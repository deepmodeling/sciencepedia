{
    "hands_on_practices": [
        {
            "introduction": "在我们能够探测符合事件之前，我们必须首先精确地探测到单个光子。本练习深入探讨 $511\\,\\mathrm{keV}$ 湮没光子与探测器晶体相互作用的基本物理过程。通过推导康普顿边的能量 ()，你将对能谱以及基于能量的散射剔除方法的物理基础有一个定量的理解，这是确保正电子发射断层扫描（PET）图像质量的关键一步。",
            "id": "4868453",
            "problem": "在正电子发射断层扫描（PET）中，探测器环用于探测能量为 $511\\,\\mathrm{keV}$ 的湮没光子符合对。每个探测器都应用能量甄别，以根据脉冲高度排除散射事件。考虑一个能量为 $511\\,\\mathrm{keV}$ 的单光子入射到闪烁探测器上。假设该光子在被吸收或逸出之前，最多经历一次康普顿散射。\n\n从入射到静止能量为 $m_e c^2$ 的静止电子上的光子的相对论能量和动量守恒出发，推导在单次康普顿相互作用中传递给反冲电子的最大动能的通用表达式，该表达式是入射光子能量 $E_0$ 和 $m_e c^2$ 的函数。然后，对于 $E_0 = 511\\,\\mathrm{keV}$，计算这个最大能量沉积（康普顿边能量）。使用 $m_e c^2 = 511\\,\\mathrm{keV}$。将您的数值结果四舍五入至四位有效数字，并以 $\\mathrm{keV}$ 为单位表示。\n\n最后，利用基于相互作用机制和信号形成的物理推理，简要论证为什么在厚闪烁晶体（例如，厚度 $\\geq 20\\,\\mathrm{mm}$）中的多点相互作用会使符合探测中基于能量的散射排除变得复杂，即使康普顿边提供了一个清晰的理论阈值。您最终报告的答案必须仅为按上述规定计算的康普顿边能量的数值。",
            "solution": "问题陈述具有科学依据，提法恰当，并包含完整推导和计算所需的所有信息。因此，该问题被认为是有效的。\n\n该问题要求推导康普顿散射事件中传递给反冲电子的最大动能，然后对入射光子能量为 $E_0 = 511\\,\\mathrm{keV}$ 的情况进行计算。设入射光子的能量为 $E_0$，动量为 $\\vec{p}_0$；散射光子的能量为 $E'$，动量为 $\\vec{p}'$；反冲电子的末动能为 $K_e$，动量为 $\\vec{p}_e$。假设电子初始时是静止的，所以它的初始能量是其静止能量 $m_e c^2$。\n\n推导从相对论能量和动量守恒原理开始。\n\n能量守恒由下式给出：\n$$E_0 + m_e c^2 = E' + E_e$$\n其中 $E_e$ 是电子的总末能量。电子的总能量是其静止能量和动能之和，即 $E_e = m_e c^2 + K_e$。将此代入能量守恒方程可得：\n$$E_0 + m_e c^2 = E' + (m_e c^2 + K_e)$$\n$$E_0 = E' + K_e$$\n这表明反冲电子的动能等于光子损失的能量：$K_e = E_0 - E'$。\n\n动量守恒是一个矢量方程：\n$$\\vec{p}_0 = \\vec{p}' + \\vec{p}_e$$\n可以重新排列以分离出电子的动量：\n$$\\vec{p}_e = \\vec{p}_0 - \\vec{p}'$$\n我们可以通过该方程与自身的点积来求得电子动量的平方：\n$$p_e^2 = (\\vec{p}_0 - \\vec{p}') \\cdot (\\vec{p}_0 - \\vec{p}') = p_0^2 + p'^2 - 2 \\vec{p}_0 \\cdot \\vec{p}'$$\n$$p_e^2 = p_0^2 + p'^2 - 2 p_0 p' \\cos\\theta$$\n其中 $\\theta$ 是入射光子和散射光子方向之间的夹角。对于光子，能量和动量通过 $E=pc$ 相关联。因此，我们可以用能量来表示上述方程：\n$$(p_e c)^2 = (p_0 c)^2 + (p' c)^2 - 2 (p_0 c)(p' c) \\cos\\theta$$\n$$(p_e c)^2 = E_0^2 + E'^2 - 2 E_0 E' \\cos\\theta$$\n\n现在我们使用电子的相对论能量-动量关系：\n$$E_e^2 = (p_e c)^2 + (m_e c^2)^2$$\n代入 $E_e = K_e + m_e c^2$：\n$$(K_e + m_e c^2)^2 = (p_e c)^2 + (m_e c^2)^2$$\n$$K_e^2 + 2 K_e m_e c^2 + (m_e c^2)^2 = (p_e c)^2 + (m_e c^2)^2$$\n$$(p_e c)^2 = K_e^2 + 2 K_e m_e c^2$$\n\n现在我们有两个关于 $(p_e c)^2$ 的表达式。令它们相等可得：\n$$K_e^2 + 2 K_e m_e c^2 = E_0^2 + E'^2 - 2 E_0 E' \\cos\\theta$$\n将 $K_e = E_0 - E'$ 代入左侧：\n$$(E_0 - E')^2 + 2 (E_0 - E') m_e c^2 = E_0^2 + E'^2 - 2 E_0 E' \\cos\\theta$$\n$$E_0^2 - 2 E_0 E' + E'^2 + 2 (E_0 - E') m_e c^2 = E_0^2 + E'^2 - 2 E_0 E' \\cos\\theta$$\n消去两边的项（$E_0^2$ 和 $E'^2$）：\n$$-2 E_0 E' + 2 (E_0 - E') m_e c^2 = -2 E_0 E' \\cos\\theta$$\n两边同除以 $2$：\n$$-E_0 E' + (E_0 - E') m_e c^2 = -E_0 E' \\cos\\theta$$\n$$(E_0 - E') m_e c^2 = E_0 E' (1 - \\cos\\theta)$$\n两边同除以 $E_0 E' m_e c^2$：\n$$\\frac{1}{E'} - \\frac{1}{E_0} = \\frac{1}{m_e c^2} (1 - \\cos\\theta)$$\n这就是著名的康普顿散射公式，它将散射光子能量 $E'$ 与入射能量 $E_0$ 和散射角 $\\theta$ 联系起来。\n\n为了求出电子的动能，我们首先解出 $E'$：\n$$\\frac{1}{E'} = \\frac{1}{E_0} + \\frac{1 - \\cos\\theta}{m_e c^2} = \\frac{m_e c^2 + E_0(1 - \\cos\\theta)}{E_0 m_e c^2}$$\n$$E' = \\frac{E_0 m_e c^2}{m_e c^2 + E_0(1 - \\cos\\theta)} = \\frac{E_0}{1 + \\frac{E_0}{m_e c^2}(1 - \\cos\\theta)}$$\n现在，电子的动能是 $K_e = E_0 - E'$：\n$$K_e = E_0 - \\frac{E_0}{1 + \\frac{E_0}{m_e c^2}(1 - \\cos\\theta)} = E_0 \\left( 1 - \\frac{1}{1 + \\frac{E_0}{m_e c^2}(1 - \\cos\\theta)} \\right)$$\n$$K_e = E_0 \\left( \\frac{1 + \\frac{E_0}{m_e c^2}(1 - \\cos\\theta) - 1}{1 + \\frac{E_0}{m_e c^2}(1 - \\cos\\theta)} \\right) = E_0 \\frac{\\frac{E_0}{m_e c^2}(1 - \\cos\\theta)}{1 + \\frac{E_0}{m_e c^2}(1 - \\cos\\theta)}$$\n当项 $(1 - \\cos\\theta)$ 最大化时，动能 $K_e$ 最大。这发生在 $\\cos\\theta = -1$ 时，对应于光子以 $\\theta = \\pi$ 或 $180^\\circ$ 的角度反向散射。在此角度下，$1 - \\cos\\theta = 2$。\n因此，最大动能 $K_{e,max}$（通常称为康普顿边能量）为：\n$$K_{e,max} = E_0 \\frac{\\frac{E_0}{m_e c^2}(2)}{1 + \\frac{E_0}{m_e c^2}(2)}$$\n通过分子和分母同乘以 $m_e c^2$ 可将其改写为：\n$$K_{e,max} = \\frac{2 E_0^2}{m_e c^2 + 2 E_0}$$\n这就是传递给反冲电子的最大动能的通用表达式。\n\n现在，我们用给定值计算此表达式：$E_0 = 511\\,\\mathrm{keV}$ 和 $m_e c^2 = 511\\,\\mathrm{keV}$。\n$$K_{e,max} = \\frac{2 (511\\,\\mathrm{keV})^2}{511\\,\\mathrm{keV} + 2 (511\\,\\mathrm{keV})} = \\frac{2 \\times 511^2}{3 \\times 511}\\,\\mathrm{keV}$$\n$$K_{e,max} = \\frac{2 \\times 511}{3}\\,\\mathrm{keV} = \\frac{1022}{3}\\,\\mathrm{keV} \\approx 340.666...\\,\\mathrm{keV}$$\n将结果四舍五入至四位有效数字，得到 $340.7\\,\\mathrm{keV}$。\n\n最后，我们讨论厚晶体中多点相互作用的复杂性。康普顿边 $K_{e,max} \\approx 340.7\\,\\mathrm{keV}$ 代表了在*单次*康普顿散射事件中沉积的最大能量。在理想的薄探测器中，任何高于此值（但低于光电峰）的能量沉积都可以归因于已经在患者体内散射过的光子，因此应被排除。\n\n然而，在厚闪烁晶体（例如，厚度 $\\geq 20\\,\\mathrm{mm}$）中，在晶体内部散射的光子在逸出前很有可能再次发生相互作用。探测器的电子设备将在一个非常短的时间窗口内发生的所有相互作用产生的光积分成一个单一的脉冲。这个脉冲的高度与所有相互作用中沉积的能量*总和*成正比。例如，一个 $511\\,\\mathrm{keV}$ 的光子可能经历第一次康普顿散射，沉积能量 $K_{e1}$，然后散射后的光子在第二次散射的光子逸出前可能再经历第二次康普顿散射，沉积能量 $K_{e2}$。探测器记录的总能量将是 $E_{dep} = K_{e1} + K_{e2}$。\n\n这个总和能量 $E_{dep}$ 可以超过单次散射的康普顿边 $K_{e,max}$。例如，一系列两次或多次前向散射事件累积沉积的能量可能比单次反向散射事件更多。这种现象“填补”了能谱中康普顿边与全能峰之间的区域。结果是，康普顿边处的清晰理论截止变得模糊不清。这使得基于能量的散射排除变得复杂，因为不再可能将那些在晶体中通过多次散射而部分沉积能量的真实事件（未在患者体内散射）与那些在患者体内散射后被探测到的事件清晰地分开。设定能量窗以排除患者散射成为一种权衡：光电峰周围的窄窗可能错误地排除具有部分能量沉积的真实事件，从而降低灵敏度；而更宽的窗则可能错误地接受更多患者散射的事件，从而降低图像对比度。",
            "answer": "$$\\boxed{340.7}$$"
        },
        {
            "introduction": "符合探测的本质在于时间测量。本练习探讨了“时间走动”这一实际挑战——即信号幅度的变化如何导致时间测量误差——并对比了两种克服此问题的关键电子学技术。通过量化简单的前沿甄别器与更精密的恒比定时甄别器之间的性能差异 ()，你将领会到实现现代 PET（特别是飞行时间 PET）所需的皮秒级精度所涉及的工程原理。",
            "id": "4868427",
            "problem": "在正电子发射断层扫描（PET）中，一对相同的探测通道使用前沿甄别器（LED）或恒分甄别器（CFD）对湮没光子事件进行符合定时。每个通道产生一个模拟闪烁脉冲，其前沿附近可以很好地近似为一个阶跃响应的因果单极点响应，模型为 $v(t) = A\\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)$（$t \\geq 0$），其中 $A$ 是脉冲幅度，$\\tau$ 是由探测器和前端电子学决定的特征上升时间常数。当 $v(t)$ 穿过一个固定阈值 $V_{\\mathrm{th}}$ 时，LED 触发。当 $v(t)$ 达到脉冲幅度的固定比例 $f$ 时，CFD 触发，即触发条件为 $v(t) = fA$。假设对于一个事件系综，幅度 $A$ 服从均值为 $A_0$、标准差为 $\\sigma_A$ 的正态分布，并且存在一个由光子统计和电子学噪声引起的、与幅度无关的额外单通道随机时间抖动 $\\sigma_{\\mathrm{noise}}$。您可以假设由于小涨落的中心极限定理效应，每个通道的时间拾取分布可以很好地近似为高斯分布。\n\n从第一性原理和上述定义出发：\n- 通过求解阈值穿越条件，推导出 LED 的触发时间 $t_{\\mathrm{LED}}(A)$，并通过计算在 $A_0$ 处的 $\\frac{dt_{\\mathrm{LED}}}{dA}$ 来获得其对幅度的灵敏度。\n- 使用在 $A_0$ 附近的一阶线性化，将幅度方差传播为时间方差，以获得由幅度引起的 LED 单通道标准差 $\\sigma_{t,\\mathrm{walk}}$。\n- 在 CFD 消除了此脉冲模型中与幅度相关的时间走动的假设下，写出 LED 和 CFD 的总单通道时间标准差，分别表示为 $\\sigma_{\\mathrm{LED}}$ 和 $\\sigma_{\\mathrm{CFD}}$。\n- 对于形成符合的两个相同通道，用单通道标准差表示符合定时标准差 $\\sigma_{\\mathrm{coinc}}$。然后，利用标准差和半高全宽（FWHM）之间的高斯关系，将每个标准差转换为符合半高全宽（FWHM）。\n\n使用以下参数值：$A_0 = 1.0~\\mathrm{V}$，$\\sigma_A = 0.20~\\mathrm{V}$，$\\tau = 1.5~\\mathrm{ns}$，$V_{\\mathrm{th}} = 0.30~\\mathrm{V}$，$f = 0.30$，以及 $\\sigma_{\\mathrm{noise}} = 60~\\mathrm{ps}$。计算基于 LED 和基于 CFD 的符合 FWHM 值之间的数值差异，定义为 $\\Delta_{\\mathrm{FWHM}} = \\mathrm{FWHM}_{\\mathrm{LED}} - \\mathrm{FWHM}_{\\mathrm{CFD}}$。\n\n您的最终答案以皮秒为单位表示，并将结果四舍五入到三位有效数字。",
            "solution": "该问题陈述经评估有效。其科学基础在于正电子发射断层扫描（PET）的核仪器学和信号处理原理。该问题是适定的，提供了一套完整的定义、参数和假设，足以推导出唯一解。语言客观且正式。因此，可以提供一个合理的解答。\n\n模拟闪烁脉冲由函数 $v(t) = A\\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)$（$t \\geq 0$）建模，其中 $A$ 是脉冲幅度，$\\tau$ 是上升时间常数。\n\n首先，我们推导前沿甄别器（LED）的触发时间，记为 $t_{\\mathrm{LED}}(A)$。当脉冲电压 $v(t)$ 穿过固定阈值 $V_{\\mathrm{th}}$ 时，LED 触发。条件是：\n$$A\\left(1 - \\exp\\left(-\\frac{t_{\\mathrm{LED}}}{\\tau}\\right)\\right) = V_{\\mathrm{th}}$$\n为了解出 $t_{\\mathrm{LED}}$，我们整理方程：\n$$1 - \\exp\\left(-\\frac{t_{\\mathrm{LED}}}{\\tau}\\right) = \\frac{V_{\\mathrm{th}}}{A}$$\n$$\\exp\\left(-\\frac{t_{\\mathrm{LED}}}{\\tau}\\right) = 1 - \\frac{V_{\\mathrm{th}}}{A}$$\n对两边取自然对数：\n$$-\\frac{t_{\\mathrm{LED}}}{\\tau} = \\ln\\left(1 - \\frac{V_{\\mathrm{th}}}{A}\\right)$$\n这得到了作为幅度 $A$ 函数的 LED 触发时间：\n$$t_{\\mathrm{LED}}(A) = -\\tau \\ln\\left(1 - \\frac{V_{\\mathrm{th}}}{A}\\right)$$\n此表达式在 $A > V_{\\mathrm{th}}$ 时有效。\n\n接下来，我们通过对 $t_{\\mathrm{LED}}(A)$ 关于 $A$ 求导来找到触发时间对幅度变化的灵敏度：\n$$\\frac{dt_{\\mathrm{LED}}}{dA} = \\frac{d}{dA}\\left[-\\tau \\ln\\left(1 - \\frac{V_{\\mathrm{th}}}{A}\\right)\\right]$$\n使用链式法则，$\\frac{d}{dx}\\ln(u) = \\frac{1}{u}\\frac{du}{dx}$，其中 $u(A) = 1 - V_{\\mathrm{th}}A^{-1}$：\n$$\\frac{du}{dA} = \\frac{d}{dA}\\left(1 - V_{\\mathrm{th}}A^{-1}\\right) = -V_{\\mathrm{th}}(-1)A^{-2} = \\frac{V_{\\mathrm{th}}}{A^2}$$\n将此代入 $t_{\\mathrm{LED}}$ 的导数中：\n$$\\frac{dt_{\\mathrm{LED}}}{dA} = -\\tau \\left(\\frac{1}{1 - \\frac{V_{\\mathrm{th}}}{A}}\\right) \\left(\\frac{V_{\\mathrm{th}}}{A^2}\\right) = -\\tau \\left(\\frac{A}{A - V_{\\mathrm{th}}}\\right) \\left(\\frac{V_{\\mathrm{th}}}{A^2}\\right) = -\\frac{\\tau V_{\\mathrm{th}}}{A(A - V_{\\mathrm{th}})}$$\n我们在平均幅度 $A = A_0$ 处计算此灵敏度：\n$$\\left.\\frac{dt_{\\mathrm{LED}}}{dA}\\right|_{A=A_0} = -\\frac{\\tau V_{\\mathrm{th}}}{A_0(A_0 - V_{\\mathrm{th}})}$$\n\n使用一阶线性化，我们将幅度分布的方差 $\\sigma_A^2$ 传播为时间方差。由幅度走动引起的时间标准差 $\\sigma_{t,\\mathrm{walk}}$ 由下式给出：\n$$\\sigma_{t,\\mathrm{walk}} = \\left| \\left.\\frac{dt_{\\mathrm{LED}}}{dA}\\right|_{A=A_0} \\right| \\sigma_A$$\n由于所有参数（$\\tau$, $V_{\\mathrm{th}}$, $A_0$, $\\sigma_A$）均为正，且 $A_0 > V_{\\mathrm{th}}$，绝对值内的表达式为负，因此我们取其相反数得到其大小：\n$$\\sigma_{t,\\mathrm{walk}} = \\frac{\\tau V_{\\mathrm{th}}}{A_0(A_0 - V_{\\mathrm{th}})} \\sigma_A$$\n\n总的单通道时间方差是来自独立噪声源的方差之和。对于 LED，这些噪声源是时间走动（$\\sigma_{t,\\mathrm{walk}}$）和固有的电子学/光子统计抖动（$\\sigma_{\\mathrm{noise}}$）。方差正交相加：\n$$\\sigma_{\\mathrm{LED}}^2 = \\sigma_{t,\\mathrm{walk}}^2 + \\sigma_{\\mathrm{noise}}^2 \\implies \\sigma_{\\mathrm{LED}} = \\sqrt{\\sigma_{t,\\mathrm{walk}}^2 + \\sigma_{\\mathrm{noise}}^2}$$\n对于恒分甄别器（CFD），触发条件是 $v(t) = fA$。对于给定的脉冲形状，$A\\left(1 - \\exp\\left(-\\frac{t_{\\mathrm{CFD}}}{\\tau}\\right)\\right) = fA$，简化为 $1 - \\exp\\left(-\\frac{t_{\\mathrm{CFD}}}{\\tau}\\right) = f$。$t_{\\mathrm{CFD}}$ 的解与 $A$ 无关，这意味着 CFD 对此脉冲模型完全消除了时间走动。因此，其时间抖动的唯一贡献是固有噪声：\n$$\\sigma_{\\mathrm{CFD}} = \\sigma_{\\mathrm{noise}}$$\n\n对于两个相同、独立的探测器通道之间的符合测量，时间分辨率由时间差 $t_{\\mathrm{coinc}} = t_1 - t_2$ 的分布决定。此差值的方差是单个通道方差之和：$\\sigma_{\\mathrm{coinc}}^2 = \\sigma_1^2 + \\sigma_2^2$。对于单通道标准差为 $\\sigma_{\\mathrm{single}}$ 的相同通道，这变为 $\\sigma_{\\mathrm{coinc}}^2 = 2\\sigma_{\\mathrm{single}}^2$，因此 $\\sigma_{\\mathrm{coinc}} = \\sqrt{2}\\sigma_{\\mathrm{single}}$。\n高斯分布的半高全宽（FWHM）与其标准差 $\\sigma$ 的关系为 $\\mathrm{FWHM} = 2\\sqrt{2\\ln(2)}\\sigma$。\n因此，符合 FWHM 为：\n$$\\mathrm{FWHM}_{\\mathrm{coinc}} = 2\\sqrt{2\\ln(2)}\\sigma_{\\mathrm{coinc}} = 2\\sqrt{2\\ln(2)}\\left(\\sqrt{2}\\sigma_{\\mathrm{single}}\\right) = 2\\sqrt{4\\ln(2)}\\sigma_{\\mathrm{single}}$$\nLED 和 CFD 系统之间 FWHM 的差异是：\n$$\\Delta_{\\mathrm{FWHM}} = \\mathrm{FWHM}_{\\mathrm{LED}} - \\mathrm{FWHM}_{\\mathrm{CFD}} = 2\\sqrt{4\\ln(2)}\\sigma_{\\mathrm{LED}} - 2\\sqrt{4\\ln(2)}\\sigma_{\\mathrm{CFD}}$$\n$$\\Delta_{\\mathrm{FWHM}} = 2\\sqrt{4\\ln(2)}\\left(\\sigma_{\\mathrm{LED}} - \\sigma_{\\mathrm{CFD}}\\right)$$\n\n我们现在计算数值。给定的参数是：\n$A_0 = 1.0~\\mathrm{V}$，$\\sigma_A = 0.20~\\mathrm{V}$，$\\tau = 1.5~\\mathrm{ns} = 1500~\\mathrm{ps}$，$V_{\\mathrm{th}} = 0.30~\\mathrm{V}$，$\\sigma_{\\mathrm{noise}} = 60~\\mathrm{ps}$。\n\n首先，我们计算 LED 的时间走动标准差：\n$$\\sigma_{t,\\mathrm{walk}} = \\frac{(1500~\\mathrm{ps})(0.30~\\mathrm{V})}{(1.0~\\mathrm{V})(1.0~\\mathrm{V} - 0.30~\\mathrm{V})} (0.20~\\mathrm{V}) = \\frac{450}{0.70} \\times 0.20~\\mathrm{ps} = \\frac{90}{0.7}~\\mathrm{ps} = \\frac{900}{7}~\\mathrm{ps}$$\n$$\\sigma_{t,\\mathrm{walk}} \\approx 128.571~\\mathrm{ps}$$\n接下来，我们计算 LED 的总单通道标准差：\n$$\\sigma_{\\mathrm{LED}} = \\sqrt{\\left(\\frac{900}{7}\\right)^2 + (60)^2}~\\mathrm{ps} = \\sqrt{\\frac{810000}{49} + 3600}~\\mathrm{ps} = \\sqrt{\\frac{810000 + 176400}{49}}~\\mathrm{ps}$$\n$$\\sigma_{\\mathrm{LED}} = \\sqrt{\\frac{986400}{49}}~\\mathrm{ps} \\approx \\sqrt{20130.61}~\\mathrm{ps} \\approx 141.882~\\mathrm{ps}$$\nCFD 的单通道标准差是：\n$$\\sigma_{\\mathrm{CFD}} = \\sigma_{\\mathrm{noise}} = 60~\\mathrm{ps}$$\n现在我们计算符合 FWHM 的最终差异：\n$$\\Delta_{\\mathrm{FWHM}} = 2\\sqrt{4\\ln(2)}\\left(141.882... - 60\\right)~\\mathrm{ps}$$\n$$\\Delta_{\\mathrm{FWHM}} = 2\\sqrt{4\\ln(2)}\\left(81.882...\\right)~\\mathrm{ps}$$\n前置因子是 $2\\sqrt{4\\ln(2)} \\approx 2\\sqrt{4(0.693147)} \\approx 2\\sqrt{2.772588} \\approx 3.330218$。\n$$\\Delta_{\\mathrm{FWHM}} \\approx 3.330218 \\times 81.882...~\\mathrm{ps} \\approx 272.6715~\\mathrm{ps}$$\n将结果四舍五入到三位有效数字，得到 $273~\\mathrm{ps}$。",
            "answer": "$$\\boxed{273}$$"
        },
        {
            "introduction": "在建立了精确的时间测量之后，我们便可以确定湮没事件在响应线上的位置，这正是飞行时间 PET（TOF-PET）的核心原理。最后的这个练习将带你进入统计信号处理的领域，你将推导一个最大似然估计器，将测量到的时间差转换为位置估计 ()。你还将研究像时钟偏移这样的系统性误差如何引入偏差，这突显了校准在真实成像系统中的重要性。",
            "id": "4868397",
            "problem": "在飞行时间正电子发射断层扫描 (Time-of-Flight Positron Emission Tomography, TOF-PET) 系统中，放置在响应线 (line-of-response, LOR) 两端的两个探测器符合探测到两个能量约为 $511\\,\\text{keV}$ 的背对背湮没光子。设 LOR 由坐标 $s$ 参数化，其中 $s=0$ 位于两探测器之间的几何中点，且 $s>0$ 的方向朝向探测器 2。忽略非共线性，并假设光子在真空中以光速 $c$ 传播。\n\n湮没事件发生在 LOR 上的一个未知位置 $s$。发射点到两个探测器的距离分别为 $d_{1}$ 和 $d_{2}$。对应的到达探测器 1 和 2 的理想时间分别为 $t_{1} = t_{0} + d_{1}/c$ 和 $t_{2} = t_{0} + d_{2}/c$，其中 $t_{0}$ 是（未知的）发射时间。两个探测器之间测量到的时间差被建模为单个带噪声的观测值\n$$\n\\Delta t = t_{2} - t_{1} + \\varepsilon,\n$$\n其中 $\\varepsilon$ 是均值为零、已知方差为 $\\sigma_{t}^{2}$ 的高斯计时噪声，即 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma_{t}^{2})$。你可以假设探测器对关于 $s=0$ 对称，因此对于某个已知的间距 $L$，有 $d_{1} = \\frac{L}{2} + s$ 和 $d_{2} = \\frac{L}{2} - s$，并且湮没光子在质心系中是同时发射的，因此理想到达时间的任何差异仅由光程差引起。\n\n1) 从这些原理出发，写出给定单个测量时间差 $\\Delta t$ 时未知位置 $s$ 的似然函数，并推导出最大似然估计量 $\\hat{s}_{\\text{ML}}$，使其为测量值 $\\Delta t$、光速 $c$ 和已知方差 $\\sigma_{t}^{2}$ 的显式函数。\n\n2) 现在假设系统时钟存在一个恒定的、未知的偏移量 $\\delta$，使得测量模型变为\n$$\n\\Delta t_{\\text{meas}} = \\left(t_{2} - t_{1}\\right) + \\delta + \\varepsilon.\n$$\n如果在忽略 $\\delta$ 的情况下，仍然朴素地使用第 (1) 部分的估计量，请计算该估计量的偏差，定义为 $\\mathrm{Bias}(\\hat{s}) = \\mathbb{E}[\\hat{s} - s]$，并用 $\\delta$ 和 $c$ 表示。\n\n最终答案应为一个数对，包含第 (1) 部分的最大似然估计量和第 (2) 部分的偏差。不需要进行数值计算。将 $s$ 和偏差以米为单位表示。在最终的方框答案中不要包含单位。",
            "solution": "首先验证问题，以确保其具有科学依据、良定性和客观性。\n\n### 第 1 步：提取已知条件\n- **系统：** 飞行时间正电子发射断层扫描 (TOF-PET)。\n- **物理：** 探测两个背对背的湮没光子，每个光子能量约为 $511\\,\\text{keV}$。\n- **几何：** 探测器位于响应线 (LOR) 的两端。LOR 由坐标 $s$ 参数化，其中 $s=0$ 在几何中点。探测器之间的总间距为 $L$。\n- **光子传播：** 光子在真空中以光速 $c$ 传播。忽略非共线性。\n- **湮没位置：** 沿 LOR 的一个未知位置 $s$。\n- **距离：** 从发射点 $s$ 到探测器 1 和探测器 2 的距离分别为 $d_{1} = \\frac{L}{2} + s$ 和 $d_{2} = \\frac{L}{2} - s$。\n- **理想时间：** 理想到达时间为 $t_{1} = t_{0} + d_{1}/c$ 和 $t_{2} = t_{0} + d_{2}/c$，其中 $t_{0}$ 是未知的发射时间。光子在质心系中同时发射。\n- **测量模型 1：** $\\Delta t = t_{2} - t_{1} + \\varepsilon$，其中 $\\varepsilon$ 是一个随机噪声项。\n- **噪声模型：** $\\varepsilon \\sim \\mathcal{N}(0,\\sigma_{t}^{2})$，其中 $\\sigma_{t}^{2}$ 是已知方差。\n- **任务 1：** 推导最大似然估计量 (MLE) $\\hat{s}_{\\text{ML}}$，使其为 $\\Delta t$、$c$ 和 $\\sigma_{t}^{2}$ 的显式函数。\n- **测量模型 2：** $\\Delta t_{\\text{meas}} = (t_{2} - t_{1}) + \\delta + \\varepsilon$，其中 $\\delta$ 是一个恒定的、未知的时钟偏移。\n- **任务 2：** 当朴素地应用于第二个测量模型时，计算第 1 部分中估计量的偏差 $\\mathrm{Bias}(\\hat{s}) = \\mathbb{E}[\\hat{s} - s]$。偏差应以 $\\delta$ 和 $c$ 表示。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 该问题描述了一个简化的但标准的、物理上正确的 TOF-PET 成像模型。正电子湮没、$511\\,\\text{keV}$ 背对背光子、飞行时间差和高斯计时分辨率等概念是该领域的基础。所有前提在事实上都是合理的。\n- **良定性：** 该问题是良定的。第 1 部分要求找到似然函数的最大值，这是估计理论中的一个标准过程。第 2 部分要求计算估计量的偏差，这是一个明确定义的统计量。所提供的信息足以推导出两个部分的唯一答案。\n- **客观性与完整性：** 该问题以精确、客观的数学语言陈述。所有必要的变量和关系（$d_1(s)$、$d_2(s)$、$\\mathcal{N}(0, \\sigma_t^2)$）都已明确定义。没有歧义、矛盾或缺失的信息。\n- **现实性：** 该模型使用了一些理想化处理（例如，在真空中传播、完美的共线性），这在创建易于处理的物理问题时很常见。这些简化不会使问题在科学上无效或在物理上不可能。\n\n### 第 3 步：结论与行动\n问题被判定为 **有效**。现在开始求解过程。\n\n### 解题推导\n\n**第 1 部分：最大似然估计量 $\\hat{s}_{\\text{ML}}$**\n\n两个光子到达各自探测器的理想时间差 $\\Delta t_{\\text{ideal}}$，由它们的光程差除以光速 $c$ 给出。\n令 $\\Delta t_{\\text{ideal}} = t_2 - t_1$。使用给定的 $t_1$ 和 $t_2$ 表达式：\n$$\n\\Delta t_{\\text{ideal}} = \\left(t_{0} + \\frac{d_{2}}{c}\\right) - \\left(t_{0} + \\frac{d_{1}}{c}\\right) = \\frac{d_{2} - d_{1}}{c}\n$$\n代入 $d_1$ 和 $d_2$ 的几何关系：\n$$\nd_{1} = \\frac{L}{2} + s \\quad \\text{和} \\quad d_{2} = \\frac{L}{2} - s\n$$\n差值 $d_{2} - d_{1}$ 是：\n$$\nd_{2} - d_{1} = \\left(\\frac{L}{2} - s\\right) - \\left(\\frac{L}{2} + s\\right) = -2s\n$$\n因此，理想时间差与位置 $s$ 成正比：\n$$\n\\Delta t_{\\text{ideal}} = -\\frac{2s}{c}\n$$\n单次观测 $\\Delta t$ 的测量模型为：\n$$\n\\Delta t = \\Delta t_{\\text{ideal}} + \\varepsilon = -\\frac{2s}{c} + \\varepsilon\n$$\n其中噪声项 $\\varepsilon$ 是从均值为 0、方差为 $\\sigma_t^2$ 的高斯分布中抽取的随机变量，即 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma_t^2)$。\n\n为了找到 $s$ 的最大似然估计量，我们首先写出似然函数 $p(\\Delta t | s)$，它是在给定真实位置 $s$ 的情况下观测到测量值 $\\Delta t$ 的概率密度。从测量模型可以看出，$\\Delta t$ 是一个高斯随机变量，其均值为 $-\\frac{2s}{c}$，方差为 $\\sigma_t^2$。\n$$\n\\Delta t \\sim \\mathcal{N}\\left(-\\frac{2s}{c}, \\sigma_{t}^{2}\\right)\n$$\n因此，似然函数是这个正态分布的概率密度函数 (PDF)：\n$$\nL(s | \\Delta t) = p(\\Delta t | s) = \\frac{1}{\\sqrt{2\\pi\\sigma_{t}^{2}}} \\exp\\left( -\\frac{\\left(\\Delta t - \\left(-\\frac{2s}{c}\\right)\\right)^{2}}{2\\sigma_{t}^{2}} \\right) = \\frac{1}{\\sqrt{2\\pi\\sigma_{t}^{2}}} \\exp\\left( -\\frac{\\left(\\Delta t + \\frac{2s}{c}\\right)^{2}}{2\\sigma_{t}^{2}} \\right)\n$$\n为了找到使该似然函数最大化的 $s$ 值，计算上更简单的方法是最大化其自然对数，即对数似然函数 $\\ell(s | \\Delta t) = \\ln L(s | \\Delta t)$。\n$$\n\\ell(s | \\Delta t) = \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma_{t}^{2}}}\\right) - \\frac{\\left(\\Delta t + \\frac{2s}{c}\\right)^{2}}{2\\sigma_{t}^{2}}\n$$\n我们通过对对数似然函数关于 $s$ 求导并令其为零来找到最大值。\n$$\n\\frac{d\\ell}{ds} = \\frac{d}{ds} \\left[ -\\ln(\\sqrt{2\\pi\\sigma_{t}^{2}}) - \\frac{1}{2\\sigma_{t}^{2}}\\left(\\Delta t + \\frac{2s}{c}\\right)^{2} \\right] \\\\\n= -\\frac{1}{2\\sigma_{t}^{2}} \\cdot 2\\left(\\Delta t + \\frac{2s}{c}\\right) \\cdot \\frac{d}{ds}\\left(\\Delta t + \\frac{2s}{c}\\right) \\\\\n= -\\frac{1}{\\sigma_{t}^{2}}\\left(\\Delta t + \\frac{2s}{c}\\right) \\left(\\frac{2}{c}\\right)\n$$\n将导数设为零以找到临界点，该点对应于 MLE $\\hat{s}_{\\text{ML}}$：\n$$\n-\\frac{2}{c\\sigma_{t}^{2}}\\left(\\Delta t + \\frac{2\\hat{s}_{\\text{ML}}}{c}\\right) = 0\n$$\n由于前置因子 $-\\frac{2}{c\\sigma_{t}^{2}}$ 非零，因此括号内的表达式必须为零：\n$$\n\\Delta t + \\frac{2\\hat{s}_{\\text{ML}}}{c} = 0\n$$\n解出 $\\hat{s}_{\\text{ML}}$ 得到最大似然估计量：\n$$\n\\hat{s}_{\\text{ML}} = -\\frac{c \\Delta t}{2}\n$$\n二阶导数 $\\frac{d^2\\ell}{ds^2} = -\\frac{4}{c^2\\sigma_{t}^{2}}$ 为负，证实了这是一个最大值。请注意，该估计量不依赖于噪声方差 $\\sigma_t^2$，尽管其推导需要高斯模型的假设，而 $\\sigma_t^2$ 是该模型的一个参数。\n\n**第 2 部分：带时钟偏移的估计量的偏差**\n\n在这部分，测量模型被一个恒定的、未知的时钟偏移 $\\delta$ 所改变：\n$$\n\\Delta t_{\\text{meas}} = (t_{2} - t_{1}) + \\delta + \\varepsilon = -\\frac{2s}{c} + \\delta + \\varepsilon\n$$\n问题指出，我们朴素地继续使用第 1 部分的估计量。这意味着在 $\\hat{s}_{\\text{ML}}$ 的表达式中用 $\\Delta t_{\\text{meas}}$ 替换 $\\Delta t$。我们将这个朴素估计量称为 $\\hat{s}_{\\text{naive}}$。\n$$\n\\hat{s}_{\\text{naive}} = -\\frac{c \\Delta t_{\\text{meas}}}{2}\n$$\n我们将 $\\Delta t_{\\text{meas}}$ 的表达式代入估计量公式：\n$$\n\\hat{s}_{\\text{naive}} = -\\frac{c}{2} \\left(-\\frac{2s}{c} + \\delta + \\varepsilon\\right) = s - \\frac{c\\delta}{2} - \\frac{c\\varepsilon}{2}\n$$\n估计量 $\\hat{s}$ 的偏差定义为 $\\mathrm{Bias}(\\hat{s}) = \\mathbb{E}[\\hat{s} - s]$，其中期望 $\\mathbb{E}[\\cdot]$ 是针对模型中随机变量的概率分布计算的，在本例中即为 $\\varepsilon$。真实位置 $s$ 和偏移量 $\\delta$ 被视为非随机参数。\n$$\n\\mathrm{Bias}(\\hat{s}_{\\text{naive}}) = \\mathbb{E}[\\hat{s}_{\\text{naive}} - s] = \\mathbb{E}\\left[\\left(s - \\frac{c\\delta}{2} - \\frac{c\\varepsilon}{2}\\right) - s\\right]\n$$\n$$\n\\mathrm{Bias}(\\hat{s}_{\\text{naive}}) = \\mathbb{E}\\left[-\\frac{c\\delta}{2} - \\frac{c\\varepsilon}{2}\\right]\n$$\n利用期望的线性性质：\n$$\n\\mathrm{Bias}(\\hat{s}_{\\text{naive}}) = -\\mathbb{E}\\left[\\frac{c\\delta}{2}\\right] - \\mathbb{E}\\left[\\frac{c\\varepsilon}{2}\\right] = -\\frac{c\\delta}{2} - \\frac{c}{2}\\mathbb{E}[\\varepsilon]\n$$\n我们已知噪声 $\\varepsilon$ 的均值为零，即 $\\mathbb{E}[\\varepsilon] = 0$。因此，偏差为：\n$$\n\\mathrm{Bias}(\\hat{s}_{\\text{naive}}) = -\\frac{c\\delta}{2} - \\frac{c}{2}(0) = -\\frac{c\\delta}{2}\n$$\n偏差是一个常数值，取决于时钟偏移 $\\delta$ 和光速 $c$。\n最终答案是数对 $(\\hat{s}_{\\text{ML}}, \\mathrm{Bias})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{c \\Delta t}{2}  -\\frac{c\\delta}{2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}