{
    "hands_on_practices": [
        {
            "introduction": "在迭代重建算法中，系统矩阵是连接图像空间和投影数据的桥梁。这个矩阵的每一个元素，本质上都代表了一条响应线 (Line of Response, LOR) 穿过一个图像体素的路径长度。通过这个练习，你将运用解析几何的基本原理，亲手计算这一基础量，这是理解射线驱动正向投影模型核心的关键一步。",
            "id": "4907349",
            "problem": "一个半径为$400\\,\\mathrm{mm}$的圆柱形机架的正电子发射断层扫描（PET）系统，在横断面上将两个相对的探测器元件放置在极角$30^{\\circ}$和$210^{\\circ}$处。位于$30^{\\circ}$的探测器坐标为$(x,y,z) = \\big(200\\sqrt{3}\\,,\\,200\\,,\\,-20\\big)\\,\\mathrm{mm}$，而位于$210^{\\circ}$的相对探测器坐标为$(x,y,z) = \\big(-200\\sqrt{3}\\,,\\,-200\\,,\\,40\\big)\\,\\mathrm{mm}$。响应线（LOR）是连接这两个探测器中心的直线段。\n\n考虑在扫描仪坐标系中定义的一个单一轴对齐体素，其边界为$x \\in [-5,0]\\,\\mathrm{mm}$，$y \\in [-5,5]\\,\\mathrm{mm}$，以及$z \\in [0,20]\\,\\mathrm{mm}$。在用于PET的射线驱动离散正向模型中，该体素对测量的LOR的贡献（权重）与LOR穿过该体素的弦长成正比。仅使用解析几何的第一性原理和Siddon算法背后的基本思想（将射线参数化，并通过与体素的轴对齐平面相交来确定入射和出射参数），推导出位于该体素内部的LOR段的精确弦长。\n\n您必须：\n- 将LOR参数化为连接两个探测器中心的直线段。\n- 确定射线与体素的每个轴对齐平面相交时的参数值。\n- 识别体素的有效入射和出射参数，并通过出射和入射参数之差乘以整个LOR段的物理长度来计算体素内的路径长度。\n- 将最终权重表示为以$\\mathrm{mm}$为单位的精确路径长度，不进行数值近似。\n\n将您的最终答案表示为以毫米为单位的精确封闭形式表达式。不要四舍五入或近似。",
            "solution": "该问题是有效的，因为它科学地基于PET成像几何原理，数据充分且一致，问题表述适定，并且表达客观。因此，我们可以进行弦长的形式推导。\n\n问题的核心是确定一条线段（响应线，LOR）与一个长方体（体素）相交部分的长度。这是计算几何中的一个标准程序，常用于像Siddon提出的断层重建算法中。\n\n设两个探测器位置为$P_1$和$P_2$。给定的坐标是：\n$$P_1 = (x_1, y_1, z_1) = (200\\sqrt{3}, 200, -20)\\,\\mathrm{mm}$$\n$$P_2 = (x_2, y_2, z_2) = (-200\\sqrt{3}, -200, 40)\\,\\mathrm{mm}$$\n\n首先，我们将LOR参数化为一条线段$L(t)$，参数$t \\in [0, 1]$，其中$L(0) = P_1$且$L(1) = P_2$。该直线的方程为：\n$$L(t) = P_1 + t(P_2 - P_1)$$\nLOR的方向向量，$V = P_2 - P_1$，为：\n$$V = \\langle x_2-x_1, y_2-y_1, z_2-z_1 \\rangle$$\n$$V = \\langle -200\\sqrt{3} - 200\\sqrt{3}, -200 - 200, 40 - (-20) \\rangle$$\n$$V = \\langle -400\\sqrt{3}, -400, 60 \\rangle$$\nLOR线段的总长度，$|V|$，为：\n$$|V| = \\sqrt{(-400\\sqrt{3})^2 + (-400)^2 + 60^2}$$\n$$|V| = \\sqrt{160000 \\cdot 3 + 160000 + 3600} = \\sqrt{480000 + 160000 + 3600} = \\sqrt{643600}$$\n$$|V| = \\sqrt{100 \\cdot 6436} = 10\\sqrt{4 \\cdot 1609} = 20\\sqrt{1609}\\,\\mathrm{mm}$$\n\nLOR上一点坐标的参数方程为：\n$$x(t) = x_1 + t V_x = 200\\sqrt{3} - 400\\sqrt{3} t$$\n$$y(t) = y_1 + t V_y = 200 - 400 t$$\n$$z(t) = z_1 + t V_z = -20 + 60 t$$\n\n接下来，我们确定LOR与包围体素的六个平面相交时的参数$t$的值。该体素定义为：\n$$x \\in [x_{\\min}, x_{\\max}] = [-5, 0]\\,\\mathrm{mm}$$\n$$y \\in [y_{\\min}, y_{\\max}] = [-5, 5]\\,\\mathrm{mm}$$\n$$z \\in [z_{\\min}, z_{\\max}] = [0, 20]\\,\\mathrm{mm}$$\n\n对于每个维度，我们求解$t$：\n1.  **与x平面的交点：**\n    $x(t) = 0 \\implies 200\\sqrt{3} - 400\\sqrt{3} t = 0 \\implies t = \\frac{200\\sqrt{3}}{400\\sqrt{3}} = \\frac{1}{2}$。\n    $x(t) = -5 \\implies 200\\sqrt{3} - 400\\sqrt{3} t = -5 \\implies 400\\sqrt{3} t = 200\\sqrt{3} + 5 \\implies t = \\frac{200\\sqrt{3} + 5}{400\\sqrt{3}} = \\frac{1}{2} + \\frac{5}{400\\sqrt{3}} = \\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$。\n    由于 $V_x  0$，$x(t)$ 是递减函数。LOR在$x=0$处进入x平板，在$x=-5$处离开。x维度的参数区间为 $[t_{x, \\text{start}}, t_{x, \\text{end}}] = [\\frac{1}{2}, \\frac{1}{2} + \\frac{1}{80\\sqrt{3}}]$。\n\n2.  **与y平面的交点：**\n    $y(t) = 5 \\implies 200 - 400 t = 5 \\implies 400 t = 195 \\implies t = \\frac{195}{400} = \\frac{39}{80}$。\n    $y(t) = -5 \\implies 200 - 400 t = -5 \\implies 400 t = 205 \\implies t = \\frac{205}{400} = \\frac{41}{80}$。\n    由于 $V_y  0$，$y(t)$ 是递减函数。LOR在$y=5$处进入y平板，在$y=-5$处离开。参数区间为 $[t_{y, \\text{start}}, t_{y, \\text{end}}] = [\\frac{39}{80}, \\frac{41}{80}]$。\n\n3.  **与z平面的交点：**\n    $z(t) = 0 \\implies -20 + 60 t = 0 \\implies 60 t = 20 \\implies t = \\frac{20}{60} = \\frac{1}{3}$。\n    $z(t) = 20 \\implies -20 + 60 t = 20 \\implies 60 t = 40 \\implies t = \\frac{40}{60} = \\frac{2}{3}$。\n    由于 $V_z > 0$，$z(t)$ 是递增函数。LOR在$z=0$处进入z平板，在$z=20$处离开。参数区间为 $[t_{z, \\text{start}}, t_{z, \\text{end}}] = [\\frac{1}{3}, \\frac{2}{3}]$。\n\n当参数$t$的范围同时满足所有三个条件时，LOR位于体素内部。这对应于三个参数区间的交集。得到的区间$[t_{\\text{in}}, t_{\\text{out}}]$如下计算：\n$$t_{\\text{in}} = \\max(t_{x, \\text{start}}, t_{y, \\text{start}}, t_{z, \\text{start}}) = \\max\\left(\\frac{1}{2}, \\frac{39}{80}, \\frac{1}{3}\\right)$$\n为了比较，我们使用公分母$240$：$\\max(\\frac{120}{240}, \\frac{117}{240}, \\frac{80}{240}) = \\frac{120}{240} = \\frac{1}{2}$。\n$$t_{\\text{out}} = \\min(t_{x, \\text{end}}, t_{y, \\text{end}}, t_{z, \\text{end}}) = \\min\\left(\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}, \\frac{41}{80}, \\frac{2}{3}\\right)$$\n让我们比较这些值。$\\frac{41}{80} = 0.5125$。$\\frac{2}{3} \\approx 0.6667$。$\\frac{1}{2} + \\frac{1}{80\\sqrt{3}} = \\frac{1}{2} + \\frac{\\sqrt{3}}{240} \\approx 0.5 + \\frac{1.732}{240} \\approx 0.5 + 0.0072 = 0.5072$。\n因此，最小值是$\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$。\n为了在没有近似的情况下严格证明这一点：比较 $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$ 与 $\\frac{41}{80}$。这等同于比较 $\\frac{1}{80\\sqrt{3}}$ 与 $\\frac{41}{80} - \\frac{1}{2} = \\frac{41-40}{80} = \\frac{1}{80}$。我们比较 $\\frac{1}{\\sqrt{3}}$ 与 $1$，并且由于 $\\sqrt{3} > 1$，我们有 $\\frac{1}{\\sqrt{3}}  1$。因此，$\\frac{1}{80\\sqrt{3}}  \\frac{1}{80}$，并且 $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}  \\frac{41}{80}$。最小值是 $\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}$。\n\n所以，LOR在体素内部的参数区间为：\n$$[t_{\\text{in}}, t_{\\text{out}}] = \\left[\\frac{1}{2}, \\frac{1}{2} + \\frac{1}{80\\sqrt{3}}\\right]$$\n由于 $t_{\\text{in}}  t_{\\text{out}}$，LOR确实与体素相交。此参数区间的长度为：\n$$\\Delta t = t_{\\text{out}} - t_{\\text{in}} = \\left(\\frac{1}{2} + \\frac{1}{80\\sqrt{3}}\\right) - \\frac{1}{2} = \\frac{1}{80\\sqrt{3}}$$\n弦长，$L_{\\text{chord}}$，是此参数区间长度与LOR向量总长度的乘积：\n$$L_{\\text{chord}} = \\Delta t \\cdot |V| = \\left(\\frac{1}{80\\sqrt{3}}\\right) \\cdot (20\\sqrt{1609})$$\n$$L_{\\text{chord}} = \\frac{20\\sqrt{1609}}{80\\sqrt{3}} = \\frac{\\sqrt{1609}}{4\\sqrt{3}}$$\n为了以有理化的封闭形式给出答案，我们将分子和分母同乘以$\\sqrt{3}$：\n$$L_{\\text{chord}} = \\frac{\\sqrt{1609} \\cdot \\sqrt{3}}{4\\sqrt{3} \\cdot \\sqrt{3}} = \\frac{\\sqrt{1609 \\cdot 3}}{4 \\cdot 3} = \\frac{\\sqrt{4827}}{12}$$\n这就是在指定体素内部的LOR段的精确弦长。",
            "answer": "$$\\boxed{\\frac{\\sqrt{4827}}{12}}$$"
        },
        {
            "introduction": "掌握了单个 LOR 与体素的相互作用后，我们将视野提升到完整的正弦图层面。PET 扫描仪的几何精度对高质量成像至关重要，任何微小的几何错误都可能导致图像中出现伪影。这个问题模拟了一个真实的系统标定错误，要求你像一名医学物理师一样，从基本原理出发预测它在正弦图数据中产生的特征伪影，从而锻炼你诊断和解决实际问题的关键能力。",
            "id": "4907397",
            "problem": "一个正电子发射断层扫描（PET）系统包含一个二维探测器单环，环上有 $N$ 个相同的晶体，均匀分布在半径为 $R_d$ 的圆周上。第 $i$ 个晶体的中心位于角位置 $\\theta_i = \\dfrac{2\\pi i}{N}$（从 x 轴正方向测量），其中 $i \\in \\{0,1,\\dots,N-1\\}$。假设系统只接受名义上相对的晶体（$(i, i+N/2)$）之间的符合事件，并且窦图分箱使用平行束坐标 $(s,\\phi)$，其中 $\\phi$ 是响应线（LOR）法线的角度，$s$ 是从原点到 LOR 的有符号垂直距离。\n\n在一个其他方面都理想的系统中，单独一对相邻晶体的软件索引被交换：晶体 $k$ 和 $k+1$ 被互换。物理上，晶体保持在角位置 $\\theta_k$ 和 $\\theta_{k+1}=\\theta_k+\\Delta\\theta$（其中 $\\Delta\\theta=\\dfrac{2\\pi}{N}$），但系统在计算窦图坐标时使用它们互换后的索引。所有其他晶体都被正确索引。一个尺寸可忽略的密封点源被放置在环的正中心 $(x,y)=(0,0)$，并在单个横断面切片中采集了大量的符合事件。\n\n从第一性几何原理（即，由半径为 $R_d$ 的圆上两点形成的 LOR 的 $(s,\\phi)$ 定义）出发，分析单个相邻交换在窦图中的表现形式，并设计一个几何测试来使用中心点源检测和定位此类交换。然后，对于一个具有 $N=624$ 和 $R_d=420\\,\\mathrm{mm}$ 的真实 PET 环，确定由该交换引入的伪影的预测绝对径向偏移量 $|s|$。\n\n选择唯一最佳选项，该选项正确描述了伪影特征，提供了可靠的几何检测/定位程序，并包含了给定 $N$ 和 $R_d$ 下 $|s|$ 的正确数值。\n\nA. 对于中心点源，该交换在单个投影角度 $\\phi$（等于被错误计算的晶体对的角平分线）处，在 $s=\\pm R_d\\sin\\!\\left(\\dfrac{\\Delta\\theta}{2}\\right)$ 位置导致一条细长的水平带，其中 $\\Delta\\theta=\\dfrac{2\\pi}{N}$。通过测量该带的非零 $|s|$ 来进行检测和定位，计算 $\\delta=2\\arcsin\\!\\left(\\dfrac{|s|}{R_d}\\right)$，验证 $\\delta\\approx \\dfrac{2\\pi}{N}$（相邻交换），并读取 $\\phi$ 来识别被交换的晶体对。对于 $N=624$ 和 $R_d=420\\,\\mathrm{mm}$， $|s|\\approx 2.11\\,\\mathrm{mm}$。\n\nB. 对于中心点源，该交换在一个随机的 $\\phi$ 处生成一个跨越所有 $s$ 的垂直条纹。检测需要将点源移离中心以产生正弦曲线；在中心处没有伪影，所以 $|s|=0\\,\\mathrm{mm}$。\n\nC. 该交换将所有投影角度全局性地移动 $\\dfrac{\\Delta\\theta}{2}$，为中心点源产生一个相移的正弦曲线。通过测量一个横跨所有 $\\phi$ 的均匀相位偏移来检测；对于任何 $N$，预测的 $|s|$ 都等于 $R_d$。\n\nD. 该交换在窦图中引入没有几何结构的随机散斑。检测需要飞行时间（TOF）计时来分离索引错误的事件；$|s|$ 无法从 $N$ 和 $R_d$ 预测。",
            "solution": "用户希望我验证问题陈述，如果有效，则提供详细的解决方案。\n\n### 步骤 1：提取已知条件\n\n-   **系统几何结构**：一个二维探测器单环。\n-   **晶体数量**：$N$ 个相同晶体。\n-   **晶体排列**：均匀分布在半径为 $R_d$ 的圆上。\n-   **晶体角位置**：第 $i$ 个晶体中心位于 $\\theta_i = \\dfrac{2\\pi i}{N}$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$。\n-   **可接受的符合事件**：仅限名义上相对的晶体之间，索引为 $(i, i+N/2)$。\n-   **窦图坐标**：平行束坐标 $(s, \\phi)$，其中 $\\phi$ 是响应线（LOR）法线的角度，$s$ 是从原点到 LOR 的有符号垂直距离。\n-   **系统误差**：相邻晶体 $k$ 和 $k+1$ 的软件索引被交换。\n-   **物理现实**：物理位置在 $\\theta_k$ 的晶体被软件视为索引 $k+1$，而物理位置在 $\\theta_{k+1}$ 的晶体被视为索引 $k$。\n-   **角间距**：$\\theta_{k+1} = \\theta_k + \\Delta\\theta$，其中 $\\Delta\\theta = \\dfrac{2\\pi}{N}$。\n-   **放射源**：一个尺寸可忽略的密封点源，位于环的中心 $(x,y)=(0,0)$。\n-   **数据**：在单个横断面切片中采集了大量的符合事件。\n-   **具体参数**：用于数值计算，$N=624$，$R_d = 420\\,\\mathrm{mm}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题在正电子发射断层扫描（PET）扫描仪几何结构、窦图形成和质量保证程序的原理上有充分的依据。中心点源采集是校准和验证探测器映射及系统几何结构的​​标准方法。软件索引交换的概念是医学成像设备复杂软件链中一种合理且现实的错误类型。该问题在科学上是合理的。\n-   **适定性**：该问题提供了所有必要的几何参数（$R_d$, $N$）、错误的精确性质（相邻索引交换）以及测量条件（中心点源），足以明确地确定该错误的几何后果。问题要求进行具体分析、设计检测方法和进行计算，所有这些都可以从已知条件中推导出来。“系统在计算窦图坐标时使用它们互换后的索引”这一陈述是关键。一个物理符合事件在两个探测器位置被记录下来。然后，系统软件使用查找表来找到这些探测器的索引。由于错误，对于位于 $\\theta_k$ 和 $\\theta_{k+1}$ 的探测器，此查找是不正确的。接着，系统根据它所检索到的（可能不正确的）索引所关联的*名义*几何位置来计算 $(s, \\phi)$ 坐标。这种解释在物理上和计算上都是合理的，并使得问题是适定的。\n-   **客观性**：语言技术性强、精确，并且没有任何主观或有偏见的陈述。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效**的。它在科学上是合理的、适定的和客观的。我将继续进行解答。\n\n### 基于原理的推导与解答\n\n该问题要求分析软件层面交换两个相邻探测器索引对中心点源生成的窦图的影响。\n\n**1. 理想系统（无交换）**\n\n在理想系统中，一个点源位于原点 $(0,0)$，正电子湮没产生两个沿相反方向、沿着一条穿过原点的直线传播的光子。这两个光子被两个物理上相对的晶体探测到，例如角位置为 $\\theta_i$ 和 $\\theta_{i+N/2} = \\theta_i + \\pi$ 的晶体。连接这两个晶体中心的响应线（LOR）是点 $(R_d\\cos\\theta_i, R_d\\sin\\theta_i)$ 和 $(R_d\\cos(\\theta_i+\\pi), R_d\\sin(\\theta_i+\\pi)) = (-R_d\\cos\\theta_i, -R_d\\sin\\theta_i)$ 之间的线段。这条线直接穿过原点。\n\n对于任何穿过原点的直线，从原点到该线的垂直距离是 $s=0$。LOR 的角度是 $\\theta_i$，其法向量的角度是 $\\phi_i = \\theta_i + \\pi/2$。因此，一个理想的中心点源会生成一个所有事件都位于 $s=0$ 的窦图，分布在所有投影角度 $\\phi \\in [0, \\pi)$ 上。在窦图中，这表现为一条位于 $s=0$ 的单一、明亮的水平线。\n\n**2. 带有交换索引的系统**\n\n错误在于物理位置为 $\\theta_k$ 的晶体以软件索引 $k+1$ 进行报告，而物理位置为 $\\theta_{k+1}$ 的晶体以软件索引 $k$ 进行报告。所有其他晶体都映射正确。\n\n我们必须分析涉及索引错误晶体的 LOR。由于源在中心，我们考虑物理上相对的探测器之间的符合事件。其分箱将被破坏的 LOR 是那些涉及物理探测器在 $\\theta_k$ 和 $\\theta_{k+1}$ 处的 LOR。\n\n-   **情况 1：涉及物理探测器在 $\\theta_k$ 处的事件**\n    一个物理符合事件发生在 $\\theta_k$ 和 $\\theta_{k+N/2}$ 的探测器之间。\n    -   物理位置为 $\\theta_k$ 的探测器被软件错误地识别为索引 $k+1$。\n    -   物理位置为 $\\theta_{k+N/2}$ 的探测器被正确地识别为索引 $k+N/2$（假设 $k+N/2$ 不等于 $k$ 或 $k+1$，这对任何实际的 $N$ 都成立）。\n    -   软件接收到索引对 $(k+1, k+N/2)$。为了计算窦图坐标，它使用这些索引的*名义*位置，即位于角度 $\\theta_{k+1}$ 的 $P_{k+1}$ 和位于角度 $\\theta_{k+N/2}$ 的 $P_{k+N/2}$。\n    -   被错误计算的 LOR 是连接点 $P_{k+1} = (R_d\\cos\\theta_{k+1}, R_d\\sin\\theta_{k+1})$ 和 $P_{k+N/2} = (R_d\\cos\\theta_{k+N/2}, R_d\\sin\\theta_{k+N/2})$ 的线。注意 $\\theta_{k+N/2} = \\theta_k + \\pi$，所以 $P_{k+N/2} = -P_k$。LOR 是为 $P_{k+1}$ 和 $-P_k$ 之间的线计算的。\n\n-   **情况 2：涉及物理探测器在 $\\theta_{k+1}$ 处的事件**\n    一个物理符合事件发生在 $\\theta_{k+1}$ 和 $\\theta_{k+1+N/2}$ 的探测器之间。\n    -   物理位置为 $\\theta_{k+1}$ 的探测器被软件错误地识别为索引 $k$。\n    -   物理位置为 $\\theta_{k+1+N/2}$ 的探测器被正确地识别。\n    -   软件接收到索引对 $(k, k+1+N/2)$，并使用位于 $\\theta_k$ 的名义位置 $P_k$ 和位于 $\\theta_{k+1+N/2}$ 的名义位置 $P_{k+1+N/2}$ 来计算 LOR。注意 $\\theta_{k+1+N/2} = \\theta_{k+1} + \\pi$，所以 $P_{k+1+N/2} = -P_{k+1}$。LOR 是为 $P_k$ 和 $-P_{k+1}$ 之间的线计算的。\n\n**3. 错误计算的 LOR 的几何分析**\n\n让我们找出这两条错误计算的 LOR 的 $(s, \\phi)$ 坐标。\n\n法线角度 $\\phi$ 是两个端点位置向量之和的方向。对于平行束窦图，我们关心的是 LOR 法线的角度。这个法向量平行于连接原点和 LOR 中点的向量。\n\n对于情况 1（连接 $P_{k+1}$ 和 $-P_k$ 的线）：\n-   LOR 的方向向量是 $V_1 = P_{k+1} - (-P_k) = P_{k+1} + P_k$。\n-   这条 LOR 的角度是 $\\alpha_1 = \\mathrm{atan2}((P_{k+1}+P_k)_y, (P_{k+1}+P_k)_x)$。计算结果为 $\\frac{\\theta_k + \\theta_{k+1}}{2} = \\theta_k + \\frac{\\Delta\\theta}{2}$。\n-   LOR 法线的角度是 $\\phi_{artifact} = \\alpha_1 + \\pi/2 = \\theta_k + \\frac{\\Delta\\theta}{2} + \\frac{\\pi}{2}$。\n\n对于情况 2（连接 $P_k$ 和 $-P_{k+1}$ 的线）：\n-   LOR 的方向向量是 $V_2 = P_k - (-P_{k+1}) = P_k + P_{k+1} = V_1$。\n-   这两条错误计算的 LOR 是平行的。因此，它们被分箱到相同的投影角度 $\\phi_{artifact}$。这个角度由两个被交换晶体的角位置的中点决定。$\\theta_k + \\frac{\\Delta\\theta}{2}$ 是平分两个物理上被交换的探测器之间的角度。\n\n现在我们计算有符号径向偏移量 $s$。一条法线角度为 $\\phi$ 且通过点 $(x_p, y_p)$ 的直线的公式是 $s = x_p\\cos\\phi + y_p\\sin\\phi$。\n\n对于情况 1，线通过点 $P_{k+1} = (R_d\\cos\\theta_{k+1}, R_d\\sin\\theta_{k+1})$。\n$$s_1 = R_d\\cos\\theta_{k+1}\\cos\\phi_{artifact} + R_d\\sin\\theta_{k+1}\\sin\\phi_{artifact} = R_d\\cos(\\theta_{k+1} - \\phi_{artifact})$$\n$$s_1 = R_d\\cos\\left( (\\theta_k+\\Delta\\theta) - (\\theta_k + \\frac{\\Delta\\theta}{2} + \\frac{\\pi}{2}) \\right) = R_d\\cos\\left(\\frac{\\Delta\\theta}{2} - \\frac{\\pi}{2}\\right)$$\n使用恒等式 $\\cos(x-\\pi/2) = \\sin(x)$，我们得到：\n$$s_1 = R_d\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)$$\n\n对于情况 2，线通过点 $P_k = (R_d\\cos\\theta_k, R_d\\sin\\theta_k)$。\n$$s_2 = R_d\\cos\\theta_k\\cos\\phi_{artifact} + R_d\\sin\\theta_k\\sin\\phi_{artifact} = R_d\\cos(\\theta_k - \\phi_{artifact})$$\n$$s_2 = R_d\\cos\\left( \\theta_k - (\\theta_k + \\frac{\\Delta\\theta}{2} + \\frac{\\pi}{2}) \\right) = R_d\\cos\\left(-\\frac{\\Delta\\theta}{2} - \\frac{\\pi}{2}\\right)$$\n使用恒等式 $\\cos(-x-\\pi/2) = -\\sin(x)$，我们得到：\n$$s_2 = -R_d\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)$$\n\n**伪影总结：** 交换创建了两组被错误分箱的事件。两者都出现在相同的投影角度 $\\phi_{artifact} = \\theta_k + \\frac{\\Delta\\theta}{2} + \\frac{\\pi}{2}$。然而，它们出现在大小相等、符号相反的径向偏移处 $s = \\pm R_d\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)$。在窦图中，这表现为在单个投影角度处的两个亮点（或在高统计量下的短水平线），关于 $s=0$ 线对称，而所有正确分箱的事件都位于 $s=0$ 线上。\n\n**4. 几何测试的设计**\n\n基于以上分析，一个检测和定位此类交换的测试如下：\n1.  使用中心点源采集数据。\n2.  检查窦图中在 $s \\neq 0$ 处是否有任何显著的计数。此类计数的出现表明存在几何失准或探测器映射错误。\n3.  如果发现一对对称的伪影位于 $(s_{art}, \\phi_{art})$ 和 $(-s_{art}, \\phi_{art})$，测量它们的径向偏移量 $|s_{art}|$ 和投影角度 $\\phi_{art}$。\n4.  使用我们分析中导出的公式计算角间距误差 $\\delta$：$|s_{art}| = R_d\\sin(\\delta/2)$，这给出 $\\delta = 2\\arcsin(|s_{art}|/R_d)$。\n5.  如果 $\\delta$ 大约等于 $\\Delta\\theta = 2\\pi/N$，这证实了是一次相邻晶体交换。如果对于某个整数 $m  1$，有 $\\delta \\approx m \\cdot (2\\pi/N)$，这表明是在非相邻晶体 $k$ 和 $k+m$ 之间发生了交换。\n6.  使用测量的角度 $\\phi_{art}$ 来定位交换。从 $\\phi_{art} = \\theta_k + \\frac{\\Delta\\theta}{2} + \\frac{\\pi}{2}$，我们可以解出第一个被交换晶体的角度：$\\theta_k = \\phi_{art} - \\frac{\\pi}{N} - \\frac{\\pi}{2}$。这可以识别出晶体对 $(k, k+1)$。\n\n**5. 数值计算**\n\n给定 $N=624$ 和 $R_d=420\\,\\mathrm{mm}$。\n相邻晶体之间的角间距是 $\\Delta\\theta = \\dfrac{2\\pi}{624}$ 弧度。\n径向偏移的量值是：\n$$|s| = R_d \\sin\\left(\\frac{\\Delta\\theta}{2}\\right) = R_d \\sin\\left(\\frac{\\pi}{N}\\right)$$\n$$|s| = (420\\,\\mathrm{mm}) \\sin\\left(\\frac{\\pi}{624}\\right)$$\n角度 $\\frac{\\pi}{624}$ 很小，所以我们可以使用近似 $\\sin(x) \\approx x$（其中 $x$ 为弧度）。\n$$|s| \\approx (420\\,\\mathrm{mm}) \\left(\\frac{\\pi}{624}\\right) \\approx \\frac{420 \\times 3.14159265}{624} \\approx 2.1145\\,\\mathrm{mm}$$\n使用计算器计算正弦函数：\n$$|s| = 420 \\times \\sin(\\pi/624) \\approx 420 \\times 0.00503456 \\approx 2.1145\\,\\mathrm{mm}$$\n该值可以非常精确地近似为 $2.11\\,\\mathrm{mm}$。\n\n### 逐项分析选项\n\n**A. 对于中心点源，该交换在单个投影角度 $\\phi$（等于被错误计算的晶体对的角平分线）处，在 $s=\\pm R_d\\sin\\!\\left(\\dfrac{\\Delta\\theta}{2}\\right)$ 位置导致一条细长的水平带，其中 $\\Delta\\theta=\\dfrac{2\\pi}{N}$。通过测量该带的非零 $|s|$ 来进行检测和定位，计算 $\\delta=2\\arcsin\\!\\left(\\dfrac{|s|}{R_d}\\right)$，验证 $\\delta\\approx \\dfrac{2\\pi}{N}$（相邻交换），并读取 $\\phi$ 来识别被交换的晶体对。对于 $N=624$ 和 $R_d=420\\,\\mathrm{mm}$， $|s|\\approx 2.11\\,\\mathrm{mm}$。**\n\n-   **伪影特征描述**：关于在单个 $\\phi$ 和偏移量 $s = \\pm R_d\\sin(\\Delta\\theta/2)$ 处出现两个伪影的描述是正确的。对 $\\phi$ 的描述略有不精确，但与物理原理一致。\n-   **检测/定位程序**：所提出的方法正是从第一性原理推导出的几何测试。\n-   **数值**：计算出的值 $|s| \\approx 2.11\\,\\mathrm{mm}$ 与推导相符。\n-   **结论**：**正确**。\n\n**B. 对于中心点源，该交换在一个随机的 $\\phi$ 处生成一个跨越所有 $s$ 的垂直条纹。检测需要将点源移离中心以产生正弦曲线；在中心处没有伪影，所以 $|s|=0\\,\\mathrm{mm}$。**\n\n-   **伪影特征描述**：垂直条纹是不正确的；伪影局限在单个 $\\phi$。它不是随机的。\n-   **检测**：中心处没有伪影的说法是错误的。中心源是检测的理想选择，因为伪影的非零 $s$ 值在 $s=0$ 的信号背景下会非常突出。\n-   **数值**：$|s|=0\\,\\mathrm{mm}$ 是不正确的。\n-   **结论**：**不正确**。\n\n**C. 该交换将所有投影角度全局性地移动 $\\dfrac{\\Delta\\theta}{2}$，为中心点源产生一个相移的正弦曲线。通过测量一个横跨所有 $\\phi$ 的均匀相位偏移来检测；对于任何 $N$，预测的 $|s|$ 都等于 $R_d$。**\n\n-   **伪影特征描述**：这种影响不是全局性的；它局限于涉及被交换晶体的 LOR。中心点源不会产生正弦曲线。\n-   **数值**：$|s| = R_d$ 是不正确的。\n-   **结论**：**不正确**。\n\n**D. 该交换在窦图中引入没有几何结构的随机散斑。检测需要飞行时间（TOF）计时来分离索引错误的事件；$|s|$ 无法从 $N$ 和 $R_d$ 预测。**\n\n-   **伪影特征描述**：该伪影不是随机散斑；它具有一个非常特定且可预测的几何结构。\n-   **检测**：不需要 TOF；该错误纯粹是几何性质的。\n-   **预测**：如前所示，|s| 可以从第一性原理预测。\n-   **结论**：**不正确**。\n\n基于详细分析，选项 A 提供了对伪影的完整且正确的描述，一个有效的检测和定位程序，以及正确的数值。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "最后，我们来探讨一项极大地提升了 PET 性能的先进技术：飞行时间 (Time-of-Flight, TOF) PET。TOF 技术的优势在于，它利用湮没光子到达探测器的时间差，来更精确地定位沿 LOR 发生的湮没事件的位置。这项练习将让你通过具体计算，建立起关键硬件指标（时间分辨率）与其对图像质量的直接影响（空间定位精度）之间的联系，从而能够量化 TOF 技术的强大之处。",
            "id": "4907332",
            "problem": "一个飞行时间正电子发射断层扫描（TOF-PET）系统测量沿单条响应线（LOR）的两个相反方向的探测器上，两个 $511\\,\\text{keV}$ 湮没光子到达时间的差异。假设符合计时不确定度可以被建模为一个高斯随机变量，其时间上的半高全宽（FWHM）为 $FWHM_t = 300\\,\\text{ps}$。使用以下基本事实：(i) 两个湮没光子都以光速 $c$ 传播，以及 (ii) 两个探测器之间的到达时间差仅由沿 LOR 传播的路径长度差决定。高斯分布的半高全宽（FWHM）和标准差 $\\sigma$ 是相关的，但在推导出具体换算关系之前，不要假定任何特定的换算。\n\n从这些原理出发，推导从计时不确定度到沿 LOR 的空间不确定度的映射关系。然后计算：\n- 沿 LOR 的空间半高全宽 $FWHM_x$（以毫米为单位），以及\n- 相应的空间标准差 $\\sigma_x$（以毫米为单位），\n\n对于给定的 $FWHM_t$。使用 $c = 2.99792458 \\times 10^8\\ \\text{m/s}$。将 $FWHM_x$ 和 $\\sigma_x$ 两者均四舍五入到4位有效数字。将两个结果都以毫米表示。在答案中仅提供最终的数值（不带单位）。",
            "solution": "该问题是有效的，因为它在科学上基于正电子发射断层扫描（PET）的原理，问题陈述清晰且包含了所有必要信息，并以客观、正式的语言表述。我们可以开始解题。\n\n飞行时间（TOF）PET 的核心原理是利用两个湮没光子的到达时间差来更精确地估计湮没事件沿响应线（LOR）的位置。设 LOR 为一维坐标轴。设两个探测器之间的中点为原点 $x=0$。一个湮没事件发生在该轴上的未知位置 $x$ 处。\n\n当事件发生在 $x$ 位置时，一个光子传播距离 $d_1$ 到达第一个探测器，另一个光子传播距离 $d_2$ 到达第二个探测器。位置 $x$ 表示相对于 LOR 中心的位移。这个位移意味着，相比于发生在中心的事件，一个光子的路径缩短了长度 $|x|$，而另一个光子的路径则延长了相同的长度。因此，两个光子传播的路径长度差为 $\\Delta l = 2|x|$。为简化起见，我们定义 $x$ 的符号，使得路径差为 $\\Delta l = 2x$。\n\n两个光子同时产生并以光速 $c$ 传播。它们到达探测器的时间差 $\\Delta t$ 与路径长度差成正比：\n$$ \\Delta t = \\frac{\\Delta l}{c} $$\n代入 $\\Delta l$ 的表达式，我们得到：\n$$ \\Delta t = \\frac{2x}{c} $$\n这个方程可以重新整理，以根据测量到的时间差 $\\Delta t$ 来求出事件的位置 $x$：\n$$ x = \\frac{c}{2} \\Delta t $$\n这个方程表示了从测量到的计时差异到事件沿 LOR 的空间位置的映射关系。\n\n题目指出，对 $\\Delta t$ 的测量存在计时不确定度，该不确定度被建模为半高全宽（FWHM）为 $FWHM_t$ 的高斯随机变量。由于 $x$ 和 $\\Delta t$ 之间的关系是线性的，因此位置 $x$ 的不确定度也将服从高斯分布。位置的不确定度，以其 FWHM $FWHM_x$ 为特征，通过相同的线性因子与计时不确定度 $FWHM_t$ 相关联：\n$$ FWHM_x = \\frac{c}{2} FWHM_t $$\n这就是推导出的从计时不确定度到沿 LOR 的空间不确定度的映射关系。\n\n接下来，我们必须推导高斯分布的 FWHM 与标准差 $\\sigma$ 之间的关系。高斯概率密度函数由下式给出：\n$$ f(y) = A \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right) $$\n其中 $\\mu$ 是均值，$\\sigma$ 是标准差，A 是归一化常数。函数的最大值为 $f(\\mu) = A$。FWHM 是分布在最大值一半处（即高度为 $A/2$ 处）的宽度。我们找到使 $f(y) = A/2$ 成立的点 $y$：\n$$ \\frac{A}{2} = A \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right) $$\n$$ \\frac{1}{2} = \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right) $$\n对两边取自然对数：\n$$ \\ln\\left(\\frac{1}{2}\\right) = -\\frac{(y-\\mu)^2}{2\\sigma^2} $$\n$$ -\\ln(2) = -\\frac{(y-\\mu)^2}{2\\sigma^2} $$\n$$ (y-\\mu)^2 = 2\\sigma^2\\ln(2) $$\n$$ |y-\\mu| = \\sigma\\sqrt{2\\ln(2)} $$\n这两个点是 $y_1 = \\mu - \\sigma\\sqrt{2\\ln(2)}$ 和 $y_2 = \\mu + \\sigma\\sqrt{2\\ln(2)}$。FWHM 是这两点之间的距离：\n$$ FWHM = y_2 - y_1 = (\\mu + \\sigma\\sqrt{2\\ln(2)}) - (\\mu - \\sigma\\sqrt{2\\ln(2)}) = 2\\sigma\\sqrt{2\\ln(2)} $$\n这个关系式 $FWHM = \\sigma \\cdot 2\\sqrt{2\\ln(2)}$ 对任何高斯分布都成立，包括计时不确定度和空间不确定度。\n\n现在我们可以计算所需的数值。给定的数据是：\n计时 FWHM: $FWHM_t = 300\\ \\text{ps} = 300 \\times 10^{-12}\\ \\text{s} = 3 \\times 10^{-10}\\ \\text{s}$。\n光速: $c = 2.99792458 \\times 10^8\\ \\text{m/s}$。\n\n首先，我们计算空间 FWHM，$FWHM_x$：\n$$ FWHM_x = \\frac{c}{2} FWHM_t = \\frac{2.99792458 \\times 10^8\\ \\text{m/s}}{2} \\times (3 \\times 10^{-10}\\ \\text{s}) $$\n$$ FWHM_x = (1.49896229 \\times 10^8\\ \\text{m/s}) \\times (3 \\times 10^{-10}\\ \\text{s}) = 0.0449688687\\ \\text{m} $$\n为了以毫米表示结果，我们乘以 $1000$：\n$$ FWHM_x = 0.0449688687\\ \\text{m} \\times 1000\\ \\text{mm/m} = 44.9688687\\ \\text{mm} $$\n四舍五入到4位有效数字，我们得到：\n$$ FWHM_x \\approx 44.97\\ \\text{mm} $$\n\n接下来，我们使用推导出的关系式计算相应的空间标准差 $\\sigma_x$：\n$$ \\sigma_x = \\frac{FWHM_x}{2\\sqrt{2\\ln(2)}} $$\n为确保精度，使用未四舍五入的 $FWHM_x$ 值：\n$$ \\sigma_x = \\frac{44.9688687\\ \\text{mm}}{2\\sqrt{2\\ln(2)}} \\approx \\frac{44.9688687\\ \\text{mm}}{2.354820045} \\approx 19.096530\\ \\text{mm} $$\n四舍五入到4位有效数字，我们得到：\n$$ \\sigma_x \\approx 19.10\\ \\text{mm} $$",
            "answer": "$$\\boxed{\\begin{pmatrix} 44.97  19.10 \\end{pmatrix}}$$"
        }
    ]
}