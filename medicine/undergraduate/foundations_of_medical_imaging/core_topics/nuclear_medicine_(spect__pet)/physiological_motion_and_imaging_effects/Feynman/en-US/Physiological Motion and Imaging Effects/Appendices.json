{
    "hands_on_practices": [
        {
            "introduction": "Physiological motion, such as breathing, is a primary source of artifacts in medical imaging. To understand its impact, we can model this motion and calculate the displacement that occurs during a data acquisition window. This exercise  provides a tangible link between a simple sinusoidal model of respiration and the resulting image blur in Computed Tomography (CT), helping to quantify the scale of the problem.",
            "id": "4911791",
            "problem": "A patient’s superior–inferior diaphragm motion during normal breathing is modeled as a sinusoid. The respiration rate is $12\\,\\text{breaths}\\,\\text{min}^{-1}$, and the diaphragm peak-to-peak excursion is $20\\,\\text{mm}$. The position is modeled by $x(t)=10\\sin(2\\pi f t)$ in millimeters, where $f$ is the breathing frequency and the argument of the sine is in radians. During a single rotation of a Computed Tomography (CT) gantry lasting $\\Delta t=0.3\\,\\text{s}$, the acquisition integrates over this time window, effectively averaging the signal while the diaphragm moves.\n\nAssuming the start phase of the motion at the beginning of the gantry rotation is unknown, compute the maximum possible displacement magnitude of the diaphragm between the beginning and end of the rotation, defined as $|\\Delta x|_{\\max}=\\max_{t}\\,|x(t+\\Delta t)-x(t)|$. Use the given sinusoidal model, express the final numerical result in $\\text{mm}$, and round your answer to four significant figures. Angles must be treated in radians. Briefly explain, in words, the implications of this motion for image blur during CT acquisition.",
            "solution": "The problem statement will first be validated according to the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Patient's superior–inferior diaphragm motion model: Sinusoidal.\n- Respiration rate: $12\\,\\text{breaths}\\,\\text{min}^{-1}$.\n- Diaphragm peak-to-peak excursion: $20\\,\\text{mm}$.\n- Position model: $x(t) = 10\\sin(2\\pi f t)$, in millimeters.\n- Independent variable $t$: time.\n- Parameter $f$: breathing frequency.\n- CT acquisition time window: $\\Delta t = 0.3\\,\\text{s}$.\n- Quantity to compute: The maximum possible displacement magnitude, defined as $|\\Delta x|_{\\max} = \\max_{t}\\,|x(t+\\Delta t) - x(t)|$.\n- Output requirements: Numerical result in $\\text{mm}$, rounded to four significant figures, and a brief explanation of the implications for image blur.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on established principles of physiological motion and medical imaging (specifically, CT). Modeling respiratory motion as a sinusoid is a common and valid first-order approximation. The given values for respiration rate ($12\\,\\text{breaths/min}$ is a typical resting rate) and diaphragm excursion ($20\\,\\text{mm}$ peak-to-peak is within the normal physiological range) are realistic. The concept of signal integration over an acquisition window is fundamental to CT and other imaging modalities.\n- **Well-Posed:** The problem is mathematically well-posed. It asks for the maximum of a well-defined, continuous, and bounded function over all possible start times $t$. All necessary parameters are provided or can be derived from the givens. The amplitude of the model, $10\\,\\text{mm}$, is consistent with the peak-to-peak excursion of $20\\,\\text{mm}$. A unique, stable solution exists.\n- **Objective:** The problem is stated using clear, objective language and precise mathematical definitions.\n\nThe problem does not exhibit any of the flaws listed in the instructions (e.g., scientific unsoundness, missing information, ambiguity). The setup is self-contained, consistent, and scientifically plausible.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe goal is to compute the maximum possible displacement of the diaphragm, $|\\Delta x|_{\\max}$, during a CT acquisition window of duration $\\Delta t$.\n\nFirst, we determine the breathing frequency, $f$, and the angular frequency, $\\omega$. The respiration rate is given as $12$ breaths per minute. To convert this to Hertz (cycles per second), we perform the following conversion:\n$$f = \\frac{12\\,\\text{breaths}}{1\\,\\text{min}} \\times \\frac{1\\,\\text{min}}{60\\,\\text{s}} = 0.2\\,\\text{Hz}$$\nThe angular frequency $\\omega$ is related to the frequency $f$ by $\\omega = 2\\pi f$.\n$$\\omega = 2\\pi (0.2\\,\\text{s}^{-1}) = 0.4\\pi\\,\\text{rad s}^{-1}$$\n\nThe position of the diaphragm as a function of time $t$ is given by the model:\n$$x(t) = A\\sin(\\omega t)$$\nwhere the amplitude is $A = 10\\,\\text{mm}$.\n\nThe displacement of the diaphragm, $\\Delta x$, over a time interval $\\Delta t$ starting at an arbitrary time $t$ is given by the difference between the position at the end and the beginning of the interval:\n$$\\Delta x(t) = x(t+\\Delta t) - x(t)$$\nSubstituting the model for $x(t)$:\n$$\\Delta x(t) = A\\sin(\\omega(t+\\Delta t)) - A\\sin(\\omega t) = A[\\sin(\\omega t + \\omega\\Delta t) - \\sin(\\omega t)]$$\n\nTo find the maximum possible magnitude of this displacement, we need to maximize $|\\Delta x(t)|$ with respect to the start time $t$. We can simplify the expression for $\\Delta x(t)$ using the trigonometric sum-to-product identity:\n$$\\sin(\\alpha) - \\sin(\\beta) = 2\\cos\\left(\\frac{\\alpha+\\beta}{2}\\right)\\sin\\left(\\frac{\\alpha-\\beta}{2}\\right)$$\nLet $\\alpha = \\omega t + \\omega\\Delta t$ and $\\beta = \\omega t$. Then:\n$$\\frac{\\alpha+\\beta}{2} = \\frac{2\\omega t + \\omega\\Delta t}{2} = \\omega t + \\frac{\\omega\\Delta t}{2}$$\n$$\\frac{\\alpha-\\beta}{2} = \\frac{\\omega\\Delta t}{2}$$\nSubstituting these into the identity, the displacement becomes:\n$$\\Delta x(t) = A \\left[ 2\\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right)\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right]$$\n\nWe are interested in the maximum magnitude of this displacement, $|\\Delta x|_{\\max} = \\max_{t}|\\Delta x(t)|$.\n$$|\\Delta x(t)| = \\left| 2A \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right) \\right|$$\nIn this expression, the term $2A\\sin(\\frac{\\omega\\Delta t}{2})$ is constant with respect to the start time $t$. The maximization over $t$ depends only on the cosine term. The maximum absolute value of the cosine function is $1$, which occurs when its argument is an integer multiple of $\\pi$.\n$$\\max_{t} \\left|\\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right)\\right| = 1$$\nTherefore, the maximum possible displacement magnitude is:\n$$|\\Delta x|_{\\max} = \\left| 2A \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right|$$\n\nNow, we substitute the numerical values: $A = 10\\,\\text{mm}$, $\\omega = 0.4\\pi\\,\\text{rad s}^{-1}$, and $\\Delta t = 0.3\\,\\text{s}$.\n$$|\\Delta x|_{\\max} = \\left| 2(10) \\sin\\left(\\frac{(0.4\\pi)(0.3)}{2}\\right) \\right|$$\n$$|\\Delta x|_{\\max} = \\left| 20 \\sin\\left(\\frac{0.12\\pi}{2}\\right) \\right| = |20 \\sin(0.06\\pi)|$$\nThe argument $0.06\\pi$ is in the first quadrant, so its sine is positive.\n$$|\\Delta x|_{\\max} = 20 \\sin(0.06\\pi)$$\nCalculating the numerical value:\n$$|\\Delta x|_{\\max} \\approx 20 \\times \\sin(0.1884955...)$$\n$$|\\Delta x|_{\\max} \\approx 20 \\times 0.1873813...$$\n$$|\\Delta x|_{\\max} \\approx 3.747626...\\,\\text{mm}$$\nRounding the result to four significant figures, as requested:\n$$|\\Delta x|_{\\max} = 3.748\\,\\text{mm}$$\n\n### Implications for Image Blur\n\nThis calculated value, $|\\Delta x|_{\\max} \\approx 3.748\\,\\text{mm}$, represents the maximum possible distance the diaphragm moves in the superior-inferior direction during a single CT gantry rotation (the data acquisition window). CT image reconstruction algorithms assume the object being scanned is stationary during this acquisition. When physiological motion occurs, this assumption is violated. The CT scanner measures X-ray attenuation, and during the $\\Delta t = 0.3\\,\\text{s}$ acquisition, the signal from any given point is effectively an average or integral of the attenuation from all positions occupied by the moving tissue.\n\nThis motion causes features in the image, especially sharp boundaries like the edge of the diaphragm, to appear smeared or blurred. This artifact, known as motion blur or an intra-scan motion artifact, degrades image quality. The extent of the blurring is directly related to the distance the object moves during the scan. The value $|\\Delta x|_{\\max}$ provides a worst-case estimate for the spatial extent of this blurring artifact along the axis of motion. Such blurring can obscure small anatomical details or pathologies, such as nodules in the lung bases or lesions in the liver dome, potentially compromising the diagnostic accuracy of the CT scan.",
            "answer": "$$\n\\boxed{3.748}\n$$"
        },
        {
            "introduction": "Once we understand that motion degrades images, a key strategy is to acquire data only during periods of relative stillness. This technique, known as gating, is common in cardiac imaging but comes with trade-offs in scan time. This practice problem  walks you through the essential time-budgeting calculations for designing a prospectively Electrocardiogram (ECG) gated Magnetic Resonance Imaging (MRI) scan, highlighting the balance between motion-free data and acquisition efficiency.",
            "id": "4911792",
            "problem": "A two-dimensional Cartesian Magnetic Resonance Imaging (MRI) sequence is prospectively Electrocardiogram (ECG) gated to acquire only during a quiescent mid-diastolic window in order to minimize motion artifacts. The subject has a heart rate of $75\\,\\mathrm{bpm}$, and the mid-diastolic quiescent window duration is $80\\,\\mathrm{ms}$. Each repetition time, denoted $\\mathrm{TR}$, is $4\\,\\mathrm{ms}$ and produces one distinct phase-encoding line. One image requires $256$ unique phase-encoding lines. Assume perfect gating, no arrhythmias, and that all lines must be acquired entirely within the quiescent window to be accepted for reconstruction.\n\nUsing only fundamental definitions of heart rate, period, and time-budgeting, determine the following acquisition constraints for motion-free reconstruction segments:\n(i) the maximum number of phase-encoding lines that can be acquired per cardiac cycle,\n(ii) the minimum number of accepted heartbeats required to complete one image,\n(iii) the minimum total acquisition time, expressed in seconds,\n(iv) the fraction of each R–R interval that is available for motion-free acquisition, expressed as a decimal.\n\nReport your answers in the order (i), (ii), (iii), (iv). If any rounding would be required, round to four significant figures; otherwise provide exact values.",
            "solution": "The heart rate is defined as beats per unit time. For a heart rate $HR$ in beats per minute, the duration of one cardiac cycle (the R–R interval) is the period\n$$\nT_{RR} = \\frac{60}{HR}\\,\\mathrm{s}.\n$$\nWith $HR = 75\\,\\mathrm{bpm}$, this gives\n$$\nT_{RR} = \\frac{60}{75} = 0.8\\,\\mathrm{s}.\n$$\nThe quiescent window has duration $T_{w} = 80\\,\\mathrm{ms} = 0.08\\,\\mathrm{s}$. Acquisition is restricted to this window to avoid motion. Each repetition time $\\mathrm{TR} = 4\\,\\mathrm{ms} = 0.004\\,\\mathrm{s}$ yields one phase-encoding line, and to ensure lines are fully within the window, the number of lines per beat is limited by the time budget available.\n\n(i) The maximum number of lines per cardiac cycle is the greatest integer that fits within the window:\n$$\nN_{\\max} = \\left\\lfloor \\frac{T_{w}}{\\mathrm{TR}} \\right\\rfloor = \\left\\lfloor \\frac{0.08}{0.004} \\right\\rfloor = \\left\\lfloor 20 \\right\\rfloor = 20.\n$$\n\n(ii) The image requires $N_{\\mathrm{req}} = 256$ unique phase-encoding lines. The minimum number of accepted heartbeats needed to collect all lines, acquiring $N_{\\max}$ lines per beat, is\n$$\nB_{\\min} = \\left\\lceil \\frac{N_{\\mathrm{req}}}{N_{\\max}} \\right\\rceil = \\left\\lceil \\frac{256}{20} \\right\\rceil = \\left\\lceil 12.8 \\right\\rceil = 13.\n$$\n\n(iii) The minimum total acquisition time assuming every heartbeat contributes its full quota is the product of the number of accepted heartbeats and the R–R interval:\n$$\nT_{\\mathrm{scan,min}} = B_{\\min} \\, T_{RR} = 13 \\times 0.8\\,\\mathrm{s} = 10.4\\,\\mathrm{s}.\n$$\n\n(iv) The fraction of each R–R interval that is motion-free (the duty cycle for accepted acquisition) is the ratio of the window duration to the R–R interval:\n$$\nf = \\frac{T_{w}}{T_{RR}} = \\frac{0.08}{0.8} = 0.1.\n$$\n\nThus, the acquisition constraints are $N_{\\max} = 20$ lines per beat, $B_{\\min} = 13$ heartbeats, $T_{\\mathrm{scan,min}} = 10.4\\,\\mathrm{s}$, and $f = 0.1$.",
            "answer": "$$\\boxed{\\begin{pmatrix}20 & 13 & 10.4 & 0.1\\end{pmatrix}}$$"
        },
        {
            "introduction": "For continuous motion like respiration, gating can be inefficient, so an alternative is to track the motion with a surrogate signal and sort the data afterward. However, this approach relies on accurately measuring the motion, which is governed by the principles of digital signal processing, particularly the Nyquist-Shannon sampling theorem. This advanced exercise  explores the critical pitfall of aliasing, demonstrating how undersampling a respiratory signal can lead to a completely incorrect estimation of the motion and render correction schemes ineffective.",
            "id": "4911807",
            "problem": "A respiratory surrogate signal is produced by periodic diaphragmatic motion that can be approximated near rest by a sinusoid $x(t) = A \\cos(2 \\pi f t + \\phi_{0})$ with true respiratory frequency $f$. The surrogate is recorded uniformly in time by a data acquisition system at sampling frequency $f_{s}$, producing the discrete-time sequence $x[n] = x(n / f_{s})$. In practice, phase-based binning for motion-resolved image reconstruction in modalities such as Computed Tomography (CT) and Magnetic Resonance Imaging (MRI) assumes the surrogate’s discrete-time samples represent a single respiratory cycle progression. \n\nStarting from the definitions of sampling frequency, Nyquist frequency, and the fact that discrete-time sinusoids are periodic in their normalized frequency with period $2\\pi$, derive the expression for the apparent baseband alias frequency $f_{a} \\in [0, f_{s}/2]$ that would be inferred from the sampled sequence when the true respiratory frequency is $f$ and the sampling frequency is $f_{s}$. Then evaluate $f_{a}$ for $f = 0.25 \\text{ Hz}$ and $f_{s} = 0.30 \\text{ Hz}$. Express the final frequency in Hz. Finally, briefly explain the implications of your result for phase-based binning accuracy in motion-resolved image reconstruction.\n\nNo rounding is required. Express the frequency in Hz. Angles, if used in your reasoning, must be expressed in radians.",
            "solution": "The problem statement is assessed to be valid as it is scientifically grounded in the principles of digital signal processing (specifically, the Nyquist-Shannon sampling theorem and aliasing), is mathematically well-posed, and uses objective, precise language. All provided information is self-contained and sufficient for deriving a unique solution.\n\nThe derivation of the apparent alias frequency $f_a$ begins with the continuous-time representation of the respiratory surrogate signal, given as:\n$$x(t) = A \\cos(2 \\pi f t + \\phi_{0})$$\nwhere $f$ is the true respiratory frequency. This signal is sampled uniformly at a sampling frequency $f_s$, which means we evaluate the signal at time instances $t = n / f_s$, where $n$ is an integer sample index. This produces the discrete-time sequence $x[n]$:\n$$x[n] = x(n/f_s) = A \\cos\\left(2 \\pi f \\frac{n}{f_s} + \\phi_{0}\\right) = A \\cos\\left( \\left(2 \\pi \\frac{f}{f_s}\\right) n + \\phi_{0} \\right)$$\nThe term $\\omega_{norm} = 2 \\pi \\frac{f}{f_s}$ is the normalized angular frequency of the discrete-time signal.\n\nA fundamental property of discrete-time sinusoids is their periodicity in the frequency domain. Specifically, a discrete-time complex exponential $e^{j\\omega n}$ is periodic in $\\omega$ with period $2\\pi$, since $$e^{j(\\omega+2\\pi k)n} = e^{j\\omega n} e^{j2\\pi kn} = e^{j\\omega n}$$ for any integer $k$ (since $n$ is also an integer). For a real-valued sinusoid, this implies that two normalized angular frequencies $\\omega$ and $\\omega'$ are indistinguishable if $\\omega' = \\omega + 2\\pi k$ for some integer $k$. Furthermore, due to the even symmetry of the cosine function, $\\cos(\\theta) = \\cos(-\\theta)$, a signal with normalized angular frequency $\\omega$ is also indistinguishable from one with frequency $-\\omega$.\n\nCombining these properties, a true normalized angular frequency $\\omega_{norm} = 2\\pi \\frac{f}{f_s}$ belongs to a larger equivalence class of frequencies $\\{\\pm \\omega_{norm} + 2\\pi k\\}$ for any integer $k \\in \\mathbb{Z}$, all of which produce the identical sampled sequence $x[n]$ (up to a possible phase shift which can be absorbed into $\\phi_0$).\n\nThe apparent baseband frequency, $f_a$, is defined as the unique frequency within the baseband interval $[0, f_s/2]$ that is observationally equivalent to the true frequency $f$. This corresponds to a normalized angular frequency $\\omega_a = 2\\pi \\frac{f_a}{f_s}$ in the interval $[0, \\pi]$. To find this apparent frequency, we must find the frequency in the equivalence class that falls into the baseband. This is equivalent to finding the absolute distance from the true frequency $f$ to the nearest integer multiple of the sampling frequency $f_s$.\n\nThe set of integer multiples of the sampling frequency is $\\{k f_s \\mid k \\in \\mathbb{Z}\\}$. The multiple of $f_s$ that is closest to the true frequency $f$ is given by $k_{nearest} f_s$, where $k_{nearest}$ is the integer closest to the ratio $f/f_s$. This is formally written as $k_{nearest} = \\text{round}(f/f_s)$.\n\nThe apparent frequency $f_a$ is the absolute difference between the true frequency and this nearest spectral replica's center:\n$$f_a = | f - k_{nearest} f_s | = \\left| f - f_s \\cdot \\text{round}\\left(\\frac{f}{f_s}\\right) \\right|$$\nThis expression provides the general formula for the alias frequency in the baseband $[0, f_s/2]$.\n\nNow, we evaluate this expression for the given values: $f = 0.25 \\text{ Hz}$ and $f_s = 0.30 \\text{ Hz}$.\nFirst, we compute the ratio of the frequencies:\n$$\\frac{f}{f_s} = \\frac{0.25}{0.30} = \\frac{25}{30} = \\frac{5}{6} \\approx 0.8333$$\nNext, we round this ratio to the nearest integer:\n$$\\text{round}\\left(\\frac{f}{f_s}\\right) = \\text{round}\\left(\\frac{5}{6}\\right) = 1$$\nSubstituting this into the derived expression for $f_a$:\n$$f_a = \\left| 0.25 - 0.30 \\cdot 1 \\right| = | 0.25 - 0.30 | = |-0.05| = 0.05 \\text{ Hz}$$\nThe Nyquist frequency is $f_{Nyq} = f_s/2 = 0.30/2 = 0.15 \\text{ Hz}$. Since the true frequency $f = 0.25 \\text{ Hz}$ is greater than $f_{Nyq}$, aliasing occurs, as confirmed by our result $f_a \\neq f$.\n\nFinally, we explain the implications of this result for phase-based binning accuracy. Phase-based binning in motion-resolved imaging aims to sort acquired data (e.g., CT projections) into bins corresponding to different phases of the physiological cycle. This is done by estimating the phase from the surrogate signal $x[n]$. The system performing the binning assumes the frequency of the observed surrogate signal is the true respiratory frequency.\n\nIn this case, the system observes an apparent frequency of $f_a = 0.05 \\text{ Hz}$. It will therefore assume the respiratory cycle has a period of $T_a = 1/f_a = 1/0.05 = 20$ seconds. However, the true respiratory period is $T = 1/f = 1/0.25 = 4$ seconds. The binning algorithm is thus operating with a grossly incorrect model of the respiratory period (a $5$-fold error).\n\nThe aliasing also introduces a phase reversal. Since $$\\cos(2\\pi(5/6) n + \\phi_0) = \\cos(2\\pi n - 2\\pi(1/6) n + \\phi_0) = \\cos(-2\\pi(1/6) n + \\phi_0) = \\cos(2\\pi(1/6) n - \\phi_0)$$ the system not only perceives the wrong frequency but also a reversed phase evolution. This means as the diaphragm moves down (inspiration), the algorithm will interpret the signal as if it were moving up (expiration), and vice versa.\n\nConsequently, data acquired during completely different phases of the true respiratory cycle will be incorrectly grouped into the same bin. For example, data from peak inspiration might be mixed with data from end-expiration. This completely undermines the goal of motion-resolved reconstruction, leading to severe motion artifacts, such as blurring and ghosting, in the final binned images. The binning accuracy is not merely reduced; it is rendered entirely invalid, making the reconstructed images unusable for clinical assessment. This demonstrates the critical importance of satisfying the Nyquist criterion ($f_s > 2f$) when designing data acquisition protocols for motion-compensated imaging.",
            "answer": "$$\n\\boxed{0.05}\n$$"
        }
    ]
}