{
    "hands_on_practices": [
        {
            "introduction": "生理运动是医学成像中的一个基本挑战，因为它会在数据采集期间导致图像模糊。本练习提供了一种量化这种效应的具体方法。通过将呼吸运动建模为一个简单的正弦波，您将计算在单次CT机架旋转期间可能发生的最大位移，从而直接估算潜在的图像模糊程度。这个练习将一个关键的生理参数（呼吸）与最终的图像质量问题联系起来。",
            "id": "4911791",
            "problem": "一名患者在正常呼吸期间的上下（头脚方向）膈肌运动被建模为正弦曲线。呼吸频率为 $12\\,\\text{次/分钟}$，膈肌的峰峰偏移值为 $20\\,\\text{mm}$。其位置由模型 $x(t)=10\\sin(2\\pi f t)$（单位为毫米）描述，其中 $f$ 是呼吸频率，正弦函数的参数以弧度为单位。在计算机断层扫描（CT）机架单次旋转（持续时间为 $\\Delta t=0.3\\,\\text{s}$）期间，采集过程在此时间窗口内进行积分，从而在膈肌移动时有效地对信号进行平均。\n\n假设机架旋转开始时的运动起始相位未知，计算在旋转开始和结束之间膈肌可能的最大位移大小，定义为 $|\\Delta x|_{\\max}=\\max_{t}\\,|x(t+\\Delta t)-x(t)|$。使用给定的正弦模型，以 $\\text{mm}$ 为单位表示最终数值结果，并将答案四舍五入至四位有效数字。角度必须以弧度处理。简要地用文字解释此运动对CT采集中图像模糊的影响。",
            "solution": "首先将根据指定标准对问题陈述进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 患者上下膈肌运动模型：正弦曲线。\n- 呼吸频率：$12\\,\\text{次/分钟}$。\n- 膈肌峰峰偏移值：$20\\,\\text{mm}$。\n- 位置模型：$x(t) = 10\\sin(2\\pi f t)$，单位为毫米。\n- 自变量 $t$：时间。\n- 参数 $f$：呼吸频率。\n- CT采集时间窗口：$\\Delta t = 0.3\\,\\text{s}$。\n- 待计算量：可能的最大位移大小，定义为 $|\\Delta x|_{\\max} = \\max_{t}\\,|x(t+\\Delta t) - x(t)|$。\n- 输出要求：以 $\\text{mm}$ 为单位的数值结果，四舍五入至四位有效数字，并简要解释其对图像模糊的影响。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于生理运动和医学成像（特别是CT）的既定原理。将呼吸运动建模为正弦曲线是一种常见且有效的一阶近似。给定的呼吸频率值（$12\\,\\text{次/分钟}$ 是典型的静息频率）和膈肌偏移值（$20\\,\\text{mm}$ 的峰峰值在正常生理范围内）是符合实际的。在采集窗口内进行信号积分的概念是CT和其他成像方式的基础。\n- **适定性：** 该问题在数学上是适定的。它要求计算一个在所有可能的开始时间 $t$ 上有明确定义、连续且有界的函数的最大值。所有必需的参数均已提供或可从已知条件中导出。模型的振幅 $10\\,\\text{mm}$ 与 $20\\,\\text{mm}$ 的峰峰偏移值一致。存在唯一且稳定的解。\n- **客观性：** 问题陈述使用了清晰、客观的语言和精确的数学定义。\n\n该问题没有说明中列出的任何缺陷（例如，科学上不健全、信息缺失、含糊不清）。问题设定是自洽、一致且科学上合理的。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n### 解题推导\n\n目标是计算在持续时间为 $\\Delta t$ 的CT采集窗口期间，膈肌可能的最大位移 $|\\Delta x|_{\\max}$。\n\n首先，我们确定呼吸频率 $f$ 和角频率 $\\omega$。给定的呼吸频率为每分钟12次。为了将其转换为赫兹（Hz，即周期/秒），我们进行以下换算：\n$$f = \\frac{12\\,\\text{breaths}}{1\\,\\text{min}} \\times \\frac{1\\,\\text{min}}{60\\,\\text{s}} = 0.2\\,\\text{Hz}$$\n角频率 $\\omega$ 与频率 $f$ 的关系为 $\\omega = 2\\pi f$。\n$$\\omega = 2\\pi (0.2\\,\\text{s}^{-1}) = 0.4\\pi\\,\\text{rad s}^{-1}$$\n\n膈肌位置随时间 $t$ 变化的函数由以下模型给出：\n$$x(t) = A\\sin(\\omega t)$$\n其中振幅为 $A = 10\\,\\text{mm}$。\n\n在从任意时间 $t$ 开始的 $\\Delta t$ 时间间隔内，膈肌的位移 $\\Delta x$ 由该时间间隔结束和开始时的位置之差给出：\n$$\\Delta x(t) = x(t+\\Delta t) - x(t)$$\n代入 $x(t)$ 的模型：\n$$\\Delta x(t) = A\\sin(\\omega(t+\\Delta t)) - A\\sin(\\omega t) = A[\\sin(\\omega t + \\omega\\Delta t) - \\sin(\\omega t)]$$\n\n为了找到该位移的最大可能大小，我们需要对 $|\\Delta x(t)|$ 关于开始时间 $t$ 求最大值。我们可以使用三角函数的和差化积公式来简化 $\\Delta x(t)$ 的表达式：\n$$\\sin(\\alpha) - \\sin(\\beta) = 2\\cos\\left(\\frac{\\alpha+\\beta}{2}\\right)\\sin\\left(\\frac{\\alpha-\\beta}{2}\\right)$$\n令 $\\alpha = \\omega t + \\omega\\Delta t$ 且 $\\beta = \\omega t$。则：\n$$\\frac{\\alpha+\\beta}{2} = \\frac{2\\omega t + \\omega\\Delta t}{2} = \\omega t + \\frac{\\omega\\Delta t}{2}$$\n$$\\frac{\\alpha-\\beta}{2} = \\frac{\\omega\\Delta t}{2}$$\n将这些代入恒等式，位移变为：\n$$\\Delta x(t) = A \\left[ 2\\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right)\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right]$$\n\n我们关心的是该位移的最大大小，即 $|\\Delta x|_{\\max} = \\max_{t}|\\Delta x(t)|$。\n$$|\\Delta x(t)| = \\left| 2A \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right) \\right|$$\n在此表达式中，项 $2A\\sin(\\frac{\\omega\\Delta t}{2})$ 相对于开始时间 $t$ 是一个常数。对 $t$ 的最大化仅取决于余弦项。余弦函数的最大绝对值为 $1$，当其参数是 $\\pi$ 的整数倍时取得。\n$$\\max_{t} \\left|\\cos\\left(\\omega t + \\frac{\\omega\\Delta t}{2}\\right)\\right| = 1$$\n因此，可能的最大位移大小为：\n$$|\\Delta x|_{\\max} = \\left| 2A \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right|$$\n\n现在，我们代入数值：$A = 10\\,\\text{mm}$，$\\omega = 0.4\\pi\\,\\text{rad s}^{-1}$，以及 $\\Delta t = 0.3\\,\\text{s}$。\n$$|\\Delta x|_{\\max} = \\left| 2(10) \\sin\\left(\\frac{(0.4\\pi)(0.3)}{2}\\right) \\right|$$\n$$|\\Delta x|_{\\max} = \\left| 20 \\sin\\left(\\frac{0.12\\pi}{2}\\right) \\right| = |20 \\sin(0.06\\pi)|$$\n参数 $0.06\\pi$ 在第一象限，因此其正弦值为正。\n$$|\\Delta x|_{\\max} = 20 \\sin(0.06\\pi)$$\n计算数值结果：\n$$|\\Delta x|_{\\max} \\approx 20 \\times \\sin(0.1884955...)$$\n$$|\\Delta x|_{\\max} \\approx 20 \\times 0.1873813...$$\n$$|\\Delta x|_{\\max} \\approx 3.747626...\\,\\text{mm}$$\n根据要求，将结果四舍五入至四位有效数字：\n$$|\\Delta x|_{\\max} = 3.748\\,\\text{mm}$$\n\n### 对图像模糊的影响\n\n这个计算出的值 $|\\Delta x|_{\\max} \\approx 3.748\\,\\text{mm}$，代表了在单次CT机架旋转（即数据采集窗口）期间，膈肌在上下方向上可能移动的最大距离。CT图像重建算法假定被扫描的物体在采集期间是静止的。当发生生理运动时，这个假设就被违背了。CT扫描仪测量X射线衰减，在 $\\Delta t = 0.3\\,\\text{s}$ 的采集期间，来自任何给定点的信号实际上是运动组织所占据的所有位置的衰减值的平均或积分。\n\n这种运动导致图像中的特征，特别是像膈肌边缘这样的清晰边界，出现拖影或模糊。这种伪影被称为运动伪影或扫描内运动伪影，它会降低图像质量。模糊的程度与物体在扫描期间移动的距离直接相关。$|\\Delta x|_{\\max}$ 的值提供了该运动轴向上模糊伪影空间范围的最坏情况估计。这种模糊可能会掩盖微小的解剖细节或病理，例如肺底的结节或肝顶的病变，从而可能影响CT扫描的诊断准确性。",
            "answer": "$$\n\\boxed{3.748}\n$$"
        },
        {
            "introduction": "为了应对生理运动，我们可以采用“门控”采集等主动策略。与仅仅量化运动伪影不同，本练习侧重于设计一种解决方案，即仅在心动周期的“静止”窗口内采集数据。这项任务挑战您像MRI技师一样思考，进行必要的时间规划计算，以在可接受的总扫描时间与获得无运动伪影的高质量心脏图像之间取得平衡。",
            "id": "4911792",
            "problem": "一个二维笛卡尔磁共振成像（MRI）序列采用前瞻性心电图（ECG）门控，仅在静止的舒张中期窗口进行数据采集，以最小化运动伪影。受试者的心率为 $75\\,\\mathrm{bpm}$，舒张中期的静止窗口持续时间为 $80\\,\\mathrm{ms}$。每个重复时间（记为 $\\mathrm{TR}$）为 $4\\,\\mathrm{ms}$，并产生一条唯一的相位编码线。一幅图像需要 $256$ 条唯一的相位编码线。假设门控是完美的，没有心律失常，并且所有的数据线都必须完全在静止窗口内采集才能被接受用于重建。\n\n仅使用心率、周期和时间预算的基本定义，确定用于无运动重建片段的以下采集约束条件：\n(i) 每个心动周期可以采集的最大相位编码线数，\n(ii) 完成一幅图像所需的最少有效心跳次数，\n(iii) 最短总采集时间，以秒为单位，\n(iv) 每个R–R间期中可用于无运动采集的部分所占的比例，以小数表示。\n\n按 (i)、(ii)、(iii)、(iv) 的顺序报告你的答案。如果需要四舍五入，则保留四位有效数字；否则提供精确值。",
            "solution": "心率定义为单位时间内的心跳次数。对于以每分钟心跳数（bpm）表示的心率 $HR$，一个心动周期（R-R间期）的持续时间为周期\n$$\nT_{RR} = \\frac{60}{HR}\\,\\mathrm{s}.\n$$\n当 $HR = 75\\,\\mathrm{bpm}$ 时，可得\n$$\nT_{RR} = \\frac{60}{75} = 0.8\\,\\mathrm{s}.\n$$\n静止窗口的持续时间为 $T_{w} = 80\\,\\mathrm{ms} = 0.08\\,\\mathrm{s}$。采集被限制在该窗口内以避免运动。每个重复时间 $\\mathrm{TR} = 4\\,\\mathrm{ms} = 0.004\\,\\mathrm{s}$ 产生一条相位编码线，并且为了确保数据线完全位于窗口内，每次心跳采集的数据线数量受可用时间预算的限制。\n\n(i) 每个心动周期可以采集的最大数据线数是在窗口内容纳的最大整数：\n$$\nN_{\\max} = \\left\\lfloor \\frac{T_{w}}{\\mathrm{TR}} \\right\\rfloor = \\left\\lfloor \\frac{0.08}{0.004} \\right\\rfloor = \\left\\lfloor 20 \\right\\rfloor = 20.\n$$\n\n(ii) 图像需要 $N_{\\mathrm{req}} = 256$ 条唯一的相位编码线。采集所有数据线所需的最少有效心跳次数，即每次心跳采集 $N_{\\max}$ 条数据线，为\n$$\nB_{\\min} = \\left\\lceil \\frac{N_{\\mathrm{req}}}{N_{\\max}} \\right\\rceil = \\left\\lceil \\frac{256}{20} \\right\\rceil = \\left\\lceil 12.8 \\right\\rceil = 13.\n$$\n\n(iii) 假设每次心跳都贡献其全部配额，最短总采集时间是有效心跳次数与R-R间期的乘积：\n$$\nT_{\\mathrm{scan,min}} = B_{\\min} \\, T_{RR} = 13 \\times 0.8\\,\\mathrm{s} = 10.4\\,\\mathrm{s}.\n$$\n\n(iv) 每个R-R间期中无运动的部分（用于有效采集的占空比）是窗口持续时间与R-R间期的比率：\n$$\nf = \\frac{T_{w}}{T_{RR}} = \\frac{0.08}{0.8} = 0.1.\n$$\n\n因此，采集约束条件为：每次心跳采集 $N_{\\max} = 20$ 条数据线，最少心跳次数 $B_{\\min} = 13$ 次，最短扫描时间 $T_{\\mathrm{scan,min}} = 10.4\\,\\mathrm{s}$，以及 $f = 0.1$。",
            "answer": "$$\\boxed{\\begin{pmatrix}20 & 13 & 10.4 & 0.1\\end{pmatrix}}$$"
        },
        {
            "introduction": "先进的运动校正技术通常依赖于追踪一个外部“代理”信号（如呼吸带）来实时了解患者的运动。然而，这一过程也存在潜在的陷阱，本练习将揭示其中最关键的一个：信号混叠。通过分析一个采样率不满足奈奎斯特准则的情景，您将亲手计算出错误的“表观”频率，并理解为什么这种欠采样会导致运动分辨图像重建的灾难性失败。",
            "id": "4911807",
            "problem": "呼吸替代信号由周期性的膈肌运动产生，在接近静止状态时，该运动可以近似为一个正弦波 $x(t) = A \\cos(2 \\pi f t + \\phi_{0})$，其中 $f$ 是真实的呼吸频率。该替代信号由一个数据采集系统以采样频率 $f_{s}$ 在时间上进行均匀记录，从而产生离散时间序列 $x[n] = x(n / f_{s})$。在实践中，诸如计算机断层扫描（CT）和磁共振成像（MRI）等成像模式中，用于运动分辨图像重建的基于相位的分箱方法假定替代信号的离散时间样本代表了单个呼吸周期的进程。\n\n从采样频率、奈奎斯特频率的定义以及离散时间正弦波在其归一化频率上是周期性的（周期为 $2\\pi$）这一事实出发，推导当真实呼吸频率为 $f$ 且采样频率为 $f_{s}$ 时，从采样序列中推断出的表观基带混叠频率 $f_{a} \\in [0, f_{s}/2]$ 的表达式。然后，计算当 $f = 0.25 \\text{ Hz}$ 和 $f_{s} = 0.30 \\text{ Hz}$ 时的 $f_{a}$。以赫兹（Hz）为单位表示最终频率。最后，简要解释您的结果对运动分辨图像重建中基于相位的分箱准确性的影响。\n\n无需四舍五入。以赫兹（Hz）为单位表示频率。如果在您的推理中使用了角度，必须以弧度表示。",
            "solution": "经评估，该问题陈述是有效的，因为它在科学上基于数字信号处理的原理（特别是奈奎斯特-香农采样定理和混叠），在数学上是适定的，并且使用了客观、精确的语言。所有提供的信息都是自洽的，足以推导出唯一的解。\n\n表观混叠频率 $f_a$ 的推导始于呼吸替代信号的连续时间表示，如下所示：\n$$x(t) = A \\cos(2 \\pi f t + \\phi_{0})$$\n其中 $f$ 是真实的呼吸频率。此信号以采样频率 $f_s$ 进行均匀采样，这意味着我们在时间点 $t = n / f_s$（其中 $n$ 是整数采样索引）处对信号进行求值。这产生了离散时间序列 $x[n]$：\n$$x[n] = x(n/f_s) = A \\cos\\left(2 \\pi f \\frac{n}{f_s} + \\phi_{0}\\right) = A \\cos\\left( \\left(2 \\pi \\frac{f}{f_s}\\right) n + \\phi_{0} \\right)$$\n项 $\\omega_{norm} = 2 \\pi \\frac{f}{f_s}$ 是离散时间信号的归一化角频率。\n\n离散时间正弦波的一个基本性质是其在频域上的周期性。具体来说，一个离散时间复指数 $e^{j\\omega n}$ 在 $\\omega$ 上是周期的，周期为 $2\\pi$，因为对于任何整数 $k$（因为 $n$ 也是整数），都有 $e^{j(\\omega+2\\pi k)n} = e^{j\\omega n} e^{j2\\pi kn} = e^{j\\omega n}$。对于实值正弦波，这意味着如果 $\\omega' = \\omega + 2\\pi k$（对于某个整数 $k$），则两个归一化角频率 $\\omega$ 和 $\\omega'$ 是不可区分的。此外，由于余弦函数的偶对称性，$\\cos(\\theta) = \\cos(-\\theta)$，一个归一化角频率为 $\\omega$ 的信号也与一个频率为 $-\\omega$ 的信号不可区分。\n\n结合这些性质，一个真实的归一化角频率 $\\omega_{norm} = 2\\pi \\frac{f}{f_s}$ 属于一个更大的频率等价类 $\\{\\pm \\omega_{norm} + 2\\pi k\\}$（对于任何整数 $k \\in \\mathbb{Z}$），所有这些频率都会产生相同的采样序列 $x[n]$（最多相差一个可以被吸收到 $\\phi_0$ 中的相位移）。\n\n表观基带频率 $f_a$ 被定义为在基带区间 $[0, f_s/2]$ 内与真实频率 $f$ 在观测上等效的唯一频率。这对应于区间 $[0, \\pi]$ 内的归一化角频率 $\\omega_a = 2\\pi \\frac{f_a}{f_s}$。要找到这个表观频率，我们必须找到等价类中落入基带的那个频率。这等同于找到真实频率 $f$ 与采样频率 $f_s$ 最近的整数倍之间的绝对距离。\n\n采样频率的整数倍集合是 $\\{k f_s \\mid k \\in \\mathbb{Z}\\}$。与真实频率 $f$ 最接近的 $f_s$ 的倍数由 $k_{nearest} f_s$ 给出，其中 $k_{nearest}$ 是与比率 $f/f_s$ 最接近的整数。这可以形式化地写为 $k_{nearest} = \\text{round}(f/f_s)$。\n\n表观频率 $f_a$ 是真实频率与这个最近的频谱副本中心之间的绝对差：\n$$f_a = | f - k_{nearest} f_s | = \\left| f - f_s \\cdot \\text{round}\\left(\\frac{f}{f_s}\\right) \\right|$$\n此表达式提供了基带 $[0, f_s/2]$ 内混叠频率的通用公式。\n\n现在，我们用给定的值来计算这个表达式：$f = 0.25 \\text{ Hz}$ 和 $f_s = 0.30 \\text{ Hz}$。\n首先，我们计算频率之比：\n$$\\frac{f}{f_s} = \\frac{0.25}{0.30} = \\frac{25}{30} = \\frac{5}{6} \\approx 0.8333$$\n接下来，我们将此比率四舍五入到最近的整数：\n$$\\text{round}\\left(\\frac{f}{f_s}\\right) = \\text{round}\\left(\\frac{5}{6}\\right) = 1$$\n将此代入推导出的 $f_a$ 表达式中：\n$$f_a = \\left| 0.25 - 0.30 \\cdot 1 \\right| = | 0.25 - 0.30 | = |-0.05| = 0.05 \\text{ Hz}$$\n奈奎斯特频率为 $f_{Nyq} = f_s/2 = 0.30/2 = 0.15 \\text{ Hz}$。由于真实频率 $f = 0.25 \\text{ Hz}$ 大于 $f_{Nyq}$，因此发生了混叠，我们的结果 $f_a \\neq f$ 也证实了这一点。\n\n最后，我们解释这一结果对基于相位的分箱准确性的影响。运动分辨成像中的基于相位的分箱旨在将采集的数据（例如，CT投影）分类到对应于生理周期不同相位的箱中。这是通过从替代信号 $x[n]$ 估计相位来完成的。执行分箱的系统假定观测到的替代信号的频率就是真实的呼吸频率。\n\n在这种情况下，系统观测到的表观频率为 $f_a = 0.05 \\text{ Hz}$。因此，它会假定呼吸周期的周期为 $T_a = 1/f_a = 1/0.05 = 20$ 秒。然而，真实的呼吸周期是 $T = 1/f = 1/0.25 = 4$ 秒。因此，分箱算法是在一个严重错误的呼吸周期模型（一个5倍的误差）下运行的。\n\n混叠还会引入相位反转。真实的归一化角频率是 $2\\pi(5/6)$，而表观频率对应于 $2\\pi(1/6)$。由于 $\\cos(2\\pi(5/6) n + \\phi_0) = \\cos(2\\pi n - 2\\pi(1/6) n + \\phi_0) = \\cos(-2\\pi(1/6) n + \\phi_0) = \\cos(2\\pi(1/6) n - \\phi_0)$，系统不仅感知到错误的频率，还会感知到反转的相位演变。这意味着当膈肌向下移动（吸气）时，算法会将其解释为向上移动（呼气），反之亦然。\n\n因此，在真实呼吸周期的完全不同阶段采集的数据将被错误地分到同一个箱中。例如，来自吸气峰值的数据可能与来自呼气末期的数据混合在一起。这完全破坏了运动分辨重建的目标，导致最终分箱图像中出现严重的运动伪影，如模糊和鬼影。分箱的准确性不仅是降低了，而是变得完全无效，使得重建的图像无法用于临床评估。这表明，在为运动补偿成像设计数据采集协议时，满足奈奎斯特准则（$f_s > 2f$）是至关重要的。",
            "answer": "$$\n\\boxed{0.05}\n$$"
        }
    ]
}