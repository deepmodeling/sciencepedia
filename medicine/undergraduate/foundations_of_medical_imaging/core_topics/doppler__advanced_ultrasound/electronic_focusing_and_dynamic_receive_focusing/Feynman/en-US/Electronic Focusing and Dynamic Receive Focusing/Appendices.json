{
    "hands_on_practices": [
        {
            "introduction": "The foundation of electronic focusing is the precise control over the timing of signals sent to each element of an ultrasound array. By introducing tiny, calculated delays between adjacent elements, we can constructively interfere their emitted waves to form a beam that is steered in a specific direction. This first practice invites you to derive these delays from first principles, solidifying your understanding of how geometry and wave physics translate into the electronic commands that guide the ultrasound beam. ",
            "id": "4882907",
            "problem": "A uniform linear ultrasound array lies along the $x$-axis with element pitch $p = 0.3\\ \\text{mm}$. The medium is homogeneous soft tissue with speed of sound $c = 1540\\ \\text{m/s}$. Consider electronically steering a narrowband transmit beam of center frequency $f = 5\\ \\text{MHz}$ to an angle $\\theta = 20^{\\circ}$ relative to the array normal (the $z$-axis). Using first-principles reasoning from plane-wave propagation and the phase of time-harmonic fields, derive the adjacent-element time-delay increment $\\Delta t$ required to produce a plane wave steered to angle $\\theta$ and the corresponding adjacent-element phase difference $\\phi$ under the narrowband (phase-shift) approximation. Then, based on the derived $\\phi$, determine whether phase wrapping would be needed (i.e., whether $\\phi \\geq 2\\pi$).\n\nYour derivation must begin from the representation of a time-harmonic plane wave $p(\\mathbf{r},t) \\propto \\exp\\!\\big(i(\\mathbf{k}\\cdot \\mathbf{r} - \\omega t)\\big)$, the relation $\\omega = 2\\pi f$, and $\\lVert \\mathbf{k} \\rVert = k = \\omega/c$. Do not assume any focusing law; instead, use fundamental geometry of plane-wave steering to obtain the required inter-element delay law. \n\nCompute the numerical values for $\\Delta t$ and $\\phi$ using the parameters above. Round your numerical answers to four significant figures. Express $\\Delta t$ in nanoseconds and $\\phi$ in radians. Provide your final answer as a two-entry row $\\big[\\Delta t,\\ \\phi\\big]$. Also state whether phase wrapping is needed in your reasoning.",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution. It is a standard problem in the field of medical imaging and acoustics. Therefore, the problem is valid.\n\nWe begin the derivation from first principles. The ultrasound array is a uniform linear array positioned along the $x$-axis, with elements separated by a pitch $p$. We wish to form a plane wave that propagates at an angle $\\theta$ relative to the array normal, which is the $z$-axis.\n\nLet the array elements be indexed by an integer $n$, with the element $n=0$ located at the origin $(x,z)=(0,0)$. The position of the $n$-th element is given by the vector $\\mathbf{r}_n = (np, 0, 0)$.\n\nA plane wave is characterized by its wavefronts, which are surfaces of constant phase. For a plane wave to be steered at an angle $\\theta$ with respect to the $z$-axis, the wavefronts must be planar and oriented perpendicular to the direction of propagation.\n\nConsider a planar wavefront that passes through the origin $(0,0)$ at time $t=0$. For this wavefront to propagate at an angle $\\theta$, the signals emitted by the different array elements must be appropriately timed. Let's analyze the geometric path length difference. The element at $x=p$ (i.e., $n=1$) is at a different position than the element at $x=0$. For a wavefront propagating into the half-space $z0$ at an angle $\\theta$ relative to the $z$-axis, the path length from the element at $x=p$ to the wavefront is shorter than the path length from the element at $x=0$ by an amount $\\Delta L$. This path length difference is given by the geometry:\n$$ \\Delta L = p \\sin(\\theta) $$\nThis is the extra distance the wave from the origin element must travel to reach the same wavefront as the wave from the element at $x=p$. To ensure that the signals from these two elements contribute constructively to this same wavefront, the signal from the element at $x=p$ must be delayed in time relative to the signal from the element at $x=0$. This time delay, which we denote as the adjacent-element time-delay increment $\\Delta t$, must exactly compensate for the travel time over the path difference $\\Delta L$.\nThe time delay is therefore:\n$$ \\Delta t = \\frac{\\Delta L}{c} $$\nwhere $c$ is the speed of sound in the medium. Substituting the expression for $\\Delta L$, we get the formula for the required time delay increment between adjacent elements:\n$$ \\Delta t = \\frac{p \\sin(\\theta)}{c} $$\nFor the $n$-th element at position $x_n = np$, the total delay relative to the element at the origin is $t_n = n \\Delta t$.\n\nUnder the narrowband approximation, the transmitted signal is a time-harmonic wave, which can be represented in complex form as proportional to $\\exp(-i\\omega t)$, where $\\omega$ is the angular frequency. A time delay of $\\Delta t$ corresponds to a phase shift of $\\phi$. A signal delayed by $\\Delta t$ is represented as $\\exp(-i\\omega(t-\\Delta t)) = \\exp(-i\\omega t)\\exp(i\\omega \\Delta t)$. The term $\\exp(i\\omega \\Delta t)$ represents a phase shift $\\phi$.\nThus, the adjacent-element phase difference $\\phi$ is:\n$$ \\phi = \\omega \\Delta t $$\nThe angular frequency $\\omega$ is related to the center frequency $f$ by $\\omega = 2\\pi f$. Substituting this and the expression for $\\Delta t$:\n$$ \\phi = (2\\pi f) \\left( \\frac{p \\sin(\\theta)}{c} \\right) = \\frac{2\\pi f p \\sin(\\theta)}{c} $$\nWe can also express this in terms of the wavenumber $k = \\omega/c = 2\\pi f / c = 2\\pi/\\lambda$, where $\\lambda$ is the wavelength.\n$$ \\phi = k p \\sin(\\theta) $$\nThis completes the derivation of the required formulas.\n\nNow, we compute the numerical values using the given parameters:\n- Element pitch: $p = 0.3\\ \\text{mm} = 0.3 \\times 10^{-3}\\ \\text{m}$\n- Speed of sound: $c = 1540\\ \\text{m/s}$\n- Center frequency: $f = 5\\ \\text{MHz} = 5 \\times 10^6\\ \\text{Hz}$\n- Steering angle: $\\theta = 20^{\\circ}$\n\nFirst, we calculate the adjacent-element time-delay increment $\\Delta t$:\n$$ \\Delta t = \\frac{(0.3 \\times 10^{-3}\\ \\text{m}) \\sin(20^{\\circ})}{1540\\ \\text{m/s}} $$\nUsing $\\sin(20^{\\circ}) \\approx 0.34202$:\n$$ \\Delta t \\approx \\frac{(0.3 \\times 10^{-3}) \\times 0.34202}{1540}\\ \\text{s} \\approx 6.6627 \\times 10^{-8}\\ \\text{s} $$\nThe problem asks for the answer in nanoseconds ($1\\ \\text{ns} = 10^{-9}\\ \\text{s}$).\n$$ \\Delta t \\approx 66.627\\ \\text{ns} $$\nRounding to four significant figures, we get $\\Delta t = 66.63\\ \\text{ns}$.\n\nNext, we calculate the corresponding adjacent-element phase difference $\\phi$:\n$$ \\phi = \\omega \\Delta t = 2\\pi f \\Delta t $$\n$$ \\phi = 2\\pi (5 \\times 10^6\\ \\text{Hz}) (6.6627 \\times 10^{-8}\\ \\text{s}) $$\n$$ \\phi = 10\\pi \\times 10^6 \\times 6.6627 \\times 10^{-8}\\ \\text{rad} = 0.66627\\pi\\ \\text{rad} \\approx 2.0931\\ \\text{rad} $$\nRounding to four significant figures, we get $\\phi = 2.093\\ \\text{rad}$.\n\nFinally, we must determine if phase wrapping is needed. Phase wrapping is required when the calculated phase shift $\\phi$ is greater than or equal to $2\\pi$, as the phase shifters can apply shifts in the range $[0, 2\\pi)$ or $(-\\pi, \\pi]$.\nWe compare our calculated phase shift $\\phi$ to $2\\pi$:\n$$ \\phi \\approx 2.093\\ \\text{rad} $$\n$$ 2\\pi \\approx 2 \\times 3.14159 = 6.283\\ \\text{rad} $$\nSince $2.093  6.283$, we have $\\phi  2\\pi$. Therefore, phase wrapping is not needed for this steering angle and set of parameters.",
            "answer": "$$\\boxed{\\begin{pmatrix} 66.63  2.093 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While electronic steering is powerful, the discrete spacing of transducer elements introduces limitations that can manifest as image artifacts. One of the most significant are grating lobes, which are unwanted copies of the main imaging beam appearing at different angles, potentially creating false structures in an image. This exercise will guide you through the process of predicting when these artifacts will appear and at what angle, based on the fundamental relationship between the array's element pitch and the ultrasound wavelength. ",
            "id": "4882892",
            "problem": "An Ultrasound linear array is used to form a broadside beam in soft tissue using electronic focusing on transmit and dynamic receive focusing on receive. Consider a uniform one-dimensional linear array with element pitch $p$ and identical elements. The medium is homogeneous with sound speed $c$, and the array operates at center frequency $f$, so that the wavelength is $\\lambda$ defined by $\\lambda=c/f$. Broadside focusing means that the progressive electronic delay (phase) applied across the aperture is zero.\n\nStarting from the phase accrued between adjacent elements for a plane wave impinging at an angle $\\theta$ relative to the array normal, derive the condition under which grating lobes appear in the visible region when the array is focused at broadside. If grating lobes are present, determine the smallest positive grating lobe angle $\\theta_{g}$ (relative to broadside). Use the following parameters: $p=0.8\\ \\text{mm}$, $f=3\\ \\text{MHz}$, $c=1540\\ \\text{m/s}$.\n\nExpress your final answer as the value of $\\theta_{g}$ in degrees. If no grating lobe exists, report $\\theta_{g}=0$ degrees. Round your answer to three significant figures and express the angle in degrees.",
            "solution": "A uniform one-dimensional linear array with pitch $p$ and no progressive phase shift (broadside focusing) can be analyzed by considering the phase difference between adjacent elements when a plane wave arrives from an angle $\\theta$ measured relative to the array normal. The wavenumber is $k=2\\pi/\\lambda$, where $\\lambda=c/f$.\n\nFor a plane wave at angle $\\theta$, the path-length difference between adjacent elements is $p\\sin\\theta$. The corresponding phase difference between the received signals at adjacent elements is\n$$\n\\Delta\\phi = k\\,p\\,\\sin\\theta = \\frac{2\\pi}{\\lambda}\\,p\\,\\sin\\theta.\n$$\nThe array factor exhibits maxima (constructive interference) when the phase progression across elements equals an integer multiple of $2\\pi$,\n$$\n\\Delta\\phi = 2\\pi m,\\quad m\\in\\mathbb{Z}.\n$$\nBecause broadside focusing uses zero progressive phase (electronic focusing centered at $\\theta=0$), this condition directly characterizes the locations of the maxima (main lobe and any grating lobes). Substituting the expression for $\\Delta\\phi$,\n$$\n\\frac{2\\pi}{\\lambda}\\,p\\,\\sin\\theta = 2\\pi m \\quad\\Longrightarrow\\quad \\sin\\theta = m\\,\\frac{\\lambda}{p}.\n$$\nThe physically visible region for plane-wave directions is restricted to $|\\sin\\theta|\\leq 1$. Therefore, grating lobes appear in the visible region if and only if there exists a nonzero integer $m$ such that\n$$\n\\left|m\\,\\frac{\\lambda}{p}\\right|\\leq 1.\n$$\nAt broadside, the first grating lobe, if present, corresponds to $m=1$ (the smallest nonzero integer), so the smallest positive grating lobe angle is determined by\n$$\n\\sin\\theta_{g} = \\frac{\\lambda}{p}.\n$$\nFrom the given parameters,\n$$\n\\lambda = \\frac{c}{f} = \\frac{1540\\ \\text{m/s}}{3\\times 10^{6}\\ \\text{s}^{-1}} = 5.133333\\ldots\\times 10^{-4}\\ \\text{m} = 0.513333\\ldots\\ \\text{mm}.\n$$\nComparing $p$ and $\\lambda$, we have $p=0.8\\ \\text{mm}$ and $\\lambda\\approx 0.513333\\ \\text{mm}$, so $p\\lambda$. Thus, a grating lobe will appear at broadside. The first-order grating lobe angle satisfies\n$$\n\\sin\\theta_{g} = \\frac{\\lambda}{p} = \\frac{0.513333\\ldots\\ \\text{mm}}{0.8\\ \\text{mm}} = \\frac{1540}{2400} = 0.641666\\ldots,\n$$\nso\n$$\n\\theta_{g} = \\arcsin\\!\\left(0.641666\\ldots\\right).\n$$\nEvaluating this and expressing in degrees,\n$$\n\\theta_{g} \\approx 39.916\\ \\text{degrees}.\n$$\nRounded to three significant figures as requested,\n$$\n\\theta_{g} \\approx 39.9\\ \\text{degrees}.\n$$\nDynamic receive focusing changes time delays with range to maintain on-axis focus, but it does not alter the spatial sampling period $p$; therefore, the grating-lobe condition derived from the phase progression remains valid for broadside focusing and determines $\\theta_{g}$ as shown.",
            "answer": "$$\\boxed{39.9}$$"
        },
        {
            "introduction": "To achieve high-quality images, it's not enough to just focus at a single depth; we need to maintain sharp focus throughout the entire field of view. This is the goal of dynamic receive focusing, a key feature of which is the dynamic aperture. This practice challenges you to design a control law that actively changes the size of the receiving aperture with depth, aiming to keep the imaging system's F-number constant and thus preserve consistent lateral resolution from near to far fields. ",
            "id": "4882934",
            "problem": "An ultrasound imaging system uses a one-dimensional linear array with a total of $128$ identical elements and center-to-center pitch $p = 0.3\\ \\text{mm}$. In dynamic receive focusing, the effective receive aperture grows with imaging depth $z$ to aim for an approximately constant $F$-number $F \\approx 1.5$ over a depth range from $z = 10\\ \\text{mm}$ to $z = 60\\ \\text{mm}$. Assume the following physically motivated base:\n- The $F$-number is defined as $F = z/D$, where $z$ is the focal (imaging) depth and $D$ is the effective receive aperture width.\n- For a uniformly weighted, centrally symmetric subaperture on a uniform linear array with negligible kerf and element width comparable to the pitch, the effective aperture width is approximated by $D \\approx N p$, where $N$ is the number of active elements and $p$ is the pitch.\n- The subaperture must use an integer number of elements, and cannot exceed the full array size $N \\leq 128$.\n\nStarting from these bases, derive a dynamic receive aperture growth law $N(z)$ that selects the number of active elements as a function of depth $z$ to maintain $F \\approx 1.5$ over the specified range, honoring the integer and maximum-size constraints. Your law should use the nearest-integer choice of $N$ to the ideal continuous value implied by $F = z/D$, and it should saturate at the full-aperture limit when needed. Treat $z$ as expressed in millimeters.\n\nProvide your final result as a single closed-form expression $N(z)$ in terms of $z$ only, with any constants numerically simplified. State your answer as the analytic expression for $N(z)$; do not include physical units in the final expression.",
            "solution": "The problem requires the derivation of a dynamic receive aperture growth law, denoted by the function $N(z)$, which specifies the number of active elements $N$ as a function of imaging depth $z$. The derivation must satisfy several conditions: maintaining a nearly constant $F$-number, respecting the discrete nature of transducer elements, and adhering to the physical size limit of the array.\n\nFirst, the problem statement is validated.\n\n**Step 1: Extract Givens**\n- Total number of elements: $128$\n- Center-to-center pitch: $p = 0.3\\ \\text{mm}$\n- Target $F$-number: $F \\approx 1.5$\n- Imaging depth range: $z = 10\\ \\text{mm}$ to $z = 60\\ \\text{mm}$\n- Definition of $F$-number: $F = z/D$, where $D$ is the effective receive aperture width.\n- Approximation for aperture width: $D \\approx N p$, where $N$ is the number of active elements.\n- Constraint on $N$: $N$ must be an integer.\n- Constraint on maximum aperture: $N \\le 128$.\n- Rule for discretization: $N$ should be the nearest-integer choice to the ideal continuous value.\n- Saturation condition: The law must saturate at the full-aperture limit.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it is based on fundamental principles of ultrasound beamforming, including the definitions of $F$-number and aperture size, which are central to medical imaging physics. All provided values and parameters are physically realistic for a clinical ultrasound probe. The problem is well-posed; it provides sufficient information and clear, consistent constraints to derive a unique function $N(z)$. The language is objective and precise. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A reasoned solution will be provided.\n\n**Solution Derivation**\n\nThe core of the problem is to maintain a constant $F$-number. The relationship between the $F$-number $F$, the imaging depth $z$, and the aperture width $D$ is given by:\n$$F = \\frac{z}{D}$$\n\nThe effective aperture width $D$ is related to the number of active elements $N$ and the pitch $p$ by the approximation:\n$$D \\approx N p$$\n\nTo find an ideal, continuous number of elements $N_{\\text{ideal}}$ that would perfectly maintain the target $F$-number, we can combine these two equations. Substituting the expression for $D$ into the $F$-number equation gives:\n$$F \\approx \\frac{z}{N p}$$\n\nSolving for $N$ yields the ideal number of elements as a function of depth $z$:\n$$N_{\\text{ideal}}(z) = \\frac{z}{F p}$$\n\nNow, we substitute the given numerical values for $F$ and $p$. The target $F$-number is $F = 1.5$, and the pitch is $p = 0.3\\ \\text{mm}$. The input $z$ is understood to be in millimeters.\n$$N_{\\text{ideal}}(z) = \\frac{z}{1.5 \\times 0.3} = \\frac{z}{0.45}$$\n\nTo express the constant as a rational number, we can write:\n$$N_{\\text{ideal}}(z) = \\frac{1}{0.45}z = \\frac{100}{45}z = \\frac{20}{9}z$$\n\nThis expression gives the ideal number of elements, which is a continuous real number. However, the physical system has two constraints that must be incorporated into the final law for $N(z)$:\n1.  The number of elements $N$ must be an integer. The problem specifies using the \"nearest-integer choice\". This is mathematically equivalent to a rounding function. A standard implementation of rounding a non-negative number $x$ to the nearest integer is $\\lfloor x + 0.5 \\rfloor$.\n2.  The number of elements $N$ cannot exceed the total number of elements available in the array, which is $128$. This imposes an upper limit, or saturation, on $N$.\n\nWe apply these two constraints sequentially. First, we apply the nearest-integer rule to $N_{\\text{ideal}}(z)$:\n$$N_{\\text{rounded}}(z) = \\left\\lfloor N_{\\text{ideal}}(z) + \\frac{1}{2} \\right\\rfloor = \\left\\lfloor \\frac{20}{9}z + \\frac{1}{2} \\right\\rfloor$$\n\nNext, we apply the saturation constraint. The number of active elements cannot be more than $128$. This means that if the calculated rounded number of elements exceeds $128$, it must be capped at $128$. This can be expressed using the minimum function:\n$$N(z) = \\min\\left(N_{\\text{rounded}}(z), 128\\right)$$\n\nSubstituting the expression for $N_{\\text{rounded}}(z)$, we arrive at the final closed-form expression for the dynamic receive aperture growth law:\n$$N(z) = \\min\\left(\\left\\lfloor \\frac{20}{9}z + \\frac{1}{2} \\right\\rfloor, 128\\right)$$\n\nThis expression for $N(z)$ provides the number of active elements for any given depth $z$ (in mm), satisfying all the conditions specified in the problem statement. The number of elements grows linearly with depth (in a stepwise integer fashion) until the aperture saturates at the full array size of $128$ elements.",
            "answer": "$$\\boxed{\\min\\left(\\left\\lfloor \\frac{20}{9}z + \\frac{1}{2} \\right\\rfloor, 128\\right)}$$"
        }
    ]
}