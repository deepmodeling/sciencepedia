{
    "hands_on_practices": [
        {
            "introduction": "功率多普勒成像的核心在于从采集的回波数据中估算信号功率。本练习将引导您从连续时间信号能量的基本原理出发，推导出一个使用同相 (I) 和正交 (Q) 样本来计算平均功率的离散时间实用估计算法。通过这个推导，您将深入理解功率多普勒中的“功率”究竟代表什么，并学会如何从原始信号数据中高效地计算它。",
            "id": "4913134",
            "problem": "给定离散慢时多普勒系综，表示为对应于同相 (I) 和正交 (Q) 分量的复数样本序列。在能量多普勒成像的背景下，像素强度基于采集时间内多普勒信号功率的估计值。从连续时间信号的能量和功率的基本定义及其离散时间近似出发，推导并实现一种计算归一化功率估计值的方法。\n\n设复数慢时信号表示为 $x(t)$，其采样版本为 $x[n] = I[n] + j\\,Q[n]$，其中 $I[n]$ 和 $Q[n]$ 分别是同相和正交分量。采样以脉冲重复频率（PRF）进行，用 $\\mathrm{PRF}$ 表示，单位为 $\\mathrm{Hz}$，采样间隔为 $\\Delta t = 1 / \\mathrm{PRF}$，系中有 $N$ 个样本。采集区间内的连续时间能量定义为\n$$\nE = \\int_{0}^{T} \\lvert x(t) \\rvert^2 \\, dt,\n$$\n其中 $T$ 是总采集时间。该区间内的平均功率定义为\n$$\nP = \\frac{E}{T}.\n$$\n使用采样数据的标准黎曼和近似，能量可以近似为\n$$\nE \\approx \\Delta t \\sum_{n=0}^{N-1} \\lvert x[n] \\rvert^2,\n$$\n且采集时间为 $T = N \\Delta t$。基于这些定义，根据 $N$ 个 I/Q 样本构建一个计算上稳定的单位时间平均功率估计量 $\\hat{P}$，并予以实现。你的估计量必须以任意单位的平方（$\\mathrm{a.u.}^2$）表示，并且必须将每个报告值四舍五入到六位小数。\n\n你的任务是编写一个完整的程序，针对每个提供的测试用例，根据给定的 $\\mathrm{PRF}$ 从 I/Q 样本中计算单位时间的归一化功率 $\\hat{P}$。你应该假设所提供的序列已经为能量多普勒成像进行了适当的杂波滤波。对于每个序列，使用从第一性原理推导出的离散时间近似，并为你解决方案中的任何简化做出解释。\n\n测试套件：\n1. 正常路径可变性案例：\n   - $\\mathrm{PRF} = 5000$ $\\mathrm{Hz}$\n   - 样本 $x[n]$: $\\left[1+0j,\\; 0.5+0.5j,\\; -0.2+0.1j,\\; 0+0j,\\; 0.3-0.4j,\\; -0.7+0.7j,\\; 0.9+0.1j,\\; -0.5-0.5j\\right]$\n2. 单样本边界案例：\n   - $\\mathrm{PRF} = 10000$ $\\mathrm{Hz}$\n   - 样本 $x[n]$: $\\left[2+3j\\right]$\n3. 全零边缘案例：\n   - $\\mathrm{PRF} = 7500$ $\\mathrm{Hz}$\n   - 样本 $x[n]$: $\\left[0+0j,\\; 0+0j,\\; 0+0j,\\; 0+0j\\right]$\n4. 恒定振幅、高$\\mathrm{PRF}$案例：\n   - $\\mathrm{PRF} = 20000$ $\\mathrm{Hz}$\n   - 样本 $x[n]$: $\\left[1+1j,\\; 1+1j,\\; 1+1j,\\; 1+1j,\\; 1+1j\\right]$\n5. 慢$\\mathrm{PRF}$异构案例：\n   - $\\mathrm{PRF} = 1000$ $\\mathrm{Hz}$\n   - 样本 $x[n]$: $\\left[0.2+0.1j,\\; -0.3+0.4j,\\; 0+0j,\\; 0.6-0.8j,\\; -0.1-0.2j,\\; 0.5+0j\\right]$\n\n最终输出格式：\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个值都四舍五入到六位小数，并以 $\\mathrm{a.u.}^2$ 表示（例如，“[0.123456,0.654321,0.000000]”）。",
            "solution": "该问题要求推导并实现一个用于离散慢时多普勒信号平均功率的估计量，该信号由一系列复数同相（$I$）和正交（$Q$）样本表示。\n\n首先，有必要对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **复数慢时信号**：连续时间表示为 $x(t)$，离散时间采样版本为 $x[n] = I[n] + j\\,Q[n]$。\n- **样本数**：$N$。\n- **脉冲重复频率**：$\\mathrm{PRF}$ (单位为 $\\mathrm{Hz}$)。\n- **采样间隔**：$\\Delta t = 1 / \\mathrm{PRF}$。\n- **总采集时间**：$T = N \\Delta t$。\n- **连续时间能量定义**：$E = \\int_{0}^{T} \\lvert x(t) \\rvert^2 \\, dt$。\n- **连续时间平均功率定义**：$P = E/T$。\n- **离散时间能量近似**：$E \\approx \\Delta t \\sum_{n=0}^{N-1} \\lvert x[n] \\rvert^2$。\n- **任务**：构建一个计算上稳定的单位时间平均功率估计量 $\\hat{P}$，并予以实现。\n- **输出单位**：任意单位的平方（$\\mathrm{a.u.}^2$）。\n- **输出精度**：四舍五入到六位小数。\n- **测试套件**：\n    1. $\\mathrm{PRF} = 5000$ $\\mathrm{Hz}$, $x[n] = \\left[1+0j, 0.5+0.5j, -0.2+0.1j, 0+0j, 0.3-0.4j, -0.7+0.7j, 0.9+0.1j, -0.5-0.5j\\right]$。\n    2. $\\mathrm{PRF} = 10000$ $\\mathrm{Hz}$, $x[n] = \\left[2+3j\\right]$。\n    3. $\\mathrm{PRF} = 7500$ $\\mathrm{Hz}$, $x[n] = \\left[0+0j, 0+0j, 0+0j, 0+0j\\right]$。\n    4. $\\mathrm{PRF} = 20000$ $\\mathrm{Hz}$, $x[n] = \\left[1+1j, 1+1j, 1+1j, 1+1j, 1+1j\\right]$。\n    5. $\\mathrm{PRF} = 1000$ $\\mathrm{Hz}$, $x[n] = \\left[0.2+0.1j, -0.3+0.4j, 0+0j, 0.6-0.8j, -0.1-0.2j, 0.5+0j\\right]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对该问题进行验证。\n- **科学依据**：该问题建立在数字信号处理的基本原理之上，特别是连续时间信号及其离散时间表示之间的关系。信号能量和功率的定义，以及使用黎曼和来近似积分，都是标准且正确的方法。能量多普勒是一种成熟的医学成像模式。\n- **适定性**：问题提供了所有必要的数据（复数样本、$\\mathrm{PRF}$）和清晰的定义，以构建一个唯一、稳定且有意义的功率估计量。目标明确无歧义。\n- **客观性**：问题以精确、正式的语言陈述，不含主观或基于意见的内容。\n\n该问题没有缺陷。它在科学上不是不健全的，也不是非形式化的、不完整的、矛盾的、不切实际的或不适定的。它提出了一个标准的、非平凡的推导，然后是计算，这是一个有效的教学结构。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将基于所提供的原则来制定解决方案。\n\n### 解决方案推导与实现\n目标是推导信号在采集区间 $T$ 内的平均功率估计量 $\\hat{P}$。平均功率 $P$ 定义为总能量 $E$ 除以时长 $T$：\n$$\nP = \\frac{E}{T} = \\frac{1}{T} \\int_{0}^{T} \\lvert x(t) \\rvert^2 \\, dt\n$$\n我们得到的是信号的离散时间表示 $x[n]$，采样间隔为 $\\Delta t = 1/\\mathrm{PRF}$。对于 $N$ 个样本，总采集时间为 $T = N \\Delta t$。问题指定使用黎曼和近似来计算能量积分。该积分可以近似为 $N$ 个矩形面积之和，其中每个矩形的宽度为 $\\Delta t$，高度为 $\\lvert x[n] \\rvert^2$，即样本 $n$ 处的瞬时功率。\n$$\nE \\approx \\sum_{n=0}^{N-1} \\lvert x[n] \\rvert^2 \\cdot \\Delta t\n$$\n让我们将此近似能量表示为 $E_{approx}$。\n$$\nE_{approx} = \\Delta t \\sum_{n=0}^{N-1} \\lvert x[n] \\rvert^2\n$$\n因此，我们的平均功率估计量 $\\hat{P}$ 是此近似能量与总采集时间 $T$ 的比值。\n$$\n\\hat{P} = \\frac{E_{approx}}{T}\n$$\n代入 $E_{approx}$ 和 $T$ 的表达式：\n$$\n\\hat{P} = \\frac{\\Delta t \\sum_{n=0}^{N-1} \\lvert x[n] \\rvert^2}{N \\Delta t}\n$$\n一个关键的观察是，采样间隔 $\\Delta t$ 在分子和分母中被消掉了。这个优雅的简化得出了我们估计量的最终形式：\n$$\n\\hat{P} = \\frac{1}{N} \\sum_{n=0}^{N-1} \\lvert x[n] \\rvert^2\n$$\n该表达式就是系中复数样本模的平方的均值。它是平均功率的离散时间等价物。值得注意的是，$\\hat{P}$ 的最终计算与脉冲重复频率（$\\mathrm{PRF}$）无关。$\\mathrm{PRF}$ 对于定义过程的时间尺度（即将离散样本索引映射到连续时间）至关重要，但它不影响归一化功率估计量本身的值。\n\n对于给定的复数样本 $x[n] = I[n] + j\\,Q[n]$，其模的平方计算如下：\n$$\n\\lvert x[n] \\rvert^2 = (\\sqrt{I[n]^2 + Q[n]^2})^2 = I[n]^2 + Q[n]^2\n$$\n因此，算法如下：\n1.  对于系中的每个复数样本，计算其模的平方。\n2.  计算这些模的平方的算术平均值。这就是估计的平均功率 $\\hat{P}$，单位为 $\\mathrm{a.u.}^2$。\n3.  将最终值四舍五入到六位小数。\n\n该过程构成了一种计算上稳定且直接的信号功率估计方法，与所提供的基本原则一致。我们现在将此算法应用于测试用例。\n\n**测试用例 1**：\n$N = 8$。样本：$\\left[1+0j, 0.5+0.5j, -0.2+0.1j, 0+0j, 0.3-0.4j, -0.7+0.7j, 0.9+0.1j, -0.5-0.5j\\right]$。\n模的平方：$[1, 0.5, 0.05, 0, 0.25, 0.98, 0.82, 0.5]$。\n模的平方之和 = $1 + 0.5 + 0.05 + 0 + 0.25 + 0.98 + 0.82 + 0.5 = 4.1$。\n$\\hat{P} = 4.1 / 8 = 0.5125$。\n\n**测试用例 2**：\n$N = 1$。样本：$\\left[2+3j\\right]$。\n模的平方：$|2+3j|^2 = 2^2 + 3^2 = 4 + 9 = 13$。\n和 = $13$。\n$\\hat{P} = 13 / 1 = 13$。\n\n**测试用例 3**：\n$N = 4$。样本：$\\left[0+0j, 0+0j, 0+0j, 0+0j\\right]$。\n模的平方都为 $0$。\n和 = $0$。\n$\\hat{P} = 0 / 4 = 0$。\n\n**测试用例 4**：\n$N = 5$。样本：$\\left[1+1j, 1+1j, 1+1j, 1+1j, 1+1j\\right]$。\n每个样本的模的平方：$|1+1j|^2 = 1^2 + 1^2 = 2$。\n和 = $5 \\times 2 = 10$。\n$\\hat{P} = 10 / 5 = 2$。\n\n**测试用例 5**：\n$N = 6$。样本：$\\left[0.2+0.1j, -0.3+0.4j, 0+0j, 0.6-0.8j, -0.1-0.2j, 0.5+0j\\right]$。\n模的平方：$[0.05, 0.25, 0, 1.0, 0.05, 0.25]$。\n和 = $0.05 + 0.25 + 0 + 1.0 + 0.05 + 0.25 = 1.6$。\n$\\hat{P} = 1.6 / 6 \\approx 0.2666666...$\n\n这些计算将在最终程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the normalized power estimate for slow-time Doppler ensembles.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (PRF, list_of_complex_samples).\n    # The PRF is included for completeness but is not used in the final derived formula.\n    test_cases = [\n        (5000, [1+0j, 0.5+0.5j, -0.2+0.1j, 0+0j, 0.3-0.4j, -0.7+0.7j, 0.9+0.1j, -0.5-0.5j]),\n        (10000, [2+3j]),\n        (7500, [0+0j, 0+0j, 0+0j, 0+0j]),\n        (20000, [1+1j, 1+1j, 1+1j, 1+1j, 1+1j]),\n        (1000, [0.2+0.1j, -0.3+0.4j, 0+0j, 0.6-0.8j, -0.1-0.2j, 0.5+0j])\n    ]\n\n    results = []\n    for prf, samples in test_cases:\n        # The derivation for the average power estimator is:\n        # P_hat = (1/T) * E_approx\n        # where T = N * dt and E_approx = dt * sum(|x[n]|^2)\n        # P_hat = (1 / (N * dt)) * (dt * sum(|x[n]|^2))\n        # P_hat = (1/N) * sum(|x[n]|^2)\n        # This is the mean of the squared magnitudes of the complex samples.\n        # The PRF (and thus dt) is not required for the calculation.\n\n        if not samples:\n            # Handle the edge case of an empty sample list to avoid division by zero.\n            power_estimate = 0.0\n        else:\n            # Convert the list of Python complex numbers to a NumPy array for efficient computation.\n            x_n = np.array(samples, dtype=np.complex128)\n            \n            # Calculate the squared magnitude of each complex sample.\n            squared_magnitudes = np.abs(x_n)**2\n            \n            # The power estimate is the arithmetic mean of the squared magnitudes.\n            power_estimate = np.mean(squared_magnitudes)\n        \n        results.append(power_estimate)\n\n    # Format the results to six decimal places and join them into the required string format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "功率多普勒与传统的彩色多普勒成像之间有何区别，这是一个常见的困惑点。本练习将帮助您直面这一问题。您将首先执行一个标准的多普勒速度计算——这是彩色多普勒的标志性操作，然后批判性地评估为何这一过程与功率多普勒成像的根本目标不同，从而巩固您对功率多普勒独特作用的理解。",
            "id": "4913104",
            "problem": "一个超声系统用于评估外周动脉的血流。该系统以中心频率 $f_0 = 5\\,\\mathrm{MHz}$ 发射，并假设软组织中的声速为 $c = 1540\\,\\mathrm{m/s}$。动脉轴线与超声波束形成 $\\theta = 60^\\circ$ 的夹角。一个频谱估计器报告称，从置于管腔内的门控中测得的平均多普勒频移为 $f_D = 1.5\\,\\mathrm{kHz}$。仅从介质中速度为 $c$ 的波与运动散射体相互作用的经典多普勒效应、沿波束方向的速度分量 $v\\cos\\theta$ 以及脉冲回波超声是双向（发射-散射-接收）传播这一事实出发，推导出一个物理上合理的血流速度 $v$ 的估计量，并根据给定参数计算其值。然后，评估这种速度估计对于能量多普勒成像（PDI）是否至关重要，其中 PDI 表示能量多普勒成像，它描绘了与血流相关的反向散射信号的强度。\n\n哪个选项同时提供了正确的数值估计和正确的概念论证？\n\nA. $v \\approx 0.92\\,\\mathrm{m/s}$；速度估计是PDI的核心，因为PDI编码平均多普勒频率和方向。\n\nB. $v \\approx 0.23\\,\\mathrm{m/s}$；PDI主要可视化频移，因此需要精确的角度校正。\n\nC. $v \\approx 0.46\\,\\mathrm{m/s}$；PDI通过对来自运动散射体的反向散射功率进行积分来量化血流，其对波束-血流夹角基本不敏感，并且不提供速度大小或方向。\n\nD. $v \\approx 0.46\\,\\mathrm{m/s}$；PDI仍然从根本上依赖于测量的多普勒频率来计算速度大小，尽管它对低速血流更敏感。\n\nE. $v \\approx 0.46\\,\\mathrm{m/s}$；PDI使用同相/正交样本的自相关输出带符号的速度，并且受混叠效应影响严重。",
            "solution": "对问题陈述进行严格验证是必要的第一步。\n\n### 第1步：提取已知条件\n\n-   系统发射中心频率：$f_0 = 5\\,\\mathrm{MHz}$\n-   假定的软组织中声速：$c = 1540\\,\\mathrm{m/s}$\n-   动脉轴线与超声波束之间的夹角：$\\theta = 60^\\circ$\n-   平均多普勒频移：$f_D = 1.5\\,\\mathrm{kHz}$\n-   任务是基于以下条件推导血流速度 $v$ 的估计量：\n    1.  介质中波的经典多普勒效应。\n    2.  沿波束方向的速度分量，$v\\cos\\theta$。\n    3.  脉冲回波超声的双向（发射-散射-接收）特性。\n-   任务还要求评估速度估计在能量多普勒成像（PDI）中的根本作用，PDI被定义为一种“描绘与血流相关的反向散射信号强度”的模式。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题坚实地基于多普勒效应应用于医学超声的物理原理，这是医学成像物理学中的一个标准课题。所有提供的参数（$f_0, c, \\theta, f_D$）在临床场景中都是物理上现实的。为能量多普勒成像提供的定义是准确的。\n-   **适定性**：该问题是适定的。它提供了推导血流速度 $v$ 的唯一数值所需的所有信息。关于PDI的概念性问题是具体的，并且可以根据该成像模式的既定原理来回答。\n-   **客观性**：该问题以精确、客观和技术性的语言陈述，没有歧义或主观性陈述。\n\n### 第3步：结论与行动\n\n问题陈述在科学上是合理的、适定的和客观的。它是**有效的**。将推导解答。\n\n### 血流速度估计量的推导\n\n推导过程必须考虑超声波的双向传播。\n\n1.  **发射路径（换能器到散射体）**：超声换能器是静止的，发射频率为 $f_0$ 的波。血细胞（散射体）以速度 $v$、与波束成 $\\theta$ 角运动。沿波束的速度分量为 $v_{\\text{beam}} = v\\cos\\theta$。我们假设这代表远离换能器的运动。血细胞充当一个移动的观察者，它感知到的频率 $f_{\\text{scat}}$ 由多普勒效应给出：\n    $$f_{\\text{scat}} = f_0 \\left( \\frac{c - v_{\\text{beam}}}{c} \\right) = f_0 \\left( 1 - \\frac{v\\cos\\theta}{c} \\right)$$\n\n2.  **接收路径（散射体到换能器）**：现在，血细胞充当一个移动的声源，将频率为 $f_{\\text{scat}}$ 的波散射回静止的换能器（观察者）。换能器接收到的频率 $f_r$ 为：\n    $$f_r = f_{\\text{scat}} \\left( \\frac{c}{c - v_{\\text{source}}} \\right)$$\n    由于声源正在远离，观察者看到的其速度 $v_{\\text{source}}$ 为 $-v_{\\text{beam}}$。一个更标准的公式使用 $v_s$ 作为远离速度，得到 $f_r = f_{scat} / (1+v_s/c)$。当 $v_s = v\\cos\\theta$ 时：\n    $$f_r = f_{\\text{scat}} \\left( \\frac{c}{c + v\\cos\\theta} \\right)$$\n    代入 $f_{\\text{scat}}$ 的表达式：\n    $$f_r = f_0 \\left( 1 - \\frac{v\\cos\\theta}{c} \\right) \\left( \\frac{c}{c + v\\cos\\theta} \\right) = f_0 \\frac{c - v\\cos\\theta}{c + v\\cos\\theta}$$\n\n3.  **多普勒频移 ($f_D$)**：多普勒频移是接收频率与发射频率之差，$f_D = f_r - f_0$。\n    $$f_D = f_0 \\left( \\frac{c - v\\cos\\theta}{c + v\\cos\\theta} - 1 \\right) = f_0 \\left( \\frac{(c - v\\cos\\theta) - (c + v\\cos\\theta)}{c + v\\cos\\theta} \\right) = f_0 \\left( \\frac{-2v\\cos\\theta}{c + v\\cos\\theta} \\right)$$\n    负号表示当散射体远离换能器时频率降低。题目给出的是频移的绝对值。在医学诊断中，血流速度 $v$ 远小于声速 $c$ (即 $v \\ll c$）。这允许在分母中进行近似 $c + v\\cos\\theta \\approx c$。由此得到的脉冲回波超声的标准多普勒方程为：\n    $$f_D \\approx \\frac{-2f_0 v\\cos\\theta}{c}$$\n\n4.  **血流速度估计量 ($v$)**：我们现在可以重新整理方程以求解 $v$。由于题目给出的 $f_D$ 是一个正值，我们处理的是其大小。\n    $$|f_D| = \\frac{2f_0 v \\cos\\theta}{c}$$\n    因此，物理上合理的血流速度 $v$ 的估计量为：\n    $$v = \\frac{|f_D| c}{2 f_0 \\cos\\theta}$$\n\n### 数值计算\n\n使用给定的参数值：\n-   $|f_D| = 1.5\\,\\mathrm{kHz} = 1.5 \\times 10^3\\,\\mathrm{Hz}$\n-   $c = 1540\\,\\mathrm{m/s}$\n-   $f_0 = 5\\,\\mathrm{MHz} = 5 \\times 10^6\\,\\mathrm{Hz}$\n-   $\\theta = 60^\\circ$，所以 $\\cos\\theta = \\cos(60^\\circ) = 0.5$\n\n将这些值代入推导出的估计量中：\n$$v = \\frac{(1.5 \\times 10^3\\,\\mathrm{Hz}) \\times (1540\\,\\mathrm{m/s})}{2 \\times (5 \\times 10^6\\,\\mathrm{Hz}) \\times 0.5} = \\frac{2.31 \\times 10^6}{5 \\times 10^6}\\,\\mathrm{m/s} = 0.462\\,\\mathrm{m/s}$$\n计算出的血流速度数值估计为 $v \\approx 0.46\\,\\mathrm{m/s}$。\n\n### 能量多普勒成像 (PDI) 的概念评估\n\n能量多普勒成像（PDI），也称为功率多普勒或超声血管造影，与传统的基于速度的多普勒模式（彩色多普勒、频谱多普勒）有根本不同。\n-   **PDI原理**：PDI描绘的是多普勒频移信号的*功率*。该功率与样本容积内运动的红细胞体积成正比。它是通过对来自组织的时间序列信号的功率谱密度进行积分来计算的。显示的强度代表血流信号的强度（功率），而不是其速度。\n-   **速度和方向**：PDI不测量或显示速度的大小或方向。它仅指示血流的存在和相对“量”。\n-   **角度依赖性**：PDI的一个关键优势是其对波束-血流夹角 $\\theta$ 的相对不敏感性。虽然多普勒频移 $f_D$ 与 $\\cos\\theta$ 成正比并在 $\\theta = 90^\\circ$ 时消失，但信号的功率不会。只要存在可检测到的多普勒频移，PDI就会记录一个信号。这使得PDI在可视化迂曲血管或几乎垂直于波束的血管中的血流时表现更优。\n-   **结论**：速度估计对于PDI**不是**根本性的。PDI的目的是以高灵敏度描绘血流的存在和分布，特别是慢速血流，它通过回避速度估计的挑战来实现这一点。\n\n### 逐项分析选项\n\nA. **$v \\approx 0.92\\,\\mathrm{m/s}$；速度估计是PDI的核心，因为PDI编码平均多普勒频率和方向。**\n   -   数值：错误。$0.92\\,\\mathrm{m/s}$ 这个值是正确答案的两倍，很可能是在速度公式的分母中漏掉了表示双向传播的因子 $2$。\n   -   概念论证：错误。PDI不编码平均多普勒频率或方向；它编码信号功率。这个描述适用于彩色多普勒，而非PDI。\n   -   结论：**错误**。\n\nB. **$v \\approx 0.23\\,\\mathrm{m/s}$；PDI主要可视化频移，因此需要精确的角度校正。**\n   -   数值：错误。$0.23\\,\\mathrm{m/s}$ 这个值是正确答案的一半，这可能是由于错误计算，例如假设 $\\cos\\theta = 1$ 而不是 $\\cos(60^\\circ) = 0.5$。\n   -   概念论证：错误。PDI可视化的是信号功率，而不是频移，其主要优点之一是对角度的相对*不*敏感性，这意味着它不需要精确的角度校正。\n   -   结论：**错误**。\n\nC. **$v \\approx 0.46\\,\\mathrm{m/s}$；PDI通过对来自运动散射体的反向散射功率进行积分来量化血流，其对波束-血流夹角基本不敏感，并且不提供速度大小或方向。**\n   -   数值：正确。我们的计算得出 $v \\approx 0.46\\,\\mathrm{m/s}$。\n   -   概念论证：正确。这是对能量多普勒成像基本原理的准确而完整的描述。\n   -   结论：**正确**。\n\nD. **$v \\approx 0.46\\,\\mathrm{m/s}$；PDI仍然从根本上依赖于测量的多普勒频率来计算速度大小，尽管它对低速血流更敏感。**\n   -   数值：正确。\n   -   概念论证：错误。其核心前提“PDI从多普勒频率计算速度大小”是错误的。虽然它对低速血流的敏感性是一个正确的属性，但所述机制是错误的。它依赖于多普勒频率的*存在*，但不是其*平均值*来进行速度计算。\n   -   结论：**错误**。\n\nE. **$v \\approx 0.46\\,\\mathrm{m/s}$；PDI使用同相/正交样本的自相关输出带符号的速度，并且受混叠效应影响严重。**\n   -   数值：正确。\n   -   概念论证：错误。PDI不输出带符号（有方向）的速度。使用自相关是估计平均频率（用于彩色多普勒）或功率的一种方法，但PDI本质上是无方向的。此外，因为PDI整合总功率而不估计特定频率，所以它受混叠效应的影响比彩色多普勒要小得多。\n   -   结论：**错误**。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "在临床实践中，来自静止或缓慢移动的组织的强回波（称为“杂波”）可能会淹没来自血流的微弱信号。本练习将向您介绍墙滤波这一关键的信号处理步骤，它用于抑制此类杂波。您将通过推导一个特定的有限冲激响应 (FIR) 滤波器的频率响应，并计算它如何影响特定频带内的信号功率，来亲手分析其工作原理。",
            "id": "4913125",
            "problem": "在能量多普勒成像中，沿脉冲序列（慢时间）缓慢采样的回波信号在估计血流的积分谱功率之前会经过滤波，以抑制低频组织杂波。考虑一个用于慢时间序列的一个三阶（$N=3$）有限冲激响应墙滤波器，其真实值系数为 $h[0]=1$、$h[1]=-2$ 和 $h[2]=1$。将慢时间序列视为一个以脉冲重复频率 (PRF) $f_{s} = 5000$ Hz 采样的离散时间信号，因此物理频率 $f$ 通过 $\\omega = 2\\pi f / f_{s}$ 映射到离散时间角频率 $\\omega$。假设未滤波的多普勒功率谱密度在血流频带 $f \\in [625, 1250]$ Hz 内为一个恒定水平 $S_{0}$ 的矩形带，而在其他地方为零（本次计算忽略杂波），因此在离散时间频率中，它占据 $\\omega \\in [\\omega_{1}, \\omega_{2}]$，其中 $\\omega_{1} = 2\\pi (625)/5000$ 且 $\\omega_{2} = 2\\pi (1250)/5000$。\n\n使用第一性原理，推导出此墙滤波器的频率响应 $H(\\omega)$ 以及相应的幅度平方响应 $|H(\\omega)|^{2}$。然后，通过计算无量纲比率\n$$R = \\frac{P_{\\text{out}}}{P_{\\text{in}}},$$\n来建模该滤波器对多普勒谱的影响，其中 $P_{\\text{in}}$ 是未滤波频带的积分谱功率，$P_{\\text{out}}$ 是滤波后频带的积分谱功率，两者都是在 $\\omega \\in [\\omega_{1}, \\omega_{2}]$ 上使用离散时间傅里叶变换 (DTFT) 框架计算的。将 $R$ 的最终数值四舍五入至四位有效数字，并将其表示为无量纲量（无单位）。",
            "solution": "问题陈述已经过验证，被认为是自洽的、一致的且科学上合理的。它提出了一个应用于医学成像的数字信号处理领域中的适定问题。所有必需的参数都已提供，目标也已明确定义。\n\n第一步是确定有限冲激响应 (FIR) 滤波器的频率响应 $H(\\omega)$。频率响应是滤波器冲激响应 $h[n]$ 的离散时间傅里叶变换 (DTFT)。冲激响应由系数 $h[0]=1$、$h[1]=-2$ 和 $h[2]=1$ 给出。\n\nDTFT 的定义为：\n$$H(\\omega) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-j\\omega n)$$\n对于这个因果三阶滤波器，求和范围为 $n=0$ 到 $2$：\n$$H(\\omega) = h[0]\\exp(-j\\omega \\cdot 0) + h[1]\\exp(-j\\omega \\cdot 1) + h[2]\\exp(-j\\omega \\cdot 2)$$\n代入给定的系数：\n$$H(\\omega) = 1 - 2\\exp(-j\\omega) + \\exp(-j2\\omega)$$\n为了分析幅度和相位，可以通过提取对应于滤波器中点的复指数项 $\\exp(-j\\omega)$ 来简化此表达式：\n$$H(\\omega) = \\exp(-j\\omega) \\left( \\exp(j\\omega) - 2 + \\exp(-j\\omega) \\right)$$\n使用欧拉公式 $\\exp(j\\omega) + \\exp(-j\\omega) = 2\\cos(\\omega)$，我们得到：\n$$H(\\omega) = \\exp(-j\\omega) (2\\cos(\\omega) - 2) = -2(1 - \\cos(\\omega))\\exp(-j\\omega)$$\n此表达式显示了一个线性相位项 $\\exp(-j\\omega)$ 和一个实值振幅项。\n\n接下来，我们推导幅度平方响应 $|H(\\omega)|^2$。\n$$|H(\\omega)| = |-2(1 - \\cos(\\omega))\\exp(-j\\omega)| = |-2| \\cdot |1 - \\cos(\\omega)| \\cdot |\\exp(-j\\omega)|$$\n由于 $\\cos(\\omega) \\le 1$，项 $1 - \\cos(\\omega)$ 总是非负的。同时 $|\\exp(-j\\omega)| = 1$。\n$$|H(\\omega)| = 2(1 - \\cos(\\omega))$$\n因此，幅度平方响应为：\n$$|H(\\omega)|^2 = \\left( 2(1 - \\cos(\\omega)) \\right)^2 = 4(1 - \\cos(\\omega))^2$$\n将此展开，我们得到：\n$$|H(\\omega)|^2 = 4(1 - 2\\cos(\\omega) + \\cos^2(\\omega))$$\n使用降幂恒等式 $\\cos^2(\\omega) = \\frac{1}{2}(1 + \\cos(2\\omega))$，表达式变为：\n$$|H(\\omega)|^2 = 4\\left(1 - 2\\cos(\\omega) + \\frac{1}{2} + \\frac{1}{2}\\cos(2\\omega)\\right) = 4\\left(\\frac{3}{2} - 2\\cos(\\omega) + \\frac{1}{2}\\cos(2\\omega)\\right)$$\n$$|H(\\omega)|^2 = 6 - 8\\cos(\\omega) + 2\\cos(2\\omega)$$\n这个表达式适合进行积分。\n\n问题要求比率 $R = \\frac{P_{\\text{out}}}{P_{\\text{in}}}$。未滤波的输入功率 $P_{\\text{in}}$ 是输入功率谱密度 (PSD) $S_{xx}(\\omega)$ 在指定频带上的积分。输入 PSD 在 $\\omega \\in [\\omega_1, \\omega_2]$ 上为 $S_0$，在其他地方为零。频带内的总功率由下式给出：\n$$P_{\\text{in}} = \\frac{1}{2\\pi} \\int_{\\omega_1}^{\\omega_2} S_{xx}(\\omega) d\\omega = \\frac{1}{2\\pi} \\int_{\\omega_1}^{\\omega_2} S_0 d\\omega = \\frac{S_0}{2\\pi}(\\omega_2 - \\omega_1)$$\n输出 PSD 为 $S_{yy}(\\omega) = |H(\\omega)|^2 S_{xx}(\\omega)$。输出功率 $P_{\\text{out}}$ 是输出 PSD 在同一频带上的积分：\n$$P_{\\text{out}} = \\frac{1}{2\\pi} \\int_{\\omega_1}^{\\omega_2} S_{yy}(\\omega) d\\omega = \\frac{1}{2\\pi} \\int_{\\omega_1}^{\\omega_2} |H(\\omega)|^2 S_{xx}(\\omega) d\\omega = \\frac{S_0}{2\\pi} \\int_{\\omega_1}^{\\omega_2} |H(\\omega)|^2 d\\omega$$\n比率 $R$ 为：\n$$R = \\frac{P_{\\text{out}}}{P_{\\text{in}}} = \\frac{\\frac{S_0}{2\\pi} \\int_{\\omega_1}^{\\omega_2} |H(\\omega)|^2 d\\omega}{\\frac{S_0}{2\\pi}(\\omega_2 - \\omega_1)} = \\frac{1}{\\omega_2 - \\omega_1} \\int_{\\omega_1}^{\\omega_2} |H(\\omega)|^2 d\\omega$$\n这表明 $R$ 是幅度平方频率响应在目标频带上的平均值。\n\n我们现在确定积分限 $\\omega_1$ 和 $\\omega_2$。物理频率为 $f_1 = 625$ Hz 和 $f_2 = 1250$ Hz，采样频率为 $f_s = 5000$ Hz。\n$$\\omega_1 = \\frac{2\\pi f_1}{f_s} = \\frac{2\\pi(625)}{5000} = \\frac{2\\pi}{8} = \\frac{\\pi}{4} \\text{ rad/sample}$$\n$$\\omega_2 = \\frac{2\\pi f_2}{f_s} = \\frac{2\\pi(1250)}{5000} = \\frac{2\\pi}{4} = \\frac{\\pi}{2} \\text{ rad/sample}$$\n区间宽度为 $\\omega_2 - \\omega_1 = \\frac{\\pi}{2} - \\frac{\\pi}{4} = \\frac{\\pi}{4}$。\n\n现在我们计算 $|H(\\omega)|^2$ 从 $\\omega_1 = \\pi/4$ 到 $\\omega_2 = \\pi/2$ 的定积分：\n$$\\int_{\\pi/4}^{\\pi/2} |H(\\omega)|^2 d\\omega = \\int_{\\pi/4}^{\\pi/2} (6 - 8\\cos(\\omega) + 2\\cos(2\\omega)) d\\omega$$\n不定积分为：\n$$\\left[ 6\\omega - 8\\sin(\\omega) + \\sin(2\\omega) \\right]_{\\pi/4}^{\\pi/2}$$\n在上限 $\\omega = \\pi/2$ 处求值：\n$$6\\left(\\frac{\\pi}{2}\\right) - 8\\sin\\left(\\frac{\\pi}{2}\\right) + \\sin(\\pi) = 3\\pi - 8(1) + 0 = 3\\pi - 8$$\n在下限 $\\omega = \\pi/4$ 处求值：\n$$6\\left(\\frac{\\pi}{4}\\right) - 8\\sin\\left(\\frac{\\pi}{4}\\right) + \\sin\\left(\\frac{\\pi}{2}\\right) = \\frac{3\\pi}{2} - 8\\left(\\frac{\\sqrt{2}}{2}\\right) + 1 = \\frac{3\\pi}{2} - 4\\sqrt{2} + 1$$\n从上限值中减去下限值：\n$$\\text{Integral} = (3\\pi - 8) - \\left(\\frac{3\\pi}{2} - 4\\sqrt{2} + 1\\right) = 3\\pi - \\frac{3\\pi}{2} - 8 - 1 + 4\\sqrt{2} = \\frac{3\\pi}{2} - 9 + 4\\sqrt{2}$$\n最后，我们计算 $R$：\n$$R = \\frac{1}{\\pi/4} \\left( \\frac{3\\pi}{2} - 9 + 4\\sqrt{2} \\right) = \\frac{4}{\\pi} \\left( \\frac{3\\pi}{2} - 9 + 4\\sqrt{2} \\right)$$\n$$R = \\frac{4}{\\pi}\\frac{3\\pi}{2} - \\frac{4 \\cdot 9}{\\pi} + \\frac{4 \\cdot 4\\sqrt{2}}{\\pi} = 6 - \\frac{36}{\\pi} + \\frac{16\\sqrt{2}}{\\pi}$$\n为了获得数值，我们使用 $\\pi \\approx 3.14159$ 和 $\\sqrt{2} \\approx 1.41421$：\n$$R \\approx 6 - \\frac{36}{3.14159} + \\frac{16(1.41421)}{3.14159}$$\n$$R \\approx 6 - 11.45916 + 7.20255 \\approx 1.74339$$\n四舍五入到四位有效数字，结果是 $1.743$。",
            "answer": "$$\\boxed{1.743}$$"
        }
    ]
}