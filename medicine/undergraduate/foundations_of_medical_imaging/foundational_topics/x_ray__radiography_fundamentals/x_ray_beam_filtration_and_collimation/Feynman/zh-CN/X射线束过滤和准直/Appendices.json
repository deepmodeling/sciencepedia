{
    "hands_on_practices": [
        {
            "introduction": "在评估X射线成像系统时，首要步骤之一是量化X射线管本身固有的滤波效应，这被称为“固有滤波”。这些滤波效应源于X射线穿过球管的玻璃外壳、绝缘油和出束窗口等组件。此练习  旨在通过计算等效铝厚度来量化这种固有滤波，即找出能产生相同X射线束衰减效果的标准铝滤片的厚度。这个基础计算将巩固您对指数衰减定律以及材料密度和衰减系数等物理特性的理解。",
            "id": "4942161",
            "problem": "一个用于普通射线照相的X射线管，在$70~\\text{kVp}$的参考千伏峰值(kVp)下工作，其产生的射线束沿出射路径穿过三个固有过滤部件：厚度为$0.20~\\text{mm}$的硼硅酸盐玻璃外壳、厚度为$4.0~\\text{mm}$的矿物油层，以及厚度为$0.80~\\text{mm}$的铍出射窗。假设为窄束条件（散射可忽略不计），且透射的空气比释动能与透射的能量注量成正比。在此工作条件下，将多能谱近似为有效单能射线束，并使用指数衰减定律。在有效能量下的质量衰减系数$\\mu/\\rho$如下：铝 $(\\mu/\\rho)_{\\text{Al}} = 0.215~\\text{cm}^{2}\\,\\text{g}^{-1}$；铍 $(\\mu/\\rho)_{\\text{Be}} = 0.137~\\text{cm}^{2}\\,\\text{g}^{-1}$；矿物油 $(\\mu/\\rho)_{\\text{oil}} = 0.25~\\text{cm}^{2}\\,\\text{g}^{-1}$；以及硼硅酸盐玻璃 $(\\mu/\\rho)_{\\text{glass}} = 0.24~\\text{cm}^{2}\\,\\text{g}^{-1}$。材料密度为：铝 $\\rho_{\\text{Al}} = 2.70~\\text{g}\\,\\text{cm}^{-3}$，铍 $\\rho_{\\text{Be}} = 1.85~\\text{g}\\,\\text{cm}^{-3}$，矿物油 $\\rho_{\\text{oil}} = 0.86~\\text{g}\\,\\text{cm}^{-3}$，以及硼硅酸盐玻璃 $\\rho_{\\text{glass}} = 2.23~\\text{g}\\,\\text{cm}^{-3}$。\n\n利用这些数据并从第一性原理出发，确定等效铝厚度$t_{\\text{eq,Al}}$，该厚度产生的透射空气比释动能与这三个部件组合过滤产生的相同。请以毫米铝（mm Al）为单位表示您的最终答案，并四舍五入至三位有效数字。",
            "solution": "该问题是有效的。它在科学上基于辐射物理学原理，特别是指数衰减定律。问题提法得当、客观，并包含了推导唯一解所需的所有信息。\n\n单能X射线束穿过材料时，其透射遵循的基本原理是指数衰减定律。在指定的窄束条件和将多能谱近似为有效单能射线束的假设下，透射空气比释动能$K$与入射空气比释动能$K_0$的关系为：\n$$K = K_0 \\exp(-\\mu t)$$\n其中$\\mu$是材料的线性衰减系数，$t$是其厚度。问题指出，透射空气比释动能与透射能量注量成正比，这证实了该关系式可用于比释动能。\n\n线性衰减系数$\\mu$是质量衰减系数$\\frac{\\mu}{\\rho}$与材料密度$\\rho$的乘积：\n$$\\mu = \\left(\\frac{\\mu}{\\rho}\\right) \\rho$$\n\n当X射线束穿过一系列$N$种不同材料时，总衰减是每一层衰减因子的乘积。透射比释动能$K_{\\text{trans}}$由下式给出：\n$$K_{\\text{trans}} = K_0 \\left( \\exp(-\\mu_1 t_1) \\right) \\left( \\exp(-\\mu_2 t_2) \\right) \\dots \\left( \\exp(-\\mu_N t_N) \\right) = K_0 \\exp\\left(-\\sum_{i=1}^{N} \\mu_i t_i\\right)$$\n\n在此问题中，射线束穿过三个固有过滤部件：铍(Be)、矿物油(oil)和硼硅酸盐玻璃(glass)。因此，透射比释动能为：\n$$K_{\\text{trans}} = K_0 \\exp\\left(-(\\mu_{\\text{Be}} t_{\\text{Be}} + \\mu_{\\text{oil}} t_{\\text{oil}} + \\mu_{\\text{glass}} t_{\\text{glass}})\\right)$$\n我们需要找到产生相同衰减的等效铝厚度$t_{\\text{eq,Al}}$。对于此等效滤片，透射比释动能为：\n$$K_{\\text{trans}} = K_0 \\exp\\left(-\\mu_{\\text{Al}} t_{\\text{eq,Al}}\\right)$$\n为使衰减等效，两个表达式中的指数必须相等：\n$$\\mu_{\\text{Al}} t_{\\text{eq,Al}} = \\mu_{\\text{Be}} t_{\\text{Be}} + \\mu_{\\text{oil}} t_{\\text{oil}} + \\mu_{\\text{glass}} t_{\\text{glass}}$$\n将每种材料的表达式$\\mu = (\\mu/\\rho)\\rho$代入，我们得到：\n$$\\left(\\frac{\\mu}{\\rho}\\right)_{\\text{Al}} \\rho_{\\text{Al}} t_{\\text{eq,Al}} = \\left(\\frac{\\mu}{\\rho}\\right)_{\\text{Be}} \\rho_{\\text{Be}} t_{\\text{Be}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\text{oil}} \\rho_{\\text{oil}} t_{\\text{oil}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\text{glass}} \\rho_{\\text{glass}} t_{\\text{glass}}$$\n现在我们可以求解等效铝厚度$t_{\\text{eq,Al}}$：\n$$t_{\\text{eq,Al}} = \\frac{\\left(\\frac{\\mu}{\\rho}\\right)_{\\text{Be}} \\rho_{\\text{Be}} t_{\\text{Be}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\text{oil}} \\rho_{\\text{oil}} t_{\\text{oil}} + \\left(\\frac{\\mu}{\\rho}\\right)_{\\text{glass}} \\rho_{\\text{glass}} t_{\\text{glass}}}{\\left(\\frac{\\mu}{\\rho}\\right)_{\\text{Al}} \\rho_{\\text{Al}}}$$\n给定值为：\n- $t_{\\text{Be}} = 0.80~\\text{mm}$\n- $t_{\\text{oil}} = 4.0~\\text{mm}$\n- $t_{\\text{glass}} = 0.20~\\text{mm}$\n- $(\\mu/\\rho)_{\\text{Be}} = 0.137~\\text{cm}^{2}\\,\\text{g}^{-1}$ 和 $\\rho_{\\text{Be}} = 1.85~\\text{g}\\,\\text{cm}^{-3}$\n- $(\\mu/\\rho)_{\\text{oil}} = 0.25~\\text{cm}^{2}\\,\\text{g}^{-1}$ 和 $\\rho_{\\text{oil}} = 0.86~\\text{g}\\,\\text{cm}^{-3}$\n- $(\\mu/\\rho)_{\\text{glass}} = 0.24~\\text{cm}^{2}\\,\\text{g}^{-1}$ 和 $\\rho_{\\text{glass}} = 2.23~\\text{g}\\,\\text{cm}^{-3}$\n- $(\\mu/\\rho)_{\\text{Al}} = 0.215~\\text{cm}^{2}\\,\\text{g}^{-1}$ 和 $\\rho_{\\text{Al}} = 2.70~\\text{g}\\,\\text{cm}^{-3}$\n\n为保持量纲一致性，所有厚度值必须转换为厘米（$1~\\text{mm} = 0.1~\\text{cm}$）：\n- $t_{\\text{Be}} = 0.080~\\text{cm}$\n- $t_{\\text{oil}} = 0.40~\\text{cm}$\n- $t_{\\text{glass}} = 0.020~\\text{cm}$\n\n现在，我们计算每种材料的线性衰减系数$\\mu_i$：\n- $\\mu_{\\text{Be}} = (0.137~\\text{cm}^{2}\\,\\text{g}^{-1}) \\times (1.85~\\text{g}\\,\\text{cm}^{-3}) = 0.25345~\\text{cm}^{-1}$\n- $\\mu_{\\text{oil}} = (0.25~\\text{cm}^{2}\\,\\text{g}^{-1}) \\times (0.86~\\text{g}\\,\\text{cm}^{-3}) = 0.215~\\text{cm}^{-1}$\n- $\\mu_{\\text{glass}} = (0.24~\\text{cm}^{2}\\,\\text{g}^{-1}) \\times (2.23~\\text{g}\\,\\text{cm}^{-3}) = 0.5352~\\text{cm}^{-1}$\n- $\\mu_{\\text{Al}} = (0.215~\\text{cm}^{2}\\,\\text{g}^{-1}) \\times (2.70~\\text{g}\\,\\text{cm}^{-3}) = 0.5805~\\text{cm}^{-1}$\n\n接下来，我们计算$t_{\\text{eq,Al}}$表达式中分子的各项：\n- 铍项: $\\mu_{\\text{Be}} t_{\\text{Be}} = (0.25345~\\text{cm}^{-1}) \\times (0.080~\\text{cm}) = 0.020276$\n- 油项: $\\mu_{\\text{oil}} t_{\\text{oil}} = (0.215~\\text{cm}^{-1}) \\times (0.40~\\text{cm}) = 0.086$\n- 玻璃项: $\\mu_{\\text{glass}} t_{\\text{glass}} = (0.5352~\\text{cm}^{-1}) \\times (0.020~\\text{cm}) = 0.010704$\n\n这些项的和（复合滤片的总指数）为：\n$$\\sum \\mu_i t_i = 0.020276 + 0.086 + 0.010704 = 0.11698$$\n现在我们可以计算$t_{\\text{eq,Al}}$：\n$$t_{\\text{eq,Al}} = \\frac{\\sum \\mu_i t_i}{\\mu_{\\text{Al}}} = \\frac{0.11698}{0.5805~\\text{cm}^{-1}} \\approx 0.201516~\\text{cm}$$\n问题要求答案以毫米（mm）为单位，并四舍五入到三位有效数字。\n$$t_{\\text{eq,Al}} \\approx 0.201516~\\text{cm} \\times \\frac{10~\\text{mm}}{1~\\text{cm}} \\approx 2.01516~\\text{mm}$$\n四舍五入到三位有效数字得到$2.02~\\text{mm}$。",
            "answer": "$$\\boxed{2.02}$$"
        },
        {
            "introduction": "在临床实践中，对滤过和准直等技术参数的调整会对探测器接收到的信号产生直接影响。例如，减少滤过会增加到达探测器的光子数量，而扩大准直范围则会增加散射辐射的比例。本练习  提出了一个实际场景，要求您预测因技术参数改变而导致的探测器信号变化，并识别可能出现的探测器饱和等问题。通过解决这个实际问题，您将学会如何定量分析技术调整对探测器入射空气动能的影响，并掌握如何调整曝光参数以避免数据丢失，从而保持最佳的图像采集条件。",
            "id": "4942160",
            "problem": "一款用于普通放射成像的平板X射线探测器，其线性响应范围直至探测器入射空气比释动能阈值$K_{\\mathrm{sat}} = 0.75 \\,\\mathrm{mGy}$，超过此阈值后，其信号因饱和而变为非线性。某次检查在管电压为$100 \\,\\mathrm{kVp}$、源-探测器距离为$100 \\,\\mathrm{cm}$的条件下，使用一个$15 \\,\\mathrm{cm}$的水等效板状模体进行。当使用边长为$20 \\,\\mathrm{cm}$的方形准直野，并附加$t_{\\mathrm{ref}} = 3.0 \\,\\mathrm{mm}$的铝滤过（固有滤过之外）时，校准后的每毫安秒主射线探测器入射空气比释动能为$Y_{\\mathrm{ref}} = 0.050 \\,\\mathrm{mGy/mAs}$。当滤过厚度减至$t_{\\mathrm{new}} = 1.0 \\,\\mathrm{mm}$铝时，忽略谱硬化效应，附加铝的透射可由在射线束有效能量下的单一有效线性衰减系数$\\mu_{\\mathrm{eff}} = 0.18 \\,\\mathrm{mm}^{-1}$来近似。在滤过减小的情况下，操作员还将准直野扩大到$35 \\,\\mathrm{cm} \\times 35 \\,\\mathrm{cm}$，此时探测器处的散射-主射线比（SPR）为$s_{f} = 0.25$；假设在$20 \\,\\mathrm{cm} \\times 20 \\,\\mathrm{cm}$照射野下的SPR较低，并且在将$Y_{\\mathrm{ref}}$校准为主射线量时已被考虑。\n\n操作员选择了$I = 800 \\,\\mathrm{mA}$的管电流和$t_{\\mathrm{exp}} = 25 \\,\\mathrm{ms}$的曝光时间，管电压和几何条件保持不变。利用附加滤过中的指数衰减和主射线比释动能与毫安秒积的线性缩放这些基于物理原理的关系，以及探测器总比释动能是主射线和散射成分之和（可建模为$K_{\\mathrm{det}} = K_{\\mathrm{primary}} (1 + s_{f})$）的定义，判断在这些新设置下探测器是否会饱和，并计算在$800 \\,\\mathrm{mA}$下，为使$K_{\\mathrm{det}}$在减小滤过和扩大准直的条件下保持在$K_{\\mathrm{sat}}$或以下所需的最短曝光时间。将你的答案四舍五入至四位有效数字，并以毫秒为单位表示。",
            "solution": "本题将首先被验证，如果有效，将通过应用X射线物理学的基本原理来解决，包括指数衰减、X射线管输出与曝光设置之间的关系，以及散射对探测器总信号的贡献。\n\n首先，对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 探测器饱和阈值：$K_{\\mathrm{sat}} = 0.75 \\,\\mathrm{mGy}$\n- 管电压：$100 \\,\\mathrm{kVp}$\n- 模体：$15 \\,\\mathrm{cm}$ 水等效板状模体\n- 源-探测器距离：$100 \\,\\mathrm{cm}$\n- 参考附加铝滤过：$t_{\\mathrm{ref}} = 3.0 \\,\\mathrm{mm}$\n- 参考准直野：$20 \\,\\mathrm{cm} \\times 20 \\,\\mathrm{cm}$\n- 参考每mAs主射线探测器入射空气比释动能：$Y_{\\mathrm{ref}} = 0.050 \\,\\mathrm{mGy/mAs}$\n- 新附加铝滤过：$t_{\\mathrm{new}} = 1.0 \\,\\mathrm{mm}$\n- 铝的有效线性衰减系数：$\\mu_{\\mathrm{eff}} = 0.18 \\,\\mathrm{mm}^{-1}$\n- 新准直野：$35 \\,\\mathrm{cm} \\times 35 \\,\\mathrm{cm}$\n- 新照射野的散射-主射线比：$s_{f} = 0.25$\n- 建议的管电流：$I = 800 \\,\\mathrm{mA}$\n- 建议的曝光时间：$t_{\\mathrm{exp}} = 25 \\,\\mathrm{ms}$\n- 探测器总比释动能模型：$K_{\\mathrm{det}} = K_{\\mathrm{primary}} (1 + s_{f})$\n- 假设：忽略谱硬化。\n- 假设：$Y_{\\mathrm{ref}}$是一个主射线比释动能值，来自参考照射野的散射已被排除。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学上成立**：该问题很好地基于诊断医学物理学的原理。它使用了X射线衰减的标准模型（比尔-朗伯定律）、比释动能对毫安秒（mAs）的线性依赖关系，以及主辐射和散射辐射的叠加性质。管电压、滤过、比释动能率、衰减系数和探测器饱和度的数值对于普通放射成像来说在物理上是现实的。\n- **适定性**：问题是适定的。它提供了足够的信息来计算新条件下的探测器比释动能并确定曝光时间限制。关于“最短曝光时间”的问题略有歧义，但在物理学中，其标准解释是找到满足边界条件的最大允许值。\n- **客观性**：问题使用精确、客观的语言和定量数据来陈述。\n\n该问题没有违反任何无效标准。它在科学上是合理的、可形式化的、完整的，并基于已建立的物理模型提出了一个可解的问题。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整的解答。\n\n**解答推导**\n\n解答过程分两部分。首先，我们确定在建议的设置下探测器是否饱和。其次，我们计算避免饱和的最大曝光时间。\n\n建议曝光的毫安秒积（$mAs$）是管电流 $I$ 和曝光时间 $t_{\\mathrm{exp}}$ 的乘积。\n$$mAs_{\\mathrm{new}} = I \\cdot t_{\\mathrm{exp}} = (800 \\,\\mathrm{mA}) \\cdot (25 \\,\\mathrm{ms}) = (800 \\,\\mathrm{mA}) \\cdot (0.025 \\,\\mathrm{s}) = 20 \\,\\mathrm{mAs}$$\n\n接下来，我们必须确定新滤过厚度 $t_{\\mathrm{new}} = 1.0 \\,\\mathrm{mm}$ 下的主射线比释动能产额。参考产额 $Y_{\\mathrm{ref}} = 0.050 \\,\\mathrm{mGy/mAs}$ 对应于参考滤过厚度 $t_{\\mathrm{ref}} = 3.0 \\,\\mathrm{mm}$。我们可以使用指数衰减定律来模拟附加滤过的效果。设 $Y_0$ 是附加铝滤过前的主射线比释动能产额。那么，参考主射线产额 $Y_{\\mathrm{ref}}$ 和新主射线产额 $Y_{\\mathrm{new, primary}}$ 分别由以下公式给出：\n$$Y_{\\mathrm{ref}} = Y_0 \\exp(-\\mu_{\\mathrm{eff}} t_{\\mathrm{ref}})$$\n$$Y_{\\mathrm{new, primary}} = Y_0 \\exp(-\\mu_{\\mathrm{eff}} t_{\\mathrm{new}})$$\n新主射线产额与参考产额之比为：\n$$\\frac{Y_{\\mathrm{new, primary}}}{Y_{\\mathrm{ref}}} = \\frac{Y_0 \\exp(-\\mu_{\\mathrm{eff}} t_{\\mathrm{new}})}{Y_0 \\exp(-\\mu_{\\mathrm{eff}} t_{\\mathrm{ref}})} = \\exp(-\\mu_{\\mathrm{eff}} (t_{\\mathrm{new}} - t_{\\mathrm{ref}}))$$\n因此，新的主射线比释动能产额为：\n$$Y_{\\mathrm{new, primary}} = Y_{\\mathrm{ref}} \\exp(-\\mu_{\\mathrm{eff}} (t_{\\mathrm{new}} - t_{\\mathrm{ref}}))$$\n代入给定值：\n$$Y_{\\mathrm{new, primary}} = (0.050 \\,\\mathrm{mGy/mAs}) \\cdot \\exp(-0.18 \\,\\mathrm{mm}^{-1} \\cdot (1.0 \\,\\mathrm{mm} - 3.0 \\,\\mathrm{mm}))$$\n$$Y_{\\mathrm{new, primary}} = (0.050 \\,\\mathrm{mGy/mAs}) \\cdot \\exp(-0.18 \\cdot (-2.0)) = (0.050 \\,\\mathrm{mGy/mAs}) \\cdot \\exp(0.36)$$\n\n现在，我们可以计算建议曝光下的主射线比释动能 $K_{\\mathrm{primary}}$：\n$$K_{\\mathrm{primary}} = Y_{\\mathrm{new, primary}} \\cdot mAs_{\\mathrm{new}} = (0.050 \\cdot \\exp(0.36) \\,\\mathrm{mGy/mAs}) \\cdot (20 \\,\\mathrm{mAs})$$\n$$K_{\\mathrm{primary}} = 1.0 \\cdot \\exp(0.36) \\,\\mathrm{mGy}$$\n\n探测器总比释动能 $K_{\\mathrm{det}}$ 是主射线和散射分量的和，模型为 $K_{\\mathrm{det}} = K_{\\mathrm{primary}} (1 + s_{f})$，其中 $s_{f} = 0.25$ 是新的、更大照射野尺寸下的散射-主射线比。\n$$K_{\\mathrm{det}} = K_{\\mathrm{primary}} (1 + 0.25) = 1.25 \\cdot K_{\\mathrm{primary}}$$\n$$K_{\\mathrm{det}} = 1.25 \\cdot (1.0 \\cdot \\exp(0.36) \\,\\mathrm{mGy}) = 1.25 \\cdot \\exp(0.36) \\,\\mathrm{mGy}$$\n数值上，这等于 $K_{\\mathrm{det}} \\approx 1.25 \\cdot 1.433329 = 1.79166 \\,\\mathrm{mGy}$。\n我们将此值与饱和阈值 $K_{\\mathrm{sat}} = 0.75 \\,\\mathrm{mGy}$ 进行比较。由于 $1.79166 \\,\\mathrm{mGy} > 0.75 \\,\\mathrm{mGy}$，探测器在建议的条件下确实会饱和。\n\n问题的第二部分要求计算使探测器比释动能保持在饱和阈值或以下的曝光时间。虽然“最短曝光时间”的措辞有歧义，但标准的物理解释是找到最大允许曝光时间 $t_{\\mathrm{max}}$，在该时间下比释动能恰好等于饱和阈值。任何比这个时间短的曝光也会导致比释动能低于阈值。我们设定 $K_{\\mathrm{det}} = K_{\\mathrm{sat}}$：\n$$K_{\\mathrm{sat}} = K_{\\mathrm{primary}} (1 + s_{f})$$\n设所需的mAs积为 $mAs_{\\mathrm{max}} = I \\cdot t_{\\mathrm{max}}$。\n$$K_{\\mathrm{sat}} = (Y_{\\mathrm{new, primary}} \\cdot mAs_{\\mathrm{max}}) (1 + s_{f}) = (Y_{\\mathrm{new, primary}} \\cdot I \\cdot t_{\\mathrm{max}}) (1 + s_{f})$$\n我们求解 $t_{\\mathrm{max}}$：\n$$t_{\\mathrm{max}} = \\frac{K_{\\mathrm{sat}}}{Y_{\\mathrm{new, primary}} \\cdot I \\cdot (1 + s_{f})}$$\n代入 $Y_{\\mathrm{new, primary}}$ 的表达式：\n$$t_{\\mathrm{max}} = \\frac{K_{\\mathrm{sat}}}{Y_{\\mathrm{ref}} \\exp(-\\mu_{\\mathrm{eff}} (t_{\\mathrm{new}} - t_{\\mathrm{ref}})) \\cdot I \\cdot (1 + s_{f})}$$\n现在，我们代入数值。$t_{\\mathrm{max}}$ 的结果将以秒为单位，因为单位为 $(\\mathrm{mGy}) / [(\\mathrm{mGy}/\\mathrm{mAs}) \\cdot (\\mathrm{mA}) \\cdot (\\mathrm{无量纲})] = (\\mathrm{mGy}) / [(\\mathrm{mGy}/(\\mathrm{mA}\\cdot\\mathrm{s})) \\cdot (\\mathrm{mA})] = \\mathrm{s}$。\n$$t_{\\mathrm{max}} = \\frac{0.75}{0.050 \\cdot \\exp(0.36) \\cdot 800 \\cdot (1 + 0.25)}$$\n$$t_{\\mathrm{max}} = \\frac{0.75}{0.050 \\cdot \\exp(0.36) \\cdot 800 \\cdot 1.25} = \\frac{0.75}{0.050 \\cdot \\exp(0.36) \\cdot 1000}$$\n$$t_{\\mathrm{max}} = \\frac{0.75}{50 \\cdot \\exp(0.36)} = \\frac{0.015}{\\exp(0.36)} \\,\\mathrm{s}$$\n$$t_{\\mathrm{max}} \\approx 0.0104651 \\,\\mathrm{s}$$\n题目要求答案以毫秒为单位，并四舍五入到四位有效数字。\n$$t_{\\mathrm{max}} \\approx 10.4651 \\,\\mathrm{ms}$$\n四舍五入到四位有效数字得到 $10.47 \\,\\mathrm{ms}$。",
            "answer": "$$\\boxed{10.47}$$"
        },
        {
            "introduction": "医学成像的核心目标之一是在保证诊断图像质量的同时，尽可能降低患者所受的辐射剂量，这正是ALARA（As Low As Reasonably Achievable）原则的精髓。这需要在图像质量和辐射剂量之间做出审慎的权衡。这个综合性练习  将引导您构建一个计算模型，该模型模拟了从X射线谱产生、滤过、患者衰减到最终的图像质量（$d'$）和有效剂量（$E_{\\mathrm{eff}}$）的完整成像链。通过执行系统性优化，您将能够为特定的儿科检查找到最佳的滤过和准直设置，从而深入、定量地理解在现代医学成像中至关重要的剂量与质量之间的平衡关系。",
            "id": "4942112",
            "problem": "您的任务是开发一个完整、可运行的程序，以确定X射线束的滤过和准直设置，从而在管电压介于 $60\\,\\mathrm{kVp}$ 和 $80\\,\\mathrm{kVp}$ 之间时，最小化儿科腹部投影成像的有效剂量，同时确保软组织病变的最小可探测性指数 $d'$。解决方案必须源自诊断放射学中使用的基本物理原理和经过充分检验的公式，并且必须以纯粹的数学和逻辑术语表达。\n\n从以下符合上下文的基本基础开始：\n- 比尔-朗伯衰减定律：能量为 $E$ 的单能光子束穿过厚度为 $x$ 的材料后，其透射率 $T(E) = \\exp(-\\mu(E)\\,x)$，其中 $\\mu(E)$ 是线性衰减系数。\n- 基于克拉默斯定律的多能管谱模型：钨阳极未经滤过的韧致辐射光子谱与 $(E_{\\max} - E)\\,E$ 成正比，其中光子能量 $E$ 的单位为 $\\mathrm{keV}$，$E_{\\max}$ 在数值上等于管电压（单位为 $\\mathrm{kVp}$）的 $\\mathrm{keV}$ 值，$E_{\\min}$ 是由实际滤过决定的低能截止值。您的程序必须在 $E_{\\min} = 15\\,\\mathrm{keV}$ 到 $E_{\\max} = \\mathrm{kVp}$ 的范围内，以 $1\\,\\mathrm{keV}$ 为步长，在均匀网格上对能量进行离散化。将离散谱归一化，使得每毫安秒（$\\mathrm{mAs}$）的总光子数为 $N_0$，其中 $N_0$ 是下面指定的固定常数。\n- 铝的滤过：厚度为 $t$（单位为 $\\mathrm{mm}$ 铝）的附加铝滤过片根据比尔-朗伯定律衰减光子，使用铝的线性衰减系数 $\\mu_{\\mathrm{Al}}(E) = \\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E)\\,\\rho_{\\mathrm{Al}}$。使用铝密度 $\\rho_{\\mathrm{Al}} = 2.7\\,\\mathrm{g/cm^3}$。对于质量衰减系数，使用二项式近似 $\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{Al}}(E) = \\frac{a_{\\mathrm{Al}}}{E^3} + b_{\\mathrm{Al}}$，其中 $a_{\\mathrm{Al}} = 6186$，$b_{\\mathrm{Al}} = 0.0731$，$E$ 的单位为 $\\mathrm{keV}$，$\\left(\\frac{\\mu}{\\rho}\\right)$ 的单位为 $\\mathrm{cm^2/g}$。\n- 患者软组织的衰减：将软组织（类水）建模为密度 $\\rho_{\\mathrm{tis}} = 1.0\\,\\mathrm{g/cm^3}$，并使用类似的二项式质量衰减近似 $\\left(\\frac{\\mu}{\\rho}\\right)_{\\mathrm{tis}}(E) = \\frac{a_{\\mathrm{tis}}}{E^3} + b_{\\mathrm{tis}}$，其中 $a_{\\mathrm{tis}} = 3050$，$b_{\\mathrm{tis}} = 0.187$。\n- 图像质量与可探测性：使用 Rose 模型处理量子限制系统，其中可探测性指数 $d'$ 的缩放关系为 $d' = C_{\\mathrm{eff}}\\,\\sqrt{D\\,N_{\\mathrm{det}}}$，$C_{\\mathrm{eff}}$ 是散射后的病变有效对比度，$D$ 是探测量子效率（DQE），$N_{\\mathrm{det}}$ 是感兴趣区域内探测到的量子数。使用一个恒定的 $D = 0.6$。设基础软组织病变对比度（无散射）为 $C_0$，并使用一个散射分数来模拟由散射引起的衰减，该散射分数与准直场面积 $A$（单位为 $\\mathrm{cm^2}$）呈线性关系：$SF(A) = SF_{\\min} + \\left(SF_{\\max} - SF_{\\min}\\right)\\,\\frac{A - A_{\\min}}{A_{\\max} - A_{\\min}}$，限制在 $[SF_{\\min}, SF_{\\max}]$ 范围内，其中 $SF_{\\min} = 0.2$ 对应 $A_{\\min} = 100\\,\\mathrm{cm^2}$，$SF_{\\max} = 0.5$ 对应 $A_{\\max} = 400\\,\\mathrm{cm^2}$。则 $C_{\\mathrm{eff}} = C_0\\,(1 - SF(A))$。\n- 剂量模型：设每 $\\mathrm{mAs}$ 的入射空气比释动能随管电压的变化关系为 $K_0\\,\\left(\\frac{\\mathrm{kVp}}{70}\\right)^2$，其中 $K_0 = 0.06\\,\\mathrm{mGy/mAs}$ 是在 $70\\,\\mathrm{kVp}$ 下未经滤过的参考束的值。通过能量注量透射因子 $F_{\\mathrm{filter}} = \\frac{\\sum_E S_0(E)\\,E\\,T_{\\mathrm{f}}(E)}{\\sum_E S_0(E)\\,E}$ 对这个基础的每 $\\mathrm{mAs}$ 空气比释动能进行加权，以考虑附加滤过，其中 $S_0(E)$ 是每 $\\mathrm{mAs}$ 的归一化源光子谱，$T_{\\mathrm{f}}(E) = \\exp\\!\\big(-\\mu_{\\mathrm{Al}}(E)\\,t_{\\mathrm{cm}}\\big)$，$t_{\\mathrm{cm}}$ 的单位为 $\\mathrm{cm}$。剂量面积乘积 (DAP) 为 $\\mathrm{DAP} = K_{\\mathrm{a}}^{(1)}\\,mAs\\,BSF\\,A$，其中反向散射因子 (BSF) $BSF = 1.3$。使用一个常数因子 $k_{\\mathrm{DAP}} = 3.0\\times10^{-4}\\,\\mathrm{mSv}/(\\mathrm{mGy\\cdot cm^2})$ 将 DAP 转换为有效剂量 $E_{\\mathrm{eff}}$。\n\n为计算精确定义以下量：\n- 离散化的光子能量 $E_i$，对于 $i = 1,2,\\ldots,N$，从 $15\\,\\mathrm{keV}$ 到 $\\mathrm{kVp}$，步长为 $1\\,\\mathrm{keV}$。\n- 未经滤过的离散谱权重 $w_i \\propto (\\mathrm{kVp} - E_i)\\,E_i$。进行归一化，使得 $\\sum_i S_0(E_i) = N_0$ 光子每 $\\mathrm{mAs}$，其中 $N_0 = 10^6$。\n- 附加滤过厚度选项 $t \\in \\{1.5,\\,2.5,\\,3.5,\\,4.5,\\,5.5\\}\\,\\mathrm{mm}$ 铝。\n- 准直场面积选项 $A \\in \\{100,\\,150,\\,200,\\,250,\\,300,\\,350,\\,400\\}\\,\\mathrm{cm^2}$。\n- 有效对比度模型 $C_{\\mathrm{eff}} = C_0\\,(1 - SF(A))$，其中 $C_0 = 0.03$。\n- 患者厚度 $x$（单位 $\\mathrm{cm}$），其透射率 $T_{\\mathrm{p}}(E) = \\exp\\!\\big(-\\mu_{\\mathrm{tis}}(E)\\,x\\big)$。\n\n对于一个选定的 $(t, A)$，计算：\n1. 经过滤过和患者衰减后，每 $\\mathrm{mAs}$ 探测到的光子数，\n$$\nN_{\\mathrm{det}}^{(1)} = \\sum_i S_0(E_i)\\,T_{\\mathrm{f}}(E_i)\\,T_{\\mathrm{p}}(E_i).\n$$\n2. 达到最小可探测性指数 $d'_{\\min}$ 所需的 $\\mathrm{mAs}$，\n$$\nmAs_{\\mathrm{req}} = \\left(\\frac{d'_{\\min}}{C_{\\mathrm{eff}}\\,\\sqrt{D\\,N_{\\mathrm{det}}^{(1)}}}\\right)^2.\n$$\n3. 考虑滤过时每 $\\mathrm{mAs}$ 的入射空气比释动能，\n$$\nK_{\\mathrm{a}}^{(1)} = K_0\\left(\\frac{\\mathrm{kVp}}{70}\\right)^2 \\cdot \\frac{\\sum_i S_0(E_i)\\,E_i\\,T_{\\mathrm{f}}(E_i)}{\\sum_i S_0(E_i)\\,E_i}.\n$$\n4. 剂量面积乘积，\n$$\n\\mathrm{DAP} = K_{\\mathrm{a}}^{(1)} \\cdot mAs_{\\mathrm{req}} \\cdot BSF \\cdot A.\n$$\n5. 有效剂量，\n$$\nE_{\\mathrm{eff}} = k_{\\mathrm{DAP}} \\cdot \\mathrm{DAP}.\n$$\n\n优化目标：\n- 对于每个测试用例，在指定的离散集合中的所有 $(t,A)$ 中，选择能最小化标称患者厚度下的 $E_{\\mathrm{eff}}$，同时通过上述计算的 $mAs_{\\mathrm{req}}$ 满足可探测性约束的配对 $(t^*,A^*)$。\n\n对患者尺寸变化的鲁棒性：\n- 对于选定的 $(t^*,A^*)$，通过在患者厚度集合 $\\{x_0 - 2,\\,x_0,\\,x_0 + 2\\}\\,\\mathrm{cm}$ 上评估 $E_{\\mathrm{eff}}$ 来量化鲁棒性，并在每个厚度下重新计算 $mAs_{\\mathrm{req}}$ 以维持 $d'_{\\min}$。报告变异系数 $R = \\sigma/\\mu$，其中 $\\sigma$ 是该集合上有效剂量的标准差，$\\mu$ 是平均值。\n\n单位和报告要求：\n- 以 $\\mathrm{mSv}$ 为单位表示有效剂量，四舍五入到三位有效数字。\n- 将鲁棒性变异系数 $R$ 表示为小数，四舍五入到三位小数。\n- 将铝滤过厚度以 $\\mathrm{mm}$ 为单位表示为一位小数的浮点数，将场面积以 $\\mathrm{cm^2}$ 为单位表示为整数。\n\n测试套件：\n- 使用以下四个测试用例，每个用例指定为 $(\\mathrm{kVp}, x_0, d'_{\\min}, C_0)$:\n    1. $(60,\\,10,\\,5,\\,0.03)$\n    2. $(70,\\,14,\\,5,\\,0.03)$\n    3. $(80,\\,18,\\,5,\\,0.03)$\n    4. $(80,\\,12,\\,5,\\,0.03)$\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是 $[t_{\\mathrm{mm}},A_{\\mathrm{cm^2}},E_{\\mathrm{mSv}},R]$ 形式的列表。整体输出必须是一个嵌套列表，如 $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$，只包含数值，不含额外文本。",
            "solution": "用户提供的问题被评估为有效。这是一个提法明确、有科学依据且计算上可行的优化任务，其根植于医学成像物理学的基本原理。所有必要的模型、常数和参数都已提供，并且目标已明确定义。该问题要求综合运用X射线谱生成、光子衰减、图像质量度量和辐射剂量学等概念，以找到最优的成像参数。\n\n解决方案通过按规定实现物理模型和计算步骤来展开。解决方案的核心是系统性地搜索最优的X射线束滤过和准直设置，以便在给定成像任务中最小化对儿科患者的有效剂量，同时保持指定的图像质量水平。\n\n方法论的结构如下：\n\n1.  **物理过程建模**：\n    -   **X射线谱**：对于给定的管电压 $\\mathrm{kVp}$，基于克拉默斯定律对多能X射线谱进行建模。谱在能量网格上进行离散化，范围从 $E_{\\min} = 15\\,\\mathrm{keV}$ 到 $E_{\\max} = \\mathrm{kVp}$，步长为 $1\\,\\mathrm{keV}$。每个能量 $E_i$ 处的光子数 $S_0(E_i)$ 由 $S_0(E_i) \\propto (\\mathrm{kVp} - E_i)E_i$ 给出。然后对谱进行归一化，使得每毫安秒（$\\mathrm{mAs}$）的总光子数为 $\\sum_i S_0(E_i) = N_0 = 10^6$。\n    -   **光子衰减**：光子穿过材料的透射遵循比尔-朗伯定律，$T(E) = \\exp(-\\mu(E)x)$。线性衰减系数 $\\mu(E)$ 是根据所提供的质量衰减系数 $\\left(\\frac{\\mu}{\\rho}\\right)(E)$ 的二项式近似和材料密度 $\\rho$ 计算得出。\n        -   对于厚度为 $t$（单位 cm）的铝滤片，其透射率为 $T_{\\mathrm{f}}(E) = \\exp(-\\mu_{\\mathrm{Al}}(E)t)$，其中 $\\mu_{\\mathrm{Al}}(E) = \\left(\\frac{a_{\\mathrm{Al}}}{E^3} + b_{\\mathrm{Al}}\\right)\\rho_{\\mathrm{Al}}$。\n        -   对于厚度为 $x$（单位 cm）的患者（软组织），其透射率为 $T_{\\mathrm{p}}(E) = \\exp(-\\mu_{\\mathrm{tis}}(E)x)$，其中 $\\mu_{\\mathrm{tis}}(E) = \\left(\\frac{a_{\\mathrm{tis}}}{E^3} + b_{\\mathrm{tis}}\\right)\\rho_{\\mathrm{tis}}$。\n\n2.  **优化过程**：\n    目标是从给定的离散集合中找到能最小化有效剂量 $E_{\\mathrm{eff}}$ 的滤过厚度 $t^*$ 和准直场面积 $A^*$ 的配对。这通过对所有可能的配对 $(t, A)$ 进行网格搜索来实现。\n    -   滤过选项：$t \\in \\{1.5, 2.5, 3.5, 4.5, 5.5\\}\\,\\mathrm{mm}$。\n    -   面积选项：$A \\in \\{100, 150, 200, 250, 300, 350, 400\\}\\,\\mathrm{cm^2}$。\n\n    对于每对 $(t, A)$ 和给定的测试用例 $(\\mathrm{kVp}, x_0, d'_{\\min}, C_0)$，按顺序计算以下量：\n\n    -   **图像质量和所需曝光量**：\n        1.  每 $\\mathrm{mAs}$ 探测到的光子数 $N_{\\mathrm{det}}^{(1)}$，通过将每个能量的初始光子经过滤片和标称患者厚度 $x_0$ 衰减后求和计算得出：\n            $$N_{\\mathrm{det}}^{(1)} = \\sum_i S_0(E_i)\\,T_{\\mathrm{f}}(E_i)\\,T_{\\mathrm{p}}(E_i; x_0)$$\n        2.  有效对比度 $C_{\\mathrm{eff}}$ 由基础对比度 $C_0$ 和散射分数 $SF(A)$ 决定，后者是场面积 $A$ 的线性函数。使用的公式是 $C_{\\mathrm{eff}} = C_0\\,(1 - SF(A))$。\n        3.  然后，基于 Rose 模型计算达到目标可探测性指数 $d'_{\\min}$ 所需的管负载 $mAs_{\\mathrm{req}}$。计算中考虑了探测器的探测量子效率（$D=0.6$）：\n            $$mAs_{\\mathrm{req}} = \\left(\\frac{d'_{\\min}}{C_{\\mathrm{eff}}\\,\\sqrt{D\\,N_{\\mathrm{det}}^{(1)}}}\\right)^2$$\n\n    -   **剂量计算**：\n        1.  计算每 $\\mathrm{mAs}$ 的入射空气比释动能 $K_{\\mathrm{a}}^{(1)}$。此计算从 $70\\,\\mathrm{kVp}$ 时的参考比释动能开始，按 $(\\mathrm{kVp}/70)^2$ 进行缩放，然后使用能量注量透射因子 $F_{\\mathrm{filter}}$ 调整因滤片引起的射线束硬化：\n            $$K_{\\mathrm{a}}^{(1)} = K_0\\left(\\frac{\\mathrm{kVp}}{70}\\right)^2 \\cdot F_{\\mathrm{filter}} = K_0\\left(\\frac{\\mathrm{kVp}}{70}\\right)^2 \\cdot \\frac{\\sum_i S_0(E_i)\\,E_i\\,T_{\\mathrm{f}}(E_i)}{\\sum_i S_0(E_i)\\,E_i}$$\n        2.  剂量面积乘积（$DAP$）是入射比释动能、场面积和反向散射因子（$BSF=1.3$）的乘积。入射比释动能为 $K_{\\mathrm{a}}^{(1)} \\cdot mAs_{\\mathrm{req}}$。\n            $$\\mathrm{DAP} = K_{\\mathrm{a}}^{(1)} \\cdot mAs_{\\mathrm{req}} \\cdot BSF \\cdot A$$\n        3.  最后，通过将 DAP 乘以转换系数 $k_{\\mathrm{DAP}} = 3.0\\times10^{-4}\\,\\mathrm{mSv}/(\\mathrm{mGy\\cdot cm^2})$ 来求得有效剂量 $E_{\\mathrm{eff}}$：\n            $$E_{\\mathrm{eff}} = k_{\\mathrm{DAP}} \\cdot \\mathrm{DAP}$$\n\n    产生最低 $E_{\\mathrm{eff}}$ 的配对 $(t, A)$ 被选为最优设置 $(t^*, A^*)$。\n\n3.  **鲁棒性分析**：\n    为了评估解相对于患者尺寸变化的稳定性，在患者厚度范围 $\\{x_0 - 2, x_0, x_0 + 2\\}\\,\\mathrm{cm}$ 内评估最优设置 $(t^*, A^*)$ 的性能。对于此集合中的每个厚度，重新计算 $mAs_{\\mathrm{req}}$ 以维持目标可探测性 $d'_{\\min}$，并计算相应的 $E_{\\mathrm{eff}}$。鲁棒性通过变异系数 $R = \\sigma/\\mu$ 来量化，其中 $\\mu$ 和 $\\sigma$ 分别是三个所得有效剂量值的平均值和标准差。\n\n4.  **最终输出**：\n    对于每个测试用例，程序报告最优滤过厚度 $t^*$（单位 mm）、最优场面积 $A^*$（单位 $\\mathrm{cm^2}$）、标称患者厚度下最小化的有效剂量 $E_{\\mathrm{eff}}$（单位 mSv）以及鲁棒性系数 $R$。这些值根据指定的精度规则进行格式化。\n\n实现将是一个利用 `numpy` 库在离散化能量谱上进行高效数值计算的 Python 程序。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef round_to_sf(x, sf):\n    \"\"\"\n    Rounds a number to a specified number of significant figures.\n    \"\"\"\n    if x == 0:\n        return 0.0\n    return round(x, sf - 1 - int(math.floor(math.log10(abs(x)))))\n\ndef solve():\n    \"\"\"\n    Solves the X-ray optimization problem for the given test cases.\n    \"\"\"\n    # Define physical and model constants\n    RHO_AL = 2.7  # g/cm^3\n    A_AL = 6186.0\n    B_AL = 0.0731\n    RHO_TIS = 1.0  # g/cm^3\n    A_TIS = 3050.0\n    B_TIS = 0.187\n    DQE = 0.6\n    SF_MIN = 0.2\n    SF_MAX = 0.5\n    A_MIN = 100.0  # cm^2\n    A_MAX = 400.0  # cm^2\n    K0 = 0.06  # mGy/mAs at 70 kVp\n    BSF = 1.3\n    K_DAP = 3.0e-4  # mSv/(mGy.cm^2)\n    N0 = 1.0e6  # photons/mAs\n\n    # Define discrete choices for optimization parameters\n    t_choices_mm = np.array([1.5, 2.5, 3.5, 4.5, 5.5])\n    a_choices_cm2 = np.array([100, 150, 200, 250, 300, 350, 400])\n\n    # Define the test suite\n    test_cases = [\n        (60, 10, 5, 0.03),\n        (70, 14, 5, 0.03),\n        (80, 18, 5, 0.03),\n        (80, 12, 5, 0.03),\n    ]\n\n    all_results = []\n\n    for kvp, x0_cm, d_prime_min, c0 in test_cases:\n        # 1. Setup spectrum and attenuation data for the current kVp\n        energies = np.arange(15, kvp + 1, 1.0)  # keV\n        \n        # Unfiltered spectrum S0(E), normalized to N0\n        weights = (kvp - energies) * energies\n        s0 = N0 * weights / np.sum(weights)\n\n        # Attenuation coefficients\n        mu_rho_al = (A_AL / energies**3) + B_AL\n        mu_al = mu_rho_al * RHO_AL  # cm^-1\n        mu_rho_tis = (A_TIS / energies**3) + B_TIS\n        mu_tis = mu_rho_tis * RHO_TIS  # cm^-1\n\n        unfiltered_beam_energy = np.sum(s0 * energies)\n\n        # 2. Optimization loop to find (t*, A*)\n        min_eff_dose = float('inf')\n        optimal_t_mm = -1\n        optimal_a_cm2 = -1\n\n        for t_mm in t_choices_mm:\n            t_cm = t_mm / 10.0\n            T_f = np.exp(-mu_al * t_cm)\n            \n            for a_cm2 in a_choices_cm2:\n                # Patient transmission for nominal thickness\n                T_p = np.exp(-mu_tis * x0_cm)\n                \n                # Detected photons per mAs\n                N_det_per_mas = np.sum(s0 * T_f * T_p)\n\n                # Scatter fraction and effective contrast\n                sf_raw = SF_MIN + (SF_MAX - SF_MIN) * (a_cm2 - A_MIN) / (A_MAX - A_MIN)\n                sf = np.clip(sf_raw, SF_MIN, SF_MAX)\n                c_eff = c0 * (1 - sf)\n\n                # Required mAs\n                if N_det_per_mas > 0 and c_eff > 0:\n                    mas_req = (d_prime_min / (c_eff * np.sqrt(DQE * N_det_per_mas)))**2\n                else: \n                    continue\n\n                # Dose calculation\n                F_filter = np.sum(s0 * energies * T_f) / unfiltered_beam_energy\n                K_a_per_mas = K0 * (kvp / 70.0)**2 * F_filter\n                dap = K_a_per_mas * mas_req * BSF * a_cm2\n                eff_dose = K_DAP * dap\n\n                if eff_dose  min_eff_dose:\n                    min_eff_dose = eff_dose\n                    optimal_t_mm = t_mm\n                    optimal_a_cm2 = a_cm2\n\n        # 3. Robustness calculation for the optimal setting (t*, A*)\n        t_cm_opt = optimal_t_mm / 10.0\n        T_f_opt = np.exp(-mu_al * t_cm_opt)\n        \n        sf_opt_raw = SF_MIN + (SF_MAX - SF_MIN) * (optimal_a_cm2 - A_MIN) / (A_MAX - A_MIN)\n        sf_opt = np.clip(sf_opt_raw, SF_MIN, SF_MAX)\n        c_eff_opt = c0 * (1 - sf_opt)\n\n        F_filter_opt = np.sum(s0 * energies * T_f_opt) / unfiltered_beam_energy\n        K_a_per_mas_opt = K0 * (kvp / 70.0)**2 * F_filter_opt\n\n        thickness_set = [x0_cm - 2, x0_cm, x0_cm + 2]\n        robustness_doses = []\n\n        for x_cm in thickness_set:\n            T_p_robust = np.exp(-mu_tis * x_cm)\n            N_det_per_mas_robust = np.sum(s0 * T_f_opt * T_p_robust)\n            \n            if N_det_per_mas_robust > 0 and c_eff_opt > 0:\n                mas_req_robust = (d_prime_min / (c_eff_opt * np.sqrt(DQE * N_det_per_mas_robust)))**2\n            else:\n                mas_req_robust = float('inf')\n\n            dap_robust = K_a_per_mas_opt * mas_req_robust * BSF * optimal_a_cm2\n            eff_dose_robust = K_DAP * dap_robust\n            robustness_doses.append(eff_dose_robust)\n\n        # Coefficient of Variation R\n        if len(robustness_doses) > 1 and np.mean(robustness_doses) > 0:\n            R = np.std(robustness_doses, ddof=0) / np.mean(robustness_doses)\n        else:\n            R = 0.0\n\n        # 4. Format and store results\n        formatted_t = float(f\"{optimal_t_mm:.1f}\")\n        formatted_a = int(optimal_a_cm2)\n        formatted_e = round_to_sf(min_eff_dose, 3)\n        formatted_r = round(R, 3)\n        \n        all_results.append([formatted_t, formatted_a, formatted_e, formatted_r])\n\n    # Final print statement in the exact required format\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}