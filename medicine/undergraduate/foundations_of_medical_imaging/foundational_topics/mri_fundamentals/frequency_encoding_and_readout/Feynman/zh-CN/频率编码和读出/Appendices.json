{
    "hands_on_practices": [
        {
            "introduction": "频率编码是实现MRI空间定位的基石之一。然而，设计一个有效的读出梯度并非随心所欲，而是在期望的图像质量（如视野和分辨率）与MRI扫描仪的物理限制（如最大梯度幅度和切换率）之间进行精确权衡的过程。本练习将引导您完成一个真实的梯度设计任务，目标是在满足所有约束条件的同时，优化扫描速度，从而让您对实际工作中如何选择序列参数有更深入的理解。",
            "id": "4886591",
            "problem": "需要设计一个用于磁共振成像（MRI）$x$方向的单次激发频率编码读出。给定目标视野$ \\mathrm{FOV}_x $和空间分辨率$\\delta x$，您必须在数据采集期间选择一个恒定的读出梯度幅度$G_x$、一个采样驻留时间$\\Delta t$以及读出持续时间。梯度波形是一个对称的梯形：它以允许的最大斜率从$0$线性上升到$G_x$，在数据采样期间保持$G_x$恒定，然后以允许的最大斜率线性下降回$0$。设计必须同时满足最大梯度幅度和最大斜率的约束，并且必须遵守模数转换器（ADC）的最大采样率。如果有多种设计方案可行，选择总读出持续时间（包括上升/下降斜坡和平台采集时间）最短的方案。\n\n使用以下参数：\n- 目标视野 $ \\mathrm{FOV}_x = 240 \\text{ mm}$。\n- 目标分辨率 $\\delta x = \\mathrm{FOV}_x / 256$。\n- 最大梯度幅度 $G_{\\max} = 35 \\text{ mT/m}$。\n- 最大斜率 $S_{\\max} = 150 \\text{ T/m/s}$。\n- ADC最大采样率 $f_{s,\\max} = 5.0 \\times 10^{5} \\text{ Hz}$。\n- 质子旋磁比 $\\gamma = 2\\pi \\times 42.58 \\times 10^{6} \\text{ rad s}^{-1}\\text{T}^{-1}$。\n\n假设在斜率限制的斜坡之外，读出梯形的开始和结束处有理想的瞬时切换，在短时读出期间没有涡流或弛豫效应，并且采样仅在恒定幅度的平台期间发生。仅使用基本的空间编码和采样关系，确定满足所有约束的最小可实现总读出持续时间（包括两个斜坡和平台）。最终答案以毫秒表示，并四舍五入到$4$位有效数字。",
            "solution": "频率编码读出设计遵循磁共振成像（MRI）中的两个基本原理：\n\n1. 梯度的空间编码源于拉莫尔关系$ \\omega(x) = \\gamma B(x) $，其中在读出梯度期间$B(x) = B_0 + G_x x$。这会产生一个与空间相关的进动频率，将位置$x$映射到频率。\n\n2. 笛卡尔采样的$k$空间形式主义定义了\n$$\nk_x(t) = \\frac{\\gamma}{2\\pi} \\int_{0}^{t} G_x(\\tau)\\, d\\tau,\n$$\n以及采样关系\n$$\n\\Delta k_x = \\frac{1}{\\mathrm{FOV}_x}, \\qquad k_{x,\\max} = \\frac{1}{2\\,\\delta x},\n$$\n它们分别强制执行视野条件（无混叠）和分辨率要求（$k$空间覆盖范围）。\n\n在恒定梯度$G_x$的平台读出期间，$k$空间中的斜率为\n$$\n\\frac{d k_x}{dt} = \\frac{\\gamma}{2\\pi} G_x.\n$$\n每隔$\\Delta t$采样一次，会使$k_x$前进\n$$\n\\Delta k_x = \\frac{\\gamma}{2\\pi} G_x \\,\\Delta t.\n$$\n因此，视野要求$\\Delta k_x = 1/\\mathrm{FOV}_x$给出\n$$\n\\Delta t = \\frac{2\\pi}{\\gamma \\, G_x \\, \\mathrm{FOV}_x}.\n$$\n需要遍历的总$k$空间宽度为$2 k_{x,\\max} = 1/\\delta x$。在恒定$G_x$下，遍历此宽度所需的平台持续时间为\n$$\nT_{\\mathrm{flat}} = \\frac{2 k_{x,\\max}}{(\\gamma/(2\\pi))\\, G_x} = \\frac{4\\pi \\, k_{x,\\max}}{\\gamma \\, G_x} = \\frac{2\\pi}{\\gamma \\, G_x \\, \\delta x}.\n$$\n梯度斜坡受最大斜率$S_{\\max}$的限制，因此从$0$上升到$G_x$的时间为\n$$\nt_{\\mathrm{ramp}} = \\frac{G_x}{S_{\\max}},\n$$\n总读出持续时间，包括两个斜坡和平台，是\n$$\nT_{\\mathrm{tot}}(G_x) = 2\\, t_{\\mathrm{ramp}} + T_{\\mathrm{flat}} = \\frac{2 G_x}{S_{\\max}} + \\frac{2\\pi}{\\gamma \\, G_x \\, \\delta x}.\n$$\n如果对$G_x$没有约束，最小化$T_{\\mathrm{tot}}(G_x)$的最优$G_x$可通过对$G_x$求导并设为零得到：\n$$\n\\frac{d T_{\\mathrm{tot}}}{d G_x} = \\frac{2}{S_{\\max}} - \\frac{2\\pi}{\\gamma \\, \\delta x} \\frac{1}{G_x^{2}} = 0\n\\;\\;\\Rightarrow\\;\\;\nG_{x,\\mathrm{opt}} = \\sqrt{\\frac{\\pi \\, S_{\\max}}{\\gamma \\, \\delta x}}.\n$$\n然而，$G_x$有两个硬性上限：\n- 硬件幅度限制$G_{\\max}$。\n- 模数转换器（ADC）的最大采样率$f_{s,\\max}$，它规定了最小驻留时间$\\Delta t_{\\min} = 1/f_{s,\\max}$。视野采样条件要求$\\Delta t = 2\\pi/(\\gamma G_x \\mathrm{FOV}_x) \\ge \\Delta t_{\\min}$，等价于\n$$\nG_x \\le G_{\\mathrm{ADC}} \\equiv \\frac{2\\pi}{\\gamma \\, \\mathrm{FOV}_x \\, \\Delta t_{\\min}}.\n$$\n因此，可行的$G_x$必须满足$0  G_x \\le \\min(G_{\\max}, G_{\\mathrm{ADC}})$。最小化的选择是\n$$\nG_x^{\\star} = \n\\begin{cases}\nG_{x,\\mathrm{opt}},  \\text{若 } G_{x,\\mathrm{opt}} \\le \\min(G_{\\max}, G_{\\mathrm{ADC}}),\\\\\n\\min(G_{\\max}, G_{\\mathrm{ADC}}),  \\text{否则。}\n\\end{cases}\n$$\n\n现在进行数值计算。首先将给定数量转换为一致的单位并计算导出值：\n- $\\mathrm{FOV}_x = 240 \\text{ mm} = 0.240 \\text{ m}$。\n- $\\delta x = \\mathrm{FOV}_x/256 = 0.240/256 = 0.0009375 \\text{ m}$。\n- $G_{\\max} = 35 \\text{ mT/m} = 0.035 \\text{ T/m}$。\n- $S_{\\max} = 150 \\text{ T/m/s}$。\n- $f_{s,\\max} = 5.0 \\times 10^{5} \\text{ Hz} \\Rightarrow \\Delta t_{\\min} = 1/f_{s,\\max} = 2.0 \\times 10^{-6} \\text{ s}$。\n- $\\gamma = 2\\pi \\times 42.58 \\times 10^{6} \\text{ rad s}^{-1}\\text{T}^{-1}$。\n\n计算无约束的最优值：\n$$\nG_{x,\\mathrm{opt}} = \\sqrt{\\frac{\\pi \\, S_{\\max}}{\\gamma \\, \\delta x}}\n= \\sqrt{\\frac{\\pi \\times 150}{\\left(2\\pi \\times 42.58 \\times 10^{6}\\right) \\times 0.0009375}}\n= \\sqrt{\\frac{150}{2 \\times 42.58 \\times 10^{6} \\times 0.0009375}}.\n$$\n数值上，\n$$\n\\gamma \\, \\delta x = \\left(2\\pi \\times 42.58 \\times 10^{6}\\right) \\times 0.0009375 \\approx 2.50817 \\times 10^{5} \\text{ s}^{-1}\\text{T}^{-1},\n$$\n所以\n$$\nG_{x,\\mathrm{opt}} \\approx \\sqrt{\\frac{\\pi \\times 150}{2.50817 \\times 10^{5}}} \\approx \\sqrt{1.878 \\times 10^{-3}} \\approx 4.333 \\times 10^{-2} \\text{ T/m}.\n$$\n接下来，计算ADC施加的界限：\n$$\nG_{\\mathrm{ADC}} = \\frac{2\\pi}{\\gamma \\, \\mathrm{FOV}_x \\, \\Delta t_{\\min}}\n= \\frac{2\\pi}{\\left(2\\pi \\times 42.58 \\times 10^{6}\\right) \\times 0.240 \\times 2.0 \\times 10^{-6}}\n= \\frac{1}{42.58 \\times 10^{6} \\times 0.240 \\times 2.0 \\times 10^{-6}}.\n$$\n数值上，\n$$\nG_{\\mathrm{ADC}} \\approx \\frac{1}{20.4384} \\text{ T/m} \\approx 4.891 \\times 10^{-2} \\text{ T/m}.\n$$\n因此，\n$$\nG_{x,\\mathrm{opt}} \\approx 0.04333 \\text{ T/m}, \\quad G_{\\max} = 0.035 \\text{ T/m}, \\quad G_{\\mathrm{ADC}} \\approx 0.04891 \\text{ T/m}.\n$$\n可行的最大值为$\\min(G_{\\max}, G_{\\mathrm{ADC}}) = 0.035 \\text{ T/m}$，小于$G_{x,\\mathrm{opt}}$。因此，可行的最小化选择是\n$$\nG_x^{\\star} = G_{\\max} = 0.035 \\text{ T/m}.\n$$\n使用这个$G_x^{\\star}$，由视野条件得到的驻留时间为\n$$\n\\Delta t = \\frac{2\\pi}{\\gamma \\, G_x^{\\star} \\, \\mathrm{FOV}_x}\n= \\frac{2\\pi}{\\left(2\\pi \\times 42.58 \\times 10^{6}\\right)\\times 0.035 \\times 0.240}\n\\approx 2.795 \\times 10^{-6} \\text{ s},\n$$\n这满足$\\Delta t \\ge \\Delta t_{\\min}$的要求。\n\n平台持续时间可以通过$T_{\\mathrm{flat}} = \\frac{2\\pi}{\\gamma \\, G_x^{\\star} \\, \\delta x}$或等效地通过$T_{\\mathrm{flat}} = N \\Delta t$（其中$N = \\mathrm{FOV}_x/\\delta x = 256$）找到。为保证数值一致性，我们使用后者，\n$$\nT_{\\mathrm{flat}} = 256 \\times 2.795 \\times 10^{-6} \\text{ s} \\approx 7.155 \\times 10^{-4} \\text{ s} = 0.7155 \\text{ ms}.\n$$\n受斜率限制的斜坡时间是\n$$\nt_{\\mathrm{ramp}} = \\frac{G_x^{\\star}}{S_{\\max}} = \\frac{0.035}{150} \\text{ s} \\approx 2.333 \\times 10^{-4} \\text{ s} = 0.2333 \\text{ ms}.\n$$\n因此，总读出持续时间是\n$$\nT_{\\mathrm{tot}} = 2\\, t_{\\mathrm{ramp}} + T_{\\mathrm{flat}} \\approx 2 \\times 0.2333 \\text{ ms} + 0.7155 \\text{ ms} \\approx 1.182 \\text{ ms}.\n$$\n四舍五入到$4$位有效数字并以毫秒表示，最小可实现的总读出持续时间是$1.182 \\text{ ms}$。",
            "answer": "$$\\boxed{1.182}$$"
        },
        {
            "introduction": "在掌握了梯度设计的基础后，理解频率编码背后的核心假设至关重要，即每个空间位置对应唯一的共振频率。本练习将探讨当这个假设被打破时会发生什么，例如在同时含有脂肪和水的组织中。您将亲手计算由化学位移引起的空间错位，从而定量地理解这种常见伪影的产生机制，并加深对频率与表观位置之间直接联系的认识。",
            "id": "4867845",
            "problem": "在质子磁共振成像 (MRI) 中，基于化学位移的脂肪抑制技术利用了块状水和块状脂肪之间的共振频率差异。回波平面成像 (EPI) 对这种频率偏移产生的空间错位尤为敏感，因为其每像素的有效读出带宽可能非常小。从第一性原理出发，使用以下数据和定义，计算在单次激发回波平面成像采集中，块状脂肪相对于块状水的位移大小（以像素为单位，沿频率编码方向）。\n\n您可以假设以下已获科学证实的结论：\n- 质子的拉莫尔频率由 $f_{0} = \\gamma_{\\mathrm{H}} B_{0}$ 给出，其中 $\\gamma_{\\mathrm{H}}$ 是质子旋磁比（单位为 $\\mathrm{Hz/T}$），$B_{0}$ 是静态磁场（单位为 $\\mathrm{T}$）。\n- 化学位移以百万分率 (ppm) 为单位进行量化，并产生一个共振频率偏移 $\\Delta f = f_{0} \\,\\delta$，其中 $\\delta$ 是无量纲的化学位移，表示为 ppm $\\times 10^{-6}$。\n- 在频率编码中，每像素读出带宽 $b_{\\mathrm{pix}}$ 指定了多少赫兹对应一个图像像素，因此共振偏移 $\\Delta f$ 会映射到一个空间位移，其大小等于与 $\\Delta f$ 相对应的像素数。\n\n使用以下参数：\n- 静态磁场 $B_{0} = 3\\,\\mathrm{T}$，\n- 质子旋磁比 $\\gamma_{\\mathrm{H}} = 42.58 \\times 10^{6}\\,\\mathrm{Hz/T}$，\n- 水-脂肪化学位移（块状亚甲基脂肪相对于块状水）$\\delta = 3.5 \\times 10^{-6}$，\n- EPI 每像素读出带宽 $b_{\\mathrm{pix}} = 20\\,\\mathrm{Hz/pixel}$。\n\n计算沿频率编码方向的脂肪位移（以像素为单位）。将最终数值答案四舍五入到三位有效数字。以像素数表示最终位移。",
            "solution": "所述问题具有科学依据，提法明确，客观，并包含计算唯一解所需的所有信息。其所依赖的原理——拉莫尔方程、化学位移的定义以及 MRI 中的频率编码机制——都是该领域的基础。所提供的参数对于临床 MRI 系统是符合实际的。因此，该问题是有效的，并且可以推导出解。\n\n目标是计算脂肪相对于水的空间位移，以像素为单位，沿频率编码方向。这个位移，记为 $S_{\\text{pix}}$，源于脂肪和水信号之间的频率差异。\n\n根据问题定义，以像素为单位的位移是共振频率偏移 $\\Delta f$ 与每像素读出带宽 $b_{\\text{pix}}$ 的比值。\n$$\nS_{\\text{pix}} = \\frac{\\Delta f}{b_{\\text{pix}}}\n$$\n\n共振频率偏移 $\\Delta f$ 是由脂肪和水之间的化学位移 $\\delta$ 引起的。它由以下公式给出：\n$$\n\\Delta f = f_{0} \\delta\n$$\n其中 $f_{0}$ 是拉莫尔频率。\n\n拉莫尔频率 $f_{0}$ 由静态磁场强度 $B_{0}$ 和质子旋磁比 $\\gamma_{\\mathrm{H}}$ 决定：\n$$\nf_{0} = \\gamma_{\\mathrm{H}} B_{0}\n$$\n\n将 $f_{0}$ 的表达式代入 $\\Delta f$ 的方程，然后将得到的 $\\Delta f$ 表达式代入 $S_{\\text{pix}}$ 的方程，我们得到一个用给定参数表示像素位移的单一表达式：\n$$\nS_{\\text{pix}} = \\frac{(\\gamma_{\\mathrm{H}} B_{0}) \\delta}{b_{\\text{pix}}}\n$$\n\n我们已知以下数值：\n-   静态磁场：$B_{0} = 3\\,\\mathrm{T}$\n-   质子旋磁比：$\\gamma_{\\mathrm{H}} = 42.58 \\times 10^{6}\\,\\mathrm{Hz/T}$\n-   水-脂肪化学位移：$\\delta = 3.5 \\times 10^{-6}$\n-   EPI 每像素读出带宽：$b_{\\text{pix}} = 20\\,\\mathrm{Hz/pixel}$\n\n首先，我们计算拉莫尔频率 $f_{0}$：\n$$\nf_{0} = (42.58 \\times 10^{6}\\,\\mathrm{Hz/T}) \\times (3\\,\\mathrm{T}) = 127.74 \\times 10^{6}\\,\\mathrm{Hz}\n$$\n\n接下来，我们用这个值计算频率偏移 $\\Delta f$：\n$$\n\\Delta f = (127.74 \\times 10^{6}\\,\\mathrm{Hz}) \\times (3.5 \\times 10^{-6}) = 447.09\\,\\mathrm{Hz}\n$$\n这是在 $3\\,\\mathrm{T}$ 磁场下，块状亚甲基脂肪信号与块状水信号之间的频率差。\n\n最后，我们通过将频率偏移除以每像素读出带宽来计算空间位移（以像素为单位）$S_{\\text{pix}}$：\n$$\nS_{\\text{pix}} = \\frac{447.09\\,\\mathrm{Hz}}{20\\,\\mathrm{Hz/pixel}} = 22.3545\\,\\text{pixels}\n$$\n\n问题要求将最终答案四舍五入到三位有效数字。\n$$\nS_{\\text{pix}} \\approx 22.4\\,\\text{pixels}\n$$\n这种显著的位移是回波平面成像 (EPI) 序列中观察到的大化学位移伪影的特征，这类序列在相位编码方向（在 EPI 读出回波链中，该方向对每个回波都成为频率编码方向）通常具有较低的有效带宽。",
            "answer": "$$\\boxed{22.4}$$"
        },
        {
            "introduction": "现实世界中的MRI序列，特别是像回波平面成像（EPI）这样的快速序列，常常将硬件推向极限，从而引入细微的误差。本练习将带您深入研究奈奎斯特鬼影的校正，这是一种由EPI中交替读出梯度的不一致性引起的伪影。通过将相位校正模型拟合到参考扫描数据，您将参与一个确保图像质量的关键数据处理步骤，体会到对频率编码的深刻理解如何推动稳健成像技术的发展。",
            "id": "4886589",
            "problem": "单次激发平面回波成像 (Echo Planar Imaging, EPI) 序列通过以交替的梯度极性遍历频率编码（读出）方向来采集一幅图像。考虑用于奈奎斯特鬼影校正的参考扫描：该序列在没有相位编码的情况下运行，并分别记录奇数和偶数读出行的复数数据。假设读出梯度在每条线期间幅度近似恒定，因此频率编码波矢满足标准的k空间关系 $k_{x}(t) = \\frac{\\gamma}{2\\pi} \\int_{0}^{t} G_{x}(\\tau)\\, d\\tau$，其中 $\\gamma$ 是旋磁比，$G_{x}(t)$ 是读出梯度。在时间 $t$ 测得的信号可以用傅里叶积分 $s(t) = \\int \\rho(x)\\, \\exp\\!\\left(-\\mathrm{i}\\, 2\\pi\\, k_{x}(t)\\, x + \\mathrm{i}\\, \\phi_{0}(x)\\right) dx$ 来建模，其中 $\\rho(x)$ 是自旋密度，$\\phi_{0}(x)$ 是由静态磁场不均匀性引起的空间变化的背景相位。\n\n在实践中，读出和梯度切换之间的一个微小相对时间偏移 $\\Delta t$，以及平滑变化的离共振，会在奇数和偶数行之间产生相位失配，该失配是频率编码坐标的平滑函数。对于较小的 $\\Delta t$ 和缓慢变化的 $\\phi_{0}(x)$，在采样的读出范围内，这种奇偶相位差可以由（归一化）频率编码坐标 $k$ 的一个低阶多项式很好地近似，即 $\\Delta \\phi(k) \\approx c_{0} + c_{1}\\, k + c_{2}\\, k^{2}$，其中 $\\Delta \\phi(k)$ 是在坐标 $k$ 处奇偶参考数据之差的解缠相位。\n\n给定在参考扫描中测量的、位于五个均匀间隔的归一化坐标 $k \\in \\{-2, -1, 0, 1, 2\\}$ 处的解缠奇偶相位差：\n- 对于 $k = -2$，$\\Delta \\phi = 0.03$ 弧度。\n- 对于 $k = -1$，$\\Delta \\phi = 0.03$ 弧度。\n- 对于 $k = 0$，$\\Delta \\phi = 0.05$ 弧度。\n- 对于 $k = 1$，$\\Delta \\phi = 0.09$ 弧度。\n- 对于 $k = 2$，$\\Delta \\phi = 0.15$ 弧度。\n\n从上面的信号形成关系和k空间定义出发，解释为什么在这种情况下使用低阶多项式模型来描述 $\\Delta \\phi(k)$ 是合理的。然后，使用线性最小二乘法将模型 $\\Delta \\phi(k) = c_{0} + c_{1}\\, k + c_{2}\\, k^{2}$ 拟合到数据，计算系数向量 $\\begin{pmatrix} c_{0}  c_{1}  c_{2} \\end{pmatrix}$。你的最终数值以弧度表示，并四舍五入到四位有效数字。最终答案必须是这三个系数的有序行向量。",
            "solution": "用户要求一个分两部分的解答：首先，论证在平面回波成像（EPI）鬼影校正中使用低阶多项式模型来描述相位差的合理性；其次，使用最小二乘法拟合给定数据，计算该模型的系数。\n\n### 步骤1：问题验证\n\n#### 提取给定信息\n- **序列：**采用交替读出梯度极性的单次激发平面回波成像（EPI）。\n- **参考扫描：**无相位编码，记录奇数和偶数读出行的复数数据。\n- **k空间关系：**$k_{x}(t) = \\frac{\\gamma}{2\\pi} \\int_{0}^{t} G_{x}(\\tau)\\, d\\tau$。\n- **信号模型：**$s(t) = \\int \\rho(x)\\, \\exp(-\\mathrm{i}\\, 2\\pi\\, k_{x}(t)\\, x + \\mathrm{i}\\, \\phi_{0}(x)) dx$。\n- **自旋密度：**$\\rho(x)$。\n- **背景相位：**$\\phi_{0}(x)$，由静态磁场不均匀性引起，随空间变化。\n- **误差来源：**微小的相对时间偏移 $\\Delta t$ 和平滑变化的离共振。\n- **相位差模型：**$\\Delta \\phi(k) \\approx c_{0} + c_{1}\\, k + c_{2}\\, k^{2}$。\n- **$\\Delta \\phi(k)$ 的数据点：**\n  - $k = -2, \\Delta \\phi = 0.03$ 弧度。\n  - $k = -1, \\Delta \\phi = 0.03$ 弧度。\n  - $k = 0, \\Delta \\phi = 0.05$ 弧度。\n  - $k = 1, \\Delta \\phi = 0.09$ 弧度。\n  - $k = 2, \\Delta \\phi = 0.15$ 弧度。\n- **任务：**论证多项式模型的合理性，并通过线性最小二乘法计算系数向量 $(c_0, c_1, c_2)$，结果四舍五入到四位有效数字。\n\n#### 验证与结论\n该问题具有科学依据，提法明确且客观。它描述了MRI中一个称为EPI奈奎斯特鬼影校正的标准流程。其物理模型、数学形式以及误差来源都与MRI物理学的既定原理一致。问题提供了所有必要的数据和一个明确的目标，即执行一个标准的数学程序（线性最小二乘法）。该问题没有违反任何无效性标准。\n\n**结论：**该问题有效。\n\n### 步骤2：求解\n\n#### 多项式相位模型的合理性论证\n\nEPI中奇数和偶数回波之间的相位差 $\\Delta \\phi(k)$ 是由系统缺陷和物理效应共同引起的。使用低阶多项式来对此差异建模是合理的，因为其底层的物理现象会导致k空间中的相位误差是k空间坐标 $k$ 的一个平滑函数。任何足够平滑的函数在一个有限区间内都可以用一个低阶多项式（例如，通过泰勒级数展开）很好地近似。让我们来分析主要的贡献因素。\n\n1.  **恒定相位误差（零阶项，$c_0$）：**\n    奇偶回波之间的恒定相位差可能由多种因素引起。例如，如果物体上存在一个平均离共振频率 $\\overline{\\Delta\\omega}$，并且奇偶回波线的采集窗口相对于回波中心的时间有轻微差异，就会产生一个恒定的相位偏移 $\\Delta \\phi = \\overline{\\Delta\\omega} \\cdot \\Delta T_{acq}$。连续回波的接收器电子路径差异也可能贡献一个恒定相位。这些效应证明了多项式模型中常数项 $c_0$ 的合理性。\n\n2.  **线性相位误差（一阶项，$c_1 k$）：**\n    该项主要由读出梯度 $G_x$ 切换和数据采集（ADC）开始之间的一个微小、恒定的时间延迟 $\\Delta t$ 引起。\n    - 对于奇数回波，梯度为正，$G_x  0$。采集延迟 $\\Delta t$ 会导致测量的k空间位置发生 $\\delta k = \\frac{\\gamma G_x}{2\\pi} \\Delta t$ 的偏移。因此，本应在k空间位置 $k$ 的信号实际上是从 $k-\\delta k$ 处采集的。设真实信号为 $S_{true}(k)$。测得的奇数回波信号为 $S_{odd}(k) = S_{true}(k - \\delta k)$。\n    - 对于偶数回波，梯度为负，$-G_x  0$，k空间轨迹被反转。类似的延迟 $\\Delta t$ 会导致一个大小相同但有效方向相反的k空间偏移，因此测得的偶数回波信号为 $S_{even}(k) = S_{true}(k + \\delta k)$。\n    - 相位差为 $\\Delta\\phi(k) = \\arg(S_{even}(k)) - \\arg(S_{odd}(k)) = \\arg(S_{true}(k+\\delta k) / S_{true}(k-\\delta k))$。\n    - 对于一个小的偏移 $\\delta k$，我们可以使用一阶泰勒展开：$S_{true}(k \\pm \\delta k) \\approx S_{true}(k) \\pm S'_{true}(k)\\delta k$。\n    - 比值变为：\n      $$ \\frac{S_{true}(k+\\delta k)}{S_{true}(k-\\delta k)} \\approx \\frac{1 + (S'_{true}(k)/S_{true}(k))\\delta k}{1 - (S'_{true}(k)/S_{true}(k))\\delta k} \\approx 1 + 2\\delta k \\frac{S'_{true}(k)}{S_{true}(k)} $$\n    - 这个复数的相位约等于其虚部：$\\Delta\\phi(k) \\approx \\text{Im}\\left\\{2\\delta k \\frac{S'_{true}(k)}{S_{true}(k)}\\right\\}$。\n    - 将真实信号写成极坐标形式，$S_{true}(k) = A(k) \\exp(\\mathrm{i}\\psi(k))$，我们有 $\\frac{S'_{true}(k)}{S_{true}(k)} = \\frac{d}{dk} \\ln(S_{true}(k)) = \\frac{A'(k)}{A(k)} + \\mathrm{i}\\psi'(k)$。\n    - 因此，相位差为 $\\Delta\\phi(k) \\approx 2\\delta k \\cdot \\psi'(k)$。项 $\\psi'(k)$ 是信号的群延迟，与物体的空间分布有关。由于物体在空间上是有限的，并且其相位 $\\phi_0(x)$ 假定为平滑的，其k空间表示 $S_{true}(k)$ 将是 $k$ 的一个平滑函数，其相位导数 $\\psi'(k)$ 也将是平滑的。$\\psi'(k)$ 的主要分量通常与 $k$ 呈线性关系，当与其他常数因子结合时，便产生了 $c_1 k$ 项。更直接地说，傅里叶位移定理指出，这种k空间位移对应于图像空间中的线性相位斜坡，$\\exp(\\pm \\mathrm{i} 2 \\pi x \\delta k)$，因此奇偶回波数据之间的相位差与 $k$ 的线性函数密切相关。\n\n3.  **二次及更高阶误差 ($c_2 k^2, \\dots$):**\n    这些项捕捉了更复杂的影响。例如，由强EPI梯度切换引起的涡流可能导致时变的、非理想的梯度波形。这些失真会引入一个与 $k$ 相关的时移 $\\Delta t(k)$，从而导致一个与 $k$ 相关的k空间位移 $\\delta k(k)$。这与时间误差和物体自身k空间相位变化（$\\psi'(k)$ 非恒定）之间的相互作用，以及空间变化的B0场（导致 $\\phi_0(x)$ 具有非线性分量）的影响相结合，将导致 $k$ 的更高阶相位项。二次项 $c_2 k^2$ 是这些高阶校正项中第一个也是最重要的一个。\n\n总之，多项式模型 $\\Delta \\phi(k) = c_{0} + c_{1}\\, k + c_{2}\\, k^{2}$ 是一个有充分依据的唯象模型，它捕捉了EPI中系统缺陷的主要物理效应，因为由这些效应产生的任何平滑函数都可以在局部被这样的多项式近似。\n\n#### 系数计算\n\n我们希望找到系数 $c_0, c_1, c_2$，以对模型 $\\Delta\\phi(k) = c_0 + c_1 k + c_2 k^2$ 进行线性最小二乘拟合。这等同于以最小二乘的方式求解矩阵方程 $A\\mathbf{c} = \\mathbf{b}$，其中 $\\mathbf{c} = \\begin{pmatrix} c_0  c_1  c_2 \\end{pmatrix}^T$。\n\n设计矩阵 $A$ 由在每个数据点 $k_i$ 处求值的基函数 $[1, k, k^2]$ 构成。向量 $\\mathbf{b}$ 包含相应的测量相位值 $\\Delta\\phi(k_i)$。\n给定的数据是：\n$k = \\{-2, -1, 0, 1, 2\\}$\n$\\Delta\\phi = \\{0.03, 0.03, 0.05, 0.09, 0.15\\}$\n\n矩阵 $A$ 和向量 $\\mathbf{b}$ 是：\n$$ A = \\begin{pmatrix} 1  -2  4 \\\\ 1  -1  1 \\\\ 1  0  0 \\\\ 1  1  1 \\\\ 1  2  4 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 0.03 \\\\ 0.03 \\\\ 0.05 \\\\ 0.09 \\\\ 0.15 \\end{pmatrix} $$\n系数向量 $\\mathbf{c}$ 的最小二乘解由正规方程给出：\n$$ \\mathbf{c} = (A^T A)^{-1} A^T \\mathbf{b} $$\n首先，我们计算 $A^T A$：\n$$ A^T A = \\begin{pmatrix} 1  1  1  1  1 \\\\ -2  -1  0  1  2 \\\\ 4  1  0  1  4 \\end{pmatrix} \\begin{pmatrix} 1  -2  4 \\\\ 1  -1  1 \\\\ 1  0  0 \\\\ 1  1  1 \\\\ 1  2  4 \\end{pmatrix} = \\begin{pmatrix} 5  0  10 \\\\ 0  10  0 \\\\ 10  0  34 \\end{pmatrix} $$\n接下来，我们求逆矩阵 $(A^T A)^{-1}$。行列式是 $\\det(A^T A) = 5(10 \\cdot 34 - 0) - 0 + 10(0 - 10 \\cdot 10) = 5(340) - 1000 = 1700 - 1000 = 700$。\n$$ (A^T A)^{-1} = \\frac{1}{700} \\begin{pmatrix} 340  0  -100 \\\\ 0  70  0 \\\\ -100  0  50 \\end{pmatrix} = \\begin{pmatrix} \\frac{34}{70}  0  -\\frac{10}{70} \\\\ 0  \\frac{7}{70}  0 \\\\ -\\frac{10}{70}  0  \\frac{5}{70} \\end{pmatrix} = \\begin{pmatrix} \\frac{17}{35}  0  -\\frac{1}{7} \\\\ 0  \\frac{1}{10}  0 \\\\ -\\frac{1}{7}  0  \\frac{1}{14} \\end{pmatrix} $$\n现在，我们计算 $A^T \\mathbf{b}$：\n$$ A^T \\mathbf{b} = \\begin{pmatrix} 1  1  1  1  1 \\\\ -2  -1  0  1  2 \\\\ 4  1  0  1  4 \\end{pmatrix} \\begin{pmatrix} 0.03 \\\\ 0.03 \\\\ 0.05 \\\\ 0.09 \\\\ 0.15 \\end{pmatrix} = \\begin{pmatrix} 0.03 + 0.03 + 0.05 + 0.09 + 0.15 \\\\ -0.06 - 0.03 + 0 + 0.09 + 0.30 \\\\ 0.12 + 0.03 + 0 + 0.09 + 0.60 \\end{pmatrix} = \\begin{pmatrix} 0.35 \\\\ 0.30 \\\\ 0.84 \\end{pmatrix} $$\n最后，我们计算系数向量 $\\mathbf{c}$：\n$$ \\mathbf{c} = \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = (A^T A)^{-1} A^T \\mathbf{b} = \\begin{pmatrix} \\frac{17}{35}  0  -\\frac{1}{7} \\\\ 0  \\frac{1}{10}  0 \\\\ -\\frac{1}{7}  0  \\frac{1}{14} \\end{pmatrix} \\begin{pmatrix} 0.35 \\\\ 0.30 \\\\ 0.84 \\end{pmatrix} $$\n$$ c_0 = \\frac{17}{35}(0.35) - \\frac{1}{7}(0.84) = 17(0.01) - 0.12 = 0.17 - 0.12 = 0.05 $$\n$$ c_1 = \\frac{1}{10}(0.30) = 0.03 $$\n$$ c_2 = -\\frac{1}{7}(0.35) + \\frac{1}{14}(0.84) = -0.05 + 0.06 = 0.01 $$\n得到的系数是 $c_0 = 0.05$, $c_1 = 0.03$ 和 $c_2 = 0.01$。问题要求将结果四舍五入到四位有效数字。\n$c_0 = 0.05000$\n$c_1 = 0.03000$\n$c_2 = 0.01000$\n最终答案是这三个系数的有序行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.05000  0.03000  0.01000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}