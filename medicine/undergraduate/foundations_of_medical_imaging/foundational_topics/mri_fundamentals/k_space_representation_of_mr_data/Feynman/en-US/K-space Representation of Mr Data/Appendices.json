{
    "hands_on_practices": [
        {
            "introduction": "This first practice establishes the fundamental relationships between the key parameters of an MRI readout. By connecting the total readout time, number of samples, and receiver bandwidth, you will build a foundational understanding of how k-space is sampled in the frequency-encoding direction. This exercise is crucial for appreciating the time costs and constraints involved in MRI data acquisition.",
            "id": "4896641",
            "problem": "In a Cartesian Magnetic Resonance Imaging (MRI) readout along the frequency-encoding direction $k_x$, the readout gradient is held constant and the signal is sampled uniformly in time. The uniform sampling produces $N_x$ complex data points of the $k$-space line at times $t_n = n\\,T_{\\mathrm{dw}}$ for integers $n$ spanning the acquisition window, where $T_{\\mathrm{dw}}$ is the dwell time, and the spectral bandwidth $BW$ of the acquisition is set by the sampling frequency. The analog-to-digital converter (ADC) gate defines the total readout time $T_{\\mathrm{ro}}$.\n\nUsing only fundamental definitions from signal sampling in MRI $k$-space acquisition, derive an expression for the total readout time $T_{\\mathrm{ro}}$ in terms of $N_x$, $T_{\\mathrm{dw}}$, and $BW$. Then evaluate $T_{\\mathrm{ro}}$ for $N_x = 1536$ samples and $BW = 192 \\times 10^{3}$ $\\mathrm{Hz}$. Express your final numerical answer in milliseconds and round to four significant figures.",
            "solution": "The problem requires the derivation of an expression for the total readout time, $T_{\\mathrm{ro}}$, in a Cartesian MRI acquisition, and its subsequent numerical evaluation. The derivation will be based on the fundamental definitions of signal sampling.\n\nFirst, we establish the relationship between the parameters provided. The dwell time, $T_{\\mathrm{dw}}$, is the time interval between the acquisition of consecutive samples in the time domain. The sampling frequency, $f_s$, is therefore the reciprocal of the dwell time:\n$$f_s = \\frac{1}{T_{\\mathrm{dw}}}$$\nThe problem states that the spectral bandwidth, $BW$, of the acquisition is set by the sampling frequency. In digital signal processing for MRI, to avoid aliasing in the frequency-encoded direction according to the Nyquist-Shannon sampling theorem, the sampling frequency is set to equal the spectral bandwidth. The spectral bandwidth defines the full range of frequencies to be digitized. Thus, we have:\n$$f_s = BW$$\nBy combining these two fundamental equations, we establish a direct relationship between the dwell time and the spectral bandwidth:\n$$BW = \\frac{1}{T_{\\mathrm{dw}}}$$\nThis implies that $T_{\\mathrm{dw}}$ and $BW$ are not independent variables but are reciprocals of each other.\n\nNext, we define the total readout time, $T_{\\mathrm{ro}}$. This is the total duration of the signal acquisition window, also known as the ADC gate time. During this time, a total of $N_x$ samples are acquired. Since the sampling is uniform with an interval of $T_{\\mathrm{dw}}$, the total readout time is the product of the number of samples and the duration per sample:\n$$T_{\\mathrm{ro}} = N_x T_{\\mathrm{dw}}$$\nThe problem asks for an expression for $T_{\\mathrm{ro}}$ in terms of $N_x$, $T_{\\mathrm{dw}}$, and $BW$. The set of relationships derived above fully describes the connection between these parameters. Specifically, we have two primary expressions for $T_{\\mathrm{ro}}$:\n1.  In terms of $N_x$ and $T_{\\mathrm{dw}}$: $T_{\\mathrm{ro}} = N_x T_{\\mathrm{dw}}$\n2.  In terms of $N_x$ and $BW$: By substituting $T_{\\mathrm{dw}} = 1/BW$ into the first expression, we get:\n    $$T_{\\mathrm{ro}} = N_x \\left(\\frac{1}{BW}\\right) = \\frac{N_x}{BW}$$\nThese two expressions collectively represent the derived relationship between $T_{\\mathrm{ro}}$, $N_x$, $T_{\\mathrm{dw}}$, and $BW$. For the numerical evaluation part of the problem, the second expression is the operative one, as values for $N_x$ and $BW$ are provided.\n\nWe are asked to evaluate $T_{\\mathrm{ro}}$ for the following values:\n- Number of samples, $N_x = 1536$\n- Spectral bandwidth, $BW = 192 \\times 10^{3} \\, \\mathrm{Hz}$\n\nThe unit of bandwidth, Hertz ($\\mathrm{Hz}$), is equivalent to inverse seconds ($\\mathrm{s}^{-1}$). Substituting the given values into the derived formula:\n$$T_{\\mathrm{ro}} = \\frac{1536}{192 \\times 10^{3} \\, \\mathrm{s}^{-1}}$$\nWe first evaluate the ratio of the numbers:\n$$\\frac{1536}{192} = 8$$\nTherefore, the total readout time in seconds is:\n$$T_{\\mathrm{ro}} = 8 \\times 10^{-3} \\, \\mathrm{s}$$\nThe problem requires the final answer to be expressed in milliseconds ($\\mathrm{ms}$). We use the conversion factor $1 \\, \\mathrm{s} = 1000 \\, \\mathrm{ms}$:\n$$T_{\\mathrm{ro}} = (8 \\times 10^{-3} \\, \\mathrm{s}) \\times \\left(\\frac{1000 \\, \\mathrm{ms}}{1 \\, \\mathrm{s}}\\right) = 8 \\, \\mathrm{ms}$$\nFinally, we must round the answer to four significant figures. The exact value of $8$ must be written with trailing zeros to indicate this precision.\n$$T_{\\mathrm{ro}} = 8.000 \\, \\mathrm{ms}$$",
            "answer": "$$\\boxed{8.000}$$"
        },
        {
            "introduction": "Real-world MRI is never perfect, and understanding how physical imperfections translate into image artifacts is a critical skill. This practice challenges you to derive the connection between static magnetic field inhomogeneity—a common issue—and the resulting geometric distortion in the image. By applying the Fourier shift theorem to a hypothetical scenario, you will see how off-resonance frequency causes a spatially-dependent shift in pixels.",
            "id": "4896651",
            "problem": "Consider a one-dimensional readout in Magnetic Resonance Imaging (MRI) along the frequency-encode axis, denoted as the spatial coordinate $x \\in [-FOV_x/2,\\, FOV_x/2]$, where $FOV_x$ is the field of view (FOV) along the readout direction. A constant readout gradient $G_x$ is applied during acquisition so that the time-dependent $k$-space coordinate is $k_x(t)$, and data are sampled at a constant rate $BW$ (the receiver bandwidth), yielding $N_x$ uniformly spaced time samples used to reconstruct the image along $x$.\n\nAssume the transverse magnetization has spin density $\\rho(x)$ and that relaxation and chemical shift are negligible during the readout. The received signal can be modeled as the superposition of contributions from all positions $x$, each accumulating phase due to the readout gradient (which encodes position) and due to a static off-resonance angular frequency $\\Delta \\omega(x)$ generated by a background static magnetic field inhomogeneity $\\Delta B_0(x)$. The Larmor relationship between angular frequency and magnetic field holds: $\\omega(x) = \\gamma B(x)$, where $\\gamma$ is the gyromagnetic ratio. Hence the off-resonance angular frequency induced by inhomogeneity is $\\Delta \\omega(x) = \\gamma \\Delta B_0(x)$.\n\nUsing only the foundational facts that (i) the readout encodes position via a Fourier relationship between the time-domain signal and the image-domain along $x$, (ii) multiplication by a complex exponential in the time domain corresponds to a shift in the reconstructed image-domain according to the Fourier shift theorem, and (iii) the sampling bandwidth $BW$ and number of points $N_x$ determine the frequency resolution per pixel, derive from first principles an analytic expression for the pixel shift along the frequency-encode axis, denoted $\\Delta n(x)$, as a function of $\\Delta \\omega(x)$, $BW$, and $N_x$.\n\nThen, for a specific, spatially varying background inhomogeneity given by\n$$\n\\Delta B_0(x) = b\\, x^{2},\n$$\nwhere $b$ is a constant with units of tesla per square meter and $x$ is measured in meters, provide the closed-form expression for the spatially varying pixel shift $\\Delta n(x)$ in terms of $b$, $\\gamma$, $BW$, $N_x$, and $x$.\n\nExpress your final answer symbolically as a single closed-form expression for $\\Delta n(x)$ in pixels. No numerical evaluation is required, and no rounding is needed. Do not include physical units in the final expression inside your final boxed answer.",
            "solution": "The frequency-encode readout in Magnetic Resonance Imaging (MRI) establishes a Fourier relationship between the recorded time-domain signal and the reconstructed spatial image along the readout direction. Let the spin density be $\\rho(x)$ along the spatial axis $x$. Under a constant readout gradient $G_x$, the time-dependent $k$-space coordinate is related to time by\n$$\nk_x(t) = \\frac{\\gamma G_x}{2\\pi}\\, t,\n$$\nso that the spatial encoding by the gradient produces the term $\\exp\\!\\big(i\\, 2\\pi\\, k_x(t)\\, x\\big)$ in the signal model. In addition, static magnetic field inhomogeneity $\\Delta B_0(x)$ produces an off-resonance angular frequency\n$$\n\\Delta \\omega(x) = \\gamma\\, \\Delta B_0(x),\n$$\nwhich contributes a multiplicative factor $\\exp\\!\\big(i\\, \\Delta \\omega(x)\\, t\\big)$ to the signal from position $x$. Neglecting relaxation, the received signal is therefore\n$$\ns(t) = \\int_{-FOV_x/2}^{FOV_x/2} \\rho(x)\\, \\exp\\!\\big(i\\, 2\\pi\\, k_x(t)\\, x\\big)\\, \\exp\\!\\big(i\\, \\Delta \\omega(x)\\, t\\big)\\, dx.\n$$\n\nThe reconstruction along the readout direction is performed by an inverse Fourier transform with respect to time samples acquired at rate $BW$. Let the $n$-th time sample be $t_n = n\\, \\Delta t$ with $\\Delta t = \\frac{1}{BW}$ and $n = 0,1,\\dots,N_x-1$. The discrete inverse Fourier transform maps the sampled time-domain data to $N_x$ spatial pixels along $x$. The key Fourier property we use is the Fourier shift theorem: multiplication in the time domain by a complex exponential $\\exp\\!\\big(i\\, 2\\pi\\, \\Delta f\\, t\\big)$ corresponds to a shift in the image domain by an amount proportional to $\\Delta f$ relative to the sampling axis. Here, $\\Delta f$ is the ordinary frequency (in hertz), related to angular frequency by\n$$\n\\Delta f(x) = \\frac{\\Delta \\omega(x)}{2\\pi}.\n$$\n\nTo quantify the pixel shift, we note that the discrete sampling bandwidth $BW$ over $N_x$ points sets the frequency increment per pixel,\n$$\n\\Delta f_{\\text{per-pixel}} = \\frac{BW}{N_x}.\n$$\nTherefore, the shift in pixels produced by a time-domain modulation at ordinary frequency $\\Delta f(x)$ is the ratio of the modulation frequency to the frequency increment per pixel:\n$$\n\\Delta n(x) = \\frac{\\Delta f(x)}{\\Delta f_{\\text{per-pixel}}} = \\frac{\\Delta f(x)}{BW/N_x} = \\frac{N_x\\, \\Delta f(x)}{BW}.\n$$\nReplacing $\\Delta f(x)$ by $\\Delta \\omega(x)/(2\\pi)$ yields\n$$\n\\Delta n(x) = \\frac{N_x}{BW}\\, \\frac{\\Delta \\omega(x)}{2\\pi}.\n$$\n\nThis expression is general: it shows directly how off-resonance produces a spatially varying pixel shift along the frequency-encode direction, with larger $\\Delta \\omega(x)$ causing proportionally larger shifts. The spatial variation in $\\Delta \\omega(x)$, inherited from $\\Delta B_0(x)$ via the Larmor relationship, leads to nonuniform distortion across the image.\n\nFor the given inhomogeneity\n$$\n\\Delta B_0(x) = b\\, x^{2},\n$$\nthe off-resonance angular frequency is\n$$\n\\Delta \\omega(x) = \\gamma\\, \\Delta B_0(x) = \\gamma\\, b\\, x^{2}.\n$$\nSubstituting into the general pixel-shift expression,\n$$\n\\Delta n(x) = \\frac{N_x}{BW}\\, \\frac{\\gamma\\, b\\, x^{2}}{2\\pi} = \\frac{N_x\\, \\gamma\\, b}{2\\pi\\, BW}\\, x^{2}.\n$$\n\nThis is the requested closed-form expression for the spatially varying pixel shift, showing that the distortion increases quadratically with $|x|$, is zero at isocenter $x=0$, and scales with the number of readout points $N_x$ and inversely with the bandwidth $BW$.",
            "answer": "$$\\boxed{\\Delta n(x)=\\frac{N_x\\,\\gamma\\,b}{2\\pi\\,BW}\\,x^{2}}$$"
        },
        {
            "introduction": "To make MRI scans faster, we often acquire less data than required by the Nyquist theorem, a technique known as accelerated imaging. This exercise explores the consequences of a common acceleration strategy: fully sampling the center of k-space but undersampling its periphery. Analyzing this hypothetical scenario will deepen your understanding of the trade-offs between scan time, image sharpness, and aliasing artifacts, which are central to modern MRI.",
            "id": "4896695",
            "problem": "A research team is acquiring a Cartesian Magnetic Resonance Imaging (MRI) dataset of a stationary object whose spin density has a single sharp step edge along one spatial direction. The signal measured in spatial frequency space (k-space) along that direction can be modeled by the one-dimensional Fourier transform relation $s(k)=\\int_{-\\infty}^{\\infty} \\rho(x)\\, e^{-i 2 \\pi k x}\\, dx$, where $\\rho(x)$ is the object’s spin density and $k$ is the spatial frequency. They reconstruct with a standard inverse discrete Fourier transform assuming missing samples are zero-filled and apply no additional filtering.\n\nTo reduce scan time, they use a variable-density sampling pattern that fully samples the central k-space region for $|k|\\le k_{c}$, but in the outer region $|k|>k_{c}$ they aggressively undersample by keeping only every $R$-th Cartesian line along the phase-encode direction (with $R>1$ an integer), up to a maximum acquired frequency $k_{\\max}$. Thus, the acquired k-space is given by $S_{\\text{acq}}(k) = s(k)\\, M(k)$, where $M(k)$ equals $1$ on the fully sampled grid for $|k|\\le k_{c}$, equals a periodic impulse train with period $\\Delta k_{\\text{outer}}=R\\, \\Delta k_{\\text{center}}$ for $k_{c}<|k|\\le k_{\\max}$, and equals $0$ for $|k|>k_{\\max}$. Here $\\Delta k_{\\text{center}}$ is the sampling increment in the fully sampled central region.\n\nStarting from the Fourier relationship between object and data, sampling theory, and the interpretation of multiplication in k-space as convolution in image space, reason about the image-domain effects of this acquisition. In particular, consider the point spread function (PSF) and the consequences of both finite k-space extent and nonuniform sampling density.\n\nWhich option best describes how this aggressive undersampling of high-frequency k-space affects (i) edge sharpness of the step and (ii) the dominant aliasing artifacts visible in the reconstructed image along the undersampled direction?\n\nA. The step edge appears blurred due to the reduced $k_{\\max}$, and oscillatory ringing arises near the edge from the abrupt k-space mask; in addition, periodic wrap-around of predominantly high-frequency features appears along the undersampled direction, while low-frequency contrast is largely unaliased because the center is fully sampled.\n\nB. The step edge becomes sharper because eliminating noisy high frequencies suppresses ringing, and no wrap-around occurs since the central k-space is fully sampled.\n\nC. Edge sharpness is unchanged, but strong global ghost copies of the entire object with nearly equal intensity appear across the field of view due to equal-density aliasing from all k-space regions.\n\nD. The step edge is blurred, but any aliasing manifests as a uniform intensity offset rather than wrap-around, because only high-frequency lines were skipped.\n\nE. Edges remain sharp; only the signal-to-noise ratio decreases, and no structured artifacts are introduced by the undersampling pattern.",
            "solution": "The relationship between the true object spin density $\\rho(x)$ and the acquired k-space signal $S_{\\text{acq}}(k)$ is given by $S_{\\text{acq}}(k) = s(k) M(k)$, where $s(k) = \\mathcal{F}\\{\\rho(x)\\}$ is the Fourier transform of the object and $M(k)$ is the k-space sampling mask. The reconstructed image, $\\rho_{\\text{recon}}(x)$, is obtained by the inverse Fourier transform of the acquired data:\n$$ \\rho_{\\text{recon}}(x) = \\mathcal{F}^{-1}\\{S_{\\text{acq}}(k)\\} = \\mathcal{F}^{-1}\\{s(k) M(k)\\} $$\nBy the convolution theorem, multiplication in the frequency domain is equivalent to convolution in the spatial domain:\n$$ \\rho_{\\text{recon}}(x) = \\rho(x) * \\mathcal{F}^{-1}\\{M(k)\\} = \\rho(x) * \\text{PSF}(x) $$\nwhere $\\text{PSF}(x)$ is the Point Spread Function, determined entirely by the sampling mask $M(k)$. The properties of the reconstructed image are thus dictated by the shape of the PSF.\n\nThe mask $M(k)$ has three distinct regions:\n1.  A fully sampled central region: $M(k)$ is unity for $|k| \\le k_c$.\n2.  An undersampled outer region: For $k_c < |k| \\le k_{\\max}$, only every $R$-th sample is acquired.\n3.  An unsampled region: $M(k) = 0$ for $|k| > k_{\\max}$.\n\nWe analyze the two effects questioned: (i) edge sharpness and (ii) aliasing artifacts.\n\n(i) Edge Sharpness\nEdge sharpness in an image is determined by the extent of its high spatial frequency content. In MRI, this corresponds to the maximum acquired spatial frequency, $k_{\\max}$. Because the acquisition stops at $k_{\\max}$ (i.e., $M(k)=0$ for $|k| > k_{\\max}$), the k-space data is effectively multiplied by a window function of width $2k_{\\max}$. The inverse Fourier transform of this window blurs sharp features, such as the described step edge. The spatial resolution, and thus the achievable edge sharpness, is inversely proportional to $k_{\\max}$. Therefore, the finite extent of k-space acquisition inherently blurs the edge.\n\nFurthermore, the abrupt truncation of data at $k_{\\max}$ (and the abrupt change in sampling density at $k_c$) implies sharp edges in the k-space mask $M(k)$. Sharp transitions in the frequency domain lead to oscillatory behavior (ringing) in the spatial domain, an effect known as the Gibbs phenomenon. This will manifest as oscillatory artifacts in the vicinity of the sharp step edge in the image.\n\n(ii) Aliasing Artifacts\nAliasing arises from sampling a signal at a rate lower than the Nyquist rate. In MRI, the sampling increment in k-space, $\\Delta k$, determines the Field of View (FOV) in the image domain, with $\\text{FOV} = 1/\\Delta k$. Undersampling by a factor $R$ means using a sampling increment $R$ times larger, effectively reducing the FOV by a factor of $R$. This causes features outside the reduced FOV to \"wrap around\" or alias into the image.\n\nThe problem describes a variable-density sampling scheme. Let's analyze its components:\n- The central k-space region, $|k| \\le k_c$, is fully sampled with an increment $\\Delta k_{\\text{center}}$. This region encodes the low spatial frequency information of the object, such as overall shape and smooth contrast variations. Since it is fully sampled, it produces a low-resolution, unaliased image of the object. The FOV for this component is $\\text{FOV} = 1/\\Delta k_{\\text{center}}$.\n- The outer k-space region, $k_c < |k| \\le k_{\\max}$, is undersampled by a factor of $R$. The sampling increment is $\\Delta k_{\\text{outer}} = R \\cdot \\Delta k_{\\text{center}}$. This region encodes the high spatial frequency information, corresponding to edges and fine details. Due to the larger sampling increment, the effective FOV for this information is $\\text{FOV}/R$. This undersampling causes the high-frequency components of the image to alias. The aliased components appear as periodic replicas (ghosts) of the object's high-frequency features, displaced by multiples of $\\text{FOV}/R$.\n\nThe final image is a superposition of a non-aliased, low-resolution base image (from the k-space center) and aliased high-frequency details (from the k-space periphery). Therefore, the dominant artifact will be the periodic wrap-around of edges and textures, while the bulk, low-frequency contrast of the object remains correctly positioned and largely unaliased.\n\nBased on this derivation, we evaluate the options:\n\nA. The step edge appears blurred due to the finite $k_{\\max}$ (and ringing from abrupt truncation), and aliasing of high-frequency features occurs due to undersampling the periphery, while low-frequency contrast is preserved by the fully-sampled center. This aligns perfectly with our analysis. **Correct.**\n\nB. Limiting $k_{\\max}$ reduces high frequencies, which *blurs* edges, it does not sharpen them. Undersampling the outer k-space *causes* wrap-around aliasing; a fully sampled center does not prevent this for the high-frequency components. **Incorrect.**\n\nC. Edge sharpness is necessarily reduced by the finite $k_{\\max}$. The aliasing is not of the \"entire object\" but predominantly of its high-frequency features, because the sampling density is variable. **Incorrect.**\n\nD. The blurring part is correct. However, aliasing from periodic undersampling manifests as periodic replicas (wrap-around), not a uniform intensity offset. A uniform offset would correspond to an error in the $k=0$ (DC) sample, which is fully sampled in this case. **Incorrect.**\n\nE. Edges are blurred, not sharp. The undersampling pattern explicitly introduces structured aliasing artifacts. **Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}