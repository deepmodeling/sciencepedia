{
    "hands_on_practices": [
        {
            "introduction": "Understanding how spatial information is encoded in the MRI signal begins with a single, fundamental principle: the Larmor equation. This exercise guides you through a first-principles derivation to see how applying a linear magnetic field gradient causes the precession frequency and phase of nuclear spins to become dependent on their position. Mastering this core relationship  is the key to unlocking the mechanisms of frequency and phase encoding that make imaging possible.",
            "id": "4897840",
            "problem": "A spin system is placed in a uniform static magnetic field $B_0$ oriented along the $z$-axis. During the time interval $0 \\le t \\le T$, a constant linear magnetic field gradient $G_x$ along the $x$-direction is applied, so that the total field experienced by an isochromat at position $x$ is $B(x) = B_0 + G_x x$ during that interval. Let $\\gamma$ denote the gyromagnetic ratio in radians per second per Tesla. \n\nStarting only from the Larmor relation for angular frequency, $\\omega(x) = \\gamma B(x)$, and from the definition of phase as the time integral of angular frequency, derive:\n- the position-dependent angular frequency shift relative to the baseline precession at $B_0$, denoted $\\Delta \\omega(x)$, during the gradient,\n- and the additional phase accrued due solely to the gradient over the duration $T$, denoted $\\phi(x)$.\n\nExpress your final result as closed-form analytic expressions in terms of $\\gamma, G_x, x,$ and $T$, with angle in radians. State the International System of Units (SI) for $\\Delta \\omega(x)$ and for $\\phi(x)$ explicitly in your reasoning. \n\nProvide your final answer as a single row vector $\\begin{pmatrix} \\Delta \\omega(x) & \\phi(x) \\end{pmatrix}$.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- A uniform static magnetic field along the $z$-axis: $B_0$.\n- A constant linear magnetic field gradient along the $x$-direction: $G_x$.\n- The time interval during which the gradient is applied: $0 \\le t \\le T$.\n- The total magnetic field at position $x$ during this interval: $B(x) = B_0 + G_x x$.\n- The gyromagnetic ratio: $\\gamma$, in radians per second per Tesla.\n- The Larmor relation for angular frequency: $\\omega(x) = \\gamma B(x)$.\n- The definition of phase as the time integral of angular frequency.\n- The quantities to derive are:\n    1. The position-dependent angular frequency shift relative to the baseline precession, $\\Delta \\omega(x)$.\n    2. The additional phase accrued due solely to the gradient over the duration $T$, $\\phi(x)$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the fundamental principle of frequency encoding in magnetic resonance imaging (MRI). The Larmor equation, the application of a linear field gradient superimposed on a main static field, and the calculation of phase accumulation are all foundational and well-established concepts in physics and medical imaging. The premises are factually correct and scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It provides all necessary equations and constants to derive the two requested quantities, $\\Delta \\omega(x)$ and $\\phi(x)$. The derivation path is unambiguous, leading to a unique solution.\n- **Objective**: The problem is stated using precise, standard scientific terminology. There is no subjective, ambiguous, or opinion-based language.\n- **Completeness and Consistency**: The problem is self-contained. The provided information is sufficient and consistent for a complete derivation. No assumptions beyond the given statements are necessary.\n- **Feasibility and Plausibility**: The setup of a static magnetic field with a superimposed linear gradient is the standard physical basis for spatial encoding in MRI and is physically realistic.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid as it is scientifically sound, well-posed, and complete. A full solution will be provided.\n\n### Derivation of the Solution\nThe derivation proceeds from the fundamental principles provided in the problem statement.\n\n**1. Derivation of the Angular Frequency Shift, $\\Delta \\omega(x)$**\n\nThe total angular frequency, $\\omega(x)$, at a spatial position $x$ is given by the Larmor relation:\n$$\n\\omega(x) = \\gamma B(x)\n$$\nSubstituting the given expression for the total magnetic field, $B(x) = B_0 + G_x x$, we obtain the position-dependent angular frequency:\n$$\n\\omega(x) = \\gamma (B_0 + G_x x) = \\gamma B_0 + \\gamma G_x x\n$$\nThe baseline precession frequency, $\\omega_0$, is the frequency in the absence of the gradient field (i.e., when $G_x = 0$) or at the isocenter ($x=0$). This frequency is determined solely by the static field $B_0$:\n$$\n\\omega_0 = \\gamma B_0\n$$\nThe angular frequency shift, $\\Delta \\omega(x)$, is defined as the change in frequency from this baseline due to the presence of the gradient. It is the difference between the total frequency $\\omega(x)$ and the baseline frequency $\\omega_0$:\n$$\n\\Delta \\omega(x) = \\omega(x) - \\omega_0\n$$\nSubstituting the expressions for $\\omega(x)$ and $\\omega_0$:\n$$\n\\Delta \\omega(x) = (\\gamma B_0 + \\gamma G_x x) - (\\gamma B_0)\n$$\nThis simplifies to the expression for the frequency shift:\n$$\n\\Delta \\omega(x) = \\gamma G_x x\n$$\nThe International System of Units (SI) for $\\Delta \\omega(x)$ is determined from the units of the constituent terms. The gyromagnetic ratio $\\gamma$ has units of $\\text{rad} \\cdot \\text{s}^{-1} \\cdot \\text{T}^{-1}$. The gradient strength $G_x$ has units of $\\text{T} \\cdot \\text{m}^{-1}$. The position $x$ has units of $\\text{m}$. Therefore, the units of $\\Delta \\omega(x)$ are:\n$$\n[\\text{rad} \\cdot \\text{s}^{-1} \\cdot \\text{T}^{-1}] \\times [\\text{T} \\cdot \\text{m}^{-1}] \\times [\\text{m}] = \\text{rad} \\cdot \\text{s}^{-1}\n$$\nThis is the correct unit for an angular frequency.\n\n**2. Derivation of the Additional Phase, $\\phi(x)$**\n\nPhase, $\\phi(t)$, is the time integral of angular frequency, $\\omega(t)$. The additional phase, $\\phi(x)$, accrued *solely due to the gradient* is the time integral of the *additional* angular frequency, $\\Delta \\omega(x)$, over the time interval $T$ during which the gradient is applied.\n$$\n\\phi(x) = \\int_{0}^{T} \\Delta \\omega(x) \\, dt\n$$\nThe problem states that the gradient $G_x$ is a *constant* linear magnetic field gradient applied during the time interval $0 \\le t \\le T$. Since $\\gamma$, $G_x$, and the spatial position $x$ are all constant with respect to the integration variable $t$, the frequency shift $\\Delta \\omega(x) = \\gamma G_x x$ is also constant over the integration interval.\nTherefore, we can take $\\Delta \\omega(x)$ outside the integral:\n$$\n\\phi(x) = \\Delta \\omega(x) \\int_{0}^{T} dt\n$$\nEvaluating the integral:\n$$\n\\int_{0}^{T} dt = [t]_{0}^{T} = T - 0 = T\n$$\nSubstituting this result back, we find the accumulated phase:\n$$\n\\phi(x) = \\Delta \\omega(x) \\cdot T\n$$\nFinally, substituting the expression for $\\Delta \\omega(x)$:\n$$\n\\phi(x) = (\\gamma G_x x) T = \\gamma G_x x T\n$$\nThe SI unit for $\\phi(x)$ is derived from the units of $\\Delta \\omega(x)$ (rad$\\cdot$s$^{-1}$) and time $T$ (s):\n$$\n[\\text{rad} \\cdot \\text{s}^{-1}] \\times [\\text{s}] = \\text{rad}\n$$\nThis is the correct unit for a phase angle, as required.\n\nThe final result is a row vector containing the expressions for $\\Delta \\omega(x)$ and $\\phi(x)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\gamma G_{x} x & \\gamma G_{x} x T \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the fundamental principle of phase encoding established, we can now design a practical imaging sequence. This practice challenges you to think like an MRI physicist, determining the precise gradient steps needed to acquire data for a two-dimensional image without aliasing artifacts . You will apply the Fourier relationship between the desired field of view ($FOV$) and the required sampling in k-space to design a complete phase-encoding scheme from the ground up.",
            "id": "4897851",
            "problem": "A two-dimensional Magnetic Resonance Imaging (MRI) spin-warp experiment is performed with readout along the $x$-axis and phase encoding along the $y$-axis. Spatial encoding arises because the Larmor angular frequency satisfies $\\omega(t) = \\gamma B(t)$ and the instantaneous magnetic field under a linear gradient $G_y(t)$ is $B(y,t) = B_0 + y\\,G_y(t)$. The accumulated phase is $\\phi(y,t) = \\int \\gamma B(y,t)\\,dt$, and by definition of the $k$-space coordinate, spatial frequency along $y$ obeys $k_y(t) = \\frac{1}{2\\pi}\\frac{\\partial \\phi(y,t)}{\\partial y}$.\n\nThe phase-encode gradient $G_y(t)$ is applied as a rectangular lobe of fixed duration $\\tau_{\\mathrm{pe}}$ prior to readout, and its lobe area is $A \\equiv \\int G_y(t)\\,dt$ with units of $\\mathrm{T\\cdot s/m}$. The acquisition samples $N_y$ equally spaced $k_y$ lines that must uniformly cover a prescribed field of view $FOV_y$ without aliasing. Assume proton spins with gyromagnetic ratio $\\gamma = 2.675\\times 10^{8}\\ \\mathrm{rad\\,s^{-1}\\,T^{-1}}$.\n\nStarting only from the preceding fundamentals and the Fourier relationship between object extent and $k$-space sampling, carry out the following:\n\n1. Derive the minimal required increment in phase-encode gradient area $\\Delta A$ between adjacent $k_y$ lines that guarantees no aliasing across the prescribed $FOV_y$. Then, for $FOV_y = 0.24\\ \\mathrm{m}$, compute the numerical value of $\\Delta A$. Round your answer to four significant figures and express it in $\\mathrm{T\\cdot s/m}$.\n\n2. Using the same principles, design an analytic expression for the phase-encode lobe amplitude $G_n$ (in $\\mathrm{T/m}$) for the $n$th $k_y$ line, with $n = 0,1,\\dots,N_y-1$, such that $k$-space is centered at zero and the lines are uniformly spaced to realize the target $FOV_y$. Your expression should be in closed form in terms of $n$, $N_y$, $\\tau_{\\mathrm{pe}}$, $\\gamma$, and $FOV_y$, and should assume a rectangular lobe of duration $\\tau_{\\mathrm{pe}}$ for each phase encoding.\n\nUse $N_y = 128$ and $\\tau_{\\mathrm{pe}} = 2.0\\times 10^{-3}\\ \\mathrm{s}$ for concreteness where needed, but do not substitute numerical values into the analytic expression for $G_n$.",
            "solution": "The problem will be validated by first extracting all given information and then assessing its scientific validity and self-consistency.\n\n### Step 1: Extract Givens\n- A two-dimensional Magnetic Resonance Imaging (MRI) spin-warp experiment is performed.\n- Readout is along the $x$-axis.\n- Phase encoding is along the $y$-axis.\n- Larmor angular frequency: $\\omega(t) = \\gamma B(t)$.\n- Instantaneous magnetic field under a linear gradient $G_y(t)$: $B(y,t) = B_0 + y\\,G_y(t)$.\n- Accumulated phase: $\\phi(y,t) = \\int \\gamma B(y,t)\\,dt$.\n- Definition of the $k$-space coordinate along $y$: $k_y(t) = \\frac{1}{2\\pi}\\frac{\\partial \\phi(y,t)}{\\partial y}$.\n- The phase-encode gradient $G_y(t)$ is applied as a rectangular lobe of fixed duration $\\tau_{\\mathrm{pe}}$ prior to readout.\n- The gradient lobe area is defined as $A \\equiv \\int G_y(t)\\,dt$.\n- The acquisition samples $N_y$ equally spaced $k_y$ lines.\n- The sampling must uniformly cover a prescribed field of view $FOV_y$ without aliasing.\n- Gyromagnetic ratio for proton spins: $\\gamma = 2.675\\times 10^{8}\\ \\mathrm{rad\\,s^{-1}\\,T^{-1}}$.\n- For Part 1, the field of view is $FOV_y = 0.24\\ \\mathrm{m}$.\n- For Part 2, the number of phase-encoding steps is $N_y = 128$ and the gradient duration is $\\tau_{\\mathrm{pe}} = 2.0\\times 10^{-3}\\ \\mathrm{s}$.\n- The index for phase-encode lines is $n = 0,1,\\dots,N_y-1$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in the fundamental principles of Magnetic Resonance Imaging. The Larmor equation, the use of linear magnetic field gradients for spatial encoding, the definition of accumulated phase, and the relationship between phase and k-space are all cornerstones of MRI physics. The term \"spin-warp\" correctly identifies this class of 2D Fourier imaging techniques.\n- **Well-Posed:** The problem asks for specific, derivable quantities ($\\Delta A$ and $G_n$) based on the provided physical model and parameters. The questions are structured to lead to unique, meaningful solutions.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased technical language.\n- **Complete and Consistent:** All necessary definitions, physical laws, and constants are provided to solve the problem. The Fourier relationship between object size ($FOV_y$) and k-space sampling ($\\Delta k_y$) is a standard principle the solver is expected to apply, as prompted by the problem statement. The provided numerical values are physically realistic for a clinical MRI system. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and self-contained. A complete solution will be provided.\n\n### Solution Derivation\n\nThe core of spatial encoding in MRI lies in making the precessional phase of nuclear spins a function of their spatial location. The problem provides the fundamental relations for this process.\n\n**Part 1: Derivation and Calculation of $\\Delta A$**\n\nThe spatially-dependent phase, $\\phi(y)$, accumulated during the application of the phase-encode gradient $G_y(t)$ is what encodes position. Starting with the given definition of total phase, $\\phi(y,t) = \\int \\gamma B(y,t)\\,dt$, we substitute the expression for the magnetic field, $B(y,t) = B_0 + y\\,G_y(t)$:\n$$ \\phi(y) = \\int_{\\mathrm{pe}} \\gamma (B_0 + y\\,G_y(t))\\,dt $$\nThe integral is taken over the duration of the phase-encoding gradient, denoted by 'pe'. We can separate the terms:\n$$ \\phi(y) = \\int_{\\mathrm{pe}} \\gamma B_0\\,dt + y \\int_{\\mathrm{pe}} \\gamma G_y(t)\\,dt $$\nThe first term, $\\int_{\\mathrm{pe}} \\gamma B_0\\,dt$, is a phase offset that is constant with respect to the spatial coordinate $y$. It does not contribute to spatial encoding and can be disregarded. The second term contains the spatial information. We can pull the constants $y$ and $\\gamma$ out of the integral:\n$$ \\phi_{\\mathrm{enc}}(y) = \\gamma y \\int_{\\mathrm{pe}} G_y(t)\\,dt $$\nThe problem defines the area of the gradient lobe as $A \\equiv \\int G_y(t)\\,dt$. Thus, the encoding phase is:\n$$ \\phi_{\\mathrm{enc}}(y) = \\gamma y A $$\nNext, we use the given definition of the k-space coordinate, $k_y = \\frac{1}{2\\pi}\\frac{\\partial \\phi}{\\partial y}$. The phase $\\phi$ in this definition refers to the total accumulated phase that varies with $y$. Applying this to our encoding phase:\n$$ k_y = \\frac{1}{2\\pi} \\frac{\\partial}{\\partial y} (\\gamma y A) = \\frac{\\gamma A}{2\\pi} $$\nThis equation establishes a direct proportionality between the k-space coordinate $k_y$ and the area of the applied phase-encoding gradient lobe $A$.\n\nThe problem requires that the chosen sampling strategy avoids aliasing across the field of view $FOV_y$. This invokes the Nyquist sampling theorem as applied to spatial frequencies (k-space). The theorem dictates that the spacing between samples in k-space, $\\Delta k_y$, is determined by the extent of the object in the spatial domain, $FOV_y$. The relationship is:\n$$ \\Delta k_y = \\frac{1}{FOV_y} $$\nSince $k_y$ is proportional to $A$, a discrete step $\\Delta k_y$ in k-space must be achieved by applying a discrete increment in gradient area, $\\Delta A$. From the relation $k_y = \\frac{\\gamma A}{2\\pi}$, we can write the relationship for the increments:\n$$ \\Delta k_y = \\frac{\\gamma \\Delta A}{2\\pi} $$\nBy equating the two expressions for $\\Delta k_y$, we can solve for the required minimum increment in gradient area, $\\Delta A$:\n$$ \\frac{1}{FOV_y} = \\frac{\\gamma \\Delta A}{2\\pi} $$\n$$ \\Delta A = \\frac{2\\pi}{\\gamma FOV_y} $$\nThis is the required analytical expression for $\\Delta A$. Now, we compute its numerical value using the provided constants: $\\gamma = 2.675\\times 10^{8}\\ \\mathrm{rad\\,s^{-1}\\,T^{-1}}$ and $FOV_y = 0.24\\ \\mathrm{m}$.\n$$ \\Delta A = \\frac{2\\pi}{(2.675\\times 10^{8}\\ \\mathrm{rad\\,s^{-1}\\,T^{-1}}) \\times (0.24\\ \\mathrm{m})} = \\frac{2\\pi}{6.42 \\times 10^{7}\\ \\mathrm{rad\\,s^{-1}\\,T^{-1}\\,m}} $$\nThis evaluates to $\\Delta A \\approx 9.78441 \\times 10^{-8}\\ \\mathrm{T\\cdot s/m}$.\nRounding to four significant figures as requested, we get $\\Delta A = 9.784 \\times 10^{-8}\\ \\mathrm{T\\cdot s/m}$.\n\n**Part 2: Derivation of the Phase-Encode Lobe Amplitude $G_n$**\n\nThe goal is to design a set of gradient amplitudes $G_n$ for a rectangular pulse of duration $\\tau_{\\mathrm{pe}}$ that results in $N_y$ uniformly spaced k-space lines centered at zero. The index $n$ runs from $0$ to $N_y-1$.\n\nTo center the k-space acquisition, the set of sampled $k_y$ values must be symmetric about $k_y=0$. For an index $n$ from $0$ to $N_y-1$, a symmetric set of values can be generated by shifting the index by its mean value, which is $\\frac{N_y-1}{2}$. The position of the $n$-th k-space line is therefore:\n$$ k_y(n) = \\left( n - \\frac{N_y-1}{2} \\right) \\Delta k_y $$\nFor example, with $N_y=128$, the term $(n - \\frac{127}{2})$ runs from $-63.5$ to $+63.5$ in integer steps, creating a symmetric set of multipliers.\n\nWe already established that $k_y = \\frac{\\gamma A}{2\\pi}$. For a rectangular gradient pulse of amplitude $G_n$ and duration $\\tau_{\\mathrm{pe}}$, the area $A_n$ is simply their product: $A_n = G_n \\tau_{\\mathrm{pe}}$. Substituting this into the k-space equation gives the k-space position for the $n$-th encoding step:\n$$ k_y(n) = \\frac{\\gamma G_n \\tau_{\\mathrm{pe}}}{2\\pi} $$\nNow, we equate the two expressions for $k_y(n)$ to find the required gradient amplitude $G_n$:\n$$ \\frac{\\gamma G_n \\tau_{\\mathrm{pe}}}{2\\pi} = \\left( n - \\frac{N_y-1}{2} \\right) \\Delta k_y $$\nSubstituting the expression for the k-space step, $\\Delta k_y = \\frac{1}{FOV_y}$:\n$$ \\frac{\\gamma G_n \\tau_{\\mathrm{pe}}}{2\\pi} = \\left( n - \\frac{N_y-1}{2} \\right) \\frac{1}{FOV_y} $$\nFinally, we solve for $G_n$ to obtain the closed-form expression in terms of the specified variables:\n$$ G_n = \\frac{2\\pi}{\\gamma \\tau_{\\mathrm{pe}} FOV_y} \\left( n - \\frac{N_y-1}{2} \\right) $$\nThis expression defines the amplitude of the phase-encoding gradient for the $n$-th step, ensuring a symmetric and uniform sampling of k-space that satisfies the Nyquist criterion for the specified $FOV_y$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9.784 \\times 10^{-8} & \\frac{2\\pi}{\\gamma \\tau_{\\mathrm{pe}} FOV_y} \\left( n - \\frac{N_y - 1}{2} \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Our ideal models of spatial encoding rely on perfectly linear magnetic field gradients, but real-world hardware is never perfect. This exercise explores the practical consequences of gradient field nonlinearity, a common system imperfection. By deriving the relationship between an object's true position and its apparent position in the reconstructed image, you will gain insight into how hardware limitations can introduce geometric distortions and ultimately define the usable field of view .",
            "id": "4897830",
            "problem": "A patient is imaged using Magnetic Resonance Imaging (MRI) with readout encoding along the $x$-axis. Spatial encoding in MRI relies on the Larmor relation $\\omega = \\gamma B$ and on the addition of a gradient magnetic field so that the local precession frequency depends on position. In an ideal system with a perfectly linear gradient, a constant readout gradient of nominal amplitude $G_{0}$ applied for duration $\\tau$ produces a phase $\\phi(x) = \\gamma G_{0} x \\tau$, which is inverted by the reconstruction to yield position $x$ via $x = \\phi/(\\gamma G_{0} \\tau)$.\n\nIn practice, gradient coils are not perfectly linear. Suppose the actual readout gradient amplitude experienced by spins at position $x$ is $G_{\\mathrm{eff}}(x) = G_{0} S(x)$, where the spatial sensitivity $S(x)$ deviates from unity according to a well-characterized, weakly nonlinear model\n$$\nS(x) = 1 + \\beta \\left(\\frac{x}{R}\\right)^{2}\n$$\nwith $0 < \\beta \\ll 1$ and $R$ a coil length scale (take $R$ to represent the effective gradient coil radius). Under this model, the reconstruction still assumes $G_{0}$, so the apparent position becomes $x_{\\mathrm{app}} = \\phi/(\\gamma G_{0} \\tau)$.\n\nAnswer the following in a single coherent derivation:\n\n1. Starting from $\\omega = \\gamma B$ and the phase accrued under a constant readout gradient, explain how the position-dependent $S(x)$ alters the mapping from true position $x$ to apparent position $x_{\\mathrm{app}}$, and use this to argue how gradient nonlinearity limits both the effective field of view (FOV) and the spatial resolution at the periphery.\n\n2. Define the geometric distortion at position $x$ as $\\Delta x(x) \\equiv x_{\\mathrm{app}} - x$. Given a maximum tolerable distortion equal to one voxel width, require $|\\Delta x(x)| \\leq \\Delta$ at the imaging boundary. Assume isotropic resolution with voxel edge length $\\Delta$ and identical nonlinearity along all three axes, so that the acceptable imaging volume is a sphere of radius $r_{\\max}$ centered at isocenter such that $|\\Delta x(r_{\\max})| = \\Delta$ along any Cartesian axis.\n\n3. Using the model for $S(x)$ above, derive an expression for $r_{\\max}$ in terms of $\\Delta$, $R$, and $\\beta$, and then compute the corresponding spherical imaging volume $V = \\frac{4}{3}\\pi r_{\\max}^{3}$ for the parameters $R = 0.30\\ \\mathrm{m}$, $\\beta = 0.050$, and $\\Delta = 1.0\\ \\mathrm{mm}$. Round your final numerical answer to three significant figures and express the final volume in liters.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective, describing a simplified but physically realistic model of gradient non-linearity in Magnetic Resonance Imaging (MRI). All necessary parameters and definitions are provided for a unique solution. Therefore, the problem is valid.\n\nThe core principle of spatial encoding in MRI is the Larmor relation, which states that the angular precession frequency $\\omega$ of a nuclear spin is directly proportional to the magnetic field strength $B$ it experiences, via the gyromagnetic ratio $\\gamma$: $\\omega = \\gamma B$. To encode spatial information, a linear magnetic field gradient is superimposed on the main static field $B_0$. For readout encoding along the $x$-axis, the total magnetic field ideally becomes $B(x) = B_0 + G_0 x$, where $G_0$ is the constant gradient amplitude. The position-dependent part of the Larmor frequency is thus $\\omega(x) = \\gamma G_0 x$. When this gradient is applied for a duration $\\tau$, the accumulated phase, relative to the isocenter ($x=0$), is $\\phi(x) = \\omega(x) \\tau = \\gamma G_0 x \\tau$. An ideal reconstruction algorithm inverts this relationship to find the true position $x$ from the measured phase: $x = \\phi / (\\gamma G_0 \\tau)$.\n\nThe problem introduces a non-ideal scenario where the actual gradient amplitude is not constant but varies with position $x$. This is described by an effective gradient amplitude $G_{\\mathrm{eff}}(x) = G_0 S(x)$, where $S(x) = 1 + \\beta (x/R)^2$ is a spatial sensitivity function. Here, $\\beta$ is a small positive dimensionless parameter characterizing the nonlinearity, and $R$ is a characteristic length scale of the gradient coil.\n\nUnder this condition, the actual position-dependent Larmor frequency is $\\omega_{\\mathrm{actual}}(x) = \\gamma G_{\\mathrm{eff}}(x) x$. After the readout duration $\\tau$, the phase accumulated by spins at position $x$ is:\n$$\n\\phi(x) = \\omega_{\\mathrm{actual}}(x) \\tau = \\gamma [G_0 S(x)] x \\tau\n$$\nThe reconstruction system, however, is unaware of the nonlinearity $S(x)$ and operates on the assumption of an ideal gradient $G_0$. It calculates the apparent position, $x_{\\mathrm{app}}$, using the ideal formula:\n$$\nx_{\\mathrm{app}} = \\frac{\\phi(x)}{\\gamma G_0 \\tau}\n$$\nSubstituting the expression for the actual phase $\\phi(x)$ into this reconstruction equation yields the mapping from the true position $x$ to the apparent position $x_{\\mathrm{app}}$:\n$$\nx_{\\mathrm{app}}(x) = \\frac{\\gamma G_0 S(x) x \\tau}{\\gamma G_0 \\tau} = S(x) x = \\left[1 + \\beta \\left(\\frac{x}{R}\\right)^2\\right] x\n$$\nThis relationship, $x_{\\mathrm{app}}(x) = x + \\beta x^3/R^2$, directly demonstrates how gradient nonlinearity leads to geometric distortion. Since $\\beta > 0$, for any position $x \\neq 0$, the apparent position $|x_{\\mathrm{app}}|$ is greater than the true position $|x|$. This outward displacement of features is known as pin-cushion distortion.\n\nThis distortion limits the effective Field of View (FOV). As one moves away from the isocenter ($x=0$), the misrepresentation of position increases rapidly with the cube of the distance. The effective FOV is the region within which this geometric distortion remains below a tolerable threshold, ensuring the spatial integrity of the image.\n\nFurthermore, gradient nonlinearity limits spatial resolution. The local magnification factor, $M(x)$, describes how an infinitesimal interval $\\delta x$ in object space is mapped to an interval $\\delta x_{\\mathrm{app}}$ in image space:\n$$\nM(x) = \\frac{dx_{\\mathrm{app}}}{dx} = \\frac{d}{dx} \\left[x + \\beta \\frac{x^3}{R^2}\\right] = 1 + 3\\beta \\left(\\frac{x}{R}\\right)^2\n$$\nAt the isocenter ($x=0$), $M(0) = 1$, and resolution is unaffected. At the periphery ($x \\neq 0$), $M(x) > 1$, meaning that structures appear magnified. This non-uniform magnification implies that the spatial resolution is not constant across the FOV. While the physical size of an object corresponding to an image pixel actually decreases at the periphery (improving \"true\" local resolution), this variation itself is a degradation of image quality. The image becomes warped, and the assumption of uniform resolution, which is fundamental to many diagnostic interpretations and post-processing algorithms, is violated. This non-uniformity is a practical limit on achieving consistent spatial resolution.\n\nFollowing the problem, we define the geometric distortion as $\\Delta x(x) = x_{\\mathrm{app}} - x$. Using our derived mapping:\n$$\n\\Delta x(x) = \\left[x + \\beta \\frac{x^3}{R^2}\\right] - x = \\beta \\frac{x^3}{R^2}\n$$\nThe problem specifies a maximum tolerable distortion of one voxel width, $\\Delta$. The acceptable imaging volume is defined as a sphere of radius $r_{\\max}$ where the distortion at the boundary along any Cartesian axis equals $\\Delta$. We evaluate the condition at $x = r_{\\max}$:\n$$\n|\\Delta x(r_{\\max})| = \\left|\\beta \\frac{r_{\\max}^3}{R^2}\\right| = \\Delta\n$$\nSince $\\beta$, $r_{\\max}$, and $R$ are positive quantities, we can drop the absolute value:\n$$\n\\beta \\frac{r_{\\max}^3}{R^2} = \\Delta\n$$\nWe can now solve for $r_{\\max}$. First, we isolate the term $r_{\\max}^3$:\n$$\nr_{\\max}^3 = \\frac{\\Delta R^2}{\\beta}\n$$\nThis gives the maximum acceptable radius cubed. The spherical imaging volume is given by $V = \\frac{4}{3}\\pi r_{\\max}^3$. Substituting our expression for $r_{\\max}^3$:\n$$\nV = \\frac{4}{3}\\pi \\left(\\frac{\\Delta R^2}{\\beta}\\right)\n$$\nWe are given the parameters $R = 0.30\\ \\mathrm{m}$, $\\beta = 0.050$, and $\\Delta = 1.0\\ \\mathrm{mm}$. To maintain consistent units, we convert $\\Delta$ to meters: $\\Delta = 1.0 \\times 10^{-3}\\ \\mathrm{m}$.\nSubstituting these values into the volume expression:\n$$\nV = \\frac{4}{3}\\pi \\left(\\frac{(1.0 \\times 10^{-3}\\ \\mathrm{m}) (0.30\\ \\mathrm{m})^2}{0.050}\\right)\n$$\n$$\nV = \\frac{4}{3}\\pi \\left(\\frac{(1.0 \\times 10^{-3}) (0.090)}{0.050}\\right) \\mathrm{m}^3\n$$\n$$\nV = \\frac{4}{3}\\pi \\left(\\frac{9.0 \\times 10^{-5}}{5.0 \\times 10^{-2}}\\right) \\mathrm{m}^3\n$$\n$$\nV = \\frac{4}{3}\\pi (1.8 \\times 10^{-3}) \\mathrm{m}^3 = 2.4\\pi \\times 10^{-3}\\ \\mathrm{m}^3\n$$\nNumerically, this is $V \\approx 7.539822... \\times 10^{-3}\\ \\mathrm{m}^3$.\nThe problem requires the final answer in liters. The conversion is $1\\ \\mathrm{m}^3 = 1000\\ \\mathrm{L}$.\n$$\nV \\approx (7.539822... \\times 10^{-3}) \\times 1000\\ \\mathrm{L} = 7.539822...\\ \\mathrm{L}\n$$\nRounding to three significant figures, the final volume is $7.54\\ \\mathrm{L}$.",
            "answer": "$$\\boxed{7.54}$$"
        }
    ]
}