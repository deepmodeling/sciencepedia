{
    "hands_on_practices": [
        {
            "introduction": "这项练习将奠定基础，它将宏观测量值与材料的内在属性联系起来。你将使用模拟实验中的数据，包括剪切波速度（$c_s$）、施加的应力（$\\sigma_{zz}$）和产生的应变（$\\epsilon_{zz}$），来推导基本的弹性常数：剪切模量（$\\mu$）和泊松比（$\\nu$）。这个问题将巩固你对线弹性本构律的理解，并展示剪切波和应变弹性成像如何提供关于组织力学的互补信息 。",
            "id": "4940402",
            "problem": "在小形变、线性、各向同性弹性条件下，使用应变成像和剪切波弹性成像技术对均匀的软组织体模进行探查。沿轴向 $z$ 施加垂直的准静态压缩，同时约束侧面以抑制侧向形变（侧向约束）。通过力传感和超声散斑跟踪分别测量了稳态轴向柯西应力 $\\sigma_{zz}$ 和轴向工程应变 $\\epsilon_{zz}$。在一次使用声辐射力脉冲 (ARFI) 剪切波弹性成像的独立采集中，在同一感兴趣区域内测量了剪切波速度 $c_{s}$。组织质量密度是已知的。\n\n假设实验测得以下值：\n-   $\\rho = 1000 \\, \\text{kg/m}^3$,\n-   $c_{s} = 3.00 \\, \\text{m/s}$,\n-   $\\sigma_{zz} = -2.25 \\, \\text{kPa}$ 当 $\\epsilon_{zz} = -0.010$.\n\n假设在真实状态下，侧向约束意味着 $\\epsilon_{xx} = \\epsilon_{yy} = 0$。然而，侧向应变跟踪算法可能会报告一个微小的伪侧向应变 $\\epsilon_{xx} = e$（根据对称性，$\\epsilon_{yy}=e$），分析师可能会错误地在三维各向同性本构律的直接反演中使用它来估计泊松比。\n\n仅从线性各向同性弹性的基本本构关系和线性弹性固体中剪切波速度的定义出发，完成以下任务：\n1) 根据 $\\rho$ 和 $c_{s}$ 确定剪切模量 $\\mu$。\n2) 使用在侧向约束下测得的 $\\sigma_{zz}$ 和 $\\epsilon_{zz}$ 以及您计算出的 $\\mu$ 值，确定泊松比 $\\nu$。\n3) 如果分析师改为通过将测得的 $\\epsilon_{xx}=e$（以及 $\\epsilon_{yy}=e$）代入 $\\sigma_{zz}$ 的三维各向同性应力-应变关系来估计 $\\nu$，计算在 $e=0$ 时，估计的泊松比对此侧向应变测量的的一阶灵敏度；即，求 $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0}$ 的值。\n\n将您的最终答案以行向量的形式报告，按顺序包含：以 $\\text{kPa}$ 为单位的 $\\mu$、$\\nu$（无量纲）以及 $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0}$（无量纲）。将每个条目四舍五入到四位有效数字。不要在最终的方框答案中包含单位；仅在文本中按要求说明单位。",
            "solution": "该问题经验证具有科学依据，是适定的、客观的。所有提供的数据对于软组织都是物理上现实的，任务基于连续介质力学和波传播的基本原理。该问题是自洽的，没有矛盾之处。\n\n根据问题陈述的要求，解答分为三个部分。\n\n**第1部分：确定剪切模量 $\\mu$**\n\n线性、各向同性、弹性固体中剪切波的传播由波动方程决定。这些波的速度 $c_s$ 与材料的剪切模量 $\\mu$ 及其质量密度 $\\rho$ 通过以下基本关系相关联：\n$$c_s = \\sqrt{\\frac{\\mu}{\\rho}}$$\n为了确定剪切模量 $\\mu$，我们可以重新排列这个方程：\n$$\\mu = \\rho c_s^2$$\n问题提供了以下数值：\n-   质量密度, $\\rho = 1000 \\, \\text{kg/m}^3$\n-   剪切波速度, $c_s = 3.00 \\, \\text{m/s}$\n\n将这些值代入 $\\mu$ 的方程中：\n$$\\mu = (1000 \\, \\text{kg/m}^3) \\times (3.00 \\, \\text{m/s})^2$$\n$$\\mu = 1000 \\times 9.00 \\, \\text{kg}\\cdot\\text{m}^{-1}\\cdot\\text{s}^{-2}$$\n$$\\mu = 9000 \\, \\text{Pa}$$\n问题要求以千帕（$\\text{kPa}$）为单位表示 $\\mu$ 的值。由于 $1 \\, \\text{kPa} = 1000 \\, \\text{Pa}$，我们有：\n$$\\mu = 9.00 \\, \\text{kPa}$$\n\n**第2部分：确定泊松比 $\\nu$**\n\n线性、各向同性弹性材料的本构关系，也称为广义胡克定律，将柯西应力张量 $\\sigma_{ij}$ 与工程应变张量 $\\epsilon_{ij}$ 联系起来，如下所示：\n$$\\sigma_{ij} = \\lambda \\delta_{ij} \\epsilon_{kk} + 2\\mu \\epsilon_{ij}$$\n这里，$\\lambda$ 是拉梅(Lamé)第一参数，$\\mu$ 是剪切模量，$\\delta_{ij}$ 是克罗内克(Kronecker)符号，$\\epsilon_{kk} = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}$ 是应变张量的迹，代表体积应变。\n\n实验在侧向约束的条件下进行，这意味着侧向（$x$ 和 $y$ 方向）的应变为零：\n$$\\epsilon_{xx} = 0, \\quad \\epsilon_{yy} = 0$$\n对于轴向应力分量 $\\sigma_{zz}$（其中 $i=j=z$），本构关系变为：\n$$\\sigma_{zz} = \\lambda(\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n代入侧向约束条件：\n$$\\sigma_{zz} = \\lambda(0 + 0 + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n$$\\sigma_{zz} = (\\lambda + 2\\mu) \\epsilon_{zz}$$\n拉梅参数 $\\lambda$ 和 $\\mu$ 通过以下表达式与泊松比 $\\nu$ 相关：\n$$\\lambda = \\frac{2\\mu\\nu}{1 - 2\\nu}$$\n将此代入 $\\sigma_{zz}$ 的方程中：\n$$\\sigma_{zz} = \\left(\\frac{2\\mu\\nu}{1 - 2\\nu} + 2\\mu\\right) \\epsilon_{zz}$$\n提出因子 $2\\mu$：\n$$\\sigma_{zz} = 2\\mu \\left(\\frac{\\nu}{1 - 2\\nu} + 1\\right) \\epsilon_{zz} = 2\\mu \\left(\\frac{\\nu + 1 - 2\\nu}{1 - 2\\nu}\\right) \\epsilon_{zz}$$\n$$\\sigma_{zz} = 2\\mu \\left(\\frac{1 - \\nu}{1 - 2\\nu}\\right) \\epsilon_{zz}$$\n为了求出 $\\nu$，我们重新排列这个方程。让我们定义一个无量纲量 $K$：\n$$K = \\frac{\\sigma_{zz}}{2\\mu \\epsilon_{zz}}$$\n然后，我们有：\n$$K = \\frac{1 - \\nu}{1 - 2\\nu}$$\n$$K(1 - 2\\nu) = 1 - \\nu$$\n$$K - 2K\\nu = 1 - \\nu$$\n$$K - 1 = 2K\\nu - \\nu = \\nu(2K - 1)$$\n$$\\nu = \\frac{K - 1}{2K - 1}$$\n我们已知实验值为：\n-   $\\sigma_{zz} = -2.25 \\, \\text{kPa} = -2250 \\, \\text{Pa}$\n-   $\\epsilon_{zz} = -0.010$\n-   $\\mu = 9000 \\, \\text{Pa}$ (来自第1部分)\n\n首先，我们计算 $K$：\n$$K = \\frac{-2250 \\, \\text{Pa}}{2 \\times (9000 \\, \\text{Pa}) \\times (-0.010)} = \\frac{-2250}{-180} = 12.5$$\n现在，我们计算 $\\nu$：\n$$\\nu = \\frac{12.5 - 1}{2(12.5) - 1} = \\frac{11.5}{25 - 1} = \\frac{11.5}{24} = \\frac{23}{48}$$\n写成小数形式，$\\nu \\approx 0.479166...$。\n\n**第3部分：估计的泊松比的灵敏度**\n\n一位分析师错误地在成本构关系中使用了伪侧向应变测量值 $\\epsilon_{xx} = e$ 和 $\\epsilon_{yy} = e$。相关的应力分量仍然是 $\\sigma_{zz}$：\n$$\\sigma_{zz} = \\lambda(\\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n代入伪应变：\n$$\\sigma_{zz} = \\lambda(e + e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz} = \\lambda(2e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n我们再次代入 $\\lambda = \\frac{2\\mu\\nu}{1 - 2\\nu}$。这里，$\\nu$ 是估计的泊松比，它现在是 $e$ 的函数。\n$$\\sigma_{zz} = \\frac{2\\mu\\nu(e)}{1 - 2\\nu(e)}(2e + \\epsilon_{zz}) + 2\\mu \\epsilon_{zz}$$\n为了找到灵敏度 $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\left.\\frac{d\\nu}{de}\\right|_{e=0}$，我们可以对 $e$ 使用隐式微分。量 $\\sigma_{zz}$、$\\epsilon_{zz}$ 和 $\\mu$ 被视为常数。\n$$0 = \\frac{d}{de} \\left[ \\frac{2\\mu\\nu(e)}{1-2\\nu(e)}(2e + \\epsilon_{zz}) \\right] + 0$$\n应用乘法法则和链式法则：\n$$0 = 2\\mu \\left[ \\frac{d}{de}\\left(\\frac{\\nu}{1-2\\nu}\\right) (2e + \\epsilon_{zz}) + \\frac{\\nu}{1-2\\nu} \\frac{d}{de}(2e+\\epsilon_{zz}) \\right]$$\n$\\frac{\\nu}{1-2\\nu}$ 对 $\\nu$ 的导数是 $\\frac{1}{(1-2\\nu)^2}$。$(2e+\\epsilon_{zz})$ 对 $e$ 的导数是 $2$。\n$$0 = \\frac{1}{(1-2\\nu)^2} \\frac{d\\nu}{de} (2e + \\epsilon_{zz}) + \\frac{\\nu}{1-2\\nu} (2)$$\n我们要在 $e=0$ 处计算该式。在 $e=0$ 时，估计的泊松比 $\\nu$ 必须等于第2部分中计算的真实值，我们将其表示为 $\\nu_0 = 23/48$。\n$$0 = \\frac{1}{(1-2\\nu_0)^2} \\left.\\frac{d\\nu}{de}\\right|_{e=0} (\\epsilon_{zz}) + \\frac{2\\nu_0}{1-2\\nu_0}$$\n求解导数：\n$$\\frac{1}{(1-2\\nu_0)^2} \\left.\\frac{d\\nu}{de}\\right|_{e=0} \\epsilon_{zz} = -\\frac{2\\nu_0}{1-2\\nu_0}$$\n$$\\left.\\frac{d\\nu}{de}\\right|_{e=0} = -\\frac{2\\nu_0}{1-2\\nu_0} \\cdot (1-2\\nu_0)^2 \\cdot \\frac{1}{\\epsilon_{zz}}$$\n$$\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\frac{-2\\nu_0(1-2\\nu_0)}{\\epsilon_{zz}}$$\n我们有 $\\nu_0 = 23/48$ 和 $\\epsilon_{zz} = -0.010$。\n首先，计算 $1-2\\nu_0$：\n$$1 - 2\\nu_0 = 1 - 2\\left(\\frac{23}{48}\\right) = 1 - \\frac{23}{24} = \\frac{1}{24}$$\n现在，将这些值代入导数表达式中：\n$$\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = \\frac{-2 \\left(\\frac{23}{48}\\right) \\left(\\frac{1}{24}\\right)}{-0.010} = \\frac{2 \\cdot \\frac{23}{48 \\cdot 24}}{0.01} = \\frac{\\frac{46}{1152}}{\\frac{1}{100}} = \\frac{4600}{1152}$$\n化简分数：\n$$\\frac{4600}{1152} = \\frac{2300}{576} = \\frac{1150}{288} = \\frac{575}{144}$$\n写成小数形式，这大约是 $3.993055...$。\n\n**最终答案摘要：**\n\n问题要求以行向量的形式报告三个计算值，并四舍五入到四位有效数字。\n1.  $\\mu = 9.00 \\, \\text{kPa}$。四舍五入到四位有效数字，为 $9.000 \\, \\text{kPa}$。\n2.  $\\nu = 23/48 \\approx 0.479166...$。四舍五入到四位有效数字，为 $0.4792$。\n3.  $\\left.\\frac{\\partial \\nu}{\\partial \\epsilon_{xx}}\\right|_{e=0} = 575/144 \\approx 3.993055...$。四舍五入到四位有效数字，为 $3.993$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n9.000 & 0.4792 & 3.993\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基本原理之后，这项练习将探讨准静态应变弹性成像的一个关键局限性：对比度模糊伪影。在这个动手编程问题中，你将展示力学边界条件如何导致软性包体呈现伪影性的“硬化”现象，这是临床判读中的一个常见陷阱。通过将其与剪切波弹性成像的结果进行比较，你将理解为何后者在定量硬度评估中通常更为可靠 。",
            "id": "4940413",
            "problem": "给定一个合成的一维分层弹性介质，用于在软夹杂物位于硬表层壳下方时，探究超声弹性成像 (UE) 中的对比度模糊性问题。您的目标是构建一个定量演示，在该演示中，表观应变对比度在特定边界条件下会反转其符号，然后设计能够恢复正确对比度符号的边界条件。在小形变、线性、各向同性弹性理论框架下，并使用第一性原理进行分析。\n\n从以下基础出发：\n- 令 $E$ 表示杨氏模量，$\\nu$ 表示泊松比，$\\mu$ 表示剪切模量，$\\rho$ 表示质量密度，$\\boldsymbol{\\sigma}$ 表示柯西应力，$\\boldsymbol{\\epsilon}$ 表示应变。对于各向同性线弹性，使用胡克定律的形式 $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I}$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，并使用 $(E,\\nu)$ 和 $(\\lambda,\\mu)$ 之间的已知关系。\n- 对于剪切波，使用剪切波速公式 $c_s = \\sqrt{\\mu / \\rho}$。\n\n考虑一个沿轴向 $z$ 串联的两层堆叠结构：一个顶部的硬壳层，其参数为 $(E_h,\\nu_h,\\rho_h)$，以及一个更深的软夹杂物，其参数为 $(E_s,\\nu_s,\\rho_s)$。在顶表面施加一个均匀的压缩压力 $p$，从而在各处产生轴向应力 $\\sigma_z = p$（串联静态平衡）。假设两层的横截面积相等，并忽略体力。\n\n定义了两种测量边界条件模式：\n1. 自由模式 (Mode Free)（平面应力，侧向无应力）：侧向应力消失，各处均有 $\\sigma_x = \\sigma_y = 0$。\n2. 约束模式 (Mode Constrained)（混合模式）：表层壳保持平面应力状态（$\\sigma_x = \\sigma_y = 0$），而软夹杂物则受到侧向约束（平面应变），在夹杂物中有 $\\epsilon_x = \\epsilon_y = 0$。\n\n您的程序必须对每个测试用例，仅基于上述基础执行以下步骤：\n1. 从 $E$、$\\nu$ 和 $\\mu$ 之间的定义和关系出发，根据胡克定律和各向同性假设，推导出在自由模式和约束模式下各层中的轴向应变 $\\epsilon_z$。\n2. 在平面应力解释下，将朴素表观模量定义为 $E_{\\text{app}} = p / \\epsilon_z$，适用于任何测得的轴向应变 $\\epsilon_z$（这模拟了在平面应力假设下将应变图像解释为与刚度成反比的情况）。\n3. 在约束模式下，将硬壳层的测量视为平面应力（与其边界条件一致），将软夹杂物的测量视为平面应变（与其边界条件一致）。相应地计算 $E_{\\text{app},h}$ 和 $E_{\\text{app},s}$，并以布尔值形式确定模糊性：如果朴素分类会将夹杂物标记为比壳层更硬，即当真实情况为 $E_s  E_h$ 时，却有 $E_{\\text{app},s} > E_{\\text{app},h}$，则 ambiguous 为 true。\n4. 在自由模式下，两层均处于平面应力状态。计算 $E_{\\text{app},h}$ 和 $E_{\\text{app},s}$，并以布尔值形式报告此边界条件是否解决了对比度符号问题：只要 $E_s  E_h$，就有 $E_{\\text{app},s}  E_{\\text{app},h}$，则 resolved 为 true。\n5. 独立地，计算各层中的剪切波速 $c_{s,h} = \\sqrt{\\mu_h / \\rho_h}$ 和 $c_{s,s} = \\sqrt{\\mu_s / \\rho_s}$，其中 $\\mu = E/(2(1+\\nu))$，以展示一种对边界条件不敏感的对比度模态（剪切波弹性成像 (SWE)）。报告一个整数 shear_sign，定义为：如果 $c_{s,h} > c_{s,s}$，则为 $+1$，否则为 $-1$。\n\n所有输入均以其指定的物理单位表示，并以数值方式计算输出：\n- 杨氏模量 $E_h$, $E_s$ 单位为千帕 ($\\text{kPa}$)。\n- 压力 $p$ 单位为千帕 ($\\text{kPa}$)。\n- 密度 $\\rho_h$, $\\rho_s$ 单位为千克/立方米 ($\\text{kg/m}^3$)。\n- 泊松比 $\\nu_h$, $\\nu_s$ 为无量纲。\n- 轴向应变 $\\epsilon_z$ 为无量纲。\n- 剪切波速 $c_s$ 单位为米/秒 ($\\text{m/s}$)，但您仅需按所述进行符号比较。\n\n测试套件：\n- 案例1（理想路径模糊性）：$E_h = 100\\,\\text{kPa}$，$E_s = 10\\,\\text{kPa}$，$\\nu_h = 0.49$，$\\nu_s = 0.49$，$\\rho_h = 1000\\,\\text{kg/m}^3$，$\\rho_s = 1000\\,\\text{kg/m}^3$，$p = 2\\,\\text{kPa}$。\n- 案例2（边界条件边缘，更具可压缩性）：$E_h = 100\\,\\text{kPa}$，$E_s = 10\\,\\text{kPa}$，$\\nu_h = 0.30$，$\\nu_s = 0.30$，$\\rho_h = 1000\\,\\text{kg/m}^3$，$\\rho_s = 1000\\,\\text{kg/m}^3$，$p = 2\\,\\text{kPa}$。\n- 案例3（近模量边界，类不可压缩）：$E_h = 12\\,\\text{kPa}$，$E_s = 10\\,\\text{kPa}$，$\\nu_h = 0.49$，$\\nu_s = 0.49$，$\\rho_h = 1000\\,\\text{kg/m}^3$，$\\rho_s = 1000\\,\\text{kg/m}^3$，$p = 1\\,\\text{kPa}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个逗号分隔的列表，其中包含多个三元素列表，每个测试用例一个，并用方括号括起来。每个内部列表的形式必须为 $[\\text{ambiguous}, \\text{resolved}, \\text{shear\\_sign}]$，其中 ambiguous 和 resolved 是布尔值，shear_sign 是整数。例如，对于两个案例，输出应类似于 $[[\\text{True},\\text{False},1],[\\text{False},\\text{True},-1]]$。",
            "solution": "该问题被认为是有效的，因为它科学地基于线弹性原理，是适定的、客观的，并且在正压缩约定的合理解释下内部一致。\n\n分析过程从连续介质力学的第一性原理出发，推导不同边界条件下的轴向应变。我们考虑一个两层介质，一个硬的表层壳 (h) 和一个软的深层夹杂物 (s)，处于均匀的轴向压缩应力 $\\sigma_z = p$ 下。我们采用压缩应力和应变为正的约定。所有材料属性均被假定为各向同性和线弹性的。\n\n基本本构关系是胡克定律，用柯西应力张量 $\\boldsymbol{\\sigma}$ 和无穷小应变张量 $\\boldsymbol{\\epsilon}$ 表示为：\n$$ \\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\epsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\epsilon}) \\mathbf{I} $$\n其中 $\\mu$ 是剪切模量，$\\lambda$ 是第一拉梅参数，$\\operatorname{tr}(\\cdot)$ 是迹算子，$\\mathbf{I}$ 是单位张量。弹性参数 $(\\lambda, \\mu)$ 通过以下公式与杨氏模量 $E$ 和泊松比 $\\nu$ 相关联：\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\n胡克定律的逆形式，即用应力表示应变，通常更为方便：\n$$ \\epsilon_{ij} = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_{ij} - \\nu \\operatorname{tr}(\\boldsymbol{\\sigma}) \\delta_{ij} \\right] $$\n其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n**1. 轴向应变 $\\epsilon_z$ 的推导**\n\n我们针对两种指定的边界条件模式推导轴向应变 $\\epsilon_z$。\n\n**自由模式 (Mode Free)（平面应力）：**\n此条件定义为 $\\sigma_x = \\sigma_y = 0$。在“自由模式”情况下，它应用于两层；在“约束模式”情况下，它应用于硬壳层。对轴向分量 $\\epsilon_z = \\epsilon_{zz}$ 使用逆胡克定律：\n$$ \\epsilon_z = \\frac{1}{E} \\left[ (1+\\nu)\\sigma_z - \\nu (\\sigma_x + \\sigma_y + \\sigma_z) \\right] $$\n代入 $\\sigma_x = 0$、$\\sigma_y = 0$ 以及施加的轴向应力 $\\sigma_z = p$：\n$$ \\epsilon_{z, \\text{stress}} = \\frac{1}{E} \\left[ (1+\\nu)p - \\nu (0 + 0 + p) \\right] = \\frac{1}{E} [p + \\nu p - \\nu p] = \\frac{p}{E} $$\n因此，对于任何处于平面应力条件下的层，轴向应变就是 $\\epsilon_z = p/E$。\n\n**约束模式 (Mode Constrained)（夹杂物中的平面应变）：**\n此条件定义为 $\\epsilon_x = \\epsilon_y = 0$，并应用于“约束模式”下的软夹杂物。我们使用原始形式的胡克定律。轴向应力分量 $\\sigma_z$ 为：\n$$ \\sigma_z = \\lambda(\\epsilon_x + \\epsilon_y + \\epsilon_z) + 2\\mu\\epsilon_z $$\n代入 $\\epsilon_x = 0$ 和 $\\epsilon_y = 0$：\n$$ \\sigma_z = \\lambda \\epsilon_z + 2\\mu \\epsilon_z = (\\lambda + 2\\mu) \\epsilon_z $$\n给定 $\\sigma_z = p$，轴向应变为：\n$$ \\epsilon_{z, \\text{strain}} = \\frac{p}{\\lambda + 2\\mu} $$\n量 $M = \\lambda + 2\\mu$ 是纵波模量或P波模量。我们用 $E$ 和 $\\nu$ 来表示它：\n$$ M = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + 2 \\frac{E}{2(1+\\nu)} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} $$\n$$ M = \\frac{E}{1+\\nu} \\left( \\frac{\\nu}{1-2\\nu} + 1 \\right) = \\frac{E}{1+\\nu} \\left( \\frac{\\nu + 1 - 2\\nu}{1-2\\nu} \\right) = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\n因此，对于处于平面应变状态的层，轴向应变为：\n$$ \\epsilon_{z, \\text{strain}} = p \\frac{(1+\\nu)(1-2\\nu)}{E(1-\\nu)} $$\n\n**2. 表观模量和对比度模糊性（约束模式）**\n\n问题将“朴素表观模量”定义为 $E_{\\text{app}} = p / \\epsilon_z$。这模拟了一种成像场景，其中所有测得的应变都通过简单的平面应力关系 $E = p/\\epsilon_z$ 来解释。\n\n在“约束模式”下：\n- 硬壳层处于平面应力状态，因此 $\\epsilon_{z,h} = p/E_h$。表观模量为 $E_{\\text{app},h} = p / \\epsilon_{z,h} = E_h$。朴素测量是正确的。\n- 软夹杂物处于平面应变状态，因此 $\\epsilon_{z,s} = p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}$。朴素表观模量为：\n  $$ E_{\\text{app},s} = \\frac{p}{\\epsilon_{z,s}} = \\frac{p}{p \\frac{(1+\\nu_s)(1-2\\nu_s)}{E_s(1-\\nu_s)}} = E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} $$\n当测得的软夹杂物比硬壳层更硬，即 $E_{\\text{app},s} > E_{\\text{app},h}$，尽管真实情况是 $E_s  E_h$ 时，就会出现模糊性或对比度反转。出现模糊性的条件是：\n$$ E_s \\frac{1-\\nu_s}{(1+\\nu_s)(1-2\\nu_s)} > E_h $$\n这个不等式表明，模糊性高度依赖于泊松比 $\\nu_s$。当 $\\nu_s$ 接近 0.5（不可压缩极限）时，分母 $(1-2\\nu_s)$ 趋近于零，导致 $E_{\\text{app},s}$ 变得非常大，即使 $E_s$ 远小于 $E_h$，它也可能轻易超过 $E_h$。\n\n**3. 对比度解决（自由模式）**\n\n在“自由模式”下，两层均处于平面应力状态。\n- 硬壳层：$\\epsilon_{z,h} = p/E_h$，所以 $E_{\\text{app},h} = p/\\epsilon_{z,h} = E_h$。\n- 软夹杂物：$\\epsilon_{z,s} = p/E_s$，所以 $E_{\\text{app},s} = p/\\epsilon_{z,s} = E_s$。\n在此模式下，表观模量等于真实的杨氏模量。“解决”条件是在真实情况为 $E_s  E_h$ 时，有 $E_{\\text{app},s}  E_{\\text{app},h}$。这可以简化为 $E_s  E_h$，根据构造这是成立的。因此，平面应力边界条件正确地反映了刚度对比度。\n\n**4. 剪切波弹性成像 (SWE)**\n\nSWE 提供了一种独立于压缩边界条件的刚度测量方法。它测量剪切波速 $c_s = \\sqrt{\\mu/\\rho}$。剪切模量 $\\mu$ 与 $E$ 和 $\\nu$ 的关系为 $\\mu = E/(2(1+\\nu))$。\n- 硬壳层：$c_{s,h} = \\sqrt{\\frac{\\mu_h}{\\rho_h}} = \\sqrt{\\frac{E_h}{2(1+\\nu_h)\\rho_h}}$。\n- 软夹杂物：$c_{s,s} = \\sqrt{\\frac{\\mu_s}{\\rho_s}} = \\sqrt{\\frac{E_s}{2(1+\\nu_s)\\rho_s}}$。\n刚度对比度的符号通过比较 $c_{s,h}$ 和 $c_{s,s}$ 来确定。如果 $c_{s,h} > c_{s,s}$，则 `shear_sign` 为 $+1$，否则为 $-1$。这种比较等同于检查 $(\\mu_h/\\rho_h) - (\\mu_s/\\rho_s)$ 的符号。由于剪切特性仅取决于 $\\mu$ 和 $\\rho$，它们不受轴向加载条件（$\\sigma_z, \\epsilon_x, \\epsilon_y$）的影响。\n\n现在将这个全面的理论框架应用于具体的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ultrasound elastography contrast ambiguity problem\n    for the given test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Eh, Es, nu_h, nu_s, rho_h, rho_s, p)\n    # Units: E in kPa, rho in kg/m^3, p in kPa, nu is dimensionless.\n    test_cases = [\n        (100.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 2.0),\n        (100.0, 10.0, 0.30, 0.30, 1000.0, 1000.0, 2.0),\n        (12.0, 10.0, 0.49, 0.49, 1000.0, 1000.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Eh, Es, nu_h, nu_s, rho_h, rho_s, p = case\n        \n        # Ground truth: The soft inclusion is indeed softer than the hard shell.\n        ground_truth_softness = Es  Eh\n\n        # --- Task 3: Mode Constrained Analysis ---\n        \n        # The hard shell is in plane stress. Its naive apparent modulus measurement\n        # is correct and equals its true Young's modulus.\n        E_app_h_constrained = Eh\n        \n        # The soft inclusion is in plane strain, but its strain is naively interpreted\n        # using the plane stress formula E_app = p / epsilon_z.\n        # From first principles, the axial strain in plane strain is:\n        # epsilon_z_s = p * (1+nu_s)(1-2*nu_s) / (Es * (1-nu_s))\n        # The naive apparent modulus is therefore:\n        # E_app_s = p / epsilon_z_s = Es * (1-nu_s) / ((1+nu_s)*(1-2*nu_s))\n        \n        # Handle the near-incompressible case to avoid division by zero.\n        if nu_s >= 0.5:\n            # For a perfectly incompressible material (nu=0.5), a plane strain\n            # compression is impossible, and the apparent modulus is infinite.\n            E_app_s_constrained = float('inf')\n        else:\n            E_app_s_constrained = Es * (1.0 - nu_s) / ((1.0 + nu_s) * (1.0 - 2.0 * nu_s))\n        \n        # Ambiguity is true if the naive measurement makes the soft layer appear harder,\n        # reversing the true stiffness contrast.\n        ambiguous = (E_app_s_constrained > E_app_h_constrained) and ground_truth_softness\n\n        # --- Task 4: Mode Free Analysis ---\n        \n        # In this mode, both layers are in plane stress. The naive apparent modulus\n        # measurement is correct for both.\n        E_app_h_free = Eh\n        E_app_s_free = Es\n        \n        # Resolved is true if the measurement correctly shows the soft layer is softer.\n        resolved = (E_app_s_free  E_app_h_free) and ground_truth_softness\n        \n        # --- Task 5: Shear Wave Elastography Analysis ---\n        \n        # Shear modulus is defined as mu = E / (2*(1+nu)).\n        mu_h = Eh / (2.0 * (1.0 + nu_h))\n        mu_s = Es / (2.0 * (1.0 + nu_s))\n        \n        # Shear wave speed squared is proportional to mu/rho. We only need to compare\n        # this ratio. Unit conversions for E (kPa to Pa) cancel out.\n        cs_sq_h = mu_h / rho_h\n        cs_sq_s = mu_s / rho_s\n        \n        # The shear_sign indicates the stiffness contrast measured by SWE.\n        shear_sign = 1 if cs_sq_h > cs_sq_s else -1\n        \n        results.append([ambiguous, resolved, shear_sign])\n\n    # Final print statement must produce the single-line format specified.\n    # The str() of a Python list is '[item1, item2, ...]' which matches the required\n    # inner list format. The f-string constructs the final outer list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在明确了剪切波弹性成像的可靠性之后，我们最后的练习将转向数据采集本身的实际设计。这个问题解决了一个关键挑战：如何在空间和时间上对传播的波场进行采样，而又不引入可能破坏测量的混叠伪影。通过应用奈奎斯特-香农采样定理 (Nyquist-Shannon sampling theorem)，你将确定一个采集系统的操作极限，这是开发和使用任何定量成像方法的核心技能 。",
            "id": "4940377",
            "problem": "需要设计一种二维剪切波弹性成像采集方案，该方案采用超快接收波束形成策略，每帧单次发射。接收聚焦使用系统指定的$F$数，并且成像系统在给定的脉冲重复频率（PRF）下运行。视场在横向上跨度为$W_x = 40\\,\\text{mm}$，在升降向上跨度为$W_y = 40\\,\\text{mm}$，中心位于焦深处，在该深度两个轴向的$F$数均恒定。假设用于超声跟踪的软组织声速为$c_{\\mathrm{us}} = 1540\\,\\text{m/s}$，中心超声频率为$f_{\\mathrm{us}} = 5\\,\\text{MHz}$。接收$F$数为$F = 1.5$。组织中的剪切波速度为$c_s = 3.2\\,\\text{m/s}$。脉冲重复频率（PRF）为$\\mathrm{PRF} = 12\\,\\text{kHz}$，每帧使用单次发射，因此帧率等于PRF。假设接收点扩散函数近似各向同性，其半峰全宽可建模为$w \\approx \\alpha F \\lambda_{\\mathrm{us}}$，其中$\\alpha = 1.02$，$\\lambda_{\\mathrm{us}} = c_{\\mathrm{us}}/f_{\\mathrm{us}}$，并且空间采样网格的间距选择为$\\Delta_x = \\Delta_y = w/2$。从空间和时间上的采样定理以及剪切波色散关系出发，确定在此次采集中能够捕获而不會产生空间或时间混叠的最大剪切波时间频率$f_{s,\\max}$。以$\\text{Hz}$为单位表示您的最终答案，并将答案四舍五入至四位有效数字。",
            "solution": "用户希望确定在剪切波弹性成像采集中可以无混叠测量的最大剪切波时间频率$f_{s,\\max}$。这需要在时间和空间域上都满足奈奎斯特-香农采样定理。最大无混叠频率将是时间采样和空间采样所施加限制中的较小者。\n\n**问题验证**\n\n**步骤 1：提取给定条件**\n- 横向视场：$W_x = 40\\,\\text{mm}$\n- 升降向视场：$W_y = 40\\,\\text{mm}$\n- 组织中超声声速：$c_{\\mathrm{us}} = 1540\\,\\text{m/s}$\n- 中心超声频率：$f_{\\mathrm{us}} = 5\\,\\text{MHz}$\n- 接收F数：$F = 1.5$\n- 剪切波速度：$c_s = 3.2\\,\\text{m/s}$\n- 脉冲重复频率：$\\mathrm{PRF} = 12\\,\\text{kHz}$\n- 帧率等于PRF。\n- 接收点扩散函数（PSF）半峰全宽（FWHM）模型：$w \\approx \\alpha F \\lambda_{\\mathrm{us}}$\n- PSF模型常数：$\\alpha = 1.02$\n- 超声波长定义：$\\lambda_{\\mathrm{us}} = c_{\\mathrm{us}}/f_{\\mathrm{us}}$\n- 空间采样网格间距：$\\Delta_x = \\Delta_y = w/2$\n\n**步骤 2：使用提取的给定条件进行验证**\n该问题在科学上基于应用于医学成像（超声弹性成像）的波物理和信号处理原理。所有给定的值（$c_{\\mathrm{us}}$，$c_s$，$f_{\\mathrm{us}}$，$F$，PRF）在此背景下都是物理上合理的。问题提得很好，客观，并包含足够的信息来确定唯一的答案。该问题要求将基本定理（采样定理、色散关系）应用于一个实际场景。关于视场尺寸（$W_x$，$W_y$）的信息与受采样限制的最大频率的计算无关，但不会使问题无效。该问题被认为是有效的。\n\n**求解推导**\n\n为避免混叠，采样率必须至少是信号中存在的最大频率的两倍。此原理独立地适用于时间域和空间域。\n\n**1. 时间采样约束**\n剪切波现象在时间上以成像帧率进行采样。问题陈述每帧使用单次发射，因此帧率等于脉冲重复频率（PRF）。\n时间采样频率为$f_{\\text{sample,t}} = \\mathrm{PRF}$。\n根据奈奎斯特定理，可以无时间混叠测量的剪切波最大时间频率$f_s$是采样频率的一半。\n设此限制为$f_{s,\\text{temp}}$。\n$$f_{s,\\text{temp}} = \\frac{\\mathrm{PRF}}{2}$$\n给定 $\\mathrm{PRF} = 12\\,\\text{kHz} = 12 \\times 10^3\\,\\text{Hz}$：\n$$f_{s,\\text{temp}} = \\frac{12 \\times 10^3\\,\\text{Hz}}{2} = 6 \\times 10^3\\,\\text{Hz}$$\n\n**2. 空间采样约束**\n剪切波是在离散网格上采样的空间传播波。此网格上的采样间隔决定了可以无空间混叠测量的最大空间频率（或波数）。\n\n首先，我们确定空间采样间隔，$\\Delta = \\Delta_x = \\Delta_y$。该间隔是根据超声点扩散函数$w$的宽度定义的。\n超声波长$\\lambda_{\\mathrm{us}}$为：\n$$\\lambda_{\\mathrm{us}} = \\frac{c_{\\mathrm{us}}}{f_{\\mathrm{us}}} = \\frac{1540\\,\\text{m/s}}{5 \\times 10^6\\,\\text{Hz}} = 3.08 \\times 10^{-4}\\,\\text{m}$$\nPSF的宽度$w$由下式给出：\n$$w = \\alpha F \\lambda_{\\mathrm{us}} = (1.02)(1.5)(3.08 \\times 10^{-4}\\,\\text{m}) = 4.7124 \\times 10^{-4}\\,\\text{m}$$\n空间采样间隔$\\Delta$是此宽度的一半：\n$$\\Delta = \\frac{w}{2} = \\frac{4.7124 \\times 10^{-4}\\,\\text{m}}{2} = 2.3562 \\times 10^{-4}\\,\\text{m}$$\n空间域中的奈奎斯特定理指出，可以明确表示的最大空间频率分量$k_{\\max}$受采样间隔$\\Delta$的限制。对于在两个维度上间距均为$\\Delta$的二维网格，沿每个轴的最高波数分量为$k_{x,\\max} = \\pi/\\Delta$和$k_{y,\\max} = \\pi/\\Delta$。为确保在任何方向传播的波都能被无混叠地捕获，我们必须考虑最限制性的情况，这对应于奈奎斯特支持域内能容纳的最大波数。对于各向同性系统，一种保守且标准的方法是受轴上传播的限制，因此最大波数大小$k_{s,\\max}$为：\n$$k_{s,\\max} = \\frac{\\pi}{\\Delta}$$\n问题假设剪切波速度$c_s$是恒定的，这意味着时间角频率$\\omega_s = 2\\pi f_s$和空间波数$k_s$之间存在线性（非色散）关系：\n$$\\omega_s = c_s k_s$$\n$$2\\pi f_s = c_s k_s \\implies f_s = \\frac{c_s k_s}{2\\pi}$$\n空间采样网格所能支持的最大时间频率$f_{s,\\text{space}}$，可通过将$k_{s,\\max}$代入色散关系得到：\n$$f_{s,\\text{space}} = \\frac{c_s k_{s,\\max}}{2\\pi} = \\frac{c_s}{2\\pi} \\left( \\frac{\\pi}{\\Delta} \\right) = \\frac{c_s}{2\\Delta}$$\n使用给定值：\n$$f_{s,\\text{space}} = \\frac{3.2\\,\\text{m/s}}{2 \\times (2.3562 \\times 10^{-4}\\,\\text{m})} = \\frac{3.2}{4.7124 \\times 10^{-4}}\\,\\text{Hz} \\approx 6790.6\\,\\text{Hz}$$\n\n**3. 总体约束**\n为使剪切波测量没有任何混叠，其频率$f_s$必须同时低于时间和空间限制。\n$$f_s \\leq f_{s,\\text{temp}} \\quad \\text{and} \\quad f_s \\leq f_{s,\\text{space}}$$\n因此，可以无混叠捕获的最大频率$f_{s,\\max}$是这两个限制中的最小值：\n$$f_{s,\\max} = \\min(f_{s,\\text{temp}}, f_{s,\\text{space}})$$\n$$f_{s,\\max} = \\min(6 \\times 10^3\\,\\text{Hz}, 6790.6\\,\\text{Hz})$$\n$$f_{s,\\max} = 6 \\times 10^3\\,\\text{Hz}$$\n此采集设计中的限制因素是时间采样，即帧率。\n\n问题要求将答案四舍五入至四位有效数字。\n$$f_{s,\\max} = 6000\\,\\text{Hz} = 6.000 \\times 10^3\\,\\text{Hz}$$",
            "answer": "$$\n\\boxed{6.000 \\times 10^3}\n$$"
        }
    ]
}