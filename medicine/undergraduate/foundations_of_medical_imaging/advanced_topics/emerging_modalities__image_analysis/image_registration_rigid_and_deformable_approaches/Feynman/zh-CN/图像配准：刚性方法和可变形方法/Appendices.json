{
    "hands_on_practices": [
        {
            "introduction": "医学影像配准的核心在于精确描述和操作不同坐标系之间的空间关系。本练习将通过一个多模态成像的典型场景，引导你动手实践刚性变换的数学基础。你将学习如何使用齐次坐标矩阵来表示旋转和平移，并通过矩阵乘法和求逆来组合与撤销这些变换 ，这是后续所有高级配准技术不可或缺的基本功。",
            "id": "4892855",
            "problem": "在一个多模态研究中，一个刚性图像配准工作流关联了三个右手坐标系之间的坐标：一个计算机断层扫描 (CT) 图像坐标系 $\\mathcal{F}_{\\mathrm{CT}}$、一个患者解剖坐标系 $\\mathcal{F}_{\\mathrm{P}}$ 和一个磁共振成像 (MRI) 坐标系 $\\mathcal{F}_{\\mathrm{MRI}}$。点在齐次坐标中表示为 $4 \\times 1$ 的列向量，其最后一个元素等于 $1$，刚性变换通过左乘作用。按照惯例，一个具有旋转矩阵 $\\mathbf{R} \\in \\mathbb{R}^{3 \\times 3}$ 和平移向量 $\\mathbf{t} \\in \\mathbb{R}^{3}$ 的刚性变换将点 $\\mathbf{x} \\in \\mathbb{R}^{3}$ 映射为 $\\mathbf{x}' = \\mathbf{R}\\,\\mathbf{x} + \\mathbf{t}$，其以齐次形式编码为 $4 \\times 4$ 矩阵\n$$\n\\mathbf{T} = \\begin{pmatrix}\n\\mathbf{R} & \\mathbf{t} \\\\\n\\mathbf{0}^{\\top} & 1\n\\end{pmatrix}.\n$$\n设 $\\mathbf{T}_1$ 表示将坐标从 $\\mathcal{F}_{\\mathrm{CT}}$ 映射到 $\\mathcal{F}_{\\mathrm{P}}$ 的刚性变换，设 $\\mathbf{T}_2$ 表示将坐标从 $\\mathcal{F}_{\\mathrm{P}}$ 映射到 $\\mathcal{F}_{\\mathrm{MRI}}$ 的刚性变换。假设以下物理上合理的设定：\n- $\\mathbf{T}_1$ 绕 $\\mathcal{F}_{\\mathrm{CT}}$ 的 $z$ 轴旋转角度 $\\alpha$，然后平移 $\\mathbf{t}_1 = \\begin{pmatrix} 10 \\\\ -5 \\\\ 2 \\end{pmatrix}$（单位：毫米）。\n- $\\mathbf{T}_2$ 绕 $\\mathcal{F}_{\\mathrm{P}}$ 的 $x$ 轴旋转角度 $\\beta$，然后平移 $\\mathbf{t}_2 = \\begin{pmatrix} -3 \\\\ 4 \\\\ 1 \\end{pmatrix}$（单位：毫米）。\n\n角度必须以弧度处理。从上述基本定义（笛卡尔坐标系中的刚体映射及其齐次嵌入）出发，注意坐标系的一致性，推导出用 $\\alpha$、$\\beta$、$\\mathbf{t}_1$ 和 $\\mathbf{t}_2$ 表示的 $\\mathbf{T}_2 \\mathbf{T}_1$ 的显式 $4 \\times 4$ 矩阵和 $(\\mathbf{T}_2 \\mathbf{T}_1)^{-1}$ 的显式 $4 \\times 4$ 矩阵。然后将结果应用于数值情况 $\\alpha = \\frac{\\pi}{6}$ 和 $\\beta = \\frac{\\pi}{4}$。\n\n最后，计算 $(\\mathbf{T}_2 \\mathbf{T}_1)^{-1}$ 的平移向量的第三个分量，即 $4 \\times 4$ 逆齐次矩阵的第 $(3,4)$ 个元素，并以毫米为单位报告其值。将最终数值答案四舍五入到四位有效数字。按规定以弧度表示角度，以毫米表示距离。",
            "solution": "首先验证问题以确保其是自洽的、有科学依据且良定的。已知条件如下：\n- 三个右手坐标系：$\\mathcal{F}_{\\mathrm{CT}}$、$\\mathcal{F}_{\\mathrm{P}}$、$\\mathcal{F}_{\\mathrm{MRI}}$。\n- 点是 $4 \\times 1$ 的齐次列向量。\n- 刚性变换 $\\mathbf{T}$ 是一个形如 $\\mathbf{T} = \\begin{pmatrix} \\mathbf{R} & \\mathbf{t} \\\\ \\mathbf{0}^{\\top} & 1 \\end{pmatrix}$ 的 $4 \\times 4$ 矩阵。\n- $\\mathbf{T}_1$：将坐标从 $\\mathcal{F}_{\\mathrm{CT}}$ 映射到 $\\mathcal{F}_{\\mathrm{P}}$。它包含一个绕 $\\mathcal{F}_{\\mathrm{CT}}$ 的 $z$ 轴旋转角度 $\\alpha$ 的旋转，然后是一个平移 $\\mathbf{t}_1 = \\begin{pmatrix} 10 \\\\ -5 \\\\ 2 \\end{pmatrix}$。\n- $\\mathbf{T}_2$：将坐标从 $\\mathcal{F}_{\\mathrm{P}}$ 映射到 $\\mathcal{F}_{\\mathrm{MRI}}$。它包含一个绕 $\\mathcal{F}_{\\mathrm{P}}$ 的 $x$ 轴旋转角度 $\\beta$ 的旋转，然后是一个平移 $\\mathbf{t}_2 = \\begin{pmatrix} -3 \\\\ 4 \\\\ 1 \\end{pmatrix}$。\n- 用于特例计算的数值：$\\alpha = \\frac{\\pi}{6}$ 和 $\\beta = \\frac{\\pi}{4}$。\n该问题在科学上是合理的，它基于刚体运动学的基本原理及其在齐次坐标中的表示，这是医学成像和机器人学中的标准做法。该问题是良定的，为求得唯一解提供了所有必要信息。其语言客观而精确。因此，该问题是有效的。\n\n我们开始推导。\n\n首先，我们构建 $\\mathbf{T}_1$ 的矩阵。旋转是绕 $z$ 轴旋转角度 $\\alpha$，所以旋转矩阵 $\\mathbf{R}_1$ 为：\n$$ \\mathbf{R}_1 = \\mathbf{R}_z(\\alpha) = \\begin{pmatrix} \\cos(\\alpha) & -\\sin(\\alpha) & 0 \\\\ \\sin(\\alpha) & \\cos(\\alpha) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n平移向量为 $\\mathbf{t}_1 = \\begin{pmatrix} 10 \\\\ -5 \\\\ 2 \\end{pmatrix}$。齐次变换矩阵 $\\mathbf{T}_1$ 为：\n$$ \\mathbf{T}_1 = \\begin{pmatrix} \\mathbf{R}_1 & \\mathbf{t}_1 \\\\ \\mathbf{0}^{\\top} & 1 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\alpha) & -\\sin(\\alpha) & 0 & 10 \\\\ \\sin(\\alpha) & \\cos(\\alpha) & 0 & -5 \\\\ 0 & 0 & 1 & 2 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\n\n接下来，我们构建 $\\mathbf{T}_2$ 的矩阵。旋转是绕 $x$ 轴旋转角度 $\\beta$，所以旋转矩阵 $\\mathbf{R}_2$ 为：\n$$ \\mathbf{R}_2 = \\mathbf{R}_x(\\beta) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos(\\beta) & -\\sin(\\beta) \\\\ 0 & \\sin(\\beta) & \\cos(\\beta) \\end{pmatrix} $$\n平移向量为 $\\mathbf{t}_2 = \\begin{pmatrix} -3 \\\\ 4 \\\\ 1 \\end{pmatrix}$。齐次变换矩阵 $\\mathbf{T}_2$ 为：\n$$ \\mathbf{T}_2 = \\begin{pmatrix} \\mathbf{R}_2 & \\mathbf{t}_2 \\\\ \\mathbf{0}^{\\top} & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 & -3 \\\\ 0 & \\cos(\\beta) & -\\sin(\\beta) & 4 \\\\ 0 & \\sin(\\beta) & \\cos(\\beta) & 1 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\n\n从 $\\mathcal{F}_{\\mathrm{CT}}$ 到 $\\mathcal{F}_{\\mathrm{MRI}}$ 的总变换是复合变换 $\\mathbf{T}_{\\mathrm{comp}} = \\mathbf{T}_2 \\mathbf{T}_1$。一个点 $\\mathbf{p}_{\\mathrm{CT}}$ 通过 $\\mathbf{p}_{\\mathrm{MRI}} = \\mathbf{T}_2 (\\mathbf{T}_1 \\mathbf{p}_{\\mathrm{CT}}) = (\\mathbf{T}_2 \\mathbf{T}_1) \\mathbf{p}_{\\mathrm{CT}}$ 映射到 $\\mathbf{p}_{\\mathrm{MRI}}$。\n设 $\\mathbf{T}_{\\mathrm{comp}} = \\begin{pmatrix} \\mathbf{R}_{\\mathrm{comp}} & \\mathbf{t}_{\\mathrm{comp}} \\\\ \\mathbf{0}^{\\top} & 1 \\end{pmatrix}$。复合旋转为 $\\mathbf{R}_{\\mathrm{comp}} = \\mathbf{R}_2 \\mathbf{R}_1$，复合平移为 $\\mathbf{t}_{\\mathrm{comp}} = \\mathbf{R}_2 \\mathbf{t}_1 + \\mathbf{t}_2$。\n\n$$ \\mathbf{R}_{\\mathrm{comp}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos(\\beta) & -\\sin(\\beta) \\\\ 0 & \\sin(\\beta) & \\cos(\\beta) \\end{pmatrix} \\begin{pmatrix} \\cos(\\alpha) & -\\sin(\\alpha) & 0 \\\\ \\sin(\\alpha) & \\cos(\\alpha) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\alpha) & -\\sin(\\alpha) & 0 \\\\ \\cos(\\beta)\\sin(\\alpha) & \\cos(\\beta)\\cos(\\alpha) & -\\sin(\\beta) \\\\ \\sin(\\beta)\\sin(\\alpha) & \\sin(\\beta)\\cos(\\alpha) & \\cos(\\beta) \\end{pmatrix} $$\n$$ \\mathbf{t}_{\\mathrm{comp}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos(\\beta) & -\\sin(\\beta) \\\\ 0 & \\sin(\\beta) & \\cos(\\beta) \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -5 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} -3 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ -5\\cos(\\beta) - 2\\sin(\\beta) \\\\ -5\\sin(\\beta) + 2\\cos(\\beta) \\end{pmatrix} + \\begin{pmatrix} -3 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 7 \\\\ 4-5\\cos(\\beta)-2\\sin(\\beta) \\\\ 1-5\\sin(\\beta)+2\\cos(\\beta) \\end{pmatrix} $$\n$\\mathbf{T}_2 \\mathbf{T}_1$ 的显式矩阵为：\n$$ \\mathbf{T}_2 \\mathbf{T}_1 = \\begin{pmatrix} \\cos(\\alpha) & -\\sin(\\alpha) & 0 & 7 \\\\ \\cos(\\beta)\\sin(\\alpha) & \\cos(\\beta)\\cos(\\alpha) & -\\sin(\\beta) & 4-5\\cos(\\beta)-2\\sin(\\beta) \\\\ \\sin(\\beta)\\sin(\\alpha) & \\sin(\\beta)\\cos(\\alpha) & \\cos(\\beta) & 1-5\\sin(\\beta)+2\\cos(\\beta) \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\n\n接下来，我们推导逆变换 $(\\mathbf{T}_2 \\mathbf{T}_1)^{-1}$。一个齐次变换 $\\mathbf{T} = \\begin{pmatrix} \\mathbf{R} & \\mathbf{t} \\\\ \\mathbf{0}^{\\top} & 1 \\end{pmatrix}$ 的逆为 $\\mathbf{T}^{-1} = \\begin{pmatrix} \\mathbf{R}^{\\top} & -\\mathbf{R}^{\\top}\\mathbf{t} \\\\ \\mathbf{0}^{\\top} & 1 \\end{pmatrix}$。\n对于 $\\mathbf{T}_{\\mathrm{comp}} = \\mathbf{T}_2 \\mathbf{T}_1$，其逆旋转为 $\\mathbf{R}_{\\mathrm{inv}} = \\mathbf{R}_{\\mathrm{comp}}^{\\top} = (\\mathbf{R}_2 \\mathbf{R}_1)^{\\top} = \\mathbf{R}_1^{\\top} \\mathbf{R}_2^{\\top}$。\n$$ \\mathbf{R}_{\\mathrm{inv}} = \\begin{pmatrix} \\cos(\\alpha) & \\sin(\\alpha) & 0 \\\\ -\\sin(\\alpha) & \\cos(\\alpha) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos(\\beta) & \\sin(\\beta) \\\\ 0 & -\\sin(\\beta) & \\cos(\\beta) \\end{pmatrix} = \\begin{pmatrix} \\cos(\\alpha) & \\sin(\\alpha)\\cos(\\beta) & \\sin(\\alpha)\\sin(\\beta) \\\\ -\\sin(\\alpha) & \\cos(\\alpha)\\cos(\\beta) & \\cos(\\alpha)\\sin(\\beta) \\\\ 0 & -\\sin(\\beta) & \\cos(\\beta) \\end{pmatrix} $$\n逆平移为 $\\mathbf{t}_{\\mathrm{inv}} = -\\mathbf{R}_{\\mathrm{inv}}\\mathbf{t}_{\\mathrm{comp}} = -(\\mathbf{R}_1^{\\top}\\mathbf{R}_2^{\\top})(\\mathbf{R}_2 \\mathbf{t}_1 + \\mathbf{t}_2) = -\\mathbf{R}_1^{\\top}(\\mathbf{t}_1 + \\mathbf{R}_2^{\\top}\\mathbf{t}_2)$，因为 $\\mathbf{R}_2^{\\top}\\mathbf{R}_2 = \\mathbf{I}$。\n我们来计算向量 $\\mathbf{v} = \\mathbf{t}_1 + \\mathbf{R}_2^{\\top}\\mathbf{t}_2$：\n$$ \\mathbf{R}_2^{\\top}\\mathbf{t}_2 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\cos(\\beta) & \\sin(\\beta) \\\\ 0 & -\\sin(\\beta) & \\cos(\\beta) \\end{pmatrix} \\begin{pmatrix} -3 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 4\\cos(\\beta)+\\sin(\\beta) \\\\ -4\\sin(\\beta)+\\cos(\\beta) \\end{pmatrix} $$\n$$ \\mathbf{v} = \\begin{pmatrix} 10 \\\\ -5 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} -3 \\\\ 4\\cos(\\beta)+\\sin(\\beta) \\\\ -4\\sin(\\beta)+\\cos(\\beta) \\end{pmatrix} = \\begin{pmatrix} 7 \\\\ -5+4\\cos(\\beta)+\\sin(\\beta) \\\\ 2-4\\sin(\\beta)+\\cos(\\beta) \\end{pmatrix} $$\n现在，$\\mathbf{t}_{\\mathrm{inv}} = -\\mathbf{R}_1^{\\top}\\mathbf{v}$：\n$$ \\mathbf{t}_{\\mathrm{inv}} = - \\begin{pmatrix} \\cos(\\alpha) & \\sin(\\alpha) & 0 \\\\ -\\sin(\\alpha) & \\cos(\\alpha) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\mathbf{v} = - \\begin{pmatrix} v_1\\cos(\\alpha) + v_2\\sin(\\alpha) \\\\ -v_1\\sin(\\alpha) + v_2\\cos(\\alpha) \\\\ v_3 \\end{pmatrix} $$\n逆变换的平移向量的第三个分量就是 $-v_3$：\n$$ (\\mathbf{t}_{\\mathrm{inv}})_3 = -v_3 = -(2 - 4\\sin(\\beta) + \\cos(\\beta)) = -2 + 4\\sin(\\beta) - \\cos(\\beta) $$\n完整的逆矩阵 $(\\mathbf{T}_2 \\mathbf{T}_1)^{-1}$ 可以通过将 $\\mathbf{R}_{\\mathrm{inv}}$ 和 $\\mathbf{t}_{\\mathrm{inv}}$ 放入齐次矩阵形式来构建，但我们只需要第 $(3,4)$ 个元素，即 $(\\mathbf{t}_{\\mathrm{inv}})_3$。\n\n我们现在将结果应用于情况 $\\alpha = \\frac{\\pi}{6}$ 和 $\\beta = \\frac{\\pi}{4}$。所求值仅取决于 $\\beta$。\n$$ (\\mathbf{t}_{\\mathrm{inv}})_3 = -2 + 4\\sin\\left(\\frac{\\pi}{4}\\right) - \\cos\\left(\\frac{\\pi}{4}\\right) $$\n使用 $\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$ 和 $\\cos(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$：\n$$ (\\mathbf{t}_{\\mathrm{inv}})_3 = -2 + 4\\left(\\frac{\\sqrt{2}}{2}\\right) - \\frac{\\sqrt{2}}{2} = -2 + 2\\sqrt{2} - \\frac{1}{2}\\sqrt{2} = -2 + \\frac{3}{2}\\sqrt{2} $$\n为了求出数值，我们使用 $\\sqrt{2} \\approx 1.41421356...$：\n$$ (\\mathbf{t}_{\\mathrm{inv}})_3 \\approx -2 + \\frac{3}{2}(1.41421356) = -2 + 2.12132034 = 0.12132034 $$\n四舍五入到四位有效数字，我们得到 $0.1213$。单位是毫米。",
            "answer": "$$\\boxed{0.1213}$$"
        },
        {
            "introduction": "与保持形状不变的刚性配准不同，可变形配准允许图像发生局部拉伸、压缩甚至折叠。本练习将带你初步探索一种强大的可变形模型——基于B样条的自由形式形变（FFD）。通过计算变换在某一点的雅可比行列式，你将学会一种判断形变场是否在局部“发生折叠”的关键方法 ，从而理解保证可变形配准物理有效性的核心挑战之一。",
            "id": "4892868",
            "problem": "考虑一个用于图像配准的、基于张量积三次B样条的二维自由形式形变 (FFD)。令空间变换定义为一个叠加在单位映射上的位移场，其中形变后的位置由 $\\mathbf{T}(x,y) = (x,y) + \\mathbf{u}(x,y)$ 给出。该位移场是使用张量积三次B样条基函数，从一个间距为 $h$ 的均匀控制网格构建的。在任何网格单元内，引入参数坐标 $s \\in [0,1]$ 和 $t \\in [0,1]$，并令局部（local）位移为 $\\mathbf{u}(x,y) = \\sum_{p=0}^{3} \\sum_{q=0}^{3} B_{p}(s) B_{q}(t) \\,\\mathbf{d}_{p,q}$，其中 $\\mathbf{d}_{p,q} = (d^{x}_{p,q}, d^{y}_{p,q})$ 是控制点位移。\n\n在 $[0,1]$ 上的三次B样条基函数定义如下：\n$$\nB_{0}(r) = \\frac{(1-r)^{3}}{6}, \\quad\nB_{1}(r) = \\frac{3r^{3} - 6r^{2} + 4}{6}, \\quad\nB_{2}(r) = \\frac{-3r^{3} + 3r^{2} + 3r + 1}{6}, \\quad\nB_{3}(r) = \\frac{r^{3}}{6},\n$$\n对于任意标量参数 $r \\in [0,1]$。\n\n假设在影响评估点的 $4 \\times 4$ 邻域内只有一个非零的控制位移：具体来说，$\\mathbf{d}_{1,2} = (a,b)$，其中 $a = 2$ mm 且 $b = -1$ mm，而所有其他的 $\\mathbf{d}_{p,q} = (0,0)$。控制网格间距为 $h = 20$ mm。在单元中心进行评估，其中 $s = 0.5$ 且 $t = 0.5$。\n\n从上述定义和基础的多元微积分（链式法则）出发，计算评估点处的雅可比行列式 $J(x,y) = \\det\\!\\left(\\nabla \\mathbf{T}(x,y)\\right)$。然后，通过检查 $J(x,y)$ 的符号来判断该映射是否局部可逆。将雅可比行列式的最终答案表示为一个单一的精确值（无量纲）。无需四舍五入。",
            "solution": "用户希望计算自由形式形变 (FFD) 变换的雅可比行列式，并评估其在特定点上的局部可逆性。\n\n### 第一步：提取已知条件\n-   **空间变换**：变换 $\\mathbf{T}(x,y)$ 将点 $(x,y)$ 映射到一个新位置，并定义为单位映射与位移场 $\\mathbf{u}(x,y)$ 之和：\n    $$ \\mathbf{T}(x,y) = (x,y) + \\mathbf{u}(x,y) $$\n-   **位移场**：位移场 $\\mathbf{u}(x,y)$ 由一个控制点网格通过张量积三次B样条基函数进行参数化：\n    $$ \\mathbf{u}(x,y) = \\sum_{p=0}^{3} \\sum_{q=0}^{3} B_{p}(s) B_{q}(t) \\,\\mathbf{d}_{p,q} $$\n    其中 $\\mathbf{d}_{p,q} = (d^{x}_{p,q}, d^{y}_{p,q})$ 是控制点位移向量。\n-   **参数坐标**：网格单元内的局部坐标是 $s \\in [0,1]$ 和 $t \\in [0,1]$。\n-   **三次B样条基函数**：对于标量参数 $r \\in [0,1]$，基函数为：\n    $$ B_{0}(r) = \\frac{(1-r)^{3}}{6} $$\n    $$ B_{1}(r) = \\frac{3r^{3} - 6r^{2} + 4}{6} $$\n    $$ B_{2}(r) = \\frac{-3r^{3} + 3r^{2} + 3r + 1}{6} $$\n    $$ B_{3}(r) = \\frac{r^{3}}{6} $$\n-   **控制点位移**：只有一个控制点位移是非零的：$\\mathbf{d}_{1,2} = (a, b)$，其中 $a = 2$ 且 $b = -1$。所有其他的 $\\mathbf{d}_{p,q}$ 都是零向量。\n-   **网格间距**：均匀控制网格的间距为 $h = 20$。\n-   **评估点**：评估将在单元的中心进行，对应参数坐标 $s = 0.5$ 和 $t = 0.5$。\n-   **目标**：\n    1.  计算指定点处的雅可比行列式 $J(x,y) = \\det(\\nabla \\mathbf{T}(x,y))$。\n    2.  判断该映射是否局部可逆。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题在可变形图像配准的数学理论中有充分的依据。使用B样条的FFD是一种标准且广泛应用的技术。使用雅可比行列式来检查局部可逆性（即检测形变场的“折叠”）是该领域的一个基本概念。所提供的基函数是三次B样条的正确和标准定义。\n-   **适定性**：该问题是完全指定的。它提供了所有必要的函数、参数值以及一个明确定义的目标。存在一个唯一的、可计算的解。\n-   **目标**：问题以精确、形式化的数学术语陈述，没有任何主观或模糊的语言。\n-   **结论**：满足了一个有效问题的所有标准。没有科学上的缺陷、不一致或含糊之处。\n\n### 第三步：进行求解\n\n变换由 $\\mathbf{T}(x,y) = (T_x, T_y)$ 给出，其中：\n$$ T_x(x,y) = x + u_x(x,y) $$\n$$ T_y(x,y) = y + u_y(x,y) $$\n此变换的雅可比矩阵是：\n$$ \\nabla \\mathbf{T}(x,y) = \\begin{pmatrix} \\frac{\\partial T_x}{\\partial x} & \\frac{\\partial T_x}{\\partial y} \\\\ \\frac{\\partial T_y}{\\partial x} & \\frac{\\partial T_y}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 1 + \\frac{\\partial u_x}{\\partial x} & \\frac{\\partial u_x}{\\partial y} \\\\ \\frac{\\partial u_y}{\\partial x} & 1 + \\frac{\\partial u_y}{\\partial y} \\end{pmatrix} = \\mathbf{I} + \\nabla \\mathbf{u}(x,y) $$\n雅可比行列式为 $J(x,y) = \\det(\\nabla \\mathbf{T}(x,y))$。\n\n鉴于只有 $\\mathbf{d}_{1,2} = (a, b)$ 非零，位移场的求和式简化为单项：\n$$ \\mathbf{u}(x,y) = B_{1}(s) B_{2}(t) \\, \\mathbf{d}_{1,2} $$\n位移的分量为：\n$$ u_x(x,y) = a B_{1}(s) B_{2}(t) $$\n$$ u_y(x,y) = b B_{1}(s) B_{2}(t) $$\n在一个单元内，参数坐标 $(s, t)$ 通过 $s = (x - x_0)/h$ 和 $t = (y - y_0)/h$ 与空间坐标 $(x, y)$ 相关联，其中 $(x_0, y_0)$ 是该单元的原点。偏导数为：\n$$ \\frac{\\partial s}{\\partial x} = \\frac{1}{h}, \\quad \\frac{\\partial s}{\\partial y} = 0, \\quad \\frac{\\partial t}{\\partial x} = 0, \\quad \\frac{\\partial t}{\\partial y} = \\frac{1}{h} $$\n使用链式法则，我们计算位移分量的空间导数。令 $B'_k(r) = \\frac{dB_k}{dr}$。\n$$ \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial}{\\partial s}(u_x) \\frac{\\partial s}{\\partial x} + \\frac{\\partial}{\\partial t}(u_x) \\frac{\\partial t}{\\partial x} = \\left( a B'_{1}(s) B_{2}(t) \\right) \\frac{1}{h} + 0 = \\frac{a}{h} B'_{1}(s) B_{2}(t) $$\n$$ \\frac{\\partial u_x}{\\partial y} = \\frac{\\partial}{\\partial s}(u_x) \\frac{\\partial s}{\\partial y} + \\frac{\\partial}{\\partial t}(u_x) \\frac{\\partial t}{\\partial y} = 0 + \\left( a B_{1}(s) B'_{2}(t) \\right) \\frac{1}{h} = \\frac{a}{h} B_{1}(s) B'_{2}(t) $$\n对于 $u_y$ 也是类似的：\n$$ \\frac{\\partial u_y}{\\partial x} = \\frac{b}{h} B'_{1}(s) B_{2}(t) $$\n$$ \\frac{\\partial u_y}{\\partial y} = \\frac{b}{h} B_{1}(s) B'_{2}(t) $$\n雅可比矩阵 $\\nabla \\mathbf{T}$ 是：\n$$ \\nabla \\mathbf{T} = \\begin{pmatrix} 1 + \\frac{a}{h} B'_{1}(s) B_{2}(t) & \\frac{a}{h} B_{1}(s) B'_{2}(t) \\\\ \\frac{b}{h} B'_{1}(s) B_{2}(t) & 1 + \\frac{b}{h} B_{1}(s) B'_{2}(t) \\end{pmatrix} $$\n行列式是：\n$$ J = \\det(\\nabla \\mathbf{T}) = \\left(1 + \\frac{a}{h} B'_{1}(s) B_{2}(t)\\right)\\left(1 + \\frac{b}{h} B_{1}(s) B'_{2}(t)\\right) - \\left(\\frac{a}{h} B_{1}(s) B'_{2}(t)\\right)\\left(\\frac{b}{h} B'_{1}(s) B_{2}(t)\\right) $$\n展开此表达式得到：\n$$ J = 1 + \\frac{a}{h} B'_{1}(s) B_{2}(t) + \\frac{b}{h} B_{1}(s) B'_{2}(t) + \\frac{ab}{h^2}B'_{1}(s) B_{2}(t) B_{1}(s) B'_{2}(t) - \\frac{ab}{h^2} B_{1}(s) B'_{2}(t) B'_{1}(s) B_{2}(t) $$\n最后两项相互抵消，将行列式简化为：\n$$ J = 1 + \\frac{a}{h} B'_{1}(s) B_{2}(t) + \\frac{b}{h} B_{1}(s) B'_{2}(t) $$\n接下来，我们在点 $s = 0.5$ 和 $t = 0.5$ 处计算B样条函数及其导数的值。令 $r=0.5$。\n基函数所需的导数为：\n$$ B'_{1}(r) = \\frac{d}{dr}\\left(\\frac{3r^{3} - 6r^{2} + 4}{6}\\right) = \\frac{9r^2 - 12r}{6} = \\frac{3r^2 - 4r}{2} $$\n$$ B'_{2}(r) = \\frac{d}{dr}\\left(\\frac{-3r^{3} + 3r^{2} + 3r + 1}{6}\\right) = \\frac{-9r^2 + 6r + 3}{6} = \\frac{-3r^2 + 2r + 1}{2} $$\n现在在 $r=0.5$ 处求值：\n$$ B_{1}(0.5) = \\frac{3(0.5)^{3} - 6(0.5)^{2} + 4}{6} = \\frac{3(\\frac{1}{8}) - 6(\\frac{1}{4}) + 4}{6} = \\frac{\\frac{3}{8} - \\frac{12}{8} + \\frac{32}{8}}{6} = \\frac{23/8}{6} = \\frac{23}{48} $$\n$$ B_{2}(0.5) = \\frac{-3(0.5)^{3} + 3(0.5)^{2} + 3(0.5) + 1}{6} = \\frac{-3(\\frac{1}{8}) + 3(\\frac{1}{4}) + \\frac{3}{2} + 1}{6} = \\frac{-\\frac{3}{8} + \\frac{6}{8} + \\frac{12}{8} + \\frac{8}{8}}{6} = \\frac{23/8}{6} = \\frac{23}{48} $$\n$$ B'_{1}(0.5) = \\frac{3(0.5)^2 - 4(0.5)}{2} = \\frac{3(\\frac{1}{4}) - 2}{2} = \\frac{\\frac{3}{4} - \\frac{8}{4}}{2} = \\frac{-5/4}{2} = -\\frac{5}{8} $$\n$$ B'_{2}(0.5) = \\frac{-3(0.5)^2 + 2(0.5) + 1}{2} = \\frac{-3(\\frac{1}{4}) + 1 + 1}{2} = \\frac{-\\frac{3}{4} + \\frac{8}{4}}{2} = \\frac{5/4}{2} = \\frac{5}{8} $$\n我们有以下值可以代入 J 的表达式中：\n$a=2$, $b=-1$, $h=20$, $s=0.5$, $t=0.5$。\n$B_1(0.5) = \\frac{23}{48}$, $B_2(0.5) = \\frac{23}{48}$, $B'_1(0.5) = -\\frac{5}{8}$, $B'_2(0.5) = \\frac{5}{8}$。\n$$ J = 1 + \\frac{2}{20} \\left(-\\frac{5}{8}\\right) \\left(\\frac{23}{48}\\right) + \\frac{-1}{20} \\left(\\frac{23}{48}\\right) \\left(\\frac{5}{8}\\right) $$\n$$ J = 1 - \\frac{1}{10} \\left(\\frac{5 \\times 23}{8 \\times 48}\\right) - \\frac{1}{20} \\left(\\frac{23 \\times 5}{48 \\times 8}\\right) $$\n提出公因式 $\\left( \\frac{5 \\times 23}{8 \\times 48} \\right)$:\n$$ J = 1 - \\left( \\frac{5 \\times 23}{8 \\times 48} \\right) \\left( \\frac{2}{20} + \\frac{1}{20} \\right) = 1 - \\left( \\frac{115}{384} \\right) \\left( \\frac{3}{20} \\right) $$\n$$ J = 1 - \\frac{115 \\times 3}{384 \\times 20} = 1 - \\frac{345}{7680} $$\n我们化简分数 $\\frac{345}{7680}$。两者均可被5整除：\n$$ \\frac{345 \\div 5}{7680 \\div 5} = \\frac{69}{1536} $$\n分子的各位数字之和是 $6+9=15$，分母的各位数字之和是 $1+5+3+6=15$。两者均可被3整除：\n$$ \\frac{69 \\div 3}{1536 \\div 3} = \\frac{23}{512} $$\n所以，雅可比行列式为：\n$$ J = 1 - \\frac{23}{512} = \\frac{512}{512} - \\frac{23}{512} = \\frac{489}{512} $$\n由于 $J = \\frac{489}{512} > 0$，该变换在评估点处是局部保向的，因此是可逆的。问题要求的是行列式的数值。",
            "answer": "$$\\boxed{\\frac{489}{512}}$$"
        }
    ]
}