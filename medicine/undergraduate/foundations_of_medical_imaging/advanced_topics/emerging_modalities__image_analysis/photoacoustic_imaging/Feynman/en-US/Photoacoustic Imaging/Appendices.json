{
    "hands_on_practices": [
        {
            "introduction": "The journey of a photoacoustic signal begins at the moment light is converted into sound. This fundamental exercise guides you through the derivation of the initial pressure rise from first principles, revealing the interplay between optical absorption, thermal expansion, and acoustic properties of tissue. By working through this problem, you will build a quantitative understanding of the photoacoustic effect, which is the cornerstone of this imaging modality .",
            "id": "4909951",
            "problem": "A nanosecond optical pulse is delivered to a homogeneous soft tissue in a photoacoustic imaging (PAI) experiment under thermal and stress confinement conditions. The tissue can be modeled as a linear, isotropic, thermoelastic medium. The absorbed energy density per unit volume is determined by the product of the optical absorption coefficient and the optical fluence. The pressure rise is governed by the elastic response to thermoelastic volumetric strain. Use these fundamental bases to derive the initial photoacoustic pressure rise.\n\nGiven tissue properties and illumination:\n- Optical absorption coefficient $\\mu_{a} = 0.5\\,\\mathrm{cm^{-1}}$,\n- Optical fluence $\\Phi = 10\\,\\mathrm{mJ/cm^{2}}$,\n- Volumetric thermal expansion coefficient $\\beta = 4 \\times 10^{-4}\\,\\mathrm{K^{-1}}$,\n- Speed of sound $c = 1540\\,\\mathrm{m/s}$,\n- Specific heat capacity at constant pressure (per unit mass) $C_{p} = 4\\,\\mathrm{kJ/(kg\\,K)}$.\n\nStarting from first principles:\n- Relate absorbed energy density per unit volume to $\\mu_{a}$ and $\\Phi$.\n- Relate the temperature rise to absorbed energy density and $C_{p}$.\n- Relate the initial pressure rise to volumetric strain through the bulk modulus and to temperature via $\\beta$.\n- Use the definition of bulk modulus in terms of $c$ and mass density.\n- Combine these relations to obtain a closed-form expression for the initial photoacoustic pressure $p_{0}$ in terms of the given quantities.\n\nCompute the numerical value of $p_{0}$ in Pascals and round your answer to four significant figures. Express the final pressure in $\\mathrm{Pa}$.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded in the principles of thermodynamics and acoustics, well-posed, objective, and internally consistent. It provides a clear path for derivation with sufficient, albeit requiring careful unit conversion, data to reach a unique solution. The mass density $\\rho$, while part of an intermediate physical relationship, cancels out in the final expression, rendering the problem self-contained.\n\nThe derivation of the initial photoacoustic pressure, $p_0$, proceeds from first principles as outlined. The core physical process involves the rapid, localized heating of the tissue by an optical pulse, followed by thermoelastic expansion that generates a pressure wave. The conditions of thermal and stress confinement are critical assumptions.\n\n1.  **Thermal Confinement**: Assumes the laser pulse duration, $\\tau_p$, is much shorter than the thermal diffusion time, $\\tau_{th}$. This means heat does not have time to conduct away from the absorption volume during the pulse. The heating process is effectively adiabatic.\n2.  **Stress Confinement**: Assumes $\\tau_p$ is much shorter than the acoustic transit time, $\\tau_s$. This means the mechanical stress does not have time to propagate away from the absorption volume during the pulse. The heating process occurs at a constant volume (isochoric).\n\nThese two conditions ensure that the absorbed optical energy is instantaneously and locally converted into a pressure rise.\n\nThe derivation follows these steps:\n\n**Step 1: Absorbed Energy Density**\nThe absorbed energy density per unit volume, $H$ (in units of $\\mathrm{J/m^3}$), is the product of the optical absorption coefficient, $\\mu_a$, and the local optical fluence, $\\Phi$.\n$$H = \\mu_a \\Phi$$\n\n**Step 2: Temperature Rise**\nUnder the specified confinement conditions, the absorbed energy $H$ leads to a rapid temperature rise, $\\Delta T$. This relationship is governed by the volumetric heat capacity of the medium. The heat capacity per unit volume is the product of the mass density, $\\rho$, and the specific heat capacity at constant pressure, $C_p$. We approximate the specific heat at constant volume $C_v$ with $C_p$, which is a valid approximation for condensed matter like soft tissue.\n$$H = \\rho C_p \\Delta T$$\nTherefore, the temperature rise is:\n$$\\Delta T = \\frac{H}{\\rho C_p} = \\frac{\\mu_a \\Phi}{\\rho C_p}$$\n\n**Step 3: Thermoelastic Pressure Generation**\nThe temperature rise $\\Delta T$ induces an instantaneous isotropic thermal expansion. For a linear, isotropic, thermoelastic medium, the volumetric strain due to thermal expansion, $\\epsilon_{th}$, is given by:\n$$\\epsilon_{th} = \\beta \\Delta T$$\nwhere $\\beta$ is the volumetric thermal expansion coefficient.\n\nUnder stress confinement, the medium does not have time to expand. An internal stress, or pressure $p_0$, is generated to oppose this thermal expansion, maintaining a net zero strain. This initial pressure is related to the thermally induced strain and the medium's bulk modulus, $K$, by Hooke's law:\n$$p_0 = K \\epsilon_{th} = K \\beta \\Delta T$$\nThe bulk modulus $K$ is related to the speed of sound, $c$, and the mass density, $\\rho$, by the fundamental acoustic relation:\n$$K = \\rho c^2$$\nSubstituting this into the expression for $p_0$:\n$$p_0 = (\\rho c^2) \\beta \\Delta T$$\n\n**Step 4: Combined Expression for Initial Pressure**\nWe combine the equations from the preceding steps to derive a single expression for $p_0$. Substituting the expression for $\\Delta T$ from Step 2 into the expression for $p_0$ from Step 3:\n$$p_0 = (\\rho c^2) \\beta \\left( \\frac{\\mu_a \\Phi}{\\rho C_p} \\right)$$\nThe mass density, $\\rho$, cancels from the numerator and denominator. This is a crucial step, confirming that the problem is solvable without an explicit value for $\\rho$.\n$$p_0 = \\frac{\\beta c^2 \\mu_a \\Phi}{C_p}$$\nThis is the desired closed-form expression for the initial photoacoustic pressure. The dimensionless quantity $\\Gamma = \\frac{\\beta c^2}{C_p}$ is known as the Grüneisen parameter, which quantifies the conversion efficiency from heat to pressure. The equation can be written compactly as $p_0 = \\Gamma \\mu_a \\Phi$.\n\n**Step 5: Numerical Calculation**\nTo compute the numerical value of $p_0$, all given quantities must be converted to a consistent set of units, preferably SI base units (meters, kilograms, seconds, Kelvin, Joules).\n\nThe given values are:\n-   $\\mu_{a} = 0.5\\,\\mathrm{cm^{-1}}$\n-   $\\Phi = 10\\,\\mathrm{mJ/cm^{2}}$\n-   $\\beta = 4 \\times 10^{-4}\\,\\mathrm{K^{-1}}$\n-   $c = 1540\\,\\mathrm{m/s}$\n-   $C_{p} = 4\\,\\mathrm{kJ/(kg\\,K)}$\n\nUnit conversions to SI:\n-   $\\mu_{a} = 0.5\\,\\mathrm{cm^{-1}} = 0.5 \\times (10^{-2}\\,\\mathrm{m})^{-1} = 0.5 \\times 100\\,\\mathrm{m^{-1}} = 50\\,\\mathrm{m^{-1}}$\n-   $\\Phi = 10\\,\\mathrm{mJ/cm^{2}} = 10 \\times 10^{-3}\\,\\mathrm{J} / (10^{-2}\\,\\mathrm{m})^2 = 10 \\times 10^{-3}\\,\\mathrm{J} / 10^{-4}\\,\\mathrm{m^2} = 100\\,\\mathrm{J/m^2}$\n-   $\\beta = 4 \\times 10^{-4}\\,\\mathrm{K^{-1}}$ (This is already in SI units)\n-   $c = 1540\\,\\mathrm{m/s}$ (This is already in SI units)\n-   $C_{p} = 4\\,\\mathrm{kJ/(kg\\,K)} = 4 \\times 10^3\\,\\mathrm{J/(kg\\,K)}$\n\nNow, we substitute these SI values into the derived formula for $p_0$:\n$$p_0 = \\frac{(4 \\times 10^{-4}\\,\\mathrm{K^{-1}}) \\times (1540\\,\\mathrm{m/s})^2 \\times (50\\,\\mathrm{m^{-1}}) \\times (100\\,\\mathrm{J/m^2})}{4000\\,\\mathrm{J/(kg\\,K)}}$$\n$$p_0 = \\frac{(4 \\times 10^{-4}) \\times (2371600) \\times (50) \\times (100)}{4000} \\,\\, \\mathrm{Pa}$$\n$$p_0 = \\frac{4 \\times 10^{-4} \\times 2.3716 \\times 10^6 \\times 5 \\times 10^3}{4 \\times 10^3} \\,\\, \\mathrm{Pa}$$\nCanceling the $4 \\times 10^3$ term from the numerator and denominator simplifies the expression:\n$$p_0 = 10^{-4} \\times 2.3716 \\times 10^6 \\times 5 \\,\\, \\mathrm{Pa}$$\n$$p_0 = (2.3716 \\times 5) \\times 10^{2} \\,\\, \\mathrm{Pa}$$\n$$p_0 = 11.858 \\times 10^{2} \\,\\, \\mathrm{Pa}$$\n$$p_0 = 1185.8 \\,\\, \\mathrm{Pa}$$\n\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $1185.8$. The fifth significant digit is $8$, so we round up the fourth digit.\n$$p_0 \\approx 1186\\,\\mathrm{Pa}$$\nThe initial photoacoustic pressure rise is $1186$ Pascals.",
            "answer": "$$\\boxed{1186}$$"
        },
        {
            "introduction": "Once a pressure wave is generated, it must be faithfully captured by electronic sensors to form an image. This practice delves into the critical process of digitization, where a continuous analog signal is converted into a series of discrete samples. You will explore the Nyquist-Shannon sampling theorem, a foundational concept in signal processing, to determine the minimum sampling rate required to prevent signal distortion and information loss, ensuring the acoustic wave is recorded with high fidelity .",
            "id": "4909999",
            "problem": "A Photoacoustic Tomography (PAT) system records the acoustic pressure signal $p(t)$ generated by nanosecond optical excitation. Due to the transducer’s finite bandwidth and acoustic attenuation, the measured pressure signal is effectively bandlimited in the sense that its Fourier transform $P(f)$ satisfies $P(f)=0$ for all $|f|>f_{\\max}$, where $f_{\\max}$ is the largest significant frequency component of the signal. The system digitizes $p(t)$ using uniform temporal sampling with period $T_{s}$ and rate $f_{s}=1/T_{s}$. Starting from the Fourier transform definition and the representation of uniform sampling as multiplication of $p(t)$ by a Dirac comb in time, derive a condition on $f_{s}$ that guarantees exact, alias-free reconstruction of $p(t)$ from its samples by ideal low-pass filtering. Then, using your derived condition, compute the minimal $f_{s}$ when the expected PAT bandwidth has a maximum frequency $f_{\\max}=20\\,\\mathrm{MHz}$. Express your final sampling frequency in $\\mathrm{MHz}$. No rounding is required.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   The acoustic pressure signal is $p(t)$.\n-   The signal is bandlimited, with Fourier transform $P(f)$.\n-   $P(f) = 0$ for all $|f| > f_{\\max}$.\n-   $f_{\\max}$ is the largest significant frequency component.\n-   The signal is digitized by uniform temporal sampling with period $T_s$ and rate $f_s = 1/T_s$.\n-   The task is to derive a condition on $f_s$ for alias-free reconstruction of $p(t)$ from its samples.\n-   The derivation must start from the Fourier transform definition and the representation of sampling as multiplication of $p(t)$ by a Dirac comb.\n-   The reconstruction method is ideal low-pass filtering.\n-   A numerical calculation is required: find the minimal $f_s$ for $f_{\\max} = 20\\,\\mathrm{MHz}$.\n-   The final answer for frequency must be in $\\mathrm{MHz}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a classic application of the Nyquist-Shannon sampling theorem, a fundamental principle in digital signal processing. The context of photoacoustic tomography and the specified bandwidth of $20\\,\\mathrm{MHz}$ are realistic for biomedical imaging applications.\n-   **Well-Posed**: The problem is well-defined. It asks for a derivation of a known theorem under specific instructions and then for a simple application of the derived result. The problem is self-contained and provides all necessary information for a unique solution.\n-   **Objective**: The language is technical, precise, and devoid of subjectivity.\n\nThe problem does not violate any of the invalidity criteria. It is a standard, scientifically sound, and well-posed problem in signal processing as applied to medical imaging.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nLet the continuous-time photoacoustic pressure signal be denoted by $p(t)$. Its Fourier transform, $P(f)$, is defined as:\n$$ P(f) = \\mathcal{F}\\{p(t)\\} = \\int_{-\\infty}^{\\infty} p(t) \\exp(-j2\\pi f t) dt $$\nThe problem states that the signal is bandlimited, which means its Fourier transform is zero outside a certain frequency range. Specifically, $P(f) = 0$ for $|f| > f_{\\max}$.\n\nUniform sampling of $p(t)$ at a rate $f_s = 1/T_s$ can be modeled as the multiplication of $p(t)$ by a Dirac comb, $\\delta_{T_s}(t)$, which is an infinite train of Dirac delta functions spaced by the sampling period $T_s$.\n$$ \\delta_{T_s}(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s) $$\nThe sampled signal, $p_s(t)$, is then:\n$$ p_s(t) = p(t) \\cdot \\delta_{T_s}(t) = p(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s) = \\sum_{n=-\\infty}^{\\infty} p(nT_s) \\delta(t - nT_s) $$\nTo understand the effect of sampling in the frequency domain, we compute the Fourier transform of $p_s(t)$, denoted as $P_s(f)$. According to the convolution theorem, multiplication in the time domain corresponds to convolution in the frequency domain:\n$$ P_s(f) = \\mathcal{F}\\{p_s(t)\\} = P(f) * \\mathcal{F}\\{\\delta_{T_s}(t)\\} $$\nThe Fourier transform of the Dirac comb, $\\mathcal{F}\\{\\delta_{T_s}(t)\\}$, is itself a Dirac comb in the frequency domain. We can find it by first representing $\\delta_{T_s}(t)$ by its Fourier series. As a periodic function with period $T_s$, its Fourier series coefficients $c_k$ are:\n$$ c_k = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} \\delta(t) \\exp\\left(-j2\\pi \\frac{k}{T_s} t\\right) dt = \\frac{1}{T_s} $$\nThus, the Fourier series representation of the time-domain Dirac comb is:\n$$ \\delta_{T_s}(t) = \\frac{1}{T_s} \\sum_{k=-\\infty}^{\\infty} \\exp\\left(j2\\pi \\frac{k}{T_s} t\\right) = f_s \\sum_{k=-\\infty}^{\\infty} \\exp(j2\\pi k f_s t) $$\nTaking the Fourier transform of this series, and using the identity $\\mathcal{F}\\{\\exp(j2\\pi f_0 t)\\} = \\delta(f-f_0)$, we obtain:\n$$ \\mathcal{F}\\{\\delta_{T_s}(t)\\} = f_s \\sum_{k=-\\infty}^{\\infty} \\mathcal{F}\\{\\exp(j2\\pi k f_s t)\\} = f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) $$\nNow we can perform the convolution to find $P_s(f)$:\n$$ P_s(f) = P(f) * \\left( f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) \\right) $$\nUsing the sifting property of convolution, $g(f) * \\delta(f-f_0) = g(f-f_0)$, we get:\n$$ P_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} P(f - kf_s) $$\nThis equation is fundamental. It shows that the spectrum of the sampled signal, $P_s(f)$, is a periodic summation of copies of the original signal's spectrum $P(f)$, scaled by $f_s$ and shifted by integer multiples of the sampling frequency $f_s$.\n\nThe original signal $p(t)$ can be recovered from its samples by applying an ideal low-pass filter to $p_s(t)$ that isolates the baseband spectrum (the $k=0$ term, which is $f_s P(f)$) and removes all other replicas. This is only possible if the spectral replicas do not overlap. This phenomenon of spectral overlap is known as aliasing.\n\nThe original spectrum $P(f)$ is non-zero only in the interval $[-f_{\\max}, f_{\\max}]$. The replica centered at $f=0$ occupies this interval. The adjacent replicas are centered at $f = f_s$ and $f = -f_s$. The replica centered at $f_s$ occupies the interval $[f_s - f_{\\max}, f_s + f_{\\max}]$.\n\nTo prevent aliasing, the upper edge of the baseband spectrum must not exceed the lower edge of the first positive-frequency replica. Mathematically, this condition is:\n$$ f_{\\max} \\leq f_s - f_{\\max} $$\nRearranging this inequality gives the condition on the sampling frequency $f_s$:\n$$ f_s \\geq 2f_{\\max} $$\nThis is the Nyquist-Shannon sampling criterion. It states that to ensure exact, alias-free reconstruction of a bandlimited signal, the sampling frequency must be at least twice the maximum frequency component of the signal. The quantity $2f_{\\max}$ is known as the Nyquist rate.\n\n### Numerical Calculation\n\nThe problem asks for the minimal sampling frequency $f_s$ that satisfies this condition. The minimum value is achieved at the lower bound of the inequality:\n$$ f_{s, \\min} = 2f_{\\max} $$\nGiven that the maximum frequency component of the photoacoustic signal is $f_{\\max} = 20\\,\\mathrm{MHz}$:\n$$ f_{s, \\min} = 2 \\times 20\\,\\mathrm{MHz} = 40\\,\\mathrm{MHz} $$\nThe minimal sampling frequency required for alias-free reconstruction is $40\\,\\mathrm{MHz}$.",
            "answer": "$$\\boxed{40}$$"
        },
        {
            "introduction": "A raw measured signal is rarely a perfect replica of the initial pressure wave; it is inevitably colored by the transducer's response and corrupted by noise. This advanced, hands-on coding challenge puts you in the role of an imaging scientist, tasking you with designing a Wiener deconvolution filter to solve this inverse problem. By implementing and testing your algorithm, you will learn how to computationally \"undo\" system distortions and suppress noise, a crucial step in reconstructing a clear and accurate image from real-world data .",
            "id": "4909911",
            "problem": "Consider a one-dimensional photoacoustic measurement modeled as a linear time-invariant system. A short optical pulse generates an initial acoustic pressure distribution $p_0(t)$ along the detector line-of-sight. The measured electrical signal $y(t)$ from the ultrasonic transducer is modeled by the convolution of $p_0(t)$ with the system impulse response $h(t)$, corrupted by additive noise $n(t)$, so that $y(t) = (h * p_0)(t) + n(t)$. Assume the noise $n(t)$ is zero-mean, wide-sense stationary, and independent of $p_0(t)$.\n\nStarting strictly from the linear time-invariant model and the definitions of convolution, Fourier transform, and mean-square error, design a frequency-domain Wiener deconvolution to estimate $p_0(t)$ from a measured $y(t)$ and a known $h(t)$. Determine the regularization parameter entirely from noise statistics estimated from a time interval that contains noise only. Your derivation and algorithm must be valid for finite-length discrete-time signals.\n\nYou must implement the following numerical experiment and produce quantitative results:\n\n- Discrete-time signals with sampling interval $\\Delta t = 2 \\times 10^{-8}$ s (that is, $20$ ns), and total number of samples $N = 2048$. The time axis is $t_k = k \\Delta t$ for $k = 0, 1, \\dots, N-1$.\n- A causal system impulse response $h(t)$ of the form $h(t) = u(t) \\exp(-t/\\tau) \\sin(2 \\pi f_0 t)$, where $u(t)$ is the unit step function, $f_0$ is the center frequency, and $\\tau$ is the exponential decay constant. You will be given different values of $f_0$ and $\\tau$ for each test case.\n- An initial pressure distribution $p_0(t)$ that is the sum of three Gaussian absorbers,\n$$\np_0(t) = A_1 \\exp\\!\\left(-\\frac{(t - t_1)^2}{2 w_1^2}\\right) + A_2 \\exp\\!\\left(-\\frac{(t - t_2)^2}{2 w_2^2}\\right) + A_3 \\exp\\!\\left(-\\frac{(t - t_3)^2}{2 w_3^2}\\right),\n$$\nwith amplitudes $A_1 = 1000$ Pa, $A_2 = 700$ Pa, $A_3 = 500$ Pa, centers $t_1 = 3.2 \\times 10^{-6}$ s, $t_2 = 4.0 \\times 10^{-6}$ s, $t_3 = 4.8 \\times 10^{-6}$ s, and widths $w_1 = 1.5 \\times 10^{-7}$ s, $w_2 = 1.0 \\times 10^{-7}$ s, $w_3 = 2.0 \\times 10^{-7}$ s.\n- The measured signal is $y(t) = (h * p_0)(t) + n(t)$, implemented as a linear convolution truncated or centered to length $N$ in discrete time. The additive noise $n(t)$ is white Gaussian noise with a specified signal-to-noise ratio in decibels (defined using average power of the noiseless $y(t)$ and average power of noise). Use an initial pre-trigger interval of $N_{\\mathrm{pre}} = 128$ samples, during which $p_0(t) = 0$ so that $y(t)$ contains noise only; use this interval to estimate noise statistics needed for regularization.\n\nTask requirements:\n1. Derive a frequency-domain Wiener deconvolution estimator $\\widehat{p}_0(t)$ based on the given model, expressing the filter in terms of $H(\\omega)$, $Y(\\omega)$, and a regularization determined from noise statistics. Your derivation must start from the linear time-invariant system model and minimize the mean-square error between the estimate and the true $p_0(t)$.\n2. Propose a practical method to estimate the regularization parameter from the pre-trigger noise-only interval and the measured signal, suitable for discrete-time implementation. Your method must not use any ground-truth information about $p_0(t)$ that would be unavailable in a real measurement.\n3. Implement the estimator and compute the root-mean-square error (RMSE) between $\\widehat{p}_0(t)$ and the true $p_0(t)$ over all $N$ samples. Express each RMSE in Pa, rounded to six decimal places.\n\nTest suite:\n- Case $1$ (happy path): $f_0 = 2.0 \\times 10^{6}$ Hz, $\\tau = 6.0 \\times 10^{-7}$ s, $\\mathrm{SNR} = 20$ dB.\n- Case $2$ (low $\\mathrm{SNR}$ boundary): $f_0 = 2.0 \\times 10^{6}$ Hz, $\\tau = 3.0 \\times 10^{-7}$ s, $\\mathrm{SNR} = 0$ dB.\n- Case $3$ (higher center frequency): $f_0 = 5.0 \\times 10^{6}$ Hz, $\\tau = 1.5 \\times 10^{-7}$ s, $\\mathrm{SNR} = 10$ dB.\n- Case $4$ (narrow-band, slowly decaying): $f_0 = 1.0 \\times 10^{6}$ Hz, $\\tau = 1.0 \\times 10^{-6}$ s, $\\mathrm{SNR} = 5$ dB.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[result_1,result_2,result_3,result_4]$), where each entry is the RMSE in Pa for the corresponding test case, rounded to six decimal places. The angle unit is not applicable. No other text should be printed.",
            "solution": "The problem requires the design and implementation of a Wiener deconvolution filter to estimate an initial acoustic pressure distribution $p_0(t)$ from a measured signal $y(t)$. The relationship is modeled as a linear time-invariant (LTI) system: $y(t) = (h * p_0)(t) + n(t)$, where $h(t)$ is the system's impulse response and $n(t)$ is additive noise.\n\n### Part 1: Derivation of the Wiener Deconvolution Filter\n\nThe goal is to find an estimate $\\widehat{p}_0(t)$ of the true signal $p_0(t)$ that minimizes the mean-square error (MSE). We design a linear filter $g(t)$ such that our estimate is given by the convolution $\\widehat{p}_0(t) = (g * y)(t)$. The objective is to minimize the error functional $J = E\\left[\\int_{-\\infty}^{\\infty} |p_0(t) - \\widehat{p}_0(t)|^2 dt\\right]$, where $E[\\cdot]$ denotes the expectation operator.\n\nBy Parseval's theorem, minimizing the MSE in the time domain is equivalent to minimizing the MSE at each frequency independently in the frequency domain. The convolution operation becomes multiplication in the frequency domain:\n$$Y(\\omega) = H(\\omega)P_0(\\omega) + N(\\omega)$$\nwhere $Y(\\omega)$, $H(\\omega)$, $P_0(\\omega)$, and $N(\\omega)$ are the Fourier transforms of $y(t)$, $h(t)$, $p_0(t)$, and $n(t)$, respectively. The estimate in the frequency domain is:\n$$\\widehat{P}_0(\\omega) = G(\\omega)Y(\\omega) = G(\\omega)(H(\\omega)P_0(\\omega) + N(\\omega))$$\nThe error at a given frequency $\\omega$ is $E(\\omega) = P_0(\\omega) - \\widehat{P}_0(\\omega)$. The MSE at this frequency is $\\epsilon(\\omega) = E[|E(\\omega)|^2]$.\n$$\\epsilon(\\omega) = E[|P_0(\\omega) - G(\\omega)(H(\\omega)P_0(\\omega) + N(\\omega))|^2]$$\nRearranging the terms inside the expectation:\n$$E(\\omega) = (1 - G(\\omega)H(\\omega))P_0(\\omega) - G(\\omega)N(\\omega)$$\nThe problem states that the noise $n(t)$ is zero-mean and independent of the signal $p_0(t)$. This implies that their cross-correlation is zero, and thus $E[P_0(\\omega)N^*(\\omega)] = 0$ (where $^*$ denotes the complex conjugate). The MSE expression expands to:\n$$\\epsilon(\\omega) = |1 - G(\\omega)H(\\omega)|^2 E[|P_0(\\omega)|^2] + |G(\\omega)|^2 E[|N(\\omega)|^2]$$\nWe define the power spectral densities (PSDs) as $\\Phi_{p_0}(\\omega) = E[|P_0(\\omega)|^2]$ and $\\Phi_n(\\omega) = E[|N(\\omega)|^2]$. The MSE is then:\n$$\\epsilon(\\omega) = |1 - G(\\omega)H(\\omega)|^2 \\Phi_{p_0}(\\omega) + |G(\\omega)|^2 \\Phi_n(\\omega)$$\nTo find the optimal filter $G(\\omega)$ that minimizes $\\epsilon(\\omega)$, we take the complex derivative with respect to $G^*(\\omega)$ and set it to zero:\n$$\\frac{\\partial\\epsilon(\\omega)}{\\partial G^*(\\omega)} = -(1 - G(\\omega)H(\\omega))H^*(\\omega)\\Phi_{p_0}(\\omega) + G(\\omega)\\Phi_n(\\omega) = 0$$\nSolving for $G(\\omega)$:\n$$G(\\omega) \\left( |H(\\omega)|^2 \\Phi_{p_0}(\\omega) + \\Phi_n(\\omega) \\right) = H^*(\\omega)\\Phi_{p_0}(\\omega)$$\n$$G_{opt}(\\omega) = \\frac{H^*(\\omega)\\Phi_{p_0}(\\omega)}{|H(\\omega)|^2 \\Phi_{p_0}(\\omega) + \\Phi_n(\\omega)} = \\frac{H^*(\\omega)}{|H(\\omega)|^2 + \\frac{\\Phi_n(\\omega)}{\\Phi_{p_0}(\\omega)}}$$\nThe optimal estimate in the frequency domain, known as the Wiener filter estimate, is:\n$$\\widehat{P}_0(\\omega) = G_{opt}(\\omega) Y(\\omega) = \\left( \\frac{H^*(\\omega)}{|H(\\omega)|^2 + \\frac{\\Phi_n(\\omega)}{\\Phi_{p_0}(\\omega)}} \\right) Y(\\omega)$$\n\n### Part 2: Practical Estimation of the Regularization Parameter\n\nIn a practical scenario, the power spectral density of the true signal, $\\Phi_{p_0}(\\omega)$, is unknown. Therefore, the ratio $\\Phi_n(\\omega)/\\Phi_{p_0}(\\omega)$ cannot be calculated directly. This term acts as a regularization parameter, preventing the amplification of noise at frequencies where $|H(\\omega)|$ is small.\n\nA common and robust approach is to simplify the filter form to Tikhonov regularization and determine a suitable regularization parameter. We replace the frequency-dependent ratio with a single constant parameter $\\alpha$:\n$$\\widehat{P}_0(\\omega) = \\left( \\frac{H^*(\\omega)}{|H(\\omega)|^2 + \\alpha} \\right) Y(\\omega)$$\nThe problem requires determining $\\alpha$ \"entirely from noise statistics\". This guides us to use a method where the choice of $\\alpha$ is governed by properties of the noise. The Discrepancy Principle is a suitable method. It states that the regularization parameter $\\alpha$ should be chosen such that the energy of the residual signal equals the expected energy of the noise.\n\nThe residual in the time domain is $r(t) = y(t) - (h * \\widehat{p}_0)(t)$. Its expected energy is matched to the noise energy:\n$$E\\left[ \\int |r(t)|^2 dt \\right] = E\\left[ \\int |n(t)|^2 dt \\right]$$\nFor a discrete signal of length $N$, this translates to finding $\\alpha$ such that the sum of squared residuals matches the expected sum of squared noise samples:\n$$\\sum_{k=0}^{N-1} |r_k|^2 = \\sum_{k=0}^{N-1} E[|n_k|^2] = N \\sigma_n^2$$\nwhere $\\sigma_n^2$ is the noise variance. We can estimate $\\sigma_n^2$ from the provided pre-trigger noise-only interval of $N_{\\mathrm{pre}}$ samples:\n$$\\hat{\\sigma}_n^2 = \\frac{1}{N_{\\mathrm{pre}}} \\sum_{k=0}^{N_{\\mathrm{pre}}-1} |y_k|^2$$\nIn the frequency domain, using Parseval's theorem ($\\sum_k |x_k|^2 = \\frac{1}{N}\\sum_m |X_m|^2$), the discrepancy principle equation becomes:\n$$\\frac{1}{N} \\sum_{m=0}^{N-1} |R_m|^2 = N \\hat{\\sigma}_n^2$$\nwhere $R_m$ is the Discrete Fourier Transform (DFT) of the residual $r_k$. The residual in the frequency domain is:\n$$R_m = Y_m - H_m \\widehat{P}_{0,m} = Y_m - H_m \\left( \\frac{H_m^* Y_m}{|H_m|^2 + \\alpha} \\right) = Y_m \\left( 1 - \\frac{|H_m|^2}{|H_m|^2 + \\alpha} \\right) = \\frac{\\alpha Y_m}{|H_m|^2 + \\alpha}$$\nSubstituting this into the discrepancy equation gives the non-linear equation for $\\alpha$:\n$$f(\\alpha) = \\sum_{m=0}^{N-1} \\left| \\frac{\\alpha Y_m}{|H_m|^2 + \\alpha} \\right|^2 - N^2 \\hat{\\sigma}_n^2 = 0$$\nThis equation can be solved for $\\alpha > 0$ using a numerical root-finding algorithm. The function $f(\\alpha)$ is monotonically increasing with $\\alpha$, guaranteeing a unique solution.\n\n### Part 3: Implementation and RMSE Calculation\n\nThe algorithm for the numerical experiment is as follows:\n1.  For each test case, define the parameters $f_0$, $\\tau$, and SNR.\n2.  Generate the discrete time axis $t_k$ for $k=0, \\dots, N-1$.\n3.  Compute the true initial pressure signal $p_0(t_k)$ as the sum of three Gaussians.\n4.  Compute the discrete impulse response $h(t_k)$.\n5.  Perform a discrete linear convolution $y_{noiseless} = h * p_0$. We use a 'same' mode convolution to maintain the length $N$.\n6.  Calculate the average power of the noiseless signal: $P_{sig} = \\frac{1}{N} \\sum_{k=0}^{N-1} |y_{noiseless,k}|^2$.\n7.  From the given SNR in decibels, calculate the required noise variance: $\\sigma_n^2 = P_{sig} / 10^{(\\mathrm{SNR_{dB}}/10)}$.\n8.  Generate a white Gaussian noise signal $n_k$ of length $N$ with variance $\\sigma_n^2$.\n9.  Create the measured signal $y_k = y_{noiseless,k} + n_k$.\n10. Estimate the noise variance $\\hat{\\sigma}_n^2$ from the first $N_{\\mathrm{pre}}$ samples of $y_k$.\n11. Compute the DFTs $Y_m = \\text{DFT}(y_k)$ and $H_m = \\text{DFT}(h_k)$.\n12. Define the function $f(\\alpha)$ for the discrepancy principle and find the root $\\alpha$ using a numerical solver (e.g., from `scipy.optimize`).\n13. Construct the regularized estimate in the frequency domain: $\\widehat{P}_{0,m} = \\frac{H_m^* Y_m}{|H_m|^2 + \\alpha}$.\n14. Compute the inverse DFT to obtain the time-domain estimate $\\widehat{p}_{0,k} = \\text{IDFT}(\\widehat{P}_{0,m})$.\n15. Calculate the Root-Mean-Square Error (RMSE) between the estimate and the true signal: $\\text{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{k=0}^{N-1} (p_{0,k} - \\widehat{p}_{0,k})^2}$.\n16. Report the RMSE rounded to six decimal places.\n\nThis procedure constitutes a complete and principled approach to Wiener deconvolution when the signal statistics are unknown, relying instead on a well-defined criterion based on estimable noise properties.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import convolve\nfrom scipy.fft import fft, ifft\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the Wiener deconvolution problem for photoacoustic imaging.\n\n    The function implements a numerical experiment for four test cases. For each case, it:\n    1. Generates the ground-truth initial pressure signal (p0) and the system impulse response (h).\n    2. Simulates the measured signal (y) by convolving p0 with h and adding Gaussian noise of a specified SNR.\n    3. Estimates the noise variance from a pre-trigger interval of the measured signal.\n    4. Uses the discrepancy principle to find the optimal Tikhonov regularization parameter (alpha). This involves\n       solving a nonlinear equation to match the residual energy with the estimated noise energy.\n    5. Applies the frequency-domain regularized inverse filter (Wiener-Tikhonov filter) to the measured signal\n       to obtain an estimate of the initial pressure (p0_hat).\n    6. Computes the Root-Mean-Square Error (RMSE) between the estimate and the ground truth.\n    7. Collects the RMSE for all cases and prints them in the specified format.\n    \"\"\"\n    # Global parameters for the simulation\n    DT = 2e-8  # Sampling interval in seconds (20 ns)\n    N = 2048   # Total number of samples\n    N_PRE = 128 # Number of pre-trigger samples for noise estimation\n\n    # Time vector\n    t = np.arange(N) * DT\n\n    # Initial pressure distribution p0(t) parameters\n    p0_params = {\n        'A1': 1000.0, 't1': 3.2e-6, 'w1': 1.5e-7,\n        'A2': 700.0,  't2': 4.0e-6, 'w2': 1.0e-7,\n        'A3': 500.0,  't3': 4.8e-6, 'w3': 2.0e-7,\n    }\n\n    # Generate the ground-truth initial pressure signal p0(t)\n    def generate_p0(t_vec, params):\n        p = params['A1'] * np.exp(-((t_vec - params['t1'])**2) / (2 * params['w1']**2))\n        p += params['A2'] * np.exp(-((t_vec - params['t2'])**2) / (2 * params['w2']**2))\n        p += params['A3'] * np.exp(-((t_vec - params['t3'])**2) / (2 * params['w3']**2))\n        return p\n\n    p0_true = generate_p0(t, p0_params)\n    \n    # Test cases from the problem statement\n    test_cases = [\n        {'f0': 2.0e6, 'tau': 6.0e-7, 'snr_db': 20}, # Case 1\n        {'f0': 2.0e6, 'tau': 3.0e-7, 'snr_db': 0},  # Case 2\n        {'f0': 5.0e6, 'tau': 1.5e-7, 'snr_db': 10}, # Case 3\n        {'f0': 1.0e6, 'tau': 1.0e-6, 'snr_db': 5},  # Case 4\n    ]\n    \n    results = []\n\n    for case in test_cases:\n        f0 = case['f0']\n        tau = case['tau']\n        snr_db = case['snr_db']\n        \n        # Generate the causal impulse response h(t)\n        h = np.exp(-t / tau) * np.sin(2 * np.pi * f0 * t)\n        h[t  0] = 0 # Ensure causality\n        \n        # 1. Simulate the measured signal y(t)\n        # Convolve p0 with h to get the noiseless signal\n        y_noiseless = convolve(p0_true, h, mode='same')\n        \n        # Calculate signal power and required noise power for the given SNR\n        power_signal = np.mean(y_noiseless**2)\n        snr_linear = 10**(snr_db / 10.0)\n        power_noise = power_signal / snr_linear\n        noise_std = np.sqrt(power_noise)\n        \n        # Generate noise and add it to the signal\n        # Use a fixed seed for reproducibility of noise across runs\n        rng = np.random.default_rng(seed=42)\n        noise = rng.normal(0, noise_std, N)\n        y_measured = y_noiseless + noise\n        \n        # 2. Estimate noise variance from pre-trigger interval\n        noise_pre_trigger = y_measured[:N_PRE]\n        # Using mean of squares for power/variance estimate\n        sigma_n_sq_est = np.mean(noise_pre_trigger**2)\n        \n        # 3. Apply Wiener-Tikhonov deconvolution\n        # Compute DFTs of measured signal and impulse response\n        y_fft = fft(y_measured)\n        h_fft = fft(h)\n        h_fft_mag_sq = np.abs(h_fft)**2\n\n        # Define the function for the discrepancy principle\n        # We need to find the root alpha of this function.\n        # Target residual energy = N * sigma_n^2\n        # Sum of squares of residual in freq domain = N^2 * sigma_n^2\n        target_residual_energy_freq = N * N * sigma_n_sq_est\n        \n        def discrepancy_func(alpha):\n            if alpha = 0: return -target_residual_energy_freq\n            residual_fft_mag_sq = (alpha**2 * np.abs(y_fft)**2) / ((h_fft_mag_sq + alpha)**2)\n            return np.sum(residual_fft_mag_sq) - target_residual_energy_freq\n\n        # Solve for alpha using a robust root-finding algorithm\n        # Bracket search. f(alpha) is monotonic.\n        # A very small alpha will give near-zero residual energy.\n        # A very large alpha will result in residual energy approaching the energy of y_measured.\n        try:\n            sol = root_scalar(discrepancy_func, bracket=[1e-15, 1e15], method='brentq')\n            alpha_opt = sol.root\n        except ValueError:\n            # If brenth fails (e.g., f has same sign at endpoints), it indicates an issue.\n            # This can happen if noise is extremely low or high. Fallback to a reasonable value.\n            # A common heuristic is related to the max of H's spectrum and noise level.\n            # For this problem, the bracket should be sufficient.\n            alpha_opt = 1e-4 * np.max(h_fft_mag_sq)\n\n        # 4. Perform deconvolution with the optimal alpha\n        p0_est_fft = (np.conj(h_fft) * y_fft) / (h_fft_mag_sq + alpha_opt)\n        \n        # Convert back to time domain\n        p0_est = np.real(ifft(p0_est_fft))\n        \n        # 5. Calculate RMSE\n        rmse = np.sqrt(np.mean((p0_true - p0_est)**2))\n        results.append(round(rmse, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}