{
    "hands_on_practices": [
        {
            "introduction": "任何测量都会受到噪声的限制。在电阻抗断层成像（EIT）中，理解信噪比（SNR）对于设计有效的系统和解释数据至关重要。本练习将引导您从第一性原理出发，量化 EIT 系统的基本性能极限，通过计算信噪比和最小可探测阻抗变化，您将对数据采集的质量和精度建立起具体的认识。",
            "id": "4881466",
            "problem": "一个电阻抗断层成像 (EIT) 系统通过一对电极注入均方根 (RMS) 幅值为 $I$ 的正弦驱动电流，并测量另一对电极之间的边界电压。测得的转移阻抗模为 $|Z_{t}|$，其定义关系为 $|Z_{t}| = |V|/|I|$。电压计前端可被建模为具有输入参考的白电压噪声谱密度 $S_{v}$（均方根每平方根赫兹）和一个由驱动频率附近的同步检波设定的测量带宽 $B$。为提高精度，对解调后的电压进行了 $N$ 次统计独立的平均，这降低了平均估计中的噪声。\n\n假设一次胸腔 EIT 边界测量使用以下科学上典型且自洽的参数：\n- 驱动电流幅值 $I = 1.0~\\mathrm{mA}$ (RMS)。\n- 转移阻抗模 $|Z_{t}| = 0.200~\\Omega$。\n- 电压计输入参考白噪声谱密度 $S_{v} = 100~\\mathrm{nV}/\\sqrt{\\mathrm{Hz}}$ (RMS)。\n- 测量带宽 $B = 200~\\mathrm{Hz}$。\n- 独立平均次数 $N = 100$。\n\n从第一性原理出发——即欧姆定律、信噪比 (SNR) 的定义、白噪声谱密度与带宽内积分均方根噪声之间的关系，以及通过平均使均方根噪声改善 $\\sqrt{N}$ 倍的原理——完成以下任务：\n\n1. 使用给定的 $I$ 和 $|Z_{t}|$ 所隐含的信号幅值，以及 $S_{v}$ 和 $B$ 所隐含的均方根噪声，计算单次测量情况（此部分取 $N=1$）下的信噪比 (SNR)。以分贝表示该信噪比。\n\n2. 从第一性原理推导，当使用 $N$ 次平均时，最小可检测转移阻抗变化 $|\\Delta Z_{\\min}|$ 的闭式表达式，其定义为：使得相应信号幅值等于平均后均方根噪声的最小 $|\\Delta Z|$。然后，使用给定的 $I$、$S_{v}$、$B$ 和 $N=100$ 对此表达式进行数值计算。\n\n将您的最终数值结果四舍五入至四位有效数字。以分贝表示信噪比，以微欧姆表示最小可检测转移阻抗变化。",
            "solution": "该问题经验证具有科学依据、适定且客观。它基于电气工程和信号处理的既定原理，包含所有必要信息，并且没有歧义。\n\n解答按要求分为两部分。\n\n### 第1部分：单次测量的信噪比 (SNR)\n\n此部分要求计算单次测量（平均次数 $N=1$）下的信噪比 (SNR)（以分贝为单位）。计算从第一性原理出发。\n\n**1. 信号幅值计算**\n信号是在测量电极上产生的均方根电压 $|V|$。根据应用于阻抗的欧姆定律，该电压是均方根驱动电流的模 $|I|$ 与转移阻抗的模 $|Z_t|$ 的乘积。\n$$|V| = |I| |Z_t|$$\n使用给定值：\n-   驱动电流幅值 $|I| = 1.0~\\mathrm{mA} = 1.0 \\times 10^{-3}~\\mathrm{A}$。\n-   转移阻抗模 $|Z_t| = 0.200~\\Omega$。\n\n信号的均方根电压为：\n$$|V| = (1.0 \\times 10^{-3}~\\mathrm{A}) \\times (0.200~\\Omega) = 0.200 \\times 10^{-3}~\\mathrm{V} = 2.00 \\times 10^{-4}~\\mathrm{V}$$\n\n**2. 噪声幅值计算**\n噪声被建模为具有谱密度 $S_v$ 的输入参考白电压噪声。在测量带宽 $B$ 内的总均方根噪声电压 $V_{n, \\mathrm{rms}}$ 由以下关系式给出：\n$$V_{n, \\mathrm{rms}} = S_v \\sqrt{B}$$\n使用给定值：\n-   噪声谱密度 $S_v = 100~\\mathrm{nV}/\\sqrt{\\mathrm{Hz}} = 1.00 \\times 10^{-7}~\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$。\n-   测量带宽 $B = 200~\\mathrm{Hz}$。\n\n单次测量 ($N=1$) 的均方根噪声电压为：\n$$V_{n, \\mathrm{rms}} = (1.00 \\times 10^{-7}~\\mathrm{V}/\\sqrt{\\mathrm{Hz}}) \\times \\sqrt{200~\\mathrm{Hz}} = 1.00 \\times 10^{-7} \\times 10\\sqrt{2}~\\mathrm{V} = \\sqrt{2} \\times 10^{-6}~\\mathrm{V}$$\n数值上，这大约是 $V_{n, \\mathrm{rms}} \\approx 1.4142 \\times 10^{-6}~\\mathrm{V}$。\n\n**3. SNR 计算**\n信噪比 (SNR) 定义为信号功率与噪声功率之比。对于在相同阻抗上测量的电压信号，这等效于其均方根幅值之比的平方。然而，信号处理中的一个通用惯例（我们在此处采用）是将 SNR 表示为均方根信号幅值与均方根噪声幅值之比。\n$$\\mathrm{SNR}_{\\mathrm{amp}} = \\frac{|V|}{V_{n, \\mathrm{rms}}}$$\n代入计算出的信号和噪声幅值：\n$$\\mathrm{SNR}_{\\mathrm{amp}} = \\frac{2.00 \\times 10^{-4}~\\mathrm{V}}{\\sqrt{2} \\times 10^{-6}~\\mathrm{V}} = \\frac{2.00 \\times 10^2}{\\sqrt{2}} = 100\\sqrt{2}$$\n数值上，$\\mathrm{SNR}_{\\mathrm{amp}} \\approx 141.42$。\n\n**4. 转换为分贝 (dB)**\n要求以分贝 ($\\mathrm{dB}$) 表示 SNR。从幅值比到分贝的转换由下式给出：\n$$\\mathrm{SNR}_{\\mathrm{dB}} = 20 \\log_{10}(\\mathrm{SNR}_{\\mathrm{amp}})$$\n代入 $\\mathrm{SNR}_{\\mathrm{amp}}$ 的表达式：\n$$\\mathrm{SNR}_{\\mathrm{dB}} = 20 \\log_{10}(100\\sqrt{2}) = 20 \\left( \\log_{10}(10^2) + \\log_{10}(2^{1/2}) \\right)$$\n$$\\mathrm{SNR}_{\\mathrm{dB}} = 20 \\left( 2 + \\frac{1}{2}\\log_{10}(2) \\right) = 40 + 10\\log_{10}(2)$$\n使用近似值 $\\log_{10}(2) \\approx 0.30103$：\n$$\\mathrm{SNR}_{\\mathrm{dB}} \\approx 40 + 10 \\times 0.30103 = 40 + 3.0103 = 43.0103~\\mathrm{dB}$$\n四舍五入到四位有效数字，单次测量的 SNR 为 $43.01~\\mathrm{dB}$。\n\n### 第2部分：最小可检测转移阻抗变化\n\n此部分要求推导最小可检测转移阻抗变化 $|\\Delta Z_{\\min}|$ 的表达式，并对其进行数值计算。\n\n**1. 表达式推导**\n对于此检测问题，我们关注的信号是由转移阻抗的微小变化 $|\\Delta Z|$ 引起的电压变化 $|\\Delta V|$。根据欧姆定律，假设驱动电流 $|I|$ 恒定，该关系为：\n$$|\\Delta V| = |I| |\\Delta Z|$$\n限制该信号检测的噪声是平均后的均方根噪声电压 $V_{n, \\mathrm{avg}}$。对电压进行 $N$ 次统计独立的平均，可使均方根噪声降低 $\\sqrt{N}$ 倍：\n$$V_{n, \\mathrm{avg}} = \\frac{V_{n, \\mathrm{rms}}}{\\sqrt{N}} = \\frac{S_v \\sqrt{B}}{\\sqrt{N}}$$\n最小可检测变化定义为信号幅值等于平均后噪声幅值的条件，即当变化的信噪比为1时。\n$$|\\Delta V|_{\\min} = V_{n, \\mathrm{avg}}$$\n代入电压变化和平均后噪声的表达式：\n$$|I| |\\Delta Z|_{\\min} = \\frac{S_v \\sqrt{B}}{\\sqrt{N}}$$\n求解最小可检测转移阻抗变化 $|\\Delta Z|_{\\min}$，得到闭式表达式：\n$$|\\Delta Z|_{\\min} = \\frac{S_v \\sqrt{B}}{|I| \\sqrt{N}}$$\n\n**2. 数值计算**\n我们有以下给定参数：\n-   $S_v = 1.00 \\times 10^{-7}~\\mathrm{V}/\\sqrt{\\mathrm{Hz}}$\n-   $B = 200~\\mathrm{Hz}$\n-   $|I| = 1.0 \\times 10^{-3}~\\mathrm{A}$\n-   $N = 100$\n\n将这些值代入推导出的表达式：\n$$|\\Delta Z|_{\\min} = \\frac{(1.00 \\times 10^{-7}~\\mathrm{V}/\\sqrt{\\mathrm{Hz}}) \\sqrt{200~\\mathrm{Hz}}}{(1.0 \\times 10^{-3}~\\mathrm{A}) \\sqrt{100}} = \\frac{(1.00 \\times 10^{-7}) \\times 10\\sqrt{2}}{(1.0 \\times 10^{-3}) \\times 10}~\\Omega = \\frac{\\sqrt{2} \\times 10^{-6}}{10^{-2}}~\\Omega = \\sqrt{2} \\times 10^{-4}~\\Omega$$\n数值上，这约等于 $1.41421356 \\times 10^{-4}~\\Omega$。\n问题要求结果以微欧姆 ($\\mu\\Omega$) 为单位。转换关系为 $1~\\Omega = 10^6~\\mu\\Omega$。\n$$|\\Delta Z|_{\\min} \\approx (1.41421356 \\times 10^{-4}) \\times 10^6~\\mu\\Omega = 141.421356~\\mu\\Omega$$\n四舍五入到四位有效数字，最小可检测转移阻抗变化为 $141.4~\\mu\\Omega$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 43.01  141.4 \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然简单的模型将生物组织和电极视为纯电阻，但真实的生物界面要复杂得多，尤其是在多频 EIT 应用中。本练习挑战您使用复阻抗来模拟电极-皮肤界面，通过推导所测电压与注入电流之间的相移，您将理解这些界面效应如何体现在测量数据中，以及为何精确建模对于准确成像至关重要。",
            "id": "4881481",
            "problem": "一个电阻抗断层成像 (EIT) 系统使用 $2$ 个电极，通过一个均匀的组织板驱动角频率为 $\\omega$ 的正弦电流，并测量复转移阻抗 $Z_{\\mathrm{tr}}(\\omega)$，该阻抗定义为电压相量与电流相量之比。假设组织是各向同性、均匀的，并且表现为电极之间的纯电阻体，其电阻为 $R_{t}$。每个电极-皮肤界面被建模为一个线性时不变元件，其阻抗由于双电层电容而依赖于频率，并由一个接触电阻 $r_{\\ell}$ 和一个电容 $c_{\\ell}$ 串联表示。因此，单个电极的阻抗为 $z_{\\ell}(\\omega)$，来自 $2$ 个电极的总界面贡献必须包含在测量的转移阻抗中。\n\n使用复阻抗、频域中的欧姆定律以及电容器阻抗的定义，从第一性原理推导出一个闭式解析表达式，用于表示测量电压和注入电流之间与频率相关的相移 $\\phi(\\omega)$（以弧度为单位）。你的表达式必须仅用 $\\omega$、$R_{t}$、$r_{\\ell}$ 和 $c_{\\ell}$ 表示，并且必须在所述的建模假设下有效。将你的最终答案表示为 $\\phi(\\omega)$（以弧度为单位）的单个闭式解析表达式。",
            "solution": "在尝试求解之前，需对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统：** 电阻抗断层成像 (EIT)\n- **电流：** 正弦波，角频率为 $\\omega$。\n- **电极：** 使用 $2$ 个电极。\n- **测量量：** 复转移阻抗 $Z_{\\mathrm{tr}}(\\omega)$，定义为电压相量与电流相量之比。\n- **组织模型：** 各向同性、均匀的纯电阻体，电极之间的电阻为 $R_{t}$。\n- **电极-皮肤界面模型：** 一个线性时不变元件，单个电极的阻抗为 $z_{\\ell}(\\omega)$。该阻抗被指定为接触电阻 $r_{\\ell}$ 和电容 $c_{\\ell}$ 的串联组合。\n- **总阻抗：** 测量值包括来自两个电极的贡献。\n- **目标：** 推导一个闭式解析表达式，用于表示测量电压和注入电流之间与频率相关的相移 $\\phi(\\omega)$（以弧度为单位）。\n- **表达式约束：** 表达式必须仅用 $\\omega$、$R_{t}$、$r_{\\ell}$ 和 $c_{\\ell}$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于电路理论的原理，特别是使用复阻抗的交流电路分析。将生物组织建模为电阻，将电极-皮肤界面建模为串联 RC 电路，是生物阻抗研究中一个标准且物理上有效的一阶近似。该问题没有违反任何科学定律或数学逻辑。\n- **适定性：** 该问题是适定的。它提供了电路模型的完整描述以及推导相移唯一表达式所需的所有必要参数（$\\omega$、$R_{t}$、$r_{\\ell}$ 和 $c_{\\ell}$）。\n- **客观性：** 该问题使用物理学和电气工程中精确、客观和标准的术语进行陈述。没有主观或模棱两可的陈述。\n\n**步骤 3：结论与行动**\n该问题在科学上是合理的、自洽的且适定的。它被判定为 **有效**。将按要求从第一性原理推导解决方案。\n\n### 解答推导\n\n该问题要求推导总测量转移阻抗 $Z_{\\mathrm{tr}}(\\omega)$ 的相移 $\\phi(\\omega)$。总阻抗由三个串联元件组成：第一个电极-皮肤界面、体组织和第二个电极-皮肤界面。\n\n首先，我们定义单个电极-皮肤界面的阻抗 $z_{\\ell}(\\omega)$。问题陈述这是一个接触电阻 $r_{\\ell}$ 和一个电容 $c_{\\ell}$ 的串联组合。\n\n电阻器的阻抗就是其电阻，这是一个实数。因此，接触电阻的阻抗是 $r_{\\ell}$。\n\n在角频率为 $\\omega$ 时，电容为 $c_{\\ell}$ 的电容器的阻抗是一个复数量，由下式给出：\n$$\nZ_{c} = \\frac{1}{j \\omega c_{\\ell}}\n$$\n其中 $j$ 是虚数单位，定义为 $j = \\sqrt{-1}$。\n\n由于单个电极界面的电阻 $r_{\\ell}$ 和电容 $c_{\\ell}$ 是串联的，它们的阻抗相加。一个电极的阻抗 $z_{\\ell}(\\omega)$ 是：\n$$\nz_{\\ell}(\\omega) = r_{\\ell} + \\frac{1}{j \\omega c_{\\ell}}\n$$\n\n总电路由第一个电极、组织体和第二个电极串联而成。因此，总转移阻抗 $Z_{\\mathrm{tr}}(\\omega)$ 是它们各自阻抗之和：\n$$\nZ_{\\mathrm{tr}}(\\omega) = z_{\\ell}(\\omega) + R_{t} + z_{\\ell}(\\omega)\n$$\n其中 $R_{t}$ 是纯电阻组织体的阻抗。\n\n代入 $z_{\\ell}(\\omega)$ 的表达式，我们得到：\n$$\nZ_{\\mathrm{tr}}(\\omega) = 2 z_{\\ell}(\\omega) + R_{t} = 2 \\left( r_{\\ell} + \\frac{1}{j \\omega c_{\\ell}} \\right) + R_{t}\n$$\n$$\nZ_{\\mathrm{tr}}(\\omega) = 2r_{\\ell} + \\frac{2}{j \\omega c_{\\ell}} + R_{t}\n$$\n\n为了求出相移，我们必须首先将复阻抗 $Z_{\\mathrm{tr}}(\\omega)$ 表示为其直角坐标形式 $Z = \\mathrm{Re}(Z) + j \\mathrm{Im}(Z)$。我们使用恒等式 $\\frac{1}{j} = -j$：\n$$\nZ_{\\mathrm{tr}}(\\omega) = (R_{t} + 2r_{\\ell}) + \\frac{2}{j \\omega c_{\\ell}} = (R_{t} + 2r_{\\ell}) - j \\frac{2}{\\omega c_{\\ell}}\n$$\n\n从这个形式，我们可以确定总转移阻抗的实部和虚部：\n实部是 $\\mathrm{Re}(Z_{\\mathrm{tr}}(\\omega)) = R_{t} + 2r_{\\ell}$。\n虚部是 $\\mathrm{Im}(Z_{\\mathrm{tr}}(\\omega)) = -\\frac{2}{\\omega c_{\\ell}}$。\n\n相移 $\\phi(\\omega)$ 是复阻抗 $Z_{\\mathrm{tr}}(\\omega)$ 的辐角。对于复数 $Z = x+jy$，其辐角由 $\\phi = \\arctan\\left(\\frac{y}{x}\\right)$ 给出。将此应用于我们对 $Z_{\\mathrm{tr}}(\\omega)$ 的表达式：\n$$\n\\phi(\\omega) = \\arctan\\left( \\frac{\\mathrm{Im}(Z_{\\mathrm{tr}}(\\omega))}{\\mathrm{Re}(Z_{\\mathrm{tr}}(\\omega))} \\right)\n$$\n$$\n\\phi(\\omega) = \\arctan\\left( \\frac{-\\frac{2}{\\omega c_{\\ell}}}{R_{t} + 2r_{\\ell}} \\right)\n$$\n简化反正切函数的自变量：\n$$\n\\phi(\\omega) = \\arctan\\left( -\\frac{2}{\\omega c_{\\ell} (R_{t} + 2r_{\\ell})} \\right)\n$$\n使用反正切函数的性质 $\\arctan(-x) = -\\arctan(x)$，我们可以将相移的最终表达式写为：\n$$\n\\phi(\\omega) = -\\arctan\\left( \\frac{2}{\\omega c_{\\ell} (R_{t} + 2r_{\\ell})} \\right)\n$$\n这就是所要求的相移 $\\phi(\\omega)$（以弧度为单位）的闭式解析表达式，仅用给定参数 $\\omega$、$R_{t}$、$r_{\\ell}$ 和 $c_{\\ell}$ 表示。",
            "answer": "$$\n\\boxed{-\\arctan\\left(\\frac{2}{\\omega c_{\\ell}(R_t + 2r_{\\ell})}\\right)}\n$$"
        },
        {
            "introduction": "EIT 的最终目标是从边界测量中重建内部电导率的图像，这是一个极具挑战性的“反问题”。现代重建方法依赖于先进的优化技术，如全变分（Total Variation, TV）正则化，它能在数据保真度和图像先验知识之间取得平衡。本练习将带您深入探索一种前沿重建算法的数学基础，通过推导原始-对偶方法的关键步骤，您将洞悉原始电压数据是如何被转化为有意义的医学图像的。",
            "id": "4881506",
            "problem": "在电阻抗断层成像 (EIT) 中，电导率的微小扰动可以通过一个线性化正演模型与边界电压的变化联系起来。令 $x \\in \\mathbb{R}^{n}$ 表示离散化的电导率扰动，$y \\in \\mathbb{R}^{m}$ 表示测量的边界电压差，$A \\in \\mathbb{R}^{m \\times n}$ 表示正演映射的线性化灵敏度（雅可比）矩阵。假设存在协方差为 $\\Sigma \\in \\mathbb{R}^{m \\times m}$ 的加性高斯噪声，并定义权重 $W \\coloneqq \\Sigma^{-1} \\succ 0$。考虑全变分 (TV) 正则化重建\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2}\\|A x - y\\|_{W}^{2} + \\lambda \\|\\nabla x\\|_{2,1},\n$$\n其中 $\\|v\\|_{W}^{2} \\coloneqq v^{\\top} W v$，$\\lambda > 0$ 是正则化参数，$\\nabla$ 是离散梯度算子，$\\|\\cdot\\|_{2,1}$ 表示每个像素或单元处梯度的欧几里得范数之和。令 $K \\coloneqq \\nabla$，$f(u) \\coloneqq \\lambda \\|u\\|_{2,1}$，以及 $g(x) \\coloneqq \\frac{1}{2}\\|A x - y\\|_{W}^{2}$，因此该问题具有 $\\min_{x} \\ g(x) + f(K x)$ 的形式。\n\n使用基于凸共轭、邻近算子和原始-对偶鞍点公式定义的第一性原理推导，执行以下操作：\n\n1) 写出与原始目标相关的鞍点问题，并推导 Chambolle–Pock 类型的原始-对偶迭代，确定每次迭代中必须计算的两个邻近映射。\n\n2) 根据定义推导数据保真项的邻近映射的显式形式，\n$$\n\\operatorname{prox}_{\\tau g}(z) \\coloneqq \\arg\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2}\\|x - z\\|_{2}^{2} + \\tau \\,\\frac{1}{2}\\|A x - y\\|_{W}^{2},\n$$\n并用 $A$、$W$、$y$、$z$ 和 $\\tau > 0$ 表示其闭式解。\n\n3) 根据定义推导对偶更新所需的邻近映射的显式形式，\n$$\n\\operatorname{prox}_{\\sigma f^{*}}(q) \\coloneqq \\arg\\min_{p} \\ \\frac{1}{2}\\|p - q\\|_{2}^{2} + \\sigma \\, f^{*}(p),\n$$\n其中 $f^{*}$ 是 $f$ 的凸共轭，$\\sigma > 0$。以对梯度场块的逐点操作形式提供表达式。\n\n4) 对于一个具有 $n=4$ 个节点和前向差分梯度\n$$\nK = \\nabla = \\begin{bmatrix}\n-1  1  0  0 \\\\\n0  -1  1  0 \\\\\n0  0  -1  1\n\\end{bmatrix},\n$$\n的特例一维 EIT 离散化，取 $\\sigma=0.5$ 并计算收敛步长界\n$$\n\\tau_{\\mathrm{bound}} \\coloneqq \\frac{1}{\\sigma \\, \\|K\\|_{2}^{2}},\n$$\n其中 $\\|\\cdot\\|_{2}$ 表示谱范数。将您的答案四舍五入到四位有效数字。报告一个无单位的值。",
            "solution": "按要求分四部分对问题进行分析和求解。\n\n### 第 1 部分：鞍点问题和原始-对偶迭代\n\n原始问题由下式给出\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ g(x) + f(K x),\n$$\n其中 $g(x) = \\frac{1}{2}\\|A x - y\\|_{W}^{2}$ 且 $f(u) = \\lambda \\|u\\|_{2,1}$。\n\n为了推导鞍点公式，我们使用 $f$ 的凸共轭的定义，记作 $f^*$。函数 $f(u)$ 可以写成其双共轭形式，$f(u) = f^{**}(u) = \\sup_{p} \\{ \\langle u, p \\rangle - f^*(p) \\}$。将此代入原始目标函数中，得到：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ g(x) + \\sup_{p} \\{ \\langle K x, p \\rangle - f^*(p) \\}\n$$\n我们可以交换 min 和 sup 算子（由于此处满足凸性和适定性假设）以获得鞍点问题：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\sup_{p} \\ \\{ g(x) + \\langle K x, p \\rangle - f^*(p) \\}\n$$\n相关的拉格朗日量是 $\\mathcal{L}(x, p) = g(x) + \\langle K x, p \\rangle - f^*(p)$。\n\nChambolle–Pock 算法是一种用于解决此类鞍点问题的原始-对偶方法。它包括关于原始变量 $x$ 的交替最小化步骤和关于对偶变量 $p$ 的最大化步骤。给定步长 $\\tau > 0$ 和 $\\sigma > 0$，以及外插参数 $\\theta \\in [0, 1]$（通常 $\\theta = 1$），迭代过程如下：\n\n1.  对偶更新：$p^{k+1} = \\arg\\max_{p} \\{ \\langle K \\bar{x}^{k}, p \\rangle - f^*(p) - \\frac{1}{2\\sigma}\\|p - p^k\\|_2^2 \\}$\n2.  原始更新：$x^{k+1} = \\arg\\min_{x} \\{ g(x) + \\langle K x, p^{k+1} \\rangle + \\frac{1}{2\\tau}\\|x - x^k\\|_2^2 \\}$\n3.  外插：$\\bar{x}^{k+1} = x^{k+1} + \\theta(x^{k+1} - x^k)$\n\n通过配方法，这些更新可以用邻近算子来表示。\n对偶更新变为：\n$$\np^{k+1} = \\arg\\min_{p} \\{ \\sigma f^*(p) + \\frac{1}{2}\\|p - (p^k + \\sigma K \\bar{x}^k)\\|_2^2 \\} = \\operatorname{prox}_{\\sigma f^*} (p^k + \\sigma K \\bar{x}^k)\n$$\n原始更新，使用 $\\langle Kx, p \\rangle = \\langle x, K^\\top p \\rangle$，变为：\n$$\nx^{k+1} = \\arg\\min_{x} \\{ \\tau g(x) + \\frac{1}{2}\\|x - (x^k - \\tau K^\\top p^{k+1})\\|_2^2 \\} = \\operatorname{prox}_{\\tau g} (x^k - \\tau K^\\top p^{k+1})\n$$\n每次迭代中必须计算的两个邻近映射是用于原始变量更新的 $\\operatorname{prox}_{\\tau g}(\\cdot)$ 和用于对偶变量更新的 $\\operatorname{prox}_{\\sigma f^*}(\\cdot)$。\n\n### 第 2 部分：数据保真项的邻近映射\n\n我们被要求推导 $\\operatorname{prox}_{\\tau g}(z)$ 的显式形式，其定义为：\n$$\n\\operatorname{prox}_{\\tau g}(z) = \\arg\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2}\\|x - z\\|_{2}^{2} + \\tau g(x)\n$$\n代入 $g(x) = \\frac{1}{2}\\|A x - y\\|_{W}^{2}$ 的定义，要最小化的目标函数是：\n$$\nL(x) = \\frac{1}{2}\\|x - z\\|_{2}^{2} + \\frac{\\tau}{2}\\|A x - y\\|_{W}^{2} = \\frac{1}{2}(x - z)^{\\top}(x - z) + \\frac{\\tau}{2}(A x - y)^{\\top} W (A x - y)\n$$\n这是一个关于 $x$ 的凸二次函数。通过将关于 $x$ 的梯度设为零来找到最小值。\n$$\n\\nabla_x L(x) = (x - z) + \\tau A^{\\top} W (A x - y) = 0\n$$\n重新整理各项以求解 $x$：\n$$\nx - z + \\tau A^{\\top} W A x - \\tau A^{\\top} W y = 0\n$$\n$$\n(I + \\tau A^{\\top} W A) x = z + \\tau A^{\\top} W y\n$$\n矩阵 $(I + \\tau A^{\\top} W A)$ 是可逆的。由于 $W \\succ 0$，矩阵 $A^{\\top} W A$ 是半正定的。单位矩阵 $I$ 是正定的。因此，它们的和是正定的，因而是可逆的。\n邻近映射的闭式表达式为：\n$$\n\\operatorname{prox}_{\\tau g}(z) = (I + \\tau A^{\\top} W A)^{-1} (z + \\tau A^{\\top} W y)\n$$\n\n### 第 3 部分：对偶更新的邻近映射\n\n我们需要推导 $\\operatorname{prox}_{\\sigma f^{*}}(q)$ 的显式形式，其中 $f^{*}$ 是 $f(u) = \\lambda \\|u\\|_{2,1}$ 的凸共轭。符号 $\\|\\cdot\\|_{2,1}$ 意味着向量 $u$ 是较小向量块 $u = (u_i)_{i=1}^N$ 的拼接，且 $\\|u\\|_{2,1} = \\sum_{i=1}^N \\|u_i\\|_2$。因此，$f(u) = \\lambda \\sum_{i=1}^N \\|u_i\\|_2$。\n\n函数 $f$ 关于块 $u_i$ 是可分的。因此，其凸共轭 $f^*(p)$ 也关于相应的块 $p_i$ 是可分的：\n$$\nf^*(p) = \\sum_{i=1}^N (\\lambda \\|\\cdot\\|_2)^*(p_i)\n$$\n让我们计算单个块 $v$ 的 $h(v) = \\lambda \\|v\\|_2$ 的共轭。\n$$\nh^*(q) = \\sup_{v} \\{ \\langle q, v \\rangle - \\lambda \\|v\\|_2 \\}\n$$\n如果 $\\|q\\|_2 > \\lambda$，我们可以选择 $v = \\alpha q$ 且 $\\alpha \\to \\infty$，使得表达式任意大。因此，$h^*(q) = +\\infty$。\n如果 $\\|q\\|_2 \\le \\lambda$，根据柯西-施瓦茨不等式，$\\langle q, v \\rangle \\le \\|q\\|_2 \\|v\\|_2$。所以，$\\langle q, v \\rangle - \\lambda \\|v\\|_2 \\le (\\|q\\|_2 - \\lambda)\\|v\\|_2 \\le 0$。上确界为 0，在 $v=0$ 处取得。\n因此，$h^*(q)$ 是半径为 $\\lambda$ 的闭 $\\ell_2$-球的指示函数：\n$$\nh^*(q) = \\mathcal{I}_{\\{v: \\|v\\|_2 \\le \\lambda\\}}(q) = \\begin{cases} 0  \\text{若 } \\|q\\|_2 \\le \\lambda \\\\ +\\infty  \\text{若 } \\|q\\|_2 > \\lambda \\end{cases}\n$$\n所以，$f^*(p) = \\sum_{i=1}^N \\mathcal{I}_{\\{p_i: \\|p_i\\|_2 \\le \\lambda\\}}(p_i)$。\n\n现在我们可以计算邻近算子：\n$$\n\\operatorname{prox}_{\\sigma f^{*}}(q) = \\arg\\min_{p} \\ \\frac{1}{2}\\|p - q\\|_{2}^{2} + \\sigma \\, f^{*}(p)\n$$\n由于目标函数中的两项都可以在块 $p_i$ 上分离，因此可以对每个块独立进行最小化：\n$$\n(\\operatorname{prox}_{\\sigma f^{*}}(q))_i = \\arg\\min_{p_i} \\ \\frac{1}{2}\\|p_i - q_i\\|_{2}^{2} + \\sigma \\, \\mathcal{I}_{\\{v: \\|v\\|_2 \\le \\lambda\\}}(p_i)\n$$\n这等价于在约束 $\\|p_i\\|_2 \\le \\lambda$ 下，找到使与 $q_i$ 的欧几里得距离的平方最小化的点 $p_i$。这是 $q_i$ 在半径为 $\\lambda$ 的 $\\ell_2$-球上的欧几里得投影。\n投影由下式给出：\n$$\n(\\operatorname{prox}_{\\sigma f^{*}}(q))_i = \\begin{cases} q_i  \\text{若 } \\|q_i\\|_2 \\le \\lambda \\\\ \\lambda \\frac{q_i}{\\|q_i\\|_2}  \\text{若 } \\|q_i\\|_2 > \\lambda \\end{cases}\n$$\n这可以紧凑地写成对每个梯度块 $q_i$ 的逐点操作：\n$$\n(\\operatorname{prox}_{\\sigma f^{*}}(q))_i = q_i \\cdot \\min\\left(1, \\frac{\\lambda}{\\|q_i\\|_2}\\right) = \\frac{q_i}{\\max\\left(1, \\frac{\\|q_i\\|_2}{\\lambda}\\right)}\n$$\n\n### 第 4 部分：步长界计算\n\n我们被要求计算给定 $K$ 和 $\\sigma$ 下的 $\\tau_{\\mathrm{bound}} = \\frac{1}{\\sigma \\, \\|K\\|_{2}^{2}}$。\n矩阵为 $K = \\begin{bmatrix} -1  1  0  0 \\\\ 0  -1  1  0 \\\\ 0  0  -1  1 \\end{bmatrix}$ 且 $\\sigma = 0.5$。\n谱范数 $\\|K\\|_2$ 是 $K^{\\top}K$ 的最大特征值的平方根。\n首先，我们计算 $K^{\\top}K$：\n$$\nK^{\\top}K = \\begin{bmatrix} -1  0  0 \\\\ 1  -1  0 \\\\ 0  1  -1 \\\\ 0  0  1 \\end{bmatrix} \\begin{bmatrix} -1  1  0  0 \\\\ 0  -1  1  0 \\\\ 0  0  -1  1 \\end{bmatrix} = \\begin{bmatrix} 1  -1  0  0 \\\\ -1  2  -1  0 \\\\ 0  -1  2  -1 \\\\ 0  0  -1  1 \\end{bmatrix}\n$$\n这是路径图 $P_4$ 的 $4 \\times 4$ 图拉普拉斯矩阵，它对应于具有诺伊曼边界条件的一维离散拉普拉斯算子。这种形式的 $n \\times n$ 矩阵的特征值由公式 $\\lambda_j = 2 - 2\\cos\\left(\\frac{(j-1)\\pi}{n}\\right)$ 给出，$j = 1, \\dots, n$。对于 $n=4$：\n\\begin{itemize}\n    \\item $j=1$: $\\lambda_1 = 2 - 2\\cos(0) = 2 - 2 = 0$。\n    \\item $j=2$: $\\lambda_2 = 2 - 2\\cos(\\pi/4) = 2 - 2(\\frac{\\sqrt{2}}{2}) = 2 - \\sqrt{2}$。\n    \\item $j=3$: $\\lambda_3 = 2 - 2\\cos(2\\pi/4) = 2 - 2\\cos(\\pi/2) = 2 - 0 = 2$。\n    \\item $j=4$: $\\lambda_4 = 2 - 2\\cos(3\\pi/4) = 2 - 2(-\\frac{\\sqrt{2}}{2}) = 2 + \\sqrt{2}$。\n\\end{itemize}\n$K^{\\top}K$ 的特征值是 $\\{0, 2-\\sqrt{2}, 2, 2+\\sqrt{2}\\}$。最大特征值是 $\\lambda_{\\max}(K^{\\top}K) = 2 + \\sqrt{2}$。\n$K$ 的谱范数的平方是 $\\|K\\|_2^2 = \\lambda_{\\max}(K^{\\top}K) = 2 + \\sqrt{2}$。\n现在我们可以计算步长界：\n$$\n\\tau_{\\mathrm{bound}} = \\frac{1}{\\sigma \\|K\\|_{2}^{2}} = \\frac{1}{0.5 \\times (2 + \\sqrt{2})} = \\frac{2}{2 + \\sqrt{2}}\n$$\n为了简化表达式，我们将分子和分母同乘以分母的共轭：\n$$\n\\tau_{\\mathrm{bound}} = \\frac{2(2 - \\sqrt{2})}{(2 + \\sqrt{2})(2 - \\sqrt{2})} = \\frac{2(2 - \\sqrt{2})}{4 - 2} = \\frac{2(2 - \\sqrt{2})}{2} = 2 - \\sqrt{2}\n$$\n为了获得数值，我们使用 $\\sqrt{2} \\approx 1.41421356...$：\n$$\n\\tau_{\\mathrm{bound}} \\approx 2 - 1.41421356 = 0.58578644\n$$\n四舍五入到四位有效数字，我们得到 $0.5858$。",
            "answer": "$$\\boxed{0.5858}$$"
        }
    ]
}