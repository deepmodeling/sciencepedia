{
    "hands_on_practices": [
        {
            "introduction": "放射组学分析的第一步通常是对感兴趣区域（ROI）的宏观形态进行量化。球形度是一个重要的三维形状特征，它衡量病灶的形状与完美球体的接近程度，因为不规则或非球形的形态往往与特定的生物学行为相关。通过这个练习，你将从第一性原理出发，推导并计算一个给定体积和表面积的病灶的球形度，从而将抽象的几何公式与肿瘤形态的量化评估联系起来。",
            "id": "4917043",
            "problem": "放射组学中使用的与紧凑性相关的形状描述符是球形度特征，它量化了分割出的病变与完美球体的接近程度。考虑一个从计算机断层扫描（CT）中分割出的病变，其体积测量为 $V = 20 \\text{ cm}^{3}$，表面积测量为 $A = 60 \\text{ cm}^{2}$。使用图像生物标志物标准化倡议（Image Biomarker Standardisation Initiative, IBSI）对球形度的定义，即具有相同体积的球体的表面积与病变表面积之比，仅从球体的几何关系（即 $V_{\\text{sphere}} = \\frac{4}{3}\\pi r^{3}$ 和 $A_{\\text{sphere}} = 4\\pi r^{2}$）出发，从第一性原理推导出球形度。然后将与完美球体的偏差定义为 $d = 1 - \\text{sphericity}$，并计算该病变的 $d$ 值。将最终偏差表示为一个无单位的十进制数，并将您的答案四舍五入到四位有效数字。在最终答案中仅报告偏差 $d$。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、定义明确的、客观的和完整的。所有提供的数据和定义都与已建立的几何学原理及其在医学影像领域（特别是放射组学）中的应用相一致。因此，将开始解题过程。\n\n目标是计算给定体积和表面积的病变的球形度偏差，记为 $d$。偏差定义为 $d = 1 - \\text{sphericity}$。第一步是根据所提供的定义和第一性原理，推导出球形度 $\\psi$ 的表达式。\n\n根据问题中给出的图像生物标志物标准化倡议（Image Biomarker Standardisation Initiative, IBSI）的定义，球形度是与病变体积相同的球体的表面积与病变实际表面积之比。设病变的体积为 $V$，表面积为 $A$。设 $A_{s,V}$ 是体积等于 $V$ 的球体的表面积。因此，球形度 $\\psi$ 由下式给出：\n$$\n\\psi = \\frac{A_{s,V}}{A}\n$$\n问题提供了半径为 $r$ 的球体的基本几何关系：\n体积：$V_{\\text{sphere}} = \\frac{4}{3}\\pi r^{3}$\n表面积：$A_{\\text{sphere}} = 4\\pi r^{2}$\n\n为了求得 $A_{s,V}$，我们必须首先确定体积为 $V$ 的球体的半径。令 $V_{\\text{sphere}} = V$，我们求解半径 $r$：\n$$\nV = \\frac{4}{3}\\pi r^{3}\n$$\n$$\nr^{3} = \\frac{3V}{4\\pi}\n$$\n$$\nr = \\left(\\frac{3V}{4\\pi}\\right)^{1/3}\n$$\n这个表达式给出了体积为 $V$ 的球体的半径。现在，我们用这个半径来求这个球体的表面积 $A_{s,V}$：\n$$\nA_{s,V} = 4\\pi r^{2} = 4\\pi \\left[ \\left(\\frac{3V}{4\\pi}\\right)^{1/3} \\right]^{2}\n$$\n$$\nA_{s,V} = 4\\pi \\left(\\frac{3V}{4\\pi}\\right)^{2/3}\n$$\n我们可以通过处理常数来简化这个表达式：\n$$\nA_{s,V} = \\frac{4\\pi}{(4\\pi)^{2/3}} (3V)^{2/3} = (4\\pi)^{1 - 2/3} (3V)^{2/3} = (4\\pi)^{1/3} (3V)^{2/3}\n$$\n$$\nA_{s,V} = (4\\pi)^{1/3} (3^{2}V^{2})^{1/3} = (4\\pi \\cdot 9V^{2})^{1/3} = (36\\pi V^{2})^{1/3}\n$$\n这是用体积表示的球体表面积的通用公式。\n\n现在我们可以写出球形度 $\\psi$ 的完整表达式：\n$$\n\\psi = \\frac{(36\\pi V^{2})^{1/3}}{A}\n$$\n问题为病变提供了以下数值：\n体积，$V = 20 \\text{ cm}^{3}$\n表面积，$A = 60 \\text{ cm}^{2}$\n\n将这些值代入球形度公式：\n$$\n\\psi = \\frac{(36\\pi (20)^{2})^{1/3}}{60} = \\frac{(36\\pi \\cdot 400)^{1/3}}{60} = \\frac{(14400\\pi)^{1/3}}{60}\n$$\n我们计算其数值：\n$$\n\\psi \\approx \\frac{(14400 \\cdot 3.14159265...)^{1/3}}{60} \\approx \\frac{(45238.934...)^{1/3}}{60} \\approx \\frac{35.63181...}{60} \\approx 0.5938635...\n$$\n该病变的球形度值约为 $0.5938635$。问题要求计算与完美球体的偏差，定义为 $d = 1 - \\psi$。\n$$\nd = 1 - \\psi \\approx 1 - 0.5938635... = 0.4061365...\n$$\n最终答案必须四舍五入到四位有效数字。前四位有效数字是 $4$、$0$、$6$ 和 $1$。第五位数字是 $3$，小于 $5$，所以我们向下舍入。\n$$\nd \\approx 0.4061\n$$\n这个偏差是一个无单位的量，符合要求。$d=0$ 的值表示一个完美的球体，而大于 $0$ 的值表示偏离了球形。",
            "answer": "$$\\boxed{0.4061}$$"
        },
        {
            "introduction": "在评估了宏观形状之后，下一步是探究ROI内部的像素强度分布。一阶统计量，或称直方图特征，通过分析ROI内所有体素的强度值分布来描述组织的特性，而不考虑它们的空间位置。本练习将指导你计算一个灰度直方图的均值、方差、偏度和熵，这些是描述组织平均密度、异质性和复杂性的基本指标。",
            "id": "4917108",
            "problem": "将来自计算机断层扫描图像的二维感兴趣区域 (ROI) 离散化为 $5$ 个等宽的灰度级区间，生成一个归一化直方图，该直方图可建模为离散灰度级 $x \\in \\{1,2,3,4,5\\}$ 上的概率质量函数 (PMF)，其概率为 $p = [0.1, 0.2, 0.3, 0.25, 0.15]$。在放射组学和定量纹理分析中，一阶统计量和 Shannon 熵常被用来表征组织异质性。\n\n从离散 PMF 的期望和中心矩的核心定义，以及 Shannon 熵的定义（使用自然对数）出发，完成以下任务：\n- 计算强度分布的均值 $\\,\\mu\\,$、方差 $\\,\\sigma^{2}\\,$、标准化偏度 $\\,\\gamma_{3}\\,$ 和 Shannon 熵 $\\,H_{\\mathrm{nat}}\\,$（单位为奈特）。\n- 然后，使用这些量，计算以下无量纲异质性指数\n$$J \\;=\\; \\frac{\\sigma^{2}}{4} \\;+\\; \\Bigl(1 - \\frac{H_{\\mathrm{nat}}}{\\ln 5}\\Bigr) \\;+\\; \\frac{1}{2}\\,|\\gamma_{3}|,$$\n其中，第一项中的分母 $4$ 是在支撑集 $\\{1,2,3,4,5\\}$ 上可实现的最大方差，而 $\\ln 5$ 是 $5$ 区间 PMF 的最大 Shannon 熵（单位为奈特）。\n\n根据计算出的统计数据，简要解释这对该 ROI 中的组织异质性有何意义。\n\n将 $J$ 的最终数值表示为无单位值，并将最终答案四舍五入到四位有效数字。",
            "solution": "该问题提法恰当，有科学依据，并为获得唯一解提供了所有必要信息。概率质量函数 (PMF) 是有效的，因为概率之和为 $\\sum p(x_i) = 0.1 + 0.2 + 0.3 + 0.25 + 0.15 = 1.0$。该问题要求计算标准的统计量以及由它们派生的复合指数，这是定量图像分析中的一个标准程序。\n\n离散灰度级由集合 $x \\in \\{1, 2, 3, 4, 5\\}$ 给出，相应的概率为 $p = [0.1, 0.2, 0.3, 0.25, 0.15]$。我们将逐步计算所需的量。\n\n1.  **均值 ($\\mu$)**\n    离散随机变量的均值，或期望值 $E[X]$，定义为：\n    $$ \\mu = E[X] = \\sum_{i=1}^{N} x_i p(x_i) $$\n    代入给定值：\n    $$ \\mu = (1)(0.1) + (2)(0.2) + (3)(0.3) + (4)(0.25) + (5)(0.15) $$\n    $$ \\mu = 0.1 + 0.4 + 0.9 + 1.0 + 0.75 $$\n    $$ \\mu = 3.15 $$\n\n2.  **方差 ($\\sigma^2$)**\n    方差 $\\sigma^2$ 是二阶中心矩，定义为 $E[(X-\\mu)^2]$。使用公式 $\\sigma^2 = E[X^2] - \\mu^2$ 计算更为方便。首先，我们计算 $X^2$ 的期望值：\n    $$ E[X^2] = \\sum_{i=1}^{N} x_i^2 p(x_i) $$\n    $$ E[X^2] = (1^2)(0.1) + (2^2)(0.2) + (3^2)(0.3) + (4^2)(0.25) + (5^2)(0.15) $$\n    $$ E[X^2] = (1)(0.1) + (4)(0.2) + (9)(0.3) + (16)(0.25) + (25)(0.15) $$\n    $$ E[X^2] = 0.1 + 0.8 + 2.7 + 4.0 + 3.75 $$\n    $$ E[X^2] = 11.35 $$\n    现在，我们可以计算方差：\n    $$ \\sigma^2 = E[X^2] - \\mu^2 = 11.35 - (3.15)^2 = 11.35 - 9.9225 $$\n    $$ \\sigma^2 = 1.4275 $$\n\n3.  **标准化偏度 ($\\gamma_3$)**\n    标准化偏度 $\\gamma_3$ 定义为三阶标准化矩：\n    $$ \\gamma_3 = \\frac{E[(X-\\mu)^3]}{\\sigma^3} = \\frac{m_3}{\\sigma^3} $$\n    首先，我们计算三阶中心矩 $m_3=E[(X-\\mu)^3]$：\n    $$ m_3 = \\sum_{i=1}^{N} (x_i - \\mu)^3 p(x_i) $$\n    与均值的偏差 $(x_i-\\mu)$ 为：\n    $1 - 3.15 = -2.15$\n    $2 - 3.15 = -1.15$\n    $3 - 3.15 = -0.15$\n    $4 - 3.15 = 0.85$\n    $5 - 3.15 = 1.85$\n    将这些值代入 $m_3$ 的公式中：\n    $$ m_3 = (-2.15)^3(0.1) + (-1.15)^3(0.2) + (-0.15)^3(0.3) + (0.85)^3(0.25) + (1.85)^3(0.15) $$\n    $$ m_3 = (-9.938375)(0.1) + (-1.520875)(0.2) + (-0.003375)(0.3) + (0.614125)(0.25) + (6.331625)(0.15) $$\n    $$ m_3 = -0.9938375 - 0.304175 - 0.0010125 + 0.15353125 + 0.94974375 $$\n    $$ m_3 = -0.19575 $$\n    接下来，我们需要标准差 $\\sigma = \\sqrt{\\sigma^2} = \\sqrt{1.4275}$。\n    $$ \\sigma \\approx 1.1947803 $$\n    现在我们可以计算偏度：\n    $$ \\gamma_3 = \\frac{m_3}{\\sigma^3} = \\frac{-0.19575}{(1.4275)^{3/2}} \\approx \\frac{-0.19575}{1.706175} $$\n    $$ \\gamma_3 \\approx -0.114730 $$\n\n4.  **Shannon 熵 ($H_{\\mathrm{nat}}$)**\n    对于离散 PMF，使用自然对数（底为 $e$）的 Shannon 熵定义为：\n    $$ H_{\\mathrm{nat}} = -\\sum_{i=1}^{N} p(x_i) \\ln(p(x_i)) $$\n    $$ H_{\\mathrm{nat}} = -[0.1\\ln(0.1) + 0.2\\ln(0.2) + 0.3\\ln(0.3) + 0.25\\ln(0.25) + 0.15\\ln(0.15)] $$\n    使用自然对数的值：\n    $\\ln(0.1) \\approx -2.302585$\n    $\\ln(0.2) \\approx -1.609438$\n    $\\ln(0.3) \\approx -1.203973$\n    $\\ln(0.25) \\approx -1.386294$\n    $\\ln(0.15) \\approx -1.897120$\n    $$ H_{\\mathrm{nat}} \\approx -[0.1(-2.302585) + 0.2(-1.609438) + 0.3(-1.203973) + 0.25(-1.386294) + 0.15(-1.897120)] $$\n    $$ H_{\\mathrm{nat}} \\approx -[-0.230259 - 0.321888 - 0.361192 - 0.346574 - 0.284568] $$\n    $$ H_{\\mathrm{nat}} \\approx -[-1.544481] $$\n    $$ H_{\\mathrm{nat}} \\approx 1.544481 \\text{ 奈特} $$\n\n5.  **异质性指数 ($J$)**\n    现在我们使用给定的公式计算无量纲指数 $J$：\n    $$ J = \\frac{\\sigma^{2}}{4} + \\Bigl(1 - \\frac{H_{\\mathrm{nat}}}{\\ln 5}\\Bigr) + \\frac{1}{2}|\\gamma_{3}| $$\n    我们代入计算出的值：\n    $\\sigma^2 = 1.4275$\n    $H_{\\mathrm{nat}} \\approx 1.544481$\n    $\\gamma_3 \\approx -0.114730$\n    对于一个 $5$ 级系统，最大熵为 $H_{\\mathrm{max}} = \\ln(5) \\approx 1.609438$。\n    让我们计算 $J$ 的每一项：\n    第 1 项: $\\frac{\\sigma^2}{4} = \\frac{1.4275}{4} = 0.356875$\n    第 2 项: $1 - \\frac{H_{\\mathrm{nat}}}{\\ln 5} \\approx 1 - \\frac{1.544481}{1.609438} \\approx 1 - 0.959639 = 0.040361$\n    第 3 项: $\\frac{1}{2}|\\gamma_3| \\approx \\frac{1}{2}|-0.114730| = \\frac{1}{2}(0.114730) = 0.057365$\n    将各项相加得到 $J$：\n    $$ J \\approx 0.356875 + 0.040361 + 0.057365 $$\n    $$ J \\approx 0.454601 $$\n    四舍五入到四位有效数字，我们得到 $J \\approx 0.4546$。\n\n**异质性解读：**\n计算出的统计数据为了解由 ROI 强度分布所捕获的组织特性提供了洞见。\n- **均值** ($\\mu=3.15$) 表明平均灰度级略高于标度的中点。\n- **方差** ($\\sigma^2=1.4275$) 是异质性的直接度量。归一化方差项 $\\sigma^2/4 \\approx 0.357$ 表明灰度级的离散程度是中等的，约为该标度下最大可能值的 $36\\%$。这表明组织密度存在显著但非极端的变异。\n- **偏度** ($\\gamma_3 \\approx -0.115$) 略为负，意味着存在轻微的不对称性，其尾部偏向较低（较暗）的灰度级。其绝对值很小，表示分布接近对称，因此这方面的异质性不显著。\n- **熵** ($H_{\\mathrm{nat}} \\approx 1.544$) 非常接近最大可能熵 ($\\ln 5 \\approx 1.609$)。这反映在归一化熵项 $(1 - H/\\ln 5) \\approx 0.040$ 中，该值非常小。高熵表明灰度级分布具有高度的随机性或不可预测性，这是复杂、异质的组织纹理的一个关键特征。\n\n总之，该 ROI 表现出中等到高的异质性。高熵指向存在许多灰度级的复杂纹理，而中等方差证实了这些灰度级存在显著的分布范围。低偏度表明这种分布范围在均值周围相对均衡。复合指数 $J$ 将这些特征综合成一个单一的度量。",
            "answer": "$$\n\\boxed{0.4546}\n$$"
        },
        {
            "introduction": "为了捕捉人眼难以察觉的纹理信息，放射组学引入了更高阶的统计量。本练习将带你进入二阶统计量的核心，即灰度共生矩阵（GLCM），它通过量化具有不同灰度值的像素对之间的空间关系来捕捉图像纹理。通过为一个给定的GLCM计算对比度和能量，你将亲身体验如何将图像的粗糙度或均匀度等空间模式转化为定量的、有意义的特征。",
            "id": "4917111",
            "problem": "一幅计算机断层扫描图像的感兴趣区域已被量化为 $3$ 个灰度级，并使用灰度共生矩阵 (GLCM) 进行分析，该矩阵被解释为由固定位移分隔的共现灰度对 $(i,j)$ 的联合概率质量函数。归一化的 GLCM 为\n$$\nP=\\begin{bmatrix}\n0.2  0.1  0 \\\\\n0.1  0.3  0.1 \\\\\n0  0.1  0.1\n\\end{bmatrix},\n$$\n其中索引满足 $i,j \\in \\{0,1,2\\}$ 且 $\\sum_{i=0}^{2}\\sum_{j=0}^{2} P(i,j)=1$。从 GLCM 的概率解释和二阶矩类型纹理描述符的定义出发，推导该纹理的对比度和能量关于 $P(i,j)$ 的表达式，计算给定 $P$ 时它们的数值，并简要解释它们的大小对于纹理相对于高度均匀模式与高度异构模式的粗糙度意味着什么。将您的数值结果四舍五入到四位有效数字。按对比度、能量的顺序报告这两个值。这些量是无量纲的，不需要单位。",
            "solution": "该问题是有效的，因为它在科学上基于定量纹理分析的原理，问题提法良好，设置完整且一致，并以客观、正式的语言表述。我们可以进行求解。\n\n该问题要求从给定的灰度共生矩阵 (GLCM) $P$ 中推导和计算两个二阶纹理特征：对比度和能量。图像被量化为 $N_g=3$ 个灰度级，索引为 $i,j \\in \\{0, 1, 2\\}$。归一化的 GLCM 代表了灰度对的联合概率质量函数 $P(i,j)$，由下式给出：\n$$\nP=\\begin{bmatrix}\nP(0,0)  P(0,1)  P(0,2) \\\\\nP(1,0)  P(1,1)  P(1,2) \\\\\nP(2,0)  P(2,1)  P(2,2)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0.2  0.1  0 \\\\\n0.1  0.3  0.1 \\\\\n0  0.1  0.1\n\\end{bmatrix}\n$$\n问题确认了 $\\sum_{i=0}^{2}\\sum_{j=0}^{2} P(i,j)=1$，这是归一化 GLCM 的一个必要属性。\n\n首先，我们推导**对比度**的表达式。对比度是衡量图像局部强度变化的指标。它被定义为 GLCM 的一个矩，特别是考察矩阵元素相对于主对角线的分布。对比度的表达式为：\n$$\n\\text{对比度} = \\sum_{i=0}^{N_g-1} \\sum_{j=0}^{N_g-1} (i-j)^2 P(i,j)\n$$\n对于我们 $N_g=3$ 的具体情况，索引 $i$ 和 $j$ 的范围是从 $0$ 到 $2$。计算过程是对所有 $i,j \\in \\{0,1,2\\}$，将 $(i-j)^2$ 与对应的矩阵元素 $P(i,j)$ 的乘积求和：\n$$\n\\text{对比度} = (0-0)^2 P(0,0) + (0-1)^2 P(0,1) + (0-2)^2 P(0,2) \\\\\n+ (1-0)^2 P(1,0) + (1-1)^2 P(1,1) + (1-2)^2 P(1,2) \\\\\n+ (2-0)^2 P(2,0) + (2-1)^2 P(2,1) + (2-2)^2 P(2,2)\n$$\n代入给定矩阵 $P$ 的数值：\n$$\n\\text{对比度} = (0)^2(0.2) + (-1)^2(0.1) + (-2)^2(0) \\\\\n+ (1)^2(0.1) + (0)^2(0.3) + (-1)^2(0.1) \\\\\n+ (2)^2(0) + (1)^2(0.1) + (0)^2(0.1)\n$$\n$$\n\\text{对比度} = 0 \\cdot (0.2) + 1 \\cdot (0.1) + 4 \\cdot (0) + 1 \\cdot (0.1) + 0 \\cdot (0.3) + 1 \\cdot (0.1) + 4 \\cdot (0) + 1 \\cdot (0.1) + 0 \\cdot (0.1)\n$$\n$$\n\\text{对比度} = 0 + 0.1 + 0 + 0.1 + 0 + 0.1 + 0 + 0.1 + 0 = 0.4\n$$\n四舍五入到四位有效数字，对比度为 $0.4000$。\n\n接下来，我们推导**能量**的表达式。能量，也称为角二阶矩 (ASM)，是衡量纹理均匀性的指标。它是通过对 GLCM 元素的平方求和计算得出的。较高的能量值表示纹理更有序、更均匀。能量的表达式为：\n$$\n\\text{能量} = \\sum_{i=0}^{N_g-1} \\sum_{j=0}^{N_g-1} P(i,j)^2\n$$\n对于我们的具体情况，计算如下：\n$$\n\\text{能量} = P(0,0)^2 + P(0,1)^2 + P(0,2)^2 \\\\\n+ P(1,0)^2 + P(1,1)^2 + P(1,2)^2 \\\\\n+ P(2,0)^2 + P(2,1)^2 + P(2,2)^2\n$$\n代入矩阵 $P$ 的数值：\n$$\n\\text{能量} = (0.2)^2 + (0.1)^2 + (0)^2 + (0.1)^2 + (0.3)^2 + (0.1)^2 + (0)^2 + (0.1)^2 + (0.1)^2\n$$\n$$\n\\text{能量} = 0.04 + 0.01 + 0 + 0.01 + 0.09 + 0.01 + 0 + 0.01 + 0.01\n$$\n$$\n\\text{能量} = 0.18\n$$\n四舍五入到四位有效数字，能量为 $0.1800$。\n\n最后，我们解释这些值的大小。\n一个**高度均匀**的纹理，其中大多数像素具有相同或非常相似的灰度级，将会得到一个其高数值元素集中在主对角线 ($i=j$) 上的 GLCM。这将导致非常低的对比度（接近 $0$）和非常高的能量（接近 $1$，这是单个非零元素的理论最大值）。\n一个**高度异构**或粗糙的纹理，相邻像素值之间存在较大变化，将会使 GLCM 在远离主对角线（$|i-j|$ 很大）的位置出现显著的元素。这将导致高对比度值。概率质量将分散在许多元素上，从而导致低能量。\n\n我们计算出的值为 $\\text{对比度} = 0.4$ 和 $\\text{能量} = 0.18$。\n$0.4$ 的对比度值相对较低。对于 $N_g=3$，可能的最大对比度为 $(2-0)^2=4$，但这要求所有概率都集中在 $P(0,2)$ 和 $P(2,0)$。我们的值要小得多，表明共现的灰度对通常没有大的差异。这与 GLCM 在最大差异处（即 $P(0,2)=P(2,0)=0$）的元素为零是一致的。\n$0.18$ 的能量值也相对较低。能量范围从 $1/N_g^2 = 1/9 \\approx 0.1111$（对于完全均匀的概率分布）到 $1$（对于单个概率为 $1$ 的情况）。我们的值更接近最小值而不是最大值，这表明纹理不是高度有序或周期性的。概率分布在几个共生对上，而不是集中在一两个上。\n\n总之，低对比度和低能量的组合表明该纹理既不是完全平滑也不是极其粗糙。它表明了中等程度的异构性，但在相邻区域之间没有剧烈的高对比度变化。纹理模式是复杂的，而不是简单和重复的。\n\n对比度和能量的数值结果，四舍五入到四位有效数字后，分别为 $0.4000$ 和 $0.1800$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4000 & 0.1800\n\\end{pmatrix}\n}\n$$"
        }
    ]
}