{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握 Tsodyks-Markram 模型的动态特性，最有效的方法之一就是亲手计算。本练习将引导你逐个脉冲地跟踪突触状态变量 $x(t)$ 和 $u(t)$ 的演化，并计算由不规则脉冲序列引发的突触后电流。通过这个过程，你将直观地理解促进和抑制两种机制如何相互作用，共同塑造突触的响应 。",
            "id": "4031684",
            "problem": "一个突触使用 Tsodyks-Markram 短期可塑性模型进行建模，其中两个状态变量代表动态抑制和易化：可用的突触前资源的比例 $x(t)$ 和突触效能的利用率 $u(t)$。在脉冲之间，$x(t)$ 和 $u(t)$ 根据线性常微分方程松弛到它们的固定点\n$$\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}}, \\qquad \\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}},$$\n其中 $\\tau_{rec}$ 是抑制恢复时间常数，$\\tau_{fac}$ 是促进时间常数，$U$ 是基线利用率参数。在脉冲时间 $t_{k}$，由于释放和易化，状态会发生瞬时更新（跳跃映射）：\n$$x(t_{k}^{+}) = x(t_{k}^{-})\\bigl(1 - u(t_{k}^{-})\\bigr), \\qquad u(t_{k}^{+}) = u(t_{k}^{-}) + U\\bigl(1 - u(t_{k}^{-})\\bigr),$$\n其中 $t_{k}^{-}$ 和 $t_{k}^{+}$ 分别表示脉冲前后的瞬间。突触后电流 (PSC) 被建模为一个 delta 突触，其振幅与释放的资源成正比。第 $k$ 个 PSC 的振幅定义为\n$$I_{k} = A\\,u(t_{k}^{-})\\,x(t_{k}^{-}),$$\n其中 $A$ 是一个固定的缩放因子。\n\n从初始条件 $u(0^{-}) = U$ 和 $x(0^{-}) = 1$ 开始，考虑一个脉冲序列，其脉冲时间为 $t_{1} = 50\\,\\mathrm{ms}$，$t_{2} = 130\\,\\mathrm{ms}$ 和 $t_{3} = 170\\,\\mathrm{ms}$。使用上面指定的 Tsodyks-Markram 动力学，通过从给定的微分方程导出的闭式脉冲间衰减，将 $x(t_{k}^{-})$ 和 $u(t_{k}^{-})$ 跨越脉冲进行传递，递归计算 $I_{3}$。模型参数为 $U = 0.15$，$\\tau_{fac} = 600\\,\\mathrm{ms}$，$\\tau_{rec} = 200\\,\\mathrm{ms}$，$A = 2.0\\,\\mathrm{nA}$。以纳安（nanoamperes）为单位表示电流振幅的最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在计算神经科学中已建立的 Tsodyks-Markram 模型中有科学依据，具备所有必要的参数和初始条件，问题阐述清晰，没有歧义或矛盾。因此，我们可以进行完整解答。\n\n该问题要求递归计算给定脉冲序列中第三个脉冲的突触后电流振幅 $I_3$。突触的动力学由状态变量 $x(t)$（可用资源的比例）和 $u(t)$（利用率参数）控制。\n\n首先，我们求解描述 $x(t)$ 和 $u(t)$ 在脉冲之间演化的线性常微分方程。该方程的一般形式为 $\\frac{dy}{dt} = \\frac{y_{\\infty} - y}{\\tau}$，其解为 $y(t) = y_{\\infty} + \\bigl(y(t_0) - y_{\\infty}\\bigr)\\exp\\left(-\\frac{t-t_0}{\\tau}\\right)$。\n\n对于资源变量 $x(t)$，静息值为 $x_{\\infty} = 1$，时间常数为 $\\tau_{rec}$。如果我们考虑从第 $(k-1)$ 个脉冲的时刻 $t_{k-1}$ 到第 $k$ 个脉冲的时刻 $t_{k}$ 的脉冲间隔，那么在第 $k$ 个脉冲之前的 $x$ 值，记为 $x(t_k^-)$，由下式给出：\n$$x(t_k^-) = 1 + \\bigl(x(t_{k-1}^+) - 1\\bigr)\\exp\\left(-\\frac{t_k - t_{k-1}}{\\tau_{rec}}\\right) = 1 - \\bigl(1 - x(t_{k-1}^+)\\bigr)\\exp\\left(-\\frac{\\Delta t_k}{\\tau_{rec}}\\right)$$\n其中 $x(t_{k-1}^+)$ 是第 $(k-1)$ 个脉冲刚结束后的 $x$ 值，而 $\\Delta t_k = t_k - t_{k-1}$。\n\n对于利用率变量 $u(t)$，静息值为 $u_{\\infty} = U$，时间常数为 $\\tau_{fac}$。在第 $k$ 个脉冲之前的 $u$ 值为：\n$$u(t_k^-) = U + \\bigl(u(t_{k-1}^+) - U\\bigr)\\exp\\left(-\\frac{t_k - t_{k-1}}{\\tau_{fac}}\\right) = U + \\bigl(u(t_{k-1}^+) - U\\bigr)\\exp\\left(-\\frac{\\Delta t_k}{\\tau_{fac}}\\right)$$\n\n在脉冲时间 $t_k$ 的瞬时更新由下式给出：\n$$x(t_k^+) = x(t_k^-)\\bigl(1 - u(t_k^-)\\bigr)$$\n$$u(t_k^+) = u(t_k^-) + U\\bigl(1 - u(t_k^-)\\bigr)$$\n\n突触后电流 (PSC) 的振幅为：\n$$I_k = A\\,u(t_k^-)\\,x(t_k^-)$$\n\n给定参数为：$U = 0.15$，$\\tau_{fac} = 600\\,\\mathrm{ms}$，$\\tau_{rec} = 200\\,\\mathrm{ms}$，$A = 2.0\\,\\mathrm{nA}$。脉冲时间为 $t_1 = 50\\,\\mathrm{ms}$，$t_2 = 130\\,\\mathrm{ms}$ 和 $t_3 = 170\\,\\mathrm{ms}$。\n\n初始条件为 $u(0^{-}) = U$ 和 $x(0^{-}) = 1$。这表明突触在第一个脉冲前处于静息状态。因此，系统在第一个脉冲 $t_1$ 之前的状态就是其静息状态。\n$$x(t_1^-) = 1$$\n$$u(t_1^-) = U = 0.15$$\n\n现在我们进行递归计算。\n\n**步骤 1：$t_1 = 50\\,\\mathrm{ms}$ 处的脉冲 1**\n\n脉冲前的状态是已知的。我们可以计算脉冲刚结束后的状态。\n$$u(t_1^+) = u(t_1^-) + U\\bigl(1 - u(t_1^-)\\bigr) = 0.15 + 0.15(1 - 0.15) = 0.15 + 0.15(0.85) = 0.15 + 0.1275 = 0.2775$$\n$$x(t_1^+) = x(t_1^-)\\bigl(1 - u(t_1^-)\\bigr) = 1(1 - 0.15) = 0.85$$\n\n**步骤 2：向 $t_2 = 130\\,\\mathrm{ms}$ 处的脉冲 2 演化**\n\n脉冲间隔为 $\\Delta t_2 = t_2 - t_1 = 130\\,\\mathrm{ms} - 50\\,\\mathrm{ms} = 80\\,\\mathrm{ms}$。我们使用值 $x(t_1^+)$ 和 $u(t_1^+)$ 来求得第二个脉冲之前的状态 $x(t_2^-)$ 和 $u(t_2^-)$。\n\n$$x(t_2^-) = 1 - \\bigl(1 - x(t_1^+)\\bigr)\\exp\\left(-\\frac{\\Delta t_2}{\\tau_{rec}}\\right) = 1 - (1 - 0.85)\\exp\\left(-\\frac{80}{200}\\right) = 1 - 0.15\\exp(-0.4)$$\n$$x(t_2^-) \\approx 1 - 0.15(0.670320) = 1 - 0.100548 = 0.899452$$\n\n$$u(t_2^-) = U + \\bigl(u(t_1^+) - U\\bigr)\\exp\\left(-\\frac{\\Delta t_2}{\\tau_{fac}}\\right) = 0.15 + (0.2775 - 0.15)\\exp\\left(-\\frac{80}{600}\\right) = 0.15 + 0.1275\\exp\\left(-\\frac{2}{15}\\right)$$\n$$u(t_2^-) \\approx 0.15 + 0.1275(0.875185) = 0.15 + 0.111586 = 0.261586$$\n\n现在我们计算第二个脉冲刚结束后的状态。\n$$u(t_2^+) = u(t_2^-) + U\\bigl(1 - u(t_2^-)\\bigr) \\approx 0.261586 + 0.15(1 - 0.261586) = 0.261586 + 0.15(0.738414) = 0.261586 + 0.110762 = 0.372348$$\n$$x(t_2^+) = x(t_2^-)\\bigl(1 - u(t_2^-)\\bigr) \\approx 0.899452(1 - 0.261586) = 0.899452(0.738414) = 0.664183$$\n\n**步骤 3：向 $t_3 = 170\\,\\mathrm{ms}$ 处的脉冲 3 演化**\n\n脉冲间隔为 $\\Delta t_3 = t_3 - t_2 = 170\\,\\mathrm{ms} - 130\\,\\mathrm{ms} = 40\\,\\mathrm{ms}$。我们使用值 $x(t_2^+)$ 和 $u(t_2^+)$ 来求得第三个脉冲之前的状态。\n\n$$x(t_3^-) = 1 - \\bigl(1 - x(t_2^+)\\bigr)\\exp\\left(-\\frac{\\Delta t_3}{\\tau_{rec}}\\right) \\approx 1 - (1 - 0.664183)\\exp\\left(-\\frac{40}{200}\\right) = 1 - 0.335817\\exp(-0.2)$$\n$$x(t_3^-) \\approx 1 - 0.335817(0.818731) = 1 - 0.274955 = 0.725045$$\n\n$$u(t_3^-) = U + \\bigl(u(t_2^+) - U\\bigr)\\exp\\left(-\\frac{\\Delta t_3}{\\tau_{fac}}\\right) \\approx 0.15 + (0.372348 - 0.15)\\exp\\left(-\\frac{40}{600}\\right) = 0.15 + 0.222348\\exp\\left(-\\frac{1}{15}\\right)$$\n$$u(t_3^-) \\approx 0.15 + 0.222348(0.935513) = 0.15 + 0.207977 = 0.357977$$\n\n**步骤 4：$I_3$ 的计算**\n\n第三个 PSC 的振幅是使用第三个脉冲之前的状态值计算的。\n$$I_3 = A\\,u(t_3^-)\\,x(t_3^-)$$\n$$I_3 \\approx (2.0\\,\\mathrm{nA})(0.357977)(0.725045)$$\n$$I_3 \\approx 0.519102\\,\\mathrm{nA}$$\n\n四舍五入到四位有效数字得到 $0.5191\\,\\mathrm{nA}$。\n为确保准确性，使用更高精度执行了计算：\n$x(t_1^+) = 0.85$\n$u(t_1^+) = 0.2775$\n$x(t_2^-) = 1 - 0.15 \\exp(-0.4) \\approx 0.89945199$\n$u(t_2^-) = 0.15 + 0.1275 \\exp(-2/15) \\approx 0.26158610$\n$x(t_2^+) = x(t_2^-)(1-u(t_2^-)) \\approx 0.66418285$\n$u(t_2^+) = u(t_2^-) + 0.15(1-u(t_2^-)) \\approx 0.37234819$\n$x(t_3^-) = 1 - (1-x(t_2^+))\\exp(-0.2) \\approx 0.72504464$\n$u(t_3^-) = 0.15 + (u(t_2^+)-0.15)\\exp(-1/15) \\approx 0.35797694$\n$I_3 = 2.0 \\times 0.35797694 \\times 0.72504464 \\approx 0.5191017\\,\\mathrm{nA}$。\n结果成立。",
            "answer": "$$\\boxed{0.5191}$$"
        },
        {
            "introduction": "在理解了瞬时动态之后，一个更普遍的问题是突触在持续的、有节律的输入下会如何表现。这个练习要求你推导并计算在周期性脉冲刺激下模型的稳态响应，即不动点。这项练习不仅能训练你的分析推导能力，还能让你深入理解突触如何适应恒定频率的输入，并达到一个动态平衡，这是神经编码中的一个核心概念 。",
            "id": "4031695",
            "problem": "考虑一个由峰间期为 $\\Delta t$ 的完美周期性突触前峰电位序列驱动的 Tsodyks–Markram 短期突触可塑性模型。该模型通过以下经过充分检验的唯象定律来描述可用突触资源的比例 $x(t)$ 和突触效能的利用率 $u(t)$。在峰电位之间，这些变量根据线性常微分方程 (ODE) 进行弛豫：$\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}}$ 和 $\\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}}$，其中 $\\tau_{rec}$ 是恢复时间常数，$\\tau_{fac}$ 是促进时间常数，$U$ 是基线释放概率。在每个峰电位时刻 $t_k$，$x$ 会瞬时耗尽，$u$ 会瞬时增加，其变化遵循 $x^{+}(t_k) = x^{-}(t_k)\\big(1 - u^{-}(t_k)\\big)$ 和 $u^{+}(t_k) = u^{-}(t_k) + U\\big(1 - u^{-}(t_k)\\big)$，其中上标 $-$ 和 $+$ 分别表示峰电位之前和之后的瞬间值。由第 $k$ 个峰电位诱发的突触后电流幅度为 $I_k = A\\,u^{-}(t_k)\\,x^{-}(t_k)$，其中 $A$ 是一个恒定的比例因子。\n\n在周期性刺激下，系统可以达到一个稳态（不动点），此时 $x^{-}(t_k)$ 和 $u^{-}(t_k)$ 在不同峰电位之间保持相同，记为 $x^{-,*}$ 和 $u^{-,*}$。从这些原理和定义出发，推导不动点关系式，并计算参数集 $A = 20$ 皮安 (pA)、$\\tau_{rec} = 800$ 毫秒 (ms)、$\\tau_{fac} = 100$ ms、$U = 0.2$ 和 $\\Delta t = 50$ ms 下的稳态突触幅度 $I^{*} = A\\,u^{-,*}\\,x^{-,*}$。以皮安为单位表示最终幅度，并将最终数值答案四舍五入到 $4$ 位有效数字。",
            "solution": "该问题是良定的，且有科学依据，为 Tsodyks-Markram 短期突触可塑性模型提供了一套完整的方程和参数。我们接下来求解周期性刺激下的稳态解。\n\n问题的核心是找到在峰间期为 $\\Delta t$ 的周期性峰电位序列下系统动力学的不动点。令 $x_k^- = x^{-}(t_k)$ 和 $u_k^- = u^{-}(t_k)$ 分别表示在第 $k$ 个峰电位之前瞬间的可用资源比例和利用因子。在峰电位时刻 $t_k$，这些变量瞬时更新如下：\n$$u_k^+ = u_k^- + U(1 - u_k^-)$$\n$$x_k^+ = x_k^-(1 - u_k^-)$$\n其中上标“$+$”表示峰电位之后瞬间的值。\n\n在峰电位之间，从 $t_k$ 到 $t_{k+1} = t_k + \\Delta t$，变量根据线性常微分方程演化：\n$$\\frac{du}{dt} = \\frac{U - u}{\\tau_{fac}}$$\n$$\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}}$$\n\n我们在时长为 $\\Delta t$ 的区间上求解这些 ODE，初始条件为 $u(t_k) = u_k^+$ 和 $x(t_k) = x_k^+$。\n对于 $u(t)$，解为 $u(t) = U + (u_k^+ - U)\\exp\\left(-\\frac{t-t_k}{\\tau_{fac}}\\right)$。\n在时刻 $t_{k+1}$，即下一个峰电位之前瞬间，我们有：\n$$u_{k+1}^- = U + (u_k^+ - U)\\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right)$$\n对于 $x(t)$，解为 $x(t) = 1 + (x_k^+ - 1)\\exp\\left(-\\frac{t-t_k}{\\tau_{rec}}\\right)$。\n在时刻 $t_{k+1}$，我们有：\n$$x_{k+1}^- = 1 + (x_k^+ - 1)\\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right)$$\n\n在稳态（不动点）下，峰电位前的值在相邻峰电位之间不发生变化，即 $u_{k+1}^- = u_k^- = u^{-,*}$ 且 $x_{k+1}^- = x_k^- = x^{-,*}$。将不动点条件和峰电位更新规则代入 ODE 的解中，我们得到一个关于 $u^{-,*}$ 和 $x^{-,*}$ 的代数方程组。\n\n首先，我们求解 $u^{-,*}$。令 $E_f = \\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right)$。\n$$u^{-,*} = U + (u^{+,*} - U)E_f$$\n代入 $u^{+,*} = u^{-,*} + U(1 - u^{-,*})$：\n$$u^{-,*} = U + (u^{-,*} + U(1 - u^{-,*}) - U)E_f$$\n$$u^{-,*} = U + (u^{-,*} - Uu^{-,*})E_f$$\n$$u^{-,*} = U + u^{-,*}(1 - U)E_f$$\n重新整理以求解 $u^{-,*}$：\n$$u^{-,*}(1 - (1 - U)E_f) = U$$\n$$u^{-,*} = \\frac{U}{1 - (1 - U)\\exp\\left(-\\frac{\\Delta t}{\\tau_{fac}}\\right)}$$\n\n接下来，我们求解 $x^{-,*}$。令 $E_r = \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right)$。\n$$x^{-,*} = 1 + (x^{+,*} - 1)E_r = 1 - (1 - x^{+,*})E_r$$\n代入 $x^{+,*} = x^{-,*}(1 - u^{-,*})$。注意 $u^{-,*}$ 是我们刚刚求出的稳态值。\n$$x^{-,*} = 1 - (1 - x^{-,*}(1 - u^{-,*}))E_r$$\n$$x^{-,*} = 1 - E_r + x^{-,*}(1 - u^{-,*})E_r$$\n重新整理以求解 $x^{-,*}$：\n$$x^{-,*}(1 - (1 - u^{-,*})E_r) = 1 - E_r$$\n$$x^{-,*} = \\frac{1 - E_r}{1 - (1 - u^{-,*})E_r} = \\frac{1 - \\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right)}{1 - (1 - u^{-,*})\\exp\\left(-\\frac{\\Delta t}{\\tau_{rec}}\\right)}$$\n\n现在我们代入给定的参数值：$A = 20$ pA，$\\tau_{rec} = 800$ ms，$\\tau_{fac} = 100$ ms，$U = 0.2$ 和 $\\Delta t = 50$ ms。\n\n计算指数因子：\n$$E_f = \\exp\\left(-\\frac{50}{100}\\right) = \\exp(-0.5)$$\n$$E_r = \\exp\\left(-\\frac{50}{800}\\right) = \\exp(-0.0625)$$\n\n计算稳态利用率 $u^{-,*}$：\n$$u^{-,*} = \\frac{0.2}{1 - (1 - 0.2)\\exp(-0.5)} = \\frac{0.2}{1 - 0.8\\exp(-0.5)}$$\n使用 $\\exp(-0.5) \\approx 0.606531$：\n$$u^{-,*} \\approx \\frac{0.2}{1 - 0.8 \\times 0.606531} = \\frac{0.2}{1 - 0.485225} = \\frac{0.2}{0.514775} \\approx 0.3885175$$\n\n使用 $u^{-,*}$ 的值计算稳态资源比例 $x^{-,*}$：\n$$x^{-,*} = \\frac{1 - \\exp(-0.0625)}{1 - (1 - 0.3885175)\\exp(-0.0625)}$$\n使用 $\\exp(-0.0625) \\approx 0.939413$：\n$$x^{-,*} \\approx \\frac{1 - 0.939413}{1 - (0.6114825) \\times 0.939413} = \\frac{0.060587}{1 - 0.574447} = \\frac{0.060587}{0.425553} \\approx 0.142372$$\n\n最后，我们计算稳态突触幅度 $I^{*} = A\\,u^{-,*}\\,x^{-,*}$：\n$$I^{*} = (20) \\times (0.3885175) \\times (0.142372)$$\n$$I^{*} \\approx 1.10628 \\text{ pA}$$\n\n按照要求，将最终答案四舍五入到 $4$ 位有效数字，得到 $1.106$ pA。",
            "answer": "$$\\boxed{1.106}$$"
        },
        {
            "introduction": "最终，为了将理论模型应用于计算神经科学研究，我们必须能够用代码实现它。这项综合性练习旨在指导你将模型的数学描述转化为一个高效的事件驱动模拟器。通过从包含狄拉克 $\\delta$ 函数的连续时间方程中推导更新规则并将其实现为算法，你将能为任何脉冲序列模拟突触反应，从而将理论知识转化为强大的研究工具 。",
            "id": "4031649",
            "problem": "您的任务是推导并实现一个用于短期可塑性（STP）的Tsodyks-Markram模型的基于事件的模拟器。该模拟器需维护突触资源变量 $x(t)$ 和利用率变量 $u(t)$，并在脉冲时间 $t_k$ 产生突触后电流幅值 $I_k$，且除了在脉冲事件处，不对时间进行离散化。请使用基于脑建模和计算神经科学中以下基本定义和经过充分检验的事实的常微分方程公式。\n\n考虑一个在时间 $\\{t_k\\}_{k=1}^{K}$ 接收到脉冲序列的单个突触，其中 $t_k$ 是非递减实数。Tsodyks-Markram模型将可用突触资源的分数 $x(t)$ 和突触效能的利用率 $u(t)$ 描述为由脉冲触发的冲激驱动的连续时间变量。在脉冲之间，$x(t)$ 向 1 恢复，$u(t)$ 根据一阶线性动力学向基线值 $U$ 衰减。在每次脉冲时，$u(t)$ 通过易化作用瞬时增加，$x(t)$ 通过资源消耗瞬时减少。第 k 次脉冲的突触后电流幅值定义为\n$$I_k = A \\, u(t_k^-)\\, x(t_k^-),$$\n其中 $A$ 是一个恒定增益，$t_k^-$ 表示在时间 $t_k$ 脉冲发生前瞬间的值。\n\n使用以下连续时间方程作为起点，这些方程通过狄拉克δ函数编码了恢复动力学和脉冲触发的变化：\n$$\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}} - u(t)\\, x(t)\\, \\sum_{k=1}^{K} \\delta(t - t_k),$$\n$$\\frac{du}{dt} = -\\frac{u - U}{\\tau_{fac}} + U \\,\\bigl(1 - u(t)\\bigr)\\, \\sum_{k=1}^{K} \\delta(t - t_k),$$\n其中 $\\delta(\\cdot)$ 表示狄拉克δ分布，$\\tau_{rec}  0$ 是耗尽恢复时间常数，$\\tau_{fac}  0$ 是易化衰减时间常数，而 $0 \\le U \\le 1$ 是基线利用率。\n\n您的任务是：\n- 从上述方程出发，推导在区间 $(t_{k-1}, t_k)$ 内以及在脉冲时间 $t_k$ 时，$x(t)$ 和 $u(t)$ 的基于事件的闭式更新规则。推导过程必须避免在脉冲时间点之外对时间进行任何离散化，并且必须仅依赖于线性微分方程的基本性质以及在对 $t_k$ 积分时使用的分布恒等式 $\\int \\delta(t - t_k) \\, dt = 1$。\n- 设计并实现一个算法，在给定脉冲时间列表 $\\{t_k\\}$、参数 $(U, \\tau_{rec}, \\tau_{fac}, A)$ 以及初始条件 $x(0)$ 和 $u(0)$ 的情况下，生成以纳安（nA）为单位的序列 $\\{I_k\\}$，其中 $I_k$ 在每个脉冲发生前瞬间计算。该实现必须是纯粹基于事件的：仅通过在脉冲间期应用闭式演化和在脉冲时应用瞬时跳变来更新 $x$ 和 $u$。不要用固定步长对时间进行离散化。\n- 通过构造确保计算全程中 $x(t) \\in [0,1]$ 和 $u(t) \\in [0,1]$，以保证物理真实性。\n\n使用以下参数集和脉冲序列的测试套件。对于所有情况，将输出电流 $I_k$ 表示为以纳安（nA）为单位的实值浮点数；不要附加单位字符串。除非另有说明，初始条件为 $u(0) = U$ 和 $x(0) = 1$。\n\n- 情况 1（包含易化和耗尽的一般“顺利路径”）：$U = 0.2$, $\\tau_{rec} = 0.8\\,\\mathrm{s}$, $\\tau_{fac} = 0.5\\,\\mathrm{s}$, $A = 1.0\\,\\mathrm{nA}$，脉冲时间 $[0.0, 0.05, 0.10, 0.30, 0.60]\\,\\mathrm{s}$。\n- 情况 2（耗尽主导，易化最小）：$U = 0.2$, $\\tau_{rec} = 0.8\\,\\mathrm{s}$, $\\tau_{fac} = 0.01\\,\\mathrm{s}$, $A = 1.0\\,\\mathrm{nA}$，脉冲时间 $[0.0, 0.05, 0.10, 0.30, 0.60]\\,\\mathrm{s}$。\n- 情况 3（易化主导，耗尽缓慢）：$U = 0.05$, $\\tau_{rec} = 10.0\\,\\mathrm{s}$, $\\tau_{fac} = 0.5\\,\\mathrm{s}$, $A = 1.0\\,\\mathrm{nA}$，脉冲时间 $[0.0, 0.02, 0.04, 0.06, 0.08]\\,\\mathrm{s}$。\n- 情况 4（无脉冲边界情况）：$U = 0.2$, $\\tau_{rec} = 0.8\\,\\mathrm{s}$, $\\tau_{fac} = 0.5\\,\\mathrm{s}$, $A = 1.0\\,\\mathrm{nA}$，脉冲时间 $[]$。\n- 情况 5（脉冲簇发边界情况，脉冲间期非常短）：$U = 0.3$, $\\tau_{rec} = 0.2\\,\\mathrm{s}$, $\\tau_{fac} = 1.5\\,\\mathrm{s}$, $A = 1.0\\,\\mathrm{nA}$，脉冲时间 $[0.0, 0.001, 0.002, 0.003, 0.004]\\,\\mathrm{s}$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是该用例计算出的 $I_k$ 值的列表，例如 $[[i_{1,1}, i_{1,2}], [i_{2,1}], \\ldots]$。输出必须只有一行，并且只包含此列表表示。",
            "solution": "模拟短期突触可塑性的Tsodyks-Markram (TM)模型是计算神经科学中一个适定性（well-posed）任务。所提供的公式是基于一套标准的连续时间微分方程，其中包含狄拉克δ函数来模拟脉冲驱动的事件。其基础在科学上是合理的，在数学上是可形式化的。所有参数和条件都已明确定义，使得该问题是自洽且可解的。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- **变量**：$x(t)$，可用突触资源的分数；$u(t)$，突触效能的利用率。\n- **参数**：$\\tau_{rec}  0$（耗尽恢复时间常数），$\\tau_{fac}  0$（易化衰减时间常数），$0 \\le U \\le 1$（基线利用率），$A$（恒定增益）。\n- **脉冲序列**：一组脉冲时间 $\\{t_k\\}_{k=1}^{K}$，其中 $t_k \\in \\mathbb{R}$ 且 $t_k \\ge t_{k-1}$。\n- **微分方程**：\n$$\n\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}} - u(t)\\, x(t)\\, \\sum_{k=1}^{K} \\delta(t - t_k)\n$$\n$$\n\\frac{du}{dt} = -\\frac{u - U}{\\tau_{fac}} + U \\,\\bigl(1 - u(t)\\bigr)\\, \\sum_{k=1}^{K} \\delta(t - t_k)\n$$\n- **输出定义**：第 k 次脉冲的突触后电流幅值为 $I_k = A \\, u(t_k^-)\\, x(t_k^-)$，其中 $t_k^-$ 是脉冲前瞬间的时间。\n- **初始条件**：$x(0) = 1$ 和 $u(0) = U$。\n- **测试用例**：\n  1. $U = 0.2$, $\\tau_{rec} = 0.8$, $\\tau_{fac} = 0.5$, $A = 1.0$, 脉冲: $[0.0, 0.05, 0.10, 0.30, 0.60]$。\n  2. $U = 0.2$, $\\tau_{rec} = 0.8$, $\\tau_{fac} = 0.01$, $A = 1.0$, 脉冲: $[0.0, 0.05, 0.10, 0.30, 0.60]$。\n  3. $U = 0.05$, $\\tau_{rec} = 10.0$, $\\tau_{fac} = 0.5$, $A = 1.0$, 脉冲: $[0.0, 0.02, 0.04, 0.06, 0.08]$。\n  4. $U = 0.2$, $\\tau_{rec} = 0.8$, $\\tau_{fac} = 0.5$, $A = 1.0$, 脉冲: $[]$。\n  5. $U = 0.3$, $\\tau_{rec} = 0.2$, $\\tau_{fac} = 1.5$, $A = 1.0$, 脉冲: $[0.0, 0.001, 0.002, 0.003, 0.004]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是：\n- **科学基础**：Tsodyks-Markram模型是计算神经科学中突触可塑性建模的基石。\n- **适定性**：带有脉冲强迫的常微分方程组是适定的。任务是为给定的参数和脉冲时间找到唯一的解轨迹。\n- **客观性**：所有术语都有数学定义，任务是一个精确的数值计算。\n\n该问题没有表现出任何无效性缺陷。其表述是标准的、自洽且一致的。\n\n**步骤 3：结论与行动**\n问题有效。将提供详细的解决方案。\n\n### 基于事件的更新规则的推导\n\n任务的核心是将带有狄拉克δ冲激的连续时间微分方程转换为一组仅在脉冲时刻应用的离散更新规则。这通过在两个不同阶段求解方程来实现：脉冲之间的动力学和脉冲时刻的瞬时变化。\n\n#### 1. 脉冲间动力学\n\n在两个连续脉冲之间的任何区间 $(t_{k-1}, t_k)$ 内，带有狄拉克δ函数的求和项为零。常微分方程组简化为：\n$$\n\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{rec}}\n$$\n$$\n\\frac{du}{dt} = -\\frac{u - U}{\\tau_{fac}} = \\frac{U - u}{\\tau_{fac}}\n$$\n这些是一阶线性常微分方程。设 $x(t_{k-1}^+)$ 和 $u(t_{k-1}^+)$ 表示在 $t_{k-1}$ 时刻脉冲发生后瞬间的变量值。我们在区间 $t \\in [t_{k-1}, t_k)$ 上利用这些初始条件求解 $x(t)$ 和 $u(t)$。\n\n对于形式为 $\\frac{dy}{dt} = \\frac{a - y}{\\tau}$ 且初始条件为 $y(t_0) = y_0$ 的常微分方程，其通解为 $y(t) = a + (y_0 - a) e^{-(t-t_0)/\\tau}$。\n\n将此应用于 $x(t)$，我们有 $a=1$ 和 $\\tau=\\tau_{rec}$。在 $t \\in [t_{k-1}, t_k)$ 区间内的解为：\n$$\nx(t) = 1 + (x(t_{k-1}^+) - 1) e^{-(t - t_{k-1})/\\tau_{rec}} = 1 - (1 - x(t_{k-1}^+)) e^{-(t-t_{k-1})/\\tau_{rec}}\n$$\n将此应用于 $u(t)$，我们有 $a=U$ 和 $\\tau=\\tau_{fac}$：\n$$\nu(t) = U + (u(t_{k-1}^+) - U) e^{-(t - t_{k-1})/\\tau_{fac}}\n$$\n为了找到在下一个脉冲 $t_k$ 之前瞬间的状态（表示为 $t_k^-$），我们设 $t=t_k$ 并令 $\\Delta t_k = t_k - t_{k-1}$。\n$$\nx(t_k^-) = 1 - (1 - x(t_{k-1}^+)) e^{-\\Delta t_k / \\tau_{rec}}\n$$\n$$\nu(t_k^-) = U + (u(t_{k-1}^+) - U) e^{-\\Delta t_k / \\tau_{fac}}\n$$\n这些方程描述了脉冲之间资源的恢复和利用率的衰减。\n\n#### 2. 脉冲诱导的动力学\n\n在每个脉冲时间 $t_k$，狄拉克δ函数 $\\delta(t-t_k)$ 变为活动状态。为了找到 $x$ 和 $u$ 的瞬时变化，我们在脉冲周围的一个无穷小区间 $[t_k^-, t_k^+]$ 上对完整的常微分方程进行积分。\n\n对于 $x(t)$:\n$$\n\\int_{t_k^-}^{t_k^+} \\frac{dx}{dt} dt = \\int_{t_k^-}^{t_k^+} \\left( \\frac{1 - x(t)}{\\tau_{rec}} - u(t)x(t) \\delta(t - t_k) \\right) dt\n$$\n左边是 $x(t_k^+) - x(t_k^-)$。在右边，非冲激项 $\\frac{1 - x(t)}{\\tau_{rec}}$ 在一个宽度趋于零的区间上的积分为零。δ项的积分使用筛选性质 $\\int f(t) \\delta(t-t_0) dt = f(t_0)$ 进行计算。假设在脉冲事件处是左连续的，$u(t)$ 和 $x(t)$ 的值取在 $t_k^-$。\n$$\nx(t_k^+) - x(t_k^-) = -u(t_k^-)x(t_k^-)\n$$\n$$\n\\implies x(t_k^+) = x(t_k^-) - u(t_k^-)x(t_k^-) = x(t_k^-) (1 - u(t_k^-))\n$$\n这代表了突触资源的耗尽，其量与可用资源（$x(t_k^-)$）和被利用的比例（$u(t_k^-)$）成正比，而后者又决定了突触后电流。\n\n对于 $u(t)$:\n$$\n\\int_{t_k^-}^{t_k^+} \\frac{du}{dt} dt = \\int_{t_k^-}^{t_k^+} \\left( -\\frac{u(t) - U}{\\tau_{fac}} + U(1 - u(t)) \\delta(t - t_k) \\right) dt\n$$\n同样地，衰减项的积分为零。δ项给出：\n$$\nu(t_k^+) - u(t_k^-) = U(1 - u(t_k^-))\n$$\n$$\n\\implies u(t_k^+) = u(t_k^-) + U(1 - u(t_k^-))\n$$\n这代表了易化效应，即一个传入的脉冲增加了利用率概率。\n\n值得注意的是，$x$ 的更新使用了 $u(t_k^-)$，即利用率在被易化更新*之前*的值。这是对所给常微分方程组最直接的解释，其中跳变是由系统在冲激发生瞬间的状态决定的。\n\n#### 3. 算法公式化\n\n推导出的规则构成了一个纯粹基于事件的算法。设 $x_{k-1,post}$ 和 $u_{k-1,post}$ 为在 $t_{k-1}$ 时刻第 $(k-1)$ 个脉冲之后的状态变量。对于时间 $t_k$ 的每个脉冲 $k=1, \\dots, K$，模拟按以下步骤进行：\n\n1.  **设置初始状态**：在时间 $t=0$ 时，我们有 $x_{0,post} = x(0)$ 和 $u_{0,post} = u(0)$。设 $t_0 = 0$。\n2.  **遍历脉冲**：对于每个脉冲 $k=1, 2, \\ldots, K$：\n    a.  **演化至脉冲前状态**：计算脉冲间期 $\\Delta t_k = t_k - t_{k-1}$。将变量从 $t_{k-1}^+$ 演化到 $t_k^-$，以找到脉冲前的值 $x_{k,pre} \\equiv x(t_k^-)$ 和 $u_{k,pre} \\equiv u(t_k^-)$：\n        $$\n        x_{k,pre} = 1 - (1 - x_{k-1,post}) e^{-\\Delta t_k / \\tau_{rec}}\n        $$\n        $$\n        u_{k,pre} = U + (u_{k-1,post} - U) e^{-\\Delta t_k / \\tau_{fac}}\n        $$\n    b.  **计算电流**：使用脉冲前的值计算突触后电流幅值：\n        $$\n        I_k = A \\cdot u_{k,pre} \\cdot x_{k,pre}\n        $$\n    c.  **更新为脉冲后状态**：应用瞬时跳变规则找到脉冲后的值 $x_{k,post} \\equiv x(t_k^+)$ 和 $u_{k,post} \\equiv u(t_k^+)$：\n        $$\n        u_{k,post} = u_{k,pre} + U(1 - u_{k,pre})\n        $$\n        $$\n        x_{k,post} = x_{k,pre} (1 - u_{k,pre})\n        $$\n    d.  **更新时间**：将 $t_k$ 设置为下一个区间的新的参考时间：$t_{k-1} \\to t_k$。\n\n#### 4. 物理约束的验证\n\n变量 $x(t)$ 和 $u(t)$ 必须保持在区间 $[0, 1]$ 内。\n- **初始条件**：$x(0)=1 \\in [0,1]$, $u(0)=U \\in [0,1]$。\n- **归纳步骤**：假设 $x(t_{k-1}^+), u(t_{k-1}^+) \\in [0,1]$。\n  - **脉冲间演化**：\n    - 对于 $x$：由于 $x(t_{k-1}^+) \\in [0,1]$ 且 $e^{-\\Delta t_k/\\tau_{rec}} \\in (0,1]$，$x(t_k^-) = 1 - (1 - x(t_{k-1}^+))e^{-\\Delta t_k / \\tau_{rec}}$ 是 1 和 $x(t_{k-1}^+)$ 的一个凸组合，因此 $x(t_k^-) \\in [x(t_{k-1}^+), 1] \\subseteq [0,1]$。\n    - 对于 $u$：由于 $u(t_{k-1}^+) \\in [0,1]$ 且 $e^{-\\Delta t_k/\\tau_{fac}} \\in (0,1]$，$u(t_k^-) = U + (u(t_{k-1}^+) - U)e^{-\\Delta t_k / \\tau_{fac}}$ 是 $U$ 和 $u(t_{k-1}^+)$ 的一个凸组合，因此 $u(t_k^-)$ 介于两者之间，并保持在 $[0,1]$ 区间内。\n  - **脉冲诱导的跳变**：\n    - 对于 $u$：$u_{post} = u_{pre}(1-U) + U$。由于 $u_{pre} \\in [0,1]$ 且 $U \\in [0,1]$，这是 $u_{pre}$ 和 1 的一个凸组合。因此 $u_{post} \\in [u_{pre}, 1] \\subseteq [0,1]$。\n    - 对于 $x$：$x_{post} = x_{pre}(1 - u_{pre})$。由于 $x_{pre} \\in [0,1]$ 且 $u_{pre} \\in [0,1]$，我们有 $(1-u_{pre}) \\in [0,1]$。因此，乘积 $x_{post}$ 必然在 $[0,1]$ 区间内。\n通过归纳法，推导出的规则保证了 $x(t)$ 和 $u(t)$ 在所有时间内都被限制在 $[0,1]$ 区间内。",
            "answer": "[[0.2, 0.2799341733333337, 0.3228302102022718, 0.2868284384357388, 0.2195844477839352],[0.2, 0.16244249118559093, 0.1557007722230623, 0.17062402941362638, 0.15745424564539665],[0.05, 0.07177579998101484, 0.09033324683526955, 0.10629402507850559, 0.1201526435948312],[],[0.3, 0.3340537443152504, 0.3541885561021966, 0.3659228498906109, 0.37254641681283344]]"
        }
    ]
}