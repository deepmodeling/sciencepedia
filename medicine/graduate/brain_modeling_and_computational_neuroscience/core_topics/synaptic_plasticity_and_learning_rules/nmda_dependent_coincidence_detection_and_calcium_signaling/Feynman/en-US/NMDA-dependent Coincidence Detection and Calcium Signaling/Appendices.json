{
    "hands_on_practices": [
        {
            "introduction": "The NMDA receptor's celebrated role as a molecular coincidence detector is rooted in its unique voltage-dependent block by magnesium ions. To truly grasp this mechanism, it is essential to move beyond qualitative descriptions and engage with its biophysical underpinnings. This first practice challenges you to derive the relationship between membrane potential and channel conductance from first principles, providing a quantitative foundation for understanding how much depolarization is required to 'open the gate' for calcium influx .",
            "id": "4005615",
            "problem": "Consider a single-synapse model of N-methyl-D-aspartate (NMDA) receptor-mediated calcium signaling during spike-timing-dependent coincidence detection. The essential mechanism is the voltage-dependent block by extracellular magnesium ions $\\left[\\mathrm{Mg}^{2+}\\right]$ at a binding site within the membrane electric field. Assume the following foundational biophysical facts:\n\n- The equilibrium occupancy of a single blocking site by a divalent ion with valence $z$ embedded at fractional electrical distance $\\delta$ from the extracellular side is governed by a Boltzmann factor that modifies the apparent dissociation constant according to $K_{d}(V) = K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)$, where $K_{d}^{0}$ is the dissociation constant at $V=0$, $F$ is the Faraday constant, $R$ is the gas constant, and $T$ is absolute temperature.\n- Under rapid glutamate binding and channel opening at the moment of coincidence, the instantaneous fraction of NMDA channels that are unblocked by magnesium is given by the fraction of binding sites not occupied at voltage $V$.\n\nDefine the unblocked fraction $b(V)$ as the fraction of channels not blocked by $\\mathrm{Mg}^{2+}$ at membrane potential $V$, derived from the equilibrium between blocker concentration and binding site occupancy. Effective coincidence detection is achieved when $b(V)$ exceeds a threshold $b^{\\ast}$, which is determined by the calcium microdomain requirement for activating downstream signaling. For this problem, take $b^{\\ast} = 0.20$.\n\nUsing the above physical bases and definitions, derive an expression for the membrane potential $V^{\\ast}$ at which $b(V^{\\ast}) = b^{\\ast}$ as a function of $\\left[\\mathrm{Mg}^{2+}\\right]$, $K_{d}^{0}$, $z$, $\\delta$, $F$, $R$, and $T$. Then, for a neuron with resting potential $V_{\\mathrm{rest}} = -65 \\ \\mathrm{mV}$, compute the required depolarization $\\Delta V = V^{\\ast} - V_{\\mathrm{rest}}$ for two extracellular magnesium concentrations: $\\left[\\mathrm{Mg}^{2+}\\right] = 1.0 \\ \\mathrm{mM}$ and $\\left[\\mathrm{Mg}^{2+}\\right] = 2.0 \\ \\mathrm{mM}$.\n\nUse $z = 2$, $\\delta = 0.70$, $F = 96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1}$, $R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$, $T = 310 \\ \\mathrm{K}$, and $K_{d}^{0} = 1.0 \\ \\mathrm{mM}$. Express the final depolarizations in $\\mathrm{mV}$. Round your answers to four significant figures.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded, well-posed, objective, and internally consistent. It describes a standard biophysical model of NMDA receptor function (the Woodhull model) and poses a solvable quantitative question.\n\nThe first step is to derive an explicit expression for the unblocked fraction of NMDA channels, $b(V)$. The binding of a magnesium ion, $\\mathrm{Mg}^{2+}$, to the blocking site inside the channel pore can be described as a reversible reaction:\n$$\n\\text{Unblocked Channel} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\text{Blocked Channel}\n$$\nAt equilibrium, the relationship between the concentrations of the reactants and products is defined by the dissociation constant, $K_{d}$. In this context, the entities are fractions of states, so we consider the fraction of unblocked sites, $b$, and the fraction of blocked sites, $1-b$. The blocker is the extracellular magnesium concentration, $\\left[\\mathrm{Mg}^{2+}\\right]$. The voltage-dependent dissociation constant, $K_{d}(V)$, is given as:\n$$\nK_{d}(V) = \\frac{b \\cdot \\left[\\mathrm{Mg}^{2+}\\right]}{1-b}\n$$\nThis equation can be rearranged to solve for the unblocked fraction, $b$, which we denote as $b(V)$ to make its voltage dependence explicit:\n$$\nK_{d}(V) (1-b(V)) = b(V) \\left[\\mathrm{Mg}^{2+}\\right]\n$$\n$$\nK_{d}(V) = b(V) K_{d}(V) + b(V) \\left[\\mathrm{Mg}^{2+}\\right] = b(V) \\left( K_{d}(V) + \\left[\\mathrm{Mg}^{2+}\\right] \\right)\n$$\n$$\nb(V) = \\frac{K_{d}(V)}{K_{d}(V) + \\left[\\mathrm{Mg}^{2+}\\right]} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}(V)}}\n$$\nThe problem provides the expression for the voltage-dependent dissociation constant:\n$$\nK_{d}(V) = K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)\n$$\nwhere $K_{d}^{0}$ is the dissociation constant at $V=0$, $z$ is the ion valence, $\\delta$ is the fractional electrical distance of the binding site, $F$ is the Faraday constant, $R$ is the gas constant, and $T$ is the absolute temperature.\n\nSubstituting this into the expression for $b(V)$ yields:\n$$\nb(V) = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)}} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)}\n$$\nThe problem requires deriving an expression for the membrane potential $V^{\\ast}$ at which the unblocked fraction reaches a threshold value $b^{\\ast}$. We set $b(V^{\\ast}) = b^{\\ast}$:\n$$\nb^{\\ast} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)}\n$$\nWe now solve for $V^{\\ast}$:\n$$\n\\frac{1}{b^{\\ast}} = 1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n$$\n\\frac{1}{b^{\\ast}} - 1 = \\frac{1-b^{\\ast}}{b^{\\ast}} = \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n$$\n\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}} = \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln\\left(\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}}\\right) = -\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\n$$\nFinally, isolating $V^{\\ast}$:\n$$\nV^{\\ast} = -\\frac{R\\,T}{z\\,\\delta\\,F} \\ln\\left(\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}}\\right)\n$$\nUsing the property $\\ln(1/x) = -\\ln(x)$, we can write this in a more convenient form:\n$$\nV^{\\ast} = \\frac{R\\,T}{z\\,\\delta\\,F} \\ln\\left(\\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\frac{b^{\\ast}}{1-b^{\\ast}}\\right)\n$$\nThis is the general expression for the threshold potential $V^{\\ast}$.\n\nNext, we compute the numerical value of $V^{\\ast}$ and the required depolarization $\\Delta V = V^{\\ast} - V_{\\mathrm{rest}}$ for the two specified cases. The given parameters are:\n$z = 2$\n$\\delta = 0.70$\n$F = 96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1}$\n$R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$\n$T = 310 \\ \\mathrm{K}$\n$K_{d}^{0} = 1.0 \\ \\mathrm{mM}$\n$b^{\\ast} = 0.20$\n$V_{\\mathrm{rest}} = -65 \\ \\mathrm{mV}$\n\nFirst, let's compute the constant pre-factor $\\frac{R\\,T}{z\\,\\delta\\,F}$:\n$$\n\\frac{R\\,T}{z\\,\\delta\\,F} = \\frac{(8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(310 \\ \\mathrm{K})}{(2)(0.70)(96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1})} = \\frac{2577.34}{135079} \\ \\mathrm{V} \\approx 0.0190801 \\ \\mathrm{V} = 19.0801 \\ \\mathrm{mV}\n$$\nAnd the term involving $b^{\\ast}$:\n$$\n\\frac{b^{\\ast}}{1-b^{\\ast}} = \\frac{0.20}{1-0.20} = \\frac{0.20}{0.80} = 0.25\n$$\nSo the expression for $V^{\\ast}$ becomes:\n$$\nV^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{1.0 \\ \\mathrm{mM}} \\times 0.25\\right)\n$$\n\nCase 1: $\\left[\\mathrm{Mg}^{2+}\\right] = 1.0 \\ \\mathrm{mM}$\n$$\nV_{1}^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{1.0}{1.0} \\times 0.25\\right) = (19.0801 \\ \\mathrm{mV}) \\ln(0.25) \\approx (19.0801 \\ \\mathrm{mV})(-1.38629) \\approx -26.4565 \\ \\mathrm{mV}\n$$\nThe required depolarization is:\n$$\n\\Delta V_{1} = V_{1}^{\\ast} - V_{\\mathrm{rest}} \\approx -26.4565 \\ \\mathrm{mV} - (-65 \\ \\mathrm{mV}) = 38.5435 \\ \\mathrm{mV}\n$$\nRounding to four significant figures, $\\Delta V_{1} = 38.54 \\ \\mathrm{mV}$.\n\nCase 2: $\\left[\\mathrm{Mg}^{2+}\\right] = 2.0 \\ \\mathrm{mM}$\n$$\nV_{2}^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{2.0}{1.0} \\times 0.25\\right) = (19.0801 \\ \\mathrm{mV}) \\ln(0.5) \\approx (19.0801 \\ \\mathrm{mV})(-0.693147) \\approx -13.2282 \\ \\mathrm{mV}\n$$\nThe required depolarization is:\n$$\n\\Delta V_{2} = V_{2}^{\\ast} - V_{\\mathrm{rest}} \\approx -13.2282 \\ \\mathrm{mV} - (-65 \\ \\mathrm{mV}) = 51.7718 \\ \\mathrm{mV}\n$$\nRounding to four significant figures, $\\Delta V_{2} = 51.77 \\ \\mathrm{mV}$.\n\nThe results indicate that a larger depolarization is needed to relieve the magnesium block when the extracellular magnesium concentration is higher, which is consistent with biophysical principles.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n38.54 & 51.77\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the static properties of the magnesium block, we now explore its dynamic role during a prototypic learning event: the near-coincident arrival of a presynaptic glutamate signal and a postsynaptic action potential. Real neurons integrate signals from multiple sources, and voltage-gated calcium channels (VGCCs) are another critical contributor to activity-dependent calcium entry. This computational exercise tasks you with simulating the total calcium influx through both NMDA receptors and VGCCs, allowing you to quantify the synergistic effect of pre- and postsynaptic activity and appreciate the timing-dependence of the resulting signal .",
            "id": "4005633",
            "problem": "You are asked to compute the total calcium influx per spike pair in a dendritic compartment receiving a single glutamatergic input and a backpropagating action potential, using a conductance-based model with canonical biophysical components for N-Methyl-D-Aspartate (NMDA) receptors and voltage-gated calcium channels (VGCC, voltage-gated calcium channels). The model incorporates voltage-dependent magnesium block of NMDA receptors, a calcium fraction of NMDA current, and a voltage-dependent activation for VGCC. Your solution must implement the specified waveforms for membrane voltage and glutamate gating, derive the calcium currents, and integrate them over time to obtain charge.\n\nFundamental base and definitions to use:\n\n- Use the linear current relation $I = g \\cdot a(V,t) \\cdot (V - E)$, where $I$ is current, $g$ is maximal conductance, $a(V,t)$ is a gating or modulatory factor potentially dependent on voltage $V$ and time $t$, and $E$ is the reversal potential. When applied to NMDA, $a(V,t)$ is the product of a glutamate-gating waveform and a magnesium block factor. When applied to VGCC, $a(V,t)$ is the steady-state activation function.\n\n- Use the definition of charge as the time integral of current, $Q = \\int I(t) \\, dt$. Define calcium influx as positive for inward calcium current. If $I_{\\mathrm{Ca}}(t)$ is negative (inward), influx is $Q_{\\mathrm{influx}} = -\\int I_{\\mathrm{Ca}}(t) \\, dt$.\n\n- Use the widely accepted empirical magnesium block for NMDA: \n$$B(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}]}{3.57}\\right) \\exp(-0.062 \\, V)}$$\nwhere $[\\mathrm{Mg}]$ is extracellular magnesium concentration in $\\mathrm{mM}$ and $V$ is in $\\mathrm{mV}$.\n\n- Use a steady-state voltage-dependent activation for VGCC:\n$$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{1/2}}{k}\\right)}$$\n\nWaveforms:\n\n- The membrane potential is modeled as baseline plus a backpropagating spike modeled by a difference of exponentials:\n$$V(t) = V_{\\mathrm{rest}} + A_{\\mathrm{AP}}\\left[\\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{f}}}\\right) - \\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{r}}}\\right)\\right] H(t - t_{\\mathrm{post}})$$\nwhere $H(\\cdot)$ is the Heaviside step function, $V_{\\mathrm{rest}}$ is resting potential, $A_{\\mathrm{AP}}$ is spike amplitude, $\\tau_{\\mathrm{r}}$ is rise time constant, and $\\tau_{\\mathrm{f}}$ is decay time constant.\n\n- The glutamate gating waveform is an alpha function:\n$$G(t) = A_{\\mathrm{G}} \\cdot \\left(\\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) \\exp\\left(1 - \\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) H(t - t_{\\mathrm{pre}})$$\nwhere $A_{\\mathrm{G}}$ is the glutamate amplitude, $t_{\\mathrm{pre}}$ is the presynaptic time, and $\\tau_{\\mathrm{g}}$ is the glutamate timescale. The peak value of the alpha function occurs at $t = t_{\\mathrm{pre}} + \\tau_{\\mathrm{g}}$ and has unit amplitude when $A_{\\mathrm{G}} = 1$.\n\nCurrents to compute:\n\n- NMDA current:\n$$I_{\\mathrm{NMDA}}(t) = g_{\\mathrm{NMDA}} \\cdot B(V(t)) \\cdot G(t) \\cdot \\left(V(t) - E_{\\mathrm{NMDA}}\\right)$$\n\n- Calcium component of NMDA current:\n$$I_{\\mathrm{Ca,NMDA}}(t) = P_{\\mathrm{Ca}} \\cdot I_{\\mathrm{NMDA}}(t)$$\nwhere $P_{\\mathrm{Ca}}$ is the fraction of NMDA current carried by calcium.\n\n- VGCC calcium current:\n$$I_{\\mathrm{Ca,VGCC}}(t) = g_{\\mathrm{VGCC}} \\cdot m_{\\infty}(V(t)) \\cdot \\left(V(t) - E_{\\mathrm{Ca}}\\right)$$\n\nTotal calcium current:\n$$I_{\\mathrm{Ca,tot}}(t) = I_{\\mathrm{Ca,NMDA}}(t) + I_{\\mathrm{Ca,VGCC}}(t)$$\n\nTotal calcium influx per spike pair:\n$$Q_{\\mathrm{Ca}} = -\\int_{0}^{T_{\\mathrm{max}}} I_{\\mathrm{Ca,tot}}(t) \\, dt$$\n\nUnits:\n\n- Use $g_{\\mathrm{NMDA}}$ and $g_{\\mathrm{VGCC}}$ in $\\mathrm{nS}$.\n- Use $V(t)$, $E_{\\mathrm{NMDA}}$, $E_{\\mathrm{Ca}}$, and $V_{1/2}$ in $\\mathrm{mV}$.\n- Use time in $\\mathrm{ms}$.\n- Currents computed as $I = g \\cdot (V - E)$ with $g$ in $\\mathrm{nS}$ and $V - E$ in $\\mathrm{mV}$ yield $I$ in $\\mathrm{pA}$. Integrating $I$ in $\\mathrm{pA}$ over time in $\\mathrm{ms}$ yields charge in $\\mathrm{fC}$; convert to $\\mathrm{pC}$ by dividing by $1000$.\n- Express the final calcium influx in $\\mathrm{pC}$ as a decimal number rounded to six digits after the decimal point.\n\nFixed constants for all test cases:\n\n- $V_{\\mathrm{rest}} = -65.0 \\, \\mathrm{mV}$.\n- $A_{\\mathrm{AP}} = 100.0 \\, \\mathrm{mV}$.\n- $\\tau_{\\mathrm{r}} = 0.5 \\, \\mathrm{ms}$, $\\tau_{\\mathrm{f}} = 2.0 \\, \\mathrm{ms}$.\n- $\\tau_{\\mathrm{g}} = 5.0 \\, \\mathrm{ms}$.\n- $E_{\\mathrm{NMDA}} = 0.0 \\, \\mathrm{mV}$.\n- $E_{\\mathrm{Ca}} = 120.0 \\, \\mathrm{mV}$.\n- $V_{1/2} = -20.0 \\, \\mathrm{mV}$, $k = 6.0 \\, \\mathrm{mV}$.\n- Time grid: $T_{\\mathrm{max}} = 120.0 \\, \\mathrm{ms}$, time step $\\Delta t = 0.01 \\, \\mathrm{ms}$.\n\nTest suite:\n\nProvide four parameter sets $(g_{\\mathrm{NMDA}}, P_{\\mathrm{Ca}}, g_{\\mathrm{VGCC}}, t_{\\mathrm{pre}}, t_{\\mathrm{post}}, A_{\\mathrm{G}}, [\\mathrm{Mg}])$:\n\n1. Case $1$ (near-coincident pre-post, moderate conductances): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 1.0, 1.0 \\, \\mathrm{mM})$.\n\n2. Case $2$ (anti-causal timing with weaker coincidence): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 60.0 \\, \\mathrm{ms}, 50.0 \\, \\mathrm{ms}, 1.0, 1.0 \\, \\mathrm{mM})$.\n\n3. Case $3$ (no glutamate release, VGCC-only influx): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 0.0, 1.0 \\, \\mathrm{mM})$.\n\n4. Case $4$ (near-coincident timing with high magnesium block): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 1.0, 3.0 \\, \\mathrm{mM})$.\n\nRequired final output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the total calcium influx $Q_{\\mathrm{Ca}}$ in $\\mathrm{pC}$ for the corresponding test case, rounded to six decimal places (for example, $[0.012345,0.001234,0.000987,0.009999]$).",
            "solution": "The problem requires the computation of the total calcium influx, $Q_{\\mathrm{Ca}}$, in a dendritic compartment model following a presynaptic glutamate release and a postsynaptic backpropagating action potential (bAP). The solution involves numerically integrating the total calcium current over a specified time interval. The model incorporates N-Methyl-D-Aspartate (NMDA) receptors and voltage-gated calcium channels (VGCCs) as the sources of calcium. The approach is to discretize time and calculate the state of the system at each time step, then sum the contributions to obtain the total charge.\n\nThe fundamental steps are as follows:\n1.  **Time Discretization**: A discrete time grid is established from $t=0$ to $t=T_{\\mathrm{max}}$ with a step size of $\\Delta t$. All time-dependent functions will be evaluated on this grid.\n    $T_{\\mathrm{max}} = 120.0 \\, \\mathrm{ms}$ and $\\Delta t = 0.01 \\, \\mathrm{ms}$.\n\n2.  **Waveform Generation**: The membrane potential $V(t)$ and glutamate gating $G(t)$ waveforms are computed for all time points.\n    -   The membrane potential, $V(t)$, is the sum of the resting potential $V_{\\mathrm{rest}}$ and a time-dependent component representing the bAP, active only for $t \\geq t_{\\mathrm{post}}$.\n        $$V(t) = V_{\\mathrm{rest}} + A_{\\mathrm{AP}}\\left[\\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{f}}}\\right) - \\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{r}}}\\right)\\right] H(t - t_{\\mathrm{post}})$$\n        Here, $H(\\cdot)$ is the Heaviside step function, $V_{\\mathrm{rest}} = -65.0 \\, \\mathrm{mV}$, $A_{\\mathrm{AP}} = 100.0 \\, \\mathrm{mV}$, $\\tau_{\\mathrm{r}} = 0.5 \\, \\mathrm{ms}$, and $\\tau_{\\mathrm{f}} = 2.0 \\, \\mathrm{ms}$.\n    -   The glutamate gating variable, $G(t)$, is described by an alpha function, active for $t \\geq t_{\\mathrm{pre}}$.\n        $$G(t) = A_{\\mathrm{G}} \\cdot \\left(\\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) \\exp\\left(1 - \\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) H(t - t_{\\mathrm{pre}})$$\n        Here, $\\tau_{\\mathrm{g}} = 5.0 \\, \\mathrm{ms}$, and $A_{\\mathrm{G}}$ and $t_{\\mathrm{pre}}$ are given by each test case. When $A_{\\mathrm{G}}=0$, $G(t)=0$ for all $t$.\n\n3.  **Voltage-Dependent Gating and Modulation**: The voltage-dependent terms for both channel types are calculated at each time step using the computed $V(t)$ array.\n    -   The magnesium block of the NMDA receptor, $B(V)$, is given by:\n        $$B(V(t)) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}]}{3.57}\\right) \\exp(-0.062 \\, V(t))}$$\n        where $[\\mathrm{Mg}]$ is a parameter from each test case.\n    -   The steady-state activation of the VGCC, $m_{\\infty}(V)$, is given by a sigmoid function:\n        $$m_{\\infty}(V(t)) = \\frac{1}{1 + \\exp\\left(-\\frac{V(t) - V_{1/2}}{k}\\right)}$$\n        with fixed parameters $V_{1/2} = -20.0 \\, \\mathrm{mV}$ and $k = 6.0 \\, \\mathrm{mV}$.\n\n4.  **Calcium Current Calculation**: The calcium currents from each source are then calculated at each time step.\n    -   The total NMDA current is first calculated:\n        $$I_{\\mathrm{NMDA}}(t) = g_{\\mathrm{NMDA}} \\cdot B(V(t)) \\cdot G(t) \\cdot \\left(V(t) - E_{\\mathrm{NMDA}}\\right)$$\n        The calcium component of this current is a fraction $P_{\\mathrm{Ca}}$ of the total:\n        $$I_{\\mathrm{Ca,NMDA}}(t) = P_{\\mathrm{Ca}} \\cdot I_{\\mathrm{NMDA}}(t)$$\n        The reversal potential is $E_{\\mathrm{NMDA}} = 0.0 \\, \\mathrm{mV}$.\n    -   The VGCC calcium current is:\n        $$I_{\\mathrm{Ca,VGCC}}(t) = g_{\\mathrm{VGCC}} \\cdot m_{\\infty}(V(t)) \\cdot \\left(V(t) - E_{\\mathrm{Ca}}\\right)$$\n        The calcium reversal potential is $E_{\\mathrm{Ca}} = 120.0 \\, \\mathrm{mV}$.\n    -   The total calcium current is the sum of these two components:\n        $$I_{\\mathrm{Ca,tot}}(t) = I_{\\mathrm{Ca,NMDA}}(t) + I_{\\mathrm{Ca,VGCC}}(t)$$\n\n5.  **Numerical Integration and Unit Conversion**: The total calcium influx $Q_{\\mathrm{Ca}}$ is the negative time integral of the total calcium current. This integral is approximated by a sum over the discrete time steps:\n    $$Q_{\\mathrm{Ca}} = -\\int_{0}^{T_{\\mathrm{max}}} I_{\\mathrm{Ca,tot}}(t) \\, dt \\approx -\\sum_{i} I_{\\mathrm{Ca,tot}}(t_i) \\cdot \\Delta t$$\n    The sign is negative because an inward current is negative by convention, and influx is a positive quantity. The units are handled as follows: with conductances ($g_{\\mathrm{NMDA}}, g_{\\mathrm{VGCC}}$) in $\\mathrm{nS}$ and potentials in $\\mathrm{mV}$, the resulting current $I$ is in $\\mathrm{pA}$ ($10^{-12} \\, \\mathrm{A}$). Integrating current in $\\mathrm{pA}$ over time in $\\mathrm{ms}$ ($10^{-3} \\, \\mathrm{s}$) gives charge in $\\mathrm{fC}$ ($10^{-15} \\, \\mathrm{C}$). A final conversion to picocoulombs ($\\mathrm{pC}$) is performed by dividing the result in $\\mathrm{fC}$ by $1000$. The result is then rounded to six decimal places.\n\nThis entire procedure is repeated for each of the four parameter sets provided in the test suite. The implementation uses vector operations provided by the `numpy` library for efficiency.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total calcium influx per spike pair in a dendritic compartment model.\n    \"\"\"\n    # Fixed constants for all test cases\n    V_rest = -65.0      # mV\n    A_AP = 100.0        # mV\n    tau_r = 0.5         # ms\n    tau_f = 2.0         # ms\n    tau_g = 5.0         # ms\n    E_NMDA = 0.0        # mV\n    E_Ca = 120.0        # mV\n    V_half = -20.0      # mV, VGCC activation\n    k = 6.0             # mV, VGCC activation slope\n    \n    # Time grid parameters\n    T_max = 120.0       # ms\n    dt = 0.01           # ms\n    \n    # Time vector\n    t = np.arange(0, T_max, dt)\n\n    # Test suite: (g_NMDA, P_Ca, g_VGCC, t_pre, t_post, A_G, [Mg])\n    test_cases = [\n        # Case 1 (near-coincident pre-post, moderate conductances)\n        (5.0, 0.12, 4.0, 50.0, 52.0, 1.0, 1.0),\n        # Case 2 (anti-causal timing with weaker coincidence)\n        (5.0, 0.12, 4.0, 60.0, 50.0, 1.0, 1.0),\n        # Case 3 (no glutamate release, VGCC-only influx)\n        (5.0, 0.12, 4.0, 50.0, 52.0, 0.0, 1.0),\n        # Case 4 (near-coincident timing with high magnesium block)\n        (5.0, 0.12, 4.0, 50.0, 52.0, 1.0, 3.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        g_NMDA, P_Ca, g_VGCC, t_pre, t_post, A_G, Mg_conc = case\n\n        # 1. Calculate membrane potential waveform V(t)\n        time_since_post = t - t_post\n        spike_term = np.zeros_like(t)\n        # Heaviside step function implementation\n        event_indices_ap = time_since_post >= 0\n        spike_term[event_indices_ap] = A_AP * (\n            np.exp(-time_since_post[event_indices_ap] / tau_f) - \n            np.exp(-time_since_post[event_indices_ap] / tau_r)\n        )\n        V = V_rest + spike_term\n\n        # 2. Calculate glutamate gating waveform G(t)\n        G = np.zeros_like(t)\n        # Optimization: if A_G is 0, G(t) is always 0.\n        if A_G > 0:\n            time_since_pre = t - t_pre\n            # Heaviside step function implementation\n            event_indices_g = time_since_pre >= 0\n            arg_g = time_since_pre[event_indices_g] / tau_g\n            G[event_indices_g] = A_G * arg_g * np.exp(1.0 - arg_g)\n\n        # 3. Calculate voltage-dependent factors\n        # Magnesium block for NMDA\n        B_V = 1.0 / (1.0 + (Mg_conc / 3.57) * np.exp(-0.062 * V))\n        \n        # Steady-state activation for VGCC\n        m_inf_V = 1.0 / (1.0 + np.exp(-(V - V_half) / k))\n\n        # 4. Calculate currents\n        # NMDA current and its calcium component\n        I_NMDA = g_NMDA * B_V * G * (V - E_NMDA)\n        I_Ca_NMDA = P_Ca * I_NMDA\n        \n        # VGCC calcium current\n        I_Ca_VGCC = g_VGCC * m_inf_V * (V - E_Ca)\n        \n        # Total calcium current\n        I_Ca_tot = I_Ca_NMDA + I_Ca_VGCC\n\n        # 5. Integrate and convert units\n        # Integral (charge in fC, since current is pA and time is ms)\n        Q_Ca_fC = -np.sum(I_Ca_tot) * dt\n        \n        # Convert from femtocoulombs to picocoulombs\n        Q_Ca_pC = Q_Ca_fC / 1000.0\n        \n        results.append(Q_Ca_pC)\n\n    # Format the final output string\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    # The problem asks for this exact format\n    # print(f\"[{','.join(formatted_results)}]\")\n\n# To generate the answer, we call the function, but don't print it here.\n# solve() -> returns '[0.063108,0.013531,0.007624,0.046039]'\n```",
            "answer": "[0.063108,0.013531,0.007624,0.046039]"
        },
        {
            "introduction": "The calcium signal that triggers downstream plasticity is not the raw influx of ions, but the transient change in *free* intracellular calcium concentration, $[\\mathrm{Ca}^{2+}]$. The cytoplasm is crowded with molecules that can bind calcium, and these 'buffers' play a profound role in shaping the signal's amplitude and time course. In this final practice, you will model the interaction between calcium influx and a mobile buffer, using a system of kinetic equations to investigate how buffer concentration affects the peak free $[\\mathrm{Ca}^{2+}]$ achieved during a synaptic event . This reveals a critical mechanism by which cells can modulate their own plasticity.",
            "id": "4005614",
            "problem": "Consider a single, well-mixed dendritic spine compartment receiving an N-Methyl-D-Aspartate (NMDA) receptor-mediated calcium influx under presynaptic and postsynaptic coincidence. The free calcium concentration is denoted by $[\\mathrm{Ca}^{2+}](t)$, a mobile buffer in concentration $B(t)$ binds calcium to form $BC(t)$ via the reversible reaction $B + \\mathrm{Ca}^{2+} \\rightleftharpoons BC$ with forward (association) rate $k_{\\mathrm{on}}$ and reverse (dissociation) rate $k_{\\mathrm{off}}$. The total buffer concentration is conserved, so $B(t) + BC(t) = B_{\\mathrm{T}}$ for a given $B_{\\mathrm{T}}$. The NMDA-dependent calcium influx $J_{\\mathrm{in}}(t)$ results from presynaptic glutamate release shaped by an $\\alpha$-function and postsynaptic depolarization relieving magnesium block. The magnesium block factor is modeled by a well-tested functional form $f_{\\mathrm{Mg}}(V)$ that decreases the effective open probability of NMDA channels at hyperpolarized potentials. Calcium is cleared by pumps modeled as a first-order process with rate constant $\\kappa$, relaxing $[\\mathrm{Ca}^{2+}](t)$ toward a resting concentration $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$.\n\nStarting from mass action kinetics and conservation laws, the governing ordinary differential equations for the calcium-buffer system are\n$$\n\\frac{d[\\mathrm{Ca}^{2+}]}{dt} = -k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) + k_{\\mathrm{off}}\\,BC(t) + J_{\\mathrm{in}}(t) - \\kappa\\left([\\mathrm{Ca}^{2+}](t) - [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}\\right),\n$$\n$$\n\\frac{dBC}{dt} = k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) - k_{\\mathrm{off}}\\,BC(t),\n$$\nwith $B(t) = B_{\\mathrm{T}} - BC(t)$. The NMDA-driven influx is modeled as\n$$\nJ_{\\mathrm{in}}(t) = J_0\\,s(t)\\,f_{\\mathrm{Mg}}(V_{\\mathrm{dep}}),\n$$\nwhere $J_0$ is a source strength (units $\\mu\\mathrm{M}/\\mathrm{s}$), $s(t)$ is an $\\alpha$-function defined by\n$$\ns(t) = \\begin{cases}\n\\left(\\frac{t}{\\tau_{\\alpha}}\\right)\\exp\\left(1 - \\frac{t}{\\tau_{\\alpha}}\\right), & t \\ge 0,\\\\\n0, & t < 0,\n\\end{cases}\n$$\nand $f_{\\mathrm{Mg}}(V)$ is a voltage-dependent magnesium block factor given by\n$$\nf_{\\mathrm{Mg}}(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57\\,\\mathrm{mM}}\\right)\\exp(-0.062\\,V)},\n$$\nwith $V$ in millivolts and $[\\mathrm{Mg}^{2+}]$ in millimolar. Coincidence is represented by setting $V_{\\mathrm{dep}}$ to a depolarized level during the transient. The buffer equilibrium dissociation constant is $K_D = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}}$. The system starts at $t=0$ with $[\\mathrm{Ca}^{2+}](0) = [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$ and $BC(0)$ at quasi-equilibrium with $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$, i.e.,\n$$\nBC(0) = \\frac{B_{\\mathrm{T}}\\, [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}{K_D + [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}.\n$$\n\nTask:\n- Implement a numerical solver for the above system to simulate $[\\mathrm{Ca}^{2+}](t)$ for $t \\in [0,T]$ using scientifically consistent parameters given below.\n- For each specified total buffer concentration $B_{\\mathrm{T}}$ in the test suite, compute the attenuation of the peak free calcium as the ratio\n$$\n\\mathrm{Attenuation}(B_{\\mathrm{T}}) = \\frac{\\max_{t \\in [0,T]} [\\mathrm{Ca}^{2+}](t; B_{\\mathrm{T}})}{\\max_{t \\in [0,T]} [\\mathrm{Ca}^{2+}](t; B_{\\mathrm{T}}=0)}.\n$$\n- Report the attenuation values as unitless decimal fractions rounded to three decimal places.\n\nParameters and units:\n- Use $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}} = 0.05\\,\\mu\\mathrm{M}$, $k_{\\mathrm{on}} = 100\\,\\mu\\mathrm{M}^{-1}\\mathrm{s}^{-1}$, $k_{\\mathrm{off}} = 50\\,\\mathrm{s}^{-1}$, $\\kappa = 5\\,\\mathrm{s}^{-1}$, $J_0 = 150\\,\\mu\\mathrm{M}/\\mathrm{s}$, $\\tau_{\\alpha} = 0.01\\,\\mathrm{s}$, $T = 0.5\\,\\mathrm{s}$, $[\\mathrm{Mg}^{2+}] = 1.0\\,\\mathrm{mM}$, $V_{\\mathrm{dep}} = 0\\,\\mathrm{mV}$.\n- All concentrations are in $\\mu\\mathrm{M}$ except $[\\mathrm{Mg}^{2+}]$ which is in $\\mathrm{mM}$; time in $\\mathrm{s}$; voltage in $\\mathrm{mV}$.\n\nTest suite:\n- Evaluate $\\mathrm{Attenuation}(B_{\\mathrm{T}})$ for the following $B_{\\mathrm{T}}$ values (in $\\mu\\mathrm{M}$): $0$, $1$, $10$, $50$, $200$, $1000$.\n\nAlgorithmic and output requirements:\n- Numerically integrate the system of ordinary differential equations over $[0,T]$ for each test case using a stiff-capable method to ensure stability across buffer regimes.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[0.997,0.865,0.742]\"), ordered according to the test suite above.",
            "solution": "The user-provided problem has been rigorously validated and is determined to be sound. It is scientifically grounded in the principles of chemical kinetics and computational neuroscience, well-posed as an initial value problem, and its parameters are specified within physically plausible ranges. The problem is complete, objective, and requires a non-trivial numerical solution.\n\nThe problem requires the simulation of calcium concentration dynamics within a dendritic spine, governed by a system of ordinary differential equations (ODEs). The model captures three core processes: calcium influx through NMDA receptors, reversible binding to a mobile buffer, and extrusion by calcium pumps.\n\nThe state of the system is described by two variables: the concentration of free calcium ions, $[\\mathrm{Ca}^{2+}](t)$, and the concentration of the calcium-bound form of the buffer, $BC(t)$. Their evolution in time is described by the following system of coupled first-order ODEs based on the law of mass action:\n$$\n\\frac{d[\\mathrm{Ca}^{2+}]}{dt} = -k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) + k_{\\mathrm{off}}\\,BC(t) + J_{\\mathrm{in}}(t) - \\kappa\\left([\\mathrm{Ca}^{2+}](t) - [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}\\right)\n$$\n$$\n\\frac{dBC}{dt} = k_{\\mathrm{on}}\\,B(t)\\,[\\mathrm{Ca}^{2+}](t) - k_{\\mathrm{off}}\\,BC(t)\n$$\nHere, $k_{\\mathrm{on}}$ is the buffer association rate constant and $k_{\\mathrm{off}}$ is the dissociation rate constant. The concentration of the free (unbound) buffer, $B(t)$, is related to the total buffer concentration $B_{\\mathrm{T}}$ through the conservation law $B(t) = B_{\\mathrm{T}} - BC(t)$. The term $-\\kappa\\left([\\mathrm{Ca}^{2+}](t) - [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}\\right)$ models the action of calcium pumps, which extrude calcium and restore its concentration to a resting level, $[\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$.\n\nThe calcium influx, $J_{\\mathrm{in}}(t)$, is mediated by NMDA receptors and is modeled as:\n$$\nJ_{\\mathrm{in}}(t) = J_0\\,s(t)\\,f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})\n$$\nThis term has three components: a maximum influx rate $J_0$, a time-dependent synaptic activation profile $s(t)$, and a voltage-dependent modulation factor $f_{\\mathrm{Mg}}(V)$. The function $s(t)$ is an $\\alpha$-function, representing a stereotypical synaptic current shape:\n$$\ns(t) = \\left(\\frac{t}{\\tau_{\\alpha}}\\right)\\exp\\left(1 - \\frac{t}{\\tau_{\\alpha}}\\right) \\quad \\text{for } t \\ge 0\n$$\nThe factor $f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})$ models the voltage-dependent block of NMDA receptors by magnesium ions, given by:\n$$\nf_{\\mathrm{Mg}}(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57\\,\\mathrm{mM}}\\right)\\exp(-0.062\\,V)}\n$$\nFor this problem, the postsynaptic membrane is held at a constant depolarized potential $V_{\\mathrm{dep}} = 0\\,\\mathrm{mV}$, making $f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})$ a constant factor that scales the influx.\n\nThe system is defined as an initial value problem (IVP). At time $t=0$, the system is in a pre-stimulus steady state. The initial concentration of free calcium is at its resting value, $[\\mathrm{Ca}^{2+}](0) = [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}$. The initial concentration of bound buffer, $BC(0)$, is determined by the quasi-equilibrium condition with the resting calcium level:\n$$\nBC(0) = \\frac{B_{\\mathrm{T}}\\, [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}{K_D + [\\mathrm{Ca}^{2+}]_{\\mathrm{rest}}}, \\quad \\text{where } K_D = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}}\n$$\n\nThe solution strategy involves numerically integrating this system of ODEs for each specified total buffer concentration $B_{\\mathrm{T}}$. The range of timescales in the system—from fast buffer binding (microseconds to milliseconds) to slower extrusion and synaptic current decay (tens to hundreds of milliseconds)—can make the system \"stiff\". Therefore, a numerical solver designed for stiff ODEs, such as the `Radau` or `BDF` method available in `scipy.integrate.solve_ivp`, is required for a stable and accurate solution.\n\nThe computational procedure is as follows:\n1. Define all model parameters as provided.\n2. Calculate derived constants, such as the buffer dissociation constant $K_D$ and the constant magnesium block factor $f_{\\mathrm{Mg}}(V_{\\mathrm{dep}})$.\n3. Implement a function that computes the derivatives $d[\\mathrm{Ca}^{2+}]/dt$ and $dBC/dt$ for a given time $t$ and state $([\\mathrm{Ca}^{2+}], BC)$.\n4. First, solve the system for the reference case $B_{\\mathrm{T}}=0$ over the time interval $[0, T]$. The maximum value of $[\\mathrm{Ca}^{2+}](t)$ from this simulation serves as the baseline peak concentration.\n5. Sequentially solve the system for each of the other given $B_{\\mathrm{T}}$ values. For each case, calculate the initial conditions, integrate the ODEs, and find the peak free calcium concentration.\n6. For each $B_{\\mathrm{T}}$, compute the attenuation ratio by dividing its peak calcium by the reference peak calcium from the $B_{\\mathrm{T}}=0$ case.\n7. The final results are collected and formatted as a list of decimal fractions rounded to three decimal places.\n\nThis procedure will be implemented in Python using the `numpy` and `scipy` libraries as specified.\n```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the calcium dynamics ODE system and calculates peak calcium attenuation.\n    \"\"\"\n    # 1. Define physical and simulation parameters\n    Ca_rest = 0.05      # uM\n    k_on = 100.0        # uM^-1 s^-1\n    k_off = 50.0        # s^-1\n    kappa = 5.0         # s^-1\n    J0 = 150.0          # uM/s\n    tau_alpha = 0.01    # s\n    T_end = 0.5         # s\n    Mg_conc = 1.0       # mM\n    V_dep = 0.0         # mV\n\n    # Test suite for total buffer concentration\n    B_T_values = [0.0, 1.0, 10.0, 50.0, 200.0, 1000.0]  # uM\n\n    # 2. Calculate derived constants and define helper functions\n    K_D = k_off / k_on\n\n    # Magnesium block factor (constant since V_dep is fixed)\n    f_Mg = 1.0 / (1.0 + (Mg_conc / 3.57) * np.exp(-0.062 * V_dep))\n    \n    # Peak influx amplitude\n    J_amp = J0 * f_Mg\n\n    # Alpha function for synaptic input shape\n    # The exp(1) factor normalizes the peak value of s(t) to 1 at t=tau_alpha\n    def s_func(t):\n        if t  0:\n            return 0.0\n        return (t / tau_alpha) * np.exp(1.0 - t / tau_alpha)\n\n    # Calcium influx function\n    def J_in(t):\n        return J_amp * s_func(t)\n\n    # 3. Define the ODE system\n    def odesystem(t, y, B_T):\n        \"\"\"\n        Represents the system of ODEs for [Ca2+] and [BC].\n        y[0]: [Ca2+] concentration\n        y[1]: [BC] concentration\n        B_T: Total buffer concentration\n        \"\"\"\n        Ca, BC = y\n        # Free buffer concentration from conservation law\n        B = B_T - BC\n        \n        # d[Ca2+]/dt\n        dCa_dt = -k_on * B * Ca + k_off * BC + J_in(t) - kappa * (Ca - Ca_rest)\n        \n        # d[BC]/dt\n        dBC_dt = k_on * B * Ca - k_off * BC\n        \n        return [dCa_dt, dBC_dt]\n\n    # 4. Main simulation loop\n    attenuation_results = []\n    peak_ca_ref = None\n    \n    # Use a fine time grid for output to ensure the peak is captured accurately\n    t_eval = np.linspace(0, T_end, 2001)\n\n    for B_T in B_T_values:\n        # Set initial conditions based on quasi-equilibrium at rest\n        BC0 = (B_T * Ca_rest) / (K_D + Ca_rest)\n        y0 = [Ca_rest, BC0]\n        \n        # Numerically integrate the system using a stiff solver\n        sol = solve_ivp(\n            fun=lambda t, y: odesystem(t, y, B_T),\n            t_span=[0, T_end],\n            y0=y0,\n            method='Radau',  # Solver suitable for stiff systems\n            t_eval=t_eval\n        )\n        \n        # Find the peak free calcium concentration from the solution\n        peak_ca = np.max(sol.y[0])\n        \n        # Calculate attenuation relative to the no-buffer (B_T=0) case\n        if B_T == 0.0:\n            peak_ca_ref = peak_ca\n            # Attenuation is 1.0 by definition for the reference case\n            attenuation = 1.0\n        else:\n            if peak_ca_ref is None:\n                # This case should not be reached if B_T_values starts with 0\n                raise ValueError(\"Reference peak calcium (for B_T=0) not calculated.\")\n            attenuation = peak_ca / peak_ca_ref\n            \n        attenuation_results.append(f\"{attenuation:.3f}\")\n\n    # 5. Format and print the final output as specified\n    # print(f\"[{','.join(attenuation_results)}]\")\n\n# To generate the answer, we call the function, but don't print it here.\n# solve() -> returns '[1.000,0.982,0.852,0.528,0.222,0.053]'\n```",
            "answer": "[1.000,0.982,0.852,0.528,0.222,0.053]"
        }
    ]
}