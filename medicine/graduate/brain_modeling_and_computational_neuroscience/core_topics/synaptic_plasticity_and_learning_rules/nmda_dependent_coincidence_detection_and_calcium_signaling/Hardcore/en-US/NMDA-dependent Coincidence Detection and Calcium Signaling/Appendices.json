{
    "hands_on_practices": [
        {
            "introduction": "The NMDA receptor's function as a molecular coincidence detector is fundamentally rooted in its voltage-dependent block by magnesium ions. This practice provides a deep dive into the biophysical underpinnings of this mechanism. By deriving the relationship between membrane potential and channel unblocking from first principles, you will gain a quantitative understanding of what it takes to \"open the gate\" for calcium influx .",
            "id": "4005615",
            "problem": "Consider a single-synapse model of N-methyl-D-aspartate (NMDA) receptor-mediated calcium signaling during spike-timing-dependent coincidence detection. The essential mechanism is the voltage-dependent block by extracellular magnesium ions $\\left[\\mathrm{Mg}^{2+}\\right]$ at a binding site within the membrane electric field. Assume the following foundational biophysical facts:\n\n- The equilibrium occupancy of a single blocking site by a divalent ion with valence $z$ embedded at fractional electrical distance $\\delta$ from the extracellular side is governed by a Boltzmann factor that modifies the apparent dissociation constant according to $K_{d}(V) = K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)$, where $K_{d}^{0}$ is the dissociation constant at $V=0$, $F$ is the Faraday constant, $R$ is the gas constant, and $T$ is absolute temperature.\n- Under rapid glutamate binding and channel opening at the moment of coincidence, the instantaneous fraction of NMDA channels that are unblocked by magnesium is given by the fraction of binding sites not occupied at voltage $V$.\n\nDefine the unblocked fraction $b(V)$ as the fraction of channels not blocked by $\\mathrm{Mg}^{2+}$ at membrane potential $V$, derived from the equilibrium between blocker concentration and binding site occupancy. Effective coincidence detection is achieved when $b(V)$ exceeds a threshold $b^{\\ast}$, which is determined by the calcium microdomain requirement for activating downstream signaling. For this problem, take $b^{\\ast} = 0.20$.\n\nUsing the above physical bases and definitions, derive an expression for the membrane potential $V^{\\ast}$ at which $b(V^{\\ast}) = b^{\\ast}$ as a function of $\\left[\\mathrm{Mg}^{2+}\\right]$, $K_{d}^{0}$, $z$, $\\delta$, $F$, $R$, and $T$. Then, for a neuron with resting potential $V_{\\mathrm{rest}} = -65 \\ \\mathrm{mV}$, compute the required depolarization $\\Delta V = V^{\\ast} - V_{\\mathrm{rest}}$ for two extracellular magnesium concentrations: $\\left[\\mathrm{Mg}^{2+}\\right] = 1.0 \\ \\mathrm{mM}$ and $\\left[\\mathrm{Mg}^{2+}\\right] = 2.0 \\ \\mathrm{mM}$.\n\nUse $z = 2$, $\\delta = 0.70$, $F = 96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1}$, $R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$, $T = 310 \\ \\mathrm{K}$, and $K_{d}^{0} = 1.0 \\ \\mathrm{mM}$. Express the final depolarizations in $\\mathrm{mV}$. Round your answers to four significant figures.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded, well-posed, objective, and internally consistent. It describes a standard biophysical model of NMDA receptor function (the Woodhull model) and poses a solvable quantitative question.\n\nThe first step is to derive an explicit expression for the unblocked fraction of NMDA channels, $b(V)$. The binding of a magnesium ion, $\\mathrm{Mg}^{2+}$, to the blocking site inside the channel pore can be described as a reversible reaction:\n$$\n\\text{Unblocked Channel} + \\mathrm{Mg}^{2+} \\rightleftharpoons \\text{Blocked Channel}\n$$\nAt equilibrium, the relationship between the concentrations of the reactants and products is defined by the dissociation constant, $K_{d}$. In this context, the entities are fractions of states, so we consider the fraction of unblocked sites, $b$, and the fraction of blocked sites, $1-b$. The blocker is the extracellular magnesium concentration, $\\left[\\mathrm{Mg}^{2+}\\right]$. The voltage-dependent dissociation constant, $K_{d}(V)$, is given as:\n$$\nK_{d}(V) = \\frac{b \\cdot \\left[\\mathrm{Mg}^{2+}\\right]}{1-b}\n$$\nThis equation can be rearranged to solve for the unblocked fraction, $b$, which we denote as $b(V)$ to make its voltage dependence explicit:\n$$\nK_{d}(V) (1-b(V)) = b(V) \\left[\\mathrm{Mg}^{2+}\\right]\n$$\n$$\nK_{d}(V) = b(V) K_{d}(V) + b(V) \\left[\\mathrm{Mg}^{2+}\\right] = b(V) \\left( K_{d}(V) + \\left[\\mathrm{Mg}^{2+}\\right] \\right)\n$$\n$$\nb(V) = \\frac{K_{d}(V)}{K_{d}(V) + \\left[\\mathrm{Mg}^{2+}\\right]} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}(V)}}\n$$\nThe problem provides the expression for the voltage-dependent dissociation constant:\n$$\nK_{d}(V) = K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)\n$$\nwhere $K_{d}^{0}$ is the dissociation constant at $V=0$, $z$ is the ion valence, $\\delta$ is the fractional electrical distance of the binding site, $F$ is the Faraday constant, $R$ is the gas constant, and $T$ is the absolute temperature.\n\nSubstituting this into the expression for $b(V)$ yields:\n$$\nb(V) = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}\\,\\exp\\!\\left(\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)}} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V}{R\\,T}\\right)}\n$$\nThe problem requires deriving an expression for the membrane potential $V^{\\ast}$ at which the unblocked fraction reaches a threshold value $b^{\\ast}$. We set $b(V^{\\ast}) = b^{\\ast}$:\n$$\nb^{\\ast} = \\frac{1}{1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)}\n$$\nWe now solve for $V^{\\ast}$:\n$$\n\\frac{1}{b^{\\ast}} = 1 + \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n$$\n\\frac{1}{b^{\\ast}} - 1 = \\frac{1-b^{\\ast}}{b^{\\ast}} = \\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\n$$\n\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}} = \\exp\\!\\left(-\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\\right)\n$$\nTaking the natural logarithm of both sides:\n$$\n\\ln\\left(\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}}\\right) = -\\frac{z\\,\\delta\\,F\\,V^{\\ast}}{R\\,T}\n$$\nFinally, isolating $V^{\\ast}$:\n$$\nV^{\\ast} = -\\frac{R\\,T}{z\\,\\delta\\,F} \\ln\\left(\\frac{K_{d}^{0}}{\\left[\\mathrm{Mg}^{2+}\\right]} \\frac{1-b^{\\ast}}{b^{\\ast}}\\right)\n$$\nUsing the property $\\ln(1/x) = -\\ln(x)$, we can write this in a more convenient form:\n$$\nV^{\\ast} = \\frac{R\\,T}{z\\,\\delta\\,F} \\ln\\left(\\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{K_{d}^{0}} \\frac{b^{\\ast}}{1-b^{\\ast}}\\right)\n$$\nThis is the general expression for the threshold potential $V^{\\ast}$.\n\nNext, we compute the numerical value of $V^{\\ast}$ and the required depolarization $\\Delta V = V^{\\ast} - V_{\\mathrm{rest}}$ for the two specified cases. The given parameters are:\n$z = 2$\n$\\delta = 0.70$\n$F = 96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1}$\n$R = 8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1}$\n$T = 310 \\ \\mathrm{K}$\n$K_{d}^{0} = 1.0 \\ \\mathrm{mM}$\n$b^{\\ast} = 0.20$\n$V_{\\mathrm{rest}} = -65 \\ \\mathrm{mV}$\n\nFirst, let's compute the constant pre-factor $\\frac{R\\,T}{z\\,\\delta\\,F}$:\n$$\n\\frac{R\\,T}{z\\,\\delta\\,F} = \\frac{(8.314 \\ \\mathrm{J} \\ \\mathrm{mol}^{-1} \\ \\mathrm{K}^{-1})(310 \\ \\mathrm{K})}{(2)(0.70)(96485 \\ \\mathrm{C} \\ \\mathrm{mol}^{-1})} = \\frac{2577.34}{135079} \\ \\mathrm{V} \\approx 0.0190801 \\ \\mathrm{V} = 19.0801 \\ \\mathrm{mV}\n$$\nAnd the term involving $b^{\\ast}$:\n$$\n\\frac{b^{\\ast}}{1-b^{\\ast}} = \\frac{0.20}{1-0.20} = \\frac{0.20}{0.80} = 0.25\n$$\nSo the expression for $V^{\\ast}$ becomes:\n$$\nV^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{\\left[\\mathrm{Mg}^{2+}\\right]}{1.0 \\ \\mathrm{mM}} \\times 0.25\\right)\n$$\n\nCase 1: $\\left[\\mathrm{Mg}^{2+}\\right] = 1.0 \\ \\mathrm{mM}$\n$$\nV_{1}^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{1.0}{1.0} \\times 0.25\\right) = (19.0801 \\ \\mathrm{mV}) \\ln(0.25) \\approx (19.0801 \\ \\mathrm{mV})(-1.38629) \\approx -26.4565 \\ \\mathrm{mV}\n$$\nThe required depolarization is:\n$$\n\\Delta V_{1} = V_{1}^{\\ast} - V_{\\mathrm{rest}} \\approx -26.4565 \\ \\mathrm{mV} - (-65 \\ \\mathrm{mV}) = 38.5435 \\ \\mathrm{mV}\n$$\nRounding to four significant figures, $\\Delta V_{1} = 38.54 \\ \\mathrm{mV}$.\n\nCase 2: $\\left[\\mathrm{Mg}^{2+}\\right] = 2.0 \\ \\mathrm{mM}$\n$$\nV_{2}^{\\ast} = (19.0801 \\ \\mathrm{mV}) \\ln\\left(\\frac{2.0}{1.0} \\times 0.25\\right) = (19.0801 \\ \\mathrm{mV}) \\ln(0.5) \\approx (19.0801 \\ \\mathrm{mV})(-0.693147) \\approx -13.2282 \\ \\mathrm{mV}\n$$\nThe required depolarization is:\n$$\n\\Delta V_{2} = V_{2}^{\\ast} - V_{\\mathrm{rest}} \\approx -13.2282 \\ \\mathrm{mV} - (-65 \\ \\mathrm{mV}) = 51.7718 \\ \\mathrm{mV}\n$$\nRounding to four significant figures, $\\Delta V_{2} = 51.77 \\ \\mathrm{mV}$.\n\nThe results indicate that a larger depolarization is needed to relieve the magnesium block when the extracellular magnesium concentration is higher, which is consistent with biophysical principles.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n38.54 & 51.77\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With a grasp of the principles of magnesium block, we can now simulate the entire coincidence detection event. This exercise requires you to construct a model that integrates a presynaptic glutamate signal with a postsynaptic back-propagating action potential, calculating the resulting calcium influx from both NMDA receptors and voltage-gated calcium channels (VGCCs). By exploring different timings and conditions, you will quantify how the precise temporal relationship between inputs dictates the magnitude of the calcium signal .",
            "id": "4005633",
            "problem": "You are asked to compute the total calcium influx per spike pair in a dendritic compartment receiving a single glutamatergic input and a backpropagating action potential, using a conductance-based model with canonical biophysical components for N-Methyl-D-Aspartate (NMDA) receptors and voltage-gated calcium channels (VGCC). The model incorporates voltage-dependent magnesium block of NMDA receptors, a calcium fraction of NMDA current, and a voltage-dependent activation for VGCC. Your solution must implement the specified waveforms for membrane voltage and glutamate gating, derive the calcium currents, and integrate them over time to obtain charge.\n\nFundamental base and definitions to use:\n\n- Use the linear current relation $I = g \\cdot a(V,t) \\cdot (V - E)$, where $I$ is current, $g$ is maximal conductance, $a(V,t)$ is a gating or modulatory factor potentially dependent on voltage $V$ and time $t$, and $E$ is the reversal potential. When applied to NMDA, $a(V,t)$ is the product of a glutamate-gating waveform and a magnesium block factor. When applied to VGCC, $a(V,t)$ is the steady-state activation function.\n\n- Use the definition of charge as the time integral of current, $Q = \\int I(t) \\, dt$. Define calcium influx as positive for inward calcium current. If $I_{\\mathrm{Ca}}(t)$ is negative (inward), influx is $Q_{\\mathrm{influx}} = -\\int I_{\\mathrm{Ca}}(t) \\, dt$.\n\n- Use the widely accepted empirical magnesium block for NMDA: \n$$B(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}]}{3.57}\\right) \\exp(-0.062 \\, V)}$$\nwhere $[\\mathrm{Mg}]$ is extracellular magnesium concentration in $\\mathrm{mM}$ and $V$ is in $\\mathrm{mV}$.\n\n- Use a steady-state voltage-dependent activation for VGCC:\n$$m_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{1/2}}{k}\\right)}$$\n\nWaveforms:\n\n- The membrane potential is modeled as baseline plus a backpropagating spike modeled by a difference of exponentials:\n$$V(t) = V_{\\mathrm{rest}} + A_{\\mathrm{AP}}\\left[\\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{f}}}\\right) - \\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{r}}}\\right)\\right] H(t - t_{\\mathrm{post}})$$\nwhere $H(\\cdot)$ is the Heaviside step function, $V_{\\mathrm{rest}}$ is resting potential, $A_{\\mathrm{AP}}$ is spike amplitude, $\\tau_{\\mathrm{r}}$ is rise time constant, and $\\tau_{\\mathrm{f}}$ is decay time constant.\n\n- The glutamate gating waveform is an alpha function:\n$$G(t) = A_{\\mathrm{G}} \\cdot \\left(\\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) \\exp\\left(1 - \\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) H(t - t_{\\mathrm{pre}})$$\nwhere $A_{\\mathrm{G}}$ is the glutamate amplitude, $t_{\\mathrm{pre}}$ is the presynaptic time, and $\\tau_{\\mathrm{g}}$ is the glutamate timescale. The peak value of the alpha function occurs at $t = t_{\\mathrm{pre}} + \\tau_{\\mathrm{g}}$ and has unit amplitude when $A_{\\mathrm{G}} = 1$.\n\nCurrents to compute:\n\n- NMDA current:\n$$I_{\\mathrm{NMDA}}(t) = g_{\\mathrm{NMDA}} \\cdot B(V(t)) \\cdot G(t) \\cdot \\left(V(t) - E_{\\mathrm{NMDA}}\\right)$$\n\n- Calcium component of NMDA current:\n$$I_{\\mathrm{Ca,NMDA}}(t) = P_{\\mathrm{Ca}} \\cdot I_{\\mathrm{NMDA}}(t)$$\nwhere $P_{\\mathrm{Ca}}$ is the fraction of NMDA current carried by calcium.\n\n- VGCC calcium current:\n$$I_{\\mathrm{Ca,VGCC}}(t) = g_{\\mathrm{VGCC}} \\cdot m_{\\infty}(V(t)) \\cdot \\left(V(t) - E_{\\mathrm{Ca}}\\right)$$\n\nTotal calcium current:\n$$I_{\\mathrm{Ca,tot}}(t) = I_{\\mathrm{Ca,NMDA}}(t) + I_{\\mathrm{Ca,VGCC}}(t)$$\n\nTotal calcium influx per spike pair:\n$$Q_{\\mathrm{Ca}} = -\\int_{0}^{T_{\\mathrm{max}}} I_{\\mathrm{Ca,tot}}(t) \\, dt$$\n\nUnits:\n\n- Use $g_{\\mathrm{NMDA}}$ and $g_{\\mathrm{VGCC}}$ in $\\mathrm{nS}$.\n- Use $V(t)$, $E_{\\mathrm{NMDA}}$, $E_{\\mathrm{Ca}}$, and $V_{1/2}$ in $\\mathrm{mV}$.\n- Use time in $\\mathrm{ms}$.\n- Currents computed as $I = g \\cdot (V - E)$ with $g$ in $\\mathrm{nS}$ and $V - E$ in $\\mathrm{mV}$ yield $I$ in $\\mathrm{pA}$. Integrating $I$ in $\\mathrm{pA}$ over time in $\\mathrm{ms}$ yields charge in $\\mathrm{fC}$; convert to $\\mathrm{pC}$ by dividing by $1000$.\n- Express the final calcium influx in $\\mathrm{pC}$ as a decimal number rounded to six digits after the decimal point.\n\nFixed constants for all test cases:\n\n- $V_{\\mathrm{rest}} = -65.0 \\, \\mathrm{mV}$.\n- $A_{\\mathrm{AP}} = 100.0 \\, \\mathrm{mV}$.\n- $\\tau_{\\mathrm{r}} = 0.5 \\, \\mathrm{ms}$, $\\tau_{\\mathrm{f}} = 2.0 \\, \\mathrm{ms}$.\n- $\\tau_{\\mathrm{g}} = 5.0 \\, \\mathrm{ms}$.\n- $E_{\\mathrm{NMDA}} = 0.0 \\, \\mathrm{mV}$.\n- $E_{\\mathrm{Ca}} = 120.0 \\, \\mathrm{mV}$.\n- $V_{1/2} = -20.0 \\, \\mathrm{mV}$, $k = 6.0 \\, \\mathrm{mV}$.\n- Time grid: $T_{\\mathrm{max}} = 120.0 \\, \\mathrm{ms}$, time step $\\Delta t = 0.01 \\, \\mathrm{ms}$.\n\nTest suite:\n\nProvide four parameter sets $(g_{\\mathrm{NMDA}}, P_{\\mathrm{Ca}}, g_{\\mathrm{VGCC}}, t_{\\mathrm{pre}}, t_{\\mathrm{post}}, A_{\\mathrm{G}}, [\\mathrm{Mg}])$:\n\n1. Case $1$ (near-coincident pre-post, moderate conductances): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 1.0, 1.0 \\, \\mathrm{mM})$.\n\n2. Case $2$ (anti-causal timing with weaker coincidence): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 60.0 \\, \\mathrm{ms}, 50.0 \\, \\mathrm{ms}, 1.0, 1.0 \\, \\mathrm{mM})$.\n\n3. Case $3$ (no glutamate release, VGCC-only influx): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 0.0, 1.0 \\, \\mathrm{mM})$.\n\n4. Case $4$ (near-coincident timing with high magnesium block): $(5.0 \\, \\mathrm{nS}, 0.12, 4.0 \\, \\mathrm{nS}, 50.0 \\, \\mathrm{ms}, 52.0 \\, \\mathrm{ms}, 1.0, 3.0 \\, \\mathrm{mM})$.\n\nRequired final output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the total calcium influx $Q_{\\mathrm{Ca}}$ in $\\mathrm{pC}$ for the corresponding test case, rounded to six decimal places (for example, $[0.012345,0.001234,0.000987,0.009999]$).",
            "solution": "The problem requires the computation of the total calcium influx, $Q_{\\mathrm{Ca}}$, in a dendritic compartment model following a presynaptic glutamate release and a postsynaptic backpropagating action potential (bAP). The solution involves numerically integrating the total calcium current over a specified time interval. The model incorporates N-Methyl-D-Aspartate (NMDA) receptors and voltage-gated calcium channels (VGCCs) as the sources of calcium. The approach is to discretize time and calculate the state of the system at each time step, then sum the contributions to obtain the total charge.\n\nThe fundamental steps are as follows:\n1.  **Time Discretization**: A discrete time grid is established from $t=0$ to $t=T_{\\mathrm{max}}$ with a step size of $\\Delta t$. All time-dependent functions will be evaluated on this grid.\n    $T_{\\mathrm{max}} = 120.0 \\, \\mathrm{ms}$ and $\\Delta t = 0.01 \\, \\mathrm{ms}$.\n\n2.  **Waveform Generation**: The membrane potential $V(t)$ and glutamate gating $G(t)$ waveforms are computed for all time points.\n    -   The membrane potential, $V(t)$, is the sum of the resting potential $V_{\\mathrm{rest}}$ and a time-dependent component representing the bAP, active only for $t \\geq t_{\\mathrm{post}}$.\n        $$V(t) = V_{\\mathrm{rest}} + A_{\\mathrm{AP}}\\left[\\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{f}}}\\right) - \\exp\\left(-\\frac{t - t_{\\mathrm{post}}}{\\tau_{\\mathrm{r}}}\\right)\\right] H(t - t_{\\mathrm{post}})$$\n        Here, $H(\\cdot)$ is the Heaviside step function, $V_{\\mathrm{rest}} = -65.0 \\, \\mathrm{mV}$, $A_{\\mathrm{AP}} = 100.0 \\, \\mathrm{mV}$, $\\tau_{\\mathrm{r}} = 0.5 \\, \\mathrm{ms}$, and $\\tau_{\\mathrm{f}} = 2.0 \\, \\mathrm{ms}$.\n    -   The glutamate gating variable, $G(t)$, is described by an alpha function, active for $t \\geq t_{\\mathrm{pre}}$.\n        $$G(t) = A_{\\mathrm{G}} \\cdot \\left(\\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) \\exp\\left(1 - \\frac{t - t_{\\mathrm{pre}}}{\\tau_{\\mathrm{g}}}\\right) H(t - t_{\\mathrm{pre}})$$\n        Here, $\\tau_{\\mathrm{g}} = 5.0 \\, \\mathrm{ms}$, and $A_{\\mathrm{G}}$ and $t_{\\mathrm{pre}}$ are given by each test case. When $A_{\\mathrm{G}}=0$, $G(t)=0$ for all $t$.\n\n3.  **Voltage-Dependent Gating and Modulation**: The voltage-dependent terms for both channel types are calculated at each time step using the computed $V(t)$ array.\n    -   The magnesium block of the NMDA receptor, $B(V)$, is given by:\n        $$B(V(t)) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}]}{3.57}\\right) \\exp(-0.062 \\, V(t))}$$\n        where $[\\mathrm{Mg}]$ is a parameter from each test case.\n    -   The steady-state activation of the VGCC, $m_{\\infty}(V)$, is given by a sigmoid function:\n        $$m_{\\infty}(V(t)) = \\frac{1}{1 + \\exp\\left(-\\frac{V(t) - V_{1/2}}{k}\\right)}$$\n        with fixed parameters $V_{1/2} = -20.0 \\, \\mathrm{mV}$ and $k = 6.0 \\, \\mathrm{mV}$.\n\n4.  **Calcium Current Calculation**: The calcium currents from each source are then calculated at each time step.\n    -   The total NMDA current is first calculated:\n        $$I_{\\mathrm{NMDA}}(t) = g_{\\mathrm{NMDA}} \\cdot B(V(t)) \\cdot G(t) \\cdot \\left(V(t) - E_{\\mathrm{NMDA}}\\right)$$\n        The calcium component of this current is a fraction $P_{\\mathrm{Ca}}$ of the total:\n        $$I_{\\mathrm{Ca,NMDA}}(t) = P_{\\mathrm{Ca}} \\cdot I_{\\mathrm{NMDA}}(t)$$\n        The reversal potential is $E_{\\mathrm{NMDA}} = 0.0 \\, \\mathrm{mV}$.\n    -   The VGCC calcium current is:\n        $$I_{\\mathrm{Ca,VGCC}}(t) = g_{\\mathrm{VGCC}} \\cdot m_{\\infty}(V(t)) \\cdot \\left(V(t) - E_{\\mathrm{Ca}}\\right)$$\n        The calcium reversal potential is $E_{\\mathrm{Ca}} = 120.0 \\, \\mathrm{mV}$.\n    -   The total calcium current is the sum of these two components:\n        $$I_{\\mathrm{Ca,tot}}(t) = I_{\\mathrm{Ca,NMDA}}(t) + I_{\\mathrm{Ca,VGCC}}(t)$$\n\n5.  **Numerical Integration and Unit Conversion**: The total calcium influx $Q_{\\mathrm{Ca}}$ is the negative time integral of the total calcium current. This integral is approximated by a sum over the discrete time steps:\n    $$Q_{\\mathrm{Ca}} = -\\int_{0}^{T_{\\mathrm{max}}} I_{\\mathrm{Ca,tot}}(t) \\, dt \\approx -\\sum_{i} I_{\\mathrm{Ca,tot}}(t_i) \\cdot \\Delta t$$\n    The sign is negative because an inward current is negative by convention, and influx is a positive quantity. The units are handled as follows: with conductances ($g_{\\mathrm{NMDA}}, g_{\\mathrm{VGCC}}$) in $\\mathrm{nS}$ and potentials in $\\mathrm{mV}$, the resulting current $I$ is in $\\mathrm{pA}$ ($10^{-12} \\, \\mathrm{A}$). Integrating current in $\\mathrm{pA}$ over time in $\\mathrm{ms}$ ($10^{-3} \\, \\mathrm{s}$) gives charge in $\\mathrm{fC}$ ($10^{-15} \\, \\mathrm{C}$). A final conversion to picocoulombs ($\\mathrm{pC}$) is performed by dividing the result in $\\mathrm{fC}$ by $1000$. The result is then rounded to six decimal places.\n\nThis entire procedure is repeated for each of the four parameter sets provided in the test suite. The implementation uses vector operations provided by the `numpy` library for efficiency.",
            "answer": "[0.081829,0.024225,0.018080,0.053744]"
        },
        {
            "introduction": "Coincidence detection does not occur in a vacuum; it is constantly modulated by other synaptic inputs. This practice explores the powerful role of shunting inhibition, which can dramatically alter a neuron's response to excitatory inputs by clamping the membrane potential near the resting potential. By incorporating a shunting conductance into your model, you will investigate how local inhibitory activity can gate or suppress NMDA-dependent calcium signaling, providing a critical link between network state and synaptic plasticity .",
            "id": "4005586",
            "problem": "You are asked to build a principled, self-contained single-compartment model to study N-methyl-D-aspartate (NMDA) receptor-mediated coincidence detection and calcium entry under shunting inhibition modeled as an increase in membrane conductance. Start only from the following bases: (i) electrical current balance for a single isopotential compartment, (ii) Ohm’s law for ionic currents, (iii) standard first-order gating by alpha functions for synaptic conductances, and (iv) a well-tested empirical form for magnesium block of NMDA receptors.\n\nAssume a point neuron with membrane potential $V(t)$, membrane capacitance $C_{\\mathrm{m}}$, leak conductance $g_{\\mathrm{L}}$, and leak reversal potential $E_{\\mathrm{L}}$. The compartment receives an excitatory synaptic input with two components: a fast alpha-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid (AMPA) conductance and a slow N-methyl-D-aspartate (NMDA) conductance. Shunting inhibition is modeled as a purely leak-like increase in conductance with the same reversal as leak. A back-propagating action potential (bAP) is modeled as a transient injected current.\n\nUse the standard current balance in current-clamp form:\n$$\nC_{\\mathrm{m}}\\frac{dV}{dt} \\;=\\; -I_{\\mathrm{ion}}(V,t) \\;+\\; I_{\\mathrm{inj}}(t),\n$$\nwith total outward ionic current\n$$\nI_{\\mathrm{ion}}(V,t) \\;=\\; g_{\\mathrm{L}}(V - E_{\\mathrm{L}})\n\\;+\\; g_{\\mathrm{sh}}(t)(V - E_{\\mathrm{L}})\n\\;+\\; g_{\\mathrm{AMPA}}(t)(V - E_{\\mathrm{E}})\n\\;+\\; g_{\\mathrm{NMDA,M}}(t)\\,B(V)\\,(V - E_{\\mathrm{E}})\n\\;+\\; g_{\\mathrm{NMDA,Ca}}(t)\\,B(V)\\,(V - E_{\\mathrm{Ca}}).\n$$\nHere $E_{\\mathrm{E}}$ is the excitatory reversal potential for the monovalent pathway, and $E_{\\mathrm{Ca}}$ is the calcium reversal potential. The NMDA current is decomposed into monovalent and calcium parallel conductances weighted by an empirical fraction. The factor $B(V)$ represents magnesium block and is given by the widely used Jahr–Stevens form:\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57\\,\\mathrm{mM}}\\right)\\,\\exp\\!\\left(-0.062\\,V_{\\mathrm{mV}}\\right)},\n$$\nwhere $V_{\\mathrm{mV}}$ is the membrane potential in millivolts.\n\nAll synaptic and shunt conductances are governed by alpha functions,\n$$\ns_{\\alpha}(t;t_0,\\tau) \\;=\\;\n\\begin{cases}\n\\frac{t-t_0}{\\tau}\\,\\exp\\!\\left(1-\\frac{t-t_0}{\\tau}\\right), & t \\ge t_0,\\\\\n0, & t < t_0,\n\\end{cases}\n$$\nwhich peak at $t=t_0+\\tau$ with unit amplitude. Parameterize the conductances as\n$$\ng_{\\mathrm{AMPA}}(t) \\,=\\, \\bar{g}_{\\mathrm{AMPA}}\\,s_{\\alpha}(t;t_{\\mathrm{E}},\\tau_{\\mathrm{A}}),\\quad\ng_{\\mathrm{NMDA,M}}(t) \\,=\\, (1-f_{\\mathrm{Ca}})\\,\\bar{g}_{\\mathrm{NMDA}}\\,s_{\\alpha}(t;t_{\\mathrm{E}},\\tau_{\\mathrm{N}}),\\quad\ng_{\\mathrm{NMDA,Ca}}(t) \\,=\\, f_{\\mathrm{Ca}}\\,\\bar{g}_{\\mathrm{NMDA}}\\,s_{\\alpha}(t;t_{\\mathrm{E}},\\tau_{\\mathrm{N}}),\n$$\n$$\ng_{\\mathrm{sh}}(t) \\,=\\, \\bar{g}_{\\mathrm{sh}}\\,s_{\\alpha}(t;t_{\\mathrm{I}},\\tau_{\\mathrm{sh}}).\n$$\nThe injected current modeling a bAP is a Gaussian pulse:\n$$\nI_{\\mathrm{inj}}(t) \\;=\\;\n\\begin{cases}\nI_0\\,\\exp\\!\\left(-\\frac{(t-t_{\\mathrm{B}})^2}{2\\sigma^2}\\right), & \\text{if bAP is present},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nUse the following fixed parameters (use the exact numerical values as given):\n- Membrane properties: $C_{\\mathrm{m}}=200\\,\\mathrm{pF}$, $g_{\\mathrm{L}}=10\\,\\mathrm{nS}$, $E_{\\mathrm{L}}=-70\\,\\mathrm{mV}$.\n- Reversals: $E_{\\mathrm{E}}=0\\,\\mathrm{mV}$, $E_{\\mathrm{Ca}}=+120\\,\\mathrm{mV}$.\n- Synapse timing: $t_{\\mathrm{E}}=50\\,\\mathrm{ms}$, $t_{\\mathrm{I}}=50\\,\\mathrm{ms}$, $t_{\\mathrm{B}}=55\\,\\mathrm{ms}$.\n- Alpha-function time constants: $\\tau_{\\mathrm{A}}=1.0\\,\\mathrm{ms}$, $\\tau_{\\mathrm{N}}=10.0\\,\\mathrm{ms}$, $\\tau_{\\mathrm{sh}}=3.0\\,\\mathrm{ms}$.\n- Maximal conductances: $\\bar{g}_{\\mathrm{AMPA}}=1.5\\,\\mathrm{nS}$, $\\bar{g}_{\\mathrm{NMDA}}=2.5\\,\\mathrm{nS}$.\n- NMDA calcium fraction: $f_{\\mathrm{Ca}}=0.06$ (dimensionless).\n- Magnesium block concentration baseline: $[\\mathrm{Mg}^{2+}]=1.0\\,\\mathrm{mM}$ unless otherwise specified in a test case.\n- bAP current parameters: $I_0=8.0\\,\\mathrm{nA}$, $\\sigma=0.5\\,\\mathrm{ms}$.\n\nInitialize at rest $V(0)=E_{\\mathrm{L}}$. Simulate for a duration $T=200\\,\\mathrm{ms}$ with time step $\\Delta t=0.02\\,\\mathrm{ms}$. For calcium entry, define the inward calcium charge (positive for inward Ca entry) as\n$$\nQ_{\\mathrm{Ca}} \\;=\\; -\\int_{0}^{T} I_{\\mathrm{NMDA,Ca}}(t)\\,dt,\n$$\nand report $Q_{\\mathrm{Ca}}$ in $\\mathrm{pC}$ (picoCoulombs). For the static NMDA current–voltage ($I$–$V$) relation, define\n$$\nI_{\\mathrm{NMDA,static}}(V) \\;=\\; \\bar{g}_{\\mathrm{NMDA}}\\,B(V)\\,\\big[(1-f_{\\mathrm{Ca}})(V-E_{\\mathrm{E}}) + f_{\\mathrm{Ca}}(V-E_{\\mathrm{Ca}})\\big]\n$$\nwith the NMDA conductance at peak activation ($s_{\\alpha}=1$). Note that $I_{\\mathrm{NMDA,static}}(V)$ is defined as a function of $V$ alone.\n\nTasks and required outputs:\n- Task A (apparent $I$–$V$ invariance under shunt at fixed $V$): Compute the maximum absolute difference, in $\\mathrm{pA}$, between $I_{\\mathrm{NMDA,static}}(V)$ evaluated on the grid $V\\in\\{-80,-79,\\dots,+40\\}\\,\\mathrm{mV}$ with and without shunt. Because the shunt does not enter $I_{\\mathrm{NMDA,static}}(V)$ when $V$ is fixed, the correct result is that the difference is zero within numerical precision. Report the maximum absolute difference in $\\mathrm{pA}$ as a single float.\n- Task B (calcium entry with and without shunt and with/without bAP): Numerically integrate the model to obtain $Q_{\\mathrm{Ca}}$ for the following four cases. Report each $Q_{\\mathrm{Ca}}$ in $\\mathrm{pC}$ as a single float.\n  1. $[\\mathrm{Mg}^{2+}]=1.0\\,\\mathrm{mM}$, no shunt ($\\bar{g}_{\\mathrm{sh}}=0\\,\\mathrm{nS}$), with bAP present.\n  2. $[\\mathrm{Mg}^{2+}]=1.0\\,\\mathrm{mM}$, shunt present with $\\bar{g}_{\\mathrm{sh}}=15\\,\\mathrm{nS}$, with bAP present.\n  3. $[\\mathrm{Mg}^{2+}]=1.0\\,\\mathrm{mM}$, shunt present with $\\bar{g}_{\\mathrm{sh}}=15\\,\\mathrm{nS}$, no bAP.\n  4. $[\\mathrm{Mg}^{2+}]=2.0\\,\\mathrm{mM}$, shunt present with $\\bar{g}_{\\mathrm{sh}}=15\\,\\mathrm{nS}$, with bAP present.\n\nAngle units do not apply. All physical quantities must be handled in SI units internally; final reported units must be as specified above. The membrane potential $V$ is in $\\mathrm{mV}$ when used inside $B(V)$ and in $\\mathrm{V}$ in the current balance; ensure correct unit conversions.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\big[\\Delta I_{\\max}\\_{\\mathrm{pA}},\\;Q_{\\mathrm{Ca},1}\\_{\\mathrm{pC}},\\;Q_{\\mathrm{Ca},2}\\_{\\mathrm{pC}},\\;Q_{\\mathrm{Ca},3}\\_{\\mathrm{pC}},\\;Q_{\\mathrm{Ca},4}\\_{\\mathrm{pC}}\\big],\n$$\nwhere $\\Delta I_{\\max}\\_{\\mathrm{pA}}$ is the Task A result in $\\mathrm{pA}$ and $Q_{\\mathrm{Ca},k}\\_{\\mathrm{pC}}$ are the Task B results in $\\mathrm{pC}$. Each entry must be a float. There must be no extra text printed.",
            "solution": "The problem requires the construction and simulation of a single-compartment neuronal model to investigate NMDA receptor-mediated calcium signaling under various conditions. The model is based on fundamental principles of electrophysiology, and its validity has been confirmed. The solution proceeds by first defining the model mathematically, then outlining the numerical methods for its simulation and analysis, and finally executing the specified tasks.\n\nAll calculations are performed in base SI units (Volts, Amperes, Farads, Siemens, seconds) to ensure physical consistency. Final results are converted to the specified units of picoAmperes ($\\mathrm{pA}$) and picoCoulombs ($\\mathrm{pC}$).\n\nThe core of the model is the current balance equation for the membrane potential $V(t)$:\n$$\nC_{\\mathrm{m}}\\frac{dV}{dt} \\;=\\; -I_{\\mathrm{ion}}(V,t) \\;+\\; I_{\\mathrm{inj}}(t)\n$$\nwhere $C_{\\mathrm{m}}$ is the membrane capacitance, $I_{\\mathrm{ion}}(V,t)$ is the total ionic current flowing out of the cell, and $I_{\\mathrm{inj}}(t)$ is an externally injected current.\n\nThe total ionic current $I_{\\mathrm{ion}}$ is the sum of several components, each following Ohm's law, $I_k = g_k (V - E_k)$:\n$$\nI_{\\mathrm{ion}}(V,t) \\;=\\; I_{\\mathrm{L}} + I_{\\mathrm{sh}} + I_{\\mathrm{AMPA}} + I_{\\mathrm{NMDA,M}} + I_{\\mathrm{NMDA,Ca}}\n$$\nEach component is detailed as follows:\n-   **Leak Current**: $I_{\\mathrm{L}} = g_{\\mathrm{L}}(V - E_{\\mathrm{L}})$ with constant conductance $g_{\\mathrm{L}}$ and reversal potential $E_{\\mathrm{L}}$.\n-   **Shunt Inhibitory Current**: $I_{\\mathrm{sh}} = g_{\\mathrm{sh}}(t)(V - E_{\\mathrm{L}})$ with a time-varying conductance $g_{\\mathrm{sh}}(t)$ and reversal potential $E_{\\mathrm{L}}$.\n-   **AMPA Receptor Current**: $I_{\\mathrm{AMPA}} = g_{\\mathrm{AMPA}}(t)(V - E_{\\mathrm{E}})$ with time-varying conductance $g_{\\mathrm{AMPA}}(t)$ and excitatory reversal potential $E_{\\mathrm{E}}$.\n-   **NMDA Receptor Monovalent Current**: $I_{\\mathrm{NMDA,M}} = g_{\\mathrm{NMDA,M}}(t)\\,B(V)\\,(V - E_{\\mathrm{E}})$ carrying monovalent cations.\n-   **NMDA Receptor Calcium Current**: $I_{\\mathrm{NMDA,Ca}} = g_{\\mathrm{NMDA,Ca}}(t)\\,B(V)\\,(V - E_{\\mathrm{Ca}})$ carrying calcium ions.\n\nThe NMDA currents are subject to a voltage-dependent magnesium block, $B(V)$, given by the empirical Jahr-Stevens formula:\n$$\nB(V) \\;=\\; \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57}\\right)\\,\\exp\\!\\left(-0.062\\,V_{\\mathrm{mV}}\\right)}\n$$\nwhere $V_{\\mathrm{mV}}$ is the membrane potential in millivolts and $[\\mathrm{Mg}^{2+}]$ is the external magnesium concentration in $\\mathrm{mM}$.\n\nAll time-varying synaptic and shunt conductances $g_x(t)$ are described by alpha functions, $g_x(t) = \\bar{g}_x s_{\\alpha}(t; t_0, \\tau_x)$, where $\\bar{g}_x$ is the maximal conductance. The normalized alpha function is:\n$$\ns_{\\alpha}(t;t_0,\\tau) \\;=\\; \\frac{t-t_0}{\\tau}\\,\\exp\\!\\left(1-\\frac{t-t_0}{\\tau}\\right) \\quad \\text{for } t \\ge t_0, \\text{ and } 0 \\text{ otherwise.}\n$$\n\nThe model of a back-propagating action potential (bAP) is an injected Gaussian current pulse:\n$$\nI_{\\mathrm{inj}}(t) \\;=\\; I_0\\,\\exp\\!\\left(-\\frac{(t-t_{\\mathrm{B}})^2}{2\\sigma^2}\\right)\n$$\n\nThe differential equation for $V(t)$ is a first-order ordinary differential equation (ODE). We solve this ODE numerically using the forward Euler method with a small time step $\\Delta t = 0.02\\,\\mathrm{ms}$. The update rule for the voltage $V$ at each time step $i$ is:\n$$\nV_{i+1} = V_i + \\frac{\\Delta t}{C_{\\mathrm{m}}} \\left( -I_{\\mathrm{ion}}(V_i, t_i) + I_{\\mathrm{inj}}(t_i) \\right)\n$$\nThe simulation starts from the initial condition $V(0) = E_{\\mathrm{L}} = -70\\,\\mathrm{mV}$ and runs for a total duration of $T = 200\\,\\mathrm{ms}$.\n\n**Task A: Static $I$–$V$ Relation**\n\nThis task asks for the maximum absolute difference between the static NMDA current-voltage relation, $I_{\\mathrm{NMDA,static}}(V)$, with and without a shunt conductance. The provided definition is:\n$$\nI_{\\mathrm{NMDA,static}}(V) \\;=\\; \\bar{g}_{\\mathrm{NMDA}}\\,B(V)\\,\\big[(1-f_{\\mathrm{Ca}})(V-E_{\\mathrm{E}}) + f_{\\mathrm{Ca}}(V-E_{\\mathrm{Ca}})\\big]\n$$\nThis function is defined for a fixed (clamped) voltage $V$ and with the NMDA conductance at its maximum ($s_{\\alpha}=1$). Critically, its formula does not include any terms related to the shunt conductance $g_{\\mathrm{sh}}$. Therefore, the value of $I_{\\mathrm{NMDA,static}}(V)$ is identical \"with\" and \"without\" the shunt. The difference is mathematically zero for all $V$. Consequently, the maximum absolute difference is $0.0\\,\\mathrm{pA}$.\n\n**Task B: Calcium Charge Calculation**\n\nThis task requires computing the total calcium charge, $Q_{\\mathrm{Ca}}$, entering the neuron over the simulation period for four different scenarios. $Q_{\\mathrm{Ca}}$ is defined as the time integral of the inward calcium current:\n$$\nQ_{\\mathrm{Ca}} \\;=\\; -\\int_{0}^{T} I_{\\mathrm{NMDA,Ca}}(t)\\,dt\n$$\nThe negative sign conventions an outward current as positive, so this definition yields a positive value for inward calcium flow. Numerically, this integral is approximated by a sum over all time steps of the simulation:\n$$\nQ_{\\mathrm{Ca}} \\approx -\\sum_{i=0}^{N-1} I_{\\mathrm{NMDA,Ca}}(V_i, t_i) \\cdot \\Delta t\n$$\nwhere $N = T/\\Delta t$. For each of the four specified cases, the full model is simulated, and the value of $Q_{\\mathrm{Ca}}$ is calculated.\n\nThe four cases are:\n1.  **Baseline with bAP**: No shunt ($\\bar{g}_{\\mathrm{sh}}=0\\,\\mathrm{nS}$), standard magnesium ($[\\mathrm{Mg}^{2+}]=1.0\\,\\mathrm{mM}$), and bAP present. This demonstrates coincidence of synaptic input and bAP leading to significant calcium entry.\n2.  **Shunt with bAP**: Shunt present ($\\bar{g}_{\\mathrm{sh}}=15\\,\\mathrm{nS}$), standard magnesium, and bAP present. The shunt is expected to reduce the depolarization and thus lower the calcium entry compared to case 1.\n3.  **Shunt without bAP**: Shunt present, standard magnesium, but no bAP. Without the strong depolarization from the bAP, the magnesium block on the NMDA receptor remains largely effective, leading to minimal calcium entry.\n4.  **Higher Mg$^{2+}$ with bAP**: Shunt present, bAP present, but with increased magnesium concentration ($[\\mathrm{Mg}^{2+}]=2.0\\,\\mathrm{mM}$). The stronger magnesium block is expected to reduce calcium influx compared to case 2.\n\nThe following code implements this simulation and calculates the required quantities.",
            "answer": "[0.0,0.2227282845680194,0.09346618765275819,0.014280540411709428,0.0658700201633519]"
        }
    ]
}