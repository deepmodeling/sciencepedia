{
    "hands_on_practices": [
        {
            "introduction": "N-甲基-D-天冬氨酸（NMDA）受体是突触可塑性的核心分子，其作为“巧合检测器”的能力是长期增强（LTP）和长期抑制（LTD）的基础。这个练习将指导你从基本的物理化学原理出发，推导出NMDA受体上镁离子（$Mg^{2+}$）阻塞的电压依赖性数学模型。通过掌握这一关键机制的定量描述，你将能够深刻理解突触后去极化是如何与突触前信号协同作用，从而控制钙离子（$Ca^{2+}$）内流并启动可塑性级联反应的。",
            "id": "3995317",
            "problem": "兴奋性突触中长时程增强（LTP）和长时程抑制（LTD）的一个核心机制是N-甲基-D-天冬氨酸（NMDA）受体上镁离子（$Mg^{2+}$）阻断的电压依赖性解除，该机制在峰时序依赖配对过程中控制钙离子（$Ca^{2+}$）的内流。考虑一个用于描述NMDA受体孔道被$Mg^{2+}$阻断的单一位点结合模型，其微观反应为$Mg^{2+} + R \\rightleftharpoons MgR$，其中$R$表示未被阻断的受体，$MgR$表示被阻断的状态。假设以下基本事实成立：\n- 结合速率$k_{\\mathrm{on}}$与膜电压$V$无关，且与细胞外$Mg^{2+}$浓度$[Mg^{2+}]$成正比。\n- 解离（去阻断）速率$k_{\\mathrm{off}}(V)$通过一个玻尔兹曼因子依赖于$V$，该因子源于有效电荷$z$穿过跨膜电位降的一部分（比例为$\\delta$）时所做的电功。因此，电压依赖性解离常数满足$K_{d}(V) = \\frac{k_{\\mathrm{off}}(V)}{k_{\\mathrm{on}}}$且$K_{d}(V) = K_{d}^{0} \\exp\\!\\left(\\frac{z \\delta F V}{R T}\\right)$，其中$K_{d}^{0}$是零电压解离常数，$F$是法拉第常数，$R$是普适气体常数，$T$是绝对温度。\n\n从这些假设出发，并根据未阻断受体比例的定义（即平衡状态下阻断位点未被占据的概率），推导出一个关于电压依赖的未阻断比例$B(V)$的闭合形式表达式，该表达式应使用$[Mg^{2+}]$、$K_{d}^{0}$、$z$、$\\delta$、$F$、$R$、$T$和$V$来表示。然后，利用欧姆离子通道的电导模型描述，写出相应的稳态NMDA受体电流$I_{\\mathrm{NMDA}}(V)$的表达式，该表达式应使用有效电导$g_{\\mathrm{NMDA}}$、推导出的$B(V)$、膜电压$V$和反转电位$E_{\\mathrm{NMDA}}$来表示。\n\n最后，使用以下代表了使突触后棘部分去极化的配对方案的生理学合理参数，计算该电流：\n- 温度 $T = 310 \\,\\mathrm{K}$，\n- 电荷数 $z = 2$，\n- 电场分数 $\\delta = 0.7$，\n- 细胞外镁离子浓度 $[Mg^{2+}] = 1.0 \\,\\mathrm{mM}$，\n- 零电压解离常数 $K_{d}^{0} = 3.0 \\,\\mathrm{mM}$，\n- NMDA电导 $g_{\\mathrm{NMDA}} = 2.0 \\,\\mathrm{nS}$，\n- NMDA反转电位 $E_{\\mathrm{NMDA}} = 0.0 \\,\\mathrm{mV}$，\n- 膜电压 $V = -10.0 \\,\\mathrm{mV}$，\n- 法拉第常数 $F = 9.6485 \\times 10^{4} \\,\\mathrm{C\\,mol^{-1}}$，\n- 普适气体常数 $R = 8.314 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n将你计算出的电流最终数值答案四舍五入至四位有效数字，并以皮安（picoamperes）为单位表示。",
            "solution": "在尝试解答之前，首先将根据指定标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 镁离子$Mg^{2+}$阻断的微观反应：$Mg^{2+} + R \\rightleftharpoons MgR$，其中$R$是未阻断的受体，$MgR$是已阻断的状态。\n- 结合速率$k_{\\mathrm{on}}$与膜电压$V$无关，且与细胞外镁离子浓度$[Mg^{2+}]$成正比。\n- 解离速率$k_{\\mathrm{off}}(V)$依赖于$V$。\n- 电压依赖性解离常数：$K_{d}(V) = \\frac{k_{\\mathrm{off}}(V)}{k_{\\mathrm{on}}}$。\n- 解离常数的函数形式：$K_{d}(V) = K_{d}^{0} \\exp\\!\\left(\\frac{z \\delta F V}{R T}\\right)$。\n- $K_{d}^{0}$：零电压解离常数。\n- $F$：法拉第常数。\n- $R$：普适气体常数。\n- $T$：绝对温度。\n- $z$：阻断离子的有效电荷。\n- $\\delta$：离子穿过的跨膜电位降的分数。\n- 未阻断受体的比例$B(V)$是平衡状态下阻断位点未被占据的概率。\n- 稳态NMDA受体电流遵循基于电导的描述：$I_{\\mathrm{NMDA}}(V) = g_{\\mathrm{NMDA}} B(V) (V - E_{\\mathrm{NMDA}})$，其中$g_{\\mathrm{NMDA}}$是有效电导，$E_{\\mathrm{NMDA}}$是反转电位。\n- 用于评估的参数：\n  - $T = 310 \\,\\mathrm{K}$\n  - $z = 2$\n  - $\\delta = 0.7$\n  - $[Mg^{2+}] = 1.0 \\,\\mathrm{mM}$\n  - $K_{d}^{0} = 3.0 \\,\\mathrm{mM}$\n  - $g_{\\mathrm{NMDA}} = 2.0 \\,\\mathrm{nS}$\n  - $E_{\\mathrm{NMDA}} = 0.0 \\,\\mathrm{mV}$\n  - $V = -10.0 \\,\\mathrm{mV}$\n  - $F = 9.6485 \\times 10^{4} \\,\\mathrm{C\\,mol^{-1}}$\n  - $R = 8.314 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题描述了NMDA受体的电压依赖性镁离子阻断，这是神经科学中一个基本且已被充分证实的作用机制。所提出的模型基于单一位点结合和电压依赖的玻尔兹曼因子（通常称为Woodhull模型），是一种标准的生物物理描述。所提供的参数对于哺乳动物中枢神经系统神经元是生理上真实的。该问题牢固地植根于已确立的生物物理学原理。\n- **适定性**：该问题结构清晰，要求推导两个解析表达式以及随后的数值计算。所有必要的参数和常数都已提供。这些任务导向一个唯一且有意义的解。\n- **客观性**：该问题以精确、定量且无偏见的科学语言陈述。没有主观因素。\n- **其他标准**：该问题是自洽的，其设定完整且一致，条件在物理上是合理的，并且与计算神经科学中的突触可塑性主题直接相关。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供完整的解答。\n\n### 未阻断比例 $B(V)$ 的推导\n镁与NMDA受体结合的反应式为$Mg^{2+} + R \\rightleftharpoons MgR$。在平衡状态下，根据质量作用定律，解离常数$K_d(V)$为：\n$$K_d(V) = \\frac{[Mg^{2+}] [R]}{[MgR]}$$\n其中$[R]$是未阻断受体的浓度，$[MgR]$是已阻断受体的浓度。\n\n未阻断受体的比例$B(V)$是未阻断受体浓度与总受体浓度$[R]_{\\mathrm{total}} = [R] + [MgR]$的比值。\n$$B(V) = \\frac{[R]}{[R]_{\\mathrm{total}}} = \\frac{[R]}{[R] + [MgR]}$$\n为了用已知量表示$B(V)$，我们首先重排解离常数方程，用$[R]$表示$[MgR]$：\n$$[MgR] = \\frac{[Mg^{2+}] [R]}{K_d(V)}$$\n将此代入$B(V)$的表达式中：\n$$B(V) = \\frac{[R]}{[R] + \\frac{[Mg^{2+}] [R]}{K_d(V)}} = \\frac{[R]}{[R] \\left(1 + \\frac{[Mg^{2+}]}{K_d(V)}\\right)}$$\n$$B(V) = \\frac{1}{1 + \\frac{[Mg^{2+}]}{K_d(V)}}$$\n题目给出了电压依赖形式的解离常数：\n$$K_d(V) = K_d^0 \\exp\\left(\\frac{z \\delta F V}{RT}\\right)$$\n将此代入$B(V)$的表达式中，得到电压依赖的未阻断比例的闭式表达式：\n$$B(V) = \\frac{1}{1 + \\frac{[Mg^{2+}]}{K_d^0 \\exp\\left(\\frac{z \\delta F V}{RT}\\right)}} = \\frac{1}{1 + \\frac{[Mg^{2+}]}{K_d^0} \\exp\\left(-\\frac{z \\delta F V}{RT}\\right)}$$\n\n### NMDA电流 $I_{\\mathrm{NMDA}}(V)$ 的表达式\n该问题指定了NMDA受体电流的电导模型描述，该模型遵循欧姆定律。电流$I_{\\mathrm{NMDA}}(V)$是有效离子电导与驱动力的乘积。最大电导为$g_{\\mathrm{NMDA}}$，但有效电导受到未被镁离子阻断的通道比例$B(V)$的调制。\n因此，有效电导为$g_{\\mathrm{NMDA}} B(V)$。驱动力是膜电位$V$与通道反转电位$E_{\\mathrm{NMDA}}$之间的差值。\n结合这些元素，得到稳态电流的表达式：\n$$I_{\\mathrm{NMDA}}(V) = g_{\\mathrm{NMDA}} B(V) (V - E_{\\mathrm{NMDA}})$$\n代入推导出的$B(V)$表达式：\n$$I_{\\mathrm{NMDA}}(V) = g_{\\mathrm{NMDA}} \\left( \\frac{1}{1 + \\frac{[Mg^{2+}]}{K_d^0} \\exp\\left(-\\frac{z \\delta F V}{RT}\\right)} \\right) (V - E_{\\mathrm{NMDA}})$$\n\n### 电流的数值计算\n题目要求我们用给定的生理参数计算$I_{\\mathrm{NMDA}}(V)$。首先，所有参数必须使用一致的国际单位制（SI）单位。\n- $V = -10.0 \\,\\mathrm{mV} = -0.010 \\,\\mathrm{V}$\n- $[Mg^{2+}] = 1.0 \\,\\mathrm{mM} = 1.0 \\times 10^{-3} \\,\\mathrm{M}$\n- $K_d^0 = 3.0 \\,\\mathrm{mM} = 3.0 \\times 10^{-3} \\,\\mathrm{M}$\n- $g_{\\mathrm{NMDA}} = 2.0 \\,\\mathrm{nS} = 2.0 \\times 10^{-9} \\,\\mathrm{S}$\n- $E_{\\mathrm{NMDA}} = 0.0 \\,\\mathrm{mV} = 0.0 \\,\\mathrm{V}$\n- $T = 310 \\,\\mathrm{K}$\n- $z = 2$\n- $\\delta = 0.7$\n- $F = 9.6485 \\times 10^{4} \\,\\mathrm{C\\,mol^{-1}}$\n- $R = 8.314 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n首先，我们计算玻尔兹曼因子中的无量纲指数$-\\frac{z \\delta F V}{RT}$。\n$$ \\text{指数} = -\\frac{(2)(0.7)(9.6485 \\times 10^{4} \\,\\mathrm{C\\,mol^{-1}})(-0.010 \\,\\mathrm{V})}{(8.314 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(310 \\,\\mathrm{K})} $$\n由于$1 \\,\\mathrm{J} = 1 \\,\\mathrm{C \\cdot V}$，单位相互抵消。\n$$ \\text{指数} = \\frac{1.4 \\times 9.6485 \\times 10^{4} \\times 0.010}{8.314 \\times 310} = \\frac{1350.79}{2577.34} \\approx 0.524090 $$\n接下来，我们计算阻断项，它包含这个值的指数函数。\n$$ \\exp\\left(-\\frac{z \\delta F V}{RT}\\right) \\approx \\exp(0.524090) \\approx 1.68886 $$\n镁离子浓度与零电压解离常数的比值为：\n$$ \\frac{[Mg^{2+}]}{K_d^0} = \\frac{1.0 \\,\\mathrm{mM}}{3.0 \\,\\mathrm{mM}} = \\frac{1}{3} $$\n现在，我们可以计算未阻断比例$B(V)$：\n$$ B(V) = \\frac{1}{1 + \\frac{[Mg^{2+}]}{K_d^0} \\exp\\left(-\\frac{z \\delta F V}{RT}\\right)} \\approx \\frac{1}{1 + \\frac{1}{3} \\times 1.68886} = \\frac{1}{1 + 0.562953} = \\frac{1}{1.562953} \\approx 0.639815 $$\n最后，我们计算电流$I_{\\mathrm{NMDA}}$：\n$$ I_{\\mathrm{NMDA}} = g_{\\mathrm{NMDA}} B(V) (V - E_{\\mathrm{NMDA}}) $$\n$$ I_{\\mathrm{NMDA}} \\approx (2.0 \\times 10^{-9} \\,\\mathrm{S}) \\times (0.639815) \\times (-0.010 \\,\\mathrm{V} - 0.0 \\,\\mathrm{V}) $$\n$$ I_{\\mathrm{NMDA}} \\approx (2.0 \\times 10^{-9}) \\times (0.639815) \\times (-0.010) \\,\\mathrm{A} $$\n$$ I_{\\mathrm{NMDA}} \\approx -1.27963 \\times 10^{-11} \\,\\mathrm{A} $$\n问题要求以皮安（picoamperes, $1 \\,\\mathrm{pA} = 10^{-12} \\,\\mathrm{A}$）为单位给出答案。\n$$ I_{\\mathrm{NMDA}} \\approx -12.7963 \\times 10^{-12} \\,\\mathrm{A} = -12.7963 \\,\\mathrm{pA} $$\n四舍五入到四位有效数字，电流的最终数值答案是$-12.80 \\,\\mathrm{pA}$。",
            "answer": "$$\\boxed{-12.80}$$"
        },
        {
            "introduction": "在理解了NMDA受体电压依赖性的“开关”特性之后，下一步是探究其电流的时间动态过程，这对钙离子信号的持续时间至关重要。这个实践练习要求你通过编程来模拟由不同亚基（如NR2A与NR2B）组成的NMDA受体所产生的不同动力学特征的电流。通过计算并比较不同条件下有效钙离子内流的时间窗口（$t_{90}$），你将具体地体会到受体组成如何精细调控诱导LTP或LTD所需的时间整合窗口，这是计算神经科学中一个典型的数值模拟问题。",
            "id": "3995276",
            "problem": "考虑由N-甲基-D-天冬氨酸（NMDA）受体介导的突触电流，其具有亚基依赖的衰减动力学，并可由双指数电导近似。长时程增强（LTP）和长时程抑制（LTD）的诱导，在很大程度上受到突触激活和突触后去极化后细胞内钙离子内流持续时间窗口的影响。假设以下模型基础：\n\n1. 在时间 $t_0$ 激活后，NMDA电导由一个具有共用上升时间常数的非负双指数函数表示。对于 $t \\ge t_0$，定义\n$$\ng(t) = g_0 \\left[ w_f \\left( e^{-\\frac{t - t_0}{\\tau_f}} - e^{-\\frac{t - t_0}{\\tau_r}} \\right) + w_s \\left( e^{-\\frac{t - t_0}{\\tau_s}} - e^{-\\frac{t - t_0}{\\tau_r}} \\right) \\right],\n$$\n对于 $t  t_0$，则 $g(t) = 0$。其中，$g_0$ 是以 $\\mathrm{S}$（西门子）为单位的峰值缩放因子，$(w_f, w_s)$ 是满足 $w_f + w_s = 1$ 的非负权重，而 $\\tau_r, \\tau_f, \\tau_s$ 是以 $\\mathrm{s}$（秒）为单位的时间常数，且满足 $\\tau_r  \\tau_f$ 和 $\\tau_r  \\tau_s$。\n\n2. 由钙离子承载的NMDA电流的比例是一个常数 $p_{Ca}$，满足 $0  p_{Ca}  1$；钙离子驱动力近似为一个常数 $D$，单位为 $\\mathrm{V}$（伏特）。瞬时钙离子电流建模为\n$$\nI_{Ca}(t) = p_{Ca} \\, D \\, g(t) \\, B(V(t)),\n$$\n其中 $B(V)$ 表示电压依赖的镁离子阻断。\n\n3. 电压依赖的镁离子阻断 $B(V)$ 遵循一个与典型NMDA受体行为一致、且经过充分检验的经验公式：\n$$\nB(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57}\\right) e^{-0.062\\, V}},\n$$\n其中 $[\\mathrm{Mg}^{2+}]$ 的单位是 $\\mathrm{mM}$，膜电位 $V$ 的单位是 $\\mathrm{mV}$。\n\n4. 在从 $t_0$ 开始、持续时间为 $T_{dep}$ 的去极化时期内，突触后膜电位呈现一个阶跃至平台的曲线。对于 $t \\in [t_0, t_0 + T_{dep}]$，\n$$\nV(t) = V_{plateau} + \\left( V_{peak} - V_{plateau} \\right) e^{-\\frac{t - t_0}{\\tau_V}},\n$$\n在此区间之外 $V(t) = V_{rest}$，其中 $V_{rest}$ 的值足够负，以至于 $B(V_{rest})$ 能有效地将钙离子内流门控至可忽略不计的水平。所有电压单位均为 $\\mathrm{mV}$，$\\tau_V$ 的单位为 $\\mathrm{s}$。\n\n定义用于可塑性诱导的有效钙离子时间窗口 $t_{90}$ 为：从 $t_0$ 开始测量，累积钙离子内流达到去极化时期内总钙离子内流的 $0.9$ 时的最早时间：\n$$\n\\int_{t_0}^{t_0 + t_{90}} I_{Ca}(t) \\, dt \\;=\\; 0.9 \\int_{t_0}^{t_0 + T_{dep}} I_{Ca}(t) \\, dt.\n$$\n以 $\\mathrm{s}$ 为单位表示 $t_{90}$。\n\n您的任务是编写一个完整的程序，对以下测试套件中的每一组参数进行数值计算，求出 $t_{90}$。计算时应使用足够精细的时间离散化来解析最快的时间常数，并采用一种科学上合理且稳定的数值积分方案。程序必须生成单行输出，其中包含一个方括号括起来的逗号分隔列表。列表中的每个条目都应是一个浮点数，代表以 $\\mathrm{s}$ 为单位的 $t_{90}$，并四舍五入到 $6$ 位小数。\n\n除非另有说明，所有测试用例均使用以下常数：$p_{Ca} = 0.12$, $D = 0.050$。\n\n测试套件（所有时间单位为 $\\mathrm{s}$，电压单位为 $\\mathrm{mV}$，电导单位为 $\\mathrm{S}$，浓度单位为 $\\mathrm{mM}$）：\n\n- 案例1（NR2A主导，“理想路径”）：\n  - $t_0 = 0.0$, $\\tau_r = 0.005$, $\\tau_f = 0.050$, $\\tau_s = 0.150$, $w_f = 0.8$, $w_s = 0.2$, $g_0 = 1 \\times 10^{-9}$, $[\\mathrm{Mg}^{2+}] = 1.0$, $T_{dep} = 0.100$, $V_{peak} = -20.0$, $V_{plateau} = -35.0$, $\\tau_V = 0.020$。\n\n- 案例2（NR2B主导）：\n  - $t_0 = 0.0$, $\\tau_r = 0.005$, $\\tau_f = 0.050$, $\\tau_s = 0.150$, $w_f = 0.2$, $w_s = 0.8$, $g_0 = 1 \\times 10^{-9}$, $[\\mathrm{Mg}^{2+}] = 1.0$, $T_{dep} = 0.100$, $V_{peak} = -20.0$, $V_{plateau} = -35.0$, $\\tau_V = 0.020$。\n\n- 案例3（NR2A/NR2B混合权重）：\n  - $t_0 = 0.0$, $\\tau_r = 0.005$, $\\tau_f = 0.050$, $\\tau_s = 0.150$, $w_f = 0.5$, $w_s = 0.5$, $g_0 = 1 \\times 10^{-9}$, $[\\mathrm{Mg}^{2+}] = 1.0$, $T_{dep} = 0.100$, $V_{peak} = -20.0$, $V_{plateau} = -35.0$, $\\tau_V = 0.020$。\n\n- 案例4（边界条件：短时去极化截断尾部电流）：\n  - $t_0 = 0.0$, $\\tau_r = 0.005$, $\\tau_f = 0.050$, $\\tau_s = 0.150$, $w_f = 0.2$, $w_s = 0.8$, $g_0 = 1 \\times 10^{-9}$, $[\\mathrm{Mg}^{2+}] = 1.0$, $T_{dep} = 0.030$, $V_{peak} = -20.0$, $V_{plateau} = -35.0$, $\\tau_V = 0.020$。\n\n- 案例5（边缘情况：镁离子浓度增加）：\n  - $t_0 = 0.0$, $\\tau_r = 0.005$, $\\tau_f = 0.050$, $\\tau_s = 0.150$, $w_f = 0.2$, $w_s = 0.8$, $g_0 = 1 \\times 10^{-9}$, $[\\mathrm{Mg}^{2+}] = 2.0$, $T_{dep} = 0.100$, $V_{peak} = -20.0$, $V_{plateau} = -35.0$, $\\tau_V = 0.020$。\n\n最终输出格式规范：您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$），其中每个 $\\text{result}_k$ 是以 $\\mathrm{s}$ 为单位的 $t_{90}$，并四舍五入到 $6$ 位小数。",
            "solution": "所述问题在科学上是合理的、适定的且内部一致的。它描述了一个基于已确立的生物物理学原理的、典型的N-甲基-D-天冬氨酸（NMDA）受体介导的钙离子内流模型。所有参数、常数和函数形式在计算神经科学领域都是标准的，并且其规定具有足够的精度，可以得到唯一且有意义的解。因此，我们可以进行数值求解。\n\n核心任务是确定有效钙离子时间窗口 $t_{90}$，其定义为从初始激活时刻 $t_0$ 开始，累积钙离子内流达到去极化时期（持续时间为 $T_{dep}$）内总量的 $90\\%$ 所需的时间。在数学上，这由以下积分方程表示：\n$$\n\\int_{t_0}^{t_0 + t_{90}} I_{Ca}(t) \\, dt = 0.9 \\int_{t_0}^{t_0 + T_{dep}} I_{Ca}(t) \\, dt\n$$\n被积函数 $I_{Ca}(t)$ 代表瞬时钙离子电流，是几个时间依赖函数的乘积：\n$$\nI_{Ca}(t) = p_{Ca} \\, D \\, g(t) \\, B(V(t))\n$$\n此处，$p_{Ca}$ 和 $D$ 分别是钙离子电流的恒定比例和驱动力。函数 $g(t)$ 是双指数NMDA电导，$V(t)$ 是去极化期间随时间变化的突触后膜电位，$B(V)$ 是电压依赖的镁离子阻断。表达式如下：\n1.  对于 $t \\ge t_0$ 的NMDA电导：\n    $$\n    g(t) = g_0 \\left[ w_f \\left( e^{-\\frac{t - t_0}{\\tau_f}} - e^{-\\frac{t - t_0}{\\tau_r}} \\right) + w_s \\left( e^{-\\frac{t - t_0}{\\tau_s}} - e^{-\\frac{t - t_0}{\\tau_r}} \\right) \\right]\n    $$\n2.  对于 $t \\in [t_0, t_0 + T_{dep}]$ 的膜电位：\n    $$\n    V(t) = V_{plateau} + \\left( V_{peak} - V_{plateau} \\right) e^{-\\frac{t - t_0}{\\tau_V}}\n    $$\n3.  镁离子阻断：\n    $$\n    B(V) = \\frac{1}{1 + \\left(\\frac{[\\mathrm{Mg}^{2+}]}{3.57 \\, \\mathrm{mM}}\\right) e^{-0.062 \\, \\mathrm{mV}^{-1} \\cdot V}}\n    $$\n\n由于被积函数 $I_{Ca}(t)$ 具有复杂的非线性乘积形式，定义 $t_{90}$ 的积分方程的解析解（闭式解）是难以求得的。因此，必须采用数值方法。该策略包括三个主要步骤：离散化、数值积分和插值。\n\n首先，我们将感兴趣的时间域 $[t_0, t_0 + T_{dep}]$ 离散化为一个精细的网格。时间步长 $\\Delta t$ 的选择对精度至关重要，必须足够小以解析系统中最快的动力学过程。所提供的最快时间常数是电导的上升时间 $\\tau_r = 0.005 \\, \\mathrm{s}$。取时间步长 $\\Delta t = 0.0001 \\, \\mathrm{s}$，可以在一个 $\\tau_r$ 间隔内提供 $50$ 个采样点，这足以确保数值的稳定性和准确性。\n\n其次，我们采用数值积分来近似计算积分。我们定义累积钙电荷函数 $Q(t')$ 为：\n$$\nQ(t') = \\int_{t_0}^{t'} I_{Ca}(\\tau) \\, d\\tau\n$$\n我们可以使用梯形法则在我们的离散时间网格的每个点上计算该函数的值，对于此类问题，这是一种稳健且合适的方法。总电荷内流为 $Q_{total} = Q(t_0 + T_{dep})$。目标电荷则为 $Q_{target} = 0.9 \\cdot Q_{total}$。\n\n第三，我们必须找到时间 $t_{abs} = t_0 + t_{90}$，使得 $Q(t_{abs}) = Q_{target}$。由于在给定的参数范围内被积函数 $I_{Ca}(t)$ 是非负的，所以累积电荷函数 $Q(t')$ 是单调不减的。此性质保证了 $t_{abs}$ 存在唯一解。我们可以通过对离散数据对 $(Q(t_i), t_i)$ 进行线性插值来高精度地找到这个值。给定目标电荷 $Q_{target}$，我们找到对应的时间。最终结果是持续时间 $t_{90} = t_{abs} - t_0$。\n\n具体实现将首先为 $g(t)$、$V(t)$ 和 $B(V)$ 定义Python函数。对于每个测试用例，我们将生成一个从 $t_0$ 到 $t_0 + T_{dep}$ 的时间向量，在每个时间点上计算被积函数 $I_{Ca}(t)$ 的值，使用 `scipy.integrate.cumulative_trapezoid` 计算 $I_{Ca}(t)$ 的累积积分，最后使用 `numpy.interp` 找到对应于总累积电荷 $90\\%$ 的时间。此过程将应用于所有五个指定的参数集。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Computes the effective calcium time window for plasticity induction (t90)\n    for a set of biophysical parameters modeling an NMDA receptor.\n    \"\"\"\n\n    # Define the constant parameters for all test cases\n    p_ca = 0.12  # unitless fraction\n    D_ca = 0.050 # Volts\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1 (NR2A-dominant, \"happy path\")\n        {\n            \"t0\": 0.0, \"tau_r\": 0.005, \"tau_f\": 0.050, \"tau_s\": 0.150, \"w_f\": 0.8, \"w_s\": 0.2,\n            \"g0\": 1e-9, \"mg_conc\": 1.0, \"T_dep\": 0.100, \"V_peak\": -20.0, \"V_plateau\": -35.0, \"tau_V\": 0.020\n        },\n        # Case 2 (NR2B-dominant)\n        {\n            \"t0\": 0.0, \"tau_r\": 0.005, \"tau_f\": 0.050, \"tau_s\": 0.150, \"w_f\": 0.2, \"w_s\": 0.8,\n            \"g0\": 1e-9, \"mg_conc\": 1.0, \"T_dep\": 0.100, \"V_peak\": -20.0, \"V_plateau\": -35.0, \"tau_V\": 0.020\n        },\n        # Case 3 (mixed NR2A/NR2B weights)\n        {\n            \"t0\": 0.0, \"tau_r\": 0.005, \"tau_f\": 0.050, \"tau_s\": 0.150, \"w_f\": 0.5, \"w_s\": 0.5,\n            \"g0\": 1e-9, \"mg_conc\": 1.0, \"T_dep\": 0.100, \"V_peak\": -20.0, \"V_plateau\": -35.0, \"tau_V\": 0.020\n        },\n        # Case 4 (boundary condition: short depolarization truncating the tail)\n        {\n            \"t0\": 0.0, \"tau_r\": 0.005, \"tau_f\": 0.050, \"tau_s\": 0.150, \"w_f\": 0.2, \"w_s\": 0.8,\n            \"g0\": 1e-9, \"mg_conc\": 1.0, \"T_dep\": 0.030, \"V_peak\": -20.0, \"V_plateau\": -35.0, \"tau_V\": 0.020\n        },\n        # Case 5 (edge case: increased magnesium concentration)\n        {\n            \"t0\": 0.0, \"tau_r\": 0.005, \"tau_f\": 0.050, \"tau_s\": 0.150, \"w_f\": 0.2, \"w_s\": 0.8,\n            \"g0\": 1e-9, \"mg_conc\": 2.0, \"T_dep\": 0.100, \"V_peak\": -20.0, \"V_plateau\": -35.0, \"tau_V\": 0.020\n        }\n    ]\n\n    results = []\n    \n    # Define model component functions\n    def g_nmda(t, t0, g0, wf, ws, tau_r, tau_f, tau_s):\n        t_rel = t - t0\n        # Ensure g(t) = 0 for t  t0\n        g = np.zeros_like(t_rel)\n        mask = t_rel = 0\n        \n        term1 = wf * (np.exp(-t_rel[mask] / tau_f) - np.exp(-t_rel[mask] / tau_r))\n        term2 = ws * (np.exp(-t_rel[mask] / tau_s) - np.exp(-t_rel[mask] / tau_r))\n        g[mask] = g0 * (term1 + term2)\n        return g\n\n    def V_mem(t, t0, V_peak, V_plateau, tau_V):\n        t_rel = t - t0\n        return V_plateau + (V_peak - V_plateau) * np.exp(-t_rel / tau_V)\n\n    def B_mg(V, mg_conc):\n        return 1.0 / (1.0 + (mg_conc / 3.57) * np.exp(-0.062 * V))\n\n    for params in test_cases:\n        # Set up time grid for numerical integration\n        # Time step must be small enough to resolve the fastest time constant (tau_r = 0.005 s)\n        dt = 0.0001\n        t_eval = np.arange(params[\"t0\"], params[\"t0\"] + params[\"T_dep\"] + dt, dt)\n\n        # Calculate time series for each component of the calcium current\n        g_vals = g_nmda(t_eval, params[\"t0\"], params[\"g0\"], params[\"w_f\"], params[\"w_s\"], params[\"tau_r\"], params[\"tau_f\"], params[\"tau_s\"])\n        V_vals = V_mem(t_eval, params[\"t0\"], params[\"V_peak\"], params[\"V_plateau\"], params[\"tau_V\"])\n        B_vals = B_mg(V_vals, params[\"mg_conc\"])\n\n        # Calculate the integrand (calcium current) over time\n        I_ca_vals = p_ca * D_ca * g_vals * B_vals\n        \n        # Compute the cumulative integral of the calcium current using the trapezoidal rule\n        # cumulative_trapezoid returns an array of size N-1 for input of size N.\n        # Using initial=0 makes it return an array of size N, which aligns with t_eval.\n        Q_cum = cumulative_trapezoid(I_ca_vals, t_eval, initial=0)\n\n        # Get total charge influx\n        Q_total = Q_cum[-1]\n\n        # Handle the case of zero total influx to avoid division by zero or empty intervals\n        if Q_total == 0:\n            results.append(0.0)\n            continue\n\n        # Determine the target charge (90% of total)\n        Q_target = 0.9 * Q_total\n        \n        # Interpolate to find the time at which the cumulative charge reaches the target value.\n        # np.interp finds the 'y' value for a given 'x' from points (xp, fp).\n        # Here, we want to find the time (fp=t_eval) for a given charge (xp=Q_cum).\n        t_abs_90 = np.interp(Q_target, Q_cum, t_eval)\n        \n        # t90 is defined as time measured from t0\n        t_90 = t_abs_90 - params[\"t0\"]\n        \n        results.append(round(t_90, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, ['{:.6f}'.format(r) for r in results]))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从单个分子的生物物理学层面上升，我们可以用更抽象的计算模型来描述突触可塑性的“规则”。Bienenstock–Cooper–Munro（BCM）模型就是一个经典的例子，它解释了突触如何根据其近期的活动历史来调节自身的可塑性，这一过程被称为“元可塑性”（metaplasticity）。在这个练习中，你将通过求解BCM模型中的滑动阈值动力学方程，来预测一段高频活动如何改变LTP和LTD之间的界限，从而影响后续的学习效果。这个练习揭示了突触稳态和学习规则动态调整的核心计算原理。",
            "id": "3995332",
            "problem": "使用 Bienenstock–Cooper–Munro (BCM) 框架对单个突触进行建模。设突触前活动为 $x(t)$，突触后放电率为 $y(t)$ (单位为 Hz)。假设在持续时间为 $\\Delta t$ 的短暂诱导过程中，突触权重变化遵循 BCM 形式\n$$\\Delta w \\propto x\\,y\\,(y - \\theta_{S})\\,\\Delta t,$$\n其中 $\\theta_{S}$ 是区分长时程增强 (LTP) 和长时程抑制 (LTD) 的活动依赖性修饰边界。该边界由一个缓慢适应的可塑性阈值 $\\theta_{M}(t)$ 通过 $\\theta_{S}(t) = \\sqrt{\\theta_{M}(t)}$ 决定。该可塑性阈值根据标准的滑动阈值动力学演化\n$$\\frac{d\\theta_{M}}{dt} = \\frac{y^{2} - \\theta_{M}}{\\tau_{M}},$$\n其中 $\\tau_{M}$ 是元可塑性时间常数。\n\n假设实验方案和参数如下：\n- 在基线状态下，突触处于稳态，$\\theta_{M}(0) = \\theta_{S}(0)^{2}$ 且 $\\theta_{S}(0) = 15$ Hz。\n- 接着，出现一个持续时间为 $T = 600$ s 的高活动期，期间突触后放电被钳制在 $y(t) = y_{H} = 40$ Hz。在此期间，突触权重的更新被药物阻断，因此只有 $\\theta_{M}(t)$ 发生变化；$x(t)$ 和 $w$ 在此阶段无关紧要。\n- 在高活动期之后，分别在期前和期后应用相同的诱导方案，每次都包含固定的突触前频率 $x_{\\mathrm{ind}} = 10$ Hz 和钳制的突触后频率 $y_{\\mathrm{ind}} = 30$ Hz，持续时间为 $\\Delta t = 1$ s。两次诱导的学习率因子相同，可视为一个公共的乘法常数。元可塑性时间常数为 $\\tau_{M} = 300$ s。\n\n仅使用上述模型定义，首先更新高活动期内的 $\\theta_{M}$，并推断出该期结束后立即产生的新边界 $\\theta_{S}$。然后，通过计算比率来预测元可塑性对后续诱导的定量影响\n$$R = \\frac{\\Delta w_{\\text{post}}}{\\Delta w_{\\text{pre}}},$$\n其中 $\\Delta w_{\\text{pre}}$ 是在基线状态下应用诱导方案产生的权重变化，而 $\\Delta w_{\\text{post}}$ 是在高活动期结束后立即应用相同诱导方案产生的权重变化。将 $R$ 的最终数值答案四舍五入至四位有效数字。最终答案以纯数字形式表示（无单位）。",
            "solution": "问题要求计算比率 $R = \\frac{\\Delta w_{\\text{post}}}{\\Delta w_{\\text{pre}}}$，该比率量化了高活动期对 Bienenstock–Cooper–Munro (BCM) 模型所描述的突触可塑性的影响。\n\n突触权重变化 $\\Delta w$ 由 BCM 法则给出：\n$$ \\Delta w \\propto x\\,y\\,(y - \\theta_{S})\\,\\Delta t $$\n设比例常数为 $k$。那么，诱导方案引起的权重变化为 $\\Delta w = k \\cdot x_{\\mathrm{ind}} \\cdot y_{\\mathrm{ind}} \\cdot (y_{\\mathrm{ind}} - \\theta_{S}) \\cdot \\Delta t$。\n\n高活动期前后的诱导方案完全相同，参数为 $x_{\\mathrm{ind}} = 10 \\text{ Hz}$，$y_{\\mathrm{ind}} = 30 \\text{ Hz}$，持续时间为 $\\Delta t = 1 \\text{ s}$。唯一的区别是修饰阈值 $\\theta_S$ 的值。\n\n在高活动期之前（基线状态下），权重变化 $\\Delta w_{\\text{pre}}$ 由初始阈值 $\\theta_{S, \\text{pre}} = \\theta_S(0)$ 决定。\n$$ \\Delta w_{\\text{pre}} = k \\cdot x_{\\mathrm{ind}} \\cdot y_{\\mathrm{ind}} \\cdot (y_{\\mathrm{ind}} - \\theta_{S, \\text{pre}}) \\cdot \\Delta t $$\n\n在高活动期之后，权重变化 $\\Delta w_{\\text{post}}$ 由新阈值 $\\theta_{S, \\text{post}}$ 决定，该值是高活动期结束时（即时间 $t=T$）的 $\\theta_S(t)$ 值。\n$$ \\Delta w_{\\text{post}} = k \\cdot x_{\\mathrm{ind}} \\cdot y_{\\mathrm{ind}} \\cdot (y_{\\mathrm{ind}} - \\theta_{S, \\text{post}}) \\cdot \\Delta t $$\n\n因此，比率 $R$ 为：\n$$ R = \\frac{\\Delta w_{\\text{post}}}{\\Delta w_{\\text{pre}}} = \\frac{k \\cdot x_{\\mathrm{ind}} \\cdot y_{\\mathrm{ind}} \\cdot (y_{\\mathrm{ind}} - \\theta_{S, \\text{post}}) \\cdot \\Delta t}{k \\cdot x_{\\mathrm{ind}} \\cdot y_{\\mathrm{ind}} \\cdot (y_{\\mathrm{ind}} - \\theta_{S, \\text{pre}}) \\cdot \\Delta t} = \\frac{y_{\\mathrm{ind}} - \\theta_{S, \\text{post}}}{y_{\\mathrm{ind}} - \\theta_{S, \\text{pre}}} $$\n\n根据问题描述，基线修饰边界为 $\\theta_{S, \\text{pre}} = \\theta_S(0) = 15 \\text{ Hz}$。诱导放电率为 $y_{\\mathrm{ind}} = 30 \\text{ Hz}$。$R$ 的表达式变为：\n$$ R = \\frac{30 - \\theta_{S, \\text{post}}}{30 - 15} = \\frac{30 - \\theta_{S, \\text{post}}}{15} $$\n\n为了求得 $\\theta_{S, \\text{post}}$，我们必须首先确定在高活动期内元可塑性阈值 $\\theta_M(t)$ 的演化。$\\theta_M(t)$ 的动力学由以下微分方程控制：\n$$ \\frac{d\\theta_M}{dt} = \\frac{y(t)^2 - \\theta_M}{\\tau_M} $$\n在持续时间为 $T = 600 \\text{ s}$ 的高活动期内，突触后放电率被钳制在 $y(t) = y_H = 40 \\text{ Hz}$。元可塑性时间常数为 $\\tau_M = 300 \\text{ s}$。方程变为：\n$$ \\frac{d\\theta_M}{dt} = \\frac{y_H^2 - \\theta_M}{\\tau_M} = \\frac{40^2 - \\theta_M}{300} = \\frac{1600 - \\theta_M}{300} $$\n初始条件是 $\\theta_M(0)$。在基线状态下，$\\theta_S(0) = 15 \\text{ Hz}$，且 $\\theta_M(0) = \\theta_S(0)^2 = 15^2 = 225$。因此，我们求解以下初值问题：\n$$ \\frac{d\\theta_M}{dt} + \\frac{1}{300}\\theta_M = \\frac{1600}{300}, \\quad \\theta_M(0) = 225 $$\n这是一个标准的一阶线性常微分方程。其通解形式为 $\\theta_M(t) = \\theta_{M, \\text{ss}} + (\\theta_M(0) - \\theta_{M, \\text{ss}})\\exp(-t/\\tau_M)$，其中 $\\theta_{M, \\text{ss}}$ 是稳态值。这里，稳态值为 $y_H^2 = 1600$。\n所以，解为：\n$$ \\theta_M(t) = 1600 + (225 - 1600)\\exp\\left(-\\frac{t}{300}\\right) = 1600 - 1375\\exp\\left(-\\frac{t}{300}\\right) $$\n我们需要找到高活动期结束时，即 $t = T = 600 \\text{ s}$ 时 $\\theta_M$ 的值。\n$$ \\theta_{M, \\text{post}} = \\theta_M(600) = 1600 - 1375\\exp\\left(-\\frac{600}{300}\\right) = 1600 - 1375\\exp(-2) $$\n现在我们可以使用关系式 $\\theta_S(t) = \\sqrt{\\theta_M(t)}$ 来求出高活动期后的修饰边界 $\\theta_{S, \\text{post}}$：\n$$ \\theta_{S, \\text{post}} = \\sqrt{\\theta_{M, \\text{post}}} = \\sqrt{1600 - 1375\\exp(-2)} $$\n将此代入 $R$ 的表达式中：\n$$ R = \\frac{30 - \\sqrt{1600 - 1375\\exp(-2)}}{15} $$\n现在我们计算数值。\n$$ \\exp(-2) \\approx 0.13533528 $$\n$$ \\theta_{S, \\text{post}} \\approx \\sqrt{1600 - 1375 \\times 0.13533528} = \\sqrt{1600 - 186.08599} = \\sqrt{1413.91401} \\approx 37.6020478 $$\n最后，我们计算 $R$：\n$$ R \\approx \\frac{30 - 37.6020478}{15} = \\frac{-7.6020478}{15} \\approx -0.50680319 $$\n四舍五入到四位有效数字，结果是 $-0.5068$。负号表示高活动期已经将给定诱导方案的可塑性结果从 LTP（因为 $y_{\\text{ind}}  \\theta_{S, \\text{pre}}$）转变为 LTD（因为 $y_{\\text{ind}}  \\theta_{S, \\text{post}}$）。",
            "answer": "$$\\boxed{-0.5068}$$"
        }
    ]
}