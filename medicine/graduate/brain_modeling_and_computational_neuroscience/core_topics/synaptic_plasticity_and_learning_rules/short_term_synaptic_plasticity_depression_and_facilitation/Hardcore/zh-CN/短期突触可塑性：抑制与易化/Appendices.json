{
    "hands_on_practices": [
        {
            "introduction": "配对脉冲比率（Paired-Pulse Ratio, PPR）是表征短期突触可塑性的一个基本实验测量指标。第一个练习将挑战你使用 Tsodyks-Markram 模型推导 PPR 的解析表达式。通过对两个连续脉冲的动态过程进行分析 ，你将为理解模型的易化和抑制参数如何直接塑造突触反应奠定坚实的基础。",
            "id": "4018478",
            "problem": "考虑一个由 Tsodyks–Markram 短期可塑性模型描述的突触，该模型同时捕捉了易化和抑制效应。令 $u(t)$ 表示突触效能的利用率（易化变量），$x(t)$ 表示可用突触资源的比例（抑制变量）。在突触前脉冲之间，这些变量根据以下常微分方程演化：\n$$\n\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}, \\qquad \\frac{d x}{d t} = \\frac{1 - x}{\\tau_{d}},\n$$\n其中 $\\tau_{f}  0$ 和 $\\tau_{d}  0$ 分别是易化和抑制的时间常数。在每个突触前脉冲时间 $t_{k}$，这些变量会发生跳跃更新：\n$$\nu(t_{k}^{+}) = u(t_{k}^{-}) + U \\bigl(1 - u(t_{k}^{-})\\bigr), \\qquad x(t_{k}^{+}) = x(t_{k}^{-}) \\bigl(1 - u(t_{k}^{+})\\bigr),\n$$\n其中 $U \\in (0,1)$ 是一个量化每个脉冲引起的利用率增量的参数，$t_{k}^{-}$ 和 $t_{k}^{+}$ 分别表示脉冲发生前和发生后瞬间的时刻。假设在 $t_1$ 时刻的第一个脉冲之前，突触已处于静息状态足够长的时间，因此 $u(t_{1}^{-}) = 0$ 且 $x(t_{1}^{-}) = 1$。\n\n设两个相同的突触前脉冲发生在时间 $t_{1}$ 和 $t_{2} = t_{1} + \\Delta$，其中 $\\Delta  0$ 是脉冲间间隔 (IPI)。第 $k$ 个脉冲诱发的突触后响应幅度与 $A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$ 成正比，其中 $A  0$ 是一个恒定的比例因子。将成对脉冲比率 (PPR) 定义为第二个诱发峰值幅度与第一个的比值。\n\n从给定的动力学和跳跃条件出发，推导成对脉冲比率关于 $\\Delta$、$U$、$\\tau_{f}$ 和 $\\tau_{d}$ 的闭式解析表达式。将最终结果表示为符号表达式；不要代入数值。如果引入了辅助量，请将其消去，以使最终表达式仅依赖于 $\\Delta$、$U$、$\\tau_{f}$ 和 $\\tau_{d}$。",
            "solution": "该问题要求为 Tsodyks–Markram 模型描述的突触推导成对脉冲比率 (PPR) 的闭式表达式。问题陈述具有科学依据，是良构的，并提供了所有必要信息。这是计算神经科学中的一个标准练习，因此是有效的。\n\n成对脉冲比率 (PPR) 定义为第二次突触后响应的幅度 $E_2$ 与第一次响应的幅度 $E_1$ 之比。\n$$\n\\text{PPR} = \\frac{E_2}{E_1}\n$$\n第 $k$ 个脉冲诱发的突触后响应幅度与 $A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$ 成正比。因此，我们可以将幅度写为 $E_k = c A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$，其中 $c$ 是某个比例常数。由于我们计算的是比率，这个常数将被消去。为简单起见，我们设 $c=1$，因此 $E_k = A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$。\n\n我们的推导分四步进行：\n1.  计算 $t_1$ 时刻第一个脉冲时突触的状态和响应幅度。\n2.  在脉冲间间隔 $\\Delta$ 期间，演化突触变量 $u(t)$ 和 $x(t)$。\n3.  计算 $t_2$ 时刻第二个脉冲时突触的状态和响应幅度。\n4.  计算幅度的比率。\n\n步骤 1：分析 $t_1$ 时刻的第一个脉冲。\n在第一个脉冲之前突触处于静息状态，因此初始条件为 $u(t_1^-) = 0$ 和 $x(t_1^-) = 1$。\n\n首先，我们使用跳跃条件找出脉冲后瞬间的易化变量 $u$ 的值，$u(t_1^+)$：\n$$\nu(t_1^+) = u(t_1^-) + U \\bigl(1 - u(t_1^-)\\bigr)\n$$\n代入 $u(t_1^-) = 0$：\n$$\nu(t_1^+) = 0 + U(1-0) = U\n$$\n第一次突触后响应的幅度 $E_1$ 为：\n$$\nE_1 = A u(t_1^+) x(t_1^-)\n$$\n代入 $u(t_1^+) = U$ 和 $x(t_1^-) = 1$：\n$$\nE_1 = A \\cdot U \\cdot 1 = AU\n$$\n接下来，我们使用其跳跃条件找出脉冲后瞬间的抑制变量 $x$ 的值，$x(t_1^+)$：\n$$\nx(t_1^+) = x(t_1^-) \\bigl(1 - u(t_1^+)\\bigr)\n$$\n代入 $x(t_1^-) = 1$ 和 $u(t_1^+) = U$：\n$$\nx(t_1^+) = 1 \\cdot (1 - U) = 1-U\n$$\n\n步骤 2：脉冲间间隔期间的演化。\n在 $t_1$ 时刻的第一个脉冲和 $t_2 = t_1 + \\Delta$ 时刻的第二个脉冲之间，变量根据给定的微分方程演化。我们需要找到 $u(t_2^-)$ 和 $x(t_2^-)$ 的值。\n\n$u(t)$ 的演化由以下方程决定：\n$$\n\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}\n$$\n这是一个一阶线性常微分方程。我们在区间 $[t_1, t_2]$ 上用初始条件 $u(t_1) = u(t_1^+) = U$ 求解它。解是指性衰减：\n$$\nu(t) = u(t_1^+) \\exp\\left(-\\frac{t-t_1}{\\tau_f}\\right)\n$$\n在时间 $t_2$，即第二个脉冲前瞬间，我们有 $t-t_1 = \\Delta$：\n$$\nu(t_2^-) = U \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right)\n$$\n\n$x(t)$ 的演化由以下方程决定：\n$$\n\\frac{d x}{d t} = \\frac{1 - x}{\\tau_{d}}\n$$\n这也是一个一阶线性常微分方程。我们可以将其重写为 $\\frac{dx}{1-x} = \\frac{dt}{\\tau_d}$。从 $t_1$ 到 $t_2$ 积分得到：\n$$\n\\int_{x(t_1^+)}^{x(t_2^-)} \\frac{dx}{1-x} = \\int_{t_1}^{t_2} \\frac{dt}{\\tau_d}\n$$\n$$\n\\bigl[-\\ln|1-x|\\bigr]_{x(t_1^+)}^{x(t_2^-)} = \\frac{t_2-t_1}{\\tau_d}\n$$\n$$\n-\\ln(1-x(t_2^-)) + \\ln(1-x(t_1^+)) = \\frac{\\Delta}{\\tau_d}\n$$\n$$\n\\ln\\left(\\frac{1-x(t_1^+)}{1-x(t_2^-)}\\right) = \\frac{\\Delta}{\\tau_d}\n$$\n$$\n1-x(t_2^-) = (1-x(t_1^+)) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n$$\nx(t_2^-) = 1 - (1-x(t_1^+)) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n代入初始条件 $x(t_1^+) = 1-U$：\n$$\nx(t_2^-) = 1 - \\bigl(1 - (1-U)\\bigr) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) = 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n\n步骤 3：分析 $t_2$ 时刻的第二个脉冲。\n我们得到了第二个脉冲前瞬间突触的状态：$u(t_2^-) = U \\exp(-\\Delta/\\tau_f)$ 和 $x(t_2^-) = 1 - U \\exp(-\\Delta/\\tau_d)$。\n\n我们使用跳跃条件计算 $u(t_2^+)$：\n$$\nu(t_2^+) = u(t_2^-) + U \\bigl(1 - u(t_2^-)\\bigr) = (1-U)u(t_2^-) + U\n$$\n代入 $u(t_2^-)$ 的表达式：\n$$\nu(t_2^+) = (1-U) \\left(U \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right)\\right) + U = U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right)\n$$\n第二次突触后响应的幅度 $E_2$ 为：\n$$\nE_2 = A u(t_2^+) x(t_2^-)\n$$\n代入 $u(t_2^+)$ 和 $x(t_2^-)$ 的表达式：\n$$\nE_2 = A \\left[ U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\right] \\left[ 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right]\n$$\n\n步骤 4：计算成对脉冲比率。\n最后，我们将 $E_2$ 除以 $E_1$ 来计算 PPR：\n$$\n\\text{PPR} = \\frac{E_2}{E_1} = \\frac{A U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)}{AU}\n$$\n$AU$ 项被消去，得到 PPR 的最终表达式：\n$$\n\\text{PPR} = \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)\n$$\n该表达式仅依赖于参数 $\\Delta$、$U$、$\\tau_f$ 和 $\\tau_d$，符合问题陈述的要求。第一项捕捉了易化效应，而第二项捕捉了抑制效应。",
            "answer": "$$\n\\boxed{\\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)}\n$$"
        },
        {
            "introduction": "虽然配对脉冲能够揭示很多信息，但神经活动通常由持续的脉冲序列组成。这个练习从双脉冲场景扩展到对脉冲序列的模拟，从而在解析理论和计算实践之间架起一座桥梁。你将通过实现模型的迭代动力学 ，观察在更真实的放电模式下，易化和抑制如何随时间相互作用，共同塑造突触的输出。",
            "id": "2751339",
            "problem": "给定一个短期突触可塑性的机制模型，该模型将易化和抑制捕捉为相互作用的动力学过程。考虑一个由基于资源模型控制的单个突触，其中两个状态变量随时间演化：瞬时释放概率 $u(t)$ 和可用资源的分数 $x(t)$。在由脉冲间期 $\\Delta t$ 分隔的突触前脉冲之间，这些变量遵循由内在弛豫驱动的一阶线性常微分方程：\n1. $u(t)$ 根据 $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$ 向 $0$ 弛豫，其中 $\\tau_f$ 是易化时间常数。\n2. $x(t)$ 根据 $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$ 向 $1$ 恢复，其中 $\\tau_d$ 是抑制恢复时间常数。\n\n在每个突触前脉冲到达时间 $t_k$，变量通过突触释放和易化被瞬时更新：\n1. 释放概率发生跳变 $u \\leftarrow u + U \\left(1 - u\\right)$，其中 $U$ 是基线利用率参数。\n2. 可用资源根据更新后的释放概率按比例消耗， $x \\leftarrow x \\left(1 - u\\right)$。\n\n假设初始状态为静息态 $u(0^{-}) = 0$ 和 $x(0^{-}) = 1$，以及一个频率为 $f$ 的周期性脉冲序列，因此 $\\Delta t = 1/f$。将第 $k$ 个脉冲处的归一化突触后响应定义为 $y_k = u_k x_k$，其中 $u_k$ 表示在第 $k$ 个脉冲处 $u$ 跳变后的瞬时值，$x_k$ 表示在第 $k$ 个脉冲处 $x$ 消耗前的瞬时值。所有响应 $y_k$ 都是无量纲的。\n\n任务：\n1. 从给定的微分方程和跳变规则出发，推导离散时间更新关系式，从而能够仅使用参数 $\\Delta t$、$U$、$\\tau_f$ 和 $\\tau_d$ 以及前一个脉冲的状态来计算连续脉冲的 $y_k$。\n2. 实现这些更新，为下面测试套件中的每个参数集计算前五个响应 $\\left(y_1, y_2, y_3, y_4, y_5\\right)$。使用以毫秒为单位的 $\\tau_f$ 和 $\\tau_d$，并在内部将它们转换为秒。使用以赫兹为单位的 $f$，因此 $\\Delta t$ 的单位是秒。\n3. 根据以下规则确定在前五个响应中是易化还是抑制占主导地位。设 $\\epsilon = 10^{-9}$。对于 $k = 2,3,4,5$，如果 $y_k - y_{k-1}  \\epsilon$ 则记为一次增加，如果 $y_k - y_{k-1}  -\\epsilon$ 则记为一次减少。设 $I$ 为增加的次数，$D$ 为减少的次数。定义主导性整数 $S$ 如下：\n   - $S = 1$ （易化主导），如果 $I \\ge 3$ 且 $y_5 - y_1  \\epsilon$，\n   - $S = -1$ （抑制主导），如果 $D \\ge 3$ 且 $y_5 - y_1  -\\epsilon$，\n   - $S = 0$ （混合或不明确），其他情况。\n\n数值输出要求：\n- 将五个响应表示为四舍五入到六位小数的浮点数。\n- 对每个参数集，输出一个包含六个条目的列表：五个四舍五入的响应，后跟整数 $S$。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由逗号分隔的列表组成的列表，并用方括号括起来，例如：[[y11,y12,y13,y14,y15,S1],[y21,y22,y23,y24,y25,S2],...].\n\n测试套件：\n为以下四个参数集提供结果。在所有情况下，计算前五个响应。当提到序列持续时间时，它仅用于为频率提供上下文；您应该假设周期性序列会按需持续以获得五个脉冲。\n1. 中等频率下的基线相互作用：$f = 20\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$。\n2. 强初始利用率，伴随更快的易化衰减和中等恢复：$f = 20\\ \\text{Hz}$, $U = 0.5$, $\\tau_f = 50\\ \\text{ms}$, $\\tau_d = 400\\ \\text{ms}$。\n3. 低初始利用率，伴随长时易化和快速恢复：$f = 20\\ \\text{Hz}$, $U = 0.05$, $\\tau_f = 1000\\ \\text{ms}$, $\\tau_d = 200\\ \\text{ms}$。\n4. 低频边界情况：$f = 1\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$。\n\n最终输出格式：\n- 单行输出，包含一个类似 JSON 的列表，其中有四个列表，每个测试用例一个，每个内部列表为 [y1,y2,y3,y4,y5,S]，使用上述的四舍五入和整数规则。",
            "solution": "问题已通过验证。\n\n**1. 提取已知条件**\n- 状态变量：瞬时释放概率 $u(t)$，可用资源分数 $x(t)$。\n- 脉冲间的动力学（脉冲间期 $\\Delta t$）：\n    - $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$\n    - $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$\n- 脉冲时间 $t_k$ 处的动力学：\n    - $u \\leftarrow u + U \\left(1 - u\\right)$\n    - $x \\leftarrow x \\left(1 - u\\right)$ （使用更新后的 $u$）\n- 初始状态：$u(0^{-}) = 0$, $x(0^{-}) = 1$。\n- 刺激：频率为 $f$ 的周期性脉冲序列，因此 $\\Delta t = 1/f$。\n- 输出变量：归一化突触后响应 $y_k = u_k x_k$，其中 $u_k$ 是在脉冲 $k$ 处 $u$ 跳变后的值，$x_k$ 是在脉冲 $k$ 处 $x$ 消耗前的值。\n- 任务：推导离散时间更新，实现它们以计算前五个响应（$y_1$ 到 $y_5$），并使用主导性整数 $S$ 对动力学进行分类。\n- 主导性规则：$\\epsilon = 10^{-9}$。$I$ 是增加的次数（$y_k - y_{k-1}  \\epsilon$），$D$ 是减少的次数（$y_k - y_{k-1}  -\\epsilon$），其中 $k \\in \\{2,3,4,5\\}$。如果 $I \\ge 3$ 且 $y_5 - y_1  \\epsilon$，则 $S=1$；如果 $D \\ge 3$ 且 $y_5 - y_1  -\\epsilon$，则 $S=-1$；否则 $S=0$。\n- 测试用例：提供了四个涉及 $f$、$U$、$\\tau_f$、$\\tau_d$ 的参数集。\n\n**2. 验证结论**\n问题是 **有效的**。它描述了一个成熟的、有科学依据的短期突触可塑性模型（Tsodyks-Markram 模型）。该问题在数学上是适定的，提供了所有必要的微分方程、更新规则、初始条件和参数。目标陈述清晰，并且在计算上是可行的。没有矛盾、歧义或事实错误。\n\n**3. 推导与求解方法**\n\n任务是计算由周期性突触前脉冲序列产生的突触后响应序列 $y_k$。这需要从给定的连续时间动力学和瞬时脉冲时间更新中推导出离散时间递推关系。\n\n让我们将第 $k$ 个脉冲前瞬间的突触状态定义为 $(u_{k}^{\\text{pre}}, x_{k}^{\\text{pre}})$。将在脉冲 $k$ 处更新和消耗后瞬间的状态定义为 $(u_k, x_{k}^{\\text{post}})$，其中 $u_k$ 是易化后的释放概率。\n\n**步骤 1：脉冲间的演化**\n在脉冲 $k-1$ 和脉冲 $k$ 之间，系统演化持续时间为 $\\Delta t = 1/f$。控制方程是一阶线性常微分方程。\n关于 $u(t)$ 的方程是 $\\dfrac{du}{dt} = -u/\\tau_f$。在初始条件 $u(t_{k-1}) = u_{k-1}$ 下，其解为 $u(t) = u_{k-1} e^{-(t - t_{k-1})/\\tau_f}$。因此，在脉冲 $k$ 前瞬间 $u$ 的值为：\n$$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n\n关于 $x(t)$ 的方程是 $\\dfrac{dx}{dt} = (1 - x)/\\tau_d$。让我们定义一个变量 $z(t) = 1 - x(t)$，所以 $\\dfrac{dz}{dt} = -\\dfrac{z}{\\tau_d}$。在初始条件 $x(t_{k-1}) = x_{k-1}^{\\text{post}}$ 下，我们有 $z(t_{k-1}) = 1 - x_{k-1}^{\\text{post}}$。$z(t)$ 的解是 $z(t) = z(t_{k-1}) e^{-(t - t_{k-1})/\\tau_d}$。代回 $x(t)$，我们得到 $1-x(t) = (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$，这意味着 $x(t) = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$。在脉冲 $k$ 前瞬间 $x$ 的值为：\n$$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n\n**步骤 2：脉冲处的更新**\n在脉冲 $k$ 到达时，变量被瞬时更新。\n首先，释放概率 $u$ 被易化。问题将 $u_k$ 定义为跳变后的值：\n$$u_k = u_{k}^{\\text{pre}} + U (1 - u_{k}^{\\text{pre}})$$\n问题将 $x_k$ 定义为资源在消耗*前*的值，这恰好是 $x_{k}^{\\text{pre}}$。因此：\n$$x_k = x_{k}^{\\text{pre}}$$\n归一化突触后响应 $y_k$ 接着被计算为：\n$$y_k = u_k x_k = u_k x_{k}^{\\text{pre}}$$\n最后，可用资源 $x$ 使用新更新的释放概率 $u_k$ 被消耗。消耗后 $x$ 的状态是：\n$$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**步骤 3：递推关系和算法**\n我们现在可以将这些步骤结合起来，形成一套完整的递推关系。系统的状态可以通过变量 $(u_k, x_{k}^{\\text{post}})$ 来跟踪。\n从步骤 $k-1$ 到 $k$ 的更新过程如下：\n1. 在脉冲间演化，以找到脉冲 $k$ 的脉冲前状态：\n   $$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n   $$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n2. 在脉冲 $k$ 处更新并计算响应：\n   $$u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$$\n   $$y_k = u_k x_{k}^{\\text{pre}}$$\n3. 计算下一个间期的消耗后资源状态：\n   $$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**初始条件：**\n系统从静息状态 $u(0^-)=0$ 和 $x(0^-)=1$ 开始。这对应于在 $t=-\\infty$ 处一个假设脉冲之后的状态。因此，对于第一个脉冲（$k=1$），我们可以将“前一个”状态值设置为 $u_0 = 0$ 和 $x_0^{\\text{post}} = 1$。\n模拟过程如下：\n用 $u_{\\text{prev}} = 0$ 和 $x_{\\text{post_prev}} = 1$ 进行初始化。\n对于 $k = 1, 2, 3, 4, 5$：\n- 计算 $u_{k}^{\\text{pre}} = u_{\\text{prev}} \\exp(-\\Delta t / \\tau_f)$。\n- 计算 $x_{k}^{\\text{pre}} = 1 - (1 - x_{\\text{post_prev}}) \\exp(-\\Delta t / \\tau_d)$。\n- 计算 $u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$。\n- 计算 $y_k = u_k x_{k}^{\\text{pre}}$。\n- 计算 $x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$。\n- 为下一次迭代更新：$u_{\\text{prev}} = u_k$ 和 $x_{\\text{post_prev}} = x_{k}^{\\text{post}}$。\n- 存储 $y_k$。\n\n时间常数 $\\tau_f$ 和 $\\tau_d$ 以毫秒（ms）为单位提供，必须通过除以 1000 转换为秒，以使其在量纲上与 $\\Delta t = 1/f$（其中 $f$ 的单位是 Hz）一致。\n\n**步骤 4：主导性分类**\n在计算出序列 $(y_1, y_2, y_3, y_4, y_5)$ 后，确定主导性整数 $S$。设 $\\epsilon = 10^{-9}$。\n- 初始化增加计数器 $I=0$ 和减少计数器 $D=0$。\n- 对于从 $2$ 到 $5$ 的 $k$，比较 $y_k$ 和 $y_{k-1}$：\n  - 如果 $y_k - y_{k-1}  \\epsilon$，则 $I$ 增加 1。\n  - 如果 $y_k - y_{k-1}  -\\epsilon$，则 $D$ 增加 1。\n- 应用规则：\n  - 如果 $I \\ge 3$ 且 $y_5 - y_1  \\epsilon$，则设 $S = 1$。\n  - 否则如果 $D \\ge 3$ 且 $y_5 - y_1  -\\epsilon$，则设 $S = -1$。\n  - 否则，设 $S = 0$。\n\n这就完成了解决该问题所需的理论和算法框架。实现将精确地遵循此逻辑。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the synaptic plasticity problem for all test cases and prints the final output.\n    \"\"\"\n\n    def compute_responses(f, U, tau_f_ms, tau_d_ms):\n        \"\"\"\n        Computes the first five synaptic responses and the dominance integer S\n        for a given set of parameters.\n\n        Args:\n            f (float): Spike train frequency in Hz.\n            U (float): Baseline utilization parameter.\n            tau_f_ms (float): Facilitation time constant in ms.\n            tau_d_ms (float): Depression recovery time constant in ms.\n\n        Returns:\n            list: A list containing the five rounded responses and the integer S.\n        \"\"\"\n        # Convert time constants from ms to s for consistency with f (Hz).\n        tau_f = tau_f_ms / 1000.0\n        tau_d = tau_d_ms / 1000.0\n        delta_t = 1.0 / f\n\n        # Pre-compute exponential decay factors\n        exp_f = np.exp(-delta_t / tau_f)\n        exp_d = np.exp(-delta_t / tau_d)\n\n        # Initial conditions corresponding to a quiescent synapse before the first spike.\n        # u_prev represents the post-facilitation u from the previous spike.\n        # x_post_prev represents the post-depletion x from the previous spike.\n        u_prev = 0.0\n        x_post_prev = 1.0\n\n        responses = []\n        num_spikes = 5\n\n        for _ in range(num_spikes):\n            # 1. Evolve state variables during the interspike interval\n            u_pre = u_prev * exp_f\n            x_pre = 1.0 - (1.0 - x_post_prev) * exp_d\n\n            # 2. Update at the spike arrival\n            # u_curr is the release probability for the current spike (post-facilitation)\n            u_curr = u_pre + U * (1.0 - u_pre)\n            \n            # The response y_k = u_k * x_k, where x_k is the resource level before depletion\n            y_k = u_curr * x_pre\n            responses.append(y_k)\n\n            # 3. Update resources after depletion\n            x_post_curr = x_pre * (1.0 - u_curr)\n\n            # 4. Prepare state for the next iteration\n            u_prev = u_curr\n            x_post_prev = x_post_curr\n        \n        # Determine the dominance integer S\n        epsilon = 1e-9\n        increases = 0\n        decreases = 0\n        for i in range(1, len(responses)):\n            diff = responses[i] - responses[i-1]\n            if diff > epsilon:\n                increases += 1\n            elif diff  -epsilon:\n                decreases += 1\n        \n        s_val = 0\n        if increases >= 3 and (responses[4] - responses[0]) > epsilon:\n            s_val = 1\n        elif decreases >= 3 and (responses[4] - responses[0])  -epsilon:\n            s_val = -1\n        \n        # Format the output as specified\n        rounded_responses = [round(y, 6) for y in responses]\n        return rounded_responses + [s_val]\n\n    # Test suite from the problem statement\n    test_cases = [\n        # f (Hz), U, tau_f (ms), tau_d (ms)\n        (20, 0.2, 200, 800),\n        (20, 0.5, 50, 400),\n        (20, 0.05, 1000, 200),\n        (1, 0.2, 200, 800),\n    ]\n\n    # Process all test cases\n    all_results = []\n    for case in test_cases:\n        result = compute_responses(*case)\n        all_results.append(result)\n\n    # Print the final output in the exact required format\n    # The output format is a JSON-like list of lists.\n    # We construct this string representation manually.\n    result_str = \",\".join([str(res) for res in all_results])\n    # Replace single quotes from Python's list __str__ with double quotes\n    # and remove spaces for a compact JSON-like representation.\n    final_output = result_str.replace(\"'\", '\"').replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "为了加深我们对复杂模型的理解，隔离并研究其各个组成部分通常很有帮助。这个问题专门聚焦于突触抑制及其恢复过程。通过计算一个突触从囊泡完全耗尽状态中恢复所需的时间 ，你将对抑制恢复时间常数 $\\tau_d$ 及其在决定突触为下一次传递做准备的速度中所起的关键作用，获得清晰直观的认识。",
            "id": "5060865",
            "problem": "一个皮层突触表现出短期突触可塑性（STP），其特征是活动依赖性抑制和易释放囊泡池（RRP）的恢复。在突触前脉冲之间，可用释放资源的分数（记作 $R(t)$）以由补充时间常数 $\\tau_d$ 控制的单指数时间进程恢复到其基线值 $R=1$。具体来说，在没有突触前脉冲的情况下，$R(t)$ 遵循以下一阶线性微分方程：\n$$\n\\frac{dR}{dt}=\\frac{1-R}{\\tau_d}.\n$$\n假设突触后反应幅度与 $R(t)$ 成正比，且基线反应对应于 $R=1$。一个持续时间为 1 秒、频率为 50 Hz 的突触前高频序列被传递，您可以假设该序列足够强以耗尽 RRP，因此在序列结束后立即（定义此时为 $t=0$），可用分数满足 $R(0)=0$。序列结束后，不再发生突触前脉冲，恢复过程遵循上述方程。\n\n从这些假设和方程出发，推导出反应恢复到基线 0.9 所需的时间 $t_{0.9}$，即满足 $R(t)=0.9$ 的最小 $t0$。用 $\\tau_d$ 将您的最终答案表示为一个闭式解析表达式（单位为秒）。不要提供数值近似值。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 可用释放资源的分数记作 $R(t)$。\n- 恢复时间常数为 $\\tau_d$。\n- 在没有脉冲的情况下，控制恢复的微分方程为 $\\frac{dR}{dt}=\\frac{1-R}{\\tau_d}$。\n- 可用分数的基线值为 $R=1$。\n- 在时间 $t=0$（定义为高频脉冲序列结束后立即），初始条件为 $R(0)=0$。\n- 目标是找到时间 $t_{0.9}$，使得 $R(t_{0.9}) = 0.9$。\n- 答案必须是用 $\\tau_d$ 表示的闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了一个简化的、但标准且广泛使用的短期突触抑制与恢复模型。微分方程 $\\frac{dR}{dt} = \\frac{1-R}{\\tau_d}$ 是一个经典的一阶动力学模型，用于描述一个过程以特征时间常数（$\\tau_d$）趋近于一个平衡值（这里是 $R=1$）的过程。该模型是突触可塑性现象学模型（如 Tsodyks-Markram 模型）的基石。该场景在科学上是合理的，并且与计算神经科学和生物物理学相关。\n\n2.  **适定性**：该问题构成了一个适定的初值问题（IVP）。它提供了一个一阶线性常微分方程（ODE）和相应的初始条件 $R(0)=0$。这样的初值问题对于 $R(t)$ 有一个唯一的解。问题要求找到该函数达到特定值（0.9）的时间。由于 $R(t)$ 从 0 开始并渐近地趋近于 1，它将在且仅在一个正的时间 $t$ 穿过 0.9。解是唯一的、稳定的且有意义的。\n\n3.  **客观性**：问题陈述使用了精确的数学和科学术语。所有量都有明确定义。没有主观或模糊的语言。\n\n4.  **完整性与一致性**：问题提供了求解所需的所有必要信息。ODE、初始条件和目标值都已明确说明。关于刺激序列（50 Hz，持续 1 秒）的信息为初始条件 $R(0)=0$ 提供了物理上的合理解释，并且没有引入任何矛盾。\n\n5.  **可行性**：假设 $R(0)=0$（完全耗尽）是一种理想化情况，但这是理论模型中为便于分析而常用的简化假设。它代表了强烈突触抑制的极端情况，在数学模型的背景下并不会使问题在科学上不合理或物理上不可能。\n\n### 步骤 3：结论与行动\n该问题具有科学依据、是适定的，并且提供了所有必要信息。这是一个有效且可解的问题。现在将推导解答。\n\n易释放囊泡池 $R(t)$ 的恢复由以下一阶线性常微分方程控制：\n$$\n\\frac{dR}{dt} = \\frac{1-R}{\\tau_d}\n$$\n该方程服从初始条件，即在 $t=0$ 时资源被完全耗尽：\n$$\nR(0) = 0\n$$\n为了找到函数 $R(t)$，我们求解这个微分方程。这是一个可分离变量的方程。我们可以重新整理各项以分离变量 $R$ 和 $t$：\n$$\n\\frac{dR}{1-R} = \\frac{dt}{\\tau_d}\n$$\n接下来，我们对两边进行积分。我们从初始状态 $(t', R') = (0, R(0)=0)$ 积分到一个任意状态 $(t, R(t))$：\n$$\n\\int_{R(0)}^{R(t)} \\frac{1}{1-R'} dR' = \\int_{0}^{t} \\frac{1}{\\tau_d} dt'\n$$\n代入初始条件 $R(0)=0$：\n$$\n\\int_{0}^{R(t)} \\frac{1}{1-R'} dR' = \\frac{1}{\\tau_d} \\int_{0}^{t} dt'\n$$\n左边的积分是 $[-\\ln(1-R')]_{0}^{R(t)}$。对于恢复过程，$R(t)$ 将介于 0 和 1 之间，所以 $1-R'$ 始终为正，不需要绝对值。右边的积分是 $[\\frac{t'}{\\tau_d}]_{0}^{t}$。\n计算定积分得出：\n$$\n-\\ln(1-R(t)) - (-\\ln(1-0)) = \\frac{t}{\\tau_d} - 0\n$$\n由于 $\\ln(1)=0$，这简化为：\n$$\n-\\ln(1-R(t)) = \\frac{t}{\\tau_d}\n$$\n为了求出 $R(t)$ 的显式形式，我们求解 $R(t)$。首先，两边乘以 -1：\n$$\n\\ln(1-R(t)) = -\\frac{t}{\\tau_d}\n$$\n然后，对两边取指数（以 $e$ 为底）：\n$$\n1-R(t) = \\exp\\left(-\\frac{t}{\\tau_d}\\right)\n$$\n最后，分离出 $R(t)$：\n$$\nR(t) = 1 - \\exp\\left(-\\frac{t}{\\tau_d}\\right)\n$$\n这个方程描述了从完全耗尽状态恢复的时间进程。现在，我们必须找到响应恢复到其基线值 0.9 时的时间 $t_{0.9}$。这对应于找到使 $R(t)=0.9$ 的时间 $t$。我们在解中设定 $R(t_{0.9})=0.9$：\n$$\n0.9 = 1 - \\exp\\left(-\\frac{t_{0.9}}{\\tau_d}\\right)\n$$\n现在，我们求解 $t_{0.9}$。重新整理方程以分离指数项：\n$$\n\\exp\\left(-\\frac{t_{0.9}}{\\tau_d}\\right) = 1 - 0.9 = 0.1\n$$\n为了求解 $t_{0.9}$，我们对两边取自然对数（$\\ln$）：\n$$\n\\ln\\left(\\exp\\left(-\\frac{t_{0.9}}{\\tau_d}\\right)\\right) = \\ln(0.1)\n$$\n$$\n-\\frac{t_{0.9}}{\\tau_d} = \\ln(0.1)\n$$\n0.1 的自然对数可以写成 $\\ln(1/10) = \\ln(10^{-1}) = -\\ln(10)$。\n$$\n-\\frac{t_{0.9}}{\\tau_d} = -\\ln(10)\n$$\n两边乘以 $-\\tau_d$ 得到 $t_{0.9}$ 的最终表达式：\n$$\nt_{0.9} = \\tau_d \\ln(10)\n$$\n这是资源池恢复到其基线值 90% 所需时间的闭式解析表达式，用恢复时间常数 $\\tau_d$ 表示。$t_{0.9}$ 的单位将与 $\\tau_d$ 的单位相同，即秒。",
            "answer": "$$\n\\boxed{\\tau_d \\ln(10)}\n$$"
        }
    ]
}