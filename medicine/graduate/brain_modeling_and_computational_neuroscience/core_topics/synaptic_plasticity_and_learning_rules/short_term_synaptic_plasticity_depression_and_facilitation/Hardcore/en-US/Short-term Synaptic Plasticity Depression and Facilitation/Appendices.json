{
    "hands_on_practices": [
        {
            "introduction": "Short-term synaptic plasticity is not a monolithic process. To begin our hands-on exploration, we first isolate one of its core components: synaptic depression. This exercise models the depletion and subsequent recovery of the readily releasable pool of synaptic vesicles, governed by the time constant $\\tau_d$. By calculating the time required for a synapse to recover its strength after intense activity, you will gain a concrete understanding of the dynamics of resource availability, a cornerstone of synaptic transmission .",
            "id": "5060865",
            "problem": "A cortical synapse exhibits short-term synaptic plasticity (STP) characterized by activity-dependent depression and recovery of the readily releasable pool (RRP) of vesicles. Between presynaptic spikes, the fraction of available release resources, denoted by $R(t)$, recovers toward its baseline value $R=1$ with a single-exponential time course governed by the replenishment time constant $\\tau_d$. Specifically, in the absence of presynaptic spikes, $R(t)$ follows the first-order linear differential equation\n$$\n\\frac{dR}{dt}=\\frac{1-R}{\\tau_d}.\n$$\nAssume that the postsynaptic response amplitude is proportional to $R(t)$ and that the baseline response corresponds to $R=1$. A presynaptic high-frequency train of duration $1$ second at $50$ Hz is delivered, and you may assume this train is sufficiently strong to deplete the RRP so that immediately after the train ends (define this as $t=0$), the available fraction satisfies $R(0)=0$. After the end of the train, no further presynaptic spikes occur and recovery proceeds according to the equation above.\n\nStarting from these assumptions and equations, derive the time $t_{0.9}$ required for the response to recover to $0.9$ of baseline, that is, the smallest $t>0$ such that $R(t)=0.9$. Express your final answer as a closed-form analytical expression in seconds, in terms of $\\tau_d$. Do not provide a numerical approximation.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- The fraction of available release resources is denoted by $R(t)$.\n- The recovery time constant is $\\tau_d$.\n- The governing differential equation for recovery in the absence of spikes is $\\frac{dR}{dt}=\\frac{1-R}{\\tau_d}$.\n- The baseline value of the available fraction is $R=1$.\n- At time $t=0$, which is defined as immediately after the end of a high-frequency spike train, the initial condition is $R(0)=0$.\n- The goal is to find the time $t_{0.9}$ such that $R(t_{0.9}) = 0.9$.\n- The answer must be a closed-form analytical expression in terms of $\\tau_d$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem describes a simplified, but standard and widely used, model of short-term synaptic depression and recovery. The differential equation $\\frac{dR}{dt} = \\frac{1-R}{\\tau_d}$ is a classic first-order kinetic model for a process approaching an equilibrium value (here, $R=1$) with a characteristic time constant ($\\tau_d$). This model is a cornerstone of phenomenological models of synaptic plasticity, such as the Tsodyks-Markram model. The scenario is scientifically sound and relevant to computational neuroscience and biophysics.\n\n2.  **Well-Posedness**: The problem constitutes a well-posed initial value problem (IVP). It provides a first-order linear ordinary differential equation (ODE) and a corresponding initial condition, $R(0)=0$. Such an IVP has a unique solution for $R(t)$. The question asks to find the time at which this function reaches a specific value ($0.9$). Since $R(t)$ starts at $0$ and asymptotically approaches $1$, it will pass through $0.9$ at exactly one positive time $t$. The solution is unique, stable, and meaningful.\n\n3.  **Objectivity**: The problem is stated using precise mathematical and scientific terminology. All quantities are clearly defined. There is no subjective or ambiguous language.\n\n4.  **Completeness and Consistency**: The problem provides all necessary information to find the solution. The ODE, the initial condition, and the target value are all explicitly stated. The information regarding the stimulus train ($50$ Hz for $1$ second) serves as a physical justification for the initial condition $R(0)=0$ and does not introduce any contradictions.\n\n5.  **Feasibility**: The assumption that $R(0)=0$ (complete depletion) is an idealization, but it is a common simplifying assumption in theoretical models to facilitate analysis. It represents an extreme case of strong synaptic depression and does not render the problem scientifically implausible or physically impossible within the context of a mathematical model.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and all necessary information is provided. It is a valid and solvable problem. A solution will now be derived.\n\nThe recovery of the readily releasable pool of vesicles, $R(t)$, is governed by the first-order linear ordinary differential equation:\n$$\n\\frac{dR}{dt} = \\frac{1-R}{\\tau_d}\n$$\nThis equation is subject to the initial condition that the resources are fully depleted at $t=0$:\n$$\nR(0) = 0\n$$\nTo find the function $R(t)$, we solve this differential equation. It is a separable equation. We can rearrange the terms to separate the variables $R$ and $t$:\n$$\n\\frac{dR}{1-R} = \\frac{dt}{\\tau_d}\n$$\nNext, we integrate both sides. We integrate from the initial state $(t', R') = (0, R(0)=0)$ to an arbitrary state $(t, R(t))$:\n$$\n\\int_{R(0)}^{R(t)} \\frac{1}{1-R'} dR' = \\int_{0}^{t} \\frac{1}{\\tau_d} dt'\n$$\nSubstituting the initial condition $R(0)=0$:\n$$\n\\int_{0}^{R(t)} \\frac{1}{1-R'} dR' = \\frac{1}{\\tau_d} \\int_{0}^{t} dt'\n$$\nThe integral on the left-hand side is $[-\\ln(1-R')]_{0}^{R(t)}$. For the recovery process, $R(t)$ will be between $0$ and $1$, so $1-R'$ is always positive and the absolute value is not needed. The integral on the right-hand side is $[\\frac{t'}{\\tau_d}]_{0}^{t}$.\nEvaluating the definite integrals gives:\n$$\n-\\ln(1-R(t)) - (-\\ln(1-0)) = \\frac{t}{\\tau_d} - 0\n$$\nSince $\\ln(1)=0$, this simplifies to:\n$$\n-\\ln(1-R(t)) = \\frac{t}{\\tau_d}\n$$\nTo find the explicit form of $R(t)$, we solve for $R(t)$. First, multiply by $-1$:\n$$\n\\ln(1-R(t)) = -\\frac{t}{\\tau_d}\n$$\nThen, exponentiate both sides (with base $e$):\n$$\n1-R(t) = \\exp\\left(-\\frac{t}{\\tau_d}\\right)\n$$\nFinally, isolate $R(t)$:\n$$\nR(t) = 1 - \\exp\\left(-\\frac{t}{\\tau_d}\\right)\n$$\nThis equation describes the time course of recovery from complete depletion. Now, we must find the time $t_{0.9}$ at which the response has recovered to $0.9$ of its baseline value. This corresponds to finding the time $t$ for which $R(t)=0.9$. We set $R(t_{0.9})=0.9$ in our solution:\n$$\n0.9 = 1 - \\exp\\left(-\\frac{t_{0.9}}{\\tau_d}\\right)\n$$\nNow, we solve for $t_{0.9}$. Rearranging the equation to isolate the exponential term:\n$$\n\\exp\\left(-\\frac{t_{0.9}}{\\tau_d}\\right) = 1 - 0.9 = 0.1\n$$\nTo solve for $t_{0.9}$, we take the natural logarithm ($\\ln$) of both sides:\n$$\n\\ln\\left(\\exp\\left(-\\frac{t_{0.9}}{\\tau_d}\\right)\\right) = \\ln(0.1)\n$$\n$$\n-\\frac{t_{0.9}}{\\tau_d} = \\ln(0.1)\n$$\nThe natural logarithm of $0.1$ can be written as $\\ln(1/10) = \\ln(10^{-1}) = -\\ln(10)$.\n$$\n-\\frac{t_{0.9}}{\\tau_d} = -\\ln(10)\n$$\nMultiplying both sides by $-\\tau_d$ gives the final expression for $t_{0.9}$:\n$$\nt_{0.9} = \\tau_d \\ln(10)\n$$\nThis is the closed-form analytical expression for the time required for the resource pool to recover to $90\\%$ of its baseline value, expressed in terms of the recovery time constant $\\tau_d$. The unit of $t_{0.9}$ will be the same as the unit of $\\tau_d$, which is seconds.",
            "answer": "$$\n\\boxed{\\tau_d \\ln(10)}\n$$"
        },
        {
            "introduction": "Having examined depression in isolation, we now integrate its counterpart: synaptic facilitation. The Tsodyks-Markram model provides a concise mathematical framework for the dynamic interplay between these two opposing processes. This next practice challenges you to derive one of the most fundamental metrics in synaptic physiology, the paired-pulse ratio (PPR), from the model's core equations. This derivation will illuminate how the parameters for facilitation ($U, \\tau_f$) and depression ($\\tau_d$) collectively shape the synaptic response to two closely-timed inputs .",
            "id": "4018478",
            "problem": "Consider a synapse described by the Tsodyks–Markram model of short-term plasticity, which captures both facilitation and depression. Let $u(t)$ denote the utilization of synaptic efficacy (facilitation variable) and let $x(t)$ denote the fraction of available synaptic resources (depression variable). Between presynaptic spikes, these variables evolve according to the ordinary differential equations\n$$\n\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}, \\qquad \\frac{d x}{d t} = \\frac{1 - x}{\\tau_{d}},\n$$\nwhere $\\tau_{f} > 0$ and $\\tau_{d} > 0$ are the facilitation and depression time constants, respectively. At each presynaptic spike time $t_{k}$, the variables undergo jump updates:\n$$\nu(t_{k}^{+}) = u(t_{k}^{-}) + U \\bigl(1 - u(t_{k}^{-})\\bigr), \\qquad x(t_{k}^{+}) = x(t_{k}^{-}) \\bigl(1 - u(t_{k}^{+})\\bigr),\n$$\nwhere $U \\in (0,1)$ is a parameter that quantifies the increment in utilization per spike, and $t_{k}^{-}$ and $t_{k}^{+}$ denote the limits immediately before and after the spike, respectively. Assume the synapse is at rest for a sufficiently long time before the first spike at time $t_{1}$, so that $u(t_{1}^{-}) = 0$ and $x(t_{1}^{-}) = 1$.\n\nLet two identical presynaptic spikes occur at times $t_{1}$ and $t_{2} = t_{1} + \\Delta$, where $\\Delta > 0$ is the inter-pulse interval (IPI). The postsynaptic response amplitude evoked by the $k$-th spike is proportional to $A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$, with $A > 0$ a constant scaling factor. Define the paired-pulse ratio (PPR) as the ratio of the second evoked peak amplitude to the first.\n\nStarting from the given dynamics and jump conditions, derive a closed-form analytic expression for the paired-pulse ratio in terms of $\\Delta$, $U$, $\\tau_{f}$, and $\\tau_{d}$. Express your final result as a symbolic expression; do not substitute numerical values. If you introduce auxiliary quantities, eliminate them so that the final expression depends only on $\\Delta$, $U$, $\\tau_{f}$, and $\\tau_{d}$.",
            "solution": "The problem is to derive a closed-form expression for the paired-pulse ratio (PPR) for a synapse described by the Tsodyks–Markram model. The problem statement is scientifically grounded, well-posed, and provides all necessary information. It is a standard exercise in computational neuroscience and is therefore valid.\n\nThe paired-pulse ratio, PPR, is defined as the ratio of the amplitude of the second postsynaptic response, $E_2$, to the amplitude of the first, $E_1$.\n$$\n\\text{PPR} = \\frac{E_2}{E_1}\n$$\nThe postsynaptic response amplitude evoked by the $k$-th spike is given as being proportional to $A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$. We can thus write the amplitudes as $E_k = c A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$ for some constant of proportionality $c$. As we are calculating a ratio, this constant will cancel. For simplicity, we will set $c=1$, so that $E_k = A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$.\n\nOur derivation proceeds in four steps:\n1.  Calculate the state of the synapse and the response amplitude for the first spike at $t_1$.\n2.  Evolve the synaptic variables $u(t)$ and $x(t)$ during the inter-pulse interval $\\Delta$.\n3.  Calculate the state of the synapse and the response amplitude for the second spike at $t_2$.\n4.  Compute the ratio of the amplitudes.\n\nStep 1: Analysis of the first spike at $t_1$.\nThe synapse is at rest before the first spike, so the initial conditions are given as $u(t_1^-) = 0$ and $x(t_1^-) = 1$.\n\nFirst, we find the value of the facilitation variable $u$ immediately after the spike, $u(t_1^+)$, using the jump condition:\n$$\nu(t_1^+) = u(t_1^-) + U \\bigl(1 - u(t_1^-)\\bigr)\n$$\nSubstituting $u(t_1^-) = 0$:\n$$\nu(t_1^+) = 0 + U(1-0) = U\n$$\nThe amplitude of the first postsynaptic response, $E_1$, is:\n$$\nE_1 = A u(t_1^+) x(t_1^-)\n$$\nSubstituting the values $u(t_1^+) = U$ and $x(t_1^-) = 1$:\n$$\nE_1 = A \\cdot U \\cdot 1 = AU\n$$\nNext, we find the value of the depression variable $x$ immediately after the spike, $x(t_1^+)$, using its jump condition:\n$$\nx(t_1^+) = x(t_1^-) \\bigl(1 - u(t_1^+)\\bigr)\n$$\nSubstituting $x(t_1^-) = 1$ and $u(t_1^+) = U$:\n$$\nx(t_1^+) = 1 \\cdot (1 - U) = 1-U\n$$\n\nStep 2: Evolution during the inter-pulse interval.\nBetween the first spike at $t_1$ and the second spike at $t_2 = t_1 + \\Delta$, the variables evolve according to the given differential equations. We need to find the values $u(t_2^-)$ and $x(t_2^-)$.\n\nThe evolution of $u(t)$ is governed by:\n$$\n\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}\n$$\nThis is a first-order linear ordinary differential equation. We solve it over the interval $[t_1, t_2]$ with the initial condition $u(t_1) = u(t_1^+) = U$. The solution is an exponential decay:\n$$\nu(t) = u(t_1^+) \\exp\\left(-\\frac{t-t_1}{\\tau_f}\\right)\n$$\nAt time $t_2$, just before the spike, we have $t-t_1 = \\Delta$:\n$$\nu(t_2^-) = U \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right)\n$$\n\nThe evolution of $x(t)$ is governed by:\n$$\n\\frac{d x}{d t} = \\frac{1 - x}{\\tau_{d}}\n$$\nThis is also a first-order linear ODE. We can rewrite it as $\\frac{dx}{1-x} = \\frac{dt}{\\tau_d}$. Integrating from $t_1$ to $t_2$ gives:\n$$\n\\int_{x(t_1^+)}^{x(t_2^-)} \\frac{dx}{1-x} = \\int_{t_1}^{t_2} \\frac{dt}{\\tau_d}\n$$\n$$\n\\bigl[-\\ln|1-x|\\bigr]_{x(t_1^+)}^{x(t_2^-)} = \\frac{t_2-t_1}{\\tau_d}\n$$\n$$\n-\\ln(1-x(t_2^-)) + \\ln(1-x(t_1^+)) = \\frac{\\Delta}{\\tau_d}\n$$\n$$\n\\ln\\left(\\frac{1-x(t_1^+)}{1-x(t_2^-)}\\right) = \\frac{\\Delta}{\\tau_d}\n$$\n$$\n1-x(t_2^-) = (1-x(t_1^+)) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n$$\nx(t_2^-) = 1 - (1-x(t_1^+)) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\nSubstituting the initial condition $x(t_1^+) = 1-U$:\n$$\nx(t_2^-) = 1 - \\bigl(1 - (1-U)\\bigr) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) = 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n\nStep 3: Analysis of the second spike at $t_2$.\nWe have the state of the synapse just before the second spike: $u(t_2^-) = U \\exp(-\\Delta/\\tau_f)$ and $x(t_2^-) = 1 - U \\exp(-\\Delta/\\tau_d)$.\n\nWe calculate $u(t_2^+)$ using the jump condition:\n$$\nu(t_2^+) = u(t_2^-) + U \\bigl(1 - u(t_2^-)\\bigr) = (1-U)u(t_2^-) + U\n$$\nSubstituting the expression for $u(t_2^-)$:\n$$\nu(t_2^+) = (1-U) \\left(U \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right)\\right) + U = U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right)\n$$\nThe amplitude of the second postsynaptic response, $E_2$, is:\n$$\nE_2 = A u(t_2^+) x(t_2^-)\n$$\nSubstituting the expressions for $u(t_2^+)$ and $x(t_2^-)$:\n$$\nE_2 = A \\left[ U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\right] \\left[ 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right]\n$$\n\nStep 4: Calculation of the Paired-Pulse Ratio.\nFinally, we compute the PPR by dividing $E_2$ by $E_1$:\n$$\n\\text{PPR} = \\frac{E_2}{E_1} = \\frac{A U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)}{AU}\n$$\nThe term $AU$ cancels, yielding the final expression for the PPR:\n$$\n\\text{PPR} = \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)\n$$\nThis expression depends only on the parameters $\\Delta$, $U$, $\\tau_f$, and $\\tau_d$, as required by the problem statement. The first term captures the effect of facilitation, while the second term captures the effect of depression.",
            "answer": "$$\n\\boxed{\\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)}\n$$"
        },
        {
            "introduction": "While paired-pulse experiments are foundational, real neurons communicate through extended trains of action potentials. To understand how synapses process these rich temporal patterns, we must move from analytical solutions for two spikes to computational simulation for many. This final practice asks you to implement the Tsodyks-Markram model to track synaptic strength during a spike train. By simulating the response dynamics, you will directly observe how facilitation and depression compete over time and learn to classify the synapse's overall behavior as facilitating, depressing, or mixed .",
            "id": "2751339",
            "problem": "You are given a mechanistic model of short-term synaptic plasticity that captures facilitation and depression as interacting dynamical processes. Consider a single synapse governed by a resource-based model in which two state variables evolve in time: the instantaneous release probability $u(t)$ and the fraction of resources available $x(t)$. Between presynaptic spikes separated by an interspike interval $\\Delta t$, these variables obey first-order linear ordinary differential equations driven by intrinsic relaxation:\n1. $u(t)$ relaxes toward $0$ according to $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$, where $\\tau_f$ is the facilitation time constant.\n2. $x(t)$ recovers toward $1$ according to $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$, where $\\tau_d$ is the depression recovery time constant.\n\nAt each presynaptic spike arrival time $t_k$, the variables are instantaneously updated by synaptic release and facilitation:\n1. The release probability jumps as $u \\leftarrow u + U \\left(1 - u\\right)$, where $U$ is the baseline utilization parameter.\n2. The available resources are depleted in proportion to the updated release probability, $x \\leftarrow x \\left(1 - u\\right)$.\n\nAssume an initial quiescent state with $u(0^{-}) = 0$ and $x(0^{-}) = 1$, and a periodic spike train of frequency $f$ so that $\\Delta t = 1/f$. Define the normalized postsynaptic response at the $k$-th spike as $y_k = u_k x_k$, where $u_k$ denotes the value of $u$ immediately after its jump at the $k$-th spike and $x_k$ denotes the value of $x$ immediately before the depletion at the $k$-th spike. All responses $y_k$ are dimensionless.\n\nTask:\n1. Starting from the stated differential equations and jump rules, derive discrete-time update relations that enable computation of $y_k$ for successive spikes using only the parameters $\\Delta t$, $U$, $\\tau_f$, and $\\tau_d$ and the previous spike’s state.\n2. Implement these updates to compute the first five responses $\\left(y_1, y_2, y_3, y_4, y_5\\right)$ for each parameter set in the test suite below. Use $\\tau_f$ and $\\tau_d$ in milliseconds and convert to seconds internally. Use $f$ in Hertz so that $\\Delta t$ is in seconds.\n3. Determine whether facilitation or depression dominates over the first five responses according to the following rule. Let $\\epsilon = 10^{-9}$. For $k = 2,3,4,5$, count an increase if $y_k - y_{k-1} > \\epsilon$ and a decrease if $y_k - y_{k-1}  -\\epsilon$. Let $I$ be the number of increases and $D$ the number of decreases. Define the dominance integer $S$ by:\n   - $S = 1$ (facilitation-dominant) if $I \\ge 3$ and $y_5 - y_1 > \\epsilon$,\n   - $S = -1$ (depression-dominant) if $D \\ge 3$ and $y_5 - y_1  -\\epsilon$,\n   - $S = 0$ (mixed or ambiguous) otherwise.\n\nNumerical output requirements:\n- Express the five responses as floating-point numbers rounded to six decimal places.\n- For each parameter set, output a list containing six entries: the five rounded responses followed by the integer $S$.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these lists enclosed in square brackets, for example: `[[y11,y12,y13,y14,y15,S1],[y21,y22,y23,y24,y25,S2],...]`.\n\nTest suite:\nProvide results for the following four parameter sets. In all cases, compute the first five responses. When a train duration is mentioned, it is only to contextualize the frequency; you should assume the periodic train is sustained as needed to obtain five spikes.\n1. Baseline interaction at moderate frequency: $f = 20\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$.\n2. Strong initial utilization with faster facilitation decay and moderate recovery: $f = 20\\ \\text{Hz}$, $U = 0.5$, $\\tau_f = 50\\ \\text{ms}$, $\\tau_d = 400\\ \\text{ms}$.\n3. Low initial utilization with long facilitation and fast recovery: $f = 20\\ \\text{Hz}$, $U = 0.05$, $\\tau_f = 1000\\ \\text{ms}$, $\\tau_d = 200\\ \\text{ms}$.\n4. Low frequency boundary case: $f = 1\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$.\n\nFinal output format:\n- A single line containing a JSON-like list of four lists, one per test case, where each inner list is [$y_1, y_2, y_3, y_4, y_5, S$] using the rounding and integer rules above.",
            "solution": "The problem is subjected to validation.\n\n**1. Extraction of Givens**\n- State variables: instantaneous release probability $u(t)$, fraction of available resources $x(t)$.\n- Dynamics between spikes (interspike interval $\\Delta t$):\n    - $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$\n    - $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$\n- Dynamics at spike time $t_k$:\n    - $u \\leftarrow u + U \\left(1 - u\\right)$\n    - $x \\leftarrow x \\left(1 - u\\right)$ (with the updated $u$)\n- Initial state: $u(0^{-}) = 0$, $x(0^{-}) = 1$.\n- Stimulus: Periodic spike train with frequency $f$, so $\\Delta t = 1/f$.\n- Output variable: Normalized postsynaptic response $y_k = u_k x_k$, where $u_k$ is the value of $u$ immediately after its jump at spike $k$, and $x_k$ is the value of $x$ immediately before depletion at spike $k$.\n- Task: Derive discrete-time updates, implement them to compute the first five responses ($y_1$ to $y_5$), and classify the dynamics using a dominance integer $S$.\n- Dominance rule: $\\epsilon = 10^{-9}$. $I$ is count of increases ($y_k - y_{k-1} > \\epsilon$), $D$ is count of decreases ($y_k - y_{k-1}  -\\epsilon$) for $k \\in \\{2,3,4,5\\}$. $S=1$ if $I \\ge 3$ and $y_5 - y_1 > \\epsilon$; $S=-1$ if $D \\ge 3$ and $y_5 - y_1  -\\epsilon$; $S=0$ otherwise.\n- Test cases: Four parameter sets involving $f$, $U$, $\\tau_f$, $\\tau_d$ are provided.\n\n**2. Validation Verdict**\nThe problem is **valid**. It describes a well-established, scientifically grounded model of short-term synaptic plasticity (the Tsodyks-Markram model). The problem is mathematically well-posed, providing all necessary differential equations, update rules, initial conditions, and parameters. The objectives are stated clearly and are computationally tractable. There are no contradictions, ambiguities, or factual errors.\n\n**3. Derivation and Solution Methodology**\n\nThe task is to compute the sequence of postsynaptic responses $y_k$ generated by a periodic presynaptic spike train. This requires deriving discrete-time recurrence relations from the given continuous-time dynamics and instantaneous spike-time updates.\n\nLet us define the state of the synapse immediately before the $k$-th spike as $(u_{k}^{\\text{pre}}, x_{k}^{\\text{pre}})$. Let the state immediately after the update and depletion at spike $k$ be $(u_k, x_{k}^{\\text{post}})$, where $u_k$ is the post-facilitation release probability.\n\n**Step 1: Evolution between spikes**\nBetween spike $k-1$ and spike $k$, the system evolves for a duration $\\Delta t = 1/f$. The governing ordinary differential equations are linear and first-order.\nThe equation for $u(t)$ is $\\dfrac{du}{dt} = -u/\\tau_f$. With initial condition $u(t_{k-1}) = u_{k-1}$, its solution is $u(t) = u_{k-1} e^{-(t - t_{k-1})/\\tau_f}$. Thus, the value of $u$ just before spike $k$ is:\n$$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n\nThe equation for $x(t)$ is $\\dfrac{dx}{dt} = (1 - x)/\\tau_d$. Let's define a variable $z(t) = 1 - x(t)$, so $\\dfrac{dz}{dt} = -\\dfrac{z}{\\tau_d}$. With initial condition $x(t_{k-1}) = x_{k-1}^{\\text{post}}$, we have $z(t_{k-1}) = 1 - x_{k-1}^{\\text{post}}$. The solution for $z(t)$ is $z(t) = z(t_{k-1}) e^{-(t - t_{k-1})/\\tau_d}$. Substituting back for $x(t)$, we get $1-x(t) = (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$, which means $x(t) = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$. The value of $x$ just before spike $k$ is:\n$$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n\n**Step 2: Updates at a spike**\nAt the arrival of spike $k$, the variables are updated instantaneously.\nFirst, the release probability $u$ is facilitated. The problem defines $u_k$ as the value after the jump:\n$$u_k = u_{k}^{\\text{pre}} + U (1 - u_{k}^{\\text{pre}})$$\nThe problem defines $x_k$ as the value of the resource *before* depletion, which is precisely $x_{k}^{\\text{pre}}$. Therefore:\n$$x_k = x_{k}^{\\text{pre}}$$\nThe normalized postsynaptic response $y_k$ is then calculated as:\n$$y_k = u_k x_k = u_k x_{k}^{\\text{pre}}$$\nFinally, the available resources $x$ are depleted using the newly updated release probability $u_k$. The state of $x$ after depletion is:\n$$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**Step 3: Recurrence Relations and Algorithm**\nWe can now combine these steps to form a complete set of recurrence relations. The state of the system can be tracked by the variables $(u_k, x_{k}^{\\text{post}})$.\nThe update from step $k-1$ to $k$ proceeds as follows:\n1. Evolve between spikes to find the pre-spike state for spike $k$:\n   $$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n   $$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n2. Update at spike $k$ and calculate the response:\n   $$u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$$\n   $$y_k = u_k x_{k}^{\\text{pre}}$$\n3. Calculate the post-depletion resource state for the next interval:\n   $$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**Initial Conditions:**\nThe system starts from a quiescent state, $u(0^-)=0$ and $x(0^-)=1$. This corresponds to the state after a hypothetical spike at $t=-\\infty$. Thus, for the first spike ($k=1$), we can set the \"previous\" state values as $u_0 = 0$ and $x_0^{\\text{post}} = 1$.\nThe simulation proceeds as follows:\nInitialize with $u_{\\text{prev}} = 0$ and $x_{\\text{post_prev}} = 1$.\nFor $k = 1, 2, 3, 4, 5$:\n- Compute $u_{k}^{\\text{pre}} = u_{\\text{prev}} \\exp(-\\Delta t / \\tau_f)$.\n- Compute $x_{k}^{\\text{pre}} = 1 - (1 - x_{\\text{post_prev}}) \\exp(-\\Delta t / \\tau_d)$.\n- Compute $u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$.\n- Compute $y_k = u_k x_{k}^{\\text{pre}}$.\n- Compute $x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$.\n- Update for the next iteration: $u_{\\text{prev}} = u_k$ and $x_{\\text{post_prev}} = x_{k}^{\\text{post}}$.\n- Store $y_k$.\n\nThe time constants $\\tau_f$ and $\\tau_d$ are provided in milliseconds (ms) and must be converted to seconds by dividing by $1000$ to be dimensionally consistent with $\\Delta t = 1/f$, where $f$ is in Hz.\n\n**Step 4: Dominance Classification**\nAfter computing the sequence $(y_1, y_2, y_3, y_4, y_5)$, the dominance integer $S$ is determined. Let $\\epsilon = 10^{-9}$.\n- Initialize counters for increases $I=0$ and decreases $D=0$.\n- For $k$ from $2$ to $5$, compare $y_k$ and $y_{k-1}$:\n  - If $y_k - y_{k-1}  \\epsilon$, increment $I$.\n  - If $y_k - y_{k-1}  -\\epsilon$, increment $D$.\n- Apply the rules:\n  - If $I \\ge 3$ and $y_5 - y_1  \\epsilon$, set $S = 1$.\n  - Else if $D \\ge 3$ and $y_5 - y_1  -\\epsilon$, set $S = -1$.\n  - Otherwise, set $S = 0$.\n\nThis completes the theoretical and algorithmic framework required to solve the problem. The implementation will follow this logic precisely.",
            "answer": "[[0.200000,0.263620,0.231641,0.193237,0.161094,-1],[0.500000,0.282909,0.179782,0.125028,0.092797,-1],[0.050000,0.088680,0.117765,0.138769,0.153401,1],[0.200000,0.189574,0.187979,0.187760,0.187731,-1]]"
        }
    ]
}