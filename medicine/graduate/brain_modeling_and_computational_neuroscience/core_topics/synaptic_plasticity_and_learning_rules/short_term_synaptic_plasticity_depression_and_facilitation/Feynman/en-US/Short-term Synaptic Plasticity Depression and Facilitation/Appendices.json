{
    "hands_on_practices": [
        {
            "introduction": "The paired-pulse ratio (PPR) is a fundamental experimental measure used to characterize short-term synaptic plasticity. It captures the essence of facilitation ($PPR \\gt 1$) or depression ($PPR \\lt 1$) by comparing the response to two closely spaced stimuli. This first practice is a cornerstone exercise: by deriving the analytical expression for the PPR directly from the Tsodyks-Markram model's equations (), you will gain a foundational understanding of how the interplay between resource depletion ($x$) and use-dependent facilitation ($u$) shapes synaptic behavior. This derivation is essential for connecting the model's parameters to observable physiological phenomena.",
            "id": "4018478",
            "problem": "Consider a synapse described by the Tsodyks–Markram model of short-term plasticity, which captures both facilitation and depression. Let $u(t)$ denote the utilization of synaptic efficacy (facilitation variable) and let $x(t)$ denote the fraction of available synaptic resources (depression variable). Between presynaptic spikes, these variables evolve according to the ordinary differential equations\n$$\n\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}, \\qquad \\frac{d x}{d t} = \\frac{1 - x}{\\tau_{d}},\n$$\nwhere $\\tau_{f} > 0$ and $\\tau_{d} > 0$ are the facilitation and depression time constants, respectively. At each presynaptic spike time $t_{k}$, the variables undergo jump updates:\n$$\nu(t_{k}^{+}) = u(t_{k}^{-}) + U \\bigl(1 - u(t_{k}^{-})\\bigr), \\qquad x(t_{k}^{+}) = x(t_{k}^{-}) \\bigl(1 - u(t_{k}^{+})\\bigr),\n$$\nwhere $U \\in (0,1)$ is a parameter that quantifies the increment in utilization per spike, and $t_{k}^{-}$ and $t_{k}^{+}$ denote the limits immediately before and after the spike, respectively. Assume the synapse is at rest for a sufficiently long time before the first spike at time $t_{1}$, so that $u(t_{1}^{-}) = 0$ and $x(t_{1}^{-}) = 1$.\n\nLet two identical presynaptic spikes occur at times $t_{1}$ and $t_{2} = t_{1} + \\Delta$, where $\\Delta > 0$ is the inter-pulse interval (IPI). The postsynaptic response amplitude evoked by the $k$-th spike is proportional to $A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$, with $A > 0$ a constant scaling factor. Define the paired-pulse ratio (PPR) as the ratio of the second evoked peak amplitude to the first.\n\nStarting from the given dynamics and jump conditions, derive a closed-form analytic expression for the paired-pulse ratio in terms of $\\Delta$, $U$, $\\tau_{f}$, and $\\tau_{d}$. Express your final result as a symbolic expression; do not substitute numerical values. If you introduce auxiliary quantities, eliminate them so that the final expression depends only on $\\Delta$, $U$, $\\tau_{f}$, and $\\tau_{d}$.",
            "solution": "The problem is to derive a closed-form expression for the paired-pulse ratio (PPR) for a synapse described by the Tsodyks–Markram model. The problem statement is scientifically grounded, well-posed, and provides all necessary information. It is a standard exercise in computational neuroscience and is therefore valid.\n\nThe paired-pulse ratio, PPR, is defined as the ratio of the amplitude of the second postsynaptic response, $E_2$, to the amplitude of the first, $E_1$.\n$$\n\\text{PPR} = \\frac{E_2}{E_1}\n$$\nThe postsynaptic response amplitude evoked by the $k$-th spike is given as being proportional to $A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$. We can thus write the amplitudes as $E_k = c A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$ for some constant of proportionality $c$. As we are calculating a ratio, this constant will cancel. For simplicity, we will set $c=1$, so that $E_k = A\\,u(t_{k}^{+})\\,x(t_{k}^{-})$.\n\nOur derivation proceeds in four steps:\n1.  Calculate the state of the synapse and the response amplitude for the first spike at $t_1$.\n2.  Evolve the synaptic variables $u(t)$ and $x(t)$ during the inter-pulse interval $\\Delta$.\n3.  Calculate the state of the synapse and the response amplitude for the second spike at $t_2$.\n4.  Compute the ratio of the amplitudes.\n\nStep 1: Analysis of the first spike at $t_1$.\nThe synapse is at rest before the first spike, so the initial conditions are given as $u(t_1^-) = 0$ and $x(t_1^-) = 1$.\n\nFirst, we find the value of the facilitation variable $u$ immediately after the spike, $u(t_1^+)$, using the jump condition:\n$$\nu(t_1^+) = u(t_1^-) + U \\bigl(1 - u(t_1^-)\\bigr)\n$$\nSubstituting $u(t_1^-) = 0$:\n$$\nu(t_1^+) = 0 + U(1-0) = U\n$$\nThe amplitude of the first postsynaptic response, $E_1$, is:\n$$\nE_1 = A u(t_1^+) x(t_1^-)\n$$\nSubstituting the values $u(t_1^+) = U$ and $x(t_1^-) = 1$:\n$$\nE_1 = A \\cdot U \\cdot 1 = AU\n$$\nNext, we find the value of the depression variable $x$ immediately after the spike, $x(t_1^+)$, using its jump condition:\n$$\nx(t_1^+) = x(t_1^-) \\bigl(1 - u(t_1^+)\\bigr)\n$$\nSubstituting $x(t_1^-) = 1$ and $u(t_1^+) = U$:\n$$\nx(t_1^+) = 1 \\cdot (1 - U) = 1-U\n$$\n\nStep 2: Evolution during the inter-pulse interval.\nBetween the first spike at $t_1$ and the second spike at $t_2 = t_1 + \\Delta$, the variables evolve according to the given differential equations. We need to find the values $u(t_2^-)$ and $x(t_2^-)$.\n\nThe evolution of $u(t)$ is governed by:\n$$\n\\frac{d u}{d t} = -\\frac{u}{\\tau_{f}}\n$$\nThis is a first-order linear ordinary differential equation. We solve it over the interval $[t_1, t_2]$ with the initial condition $u(t_1) = u(t_1^+) = U$. The solution is an exponential decay:\n$$\nu(t) = u(t_1^+) \\exp\\left(-\\frac{t-t_1}{\\tau_f}\\right)\n$$\nAt time $t_2$, just before the spike, we have $t-t_1 = \\Delta$:\n$$\nu(t_2^-) = U \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right)\n$$\n\nThe evolution of $x(t)$ is governed by:\n$$\n\\frac{d x}{d t} = \\frac{1 - x}{\\tau_{d}}\n$$\nThis is also a first-order linear ODE. We can rewrite it as $\\frac{dx}{1-x} = \\frac{dt}{\\tau_d}$. Integrating from $t_1$ to $t_2$ gives:\n$$\n\\int_{x(t_1^+)}^{x(t_2^-)} \\frac{dx}{1-x} = \\int_{t_1}^{t_2} \\frac{dt}{\\tau_d}\n$$\n$$\n\\bigl[-\\ln|1-x|\\bigr]_{x(t_1^+)}^{x(t_2^-)} = \\frac{t_2-t_1}{\\tau_d}\n$$\n$$\n-\\ln(1-x(t_2^-)) + \\ln(1-x(t_1^+)) = \\frac{\\Delta}{\\tau_d}\n$$\n$$\n\\ln\\left(\\frac{1-x(t_1^+)}{1-x(t_2^-)}\\right) = \\frac{\\Delta}{\\tau_d}\n$$\n$$\n1-x(t_2^-) = (1-x(t_1^+)) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n$$\nx(t_2^-) = 1 - (1-x(t_1^+)) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\nSubstituting the initial condition $x(t_1^+) = 1-U$:\n$$\nx(t_2^-) = 1 - \\bigl(1 - (1-U)\\bigr) \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) = 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right)\n$$\n\nStep 3: Analysis of the second spike at $t_2$.\nWe have the state of the synapse just before the second spike: $u(t_2^-) = U \\exp(-\\Delta/\\tau_f)$ and $x(t_2^-) = 1 - U \\exp(-\\Delta/\\tau_d)$.\n\nWe calculate $u(t_2^+)$ using the jump condition:\n$$\nu(t_2^+) = u(t_2^-) + U \\bigl(1 - u(t_2^-)\\bigr) = (1-U)u(t_2^-) + U\n$$\nSubstituting the expression for $u(t_2^-)$:\n$$\nu(t_2^+) = (1-U) \\left(U \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right)\\right) + U = U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right)\n$$\nThe amplitude of the second postsynaptic response, $E_2$, is:\n$$\nE_2 = A u(t_2^+) x(t_2^-)\n$$\nSubstituting the expressions for $u(t_2^+)$ and $x(t_2^-)$:\n$$\nE_2 = A \\left[ U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\right] \\left[ 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right]\n$$\n\nStep 4: Calculation of the Paired-Pulse Ratio.\nFinally, we compute the PPR by dividing $E_2$ by $E_1$:\n$$\n\\text{PPR} = \\frac{E_2}{E_1} = \\frac{A U \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)}{AU}\n$$\nThe term $AU$ cancels, yielding the final expression for the PPR:\n$$\n\\text{PPR} = \\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)\n$$\nThis expression depends only on the parameters $\\Delta$, $U$, $\\tau_f$, and $\\tau_d$, as required by the problem statement. The first term captures the effect of facilitation, while the second term captures the effect of depression.",
            "answer": "$$\n\\boxed{\\left( 1 + (1-U) \\exp\\left(-\\frac{\\Delta}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta}{\\tau_d}\\right) \\right)}\n$$"
        },
        {
            "introduction": "While paired-pulse protocols are informative, neural communication often involves sustained trains of action potentials. This practice moves beyond the two-spike scenario to explore the dynamic evolution of synaptic strength during a continuous spike train, which often cannot be captured by a simple closed-form solution. By implementing the model's rules in a step-by-step simulation (), you will observe the rich, history-dependent behavior of the synapse and learn to identify whether facilitation or depression dominates under different physiological conditions. This exercise builds practical computational skills essential for simulating more complex and realistic neural dynamics.",
            "id": "2751339",
            "problem": "You are given a mechanistic model of short-term synaptic plasticity that captures facilitation and depression as interacting dynamical processes. Consider a single synapse governed by a resource-based model in which two state variables evolve in time: the instantaneous release probability $u(t)$ and the fraction of resources available $x(t)$. Between presynaptic spikes separated by an interspike interval $\\Delta t$, these variables obey first-order linear ordinary differential equations driven by intrinsic relaxation:\n1. $u(t)$ relaxes toward $0$ according to $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$, where $\\tau_f$ is the facilitation time constant.\n2. $x(t)$ recovers toward $1$ according to $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$, where $\\tau_d$ is the depression recovery time constant.\n\nAt each presynaptic spike arrival time $t_k$, the variables are instantaneously updated by synaptic release and facilitation:\n1. The release probability jumps as $u \\leftarrow u + U \\left(1 - u\\right)$, where $U$ is the baseline utilization parameter.\n2. The available resources are depleted in proportion to the updated release probability, $x \\leftarrow x \\left(1 - u\\right)$.\n\nAssume an initial quiescent state with $u(0^{-}) = 0$ and $x(0^{-}) = 1$, and a periodic spike train of frequency $f$ so that $\\Delta t = 1/f$. Define the normalized postsynaptic response at the $k$-th spike as $y_k = u_k x_k$, where $u_k$ denotes the value of $u$ immediately after its jump at the $k$-th spike and $x_k$ denotes the value of $x$ immediately before the depletion at the $k$-th spike. All responses $y_k$ are dimensionless.\n\nTask:\n1. Starting from the stated differential equations and jump rules, derive discrete-time update relations that enable computation of $y_k$ for successive spikes using only the parameters $\\Delta t$, $U$, $\\tau_f$, and $\\tau_d$ and the previous spike’s state.\n2. Implement these updates to compute the first five responses $(y_1, y_2, y_3, y_4, y_5)$ for each parameter set in the test suite below. Use $\\tau_f$ and $\\tau_d$ in milliseconds and convert to seconds internally. Use $f$ in Hertz so that $\\Delta t$ is in seconds.\n3. Determine whether facilitation or depression dominates over the first five responses according to the following rule. Let $\\epsilon = 10^{-9}$. For $k = 2,3,4,5$, count an increase if $y_k - y_{k-1} > \\epsilon$ and a decrease if $y_k - y_{k-1} < -\\epsilon$. Let $I$ be the number of increases and $D$ the number of decreases. Define the dominance integer $S$ by:\n   - $S = 1$ (facilitation-dominant) if $I \\ge 3$ and $y_5 - y_1 > \\epsilon$,\n   - $S = -1$ (depression-dominant) if $D \\ge 3$ and $y_5 - y_1 < -\\epsilon$,\n   - $S = 0$ (mixed or ambiguous) otherwise.\n\nNumerical output requirements:\n- Express the five responses as floating-point numbers rounded to six decimal places.\n- For each parameter set, output a list containing six entries: the five rounded responses followed by the integer $S$.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these lists enclosed in square brackets, for example: [[y11,y12,y13,y14,y15,S1],[y21,y22,y23,y24,y25,S2],...].\n\nTest suite:\nProvide results for the following four parameter sets. In all cases, compute the first five responses. When a train duration is mentioned, it is only to contextualize the frequency; you should assume the periodic train is sustained as needed to obtain five spikes.\n1. Baseline interaction at moderate frequency: $f = 20\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$.\n2. Strong initial utilization with faster facilitation decay and moderate recovery: $f = 20\\ \\text{Hz}$, $U = 0.5$, $\\tau_f = 50\\ \\text{ms}$, $\\tau_d = 400\\ \\text{ms}$.\n3. Low initial utilization with long facilitation and fast recovery: $f = 20\\ \\text{Hz}$, $U = 0.05$, $\\tau_f = 1000\\ \\text{ms}$, $\\tau_d = 200\\ \\text{ms}$.\n4. Low frequency boundary case: $f = 1\\ \\text{Hz}$, $U = 0.2$, $\\tau_f = 200\\ \\text{ms}$, $\\tau_d = 800\\ \\text{ms}$.\n\nFinal output format:\n- A single line containing a JSON-like list of four lists, one per test case, where each inner list is [y1,y2,y3,y4,y5,S] using the rounding and integer rules above.",
            "solution": "The problem is subjected to validation.\n\n**1. Extraction of Givens**\n- State variables: instantaneous release probability $u(t)$, fraction of available resources $x(t)$.\n- Dynamics between spikes (interspike interval $\\Delta t$):\n    - $\\dfrac{du}{dt} = -\\dfrac{u}{\\tau_f}$\n    - $\\dfrac{dx}{dt} = \\dfrac{1 - x}{\\tau_d}$\n- Dynamics at spike time $t_k$:\n    - $u \\leftarrow u + U \\left(1 - u\\right)$\n    - $x \\leftarrow x \\left(1 - u\\right)$ (with the updated $u$)\n- Initial state: $u(0^{-}) = 0$, $x(0^{-}) = 1$.\n- Stimulus: Periodic spike train with frequency $f$, so $\\Delta t = 1/f$.\n- Output variable: Normalized postsynaptic response $y_k = u_k x_k$, where $u_k$ is the value of $u$ immediately after its jump at spike $k$, and $x_k$ is the value of $x$ immediately before depletion at spike $k$.\n- Task: Derive discrete-time updates, implement them to compute the first five responses ($y_1$ to $y_5$), and classify the dynamics using a dominance integer $S$.\n- Dominance rule: $\\epsilon = 10^{-9}$. $I$ is count of increases ($y_k - y_{k-1} > \\epsilon$), $D$ is count of decreases ($y_k - y_{k-1} < -\\epsilon$) for $k \\in \\{2,3,4,5\\}$. $S=1$ if $I \\ge 3$ and $y_5 - y_1 > \\epsilon$; $S=-1$ if $D \\ge 3$ and $y_5 - y_1 < -\\epsilon$; $S=0$ otherwise.\n- Test cases: Four parameter sets involving $f$, $U$, $\\tau_f$, $\\tau_d$ are provided.\n\n**2. Validation Verdict**\nThe problem is **valid**. It describes a well-established, scientifically grounded model of short-term synaptic plasticity (the Tsodyks-Markram model). The problem is mathematically well-posed, providing all necessary differential equations, update rules, initial conditions, and parameters. The objectives are stated clearly and are computationally tractable. There are no contradictions, ambiguities, or factual errors.\n\n**3. Derivation and Solution Methodology**\n\nThe task is to compute the sequence of postsynaptic responses $y_k$ generated by a periodic presynaptic spike train. This requires deriving discrete-time recurrence relations from the given continuous-time dynamics and instantaneous spike-time updates.\n\nLet us define the state of the synapse immediately before the $k$-th spike as $(u_{k}^{\\text{pre}}, x_{k}^{\\text{pre}})$. Let the state immediately after the update and depletion at spike $k$ be $(u_k, x_{k}^{\\text{post}})$, where $u_k$ is the post-facilitation release probability.\n\n**Step 1: Evolution between spikes**\nBetween spike $k-1$ and spike $k$, the system evolves for a duration $\\Delta t = 1/f$. The governing ordinary differential equations are linear and first-order.\nThe equation for $u(t)$ is $\\dfrac{du}{dt} = -u/\\tau_f$. With initial condition $u(t_{k-1}) = u_{k-1}$, its solution is $u(t) = u_{k-1} e^{-(t - t_{k-1})/\\tau_f}$. Thus, the value of $u$ just before spike $k$ is:\n$$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n\nThe equation for $x(t)$ is $\\dfrac{dx}{dt} = (1 - x)/\\tau_d$. Let's define a variable $z(t) = 1 - x(t)$, so $\\dfrac{dz}{dt} = -\\dfrac{z}{\\tau_d}$. With initial condition $x(t_{k-1}) = x_{k-1}^{\\text{post}}$, we have $z(t_{k-1}) = 1 - x_{k-1}^{\\text{post}}$. The solution for $z(t)$ is $z(t) = z(t_{k-1}) e^{-(t - t_{k-1})/\\tau_d}$. Substituting back for $x(t)$, we get $1-x(t) = (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$, which means $x(t) = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-(t - t_{k-1})/\\tau_d}$. The value of $x$ just before spike $k$ is:\n$$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n\n**Step 2: Updates at a spike**\nAt the arrival of spike $k$, the variables are updated instantaneously.\nFirst, the release probability $u$ is facilitated. The problem defines $u_k$ as the value after the jump:\n$$u_k = u_{k}^{\\text{pre}} + U (1 - u_{k}^{\\text{pre}})$$\nThe problem defines $x_k$ as the value of the resource *before* depletion, which is precisely $x_{k}^{\\text{pre}}$. Therefore:\n$$x_k = x_{k}^{\\text{pre}}$$\nThe normalized postsynaptic response $y_k$ is then calculated as:\n$$y_k = u_k x_k = u_k x_{k}^{\\text{pre}}$$\nFinally, the available resources $x$ are depleted using the newly updated release probability $u_k$. The state of $x$ after depletion is:\n$$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**Step 3: Recurrence Relations and Algorithm**\nWe can now combine these steps to form a complete set of recurrence relations. The state of the system can be tracked by the variables $(u_k, x_{k}^{\\text{post}})$.\nThe update from step $k-1$ to $k$ proceeds as follows:\n1. Evolve between spikes to find the pre-spike state for spike $k$:\n   $$u_{k}^{\\text{pre}} = u_{k-1} e^{-\\Delta t / \\tau_f}$$\n   $$x_{k}^{\\text{pre}} = 1 - (1 - x_{k-1}^{\\text{post}}) e^{-\\Delta t / \\tau_d}$$\n2. Update at spike $k$ and calculate the response:\n   $$u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$$\n   $$y_k = u_k x_{k}^{\\text{pre}}$$\n3. Calculate the post-depletion resource state for the next interval:\n   $$x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$$\n\n**Initial Conditions:**\nThe system starts from a quiescent state, $u(0^-)=0$ and $x(0^-)=1$. This corresponds to the state after a hypothetical spike at $t=-\\infty$. Thus, for the first spike ($k=1$), we can set the \"previous\" state values as $u_0 = 0$ and $x_0^{\\text{post}} = 1$.\nThe simulation proceeds as follows:\nInitialize with $u_{\\text{prev}} = 0$ and $x_{\\text{post_prev}} = 1$.\nFor $k = 1, 2, 3, 4, 5$:\n- Compute $u_{k}^{\\text{pre}} = u_{\\text{prev}} \\exp(-\\Delta t / \\tau_f)$.\n- Compute $x_{k}^{\\text{pre}} = 1 - (1 - x_{\\text{post_prev}}) \\exp(-\\Delta t / \\tau_d)$.\n- Compute $u_k = u_{k}^{\\text{pre}} + U(1 - u_{k}^{\\text{pre}})$.\n- Compute $y_k = u_k x_{k}^{\\text{pre}}$.\n- Compute $x_{k}^{\\text{post}} = x_{k}^{\\text{pre}} (1 - u_k)$.\n- Update for the next iteration: $u_{\\text{prev}} = u_k$ and $x_{\\text{post_prev}} = x_{k}^{\\text{post}}$.\n- Store $y_k$.\n\nThe time constants $\\tau_f$ and $\\tau_d$ are provided in milliseconds (ms) and must be converted to seconds by dividing by $1000$ to be dimensionally consistent with $\\Delta t = 1/f$, where $f$ is in Hz.\n\n**Step 4: Dominance Classification**\nAfter computing the sequence $(y_1, y_2, y_3, y_4, y_5)$, the dominance integer $S$ is determined. Let $\\epsilon = 10^{-9}$.\n- Initialize counters for increases $I=0$ and decreases $D=0$.\n- For $k$ from $2$ to $5$, compare $y_k$ and $y_{k-1}$:\n  - If $y_k - y_{k-1} > \\epsilon$, increment $I$.\n  - If $y_k - y_{k-1} < -\\epsilon$, increment $D$.\n- Apply the rules:\n  - If $I \\ge 3$ and $y_5 - y_1 > \\epsilon$, set $S = 1$.\n  - Else if $D \\ge 3$ and $y_5 - y_1 < -\\epsilon$, set $S = -1$.\n  - Otherwise, set $S = 0$.\n\nThis completes the theoretical and algorithmic framework required to solve the problem. The implementation will follow this logic precisely.",
            "answer": "```\n[[0.2,0.198399,0.192534,0.187313,0.182963,-1],[0.5,0.330829,0.24584,0.201657,0.177303,-1],[0.05,0.088365,0.119421,0.144431,0.164392,1],[0.2,0.198425,0.196901,0.195426,0.193998,-1]]\n```"
        },
        {
            "introduction": "A key strength of computational models is their ability to generate testable predictions about how biological manipulations affect system behavior. This advanced practice leverages the analytical framework of the PPR to investigate the effects of neuromodulation, a ubiquitous mechanism for regulating neural circuits. You will derive how a change in the baseline utilization parameter $U$—a common target of neuromodulators—alters the PPR (). This exercise demonstrates how the model can be used not just to describe phenomena, but to build a predictive understanding of synaptic function and its regulation.",
            "id": "4018473",
            "problem": "Consider a synapse described by the Tsodyks–Markram model of short-term synaptic plasticity, which combines facilitation and depression. Let the utilization variable be denoted by $u(t)$ and the fraction of available resources be denoted by $x(t)$. Between presynaptic spikes, the dynamics are given by $\\frac{du}{dt} = -\\frac{u}{\\tau_{f}}$ and $\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{d}}$, where $\\tau_{f}$ and $\\tau_{d}$ are the facilitation and depression time constants, respectively. At a presynaptic spike occurring at time $t_{n}$, the variables update according to $u_{n} = u_{n^{-}} + U \\left(1 - u_{n^{-}}\\right)$ and $x_{n^{+}} = x_{n^{-}} \\left(1 - u_{n}\\right)$, where $U$ is the baseline utilization parameter that determines the increment in $u$ at each spike, $u_{n^{-}}$ and $x_{n^{-}}$ denote pre-spike values, and $u_{n}$ and $x_{n^{+}}$ denote post-spike values. The excitatory postsynaptic current (EPSC) amplitude for spike $n$ is proportional to $u_{n} x_{n^{-}}$. Assume the synapse is initially at rest, with $u_{0^{-}} = 0$ and $x_{0^{-}} = 1$, and consider a paired-pulse stimulation consisting of two spikes at times $t_{1} = 0$ and $t_{2} = \\Delta t$. Define the paired-pulse ratio (PPR) as $\\mathrm{PPR} = \\frac{A_{2}}{A_{1}}$, where $A_{1}$ and $A_{2}$ are the first and second EPSC amplitudes, respectively.\n\nA neuromodulator is applied that decreases the utilization parameter multiplicatively to $U' = sU$ with $0 < s < 1$, while leaving $\\tau_{f}$ and $\\tau_{d}$ unchanged. Starting solely from the dynamical rules given above and the definition of the paired-pulse ratio (PPR), derive the predicted change in paired-pulse ratio due to the neuromodulator, defined as $\\Delta \\mathrm{PPR} = \\mathrm{PPR}(U') - \\mathrm{PPR}(U)$. Express your final result as a single closed-form analytic expression in terms of $s$, $U$, $\\Delta t$, $\\tau_{f}$, and $\\tau_{d}$. No numerical evaluation is required.",
            "solution": "The problem asks for the change in the paired-pulse ratio, $\\Delta \\mathrm{PPR}$, when the baseline utilization parameter $U$ is multiplicatively decreased to $U' = sU$, where $0 < s < 1$. The change is defined as $\\Delta \\mathrm{PPR} = \\mathrm{PPR}(U') - \\mathrm{PPR}(U)$. To find this, we first need to derive a general expression for the paired-pulse ratio, $\\mathrm{PPR}(U)$, based on the provided dynamics of the Tsodyks-Markram model.\n\nThe calculation proceeds in several steps:\n1.  Determine the amplitude of the first excitatory postsynaptic current (EPSC), $A_1$, for a spike at time $t_1 = 0$.\n2.  Calculate the evolution of the synaptic variables $u(t)$ and $x(t)$ during the inter-spike interval $\\Delta t$.\n3.  Determine the amplitude of the second EPSC, $A_2$, for a spike at time $t_2 = \\Delta t$.\n4.  Calculate the paired-pulse ratio $\\mathrm{PPR}(U) = A_2 / A_1$.\n5.  Substitute $U$ with $U' = sU$ to find $\\mathrm{PPR}(U')$.\n6.  Compute the difference $\\Delta \\mathrm{PPR} = \\mathrm{PPR}(U') - \\mathrm{PPR}(U)$.\n\nLet $k$ be the proportionality constant relating the product $u_n x_{n^{-}}$ to the EPSC amplitude $A_n$, such that $A_n = k \\cdot u_n x_{n^{-}}$.\n\n**Step 1: First Spike ($n=1$ at $t_1 = 0$)**\nThe synapse is initially at rest, so the pre-spike values for the first spike are $u_{1^{-}} = 0$ and $x_{1^{-}} = 1$.\nThe utilization value for the first spike, $u_1$, is calculated using the update rule:\n$$u_1 = u_{1^{-}} + U(1 - u_{1^{-}}) = 0 + U(1 - 0) = U$$\nThe amplitude of the first EPSC, $A_1$, is then:\n$$A_1 = k \\cdot u_1 x_{1^{-}} = k \\cdot U \\cdot 1 = kU$$\nFollowing the first spike, the fraction of available resources $x$ is updated:\n$$x_{1^{+}} = x_{1^{-}}(1 - u_1) = 1(1 - U) = 1 - U$$\nThe value of the utilization variable immediately after the spike is $u(0^+) = u_1 = U$. So, at $t=0^+$, the state of the system is $u(0^+) = U$ and $x(0^+) = 1 - U$.\n\n**Step 2: Inter-spike Interval ($0 < t < \\Delta t$)**\nBetween spikes, the variables evolve according to the differential equations:\n$$\\frac{du}{dt} = -\\frac{u}{\\tau_{f}} \\quad \\text{and} \\quad \\frac{dx}{dt} = \\frac{1 - x}{\\tau_{d}}$$\nSolving these linear first-order ordinary differential equations with initial conditions $u(0^+) = U$ and $x(0^+) = 1 - U$:\nFor $u(t)$:\n$$u(t) = u(0^+) \\exp\\left(-\\frac{t}{\\tau_f}\\right) = U \\exp\\left(-\\frac{t}{\\tau_f}\\right)$$\nFor $x(t)$: The solution is of the form $x(t) = 1 - C\\exp(-t/\\tau_d)$. Using the initial condition $x(0^+) = 1-U$:\n$$1 - U = 1 - C\\exp(0) \\implies C = U$$\nSo, the evolution of $x(t)$ is:\n$$x(t) = 1 - U \\exp\\left(-\\frac{t}{\\tau_d}\\right)$$\nAt the time of the second spike, $t_2 = \\Delta t$, the pre-spike values are:\n$$u_{2^{-}} = u(\\Delta t) = U \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right)$$\n$$x_{2^{-}} = x(\\Delta t) = 1 - U \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right)$$\n\n**Step 3: Second Spike ($n=2$ at $t_2 = \\Delta t$)**\nThe utilization value for the second spike, $u_2$, is:\n$$u_2 = u_{2^{-}} + U(1 - u_{2^{-}}) = U \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) + U\\left(1 - U \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right)\\right)$$\n$$u_2 = U \\left( \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) + 1 - U \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) \\right) = U \\left( 1 + (1 - U)\\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) \\right)$$\nThe amplitude of the second EPSC, $A_2$, is:\n$$A_2 = k \\cdot u_2 x_{2^{-}} = k \\cdot U \\left( 1 + (1 - U)\\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) \\right)$$\n\n**Step 4: Paired-Pulse Ratio $\\mathrm{PPR}(U)$**\nThe PPR is the ratio of the amplitudes. The constant $k$ and the leading factor of $U$ from $A_2$ cancel with $A_1$:\n$$\\mathrm{PPR}(U) = \\frac{A_2}{A_1} = \\frac{k \\cdot U \\left( 1 + (1 - U)\\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) \\right)}{kU}$$\n$$\\mathrm{PPR}(U) = \\left( 1 + (1 - U)\\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) \\right) \\left( 1 - U \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) \\right)$$\n\n**Step 5: Paired-Pulse Ratio with Neuromodulator, $\\mathrm{PPR}(U')$**\nThe neuromodulator changes the utilization parameter from $U$ to $U' = sU$. The time constants $\\tau_f$ and $\\tau_d$ remain unchanged. We find $\\mathrm{PPR}(U')$ by substituting $sU$ for $U$ in the expression for $\\mathrm{PPR}(U)$:\n$$\\mathrm{PPR}(U') = \\left( 1 + (1 - sU)\\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) \\right) \\left( 1 - sU \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) \\right)$$\n\n**Step 6: Change in Paired-Pulse Ratio, $\\Delta \\mathrm{PPR}$**\nWe now compute the difference $\\Delta \\mathrm{PPR} = \\mathrm{PPR}(U') - \\mathrm{PPR}(U)$. For convenience, let $E_f = \\exp(-\\Delta t/\\tau_f)$ and $E_d = \\exp(-\\Delta t/\\tau_d)$.\nThe expressions become:\n$$\\mathrm{PPR}(U) = (1 + (1-U)E_f)(1-UE_d) = (1+E_f-UE_f)(1-UE_d)$$\n$$\\mathrm{PPR}(U') = (1 + (1-sU)E_f)(1-sUE_d) = (1+E_f-sUE_f)(1-sUE_d)$$\nExpanding both expressions:\n$$\\mathrm{PPR}(U) = 1 - UE_d + E_f - UE_fE_d - UE_f + U^2E_fE_d = 1 + E_f - U(E_d+E_f+E_fE_d) + U^2E_fE_d$$\n$$\\mathrm{PPR}(U') = 1 - sUE_d + E_f - sUE_fE_d - sUE_f + s^2U^2E_fE_d = 1 + E_f - sU(E_d+E_f+E_fE_d) + s^2U^2E_fE_d$$\nNow, we take the difference:\n$$\\Delta \\mathrm{PPR} = \\mathrm{PPR}(U') - \\mathrm{PPR}(U)$$\n$$= \\left[ 1 + E_f - sU(E_d+E_f+E_fE_d) + s^2U^2E_fE_d \\right] - \\left[ 1 + E_f - U(E_d+E_f+E_fE_d) + U^2E_fE_d \\right]$$\nThe terms $1+E_f$ cancel out. Grouping the remaining terms by factors of $U$ and $U^2$:\n$$\\Delta \\mathrm{PPR} = \\left( -sU(E_d+E_f+E_fE_d) + U(E_d+E_f+E_fE_d) \\right) + \\left( s^2U^2E_fE_d - U^2E_fE_d \\right)$$\n$$\\Delta \\mathrm{PPR} = U(1-s)(E_d+E_f+E_fE_d) + U^2(s^2-1)E_fE_d$$\nUsing the identity $s^2-1 = -(1-s^2) = -(1-s)(1+s)$:\n$$\\Delta \\mathrm{PPR} = U(1-s)(E_d+E_f+E_fE_d) - U^2(1-s)(1+s)E_fE_d$$\nFactoring out the common term $U(1-s)$:\n$$\\Delta \\mathrm{PPR} = U(1-s) \\left[ (E_d+E_f+E_fE_d) - U(1+s)E_fE_d \\right]$$\nFinally, we substitute back the exponential forms for $E_f$ and $E_d$:\n$$E_d+E_f+E_fE_d = \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) + \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) + \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right)\\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right)$$\n$$E_fE_d = \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right)\\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) = \\exp\\left(-\\Delta t\\left(\\frac{1}{\\tau_f}+\\frac{1}{\\tau_d}\\right)\\right)$$\nThis gives the final closed-form expression:\n$$\\Delta \\mathrm{PPR} = U(1-s) \\left[ \\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) + \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) + \\left(1 - U(1+s)\\right)\\exp\\left(-\\Delta t\\left(\\frac{1}{\\tau_f}+\\frac{1}{\\tau_d}\\right)\\right) \\right]$$",
            "answer": "$$\n\\boxed{U(1-s)\\left[\\exp\\left(-\\frac{\\Delta t}{\\tau_d}\\right) + \\exp\\left(-\\frac{\\Delta t}{\\tau_f}\\right) + \\left(1-U(1+s)\\right)\\exp\\left(-\\Delta t\\left(\\frac{1}{\\tau_f} + \\frac{1}{\\tau_d}\\right)\\right)\\right]}\n$$"
        }
    ]
}