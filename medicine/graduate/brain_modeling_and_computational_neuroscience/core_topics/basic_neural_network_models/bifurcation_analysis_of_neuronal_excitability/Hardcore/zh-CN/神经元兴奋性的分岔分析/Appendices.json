{
    "hands_on_practices": [
        {
            "introduction": "理论分析的第一步是掌握其数学基础。本练习将引导您通过分析一个简化的神经元模型，来理解I类兴奋性的核心机制。您将通过计算鞍结分岔（saddle-node bifurcation）发生的临界条件，来精确确定神经元发放活动的起点，这有助于您掌握相平面分析中零斜线和不动点的基本技巧。",
            "id": "3965535",
            "problem": "一个基于电导的平面简化模型由以下系统给出，该模型包含一个类膜电位快变量和一个恢复慢变量：\n$$\n\\frac{dv}{dt} = v \\left( \\alpha - v^{2} \\right) - w + I, \\qquad \\frac{dw}{dt} = \\varepsilon \\left( v - \\beta w \\right),\n$$\n其中 $\\alpha  0$，$\\beta  0$，$0  \\varepsilon \\ll 1$，且 $I \\in \\mathbb{R}$ 是一个恒定的外施电流。不动点的定义是方程组右侧同时为零的点。零斜线的定义是 $\\frac{dv}{dt} = 0$ 或 $\\frac{dw}{dt} = 0$ 的点集。当两个不动点合并并且合并点处的雅可比矩阵有一个零特征值时，平面上会发生鞍节点分岔。对于足够小的 $\\varepsilon$，这类平面简化模型中重复性发放的起始可以由不变圆上的鞍节点（Saddle-Node on Invariant Circle, SNIC）分岔来组织，这种情况发生于鞍节点位于一个周期轨道上时。\n\n仅使用不动点、零斜线的核心定义，以及平面上鞍节点分岔的局域特征（在合并点处零斜线相切且雅可比矩阵有一个零特征值），确定右膝（v为正）鞍节点发生时的临界输入电流 $I_{\\mathrm{SN}}(\\alpha,\\beta)$ 的精确值，该值需纯粹用 $\\alpha$ 和 $\\beta$ 表示。你的最终答案必须是一个没有单位的闭式解析表达式。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤1：提取已知条件**\n-   微分方程组：\n    $$\n    \\frac{dv}{dt} = v \\left( \\alpha - v^{2} \\right) - w + I, \\qquad \\frac{dw}{dt} = \\varepsilon \\left( v - \\beta w \\right)\n    $$\n-   参数约束：$\\alpha > 0$，$\\beta > 0$，$0  \\varepsilon \\ll 1$。\n-   变量：$I \\in \\mathbb{R}$ 是一个恒定的外施电流。\n-   定义：\n    -   不动点是方程组右侧同时为零的点。\n    -   零斜线是 $\\frac{dv}{dt} = 0$ 或 $\\frac{dw}{dt} = 0$ 的点集。\n    -   当两个不动点合并并且合并点处的雅可比矩阵有一个零特征值时，发生鞍节点分岔。\n-   目标：确定右膝（v为正）鞍节点分岔的临界输入电流 $I_{\\mathrm{SN}}(\\alpha,\\beta)$，纯粹用 $\\alpha$ 和 $\\beta$ 表示。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础**：该问题描述了一个 FitzHugh-Nagumo 型系统，这是计算神经科学中用于解释神经元兴奋性的一个经典模型。零斜线、不动点和分岔（特别是鞍节点分岔）的概念是动力系统理论中用于分析此类模型的基本标准工具。该问题在科学和数学上是合理的。\n-   **适定性**：系统定义清晰，分岔条件明确。术语“右膝”明确指定了要分析两种可能的鞍节点分岔中的哪一种。问题的构造使得临界电流 $I_{\\mathrm{SN}}$ 有唯一的解析解。\n-   **客观性**：问题以精确、形式化的数学语言陈述，没有任何主观或模糊的术语。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它具有科学基础、适定且客观。它不包含任何科学谬误、矛盾或含糊之处。现在将提供完整的解答。\n\n**解题推导**\n\n常微分方程组为：\n$$ \\frac{dv}{dt} = f(v, w) = \\alpha v - v^{3} - w + I $$\n$$ \\frac{dw}{dt} = g(v, w) = \\varepsilon (v - \\beta w) $$\n系统的不动点 $(v, w)$ 由条件 $\\frac{dv}{dt} = 0$ 和 $\\frac{dw}{dt} = 0$ 定义。这些条件定义了系统的零斜线。\n\n$v$-零斜线是 $\\frac{dv}{dt} = 0$ 的点集：\n$$ w = \\alpha v - v^{3} + I $$\n这是 $(v, w)$ 平面中的一条三次曲线。\n\n$w$-零斜线是 $\\frac{dw}{dt} = 0$ 的点集。由于 $\\varepsilon > 0$，这可以简化为：\n$$ v - \\beta w = 0 \\implies w = \\frac{v}{\\beta} $$\n这是一条通过原点且斜率为正值 $\\frac{1}{\\beta}$ 的直线。\n\n不动点是这两条零斜线的交点。将 $w$-零斜线中的 $w$ 表达式代入 $v$-零斜线方程，得到一个关于不动点 $v$ 坐标的方程：\n$$ \\frac{v}{\\beta} = \\alpha v - v^{3} + I $$\n整理这个方程，得到一个关于 $v$ 的三次多项式：\n$$ v^{3} + \\left(\\frac{1}{\\beta} - \\alpha\\right)v - I = 0 $$\n当两个不动点合并然后消失时，发生鞍节点分岔。在几何上，这对应于 $v$-零斜线和 $w$-零斜线彼此相切的点。在相切点，它们相对于 $v$ 的斜率必须相等。\n\n$v$-零斜线的斜率通过对 $w$ 关于 $v$ 求导得到：\n$$ \\frac{dw}{dv} = \\frac{d}{dv} \\left(\\alpha v - v^{3} + I\\right) = \\alpha - 3v^{2} $$\n$w$-零斜线的斜率为：\n$$ \\frac{dw}{dv} = \\frac{d}{dv} \\left(\\frac{v}{\\beta}\\right) = \\frac{1}{\\beta} $$\n令两个斜率相等，得到鞍节点分岔点的 $v$ 坐标，我们记为 $v_{\\mathrm{SN}}$：\n$$ \\alpha - 3v_{\\mathrm{SN}}^{2} = \\frac{1}{\\beta} \\implies 3v_{\\mathrm{SN}}^{2} = \\alpha - \\frac{1}{\\beta} = \\frac{\\alpha \\beta - 1}{\\beta} $$\n$$ v_{\\mathrm{SN}}^{2} = \\frac{\\alpha \\beta - 1}{3\\beta} $$\n问题要求的是“右膝”鞍节点分岔，按惯例，这对应于三次零斜线在正 $v$ 值处的局部极值点。因此，我们取正根：\n$$ v_{\\mathrm{SN}} = \\sqrt{\\frac{\\alpha \\beta - 1}{3\\beta}} $$\n为使 $v_{\\mathrm{SN}}$ 为实数，我们需要 $\\alpha \\beta \\ge 1$。\n\n这个结果可以通过分析系统的雅可比矩阵来验证。在不动点 $(v, w)$ 处的雅可比矩阵 $J$ 是：\n$$ J(v, w) = \\begin{pmatrix} \\frac{\\partial f}{\\partial v}  \\frac{\\partial f}{\\partial w} \\\\ \\frac{\\partial g}{\\partial v}  \\frac{\\partial g}{\\partial w} \\end{pmatrix} = \\begin{pmatrix} \\alpha - 3v^{2}  -1 \\\\ \\varepsilon  -\\varepsilon\\beta \\end{pmatrix} $$\n鞍节点分岔的特征是雅可比矩阵的一个特征值为零。这当且仅当雅可比矩阵的行列式为零时发生。\n$$ \\det(J) = (\\alpha - 3v^{2})(-\\varepsilon\\beta) - (-1)(\\varepsilon) = -\\varepsilon\\beta(\\alpha - 3v^{2}) + \\varepsilon = \\varepsilon(1 - \\beta(\\alpha - 3v^{2})) $$\n设 $\\det(J) = 0$，且因为 $\\varepsilon \\ne 0$：\n$$ 1 - \\beta(\\alpha - 3v^{2}) = 0 \\implies \\alpha - 3v^{2} = \\frac{1}{\\beta} $$\n这与从零斜线相切导出的条件相同，从而证实了 $v_{\\mathrm{SN}}$ 的值。\n\n现在，我们确定发生此分岔时的临界电流 $I_{\\mathrm{SN}}$。分岔点 $(v_{\\mathrm{SN}}, w_{\\mathrm{SN}})$ 是一个不动点，因此它必须同时位于两条零斜线上。我们使用不动点方程：\n$$ I = \\frac{v}{\\beta} - \\alpha v + v^{3} $$\n将 $v = v_{\\mathrm{SN}}$ 代入，得到临界电流 $I_{\\mathrm{SN}}$：\n$$ I_{\\mathrm{SN}} = v_{\\mathrm{SN}} \\left( \\frac{1}{\\beta} - \\alpha + v_{\\mathrm{SN}}^{2} \\right) $$\n我们已经求得 $v_{\\mathrm{SN}}^{2} = \\frac{\\alpha \\beta - 1}{3\\beta}$。将其代入 $I_{\\mathrm{SN}}$ 的表达式中：\n$$ I_{\\mathrm{SN}} = v_{\\mathrm{SN}} \\left( \\frac{1}{\\beta} - \\alpha + \\frac{\\alpha \\beta - 1}{3\\beta} \\right) $$\n我们来简化括号中的项：\n$$ \\frac{1}{\\beta} - \\alpha + \\frac{\\alpha \\beta - 1}{3\\beta} = \\frac{3 - 3\\alpha\\beta + \\alpha\\beta - 1}{3\\beta} = \\frac{2 - 2\\alpha\\beta}{3\\beta} = -\\frac{2(\\alpha\\beta - 1)}{3\\beta} $$\n现在，将此结果以及 $v_{\\mathrm{SN}}$ 的表达式代回 $I_{\\mathrm{SN}}$ 的方程中：\n$$ I_{\\mathrm{SN}} = \\left( \\sqrt{\\frac{\\alpha \\beta - 1}{3\\beta}} \\right) \\left( -\\frac{2(\\alpha\\beta - 1)}{3\\beta} \\right) $$\n这个表达式可以通过合并项来简化：\n$$ I_{\\mathrm{SN}} = -2 \\left( \\frac{\\alpha \\beta - 1}{3\\beta} \\right)^{\\frac{1}{2}} \\left( \\frac{\\alpha \\beta - 1}{3\\beta} \\right)^{1} $$\n$$ I_{\\mathrm{SN}} = -2 \\left( \\frac{\\alpha \\beta - 1}{3\\beta} \\right)^{\\frac{3}{2}} $$\n这是右膝鞍节点分岔点处临界电流 $I_{\\mathrm{SN}}$ 的最终解析表达式，纯粹用参数 $\\alpha$ 和 $\\beta$ 表示。",
            "answer": "$$ \\boxed{-2 \\left( \\frac{\\alpha \\beta - 1}{3 \\beta} \\right)^{\\frac{3}{2}}} $$"
        },
        {
            "introduction": "在理解了I类兴奋性之后，我们来探讨与之相对的II类兴奋性。本练习旨在阐明这两种兴奋性类型在发放起始频率上的根本区别，并将这一区别与霍普夫分岔（Hopf bifurcation）的数学特性联系起来。通过从雅可比矩阵的本征值直接计算最小发放频率，您将学习如何将系统的线性稳定性分析与可测量的神经元动力学行为联系起来。",
            "id": "4994560",
            "problem": "一个接近其动作电位起始阈值的神经元，经过适当简化后，可以用一个二维动力学系统来描述，该系统包含一个快速的膜电压变量和一个较慢的恢复变量。在不动点附近，小的扰动遵循一个形如 $\\dot{\\mathbf{x}} = J \\mathbf{x}$ 的线性系统，其中 $J$ 是在不动点处计算的雅可比矩阵，而 $\\mathbf{x}$ 集合了变量与平衡态的偏差。在这个框架下，兴奋性类别由阈值处的动力学机制决定，该机制将一个稳定的不动点转变为重复性放电。\n\n使用线性稳定性分析和分岔概念，解释I类兴奋性与II类兴奋性在放电阈值处的起始频率方面有何不同。然后，考虑一个其阈值对应于霍普夫分岔（II类）的神经元。在阈值电流 $I_{\\mathrm{thr}}$ 处，线性化得到雅可比矩阵\n$$\nJ_{\\mathrm{thr}} = \\begin{pmatrix}\n0  -1000 \\\\\n25  0\n\\end{pmatrix} \\quad \\text{矩阵元素单位为 } \\mathrm{s}^{-1}。\n$$\n根据第一性原理，确定这个II类神经元在阈值附近的最小放电频率 $f_{\\min}$（单位为 $\\mathrm{Hz}$），该频率由分岔点处的线性动力学预测。以 $\\mathrm{Hz}$ 为单位表示最终频率，并将答案四舍五入到三位有效数字。",
            "solution": "该问题要求解释I类和II类神经元兴奋性在起始放电频率方面的差异，然后计算一个特定的II类神经元的最小放电频率。\n\n神经元在其静息态附近的动力学通常可以简化为一个二维微分方程组：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x}, I)\n$$\n其中 $\\mathbf{x}$ 是一个状态向量，通常包含膜电位 $V$ 和一个较慢的恢复变量 $w$，而 $I$ 是一个代表注入刺激电流的参数。动作电位产生的阈值对应于一个分岔，在该分岔点，系统的稳定不动点（静息态）随着 $I$ 的增加而失去其稳定性。分岔的类型决定了神经元的兴奋性类别。\n\n线性稳定性分析涉及检查系统在不动点 $\\mathbf{x}_0$ 附近受到小扰动 $\\mathbf{x}$ 时的行为。该行为由线性化系统 $\\dot{\\mathbf{x}} = J \\mathbf{x}$ 控制，其中 $J$ 是 $\\mathbf{F}$ 在不动点处计算的雅可比矩阵，即 $J = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}} |_{\\mathbf{x}_0}$。不动点的稳定性由 $J$ 的特征值决定。\n\n**I类兴奋性**\nI类兴奋性的特征是鞍结不变圆（SNIC）分岔。对于低于阈值 $I_{\\mathrm{thr}}$ 的刺激电流 $I$，系统有两个不动点：一个稳定结点（静息态）和一个鞍点。当 $I$ 接近 $I_{\\mathrm{thr}}$ 时，这两个不动点相互靠近，稳定结点处雅可比矩阵的特征值（它们是实数且为负）发生变化。一个特征值趋近于零，而另一个保持为负。\n在阈值 $I = I_{\\mathrm{thr}}$ 处，稳定结点和鞍点合并并湮灭。在这个分岔点，雅可比矩阵有一个特征值恰好等于零（$\\lambda_1 = 0$）。对于 $I > I_{\\mathrm{thr}}$，相空间的该区域没有不动点，系统的轨迹沿着一个极限环演化，这对应于动作电位的重复放电。\n分岔点处零特征值的存在会产生一个已湮灭不动点的“幽灵”，这是一个动力学非常缓慢的区域。因此，对于刚刚超过阈值的电流，新形成的极限环的周期 $T$ 非常长。SNIC分岔理论表明，周期与 $(I - I_{\\mathrm{thr}})^{-1/2}$ 成正比，即 $T \\propto (I - I_{\\mathrm{thr}})^{-1/2}$。因此，放电频率 $f = 1/T$ 与 $\\sqrt{I - I_{\\mathrm{thr}}}$ 成正比，即 $f \\propto \\sqrt{I - I_{\\mathrm{thr}}}$。当电流从上方接近阈值时（$I \\to I_{\\mathrm{thr}}^+$），周期发散（$T \\to \\infty$），放电频率趋近于零（$f \\to 0$）。\n因此，I类神经元可以以任意低的频率放电，其频率-电流（f-I）曲线是连续的，从 $I=I_{\\mathrm{thr}}$ 处的 $f=0$ 开始。\n\n**II类兴奋性**\nII类兴奋性与Andronov-Hopf分岔相关。对于 $I  I_{\\mathrm{thr}}$，系统有一个唯一的稳定不动点，它是一个稳定焦点（或螺旋汇）。在这个不动点处，雅可比矩阵的特征值是一对具有负实部的复共轭对，$\\lambda = \\alpha(I) \\pm i\\omega(I)$，其中 $\\alpha(I)  0$。虚部 $\\omega(I)$ 导致轨迹螺旋式地进入不动点。\n随着 $I$ 增加并趋向 $I_{\\mathrm{thr}}$，特征值的实部趋近于零，即 $\\alpha(I) \\to 0^-$。在阈值 $I = I_{\\mathrm{thr}}$ 处，实部变为零，$\\alpha(I_{\\mathrm{thr}}) = 0$。特征值变为一对纯虚的复共轭对：$\\lambda = \\pm i\\omega_0$，其中 $\\omega_0 = \\omega(I_{\\mathrm{thr}}) \\neq 0$。\n在这个分岔点，不动点失去稳定性，并产生一个极限环。特征值的虚部 $\\omega_0$ 决定了放电起始时的振荡角频率。这意味着一旦神经元开始放电（对于刚刚超过 $I_{\\mathrm{thr}}$ 的 $I$），它就会以一个特定的、非零的频率进行。\n最小放电频率 $f_{\\min}$ 由这个内在角频率 $\\omega_0$ 通过关系式 $f_{\\min} = \\omega_0 / (2\\pi)$ 直接确定。与I类不同，放电不是从零频率开始的。相反，f-I曲线表现出从 $I  I_{\\mathrm{thr}}$ 时的 $f=0$ 到 $I = I_{\\mathrm{thr}}$ 时的 $f \\approx f_{\\min}$ 的跳跃。\n因此，II类神经元以一个特征性的、非零的频率开始放电。\n\n**最小放电频率的计算**\n给定了一个II类神经元在阈值电流 $I_{\\mathrm{thr}}$ 处的雅可比矩阵：\n$$\nJ_{\\mathrm{thr}} = \\begin{pmatrix}\n0  -1000 \\\\\n25  0\n\\end{pmatrix} \\quad \\text{矩阵元素单位为 } \\mathrm{s}^{-1}。\n$$\n问题指出这对应于一个霍普夫分岔。最小放电频率由该矩阵在分岔点处的特征值的虚部决定。特征值 $\\lambda$ 通过求解特征方程 $\\det(J_{\\mathrm{thr}} - \\lambda I) = 0$ 找到，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix}\n0 - \\lambda  -1000 \\\\\n25  0 - \\lambda\n\\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-\\lambda) - (-1000)(25) = 0\n$$\n$$\n\\lambda^2 + 25000 = 0\n$$\n求解 $\\lambda$：\n$$\n\\lambda^2 = -25000\n$$\n$$\n\\lambda = \\pm \\sqrt{-25000} = \\pm i \\sqrt{25000}\n$$\n特征值是纯虚数，$\\lambda = \\pm i\\omega_0$，这是霍普夫分岔的标志。放电起始时的振荡角频率是 $\\omega_0$。雅可比矩阵元素的单位是 $\\mathrm{s}^{-1}$，所以 $\\omega_0$ 的单位是 $\\mathrm{rad}\\cdot\\mathrm{s}^{-1}$。\n$$\n\\omega_0 = \\sqrt{25000} \\ \\mathrm{rad}\\cdot\\mathrm{s}^{-1}\n$$\n以赫兹（$\\mathrm{Hz}$）为单位的最小放电频率 $f_{\\min}$ 与角频率 $\\omega_0$ 通过公式 $f_{\\min} = \\omega_0 / (2\\pi)$ 相关联。\n$$\nf_{\\min} = \\frac{\\sqrt{25000}}{2\\pi} = \\frac{\\sqrt{2500 \\times 10}}{2\\pi} = \\frac{50\\sqrt{10}}{2\\pi} = \\frac{25\\sqrt{10}}{\\pi}\n$$\n现在，我们计算数值并四舍五入到三位有效数字。\n使用数值 $\\sqrt{10} \\approx 3.162277...$ 和 $\\pi \\approx 3.141592...$：\n$$\nf_{\\min} \\approx \\frac{25 \\times 3.162277}{3.141592} \\approx \\frac{79.056925}{3.141592} \\approx 25.1632 \\ \\mathrm{Hz}\n$$\n四舍五入到三位有效数字，我们得到：\n$$\nf_{\\min} \\approx 25.2 \\ \\mathrm{Hz}\n$$",
            "answer": "$$\\boxed{25.2}$$"
        },
        {
            "introduction": "最后，我们将理论知识应用于一个更接近生物现实的电导模型中，以此连接理论与实践。在这个综合性练习中，您将使用数值模拟——现代计算神经科学的核心工具——来探究内在适应性和突触输入如何调节神经元的兴奋性类型。您将通过编写程序来自动确定发放阈值、计算起始频率并对兴奋性进行分类，这模拟了真实的研究过程。",
            "id": "3965524",
            "problem": "您被要求实现一个完整的、可运行的程序，该程序在一个基于电导的神经元模型中，分析持续性突触输入和内在适应如何调节神经元兴奋性的分岔结构。该分析必须区分I型兴奋性（通常与不变圆上的鞍结（SNIC）或同宿分岔相关）和II型兴奋性（通常与超临界霍普夫分岔相关）。所有涉及时间的量必须以毫秒（ms）表示，所有电压以毫伏（mV）表示，所有电容密度以微法每平方厘米（$\\mu\\mathrm{F}/\\mathrm{cm}^2$）表示，所有电导密度以毫西门子每平方厘米（$\\mathrm{mS}/\\mathrm{cm}^2$）表示。电流必须以微安每平方厘米（$\\mu\\mathrm{A}/\\mathrm{cm}^2$）表示。此问题中不出现角度。\n\n使用的基本基础是基于电导的膜动力学和门控动力学公式。膜方程源自电荷守恒和欧姆定律，门控动力学通过S型稳态激活和电压依赖的时间尺度进行参数化。具体来说，该神经元通过一个二维Morris–Lecar系统建模，并增加了一个持续性突触电导，其中膜电位$V$和恢复变量$w$满足\n$$\nC \\frac{dV}{dt} = - g_{\\mathrm{Ca}} m_{\\infty}(V)\\,(V - V_{\\mathrm{Ca}}) - g_{\\mathrm{K}}\\, w\\, (V - V_{\\mathrm{K}}) - g_{\\mathrm{L}} (V - V_{\\mathrm{L}}) - g_{\\mathrm{syn}}\\, s\\, (V - E_{\\mathrm{syn}}) + I_{\\mathrm{app}},\n$$\n$$\n\\frac{dw}{dt} = \\phi\\, \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}.\n$$\n电压依赖的稳态激活函数和时间尺度由下式给出\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_1}{V_2}\\right)\\right), \\quad\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_3}{V_4}\\right)\\right), \\quad\n\\tau_w(V) = \\frac{1}{\\cosh\\!\\left(\\frac{V - V_3}{2 V_4}\\right)}.\n$$\n参数$\\phi$调节恢复变量$w$的时间尺度，因此代表内在适应速度。持续性突触输入被建模为一个恒定的门控变量$s = 1$，具有电导$g_{\\mathrm{syn}}$和反转电位$E_{\\mathrm{syn}}$。\n\n您的程序必须实现以下任务并产生指定的输出：\n\n1. 对于给定的参数集，使用数值模拟确定系统表现出持续振荡（持续性发放）的最小施加电流$I_{\\mathrm{th}}$。在提供的区间内对$I_{\\mathrm{app}}$使用区间法和二分法，直到找到$I_{\\mathrm{th}}$，容差为$\\Delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$。$I_{\\mathrm{th}}$定义为使发放频率超过$0.5$赫兹（Hz）的最小$I_{\\mathrm{app}}$，其中赫兹表示每秒的脉冲数，一秒等于$1000$毫秒。\n\n2. 对于$I_{\\mathrm{app}} = I_{\\mathrm{th}} + \\delta I$，其中$\\delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$，通过在瞬态后的窗口内计数$V$以正斜率穿越电压阈值$0\\,\\mathrm{mV}$的次数来估计起始发放频率$f_{\\mathrm{onset}}$（以赫兹为单位）。使用峰电位计数除以测量窗口的持续时间（以秒为单位）。\n\n3. 按如下方式对兴奋性类型进行分类：\n   - 如果$f_{\\mathrm{onset}}  10.0$赫兹，将该情况分类为I型，并记录整数$1$。\n   - 否则，将其分类为II型，并记录整数$2$。\n   这种分类的理由是，I型兴奋性在起始时以零频率出现（如在不变圆上的鞍结分岔或同宿分岔中），而II型兴奋性在起始时以非零频率出现（如在超临界霍普夫分岔中）。\n\n4. 将此过程应用于以下参数集测试套件。除非另有说明，否则使用$C = 20\\,\\mu\\mathrm{F}/\\mathrm{cm}^2$，$g_{\\mathrm{Ca}} = 4.4\\,\\mathrm{mS}/\\mathrm{cm}^2$，$g_{\\mathrm{K}} = 8.0\\,\\mathrm{mS}/\\mathrm{cm}^2$，$g_{\\mathrm{L}} = 2.0\\,\\mathrm{mS}/\\mathrm{cm}^2$，$V_{\\mathrm{Ca}} = 120\\,\\mathrm{mV}$，$V_{\\mathrm{K}} = -84\\,\\mathrm{mV}$，$V_{\\mathrm{L}} = -60\\,\\mathrm{mV}$，$V_1 = -1.2\\,\\mathrm{mV}$，$V_2 = 18\\,\\mathrm{mV}$，以及初始条件$V(0) = -60\\,\\mathrm{mV}$，$w(0) = w_{\\infty}(V(0))$。使用$s = 1$。\n   - 情况A（基线类I型零斜线）：$V_3 = 12\\,\\mathrm{mV}$，$V_4 = 17.4\\,\\mathrm{mV}$，$\\phi = 0.04\\,\\mathrm{ms}^{-1}$，$g_{\\mathrm{syn}} = 0\\,\\mathrm{mS}/\\mathrm{cm}^2$，$E_{\\mathrm{syn}} = 0\\,\\mathrm{mV}$；在$I_{\\mathrm{app}} \\in [0, 60]\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$上进行区间搜索。\n   - 情况B（基线类II型零斜线）：$V_3 = 2\\,\\mathrm{mV}$，$V_4 = 30\\,\\mathrm{mV}$，$\\phi = 0.2\\,\\mathrm{ms}^{-1}$，$g_{\\mathrm{syn}} = 0\\,\\mathrm{mS}/\\mathrm{cm}^2$，$E_{\\mathrm{syn}} = 0\\,\\mathrm{mV}$；在$I_{\\mathrm{app}} \\in [60, 140]\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$上进行区间搜索。\n   - 情况C（具有持续性突触分流的适应调节起始）：$V_3 = 12\\,\\mathrm{mV}$，$V_4 = 17.4\\,\\mathrm{mV}$，$\\phi = 0.2\\,\\mathrm{ms}^{-1}$，$g_{\\mathrm{syn}} = 1.0\\,\\mathrm{mS}/\\mathrm{cm}^2$，$E_{\\mathrm{syn}} = 0\\,\\mathrm{mV}$；在$I_{\\mathrm{app}} \\in [30, 100]\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$上进行区间搜索。\n\n您的程序必须使用固定的评估网格实现数值积分来测量$V(t)$，丢弃瞬态，并计算峰电位数量。使用几秒钟（以毫秒表示）的总模拟时间，以确保可以检测到低频振荡。您的程序必须产生一行输出，其中包含三种情况的分类结果，形式为逗号分隔的列表，并用方括号括起来；例如，输出必须是$[r_1,r_2,r_3]$的形式，其中每个$r_i$是对应情况的整数$1$或$2$。\n\n每个测试用例的答案都是一个单一的整数，并且必须以指定的聚合单行格式报告。程序输出中不允许有此单行之外的任何附加文本。",
            "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于计算神经科学的既定原理，使用了著名的Morris-Lecar模型。问题是适定的，提供了所有必要的参数、方程、初始条件和清晰的算法流程。语言是客观的，任务可以形式化为计算解决方案。\n\n问题的核心是根据不同的参数体系对神经元模型的兴奋性类型进行分类。这是通过分析发放起始时的发放频率来实现的。该模型是一个二维常微分方程系统，用于描述膜电位$V$和恢复变量$w$。\n\n控制方程为：\n$$\nC \\frac{dV}{dt} = - g_{\\mathrm{Ca}} m_{\\infty}(V)\\,(V - V_{\\mathrm{Ca}}) - g_{\\mathrm{K}}\\, w\\, (V - V_{\\mathrm{K}}) - g_{\\mathrm{L}} (V - V_{\\mathrm{L}}) - g_{\\mathrm{syn}}\\, s\\, (V - E_{\\mathrm{syn}}) + I_{\\mathrm{app}}\n$$\n$$\n\\frac{dw}{dt} = \\phi\\, \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\n其中稳态激活和时间尺度函数由下式给出：\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_1}{V_2}\\right)\\right)\n$$\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{V - V_3}{V_4}\\right)\\right)\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\!\\left(\\frac{V - V_3}{2 V_4}\\right)}\n$$\n分析遵循一个精确的数值协议，实现如下：\n\n1.  **数值积分**：通过数值求解常微分方程系统来获得$V(t)$和$w(t)$的时间演化。我们采用一种鲁棒的积分方法，特别是来自`scipy.integrate`库的`solve_ivp`函数，它适用于此类刚性系统。解在步长为$dt = 0.1\\,\\mathrm{ms}$、总时长为$T_{\\mathrm{total}} = 5000\\,\\mathrm{ms}$的固定时间网格上进行评估。这个时长允许检测低频振荡。每次模拟的初始条件设置为$V(0) = -60\\,\\mathrm{mV}$和$w(0) = w_{\\infty}(V(0))$，其中$w_{\\infty}$的值是使用特定情况的参数$V_3$和$V_4$计算的。\n\n2.  **发放频率计算**：为了确定神经元是否表现出持续性发放，我们计算其发放频率。在丢弃一个$T_{\\mathrm{transient}} = 1000\\,\\mathrm{ms}$的初始瞬态周期以使系统稳定到其吸引子上之后，我们在接下来的$4000\\,\\mathrm{ms}$的测量窗口中计算峰电位的数量。一个峰电位被定义为膜电位$V(t)$从下方（即以正斜率）穿过$V_{\\mathrm{thresh}} = 0\\,\\mathrm{mV}$阈值的事件。然后，以赫兹（Hz）为单位的发放频率$f$计算为峰电位数量除以测量窗口的持续时间（以秒为单位）。\n\n3.  **阈值电流搜索**：使用二分搜索算法找到引发持续性发放的最小施加电流$I_{\\mathrm{th}}$。对于每个测试用例，我们在指定的区间$[I_{\\mathrm{low}}, I_{\\mathrm{high}}]$内进行搜索。搜索标准是上面计算出的发放频率是否超过$0.5\\,\\mathrm{Hz}$的最小阈值。该算法迭代地缩小电流区间，直到其宽度不超过指定的容差$\\Delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$。最终区间的上界被指定为阈值电流$I_{\\mathrm{th}}$，代表了保证产生高于$0.5\\,\\mathrm{Hz}$发放频率的最低测试电流。\n\n4.  **兴奋性分类**：兴奋性的类型由发放起始时的发放频率决定。我们用$I_{\\mathrm{app}} = I_{\\mathrm{th}} + \\delta I$（其中$\\delta I = 0.5\\,\\mu\\mathrm{A}/\\mathrm{cm}^2$）的施加电流来模拟神经元。产生的发放频率表示为起始频率$f_{\\mathrm{onset}}$。然后根据以下规则进行分类，该规则基于不同分岔的理论特性：\n    - 如果$f_{\\mathrm{onset}}  10.0\\,\\mathrm{Hz}$，兴奋性被分类为I型（与SNIC或同宿分岔相关，其中频率可以从任意低开始）。结果记录为整数$1$。\n    - 如果$f_{\\mathrm{onset}} \\ge 10.0\\,\\mathrm{Hz}$，兴奋性被分类为II型（与霍普夫分岔相关，其中振荡以非零频率出现）。结果记录为整数$2$。\n\n这个完整的数值过程应用于所提供的三个测试用例中的每一个，为每个参数集得出一个分类。最终输出是这些分类整数的集合。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Analyzes the bifurcation structure and excitability type of a modified\n    Morris-Lecar neuron model for three different parameter sets.\n    \"\"\"\n\n    # --- Model Definition ---\n    def m_inf(V, V1, V2):\n        return 0.5 * (1 + np.tanh((V - V1) / V2))\n\n    def w_inf(V, V3, V4):\n        return 0.5 * (1 + np.tanh((V - V3) / V4))\n\n    def tau_w(V, V3, V4):\n        return 1.0 / np.cosh((V - V3) / (2 * V4))\n\n    def derivatives(t, y, params):\n        V, w = y\n        p = params\n        \n        # Unpack parameters\n        C, g_Ca, g_K, g_L, g_syn, V_Ca, V_K, V_L, E_syn, V1, V2, V3, V4, phi, I_app = (\n            p['C'], p['g_Ca'], p['g_K'], p['g_L'], p['g_syn'], p['V_Ca'], p['V_K'], p['V_L'],\n            p['E_syn'], p['V1'], p['V2'], p['V3'], p['V4'], p['phi'], p['I_app']\n        )\n        s = 1.0  # Tonic synaptic gating\n\n        minf = m_inf(V, V1, V2)\n        winf = w_inf(V, V3, V4)\n        tauw = tau_w(V, V3, V4)\n\n        dV_dt = (-g_Ca * minf * (V - V_Ca) -\n                 g_K * w * (V - V_K) -\n                 g_L * (V - V_L) -\n                 g_syn * s * (V - E_syn) +\n                 I_app) / C\n        \n        dw_dt = phi * (winf - w) / tauw\n\n        return [dV_dt, dw_dt]\n\n    # --- Simulation and Analysis ---\n    def run_simulation_and_get_freq(params, I_app):\n        \"\"\"\n        Runs a simulation for a given I_app and calculates the firing frequency.\n        \"\"\"\n        sim_params = params.copy()\n        sim_params['I_app'] = I_app\n\n        # Simulation settings\n        T_total = 5000.0  # ms\n        dt = 0.1  # ms\n        T_transient = 1000.0  # ms\n        V_thresh = 0.0  # mV\n\n        # Initial conditions\n        V0 = -60.0\n        w0 = w_inf(V0, sim_params['V3'], sim_params['V4'])\n        y0 = [V0, w0]\n\n        # Time vector for evaluation\n        t_eval = np.arange(0, T_total, dt)\n\n        # Solve ODE\n        sol = solve_ivp(derivatives, [0, T_total], y0, args=(sim_params,),\n                        dense_output=True, t_eval=t_eval, method='RK45')\n        \n        V = sol.y[0]\n        \n        # Spike counting post-transient\n        transient_idx = int(T_transient / dt)\n        V_measure = V[transient_idx:]\n        \n        spike_count = 0\n        for i in range(1, len(V_measure)):\n            if V_measure[i - 1]  V_thresh and V_measure[i] >= V_thresh:\n                spike_count += 1\n        \n        measure_duration_s = (T_total - T_transient) / 1000.0\n        \n        if measure_duration_s > 0:\n            return spike_count / measure_duration_s\n        else:\n            return 0.0\n\n    def find_I_th(params, I_range):\n        \"\"\"\n        Performs a bisection search to find the threshold current I_th.\n        \"\"\"\n        low, high = I_range\n        tol = 0.5  # uA/cm^2\n        freq_crit = 0.5  # Hz\n\n        # Check boundaries to ensure search is valid\n        if run_simulation_and_get_freq(params, low) > freq_crit:\n            # The lower bound already produces spiking, threshold is lower\n            return low\n        if run_simulation_and_get_freq(params, high) = freq_crit:\n            # The upper bound doesn't produce spiking, threshold is higher\n            return high \n            \n        while (high - low) > tol:\n            mid = (low + high) / 2.0\n            freq = run_simulation_and_get_freq(params, mid)\n            if freq > freq_crit:\n                high = mid\n            else:\n                low = mid\n        return high\n\n    # --- Main Execution Logic ---\n    # Default parameters\n    BASE_PARAMS = {\n        'C': 20.0, 'g_Ca': 4.4, 'g_K': 8.0, 'g_L': 2.0,\n        'V_Ca': 120.0, 'V_K': -84.0, 'V_L': -60.0,\n        'V1': -1.2, 'V2': 18.0, 's': 1.0\n    }\n\n    # Test cases\n    test_cases = [\n        # Case A: Baseline Type I-like\n        {'V3': 12.0, 'V4': 17.4, 'phi': 0.04, 'g_syn': 0.0, 'E_syn': 0.0, 'I_range': [0, 60]},\n        # Case B: Baseline Type II-like\n        {'V3': 2.0, 'V4': 30.0, 'phi': 0.2, 'g_syn': 0.0, 'E_syn': 0.0, 'I_range': [60, 140]},\n        # Case C: Adaptation-modulated with shunt\n        {'V3': 12.0, 'V4': 17.4, 'phi': 0.2, 'g_syn': 1.0, 'E_syn': 0.0, 'I_range': [30, 100]}\n    ]\n    \n    results = []\n    delta_I = 0.5  # uA/cm^2\n    f_classify_thresh = 10.0 # Hz\n\n    for case_spec in test_cases:\n        params = BASE_PARAMS.copy()\n        params.update(case_spec)\n        \n        # 1. Find threshold current I_th\n        I_th = find_I_th(params, params['I_range'])\n        \n        # 2. Get onset frequency\n        I_onset = I_th + delta_I\n        f_onset = run_simulation_and_get_freq(params, I_onset)\n        \n        # 3. Classify excitability\n        if f_onset  f_classify_thresh:\n            classification = 1  # Type I\n        else:\n            classification = 2  # Type II\n        \n        results.append(classification)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}