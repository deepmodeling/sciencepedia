{
    "hands_on_practices": [
        {
            "introduction": "Understanding the diverse zoo of single-neuron models is crucial in computational neuroscience. This exercise provides hands-on experience in bridging the gap between biophysically-detailed models like the Adaptive Exponential (AdEx) integrate-and-fire neuron and more computationally efficient phenomenological models like the Izhikevich neuron. By fitting parameters to match key firing characteristics, you will develop a deeper intuition for how mathematical parameters govern neuronal dynamics and response properties .",
            "id": "4021734",
            "problem": "You are given the task of programmatically approximating the response of an Adaptive Exponential integrate-and-fire neuron by an Izhikevich neuron in a principled way grounded in biophysical and phenomenological modeling. The goal is to fit the Izhikevich parameters $(a,b,c,d)$ such that its firing rate as a function of input current (the $f$–$I$ curve) and key spike-shape features are close to those of a specified Adaptive Exponential (AdEx) model. You must derive your algorithm from core definitions of the two neuron models and justify the parameter mapping from biophysical to phenomenological quantities.\n\nFundamentals and Definitions:\n- A single-compartment neuron obeys a membrane equation that balances leak, nonlinear spike initiation, adaptation, and input drive. In an Adaptive Exponential (AdEx) model, the voltage $V(t)$ and adaptation current $w(t)$ satisfy\n$$\nC\\,\\frac{dV}{dt} = g_L\\,(E_L - V) + g_L\\,\\Delta_T\\,\\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right) + I - w,\n$$\n$$\n\\tau_w\\,\\frac{dw}{dt} = a\\,(V - E_L) - w,\n$$\ntogether with a spike-and-reset rule: when $V$ reaches a spike cutoff $V_{\\text{peak}}$, record a spike, set $V \\leftarrow V_{\\text{reset}}$, and increment the adaptation by $w \\leftarrow w + b$. All quantities in this problem are dimensionless (no physical units).\n- In the Izhikevich model, the voltage $v(t)$ and recovery variable $u(t)$ satisfy\n$$\n\\frac{dv}{dt} = 0.04\\,v^2 + 5\\,v + 140 - u + I,\n$$\n$$\n\\frac{du}{dt} = a\\,(b\\,v - u),\n$$\nwith spike-and-reset: when $v$ reaches $30$, record a spike, set $v \\leftarrow c$, and increment the recovery variable by $u \\leftarrow u + d$. All quantities are dimensionless.\n\nDefinitions of the target curve and constraints:\n- An $f$–$I$ curve maps an injected constant current $I$ to the steady-state firing rate $f(I)$, computed as total spike count divided by total simulation time. The target $f$–$I$ curve is generated by the AdEx model under each test case below.\n- The spike-shape constraint in this problem is defined as the onset slope, namely $\\left.\\frac{dV}{dt}\\right|_{V=V_T,\\,I=I_{\\max}}$ for the AdEx model (approximated at $w \\approx 0$), and its Izhikevich counterpart $\\left.\\frac{dv}{dt}\\right|_{v=V_T,\\,I=I_{\\max}}$ evaluated at $u \\approx 0$. This constraint targets the rapid voltage rise at spike initiation.\n\nRequired algorithmic tasks:\n- Starting from the stated differential equations and reset rules, simulate both models using explicit Euler integration to numerically approximate the $f$–$I$ curves for a given set of currents. Use a fixed time step $dt$ and total simulation time $T$ as specified below. For each current $I$, initialize $V(0)=E_L$ and $w(0)=0$ for the AdEx model, and initialize $v(0)=E_L$ and $u(0)=0$ for the Izhikevich model.\n- Construct an objective to fit the Izhikevich parameters $(a,b,c,d)$ to a given AdEx configuration by minimizing a weighted combination of rate error and onset slope error. Let the rate error be the root-mean-square difference across the current sweep:\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N_I}\\sum_{k=1}^{N_I}\\left(f_{\\text{Iz}}(I_k) - f_{\\text{AdEx}}(I_k)\\right)^2},\n$$\nand the onset slope error be\n$$\n\\Delta_{\\text{slope}} = \\left|\\left.\\frac{dv}{dt}\\right|_{v=V_T,\\,I=I_{\\max}} - \\left.\\frac{dV}{dt}\\right|_{V=V_T,\\,I=I_{\\max}}\\right|.\n$$\nUse a fixed weight $\\lambda$ to combine them as $\\text{Objective} = \\text{RMSE} + \\lambda\\,\\Delta_{\\text{slope}}$.\n- Justify and implement a principled mapping strategy: set $c$ to the AdEx reset voltage $V_{\\text{reset}}$ and $d$ to the AdEx post-spike adaptation increment $b$, motivated by the similarity of reset and post-spike adaptation jumps. Fit $a$ and $b$ of the Izhikevich model by grid search over a specified range.\n\nSimulation specifications:\n- Use explicit Euler with time step $dt = 0.1$ and total simulation time $T = 500$. The current sweep is $I \\in \\{0,5,10,15\\}$, so $N_I = 4$ and $I_{\\max} = 15$. All numbers are dimensionless. Use a fixed weight $\\lambda = 0.01$.\n- Spike cutoff and reset in AdEx: use $V_{\\text{peak}} = 30$ and $V_{\\text{reset}}$ as defined per test case. For Izhikevich, use the standard spike cutoff $30$.\n\nTest suite and coverage:\nProvide three AdEx parameter sets to probe different regimes.\n1. Regular-spiking like adaptation (happy path):\n   - $C=1$, $g_L=0.05$, $E_L=-65$, $V_T=-50$, $\\Delta_T=2$, $\\tau_w=100$, $a=0.001$, $b=0.05$, $V_{\\text{reset}}=-65$, $V_{\\text{peak}}=30$.\n2. Fast-spiking like behavior (small adaptation, faster membrane):\n   - $C=1$, $g_L=0.1$, $E_L=-65$, $V_T=-50$, $\\Delta_T=2$, $\\tau_w=10$, $a=0.0$, $b=0.0$, $V_{\\text{reset}}=-65$, $V_{\\text{peak}}=30$.\n3. Near-threshold sharper onset (edge case with smaller spike slope window):\n   - $C=1$, $g_L=0.05$, $E_L=-65$, $V_T=-48$, $\\Delta_T=1$, $\\tau_w=200$, $a=0.001$, $b=0.02$, $V_{\\text{reset}}=-65$, $V_{\\text{peak}}=30$.\n\nFitting ranges:\n- Fit $a$ over $\\{0.01,0.02,0.05,0.1\\}$ and $b$ over $\\{0.0,0.05,0.1,0.2,0.3\\}$ for the Izhikevich model. Set $c = V_{\\text{reset}}$ and $d = b$ of the corresponding AdEx test case.\n\nProgram output specification:\n- For each test case, compute the minimized objective value as a floating-point number. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $3$, for example, $[\\text{obj}_1,\\text{obj}_2,\\text{obj}_3]$.",
            "solution": "The problem has been validated and is deemed valid. It is scientifically grounded in established principles of computational neuroscience, presents a well-posed computational task, and is expressed in objective, formal language. All necessary parameters, equations, and constraints for a unique solution are provided, and there are no internal contradictions or scientifically unsound premises.\n\nThe task is to approximate an Adaptive Exponential (AdEx) integrate-and-fire neuron with an Izhikevich neuron model. The fitting procedure aims to match the firing rate response to constant input currents (the $f$-$I$ curve) and the voltage dynamics at spike initiation. This is achieved by minimizing a composite objective function over a discrete set of Izhikevich model parameters.\n\nThe solution is developed in four principled steps:\n1.  **Model Definition and Discretization**: The continuous-time differential equations for both models are discretized using the explicit Euler method to prepare for numerical simulation.\n2.  **Parameter Mapping Justification**: A principled mapping is established between a subset of AdEx and Izhikevich parameters based on their analogous functional roles in the dynamics of spiking and adaptation.\n3.  **Objective Function Derivation**: An objective function is constructed to quantify the mismatch between the two models, combining errors in firing rate and spike onset dynamics.\n4.  **Optimization Algorithm**: A grid search algorithm is employed to find the Izhikevich parameters that minimize the defined objective function.\n\n**1. Model Definition and Discretization**\n\nThe AdEx model is described by a system of two ordinary differential equations (ODEs) for membrane voltage $V(t)$ and adaptation current $w(t)$:\n$$\nC\\,\\frac{dV}{dt} = g_L\\,(E_L - V) + g_L\\,\\Delta_T\\,\\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right) + I - w\n$$\n$$\n\\tau_w\\,\\frac{dw}{dt} = a_{\\text{AdEx}}\\,(V - E_L) - w\n$$\nThe Izhikevich model is described by a similar system for voltage $v(t)$ and recovery variable $u(t)$:\n$$\n\\frac{dv}{dt} = 0.04\\,v^2 + 5\\,v + 140 - u + I\n$$\n$$\n\\frac{du}{dt} = a_{\\text{Iz}}\\,(b_{\\text{Iz}}\\,v - u)\n$$\nFor numerical simulation, we use the explicit Euler method with a time step $dt$. Let $V_n = V(n \\cdot dt)$ and $w_n = w(n \\cdot dt)$. The updates from time step $n$ to $n+1$ are:\n$$\nV_{n+1} = V_n + \\frac{dt}{C} \\left[ g_L(E_L - V_n) + g_L\\Delta_T\\exp\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) + I - w_n \\right]\n$$\n$$\nw_{n+1} = w_n + \\frac{dt}{\\tau_w} \\left[ a_{\\text{AdEx}}(V_n - E_L) - w_n \\right]\n$$\nIf $V_{n+1} \\geq V_{\\text{peak}}$, a spike is recorded, and the state is reset: $V_{n+1} \\leftarrow V_{\\text{reset}}$ and $w_{n+1} \\leftarrow w_n + b_{\\text{AdEx}}$. Note that the problem specifies `w`'s reset as an increment from its value *before* the Euler step, which is $w_n$. A more standard implementation might use $w_{n+1}$ as the base, however we will strictly adhere to the prompt's implied sequence of calculate-update-reset. For numerical stability, the reset of `w` is best implemented as $w_{n+1} \\leftarrow (w_n + \\frac{dt}{\\tau_w} \\left[ a_{\\text{AdEx}}(V_n - E_L) - w_n \\right]) + b_{\\text{AdEx}}$, but the problem states \"$w \\leftarrow w + b$\", which is interpreted as incrementing the current value. We will implement $w_{n+1} \\leftarrow w_n + b_{\\text{AdEx}}$ for simplicity and direct interpretation.\n\nSimilarly, for the Izhikevich model:\n$$\nv_{n+1} = v_n + dt \\cdot (0.04\\,v_n^2 + 5\\,v_n + 140 - u_n + I)\n$$\n$$\nu_{n+1} = u_n + dt \\cdot (a_{\\text{Iz}}(b_{\\text{Iz}}\\,v_n - u_n))\n$$\nIf $v_{n+1} \\geq 30$, a spike is recorded, and the state is reset: $v_{n+1} \\leftarrow c_{\\text{Iz}}$ and $u_{n+1} \\leftarrow u_n + d_{\\text{Iz}}$.\n\n**2. Parameter Mapping Justification**\n\nThe problem requires fitting the Izhikevich parameters $(a_{\\text{Iz}}, b_{\\text{Iz}}, c_{\\text{Iz}}, d_{\\text{Iz}})$. A principled approach, as specified, is to map parameters with analogous roles directly and fit the remaining ones.\n- **Reset Voltage ($V_{\\text{reset}} \\to c_{\\text{Iz}}$)**: The Izhikevich parameter $c_{\\text{Iz}}$ is the value to which the membrane potential $v$ is reset after a spike. This is functionally identical to the AdEx reset potential $V_{\\text{reset}}$. Therefore, we set $c_{\\text{Iz}} = V_{\\text{reset}}$.\n- **Adaptation Increment ($b_{\\text{AdEx}} \\to d_{\\text{Iz}}$)**: The Izhikevich parameter $d_{\\text{Iz}}$ is the amount added to the recovery variable $u$ after a spike. This models a spike-triggered adaptive process. This is functionally analogous to the AdEx parameter $b_{\\text{AdEx}}$, which is the amount added to the adaptation current $w$ after a spike. Both contribute to spike-frequency adaptation. Hence, we set $d_{\\text{Iz}} = b_{\\text{AdEx}}$.\n\nThe remaining Izhikevich parameters, $a_{\\text{Iz}}$ and $b_{\\text{Iz}}$, which control the time scale of the recovery variable and its sensitivity to voltage, respectively, do not have direct one-to-one analogs in the AdEx model. They are therefore chosen as the fitting parameters to be optimized via a grid search.\n\n**3. Objective Function Derivation**\n\nThe objective function to be minimized is a weighted sum of two error terms: $\\text{Objective} = \\text{RMSE} + \\lambda\\,\\Delta_{\\text{slope}}$.\n\n- **Firing Rate Error (RMSE)**: This term quantifies the difference between the $f$-$I$ curves of the two models. The firing rate $f(I)$ for a given current $I$ is computed as $N_{\\text{spikes}} / T$, where $N_{\\text{spikes}}$ is the total number of spikes during a simulation of duration $T$. The Root-Mean-Square Error is calculated across the set of input currents $\\{I_k\\}_{k=1}^{N_I}$:\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N_I}\\sum_{k=1}^{N_I}\\left(f_{\\text{Iz}}(I_k) - f_{\\text{AdEx}}(I_k)\\right)^2}\n$$\n\n- **Spike Onset Slope Error ($\\Delta_{\\text{slope}}$)**: This term matches the steepness of the voltage upswing at spike initiation. It is calculated as the absolute difference of the derivatives $\\frac{dV}{dt}$ and $\\frac{dv}{dt}$, both evaluated at the AdEx threshold $V_T$ for the maximum current $I_{\\max}$, and assuming the adaptation/recovery variables are near zero ($w \\approx 0, u \\approx 0$).\n\nFor the AdEx model, the slope is:\n$$\n\\left.\\frac{dV}{dt}\\right|_{\\text{AdEx}} = \\frac{1}{C} \\left[ g_L(E_L - V_T) + g_L\\Delta_T\\exp\\left(\\frac{V_T - V_T}{\\Delta_T}\\right) + I_{\\max} - 0 \\right] = \\frac{1}{C} [g_L(E_L - V_T + \\Delta_T) + I_{\\max}]\n$$\nFor the Izhikevich model, the slope is:\n$$\n\\left.\\frac{dv}{dt}\\right|_{\\text{Iz}} = 0.04\\,V_T^2 + 5\\,V_T + 140 - 0 + I_{\\max} = 0.04\\,V_T^2 + 5\\,V_T + 140 + I_{\\max}\n$$\nThe slope error is then $\\Delta_{\\text{slope}} = \\left| \\left.\\frac{dv}{dt}\\right|_{\\text{Iz}} - \\left.\\frac{dV}{dt}\\right|_{\\text{AdEx}} \\right|$. The weight $\\lambda = 0.01$ balances the contributions of the two error terms.\n\n**4. Optimization Algorithm**\n\nThe overall procedure for each test case is as follows:\n1.  Set the AdEx parameters for the given test case.\n2.  Calculate the target AdEx $f$-$I$ curve by simulating the model for each current $I \\in \\{0, 5, 10, 15\\}$.\n3.  Calculate the target AdEx spike onset slope using the derived formula.\n4.  Initialize a variable `min_objective` to a very large number.\n5.  Perform a grid search over the specified ranges for Izhikevich parameters $a_{\\text{Iz}} \\in \\{0.01, 0.02, 0.05, 0.1\\}$ and $b_{\\text{Iz}} \\in \\{0.0, 0.05, 0.1, 0.2, 0.3\\}$.\n6.  For each pair $(a_{\\text{Iz}}, b_{\\text{Iz}})$ in the grid:\n    a. Determine the other Izhikevich parameters: $c_{\\text{Iz}} = V_{\\text{reset}}$ and $d_{\\text{Iz}} = b_{\\text{AdEx}}$ from the AdEx parameters.\n    b. Simulate the Izhikevich model with the current parameter set $(a_{\\text{Iz}}, b_{\\text{Iz}}, c_{\\text{Iz}}, d_{\\text{Iz}})$ to generate its $f$-$I$ curve.\n    c. Calculate the Izhikevich spike onset slope.\n    d. Compute the total objective function value.\n    e. If this value is less than `min_objective`, update `min_objective` to this new value.\n7.  The final `min_objective` value after the grid search is the result for the test case.\n\nThis procedure is repeated for all three test cases, and the resulting minimum objective values are reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits an Izhikevich neuron model to an Adaptive Exponential (AdEx) model\n    by minimizing an objective function that combines f-I curve error and\n    spike onset slope error.\n    \"\"\"\n\n    # --- Simulation and Fitting Specifications ---\n    DT = 0.1\n    T_SIM = 500.0\n    CURRENTS = [0.0, 5.0, 10.0, 15.0]\n    I_MAX = 15.0\n    LAMBDA_WEIGHT = 0.01\n\n    IZH_A_RANGE = [0.01, 0.02, 0.05, 0.1]\n    IZH_B_RANGE = [0.0, 0.05, 0.1, 0.2, 0.3]\n\n    # --- Test Cases ---\n    test_cases = [\n        # 1. Regular-spiking like\n        {\n            \"C\": 1.0, \"g_L\": 0.05, \"E_L\": -65.0, \"V_T\": -50.0, \"Delta_T\": 2.0,\n            \"tau_w\": 100.0, \"a\": 0.001, \"b\": 0.05, \"V_reset\": -65.0, \"V_peak\": 30.0\n        },\n        # 2. Fast-spiking like\n        {\n            \"C\": 1.0, \"g_L\": 0.1, \"E_L\": -65.0, \"V_T\": -50.0, \"Delta_T\": 2.0,\n            \"tau_w\": 10.0, \"a\": 0.0, \"b\": 0.0, \"V_reset\": -65.0, \"V_peak\": 30.0\n        },\n        # 3. Near-threshold sharper onset\n        {\n            \"C\": 1.0, \"g_L\": 0.05, \"E_L\": -65.0, \"V_T\": -48.0, \"Delta_T\": 1.0,\n            \"tau_w\": 200.0, \"a\": 0.001, \"b\": 0.02, \"V_reset\": -65.0, \"V_peak\": 30.0\n        }\n    ]\n\n    # --- Helper Functions ---\n\n    def simulate_adex(p, currents, dt, t_sim):\n        \"\"\"Simulates the AdEx model and returns firing rates.\"\"\"\n        rates = []\n        num_steps = int(t_sim / dt)\n        \n        for I_inj in currents:\n            V = p[\"E_L\"]\n            w = 0.0\n            spike_count = 0\n            \n            for _ in range(num_steps):\n                # Check for spike and reset\n                if V >= p[\"V_peak\"]:\n                    spike_count += 1\n                    V = p[\"V_reset\"]\n                    w += p[\"b\"]\n                \n                # Exponential term can be large, handle cautiously\n                exp_term = p[\"g_L\"] * p[\"Delta_T\"] * np.exp((V - p[\"V_T\"]) / p[\"Delta_T\"])\n                \n                # Euler integration step\n                dV_dt = (p[\"g_L\"] * (p[\"E_L\"] - V) + exp_term + I_inj - w) / p[\"C\"]\n                dw_dt = (p[\"a\"] * (V - p[\"E_L\"]) - w) / p[\"tau_w\"]\n                \n                V += dV_dt * dt\n                w += dw_dt * dt\n\n            rates.append(spike_count / t_sim)\n        return np.array(rates)\n\n    def simulate_izh(p_iz, p_adex, currents, dt, t_sim):\n        \"\"\"Simulates the Izhikevich model and returns firing rates.\"\"\"\n        rates = []\n        num_steps = int(t_sim / dt)\n        \n        for I_inj in currents:\n            v = p_adex[\"E_L\"]  # Initialize at AdEx E_L\n            u = 0.0\n            spike_count = 0\n            \n            for _ in range(num_steps):\n                # Check for spike and reset\n                if v >= 30.0:\n                    spike_count += 1\n                    v = p_iz[\"c\"]\n                    u += p_iz[\"d\"]\n\n                # Euler integration step\n                dv_dt = 0.04 * v**2 + 5.0 * v + 140.0 - u + I_inj\n                du_dt = p_iz[\"a\"] * (p_iz[\"b\"] * v - u)\n                \n                v += dv_dt * dt\n                u += du_dt * dt\n                \n            rates.append(spike_count / t_sim)\n        return np.array(rates)\n\n    def calculate_objective(f_adex, f_iz, slope_adex, slope_iz, lambda_w):\n        \"\"\"Calculates the combined objective function.\"\"\"\n        rmse = np.sqrt(np.mean((f_iz - f_adex)**2))\n        delta_slope = np.abs(slope_iz - slope_iz)\n        return rmse + lambda_w * delta_slope\n\n    # --- Main Loop ---\n    final_results = []\n    \n    for adex_params in test_cases:\n        # 1. Generate target AdEx f-I curve\n        f_adex_target = simulate_adex(adex_params, CURRENTS, DT, T_SIM)\n\n        # 2. Calculate target AdEx onset slope\n        p = adex_params\n        slope_adex_target = (p[\"g_L\"] * (p[\"E_L\"] - p[\"V_T\"] + p[\"Delta_T\"]) + I_MAX) / p[\"C\"]\n\n        min_objective = float('inf')\n\n        # 3. Grid search for Izhikevich parameters\n        for a_iz in IZH_A_RANGE:\n            for b_iz in IZH_B_RANGE:\n                # Set Izhikevich parameters based on mapping\n                iz_params = {\n                    \"a\": a_iz,\n                    \"b\": b_iz,\n                    \"c\": adex_params[\"V_reset\"],\n                    \"d\": adex_params[\"b\"]\n                }\n                \n                # Simulate Izhikevich model for this parameter set\n                f_iz_candidate = simulate_izh(iz_params, adex_params, CURRENTS, DT, T_SIM)\n                \n                # Calculate Izhikevich onset slope\n                V_T = adex_params[\"V_T\"]\n                slope_iz_candidate = 0.04 * V_T**2 + 5.0 * V_T + 140.0 + I_MAX\n\n                # Calculate objective\n                objective = calculate_objective(f_adex_target, f_iz_candidate, slope_adex_target, slope_iz_candidate, LAMBDA_WEIGHT)\n                \n                if objective < min_objective:\n                    min_objective = objective\n        \n        final_results.append(min_objective)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.10f}' for r in final_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Synaptic plasticity rules are the engine of learning in the brain and in spiking neural networks. This practice moves beyond simple pairwise models to a more computationally powerful triplet Spike-Timing-Dependent Plasticity (STDP) rule, which better captures experimental data. By manually tracing the dynamics of eligibility traces and calculating weight updates for specific spike sequences, you will gain a concrete understanding of how spike history and timing patterns interact to shape synaptic strength .",
            "id": "4021715",
            "problem": "Consider a single synapse governed by a triplet Spike-Timing-Dependent Plasticity (STDP) rule in a spiking neural network, as commonly used for computational modeling in brain modeling and computational neuroscience. The synaptic plasticity is described by four eligibility traces: a fast presynaptic trace $x(t)$, a slow presynaptic trace $x_{s}(t)$, a fast postsynaptic trace $y(t)$, and a slow postsynaptic trace $y_{s}(t)$. These traces follow first-order linear decay dynamics between spikes. Specifically, for a presynaptic spike at time $t_{\\text{pre}}$, the updates are $x(t_{\\text{pre}}^{+}) = x(t_{\\text{pre}}^{-}) + 1$ and $x_{s}(t_{\\text{pre}}^{+}) = x_{s}(t_{\\text{pre}}^{-}) + 1$, and for a postsynaptic spike at time $t_{\\text{post}}$, the updates are $y(t_{\\text{post}}^{+}) = y(t_{\\text{post}}^{-}) + 1$ and $y_{s}(t_{\\text{post}}^{+}) = y_{s}(t_{\\text{post}}^{-}) + 1$. Between spikes, the traces decay exponentially according to\n$$\n\\frac{d x}{d t} = -\\frac{x}{\\tau_{x}},\\quad \\frac{d x_{s}}{d t} = -\\frac{x_{s}}{\\tau_{x,s}},\\quad \\frac{d y}{d t} = -\\frac{y}{\\tau_{y}},\\quad \\frac{d y_{s}}{d t} = -\\frac{y_{s}}{\\tau_{y,s}}.\n$$\nThe synaptic weight $w$ is updated instantaneously at spike times. At a postsynaptic spike time $t_{\\text{post}}$, the change is\n$$\n\\Delta w\\big|_{t_{\\text{post}}} = A_{2}^{+}\\,x(t_{\\text{post}}^{-}) + A_{3}^{+}\\,x(t_{\\text{post}}^{-})\\,y_{s}(t_{\\text{post}}^{-}),\n$$\nand at a presynaptic spike time $t_{\\text{pre}}$, the change is\n$$\n\\Delta w\\big|_{t_{\\text{pre}}} = -A_{2}^{-}\\,y(t_{\\text{pre}}^{-}) - A_{3}^{-}\\,y(t_{\\text{pre}}^{-})\\,x_{s}(t_{\\text{pre}}^{-}).\n$$\nHere, $A_{2}^{+}$ and $A_{3}^{+}$ are positive potentiation amplitudes, while $A_{2}^{-}$ and $A_{3}^{-}$ are positive depression amplitudes. The traces are initialized as $x(0^{-})=x_{s}(0^{-})=y(0^{-})=y_{s}(0^{-})=0$.\n\nLet the parameters be\n$$\nA_{2}^{+} = 0.008,\\quad A_{3}^{+} = 0.002,\\quad A_{2}^{-} = 0.009,\\quad A_{3}^{-} = 0.003,\n$$\nand the time constants be\n$$\n\\tau_{x} = 20~\\text{ms},\\quad \\tau_{x,s} = 80~\\text{ms},\\quad \\tau_{y} = 30~\\text{ms},\\quad \\tau_{y,s} = 120~\\text{ms}.\n$$\nConsider two three-spike sequences that share the same inter-spike intervals but permute the identity of the middle spike:\n- Sequence $\\mathcal{S}_{A}$: a presynaptic spike at $t=0~\\text{ms}$, a postsynaptic spike at $t=10~\\text{ms}$, and a presynaptic spike at $t=40~\\text{ms}$.\n- Sequence $\\mathcal{S}_{B}$: a presynaptic spike at $t=0~\\text{ms}$, a presynaptic spike at $t=10~\\text{ms}$, and a postsynaptic spike at $t=40~\\text{ms}$.\n\nUsing the above triplet STDP rule and trace dynamics, compute the net synaptic change $\\Delta w(\\mathcal{S}_{A})$ and $\\Delta w(\\mathcal{S}_{B})$, and then define the sensitivity to interval permutation as\n$$\nS \\equiv \\Delta w(\\mathcal{S}_{A}) - \\Delta w(\\mathcal{S}_{B}).\n$$\nProvide the value of $S$ as a dimensionless number rounded to five significant figures, and express your answer in scientific notation. No units are required for the final answer.",
            "solution": "The problem requires the calculation of the net synaptic weight change, $\\Delta w$, for two different three-spike sequences, $\\mathcal{S}_{A}$ and $\\mathcal{S}_{B}$, under a triplet Spike-Timing-Dependent Plasticity (STDP) rule. We will then compute the sensitivity $S = \\Delta w(\\mathcal{S}_{A}) - \\Delta w(\\mathcal{S}_{B})$.\n\nThe dynamics of the four eligibility traces ($x(t)$, $x_{s}(t)$, $y(t)$, $y_{s}(t)$) between spikes are governed by first-order linear decay differential equations. The solution for a generic trace $z(t)$ with time constant $\\tau_{z}$ and an initial value $z(t_0)$ at time $t_0$ is given by:\n$$ z(t) = z(t_0) \\exp\\left(-\\frac{t-t_0}{\\tau_{z}}\\right) \\quad \\text{for } t > t_0. $$\nThe traces are initialized to $0$ at $t=0^{-}$. At each spike, the weight $w$ is updated based on the values of the traces just before the spike ($t^{-}$), and then the traces themselves are updated instantaneously ($t^{+}$).\n\nWe are given the parameters:\nAmplitudes: $A_{2}^{+} = 0.008$, $A_{3}^{+} = 0.002$, $A_{2}^{-} = 0.009$, $A_{3}^{-} = 0.003$.\nTime constants: $\\tau_{x} = 20$ ms, $\\tau_{x,s} = 80$ ms, $\\tau_{y} = 30$ ms, $\\tau_{y,s} = 120$ ms.\n\nFirst, we analyze sequence $\\mathcal{S}_{A}$: presynaptic at $t=0$ ms, postsynaptic at $t=10$ ms, and presynaptic at $t=40$ ms.\n\n1.  **Presynaptic spike at $t=0$ ms:**\n    - Traces at $t=0^{-}$: $x(0^{-})=0$, $x_{s}(0^{-})=0$, $y(0^{-})=0$, $y_{s}(0^{-})=0$.\n    - Weight update $\\Delta w_1(\\mathcal{S}_{A})$: The update for a presynaptic spike depends on $y(0^{-})$ and $x_s(0^{-})$.\n      $$ \\Delta w_1(\\mathcal{S}_{A}) = -A_{2}^{-}\\,y(0^{-}) - A_{3}^{-}\\,y(0^{-})\\,x_{s}(0^{-}) = -A_{2}^{-}(0) - A_{3}^{-}(0)(0) = 0. $$\n    - Trace update at $t=0^{+}$: $x(0^{+}) = x(0^{-})+1=1$, $x_{s}(0^{+}) = x_{s}(0^{-})+1=1$. The $y$ traces remain $0$.\n\n2.  **Decay from $t=0$ ms to $t=10$ ms:** We calculate the trace values at $t=10^{-}$.\n    - $x(10^{-}) = x(0^{+}) \\exp(-\\frac{10}{\\tau_{x}}) = 1 \\cdot \\exp(-\\frac{10}{20}) = \\exp(-0.5)$.\n    - $x_{s}(10^{-}) = x_{s}(0^{+}) \\exp(-\\frac{10}{\\tau_{x,s}}) = 1 \\cdot \\exp(-\\frac{10}{80}) = \\exp(-0.125)$.\n    - $y(10^{-}) = y(0^{+}) \\exp(-\\frac{10}{\\tau_{y}}) = 0$.\n    - $y_{s}(10^{-}) = y_{s}(0^{+}) \\exp(-\\frac{10}{\\tau_{y,s}}) = 0$.\n\n3.  **Postsynaptic spike at $t=10$ ms:**\n    - Weight update $\\Delta w_2(\\mathcal{S}_{A})$: The update for a postsynaptic spike depends on $x(10^{-})$ and $y_{s}(10^{-})$.\n      $$ \\Delta w_2(\\mathcal{S}_{A}) = A_{2}^{+}\\,x(10^{-}) + A_{3}^{+}\\,x(10^{-})\\,y_{s}(10^{-}) = A_{2}^{+}\\,\\exp(-0.5) + A_{3}^{+}\\,\\exp(-0.5)(0) = A_{2}^{+}\\,\\exp(-0.5). $$\n    - Trace update at $t=10^{+}$: $y(10^{+})=y(10^{-})+1=1$, $y_{s}(10^{+})=y_{s}(10^{-})+1=1$. The $x$ traces are unchanged: $x(10^{+}) = \\exp(-0.5)$ and $x_{s}(10^{+}) = \\exp(-0.125)$.\n\n4.  **Decay from $t=10$ ms to $t=40$ ms:** The time interval is $\\Delta t = 30$ ms. We calculate traces at $t=40^{-}$.\n    - $x(40^{-}) = x(10^{+}) \\exp(-\\frac{30}{\\tau_{x}}) = \\exp(-0.5) \\exp(-\\frac{30}{20}) = \\exp(-0.5 - 1.5) = \\exp(-2.0)$.\n    - $x_{s}(40^{-}) = x_{s}(10^{+}) \\exp(-\\frac{30}{\\tau_{x,s}}) = \\exp(-0.125) \\exp(-\\frac{30}{80}) = \\exp(-0.125 - 0.375) = \\exp(-0.5)$.\n    - $y(40^{-}) = y(10^{+}) \\exp(-\\frac{30}{\\tau_{y}}) = 1 \\cdot \\exp(-\\frac{30}{30}) = \\exp(-1.0)$.\n    - $y_{s}(40^{-}) = y_{s}(10^{+}) \\exp(-\\frac{30}{\\tau_{y,s}}) = 1 \\cdot \\exp(-\\frac{30}{120}) = \\exp(-0.25)$.\n\n5.  **Presynaptic spike at $t=40$ ms:**\n    - Weight update $\\Delta w_3(\\mathcal{S}_{A})$:\n      $$ \\Delta w_3(\\mathcal{S}_{A}) = -A_{2}^{-}\\,y(40^{-}) - A_{3}^{-}\\,y(40^{-})\\,x_{s}(40^{-}) = -A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.0)\\,\\exp(-0.5) = -A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5). $$\n\nThe total weight change for $\\mathcal{S}_{A}$ is the sum of the individual changes:\n$$ \\Delta w(\\mathcal{S}_{A}) = \\Delta w_1 + \\Delta w_2 + \\Delta w_3 = A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5). $$\n\nNext, we analyze sequence $\\mathcal{S}_{B}$: presynaptic at $t=0$ ms, presynaptic at $t=10$ ms, and postsynaptic at $t=40$ ms.\n\n1.  **Presynaptic spike at $t=0$ ms:** This is identical to $\\mathcal{S}_{A}$. $\\Delta w_1(\\mathcal{S}_{B}) = 0$. Traces at $t=0^{+}$ are $x(0^{+})=1$, $x_{s}(0^{+})=1$, $y(0^{+})=0$, $y_{s}(0^{+})=0$.\n\n2.  **Decay from $t=0$ ms to $t=10$ ms:** Identical to $\\mathcal{S}_{A}$. At $t=10^{-}$, $x(10^{-})=\\exp(-0.5)$, $x_{s}(10^{-})=\\exp(-0.125)$, and $y, y_s$ are $0$.\n\n3.  **Presynaptic spike at $t=10$ ms:**\n    - Weight update $\\Delta w_2(\\mathcal{S}_{B})$:\n      $$ \\Delta w_2(\\mathcal{S}_{B}) = -A_{2}^{-}\\,y(10^{-}) - A_{3}^{-}\\,y(10^{-})\\,x_{s}(10^{-}) = -A_{2}^{-}(0) - A_{3}^{-}(0)\\exp(-0.125) = 0. $$\n    - Trace update at $t=10^{+}$: $x(10^{+})=x(10^{-})+1 = \\exp(-0.5)+1$, $x_{s}(10^{+})=x_{s}(10^{-})+1 = \\exp(-0.125)+1$. The $y$ traces remain $0$.\n\n4.  **Decay from $t=10$ ms to $t=40$ ms:** $\\Delta t=30$ ms. Traces at $t=40^{-}$.\n    - $x(40^{-}) = x(10^{+}) \\exp(-\\frac{30}{\\tau_{x}}) = (\\exp(-0.5)+1) \\exp(-1.5) = \\exp(-2.0) + \\exp(-1.5)$.\n    - $x_{s}(40^{-}) = x_{s}(10^{+}) \\exp(-\\frac{30}{\\tau_{x,s}}) = (\\exp(-0.125)+1) \\exp(-0.375) = \\exp(-0.5) + \\exp(-0.375)$.\n    - $y(40^{-})=0$, $y_{s}(40^{-})=0$.\n\n5.  **Postsynaptic spike at $t=40$ ms:**\n    - Weight update $\\Delta w_3(\\mathcal{S}_{B})$:\n      $$ \\Delta w_3(\\mathcal{S}_{B}) = A_{2}^{+}\\,x(40^{-}) + A_{3}^{+}\\,x(40^{-})\\,y_{s}(40^{-}) = A_{2}^{+}(\\exp(-2.0) + \\exp(-1.5)) + 0. $$\n\nThe total weight change for $\\mathcal{S}_{B}$ is:\n$$ \\Delta w(\\mathcal{S}_{B}) = \\Delta w_1 + \\Delta w_2 + \\Delta w_3 = A_{2}^{+}(\\exp(-2.0) + \\exp(-1.5)). $$\n\nFinally, we compute the sensitivity $S = \\Delta w(\\mathcal{S}_{A}) - \\Delta w(\\mathcal{S}_{B})$.\n$$ S = \\left( A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5) \\right) - \\left( A_{2}^{+}(\\exp(-2.0) + \\exp(-1.5)) \\right). $$\n$$ S = A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - A_{3}^{-}\\,\\exp(-1.5) - A_{2}^{+}\\,\\exp(-2.0) - A_{2}^{+}\\,\\exp(-1.5). $$\nGrouping terms:\n$$ S = A_{2}^{+}\\,\\exp(-0.5) - A_{2}^{-}\\,\\exp(-1.0) - (A_{2}^{+} + A_{3}^{-})\\,\\exp(-1.5) - A_{2}^{+}\\,\\exp(-2.0). $$\nNow we substitute the numerical values for the parameters:\n$$ S = 0.008\\,\\exp(-0.5) - 0.009\\,\\exp(-1.0) - (0.008 + 0.003)\\,\\exp(-1.5) - 0.008\\,\\exp(-2.0). $$\n$$ S = 0.008\\,\\exp(-0.5) - 0.009\\,\\exp(-1.0) - 0.011\\,\\exp(-1.5) - 0.008\\,\\exp(-2.0). $$\nUsing numerical values for the exponential function:\n$\\exp(-0.5) \\approx 0.606531$\n$\\exp(-1.0) \\approx 0.367879$\n$\\exp(-1.5) \\approx 0.223130$\n$\\exp(-2.0) \\approx 0.135335$\n$$ S \\approx 0.008(0.606531) - 0.009(0.367879) - 0.011(0.223130) - 0.008(0.135335). $$\n$$ S \\approx 0.00485225 - 0.00331091 - 0.00245443 - 0.00108268. $$\n$$ S \\approx -0.00199577. $$\nRounding to five significant figures and expressing in scientific notation:\n$$ S \\approx -1.9958 \\times 10^{-3}. $$",
            "answer": "$$\\boxed{-1.9958 \\times 10^{-3}}$$"
        },
        {
            "introduction": "Quantifying the difference between neural spike trains is a fundamental task in analyzing both experimental and simulated data. This exercise introduces the Victor-Purpura distance, a versatile and widely used spike train metric that elegantly balances sensitivity to spike timing and spike count. Calculating this distance for a pair of spike trains will solidify your understanding of the underlying dynamic programming algorithm and the critical role of the cost parameter $q$ in defining temporal precision .",
            "id": "4021728",
            "problem": "Consider two spike trains $S^{(1)}$ and $S^{(2)}$ observed from two neurons in a computational experiment. The spike times (measured relative to a common reference) are strictly increasing and given by $S^{(1)} = \\{5, 15, 30, 55\\}\\ \\mathrm{ms}$ and $S^{(2)} = \\{4, 20, 31, 54, 90\\}\\ \\mathrm{ms}$. The Victor–Purpura distance $D_{q}(S^{(1)}, S^{(2)})$ is defined as the minimal total cost of transforming $S^{(1)}$ into $S^{(2)}$ using only three edit operations: delete a spike (cost $1$), insert a spike (cost $1$), or shift a spike in time by an amount $\\Delta t$ (cost $q\\,|\\Delta t|$). The cost parameter $q$ has units $\\mathrm{ms}^{-1}$ so that $q\\,|\\Delta t|$ is dimensionless, and the distance $D_{q}$ is dimensionless.\n\nUsing these definitions and $q = 0.2\\ \\mathrm{ms}^{-1}$, compute the Victor–Purpura distance $D_{q}(S^{(1)}, S^{(2)})$. Provide your final numerical answer exactly (no rounding). Then, based on your computation and the structure of the edit operations, interpret how the parameter $q$ tunes sensitivity to spike timing differences versus spike count differences. Express your final answer as a single number with no units.",
            "solution": "The problem requires the computation of the Victor–Purpura distance, $D_{q}(S^{(1)}, S^{(2)})$, between two spike trains, $S^{(1)} = \\{5, 15, 30, 55\\}$ ms and $S^{(2)} = \\{4, 20, 31, 54, 90\\}$ ms, for a cost parameter $q = 0.2\\ \\mathrm{ms}^{-1}$. It also asks for an interpretation of the role of the parameter $q$.\n\nThe Victor–Purpura distance is the minimum cost to transform one spike train into another using three elementary operations: spike deletion (cost $1$), spike insertion (cost $1$), and spike shift by an amount $\\Delta t$ (cost $q|\\Delta t|$). This minimal cost can be computed efficiently using a dynamic programming algorithm, analogous to the one used for computing the Levenshtein distance between strings.\n\nLet the spike times in $S^{(1)}$ be denoted by $t_i$ for $i=1, \\dots, m$, and in $S^{(2)}$ by $t'_j$ for $j=1, \\dots, n$. Here, $m=4$ and $n=5$. We define a matrix $D$ of size $(m+1) \\times (n+1)$, where $D(i,j)$ is the minimum cost to transform the first $i$ spikes of $S^{(1)}$ into the first $j$ spikes of $S^{(2)}$.\n\nThe matrix entries are computed as follows:\n\n1.  **Initialization**:\n    The cost of transforming an empty spike train into one with $j$ spikes is to insert all $j$ spikes, so $D(0,j) = j$.\n    The cost of transforming a spike train with $i$ spikes into an empty one is to delete all $i$ spikes, so $D(i,0) = i$.\n    The cost of transforming an empty spike train into another empty one is $D(0,0)=0$.\n\n2.  **Recurrence Relation**:\n    For $i > 0$ and $j > 0$, the value of $D(i,j)$ is determined by the minimum of three possible operations:\n    a. Deleting the $i$-th spike of $S^{(1)}$: The cost is $D(i-1, j) + 1$.\n    b. Inserting the $j$-th spike of $S^{(2)}$: The cost is $D(i, j-1) + 1$.\n    c. Shifting the $i$-th spike of $S^{(1)}$ to match the $j$-th spike of $S^{(2)}$: The cost is $D(i-1, j-1) + q|t_i - t'_j|$.\n\n    The recurrence is therefore:\n    $$D(i,j) = \\min\\left( D(i-1, j) + 1, \\quad D(i, j-1) + 1, \\quad D(i-1, j-1) + q|t_i - t'_j| \\right)$$\n\nWe apply this algorithm with the given spike trains and $q=0.2$.\n$S^{(1)} = \\{t_1, t_2, t_3, t_4\\} = \\{5, 15, 30, 55\\}$\n$S^{(2)} = \\{t'_1, t'_2, t'_3, t'_4, t'_5\\} = \\{4, 20, 31, 54, 90\\}$\n\nThe initialization of the $5 \\times 6$ matrix $D$ is:\n$D(i, 0) = i$ for $i \\in \\{0, 1, 2, 3, 4\\}$\n$D(0, j) = j$ for $j \\in \\{0, 1, 2, 3, 4, 5\\}$\n\nLet's compute an example entry, $D(1,1)$:\n$D(1,1) = \\min(D(0,1)+1, D(1,0)+1, D(0,0)+q|t_1-t'_1|)$\n$D(1,1) = \\min(1+1, 1+1, 0 + 0.2 |5 - 4|) = \\min(2, 2, 0.2) = 0.2$.\n\nProceeding with this calculation for all entries results in the following cost matrix:\n$$\nD = \\begin{pmatrix}\n0 & 1 & 2 & 3 & 4 & 5 \\\\\n1 & 0.2 & 1.2 & 2.2 & 3.2 & 4.2 \\\\\n2 & 1.2 & 1.2 & 2.2 & 3.2 & 4.2 \\\\\n3 & 2.2 & 2.2 & 1.4 & 2.4 & 3.4 \\\\\n4 & 3.2 & 3.2 & 2.4 & 1.6 & 2.6\n\\end{pmatrix}\n$$\nThe Victor–Purpura distance is the value in the bottom-right corner of the matrix, $D(m,n) = D(4,5)$.\nTherefore, $D_{0.2}(S^{(1)}, S^{(2)}) = 2.6$.\n\nThe second part of the problem asks for an interpretation of the parameter $q$. The parameter $q$ controls the trade-off between the cost of spike timing differences and spike count differences.\n\nThe cost of accounting for a mismatch between two spikes, one from each train, can be resolved in two fundamental ways:\n1.  Treat them as unrelated: delete the spike from $S^{(1)}$ and insert the spike from $S^{(2)}$. The total cost for this pair of operations is $1 + 1 = 2$.\n2.  Treat them as corresponding spikes: shift the spike from $S^{(1)}$ to the time of the spike from $S^{(2)}$. The cost is $q|\\Delta t|$, where $\\Delta t$ is the time difference.\n\nThe algorithm chooses the cheaper option. A shift will be preferred over a delete-insert operation if $q|\\Delta t| < 2$, which is equivalent to $|\\Delta t| < 2/q$. This inequality reveals the role of $q$:\n-   The quantity $1/q$ sets a characteristic timescale. For the given problem, $1/q = 1/0.2 = 5$ ms. The critical time difference where shifting costs as much as deletion and insertion is $2/q = 10$ ms.\n-   When $q$ is small ($q \\to 0$), the shifting cost $q|\\Delta t|$ becomes negligible. The metric becomes insensitive to spike timing, and the distance is primarily determined by the difference in the number of spikes between the two trains, $|m-n|$. Spikes are matched even if they are far apart in time. The metric effectively becomes a spike count metric.\n-   When $q$ is large ($q \\to \\infty$), the shifting cost $q|\\Delta t|$ becomes very high for any non-zero $\\Delta t$. It is almost always cheaper to delete and insert spikes rather than shift them, unless they are nearly coincident ($|\\Delta t| < 2/q \\to 0$). The metric becomes highly sensitive to the precise timing of spikes. The distance effectively counts the number of non-coincident spikes.\n\nIn summary, $q$ is a temporal precision parameter. Low values of $q$ cause the distance to measure differences in spike rate, while high values of $q$ cause the distance to measure differences in the precise timing of spikes.",
            "answer": "$$\\boxed{2.6}$$"
        }
    ]
}