{
    "hands_on_practices": [
        {
            "introduction": "本练习将探索环形吸引子网络的一个基本特性：如何形成一个稳定的、局部化的活动“凸起” (bump)。我们将使用一个带有尖锐阈值非线性的简化模型，来解析地推导出凸起宽度与网络参数之间的关系。这个练习能让您清晰直观地理解局部兴奋和全局抑制之间的平衡是如何塑造网络稳态活动轮廓的。",
            "id": "4016930",
            "problem": "考虑一个一维圆环上的环形吸引子的连续神经场表示，该圆环周长为 $2\\pi$，由角坐标 $\\theta \\in (-\\pi,\\pi]$ 参数化。设稳态突触输入场 $u(\\theta)$ 由平移不变的循环相互作用和均匀抑制性偏置确定，如下式所示：\n$$\nu(\\theta) = \\int_{-\\pi}^{\\pi} w(\\theta - \\theta')\\,\\phi\\big(u(\\theta')\\big)\\,d\\theta' - h,\n$$\n其中 $w(\\Delta)$ 是突触权重核，$h>0$ 是一个恒定的偏置电流。假设突触核纯粹是一阶傅里叶模式，\n$$\nw(\\Delta) = w\\,\\cos(\\Delta),\n$$\n其中 $w>0$，且神经元响应非线性是一个阈值函数，\n$$\n\\phi(u) = H(u),\n$$\n其中 $H(\\cdot)$ 是亥维赛阶跃函数，因此如果 $u>0$ 则 $\\phi(u)=1$，如果 $u\\le 0$ 则 $\\phi(u)=0$。假设网络支持一个以某个 $\\theta_0$ 为中心的局域稳态“凸起”解，使得当 $|\\theta - \\theta_0|  \\alpha$ 时 $u(\\theta)>0$，当 $|\\theta - \\theta_0| \\ge \\alpha$ 时 $u(\\theta)\\le 0$，并且 $u(\\theta)$ 在边界 $\\theta=\\theta_0\\pm\\alpha$ 处连续地穿过 0。使用此模型，推导凸起半宽 $\\alpha$ 关于参数 $w$ 和 $h$ 的精确表达式。答案以弧度表示。无需进行数值取整；请提供一个闭式解析表达式。",
            "solution": "问题要求在一个特定的环形吸引子模型中，为凸起半宽 $\\alpha$ 找出一个表达式。该模型由一个以角坐标 $\\theta \\in (-\\pi, \\pi]$ 参数化的圆环上的稳态突触输入场 $u(\\theta)$ 定义。\n\n突触输入的控制方程为：\n$$\nu(\\theta) = \\int_{-\\pi}^{\\pi} w(\\theta - \\theta')\\,\\phi\\big(u(\\theta')\\big)\\,d\\theta' - h\n$$\n问题给出了突触权重核 $w(\\Delta)$ 和神经元响应非线性 $\\phi(u)$ 的具体形式。\n权重核由下式给出：\n$$\nw(\\Delta) = w\\,\\cos(\\Delta)\n$$\n其中 $w>0$。\n\n非线性是亥维赛阶跃函数：\n$$\n\\phi(u) = H(u)\n$$\n这意味着当 $u>0$ 时 $\\phi(u)=1$，当 $u \\le 0$ 时 $\\phi(u)=0$。\n\n假设网络支持一个局域稳态“凸起”解。该解的特征是一个以某个角度 $\\theta_0$ 为中心、半宽为 $\\alpha$ 的活动区域。根据问题陈述，这意味着：\n$$\nu(\\theta) > 0 \\quad \\text{for } |\\theta - \\theta_0|  \\alpha\n$$\n$$\nu(\\theta) \\le 0 \\quad \\text{for } |\\theta - \\theta_0| \\ge \\alpha\n$$\n由此，发放率函数 $\\phi(u(\\theta'))$ 的值被确定为：\n$$\n\\phi(u(\\theta')) =\n\\begin{cases}\n1  \\text{if } |\\theta' - \\theta_0|  \\alpha \\\\\n0  \\text{if } |\\theta' - \\theta_0| \\ge \\alpha\n\\end{cases}\n$$\n由于核 $w(\\theta-\\theta')$ 的平移不变性，我们可以不失一般性地将凸起中心设在 $\\theta_0 = 0$。那么活动区域就是区间 $(-\\alpha, \\alpha)$。\n\n将 $w(\\Delta)$ 和 $\\phi(u)$ 的表达式代入控制积分方程，并将积分限调整为活动区域，我们得到：\n$$\nu(\\theta) = \\int_{-\\alpha}^{\\alpha} w\\,\\cos(\\theta - \\theta') \\cdot 1 \\,d\\theta' - h\n$$\n我们继续计算这个积分：\n$$\nu(\\theta) = w \\int_{-\\alpha}^{\\alpha} \\cos(\\theta - \\theta') \\,d\\theta' - h\n$$\n$\\cos(\\theta - \\theta')$ 关于 $\\theta'$ 的原函数是 $-\\sin(\\theta - \\theta')$。计算该定积分：\n$$\nu(\\theta) = w \\left[ -\\sin(\\theta - \\theta') \\right]_{\\theta'=-\\alpha}^{\\theta'=\\alpha} - h\n$$\n$$\nu(\\theta) = w \\left( (-\\sin(\\theta - \\alpha)) - (-\\sin(\\theta - (-\\alpha))) \\right) - h\n$$\n$$\nu(\\theta) = w \\left( -\\sin(\\theta - \\alpha) + \\sin(\\theta + \\alpha) \\right) - h\n$$\n使用三角和差化积恒等式 $\\sin(A+B) - \\sin(A-B) = 2\\cos(A)\\sin(B)$，令 $A=\\theta$ 且 $B=\\alpha$：\n$$\nu(\\theta) = w \\left( 2\\cos(\\theta)\\sin(\\alpha) \\right) - h\n$$\n因此，突触输入场的显式形式为：\n$$\nu(\\theta) = 2w\\sin(\\alpha)\\cos(\\theta) - h\n$$\n问题陈述 $u(\\theta)$ 在凸起的边界（即 $\\theta = \\pm\\alpha$）处穿过 0。我们应用这个边界条件，例如在 $\\theta = \\alpha$ 处：\n$$\nu(\\alpha) = 0\n$$\n$$\n2w\\sin(\\alpha)\\cos(\\alpha) - h = 0\n$$\n使用正弦的二倍角恒等式 $2\\sin(\\alpha)\\cos(\\alpha) = \\sin(2\\alpha)$，我们有：\n$$\nw\\sin(2\\alpha) - h = 0\n$$\n这个方程将凸起半宽 $\\alpha$ 与模型参数 $w$ 和 $h$ 联系起来。我们现在可以解出 $\\alpha$。\n$$\nw\\sin(2\\alpha) = h\n$$\n$$\n\\sin(2\\alpha) = \\frac{h}{w}\n$$\n由于 $\\alpha$ 代表一个物理半宽，我们必须有 $\\alpha > 0$。解的存在性要求 $0  h/w \\le 1$。根据问题陈述假设解存在，我们可以对等式两边取反正弦。\n$$\n2\\alpha = \\arcsin\\left(\\frac{h}{w}\\right)\n$$\n分离出 $\\alpha$ 得到最终表达式：\n$$\n\\alpha = \\frac{1}{2}\\arcsin\\left(\\frac{h}{w}\\right)\n$$\n结果以弧度为单位，因为反正弦函数（arcsin）返回的值是弧度，这与角度参数化是一致的。这个表达式就是凸起半宽的精确闭式解。",
            "answer": "$$\n\\boxed{\\frac{1}{2}\\arcsin\\left(\\frac{h}{w}\\right)}\n$$"
        },
        {
            "introduction": "在理解了稳定凸起概念的基础上，我们现在来研究这种模式是如何从一个初始均匀的状态中涌现出来的。本练习使用线性稳定性分析来确定哪种空间模式（即傅里叶模）会首先变得不稳定，从而在竞争中“胜出”，并构成活动凸起的结构。这种分析是模式形成理论的核心，它解释了网络的连接结构 ($W(\\Delta\\theta)$) 如何决定其持续活动状态的空间轮廓。",
            "id": "4016910",
            "problem": "考虑一个单神经元群体的连续环形吸引子网络，由角度 $\\theta \\in [-\\pi,\\pi)$（弧度）索引。该群体的放电率 $r(\\theta,t)$ 服从一个带有平滑饱和静态非线性的漏积分速率动力学模型，\n$$\n\\tau \\frac{\\partial r(\\theta,t)}{\\partial t} = - r(\\theta,t) + F\\!\\left( g \\int_{-\\pi}^{\\pi} W(\\theta-\\theta')\\, r(\\theta',t)\\, d\\theta' \\right),\n$$\n其中 $\\tau>0$ 是时间常数，$g>0$ 是无量纲增益，$W(\\Delta\\theta)$ 是环上的偶连接核函数，$F(x)$ 是一个标量输入-输出函数。该核函数由其截至二阶谐波的余弦傅里叶级数指定，其归一化形式可使环上的卷积算子对角化：\n$$\nW(\\Delta\\theta) = \\frac{1}{2\\pi}\\Big( J_{0} + 2 J_{1} \\cos(\\Delta\\theta) + 2 J_{2} \\cos(2\\Delta\\theta) \\Big),\n$$\n因此，对于任何余弦模式 $\\cos(k\\theta)$，卷积满足 $\\int_{-\\pi}^{\\pi} W(\\theta-\\theta') \\cos(k\\theta')\\, d\\theta' = J_{k} \\cos(k\\theta)$，其中 $k=0,1,2$。非线性函数是平滑的，并在 $x=0$ 处有泰勒展开式，\n$$\nF(x) = x - c x^{3} + \\mathcal{O}(x^{5}),\n$$\n其中 $c>0$。假设以下参数值为已知固定值：$J_{0} = 0.6$，$J_{1} = 1.2$，$J_{2} = 0.7$，$g = 1.4$ 以及 $\\tau = 1$。此外，通过对均匀态 $r(\\theta)\\equiv 0$ 的不稳定性起始点进行标准的弱非线性中心流形约简，已知对于给定的 $F$ 和 $W$，控制任何孤立余弦模式振幅方程的有效三次项系数为 $\\gamma = 0.34$。\n\n从环形卷积的基本性质和动力学系统在 $r(\\theta)=0$ 附近的线性化出发，确定哪个傅里叶模式 $k \\in \\{0,1,2\\}$ 首先变得不稳定，从而在模式选择中胜出。然后，在单一不稳定模式占主导且高次谐波在不稳定性起始点附近可忽略不计的假设下，确定由增长和三次饱和的弱非线性平衡所产生的稳态“峰”形 $r^{\\ast}(\\theta)$。将该峰形表示为 $\\theta$（以弧度为单位）的闭合形式函数。以一个包含胜出模式指数 $k$ 和 $r^{\\ast}(\\theta)$ 表达式的两元素行矩阵形式给出最终答案。无需四舍五入；请给出精确表达式。",
            "solution": "首要任务是确定当增益 $g$ 增加时，哪个傅里叶模式首先变得不稳定。这可以通过在平凡的均匀稳态 $r(\\theta) \\equiv 0$ 附近对动力学方程进行线性化来完成。在 $x=0$ 附近，非线性函数 $F(x)$ 被其线性项 $F(x) \\approx x$ 近似。线性化后的动力学方程为：\n$$\n\\tau \\frac{\\partial r(\\theta,t)}{\\partial t} = - r(\\theta,t) + g \\int_{-\\pi}^{\\pi} W(\\theta-\\theta')\\, r(\\theta',t)\\, d\\theta'\n$$\n我们分析该系统对于不同傅里叶模式扰动的稳定性。考虑一个形式为 $r(\\theta, t) = A_k(t) \\cos(k\\theta)$ 的扰动。将其代入线性化方程，并利用给定的卷积性质 $\\int_{-\\pi}^{\\pi} W(\\theta-\\theta') \\cos(k\\theta') d\\theta' = J_k \\cos(k\\theta)$：\n$$\n\\tau \\frac{d}{dt} \\left( A_k(t) \\cos(k\\theta) \\right) = -A_k(t) \\cos(k\\theta) + g A_k(t) J_k \\cos(k\\theta)\n$$\n两边同除以 $\\cos(k\\theta)$（它几乎处处非零），我们得到关于每个模式振幅 $A_k(t)$ 的线性常微分方程：\n$$\n\\tau \\frac{dA_k}{dt} = (g J_k - 1) A_k(t)\n$$\n振幅的时间演化为 $A_k(t) = A_k(0) \\exp\\left( \\frac{\\lambda_k t}{\\tau} \\right)$，其中 $\\lambda_k = gJ_k - 1$ 是模式 $k$ 的增长率（特征值）。当一个模式的增长率 $\\lambda_k$ 变为正值时，即 $gJ_k > 1$，该模式变得不稳定。当 $g$ 从 $0$ 开始增加时，首先变得不稳定的模式是需要最小临界增益 $g_c^{(k)} = 1/J_k$ 的模式。这对应于连接核具有最大特征值 $J_k$ 的模式。\n\n给定的核特征值为：\n-   $J_0 = 0.6$\n-   $J_1 = 1.2$\n-   $J_2 = 0.7$\n\n比较这些值，$J_1$ 是最大的。因此，模式 $k=1$ 是第一个变得不稳定的模式，并被选为胜出模式。我们可以在给定的增益 $g=1.4$（及 $\\tau=1$）下验证每个模式的稳定性：\n-   $\\lambda_0 = g J_0 - 1 = 1.4 \\times 0.6 - 1 = 0.84 - 1 = -0.16$ (稳定)\n-   $\\lambda_1 = g J_1 - 1 = 1.4 \\times 1.2 - 1 = 1.68 - 1 = 0.68$ (不稳定)\n-   $\\lambda_2 = g J_2 - 1 = 1.4 \\times 0.7 - 1 = 0.98 - 1 = -0.02$ (稳定)\n\n只有 $k=1$ 模式是不稳定的，这证实了它是形成模式的模式。\n\n第二个任务是确定涌现出的稳态“峰”形 $r^*(\\theta)$。在不稳定性起始点附近（即 $g$ 略高于临界值 $g_c^{(1)} = 1/J_1$ 时），胜出模式的振幅动力学（我们称之为 $A(t)$）由一个斯图尔特-朗道方程（Stuart-Landau equation）控制。问题陈述中指出，该方程的有效三次项系数为 $\\gamma = 0.34$。振幅方程为：\n$$\n\\tau \\frac{dA}{dt} = \\lambda_1 A - \\gamma A^3\n$$\n这里，$A(t)$ 表示放电率分布中 $\\cos(\\theta)$ 模式的振幅，因此有 $r(\\theta, t) \\approx A(t) \\cos(\\theta)$。由于系统的旋转对称性，不失一般性地将余弦的相位设为零。\n\n为了找到稳态“峰”形 $r^*(\\theta)$，我们需求解振幅方程的非平凡稳态解，此时 $\\frac{dA}{dt} = 0$。\n$$\n0 = \\lambda_1 A - \\gamma A^3 = A (\\lambda_1 - \\gamma A^2)\n$$\n该方程有平凡解 $A=0$（均匀态）和一个关于饱和振幅 $A_{ss}$ 的非平凡解：\n$$\nA_{ss}^2 = \\frac{\\lambda_1}{\\gamma}\n$$\n振幅必须是实数，这要求 $\\lambda_1 > 0$。我们已经证实了这一点。代入已知值：\n-   $\\lambda_1 = 0.68$\n-   $\\gamma = 0.34$\n\n我们可以计算稳态振幅的平方：\n$$\nA_{ss}^2 = \\frac{0.68}{0.34} = 2\n$$\n因此，稳态振幅为：\n$$\nA_{ss} = \\sqrt{2}\n$$\n在忽略高次谐波的假设下，稳态“峰”形是一个具有此振幅的纯余弦函数：\n$$\nr^*(\\theta) = A_{ss} \\cos(\\theta) = \\sqrt{2} \\cos(\\theta)\n$$\n\n最终答案需要胜出模式的指数，即 $k=1$，以及稳态“峰”形的表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\sqrt{2}\\cos(\\theta) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在真实的神经系统中，噪声是不可避免的。本练习将检验神经元噪声对活动凸起稳定性的影响。您将推导单个神经元层面的微观独立噪声如何转化为凸起位置的宏观随机“漂移”——这一现象被称为沿吸引子的扩散。理解这一过程对于评估环形吸引子网络作为神经积分器或工作记忆系统的可靠性和精确度至关重要。",
            "id": "4016944",
            "problem": "考虑一个一维连续环形吸引子网络，该网络支持一个局域活动“鼓包”，其中心可由圆上的角度 $\\,\\theta(t)\\,$ 参数化。神经元群体由一个偏好角度 $\\,\\phi \\in [0, 2\\pi)\\,$ 索引。在连续极限下，发放率动力学由一个一阶线性时不变方程建模，该方程包含一个在环上平移不变的突触核和一个加性高斯白噪声驱动。设稳态鼓包轮廓可由一阶傅里叶模式 $\\,r^*(\\phi - \\theta) = R_0 + R_1 \\cos(\\phi - \\theta)\\,$ 很好地近似，其中 $\\,R_0\\,$ 和 $\\,R_1\\,$ 是正常数。时间动力学具有单神经元时间常数 $\\,\\tau  0\\,$ 和每个神经元独立的白噪声驱动 $\\,\\eta_i(t)\\,$，其均值为零，强度为 $\\,q\\,$，使得 $\\,\\mathbb{E}[\\eta_i(t)\\eta_j(t')] = q \\,\\delta_{ij}\\,\\delta(t-t')\\,$，其中 $\\,i,j \\in \\{1,\\dots,N\\}\\,$ 索引了在环上均匀分布的 $\\,N\\,$ 个神经元。假设在连续极限下突触核是自伴的，因此平移模式是中性稳定的。\n\n一个速度调制的外部驱动产生具有有效增益 $\\,k\\,$ 的相位演化，因此输入角速度 $\\,\\omega\\,$ 为相速度引入一个确定性漂移贡献 $\\,k\\,\\omega\\,$。在持续时间为 $\\,T  0\\,$ 的有限时间窗口内，通过以下形式的随机微分方程来建模涌现的相位动力学：\n$$\nd\\theta(t) = k\\,\\omega\\,dt + \\sqrt{2D}\\,dW_t,\n$$\n其中 $\\,D\\,$ 是有效角扩散系数，$\\,W_t\\,$ 是一个标准维纳过程。您可以假设在所考虑的时间窗口内，角度不会发生环绕。\n\n您的任务是：\n- 从发放率动力学、鼓包拟设 $\\,r^*(\\phi-\\theta)\\,$ 以及鼓包周围线性化算子的自伴性出发，通过将每个神经元的独立噪声投影到平移（Goldstone）模上，推导相位变量 $\\,\\theta(t)\\,$ 的有效扩散系数 $\\,D\\,$。请用 $\\,N\\,$, $\\,\\tau\\,$, $\\,R_1\\,$ 和 $\\,q\\,$ 表示 $\\,D\\,$，单位为 $\\text{radians}^2/\\text{second}$。\n- 使用推导出的 $\\,D\\,$，在长度为 $\\,T\\,$ 的窗口上计算以下量：\n  1. 预期确定性角漂移的大小，$\\,|k\\,\\omega\\,T|\\,$，单位为 $\\text{radians}$。\n  2. 随机角漂移的标准差，$\\,\\sqrt{2DT}\\,$，单位为 $\\text{radians}$。\n  3. 相对于刺激角度 $\\,\\theta_s(T) = \\omega T\\,$ 的预期均方根追踪误差，定义为\n     $$\n     \\mathrm{RMSE}(T) = \\sqrt{\\big((k-1)\\,\\omega\\,T\\big)^2 + 2DT},\n     $$\n     单位为 $\\text{radians}$。\n  4. 在时间 $\\,T\\,$，绝对追踪误差在容差 $\\,\\delta\\,$ 内的概率，即 $\\,\\mathbb{P}\\big(|\\theta(T)-\\theta_s(T)| \\le \\delta\\big)\\,$，在误差分布的高斯近似下处理。将此概率表示为 $[0,1]$ 范围内的十进制小数。\n\n所有角度必须以 $\\text{radians}$（弧度）表示，所有时间量以 $\\text{seconds}$（秒）表示，概率以十进制小数表示。\n\n您的程序必须实现上述计算，并为以下参数集测试套件 $\\,\\{(N,\\tau,R_1,q,\\omega,k,T,\\delta)\\}\\,$ 生成结果：\n\n- 测试用例 1 (一般情况): $\\,N=1000\\,$, $\\,\\tau=0.02\\,$, $\\,R_1=8\\,$, $\\,q=1.0\\,$, $\\,\\omega=0.5\\,$, $\\,k=1.0\\,$, $\\,T=1.0\\,$, $\\,\\delta=0.2\\,$.\n- 测试用例 2 (零噪声，增益失准边界): $\\,N=1200\\,$, $\\,\\tau=0.02\\,$, $\\,R_1=10\\,$, $\\,q=0.0\\,$, $\\,\\omega=0.3\\,$, $\\,k=0.9\\,$, $\\,T=2.0\\,$, $\\,\\delta=0.05\\,$.\n- 测试用例 3 (高噪声，静态刺激): $\\,N=200\\,$, $\\,\\tau=0.05\\,$, $\\,R_1=6\\,$, $\\,q=4.0\\,$, $\\,\\omega=0.0\\,$, $\\,k=1.0\\,$, $\\,T=1.5\\,$, $\\,\\delta=0.4\\,$.\n- 测试用例 4 (大网络，强鼓包，增益过大): $\\,N=5000\\,$, $\\,\\tau=0.01\\,$, $\\,R_1=15\\,$, $\\,q=0.5\\,$, $\\,\\omega=1.2\\,$, $\\,k=1.05\\,$, $\\,T=0.75\\,$, $\\,\\delta=0.3\\,$.\n\n您的程序应生成单行输出，其中包含一个以方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含四个值的子列表 $[|k\\omega T|,\\sqrt{2DT},\\mathrm{RMSE}(T),\\mathbb{P}(|\\theta(T)-\\theta_s(T)| \\le \\delta)]$。例如，输出格式必须如下所示：\n```\n[\\,[d_1,s_1,r_1,p_1],[d_2,s_2,r_2,p_2],[d_3,s_3,r_3,p_3],[d_4,s_4,r_4,p_4]\\,]\n```",
            "solution": "解决方案分为两部分：首先，推导角扩散系数 D，其次，计算所需的量。\n\n**第 1 部分：角扩散系数 D 的推导**\n\n网络的状态由 $N$ 个神经元的发放率描述，记为向量 $\\mathbf{r}(t) = (r_1(t), \\dots, r_N(t))^T$。动力学由一个朗之万方程组控制，通常可以写成：\n$$\n\\tau \\frac{d\\mathbf{r}}{dt} = \\mathbf{F}(\\mathbf{r}) + \\boldsymbol{\\eta}(t)\n$$\n其中 $\\tau$ 是单神经元时间常数，$\\mathbf{F}(\\mathbf{r})$ 代表动力学的确定性部分（自耦合、突触相互作用和外部输入），$\\boldsymbol{\\eta}(t)$ 是独立白噪声项的向量，满足 $\\mathbb{E}[\\eta_i(t)\\eta_j(t')] = q\\,\\delta_{ij}\\,\\delta(t-t')$。\n\n由于平移不变的连接性，网络拥有一族连续的稳态（一个吸引子流形），这些稳态是局域的活动“鼓包”。这些状态 $\\mathbf{r}^*$ 可以由相角 $\\theta$ 参数化。问题给出了连续极限下鼓包轮廓的拟设：$r^*(\\phi - \\theta) = R_0 + R_1 \\cos(\\phi - \\theta)$。对于具有偏好角度 $\\phi_i = 2\\pi(i-1)/N$ 的 $N$ 个离散神经元，神经元 $i$ 的稳态发放率为 $r_i^*(\\theta) = R_0 + R_1 \\cos(\\phi_i - \\theta)$。\n\n噪声的影响是使系统状态沿吸引子流形扩散。这种扩散对应于相角 $\\theta(t)$ 的随机游走。为了找到 $\\theta(t)$ 的动力学，我们将噪声项 $\\boldsymbol{\\eta}(t)$ 投影到沿吸引子平移的方向上。这个方向由“Goldstone 模”给出，即流形的切向量：\n$$\n\\mathbf{u}_0(\\theta) = \\frac{d\\mathbf{r}^*(\\theta)}{d\\theta}\n$$\n该向量的第 $i$ 个分量是：\n$$\nu_{0,i}(\\theta) = \\frac{d}{d\\theta} \\left( R_0 + R_1 \\cos(\\phi_i - \\theta) \\right) = R_1 \\sin(\\phi_i - \\theta)\n$$\n相位 $\\theta$ 因噪声引起的演化是通过将神经动力学投影到线性化动力学矩阵的零左特征向量上来确定的。问题指出突触核是自伴的，这意味着左右特征向量是相同的。零特征向量是 Goldstone 模 $\\mathbf{u}_0(\\theta)$。投影得到 $\\theta$ 的随机微分方程（在没有确定性漂移的情况下）：\n$$\n\\frac{d\\theta}{dt} = \\frac{\\mathbf{u}_0(\\theta) \\cdot \\boldsymbol{\\eta}(t)}{\\tau ||\\mathbf{u}_0(\\theta)||^2}\n$$\n驱动相位的有效噪声是 $\\xi(t) = \\frac{d\\theta}{dt}$。我们将其与形式 $d\\theta = \\sqrt{2D} dW_t$ 进行比较，这意味着 $\\mathbb{E}[\\xi(t)\\xi(t')] = 2D \\delta(t-t')$。让我们计算我们推导的 $\\xi(t)$ 的自相关：\n$$\n\\mathbb{E}[\\xi(t)\\xi(t')] = \\mathbb{E}\\left[ \\left(\\frac{\\sum_i u_{0,i} \\eta_i(t)}{\\tau ||\\mathbf{u}_0||^2}\\right) \\left(\\frac{\\sum_j u_{0,j} \\eta_j(t')}{\\tau ||\\mathbf{u}_0||^2}\\right) \\right] = \\frac{1}{\\tau^2 ( ||\\mathbf{u}_0||^2 )^2} \\sum_{i,j} u_{0,i} u_{0,j} \\mathbb{E}[\\eta_i(t)\\eta_j(t')]\n$$\n代入噪声相关性 $\\mathbb{E}[\\eta_i(t)\\eta_j(t')] = q \\delta_{ij} \\delta(t-t')$：\n$$\n\\mathbb{E}[\\xi(t)\\xi(t')] = \\frac{q \\delta(t-t')}{\\tau^2 ( ||\\mathbf{u}_0||^2 )^2} \\sum_{i,j} u_{0,i} u_{0,j} \\delta_{ij} = \\frac{q \\delta(t-t')}{\\tau^2 ( ||\\mathbf{u}_0||^2 )^2} \\sum_i u_{0,i}^2 = \\frac{q \\delta(t-t')}{\\tau^2 ||\\mathbf{u}_0||^2}\n$$\n将此结果与 $\\mathbb{E}[\\xi(t)\\xi(t')] = 2D \\delta(t-t')$ 进行比较，我们得到：\n$$\n2D = \\frac{q}{\\tau^2 ||\\mathbf{u}_0||^2} \\implies D = \\frac{q}{2\\tau^2 ||\\mathbf{u}_0||^2}\n$$\n最后一步是计算 Goldstone 模的范数平方，$||\\mathbf{u}_0||^2 = \\sum_{i=1}^N u_{0,i}^2$：\n$$\n||\\mathbf{u}_0||^2 = \\sum_{i=1}^N \\left( R_1 \\sin(\\phi_i - \\theta) \\right)^2 = R_1^2 \\sum_{i=1}^N \\sin^2(\\phi_i - \\theta)\n$$\n对于均匀分布在环上的神经元，求和 $\\sum_{i=1}^N \\sin^2(x + 2\\pi (i-1)/N)$ 是一个标准的三角函数求和。对于任意 $x$ 和 $N>2$，此和的值为 $N/2$。因此：\n$$\n||\\mathbf{u}_0||^2 = R_1^2 \\frac{N}{2}\n$$\n将此代入 $D$ 的表达式中：\n$$\nD = \\frac{q}{2\\tau^2 \\left( R_1^2 \\frac{N}{2} \\right)} = \\frac{q}{N \\tau^2 R_1^2}\n$$\n这就是所求的有效角扩散系数的表达式，单位为 $\\text{radians}^2/\\text{second}$。\n\n**第 2 部分：导出量的计算**\n\n在建立了 $D$ 的公式后，我们可以为每个参数集计算四个所需的量。\n\n1.  **预期确定性角漂移的大小**：随机微分方程 $d\\theta(t) = k\\,\\omega\\,dt + \\sqrt{2D}\\,dW_t$ 表明，演化的确定性部分是 $d\\theta_{det} = k\\omega dt$。在持续时间为 $T$ 的时间窗口上积分，总的确定性漂移为 $\\Delta\\theta_{det} = k\\omega T$。其大小为 $|k\\omega T|$。\n\n2.  **随机角漂移的标准差**：演化的随机部分是 $d\\theta_{stoch} = \\sqrt{2D} dW_t$。在时间 $T$ 的总随机漂移是伊藤积分 $\\Delta\\theta_{stoch}(T) = \\int_0^T \\sqrt{2D} dW_t = \\sqrt{2D} W_T$。维纳过程 $W_T$ 是一个均值为 $0$、方差为 $T$ 的高斯随机变量。因此，$\\Delta\\theta_{stoch}(T)$ 是一个均值为 $\\mathbb{E}[\\Delta\\theta_{stoch}(T)] = 0$、方差为 $\\text{Var}(\\Delta\\theta_{stoch}(T)) = \\mathbb{E}[(\\sqrt{2D} W_T)^2] = 2D \\mathbb{E}[W_T^2] = 2DT$ 的高斯随机变量。标准差是方差的平方根，即 $\\sigma_{stoch}(T) = \\sqrt{2DT}$。\n\n3.  **均方根追踪误差**：追踪误差定义为 $E(T) = \\theta(T) - \\theta_s(T)$，其中 $\\theta_s(T) = \\omega T$。假设 $\\theta(0) = \\theta_s(0) = 0$，随机微分方程的解是 $\\theta(T) = k\\omega T + \\sqrt{2D}W_T$。误差为：\n    $$\n    E(T) = (k\\omega T + \\sqrt{2D}W_T) - \\omega T = (k-1)\\omega T + \\sqrt{2D}W_T\n    $$\n    误差 $E(T)$ 是一个高斯随机变量。其均值（偏差）是 $\\mu_E = \\mathbb{E}[E(T)] = (k-1)\\omega T$。其方差是 $\\sigma_E^2 = \\text{Var}(E(T)) = 2DT$。均方误差 (MSE) 是 $\\mathbb{E}[E(T)^2] = (\\mu_E)^2 + \\sigma_E^2$。均方根误差 (RMSE) 是：\n    $$\n    \\mathrm{RMSE}(T) = \\sqrt{\\mathbb{E}[E(T)^2]} = \\sqrt{((k-1)\\omega T)^2 + 2DT}\n    $$\n    这与问题陈述中提供的公式相符。\n\n4.  **追踪误差在容差内的概率**：我们需要计算 $\\mathbb{P}(|E(T)| \\le \\delta)$。由于 $E(T) \\sim \\mathcal{N}(\\mu_E, \\sigma_E^2)$，我们可以对变量进行标准化。设 $Z = (E(T) - \\mu_E)/\\sigma_E \\sim \\mathcal{N}(0,1)$。\n    $$\n    \\mathbb{P}(-\\delta \\le E(T) \\le \\delta) = \\mathbb{P}\\left(\\frac{-\\delta - \\mu_E}{\\sigma_E} \\le Z \\le \\frac{\\delta - \\mu_E}{\\sigma_E}\\right)\n    $$\n    此概率由标准正态分布的累积分布函数 (CDF) $\\Phi(z)$ 的差给出：\n    $$\n    P = \\Phi\\left(\\frac{\\delta - \\mu_E}{\\sigma_E}\\right) - \\Phi\\left(\\frac{-\\delta - \\mu_E}{\\sigma_E}\\right)\n    $$\n    其中 $\\mu_E=(k-1)\\omega T$ 且 $\\sigma_E=\\sqrt{2DT}$。CDF 可以使用误差函数 $\\text{erf}(x)$ 计算，即 $\\Phi(z) = \\frac{1}{2}(1 + \\text{erf}(z/\\sqrt{2}))$。这导致：\n    $$\n    P = \\frac{1}{2}\\left[\\text{erf}\\left(\\frac{\\delta - \\mu_E}{\\sigma_E\\sqrt{2}}\\right) - \\text{erf}\\left(\\frac{-\\delta - \\mu_E}{\\sigma_E\\sqrt{2}}\\right)\\right]\n    $$\n    如果噪声强度 $q=0$，则 $D=0$ 且 $\\sigma_E = 0$。在这种情况下，误差是确定性的，$E(T) = \\mu_E$。如果 $|\\mu_E| \\le \\delta$，则概率为 $1$，否则为 $0$。\n\n实现将为每个测试用例计算这四个量。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the ring attractor problem for the given test cases.\n    It first calculates the diffusion coefficient D and then computes\n    the four required metrics: deterministic drift, stochastic drift standard\n    deviation, RMSE, and the probability of the tracking error being within\n    a tolerance.\n    \"\"\"\n    test_cases = [\n        # (N, tau, R1, q, omega, k, T, delta)\n        (1000, 0.02, 8., 1.0, 0.5, 1.0, 1.0, 0.2),   # Test case 1\n        (1200, 0.02, 10., 0.0, 0.3, 0.9, 2.0, 0.05),  # Test case 2\n        (200, 0.05, 6., 4.0, 0.0, 1.0, 1.5, 0.4),    # Test case 3\n        (5000, 0.01, 15., 0.5, 1.2, 1.05, 0.75, 0.3)  # Test case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, tau, R1, q, omega, k, T, delta = case\n\n        # Derived formula for the angular diffusion coefficient D.\n        # D = q / (N * tau^2 * R1^2)\n        # Denominator will not be zero based on problem constraints (N>0, tau>0, R1>0)\n        # but q can be zero.\n        if q == 0.0:\n            D = 0.0\n        else:\n            D = q / (N * tau**2 * R1**2)\n\n        # 1. Expected deterministic angular drift magnitude\n        deterministic_drift_mag = np.abs(k * omega * T)\n\n        # 2. Standard deviation of the stochastic angular drift\n        stochastic_drift_std = np.sqrt(2 * D * T)\n\n        # 3. Root-mean-square tracking error\n        mean_error_sq = ((k - 1) * omega * T)**2\n        variance_error = 2 * D * T\n        rmse = np.sqrt(mean_error_sq + variance_error)\n\n        # 4. Probability that the absolute tracking error is within a tolerance delta\n        mean_error = (k - 1) * omega * T\n        std_error = np.sqrt(variance_error)\n        \n        if std_error == 0.0:\n            # Deterministic case (zero noise)\n            probability = 1.0 if np.abs(mean_error) = delta else 0.0\n        else:\n            # Standard Normal CDF is Phi(x) = 0.5 * (1 + erf(x / sqrt(2)))\n            z_upper = (delta - mean_error) / std_error\n            z_lower = (-delta - mean_error) / std_error\n            \n            prob_upper = 0.5 * (1 + erf(z_upper / np.sqrt(2)))\n            prob_lower = 0.5 * (1 + erf(z_lower / np.sqrt(2)))\n            \n            probability = prob_upper - prob_lower\n            \n        results.append([\n            deterministic_drift_mag,\n            stochastic_drift_std,\n            rmse,\n            probability\n        ])\n\n    # Format the final output as a string representing a list of lists.\n    # e.g., [[val1,val2,...], [val1,val2,...]]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}