{
    "hands_on_practices": [
        {
            "introduction": "我们的实践之旅始于房室模型最基本的单元：单个等电位房室。这个练习将引导你从第一性原理出发，为一个代表球形胞体的简化神经元计算其关键的电学特性。通过将生物物理参数（如膜电阻和电容）与几何形状联系起来，你将亲手计算出膜时间常数（$\\tau_m$）和输入电阻，这是理解任何神经元如何响应输入电流的基础。",
            "id": "3969770",
            "problem": "考虑一个代表球形神经元胞体的单个等电位房室，其半径为 $r=10\\,\\mu\\text{m}$，无树突，且与其他房室无轴向耦合（封闭末端边界）。该膜是被动的、线性的且空间均匀的，其特征为比膜电容 $c_{m}=1\\,\\mu\\text{F}/\\text{cm}^{2}$ 和比膜电阻 $R_{m}=20\\,\\text{k}\\Omega\\cdot\\text{cm}^{2}$。一个幅值为 $I=0.1\\,\\text{nA}$ 的直流阶跃电流被均匀注入到整个胞体膜上。仅使用适用于房室模型的第一性原理，即：(i) 表面积的几何关系，(ii) 根据比膜参数值和膜面积 $A$ 来定义总膜电容 $C$ 和总膜电阻 $R$，以及 (iii) 阻容 (RC) 元件的欧姆定律和电荷-电压关系，推导膜时间常数 $\\tau_{m}$ 和相对于静息电位的稳态电压偏转 $\\Delta V_{\\infty}$ 的表达式，并在这些假设下计算它们的数值。在整个瞬态和稳态过程中，将胞体视为等电位。将您的最终数值四舍五入到四位有效数字。以秒为单位表示 $\\tau_{m}$，以毫伏为单位表示 $\\Delta V_{\\infty}$。",
            "solution": "该问题陈述已经过验证，被认为是有效的。它具有科学依据、良定、客观且内部一致。所有必要信息均已提供，可用于使用计算神经科学和电路理论的既定原理推导出唯一且有意义的解。\n\n神经元胞体被建模为单个等电位房室。在给定假设（被动、线性膜）下，该房室在电学上等效于一个并联电阻-电容 (RC) 电路。注入的电流 $I$ 分布在膜电容和膜电阻之间。\n\n根据基尔霍夫电流定律，总注入电流 $I$ 必须等于流过电阻通路上的电流 $I_{R}$ 和流过电容通路上的电流 $I_{C}$ 的总和：\n$$I = I_{R} + I_{C}$$\n设 $V(t)$ 为膜电位与静息电位的差值。电阻电流 $I_{R}$ 遵循欧姆定律，其中 $R$ 是胞体的总膜电阻：\n$$I_{R} = \\frac{V(t)}{R}$$\n电容电流 $I_{C}$ 与电容器两端电压的变化率有关，其中 $C$ 是胞体的总膜电容：\n$$I_{C} = C \\frac{dV(t)}{dt}$$\n将这些表达式代入电流平衡方程，得到控制膜电位的一阶线性常微分方程：\n$$I = \\frac{V(t)}{R} + C \\frac{dV(t)}{dt}$$\n两边乘以 $R$ 并重新排列，得到标准形式：\n$$RC \\frac{dV(t)}{dt} + V(t) = RI$$\n该方程描述了 RC 电路的充电过程。\n\n**1. 膜时间常数 ($\\tau_{m}$) 的推导**\n\n膜时间常数 $\\tau_{m}$ 定义为总膜电阻 $R$ 和总膜电容 $C$ 的乘积：\n$$\\tau_{m} = RC$$\n问题给出了比膜电阻 $R_{m}$（单位为电阻 $\\times$ 面积）和比膜电容 $c_{m}$（单位为电容 / 面积）。总电阻和总电容通过膜的总表面积 $A$ 与这些比值相关联。\n总电容与面积成正比：\n$$C = c_{m} A$$\n总电阻与面积成反比：\n$$R = \\frac{R_{m}}{A}$$\n将这些代入 $\\tau_{m}$ 的表达式中：\n$$\\tau_{m} = \\left(\\frac{R_{m}}{A}\\right) (c_{m} A) = R_{m} c_{m}$$\n这个关键结果表明，对于均匀的被动膜，时间常数是膜本身的内在属性，与房室的大小或几何形状无关。\n\n我们现在计算 $\\tau_{m}$ 的数值。首先，我们将给定的参数转换为国际单位制基本单位（米、秒、欧姆、法拉）。\n已知：$R_{m} = 20\\,\\text{k}\\Omega\\cdot\\text{cm}^{2}$ 和 $c_{m} = 1\\,\\mu\\text{F}/\\text{cm}^{2}$。\n$$R_{m} = 20 \\times 10^{3} \\, \\Omega \\cdot (10^{-2} \\, \\text{m})^{2} = 20 \\times 10^{3} \\times 10^{-4} \\, \\Omega\\cdot\\text{m}^{2} = 2 \\, \\Omega\\cdot\\text{m}^{2}$$\n$$c_{m} = 1 \\times 10^{-6} \\, \\text{F} / (10^{-2} \\, \\text{m})^{2} = 1 \\times 10^{-6} \\times 10^{4} \\, \\text{F}/\\text{m}^{2} = 10^{-2} \\, \\text{F}/\\text{m}^{2}$$\n现在，我们可以计算 $\\tau_{m}$：\n$$\\tau_{m} = R_{m} c_{m} = (2 \\, \\Omega\\cdot\\text{m}^{2}) \\times (10^{-2} \\, \\text{F}/\\text{m}^{2}) = 0.02 \\, \\Omega\\cdot\\text{F}$$\n因为 $1 \\, \\Omega \\cdot \\text{F} = 1 \\, \\text{s}$，所以时间常数为：\n$$\\tau_{m} = 0.02 \\, \\text{s}$$\n题目要求四舍五入到四位有效数字，所以 $\\tau_{m} = 0.02000 \\, \\text{s}$。\n\n**2. 稳态电压偏转 ($\\Delta V_{\\infty}$) 的推导**\n\n稳态电压偏转 $\\Delta V_{\\infty}$ 是当时间 $t \\to \\infty$ 时 $V(t)$ 的值。在稳态下，膜电位是恒定的，所以其时间导数为零：\n$$\\frac{dV(t)}{dt} \\to 0 \\quad \\text{as} \\quad t \\to \\infty$$\n在此条件下，微分方程 $RC \\frac{dV(t)}{dt} + V(t) = RI$ 简化为：\n$$V(\\infty) = RI$$\n这就是稳态解。我们将此偏转表示为 $\\Delta V_{\\infty}$：\n$$\\Delta V_{\\infty} = RI$$\n乘积 $RI$ 表示当电容器完全充电且不再吸收电流时，膜电阻上的总电压降。$R$ 这一项通常被称为神经元的输入电阻。要计算其值，我们首先需要半径为 $r = 10 \\, \\mu\\text{m}$ 的球形胞体的表面积 $A$。\n首先，将半径转换为米：\n$$r = 10 \\, \\mu\\text{m} = 10 \\times 10^{-6} \\, \\text{m} = 10^{-5} \\, \\text{m}$$\n球体的表面积 $A$ 由以下公式给出：\n$$A = 4\\pi r^{2} = 4\\pi (10^{-5} \\, \\text{m})^{2} = 4\\pi \\times 10^{-10} \\, \\text{m}^{2}$$\n现在我们可以求出总膜电阻 $R$：\n$$R = \\frac{R_{m}}{A} = \\frac{2 \\, \\Omega\\cdot\\text{m}^{2}}{4\\pi \\times 10^{-10} \\, \\text{m}^{2}} = \\frac{1}{2\\pi \\times 10^{-10}} \\, \\Omega$$\n接下来，我们将注入电流 $I$ 转换为国际单位制基本单位：\n$$I = 0.1 \\, \\text{nA} = 0.1 \\times 10^{-9} \\, \\text{A} = 10^{-10} \\, \\text{A}$$\n最后，我们计算 $\\Delta V_{\\infty}$：\n$$\\Delta V_{\\infty} = RI = \\left(\\frac{1}{2\\pi \\times 10^{-10}} \\, \\Omega\\right) (10^{-10} \\, \\text{A}) = \\frac{1}{2\\pi} \\, \\text{V}$$\n问题要求答案以毫伏 (mV) 为单位。\n$$\\Delta V_{\\infty} = \\frac{1}{2\\pi} \\, \\text{V} \\times \\frac{1000 \\, \\text{mV}}{1 \\, \\text{V}} = \\frac{500}{\\pi} \\, \\text{mV}$$\n计算数值：\n$$\\Delta V_{\\infty} \\approx 159.154943... \\, \\text{mV}$$\n四舍五入到四位有效数字，我们得到：\n$$\\Delta V_{\\infty} = 159.2 \\, \\text{mV}$$\n\n推导出的表达式为 $\\tau_m = R_m c_m$ 和 $\\Delta V_\\infty = RI = \\frac{R_m I}{4\\pi r^2}$。计算出的数值为 $\\tau_m = 0.02000 \\, \\text{s}$ 和 $\\Delta V_\\infty = 159.2 \\, \\text{mV}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.02000 & 159.2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了单个房室的特性后，我们现在将模型在空间上进行扩展，以模拟树突。这个练习将你引入被动电缆理论，这是理解信号如何在神经元复杂的分支结构中传播的基石。你将求解稳态电缆方程，以确定电压信号如何随着距离衰减，并计算一个关键的度量——电压在树突末端与起始端的比率。",
            "id": "3969721",
            "problem": "考虑一个均匀的被动树突分支，其模型为一个一维电缆，电紧张长度 $L = 0.8$，在位置 $y = 0$ 处连接到胞体，并在其远端 $y = L$ 处密封。该树突由标准的被动电缆理论描述，假设其比轴向电阻率、膜电阻和膜电容恒定，并忽略任何主动电导。一个稳态（不随时间变化的）电流在胞体处注入，产生稳态的胞体膜电位 $V(0)$ 和沿树突的稳态轴向电压分布 $V(y)$。\n\n从电荷守恒定律出发，利用基尔霍夫电流定律以及轴向电流和膜电流的欧姆定律，推导出电缆上的稳态电压分布 $V(y)$，施加在 $y = L$ 处的密封末端边界条件，并确定远端电压与胞体电压之比 $V(L)/V(0)$（作为 $L$ 的闭合形式函数）。然后计算当 $L = 0.8$ 时该比率的值。\n\n将最终答案表示为一个无量纲数。将答案四舍五入到四位有效数字。",
            "solution": "题目要求解被动树突电缆上的稳态电压分布以及远端电压与胞体电压之比。我们首先将物理描述形式化为一个数学模型。\n\n在均匀的被动电缆中，膜电位 $V$ 作为物理距离 $x$ 和时间 $t$ 的函数，其行为由电缆方程描述：\n$$ \\tau_m \\frac{\\partial V}{\\partial t} = \\lambda^2 \\frac{\\partial^2 V}{\\partial x^2} - V $$\n其中 $\\tau_m$ 是膜时间常数，$\\lambda$ 是空间常数。电压 $V$ 定义为与静息电位的偏差。\n\n通过引入无量纲的电紧张距离 $y = x/\\lambda$，问题得以简化。通过这个变量替换，空间导数转换为 $\\frac{\\partial}{\\partial x} = \\frac{1}{\\lambda}\\frac{\\partial}{\\partial y}$ 和 $\\frac{\\partial^2}{\\partial x^2} = \\frac{1}{\\lambda^2}\\frac{\\partial^2}{\\partial y^2}$。将此代入电缆方程，得到：\n$$ \\tau_m \\frac{\\partial V}{\\partial t} = \\frac{\\partial^2 V}{\\partial y^2} - V $$\n题目指定了稳态条件，这意味着电压不随时间变化，因此 $\\frac{\\partial V}{\\partial t} = 0$。该方程简化为一个二阶常微分方程（ODE）：\n$$ \\frac{d^2 V}{d y^2} - V = 0 $$\n这个齐次线性常微分方程的通解可以写成指数函数的形式，或者为了更方便地处理本问题的边界条件，写成双曲函数的形式：\n$$ V(y) = A \\cosh(y) + B \\sinh(y) $$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n边界条件由电缆两端的状态给出，$y=0$（胞体）和 $y=L$（远端）。\n1.  在胞体处（$y=0$），电压被指定为 $V(0)$。将此应用于通解：\n    $$ V(0) = A \\cosh(0) + B \\sinh(0) $$\n    由于 $\\cosh(0)=1$ 且 $\\sinh(0)=0$，这简化为：\n    $$ A = V(0) $$\n2.  在远端（$y=L$），电缆是“密封”的。这意味着没有轴向电流流过此点。轴向电流 $I_a$ 与电压负空间导数成正比（轴突内部的欧姆定律），即 $I_a \\propto -\\frac{dV}{dy}$。因此，密封末端对应于零斜率的边界条件：\n    $$ \\frac{dV}{dy}\\bigg|_{y=L} = 0 $$\n首先，我们求 $V(y)$ 的导数，代入 $A = V(0)$：\n$$ \\frac{dV}{dy} = \\frac{d}{dy} [V(0) \\cosh(y) + B \\sinh(y)] = V(0) \\sinh(y) + B \\cosh(y) $$\n现在，我们在 $y=L$ 处应用密封末端条件：\n$$ V(0) \\sinh(L) + B \\cosh(L) = 0 $$\n求解 $B$：\n$$ B = -V(0) \\frac{\\sinh(L)}{\\cosh(L)} = -V(0) \\tanh(L) $$\n在确定了常数 $A$ 和 $B$ 后，我们可以写出电压分布 $V(y)$ 的特解：\n$$ V(y) = V(0) \\cosh(y) - V(0) \\tanh(L) \\sinh(y) $$\n这个表达式可以通过代入 $\\tanh(L) = \\frac{\\sinh(L)}{\\cosh(L)}$ 来简化：\n$$ V(y) = V(0) \\left( \\cosh(y) - \\frac{\\sinh(L)}{\\cosh(L)} \\sinh(y) \\right) $$\n$$ V(y) = \\frac{V(0)}{\\cosh(L)} \\left( \\cosh(L)\\cosh(y) - \\sinh(L)\\sinh(y) \\right) $$\n使用双曲恒等式 $\\cosh(u-v) = \\cosh(u)\\cosh(v) - \\sinh(u)\\sinh(v)$，我们得到电压分布的最终闭合形式表达式：\n$$ V(y) = V(0) \\frac{\\cosh(L-y)}{\\cosh(L)} $$\n题目要求远端电压 $V(L)$ 与胞体电压 $V(0)$ 之比。我们可以通过将 $y=L$ 代入我们推导出的电压分布来求得 $V(L)$：\n$$ V(L) = V(0) \\frac{\\cosh(L-L)}{\\cosh(L)} = V(0) \\frac{\\cosh(0)}{\\cosh(L)} $$\n由于 $\\cosh(0) = 1$，这变为：\n$$ V(L) = \\frac{V(0)}{\\cosh(L)} $$\n因此，所求的比率为：\n$$ \\frac{V(L)}{V(0)} = \\frac{1}{\\cosh(L)} $$\n这等价于双曲正割，$\\text{sech}(L)$。\n\n最后，我们对给定的电紧张长度 $L = 0.8$ 计算这个比率：\n$$ \\frac{V(L)}{V(0)} = \\frac{1}{\\cosh(0.8)} $$\n双曲余弦定义为 $\\cosh(z) = \\frac{\\exp(z) + \\exp(-z)}{2}$。对于 $z=0.8$：\n$$ \\cosh(0.8) = \\frac{\\exp(0.8) + \\exp(-0.8)}{2} \\approx \\frac{2.225540928 + 0.449328964}{2} \\approx \\frac{2.674869892}{2} \\approx 1.337434946 $$\n该比率是此值的倒数：\n$$ \\frac{V(L)}{V(0)} \\approx \\frac{1}{1.337434946} \\approx 0.7477146036 $$\n按要求将结果四舍五入到四位有效数字，得到 $0.7477$。",
            "answer": "$$\n\\boxed{0.7477}\n$$"
        },
        {
            "introduction": "到目前为止，我们关注的是稳态特性。然而，神经元的真正动态在于其随时间演化的行为。这个最终的练习将焦点转移到时间维度，要求你为一个单房室模型实现并比较两种核心的数值积分方法：显式欧拉法和Crank-Nicolson法。通过这个编码练习，你将量化数值误差，并深刻体会到在模拟神经元动态时，选择合适的积分算法对准确性和稳定性的决定性影响。",
            "id": "3969724",
            "problem": "考虑一个无源单室神经元模型，其膜电位 $V(t)$ 服从一个线性常微分方程（ODE），该方程描述了一个漏电阻-电容电路：$$C_m \\frac{dV}{dt} = -\\frac{V(t) - E_L}{R_m} + I(t),$$ 其中 $C_m$ 是膜电容，$R_m$ 是膜电阻，$E_L$ 是漏泄反转电位，$I(t)$ 是外加电流。膜时间常数定义为 $$\\tau_m = R_m C_m.$$ 假设一个亥维赛阶跃电流输入 $$I(t) = \\begin{cases}0 & \\text{for } t < 0, \\\\ I_0 & \\text{for } t \\ge 0,\\end{cases}$$ 其恒定幅值为 $I_0$。假设初始条件为 $$V(0) = E_L.$$\n\n使用以下物理上一致的参数，以国际单位制（SI）表示：$$\\tau_m = 20\\,\\text{ms},\\quad R_m = 100\\,\\text{M}\\Omega,\\quad C_m = 200\\,\\text{pF},\\quad E_L = -65\\,\\text{mV}.$$ 这些值满足 $\\tau_m = R_m C_m$。\n\n任务：\n1. 仅从上述 ODE 和定义出发，推导阶跃响应的精确解 $V(t)$ 以及稳态电位。你的推导必须基于第一性原理，不得假定任何离散化公式。\n2. 构建两种数值时间步进方案，在步长为 $\\Delta t$ 的均匀网格上逼近 $t \\in [0, T]$ 区间内的 $V(t)$：\n   - 显式欧拉法。\n   - Crank–Nicolson (CN) 法，这是一种基于梯形法则的二阶方法。不要使用或假定任何预先给定的更新公式；通过将该方法的定义应用于 ODE 来推导离散更新规则。\n3. 对于每种方案，计算在最终时间 $t = T$ 的全局误差，定义为在 $t=T$ 时数值近似解与精确解之间的绝对差，以毫伏（mV）表示。绝对误差必须以 $\\text{mV}$ 为单位，报告为一个非负实数。\n4. 在一个程序中实现这两种方案，并对下面列出的参数集，在 $T = 100\\,\\text{ms}$ 时评估全局误差。对于每个参数集，程序必须计算并报告两个数字：在 $t = 100\\,\\text{ms}$ 时的显式欧拉法绝对全局误差和 Crank–Nicolson 法绝对全局误差，均以 $\\text{mV}$ 为单位。\n\n使用以下参数集测试套件，每个参数集表示为 $(\\Delta t, I_0)$，其中 $\\Delta t$ 以毫秒为单位， $I_0$ 以纳安为单位：\n- 案例 A (正常情况，典型案例): $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.5\\,\\text{nA})$。\n- 案例 B (细网格): $(\\Delta t, I_0) = (0.1\\,\\text{ms}, 0.5\\,\\text{nA})$。\n- 案例 C (粗网格): $(\\Delta t, I_0) = (5.0\\,\\text{ms}, 0.5\\,\\text{nA})$。\n- 案例 D (接近显式欧拉法的稳定性边界但仍稳定): $(\\Delta t, I_0) = (20.0\\,\\text{ms}, 0.5\\,\\text{nA})$。\n- 案例 E (零输入边缘情况): $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.0\\,\\text{nA})$。\n- 案例 F (负阶跃对称性): $(\\Delta t, I_0) = (0.5\\,\\text{ms}, -0.5\\,\\text{nA})$。\n\n你的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。结果必须按以下顺序排列 $$[\\text{Euler}_A,\\text{CN}_A,\\text{Euler}_B,\\text{CN}_B,\\text{Euler}_C,\\text{CN}_C,\\text{Euler}_D,\\text{CN}_D,\\text{Euler}_E,\\text{CN}_E,\\text{Euler}_F,\\text{CN}_F],$$ 其中每一项都是在 $t = 100\\,\\text{ms}$ 时的绝对全局误差（以 $\\text{mV}$ 为单位），表示为浮点数。\n\n在计算过程中，所有物理量必须统一转换为国际单位制（SI）单位。不涉及角度。所有类似百分比的量如果需要，必须表示为小数；不要使用百分号。",
            "solution": "问题已经过验证。\n\n### 第 1 步：提取已知条件\n\n**控制方程：**\n膜电位 $V(t)$ 由常微分方程（ODE）控制：\n$$C_m \\frac{dV}{dt} = -\\frac{V(t) - E_L}{R_m} + I(t)$$\n\n**定义和常数：**\n- 膜电容：$C_m = 200\\,\\text{pF}$\n- 膜电阻：$R_m = 100\\,\\text{M}\\Omega$\n- 漏泄反转电位：$E_L = -65\\,\\text{mV}$\n- 膜时间常数：$\\tau_m = R_m C_m = 20\\,\\text{ms}$\n\n**输入电流：**\n施加一个亥维赛阶跃电流：\n$$I(t) = \\begin{cases}0 & \\text{for } t < 0, \\\\ I_0 & \\text{for } t \\ge 0,\\end{cases}$$\n其中 $I_0$ 是一个恒定幅值。\n\n**初始条件：**\n$$V(0) = E_L$$\n\n**任务：**\n1.  推导阶跃响应的精确解 $V(t)$ 和稳态电位。\n2.  推导显式欧拉法和 Crank-Nicolson 数值方法的更新规则。\n3.  对每种方案，计算在最终时间 $T = 100\\,\\text{ms}$ 的全局误差，定义为在 $T$ 时数值解与精确解之间的绝对差，以毫伏为单位。\n4.  实现这两种方案，并对给定的参数测试套件 $(\\Delta t, I_0)$ 评估全局误差。\n\n**测试套件：**\n所有案例的最终时间：$T = 100\\,\\text{ms}$。\n- 案例 A: $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.5\\,\\text{nA})$\n- 案例 B: $(\\Delta t, I_0) = (0.1\\,\\text{ms}, 0.5\\,\\text{nA})$\n- 案例 C: $(\\Delta t, I_0) = (5.0\\,\\text{ms}, 0.5\\,\\text{nA})$\n- 案例 D: $(\\Delta t, I_0) = (20.0\\,\\text{ms}, 0.5\\,\\text{nA})$\n- 案例 E: $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.0\\,\\text{nA})$\n- 案例 F: $(\\Delta t, I_0) = (0.5\\,\\text{ms}, -0.5\\,\\text{nA})$\n\n### 第 2 步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题描述了漏电积分-发放模型，这是计算神经科学中一个基础且广泛使用的模型。控制方程是标准的 RC 电路方程，是电气工程和生物物理学的基石。所有参数都具有物理意义，其数值在现实的生物物理范围内。一致性检查 $R_m C_m = (100 \\times 10^6\\,\\Omega) \\times (200 \\times 10^{-12}\\,\\text{F}) = 20 \\times 10^{-3}\\,\\text{s} = 20\\,\\text{ms}$ 证实了所提供数据的内部一致性。该问题是科学合理的。\n-   **适定性**：该问题提供了一个具有明确初始条件的一阶线性常微分方程。对于给定的输入电流，存在唯一且稳定的解。任务是具体的，并能导出一组唯一的数值结果。该问题是适定的。\n-   **客观性**：问题使用精确的数学和物理术语陈述。任务是定量的、明确的。不需要主观解释。该问题是客观的。\n-   **未检测到其他缺陷**：该问题是自洽的、可形式化的和计算上可行的。这是将数值方法应用于生物物理模型的一个标准练习。\n\n### 第 3 步：结论与行动\n\n问题陈述是**有效的**。将提供解决方案。\n\n### 解法推导\n\n分析从给定的 ODE 开始，所有计算均在国际单位制（SI）基本单位下进行。\n\n**1. 精确解析解**\n\n单室模型的控制 ODE 是：\n$$C_m \\frac{dV}{dt} = -\\frac{V(t) - E_L}{R_m} + I(t)$$\n使用膜时间常数的定义 $\\tau_m = R_m C_m$，我们可以重写该方程。两边乘以 $R_m$ 得到：\n$$R_m C_m \\frac{dV}{dt} = -(V(t) - E_L) + R_m I(t)$$\n$$\\tau_m \\frac{dV}{dt} = -V(t) + E_L + R_m I(t)$$\n这是一个一阶线性非齐次 ODE。对于 $t \\ge 0$，输入电流 $I(t)$ 是一个常数 $I_0$。我们可以将方程重排为标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$：\n$$\\frac{dV}{dt} + \\frac{1}{\\tau_m}V(t) = \\frac{E_L + R_m I_0}{\\tau_m}$$\n我们定义稳态电位 $V_{\\infty}$ 为当 $\\frac{dV}{dt} = 0$ 时达到的电位：\n$$0 = -V_{\\infty} + E_L + R_m I_0 \\implies V_{\\infty} = E_L + R_m I_0$$\n将 $V_{\\infty}$ 代回 ODE 得到一个更紧凑的形式：\n$$\\frac{dV}{dt} = \\frac{V_{\\infty} - V(t)}{\\tau_m}$$\n这个方程是可分离的：\n$$\\frac{dV}{V_{\\infty} - V} = \\frac{dt}{\\tau_m}$$\n对两边从初始状态 $(t=0, V=V(0)=E_L)$ 积分到一个一般状态 $(t, V=V(t))$：\n$$\\int_{E_L}^{V(t)} \\frac{dV'}{V_{\\infty} - V'} = \\int_0^t \\frac{dt'}{\\tau_m}$$\n$$[-\\ln|V_{\\infty} - V'|]_{E_L}^{V(t)} = \\frac{t}{\\tau_m}$$\n$$-\\ln|V_{\\infty} - V(t)| + \\ln|V_{\\infty} - E_L| = \\frac{t}{\\tau_m}$$\n$$\\ln\\left(\\frac{V_{\\infty} - E_L}{V_{\\infty} - V(t)}\\right) = \\frac{t}{\\tau_m}$$\n对两边取指数：\n$$\\frac{V_{\\infty} - E_L}{V_{\\infty} - V(t)} = e^{t/\\tau_m}$$\n求解 $V(t)$：\n$$V_{\\infty} - V(t) = (V_{\\infty} - E_L)e^{-t/\\tau_m}$$\n$$V(t) = V_{\\infty} - (V_{\\infty} - E_L)e^{-t/\\tau_m}$$\n代入 $V_{\\infty}$ 的定义并注意到 $V_{\\infty} - E_L = R_m I_0$：\n$$V(t) = (E_L + R_m I_0) - (R_m I_0)e^{-t/\\tau_m}$$\n因此，阶跃响应的精确解为：\n$$V(t) = E_L + R_m I_0 (1 - e^{-t/\\tau_m})$$\n稳态电位，可以从平衡条件 $\\frac{dV}{dt} = 0$ 推导，或通过在解中取极限 $t \\to \\infty$ 得到：\n$$V_{ss} = \\lim_{t \\to \\infty} V(t) = E_L + R_m I_0$$\n这与我们之前对 $V_{\\infty}$ 的定义一致。\n\n**2. 数值方案推导**\n\n我们将离散化简化的 ODE，$\\frac{dV}{dt} = f(V)$，其中 $f(V) = \\frac{V_{\\infty} - V}{\\tau_m}$。设 $V_n$ 是在时间 $t_n = n \\Delta t$ 时 $V(t_n)$ 的数值近似。\n\n**显式欧拉法：**\n显式（或前向）欧拉法将导数近似为前向差分：\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = f(V_n)$$\n代入我们的函数 $f(V_n)$：\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = \\frac{V_{\\infty} - V_n}{\\tau_m}$$\n求解 $V_{n+1}$ 得到更新规则：\n$$V_{n+1} = V_n + \\frac{\\Delta t}{\\tau_m}(V_{\\infty} - V_n)$$\n这可以重排为：\n$$V_{n+1} = V_n \\left(1 - \\frac{\\Delta t}{\\tau_m}\\right) + V_{\\infty} \\frac{\\Delta t}{\\tau_m}$$\n\n**Crank-Nicolson (CN) 法：**\nCrank-Nicolson 法是一种基于梯形法则的隐式方法，它对时间步开始和结束时的函数 $f(V)$ 进行平均：\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = \\frac{1}{2} (f(V_n) + f(V_{n+1}))$$\n代入我们的函数 $f(V)$：\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = \\frac{1}{2} \\left( \\frac{V_{\\infty} - V_n}{\\tau_m} + \\frac{V_{\\infty} - V_{n+1}}{\\tau_m} \\right)$$\n$$V_{n+1} - V_n = \\frac{\\Delta t}{2 \\tau_m} (2V_{\\infty} - V_n - V_{n+1})$$\n为了找到更新规则，我们必须重排方程以求解 $V_{n+1}$：\n$$V_{n+1} + \\frac{\\Delta t}{2 \\tau_m} V_{n+1} = V_n - \\frac{\\Delta t}{2 \\tau_m} V_n + \\frac{\\Delta t}{\\tau_m} V_{\\infty}$$\n$$V_{n+1} \\left(1 + \\frac{\\Delta t}{2 \\tau_m}\\right) = V_n \\left(1 - \\frac{\\Delta t}{2 \\tau_m}\\right) + V_{\\infty} \\frac{\\Delta t}{\\tau_m}$$\n分离出 $V_{n+1}$ 得到最终的 Crank-Nicolson 更新规则：\n$$V_{n+1} = \\frac{V_n \\left(1 - \\frac{\\Delta t}{2 \\tau_m}\\right) + V_{\\infty} \\frac{\\Delta t}{\\tau_m}}{1 + \\frac{\\Delta t}{2 \\tau_m}}$$\n\n**3. 全局误差计算和实现计划**\n\n在最终时间 $T$ 的全局误差是最终数值与精确值之间的绝对差，并转换为毫伏：\n$$E_{global} = |V_{numerical}(T) - V_{exact}(T)| \\times 1000$$\n实现将按以下步骤进行：\n1.  以国际单位制（SI）基本单位定义所有物理参数（$C_m$、$R_m$、$\\tau_m$、$E_L$、$T$）。\n2.  遍历提供的测试套件中的每个测试案例 $(\\Delta t, I_0)$。\n3.  对每个案例，将给定的 $\\Delta t$（从毫秒）和 $I_0$（从纳安）转换为国际单位制单位（秒和安培）。\n4.  计算时间步数 $N = \\text{round}(T/\\Delta t)$。模拟将运行 $N$ 步。最终时间将是 $T_{sim} = N \\Delta t$。\n5.  使用推导出的解析公式计算精确解 $V_{exact}(T_{sim})$。\n6.  将两个电位变量 $V_{euler}$ 和 $V_{cn}$ 初始化为初始条件 $V(0) = E_L$。\n7.  迭代 $N$ 次，在每一步中根据它们各自推导出的更新规则更新 $V_{euler}$ 和 $V_{cn}$。\n8.  循环结束后，计算绝对误差 $|V_{euler} - V_{exact}(T_{sim})|$ 和 $|V_{cn} - V_{exact}(T_{sim})|$。\n9.  将误差转换为毫伏并存储它们。\n10. 最后，将所有计算出的误差格式化为指定的单个逗号分隔字符串。\n\n这种严谨的、基于原理的方法确保了分析推导和数值实现的正确性。\n\n**实现代码：**\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the single-compartment neuron model problem by deriving and implementing\n    explicit Euler and Crank-Nicolson methods, and comparing their accuracy against\n    the analytical solution.\n    \"\"\"\n    # SI unit definitions for physical parameters\n    tau_m = 20e-3    # Membrane time constant (s)\n    R_m = 100e6      # Membrane resistance (Ohm)\n    # C_m = 200e-12 is not directly needed if tau_m and R_m are used.\n    E_L = -65e-3     # Leak reversal potential (V)\n    T = 100e-3       # Total simulation time (s)\n\n    # Test suite: (delta_t_ms, I0_nA)\n    test_cases = [\n        (0.5, 0.5),   # Case A\n        (0.1, 0.5),   # Case B\n        (5.0, 0.5),   # Case C\n        (20.0, 0.5),  # Case D\n        (0.5, 0.0),   # Case E\n        (0.5, -0.5),  # Case F\n    ]\n\n    results = []\n\n    for delta_t_ms, I0_nA in test_cases:\n        # Convert parameters to SI units for the current case\n        delta_t = delta_t_ms * 1e-3  # Time step (s)\n        I_0 = I0_nA * 1e-9           # Input current (A)\n\n        # Determine the number of steps. Using int() is sufficient as the problem\n        # uses values that result in integer step counts.\n        num_steps = int(round(T / delta_t))\n        final_time = num_steps * delta_t # Use the actual final time of simulation\n\n        # --- 1. Analytical Solution ---\n        # Steady-state potential\n        v_inf = E_L + R_m * I_0\n        \n        # Exact solution at the final time T\n        v_exact_at_T = v_inf + (E_L - v_inf) * np.exp(-final_time / tau_m)\n\n        # --- 2. Explicit Euler Method ---\n        v_euler = E_L\n        # Pre-calculate factors for the update rule for efficiency\n        euler_factor = delta_t / tau_m\n        for _ in range(num_steps):\n            v_euler = v_euler + euler_factor * (v_inf - v_euler)\n\n        # --- 3. Crank-Nicolson Method ---\n        v_cn = E_L\n        # Pre-calculate factors for the update rule for efficiency\n        cn_factor = delta_t / (2 * tau_m)\n        cn_numerator_term1 = 1 - cn_factor\n        cn_denominator = 1 + cn_factor\n        cn_numerator_term2 = (delta_t / tau_m) * v_inf\n        for _ in range(num_steps):\n            v_cn_numerator = v_cn * cn_numerator_term1 + cn_numerator_term2\n            v_cn = v_cn_numerator / cn_denominator\n\n        # --- 4. Error Calculation ---\n        # Global error is the absolute difference at the final time, in mV\n        error_euler_mv = abs(v_euler - v_exact_at_T) * 1000\n        error_cn_mv = abs(v_cn - v_exact_at_T) * 1000\n\n        results.append(error_euler_mv)\n        results.append(error_cn_mv)\n\n    # Format the final output string according to the problem specification\n    return f\"[{','.join(f'{r:.15f}' for r in results)}]\"\n\n```",
            "answer": "`[0.598586877846153,0.000623351659714,0.120614838321045,0.000025029314490,5.174828343725519,0.061439247657199,19.346980553958971,0.653019446041029,0.000000000000000,0.000000000000000,0.598586877846153,0.000623351659714]`"
        }
    ]
}