{
    "hands_on_practices": [
        {
            "introduction": "Our journey into compartmental modeling begins with its fundamental unit: the single, isopotential compartment. This first practice grounds the abstract RC-circuit analogy in concrete biophysics by having you derive a neuron's core electrical properties—its input resistance $R_{in}$ and membrane time constant $\\tau_m$—directly from its physical size and specific membrane characteristics. This foundational exercise clarifies how a cell's passive response to current is dictated by its underlying physical structure. ",
            "id": "3969770",
            "problem": "Consider a single isopotential compartment representing a spherical neuronal soma with radius $r=10\\,\\mu\\text{m}$, no dendrites, and no axial coupling to other compartments (sealed-end boundary). The membrane is passive, linear, and spatially uniform, characterized by specific membrane capacitance $c_{m}=1\\,\\mu\\text{F}/\\text{cm}^{2}$ and specific membrane resistance $R_{m}=20\\,\\text{k}\\Omega\\cdot\\text{cm}^{2}$. A direct current step of amplitude $I=0.1\\,\\text{nA}$ is injected uniformly over the soma membrane. Using only first principles appropriate for compartmental modeling, namely: (i) geometric relations for surface area, (ii) the definition of total membrane capacitance $C$ and total membrane resistance $R$ from their specific values and membrane area $A$, and (iii) Ohm’s law and charge–voltage relations for resistive–capacitive (RC) elements, derive expressions for the membrane time constant $\\tau_{m}$ and the steady-state voltage deflection $\\Delta V_{\\infty}$ from rest, and compute their numerical values under these assumptions. Treat the soma as isopotential throughout the transient and steady state. Round your final numerical values to four significant figures. Express $\\tau_{m}$ in seconds and $\\Delta V_{\\infty}$ in millivolts.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, objective, and internally consistent. All necessary information is provided to derive a unique and meaningful solution using established principles of computational neuroscience and circuit theory.\n\nThe neuronal soma is modeled as a single, isopotential compartment. Under the given assumptions (passive, linear membrane), this compartment is electrically equivalent to a parallel resistor-capacitor (RC) circuit. The injected current, $I$, is distributed between the membrane capacitance and the membrane resistance.\n\nAccording to Kirchhoff's current law, the total injected current $I$ must equal the sum of the current flowing through the resistive pathway, $I_{R}$, and the current flowing through the capacitive pathway, $I_{C}$:\n$$I = I_{R} + I_{C}$$\nLet $V(t)$ be the membrane potential difference from the resting potential. The resistive current $I_{R}$ is governed by Ohm's law, where $R$ is the total membrane resistance of the soma:\n$$I_{R} = \\frac{V(t)}{R}$$\nThe capacitive current $I_{C}$ is related to the rate of change of voltage across the capacitor, where $C$ is the total membrane capacitance of the soma:\n$$I_{C} = C \\frac{dV(t)}{dt}$$\nSubstituting these expressions into the current balance equation yields the governing first-order linear ordinary differential equation for the membrane potential:\n$$I = \\frac{V(t)}{R} + C \\frac{dV(t)}{dt}$$\nMultiplying by $R$ and rearranging gives the standard form:\n$$RC \\frac{dV(t)}{dt} + V(t) = RI$$\nThis equation describes the charging of the RC circuit.\n\n**1. Derivation of the Membrane Time Constant ($\\tau_{m}$)**\n\nThe membrane time constant, $\\tau_{m}$, is defined as the product of the total membrane resistance $R$ and the total membrane capacitance $C$:\n$$\\tau_{m} = RC$$\nThe problem provides the specific membrane resistance $R_{m}$ (in units of resistance $\\times$ area) and the specific membrane capacitance $c_{m}$ (in units of capacitance / area). The total resistance and capacitance are related to these specific values through the total surface area $A$ of the membrane.\nThe total capacitance is directly proportional to the area:\n$$C = c_{m} A$$\nThe total resistance is inversely proportional to the area:\n$$R = \\frac{R_{m}}{A}$$\nSubstituting these into the expression for $\\tau_{m}$:\n$$\\tau_{m} = \\left(\\frac{R_{m}}{A}\\right) (c_{m} A) = R_{m} c_{m}$$\nThis key result shows that for a uniform passive membrane, the time constant is an intrinsic property of the membrane itself, independent of the compartment's size or geometry.\n\nWe now compute the numerical value of $\\tau_{m}$. First, we convert the given parameters to base SI units (meters, seconds, ohms, farads).\nGiven: $R_{m} = 20\\,\\text{k}\\Omega\\cdot\\text{cm}^{2}$ and $c_{m} = 1\\,\\mu\\text{F}/\\text{cm}^{2}$.\n$$R_{m} = 20 \\times 10^{3} \\, \\Omega \\cdot (10^{-2} \\, \\text{m})^{2} = 20 \\times 10^{3} \\times 10^{-4} \\, \\Omega\\cdot\\text{m}^{2} = 2 \\, \\Omega\\cdot\\text{m}^{2}$$\n$$c_{m} = 1 \\times 10^{-6} \\, \\text{F} / (10^{-2} \\, \\text{m})^{2} = 1 \\times 10^{-6} \\times 10^{4} \\, \\text{F}/\\text{m}^{2} = 10^{-2} \\, \\text{F}/\\text{m}^{2}$$\nNow, we can calculate $\\tau_{m}$:\n$$\\tau_{m} = R_{m} c_{m} = (2 \\, \\Omega\\cdot\\text{m}^{2}) \\times (10^{-2} \\, \\text{F}/\\text{m}^{2}) = 0.02 \\, \\Omega\\cdot\\text{F}$$\nSince $1 \\, \\Omega \\cdot \\text{F} = 1 \\, \\text{s}$, the time constant is:\n$$\\tau_{m} = 0.02 \\, \\text{s}$$\nThe problem requests rounding to four significant figures, so $\\tau_{m} = 0.02000 \\, \\text{s}$.\n\n**2. Derivation of the Steady-State Voltage Deflection ($\\Delta V_{\\infty}$)**\n\nThe steady-state voltage deflection, $\\Delta V_{\\infty}$, is the value of $V(t)$ as time $t \\to \\infty$. In the steady state, the membrane potential is constant, so its time derivative is zero:\n$$\\frac{dV(t)}{dt} \\to 0 \\quad \\text{as} \\quad t \\to \\infty$$\nUnder this condition, the differential equation $RC \\frac{dV(t)}{dt} + V(t) = RI$ simplifies to:\n$$V(\\infty) = RI$$\nThis is the steady-state solution. We denote this deflection as $\\Delta V_{\\infty}$:\n$$\\Delta V_{\\infty} = RI$$\nThe product $RI$ represents the total voltage drop across the membrane resistance when the capacitor is fully charged and no longer draws current. The term $R$ is often called the input resistance of the neuron. To compute its value, we first need the surface area $A$ of the spherical soma with radius $r = 10 \\, \\mu\\text{m}$.\nFirst, convert the radius to meters:\n$$r = 10 \\, \\mu\\text{m} = 10 \\times 10^{-6} \\, \\text{m} = 10^{-5} \\, \\text{m}$$\nThe surface area $A$ of a sphere is given by:\n$$A = 4\\pi r^{2} = 4\\pi (10^{-5} \\, \\text{m})^{2} = 4\\pi \\times 10^{-10} \\, \\text{m}^{2}$$\nNow we can find the total membrane resistance $R$:\n$$R = \\frac{R_{m}}{A} = \\frac{2 \\, \\Omega\\cdot\\text{m}^{2}}{4\\pi \\times 10^{-10} \\, \\text{m}^{2}} = \\frac{1}{2\\pi \\times 10^{-10}} \\, \\Omega$$\nNext, we convert the injected current $I$ to base SI units:\n$$I = 0.1 \\, \\text{nA} = 0.1 \\times 10^{-9} \\, \\text{A} = 10^{-10} \\, \\text{A}$$\nFinally, we calculate $\\Delta V_{\\infty}$:\n$$\\Delta V_{\\infty} = RI = \\left(\\frac{1}{2\\pi \\times 10^{-10}} \\, \\Omega\\right) (10^{-10} \\, \\text{A}) = \\frac{1}{2\\pi} \\, \\text{V}$$\nThe problem requires the answer in millivolts (mV).\n$$\\Delta V_{\\infty} = \\frac{1}{2\\pi} \\, \\text{V} \\times \\frac{1000 \\, \\text{mV}}{1 \\, \\text{V}} = \\frac{500}{\\pi} \\, \\text{mV}$$\nCalculating the numerical value:\n$$\\Delta V_{\\infty} \\approx 159.154943... \\, \\text{mV}$$\nRounding to four significant figures, we get:\n$$\\Delta V_{\\infty} = 159.2 \\, \\text{mV}$$\n\nThe derived expressions are $\\tau_m = R_m c_m$ and $\\Delta V_\\infty = RI = \\frac{R_m I}{4\\pi r^2}$. The computed numerical values are $\\tau_m = 0.02000 \\, \\text{s}$ and $\\Delta V_\\infty = 159.2 \\, \\text{mV}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.02000 & 159.2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While static properties are foundational, neuroscience is fundamentally about dynamics. This practice transitions from steady-state analysis to the time-dependent behavior of a single compartment, governed by a first-order ordinary differential equation (ODE). By implementing and comparing the explicit Euler method with the more robust Crank-Nicolson method, you will gain hands-on experience with the trade-offs in accuracy, stability, and computational cost inherent in numerically integrating neuronal dynamics over time. ",
            "id": "3969724",
            "problem": "Consider a passive single-compartment neuron model whose membrane potential $V(t)$ obeys the linear ordinary differential equation (ODE) describing a leaky resistor-capacitor circuit: $$C_m \\frac{dV}{dt} = -\\frac{V(t) - E_L}{R_m} + I(t),$$ where $C_m$ is the membrane capacitance, $R_m$ is the membrane resistance, $E_L$ is the leak reversal potential, and $I(t)$ is the applied current. The membrane time constant is defined by $$\\tau_m = R_m C_m.$$ Assume a Heaviside step current input $$I(t) = \\begin{cases}0 & \\text{for } t < 0, \\\\ I_0 & \\text{for } t \\ge 0,\\end{cases}$$ with constant amplitude $I_0$. Assume the initial condition $$V(0) = E_L.$$\n\nUse the following physically consistent parameters, expressed in International System of Units (SI): $$\\tau_m = 20\\,\\text{ms},\\quad R_m = 100\\,\\text{M}\\Omega,\\quad C_m = 200\\,\\text{pF},\\quad E_L = -65\\,\\text{mV}.$$ These values satisfy $$\\tau_m = R_m C_m.$$\n\nTasks:\n1. Starting only from the ODE and the definitions above, derive the exact solution $V(t)$ for the step response and the steady-state potential. Your derivation must be grounded in first principles and must not assume any discretization formula.\n2. Construct two numerical time-stepping schemes to approximate $V(t)$ on a uniform grid of step size $\\Delta t$ for $t \\in [0, T]$:\n   - The explicit Euler method.\n   - The Crank–Nicolson (CN) method, which is a second-order, trapezoidal-rule-based method. Do not use or assume any pre-given update formulas; derive the discrete update rule by applying the method definition to the ODE.\n3. For each scheme, compute the global error at the final time $t = T$ defined as the absolute difference between the numerical approximation and the exact solution at $t = T$, expressed in millivolts (mV). The absolute error must be reported in $\\text{mV}$ as a nonnegative real number.\n4. Implement both schemes in a single program and evaluate the global error at $T = 100\\,\\text{ms}$ for the parameter sets listed below. For each parameter set, the program must compute and report two numbers: the explicit Euler absolute global error at $t = 100\\,\\text{ms}$ and the Crank–Nicolson absolute global error at $t = 100\\,\\text{ms}$, both in $\\text{mV}$.\n\nUse the following test suite of parameter sets, each expressed as $(\\Delta t, I_0)$ with $\\Delta t$ in milliseconds and $I_0$ in nanoamperes:\n- Case A (happy path, thumbnail case): $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.5\\,\\text{nA})$.\n- Case B (fine grid): $(\\Delta t, I_0) = (0.1\\,\\text{ms}, 0.5\\,\\text{nA})$.\n- Case C (coarser grid): $(\\Delta t, I_0) = (5.0\\,\\text{ms}, 0.5\\,\\text{nA})$.\n- Case D (near stability boundary for explicit Euler but still stable): $(\\Delta t, I_0) = (20.0\\,\\text{ms}, 0.5\\,\\text{nA})$.\n- Case E (zero input edge case): $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.0\\,\\text{nA})$.\n- Case F (negative step symmetry): $(\\Delta t, I_0) = (0.5\\,\\text{ms}, -0.5\\,\\text{nA})$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The results must be ordered as $$[\\text{Euler}_A,\\text{CN}_A,\\text{Euler}_B,\\text{CN}_B,\\text{Euler}_C,\\text{CN}_C,\\text{Euler}_D,\\text{CN}_D,\\text{Euler}_E,\\text{CN}_E,\\text{Euler}_F,\\text{CN}_F],$$ where each entry is the absolute global error at $t = 100\\,\\text{ms}$ in $\\text{mV}$, represented as a floating-point number.\n\nAll physical quantities must be converted consistently to SI units during computation. Angles are not involved. All percentage-like quantities must be expressed as decimals if needed; do not use the percentage sign.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n\n**Governing Equation:**\nThe membrane potential $V(t)$ is governed by the ordinary differential equation (ODE):\n$$C_m \\frac{dV}{dt} = -\\frac{V(t) - E_L}{R_m} + I(t)$$\n\n**Definitions and Constants:**\n- Membrane capacitance: $C_m = 200\\,\\text{pF}$\n- Membrane resistance: $R_m = 100\\,\\text{M}\\Omega$\n- Leak reversal potential: $E_L = -65\\,\\text{mV}$\n- Membrane time constant: $\\tau_m = R_m C_m = 20\\,\\text{ms}$\n\n**Input Current:**\nA Heaviside step current is applied:\n$$I(t) = \\begin{cases}0 & \\text{for } t < 0, \\\\ I_0 & \\text{for } t \\ge 0,\\end{cases}$$\nwhere $I_0$ is a constant amplitude.\n\n**Initial Condition:**\n$$V(0) = E_L$$\n\n**Tasks:**\n1.  Derive the exact solution $V(t)$ for the step response and the steady-state potential.\n2.  Derive the update rules for the explicit Euler and Crank-Nicolson numerical methods.\n3.  Compute the global error at final time $T = 100\\,\\text{ms}$ for each scheme, defined as the absolute difference between the numerical and exact solutions at $T$, in millivolts.\n4.  Implement both schemes and evaluate the global error for a given test suite of parameters $(\\Delta t, I_0)$.\n\n**Test Suite:**\nFinal time for all cases: $T = 100\\,\\text{ms}$.\n- Case A: $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.5\\,\\text{nA})$\n- Case B: $(\\Delta t, I_0) = (0.1\\,\\text{ms}, 0.5\\,\\text{nA})$\n- Case C: $(\\Delta t, I_0) = (5.0\\,\\text{ms}, 0.5\\,\\text{nA})$\n- Case D: $(\\Delta t, I_0) = (20.0\\,\\text{ms}, 0.5\\,\\text{nA})$\n- Case E: $(\\Delta t, I_0) = (0.5\\,\\text{ms}, 0.0\\,\\text{nA})$\n- Case F: $(\\Delta t, I_0) = (0.5\\,\\text{ms}, -0.5\\,\\text{nA})$\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem describes the leaky integrate-and-fire model, a fundamental and widely used model in computational neuroscience. The governing equation is a standard RC circuit equation, which is a cornerstone of electrical engineering and biophysics. All parameters are physically meaningful, and their values are within realistic biophysical ranges. The consistency check $R_m C_m = (100 \\times 10^6\\,\\Omega) \\times (200 \\times 10^{-12}\\,\\text{F}) = 20 \\times 10^{-3}\\,\\text{s} = 20\\,\\text{ms}$ confirms the internal consistency of the provided data. The problem is scientifically sound.\n-   **Well-Posed**: The problem provides a first-order linear ODE with a well-defined initial condition. For a given input current, a unique and stable solution exists. The tasks are specific and lead to a unique set of numerical results. The problem is well-posed.\n-   **Objective**: The problem is stated using precise mathematical and physical terminology. The tasks are quantitative and unambiguous. No subjective interpretation is required. The problem is objective.\n-   **No other flaws detected**: The problem is self-contained, formalizable, and computationally feasible. It is a standard exercise in numerical methods applied to a biophysical model.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe analysis begins with the provided ODE, with all calculations performed in base SI units.\n\n**1. Exact Analytical Solution**\n\nThe governing ODE for the single-compartment model is:\n$$C_m \\frac{dV}{dt} = -\\frac{V(t) - E_L}{R_m} + I(t)$$\nUsing the definition of the membrane time constant, $\\tau_m = R_m C_m$, we can rewrite the equation. Multiplying by $R_m$ yields:\n$$R_m C_m \\frac{dV}{dt} = -(V(t) - E_L) + R_m I(t)$$\n$$\\tau_m \\frac{dV}{dt} = -V(t) + E_L + R_m I(t)$$\nThis is a first-order linear non-homogeneous ODE. For $t \\ge 0$, the input current $I(t)$ is a constant $I_0$. We can rearrange the equation into the standard form $\\frac{dy}{dt} + P(t)y = Q(t)$:\n$$\\frac{dV}{dt} + \\frac{1}{\\tau_m}V(t) = \\frac{E_L + R_m I_0}{\\tau_m}$$\nLet's define the steady-state potential $V_{\\infty}$ as the potential reached when $\\frac{dV}{dt} = 0$:\n$$0 = -V_{\\infty} + E_L + R_m I_0 \\implies V_{\\infty} = E_L + R_m I_0$$\nSubstituting $V_{\\infty}$ back into the ODE gives a more compact form:\n$$\\frac{dV}{dt} = \\frac{V_{\\infty} - V(t)}{\\tau_m}$$\nThis equation is separable:\n$$\\frac{dV}{V_{\\infty} - V} = \\frac{dt}{\\tau_m}$$\nIntegrating both sides from the initial state $(t=0, V=V(0)=E_L)$ to a generic state $(t, V=V(t))$:\n$$\\int_{E_L}^{V(t)} \\frac{dV'}{V_{\\infty} - V'} = \\int_0^t \\frac{dt'}{\\tau_m}$$\n$$[-\\ln|V_{\\infty} - V'|]_{E_L}^{V(t)} = \\frac{t}{\\tau_m}$$\n$$-\\ln|V_{\\infty} - V(t)| + \\ln|V_{\\infty} - E_L| = \\frac{t}{\\tau_m}$$\n$$\\ln\\left(\\frac{V_{\\infty} - E_L}{V_{\\infty} - V(t)}\\right) = \\frac{t}{\\tau_m}$$\nExponentiating both sides:\n$$\\frac{V_{\\infty} - E_L}{V_{\\infty} - V(t)} = e^{t/\\tau_m}$$\nSolving for $V(t)$:\n$$V_{\\infty} - V(t) = (V_{\\infty} - E_L)e^{-t/\\tau_m}$$\n$$V(t) = V_{\\infty} - (V_{\\infty} - E_L)e^{-t/\\tau_m}$$\nSubstituting the definitions of $V_{\\infty}$ and noting that $V_{\\infty} - E_L = R_m I_0$:\n$$V(t) = (E_L + R_m I_0) - (R_m I_0)e^{-t/\\tau_m}$$\nThe exact solution for the step response is therefore:\n$$V(t) = E_L + R_m I_0 (1 - e^{-t/\\tau_m})$$\nThe steady-state potential, as derived from the equilibrium condition $\\frac{dV}{dt} = 0$ or by taking the limit $t \\to \\infty$ in the solution, is:\n$$V_{ss} = \\lim_{t \\to \\infty} V(t) = E_L + R_m I_0$$\nThis is consistent with our earlier definition of $V_{\\infty}$.\n\n**2. Numerical Scheme Derivation**\n\nWe will discretize the simplified ODE, $\\frac{dV}{dt} = f(V)$ where $f(V) = \\frac{V_{\\infty} - V}{\\tau_m}$. Let $V_n$ be the numerical approximation of $V(t_n)$ at time $t_n = n \\Delta t$.\n\n**Explicit Euler Method:**\nThe explicit (or forward) Euler method approximates the derivative as a forward difference:\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = f(V_n)$$\nSubstituting our function $f(V_n)$:\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = \\frac{V_{\\infty} - V_n}{\\tau_m}$$\nSolving for $V_{n+1}$ yields the update rule:\n$$V_{n+1} = V_n + \\frac{\\Delta t}{\\tau_m}(V_{\\infty} - V_n)$$\nThis can be rearranged to:\n$$V_{n+1} = V_n \\left(1 - \\frac{\\Delta t}{\\tau_m}\\right) + V_{\\infty} \\frac{\\Delta t}{\\tau_m}$$\n\n**Crank-Nicolson (CN) Method:**\nThe Crank-Nicolson method is an implicit method based on the trapezoidal rule, averaging the function $f(V)$ at the beginning and end of the time step:\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = \\frac{1}{2} (f(V_n) + f(V_{n+1}))$$\nSubstituting our function $f(V)$:\n$$\\frac{V_{n+1} - V_n}{\\Delta t} = \\frac{1}{2} \\left( \\frac{V_{\\infty} - V_n}{\\tau_m} + \\frac{V_{\\infty} - V_{n+1}}{\\tau_m} \\right)$$\n$$V_{n+1} - V_n = \\frac{\\Delta t}{2 \\tau_m} (2V_{\\infty} - V_n - V_{n+1})$$\nTo find the update rule, we must rearrange the equation to solve for $V_{n+1}$:\n$$V_{n+1} + \\frac{\\Delta t}{2 \\tau_m} V_{n+1} = V_n - \\frac{\\Delta t}{2 \\tau_m} V_n + \\frac{\\Delta t}{\\tau_m} V_{\\infty}$$\n$$V_{n+1} \\left(1 + \\frac{\\Delta t}{2 \\tau_m}\\right) = V_n \\left(1 - \\frac{\\Delta t}{2 \\tau_m}\\right) + V_{\\infty} \\frac{\\Delta t}{\\tau_m}$$\nIsolating $V_{n+1}$ gives the final Crank-Nicolson update rule:\n$$V_{n+1} = \\frac{V_n \\left(1 - \\frac{\\Delta t}{2 \\tau_m}\\right) + V_{\\infty} \\frac{\\Delta t}{\\tau_m}}{1 + \\frac{\\Delta t}{2 \\tau_m}}$$\n\n**3. Global Error Calculation and Implementation Plan**\n\nThe global error at the final time $T$ is the absolute difference between the final numerical value and the exact value, converted to millivolts:\n$$E_{global} = |V_{numerical}(T) - V_{exact}(T)| \\times 1000$$\nThe implementation will proceed as follows:\n1.  Define all physical parameters ($C_m$, $R_m$, $\\tau_m$, $E_L$, $T$) in base SI units.\n2.  Iterate through each test case $(\\Delta t, I_0)$ from the provided suite.\n3.  For each case, convert the given $\\Delta t$ (from ms) and $I_0$ (from nA) to SI units (s and A).\n4.  Calculate the number of time steps $N = \\text{round}(T/\\Delta t)$. The simulation will run for $N$ steps. The final time will be $T_{sim} = N \\Delta t$.\n5.  Compute the exact solution $V_{exact}(T_{sim})$ using the derived analytical formula.\n6.  Initialize two variables for the potential, $V_{euler}$ and $V_{cn}$, to the initial condition $V(0) = E_L$.\n7.  Iterate $N$ times, updating $V_{euler}$ and $V_{cn}$ in each step according to their respective derived update rules.\n8.  After the loop, compute the absolute errors $|V_{euler} - V_{exact}(T_{sim})|$ and $|V_{cn} - V_{exact}(T_{sim})|$.\n9.  Convert the errors to millivolts and store them.\n10. Finally, format all computed errors into a single comma-separated string as specified.\n\nThis rigorous, principle-based approach ensures correctness in both the analytical derivation and the numerical implementation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the single-compartment neuron model problem by deriving and implementing\n    explicit Euler and Crank-Nicolson methods, and comparing their accuracy against\n    the analytical solution.\n    \"\"\"\n    # SI unit definitions for physical parameters\n    tau_m = 20e-3    # Membrane time constant (s)\n    R_m = 100e6      # Membrane resistance (Ohm)\n    # C_m = 200e-12 is not directly needed if tau_m and R_m are used.\n    E_L = -65e-3     # Leak reversal potential (V)\n    T = 100e-3       # Total simulation time (s)\n\n    # Test suite: (delta_t_ms, I0_nA)\n    test_cases = [\n        (0.5, 0.5),   # Case A\n        (0.1, 0.5),   # Case B\n        (5.0, 0.5),   # Case C\n        (20.0, 0.5),  # Case D\n        (0.5, 0.0),   # Case E\n        (0.5, -0.5),  # Case F\n    ]\n\n    results = []\n\n    for delta_t_ms, I0_nA in test_cases:\n        # Convert parameters to SI units for the current case\n        delta_t = delta_t_ms * 1e-3  # Time step (s)\n        I_0 = I0_nA * 1e-9           # Input current (A)\n\n        # Determine the number of steps. Using int() is sufficient as the problem\n        # uses values that result in integer step counts.\n        num_steps = int(round(T / delta_t))\n        final_time = num_steps * delta_t # Use the actual final time of simulation\n\n        # --- 1. Analytical Solution ---\n        # Steady-state potential\n        v_inf = E_L + R_m * I_0\n        \n        # Exact solution at the final time T\n        v_exact_at_T = v_inf + (E_L - v_inf) * np.exp(-final_time / tau_m)\n\n        # --- 2. Explicit Euler Method ---\n        v_euler = E_L\n        # Pre-calculate factors for the update rule for efficiency\n        euler_factor = delta_t / tau_m\n        for _ in range(num_steps):\n            v_euler = v_euler + euler_factor * (v_inf - v_euler)\n\n        # --- 3. Crank-Nicolson Method ---\n        v_cn = E_L\n        # Pre-calculate factors for the update rule for efficiency\n        cn_factor = delta_t / (2 * tau_m)\n        cn_numerator_term1 = 1 - cn_factor\n        cn_denominator = 1 + cn_factor\n        cn_numerator_term2 = 2 * cn_factor * v_inf\n        for _ in range(num_steps):\n            v_cn_numerator = v_cn * cn_numerator_term1 + cn_numerator_term2\n            v_cn = v_cn_numerator / cn_denominator\n\n        # --- 4. Error Calculation ---\n        # Global error is the absolute difference at the final time, in mV\n        error_euler_mv = abs(v_euler - v_exact_at_T) * 1000\n        error_cn_mv = abs(v_cn - v_exact_at_T) * 1000\n\n        results.append(error_euler_mv)\n        results.append(error_cn_mv)\n\n    # Format the final output string according to the problem specification\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Real neurons are spatially complex, a feature that compartmental models approximate by linking discrete segments together. This practice confronts the central challenge of this approximation: spatial discretization error. You will analyze how representing a continuous passive cable with a chain of compartments affects the accuracy of voltage attenuation, and derive a quantitative relationship between compartment size $\\Delta x$ and simulation fidelity, a critical skill for building computationally efficient and biophysically faithful models. ",
            "id": "3969758",
            "problem": "Consider a one-dimensional passive dendritic cable at steady state with membrane potential $V(x)$ governed by the classical cable relation for a passive, homogeneous neurite: the second spatial derivative of the membrane potential is proportional to the membrane potential itself with proportionality given by the inverse square of the length constant $\\lambda$. Formally, the steady-state relation is the second-order ordinary differential equation (ODE) $d^{2}V/dx^{2} = V/\\lambda^{2}$, for which the physically relevant, bounded solution for attenuation from a source at $x=0$ along the cable is exponential: $V(x)/V(0) = \\exp(-x/\\lambda)$.\n\nIn compartmental modeling, the continuous cable is discretized into compartments of length $\\Delta x$ with a second-order central difference approximation of the second derivative. This leads to a three-point stencil relation of the form $(V_{i+1} - 2 V_{i} + V_{i-1})/\\Delta x^{2} = V_{i}/\\lambda^{2}$, which admits geometric solutions $V_{i} \\propto r^{i}$ when the cable is homogeneous. The compartmental attenuation per compartment is then characterized by a factor $r$ that depends on $\\Delta x/\\lambda$. Over a distance equal to the length constant $x = \\lambda$, there are $M = \\lambda/\\Delta x$ compartments, and the discrete attenuation is $r^{M}$, which can be compared to the exact continuum attenuation $\\exp(-1)$.\n\nYour tasks are:\n- Starting from the steady-state cable relation $d^{2}V/dx^{2} = V/\\lambda^{2}$ and the central-difference compartmental approximation, derive the discrete geometric factor $r$ in terms of the dimensionless ratio $y = \\Delta x/\\lambda$. Express $r$ through elementary functions and show how to compute the discrete attenuation over a distance $x=\\lambda$ as a function of $y$.\n- Define the relative error $E(y)$ of the discrete attenuation with respect to the exact attenuation over the same distance as $E(y) = \\lvert r^{M} - \\exp(-1) \\rvert / \\exp(-1)$, where $M = \\lambda/\\Delta x = 1/y$. Derive a small-$y$ asymptotic expression for $E(y)$ and use it to obtain a bound on $\\Delta x$ in terms of $\\lambda$ and a prescribed relative error tolerance $\\delta$ such that $E(y) \\le \\delta$ is guaranteed. The bound must be expressed in meters (m).\n- Implement these computations in a complete, runnable program that, for each test case listed below, calculates:\n    1. The relative error $E(y)$ as a decimal.\n    2. A boolean indicating whether the requirement $E(y) \\le \\delta$ is satisfied.\n    3. The analytical small-$y$ bound on $\\Delta x$ in meters (m) implied by your asymptotic derivation, given by an explicit formula in terms of $\\lambda$ and $\\delta$.\n    4. A numerically tight bound on $\\Delta x$ in meters (m) obtained by solving $E(y) = \\delta$ for $y$ and then mapping $y$ back to $\\Delta x = y \\lambda$.\n- Use the following test suite. In all cases, the length constant is $\\lambda = 1.0 \\times 10^{-3}$ m, and you must use $x = \\lambda$. The dimensionless ratios $y = \\Delta x/\\lambda$ are chosen so that $M = 1/y$ is an integer:\n    1. $\\Delta x/\\lambda = 0.1$, $\\delta = 0.01$.\n    2. $\\Delta x/\\lambda = 0.5$, $\\delta = 0.05$.\n    3. $\\Delta x/\\lambda = 1.0$, $\\delta = 0.05$.\n    4. $\\Delta x/\\lambda = 0.25$, $\\delta = 0.002$.\n- Required output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list in the order described above. For example, the output should look like: \"[[E1,True,dx_bound_approx_1,dx_bound_exact_1],[E2,False,dx_bound_approx_2,dx_bound_exact_2],...]\" with numerical values as plain decimals. All $\\Delta x$ bounds must be expressed in meters (m).\n\nAll angle quantities, if any appear in intermediate steps, must be treated in radians. All percentages, if any arise, must be expressed as decimals. There are no other units besides meters (m) to be used in this problem.",
            "solution": "The problem is assessed to be valid. It is a scientifically grounded, well-posed, and objective problem in computational neuroscience that requires the derivation and analysis of a numerical method. All necessary data and definitions are provided, and there are no internal contradictions or factual inaccuracies.\n\nThe solution proceeds in three parts as requested: derivation of the discrete attenuation factor, asymptotic error analysis, and implementation of the calculations.\n\n### Part 1: Derivation of the Discrete Attenuation Factor\nThe starting point is the discretized steady-state cable equation using a second-order central difference approximation for the second spatial derivative:\n$$\n\\frac{V_{i+1} - 2 V_{i} + V_{i-1}}{\\Delta x^{2}} = \\frac{V_{i}}{\\lambda^{2}}\n$$\nwhere $V_i$ is the membrane potential at the center of compartment $i$, $\\Delta x$ is the length of a compartment, and $\\lambda$ is the length constant.\n\nWe seek a geometric solution of the form $V_i = V_0 r^i$, which represents exponential decay or growth from compartment to compartment. Substituting this into the difference equation yields:\n$$\n\\frac{V_0 r^{i+1} - 2 V_0 r^i + V_0 r^{i-1}}{\\Delta x^{2}} = \\frac{V_0 r^i}{\\lambda^{2}}\n$$\nDividing through by $V_0 r^{i-1}$ (assuming $V_0 \\ne 0$ and $r \\ne 0$) gives:\n$$\n\\frac{r^2 - 2r + 1}{\\Delta x^{2}} = \\frac{r}{\\lambda^{2}}\n$$\nLet's introduce the dimensionless ratio $y = \\Delta x / \\lambda$. The equation becomes:\n$$\nr^2 - 2r + 1 = r \\left(\\frac{\\Delta x}{\\lambda}\\right)^2 = r y^2\n$$\nRearranging this into a standard quadratic equation for $r$:\n$$\nr^2 - (2 + y^2)r + 1 = 0\n$$\nSolving for $r$ using the quadratic formula, $r = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nr = \\frac{(2 + y^2) \\pm \\sqrt{(2 + y^2)^2 - 4}}{2} = \\frac{(2 + y^2) \\pm \\sqrt{4 + 4y^2 + y^4 - 4}}{2}\n$$\n$$\nr = \\frac{(2 + y^2) \\pm \\sqrt{4y^2 + y^4}}{2} = \\frac{(2 + y^2) \\pm |y|\\sqrt{4 + y^2}}{2}\n$$\nSince $\\Delta x$ and $\\lambda$ are lengths, $y > 0$, so $|y| = y$:\n$$\nr = \\frac{2 + y^2 \\pm y\\sqrt{4 + y^2}}{2}\n$$\nThis provides two solutions, $r_+$ and $r_-$. From Vieta's formulas, their product is $r_+ r_- = c/a = 1$. One solution must be greater than $1$ (representing an unphysical growing potential away from the source) and the other less than $1$ (representing attenuation). For a physically relevant passive cable, we choose the solution corresponding to attenuation, $|r| < 1$. This is the solution with the minus sign:\n$$\nr = \\frac{2 + y^2 - y\\sqrt{4 + y^2}}{2}\n$$\nThe discrete attenuation over a distance $x = \\lambda$ is calculated over $M = \\lambda/\\Delta x = 1/y$ compartments. The total attenuation factor is thus $r^M = r^{1/y}$.\n\n### Part 2: Asymptotic Error Analysis and Bound Derivation\nThe relative error $E(y)$ of the discrete attenuation with respect to the exact continuum attenuation, $\\exp(-1)$, is defined as:\n$$\nE(y) = \\frac{\\lvert r^{M} - \\exp(-1) \\rvert}{\\exp(-1)} = \\frac{\\lvert r^{1/y} - e^{-1} \\rvert}{e^{-1}}\n$$\nTo find the small-$y$ asymptotic behavior of $E(y)$, we first find the Taylor series expansion of $r$ for small $y$:\n$$\nr = 1 + \\frac{y^2}{2} - \\frac{y}{2}\\sqrt{4+y^2} = 1 + \\frac{y^2}{2} - y\\sqrt{1+\\frac{y^2}{4}}\n$$\nUsing the expansion $\\sqrt{1+u} = 1 + u/2 - u^2/8 + O(u^3)$ with $u = y^2/4$:\n$$\n\\sqrt{1+\\frac{y^2}{4}} \\approx 1 + \\frac{1}{2}\\left(\\frac{y^2}{4}\\right) - \\frac{1}{8}\\left(\\frac{y^2}{4}\\right)^2 = 1 + \\frac{y^2}{8} - \\frac{y^4}{128} + O(y^6)\n$$\nSubstituting this back into the expression for $r$:\n$$\nr \\approx 1 + \\frac{y^2}{2} - y\\left(1 + \\frac{y^2}{8}\\right) = 1 - y + \\frac{y^2}{2} - \\frac{y^3}{8}\n$$\nTo evaluate $r^{1/y}$, we use the identity $a^b = \\exp(b \\ln a)$:\n$$\nr^{1/y} = \\exp\\left(\\frac{1}{y} \\ln r\\right)\n$$\nWe expand $\\ln r$ for small $y$ using $\\ln(1+u) = u - u^2/2 + u^3/3 - \\dots$ with $u = -y + \\frac{y^2}{2} - \\frac{y^3}{8} + \\dots$:\n$$\n\\ln r = \\ln\\left(1 + \\left[-y + \\frac{y^2}{2} - \\frac{y^3}{8} + \\dots\\right]\\right)\n$$\n$$\n\\ln r = \\left(-y + \\frac{y^2}{2} - \\frac{y^3}{8}\\right) - \\frac{1}{2}\\left(-y + \\frac{y^2}{2}\\right)^2 + \\frac{1}{3}(-y)^3 + O(y^4)\n$$\n$$\n\\ln r = \\left(-y + \\frac{y^2}{2} - \\frac{y^3}{8}\\right) - \\frac{1}{2}\\left(y^2 - y^3\\right) - \\frac{y^3}{3} + O(y^4)\n$$\n$$\n\\ln r = -y + \\left(\\frac{1}{2} - \\frac{1}{2}\\right)y^2 + \\left(-\\frac{1}{8} + \\frac{1}{2} - \\frac{1}{3}\\right)y^3 + O(y^4) = -y + \\frac{1}{24}y^3 + O(y^4)\n$$\nThen, $\\frac{1}{y}\\ln r = -1 + \\frac{1}{24}y^2 + O(y^3)$. The attenuation is:\n$$\nr^{1/y} = \\exp\\left(-1 + \\frac{y^2}{24} + O(y^3)\\right) = e^{-1} \\exp\\left(\\frac{y^2}{24} + O(y^3)\\right)\n$$\nUsing $\\exp(u) \\approx 1+u$ for small $u$:\n$$\nr^{1/y} \\approx e^{-1}\\left(1 + \\frac{y^2}{24}\\right)\n$$\nNow, we substitute this into the error formula. For small $y>0$, $r^{1/y} > e^{-1}$, so the absolute value can be dropped.\n$$\nE(y) \\approx \\frac{e^{-1}(1 + y^2/24) - e^{-1}}{e^{-1}} = 1 + \\frac{y^2}{24} - 1 = \\frac{y^2}{24}\n$$\nThus, the leading-order asymptotic expression for the relative error is $E(y) \\approx y^2/24$.\n\nTo find a bound on $\\Delta x$ that guarantees $E(y) \\le \\delta$, we set our approximation equal to the tolerance $\\delta$:\n$$\n\\frac{y^2}{24} \\approx \\delta \\implies y^2 \\approx 24\\delta \\implies y \\approx \\sqrt{24\\delta}\n$$\nSince $y = \\Delta x/\\lambda$, the requirement is $\\Delta x/\\lambda \\le \\sqrt{24\\delta}$. This gives the analytical small-$y$ bound on $\\Delta x$:\n$$\n\\Delta x \\le \\lambda \\sqrt{24\\delta}\n$$\n\n### Part 3: Numerical Implementation\nThe implementation calculates four quantities for each test case $(\\Delta x/\\lambda, \\delta)$:\n1.  **Relative Error $E(y)$**: Calculated directly from its definition using $y = \\Delta x/\\lambda$ and the derived formula for $r$.\n2.  **Satisfaction of Requirement**: A boolean check if the calculated $E(y) \\le \\delta$.\n3.  **Analytical Bound on $\\Delta x$**: Calculated using the formula $\\Delta x_{approx} = \\lambda \\sqrt{24\\delta}$. This provides an approximate upper bound for $\\Delta x$ to meet the tolerance $\\delta$.\n4.  **Numerically Tight Bound on $\\Delta x$**: This requires finding the specific value of $y$, let's call it $y_{sol}$, for which $E(y_{sol}) = \\delta$. This is a root-finding problem for the equation $E(y) - \\delta = 0$. We use a numerical solver (`scipy.optimize.root_scalar`) to find $y_{sol}$. The numerically tight bound on the compartment size is then $\\Delta x_{exact} = y_{sol} \\lambda$. For any $\\Delta x \\le \\Delta x_{exact}$, the error will be less than or equal to $\\delta$.\n\nThe Python code in the final answer implements these steps for the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the compartmental modeling error analysis problem for a passive dendritic cable.\n    \"\"\"\n    \n    # Define constant from the problem statement\n    LAMBDA_VAL = 1.0e-3  # meters\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (y, delta), where y = delta_x / lambda.\n    test_cases = [\n        (0.1, 0.01),\n        (0.5, 0.05),\n        (1.0, 0.05),\n        (0.25, 0.002),\n    ]\n\n    # Pre-calculate exact attenuation for efficiency\n    ATT_EXACT = np.exp(-1)\n\n    def calculate_E(y: float) -> float:\n        \"\"\"\n        Calculates the relative error E(y) for a given y = delta_x / lambda.\n        \n        Args:\n            y: The dimensionless ratio of compartment size to length constant.\n            \n        Returns:\n            The relative error as a decimal.\n        \"\"\"\n        if y <= 0:\n            return 0.0\n\n        # Discrete geometric factor r for attenuation\n        r = (2 + y**2 - y * np.sqrt(4 + y**2)) / 2\n        \n        # Number of compartments M over distance lambda is 1/y.\n        # Python's ** operator handles non-integer exponents, which is\n        # necessary for the numerical solver.\n        M = 1 / y\n        att_discrete = r**M\n        \n        # Relative error\n        error = np.abs(att_discrete - ATT_EXACT) / ATT_EXACT\n        return error\n\n    def find_numerical_y_solution(delta: float) -> float:\n        \"\"\"\n        Finds the value of y for which E(y) = delta using a numerical root finder.\n        \n        Args:\n            delta: The prescribed relative error tolerance.\n            \n        Returns:\n            The value of y that satisfies E(y) = delta.\n        \"\"\"\n        # Define the function whose root we want to find: E(y) - delta = 0\n        objective_func = lambda y_solve: calculate_E(y_solve) - delta\n        \n        # E(y) is monotonic, starting at 0 for y=0.\n        # The bracket [1e-9, 2.0] is safe for the expected range of delta.\n        # A small positive number is used as the lower bound to avoid division by zero.\n        try:\n            sol = root_scalar(objective_func, bracket=[1e-9, 2.0], method='brentq')\n            return sol.root\n        except ValueError:\n            # This might happen if objective_func(a) and objective_func(b) don't have opposite signs.\n            # For the given problem constraints and bracket, this is not expected.\n            return np.nan\n\n\n    results = []\n    for y_val, delta_val in test_cases:\n        # 1. Calculate the relative error E(y)\n        E_val = calculate_E(y_val)\n        \n        # 2. Check if the requirement E(y) <= delta is satisfied\n        is_satisfied = E_val <= delta_val\n        \n        # 3. Calculate the analytical small-y bound on delta_x\n        # delta_x_approx = lambda * sqrt(24 * delta)\n        dx_bound_approx = LAMBDA_VAL * np.sqrt(24 * delta_val)\n        \n        # 4. Calculate the numerically tight bound on delta_x\n        # Solve E(y) = delta for y, then delta_x_exact = y_sol * lambda\n        y_solution = find_numerical_y_solution(delta_val)\n        dx_bound_exact = y_solution * LAMBDA_VAL\n\n        results.append([E_val, is_satisfied, dx_bound_approx, dx_bound_exact])\n\n    # Format the final output string exactly as required.\n    case_strings = []\n    for res in results:\n        # res = [E, is_satisfied, dx_approx, dx_exact]\n        # str(bool) produces 'True' or 'False' as required.\n        case_strings.append(f\"[{res[0]},{str(res[1])},{res[2]},{res[3]}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}