{
    "hands_on_practices": [
        {
            "introduction": "要模拟完整的树突树，我们必须首先理解其基本构成单位——一段树突——的电学特性。本练习聚焦于轴向电阻（$r_a$），这是一个量化电流沿树突流动难易程度的关键参数 。通过推导并计算它，您将深入理解神经元的形态（尤其是直径）如何从根本上决定其电信号的传播。",
            "id": "3974745",
            "problem": "一个直的树突段被建模为一个半径为 $a$、长度为 $L$ 的均匀直立圆柱体，其内部含有均匀的细胞内介质，介质的电阻率（specific resistivity）为 $R_i$（单位为 $\\Omega\\cdot\\text{cm}$）。在多房室电缆模型中，单位长度轴向电阻 $r_a$（单位为 $\\Omega/\\text{cm}$）量化了沿树突轴向流动的电流所受到的阻力，并决定了相邻房室之间纵向耦合的强度。\n\n从欧姆定律的连续形式以及长度为 $L$、横截面积为 $A$ 的均匀导体的电阻定义出发，推导出一个用 $R_i$ 和 $a$ 表示均匀圆柱形树突单位长度轴向电阻 $r_a$ 的表达式。然后，对于一个电阻率为 $R_i = 130\\ \\Omega\\cdot\\text{cm}$、半径为 $a = 0.65\\ \\mu\\mathrm{m}$ 的树突，数值计算 $r_a$ 的值。将 $r_a$ 的数值以 $\\Omega/\\text{cm}$ 为单位表示，并四舍五入到 $3$ 位有效数字。\n\n最后，假设在 $R_i$ 保持不变的情况下，树突的直径减半。确定在这种情况下 $r_a$ 变化的乘法因子。最终答案仅报告此因子，它是一个没有单位的纯数。",
            "solution": "本题要求三个不同的结果：第一，推导圆柱形树突的单位长度轴向电阻 $r_a$；第二，对给定参数下的 $r_a$ 进行数值计算；第三，当树突直径减半时，$r_a$ 变化的乘法因子。最终答案应仅为此乘法因子。\n\n首先，我们验证题目陈述的有效性。\n已知条件如下：\n- 树突段被建模为半径为 $a$、长度为 $L$ 的均匀直立圆柱体。\n- 细胞内介质是均匀的，电阻率为 $R_i$。\n- 单位长度轴向电阻用 $r_a$ 表示，单位为 $\\Omega/\\text{cm}$。\n- 出发点是欧姆定律的连续形式和均匀导体的电阻定义。\n- 用于数值计算的参数：$R_i = 130\\ \\Omega\\cdot\\text{cm}$ 和 $a = 0.65\\ \\mu\\mathrm{m}$。\n- 最后一个场景涉及将树突直径减半。\n\n该问题具有科学依据，因为它是将基础电学原理（欧姆定律）标准地应用于计算神经科学中的一个经典模型（电缆理论）。所提供的参数在生理上是现实的范围内。该问题提法恰当、明确且自洽，包含了推导所需量所需的所有信息。因此，该问题是有效的，我们可以继续求解。\n\n**第一部分：$r_a$ 表达式的推导**\n\n均匀导体的电阻 $R$ 由关联电阻率、长度和横截面积的公式给出：\n$$\nR = \\rho \\frac{\\ell}{A}\n$$\n其中 $\\rho$ 是材料的电阻率，$\\ell$ 是导体的长度，$A$ 是其横截面积。\n\n在树突段的背景下，细胞内介质的电阻率为 $R_i$。我们考虑一段长度为 $L$ 的节段。电流沿此长度轴向流动，因此用于计算电阻的相关长度为 $\\ell = L$。树突被建模为半径为 $a$ 的直立圆柱体，因此其横截面积 $A$ 是该半径下圆的面积：\n$$\nA = \\pi a^2\n$$\n将这些量代入通用电阻公式，我们得到长度为 $L$ 的树突段的总轴向电阻 $R_{axial}$：\n$$\nR_{axial} = R_i \\frac{L}{\\pi a^2}\n$$\n题目定义了单位长度轴向电阻 $r_a$，其单位是电阻每长度（例如 $\\Omega/\\text{cm}$）。它是通过将总轴向电阻 $R_{axial}$ 除以节段的长度 $L$ 得到的：\n$$\nr_a = \\frac{R_{axial}}{L}\n$$\n代入 $R_{axial}$ 的表达式：\n$$\nr_a = \\frac{1}{L} \\left( R_i \\frac{L}{\\pi a^2} \\right)\n$$\n长度 $L$ 被消去，得到用电阻率 $R_i$ 和半径 $a$ 表示的单位长度轴向电阻的所需表达式：\n$$\nr_a = \\frac{R_i}{\\pi a^2}\n$$\n\n**第二部分：$r_a$ 的数值计算**\n\n我们被给予以下数值：\n- 电阻率，$R_i = 130\\ \\Omega\\cdot\\text{cm}$。\n- 半径，$a = 0.65\\ \\mu\\text{m}$。\n\n为了计算 $r_a$，单位必须一致。由于 $R_i$ 的单位是 $\\Omega\\cdot\\text{cm}$，我们必须将半径 $a$ 从微米 ($\\mu\\text{m}$) 转换为厘米 ($\\text{cm}$)。我们知道 $1\\ \\mu\\text{m} = 10^{-4}\\ \\text{cm}$。因此：\n$$\na = 0.65\\ \\mu\\text{m} = 0.65 \\times 10^{-4}\\ \\text{cm}\n$$\n现在，我们将 $R_i$ 和 $a$ 的数值代入推导出的 $r_a$ 公式中：\n$$\nr_a = \\frac{130\\ \\Omega\\cdot\\text{cm}}{\\pi (0.65 \\times 10^{-4}\\ \\text{cm})^2}\n$$\n$$\nr_a = \\frac{130}{\\pi (0.65)^2 (10^{-4})^2} \\frac{\\Omega\\cdot\\text{cm}}{\\text{cm}^2}\n$$\n$$\nr_a = \\frac{130}{\\pi (0.4225) (10^{-8})} \\frac{\\Omega}{\\text{cm}}\n$$\n$$\nr_a = \\frac{130}{\\pi \\times 0.4225} \\times 10^8 \\frac{\\Omega}{\\text{cm}}\n$$\n计算分母项 $\\pi \\times 0.4225 \\approx 1.32732...$\n$$\nr_a \\approx \\frac{130}{1.32732} \\times 10^8 \\frac{\\Omega}{\\text{cm}} \\approx 97.9416 \\times 10^6 \\frac{\\Omega}{\\text{cm}}\n$$\n用标准科学记数法表示，结果为 $9.79416 \\times 10^7\\ \\Omega/\\text{cm}$。题目要求四舍五入到 $3$ 位有效数字。\n$$\nr_a \\approx 9.79 \\times 10^7\\ \\frac{\\Omega}{\\text{cm}}\n$$\n\n**第三部分：乘法因子的确定**\n\n设树突的初始状态半径为 $a_1$，单位长度轴向电阻为 $r_{a,1}$。直径减半后的最终状态半径为 $a_2$，单位长度轴向电阻为 $r_{a,2}$。电阻率 $R_i$ 是恒定的。\n半径和直径 $d$ 之间的关系是 $d = 2a$。如果初始直径是 $d_1$，则新直径是 $d_2 = \\frac{d_1}{2}$。\n新半径 $a_2$ 与新直径 $d_2$ 的关系是 $a_2 = \\frac{d_2}{2}$。代入 $d_2$ 的表达式：\n$$\na_2 = \\frac{1}{2} \\left(\\frac{d_1}{2}\\right) = \\frac{d_1}{4}\n$$\n由于初始半径是 $a_1 = \\frac{d_1}{2}$，我们可以用旧半径表示新半径：\n$$\na_2 = \\frac{1}{2} \\left(\\frac{d_1}{2}\\right) = \\frac{1}{2} a_1\n$$\n所以，直径减半等同于半径减半。\n\n初始的单位长度轴向电阻是：\n$$\nr_{a,1} = \\frac{R_i}{\\pi a_1^2}\n$$\n最终的单位长度轴向电阻是：\n$$\nr_{a,2} = \\frac{R_i}{\\pi a_2^2}\n$$\n代入 $a_2 = \\frac{a_1}{2}$：\n$$\nr_{a,2} = \\frac{R_i}{\\pi \\left(\\frac{a_1}{2}\\right)^2} = \\frac{R_i}{\\pi \\frac{a_1^2}{4}} = 4 \\left( \\frac{R_i}{\\pi a_1^2} \\right)\n$$\n识别出括号中的项为 $r_{a,1}$，我们得到：\n$$\nr_{a,2} = 4 \\cdot r_{a,1}\n$$\n$r_a$ 变化的乘法因子是最终值与初始值的比率：\n$$\n\\text{因子} = \\frac{r_{a,2}}{r_{a,1}} = \\frac{4 \\cdot r_{a,1}}{r_{a,1}} = 4\n$$\n因此，将树突的直径减半会使其单位长度轴向电阻增加为原来的 $4$ 倍。这是因为电阻与横截面积成反比，而横截面积本身又与半径（或直径）的平方成正比。半径减半使面积减少为原来的 $1/4$，从而使电阻增加为原来的 $4$ 倍。\n题目指定最终答案仅报告此因子。",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "理解了单位长度的基本参数后，我们将视野扩展到一段有限长度的树突。本练习探讨了输入电阻（$R_{\\text{in}}$），它衡量了树突对输入的响应能力，并揭示了它不仅取决于自身的内在属性，还取决于它在整个神经元中所处的位置和连接方式 。通过为不同的边界条件推导和比较$R_{\\text{in}}$，您将体会到树突的电学特性是如何依赖于其上下文的。",
            "id": "3974785",
            "problem": "考虑一个长度为 $L$、半径为 $a$ 的无源、均匀、圆柱形树突电缆，其比膜电阻为 $R_{m}$，胞内（轴向）电阻率为 $R_{i}$。假设膜具有线性阈下特性，并且处于稳态直流（DC）条件下，因此一维稳态电缆方程适用。令 $x=0$ 表示注入电流的远端尖端，$x=L$ 表示近端。膜电位 $V(x)$ 满足稳态电缆方程 $d^{2}V/dx^{2} = V/\\lambda^{2}$，其中长度常数 $\\lambda$ 与单位长度膜电阻 $r_{m}$ 和单位长度轴向电阻 $r_{a}$ 的关系为 $\\lambda = \\sqrt{r_{m}/r_{a}}$。对于圆柱体，$r_{m} = R_{m}/(2\\pi a)$ 且 $r_{a} = R_{i}/(\\pi a^{2})$。\n\n一个小的稳态电流 $I$ 在远端尖端 $x=0$ 处注入。轴向电流为 $I_{a}(x) = -(1/r_{a})\\, dV/dx$。在注入点，进入电缆的轴向电流必须等于注入的电流，因此 $I_{a}(0^{+}) = I$。\n\n在近端 $x=L$ 处，考虑两种不同的边界条件：\n- 接地端 (Killed end)：$V(L) = 0$。\n- 密封端 (Sealed end)：$I_{a}(L) = 0$。\n\n从稳态电缆方程和上述定义出发，推导在每种边界条件下远端输入电阻 $R_{\\text{in}} = V(0)/I$ 的表达式。然后，对于给定的具体参数值 $L = 1.0\\,\\text{mm}$，$a = 1\\,\\mu\\text{m}$，$R_{m} = 1.0 \\times 10^{4}\\,\\Omega\\cdot\\text{cm}^{2}$ 和 $R_{i} = 150\\,\\Omega\\cdot\\text{cm}$，计算密封端和接地端情况下远端输入电阻的比值，即\n$$\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}}.$$\n将您的答案四舍五入到四位有效数字。将您的最终答案表示为一个无单位的纯数。在您的推导过程中，简要解释为什么这两种边界条件会产生不同的远端输入电阻，并说明每种边界条件如何限制轴向电流和电压。",
            "solution": "该问题要求推导和计算在近端存在两种不同边界条件下，无源树突电缆的远端输入电阻之比。分析从一维稳态电缆方程开始。\n\n稳态条件下膜电位 $V(x)$ 的控制方程为：\n$$\n\\frac{d^2V}{dx^2} = \\frac{V}{\\lambda^2}\n$$\n这是一个二阶线性齐次常微分方程。其通解可以用双曲函数表示：\n$$\nV(x) = A \\cosh\\left(\\frac{x}{\\lambda}\\right) + B \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\n其中 $A$ 和 $B$ 是由边界条件决定的常数。\n\n轴向电流 $I_a(x)$ 定义为：\n$$\nI_a(x) = -\\frac{1}{r_a} \\frac{dV}{dx}\n$$\n对 $V(x)$ 的通解求导，得到：\n$$\n\\frac{dV}{dx} = \\frac{A}{\\lambda} \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{B}{\\lambda} \\cosh\\left(\\frac{x}{\\lambda}\\right)\n$$\n在远端尖端（$x=0$），注入稳态电流 $I$。这为两种情况设定了第一个边界条件：\n$$\nI_a(0^+) = I \\implies -\\frac{1}{r_a} \\frac{dV}{dx}\\Big|_{x=0} = I\n$$\n代入 $x=0$ 处的导数表达式：\n$$\n-\\frac{1}{r_a} \\left[ \\frac{A}{\\lambda} \\sinh(0) + \\frac{B}{\\lambda} \\cosh(0) \\right] = I\n$$\n$$\n-\\frac{1}{r_a} \\left( \\frac{B}{\\lambda} \\right) = I \\implies B = -I r_a \\lambda\n$$\n这确定了两种情况下常数 $B$ 的值。常数 $A$ 将取决于近端 $x=L$ 处的边界条件。\n\n**情况 1：接地端 ($V(L)=0$)**\n\n近端的边界条件是 $V(L) = 0$。将其应用于通解：\n$$\nV(L) = A \\cosh\\left(\\frac{L}{\\lambda}\\right) + B \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n代入 $B$ 的值：\n$$\nA \\cosh\\left(\\frac{L}{\\lambda}\\right) - I r_a \\lambda \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n求解 $A$：\n$$\nA = I r_a \\lambda \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} = I r_a \\lambda \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\n远端的输入电阻 $R_{\\text{in}}$ 定义为 $V(0)/I$。注入点 $x=0$ 处的电压为：\n$$\nV(0) = A \\cosh(0) + B \\sinh(0) = A\n$$\n因此，接地端情况下的输入电阻为：\n$$\nR_{\\text{in}}^{\\text{killed}} = \\frac{V(0)}{I} = \\frac{I r_a \\lambda \\tanh(L/\\lambda)}{I} = r_a \\lambda \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\n\n**情况 2：密封端 ($I_a(L)=0$)**\n\n近端的边界条件是 $I_a(L) = 0$，这意味着 $\\frac{dV}{dx}\\Big|_{x=L} = 0$。将此应用于电压的导数：\n$$\n\\frac{dV}{dx}\\Big|_{x=L} = \\frac{A}{\\lambda} \\sinh\\left(\\frac{L}{\\lambda}\\right) + \\frac{B}{\\lambda} \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n这可以简化为：\n$$\nA \\sinh\\left(\\frac{L}{\\lambda}\\right) + B \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n代入 $B$ 的值：\n$$\nA \\sinh\\left(\\frac{L}{\\lambda}\\right) - I r_a \\lambda \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\n求解 $A$：\n$$\nA = I r_a \\lambda \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} = I r_a \\lambda \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\n输入电阻同样为 $R_{\\text{in}} = V(0)/I = A/I$。因此，对于密封端情况：\n$$\nR_{\\text{in}}^{\\text{sealed}} = \\frac{V(0)}{I} = \\frac{I r_a \\lambda \\coth(L/\\lambda)}{I} = r_a \\lambda \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\n\n**电阻差异的合理解释**\n\n推导出的表达式为 $R_{\\text{in}}^{\\text{killed}} = r_a \\lambda \\tanh(L/\\lambda)$ 和 $R_{\\text{in}}^{\\text{sealed}} = r_a \\lambda \\coth(L/\\lambda)$。对于任何正的无量纲长度 $L/\\lambda > 0$，根据数学性质可知 $\\coth(L/\\lambda) > \\tanh(L/\\lambda)$。因此，$R_{\\text{in}}^{\\text{sealed}} > R_{\\text{in}}^{\\text{killed}}$。\n\n这种差异的物理原因在于注入电流 $I$ 可流动的路径。总输入电阻是从注入点到地的电流流动的阻碍程度的度量。电流可以沿着电缆的长度通过分布的膜电阻泄漏出去，也可以轴向流向近端 $x=L$。\n- 在**接地端**情况下（$V(L)=0$），近端被保持在接地电位，形成一个低电阻路径或电流汇。因此，注入的电流有两条主要的接地通路：通过膜泄漏和从 $x=L$ 的末端流出。这条额外出口路径的存在降低了在注入点看到的总电阻。\n- 在**密封端**情况下（$I_a(L) = 0$），没有轴向电流可以从近端流出。该端点相当于一个开路。因此，所有注入的电流都必须沿着电缆的长度通过膜电阻泄漏出去。通过移除一条通往地的并联电流路径，电流流动的总阻碍增加，从而导致更高的输入电阻。\n\n**比值计算**\n\n远端输入电阻的比值为：\n$$\n\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}} = \\frac{r_a \\lambda \\coth(L/\\lambda)}{r_a \\lambda \\tanh(L/\\lambda)} = \\frac{\\coth(L/\\lambda)}{\\tanh(L/\\lambda)} = \\coth^2\\left(\\frac{L}{\\lambda}\\right)\n$$\n为了计算这个值，我们必须首先根据给定的参数计算无量纲长度 $L/\\lambda$。单位必须保持一致；我们将使用厘米（cm）。\n\n给定的参数是：\n$L = 1.0\\,\\text{mm} = 0.1\\,\\text{cm}$\n$a = 1\\,\\mu\\text{m} = 10^{-4}\\,\\text{cm}$\n$R_{m} = 1.0 \\times 10^{4}\\,\\Omega\\cdot\\text{cm}^{2}$\n$R_{i} = 150\\,\\Omega\\cdot\\text{cm}$\n\n首先，我们计算单位长度电阻 $r_m$ 和 $r_a$：\n$$\nr_m = \\frac{R_m}{2\\pi a} = \\frac{1.0 \\times 10^4\\,\\Omega\\cdot\\text{cm}^2}{2\\pi (10^{-4}\\,\\text{cm})} = \\frac{10^8}{2\\pi}\\,\\Omega\\cdot\\text{cm}\n$$\n$$\nr_a = \\frac{R_i}{\\pi a^2} = \\frac{150\\,\\Omega\\cdot\\text{cm}}{\\pi (10^{-4}\\,\\text{cm})^2} = \\frac{150}{\\pi \\times 10^{-8}}\\,\\Omega/\\text{cm} = \\frac{1.5 \\times 10^{10}}{\\pi}\\,\\Omega/\\text{cm}\n$$\n接下来，我们计算长度常数的平方 $\\lambda^2$：\n$$\n\\lambda^2 = \\frac{r_m}{r_a} = \\frac{\\frac{10^8}{2\\pi}\\,\\Omega\\cdot\\text{cm}}{\\frac{1.5 \\times 10^{10}}{\\pi}\\,\\Omega/\\text{cm}} = \\frac{10^8}{2\\pi} \\cdot \\frac{\\pi}{1.5 \\times 10^{10}}\\,\\text{cm}^2 = \\frac{10^8}{3 \\times 10^{10}}\\,\\text{cm}^2 = \\frac{1}{300}\\,\\text{cm}^2\n$$\n长度常数 $\\lambda$ 是：\n$$\n\\lambda = \\sqrt{\\frac{1}{300}}\\,\\text{cm} = \\frac{1}{10\\sqrt{3}}\\,\\text{cm}\n$$\n现在，我们可以计算电缆的无量纲长度 $L/\\lambda$：\n$$\n\\frac{L}{\\lambda} = \\frac{0.1\\,\\text{cm}}{\\frac{1}{10\\sqrt{3}}\\,\\text{cm}} = 0.1 \\times 10\\sqrt{3} = \\sqrt{3}\n$$\n最后，我们计算电阻的比值：\n$$\n\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}} = \\coth^2(\\sqrt{3})\n$$\n使用值 $\\sqrt{3} \\approx 1.7320508...$：\n$$\n\\coth(\\sqrt{3}) = \\frac{\\exp(\\sqrt{3}) + \\exp(-\\sqrt{3})}{\\exp(\\sqrt{3}) - \\exp(-\\sqrt{3})} \\approx 1.064593\n$$\n将该值平方：\n$$\n\\coth^2(\\sqrt{3}) \\approx (1.064593)^2 \\approx 1.133368\n$$\n四舍五入到四位有效数字，比值为 $1.133$。",
            "answer": "$$\\boxed{1.133}$$"
        },
        {
            "introduction": "理论上的连续电缆方程固然精确，但在计算机上模拟树突行为时，我们必须将其离散化为“房室模型”。本练习直面这一过程中的核心实践问题：离散模型在多大程度上能精确地复现连续的真实情况 ？通过分析离散化引入的误差，您将学会如何为房室大小的选择建立一个有理有据的标准，这是构建可靠神经元模型的关键一步。",
            "id": "3974733",
            "problem": "您正在将一个被动树突分支建模为一维电缆，并用长度为 $\\Delta x$ 的区室对其进行近似。其物理基础是被动电缆方程，这是一个线性偏微分方程(PDE)，用于描述在具有特定膜电阻 $R_m$、特定膜电容 $C_m$ 和轴向电阻率 $R_i$ 的均匀圆柱形树突上电压 $V(x,t)$ 的变化。对于角频率为 $\\omega$（单位为弧度/秒）的正弦输入，电缆方程存在谐波稳态响应，该响应由一个关于频域中复振幅 $V(x)$ 的空间常微分方程(ODE)控制。静态空间常数 $\\lambda$ 和膜时间常数 $\\tau_m$ 由经过充分检验的公式定义：$\\lambda = \\sqrt{a R_m / (2 R_i)}$ 和 $\\tau_m = R_m C_m$，其中 $a$ 是树突半径。\n\n从被动电缆方程的频域形式出发，根据第一性原理推导出：\n- 精确的连续空间传播常数 $\\gamma$（作为 $\\lambda$、$\\tau_m$ 和 $\\omega$ 的函数），以及跨越一小段长度 $\\Delta x$ 的精确连续传递比，定义为 $T_c(\\Delta x) = V(x+\\Delta x)/V(x)$。\n- 基于均匀网格（间距为 $\\Delta x$）上二阶空间导数的中心有限差分近似的离散区室模型，以及跨越一个区室的相应离散传递比 $T_d(\\Delta x)$。\n- 由离散化引起的跨越一个区室的振幅误差和相位误差的表达式，用 $T_d(\\Delta x)$ 和 $T_c(\\Delta x)$ 表示。将振幅误差定义为相对误差 $\\left|\\,|T_d|/|T_c| - 1\\,\\right|$，将相位误差定义为辐角之间的绝对差（以弧度为单位），即 $\\left| \\arg\\left(T_d/T_c\\right) \\right|$。\n\n使用这些定义，通过量化振幅和相位误差如何依赖于 $\\Delta x/\\lambda$ 和 $\\omega \\tau_m$，提供并论证一个选择 $\\Delta x$ 的标准（以空间常数 $\\lambda$ 表示），例如 $\\Delta x \\le \\lambda/10$。您的论证必须从频域电缆方程和有限差分格式出发，并且必须解释误差随 $\\Delta x$ 变化的标度关系。\n\n算法任务：实现一个程序，对于下面的每个测试用例，计算使得单个区室的振幅相对误差和相位误差都不超过指定容差的最大区室长度 $\\Delta x_{\\max}$（单位为微米）。此外，确定保守选择 $\\Delta x = \\lambda/10$ 是否满足这两个容差。相位使用弧度，长度使用微米（$\\mu$m）。将膜时间常数 $\\tau_m$ 视为毫秒，并在计算中将其转换为秒。您的程序应使用您推导出的精确连续和离散传递比，而非启发式替代方法。对于复数运算，在需要时使用复反双曲余弦的主支来定义离散的单位区室传播因子。\n\n测试套件（每个元组列出 $(\\lambda \\text{ 单位 } \\mu\\text{m}, \\tau_m \\text{ 单位 ms}, \\omega \\text{ 单位 rad/s}, \\text{振幅容差 (十进制)}, \\text{相位容差 (弧度)})$）：\n- 案例1（理想情况，直流电）：$(500.0, 20.0, 0.0, 0.01, 0.001)$。\n- 案例2（中等频率，中等容差）：$(500.0, 20.0, 200.0, 0.01, 0.01745)$。\n- 案例3（较小空间常数，更严格的振幅容差）：$(200.0, 30.0, 400.0, 0.005, 0.017)$。\n- 案例4（较大空间常数，更高频率，较宽松容差）：$(1000.0, 10.0, 1000.0, 0.02, 0.035)$。\n- 案例5（边界情况，高频）：$(300.0, 40.0, 2000.0, 0.01, 0.017)$。\n\n对于每个案例，返回一个包含两个元素的结果：$[\\Delta x_{\\max}, \\text{ok\\_at\\_tenth\\_rule}]$，其中 $\\Delta x_{\\max}$ 是一个浮点数，表示满足两个容差的最大区室长度（单位为 $\\mu$m），四舍五入到三位小数，而 `ok_at_tenth_rule` 是一个布尔值，指示使用 $\\Delta x=\\lambda/10$ 是否满足两个容差。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号括起来，每个元素是对应一个测试用例的双元素列表，例如 $[[\\Delta x_{\\max,1}, \\text{True}], [\\Delta x_{\\max,2}, \\text{False}], \\dots]$。角度必须以弧度为单位，长度以微米为单位，振幅容差必须是十进制数（例如，用 $0.01$ 而不是 $1\\%$）。",
            "solution": "该问题要求对被动树突电缆中电压传播的连续和离散表示进行基于原理的推导，分析离散化误差，并设计一个算法来找到满足给定误差容差的最大区室尺寸 $\\Delta x_{max}$。\n\n首先，我们推导连续传递函数。时域中的被动电缆方程由下式给出：\n$$ \\tau_m \\frac{\\partial V}{\\partial t} = \\lambda^2 \\frac{\\partial^2 V}{\\partial x^2} - V $$\n其中 $V(x,t)$ 是电压，$\\tau_m$ 是膜时间常数，$\\lambda$ 是空间常数。对于角频率为 $\\omega$ 的正弦输入，我们假设一个稳态解的形式为 $V(x,t) = \\text{Re}\\{V(x) e^{i\\omega t}\\}$，其中 $V(x)$ 是一个复振幅。将此代入电缆方程，得到一个关于 $V(x)$ 的常微分方程(ODE)：\n$$ \\tau_m (i\\omega) V(x) = \\lambda^2 \\frac{d^2 V(x)}{dx^2} - V(x) $$\n整理后得到亥姆霍兹方程的标准形式：\n$$ \\frac{d^2 V(x)}{dx^2} = \\frac{1+i\\omega\\tau_m}{\\lambda^2} V(x) $$\n该方程的形式为 $\\frac{d^2V}{dx^2} = \\gamma^2 V$，其中 $\\gamma$ 是复传播常数。因此，我们确定精确的连续空间传播常数为：\n$$ \\gamma = \\frac{\\sqrt{1+i\\omega\\tau_m}}{\\lambda} $$\n对于沿正 $x$ 方向传播的波，解为 $V(x) = V(0) e^{-\\gamma x}$。跨越长度为 $\\Delta x$ 的线段的精确连续传递比 $T_c(\\Delta x)$ 是比率 $V(x+\\Delta x)/V(x)$：\n$$ T_c(\\Delta x) = \\frac{V(0) e^{-\\gamma (x+\\Delta x)}}{V(0) e^{-\\gamma x}} = e^{-\\gamma \\Delta x} $$\n代入 $\\gamma$ 的表达式，我们得到：\n$$ T_c(\\Delta x) = \\exp\\left(-\\frac{\\Delta x}{\\lambda}\\sqrt{1+i\\omega\\tau_m}\\right) $$\n\n接下来，我们使用有限差分近似推导离散表示。我们将树突表示为一系列长度为 $\\Delta x$ 的区室，其中第 $j$ 个区室中心的电压为 $V_j$。位置 $j$ 处的二阶空间导数 $\\frac{d^2V}{dx^2}$ 使用中心差分格式近似：\n$$ \\left.\\frac{d^2V}{dx^2}\\right|_j \\approx \\frac{V_{j+1} - 2V_j + V_{j-1}}{(\\Delta x)^2} $$\n将此代入频域ODE，得到区室电压的代数递推关系：\n$$ \\lambda^2 \\frac{V_{j+1} - 2V_j + V_{j-1}}{(\\Delta x)^2} = (1+i\\omega\\tau_m)V_j $$\n假设离散系统中有行波解，我们有 $V_{j+1} = T_d V_j$ 和 $V_{j-1} = T_d^{-1} V_j$，其中 $T_d$ 是离散传递比。将此代入递推关系得到：\n$$ \\lambda^2 \\frac{T_d V_j - 2V_j + T_d^{-1} V_j}{(\\Delta x)^2} = (1+i\\omega\\tau_m)V_j $$\n两边除以 $V_j$ 并整理得：\n$$ T_d + T_d^{-1} = 2 + \\frac{(\\Delta x)^2}{\\lambda^2}(1+i\\omega\\tau_m) $$\n注意到 $z + z^{-1} = 2 \\cosh(\\ln z)$，我们可以定义一个离散传播因子 $g_d$ 使得 $T_d = e^{-g_d}$。这得到 $e^{g_d} + e^{-g_d} = 2 \\cosh(g_d)$。因此：\n$$ 2\\cosh(g_d) = 2 + \\frac{(\\Delta x)^2}{\\lambda^2}(1+i\\omega\\tau_m) \\implies \\cosh(g_d) = 1 + \\frac{(\\Delta x)^2}{2\\lambda^2}(1+i\\omega\\tau_m) $$\n因此，离散传播因子为 $g_d = \\text{arccosh}\\left(1 + \\frac{(\\Delta x)^2}{2\\lambda^2}(1+i\\omega\\tau_m)\\right)$，使用复反双曲余弦的主支以获得对应于衰减波的唯一解。跨越一个区室的离散传递比是：\n$$ T_d(\\Delta x) = e^{-g_d} = \\exp\\left(-\\text{arccosh}\\left(1 + \\frac{(\\Delta x)^2}{2\\lambda^2}(1+i\\omega\\tau_m)\\right)\\right) $$\n\n问题将由离散化引起的振幅误差 $\\varepsilon_A$ 和相位误差 $\\varepsilon_\\Phi$ 定义为：\n$$ \\varepsilon_A = \\left| \\frac{|T_d(\\Delta x)|}{|T_c(\\Delta x)|} - 1 \\right| \\quad \\text{和} \\quad \\varepsilon_\\Phi = \\left| \\arg\\left(\\frac{T_d(\\Delta x)}{T_c(\\Delta x)}\\right) \\right| $$\n为了论证诸如 $\\Delta x \\le \\lambda/10$ 的离散化标准，我们分析小 $\\Delta x$ 时的误差标度关系。我们使用 $\\text{arccosh}(1+z) \\approx \\sqrt{2z}$ 对小 $z$ 的泰勒级数展开。令 $z = \\frac{(\\Delta x)^2}{2\\lambda^2}(1+i\\omega\\tau_m) = \\frac{(\\gamma \\Delta x)^2}{2}$。\n$$ g_d = \\text{arccosh}(1+z) \\approx \\sqrt{2z} = \\sqrt{(\\gamma \\Delta x)^2} = \\gamma \\Delta x $$\n这表明当 $\\Delta x \\to 0$ 时，$g_d \\to \\gamma \\Delta x$，因此 $T_d \\to T_c$。为了更精确地分析误差，我们使用级数展开的下一项：$\\text{arccosh}(1+z) = \\sqrt{2z}(1 - \\frac{z}{12} + O(z^2))$。\n$$ g_d \\approx \\gamma \\Delta x \\left(1 - \\frac{(\\gamma \\Delta x)^2}{24}\\right) = \\gamma \\Delta x - \\frac{\\gamma^3 (\\Delta x)^3}{24} $$\n传递函数的比值为 $T_d/T_c = e^{-g_d}/e^{-\\gamma \\Delta x} = e^{\\gamma \\Delta x - g_d}$。\n$$ \\frac{T_d(\\Delta x)}{T_c(\\Delta x)} \\approx \\exp\\left(\\frac{\\gamma^3 (\\Delta x)^3}{24}\\right) $$\n对于小宗量，$e^u \\approx 1+u$。因此，\n$$ \\frac{T_d(\\Delta x)}{T_c(\\Delta x)} \\approx 1 + \\frac{\\gamma^3 (\\Delta x)^3}{24} = 1 + \\frac{1}{24}\\left(\\frac{\\Delta x}{\\lambda}\\right)^3 (1+i\\omega\\tau_m)^{3/2} $$\n误差向量 $T_d/T_c - 1$ 的大小与 $(\\Delta x/\\lambda)^3$ 成比例。这种对归一化区室长度 $\\Delta x/\\lambda$ 的三次方依赖关系是关键的洞见。这意味着将 $\\Delta x$ 减小2倍，误差将减小8倍。选择一个小的比率如 $\\Delta x/\\lambda = 1/10$ 会在主导误差项中引入一个 $(1/10)^3 = 10^{-3}$ 的因子，这为保持误差较小提供了强有力的基础，特别是在中低频率下，此时 $(1+i\\omega\\tau_m)^{3/2}$ 项不会过大。误差会随频率增加而增长，因此需要更小的 $\\Delta x$ 来维持精度。\n\n为了找到允许的最大区室长度 $\\Delta x_{\\max}$，我们必须找到满足 $\\varepsilon_A \\le \\text{tolerance}_A$ 和 $\\varepsilon_\\Phi \\le \\text{tolerance}_\\Phi$ 的最大 $\\Delta x$。由于误差函数 $\\varepsilon_A(\\Delta x)$ 和 $\\varepsilon_\\Phi(\\Delta x)$ 在我们感兴趣的范围内都是随 $\\Delta x$ 单调递增的，我们可以采用数值二分搜索（二分法）。我们在区间 $[0, \\lambda]$ 中搜索 $\\Delta x$，迭代地优化区间，直到找到满足两个条件的最大 $\\Delta x$ 达到所需精度。我们还检查特定选择 $\\Delta x = \\lambda/10$ 是否满足标准。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the dendritic compartment modeling problem for the given test suite.\n    \"\"\"\n\n    test_cases = [\n        # (lambda in um, tau_m in ms, omega in rad/s, amp_tol, phase_tol)\n        (500.0, 20.0, 0.0, 0.01, 0.001),\n        (500.0, 20.0, 200.0, 0.01, 0.01745),\n        (200.0, 30.0, 400.0, 0.005, 0.017),\n        (1000.0, 10.0, 1000.0, 0.02, 0.035),\n        (300.0, 40.0, 2000.0, 0.01, 0.017),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        lam, tau_m_ms, omega, amp_tol, phase_tol = case\n        \n        # Convert tau_m from ms to seconds for SI unit consistency\n        tau_m_s = tau_m_ms / 1000.0\n\n        def calculate_errors(delta_x, lam_val, tau_m_s_val, omega_val):\n            \"\"\"\n            Calculates amplitude and phase errors for a given compartment size delta_x.\n            \"\"\"\n            if delta_x == 0:\n                return 0.0, 0.0\n\n            # Complex term in the cable equation\n            complex_factor = 1.0 + 1j * omega_val * tau_m_s_val\n\n            # Continuum model\n            gamma = np.sqrt(complex_factor) / lam_val\n            t_c = np.exp(-gamma * delta_x)\n\n            # Discrete model\n            z = 1.0 + (delta_x**2 / (2.0 * lam_val**2)) * complex_factor\n            g_d = np.arccosh(z) # Uses principal branch\n            t_d = np.exp(-g_d)\n\n            # Error calculation\n            # Avoid division by zero if t_c is numerically zero (for very large delta_x)\n            if np.abs(t_c)  1e-15:\n                # If t_c is zero, t_d will also be effectively zero. The ratio is ill-defined\n                # but the deviation is maximal. We can return large errors.\n                return np.inf, np.pi\n\n            ratio_t_d_t_c = t_d / t_c\n            \n            amp_error = np.abs(np.abs(ratio_t_d_t_c) - 1.0)\n            phase_error = np.abs(np.angle(ratio_t_d_t_c))\n            \n            return amp_error, phase_error\n\n        # Binary search for delta_x_max\n        low = 0.0\n        high = 2.0 * lam  # A safe upper bound for the search\n        delta_x_max = 0.0\n\n        # Run for a fixed number of iterations for sufficient precision\n        for _ in range(100):\n            mid = (low + high) / 2.0\n            if mid == 0: # Avoid infinite loop at the start\n                low = mid\n                continue\n\n            amp_err, phase_err = calculate_errors(mid, lam, tau_m_s, omega)\n            \n            if amp_err = amp_tol and phase_err = phase_tol:\n                # This delta_x is valid, try for a larger one\n                delta_x_max = mid\n                low = mid\n            else:\n                # This delta_x is too large\n                high = mid\n        \n        # Check if delta_x = lambda/10 satisfies the tolerances\n        dx_test = lam / 10.0\n        amp_err_test, phase_err_test = calculate_errors(dx_test, lam, tau_m_s, omega)\n        ok_at_tenth_rule = (amp_err_test = amp_tol) and (phase_err_test = phase_tol)\n\n        # Store results for the current case\n        results.append([round(delta_x_max, 3), ok_at_tenth_rule])\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{str(res[1])}]\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}