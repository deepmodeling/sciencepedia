{
    "hands_on_practices": [
        {
            "introduction": "To model a dendritic tree, we first must understand the fundamental electrical properties of its constituent parts. This exercise grounds our understanding in basic physics, guiding you to derive the axial resistance per unit length, $r_a$, a parameter that dictates how easily current flows along a dendrite's core. By exploring how $r_a$ is inversely proportional to the cross-sectional area, you will uncover the profound impact of dendritic diameter on signal propagation .",
            "id": "3974745",
            "problem": "A straight dendritic segment is modeled as a uniform right circular cylinder of radius $a$ and length $L$, with homogeneous intracellular medium characterized by specific resistivity $R_i$ (units $\\Omega\\cdot\\text{cm}$). In multicompartment cable modeling, the axial resistance per unit length $r_a$ (units $\\Omega/\\text{cm}$) quantifies the opposition to axial current flow along the dendrite and determines the strength of longitudinal coupling between adjacent compartments.\n\nStarting from the continuum form of Ohm’s law and the definition of resistance for a homogeneous conductor of length $L$ and cross-sectional area $A$, derive an expression for the axial resistance per unit length $r_a$ in terms of $R_i$ and $a$ for a uniform cylindrical dendrite. Then, evaluate $r_a$ numerically for a dendrite with $R_i = 130\\ \\Omega\\cdot\\text{cm}$ and $a = 0.65\\ \\mu\\mathrm{m}$. Express the numerical value of $r_a$ in $\\Omega/\\text{cm}$ and round to $3$ significant figures.\n\nFinally, suppose the dendritic diameter is halved while $R_i$ remains unchanged. Determine the multiplicative factor by which $r_a$ changes under this diameter halving. Report only this factor as your final answer, as a pure number with no units.",
            "solution": "The problem asks for three distinct results: first, a derivation of the axial resistance per unit length $r_a$ for a cylindrical dendrite; second, a numerical evaluation of $r_a$ for given parameters; and third, the multiplicative factor by which $r_a$ changes when the dendritic diameter is halved. The final answer should be only this multiplicative factor.\n\nTo begin, we validate the problem statement.\nThe givens are:\n- The dendritic segment is modeled as a uniform right circular cylinder of radius $a$ and length $L$.\n- The intracellular medium is homogeneous with specific resistivity $R_i$.\n- The axial resistance per unit length is denoted by $r_a$ with units $\\Omega/\\text{cm}$.\n- The starting points are the continuum form of Ohm’s law and the definition of resistance for a homogeneous conductor.\n- For numerical evaluation: $R_i = 130\\ \\Omega\\cdot\\text{cm}$ and $a = 0.65\\ \\mu\\mathrm{m}$.\n- A final scenario involves halving the dendritic diameter.\n\nThe problem is scientifically grounded, as it is a standard application of fundamental electrical principles (Ohm's law) to a canonical model in computational neuroscience (cable theory). The parameters provided are within a physiologically realistic range. The problem is well-posed, unambiguous, and self-contained. It contains all necessary information to derive the requested quantities. Therefore, the problem is valid and we may proceed with the solution.\n\n**Part 1: Derivation of the expression for $r_a$**\n\nThe resistance $R$ of a homogeneous conductor is given by the formula relating resistivity, length, and cross-sectional area:\n$$\nR = \\rho \\frac{\\ell}{A}\n$$\nwhere $\\rho$ is the specific resistivity of the material, $\\ell$ is the length of the conductor, and $A$ is its cross-sectional area.\n\nIn the context of the dendritic segment, the specific resistivity of the intracellular medium is given as $R_i$. We consider a segment of length $L$. The current flows axially along this length, so the relevant length for the resistance calculation is $\\ell = L$. The dendrite is modeled as a right circular cylinder of radius $a$, so its cross-sectional area $A$ is the area of a circle with this radius:\n$$\nA = \\pi a^2\n$$\nSubstituting these quantities into the general resistance formula, we obtain the total axial resistance, $R_{axial}$, of a dendritic segment of length $L$:\n$$\nR_{axial} = R_i \\frac{L}{\\pi a^2}\n$$\nThe problem defines the axial resistance per unit length, $r_a$, which has units of resistance per length (e.g., $\\Omega/\\text{cm}$). It is obtained by dividing the total axial resistance $R_{axial}$ by the length $L$ of the segment:\n$$\nr_a = \\frac{R_{axial}}{L}\n$$\nSubstituting the expression for $R_{axial}$:\n$$\nr_a = \\frac{1}{L} \\left( R_i \\frac{L}{\\pi a^2} \\right)\n$$\nThe length $L$ cancels out, yielding the desired expression for the axial resistance per unit length in terms of the specific resistivity $R_i$ and the radius $a$:\n$$\nr_a = \\frac{R_i}{\\pi a^2}\n$$\n\n**Part 2: Numerical evaluation of $r_a$**\n\nWe are given the following values:\n- Specific resistivity, $R_i = 130\\ \\Omega\\cdot\\text{cm}$.\n- Radius, $a = 0.65\\ \\mu\\text{m}$.\n\nTo calculate $r_a$, the units must be consistent. Since $R_i$ is given in $\\Omega\\cdot\\text{cm}$, we must convert the radius $a$ from micrometers ($\\mu\\text{m}$) to centimeters ($\\text{cm}$).\nWe know that $1\\ \\mu\\text{m} = 10^{-4}\\ \\text{cm}$. Therefore:\n$$\na = 0.65\\ \\mu\\text{m} = 0.65 \\times 10^{-4}\\ \\text{cm}\n$$\nNow, we substitute the numerical values for $R_i$ and $a$ into the derived formula for $r_a$:\n$$\nr_a = \\frac{130\\ \\Omega\\cdot\\text{cm}}{\\pi (0.65 \\times 10^{-4}\\ \\text{cm})^2}\n$$\n$$\nr_a = \\frac{130}{\\pi (0.65)^2 (10^{-4})^2} \\frac{\\Omega\\cdot\\text{cm}}{\\text{cm}^2}\n$$\n$$\nr_a = \\frac{130}{\\pi (0.4225) (10^{-8})} \\frac{\\Omega}{\\text{cm}}\n$$\n$$\nr_a = \\frac{130}{\\pi \\times 0.4225} \\times 10^8 \\frac{\\Omega}{\\text{cm}}\n$$\nCalculating the denominator term $\\pi \\times 0.4225 \\approx 1.32732...$\n$$\nr_a \\approx \\frac{130}{1.32732} \\times 10^8 \\frac{\\Omega}{\\text{cm}} \\approx 97.9416 \\times 10^6 \\frac{\\Omega}{\\text{cm}}\n$$\nIn standard scientific notation, this is $9.79416 \\times 10^7\\ \\Omega/\\text{cm}$. The problem requires rounding to $3$ significant figures.\n$$\nr_a \\approx 9.79 \\times 10^7\\ \\frac{\\Omega}{\\text{cm}}\n$$\n\n**Part 3: Determination of the multiplicative factor**\n\nLet the initial state of the dendrite have radius $a_1$ and axial resistance per unit length $r_{a,1}$. The final state, after the diameter is halved, will have radius $a_2$ and axial resistance per unit length $r_{a,2}$. The specific resistivity $R_i$ is constant.\nThe relationship between radius and diameter $d$ is $d = 2a$. If the initial diameter is $d_1$, the new diameter is $d_2 = \\frac{d_1}{2}$.\nThe new radius $a_2$ is related to the new diameter $d_2$ by $a_2 = \\frac{d_2}{2}$. Substituting the expression for $d_2$:\n$$\na_2 = \\frac{1}{2} \\left(\\frac{d_1}{2}\\right) = \\frac{d_1}{4}\n$$\nSince the initial radius is $a_1 = \\frac{d_1}{2}$, we can express the new radius in terms of the old radius:\n$$\na_2 = \\frac{1}{2} \\left(\\frac{d_1}{2}\\right) = \\frac{1}{2} a_1\n$$\nSo, halving the diameter is equivalent to halving the radius.\n\nThe initial axial resistance per unit length is:\n$$\nr_{a,1} = \\frac{R_i}{\\pi a_1^2}\n$$\nThe final axial resistance per unit length is:\n$$\nr_{a,2} = \\frac{R_i}{\\pi a_2^2}\n$$\nSubstituting $a_2 = \\frac{a_1}{2}$:\n$$\nr_{a,2} = \\frac{R_i}{\\pi \\left(\\frac{a_1}{2}\\right)^2} = \\frac{R_i}{\\pi \\frac{a_1^2}{4}} = 4 \\left( \\frac{R_i}{\\pi a_1^2} \\right)\n$$\nRecognizing the term in the parentheses as $r_{a,1}$, we have:\n$$\nr_{a,2} = 4 \\cdot r_{a,1}\n$$\nThe multiplicative factor by which $r_a$ changes is the ratio of the final value to the initial value:\n$$\n\\text{Factor} = \\frac{r_{a,2}}{r_{a,1}} = \\frac{4 \\cdot r_{a,1}}{r_{a,1}} = 4\n$$\nThus, halving the diameter of the dendrite increases its axial resistance per unit length by a factor of $4$. This is because the resistance is inversely proportional to the cross-sectional area, which itself is proportional to the square of the radius (or diameter). Halving the radius reduces the area by a factor of $4$, thereby increasing the resistance by a factor of $4$.\nThe problem specifies that only this factor should be reported as the final answer.",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "Building on the concept of axial resistance, we now scale up to analyze a finite dendritic cable. This practice explores how a dendrite's input resistance, $R_{\\text{in}}$, a crucial factor determining its response to synaptic currents, is shaped not only by its intrinsic properties but also by its boundary conditions. By comparing a \"sealed end\" to a \"killed end,\" you will develop an intuition for how a branch's termination point affects its integrative function within the larger neuron .",
            "id": "3974785",
            "problem": "Consider a passive, uniform, cylindrical dendritic cable of length $L$ and radius $a$, with specific membrane resistance $R_{m}$ and intracellular (axial) resistivity $R_{i}$. Assume linear subthreshold membrane properties and steady direct current (DC) conditions so that the one-dimensional steady-state cable equation applies. Let $x=0$ denote the distal tip where current is injected, and $x=L$ the proximal end. The membrane potential $V(x)$ satisfies the steady-state cable equation $d^{2}V/dx^{2} = V/\\lambda^{2}$, where the length constant $\\lambda$ is related to the per-unit-length membrane resistance $r_{m}$ and axial resistance $r_{a}$ by $\\lambda = \\sqrt{r_{m}/r_{a}}$. For a cylinder, $r_{m} = R_{m}/(2\\pi a)$ and $r_{a} = R_{i}/(\\pi a^{2})$.\n\nA small steady current $I$ is injected at the distal tip $x=0$. The axial current is $I_{a}(x) = -(1/r_{a})\\, dV/dx$. At the injection site, the axial current entering the cable must equal the injected current, so $I_{a}(0^{+}) = I$.\n\nAt the proximal end $x=L$, consider two alternative boundary conditions:\n- Killed end: $V(L) = 0$.\n- Sealed end: $I_{a}(L) = 0$.\n\nStarting from the steady-state cable equation and the above definitions, derive expressions for the distal input resistance $R_{\\text{in}} = V(0)/I$ under each boundary condition. Then, for the specific parameter values $L = 1.0\\,\\text{mm}$, $a = 1\\,\\mu\\text{m}$, $R_{m} = 1.0 \\times 10^{4}\\,\\Omega\\cdot\\text{cm}^{2}$, and $R_{i} = 150\\,\\Omega\\cdot\\text{cm}$, compute the ratio of the distal input resistances between the sealed and killed cases, that is,\n$$\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}}.$$\nRound your answer to four significant figures. Express your final answer as a pure number with no units. Briefly justify, in your derivation, why the two boundary conditions produce different distal input resistances in terms of how each boundary condition constrains axial current and voltage.",
            "solution": "The problem requires the derivation and calculation of the ratio of distal input resistances for a passive dendritic cable under two different boundary conditions at the proximal end. The analysis begins with the one-dimensional steady-state cable equation.\n\nThe governing equation for the membrane potential $V(x)$ under steady-state conditions is given as:\n$$\n\\frac{d^2V}{dx^2} = \\frac{V}{\\lambda^2}\n$$\nThis is a second-order linear homogeneous ordinary differential equation. The general solution can be written in terms of hyperbolic functions:\n$$\nV(x) = A \\cosh\\left(\\frac{x}{\\lambda}\\right) + B \\sinh\\left(\\frac{x}{\\lambda}\\right)\n$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\n\nThe axial current $I_a(x)$ is defined as:\n$$\nI_a(x) = -\\frac{1}{r_a} \\frac{dV}{dx}\n$$\nDifferentiating the general solution for $V(x)$ gives:\n$$\n\\frac{dV}{dx} = \\frac{A}{\\lambda} \\sinh\\left(\\frac{x}{\\lambda}\\right) + \\frac{B}{\\lambda} \\cosh\\left(\\frac{x}{\\lambda}\\right)\n$$\nAt the distal tip ($x=0$), a steady current $I$ is injected. This sets the first boundary condition for both cases:\n$$\nI_a(0^+) = I \\implies -\\frac{1}{r_a} \\frac{dV}{dx}\\Big|_{x=0} = I\n$$\nSubstituting the expression for the derivative at $x=0$:\n$$\n-\\frac{1}{r_a} \\left[ \\frac{A}{\\lambda} \\sinh(0) + \\frac{B}{\\lambda} \\cosh(0) \\right] = I\n$$\n$$\n-\\frac{1}{r_a} \\left( \\frac{B}{\\lambda} \\right) = I \\implies B = -I r_a \\lambda\n$$\nThis determines the constant $B$ for both scenarios. The constant $A$ will depend on the boundary condition at the proximal end, $x=L$.\n\n**Case 1: Killed End ($V(L)=0$)**\n\nThe boundary condition at the proximal end is $V(L) = 0$. Applying this to the general solution:\n$$\nV(L) = A \\cosh\\left(\\frac{L}{\\lambda}\\right) + B \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\nSubstituting the value of $B$:\n$$\nA \\cosh\\left(\\frac{L}{\\lambda}\\right) - I r_a \\lambda \\sinh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\nSolving for $A$:\n$$\nA = I r_a \\lambda \\frac{\\sinh(L/\\lambda)}{\\cosh(L/\\lambda)} = I r_a \\lambda \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\nThe input resistance at the distal end, $R_{\\text{in}}$, is defined as $V(0)/I$. The voltage at the injection site $x=0$ is:\n$$\nV(0) = A \\cosh(0) + B \\sinh(0) = A\n$$\nTherefore, the input resistance for the killed-end case is:\n$$\nR_{\\text{in}}^{\\text{killed}} = \\frac{V(0)}{I} = \\frac{I r_a \\lambda \\tanh(L/\\lambda)}{I} = r_a \\lambda \\tanh\\left(\\frac{L}{\\lambda}\\right)\n$$\n\n**Case 2: Sealed End ($I_a(L)=0$)**\n\nThe boundary condition at the proximal end is $I_a(L) = 0$, which implies $\\frac{dV}{dx}\\Big|_{x=L} = 0$. Applying this to the derivative of the voltage:\n$$\n\\frac{dV}{dx}\\Big|_{x=L} = \\frac{A}{\\lambda} \\sinh\\left(\\frac{L}{\\lambda}\\right) + \\frac{B}{\\lambda} \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\nThis simplifies to:\n$$\nA \\sinh\\left(\\frac{L}{\\lambda}\\right) + B \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\nSubstituting the value of $B$:\n$$\nA \\sinh\\left(\\frac{L}{\\lambda}\\right) - I r_a \\lambda \\cosh\\left(\\frac{L}{\\lambda}\\right) = 0\n$$\nSolving for $A$:\n$$\nA = I r_a \\lambda \\frac{\\cosh(L/\\lambda)}{\\sinh(L/\\lambda)} = I r_a \\lambda \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\nThe input resistance is again $R_{\\text{in}} = V(0)/I = A/I$. Therefore, for the sealed-end case:\n$$\nR_{\\text{in}}^{\\text{sealed}} = \\frac{V(0)}{I} = \\frac{I r_a \\lambda \\coth(L/\\lambda)}{I} = r_a \\lambda \\coth\\left(\\frac{L}{\\lambda}\\right)\n$$\n\n**Justification for the Difference in Resistances**\n\nThe derived expressions are $R_{\\text{in}}^{\\text{killed}} = r_a \\lambda \\tanh(L/\\lambda)$ and $R_{\\textin}^{\\text{sealed}} = r_a \\lambda \\coth(L/\\lambda)$. For any positive dimensionless length $L/\\lambda > 0$, it is a mathematical property that $\\coth(L/\\lambda) > \\tanh(L/\\lambda)$. Consequently, $R_{\\text{in}}^{\\text{sealed}} > R_{\\text{in}}^{\\text{killed}}$.\n\nThe physical reason for this difference lies in the paths available for the injected current $I$ to flow. The total input resistance is a measure of the opposition to current flow from the injection point to ground. Current can leak out through the distributed membrane resistance along the cable's length, or it can flow axially to the proximal end at $x=L$.\n- In the **killed-end** case ($V(L) = 0$), the proximal end is held at ground potential, creating a low-resistance path, or a current sink. Thus, the injected current has two main pathways to ground: leaking through the membrane and flowing out the end at $x=L$. The presence of this additional exit path lowers the overall resistance seen at the injection site.\n- In the **sealed-end** case ($I_a(L) = 0$), no axial current can exit the proximal end. This end acts as an open circuit. All injected current must therefore leak out through the membrane resistance along the cable's length. By removing one of the parallel paths for current flow to ground, the total opposition to current flow increases, resulting in a higher input resistance.\n\n**Calculation of the Ratio**\n\nThe ratio of the distal input resistances is:\n$$\n\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}} = \\frac{r_a \\lambda \\coth(L/\\lambda)}{r_a \\lambda \\tanh(L/\\lambda)} = \\frac{\\coth(L/\\lambda)}{\\tanh(L/\\lambda)} = \\coth^2\\left(\\frac{L}{\\lambda}\\right)\n$$\nTo compute this value, we must first calculate the dimensionless length $L/\\lambda$ from the given parameters. The units must be consistent; we will use centimeters (cm).\n\nThe given parameters are:\n$L = 1.0\\,\\text{mm} = 0.1\\,\\text{cm}$\n$a = 1\\,\\mu\\text{m} = 10^{-4}\\,\\text{cm}$\n$R_{m} = 1.0 \\times 10^{4}\\,\\Omega\\cdot\\text{cm}^{2}$\n$R_{i} = 150\\,\\Omega\\cdot\\text{cm}$\n\nFirst, we calculate the per-unit-length resistances $r_m$ and $r_a$:\n$$\nr_m = \\frac{R_m}{2\\pi a} = \\frac{1.0 \\times 10^4\\,\\Omega\\cdot\\text{cm}^2}{2\\pi (10^{-4}\\,\\text{cm})} = \\frac{10^8}{2\\pi}\\,\\Omega\\cdot\\text{cm}\n$$\n$$\nr_a = \\frac{R_i}{\\pi a^2} = \\frac{150\\,\\Omega\\cdot\\text{cm}}{\\pi (10^{-4}\\,\\text{cm})^2} = \\frac{150}{\\pi \\times 10^{-8}}\\,\\Omega/\\text{cm} = \\frac{1.5 \\times 10^{10}}{\\pi}\\,\\Omega/\\text{cm}\n$$\nNext, we calculate the square of the length constant, $\\lambda^2$:\n$$\n\\lambda^2 = \\frac{r_m}{r_a} = \\frac{\\frac{10^8}{2\\pi}\\,\\Omega\\cdot\\text{cm}}{\\frac{1.5 \\times 10^{10}}{\\pi}\\,\\Omega/\\text{cm}} = \\frac{10^8}{2\\pi} \\cdot \\frac{\\pi}{1.5 \\times 10^{10}}\\,\\text{cm}^2 = \\frac{10^8}{3 \\times 10^{10}}\\,\\text{cm}^2 = \\frac{1}{300}\\,\\text{cm}^2\n$$\nThe length constant $\\lambda$ is:\n$$\n\\lambda = \\sqrt{\\frac{1}{300}}\\,\\text{cm} = \\frac{1}{10\\sqrt{3}}\\,\\text{cm}\n$$\nNow, we can compute the dimensionless length of the cable, $L/\\lambda$:\n$$\n\\frac{L}{\\lambda} = \\frac{0.1\\,\\text{cm}}{\\frac{1}{10\\sqrt{3}}\\,\\text{cm}} = 0.1 \\times 10\\sqrt{3} = \\sqrt{3}\n$$\nFinally, we compute the ratio of the resistances:\n$$\n\\frac{R_{\\text{in}}^{\\text{sealed}}}{R_{\\text{in}}^{\\text{killed}}} = \\coth^2(\\sqrt{3})\n$$\nUsing the value $\\sqrt{3} \\approx 1.7320508...$:\n$$\n\\coth(\\sqrt{3}) = \\frac{\\exp(\\sqrt{3}) + \\exp(-\\sqrt{3})}{\\exp(\\sqrt{3}) - \\exp(-\\sqrt{3})} \\approx 1.064593\n$$\nSquaring this value:\n$$\n\\coth^2(\\sqrt{3}) \\approx (1.064593)^2 \\approx 1.133368\n$$\nRounding to four significant figures, the ratio is $1.133$.",
            "answer": "$$\\boxed{1.133}$$"
        },
        {
            "introduction": "Real dendrites are complex, branching structures, not simple cylinders. This final practice bridges theory and reality by applying principles of conductance scaling to analyze a digitally reconstructed dendritic arbor. You will implement a test for Rall's $d^{3/2}$ power rule, a condition for efficient signal transfer at bifurcations, thereby learning how to computationally assess whether a real neuron's morphology is optimized for passive signal propagation .",
            "id": "3974766",
            "problem": "You are given a set of rooted trees representing morphological reconstructions of dendritic arbors. Each node corresponds to a short cylindrical compartment with a specified diameter measured in micrometers. The trees are represented as lists of tuples $(\\text{node\\_id}, \\text{parent\\_id}, d)$, where $d$ is the compartment diameter in $\\mu\\text{m}$, $\\text{parent\\_id}=-1$ denotes the root, and each non-root node has exactly one parent. A branching point (bifurcation) is any node with two or more children.\n\nThe aim is to test the applicability of Rall’s rule across each tree by computing, for every branching point, the deviation between the parent compartment’s $d^{3/2}$ and the sum of the children compartments’ $d^{3/2}$. Specifically, define for a branching point with parent diameter $d_p$ and child diameters $\\{d_k\\}_{k=1}^m$ the sums $S_{\\text{parent}} = d_p^{3/2}$ and $S_{\\text{kids}} = \\sum_{k=1}^m d_k^{3/2}$, and the relative deviation\n$$\n\\delta = \\frac{S_{\\text{kids}} - S_{\\text{parent}}}{S_{\\text{parent}}}.\n$$\nAcross all branching points in a given tree, compute three metrics: the mean absolute relative deviation $\\overline{|\\delta|}$, the maximum absolute relative deviation $\\max|\\delta|$, and the fraction $f_\\tau$ of branching points whose absolute relative deviation is at most a tolerance $\\tau$. The tolerance is $\\tau=0.05$ (a decimal), and all deviation metrics are dimensionless. If a tree has no branching points, define $\\overline{|\\delta|}=0$, $\\max|\\delta|=0$, and $f_\\tau=1$.\n\nThe foundational base for this problem is linear cable theory for neuronal dendrites under quasi-static conditions, with the well-tested observation that the input conductance of a semi-infinite cylindrical cable scales with $d^{3/2}$, leading to the branching conductance matching condition at a node. The derivation of this scaling and its application are requested in the solution.\n\nYour task is to implement a program that, for the provided test suite of five trees, computes the three metrics described above for each tree and outputs them in a single aggregate format. Diameters are provided in $\\mu\\text{m}$; the deviations are dimensionless. There are no angles and no percentage signs are to be used.\n\nTest suite (each tree is a list of $(\\text{node\\_id}, \\text{parent\\_id}, d)$ tuples; diameters $d$ are in $\\mu\\text{m}$):\n\n- Tree A (balanced binary with near-Rall compliance at both branching points):\n    - $(0,-1,2.0736)$\n    - $(1,0,1.2)$\n    - $(2,0,1.4)$\n    - $(3,1,0.7)$\n    - $(4,1,0.81)$\n\n- Tree B (same topology as Tree A, with a deliberate deviation at one branch):\n    - $(0,-1,2.0736)$\n    - $(1,0,1.2)$\n    - $(2,0,1.4)$\n    - $(3,1,0.7)$\n    - $(4,1,0.9)$\n\n- Tree C (root trifurcation with near-Rall compliance, and a deeper bifurcation deviating):\n    - $(0,-1,2.0850)$\n    - $(1,0,1.1)$\n    - $(2,0,1.0)$\n    - $(3,0,0.9)$\n    - $(4,1,0.7)$\n    - $(5,1,0.5)$\n\n- Tree D (single chain, no branching points):\n    - $(0,-1,1.2)$\n    - $(1,0,1.1)$\n    - $(2,1,1.0)$\n    - $(3,2,0.9)$\n\n- Tree E (binary root with one very small child to test numerical stability, deeper bifurcation deviating):\n    - $(0,-1,1.0)$\n    - $(1,0,0.2)$\n    - $(2,0,0.945)$\n    - $(3,2,0.4)$\n    - $(4,2,0.5)$\n\nYour program should produce a single line of output containing the results for the five trees as a comma-separated list of lists, where each inner list has the three metrics in the order $[\\overline{|\\delta|}, \\max|\\delta|, f_\\tau]$. For example, the output should look like $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4],[x_5,y_5,z_5]]$, with each $x_i$, $y_i$, and $z_i$ a floating-point number. No other output text is permitted.",
            "solution": "The problem requires an analysis of dendritic tree morphology based on Rall's branching rule, a principle derived from linear cable theory. Before presenting the computational method, it is imperative to first establish the theoretical foundation, as requested.\n\n**Theoretical Foundation: Derivation of Rall's $3/2$ Power Rule**\n\nThe basis for Rall's rule is found in the behavior of electrical current in passive dendritic cables under steady-state (DC) conditions. We model a segment of a dendrite as a uniform cylinder. The voltage $V(x)$ along the length $x$ of this cable is described by the steady-state cable equation:\n$$\n\\lambda^2 \\frac{d^2V}{dx^2} - V = 0\n$$\nHere, $\\lambda$ is the space constant of the cable, defined as $\\lambda = \\sqrt{r_m/r_a}$, where $r_m$ is the membrane resistance for a unit length of the cylinder and $r_a$ is the axial resistance per unit length.\n\nThese resistances depend on the geometry of the cylinder and the intrinsic properties of the neuron. Let $d$ be the diameter of the cylindrical compartment, $R_m$ be the specific membrane resistance (in $\\Omega \\cdot \\text{m}^2$), and $R_i$ be the specific intracellular (axial) resistivity (in $\\Omega \\cdot \\text{m}$).\n\nThe membrane resistance per unit length, $r_m$, is inversely proportional to the membrane surface area per unit length (the perimeter, $\\pi d$):\n$$\nr_m = \\frac{R_m}{\\pi d}\n$$\nThe axial resistance per unit length, $r_a$, is inversely proportional to the cross-sectional area of the cylinder ($A = \\pi(d/2)^2$):\n$$\nr_a = \\frac{R_i}{A} = \\frac{R_i}{\\pi (d/2)^2} = \\frac{4 R_i}{\\pi d^2}\n$$\nSubstituting these into the definition of the space constant $\\lambda$:\n$$\n\\lambda = \\sqrt{\\frac{r_m}{r_a}} = \\sqrt{\\frac{R_m / (\\pi d)}{4 R_i / (\\pi d^2)}} = \\sqrt{\\frac{R_m d}{4 R_i}}\n$$\nAssuming uniform material properties ($R_m$ and $R_i$ are constant), the space constant scales with the square root of the diameter: $\\lambda \\propto \\sqrt{d}$.\n\nNext, we consider the input conductance, $G_{in}$, of a dendritic branch. For a semi-infinite cable (a valid approximation for electrically long branches), the input resistance is $R_{in} = \\sqrt{r_m r_a}$. The input conductance is its reciprocal:\n$$\nG_{in} = \\frac{1}{R_{in}} = \\frac{1}{\\sqrt{r_m r_a}}\n$$\nWe can also express $R_{in}$ using $\\lambda$ and $r_a$ as $R_{in} = \\lambda r_a$. Thus:\n$$\nG_{in} = \\frac{1}{\\lambda r_a}\n$$\nNow, we examine how $G_{in}$ scales with diameter $d$. We have established that $\\lambda \\propto \\sqrt{d}$ and $r_a \\propto 1/d^2$. Therefore:\n$$\nG_{in} \\propto \\frac{1}{(\\sqrt{d}) (1/d^2)} = \\frac{d^2}{\\sqrt{d}} = d^{3/2}\n$$\nThis derivation establishes that the input conductance of a semi-infinite cable scales with its diameter to the power of $3/2$.\n\nWilfrid Rall's insight was that for efficient signal propagation without impedance mismatch, the conductance looking into a parent branch should be equal to the sum of the conductances of its daughter branches. At a branching point with parent diameter $d_p$ and $m$ child branches with diameters $\\{d_k\\}_{k=1}^m$, this condition is:\n$$\nG_{in, \\text{parent}} = \\sum_{k=1}^m G_{in, \\text{child}_k}\n$$\nUsing the derived scaling relationship, and letting $C$ be the constant of proportionality, we get:\n$$\nC \\cdot d_p^{3/2} = \\sum_{k=1}^m C \\cdot d_k^{3/2}\n$$\nThe constant $C$ cancels, yielding Rall's celebrated branching rule:\n$$\nd_p^{3/2} = \\sum_{k=1}^m d_k^{3/2}\n$$\n**Computational Strategy**\n\nThe problem requires us to quantify the deviation from this ideal rule for a set of given dendritic trees. The algorithm to achieve this for each tree is as follows:\n\n1.  **Data Structuring**: The input format, a list of $(\\text{node\\_id}, \\text{parent\\_id}, d)$ tuples, is an edge list. This needs to be parsed into a more computationally convenient structure. Two dictionaries are optimal:\n    *   A dictionary mapping each `node_id` to its diameter $d$.\n    *   A dictionary mapping each parent `node_id` to a list of its children's `node_id`s. This directly represents the tree hierarchy.\n\n2.  **Identification of Branching Points**: A branching point is defined as a node with two or more children. By iterating through the parent-to-children dictionary created in the previous step, all nodes that are keys to lists of length $\\ge 2$ are identified as branching points.\n\n3.  **Deviation Calculation**: For each identified branching point $p$:\n    *   Retrieve the parent diameter $d_p$ and the set of child diameters $\\{d_k\\}$.\n    *   Calculate the parent sum $S_{\\text{parent}} = d_p^{3/2}$.\n    *   Calculate the children sum $S_{\\text{kids}} = \\sum_{k} d_k^{3/2}$.\n    *   Compute the relative deviation $\\delta = (S_{\\text{kids}} - S_{\\text{parent}}) / S_{\\text{parent}}$. Note that for any $d_p > 0$, $S_{\\text{parent}}$ is also greater than $0$, precluding division by zero. All diameters in the test suite are positive.\n    *   Collect all computed $\\delta$ values for the tree into a list.\n\n4.  **Metric Computation**:\n    *   If the tree contains no branching points, the list of deviations will be empty. As per the problem definition, the metrics are defined as $\\overline{|\\delta|} = 0$, $\\max|\\delta| = 0$, and $f_\\tau = 1$.\n    *   If branching points exist, the following metrics are computed from the list of $\\delta$ values:\n        *   **Mean Absolute Relative Deviation, $\\overline{|\\delta|}$**: The arithmetic mean of the absolute values of all computed deviations.\n        *   **Maximum Absolute Relative Deviation, $\\max|\\delta|$**: The maximum value among the absolute values of all computed deviations.\n        *   **Fraction of Compliant Branches, $f_\\tau$**: The fraction of branching points for which $|\\delta| \\le \\tau$, where the tolerance $\\tau$ is given as $0.05$. This is calculated as (number of branches with $|\\delta| \\le \\tau$) / (total number of branches).\n\nThis procedure is applied independently to each of the five provided test trees to generate the final results. The implementation will use the `numpy` library for efficient numerical operations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates dendritic trees against Rall's rule and computes deviation metrics.\n    \"\"\"\n    # Test suite of five dendritic trees.\n    # Each tree is a list of (node_id, parent_id, diameter) tuples.\n    test_cases = [\n        # Tree A (balanced binary, near-Rall compliance)\n        [\n            (0, -1, 2.0736), (1, 0, 1.2), (2, 0, 1.4), (3, 1, 0.7), (4, 1, 0.81)\n        ],\n        # Tree B (same as A, one branch deviating)\n        [\n            (0, -1, 2.0736), (1, 0, 1.2), (2, 0, 1.4), (3, 1, 0.7), (4, 1, 0.9)\n        ],\n        # Tree C (trifurcation, deeper bifurcation deviating)\n        [\n            (0, -1, 2.0850), (1, 0, 1.1), (2, 0, 1.0), (3, 0, 0.9), (4, 1, 0.7), (5, 1, 0.5)\n        ],\n        # Tree D (single chain, no branching points)\n        [\n            (0, -1, 1.2), (1, 0, 1.1), (2, 1, 1.0), (3, 2, 0.9)\n        ],\n        # Tree E (binary root, deeper bifurcation deviating)\n        [\n            (0, -1, 1.0), (1, 0, 0.2), (2, 0, 0.945), (3, 2, 0.4), (4, 2, 0.5)\n        ]\n    ]\n\n    # Tolerance for calculating the fraction of compliant branches.\n    tau = 0.05\n    all_results = []\n\n    for tree_data in test_cases:\n        if not tree_data:\n            # Handle empty tree case if necessary, though not in test suite.\n            all_results.append([0.0, 0.0, 1.0])\n            continue\n            \n        diameters = {node_id: d for node_id, _, d in tree_data}\n        children = {}\n        for node_id, parent_id, _ in tree_data:\n            if parent_id != -1:\n                if parent_id not in children:\n                    children[parent_id] = []\n                children[parent_id].append(node_id)\n        \n        branching_points = [\n            node_id for node_id, child_list in children.items()\n            if len(child_list) >= 2\n        ]\n\n        if not branching_points:\n            # Per problem spec, if no branching points, define metrics as follows.\n            mean_abs_dev = 0.0\n            max_abs_dev = 0.0\n            f_tau = 1.0\n            all_results.append([mean_abs_dev, max_abs_dev, f_tau])\n            continue\n\n        deviations = []\n        for bp_id in branching_points:\n            # Get parent diameter and calculate S_parent = d_p^(3/2)\n            d_p = diameters[bp_id]\n            # Handle d_p=0 case to prevent division by zero, though not in test data.\n            if d_p == 0:\n                # If parent diameter is 0, deviation is ill-defined.\n                # A sum of positive child diams would yield infinite deviation.\n                # Assuming d_p > 0 based on context. Let's formalize a behavior if needed.\n                # If child diameters are also 0, deviation could be 0. We'll assume d_p > 0.\n                s_parent = 0.0\n            else:\n                s_parent = np.power(d_p, 1.5)\n\n            # Get child diameters and calculate S_kids = sum(d_k^(3/2))\n            child_ids = children[bp_id]\n            child_diams = [diameters[cid] for cid in child_ids]\n            s_kids = np.sum(np.power(child_diams, 1.5))\n            \n            # Calculate relative deviation\n            if s_parent == 0:\n                # Can't compute relative deviation if parent sum is zero.\n                # If kids_sum is also 0, dev is 0. If kids_sum > 0, dev is inf.\n                # This case is not expected in the problem.\n                delta = np.inf if s_kids > 0 else 0.0\n            else:\n                delta = (s_kids - s_parent) / s_parent\n            \n            deviations.append(delta)\n\n        # Calculate metrics from the list of deviations\n        abs_deviations = np.abs(np.array(deviations))\n        mean_abs_dev = np.mean(abs_deviations)\n        max_abs_dev = np.max(abs_deviations)\n        \n        compliant_branches = np.sum(abs_deviations = tau)\n        f_tau = compliant_branches / len(branching_points)\n        \n        all_results.append([mean_abs_dev, max_abs_dev, f_tau])\n\n    # Format output to match specification: [[x1,y1,z1],[x2,y2,z2],...]\n    # without spaces inside the inner lists.\n    output_str = f\"[{','.join(['[' + ','.join(map(str, res)) + ']' for res in all_results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}