{
    "hands_on_practices": [
        {
            "introduction": "The cable equation can be solved analytically on an infinite line, but real dendrites have boundaries, such as sealed ends where a branch terminates. This practice introduces the method of images, a powerful technique to construct solutions in bounded domains by strategically placing \"image\" sources outside the physical domain. You will apply this method to derive the voltage response in a semi-infinite cable with a sealed-end boundary, a common and important scenario in neuronal modeling .",
            "id": "4031310",
            "problem": "Consider a passive, semi-infinite dendritic cable occupying $x \\geq 0$ that is initially at rest, with a sealed end at $x=0$. The membrane potential $V(x,t)$ obeys the one-dimensional linear cable equation with per-unit-length parameters: axial resistance $r_a$ (in $\\Omega \\cdot \\mathrm{cm}^{-1}$), membrane conductance $G_m$ (in $\\mathrm{S} \\cdot \\mathrm{cm}^{-1}$), and membrane capacitance $C_m$ (in $\\mathrm{F} \\cdot \\mathrm{cm}^{-1}$). An instantaneous point current impulse of strength $I_0$ (in $\\mathrm{A} \\cdot \\mathrm{s}$) is injected at position $x=x_00$ at time $t=0$, modeled by $I_{\\mathrm{inj}}(x,t)=I_0\\,\\delta(x-x_0)\\,\\delta(t)$. The governing Partial Differential Equation (PDE) and conditions are:\n- Cable dynamics:\n$$C_m\\,\\partial_t V = \\frac{1}{r_a}\\,\\partial_{xx} V - G_m\\,V + I_{\\mathrm{inj}}(x,t)$$\nfor $x \\geq 0$, $t0$.\n- Sealed-end (no axial current) boundary condition: $\\partial_x V(0,t)=0$ for $t0$.\n- Decay at infinity: $V(x,t)\\to 0$ as $x\\to\\infty$ for $t0$.\n- Rest initial condition: $V(x,0^{-})=0$ for $x \\geq 0$.\n\nUsing only fundamental linearity and symmetry principles together with the well-tested fundamental solution for diffusion with linear decay, construct the transient solution $V(x,t)$ for $t0$ and $x \\geq 0$ by the method of images. In particular:\n- Start from the infinite-line fundamental solution for the operator $\\partial_t - D\\,\\partial_{xx} + \\tau_m^{-1}$, where $D \\equiv \\frac{1}{r_a C_m}$ and $\\tau_m \\equiv \\frac{C_m}{G_m}$.\n- Enforce the sealed-end boundary condition by an appropriate image source, and justify the sign choice of the image by directly verifying the boundary condition.\n- Express your final $V(x,t)$ as a closed-form expression in terms of $x$, $t$, $x_0$, $I_0$, $C_m$, $D$, and $\\tau_m$.\n\nYour final answer must be a single closed-form analytic expression. Do not provide an equation or an inequality. No numerical rounding is required.",
            "solution": "The problem asks for the transient solution for the membrane potential $V(x,t)$ in a passive, semi-infinite dendritic cable subject to an instantaneous point current injection. The solution is to be constructed using the method of images.\n\nFirst, we validate the problem statement.\n**Step 1: Extract Givens**\n- Governing PDE: $C_m\\,\\partial_t V = \\frac{1}{r_a}\\,\\partial_{xx} V - G_m\\,V + I_{\\mathrm{inj}}(x,t)$ for $x \\geq 0$, $t0$.\n- Injected Current: $I_{\\mathrm{inj}}(x,t)=I_0\\,\\delta(x-x_0)\\,\\delta(t)$.\n- Injection Location: $x=x_00$.\n- Boundary Condition 1 (Sealed-end): $\\partial_x V(0,t)=0$ for $t0$.\n- Boundary Condition 2 (Decay at infinity): $V(x,t)\\to 0$ as $x\\to\\infty$ for $t0$.\n- Initial Condition (Rest): $V(x,0^{-})=0$ for $x \\geq 0$.\n- Parameters: axial resistance $r_a$, membrane conductance $G_m$, membrane capacitance $C_m$.\n- Definitions: $D \\equiv \\frac{1}{r_a C_m}$ and $\\tau_m \\equiv \\frac{C_m}{G_m}$.\n- Required Method: Method of images, starting from the fundamental solution for the operator $\\partial_t - D\\,\\partial_{xx} + \\tau_m^{-1}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on the standard linear cable equation, a fundamental model in computational neuroscience. All parameters, boundary conditions, and initial conditions are clearly stated and physically consistent, forming a standard initial-boundary value problem for a parabolic PDE. The problem is a textbook example of applying the method of images and is free of any listed flaws.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete, reasoned solution will be provided.\n\n**Solution Derivation**\n\nThe governing partial differential equation (PDE) is given as:\n$$\nC_m\\,\\frac{\\partial V}{\\partial t} = \\frac{1}{r_a}\\,\\frac{\\partial^2 V}{\\partial x^2} - G_m\\,V + I_0\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nWe begin by normalizing the equation. We divide the entire equation by the membrane capacitance per unit length, $C_m$:\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{1}{r_a C_m}\\,\\frac{\\partial^2 V}{\\partial x^2} - \\frac{G_m}{C_m}\\,V + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nUsing the provided definitions for the diffusion coefficient, $D \\equiv \\frac{1}{r_a C_m}$, and the membrane time constant, $\\tau_m \\equiv \\frac{C_m}{G_m}$, the PDE becomes:\n$$\n\\frac{\\partial V}{\\partial t} = D\\,\\frac{\\partial^2 V}{\\partial x^2} - \\frac{1}{\\tau_m}\\,V + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThis equation can be rearranged to highlight the linear operator acting on $V$:\n$$\n\\left(\\frac{\\partial}{\\partial t} - D\\,\\frac{\\partial^2}{\\partial x^2} + \\frac{1}{\\tau_m}\\right) V(x,t) = \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThe problem has a decay term $-\\frac{1}{\\tau_m}V$. To simplify the equation to the standard diffusion equation, we introduce a substitution. Let $V(x,t) = U(x,t)\\,\\exp(-t/\\tau_m)$. The partial derivatives of $V$ are:\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{\\partial U}{\\partial t}\\,\\exp(-t/\\tau_m) - \\frac{1}{\\tau_m}\\,U(x,t)\\,\\exp(-t/\\tau_m)\n$$\n$$\n\\frac{\\partial^2 V}{\\partial x^2} = \\frac{\\partial^2 U}{\\partial x^2}\\,\\exp(-t/\\tau_m)\n$$\nSubstituting these into the normalized PDE:\n$$\n\\frac{\\partial U}{\\partial t}\\,e^{-t/\\tau_m} - \\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m} = D\\,\\frac{\\partial^2 U}{\\partial x^2}\\,e^{-t/\\tau_m} - \\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m} + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThe term $-\\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m}$ cancels out. Multiplying the entire equation by $\\exp(t/\\tau_m)$ and using the property that $f(t)\\delta(t) = f(0)\\delta(t)$, we get:\n$$\n\\frac{\\partial U}{\\partial t} = D\\,\\frac{\\partial^2 U}{\\partial x^2} + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThis is the standard diffusion (or heat) equation for $U(x,t)$ on an infinite line, with an impulsive source of strength $\\frac{I_0}{C_m}$ at $x=x_0$ and $t=0$.\n\nThe fundamental solution (or Green's function) for the diffusion equation $\\partial_t U = D \\partial_{xx} U + \\delta(x-x_0)\\delta(t)$ on an infinite line ($-\\infty  x  \\infty$) is the Gaussian kernel:\n$$\nG(x,t; x_0) = \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right)\n$$\nBy linearity, the solution for $U(x,t)$ on an infinite line due to the source $\\frac{I_0}{C_m}\\delta(x-x_0)\\delta(t)$ is:\n$$\nU_{\\mathrm{inf}}(x,t) = \\frac{I_0}{C_m} G(x,t; x_0) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right)\n$$\nThe problem is defined on a semi-infinite domain $x \\geq 0$ with a sealed-end boundary condition $\\partial_x V(0,t)=0$. Since $V$ and $U$ are related by a factor that does not depend on $x$, this is equivalent to $\\partial_x U(0,t)=0$. This is a Neumann boundary condition.\n\nWe use the method of images to satisfy this boundary condition. We consider an infinite cable and introduce an \"image\" source located at $x=-x_0$ (the reflection of the original source across the boundary at $x=0$). The solution for $x \\geq 0$ is then the sum of the influences of the original source at $x_0$ and the image source at $-x_0$.\n\nLet the image source have strength $k \\frac{I_0}{C_m}$. The total solution $U(x,t)$ on the infinite line is the superposition:\n$$\nU(x,t) = \\frac{I_0}{C_m} G(x,t; x_0) + k \\frac{I_0}{C_m} G(x,t; -x_0)\n$$\n$$\nU(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + k \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nTo determine the constant $k$, we enforce the boundary condition $\\partial_x U(0,t)=0$. First, we compute the spatial derivative of $U(x,t)$:\n$$\n\\frac{\\partial U}{\\partial x} = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\frac{-2(x-x_0)}{4Dt} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + k \\frac{-2(x+x_0)}{4Dt} \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nNow, we evaluate this derivative at $x=0$:\n$$\n\\left.\\frac{\\partial U}{\\partial x}\\right|_{x=0} = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\frac{-1}{2Dt} \\left[ (-x_0) \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) + k(x_0) \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) \\right]\n$$\n$$\n\\left.\\frac{\\partial U}{\\partial x}\\right|_{x=0} = \\frac{I_0 x_0}{C_m \\sqrt{4\\pi D t}} \\frac{-1}{2Dt} \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) (-1+k)\n$$\nFor this to be zero for all $t0$, we must have $-1+k=0$, which implies $k=1$. Thus, the image source must have the same sign and magnitude as the original source. This is the characteristic of a Neumann (no-flux) boundary condition.\n\nSubstituting $k=1$ into the expression for $U(x,t)$, we get the solution for the semi-infinite domain $x \\geq 0$:\n$$\nU(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nFinally, we transform back to the original variable $V(x,t)$ using the relation $V(x,t) = U(x,t) \\exp(-t/\\tau_m)$:\n$$\nV(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nThis is the final closed-form expression for the membrane potential $V(x,t)$ for $x \\geq 0$ and $t0$. The solution satisfies the PDE (by construction as a superposition of fundamental solutions), the sealed-end boundary condition at $x=0$, the decay condition at infinity, and the initial condition of rest before the impulse.",
            "answer": "$$\n\\boxed{\\frac{I_0}{C_m \\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\left( \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right)}\n$$"
        },
        {
            "introduction": "Building upon the method of images, this exercise offers deeper physical intuition into the effect of a sealed-end boundary. By directly comparing the voltage response from an injection at a sealed end with an injection in an infinite cable, you will quantify how the boundary effectively \"reflects\" current and amplifies the local voltage. This comparison highlights a key computational feature of dendritic terminations and reinforces the principles explored in the previous practice .",
            "id": "4031323",
            "problem": "Consider a passive dendritic cable modeled as a uniform cylinder with membrane capacitance per unit length $c_m$, membrane resistance per unit length $r_m$, and axial resistance per unit length $r_i$. Starting from current conservation and Ohm's law, the dimensional cable equation for the transmembrane voltage $V(x,t)$ is\n$$\nc_m \\frac{\\partial V}{\\partial t} = \\frac{1}{r_i} \\frac{\\partial^2 V}{\\partial x^2} - \\frac{1}{r_m} V + I_{\\text{inj}}(x,t),\n$$\nwhere $I_{\\text{inj}}(x,t)$ is the transmembrane current per unit length injected at position $x$ and time $t$. Define the membrane time constant $\\tau_m = r_m c_m$ and the length constant $\\lambda = \\sqrt{r_m/r_i}$, and introduce normalized variables $\\tilde{x} = x/\\lambda$, $\\tilde{t} = t/\\tau_m$, and a scaled voltage $v(\\tilde{x},\\tilde{t})$ obeying the normalized partial differential equation (PDE)\n$$\n\\frac{\\partial v}{\\partial \\tilde{t}} = \\frac{\\partial^2 v}{\\partial \\tilde{x}^2} - v + s(\\tilde{x},\\tilde{t}),\n$$\nwhere $s(\\tilde{x},\\tilde{t})$ is the appropriately normalized source term. A brief current injection is modeled as an impulse $s(\\tilde{x},\\tilde{t}) = \\kappa \\,\\delta(\\tilde{x}-\\tilde{x}_{\\text{inj}})\\,\\delta(\\tilde{t})$ with amplitude $\\kappa$.\n\nCase A: A semi-infinite cable occupying $\\tilde{x} \\ge 0$ with a sealed end at $\\tilde{x}=0$ (no axial current, so $\\partial v/\\partial \\tilde{x}(\\tilde{x}=0,\\tilde{t})=0$), with the impulse injected at the sealed end $\\tilde{x}_{\\text{inj}}=0$ at time $\\tilde{t}=0$.\n\nCase B: An infinite cable $\\tilde{x}\\in(-\\infty,\\infty)$ with the impulse injected at $\\tilde{x}_{\\text{inj}}=\\tilde{x}_00$ at time $\\tilde{t}=0$.\n\nFor a fixed observation location $\\tilde{x}0$ and time $\\tilde{t}0$, both cases driven by the same impulse amplitude $\\kappa$, derive from first principles the explicit closed-form expression for the ratio\n$$\nR(\\tilde{x},\\tilde{t};\\tilde{x}_0) = \\frac{v_{\\text{semi}}(\\tilde{x},\\tilde{t})}{v_{\\infty}(\\tilde{x},\\tilde{t};\\tilde{x}_0)},\n$$\nwhere $v_{\\text{semi}}$ is the transient voltage in Case A and $v_{\\infty}$ is the transient voltage in Case B. Work entirely in the normalized variables and use fundamental solution methods consistent with the governing PDE and boundary condition. Express your final answer as a single simplified analytic expression in terms of $\\tilde{x}$, $\\tilde{t}$, and $\\tilde{x}_0$. No numerical evaluation is required, and no units should be included in the final expression.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the established theory of cable equation modeling in computational neuroscience, is mathematically well-posed with sufficient and consistent conditions, and is expressed in objective, formal language. The problem requires a standard, albeit non-trivial, application of fundamental solution methods for partial differential equations.\n\nThe analysis begins with the normalized cable equation for the transmembrane voltage $v(\\tilde{x},\\tilde{t})$:\n$$\n\\frac{\\partial v}{\\partial \\tilde{t}} = \\frac{\\partial^2 v}{\\partial \\tilde{x}^2} - v + s(\\tilde{x},\\tilde{t})\n$$\nThis is a linear partial differential equation (PDE). To simplify it, we introduce a transformation $v(\\tilde{x}, \\tilde{t}) = w(\\tilde{x}, \\tilde{t}) \\exp(-\\tilde{t})$. We compute the partial derivatives of $v$ in terms of $w$:\n$$\n\\frac{\\partial v}{\\partial \\tilde{t}} = \\frac{\\partial w}{\\partial \\tilde{t}} \\exp(-\\tilde{t}) - w \\exp(-\\tilde{t})\n$$\n$$\n\\frac{\\partial^2 v}{\\partial \\tilde{x}^2} = \\frac{\\partial^2 w}{\\partial \\tilde{x}^2} \\exp(-\\tilde{t})\n$$\nSubstituting these into the original PDE yields:\n$$\n\\frac{\\partial w}{\\partial \\tilde{t}} \\exp(-\\tilde{t}) - w \\exp(-\\tilde{t}) = \\frac{\\partial^2 w}{\\partial \\tilde{x}^2} \\exp(-\\tilde{t}) - w \\exp(-\\tilde{t}) + s(\\tilde{x},\\tilde{t})\n$$\nThe terms involving $w \\exp(-\\tilde{t})$ cancel. Multiplying the entire equation by $\\exp(\\tilde{t})$ gives the standard heat (or diffusion) equation for $w$:\n$$\n\\frac{\\partial w}{\\partial \\tilde{t}} = \\frac{\\partial^2 w}{\\partial \\tilde{x}^2} + s(\\tilde{x},\\tilde{t})\\exp(\\tilde{t})\n$$\nThe source term is given as $s(\\tilde{x},\\tilde{t}) = \\kappa \\,\\delta(\\tilde{x}-\\tilde{x}_{\\text{inj}})\\,\\delta(\\tilde{t})$. The term $\\exp(\\tilde{t})$ in the transformed equation is only relevant at $\\tilde{t}=0$ due to the presence of $\\delta(\\tilde{t})$, so we can replace $\\exp(\\tilde{t})$ with $\\exp(0)=1$. The PDE for $w$ becomes:\n$$\n\\frac{\\partial w}{\\partial \\tilde{t}} = \\frac{\\partial^2 w}{\\partial \\tilde{x}^2} + \\kappa \\,\\delta(\\tilde{x}-\\tilde{x}_{\\text{inj}})\\,\\delta(\\tilde{t})\n$$\nThis equation describes heat diffusion with an instantaneous point source of strength $\\kappa$ at position $\\tilde{x}_{\\text{inj}}$ and time $\\tilde{t}=0$. Assuming the system is at rest for $\\tilde{t}0$, i.e., $v(\\tilde{x}, \\tilde{t})=0$, which implies $w(\\tilde{x}, \\tilde{t})=0$, this problem is equivalent to solving the homogeneous heat equation $\\frac{\\partial w}{\\partial \\tilde{t}} = \\frac{\\partial^2 w}{\\partial \\tilde{x}^2}$ for $\\tilde{t}0$ with an initial condition $w(\\tilde{x}, 0^+) = \\kappa \\,\\delta(\\tilde{x}-\\tilde{x}_{\\text{inj}})$.\n\nThe fundamental solution (or Green's function for the initial value problem) of the 1D heat equation $\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2}$ with initial condition $u(x,0) = f(x)$ on an infinite domain is a convolution with the heat kernel:\n$$\nu(x,t) = \\frac{1}{\\sqrt{4\\pi D t}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x-y)^2}{4Dt}\\right) f(y) \\, dy\n$$\nIn our case, the diffusion coefficient is $D=1$, and the initial condition is $w(\\tilde{x}, 0^+) = \\kappa \\,\\delta(\\tilde{x}-\\tilde{x}_{\\text{inj}})$. The solution for $w$ is:\n$$\nw(\\tilde{x},\\tilde{t}) = \\frac{1}{\\sqrt{4\\pi \\tilde{t}}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(\\tilde{x}-y)^2}{4\\tilde{t}}\\right) \\kappa \\,\\delta(y-\\tilde{x}_{\\text{inj}}) \\, dy = \\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{(\\tilde{x}-\\tilde{x}_{\\text{inj}})^2}{4\\tilde{t}}\\right)\n$$\nThis is the solution for a single point source on an infinite line.\n\n**Case B: Infinite Cable**\nFor the infinite cable, the domain is $\\tilde{x}\\in(-\\infty,\\infty)$ and the injection is at $\\tilde{x}_{\\text{inj}}=\\tilde{x}_0$. The solution for $w_{\\infty}$ is given directly by the fundamental solution:\n$$\nw_{\\infty}(\\tilde{x},\\tilde{t};\\tilde{x}_0) = \\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{(\\tilde{x}-\\tilde{x}_0)^2}{4\\tilde{t}}\\right)\n$$\nTransforming back to $v_{\\infty}$ using $v=w\\exp(-\\tilde{t})$:\n$$\nv_{\\infty}(\\tilde{x},\\tilde{t};\\tilde{x}_0) = \\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{(\\tilde{x}-\\tilde{x}_0)^2}{4\\tilde{t}} - \\tilde{t}\\right)\n$$\n\n**Case A: Semi-infinite Cable**\nFor the semi-infinite cable, the domain is $\\tilde{x} \\ge 0$, the injection is at $\\tilde{x}_{\\text{inj}}=0$, and there is a sealed-end boundary condition $\\frac{\\partial v}{\\partial \\tilde{x}}(0,\\tilde{t})=0$. This Neumann condition also applies to $w$: $\\frac{\\partial w}{\\partial \\tilde{x}}(0,\\tilde{t})=0$. We solve this using the method of images. To satisfy a zero-flux (Neumann) boundary at $\\tilde{x}=0$, we add an image source of the same sign and magnitude at the reflected position. The real source is at $\\tilde{x}_{\\text{inj}}=0$. Its reflection is at $-\\tilde{x}_{\\text{inj}}=0$. Thus, we have two sources of strength $\\kappa$ at the same location, $\\tilde{x}=0$. The solution for $w_{\\text{semi}}$ for $\\tilde{x} \\ge 0$ is the sum of the effects of the source and its image:\n$$\nw_{\\text{semi}}(\\tilde{x},\\tilde{t}) = \\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{(\\tilde{x}-0)^2}{4\\tilde{t}}\\right) + \\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{(\\tilde{x}-(-0))^2}{4\\tilde{t}}\\right)\n$$\n$$\nw_{\\text{semi}}(\\tilde{x},\\tilde{t}) = \\frac{2\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{\\tilde{x}^2}{4\\tilde{t}}\\right)\n$$\nWe can verify that this solution satisfies the boundary condition:\n$$\n\\frac{\\partial w_{\\text{semi}}}{\\partial \\tilde{x}} = \\frac{2\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{\\tilde{x}^2}{4\\tilde{t}}\\right) \\left(-\\frac{2\\tilde{x}}{4\\tilde{t}}\\right) = -\\frac{\\kappa \\tilde{x}}{\\tilde{t}\\sqrt{\\pi \\tilde{t}}} \\exp\\left(-\\frac{\\tilde{x}^2}{4\\tilde{t}}\\right)\n$$\nAt $\\tilde{x}=0$, $\\frac{\\partial w_{\\text{semi}}}{\\partial \\tilde{x}}(0,\\tilde{t}) = 0$, as required.\nNow, we transform back to $v_{\\text{semi}}$:\n$$\nv_{\\text{semi}}(\\tilde{x},\\tilde{t}) = \\frac{2\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{\\tilde{x}^2}{4\\tilde{t}} - \\tilde{t}\\right)\n$$\n\n**Ratio Calculation**\nFinally, we compute the ratio $R(\\tilde{x},\\tilde{t};\\tilde{x}_0) = \\frac{v_{\\text{semi}}(\\tilde{x},\\tilde{t})}{v_{\\infty}(\\tilde{x},\\tilde{t};\\tilde{x}_0)}$ for $\\tilde{x}0, \\tilde{t}0, \\tilde{x}_00$.\n$$\nR(\\tilde{x},\\tilde{t};\\tilde{x}_0) = \\frac{\\frac{2\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{\\tilde{x}^2}{4\\tilde{t}} - \\tilde{t}\\right)}{\\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}} \\exp\\left(-\\frac{(\\tilde{x}-\\tilde{x}_0)^2}{4\\tilde{t}} - \\tilde{t}\\right)}\n$$\nThe common pre-factor $\\frac{\\kappa}{\\sqrt{4\\pi \\tilde{t}}}$ and the term $\\exp(-\\tilde{t})$ cancel, leaving:\n$$\nR(\\tilde{x},\\tilde{t};\\tilde{x}_0) = \\frac{2\\exp\\left(-\\frac{\\tilde{x}^2}{4\\tilde{t}}\\right)}{\\exp\\left(-\\frac{(\\tilde{x}-\\tilde{x}_0)^2}{4\\tilde{t}}\\right)} = 2 \\exp\\left( -\\frac{\\tilde{x}^2}{4\\tilde{t}} - \\left(-\\frac{(\\tilde{x}-\\tilde{x}_0)^2}{4\\tilde{t}}\\right) \\right)\n$$\n$$\nR(\\tilde{x},\\tilde{t};\\tilde{x}_0) = 2 \\exp\\left( \\frac{(\\tilde{x}-\\tilde{x}_0)^2 - \\tilde{x}^2}{4\\tilde{t}} \\right)\n$$\nExpanding the term in the exponent's numerator:\n$$\n(\\tilde{x}-\\tilde{x}_0)^2 - \\tilde{x}^2 = (\\tilde{x}^2 - 2\\tilde{x}\\tilde{x}_0 + \\tilde{x}_0^2) - \\tilde{x}^2 = \\tilde{x}_0^2 - 2\\tilde{x}\\tilde{x}_0\n$$\nSubstituting this back into the expression for $R$:\n$$\nR(\\tilde{x},\\tilde{t};\\tilde{x}_0) = 2 \\exp\\left(\\frac{\\tilde{x}_0^2 - 2\\tilde{x}\\tilde{x}_0}{4\\tilde{t}}\\right)\n$$\nThis is the final closed-form expression for the ratio.",
            "answer": "$$\n\\boxed{2 \\exp\\left(\\frac{\\tilde{x}_0^{2} - 2\\tilde{x}\\tilde{x}_0}{4\\tilde{t}}\\right)}\n$$"
        },
        {
            "introduction": "While analytical solutions provide invaluable insight, most realistic models of complex neuronal morphologies require numerical simulation. This practice guides you through the process of discretizing the cable equation and implementing an implicit numerical scheme, a standard and robust technique in computational neuroscience. You will also analyze the numerical stability of the method, a critical step in ensuring that a simulation produces physically meaningful results rather than numerical artifacts .",
            "id": "4031343",
            "problem": "You will implement an implicit time-stepping scheme for the transient spread of membrane voltage along a passive, one-dimensional dendritic cable. The physical model is the passive cable equation derived from fundamental circuit laws: charge conservation and Ohmic conductance for the membrane and axial cytoplasm. The governing partial differential equation is\n$$\nc_m \\,\\frac{\\partial V(x,t)}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V(x,t)}{\\partial x^2} \\;-\\; g_m \\,\\bigl(V(x,t) - E_L\\bigr) \\;+\\; i_e(x,t),\n$$\nwhere $V(x,t)$ is the membrane voltage in $\\mathrm{mV}$, $x$ is position along the dendrite in $\\mathrm{cm}$, and $t$ is time in $\\mathrm{s}$. The quantities $c_m$ (membrane capacitance per unit area) are in $\\mathrm{F/cm^2}$, $a$ (dendrite radius) is in $\\mathrm{cm}$, $R_i$ (axial resistivity) is in $\\Omega\\cdot\\mathrm{cm}$, $g_m$ (membrane conductance per unit area) is in $\\mathrm{S/cm^2}$, $E_L$ (leak reversal potential) is in $\\mathrm{mV}$, and $i_e(x,t)$ (external current density per unit area) is in $\\mathrm{A/cm^2}$. For this task, focus on the homogeneous linear passive dynamics, setting $E_L$ equal to $0$ and $i_e(x,t)$ equal to $0$, and impose sealed-end (no axial current) boundary conditions, which are the Neumann conditions\n$$\n\\frac{\\partial V(0,t)}{\\partial x} \\;=\\; 0, \\qquad \\frac{\\partial V(L,t)}{\\partial x} \\;=\\; 0,\n$$\nfor a cable of length $L$ in $\\mathrm{cm}$.\n\nStarting from the fundamental laws listed above, formulate the spatially discretized system on a uniform grid of $N$ nodes with spacing $\\Delta x = L/(N-1)$ using second-order accurate finite differences that respect the Neumann boundary conditions, yielding a semidiscrete linear system of ordinary differential equations,\n$$\n\\frac{d\\mathbf{V}(t)}{dt} \\;=\\; A\\,\\mathbf{V}(t),\n$$\nin which $\\mathbf{V}(t)\\in\\mathbb{R}^N$ collects the nodal voltages and $A\\in\\mathbb{R}^{N\\times N}$ is the stiffness matrix that arises from the axial diffusion and membrane leak. Express $A$ in terms of\n$$\nD \\;=\\; \\frac{a}{2\\,R_i\\,c_m} \\quad \\text{in} \\;\\mathrm{cm^2/s}, \\qquad \\alpha \\;=\\; \\frac{g_m}{c_m} \\quad \\text{in} \\; \\mathrm{s^{-1}},\n$$\nand provide the full tridiagonal structure of the resulting linear systems for implicit Backward Euler and Crank–Nicolson time-stepping schemes. Specifically, for a time step size $\\Delta t$ in $\\mathrm{s}$, derive the linear systems\n$$\n\\bigl(I - \\Delta t\\,A\\bigr)\\,\\mathbf{V}^{n+1} \\;=\\; \\mathbf{V}^{n} \\quad \\text{(Backward Euler)},\n$$\nand\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\,A\\bigr)\\,\\mathbf{V}^{n+1} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\,A\\bigr)\\,\\mathbf{V}^{n} \\quad \\text{(Crank–Nicolson)},\n$$\nand explain why these implicit schemes are unconditionally stable for the linear passive dynamics under consideration. Your explanation must be grounded in first principles: characterize the spectrum of $A$ arising from the spatial discretization with Neumann boundary conditions and leak, and connect that to the absolute stability properties of the chosen implicit schemes for linear systems.\n\nImplement a program that:\n- Constructs the matrix $A$ for a given set of physical parameters and grid resolution using the second-order finite difference method with Neumann boundary conditions.\n- Computes the spectral radius of the one-step amplification operator for both Backward Euler and Crank–Nicolson. For Backward Euler, the one-step amplification is $\\bigl(I - \\Delta t\\,A\\bigr)^{-1}$. For Crank–Nicolson, it is $\\bigl(I - \\tfrac{\\Delta t}{2}\\,A\\bigr)^{-1}\\,\\bigl(I + \\tfrac{\\Delta t}{2}\\,A\\bigr)$. The spectral radius should be reported as a float rounded to six decimal places.\n\nUse the following test suite, where each test case specifies the numerical scheme, grid size, physical parameters, and time step. All quantities use the units indicated above. Voltage should be treated in $\\mathrm{mV}$, but because the dynamics are homogeneous and linear, only the matrix $A$ and its spectrum affect the requested measurements.\n\n- Test case $1$ (typical parameters, small time step, Backward Euler):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.0001$.\n- Test case $2$ (typical parameters, large time step, Backward Euler):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.05$.\n- Test case $3$ (typical parameters, large time step, Crank–Nicolson):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.05$.\n- Test case $4$ (no leak edge case, large time step, Crank–Nicolson):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 0$, $\\Delta t = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases listed above. For each test case, output the spectral radius of the corresponding one-step amplification operator as a float rounded to six decimal places. For example, the output format must be\n$$\n\\texttt{[r_1,r_2,r_3,r_4]},\n$$\nwhere $r_1$, $r_2$, $r_3$, and $r_4$ are the computed floats for test cases $1$, $2$, $3$, and $4$, respectively, each rounded to six decimal places. All time quantities must be handled in $\\mathrm{s}$, all lengths in $\\mathrm{cm}$, and all voltages in $\\mathrm{mV}$.",
            "solution": "The problem asks for the derivation and implementation of implicit numerical schemes for the one-dimensional passive cable equation, followed by a stability analysis based on the spectral radius of the amplification operators.\n\n### 1. Semi-Discretization of the Cable Equation\n\nThe governing partial differential equation (PDE) for the membrane voltage $V(x,t)$ is given as:\n$$\nc_m \\,\\frac{\\partial V(x,t)}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V(x,t)}{\\partial x^2} \\;-\\; g_m \\,\\bigl(V(x,t) - E_L\\bigr) \\;+\\; i_e(x,t)\n$$\nWe are instructed to consider the homogeneous case where the leak reversal potential $E_L=0\\,\\mathrm{mV}$ and the external current density $i_e(x,t)=0\\,\\mathrm{A/cm^2}$. The PDE simplifies to:\n$$\nc_m \\,\\frac{\\partial V}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V}{\\partial x^2} \\;-\\; g_m \\,V\n$$\nDividing by the membrane capacitance per unit area, $c_m$, and introducing the specified constants for diffusion, $D = \\frac{a}{2\\,R_i\\,c_m}$, and leak, $\\alpha = \\frac{g_m}{c_m}$, we obtain the normalized form:\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; D \\frac{\\partial^2 V}{\\partial x^2} \\;-\\; \\alpha V\n$$\nWe discretize the spatial domain $x \\in [0, L]$ into a uniform grid of $N$ nodes, $x_j = j \\Delta x$ for $j=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L/(N-1)$. Let $V_j(t)$ be the numerical approximation of $V(x_j, t)$. The vector of nodal voltages is denoted by $\\mathbf{V}(t) = [V_0(t), V_1(t), \\dots, V_{N-1}(t)]^T$.\n\nThe second spatial derivative is approximated using a second-order accurate central difference formula for the interior nodes ($j=1, \\dots, N-2$):\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_j} \\approx \\frac{V_{j-1}(t) - 2V_j(t) + V_{j+1}(t)}{(\\Delta x)^2}\n$$\nThe sealed-end boundary conditions, $\\frac{\\partial V(0,t)}{\\partial x} = 0$ and $\\frac{\\partial V(L,t)}{\\partial x} = 0$, are Neumann conditions. To maintain second-order accuracy, we employ \"ghost points\" (or fictitious nodes). At the left boundary ($j=0$), a centered difference for the first derivative is $\\frac{V_1 - V_{-1}}{2\\Delta x} = 0$, implying $V_{-1} = V_1$. Substituting this into the central difference formula for the second derivative at $j=0$ gives:\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_0} \\approx \\frac{V_{-1} - 2V_0 + V_1}{(\\Delta x)^2} = \\frac{V_1 - 2V_0 + V_1}{(\\Delta x)^2} = \\frac{2(V_1 - V_0)}{(\\Delta x)^2}\n$$\nSimilarly, at the right boundary ($j=N-1$), the condition $\\frac{V_{N} - V_{N-2}}{2\\Delta x} = 0$ implies a ghost point value of $V_N = V_{N-2}$. The second derivative approximation becomes:\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_{N-1}} \\approx \\frac{V_{N-2} - 2V_{N-1} + V_N}{(\\Delta x)^2} = \\frac{2(V_{N-2} - V_{N-1})}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the PDE yields a system of $N$ coupled ordinary differential equations (ODEs), known as the semi-discrete system:\n*   For $j=0$: $\\frac{dV_0}{dt} = D \\frac{2(V_1 - V_0)}{(\\Delta x)^2} - \\alpha V_0$\n*   For $j=1, \\dots, N-2$: $\\frac{dV_j}{dt} = D \\frac{V_{j-1} - 2V_j + V_{j+1}}{(\\Delta x)^2} - \\alpha V_j$\n*   For $j=N-1$: $\\frac{dV_{N-1}}{dt} = D \\frac{2(V_{N-2} - V_{N-1})}{(\\Delta x)^2} - \\alpha V_{N-1}$\n\nThis system can be written in matrix form $\\frac{d\\mathbf{V}}{dt} = A\\,\\mathbf{V}$, where $A$ is an $N \\times N$ tridiagonal matrix defined as:\n$$\nA = \\frac{D}{(\\Delta x)^2}\n\\begin{pmatrix}\n-2  2  0  \\dots  0 \\\\\n1  -2  1  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  1  -2  1 \\\\\n0  \\dots  0  2  -2\n\\end{pmatrix}\n- \\alpha\n\\begin{pmatrix}\n1  0  \\dots  0 \\\\\n0  1  \\dots  0 \\\\\n\\vdots   \\ddots  \\vdots \\\\\n0  \\dots   1\n\\end{pmatrix}\n$$\nThe components of $A$ are $A_{j,k}$ where for $j \\in \\{1, \\dots, N-2\\}$, $A_{j,j-1} = D/(\\Delta x)^2$, $A_{j,j} = -2D/(\\Delta x)^2 - \\alpha$, $A_{j,j+1} = D/(\\Delta x)^2$. At the boundaries, $A_{0,0} = -2D/(\\Delta x)^2 - \\alpha$, $A_{0,1} = 2D/(\\Delta x)^2$, $A_{N-1,N-2} = 2D/(\\Delta x)^2$, and $A_{N-1,N-1} = -2D/(\\Delta x)^2 - \\alpha$.\n\n### 2. Time-Stepping Schemes and Stability Analysis\n\nWe apply a time discretization to the ODE system $\\frac{d\\mathbf{V}}{dt} = A\\,\\mathbf{V}$. Let $\\mathbf{V}^n$ denote the voltage vector at time $t_n = n \\Delta t$.\n\n**Backward Euler (BE):** This first-order implicit scheme is defined by evaluating the right-hand side at the future time step $n+1$:\n$$ \\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = A \\mathbf{V}^{n+1} \\implies (I - \\Delta t A) \\mathbf{V}^{n+1} = \\mathbf{V}^n $$\nfrom which we solve for $\\mathbf{V}^{n+1}$. The one-step amplification operator is $G_{BE} = (I - \\Delta t A)^{-1}$.\n\n**Crank-Nicolson (CN):** This second-order implicit scheme averages the right-hand side over the current and future time steps:\n$$ \\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = \\frac{1}{2} (A \\mathbf{V}^n + A \\mathbf{V}^{n+1}) \\implies (I - \\tfrac{\\Delta t}{2} A) \\mathbf{V}^{n+1} = (I + \\tfrac{\\Delta t}{2} A) \\mathbf{V}^n $$\nThe amplification operator is $G_{CN} = (I - \\tfrac{\\Delta t}{2} A)^{-1} (I + \\tfrac{\\Delta t}{2} A)$.\n\n**Stability Analysis:** A numerical scheme is stable if the spectral radius of its amplification operator, $\\rho(G)$, satisfies $\\rho(G) \\le 1$. The eigenvalues of $G$ are functions of the eigenvalues of $A$. Let $\\lambda_k$ be an eigenvalue of $A$. The matrix $A$ is the sum of a scaled discrete Laplacian matrix for Neumann conditions and $-\\alpha I$. The discrete Laplacian portion is symmetric and its eigenvalues are known to be real and non-positive. The eigenvalues of the specific $N \\times N$ matrix for the second derivative with Neumann conditions are $\\frac{1}{(\\Delta x)^2} \\left[ -4\\sin^2\\left(\\frac{k\\pi}{2(N-1)}\\right) \\right]$ for $k=0, 1, \\dots, N-1$.\nThus, the eigenvalues of $A$ are:\n$$\n\\lambda_k = -\\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\pi}{2(N-1)}\\right) - \\alpha, \\quad k=0, 1, \\dots, N-1\n$$\nSince $D \\ge 0$ and $\\alpha \\ge 0$, all eigenvalues $\\lambda_k$ of $A$ are real and non-positive, i.e., $\\lambda_k \\in (-\\infty, 0]$.\n\nFor the **Backward Euler** scheme, the eigenvalues of $G_{BE}$ are $\\mu_k = \\frac{1}{1 - \\Delta t \\lambda_k}$. Since $\\lambda_k \\le 0$ and $\\Delta t  0$, the term $-\\Delta t \\lambda_k \\ge 0$. The denominator $1 - \\Delta t \\lambda_k \\ge 1$. Consequently, the magnitude of the eigenvalues is $|\\mu_k| = \\frac{1}{|1 - \\Delta t \\lambda_k|} = \\frac{1}{1 - \\Delta t \\lambda_k} \\le 1$. This holds for any choice of $\\Delta t  0$, so the Backward Euler scheme is unconditionally stable for this problem. The spectral radius is $\\rho(G_{BE}) = \\max_k |\\mu_k| = \\frac{1}{1 - \\Delta t \\lambda_{max}}$, where $\\lambda_{max}$ is the least negative eigenvalue of $A$. Since $\\sin^2(\\cdot)$ is smallest at $k=0$, $\\lambda_0 = -\\alpha$ is the least negative eigenvalue.\n\nFor the **Crank-Nicolson** scheme, the eigenvalues of $G_{CN}$ are $\\mu_k = \\frac{1 + \\frac{\\Delta t}{2} \\lambda_k}{1 - \\frac{\\Delta t}{2} \\lambda_k}$. Let $z = \\frac{\\Delta t}{2} \\lambda_k$. Since $\\lambda_k \\le 0$, we have $z \\le 0$. The amplification factor is a real number $\\mu(z) = \\frac{1+z}{1-z}$ for $z\\le 0$. The magnitude is $|\\mu(z)| = \\left|\\frac{1+z}{1-z}\\right|$.\n*   For $z \\in [-1, 0]$, $|\\mu(z)| = \\frac{1+z}{1-z} \\le 1$.\n*   For $z  -1$, $|\\mu(z)| = -\\frac{1+z}{1-z} = \\frac{1+z}{z-1}  1$.\nThus, for any real, non-positive eigenvalue $\\lambda_k$, the corresponding eigenvalue $\\mu_k$ of the CN amplification matrix has magnitude $|\\mu_k| \\le 1$. The equality $|\\mu_k|=1$ occurs only if $\\lambda_k = 0$ (which happens for the $k=0$ mode if $\\alpha=0$). Therefore, the Crank-Nicolson scheme is also unconditionally stable. This property is a direct consequence of A-stability, which guarantees stability for any system with eigenvalues in the left half-plane, a condition met by our matrix $A$.\n\nThe implementation will construct the matrix $A$, form the respective amplification operator $G$, and compute its spectral radius $\\rho(G) = \\max_k |\\text{eig}_k(G)|$ using numerical linear algebra routines.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the transient voltage spread problem for an arbitrary number of test cases.\n\n    This function constructs the stiffness matrix A for the passive cable equation\n    and computes the spectral radius of the one-step amplification operator for\n    Backward Euler or Crank-Nicolson schemes.\n    \"\"\"\n    test_cases = [\n        # scheme, N, L, a, Ri, cm, gm, dt\n        ('BE', 50, 0.04, 1e-4, 100, 1e-6, 1e-4, 0.0001),\n        ('BE', 50, 0.04, 1e-4, 100, 1e-6, 1e-4, 0.05),\n        ('CN', 50, 0.04, 1e-4, 100, 1e-6, 1e-4, 0.05),\n        ('CN', 50, 0.04, 1e-4, 100, 1e-6, 0.0, 0.05),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        scheme, N, L, a, Ri, cm, gm, dt = case\n\n        # Calculate derived physical and numerical parameters\n        dx = L / (N - 1)\n        # Diffusion coefficient D (cm^2/s)\n        D = a / (2 * Ri * cm)\n        # Leak rate alpha (1/s)\n        alpha = gm / cm\n\n        # Construct the stiffness matrix A\n        A = np.zeros((N, N))\n\n        # Coefficients for finite difference stencil\n        c_diag = -2 * D / (dx**2) - alpha\n        c_off = D / (dx**2)\n\n        # Fill the interior of the matrix\n        for i in range(1, N - 1):\n            A[i, i - 1] = c_off\n            A[i, i] = c_diag\n            A[i, i + 1] = c_off\n\n        # Apply Neumann boundary conditions (sealed ends)\n        # At x=0 (j=0)\n        A[0, 0] = c_diag\n        A[0, 1] = 2 * c_off\n        \n        # At x=L (j=N-1)\n        A[N - 1, N - 1] = c_diag\n        A[N - 1, N - 2] = 2 * c_off\n        \n        # Define the identity matrix\n        I = np.identity(N)\n\n        # Construct the one-step amplification operator G\n        if scheme == 'BE':\n            # G = (I - dt*A)^(-1)\n            M = I - dt * A\n            G = np.linalg.inv(M)\n        elif scheme == 'CN':\n            # G = (I - dt/2*A)^(-1) * (I + dt/2*A)\n            M_lhs = I - (dt / 2) * A\n            M_rhs = I + (dt / 2) * A\n            G = np.linalg.inv(M_lhs) @ M_rhs\n\n        # Compute eigenvalues of the amplification operator\n        eigenvalues = np.linalg.eigvals(G)\n\n        # The spectral radius is the maximum of the absolute values of the eigenvalues\n        spectral_radius = np.max(np.abs(eigenvalues))\n        \n        results.append(spectral_radius)\n\n    # Format the output string as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}