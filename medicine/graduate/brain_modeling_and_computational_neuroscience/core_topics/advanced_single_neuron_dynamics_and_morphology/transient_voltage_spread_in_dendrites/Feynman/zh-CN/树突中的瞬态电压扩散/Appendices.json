{
    "hands_on_practices": [
        {
            "introduction": "本练习将探讨一种基础的解析技术——镜像法（method of images），用以求解电缆方程。我们将研究一种半无限长树突的场景，其末端为“接地端”（killed end），这代表了电压恒定的关键边界条件。通过推导格林函数，您将通过巧妙运用“反对称”镜像源，深入理解边界如何塑造电压信号。",
            "id": "4031363",
            "problem": "考虑一个无源、均匀的树突电缆，其被建模为占据半无限域 $x \\geq 0$ 的一维连续体。令 $V(x,t)$ 表示跨膜电压相对于静息电位的偏差。在线性膜行为和轴向电流的标准假设下，根据 Kirchhoff 电路定律和电流守恒可得出线性电缆方程\n$$\n\\tau \\,\\frac{\\partial V}{\\partial t}(x,t) \\;=\\; \\lambda^{2}\\,\\frac{\\partial^{2} V}{\\partial x^{2}}(x,t) \\;-\\; V(x,t) \\;+\\; \\tau \\, s(x,t),\n$$\n其中 $\\tau$ 是膜时间常数，$\\lambda$ 是电紧张长度常数，$s(x,t)$ 是一个外部施加的源项，表示单位长度的跨膜电流注入。定义扩散系数 $D$ 和衰减率 $\\kappa$ 为 $D \\equiv \\lambda^{2}/\\tau$ 和 $\\kappa \\equiv 1/\\tau$，从而齐次算子可以写成 $\\partial/\\partial t - D\\,\\partial^{2}/\\partial x^{2} + \\kappa$。\n\n令 $G(x,t;x_{0})$ 为该算子在半无限域 $x \\ge 0$ 上的格林函数，其在 $x=0$ 处具有吸收端（Dirichlet 边界），满足边界条件 $G(0,t;x_{0})=0$（对所有 $t>0$），因果性条件 $G(x,t;x_{0})=0$（对 $t0$），以及如下定义的非齐次偏微分方程（PDE）\n$$\n\\frac{\\partial G}{\\partial t}(x,t;x_{0}) \\;=\\; D\\,\\frac{\\partial^{2} G}{\\partial x^{2}}(x,t;x_{0}) \\;-\\; \\kappa\\,G(x,t;x_{0}) \\;+\\; \\delta(x-x_{0})\\,\\delta(t),\n$$\n对于 $x \\ge 0$ 和 $t \\in \\mathbb{R}$，其中 $\\delta(\\cdot)$ 表示 Dirac delta 分布。\n\n仅使用线性系统、对称性的基本原理以及镜像法，推导当 $x \\ge 0$ 和 $t>0$ 时 $G(x,t;x_{0})$ 的闭式表达式，该表达式应以 $x$、$t$、$x_{0}$、$D$ 和 $\\tau$ 表示。明确验证您推导的表达式满足吸收端的 Dirichlet 边界条件。Heaviside 阶跃函数 $H(t)$ 定义为：当 $t0$ 时 $H(t)=0$，当 $t>0$ 时 $H(t)=1$，并可用于编码因果性。将您的最终答案表示为 $G(x,t;x_{0})$ 的单个解析表达式。无需进行数值计算。",
            "solution": "用户希望我首先验证问题的完整性，然后提供一个完整的解决方案。\n\n### 步骤 1：提取已知条件\n- **控制方程（线性电缆方程）：**\n$$\n\\tau \\,\\frac{\\partial V}{\\partial t}(x,t) \\;=\\; \\lambda^{2}\\,\\frac{\\partial^{2} V}{\\partial x^{2}}(x,t) \\;-\\; V(x,t) \\;+\\; \\tau \\, s(x,t)\n$$\n- **定义域：** $x \\ge 0$\n- **参数定义：**\n  - 扩散系数：$D \\equiv \\lambda^{2}/\\tau$\n  - 衰减率：$\\kappa \\equiv 1/\\tau$\n- **格林函数偏微分方程：**\n$$\n\\frac{\\partial G}{\\partial t}(x,t;x_{0}) \\;=\\; D\\,\\frac{\\partial^{2} G}{\\partial x^{2}}(x,t;x_{0}) \\;-\\; \\kappa\\,G(x,t;x_{0}) \\;+\\; \\delta(x-x_{0})\\,\\delta(t)\n$$\n  对于 $x \\ge 0$ 和 $t \\in \\mathbb{R}$。\n- **边界条件：** $G(0,t;x_{0})=0$（对所有 $t>0$）（吸收端，Dirichlet 边界）。\n- **因果性条件：** $G(x,t;x_{0})=0$（对 $t0$）。\n- **Heaviside 阶跃函数：** $H(t)=0$（对 $t0$），$H(t)=1$（对 $t>0$）。\n- **任务：** 使用镜像法推导当 $x \\ge 0$ 和 $t>0$ 时 $G(x,t;x_{0})$ 的闭式表达式，并验证边界条件。\n\n### 步骤 2：使用提取的已知条件进行验证\n现在将根据指定标准对问题陈述进行验证。\n\n- **科学性：** 该问题基于线性电缆方程，这是计算神经科学中描述无源神经元树突中电压传播的基石模型。该方程源于应用于连续电缆结构的电路基本原理（Kirchhoff 定律，Ohm 定律）。为此线性偏微分方程构建格林函数是一种标准且严谨的数学方法。该问题在根本上是合理的。\n- **适定性：** 该问题要求解一个在半无限域上的线性抛物型偏微分方程的基本解（格林函数），该方程具有指定的初始条件（时间和空间上的 Dirac delta 函数）和 Dirichlet 边界条件。这是数学物理学中一个经典的适定问题，预计有唯一且稳定的解。\n- **客观性：** 问题陈述使用了精确的数学语言和公认的科学术语。没有主观、模糊或基于观点性的陈述。\n- **完整性和一致性：** 所有必要信息——偏微分方程、定义域、边界条件和参数定义——均已提供。约束条件是自洽的。\n- **其他缺陷：** 该问题没有表现出任何其他缺陷，如隐喻性、不切实际、同义反复或无法验证。这是指定领域内一个标准的可解问题。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解决方案。\n\n### 解题推导\n目标是找到满足以下偏微分方程的格林函数 $G(x,t;x_{0})$：\n$$\n\\frac{\\partial G}{\\partial t} = D\\,\\frac{\\partial^{2} G}{\\partial x^{2}} - \\kappa\\,G + \\delta(x-x_{0})\\,\\delta(t)\n$$\n在定义域 $x \\ge 0$ 上，并受限于边界条件 $G(0,t;x_{0})=0$（对于 $t>0$）和因果性条件 $G(x,t;x_{0})=0$（对于 $t0$）。\n\n首先，我们通过消除衰减项 $-\\kappa\\,G$ 来简化方程。我们通过替换引入一个辅助函数 $\\tilde{G}(x,t;x_{0})$：\n$$\nG(x,t;x_{0}) = \\tilde{G}(x,t;x_{0}) \\, \\exp(-\\kappa t)\n$$\n将此代入偏微分方程，我们得到：\n$$\n\\frac{\\partial}{\\partial t} \\left( \\tilde{G} \\, \\exp(-\\kappa t) \\right) = D\\,\\frac{\\partial^{2}}{\\partial x^{2}} \\left( \\tilde{G} \\, \\exp(-\\kappa t) \\right) - \\kappa \\left( \\tilde{G} \\, \\exp(-\\kappa t) \\right) + \\delta(x-x_{0})\\,\\delta(t)\n$$\n应用乘法求导法则：\n$$\n\\frac{\\partial \\tilde{G}}{\\partial t}\\exp(-\\kappa t) - \\kappa\\,\\tilde{G}\\,\\exp(-\\kappa t) = D\\,\\exp(-\\kappa t)\\,\\frac{\\partial^{2} \\tilde{G}}{\\partial x^{2}} - \\kappa\\,\\tilde{G}\\,\\exp(-\\kappa t) + \\delta(x-x_{0})\\,\\delta(t)\n$$\n两边包含 $-\\kappa\\,\\tilde{G}\\,\\exp(-\\kappa t)$ 的项相互抵消。将整个方程乘以 $\\exp(\\kappa t)$：\n$$\n\\frac{\\partial \\tilde{G}}{\\partial t} = D\\,\\frac{\\partial^{2} \\tilde{G}}{\\partial x^{2}} + \\exp(\\kappa t)\\delta(x-x_{0})\\,\\delta(t)\n$$\n根据狄拉克 $\\delta$ 函数的性质，$\\exp(\\kappa t)\\delta(t) = \\exp(\\kappa \\cdot 0)\\delta(t) = \\delta(t)$。因此，方程简化为关于 $\\tilde{G}$ 的标准扩散（或热）方程：\n$$\n\\frac{\\partial \\tilde{G}}{\\partial t} = D\\,\\frac{\\partial^{2} \\tilde{G}}{\\partial x^{2}} + \\delta(x-x_{0})\\,\\delta(t)\n$$\n这个方程在无限空间域 $x \\in \\mathbb{R}$ 上的基本解，我们记为 $\\tilde{G}_{\\infty}$，是一个高斯函数，代表点热源/粒子源的扩散：\n$$\n\\tilde{G}_{\\infty}(x, t; x_{0}) = \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right)\n$$\n其中 Heaviside 阶跃函数 $H(t)$ 强制了因果性。\n\n现在我们使用镜像法来构建半无限域 $x \\ge 0$ 上满足 Dirichlet 边界条件 $G(0,t;x_{0})=0$ 的解。由于 $G$ 与 $\\tilde{G}$ 成正比，该边界条件等价于 $\\tilde{G}(0,t;x_{0})=0$。为实现这个零值边界，我们在位置 $-x_{0}$ 处放置一个负的“镜像”源。那么，在半空间 $x\\ge0$ 中的解 $\\tilde{G}(x,t;x_{0})$ 就是位于 $x_0$ 的原始源和位于 $-x_0$ 的镜像源产生的场的叠加：\n$$\n\\tilde{G}(x,t; x_{0}) = \\tilde{G}_{\\infty}(x, t; x_{0}) - \\tilde{G}_{\\infty}(x, t; -x_{0})\n$$\n代入 $\\tilde{G}_{\\infty}$ 的表达式：\n$$\n\\tilde{G}(x,t; x_{0}) = \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right) - \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{(x-(-x_{0}))^2}{4Dt}\\right)\n$$\n$$\n\\tilde{G}(x,t; x_{0}) = \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right) - \\exp\\left(-\\frac{(x+x_{0})^2}{4Dt}\\right) \\right]\n$$\n现在，我们使用 $G = \\tilde{G}\\exp(-\\kappa t)$ 变换回原始的格林函数 $G$。我们还代入 $\\kappa = 1/\\tau$：\n$$\nG(x,t; x_{0}) = \\frac{H(t)\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right) - \\exp\\left(-\\frac{(x+x_{0})^2}{4Dt}\\right) \\right]\n$$\n这就是当 $x \\ge 0$ 和 $t>0$ 时格林函数的闭式表达式。\n\n最后，我们明确验证当 $t>0$ 时，Dirichlet 边界条件 $G(0,t;x_{0})=0$ 是否被满足。我们在 $G$ 的表达式中令 $x=0$：\n$$\nG(0,t; x_{0}) = \\frac{H(t)\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(0-x_{0})^2}{4Dt}\\right) - \\exp\\left(-\\frac{(0+x_{0})^2}{4Dt}\\right) \\right]\n$$\n当 $t>0$ 时，$H(t)=1$。表达式变为：\n$$\nG(0,t; x_{0}) = \\frac{\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{x_{0}^2}{4Dt}\\right) - \\exp\\left(-\\frac{x_{0}^2}{4Dt}\\right) \\right]\n$$\n$$\nG(0,t; x_{0}) = \\frac{\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ 0 \\right] = 0\n$$\n边界条件按要求得到满足。推导出的表达式是完整的解。",
            "answer": "$$\n\\boxed{\\frac{H(t)\\exp(-\\frac{t}{\\tau})}{\\sqrt{4 \\pi D t}} \\left( \\exp\\left(-\\frac{(x-x_{0})^{2}}{4Dt}\\right) - \\exp\\left(-\\frac{(x+x_{0})^{2}}{4Dt}\\right) \\right)}\n$$"
        },
        {
            "introduction": "在镜像法的基础上，本练习将考察另一种相反的情形：具有“密封端”（sealed end）的树突。这种无电流流过的条件在树突分支的物理末端十分常见。求解瞬态电压响应需要您部署一个“对称”的镜像源，这将突显此解析方法的多功能性，并将密封端的反射特性与接地端的吸收特性进行对比。",
            "id": "4031310",
            "problem": "考虑一个占据 $x \\ge 0$ 区域的无源、半无限长树突电缆，该电缆初始处于静息状态，在 $x=0$ 处为封闭端。膜电位 $V(x,t)$ 满足一维线性电缆方程，其单位长度参数为：轴向电阻 $r_a$（单位 $\\Omega \\cdot \\mathrm{cm}^{-1}$）、膜电导 $G_m$（单位 $\\mathrm{S} \\cdot \\mathrm{cm}^{-1}$）和膜电容 $C_m$（单位 $\\mathrm{F} \\cdot \\mathrm{cm}^{-1}$）。在时间 $t=0$、位置 $x=x_00$ 处注入一个强度为 $I_0$（单位 $\\mathrm{A} \\cdot \\mathrm{s}$）的瞬时点电流脉冲，其模型为 $I_{\\mathrm{inj}}(x,t)=I_0\\,\\delta(x-x_0)\\,\\delta(t)$。控制该系统的偏微分方程（PDE）和条件如下：\n- 电缆动力学：$C_m\\,\\partial_t V = \\frac{1}{r_a}\\,\\partial_{xx} V - G_m\\,V + I_{\\mathrm{inj}}(x,t)$，对于 $x \\ge 0$, $t>0$。\n- 封闭端（无轴向电流）边界条件：$\\partial_x V(0,t)=0$，对于 $t>0$。\n- 无穷远处衰减：当 $x\\to\\infty$ 时，$V(x,t)\\to 0$，对于 $t>0$。\n- 静息初始条件：$V(x,0^{-})=0$，对于 $x \\ge 0$。\n\n请仅使用基本的线性和对称性原理，结合经过充分检验的带线性衰减的扩散方程基本解，通过镜像法构建瞬态解 $V(x,t)$（对于 $t>0$ 和 $x \\ge 0$）。具体要求如下：\n- 从算子 $\\partial_t - D\\,\\partial_{xx} + \\tau_m^{-1}$ 在无限长直线上的基本解出发，其中 $D \\equiv \\frac{1}{r_a C_m}$ 且 $\\tau_m \\equiv \\frac{C_m}{G_m}$。\n- 通过设置一个适当的镜像源来施加封闭端边界条件，并通过直接验证该边界条件来证明镜像源符号选择的合理性。\n- 将最终的 $V(x,t)$ 表示为一个以 $x$、$t$、$x_0$、$I_0$、$C_m$、$D$ 和 $\\tau_m$ 表示的闭式表达式。\n\n你的最终答案必须是单个闭式解析表达式。不要提供方程或不等式。无需进行数值取整。",
            "solution": "该问题要求解在瞬时点电流注入下，无源、半无限长树突电缆中膜电位 $V(x,t)$ 的瞬态解。该解需要用镜像法构建。\n\n首先，我们验证问题陈述的有效性。\n**步骤1：提取已知条件**\n- 控制偏微分方程：$C_m\\,\\partial_t V = \\frac{1}{r_a}\\,\\partial_{xx} V - G_m\\,V + I_{\\mathrm{inj}}(x,t)$，对于 $x \\ge 0$, $t>0$。\n- 注入电流：$I_{\\mathrm{inj}}(x,t)=I_0\\,\\delta(x-x_0)\\,\\delta(t)$。\n- 注入位置：$x=x_00$。\n- 边界条件1（封闭端）：$\\partial_x V(0,t)=0$，对于 $t>0$。\n- 边界条件2（无穷远处衰减）：当 $x\\to\\infty$ 时，$V(x,t)\\to 0$，对于 $t>0$。\n- 初始条件（静息）：$V(x,0^{-})=0$，对于 $x \\ge 0$。\n- 参数：轴向电阻 $r_a$、膜电导 $G_m$、膜电容 $C_m$。\n- 定义：$D \\equiv \\frac{1}{r_a C_m}$ 和 $\\tau_m \\equiv \\frac{C_m}{G_m}$。\n- 要求的方法：镜像法，从算子 $\\partial_t - D\\,\\partial_{xx} + \\tau_m^{-1}$ 的基本解出发。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据、适定且客观。它基于标准的线性电缆方程，这是计算神经科学中的一个基本模型。所有参数、边界条件和初始条件都陈述清晰且物理上一致，构成了一个标准的抛物型偏微分方程初边值问题。该问题是应用镜像法的一个教科书式范例，不存在任何已列出的缺陷。\n\n**步骤3：结论与行动**\n问题有效。将提供一个完整的、有理有据的解答。\n\n**解答推导**\n\n控制偏微分方程（PDE）为：\n$$\nC_m\\,\\frac{\\partial V}{\\partial t} = \\frac{1}{r_a}\\,\\frac{\\partial^2 V}{\\partial x^2} - G_m\\,V + I_0\\,\\delta(x-x_0)\\,\\delta(t)\n$$\n我们首先对该方程进行归一化。我们将整个方程除以单位长度的膜电容 $C_m$：\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{1}{r_a C_m}\\,\\frac{\\partial^2 V}{\\partial x^2} - \\frac{G_m}{C_m}\\,V + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\n使用给定的扩散系数 $D \\equiv \\frac{1}{r_a C_m}$ 和膜时间常数 $\\tau_m \\equiv \\frac{C_m}{G_m}$ 的定义，PDE 变为：\n$$\n\\frac{\\partial V}{\\partial t} = D\\,\\frac{\\partial^2 V}{\\partial x^2} - \\frac{1}{\\tau_m}\\,V + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\n该方程可以重排，以突出作用于 $V$ 的线性算子：\n$$\n\\left(\\frac{\\partial}{\\partial t} - D\\,\\frac{\\partial^2}{\\partial x^2} + \\frac{1}{\\tau_m}\\right) V(x,t) = \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\n问题中存在衰减项 $-\\frac{1}{\\tau_m}V$。为了将方程简化为标准扩散方程，我们引入一个代换。令 $V(x,t) = U(x,t)\\,\\exp(-t/\\tau_m)$。$V$ 的偏导数为：\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{\\partial U}{\\partial t}\\,\\exp(-t/\\tau_m) - \\frac{1}{\\tau_m}\\,U(x,t)\\,\\exp(-t/\\tau_m)\n$$\n$$\n\\frac{\\partial^2 V}{\\partial x^2} = \\frac{\\partial^2 U}{\\partial x^2}\\,\\exp(-t/\\tau_m)\n$$\n将这些代入归一化后的 PDE：\n$$\n\\frac{\\partial U}{\\partial t}\\,e^{-t/\\tau_m} - \\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m} = D\\,\\frac{\\partial^2 U}{\\partial x^2}\\,e^{-t/\\tau_m} - \\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m} + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\n$-\\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m}$ 项相互抵消。将整个方程乘以 $\\exp(t/\\tau_m)$ 并利用性质 $f(t)\\delta(t) = f(0)\\delta(t)$，我们得到：\n$$\n\\frac{\\partial U}{\\partial t} = D\\,\\frac{\\partial^2 U}{\\partial x^2} + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\n这是 $U(x,t)$ 在无限长直线上的标准扩散（或热）方程，在 $x=x_0$ 和 $t=0$ 处有一个强度为 $\\frac{I_0}{C_m}$ 的脉冲源。\n\n在无限长直线（$-\\infty  x  \\infty$）上，扩散方程 $\\partial_t U = D \\partial_{xx} U + \\delta(x-x_0)\\delta(t)$ 的基本解（或格林函数）是高斯核：\n$$\nG(x,t; x_0) = \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right)\n$$\n根据线性叠加原理，由源 $\\frac{I_0}{C_m}\\delta(x-x_0)\\delta(t)$ 在无限长直线上引起的解 $U(x,t)$ 为：\n$$\nU_{\\mathrm{inf}}(x,t) = \\frac{I_0}{C_m} G(x,t; x_0) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right)\n$$\n本问题定义在半无限域 $x \\geq 0$ 上，并具有封闭端边界条件 $\\partial_x V(0,t)=0$。由于 $V$ 和 $U$ 通过一个不依赖于 $x$ 的因子相关联，这等价于 $\\partial_x U(0,t)=0$。这是一个诺伊曼边界条件。\n\n我们使用镜像法来满足此边界条件。我们考虑一个无限长电缆，并引入一个位于 $x=-x_0$（原始源关于边界 $x=0$ 的反射点）的“镜像”源。对于 $x \\geq 0$ 区域的解，是位于 $x_0$ 的原始源和位于 $-x_0$ 的镜像源共同作用的结果之和。\n\n设镜像源的强度为 $k \\frac{I_0}{C_m}$。在无限长直线上的总解 $U(x,t)$ 是两者的叠加：\n$$\nU(x,t) = \\frac{I_0}{C_m} G(x,t; x_0) + k \\frac{I_0}{C_m} G(x,t; -x_0)\n$$\n$$\nU(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + k \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\n为了确定常数 $k$，我们施加边界条件 $\\partial_x U(0,t)=0$。首先，我们计算 $U(x,t)$ 的空间导数：\n$$\n\\frac{\\partial U}{\\partial x} = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\frac{-2(x-x_0)}{4Dt} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + k \\frac{-2(x+x_0)}{4Dt} \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\n现在，我们在 $x=0$ 处计算该导数：\n$$\n\\left.\\frac{\\partial U}{\\partial x}\\right|_{x=0} = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\frac{-1}{2Dt} \\left[ (-x_0) \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) + k(x_0) \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) \\right]\n$$\n$$\n\\left.\\frac{\\partial U}{\\partial x}\\right|_{x=0} = \\frac{I_0 x_0}{C_m \\sqrt{4\\pi D t}} \\frac{-1}{2Dt} \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) (-1+k)\n$$\n为了使该式对所有 $t>0$ 都为零，必须有 $-1+k=0$，这意味着 $k=1$。因此，镜像源必须与原始源具有相同的符号和大小。这是诺伊曼（无通量）边界条件的特征。\n\n将 $k=1$ 代入 $U(x,t)$ 的表达式中，我们得到半无限域 $x \\geq 0$ 上的解：\n$$\nU(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\n最后，我们使用关系式 $V(x,t) = U(x,t) \\exp(-t/\\tau_m)$ 变换回原始变量 $V(x,t)$：\n$$\nV(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\n这是在 $x \\ge 0$ 和 $t>0$ 条件下膜电位 $V(x,t)$ 的最终闭式表达式。该解满足了偏微分方程（通过构建为基本解的叠加）、$x=0$ 处的封闭端边界条件、无穷远处的衰减条件，以及脉冲前的静息初始条件。",
            "answer": "$$\n\\boxed{\\frac{I_0}{C_m \\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\left( \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right)}\n$$"
        },
        {
            "introduction": "虽然解析解能提供宝贵的直觉，但大多数真实的神经元模型都需要进行数值模拟。本练习将指导您为被动电缆方程实现一种稳定的数值格式，从而连接理论与计算。通过将方程离散化并分析如后向欧拉法和Crank-Nicolson法等隐式格式的稳定性，您将掌握构建和验证神经动力学计算模型的关键技能。",
            "id": "4031343",
            "problem": "您将为无源一维树突电缆上膜电压的瞬态传播实现一个隐式时间步进格式。其物理模型是源于基本电路定律（细胞膜和轴向细胞质的电荷守恒和欧姆电导）的无源电缆方程。控制偏微分方程为\n$$\nc_m \\,\\frac{\\partial V(x,t)}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V(x,t)}{\\partial x^2} \\;-\\; g_m \\,\\bigl(V(x,t) - E_L\\bigr) \\;+\\; i_e(x,t),\n$$\n其中 $V(x,t)$ 是膜电压，单位为 $\\mathrm{mV}$；$x$ 是沿树突的位置，单位为 $\\mathrm{cm}$；$t$ 是时间，单位为 $\\mathrm{s}$。各物理量的单位如下：$c_m$（单位面积膜电容）为 $\\mathrm{F/cm^2}$，$a$（树突半径）为 $\\mathrm{cm}$，$R_i$（轴向电阻率）为 $\\Omega\\cdot\\mathrm{cm}$，$g_m$（单位面积膜电导）为 $\\mathrm{S/cm^2}$，$E_L$（漏泄反转电位）为 $\\mathrm{mV}$，以及 $i_e(x,t)$（单位面积外部电流密度）为 $\\mathrm{A/cm^2}$。在本任务中，请专注于齐次线性无源动力学，将 $E_L$ 设为 $0$，将 $i_e(x,t)$ 设为 $0$，并施加封端（无轴向电流）边界条件，即 Neumann 条件\n$$\n\\frac{\\partial V(0,t)}{\\partial x} \\;=\\; 0, \\qquad \\frac{\\partial V(L,t)}{\\partial x} \\;=\\; 0,\n$$\n对于长度为 $L$（单位 $\\mathrm{cm}$）的电缆。\n\n从上述基本定律出发，使用尊重 Neumann 边界条件的二阶精确有限差分，在一个包含 $N$ 个节点、间距为 $\\Delta x = L/(N-1)$ 的均匀网格上，构建空间离散系统，从而得到一个半离散线性常微分方程组，\n$$\n\\frac{d\\mathbf{V}(t)}{dt} \\;=\\; A\\,\\mathbf{V}(t),\n$$\n其中 $\\mathbf{V}(t)\\in\\mathbb{R}^N$ 汇集了节点电压，而 $A\\in\\mathbb{R}^{N\\times N}$ 是由轴向扩散和膜漏泄产生的刚度矩阵。请用\n$$\nD \\;=\\; \\frac{a}{2\\,R_i\\,c_m} \\quad \\text{单位为} \\;\\mathrm{cm^2/s}, \\qquad \\alpha \\;=\\; \\frac{g_m}{c_m} \\quad \\text{单位为} \\; \\mathrm{s^{-1}},\n$$\n来表示 $A$，并为隐式 Backward Euler 和 Crank–Nicolson 时间步进格式提供所得线性系统的完整三对角结构。具体来说，对于时间步长 $\\Delta t$（单位 $\\mathrm{s}$），推导线性系统\n$$\n\\bigl(I - \\Delta t\\,A\\bigr)\\,\\mathbf{V}^{n+1} \\;=\\; \\mathbf{V}^{n} \\quad \\text{(Backward Euler)},\n$$\n和\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\,A\\bigr)\\,\\mathbf{V}^{n+1} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\,A\\bigr)\\,\\mathbf{V}^{n} \\quad \\text{(Crank–Nicolson)},\n$$\n并解释为什么这些隐式格式对于所考虑的线性无源动力学是无条件稳定的。您的解释必须基于第一性原理：刻画由 Neumann 边界条件和漏泄的空间离散化产生的矩阵 $A$ 的谱，并将其与所选隐式格式对线性系统的绝对稳定性性质联系起来。\n\n实现一个程序，该程序：\n- 使用带有 Neumann 边界条件的二阶有限差分法，为一组给定的物理参数和网格分辨率构建矩阵 $A$。\n- 计算 Backward Euler 和 Crank–Nicolson 的单步放大算子的谱半径。对于 Backward Euler，单步放大算子是 $\\bigl(I - \\Delta t\\,A\\bigr)^{-1}$。对于 Crank–Nicolson，它是 $\\bigl(I - \\tfrac{\\Delta t}{2}\\,A\\bigr)^{-1}\\,\\bigl(I + \\tfrac{\\Delta t}{2}\\,A\\bigr)$。谱半径应报告为一个四舍五入到六位小数的浮点数。\n\n使用以下测试套件，其中每个测试用例指定了数值格式、网格大小、物理参数和时间步长。所有量均使用上述单位。电压应以 $\\mathrm{mV}$ 为单位处理，但由于动力学是齐次线性的，只有矩阵 $A$ 及其谱会影响所要求的测量值。\n\n- 测试用例 1（典型参数，小时间步长，Backward Euler）：\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.0001$。\n- 测试用例 2（典型参数，大时间步长，Backward Euler）：\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.05$。\n- 测试用例 3（典型参数，大时间步长，Crank–Nicolson）：\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.05$。\n- 测试用例 4（无漏泄边缘情况，大时间步长，Crank–Nicolson）：\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 0$, $\\Delta t = 0.05$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其顺序与上面列出的测试用例相同。对于每个测试用例，将相应单步放大算子的谱半径输出为一个四舍五入到六位小数的浮点数。例如，输出格式必须是\n`[r_1,r_2,r_3,r_4]`,\n其中 $r_1$、$r_2$、$r_3$ 和 $r_4$ 分别是测试用例 1、2、3 和 4 计算出的浮点数，每个都四舍五入到六位小数。所有时间量必须以 $\\mathrm{s}$ 为单位处理，所有长度以 $\\mathrm{cm}$ 为单位，所有电压以 $\\mathrm{mV}$ 为单位。",
            "solution": "该问题要求推导和实现一维无源电缆方程的隐式数值格式，然后基于放大算子的谱半径进行稳定性分析。\n\n### 1. 电缆方程的半离散化\n\n膜电压 $V(x,t)$ 的控制偏微分方程（PDE）如下：\n$$\nc_m \\,\\frac{\\partial V(x,t)}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V(x,t)}{\\partial x^2} \\;-\\; g_m \\,\\bigl(V(x,t) - E_L\\bigr) \\;+\\; i_e(x,t)\n$$\n我们被要求考虑齐次情况，其中漏泄反转电位 $E_L=0\\,\\mathrm{mV}$，外部电流密度 $i_e(x,t)=0\\,\\mathrm{A/cm^2}$。偏微分方程简化为：\n$$\nc_m \\,\\frac{\\partial V}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V}{\\partial x^2} \\;-\\; g_m \\,V\n$$\n两边除以单位面积膜电容 $c_m$，并引入指定的扩散常数 $D = \\frac{a}{2\\,R_i\\,c_m}$ 和漏泄常数 $\\alpha = \\frac{g_m}{c_m}$，我们得到归一化形式：\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; D \\frac{\\partial^2 V}{\\partial x^2} \\;-\\; \\alpha V\n$$\n我们将空间域 $x \\in [0, L]$ 离散化为一个包含 $N$ 个节点的均匀网格，$x_j = j \\Delta x$，其中 $j=0, 1, \\dots, N-1$，网格间距为 $\\Delta x = L/(N-1)$。设 $V_j(t)$ 是 $V(x_j, t)$ 的数值近似。节点电压向量表示为 $\\mathbf{V}(t) = [V_0(t), V_1(t), \\dots, V_{N-1}(t)]^T$。\n\n空间二阶导数对内部节点（$j=1, \\dots, N-2$）使用二阶精确中心差分公式进行近似：\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_j} \\approx \\frac{V_{j-1}(t) - 2V_j(t) + V_{j+1}(t)}{(\\Delta x)^2}\n$$\n封端边界条件 $\\frac{\\partial V(0,t)}{\\partial x} = 0$ 和 $\\frac{\\partial V(L,t)}{\\partial x} = 0$ 是 Neumann 条件。为保持二阶精度，我们采用“鬼点”（或虚构节点）。在左边界（$j=0$），一阶导数的中心差分为 $\\frac{V_1 - V_{-1}}{2\\Delta x} = 0$，这意味着 $V_{-1} = V_1$。将其代入 $j=0$ 处二阶导数的中心差分公式，得到：\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_0} \\approx \\frac{V_{-1} - 2V_0 + V_1}{(\\Delta x)^2} = \\frac{V_1 - 2V_0 + V_1}{(\\Delta x)^2} = \\frac{2(V_1 - V_0)}{(\\Delta x)^2}\n$$\n类似地，在右边界（$j=N-1$），条件 $\\frac{V_{N} - V_{N-2}}{2\\Delta x} = 0$ 意味着鬼点值为 $V_N = V_{N-2}$。二阶导数的近似变为：\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_{N-1}} \\approx \\frac{V_{N-2} - 2V_{N-1} + V_N}{(\\Delta x)^2} = \\frac{2(V_{N-2} - V_{N-1})}{(\\Delta x)^2}\n$$\n将这些近似代入偏微分方程，得到一个包含 $N$ 个耦合常微分方程（ODE）的系统，称为半离散系统：\n*   对于 $j=0$：$\\frac{dV_0}{dt} = D \\frac{2(V_1 - V_0)}{(\\Delta x)^2} - \\alpha V_0$\n*   对于 $j=1, \\dots, N-2$：$\\frac{dV_j}{dt} = D \\frac{V_{j-1} - 2V_j + V_{j+1}}{(\\Delta x)^2} - \\alpha V_j$\n*   对于 $j=N-1$：$\\frac{dV_{N-1}}{dt} = D \\frac{2(V_{N-2} - V_{N-1})}{(\\Delta x)^2} - \\alpha V_{N-1}$\n\n这个系统可以写成矩阵形式 $\\frac{d\\mathbf{V}}{dt} = A\\,\\mathbf{V}$，其中 $A$ 是一个 $N \\times N$ 的三对角矩阵，定义如下：\n$$\nA = \\frac{D}{(\\Delta x)^2}\n\\begin{pmatrix}\n-2   2   0   \\dots   0 \\\\\n1   -2   1   \\dots   0 \\\\\n0   \\ddots   \\ddots   \\ddots   0 \\\\\n0   \\dots   1   -2   1 \\\\\n0   \\dots   0   2   -2\n\\end{pmatrix}\n- \\alpha\n\\begin{pmatrix}\n1   0   \\dots   0 \\\\\n0   1   \\dots   0 \\\\\n\\vdots    \\ddots    \\vdots \\\\\n0   \\dots    1  0 \\\\\n0   \\dots    0  1\n\\end{pmatrix}\n$$\n$A$ 的分量为 $A_{j,k}$，其中对于 $j \\in \\{1, \\dots, N-2\\}$，$A_{j,j-1} = D/(\\Delta x)^2$，$A_{j,j} = -2D/(\\Delta x)^2 - \\alpha$，$A_{j,j+1} = D/(\\Delta x)^2$。在边界处，$A_{0,0} = -2D/(\\Delta x)^2 - \\alpha$，$A_{0,1} = 2D/(\\Delta x)^2$，$A_{N-1,N-2} = 2D/(\\Delta x)^2$，以及 $A_{N-1,N-1} = -2D/(\\Delta x)^2 - \\alpha$。\n\n### 2. 时间步进格式与稳定性分析\n\n我们对常微分方程系统 $\\frac{d\\mathbf{V}}{dt} = A\\,\\mathbf{V}$ 进行时间离散化。设 $\\mathbf{V}^n$ 表示在时间 $t_n = n \\Delta t$ 时的电压向量。\n\n**Backward Euler (BE):** 这个一阶隐式格式通过在未来的时间步 $n+1$ 处计算右侧项来定义：\n$$ \\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = A \\mathbf{V}^{n+1} \\implies (I - \\Delta t A) \\mathbf{V}^{n+1} = \\mathbf{V}^n $$\n由此我们求解 $\\mathbf{V}^{n+1}$。单步放大算子是 $G_{BE} = (I - \\Delta t A)^{-1}$。\n\n**Crank-Nicolson (CN):** 这个二阶隐式格式对当前和未来时间步的右侧项进行平均：\n$$ \\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = \\frac{1}{2} (A \\mathbf{V}^n + A \\mathbf{V}^{n+1}) \\implies (I - \\tfrac{\\Delta t}{2} A) \\mathbf{V}^{n+1} = (I + \\tfrac{\\Delta t}{2} A) \\mathbf{V}^n $$\n放大算子是 $G_{CN} = (I - \\tfrac{\\Delta t}{2} A)^{-1} (I + \\tfrac{\\Delta t}{2} A)$。\n\n**稳定性分析：** 如果数值格式的放大算子的谱半径 $\\rho(G)$ 满足 $\\rho(G) \\le 1$，则该格式是稳定的。$G$ 的特征值是 $A$ 的特征值的函数。设 $\\lambda_k$ 是 $A$ 的一个特征值。矩阵 $A$ 是一个用于 Neumann 条件的缩放后离散拉普拉斯矩阵与 $-\\alpha I$ 的和。离散拉普拉斯部分是对称的，并且已知其特征值是实数且非正的。带有 Neumann 条件的二阶导数的特定 $N \\times N$ 矩阵的特征值为 $\\frac{1}{(\\Delta x)^2} \\left[ -4\\sin^2\\left(\\frac{k\\pi}{2(N-1)}\\right) \\right]$，其中 $k=0, 1, \\dots, N-1$。\n因此，$A$ 的特征值为：\n$$\n\\lambda_k = -\\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\pi}{2(N-1)}\\right) - \\alpha, \\quad k=0, 1, \\dots, N-1\n$$\n由于 $D \\ge 0$ 和 $\\alpha \\ge 0$，$A$ 的所有特征值 $\\lambda_k$ 都是实数且非正的，即 $\\lambda_k \\in (-\\infty, 0]$。\n\n对于 **Backward Euler** 格式，$G_{BE}$ 的特征值为 $\\mu_k = \\frac{1}{1 - \\Delta t \\lambda_k}$。由于 $\\lambda_k \\le 0$ 且 $\\Delta t  0$，项 $-\\Delta t \\lambda_k \\ge 0$。分母 $1 - \\Delta t \\lambda_k \\ge 1$。因此，特征值的模为 $|\\mu_k| = \\frac{1}{|1 - \\Delta t \\lambda_k|} = \\frac{1}{1 - \\Delta t \\lambda_k} \\le 1$。这对任何 $\\Delta t  0$ 的选择都成立，因此 Backward Euler 格式对于此问题是无条件稳定的。\n\n对于 **Crank-Nicolson** 格式，$G_{CN}$ 的特征值为 $\\mu_k = \\frac{1 + \\frac{\\Delta t}{2} \\lambda_k}{1 - \\frac{\\Delta t}{2} \\lambda_k}$。令 $z = \\frac{\\Delta t}{2} \\lambda_k$。由于 $\\lambda_k \\le 0$，我们有 $z \\le 0$。对于 $z\\le 0$，放大因子是一个实数 $\\mu(z) = \\frac{1+z}{1-z}$。其模为 $|\\mu(z)| = \\left|\\frac{1+z}{1-z}\\right|$。\n*   对于 $z \\in [-1, 0]$，$|\\mu(z)| = \\frac{1+z}{1-z} \\le 1$。\n*   对于 $z  -1$，$|\\mu(z)| = -\\frac{1+z}{1-z} = \\frac{z+1}{z-1}  1$。\n因此，对于任何实数非正特征值 $\\lambda_k$，CN 放大矩阵对应的特征值 $\\mu_k$ 的模满足 $|\\mu_k| \\le 1$。等号 $|\\mu_k|=1$ 仅在 $\\lambda_k = 0$ 时成立（如果 $\\alpha=0$，这发生在 $k=0$ 模式下）。因此，Crank-Nicolson 格式也是无条件稳定的。这个性质是 A-稳定性的直接结果，A-稳定性保证了对于特征值在左半平面的任何系统都是稳定的，我们的矩阵 $A$ 满足这个条件。\n\n该实现将构建矩阵 $A$，形成相应的放大算子 $G$，并使用数值线性代数例程计算其谱半径 $\\rho(G) = \\max_k |\\text{eig}_k(G)|$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the transient voltage spread problem for an arbitrary number of test cases.\n\n    This function constructs the stiffness matrix A for the passive cable equation\n    and computes the spectral radius of the one-step amplification operator for\n    Backward Euler or Crank-Nicolson schemes.\n    \"\"\"\n    test_cases = [\n        # scheme, N, L, a, Ri, cm, gm, dt\n        ('BE', 50, 0.04, 1e-4, 100, 1e-6, 1e-4, 0.0001),\n        ('BE', 50, 0.04, 1e-4, 100, 1e-6, 1e-4, 0.05),\n        ('CN', 50, 0.04, 1e-4, 100, 1e-6, 1e-4, 0.05),\n        ('CN', 50, 0.04, 1e-4, 100, 1e-6, 0.0, 0.05),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        scheme, N, L, a, Ri, cm, gm, dt = case\n\n        # Calculate derived physical and numerical parameters\n        dx = L / (N - 1)\n        # Diffusion coefficient D (cm^2/s)\n        D = a / (2 * Ri * cm)\n        # Leak rate alpha (1/s)\n        alpha = gm / cm\n\n        # Construct the stiffness matrix A\n        A = np.zeros((N, N))\n\n        # Coefficients for finite difference stencil\n        c_diag = -2 * D / (dx**2) - alpha\n        c_off = D / (dx**2)\n\n        # Fill the interior of the matrix\n        for i in range(1, N - 1):\n            A[i, i - 1] = c_off\n            A[i, i] = c_diag\n            A[i, i + 1] = c_off\n\n        # Apply Neumann boundary conditions (sealed ends)\n        # At x=0 (j=0)\n        A[0, 0] = c_diag\n        A[0, 1] = 2 * c_off\n        \n        # At x=L (j=N-1)\n        A[N - 1, N - 1] = c_diag\n        A[N - 1, N - 2] = 2 * c_off\n        \n        # Define the identity matrix\n        I = np.identity(N)\n\n        # Construct the one-step amplification operator G\n        if scheme == 'BE':\n            # G = (I - dt*A)^(-1)\n            M = I - dt * A\n            G = np.linalg.inv(M)\n        elif scheme == 'CN':\n            # G = (I - dt/2*A)^(-1) * (I + dt/2*A)\n            M_lhs = I - (dt / 2) * A\n            M_rhs = I + (dt / 2) * A\n            G = np.linalg.inv(M_lhs) @ M_rhs\n\n        # Compute eigenvalues of the amplification operator\n        eigenvalues = np.linalg.eigvals(G)\n\n        # The spectral radius is the maximum of the absolute values of the eigenvalues\n        spectral_radius = np.max(np.abs(eigenvalues))\n        \n        results.append(spectral_radius)\n\n    # Format the output string as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}