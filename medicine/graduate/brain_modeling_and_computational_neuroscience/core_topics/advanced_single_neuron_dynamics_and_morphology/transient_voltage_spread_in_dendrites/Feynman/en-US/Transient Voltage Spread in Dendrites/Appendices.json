{
    "hands_on_practices": [
        {
            "introduction": "Understanding how boundaries shape electrical signals is fundamental to dendritic theory. This practice explores the common scenario of a \"sealed end\" dendritic tip, where no axial current can escape. You will use the elegant method of images to construct an analytical solution, providing deep insight into how this no-flux boundary condition effectively reflects and amplifies incoming voltage transients .",
            "id": "4031310",
            "problem": "Consider a passive, semi-infinite dendritic cable occupying $x \\geq 0$ that is initially at rest, with a sealed end at $x=0$. The membrane potential $V(x,t)$ obeys the one-dimensional linear cable equation with per-unit-length parameters: axial resistance $r_a$ (in $\\Omega \\cdot \\mathrm{cm}^{-1}$), membrane conductance $G_m$ (in $\\mathrm{S} \\cdot \\mathrm{cm}^{-1}$), and membrane capacitance $C_m$ (in $\\mathrm{F} \\cdot \\mathrm{cm}^{-1}$). An instantaneous point current impulse of strength $I_0$ (in $\\mathrm{A} \\cdot \\mathrm{s}$) is injected at position $x=x_0 > 0$ at time $t=0$, modeled by $I_{\\mathrm{inj}}(x,t)=I_0\\,\\delta(x-x_0)\\,\\delta(t)$. The governing Partial Differential Equation (PDE) and conditions are:\n- Cable dynamics: $C_m\\,\\partial_t V = \\frac{1}{r_a}\\,\\partial_{xx} V - G_m\\,V + I_{\\mathrm{inj}}(x,t)$ for $x \\geq 0$, $t > 0$.\n- Sealed-end (no axial current) boundary condition: $\\partial_x V(0,t)=0$ for $t > 0$.\n- Decay at infinity: $V(x,t)\\to 0$ as $x\\to\\infty$ for $t > 0$.\n- Rest initial condition: $V(x,0^{-})=0$ for $x \\geq 0$.\n\nUsing only fundamental linearity and symmetry principles together with the well-tested fundamental solution for diffusion with linear decay, construct the transient solution $V(x,t)$ for $t>0$ and $x \\geq 0$ by the method of images. In particular:\n- Start from the infinite-line fundamental solution for the operator $\\partial_t - D\\,\\partial_{xx} + \\tau_m^{-1}$, where $D \\equiv \\frac{1}{r_a C_m}$ and $\\tau_m \\equiv \\frac{C_m}{G_m}$.\n- Enforce the sealed-end boundary condition by an appropriate image source, and justify the sign choice of the image by directly verifying the boundary condition.\n- Express your final $V(x,t)$ as a closed-form expression in terms of $x$, $t$, $x_0$, $I_0$, $C_m$, $D$, and $\\tau_m$.\n\nYour final answer must be a single closed-form analytic expression. Do not provide an equation or an inequality. No numerical rounding is required.",
            "solution": "The problem asks for the transient solution for the membrane potential $V(x,t)$ in a passive, semi-infinite dendritic cable subject to an instantaneous point current injection. The solution is to be constructed using the method of images.\n\nFirst, we validate the problem statement.\n**Step 1: Extract Givens**\n- Governing PDE: $C_m\\,\\partial_t V = \\frac{1}{r_a}\\,\\partial_{xx} V - G_m\\,V + I_{\\mathrm{inj}}(x,t)$ for $x \\geq 0$, $t > 0$.\n- Injected Current: $I_{\\mathrm{inj}}(x,t)=I_0\\,\\delta(x-x_0)\\,\\delta(t)$.\n- Injection Location: $x=x_0>0$.\n- Boundary Condition 1 (Sealed-end): $\\partial_x V(0,t)=0$ for $t > 0$.\n- Boundary Condition 2 (Decay at infinity): $V(x,t)\\to 0$ as $x\\to\\infty$ for $t > 0$.\n- Initial Condition (Rest): $V(x,0^{-})=0$ for $x \\geq 0$.\n- Parameters: axial resistance $r_a$, membrane conductance $G_m$, membrane capacitance $C_m$.\n- Definitions: $D \\equiv \\frac{1}{r_a C_m}$ and $\\tau_m \\equiv \\frac{C_m}{G_m}$.\n- Required Method: Method of images, starting from the fundamental solution for the operator $\\partial_t - D\\,\\partial_{xx} + \\tau_m^{-1}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on the standard linear cable equation, a fundamental model in computational neuroscience. All parameters, boundary conditions, and initial conditions are clearly stated and physically consistent, forming a standard initial-boundary value problem for a parabolic PDE. The problem is a textbook example of applying the method of images and is free of any listed flaws.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete, reasoned solution will be provided.\n\n**Solution Derivation**\n\nThe governing partial differential equation (PDE) is given as:\n$$\nC_m\\,\\frac{\\partial V}{\\partial t} = \\frac{1}{r_a}\\,\\frac{\\partial^2 V}{\\partial x^2} - G_m\\,V + I_0\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nWe begin by normalizing the equation. We divide the entire equation by the membrane capacitance per unit length, $C_m$:\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{1}{r_a C_m}\\,\\frac{\\partial^2 V}{\\partial x^2} - \\frac{G_m}{C_m}\\,V + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nUsing the provided definitions for the diffusion coefficient, $D \\equiv \\frac{1}{r_a C_m}$, and the membrane time constant, $\\tau_m \\equiv \\frac{C_m}{G_m}$, the PDE becomes:\n$$\n\\frac{\\partial V}{\\partial t} = D\\,\\frac{\\partial^2 V}{\\partial x^2} - \\frac{1}{\\tau_m}\\,V + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThis equation can be rearranged to highlight the linear operator acting on $V$:\n$$\n\\left(\\frac{\\partial}{\\partial t} - D\\,\\frac{\\partial^2}{\\partial x^2} + \\frac{1}{\\tau_m}\\right) V(x,t) = \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThe problem has a decay term $-\\frac{1}{\\tau_m}V$. To simplify the equation to the standard diffusion equation, we introduce a substitution. Let $V(x,t) = U(x,t)\\,\\exp(-t/\\tau_m)$. The partial derivatives of $V$ are:\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{\\partial U}{\\partial t}\\,\\exp(-t/\\tau_m) - \\frac{1}{\\tau_m}\\,U(x,t)\\,\\exp(-t/\\tau_m)\n$$\n$$\n\\frac{\\partial^2 V}{\\partial x^2} = \\frac{\\partial^2 U}{\\partial x^2}\\,\\exp(-t/\\tau_m)\n$$\nSubstituting these into the normalized PDE:\n$$\n\\frac{\\partial U}{\\partial t}\\,e^{-t/\\tau_m} - \\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m} = D\\,\\frac{\\partial^2 U}{\\partial x^2}\\,e^{-t/\\tau_m} - \\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m} + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThe term $-\\frac{1}{\\tau_m}U\\,e^{-t/\\tau_m}$ cancels out. Multiplying the entire equation by $\\exp(t/\\tau_m)$ and using the property that $f(t)\\delta(t) = f(0)\\delta(t)$, we get:\n$$\n\\frac{\\partial U}{\\partial t} = D\\,\\frac{\\partial^2 U}{\\partial x^2} + \\frac{I_0}{C_m}\\,\\delta(x-x_0)\\,\\delta(t)\n$$\nThis is the standard diffusion (or heat) equation for $U(x,t)$ on an infinite line, with an impulsive source of strength $\\frac{I_0}{C_m}$ at $x=x_0$ and $t=0$.\n\nThe fundamental solution (or Green's function) for the diffusion equation $\\partial_t U = D \\partial_{xx} U + \\delta(x-x_0)\\delta(t)$ on an infinite line ($-\\infty  x  \\infty$) is the Gaussian kernel:\n$$\nG(x,t; x_0) = \\frac{1}{\\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right)\n$$\nBy linearity, the solution for $U(x,t)$ on an infinite line due to the source $\\frac{I_0}{C_m}\\delta(x-x_0)\\delta(t)$ is:\n$$\nU_{\\mathrm{inf}}(x,t) = \\frac{I_0}{C_m} G(x,t; x_0) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right)\n$$\nThe problem is defined on a semi-infinite domain $x \\geq 0$ with a sealed-end boundary condition $\\partial_x V(0,t)=0$. Since $V$ and $U$ are related by a factor that does not depend on $x$, this is equivalent to $\\partial_x U(0,t)=0$. This is a Neumann boundary condition.\n\nWe use the method of images to satisfy this boundary condition. We consider an infinite cable and introduce an \"image\" source located at $x=-x_0$ (the reflection of the original source across the boundary at $x=0$). The solution for $x \\geq 0$ is then the sum of the influences of the original source at $x_0$ and the image source at $-x_0$.\n\nLet the image source have strength $k \\frac{I_0}{C_m}$. The total solution $U(x,t)$ on the infinite line is the superposition:\n$$\nU(x,t) = \\frac{I_0}{C_m} G(x,t; x_0) + k \\frac{I_0}{C_m} G(x,t; -x_0)\n$$\n$$\nU(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + k \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nTo determine the constant $k$, we enforce the boundary condition $\\partial_x U(0,t)=0$. First, we compute the spatial derivative of $U(x,t)$:\n$$\n\\frac{\\partial U}{\\partial x} = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\frac{-2(x-x_0)}{4Dt} \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + k \\frac{-2(x+x_0)}{4Dt} \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nNow, we evaluate this derivative at $x=0$:\n$$\n\\left.\\frac{\\partial U}{\\partial x}\\right|_{x=0} = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\frac{-1}{2Dt} \\left[ (-x_0) \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) + k(x_0) \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) \\right]\n$$\n$$\n\\left.\\frac{\\partial U}{\\partial x}\\right|_{x=0} = \\frac{I_0 x_0}{C_m \\sqrt{4\\pi D t}} \\frac{-1}{2Dt} \\exp\\left(-\\frac{x_0^2}{4Dt}\\right) (-1+k)\n$$\nFor this to be zero for all $t > 0$, we must have $-1+k=0$, which implies $k=1$. Thus, the image source must have the same sign and magnitude as the original source. This is the characteristic of a Neumann (no-flux) boundary condition.\n\nSubstituting $k=1$ into the expression for $U(x,t)$, we get the solution for the semi-infinite domain $x \\geq 0$:\n$$\nU(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nFinally, we transform back to the original variable $V(x,t)$ using the relation $V(x,t) = U(x,t) \\exp(-t/\\tau_m)$:\n$$\nV(x,t) = \\frac{I_0}{C_m \\sqrt{4\\pi D t}} \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\left[ \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right]\n$$\nThis is the final closed-form expression for the membrane potential $V(x,t)$ for $x \\geq 0$ and $t > 0$. The solution satisfies the PDE (by construction as a superposition of fundamental solutions), the sealed-end boundary condition at $x=0$, the decay condition at infinity, and the initial condition of rest before the impulse.",
            "answer": "$$\n\\boxed{\\frac{I_0}{C_m \\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{t}{\\tau_m}\\right) \\left( \\exp\\left(-\\frac{(x-x_0)^2}{4Dt}\\right) + \\exp\\left(-\\frac{(x+x_0)^2}{4Dt}\\right) \\right)}\n$$"
        },
        {
            "introduction": "In contrast to a sealed end, a \"killed end\" boundary models a location where voltage is held constant, such as at a connection to the large, low-resistance cell body (soma). This exercise demonstrates the versatility of the method of images by showing how a simple change in the setup—placing a negative, or inverted, image source—can satisfy this Dirichlet boundary condition. By comparing this to the sealed-end case, you will gain a clearer understanding of how different biophysical constraints dictate voltage dynamics in dendrites .",
            "id": "4031363",
            "problem": "Consider a passive, uniform dendritic cable modeled as a one-dimensional continuum occupying the semi-infinite domain $x \\geq 0$. Let $V(x,t)$ denote the transmembrane voltage deviation from rest. Under standard assumptions of linear membrane behavior and axial current flow, Kirchhoff’s circuit laws and current conservation yield the linear cable equation\n$$\n\\tau \\,\\frac{\\partial V}{\\partial t}(x,t) \\;=\\; \\lambda^{2}\\,\\frac{\\partial^{2} V}{\\partial x^{2}}(x,t) \\;-\\; V(x,t) \\;+\\; \\tau \\, s(x,t),\n$$\nwhere $\\tau$ is the membrane time constant, $\\lambda$ is the electrotonic length constant, and $s(x,t)$ is an externally applied source term representing transmembrane current injection per unit length. Define the diffusion coefficient $D$ and the decay rate $\\kappa$ by $D \\equiv \\lambda^{2}/\\tau$ and $\\kappa \\equiv 1/\\tau$, so that the homogeneous operator can be written as $\\partial/\\partial t - D\\,\\partial^{2}/\\partial x^{2} + \\kappa$.\n\nLet $G(x,t;x_{0})$ be the Green’s function for this operator on the semi-infinite domain $x \\geq 0$ with a killed end (Dirichlet boundary) at $x=0$, satisfying the boundary condition $G(0,t;x_{0})=0$ for all $t > 0$, causality $G(x,t;x_{0})=0$ for $t  0$, and the defining inhomogeneous partial differential equation (PDE)\n$$\n\\frac{\\partial G}{\\partial t}(x,t;x_{0}) \\;=\\; D\\,\\frac{\\partial^{2} G}{\\partial x^{2}}(x,t;x_{0}) \\;-\\; \\kappa\\,G(x,t;x_{0}) \\;+\\; \\delta(x-x_{0})\\,\\delta(t),\n$$\nfor $x \\geq 0$ and $t \\in \\mathbb{R}$, where $\\delta(\\cdot)$ denotes the Dirac delta distribution.\n\nUsing only fundamental principles of linear systems, symmetry, and the method of images, derive a closed-form expression for $G(x,t;x_{0})$ for $x \\geq 0$ and $t > 0$, in terms of $x$, $t$, $x_0$, $D$, and $\\tau$. Explicitly verify that the Dirichlet boundary condition at the killed end is satisfied by your expression. The Heaviside step function $H(t)$ is defined as $H(t)=0$ for $t0$ and $H(t)=1$ for $t>0$ and may be used to encode causality. Express your final answer as a single analytic expression for $G(x,t;x_{0})$. No numerical evaluation is required.",
            "solution": "The user wants me to solve the problem by first validating its integrity and then providing a complete solution.\n\n### Step 1: Extract Givens\n- **Governing Equation (Linear Cable Equation):** \n$$\n\\tau \\,\\frac{\\partial V}{\\partial t}(x,t) \\;=\\; \\lambda^{2}\\,\\frac{\\partial^{2} V}{\\partial x^{2}}(x,t) \\;-\\; V(x,t) \\;+\\; \\tau \\, s(x,t)\n$$\n- **Domain:** $x \\geq 0$\n- **Parameter Definitions:**\n  - Diffusion coefficient: $D \\equiv \\lambda^{2}/\\tau$\n  - Decay rate: $\\kappa \\equiv 1/\\tau$\n- **Green's Function PDE:** \n$$\n\\frac{\\partial G}{\\partial t}(x,t;x_{0}) \\;=\\; D\\,\\frac{\\partial^{2} G}{\\partial x^{2}}(x,t;x_{0}) \\;-\\; \\kappa\\,G(x,t;x_{0}) \\;+\\; \\delta(x-x_{0})\\,\\delta(t)\n$$\n  for $x \\geq 0$ and $t \\in \\mathbb{R}$.\n- **Boundary Condition:** $G(0,t;x_{0})=0$ for all $t > 0$ (killed end, Dirichlet boundary).\n- **Causality Condition:** $G(x,t;x_{0})=0$ for $t  0$.\n- **Heaviside Step Function:** $H(t)=0$ for $t0$ and $H(t)=1$ for $t>0$.\n- **Task:** Derive a closed-form expression for $G(x,t;x_{0})$ for $x \\geq 0$ and $t>0$ using the method of images, and verify the boundary condition.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement will now be validated against the specified criteria.\n\n- **Scientifically Grounded:** The problem is based on the linear cable equation, a cornerstone model in computational neuroscience for describing voltage propagation in passive neuronal dendrites. This equation is derived from fundamental principles of electrical circuits (Kirchhoff's laws, Ohm's law) applied to a continuous cable structure. The formulation of a Green's function for this linear PDE is a standard and rigorous mathematical approach. The problem is fundamentally sound.\n- **Well-Posed:** The problem asks for the fundamental solution (Green's function) of a linear parabolic partial differential equation on a semi-infinite domain with a specified initial condition (a Dirac delta function in time and space) and a Dirichlet boundary condition. This is a classic well-posed problem in mathematical physics, which is expected to have a unique and stable solution.\n- **Objective:** The problem is stated using precise mathematical language and established scientific terminology. There are no subjective, ambiguous, or opinion-based statements.\n- **Completeness and Consistency:** All necessary information—the PDE, domain, boundary conditions, and definitions of parameters—is provided. The constraints are self-consistent.\n- **Other Flaws:** The problem does not exhibit any other flaws such as being metaphorical, unrealistic, tautological, or unverifiable. It is a standard, solvable problem in the specified field.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to find the Green's function $G(x,t;x_{0})$ that satisfies the partial differential equation:\n$$\n\\frac{\\partial G}{\\partial t} = D\\,\\frac{\\partial^{2} G}{\\partial x^{2}} - \\kappa\\,G + \\delta(x-x_{0})\\,\\delta(t)\n$$\non the domain $x \\geq 0$, subject to the boundary condition $G(0,t;x_{0})=0$ for $t>0$ and causality $G(x,t;x_{0})=0$ for $t0$.\n\nFirst, we simplify the equation by eliminating the decay term $-\\kappa\\,G$. We introduce an auxiliary function $\\tilde{G}(x,t;x_{0})$ via the substitution:\n$$\nG(x,t;x_{0}) = \\tilde{G}(x,t;x_{0}) \\, \\exp(-\\kappa t)\n$$\nSubstituting this into the PDE, we get:\n$$\n\\frac{\\partial}{\\partial t} \\left( \\tilde{G} \\, \\exp(-\\kappa t) \\right) = D\\,\\frac{\\partial^{2}}{\\partial x^{2}} \\left( \\tilde{G} \\, \\exp(-\\kappa t) \\right) - \\kappa \\left( \\tilde{G} \\, \\exp(-\\kappa t) \\right) + \\delta(x-x_{0})\\,\\delta(t)\n$$\nApplying the product rule for differentiation:\n$$\n\\frac{\\partial \\tilde{G}}{\\partial t}\\exp(-\\kappa t) - \\kappa\\,\\tilde{G}\\,\\exp(-\\kappa t) = D\\,\\exp(-\\kappa t)\\,\\frac{\\partial^{2} \\tilde{G}}{\\partial x^{2}} - \\kappa\\,\\tilde{G}\\,\\exp(-\\kappa t) + \\delta(x-x_{0})\\,\\delta(t)\n$$\nThe terms involving $-\\kappa\\,\\tilde{G}\\,\\exp(-\\kappa t)$ on both sides cancel out. We can also handle the delta function source term by noting that $\\delta(t)f(t) = \\delta(t)f(0)$. Since $\\exp(-\\kappa \\cdot 0) = 1$, we have $\\delta(t) = \\exp(\\kappa t)\\delta(t)$, which allows us to factor out $\\exp(-\\kappa t)$ from the entire equation:\n$$\n\\exp(-\\kappa t) \\left( \\frac{\\partial \\tilde{G}}{\\partial t} \\right) = \\exp(-\\kappa t) \\left( D\\,\\frac{\\partial^{2} \\tilde{G}}{\\partial x^{2}} + \\delta(x-x_{0})\\,\\delta(t) \\right)\n$$\nThis simplifies to the standard diffusion (or heat) equation for $\\tilde{G}$:\n$$\n\\frac{\\partial \\tilde{G}}{\\partial t} = D\\,\\frac{\\partial^{2} \\tilde{G}}{\\partial x^{2}} + \\delta(x-x_{0})\\,\\delta(t)\n$$\nThe fundamental solution to this equation on an infinite spatial domain, $x \\in \\mathbb{R}$, which we denote $\\tilde{G}_{\\infty}$, is a Gaussian function representing the diffusion of a point source of heat/particles:\n$$\n\\tilde{G}_{\\infty}(x, t; x_{0}) = \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right)\n$$\nwhere the Heaviside step function $H(t)$ enforces causality.\n\nWe now use the method of images to construct the solution for the semi-infinite domain $x \\geq 0$ with the Dirichlet boundary condition $G(0,t;x_{0})=0$. Since $G$ is proportional to $\\tilde{G}$, this boundary condition is equivalent to $\\tilde{G}(0,t;x_{0})=0$. To achieve this zero-value boundary, we place a negative \"image\" source at position $-x_{0}$. The solution $\\tilde{G}(x,t;x_{0})$ in the half-space $x\\geq0$ is then the superposition of the field from the original source at $x_0$ and the image source at $-x_0$:\n$$\n\\tilde{G}(x,t; x_{0}) = \\tilde{G}_{\\infty}(x, t; x_{0}) - \\tilde{G}_{\\infty}(x, t; -x_{0})\n$$\nSubstituting the expression for $\\tilde{G}_{\\infty}$:\n$$\n\\tilde{G}(x,t; x_{0}) = \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right) - \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\exp\\left(-\\frac{(x-(-x_{0}))^2}{4Dt}\\right)\n$$\n$$\n\\tilde{G}(x,t; x_{0}) = \\frac{H(t)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right) - \\exp\\left(-\\frac{(x+x_{0})^2}{4Dt}\\right) \\right]\n$$\nNow, we transform back to the original Green's function $G$ using $G = \\tilde{G}\\exp(-\\kappa t)$. We also substitute $\\kappa = 1/\\tau$:\n$$\nG(x,t; x_{0}) = \\frac{H(t)\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(x-x_{0})^2}{4Dt}\\right) - \\exp\\left(-\\frac{(x+x_{0})^2}{4Dt}\\right) \\right]\n$$\nThis is the closed-form expression for the Green's function for $x \\geq 0$ and $t > 0$.\n\nFinally, we explicitly verify that the Dirichlet boundary condition $G(0,t;x_{0})=0$ is satisfied for $t > 0$. We set $x=0$ in the expression for $G$:\n$$\nG(0,t; x_{0}) = \\frac{H(t)\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{(0-x_{0})^2}{4Dt}\\right) - \\exp\\left(-\\frac{(0+x_{0})^2}{4Dt}\\right) \\right]\n$$\nFor $t > 0$, $H(t)=1$. The expression becomes:\n$$\nG(0,t; x_{0}) = \\frac{\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ \\exp\\left(-\\frac{x_{0}^2}{4Dt}\\right) - \\exp\\left(-\\frac{x_{0}^2}{4Dt}\\right) \\right]\n$$\n$$\nG(0,t; x_{0}) = \\frac{\\exp(-t/\\tau)}{\\sqrt{4 \\pi D t}} \\left[ 0 \\right] = 0\n$$\nThe boundary condition is satisfied as required. The derived expression is the complete solution.",
            "answer": "$$\n\\boxed{\\frac{H(t)\\exp(-\\frac{t}{\\tau})}{\\sqrt{4 \\pi D t}} \\left( \\exp\\left(-\\frac{(x-x_{0})^{2}}{4Dt}\\right) - \\exp\\left(-\\frac{(x+x_{0})^{2}}{4Dt}\\right) \\right)}\n$$"
        },
        {
            "introduction": "While analytical solutions provide powerful insights for simple geometries, realistic dendritic trees require numerical simulation. This practice bridges the gap between theory and application by guiding you through the implementation of an implicit numerical scheme to solve the cable equation. You will not only build a functional simulator but also explore the critical concept of unconditional stability, a property that makes implicit methods like Backward Euler and Crank-Nicolson essential tools for robust and efficient neural modeling .",
            "id": "4031343",
            "problem": "You will implement an implicit time-stepping scheme for the transient spread of membrane voltage along a passive, one-dimensional dendritic cable. The physical model is the passive cable equation derived from fundamental circuit laws: charge conservation and Ohmic conductance for the membrane and axial cytoplasm. The governing partial differential equation is\n$$\nc_m \\,\\frac{\\partial V(x,t)}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V(x,t)}{\\partial x^2} \\;-\\; g_m \\,\\bigl(V(x,t) - E_L\\bigr) \\;+\\; i_e(x,t),\n$$\nwhere $V(x,t)$ is the membrane voltage in $\\mathrm{mV}$, $x$ is position along the dendrite in $\\mathrm{cm}$, and $t$ is time in $\\mathrm{s}$. The quantities $c_m$ (membrane capacitance per unit area) are in $\\mathrm{F/cm^2}$, $a$ (dendrite radius) is in $\\mathrm{cm}$, $R_i$ (axial resistivity) is in $\\Omega\\cdot\\mathrm{cm}$, $g_m$ (membrane conductance per unit area) is in $\\mathrm{S/cm^2}$, $E_L$ (leak reversal potential) is in $\\mathrm{mV}$, and $i_e(x,t)$ (external current density per unit area) is in $\\mathrm{A/cm^2}$. For this task, focus on the homogeneous linear passive dynamics, setting $E_L$ equal to $0$ and $i_e(x,t)$ equal to $0$, and impose sealed-end (no axial current) boundary conditions, which are the Neumann conditions\n$$\n\\frac{\\partial V(0,t)}{\\partial x} \\;=\\; 0, \\qquad \\frac{\\partial V(L,t)}{\\partial x} \\;=\\; 0,\n$$\nfor a cable of length $L$ in $\\mathrm{cm}$.\n\nStarting from the fundamental laws listed above, formulate the spatially discretized system on a uniform grid of $N$ nodes with spacing $\\Delta x = L/(N-1)$ using second-order accurate finite differences that respect the Neumann boundary conditions, yielding a semidiscrete linear system of ordinary differential equations,\n$$\n\\frac{d\\mathbf{V}(t)}{dt} \\;=\\; A\\,\\mathbf{V}(t),\n$$\nin which $\\mathbf{V}(t)\\in\\mathbb{R}^N$ collects the nodal voltages and $A\\in\\mathbb{R}^{N\\times N}$ is the stiffness matrix that arises from the axial diffusion and membrane leak. Express $A$ in terms of\n$$\nD \\;=\\; \\frac{a}{2\\,R_i\\,c_m} \\quad \\text{in} \\;\\mathrm{cm^2/s}, \\qquad \\alpha \\;=\\; \\frac{g_m}{c_m} \\quad \\text{in} \\; \\mathrm{s^{-1}},\n$$\nand provide the full tridiagonal structure of the resulting linear systems for implicit Backward Euler and Crank–Nicolson time-stepping schemes. Specifically, for a time step size $\\Delta t$ in $\\mathrm{s}$, derive the linear systems\n$$\n\\bigl(I - \\Delta t\\,A\\bigr)\\,\\mathbf{V}^{n+1} \\;=\\; \\mathbf{V}^{n} \\quad \\text{(Backward Euler)},\n$$\nand\n$$\n\\bigl(I - \\tfrac{\\Delta t}{2}\\,A\\bigr)\\,\\mathbf{V}^{n+1} \\;=\\; \\bigl(I + \\tfrac{\\Delta t}{2}\\,A\\bigr)\\,\\mathbf{V}^{n} \\quad \\text{(Crank–Nicolson)},\n$$\nand explain why these implicit schemes are unconditionally stable for the linear passive dynamics under consideration. Your explanation must be grounded in first principles: characterize the spectrum of $A$ arising from the spatial discretization with Neumann boundary conditions and leak, and connect that to the absolute stability properties of the chosen implicit schemes for linear systems.\n\nImplement a program that:\n- Constructs the matrix $A$ for a given set of physical parameters and grid resolution using the second-order finite difference method with Neumann boundary conditions.\n- Computes the spectral radius of the one-step amplification operator for both Backward Euler and Crank–Nicolson. For Backward Euler, the one-step amplification is $(I - \\Delta t A)^{-1}$. For Crank–Nicolson, it is $(I - \\frac{\\Delta t}{2} A)^{-1} (I + \\frac{\\Delta t}{2} A)$. The spectral radius should be reported as a float rounded to six decimal places.\n\nUse the following test suite, where each test case specifies the numerical scheme, grid size, physical parameters, and time step. All quantities use the units indicated above. Voltage should be treated in $\\mathrm{mV}$, but because the dynamics are homogeneous and linear, only the matrix $A$ and its spectrum affect the requested measurements.\n\n- Test case 1 (typical parameters, small time step, Backward Euler):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.0001$.\n- Test case 2 (typical parameters, large time step, Backward Euler):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.05$.\n- Test case 3 (typical parameters, large time step, Crank–Nicolson):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 1\\times 10^{-4}$, $\\Delta t = 0.05$.\n- Test case 4 (no leak edge case, large time step, Crank–Nicolson):\n  - $N = 50$, $L = 0.04$, $a = 1\\times 10^{-4}$, $R_i = 100$, $c_m = 1\\times 10^{-6}$, $g_m = 0$, $\\Delta t = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases listed above. For each test case, output the spectral radius of the corresponding one-step amplification operator as a float rounded to six decimal places. For example, the output format must be\n`[r_1,r_2,r_3,r_4]`,\nwhere $r_1$, $r_2$, $r_3$, and $r_4$ are the computed floats for test cases 1, 2, 3, and 4, respectively, each rounded to six decimal places. All time quantities must be handled in $\\mathrm{s}$, all lengths in $\\mathrm{cm}$, and all voltages in $\\mathrm{mV}$.",
            "solution": "The problem asks for the derivation and implementation of implicit numerical schemes for the one-dimensional passive cable equation, followed by a stability analysis based on the spectral radius of the amplification operators.\n\n### 1. Semi-Discretization of the Cable Equation\n\nThe governing partial differential equation (PDE) for the membrane voltage $V(x,t)$ is given as:\n$$\nc_m \\,\\frac{\\partial V(x,t)}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V(x,t)}{\\partial x^2} \\;-\\; g_m \\,\\bigl(V(x,t) - E_L\\bigr) \\;+\\; i_e(x,t)\n$$\nWe are instructed to consider the homogeneous case where the leak reversal potential $E_L=0\\,\\mathrm{mV}$ and the external current density $i_e(x,t)=0\\,\\mathrm{A/cm^2}$. The PDE simplifies to:\n$$\nc_m \\,\\frac{\\partial V}{\\partial t} \\;=\\; \\frac{a}{2\\,R_i} \\,\\frac{\\partial^2 V}{\\partial x^2} \\;-\\; g_m \\,V\n$$\nDividing by the membrane capacitance per unit area, $c_m$, and introducing the specified constants for diffusion, $D = \\frac{a}{2\\,R_i\\,c_m}$, and leak, $\\alpha = \\frac{g_m}{c_m}$, we obtain the normalized form:\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; D \\frac{\\partial^2 V}{\\partial x^2} \\;-\\; \\alpha V\n$$\nWe discretize the spatial domain $x \\in [0, L]$ into a uniform grid of $N$ nodes, $x_j = j \\Delta x$ for $j=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = L/(N-1)$. Let $V_j(t)$ be the numerical approximation of $V(x_j, t)$. The vector of nodal voltages is denoted by $\\mathbf{V}(t) = [V_0(t), V_1(t), \\dots, V_{N-1}(t)]^T$.\n\nThe second spatial derivative is approximated using a second-order accurate central difference formula for the interior nodes ($j=1, \\dots, N-2$):\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_j} \\approx \\frac{V_{j-1}(t) - 2V_j(t) + V_{j+1}(t)}{(\\Delta x)^2}\n$$\nThe sealed-end boundary conditions, $\\frac{\\partial V(0,t)}{\\partial x} = 0$ and $\\frac{\\partial V(L,t)}{\\partial x} = 0$, are Neumann conditions. To maintain second-order accuracy, we employ \"ghost points\" (or fictitious nodes). At the left boundary ($j=0$), a centered difference for the first derivative is $\\frac{V_1 - V_{-1}}{2\\Delta x} = 0$, implying $V_{-1} = V_1$. Substituting this into the central difference formula for the second derivative at $j=0$ gives:\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_0} \\approx \\frac{V_{-1} - 2V_0 + V_1}{(\\Delta x)^2} = \\frac{V_1 - 2V_0 + V_1}{(\\Delta x)^2} = \\frac{2(V_1 - V_0)}{(\\Delta x)^2}\n$$\nSimilarly, at the right boundary ($j=N-1$), the condition $\\frac{V_{N} - V_{N-2}}{2\\Delta x} = 0$ implies a ghost point value of $V_N = V_{N-2}$. The second derivative approximation becomes:\n$$\n\\left. \\frac{\\partial^2 V}{\\partial x^2} \\right|_{x=x_{N-1}} \\approx \\frac{V_{N-2} - 2V_{N-1} + V_N}{(\\Delta x)^2} = \\frac{2(V_{N-2} - V_{N-1})}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the PDE yields a system of $N$ coupled ordinary differential equations (ODEs), known as the semi-discrete system:\n*   For $j=0$: $\\frac{dV_0}{dt} = D \\frac{2(V_1 - V_0)}{(\\Delta x)^2} - \\alpha V_0$\n*   For $j=1, \\dots, N-2$: $\\frac{dV_j}{dt} = D \\frac{V_{j-1} - 2V_j + V_{j+1}}{(\\Delta x)^2} - \\alpha V_j$\n*   For $j=N-1$: $\\frac{dV_{N-1}}{dt} = D \\frac{2(V_{N-2} - V_{N-1})}{(\\Delta x)^2} - \\alpha V_{N-1}$\n\nThis system can be written in matrix form $\\frac{d\\mathbf{V}}{dt} = A\\,\\mathbf{V}$, where $A$ is an $N \\times N$ tridiagonal matrix defined as:\n$$\nA = \\frac{D}{(\\Delta x)^2}\n\\begin{pmatrix}\n-2  2  0  \\dots  0 \\\\\n1  -2  1  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  1  -2  1 \\\\\n0  \\dots  0  2  -2\n\\end{pmatrix}\n- \\alpha\n\\begin{pmatrix}\n1  0  \\dots  0 \\\\\n0  1  \\dots  0 \\\\\n\\vdots   \\ddots  \\vdots \\\\\n0  \\dots   1\n\\end{pmatrix}\n$$\nThe components of $A$ are $A_{j,k}$ where for $j \\in \\{1, \\dots, N-2\\}$, $A_{j,j-1} = D/(\\Delta x)^2$, $A_{j,j} = -2D/(\\Delta x)^2 - \\alpha$, $A_{j,j+1} = D/(\\Delta x)^2$. At the boundaries, $A_{0,0} = -2D/(\\Delta x)^2 - \\alpha$, $A_{0,1} = 2D/(\\Delta x)^2$, $A_{N-1,N-2} = 2D/(\\Delta x)^2$, and $A_{N-1,N-1} = -2D/(\\Delta x)^2 - \\alpha$.\n\n### 2. Time-Stepping Schemes and Stability Analysis\n\nWe apply a time discretization to the ODE system $\\frac{d\\mathbf{V}}{dt} = A\\,\\mathbf{V}$. Let $\\mathbf{V}^n$ denote the voltage vector at time $t_n = n \\Delta t$.\n\n**Backward Euler (BE):** This first-order implicit scheme is defined by evaluating the right-hand side at the future time step $n+1$:\n$$ \\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = A \\mathbf{V}^{n+1} \\implies (I - \\Delta t A) \\mathbf{V}^{n+1} = \\mathbf{V}^n $$\nfrom which we solve for $\\mathbf{V}^{n+1}$. The one-step amplification operator is $G_{BE} = (I - \\Delta t A)^{-1}$.\n\n**Crank-Nicolson (CN):** This second-order implicit scheme averages the right-hand side over the current and future time steps:\n$$ \\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = \\frac{1}{2} (A \\mathbf{V}^n + A \\mathbf{V}^{n+1}) \\implies (I - \\tfrac{\\Delta t}{2} A) \\mathbf{V}^{n+1} = (I + \\tfrac{\\Delta t}{2} A) \\mathbf{V}^n $$\nThe amplification operator is $G_{CN} = (I - \\tfrac{\\Delta t}{2} A)^{-1} (I + \\tfrac{\\Delta t}{2} A)$.\n\n**Stability Analysis:** A numerical scheme is stable if the spectral radius of its amplification operator, $\\rho(G)$, satisfies $\\rho(G) \\le 1$. The eigenvalues of $G$ are functions of the eigenvalues of $A$. Let $\\lambda_k$ be an eigenvalue of $A$. The matrix $A$ is the sum of a scaled discrete Laplacian matrix for Neumann conditions and $-\\alpha I$. The discrete Laplacian portion is symmetric and its eigenvalues are known to be real and non-positive. The eigenvalues of the specific $N \\times N$ matrix for the second derivative with Neumann conditions are $\\frac{1}{(\\Delta x)^2} \\left[ -4\\sin^2\\left(\\frac{k\\pi}{2(N-1)}\\right) \\right]$ for $k=0, 1, \\dots, N-1$.\nThus, the eigenvalues of $A$ are:\n$$\n\\lambda_k = -\\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\pi}{2(N-1)}\\right) - \\alpha, \\quad k=0, 1, \\dots, N-1\n$$\nSince $D \\ge 0$ and $\\alpha \\ge 0$, all eigenvalues $\\lambda_k$ of $A$ are real and non-positive, i.e., $\\lambda_k \\in (-\\infty, 0]$.\n\nFor the **Backward Euler** scheme, the eigenvalues of $G_{BE}$ are $\\mu_k = \\frac{1}{1 - \\Delta t \\lambda_k}$. Since $\\lambda_k \\le 0$ and $\\Delta t > 0$, the term $-\\Delta t \\lambda_k \\ge 0$. The denominator $1 - \\Delta t \\lambda_k \\ge 1$. Consequently, the magnitude of the eigenvalues is $|\\mu_k| = \\frac{1}{|1 - \\Delta t \\lambda_k|} = \\frac{1}{1 - \\Delta t \\lambda_k} \\le 1$. This holds for any choice of $\\Delta t > 0$, so the Backward Euler scheme is unconditionally stable for this problem. The spectral radius is $\\rho(G_{BE}) = \\max_k |\\mu_k| = \\frac{1}{1 - \\Delta t \\lambda_{max}}$, where $\\lambda_{max}$ is the least negative eigenvalue of $A$. Since $\\sin^2(\\cdot)$ is smallest at $k=0$, $\\lambda_0 = -\\alpha$ is the least negative eigenvalue.\n\nFor the **Crank-Nicolson** scheme, the eigenvalues of $G_{CN}$ are $\\mu_k = \\frac{1 + \\frac{\\Delta t}{2} \\lambda_k}{1 - \\frac{\\Delta t}{2} \\lambda_k}$. Let $z = \\frac{\\Delta t}{2} \\lambda_k$. Since $\\lambda_k \\le 0$, we have $z \\le 0$. The amplification factor is a real number $\\mu(z) = \\frac{1+z}{1-z}$ for $z\\le 0$. The magnitude is $|\\mu(z)| = \\left|\\frac{1+z}{1-z}\\right|$.\n*   For $z \\in [-1, 0]$, $|\\mu(z)| = \\frac{1+z}{1-z} \\le 1$.\n*   For $z  -1$, $|\\mu(z)| = -\\frac{1+z}{1-z} = \\frac{1+z}{z-1}  1$.\nThus, for any real, non-positive eigenvalue $\\lambda_k$, the corresponding eigenvalue $\\mu_k$ of the CN amplification matrix has magnitude $|\\mu_k| \\le 1$. The equality $|\\mu_k|=1$ occurs only if $\\lambda_k = 0$ (which happens for the $k=0$ mode if $\\alpha=0$). Therefore, the Crank-Nicolson scheme is also unconditionally stable. This property is a direct consequence of A-stability, which guarantees stability for any system with eigenvalues in the left half-plane, a condition met by our matrix $A$.\n\nThe implementation will construct the matrix $A$, form the respective amplification operator $G$, and compute its spectral radius $\\rho(G) = \\max_k |\\text{eig}_k(G)|$ using numerical linear algebra routines.",
            "answer": "[0.990099,0.166667,0.999973,1.000000]"
        }
    ]
}