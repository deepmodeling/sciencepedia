{
    "hands_on_practices": [
        {
            "introduction": "我们实践的第一步是回到基本原理，直接比较两种模型在突触激活瞬间产生的电流。这个练习旨在阐明一个核心概念：基于电导的模型所产生的突触电流取决于突触后膜电位与突触反转电位之间的“驱动力”，而基于电流的模型则忽略了这种依赖性。通过计算兴奋性和抑制性输入的瞬时电流 ()，你将亲手验证这两种模型在最基本层面上的差异。",
            "id": "4025173",
            "problem": "考虑一个单室神经元模型，该模型具有被动泄漏和突触输入。膜电位处于静息状态，等于泄漏反转电位，即 $V = E_{L}$。假设一个泄漏整合发放（LIF）神经元的 $E_{L} = -65\\,\\mathrm{mV}$。在时间 $t=0$ 时，有两种类型的突触输入作用于该神经元：一种是兴奋性突触，其反转电位为 $E_{\\mathrm{exc}} = 0\\,\\mathrm{mV}$；另一种是抑制性突触，其反转电位为 $E_{\\mathrm{inh}} = -75\\,\\mathrm{mV}$。对于这两种突触，门控变量均为 $s(t) = \\exp(-t/\\tau_{s})$，因此 $s(0) = 1$。基于电导的模型将突触输入实现为一种电压依赖性电导，其峰值突触电导分别为 $g_{\\mathrm{exc}} = 1.2\\,\\mathrm{nS}$ 和 $g_{\\mathrm{inh}} = 1.2\\,\\mathrm{nS}$。基于电流的模型将突触输入实现为一个由相同门控变量控制的注入电流源，其权重分别为 $w_{\\mathrm{exc}} = -25\\,\\mathrm{pA}$ 和 $w_{\\mathrm{inh}} = +25\\,\\mathrm{pA}$。\n\n从基尔霍夫电流定律和欧姆定律出发，确定在 $t=0$ 时，基于电导的兴奋性突触和抑制性突触的瞬时突触电流，并将其与使用相同 $s(t)$ 的基于电流的突触所产生的瞬时电流进行对比。按以下顺序报告这四种电流：基于电导的兴奋性电流、基于电导的抑制性电流、基于电流的兴奋性电流、基于电流的抑制性电流。\n\n以皮安（pA）为单位表示最终电流，并将答案四舍五入到三位有效数字。以单行矩阵的形式提供最终答案。",
            "solution": "问题要求计算在时间 $t=0$ 时，两种不同类型突触模型（基于电导的模型和基于电流的模型）的瞬时突触电流。该分析基于基尔霍夫电流定律和欧姆定律在单室神经元模型中的应用。\n\n在**基于电导的模型**中，突触电流 $I_{\\text{syn}}$ 由欧姆定律的应用来描述。该电流是突触电导 $g_{\\text{syn}}(t)$ 与电化学驱动力 $(V(t) - E_{\\text{syn}})$ 的乘积，其中 $V(t)$ 是膜电位，$E_{\\text{syn}}$ 是突触反转电位。通用方程为：\n$$I_{\\text{syn}}(t) = g_{\\text{syn}}(t) (V(t) - E_{\\text{syn}})$$\n突触电导本身是时间依赖的，由峰值电导 $\\bar{g}_{\\text{syn}}$ 与一个描述突触激活时间进程的无量纲门控变量 $s(t)$ 的乘积给出。因此，$g_{\\text{syn}}(t) = \\bar{g}_{\\text{syn}} s(t)$。\n\n相比之下，**基于电流的模型**提供了一种现象学的简化。在此模型中，突触电流被建模为一个理想电流源，其大小与门控变量 $s(t)$ 成正比，并由一个具有电流单位的突触权重 $w_{\\text{syn}}$ 进行缩放。该模型忽略了电流对突触后膜电位 $V(t)$ 的依赖性：\n$$I_{\\text{syn}}(t) = w_{\\text{syn}} s(t)$$\n\n问题指定了突触激活时刻 $t=0$ 的条件。神经元处于静息状态，膜电位等于泄漏反转电位：$V(0) = E_{L} = -65\\,\\mathrm{mV}$。突触门控变量为 $s(t) = \\exp(-t/\\tau_{s})$，在 $t=0$ 时其值为 $s(0) = \\exp(0) = 1$。使用标准的生物物理学符号约定，其中正电荷的内流（去极化电流）为负，正电荷的外流（超极化电流）为正。\n\n我们现在来计算所要求的四种电流。\n\n**1. $t=0$ 时基于电导的模型的电流**\n\n**a) 兴奋性突触电流 ($I_{\\text{cond,exc}}$)**\n兴奋性突触的给定参数为峰值电导 $g_{\\mathrm{exc}} = 1.2\\,\\mathrm{nS}$ 和反转电位 $E_{\\mathrm{exc}} = 0\\,\\mathrm{mV}$。\n在 $t=0$ 时的瞬时兴奋性电导为：\n$$g_{\\text{exc}}(0) = g_{\\mathrm{exc}} \\cdot s(0) = (1.2\\,\\mathrm{nS}) \\cdot 1 = 1.2\\,\\mathrm{nS}$$\n突触通道上的驱动力是膜电位与突触反转电位之差：\n$$V(0) - E_{\\mathrm{exc}} = -65\\,\\mathrm{mV} - 0\\,\\mathrm{mV} = -65\\,\\mathrm{mV}$$\n瞬时兴奋性突触电流是电导和驱动力的乘积：\n$$I_{\\text{cond,exc}}(0) = g_{\\text{exc}}(0) (V(0) - E_{\\mathrm{exc}}) = (1.2 \\times 10^{-9}\\,\\mathrm{S}) \\cdot (-65 \\times 10^{-3}\\,\\mathrm{V})$$\n$$I_{\\text{cond,exc}}(0) = -78 \\times 10^{-12}\\,\\mathrm{A} = -78\\,\\mathrm{pA}$$\n负号表示内向电流，这与兴奋性突触后电位一致。\n\n**b) 抑制性突触电流 ($I_{\\text{cond,inh}}$)**\n抑制性突触的参数为峰值电导 $g_{\\mathrm{inh}} = 1.2\\,\\mathrm{nS}$ 和反转电位 $E_{\\mathrm{inh}} = -75\\,\\mathrm{mV}$。\n在 $t=0$ 时的瞬时抑制性电导为：\n$$g_{\\text{inh}}(0) = g_{\\mathrm{inh}} \\cdot s(0) = (1.2\\,\\mathrm{nS}) \\cdot 1 = 1.2\\,\\mathrm{nS}$$\n抑制性突触的驱动力为：\n$$V(0) - E_{\\mathrm{inh}} = -65\\,\\mathrm{mV} - (-75\\,\\mathrm{mV}) = 10\\,\\mathrm{mV}$$\n瞬时抑制性突触电流为：\n$$I_{\\text{cond,inh}}(0) = g_{\\text{inh}}(0) (V(0) - E_{\\mathrm{inh}}) = (1.2 \\times 10^{-9}\\,\\mathrm{S}) \\cdot (10 \\times 10^{-3}\\,\\mathrm{V})$$\n$$I_{\\text{cond,inh}}(0) = +12 \\times 10^{-12}\\,\\mathrm{A} = +12\\,\\mathrm{pA}$$\n正号表示外向电流，这是超极化的，因为反转电位 $E_{\\text{inh}}$ 比静息电位 $E_{L}$ 更负。\n\n**2. $t=0$ 时基于电流的模型的电流**\n\n**a) 兴奋性突触电流 ($I_{\\text{curr,exc}}$)**\n兴奋性突触权重为 $w_{\\mathrm{exc}} = -25\\,\\mathrm{pA}$。当 $s(0)=1$ 时，电流直接由下式给出：\n$$I_{\\text{curr,exc}}(0) = w_{\\text{exc}} \\cdot s(0) = (-25\\,\\mathrm{pA}) \\cdot 1 = -25\\,\\mathrm{pA}$$\n\n**b) 抑制性突触电流 ($I_{\\text{curr,inh}}$)**\n抑制性突触权重为 $w_{\\mathrm{inh}} = +25\\,\\mathrm{pA}$。当 $s(0)=1$ 时，电流为：\n$$I_{\\text{curr,inh}}(0) = w_{\\mathrm{inh}} \\cdot s(0) = (+25\\,\\mathrm{pA}) \\cdot 1 = +25\\,\\mathrm{pA}$$\n\n**3. 最终答案汇总**\n问题要求按指定顺序报告这四种电流，单位为皮安（pA），并四舍五入到三位有效数字：\n- 基于电导的兴奋性电流：$-78.0\\,\\mathrm{pA}$\n- 基于电导的抑制性电流：$12.0\\,\\mathrm{pA}$\n- 基于电流的兴奋性电流：$-25.0\\,\\mathrm{pA}$\n- 基于电流的抑制性电流：$25.0\\,\\mathrm{pA}$\n\n这些值被排列在一个行矩阵中作为最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-78.0  12.0  -25.0  25.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在理解了瞬时电流的差异后，我们接下来探讨这种差异如何影响突触后电位（PSP）的动态行为。这个练习将引导你通过分析来揭示一个关键的生物物理现象：基于电导的突触所引起的PSP幅度会随着神经元初始膜电位的变化而缩放。通过推导并比较两种模型下PSP幅度对钳制电压的依赖关系 ()，你将深入理解基于电导模型如何捕捉到这种重要的电压依赖性，而这正是基于电流的模型无法体现的。",
            "id": "4025188",
            "problem": "考虑一个单室神经元模型，该模型被建模为一个阻容元件，具有膜电容 $C$、漏电导 $g_L$ 和漏泄反转电位 $E_L$。一个恒定的维持电流 $I_{\\text{hold}}$ 被用来将稳态膜电位钳制在 $V_{h1} = -80\\,\\mathrm{mV}$ 或 $V_{h2} = -60\\,\\mathrm{mV}$，使得在没有突触输入的情况下，稳态满足 $0 = -g_L (V_h - E_L) + I_{\\text{hold}}$。在 $t=0$ 时，通过以下两种方案之一，施加一个短暂的兴奋性突触后事件：\n\n1.  一次类 α-氨基-3-羟基-5-甲基-4-异恶唑丙酸 (AMPA) 的电导注入，其反转电位为 $E_s = 0\\,\\mathrm{mV}$，时间进程为 $g_s(t) = g_{\\text{peak}} \\exp(-t/\\tau_s)$（当 $t \\ge 0$ 时），且当 $t < 0$ 时 $g_s(t) = 0$。\n2.  一次基于电流的注入，其时间进程为 $I_s(t) = I_{\\text{peak}} \\exp(-t/\\tau_s)$（当 $t \\ge 0$ 时），且当 $t < 0$ 时 $I_s(t) = 0$。\n\n假设 $g_{\\text{peak}} \\ll g_L$ 且 $|I_{\\text{peak}}|$ 足够小，使得突触后电位保持在维持电位附近的线性区域内，因此线性化是有效的。在基于电导的突触输入下，膜方程为 $C \\frac{dV}{dt} = -g_L (V - E_L) - g_s(t) (V - E_s) + I_{\\text{hold}}$，而在基于电流的输入下，膜方程为 $C \\frac{dV}{dt} = -g_L (V - E_L) + I_{\\text{hold}} + I_s(t)$。\n\n将突触后电位 (PSP) 定义为与钳制基线电位的偏差 $\\delta V(t) = V(t) - V_h$，并将其峰值幅度表示为 $\\delta V_{\\text{peak}}(V_h)$（对于给定的维持电位 $V_h$）。仅使用给定的模型方程和线性化假设，从第一性原理推导每种输入方案下 $\\delta V_{\\text{peak}}(V_h)$ 如何依赖于 $V_h$。然后，计算每种情况下，当维持电位从 $V_{h2}$ 变为 $V_{h1}$ 时峰值幅度的比率：\n$$\nr_{\\text{cond}} = \\frac{\\delta V_{\\text{peak}}^{\\text{(cond)}}(V_{h1})}{\\delta V_{\\text{peak}}^{\\text{(cond)}}(V_{h2})}, \n\\qquad\nr_{\\text{curr}} = \\frac{\\delta V_{\\text{peak}}^{\\text{(curr)}}(V_{h1})}{\\delta V_{\\text{peak}}^{\\text{(curr)}}(V_{h2})}.\n$$\n将你的最终答案表示为一个单行矩阵 $\\begin{pmatrix} r_{\\text{cond}}  r_{\\text{curr}} \\end{pmatrix}$，形式为精确值。无需四舍五入。由于所求量为比率，最终答案中不应包含物理单位。",
            "solution": "该问题要求我们分析一个单室神经元模型在两种不同突触输入方案下，从一个钳制电位 $V_h$ 开始的响应。我们将突触后电位（PSP）定义为膜电位与该钳制电位的偏差，即 $\\delta V(t) = V(t) - V_h$。根据定义，系统在 $t < 0$ 时处于稳态，因此初始条件为 $\\delta V(0) = 0$。绝对电位 $V$ 的时间导数与 PSP $\\delta V$ 的关系是 $\\frac{dV}{dt} = \\frac{d}{dt}(V_h + \\delta V) = \\frac{d(\\delta V)}{dt}$，因为 $V_h$ 是一个常数。维持电流 $I_{\\text{hold}}$ 被设定为维持稳态，满足 $I_{\\text{hold}} = g_L (V_h - E_L)$。\n\n**1. 基于电流的突触分析（方案 2）**\n\n对于基于电流的输入，膜方程为：\n$$C \\frac{dV}{dt} = -g_L (V - E_L) + I_{\\text{hold}} + I_s(t)$$\n代入 $V(t) = V_h + \\delta V(t)$ 和 $I_{\\text{hold}} = g_L (V_h - E_L)$：\n$$C \\frac{d(\\delta V)}{dt} = -g_L (V_h + \\delta V(t) - E_L) + g_L (V_h - E_L) + I_s(t)$$\n展开并简化各项：\n$$C \\frac{d(\\delta V)}{dt} = -g_L(V_h - E_L) - g_L \\delta V(t) + g_L(V_h - E_L) + I_s(t)$$\n$$C \\frac{d(\\delta V)}{dt} = -g_L \\delta V(t) + I_s(t)$$\n这是一个关于 PSP $\\delta V(t)$ 的一阶线性常微分方程。一个重要的观察是，控制 $\\delta V(t)$ 的方程取决于参数 $C$、$g_L$ 和输入电流 $I_s(t) = I_{\\text{peak}} \\exp(-t/\\tau_s)$，这些参数都不依赖于钳制电位 $V_h$。由于微分方程和初始条件 $\\delta V(0)=0$ 都与 $V_h$ 无关，因此整个解 $\\delta V(t)$ 也必须与 $V_h$ 无关。\n因此，PSP 的峰值幅度 $\\delta V_{\\text{peak}}^{\\text{(curr)}}$ 与维持电位无关。\n$$\\delta V_{\\text{peak}}^{\\text{(curr)}}(V_{h1}) = \\delta V_{\\text{peak}}^{\\text{(curr)}}(V_{h2})$$\n所以，比率 $r_{\\text{curr}}$ 为：\n$$r_{\\text{curr}} = \\frac{\\delta V_{\\text{peak}}^{\\text{(curr)}}(V_{h1})}{\\delta V_{\\text{peak}}^{\\text{(curr)}}(V_{h2})} = 1$$\n\n**2. 基于电导的突触分析（方案 1）**\n\n对于基于电导的输入，膜方程为：\n$$C \\frac{dV}{dt} = -g_L (V - E_L) - g_s(t) (V - E_s) + I_{\\text{hold}}$$\n再次代入 $V(t) = V_h + \\delta V(t)$ 和 $I_{\\text{hold}} = g_L (V_h - E_L)$：\n$$C \\frac{d(\\delta V)}{dt} = -g_L (V_h + \\delta V(t) - E_L) - g_s(t) (V_h + \\delta V(t) - E_s) + g_L (V_h - E_L)$$\n像之前一样简化与漏电相关的项：\n$$C \\frac{d(\\delta V)}{dt} = -g_L \\delta V(t) - g_s(t) (V_h + \\delta V(t) - E_s)$$\n$$C \\frac{d(\\delta V)}{dt} = -g_L \\delta V(t) - g_s(t) (V_h - E_s) - g_s(t) \\delta V(t)$$\n整理各项得到：\n$$C \\frac{d(\\delta V)}{dt} + (g_L + g_s(t)) \\delta V(t) = -g_s(t) (V_h - E_s)$$\n问题陈述我们可以使用线性化，这是由假设 $g_{\\text{peak}} \\ll g_L$ 所保证的。这意味着对于所有 $t$ 都有 $g_s(t) \\ll g_L$。$g_s(t) \\delta V(t)$ 项是两个小量的乘积，因此是可以忽略的二阶项。这可将方程简化为：\n$$C \\frac{d(\\delta V)}{dt} + g_L \\delta V(t) \\approx -g_s(t) (V_h - E_s)$$\n我们可以定义一个有效突触电流 $I_{\\text{eff}}(t) = -g_s(t) (V_h - E_s)$。该项表示流经突触通道的电流，它是通过使用恒定的钳制电位 $V_h$ 而不是时变的电位 $V(t)$ 来近似得到的。$(V_h - E_s)$ 项是突触驱动力。线性化方程变为：\n$$C \\frac{d(\\delta V)}{dt} \\approx -g_L \\delta V(t) + I_{\\text{eff}}(t)$$\n这个方程的形式与基于电流的情况相同，只是输入电流 $I_s(t)$ 被替换为 $I_{\\text{eff}}(t)$。$\\delta V(t)$ 的解将与这个有效电流的幅度成线性比例。因为 $g_s(t) = g_{\\text{peak}} \\exp(-t/\\tau_s)$，所以有效电流为：\n$$I_{\\text{eff}}(t) = -g_{\\text{peak}} (V_h - E_s) \\exp(-t/\\tau_s) = g_{\\text{peak}} (E_s - V_h) \\exp(-t/\\tau_s)$$\nPSP 的整个时间进程 $\\delta V(t)$ 与此有效电流的幅度成正比，而该幅度又与驱动力 $(E_s - V_h)$ 成正比。\n$$\\delta V(t; V_h) \\propto (E_s - V_h)$$\n因此，PSP 的峰值幅度也与驱动力成正比：\n$$\\delta V_{\\text{peak}}^{\\text{(cond)}}(V_h) \\propto (E_s - V_h)$$\n现在我们可以通过计算两个钳制电位 $V_{h1}$ 和 $V_{h2}$ 下峰值幅度的比率来计算 $r_{\\text{cond}}$：\n$$r_{\\text{cond}} = \\frac{\\delta V_{\\text{peak}}^{\\text{(cond)}}(V_{h1})}{\\delta V_{\\text{peak}}^{\\text{(cond)}}(V_{h2})} = \\frac{k \\cdot (E_s - V_{h1})}{k \\cdot (E_s - V_{h2})} = \\frac{E_s - V_{h1}}{E_s - V_{h2}}$$\n其中 $k$ 是比例常数。\n代入给定值 $E_s = 0\\,\\mathrm{mV}$、$V_{h1} = -80\\,\\mathrm{mV}$ 和 $V_{h2} = -60\\,\\mathrm{mV}$：\n$$r_{\\text{cond}} = \\frac{0 - (-80)}{0 - (-60)} = \\frac{80}{60} = \\frac{4}{3}$$\n\n**3. 最终答案组合**\n\n我们已经求得两个比率：\n$$r_{\\text{cond}} = \\frac{4}{3}$$\n$$r_{\\text{curr}} = 1$$\n问题要求答案以单行矩阵 $\\begin{pmatrix} r_{\\text{cond}}  r_{\\text{curr}} \\end{pmatrix}$ 形式表示。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{3}  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论分析之后，我们最终转向计算实践，这将让你直面两种模型在模拟实现中的差异。这项编程练习要求你为两种突触模型构建精确的、基于事件的更新算法 ()。通过亲手实现，你将体会到它们在计算上的权衡：基于电流的模型允许一个简洁的、有解析解的更新，而更真实的基于电导的模型则需要更复杂的数值积分，这使得模型选择成为大规模网络模拟中的一个重要现实考量。",
            "id": "4025193",
            "problem": "考虑一个根据基尔霍夫电流定律建模为电路的单室神经元。设膜电压为 $V(t)$，膜电容为 $C$，漏电导为 $g_L$，漏泄反转电位为 $E_L$。电容电流为 $I_C(t) = C \\, dV/dt$，漏电流为 $I_L(t) = g_L \\, (V(t) - E_L)$，外部注入电流为 $I_{\\mathrm{ext}}$。我们研究两种突触建模方案：\n\n1. 基于电流的突触：突触电流为 $I_{\\mathrm{syn}}(t) = q \\, s(t)$，其中 $q$ 是一个单位为安培的恒定振幅，$s(t)$ 是一个无量纲的突触状态，服从指数衰减动态，并在脉冲到达时间 $t_k$ 发生脉冲式增量，即\n$$\n\\frac{ds}{dt} = -\\frac{s}{\\tau_s} + \\sum_k a_k \\, \\delta(t - t_k),\n$$\n其中 $\\tau_s$ 是突触衰减时间常数，$a_k$ 是在脉冲时间 $t_k$ 时 $s$ 的无量纲跳跃大小，$\\delta(\\cdot)$ 是狄拉克δ分布。\n\n2. 基于电导的突触：突触电流为 $I_{\\mathrm{syn}}(t) = g(t) \\, (V(t) - E_{\\mathrm{syn}})$，其中 $E_{\\mathrm{syn}}$ 是突触反转电位，$g(t)$ 是突触电导，服从\n$$\n\\frac{dg}{dt} = -\\frac{g}{\\tau_s} + \\sum_k w_k \\, \\delta(t - t_k),\n$$\n其中 $\\tau_s$ 与上述时间常数相同，$w_k$ 是在脉冲时间 $t_k$ 时的突触电导跳跃。\n\n在脉冲之间，膜电压服从以下一阶常微分方程 (ODE)：\n$$\nC \\frac{dV}{dt} = - g_L \\, (V(t) - E_L) + I_{\\mathrm{ext}} + I_{\\mathrm{syn}}(t).\n$$\n对于基于电流的突触，$I_{\\mathrm{syn}}(t) = q \\, s(t)$；对于基于电导的突触，$I_{\\mathrm{syn}}(t) = g(t) \\, (V(t) - E_{\\mathrm{syn}})$。\n\n任务：严格从这些定义出发，并使用线性常微分方程的标准求解技术（包括积分因子和卷积），推导对于两种突触模型，将状态从时间 $t_0$ 映射到时间 $t_1$（其中 $t_1 > t_0$）的精确的基于事件的更新映射。该更新必须考虑：\n- 从 $t_0$ 时的初始条件开始，$s(t)$ 或 $g(t)$ 的指数衰减。\n- 在开区间 $(t_0, t_1]$ 内发生的任何脉冲 $\\{t_k\\}$，以及相应的跳跃大小 $\\{a_k\\}$（基于电流的状态跳跃）和 $\\{w_k\\}$（基于电导的电导跳跃）。\n- 在每种突触模型下，从 $V(t_0) = V_0$ 开始的 $V(t)$ 的解，对于基于电流的模型，初始条件为 $s(t_0) = s_0$，对于基于电导的模型，初始条件为 $g(t_0) = g_0$。\n\n然后，您必须将这些精确的基于事件的更新实现为一个单一程序，该程序为每个测试用例计算在基于电流和基于电导的突触模型下，$t_1$ 时刻的膜电压 $V(t_1)$。对于基于电流的情况，解必须以闭式形式实现。对于基于电导的情况，您必须实现表示为定积分的精确积分因子解；需要以完全双精度准确度对任何所需的时间积分进行数值计算。所有物理量必须使用国际单位制（SI）：时间单位为秒 (s)，电容单位为法拉 (F)，电导单位为西门子 (S)，电流单位为安培 (A)，电压单位为伏特 (V)，反转电位单位为伏特 (V)。最终电压以伏特 (V) 为单位，表示为浮点数。\n\n重要特殊情况：当漏泄衰减率 $g_L/C$ 等于突触衰减率 $1/\\tau_s$ 时，您为基于电流的情况提供的闭式更新必须使用适当的极限，以避免除以零并保持精确。\n\n测试套件：\n使用以下参数集。对于所有情况，取 $C = 200 \\times 10^{-12}$ F，$g_L = 10 \\times 10^{-9}$ S，$E_L = -0.070$ V，$E_{\\mathrm{syn}} = 0.0$ V，除非另有说明，$I_{\\mathrm{ext}} = 0.0$ A。对于基于电流的突触，使用 $q = 0.5 \\times 10^{-9}$ A。对于基于电导的突触，每个案例提供脉冲权重 $w_k$。\n\n- 情况1（无突触输入，漏泄弛豫）：$t_0 = 0.0$ s，$t_1 = 0.010$ s，$V_0 = -0.065$ V，$s_0 = 0.0$，$g_0 = 0.0$，$\\tau_s = 0.005$ s，无脉冲。\n\n- 情况2（单个脉冲，两种模型）：$t_0 = 0.0$ s，$t_1 = 0.010$ s，$V_0 = -0.070$ V，$s_0 = 0.0$，$g_0 = 0.0$，$\\tau_s = 0.005$ s，在 $t = 0.002$ s 处有一次脉冲，基于电流的跳跃 $a_1 = 1.0$，基于电导的权重 $w_1 = 5 \\times 10^{-9}$ S。\n\n- 情况3（两次脉冲，不同突触时间常数）：$t_0 = 0.0$ s，$t_1 = 0.015$ s，$V_0 = -0.068$ V，$s_0 = 0.0$，$g_0 = 0.0$，$\\tau_s = 0.010$ s，在 $t = 0.001$ s 和 $t = 0.006$ s 处有两次脉冲，基于电流的跳跃 $a_1 = 1.0$，$a_2 = 1.0$，基于电导的权重 $w_1 = 3 \\times 10^{-9}$ S，$w_2 = 7 \\times 10^{-9}$ S。\n\n- 情况4（边缘情况 $g_L/C = 1/\\tau_s$，非零初始突触状态）：$t_0 = 0.0$ s，$t_1 = 0.010$ s，$V_0 = -0.060$ V，$s_0 = 0.5$，$g_0 = 2 \\times 10^{-9}$ S，$\\tau_s = 0.020$ s，在 $t = 0.005$ s 处有一次脉冲，其中 $a_1 = 0.8$，$w_1 = 5 \\times 10^{-9}$ S。\n\n- 情况5（零区间边界）：$t_0 = 0.0$ s，$t_1 = 0.0$ s，$V_0 = -0.065$ V，$s_0 = 1.0$，$g_0 = 1 \\times 10^{-9}$ S，$\\tau_s = 0.010$ s，无脉冲。\n\n要求的程序输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个双元素列表 $[V_{\\mathrm{cb}}, V_{\\mathrm{gb}}]$，分别包含基于电流和基于电导的突触模型在 $t_1$ 时的膜电压，单位均为伏特 (V)。例如，输出应如下所示：\n$$\n[[V_{\\mathrm{cb,1}},V_{\\mathrm{gb,1}}],[V_{\\mathrm{cb,2}},V_{\\mathrm{gb,2}}],\\dots].\n$$",
            "solution": "该问题要求推导并实现一个精确的基于事件的更新规则，用于计算单室神经元模型在两种不同突触假设（基于电流和基于电导）下膜电压 $V(t)$ 的值。神经元的动力学由一个基于基尔霍夫电流定律的一阶常微分方程 (ODE) 控制。\n\n首先，让我们定义共用的参数和常数。膜时间常数为 $\\tau_m = C/g_L$，在没有突触输入的情况下，稳态膜电位为 $V_\\infty = E_L + I_{\\mathrm{ext}}/g_L$。膜电压 $V(t)$ 的控制方程为\n$$\nC \\frac{dV}{dt} = - g_L \\, (V(t) - E_L) + I_{\\mathrm{ext}} + I_{\\mathrm{syn}}(t)\n$$\n通过除以 $g_L$，可以将其重写为标准形式：\n$$\n\\tau_m \\frac{dV}{dt} = - (V(t) - V_\\infty) + \\frac{I_{\\mathrm{syn}}(t)}{g_L}\n$$\n\n突触状态变量，即基于电流模型中的 $s(t)$ 和基于电导模型中的 $g(t)$，都遵循一个一阶衰减过程，并在脉冲时间 $\\{t_k\\}$ 处有脉冲式增量。这种动力学的一般形式是\n$$\n\\frac{dy}{dt} = -\\frac{y}{\\tau_s} + \\sum_k J_k \\, \\delta(t - t_k)\n$$\n其中 $J_k$ 表示在脉冲时间 $t_k$ 的跳跃大小（$a_k$ 或 $w_k$）。对于初始条件 $y(t_0) = y_0$ 和一组在时间 $t_k \\in (t_0, t_1]$ 发生的脉冲，此方程的解可以通过叠加初始条件和每个脉冲的影响来找到，所有这些都随时间指数衰减。在时间 $t_1$ 的值为：\n$$\ny(t_1) = y_0 e^{-(t_1-t_0)/\\tau_s} + \\sum_{k | t_0  t_k \\le t_1} J_k e^{-(t_1-t_k)/\\tau_s}\n$$\n通过代入适当的初始条件（$s_0$ 或 $g_0$）和跳跃大小（$a_k$ 或 $w_k$），这个通用解适用于 $s(t_1)$ 和 $g(t_1)$。\n\n### 基于电流的突触模型\n\n对于基于电流的突触，$I_{\\mathrm{syn}}(t) = q \\, s(t)$。电压动力学方程为：\n$$\n\\frac{dV}{dt} + \\frac{1}{\\tau_m}V(t) = \\frac{V_\\infty}{\\tau_m} + \\frac{q}{C}s(t)\n$$\n这是一个系数恒定的一阶线性非齐次常微分方程。我们可以使用积分因子 $\\mu(t) = e^{t/\\tau_m}$ 来求解。通用解可以用卷积积分表示：\n$$\nV(t_1) = V(t_0) e^{-(t_1-t_0)/\\tau_m} + \\int_{t_0}^{t_1} e^{-(t_1-u)/\\tau_m} \\left( \\frac{V_\\infty}{\\tau_m} + \\frac{q}{C}s(u) \\right) du\n$$\n计算常数项的积分，得到向稳态弛豫的熟悉形式：\n$$\nV(t_1) = V_\\infty + (V_0 - V_\\infty) e^{-(t_1-t_0)/\\tau_m} + \\frac{q}{C} \\int_{t_0}^{t_1} s(u) e^{-(t_1-u)/\\tau_m} du\n$$\n剩下的积分涉及突触变量 $s(u)$，它是衰减指数的总和：\n$s(u) = s_0 e^{-(u-t_0)/\\tau_s} + \\sum_{k | t_0  t_k \\le u} a_k e^{-(u-t_k)/\\tau_s}$。\n最好通过分别考虑每个指数项来求解该积分。对于在 $t_{event}$ 时刻启动的单个指数项 $e^{-(u-t_{event})/\\tau_s}$，积分为：\n$$\n\\int_{t_{event}}^{t_1} e^{-(u-t_{event})/\\tau_s} e^{-(t_1-u)/\\tau_m} du = e^{t_{event}/\\tau_s - t_1/\\tau_m} \\int_{t_{event}}^{t_1} e^{u(1/\\tau_m - 1/\\tau_s)} du\n$$\n\n**情况1：非共振情况 ($\\tau_m \\neq \\tau_s$)**\n令 $\\alpha = 1/\\tau_m - 1/\\tau_s$。积分计算为：\n$e^{t_{event}/\\tau_s - t_1/\\tau_m} \\frac{1}{\\alpha} [e^{\\alpha u}]_{t_{event}}^{t_1} = \\frac{1}{\\alpha} (e^{-(t_1-t_{event})/\\tau_s} - e^{-(t_1-t_{event})/\\tau_m})$。\n将此结果应用于 $s(t)$ 的每个分量（初始状态 $s_0$ 和每个脉冲 $a_k$），对 $V(t_1)$ 的总突触贡献为：\n$$\n\\Delta V_{\\mathrm{syn}}(t_1) = \\frac{q}{C\\alpha} \\left[ s_0(e^{-\\frac{t_1-t_0}{\\tau_s}} - e^{-\\frac{t_1-t_0}{\\tau_m}}) + \\sum_k a_k(e^{-\\frac{t_1-t_k}{\\tau_s}} - e^{-\\frac{t_1-t_k}{\\tau_m}}) \\right]\n$$\n其中 $\\alpha = 1/\\tau_m - 1/\\tau_s = (\\tau_s-\\tau_m)/(\\tau_m \\tau_s)$。完整解为：\n$$\nV(t_1) = V_\\infty + (V_0 - V_\\infty)e^{-\\frac{t_1-t_0}{\\tau_m}} + \\frac{q \\tau_m \\tau_s}{C(\\tau_s - \\tau_m)} \\left[ \\left( s_0 e^{-\\frac{t_1-t_0}{\\tau_s}} + \\sum_k a_k e^{-\\frac{t_1-t_k}{\\tau_s}} \\right) - \\left( s_0 e^{-\\frac{t_1-t_0}{\\tau_m}} + \\sum_k a_k e^{-\\frac{t_1-t_k}{\\tau_m}} \\right) \\right]\n$$\n\n**情况2：共振情况 ($\\tau_m = \\tau_s = \\tau$)**\n在这种特殊情况下，$\\alpha = 0$。积分 $\\int_{t_{event}}^{t_1} e^{u \\cdot 0} du = t_1 - t_{event}$。来自一个指数项的贡献是：\n$e^{t_{event}/\\tau - t_1/\\tau} (t_1 - t_{event}) = (t_1-t_{event})e^{-(t_1-t_{event})/\\tau}$。\n对 $s(t)$ 的所有分量求和，突触贡献为：\n$$\n\\Delta V_{\\mathrm{syn}}(t_1) = \\frac{q}{C} \\left[ s_0 (t_1-t_0) e^{-\\frac{t_1-t_0}{\\tau}} + \\sum_k a_k (t_1-t_k) e^{-\\frac{t_1-t_k}{\\tau}} \\right]\n$$\n完整解为：\n$$\nV(t_1) = V_\\infty + (V_0 - V_\\infty)e^{-\\frac{t_1-t_0}{\\tau}} + \\Delta V_{\\mathrm{syn}}(t_1)\n$$\n此公式是当 $\\tau_s \\to \\tau_m$ 时非共振情况的极限，符合要求。\n\n### 基于电导的突触模型\n\n对于基于电导的突触，$I_{\\mathrm{syn}}(t) = g(t)(V(t) - E_{\\mathrm{syn}})$。控制ODE变为：\n$$\nC \\frac{dV}{dt} = -g_L(V-E_L) + I_{\\mathrm{ext}} - g(t)(V-E_{\\mathrm{syn}})\n$$\n整理各项，我们得到一个线性ODE，其中 $V(t)$ 的系数是时变的：\n$$\n\\frac{dV}{dt} + \\frac{g_L+g(t)}{C}V(t) = \\frac{g_L E_L + g(t)E_{\\mathrm{syn}} + I_{\\mathrm{ext}}}{C}\n$$\n此方程具有形式 $V' + P(t)V = Q(t)$，其中 $P(t) = \\frac{g_L+g(t)}{C}$，$Q(t) = \\frac{g_L E_L + g(t)E_{\\mathrm{syn}} + I_{\\mathrm{ext}}}{C}$。\n解需要一个积分因子 $\\mu(t) = e^{\\int_{t_0}^t P(u)du}$。从 $t_0$ 到 $t_1$ 的精确解是：\n$$\nV(t_1) = \\frac{1}{\\mu(t_1)} \\left( \\mu(t_0)V(t_0) + \\int_{t_0}^{t_1} \\mu(u) Q(u) du \\right)\n$$\n由于 $\\mu(t_0) = e^{\\int_{t_0}^{t_0} \\dots} = e^0 = 1$，我们有：\n$$\nV(t_1) = e^{-\\int_{t_0}^{t_1} P(u)du} \\left( V_0 + \\int_{t_0}^{t_1} e^{\\int_{t_0}^u P(x)dx} Q(u) du \\right)\n$$\n让我们定义指数项 $\\phi(t) = \\int_{t_0}^{t} P(x)dx$。\n$$\n\\phi(t) = \\int_{t_0}^{t} \\frac{g_L+g(x)}{C} dx = \\frac{g_L(t-t_0)}{C} + \\frac{1}{C}\\int_{t_0}^t g(x) dx\n$$\n$g(x)$ 的积分可以解析计算：\n$$\n\\int_{t_0}^t g(x)dx = g_0 \\tau_s (1-e^{-(t-t_0)/\\tau_s}) + \\sum_{k|t_k \\le t} w_k \\tau_s (1-e^{-(t-t_k)/\\tau_s})\n$$\n定义了 $\\phi(t)$ 后，$V(t_1)$ 的解为：\n$$\nV(t_1) = e^{-\\phi(t_1)} \\left( V_0 + \\int_{t_0}^{t_1} e^{\\phi(u)} Q(u) du \\right)\n$$\n按照要求，解析推导到此为止。涉及 $e^{\\phi(u)}Q(u)$ 的外层积分没有简单的闭式解，必须进行数值计算。实现将使用标准的数值求积方法来高精度地计算这个定积分。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve for the membrane potential V(t1) for all test cases.\n    \"\"\"\n    \n    # Common parameters for all test cases\n    C = 200e-12  # Farad\n    g_L = 10e-9   # Siemens\n    E_L = -0.070  # Volt\n    E_syn = 0.0   # Volt\n    I_ext = 0.0   # Ampere\n    q = 0.5e-9    # Ampere for current-based synapse\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1 (no synaptic input, leak relaxation)\n        {'t0': 0.0, 't1': 0.010, 'V0': -0.065, 's0': 0.0, 'g0': 0.0, 'tau_s': 0.005, 'spikes': []},\n        # Case 2 (single spike, both models)\n        {'t0': 0.0, 't1': 0.010, 'V0': -0.070, 's0': 0.0, 'g0': 0.0, 'tau_s': 0.005, \n         'spikes': [{'t': 0.002, 'a': 1.0, 'w': 5e-9}]},\n        # Case 3 (two spikes, different synaptic time constant)\n        {'t0': 0.0, 't1': 0.015, 'V0': -0.068, 's0': 0.0, 'g0': 0.0, 'tau_s': 0.010, \n         'spikes': [{'t': 0.001, 'a': 1.0, 'w': 3e-9},\n                    {'t': 0.006, 'a': 1.0, 'w': 7e-9}]},\n        # Case 4 (edge case g_L/C = 1/tau_s with nonzero initial synaptic states)\n        {'t0': 0.0, 't1': 0.010, 'V0': -0.060, 's0': 0.5, 'g0': 2e-9, 'tau_s': 0.020, \n         'spikes': [{'t': 0.005, 'a': 0.8, 'w': 5e-9}]},\n        # Case 5 (zero-interval boundary)\n        {'t0': 0.0, 't1': 0.0, 'V0': -0.065, 's0': 1.0, 'g0': 1e-9, 'tau_s': 0.010, 'spikes': []},\n    ]\n\n    results = []\n    for case in test_cases:\n        V_cb = solve_current_based(C, g_L, E_L, I_ext, q, **case)\n        V_gb = solve_conductance_based(C, g_L, E_L, E_syn, I_ext, **case)\n        results.append([V_cb, V_gb])\n    \n    # Format a list of lists into the required string representation\n    output_str = '[' + ','.join(f'[{v1},{v2}]' for v1, v2 in results) + ']'\n    # The problem asks for the output format to be [[...],[...],...]\n    # My f-string above creates this. The original code's map(str, results) would be [[...], [...]]. Let's fix that.\n    output_str = '[' + ','.join(map(str, results)) + ']'\n    # Re-evaluating. The user provided an example `[[V_cb,1,V_gb,1],[V_cb,2,V_gb,2],...]` with `\\,`.\n    # And my corrected python code produces `[[-0.0669674849330312, -0.0669674849330312], ...]`.\n    # Let's trust the python code's output format is what's expected.\n    \n    # A cleaner output string generation that matches the example format better\n    formatted_results = []\n    for res_pair in results:\n        formatted_results.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    output_str = f\"[{','.join(formatted_results)}]\"\n\n\ndef solve_current_based(C, g_L, E_L, I_ext, q, t0, t1, V0, s0, tau_s, spikes, **kwargs):\n    \"\"\"\n    Calculates V(t1) for the current-based synapse model using the exact closed-form solution.\n    \"\"\"\n    if t1 == t0:\n        return V0\n\n    tau_m = C / g_L\n    V_inf = E_L + I_ext / g_L\n    dt = t1 - t0\n\n    # Leakage component of the solution\n    V_leak = V_inf + (V0 - V_inf) * np.exp(-dt / tau_m)\n\n    # Synaptic component\n    delta_V_syn = 0.0\n\n    # Non-resonant case: tau_m != tau_s\n    if not np.isclose(tau_m, tau_s):\n        s_eff_s = s0 * np.exp(-dt / tau_s) + sum(sp['a'] * np.exp(-(t1 - sp['t']) / tau_s) for sp in spikes)\n        s_eff_m = s0 * np.exp(-dt / tau_m) + sum(sp['a'] * np.exp(-(t1 - sp['t']) / tau_m) for sp in spikes)\n        \n        prefactor = (q * tau_m * tau_s) / (C * (tau_s - tau_m))\n        delta_V_syn = prefactor * (s_eff_s - s_eff_m)\n    \n    # Resonant case: tau_m == tau_s\n    else:\n        tau = tau_m\n        term_s0 = s0 * dt * np.exp(-dt / tau)\n        term_spikes = sum(sp['a'] * (t1 - sp['t']) * np.exp(-(t1 - sp['t']) / tau) for sp in spikes)\n        \n        prefactor = q / C\n        delta_V_syn = prefactor * (term_s0 + term_spikes)\n\n    return V_leak + delta_V_syn\n\n\ndef solve_conductance_based(C, g_L, E_L, E_syn, I_ext, t0, t1, V0, g0, tau_s, spikes, **kwargs):\n    \"\"\"\n    Calculates V(t1) for the conductance-based synapse model by numerically integrating the exact solution.\n    \"\"\"\n    if t1 == t0:\n        return V0\n\n    # Extract spike times and weights for conductance\n    g_spikes = [{'t': sp['t'], 'w': sp['w']} for sp in spikes]\n\n    def g(t):\n        val = g0 * np.exp(-(t - t0) / tau_s)\n        for sp in g_spikes:\n            if t >= sp['t']:\n                val += sp['w'] * np.exp(-(t - sp['t']) / tau_s)\n        return val\n\n    def G_int(t): # Integral of g(u) from t0 to t\n        val = g0 * tau_s * (1 - np.exp(-(t - t0) / tau_s))\n        for sp in g_spikes:\n            if t >= sp['t']:\n                val += sp['w'] * tau_s * (1 - np.exp(-(t - sp['t']) / tau_s))\n        return val\n\n    def phi(t): # Exponent of the integrating factor\n        return (g_L * (t - t0) + G_int(t)) / C\n\n    def Q(t): # RHS of the ODE in standard form V' + P(t)V = Q(t)\n        return (g_L * E_L + g(t) * E_syn + I_ext) / C\n\n    def integrand(u):\n        return np.exp(phi(u)) * Q(u)\n\n    # Numerically evaluate the main integral\n    integral_val, _ = integrate.quad(integrand, t0, t1, epsabs=1e-12, epsrel=1e-12)\n\n    phi_t1 = phi(t1)\n    \n    V_t1 = np.exp(-phi_t1) * (V0 + integral_val)\n    \n    return V_t1\n\n# The problem asks for the implementation, so the python script itself is the answer.\n# I am not supposed to run it and put the results. So I'll remove the `if __name__ == \"__main__\"` block\n# and just provide the functions as the implementation. Wait, the original had it. I'll keep it.\n# Minimalist principle. I'll just fix the syntax errors.\n\n# The user-provided answer was not a complete script. It ended at `solve()`.\n# I will make it a complete and runnable script.\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}