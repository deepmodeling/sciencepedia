{
    "hands_on_practices": [
        {
            "introduction": "在分析神经脉冲计数时，一个关键的初始步骤是诊断其统计特性。Fano因子是区分泊松分布数据（等离散，即方差等于均值）和更具变异性数据（超离散，即方差大于均值）的经典工具。本练习  将引导您使用自举法（bootstrap）这一强大的计算方法，来判断观测到的数据变异性是否具有统计显著性，从而为选择简单的泊松模型还是更复杂的负二项分布模型提供依据。",
            "id": "4010449",
            "problem": "给定一个神经元在固定刺激条件下、多次重复试验中记录的脉冲计数数据。每次试验的数据记录在一个固定宽度的时间窗内。这些脉冲计数被建模为独立同分布的随机变量。任务是计算经验法诺因子，并评估观测到的过度离散现象是否支持使用负二项计数模型而非泊松计数模型。\n\n使用的基本原理和定义如下：\n- 泊松分布，其率参数为 $\\lambda$，均值为 $\\mathbb{E}[N] = \\lambda$，方差为 $\\mathrm{Var}(N) = \\lambda$。法诺因子定义为 $\\mathcal{F} = \\frac{\\mathrm{Var}(N)}{\\mathbb{E}[N]}$，对于泊松分布，$\\mathcal{F} = 1$。\n- 负二项分布 (NB)，其均值为 $\\mu$，正离散参数为 $k$，方差为 $\\mathrm{Var}(N) = \\mu + \\frac{\\mu^{2}}{k}$。其法诺因子为 $\\mathcal{F} = 1 + \\frac{\\mu}{k}$。相对于泊松分布的过度离散特征是 $\\mathrm{Var}(N) > \\mathbb{E}[N]$，等价于 $\\mathcal{F} > 1$。\n- 对于 $n$ 次试验，无偏样本均值为 $\\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^{n} x_{i}$。\n- 无偏样本方差为 $s^{2} = \\frac{1}{n - 1} \\sum_{i=1}^{n} (x_{i} - \\hat{\\mu})^{2}$。\n- 经验法诺因子为 $\\hat{\\mathcal{F}} = \\frac{s^{2}}{\\hat{\\mu}}$。\n- 负二项分布离散参数 $k$ 的矩估计量，可通过将经验方差和均值与 NB 方差公式相等来求得。当 $s^{2} > \\hat{\\mu}$ 时，得出 $\\hat{k} = \\frac{\\hat{\\mu}^{2}}{s^{2} - \\hat{\\mu}}$；否则，在 NB 的过度离散参数化中，$\\hat{k}$ 未定义。\n\n评估流程：\n- 在等离散（泊松分布）的零假设下，使用拟合均值 $\\hat{\\mu}$ 从 $\\mathrm{Poisson}(\\hat{\\mu})$ 分布中模拟 $B$ 个包含 $n$ 个计数的自助法复制样本，为 $b = 1,\\dots,B$ 计算自助法法诺因子 $\\hat{\\mathcal{F}}^{(b)}$，并估计用于判断过度离散的单侧 $p$ 值，公式为 $p = \\frac{1}{B} \\sum_{b=1}^{B} \\mathbf{1}\\left\\{ \\hat{\\mathcal{F}}^{(b)} \\ge \\hat{\\mathcal{F}} \\right\\}$。\n- 当且仅当 $p < \\alpha$ 且 $s^{2} > \\hat{\\mu}$ 时，宣告支持负二项模型。其中 $\\alpha$ 是显著性水平。\n\n算法要求：\n- 对每个数据集，计算 $\\hat{\\mu}$、$s^{2}$、$\\hat{\\mathcal{F}}$、单侧自助法 $p$ 值，以及在 $s^{2} > \\hat{\\mu}$ 条件下的矩估计量 $\\hat{k}$。否则，将 $\\hat{k}$ 设置为 $\\infty$，以表示 NB 的过度离散参数化不适用。\n- 使用 $B = 10000$ 次自助法复制和显著性水平 $\\alpha = 0.05$。\n- 所有计算都是无量纲的计数；不涉及物理单位。\n\n测试集：\n- 数据集 $1$ (过度离散，中等均值): $[\\, $2$, $12$, $3$, $15$, $7$, $8$, $1$, $18$, $4$, $11$, $5$, $9$, $14$, $6$, $13$, $10$, $17$, $3$, $16$, $7$ \\,]$。\n- 数据集 $2$ (近似等离散，类泊松): $[\\, $3$, $5$, $4$, $6$, $5$, $5$, $4$, $7$, $6$, $5$, $4$, $5$, $6$, $5$, $5$, $4$, $6$, $5$, $5$, $5$, $6$, $4$, $5$, $6$, $5$, $5$, $4$, $6$, $5$, $5$ \\,]$。\n- 数据集 $3$ (低度离散): $[\\, $7$, $7$, $7$, $8$, $6$, $7$, $7$, $8$, $6$, $7$ \\,]$。\n- 数据集 $4$ (小样本，低均值): $[\\, $0$, $0$, $1$, $2$, $0$ \\,]$。\n- 数据集 $5$ (过度离散，大均值): $[\\, $35$, $52$, $47$, $41$, $60$, $39$, $55$, $42$, $68$, $44$, $57$, $36$ \\,]$。\n\n最终输出规范：\n- 对每个数据集，生成一个列表 $[\\, \\hat{\\mathcal{F}}, \\hat{k}, \\mathrm{support} \\,]$，其中 $\\hat{\\mathcal{F}}$ 和 $\\hat{k}$ 是四舍五入到 $6$ 位小数的浮点数，$\\mathrm{support}$ 是一个布尔值，表示负二项模型是否得到了自助法检验和过度离散准则的支持。\n- 您的程序应生成单行输出，其中包含所有数据集的结果，格式为一个由方括号括起来的逗号分隔列表，每个数据集的结果本身也是一个由方括号括起来的逗号分隔列表。例如，输出格式必须为 $[ [f_{1}, k_{1}, b_{1}], [f_{2}, k_{2}, b_{2}], \\dots ]$ 的形式，其中每个 $f_{i}$ 和 $k_{i}$ 是具有 $6$ 位小数的浮点数，每个 $b_{i}$ 是一个布尔值。",
            "solution": "该问题已被验证为具有科学依据、定义明确且客观。它提出了计算神经科学中的一个标准任务：比较神经脉冲计数的统计模型。所有定义、数据和流程都清晰明了，并与既定的统计学和神经科学实践相符。\n\n目标是分析几个神经脉冲计数的数据集。对于每个数据集，我们必须确定负二项 ($NB$) 模型是否比更简单的泊松模型更受支持。该评估基于两个标准：是否存在过度离散（方差大于均值）以及对法诺因子进行的自助法假设检验的结果。\n\n法诺因子定义为 $\\mathcal{F} = \\frac{\\mathrm{Var}(N)}{\\mathbb{E}[N]}$，是衡量计数数据离散程度的关键指标。泊松过程由单一参数 $\\lambda$ 表征，其均值等于方差，因此其法诺因子恰好为 $\\mathcal{F} = 1$。此属性称为等离散。相比之下，神经脉冲序列通常表现出过度离散，即方差超过均值，导致法诺因子 $\\mathcal{F} > 1$。负二项分布，其参数为均值 $\\mu$ 和离散参数 $k$，可以对此类数据进行建模。其方差为 $\\mathrm{Var}(N) = \\mu + \\frac{\\mu^{2}}{k}$，产生的法诺因子为 $\\mathcal{F} = 1 + \\frac{\\mu}{k}$，对于正的有限离散参数 $k$，该值大于 $1$。\n\n对每个数据集的分析过程包括以下步骤：\n\n1.  **计算经验统计量**：给定一个包含 $n$ 个脉冲计数的数据集 $\\{x_1, x_2, \\dots, x_n\\}$，我们首先计算无偏样本均值 $\\hat{\\mu}$ 和无偏样本方差 $s^2$。\n    $$ \\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^{n} x_{i} $$\n    $$ s^{2} = \\frac{1}{n - 1} \\sum_{i=1}^{n} (x_{i} - \\hat{\\mu})^{2} $$\n    然后，经验法诺因子 $\\hat{\\mathcal{F}}$ 是这两个量的比值：\n    $$ \\hat{\\mathcal{F}} = \\frac{s^{2}}{\\hat{\\mu}} $$\n    当 $\\hat{\\mu} = 0$ 时会出现特殊情况。这意味着所有 $x_i = 0$，导致 $s^2 = 0$。该比值是不确定的，但数据完美符合 $\\lambda=0$ 的泊松模型。在这种情况下，我们可以认为该过程是等离散的，$\\hat{\\mathcal{F}}=1.0$。\n\n2.  **估计负二项分布参数**：支持 $NB$ 模型的第一个条件是观测到过度离散，即 $s^2 > \\hat{\\mu}$。如果满足此条件，我们使用矩方法来估计离散参数 $k$。通过将 $NB$ 分布的理论均值和方差设为等于其样本估计值（$\\mathbb{E}[N] = \\hat{\\mu}$ 和 $\\mathrm{Var}(N) = s^2$），我们求解 $k$：\n    $$ s^2 = \\hat{\\mu} + \\frac{\\hat{\\mu}^2}{\\hat{k}} \\implies \\hat{k} = \\frac{\\hat{\\mu}^2}{s^2 - \\hat{\\mu}} $$\n    如果数据不是过度离散的（$s^2 \\le \\hat{\\mu}$），则此估计量在 $NB$ 模型的过度离散参数化中无效。在这种情况下，$\\hat{k}$ 被设置为 $\\infty$，表示一个趋近于泊松分布的模型（因为当 $k \\to \\infty$ 时，$\\frac{\\mu^2}{k} \\to 0$ 且 $\\mathrm{Var}(N) \\to \\mu$）。\n\n3.  **自助法假设检验**：第二个条件是统计显著性。即使基础过程是泊松过程，观测到 $\\hat{\\mathcal{F}} > 1$ 也可能归因于随机抽样变异性。为评估这一点，我们执行自助法假设检验。\n    -   **零假设 ($H_0$)**：数据由泊松过程生成。在 $H_0$ 下，泊松率参数的最佳估计是样本均值，即 $\\lambda = \\hat{\\mu}$。\n    -   **流程**：我们模拟 $B = 10000$ 个自助法数据集。每个数据集（索引为 $b$）包含从 $\\mathrm{Poisson}(\\hat{\\mu})$ 分布中独立抽取的 $n$ 个计数。\n    -   对于每个自助法数据集，我们计算其样本均值 $\\hat{\\mu}^{(b)}$ 和样本方差 $(s^2)^{(b)}$，并由此计算出自助法法诺因子 $\\hat{\\mathcal{F}}^{(b)} = (s^2)^{(b)} / \\hat{\\mu}^{(b)}$。\n    -   **P 值计算**：单侧 $p$ 值是自助法法诺因子大于或等于经验观测法诺因子 $\\hat{\\mathcal{F}}$ 的比例。\n    $$ p = \\frac{1}{B} \\sum_{b=1}^{B} \\mathbf{1}\\left\\{ \\hat{\\mathcal{F}}^{(b)} \\ge \\hat{\\mathcal{F}} \\right\\} $$\n    其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。该 $p$ 值表示在数据服从泊松分布的零假设下，观测到等于或大于 $\\hat{\\mathcal{F}}$ 的法诺因子的概率。\n\n4.  **最终决策**：当且仅当满足以下两个条件时，才确认支持负二项模型：\n    -   数据是过度离散的：$s^2 > \\hat{\\mu}$。\n    -   自助法检验结果在统计上是显著的：$p < \\alpha$，其中显著性水平给定为 $\\alpha = 0.05$。\n\n对于提供的五个数据集中的每一个，都将执行此完整流程以计算结果元组 $[\\hat{\\mathcal{F}}, \\hat{k}, \\mathrm{support}]$。$\\hat{\\mathcal{F}}$ 和 $\\hat{k}$ 的浮点值将四舍五入到 $6$ 位小数。如果 $\\hat{k}$ 无法估计，则表示为无穷大。$\\mathrm{support}$ 结果是一个布尔值（`True` 或 `False`）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef analyze_spikes(data, B, alpha):\n    \"\"\"\n    Analyzes spike count data to assess support for a Negative Binomial model.\n\n    Args:\n        data (list): A list of integer spike counts.\n        B (int): The number of bootstrap replicates.\n        alpha (float): The significance level for the hypothesis test.\n\n    Returns:\n        list: A list containing [fano_hat, k_hat, support_nb], where\n              fano_hat is the empirical Fano factor, k_hat is the estimated NB\n              dispersion parameter (or inf), and support_nb is a boolean.\n    \"\"\"\n    counts = np.array(data)\n    n = len(counts)\n\n    # Step 1: Compute empirical statistics\n    if n  2:\n        # Unbiased variance is not defined for n  2.\n        # This case is not present in the test suite but is handled for robustness.\n        mu_hat = np.mean(counts) if n > 0 else 0.0\n        s2 = np.nan\n        ff_hat = np.nan\n    else:\n        mu_hat = np.mean(counts)\n        s2 = np.var(counts, ddof=1)\n        # Handle the case where mu_hat is 0 to avoid division by zero.\n        # If mu_hat is 0, all counts are 0, s2 is 0. This is perfectly Poisson.\n        # The Fano factor is indeterminate but best represented as 1 (equidispersion).\n        if mu_hat == 0.0:\n            ff_hat = 1.0\n        else:\n            ff_hat = s2 / mu_hat\n\n    # Step 2: Estimate Negative Binomial Parameter\n    is_overdispersed = s2 > mu_hat\n    if is_overdispersed:\n        k_hat = mu_hat**2 / (s2 - mu_hat)\n    else:\n        k_hat = float('inf')\n\n    # Step 3: Bootstrap Hypothesis Test\n    # If mu_hat is 0, the process is perfectly Poisson(0), p-value is 1.\n    if mu_hat == 0.0:\n        p_value = 1.0\n    else:\n        # Use a fixed seed for reproducibility.\n        rng = np.random.default_rng(seed=42)\n        bootstrap_samples = rng.poisson(lam=mu_hat, size=(B, n))\n\n        # Calculate Fano factors for all bootstrap samples\n        # axis=1 performs calculations across each row (each bootstrap replicate)\n        bootstrap_means = np.mean(bootstrap_samples, axis=1)\n        bootstrap_vars = np.var(bootstrap_samples, axis=1, ddof=1)\n\n        # Safely compute Fano factors, avoiding division by zero.\n        # If a bootstrap mean is 0, its variance is also 0. It's an equidispersed sample.\n        # We assign a Fano factor of 1.0 in this case.\n        bootstrap_ffs = np.divide(bootstrap_vars, bootstrap_means, \n                                  out=np.ones_like(bootstrap_means, dtype=float), \n                                  where=bootstrap_means != 0)\n\n        # Calculate the one-sided p-value\n        p_value = np.sum(bootstrap_ffs >= ff_hat) / B\n    \n    # Step 4: Final Decision\n    support_nb = is_overdispersed and (p_value  alpha)\n\n    return [ff_hat, k_hat, support_nb]\n\n\ndef solve():\n    \"\"\"\n    Drives the analysis for all test cases and prints the formatted result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        [2, 12, 3, 15, 7, 8, 1, 18, 4, 11, 5, 9, 14, 6, 13, 10, 17, 3, 16, 7],\n        [3, 5, 4, 6, 5, 5, 4, 7, 6, 5, 4, 5, 6, 5, 5, 4, 6, 5, 5, 5, 6, 4, 5, 6, 5, 5, 4, 6, 5, 5],\n        [7, 7, 7, 8, 6, 7, 7, 8, 6, 7],\n        [0, 0, 1, 2, 0],\n        [35, 52, 47, 41, 60, 39, 55, 42, 68, 44, 57, 36]\n    ]\n\n    B = 10000\n    alpha = 0.05\n    \n    results = []\n    for data in test_cases:\n        result = analyze_spikes(data, B, alpha)\n        results.append(result)\n\n    # Format the final output string exactly as specified.\n    formatted_results = []\n    for res in results:\n        ff, k, support = res\n        ff_str = f\"{ff:.6f}\"\n        k_str = \"inf\" if k == float('inf') else f\"{k:.6f}\"\n        support_str = str(support).lower()\n        formatted_results.append(f\"[{ff_str},{k_str},{support_str}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从数据诊断过渡到参数估计，下一步是量化我们模型的参数。即使我们初步判断泊松模型是合适的，仅仅估算发放率 $\\lambda$ 是不够的，量化该估计的不确定性也至关重要。本练习  对比了计算置信区间的两种方法：一种是基于卡方（Chi-square）分布的理论精确方法，另一种是广泛应用的高斯近似方法，这有助于深入理解不同统计技术之间的权衡与局限。",
            "id": "4010384",
            "problem": "给定来自一个齐次泊松过程的独立脉冲计数，在持续时间为 $T$ 秒的固定窗口中观测到的脉冲计数 $K$ 服从均值为 $\\mu = \\lambda T$ 的泊松分布，其中 $\\lambda$ 是未知的速率（单位：脉冲/秒）。从泊松过程和泊松分布的定义出发，并仅使用经过充分检验的事实，请实现两种方法，用于在持续时间为 $T$ 的窗口中观测到单个计数值 $k$ 的情况下，为 $\\lambda$ 构建一个置信水平为 $1 - \\alpha$ 的双边等尾置信区间：\n- 一个精确区间，通过反转泊松尾部概率来找到其累积概率等于指定尾部概率的 $\\mu$ 值，然后通过 $\\lambda = \\mu / T$ 映射回 $\\lambda$。你可以使用在此类反转中出现的泊松分布和卡方分布之间已经确立的关系，但在你的推理中，不要在没有推导的情况下假定任何现成的快捷公式。\n- 一个高斯（正态）近似区间，由中心极限定理证明其合理性，并在中等计数范围内对方差应用适当的置入估计。如果需要，请在你的构建中对 $\\lambda$ 强制施加非负约束。\n\n你的程序必须为每个测试用例计算：\n- $\\lambda$ 的精确下界，\n- $\\lambda$ 的精确上界，\n- $\\lambda$ 的高斯下界，\n- $\\lambda$ 的高斯上界。\n\n所有界限必须以 $s^{-1}$ 为单位表示，并四舍五入到六位小数。如果任何高斯下界为负，则将其截断为 $0$ 以遵循 $\\lambda \\ge 0$。如果高斯构造在 $k = 0$ 时退化，请在应用非负约束后，在输出中忠实地反映这一点。\n\n测试套件（每个测试用例是一个三元组 $(k, T, \\alpha)$）：\n- 用例 1: $k = 12$, $T = 1.0$, $\\alpha = 0.05$.\n- 用例 2 (边界情况): $k = 0$, $T = 1.0$, $\\alpha = 0.05$.\n- 用例 3: $k = 30$, $T = 0.5$, $\\alpha = 0.05$.\n- 用例 4: $k = 5$, $T = 2.0$, $\\alpha = 0.10$.\n- 用例 5: $k = 80$, $T = 4.0$, $\\alpha = 0.01$.\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。\n- 该列表应按每个测试用例的以下顺序展开：$[\\text{exact\\_lower}, \\text{exact\\_upper}, \\text{gaussian\\_lower}, \\text{gaussian\\_upper}]$ 用于用例 1，随后是用例 2 的相同四个数字，依此类推直到用例 5。\n- 所有数字必须打印为精确到六位小数的十进制浮点数。\n例如，对于五个测试用例，输出应看起来像 $[\\dots]$，其中包含按指定顺序排列的恰好 $20$ 个数字，每个数字都四舍五入到六位小数，并且没有附加文本。不涉及角度。不应出现百分比；$\\alpha$ 必须作为 0 到 1 之间的小数处理。",
            "solution": "用户提供了有效的问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知信息**\n- **过程**：齐次泊松过程。\n- **观测**：在持续时间为 $T$ 秒的固定时间窗口中观测到单个脉冲计数 $K=k$。\n- **分布**：$K$ 服从均值为 $\\mu = \\lambda T$ 的泊松分布，其中 $\\lambda$ 是未知的速率（单位：脉冲/秒，$s^{-1}$）。\n- **目标**：为 $\\lambda$ 构建一个置信水平为 $1 - \\alpha$ 的双边等尾置信区间 (CI)。\n- **方法 1 (精确)**：反转泊松尾部概率以找到 $\\mu$ 的界限，然后映射到 $\\lambda$。可以使用泊松分布和卡方分布之间的关系，但必须进行推导。\n- **方法 2 (高斯)**：使用由中心极限定理证明其合理性的正态近似，并对方差使用置入估计。必须强制执行非负约束。应处理 $k=0$ 时的退化情况。\n- **测试套件**：提供了五个测试用例，形式为元组 $(k, T, \\alpha)$：\n  1. $(12, 1.0, 0.05)$\n  2. $(0, 1.0, 0.05)$\n  3. $(30, 0.5, 0.05)$\n  4. $(5, 2.0, 0.10)$\n  5. $(80, 4.0, 0.01)$\n- **输出要求**：为每个测试用例计算四个值：$\\lambda$ 的精确下界、精确上界、高斯下界和高斯上界。所有值必须四舍五入到六位小数，并以单个扁平列表形式呈现。\n\n**步骤 2：使用提取的已知信息进行验证**\n- **科学依据**：该问题在统计学和计算神经科学中有充分的依据。泊松过程是脉冲序列的标准模型，为其速率参数构建置信区间是一项基本任务。\n- **良态问题**：问题定义清晰。它指定了模型、数据、所需的统计构造（置信区间）以及要使用的确切方法。输入足以产生唯一的解决方案。\n- **客观性**：问题使用精确、无歧义的科学和数学语言进行陈述。\n\n**步骤 3：结论与行动**\n问题是有效的。它在科学上是合理的、良态的且客观的。没有矛盾、歧义或缺失的信息。将提供一个有理有据的解决方案。\n\n### 基于原理的解决方案\n\n目标是基于在时间间隔 $T$ 内观测到的计数值 $k$，为泊松速率参数 $\\lambda$ 找到一个 $1-\\alpha$ 置信区间。计数值 $K$ 是一个来自均值为 $\\mu = \\lambda T$ 的泊松分布的随机变量，记为 $K \\sim \\text{Poisson}(\\mu)$。我们将首先为均值 $\\mu$ 构建一个置信区间 $[\\mu_L, \\mu_U]$，然后通过缩放得到速率 $\\lambda$ 的区间，即 $[\\lambda_L, \\lambda_U] = [\\mu_L/T, \\mu_U/T]$。\n\n#### 1. 精确置信区间（针对泊松分布的 Clopper-Pearson 方法）\n\n该方法通过反转对参数 $\\mu$ 的假设检验来定义区间。对于一个观测到的计数值 $k$，双边等尾 $(1-\\alpha)$ 置信区间 $[\\mu_L, \\mu_U]$ 由以下两个方程定义：\n\n1.  下界 $\\mu_L$ 是这样一个 $\\mu$ 值，使得观测到 $k$ 或更多计数的概率为 $\\alpha/2$：\n    $$P(K \\ge k | \\mu = \\mu_L) = \\sum_{j=k}^{\\infty} \\frac{e^{-\\mu_L} \\mu_L^j}{j!} = \\frac{\\alpha}{2}$$\n2.  上界 $\\mu_U$ 是这样一个 $\\mu$ 值，使得观测到 $k$ 或更少计数的概率为 $\\alpha/2$：\n    $$P(K \\le k | \\mu = \\mu_U) = \\sum_{j=0}^{k} \\frac{e^{-\\mu_U} \\mu_U^j}{j!} = \\frac{\\alpha}{2}$$\n\n为求解这些方程，我们使用泊松分布和伽马分布之间的关系，并随后使用卡方分布。\n\n**泊松-伽马-卡方关系的推导：**\n考虑一个速率为 1 的泊松过程。在长度为 $\\mu$ 的区间内，事件数 $K$ 服从 $\\text{Poisson}(\\mu)$ 分布。直到第 $n$ 个事件的等待时间 $W_n$ 服从形状参数为 $n$、速率参数为 1 的伽马分布，即 $W_n \\sim \\text{Gamma}(n, 1)$。在区间 $[0, \\mu]$ 内事件数少于 $k$ 个的事件，等价于第 $k$ 个事件在时间 $\\mu$ 之后发生的事件。\n$$P(K  k | \\mu) = P(W_k  \\mu)$$\n因此，泊松分布的生存函数 (SF) 与伽马分布的累积分布函数 (CDF) 相关：\n$$P(K \\ge k | \\mu) = 1 - P(K  k | \\mu) = 1 - P(W_k  \\mu) = P(W_k \\le \\mu) = F_{\\text{Gamma}(k,1)}(\\mu)$$\n现在，我们将伽马分布与卡方 ($\\chi^2$) 分布联系起来。一个自由度为 $\\nu$ 的 $\\chi^2$ 分布是伽马分布的一个特例：$\\chi^2_{\\nu} \\sim \\text{Gamma}(\\nu/2, 1/2)$。如果一个随机变量 $X \\sim \\text{Gamma}(a, b)$，那么 $2bX \\sim \\chi^2_{2a}$。对于我们的等待时间 $W_k \\sim \\text{Gamma}(k, 1)$，我们有 $a=k$ 和 $b=1$。因此，$2W_k \\sim \\chi^2_{2k}$。\nCDF 关系为 $F_{W_k}(\\mu) = F_{2W_k}(2\\mu) = F_{\\chi^2_{2k}}(2\\mu)$。\n结合这些事实，我们得到：\n$$P(K \\ge k | \\mu) = F_{\\chi^2_{2k}}(2\\mu)$$\n\n**计算界限：**\n\n**下界 ($\\mu_L$):**\n对于观测到的计数值 $k  0$，定义方程为 $P(K \\ge k | \\mu_L) = \\alpha/2$。使用我们推导的恒等式：\n$$F_{\\chi^2_{2k}}(2\\mu_L) = \\frac{\\alpha}{2}$$\n反转该式可得 $2\\mu_L = F^{-1}_{\\chi^2_{2k}}(\\alpha/2)$，其中 $F^{-1}_{\\chi^2_{\\nu}}(p)$ 是自由度为 $\\nu$ 的 $\\chi^2$ 分布在概率 $p$ 处求值的分位数函数（逆累积分布函数）。\n$$\\mu_L = \\frac{1}{2} F^{-1}_{\\chi^2_{2k}}\\left(\\frac{\\alpha}{2}\\right)$$\n对于 $k=0$ 的特殊情况，对于任何 $\\mu  0$ 都有 $P(K \\ge 0 | \\mu)=1$。除非 $\\alpha=2$，否则定义方程无法满足。按照惯例，当 $k=0$ 时我们设定 $\\mu_L = 0$，这对应于该参数的物理极限。\n\n**上界 ($\\mu_U$):**\n定义方程为 $P(K \\le k | \\mu_U) = \\alpha/2$。这可以使用生存函数重写为：\n$$1 - P(K \\ge k+1 | \\mu_U) = \\frac{\\alpha}{2} \\implies P(K \\ge k+1 | \\mu_U) = 1 - \\frac{\\alpha}{2}$$\n使用我们关于 $k+1$ 的恒等式：\n$$F_{\\chi^2_{2(k+1)}}(2\\mu_U) = 1 - \\frac{\\alpha}{2}$$\n反转该式可得 $2\\mu_U = F^{-1}_{\\chi^2_{2(k+1)}}(1 - \\alpha/2)$。\n$$\\mu_U = \\frac{1}{2} F^{-1}_{\\chi^2_{2(k+1)}}\\left(1 - \\frac{\\alpha}{2}\\right)$$\n\n最后，$\\lambda$ 的置信区间为 $[\\lambda_L, \\lambda_U] = [\\mu_L/T, \\mu_U/T]$。\n\n#### 2. 高斯（正态）近似区间\n\n对于较大的均值 $\\mu$，泊松分布可以用具有相同均值和方差的正态分布来近似：$\\text{Poisson}(\\mu) \\approx N(\\mu, \\mu)$。\n我们考虑速率的点估计量 $\\hat{\\lambda} = k/T$。\n这个估计量的期望是 $E[\\hat{\\lambda}] = E[k/T] = E[K]/T = \\mu/T = (\\lambda T)/T = \\lambda$。\n方差是 $\\text{Var}(\\hat{\\lambda}) = \\text{Var}(k/T) = \\frac{1}{T^2}\\text{Var}(K) = \\mu/T^2 = (\\lambda T)/T^2 = \\lambda/T$。\n对于较大的 $k$，$\\hat{\\lambda}$ 的抽样分布近似为正态分布：$\\hat{\\lambda} \\stackrel{\\cdot}{\\sim} N(\\lambda, \\lambda/T)$。\n为了构建置信区间，我们需要估计量的标准误，$\\text{SE}(\\hat{\\lambda}) = \\sqrt{\\lambda/T}$。由于 $\\lambda$ 未知，我们通过将 $\\lambda$ 替换为 $\\hat{\\lambda}$ 来使用“置入”估计：\n$$\\widehat{\\text{SE}}(\\hat{\\lambda}) = \\sqrt{\\frac{\\hat{\\lambda}}{T}} = \\sqrt{\\frac{k/T}{T}} = \\frac{\\sqrt{k}}{T}$$\n一个 $(1-\\alpha)$ 置信区间则由 $\\hat{\\lambda} \\pm z_{1-\\alpha/2} \\widehat{\\text{SE}}(\\hat{\\lambda})$ 给出，其中 $z_{1-\\alpha/2}$ 是标准正态分布 $N(0,1)$ 的 $(1-\\alpha/2)$-分位数。\n\n界限为：\n$$\\lambda_{L,G} = \\frac{k}{T} - z_{1-\\alpha/2} \\frac{\\sqrt{k}}{T}$$\n$$\\lambda_{U,G} = \\frac{k}{T} + z_{1-\\alpha/2} \\frac{\\sqrt{k}}{T}$$\n\n由于速率 $\\lambda$ 不能为负，我们通过将下界截断为零来强制执行此约束：\n$$\\lambda_{L,G}^{\\text{final}} = \\max\\left(0, \\lambda_{L,G}\\right)$$\n\n在 $k=0$ 的特殊情况下，估计量为 $\\hat{\\lambda}=0$，估计的标准误为 $\\widehat{\\text{SE}}(\\hat{\\lambda})=0$。这导致一个退化区间 $[0,0]$。这种行为是这种特定正态近似（瓦尔德区间）在参数空间边界处的一个已知的人为现象。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2, norm\n\ndef solve():\n    \"\"\"\n    Computes exact and Gaussian confidence intervals for the rate parameter\n    of a Poisson process based on observed spike counts.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k, T, alpha)\n        (12, 1.0, 0.05),\n        (0, 1.0, 0.05),\n        (30, 0.5, 0.05),\n        (5, 2.0, 0.10),\n        (80, 4.0, 0.01),\n    ]\n\n    flat_results = []\n    for k, T, alpha in test_cases:\n        # --- Method 1: Exact Interval (Clopper-Pearson for Poisson) ---\n        # The exact interval for the Poisson mean mu is given by Chi-square quantiles.\n        # We then scale by 1/T to get the interval for the rate lambda.\n\n        # Lower bound\n        if k == 0:\n            # For k=0, the lower bound for the rate is 0.\n            lambda_L_exact = 0.0\n        else:\n            # Degrees of freedom for lower bound calculation\n            df_L = 2 * k\n            # mu_L = 0.5 * chi2.ppf(alpha/2, 2*k)\n            # lambda_L = mu_L / T\n            lambda_L_exact = chi2.ppf(alpha / 2, df_L) / (2 * T)\n        \n        # Upper bound\n        # Degrees of freedom for upper bound calculation\n        df_U = 2 * (k + 1)\n        # mu_U = 0.5 * chi2.ppf(1 - alpha/2, 2*(k+1))\n        # lambda_U = mu_U / T\n        lambda_U_exact = chi2.ppf(1 - alpha / 2, df_U) / (2 * T)\n\n        # --- Method 2: Gaussian (Normal) Approximation Interval ---\n        # This is the standard Wald interval based on the normal approximation\n        # to the Poisson distribution (or to the sampling distribution of the estimator).\n        \n        # Point estimate of the rate\n        lambda_hat = k / T\n        \n        if k == 0:\n            # For k=0, lambda_hat=0 and the estimated standard error is 0.\n            # This leads to a degenerate interval [0, 0].\n            lambda_L_gauss = 0.0\n            lambda_U_gauss = 0.0\n        else:\n            # z-score for the (1-alpha) confidence level\n            z_score = norm.ppf(1 - alpha / 2)\n            # Plug-in estimate of the standard error of lambda_hat\n            se_hat = np.sqrt(k) / T\n            \n            # Lower bound with non-negativity constraint\n            lambda_L_gauss = max(0.0, lambda_hat - z_score * se_hat)\n            \n            # Upper bound\n            lambda_U_gauss = lambda_hat + z_score * se_hat\n        \n        flat_results.extend([lambda_L_exact, lambda_U_exact, lambda_L_gauss, lambda_U_gauss])\n\n    # Format all results to a string with exactly six decimal places\n    # and join them into a single comma-separated list.\n    formatted_results = [f\"{num:.6f}\" for num in flat_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本章最后将介绍规范的模型比较方法。当诊断指标（如第一个练习中的Fano因子）表明简单模型可能不足时，进行模型比较是合乎逻辑的后续步骤。本练习  介绍了似然比检验（Likelihood-Ratio Test），它提供了一个强大且有原则的框架，用以量化支持更复杂模型（如负二项分布）优于其嵌套的简单模型（如泊松分布）的证据，从而使模型选择过程更加严谨。",
            "id": "4010365",
            "problem": "对单个皮层神经元在 $n = 10$ 次相同刺激的重复呈现下进行记录，得到逐次试验的脉冲计数 $\\{x_{i}\\}_{i=1}^{n} = (0, 1, 0, 2, 3, 4, 1, 2, 5, 0)$。考虑用两种生成模型来描述这些脉冲计数：一个是在所有试验中具有共同未知率 $\\,\\mu\\,$ 的泊松模型，另一个是具有共同未知均值 $\\,\\mu\\,$ 和一个固定的已知大小（离散）参数 $\\,k = 3\\,$ 的负二项 (NB) 模型。大小参数 $\\,k\\,$ 是从一个大型、独立的校准数据集中估计得出的，在此被视为外部提供且固定的。\n\n从泊松分布和负二项分布的概率质量函数的基本定义出发，在独立试验的假设下，推导一个似然比检验 (LRT; Likelihood-Ratio Test)，用于比较泊松模型和负二项模型对这些脉冲计数的拟合。具体要求如下：\n\n- 从第一性原理出发，为每个模型推导最大似然估计 (MLE) $\\,\\hat{\\mu}\\,$。\n- 对于一般的脉冲计数 $\\{x_{i}\\}$ 和固定的 $k$，以闭式形式推导 LRT 统计量 $\\,\\Lambda = 2\\left(\\ln L_{\\mathrm{NB}}(\\hat{\\mu}, k) - \\ln L_{\\mathrm{Pois}}(\\hat{\\mu})\\right)\\,$，并根据需要，仅使用充分统计量和初等函数来表示它。\n- 计算给定数据集和 $\\,k = 3\\,$ 时的 $\\,\\Lambda\\,$ 值。\n\n在您的推导中，通过明确使用定义和独立性假设来证明每一步的合理性。最后，基于推导出的 $\\,\\Lambda\\,$ 及其对 $\\,k\\,$ 的函数依赖关系，简要解释离散参数 $\\,k\\,$ 如何影响神经脉冲计数的泊松模型和负二项模型之间的模型选择。将 $\\,\\Lambda\\,$ 的最终数值四舍五入到四位有效数字。最终数值无需物理单位。",
            "solution": "该问题表述科学严谨、定义明确、客观且内部一致。这是计算神经科学中统计模型比较的一个标准问题。所有必要的数据和定义均已提供。因此，我将进行完整的推导和解答。\n\n问题要求进行似然比检验，以比较两种用于神经脉冲计数数据 $\\{x_i\\}_{i=1}^n$ 的模型：泊松模型和负二项 (NB) 模型。试验被假定为独立的。\n\n首先，我们定义两种模型的概率质量函数 (PMF)。\n对于率（也是均值）为 $\\mu$ 的泊松分布，其 PMF 为：\n$$P(X=x | \\mu) = \\frac{\\mu^x \\exp(-\\mu)}{x!}$$\n对于负二项分布，问题指定了使用均值 $\\mu$ 和固定大小参数 $k$ 的参数化形式。标准的 PMF 使用大小参数 $r$ 和成功概率 $p$。它们之间的关系是 $r=k$，均值 $\\mu = \\frac{r(1-p)}{p} = \\frac{k(1-p)}{p}$。解出 $p$ 可得 $p = \\frac{k}{k+\\mu}$，因此 $1-p = \\frac{\\mu}{k+\\mu}$。用 $\\mu$ 和 $k$ 表示的 PMF 是：\n$$P(X=x | \\mu, k) = \\binom{x+k-1}{x} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^x$$\n\n**步骤 1：为每个模型推导 $\\mu$ 的最大似然估计 (MLE)。**\n\n**泊松模型：**\n给定 $n$ 个独立观测值 $\\{x_i\\}_{i=1}^n$，似然函数是各个概率的乘积：\n$$L_{\\mathrm{Pois}}(\\mu; \\{x_i\\}) = \\prod_{i=1}^{n} P(x_i | \\mu) = \\prod_{i=1}^{n} \\frac{\\mu^{x_i} \\exp(-\\mu)}{x_i!}$$\n使用对数似然函数 $\\ln L$ 更为方便：\n$$\\ln L_{\\mathrm{Pois}}(\\mu) = \\sum_{i=1}^{n} \\ln\\left(\\frac{\\mu^{x_i} \\exp(-\\mu)}{x_i!}\\right) = \\sum_{i=1}^{n} (x_i \\ln \\mu - \\mu - \\ln(x_i!))$$\n$$\\ln L_{\\mathrm{Pois}}(\\mu) = (\\ln \\mu) \\sum_{i=1}^{n} x_i - n\\mu - \\sum_{i=1}^{n} \\ln(x_i!)$$\n为了求得 MLE $\\hat{\\mu}_{\\mathrm{Pois}}$，我们将 $\\ln L_{\\mathrm{Pois}}(\\mu)$ 对 $\\mu$ 求导，并令其结果为零：\n$$\\frac{d}{d\\mu} \\ln L_{\\mathrm{Pois}}(\\mu) = \\frac{1}{\\mu} \\sum_{i=1}^{n} x_i - n = 0$$\n解出 $\\mu$ 得到 MLE：\n$$\\hat{\\mu}_{\\mathrm{Pois}} = \\frac{\\sum_{i=1}^{n} x_i}{n} = \\bar{x}$$\n泊松率的 MLE 是数据的样本均值。\n\n**负二项模型：**\n对于固定 $k$ 的负二项模型，其对数似然函数为：\n$$\\ln L_{\\mathrm{NB}}(\\mu; \\{x_i\\}, k) = \\sum_{i=1}^{n} \\ln\\left( \\binom{x_i+k-1}{x_i} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^{x_i} \\right)$$\n$$\\ln L_{\\mathrm{NB}}(\\mu) = \\sum_{i=1}^{n} \\left[ \\ln\\binom{x_i+k-1}{x_i} + k\\ln\\left(\\frac{k}{k+\\mu}\\right) + x_i\\ln\\left(\\frac{\\mu}{k+\\mu}\\right) \\right]$$\n$$\\ln L_{\\mathrm{NB}}(\\mu) = C + \\sum_{i=1}^{n} \\left[ k(\\ln k - \\ln(k+\\mu)) + x_i(\\ln \\mu - \\ln(k+\\mu)) \\right]$$\n其中 $C = \\sum_{i=1}^n \\ln\\binom{x_i+k-1}{x_i}$ 是一个相对于 $\\mu$ 的常数。\n$$\\ln L_{\\mathrm{NB}}(\\mu) = C + nk\\ln k - nk\\ln(k+\\mu) + (\\ln \\mu)\\sum_{i=1}^{n} x_i - (\\ln(k+\\mu))\\sum_{i=1}^{n} x_i$$\n为了求得 MLE $\\hat{\\mu}_{\\mathrm{NB}}$，我们对 $\\mu$ 求导并令其为零：\n$$\\frac{d}{d\\mu} \\ln L_{\\mathrm{NB}}(\\mu) = -\\frac{nk}{k+\\mu} + \\frac{1}{\\mu}\\sum_{i=1}^{n} x_i - \\frac{1}{k+\\mu}\\sum_{i=1}^{n} x_i = 0$$\n$$\\frac{\\sum x_i}{\\mu} = \\frac{nk + \\sum x_i}{k+\\mu}$$\n$$(k+\\mu)\\sum x_i = \\mu(nk + \\sum x_i)$$\n$$k\\sum x_i + \\mu\\sum x_i = nk\\mu + \\mu\\sum x_i$$\n$$k\\sum x_i = nk\\mu$$\n解出 $\\mu$ 得到 MLE：\n$$\\hat{\\mu}_{\\mathrm{NB}} = \\frac{\\sum_{i=1}^{n} x_i}{n} = \\bar{x}$$\n因此，对于两个模型，均值参数 $\\mu$ 的 MLE 都是样本均值 $\\bar{x}$。我们将这个共同的 MLE 记为 $\\hat{\\mu} = \\bar{x}$。\n\n**步骤 2：推导似然比检验统计量 $\\Lambda$。**\nLRT 统计量定义为 $\\Lambda = 2(\\ln L_{\\mathrm{NB}}(\\hat{\\mu}, k) - \\ln L_{\\mathrm{Pois}}(\\hat{\\mu}))$。\n我们可以将其表示为在每个数据点上概率的对数比率之和，在 $\\hat{\\mu}=\\bar{x}$ 处求值：\n$$\\Lambda = 2 \\sum_{i=1}^{n} \\ln\\left(\\frac{P(x_i | \\hat{\\mu}, k)}{P(x_i | \\hat{\\mu})}\\right)$$\n我们来分析单个数据点 $x_i$ 的比率：\n$$\\frac{P(x_i | \\bar{x}, k)}{P(x_i | \\bar{x})} = \\frac{\\binom{x_i+k-1}{x_i} (\\frac{k}{k+\\bar{x}})^k (\\frac{\\bar{x}}{k+\\bar{x}})^{x_i}}{\\frac{\\bar{x}^{x_i} \\exp(-\\bar{x})}{x_i!}}$$\n使用 $\\binom{x_i+k-1}{x_i} = \\frac{\\Gamma(x_i+k)}{x_i! \\Gamma(k)}$，其中 $\\Gamma(z)$ 是伽马函数：\n$$= \\frac{\\Gamma(x_i+k)}{x_i! \\Gamma(k)} \\frac{k^k \\bar{x}^{x_i}}{(k+\\bar{x})^{k+x_i}} \\frac{x_i!}{\\bar{x}^{x_i} \\exp(-\\bar{x})} = \\frac{\\Gamma(x_i+k)}{\\Gamma(k)} \\frac{k^k \\exp(\\bar{x})}{(k+\\bar{x})^{k+x_i}}$$\n取该比率的自然对数：\n$$\\ln\\left(\\frac{P(x_i | \\bar{x}, k)}{P(x_i | \\bar{x})}\\right) = \\ln\\Gamma(x_i+k) - \\ln\\Gamma(k) + k\\ln k + \\bar{x} - (k+x_i)\\ln(k+\\bar{x})$$\n对所有 $n$ 个观测值求和：\n$$\\sum_{i=1}^{n} \\ln\\left(\\frac{P(x_i | \\hat{\\mu}, k)}{P(x_i | \\hat{\\mu})}\\right) = \\sum_{i=1}^{n} \\left[ \\ln\\Gamma(x_i+k) - \\ln\\Gamma(k) + k\\ln k + \\bar{x} - (k+x_i)\\ln(k+\\bar{x}) \\right]$$\n$$= \\left(\\sum_{i=1}^{n} \\ln\\Gamma(x_i+k)\\right) - n\\ln\\Gamma(k) + nk\\ln k + n\\bar{x} - \\sum_{i=1}^{n}(k+x_i)\\ln(k+\\bar{x})$$\n最后一项可以展开：\n$$\\sum_{i=1}^{n}(k+x_i)\\ln(k+\\bar{x}) = (nk + \\sum_{i=1}^{n} x_i)\\ln(k+\\bar{x}) = (nk + n\\bar{x})\\ln(k+\\bar{x})$$\n代回并乘以 $2$ 得到 $\\Lambda$ 的最终表达式：\n$$\\Lambda = 2 \\left[ \\sum_{i=1}^{n} \\ln\\Gamma(x_i+k) - n\\ln\\Gamma(k) + nk\\ln k - (nk+n\\bar{x})\\ln(k+\\bar{x}) + n\\bar{x} \\right]$$\n这就是 LRT 统计量的闭式表达式。\n\n**步骤 3：计算给定数据集的 $\\Lambda$ 值。**\n数据为 $\\{x_i\\} = (0, 1, 0, 2, 3, 4, 1, 2, 5, 0)$。\n参数为 $n=10$ 和 $k=3$。\n首先，计算样本均值 $\\bar{x}$：\n$$\\sum_{i=1}^{10} x_i = 0+1+0+2+3+4+1+2+5+0 = 18$$\n$$\\bar{x} = \\frac{18}{10} = 1.8$$\n现在我们计算 $\\Lambda$ 表达式中的每一项。对于整数 $z$，我们使用 $\\ln\\Gamma(z) = \\ln((z-1)!)$。\n每个值的计数为：$f(0)=3$，$f(1)=2$，$f(2)=2$，$f(3)=1$，$f(4)=1$，$f(5)=1$。\n$$\\sum_{i=1}^{10} \\ln\\Gamma(x_i+k) = \\sum_{i=1}^{10} \\ln\\Gamma(x_i+3)$$\n$$= 3\\ln\\Gamma(3) + 2\\ln\\Gamma(4) + 2\\ln\\Gamma(5) + 1\\ln\\Gamma(6) + 1\\ln\\Gamma(7) + 1\\ln\\Gamma(8)$$\n$$= 3\\ln(2!) + 2\\ln(3!) + 2\\ln(4!) + \\ln(5!) + \\ln(6!) + \\ln(7!)$$\n$$= 3\\ln(2) + 2\\ln(6) + 2\\ln(24) + \\ln(120) + \\ln(720) + \\ln(5040)$$\n使用数值计算：\n$\\sum \\ln\\Gamma(x_i+3) \\approx 3(0.69315) + 2(1.79176) + 2(3.17805) + 4.78749 + 6.57925 + 8.52516 \\approx 31.9110$\n其他项为：\n$n\\ln\\Gamma(k) = 10\\ln\\Gamma(3) = 10\\ln(2) \\approx 6.9315$\n$nk\\ln(k) = 10 \\cdot 3 \\ln(3) = 30\\ln(3) \\approx 32.9584$\n$n\\bar{x} = 10 \\cdot 1.8 = 18$\n$(nk+n\\bar{x})\\ln(k+\\bar{x}) = (30+18)\\ln(3+1.8) = 48\\ln(4.8) \\approx 75.2936$\n将这些值代入 $\\Lambda$ 的公式中：\n$$\\Lambda = 2 [31.9110 - 6.9315 + 32.9584 - 75.2936 + 18]$$\n$$\\Lambda = 2 [82.8694 - 82.2251] = 2 [0.6443] = 1.2886$$\n四舍五入到四位有效数字，$\\Lambda \\approx 1.289$。\n\n**离散参数 $k$ 的影响：**\n负二项分布中的参数 $k$ 控制其离散程度。负二项分布的方差为 $\\mathrm{Var}(X) = \\mu + \\frac{\\mu^2}{k}$。\n当 $k \\to \\infty$ 时，泊松分布是负二项分布的一个特例。在此极限下，负二项分布的方差变为 $\\mu$，这正是泊松分布的方差。因此，对于非常大的 $k$，负二项模型变得与泊松模型无法区分。其结果是，似然值变得相等 ($L_{\\mathrm{NB}} \\to L_{\\mathrm{Pois}}$)，LRT 统计量 $\\Lambda \\to 0$。\n相反，较小的 $k$ 值对应于更大的过离散（即方差远大于均值）。对于表现出显著过离散（样本方差显著大于样本均值）的数据集，具有较小 $k$ 值的负二项模型将比泊松模型提供更好的拟合。这将导致 $L_{\\mathrm{NB}} \\gg L_{\\mathrm{Pois}}$ 和一个大的正值 $\\Lambda$，从而为负二项模型优于泊松模型提供了强有力的证据。\n本质上，$k$ 参数化了一个模型族，它连接了高度过离散（小 $k$）和泊松（大 $k$）之间的鸿沟。LRT 统计量 $\\Lambda$ 量化了与更具限制性的泊松模型相比，具有特定离散度 $k$ 的负二项模型所提供的额外灵活性（过离散）的证据。一个正的 $\\Lambda$ 值表明数据在负二项模型下出现的可能性更大，这意味着存在与 $k$ 值相符的过离散现象。",
            "answer": "$$\\boxed{1.289}$$"
        }
    ]
}