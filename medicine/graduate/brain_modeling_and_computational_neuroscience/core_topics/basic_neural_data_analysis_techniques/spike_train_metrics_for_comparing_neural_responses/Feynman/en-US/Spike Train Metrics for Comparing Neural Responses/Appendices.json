{
    "hands_on_practices": [
        {
            "introduction": "A common first approach to comparing spike trains is to discretize them into binary vectors through binning. This exercise delves into the properties of the Hamming distance, a simple metric for such binned data, to reveal one of its fundamental weaknesses. By analyzing how the distance changes with a small, continuous time shift, you will gain a concrete understanding of why this method's sensitivity to spike timings near bin boundaries necessitates the development of more sophisticated, time-aware metrics .",
            "id": "4019999",
            "problem": "Consider two single-neuron spike trains recorded over a fixed observation window of duration $T=1$ seconds in response to the same stimulus on two trials, labeled $x$ and $y$. The spike times for $x$ are $0.095$ seconds, $0.205$ seconds, $0.499$ seconds, $0.501$ seconds, and $0.905$ seconds. The spike times for $y$ are $0.005$ seconds, $0.215$ seconds, $0.500$ seconds, and $0.890$ seconds. Construct binary binned spike trains for each trial by partitioning the interval $[0,T)$ into $10$ equal-width bins of width $\\Delta=0.1$ seconds, using left-closed, right-open bin intervals $[k\\Delta,(k+1)\\Delta)$ for $k=0,1,\\dots,9$. A bin is assigned the value $1$ if it contains one or more spikes from the corresponding trial and $0$ otherwise. Spikes that fall outside $[0,T)$ after any transformation are discarded.\n\nCompute the Hamming distance between the resulting binary binned spike trains for $x$ and $y$. Then, consider a transformed version of $x$ in which every spike time is shifted forward (to the right) by a constant offset $\\epsilon \\in [0,0.1)$ seconds. Reconstruct the binary binned spike train for the shifted $x$ as above and let $D(\\epsilon)$ denote the Hamming distance between the shifted $x$ and the original $y$. Provide the fully simplified, piecewise analytic expression for $D(\\epsilon)$ over $0 \\le \\epsilon < 0.1$ that explicitly captures how the Hamming distance changes as spikes cross bin boundaries due to the shift. The final answer must be a single closed-form expression. No rounding is required for this problem. Express any numeric values appearing in the answer exactly as specified by the spike times and bin widths given here.",
            "solution": "The problem asks for a piecewise analytic expression for the Hamming distance, $D(\\epsilon)$, between two binned spike trains as a function of a time shift $\\epsilon$ applied to one of the trains. The observation window is $T=1$ second, divided into $10$ bins of width $\\Delta = 0.1$ seconds.\n\nFirst, we establish the fixed reference spike train. The spike times for trial $y$ are given as $S_y = \\{0.005, 0.215, 0.500, 0.890\\}$. The bin intervals are $[k\\Delta, (k+1)\\Delta)$ for $k \\in \\{0, 1, \\dots, 9\\}$. A spike at time $t$ falls into bin $k = \\lfloor t/\\Delta \\rfloor = \\lfloor 10t \\rfloor$.\n\nBinning the spike train $y$:\n- Spike at $t=0.005$: $k = \\lfloor 10 \\times 0.005 \\rfloor = \\lfloor 0.05 \\rfloor = 0$.\n- Spike at $t=0.215$: $k = \\lfloor 10 \\times 0.215 \\rfloor = \\lfloor 2.15 \\rfloor = 2$.\n- Spike at $t=0.500$: $k = \\lfloor 10 \\times 0.500 \\rfloor = \\lfloor 5.00 \\rfloor = 5$.\n- Spike at $t=0.890$: $k = \\lfloor 10 \\times 0.890 \\rfloor = \\lfloor 8.90 \\rfloor = 8$.\n\nThe set of bins containing spikes for trial $y$ is $\\{0, 2, 5, 8\\}$. This results in the binary binned vector $y_{\\text{binned}}$, which remains constant throughout the problem:\n$$y_{\\text{binned}} = (1, 0, 1, 0, 0, 1, 0, 0, 1, 0)$$\n\nNext, we consider the spike train $x$, which is shifted by a time offset $\\epsilon \\in [0, 0.1)$. The original spike times for $x$ are $S_x = \\{0.095, 0.205, 0.499, 0.501, 0.905\\}$. The shifted spike times are $t'_i = t_i^x + \\epsilon$. We denote the resulting binned vector as $x'_{\\text{binned}}(\\epsilon)$. The Hamming distance $D(\\epsilon)$ is the number of positions where $x'_{\\text{binned}}(\\epsilon)$ and $y_{\\text{binned}}$ differ.\n\n$D(\\epsilon)$ is a step function that changes its value only when a shifted spike $t'_i$ crosses a bin boundary. A boundary is located at each multiple of $\\Delta=0.1$. A crossing occurs when $t_i^x + \\epsilon = k\\Delta$ for some integer $k$. We need to find the critical values of $\\epsilon \\in [0, 0.1)$ at which these crossings occur.\n\n- Spike $t_1^x = 0.095$: Crosses the boundary at $0.1$ when $0.095 + \\epsilon = 0.1$, so $\\epsilon = 0.005$.\n- Spike $t_2^x = 0.205$: Crosses the boundary at $0.3$ when $0.205 + \\epsilon = 0.3$, so $\\epsilon = 0.095$.\n- Spike $t_3^x = 0.499$: Crosses the boundary at $0.5$ when $0.499 + \\epsilon = 0.5$, so $\\epsilon = 0.001$.\n- Spike $t_4^x = 0.501$: Crosses the boundary at $0.6$ when $0.501 + \\epsilon = 0.6$, so $\\epsilon = 0.099$.\n- Spike $t_5^x = 0.905$: Crosses the boundary at $1.0$ (end of observation window) when $0.905 + \\epsilon = 1.0$, so $\\epsilon = 0.095$. Spikes at or after $t=1.0$ are discarded.\n\nThe distinct critical values of $\\epsilon$ in increasing order are $0.001$, $0.005$, $0.095$, and $0.099$. These values partition the interval $[0, 0.1)$ into five subintervals. We will now compute $D(\\epsilon)$ for each subinterval.\n\n**1. Interval: $0 \\le \\epsilon < 0.001$**\nNo spike has crossed a boundary yet. The spikes of $x$ fall into their original bins:\n- $t=0.095 \\to k=0$.\n- $t=0.205 \\to k=2$.\n- $t=0.499 \\to k=4$.\n- $t=0.501 \\to k=5$.\n- $t=0.905 \\to k=9$.\nThe set of active bins for $x'$ is $\\{0, 2, 4, 5, 9\\}$. So, $x'_{\\text{binned}}(\\epsilon) = (1, 0, 1, 0, 1, 1, 0, 0, 0, 1)$.\nComparing with $y_{\\text{binned}} = (1, 0, 1, 0, 0, 1, 0, 0, 1, 0)$, the mismatches occur at bins $4$, $8$, and $9$.\nThus, $D(\\epsilon) = 3$.\n\n**2. Interval: $0.001 \\le \\epsilon < 0.005$**\nAt $\\epsilon=0.001$, the spike from $t_3^x=0.499$ crosses into bin $5$.\n- Bin $4$ becomes empty. Its value in $x'_{\\text{binned}}$ changes from $1$ to $0$.\n- Bin $5$ already contained the spike from $t_4^x=0.501$, so its value in $x'_{\\text{binned}}$ remains $1$.\nThe set of active bins for $x'$ becomes $\\{0, 2, 5, 9\\}$. So, $x'_{\\text{binned}}(\\epsilon) = (1, 0, 1, 0, 0, 1, 0, 0, 0, 1)$.\nComparing with $y_{\\text{binned}}$, the mismatches occur at bins $8$ and $9$.\nThus, $D(\\epsilon) = 2$.\n\n**3. Interval: $0.005 \\le \\epsilon < 0.095$**\nAt $\\epsilon=0.005$, the spike from $t_1^x=0.095$ crosses into bin $1$.\n- Bin $0$ becomes empty ($x'_{\\text{binned}}[0]$ changes from $1$ to $0$).\n- Bin $1$ was empty and now contains a spike ($x'_{\\text{binned}}[1]$ changes from $0$ to $1$).\nThe set of active bins for $x'$ becomes $\\{1, 2, 5, 9\\}$. So, $x'_{\\text{binned}}(\\epsilon) = (0, 1, 1, 0, 0, 1, 0, 0, 0, 1)$.\nComparing with $y_{\\text{binned}}$, the mismatches occur at bins $0$, $1$, $8$, and $9$.\nThus, $D(\\epsilon) = 4$.\n\n**4. Interval: $0.095 \\le \\epsilon < 0.099$**\nAt $\\epsilon=0.095$, two events happen simultaneously:\n- The spike from $t_2^x=0.205$ crosses into bin $3$.\n- The spike from $t_5^x=0.905$ is shifted to $t \\ge 1.0$ and is discarded.\n- Bin $2$ becomes empty ($x'_{\\text{binned}}[2]$ changes from $1$ to $0$).\n- Bin $3$ was empty and becomes active ($x'_{\\text{binned}}[3]$ changes from $0$ to $1$).\n- Bin $9$ becomes empty ($x'_{\\text{binned}}[9]$ changes from $1$ to $0$).\nThe set of active bins for $x'$ becomes $\\{1, 3, 5\\}$. So, $x'_{\\text{binned}}(\\epsilon) = (0, 1, 0, 1, 0, 1, 0, 0, 0, 0)$.\nComparing with $y_{\\text{binned}}$, the mismatches occur at bins $0$, $1$, $2$, $3$, and $8$.\nThus, $D(\\epsilon) = 5$.\n\n**5. Interval: $0.099 \\le \\epsilon < 0.1$**\nAt $\\epsilon=0.099$, the spike from $t_4^x=0.501$ crosses into bin $6$.\n- Bin $5$ remains active because it still contains the shifted spike from $t_3^x=0.499$ (e.g., for $\\epsilon=0.099$, $0.499+0.099 = 0.598$, in bin $5$).\n- Bin $6$ was empty and becomes active ($x'_{\\text{binned}}[6]$ changes from $0$ to $1$).\nThe set of active bins for $x'$ becomes $\\{1, 3, 5, 6\\}$. So, $x'_{\\text{binned}}(\\epsilon) = (0, 1, 0, 1, 0, 1, 1, 0, 0, 0)$.\nComparing with $y_{\\text{binned}}$, the mismatches occur at bins $0$, $1$, $2$, $3$, $6$, and $8$.\nThus, $D(\\epsilon) = 6$.\n\nCombining these results, we obtain the piecewise analytic expression for $D(\\epsilon)$ over the interval $0 \\le \\epsilon < 0.1$:\n$D(\\epsilon) = \\begin{cases} 3 & \\text{if } 0 \\le \\epsilon < 0.001 \\\\ 2 & \\text{if } 0.001 \\le \\epsilon < 0.005 \\\\ 4 & \\text{if } 0.005 \\le \\epsilon < 0.095 \\\\ 5 & \\text{if } 0.095 \\le \\epsilon < 0.099 \\\\ 6 & \\text{if } 0.099 \\le \\epsilon < 0.1 \\end{cases}$\nThis is the final simplified expression.",
            "answer": "$$\n\\boxed{\nD(\\epsilon) = \\begin{cases} 3 & \\text{if } 0 \\le \\epsilon < 0.001 \\\\ 2 & \\text{if } 0.001 \\le \\epsilon < 0.005 \\\\ 4 & \\text{if } 0.005 \\le \\epsilon < 0.095 \\\\ 5 & \\text{if } 0.095 \\le \\epsilon < 0.099 \\\\ 6 & \\text{if } 0.099 \\le \\epsilon < 0.1 \\end{cases}\n}\n$$"
        },
        {
            "introduction": "To overcome the limitations of binning, we turn to metrics that explicitly account for the precise timing of spikes. This practice introduces the Victor–Purpura (VP) distance, a powerful metric based on the concept of an \"edit distance,\" which finds the minimum cost to transform one spike train into another. By manually calculating this minimal cost, you will learn to reason about the trade-off between shifting a spike (with cost $q|t-t'|$) and the fixed cost of deleting and inserting spikes, building a foundational intuition for how cost-based metrics quantify neural dissimilarity .",
            "id": "4019961",
            "problem": "Consider two spike trains, $x=\\{0.1,\\,0.5,\\,0.9\\}$ and $y=\\{0.12,\\,0.52\\}$, whose spike times are measured in seconds. The task is to compare these neural responses using the Victor–Purpura (VP) spike train metric, defined as follows. The VP metric $d_{q}(x,y)$ is the minimal total cost over all sequences of edit operations that transform $x$ into $y$, where the allowed operations are: (i) deleting a spike with cost $1$; (ii) inserting a spike with cost $1$; and (iii) moving a spike from time $t$ to time $t'$ with cost $q\\,|t-t'|$. Here $q$ is a positive parameter with units of inverse time, so that the move cost is dimensionless. The total cost is the sum of the costs of the individual operations in the edit path, and the metric $d_{q}(x,y)$ is the minimum of this total cost over all valid edit paths.\n\nStarting from these definitions, determine the metric $d_{q}(x,y)$ for $q=10$ (in units of $\\text{s}^{-1}$), by explicitly identifying an optimal edit path that transforms $x$ into $y$ and computing its total cost. In your reasoning, justify that the identified path is optimal among all possible edit paths. Express the final answer as a single dimensionless real number. No rounding is required, and the final answer does not carry units.",
            "solution": "The problem is to compute the Victor–Purpura (VP) spike train metric $d_q(x, y)$ for two given spike trains $x=\\{0.1, 0.5, 0.9\\}$ and $y=\\{0.12, 0.52\\}$, with the parameter $q=10\\,\\text{s}^{-1}$. The spike times are given in seconds.\n\nThe VP metric $d_q(x, y)$ is defined as the minimum total cost to transform spike train $x$ into spike train $y$ using three types of operations:\n1.  Deleting a spike, at a cost of $1$.\n2.  Inserting a spike, at a cost of $1$.\n3.  Moving a spike from time $t_i$ to $t_j$, at a cost of $q|t_i - t_j|$.\n\nSince the cost parameter $q$ is given in units of $\\text{s}^{-1}$ and the time differences are in $\\text{s}$, the cost of moving a spike is dimensionless, consistent with the costs of insertions and deletions.\n\nThe number of spikes in train $x$ is $N_x = 3$, and the number of spikes in train $y$ is $N_y = 2$. Any sequence of operations that transforms $x$ into $y$ can be decomposed into a set of moves, deletions, and insertions. Let $k$ be the number of spikes from $x$ that are \"moved\" to become spikes in $y$. This corresponds to establishing $k$ pairings between spikes from $x$ and spikes from $y$. The number of such pairings is limited by $0 \\le k \\le \\min(N_x, N_y)$, so $k$ can be $0$, $1$, or $2$.\n\nFor a given number of moves $k$, the remaining $N_x - k$ spikes in $x$ must be deleted, and the remaining $N_y - k$ spikes in $y$ must be inserted. The total cost for a specific transformation path involving $k$ moves is the sum of the costs of these operations. We can find the overall minimum cost $d_q(x,y)$ by finding the minimum cost for each possible value of $k$ and then taking the minimum over these cases.\n\nThe total cost for a path with $k$ moves is given by:\n$$\nC_k = (\\text{cost of } k \\text{ moves}) + (N_x - k) \\times (\\text{cost of a deletion}) + (N_y - k) \\times (\\text{cost of an insertion})\n$$\nSubstituting the given values $N_x=3$, $N_y=2$, and the costs of $1$ for deletions/insertions:\n$$\nC_k = (\\text{cost of } k \\text{ moves}) + (3 - k) \\cdot 1 + (2 - k) \\cdot 1 = (\\text{cost of } k \\text{ moves}) + 5 - 2k\n$$\nWe now analyze each case for $k$.\n\nCase 1: $k=0$ moves.\nThis corresponds to deleting all spikes in $x$ and inserting all spikes in $y$.\nThe cost is $C_0 = (3 - 0) \\times 1 + (2 - 0) \\times 1 = 3 + 2 = 5$.\n\nCase 2: $k=1$ move.\nThis corresponds to moving one spike from $x$ to $y$, deleting the other two spikes from $x$, and inserting the other spike from $y$. The total cost is:\n$$\nC_1 = q|x_i - y_j| + (3 - 1) + (2 - 1) = q|x_i - y_j| + 2 + 1 = q|x_i - y_j| + 3\n$$\nWe seek the minimum cost, so we must find the minimum move cost $q|x_i - y_j|$ over all possible pairs of spikes $(x_i, y_j)$. With $q=10$:\n- Move $x_1=0.1$ to $y_1=0.12$: Cost = $10|0.1 - 0.12| + 3 = 10(0.02) + 3 = 0.2 + 3 = 3.2$.\n- Move $x_1=0.1$ to $y_2=0.52$: Cost = $10|0.1 - 0.52| + 3 = 10(0.42) + 3 = 4.2 + 3 = 7.2$.\n- Move $x_2=0.5$ to $y_1=0.12$: Cost = $10|0.5 - 0.12| + 3 = 10(0.38) + 3 = 3.8 + 3 = 6.8$.\n- Move $x_2=0.5$ to $y_2=0.52$: Cost = $10|0.5 - 0.52| + 3 = 10(0.02) + 3 = 0.2 + 3 = 3.2$.\n- Move $x_3=0.9$ to $y_1=0.12$: Cost = $10|0.9 - 0.12| + 3 = 10(0.78) + 3 = 7.8 + 3 = 10.8$.\n- Move $x_3=0.9$ to $y_2=0.52$: Cost = $10|0.9 - 0.52| + 3 = 10(0.38) + 3 = 3.8 + 3 = 6.8$.\nThe minimum cost for $k=1$ is $3.2$.\n\nCase 3: $k=2$ moves.\nThis corresponds to moving two spikes from $x$ to the two spikes in $y$, and deleting the one remaining spike from $x$. The number of insertions is $N_y-k=2-2=0$. The total cost is:\n$$\nC_2 = (\\text{cost of 2 moves}) + (3 - 2) + (2 - 2) = (\\text{cost of 2 moves}) + 1\n$$\nTo find the minimum cost for this case, we must consider which spike from $x$ is deleted and how the remaining two are matched to the spikes in $y$.\n\nSubcase 3a: Delete $x_1=0.1$. The remaining spikes in $x$ are $\\{0.5, 0.9\\}$ to be matched with $\\{0.12, 0.52\\}$.\n- Match $0.5 \\to 0.12$ and $0.9 \\to 0.52$: Cost = $1 + 10|0.5 - 0.12| + 10|0.9 - 0.52| = 1 + 3.8 + 3.8 = 8.6$.\n- Match $0.5 \\to 0.52$ and $0.9 \\to 0.12$: Cost = $1 + 10|0.5 - 0.52| + 10|0.9 - 0.12| = 1 + 0.2 + 7.8 = 9.0$.\nThe minimum cost for this subcase is $8.6$.\n\nSubcase 3b: Delete $x_2=0.5$. The remaining spikes in $x$ are $\\{0.1, 0.9\\}$ to be matched with $\\{0.12, 0.52\\}$.\n- Match $0.1 \\to 0.12$ and $0.9 \\to 0.52$: Cost = $1 + 10|0.1 - 0.12| + 10|0.9 - 0.52| = 1 + 0.2 + 3.8 = 5.0$.\n- Match $0.1 \\to 0.52$ and $0.9 \\to 0.12$: Cost = $1 + 10|0.1 - 0.52| + 10|0.9 - 0.12| = 1 + 4.2 + 7.8 = 13.0$.\nThe minimum cost for this subcase is $5.0$.\n\nSubcase 3c: Delete $x_3=0.9$. The remaining spikes in $x$ are $\\{0.1, 0.5\\}$ to be matched with $\\{0.12, 0.52\\}$.\n- Match $0.1 \\to 0.12$ and $0.5 \\to 0.52$: Cost = $1 + 10|0.1 - 0.12| + 10|0.5 - 0.52| = 1 + 0.2 + 0.2 = 1.4$.\n- Match $0.1 \\to 0.52$ and $0.5 \\to 0.12$: Cost = $1 + 10|0.1 - 0.52| + 10|0.5 - 0.12| = 1 + 4.2 + 3.8 = 9.0$.\nThe minimum cost for this subcase is $1.4$.\n\nThe minimum cost for the $k=2$ case is the minimum of $\\{8.6, 5.0, 1.4\\}$, which is $1.4$.\n\nTo find the global minimum cost $d_{10}(x,y)$, we compare the minimum costs found for each value of $k$:\n- Minimum cost for $k=0$: $5.0$.\n- Minimum cost for $k=1$: $3.2$.\n- Minimum cost for $k=2$: $1.4$.\n\nThe overall minimum is $1.4$. This cost is achieved via an edit path with two moves and one deletion.\nThe specific optimal edit path is:\n1.  Move the spike at $t=0.1$ to $t=0.12$. The cost is $q|0.1 - 0.12| = 10 \\times 0.02 = 0.2$.\n2.  Move the spike at $t=0.5$ to $t=0.52$. The cost is $q|0.5 - 0.52| = 10 \\times 0.02 = 0.2$.\n3.  Delete the spike at $t=0.9$. The cost is $1$.\n\nThe total cost for this path is $0.2 + 0.2 + 1 = 1.4$. This systematic enumeration of all possible transformation structures ($k=0, 1, 2$ moves) and finding the minimum cost for each case guarantees that $1.4$ is the minimal total cost over all possible edit paths. Thus, the Victor–Purpura distance is $1.4$.",
            "answer": "$$\\boxed{1.4}$$"
        },
        {
            "introduction": "An alternative to cost-based edit distances are kernel-based methods, which operate by an entirely different principle. This exercise explores the van Rossum distance, which conceptualizes spike trains as signals, filters them with an exponential kernel to mimic postsynaptic potentials, and then measures the distance between the resulting continuous waveforms. This practice is designed to deepen your understanding by guiding you through the derivation of the standard computational formula directly from the metric's first-principles integral definition, connecting the theoretical concept to its practical implementation .",
            "id": "4020002",
            "problem": "Two single neurons are recorded in response to the same stimulus, producing two spike trains. Let the spike train for neuron $x$ be the ordered set of spike times $x=\\{0.1,0.4\\}$ and the spike train for neuron $y$ be $y=\\{0.15,0.6\\}$, where all times are in seconds. To compare these spike trains, use the van Rossum distance $d_{\\tau}$ defined from first principles as follows. Represent each spike train as a sum of Dirac delta functions and filter it with an exponential kernel of time constant $\\tau$. Specifically, let the exponential kernel be $h_{\\tau}(t)=\\exp(-t/\\tau)\\,H(t)$, where $H(t)$ is the Heaviside step function. Define the filtered signals by $f_{x}(t)=\\sum_{t_{i}\\in x}h_{\\tau}(t-t_{i})$ and $f_{y}(t)=\\sum_{s_{j}\\in y}h_{\\tau}(t-s_{j})$. The van Rossum distance is the square root of the time-constant-normalized squared difference of these filtered signals:\n$$\nd_{\\tau}=\\left(\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\left(f_{x}(t)-f_{y}(t)\\right)^{2}\\,\\mathrm{d}t\\right)^{1/2}.\n$$\nStarting only from these definitions and without invoking any pre-derived shortcut formulas, carry out the derivation to reduce the integral to explicit pairwise exponential overlap terms between spikes, separately enumerating the within-train and cross-train contributions, and then compute the numerical value of $d_{\\tau}$ for $\\tau=0.05$ seconds. Report $d_{\\tau}$ as a dimensionless quantity. Round your final numerical answer to six significant figures.",
            "solution": "The problem requires the computation of the van Rossum distance, $d_{\\tau}$, between two spike trains, $x=\\{t_1, t_2\\} = \\{0.1, 0.4\\}$ and $y=\\{s_1, s_2\\} = \\{0.15, 0.6\\}$, for a given time constant $\\tau=0.05$ seconds. The derivation must start from the first principles provided.\n\nThe squared van Rossum distance is defined as:\n$$\nd_{\\tau}^2 = \\frac{1}{\\tau} \\int_{-\\infty}^{\\infty} (f_{x}(t) - f_{y}(t))^2 \\mathrm{d}t\n$$\nwhere $f_{x}(t)$ and $f_{y}(t)$ are the spike trains filtered with an exponential kernel $h_{\\tau}(t) = \\exp(-t/\\tau)H(t)$. Here, $H(t)$ is the Heaviside step function, which is $1$ for $t \\ge 0$ and $0$ for $t < 0$.\n\nFirst, we expand the squared term in the integrand:\n$$\n(f_{x}(t) - f_{y}(t))^2 = f_{x}(t)^2 - 2f_{x}(t)f_{y}(t) + f_{y}(t)^2\n$$\nThe integral can thus be separated into three parts:\n$$\nd_{\\tau}^2 = \\frac{1}{\\tau} \\left[ \\int_{-\\infty}^{\\infty} f_{x}(t)^2 \\mathrm{d}t - 2\\int_{-\\infty}^{\\infty} f_{x}(t)f_{y}(t) \\mathrm{d}t + \\int_{-\\infty}^{\\infty} f_{y}(t)^2 \\mathrm{d}t \\right]\n$$\nThe filtered signals are given by $f_{x}(t) = \\sum_{t_i \\in x} h_{\\tau}(t-t_i)$ and $f_{y}(t) = \\sum_{s_j \\in y} h_{\\tau}(t-s_j)$. Let's analyze the general form of the integrals. The integrals are composed of sums of pairwise kernel convolutions. The fundamental building block is the integral of the product of two kernels, one centered at time $t_a$ and the other at $t_b$:\n$$\nI(t_a, t_b) = \\int_{-\\infty}^{\\infty} h_{\\tau}(t-t_a) h_{\\tau}(t-t_b) \\mathrm{d}t\n$$\nSubstituting the definition of $h_{\\tau}(t)$:\n$$\nI(t_a, t_b) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-t_a}{\\tau}\\right) H(t-t_a) \\exp\\left(-\\frac{t-t_b}{\\tau}\\right) H(t-t_b) \\mathrm{d}t\n$$\nThe product of the Heaviside functions $H(t-t_a)H(t-t_b)$ is non-zero only when both $t \\ge t_a$ and $t \\ge t_b$. This is equivalent to $t \\ge \\max(t_a, t_b)$, so the product equals $H(t - \\max(t_a, t_b))$. The lower limit of the integral becomes $\\max(t_a, t_b)$.\n$$\nI(t_a, t_b) = \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{t-t_a}{\\tau}\\right) \\exp\\left(-\\frac{t-t_b}{\\tau}\\right) \\mathrm{d}t\n$$\n$$\nI(t_a, t_b) = \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t - t_a - t_b}{\\tau}\\right) \\mathrm{d}t = \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\mathrm{d}t\n$$\nPerforming the integration:\n$$\n\\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\mathrm{d}t = \\left[ -\\frac{\\tau}{2} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\right]_{\\max(t_a, t_b)}^{\\infty} = 0 - \\left( -\\frac{\\tau}{2} \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right) \\right) = \\frac{\\tau}{2} \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right)\n$$\nSubstituting this back into the expression for $I(t_a, t_b)$:\n$$\nI(t_a, t_b) = \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\cdot \\frac{\\tau}{2} \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right) = \\frac{\\tau}{2} \\exp\\left(\\frac{t_a+t_b - 2\\max(t_a, t_b)}{\\tau}\\right)\n$$\nWe use the identity $t_a+t_b = \\min(t_a, t_b) + \\max(t_a, t_b)$, which gives $t_a+t_b - 2\\max(t_a, t_b) = \\min(t_a, t_b) - \\max(t_a, t_b) = -|t_a-t_b|$. Thus, we arrive at the simplified expression for the elementary integral:\n$$\nI(t_a, t_b) = \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_a-t_b|}{\\tau}\\right)\n$$\nNow, we can express the three integrals in our formula for $d_{\\tau}^2$ using this result.\n\nThe first integral (within-train $x$):\n$$\n\\int_{-\\infty}^{\\infty} f_{x}(t)^2 \\mathrm{d}t = \\int_{-\\infty}^{\\infty} \\left(\\sum_{t_i \\in x} h_{\\tau}(t-t_i)\\right) \\left(\\sum_{t_k \\in x} h_{\\tau}(t-t_k)\\right) \\mathrm{d}t = \\sum_{t_i \\in x} \\sum_{t_k \\in x} \\int_{-\\infty}^{\\infty} h_{\\tau}(t-t_i)h_{\\tau}(t-t_k) \\mathrm{d}t\n$$\n$$\n\\int_{-\\infty}^{\\infty} f_{x}(t)^2 \\mathrm{d}t = \\sum_{t_i \\in x} \\sum_{t_k \\in x} \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right)\n$$\nThe third integral (within-train $y$):\n$$\n\\int_{-\\infty}^{\\infty} f_{y}(t)^2 \\mathrm{d}t = \\sum_{s_j \\in y} \\sum_{s_l \\in y} \\frac{\\tau}{2} \\exp\\left(-\\frac{|s_j-s_l|}{\\tau}\\right)\n$$\nThe second integral (cross-train $x-y$):\n$$\n\\int_{-\\infty}^{\\infty} f_{x}(t)f_{y}(t) \\mathrm{d}t = \\sum_{t_i \\in x} \\sum_{s_j \\in y} \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_i-s_j|}{\\tau}\\right)\n$$\nSubstituting these back into the expression for $d_{\\tau}^2$ and cancelling the $\\tau$ from the numerator and denominator:\n$$\nd_{\\tau}^2 = \\frac{1}{2} \\left[ \\sum_{t_i, t_k \\in x} \\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right) - 2\\sum_{t_i \\in x, s_j \\in y} \\exp\\left(-\\frac{|t_i-s_j|}{\\tau}\\right) + \\sum_{s_j, s_l \\in y} \\exp\\left(-\\frac{|s_j-s_l|}{\\tau}\\right) \\right]\n$$\nThis expression separates the contributions as requested. Let's define the within-train and cross-train terms:\n$C_{xx} = \\sum_{t_i, t_k \\in x} \\exp(-|t_i-t_k|/\\tau)$\n$C_{yy} = \\sum_{s_j, s_l \\in y} \\exp(-|s_j-s_l|/\\tau)$\n$C_{xy} = \\sum_{t_i \\in x, s_j \\in y} \\exp(-|t_i-s_j|/\\tau)$\nThen $d_{\\tau}^2 = \\frac{1}{2}(C_{xx} - 2C_{xy} + C_{yy})$.\n\nNow, we compute these terms for the given spike trains $x=\\{0.1, 0.4\\}$ and $y=\\{0.15, 0.6\\}$ with $\\tau=0.05$.\nLet $t_1=0.1$, $t_2=0.4$, $s_1=0.15$, $s_2=0.6$.\n\nContribution $C_{xx}$:\n$$\nC_{xx} = \\exp\\left(-\\frac{|t_1-t_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_1-t_2|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-t_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-t_2|}{\\tau}\\right)\n$$\n$$\nC_{xx} = \\exp(0) + \\exp\\left(-\\frac{|0.1-0.4|}{0.05}\\right) + \\exp\\left(-\\frac{|0.4-0.1|}{0.05}\\right) + \\exp(0)\n$$\n$$\nC_{xx} = 1 + \\exp\\left(-\\frac{0.3}{0.05}\\right) + \\exp\\left(-\\frac{0.3}{0.05}\\right) + 1 = 2 + 2\\exp(-6)\n$$\nContribution $C_{yy}$:\n$$\nC_{yy} = \\exp\\left(-\\frac{|s_1-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|s_1-s_2|}{\\tau}\\right) + \\exp\\left(-\\frac{|s_2-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|s_2-s_2|}{\\tau}\\right)\n$$\n$$\nC_{yy} = \\exp(0) + \\exp\\left(-\\frac{|0.15-0.6|}{0.05}\\right) + \\exp\\left(-\\frac{|0.6-0.15|}{0.05}\\right) + \\exp(0)\n$$\n$$\nC_{yy} = 1 + \\exp\\left(-\\frac{0.45}{0.05}\\right) + \\exp\\left(-\\frac{0.45}{0.05}\\right) + 1 = 2 + 2\\exp(-9)\n$$\nContribution $C_{xy}$:\n$$\nC_{xy} = \\exp\\left(-\\frac{|t_1-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_1-s_2|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-s_2|}{\\tau}\\right)\n$$\nThe absolute differences are:\n$|t_1-s_1| = |0.1-0.15|=0.05$\n$|t_1-s_2| = |0.1-0.6|=0.5$\n$|t_2-s_1| = |0.4-0.15|=0.25$\n$|t_2-s_2| = |0.4-0.6|=0.2$\n$$\nC_{xy} = \\exp\\left(-\\frac{0.05}{0.05}\\right) + \\exp\\left(-\\frac{0.5}{0.05}\\right) + \\exp\\left(-\\frac{0.25}{0.05}\\right) + \\exp\\left(-\\frac{0.2}{0.05}\\right)\n$$\n$$\nC_{xy} = \\exp(-1) + \\exp(-10) + \\exp(-5) + \\exp(-4)\n$$\nNow, assemble $d_{\\tau}^2$:\n$$\nd_{\\tau}^2 = \\frac{1}{2} \\left[ (2 + 2\\exp(-6)) - 2(\\exp(-1) + \\exp(-4) + \\exp(-5) + \\exp(-10)) + (2 + 2\\exp(-9)) \\right]\n$$\n$$\nd_{\\tau}^2 = (1 + \\exp(-6)) - (\\exp(-1) + \\exp(-4) + \\exp(-5) + \\exp(-10)) + (1 + \\exp(-9))\n$$\n$$\nd_{\\tau}^2 = 2 + \\exp(-6) + \\exp(-9) - \\exp(-1) - \\exp(-4) - \\exp(-5) - \\exp(-10)\n$$\nWe compute the numerical values of the exponential terms:\n$\\exp(-1) \\approx 0.36787944$\n$\\exp(-4) \\approx 0.01831564$\n$\\exp(-5) \\approx 0.00673795$\n$\\exp(-6) \\approx 0.00247875$\n$\\exp(-9) \\approx 0.00012341$\n$\\exp(-10) \\approx 0.00004540$\n\n$$\nd_{\\tau}^2 \\approx 2 + 0.00247875 + 0.00012341 - 0.36787944 - 0.01831564 - 0.00673795 - 0.00004540\n$$\n$$\nd_{\\tau}^2 \\approx 2.00260216 - (0.36787944 + 0.01831564 + 0.00673795 + 0.00004540)\n$$\n$$\nd_{\\tau}^2 \\approx 2.00260216 - 0.39297843 = 1.60962373\n$$\nFinally, we compute the distance $d_{\\tau}$ by taking the square root:\n$$\nd_{\\tau} = \\sqrt{1.60962373} \\approx 1.268709476\n$$\nRounding to six significant figures, we get $1.26871$. The quantity is dimensionless as per the definition.",
            "answer": "$$\n\\boxed{1.26871}\n$$"
        }
    ]
}