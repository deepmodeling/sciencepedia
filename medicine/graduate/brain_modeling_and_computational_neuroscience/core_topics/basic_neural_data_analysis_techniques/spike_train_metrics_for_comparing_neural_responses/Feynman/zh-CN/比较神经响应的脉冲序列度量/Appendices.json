{
    "hands_on_practices": [
        {
            "introduction": "比较脉冲序列最直接的方法之一，是将时间离散化为若干区间（bin），并将每个序列表示为一个二进制向量。本练习将探讨汉明距离，一种适用于此类区间化表示的简单度量。通过分析一个微小的时间平移如何影响距离 ，你将亲身体会到基于区间化方法的敏感性及其局限，从而理解为何需要更复杂、时间连续的度量方法。",
            "id": "4019999",
            "problem": "考虑在两次试验（标记为 $x$ 和 $y$）中，对同一刺激响应而记录的两个单神经元脉冲序列。观测窗口的固定时长为 $T=1$ 秒。试验 $x$ 的脉冲时间为 $0.095$ 秒、$0.205$ 秒、$0.499$ 秒、$0.501$ 秒和 $0.905$ 秒。试验 $y$ 的脉冲时间为 $0.005$ 秒、$0.215$ 秒、$0.500$ 秒和 $0.890$ 秒。通过将区间 $[0,T)$ 划分为 10 个宽度为 $\\Delta=0.1$ 秒的等宽的箱，为每次试验构建二值化分箱脉冲序列。使用左闭右开的箱区间 $[k\\Delta,(k+1)\\Delta)$，其中 $k=0,1,\\dots,9$。如果一个箱包含来自相应试验的一个或多个脉冲，则该箱的值为 $1$，否则为 $0$。经过任何变换后，落在 $[0,T)$ 之外的脉冲将被丢弃。\n\n计算 $x$ 和 $y$ 得到的二值化分箱脉冲序列之间的汉明距离。然后，考虑 $x$ 的一个变换版本，其中每个脉冲时间都向前（向右）平移一个恒定的偏移量 $\\epsilon \\in [0,0.1)$ 秒。如上所述，为平移后的 $x$ 重构二值化分箱脉冲序列，并令 $D(\\epsilon)$ 表示平移后的 $x$ 与原始 $y$ 之间的汉明距离。请给出在 $0 \\le \\epsilon  0.1$ 范围内 $D(\\epsilon)$ 的完全简化的分段解析表达式，该表达式能明确地反映出由于平移导致脉冲穿过箱边界时汉明距离如何变化。最终答案必须是单个闭式表达式。本题无需四舍五入。答案中出现的任何数值都应与此处给出的脉冲时间和箱宽完全一致。",
            "solution": "该问题要求我们给出一个关于汉明距离 $D(\\epsilon)$ 的分段解析表达式。该汉明距离是两个分箱脉冲序列之间的距离，其中一个脉冲序列被施加了时间平移 $\\epsilon$。观测窗口为 $T=1$ 秒，被划分为 10 个宽度为 $\\Delta = 0.1$ 秒的箱。\n\n首先，我们确定固定的参考脉冲序列。试验 $y$ 的脉冲时间为 $S_y = \\{0.005, 0.215, 0.500, 0.890\\}$。箱区间为 $[k\\Delta, (k+1)\\Delta)$，其中 $k \\in \\{0, 1, \\dots, 9\\}$。位于时间 $t$ 的脉冲落入箱 $k = \\lfloor t/\\Delta \\rfloor = \\lfloor 10t \\rfloor$。\n\n对脉冲序列 $y$ 进行分箱：\n- 脉冲在 $t=0.005$：$k = \\lfloor 10 \\times 0.005 \\rfloor = \\lfloor 0.05 \\rfloor = 0$。\n- 脉冲在 $t=0.215$：$k = \\lfloor 10 \\times 0.215 \\rfloor = \\lfloor 2.15 \\rfloor = 2$。\n- 脉冲在 $t=0.500$：$k = \\lfloor 10 \\times 0.500 \\rfloor = \\lfloor 5.00 \\rfloor = 5$。\n- 脉冲在 $t=0.890$：$k = \\lfloor 10 \\times 0.890 \\rfloor = \\lfloor 8.90 \\rfloor = 8$。\n\n试验 $y$ 中包含脉冲的箱的集合是 $\\{0, 2, 5, 8\\}$。这得到了二值化分箱向量 $y_{\\text{binned}}$，它在整个问题中保持不变：\n$$y_{\\text{binned}} = (1, 0, 1, 0, 0, 1, 0, 0, 1, 0)$$\n\n接下来，我们考虑脉冲序列 $x$，它被一个时间偏移量 $\\epsilon \\in [0, 0.1)$ 平移。$x$ 的原始脉冲时间为 $S_x = \\{0.095, 0.205, 0.499, 0.501, 0.905\\}$。平移后的脉冲时间为 $t'_i = t_i^x + \\epsilon$。我们将得到的分箱向量表示为 $x'_{\\text{binned}}(\\epsilon)$。汉明距离 $D(\\epsilon)$ 是 $x'_{\\text{binned}}(\\epsilon)$ 和 $y_{\\text{binned}}$ 之间不同的位置数。\n\n$D(\\epsilon)$ 是一个阶跃函数，其值仅在平移后的脉冲 $t'_i$ 穿过箱边界时才发生改变。边界位于每个 $\\Delta=0.1$ 的倍数处。当 $t_i^x + \\epsilon = k\\Delta$（对于某个整数 $k$）时，就会发生穿越。我们需要找到在 $[0, 0.1)$ 范围内发生这些穿越的临界值 $\\epsilon$。\n\n- 脉冲 $t_1^x = 0.095$：当 $0.095 + \\epsilon = 0.1$ 时穿过边界 $0.1$，因此 $\\epsilon = 0.005$。\n- 脉冲 $t_2^x = 0.205$：当 $0.205 + \\epsilon = 0.3$ 时穿过边界 $0.3$，因此 $\\epsilon = 0.095$。\n- 脉冲 $t_3^x = 0.499$：当 $0.499 + \\epsilon = 0.5$ 时穿过边界 $0.5$，因此 $\\epsilon = 0.001$。\n- 脉冲 $t_4^x = 0.501$：当 $0.501 + \\epsilon = 0.6$ 时穿过边界 $0.6$，因此 $\\epsilon = 0.099$。\n- 脉冲 $t_5^x = 0.905$：当 $0.905 + \\epsilon = 1.0$ 时穿过边界 $1.0$（观测窗口的末端），因此 $\\epsilon = 0.095$。在 $t=1.0$ 或之后出现的脉冲将被丢弃。\n\n按升序排列，$\\epsilon$ 的不同临界值为 $0.001$、$0.005$、$0.095$ 和 $0.099$。这些值将区间 $[0, 0.1)$ 划分为五个子区间。我们现在将为每个子区间计算 $D(\\epsilon)$。\n\n**1. 区间：$0 \\le \\epsilon  0.001$**\n此时没有脉冲穿过边界。$x$ 的脉冲落入其原始箱中：\n- $t=0.095 \\to k=0$。\n- $t=0.205 \\to k=2$。\n- $t=0.499 \\to k=4$。\n- $t=0.501 \\to k=5$。\n- $t=0.905 \\to k=9$。\n$x'$ 的活动箱集合为 $\\{0, 2, 4, 5, 9\\}$。所以，$x'_{\\text{binned}}(\\epsilon) = (1, 0, 1, 0, 1, 1, 0, 0, 0, 1)$。\n与 $y_{\\text{binned}} = (1, 0, 1, 0, 0, 1, 0, 0, 1, 0)$ 比较，不匹配发生在箱 $4$、$8$ 和 $9$。\n因此，$D(\\epsilon) = 3$。\n\n**2. 区间：$0.001 \\le \\epsilon  0.005$**\n在 $\\epsilon=0.001$ 时，来自 $t_3^x=0.499$ 的脉冲穿过进入箱 $5$。\n- 箱 $4$ 变为空。其在 $x'_{\\text{binned}}$ 中的值从 $1$ 变为 $0$。\n- 箱 $5$ 已经包含了来自 $t_4^x=0.501$ 的脉冲，因此其在 $x'_{\\text{binned}}$ 中的值保持为 $1$。\n$x'$ 的活动箱集合变为 $\\{0, 2, 5, 9\\}$。所以，$x'_{\\text{binned}}(\\epsilon) = (1, 0, 1, 0, 0, 1, 0, 0, 0, 1)$。\n与 $y_{\\text{binned}}$ 比较，不匹配发生在箱 $8$ 和 $9$。\n因此，$D(\\epsilon) = 2$。\n\n**3. 区间：$0.005 \\le \\epsilon  0.095$**\n在 $\\epsilon=0.005$ 时，来自 $t_1^x=0.095$ 的脉冲穿过进入箱 $1$。\n- 箱 $0$ 变为空（$x'_{\\text{binned}}[0]$ 从 $1$ 变为 $0$）。\n- 箱 $1$ 原本为空，现在包含一个脉冲（$x'_{\\text{binned}}[1]$ 从 $0$ 变为 $1$）。\n$x'$ 的活动箱集合变为 $\\{1, 2, 5, 9\\}$。所以，$x'_{\\text{binned}}(\\epsilon) = (0, 1, 1, 0, 0, 1, 0, 0, 0, 1)$。\n与 $y_{\\text{binned}}$ 比较，不匹配发生在箱 $0$、$1$、$8$ 和 $9$。\n因此，$D(\\epsilon) = 4$。\n\n**4. 区间：$0.095 \\le \\epsilon  0.099$**\n在 $\\epsilon=0.095$ 时，两个事件同时发生：\n- 来自 $t_2^x=0.205$ 的脉冲穿过进入箱 $3$。\n- 来自 $t_5^x=0.905$ 的脉冲被平移到 $t \\ge 1.0$ 并被丢弃。\n- 箱 $2$ 变为空（$x'_{\\text{binned}}[2]$ 从 $1$ 变为 $0$）。\n- 箱 $3$ 原本为空，现在变为活动（$x'_{\\text{binned}}[3]$ 从 $0$ 变为 $1$）。\n- 箱 $9$ 变为空（$x'_{\\text{binned}}[9]$ 从 $1$ 变为 $0$）。\n$x'$ 的活动箱集合变为 $\\{1, 3, 5\\}$。所以，$x'_{\\text{binned}}(\\epsilon) = (0, 1, 0, 1, 0, 1, 0, 0, 0, 0)$。\n与 $y_{\\text{binned}}$ 比较，不匹配发生在箱 $0$、$1$、$2$、$3$ 和 $8$。\n因此，$D(\\epsilon) = 5$。\n\n**5. 区间：$0.099 \\le \\epsilon  0.1$**\n在 $\\epsilon=0.099$ 时，来自 $t_4^x=0.501$ 的脉冲穿过进入箱 $6$。\n- 箱 $5$ 保持活动状态，因为它仍然包含来自 $t_3^x=0.499$ 的平移后的脉冲（例如，当 $\\epsilon=0.099$ 时，$0.499+0.099 = 0.598$，在箱 $5$ 中）。\n- 箱 $6$ 原本为空，现在变为活动（$x'_{\\text{binned}}[6]$ 从 $0$ 变为 $1$）。\n$x'$ 的活动箱集合变为 $\\{1, 3, 5, 6\\}$。所以，$x'_{\\text{binned}}(\\epsilon) = (0, 1, 0, 1, 0, 1, 1, 0, 0, 0)$。\n与 $y_{\\text{binned}}$ 比较，不匹配发生在箱 $0$、$1$、$2$、$3$、$6$ 和 $8$。\n因此，$D(\\epsilon) = 6$。\n\n综合这些结果，我们得到了在区间 $0 \\le \\epsilon  0.1$ 上 $D(\\epsilon)$ 的分段解析表达式：\n$D(\\epsilon) = \\begin{cases} 3  \\text{ if } 0 \\le \\epsilon  0.001 \\\\ 2  \\text{ if } 0.001 \\le \\epsilon  0.005 \\\\ 4  \\text{ if } 0.005 \\le \\epsilon  0.095 \\\\ 5  \\text{ if } 0.095 \\le \\epsilon  0.099 \\\\ 6  \\text{ if } 0.099 \\le \\epsilon  0.1 \\end{cases}$\n这就是最终的简化表达式。",
            "answer": "$$\n\\boxed{\nD(\\epsilon) = \\begin{cases} 3  \\text{如果 } 0 \\le \\epsilon  0.001 \\\\ 2  \\text{如果 } 0.001 \\le \\epsilon  0.005 \\\\ 4  \\text{如果 } 0.005 \\le \\epsilon  0.095 \\\\ 5  \\text{如果 } 0.095 \\le \\epsilon  0.099 \\\\ 6  \\text{如果 } 0.099 \\le \\epsilon  0.1 \\end{cases}\n}\n$$"
        },
        {
            "introduction": "超越简单的区间化方法，Victor-Purpura (VP) 距离通过计算将一个脉冲序列转换为另一个所需的最小“成本”，提供了一种更精细的比较方式。本练习  要求你通过一个小型实例，手动找出一系列最优的编辑操作——包括脉冲平移、插入和删除。这一过程将帮助你建立关于成本参数 $q$ 的作用以及这种强大的编辑距离度量所涉及的基本权衡的关键直觉。",
            "id": "4019961",
            "problem": "考虑两个脉冲序列，$x=\\{0.1,\\,0.5,\\,0.9\\}$ 和 $y=\\{0.12,\\,0.52\\}$，其脉冲时间以秒为单位。任务是使用 Victor–Purpura (VP) 脉冲序列度量来比较这些神经响应，该度量定义如下。VP 度量 $d_{q}(x,y)$ 是将 $x$ 转换为 $y$ 的所有编辑操作序列中的最小总代价，其中允许的操作有：(i) 删除一个脉冲，代价为 $1$；(ii) 插入一个脉冲，代价为 $1$；(iii) 将一个脉冲从时间 $t$ 移动到时间 $t'$，代价为 $q\\,|t-t'|$。此处 $q$ 是一个正参数，其单位为逆时间单位，因此移动代价是无量纲的。总代价是编辑路径中各单个操作的代价之和，而度量 $d_{q}(x,y)$ 是所有有效编辑路径中该总代价的最小值。\n\n根据这些定义，通过明确找出一个将 $x$ 转换为 $y$ 的最优编辑路径并计算其总代价，来确定当 $q=10$（单位为 $\\text{s}^{-1}$）时度量 $d_{q}(x,y)$ 的值。在你的推理过程中，请论证所找出的路径在所有可能的编辑路径中是最优的。将最终答案表示为一个无量纲的实数。无需四舍五入，且最终答案不带单位。",
            "solution": "问题是计算两个给定的脉冲序列 $x=\\{0.1, 0.5, 0.9\\}$ 和 $y=\\{0.12, 0.52\\}$ 的 Victor–Purpura (VP) 脉冲序列度量 $d_q(x, y)$，其中参数 $q=10\\,\\text{s}^{-1}$。脉冲时间以秒为单位。\n\nVP 度量 $d_q(x, y)$ 定义为使用三类操作将脉冲序列 $x$ 转换为脉冲序列 $y$ 的最小总代价：\n1.  删除一个脉冲，代价为 $1$。\n2.  插入一个脉冲，代价为 $1$。\n3.  将一个脉冲从时间 $t_i$ 移动到时间 $t_j$，代价为 $q|t_i - t_j|$。\n\n由于代价参数 $q$ 的单位是 $\\text{s}^{-1}$，时间差的单位是 $\\text{s}$，因此移动一个脉冲的代价是无量纲的，这与插入和删除的代价相一致。\n\n序列 $x$ 中的脉冲数量为 $N_x = 3$，序列 $y$ 中的脉冲数量为 $N_y = 2$。任何将 $x$ 转换为 $y$ 的操作序列都可以分解为一组移动、删除和插入操作。设 $k$ 是从 $x$ 中“移动”到 $y$ 中成为脉冲的数量。这对应于在 $x$ 的脉冲和 $y$ 的脉冲之间建立 $k$ 个配对。这样的配对数量受限于 $0 \\le k \\le \\min(N_x, N_y)$，所以 $k$ 可以是 $0$、$1$ 或 $2$。\n\n对于给定的 $k$ 次移动， $x$ 中剩余的 $N_x - k$ 个脉冲必须被删除，而 $y$ 中剩余的 $N_y - k$ 个脉冲必须被插入。包含 $k$ 次移动的特定转换路径的总代价是这些操作的代价之和。我们可以通过找出每个可能的 $k$ 值对应的最小代价，然后在这些情况中取最小值，来得到总体最小代价 $d_q(x,y)$。\n\n具有 $k$ 次移动的路径的总代价由下式给出：\n$$\nC_k = (\\text{cost of } k \\text{ moves}) + (N_x - k) \\times (\\text{cost of a deletion}) + (N_y - k) \\times (\\text{cost of an insertion})\n$$\n代入给定值 $N_x=3$，$N_y=2$，以及删除/插入的代价为 $1$：\n$$\nC_k = (\\text{cost of } k \\text{ moves}) + (3 - k) \\cdot 1 + (2 - k) \\cdot 1 = (\\text{cost of } k \\text{ moves}) + 5 - 2k\n$$\n我们现在分析每种 $k$ 的情况。\n\n情况 1：$k=0$ 次移动。\n这对应于删除 $x$ 中的所有脉冲并插入 $y$ 中的所有脉冲。\n代价为 $C_0 = (3 - 0) \\times 1 + (2 - 0) \\times 1 = 3 + 2 = 5$。\n\n情况 2：$k=1$ 次移动。\n这对应于将 $x$ 中的一个脉冲移动到 $y$ 中，删除 $x$ 中另外两个脉冲，并插入 $y$ 中另一个脉冲。总代价为：\n$$\nC_1 = q|x_i - y_j| + (3 - 1) + (2 - 1) = q|x_i - y_j| + 2 + 1 = q|x_i - y_j| + 3\n$$\n我们寻求最小代价，因此必须在所有可能的脉冲对 $(x_i, y_j)$ 上找到最小移动代价 $q|x_i - y_j|$。当 $q=10$ 时：\n- 移动 $x_1=0.1$ 到 $y_1=0.12$：代价 = $10|0.1 - 0.12| + 3 = 10(0.02) + 3 = 0.2 + 3 = 3.2$。\n- 移动 $x_1=0.1$ 到 $y_2=0.52$：代价 = $10|0.1 - 0.52| + 3 = 10(0.42) + 3 = 4.2 + 3 = 7.2$。\n- 移动 $x_2=0.5$ 到 $y_1=0.12$：代价 = $10|0.5 - 0.12| + 3 = 10(0.38) + 3 = 3.8 + 3 = 6.8$。\n- 移动 $x_2=0.5$ 到 $y_2=0.52$：代价 = $10|0.5 - 0.52| + 3 = 10(0.02) + 3 = 0.2 + 3 = 3.2$。\n- 移动 $x_3=0.9$ 到 $y_1=0.12$：代价 = $10|0.9 - 0.12| + 3 = 10(0.78) + 3 = 7.8 + 3 = 10.8$。\n- 移动 $x_3=0.9$ 到 $y_2=0.52$：代价 = $10|0.9 - 0.52| + 3 = 10(0.38) + 3 = 3.8 + 3 = 6.8$。\n$k=1$ 时的最小代价是 $3.2$。\n\n情况 3：$k=2$ 次移动。\n这对应于将 $x$ 中的两个脉冲移动到 $y$ 中的两个脉冲，并删除 $x$ 中剩余的一个脉冲。插入次数为 $N_y-k=2-2=0$。总代价为：\n$$\nC_2 = (\\text{cost of 2 moves}) + (3 - 2) + (2 - 2) = (\\text{cost of 2 moves}) + 1\n$$\n为找到这种情况下的最小代价，我们必须考虑删除 $x$ 中的哪个脉冲，以及剩下的两个脉冲如何与 $y$ 中的脉冲配对。\n\n子情况 3a：删除 $x_1=0.1$。$x$ 中剩余的脉冲是 $\\{0.5, 0.9\\}$，需与 $\\{0.12, 0.52\\}$ 配对。\n- 配对 $0.5 \\to 0.12$ 和 $0.9 \\to 0.52$：代价 = $1 + 10|0.5 - 0.12| + 10|0.9 - 0.52| = 1 + 3.8 + 3.8 = 8.6$。\n- 配对 $0.5 \\to 0.52$ 和 $0.9 \\to 0.12$：代价 = $1 + 10|0.5 - 0.52| + 10|0.9 - 0.12| = 1 + 0.2 + 7.8 = 9.0$。\n这个子情况的最小代价是 $8.6$。\n\n子情况 3b：删除 $x_2=0.5$。$x$ 中剩余的脉冲是 $\\{0.1, 0.9\\}$，需与 $\\{0.12, 0.52\\}$ 配对。\n- 配对 $0.1 \\to 0.12$ 和 $0.9 \\to 0.52$：代价 = $1 + 10|0.1 - 0.12| + 10|0.9 - 0.52| = 1 + 0.2 + 3.8 = 5.0$。\n- 配对 $0.1 \\to 0.52$ 和 $0.9 \\to 0.12$：代价 = $1 + 10|0.1 - 0.52| + 10|0.9 - 0.12| = 1 + 4.2 + 7.8 = 13.0$。\n这个子情况的最小代价是 $5.0$。\n\n子情况 3c：删除 $x_3=0.9$。$x$ 中剩余的脉冲是 $\\{0.1, 0.5\\}$，需与 $\\{0.12, 0.52\\}$ 配对。\n- 配对 $0.1 \\to 0.12$ 和 $0.5 \\to 0.52$：代价 = $1 + 10|0.1 - 0.12| + 10|0.5 - 0.52| = 1 + 0.2 + 0.2 = 1.4$。\n- 配对 $0.1 \\to 0.52$ 和 $0.5 \\to 0.12$：代价 = $1 + 10|0.1 - 0.52| + 10|0.5 - 0.12| = 1 + 4.2 + 3.8 = 9.0$。\n这个子情况的最小代价是 $1.4$。\n\n$k=2$ 情况下的最小代价是 $\\{8.6, 5.0, 1.4\\}$ 中的最小值，即 $1.4$。\n\n为了找到全局最小代价 $d_{10}(x,y)$，我们比较为每个 $k$ 值找到的最小代价：\n- $k=0$ 的最小代价：$5.0$。\n- $k=1$ 的最小代价：$3.2$。\n- $k=2$ 的最小代价：$1.4$。\n\n总体最小值是 $1.4$。这个代价是通过一条包含两次移动和一次删除的编辑路径实现的。\n具体的最优编辑路径是：\n1.  将 $t=0.1$ 处的脉冲移动到 $t=0.12$。代价为 $q|0.1 - 0.12| = 10 \\times 0.02 = 0.2$。\n2.  将 $t=0.5$ 处的脉冲移动到 $t=0.52$。代价为 $q|0.5 - 0.52| = 10 \\times 0.02 = 0.2$。\n3.  删除 $t=0.9$ 处的脉冲。代价为 $1$。\n\n这条路径的总代价是 $0.2 + 0.2 + 1 = 1.4$。这种对所有可能的转换结构（$k=0, 1, 2$ 次移动）进行系统性枚举并找出每种情况的最小代价的方法，保证了 $1.4$ 是所有可能编辑路径中的最小总代价。因此，Victor-Purpura 距离是 $1.4$。",
            "answer": "$$\\boxed{1.4}$$"
        },
        {
            "introduction": "除了基于编辑的方法，另一种思路是将脉冲序列视为信号。van Rossum 距离将此概念形式化，它通过一个指数核函数对脉冲序列进行滤波，并测量生成的连续函数之间的差异。本练习  将引导你从第一性原理出发，推导出该度量的最终计算形式。通过深入剖析其数学原理，你将清晰地理解信号距离这一抽象概念是如何转化为一个基于脉冲间成对相互作用的具体、实用公式的。",
            "id": "4020002",
            "problem": "记录了两个单个神经元对同一刺激的响应，产生了两个脉冲序列。设神经元 $x$ 的脉冲序列为脉冲时间的有序集合 $x=\\{0.1,0.4\\}$，神经元 $y$ 的脉冲序列为 $y=\\{0.15,0.6\\}$，所有时间单位均为秒。为比较这两个脉冲序列，使用从第一性原理定义的 van Rossum 距离 $d_{\\tau}$，定义如下。将每个脉冲序列表示为狄拉克δ函数之和，并用时间常数为 $\\tau$ 的指数核对其进行滤波。具体而言，设指数核为 $h_{\\tau}(t)=\\exp(-t/\\tau)\\,H(t)$，其中 $H(t)$ 是亥维赛德阶跃函数。定义滤波后的信号为 $f_{x}(t)=\\sum_{t_{i}\\in x}h_{\\tau}(t-t_{i})$ 和 $f_{y}(t)=\\sum_{s_{j}\\in y}h_{\\tau}(t-s_{j})$。van Rossum 距离是这些滤波后信号的平方差经时间常数归一化后的平方根：\n$$\nd_{\\tau}=\\left(\\frac{1}{\\tau}\\int_{-\\infty}^{\\infty}\\left(f_{x}(t)-f_{y}(t)\\right)^{2}\\,\\mathrm{d}t\\right)^{1/2}.\n$$\n仅从这些定义出发，不使用任何预先推导的快捷公式，进行推导，将该积分简化为脉冲之间成对的指数重叠项的显式表达式，分别列出序列内和序列间的贡献，然后计算当 $\\tau=0.05$ 秒时 $d_{\\tau}$ 的数值。将 $d_{\\tau}$ 报告为无量纲量。将最终数值答案四舍五入至六位有效数字。",
            "solution": "问题要求计算两个脉冲序列 $x=\\{t_1, t_2\\} = \\{0.1, 0.4\\}$ 和 $y=\\{s_1, s_2\\} = \\{0.15, 0.6\\}$ 之间的 van Rossum 距离 $d_{\\tau}$，给定的时间常数为 $\\tau=0.05$ 秒。推导必须从所给定的第一性原理开始。\n\nvan Rossum 距离的平方定义为：\n$$\nd_{\\tau}^2 = \\frac{1}{\\tau} \\int_{-\\infty}^{\\infty} (f_{x}(t) - f_{y}(t))^2 \\mathrm{d}t\n$$\n其中 $f_{x}(t)$ 和 $f_{y}(t)$ 是用指数核 $h_{\\tau}(t) = \\exp(-t/\\tau)H(t)$ 滤波后的脉冲序列。这里，$H(t)$ 是亥维赛德阶跃函数，当 $t \\ge 0$ 时为 $1$，当 $t  0$ 时为 $0$。\n\n首先，我们展开被积函数中的平方项：\n$$\n(f_{x}(t) - f_{y}(t))^2 = f_{x}(t)^2 - 2f_{x}(t)f_{y}(t) + f_{y}(t)^2\n$$\n因此，该积分可以分为三个部分：\n$$\nd_{\\tau}^2 = \\frac{1}{\\tau} \\left[ \\int_{-\\infty}^{\\infty} f_{x}(t)^2 \\mathrm{d}t - 2\\int_{-\\infty}^{\\infty} f_{x}(t)f_{y}(t) \\mathrm{d}t + \\int_{-\\infty}^{\\infty} f_{y}(t)^2 \\mathrm{d}t \\right]\n$$\n滤波后的信号由 $f_{x}(t) = \\sum_{t_i \\in x} h_{\\tau}(t-t_i)$ 和 $f_{y}(t) = \\sum_{s_j \\in y} h_{\\tau}(t-s_j)$ 给出。我们来分析积分的一般形式。这些积分由成对的核卷积之和组成。其基本构件是两个核乘积的积分，一个核的中心在时间 $t_a$，另一个在时间 $t_b$：\n$$\nI(t_a, t_b) = \\int_{-\\infty}^{\\infty} h_{\\tau}(t-t_a) h_{\\tau}(t-t_b) \\mathrm{d}t\n$$\n代入 $h_{\\tau}(t)$ 的定义：\n$$\nI(t_a, t_b) = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{t-t_a}{\\tau}\\right) H(t-t_a) \\exp\\left(-\\frac{t-t_b}{\\tau}\\right) H(t-t_b) \\mathrm{d}t\n$$\n亥维赛德函数之积 $H(t-t_a)H(t-t_b)$ 仅在 $t \\ge t_a$ 和 $t \\ge t_b$ 同时成立时非零。这等价于 $t \\ge \\max(t_a, t_b)$，因此该乘积等于 $H(t - \\max(t_a, t_b))$。积分的下限变为 $\\max(t_a, t_b)$。\n$$\nI(t_a, t_b) = \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{t-t_a}{\\tau}\\right) \\exp\\left(-\\frac{t-t_b}{\\tau}\\right) \\mathrm{d}t\n$$\n$$\nI(t_a, t_b) = \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t - t_a - t_b}{\\tau}\\right) \\mathrm{d}t = \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\mathrm{d}t\n$$\n进行积分：\n$$\n\\int_{\\max(t_a, t_b)}^{\\infty} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\mathrm{d}t = \\left[ -\\frac{\\tau}{2} \\exp\\left(-\\frac{2t}{\\tau}\\right) \\right]_{\\max(t_a, t_b)}^{\\infty} = 0 - \\left( -\\frac{\\tau}{2} \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right) \\right) = \\frac{\\tau}{2} \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right)\n$$\n将此结果代回 $I(t_a, t_b)$ 的表达式中：\n$$\nI(t_a, t_b) = \\exp\\left(\\frac{t_a+t_b}{\\tau}\\right) \\cdot \\frac{\\tau}{2} \\exp\\left(-\\frac{2\\max(t_a, t_b)}{\\tau}\\right) = \\frac{\\tau}{2} \\exp\\left(\\frac{t_a+t_b - 2\\max(t_a, t_b)}{\\tau}\\right)\n$$\n我们使用恒等式 $t_a+t_b = \\min(t_a, t_b) + \\max(t_a, t_b)$，这给出 $t_a+t_b - 2\\max(t_a, t_b) = \\min(t_a, t_b) - \\max(t_a, t_b) = -|t_a-t_b|$。因此，我们得到了基本积分的简化表达式：\n$$\nI(t_a, t_b) = \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_a-t_b|}{\\tau}\\right)\n$$\n现在，我们可以使用这个结果来表示我们公式中 $d_{\\tau}^2$ 的三个积分。\n\n第一个积分（序列 $x$ 内部）：\n$$\n\\int_{-\\infty}^{\\infty} f_{x}(t)^2 \\mathrm{d}t = \\int_{-\\infty}^{\\infty} \\left(\\sum_{t_i \\in x} h_{\\tau}(t-t_i)\\right) \\left(\\sum_{t_k \\in x} h_{\\tau}(t-t_k)\\right) \\mathrm{d}t = \\sum_{t_i \\in x} \\sum_{t_k \\in x} \\int_{-\\infty}^{\\infty} h_{\\tau}(t-t_i)h_{\\tau}(t-t_k) \\mathrm{d}t\n$$\n$$\n\\int_{-\\infty}^{\\infty} f_{x}(t)^2 \\mathrm{d}t = \\sum_{t_i \\in x} \\sum_{t_k \\in x} \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right)\n$$\n第三个积分（序列 $y$ 内部）：\n$$\n\\int_{-\\infty}^{\\infty} f_{y}(t)^2 \\mathrm{d}t = \\sum_{s_j \\in y} \\sum_{s_l \\in y} \\frac{\\tau}{2} \\exp\\left(-\\frac{|s_j-s_l|}{\\tau}\\right)\n$$\n第二个积分（序列 $x$ 和 $y$ 之间）：\n$$\n\\int_{-\\infty}^{\\infty} f_{x}(t)f_{y}(t) \\mathrm{d}t = \\sum_{t_i \\in x} \\sum_{s_j \\in y} \\frac{\\tau}{2} \\exp\\left(-\\frac{|t_i-s_j|}{\\tau}\\right)\n$$\n将这些代回 $d_{\\tau}^2$ 的表达式中，并消去分子和分母中的 $\\tau$：\n$$\nd_{\\tau}^2 = \\frac{1}{2} \\left[ \\sum_{t_i, t_k \\in x} \\exp\\left(-\\frac{|t_i-t_k|}{\\tau}\\right) - 2\\sum_{t_i \\in x, s_j \\in y} \\exp\\left(-\\frac{|t_i-s_j|}{\\tau}\\right) + \\sum_{s_j, s_l \\in y} \\exp\\left(-\\frac{|s_j-s_l|}{\\tau}\\right) \\right]\n$$\n该表达式按要求分开了各项贡献。我们来定义序列内和序列间的项：\n$C_{xx} = \\sum_{t_i, t_k \\in x} \\exp(-|t_i-t_k|/\\tau)$\n$C_{yy} = \\sum_{s_j, s_l \\in y} \\exp(-|s_j-s_l|/\\tau)$\n$C_{xy} = \\sum_{t_i \\in x, s_j \\in y} \\exp(-|t_i-s_j|/\\tau)$\n那么 $d_{\\tau}^2 = \\frac{1}{2}(C_{xx} - 2C_{xy} + C_{yy})$。\n\n现在，我们用给定的脉冲序列 $x=\\{0.1, 0.4\\}$ 和 $y=\\{0.15, 0.6\\}$ 以及 $\\tau=0.05$ 来计算这些项。\n设 $t_1=0.1$, $t_2=0.4$, $s_1=0.15$, $s_2=0.6$。\n\n贡献 $C_{xx}$：\n$$\nC_{xx} = \\exp\\left(-\\frac{|t_1-t_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_1-t_2|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-t_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-t_2|}{\\tau}\\right)\n$$\n$$\nC_{xx} = \\exp(0) + \\exp\\left(-\\frac{|0.1-0.4|}{0.05}\\right) + \\exp\\left(-\\frac{|0.4-0.1|}{0.05}\\right) + \\exp(0)\n$$\n$$\nC_{xx} = 1 + \\exp\\left(-\\frac{0.3}{0.05}\\right) + \\exp\\left(-\\frac{0.3}{0.05}\\right) + 1 = 2 + 2\\exp(-6)\n$$\n贡献 $C_{yy}$：\n$$\nC_{yy} = \\exp\\left(-\\frac{|s_1-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|s_1-s_2|}{\\tau}\\right) + \\exp\\left(-\\frac{|s_2-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|s_2-s_2|}{\\tau}\\right)\n$$\n$$\nC_{yy} = \\exp(0) + \\exp\\left(-\\frac{|0.15-0.6|}{0.05}\\right) + \\exp\\left(-\\frac{|0.6-0.15|}{0.05}\\right) + \\exp(0)\n$$\n$$\nC_{yy} = 1 + \\exp\\left(-\\frac{0.45}{0.05}\\right) + \\exp\\left(-\\frac{0.45}{0.05}\\right) + 1 = 2 + 2\\exp(-9)\n$$\n贡献 $C_{xy}$：\n$$\nC_{xy} = \\exp\\left(-\\frac{|t_1-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_1-s_2|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-s_1|}{\\tau}\\right) + \\exp\\left(-\\frac{|t_2-s_2|}{\\tau}\\right)\n$$\n绝对差值为：\n$|t_1-s_1| = |0.1-0.15|=0.05$\n$|t_1-s_2| = |0.1-0.6|=0.5$\n$|t_2-s_1| = |0.4-0.15|=0.25$\n$|t_2-s_2| = |0.4-0.6|=0.2$\n$$\nC_{xy} = \\exp\\left(-\\frac{0.05}{0.05}\\right) + \\exp\\left(-\\frac{0.5}{0.05}\\right) + \\exp\\left(-\\frac{0.25}{0.05}\\right) + \\exp\\left(-\\frac{0.2}{0.05}\\right)\n$$\n$$\nC_{xy} = \\exp(-1) + \\exp(-10) + \\exp(-5) + \\exp(-4)\n$$\n现在，组合成 $d_{\\tau}^2$：\n$$\nd_{\\tau}^2 = \\frac{1}{2} \\left[ (2 + 2\\exp(-6)) - 2(\\exp(-1) + \\exp(-4) + \\exp(-5) + \\exp(-10)) + (2 + 2\\exp(-9)) \\right]\n$$\n$$\nd_{\\tau}^2 = (1 + \\exp(-6)) - (\\exp(-1) + \\exp(-4) + \\exp(-5) + \\exp(-10)) + (1 + \\exp(-9))\n$$\n$$\nd_{\\tau}^2 = 2 + \\exp(-6) + \\exp(-9) - \\exp(-1) - \\exp(-4) - \\exp(-5) - \\exp(-10)\n$$\n我们计算指数项的数值：\n$\\exp(-1) \\approx 0.36787944$\n$\\exp(-4) \\approx 0.01831564$\n$\\exp(-5) \\approx 0.00673795$\n$\\exp(-6) \\approx 0.00247875$\n$\\exp(-9) \\approx 0.00012341$\n$\\exp(-10) \\approx 0.00004540$\n\n$$\nd_{\\tau}^2 \\approx 2 + 0.00247875 + 0.00012341 - 0.36787944 - 0.01831564 - 0.00673795 - 0.00004540\n$$\n$$\nd_{\\tau}^2 \\approx 2.00260216 - (0.36787944 + 0.01831564 + 0.00673795 + 0.00004540)\n$$\n$$\nd_{\\tau}^2 \\approx 2.00260216 - 0.39297843 = 1.60962373\n$$\n最后，我们通过取平方根来计算距离 $d_{\\tau}$：\n$$\nd_{\\tau} = \\sqrt{1.60962373} \\approx 1.268709476\n$$\n四舍五入到六位有效数字，我们得到 $1.26871$。根据定义，该量是无量纲的。",
            "answer": "$$\n\\boxed{1.26871}\n$$"
        }
    ]
}