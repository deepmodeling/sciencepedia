{
    "hands_on_practices": [
        {
            "introduction": "对视觉系统的任何建模都必须从眼睛的光学特性开始。衍射是限制分辨率的基本物理原理，它为我们能分辨的细节设定了理论上限。本练习  将指导你从第一性原理出发，计算这一衍射极限，从而量化视觉通路中第一个信息瓶颈，为理解空间敏锐度的理论边界奠定基础。",
            "id": "3998486",
            "problem": "在对早期视觉系统的光学进行建模时，一个常见的第一性原理假设是眼睛可视为一个衍射受限的圆形孔径。在波长为 $ \\lambda $ 的单色光照射下，直径为 $ D $ 的圆形孔径的点扩散函数的第一个零点角位置由Rayleigh判据确定，这是标量衍射理论中一个经过充分检验的结果。将衍射受限的截止角空间频率 $ f_{c,\\text{ang}} $ 定义为Rayleigh角的倒数，然后将此角频率转换为“周/度”（cycles per degree）视觉角单位，以表示眼睛光学前端可分辨的正弦光栅的理论上限。使用以下在明视觉条件下符合生理学的人眼参数：瞳孔直径 $ D = 3.5\\,\\text{mm} $ 和波长 $ \\lambda = 550\\,\\text{nm} $。\n\n仅从圆形孔径的Rayleigh判据和方向球面上的空间频率定义出发，推导出以“周/度”为单位的衍射受限截止频率的表达式，并根据这些参数计算其数值。最终答案以“周/度”为单位表示，并四舍五入至四位有效数字。明确说明您使用的任何小角度近似和单位转换。任何中间角量的单位必须是弧度，最终单位必须是“周/度”。",
            "solution": "用户提供了一个问题，要求计算人眼的衍射受限截止空间频率，其中人眼被建模为一个圆形孔径。计算过程必须从Rayleigh判据和问题陈述中提供的截止频率的特定定义开始。\n\n首先，我将验证问题陈述。\n\n### 第1步：提取已知条件\n- 眼睛被建模为直径为 $D$ 的衍射受限圆形孔径。\n- 照明是波长为 $\\lambda$ 的单色光。\n- 点扩散函数的第一个零点的角位置由Rayleigh判据确定。\n- 衍射受限的截止角空间频率 $f_{c,\\text{ang}}$ 被定义为Rayleigh角的倒数。\n- 最终结果的单位必须是“周/度”（cycles per degree）视觉角。\n- 瞳孔直径：$D = 3.5\\,\\text{mm}$。\n- 波长：$\\lambda = 550\\,\\text{nm}$。\n- 上下文是人眼的明视觉条件。\n- 最终数值答案必须四舍五入到四位有效数字。\n- 中间角量的单位必须是弧度。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于光学的基本原理，特别是Fraunhofer衍射和用于分辨率的Rayleigh判据。将眼睛的瞳孔建模为圆形孔径是生理光学中一个标准且有效的一阶近似。给定的参数，瞳孔直径 $D = 3.5\\,\\text{mm}$ 和波长 $\\lambda = 550\\,\\text{nm}$（近似于明视觉光度函数的峰值），对于强光下的人眼是符合生理现实的。该问题具有科学合理性。\n- **适定性**：所有必要的数据（$D$, $\\lambda$）、定义（截止频率为Rayleigh角的倒数）和约束（最终单位、四舍五入）都已提供。该问题是自洽的，并有清晰、唯一的解决路径。\n- **客观性**：该问题以精确、技术性的语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n该问题因其科学合理、适定且客观而是有效的。我将继续进行解答。\n\n解答推导如下。\n\nRayleigh判据指出，由直径为 $D$ 的圆形孔径产生的衍射图样的第一个极小值（Airy函数的第一个零点）出现在角度 $\\theta_R$ 处，其公式为：\n$$\n\\sin(\\theta_R) = 1.22 \\frac{\\lambda}{D}\n$$\n其中 $\\lambda$ 是光的波长。对于像眼睛这样的光学系统，所涉及的角度非常小。因此，我们可以采用小角度近似，即 $\\sin(\\theta) \\approx \\theta$，其中 $\\theta$ 必须以弧度表示。对于在这种情况下遇到的微小角度，该近似非常精确。因此，该判据变为：\n$$\n\\theta_R \\approx 1.22 \\frac{\\lambda}{D}\n$$\n此处，$\\theta_R$ 是以弧度为单位的Rayleigh角。\n\n问题将截止角空间频率 $f_{c,\\text{ang}}$ 定义为此Rayleigh角的倒数：\n$$\nf_{c,\\text{ang}} = \\frac{1}{\\theta_R}\n$$\n代入 $\\theta_R$ 的表达式，我们得到：\n$$\nf_{c,\\text{ang}} = \\frac{1}{1.22 \\frac{\\lambda}{D}} = \\frac{D}{1.22 \\lambda}\n$$\n为使此表达式在量纲上保持一致，$D$ 和 $\\lambda$ 必须使用相同的单位（例如，米）。$f_{c,\\text{ang}}$ 的结果单位是反弧度（弧度$^{-1}$）。由于波的周期是其频率的倒数，这个频率可以被解释为单位是“周/弧度”（cycles per radian）。\n\n问题要求最终答案以“周/度”（cycles per degree）为单位。我们必须进行单位转换。设以“周/度”为单位的频率为 $f_{cpd}$。弧度与度的关系是：\n$$\n\\pi \\text{ 弧度} = 180 \\text{ 度}\n$$\n要将频率从“周/弧度”转换为“周/度”，我们乘以转换因子 $\\frac{\\pi \\text{ 弧度}}{180 \\text{ 度}}$：\n$$\nf_{cpd} \\left[\\frac{\\text{周}}{\\text{度}}\\right] = f_{c,\\text{ang}} \\left[\\frac{\\text{周}}{\\text{弧度}}\\right] \\times \\frac{\\pi \\text{ 弧度}}{180 \\text{ 度}}\n$$\n代入我们得到的 $f_{c,\\text{ang}}$ 表达式，得到以“周/度”为单位的截止频率的完整公式：\n$$\nf_{cpd} = \\frac{D}{1.22 \\lambda} \\frac{\\pi}{180}\n$$\n现在，我们代入给定的数值：\n- $D = 3.5\\,\\text{mm} = 3.5 \\times 10^{-3}\\,\\text{m}$\n- $\\lambda = 550\\,\\text{nm} = 550 \\times 10^{-9}\\,\\text{m}$\n\n$$\nf_{cpd} = \\frac{3.5 \\times 10^{-3}\\,\\text{m}}{1.22 \\times (550 \\times 10^{-9}\\,\\text{m})} \\times \\frac{\\pi}{180}\n$$\n分数中的米（m）单位相互抵消，留下一个无量纲的量，符合预期。\n$$\nf_{cpd} = \\frac{3.5 \\times 10^{-3}}{1.22 \\times 550 \\times 10^{-9}} \\times \\frac{\\pi}{180}\n$$\n$$\nf_{cpd} = \\frac{3.5}{671} \\times 10^{6} \\times \\frac{\\pi}{180}\n$$\n计算数值：\n$$\nf_{cpd} \\approx (0.00521609538...) \\times 10^{6} \\times (0.0174532925...)\n$$\n$$\nf_{cpd} \\approx 5216.09538... \\times 0.0174532925...\n$$\n$$\nf_{cpd} \\approx 91.03710...\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nf_{cpd} \\approx 91.04\n$$\n对于给定的参数，衍射受限的截止空间频率约为 $91.04$ 周/度。",
            "answer": "$$\\boxed{91.04}$$"
        },
        {
            "introduction": "光学系统形成图像后，必须由感光细胞进行采样。这个采样过程并非连续的，因此引入了其自身的限制，特别是可能导致混叠 (aliasing) 失真。本练习  探讨了视网膜感光细胞高效的六边形排列所带来的后果，并推导了相应的奈奎斯特频率，这是理解空间视觉采样极限的关键一步。",
            "id": "3998494",
            "problem": "考虑将脊椎动物视网膜中的光感受器镶嵌建模为像平面上的一个二维六边形（三角形）采样晶格，采样点之间的最近邻间距为 $a$。设相应的实空间原胞晶格矢量选为 $ \\mathbf{a}_{1} = a \\, (1, 0)$ 和 $ \\mathbf{a}_{2} = a \\, \\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right)$，它们生成一个角间距为 $60^{\\circ}$、最近邻距离为 $a$ 的三角形晶格。一个入射的视觉刺激具有空间频率矢量 $\\mathbf{f}$，单位为每单位长度的周期数（例如，视网膜上每度的周期数或每毫米的周期数）。使用采样理论的第一性原理，通过 $\\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2\\pi \\, \\delta_{ij}$ 定义倒易晶格，将第一布里渊区构建为倒易晶格的维格纳-赛兹原胞，并确定最大各向同性无混叠截止（奈奎斯特）频率。具体来说，推导标量截止频率 $f_{c}(a)$ 的一个闭式表达式（单位为每单位长度的周期数），使得任何满足 $\\|\\mathbf{f}\\|  f_{c}(a)$ 的输入在六边形采样下保证不产生混叠。\n\n你的答案必须是 $f_{c}(a)$ 的单个解析表达式，单位为每单位长度的周期数。不要用不等式作为最终答案。无需四舍五入。",
            "solution": "用户希望找到六边形采样晶格的最大各向同性无混叠截止频率。\n\n### 步骤 1：问题陈述的验证\n\n根据指定标准对问题陈述进行验证。\n\n**1. 提取的已知条件：**\n- 光感受器镶嵌被建模为二维六边形（三角形）采样晶格。\n- 最近邻间距为 $a$。\n- 实空间原胞晶格矢量为 $\\mathbf{a}_{1} = a(1, 0)$ 和 $\\mathbf{a}_{2} = a(\\frac{1}{2}, \\frac{\\sqrt{3}}{2})$。\n- 输入刺激具有空间频率矢量 $\\mathbf{f}$，单位为每单位长度的周期数。\n- 倒易晶格由关系式 $\\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2\\pi \\delta_{ij}$ 定义。\n- 第一布里渊区是倒易晶格的维格纳-赛兹原胞。\n- 目标是找到最大各向同性无混叠截止频率 $f_{c}(a)$ 的闭式表达式，其定义为任何满足 $\\|\\mathbf{f}\\|  f_{c}(a)$ 的输入都不会产生混叠。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：**该问题在科学上是合理的。将视网膜的光感受器镶嵌建模为六边形晶格是计算神经科学中一个标准且合理的简化。使用采样理论、倒易晶格和布里渊区来分析混叠是固态物理和信号处理原理的基本且正确的应用。\n- **良定性：**该问题是良定的。它提供了一套完整的定义和约束，足以推导出唯一解。晶格、倒易晶格和截止频率的定义是精确且标准的。\n- **客观性：**问题以客观、正式的语言陈述，没有歧义或主观论断。\n\n**3. 结论与行动：**\n问题被判定为**有效**，因为它具有科学依据、是良定的且客观。将提供详细的解决方案。\n\n### 步骤 2：解的推导\n\n解决方案的步骤是：首先构建倒易晶格，然后确定其第一布里渊区，最后确定可以内切于该区域的最大圆的半径。\n\n**1. 倒易晶格矢量的计算**\n\n实空间原胞晶格矢量由下式给出：\n$$ \\mathbf{a}_{1} = a\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{a}_{2} = a\\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} $$\n倒易晶格矢量 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 由条件 $\\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2\\pi \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 delta 符号。\n\n设 $\\mathbf{b}_{j} = \\begin{pmatrix} b_{j1} \\\\ b_{j2} \\end{pmatrix}$。我们可以求解方程组：\n对于 $j=1$：\n$$ \\mathbf{a}_{1} \\cdot \\mathbf{b}_{1} = a(1)b_{11} + a(0)b_{12} = ab_{11} = 2\\pi $$\n$$ \\mathbf{a}_{2} \\cdot \\mathbf{b}_{1} = a\\left(\\frac{1}{2}\\right)b_{11} + a\\left(\\frac{\\sqrt{3}}{2}\\right)b_{12} = 0 $$\n从第一个方程得到 $b_{11} = \\frac{2\\pi}{a}$。代入第二个方程：\n$$ a\\left(\\frac{1}{2}\\right)\\left(\\frac{2\\pi}{a}\\right) + a\\left(\\frac{\\sqrt{3}}{2}\\right)b_{12} = \\pi + \\frac{a\\sqrt{3}}{2}b_{12} = 0 \\implies b_{12} = -\\frac{2\\pi}{a\\sqrt{3}} $$\n所以，$\\mathbf{b}_{1} = \\frac{2\\pi}{a}\\begin{pmatrix} 1 \\\\ -\\frac{1}{\\sqrt{3}} \\end{pmatrix}$。\n\n对于 $j=2$：\n$$ \\mathbf{a}_{1} \\cdot \\mathbf{b}_{2} = a(1)b_{21} + a(0)b_{22} = ab_{21} = 0 \\implies b_{21} = 0 $$\n$$ \\mathbf{a}_{2} \\cdot \\mathbf{b}_{2} = a\\left(\\frac{1}{2}\\right)b_{21} + a\\left(\\frac{\\sqrt{3}}{2}\\right)b_{22} = 2\\pi $$\n代入 $b_{21}=0$：\n$$ a\\left(\\frac{\\sqrt{3}}{2}\\right)b_{22} = 2\\pi \\implies b_{22} = \\frac{4\\pi}{a\\sqrt{3}} $$\n所以，$\\mathbf{b}_{2} = \\frac{2\\pi}{a}\\begin{pmatrix} 0 \\\\ \\frac{2}{\\sqrt{3}} \\end{pmatrix}$。\n\n**2. 倒易晶格与第一布里渊区**\n\n倒易晶格是所有点 $\\mathbf{G}$ 的集合，这些点由原胞倒易矢量的整数组合给出：$\\mathbf{G} = n_1\\mathbf{b}_1 + n_2\\mathbf{b}_2$，其中 $n_1, n_2 \\in \\mathbb{Z}$。第一布里渊区是该晶格中以原点为中心的维格纳-赛兹原胞。其边界由从原点到最近的倒易晶格点的矢量的垂直平分线构成。因此，我们必须找到最短的非零倒易晶格矢量。\n\n让我们计算 $\\|\\mathbf{b}_1\\|^2$、$\\|\\mathbf{b}_2\\|^2$ 及其简单组合的模的平方：\n$$ \\|\\mathbf{b}_1\\|^2 = \\left(\\frac{2\\pi}{a}\\right)^2 \\left(1^2 + \\left(-\\frac{1}{\\sqrt{3}}\\right)^2\\right) = \\left(\\frac{2\\pi}{a}\\right)^2 \\left(1 + \\frac{1}{3}\\right) = \\frac{16\\pi^2}{3a^2} $$\n$$ \\|\\mathbf{b}_2\\|^2 = \\left(\\frac{2\\pi}{a}\\right)^2 \\left(0^2 + \\left(\\frac{2}{\\sqrt{3}}\\right)^2\\right) = \\left(\\frac{2\\pi}{a}\\right)^2 \\left(\\frac{4}{3}\\right) = \\frac{16\\pi^2}{3a^2} $$\n实空间晶格是三角形的，所以其倒易晶格也是三角形的（六边形）。一个三角形晶格有 6 个最近邻。让我们验证一下像 $\\mathbf{b}_1 + \\mathbf{b}_2$ 这样的其他组合也具有这个最小长度。\n点积为 $\\mathbf{b}_1 \\cdot \\mathbf{b}_2 = \\left(\\frac{2\\pi}{a}\\right)^2 \\left(1 \\cdot 0 + \\left(-\\frac{1}{\\sqrt{3}}\\right)\\left(\\frac{2}{\\sqrt{3}}\\right)\\right) = -\\frac{8\\pi^2}{3a^2}$。\n$$ \\|\\mathbf{b}_1 + \\mathbf{b}_2\\|^2 = \\|\\mathbf{b}_1\\|^2 + \\|\\mathbf{b}_2\\|^2 + 2(\\mathbf{b}_1 \\cdot \\mathbf{b}_2) = \\frac{16\\pi^2}{3a^2} + \\frac{16\\pi^2}{3a^2} + 2\\left(-\\frac{8\\pi^2}{3a^2}\\right) = \\frac{16\\pi^2}{3a^2} $$\n矢量 $\\pm \\mathbf{b}_1$、$\\pm \\mathbf{b}_2$ 和 $\\pm(\\mathbf{b}_1 + \\mathbf{b}_2)$ 构成一个包含六个矢量的集合，它们的模平方都等于 $\\frac{16\\pi^2}{3a^2}$。这些是倒易晶格中离原点最近的六个邻居。这些最短倒易晶格矢量的模为：\n$$ G_{\\min} = \\sqrt{\\frac{16\\pi^2}{3a^2}} = \\frac{4\\pi}{a\\sqrt{3}} $$\n第一布里渊区是一个正六边形，其边是这六个矢量的垂直平分线。\n\n**3. 各向同性无混叠截止频率**\n\n无混叠频率的区域是第一布里渊区。问题要求最大的*各向同性*无混叠截止频率 $f_c$。这对应于找到一个以原点为中心、且完全包含在第一布里渊区内的最大圆形区域。对于正六边形，这就是其内切圆。\n\n内切圆的半径是中心（原点）到边界的最短距离。这个距离恰好是最短倒易晶格矢量模的一半：\n$$ F_c = \\frac{1}{2} G_{\\min} = \\frac{1}{2} \\left(\\frac{4\\pi}{a\\sqrt{3}}\\right) = \\frac{2\\pi}{a\\sqrt{3}} $$\n这个截止频率 $F_c$ 是一个角频率，单位是弧度/单位长度。\n\n**4. 转换为每单位长度的周期数**\n\n问题要求以每单位长度的周期数表示的频率 $f_c(a)$。角频率 $F$（单位：弧度/长度）和空间频率 $f$（单位：周期/长度）之间的关系是 $F = 2\\pi f$。\n因此，我们将 $F_c$ 转换为 $f_c(a)$：\n$$ f_c(a) = \\frac{F_c}{2\\pi} = \\frac{1}{2\\pi} \\left(\\frac{2\\pi}{a\\sqrt{3}}\\right) = \\frac{1}{a\\sqrt{3}} $$\n这就是最近邻间距为 $a$ 的六边形晶格的各向同性奈奎斯特频率的最终表达式。任何空间频率 $\\|\\mathbf{f}\\|$ 小于 $f_c(a)=\\frac{1}{a\\sqrt{3}}$ 的正弦刺激都保证不会引起混叠。\n这也可以写成：\n$$ f_c(a) = \\frac{\\sqrt{3}}{3a} $$\n然而，形式 $\\frac{1}{a\\sqrt{3}}$ 更为直接。",
            "answer": "$$ \\boxed{\\frac{1}{a\\sqrt{3}}} $$"
        },
        {
            "introduction": "从采样到神经处理，视觉系统中的神经元不仅仅是信号的中继站，它们还执行复杂的计算。子单元模型是理解非线性（如整流效应）如何产生复杂响应特性的经典框架，这些特性对于特征检测至关重要。本练习  将通过一个具体的计算，演示非线性如何从一个简单的周期性刺激中产生新的频率成分（谐波），从而揭示神经元计算的一个基本原理。",
            "id": "3998468",
            "problem": "考虑一个早期视觉通路神经元的典范亚基模型，该模型具有 $N$ 个相同的、平行的、线性-非线性亚基，通过均匀求和进行汇集，其中 $N$ 是偶数。每个亚基接收一个时间上闪烁的空间棋盘格刺激。具体来说，呈现给亚基 $i$ 的刺激是 $s_{i}(t)=c_{i}\\,A \\cos(\\omega t)$，其中 $A0$ 是对比度幅度，$\\omega0$ 是角频率，$c_{i}\\in\\{+1,-1\\}$ 编码棋盘格的极性：恰好有 $N/2$ 个亚基具有 $c_{i}=+1$（亮格），$N/2$ 个亚基具有 $c_{i}=-1$（暗格）。每个亚基中的线性阶段具有单位增益，静态非线性是线性整流函数 $g(x)=\\max(0,x)$。汇集的输出为\n$$\ny(t)=\\sum_{i=1}^{N} g\\!\\left(s_{i}(t)\\right).\n$$\n\n仅从 $g(x)$ 的定义、三角函数的周期性以及周期为 $T$ 的实函数 $f(t)$ 的傅里叶级数出发，\n$$\nf(t)=\\frac{a_{0}}{2}+\\sum_{n=1}^{\\infty} a_{n}\\cos\\!\\left(\\frac{2\\pi n}{T} t\\right) + \\sum_{n=1}^{\\infty} b_{n}\\sin\\!\\left(\\frac{2\\pi n}{T} t\\right),\n$$\n其系数为\n$$\na_{n}=\\frac{2}{T}\\int_{0}^{T} f(t)\\cos\\!\\left(\\frac{2\\pi n}{T} t\\right)\\,dt, \\quad b_{n}=\\frac{2}{T}\\int_{0}^{T} f(t)\\sin\\!\\left(\\frac{2\\pi n}{T} t\\right)\\,dt,\n$$\n推导 $y(t)$ 在稳态下的谐波成分。\n\n将非线性度 $D$ 定义为角频率为 $2\\omega$ 的二次谐波分量的幅度与 $y(t)$ 的直流（平均）分量之比，该比值从上述余弦-正弦形式表示的 $y(t)$ 的傅里叶级数中计算得出。以单个实数的形式计算 $D$ 的闭式解。不需要数值近似，也不需要单位。将最终答案表示为单个数字。",
            "solution": "问题陈述按如下方式进行严格验证。\n\n**步骤 1：提取已知条件**\n- 模型：一个早期视觉神经元的典范亚基模型。\n- 亚基数量：$N$，一个偶数。\n- 亚基处理：相同的、平行的线性-非线性亚基。\n- 汇集：亚基输出的均匀求和。\n- 对亚基 $i$ 的刺激：$s_{i}(t) = c_{i} A \\cos(\\omega t)$，其中 $A  0$ 且 $\\omega  0$。\n- 棋盘格极性：$c_{i} \\in \\{+1, -1\\}$。\n- 极性分布：恰好 $N/2$ 个亚基具有 $c_i = +1$， $N/2$ 个亚基具有 $c_i = -1$。\n- 线性阶段：单位增益。\n- 非线性：线性整流函数 $g(x) = \\max(0, x)$。\n- 总输出：$y(t) = \\sum_{i=1}^{N} g(s_{i}(t))$。\n- 周期为 $T$ 的函数 $f(t)$ 的傅里叶级数：\n  $f(t) = \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty} a_{n}\\cos(\\frac{2\\pi n}{T} t) + \\sum_{n=1}^{\\infty} b_{n}\\sin(\\frac{2\\pi n}{T} t)$。\n- 傅里叶系数：\n  $a_{n} = \\frac{2}{T}\\int_{0}^{T} f(t)\\cos(\\frac{2\\pi n}{T} t)\\,dt$\n  $b_{n} = \\frac{2}{T}\\int_{0}^{T} f(t)\\sin(\\frac{2\\pi n}{T} t)\\,dt$\n- 非线性度 $D$ 的定义：二次谐波分量（角频率为 $2\\omega$）的幅度与 $y(t)$ 的直流（DC）分量之比。\n- 要求输出：$D$ 作为单个实数。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。它描述了计算神经科学中一个简化但标准的模型（LNP 模型）。所有变量、函数和常数都已明确定义，且前提是自洽的。该任务是基于所提供定义的形式化数学推导，特别是为一个良定义的周期函数计算傅里叶级数系数。问题的结构允许一个唯一、稳定且有意义的解。未检测到与无效性清单相对应的缺陷。\n\n**步骤 3：结论与行动**\n问题有效。开始解答。\n\n神经元模型的总输出由 $N$ 个亚基的输出之和给出：\n$$\ny(t) = \\sum_{i=1}^{N} g(s_{i}(t))\n$$\n亚基 $i$ 的刺激是 $s_{i}(t) = c_{i} A \\cos(\\omega t)$。极性集合 $\\{c_i\\}$ 包含 $N/2$ 个 $+1$ 值和 $N/2$ 个 $-1$ 值。我们可以将求和分为两组：\n$$\ny(t) = \\sum_{i \\text{ with } c_i=+1} g(A \\cos(\\omega t)) + \\sum_{i \\text{ with } c_i=-1} g(-A \\cos(\\omega t))\n$$\n由于每组有 $N/2$ 个亚基，我们得到：\n$$\ny(t) = \\frac{N}{2} g(A \\cos(\\omega t)) + \\frac{N}{2} g(-A \\cos(\\omega t))\n$$\n使用线性整流非线性 $g(x) = \\max(0, x)$ 的定义：\n$$\ny(t) = \\frac{N}{2} \\max(0, A \\cos(\\omega t)) + \\frac{N}{2} \\max(0, -A \\cos(\\omega t))\n$$\n由于 $A  0$，我们可以将其从 $\\max$ 函数中提取出来：\n$$\ny(t) = \\frac{NA}{2} \\left( \\max(0, \\cos(\\omega t)) + \\max(0, -\\cos(\\omega t)) \\right)\n$$\n表达式 $\\max(0, z) + \\max(0, -z)$ 等价于绝对值 $|z|$。因此，输出简化为全波整流余弦函数：\n$$\ny(t) = \\frac{NA}{2} |\\cos(\\omega t)|\n$$\n为了找到 $y(t)$ 的谐波成分，我们必须计算其傅里叶级数。函数 $\\cos(\\omega t)$ 的周期是 $T_{stim} = 2\\pi/\\omega$。然而，函数 $|\\cos(\\omega t)|$ 的周期性使其基本周期为 $T = \\pi/\\omega$。对应的基本角频率是 $\\omega_f = 2\\pi/T = 2\\pi/(\\pi/\\omega) = 2\\omega$。\n\n周期为 $T$ 的函数 $y(t)$ 的傅里叶级数由下式给出：\n$$\ny(t) = \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty} a_{n}\\cos\\left(\\frac{2\\pi n}{T} t\\right) + \\sum_{n=1}^{\\infty} b_{n}\\sin\\left(\\frac{2\\pi n}{T} t\\right)\n$$\n代入 $T = \\pi/\\omega$，级数变为：\n$$\ny(t) = \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty} a_{n}\\cos(2n\\omega t) + \\sum_{n=1}^{\\infty} b_{n}\\sin(2n\\omega t)\n$$\n函数 $y(t) = \\frac{NA}{2} |\\cos(\\omega t)|$ 是一个偶函数，因为 $y(-t) = \\frac{NA}{2} |\\cos(-\\omega t)| = \\frac{NA}{2} |\\cos(\\omega t)| = y(t)$。对于偶函数，所有正弦系数 $b_n$ 均为零。我们只需要计算余弦系数 $a_n$。\n\n$y(t)$ 的直流分量（平均值）是 $\\frac{a_0}{2}$。系数 $a_0$ 计算如下：\n$$\na_0 = \\frac{2}{T} \\int_{0}^{T} y(t) dt = \\frac{2}{\\pi/\\omega} \\int_{0}^{\\pi/\\omega} \\frac{NA}{2} |\\cos(\\omega t)| dt = \\frac{NA\\omega}{\\pi} \\int_{0}^{\\pi/\\omega} |\\cos(\\omega t)| dt\n$$\n令 $u = \\omega t$，则 $du = \\omega dt$。积分限变为 $0$ 到 $\\pi$。\n$$\na_0 = \\frac{NA}{\\pi} \\int_{0}^{\\pi} |\\cos(u)| du = \\frac{NA}{\\pi} \\left( \\int_{0}^{\\pi/2} \\cos(u)du + \\int_{\\pi/2}^{\\pi} [-\\cos(u)]du \\right)\n$$\n$$\na_0 = \\frac{NA}{\\pi} \\left( [\\sin(u)]_{0}^{\\pi/2} - [\\sin(u)]_{\\pi/2}^{\\pi} \\right) = \\frac{NA}{\\pi} \\left( (\\sin(\\pi/2) - \\sin(0)) - (\\sin(\\pi) - \\sin(\\pi/2)) \\right)\n$$\n$$\na_0 = \\frac{NA}{\\pi} \\left( (1 - 0) - (0 - 1) \\right) = \\frac{NA}{\\pi} (1 + 1) = \\frac{2NA}{\\pi}\n$$\n因此，$y(t)$ 的直流分量为：\n$$\n\\text{DC component} = \\frac{a_0}{2} = \\frac{NA}{\\pi}\n$$\n接下来，我们求二次谐波分量的幅度，它对应于角频率 $2\\omega$。在我们的傅里叶级数展开式中，这是 $n=1$ 的项，即 $a_1 \\cos(2\\omega t)$。由于 $a_n$ 可能为负，幅度是 $|a_n|$。我们计算 $a_1$：\n$$\na_1 = \\frac{2}{T} \\int_{0}^{T} y(t) \\cos\\left(\\frac{2\\pi(1)}{T}t\\right) dt = \\frac{NA\\omega}{\\pi} \\int_{0}^{\\pi/\\omega} |\\cos(\\omega t)| \\cos(2\\omega t) dt\n$$\n使用相同的代换 $u = \\omega t$：\n$$\na_1 = \\frac{NA}{\\pi} \\int_{0}^{\\pi} |\\cos(u)| \\cos(2u) du = \\frac{NA}{\\pi} \\left( \\int_{0}^{\\pi/2} \\cos(u)\\cos(2u)du - \\int_{\\pi/2}^{\\pi} \\cos(u)\\cos(2u)du \\right)\n$$\n使用三角恒等式 $\\cos(A)\\cos(B) = \\frac{1}{2}[\\cos(A+B) + \\cos(A-B)]$：\n$$\n\\cos(u)\\cos(2u) = \\frac{1}{2}(\\cos(3u) + \\cos(u))\n$$\n积分变为：\n$$\n\\int \\cos(u)\\cos(2u)du = \\frac{1}{2} \\int (\\cos(3u) + \\cos(u))du = \\frac{1}{2} \\left( \\frac{1}{3}\\sin(3u) + \\sin(u) \\right)\n$$\n让我们计算定积分：\n$$\n\\int_{0}^{\\pi/2} \\cos(u)\\cos(2u)du = \\frac{1}{2}\\left[\\frac{1}{3}\\sin(3u) + \\sin(u)\\right]_{0}^{\\pi/2} = \\frac{1}{2}\\left(\\left(\\frac{1}{3}\\sin\\frac{3\\pi}{2} + \\sin\\frac{\\pi}{2}\\right) - 0\\right) = \\frac{1}{2}\\left(-\\frac{1}{3} + 1\\right) = \\frac{1}{3}\n$$\n$$\n\\int_{\\pi/2}^{\\pi} \\cos(u)\\cos(2u)du = \\frac{1}{2}\\left[\\frac{1}{3}\\sin(3u) + \\sin(u)\\right]_{\\pi/2}^{\\pi} = \\frac{1}{2}\\left(0 - \\left(\\frac{1}{3}\\sin\\frac{3\\pi}{2} + \\sin\\frac{\\pi}{2}\\right)\\right) = -\\frac{1}{2}\\left(-\\frac{1}{3}+1\\right) = -\\frac{1}{3}\n$$\n将这些结果代回 $a_1$ 的表达式中：\n$$\na_1 = \\frac{NA}{\\pi} \\left( \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) \\right) = \\frac{NA}{\\pi} \\left(\\frac{2}{3}\\right) = \\frac{2NA}{3\\pi}\n$$\n由于 $N  0$ 且 $A  0$，$a_1$ 是正的，所以二次谐波的幅度是 $|a_1| = a_1 = \\frac{2NA}{3\\pi}$。\n\n非线性度 $D$ 定义为该幅度与直流分量之比：\n$$\nD = \\frac{\\text{二次谐波的幅度}}{\\text{直流分量}} = \\frac{a_1}{a_0/2}\n$$\n$$\nD = \\frac{\\frac{2NA}{3\\pi}}{\\frac{NA}{\\pi}} = \\frac{2NA}{3\\pi} \\cdot \\frac{\\pi}{NA} = \\frac{2}{3}\n$$\n结果是一个无量纲常数，与刺激参数 $A$ 和 $\\omega$ 以及亚基数量 $N$ 无关。",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        }
    ]
}