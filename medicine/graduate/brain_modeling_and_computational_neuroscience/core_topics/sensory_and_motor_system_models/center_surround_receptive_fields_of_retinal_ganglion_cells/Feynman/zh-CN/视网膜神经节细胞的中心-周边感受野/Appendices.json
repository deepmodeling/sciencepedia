{
    "hands_on_practices": [
        {
            "introduction": "高斯差分 (Difference-of-Gaussians, DoG) 模型是描述中央-周边拮抗性感受野的一个经典且简洁的数学工具。许多视网膜神经节细胞的一个关键特性是它们对均匀光照变化不敏感，这对于凸显对比度和节省代谢能量至关重要。本练习将通过计算来揭示实现这种“平衡”拮抗设计的数学约束条件 ，从而将感受野的结构参数与其核心功能联系起来。",
            "id": "3968078",
            "problem": "视网膜神经节细胞 (RGC) 的中央-周边拮抗结构感受野的常用空间核，在二维视网膜平面上被建模为两个各向同性高斯分量的差。令中央-周边空间核为\n$$\nK(\\mathbf{x}) \\;=\\; A_{c} \\,\\exp\\!\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\,\\sigma_{c}^{2}}\\right)\\;-\\;A_{s}\\,\\exp\\!\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\,\\sigma_{s}^{2}}\\right),\n$$\n其中 $\\mathbf{x}\\in\\mathbb{R}^{2}$ 表示视网膜平面上的位置，$A_{c}>0$ 和 $A_{s}>0$ 是中央和周边的振幅，$\\sigma_{c}>0$ 和 $\\sigma_{s}>0$ 是它们的空间尺度（其中 $\\sigma_{s}>\\sigma_{c}$）。每个高斯函数被定义为在 $\\mathbf{x}=\\mathbf{0}$ 处有单位峰值，并且未被归一化为单位积分。\n\n为了对均匀场进行能量高效编码，需要核函数具有零直流 (DC) 增益，这等价于二维傅里叶变换 $\\hat{K}(\\mathbf{k})$ 满足 $\\hat{K}(\\mathbf{0})=0$。使用二维傅里叶变换的定义\n$$\n\\hat{K}(\\mathbf{k}) \\;=\\; \\int_{\\mathbb{R}^{2}} K(\\mathbf{x})\\,\\exp\\!\\left(-i\\,\\mathbf{k}\\cdot\\mathbf{x}\\right)\\,d^{2}\\mathbf{x},\n$$\n以及关于高斯积分的标准性质，推导在给定 $\\sigma_{c}$ 和 $\\sigma_{s}$ 的情况下，保证 $\\hat{K}(\\mathbf{0})=0$ 所需的对振幅的约束，并表示为无量纲比率 $A_{s}/A_{c}$。\n\n请以 $A_{s}/A_{c}$ 的单个闭式表达式提供您的最终答案。不需要数值近似或四舍五入。答案是无量纲的，因此无需报告单位。",
            "solution": "首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 空间核由 $K(\\mathbf{x}) = A_{c} \\exp(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{c}^{2}}) - A_{s} \\exp(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{s}^{2}})$ 给出。\n- 位置向量为 $\\mathbf{x} \\in \\mathbb{R}^{2}$。\n- 振幅为正：$A_{c} > 0$ 且 $A_{s} > 0$。\n- 空间尺度为正：$\\sigma_{c} > 0$ 且 $\\sigma_{s} > 0$。\n- 周边的范围比中央宽：$\\sigma_{s} > \\sigma_{c}$。\n- 二维傅里叶变换的定义为 $\\hat{K}(\\mathbf{k}) = \\int_{\\mathbb{R}^{2}} K(\\mathbf{x})\\,\\exp(-i\\,\\mathbf{k}\\cdot\\mathbf{x})\\,d^{2}\\mathbf{x}$。\n- 能量高效编码的条件是零直流 (DC) 增益，这等价于 $\\hat{K}(\\mathbf{0}) = 0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用了高斯差分 (DoG) 模型，这是计算神经科学中用于中央-周边感受野的一个标准且成熟的模型。零直流增益的条件是一个常见且有意义的约束，代表对均匀光照不敏感。其数学框架是傅里叶分析，这是恰当的。该问题在科学上和数学上都是合理的。\n- **适定性**：该问题是适定的。它提供了所有必要的定义和约束，以推导出比率 $A_{s}/A_{c}$ 的唯一解。\n- **客观性**：该问题以精确、客观的数学语言陈述。所有术语都是标准的且定义明确。\n- **结论**：该问题没有任何科学、逻辑或结构上的缺陷。它是有效的。\n\n### 步骤 3：结论与行动\n该问题被认定为有效。将推导解答。\n\n目标是找到满足零直流 (DC) 增益条件的比率 $A_{s}/A_{c}$。该条件由 $\\hat{K}(\\mathbf{0}) = 0$ 给出。我们首先在零频率向量 $\\mathbf{k}=\\mathbf{0}$ 处计算傅里叶变换 $\\hat{K}(\\mathbf{k})$。\n\n使用给定的傅里叶变换定义：\n$$\n\\hat{K}(\\mathbf{k}) = \\int_{\\mathbb{R}^{2}} K(\\mathbf{x}) \\exp(-i \\mathbf{k} \\cdot \\mathbf{x}) d^{2}\\mathbf{x}\n$$\n设 $\\mathbf{k} = \\mathbf{0}$，指数项变为 $\\exp(-i\\mathbf{0}\\cdot\\mathbf{x}) = \\exp(0) = 1$。因此，条件 $\\hat{K}(\\mathbf{0})=0$ 简化为要求核函数在整个空间域上的积分为零：\n$$\n\\hat{K}(\\mathbf{0}) = \\int_{\\mathbb{R}^{2}} K(\\mathbf{x}) d^{2}\\mathbf{x} = 0\n$$\n将核函数 $K(\\mathbf{x})$ 的表达式代入此积分中，得到：\n$$\n\\int_{\\mathbb{R}^{2}} \\left[ A_{c} \\exp\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{c}^{2}}\\right) - A_{s} \\exp\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{s}^{2}}\\right) \\right] d^{2}\\mathbf{x} = 0\n$$\n根据积分的线性性质，我们可以将各项分开：\n$$\nA_{c} \\int_{\\mathbb{R}^{2}} \\exp\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{c}^{2}}\\right) d^{2}\\mathbf{x} - A_{s} \\int_{\\mathbb{R}^{2}} \\exp\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{s}^{2}}\\right) d^{2}\\mathbf{x} = 0\n$$\n这意味着中央分量的总加权体积必须等于周边分量的总加权体积：\n$$\nA_{c} \\int_{\\mathbb{R}^{2}} \\exp\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{c}^{2}}\\right) d^{2}\\mathbf{x} = A_{s} \\int_{\\mathbb{R}^{2}} \\exp\\left(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma_{s}^{2}}\\right) d^{2}\\mathbf{x}\n$$\n为了继续，我们必须计算形式为 $I(\\sigma) = \\int_{\\mathbb{R}^{2}} \\exp(-\\frac{\\|\\mathbf{x}\\|^{2}}{2\\sigma^{2}}) d^{2}\\mathbf{x}$ 的二维各向同性高斯函数的广义积分。令 $\\mathbf{x} = (x_{1}, x_{2})$，则 $\\|\\mathbf{x}\\|^{2} = x_{1}^{2} + x_{2}^{2}$。该积分可以分解为两个相同的一维高斯积分的乘积：\n$$\nI(\\sigma) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x_{1}^{2} + x_{2}^{2}}{2\\sigma^{2}}\\right) dx_{1} dx_{2} = \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right) du \\right]^{2}\n$$\n标准高斯定积分为 $\\int_{-\\infty}^{\\infty} \\exp(-a u^{2}) du = \\sqrt{\\pi/a}$。在我们的例子中，常数 $a = \\frac{1}{2\\sigma^{2}}$。因此，一维积分为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{u^{2}}{2\\sigma^{2}}\\right) du = \\sqrt{\\frac{\\pi}{1/(2\\sigma^{2})}} = \\sqrt{2\\pi\\sigma^{2}} = \\sigma\\sqrt{2\\pi}\n$$\n将此结果代回到二维积分 $I(\\sigma)$ 的表达式中：\n$$\nI(\\sigma) = (\\sigma\\sqrt{2\\pi})^{2} = 2\\pi\\sigma^{2}\n$$\n现在我们将此结果应用于我们关联中央和周边分量的方程。中央分量的积分为 $I(\\sigma_{c}) = 2\\pi\\sigma_{c}^{2}$，周边分量的积分为 $I(\\sigma_{s}) = 2\\pi\\sigma_{s}^{2}$。方程变为：\n$$\nA_{c} (2\\pi\\sigma_{c}^{2}) = A_{s} (2\\pi\\sigma_{s}^{2})\n$$\n$2\\pi$ 这个公因子从两边消去，得到振幅和方差之间的关系：\n$$\nA_{c}\\sigma_{c}^{2} = A_{s}\\sigma_{s}^{2}\n$$\n问题要求无量纲比率 $A_{s}/A_{c}$。我们可以通过重新排列上述方程得到：\n$$\n\\frac{A_{s}}{A_{c}} = \\frac{\\sigma_{c}^{2}}{\\sigma_{s}^{2}}\n$$\n此表达式提供了确保核函数具有零直流增益所需的对振幅的约束。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{c}^{2}}{\\sigma_{s}^{2}}}\n$$"
        },
        {
            "introduction": "尽管像DoG这样的线性模型非常强大，但其背后的生物学机制本质上是非线性的。本练习将从抽象的滤波器模型深入到更符合生物物理现实的电导模型，以探究突触抑制在细胞层面是如何实现的。我们将发现，这种被称为“分流抑制”的机制不仅仅是简单的信号相减，它还能动态调节神经元的整体响应性（即增益控制），本练习将通过对比分流抑制模型与简单减法模型的行为，揭示其在对比度编码中的独特计算特性 。",
            "id": "3968098",
            "problem": "考虑一个中央型视网膜神经节细胞 (RGC)，我们使用基于电导的框架在其膜电位水平上对其进行建模。中央兴奋和周围抑制由空间刺激驱动，其中中央的对比度为 $C \\in [0,\\infty)$，周围的对比度为 $S = \\alpha C$，且周围与中央的驱动比 $\\alpha > 0$ 为固定值。假设突触动力学是瞬时的且不存在电压门控电流，稳态膜电位 $V$ 在胞体处遵循 Kirchhoff 电流定律：\n$$\n0 \\;=\\; g_{L}\\left(E_{L} - V\\right) \\;+\\; g_{c}(C)\\left(E_{e} - V\\right) \\;+\\; g_{s}(S)\\left(E_{i} - V\\right),\n$$\n其中 $g_{L}$ 是漏电导，$E_{L}$ 是漏反转电位，$E_{e}$ 是兴奋性突触反转电位，$E_{i}$ 是抑制性突触反转电位，而 $g_{c}(C)$ 和 $g_{s}(S)$ 分别是中央和周围的突触电导。假设对比度到电导的转换为线性关系，$g_{c}(C) = g_{c}^{0}\\,C$ 和 $g_{s}(S) = g_{s}^{0}\\,S = g_{s}^{0}\\,\\alpha C$，其中 $g_{c}^{0} > 0$ 且 $g_{s}^{0} > 0$。\n\n将脉冲输出非线性定义为电压的静态逻辑斯蒂函数，\n$$\nR(V) \\;=\\; \\frac{R_{\\max}}{1 + \\exp\\!\\left(-\\frac{V - V_{0}}{\\kappa}\\right)},\n$$\n其中半激活电压为 $V_{0}$，斜率参数为 $\\kappa > 0$，最大响应为 $R_{\\max}$。根据逻辑斯蒂函数的定义，产生半最大响应的对比度 $C$ 满足 $V(C) = V_{0}$。\n\n一个忽略分流效应的纯减法比较器模型假设，在固定的漏整合之前，周围会减去电流，从而产生一个有效产生电位\n$$\nV_{\\text{sub}}(C) \\;=\\; E_{L} \\;+\\; \\frac{I_{\\text{net}}(C)}{g_{L}}, \\quad I_{\\text{net}}(C) \\;=\\; g_{c}^{0}\\,C\\left(E_{e} - E_{L}\\right) \\;+\\; g_{s}^{0}\\,\\alpha C\\left(E_{i} - E_{L}\\right),\n$$\n并使用相同的逻辑斯蒂函数 $R(V)$，其半最大响应发生在 $V_{\\text{sub}}(C) = V_{0}$ 处。\n\n从给定的生物物理定义和 Kirchhoff 电流定律出发，推导分流模型预测半最大响应时的对比度 $C_{\\frac{1}{2}}^{\\text{shunt}}(g_{s}^{0})$，以及纯减法模型预测半最大响应时的对比度 $C_{\\frac{1}{2}}^{\\text{sub}}(g_{s}^{0})$。然后，对于以下参数集\n- $g_{L} = 6\\,\\mathrm{nS}$，\n- $E_{L} = -65\\,\\mathrm{mV}$，\n- $E_{e} = 0\\,\\mathrm{mV}$，\n- $E_{i} = -70\\,\\mathrm{mV}$，\n- $g_{c}^{0} = 0.8\\,\\mathrm{nS}$，\n- $g_{s}^{0} = 0.6\\,\\mathrm{nS}$，\n- $\\alpha = 1$，\n- $V_{0} = -55\\,\\mathrm{mV}$，\n- $\\kappa > 0$ 为任意值（不影响半最大响应），\n计算比率\n$$\n\\mathcal{R} \\;=\\; \\frac{C_{\\frac{1}{2}}^{\\text{shunt}}(g_{s}^{0})}{C_{\\frac{1}{2}}^{\\text{sub}}(g_{s}^{0})}.\n$$\n将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "基于电导的稳态电压遵循 Kirchhoff 电流定律。使用内向突触电流为正的符号约定，我们将稳态平衡写为\n$$\n0 \\;=\\; g_{L}\\left(E_{L} - V\\right) \\;+\\; g_{c}(C)\\left(E_{e} - V\\right) \\;+\\; g_{s}(S)\\left(E_{i} - V\\right),\n$$\n其中 $g_{c}(C) = g_{c}^{0} C$ 且 $g_{s}(S) = g_{s}^{0}\\,\\alpha C$。整理各项，我们合并 $V$：\n$$\n0 \\;=\\; g_{L} E_{L} - g_{L} V \\;+\\; g_{c}^{0} C\\,E_{e} - g_{c}^{0} C\\,V \\;+\\; g_{s}^{0}\\,\\alpha C\\,E_{i} - g_{s}^{0}\\,\\alpha C\\,V.\n$$\n将关于 $V$ 的线性和不含 $V$ 的项分组，\n$$\n\\left(g_{L} + g_{c}^{0} C + g_{s}^{0}\\,\\alpha C\\right) V \\;=\\; g_{L} E_{L} \\;+\\; g_{c}^{0} C\\,E_{e} \\;+\\; g_{s}^{0}\\,\\alpha C\\,E_{i}.\n$$\n因此，作为对比度 $C$ 函数的稳态电压为\n$$\nV(C) \\;=\\; \\frac{g_{L} E_{L} \\;+\\; C\\left(g_{c}^{0} E_{e} \\;+\\; g_{s}^{0}\\,\\alpha E_{i}\\right)}{g_{L} \\;+\\; C\\left(g_{c}^{0} \\;+\\; g_{s}^{0}\\,\\alpha\\right)}.\n$$\n逻辑斯蒂输出的半最大响应条件是 $V(C_{\\frac{1}{2}}^{\\text{shunt}}) = V_{0}$。对 $V(C) = V_{0}$ 求解 $C$ 可得\n$$\nV_{0}\\left[g_{L} + C\\left(g_{c}^{0} + g_{s}^{0}\\,\\alpha\\right)\\right] \\;=\\; g_{L} E_{L} \\;+\\; C\\left(g_{c}^{0} E_{e} + g_{s}^{0}\\,\\alpha E_{i}\\right).\n$$\n整理以分离出 $C$：\n$$\ng_{L} V_{0} \\;+\\; C\\,V_{0}\\left(g_{c}^{0} + g_{s}^{0}\\,\\alpha\\right) \\;=\\; g_{L} E_{L} \\;+\\; C\\left(g_{c}^{0} E_{e} + g_{s}^{0}\\,\\alpha E_{i}\\right),\n$$\n$$\nC\\left[\\left(g_{c}^{0} E_{e} + g_{s}^{0}\\,\\alpha E_{i}\\right) - V_{0}\\left(g_{c}^{0} + g_{s}^{0}\\,\\alpha\\right)\\right] \\;=\\; g_{L}\\left(V_{0} - E_{L}\\right).\n$$\n因此，\n$$\nC_{\\frac{1}{2}}^{\\text{shunt}}(g_{s}^{0}) \\;=\\; \\frac{g_{L}\\left(V_{0} - E_{L}\\right)}{\\left(g_{c}^{0} E_{e} + g_{s}^{0}\\,\\alpha E_{i}\\right) - V_{0}\\left(g_{c}^{0} + g_{s}^{0}\\,\\alpha\\right)}.\n$$\n\n对于纯减法模型，净突触电流是相对于漏反转电位 $E_{L}$ 计算的，而有效产生电位由固定的漏电导 $g_{L}$ 整合：\n$$\nV_{\\text{sub}}(C) \\;=\\; E_{L} \\;+\\; \\frac{I_{\\text{net}}(C)}{g_{L}}, \\quad I_{\\text{net}}(C) \\;=\\; g_{c}^{0} C \\left(E_{e} - E_{L}\\right) \\;+\\; g_{s}^{0}\\,\\alpha C \\left(E_{i} - E_{L}\\right).\n$$\n施加半最大响应条件 $V_{\\text{sub}}(C_{\\frac{1}{2}}^{\\text{sub}}) = V_{0}$：\n$$\nE_{L} \\;+\\; \\frac{C}{g_{L}}\\left[g_{c}^{0}\\left(E_{e} - E_{L}\\right) \\;+\\; g_{s}^{0}\\,\\alpha\\left(E_{i} - E_{L}\\right)\\right] \\;=\\; V_{0}.\n$$\n求解 $C$：\n$$\nC_{\\frac{1}{2}}^{\\text{sub}}(g_{s}^{0}) \\;=\\; \\frac{g_{L}\\left(V_{0} - E_{L}\\right)}{g_{c}^{0}\\left(E_{e} - E_{L}\\right) + g_{s}^{0}\\,\\alpha\\left(E_{i} - E_{L}\\right)}.\n$$\n\n我们需要计算比率\n$$\n\\mathcal{R} \\;=\\; \\frac{C_{\\frac{1}{2}}^{\\text{shunt}}(g_{s}^{0})}{C_{\\frac{1}{2}}^{\\text{sub}}(g_{s}^{0})}\n$$\n对于指定的参数。代入符号表达式，注意到公共因子 $g_{L}\\left(V_{0} - E_{L}\\right)$ 会被消去：\n$$\n\\mathcal{R} \\;=\\; \\frac{g_{c}^{0}\\left(E_{e} - E_{L}\\right) + g_{s}^{0}\\,\\alpha\\left(E_{i} - E_{L}\\right)}{\\left(g_{c}^{0} E_{e} + g_{s}^{0}\\,\\alpha E_{i}\\right) - V_{0}\\left(g_{c}^{0} + g_{s}^{0}\\,\\alpha\\right)}.\n$$\n\n现在代入给定的数值 $g_{L} = 6\\,\\mathrm{nS}$（该项被消去），$E_{L} = -65\\,\\mathrm{mV}$，$E_{e} = 0\\,\\mathrm{mV}$，$E_{i} = -70\\,\\mathrm{mV}$，$g_{c}^{0} = 0.8\\,\\mathrm{nS}$，$g_{s}^{0} = 0.6\\,\\mathrm{nS}$，$\\alpha = 1$ 和 $V_{0} = -55\\,\\mathrm{mV}$：\n- 计算分子：\n$$\ng_{c}^{0}\\left(E_{e} - E_{L}\\right) + g_{s}^{0}\\left(E_{i} - E_{L}\\right) \\;=\\; 0.8\\cdot(0 - (-65)) \\;+\\; 0.6\\cdot(-70 - (-65)) \\;=\\; 0.8\\cdot 65 \\;+\\; 0.6\\cdot(-5) \\;=\\; 52 \\;-\\; 3 \\;=\\; 49\n$$\n- 计算分母：\n$$\n\\left(g_{c}^{0} E_{e} + g_{s}^{0} E_{i}\\right) - V_{0}\\left(g_{c}^{0} + g_{s}^{0}\\right) \\;=\\; \\left(0.8\\cdot 0 + 0.6\\cdot(-70)\\right) - \\left(-55\\right)\\left(0.8 + 0.6\\right) \\;=\\; -42 \\;+\\; 77 \\;=\\; 35\n$$\n因此，\n$$\n\\mathcal{R} \\;=\\; \\frac{49}{35} \\;=\\; 1.4\n$$\n四舍五入到四位有效数字，该无量纲比率为 $1.400$。",
            "answer": "$$\\boxed{1.400}$$"
        },
        {
            "introduction": "任何模型的最终检验标准是其解释真实数据的能力。本练习将挑战一个核心的“逆问题”：我们如何通过观察神经元对复杂随机刺激的脉冲发放，来估计其感受野的特性？我们将介绍线性-非线性-泊松 (Linear-Nonlinear-Poisson, LNP) 模型这一领域的标准分析框架，并指导你推导出感受野滤波器的最大似然估计 ，这是现代计算神经科学中一项基石性的系统辨识技术。",
            "id": "3968071",
            "problem": "考虑一个具有中央-周边感受野的单个视网膜神经节细胞，其感受野可以很好地通过一个作用于时空白噪声刺激的线性滤波器来近似。设离散时间窗 $t$ 的刺激是一个 $d$ 维向量 $\\mathbf{S}_t \\in \\mathbb{R}^{d}$，代表一个白化的空间斑块及其近期的时间历史，因此感受野由一个向量 $\\mathbf{K} \\in \\mathbb{R}^{d}$ 表示。假设该细胞的脉冲序列是一个非齐次泊松过程，其条件强度为\n$$\n\\lambda_t \\;=\\; \\exp\\!\\big(h \\;+\\; \\mathbf{K}^{\\top}\\mathbf{S}_t\\big),\n$$\n其中 $h \\in \\mathbb{R}$ 是一个标量偏置。您在总记录时间 $T$ 内观测到脉冲时间 $\\{t_i\\}_{i=1}^{n}$，该时间段被划分为 $N$ 个宽度为 $\\Delta$ 的小时间窗，使得 $T = N \\Delta$，且每个时间窗内最多发生一个脉冲。\n\n假设刺激过程在时间上是独立同分布的，其均值为零，协方差为\n$$\n\\mathbb{E}[\\mathbf{S}_t] \\;=\\; \\mathbf{0}, \n\\qquad \n\\lim_{N \\to \\infty}\\frac{\\Delta}{T}\\sum_{t=1}^{N}\\mathbf{S}_t\\mathbf{S}_t^{\\top} \\;=\\; \\mathbf{C},\n$$\n其中 $\\mathbf{C} \\in \\mathbb{R}^{d \\times d}$ 是正定的。定义经验脉冲触发平均\n$$\n\\mathbf{m} \\;=\\; \\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{S}_{t_i}.\n$$\n\n从非齐次泊松过程的对数似然出发，并假设在小滤波器能量范畴内，对时间积分项进行关于 $\\mathbf{K}$ 的二阶泰勒展开是合理的，请推导 $\\hat{\\mathbf{K}}$ 和 $\\hat{h}$ 的闭式最大似然估计，用 $\\mathbf{m}$、$\\mathbf{C}$、$n$ 和 $T$ 表示。您的推导必须从泊松对数似然开始，仅使用上面给出的刺激白化和平稳性属性，并将难以处理的积分项近似到 $\\mathbf{K}^{\\top}\\mathbf{C}\\mathbf{K}$ 的二阶。请以 $\\hat{\\mathbf{K}}$ 和 $\\hat{h}$ 的显式解析表达式形式提供您的最终答案，不含任何未指明的优化步骤。最终答案必须是单个闭式表达式。不需要进行数值四舍五入，也不需要报告单位。",
            "solution": "该问题要求推导一个视网膜神经节细胞的线性-非线性-泊松 (LNP) 模型中滤波器 $\\mathbf{K}$ 和偏置 $h$ 的最大似然估计 (MLEs)。推导从非齐次泊松过程的对数似然函数开始，并按要求采用二阶近似。\n\n条件强度或瞬时发放率由 $\\lambda_t = \\exp(h + \\mathbf{K}^{\\top}\\mathbf{S}_t)$ 给出。脉冲序列在总时间 $T$ 内被观测，该时间段被离散化为 $N$ 个宽度为 $\\Delta$ 的时间窗，其中 $T = N\\Delta$。我们将时间窗 $t$ 内的脉冲数记为 $y_t \\in \\{0, 1\\}$。总脉冲数是 $n = \\sum_{t=1}^{N} y_t$。脉冲时间的集合是 $\\{t_i\\}_{i=1}^{n}$。\n\n在离散时间公式下，观测到该脉冲序列的对数似然 $\\mathcal{L}(\\mathbf{K}, h)$ 由下式给出：\n$$\n\\mathcal{L}(\\mathbf{K}, h) = \\sum_{t=1}^{N} \\left[ y_t \\ln(\\lambda_t) - \\lambda_t \\Delta \\right]\n$$\n这是在小时间窗内近似的泊松过程的标准对数似然。我们可以将第一个求和项改写为对发生脉冲的时间窗（由 $t_i$ 索引）求和：\n$$\n\\mathcal{L}(\\mathbf{K}, h) = \\sum_{i=1}^{n} \\ln(\\lambda_{t_i}) - \\Delta \\sum_{t=1}^{N} \\lambda_t\n$$\n代入给定的 $\\lambda_t$ 形式：\n$$\n\\mathcal{L}(\\mathbf{K}, h) = \\sum_{i=1}^{n} \\ln\\left(\\exp(h + \\mathbf{K}^{\\top}\\mathbf{S}_{t_i})\\right) - \\Delta \\sum_{t=1}^{N} \\exp(h + \\mathbf{K}^{\\top}\\mathbf{S}_t)\n$$\n$$\n\\mathcal{L}(\\mathbf{K}, h) = \\sum_{i=1}^{n} (h + \\mathbf{K}^{\\top}\\mathbf{S}_{t_i}) - \\Delta \\exp(h) \\sum_{t=1}^{N} \\exp(\\mathbf{K}^{\\top}\\mathbf{S}_t)\n$$\n第一项可以简化为：\n$$\n\\sum_{i=1}^{n} (h + \\mathbf{K}^{\\top}\\mathbf{S}_{t_i}) = n h + \\mathbf{K}^{\\top} \\sum_{i=1}^{n} \\mathbf{S}_{t_i}\n$$\n使用经验脉冲触发平均的定义 $\\mathbf{m} = \\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{S}_{t_i}$，我们有 $\\sum_{i=1}^{n}\\mathbf{S}_{t_i} = n\\mathbf{m}$。对数似然变为：\n$$\n\\mathcal{L}(\\mathbf{K}, h) = n h + n \\mathbf{K}^{\\top}\\mathbf{m} - \\Delta \\exp(h) \\sum_{t=1}^{N} \\exp(\\mathbf{K}^{\\top}\\mathbf{S}_t)\n$$\n问题要求对时间积分项使用二阶泰勒展开，在我们的离散情况下，这对应于求和项。我们对 $x = \\mathbf{K}^{\\top}\\mathbf{S}_t$ 展开指数函数 $\\exp(x) \\approx 1 + x + \\frac{1}{2}x^2$：\n$$\n\\sum_{t=1}^{N} \\exp(\\mathbf{K}^{\\top}\\mathbf{S}_t) \\approx \\sum_{t=1}^{N} \\left( 1 + \\mathbf{K}^{\\top}\\mathbf{S}_t + \\frac{1}{2}(\\mathbf{K}^{\\top}\\mathbf{S}_t)^2 \\right)\n$$\n二次项可以重写为 $\\frac{1}{2}\\mathbf{K}^{\\top}(\\mathbf{S}_t\\mathbf{S}_t^{\\top})\\mathbf{K}$。分配求和：\n$$\n\\sum_{t=1}^{N} \\exp(\\mathbf{K}^{\\top}\\mathbf{S}_t) \\approx \\sum_{t=1}^{N} 1 + \\mathbf{K}^{\\top}\\left(\\sum_{t=1}^{N} \\mathbf{S}_t\\right) + \\frac{1}{2}\\mathbf{K}^{\\top}\\left(\\sum_{t=1}^{N} \\mathbf{S}_t\\mathbf{S}_t^{\\top}\\right)\\mathbf{K}\n$$\n我们使用给定的刺激属性。由于 $\\mathbb{E}[\\mathbf{S}_t] = \\mathbf{0}$ 并且刺激是独立同分布的，对于大的 $N$，和 $\\sum_{t=1}^{N} \\mathbf{S}_t$ 期望接近 $\\mathbf{0}$，并且与其他 $N$ 阶的项相比可以忽略。对于二次项，我们使用给定的极限：\n$$\n\\lim_{N \\to \\infty}\\frac{\\Delta}{T}\\sum_{t=1}^{N}\\mathbf{S}_t\\mathbf{S}_t^{\\top} = \\mathbf{C}\n$$\n由于 $T=N\\Delta$，这等价于 $\\frac{1}{N}\\sum_{t=1}^{N}\\mathbf{S}_t\\mathbf{S}_t^{\\top} \\to \\mathbf{C}$。因此，对于大的 $N$，我们可以将这个和近似为 $\\sum_{t=1}^{N}\\mathbf{S}_t\\mathbf{S}_t^{\\top} \\approx N\\mathbf{C} = \\frac{T}{\\Delta}\\mathbf{C}$。\n将这些近似代入求和中：\n$$\n\\sum_{t=1}^{N} \\exp(\\mathbf{K}^{\\top}\\mathbf{S}_t) \\approx N + \\mathbf{K}^{\\top}(\\mathbf{0}) + \\frac{1}{2}\\mathbf{K}^{\\top}\\left(\\frac{T}{\\Delta}\\mathbf{C}\\right)\\mathbf{K} = \\frac{T}{\\Delta} + \\frac{T}{2\\Delta}\\mathbf{K}^{\\top}\\mathbf{C}\\mathbf{K}\n$$\n现在，将此代回到对数似然表达式中：\n$$\n\\mathcal{L}(\\mathbf{K}, h) \\approx n h + n \\mathbf{K}^{\\top}\\mathbf{m} - \\Delta \\exp(h) \\left( \\frac{T}{\\Delta} + \\frac{T}{2\\Delta}\\mathbf{K}^{\\top}\\mathbf{C}\\mathbf{K} \\right)\n$$\n$$\n\\mathcal{L}(\\mathbf{K}, h) \\approx n h + n \\mathbf{K}^{\\top}\\mathbf{m} - T \\exp(h) \\left( 1 + \\frac{1}{2}\\mathbf{K}^{\\top}\\mathbf{C}\\mathbf{K} \\right)\n$$\n为了找到最大似然估计 $\\hat{\\mathbf{K}}$ 和 $\\hat{h}$，我们将 $\\mathcal{L}$ 对 $\\mathbf{K}$ 和 $h$ 的偏导数设为零。\n首先，对 $h$ 求导：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial h} = n - T \\exp(h) \\left( 1 + \\frac{1}{2}\\mathbf{K}^{\\top}\\mathbf{C}\\mathbf{K} \\right) = 0\n$$\n这得到了一个关于 $\\exp(h)$ 的方程：\n$$\n\\exp(h) = \\frac{n}{T\\left( 1 + \\frac{1}{2}\\mathbf{K}^{\\top}\\mathbf{C}\\mathbf{K} \\right)}\n$$\n接下来，对 $\\mathbf{K}$ 求梯度（对于对称矩阵 $\\mathbf{A}$，使用 $\\nabla_{\\mathbf{x}}(\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x}) = 2\\mathbf{A}\\mathbf{x}$）：\n$$\n\\nabla_{\\mathbf{K}} \\mathcal{L} = n \\mathbf{m} - T \\exp(h) \\left( \\frac{1}{2} \\cdot 2\\mathbf{C}\\mathbf{K} \\right) = n \\mathbf{m} - T \\exp(h) \\mathbf{C}\\mathbf{K} = \\mathbf{0}\n$$\n$$\nT \\exp(h) \\mathbf{C}\\mathbf{K} = n \\mathbf{m}\n$$\n我们现在有一个关于估计量 $\\hat{\\mathbf{K}}$ 和 $\\hat{h}$ 的双方程系统。将 $\\exp(\\hat{h})$ 的表达式代入第二个方程：\n$$\nT \\left( \\frac{n}{T\\left( 1 + \\frac{1}{2}\\hat{\\mathbf{K}}^{\\top}\\mathbf{C}\\hat{\\mathbf{K}} \\right)} \\right) \\mathbf{C}\\hat{\\mathbf{K}} = n \\mathbf{m}\n$$\n假设 $n > 0$，我们可以除以 $n$：\n$$\n\\frac{\\mathbf{C}\\hat{\\mathbf{K}}}{1 + \\frac{1}{2}\\hat{\\mathbf{K}}^{\\top}\\mathbf{C}\\hat{\\mathbf{K}}} = \\mathbf{m} \\implies \\mathbf{C}\\hat{\\mathbf{K}} = \\mathbf{m} \\left( 1 + \\frac{1}{2}\\hat{\\mathbf{K}}^{\\top}\\mathbf{C}\\hat{\\mathbf{K}} \\right)\n$$\n由于 $\\mathbf{C}$ 是正定的，其逆矩阵 $\\mathbf{C}^{-1}$ 存在。\n$$\n\\hat{\\mathbf{K}} = \\left( 1 + \\frac{1}{2}\\hat{\\mathbf{K}}^{\\top}\\mathbf{C}\\hat{\\mathbf{K}} \\right) \\mathbf{C}^{-1}\\mathbf{m}\n$$\n这表明 $\\hat{\\mathbf{K}}$ 必须与 $\\mathbf{C}^{-1}\\mathbf{m}$ 成比例。设 $\\hat{\\mathbf{K}} = \\alpha \\mathbf{C}^{-1}\\mathbf{m}$，其中 $\\alpha$ 是某个标量。将此形式代回方程中：\n$$\n\\alpha \\mathbf{C}^{-1}\\mathbf{m} = \\left( 1 + \\frac{1}{2}(\\alpha \\mathbf{C}^{-1}\\mathbf{m})^{\\top}\\mathbf{C}(\\alpha \\mathbf{C}^{-1}\\mathbf{m}) \\right) \\mathbf{C}^{-1}\\mathbf{m}\n$$\n假设 $\\mathbf{m} \\neq \\mathbf{0}$，我们可以消去向量 $\\mathbf{C}^{-1}\\mathbf{m}$：\n$$\n\\alpha = 1 + \\frac{1}{2}\\alpha^2 (\\mathbf{C}^{-1}\\mathbf{m})^{\\top}\\mathbf{C}(\\mathbf{C}^{-1}\\mathbf{m}) = 1 + \\frac{1}{2}\\alpha^2 (\\mathbf{m}^{\\top}(\\mathbf{C}^{-1})^{\\top}\\mathbf{C}\\mathbf{C}^{-1}\\mathbf{m})\n$$\n因为 $\\mathbf{C}$ 是对称的，所以 $\\mathbf{C}^{-1}$ 也是对称的。因此 $(\\mathbf{C}^{-1})^{\\top} = \\mathbf{C}^{-1}$。\n$$\n\\alpha = 1 + \\frac{1}{2}\\alpha^2 (\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m})\n$$\n这是一个关于 $\\alpha$ 的一元二次方程：\n$$\n\\left( \\frac{1}{2}\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m} \\right)\\alpha^2 - \\alpha + 1 = 0\n$$\n$\\alpha$ 的解由二次方程求根公式给出：\n$$\n\\alpha = \\frac{1 \\pm \\sqrt{1 - 4 \\left( \\frac{1}{2}\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m} \\right)(1)}}{\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m}} = \\frac{1 \\pm \\sqrt{1 - 2(\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m})}}{\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m}}\n$$\n我们必须选择物理上正确的根。问题设定在“小滤波器能量范畴”，意味着 $\\mathbf{K}$ 很小。当 $\\mathbf{m} \\to \\mathbf{0}$ 时，我们期望 $\\mathbf{K} \\to \\mathbf{0}$。令 $B = \\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m}$。对于小的 $\\mathbf{m}$， $B$ 也很小。对 $\\sqrt{1-2B}$进行泰勒展开得到 $\\sqrt{1-2B} \\approx 1 - B - B^2/2$。\n正根给出 $\\alpha_+ \\approx \\frac{1 + (1-B)}{B} = \\frac{2-B}{B} \\approx \\frac{2}{B}$，当 $B \\to 0$ 时发散。\n负根给出 $\\alpha_- \\approx \\frac{1 - (1-B-B^2/2)}{B} = \\frac{B+B^2/2}{B} = 1 + B/2$。当 $B \\to 0$ 时，这个根趋近于 1。这对应于线性近似 $\\hat{\\mathbf{K}} \\approx \\mathbf{C}^{-1}\\mathbf{m}$，这是正确的极限行为。因此，我们选择负根。\n$$\n\\alpha = \\frac{1 - \\sqrt{1 - 2(\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m})}}{\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m}}\n$$\n滤波器的估计值为：\n$$\n\\hat{\\mathbf{K}} = \\frac{1 - \\sqrt{1 - 2(\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m})}}{\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m}} \\mathbf{C}^{-1}\\mathbf{m}\n$$\n为了找到 $\\hat{h}$，我们回到关于 $\\exp(h)$ 的方程。让我们重新审视分母：$1 + \\frac{1}{2}\\hat{\\mathbf{K}}^{\\top}\\mathbf{C}\\hat{\\mathbf{K}}$。使用 $\\hat{\\mathbf{K}}=\\alpha \\mathbf{C}^{-1}\\mathbf{m}$：\n$$\n1 + \\frac{1}{2}\\hat{\\mathbf{K}}^{\\top}\\mathbf{C}\\hat{\\mathbf{K}} = 1 + \\frac{1}{2}\\alpha^2 (\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m})\n$$\n从关于 $\\alpha$ 的二次方程，我们有 $\\alpha = 1 + \\frac{1}{2}\\alpha^2(\\mathbf{m}^{\\top}\\mathbf{C}^{-1}\\mathbf{m})$。因此，分母就是 $\\alpha$。\n所以，$\\exp(\\hat{h}) = \\frac{n}{T\\alpha}$。取自然对数得到 $\\hat{h}$：\n$$\n\\hat{h} = \\ln\\left(\\frac{n}{T\\alpha}\\right) = \\ln\\left(\\frac{n}{T}\\right) - \\ln(\\alpha)\n$$\n代入 $\\alpha$ 的表达式：\n$$\n\\hat{h} = \\ln\\left(\\frac{n}{T}\\right) - \\ln\\left(\\frac{1 - \\sqrt{1 - 2(\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m})}}{\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m}}\\right)\n$$\n这些就是在指定的二阶近似下，$\\mathbf{K}$ 和 $h$ 的闭式最大似然估计。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\hat{\\mathbf{K}} \\\\\n\\hat{h}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\left( \\frac{1 - \\sqrt{1 - 2(\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m})}}{\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m}} \\right) \\mathbf{C}^{-1}\\mathbf{m} \\\\\n\\ln\\left(\\frac{n}{T}\\right) - \\ln\\left( \\frac{1 - \\sqrt{1 - 2(\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m})}}{\\mathbf{m}^{\\top} \\mathbf{C}^{-1} \\mathbf{m}} \\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}