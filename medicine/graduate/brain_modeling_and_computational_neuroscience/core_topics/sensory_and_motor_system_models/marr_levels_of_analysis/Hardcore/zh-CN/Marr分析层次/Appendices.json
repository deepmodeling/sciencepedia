{
    "hands_on_practices": [
        {
            "introduction": "认知科学中的一个核心挑战是确定观察到的行为是反映了最优的计算策略，还是一个更简单的“足够好”的启发式算法。本练习旨在探讨这一问题，要求您找出在何种条件下，一个规范的贝叶斯模型和一个简单的阈值算法在行为上变得无法区分。通过进一步设计实验来打破这种等价性，您将对如何将计算层面的解释与算法层面的解释分离开来，有更深刻的理解。",
            "id": "3995657",
            "problem": "考虑一个二元感知分类任务，其中潜在类别变量 $C \\in \\{-1,+1\\}$ 和标量刺激 $s \\in \\mathbb{R}$ 通过环境层面的生成过程相关联。该生成模型由以下经过充分检验的事实指定：条件刺激分布是等方差的高斯分布，$p(s \\mid C=+1) = \\mathcal{N}(\\mu,\\sigma^{2})$ 和 $p(s \\mid C=-1) = \\mathcal{N}(-\\mu,\\sigma^{2})$，其中 $\\mu  0$ 且 $\\sigma  0$。类别的先验概率为 $p(C=+1) = \\pi$ 和 $p(C=-1) = 1-\\pi$，其中 $\\pi \\in (0,1)$。\n\n在计算层面（根据 Marr 的分析层面理论），观察者旨在通过使用贝叶斯准则来最大化该生成模型下的期望准确率。为捕捉有限理性，假设观察者的选择概率是通过对后验对数优势比应用一个逆温度为 $\\beta_{B}  0$ 的逻辑斯谛变换得到的软决策，从而产生一个作为 $s$ 的函数的选择概率 $P_{B}(+1 \\mid s)$。\n\n在算法层面（根据 Marr 的理论），考虑一种启发式决策算法，该算法在加性内部噪声后将刺激与一个阈值 $T \\in \\mathbb{R}$ 进行比较：内部决策变量为 $d(s) = s - T + \\varepsilon$，其中 $\\varepsilon$ 是一个尺度参数为 $b  0$ 的逻辑斯谛分布随机变量（因此 $\\varepsilon$ 的累积分布函数为 $F(\\varepsilon) = 1/(1+\\exp(-\\varepsilon/b))$）。这产生了一个选择概率 $P_{H}(+1 \\mid s)$，它是 $s$ 的一个逻辑斯谛函数。\n\n你的任务是：\n- 从贝叶斯准则和高斯生成模型的核心定义出发，推导在何种条件 $(\\mu,\\sigma,\\pi,\\beta_{B},b,T)$ 下，计算层面的贝叶斯观察者和算法层面的启发式方法会产生无法区分的行为，即对于所有 $s \\in \\mathbb{R}$，都有 $P_{B}(+1 \\mid s) = P_{H}(+1 \\mid s)$。\n- 利用推导出的等价性结构，提出科学上可行的实验来区分计算层面和算法层面的解释。通过打破等价性的操纵（例如，改变刺激分布结构、先验概率随时间变化或对内部噪声的约束）来设计这些实验，并定义一个分析可识别性度量（例如，在刺激空间上对 $P_{B}(+1 \\mid s)$ 和 $P_{H}(+1 \\mid s)$ 之间散度的一个积分）。你无需计算数值；提供符号表达式和原则性推理，说明为什么这些实验可以分离这两个层面。\n- 作为你的最终答案，提供启发式阈值 $T$ 的闭式表达式，该表达式用 $\\mu$、$\\sigma$、$\\pi$ 和 $\\beta_{B}$ 表示，并保证当启发式噪声尺度 $b$ 被选择以满足推导出的等价条件时，在所有 $s$ 上行为不可区分。\n\n不需要数值四舍五入。最终答案必须是单个无单位的解析表达式。",
            "solution": "我们从贝叶斯准则下的计算层面目标开始。在给定 $s$ 的条件下，$C=+1$ 相对于 $C=-1$ 的后验优势比为\n$$\n\\frac{p(C=+1 \\mid s)}{p(C=-1 \\mid s)} \\;=\\; \\frac{p(s \\mid C=+1)\\,p(C=+1)}{p(s \\mid C=-1)\\,p(C=-1)} \\;=\\; \\frac{\\mathcal{N}(s;\\mu,\\sigma^{2})\\,\\pi}{\\mathcal{N}(s;-\\mu,\\sigma^{2})\\,(1-\\pi)}.\n$$\n取自然对数得到后验对数优势比\n$$\n\\Lambda(s) \\;=\\; \\ln\\!\\left(\\frac{p(C=+1 \\mid s)}{p(C=-1 \\mid s)}\\right) \\;=\\; \\ln\\!\\left(\\frac{p(s \\mid C=+1)}{p(s \\mid C=-1)}\\right) \\;+\\; \\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right).\n$$\n对于均值在 $\\pm\\mu$ 的等方差高斯分布，对数似然比是 $s$ 的线性函数。具体来说，\n\\begin{align*}\n\\ln\\!\\left(\\frac{p(s \\mid C=+1)}{p(s \\mid C=-1)}\\right)\n= -\\frac{(s-\\mu)^{2}}{2\\sigma^{2}} + \\frac{(s+\\mu)^{2}}{2\\sigma^{2}} \\\\\n= -\\frac{s^{2} - 2\\mu s + \\mu^{2}}{2\\sigma^{2}} + \\frac{s^{2} + 2\\mu s + \\mu^{2}}{2\\sigma^{2}} \\\\\n= \\frac{4\\mu s}{2\\sigma^{2}} \\\\\n= \\frac{2\\mu}{\\sigma^{2}}\\,s.\n\\end{align*}\n因此，\n$$\n\\Lambda(s) \\;=\\; \\frac{2\\mu}{\\sigma^{2}}\\,s \\;+\\; \\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right).\n$$\n为了模拟有限理性，假设一个软决策规则，其中选择概率是后验对数优势比乘以一个逆温度 $\\beta_{B}$ 后的逻辑斯谛函数。这得到\n$$\nP_{B}(+1 \\mid s) \\;=\\; \\frac{1}{1 + \\exp\\!\\Big(-\\beta_{B}\\,\\Lambda(s)\\Big)} \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-\\beta_{B}\\left(\\frac{2\\mu}{\\sigma^{2}}\\,s + \\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right)\\right)\\right)}.\n$$\n因此，在这些假设下的计算层面，$P_{B}(+1 \\mid s)$ 是一个关于 $s$ 的逻辑斯谛函数，其斜率参数为 $\\beta_{B}\\,\\frac{2\\mu}{\\sigma^{2}}$，偏移量为 $\\beta_{B}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right)$。\n\n在算法层面，考虑启发式决策变量 $d(s) = s - T + \\varepsilon$，其中 $\\varepsilon$ 服从尺度为 $b  0$ 的逻辑斯谛分布。如果 $d(s)  0$，观察者选择 $+1$。选择 $+1$ 的概率是\n\\begin{align*}\nP_{H}(+1 \\mid s) = \\Pr\\big[\\,s - T + \\varepsilon  0 \\,\\big] \\\\\n= \\Pr\\big[\\,\\varepsilon  T - s \\,\\big] \\\\\n= 1 - F(T - s),\n\\end{align*}\n其中 $F$ 是尺度为 $b$ 的逻辑斯谛分布的累积分布函数，$F(x) = \\frac{1}{1 + \\exp(-x/b)}$。因此，\n\\begin{align*}\nP_{H}(+1 \\mid s) = 1 - \\frac{1}{1 + \\exp\\!\\left(-(T - s)/b\\right)} \\\\\n= \\frac{\\exp\\!\\left(-(T - s)/b\\right)}{1 + \\exp\\!\\left(-(T - s)/b\\right)} \\\\\n= \\frac{1}{1 + \\exp\\!\\left((T - s)/b\\right)} \\\\\n= \\frac{1}{1 + \\exp\\!\\left(-\\frac{s}{b} + \\frac{T}{b}\\right)}.\n\\end{align*}\n因此，该启发式算法的选择概率是关于 $s$ 的逻辑斯谛函数，其斜率参数为 $\\frac{1}{b}$，偏移量为 $\\frac{T}{b}$（注意符号约定）。\n\n对于所有刺激 $s \\in \\mathbb{R}$ 的不可区分性要求对所有 $s$ 都有 $P_{B}(+1 \\mid s) = P_{H}(+1 \\mid s)$。由于两者都是 $s$ 的逻辑斯谛函数，要对所有 $s$ 相等，就要求斜率和偏移量参数完全匹配。比较\n$$\nP_{B}(+1 \\mid s) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-\\beta_{B}\\,\\frac{2\\mu}{\\sigma^{2}}\\,s \\;-\\; \\beta_{B}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right)\\right)}\n$$\n与\n$$\nP_{H}(+1 \\mid s) \\;=\\; \\frac{1}{1 + \\exp\\!\\left(-\\frac{s}{b} \\;+\\; \\frac{T}{b}\\right)},\n$$\n我们必须有\n\\begin{align*}\n\\text{斜率匹配:}\\quad  \\frac{1}{b} \\;=\\; \\beta_{B}\\,\\frac{2\\mu}{\\sigma^{2}}, \\\\\n\\text{偏移量匹配:}\\quad  \\frac{T}{b} \\;=\\; -\\,\\beta_{B}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right).\n\\end{align*}\n这两个等式是在所有 $s$ 上，计算层面的贝叶斯方法和算法层面的启发式方法产生不可区分行为的条件。\n\n从斜率匹配中解出 $b$ 得到\n$$\nb \\;=\\; \\frac{\\sigma^{2}}{2\\mu\\,\\beta_{B}}.\n$$\n将此代入偏移量匹配中得到\n\\begin{align*}\n\\frac{T}{b} = -\\,\\beta_{B}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right), \\\\\nT = -\\,b\\,\\beta_{B}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right) \\\\\n= -\\,\\frac{\\sigma^{2}}{2\\mu}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right).\n\\end{align*}\n因此，实现不可区分性所需的启发式阈值完全由生成模型的先验优势比和刺激分布参数决定，一旦选择 $b$ 来匹配斜率，它就与逆温度 $\\beta_{B}$ 无关。\n\n接下来我们提出实验来区分计算层面和算法层面的解释。上述等价性依赖于后验对数优势比在 $s$ 上的线性以及逻辑斯谛内部噪声的假设。打破任一特征都可以区分这两种解释。\n\n实验 1：不等方差类别。操纵刺激统计量，使得 $p(s \\mid C=+1) = \\mathcal{N}(\\mu_{+},\\sigma_{+}^{2})$ 和 $p(s \\mid C=-1) = \\mathcal{N}(\\mu_{-},\\sigma_{-}^{2})$，其中 $\\sigma_{+}^{2} \\neq \\sigma_{-}^{2}$。根据贝叶斯准则，后验对数优势比变为 $s$ 的二次函数：\n$$\n\\Lambda_{\\text{uv}}(s) \\;=\\; \\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right) \\;+\\; \\ln\\!\\left(\\frac{\\sigma_{-}}{\\sigma_{+}}\\right) \\;-\\; \\frac{(s-\\mu_{+})^{2}}{2\\sigma_{+}^{2}} \\;+\\; \\frac{(s-\\mu_{-})^{2}}{2\\sigma_{-}^{2}},\n$$\n对于所有 $s$，这无法被一个具有 $s$ 线性参数的逻辑斯谛函数精确表示。一个阈值加逻辑斯谛噪声的启发式方法会产生一个线性的逻辑斯谛心理测量函数 $P_{H}(+1 \\mid s)$，并且无法对所有 $s$ 都匹配贝叶斯模型 $P_{B}(+1 \\mid s)$。一个可识别性度量可以是，在一个刺激总体 $q(s)$ 下，由两种模型导出的选择分布之间的Kullback-Leibler散度，\n$$\nD_{\\text{KL}} \\;=\\; \\int q(s)\\,\\ln\\!\\left(\\frac{P_{B}(+1 \\mid s)}{P_{H}(+1 \\mid s)}\\right)\\,\\mathrm{d}s,\n$$\n如果 $P_{B}(+1 \\mid s) \\neq P_{H}(+1 \\mid s)$ 在一个正测度集上成立，该散度将严格为正。当方差不相等时观察到非零散度，支持了利用生成模型结构的计算层面解释。\n\n实验 2：噪声分布扰动。施加已知会改变内部噪声特性的操纵（例如，时间压力或双任务干扰），并测试心理测量函数是由probit模型（高斯噪声）还是logit模型（逻辑斯谛噪声）更好地拟合。如果启发式方法依赖于尺度为 $b$ 的逻辑斯谛噪声，将其替换为标准差为 $\\sigma_{h}$ 的高斯噪声会产生一个probit心理测量函数\n$$\nP_{H}^{\\text{probit}}(+1 \\mid s) \\;=\\; \\Phi\\!\\left(\\frac{s-T}{\\sigma_{h}}\\right),\n$$\n其中 $\\Phi$ 是标准正态累积分布函数。在等方差情况下，计算层面的贝叶斯软决策仍然是逻辑斯谛的。$P_{B}$ 和 $P_{H}^{\\text{probit}}$ 之间的一个散度度量，如Jensen-Shannon散度（其平方根是一个度量），\n$$\nD_{\\text{JS}} \\;=\\; \\frac{1}{2}\\,\\int q(s)\\,\\left[ \\ln\\!\\left(\\frac{2\\,P_{B}(+1 \\mid s)}{P_{B}(+1 \\mid s) + P_{H}^{\\text{probit}}(+1 \\mid s)}\\right) + \\ln\\!\\left(\\frac{2\\,P_{H}^{\\text{probit}}(+1 \\mid s)}{P_{B}(+1 \\mid s) + P_{H}^{\\text{probit}}(+1 \\mid s)}\\right) \\right]\\,\\mathrm{d}s,\n$$\n通常会非零，这揭示了是算法层面的噪声假设，而非计算层面的目标，解释了观察到的心理测量函数形状。\n\n实验 3：带有动态适应的先验线索操纵。使用明确的线索在不同区块间改变 $\\pi$，并分析心理测量函数的偏移量如何随时间变化。计算层面的模型预测 $\\Lambda(s)$ 中会有一个与 $\\ln(\\pi/(1-\\pi))$ 成比例的偏移，如果 $\\beta_{B}$ 固定，则产生一个逻辑斯谛偏移 $\\beta_{B}\\,\\ln(\\pi/(1-\\pi))$。与此匹配的启发式阈值为 $T = -(\\sigma^{2}/(2\\mu))\\,\\ln(\\pi/(1-\\pi))$。如果生物体的适应是迟缓的或依赖于情境的，那么从行为中推断出的阈值可能会滞后于计算层面的规定。将滞后量化为在试验索引 $t$ 上的 $L^{2}$ 差异，\n$$\n\\Delta \\;=\\; \\sum_{t=1}^{T_{\\text{tot}}} \\left[P_{\\text{obs}}(+1 \\mid s_{t}) - \\frac{1}{1 + \\exp\\!\\left(-\\beta_{B}\\left(\\frac{2\\mu}{\\sigma^{2}}\\,s_{t} + \\ln\\!\\left(\\frac{\\pi_{t}}{1-\\pi_{t}}\\right)\\right)\\right)}\\right]^{2},\n$$\n其中 $P_{\\text{obs}}$ 是从序列中估计的观察选择概率。系统性的滞后或情境依赖性支持了涉及阈值动态的算法层面解释，而非纯粹的计算层面最优性。\n\n在所有情况下，关键策略是操纵环境或内部约束以引起状态变化，从而打破线性的逻辑斯谛等价性。在原始的等方差条件下，等价性要求同时匹配斜率和偏移量。求解这些匹配条件得到启发式阈值\n$$\nT \\;=\\; -\\,\\frac{\\sigma^{2}}{2\\mu}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right),\n$$\n其中启发式噪声尺度设置为 $b = \\frac{\\sigma^{2}}{2\\mu\\,\\beta_{B}}$。所要求的最终答案是 $T$ 的表达式。",
            "answer": "$$\\boxed{-\\frac{\\sigma^{2}}{2\\mu}\\,\\ln\\!\\left(\\frac{\\pi}{1-\\pi}\\right)}$$"
        },
        {
            "introduction": "Marr 的分析框架强调了不同分析层面之间的相互制约。本练习提供了一个具体的例子，将习惯的形成构建为一个优化问题的解，其中计算目标（最小化决策成本）受到实现层面约束（有限的突触资源）的塑造。您的任务是推导出在这种相互作用中涌现出的最优缓存算法，从而亲身体验一个复杂的认知现象如何能够被理解为一个定义明确问题的优雅解决方案。",
            "id": "3995641",
            "problem": "Marr的分析层次中的一个核心主题是计算目标、算法过程和实现基底的分离。将习惯形成视为一个计算原则，其目标是在反映实现资源限制的约束条件下，最小化预期决策成本。在计算层面上，假设存在一个由使用强度 $a \\in [0,1]$ 索引的连续动作模板，其群体密度为 $g(a) = 2a$。审慎地选择一个动作会产生每次使用的成本 $C_{d}$，而从习惯缓存中检索一个动作会产生每次使用的成本 $C_{h}$，其中 $C_{d}  C_{h}$。缓存带来的每次使用节省为 $\\Delta C = C_{d} - C_{h}$。如果一个使用强度为 $a$ 的动作模板被缓存，其单位时间的预期收益与其使用强度成正比，产生的收益密度为 $b(a) = \\Delta C \\, a$。实现基底施加了一个容量约束：每个被缓存的模板都带有一个突触资源占用 $w(a) = 1 + \\phi a$，其中 $\\phi  0$ 编码了皮质纹状体可塑性的一个实现特征（例如，与纹状体中多巴胺依赖的长时程增强（LTP）与长时程抑制（LTD）的平衡成比例）。可用的总突触资源为 $W$，这强制了约束条件 $\\int_{0}^{1} g(a) \\, w(a) \\, x(a) \\, da \\leq W$，其中 $x(a) \\in \\{0,1\\}$ 表示位于 $a$ 处的模板是否被缓存。\n\n在算法层面上，将最优习惯缓存策略形式化为在上述资源约束下最小化预期决策成本（等效于最大化预期节省）的解。从第一性原理出发，不引用任何预先指定的快捷公式，推导最优策略 $x^{*}(a)$ 的结构，并证明它由一个阈值 $a^{*}$ 表征，该阈值由一个编码突触资源影子价格的拉格朗日乘子 $\\mu$ 决定。通过明确展示 $w(a)$ 如何进入优化过程，将阈值结构与实现参数 $\\phi$ 联系起来。\n\n最后，对于具体的参数设置 $C_{d} = 5$, $C_{h} = 1$（因此 $\\Delta C = 4$），实现特征 $\\phi = 1$，以及容量 $W = \\frac{4}{3}$，计算在容量紧约束最优解下的拉格朗日乘子 $\\mu$ 的值。将您的答案表示为一个精确的有理数。最终答案不需要单位。",
            "solution": "在计算层面上，目标是在实现容量约束下最小化预期决策成本。因为审慎选择每次使用会产生成本 $C_{d}$，而习惯性检索会产生 $C_{h}$，所以每次使用的节省为 $\\Delta C = C_{d} - C_{h}$。对于一个由使用强度 $a$ 索引的动作模板，如果被缓存，其单位时间的预期收益密度为 $b(a) = \\Delta C \\, a$，并由群体密度 $g(a) = 2 a$ 加权。在缓存策略 $x(a) \\in \\{0,1\\}$ 下，总预期节省为\n$$\n\\int_{0}^{1} g(a) \\, b(a) \\, x(a) \\, da \\;=\\; \\int_{0}^{1} 2 a \\cdot \\Delta C \\, a \\cdot x(a) \\, da \\;=\\; \\Delta C \\int_{0}^{1} 2 a^{2} x(a) \\, da.\n$$\n实现约束源于突触资源占用 $w(a) = 1 + \\phi a$，得出\n$$\n\\int_{0}^{1} g(a) \\, w(a) \\, x(a) \\, da \\;=\\; \\int_{0}^{1} 2 a \\left(1 + \\phi a\\right) x(a) \\, da \\;\\leq\\; W.\n$$\n在算法层面上，这是一个连续的类背包选择问题。将 $x(a)$ 松弛到 $[0,1]$，并使用 Karush-Kuhn-Tucker (KKT) 框架来推导最优性条件。拉格朗日函数是\n$$\n\\mathcal{L}[x,\\mu] \\;=\\; \\int_{0}^{1} g(a) \\left( b(a) x(a) - \\mu \\, w(a) x(a) \\right) da \\;+\\; \\mu W \\;=\\; \\int_{0}^{1} 2 a \\left( \\Delta C \\, a - \\mu \\left(1 + \\phi a\\right) \\right) x(a)\\, da \\;+\\; \\mu W,\n$$\n其中 $\\mu \\geq 0$ 是容量约束的拉格朗日乘子。因为 $x(a)$ 是线性进入并且有界于 $[0,1]$，所以逐点最大化解是\n$$\nx^{*}(a) \\;=\\; \\begin{cases}\n1,  \\text{if } \\Delta C \\, a - \\mu \\left(1 + \\phi a\\right)  0, \\\\\n0,  \\text{if } \\Delta C \\, a - \\mu \\left(1 + \\phi a\\right)  0,\n\\end{cases}\n$$\n在等式成立时存在无差异，允许取 $[0,1]$ 中的任何值。重新整理符号条件，\n$$\n\\Delta C \\, a - \\mu \\left(1 + \\phi a\\right)  0 \\;\\;\\Longleftrightarrow\\;\\; \\frac{\\Delta C \\, a}{1 + \\phi a} \\;\\; \\mu.\n$$\n当 $\\Delta C0$ 且 $\\phi0$ 时，函数 $a \\mapsto \\frac{\\Delta C \\, a}{1 + \\phi a}$ 在 $a \\in [0,1]$ 上是严格递增的，因为其导数为正：\n$$\n\\frac{d}{da} \\left( \\frac{\\Delta C \\, a}{1 + \\phi a} \\right) \\;=\\; \\frac{\\Delta C \\left(1 + \\phi a\\right) - \\Delta C \\, a \\, \\phi}{\\left(1 + \\phi a\\right)^{2}} \\;=\\; \\frac{\\Delta C}{\\left(1 + \\phi a\\right)^{2}} \\;\\; 0.\n$$\n因此，存在一个唯一的阈值 $a^{*} \\in [0,1]$，使得\n$$\nx^{*}(a) \\;=\\; \\begin{cases}\n1,  a  a^{*}, \\\\\n0,  a  a^{*},\n\\end{cases}\n$$\n其中 $a^{*}$ 由容量紧约束和在阈值处的无差异条件确定：\n$$\n\\mu \\;=\\; \\frac{\\Delta C \\, a^{*}}{1 + \\phi a^{*}}.\n$$\n为了确定 $a^{*}$，施加容量紧约束（在非平凡情况下，互补松弛性和 $\\mu0$ 成立）：\n$$\n\\int_{a^{*}}^{1} g(a) \\, w(a) \\, da \\;=\\; W.\n$$\n使用 $g(a) = 2 a$ 和 $w(a) = 1 + \\phi a$，此积分计算为\n$$\n\\int_{a^{*}}^{1} 2 a \\left(1 + \\phi a\\right) \\, da \\;=\\; 2 \\int_{a^{*}}^{1} \\left( a + \\phi a^{2} \\right) da \\;=\\; 2 \\left[ \\frac{1}{2} \\left(1 - a^{*2}\\right) + \\frac{\\phi}{3} \\left(1 - a^{*3}\\right) \\right].\n$$\n化简得，\n$$\n\\int_{a^{*}}^{1} 2 a \\left(1 + \\phi a\\right) \\, da \\;=\\; \\left(1 - a^{*2}\\right) + \\frac{2\\phi}{3} \\left(1 - a^{*3}\\right) \\;=\\; 1 + \\frac{2\\phi}{3} \\;-\\; a^{*2} \\;-\\; \\frac{2\\phi}{3} a^{*3}.\n$$\n将此结果设为 $W$ 并用给定的参数求解 $a^{*}$。参数为 $C_{d} = 5$, $C_{h} = 1$（因此 $\\Delta C = 4$），实现特征 $\\phi = 1$，以及容量 $W = \\frac{4}{3}$。代入 $\\phi = 1$，\n$$\n\\int_{a^{*}}^{1} 2 a \\left(1 + a\\right) \\, da \\;=\\; 1 + \\frac{2}{3} \\;-\\; a^{*2} \\;-\\; \\frac{2}{3} a^{*3} \\;=\\; \\frac{5}{3} \\;-\\; a^{*2} \\;-\\; \\frac{2}{3} a^{*3}.\n$$\n容量紧约束条件变为\n$$\n\\frac{5}{3} \\;-\\; a^{*2} \\;-\\; \\frac{2}{3} a^{*3} \\;=\\; \\frac{4}{3}.\n$$\n重新整理，\n$$\na^{*2} \\;+\\; \\frac{2}{3} a^{*3} \\;=\\; \\frac{1}{3}.\n$$\n乘以 $3$，\n$$\n3 a^{*2} \\;+\\; 2 a^{*3} \\;=\\; 1.\n$$\n观察到 $a^{*} = \\frac{1}{2}$ 精确地满足此方程：\n$$\n3 \\left(\\frac{1}{2}\\right)^{2} \\;+\\; 2 \\left(\\frac{1}{2}\\right)^{3} \\;=\\; 3 \\cdot \\frac{1}{4} \\;+\\; 2 \\cdot \\frac{1}{8} \\;=\\; \\frac{3}{4} \\;+\\; \\frac{1}{4} \\;=\\; 1.\n$$\n因此，$a^{*} = \\frac{1}{2}$。相应的拉格朗日乘子由阈值处的无差异条件得出：\n$$\n\\mu \\;=\\; \\frac{\\Delta C \\, a^{*}}{1 + \\phi a^{*}} \\;=\\; \\frac{4 \\cdot \\frac{1}{2}}{1 + 1 \\cdot \\frac{1}{2}} \\;=\\; \\frac{2}{\\frac{3}{2}} \\;=\\; \\frac{4}{3}.\n$$\n在 Marr 的算法层面上，这个 $\\mu$ 决定了最优阈值，从而确定了一种缓存策略，该策略选择具有足够大的效益-占用比的动作。在实现层面上，参数 $\\phi$ 编码了皮质纹状体可塑性特征（例如，多巴胺（DA）调节的长时程增强（LTP）和长时程抑制（LTD）的平衡），它缩放了 $w(a)$，从而改变了 $a^{*}$ 和 $\\mu$。对于指定的 $\\phi = 1$，推导出的影子价格 $\\mu$ 是上面计算出的精确有理数值。",
            "answer": "$$\\boxed{\\frac{4}{3}}$$"
        },
        {
            "introduction": "像梯度下降这样的抽象算法在神经回路中究竟是如何实现的？本练习使用极具影响力的预测编码框架深入探讨了这个问题，其计算目标是最小化预测误差。您将推导实现该算法的神经动力学，并分析实现层面的参数（特别是神经元群体的时间常数）必须如何平衡以确保系统有效收敛，从而将算法性能与生物物理属性直接联系起来。",
            "id": "3995618",
            "problem": "考虑一个通过 David Marr 的三个分析层次进行分析的预测编码（PC）皮层微电路模型。在计算层面，假设大脑的目标是通过最小化一个平衡了预测保真度和表示上的二次先验的二次能量泛函，来推断感官输入 $x \\in \\mathbb{R}^{n}$ 的一个潜在表示向量 $r \\in \\mathbb{R}^{m}$。形式上，目标是最小化函数\n$$\nE(r) = \\frac{1}{2}\\|x - W r\\|^{2} + \\frac{\\lambda}{2}\\|r\\|^{2},\n$$\n其中 $W \\in \\mathbb{R}^{n \\times m}$ 是一个固定的线性生成模型，$\\lambda  0$ 是一个先验强度。\n\n在算法层面，使用两个相互作用的神经元群体来实现关于 $E(r)$ 的连续时间梯度流推断：一个表示残差的误差群体 $e \\in \\mathbb{R}^{n}$ 和一个编码潜在状态的表示群体 $r \\in \\mathbb{R}^{m}$。假设这两个群体都是漏积分器，其时间常数分别为 $\\tau_{e}  0$ 和 $\\tau_{r}  0$。误差单元通过漏计算来编码残差，而表示单元通过接收来自误差单元的反馈来沿能量梯度下降。在实现层面，假设这些计算是由局部的兴奋-抑制性循环电路实例化的，其中 $W$ 由群体之间的前馈和反馈突触实现。\n\n仅使用目标 $E(r)$ 和漏积分器假设，推导 $e(t)$ 和 $r(t)$ 的耦合常微分方程。然后，通过将动力学限制在 $W$ 的一个奇异模式上（即，沿着满足 $W v = \\sigma u$ 和 $W^{\\top} u = \\sigma v$ 的左-右奇异向量对 $(u, v)$），其中奇异值为 $\\sigma \\ge 0$，来分析恒定输入 $x$ 在不动点附近的线性化动力学。在该 $2 \\times 2$ 子空间中，确定线性化动力学临界阻尼（一个重实特征值）的条件。最后，关注对应于最大奇异值 $\\sigma$ 的最坏情况模式，计算在该模式下产生临界阻尼的较小的正临界比率\n$$\n\\rho^{\\star} = \\frac{\\tau_{r}}{\\tau_{e}}\n$$\n并仅用 $\\lambda$ 和 $\\sigma$ 来表示。\n\n你的最终答案必须是 $\\rho^{\\star}$ 的单个闭式解析表达式。不需要四舍五入，也不需要单位，因为 $\\rho^{\\star}$ 是无量纲的。",
            "solution": "该问题要求在一个预测编码（PC）模型中推导一个关键参数比率。分析过程首先建立系统的动力学，然后对其进行线性化，最后在一个特定子空间中找到临界阻尼的条件。\n\n首先，我们建立控制误差群体 $e(t) \\in \\mathbb{R}^{n}$ 和表示群体 $r(t) \\in \\mathbb{R}^{m}$ 的耦合常微分方程（ODE）。问题陈述这些群体是漏积分器。\n\n误差单元 $e$ 被描述为对残差进行漏计算，残差定义为感官输入 $x$ 和预测 $Wr$ 之间的差。一个输入为 $I$、时间常数为 $\\tau$ 的漏积分器的动力学通常表示为 $\\tau \\frac{dy}{dt} = -y + I$。在这里，状态是 $e$，输入是残差 $x - Wr$。因此，误差群体的动力学为：\n$$\n\\tau_{e} \\frac{de}{dt} = -e + x - Wr\n$$\n\n表示单元 $r$ 被描述为通过接收来自误差单元 $e$ 的反馈，沿能量泛函 $E(r)$ 的梯度下降。能量泛函由下式给出：\n$$\nE(r) = \\frac{1}{2}\\|x - W r\\|^{2} + \\frac{\\lambda}{2}\\|r\\|^{2}\n$$\n$E(r)$ 关于 $r$ 的梯度是：\n$$\n\\frac{\\partial E}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( \\frac{1}{2}(x - Wr)^T(x - Wr) + \\frac{\\lambda}{2} r^T r \\right) = -W^T(x - Wr) + \\lambda r\n$$\n$r$ 的标准连续时间梯度流动力学应为 $\\tau_r \\frac{dr}{dt} = -\\frac{\\partial E}{\\partial r}$。代入梯度，我们得到：\n$$\n\\tau_r \\frac{dr}{dt} = W^T(x - Wr) - \\lambda r\n$$\n问题指明表示单元从误差单元 $e(t)$ 接收反馈，而不是从瞬时残差 $x-Wr$。这意味着我们应该将误差群体 $e$ 的状态代入更新规则中。与问题描述一致的标准预测编码（PC）公式将 $r$ 的动力学建模为：\n$$\n\\tau_{r} \\frac{dr}{dt} = W^T e - \\lambda r\n$$\n这个方程捕捉了这样的思想：表示 $r$ 的变化是由来自误差群体的反馈 $W^T e$ 驱动的，并由一个源于先验的泄漏/衰减项 $-\\lambda r$ 进行正则化。\n\n完整的耦合常微分方程组是：\n$$\n\\begin{cases}\n\\tau_{e} \\frac{de}{dt} = -e + x - Wr \\\\\n\\tau_{r} \\frac{dr}{dt} = W^T e - \\lambda r\n\\end{cases}\n$$\n\n接下来，我们求系统对于恒定输入 $x$ 的不动点 $(\\bar{e}, \\bar{r})$。在不动点处，时间导数为零：\n$$\n0 = -\\bar{e} + x - W\\bar{r} \\implies \\bar{e} = x - W\\bar{r}\n$$\n$$\n0 = W^T \\bar{e} - \\lambda \\bar{r}\n$$\n将 $\\bar{e}$ 的表达式代入第二个方程，得到：\n$$\nW^T (x - W\\bar{r}) - \\lambda \\bar{r} = 0 \\implies W^T x = (W^T W + \\lambda I) \\bar{r}\n$$\n这表明不动点 $\\bar{r}$ 是最小化能量泛函 $E(r)$ 的解。\n\n我们现在围绕这个不动点对动力学进行线性化。设 $e(t) = \\bar{e} + \\delta e(t)$ 和 $r(t) = \\bar{r} + \\delta r(t)$。将这些代入常微分方程并使用不动点条件，我们得到关于扰动 $(\\delta e, \\delta r)$ 的线性化系统：\n$$\n\\tau_{e} \\frac{d\\delta e}{dt} = -(\\bar{e} + \\delta e) + x - W(\\bar{r} + \\delta r) = (-\\bar{e} + x - W\\bar{r}) - \\delta e - W \\delta r = -\\delta e - W \\delta r\n$$\n$$\n\\tau_{r} \\frac{d\\delta r}{dt} = W^T (\\bar{e} + \\delta e) - \\lambda (\\bar{r} + \\delta r) = (W^T \\bar{e} - \\lambda \\bar{r}) + W^T \\delta e - \\lambda \\delta r = W^T \\delta e - \\lambda \\delta r\n$$\n用矩阵形式表示，这是：\n$$\n\\frac{d}{dt} \\begin{pmatrix} \\delta e \\\\ \\delta r \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\tau_{e}}I  -\\frac{1}{\\tau_{e}}W \\\\ \\frac{1}{\\tau_{r}}W^T  -\\frac{\\lambda}{\\tau_{r}}I \\end{pmatrix} \\begin{pmatrix} \\delta e \\\\ \\delta r \\end{pmatrix}\n$$\n其中该矩阵是系统在不动点处的雅可比矩阵。\n\n问题要求分析限制在 $W$ 的一个奇异模式上的动力学，该模式由一个左奇异向量 $u \\in \\mathbb{R}^n$、一个右奇异向量 $v \\in \\mathbb{R}^m$ 和一个奇异值 $\\sigma \\ge 0$ 定义，使得 $Wv = \\sigma u$ 和 $W^T u = \\sigma v$。我们通过设置 $\\delta e(t) = e_p(t) u$ 和 $\\delta r(t) = r_p(t) v$ 将扰动投影到这个子空间上，其中 $e_p(t)$ 和 $r_p(t)$ 是标量函数。将这些代入线性化方程中：\n$$\n\\tau_{e} \\frac{d(e_p u)}{dt} = -(e_p u) - W(r_p v) \\implies \\tau_{e} \\frac{de_p}{dt} u = -e_p u - r_p (\\sigma u)\n$$\n$$\n\\tau_{r} \\frac{d(r_p v)}{dt} = W^T(e_p u) - \\lambda(r_p v) \\implies \\tau_{r} \\frac{dr_p}{dt} v = e_p (\\sigma v) - \\lambda r_p v\n$$\n提出非零向量 $u$ 和 $v$ 得到一个关于标量系数的 $2 \\times 2$ 系统：\n$$\n\\frac{d}{dt} \\begin{pmatrix} e_p \\\\ r_p \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\tau_e}  -\\frac{\\sigma}{\\tau_e} \\\\ \\frac{\\sigma}{\\tau_r}  -\\frac{\\lambda}{\\tau_r} \\end{pmatrix} \\begin{pmatrix} e_p \\\\ r_p \\end{pmatrix}\n$$\n这个投影系统的稳定性由 $2 \\times 2$ 矩阵 $J_{uv}$ 的特征值 $k$ 决定。特征方程是 $\\det(J_{uv} - kI) = 0$：\n$$\n\\det \\begin{pmatrix} -1/\\tau_e - k  -\\sigma/\\tau_e \\\\ \\sigma/\\tau_r  -\\lambda/\\tau_r - k \\end{pmatrix} = \\left(-\\frac{1}{\\tau_e} - k\\right)\\left(-\\frac{\\lambda}{\\tau_r} - k\\right) - \\left(-\\frac{\\sigma}{\\tau_e}\\right)\\left(\\frac{\\sigma}{\\tau_r}\\right) = 0\n$$\n$$\n\\left(k + \\frac{1}{\\tau_e}\\right)\\left(k + \\frac{\\lambda}{\\tau_r}\\right) + \\frac{\\sigma^2}{\\tau_e\\tau_r} = 0\n$$\n$$\nk^2 + \\left(\\frac{1}{\\tau_e} + \\frac{\\lambda}{\\tau_r}\\right)k + \\frac{\\lambda + \\sigma^2}{\\tau_e\\tau_r} = 0\n$$\n当这个二次方程有一个重实根时，发生临界阻尼，这意味着它的判别式必须为零。\n$$\n\\Delta = \\left(\\frac{1}{\\tau_e} + \\frac{\\lambda}{\\tau_r}\\right)^2 - 4\\frac{\\lambda + \\sigma^2}{\\tau_e\\tau_r} = 0\n$$\n让我们展开并简化这个条件：\n$$\n\\frac{1}{\\tau_e^2} + \\frac{2\\lambda}{\\tau_e\\tau_r} + \\frac{\\lambda^2}{\\tau_r^2} - \\frac{4\\lambda + 4\\sigma^2}{\\tau_e\\tau_r} = 0\n$$\n$$\n\\frac{1}{\\tau_e^2} - \\frac{2\\lambda + 4\\sigma^2}{\\tau_e\\tau_r} + \\frac{\\lambda^2}{\\tau_r^2} = 0\n$$\n问题要求的是临界比率 $\\rho = \\frac{\\tau_r}{\\tau_e}$。我们可以将方程重排为关于 $\\rho$ 的二次方程。将整个方程乘以 $\\tau_r^2$：\n$$\n\\frac{\\tau_r^2}{\\tau_e^2} - \\frac{(2\\lambda + 4\\sigma^2)\\tau_r}{\\tau_e} + \\lambda^2 = 0\n$$\n代入 $\\rho = \\frac{\\tau_r}{\\tau_e}$，我们得到一个关于 $\\rho$ 的二次方程：\n$$\n\\rho^2 - (2\\lambda + 4\\sigma^2)\\rho + \\lambda^2 = 0\n$$\n我们使用二次公式求解 $\\rho$：\n$$\n\\rho = \\frac{(2\\lambda + 4\\sigma^2) \\pm \\sqrt{(2\\lambda + 4\\sigma^2)^2 - 4\\lambda^2}}{2}\n$$\n$$\n\\rho = (\\lambda + 2\\sigma^2) \\pm \\frac{\\sqrt{4(\\lambda + 2\\sigma^2)^2 - 4\\lambda^2}}{2}\n$$\n$$\n\\rho = (\\lambda + 2\\sigma^2) \\pm \\sqrt{(\\lambda + 2\\sigma^2)^2 - \\lambda^2}\n$$\n化简平方根下的项：\n$$\n(\\lambda + 2\\sigma^2)^2 - \\lambda^2 = (\\lambda^2 + 4\\lambda\\sigma^2 + 4\\sigma^4) - \\lambda^2 = 4\\lambda\\sigma^2 + 4\\sigma^4 = 4\\sigma^2(\\lambda + \\sigma^2)\n$$\n所以 $\\rho$ 的解是：\n$$\n\\rho = (\\lambda + 2\\sigma^2) \\pm \\sqrt{4\\sigma^2(\\lambda + \\sigma^2)} = \\lambda + 2\\sigma^2 \\pm 2\\sigma\\sqrt{\\lambda + \\sigma^2}\n$$\n这里我们使用 $\\sigma$ 而不是 $|\\sigma|$，因为题目给出 $\\sigma \\ge 0$。\n问题要求较小的正临界比率 $\\rho^\\star$。我们必须检查两个根是否都为正。第一个根 $\\rho_+ = \\lambda + 2\\sigma^2 + 2\\sigma\\sqrt{\\lambda + \\sigma^2}$ 显然是正的，因为 $\\lambda  0$ 和 $\\sigma \\ge 0$。对于第二个根 $\\rho_- = \\lambda + 2\\sigma^2 - 2\\sigma\\sqrt{\\lambda + \\sigma^2}$，我们检查是否 $\\lambda + 2\\sigma^2  2\\sigma\\sqrt{\\lambda + \\sigma^2}$。由于两边都是非负的，我们可以对它们进行平方：\n$$\n(\\lambda + 2\\sigma^2)^2  4\\sigma^2(\\lambda + \\sigma^2)\n$$\n$$\n\\lambda^2 + 4\\lambda\\sigma^2 + 4\\sigma^4  4\\lambda\\sigma^2 + 4\\sigma^4 \\implies \\lambda^2  0\n$$\n这是成立的，因为 $\\lambda  0$。因此，两个根都是正的，较小的一个是 $\\rho_-$。\n$$\n\\rho^\\star = \\lambda + 2\\sigma^2 - 2\\sigma\\sqrt{\\lambda + \\sigma^2}\n$$\n这个表达式可以被识别为一个完全平方数，从而简化：\n$$\n\\rho^\\star = (\\lambda + \\sigma^2) - 2\\sigma\\sqrt{\\lambda+\\sigma^2} + \\sigma^2 = \\left(\\sqrt{\\lambda+\\sigma^2} - \\sigma\\right)^2\n$$\n这就是较小的正临界比率的最终表达式。",
            "answer": "$$\\boxed{\\left(\\sqrt{\\lambda+\\sigma^2} - \\sigma\\right)^2}$$"
        }
    ]
}