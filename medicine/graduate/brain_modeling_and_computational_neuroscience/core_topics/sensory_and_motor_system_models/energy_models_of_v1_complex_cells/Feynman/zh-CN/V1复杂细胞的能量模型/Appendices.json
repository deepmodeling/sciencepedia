{
    "hands_on_practices": [
        {
            "introduction": "能量模型的一个核心目标是解释V1复杂细胞响应的一个关键特性：相位不变性。这个练习旨在通过一个思想实验来巩固这一概念，要求您利用反相光栅刺激来构建一个能够区分简单细胞和复杂细胞的可证伪的预测 。通过为理想能量模型计算相位不变性指数，您将把抽象的理论与可量化的实验测量直接联系起来。",
            "id": "3978675",
            "problem": "考虑初级视皮层（V1）中的一个一维模型神经元，该神经元由经典的复杂细胞能量模型描述。刺激是一个反相光栅，由下式给出\n$$\ns(x,t) \\;=\\; A \\cos(k_0 x + \\phi)\\,\\cos(\\omega t),\n$$\n其中 $A$ 是对比度振幅，$k_0$ 是空间频率，$\\phi$ 是空间相位（以弧度为单位），$\\omega$ 是时间角频率（以弧度/秒为单位）。该神经元有两个线性子单元，其空间感受野（RFs）为 $g_{e}(x)$ 和 $g_{o}(x)$，它们在空间频率 $k_0$ 处形成一个空间正交对。线性响应为\n$$\nr_{e}(t;\\phi)\\;=\\;\\int_{-\\infty}^{\\infty} g_{e}(x)\\,s(x,t)\\,dx,\\qquad\nr_{o}(t;\\phi)\\;=\\;\\int_{-\\infty}^{\\infty} g_{o}(x)\\,s(x,t)\\,dx,\n$$\n复杂细胞的输出是能量\n$$\nE(t;\\phi)\\;=\\;r_{e}(t;\\phi)^{2}\\;+\\;r_{o}(t;\\phi)^{2}.\n$$\n假设两个子单元在空间上都是线性和时间不变的，正交性质在 $k_0$ 处精确成立（增益相等，空间相位差为 $\\pi/2$），并且每个线性响应的时间依赖性仅来自刺激中的 $\\cos(\\omega t)$ 因子。定义一个时间周期 $T = 2\\pi/\\omega$ 上的时间平均响应为\n$$\n\\overline{E}(\\phi)\\;=\\;\\frac{1}{T}\\int_{0}^{T} E(t;\\phi)\\,dt,\n$$\n并定义相位不变性指数\n$$\n\\mathrm{PI}\\;=\\;\\frac{R_{\\min}}{R_{\\max}},\n$$\n其中 $R_{\\min}$ 和 $R_{\\max}$ 分别是 $\\overline{E}(\\phi)$ 在 $\\phi \\in [0,2\\pi)$ 上的最小值和最大值。\n\n仅使用线性系统的第一性原理和正交性质，完成以下任务。首先，通过指明时间平均响应对空间相位 $\\phi$ 的依赖性有何不同，构建一个可证伪的实验预测，用以在反相光栅刺激下区分简单细胞和复杂细胞。其次，为能量模型神经元推导 $\\overline{E}(\\phi)$，并计算上述理想情况下的相应 $\\mathrm{PI}$。\n\n将最终答案表示为一个无量纲数。无需四舍五入。",
            "solution": "解答分为两个部分：首先，构建一个可证伪的预测来区分简单细胞和复杂细胞；其次，为理想复杂细胞模型推导时间平均响应 $\\overline{E}(\\phi)$ 并计算相位不变性指数 $(\\mathrm{PI})$。\n\n**第1部分：区分简单细胞和复杂细胞的可证伪预测**\n\n一个简单细胞通常被建模为单个线性滤波器后接一个静态非线性环节，例如整流或平方。其响应对刺激的空间相位高度敏感。相比之下，复杂细胞的能量模型汇集了具有不同相位偏好的多个线性滤波器的平方输出。这种汇集被假设用来创建一个对空间相位不变的响应。这种差异导致了一个清晰的实验预测。\n\n一个简单细胞的响应可以被建模为 $S(t;\\phi) = f(r_e(t;\\phi))$，其中 $r_e(t;\\phi)$ 是某个单一的线性响应，$f$ 是一个非线性函数。如下文所示，$r_e(t;\\phi)$ 与 $\\cos(\\phi)$ 成正比。因此，其时间平均响应 $\\overline{S}(\\phi)$ 会受到 $\\phi$ 的强烈调制，在某个偏好相位达到峰值，而在其他相位为零。例如，如果 $f(z)=z^2$，则时间平均的简单细胞响应将与 $\\cos^2(\\phi)$ 成正比，其最小响应与最大响应之比为 $0$。\n\n一个复杂细胞的响应由 $E(t;\\phi)$ 给出。下面的推导将表明其时间平均响应 $\\overline{E}(\\phi)$ 是一个常数。\n\n**可证伪的预测：** 可以设计一个实验，向一个V1神经元呈现其偏好空间频率 $k_0$ 的反相光栅刺激 $s(x,t) = A \\cos(k_0 x + \\phi)\\cos(\\omega t)$。当空间相位 $\\phi$ 在 $[0, 2\\pi)$ 范围内变化时，记录神经元的时间平均发放率（作为响应的度量）。\n-   **如果该细胞是一个简单细胞**，其时间平均响应将随 $\\phi$ 表现出强烈的调制，呈现出明显的峰值和谷值。相位不变性指数 $\\mathrm{PI}$ 将接近于 $0$。\n-   **如果该细胞是一个理想的复杂细胞**，其时间平均响应将是恒定的，不随 $\\phi$ 发生调制。相位不变性指数 $\\mathrm{PI}$ 将为 $1$。\n这提供了一种直接、定量且可证伪的方法，根据神经元对此刺激的响应将其分类为简单细胞或复杂细胞。\n\n**第2部分：$\\overline{E}(\\phi)$ 和相位不变性指数 $(\\mathrm{PI})$ 的推导**\n\n我们首先计算线性响应 $r_{e}(t;\\phi)$ 和 $r_{o}(t;\\phi)$。给定刺激 $s(x,t) = A \\cos(k_0 x + \\phi) \\cos(\\omega t)$ 以及时间动态仅来自刺激的假设，我们可以将时间分量从空间积分中提出来。\n$$\nr_{j}(t;\\phi) = \\int_{-\\infty}^{\\infty} g_{j}(x) A \\cos(k_0 x + \\phi) \\cos(\\omega t) dx = A \\cos(\\omega t) \\int_{-\\infty}^{\\infty} g_j(x) \\cos(k_0 x + \\phi) dx\n$$\n对于 $j \\in \\{e, o\\}$。我们通过展开余弦来分析空间积分项：\n$$\n\\int_{-\\infty}^{\\infty} g_j(x) [\\cos(k_0 x)\\cos(\\phi) - \\sin(k_0 x)\\sin(\\phi)] dx = \\cos(\\phi)\\int_{-\\infty}^{\\infty} g_j(x)\\cos(k_0 x)dx - \\sin(\\phi)\\int_{-\\infty}^{\\infty} g_j(x)\\sin(k_0 x)dx\n$$\n正交性质意味着 $g_e(x)$ 是一个偶对称滤波器（如余弦Gabor滤波器），而 $g_o(x)$ 是一个奇对称滤波器（如正弦Gabor滤波器）。对于偶函数 $g_e(x)$， $g_e(x)\\sin(k_0 x)$ 在 $(-\\infty, \\infty)$ 上的积分是零，因为被积函数是奇函数。对于奇函数 $g_o(x)$，$g_o(x)\\cos(k_0 x)$ 的积分是零，因为被积函数是奇函数。\n这简化了响应的空间分量：\n-   对于 $r_e(t;\\phi)$：含有 $\\sin(\\phi)$ 的项消失。令 $C_e = \\int_{-\\infty}^{\\infty} g_e(x)\\cos(k_0 x)dx$。响应变为 $r_e(t;\\phi) = A C_e \\cos(\\phi) \\cos(\\omega t)$。\n-   对于 $r_o(t;\\phi)$：含有 $\\cos(\\phi)$ 的项消失。令 $S_o = \\int_{-\\infty}^{\\infty} g_o(x)\\sin(k_0 x)dx$。响应变为 $r_o(t;\\phi) = -A S_o \\sin(\\phi) \\cos(\\omega t)$。\n\n正交性质还指出滤波器具有“相等增益”。这转化为它们对其偏好输入的响应幅度相等。常数 $C_e$ 表示偶滤波器对余弦光栅的响应，$S_o$ 表示奇滤波器对正弦光栅的响应。相等增益意味着 $|C_e| = |S_o|$。我们定义这个增益为 $K > 0$。如有必要，通过调整 $g_e$ 和 $g_o$ 的符号，我们可以设定 $C_e = K$ 和 $S_o = K$。\n因此，线性响应为：\n$$\nr_e(t;\\phi) = A K \\cos(\\phi) \\cos(\\omega t)\n$$\n$$\nr_o(t;\\phi) = -A K \\sin(\\phi) \\cos(\\omega t)\n$$\n现在，我们计算能量 $E(t;\\phi) = r_e(t;\\phi)^2 + r_o(t;\\phi)^2$：\n$$\nE(t;\\phi) = [A K \\cos(\\phi) \\cos(\\omega t)]^2 + [-A K \\sin(\\phi) \\cos(\\omega t)]^2\n$$\n$$\nE(t;\\phi) = (A K)^2 \\cos^2(\\omega t) \\cos^2(\\phi) + (A K)^2 \\cos^2(\\omega t) \\sin^2(\\phi)\n$$\n提取公因式：\n$$\nE(t;\\phi) = (A K)^2 \\cos^2(\\omega t) [\\cos^2(\\phi) + \\sin^2(\\phi)]\n$$\n使用三角恒等式 $\\cos^2(\\phi) + \\sin^2(\\phi) = 1$：\n$$\nE(t;\\phi) = (A K)^2 \\cos^2(\\omega t)\n$$\n值得注意的是，瞬时能量 $E(t;\\phi)$ 与空间相位 $\\phi$ 无关。\n\n接下来，我们计算一个时间周期 $T=2\\pi/\\omega$ 上的时间平均响应 $\\overline{E}(\\phi)$：\n$$\n\\overline{E}(\\phi) = \\frac{1}{T} \\int_0^T E(t;\\phi) dt = \\frac{1}{T} \\int_0^T (A K)^2 \\cos^2(\\omega t) dt\n$$\n$\\cos^2(\\theta)$ 在一个完整周期内的平均值为 $1/2$。形式上：\n$$\n\\frac{1}{T} \\int_0^T \\cos^2(\\omega t) dt = \\frac{1}{T} \\int_0^T \\frac{1+\\cos(2\\omega t)}{2} dt = \\frac{1}{2T} \\left[t + \\frac{\\sin(2\\omega t)}{2\\omega}\\right]_0^T\n$$\n$$\n= \\frac{1}{2T} \\left[T + \\frac{\\sin(2\\omega (2\\pi/\\omega))}{2\\omega} - 0\\right] = \\frac{1}{2T} \\left[T + \\frac{\\sin(4\\pi)}{2\\omega}\\right] = \\frac{1}{2}\n$$\n因此，时间平均响应为：\n$$\n\\overline{E}(\\phi) = (A K)^2 \\cdot \\frac{1}{2} = \\frac{(A K)^2}{2}\n$$\n时间平均响应 $\\overline{E}(\\phi)$ 是一个常数，与空间相位 $\\phi$ 无关。\n\n最后，我们计算相位不变性指数，$\\mathrm{PI} = R_{\\min}/R_{\\max}$：\n$$\nR_{\\max} = \\max_{\\phi \\in [0,2\\pi)} \\overline{E}(\\phi) = \\max_{\\phi} \\frac{(A K)^2}{2} = \\frac{(A K)^2}{2}\n$$\n$$\nR_{\\min} = \\min_{\\phi \\in [0,2\\pi)} \\overline{E}(\\phi) = \\min_{\\phi} \\frac{(A K)^2}{2} = \\frac{(A K)^2}{2}\n$$\n$$\n\\mathrm{PI} = \\frac{R_{\\min}}{R_{\\max}} = \\frac{(A K)^2 / 2}{(A K)^2 / 2} = 1\n$$\n对于由能量模型描述的理想复杂细胞，相位不变性指数恰好为 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "理解了能量模型所要解释的现象之后，下一个关键步骤是学习如何将该模型与真实的神经活动数据进行拟合。这个被称为系统辨识的过程通常依赖于梯度优化算法。这项练习将引导您推导能量模型输出相对于其输入和滤波器参数的梯度，为您提供模型训练的基础技能，这些梯度是让模型能够复现神经元响应的必要构件 。",
            "id": "3978680",
            "problem": "考虑一个初级视皮层（V1）复杂细胞的标准能量模型。设刺激是一个向量 $x \\in \\mathbb{R}^{n}$，两个线性子单元滤波器为 $h_{1} \\in \\mathbb{R}^{n}$ 和 $h_{2} \\in \\mathbb{R}^{n}$。子单元的响应是内积 $y_{1} = h_{1}^{\\top} x$ 和 $y_{2} = h_{2}^{\\top} x$。模型的能量输出定义为\n$$\nE(x) = y_{1}^{2} + y_{2}^{2} = \\left(h_{1}^{\\top} x\\right)^{2} + \\left(h_{2}^{\\top} x\\right)^{2}.\n$$\n从线性滤波作为内积的核心定义以及复合函数微分的链式法则出发，推导 $E(x)$ 关于刺激 $x$ 以及关于滤波器参数 $h_{1}$ 和 $h_{2}$ 的梯度的闭式表达式。然后，简要解释如何使用这些梯度，通过基于梯度的优化方法，从包含已知刺激下测量的复杂细胞响应的数据中，对滤波器进行系统辨识。\n\n将三个梯度的最终答案按 $\\left(\\nabla_{x} E, \\nabla_{h_{1}} E, \\nabla_{h_{2}} E\\right)$ 的顺序放在一个单行矩阵中。不需要进行数值四舍五入，也没有物理单位。将最终答案表示为一个简化的、闭式的解析表达式。",
            "solution": "V1 复杂细胞模型的能量输出由下式给出：\n$$\nE(x) = \\left(h_{1}^{\\top} x\\right)^{2} + \\left(h_{2}^{\\top} x\\right)^{2}\n$$\n其中 $x \\in \\mathbb{R}^{n}$ 是刺激向量，$h_{1}, h_{2} \\in \\mathbb{R}^{n}$ 是线性滤波器向量。为了推导梯度，我们将应用向量值函数的链式微分法则。对于一个复合函数 $f(g(z))$，其关于 $z$ 的梯度是 $\\nabla_z f = \\frac{\\partial f}{\\partial g} \\nabla_z g$。我们还使用两个标准的向量微积分恒等式：$\\nabla_z(a^\\top z) = a$ 和 $\\nabla_z(z^\\top a) = a$。\n\n1.  **关于刺激 $x$ 的梯度：** $\\nabla_{x} E(x)$\n\n能量 $E(x)$ 是两项之和。和的梯度等于梯度的和。我们分别计算每一项关于 $x$ 的梯度。\n\n对于第一项，令 $y_{1}(x) = h_{1}^{\\top} x$。该项为 $y_{1}^{2}$。使用链式法则：\n$$\n\\nabla_{x} \\left(y_{1}^{2}\\right) = \\frac{d(y_{1}^{2})}{dy_{1}} \\nabla_{x} y_{1}\n$$\n$y_{1}^{2}$ 关于 $y_{1}$ 的导数是 $2y_{1}$。线性函数 $y_{1}(x) = h_{1}^{\\top} x$ 关于 $x$ 的梯度是：\n$$\n\\nabla_{x} \\left(h_{1}^{\\top} x\\right) = h_{1}\n$$\n结合这些，第一项的梯度是：\n$$\n\\nabla_{x} \\left(\\left(h_{1}^{\\top} x\\right)^{2}\\right) = 2y_{1} h_{1} = 2\\left(h_{1}^{\\top} x\\right) h_{1}\n$$\n根据对称性，第二项 $\\left(h_{2}^{\\top} x\\right)^{2}$ 的梯度是：\n$$\n\\nabla_{x} \\left(\\left(h_{2}^{\\top} x\\right)^{2}\\right) = 2\\left(h_{2}^{\\top} x\\right) h_{2}\n$$\n$E(x)$ 关于 $x$ 的总梯度是这两个结果的和：\n$$\n\\nabla_{x} E(x) = 2\\left(h_{1}^{\\top} x\\right) h_{1} + 2\\left(h_{2}^{\\top} x\\right) h_{2}\n$$\n\n2.  **关于滤波器 $h_{1}$ 的梯度：** $\\nabla_{h_{1}} E$\n\n为了求得关于 $h_{1}$ 的梯度，我们注意到第二项 $\\left(h_{2}^{\\top} x\\right)^{2}$ 不依赖于 $h_{1}$，所以其梯度为零向量。我们只需要对第一项 $\\left(h_{1}^{\\top} x\\right)^{2}$ 进行微分。\n\n令 $y_{1}(h_{1}) = h_{1}^{\\top} x$。使用关于 $h_{1}$ 的梯度的链式法则：\n$$\n\\nabla_{h_{1}} \\left(y_{1}^{2}\\right) = \\frac{d(y_{1}^{2})}{dy_{1}} \\nabla_{h_{1}} y_{1} = 2y_{1} \\nabla_{h_{1}} y_{1}\n$$\n为了求得 $y_{1}(h_{1}) = h_{1}^{\\top} x$ 的梯度，我们可以将内积重写为 $x^{\\top}h_{1}$。这个线性函数关于 $h_{1}$ 的梯度是：\n$$\n\\nabla_{h_{1}} \\left(x^{\\top} h_{1}\\right) = x\n$$\n将其代回，我们得到 $E$ 关于 $h_{1}$ 的梯度：\n$$\n\\nabla_{h_{1}} E = 2y_{1} x = 2\\left(h_{1}^{\\top} x\\right) x\n$$\n\n3.  **关于滤波器 $h_{2}$ 的梯度：** $\\nabla_{h_{2}} E$\n\n$\\nabla_{h_{2}} E$ 的推导与 $\\nabla_{h_{1}} E$ 的推导是对称的。第一项 $\\left(h_{1}^{\\top} x\\right)^{2}$ 不依赖于 $h_{2}$。我们对第二项 $\\left(h_{2}^{\\top} x\\right)^{2}$ 关于 $h_{2}$ 进行微分。\n$$\n\\nabla_{h_{2}} E = \\nabla_{h_{2}} \\left(\\left(h_{2}^{\\top} x\\right)^{2}\\right)\n$$\n遵循与 $h_{1}$ 相同的逻辑：\n$$\n\\nabla_{h_{2}} \\left(\\left(h_{2}^{\\top} x\\right)^{2}\\right) = 2\\left(h_{2}^{\\top} x\\right) \\nabla_{h_{2}}\\left(h_{2}^{\\top} x\\right) = 2\\left(h_{2}^{\\top} x\\right) x\n$$\n因此，$E$ 关于 $h_{2}$ 的梯度是：\n$$\n\\nabla_{h_{2}} E = 2\\left(h_{2}^{\\top} x\\right) x\n$$\n\n**使用梯度进行系统辨识**\n\n系统辨识是根据实验数据建立系统数学模型的过程。在此背景下，这意味着找到能够最好地解释一组已知刺激下 V1 复杂细胞的观测响应的滤波器参数 $h_{1}$ 和 $h_{2}$。\n\n当使用基于梯度的优化方法时，我们推导出的梯度 $\\nabla_{h_{1}} E$ 和 $\\nabla_{h_{2}} E$ 对此过程至关重要。其步骤如下：\n\n1.  **定义损失函数：** 首先，定义一个损失函数 $L(h_{1}, h_{2})$ 来量化模型预测的能量输出 $E(x^{(i)})$ 与一个由刺激-响应对 $\\{ (x^{(i)}, r^{(i)}) \\}_{i=1}^{N}$ 组成的数据集中实际测量的神经响应 $r^{(i)}$ 之间的差异。一个常见的选择是均方误差（MSE）：\n    $$\n    L(h_{1}, h_{2}) = \\frac{1}{N} \\sum_{i=1}^{N} \\left(r^{(i)} - E(x^{(i)})\\right)^{2}\n    $$\n2.  **基于梯度的优化：** 目标是找到最小化该损失函数的参数 $h_{1}$ 和 $h_{2}$。梯度下降是一种迭代算法，它通过沿损失函数梯度的相反方向重复更新参数来实现这一目标。每个滤波器的更新规则是：\n    $$\n    h_{1} \\leftarrow h_{1} - \\alpha \\nabla_{h_{1}} L \\\\\n    h_{2} \\leftarrow h_{2} - \\alpha \\nabla_{h_{2}} L\n    $$\n    其中 $\\alpha$ 是一个称为学习率的小正数。\n\n3.  **计算损失梯度：** 损失函数的梯度 $\\nabla_{h_{1}} L$ 和 $\\nabla_{h_{2}} L$ 是通过链式法则计算的，这需要我们已经推导出的能量模型 $E$ 的梯度。例如，对于 $h_{1}$：\n    $$\n    \\nabla_{h_{1}} L = \\frac{\\partial L}{\\partial E} \\nabla_{h_{1}} E\n    $$\n    对于单个数据点 $(x, r)$，MSE 损失关于 $h_{1}$ 的梯度是：\n    $$\n    \\nabla_{h_{1}} L = \\frac{\\partial}{\\partial h_{1}} \\left(r - E(x)\\right)^{2} = 2(r - E(x))(-\\nabla_{h_{1}} E) = -2(r - E(x)) \\left(2(h_{1}^{\\top} x) x\\right)\n    $$\n    对于 $\\nabla_{h_{2}} L$，存在一个类似的表达式。通过在数据集上对这些梯度求平均，并迭代地应用更新规则，算法会收敛到一组能够最优地表征复杂细胞响应特性的滤波器 $h_{1}$ 和 $h_{2}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2\\left(h_{1}^{\\top} x\\right) h_{1} + 2\\left(h_{2}^{\\top} x\\right) h_{2}  2\\left(h_{1}^{\\top} x\\right) x  2\\left(h_{2}^{\\top} x\\right) x \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "能量模型的计算原理不仅具有历史意义，它们也在现代神经网络架构中得到了体现。这项练习通过构建一个使用深度学习中常见组件（如修正线性单元ReLU和最大池化）的替代模型来探索这种联系。通过分析这个替代模型如何近似能量模型的相位不变性，您将深入理解跨越不同建模范式（从经典计算神经科学到当代人工智能）的规范计算 。",
            "id": "3978678",
            "problem": "考虑由经典能量模型和一种替代性亚基模型建模的初级视皮层（$V1$）复杂细胞，两者均由一个正弦亮度光栅驱动。该光栅具有固定的方向和空间频率（与滤波器匹配）、对比度振幅 $A  0$ 以及以弧度为单位的相位 $\\phi$。假设对于匹配的刺激，线性滤波器增益是单位归一化的。能量模型包含一对正交线性滤波器，其对光栅的输出为 $L_{c}(\\phi) = A \\cos(\\phi)$ 和 $L_{s}(\\phi) = A \\sin(\\phi)$，其响应由平方和定义为 $R_{E}(\\phi) = L_{c}(\\phi)^{2} + L_{s}(\\phi)^{2}$。已知此响应对刺激相位 $\\phi$ 是不变的。\n\n构建一个替代性亚基模型，该模型包含 $M$ 个相位调谐亚基，它们具有相同的方向和空间频率，但具有不同的偏好相位 $\\theta_{k}$，其中 $k \\in \\{0,1,\\dots,M-1\\}$。每个亚基计算一个线性投影 $L_{k}(\\phi) = A \\cos(\\phi - \\theta_{k})$，然后应用一个阈值为 $\\tau \\ge 0$ 的整流线性单元（ReLU）非线性函数，定义为 $f(x) = \\max(0, x - \\tau)$。为了近似相位不变性，将每个亚基与其相反极性的对应部分配对，并通过取两个整流输出中的较大者来对该对进行池化，因此 $u_{k}(\\phi) = \\max\\left(f(L_{k}(\\phi)), f(-L_{k}(\\phi))\\right)$。通过跨亚基的最大池化和随后的平方运算来定义模型输出，$R_{M}(\\phi) = \\left(\\max_{k} u_{k}(\\phi)\\right)^{2}$。\n\n将相对于能量模型的近似误差定义为 $\\varepsilon(\\phi) = R_{E}(\\phi) - R_{M}(\\phi)$。在 $\\{\\theta_{k}\\}$ 和 $\\tau$ 的所有选择中，确定使相位上的最坏情况误差（理解为 $\\varepsilon_{\\max} = \\max_{\\phi \\in [0,\\pi)} \\varepsilon(\\phi)$）最小化的关于 $\\{\\theta_{k}\\}$ 和 $\\tau$ 的条件，并计算相应的最小最坏情况误差，结果表示为关于 $A$ 和 $M$ 的闭式表达式。您的最终答案必须是这个单一的表达式。角度必须以弧度处理。不需要进行数值四舍五入；请给出精确的表达式。",
            "solution": "首先，我们简化能量模型的响应表达式 $R_{E}(\\phi)$。\n$$R_{E}(\\phi) = L_{c}(\\phi)^{2} + L_{s}(\\phi)^{2} = (A \\cos(\\phi))^{2} + (A \\sin(\\phi))^{2} = A^{2}(\\cos^{2}(\\phi) + \\sin^{2}(\\phi)) = A^{2}$$\n如问题所述，能量模型的响应是一个常数 $A^{2}$，对刺激相位 $\\phi$ 完全不变。\n\n接下来，我们简化亚基模型的响应表达式 $R_{M}(\\phi)$。一个配对亚基的输出 $u_k(\\phi)$ 是：\n$$u_{k}(\\phi) = \\max\\left(f(L_{k}(\\phi)), f(-L_{k}(\\phi))\\right) = \\max\\left(\\max(0, L_{k}(\\phi)-\\tau), \\max(0, -L_{k}(\\phi)-\\tau)\\right)$$\n这可以简化为：\n$$u_{k}(\\phi) = \\max(0, L_{k}(\\phi)-\\tau, -L_{k}(\\phi)-\\tau) = \\max(0, |L_{k}(\\phi)| - \\tau)$$\n代入 $L_{k}(\\phi) = A \\cos(\\phi - \\theta_{k})$，我们得到：\n$$u_{k}(\\phi) = \\max(0, |A \\cos(\\phi - \\theta_{k})| - \\tau) = \\max(0, A |\\cos(\\phi - \\theta_{k})| - \\tau)$$\n总模型响应 $R_{M}(\\phi)$ 是通过对亚基进行最大池化然后平方得到的：\n$$R_{M}(\\phi) = \\left(\\max_{k} u_{k}(\\phi)\\right)^{2} = \\left(\\max_{k} \\max(0, A |\\cos(\\phi - \\theta_{k})| - \\tau)\\right)^{2}$$\n这可以通过将外部的最大值函数移到内部来重写：\n$$R_{M}(\\phi) = \\left(\\max\\left(0, \\max_{k} (A |\\cos(\\phi - \\theta_{k})|) - \\tau\\right)\\right)^{2} = \\left(\\max\\left(0, A \\left(\\max_{k} |\\cos(\\phi - \\theta_{k})|\\right) - \\tau\\right)\\right)^{2}$$\n我们定义包络函数 $C(\\phi) = \\max_{k} |\\cos(\\phi - \\theta_{k})|$。那么亚基模型的响应是：\n$$R_{M}(\\phi) = \\left(\\max(0, A C(\\phi) - \\tau)\\right)^{2}$$\n\n近似误差为 $\\varepsilon(\\phi) = R_{E}(\\phi) - R_{M}(\\phi) = A^{2} - R_{M}(\\phi)$。最坏情况误差为 $\\varepsilon_{\\max} = \\max_{\\phi \\in [0,\\pi)} \\varepsilon(\\phi)$。\n$$\\varepsilon_{\\max} = \\max_{\\phi \\in [0,\\pi)} \\left( A^{2} - \\left(\\max(0, A C(\\phi) - \\tau)\\right)^{2} \\right)$$\n为了最大化 $\\varepsilon(\\phi)$，我们必须最小化 $R_{M}(\\phi)$。$R_{M}(\\phi)$ 是 $C(\\phi)$ 的一个单调非减函数。因此，当 $C(\\phi)$ 最小时，$R_{M}(\\phi)$ 也最小。设 $C_{\\min} = \\min_{\\phi \\in [0,\\pi)} C(\\phi)$。最大误差 $\\varepsilon_{\\max}$ 发生在 $C(\\phi) = C_{\\min}$ 的相位 $\\phi$ 处。\n$$\\varepsilon_{\\max} = A^{2} - \\left(\\max(0, A C_{\\min} - \\tau)\\right)^{2}$$\n我们的目标是通过选择相位集合 $\\{\\theta_{k}\\}$ 和阈值 $\\tau \\ge 0$ 来最小化这个 $\\varepsilon_{\\max}$。这等价于最大化被减去的项，而这又等价于最大化它的底数：\n$$\\max_{\\{\\theta_k\\}, \\tau \\ge 0} \\left(\\max(0, A C_{\\min} - \\tau)\\right)$$\n我们可以分两步进行这个最大化：首先对 $\\{\\theta_k\\}$ 进行，然后对 $\\tau$ 进行。\n\n1.  **优化相位 $\\{\\theta_k\\}$：**\n    对于任何固定的 $\\tau$ 和 $A$，我们需要最大化 $C_{\\min} = \\min_{\\phi \\in [0,\\pi)} \\max_{k} |\\cos(\\phi - \\theta_{k})|$。这是一个用区间覆盖圆的经典问题。函数 $|\\cos(\\psi)|$ 的周期是 $\\pi$。为了最大化这些函数包络的最小值，这些函数必须均匀分布。将 $M$ 个偏好相位 $\\theta_k$ 均匀分布在 $[0, \\pi)$ 区间上可以得到最优的排列方式，例如 $\\theta_{k} = \\frac{k\\pi}{M}$。在这种均匀间隔下，包络 $C(\\phi)$ 的最小值将出现在任意两个相邻峰值的中点，例如，在 $\\theta_0=0$ 和 $\\theta_1=\\pi/M$ 之间的 $\\phi = \\frac{\\pi}{2M}$。在这一点上，包络的最小值为 $C_{\\min} = \\cos\\left(\\frac{\\pi}{2M}\\right)$。这是在所有 $\\{\\theta_k\\}$ 选择中 $C_{\\min}$ 可能的最大值。\n\n2.  **优化阈值 $\\tau$：**\n    现在，我们将最优的 $C_{\\min}$ 代入 $\\varepsilon_{\\max}$ 的表达式中，并关于 $\\tau \\ge 0$ 进行最小化。这等价于在 $\\tau \\ge 0$ 的约束下最大化项 $g(\\tau) = \\left(\\max\\left(0, A \\cos\\left(\\frac{\\pi}{2M}\\right) - \\tau\\right)\\right)^{2}$。设 $K = A \\cos\\left(\\frac{\\pi}{2M}\\right)$。我们想要在 $\\tau \\ge 0$ 的条件下最大化 $g(\\tau) = (\\max(0, K-\\tau))^2$。这个函数在 $\\tau=0$ 时取得最大值。\n\n因此，最优条件是均匀间隔的相位，例如 $\\theta_{k} = \\frac{k\\pi}{M}$，以及阈值 $\\tau=0$。\n\n最后，我们将这些最优参数值代入 $\\varepsilon_{\\max}$ 的表达式中，以计算最小最坏情况误差：\n$$\\varepsilon_{\\max}^{\\min} = A^{2} - \\left(\\max\\left(0, A \\cos\\left(\\frac{\\pi}{2M}\\right) - 0\\right)\\right)^{2}$$\n$$\\varepsilon_{\\max}^{\\min} = A^{2} - \\left(A \\cos\\left(\\frac{\\pi}{2M}\\right)\\right)^{2} = A^{2} - A^{2} \\cos^{2}\\left(\\frac{\\pi}{2M}\\right)$$\n使用三角恒等式 $\\sin^{2}(x) + \\cos^{2}(x) = 1$：\n$$\\varepsilon_{\\max}^{\\min} = A^{2} \\left(1 - \\cos^{2}\\left(\\frac{\\pi}{2M}\\right)\\right) = A^{2} \\sin^{2}\\left(\\frac{\\pi}{2M}\\right)$$\n这就是以 $A$ 和 $M$ 表示的最小最坏情况误差的闭式表达式。",
            "answer": "$$\\boxed{A^{2} \\sin^{2}\\left(\\frac{\\pi}{2M}\\right)}$$"
        }
    ]
}