{
    "hands_on_practices": [
        {
            "introduction": "To understand how the brain controls movement, we must first model the 'motors' that drive the skeleton: the muscles. This exercise introduces the foundational Hill-type muscle model, which captures the essential, nonlinear relationships between a muscle's activation, its length, and its velocity to determine the force it produces. By working through this problem (), you will gain hands-on experience in calculating the joint torque generated by a muscle, a critical first step in simulating and analyzing biological movement.",
            "id": "3971475",
            "problem": "Consider a single-degree-of-freedom planar elbow joint actuated by one flexor muscle modeled as a Hill-type actuator. The following well-tested components characterize the muscle mechanics: the active contractile force scales with maximal isometric force, activation, an active force–length multiplier, and a force–velocity multiplier; a passive parallel elastic element contributes force that grows exponentially with extension beyond optimal length; the joint torque equals the scalar moment arm multiplied by the muscle–tendon force.\n\nAssume the muscle has maximal isometric force $F_{0} = 1500\\,\\mathrm{N}$ and activation $a = 0.60$. The fiber length is expressed in units normalized by optimal fiber length, $\\ell = 1.10$, and the fiber velocity is normalized by maximal shortening velocity, $v = 0$. The active force–length multiplier is given by\n$$\nf_{\\ell}(\\ell) = \\exp\\!\\left(-\\left(\\frac{\\ell - 1}{w}\\right)^{2}\\right),\n$$\nwith width parameter $w = 0.25$. The passive elastic force is modeled as\n$$\nF_{\\mathrm{passive}}(\\ell) = \n\\begin{cases}\nF_{0}\\,c_{p}\\!\\left(\\exp\\!\\big(k_{p}(\\ell - 1)\\big) - 1\\right), & \\ell \\ge 1,\\\\[6pt]\n0, & \\ell < 1,\n\\end{cases}\n$$\nwith $c_{p} = 0.01$ and $k_{p} = 4.0$. For the force–velocity effect, use the standard normalization convention that $f_{v}(0) = 1$ at zero velocity.\n\nThe joint angle is $q = \\pi/3\\,\\mathrm{rad}$. The scalar moment arm as a function of angle is\n$$\nR(q) = r_{0} + r_{1}\\cos(q),\n$$\nwith $r_{0} = 0.030\\,\\mathrm{m}$ and $r_{1} = 0.010\\,\\mathrm{m}$.\n\nUsing only these definitions and fundamental mechanics, compute the net elbow flexion torque $\\tau$ at the given posture. Express your final answer in $\\mathrm{N\\cdot m}$ and round to four significant figures. Angles are in radians.",
            "solution": "The problem statement provides a complete and scientifically consistent description of a biomechanical system based on a standard Hill-type muscle model. All parameters and functions required to calculate the joint torque are specified, rendering the problem valid and well-posed. The solution proceeds by systematically calculating the components that contribute to the net joint torque.\n\nThe net elbow flexion torque, $\\tau$, is the product of the total muscle force, $F_{\\text{total}}$, and the muscle's moment arm, $R(q)$, about the joint axis.\n$$ \\tau = F_{\\text{total}} \\cdot R(q) $$\nThe total force generated by the muscle is the sum of the active force, $F_{\\text{active}}$, and the passive force, $F_{\\text{passive}}$.\n$$ F_{\\text{total}} = F_{\\text{active}} + F_{\\text{passive}} $$\n\nFirst, we calculate the moment arm, $R(q)$, at the specified joint angle $q = \\pi/3\\,\\mathrm{rad}$. The formula for the moment arm is given as:\n$$ R(q) = r_{0} + r_{1}\\cos(q) $$\nSubstituting the given parameter values $r_{0} = 0.030\\,\\mathrm{m}$ and $r_{1} = 0.010\\,\\mathrm{m}$:\n$$ R(\\pi/3) = 0.030\\,\\mathrm{m} + (0.010\\,\\mathrm{m})\\cos(\\pi/3) $$\nThe cosine of $\\pi/3$ radians is exactly $0.5$.\n$$ R(\\pi/3) = 0.030\\,\\mathrm{m} + (0.010\\,\\mathrm{m})(0.5) = 0.030\\,\\mathrm{m} + 0.005\\,\\mathrm{m} = 0.035\\,\\mathrm{m} $$\n\nNext, we calculate the total muscle force, $F_{\\text{total}}$. This requires computing its active and passive components.\n\nThe active force, $F_{\\text{active}}$, is defined by the product of several factors:\n$$ F_{\\text{active}} = F_{0} \\cdot a \\cdot f_{\\ell}(\\ell) \\cdot f_{v}(v) $$\nwhere $F_{0}$ is the maximal isometric force, $a$ is the muscle activation, $f_{\\ell}(\\ell)$ is the active force-length multiplier, and $f_{v}(v)$ is the force-velocity multiplier.\nThe problem states that the fiber velocity is zero, corresponding to a normalized velocity $v=0$. Per the problem's convention, the force-velocity multiplier at zero velocity is unity:\n$$ f_{v}(0) = 1 $$\nThe active force-length multiplier, $f_{\\ell}(\\ell)$, is given by the function:\n$$ f_{\\ell}(\\ell) = \\exp\\left(-\\left(\\frac{\\ell - 1}{w}\\right)^{2}\\right) $$\nUsing the given normalized fiber length $\\ell = 1.10$ and width parameter $w = 0.25$, we compute:\n$$ f_{\\ell}(1.10) = \\exp\\left(-\\left(\\frac{1.10 - 1}{0.25}\\right)^{2}\\right) = \\exp\\left(-\\left(\\frac{0.10}{0.25}\\right)^{2}\\right) = \\exp\\left(-(0.4)^{2}\\right) = \\exp(-0.16) $$\nNow, we can assemble the active force using the given values $F_{0} = 1500\\,\\mathrm{N}$ and $a = 0.60$:\n$$ F_{\\text{active}} = (1500\\,\\mathrm{N}) \\cdot (0.60) \\cdot \\exp(-0.16) \\cdot 1 = 900 \\cdot \\exp(-0.16)\\,\\mathrm{N} $$\n\nThe passive force, $F_{\\text{passive}}$, is determined by the muscle's extension. Since the normalized fiber length is $\\ell = 1.10$, which is greater than or equal to $1$, we use the first case of the provided piecewise function:\n$$ F_{\\text{passive}}(\\ell) = F_{0}\\,c_{p}\\!\\left(\\exp\\!\\big(k_{p}(\\ell - 1)\\big) - 1\\right) \\quad \\text{for } \\ell \\ge 1 $$\nSubstituting the parameters $F_{0} = 1500\\,\\mathrm{N}$, $c_{p} = 0.01$, and $k_{p} = 4.0$, along with $\\ell = 1.10$:\n$$ F_{\\text{passive}}(1.10) = (1500\\,\\mathrm{N}) \\cdot (0.01) \\left(\\exp\\big(4.0 \\cdot (1.10 - 1)\\big) - 1\\right) $$\n$$ F_{\\text{passive}}(1.10) = 15 \\left(\\exp\\big(4.0 \\cdot 0.10\\big) - 1\\right)\\,\\mathrm{N} = 15 \\left(\\exp(0.4) - 1\\right)\\,\\mathrm{N} $$\n\nThe total muscle force is the sum of the active and passive forces:\n$$ F_{\\text{total}} = F_{\\text{active}} + F_{\\text{passive}} = \\left(900 \\cdot \\exp(-0.16) + 15 \\left(\\exp(0.4) - 1\\right)\\right)\\,\\mathrm{N} $$\nWe evaluate this expression numerically:\n$$ \\exp(-0.16) \\approx 0.8521405 $$\n$$ \\exp(0.4) \\approx 1.4918247 $$\n$$ F_{\\text{active}} \\approx 900 \\cdot 0.8521405\\,\\mathrm{N} \\approx 766.92645\\,\\mathrm{N} $$\n$$ F_{\\text{passive}} \\approx 15 \\left(1.4918247 - 1\\right)\\,\\mathrm{N} = 15 \\cdot 0.4918247\\,\\mathrm{N} \\approx 7.37737\\,\\mathrm{N} $$\n$$ F_{\\text{total}} \\approx 766.92645\\,\\mathrm{N} + 7.37737\\,\\mathrm{N} = 774.30382\\,\\mathrm{N} $$\n\nFinally, we compute the net elbow flexion torque $\\tau$ by multiplying the total force by the calculated moment arm:\n$$ \\tau = F_{\\text{total}} \\cdot R(\\pi/3) \\approx (774.30382\\,\\mathrm{N}) \\cdot (0.035\\,\\mathrm{m}) $$\n$$ \\tau \\approx 27.1006337\\,\\mathrm{N\\cdot m} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\tau \\approx 27.10\\,\\mathrm{N\\cdot m} $$",
            "answer": "$$\n\\boxed{27.10}\n$$"
        },
        {
            "introduction": "A central challenge for the nervous system is maintaining stability, such as when standing upright. This task can be modeled as balancing an inverted pendulum, an inherently unstable system. This practice explores how the brain might solve this problem using the principles of optimal control, specifically the Linear Quadratic Regulator (LQR) framework (). You will implement a controller that minimizes a combination of postural sway and control effort, providing a computational account of how the CNS can achieve robust and efficient stabilization.",
            "id": "3971477",
            "problem": "Consider a torque-driven rigid pendulum used as a simplified model of a single-joint limb in motor control. The rotational dynamics about an equilibrium angle are given by the second-order ordinary differential equation\n$$\nI\\,\\ddot{\\theta}(t) + b\\,\\dot{\\theta}(t) + m g l\\,\\sin(\\theta(t)) = u(t),\n$$\nwhere $m$ is the mass, $l$ is the length, $I = m l^2$ is the moment of inertia about the pivot, $b$ is the viscous damping coefficient, $g$ is the gravitational acceleration, and $u(t)$ is the applied torque. Linearize about an equilibrium angle $\\theta_e$ with small deviation $\\phi(t) = \\theta(t) - \\theta_e$ using the small-angle approximation $\\sin(\\theta_e + \\phi) \\approx \\sin(\\theta_e) + \\cos(\\theta_e)\\,\\phi$. For equilibria where $\\sin(\\theta_e) = 0$ and $\\cos(\\theta_e) \\in \\{+1, -1\\}$, the linearized continuous-time state-space model with state $x(t) = [\\phi(t), \\dot{\\phi}(t)]^\\top$ has the form\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\nwith\n$$\nA = \\begin{bmatrix}\n0 & 1 \\\\\n- \\dfrac{g}{l}\\,\\cos(\\theta_e) & -\\dfrac{b}{I}\n\\end{bmatrix},\\quad\nB = \\begin{bmatrix}\n0 \\\\\n\\dfrac{1}{I}\n\\end{bmatrix}.\n$$\nDefine the regulation objective by the infinite-horizon quadratic cost\n$$\nJ = \\int_0^\\infty \\left( x(t)^\\top Q\\, x(t) + u(t)^\\top R\\, u(t) \\right)\\, dt,\n$$\nwhere $Q \\succeq 0$ is a symmetric positive semidefinite state-weight matrix and $R \\succ 0$ is a symmetric positive definite control-weight matrix. The Linear Quadratic Regulator (LQR) aims to find a state-feedback law $u(t) = -K x(t)$ that minimizes $J$. Assess motor control stability and damping by examining the closed-loop matrix $A_{\\mathrm{cl}} = A - B K$ and its eigenvalues.\n\nStarting only from the definitions above and first principles of linear systems and optimal control, implement an algorithm to:\n- Construct $A$ and $B$ from given physical parameters and equilibrium type.\n- Compute the LQR gain $K$ that minimizes $J$ under the given $(A,B,Q,R)$.\n- Form the closed-loop matrix $A_{\\mathrm{cl}}$ and compute its eigenvalues.\n- Determine stability by checking whether all eigenvalue real parts are strictly negative.\n- Quantify damping by computing, for each eigenvalue $\\lambda$, a damping ratio surrogate defined by\n$$\n\\zeta(\\lambda) =\n\\begin{cases}\n-\\dfrac{\\Re(\\lambda)}{\\lvert \\lambda \\rvert}, & \\text{if } \\Im(\\lambda) \\neq 0, \\\\\n1, & \\text{if } \\Im(\\lambda) = 0 \\text{ and } \\Re(\\lambda) < 0, \\\\\n0, & \\text{if } \\Im(\\lambda) = 0 \\text{ and } \\Re(\\lambda) \\ge 0,\n\\end{cases}\n$$\nand report the minimum value across all eigenvalues of $A_{\\mathrm{cl}}$ as the system's worst-case damping ratio. Additionally, report the maximum eigenvalue real part (units: $1/\\mathrm{s}$).\n\nYour program must evaluate the following test suite of physically plausible cases using the International System of Units (SI), with $g = 9.81\\,\\mathrm{m}/\\mathrm{s}^2$, angles in radians, and time in seconds. For each case, the equilibrium type is either \"upright\" ($\\cos(\\theta_e) = -1$) or \"downward\" ($\\cos(\\theta_e) = +1$), and the matrices $Q$ and $R$ are specified by diagonal entries such that $Q = \\mathrm{diag}(q_\\phi, q_{\\dot{\\phi}})$ and $R = [r]$ is a scalar ($1 \\times 1$) matrix.\n\nTest suite (each case is $(\\text{equilibrium}, m, l, b, q_\\phi, q_{\\dot{\\phi}}, r)$):\n- Case $1$: $(\\text{upright},\\, 1.0\\,\\mathrm{kg},\\, 1.0\\,\\mathrm{m},\\, 0.05\\,\\mathrm{N\\,m\\,s},\\, 15.0,\\, 1.5,\\, 0.2)$.\n- Case $2$: $(\\text{upright},\\, 2.0\\,\\mathrm{kg},\\, 1.5\\,\\mathrm{m},\\, 0.01\\,\\mathrm{N\\,m\\,s},\\, 120.0,\\, 12.0,\\, 0.05)$.\n- Case $3$: $(\\text{downward},\\, 1.0\\,\\mathrm{kg},\\, 0.8\\,\\mathrm{m},\\, 0.02\\,\\mathrm{N\\,m\\,s},\\, 2.0,\\, 0.2,\\, 0.5)$.\n- Case $4$: $(\\text{downward},\\, 1.0\\,\\mathrm{kg},\\, 1.0\\,\\mathrm{m},\\, 0.0\\,\\mathrm{N\\,m\\,s},\\, 5.0,\\, 0.5,\\, 10.0)$.\n- Case $5$: $(\\text{upright},\\, 1.0\\,\\mathrm{kg},\\, 1.0\\,\\mathrm{m},\\, 0.5\\,\\mathrm{N\\,m\\,s},\\, 30.0,\\, 3.0,\\, 0.1)$.\n\nFor each case, compute:\n- The boolean stability indicator (all real parts of eigenvalues of $A_{\\mathrm{cl}}$ strictly negative).\n- The maximum real part among eigenvalues of $A_{\\mathrm{cl}}$ (expressed in $1/\\mathrm{s}$ as a float).\n- The minimum damping ratio surrogate $\\min_{\\lambda} \\zeta(\\lambda)$ (dimensionless as a float).\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list of the form $[\\text{stable}, \\text{max\\_real\\_part}, \\text{min\\_damping\\_ratio}]$ with the two floats rounded to six decimal places, for example, $[[\\text{True}, -1.234567, 0.789012],[\\dots],\\dots]$.",
            "solution": "The solution requires implementing a standard workflow from modern control theory. For each test case, the analysis proceeds in several steps based on the principles outlined in the problem description.\n\n1.  **System Matrix Construction**: First, the continuous-time state-space matrices, $A$ and $B$, are constructed from the given physical parameters ($m, l, b$) and the specified equilibrium condition (\"upright\" where $\\cos(\\theta_e) = -1$, or \"downward\" where $\\cos(\\theta_e) = +1$). The moment of inertia is calculated as $I = ml^2$.\n\n2.  **LQR Controller Synthesis**: The Linear Quadratic Regulator (LQR) gain, $K$, is computed. This gain is optimal with respect to the infinite-horizon quadratic cost function $J$. Finding $K$ requires solving the Continuous Algebraic Riccati Equation (CARE) for a symmetric positive semidefinite matrix $P$:\n    $$A^\\top P + P A - P B R^{-1} B^\\top P + Q = 0$$\n    This equation is solved numerically using standard computational linear algebra libraries. Once $P$ is found, the optimal gain is given by the formula $K = R^{-1} B^\\top P$.\n\n3.  **Closed-Loop Analysis**: With the gain $K$, the closed-loop system dynamics matrix is formed as $A_{\\mathrm{cl}} = A - B K$. The stability of the controlled system is determined by the eigenvalues of $A_{\\mathrm{cl}}$. The system is stable if and only if all eigenvalues have strictly negative real parts. The maximum real part among the eigenvalues is reported.\n\n4.  **Damping Quantification**: For each eigenvalue $\\lambda$ of $A_{\\mathrm{cl}}$, the damping ratio surrogate $\\zeta(\\lambda)$ is computed according to the provided piecewise formula. This formula correctly maps to the standard damping ratio for complex conjugate poles and provides a reasonable convention for real poles. The minimum value of this surrogate across all eigenvalues is reported, which indicates the worst-case damping in any of the system's response modes.\n\nThe provided Python code in the answer section implements this entire procedure, iterating through each test case to compute and report the required metrics.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_continuous_are\n\ndef solve():\n    \"\"\"\n    Solves the LQR problem for a linearized pendulum for a suite of test cases.\n    \"\"\"\n    g = 9.81  # Gravitational acceleration in m/s^2\n\n    test_cases = [\n        # (equilibrium, m, l, b, q_phi, q_dphi, r)\n        (\"upright\", 1.0, 1.0, 0.05, 15.0, 1.5, 0.2),    # Case 1\n        (\"upright\", 2.0, 1.5, 0.01, 120.0, 12.0, 0.05),  # Case 2\n        (\"downward\", 1.0, 0.8, 0.02, 2.0, 0.2, 0.5),    # Case 3\n        (\"downward\", 1.0, 1.0, 0.0, 5.0, 0.5, 10.0),   # Case 4\n        (\"upright\", 1.0, 1.0, 0.5, 30.0, 3.0, 0.1),    # Case 5\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        eq_type, m, l, b, q_phi, q_dphi, r = case\n\n        # Step 1: Construct state-space matrices A and B\n        I = m * l**2\n        cos_theta_e = -1.0 if eq_type == \"upright\" else 1.0\n\n        A = np.array([\n            [0.0, 1.0],\n            [-g/l * cos_theta_e, -b/I]\n        ])\n\n        B = np.array([\n            [0.0],\n            [1.0/I]\n        ])\n        \n        # Construct cost matrices Q and R\n        Q = np.diag([q_phi, q_dphi])\n        R = np.array([[r]])\n\n        # Step 2: Compute the LQR gain K\n        # Solve the Continuous Algebraic Riccati Equation (CARE) for P\n        # A.T*P + P*A - P*B*R_inv*B.T*P + Q = 0\n        P = solve_continuous_are(A, B, Q, R)\n\n        # Compute the optimal LQR gain K = R_inv * B.T * P\n        R_inv = np.linalg.inv(R)\n        K = R_inv @ B.T @ P\n\n        # Step 3: Form the closed-loop matrix and compute its eigenvalues\n        A_cl = A - B @ K\n        eigenvalues = np.linalg.eigvals(A_cl)\n\n        # Step 4: Determine stability and maximum eigenvalue real part\n        real_parts = np.real(eigenvalues)\n        is_stable = np.all(real_parts  0)\n        max_real_part = np.max(real_parts)\n\n        # Step 5: Compute the minimum damping ratio surrogate\n        damping_ratios = []\n        for lam in eigenvalues:\n            if np.imag(lam) != 0:\n                zeta = -np.real(lam) / np.abs(lam)\n            else: # Real eigenvalue\n                if np.real(lam)  0:\n                    zeta = 1.0\n                else:\n                    zeta = 0.0\n            damping_ratios.append(zeta)\n        \n        min_damping_ratio = np.min(damping_ratios)\n\n        all_results.append([is_stable, max_real_part, min_damping_ratio])\n    \n    # Format the final output string as specified\n    formatted_results = []\n    for res in all_results:\n        # res[0] is bool, res[1] and res[2] are floats\n        formatted_results.append(f\"[{res[0]}, {res[1]:.6f}, {res[2]:.6f}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Skilled actions like reaching require coordinating multiple joints to guide an end-effector, such as the hand, along a desired path. This presents a classic computational challenge known as the inverse kinematics problem. This exercise () introduces resolved motion rate control, a powerful method for determining the joint velocities needed to achieve a specific hand velocity. You will learn to formulate and solve this problem using a damped least-squares approach, which not only provides a solution but also ensures robust behavior near kinematic singularities, reflecting the smooth and versatile nature of biological movements.",
            "id": "3971443",
            "problem": "Consider a two-degree-of-freedom planar arm model commonly used in computational motor control to approximate kinematic transformations in the primate upper limb. Let the shoulder and elbow joint angles be $q_{1}$ and $q_{2}$, respectively, collected as $q = (q_{1}, q_{2})^{\\top}$. The end-effector (hand) Cartesian position is modeled by standard forward kinematics\n$$\nx(q) = \\begin{pmatrix}\nL_{1} \\cos(q_{1}) + L_{2} \\cos(q_{1} + q_{2}) \\\\\nL_{1} \\sin(q_{1}) + L_{2} \\sin(q_{1} + q_{2})\n\\end{pmatrix},\n$$\nwhere $L_{1}  0$ and $L_{2}  0$ are the segment lengths. The instantaneous relationship between joint angular velocity and end-effector velocity is given by\n$$\n\\dot{x} = J(q)\\,\\dot{q},\n$$\nwhere $J(q)$ is the Jacobian matrix obtained by differentiating $x(q)$ with respect to $q$.\n\nIn resolved motion rate control, one seeks joint commands $\\dot{q}$ that realize a desired end-effector velocity $\\dot{x}_{d}$ when possible and otherwise trade off task error with a penalty on joint velocity magnitude. A widely used normative construction is to define the objective\n$$\n\\mathcal{C}(\\dot{q}) = \\frac{1}{2}\\,\\|J(q)\\,\\dot{q} - \\dot{x}_{d}\\|^{2} + \\frac{1}{2}\\,\\lambda^{2}\\,\\|\\dot{q}\\|^{2},\n$$\nwith damping parameter $\\lambda  0$, and choose $\\dot{q}$ to minimize $\\mathcal{C}(\\dot{q})$. This regularization can be interpreted as a motor cost on large joint velocities in computational neuroscience models.\n\nTasks:\n1. Starting only from the definitions above and the optimization problem for $\\mathcal{C}(\\dot{q})$, derive a closed-form expression for the resolved motion rate control law $\\dot{q}$ in terms of $J(q)$, $\\dot{x}_{d}$, and $\\lambda$. Your derivation must explicitly show the stationarity condition and solve the resulting linear system.\n2. Using the derived expression, evaluate $\\dot{q}$ numerically for the following scientifically plausible parameters and state:\n   - Segment lengths: $L_{1} = 0.35\\,\\mathrm{m}$, $L_{2} = 0.25\\,\\mathrm{m}$.\n   - Joint configuration: $q_{1} = 0\\,\\mathrm{rad}$, $q_{2} = 0\\,\\mathrm{rad}$.\n   - Desired end-effector velocity: $\\dot{x}_{d} = \\begin{pmatrix} 0.05 \\\\ 0.10 \\end{pmatrix}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n   - Damping parameter: $\\lambda = 0.05\\,\\mathrm{m}$.\n   Compute the numerical values of $(\\dot{q}_{1}, \\dot{q}_{2})$ in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n3. Briefly explain, in terms of the singular value decomposition of $J(q)$, how the damping parameter $\\lambda$ mitigates the growth of joint velocities near kinematic singularities.\n\nRound your final numerical answer for $(\\dot{q}_{1}, \\dot{q}_{2})$ to four significant figures. Express the final joint velocities in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$.",
            "solution": "The fundamental kinematic relationship for a manipulator or limb model is the instantaneous velocity mapping\n$\\dot{x} = J(q)\\,\\dot{q}$,\nwhich follows from differentiating the forward kinematics $x(q)$ with respect to time and using $\\dot{q} = \\frac{dq}{dt}$.\n\nTo derive the resolved motion rate control law, we adopt the damped least squares objective\n$$\n\\mathcal{C}(\\dot{q}) = \\frac{1}{2}\\,\\|J(q)\\,\\dot{q} - \\dot{x}_{d}\\|^{2} + \\frac{1}{2}\\,\\lambda^{2}\\,\\|\\dot{q}\\|^{2},\n$$\nwhere the first term penalizes task-space velocity error and the second term is a quadratic regularization on the joint velocities. Since radians are dimensionless, $\\lambda$ has units of meters, ensuring that $\\lambda^{2}\\,\\|\\dot{q}\\|^{2}$ has the same units as the squared task-space error.\n\nWe compute the gradient of $\\mathcal{C}$ with respect to $\\dot{q}$ and set it to zero to find the minimizer. Using standard results for quadratic forms,\n$$\n\\nabla_{\\dot{q}}\\,\\mathcal{C}(\\dot{q}) = J(q)^{\\top}\\,\\big(J(q)\\,\\dot{q} - \\dot{x}_{d}\\big) + \\lambda^{2}\\,\\dot{q}.\n$$\nThe stationarity condition $\\nabla_{\\dot{q}}\\,\\mathcal{C}(\\dot{q}) = 0$ gives the normal equations\n$$\n\\big(J(q)^{\\top}\\,J(q) + \\lambda^{2}\\,I\\big)\\,\\dot{q} = J(q)^{\\top}\\,\\dot{x}_{d}.\n$$\nBecause $\\lambda > 0$, the matrix $J(q)^{\\top}\\,J(q) + \\lambda^{2}\\,I$ is symmetric positive definite and hence invertible for all $q$. Solving for $\\dot{q}$ yields the damped least squares resolved motion rate control law\n$$\n\\dot{q} = \\big(J(q)^{\\top}\\,J(q) + \\lambda^{2}\\,I\\big)^{-1}\\,J(q)^{\\top}\\,\\dot{x}_{d}.\n$$\nAn equivalent expression, obtained via standard pseudoinverse identities, is\n$$\n\\dot{q} = J(q)^{\\top}\\,\\big(J(q)\\,J(q)^{\\top} + \\lambda^{2}\\,I\\big)^{-1}\\,\\dot{x}_{d},\n$$\nwhich is often preferred when the task dimension is lower than the joint dimension. For the present two-by-two case, both forms are consistent.\n\nWe now evaluate this expression for the specified planar arm configuration. The forward kinematics are\n$$\nx(q) = \\begin{pmatrix}\nL_{1} \\cos(q_{1}) + L_{2} \\cos(q_{1} + q_{2}) \\\\\nL_{1} \\sin(q_{1}) + L_{2} \\sin(q_{1} + q_{2})\n\\end{pmatrix},\n$$\nand differentiating yields the Jacobian\n$$\nJ(q) = \\begin{pmatrix}\n-\\big(L_{1}\\,\\sin(q_{1}) + L_{2}\\,\\sin(q_{1} + q_{2})\\big)  -L_{2}\\,\\sin(q_{1} + q_{2}) \\\\\n\\phantom{-}\\big(L_{1}\\,\\cos(q_{1}) + L_{2}\\,\\cos(q_{1} + q_{2})\\big)  \\phantom{-}L_{2}\\,\\cos(q_{1} + q_{2})\n\\end{pmatrix}.\n$$\nAt $q_{1} = 0$ and $q_{2} = 0$, we have $\\sin(0) = 0$ and $\\cos(0) = 1$, so\n$$\nJ(0,0) = \\begin{pmatrix}\n0  0 \\\\\nL_{1} + L_{2}  L_{2}\n\\end{pmatrix}.\n$$\nWith $L_{1} = 0.35$ and $L_{2} = 0.25$, this becomes\n$$\nJ = \\begin{pmatrix}\n0  0 \\\\\n0.60  0.25\n\\end{pmatrix}.\n$$\nWe compute the matrices required by the control law:\n$$\nJ^{\\top}\\,J = \\begin{pmatrix}\n0^{2} + 0.60^{2}  0 \\cdot 0 + 0.60 \\cdot 0.25 \\\\\n0 \\cdot 0 + 0.25 \\cdot 0.60  0^{2} + 0.25^{2}\n\\end{pmatrix} = \\begin{pmatrix}\n0.36  0.15 \\\\\n0.15  0.0625\n\\end{pmatrix}.\n$$\nAdding the damping term with $\\lambda = 0.05$ gives\n$$\nJ^{\\top}\\,J + \\lambda^{2}\\,I = \\begin{pmatrix}\n0.36 + 0.0025  0.15 \\\\\n0.15  0.0625 + 0.0025\n\\end{pmatrix} = \\begin{pmatrix}\n0.3625  0.15 \\\\\n0.15  0.065\n\\end{pmatrix}.\n$$\nWe also compute\n$$\nJ^{\\top}\\,\\dot{x}_{d} = \\begin{pmatrix}\n0  0.60 \\\\\n0  0.25\n\\end{pmatrix} \\begin{pmatrix}\n0.05 \\\\\n0.10\n\\end{pmatrix} = \\begin{pmatrix}\n0.06 \\\\\n0.025\n\\end{pmatrix}.\n$$\nTo solve for $\\dot{q}$, we invert the $2 \\times 2$ matrix. The determinant is\n$$\n\\det\\big(J^{\\top}\\,J + \\lambda^{2}\\,I\\big) = 0.3625 \\cdot 0.065 - 0.15 \\cdot 0.15 = 0.0235625 - 0.0225 = 0.0010625.\n$$\nHence\n$$\n\\big(J^{\\top}\\,J + \\lambda^{2}\\,I\\big)^{-1} = \\frac{1}{0.0010625}\\,\\begin{pmatrix}\n0.065  -0.15 \\\\\n-0.15  0.3625\n\\end{pmatrix} = \\begin{pmatrix}\n61.1764705882  -141.1764705882 \\\\\n-141.1764705882  341.1764705882\n\\end{pmatrix}.\n$$\nMultiplying by $J^{\\top}\\,\\dot{x}_{d}$,\n$$\n\\dot{q} = \\begin{pmatrix}\n61.1764705882  -141.1764705882 \\\\\n-141.1764705882  341.1764705882\n\\end{pmatrix} \\begin{pmatrix}\n0.06 \\\\\n0.025\n\\end{pmatrix} = \\begin{pmatrix}\n0.1411764705882 \\\\\n0.0588235294118\n\\end{pmatrix}.\n$$\nRounding each component to four significant figures and expressing in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$ yields\n$$\n\\dot{q}_{1} \\approx 0.1412,\\quad \\dot{q}_{2} \\approx 0.05882.\n$$\n\nFinally, we explain how the damping parameter $\\lambda$ mitigates singularities. Consider the singular value decomposition (SVD) $J(q) = U\\,\\Sigma\\,V^{\\top}$, where $U$ and $V$ are orthogonal and $\\Sigma = \\operatorname{diag}(\\sigma_{1}, \\sigma_{2})$ contains the nonnegative singular values. The undamped pseudoinverse scales each task-space component by $\\sigma_{i}^{-1}$, which diverges as $\\sigma_{i} \\to 0$ near a kinematic singularity. In contrast, the damped least squares pseudoinverse can be written as\n$$\nJ_{\\text{DLS}}^{\\#}(q) = V\\,\\operatorname{diag}\\!\\left(\\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\lambda^{2}}\\right)\\,U^{\\top}.\n$$\nEach mode is now scaled by $\\frac{\\sigma_{i}}{\\sigma_{i}^{2} + \\lambda^{2}}$, which remains bounded and in fact approaches $0$ as $\\sigma_{i} \\to 0$. Thus, $\\lambda > 0$ prevents the amplification of commands along poorly controllable directions, ensuring finite joint velocities and smooth behavior as the configuration approaches singularities.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1412 \\\\ 0.05882 \\end{pmatrix}}$$"
        }
    ]
}