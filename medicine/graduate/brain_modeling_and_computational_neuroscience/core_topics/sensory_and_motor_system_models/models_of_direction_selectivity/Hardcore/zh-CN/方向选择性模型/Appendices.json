{
    "hands_on_practices": [
        {
            "introduction": "在神经科学中，一个常见的任务是从神经元的放电率中量化其选择性。方向选择性指数（DSI）是衡量此特性的一种标准指标。本实践旨在展示在应用此类指标时一个至关重要的考量：基线神经活动的影响。你将看到，在计算$DSI$之前简单地减去自发放电率，可以如何揭示出更强的内在选择性，这是真实数据分析中的关键一步。",
            "id": "3999440",
            "problem": "在视觉皮层的方向选择性模型中，一个定向运动刺激会引发一个放电率，该放电率可以表示为一个线性方向调谐分量与一个自发基线相加，然后通过一个强制非负性的生物物理非线性环节。具体来说，假设在首选方向和无效方向运动下的瞬时放电率分别为 $$R_{\\mathrm{pref}}$$ 和 $$R_{\\mathrm{null}}$$，单位为 $$\\mathrm{spikes}\\ \\mathrm{s}^{-1}$$。自发基线（自发放电率）为 $$r_0$$。半波整流器的模型为 $$[x]_+ = \\max(0,x)$$，这与放电率的非负性是一致的。\n\n方向选择性指数 (DSI) 由两个方向特异性响应定义为 $$\\mathrm{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}$$。基线放电和整流会使该指数产生偏差，因为它们同时提高了 $$R_{\\mathrm{pref}}$$ 和 $$R_{\\mathrm{null}}$$，并且可以防止在减去 $$r_0$$ 后出现负值。\n\n使用以下科学上合理的测量值：\n- $$R_{\\mathrm{pref}} = 38\\ \\mathrm{spikes}\\ \\mathrm{s}^{-1}$$,\n- $$R_{\\mathrm{null}} = 12\\ \\mathrm{spikes}\\ \\mathrm{s}^{-1}$$,\n- $$r_0 = 10\\ \\mathrm{spikes}\\ \\mathrm{s}^{-1}$$,\n\n计算：\n1. 直接使用 $$R_{\\mathrm{pref}}$$ 和 $$R_{\\mathrm{null}}$$ 计算原始方向选择性指数 $$\\mathrm{DSI}_{\\mathrm{raw}}$$。\n2. 计算基线校正后的方向选择性指数 $$\\mathrm{DSI}_{\\mathrm{corr}}$$。该指数的计算方法是：首先从每个测量到的放电率中减去 $$r_0$$，对结果进行半波整流，然后利用经过基线减除和整流后的响应计算相同的指数。\n\n将 $$\\mathrm{DSI}_{\\mathrm{raw}}$$ 和 $$\\mathrm{DSI}_{\\mathrm{corr}}$$ 均表示为无单位小数，并四舍五入至四位有效数字。按 $$\\mathrm{DSI}_{\\mathrm{raw}}$$、$$\\mathrm{DSI}_{\\mathrm{corr}}$$ 的顺序报告这两个值。",
            "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n提供了以下数据和定义：\n-   首选方向的瞬时放电率：$$R_{\\mathrm{pref}} = 38\\ \\mathrm{spikes}\\ \\mathrm{s}^{-1}$$\n-   无效方向的瞬时放电率：$$R_{\\mathrm{null}} = 12\\ \\mathrm{spikes}\\ \\mathrm{s}^{-1}$$\n-   自发基线率：$$r_0 = 10\\ \\mathrm{spikes}\\ \\mathrm{s}^{-1}$$\n-   半波整流函数：$$[x]_+ = \\max(0,x)$$\n-   方向选择性指数 (DSI) 的定义：$$\\mathrm{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}$$\n-   任务 1：计算原始 DSI，$$\\mathrm{DSI}_{\\mathrm{raw}}$$。\n-   任务 2：计算基线校正后的 DSI，$$\\mathrm{DSI}_{\\mathrm{corr}}$$。\n-   四舍五入要求：将结果报告为无单位小数，保留四位有效数字。\n-   报告顺序：$$\\mathrm{DSI}_{\\mathrm{raw}}$$、$$\\mathrm{DSI}_{\\mathrm{corr}}$$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是计算神经科学中的一个标准计算，涉及一个简化但广泛使用的神经元响应模型。放电率、自发活动、整流（强制非负性）和方向选择性指数等概念是该领域的基础。所提供的放电率数值在生理上是合理的。问题是自洽的，提供了所有必要的数据和定义。指示清晰，可以得出一个唯一且有意义的解。没有科学或事实上的不健全之处，没有歧义，也没有矛盾。因此，该问题被认定为 **有效**。\n\n### 解答\n解答过程是根据所提供的定义和数据，计算两个所求量 $$\\mathrm{DSI}_{\\mathrm{raw}}$$ 和 $$\\mathrm{DSI}_{\\mathrm{corr}}$$。\n\n**1. 原始方向选择性指数 ($$\\mathrm{DSI}_{\\mathrm{raw}}$$) 的计算**\n\n原始 DSI 是使用给定的公式，直接从测量到的放电率 $$R_{\\mathrm{pref}}$$ 和 $$R_{\\mathrm{null}}$$ 计算得出的。\nDSI 的公式为：\n$$\\mathrm{DSI} = \\frac{R_{\\mathrm{pref}} - R_{\\mathrm{null}}}{R_{\\mathrm{pref}} + R_{\\mathrm{null}}}$$\n代入给定值 $$R_{\\mathrm{pref}} = 38$$ 和 $$R_{\\mathrm{null}} = 12$$：\n$$\\mathrm{DSI}_{\\mathrm{raw}} = \\frac{38 - 12}{38 + 12}$$\n$$\\mathrm{DSI}_{\\mathrm{raw}} = \\frac{26}{50}$$\n$$\\mathrm{DSI}_{\\mathrm{raw}} = 0.52$$\n四舍五入到四位有效数字，我们得到 $$\\mathrm{DSI}_{\\mathrm{raw}} = 0.5200$$。\n\n**2. 基线校正后方向选择性指数 ($$\\mathrm{DSI}_{\\mathrm{corr}}$$) 的计算**\n\n基线校正后的 DSI 是使用经过自发基线率 $$r_0$$ 校正并随后进行半波整流的响应来计算的。\n\n让我们将减去基线并整流后的响应定义为 $$R'_{\\mathrm{pref}}$$ 和 $$R'_{\\mathrm{null}}$$。\n首先，我们从测量到的放电率中减去基线率 $$r_0$$：\n-   首选方向，整流前：$$R_{\\mathrm{pref}} - r_0 = 38 - 10 = 28$$\n-   无效方向，整流前：$$R_{\\mathrm{null}} - r_0 = 12 - 10 = 2$$\n\n接下来，我们将半波整流函数 $$[x]_+ = \\max(0, x)$$ 应用于这些相减后的值：\n$$R'_{\\mathrm{pref}} = [R_{\\mathrm{pref}} - r_0]_+ = [28]_+ = \\max(0, 28) = 28$$\n$$R'_{\\mathrm{null}} = [R_{\\mathrm{null}} - r_0]_+ = [2]_+ = \\max(0, 2) = 2$$\n\n现在，我们使用这些校正后的响应 $$R'_{\\mathrm{pref}}$$ 和 $$R'_{\\mathrm{null}}$$ 来计算 DSI：\n$$\\mathrm{DSI}_{\\mathrm{corr}} = \\frac{R'_{\\mathrm{pref}} - R'_{\\mathrm{null}}}{R'_{\\mathrm{pref}} + R'_{\\mathrm{null}}}$$\n代入校正后的值：\n$$\\mathrm{DSI}_{\\mathrm{corr}} = \\frac{28 - 2}{28 + 2}$$\n$$\\mathrm{DSI}_{\\mathrm{corr}} = \\frac{26}{30} = \\frac{13}{15}$$\n为了将其表示为小数，我们进行除法运算：\n$$\\mathrm{DSI}_{\\mathrm{corr}} = 0.86666...$$\n四舍五入到四位有效数字，我们得到 $$\\mathrm{DSI}_{\\mathrm{corr}} = 0.8667$$。\n\n问题要求按顺序给出 $$\\mathrm{DSI}_{\\mathrm{raw}}$$ 和 $$\\mathrm{DSI}_{\\mathrm{corr}}$$ 这两个值，并四舍五入到四位有效数字。\n最终结果是 $$0.5200$$ 和 $$0.8667$$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.5200  0.8667 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在量化了选择性之后，下一步是理解产生选择性的机制。“延迟-比较”操作是一个基本原理，本练习将模拟其生物物理实现。通过这个实践，你将从头开始构建一个基于电导的神经元的计算模型。通过模拟具有不同轴突延迟的输入如何整合，你将具体理解神经硬件如何实现一个抽象的计算基元以达成方向选择性。",
            "id": "3999490",
            "problem": "要求您在一个简单的、基于电导的神经元中形式化并计算方向选择性，该神经元接收两个具有不同轴突延迟、空间上分离的兴奋性输入。该神经元是一个具有被动漏电和两个突触电导的单个等电位房室，由一个移动刺激驱动，该刺激依次激活两个输入位点。任务是推导、实现并评估突触总和仅在偏好方向上是相长的条件。\n\n使用以下基本依据和定义：\n\n- 神经元遵循具有时变总电导的单个房室的被动膜方程，\n$$\nC_m \\frac{dV(t)}{dt} \\;=\\; -g_L\\left(V(t) - E_L\\right) \\;-\\; \\sum_{i=1}^2 g_i(t)\\left(V(t) - E_E\\right),\n$$\n其中 $C_m$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏电反转电位，$E_E$ 是兴奋性突触反转电位，$g_i(t)$ 是突触电导。\n\n- 每个突触电导都是一个在其到达胞体时被触发的 alpha 函数，\n$$\ng_i(t) \\;=\\; \\bar g \\,\\alpha\\!\\left(t - t_{a,i}\\right), \\quad \\alpha(s) \\;=\\; \\begin{cases}\n\\frac{s}{\\tau_s}\\,\\exp\\!\\left(1 - \\frac{s}{\\tau_s}\\right),  s \\ge 0,\\\\\n0,  s  0,\n\\end{cases}\n$$\n其中 $\\bar g$ 是突触峰值电导，$\\tau_s$ 是突触时间常数。\n\n- 两个输入位于位置 $x_1$ 和 $x_2$，其中 $x_1 = 0$ 且 $x_2 = \\Delta x$，$\\Delta x \\ge 0$。一个点刺激以恒定速度 $v$ 沿着连接 $x_1$ 和 $x_2$ 的直线移动。在偏好方向上，刺激以速度 $v0$ 从 $x_1$ 移动到 $x_2$，使得刺激在这些位置的到达时间为 $t_{s,1}^{\\mathrm{PD}} = 0$ 和 $t_{s,2}^{\\mathrm{PD}} = \\Delta x / v$。在非偏好方向上，刺激以相等的速度大小从 $x_2$ 移动到 $x_1$，给出 $t_{s,1}^{\\mathrm{ND}} = \\Delta x / v$ 和 $t_{s,2}^{\\mathrm{ND}} = 0$。\n\n- 每个输入都有从其位置到胞体的轴突传导延迟，分别表示为 $d_1$ 和 $d_2$，因此在胞体的突触到达时间为 $t_{a,i}^{\\mathrm{dir}} = t_{s,i}^{\\mathrm{dir}} + d_i$，其中方向 $\\mathrm{dir} \\in \\{\\mathrm{PD}, \\mathrm{ND}\\}$。\n\n- 初始条件为 $V(0) = E_L$。\n\n科学任务：\n\n1. 从膜方程和突触电导的定义出发，推导在何种条件下时间总和仅在偏好方向上是相长的，这个条件应是关于 $\\Delta x$、$v$、$d_1$、$d_2$ 和 $\\tau_s$ 的。请用突触到达的相对时间和突触时间常数来精确陈述你的条件。\n\n2. 使用上述生物物理参数，实现 $V(t)$ 的时域仿真，并计算每个测试用例在偏好方向和非偏好方向上的峰值膜电位（以毫伏为单位）。使用具有分段常数电导的线性常微分方程的每步精确解，或与基本依据一致的、同样合理且稳定的数值方法。\n\n3. 对于每个测试用例，计算方向选择性指数（DSI），定义为\n$$\n\\mathrm{DSI} \\;=\\; \\frac{V_{\\max}^{\\mathrm{PD}} - V_{\\max}^{\\mathrm{ND}}}{V_{\\max}^{\\mathrm{PD}} + V_{\\max}^{\\mathrm{ND}}},\n$$\n其中 $V_{\\max}^{\\mathrm{PD}}$ 和 $V_{\\max}^{\\mathrm{ND}}$ 分别是各自的峰值膜电位（以毫伏为单位）。将 DSI 报告为一个无量纲的十进制数。\n\n在所有仿真中使用以下固定的生物物理参数：\n- $C_m = 200\\,\\mathrm{pF}$，\n- $g_L = 10\\,\\mathrm{nS}$，\n- $E_L = -65\\,\\mathrm{mV}$，\n- $E_E = 0\\,\\mathrm{mV}$，\n- $\\bar g = 5\\,\\mathrm{nS}$，\n- $\\tau_s = 2\\,\\mathrm{ms}$。\n\n使用仿真时间步长 $\\Delta t = 0.05\\,\\mathrm{ms}$，总仿真窗口为 $T = 100\\,\\mathrm{ms}$。所有时间量必须以毫秒为单位，距离以毫米为单位，电导以纳西门子为单位，电容以皮法为单位，电压以毫伏为单位。您必须以毫米/毫秒为单位计算和使用 $v$。\n\n测试套件：\n\n提供以下四个参数集的结果，其中每个测试用例都是一个元组 $(\\Delta x, v, d_1, d_2)$，使用上述指定的单位：\n\n- A 例（偏好方向对齐）：$(0.2, 0.05, 4.0, 0.0)$。\n- B 例（非偏好方向对齐）：$(0.2, 0.05, 0.0, 4.0)$。\n- C 例（对称延迟）：$(0.2, 0.05, 2.0, 2.0)$。\n- D 例（共址输入）：$(0.0, 0.05, 1.0, 3.0)$。\n\n实现和输出要求：\n\n- 实现仿真并计算每个测试用例的 $V_{\\max}^{\\mathrm{PD}}$ 和 $V_{\\max}^{\\mathrm{ND}}$（以毫伏为单位）。\n- 根据上述定义计算每个测试用例的方向选择性指数。\n- 最终程序输出必须是单行，包含一个 Python 列表，其中有四个浮点 DSI 值，按 A、B、C、D 的顺序对应每个测试用例，每个值四舍五入到六位小数，以逗号分隔并用方括号括起来，例如，“[0.123456,-0.234567,0.000000,0.000000]”。",
            "solution": "我们从基于电导的单房室被动膜方程开始，\n$$\nC_m \\frac{dV(t)}{dt} \\;=\\; -g_L\\left(V(t) - E_L\\right) \\;-\\; \\sum_{i=1}^2 g_i(t)\\left(V(t) - E_E\\right),\n$$\n其中 $V(0)=E_L$。突触电导是以下形式的 alpha 函数\n$$\ng_i(t) = \\bar g \\,\\alpha\\!\\left(t - t_{a,i}\\right),\\quad \\alpha(s) = \\frac{s}{\\tau_s}\\,e^{1 - s/\\tau_s}\\;\\text{for}\\; s\\ge 0,\\;\\text{and}\\; \\alpha(s)=0\\;\\text{for}\\; s0,\n$$\n其中 $t_{a,i}$ 是突触到达胞体的时间。对于偏好方向（从 $x_1$ 到 $x_2$），我们有两个位置的刺激到达时间\n$$\nt_{s,1}^{\\mathrm{PD}}=0,\\qquad t_{s,2}^{\\mathrm{PD}}=\\frac{\\Delta x}{v},\n$$\n并且有轴突延迟 $d_1$ 和 $d_2$，胞体到达时间是\n$$\nt_{a,1}^{\\mathrm{PD}}=d_1,\\qquad t_{a,2}^{\\mathrm{PD}}=\\frac{\\Delta x}{v} + d_2.\n$$\n对于非偏好方向（从 $x_2$ 到 $x_1$），\n$$\nt_{s,2}^{\\mathrm{ND}}=0,\\qquad t_{s,1}^{\\mathrm{ND}}=\\frac{\\Delta x}{v},\n$$\n因此胞体到达时间是\n$$\nt_{a,2}^{\\mathrm{ND}}=d_2,\\qquad t_{a,1}^{\\mathrm{ND}}=\\frac{\\Delta x}{v} + d_1.\n$$\n\n相长求和要求两个突触电导在胞体处的时间上大量重叠，这发生在它们的到达时间差与突触时间常数相比很小的时候。对于偏好方向，到达时间间隔是\n$$\n\\Delta t_{\\mathrm{PD}} \\;=\\; t_{a,2}^{\\mathrm{PD}} - t_{a,1}^{\\mathrm{PD}} \\;=\\; \\frac{\\Delta x}{v} + d_2 - d_1.\n$$\n对于非偏好方向，\n$$\n\\Delta t_{\\mathrm{ND}} \\;=\\; t_{a,1}^{\\mathrm{ND}} - t_{a,2}^{\\mathrm{ND}} \\;=\\; \\frac{\\Delta x}{v} + d_1 - d_2 \\;=\\; -\\Delta t_{\\mathrm{PD}}.\n$$\n因此，仅在偏好方向上实现相长求和的充分必要时间条件是 $|\\Delta t_{\\mathrm{PD}}| \\ll \\tau_s$ 而 $|\\Delta t_{\\mathrm{ND}}| \\gg \\tau_s$。实现这一点的一个自然方法是设置\n$$\n\\Delta t_{\\mathrm{PD}} = \\frac{\\Delta x}{v} + d_2 - d_1 \\approx 0 \\quad \\Longleftrightarrow \\quad d_1 - d_2 \\approx \\frac{\\Delta x}{v},\n$$\n这样延迟就补偿了偏好方向上刺激在两个位置之间的传输时间。在那种情况下，非偏好方向的时间间隔变为\n$$\n\\Delta t_{\\mathrm{ND}} = -\\Delta t_{\\mathrm{PD}} \\approx 0 \\;\\text{with sign flipped only if the above is exact.}\n$$\n然而，代入精确补偿 $d_1 - d_2 = \\Delta x / v$ 会得到 $\\Delta t_{\\mathrm{PD}} = 0$ 以及\n$$\n\\Delta t_{\\mathrm{ND}} \\;=\\; \\frac{\\Delta x}{v} + d_1 - d_2 \\;=\\; \\frac{\\Delta x}{v} + \\frac{\\Delta x}{v} \\;=\\; \\frac{2\\Delta x}{v},\n$$\n当 $\\frac{2\\Delta x}{v} \\gg \\tau_s$ 时，这个值与 $\\tau_s$ 相比很大。因此，仅在偏好方向上求和是相长的精确条件是\n$$\n\\left| \\frac{\\Delta x}{v} + d_2 - d_1 \\right| \\ll \\tau_s\n\\quad \\text{and} \\quad\n\\frac{2\\Delta x}{v} \\gg \\tau_s.\n$$\n第一个条件确保了在偏好方向上的同时性，第二个条件确保了在非偏好方向上的时间分离。\n\n仿真算法设计：\n\n- 我们在时间网格上进行仿真，步长为 $\\Delta t$，直到 $T$。在每个时间步，使用带有相应 $t_{a,i}$ 的 alpha 函数计算任一方向的 $g_{\\mathrm{syn}}(t) = g_1(t) + g_2(t)$。\n- 膜方程是具有时变系数的线性方程。在一个总电导近似恒定的小步长内，常微分方程\n$$\n\\frac{dV}{dt} = -\\frac{g_L + g_{\\mathrm{syn}}(t)}{C_m} V + \\frac{g_L E_L + g_{\\mathrm{syn}}(t) E_E}{C_m}\n$$\n有精确的每步解\n$$\nV(t+\\Delta t) = V_\\infty(t) + \\left(V(t) - V_\\infty(t)\\right)\\exp\\!\\left(-\\frac{g_L + g_{\\mathrm{syn}}(t)}{C_m}\\Delta t\\right),\n$$\n其中 $V_\\infty(t) = \\frac{g_L E_L + g_{\\mathrm{syn}}(t) E_E}{g_L + g_{\\mathrm{syn}}(t)}$ 是瞬时不动点。\n- 初始化 $V(0)=E_L$ 并进行迭代，以获得偏好和非偏好方向的 $V(t)$。记录峰值 $V_{\\max}^{\\mathrm{PD}}$ 和 $V_{\\max}^{\\mathrm{ND}}$。\n- 计算方向选择性指数为\n$$\n\\mathrm{DSI} = \\frac{V_{\\max}^{\\mathrm{PD}} - V_{\\max}^{\\mathrm{ND}}}{V_{\\max}^{\\mathrm{PD}} + V_{\\max}^{\\mathrm{ND}}}.\n$$\n\n测试套件覆盖范围：\n\n- A 例设置 $d_1 - d_2 = \\Delta x / v$ （其中 $\\Delta x = 0.2$，$v = 0.05$，所以 $\\Delta x/v = 4.0$），满足了偏好方向的同时性条件，并产生了一个非偏好方向的时间间隔 $2\\Delta x/v = 8.0$，这个值比 $\\tau_s = 2.0$ 大，所以我们预期 $\\mathrm{DSI}$ 为正且较大。\n- B 例设置 $d_1 - d_2 = -\\Delta x / v$，对齐了非偏好方向，所以预期 $\\mathrm{DSI}$ 为负。\n- C 例使用对称延迟 $d_1 = d_2$，因此 $|\\Delta t_{\\mathrm{PD}}| = |\\Delta t_{\\mathrm{ND}}| = \\Delta x/v$，导致相似的峰值响应和接近零的 $\\mathrm{DSI}$。\n- D 例设置 $\\Delta x = 0$，使得刺激在不同方向上的到达时间相同，所以 $\\mathrm{DSI}$ 应接近零。\n\n程序实现了上述仿真，计算了峰值电压（以毫伏为单位），并按指定测试用例的顺序输出一行，其中包含一个 Python 列表，内有四个方向选择性指数值，每个值都四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef alpha_function(t, tau_s):\n    \"\"\"\n    Alpha function: alpha(s) = (s/tau_s) * exp(1 - s/tau_s) for s = 0, else 0.\n    Vectorized for numpy arrays.\n    \"\"\"\n    s = t\n    out = np.zeros_like(s)\n    mask = s = 0.0\n    sm = s[mask]\n    # Avoid underflow/overflow issues by direct computation; tau_s  0 by design.\n    out[mask] = (sm / tau_s) * np.exp(1.0 - sm / tau_s)\n    return out\n\ndef simulate_peak_response(C_m, g_L, E_L, E_E, g_peak, tau_s,\n                           delta_x, v, d1, d2,\n                           dt=0.05, T=100.0, direction='PD'):\n    \"\"\"\n    Simulate the membrane potential V(t) for a given direction (PD or ND)\n    and return the peak membrane potential in mV.\n    Units:\n      - C_m in pF, g_* in nS, E_* in mV, tau_s in ms, dt in ms, T in ms\n      - delta_x in mm, v in mm/ms, d1, d2 in ms\n    \"\"\"\n    # Time vector\n    t = np.arange(0.0, T + dt, dt)\n\n    # Stimulus arrival times at locations x1=0, x2=delta_x for PD and ND\n    ts1_PD = 0.0\n    ts2_PD = (delta_x / v) if v != 0 else 0.0\n    ts1_ND = (delta_x / v) if v != 0 else 0.0\n    ts2_ND = 0.0\n\n    if direction == 'PD':\n        ta1 = ts1_PD + d1\n        ta2 = ts2_PD + d2\n    else:\n        ta1 = ts1_ND + d1\n        ta2 = ts2_ND + d2\n\n    # Synaptic conductances (nS) as alpha functions\n    g1 = g_peak * alpha_function(t - ta1, tau_s)\n    g2 = g_peak * alpha_function(t - ta2, tau_s)\n    gsyn = g1 + g2\n\n    # Precompute constants\n    V = E_L  # initial condition at rest\n    Vmax = V\n\n    # Iterate with exact per-step solution:\n    # V_{k+1} = V_inf + (V_k - V_inf) * exp(-(g_L + gsyn)/C_m * dt)\n    # where V_inf = (g_L*E_L + gsyn*E_E)/(g_L + gsyn)\n    for k in range(len(t) - 1):\n        gtot = g_L + gsyn[k]  # nS\n        # Instantaneous fixed point\n        V_inf = (g_L * E_L + gsyn[k] * E_E) / gtot\n        # Effective rate in 1/ms since (nS)/(pF) = 1/ms\n        rate = gtot / C_m\n        V = V_inf + (V - V_inf) * np.exp(-rate * dt)\n        if V  Vmax:\n            Vmax = V\n\n    return Vmax\n\ndef direction_selectivity_index(Vpd_peak, Vnd_peak):\n    \"\"\"\n    Compute DSI = (PD - ND)/(PD + ND).\n    \"\"\"\n    denom = Vpd_peak + Vnd_peak\n    # To be safe, handle extremely small denom (though in this model denom  0)\n    if denom == 0.0:\n        return 0.0\n    return (Vpd_peak - Vnd_peak) / denom\n\ndef solve():\n    # Fixed biophysical parameters\n    C_m = 200.0    # pF\n    g_L = 10.0     # nS\n    E_L = -65.0    # mV\n    E_E = 0.0      # mV\n    g_peak = 5.0   # nS\n    tau_s = 2.0    # ms\n\n    # Simulation parameters\n    dt = 0.05      # ms\n    T = 100.0      # ms\n\n    # Test cases: (delta_x [mm], v [mm/ms], d1 [ms], d2 [ms])\n    test_cases = [\n        (0.2, 0.05, 4.0, 0.0),  # Case A: PD alignment (d1 - d2 = delta_x/v = 4.0 ms)\n        (0.2, 0.05, 0.0, 4.0),  # Case B: ND alignment (d1 - d2 = -4.0 ms)\n        (0.2, 0.05, 2.0, 2.0),  # Case C: symmetric delays\n        (0.0, 0.05, 1.0, 3.0),  # Case D: co-located inputs delta_x = 0\n    ]\n\n    results = []\n    for (delta_x, v, d1, d2) in test_cases:\n        # Preferred direction\n        Vpd_peak = simulate_peak_response(C_m, g_L, E_L, E_E, g_peak, tau_s,\n                                          delta_x, v, d1, d2,\n                                          dt=dt, T=T, direction='PD')\n        # Null direction\n        Vnd_peak = simulate_peak_response(C_m, g_L, E_L, E_E, g_peak, tau_s,\n                                          delta_x, v, d1, d2,\n                                          dt=dt, T=T, direction='ND')\n        dsi = direction_selectivity_index(Vpd_peak, Vnd_peak)\n        # Round to six decimals for output\n        results.append(round(dsi, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}