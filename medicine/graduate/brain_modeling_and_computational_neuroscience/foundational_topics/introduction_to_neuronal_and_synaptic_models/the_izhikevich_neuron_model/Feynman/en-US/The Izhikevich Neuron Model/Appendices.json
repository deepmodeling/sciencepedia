{
    "hands_on_practices": [
        {
            "introduction": "A fundamental property of any neuron is its excitability threshold—the minimum input required to elicit a spike. In a dynamical systems framework, this transition from rest to firing can be precisely described as a bifurcation. This first practice invites you to analytically determine the rheobase current for the Izhikevich model by finding the exact point where its resting state equilibrium disappears, providing a direct link between the model's equations and a core neurophysiological concept. ",
            "id": "4029523",
            "problem": "Consider the Izhikevich neuron model, which describes the membrane potential dynamics and a recovery variable using the system of ordinary differential equations\n$$\\frac{dv}{dt} = 0.04\\,v^{2} + 5\\,v + 140 - u + I,$$\n$$\\frac{du}{dt} = a\\,(b\\,v - u),$$\nwith spike emission and reset defined by the after-spike condition: when $v$ reaches a threshold, the membrane potential and recovery variable undergo a reset $v \\leftarrow c$ and $u \\leftarrow u + d$. Assume a constant injected current $I$ and focus on the existence and disappearance of fixed points of the continuous dynamics prior to any spike reset.\n\nA parameter set exhibiting Type I excitability (onset via a Saddle-Node on Invariant Circle (SNIC) bifurcation) is given by\n$$a = 0.02,\\quad b = 0.2,\\quad c = -65,\\quad d = 8.$$\nUsing the definitions of fixed points for autonomous dynamical systems and the necessary condition for a Saddle-Node bifurcation (coalescence of equilibria accompanied by vanishing discriminant of the reduced equilibrium condition), compute the rheobase current $I_{\\text{rh}}$, defined here as the smallest constant $I$ at which the resting fixed point of the subthreshold dynamics disappears. Report the exact value of $I_{\\text{rh}}$ in the model’s normalized current units (no unit conversion is required). No rounding is needed; provide the exact result.",
            "solution": "The problem requires the calculation of the rheobase current, $I_{\\text{rh}}$, for the Izhikevich neuron model under a specific parameter set. The rheobase current is defined as the smallest constant input current $I$ at which the fixed points of the subthreshold dynamics disappear. This disappearance occurs through a saddle-node bifurcation.\n\nThe dynamics of the Izhikevich model are described by the following system of ordinary differential equations:\n$$\n\\frac{dv}{dt} = 0.04\\,v^{2} + 5\\,v + 140 - u + I\n$$\n$$\n\\frac{du}{dt} = a\\,(b\\,v - u)\n$$\nThe parameters relevant to the subthreshold dynamics are given as $a = 0.02$ and $b = 0.2$. The reset parameters $c = -65$ and $d = 8$ are not involved in the analysis of the fixed points.\n\nA fixed point, or equilibrium point, $(v^*, u^*)$ of the system is a point where the time derivatives are zero. Thus, we must solve the system of algebraic equations:\n$$\n\\frac{dv}{dt} = 0 \\implies 0.04\\,(v^*)^{2} + 5\\,v^* + 140 - u^* + I = 0\n$$\n$$\n\\frac{du}{dt} = 0 \\implies a\\,(b\\,v^* - u^*) = 0\n$$\n\nFrom the second equation, since the parameter $a = 0.02 \\neq 0$, we must have:\n$$\nb\\,v^* - u^* = 0\n$$\nThis implies that at any fixed point, the recovery variable $u^*$ is a linear function of the membrane potential $v^*$:\n$$\nu^* = b\\,v^*\n$$\nThis equation defines the $u$-nullcline of the system.\n\nTo find the value(s) of $v^*$ at the fixed point(s), we substitute this expression for $u^*$ into the first equation (the $v$-nullcline):\n$$\n0.04\\,(v^*)^{2} + 5\\,v^* + 140 - (b\\,v^*) + I = 0\n$$\nCombining the terms involving $v^*$, we obtain a single quadratic equation for $v^*$:\n$$\n0.04\\,(v^*)^{2} + (5 - b)\\,v^* + (140 + I) = 0\n$$\nThe roots of this quadratic equation correspond to the membrane potential values of the system's fixed points. The number of real roots, and thus the number of fixed points, is determined by the discriminant of this quadratic equation. A standard quadratic equation of the form $Ax^2+Bx+C=0$ has a discriminant $\\Delta = B^2-4AC$. In our case, the coefficients are:\n$$\nA = 0.04\n$$\n$$\nB = 5 - b\n$$\n$$\nC = 140 + I\n$$\nThe system has two distinct fixed points when $\\Delta > 0$, one fixed point when $\\Delta = 0$, and no real fixed points when $\\Delta  0$. The disappearance of the fixed points corresponds to the transition from $\\Delta > 0$ to $\\Delta  0$. The boundary case, which defines the saddle-node bifurcation, occurs precisely when the discriminant is zero.\n$$\n\\Delta = (5 - b)^2 - 4(0.04)(140 + I) = 0\n$$\nWe are asked to find the rheobase current $I_{\\text{rh}}$, which is the value of $I$ that satisfies this annihilation condition. We can now substitute the given value for the parameter $b = 0.2$:\n$$\n(5 - 0.2)^2 - 4(0.04)(140 + I_{\\text{rh}}) = 0\n$$\n$$\n(4.8)^2 - 0.16(140 + I_{\\text{rh}}) = 0\n$$\nNow, we compute the square and simplify:\n$$\n23.04 - 0.16(140 + I_{\\text{rh}}) = 0\n$$\nRearranging the equation to solve for $I_{\\text{rh}}$:\n$$\n23.04 = 0.16(140 + I_{\\text{rh}})\n$$\nDivide both sides by $0.16$:\n$$\n\\frac{23.04}{0.16} = 140 + I_{\\text{rh}}\n$$\nThe division yields:\n$$\n144 = 140 + I_{\\text{rh}}\n$$\nFinally, solving for $I_{\\text{rh}}$:\n$$\nI_{\\text{rh}} = 144 - 140 = 4\n$$\nThus, the rheobase current at which the resting fixed point disappears via a saddle-node bifurcation is $4$ in the model's normalized current units. For $I  4$, the system has two fixed points (a stable node representing the resting state and a saddle point). For $I > 4$, the system has no fixed points, and the membrane potential will grow unboundedly (in the context of the subthreshold dynamics), leading to the emission of a spike.",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "While analytical methods reveal key thresholds, the true richness of the Izhikevich model is expressed in its dynamic behavior over time. This exercise transitions from static analysis to dynamic simulation, tasking you with implementing the model to generate spike trains and quantify a hallmark of many real neurons: spike-frequency adaptation. By translating the model's equations into code and analyzing the output, you will develop the core practical skills needed to explore the diverse repertoire of neuronal firing patterns. ",
            "id": "4064812",
            "problem": "Design and implement a program that simulates the Izhikevich spiking neuron in the regular spiking (RS) regime and computes inter-spike intervals (ISIs) and an adaptation ratio. Use the following definitions, which are the foundation for the Izhikevich model. The membrane potential is denoted by $v$ (in $\\mathrm{mV}$), the recovery variable by $u$ (dimensionless), and the externally applied current by $I$ (in model-consistent current units that yield $v$ in $\\mathrm{mV}$ and time in $\\mathrm{ms}$). The Izhikevich model is governed by the system of ordinary differential equations (ODEs): \n$$\n\\frac{dv}{dt} = 0.04v^2 + 5v + 140 - u + I, \\quad \\frac{du}{dt} = a(bv - u),\n$$\nwith an after-spike reset condition applied when the membrane potential reaches the spike threshold:\n$$\n\\text{if } v \\ge 30, \\text{ then set } v \\leftarrow c \\text{ and } u \\leftarrow u + d.\n$$\nAssume initial conditions $v(0)=c$ and $u(0)=bv(0)$. Simulate using a fixed-step explicit Euler method with a time step $\\Delta t$ (in $\\mathrm{ms}$), and implement spike event detection by linear interpolation within each time step: if $v$ crosses the spike threshold from below within a step, estimate the spike time $t_{\\text{spike}}$ in $\\mathrm{ms}$ by linearly interpolating between the pre-step and post-step values of $v$. Use the first crossing per step, and immediately apply the reset rule at that step.\n\nDefine the inter-spike intervals (ISIs) as the differences between successive spike times, in milliseconds. The adaptation ratio is defined as the ratio $\\text{ISI}_1/\\text{ISI}_5$, where $\\text{ISI}_k$ denotes the $k$-th ISI (in order of occurrence). If fewer than $6$ spikes occur within the simulation window, define the adaptation ratio as `nan` (not-a-number).\n\nAll times must be expressed in $\\mathrm{ms}$, voltages in $\\mathrm{mV}$, and the adaptation ratio is dimensionless. Your program must compute results for the test suite below and produce a single line of output containing the adaptation ratios for each test case as a comma-separated list enclosed in square brackets, e.g., \n`[ratio_1,ratio_2,ratio_3]`. Round each ratio to $6$ decimal places. If a ratio is undefined, output `nan` in its position.\n\nTest suite (all cases use the RS parameters):\n- Regular spiking (RS) parameters: $(a,b,c,d) = (0.02,0.2,-65,8)$.\n- Spike threshold: $30 \\,\\mathrm{mV}$.\n\nCases:\n- Case A (happy path): constant current $I=14$, total simulation time $T=1000 \\,\\mathrm{ms}$, time step $\\Delta t = 0.1 \\,\\mathrm{ms}$.\n- Case B (low-current boundary): constant current $I=5$, total simulation time $T=1000 \\,\\mathrm{ms}$, time step $\\Delta t = 0.1 \\,\\mathrm{ms}$.\n- Case C (high-current and smaller step): constant current $I=30$, total simulation time $T=500 \\,\\mathrm{ms}$, time step $\\Delta t = 0.05 \\,\\mathrm{ms}$.\n\nFor each case, compute the first five inter-spike intervals in $\\mathrm{ms}$, then compute the adaptation ratio $\\text{ISI}_1/\\text{ISI}_5$. The required final output format is a single line:\n`[ratio_A,ratio_B,ratio_C]`\nwith each numeric value rounded to $6$ decimals and with `nan` where fewer than $6$ spikes occurred within the window. No other text should be printed.",
            "solution": "The user wants to simulate the Izhikevich neuron model, specifically for the regular spiking (RS) regime, and compute a spike adaptation ratio from the resulting spike train.\n\n### Step 1: Problem Validation\n\nFirst, I will validate the problem statement according to the specified criteria.\n\n#### Givens Extraction\n\n-   **Model Equations**:\n    $$\n    \\frac{dv}{dt} = 0.04v^2 + 5v + 140 - u + I\n    $$\n    $$\n    \\frac{du}{dt} = a(bv - u)\n    $$\n-   **State Variables**: $v$ (membrane potential, $\\mathrm{mV}$), $u$ (recovery variable, dimensionless).\n-   **Input Current**: $I$.\n-   **Spike Reset Condition**: If $v \\ge 30 \\, \\mathrm{mV}$, then $v \\leftarrow c$ and $u \\leftarrow u + d$.\n-   **Initial Conditions**: $v(0)=c$, $u(0)=bv(0)$.\n-   **Simulation Method**: Fixed-step explicit Euler method with time step $\\Delta t$.\n-   **Spike Detection**: Linear interpolation for spike time $t_{\\text{spike}}$ when $v$ crosses the threshold of $30 \\, \\mathrm{mV}$ from below within a time step. The reset is to be applied \"at that step\".\n-   **Definitions**:\n    -   Inter-Spike Interval (ISI): Time difference between successive spikes.\n    -   Adaptation Ratio: $\\text{ISI}_1/\\text{ISI}_5$. Value is $\\mathrm{nan}$ if fewer than $6$ spikes occur.\n-   **Parameters**:\n    -   Regular Spiking (RS): $(a,b,c,d) = (0.02, 0.2, -65, 8)$.\n    -   Spike Threshold: $30 \\, \\mathrm{mV}$.\n-   **Test Cases**:\n    -   Case A: $I=14$, $T=1000 \\, \\mathrm{ms}$, $\\Delta t = 0.1 \\, \\mathrm{ms}$.\n    -   Case B: $I=5$, $T=1000 \\, \\mathrm{ms}$, $\\Delta t = 0.1 \\, \\mathrm{ms}$.\n    -   Case C: $I=30$, $T=500 \\, \\mathrm{ms}$, $\\Delta t = 0.05 \\, \\mathrm{ms}$.\n-   **Output Format**: A single line `[ratio_A,ratio_B,ratio_C]`, with ratios rounded to $6$ decimal places and including `nan` where appropriate.\n\n#### Validation Analysis\n\n1.  **Scientifically Grounded**: The problem is based on the Izhikevich neuron model, a cornerstone of computational neuroscience published in a highly-cited 2003 paper. The parameters and behavior (regular spiking) are standard and well-documented. The problem is scientifically sound.\n2.  **Well-Posed**: The problem provides a complete set of differential equations, initial conditions, parameters, and a specified numerical method (explicit Euler). This ensures that a unique numerical solution can be computed. The required outputs are unambiguously defined based on the simulation results.\n3.  **Objective**: The problem is stated using precise mathematical and computational language. All parameters and conditions are given as objective numerical values.\n4.  **Completeness and Consistency**: All necessary information is provided. Variables, parameters, and units ($\\mathrm{mV}$, $\\mathrm{ms}$) are consistent throughout the problem description.\n5.  **No Other Flaws**: The problem is not trivial, metaphorical, or outside the scope of scientific verifiability. It is a standard numerical simulation task in a scientific domain.\n\n#### Verdict\n\nThe problem is **valid**. It is a well-defined task in computational neuroscience that requires the implementation of a standard numerical method to simulate a well-known model.\n\n### Step 2: Solution Design and Implementation\n\nThe solution involves numerically integrating the given system of two ordinary differential equations (ODEs) using the explicit Euler method, while handling the specified spike-and-reset condition.\n\n#### Numerical Method: Explicit Euler\n\nThe explicit Euler method approximates the state of the system at time $t + \\Delta t$ based on the state and its rate of change at time $t$. For our system $(v, u)$, the update rules for a single time step $\\Delta t$ are:\n$$\nv_{n+1} = v_n + \\Delta t \\cdot \\left( \\frac{dv}{dt} \\right)\\bigg|_{t_n} = v_n + \\Delta t \\cdot (0.04v_n^2 + 5v_n + 140 - u_n + I)\n$$\n$$\nu_{n+1} = u_n + \\Delta t \\cdot \\left( \\frac{du}{dt} \\right)\\bigg|_{t_n} = u_n + \\Delta t \\cdot a(bv_n - u_n)\n$$\nHere, $(v_n, u_n)$ represents the state at the beginning of the step (time $t_n$), and $(v_{n+1}, u_{n+1})$ is the tentative state at the end of the step (time $t_{n+1} = t_n + \\Delta t$).\n\n#### Simulation Algorithm\n\nFor each test case, the simulation proceeds as follows:\n1.  **Initialization**:\n    -   Set the parameters $(a,b,c,d,I,T,\\Delta t)$ for the specific case.\n    -   Initialize the state variables at time $t=0$: $v \\leftarrow c$ and $u \\leftarrow b \\cdot c$.\n    -   Initialize an empty list, `spike_times`, to store the times at which spikes occur.\n\n2.  **Time-Stepping Loop**: The simulation iterates for a total time $T$, with a fixed time step $\\Delta t$. In each step, from current time $t$ and state $(v, u)$:\n    -   Store the current voltage as $v_{\\text{old}} \\leftarrow v$.\n    -   Compute the tentative next state $(v_{\\text{next}}, u_{\\text{next}})$ at time $t+\\Delta t$ using the explicit Euler formulas described above.\n    -   **Spike Detection**: Check if the membrane potential has crossed the spike threshold $v_{\\text{thresh}} = 30 \\, \\mathrm{mV}$ from below. This condition is $v_{\\text{old}}  v_{\\text{thresh}}$ and $v_{\\text{next}} \\ge v_{\\text{thresh}}$.\n    -   **State Update**:\n        -   **If a spike is detected**:\n            1.  The precise spike time, $t_{\\text{spike}}$, is estimated using linear interpolation between the points $(t, v_{\\text{old}})$ and $(t+\\Delta t, v_{\\text{next}})$:\n                $$\n                t_{\\text{spike}} = t + \\Delta t \\frac{v_{\\text{thresh}} - v_{\\text{old}}}{v_{\\text{next}} - v_{\\text{old}}}\n                $$\n            2.  This $t_{\\text{spike}}$ is appended to the `spike_times` list.\n            3.  The after-spike reset rule is applied to determine the state for the next time step. The problem specifies a fixed-step method and an immediate reset \"at that step\". This is interpreted to mean the state at time $t+\\Delta t$ becomes the reset state. The voltage is reset to $c$, and the recovery variable $u$ is incremented by $d$. The value of $u$ to be incremented is the one calculated for the end of the step, $u_{\\text{next}}$, as this reflects the accumulation of the recovery process during the action potential's upstroke. Thus, for the next step, we set:\n                $$\n                v \\leftarrow c\n                $$\n                $$\n                u \\leftarrow u_{\\text{next}} + d\n                $$\n        -   **If no spike is detected**: The state for the next step is simply the Euler-approximated state:\n            $$\n            v \\leftarrow v_{\\text{next}}\n            $$\n            $$\n            u \\leftarrow u_{\\text{next}}\n            $$\n\n3.  **Post-Simulation Analysis**:\n    -   After the simulation loop completes, check the number of recorded spikes.\n    -   If fewer than $6$ spikes were recorded, it's not possible to compute five ISIs. In this case, the adaptation ratio is defined as not-a-number ($\\mathrm{nan}$).\n    -   If $6$ or more spikes were recorded, the Inter-Spike Intervals (ISIs) are calculated as the differences between consecutive spike times: $\\text{ISI}_k = t_{\\text{spike}, k+1} - t_{\\text{spike}, k}$.\n    -   The adaptation ratio is then computed as the ratio of the first ISI to the fifth ISI:\n        $$\n        \\text{Ratio} = \\frac{\\text{ISI}_1}{\\text{ISI}_5}\n        $$\n\n4.  **Final Output**: The computed ratio is rounded to $6$ decimal places. The results for all test cases are collected and formatted into the required string `[ratio_A,ratio_B,ratio_C]`.\n\nThis entire procedure is encapsulated in a Python script. A function `simulate_neuron` implements the simulation and analysis for a single test case, and a `solve` function iterates through the given test suite, calling the simulation function and printing the final formatted result.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_neuron(params):\n    \"\"\"\n    Simulates the Izhikevich neuron model for a given set of parameters.\n\n    Args:\n        params (tuple): A tuple containing (a, b, c, d, I, T, dt).\n\n    Returns:\n        float: The computed adaptation ratio, or np.nan if undefined.\n    \"\"\"\n    # Unpack parameters\n    a, b, c, d, I, T, dt = params\n    v_thresh = 30.0\n\n    # Initial conditions\n    v = c\n    u = b * c\n    \n    spike_times = []\n    \n    # Use a precise number of steps to avoid floating point issues with the loop range\n    num_steps = int(round(T / dt))\n\n    for i in range(num_steps):\n        current_t = i * dt\n        v_old = v\n        \n        # Explicit Euler step: calculate derivatives at the current state (v, u)\n        dv_dt = 0.04 * v**2 + 5 * v + 140 - u + I\n        du_dt = a * (b * v - u)\n        \n        # Calculate tentative state for the next time step\n        v_next = v + dv_dt * dt\n        u_next = u + du_dt * dt\n        \n        # Spike detection: check for threshold crossing from below\n        if v_old  v_thresh and v_next >= v_thresh:\n            # Estimate spike time using linear interpolation\n            if v_next - v_old > 0: # Avoid division by zero\n                t_spike = current_t + dt * (v_thresh - v_old) / (v_next - v_old)\n                spike_times.append(t_spike)\n            else: # Should not happen on upstroke, but as a safeguard\n                spike_times.append(current_t + dt)\n\n            # Apply reset rule for the state at the beginning of the next step.\n            # This is the standard way to handle resets in fixed-step methods.\n            v = c\n            u = u_next + d\n        else:\n            # No spike, so the state for the next step is the Euler-updated state\n            v = v_next\n            u = u_next\n            \n    # Calculate adaptation ratio after the simulation is complete\n    # At least 6 spikes are needed to compute 5 ISIs.\n    if len(spike_times)  6:\n        return np.nan\n        \n    isis = np.diff(spike_times)\n    \n    # The length of isis is len(spike_times) - 1. We need at least 5 ISIs.\n    if len(isis)  5:\n        return np.nan\n        \n    adaptation_ratio = isis[0] / isis[4]\n    \n    return adaptation_ratio\n\ndef solve():\n    \"\"\"\n    Runs the Izhikevich neuron simulation for all test cases and prints the result.\n    \"\"\"\n    # Define the regular spiking (RS) parameters\n    # (a, b, c, d)\n    rs_params = (0.02, 0.2, -65.0, 8.0)\n    \n    # Define the test cases from the problem statement\n    # Each case is a tuple: (*rs_params, I, T, dt)\n    test_cases = [\n        # Case A: happy path\n        (*rs_params, 14.0, 1000.0, 0.1),\n        # Case B: low-current boundary\n        (*rs_params, 5.0, 1000.0, 0.1),\n        # Case C: high-current and smaller step\n        (*rs_params, 30.0, 500.0, 0.05)\n    ]\n\n    results = []\n    for case in test_cases:\n        ratio = simulate_neuron(case)\n        if np.isnan(ratio):\n            results.append(\"nan\")\n        else:\n            # Round the result to 6 decimal places as required\n            results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solution\nsolve()\n```"
        },
        {
            "introduction": "A computer simulation is an approximation of a mathematical model, and its accuracy is fundamentally limited by the numerical methods used. This advanced practice addresses the critical issue of numerical fidelity, a cornerstone of responsible computational science. You will investigate how the choice of simulation time step, $\\Delta t$, affects the model's output and implement a convergence test to determine when a simulation result can be considered reliable, a crucial skill for distinguishing genuine model behavior from numerical artifacts. ",
            "id": "4029521",
            "problem": "Consider the Izhikevich neuron model, which describes the membrane potential and recovery variable dynamics via ordinary differential equations (ODEs). The model is defined by the system\n$$\n\\frac{dv}{dt} = 0.04 v^2 + 5 v + 140 - u + I,\\quad \\frac{du}{dt} = a\\,(b\\,v - u),\n$$\ntogether with the after-spike resetting rule applied whenever the membrane potential crosses the spike threshold,\n$$\n\\text{if } v \\ge 30 \\text{ then } v \\leftarrow c,\\quad u \\leftarrow u + d.\n$$\nUse the standard \"regular spiking\" parameters $a=0.02$, $b=0.2$, $c=-65$, $d=8$, and initialize the state at $v(0)=c$, $u(0)=b\\,c$. Assume the dynamics are integrated using the explicit first-order forward Euler method with a fixed time step $ \\Delta t $ in milliseconds, and that the spike threshold is checked after each Euler update. The membrane potential $v$ and the recovery variable $u$ are in model units (dimensionless). The input current $I$ is constant (dimensionless model units).\n\nThe firing rate as a function of input current (the $f$–$I$ curve) is estimated by counting spikes over a finite simulation duration $T$ and dividing by the duration in seconds. Explicitly, if $N_{\\text{spike}}$ spikes occur over $T$ milliseconds, the firing rate $f$ must be reported in Hertz (Hz) as\n$$\nf = \\frac{N_{\\text{spike}}}{T/1000}.\n$$\n\nYour task is to compute the effect of numerical discretization on $f$–$I$ curve estimation and to design a convergence diagnostic that distinguishes numerical artifacts from true model behavior. Proceed from first principles of numerical integration and ODE error analysis, without using any specialized shortcut formulas beyond the Izhikevich model itself and fundamental properties of the explicit Euler method.\n\nImplement a program that:\n- Simulates the Izhikevich model using explicit Euler with time steps $\\Delta t \\in \\{1.0, 0.5, 0.25, 0.125\\}$ milliseconds.\n- For each specified test case, computes firing rates for a set of constant currents $I$ at all specified $\\Delta t$ values over a simulation duration $T$ milliseconds, and then evaluates a convergence diagnostic for each $I$:\n  1. Define the sequence of firing rates $f_{\\Delta t}$, $f_{\\Delta t/2}$, $f_{\\Delta t/4}$, $f_{\\Delta t/8}$.\n  2. Define successive absolute differences $D_1 = |f_{\\Delta t} - f_{\\Delta t/2}|$, $D_2 = |f_{\\Delta t/2} - f_{\\Delta t/4}|$, $D_3 = |f_{\\Delta t/4} - f_{\\Delta t/8}|$.\n  3. Define the convergence ratio\n     $$\n     R = \\frac{D_1}{D_2},\n     $$\n     which is expected to be near $2$ for a first-order method when the solution is smooth in the relevant sense.\n  4. Declare the diagnostic to pass for a current $I$ if all of the following are satisfied:\n     - Monotone refinement of differences: $D_1 \\ge D_2 \\ge D_3$.\n     - Asymptotic ratio consistency: $R$ lies within the interval $[1.25, 3.0]$ whenever $D_2 > 0$; if $D_2 = 0$ and $D_1 = 0$, treat this condition as satisfied.\n     - Fine-scale stability: $D_3 \\le \\epsilon$, with $\\epsilon = 1.0$ Hz.\n     Additionally, if all four firing rates are exactly zero for a given $I$ (no spiking across all discretizations), treat the diagnostic as trivially satisfied for that $I$.\n  5. The test case result is the boolean indicating whether the diagnostic passes for all currents in that case.\n\nScientific realism requirements:\n- Use $T = 2000$ milliseconds for all simulations, and report firing rates in Hertz (Hz).\n- The explicit Euler method must be used to approximate the ODEs, and spikes must be detected by thresholding $v$ at $30$ after each Euler update, applying the reset instantaneously when a spike is detected. This event handling should be identical across all $\\Delta t$ values.\n\nTest suite:\n- Case $1$ (general \"happy path\"): $I \\in \\{10, 14, 20, 30\\}$, $T = 2000$ ms, base step $\\Delta t_0 = 1.0$ ms.\n- Case $2$ (near rheobase boundary): $I \\in \\{6, 8, 10\\}$, $T = 2000$ ms, base step $\\Delta t_0 = 1.0$ ms.\n- Case $3$ (high-input regime): $I \\in \\{40, 60\\}$, $T = 2000$ ms, base step $\\Delta t_0 = 1.0$ ms.\n- Case $4$ (subthreshold edge): $I \\in \\{0, 2\\}$, $T = 2000$ ms, base step $\\Delta t_0 = 1.0$ ms.\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated list of booleans (one per test case), enclosed in square brackets, for example [`True`, `False`, `True`, `True`]. Each boolean indicates whether the convergence diagnostic passes for all currents in the corresponding test case. This line must be the only output produced by the program.",
            "solution": "The problem requires the implementation and analysis of the Izhikevich neuron model, a system of ordinary differential equations (ODEs) with a discontinuous reset condition, to assess the impact of numerical discretization on the calculated firing rate. The analysis is performed using a custom convergence diagnostic based on fundamental principles of numerical error analysis for the explicit first-order forward Euler method.\n\nThe Izhikevich model is defined by the following system for the membrane potential $v(t)$ and the recovery variable $u(t)$:\n$$\n\\frac{dv}{dt} = 0.04 v^2 + 5 v + 140 - u + I\n$$\n$$\n\\frac{du}{dt} = a(b v - u)\n$$\nwhere $I$ is a constant input current. A spike is registered and the state variables are reset when $v$ reaches a threshold of $30$:\n$$\n\\text{if } v \\ge 30, \\text{ then } v \\leftarrow c \\text{ and } u \\leftarrow u + d.\n$$\nThe problem specifies the use of parameters for \"regular spiking\" neurons: $a = 0.02$, $b = 0.2$, $c = -65$, and $d = 8$. The initial conditions are set to a resting state, $v(0) = c = -65$ and $u(0) = b \\cdot c = 0.2 \\cdot (-65) = -13$.\n\nThe solution to this ODE system is approximated using the explicit first-order forward Euler method. Given the state $(v_n, u_n)$ at time $t_n$, the state $(v_{n+1}, u_{n+1})$ at time $t_{n+1} = t_n + \\Delta t$ is computed as:\n$$\nv_{n+1} = v_n + \\Delta t \\left( 0.04 v_n^2 + 5 v_n + 140 - u_n + I \\right)\n$$\n$$\nu_{n+1} = u_n + \\Delta t \\left( a(b v_n - u_n) \\right)\n$$\nIt is crucial that the derivatives for both $v$ and $u$ are evaluated at the same time point $t_n$, using the values $v_n$ and $u_n$. After each Euler step, the new potential $v_{n+1}$ is checked against the spike threshold. If $v_{n+1} \\ge 30$, a spike is counted, and the reset conditions are applied instantaneously to the just-computed state: $v_{n+1}$ is set to $c$, and $u_{n+1}$ is incremented by $d$.\n\nThe core of the problem is to evaluate a convergence diagnostic for the firing rate, $f$, which is a functional of the solution trajectory. The firing rate is calculated as $f = N_{\\text{spike}} / (T/1000)$, where $N_{\\text{spike}}$ is the total number of spikes over a simulation duration of $T = 2000$ milliseconds. This calculation converts the rate to Hertz (Hz). The diagnostic assesses how the computed rate $f$ changes as the time step $\\Delta t$ is refined. Simulations are run for a sequence of time steps $\\Delta t \\in \\{1.0, 0.5, 0.25, 0.125\\}$ ms. Let the corresponding firing rates be $f_1, f_2, f_3, f_4$.\n\nThe diagnostic consists of three conditions grounded in the theory of numerical integration:\n\n1.  **Monotone Refinement of Differences**: $D_1 \\ge D_2 \\ge D_3$, where $D_1 = |f_1 - f_2|$, $D_2 = |f_2 - f_3|$, and $D_3 = |f_3 - f_4|$. This condition checks that successive refinements of $\\Delta t$ lead to progressively smaller changes in the computed firing rate. This indicates well-behaved convergence. A violation, such as $D_1  D_2$, can suggest oscillatory convergence or that the coarser time steps are in a region of numerical instability.\n\n2.  **Asymptotic Ratio Consistency**: The ratio of successive differences, $R = D_1 / D_2$, is expected to approach $2^p$ for a method of order $p$. For the first-order Euler method ($p=1$), this ratio should be approximately $2$. The diagnostic requires $R \\in [1.25, 3.0]$ when $D_2 > 0$. This interval provides a reasonable tolerance for deviations from the ideal asymptotic behavior, which are expected in a system with discontinuities like spike resets. If $D_2=0$ and $D_1=0$, the rates have converged, so this condition is considered satisfied.\n\n3.  **Fine-scale Stability**: The absolute difference at the finest scale, $D_3$, must be below a tolerance $\\epsilon = 1.0$ Hz. This ensures that the computed rate is sufficiently close to its converged value and that further refinements of $\\Delta t$ would likely yield only minor changes.\n\nA special case is handled where no spikes are detected for any of the four time steps. In this subthreshold regime, all four firing rates are $0$, and the diagnostic is considered trivially passed. For a given test case, the final result is `True` only if this diagnostic passes for every input current $I$ in that case.\n\nThe implementation consists of three main parts. First, a function `simulate_izhikevich` that executes the simulation for a given set of parameters ($I$, $\\Delta t$, etc.) and returns the spike count. Second, a function `evaluate_diagnostic` that, for a given current $I$, runs the simulation for all four $\\Delta t$ values, computes the firing rates, and evaluates the three conditions of the diagnostic. Finally, a main `solve` function iterates through the predefined test cases, calls the diagnostic evaluation for each current within a case, and aggregates the boolean results as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    \n    # Model parameters for regular spiking (RS)\n    a = 0.02\n    b = 0.2\n    c = -65.0\n    d = 8.0\n\n    # Simulation and diagnostic parameters\n    T = 2000.0  # ms\n    time_steps = [1.0, 0.5, 0.25, 0.125] # ms\n    epsilon = 1.0 # Hz\n\n    # Test suite\n    test_cases = [\n        # Case 1: general \"happy path\"\n        {'I_values': [10.0, 14.0, 20.0, 30.0]},\n        # Case 2: near rheobase boundary\n        {'I_values': [6.0, 8.0, 10.0]},\n        # Case 3: high-input regime\n        {'I_values': [40.0, 60.0]},\n        # Case 4: subthreshold edge\n        {'I_values': [0.0, 2.0]},\n    ]\n\n    def simulate_izhikevich(I_val, dt):\n        \"\"\"\n        Simulates the Izhikevich neuron model using forward Euler.\n        \n        Args:\n            I_val (float): Input current.\n            dt (float): Time step in ms.\n        \n        Returns:\n            int: Number of spikes.\n        \"\"\"\n        v = c\n        u = b * c\n        spike_count = 0\n        \n        num_steps = int(T / dt)\n        \n        for _ in range(num_steps):\n            # Forward Euler update\n            v_old = v\n            u_old = u\n            \n            dv = (0.04 * v_old**2 + 5.0 * v_old + 140.0 - u_old + I_val)\n            du = a * (b * v_old - u_old)\n            \n            v = v_old + dt * dv\n            u = u_old + dt * du\n            \n            # Spike detection and reset\n            if v >= 30.0:\n                spike_count += 1\n                v = c\n                u = u + d\n                \n        return spike_count\n\n    def evaluate_diagnostic(I_val):\n        \"\"\"\n        Calculates firing rates and evaluates the convergence diagnostic for a given current.\n        \n        Args:\n            I_val (float): Input current.\n            \n        Returns:\n            bool: True if the diagnostic passes, False otherwise.\n        \"\"\"\n        firing_rates = []\n        for dt in time_steps:\n            n_spikes = simulate_izhikevich(I_val, dt)\n            rate = n_spikes / (T / 1000.0)\n            firing_rates.append(rate)\n\n        # Trivial pass condition: no spikes at any resolution\n        if all(rate == 0 for rate in firing_rates):\n            return True\n\n        # Define successive absolute differences\n        D1 = abs(firing_rates[0] - firing_rates[1])\n        D2 = abs(firing_rates[1] - firing_rates[2])\n        D3 = abs(firing_rates[2] - firing_rates[3])\n\n        # 1. Monotone refinement of differences\n        cond_monotonicity = (D1 >= D2) and (D2 >= D3)\n\n        # 2. Asymptotic ratio consistency\n        cond_ratio = False\n        if D2 > 0:\n            R = D1 / D2\n            if 1.25 = R = 3.0:\n                cond_ratio = True\n        elif D1 == 0:  # and D2 is implicitly 0\n            cond_ratio = True\n        \n        # 3. Fine-scale stability\n        cond_stability = (D3 = epsilon)\n\n        return cond_monotonicity and cond_ratio and cond_stability\n\n    results = []\n    for case in test_cases:\n        case_passed = True\n        for I in case['I_values']:\n            if not evaluate_diagnostic(I):\n                case_passed = False\n                break\n        results.append(case_passed)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}