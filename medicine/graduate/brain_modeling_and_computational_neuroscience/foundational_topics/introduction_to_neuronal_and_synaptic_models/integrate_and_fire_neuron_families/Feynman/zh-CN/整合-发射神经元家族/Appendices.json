{
    "hands_on_practices": [
        {
            "introduction": "我们从整合发放神经元家族中最基础的成员——漏电整合发放（LIF）模型开始。这项练习将通过无量纲化这一关键的建模技巧，帮助您将模型的动力学提炼至其核心参数，从而揭示控制其行为的本质因素。计算其发放率是将模型参数与神经元基本功能（即信息传递）联系起来的第一步，是理解神经编码的基础。",
            "id": "3990565",
            "problem": "一个单室漏积分放电 (LIF) 神经元遵循电流平衡方程 $C \\,\\frac{dV}{dt} = -g_{L}\\,(V - E_{L}) + I(t)$，其阈值为 $V_{\\text{th}}$，并在超过阈值后瞬时重置为 $V_{r}$。此处，$C$ 是膜电容，$g_{L}$ 是漏电导，$E_{L}$ 是漏泄反转电位。定义膜时间常数 $\\tau_{m} = \\frac{C}{g_{L}}$ 和膜电阻 $R_{m} = \\frac{1}{g_{L}}$。考虑形式为 $I(t) = I_{0} + \\sigma\\,\\xi(t)$ 的输入，其中 $\\xi(t)$ 是均值为零且相关性为 $\\langle \\xi(t)\\,\\xi(t') \\rangle = \\delta(t - t')$ 的高斯白噪声。引入无量纲变量 $\\tilde{t} = \\frac{t}{\\tau_{m}}$ 和 $\\tilde{v} = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$。\n\n任务：\n- 仅从电流平衡方程以及 $\\tau_{m}$ 和 $R_{m}$ 的定义出发，对阈下动力学进行无量纲化，以获得关于 $\\tilde{v}(\\tilde{t})$ 的随机微分方程。明确指出在恒定输入 ($\\sigma = 0$) 和随机输入 ($\\sigma \\neq 0$) 两种情况下，控制阈下动力学和脉冲生成规则的全套无量纲参数。\n- 特别考虑恒定输入情况 $\\sigma = 0$，其中无量纲输入 $\\mu \\equiv \\frac{R_{m} I_{0}}{V_{\\text{th}} - E_{L}} > 1$，重置值 $\\tilde{v}_{r} \\equiv \\frac{V_{r} - E_{L}}{V_{\\text{th}} - E_{L}}  1$，阈值为 $\\tilde{v} = 1$。从第一性原理出发，通过计算脉冲间隔并对其求倒数，推导出精确的稳态放电率 $r$。将你的最终答案表示为无量纲放电率 $\\tilde{r} \\equiv \\tau_{m}\\,r$。\n\n答案规格：\n- 你的最终答案必须是一个仅用 $\\mu$ 和 $\\tilde{v}_{r}$ 表示的、无单位的单一闭式解析表达式。",
            "solution": "该问题被认为是有效的，因为它科学上基于计算神经科学中的标准漏积分放电 (LIF) 模型，是适定的（提供了所有必要信息），并且使用精确的数学语言进行了客观陈述。\n\n该问题包含两部分。首先，我们将对膜电位的主导随机微分方程进行无量纲化。其次，我们将求解确定性情况（零噪声）下的稳态放电率。\n\n**第一部分：阈下动力学的无量纲化**\n\n出发点是 LIF 神经元的电流平衡方程：\n$$C \\frac{dV}{dt} = -g_{L}(V - E_{L}) + I(t)$$\n我们已知膜时间常数 $\\tau_{m} = \\frac{C}{g_{L}}$ 和膜电阻 $R_{m} = \\frac{1}{g_{L}}$ 的定义。将方程两边除以 $g_L$ 并代入这些定义：\n$$\\frac{C}{g_{L}}\\frac{dV}{dt} = -(V - E_{L}) + \\frac{1}{g_{L}}I(t)$$\n$$\\tau_{m}\\frac{dV}{dt} = -(V - E_{L}) + R_{m}I(t)$$\n输入电流为 $I(t) = I_{0} + \\sigma\\,\\xi(t)$，其中 $\\xi(t)$ 是高斯白噪声。代入此式可得：\n$$\\tau_{m}\\frac{dV}{dt} = -(V - E_{L}) + R_{m}I_{0} + R_{m}\\sigma\\,\\xi(t)$$\n接下来，我们引入无量纲变量：\n$$\\tilde{t} = \\frac{t}{\\tau_{m}} \\quad \\text{和} \\quad \\tilde{v} = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$$\n根据这些定义，我们可以表示原始变量及其微分。我们假设 $V_{\\text{th}} \\neq E_L$。\n$$t = \\tau_{m}\\tilde{t} \\implies dt = \\tau_{m}d\\tilde{t}$$\n$$V = E_{L} + \\tilde{v}(V_{\\text{th}} - E_{L}) \\implies dV = (V_{\\text{th}} - E_{L})d\\tilde{v}$$\n使用链式法则，$\\frac{dV}{dt} = \\frac{dV}{d\\tilde{v}} \\frac{d\\tilde{v}}{d\\tilde{t}} \\frac{d\\tilde{t}}{dt} = (V_{\\text{th}}-E_L)\\frac{d\\tilde{v}}{d\\tilde{t}}\\frac{1}{\\tau_m}$。将其代入动力学方程：\n$$\\tau_{m} \\left( \\frac{V_{\\text{th}} - E_{L}}{\\tau_{m}} \\frac{d\\tilde{v}}{d\\tilde{t}} \\right) = -[\\tilde{v}(V_{\\text{th}} - E_{L})] + R_{m}I_{0} + R_{m}\\sigma\\,\\xi(\\tau_{m}\\tilde{t})$$\n$$(V_{\\text{th}} - E_{L}) \\frac{d\\tilde{v}}{d\\tilde{t}} = -\\tilde{v}(V_{\\text{th}} - E_{L}) + R_{m}I_{0} + R_{m}\\sigma\\,\\xi(\\tau_{m}\\tilde{t})$$\n将整个方程除以 $(V_{\\text{th}} - E_{L})$：\n$$\\frac{d\\tilde{v}}{d\\tilde{t}} = -\\tilde{v} + \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}} + \\frac{R_{m}\\sigma}{V_{\\text{th}} - E_{L}}\\xi(\\tau_{m}\\tilde{t})$$\n为了将其写成标准的随机微分方程 (SDE)，我们考虑噪声项。一个形式化的 SDE 是用维纳过程增量 $dW_t$ 来写的，其中 $\\xi(t)dt = dW_t$。重标度的过程 $\\tilde{W}_{\\tilde{t}} = W_{\\tau_m \\tilde{t}} / \\sqrt{\\tau_m}$ 也是一个标准的维纳过程。其增量为 $d\\tilde{W}_{\\tilde{t}} = \\frac{1}{\\sqrt{\\tau_m}} dW_{\\tau_m \\tilde{t}} = \\frac{1}{\\sqrt{\\tau_m}} \\xi(\\tau_m \\tilde{t}) d(\\tau_m\\tilde{t}) = \\sqrt{\\tau_m} \\xi(\\tau_m \\tilde{t}) d\\tilde{t}$。因此，$\\xi(\\tau_{m}\\tilde{t})d\\tilde{t} = \\frac{1}{\\sqrt{\\tau_m}}d\\tilde{W}_{\\tilde{t}}$。\n微分形式的 SDE 为：\n$$d\\tilde{v} = \\left(-\\tilde{v} + \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}\\right)d\\tilde{t} + \\frac{R_{m}\\sigma}{V_{\\text{th}} - E_{L}}\\xi(\\tau_{m}\\tilde{t})d\\tilde{t}$$\n$$d\\tilde{v} = \\left(-\\tilde{v} + \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}\\right)d\\tilde{t} + \\frac{R_{m}\\sigma}{(V_{\\text{th}} - E_{L})\\sqrt{\\tau_m}}d\\tilde{W}_{\\tilde{t}}$$\n现在我们可以确定无量纲参数。\n恒定输入项是 $\\mu = \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}$。\n噪声幅度是 $\\tilde{\\sigma} = \\frac{R_{m}\\sigma}{(V_{\\text{th}} - E_{L})\\sqrt{\\tau_m}}$。\n无量纲化的 SDE 是：\n$$d\\tilde{v} = (-\\tilde{v} + \\mu)d\\tilde{t} + \\tilde{\\sigma}d\\tilde{W}_{\\tilde{t}}$$\n脉冲生成规则也必须无量纲化。\n阈值 $V = V_{\\text{th}}$ 变为 $\\tilde{v}_{\\text{th}} = \\frac{V_{\\text{th}} - E_{L}}{V_{\\text{th}} - E_{L}} = 1$。\n重置电位 $V = V_{r}$ 变为 $\\tilde{v}_{r} = \\frac{V_{r} - E_{L}}{V_{\\text{th}} - E_{L}}$。\n\n完整的无量纲参数集是：\n1.  对于恒定输入（$\\sigma=0$，因此 $\\tilde{\\sigma}=0$）：动力学由 $\\mu = \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}$ 控制，脉冲重置规则由 $\\tilde{v}_{r} = \\frac{V_{r} - E_{L}}{V_{\\text{th}} - E_{L}}$ 控制。\n2.  对于随机输入（$\\sigma \\neq 0$）：动力学由 $\\mu$ 和 $\\tilde{\\sigma} = \\frac{R_{m}\\sigma}{(V_{\\text{th}} - E_{L})\\sqrt{\\tau_m}}$ 控制，脉冲重置规则由 $\\tilde{v}_{r}$ 控制。\n\n**第二部分：恒定输入下的放电率**\n\n我们专门研究 $\\sigma = 0$ 即 $\\tilde{\\sigma} = 0$ 的恒定输入情况。控制方程变成一个确定性的常微分方程：\n$$\\frac{d\\tilde{v}}{d\\tilde{t}} = -\\tilde{v} + \\mu$$\n给定条件为 $\\mu > 1$ 和重置值 $\\tilde{v}_{r}  1$。阈值在 $\\tilde{v}_{\\text{th}} = 1$。\n为了求解放电率，我们首先计算脉冲间隔 $\\tilde{T}_{\\text{ISI}}$，即 $\\tilde{v}$ 从 $\\tilde{v}_{r}$ 演变到 $\\tilde{v}_{\\text{th}}$ 所需的时间。\n我们通过分离变量法或作为一阶线性方程来求解该常微分方程。\n$$\\frac{d\\tilde{v}}{\\mu - \\tilde{v}} = d\\tilde{t}$$\n从 $\\tilde{v}(\\tilde{t}=0)=\\tilde{v}_{r}$ 积分到 $\\tilde{v}(\\tilde{t}=\\tilde{T}_{\\text{ISI}})=1$：\n$$\\int_{\\tilde{v}_{r}}^{1} \\frac{d\\tilde{v}'}{\\mu - \\tilde{v}'} = \\int_{0}^{\\tilde{T}_{\\text{ISI}}} d\\tilde{t}'$$\n$$[-\\ln|\\mu - \\tilde{v}'|]_{\\tilde{v}_{r}}^{1} = \\tilde{T}_{\\text{ISI}}$$\n由于 $\\mu > 1$ 且 $\\tilde{v}$ 保持在 1 以下（因此也低于 $\\mu$），项 $\\mu - \\tilde{v}'$ 总是正的。\n$$(-\\ln(\\mu - 1)) - (-\\ln(\\mu - \\tilde{v}_{r})) = \\tilde{T}_{\\text{ISI}}$$\n$$\\tilde{T}_{\\text{ISI}} = \\ln(\\mu - \\tilde{v}_{r}) - \\ln(\\mu - 1)$$\n$$\\tilde{T}_{\\text{ISI}} = \\ln\\left(\\frac{\\mu - \\tilde{v}_{r}}{\\mu - 1}\\right)$$\n这是无量纲的脉冲间隔。有量纲的 ISI 是 $T_{\\text{ISI}} = \\tau_{m}\\tilde{T}_{\\text{ISI}}$。\n放电率是 $r = \\frac{1}{T_{\\text{ISI}}}$。\n问题要求的是无量纲放电率 $\\tilde{r} = \\tau_{m}r$。\n$$\\tilde{r} = \\tau_{m} \\left( \\frac{1}{T_{\\text{ISI}}} \\right) = \\tau_{m} \\left( \\frac{1}{\\tau_{m}\\tilde{T}_{\\text{ISI}}} \\right) = \\frac{1}{\\tilde{T}_{\\text{ISI}}}$$\n代入 $\\tilde{T}_{\\text{ISI}}$ 的表达式：\n$$\\tilde{r} = \\frac{1}{\\ln\\left(\\frac{\\mu - \\tilde{v}_{r}}{\\mu - 1}\\right)}$$\n这是无量纲放电率关于 $\\mu$ 和 $\\tilde{v}_{r}$ 的最终表达式。条件 $\\mu > 1$ 和 $\\tilde{v}_{r}  1$ 确保了 $\\mu - \\tilde{v}_{r} > \\mu - 1 > 0$，因此对数的自变量大于 1，放电率 $\\tilde{r}$ 是正的且良定义的。\n另一种方法是，常微分方程 $\\frac{d\\tilde{v}}{d\\tilde{t}} + \\tilde{v} = \\mu$ 在初始条件 $\\tilde{v}(0)=\\tilde{v}_r$ 下的解为 $\\tilde{v}(\\tilde{t}) = \\mu + (\\tilde{v}_r - \\mu)\\exp(-\\tilde{t})$。设 $\\tilde{v}(\\tilde{T}_{\\text{ISI}})=1$ 可得 $1 = \\mu + (\\tilde{v}_r - \\mu)\\exp(-\\tilde{T}_{\\text{ISI}})$，整理后为 $\\exp(-\\tilde{T}_{\\text{ISI}}) = \\frac{1-\\mu}{\\tilde{v}_r-\\mu} = \\frac{\\mu-1}{\\mu-\\tilde{v}_r}$。取负对数得到 $\\tilde{T}_{\\text{ISI}} = -\\ln\\left(\\frac{\\mu-1}{\\mu-\\tilde{v}_r}\\right) = \\ln\\left(\\frac{\\mu-\\tilde{v}_r}{\\mu-1}\\right)$，这证实了前面的结果。",
            "answer": "$$\\boxed{\\frac{1}{\\ln\\left(\\frac{\\mu - \\tilde{v}_{r}}{\\mu - 1}\\right)}}$$"
        },
        {
            "introduction": "接下来，我们探讨二次整合发放（QIF）模型，这是对LIF模型的一个重要的非线性扩展。QIF模型是I型兴奋性的典范，它与神经元如何从静息状态开始发放动作电位的基本分岔理论紧密相连。这项练习将引导您使用一个巧妙的数学变换，将电压动力学映射到一个相位圆上，从而揭示其潜在的周期性行为以及其特征性发放率标度的起源。",
            "id": "3990549",
            "problem": "考虑一个由恒定超阈值输入驱动的二次积分发放 (QIF) 神经元。其无量纲形式的膜电位动力学由以下常微分方程 (ODE) 决定\n$$\n\\frac{dV}{dt} = V^{2} + \\eta,\n$$\n其中 $V$ 是膜电位，$t$ 是时间，$\\eta0$ 是一个恒定输入（有时被解释为与基电流的距离）。在 QIF 的约定中，当 $V$ 爆发至 $+\\infty$ 时，记录一个脉冲，随后电位立即重置为 $-\\infty$。因此，在恒定驱动下，脉冲间期 $T(\\eta)$ 是轨迹从 $V=-\\infty$ 演化到 $V=+\\infty$ 所需的时间。\n\n从这个 ODE 和脉冲/重置约定出发，使用一个将 $V \\in \\mathbb{R} \\cup \\{\\pm \\infty\\}$ 紧致化到一个圆上的相映射，精确推导出 $T(\\eta)$。为此，引入一个平滑的变量代换 $V=\\tan(\\theta/2)$，它将 $V \\in \\mathbb{R}\\cup\\{\\pm\\infty\\}$ 映射到一个相位 $\\theta \\in [0,2\\pi)$，推导相应的相动力学，并计算相位上一次完整旋转的周期。仅使用基础微积分和三角恒等式，并且除了那些可从标准方法推导出的积分外，不假设任何预先计算好的积分。然后，在 $\\eta \\downarrow 0$ 的情况下，基于相流缓慢区域附近的动力学，使用一个有原理的渐近论证，解释为什么 $T(\\eta)$ 会发散，并确定其随 $\\eta$ 的标度关系。\n\n以 $\\eta$ 的函数形式，提供 $T(\\eta)$ 的闭式表达式。无需单位。最终答案必须是单个解析表达式。",
            "solution": "分析始于验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   **运动方程**：二次积分发放 (QIF) 神经元的膜电位 $V$ 根据微分方程 $\\frac{dV}{dt} = V^{2} + \\eta$ 演化。\n-   **参数**：$V$ 是膜电位，$t$ 是时间，$\\eta > 0$ 是一个恒定输入。\n-   **脉冲-重置机制**：当 $V \\to +\\infty$ 时发生脉冲，之后 $V$ 立即重置为 $-\\infty$。\n-   **脉冲间期**：脉冲间期 $T(\\eta)$ 是轨迹从 $V = -\\infty$ 演化到 $V = +\\infty$ 所需的时间。\n-   **方法**：该问题要求使用变量代换 $V = \\tan(\\theta/2)$ 将动力学从 $V$ 空间转换到相变量 $\\theta \\in [0, 2\\pi)$。任务是推导出 $\\theta$ 的动力学，计算一次完整旋转的周期以求得 $T(\\eta)$，然后分析小 $\\eta$ 值下 $T(\\eta)$ 的渐近行为。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：QIF 模型是计算神经科学中一个典型的、基础性的重要模型，代表 I 型神经兴奋性。给定的 ODE 是一个标准的无量纲形式。变换 $V = \\tan(\\theta/2)$ 是一项成熟的技术，它将 QIF 模型与 theta-神经元模型（一种基于相的表示方法）联系起来。该问题在科学上和数学上都是合理的。\n-   **适定性**：该问题是适定的。它明确了起点（ODE）、方法（变量代换）和目标（推导 $T(\\eta)$ 及其标度关系）。条件 $\\eta > 0$ 确保输入是超阈值的，这保证了周期性脉冲发放和明确、唯一的脉冲间期。\n-   **客观性**：该问题以精确的数学语言陈述，没有任何主观性或模糊性。\n\n### 步骤 3：结论与行动\n问题有效。我们继续求解。\n\n### 脉冲间期 $T(\\eta)$ 的推导\n\n电压动力学由下式给出：\n$$\n\\frac{dV}{dt} = V^{2} + \\eta\n$$\n我们引入指定的变量代换 $V = \\tan(\\theta/2)$。为了找到相变量 $\\theta$ 的动力学，我们首先使用链式法则对 $V$ 关于时间 $t$ 求导：\n$$\n\\frac{dV}{dt} = \\frac{d}{dt}\\left(\\tan\\left(\\frac{\\theta}{2}\\right)\\right) = \\sec^{2}\\left(\\frac{\\theta}{2}\\right) \\cdot \\frac{d}{dt}\\left(\\frac{\\theta}{2}\\right) = \\frac{1}{2}\\sec^{2}\\left(\\frac{\\theta}{2}\\right)\\frac{d\\theta}{dt}\n$$\n将此式和 $V$ 的表达式代入原始 ODE，我们得到：\n$$\n\\frac{1}{2}\\sec^{2}\\left(\\frac{\\theta}{2}\\right)\\frac{d\\theta}{dt} = \\tan^{2}\\left(\\frac{\\theta}{2}\\right) + \\eta\n$$\n我们求解 $\\frac{d\\theta}{dt}$：\n$$\n\\frac{d\\theta}{dt} = 2 \\cdot \\frac{\\tan^{2}(\\theta/2) + \\eta}{\\sec^{2}(\\theta/2)} = 2\\cos^{2}\\left(\\frac{\\theta}{2}\\right)\\left(\\tan^{2}\\left(\\frac{\\theta}{2}\\right) + \\eta\\right)\n$$\n将项 $2\\cos^{2}(\\theta/2)$ 分配进去，得到：\n$$\n\\frac{d\\theta}{dt} = 2\\sin^{2}\\left(\\frac{\\theta}{2}\\right) + 2\\eta\\cos^{2}\\left(\\frac{\\theta}{2}\\right)\n$$\n为了简化此表达式，我们使用半角三角恒等式：$\\sin^{2}(x) = \\frac{1-\\cos(2x)}{2}$ 和 $\\cos^{2}(x) = \\frac{1+\\cos(2x)}{2}$。将这些应用于 $x = \\theta/2$：\n$$\n\\frac{d\\theta}{dt} = 2\\left(\\frac{1-\\cos(\\theta)}{2}\\right) + 2\\eta\\left(\\frac{1+\\cos(\\theta)}{2}\\right)\n$$\n$$\n\\frac{d\\theta}{dt} = (1-\\cos(\\theta)) + \\eta(1+\\cos(\\theta)) = 1 + \\eta - \\cos(\\theta) + \\eta\\cos(\\theta)\n$$\n这给出了相动力学，也称为 theta-神经元方程：\n$$\n\\frac{d\\theta}{dt} = 1 + \\eta - (1-\\eta)\\cos(\\theta)\n$$\n脉冲间期 $T(\\eta)$ 是 $\\theta$ 完成一个 $2\\pi$ 完整周期所需的时间。我们可以通过分离变量并在一个完整周期（例如，从 $\\theta=0$ 到 $\\theta=2\\pi$）上积分来找到这个周期：\n$$\nT(\\eta) = \\int_{0}^{T(\\eta)} dt = \\int_{0}^{2\\pi} \\frac{d\\theta}{1 + \\eta - (1-\\eta)\\cos(\\theta)}\n$$\n这个定积分可以使用 Weierstrass 代换（$u = \\tan(\\theta/2)$）来求解，其中 $d\\theta = \\frac{2du}{1+u^2}$ 和 $\\cos(\\theta) = \\frac{1-u^2}{1+u^2}$。由于该代换在 $\\theta=\\pi$ 处存在奇点，我们在此点将积分拆分：\n$$\nT(\\eta) = \\int_{0}^{\\pi} \\frac{d\\theta}{1 + \\eta - (1-\\eta)\\cos(\\theta)} + \\int_{\\pi}^{2\\pi} \\frac{d\\theta}{1 + \\eta - (1-\\eta)\\cos(\\theta)}\n$$\n对于第一个积分，当 $\\theta$ 从 $0$ 变为 $\\pi$ 时，$u$ 从 $0$ 变为 $+\\infty$：\n$$\n\\int_{0}^{\\pi} \\frac{...}{...} d\\theta = \\int_{0}^{\\infty} \\frac{\\frac{2du}{1+u^2}}{(1+\\eta) - (1-\\eta)\\frac{1-u^2}{1+u^2}} = \\int_{0}^{\\infty} \\frac{2du}{(1+\\eta)(1+u^2) - (1-\\eta)(1-u^2)}\n$$\n$$\n= \\int_{0}^{\\infty} \\frac{2du}{(1+\\eta+u^2+\\eta u^2) - (1-\\eta-u^2+\\eta u^2)} = \\int_{0}^{\\infty} \\frac{2du}{2\\eta+2u^2} = \\int_{0}^{\\infty} \\frac{du}{u^2+\\eta}\n$$\n这是一个标准反正切积分形式，$\\int \\frac{dx}{x^2+a^2} = \\frac{1}{a}\\arctan(x/a)$，其中 $a=\\sqrt{\\eta}$：\n$$\n\\left[ \\frac{1}{\\sqrt{\\eta}}\\arctan\\left(\\frac{u}{\\sqrt{\\eta}}\\right) \\right]_{0}^{\\infty} = \\frac{1}{\\sqrt{\\eta}}\\left( \\frac{\\pi}{2} - 0 \\right) = \\frac{\\pi}{2\\sqrt{\\eta}}\n$$\n这对应于 $V$ 从 $V(0)=\\tan(0)=0$ 演化到 $V(t \\to \\infty) = \\tan(\\pi/2) \\to +\\infty$ 所需的时间。根据对称性，从 $V=-\\infty$到 $V=0$ 的时间是相同的。这可以通过计算从 $\\pi$ 到 $2\\pi$ 的第二个积分来证实，其中 $u$ 从 $-\\infty$ 变为 $0$，其结果同样是 $\\frac{\\pi}{2\\sqrt{\\eta}}$。\n总周期 $T(\\eta)$ 是两部分之和：\n$$\nT(\\eta) = \\frac{\\pi}{2\\sqrt{\\eta}} + \\frac{\\pi}{2\\sqrt{\\eta}} = \\frac{\\pi}{\\sqrt{\\eta}}\n$$\n\n### 当 $\\eta \\downarrow 0$ 时的渐近分析\n精确表达式 $T(\\eta) = \\pi/\\sqrt{\\eta}$ 直接表明，当 $\\eta \\downarrow 0$ 时，$T(\\eta) \\to \\infty$，其标度关系为 $\\eta^{-1/2}$。\n我们可以基于相动力学提供一个有原理的论证。旋转速度为 $\\frac{d\\theta}{dt} = 1 + \\eta - (1-\\eta)\\cos(\\theta)$。最小速度出现在 $\\cos(\\theta)$ 最大时（即 $\\cos(\\theta)=1$），这发生在 $\\theta = 2k\\pi$（$k$为整数）处。在这些点，$\\frac{d\\theta}{dt}|_{\\text{min}} = 1+\\eta-(1-\\eta) = 2\\eta$。最大速度出现在 $\\cos(\\theta)=-1$ 时（在 $\\theta = (2k+1)\\pi$ 处），此时 $\\frac{d\\theta}{dt}|_{\\text{max}} = 1+\\eta+(1-\\eta) = 2$。\n当 $\\eta \\downarrow 0$ 时，最小速度趋近于 $0$，而最大速度保持为 $2$。这在 $\\theta=0$ 附近产生了一个“瓶颈”或缓慢通过区域。对于小 $\\eta$ 和小 $\\theta$，我们可以使用 $\\cos(\\theta) \\approx 1-\\theta^2/2$ 来近似动力学：\n$$\n\\frac{d\\theta}{dt} \\approx 1+\\eta - (1-\\eta)(1-\\theta^2/2) = 2\\eta + (1-\\eta)\\frac{\\theta^2}{2} \\approx 2\\eta + \\frac{\\theta^2}{2}\n$$\n在瓶颈附近的一个小区间 $[-\\delta, \\delta]$ 内花费的时间是：\n$$\nT_{\\text{slow}} \\approx \\int_{-\\delta}^{\\delta} \\frac{d\\theta}{2\\eta + \\theta^2/2} = 2 \\int_{-\\delta}^{\\delta} \\frac{d\\theta}{\\theta^2 + 4\\eta} = 2 \\left[ \\frac{1}{2\\sqrt{\\eta}}\\arctan\\left(\\frac{\\theta}{2\\sqrt{\\eta}}\\right) \\right]_{-\\delta}^{\\delta} = \\frac{2}{\\sqrt{\\eta}}\\arctan\\left(\\frac{\\delta}{2\\sqrt{\\eta}}\\right)\n$$\n在 $\\eta \\to 0$ 的极限下，对于任何固定的 $\\delta>0$，自变量 $\\frac{\\delta}{2\\sqrt{\\eta}} \\to \\infty$，因此 $\\arctan\\left(\\frac{\\delta}{2\\sqrt{\\eta}}\\right) \\to \\frac{\\pi}{2}$。所以，\n$$\n\\lim_{\\eta\\to 0} T_{\\text{slow}} \\approx \\frac{2}{\\sqrt{\\eta}} \\cdot \\frac{\\pi}{2} = \\frac{\\pi}{\\sqrt{\\eta}}\n$$\n这表明周期的发散完全是由于在 $\\theta=0$ 处的鞍-结分岔“幽灵”附近速度减慢所致，并证实了标度关系 $T(\\eta) \\propto \\eta^{-1/2}$。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{\\sqrt{\\eta}}}\n$$"
        },
        {
            "introduction": "最后，我们将注意力转向指数整合发放（EIF）模型，这是一个在生物物理上更接近现实的模型，它能够捕捉动作电位启动时的急剧上升过程。这项练习是一个关于计算神经科学实践的重要课程：即使模型是正确的，其数值实现也至关重要。通过这个动手实践，您将发现模拟中的一个常见陷阱，并学习一种确保尖峰时刻精确性的稳健方法，这是任何建模者都必须掌握的关键技能。",
            "id": "3990544",
            "problem": "请考虑指数积分-发放 (EIF) 神经元模型，该模型通过在膜电流中加入一个指数项，扩展了漏电积分-发放模型家族。膜电位动力学由以下常微分方程控制：\n$$\n\\frac{dV}{dt} \\;=\\; \\frac{-(V - E_L) + \\Delta_T \\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right) + R\\,I_0}{\\tau_m},\n$$\n其中 $V$ 是以伏特为单位的膜电位，$E_L$ 是以伏特为单位的漏泄反转电位，$\\Delta_T$ 是以伏特为单位的斜率因子，$V_T$ 是以伏特为单位的有效阈值，$R$ 是以欧姆为单位的无源膜电阻，$I_0$ 是以安培为单位的注入电流，$\\tau_m$ 是以秒为单位的膜时间常数。当 $V$ 达到预定义的峰值电位 $V_{\\mathrm{peak}}$（以伏特为单位）时，记录一个脉冲，此时穿越阈值的时间即为要报告的脉冲时间。\n\n基本原理：该膜方程源于电荷在具有漏泄电导和主动指数电流的无源电容膜上的守恒，与 Kirchhoff 电流定律和标准的 Hodgkin–Huxley 简化模型一致。指数电流项捕捉了接近阈值时的快速激活过程，是一种经过充分检验的唯象描述。\n\n任务：您必须通过构建一个模拟来证明，由于指数项引起的有限时间爆破，朴素的固定步长时间步进方法可能会错过 EIF 的真实阈值穿越时间。同时，您需要实现一种基于外推指数项的鲁棒寻根策略。您的推导和实现必须从所提供的常微分方程和基础微积分出发。\n\n算法要求：\n\n1.  为给定的常微分方程实现一个步长为 $\\Delta t$ 的朴素显式欧拉时间步进方案。仅在步长边界处通过准则 $V_{n+1} \\ge V_{\\mathrm{peak}}$ 来检测脉冲，如果发生此情况，则记录脉冲时间 $t_{n+1}$。\n\n2.  在每个步长内部，根据以下原理实现一种鲁棒的脉冲时间检测策略：当指数项主导动力学时，该微分方程简化为\n    $$\n    \\frac{dV}{dt} \\approx \\frac{\\Delta_T}{\\tau_m}\\,\\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right).\n    $$\n    定义变换变量 $y(t) = \\exp\\!\\left(-\\frac{V(t) - V_T}{\\Delta_T}\\right)$，并利用在脉冲附近 $y(t)$ 随时间近似线性演化的事实。在一个从时间 $t_n$ 开始、膜电位为 $V_n$ 的步长内，如果对于一个固定的主导因子 $k$（使用 $k=5$），主导条件\n    $$\n    \\Delta_T\\,\\exp\\!\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) \\;\\ge\\; k\\,\\left|-(V_n - E_L) + R\\,I_0\\right|\n    $$\n    成立，那么通过求解\n    $$\n    y(t) \\approx y_n - \\frac{t - t_n}{\\tau_m},\\quad y_n = \\exp\\!\\left(-\\frac{V_n - V_T}{\\Delta_T}\\right),\n    $$\n    来近似计算步长内的脉冲时间。具体而言，求解 $V(t)$ 达到 $V_{\\mathrm{peak}}$ 的时间 $t_{\\mathrm{hit}}$，即当\n    $$\n    y(t_{\\mathrm{hit}}) = \\exp\\!\\left(-\\frac{V_{\\mathrm{peak}} - V_T}{\\Delta_T}\\right) =: y_{\\mathrm{peak}}.\n    $$\n    如果 $t_{\\mathrm{hit}} \\in [t_n, t_n + \\Delta t]$，则将 $t_{\\mathrm{hit}}$ 记录为鲁棒脉冲时间。该策略使用指数项的外推法来寻找步长内的脉冲时间。\n\n3.  对于每个测试用例，在从 $V(0) = E_L$ 开始的同一轨迹上运行两种检测器，直至达到指定的最大时间 $T_{\\max}$。如果在 $T_{\\max}$ 内鲁棒方法未检测到脉冲，则报告无脉冲。为量化朴素方法是否“错过”了阈值穿越，定义一个布尔指示器：如果朴素方法未能检测到脉冲而鲁棒方法检测到了，或者朴素脉冲时间与鲁棒脉冲时间的绝对差超过 $\\frac{1}{2}\\Delta t$，则该指示器为真。\n\n单位和输出：\n\n-   所有电位 $V$、$E_L$、$V_T$ 和 $V_{\\mathrm{peak}}$ 必须以伏特为单位。\n-   在模拟中，所有时间必须以秒为单位；报告的脉冲时间必须以毫秒表示，并四舍五入到 $6$ 位小数。\n-   此问题不涉及角度。\n-   电流必须以安培为单位。\n-   电阻必须以欧姆为单位。\n\n测试套件：\n\n使用以下四组参数集，每组指定为 $(\\tau_m, E_L, V_T, \\Delta_T, R, I_0, V_{\\mathrm{peak}}, \\Delta t, T_{\\max})$。\n\n-   用例 A（一般正常路径）：$(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, 0.5\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.0001\\,\\mathrm{s}, 0.1\\,\\mathrm{s})$。\n-   用例 B（粗步长，强驱动，明显错失）：$(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, 1.5\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.002\\,\\mathrm{s}, 0.02\\,\\mathrm{s})$。\n-   用例 C（近边界主导）：$(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, 0.8\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.0005\\,\\mathrm{s}, 0.05\\,\\mathrm{s})$。\n-   用例 D（无脉冲边界情况）：$(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, -0.5\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.0001\\,\\mathrm{s}, 0.1\\,\\mathrm{s})$。\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例对应一个包含两个元素的子列表 $[\\mathrm{miss}, t_{\\mathrm{robust}}]$，其中 $\\mathrm{miss}$ 是一个布尔值，而 $t_{\\mathrm{robust}}$ 是以毫秒为单位的鲁棒脉冲时间，四舍五入到 $6$ 位小数（如果未检测到脉冲，则使用 $-1.0$）。例如，对于四个用例，输出应类似于 $[[\\mathrm{True},1.234000],[\\mathrm{False},5.678000],\\dots]$，顺序与测试套件中的顺序相同。",
            "solution": "该问题要求实现并比较两种用于指数积分-发放 (EIF) 神经元模型的脉冲检测方法。该项目是有效的，因为它基于计算神经科学的既定原则，定义明确，并提供了所有必要的参数和条件。\n\n膜电位 $V$ 的动力学由以下常微分方程 (ODE) 描述：\n$$\n\\frac{dV}{dt} = \\frac{1}{\\tau_m} \\left( -(V - E_L) + \\Delta_T \\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right) + R\\,I_0 \\right)\n$$\n这里，$\\tau_m$ 是膜时间常数，$E_L$ 是漏泄反转电位，$V_T$ 是有效阈值电位，$\\Delta_T$ 是控制脉冲起始锐度的斜率因子，$R$ 是膜电阻，$I_0$ 是一个恒定的注入直流电流。\n\n需要进行数值模拟来求解这个 ODE。我们将采用显式欧拉方法，这是一种用于求解具有给定初始值的 ODE 的一阶数值方法。对于一个时间步长 $\\Delta t$，第 $n+1$ 步的膜电位由第 $n$ 步的值更新如下：\n$$\nV_{n+1} = V_n + \\Delta t \\cdot \\frac{dV}{dt}\\bigg|_{V=V_n}\n$$\n$$\nV_{n+1} = V_n + \\frac{\\Delta t}{\\tau_m} \\left( -(V_n - E_L) + \\Delta_T \\exp\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) + R\\,I_0 \\right)\n$$\n模拟从时间 $t=0$ 开始，初始条件为 $V(0) = E_L$。\n\n我们将实现两种不同的方法来检测神经元何时“发放脉冲”，这被定义为电位 $V(t)$ 穿越一个峰值 $V_{\\mathrm{peak}}$ 的时刻。\n\n1.  **朴素脉冲检测**：此方法严格在离散时间步的边界上操作。每次欧拉更新后，我们检查新的电位 $V_{n+1}$ 是否已穿越峰值电位。如果 $V_{n+1} \\ge V_{\\mathrm{peak}}$ 且此方法尚未检测到脉冲，则脉冲时间记录为 $t_{\\mathrm{naive}} = t_{n+1} = t_n + \\Delta t$。此方法的主要缺点是它对步长 $\\Delta t$ 的依赖性。EIF 模型中的指数项可能导致“有限时间爆破”，即电压上升得极其迅速。一个大的 $\\Delta t$ 可能导致模拟从一个亚阈值电压跳到一个远超 $V_{\\mathrm{peak}}$ 的值，使得记录的脉冲时间 $t_{n+1}$ 成为真实穿越时间的一个很差的近似。\n\n2.  **鲁棒脉冲检测**：此方法旨在通过分析指数项变得主导时的动力学，来找到一个时间步内更精确的脉冲时间。主导条件如下：\n    $$\n    \\Delta_T\\,\\exp\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) \\;\\ge\\; k\\,\\left|-(V_n - E_L) + R\\,I_0\\right|\n    $$\n    其中 $k=5$ 是一个固定因子。当在时间步 $(t_n, V_n)$ 开始时满足此条件，我们可以通过忽略线性漏电项和输入电流项来近似 ODE：\n    $$\n    \\frac{dV}{dt} \\approx \\frac{\\Delta_T}{\\tau_m}\\,\\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right)\n    $$\n    为了求解这个方程，我们引入变换 $y(t) = \\exp\\left(-\\frac{V(t) - V_T}{\\Delta_T}\\right)$。$y$ 的时间导数是：\n    $$\n    \\frac{dy}{dt} = \\frac{dy}{dV} \\frac{dV}{dt} = \\left(-\\frac{1}{\\Delta_T} \\exp\\left(-\\frac{V - V_T}{\\Delta_T}\\right)\\right) \\frac{dV}{dt} = -\\frac{y}{\\Delta_T} \\frac{dV}{dt}\n    $$\n    代入近似的 $\\frac{dV}{dt}$ 并注意到 $\\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right) = 1/y$：\n    $$\n    \\frac{dy}{dt} \\approx -\\frac{y}{\\Delta_T} \\left( \\frac{\\Delta_T}{\\tau_m} \\frac{1}{y} \\right) = -\\frac{1}{\\tau_m}\n    $$\n    这表明 $y(t)$ 以一个恒定的斜率 $-1/\\tau_m$ 近似线性演化。我们可以从步长开始时的值 $y_n = y(t_n)$ 来外推它的值：\n    $$\n    y(t) \\approx y_n - \\frac{t - t_n}{\\tau_m}\n    $$\n    我们寻找时间 $t_{\\mathrm{hit}}$，使得 $V(t_{\\mathrm{hit}}) = V_{\\mathrm{peak}}$。这对应于 $y(t_{\\mathrm{hit}}) = y_{\\mathrm{peak}} = \\exp\\left(-\\frac{V_{\\mathrm{peak}} - V_T}{\\Delta_T}\\right)$。求解 $t_{\\mathrm{hit}}$：\n    $$\n    y_{\\mathrm{peak}} = y_n - \\frac{t_{\\mathrm{hit}} - t_n}{\\tau_m} \\implies t_{\\mathrm{hit}} = t_n + \\tau_m (y_n - y_{\\mathrm{peak}})\n    $$\n    如果计算出的 $t_{\\mathrm{hit}}$ 落在当前时间步内，即 $t_n \\le t_{\\mathrm{hit}}  t_n + \\Delta t$，我们将其记录为鲁棒脉冲时间 $t_{\\mathrm{robust}}$。\n\n每个测试用例的模拟通过以步长 $\\Delta t$ 迭代进行，直到达到最大时间 $T_{\\max}$。在每一步中，我们在由欧拉更新定义的同一电压轨迹上应用两种检测策略。我们会继续模拟直到达到 $T_{\\max}$ 或两种方法都已记录到脉冲，以确保进行完整比较。如果鲁棒方法没有找到脉冲，其时间报告为 $-1.0$。\n\n最后，我们确定朴素方法是否“错过”了阈值穿越。`miss` 指示器在以下情况下设为真：\n(a) 鲁棒方法检测到脉冲，但朴素方法在 $T_{\\max}$ 内没有检测到。\n(b) 两种方法都检测到脉冲，但它们记录的时间相差超过半个时间步：$|t_{\\mathrm{naive}} - t_{\\mathrm{robust}}| > 0.5 \\Delta t$。\n\n每个用例的最终输出是一个数对 `[miss, t_robust_ms]`，其中 `miss` 是布尔指示器，`t_robust_ms` 是以毫秒为单位的鲁棒检测脉冲时间，四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(params):\n    \"\"\"\n    Simulates an Exponential Integrate-and-Fire (EIF) neuron model and\n    compares naive and robust spike detection methods.\n\n    Args:\n        params (tuple): A tuple containing all model and simulation parameters:\n            (tau_m, E_L, V_T, Delta_T, R, I_0, V_peak, dt, T_max).\n\n    Returns:\n        list: A list containing [miss, t_robust_ms], where 'miss' is a boolean\n              and 't_robust_ms' is the robust spike time in ms, rounded to 6\n              decimal places (-1.0 if no spike).\n    \"\"\"\n    tau_m, E_L, V_T, Delta_T, R, I_0, V_peak, dt, T_max = params\n    k = 5.0  # Dominance factor\n\n    V = E_L  # Initial membrane potential\n    t = 0.0   # Initial time\n\n    t_naive = -1.0\n    t_robust = -1.0\n\n    # Pre-calculate for efficiency\n    y_peak = np.exp(-(V_peak - V_T) / Delta_T)\n\n    while t = T_max:\n        # ---- Robust Spike Detection (Extrapolation) ----\n        if t_robust == -1.0:\n            # Check dominance condition\n            exp_term = Delta_T * np.exp((V - V_T) / Delta_T)\n            linear_term = -(V - E_L) + R * I_0\n            \n            if exp_term >= k * np.abs(linear_term):\n                y_n = np.exp(-(V - V_T) / Delta_T)\n                # Calculate time to hit V_peak based on linear extrapolation of y\n                t_hit = t + tau_m * (y_n - y_peak)\n                \n                # If hit time is within the current step, record it\n                if t = t_hit  t + dt:\n                    t_robust = t_hit\n        \n        # ---- Explicit Euler Step ----\n        dVdt = (-(V - E_L) + Delta_T * np.exp((V - V_T) / Delta_T) + R * I_0) / tau_m\n        V_next = V + dt * dVdt\n        t_next = t + dt\n\n        # ---- Naive Spike Detection (Step Boundary) ----\n        if t_naive == -1.0:\n            if V_next >= V_peak:\n                t_naive = t_next\n\n        # Update state for next iteration\n        V = V_next\n        t = t_next\n\n        # Optimization: if both spikes are found, no need to continue\n        if t_naive != -1.0 and t_robust != -1.0:\n            break\n\n    # ---- Determine if naive method \"missed\" ----\n    miss = False\n    robust_succeeded = t_robust != -1.0\n    naive_succeeded = t_naive != -1.0\n\n    if robust_succeeded and not naive_succeeded:\n        miss = True\n    elif robust_succeeded and naive_succeeded:\n        if np.abs(t_naive - t_robust) > 0.5 * dt:\n            miss = True\n\n    # ---- Format output ----\n    if robust_succeeded:\n        t_robust_ms = round(t_robust * 1000.0, 6)\n    else:\n        t_robust_ms = -1.0\n\n    return [miss, t_robust_ms]\n\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: (tau_m, E_L, V_T, Delta_T, R, I_0, V_peak, dt, T_max)\n        (0.02, -0.065, -0.055, 0.002, 100e6, 0.5e-9, -0.020, 0.0001, 0.1),\n        # Case B\n        (0.02, -0.065, -0.055, 0.002, 100e6, 1.5e-9, -0.020, 0.002, 0.02),\n        # Case C\n        (0.02, -0.065, -0.055, 0.002, 100e6, 0.8e-9, -0.020, 0.0005, 0.05),\n        # Case D\n        (0.02, -0.065, -0.055, 0.002, 100e6, -0.5e-9, -0.020, 0.0001, 0.1),\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(run_simulation(params))\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for miss, t_rob_ms in results:\n        # Use str() for boolean to get 'True'/'False'\n        miss_str = str(miss)\n        if t_rob_ms == -1.0:\n            t_str = \"-1.0\"\n        else:\n            # Format to 6 decimal places with trailing zeros\n            t_str = f\"{t_rob_ms:.6f}\"\n        \n        formatted_results.append(f\"[{miss_str},{t_str}]\")\n    \n    # Join the sub-lists into the final string\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}