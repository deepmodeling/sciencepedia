{
    "hands_on_practices": [
        {
            "introduction": "The Leaky Integrate-and-Fire (LIF) model is the cornerstone of its family, offering a simple yet powerful framework for understanding neural integration. To truly grasp its behavior, we must first strip it down to its essential mathematical form through nondimensionalization. This practice guides you through this crucial process, revealing the minimal set of dimensionless parameters that govern the neuron's dynamics and then challenging you to derive its classic firing rate curve for a constant input .",
            "id": "3990565",
            "problem": "A single-compartment leaky integrate-and-fire (LIF) neuron is governed by the current-balance equation $C \\,\\frac{dV}{dt} = -g_{L}\\,(V - E_{L}) + I(t)$, with threshold at $V_{\\text{th}}$ and instantaneous reset to $V_{r}$ after threshold crossing. Here $C$ is the membrane capacitance, $g_{L}$ is the leak conductance, and $E_{L}$ is the leak reversal potential. Define the membrane time constant $\\tau_{m} = \\frac{C}{g_{L}}$ and the membrane resistance $R_{m} = \\frac{1}{g_{L}}$. Consider inputs of the form $I(t) = I_{0} + \\sigma\\,\\xi(t)$ where $\\xi(t)$ is Gaussian white noise with zero mean and correlation $\\langle \\xi(t)\\,\\xi(t') \\rangle = \\delta(t - t')$. Introduce the nondimensional variables $\\tilde{t} = \\frac{t}{\\tau_{m}}$ and $\\tilde{v} = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$.\n\nTasks:\n- Starting only from the current-balance equation and the definitions of $\\tau_{m}$ and $R_{m}$, nondimensionalize the subthreshold dynamics to obtain a stochastic differential equation for $\\tilde{v}(\\tilde{t})$. Identify explicitly the complete set of dimensionless parameters that control the subthreshold dynamics and the spike-generation rule under both constant input ($\\sigma = 0$) and stochastic input ($\\sigma \\neq 0$).\n- Specialize to the constant-input case $\\sigma = 0$ with the dimensionless input $\\mu \\equiv \\frac{R_{m} I_{0}}{V_{\\text{th}} - E_{L}}  1$, reset $\\tilde{v}_{r} \\equiv \\frac{V_{r} - E_{L}}{V_{\\text{th}} - E_{L}}  1$, and threshold at $\\tilde{v} = 1$. From first principles, derive the exact steady firing rate $r$ by computing the interspike interval and inverting it. Report your final answer as the dimensionless rate $\\tilde{r} \\equiv \\tau_{m}\\,r$.\n\nAnswer specification:\n- Your final answer must be a single closed-form analytic expression for $\\tilde{r}$ in terms of $\\mu$ and $\\tilde{v}_{r}$ only, with no units.",
            "solution": "This problem consists of two parts. First, we will nondimensionalize the governing stochastic differential equation for the membrane potential. Second, we will solve for the steady firing rate in the deterministic case (zero noise).\n\n**Part 1: Nondimensionalization of the Subthreshold Dynamics**\n\nThe starting point is the current-balance equation for the LIF neuron:\n$$C \\frac{dV}{dt} = -g_{L}(V - E_{L}) + I(t)$$\nWe are given the definitions for the membrane time constant, $\\tau_{m} = \\frac{C}{g_{L}}$, and the membrane resistance, $R_{m} = \\frac{1}{g_{L}}$. Substituting these into the equation by dividing by $g_L$:\n$$\\frac{C}{g_{L}}\\frac{dV}{dt} = -(V - E_{L}) + \\frac{1}{g_{L}}I(t)$$\n$$\\tau_{m}\\frac{dV}{dt} = -(V - E_{L}) + R_{m}I(t)$$\nThe input current is $I(t) = I_{0} + \\sigma\\,\\xi(t)$, where $\\xi(t)$ is Gaussian white noise. Substituting this gives:\n$$\\tau_{m}\\frac{dV}{dt} = -(V - E_{L}) + R_{m}I_{0} + R_{m}\\sigma\\,\\xi(t)$$\nNext, we introduce the nondimensional variables:\n$$\\tilde{t} = \\frac{t}{\\tau_{m}} \\quad \\text{and} \\quad \\tilde{v} = \\frac{V - E_{L}}{V_{\\text{th}} - E_{L}}$$\nFrom these definitions, we can express the original variables and their differentials. We assume $V_{\\text{th}} \\neq E_L$.\n$$t = \\tau_{m}\\tilde{t} \\implies dt = \\tau_{m}d\\tilde{t}$$\n$$V = E_{L} + \\tilde{v}(V_{\\text{th}} - E_{L}) \\implies dV = (V_{\\text{th}} - E_{L})d\\tilde{v}$$\nUsing the chain rule, $\\frac{dV}{dt} = \\frac{dV}{d\\tilde{v}} \\frac{d\\tilde{v}}{d\\tilde{t}} \\frac{d\\tilde{t}}{dt} = (V_{\\text{th}}-E_L)\\frac{d\\tilde{v}}{d\\tilde{t}}\\frac{1}{\\tau_m}$. Substituting this into the equation for the dynamics:\n$$\\tau_{m} \\left( \\frac{V_{\\text{th}} - E_{L}}{\\tau_{m}} \\frac{d\\tilde{v}}{d\\tilde{t}} \\right) = -[\\tilde{v}(V_{\\text{th}} - E_{L})] + R_{m}I_{0} + R_{m}\\sigma\\,\\xi(\\tau_{m}\\tilde{t})$$\n$$(V_{\\text{th}} - E_{L}) \\frac{d\\tilde{v}}{d\\tilde{t}} = -\\tilde{v}(V_{\\text{th}} - E_{L}) + R_{m}I_{0} + R_{m}\\sigma\\,\\xi(\\tau_{m}\\tilde{t})$$\nDividing the entire equation by $(V_{\\text{th}} - E_{L})$:\n$$\\frac{d\\tilde{v}}{d\\tilde{t}} = -\\tilde{v} + \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}} + \\frac{R_{m}\\sigma}{V_{\\text{th}} - E_{L}}\\xi(\\tau_{m}\\tilde{t})$$\nTo write this as a standard stochastic differential equation (SDE), we consider the noise term. A formal SDE is written in terms of Wiener process increments $dW_t$, where $\\xi(t)dt = dW_t$. The rescaled process $\\tilde{W}_{\\tilde{t}} = W_{\\tau_m \\tilde{t}} / \\sqrt{\\tau_m}$ is also a standard Wiener process. Its increment is $d\\tilde{W}_{\\tilde{t}} = \\frac{1}{\\sqrt{\\tau_m}} dW_{\\tau_m \\tilde{t}} = \\frac{1}{\\sqrt{\\tau_m}} \\xi(\\tau_m \\tilde{t}) d(\\tau_m\\tilde{t}) = \\sqrt{\\tau_m} \\xi(\\tau_m \\tilde{t}) d\\tilde{t}$.\nTherefore, $\\xi(\\tau_{m}\\tilde{t})d\\tilde{t} = \\frac{1}{\\sqrt{\\tau_m}}d\\tilde{W}_{\\tilde{t}}$.\nThe SDE in differential form is:\n$$d\\tilde{v} = \\left(-\\tilde{v} + \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}\\right)d\\tilde{t} + \\frac{R_{m}\\sigma}{V_{\\text{th}} - E_{L}}\\xi(\\tau_{m}\\tilde{t})d\\tilde{t}$$\n$$d\\tilde{v} = \\left(-\\tilde{v} + \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}\\right)d\\tilde{t} + \\frac{R_{m}\\sigma}{(V_{\\text{th}} - E_{L})\\sqrt{\\tau_m}}d\\tilde{W}_{\\tilde{t}}$$\nWe can now identify the dimensionless parameters.\nThe constant input term is $\\mu = \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}$.\nThe noise amplitude is $\\tilde{\\sigma} = \\frac{R_{m}\\sigma}{(V_{\\text{th}} - E_{L})\\sqrt{\\tau_m}}$.\nThe nondimensional SDE is:\n$$d\\tilde{v} = (-\\tilde{v} + \\mu)d\\tilde{t} + \\tilde{\\sigma}d\\tilde{W}_{\\tilde{t}}$$\nThe spike-generation rule must also be nondimensionalized.\nThe threshold $V = V_{\\text{th}}$ becomes $\\tilde{v}_{\\text{th}} = \\frac{V_{\\text{th}} - E_{L}}{V_{\\text{th}} - E_{L}} = 1$.\nThe reset potential $V = V_{r}$ becomes $\\tilde{v}_{r} = \\frac{V_{r} - E_{L}}{V_{\\text{th}} - E_{L}}$.\n\nThe complete set of dimensionless parameters is:\n1.  For constant input ($\\sigma=0$, so $\\tilde{\\sigma}=0$): The dynamics are controlled by $\\mu = \\frac{R_{m}I_{0}}{V_{\\text{th}} - E_{L}}$ and the spike-reset rule is controlled by $\\tilde{v}_{r} = \\frac{V_{r} - E_{L}}{V_{\\text{th}} - E_{L}}$.\n2.  For stochastic input ($\\sigma \\neq 0$): The dynamics are controlled by $\\mu$ and $\\tilde{\\sigma} = \\frac{R_{m}\\sigma}{(V_{\\text{th}} - E_{L})\\sqrt{\\tau_m}}$, and the spike-reset rule by $\\tilde{v}_{r}$.\n\n**Part 2: Firing Rate for Constant Input**\n\nWe specialize to the constant-input case where $\\sigma = 0$, so $\\tilde{\\sigma} = 0$. The governing equation becomes a deterministic ordinary differential equation:\n$$\\frac{d\\tilde{v}}{d\\tilde{t}} = -\\tilde{v} + \\mu$$\nWe are given $\\mu  1$ and a reset value $\\tilde{v}_{r}  1$. The threshold is at $\\tilde{v}_{\\text{th}} = 1$.\nTo find the firing rate, we first calculate the interspike interval, $\\tilde{T}_{\\text{ISI}}$, which is the time taken for $\\tilde{v}$ to evolve from $\\tilde{v}_{r}$ to $\\tilde{v}_{\\text{th}}$.\nWe solve the ODE by separation of variables or as a linear first-order equation.\n$$\\frac{d\\tilde{v}}{\\mu - \\tilde{v}} = d\\tilde{t}$$\nIntegrating from $\\tilde{v}(\\tilde{t}=0)=\\tilde{v}_{r}$ to $\\tilde{v}(\\tilde{t}=\\tilde{T}_{\\text{ISI}})=1$:\n$$\\int_{\\tilde{v}_{r}}^{1} \\frac{d\\tilde{v}'}{\\mu - \\tilde{v}'} = \\int_{0}^{\\tilde{T}_{\\text{ISI}}} d\\tilde{t}'$$\n$$[-\\ln|\\mu - \\tilde{v}'|]_{\\tilde{v}_{r}}^{1} = \\tilde{T}_{\\text{ISI}}$$\nSince $\\mu  1$ and $\\tilde{v}$ remains below $1$ (and thus below $\\mu$), the term $\\mu - \\tilde{v}'$ is always positive.\n$$(-\\ln(\\mu - 1)) - (-\\ln(\\mu - \\tilde{v}_{r})) = \\tilde{T}_{\\text{ISI}}$$\n$$\\tilde{T}_{\\text{ISI}} = \\ln(\\mu - \\tilde{v}_{r}) - \\ln(\\mu - 1)$$\n$$\\tilde{T}_{\\text{ISI}} = \\ln\\left(\\frac{\\mu - \\tilde{v}_{r}}{\\mu - 1}\\right)$$\nThis is the dimensionless interspike interval. The dimensional ISI is $T_{\\text{ISI}} = \\tau_{m}\\tilde{T}_{\\text{ISI}}$.\nThe firing rate is $r = \\frac{1}{T_{\\text{ISI}}}$.\nThe problem asks for the dimensionless firing rate $\\tilde{r} = \\tau_{m}r$.\n$$\\tilde{r} = \\tau_{m} \\left( \\frac{1}{T_{\\text{ISI}}} \\right) = \\tau_{m} \\left( \\frac{1}{\\tau_{m}\\tilde{T}_{\\text{ISI}}} \\right) = \\frac{1}{\\tilde{T}_{\\text{ISI}}}$$\nSubstituting the expression for $\\tilde{T}_{\\text{ISI}}$:\n$$\\tilde{r} = \\frac{1}{\\ln\\left(\\frac{\\mu - \\tilde{v}_{r}}{\\mu - 1}\\right)}$$\nThis is the final expression for the dimensionless firing rate in terms of $\\mu$ and $\\tilde{v}_{r}$. The conditions $\\mu  1$ and $\\tilde{v}_{r}  1$ ensure that $\\mu - \\tilde{v}_{r}  \\mu - 1  0$, so the argument of the logarithm is greater than $1$, and the rate $\\tilde{r}$ is positive and well-defined.\nAlternatively, the solution of the ODE $\\frac{d\\tilde{v}}{d\\tilde{t}} + \\tilde{v} = \\mu$ with initial condition $\\tilde{v}(0)=\\tilde{v}_r$ is $\\tilde{v}(\\tilde{t}) = \\mu + (\\tilde{v}_r - \\mu)\\exp(-\\tilde{t})$. Setting $\\tilde{v}(\\tilde{T}_{\\text{ISI}})=1$ yields $1 = \\mu + (\\tilde{v}_r - \\mu)\\exp(-\\tilde{T}_{\\text{ISI}})$, which rearranges to $\\exp(-\\tilde{T}_{\\text{ISI}}) = \\frac{1-\\mu}{\\tilde{v}_r-\\mu} = \\frac{\\mu-1}{\\mu-\\tilde{v}_r}$. Taking the negative logarithm gives $\\tilde{T}_{\\text{ISI}} = -\\ln\\left(\\frac{\\mu-1}{\\mu-\\tilde{v}_r}\\right) = \\ln\\left(\\frac{\\mu-\\tilde{v}_r}{\\mu-1}\\right)$, confirming the previous result.",
            "answer": "$$\\boxed{\\frac{1}{\\ln\\left(\\frac{\\mu - \\tilde{v}_{r}}{\\mu - 1}\\right)}}$$"
        },
        {
            "introduction": "Beyond the linear LIF model, the Quadratic Integrate-and-Fire (QIF) neuron captures the dynamics of Type I excitability, characterized by the ability to fire at arbitrarily low frequencies. This practice introduces a powerful analytical technique: mapping the voltage dynamics, which evolve on the real line, onto a circular phase variable, thereby transforming the QIF model into the equivalent theta-neuron . By analyzing the rotational speed on this circle, you can derive the exact interspike interval and gain deep insight into how neuronal firing slows near the bifurcation that marks the onset of spiking.",
            "id": "3990549",
            "problem": "Consider the Quadratic Integrate-and-Fire (QIF) neuron driven by a constant suprathreshold input. In dimensionless form, the membrane potential dynamics is governed by the ordinary differential equation (ODE)\n$$\n\\frac{dV}{dt} = V^{2} + \\eta,\n$$\nwhere $V$ is the membrane potential, $t$ is time, and $\\eta > 0$ is a constant input (sometimes interpreted as distance to rheobase). In the QIF convention, a spike is recorded when $V$ blows up to $+\\infty$, and immediately thereafter the potential is reset to $-\\infty$. Therefore, under constant drive, the interspike interval $T(\\eta)$ is the time it takes for the trajectory to evolve from $V=-\\infty$ to $V=+\\infty$.\n\nStarting from this ODE and the spike/reset convention, derive $T(\\eta)$ exactly using a phase mapping that compactifies $V \\in \\mathbb{R} \\cup \\{\\pm \\infty\\}$ to a circle. To do so, introduce a smooth change of variables $V=\\tan(\\theta/2)$ that maps $V \\in \\mathbb{R}\\cup\\{\\pm\\infty\\}$ to a phase $\\theta \\in [0,2\\pi)$, derive the corresponding phase dynamics, and compute the period of one full rotation in phase. Use only fundamental calculus and trigonometric identities, and do not assume any precomputed integrals beyond those derivable from standard methods. Then, using a principled asymptotic argument based on the dynamics near the slow region of the phase flow as $\\eta \\downarrow 0$, explain why $T(\\eta)$ diverges and identify its scaling with $\\eta$.\n\nProvide the final expression for $T(\\eta)$ in closed form as a function of $\\eta$. No units are required. The final answer must be a single analytic expression.",
            "solution": "### Derivation of the Interspike Interval $T(\\eta)$\n\nThe voltage dynamics are given by:\n$$\n\\frac{dV}{dt} = V^{2} + \\eta\n$$\nWe introduce the specified change of variables, $V = \\tan(\\theta/2)$. To find the dynamics of the phase variable $\\theta$, we first differentiate $V$ with respect to time $t$ using the chain rule:\n$$\n\\frac{dV}{dt} = \\frac{d}{dt}\\left(\\tan\\left(\\frac{\\theta}{2}\\right)\\right) = \\sec^{2}\\left(\\frac{\\theta}{2}\\right) \\cdot \\frac{d}{dt}\\left(\\frac{\\theta}{2}\\right) = \\frac{1}{2}\\sec^{2}\\left(\\frac{\\theta}{2}\\right)\\frac{d\\theta}{dt}\n$$\nSubstituting this and the expression for $V$ into the original ODE, we obtain:\n$$\n\\frac{1}{2}\\sec^{2}\\left(\\frac{\\theta}{2}\\right)\\frac{d\\theta}{dt} = \\tan^{2}\\left(\\frac{\\theta}{2}\\right) + \\eta\n$$\nWe solve for $\\frac{d\\theta}{dt}$:\n$$\n\\frac{d\\theta}{dt} = 2 \\cdot \\frac{\\tan^{2}(\\theta/2) + \\eta}{\\sec^{2}(\\theta/2)} = 2\\cos^{2}\\left(\\frac{\\theta}{2}\\right)\\left(\\tan^{2}\\left(\\frac{\\theta}{2}\\right) + \\eta\\right)\n$$\nDistributing the term $2\\cos^{2}(\\theta/2)$ yields:\n$$\n\\frac{d\\theta}{dt} = 2\\sin^{2}\\left(\\frac{\\theta}{2}\\right) + 2\\eta\\cos^{2}\\left(\\frac{\\theta}{2}\\right)\n$$\nTo simplify this expression, we employ the half-angle trigonometric identities: $\\sin^{2}(x) = \\frac{1-\\cos(2x)}{2}$ and $\\cos^{2}(x) = \\frac{1+\\cos(2x)}{2}$. Applying these with $x = \\theta/2$:\n$$\n\\frac{d\\theta}{dt} = 2\\left(\\frac{1-\\cos(\\theta)}{2}\\right) + 2\\eta\\left(\\frac{1+\\cos(\\theta)}{2}\\right)\n$$\n$$\n\\frac{d\\theta}{dt} = (1-\\cos(\\theta)) + \\eta(1+\\cos(\\theta)) = 1 + \\eta - \\cos(\\theta) + \\eta\\cos(\\theta)\n$$\nThis gives the phase dynamics, also known as the theta-neuron equation:\n$$\n\\frac{d\\theta}{dt} = 1 + \\eta - (1-\\eta)\\cos(\\theta)\n$$\nThe interspike interval $T(\\eta)$ is the time required for $\\theta$ to complete a full cycle of $2\\pi$. We can find this period by separating variables and integrating over one full cycle (e.g., from $\\theta=0$ to $\\theta=2\\pi$):\n$$\nT(\\eta) = \\int_{0}^{T(\\eta)} dt = \\int_{0}^{2\\pi} \\frac{d\\theta}{1 + \\eta - (1-\\eta)\\cos(\\theta)}\n$$\nThis definite integral can be solved using the Weierstrass substitution ($u = \\tan(\\theta/2)$), for which $d\\theta = \\frac{2du}{1+u^2}$ and $\\cos(\\theta) = \\frac{1-u^2}{1+u^2}$. Due to the singularity of the substitution at $\\theta=\\pi$, we split the integral at this point:\n$$\nT(\\eta) = \\int_{0}^{\\pi} \\frac{d\\theta}{1 + \\eta - (1-\\eta)\\cos(\\theta)} + \\int_{\\pi}^{2\\pi} \\frac{d\\theta}{1 + \\eta - (1-\\eta)\\cos(\\theta)}\n$$\nFor the first integral, as $\\theta$ goes from $0$ to $\\pi$, $u$ goes from $0$ to $+\\infty$:\n$$\n\\int_{0}^{\\pi} \\frac{...}{...} d\\theta = \\int_{0}^{\\infty} \\frac{\\frac{2du}{1+u^2}}{(1+\\eta) - (1-\\eta)\\frac{1-u^2}{1+u^2}} = \\int_{0}^{\\infty} \\frac{2du}{(1+\\eta)(1+u^2) - (1-\\eta)(1-u^2)}\n$$\n$$\n= \\int_{0}^{\\infty} \\frac{2du}{(1+\\eta+u^2+\\eta u^2) - (1-\\eta-u^2+\\eta u^2)} = \\int_{0}^{\\infty} \\frac{2du}{2\\eta+2u^2} = \\int_{0}^{\\infty} \\frac{du}{u^2+\\eta}\n$$\nThis is a standard arctangent integral form, $\\int \\frac{dx}{x^2+a^2} = \\frac{1}{a}\\arctan(x/a)$, with $a=\\sqrt{\\eta}$:\n$$\n\\left[ \\frac{1}{\\sqrt{\\eta}}\\arctan\\left(\\frac{u}{\\sqrt{\\eta}}\\right) \\right]_{0}^{\\infty} = \\frac{1}{\\sqrt{\\eta}}\\left( \\frac{\\pi}{2} - 0 \\right) = \\frac{\\pi}{2\\sqrt{\\eta}}\n$$\nThis corresponds to the time for $V$ to evolve from $V(0)=\\tan(0)=0$ to $V(t \\to \\infty) = \\tan(\\pi/2) \\to +\\infty$. By symmetry, the time from $V=-\\infty$ to $V=0$ is identical. This can be confirmed by evaluating the second integral from $\\pi$ to $2\\pi$, where $u$ goes from $-\\infty$ to $0$, which also yields $\\frac{\\pi}{2\\sqrt{\\eta}}$.\nThe total period $T(\\eta)$ is the sum of the two parts:\n$$\nT(\\eta) = \\frac{\\pi}{2\\sqrt{\\eta}} + \\frac{\\pi}{2\\sqrt{\\eta}} = \\frac{\\pi}{\\sqrt{\\eta}}\n$$\n\n### Asymptotic Analysis for $\\eta \\downarrow 0$\nThe exact expression $T(\\eta) = \\pi/\\sqrt{\\eta}$ immediately shows that as $\\eta \\downarrow 0$, $T(\\eta) \\to \\infty$ with a scaling of $\\eta^{-1/2}$.\nWe can provide a principled argument based on the phase dynamics. The rotational speed is $\\frac{d\\theta}{dt} = 1 + \\eta - (1-\\eta)\\cos(\\theta)$. The minimum speed occurs when $\\cos(\\theta)$ is maximal (i.e., $\\cos(\\theta)=1$), which happens at $\\theta = 2k\\pi$ for integer $k$. At these points, $\\frac{d\\theta}{dt}|_{\\text{min}} = 1+\\eta-(1-\\eta) = 2\\eta$. The maximum speed occurs when $\\cos(\\theta)=-1$ (at $\\theta = (2k+1)\\pi$), where $\\frac{d\\theta}{dt}|_{\\text{max}} = 1+\\eta+(1-\\eta) = 2$.\nAs $\\eta \\downarrow 0$, the minimum speed approaches $0$ while the maximum speed remains $2$. This creates a \"bottleneck\" or region of slow passage near $\\theta=0$. For small $\\eta$ and small $\\theta$, we can approximate the dynamics using $\\cos(\\theta) \\approx 1-\\theta^2/2$:\n$$\n\\frac{d\\theta}{dt} \\approx 1+\\eta - (1-\\eta)(1-\\theta^2/2) = 2\\eta + (1-\\eta)\\frac{\\theta^2}{2} \\approx 2\\eta + \\frac{\\theta^2}{2}\n$$\nThe time spent in a small interval $[-\\delta, \\delta]$ around the bottleneck is:\n$$\nT_{\\text{slow}} \\approx \\int_{-\\delta}^{\\delta} \\frac{d\\theta}{2\\eta + \\theta^2/2} = 2 \\int_{-\\delta}^{\\delta} \\frac{d\\theta}{\\theta^2 + 4\\eta} = 2 \\left[ \\frac{1}{2\\sqrt{\\eta}}\\arctan\\left(\\frac{\\theta}{2\\sqrt{\\eta}}\\right) \\right]_{-\\delta}^{\\delta} = \\frac{2}{\\sqrt{\\eta}}\\arctan\\left(\\frac{\\delta}{2\\sqrt{\\eta}}\\right)\n$$\nIn the limit $\\eta \\to 0$, for any fixed $\\delta0$, the argument $\\frac{\\delta}{2\\sqrt{\\eta}} \\to \\infty$, so $\\arctan\\left(\\frac{\\delta}{2\\sqrt{\\eta}}\\right) \\to \\frac{\\pi}{2}$. Therefore,\n$$\n\\lim_{\\eta\\to 0} T_{\\text{slow}} \\approx \\frac{2}{\\sqrt{\\eta}} \\cdot \\frac{\\pi}{2} = \\frac{\\pi}{\\sqrt{\\eta}}\n$$\nThis demonstrates that the divergence of the period is entirely due to the slowing down near the \"ghost\" of the saddle-node bifurcation at $\\theta=0$, and confirms the scaling $T(\\eta) \\propto \\eta^{-1/2}$.",
            "answer": "$$\n\\boxed{\\frac{\\pi}{\\sqrt{\\eta}}}\n$$"
        },
        {
            "introduction": "The Exponential Integrate-and-Fire (EIF) model provides a more biophysically realistic spike initiation mechanism than simpler models, but this realism introduces a significant numerical challenge. Because its voltage can diverge extremely rapidly, a phenomenon known as finite-time blow-up, standard fixed-step simulation methods can be highly inaccurate or fail to detect spikes altogether. This hands-on coding practice demonstrates this pitfall and guides you in implementing a robust, hybrid detection scheme that accurately captures spike times, a crucial skill for any computational modeling work .",
            "id": "3990544",
            "problem": "Consider the Exponential Integrate-and-Fire (EIF) neuron model, which extends the Leaky Integrate-and-Fire family with an exponential term in the membrane current. The membrane potential dynamics are governed by the ordinary differential equation\n$$\n\\frac{dV}{dt} \\;=\\; \\frac{-(V - E_L) + \\Delta_T \\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right) + R\\,I_0}{\\tau_m},\n$$\nwhere $V$ is the membrane potential in volts, $E_L$ is the leak reversal potential in volts, $\\Delta_T$ is the slope factor in volts, $V_T$ is the effective threshold in volts, $R$ is the passive membrane resistance in ohms, $I_0$ is an injected current in amperes, and $\\tau_m$ is the membrane time constant in seconds. A spike is recorded when $V$ reaches a predefined peak potential $V_{\\mathrm{peak}}$ in volts, at which point the time of threshold crossing is the spike time to report.\n\nFundamental base: The membrane equation is derived from conservation of charge across a passive capacitive membrane with a leak conductance and an active exponential current, consistent with Kirchhoff’s current law and standard Hodgkin–Huxley reductions. The exponential current term captures the rapid activation near threshold and is a well-tested phenomenological description.\n\nTask. You must demonstrate, by constructing a simulation, that naive fixed-step time-stepping can miss the true threshold crossing time for EIF due to the finite-time blow-up induced by the exponential term, and implement a robust root-finding strategy based on extrapolating the exponential term. Your derivation and implementation must start from the provided ordinary differential equation and basic calculus.\n\nAlgorithmic requirements:\n\n1. Implement a naive explicit Euler time-stepping scheme with step size $\\Delta t$ for the given ordinary differential equation. Detect a spike only at step boundaries by the criterion $V_{n+1} \\ge V_{\\mathrm{peak}}$, and record the spike time $t_{n+1}$ if this occurs.\n\n2. Implement a robust spike-time detection strategy inside each step based on the following principle: when the exponential term dominates the dynamics, the differential equation reduces to\n$$\n\\frac{dV}{dt} \\approx \\frac{\\Delta_T}{\\tau_m}\\,\\exp\\!\\left(\\frac{V - V_T}{\\Delta_T}\\right).\n$$\nDefine the transformed variable $y(t) = \\exp\\!\\left(-\\frac{V(t) - V_T}{\\Delta_T}\\right)$, and use the fact that near spike $y(t)$ evolves approximately linearly in time. Within a step starting at time $t_n$ with membrane potential $V_n$, if the dominance condition\n$$\n\\Delta_T\\,\\exp\\!\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) \\;\\ge\\; k\\,\\left|-(V_n - E_L) + R\\,I_0\\right|\n$$\nholds for a fixed dominance factor $k$ (use $k=5$), then approximate the spike time within the step by solving\n$$\ny(t) \\approx y_n - \\frac{t - t_n}{\\tau_m},\\quad y_n = \\exp\\!\\left(-\\frac{V_n - V_T}{\\Delta_T}\\right),\n$$\nfor the time $t_{\\mathrm{hit}}$ at which $V(t)$ reaches $V_{\\mathrm{peak}}$, i.e., when\n$$\ny(t_{\\mathrm{hit}}) = \\exp\\!\\left(-\\frac{V_{\\mathrm{peak}} - V_T}{\\Delta_T}\\right) =: y_{\\mathrm{peak}}.\n$$\nIf $t_{\\mathrm{hit}} \\in [t_n, t_n + \\Delta t]$, record $t_{\\mathrm{hit}}$ as the robust spike time. This strategy uses extrapolation of the exponential term to find the spike time inside the step.\n\n3. For each test case, run both detectors on the same trajectory starting at $V(0) = E_L$, up to a specified maximum time $T_{\\max}$. If no spike is detected by the robust method within $T_{\\max}$, report no spike. To quantify whether the naive method “misses” the threshold crossing, define a boolean indicator that is true if either the naive method fails to detect a spike while the robust method does detect one, or the absolute difference between the naive spike time and the robust spike time exceeds $\\frac{1}{2}\\Delta t$.\n\nUnits and outputs:\n\n- All potentials $V$, $E_L$, $V_T$, and $V_{\\mathrm{peak}}$ must be in volts.\n- All times must be in seconds in the simulation; the reported spike times must be expressed in milliseconds, rounded to $6$ decimal places.\n- Angles do not appear in this problem.\n- Currents must be in amperes.\n- Resistances must be in ohms.\n\nTest suite:\n\nUse the following four parameter sets, each specified as $(\\tau_m, E_L, V_T, \\Delta_T, R, I_0, V_{\\mathrm{peak}}, \\Delta t, T_{\\max})$.\n\n- Case A (general happy path): $(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, 0.5\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.0001\\,\\mathrm{s}, 0.1\\,\\mathrm{s})$.\n- Case B (coarse step, strong drive, clear miss): $(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, 1.5\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.002\\,\\mathrm{s}, 0.02\\,\\mathrm{s})$.\n- Case C (near-boundary dominance): $(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, 0.8\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.0005\\,\\mathrm{s}, 0.05\\,\\mathrm{s})$.\n- Case D (no spike edge case): $(0.02\\,\\mathrm{s}, -0.065\\,\\mathrm{V}, -0.055\\,\\mathrm{V}, 0.002\\,\\mathrm{V}, 100\\times 10^{6}\\,\\Omega, -0.5\\times 10^{-9}\\,\\mathrm{A}, -0.020\\,\\mathrm{V}, 0.0001\\,\\mathrm{s}, 0.1\\,\\mathrm{s})$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of two elements $[\\mathrm{miss}, t_{\\mathrm{robust}}]$ with $\\mathrm{miss}$ a boolean and $t_{\\mathrm{robust}}$ the robust spike time in milliseconds rounded to $6$ decimal places (use $-1.0$ if no spike is detected). For example, the output should look like $[[\\mathrm{True},1.234000],[\\mathrm{False},5.678000],\\dots]$ for the four cases, in the same order as the test suite.",
            "solution": "The dynamics of the membrane potential $V$ are described by the ordinary differential equation (ODE):\n$$\n\\frac{dV}{dt} = \\frac{1}{\\tau_m} \\left( -(V - E_L) + \\Delta_T \\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right) + R\\,I_0 \\right)\n$$\nHere, $\\tau_m$ is the membrane time constant, $E_L$ is the leak reversal potential, $V_T$ is the effective threshold potential, $\\Delta_T$ is the slope factor controlling the sharpness of the spike initiation, $R$ is the membrane resistance, and $I_0$ is a constant injected DC current.\n\nA numerical simulation is required to solve this ODE. We will employ the explicit Euler method, a first-order numerical procedure for solving ODEs with a given initial value. For a time step $\\Delta t$, the membrane potential at step $n+1$ is updated from the value at step $n$ as:\n$$\nV_{n+1} = V_n + \\Delta t \\cdot \\frac{dV}{dt}\\bigg|_{V=V_n}\n$$\n$$\nV_{n+1} = V_n + \\frac{\\Delta t}{\\tau_m} \\left( -(V_n - E_L) + \\Delta_T \\exp\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) + R\\,I_0 \\right)\n$$\nThe simulation starts at time $t=0$ with the initial condition $V(0) = E_L$.\n\nWe will implement two distinct methods for detecting when the neuron \"spikes,\" which is defined as the moment the potential $V(t)$ crosses a peak value $V_{\\mathrm{peak}}$.\n\n1.  **Naive Spike Detection**: This method operates strictly at the boundaries of the discrete time steps. After each Euler update, we check if the new potential $V_{n+1}$ has crossed the peak potential. If $V_{n+1} \\ge V_{\\mathrm{peak}}$ and a spike has not yet been detected by this method, the spike time is recorded as $t_{\\mathrm{naive}} = t_{n+1} = t_n + \\Delta t$. The primary drawback of this method is its dependence on the step size $\\Delta t$. The exponential term in the EIF model can cause a \"finite-time blow-up,\" where the voltage rises extremely rapidly. A large $\\Delta t$ may cause the simulation to jump from a sub-threshold voltage to a value far exceeding $V_{\\mathrm{peak}}$, making the recorded spike time $t_{n+1}$ a poor approximation of the true crossing time.\n\n2.  **Robust Spike Detection**: This method aims to find a more precise spike time within a time step by analyzing the dynamics when the exponential term becomes dominant. The dominance condition is given as:\n    $$\n    \\Delta_T\\,\\exp\\left(\\frac{V_n - V_T}{\\Delta_T}\\right) \\;\\ge\\; k\\,\\left|-(V_n - E_L) + R\\,I_0\\right|\n    $$\n    where $k=5$ is a fixed factor. When this condition is met at the beginning of a time step $(t_n, V_n)$, we can approximate the ODE by neglecting the linear leakage and input current terms:\n    $$\n    \\frac{dV}{dt} \\approx \\frac{\\Delta_T}{\\tau_m}\\,\\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right)\n    $$\n    To solve this, we introduce the transformation $y(t) = \\exp\\left(-\\frac{V(t) - V_T}{\\Delta_T}\\right)$. The time derivative of $y$ is:\n    $$\n    \\frac{dy}{dt} = \\frac{dy}{dV} \\frac{dV}{dt} = \\left(-\\frac{1}{\\Delta_T} \\exp\\left(-\\frac{V - V_T}{\\Delta_T}\\right)\\right) \\frac{dV}{dt} = -\\frac{y}{\\Delta_T} \\frac{dV}{dt}\n    $$\n    Substituting the approximated $\\frac{dV}{dt}$ and noting that $\\exp\\left(\\frac{V - V_T}{\\Delta_T}\\right) = 1/y$:\n    $$\n    \\frac{dy}{dt} \\approx -\\frac{y}{\\Delta_T} \\left( \\frac{\\Delta_T}{\\tau_m} \\frac{1}{y} \\right) = -\\frac{1}{\\tau_m}\n    $$\n    This shows that $y(t)$ evolves approximately linearly with a constant slope of $-1/\\tau_m$. We can extrapolate its value from the start of the step, $y_n = y(t_n)$:\n    $$\n    y(t) \\approx y_n - \\frac{t - t_n}{\\tau_m}\n    $$\n    We seek the time $t_{\\mathrm{hit}}$ where $V(t_{\\mathrm{hit}}) = V_{\\mathrm{peak}}$. This corresponds to $y(t_{\\mathrm{hit}}) = y_{\\mathrm{peak}} = \\exp\\left(-\\frac{V_{\\mathrm{peak}} - V_T}{\\Delta_T}\\right)$. Solving for $t_{\\mathrm{hit}}$:\n    $$\n    y_{\\mathrm{peak}} = y_n - \\frac{t_{\\mathrm{hit}} - t_n}{\\tau_m} \\implies t_{\\mathrm{hit}} = t_n + \\tau_m (y_n - y_{\\mathrm{peak}})\n    $$\n    If this calculated $t_{\\mathrm{hit}}$ falls within the current time step, i.e., $t_n \\le t_{\\mathrm{hit}}  t_n + \\Delta t$, we record it as the robust spike time, $t_{\\mathrm{robust}}$.\n\nThe simulation for each test case proceeds by iterating with step size $\\Delta t$ up to a maximum time $T_{\\max}$. In each step, we apply both detection strategies on the same voltage trajectory defined by the Euler updates. We continue the simulation until $T_{\\max}$ is reached or until both methods have registered a spike, to ensure a complete comparison. If the robust method does not find a spike, its time is reported as $-1.0$.\n\nFinally, we determine if the naive method \"missed\" the threshold crossing. The `miss` indicator is set to true if:\n(a) The robust method detects a spike, but the naive method does not within $T_{\\max}$.\n(b) Both methods detect a spike, but their recorded times differ by more than half a time step: $|t_{\\mathrm{naive}} - t_{\\mathrm{robust}}|  0.5 \\Delta t$.\n\nThe final output for each case is a pair `[miss, t_robust_ms]`, where `miss` is the boolean indicator and `t_robust_ms` is the robustly detected spike time in milliseconds, rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(params):\n    \"\"\"\n    Simulates an Exponential Integrate-and-Fire (EIF) neuron model and\n    compares naive and robust spike detection methods.\n\n    Args:\n        params (tuple): A tuple containing all model and simulation parameters:\n            (tau_m, E_L, V_T, Delta_T, R, I_0, V_peak, dt, T_max).\n\n    Returns:\n        list: A list containing [miss, t_robust_ms], where 'miss' is a boolean\n              and 't_robust_ms' is the robust spike time in ms, rounded to 6\n              decimal places (-1.0 if no spike).\n    \"\"\"\n    tau_m, E_L, V_T, Delta_T, R, I_0, V_peak, dt, T_max = params\n    k = 5.0  # Dominance factor\n\n    V = E_L  # Initial membrane potential\n    t = 0.0   # Initial time\n\n    t_naive = -1.0\n    t_robust = -1.0\n\n    # Pre-calculate for efficiency\n    y_peak = np.exp(-(V_peak - V_T) / Delta_T)\n\n    while t = T_max:\n        # ---- Robust Spike Detection (Extrapolation) ----\n        if t_robust == -1.0:\n            # Check dominance condition\n            exp_term = Delta_T * np.exp((V - V_T) / Delta_T)\n            linear_term = -(V - E_L) + R * I_0\n            \n            if exp_term = k * np.abs(linear_term):\n                y_n = np.exp(-(V - V_T) / Delta_T)\n                # Calculate time to hit V_peak based on linear extrapolation of y\n                t_hit = t + tau_m * (y_n - y_peak)\n                \n                # If hit time is within the current step, record it\n                if t = t_hit  t + dt:\n                    t_robust = t_hit\n        \n        # ---- Explicit Euler Step ----\n        dVdt = (-(V - E_L) + Delta_T * np.exp((V - V_T) / Delta_T) + R * I_0) / tau_m\n        V_next = V + dt * dVdt\n        t_next = t + dt\n\n        # ---- Naive Spike Detection (Step Boundary) ----\n        if t_naive == -1.0:\n            if V_next = V_peak:\n                t_naive = t_next\n\n        # Update state for next iteration\n        V = V_next\n        t = t_next\n\n        # Optimization: if both spikes are found, no need to continue\n        if t_naive != -1.0 and t_robust != -1.0:\n            break\n\n    # ---- Determine if naive method \"missed\" ----\n    miss = False\n    robust_succeeded = t_robust != -1.0\n    naive_succeeded = t_naive != -1.0\n\n    if robust_succeeded and not naive_succeeded:\n        miss = True\n    elif robust_succeeded and naive_succeeded:\n        if np.abs(t_naive - t_robust)  0.5 * dt:\n            miss = True\n\n    # ---- Format output ----\n    if robust_succeeded:\n        t_robust_ms = round(t_robust * 1000.0, 6)\n    else:\n        t_robust_ms = -1.0\n\n    return [miss, t_robust_ms]\n\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: (tau_m, E_L, V_T, Delta_T, R, I_0, V_peak, dt, T_max)\n        (0.02, -0.065, -0.055, 0.002, 100e6, 0.5e-9, -0.020, 0.0001, 0.1),\n        # Case B\n        (0.02, -0.065, -0.055, 0.002, 100e6, 1.5e-9, -0.020, 0.002, 0.02),\n        # Case C\n        (0.02, -0.065, -0.055, 0.002, 100e6, 0.8e-9, -0.020, 0.0005, 0.05),\n        # Case D\n        (0.02, -0.065, -0.055, 0.002, 100e6, -0.5e-9, -0.020, 0.0001, 0.1),\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(run_simulation(params))\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for miss, t_rob_ms in results:\n        # Use str() for boolean to get 'True'/'False'\n        miss_str = str(miss)\n        if t_rob_ms == -1.0:\n            t_str = \"-1.0\"\n        else:\n            # Format to 6 decimal places with trailing zeros\n            t_str = f\"{t_rob_ms:.6f}\"\n        \n        formatted_results.append(f\"[{miss_str},{t_str}]\")\n    \n    # Join the sub-lists into the final string\n    print(f\"[[{','.join(formatted_results)}]]\")\n\nsolve()\n\n```"
        }
    ]
}