{
    "hands_on_practices": [
        {
            "introduction": "We begin with a fundamental question about neuronal excitability: how many excitatory synapses must activate synchronously to make a neuron fire? This exercise provides a concrete, quantitative look at how a background of shunting inhibition powerfully modulates a neuron's firing threshold. By applying a quasi-steady-state analysis to a neuron receiving both excitatory and shunting inputs, you will calculate the number of inputs required to reach the spike threshold, revealing the potent effect of conductance changes on neuronal computation. ",
            "id": "4024800",
            "problem": "Consider a single-compartment conductance-driven neuron modeled within the Leaky Integrate-and-Fire (LIF) framework. The neuron is initially at its resting potential and receives synchronous excitatory synaptic inputs on a background of shunting conductance. Assume the following biophysical properties and conditions, all scientifically plausible and typical for cortical pyramidal neurons receiving balanced synaptic bombardment:\n\n- Resting potential is $E_{\\mathrm{rest}} = -65\\ \\mathrm{mV}$.\n- Spike threshold is $V_{\\mathrm{th}} = -50\\ \\mathrm{mV}$.\n- Leak conductance is $g_{L} = 10\\ \\mathrm{nS}$ and membrane capacitance is $C = 200\\ \\mathrm{pF}$.\n- Background shunting conductance is present at the soma with $g_{\\mathrm{bk}} = 90\\ \\mathrm{nS}$ and reversal $E_{\\mathrm{bk}} = E_{\\mathrm{rest}}$.\n- Each excitatory synaptic input is conductance-based with peak conductance $g_{e} = 1\\ \\mathrm{nS}$, normalized gating variable $s(t)$ that peaks at $s_{\\max} = 1$, and reversal $E_{e} = 0\\ \\mathrm{mV}$. All inputs are identical and arrive synchronously.\n- The excitatory gating $s(t)$ varies slowly relative to the effective membrane time constant during the input, so that near the population peak the membrane potential can be treated as quasi-steady with respect to the instantaneous conductance configuration.\n\nStarting from the fundamental single-compartment current balance and definitions of conductance and reversal potentials, derive the condition under which the summed excitatory postsynaptic potentials (EPSPs) cross spike threshold in the presence of the background shunting conductance. Then, using the numerical values provided, compute the minimal integer number $N$ of synchronous excitatory inputs required to elicit a spike. Report the final number of inputs as an integer with no units. If any intermediate numerical evaluations are needed, they must be exact; no rounding is required for the final answer.",
            "solution": "The problem is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- Resting potential: $E_{\\mathrm{rest}} = -65\\ \\mathrm{mV}$\n- Spike threshold: $V_{\\mathrm{th}} = -50\\ \\mathrm{mV}$\n- Leak conductance: $g_{L} = 10\\ \\mathrm{nS}$\n- Membrane capacitance: $C = 200\\ \\mathrm{pF}$\n- Background shunting conductance: $g_{\\mathrm{bk}} = 90\\ \\mathrm{nS}$\n- Reversal potential for background shunt: $E_{\\mathrm{bk}} = E_{\\mathrm{rest}}$\n- Peak conductance per excitatory synapse: $g_{e} = 1\\ \\mathrm{nS}$\n- Peak of normalized gating variable: $s_{\\max} = 1$\n- Reversal potential for excitatory synapse: $E_{e} = 0\\ \\mathrm{mV}$\n- Assumption of synchronous inputs.\n- Assumption of quasi-steady state for membrane potential near the peak of synaptic input.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on the standard single-compartment conductance-based neuron model (Leaky Integrate-and-Fire), a fundamental tool in computational neuroscience. The provided biophysical parameters are realistic for cortical neurons. The concepts of synaptic summation and shunting inhibition are central to the discipline. The problem is self-contained, with all necessary data and a crucial simplifying assumption (quasi-steady state) that makes it algebraically solvable. It is free from contradictions, ambiguities, and non-scientific claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A detailed solution follows.\n\nThe dynamics of the membrane potential $V$ in a single-compartment model are described by the current balance equation:\n$$C \\frac{dV}{dt} = -I_{\\mathrm{ion}}$$\nwhere $C$ is the membrane capacitance and $I_{\\mathrm{ion}}$ is the sum of all ionic currents flowing across the membrane. In this problem, the contributing currents are the leak current ($I_{L}$), the background shunting current ($I_{\\mathrm{bk}}$), and the total excitatory synaptic current ($I_{e}$).\n$$I_{\\mathrm{ion}} = I_{L} + I_{\\mathrm{bk}} + I_{e}$$\nEach current is defined by its conductance and the difference between the membrane potential and its respective reversal potential:\n$$I_{L} = g_{L}(V - E_{\\mathrm{rest}})$$\n$$I_{\\mathrm{bk}} = g_{\\mathrm{bk}}(V - E_{\\mathrm{bk}})$$\n$$I_{e} = g_{\\mathrm{total\\_e}}(t)(V - E_{e})$$\nThe total excitatory conductance $g_{\\mathrm{total\\_e}}(t)$ is the sum of conductances from $N$ identical, synchronous inputs. At its peak, where the gating variable $s(t)$ reaches its maximum $s_{\\max} = 1$, the total excitatory conductance is:\n$$g_{\\mathrm{total\\_e, peak}} = N \\cdot g_{e} \\cdot s_{\\max} = N g_{e}$$\nThe problem states that we can assume a quasi-steady state for the membrane potential near the peak of the synchronous input. This implies that the rate of change of the membrane potential is negligible, $\\frac{dV}{dt} \\approx 0$. The current balance equation thus simplifies to an algebraic equation:\n$$I_{L} + I_{\\mathrm{bk}} + I_{e} = 0$$\nSubstituting the expressions for the currents at the peak of the excitatory input, we get:\n$$g_{L}(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + g_{\\mathrm{bk}}(V_{\\mathrm{peak}} - E_{\\mathrm{bk}}) + N g_{e}(V_{\\mathrm{peak}} - E_{e}) = 0$$\nwhere $V_{\\mathrm{peak}}$ is the peak membrane potential achieved. We are given that the reversal potential for the background shunt is equal to the resting potential, $E_{\\mathrm{bk}} = E_{\\mathrm{rest}}$. This allows for a simplification:\n$$g_{L}(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + g_{\\mathrm{bk}}(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + N g_{e}(V_{\\mathrm{peak}} - E_{e}) = 0$$\n$$(g_{L} + g_{\\mathrm{bk}})(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + N g_{e}(V_{\\mathrm{peak}} - E_{e}) = 0$$\nTo find the minimum number of inputs $N$ required to elicit a spike, we must find the condition under which the peak membrane potential $V_{\\mathrm{peak}}$ reaches the spike threshold $V_{\\mathrm{th}}$. We set $V_{\\mathrm{peak}} = V_{\\mathrm{th}}$ and solve for $N$:\n$$(g_{L} + g_{\\mathrm{bk}})(V_{\\mathrm{th}} - E_{\\mathrm{rest}}) + N g_{e}(V_{\\mathrm{th}} - E_{e}) = 0$$\nRearranging the equation to solve for $N$:\n$$N g_{e}(V_{\\mathrm{th}} - E_{e}) = -(g_{L} + g_{\\mathrm{bk}})(V_{\\mathrm{th}} - E_{\\mathrm{rest}})$$\n$$N g_{e}(V_{\\mathrm{th}} - E_{e}) = (g_{L} + g_{\\mathrm{bk}})(E_{\\mathrm{rest}} - V_{\\mathrm{th}})$$\nThe final derived condition for the number of inputs $N$ is:\n$$N = \\frac{(g_{L} + g_{\\mathrm{bk}})(E_{\\mathrm{rest}} - V_{\\mathrm{th}})}{g_{e}(V_{\\mathrm{th}} - E_{e})}$$\nNow, we substitute the given numerical values into this expression. The units (nS for conductance, mV for potential) will cancel out, yielding a dimensionless number for $N$.\nGiven values:\n$g_{L} = 10\\ \\mathrm{nS}$\n$g_{\\mathrm{bk}} = 90\\ \\mathrm{nS}$\n$g_{e} = 1\\ \\mathrm{nS}$\n$E_{\\mathrm{rest}} = -65\\ \\mathrm{mV}$\n$V_{\\mathrm{th}} = -50\\ \\mathrm{mV}$\n$E_{e} = 0\\ \\mathrm{mV}$\n\nFirst, we calculate the terms in the expression for $N$:\nThe sum of passive conductances is $g_{L} + g_{\\mathrm{bk}} = 10\\ \\mathrm{nS} + 90\\ \\mathrm{nS} = 100\\ \\mathrm{nS}$.\nThe voltage difference from rest to threshold is $E_{\\mathrm{rest}} - V_{\\mathrm{th}} = -65\\ \\mathrm{mV} - (-50\\ \\mathrm{mV}) = -15\\ \\mathrm{mV}$.\nThe driving force for the excitatory current at threshold is $V_{\\mathrm{th}} - E_{e} = -50\\ \\mathrm{mV} - 0\\ \\mathrm{mV} = -50\\ \\mathrm{mV}$.\n\nSubstituting these into the equation for $N$:\n$$N = \\frac{(100\\ \\mathrm{nS})(-15\\ \\mathrm{mV})}{(1\\ \\mathrm{nS})(-50\\ \\mathrm{mV})} = \\frac{-1500}{-50} = \\frac{150}{5} = 30$$\nThe calculation yields an integer value $N = 30$. This represents the exact number of synchronous inputs required for the membrane potential to reach the spike threshold under the given conditions. Since the problem asks for the minimal integer number, and $N=30$ exactly satisfies the condition $V_{\\mathrm{peak}} = V_{\\mathrm{th}}$, this is the required answer.",
            "answer": "$$\\boxed{30}$$"
        },
        {
            "introduction": "The integration of synaptic inputs is often non-linear, a crucial feature that simple current-summation models fail to capture. This practice is designed to highlight the non-linearity inherent in shunting inhibition by having you compare the actual membrane potential with a flawed linear prediction. By calculating the voltage response to overlapping excitatory and inhibitory conductances, you will quantify the error in the linear model and gain a deeper intuition for how shunting divisively scales excitatory potentials by increasing the total membrane conductance. ",
            "id": "4024857",
            "problem": "Consider a single-compartment neuron described by the passive membrane equation with time-dependent synaptic conductances,\n$$\nC \\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;-\\; g_{e}(t)\\,\\big(V - E_{e}\\big) \\;-\\; g_{i}(t)\\,\\big(V - E_{i}\\big),\n$$\nwhere $C$ is the membrane capacitance, $g_{L}$ is the leak conductance, $E_{L}$ is the leak reversal potential, $g_{e}(t)$ is the excitatory synaptic conductance with reversal potential $E_{e}$, and $g_{i}(t)$ is the inhibitory synaptic conductance with reversal potential $E_{i}$. Let the neuron start from rest at $t=0$ with $V(0)=E_{L}$. Assume the synaptic conductances are exponentially decaying after their onset times:\n$$\ng_{e}(t) \\;=\\; \\bar{g}_{e} \\,\\exp\\!\\left(-\\frac{t}{\\tau_{e}}\\right)\\,H(t), \\quad\ng_{i}(t) \\;=\\; \\bar{g}_{i} \\,\\exp\\!\\left(-\\frac{t-\\Delta}{\\tau_{i}}\\right)\\,H(t-\\Delta),\n$$\nwhere $\\bar{g}_{e}$ and $\\bar{g}_{i}$ are peak conductances, $\\tau_{e}$ and $\\tau_{i}$ are decay time constants, $\\Delta$ is the inhibitory onset delay, and $H(\\cdot)$ is the Heaviside step function.\n\nWork in the slow-synapse regime relative to the membrane time constant, so that the membrane charging dynamics are negligible on the timescale of synaptic decay, and the voltage can be approximated by instantaneous current balance at each time $t$. Starting from the passive membrane equation, derive the expression for the membrane potential $V(t)$ under this quasi-steady-state approximation and evaluate it at $t^{\\ast} = 6\\,\\text{ms}$ using the parameters\n$$\nC = 2\\,\\text{pF}, \\quad g_{L} = 10\\,\\text{nS}, \\quad E_{L} = -65\\,\\text{mV}, \\quad E_{e} = 0\\,\\text{mV}, \\quad E_{i} = -65\\,\\text{mV},\n$$\n$$\n\\bar{g}_{e} = 8\\,\\text{nS}, \\quad \\tau_{e} = 4\\,\\text{ms}, \\quad \\bar{g}_{i} = 40\\,\\text{nS}, \\quad \\tau_{i} = 8\\,\\text{ms}, \\quad \\Delta = 2\\,\\text{ms}.\n$$\nIn parallel, construct a linear prediction that assumes fixed driving forces equal to their values at rest $V_{\\mathrm{ref}} = E_{L}$, meaning that synaptic currents are treated as $I_{\\mathrm{syn}}^{\\mathrm{lin}}(t) = g_{e}(t)\\,\\big(E_{e} - V_{\\mathrm{ref}}\\big) + g_{i}(t)\\,\\big(E_{i} - V_{\\mathrm{ref}}\\big)$ without altering the total membrane conductance, and use the same slow-synapse regime to obtain $V_{\\mathrm{lin}}(t)$ at $t^{\\ast} = 6\\,\\text{ms}$.\n\nCompute the difference $\\Delta V = V(t^{\\ast}) - V_{\\mathrm{lin}}(t^{\\ast})$. Express the final answer in millivolts and round your answer to four significant figures.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a standard single-compartment neuron model and asks for a comparison between the full non-linear voltage response and a linearized approximation, a common analysis in computational neuroscience. All necessary parameters and conditions are provided. Therefore, the problem is valid and a solution can be derived.\n\nFirst, we derive the expression for the membrane potential $V(t)$ under the quasi-steady-state approximation. The governing differential equation for the membrane potential is\n$$\nC \\frac{dV}{dt} = -g_{L}\\big(V - E_{L}\\big) - g_{e}(t)\\big(V - E_{e}\\big) - g_{i}(t)\\big(V - E_{i}\\big)\n$$\nThe problem specifies the slow-synapse regime, which allows for a quasi-steady-state approximation where the membrane voltage instantaneously equilibrates to the synaptic inputs. This is equivalent to setting the capacitive current to zero, $C \\frac{dV}{dt} \\approx 0$. The equation becomes an algebraic equation for $V$:\n$$\n0 = -g_{L}\\big(V(t) - E_{L}\\big) - g_{e}(t)\\big(V(t) - E_{e}\\big) - g_{i}(t)\\big(V(t) - E_{i}\\big)\n$$\nWe can rearrange this equation to solve for $V(t)$:\n$$\nV(t) \\big( g_{L} + g_{e}(t) + g_{i}(t) \\big) = g_{L}E_{L} + g_{e}(t)E_{e} + g_{i}(t)E_{i}\n$$\nThe membrane potential at any time $t$ is thus the weighted average of the reversal potentials, where the weights are the respective conductances:\n$$\nV(t) = \\frac{g_{L}E_{L} + g_{e}(t)E_{e} + g_{i}(t)E_{i}}{g_{L} + g_{e}(t) + g_{i}(t)}\n$$\nWe need to evaluate this expression at $t^{\\ast} = 6\\,\\text{ms}$. First, we compute the synaptic conductances $g_e(t^{\\ast})$ and $g_i(t^{\\ast})$.\nThe excitatory conductance is $g_{e}(t) = \\bar{g}_{e} \\exp(-t/\\tau_{e})H(t)$. At $t^{\\ast} = 6\\,\\text{ms}$, since $t^{\\ast}  0$, $H(t^{\\ast})=1$.\n$$\ng_{e}(t^{\\ast}) = (8\\,\\text{nS}) \\exp\\left(-\\frac{6\\,\\text{ms}}{4\\,\\text{ms}}\\right) = 8 \\exp(-1.5)\\,\\text{nS}\n$$\nThe inhibitory conductance is $g_{i}(t) = \\bar{g}_{i} \\exp(-(t-\\Delta)/\\tau_{i})H(t-\\Delta)$. At $t^{\\ast} = 6\\,\\text{ms}$ with $\\Delta = 2\\,\\text{ms}$, we have $t^{\\ast}-\\Delta = 4\\,\\text{ms}  0$, so $H(t^{\\ast}-\\Delta)=1$.\n$$\ng_{i}(t^{\\ast}) = (40\\,\\text{nS}) \\exp\\left(-\\frac{6\\,\\text{ms} - 2\\,\\text{ms}}{8\\,\\text{ms}}\\right) = 40 \\exp\\left(-\\frac{4}{8}\\right) = 40 \\exp(-0.5)\\,\\text{nS}\n$$\nNow we substitute these conductances and the given parameters into the expression for $V(t^{\\ast})$: $g_{L} = 10\\,\\text{nS}$, $E_{L} = -65\\,\\text{mV}$, $E_{e} = 0\\,\\text{mV}$, and $E_{i} = -65\\,\\text{mV}$.\n$$\nV(t^{\\ast}) = \\frac{(10\\,\\text{nS})(-65\\,\\text{mV}) + (8 \\exp(-1.5)\\,\\text{nS})(0\\,\\text{mV}) + (40 \\exp(-0.5)\\,\\text{nS})(-65\\,\\text{mV})}{10\\,\\text{nS} + 8 \\exp(-1.5)\\,\\text{nS} + 40 \\exp(-0.5)\\,\\text{nS}}\n$$\n$$\nV(t^{\\ast}) = \\frac{-65 \\left( 10 + 40 \\exp(-0.5) \\right)}{10 + 8 \\exp(-1.5) + 40 \\exp(-0.5)}\\,\\text{mV}\n$$\nNumerically, $e^{-1.5} \\approx 0.223130$ and $e^{-0.5} \\approx 0.606531$.\n$g_e(t^{\\ast}) \\approx 8 \\times 0.223130 = 1.78504\\,\\text{nS}$.\n$g_i(t^{\\ast}) \\approx 40 \\times 0.606531 = 24.2612\\,\\text{nS}$.\n$$\nV(t^{\\ast}) \\approx \\frac{-65 (10 + 24.2612)}{10 + 1.78504 + 24.2612} = \\frac{-65 \\times 34.2612}{36.04624} \\approx -61.7816\\,\\text{mV}\n$$\n\nNext, we construct the linear prediction $V_{\\mathrm{lin}}(t)$. The problem states that synaptic inputs are treated as current sources $I_{\\mathrm{syn}}^{\\mathrm{lin}}(t) = g_{e}(t)(E_{e} - V_{\\mathrm{ref}}) + g_{i}(t)(E_{i} - V_{\\mathrm{ref}})$ with $V_{\\mathrm{ref}} = E_L$, and that the total membrane conductance is not altered, meaning it remains $g_L$. The effective membrane equation for the linear model is:\n$$\nC \\frac{dV_{\\mathrm{lin}}}{dt} = -g_{L}(V_{\\mathrm{lin}} - E_{L}) + g_{e}(t)(E_{e} - E_{L}) + g_{i}(t)(E_{i} - E_{L})\n$$\nApplying the same quasi-steady-state approximation ($C \\frac{dV_{\\mathrm{lin}}}{dt} \\approx 0$):\n$$\n0 = -g_{L}(V_{\\mathrm{lin}}(t) - E_{L}) + g_{e}(t)(E_{e} - E_{L}) + g_{i}(t)(E_{i} - E_{L})\n$$\nSolving for $V_{\\mathrm{lin}}(t)$:\n$$\ng_{L}V_{\\mathrm{lin}}(t) = g_{L}E_{L} + g_{e}(t)(E_{e} - E_{L}) + g_{i}(t)(E_{i} - E_{L})\n$$\n$$\nV_{\\mathrm{lin}}(t) = E_{L} + \\frac{g_{e}(t)}{g_{L}}(E_{e} - E_{L}) + \\frac{g_{i}(t)}{g_{L}}(E_{i} - E_{L})\n$$\nWe evaluate this at $t^{\\ast} = 6\\,\\text{ms}$. We have $E_{e} - E_{L} = 0\\,\\text{mV} - (-65\\,\\text{mV}) = 65\\,\\text{mV}$, and $E_{i} - E_{L} = -65\\,\\text{mV} - (-65\\,\\text{mV}) = 0\\,\\text{mV}$. The term involving the inhibitory conductance vanishes.\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) = E_{L} + \\frac{g_{e}(t^{\\ast})}{g_{L}}(E_{e} - E_{L})\n$$\nSubstituting the numerical values:\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) = -65\\,\\text{mV} + \\frac{8 \\exp(-1.5)\\,\\text{nS}}{10\\,\\text{nS}}(65\\,\\text{mV})\n$$\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) = -65 + \\frac{8 \\times 65}{10} \\exp(-1.5) = -65 + 52 \\exp(-1.5)\\,\\text{mV}\n$$\nNumerically:\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) \\approx -65 + 52 \\times 0.223130 = -65 + 11.60276 = -53.39724\\,\\text{mV}\n$$\nFinally, we compute the difference $\\Delta V = V(t^{\\ast}) - V_{\\mathrm{lin}}(t^{\\ast})$:\n$$\n\\Delta V \\approx -61.7816\\,\\text{mV} - (-53.39724\\,\\text{mV}) = -8.38436\\,\\text{mV}\n$$\nThe problem asks to round the final answer to four significant figures.\n$$\n\\Delta V \\approx -8.384\\,\\text{mV}\n$$\nThe negative sign indicates that the actual voltage ($V$) is more hyperpolarized than the linearized prediction ($V_{\\mathrm{lin}}$). This is the hallmark of shunting inhibition: the inhibitory conductance $g_i(t)$, although having a reversal potential $E_i$ equal to the resting potential $E_L$, increases the total membrane conductance, which reduces the depolarizing effect of the excitatory current. The linear model fails to capture this shunting effect, as the inhibitory current term becomes zero, leading to an overestimation of the membrane potential.",
            "answer": "$$\\boxed{-8.384}$$"
        },
        {
            "introduction": "Building on the previous concepts, we now formalize the role of shunting inhibition as a mechanism for \"gain control.\" This capstone exercise combines analytical derivation with computational practice, a core workflow in modern neuroscience. You will first derive the mathematical expression showing how shunting inhibition divisively scales the gain of excitatory inputs, and then write code to simulate the neuron's dynamics and validate your theoretical prediction against numerical results. ",
            "id": "4024781",
            "problem": "Consider a single-compartment conductance-based point neuron receiving synaptic inputs. The membrane voltage $V(t)$ evolves according to the current balance Ordinary Differential Equation (ODE)\n$$\nC \\frac{dV}{dt} \\;=\\; -\\,g_L\\,\\big(V - E_L\\big)\\;-\\;g_{\\mathrm{exc}}(t)\\,\\big(V - E_{\\mathrm{exc}}\\big)\\;-\\;g_{\\mathrm{inh}}(t)\\,\\big(V - E_{\\mathrm{inh}}\\big),\n$$\nwhere $C$ is the membrane capacitance, $g_L$ is the leak conductance with reversal potential $E_L$, $g_{\\mathrm{exc}}(t)$ is the excitatory synaptic conductance with reversal potential $E_{\\mathrm{exc}}$, and $g_{\\mathrm{inh}}(t)$ is the inhibitory synaptic conductance with reversal potential $E_{\\mathrm{inh}}$. In the regime of shunting inhibition, $E_{\\mathrm{inh}} \\approx E_L$, and the inhibitory current primarily increases the effective membrane conductance without significantly changing the driving force near rest. Your task is to derive, from first principles and without assuming any shortcut formulas, how shunting inhibition changes the small-signal gain from excitatory conductance to voltage deflection when linearized near $V \\approx E_L$. Then, validate the derived gain change against numerical simulation of the ODE using the specified test suite.\n\nDerivation requirements:\n- Start from the ODE above and define the voltage deflection $\\delta V(t) = V(t) - E_L$.\n- Under the assumption $E_{\\mathrm{inh}} = E_L$, perform a principled linearization around $V \\approx E_L$ for small excitatory conductance perturbations $g_{\\mathrm{exc}}(t)$, and obtain an expression that shows how the effective gain from $g_{\\mathrm{exc}}(t)$ to $\\delta V(t)$ is modulated by $g_{\\mathrm{inh}}(t)$.\n- Clearly state all approximations and their validity conditions in terms of relative magnitudes of conductances and time scales.\n\nSimulation and validation requirements:\n- Implement a numerical solver for the ODE using a fixed time step $\\Delta t$ and explicit update. Units must be consistently used as follows: voltages in $\\mathrm{mV}$, conductances in $\\mathrm{nS}$, capacitance in $\\mathrm{nF}$, and time in $\\mathrm{ms}$. With these units, note that $\\mathrm{nS}/\\mathrm{nF}$ has the dimension of $1/\\mathrm{ms}$, so the ODE is dimensionally consistent.\n- Use the derived expression to compute a predicted divisive gain factor as a function of $g_{\\mathrm{inh}}(t)$, and compare it to the gain measured from the simulation. For constant conductances, use steady-state deflections. For time-varying $g_{\\mathrm{inh}}(t)$, compare the instantaneous ratios after an initial warm-up period using a root-mean-square (RMS) error metric.\n\nTest suite:\n- Use the following fixed parameters for all tests unless specified otherwise: $C = 0.2\\,\\mathrm{nF}$, $g_L = 10\\,\\mathrm{nS}$, $E_L = -65\\,\\mathrm{mV}$, $E_{\\mathrm{exc}} = 0\\,\\mathrm{mV}$, $\\Delta t = 0.05\\,\\mathrm{ms}$. Excitatory conductance is held constant at a small value $g_{\\mathrm{exc}}(t) \\equiv 0.01\\,\\mathrm{nS}$ in all tests to stay in the small-signal regime.\n- Define four test cases:\n    1. Constant no inhibition: $g_{\\mathrm{inh}}(t) \\equiv 0\\,\\mathrm{nS}$, $E_{\\mathrm{inh}} = E_L$, simulate for $T = 300\\,\\mathrm{ms}$. Compute the steady-state ratio $r_{\\mathrm{num}}$ of $\\delta V$ with inhibition to the baseline without inhibition, and compare to the predicted factor using a tolerance $\\varepsilon_1 = 10^{-3}$ (absolute difference).\n    2. Constant shunt: $g_{\\mathrm{inh}}(t) \\equiv 5\\,\\mathrm{nS}$, $E_{\\mathrm{inh}} = E_L$, simulate for $T = 300\\,\\mathrm{ms}$. Compute $r_{\\mathrm{num}}$ at steady state and compare with the predicted factor using $\\varepsilon_1 = 10^{-3}$.\n    3. Time-varying shunt: $g_{\\mathrm{inh}}(t) = 4 + 2\\sin\\!\\big(2\\pi f t\\big)\\,\\mathrm{nS}$ with $f = 0.002\\,\\mathrm{cycles/ms}$ (that is, $2\\,\\mathrm{Hz}$), $E_{\\mathrm{inh}} = E_L$, simulate for $T = 2000\\,\\mathrm{ms}$. After a warm-up of $300\\,\\mathrm{ms}$, compute the instantaneous ratio $r_{\\mathrm{num}}(t)$ and the predicted factor for each time point, then compute the RMS error over the analysis window. Use tolerance $\\varepsilon_2 = 0.03$ (absolute RMS error).\n    4. Constant non-shunting inhibition (edge case): $g_{\\mathrm{inh}}(t) \\equiv 5\\,\\mathrm{nS}$, but $E_{\\mathrm{inh}} = E_L - 3\\,\\mathrm{mV}$, simulate for $T = 300\\,\\mathrm{ms}$. Compute the steady-state ratio $r_{\\mathrm{num}}$ and compare with the same predicted factor derived under the shunting assumption using tolerance $\\varepsilon_1 = 10^{-3}$. This test probes the boundary of the assumption $E_{\\mathrm{inh}} \\approx E_L$ and will generally not satisfy the tolerance.\n\nAnswer specification:\n- For tests with constant conductances, use the end-of-simulation steady-state values.\n- For the time-varying conductance test, use the RMS error over the post-warm-up interval.\n- Your program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets (for example, $\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}\\right]$), indicating whether each test meets its respective tolerance criterion in the order specified above.",
            "solution": "The objective is to derive the effect of shunting inhibition on the input-output gain of a single-compartment neuron model and validate this derivation via numerical simulation. The analysis proceeds in two stages: first, a principled analytical derivation from the governing Ordinary Differential Equation (ODE), and second, a numerical implementation to test the derived formula against specific cases.\n\n### Part 1: Analytical Derivation\n\nThe dynamics of the membrane voltage $V(t)$ are governed by the current balance equation:\n$$\nC \\frac{dV}{dt} = -g_L(V - E_L) - g_{\\mathrm{exc}}(t)(V - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t)(V - E_{\\mathrm{inh}})\n$$\nwhere $C$ is capacitance, $E_L$, $E_{\\mathrm{exc}}$, $E_{\\mathrm{inh}}$ are reversal potentials, and $g_L$, $g_{\\mathrm{exc}}(t)$, $g_{\\mathrm{inh}}(t)$ are the leak, excitatory, and inhibitory conductances, respectively.\n\nWe are interested in the voltage deflection $\\delta V(t)$ from the leak reversal potential $E_L$, defined as $\\delta V(t) = V(t) - E_L$. Substituting $V(t) = \\delta V(t) + E_L$ into the ODE, and noting that $dE_L/dt = 0$, we get:\n$$\nC \\frac{d\\delta V}{dt} = -g_L \\delta V - g_{\\mathrm{exc}}(t)(\\delta V + E_L - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t)(\\delta V + E_L - E_{\\mathrm{inh}})\n$$\nThe problem specifies the shunting inhibition regime, which is mathematically modeled by the approximation $E_{\\mathrm{inh}} \\approx E_L$. Setting $E_{\\mathrm{inh}} = E_L$ simplifies the last term:\n$$\nC \\frac{d\\delta V}{dt} = -g_L \\delta V - g_{\\mathrm{exc}}(t)(\\delta V + E_L - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t) \\delta V\n$$\nWe can rearrange the terms by separating those proportional to $\\delta V$ from the driving terms:\n$$\nC \\frac{d\\delta V}{dt} = -\\left(g_L + g_{\\mathrm{exc}}(t) + g_{\\mathrm{inh}}(t)\\right)\\delta V - g_{\\mathrm{exc}}(t)(E_L - E_{\\mathrm{exc}})\n$$\n$$\nC \\frac{d\\delta V}{dt} + \\left(g_L + g_{\\mathrm{exc}}(t) + g_{\\mathrm{inh}}(t)\\right)\\delta V = g_{\\mathrm{exc}}(t)(E_{\\mathrm{exc}} - E_L)\n$$\nThis is a first-order linear ODE for $\\delta V(t)$. To analyze the small-signal gain, we linearize the system. The problem states we are considering small excitatory conductance perturbations $g_{\\mathrm{exc}}(t)$. This implies that the resulting voltage deflection $\\delta V(t)$ is also small. Consequently, the product term $g_{\\mathrm{exc}}(t)\\delta V$ is a product of two small quantities and can be neglected relative to terms linear in $\\delta V$, such as $g_L \\delta V$ and $g_{\\mathrm{inh}}(t) \\delta V$. The validity of this approximation hinges on the condition $g_{\\mathrm{exc}}(t) \\ll g_L + g_{\\mathrm{inh}}(t)$. With this linearization, the ODE becomes:\n$$\nC \\frac{d\\delta V}{dt} + \\left(g_L + g_{\\mathrm{inh}}(t)\\right)\\delta V \\approx g_{\\mathrm{exc}}(t)(E_{\\mathrm{exc}} - E_L)\n$$\nThis linearized equation describes how the voltage deflection $\\delta V$ is driven by the excitatory conductance $g_{\\mathrm{exc}}(t)$, modulated by the total effective conductance $g_L + g_{\\mathrm{inh}}(t)$.\n\nTo find the gain, we first consider the steady-state response where all conductances are constant. At steady state, $d\\delta V/dt = 0$, leading to:\n$$\n(g_L + g_{\\mathrm{inh}})\\delta V_{ss} \\approx g_{\\mathrm{exc}}(E_{\\mathrm{exc}} - E_L)\n$$\nThe steady-state voltage deflection is therefore:\n$$\n\\delta V_{ss} \\approx \\frac{E_{\\mathrm{exc}} - E_L}{g_L + g_{\\mathrm{inh}}} \\cdot g_{\\mathrm{exc}}\n$$\nThe small-signal gain, $K$, is the ratio of the output deflection to the input conductance perturbation, $K(g_{\\mathrm{inh}}) = \\delta V_{ss} / g_{\\mathrm{exc}}$:\n$$\nK(g_{\\mathrm{inh}}) \\approx \\frac{E_{\\mathrm{exc}} - E_L}{g_L + g_{\\mathrm{inh}}}\n$$\nThe effect of inhibition is quantified by comparing this gain to the baseline gain without inhibition ($g_{\\mathrm{inh}} = 0$):\n$$\nK(0) \\approx \\frac{E_{\\mathrm{exc}} - E_L}{g_L}\n$$\nThe divisive gain factor, which represents the change in gain due to inhibition, is the ratio $K(g_{\\mathrm{inh}}) / K(0)$:\n$$\nr_{\\mathrm{pred}} = \\frac{K(g_{\\mathrm{inh}})}{K(0)} = \\frac{(E_{\\mathrm{exc}} - E_L) / (g_L + g_{\\mathrm{inh}})}{(E_{\\mathrm{exc}} - E_L) / g_L} = \\frac{g_L}{g_L + g_{\\mathrm{inh}}}\n$$\nThis is our predicted divisive gain factor. It shows that the inhibitory conductance $g_{\\mathrm{inh}}$ divisively scales the neuron's gain to excitatory inputs.\n\nFor the time-varying case, where $g_{\\mathrm{inh}}(t)$ changes, we can employ a quasi-static approximation if the dynamics of $g_{\\mathrm{inh}}(t)$ are slow compared to the effective membrane time constant, $\\tau_{\\mathrm{eff}}(t) = C/(g_L + g_{\\mathrm{inh}}(t))$. The problem parameters satisfy this condition: the input frequency $f = 2\\,\\mathrm{Hz}$ ($T_{\\mathrm{input}} = 500\\,\\mathrm{ms}$) is much slower than $\\tau_{\\mathrm{eff}}$, which is on the order of $15\\,\\mathrm{ms}$. Under this approximation, the voltage $\\delta V(t)$ closely tracks the instantaneous steady-state value. The predicted instantaneous ratio of the deflection with inhibition to the baseline steady-state deflection is thus given by the same time-dependent formula:\n$$\nr_{\\mathrm{pred}}(t) = \\frac{g_L}{g_L + g_{\\mathrm{inh}}(t)}\n$$\n\n### Part 2: Numerical Validation Methodology\n\nTo validate these theoretical predictions, the original, non-linearized ODE is solved numerically using the explicit Euler method with a time step $\\Delta t$:\n$$\nV_{i+1} = V_i + \\frac{\\Delta t}{C} \\left[ -g_L(V_i - E_L) - g_{\\mathrm{exc}}(t_i)(V_i - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t_i)(V_i - E_{\\mathrm{inh}}) \\right]\n$$\nThe simulation starts from the resting state, $V(0) = E_L$.\n\nThe validation involves four tests:\n1.  **Baseline (No Inhibition):** A simulation is run with $g_{\\mathrm{inh}}(t) \\equiv 0$. The resulting steady-state deflection, $\\delta V_{\\mathrm{base}, ss}$, serves as the reference for other tests. The predicted ratio is $r_{\\mathrm{pred}} = g_L / (g_L + 0) = 1$, which is compared to the numerical ratio $r_{\\mathrm{num}} = \\delta V_{\\mathrm{base}, ss} / \\delta V_{\\mathrm{base}, ss} = 1$.\n2.  **Constant Shunting Inhibition:** With a constant $g_{\\mathrm{inh}} > 0$ and $E_{\\mathrm{inh}} = E_L$, the numerical ratio of steady-state deflections $r_{\\mathrm{num}} = \\delta V_{ss} / \\delta V_{\\mathrm{base}, ss}$ is compared against the predicted factor $r_{\\mathrm{pred}} = g_L / (g_L + g_{\\mathrm{inh}})$.\n3.  **Time-Varying Shunting Inhibition:** With a sinusoidal $g_{\\mathrm{inh}}(t)$ and $E_{\\mathrm{inh}} = E_L$, the time series of the numerical ratio $r_{\\mathrm{num}}(t) = (V(t) - E_L) / \\delta V_{\\mathrm{base}, ss}$ is compared to the predicted instantaneous ratio $r_{\\mathrm{pred}}(t) = g_L / (g_L + g_{\\mathrm{inh}}(t))$. The agreement is quantified by the Root-Mean-Square (RMS) error over an analysis window following an initial warm-up period.\n4.  **Non-Shunting Inhibition:** This case deliberately violates the shunting assumption by setting $E_{\\mathrm{inh}}  E_L$. The inhibitory current now has a hyperpolarizing component, $g_{\\mathrm{inh}}(V-E_{\\mathrm{inh}})$, which does not vanish at $V=E_L$. The steady-state numerical deflection ratio is compared against the prediction from the shunting model. A significant discrepancy is expected, demonstrating the limits of the shunting-based divisive gain model. The comparison is expected to fail the given tolerance.\n\nThe following Python code implements this validation procedure.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of validating the divisive effect of shunting inhibition\n    on neuronal gain, both analytically and through numerical simulation.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    C = 0.2          # Membrane capacitance (nF)\n    g_L = 10.0       # Leak conductance (nS)\n    E_L = -65.0      # Leak reversal potential (mV)\n    E_exc = 0.0      # Excitatory reversal potential (mV)\n    g_exc_val = 0.01 # Constant excitatory conductance (nS)\n    dt = 0.05        # Time step (ms)\n\n    def run_simulation(T, g_inh_func, E_inh_val):\n        \"\"\"\n        Numerically solves the membrane equation using the explicit Euler method.\n        \n        Args:\n            T (float): Total simulation time (ms).\n            g_inh_func (callable): A function of time t that returns g_inh(t) in nS.\n            E_inh_val (float): The inhibitory reversal potential (mV).\n\n        Returns:\n            tuple: A tuple containing:\n                - V_trace (np.ndarray): The time series of the membrane voltage (mV).\n                - t_trace (np.ndarray): The corresponding time points (ms).\n        \"\"\"\n        num_steps = int(T / dt)\n        t_trace = np.linspace(0, T, num_steps + 1)\n        V_trace = np.zeros(num_steps + 1)\n        V_trace[0] = E_L  # Initial condition\n\n        g_exc = g_exc_val # Constant excitatory conductance\n\n        V = E_L  # Initialize voltage\n        for i in range(num_steps):\n            t = t_trace[i]\n            g_inh = g_inh_func(t)\n            \n            # ODE: dV/dt = (1/C) * I_total\n            I_leak = -g_L * (V - E_L)\n            I_exc = -g_exc * (V - E_exc)\n            I_inh = -g_inh * (V - E_inh_val)\n            \n            dV_dt = (I_leak + I_exc + I_inh) / C\n            \n            # Euler update\n            V = V + dV_dt * dt\n            V_trace[i+1] = V\n            \n        return V_trace, t_trace\n\n    # --- Test Suite Definition ---\n    test_suite = [\n        {'case': 1, 'T': 300, 'g_inh_func': lambda t: 0.0, 'E_inh_val': E_L, 'tol': 1e-3, 'type': 'ss'},\n        {'case': 2, 'T': 300, 'g_inh_func': lambda t: 5.0, 'E_inh_val': E_L, 'tol': 1e-3, 'type': 'ss'},\n        {'case': 3, 'T': 2000, 'f': 0.002, 'g_inh_func': lambda t, f=0.002: 4.0 + 2.0 * np.sin(2 * np.pi * f * t), 'E_inh_val': E_L, 'tol': 0.03, 'type': 'rms', 'warmup': 300},\n        {'case': 4, 'T': 300, 'g_inh_func': lambda t: 5.0, 'E_inh_val': E_L - 3.0, 'tol': 1e-3, 'type': 'ss'},\n    ]\n\n    results = []\n\n    # --- Baseline Simulation (Case 1 setup) ---\n    base_params = test_suite[0]\n    V_base, _ = run_simulation(base_params['T'], base_params['g_inh_func'], base_params['E_inh_val'])\n    delta_V_base_ss = V_base[-1] - E_L\n\n    # --- Execute and Validate Test Cases ---\n    for params in test_suite:\n        V, t = run_simulation(params['T'], params['g_inh_func'], params['E_inh_val'])\n\n        if params['type'] == 'ss':\n            # Steady-state analysis for constant inhibition\n            delta_V_ss = V[-1] - E_L\n            r_num = delta_V_ss / delta_V_base_ss\n\n            g_inh_val = params['g_inh_func'](0)  # g_inh is constant\n            r_pred = g_L / (g_L + g_inh_val)\n            \n            error = np.abs(r_num - r_pred)\n            results.append(error  params['tol'])\n\n        elif params['type'] == 'rms':\n            # Time-varying analysis with RMS error\n            warmup_steps = int(params['warmup'] / dt)\n            \n            analysis_V = V[warmup_steps:]\n            analysis_t = t[warmup_steps:]\n            \n            delta_V_t = analysis_V - E_L\n            r_num_t = delta_V_t / delta_V_base_ss\n\n            g_inh_t = params['g_inh_func'](analysis_t)\n            r_pred_t = g_L / (g_L + g_inh_t)\n            \n            rms_error = np.sqrt(np.mean((r_num_t - r_pred_t)**2))\n            results.append(rms_error  params['tol'])\n\n    # Format the final output\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}