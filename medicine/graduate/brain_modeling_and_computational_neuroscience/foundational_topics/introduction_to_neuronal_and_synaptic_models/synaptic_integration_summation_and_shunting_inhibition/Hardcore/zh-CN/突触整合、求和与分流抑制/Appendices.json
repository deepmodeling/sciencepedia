{
    "hands_on_practices": [
        {
            "introduction": "神经元是否发放冲动是神经计算的核心问题。本练习旨在通过一个实际计算来量化解答这一问题：在持续的“分流抑制”背景下，需要多少个同步的兴奋性输入才能使神经元达到其发放阈值？通过运用稳态近似，该练习将复杂的动力学问题简化为一个代数问题，清晰地揭示了在冲动发放阈值处，兴奋性、泄露性和抑制性电流之间是如何相互抗衡的 。",
            "id": "4024800",
            "problem": "考虑一个在漏电积分-发放（LIF）模型框架内建模的单室电导驱动神经元。该神经元初始处于其静息电位，并在分路电导的背景下接收同步的兴奋性突触输入。假设以下生物物理特性和条件，这些都具有科学合理性，并且是接收平衡突触轰击的皮层锥体神经元的典型特征：\n\n- 静息电位为 $E_{\\mathrm{rest}} = -65\\ \\mathrm{mV}$。\n- 尖峰阈值为 $V_{\\mathrm{th}} = -50\\ \\mathrm{mV}$。\n- 漏电导为 $g_{L} = 10\\ \\mathrm{nS}$，膜电容为 $C = 200\\ \\mathrm{pF}$。\n- 胞体上存在背景分路电导，其值为 $g_{\\mathrm{bk}} = 90\\ \\mathrm{nS}$，反转电位为 $E_{\\mathrm{bk}} = E_{\\mathrm{rest}}$。\n- 每个兴奋性突触输入都是基于电导的，其峰值电导为 $g_{e} = 1\\ \\mathrm{nS}$，归一化门控变量 $s(t)$ 的峰值为 $s_{\\max} = 1$，反转电位为 $E_{e} = 0\\ \\mathrm{mV}$。所有输入都相同且同步到达。\n- 在输入期间，兴奋性门控变量 $s(t)$ 相对于有效膜时间常数变化缓慢，因此在群体峰值附近，膜电位可以被视为相对于瞬时电导配置处于准稳态。\n\n从基本的单室电流平衡以及电导和反转电位的定义出发，推导在背景分路电导存在的情况下，总的兴奋性突触后电位（EPSP）跨越尖峰阈值的条件。然后，使用所提供的数值，计算引发一次尖峰所需的最少同步兴奋性输入整数数量 $N$。将最终的输入数量以无单位的整数形式报告。如果需要任何中间数值计算，它们必须是精确的；最终答案无需四舍五入。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 静息电位：$E_{\\mathrm{rest}} = -65\\ \\mathrm{mV}$\n- 尖峰阈值：$V_{\\mathrm{th}} = -50\\ \\mathrm{mV}$\n- 漏电导：$g_{L} = 10\\ \\mathrm{nS}$\n- 膜电容：$C = 200\\ \\mathrm{pF}$\n- 背景分路电导：$g_{\\mathrm{bk}} = 90\\ \\mathrm{nS}$\n- 背景分路的反转电位：$E_{\\mathrm{bk}} = E_{\\mathrm{rest}}$\n- 每个兴奋性突触的峰值电导：$g_{e} = 1\\ \\mathrm{nS}$\n- 归一化门控变量的峰值：$s_{\\max} = 1$\n- 兴奋性突触的反转电位：$E_{e} = 0\\ \\mathrm{mV}$\n- 同步输入的假设。\n- 突触输入峰值附近膜电位处于准稳态的假设。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它基于标准的单室电导驱动神经元模型（漏电积分-发放），这是计算神经科学中的一个基本工具。所提供的生物物理参数对于皮层神经元是符合实际的。突触总和与分路抑制的概念是该学科的核心。问题是自洽的，包含了所有必要的数据和一个关键的简化假设（准稳态），使其可以通过代数方法求解。它没有任何矛盾、歧义和非科学性的主张。\n\n**步骤 3：结论与行动**\n问题有效。详细解答如下。\n\n单室模型中膜电位 $V$ 的动态由电流平衡方程描述：\n$$C \\frac{dV}{dt} = -I_{\\mathrm{ion}}$$\n其中 $C$ 是膜电容，$I_{\\mathrm{ion}}$ 是流过细胞膜的所有离子电流的总和。在本问题中，起作用的电流包括漏电流（$I_{L}$）、背景分路电流（$I_{\\mathrm{bk}}$）和总兴奋性突触电流（$I_{e}$）。\n$$I_{\\mathrm{ion}} = I_{L} + I_{\\mathrm{bk}} + I_{e}$$\n每种电流由其电导以及膜电位与其各自反转电位之间的差值定义：\n$$I_{L} = g_{L}(V - E_{\\mathrm{rest}})$$\n$$I_{\\mathrm{bk}} = g_{\\mathrm{bk}}(V - E_{\\mathrm{bk}})$$\n$$I_{e} = g_{\\mathrm{total\\_e}}(t)(V - E_{e})$$\n总兴奋性电导 $g_{\\mathrm{total\\_e}}(t)$ 是来自 $N$ 个相同、同步输入的电导之和。在其峰值处，门控变量 $s(t)$ 达到其最大值 $s_{\\max} = 1$，此时总兴奋性电导为：\n$$g_{\\mathrm{total\\_e, peak}} = N \\cdot g_{e} \\cdot s_{\\max} = N g_{e}$$\n问题指出，我们可以假设在同步输入的峰值附近膜电位处于准稳态。这意味着膜电位的变化率可以忽略不计，即 $\\frac{dV}{dt} \\approx 0$。因此，电流平衡方程简化为一个代数方程：\n$$I_{L} + I_{\\mathrm{bk}} + I_{e} = 0$$\n将兴奋性输入峰值时的电流表达式代入，我们得到：\n$$g_{L}(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + g_{\\mathrm{bk}}(V_{\\mathrm{peak}} - E_{\\mathrm{bk}}) + N g_{e}(V_{\\mathrm{peak}} - E_{e}) = 0$$\n其中 $V_{\\mathrm{peak}}$ 是达到的峰值膜电位。已知背景分路的反转电位等于静息电位，即 $E_{\\mathrm{bk}} = E_{\\mathrm{rest}}$。这使得方程可以简化：\n$$g_{L}(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + g_{\\mathrm{bk}}(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + N g_{e}(V_{\\mathrm{peak}} - E_{e}) = 0$$\n$$(g_{L} + g_{\\mathrm{bk}})(V_{\\mathrm{peak}} - E_{\\mathrm{rest}}) + N g_{e}(V_{\\mathrm{peak}} - E_{e}) = 0$$\n为了求出引发一次尖峰所需的最小输入数量 $N$，我们必须找到峰值膜电位 $V_{\\mathrm{peak}}$ 达到尖峰阈值 $V_{\\mathrm{th}}$ 的条件。我们令 $V_{\\mathrm{peak}} = V_{\\mathrm{th}}$ 并求解 $N$：\n$$(g_{L} + g_{\\mathrm{bk}})(V_{\\mathrm{th}} - E_{\\mathrm{rest}}) + N g_{e}(V_{\\mathrm{th}} - E_{e}) = 0$$\n整理方程以求解 $N$：\n$$N g_{e}(V_{\\mathrm{th}} - E_{e}) = -(g_{L} + g_{\\mathrm{bk}})(V_{\\mathrm{th}} - E_{\\mathrm{rest}})$$\n$$N g_{e}(V_{\\mathrm{th}} - E_{e}) = (g_{L} + g_{\\mathrm{bk}})(E_{\\mathrm{rest}} - V_{\\mathrm{th}})$$\n最终推导出的关于输入数量 $N$ 的条件是：\n$$N = \\frac{(g_{L} + g_{\\mathrm{bk}})(E_{\\mathrm{rest}} - V_{\\mathrm{th}})}{g_{e}(V_{\\mathrm{th}} - E_{e})}$$\n现在，我们将给定的数值代入这个表达式。单位（电导为nS，电位为mV）将会抵消，从而得到一个无量纲的数 $N$。\n给定值：\n$g_{L} = 10\\ \\mathrm{nS}$\n$g_{\\mathrm{bk}} = 90\\ \\mathrm{nS}$\n$g_{e} = 1\\ \\mathrm{nS}$\n$E_{\\mathrm{rest}} = -65\\ \\mathrm{mV}$\n$V_{\\mathrm{th}} = -50\\ \\mathrm{mV}$\n$E_{e} = 0\\ \\mathrm{mV}$\n\n首先，我们计算 $N$ 表达式中的各项：\n无源电导之和为 $g_{L} + g_{\\mathrm{bk}} = 10\\ \\mathrm{nS} + 90\\ \\mathrm{nS} = 100\\ \\mathrm{nS}$。\n从静息到阈值的电压差为 $E_{\\mathrm{rest}} - V_{\\mathrm{th}} = -65\\ \\mathrm{mV} - (-50\\ \\mathrm{mV}) = -15\\ \\mathrm{mV}$。\n在阈值处兴奋性电流的驱动力为 $V_{\\mathrm{th}} - E_{e} = -50\\ \\mathrm{mV} - 0\\ \\mathrm{mV} = -50\\ \\mathrm{mV}$。\n\n将这些值代入 $N$ 的方程中：\n$$N = \\frac{(100\\ \\mathrm{nS})(-15\\ \\mathrm{mV})}{(1\\ \\mathrm{nS})(-50\\ \\mathrm{mV})} = \\frac{-1500}{-50} = \\frac{150}{5} = 30$$\n计算得出一个整数值 $N = 30$。这表示在给定条件下，使膜电位达到尖峰阈值所需的精确同步输入数量。由于问题要求的是最小整数数量，而 $N=30$ 恰好满足条件 $V_{\\mathrm{peak}} = V_{\\mathrm{th}}$，因此这就是所求的答案。",
            "answer": "$$\\boxed{30}$$"
        },
        {
            "introduction": "在上一个练习的基础上，我们进一步探讨当多个突触输入在时间上重叠时会发生什么。简单地将各个突触后电位线性相加，往往会得到不准确的结果，因为膜电导的变化会产生非线性效应。本练习通过对比真实的膜电位响应与一个简化的线性预测模型，深刻揭示了突触整合的非线性本质，特别是分流抑制是如何通过增加膜电导来“分流”兴奋性电流，从而削弱其效果的 。",
            "id": "4024857",
            "problem": "考虑一个单室神经元，其由带有时间依赖性突触电导的被动膜方程描述，\n$$\nC \\frac{dV}{dt} \\;=\\; -\\,g_{L}\\,\\big(V - E_{L}\\big) \\;-\\; g_{e}(t)\\,\\big(V - E_{e}\\big) \\;-\\; g_{i}(t)\\,\\big(V - E_{i}\\big),\n$$\n其中 $C$ 是膜电容，$g_{L}$ 是漏电导，$E_{L}$ 是漏反转电位，$g_{e}(t)$ 是兴奋性突触电导，其反转电位为 $E_{e}$，而 $g_{i}(t)$ 是抑制性突触电导，其反转电位为 $E_{i}$。设神经元在 $t=0$ 时从静息状态开始，此时 $V(0)=E_{L}$。假设突触电导在其起始时间后呈指数衰减：\n$$\ng_{e}(t) \\;=\\; \\bar{g}_{e} \\,\\exp\\!\\left(-\\frac{t}{\\tau_{e}}\\right)\\,H(t), \\quad\ng_{i}(t) \\;=\\; \\bar{g}_{i} \\,\\exp\\!\\left(-\\frac{t-\\Delta}{\\tau_{i}}\\right)\\,H(t-\\Delta),\n$$\n其中 $\\bar{g}_{e}$ 和 $\\bar{g}_{i}$ 是峰值电导，$\\tau_{e}$ 和 $\\tau_{i}$ 是衰减时间常数，$\\Delta$ 是抑制性起始延迟，$H(\\cdot)$ 是亥维赛阶跃函数。\n\n在相对于膜时间常数的慢突触机制下进行分析，从而在突触衰减的时间尺度上，膜充电动态可以忽略不计，电压可以由每个时刻 $t$ 的瞬时电流平衡来近似。从被动膜方程出发，推导在这种准稳态近似下膜电位 $V(t)$ 的表达式，并使用以下参数计算其在 $t^{\\ast} = 6\\,\\text{ms}$ 时的值：\n$$\nC = 2\\,\\text{pF}, \\quad g_{L} = 10\\,\\text{nS}, \\quad E_{L} = -65\\,\\text{mV}, \\quad E_{e} = 0\\,\\text{mV}, \\quad E_{i} = -65\\,\\text{mV},\n$$\n$$\n\\bar{g}_{e} = 8\\,\\text{nS}, \\quad \\tau_{e} = 4\\,\\text{ms}, \\quad \\bar{g}_{i} = 40\\,\\text{nS}, \\quad \\tau_{i} = 8\\,\\text{ms}, \\quad \\Delta = 2\\,\\text{ms}.\n$$\n同时，构建一个线性预测，该预测假设驱动力固定为其静息值 $V_{\\mathrm{ref}} = E_{L}$，这意味着突触电流被处理为 $I_{\\mathrm{syn}}^{\\mathrm{lin}}(t) = g_{e}(t)\\,\\big(E_{e} - V_{\\mathrm{ref}}\\big) + g_{i}(t)\\,\\big(E_{i} - V_{\\mathrm{ref}}\\big)$，而不改变总膜电导，并使用相同的慢突触机制来获得 $t^{\\ast} = 6\\,\\text{ms}$ 时的 $V_{\\mathrm{lin}}(t)$。\n\n计算差值 $\\Delta V = V(t^{\\ast}) - V_{\\mathrm{lin}}(t^{\\ast})$。最终答案以毫伏为单位表示，并四舍五入到四位有效数字。如果需要，角度使用弧度制。",
            "solution": "问题陈述具有科学依据，提法得当且客观。它描述了一个标准的单室神经元模型，并要求比较完整的非线性电压响应和线性化近似，这是计算神经科学中的一种常见分析。所有必要的参数和条件都已提供。因此，该问题是有效的，并且可以推导出解。\n\n首先，我们推导在准稳态近似下膜电位 $V(t)$ 的表达式。膜电位的控制微分方程是\n$$\nC \\frac{dV}{dt} = -g_{L}\\big(V - E_{L}\\big) - g_{e}(t)\\big(V - E_{e}\\big) - g_{i}(t)\\big(V - E_{i}\\big)\n$$\n问题指定了慢突触机制，这允许我们采用准稳态近似，即膜电压瞬时平衡于突触输入。这等同于将电容电流设为零，$C \\frac{dV}{dt} \\approx 0$。该方程变为一个关于 $V$ 的代数方程：\n$$\n0 = -g_{L}\\big(V(t) - E_{L}\\big) - g_{e}(t)\\big(V(t) - E_{e}\\big) - g_{i}(t)\\big(V(t) - E_{i}\\big)\n$$\n我们可以重新整理这个方程来求解 $V(t)$：\n$$\nV(t) \\big( g_{L} + g_{e}(t) + g_{i}(t) \\big) = g_{L}E_{L} + g_{e}(t)E_{e} + g_{i}(t)E_{i}\n$$\n因此，任何时刻 $t$ 的膜电位是反转电位的加权平均值，其中权重是各自的电导：\n$$\nV(t) = \\frac{g_{L}E_{L} + g_{e}(t)E_{e} + g_{i}(t)E_{i}}{g_{L} + g_{e}(t) + g_{i}(t)}\n$$\n我们需要计算这个表达式在 $t^{\\ast} = 6\\,\\text{ms}$ 时的值。首先，我们计算突触电导 $g_e(t^{\\ast})$ 和 $g_i(t^{\\ast})$。\n兴奋性电导为 $g_{e}(t) = \\bar{g}_{e} \\exp(-t/\\tau_{e})H(t)$。在 $t^{\\ast} = 6\\,\\text{ms}$ 时，由于 $t^{\\ast} > 0$，因此 $H(t^{\\ast})=1$。\n$$\ng_{e}(t^{\\ast}) = (8\\,\\text{nS}) \\exp\\left(-\\frac{6\\,\\text{ms}}{4\\,\\text{ms}}\\right) = 8 \\exp(-1.5)\\,\\text{nS}\n$$\n抑制性电导为 $g_{i}(t) = \\bar{g}_{i} \\exp(-(t-\\Delta)/\\tau_{i})H(t-\\Delta)$。在 $t^{\\ast} = 6\\,\\text{ms}$ 且 $\\Delta = 2\\,\\text{ms}$ 时，我们有 $t^{\\ast}-\\Delta = 4\\,\\text{ms} > 0$，所以 $H(t^{\\ast}-\\Delta)=1$。\n$$\ng_{i}(t^{\\ast}) = (40\\,\\text{nS}) \\exp\\left(-\\frac{6\\,\\text{ms} - 2\\,\\text{ms}}{8\\,\\text{ms}}\\right) = 40 \\exp\\left(-\\frac{4}{8}\\right) = 40 \\exp(-0.5)\\,\\text{nS}\n$$\n现在我们将这些电导和给定参数代入 $V(t^{\\ast})$ 的表达式中：$g_{L} = 10\\,\\text{nS}$，$E_{L} = -65\\,\\text{mV}$，$E_{e} = 0\\,\\text{mV}$，以及 $E_{i} = -65\\,\\text{mV}$。\n$$\nV(t^{\\ast}) = \\frac{(10\\,\\text{nS})(-65\\,\\text{mV}) + (8 \\exp(-1.5)\\,\\text{nS})(0\\,\\text{mV}) + (40 \\exp(-0.5)\\,\\text{nS})(-65\\,\\text{mV})}{10\\,\\text{nS} + 8 \\exp(-1.5)\\,\\text{nS} + 40 \\exp(-0.5)\\,\\text{nS}}\n$$\n$$\nV(t^{\\ast}) = \\frac{-65 \\left( 10 + 40 \\exp(-0.5) \\right)}{10 + 8 \\exp(-1.5) + 40 \\exp(-0.5)}\\,\\text{mV}\n$$\n数值上，$e^{-1.5} \\approx 0.223130$ 且 $e^{-0.5} \\approx 0.606531$。\n$g_e(t^{\\ast}) \\approx 8 \\times 0.223130 = 1.78504\\,\\text{nS}$。\n$g_i(t^{\\ast}) \\approx 40 \\times 0.606531 = 24.2612\\,\\text{nS}$。\n$$\nV(t^{\\ast}) \\approx \\frac{-65 (10 + 24.2612)}{10 + 1.78504 + 24.2612} = \\frac{-65 \\times 34.2612}{36.04624} \\approx -61.7816\\,\\text{mV}\n$$\n\n接下来，我们构建线性预测 $V_{\\mathrm{lin}}(t)$。问题陈述，突触输入被视为电流源 $I_{\\mathrm{syn}}^{\\mathrm{lin}}(t) = g_{e}(t)(E_{e} - V_{\\mathrm{ref}}) + g_{i}(t)(E_{i} - V_{\\mathrm{ref}})$，其中 $V_{\\mathrm{ref}} = E_L$，并且总膜电导不变，即保持为 $g_L$。线性模型的有效膜方程为：\n$$\nC \\frac{dV_{\\mathrm{lin}}}{dt} = -g_{L}(V_{\\mathrm{lin}} - E_{L}) + g_{e}(t)(E_{e} - E_{L}) + g_{i}(t)(E_{i} - E_{L})\n$$\n应用相同的准稳态近似（$C \\frac{dV_{\\mathrm{lin}}}{dt} \\approx 0$）：\n$$\n0 = -g_{L}(V_{\\mathrm{lin}}(t) - E_{L}) + g_{e}(t)(E_{e} - E_{L}) + g_{i}(t)(E_{i} - E_{L})\n$$\n求解 $V_{\\mathrm{lin}}(t)$：\n$$\ng_{L}V_{\\mathrm{lin}}(t) = g_{L}E_{L} + g_{e}(t)(E_{e} - E_{L}) + g_{i}(t)(E_{i} - E_{L})\n$$\n$$\nV_{\\mathrm{lin}}(t) = E_{L} + \\frac{g_{e}(t)}{g_{L}}(E_{e} - E_{L}) + \\frac{g_{i}(t)}{g_{L}}(E_{i} - E_{L})\n$$\n我们在 $t^{\\ast} = 6\\,\\text{ms}$ 时计算该值。我们有 $E_{e} - E_{L} = 0\\,\\text{mV} - (-65\\,\\text{mV}) = 65\\,\\text{mV}$，以及 $E_{i} - E_{L} = -65\\,\\text{mV} - (-65\\,\\text{mV}) = 0\\,\\text{mV}$。涉及抑制性电导的项消失了。\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) = E_{L} + \\frac{g_{e}(t^{\\ast})}{g_{L}}(E_{e} - E_{L})\n$$\n代入数值：\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) = -65\\,\\text{mV} + \\frac{8 \\exp(-1.5)\\,\\text{nS}}{10\\,\\text{nS}}(65\\,\\text{mV})\n$$\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) = -65 + \\frac{8 \\times 65}{10} \\exp(-1.5) = -65 + 52 \\exp(-1.5)\\,\\text{mV}\n$$\n数值计算：\n$$\nV_{\\mathrm{lin}}(t^{\\ast}) \\approx -65 + 52 \\times 0.223130 = -65 + 11.60276 = -53.39724\\,\\text{mV}\n$$\n最后，我们计算差值 $\\Delta V = V(t^{\\ast}) - V_{\\mathrm{lin}}(t^{\\ast})$：\n$$\n\\Delta V \\approx -61.7816\\,\\text{mV} - (-53.39724\\,\\text{mV}) = -8.38436\\,\\text{mV}\n$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\n\\Delta V \\approx -8.384\\,\\text{mV}\n$$\n负号表示实际电压（$V$）比线性化预测（$V_{\\mathrm{lin}}$）更超极化。这是分流抑制的标志：抑制性电导 $g_i(t)$ 虽然其反转电位 $E_i$ 等于静息电位 $E_L$，但它增加了总膜电导，从而减小了兴奋性电流的去极化效应。线性模型未能捕捉到这种分流效应，因为抑制性电流项变为零，导致对膜电位的高估。",
            "answer": "$$\\boxed{-8.384}$$"
        },
        {
            "introduction": "现在，让我们从理论计算走向计算建模。分流抑制在计算神经科学中常被描述为一种“除法式增益控制”（divisive gain control）机制，它能调节神经元对输入的响应强度。本练习将这一抽象概念具体化：首先，你将从第一性原理出发，推导出分流抑制对神经元增益的数学表达式；然后，你将通过编写代码进行数值模拟，来验证你的理论预测，从而架起连接解析理论与计算实践的桥梁 。",
            "id": "4024781",
            "problem": "考虑一个接收突触输入的单室电导点神经元。膜电压 $V(t)$ 的演化遵循以下电流平衡常微分方程 (ODE)：\n$$\nC \\frac{dV}{dt} \\;=\\; -\\,g_L\\,\\big(V - E_L\\big)\\;-\\;g_{\\mathrm{exc}}(t)\\,\\big(V - E_{\\mathrm{exc}}\\big)\\;-\\;g_{\\mathrm{inh}}(t)\\,\\big(V - E_{\\mathrm{inh}}\\big),\n$$\n其中 $C$ 是膜电容，$g_L$ 是漏电导（其反转电位为 $E_L$），$g_{\\mathrm{exc}}(t)$ 是兴奋性突触电导（其反转电位为 $E_{\\mathrm{exc}}$），$g_{\\mathrm{inh}}(t)$ 是抑制性突触电导（其反转电位为 $E_{\\mathrm{inh}}$）。在分流抑制 (shunting inhibition) 模式下，$E_{\\mathrm{inh}} \\approx E_L$，抑制性电流主要通过增加有效膜电导起作用，而不会显著改变静息电位附近的驱动力。您的任务是，从第一性原理出发，不使用任何简便公式，推导当系统在 $V \\approx E_L$ 附近线性化时，分流抑制如何改变从兴奋性电导到电压偏转的小信号增益。然后，使用指定的测试套件，通过对该 ODE 进行数值模拟来验证所推导的增益变化。\n\n推导要求：\n- 从上述 ODE 出发，定义电压偏转 $\\delta V(t) = V(t) - E_L$。\n- 在 $E_{\\mathrm{inh}} = E_L$ 的假设下，针对小的兴奋性电导扰动 $g_{\\mathrm{exc}}(t)$，在 $V \\approx E_L$ 附近进行有理有据的线性化，并得出一个表达式，说明从 $g_{\\mathrm{exc}}(t)$ 到 $\\delta V(t)$ 的有效增益是如何被 $g_{\\mathrm{inh}}(t)$ 调制的。\n- 清晰地说明所有近似及其有效性条件（用电导和时间尺度的相对大小表示）。\n\n模拟与验证要求：\n- 使用固定时间步长 $\\Delta t$ 和显式更新方法，为该 ODE 实现一个数值求解器。单位必须统一使用如下：电压单位为 $\\mathrm{mV}$，电导单位为 $\\mathrm{nS}$，电容单位为 $\\mathrm{nF}$，时间单位为 $\\mathrm{ms}$。请注意，使用这些单位时，$\\mathrm{nS}/\\mathrm{nF}$ 的量纲为 $1/\\mathrm{ms}$，因此该 ODE 在量纲上是一致的。\n- 使用推导出的表达式计算作为 $g_{\\mathrm{inh}}(t)$ 函数的预测除法增益因子，并将其与从模拟中测得的增益进行比较。对于恒定电导，使用稳态偏转。对于随时间变化的 $g_{\\mathrm{inh}}(t)$，在初始预热期后，使用均方根 (RMS) 误差指标比较瞬时比率。\n\n测试套件：\n- 除非另有说明，所有测试均使用以下固定参数：$C = 0.2\\,\\mathrm{nF}$，$g_L = 10\\,\\mathrm{nS}$，$E_L = -65\\,\\mathrm{mV}$，$E_{\\mathrm{exc}} = 0\\,\\mathrm{mV}$，$\\Delta t = 0.05\\,\\mathrm{ms}$。为保持在小信号范围内，所有测试中的兴奋性电导均保持在一个小恒定值 $g_{\\mathrm{exc}}(t) \\equiv 0.01\\,\\mathrm{nS}$。\n- 定义四个测试用例：\n    1. 恒定无抑制：$g_{\\mathrm{inh}}(t) \\equiv 0\\,\\mathrm{nS}$，$E_{\\mathrm{inh}} = E_L$，模拟时长 $T = 300\\,\\mathrm{ms}$。计算有抑制时的 $\\delta V$ 与无抑制基线值的稳态比率 $r_{\\mathrm{num}}$，并与预测因子进行比较，容差为 $\\varepsilon_1 = 10^{-3}$（绝对差）。\n    2. 恒定分流：$g_{\\mathrm{inh}}(t) \\equiv 5\\,\\mathrm{nS}$，$E_{\\mathrm{inh}} = E_L$，模拟时长 $T = 300\\,\\mathrm{ms}$。计算稳态时的 $r_{\\mathrm{num}}$，并与预测因子进行比较，容差为 $\\varepsilon_1 = 10^{-3}$。\n    3. 时变分流：$g_{\\mathrm{inh}}(t) = 4 + 2\\sin\\!\\big(2\\pi f t\\big)\\,\\mathrm{nS}$，其中 $f = 0.002\\,\\mathrm{cycles/ms}$（即 $2\\,\\mathrm{Hz}$），$E_{\\mathrm{inh}} = E_L$，模拟时长 $T = 2000\\,\\mathrm{ms}$。在 $300\\,\\mathrm{ms}$ 的预热期后，计算每个时间点的瞬时比率 $r_{\\mathrm{num}}(t)$ 和预测因子，然后计算分析窗口内的 RMS 误差。使用容差 $\\varepsilon_2 = 0.03$（绝对 RMS 误差）。\n    4. 恒定非分流抑制（边界情况）：$g_{\\mathrm{inh}}(t) \\equiv 5\\,\\mathrm{nS}$，但 $E_{\\mathrm{inh}} = E_L - 3\\,\\mathrm{mV}$，模拟时长 $T = 300\\,\\mathrm{ms}$。计算稳态比率 $r_{\\mathrm{num}}$，并与在分流假设下推导的相同预测因子进行比较，容差为 $\\varepsilon_1 = 10^{-3}$。此测试旨在探究 $E_{\\mathrm{inh}} \\approx E_L$ 假设的边界条件，通常不会满足容差要求。\n\n答案规范：\n- 对于恒定电导的测试，使用模拟结束时的稳态值。\n- 对于时变电导的测试，使用预热期之后区间的 RMS 误差。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的布尔值列表（例如，`[True,False,True,True]`），按上述顺序指示每个测试是否满足其各自的容差标准。",
            "solution": "目标是推导分流抑制对单室神经元模型输入-输出增益的影响，并通过数值模拟验证该推导。分析分两个阶段进行：首先，从控制常微分方程 (ODE) 出发进行有理有据的解析推导；其次，通过数值实现来针对特定情况检验推导出的公式。\n\n### 第一部分：解析推导\n\n膜电压 $V(t)$ 的动力学由电流平衡方程决定：\n$$\nC \\frac{dV}{dt} = -g_L(V - E_L) - g_{\\mathrm{exc}}(t)(V - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t)(V - E_{\\mathrm{inh}})\n$$\n其中 $C$ 是电容，$E_L$、$E_{\\mathrm{exc}}$、$E_{\\mathrm{inh}}$ 是反转电位，$g_L$、$g_{\\mathrm{exc}}(t)$、$g_{\\mathrm{inh}}(t)$ 分别是漏电导、兴奋性电导和抑制性电导。\n\n我们关心的是相对于漏电反转电位 $E_L$ 的电压偏转 $\\delta V(t)$，定义为 $\\delta V(t) = V(t) - E_L$。将 $V(t) = \\delta V(t) + E_L$ 代入 ODE，并注意到 $dE_L/dt = 0$，我们得到：\n$$\nC \\frac{d\\delta V}{dt} = -g_L \\delta V - g_{\\mathrm{exc}}(t)(\\delta V + E_L - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t)(\\delta V + E_L - E_{\\mathrm{inh}})\n$$\n问题指定了分流抑制模式，其数学模型为近似 $E_{\\mathrm{inh}} \\approx E_L$。令 $E_{\\mathrm{inh}} = E_L$ 可简化最后一项：\n$$\nC \\frac{d\\delta V}{dt} = -g_L \\delta V - g_{\\mathrm{exc}}(t)(\\delta V + E_L - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t) \\delta V\n$$\n我们可以通过分离与 $\\delta V$ 成正比的项和驱动项来重新整理方程：\n$$\nC \\frac{d\\delta V}{dt} = -\\left(g_L + g_{\\mathrm{exc}}(t) + g_{\\mathrm{inh}}(t)\\right)\\delta V - g_{\\mathrm{exc}}(t)(E_L - E_{\\mathrm{exc}})\n$$\n$$\nC \\frac{d\\delta V}{dt} + \\left(g_L + g_{\\mathrm{exc}}(t) + g_{\\mathrm{inh}}(t)\\right)\\delta V = g_{\\mathrm{exc}}(t)(E_{\\mathrm{exc}} - E_L)\n$$\n这是一个关于 $\\delta V(t)$ 的一阶线性 ODE。为了分析小信号增益，我们对系统进行线性化。问题陈述中提到我们考虑的是小的兴奋性电导扰动 $g_{\\mathrm{exc}}(t)$。这意味着由此产生的电压偏转 $\\delta V(t)$ 也很小。因此，乘积项 $g_{\\mathrm{exc}}(t)\\delta V$ 是两个小量的乘积，相对于 $\\delta V$ 的线性项（如 $g_L \\delta V$ 和 $g_{\\mathrm{inh}}(t) \\delta V$）可以忽略不计。此近似的有效性取决于条件 $g_{\\mathrm{exc}}(t) \\ll g_L + g_{\\mathrm{inh}}(t)$。经过此线性化，ODE 变为：\n$$\nC \\frac{d\\delta V}{dt} + \\left(g_L + g_{\\mathrm{inh}}(t)\\right)\\delta V \\approx g_{\\mathrm{exc}}(t)(E_{\\mathrm{exc}} - E_L)\n$$\n这个线性化方程描述了电压偏转 $\\delta V$ 如何被兴奋性电导 $g_{\\mathrm{exc}}(t)$ 驱动，并受到总有效电导 $g_L + g_{\\mathrm{inh}}(t)$ 的调制。\n\n为了求出增益，我们首先考虑所有电导都恒定时的稳态响应。在稳态下，$d\\delta V/dt = 0$，可得：\n$$\n(g_L + g_{\\mathrm{inh}})\\delta V_{ss} \\approx g_{\\mathrm{exc}}(E_{\\mathrm{exc}} - E_L)\n$$\n因此，稳态电压偏转为：\n$$\n\\delta V_{ss} \\approx \\frac{E_{\\mathrm{exc}} - E_L}{g_L + g_{\\mathrm{inh}}} \\cdot g_{\\mathrm{exc}}\n$$\n小信号增益 $K$ 是输出偏转与输入电导扰动之比，$K(g_{\\mathrm{inh}}) = \\delta V_{ss} / g_{\\mathrm{exc}}$：\n$$\nK(g_{\\mathrm{inh}}) \\approx \\frac{E_{\\mathrm{exc}} - E_L}{g_L + g_{\\mathrm{inh}}}\n$$\n抑制效应通过将此增益与无抑制时的基线增益（$g_{\\mathrm{inh}} = 0$）进行比较来量化：\n$$\nK(0) \\approx \\frac{E_{\\mathrm{exc}} - E_L}{g_L}\n$$\n除法增益因子代表了由抑制引起的增益变化，是比率 $K(g_{\\mathrm{inh}}) / K(0)$：\n$$\nr_{\\mathrm{pred}} = \\frac{K(g_{\\mathrm{inh}})}{K(0)} = \\frac{(E_{\\mathrm{exc}} - E_L) / (g_L + g_{\\mathrm{inh}})}{(E_{\\mathrm{exc}} - E_L) / g_L} = \\frac{g_L}{g_L + g_{\\mathrm{inh}}}\n$$\n这就是我们预测的除法增益因子。它表明抑制性电导 $g_{\\mathrm{inh}}$ 对神经元之于兴奋性输入的增益进行除法缩放。\n\n对于时变情况，即 $g_{\\mathrm{inh}}(t)$ 发生变化时，如果 $g_{\\mathrm{inh}}(t)$ 的动力学相对于有效膜时间常数 $\\tau_{\\mathrm{eff}}(t) = C/(g_L + g_{\\mathrm{inh}}(t))$ 较慢，我们可以采用准静态近似。问题参数满足此条件：输入频率 $f = 2\\,\\mathrm{Hz}$（$T_{\\mathrm{input}} = 500\\,\\mathrm{ms}$）远慢于约为 $15\\,\\mathrm{ms}$ 的 $\\tau_{\\mathrm{eff}}$。在此近似下，电压 $\\delta V(t)$ 会紧密跟踪瞬时稳态值。因此，有抑制时的电压偏转与基线稳态偏转的预测瞬时比率由相同的时变公式给出：\n$$\nr_{\\mathrm{pred}}(t) = \\frac{g_L}{g_L + g_{\\mathrm{inh}}(t)}\n$$\n\n### 第二部分：数值验证方法\n\n为验证这些理论预测，我们使用显式欧拉法和时间步长 $\\Delta t$ 对原始的非线性化 ODE 进行数值求解：\n$$\nV_{i+1} = V_i + \\frac{\\Delta t}{C} \\left[ -g_L(V_i - E_L) - g_{\\mathrm{exc}}(t_i)(V_i - E_{\\mathrm{exc}}) - g_{\\mathrm{inh}}(t_i)(V_i - E_{\\mathrm{inh}}) \\right]\n$$\n模拟从静息态 $V(0) = E_L$ 开始。\n\n验证包括四个测试：\n1.  **基线（无抑制）：** 运行一个 $g_{\\mathrm{inh}}(t) \\equiv 0$ 的模拟。得到的稳态偏转 $\\delta V_{\\mathrm{base}, ss}$ 作为其他测试的参考。预测比率为 $r_{\\mathrm{pred}} = g_L / (g_L + 0) = 1$，与数值比率 $r_{\\mathrm{num}} = \\delta V_{\\mathrm{base}, ss} / \\delta V_{\\mathrm{base}, ss} = 1$ 进行比较。\n2.  **恒定分流抑制：** 在恒定 $g_{\\mathrm{inh}} > 0$ 和 $E_{\\mathrm{inh}} = E_L$ 的条件下，将稳态偏转的数值比率 $r_{\\mathrm{num}} = \\delta V_{ss} / \\delta V_{\\mathrm{base}, ss}$ 与预测因子 $r_{\\mathrm{pred}} = g_L / (g_L + g_{\\mathrm{inh}})$ 进行比较。\n3.  **时变分流抑制：** 在正弦变化的 $g_{\\mathrm{inh}}(t)$ 和 $E_{\\mathrm{inh}} = E_L$ 的条件下，将数值比率的时间序列 $r_{\\mathrm{num}}(t) = (V(t) - E_L) / \\delta V_{\\mathrm{base}, ss}$ 与预测的瞬时比率 $r_{\\mathrm{pred}}(t) = g_L / (g_L + g_{\\mathrm{inh}}(t))$ 进行比较。其一致性通过在初始预热期后的分析窗口上计算均方根 (RMS) 误差来量化。\n4.  **非分流抑制：** 该情况通过设置 $E_{\\mathrm{inh}} \\neq E_L$ 故意违反了分流假设。此时，抑制性电流具有一个超极化分量 $g_{\\mathrm{inh}}(V-E_{\\mathrm{inh}})$，该分量在 $V=E_L$ 时不为零。将稳态数值偏转比率与基于分流模型得出的预测进行比较。预计会出现显著差异，这揭示了基于分流的除法增益模型的局限性。预计此比较不会满足给定的容差。\n\n以下 Python 代码实现了此验证过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of validating the divisive effect of shunting inhibition\n    on neuronal gain, both analytically and through numerical simulation.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    C = 0.2          # Membrane capacitance (nF)\n    g_L = 10.0       # Leak conductance (nS)\n    E_L = -65.0      # Leak reversal potential (mV)\n    E_exc = 0.0      # Excitatory reversal potential (mV)\n    g_exc_val = 0.01 # Constant excitatory conductance (nS)\n    dt = 0.05        # Time step (ms)\n\n    def run_simulation(T, g_inh_func, E_inh_val):\n        \"\"\"\n        Numerically solves the membrane equation using the explicit Euler method.\n        \n        Args:\n            T (float): Total simulation time (ms).\n            g_inh_func (callable): A function of time t that returns g_inh(t) in nS.\n            E_inh_val (float): The inhibitory reversal potential (mV).\n\n        Returns:\n            tuple: A tuple containing:\n                - V_trace (np.ndarray): The time series of the membrane voltage (mV).\n                - t_trace (np.ndarray): The corresponding time points (ms).\n        \"\"\"\n        num_steps = int(T / dt)\n        t_trace = np.linspace(0, T, num_steps + 1)\n        V_trace = np.zeros(num_steps + 1)\n        V_trace[0] = E_L  # Initial condition\n\n        g_exc = g_exc_val # Constant excitatory conductance\n\n        V = E_L  # Initialize voltage\n        for i in range(num_steps):\n            t = t_trace[i]\n            g_inh = g_inh_func(t)\n            \n            # ODE: dV/dt = (1/C) * I_total\n            I_leak = -g_L * (V - E_L)\n            I_exc = -g_exc * (V - E_exc)\n            I_inh = -g_inh * (V - E_inh_val)\n            \n            dV_dt = (I_leak + I_exc + I_inh) / C\n            \n            # Euler update\n            V = V + dV_dt * dt\n            V_trace[i+1] = V\n            \n        return V_trace, t_trace\n\n    # --- Test Suite Definition ---\n    test_suite = [\n        {'case': 1, 'T': 300, 'g_inh_func': lambda t: 0.0, 'E_inh_val': E_L, 'tol': 1e-3, 'type': 'ss'},\n        {'case': 2, 'T': 300, 'g_inh_func': lambda t: 5.0, 'E_inh_val': E_L, 'tol': 1e-3, 'type': 'ss'},\n        {'case': 3, 'T': 2000, 'f': 0.002, 'g_inh_func': lambda t, f=0.002: 4.0 + 2.0 * np.sin(2 * np.pi * f * t), 'E_inh_val': E_L, 'tol': 0.03, 'type': 'rms', 'warmup': 300},\n        {'case': 4, 'T': 300, 'g_inh_func': lambda t: 5.0, 'E_inh_val': E_L - 3.0, 'tol': 1e-3, 'type': 'ss'},\n    ]\n\n    results = []\n\n    # --- Baseline Simulation (Case 1 setup) ---\n    base_params = test_suite[0]\n    V_base, _ = run_simulation(base_params['T'], base_params['g_inh_func'], base_params['E_inh_val'])\n    delta_V_base_ss = V_base[-1] - E_L\n\n    # --- Execute and Validate Test Cases ---\n    for params in test_suite:\n        V, t = run_simulation(params['T'], params['g_inh_func'], params['E_inh_val'])\n\n        if params['type'] == 'ss':\n            # Steady-state analysis for constant inhibition\n            delta_V_ss = V[-1] - E_L\n            r_num = delta_V_ss / delta_V_base_ss\n\n            g_inh_val = params['g_inh_func'](0)  # g_inh is constant\n            r_pred = g_L / (g_L + g_inh_val)\n            \n            error = np.abs(r_num - r_pred)\n            results.append(error  params['tol'])\n\n        elif params['type'] == 'rms':\n            # Time-varying analysis with RMS error\n            warmup_steps = int(params['warmup'] / dt)\n            \n            analysis_V = V[warmup_steps:]\n            analysis_t = t[warmup_steps:]\n            \n            delta_V_t = analysis_V - E_L\n            r_num_t = delta_V_t / delta_V_base_ss\n\n            g_inh_t = params['g_inh_func'](analysis_t)\n            r_pred_t = g_L / (g_L + g_inh_t)\n            \n            rms_error = np.sqrt(np.mean((r_num_t - r_pred_t)**2))\n            results.append(rms_error  params['tol'])\n\n    # Format the final output\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}