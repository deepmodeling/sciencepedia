{
    "hands_on_practices": [
        {
            "introduction": "能斯特电位是理解离子如何跨膜移动的基础，它定义了单个离子在纯粹由浓度梯度和电场力驱动下所达到的平衡电位。本练习  将引导您从基本原理出发，推导并计算钙离子（$\\mathrm{Ca}^{2+}$）的能斯特电位。钙离子是神经递质释放和细胞内信号传导的关键，其巨大的浓度梯度使其平衡电位呈现高度去极化的状态，理解这一点对于掌握神经元功能至关重要。",
            "id": "3978026",
            "problem": "一个神经元浸泡在细胞外溶液中，其钙离子浓度为 $[\\mathrm{Ca}]_o = 2\\,\\mathrm{mM}$，并维持细胞内游离钙离子浓度为 $[\\mathrm{Ca}]_i = 100\\,\\mathrm{nM}$。假设细胞膜对 $\\mathrm{Ca}^{2+}$ 具有选择性通透性，并且溶液是理想稀溶液，因此活度等于浓度。从平衡时跨膜电化学势相等出发，利用理想溶液中溶质的化学势以及带电粒子在电场中的静电能，推导钙的平衡膜电位（记为 $E_{\\mathrm{Ca}}$ 的钙的能斯特电位），符号约定为 $E_{\\mathrm{Ca}} = \\phi_i - \\phi_o$，其中 $\\phi_i$ 和 $\\phi_o$ 分别是细胞内和细胞外电位。取钙的化合价为 $z_{\\mathrm{Ca}} = +2$，普适气体常数为 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，法拉第常数（每摩尔基本电荷的电荷量大小）为 $F = 96485\\,\\mathrm{C\\,mol^{-1}}$，绝对温度为 $T = 310\\,\\mathrm{K}$。\n\n计算给定浓度和常数下 $E_{\\mathrm{Ca}}$ 的数值。最终数值答案以毫伏表示，并四舍五入至四位有效数字。\n\n最后，根据你推导的表达式，定性讨论为什么巨大的细胞外-细胞内钙离子梯度使得 $E_{\\mathrm{Ca}}$ 在神经元建模中高度去极化。",
            "solution": "该问题是有效的，因为它具有科学依据、提法恰当、客观，并包含完整推导和计算所需的所有必要信息。它代表了电生理学中一个标准且基础的问题。\n\n离子种类 $j$ 的电化学势 $\\tilde{\\mu}_j$ 是其化学势 $\\mu_j$ 与其电荷在电场中的势能之和。表达式为：\n$$\n\\tilde{\\mu}_j = \\mu_j + z_j F \\phi\n$$\n其中 $z_j$ 是离子的化合价， $F$ 是法拉第常数（每摩尔基本电荷的电荷量），$\\phi$ 是局部电位。对于理想稀溶液中的溶质，其化学势由下式给出：\n$$\n\\mu_j = \\mu_j^0 + RT \\ln([j])\n$$\n这里，$\\mu_j^0$ 是标准化学势，$R$ 是普适气体常数，$T$ 是绝对温度，$[j]$ 是该物质的摩尔浓度。结合这两个表达式，离子 $j$ 的电化学势为：\n$$\n\\tilde{\\mu}_j = \\mu_j^0 + RT \\ln([j]) + z_j F \\phi\n$$\n在平衡状态下，离子没有跨膜的净通量。当离子在细胞内和细胞外两个隔室中的电化学势相等时，此条件即得到满足。对于钙离子 $\\mathrm{Ca}^{2+}$，我们令细胞内电化学势 $\\tilde{\\mu}_{\\mathrm{Ca}, i}$ 等于细胞外电化学势 $\\tilde{\\mu}_{\\mathrm{Ca}, o}$：\n$$\n\\tilde{\\mu}_{\\mathrm{Ca}, i} = \\tilde{\\mu}_{\\mathrm{Ca}, o}\n$$\n将电化学势的完整表达式代入等式两边得到：\n$$\n\\mu_{\\mathrm{Ca}}^0 + RT \\ln([\\mathrm{Ca}]_i) + z_{\\mathrm{Ca}} F \\phi_i = \\mu_{\\mathrm{Ca}}^0 + RT \\ln([\\mathrm{Ca}]_o) + z_{\\mathrm{Ca}} F \\phi_o\n$$\n标准化学势 $\\mu_{\\mathrm{Ca}}^0$ 是离子和溶剂的内禀属性，在等式两边是相同的，因此可以消去。重排剩余项，将电位项和浓度项归类，得到：\n$$\nz_{\\mathrm{Ca}} F \\phi_i - z_{\\mathrm{Ca}} F \\phi_o = RT \\ln([\\mathrm{Ca}]_o) - RT \\ln([\\mathrm{Ca}]_i)\n$$\n提取公因式：\n$$\nz_{\\mathrm{Ca}} F (\\phi_i - \\phi_o) = RT \\ln\\left(\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i}\\right)\n$$\n钙的平衡膜电位 $E_{\\mathrm{Ca}}$ 定义为跨膜电位差，$E_{\\mathrm{Ca}} = \\phi_i - \\phi_o$。解出此量，得到钙的能斯特电位：\n$$\nE_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\left(\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i}\\right)\n$$\n至此，按要求完成了推导。\n\n接下来，我们使用给定的常数和浓度计算 $E_{\\mathrm{Ca}}$ 的数值。\n给定值为：\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 310\\,\\mathrm{K}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n$z_{\\mathrm{Ca}} = +2$\n$[\\mathrm{Ca}]_o = 2\\,\\mathrm{mM} = 2 \\times 10^{-3}\\,\\mathrm{M}$\n$[\\mathrm{Ca}]_i = 100\\,\\mathrm{nM} = 100 \\times 10^{-9}\\,\\mathrm{M} = 1 \\times 10^{-7}\\,\\mathrm{M}$\n\n首先，我们计算细胞外与细胞内浓度的比值：\n$$\n\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i} = \\frac{2 \\times 10^{-3}\\,\\mathrm{M}}{1 \\times 10^{-7}\\,\\mathrm{M}} = 2 \\times 10^4\n$$\n现在，将这些数值代入推导出的能斯特方程：\n$$\nE_{\\mathrm{Ca}} = \\frac{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (310\\,\\mathrm{K})}{(2) \\times (96485\\,\\mathrm{C\\,mol^{-1}})} \\ln(2 \\times 10^4)\n$$\n进行计算：\n$$\nE_{\\mathrm{Ca}} \\approx \\frac{2577.34\\,\\mathrm{J\\,mol^{-1}}}{192970\\,\\mathrm{C\\,mol^{-1}}} \\times \\ln(20000)\n$$\n$$\nE_{\\mathrm{Ca}} \\approx (0.0133563\\,\\mathrm{J\\,C^{-1}}) \\times (9.903488)\n$$\n因为 $1\\,\\mathrm{J\\,C^{-1}} = 1\\,\\mathrm{V}$：\n$$\nE_{\\mathrm{Ca}} \\approx 0.132274\\,\\mathrm{V}\n$$\n题目要求答案以毫伏为单位，并四舍五入到四位有效数字。\n$$\nE_{\\mathrm{Ca}} \\approx 132.274\\,\\mathrm{mV} \\approx 132.3\\,\\mathrm{mV}\n$$\n\n最后，我们定性讨论为什么巨大的细胞外-细胞内钙离子梯度使得 $E_{\\mathrm{Ca}}$ 高度去极化。推导出的能斯特方程 $E_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\left(\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i}\\right)$ 为此讨论提供了基础。在神经元背景下，“去极化”指的是膜电位为正值，或者至少显著比典型的静息电位（约 $-70\\,\\mathrm{mV}$）更正。\n项 $\\frac{RT}{z_{\\mathrm{Ca}}F}$ 是正常数（$R$, $T$, $F$）和正的化合价 $z_{\\mathrm{Ca}}=+2$ 的乘积，因此这个前置因子是正的。$E_{\\mathrm{Ca}}$ 的符号和大小因此由对数项 $\\ln\\left(\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i}\\right)$ 决定。\n“巨大的细胞外-细胞内钙离子梯度”意味着浓度比 $\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i}$ 是一个远大于1的数。在本题中，该比值为 $20000$。任何大于1的数的自然对数都是正的。对于一个非常大的比值，其对数会产生一个相应显著的正值。将正的前置因子乘以这个正的对数项，得到一个正的平衡电位 $E_{\\mathrm{Ca}}$。钙离子浓度比的巨大数量级确保了这个正电位值很大（例如 $+132.3\\,\\mathrm{mV}$）。这个值远比神经元的负静息电位更正，因此被描述为“高度去极化”。这个高的平衡电位建立了一个强大的电化学驱动力，使得每当钙离子通道开放时，$\\mathrm{Ca}^{2+}$ 就会进入细胞，导致快速且显著的膜去极化。",
            "answer": "$$\\boxed{132.3}$$"
        },
        {
            "introduction": "计算出平衡电位后，下一步是理解当膜电位偏离该平衡点时会发生什么。离子的净流动，即电流，是由膜电位（$V_m$）与该离子的能斯特电位（$E_{ion}$）之间的差异——即“驱动力”——所决定的。在本练习  中，您将应用这一关键概念，通过计算钾离子电流（$I_K$）来量化钾离子的跨膜流动。这个实践将帮助您巩固对离子流方向和大小的判断，这是膜生物物理学的核心技能。",
            "id": "3977994",
            "problem": "在对一个皮层锥体神经元进行的全细胞电压钳实验中，膜电位被钳制在一个恒定电位 $V_{m}$，同时一群钾选择性通道在静息电位附近的一个狭窄电压范围内保持开放，其电导 $g_{K}$ 近似恒定。钾反转电位 $E_{K}$ 已通过能斯特关系式根据细胞内和细胞外的钾离子浓度独立测量得出。假设采用传统的电生理学符号约定，其中正电流对应于正电荷跨膜的净向外移动。\n\n从以下原则出发：\n- 反转电位 $E_{K}$ 是指作用于钾离子上的净电化学力为零时的膜电位。\n- 在一个工作点附近，对于一个被动离子种类，其开放通道的电流-电压关系可近似为线性（欧姆性），其斜率等于该离子的电导。\n\n(a) 使用这些原则，推导钾电流 $I_{K}$ 的表达式，用电导 $g_{K}$ 和一个表示电化学驱动力的合适电压差来表示。\n\n(b) 对于特定值 $g_{K}=10\\,\\mathrm{nS}$、$V_{m}=-60\\,\\mathrm{mV}$ 和 $E_{K}=-88\\,\\mathrm{mV}$，计算 $I_{K}$ 的值，并在你的推理中根据所述的符号约定，指明电流是内向还是外向。最终电流以皮安（pA）为单位表示。最终的数值答案必须是答案框中的一个不带单位的数字。",
            "solution": "问题陈述经验证具有科学依据、提法得当、客观且内部一致。它基于电生理学的基本原理，并为提供完整解法提供了所有必要信息。\n\n**(a) 钾电流表达式的推导**\n\n问题要求基于所给的两个原则推导钾电流 $I_K$ 的表达式。\n\n第二个原则指出，在工作点附近，开放通道的电流-电压关系可近似为线性（欧姆性）。这是欧姆定律的一个应用，其一般形式写作：\n$$I = g \\cdot \\Delta V$$\n其中 $I$ 是电流，$g$ 是电导，$\\Delta V$ 是电位差或驱动力。对于钾离子的特定情况，该关系变为：\n$$I_K = g_K \\cdot \\Delta V_K$$\n这里，$g_K$ 是钾电导，$\\Delta V_K$ 是作用于钾离子上的电化学驱动力。\n\n第一个原则指出，反转电位 $E_K$ 是指当作用于钾离子上的净电化学力为零时的膜电位（$V_m$）。这意味着当 $V_m = E_K$ 时，净电流 $I_K$ 必须为零。我们必须定义驱动力 $\\Delta V_K$ 以满足此条件。\n\n驱动力是实际膜电位 $V_m$ 与没有净离子移动时的电位（即反转电位 $E_K$）之间的差值。我们定义驱动力为：\n$$\\Delta V_K = V_m - E_K$$\n\n我们可以验证这个定义与第一个原则是一致的。如果我们将 $V_m = E_K$ 代入此表达式，我们得到：\n$$\\Delta V_K = E_K - E_K = 0$$\n这导致电流 $I_K = g_K \\cdot 0 = 0$，这正确地反映了在反转电位时净电流为零的条件。\n\n因此，用电导 $g_K$ 和驱动力表示的钾电流 $I_K$ 的表达式为：\n$$I_K = g_K (V_m - E_K)$$\n\n这个方程是膜生物物理学的基石之一。项 $(V_m - E_K)$ 代表作用于钾离子上的净电化学驱动力。\n\n**(b) 钾电流的计算**\n\n我们被给予以下特定值：\n- 电导 $g_K = 10\\,\\mathrm{nS} = 10 \\times 10^{-9}\\,\\mathrm{S}$\n- 膜电位 $V_m = -60\\,\\mathrm{mV} = -60 \\times 10^{-3}\\,\\mathrm{V}$\n- 钾反转电位 $E_K = -88\\,\\mathrm{mV} = -88 \\times 10^{-3}\\,\\mathrm{V}$\n\n我们将这些值代入推导出的 $I_K$ 表达式中：\n$$I_K = g_K (V_m - E_K)$$\n$$I_K = (10 \\times 10^{-9}\\,\\mathrm{S}) \\left( (-60 \\times 10^{-3}\\,\\mathrm{V}) - (-88 \\times 10^{-3}\\,\\mathrm{V}) \\right)$$\n首先，我们以伏特为单位计算驱动力：\n$$V_m - E_K = (-60 - (-88)) \\times 10^{-3}\\,\\mathrm{V} = (-60 + 88) \\times 10^{-3}\\,\\mathrm{V} = 28 \\times 10^{-3}\\,\\mathrm{V}$$\n现在，我们将电导乘以驱动力来计算电流（单位为安培 A），因为 $1\\,\\mathrm{S} \\times 1\\,\\mathrm{V} = 1\\,\\mathrm{A}$：\n$$I_K = (10 \\times 10^{-9}\\,\\mathrm{S}) \\times (28 \\times 10^{-3}\\,\\mathrm{V})$$\n$$I_K = 280 \\times 10^{-12}\\,\\mathrm{A}$$\n问题要求结果以皮安（pA）表示。前缀“皮”（pico）对应于因子 $10^{-12}$。因此：\n$$I_K = 280\\,\\mathrm{pA}$$\n\n问题还要求指明电流的方向。计算出的 $I_K$ 值为正（$+280\\,\\mathrm{pA}$）。问题陈述中定义的符号约定是正电流对应于正电荷的净向外移动。由于钾离子（$K^+$）带正电，正电流表示 $K^+$ 离子从神经元中的净流出（向外移动）。这在物理上是合理的，因为膜电位（$V_m = -60\\,\\mathrm{mV}$）比钾平衡电位（$E_K = -88\\,\\mathrm{mV}$）更正（去极化），这产生了一个电化学梯度，驱动正的 $K^+$ 离子流出细胞。",
            "answer": "$$\\boxed{280}$$"
        },
        {
            "introduction": "前面的练习侧重于静态条件下的计算，然而，在真实的生理过程中，离子浓度是动态变化的，尤其是在高频神经活动期间。本节的高级编程实践  将引导您将前面的概念整合到一个动态的、生理学意义显著的情景中。您将模拟细胞外钾离子浓度上升（一种常见的生理现象）如何改变钾离子的平衡电位（$E_K$），进而影响钾电流（$I_K$）和整个神经元的兴奋性。这项练习旨在搭建从静态计算到动态计算建模的桥梁，是计算神经科学研究的一项基本功。",
            "id": "3977992",
            "problem": "你的任务是设计并实现一个程序，模拟在强烈的神经元放电情况下，当细胞外钾离子浓度（$[K]_o$）从 $3\\,\\mathrm{mM}$ 上升到 $10\\,\\mathrm{mM}$ 时，钾离子的反转电位（$E_K$）如何演变，并量化由此导致的钾离子电流密度（$I_K$）的变化，以及一个基于在被动膜中达到指定电压阈值所需的阈值电流密度的简单兴奋性度量。\n\n推导和计算必须从适用于大脑建模和计算神经科学的第一性原理开始。使用以下基础和定义，不要在问题陈述中调用任何捷径公式：\n- 离子物质的电化学平衡条件，即平衡时净电化学势差为零。\n- 离子的理想溶液近似。\n- 膜等效电路中电导、驱动力和电流之间的关系。\n- 在被动多电导膜中，静息膜电位定义为反转电位的电导加权平均值。\n\n推导和计算中使用的常量和参数：\n- 绝对温度 $T = 310\\,\\mathrm{K}$。\n- 普适气体常数 $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n- 法拉第常数 $F = 96485.33212\\,\\mathrm{C/mol}$。\n- 钾的化合价 $z_K = +1$。\n- 细胞内钾离子浓度 $[K]_i = 140\\,\\mathrm{mM}$。\n- 最大钾电导 $g_{K,\\mathrm{max}} = 36\\,\\mathrm{mS/cm^2}$。\n- 漏电导 $g_L = 0.1\\,\\mathrm{mS/cm^2}$。\n- 漏反转电位 $E_L = -65\\,\\mathrm{mV}$。\n- 峰间期代表性膜电压 $V_m = -55\\,\\mathrm{mV}$。\n- 简化模型中动作电位发放的电压阈值 $V_{\\mathrm{th}} = -50\\,\\mathrm{mV}$。\n- 活动期间钾通道的平均开放概率 $p_{\\mathrm{open}}$ 取决于具体情况，并在下面的测试套件中指定。\n- 有效钾电导为 $g_K = p_{\\mathrm{open}} \\cdot g_{K,\\mathrm{max}}$。\n\n每个测试用例的计算任务：\n1. 根据给定的 $[K]_o$ 和 $[K]_i$，使用常数 $R$、$T$、$F$ 和 $z_K$，从电化学平衡条件推导出钾离子反转电位 $E_K$ (单位为 $\\mathrm{mV}$)。\n2. 使用电导 $g_K$ 以及由 $V_m$ 和 $E_K$ 之间的差值决定的驱动力，计算在指定 $V_m$ 下的钾离子电流密度 $I_K$ (单位为 $\\mathrm{\\mu A/cm^2}$)。\n3. 将静息膜电位 $V_{\\mathrm{rest}}$ (单位为 $\\mathrm{mV}$) 计算为漏电导和钾离子反转电位的电导加权平均值，然后计算在被动膜的稳态条件下，将膜电位维持在 $V_{\\mathrm{th}}$ 所需的阈值电流密度 $I_{\\mathrm{th}}$ (单位为 $\\mathrm{\\mu A/cm^2}$)。\n\n上述量的显式公式必须作为解决方案的一部分，从所述的基本原理中推导出来。在适用的情况下必须使用自然对数。\n\n单位和输出要求：\n- 将 $E_K$ 以 $\\mathrm{mV}$ 表示，$I_K$ 以 $\\mathrm{\\mu A/cm^2}$ 表示，$I_{\\mathrm{th}}$ 以 $\\mathrm{\\mu A/cm^2}$ 表示。\n- 将所有输出四舍五入到三位小数。\n- 你的程序应该生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是包含三个浮点数 $[E_K, I_K, I_{\\mathrm{th}}]$ 的列表，最终输出必须是这些列表的列表。\n\n测试套件：\n- 情况A (基线)：$[K]_o = 3\\,\\mathrm{mM}$，$p_{\\mathrm{open}} = 0.05$。\n- 情况B (强烈放电)：$[K]_o = 10\\,\\mathrm{mM}$，$p_{\\mathrm{open}} = 0.40$。\n- 情况C (边界条件)：$[K]_o = 140\\,\\mathrm{mM}$，$p_{\\mathrm{open}} = 0.40$。\n- 情况D (中间)：$[K]_o = 6\\,\\mathrm{mM}$，$p_{\\mathrm{open}} = 0.20$。\n\n最终输出格式规范：\n- 你的程序必须精确打印一行：一个形式为 $[[E_K^{(A)}, I_K^{(A)}, I_{\\mathrm{th}}^{(A)}],[E_K^{(B)}, I_K^{(B)}, I_{\\mathrm{th}}^{(B)}],[E_K^{(C)}, I_K^{(C)}, I_{\\mathrm{th}}^{(D)}],[E_K^{(D)}, I_K^{(D)}, I_{\\mathrm{th}}^{(D)}]]$ 的单一列表，其中上标表示测试用例的标签。所有数值条目必须是四舍五入到三位小数的浮点数。",
            "solution": "该问题已经过验证，被确定为合理、适定，并在计算神经科学的原理上有科学依据。所提供的参数是一致的，并且在生理学上合理的范围内。所要求的推导和计算是神经元生物物理建模中的标准程序。\n\n解决方案将首先从指定的基本原理中推导出所需的公式，然后针对给定的测试用例进行计算实现。\n\n**1. 钾离子反转电位 ($E_K$) 的推导**\n\n离子的反转电位（或能斯特电位）是指在该膜电位下，没有该离子跨膜的净流动。当跨膜的电化学势差为零时，达到此平衡。对于化合价为 $z_X$ 的离子物质 $X$，其电化学势差 $\\Delta\\mu_X$ 是化学势差（由浓度梯度引起）和电势差（由跨膜电场引起）的总和。\n\n理想溶液的化学势差由下式给出：\n$$ \\Delta \\mu_{\\mathrm{chem}} = RT \\ln\\left(\\frac{[X]_i}{[X]_o}\\right) $$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$[X]_i$ 和 $[X]_o$ 分别是离子的细胞内和细胞外浓度。\n\n一摩尔离子所经历的电势差为：\n$$ \\Delta \\mu_{\\mathrm{elec}} = z_X F V_m $$\n其中 $F$ 是法拉第常数，$V_m$ 是膜电位。\n\n在平衡状态下，总电化学势差为零（$\\Delta\\mu_X = 0$），膜电位等于反转电位 $E_X$。\n$$ \\Delta \\mu_X = RT \\ln\\left(\\frac{[X]_i}{[X]_o}\\right) + z_X F E_X = 0 $$\n求解 $E_X$ 得到能斯特方程：\n$$ E_X = -\\frac{RT}{z_X F} \\ln\\left(\\frac{[X]_i}{[X]_o}\\right) = \\frac{RT}{z_X F} \\ln\\left(\\frac{[X]_o}{[X]_i}\\right) $$\n对于钾离子（$K^+$），化合价 $z_K = +1$。因此，钾离子反转电位 $E_K$ 为：\n$$ E_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o}{[K]_i}\\right) $$\n该公式的结果单位为伏特（Volts）。要按要求转换为毫伏（$\\mathrm{mV}$），结果必须乘以 $1000$。浓度 $[K]_o$ 和 $[K]_i$ 的单位是 $\\mathrm{mM}$，但由于使用的是它们的比率，单位会抵消。\n\n**2. 钾离子电流密度 ($I_K$) 的计算**\n\n离子电流、电导和驱动力之间的关系由一种为膜定制的欧姆定律形式描述。特定离子的电流密度 $I_X$ 是其膜电导 $g_X$ 与电化学驱动力 $(V_m - E_X)$ 的乘积。\n$$ I_X = g_X (V_m - E_X) $$\n对于钾离子，电流密度 $I_K$ 为：\n$$ I_K = g_K (V_m - E_K) $$\n问题指明，有效钾电导 $g_K$ 是最大电导 $g_{K,\\mathrm{max}}$ 和通道平均开放概率 $p_{\\mathrm{open}}$ 的乘积。\n$$ g_K = p_{\\mathrm{open}} \\cdot g_{K,\\mathrm{max}} $$\n计算在给定的代表性膜电压 $V_m = -55\\,\\mathrm{mV}$ 下进行。单位是一致的：如果 $g_K$ 的单位是 $\\mathrm{mS/cm^2}$，电压（$V_m$, $E_K$）的单位是 $\\mathrm{mV}$，则得到的电流密度 $I_K$ 的单位将是 $\\mathrm{\\mu A/cm^2}$（$1\\,\\mathrm{mS} \\times 1\\,\\mathrm{mV} = 10^{-3}\\,\\mathrm{S} \\times 10^{-3}\\,\\mathrm{V} = 10^{-6}\\,\\mathrm{A} = 1\\,\\mathrm{\\mu A}$）。\n\n**3. 静息电位 ($V_{\\mathrm{rest}}$) 和阈值电流 ($I_{\\mathrm{th}}$) 的计算**\n\n在被动模型中，静息膜电位 $V_{\\mathrm{rest}}$ 是指在没有施加外部电流的情况下，跨膜所有离子电流之和为零时的电位。对于给定的双电导模型（钾和漏电），此条件为：\n$$ I_{\\mathrm{total}} = I_K + I_L = 0 $$\n代入每种电流的表达式：\n$$ g_K(V_{\\mathrm{rest}} - E_K) + g_L(V_{\\mathrm{rest}} - E_L) = 0 $$\n其中 $g_L$ 和 $E_L$ 分别是漏电导和漏反转电位。求解 $V_{\\mathrm{rest}}$：\n$$ V_{\\mathrm{rest}} (g_K+g_L) = g_K E_K + g_L E_L $$\n$$ V_{\\mathrm{rest}} = \\frac{g_K E_K + g_L E_L}{g_K + g_L} $$\n这表明静息电位是各个反转电位的电导加权平均值。\n\n阈值电流 $I_{\\mathrm{th}}$ 定义为必须注入以将膜电位维持在动作电位发放阈值 $V_{\\mathrm{th}}$ 的外部电流密度。在外部电流 $I_{\\mathrm{ext}}$ 作用下，膜电位的动态可以描述为 $C_m \\frac{dV_m}{dt} = I_{\\mathrm{ext}} - I_{\\mathrm{ion}}(V_m)$，其中 $I_{\\mathrm{ion}}(V_m) = I_K + I_L$。为了将电位恒定保持在 $V_{\\mathrm{th}}$，我们必须有 $\\frac{dV_m}{dt} = 0$，这意味着注入的电流必须精确平衡该电压下的总离子电流。因此，$I_{\\mathrm{th}} = I_{\\mathrm{ext}} = I_{\\mathrm{ion}}(V_{\\mathrm{th}})$。\n$$ I_{\\mathrm{th}} = g_K(V_{\\mathrm{th}} - E_K) + g_L(V_{\\mathrm{th}} - E_L) $$\n按照惯例，正电流使细胞去极化，负电流使其超极化。正的 $I_{\\mathrm{th}}$ 表示需要一个去极化电流才能从静息状态达到阈值，而负的 $I_{\\mathrm{th}}$ 表示需要一个超极化电流。\n$I_{\\mathrm{th}}$ 的计算通过代入 $g_K$、$E_K$、$g_L$、$E_L$ 和 $V_{\\mathrm{th}}$ 的值来进行。出于与 $I_K$ 相同的原因，其单位将是 $\\mathrm{\\mu A/cm^2}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes potassium reversal potential, potassium current density, and threshold\n    current density based on fundamental biophysical principles for a set of test cases.\n    \"\"\"\n    \n    # Define constants and parameters from the problem statement.\n    R = 8.314462618  # Universal gas constant in J/(mol·K)\n    T = 310.0        # Absolute temperature in K\n    F = 96485.33212  # Faraday constant in C/mol\n    z_K = 1.0        # Valence of potassium\n    K_i = 140.0      # Intracellular potassium concentration in mM\n    g_K_max = 36.0   # Maximal potassium conductance in mS/cm^2\n    g_L = 0.1        # Leak conductance in mS/cm^2\n    E_L = -65.0      # Leak reversal potential in mV\n    V_m = -55.0      # Representative membrane voltage in mV\n    V_th = -50.0     # Voltage threshold for spike initiation in mV\n\n    # Pre-calculate the RT/F term in mV for the Nernst equation.\n    RT_over_F_mV = (R * T / (z_K * F)) * 1000.0\n\n    # Define the test cases. Each case is a tuple of ([K]_o, p_open).\n    test_cases = [\n        (3.0, 0.05),    # Case A: baseline\n        (10.0, 0.40),   # Case B: intense firing\n        (140.0, 0.40),  # Case C: boundary condition\n        (6.0, 0.20),    # Case D: intermediate\n    ]\n\n    all_results = []\n    for case in test_cases:\n        K_o, p_open = case\n\n        # Task 1: Compute potassium reversal potential E_K (in mV)\n        # using the Nernst equation derived in the solution.\n        # np.log is the natural logarithm.\n        E_K = RT_over_F_mV * np.log(K_o / K_i)\n\n        # Task 2: Compute potassium current density I_K (in µA/cm^2)\n        # Effective potassium conductance g_K\n        g_K = p_open * g_K_max\n        # Potassium current I_K using Ohm's law for the membrane\n        I_K = g_K * (V_m - E_K)\n        \n        # Task 3: Compute threshold current density I_th (in µA/cm^2)\n        # I_th is the injected current needed to hold V_m at V_th.\n        # This current must balance the ionic currents at V_th.\n        I_th = g_K * (V_th - E_K) + g_L * (V_th - E_L)\n        \n        # Round all results to three decimal places as required.\n        case_results = [\n            round(E_K, 3),\n            round(I_K, 3),\n            round(I_th, 3)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output as a single-line string representation\n    # of the list of lists, with no spaces.\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}