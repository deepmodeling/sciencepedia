{
    "hands_on_practices": [
        {
            "introduction": "While the Nernst equation perfectly describes the equilibrium potential for a single ion species, most biological ion channels allow multiple types of ions to pass through. This practice challenges you to derive and apply the Goldman-Hodgkin-Katz (GHK) voltage equation, a cornerstone of membrane biophysics that accounts for the contributions of multiple permeant ions. Mastering this calculation  is crucial for accurately predicting the reversal potential of non-selective channels, such as those mediating synaptic transmission or setting the neuronal resting potential.",
            "id": "3996860",
            "problem": "A membrane patch in a computational neuron model contains a single population of nonselective cation channels that conduct both sodium ions ($\\text{Na}^{+}$) and potassium ions ($\\text{K}^{+}$). The channels obey the independence principle for ionic movement and the constant-field approximation underlying the Goldman-Hodgkin-Katz (GHK) framework. Assume an ideal solution so that activities equal concentrations. There are no other permeant ions. The membrane potential is defined by the intracellular minus extracellular electric potential, $V_{m} = \\phi_{\\text{in}} - \\phi_{\\text{out}}$. The intracellular and extracellular concentrations are:\n- $[\\text{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$, $[\\text{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$,\n- $[\\text{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$, $[\\text{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$.\nThe absolute temperature is $T = 308\\,\\mathrm{K}$, the universal gas constant is $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and the Faraday constant is $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$. The channel has equal permeability to sodium and potassium: $P_{\\text{Na}} = P_{\\text{K}}$.\n\nStarting from the electrodiffusion description that under the constant-field approximation leads to the Goldman-Hodgkin-Katz description of ionic fluxes, derive the reversal potential $V_{\\text{rev}}$ for the nonselective cation channel as the membrane potential at which the net current carried by $\\text{Na}^{+}$ and $\\text{K}^{+}$ is zero. Then evaluate the numerical value of $V_{\\text{rev}}$ for the given concentrations and parameters.\n\nRound your final numerical answer to four significant figures and express it in millivolts (mV). Provide a single numerical value for $V_{\\text{rev}}$.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Task:** Derive the reversal potential $V_{\\text{rev}}$ and calculate its numerical value for a nonselective cation channel.\n- **Physical System:** A membrane patch containing a single population of nonselective cation channels permeable to $\\text{Na}^{+}$ and $\\text{K}^{+}$.\n- **Assumptions:** Independence principle for ionic movement, constant-field approximation (GHK framework), ideal solution (activity = concentration).\n- **Definitions:** Membrane potential $V_{m} = \\phi_{\\text{in}} - \\phi_{\\text{out}}$.\n- **Ionic Concentrations:**\n    - $[\\text{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$\n    - $[\\text{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$\n    - $[\\text{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$\n    - $[\\text{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$\n- **Physical Constants:**\n    - Absolute temperature $T = 308\\,\\mathrm{K}$\n    - Universal gas constant $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n    - Faraday constant $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- **Channel Property:** Equal permeability for sodium and potassium ions, $P_{\\text{Na}} = P_{\\text{K}}$.\n- **Output Requirements:**\n    - Round the final numerical answer to four significant figures.\n    - Express the answer in millivolts ($\\mathrm{mV}$).\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in established principles of biophysics, specifically the Nernst-Planck electrodiffusion theory and its simplification under the constant-field assumption, which leads to the Goldman-Hodgkin-Katz (GHK) equations. This is a standard and fundamental model in computational neuroscience and cell physiology. The provided ionic concentrations are physiologically plausible for a neuron.\n- **Well-Posed:** The problem statement is clear and provides all necessary parameters ($T$, $R$, $F$), boundary conditions (concentrations), and properties of the system ($P_{\\text{Na}} = P_{\\text{K}}$) to derive and compute a unique value for the reversal potential, $V_{\\text{rev}}$.\n- **Objective:** The problem is phrased in precise, quantitative, and unbiased language, free of any subjectivity.\n- **Completeness and Consistency:** The data and constraints are self-contained and consistent. There are no missing essential parameters or contradictory statements.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and complete. It is therefore deemed **valid**. The solution process will now proceed.\n\nThe reversal potential, $V_{\\text{rev}}$, is the membrane potential $V_m$ at which the total net ionic current across the membrane is zero. The channel is permeable only to sodium ($\\text{Na}^{+}$) and potassium ($\\text{K}^{+}$) ions. Therefore, the total current $I_{\\text{total}}$ is the sum of the sodium current $I_{\\text{Na}}$ and the potassium current $I_{\\text{K}}$. The condition for the reversal potential is:\n$$I_{\\text{total}} = I_{\\text{Na}} + I_{\\text{K}} = 0$$\n\nThe problem requires starting from the GHK description of ionic fluxes. The GHK current equation for a generic ion species $S$ with valence $z_S$ is given by:\n$$I_S = P_S z_S^2 \\frac{F^2 V_m}{RT} \\frac{[S]_{\\text{in}} - [S]_{\\text{out}}\\exp\\left(-\\frac{z_S F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{z_S F V_m}{RT}\\right)}$$\nwhere $P_S$ is the permeability of the membrane to the ion $S$, $[S]_{\\text{in}}$ and $[S]_{\\text{out}}$ are the intracellular and extracellular concentrations, $V_m$ is the membrane potential, $F$ is the Faraday constant, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nFor sodium ($\\text{Na}^{+}$) and potassium ($\\text{K}^{+}$), which are both monovalent cations, their valences are $z_{\\text{Na}} = +1$ and $z_{\\text{K}} = +1$. The respective currents are:\n$$I_{\\text{Na}} = P_{\\text{Na}} \\frac{F^2 V_m}{RT} \\frac{[\\text{Na}^{+}]_{\\text{in}} - [\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_m}{RT}\\right)}$$\n$$I_{\\text{K}} = P_{\\text{K}} \\frac{F^2 V_m}{RT} \\frac{[\\text{K}^{+}]_{\\text{in}} - [\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_m}{RT}\\right)}$$\n\nAt the reversal potential ($V_m = V_{\\text{rev}}$), the sum of these currents is zero:\n$$I_{\\text{Na}} + I_{\\text{K}} = 0$$\n$$P_{\\text{Na}} \\frac{F^2 V_{\\text{rev}}}{RT} \\frac{[\\text{Na}^{+}]_{\\text{in}} - [\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)} + P_{\\text{K}} \\frac{F^2 V_{\\text{rev}}}{RT} \\frac{[\\text{K}^{+}]_{\\text{in}} - [\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)} = 0$$\n\nAssuming $V_{\\text{rev}} \\neq 0$, the common pre-factor $\\frac{F^2 V_{\\text{rev}}}{RT} \\frac{1}{1 - \\exp(-F V_{\\text{rev}}/RT)}$ is non-zero and can be divided out. This leaves:\n$$P_{\\text{Na}}\\left([\\text{Na}^{+}]_{\\text{in}} - [\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)\\right) + P_{\\text{K}}\\left([\\text{K}^{+}]_{\\text{in}} - [\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)\\right) = 0$$\n\nWe now solve for $V_{\\text{rev}}$. First, group terms with and without the exponential factor:\n$$P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}} = P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right) + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)$$\nFactor out the exponential term on the right-hand side:\n$$P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}} = \\left(P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}\\right) \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)$$\nIsolate the exponential term:\n$$\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right) = \\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}$$\nTake the natural logarithm of both sides:\n$$-\\frac{F V_{\\text{rev}}}{RT} = \\ln\\left(\\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}\\right)$$\nUsing the property $\\ln(1/x) = -\\ln(x)$, we can invert the argument of the logarithm and remove the negative sign:\n$$\\frac{F V_{\\text{rev}}}{RT} = \\ln\\left(\\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}\\right)$$\nFinally, solving for $V_{\\text{rev}}$ gives the Goldman-Hodgkin-Katz voltage equation for these two ions:\n$$V_{\\text{rev}} = \\frac{RT}{F} \\ln\\left(\\frac{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{out}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{out}}}{P_{\\text{Na}}[\\text{Na}^{+}]_{\\text{in}} + P_{\\text{K}}[\\text{K}^{+}]_{\\text{in}}}\\right)$$\n\nThe problem states that the channel has equal permeability to sodium and potassium: $P_{\\text{Na}} = P_{\\text{K}}$. Let us denote this common permeability by $P$. The expression for $V_{\\text{rev}}$ simplifies:\n$$V_{\\text{rev}} = \\frac{RT}{F} \\ln\\left(\\frac{P[\\text{Na}^{+}]_{\\text{out}} + P[\\text{K}^{+}]_{\\text{out}}}{P[\\text{Na}^{+}]_{\\text{in}} + P[\\text{K}^{+}]_{\\text{in}}}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{[\\text{Na}^{+}]_{\\text{out}} + [\\text{K}^{+}]_{\\text{out}}}{[\\text{Na}^{+}]_{\\text{in}} + [\\text{K}^{+}]_{\\text{in}}}\\right)$$\n\nNow, we substitute the given numerical values:\n- $[\\text{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$\n- $[\\text{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$\n- $[\\text{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$\n- $[\\text{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$\n- $T = 308\\,\\mathrm{K}$\n- $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n\nThe sum of extracellular concentrations is $[\\text{Na}^{+}]_{\\text{out}} + [\\text{K}^{+}]_{\\text{out}} = 160 + 3 = 163\\,\\mathrm{mM}$.\nThe sum of intracellular concentrations is $[\\text{Na}^{+}]_{\\text{in}} + [\\text{K}^{+}]_{\\text{in}} = 8 + 100 = 108\\,\\mathrm{mM}$.\n\n$$V_{\\text{rev}} = \\frac{(8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(308\\,\\mathrm{K})}{96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\ln\\left(\\frac{163}{108}\\right)$$\nThe term $\\frac{RT}{F}$ has units of $\\mathrm{J}/\\mathrm{C}$, which is Volts ($\\mathrm{V}$).\n$$\\frac{RT}{F} \\approx \\frac{2560.712}{96485} \\approx 0.026540\\,\\mathrm{V}$$\nThe argument of the logarithm is:\n$$\\frac{163}{108} \\approx 1.509259$$\nThus,\n$$V_{\\text{rev}} \\approx (0.026540\\,\\mathrm{V}) \\ln(1.509259)$$\n$$V_{\\text{rev}} \\approx (0.026540\\,\\mathrm{V}) (0.411600)$$\n$$V_{\\text{rev}} \\approx 0.01092518\\,\\mathrm{V}$$\nThe problem requires the answer in millivolts ($\\mathrm{mV}$):\n$$V_{\\text{rev}} \\approx 10.92518\\,\\mathrm{mV}$$\nRounding to four significant figures, we get:\n$$V_{\\text{rev}} = 10.93\\,\\mathrm{mV}$$",
            "answer": "$$\n\\boxed{10.93}\n$$"
        },
        {
            "introduction": "Moving from a macroscopic view to the microscopic reality of the cell membrane reveals that ion channels are not simple deterministic gates. This exercise introduces the fundamental concept that channels open and close probabilistically, and the total current across a patch of membrane is the sum of these tiny, random events. By deriving the variance of the total current from first principles , you will gain a deep, quantitative insight into the nature of channel noise and its relationship to single-channel properties and the number of active channels.",
            "id": "3996923",
            "problem": "A neuron’s somatic membrane patch is voltage clamped at a fixed potential so that ionic driving forces are constant. The patch contains $N$ identical, independent ion channels, each modeled as a two-state Markov process with states “closed” and “open.” At stationarity, the probability that any given channel is in the open state is $p$, and transitions are sufficiently fast relative to the acquisition bandwidth that the state during each sampling instant can be treated as a Bernoulli trial. When a channel is open, it passes a single-channel current of magnitude $i$; when closed, it passes zero. Assume ions are abundant so that the single-channel current $i$ is deterministic and does not fluctuate due to shot noise, and assume there are no interactions or correlations among channels beyond the independence specified.\n\nDefine the total membrane current as $I = i \\sum_{k=1}^{N} X_k$, where $X_k \\in \\{0,1\\}$ is the indicator that channel $k$ is open at the sampling instant. Using only first principles of probability for independent Bernoulli random variables and properties of variance, derive the variance of the total current $I$ at stationarity. Express your final answer as a single closed-form analytic expression in terms of $N$, $p$, and $i$. No numerical evaluation is required. Provide the final expression only, with no units attached to it.",
            "solution": "The problem requires the derivation of the variance of the total membrane current, $I$, under specific stationary conditions. The total current is given by the expression:\n$$I = i \\sum_{k=1}^{N} X_k$$\nHere, $i$ is the deterministic single-channel current magnitude, $N$ is the total number of identical channels, and $X_k$ is a random variable representing the state of the $k$-th channel at a given sampling instant.\n\nThe problem states that each channel's state can be modeled as a Bernoulli trial. The variable $X_k$ is an indicator variable, where $X_k = 1$ if the channel is open and $X_k = 0$ if it is closed. The probability that any given channel is in the open state is given as $p$. Therefore, for each channel $k$, the probability distribution of $X_k$ is:\n$$P(X_k = 1) = p$$\n$$P(X_k = 0) = 1 - p$$\nThese $N$ random variables, $X_1, X_2, \\dots, X_N$, are stated to be independent and, since the channels are identical, they are also identically distributed. Thus, they are independent and identically distributed (i.i.d.) Bernoulli random variables.\n\nWe seek to find the variance of the total current, $\\text{Var}(I)$. We begin by applying the properties of variance to the given expression for $I$. A fundamental property of variance states that for any constant $c$ and random variable $Y$, $\\text{Var}(cY) = c^2 \\text{Var}(Y)$. In our case, the single-channel current $i$ is a constant. Thus, we can write:\n$$\\text{Var}(I) = \\text{Var}\\left(i \\sum_{k=1}^{N} X_k\\right) = i^2 \\text{Var}\\left(\\sum_{k=1}^{N} X_k\\right)$$\n\nThe problem specifies that the channels are independent. For a sum of independent random variables, the variance of the sum is equal to the sum of their individual variances. This allows us to write:\n$$\\text{Var}\\left(\\sum_{k=1}^{N} X_k\\right) = \\sum_{k=1}^{N} \\text{Var}(X_k)$$\n\nFurthermore, since all channels are identical, the random variables $X_k$ are identically distributed. This implies that their variances are all equal. Let us denote the variance of a single channel's state variable as $\\text{Var}(X)$.\n$$\\text{Var}(X_1) = \\text{Var}(X_2) = \\dots = \\text{Var}(X_N) = \\text{Var}(X)$$\nTherefore, the sum of the variances simplifies to:\n$$\\sum_{k=1}^{N} \\text{Var}(X_k) = N \\cdot \\text{Var}(X)$$\n\nBy substituting these results back into our expression for $\\text{Var}(I)$, we obtain:\n$$\\text{Var}(I) = i^2 N \\text{Var}(X)$$\n\nThe remaining task is to compute the variance of a single Bernoulli random variable $X$ with success probability $p$. The variance is defined by the formula $\\text{Var}(X) = E[X^2] - (E[X])^2$. We must first calculate the expected value (mean) of $X$.\n$$E[X] = (1) \\cdot P(X=1) + (0) \\cdot P(X=0) = (1)(p) + (0)(1-p) = p$$\n\nNext, we calculate the expected value of $X^2$. Since $X$ can only take values of $0$ or $1$, the variable $X^2$ is identical to $X$ (because $0^2 = 0$ and $1^2 = 1$). Therefore, their expected values are also identical.\n$$E[X^2] = E[X] = p$$\n\nNow we can calculate the variance of $X$:\n$$\\text{Var}(X) = E[X^2] - (E[X])^2 = p - p^2 = p(1-p)$$\n\nThis is the well-established formula for the variance of a Bernoulli random variable.\n\nFinally, we substitute this expression for $\\text{Var}(X)$ into our equation for the variance of the total current $\\text{Var}(I)$:\n$$\\text{Var}(I) = i^2 N p(1-p)$$\nThis is the closed-form analytic expression for the variance of the total current in terms of the given parameters $N$, $p$, and $i$.",
            "answer": "$$\\boxed{N i^2 p (1-p)}$$"
        },
        {
            "introduction": "Our previous analyses assumed that intracellular ion concentrations were constant. In reality, every ion that crosses the membrane slightly alters these concentrations, which in turn shifts the reversal potentials. This capstone practice  asks you to build a dynamic simulation that integrates passive channel currents, active transport by pumps, and the resulting changes in ion concentrations over time. By modeling this feedback loop, you will develop a hands-on understanding of ion homeostasis—the process by which neurons actively maintain their critical electrochemical gradients in the face of ongoing electrical activity.",
            "id": "3996817",
            "problem": "Design and implement a complete program that simulates how constant membrane ionic currents drive changes in intracellular ionic concentrations and, consequently, dynamically alter reversal potentials during a sustained depolarization in a single isopotential neuronal compartment. Start from the following fundamental base: conservation of mass for each ionic species, Faraday's law relating ionic current to molar flux, and the Nernst equation linking concentration gradients to reversal potentials. Consider three ions: sodium ($\\mathrm{Na}^+$), potassium ($\\mathrm{K}^+$), and chloride ($\\mathrm{Cl}^-$). Use a spherical compartment of radius $r$ with membrane area $A = 4\\pi r^2$ and intracellular volume $V = \\frac{4}{3}\\pi r^3$. Assume constant extracellular concentrations and a held membrane potential (voltage clamp), giving a sustained depolarization for a fixed duration.\n\nThe foundational definitions and assumptions to be used are:\n- Faraday's law: for ion species $X$ with valence $z_X$, the outward current density $i_X$ (in $\\mathrm{A/m^2}$) relates to the outward molar flux per unit area $J_X$ (in $\\mathrm{mol/(m^2\\,s)}$) by $i_X = z_X F J_X$, where $F$ is Faraday's constant (in $\\mathrm{C/mol}$). The intracellular concentration $[\\mathrm{X}]_i$ (in $\\mathrm{mol/m^3}$) changes according to $\\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V} J_X = -\\frac{A}{V z_X F} i_X$.\n- Ohmic current for each ion: $i_X = g_X (V_m - E_X)$, with $g_X$ the conductance density (in $\\mathrm{S/m^2}$), $V_m$ the membrane potential (in $\\mathrm{V}$), and $E_X$ the reversal potential (in $\\mathrm{V}$).\n- Nernst equation: $E_X = \\frac{RT}{z_X F} \\ln\\left(\\frac{[\\mathrm{X}]_o}{[\\mathrm{X}]_i}\\right)$, where $R$ is the gas constant (in $\\mathrm{J/(mol\\,K)}$), $T$ is the absolute temperature (in $\\mathrm{K}$), and $[\\mathrm{X}]_o$ is the extracellular concentration (in $\\mathrm{mol/m^3}$).\n- Sodium–potassium adenosine triphosphatase (ATPase) pump current density $i_{\\mathrm{pump}}$ (in $\\mathrm{A/m^2}$) is outward and depends sigmoidally on intracellular sodium and extracellular potassium. Its stoichiometry is $3$ $\\mathrm{Na}^+$ ions pumped outward and $2$ $\\mathrm{K}^+$ ions pumped inward per cycle, producing a net outward positive current equivalent to $+1$ elementary charge per cycle. Model it as $i_{\\mathrm{pump}} = I_{\\max} s_{\\mathrm{Na}} s_{\\mathrm{K}}$, with $s_{\\mathrm{Na}} = \\frac{[\\mathrm{Na}]_i^n}{K_{\\mathrm{Na}}^n + [\\mathrm{Na}]_i^n}$ and $s_{\\mathrm{K}} = \\frac{[\\mathrm{K}]_o^m}{K_{\\mathrm{K}}^m + [\\mathrm{K}]_o^m}$, where $I_{\\max}$ is a maximal pump current density, $K_{\\mathrm{Na}}$ and $K_{\\mathrm{K}}$ are half-saturation constants (in $\\mathrm{mol/m^3}$), and $n,m$ are Hill exponents (dimensionless). The pump contributes $+3 i_{\\mathrm{pump}}$ to the sodium outward current density and $-2 i_{\\mathrm{pump}}$ to the potassium outward current density.\n\nThe program must integrate the coupled ordinary differential equations (ODEs) for $[\\mathrm{Na}]_i(t)$, $[\\mathrm{K}]_i(t)$, and $[\\mathrm{Cl}]_i(t)$ over a specified time interval under a constant depolarized membrane potential $V_m$ and compute the changes in reversal potentials $E_{\\mathrm{Na}}(t)$, $E_{\\mathrm{K}}(t)$, and $E_{\\mathrm{Cl}}(t)$ from their initial values. Use absolute temperature $T = 310\\,\\mathrm{K}$. Use extracellular concentrations $[\\mathrm{Na}]_o = 145\\,\\mathrm{mM}$, $[\\mathrm{K}]_o = 4\\,\\mathrm{mM}$, and $[\\mathrm{Cl}]_o = 110\\,\\mathrm{mM}$, and initial intracellular concentrations $[\\mathrm{Na}]_i(0) = 15\\,\\mathrm{mM}$, $[\\mathrm{K}]_i(0) = 140\\,\\mathrm{mM}$, $[\\mathrm{Cl}]_i(0) = 5\\,\\mathrm{mM}$. Treat $1\\,\\mathrm{mM}$ as $1\\,\\mathrm{mol/m^3}$ internally. Use conductance densities $g_{\\mathrm{Na}} = 0.001\\,\\mathrm{S/m^2}$, $g_{\\mathrm{K}} = 0.002\\,\\mathrm{S/m^2}$, $g_{\\mathrm{Cl}} = 0.001\\,\\mathrm{S/m^2}$. Use the pump parameters $I_{\\max} = 0.001\\,\\mathrm{A/m^2}$, $K_{\\mathrm{Na}} = 10\\,\\mathrm{mol/m^3}$, $K_{\\mathrm{K}} = 1.5\\,\\mathrm{mol/m^3}$, $n = 1.5$, and $m = 1.5$. Set valences $z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{K}} = +1$, and $z_{\\mathrm{Cl}} = -1$.\n\nImplement numerical integration of the ODEs using any stable method suitable for smooth dynamics. Ensure positivity of concentrations in the computation of $E_X$ by applying a minimal floor (e.g., replacing $[\\mathrm{X}]_i$ inside logarithms with $\\max([\\mathrm{X}]_i, \\varepsilon)$ for some small $\\varepsilon > 0$) while maintaining correct mass-balance signs in the ODE.\n\nThe test suite consists of five parameter sets covering typical, edge, and boundary conditions. For each test case, simulate to compute the final reversal potentials and output their changes (final minus initial) for all ions, expressed in millivolts (in $\\mathrm{mV}$) as floats. The sustained membrane potential and other parameters for each case are:\n\n- Case $1$: $r = 10\\times 10^{-6}\\,\\mathrm{m}$, $V_m = -20\\times 10^{-3}\\,\\mathrm{V}$, duration $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$, pump on.\n- Case $2$: $r = 5\\times 10^{-6}\\,\\mathrm{m}$, $V_m = -10\\times 10^{-3}\\,\\mathrm{V}$, duration $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$, pump off.\n- Case $3$: $r = 25\\times 10^{-6}\\,\\mathrm{m}$, $V_m = -20\\times 10^{-3}\\,\\mathrm{V}$, duration $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$, pump on.\n- Case $4$: $r = 10\\times 10^{-6}\\,\\mathrm{m}$, $V_m = 0\\,\\mathrm{V}$, duration $T_{\\mathrm{end}} = 60\\,\\mathrm{s}$, pump on.\n- Case $5$: $r = 10\\times 10^{-6}\\,\\mathrm{m}$, $V_m = -65\\times 10^{-3}\\,\\mathrm{V}$, duration $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$, pump on.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$). The output must list, in order for each test case, the reversal potential changes $\\Delta E_{\\mathrm{K}}$ (in $\\mathrm{mV}$), $\\Delta E_{\\mathrm{Na}}$ (in $\\mathrm{mV}$), and $\\Delta E_{\\mathrm{Cl}}$ (in $\\mathrm{mV}$), flattened across all test cases into one list. All values must be expressed in $\\mathrm{mV}$ as floats.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and provides a complete and consistent set of parameters and equations for a standard computational neuroscience simulation. The model is based on fundamental biophysical principles, namely the conservation of ionic species, the Nernst equation for equilibrium potentials, and an established formulation for ion channel and pump currents.\n\nThe solution requires the formulation and numerical integration of a system of coupled ordinary differential equations (ODEs) that describe the temporal evolution of intracellular ion concentrations. From these concentrations, the corresponding Nernst reversal potentials are calculated.\n\nThe core of the model is the principle of mass conservation for each ion species $X$. The rate of change of the intracellular concentration, $[\\mathrm{X}]_i$, within a compartment of volume $V$ and surface area $A$ is determined by the net molar flux per unit area, $J_X$, across the membrane:\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V} J_X $$\nThe molar flux $J_X$ is related to the total ionic current density $i_{X, \\text{total}}$ (in $\\mathrm{A/m^2}$) by Faraday's law, $i_{X, \\text{total}} = z_X F J_X$, where $z_X$ is the valence of the ion and $F$ is Faraday's constant. Substituting $J_X$ gives the fundamental equation for concentration dynamics:\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V z_X F} i_{X, \\text{total}} $$\nFor the specified spherical compartment of radius $r$, the surface area is $A=4\\pi r^2$ and the volume is $V = \\frac{4}{3}\\pi r^3$. The surface-area-to-volume ratio simplifies to $\\frac{A}{V} = \\frac{3}{r}$. Thus, the ODE becomes:\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{3}{r z_X F} i_{X, \\text{total}} $$\nThe total current density $i_{X, \\text{total}}$ for each ion is the sum of its passive (Ohmic) leak current and any active transport current (i.e., from the pump). The passive current is given by $i_{X, \\text{leak}} = g_X (V_m - E_X)$, where $g_X$ is the membrane conductance density, $V_m$ is the constant (clamped) membrane potential, and $E_X$ is the Nernst reversal potential. The Nernst potential itself depends on the intracellular and extracellular concentrations, $[\\mathrm{X}]_i$ and $[\\mathrm{X}]_o$:\n$$ E_X = \\frac{RT}{z_X F} \\ln\\left(\\frac{[\\mathrm{X}]_o}{[\\mathrm{X}]_i}\\right) $$\nwhere $R$ is the gas constant and $T$ is the absolute temperature. This dependency of $E_X$ on $[\\mathrm{X}]_i$ makes the system of ODEs non-linear and coupled.\n\nThe sodium-potassium ATPase pump provides an active transport mechanism. It is modeled as generating a net outward current density $i_{\\mathrm{pump}}$, with a dependence on $[\\mathrm{Na}]_i$ and $[\\mathrm{K}]_o$:\n$$ i_{\\mathrm{pump}} = I_{\\max} \\left(\\frac{[\\mathrm{Na}]_i^n}{K_{\\mathrm{Na}}^n + [\\mathrm{Na}]_i^n}\\right) \\left(\\frac{[\\mathrm{K}]_o^m}{K_{\\mathrm{K}}^m + [\\mathrm{K}]_o^m}\\right) $$\nDue to its $3:2$ stoichiometry ($3$ $\\mathrm{Na}^+$ out, $2$ $\\mathrm{K}^+$ in), this pump contributes a current of $3 i_{\\mathrm{pump}}$ to the total sodium current and $-2 i_{\\mathrm{pump}}$ to the total potassium current (where a positive sign denotes outward current).\n\nWith these components, we can write the explicit system of ODEs for the state vector $y(t) = \\left( [\\mathrm{Na}]_i(t), [\\mathrm{K}]_i(t), [\\mathrm{Cl}]_i(t) \\right)$:\n\n1.  **Sodium ($\\mathrm{Na}^+$):** $z_{\\mathrm{Na}} = +1$. The total outward current density is $i_{\\mathrm{Na, total}} = g_{\\mathrm{Na}}(V_m - E_{\\mathrm{Na}}) + 3 i_{\\mathrm{pump}}$.\n    $$ \\frac{d[\\mathrm{Na}]_i}{dt} = -\\frac{3}{r F} \\left( g_{\\mathrm{Na}}\\left(V_m - \\frac{RT}{F}\\ln\\frac{[\\mathrm{Na}]_o}{[\\mathrm{Na}]_i}\\right) + 3 \\cdot \\text{flag}_{\\text{pump}} \\cdot i_{\\mathrm{pump}} \\right) $$\n\n2.  **Potassium ($\\mathrm{K}^+$):** $z_{\\mathrm{K}} = +1$. The total outward current density is $i_{\\mathrm{K, total}} = g_{\\mathrm{K}}(V_m - E_{\\mathrm{K}}) - 2 i_{\\mathrm{pump}}$.\n    $$ \\frac{d[\\mathrm{K}]_i}{dt} = -\\frac{3}{r F} \\left( g_{\\mathrm{K}}\\left(V_m - \\frac{RT}{F}\\ln\\frac{[\\mathrm{K}]_o}{[\\mathrm{K}]_i}\\right) - 2 \\cdot \\text{flag}_{\\text{pump}} \\cdot i_{\\mathrm{pump}} \\right) $$\n\n3.  **Chloride ($\\mathrm{Cl}^-$):** $z_{\\mathrm{Cl}} = -1$. There is no pump component, so $i_{\\mathrm{Cl, total}} = g_{\\mathrm{Cl}}(V_m - E_{\\mathrm{Cl}})$.\n    $$ \\frac{d[\\mathrm{Cl}]_i}{dt} = -\\frac{3}{r (-1) F} \\left( g_{\\mathrm{Cl}}\\left(V_m - \\frac{RT}{-F}\\ln\\frac{[\\mathrm{Cl}]_o}{[\\mathrm{Cl}]_i}\\right) \\right) = \\frac{3 g_{\\mathrm{Cl}}}{r F} \\left( V_m + \\frac{RT}{F}\\ln\\frac{[\\mathrm{Cl}]_o}{[\\mathrm{Cl}]_i} \\right) $$\nThe term $\\text{flag}_{\\text{pump}}$ is $1$ when the pump is active and $0$ otherwise.\n\nTo implement the solution, a Python program is designed. This program defines a function encapsulating the ODE system, which is then passed to a numerical solver from the `scipy.integrate` library, specifically `solve_ivp`. This function takes the current time $t$ and state vector $y$ as inputs and returns the vector of derivatives $dy/dt$. For numerical stability, the concentration $[\\mathrm{X}]_i$ inside any logarithmic term is floored at a small positive value $\\varepsilon$, e.g., $\\ln([\\mathrm{X}]_o / \\max([\\mathrm{X}]_i, \\varepsilon))$.\n\nThe overall computational procedure is as follows:\n1.  Define all physical constants ($F$, $R$, $T$), model parameters ($g_X$, $[\\mathrm{X}]_o$, pump parameters), and initial conditions ($[\\mathrm{X}]_i(0)$).\n2.  Calculate the initial reversal potentials $E_{X, \\text{initial}}$ for all ions using the initial concentrations.\n3.  Iterate through each test case provided in the problem statement.\n4.  For each case, set the specific parameters ($r$, $V_m$, $T_{\\mathrm{end}}$, pump status).\n5.  Invoke `scipy.integrate.solve_ivp` to integrate the ODE system from $t=0$ to $t=T_{\\mathrm{end}}$, starting from the initial concentration vector $y(0) = ([\\mathrm{Na}]_i(0), [\\mathrm{K}]_i(0), [\\mathrm{Cl}]_i(0))$.\n6.  Extract the final concentration vector $y(T_{\\mathrm{end}})$ from the solver's output.\n7.  Calculate the final reversal potentials $E_{X, \\text{final}}$ from the final concentrations.\n8.  Compute the change in reversal potential, $\\Delta E_X = E_{X, \\text{final}} - E_{X, \\text{initial}}$, for each ion.\n9.  Convert the changes $\\Delta E_X$ from Volts to millivolts (by multiplying by $1000$).\n10. The results for all test cases, in the specified order ($\\Delta E_{\\mathrm{K}}$, $\\Delta E_{\\mathrm{Na}}$, $\\Delta E_{\\mathrm{Cl}}$), are aggregated into a single list and formatted into the required output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Simulates ionic concentration and reversal potential dynamics in a single\n    neuronal compartment under voltage clamp.\n    \"\"\"\n    # --- Constants and Global Parameters ---\n    F = 96485.33212  # Faraday's constant in C/mol\n    R = 8.314462618  # Gas constant in J/(mol·K)\n    T_abs = 310.0      # Absolute temperature in K\n    RT_over_F = (R * T_abs) / F  # Thermal voltage in Volts\n\n    # Ion valences\n    z_Na, z_K, z_Cl = 1.0, 1.0, -1.0\n\n    # Membrane conductance densities (S/m^2)\n    g_Na, g_K, g_Cl = 0.001, 0.002, 0.001\n\n    # Extracellular concentrations (mol/m^3, treating mM as mol/m^3)\n    Na_o, K_o, Cl_o = 145.0, 4.0, 110.0\n\n    # Initial intracellular concentrations (mol/m^3)\n    Na_i0, K_i0, Cl_i0 = 15.0, 140.0, 5.0\n    y0 = np.array([Na_i0, K_i0, Cl_i0])\n\n    # Pump parameters\n    I_max = 0.001  # A/m^2\n    K_Na = 10.0    # mol/m^3\n    K_K = 1.5      # mol/m^3\n    n, m = 1.5, 1.5\n    s_K_term = (K_o**m) / (K_K**m + K_o**m) # Constant K-dependent pump term\n\n    # Small epsilon for numerical stability in logarithms\n    epsilon = 1e-9\n\n    # --- Test Cases ---\n    test_cases = [\n        {'r': 10e-6, 'Vm': -20e-3, 'T_end': 10.0, 'pump_on': True},\n        {'r': 5e-6,  'Vm': -10e-3, 'T_end': 10.0, 'pump_on': False},\n        {'r': 25e-6, 'Vm': -20e-3, 'T_end': 10.0, 'pump_on': True},\n        {'r': 10e-6, 'Vm': 0.0,    'T_end': 60.0, 'pump_on': True},\n        {'r': 10e-6, 'Vm': -65e-3, 'T_end': 10.0, 'pump_on': True},\n    ]\n\n    all_results = []\n\n    def odes(t, y, r, Vm, pump_on):\n        \"\"\"\n        Defines the system of ordinary differential equations for ion concentrations.\n        y: state vector [Na_i, K_i, Cl_i]\n        \"\"\"\n        Na_i, K_i, Cl_i = y\n\n        # Apply floor to concentrations to prevent log(0) or division by zero\n        Na_i_safe = max(Na_i, epsilon)\n        K_i_safe = max(K_i, epsilon)\n        Cl_i_safe = max(Cl_i, epsilon)\n\n        # Nernst potentials\n        E_Na = (RT_over_F / z_Na) * np.log(Na_o / Na_i_safe)\n        E_K = (RT_over_F / z_K) * np.log(K_o / K_i_safe)\n        E_Cl = (RT_over_F / z_Cl) * np.log(Cl_o / Cl_i_safe)\n\n        # Pump current density\n        i_pump = 0.0\n        if pump_on:\n            s_Na_term = (Na_i_safe**n) / (K_Na**n + Na_i_safe**n)\n            i_pump = I_max * s_Na_term * s_K_term\n        \n        # Total outward current densities (A/m^2)\n        i_Na_total = g_Na * (Vm - E_Na) + 3.0 * i_pump\n        i_K_total = g_K * (Vm - E_K) - 2.0 * i_pump\n        i_Cl_total = g_Cl * (Vm - E_Cl)\n        \n        # Concentration derivatives (d[X]_i/dt = -(3 / (r * z_X * F)) * i_X_total)\n        dNa_i_dt = -(3.0 / (r * z_Na * F)) * i_Na_total\n        dK_i_dt = -(3.0 / (r * z_K * F)) * i_K_total\n        dCl_i_dt = -(3.0 / (r * z_Cl * F)) * i_Cl_total\n        \n        return [dNa_i_dt, dK_i_dt, dCl_i_dt]\n\n    def calculate_reversals(concentrations):\n        \"\"\"Calculates reversal potentials from a concentration vector.\"\"\"\n        Na_i, K_i, Cl_i = concentrations\n        \n        Na_i_safe = max(Na_i, epsilon)\n        K_i_safe = max(K_i, epsilon)\n        Cl_i_safe = max(Cl_i, epsilon)\n        \n        E_Na = (RT_over_F / z_Na) * np.log(Na_o / Na_i_safe)\n        E_K = (RT_over_F / z_K) * np.log(K_o / K_i_safe)\n        E_Cl = (RT_over_F / z_Cl) * np.log(Cl_o / Cl_i_safe)\n        return E_Na, E_K, E_Cl\n\n    # Calculate initial reversal potentials\n    E_Na_initial, E_K_initial, E_Cl_initial = calculate_reversals(y0)\n\n    for case in test_cases:\n        r, Vm, T_end, pump_on = case['r'], case['Vm'], case['T_end'], case['pump_on']\n        \n        # Solve the ODE system for the current case\n        sol = solve_ivp(\n            fun=odes,\n            t_span=[0, T_end],\n            y0=y0,\n            args=(r, Vm, pump_on),\n            method='RK45'\n        )\n        \n        # Get final concentrations\n        y_final = sol.y[:, -1]\n        \n        # Calculate final reversal potentials\n        E_Na_final, E_K_final, E_Cl_final = calculate_reversals(y_final)\n        \n        # Calculate change in reversal potentials and convert to mV\n        delta_E_Na_mV = (E_Na_final - E_Na_initial) * 1000.0\n        delta_E_K_mV = (E_K_final - E_K_initial) * 1000.0\n        delta_E_Cl_mV = (E_Cl_final - E_Cl_initial) * 1000.0\n        \n        # Append results in specified order: K, Na, Cl\n        all_results.extend([delta_E_K_mV, delta_E_Na_mV, delta_E_Cl_mV])\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.8f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}