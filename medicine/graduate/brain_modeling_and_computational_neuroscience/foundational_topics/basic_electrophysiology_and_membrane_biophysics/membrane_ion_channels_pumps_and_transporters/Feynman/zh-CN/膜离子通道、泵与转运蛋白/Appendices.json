{
    "hands_on_practices": [
        {
            "introduction": "当多种离子可以穿过一个通道时，它们的平衡点不再由单一离子的能斯特电位决定。此练习将引导您使用高盛-霍奇金-卡茨（GHK）电压方程，推导并计算一个对钠离子和钾离子均通透的非选择性阳离子通道的逆转电位。通过这个实践（），您将掌握分析混合离子电流的基础，这是理解神经元中许多关键通道（如突触后受体）电生理特性的核心技能。",
            "id": "3996860",
            "problem": "在一个计算神经元模型中，一个膜片包含一个单一的非选择性阳离子通道群，该通道对钠离子（$\\mathrm{Na}^{+}$）和钾离子（$\\mathrm{K}^{+}$）均可传导。这些通道遵循离子运动的独立性原则和Goldman-Hodgkin-Katz（GHK）框架所基于的恒定场近似。假设溶液为理想溶液，因此活度等于浓度。没有其他可渗透的离子。膜电位定义为细胞内电势减去细胞外电势，即 $V_{m} = \\phi_{\\text{in}} - \\phi_{\\text{out}}$。细胞内和细胞外的浓度如下：\n- $[\\mathrm{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$，$[\\mathrm{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$，\n- $[\\mathrm{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$，$[\\mathrm{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$。\n绝对温度为 $T = 308\\,\\mathrm{K}$，普适气体常数为 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，法拉第常数为 $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。该通道对钠和钾的渗透性相等：$P_{\\mathrm{Na}} = P_{\\mathrm{K}}$。\n\n从电扩散描述出发，在恒定场近似下该描述可导出离子通量的Goldman-Hodgkin-Katz描述，推导出非选择性阳离子通道的反转电位 $V_{\\text{rev}}$，即$\\mathrm{Na}^{+}$ 和 $\\mathrm{K}^{+}$ 承载的净电流为零时的膜电位。然后，根据给定的浓度和参数，计算 $V_{\\text{rev}}$ 的数值。\n\n将您的最终数值答案四舍五入到四位有效数字，并以毫伏（mV）表示。为 $V_{\\text{rev}}$ 提供一个单一的数值。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **任务：** 推导反转电位 $V_{\\text{rev}}$ 并计算其对于一个非选择性阳离子通道的数值。\n- **物理系统：** 一个包含单一非选择性阳离子通道群的膜片，该通道对 $\\mathrm{Na}^{+}$ 和 $\\mathrm{K}^{+}$ 均可渗透。\n- **假设：** 离子运动的独立性原则，恒定场近似（GHK框架），理想溶液（活度=浓度）。\n- **定义：** 膜电位 $V_{m} = \\phi_{\\text{in}} - \\phi_{\\text{out}}$。\n- **离子浓度：**\n    - $[\\mathrm{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$\n    - $[\\mathrm{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$\n    - $[\\mathrm{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$\n    - $[\\mathrm{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$\n- **物理常数：**\n    - 绝对温度 $T = 308\\,\\mathrm{K}$\n    - 普适气体常数 $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n    - 法拉第常数 $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n- **通道特性：** 对钠离子和钾离子的渗透性相等，$P_{\\mathrm{Na}} = P_{\\mathrm{K}}$。\n- **输出要求：**\n    - 将最终数值答案四舍五入到四位有效数字。\n    - 以毫伏（$\\mathrm{mV}$）表示答案。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于生物物理学的既定原理，特别是Nernst-Planck电扩散理论及其在恒定场假设下的简化，这导出了Goldman-Hodgkin-Katz（GHK）方程。这是计算神经科学和细胞生理学中的一个标准和基础模型。所提供的离子浓度对于神经元来说在生理学上是合理的。\n- **适定性：** 问题陈述清晰，并提供了所有必要的参数（$T$, $R$, $F$）、边界条件（浓度）和系统属性（$P_{\\mathrm{Na}} = P_{\\mathrm{K}}$），以推导和计算反转电位 $V_{\\text{rev}}$ 的唯一值。\n- **客观性：** 问题以精确、定量且无偏见的语言表述，不含任何主观性。\n- **完整性和一致性：** 数据和约束条件是自洽且一致的。没有缺失基本参数或矛盾的陈述。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、适定的、客观且完整的。因此，它被判定为**有效**。现在开始求解过程。\n\n反转电位 $V_{\\text{rev}}$ 是指跨膜总净离子电流为零时的膜电位 $V_m$。该通道仅对钠离子（$\\mathrm{Na}^{+}$）和钾离子（$\\mathrm{K}^{+}$）可渗透。因此，总电流 $I_{\\text{total}}$ 是钠电流 $I_{\\mathrm{Na}}$ 和钾电流 $I_{\\mathrm{K}}$ 的和。反转电位的条件是：\n$$I_{\\text{total}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}} = 0$$\n\n题目要求从离子通量的GHK描述出发。对于价态为 $z_S$ 的一般离子种类 $S$，GHK电流方程由下式给出：\n$$I_S = P_S z_S^2 \\frac{F^2 V_m}{RT} \\frac{[S]_{\\text{in}} - [S]_{\\text{out}}\\exp\\left(-\\frac{z_S F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{z_S F V_m}{RT}\\right)}$$\n其中 $P_S$ 是膜对离子 $S$ 的渗透性，$[S]_{\\text{in}}$ 和 $[S]_{\\text{out}}$ 分别是细胞内和细胞外浓度，$V_m$ 是膜电位，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度。\n\n对于钠离子（$\\mathrm{Na}^{+}$）和钾离子（$\\mathrm{K}^{+}$），它们都是单价阳离子，其价态为 $z_{\\mathrm{Na}} = +1$ 和 $z_{\\mathrm{K}} = +1$。相应的电流为：\n$$I_{\\mathrm{Na}} = P_{\\mathrm{Na}} \\frac{F^2 V_m}{RT} \\frac{[\\mathrm{Na}^{+}]_{\\text{in}} - [\\mathrm{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_m}{RT}\\right)}$$\n$$I_{\\mathrm{K}} = P_{\\mathrm{K}} \\frac{F^2 V_m}{RT} \\frac{[\\mathrm{K}^{+}]_{\\text{in}} - [\\mathrm{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_m}{RT}\\right)}$$\n\n在反转电位（$V_m = V_{\\text{rev}}$）时，这些电流之和为零：\n$$I_{\\mathrm{Na}} + I_{\\mathrm{K}} = 0$$\n$$P_{\\mathrm{Na}} \\frac{F^2 V_{\\text{rev}}}{RT} \\frac{[\\mathrm{Na}^{+}]_{\\text{in}} - [\\mathrm{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)} + P_{\\mathrm{K}} \\frac{F^2 V_{\\text{rev}}}{RT} \\frac{[\\mathrm{K}^{+}]_{\\text{in}} - [\\mathrm{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)}{1 - \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)} = 0$$\n\n假设 $V_{\\text{rev}} \\neq 0$，则公共前置因子 $\\frac{F^2 V_{\\text{rev}}}{RT} \\frac{1}{1 - \\exp(-F V_{\\text{rev}}/RT)}$ 非零，可以被约去。这剩下：\n$$P_{\\mathrm{Na}}\\left([\\mathrm{Na}^{+}]_{\\text{in}} - [\\mathrm{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)\\right) + P_{\\mathrm{K}}\\left([\\mathrm{K}^{+}]_{\\text{in}} - [\\mathrm{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)\\right) = 0$$\n\n我们现在求解 $V_{\\text{rev}}$。首先，将包含和不包含指数因子的项分组：\n$$P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{in}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{in}} = P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right) + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{out}}\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)$$\n将右侧的指数项提取出来：\n$$P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{in}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{in}} = \\left(P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{out}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{out}}\\right) \\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right)$$\n分离指数项：\n$$\\exp\\left(-\\frac{F V_{\\text{rev}}}{RT}\\right) = \\frac{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{in}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{in}}}{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{out}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{out}}}$$\n对两边取自然对数：\n$$-\\frac{F V_{\\text{rev}}}{RT} = \\ln\\left(\\frac{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{in}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{in}}}{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{out}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{out}}}\\right)$$\n使用属性 $\\ln(1/x) = -\\ln(x)$，我们可以反转对数的参数并去掉负号：\n$$\\frac{F V_{\\text{rev}}}{RT} = \\ln\\left(\\frac{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{out}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{out}}}{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{in}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{in}}}\\right)$$\n最后，求解 $V_{\\text{rev}}$ 得到这两种离子的Goldman-Hodgkin-Katz电压方程：\n$$V_{\\text{rev}} = \\frac{RT}{F} \\ln\\left(\\frac{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{out}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{out}}}{P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_{\\text{in}} + P_{\\mathrm{K}}[\\mathrm{K}^{+}]_{\\text{in}}}\\right)$$\n\n题目说明该通道对钠和钾具有相等的渗透性：$P_{\\mathrm{Na}} = P_{\\mathrm{K}}$。让我们用 $P$ 表示这个共同的渗透性。$V_{\\text{rev}}$ 的表达式简化为：\n$$V_{\\text{rev}} = \\frac{RT}{F} \\ln\\left(\\frac{P[\\mathrm{Na}^{+}]_{\\text{out}} + P[\\mathrm{K}^{+}]_{\\text{out}}}{P[\\mathrm{Na}^{+}]_{\\text{in}} + P[\\mathrm{K}^{+}]_{\\text{in}}}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{[\\mathrm{Na}^{+}]_{\\text{out}} + [\\mathrm{K}^{+}]_{\\text{out}}}{[\\mathrm{Na}^{+}]_{\\text{in}} + [\\mathrm{K}^{+}]_{\\text{in}}}\\right)$$\n\n现在，我们代入给定的数值：\n- $[\\mathrm{Na}^{+}]_{\\text{in}} = 8\\,\\mathrm{mM}$\n- $[\\mathrm{Na}^{+}]_{\\text{out}} = 160\\,\\mathrm{mM}$\n- $[\\mathrm{K}^{+}]_{\\text{in}} = 100\\,\\mathrm{mM}$\n- $[\\mathrm{K}^{+}]_{\\text{out}} = 3\\,\\mathrm{mM}$\n- $T = 308\\,\\mathrm{K}$\n- $R = 8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $F = 96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n\n细胞外浓度之和为 $[\\mathrm{Na}^{+}]_{\\text{out}} + [\\mathrm{K}^{+}]_{\\text{out}} = 160 + 3 = 163\\,\\mathrm{mM}$。\n细胞内浓度之和为 $[\\mathrm{Na}^{+}]_{\\text{in}} + [\\mathrm{K}^{+}]_{\\text{in}} = 8 + 100 = 108\\,\\mathrm{mM}$。\n\n$$V_{\\text{rev}} = \\frac{(8.314\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1})(308\\,\\mathrm{K})}{96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}} \\ln\\left(\\frac{163}{108}\\right)$$\n项 $\\frac{RT}{F}$ 的单位是 $\\mathrm{J}/\\mathrm{C}$，即伏特 ($\\mathrm{V}$)。\n$$\\frac{RT}{F} \\approx \\frac{2560.712}{96485} \\approx 0.026540\\,\\mathrm{V}$$\n对数的参数是：\n$$\\frac{163}{108} \\approx 1.509259$$\n因此，\n$$V_{\\text{rev}} \\approx (0.026540\\,\\mathrm{V}) \\ln(1.509259)$$\n$$V_{\\text{rev}} \\approx (0.026540\\,\\mathrm{V}) (0.411600)$$\n$$V_{\\text{rev}} \\approx 0.01092518\\,\\mathrm{V}$$\n题目要求答案以毫伏（$\\mathrm{mV}$）表示：\n$$V_{\\text{rev}} \\approx 10.92518\\,\\mathrm{mV}$$\n四舍五入到四位有效数字，我们得到：\n$$V_{\\text{rev}} = 10.93\\,\\mathrm{mV}$$",
            "answer": "$$\n\\boxed{10.93}\n$$"
        },
        {
            "introduction": "膜片上的宏观离子电流是大量独立的、随机开关的单个离子通道电流的总和。此练习将引导您从第一性原理出发，推导总电流的方差与单通道电流、通道数量及其开放概率之间的关系（）。这项实践揭示了通道的随机性如何转化为可测量的宏观噪声，并构成了波动分析（一种用于估算通道数量和单通道电导的强大实验技术）的理论基础。",
            "id": "3996923",
            "problem": "一个神经元的胞体膜片被电压钳制在固定电位，因此离子驱动力是恒定的。该膜片包含 $N$ 个相同且独立的离子通道，每个通道都被建模为一个具有“关闭”和“开放”两种状态的两状态马尔可夫过程。在稳态下，任意给定通道处于开放状态的概率为 $p$，且状态转换相对于采集带宽而言足够快，因此每个采样瞬间的状态都可以被视为一次伯努利试验。当一个通道开放时，它通过一个大小为 $i$ 的单通道电流；当关闭时，它通过的电流为零。假设离子充足，因此单通道电流 $i$ 是确定性的，不会因散粒噪声而波动，并假设除了所规定的独立性之外，通道之间没有相互作用或相关性。\n\n将总膜电流定义为 $I = i \\sum_{k=1}^{N} X_k$，其中 $X_k \\in \\{0,1\\}$ 是指示通道 $k$ 在采样瞬间是否开放的指示变量。仅使用针对独立伯努利随机变量的概率论第一性原理和方差的性质，推导稳态下总电流 $I$ 的方差。将您的最终答案表示为关于 $N$、$p$ 和 $i$ 的单一闭式解析表达式。无需进行数值计算。只提供最终表达式，不附带任何单位。",
            "solution": "该问题要求在特定的稳态条件下，推导总膜电流 $I$ 的方差。总电流由以下表达式给出：\n$$I = i \\sum_{k=1}^{N} X_k$$\n在此式中，$i$ 是确定性的单通道电流大小，$N$ 是相同通道的总数，$X_k$ 是一个随机变量，代表第 $k$ 个通道在给定采样瞬间的状态。\n\n问题陈述，每个通道的状态可以建模为一次伯努利试验。变量 $X_k$ 是一个指示变量，当通道开放时 $X_k = 1$，当通道关闭时 $X_k = 0$。任意给定通道处于开放状态的概率为 $p$。因此，对于每个通道 $k$，$X_k$ 的概率分布为：\n$$P(X_k = 1) = p$$\n$$P(X_k = 0) = 1 - p$$\n这 $N$ 个随机变量 $X_1, X_2, \\dots, X_N$ 被规定为独立的，并且由于通道是相同的，它们也是同分布的。因此，它们是独立同分布 (i.i.d.) 的伯努利随机变量。\n\n我们旨在求出总电流的方差 $\\text{Var}(I)$。我们首先将方差的性质应用于给定的 $I$ 的表达式。方差的一个基本性质表明，对于任意常数 $c$ 和随机变量 $Y$，有 $\\text{Var}(cY) = c^2 \\text{Var}(Y)$。在我们的问题中，单通道电流 $i$ 是一个常数。因此，我们可以写出：\n$$\\text{Var}(I) = \\text{Var}\\left(i \\sum_{k=1}^{N} X_k\\right) = i^2 \\text{Var}\\left(\\sum_{k=1}^{N} X_k\\right)$$\n\n问题指明通道是独立的。对于独立随机变量之和，其和的方差等于它们各自方差的和。这使得我们可以写出：\n$$\\text{Var}\\left(\\sum_{k=1}^{N} X_k\\right) = \\sum_{k=1}^{N} \\text{Var}(X_k)$$\n\n此外，由于所有通道都是相同的，随机变量 $X_k$ 是同分布的。这意味着它们的方差都相等。我们把单个通道状态变量的方差记为 $\\text{Var}(X)$。\n$$\\text{Var}(X_1) = \\text{Var}(X_2) = \\dots = \\text{Var}(X_N) = \\text{Var}(X)$$\n因此，方差之和简化为：\n$$\\sum_{k=1}^{N} \\text{Var}(X_k) = N \\cdot \\text{Var}(X)$$\n\n将这些结果代回到我们关于 $\\text{Var}(I)$ 的表达式中，我们得到：\n$$\\text{Var}(I) = i^2 N \\text{Var}(X)$$\n\n剩下的任务是计算成功概率为 $p$ 的单个伯努利随机变量 $X$ 的方差。方差由公式 $\\text{Var}(X) = E[X^2] - (E[X])^2$ 定义。我们必须首先计算 $X$ 的期望值（均值）。\n$$E[X] = (1) \\cdot P(X=1) + (0) \\cdot P(X=0) = (1)(p) + (0)(1-p) = p$$\n\n接下来，我们计算 $X^2$ 的期望值。由于 $X$ 只能取 0 或 1，变量 $X^2$ 与 $X$ 相同（因为 $0^2 = 0$ 且 $1^2 = 1$）。因此，它们的期望值也相同。\n$$E[X^2] = E[X] = p$$\n\n现在我们可以计算 $X$ 的方差：\n$$\\text{Var}(X) = E[X^2] - (E[X])^2 = p - p^2 = p(1-p)$$\n\n这是伯努利随机变量方差的熟知公式。\n\n最后，我们将这个 $\\text{Var}(X)$ 的表达式代入我们关于总电流方差 $\\text{Var}(I)$ 的方程中：\n$$\\text{Var}(I) = i^2 N p(1-p)$$\n这就是用给定参数 $N$、$p$ 和 $i$ 表示的总电流方差的闭式解析表达式。",
            "answer": "$$\\boxed{N i^2 p (1-p)}$$"
        },
        {
            "introduction": "神经元内的离子浓度并非一成不变，而是随着离子电流的流动而动态变化，而浓度的变化又会反过来改变离子的驱动力和逆转电位，形成一个动态反馈回路。这个综合性练习要求您构建一个计算模型，模拟在持续的膜电位下，被动通道和主动泵如何共同驱动细胞内离子浓度的变化（）。通过亲手编程实现这一动态系统，您将深刻理解离子稳态的维持机制及其在持续神经活动下的脆弱性，这是计算神经科学中的一个核心问题。",
            "id": "3996817",
            "problem": "设计并实现一个完整的程序，模拟在单个等电位神经元隔室中，持续的去极化过程中，恒定的膜离子电流如何驱动细胞内离子浓度的变化，并因此动态地改变反转电位。从以下基本原理出发：每种离子物质的质量守恒，将离子电流与摩尔通量关联的法拉第定律，以及将浓度梯度与反转电位关联的能斯特方程。考虑三种离子：钠离子（$\\mathrm{Na}^+$）、钾离子（$\\mathrm{K}^+$）和氯离子（$\\mathrm{Cl}^-$）。使用一个半径为 $r$ 的球形隔室，其膜面积为 $A = 4\\pi r^2$，细胞内体积为 $V = \\frac{4}{3}\\pi r^3$。假设细胞外浓度恒定，并且膜电位被钳制（电压钳），从而在固定的持续时间内产生持续的去极化。\n\n使用的基本定义和假设如下：\n- 法拉第定律：对于价态为 $z_X$ 的离子种类 $X$，其外向电流密度 $i_X$（单位为 $\\mathrm{A/m^2}$）通过 $i_X = z_X F J_X$ 与单位面积的外向摩尔通量 $J_X$（单位为 $\\mathrm{mol/(m^2\\,s)}$）相关联，其中 $F$ 是法拉第常数（单位为 $\\mathrm{C/mol}$）。细胞内浓度 $[\\mathrm{X}]_i$（单位为 $\\mathrm{mol/m^3}$）根据 $\\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V} J_X = -\\frac{A}{V z_X F} i_X$ 变化。\n- 每种离子的欧姆电流：$i_X = g_X (V_m - E_X)$，其中 $g_X$ 是电导密度（单位为 $\\mathrm{S/m^2}$），$V_m$ 是膜电位（单位为 $\\mathrm{V}$），$E_X$ 是反转电位（单位为 $\\mathrm{V}$）。\n- 能斯特方程：$E_X = \\frac{RT}{z_X F} \\ln\\left(\\frac{[\\mathrm{X}]_o}{[\\mathrm{X}]_i}\\right)$，其中 $R$ 是气体常数（单位为 $\\mathrm{J/(mol\\,K)}$），$T$ 是绝对温度（单位为 $\\mathrm{K}$），$[\\mathrm{X}]_o$ 是细胞外浓度（单位为 $\\mathrm{mol/m^3}$）。\n- 钠钾三磷酸腺苷酶（ATPase）泵电流密度 $i_{\\mathrm{pump}}$（单位为 $\\mathrm{A/m^2}$）是外向的，并且 S 型依赖于细胞内钠离子浓度和细胞外钾离子浓度。其化学计量比为每个循环泵出 $3$ 个 $\\mathrm{Na}^+$ 离子和泵入 $2$ 个 $\\mathrm{K}^+$ 离子，每个循环产生相当于 $+1$ 个元电荷的净外向正电流。将其建模为 $i_{\\mathrm{pump}} = I_{\\max} s_{\\mathrm{Na}} s_{\\mathrm{K}}$，其中 $s_{\\mathrm{Na}} = \\frac{[\\mathrm{Na}]_i^n}{K_{\\mathrm{Na}}^n + [\\mathrm{Na}]_i^n}$ 且 $s_{\\mathrm{K}} = \\frac{[\\mathrm{K}]_o^m}{K_{\\mathrm{K}}^m + [\\mathrm{K}]_o^m}$，其中 $I_{\\max}$ 是最大泵电流密度，$K_{\\mathrm{Na}}$ 和 $K_{\\mathrm{K}}$ 是半饱和常数（单位为 $\\mathrm{mol/m^3}$），$n,m$ 是希尔指数（无量纲）。该泵对钠离子外向电流密度的贡献为 $+3 i_{\\mathrm{pump}}$，对钾离子外向电流密度的贡献为 $-2 i_{\\mathrm{pump}}$。\n\n程序必须在恒定的去极化膜电位 $V_m$ 下，对关于 $[\\mathrm{Na}]_i(t)$、$[\\mathrm{K}]_i(t)$ 和 $[\\mathrm{Cl}]_i(t)$ 的耦合常微分方程（Ordinary Differential Equation, ODE）在指定的时间间隔内进行积分，并计算反转电位 $E_{\\mathrm{Na}}(t)$、$E_{\\mathrm{K}}(t)$ 和 $E_{\\mathrm{Cl}}(t)$ 相对于其初始值的变化。使用绝对温度 $T = 310\\,\\mathrm{K}$。使用细胞外浓度 $[\\mathrm{Na}]_o = 145\\,\\mathrm{mM}$、$[\\mathrm{K}]_o = 4\\,\\mathrm{mM}$ 和 $[\\mathrm{Cl}]_o = 110\\,\\mathrm{mM}$，以及初始细胞内浓度 $[\\mathrm{Na}]_i(0) = 15\\,\\mathrm{mM}$、$[\\mathrm{K}]_i(0) = 140\\,\\mathrm{mM}$ 和 $[\\mathrm{Cl}]_i(0) = 5\\,\\mathrm{mM}$。在内部将 $1\\,\\mathrm{mM}$ 视为 $1\\,\\mathrm{mol/m^3}$。使用电导密度 $g_{\\mathrm{Na}} = 0.001\\,\\mathrm{S/m^2}$、$g_{\\mathrm{K}} = 0.002\\,\\mathrm{S/m^2}$、$g_{\\mathrm{Cl}} = 0.001\\,\\mathrm{S/m^2}$。使用泵参数 $I_{\\max} = 0.001\\,\\mathrm{A/m^2}$、$K_{\\mathrm{Na}} = 10\\,\\mathrm{mol/m^3}$、$K_{\\mathrm{K}} = 1.5\\,\\mathrm{mol/m^3}$、$n = 1.5$ 和 $m = 1.5$。设置价态 $z_{\\mathrm{Na}} = +1$、$z_{\\mathrm{K}} = +1$ 和 $z_{\\mathrm{Cl}} = -1$。\n\n使用任何适合平滑动力学的稳定方法实现 ODE 的数值积分。通过施加一个最小下限（例如，对于某个小的 $\\varepsilon > 0$，将对数内的 $[\\mathrm{X}]_i$ 替换为 $\\max([\\mathrm{X}]_i, \\varepsilon)$）来确保计算 $E_X$ 时浓度的正性，同时在 ODE 中保持正确的质量平衡符号。\n\n测试套件包含五组参数集，涵盖了典型、边缘和边界条件。对于每个测试用例，进行模拟以计算最终的反转电位，并输出所有离子电位的变化（最终值减去初始值），以毫伏（$\\mathrm{mV}$）为单位，表示为浮点数。每个用例的持续膜电位和其他参数如下：\n\n- 情况 1：$r = 10\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -20\\times 10^{-3}\\,\\mathrm{V}$，持续时间 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵开启。\n- 情况 2：$r = 5\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -10\\times 10^{-3}\\,\\mathrm{V}$，持续时间 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵关闭。\n- 情况 3：$r = 25\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -20\\times 10^{-3}\\,\\mathrm{V}$，持续时间 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵开启。\n- 情况 4：$r = 10\\times 10^{-6}\\,\\mathrm{m}$，$V_m = 0\\,\\mathrm{V}$，持续时间 $T_{\\mathrm{end}} = 60\\,\\mathrm{s}$，泵开启。\n- 情况 5：$r = 10\\times 10^{-6}\\,\\mathrm{m}$，$V_m = -65\\times 10^{-3}\\,\\mathrm{V}$，持续时间 $T_{\\mathrm{end}} = 10\\,\\mathrm{s}$，泵开启。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[\\text{result1},\\text{result2},\\text{result3}]$）。对于每个测试用例，输出必须按顺序依次列出反转电位的变化 $\\Delta E_{\\mathrm{K}}$（单位 $\\mathrm{mV}$）、$\\Delta E_{\\mathrm{Na}}$（单位 $\\mathrm{mV}$）和 $\\Delta E_{\\mathrm{Cl}}$（单位 $\\mathrm{mV}$），并将所有测试用例的结果平铺到一个列表中。所有值都必须以 $\\mathrm{mV}$ 为单位表示为浮点数。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、定义明确，并为一次标准的计算神经科学模拟提供了一套完整且一致的参数和方程。\n\n解决方案要求构建并数值积分一个描述细胞内离子浓度随时间演化的耦合常微分方程（ODE）系统。然后，根据这些浓度计算出相应的能斯特反转电位。\n\n该模型的核心是每种离子种类 $X$ 的质量守恒原理。在一个体积为 $V$、表面积为 $A$ 的隔室中，细胞内浓度 $[\\mathrm{X}]_i$ 的变化率由穿过膜的单位面积净摩尔通量 $J_X$ 决定：\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V} J_X $$\n摩尔通量 $J_X$ 通过法拉第定律 $i_{X, \\text{total}} = z_X F J_X$ 与总离子电流密度 $i_{X, \\text{total}}$（单位为 $\\mathrm{A/m^2}$）相关，其中 $z_X$ 是离子的价态，$F$ 是法拉第常数。代入 $J_X$ 得到浓度动力学的基本方程：\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{A}{V z_X F} i_{X, \\text{total}} $$\n对于指定的半径为 $r$ 的球形隔室，其表面积为 $A=4\\pi r^2$，体积为 $V = \\frac{4}{3}\\pi r^3$。表面积与体积之比简化为 $\\frac{A}{V} = \\frac{3}{r}$。因此，该 ODE 变为：\n$$ \\frac{d[\\mathrm{X}]_i}{dt} = -\\frac{3}{r z_X F} i_{X, \\text{total}} $$\n每种离子的总电流密度 $i_{X, \\text{total}}$ 是其被动（欧姆）漏电流和任何主动转运电流（即来自泵的电流）的总和。被动电流由 $i_{X, \\text{leak}} = g_X (V_m - E_X)$ 给出，其中 $g_X$ 是膜电导密度，$V_m$ 是恒定（钳制）的膜电位，$E_X$ 是能斯特反转电位。能斯特电位本身取决于细胞内和细胞外浓度 $[\\mathrm{X}]_i$ 和 $[\\mathrm{X}]_o$：\n$$ E_X = \\frac{RT}{z_X F} \\ln\\left(\\frac{[\\mathrm{X}]_o}{[\\mathrm{X}]_i}\\right) $$\n其中 $R$ 是气体常数，$T$ 是绝对温度。$E_X$ 对 $[\\mathrm{X}]_i$ 的这种依赖性使得该 ODE 系统成为非线性和耦合的。\n\n钠钾 ATPase 泵提供了一种主动转运机制。它被建模为产生一个净外向电流密度 $i_{\\mathrm{pump}}$，该电流密度依赖于 $[\\mathrm{Na}]_i$ 和 $[\\mathrm{K}]_o$：\n$$ i_{\\mathrm{pump}} = I_{\\max} \\left(\\frac{[\\mathrm{Na}]_i^n}{K_{\\mathrm{Na}}^n + [\\mathrm{Na}]_i^n}\\right) \\left(\\frac{[\\mathrm{K}]_o^m}{K_{\\mathrm{K}}^m + [\\mathrm{K}]_o^m}\\right) $$\n由于其 $3:2$ 的化学计量比（$3$ 个 $\\mathrm{Na}^+$ 泵出， $2$ 个 $\\mathrm{K}^+$ 泵入），该泵对总钠电流的贡献为 $3 i_{\\mathrm{pump}}$，对总钾电流的贡献为 $-2 i_{\\mathrm{pump}}$（其中正号表示外向电流）。\n\n有了这些组件，我们可以为状态向量 $y(t) = \\left( [\\mathrm{Na}]_i(t), [\\mathrm{K}]_i(t), [\\mathrm{Cl}]_i(t) \\right)$ 写出显式的 ODE 系统：\n\n1.  **钠离子 ($\\mathrm{Na}^+$):** $z_{\\mathrm{Na}} = +1$。总外向电流密度为 $i_{\\mathrm{Na, total}} = g_{\\mathrm{Na}}(V_m - E_{\\mathrm{Na}}) + 3 i_{\\mathrm{pump}}$。\n    $$ \\frac{d[\\mathrm{Na}]_i}{dt} = -\\frac{3}{r F} \\left( g_{\\mathrm{Na}}\\left(V_m - \\frac{RT}{F}\\ln\\frac{[\\mathrm{Na}]_o}{[\\mathrm{Na}]_i}\\right) + 3 \\cdot \\text{flag}_{\\text{pump}} \\cdot i_{\\mathrm{pump}} \\right) $$\n\n2.  **钾离子 ($\\mathrm{K}^+$):** $z_{\\mathrm{K}} = +1$。总外向电流密度为 $i_{\\mathrm{K, total}} = g_{\\mathrm{K}}(V_m - E_{\\mathrm{K}}) - 2 i_{\\mathrm{pump}}$。\n    $$ \\frac{d[\\mathrm{K}]_i}{dt} = -\\frac{3}{r F} \\left( g_{\\mathrm{K}}\\left(V_m - \\frac{RT}{F}\\ln\\frac{[\\mathrm{K}]_o}{[\\mathrm{K}]_i}\\right) - 2 \\cdot \\text{flag}_{\\text{pump}} \\cdot i_{\\mathrm{pump}} \\right) $$\n\n3.  **氯离子 ($\\mathrm{Cl}^-$):** $z_{\\mathrm{Cl}} = -1$。没有泵的成分，所以 $i_{\\mathrm{Cl, total}} = g_{\\mathrm{Cl}}(V_m - E_{\\mathrm{Cl}})$。\n    $$ \\frac{d[\\mathrm{Cl}]_i}{dt} = -\\frac{3}{r (-1) F} \\left( g_{\\mathrm{Cl}}\\left(V_m - \\frac{RT}{-F}\\ln\\frac{[\\mathrm{Cl}]_o}{[\\mathrm{Cl}]_i}\\right) \\right) = \\frac{3 g_{\\mathrm{Cl}}}{r F} \\left( V_m + \\frac{RT}{F}\\ln\\frac{[\\mathrm{Cl}]_o}{[\\mathrm{Cl}]_i} \\right) $$\n$\\text{flag}_{\\text{pump}}$ 项在泵激活时为 $1$，否则为 $0$。\n\n为了实现该解决方案，设计了一个 Python 程序。该程序定义了一个封装 ODE 系统的函数，然后将此函数传递给 `scipy.integrate` 库中的一个数值求解器，具体来说是 `solve_ivp`。该函数将当前时间 $t$ 和状态向量 $y$ 作为输入，并返回导数向量 $dy/dt$。为保证数值稳定性，任何对数项内的浓度 $[\\mathrm{X}]_i$ 都被限制在一个小的正值 $\\varepsilon$ 作为下限，例如 $\\ln([\\mathrm{X}]_o / \\max([\\mathrm{X}]_i, \\varepsilon))$。\n\n整体计算流程如下：\n1.  定义所有物理常数（$F$, $R$, $T$）、模型参数（$g_X$, $[\\mathrm{X}]_o$，泵参数）和初始条件（$[\\mathrm{X}]_i(0)$）。\n2.  使用初始浓度计算所有离子的初始反转电位 $E_{X, \\text{initial}}$。\n3.  遍历问题陈述中提供的每个测试用例。\n4.  对每个用例，设置特定的参数（$r$, $V_m$, $T_{\\mathrm{end}}$，泵的状态）。\n5.  调用 `scipy.integrate.solve_ivp` 从初始浓度向量 $y(0) = ([\\mathrm{Na}]_i(0), [\\mathrm{K}]_i(0), [\\mathrm{Cl}]_i(0))$ 开始，对 ODE 系统从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 进行积分。\n6.  从求解器的输出中提取最终浓度向量 $y(T_{\\mathrm{end}})$。\n7.  根据最终浓度计算最终反转电位 $E_{X, \\text{final}}$。\n8.  计算每种离子的反转电位变化量 $\\Delta E_X = E_{X, \\text{final}} - E_{X, \\text{initial}}$。\n9.  将变化量 $\\Delta E_X$ 从伏特（Volts）转换为毫伏（millivolts）（通过乘以 $1000$）。\n10. 将所有测试用例的结果，按照指定的顺序（$\\Delta E_{\\mathrm{K}}$，$\\Delta E_{\\mathrm{Na}}$，$\\Delta E_{\\mathrm{Cl}}$），汇总到一个列表中，并格式化为所需的输出字符串。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Simulates ionic concentration and reversal potential dynamics in a single\n    neuronal compartment under voltage clamp.\n    \"\"\"\n    # --- Constants and Global Parameters ---\n    F = 96485.33212  # Faraday's constant in C/mol\n    R = 8.314462618  # Gas constant in J/(mol·K)\n    T_abs = 310.0      # Absolute temperature in K\n    RT_over_F = (R * T_abs) / F  # Thermal voltage in Volts\n\n    # Ion valences\n    z_Na, z_K, z_Cl = 1.0, 1.0, -1.0\n\n    # Membrane conductance densities (S/m^2)\n    g_Na, g_K, g_Cl = 0.001, 0.002, 0.001\n\n    # Extracellular concentrations (mol/m^3, treating mM as mol/m^3)\n    Na_o, K_o, Cl_o = 145.0, 4.0, 110.0\n\n    # Initial intracellular concentrations (mol/m^3)\n    Na_i0, K_i0, Cl_i0 = 15.0, 140.0, 5.0\n    y0 = np.array([Na_i0, K_i0, Cl_i0])\n\n    # Pump parameters\n    I_max = 0.001  # A/m^2\n    K_Na = 10.0    # mol/m^3\n    K_K = 1.5      # mol/m^3\n    n, m = 1.5, 1.5\n    s_K_term = (K_o**m) / (K_K**m + K_o**m) # Constant K-dependent pump term\n\n    # Small epsilon for numerical stability in logarithms\n    epsilon = 1e-9\n\n    # --- Test Cases ---\n    test_cases = [\n        {'r': 10e-6, 'Vm': -20e-3, 'T_end': 10.0, 'pump_on': True},\n        {'r': 5e-6,  'Vm': -10e-3, 'T_end': 10.0, 'pump_on': False},\n        {'r': 25e-6, 'Vm': -20e-3, 'T_end': 10.0, 'pump_on': True},\n        {'r': 10e-6, 'Vm': 0.0,    'T_end': 60.0, 'pump_on': True},\n        {'r': 10e-6, 'Vm': -65e-3, 'T_end': 10.0, 'pump_on': True},\n    ]\n\n    all_results = []\n\n    def odes(t, y, r, Vm, pump_on):\n        \"\"\"\n        Defines the system of ordinary differential equations for ion concentrations.\n        y: state vector [Na_i, K_i, Cl_i]\n        \"\"\"\n        Na_i, K_i, Cl_i = y\n\n        # Apply floor to concentrations to prevent log(0) or division by zero\n        Na_i_safe = max(Na_i, epsilon)\n        K_i_safe = max(K_i, epsilon)\n        Cl_i_safe = max(Cl_i, epsilon)\n\n        # Nernst potentials\n        E_Na = (RT_over_F / z_Na) * np.log(Na_o / Na_i_safe)\n        E_K = (RT_over_F / z_K) * np.log(K_o / K_i_safe)\n        E_Cl = (RT_over_F / z_Cl) * np.log(Cl_o / Cl_i_safe)\n\n        # Pump current density\n        i_pump = 0.0\n        if pump_on:\n            s_Na_term = (Na_i_safe**n) / (K_Na**n + Na_i_safe**n)\n            i_pump = I_max * s_Na_term * s_K_term\n        \n        # Total outward current densities (A/m^2)\n        i_Na_total = g_Na * (Vm - E_Na) + 3.0 * i_pump\n        i_K_total = g_K * (Vm - E_K) - 2.0 * i_pump\n        i_Cl_total = g_Cl * (Vm - E_Cl)\n        \n        # Concentration derivatives (d[X]_i/dt = -(3 / (r * z_X * F)) * i_X_total)\n        dNa_i_dt = -(3.0 / (r * z_Na * F)) * i_Na_total\n        dK_i_dt = -(3.0 / (r * z_K * F)) * i_K_total\n        dCl_i_dt = -(3.0 / (r * z_Cl * F)) * i_Cl_total\n        \n        return [dNa_i_dt, dK_i_dt, dCl_i_dt]\n\n    def calculate_reversals(concentrations):\n        \"\"\"Calculates reversal potentials from a concentration vector.\"\"\"\n        Na_i, K_i, Cl_i = concentrations\n        \n        Na_i_safe = max(Na_i, epsilon)\n        K_i_safe = max(K_i, epsilon)\n        Cl_i_safe = max(Cl_i, epsilon)\n        \n        E_Na = (RT_over_F / z_Na) * np.log(Na_o / Na_i_safe)\n        E_K = (RT_over_F / z_K) * np.log(K_o / K_i_safe)\n        E_Cl = (RT_over_F / z_Cl) * np.log(Cl_o / Cl_i_safe)\n        return E_Na, E_K, E_Cl\n\n    # Calculate initial reversal potentials\n    E_Na_initial, E_K_initial, E_Cl_initial = calculate_reversals(y0)\n\n    for case in test_cases:\n        r, Vm, T_end, pump_on = case['r'], case['Vm'], case['T_end'], case['pump_on']\n        \n        # Solve the ODE system for the current case\n        sol = solve_ivp(\n            fun=odes,\n            t_span=[0, T_end],\n            y0=y0,\n            args=(r, Vm, pump_on),\n            method='RK45'\n        )\n        \n        # Get final concentrations\n        y_final = sol.y[:, -1]\n        \n        # Calculate final reversal potentials\n        E_Na_final, E_K_final, E_Cl_final = calculate_reversals(y_final)\n        \n        # Calculate change in reversal potentials and convert to mV\n        delta_E_Na_mV = (E_Na_final - E_Na_initial) * 1000.0\n        delta_E_K_mV = (E_K_final - E_K_initial) * 1000.0\n        delta_E_Cl_mV = (E_Cl_final - E_Cl_initial) * 1000.0\n        \n        # Append results in specified order: K, Na, Cl\n        all_results.extend([delta_E_K_mV, delta_E_Na_mV, delta_E_Cl_mV])\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.8f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}