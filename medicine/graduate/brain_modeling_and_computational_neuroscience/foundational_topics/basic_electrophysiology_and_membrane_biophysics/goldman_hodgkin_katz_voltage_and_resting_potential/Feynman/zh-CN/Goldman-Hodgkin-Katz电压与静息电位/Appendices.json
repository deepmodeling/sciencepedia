{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将我们带回基本原理。通过从离子通量的能斯特-普朗克方程出发，并应用恒定场近似等关键假设，您将从头开始推导高盛-霍奇金-卡茨（GHK）电压方程。这项练习对于理解静息膜电位的物理基础以及这个著名方程背后所包含的假设至关重要 。",
            "id": "3985073",
            "problem": "一层厚度为 $d$ 的平面脂质膜将细胞内溶液（下标 $i$）与细胞外溶液（下标 $o$）分隔开。该膜对三种单价离子可通透：钾离子（$\\mathrm{K}^{+}$）、钠离子（$\\mathrm{Na}^{+}$）和氯离子（$\\mathrm{Cl}^{-}$）。定义跨膜电位为 $V_{m} = \\phi_{i} - \\phi_{o}$，其中 $\\phi$ 是电势。假设以下基于物理的条件成立：\n- 每种离子的电扩散均为一维稳态过程，遵循 Nernst-Planck 方程，扩散系数为常数，且无化学反应。\n- 膜内电场在空间上均匀（恒定场近似）。\n- 稳态时，跨膜的净离子电流为零。\n\n设相对渗透率为 $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1 : 0.05 : 0.45$。在温度 $T = 310\\,\\text{K}$ 时，离子活度可视为等于其浓度（单位：毫摩尔/升），细胞内和细胞外的体浓度如下：\n$\\left[\\mathrm{K}^{+}\\right]_{i} = 140\\,\\text{mM}$，$\\left[\\mathrm{K}^{+}\\right]_{o} = 5\\,\\text{mM}$，$\\left[\\mathrm{Na}^{+}\\right]_{i} = 12\\,\\text{mM}$，$\\left[\\mathrm{Na}^{+}\\right]_{o} = 145\\,\\text{mM}$，$\\left[\\mathrm{Cl}^{-}\\right]_{i} = 10\\,\\text{mM}$，以及 $\\left[\\mathrm{Cl}^{-}\\right]_{o} = 110\\,\\text{mM}$。\n\n从每种离子的 Nernst-Planck 通量和上述假设出发，推导稳态跨膜电位 $V_{m}$ 的闭合形式表达式，该表达式应使用气体常数 $R$、法拉第常数 $F$、温度 $T$、渗透率 $P_{s}$ 以及细胞内/外浓度来表示，并注意正确处理氯离子的阴离子价态。然后，根据给定数据对 $V_{m}$ 进行数值计算。请用毫伏表示你的最终数值答案，并四舍五入至 $3$ 位有效数字。",
            "solution": "该问题是电生理学基本原理的一个有效应用，并且是良定的。推导和计算 Goldman-Hodgkin-Katz (GHK) 电压所需的所有数据和条件均已提供。下面开始求解。\n\n问题要求从离子通量的 Nernst-Planck 方程出发，在恒定场近似下推导稳态跨膜电位 $V_m$。\n\n对于离子种类 $s$，其通量密度 $J_s$ 的一维 Nernst-Planck 方程为：\n$$ J_s(x) = -D_s \\left( \\frac{d[s](x)}{dx} + \\frac{z_s F}{RT} [s](x) \\frac{d\\phi(x)}{dx} \\right) $$\n其中 $D_s$ 是扩散系数，$[s](x)$ 是在膜上位置 $x$ 处的浓度， $z_s$ 是离子价， $F$ 是法拉第常数， $R$ 是气体常数， $T$ 是绝对温度，$\\phi(x)$ 是电势。坐标 $x$ 从细胞外侧（$x=0$）延伸到细胞内侧（$x=d$）。\n\n问题陈述了恒定场近似，即假设电场 $E = -d\\phi/dx$ 在整个膜上是均匀的。对此从 $x=0$ 到 $x=d$ 积分：\n$$ \\int_{\\phi_o}^{\\phi_i} d\\phi = \\int_{0}^{d} -\\frac{d\\phi}{dx} dx = \\int_{0}^{d} E dx = E d $$\n跨膜电位定义为 $V_m = \\phi_i - \\phi_o$。因此，$V_m = E d$，这意味着 $E = V_m/d$。\n将 $d\\phi/dx = -E = -V_m/d$ 代入 Nernst-Planck 方程可得：\n$$ J_s = -D_s \\left( \\frac{d[s]}{dx} - \\frac{z_s F V_m}{RTd} [s] \\right) $$\n在稳态下，对于所有 $x \\in [0, d]$，每种离子的通量 $J_s$ 必须是常数。我们可以将其重排为关于 $[s](x)$ 的一阶线性常微分方程：\n$$ \\frac{d[s]}{dx} - \\left(\\frac{z_s F V_m}{RTd}\\right) [s] = -\\frac{J_s}{D_s} $$\n为解此方程，我们使用积分因子 $I(x) = \\exp\\left(-\\int \\frac{z_s F V_m}{RTd} dx\\right) = \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right)$。\n将常微分方程乘以 $I(x)$：\n$$ \\frac{d}{dx}\\left( [s](x) \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right) = -\\frac{J_s}{D_s} \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) $$\n我们使用边界条件 $[s](0) = [s]_o$（细胞外浓度）和 $[s](d) = [s]_i$（细胞内浓度），对此表达式在膜上从 $x=0$ 到 $x=d$进行积分：\n$$ \\int_0^d \\frac{d}{dx}\\left( [s](x) \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right) dx = -\\frac{J_s}{D_s} \\int_0^d \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) dx $$\n$$ \\left[ [s](x) \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right]_0^d = -\\frac{J_s}{D_s} \\left[ \\frac{-RTd}{z_s F V_m} \\exp\\left(-\\frac{z_s F V_m x}{RTd}\\right) \\right]_0^d $$\n$$ [s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - [s]_o = \\frac{J_s RTd}{D_s z_s F V_m} \\left( \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - 1 \\right) $$\n求解通量 $J_s$：\n$$ J_s = \\frac{D_s z_s F V_m}{RTd} \\frac{[s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - 1} $$\n离子电流密度为 $I_s = z_s F J_s$。膜渗透率定义为 $P_s = D_s/d$。代入这些量，得到种类 $s$ 的 Goldman-Hodgkin-Katz 电流方程：\n$$ I_s = P_s z_s^2 \\frac{F^2 V_m}{RT} \\frac{[s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(-\\frac{z_s F V_m}{RT}\\right) - 1} $$\n将分子和分母同乘以 $-\\exp\\left(\\frac{z_s F V_m}{RT}\\right)$，得到更常规的形式：\n$$ I_s = P_s z_s^2 \\frac{F^2 V_m}{RT} \\frac{[s]_o - [s]_i \\exp\\left(\\frac{z_s F V_m}{RT}\\right)}{1 - \\exp\\left(\\frac{z_s F V_m}{RT}\\right)} $$\n问题指出，在稳态下，跨膜的净离子电流为零：\n$$ I_{net} = \\sum_s I_s = I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0 $$\n对于阳离子 $\\mathrm{K}^{+}$ 和 $\\mathrm{Na}^{+}$，价态 $z_s = +1$。对于阴离子 $\\mathrm{Cl}^{-}$，价态 $z_s = -1$。\n我们定义一个无量纲电压 $u = \\frac{F V_m}{RT}$。\n对于阳离子（$z_s = +1$）：\n$$ I_{cat} = P_{cat} \\frac{F^2 V_m}{RT} \\frac{[cat]_o - [cat]_i \\exp(u)}{1 - \\exp(u)} $$\n对于阴离子 $\\mathrm{Cl}^{-}$（$z_s = -1$）：\n$$ I_{\\mathrm{Cl}} = P_{\\mathrm{Cl}} (-1)^2 \\frac{F^2 V_m}{RT} \\frac{[\\mathrm{Cl}^{-}]_o - [\\mathrm{Cl}^{-}]_i \\exp(-u)}{1 - \\exp(-u)} $$\n为了对电流求和，我们必须有一个公分母。我们处理阴离子电流项，将其分子和分母同乘以 $-\\exp(u)$：\n$$ I_{\\mathrm{Cl}} = P_{\\mathrm{Cl}} \\frac{F^2 V_m}{RT} \\frac{\\left([\\mathrm{Cl}^{-}]_o - [\\mathrm{Cl}^{-}]_i \\exp(-u)\\right) \\times (-\\exp(u))}{\\left(1 - \\exp(-u)\\right) \\times (-\\exp(u))} = P_{\\mathrm{Cl}} \\frac{F^2 V_m}{RT} \\frac{-[\\mathrm{Cl}^{-}]_o \\exp(u) + [\\mathrm{Cl}^{-}]_i}{-\\exp(u) + 1} $$\n$$ I_{\\mathrm{Cl}} = P_{\\mathrm{Cl}} \\frac{F^2 V_m}{RT} \\frac{[\\mathrm{Cl}^{-}]_i - [\\mathrm{Cl}^{-}]_o \\exp(u)}{1 - \\exp(u)} $$\n现在我们将电流求和至零。假设 $V_m \\neq 0$，公共因子 $ \\frac{F^2 V_m}{RT} \\frac{1}{1 - \\exp(u)} $ 可以被消去：\n$$ P_{\\mathrm{K}}([\\mathrm{K}^{+}]_o - [\\mathrm{K}^{+}]_i \\exp(u)) + P_{\\mathrm{Na}}([\\mathrm{Na}^{+}]_o - [\\mathrm{Na}^{+}]_i \\exp(u)) + P_{\\mathrm{Cl}}([\\mathrm{Cl}^{-}]_i - [\\mathrm{Cl}^{-}]_o \\exp(u)) = 0 $$\n将含有 $\\exp(u)$ 的项分组：\n$$ \\left( P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i \\right) = \\exp(u) \\left( P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o \\right) $$\n求解 $\\exp(u)$：\n$$ \\exp(u) = \\frac{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i }{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o } $$\n代回 $u = F V_m / RT$ 并求解 $V_m$，我们得到 GHK 电压方程：\n$$ V_m = \\frac{RT}{F} \\ln \\left( \\frac{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i }{ P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o } \\right) $$\n这就是所求的闭合形式表达式。注意由于氯离子的负价态，其浓度项是如何“翻转”的（细胞内浓度在分子上，细胞外浓度在分母上）。\n\n现在，我们对 $V_m$ 进行数值计算。物理常数为 $R \\approx 8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ 和 $F \\approx 96485\\,\\text{C}\\,\\text{mol}^{-1}$。\n首先，计算在 $T = 310\\,\\text{K}$ 时的热电压项 $\\frac{RT}{F}$：\n$$ \\frac{RT}{F} = \\frac{(8.314\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1})(310\\,\\text{K})}{96485\\,\\text{C}\\,\\text{mol}^{-1}} \\approx 0.026712\\,\\text{V} $$\n问题给出的相对渗透率为 $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1 : 0.05 : 0.45$。我们可以直接使用这些值，因为只有它们的比率才重要。\n浓度为（单位 $\\text{mM}$）：\n$[\\mathrm{K}^{+}]_{i} = 140$, $[\\mathrm{K}^{+}]_{o} = 5$\n$[\\mathrm{Na}^{+}]_{i} = 12$, $[\\mathrm{Na}^{+}]_{o} = 145$\n$[\\mathrm{Cl}^{-}]_{i} = 10$, $[\\mathrm{Cl}^{-}]_{o} = 110$\n\n计算对数参数的分子：\n$$ \\text{分子} = P_{\\mathrm{K}}[\\mathrm{K}^{+}]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_i $$\n$$ \\text{分子} = (1)(5) + (0.05)(145) + (0.45)(10) = 5 + 7.25 + 4.5 = 16.75 $$\n计算对数参数的分母：\n$$ \\text{分母} = P_{\\mathrm{K}}[\\mathrm{K}^{+}]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^{+}]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^{-}]_o $$\n$$ \\text{分母} = (1)(140) + (0.05)(12) + (0.45)(110) = 140 + 0.6 + 49.5 = 190.1 $$\n现在，计算 $V_m$：\n$$ V_m = (0.026712\\,\\text{V}) \\ln\\left(\\frac{16.75}{190.1}\\right) \\approx (0.026712\\,\\text{V}) \\ln(0.0881115) $$\n$$ V_m \\approx (0.026712\\,\\text{V})(-2.4291) \\approx -0.064917\\,\\text{V} $$\n转换为毫伏： $V_m \\approx -64.917\\,\\text{mV}$。\n四舍五入至 $3$ 位有效数字，我们得到 $V_m = -64.9\\,\\text{mV}$。",
            "answer": "$$\\boxed{-64.9}$$"
        },
        {
            "introduction": "对静息电位进行静态计算固然有用，但理解它如何随参数变化则更为重要。本练习引入了敏感性分析的概念，要求您计算当细胞外钾离子浓度发生微小变化时，膜电位会改变多少。通过推导并计算偏导数 $\\frac{\\partial V_{m}}{\\partial [K]_{o}}$，您将定量地证实钾离子对静息电位的深远影响——这是神经生理学的一个基石 。",
            "id": "3985046",
            "problem": "一个处于生理温度下的球形神经元，在恒定场近似下，单价离子穿过一层薄膜表现出稳态电扩散。从离子通量的 Nernst–Planck 描述和静息时跨膜净电流为零的要求出发，在 Goldman–Hodgkin–Katz (GHK) 框架内，推导膜电位 $V_{m}$ 作为离子渗透性以及细胞内/外浓度的函数。然后，将细胞外钾离子浓度 $[K]_{o}$ 视为变量，所有其他参数视为常数，推导偏导数 $\\frac{\\partial V_{m}}{\\partial [K]_{o}}$ 的显式闭合形式表达式。\n\n使用以下参数（所有浓度单位为毫摩尔/升，渗透性为相对无量纲权重），在典型静息状态下对此导数进行数值计算：\n- 温度：$T = 310\\,\\mathrm{K}$，\n- 气体常数：$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，\n- 法拉第常数：$F = 96485.33212\\,\\mathrm{C\\,mol^{-1}}$，\n- 渗透性：$P_{K} = 1.0$， $P_{Na} = 0.05$， $P_{Cl} = 0.45$，\n- 细胞内浓度：$[K]_{i} = 140$， $[Na]_{i} = 12$， $[Cl]_{i} = 10$，\n- 细胞外浓度：$[K]_{o} = 4$， $[Na]_{o} = 145$， $[Cl]_{o} = 110$。\n\n假设钾和钠是化合价为+1的单价阳离子，氯是化合价为-1的单价阴离子。请以毫伏特/毫摩尔每升（mV/mM）为单位表示您最终的 $\\frac{\\partial V_{m}}{\\partial [K]_{o}}$ 数值结果。将您的答案四舍五入到三位有效数字。您的最终答案必须是一个数字。",
            "solution": "适用的基本原理是在恒定场近似下离子通过膜的稳态电扩散。对于每种化合价为 $z_{i}$ 的离子 $i$，其穿过膜的一维 Nernst–Planck 通量密度为\n$$\nJ_{i} \\;=\\; -D_{i}\\left(\\frac{d C_{i}}{dx} + \\frac{z_{i} F}{R T}\\, C_{i}\\, \\frac{d \\phi}{dx}\\right),\n$$\n其中 $D_{i}$ 是扩散系数，$C_{i}$ 是浓度，$\\phi$ 是电势，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是绝对温度。在恒定场近似下，$\\frac{d \\phi}{dx}$ 在整个膜上是恒定的。对厚度为 $L$ 的膜进行积分，并定义渗透性 $P_{i} = D_{i}/L$，可得到 Goldman–Hodgkin–Katz 通量表达式\n$$\nJ_{i} \\;=\\; \\frac{P_{i} z_{i}^{2} F^{2} V_{m}}{R T}\\,\\frac{C_{i}^{\\mathrm{in}} - C_{i}^{\\mathrm{out}} \\exp\\!\\left(-\\frac{z_{i} F V_{m}}{R T}\\right)}{1 - \\exp\\!\\left(-\\frac{z_{i} F V_{m}}{R T}\\right)},\n$$\n其中 $V_{m} = \\phi^{\\mathrm{in}} - \\phi^{\\mathrm{out}}$ 是膜电位，$C_{i}^{\\mathrm{in}}$/$C_{i}^{\\mathrm{out}}$ 表示细胞内/外浓度。总跨膜电流密度是各离子电流之和 $I = \\sum_{i} z_{i} F J_{i}$。在稳态（静息）下，净电流为零：\n$$\n\\sum_{i} z_{i} F J_{i} \\;=\\; 0.\n$$\n对于单价离子 $z_{K} = z_{Na} = +1$ 和 $z_{Cl} = -1$，求解零电流条件可得出著名的用于计算静息膜电位的 Goldman–Hodgkin–Katz 电压关系式：\n$$\nV_{m} \\;=\\; \\frac{R T}{F}\\,\\ln\\!\\left(\\frac{P_{K}[K]_{o} + P_{Na}[Na]_{o} + P_{Cl}[Cl]_{i}}{P_{K}[K]_{i} + P_{Na}[Na]_{i} + P_{Cl}[Cl]_{o}}\\right).\n$$\n氯离子项的位置反映了其负化合价（对于阴离子，分子和分母中的细胞内和细胞外浓度位置互换）。\n\n定义分子和分母函数\n$$\nA([K]_{o}) \\;=\\; P_{K}[K]_{o} + P_{Na}[Na]_{o} + P_{Cl}[Cl]_{i}, \\qquad\nB \\;=\\; P_{K}[K]_{i} + P_{Na}[Na]_{i} + P_{Cl}[Cl]_{o},\n$$\n其中 $B$ 与 $[K]_{o}$ 无关。则\n$$\nV_{m}([K]_{o}) \\;=\\; \\frac{R T}{F}\\,\\ln\\!\\left(\\frac{A([K]_{o})}{B}\\right).\n$$\n对 $[K]_{o}$ 求导：\n$$\n\\frac{\\partial V_{m}}{\\partial [K]_{o}} \\;=\\; \\frac{R T}{F}\\,\\frac{1}{A([K]_{o})/B}\\,\\frac{1}{B}\\frac{\\partial A}{\\partial [K]_{o}} \\;=\\; \\frac{R T}{F}\\,\\frac{P_{K}}{A([K]_{o})}.\n$$\n这就是 GHK 电压对细胞外钾离子的闭合形式灵敏度。\n\n接下来，在指定的静息状态下进行数值计算。根据给定的参数值计算 $A$：\n$$\nA \\;=\\; P_{K}[K]_{o} + P_{Na}[Na]_{o} + P_{Cl}[Cl]_{i}\n\\;=\\; (1.0)\\cdot 4 + (0.05)\\cdot 145 + (0.45)\\cdot 10\n\\;=\\; 4 + 7.25 + 4.5 \\;=\\; 15.75.\n$$\n计算热电压因子：\n$$\n\\frac{R T}{F} \\;=\\; \\frac{(8.314462618)\\times (310)}{96485.33212} \\;\\mathrm{V}\n\\;\\approx\\; 0.02672\\;\\mathrm{V}.\n$$\n因此，\n$$\n\\frac{\\partial V_{m}}{\\partial [K]_{o}} \\;=\\; \\frac{0.02672\\;\\mathrm{V}}{15.75}\\;\\mathrm{per\\ mM}\n\\;\\approx\\; 0.001697\\;\\mathrm{V\\ per\\ mM}.\n$$\n以毫伏特/毫摩尔每升表示，\n$$\n0.001697\\;\\mathrm{V\\ per\\ mM} \\;=\\; 1.697\\;\\mathrm{mV\\ per\\ mM}.\n$$\n四舍五入到三位有效数字，所求的灵敏度在指定单位下为 $1.70$。",
            "answer": "$$\\boxed{1.70}$$"
        },
        {
            "introduction": "我们最后的练习将构建一个更完整的神经元生物物理模型。真实的细胞膜不完全是被动的；它们包含像钠钾泵这样的主动转运蛋白，这些蛋白消耗能量来维持浓度梯度，并且通常是生电性的。在这个问题中，您需要将一个恒定的泵电流整合到电荷平衡方程中，并求解由此产生的膜电位，在该电位下，被动泄漏电流和主动泵电流的总和为零。这项练习将视角从GHK电压方程转移到更通用的GHK电流平衡上，并需要使用数值方法来寻找解 。",
            "id": "3985075",
            "problem": "考虑一个单室神经元膜，其上有针对钾离子（$K^+$）、钠离子（$Na^+$）和氯离子（$Cl^-$）的三种被动泄漏通道，以及一个产生净外向电流密度的生电性钠钾泵。假设跨膜电场为恒定场（与位置无关），且系统处于稳态，其中细胞内和细胞外的离子浓度由与膜充电时间相比足够慢的动力学过程维持恒定。设化合价为 $z_{K} = +1$，$z_{Na} = +1$ 和 $z_{Cl} = -1$。净稳态膜电流密度 $J_{\\text{tot}}(V_m)$ 遵循符号约定，即正值对应正电荷的净外向移动（等效于正电流流出细胞）。在稳态下，该电流密度必须满足电荷守恒：在静息电位 $V_m^\\ast$ 时，所有离子泄漏电流密度与泵电流密度之和为零。\n\n从第一性原理出发——即粒子数守恒、由均匀电场引起的漂移所增强的 Fick 扩散定律，以及电化学势的 Boltzmann 关系——推导每种离子物质的膜电流密度作为膜电位 $V_m$ 的函数表达式，并对下面的每个参数集，确定满足 $J_{\\text{tot}}(V_m^\\ast) = 0$ 的静息电位 $V_m^\\ast$。最终答案必须以伏特为单位，并四舍五入到六位小数。使用以下常数：法拉第常数 $F = 96485\\,\\text{C}/\\text{mol}$，通用气体常数 $R = 8.314\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$，以及绝对温度 $T = 310\\,\\text{K}$。\n\n对所有测试用例，使用以下固定的离子浓度：\n- 细胞内浓度：$[K^+]_{\\text{in}} = 140\\,\\text{mM}$，$[Na^+]_{\\text{in}} = 15\\,\\text{mM}$，$[Cl^-]_{\\text{in}} = 10\\,\\text{mM}$。\n- 细胞外浓度：$[K^+]_{\\text{out}} = 5\\,\\text{mM}$，$[Na^+]_{\\text{out}} = 145\\,\\text{mM}$，$[Cl^-]_{\\text{out}} = 110\\,\\text{mM}$。\n\n计算时，将 $1\\,\\text{mM}$ 视为 $1\\,\\text{mol}/\\text{m}^3$。膜泵产生净外向电流密度 $I_{\\text{pump}}$（单位为 $\\mu\\text{A}/\\text{cm}^2$）。使用 $1\\,\\mu\\text{A}/\\text{cm}^2 = 10^{-2}\\,\\text{A}/\\text{m}^2$ 将 $I_{\\text{pump}}$ 转换为安培/平方米。泄漏渗透率 $P_K$、$P_{Na}$、$P_{Cl}$ 以米/秒为单位给出。\n\n您的任务是：\n- 在恒定场假设下，从第一性原理构建 $J_{\\text{tot}}(V_m)$，使得 $J_{\\text{tot}}(V_m) = J_K(V_m) + J_{Na}(V_m) + J_{Cl}(V_m) + I_{\\text{pump}}$，并对下面的每个测试用例求解 $J_{\\text{tot}}(V_m^\\ast) = 0$ 以得到 $V_m^\\ast$。\n- 通过使用从您的公式中推导出的适当极限表达式，确保在 $V_m = 0$ 伏特附近的计算具有数值稳定性。\n- 结果以伏特为单位，保留六位小数。\n\n测试套件（每个元组为 $(I_{\\text{pump}}, P_K, P_{Na}, P_{Cl})$）：\n1. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n2. $(0\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n3. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 0\\,\\text{m/s})$。\n4. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-8}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[v_1,v_2,v_3,v_4]$），其中每个 $v_i$ 是相应测试用例计算出的 $V_m^\\ast$（以伏特为单位），并四舍五入到六位小数。",
            "solution": "### 第一步：提取已知条件\n问题提供了以下信息：\n- **离子种类**：钾离子（$K^+$）、钠离子（$Na^+$）、氯离子（$Cl^-$）。\n- **化合价**：$z_K = +1$，$z_{Na} = +1$，$z_{Cl} = -1$。\n- **常数**：\n    - 法拉第常数：$F = 96485\\,\\text{C}/\\text{mol}$。\n    - 通用气体常数：$R = 8.314\\,\\text{J}/(\\text{mol}\\cdot\\text{K})$。\n    - 绝对温度：$T = 310\\,\\text{K}$。\n- **细胞内浓度**：\n    - $[K^+]_{\\text{in}} = 140\\,\\text{mM}$\n    - $[Na^+]_{\\text{in}} = 15\\,\\text{mM}$\n    - $[Cl^-]_{\\text{in}} = 10\\,\\text{mM}$\n- **细胞外浓度**：\n    - $[K^+]_{\\text{out}} = 5\\,\\text{mM}$\n    - $[Na^+]_{\\text{out}} = 145\\,\\text{mM}$\n    - $[Cl^-]_{\\text{out}} = 110\\,\\text{mM}$\n- **浓度的单位约定**：$1\\,\\text{mM}$ 被视为 $1\\,\\text{mol}/\\text{m}^3$。\n- **泵电流密度**：$I_{\\text{pump}}$ 以 $\\mu\\text{A}/\\text{cm}^2$ 为单位给出。\n- **电流密度的单位约定**：$1\\,\\mu\\text{A}/\\text{cm}^2 = 10^{-2}\\,\\text{A}/\\text{m}^2$。\n- **渗透率**：$P_K$、$P_{Na}$、$P_{Cl}$ 以 $\\text{m/s}$ 为单位给出。\n- **稳态下的控制方程**：总膜电流密度 $J_{\\text{tot}}(V_m)$ 是各离子电流密度与泵电流密度之和。在静息电位 $V_m^\\ast$ 时，此和必须为零：\n$$J_{\\text{tot}}(V_m^\\ast) = J_K(V_m^\\ast) + J_{Na}(V_m^\\ast) + J_{Cl}(V_m^\\ast) + I_{\\text{pump}} = 0$$\n- **假设**：稳态、恒定场近似。\n- **测试套件**：提供了四个需要计算 $V_m^\\ast$ 的 $(I_{\\text{pump}}, P_K, P_{Na}, P_{Cl})$ 元组。\n    1. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n    2. $(0\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n    3. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-7}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 0\\,\\text{m/s})$。\n    4. $(50\\,\\mu\\text{A}/\\text{cm}^2,\\; 1\\times 10^{-8}\\,\\text{m/s},\\; 5\\times 10^{-9}\\,\\text{m/s},\\; 4.5\\times 10^{-8}\\,\\text{m/s})$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题要求推导并应用 Goldman-Hodgkin-Katz (GHK) 电流方程，并辅以生电性泵电流，以求出神经元的静息电位。\n- **科学依据**：该问题基于电扩散的基本原理，如 Nernst-Planck 方程所述，以及恒定场假设，这两者共同导出了 GHK 方程。这些是生物物理学和计算神经科学中的经典且成熟的模型。不存在伪科学或事实错误。\n- **适定性**：该问题用定义总电流函数 $J_{\\text{tot}}(V_m)$ 所需的一整套参数（浓度、渗透率、常数、泵电流）进行了规定。函数 $J_{\\text{tot}}(V_m)$ 是单调的，确保在生理学上合理的范围内存在唯一的根 $V_m^\\ast$。\n- **客观性**：该问题使用精确的定量语言和公认的科学术语进行陈述。没有主观或含糊的陈述。\n- **无其他缺陷**：该问题不是比喻性的，与指定主题直接相关，不完整或不矛盾，没有提出不切实际的条件，结构不良，不是微不足道的，并且是科学上可验证的。\n\n### 第三步：结论与行动\n该问题有效。将提供严谨的解决方案。\n\n### 求解推导与方法\n求解过程需要找到满足稳态下跨膜净电流为零条件的静息膜电位 $V_m^\\ast$。这涉及推导每种离子的电流-电压关系，然后数值求解总电流为零时的电位。\n\n**1. Goldman-Hodgkin-Katz (GHK) 电流方程的推导**\n离子物质 $s$ 跨膜的运动受浓度梯度引起的扩散和电场引起的漂移共同控制。膜上位置 $x$ 处的一维通量密度 $j_s(x)$ 由 Nernst-Planck 方程描述：\n$$j_s(x) = -D_s \\left( \\frac{d[s](x)}{dx} + \\frac{z_s F}{RT} [s](x) \\frac{d\\phi(x)}{dx} \\right)$$\n其中 $D_s$ 是扩散系数，$[s](x)$ 是浓度，$z_s$ 是化合价，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是温度，$\\phi(x)$ 是电势。\n\nGHK 模型依赖于**恒定场假设**，该假设假定电场 $E = -d\\phi/dx$ 在厚度为 $L$ 的膜上是均匀的。因此，$E = (V_{\\text{in}} - V_{\\text{out}})/L = V_m/L$。\n在此假设下，并在稳态（$j_s(x)$ 为常数）时，Nernst-Planck 方程可以从 $x=0$（外侧）到 $x=L$（内侧）对整个膜进行积分。通量 $j_s$ 的解为：\n$$j_s = P_s \\frac{z_s F V_m}{RT} \\frac{[s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT})}{\\exp(-\\frac{z_sFV_m}{RT}) - 1}$$\n其中 $P_s=D_s/L$ 是该离子的膜渗透率。\n\n由该离子物质携带的电流密度 $J_s$ 为 $J_s = z_s F j_s$。代入 $j_s$ 的表达式并重新整理，得到 GHK 电流方程：\n$$J_s(V_m) = P_s \\frac{(z_sF)^2 V_m}{RT} \\frac{[s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT})}{1 - \\exp(-\\frac{z_sFV_m}{RT})}$$\n符号约定为正电流对应正电荷的净外向流动。此方程通过代入相应的化合价 $z_s$，对所有离子（$K^+$、$Na^+$、$Cl^-$）均有效。\n\n**2. $V_m \\to 0$ 时的数值稳定性**\nGHK 方程在 $V_m = 0$ 时形式为 $0/0$，需要一个极限表达式以保证数值稳定性。我们可以使用洛必达法则 (L'Hôpital's rule) 来求此极限。我们分析依赖于 $V_m$ 的项：\n$$ \\lim_{V_m \\to 0} \\frac{V_m \\left( [s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT}) \\right)}{1 - \\exp(-\\frac{z_sFV_m}{RT})} $$\n设分子为 $N(V_m)$，分母为 $D(V_m)$。\n对 $V_m$ 的导数是：\n$$ N'(V_m) = \\left( [s]_{\\text{in}} - [s]_{\\text{out}}\\exp(-\\frac{z_sFV_m}{RT}) \\right) + V_m \\left( [s]_{\\text{out}} \\frac{z_sF}{RT} \\exp(-\\frac{z_sFV_m}{RT}) \\right) $$\n$$ D'(V_m) = \\frac{z_sF}{RT} \\exp(-\\frac{z_sFV_m}{RT}) $$\n计算当 $V_m \\to 0$ 时的极限：\n$$ \\lim_{V_m \\to 0} N'(V_m) = [s]_{\\text{in}} - [s]_{\\text{out}} $$\n$$ \\lim_{V_m \\to 0} D'(V_m) = \\frac{z_sF}{RT} $$\n将这些代入 $J_s(V_m)$ 的极限表达式中：\n$$ \\lim_{V_m \\to 0} J_s(V_m) = P_s \\frac{(z_sF)^2}{RT} \\left( \\frac{[s]_{\\text{in}} - [s]_{\\text{out}}}{z_sF/RT} \\right) = P_s z_s F ([s]_{\\text{in}} - [s]_{\\text{out}}) $$\n这个线性近似将用于 $|V_m|$ 接近零的计算。\n\n**3. 总电流与数值解**\n跨膜总电流密度是各离子泄漏电流与生电性泵电流之和：\n$$J_{\\text{tot}}(V_m) = J_K(V_m) + J_{Na}(V_m) + J_{Cl}(V_m) + I_{\\text{pump}}$$\n静息电位 $V_m^\\ast$ 是净电流为零时的膜电位：$J_{\\text{tot}}(V_m^\\ast) = 0$。这是一个超越方程，没有 $V_m^\\ast$ 的闭式解析解。因此，必须使用数值求根算法来求解。Brent 方法是一个极佳的选择，因为它鲁棒性强，并且如果在函数值变号的区间内，可以保证收敛。$V_m^\\ast$ 的搜索区间可以合理地由所涉及离子的最极端 Nernst 电位来界定，例如从 $-0.2\\,\\text{V}$ 到 $+0.2\\,\\text{V}$。\n\n**4. 参数与单位管理**\n所有计算都将在一致的国际单位制（SI）下进行：\n- 电位（$V_m$）：伏特（V）\n- 渗透率（$P_s$）：米/秒（m/s）\n- 浓度（$[s]$）：摩尔/立方米（mol/m³）\n- 电流密度（$J_s, I_{\\text{pump}}$）：安培/平方米（A/m²）\n- 常数 $F$、$R$、$T$ 使用其标准国际单位制单位。\n\n给定的泵电流 $I_{\\text{pump}}$ 单位为 $\\mu\\text{A}/\\text{cm}^2$，使用转换因子 $1\\,\\mu\\text{A}/\\text{cm}^2 = 10^{-2}\\,\\text{A}/\\text{m}^2$ 转换为 A/m²。根据指示，单位为 mM 的浓度在计算中被视为 mol/m³。这是正确的，因为 $1\\,\\text{mM} = 10^{-3}\\,\\text{mol/L}$，并且 $1\\,\\text{L} = 10^{-3}\\,\\text{m}^3$，因此 $1\\,\\text{mM} = (10^{-3}\\,\\text{mol}) / (10^{-3}\\,\\text{m}^3) = 1\\,\\text{mol/m}^3$。\n\n基于这些原理，将实现一个 Python 脚本来为每个测试用例计算 $V_m^\\ast$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the resting membrane potential Vm* for a single-compartment neuron model\n    by solving the Goldman-Hodgkin-Katz (GHK) current balance equation.\n    \"\"\"\n\n    # --- Define Constants and Fixed Parameters ---\n    F = 96485.0  # Faraday's constant (C/mol)\n    R = 8.314    # Universal gas constant (J/(mol*K))\n    T = 310.0    # Absolute temperature (K)\n\n    # Unit conversion factor for pump current from uA/cm^2 to A/m^2\n    PUMP_UNIT_CONVERSION = 1e-2\n\n    # Ion concentrations (mM, treated as mol/m^3 as per problem statement)\n    k_in, na_in, cl_in = 140.0, 15.0, 10.0\n    k_out, na_out, cl_out = 5.0, 145.0, 110.0\n\n    # Ion valences\n    z_k, z_na, z_cl = 1.0, 1.0, -1.0\n\n    # Test suite from the problem statement\n    # Each tuple is (I_pump [uA/cm^2], P_k [m/s], P_na [m/s], P_cl [m/s])\n    test_cases = [\n        (50.0, 1e-7, 5e-9, 4.5e-8),\n        (0.0, 1e-7, 5e-9, 4.5e-8),\n        (50.0, 1e-7, 5e-9, 0.0),\n        (50.0, 1e-8, 5e-9, 4.5e-8),\n    ]\n\n    # Small voltage tolerance to switch to the linear approximation of GHK equation\n    VM_TOLERANCE = 1e-12\n\n    # Pre-calculate a common term\n    RT = R * T\n\n    def ghk_current(Vm, P, z, c_in, c_out):\n        \"\"\"\n        Calculates the current density for a single ion species using the GHK equation.\n        Handles the singularity at Vm = 0 by using a linear approximation.\n\n        Args:\n            Vm (float): Membrane potential (V).\n            P (float): Permeability (m/s).\n            z (float): Ion valence.\n            c_in (float): Intracellular concentration (mol/m^3).\n            c_out (float): Extracellular concentration (mol/m^3).\n\n        Returns:\n            float: Current density (A/m^2).\n        \"\"\"\n        if abs(Vm)  VM_TOLERANCE:\n            # Linear approximation for Vm -> 0 to avoid singularity\n            return P * z * F * (c_in - c_out)\n        else:\n            # Full GHK equation\n            # u is a dimensionless argument for the exponential function\n            u = z * F * Vm / RT\n            \n            # np.expm1(x) calculates exp(x) - 1 with high precision for small x.\n            # Our denominator is 1 - exp(-u), which is - (exp(-u) - 1) = -expm1(-u).\n            # This avoids catastrophic cancellation when u is near zero.\n            ghk_factor = P * (z * F)**2 * Vm / RT\n            concentration_term = (c_in - c_out * np.exp(-u))\n            denominator = -np.expm1(-u)\n            \n            return ghk_factor * concentration_term / denominator\n\n    results = []\n    for case in test_cases:\n        I_pump_val, P_k, P_na, P_cl = case\n        \n        # Convert pump current to A/m^2\n        I_pump = I_pump_val * PUMP_UNIT_CONVERSION\n\n        def total_current(Vm):\n            \"\"\"\n            Calculates the total membrane current density at a given potential Vm.\n            The root of this function is the resting potential Vm*.\n            \"\"\"\n            J_k = ghk_current(Vm, P_k, z_k, k_in, k_out)\n            J_na = ghk_current(Vm, P_na, z_na, na_in, na_out)\n            J_cl = ghk_current(Vm, P_cl, z_cl, cl_in, cl_out)\n            \n            return J_k + J_na + J_cl + I_pump\n\n        # Numerically solve for the root Vm* where total_current(Vm*) = 0.\n        # The search interval [-0.2, 0.2] V is physiologically plausible and\n        # safely brackets the expected resting potential.\n        try:\n            vm_star = brentq(total_current, -0.2, 0.2)\n            results.append(round(vm_star, 6))\n        except ValueError:\n            # This would happen if total_current(-0.2) and total_current(0.2)\n            # have the same sign, meaning no root was found in the interval.\n            results.append(np.nan)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}