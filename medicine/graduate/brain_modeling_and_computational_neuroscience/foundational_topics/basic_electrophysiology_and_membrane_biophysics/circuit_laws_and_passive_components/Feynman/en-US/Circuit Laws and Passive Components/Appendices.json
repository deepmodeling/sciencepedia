{
    "hands_on_practices": [
        {
            "introduction": "Understanding how electrical signals propagate through the brain begins with modeling the passive electrical properties of neural tissue. This exercise challenges you to derive the effective resistance of a simplified, heterogeneous block of cortical tissue from first principles. By applying fundamental circuit laws to a model combining series and parallel resistive pathways, you will practice reducing a complex structure to a single equivalent component, a foundational skill in biophysical modeling .",
            "id": "3969080",
            "problem": "A pair of planar macroelectrodes of area $A$ sandwich a cortical slab of total thickness $L_{1}+L_{2}$. The slab is heterogeneous and can be modeled as two sublayers in series along the normal to the electrodes. The superficial sublayer ($0 \\leq x \\leq L_{1}$) is a homogeneous perineuronal matrix of uniform resistivity $\\rho_{1}$. The deeper sublayer ($L_{1} \\leq x \\leq L_{1}+L_{2}$) is a parenchymal mixture that conducts through two interpenetrating domains arranged in parallel over the same thickness $L_{2}$: an extracellular fluid domain of resistivity $\\rho_{\\mathrm{e}}$ occupying a constant area fraction $\\phi_{\\mathrm{e}}$ of the electrode area, and a cellular pathway domain with effective resistivity $\\rho_{\\mathrm{c}}$ occupying the complementary area fraction $\\phi_{\\mathrm{c}}=1-\\phi_{\\mathrm{e}}$. Assume uniform cross-sectional area within each domain and that displacement currents are negligible over the timescale of interest, so that quasi-static conduction holds.\n\nUsing only conservation of electric charge (Kirchhoff’s current law), the definition of resistance in terms of resistivity and geometry, and the constitutive relation for ohmic media, derive from first principles the effective resistance $R_{\\mathrm{eff}}$ between the electrodes. In your derivation, explicitly reduce the parallel mixture in the deeper sublayer to an equivalent homogeneous sublayer and then combine the two sublayers in series.\n\nThen, justify why, for small injected currents about a resting operating point, linear superposition of voltage responses to multiple independent current injections holds in this passive network.\n\nFinally, evaluate $R_{\\mathrm{eff}}$ numerically for the parameter set\n$A=1.7\\times 10^{-6}\\ \\mathrm{m}^{2}$, $L_{1}=4.0\\times 10^{-4}\\ \\mathrm{m}$, $L_{2}=1.6\\times 10^{-3}\\ \\mathrm{m}$, $\\rho_{1}=6.0\\ \\Omega\\cdot \\mathrm{m}$, $\\phi_{\\mathrm{e}}=0.30$, $\\rho_{\\mathrm{e}}=2.5\\ \\Omega\\cdot \\mathrm{m}$, and $\\rho_{\\mathrm{c}}=7.5\\ \\Omega\\cdot \\mathrm{m}$. Round your answer to four significant figures. Express the effective resistance in ohms.",
            "solution": "The problem requires the derivation of the effective resistance $R_{\\mathrm{eff}}$ of a heterogeneous cortical slab, a justification for the applicability of the superposition principle, and a numerical evaluation of $R_{\\mathrm{eff}}$. The derivation will be performed from first principles as requested.\n\n### Step 1: Derivation of Effective Resistance $R_{\\mathrm{eff}}$\n\nThe problem describes a resistive network composed of two main sections connected in series. The first section is a homogeneous sublayer of thickness $L_{1}$. The second section is a composite sublayer of thickness $L_{2}$, which itself consists of two domains arranged in parallel. We will first find the equivalent resistance of the parallel composite sublayer and then combine it in series with the first sublayer.\n\n#### Analysis of the Deeper Sublayer (Parallel Combination)\n\nThe deeper sublayer, extending from $x=L_{1}$ to $x=L_{1}+L_{2}$, has a thickness of $L_{2}$ and a total cross-sectional area $A$. It is composed of two parallel conducting domains: an extracellular fluid domain and a cellular pathway domain.\n\nThe resistance $R$ of a uniform conductor is given by the formula $R = \\rho \\frac{L}{A_{\\text{cross}}}$, where $\\rho$ is the resistivity, $L$ is the length along the direction of current flow, and $A_{\\text{cross}}$ is the cross-sectional area normal to the current flow.\n\n1.  **Extracellular Domain Resistance ($R_{\\mathrm{e}}$)**:\n    This domain has resistivity $\\rho_{\\mathrm{e}}$, length $L_{2}$, and a cross-sectional area that is a fraction $\\phi_{\\mathrm{e}}$ of the total area $A$. Thus, its area is $A_{\\mathrm{e}} = \\phi_{\\mathrm{e}} A$. The resistance of this domain is:\n    $$R_{\\mathrm{e}} = \\frac{\\rho_{\\mathrm{e}} L_{2}}{A_{\\mathrm{e}}} = \\frac{\\rho_{\\mathrm{e}} L_{2}}{\\phi_{\\mathrm{e}} A}$$\n\n2.  **Cellular Domain Resistance ($R_{\\mathrm{c}}$)**:\n    This domain has effective resistivity $\\rho_{\\mathrm{c}}$, length $L_{2}$, and a cross-sectional area given by the complementary fraction $\\phi_{\\mathrm{c}} = 1 - \\phi_{\\mathrm{e}}$. Its area is $A_{\\mathrm{c}} = (1-\\phi_{\\mathrm{e}})A$. The resistance of this domain is:\n    $$R_{\\mathrm{c}} = \\frac{\\rho_{\\mathrm{c}} L_{2}}{A_{\\mathrm{c}}} = \\frac{\\rho_{\\mathrm{c}} L_{2}}{(1-\\phi_{\\mathrm{e}}) A}$$\n\nSince these two domains are arranged in parallel, the total current through the sublayer is the sum of the currents through each domain (Kirchhoff's current law), while the voltage drop across both domains is the same. The equivalent resistance of this parallel combination, let's call it $R_{p}$, is given by the formula for parallel resistors:\n$$\\frac{1}{R_{p}} = \\frac{1}{R_{\\mathrm{e}}} + \\frac{1}{R_{\\mathrm{c}}}$$\nSubstituting the expressions for $R_{\\mathrm{e}}$ and $R_{\\mathrm{c}}$:\n$$\\frac{1}{R_{p}} = \\frac{\\phi_{\\mathrm{e}} A}{\\rho_{\\mathrm{e}} L_{2}} + \\frac{(1-\\phi_{\\mathrm{e}}) A}{\\rho_{\\mathrm{c}} L_{2}}$$\nWe can factor out the common term $\\frac{A}{L_{2}}$:\n$$\\frac{1}{R_{p}} = \\frac{A}{L_{2}} \\left( \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} \\right)$$\nThe problem asks to reduce this to an equivalent homogeneous sublayer. An equivalent homogeneous sublayer would have a single effective resistivity, $\\rho_{p}$, thickness $L_{2}$, and total area $A$. Its resistance would be $R_{p} = \\frac{\\rho_{p} L_{2}}{A}$. Comparing this with our derived expression for $R_{p}$, we can identify the effective resistivity $\\rho_{p}$:\n$$R_{p} = \\left[ \\frac{A}{L_{2}} \\left( \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} \\right) \\right]^{-1} = \\frac{L_{2}}{A} \\left( \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} \\right)^{-1}$$\nBy comparing $R_{p} = \\frac{\\rho_{p} L_{2}}{A}$, we find the effective resistivity of the parallel sublayer is:\n$$\\rho_{p} = \\left( \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} \\right)^{-1}$$\n\n#### Analysis of the Full Slab (Series Combination)\n\nThe entire cortical slab is now modeled as two homogeneous sublayers in series.\n\n1.  **Superficial Sublayer Resistance ($R_{1}$)**:\n    This sublayer has resistivity $\\rho_{1}$, thickness $L_{1}$, and cross-sectional area $A$. Its resistance is:\n    $$R_{1} = \\frac{\\rho_{1} L_{1}}{A}$$\n\n2.  **Deeper Sublayer Equivalent Resistance ($R_{p}$)**:\n    We have already derived the equivalent resistance of this sublayer as $R_{p} = \\frac{\\rho_{p} L_{2}}{A}$.\n\nSince these two sublayers are in series, the total current passes through both, and the total voltage drop is the sum of the voltage drops across each (a consequence of Kirchhoff's laws). The total effective resistance $R_{\\mathrm{eff}}$ is the sum of the individual series resistances:\n$$R_{\\mathrm{eff}} = R_{1} + R_{p}$$\nSubstituting the expressions for $R_{1}$ and $R_{p}$:\n$$R_{\\mathrm{eff}} = \\frac{\\rho_{1} L_{1}}{A} + \\frac{\\rho_{p} L_{2}}{A}$$\nFinally, substituting the expression for $\\rho_{p}$:\n$$R_{\\mathrm{eff}} = \\frac{\\rho_{1} L_{1}}{A} + \\frac{L_{2}}{A} \\left( \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} \\right)^{-1}$$\nFactoring out the area $A$ gives the final symbolic expression for the effective resistance:\n$$R_{\\mathrm{eff}} = \\frac{1}{A} \\left[ \\rho_{1} L_{1} + L_{2} \\left( \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} \\right)^{-1} \\right]$$\n\n### Step 2: Justification for Linear Superposition\n\nThe principle of superposition states that for any linear system, the net response at a given place and time caused by two or more stimuli is the sum of the responses which would have been caused by each stimulus individually.\nIn the context of this problem, the system is an electrical network. Its linearity depends on the linearity of its components and governing laws.\n\n1.  **Constitutive Relation**: The problem specifies the material as ohmic media. The constitutive relation for an ohmic medium is Ohm's law, $V = I R$, where the voltage drop $V$ is directly proportional to the current $I$. The resistance $R$ is defined by the material's resistivity and geometry, which are assumed to be constant and independent of the applied current or voltage. This is a linear relationship.\n\n2.  **Governing Laws**: The analysis is based on Kirchhoff's laws. Kirchhoff's current law (KCL), $\\sum_k I_k = 0$, represents conservation of charge and is a linear sum of currents. Kirchhoff's voltage law (KVL), $\\sum_k V_k = 0$, represents conservation of energy and is a linear sum of voltages. Both are linear equations.\n\nSince the entire network is described by a system of linear equations (Ohm's law for components, KCL and KVL for the network), it constitutes a linear system. Therefore, the principle of superposition must hold. This means that the total voltage response to multiple independent current injections is the sum of the voltage responses to each current injection applied separately. The condition \"for small injected currents about a resting operating point\" ensures that any potential non-linear effects (e.g., changes in resistivity due to heating, or voltage-dependent channel gating in a more realistic biological model) are negligible, and the assumption of a passive, linear ohmic network remains valid.\n\n### Step 3: Numerical Evaluation\n\nWe are given the following parameters:\n$A=1.7\\times 10^{-6}\\ \\mathrm{m}^{2}$\n$L_{1}=4.0\\times 10^{-4}\\ \\mathrm{m}$\n$L_{2}=1.6\\times 10^{-3}\\ \\mathrm{m}$\n$\\rho_{1}=6.0\\ \\Omega\\cdot \\mathrm{m}$\n$\\phi_{\\mathrm{e}}=0.30$\n$\\rho_{\\mathrm{e}}=2.5\\ \\Omega\\cdot \\mathrm{m}$\n$\\rho_{\\mathrm{c}}=7.5\\ \\Omega\\cdot \\mathrm{m}$\n\nFirst, we calculate the effective resistivity $\\rho_{p}$ of the deeper sublayer. The fraction for the cellular domain is $\\phi_{\\mathrm{c}} = 1 - \\phi_{\\mathrm{e}} = 1 - 0.30 = 0.70$.\n$$\\frac{1}{\\rho_{p}} = \\frac{\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{e}}} + \\frac{1-\\phi_{\\mathrm{e}}}{\\rho_{\\mathrm{c}}} = \\frac{0.30}{2.5\\ \\Omega\\cdot \\mathrm{m}} + \\frac{0.70}{7.5\\ \\Omega\\cdot \\mathrm{m}}$$\n$$\\frac{1}{\\rho_{p}} = 0.12\\ (\\Omega\\cdot \\mathrm{m})^{-1} + 0.09333...\\ (\\Omega\\cdot \\mathrm{m})^{-1} = 0.21333...\\ (\\Omega\\cdot \\mathrm{m})^{-1}$$\nIn exact fractions, this is $\\frac{1}{\\rho_p} = \\frac{3}{25} + \\frac{7}{75} = \\frac{9}{75} + \\frac{7}{75} = \\frac{16}{75}\\ (\\Omega\\cdot \\mathrm{m})^{-1}$.\nSo, $\\rho_{p} = \\frac{75}{16}\\ \\Omega\\cdot \\mathrm{m} = 4.6875\\ \\Omega\\cdot \\mathrm{m}$.\n\nNow, we calculate the resistances of the two series components:\n$$R_{1} = \\frac{\\rho_{1} L_{1}}{A} = \\frac{(6.0\\ \\Omega\\cdot \\mathrm{m})(4.0\\times 10^{-4}\\ \\mathrm{m})}{1.7\\times 10^{-6}\\ \\mathrm{m}^{2}} = \\frac{2.4\\times 10^{-3}}{1.7\\times 10^{-6}}\\ \\Omega \\approx 1411.76\\ \\Omega$$\n$$R_{p} = \\frac{\\rho_{p} L_{2}}{A} = \\frac{(4.6875\\ \\Omega\\cdot \\mathrm{m})(1.6\\times 10^{-3}\\ \\mathrm{m})}{1.7\\times 10^{-6}\\ \\mathrm{m}^{2}} = \\frac{7.5\\times 10^{-3}}{1.7\\times 10^{-6}}\\ \\Omega \\approx 4411.76\\ \\Omega$$\n\nThe total effective resistance is the sum of these two:\n$$R_{\\mathrm{eff}} = R_{1} + R_{p} \\approx 1411.76\\ \\Omega + 4411.76\\ \\Omega = 5823.52\\ \\Omega$$\nAlternatively, using the full symbolic expression:\n$$R_{\\mathrm{eff}} = \\frac{1}{1.7\\times 10^{-6}} \\left[ (6.0)(4.0\\times 10^{-4}) + (1.6\\times 10^{-3})(4.6875) \\right]$$\n$$R_{\\mathrm{eff}} = \\frac{1}{1.7\\times 10^{-6}} \\left[ 2.4\\times 10^{-3} + 7.5\\times 10^{-3} \\right]$$\n$$R_{\\mathrm{eff}} = \\frac{9.9\\times 10^{-3}}{1.7\\times 10^{-6}}\\ \\Omega = \\frac{9.9}{1.7} \\times 10^3\\ \\Omega \\approx 5823.5294...\\ \\Omega$$\nRounding the result to four significant figures gives $5824\\ \\Omega$.",
            "answer": "$$\\boxed{5.824 \\times 10^3}$$"
        },
        {
            "introduction": "While bulk tissue models provide a starting point, understanding neural computation requires modeling the dynamics of individual neurons, particularly their dendrites. This practice moves from static resistance to the dynamic behavior of an RC ladder network, a classic approximation for a dendritic cable. You will implement a computational model to derive the voltage transfer function, which reveals how a dendrite filters synaptic inputs, and identify the dominant time constants that shape the resulting postsynaptic potentials .",
            "id": "3969145",
            "problem": "You are tasked with deriving and implementing the transfer function of a dendritic tree approximated by a finite ladder network composed of resistors and capacitors. The dendritic tree is modeled as a one-dimensional chain of $N$ isopotential nodes (compartments) connected in series by axial resistors and each node shunted to ground by a membrane resistor in parallel with a membrane capacitor. The model is guided by Kirchhoff's Current Law (KCL) and Ohm's Law, together with the capacitor constitutive relation. Your goal is to determine, from first principles, the input-current to output-voltage transfer function in the Laplace domain and identify the dominant poles that shape postsynaptic potentials.\n\nFundamental base and definitions:\n- Kirchhoff's Current Law (KCL): the algebraic sum of currents leaving a node equals the external current injected into the node. For a node voltage $V_i(t)$, currents through adjacent axial resistors and through the membrane branch sum to the external injection.\n- Ohm's Law: the current through a resistor is the voltage difference divided by the resistance, i.e., $I = \\Delta V / R$.\n- Capacitor constitutive relation: the current through a capacitor is $I_C(t) = C \\,\\frac{dV(t)}{dt}$.\n- Laplace transform with complex frequency $s$ (here restricted to real nonnegative $s$): $\\mathcal{L}\\{\\frac{dV}{dt}\\} = s V(s)$ under zero initial conditions.\n\nNetwork construction:\n- Indices $i \\in \\{1,\\dots,N\\}$ denote the compartments from the soma ($i = 1$) to the distal end ($i = N$).\n- Each node $i$ has membrane resistance $R_m$ to ground and membrane capacitance $C_m$ to ground, modeled as a parallel branch.\n- Each adjacent pair $(i,i+1)$ is connected by an axial resistance $R_a$.\n- External current $I_{\\text{in}}(t)$ is injected at a single node $k \\in \\{1,\\dots,N\\}$, and the output voltage is measured at node $m \\in \\{1,\\dots,N\\}$.\n- Define conductances $g_m = 1/R_m$ and $g_a = 1/R_a$.\n- Let $\\mathbf{G} \\in \\mathbb{R}^{N \\times N}$ denote the nodal conductance matrix assembled by KCL and Ohm's Law, and $\\mathbf{C} \\in \\mathbb{R}^{N \\times N}$ denote the diagonal capacitance matrix. In the Laplace domain, the nodal balance for the vector of node voltages $\\mathbf{V}(s)$ and external injection vector $\\mathbf{i}_{\\text{ext}}(s)$ is $(\\mathbf{G} + s \\mathbf{C}) \\mathbf{V}(s) = \\mathbf{i}_{\\text{ext}}(s)$.\n\nObjectives:\n- Derive the general mapping from KCL and Ohm's Law to construct $\\mathbf{G}$ and $\\mathbf{C}$ for any given $N$, $R_a$, $R_m$, $C_m$.\n- The input-current to output-voltage transfer function is defined as $H(s) = V_m(s) / I_{\\text{in}}(s)$ when the current is injected at node $k$. From the nodal equation, this is the $(m,k)$ entry of $(\\mathbf{G} + s \\mathbf{C})^{-1}$.\n- Identify the poles of $H(s)$ as the values of $s$ for which $\\det(\\mathbf{G} + s \\mathbf{C}) = 0$, equivalently the negatives of the generalized eigenvalues of $(\\mathbf{G}, \\mathbf{C})$. For a strictly passive network with positive $R_a$, $R_m$, and $C_m$, all poles lie on the negative real axis. Let $\\lambda_i > 0$ denote the eigenvalues of $\\mathbf{A} = \\mathbf{C}^{-1}\\mathbf{G}$; then the poles are at $s = -\\lambda_i$, and the corresponding time constants are $\\tau_i = 1/\\lambda_i$.\n- Define the dominant poles to be the two poles with the largest time constants (smallest $\\lambda_i$), which most strongly shape the long-time decay of postsynaptic potentials.\n\nPhysical units:\n- Resistances must be expressed in $\\Omega$.\n- Capacitances must be expressed in $\\mathrm{F}$.\n- The Laplace variable $s$ must be expressed in $\\mathrm{s}^{-1}$ (real, nonnegative values only).\n- The transfer function $H(s)$ must be reported in $\\Omega$.\n- Time constants must be reported in $\\mathrm{s}$.\n\nTest suite:\nFor each case, compute $H(s)$ at the specified $s$ values and report the two dominant time constants $\\tau_1$ and $\\tau_2$ (if fewer than two modes exist, report all available). Use the parameters exactly as given.\n\n- Case $1$ (happy path, multi-compartment distal input to soma):\n  - $N = 3$\n  - $R_a = 5.0 \\times 10^{7}\\,\\Omega$\n  - $R_m = 2.0 \\times 10^{8}\\,\\Omega$\n  - $C_m = 5.0 \\times 10^{-11}\\,\\mathrm{F}$\n  - Injection node $k = 3$\n  - Measurement node $m = 1$\n  - Evaluate at $s$ values: $[0, 100, 500]\\,\\mathrm{s}^{-1}$\n\n- Case $2$ (boundary condition, single-compartment soma):\n  - $N = 1$\n  - $R_a$ unused but set to $1.0\\,\\Omega$ for completeness\n  - $R_m = 1.5 \\times 10^{8}\\,\\Omega$\n  - $C_m = 1.0 \\times 10^{-10}\\,\\mathrm{F}$\n  - Injection node $k = 1$\n  - Measurement node $m = 1$\n  - Evaluate at $s$ values: $[0, 50, 1000]\\,\\mathrm{s}^{-1}$\n\n- Case $3$ (edge case, longer dendrite with lower axial resistance and lower capacitance):\n  - $N = 5$\n  - $R_a = 3.0 \\times 10^{7}\\,\\Omega$\n  - $R_m = 1.0 \\times 10^{8}\\,\\Omega$\n  - $C_m = 3.0 \\times 10^{-11}\\,\\mathrm{F}$\n  - Injection node $k = 5$\n  - Measurement node $m = 1$\n  - Evaluate at $s$ values: $[0, 200, 2000]\\,\\mathrm{s}^{-1}$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case.\n- Each test case result must be a list concatenating the transfer function evaluations followed by the two dominant time constants in seconds; for example, a case with $L$ Laplace points yields $[H(s_1),H(s_2),\\dots,H(s_L),\\tau_1,\\tau_2]$ where $H(s_i)$ is in $\\Omega$ and $\\tau_j$ is in $\\mathrm{s}$.\n- The full output thus has the form $[[\\dots\\text{case 1 results}\\dots],[\\dots\\text{case 2 results}\\dots],[\\dots\\text{case 3 results}\\dots]]$ with no additional text.",
            "solution": "The problem requires the derivation and implementation of the transfer function for a discrete compartmental model of a neuron's dendrite. This model is a finite, one-dimensional ladder network of resistors and capacitors. The solution will be systematically derived from first principles, namely Kirchhoff's Current Law and the constitutive relations for passive circuit elements.\n\n### 1. Nodal Analysis and System Matrix Formulation\n\nThe dendritic cable is modeled as a chain of $N$ compartments. For each compartment $i \\in \\{1, \\dots, N\\}$, we apply Kirchhoff's Current Law (KCL), which states that the sum of currents leaving the node equals the externally injected current. The analysis is performed in the Laplace domain with complex frequency $s$, assuming zero initial conditions for all capacitor voltages.\n\nA compartment $i$ is connected to ground through a parallel membrane resistance $R_m$ and membrane capacitance $C_m$. The current leaving node $i$ through this membrane branch is given by the sum of the resistive and capacitive currents:\n$$\nI_{\\text{mem},i}(s) = \\frac{V_i(s)}{R_m} + s C_m V_i(s) = (g_m + s C_m) V_i(s)\n$$\nwhere $V_i(s)$ is the Laplace transform of the voltage at node $i$ and $g_m = 1/R_m$ is the membrane conductance.\n\nCompartments are connected to their neighbors by an axial resistance $R_a$. Let $g_a = 1/R_a$ be the axial conductance. The current flowing from node $i$ to an adjacent node $j$ is given by Ohm's Law: $I_{i \\to j}(s) = g_a (V_i(s) - V_j(s))$.\n\nWe now write the KCL equation for three types of nodes: the soma end (node $1$), an intermediate node ($i \\in \\{2, \\dots, N-1\\}$), and the distal end (node $N$). Let $I_{\\text{ext},i}(s)$ be the external current injected at node $i$.\n\n**For an intermediate node $i \\in \\{2, \\dots, N-1\\}$:**\nThe total current leaving the node is the sum of the membrane current and the currents to neighbors $i-1$ and $i+1$:\n$$\nI_{\\text{mem},i}(s) + I_{i \\to i-1}(s) + I_{i \\to i+1}(s) = I_{\\text{ext},i}(s)\n$$\n$$\n(g_m + s C_m) V_i(s) + g_a (V_i(s) - V_{i-1}(s)) + g_a (V_i(s) - V_{i+1}(s)) = I_{\\text{ext},i}(s)\n$$\nRearranging terms, we group coefficients of the voltages:\n$$\n-g_a V_{i-1}(s) + (g_m + 2g_a + s C_m) V_i(s) - g_a V_{i+1}(s) = I_{\\text{ext},i}(s)\n$$\n\n**For the soma end node $i=1$ ($N > 1$):**\nThis node is connected only to node $2$ and to ground. The boundary condition is a sealed end (no current flows out of the start of the chain).\n$$\nI_{\\text{mem},1}(s) + I_{1 \\to 2}(s) = I_{\\text{ext},1}(s)\n$$\n$$\n(g_m + s C_m) V_1(s) + g_a (V_1(s) - V_2(s)) = I_{\\text{ext},1}(s)\n$$\n$$\n(g_m + g_a + s C_m) V_1(s) - g_a V_2(s) = I_{\\text{ext},1}(s)\n$$\n\n**For the distal end node $i=N$ ($N > 1$):**\nThis node is connected only to node $N-1$ and to ground, with a sealed-end boundary.\n$$\nI_{\\text{mem},N}(s) + I_{N \\to N-1}(s) = I_{\\text{ext},N}(s)\n$$\n$$\n(g_m + s C_m) V_N(s) + g_a (V_N(s) - V_{N-1}(s)) = I_{\\text{ext},N}(s)\n$$\n$$\n-g_a V_{N-1}(s) + (g_m + g_a + s C_m) V_N(s) = I_{\\text{ext},N}(s)\n$$\n\nThese linear equations can be aggregated into the matrix form $(\\mathbf{G} + s \\mathbf{C}) \\mathbf{V}(s) = \\mathbf{i}_{\\text{ext}}(s)$, where $\\mathbf{V}(s) = [V_1(s), \\dots, V_N(s)]^T$ is the vector of nodal voltages and $\\mathbf{i}_{\\text{ext}}(s)$ is the vector of injected currents.\n\nThe capacitance matrix $\\mathbf{C}$ is diagonal, as each $s C_m V_i(s)$ term only depends on its own node voltage:\n$$\n\\mathbf{C} = \\text{diag}(C_m, C_m, \\dots, C_m) = C_m \\mathbf{I}_{N \\times N}\n$$\n\nThe conductance matrix $\\mathbf{G}$ is a symmetric, tridiagonal matrix constructed from the coefficients of $V_j(s)$. For $N > 1$:\n-   Diagonal entries:\n    $G_{1,1} = G_{N,N} = g_m + g_a$\n    $G_{i,i} = g_m + 2g_a$ for $i \\in \\{2, \\dots, N-1\\}$\n-   Off-diagonal entries:\n    $G_{i,i+1} = G_{i+1,i} = -g_a$ for $i \\in \\{1, \\dots, N-1\\}$\n-   All other entries are zero.\n\nFor the special case $N=1$, the compartment is an isolated RC circuit. There are no axial resistors. The KCL equation is simply $(g_m + s C_m) V_1(s) = I_{\\text{ext},1}(s)$. Thus, $\\mathbf{G} = [g_m]$ and $\\mathbf{C} = [C_m]$.\n\n### 2. Transfer Function Calculation\n\nThe transfer function $H(s) = V_m(s) / I_{\\text{in}}(s)$ relates the output voltage at node $m$ to a single input current $I_{\\text{in}}(s)$ injected at node $k$. In this scenario, the external current vector is $\\mathbf{i}_{\\text{ext}}(s) = [0, \\dots, I_{\\text{in}}(s), \\dots, 0]^T$, with the non-zero element at position $k$.\n\nThe system's nodal admittance matrix is $\\mathbf{Y}(s) = \\mathbf{G} + s\\mathbf{C}$. The voltage vector is found by inverting this matrix: $\\mathbf{V}(s) = \\mathbf{Y}(s)^{-1} \\mathbf{i}_{\\text{ext}}(s)$. Let $\\mathbf{Z}(s) = \\mathbf{Y}(s)^{-1}$ be the nodal impedance matrix. The voltage at node $m$ is the $m$-th component of $\\mathbf{V}(s)$:\n$$\nV_m(s) = \\sum_{j=1}^{N} Z_{m,j}(s) I_{\\text{ext},j}(s) = Z_{m,k}(s) I_{\\text{in}}(s)\n$$\nThus, the required transfer function is the $(m, k)$-th element of the impedance matrix:\n$$\nH(s) = Z_{m,k}(s) = \\left[ (\\mathbf{G} + s \\mathbf{C})^{-1} \\right]_{m,k}\n$$\nNumerically, for each specified value of $s$, we construct the matrix $\\mathbf{Y}(s)$, compute its inverse, and extract the element at row $m-1$ and column $k-1$ (for $0$-based indexing).\n\n### 3. Poles and Time Constants\n\nThe poles of the transfer function are the values of $s$ for which the system matrix $\\mathbf{G} + s\\mathbf{C}$ becomes singular, i.e., $\\det(\\mathbf{G} + s\\mathbf{C}) = 0$. These poles govern the natural response and time evolution of the system. This condition defines a generalized eigenvalue problem:\n$$\n\\mathbf{G}\\mathbf{v} = -s \\mathbf{C}\\mathbf{v}\n$$\nLetting the eigenvalues be $\\lambda_i = -s_i$, where $s_i$ are the poles, we have the standard form for a generalized eigenvalue problem:\n$$\n\\mathbf{G}\\mathbf{v} = \\lambda \\mathbf{C}\\mathbf{v}\n$$\nSince $\\mathbf{G}$ and $\\mathbf{C}$ are symmetric and, for positive component values, positive definite, the eigenvalues $\\lambda_i$ are all real and positive. The poles are located on the negative real axis at $s_i = -\\lambda_i$.\n\nThe system's time constants are the negative reciprocals of the poles, or simply the reciprocals of the eigenvalues $\\lambda_i$:\n$$\n\\tau_i = -\\frac{1}{s_i} = \\frac{1}{\\lambda_i}\n$$\nThe dominant poles are those closest to the origin on the complex plane, which correspond to the smallest positive eigenvalues $\\lambda_i$. These give rise to the largest (and thus most dominant, i.e., slowest decaying) time constants. The task is to find the two largest time constants, $\\tau_1$ and $\\tau_2$, by computing all eigenvalues $\\lambda_i$ of the pair $(\\mathbf{G}, \\mathbf{C})$, calculating the corresponding time constants $\\tau_i = 1/\\lambda_i$, and selecting the two largest values. For $N=1$, there is only one eigenvalue and one time constant.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to solve the dendritic tree modeling problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path, multi-compartment distal input to soma)\n        {\n            \"N\": 3, \"Ra\": 5.0e7, \"Rm\": 2.0e8, \"Cm\": 5.0e-11,\n            \"k\": 3, \"m\": 1, \"s_values\": [0, 100, 500]\n        },\n        # Case 2 (boundary condition, single-compartment soma)\n        {\n            \"N\": 1, \"Ra\": 1.0, \"Rm\": 1.5e8, \"Cm\": 1.0e-10,\n            \"k\": 1, \"m\": 1, \"s_values\": [0, 50, 1000]\n        },\n        # Case 3 (edge case, longer dendrite with lower axial resistance and lower capacitance)\n        {\n            \"N\": 5, \"Ra\": 3.0e7, \"Rm\": 1.0e8, \"Cm\": 3.0e-11,\n            \"k\": 5, \"m\": 1, \"s_values\": [0, 200, 2000]\n        }\n    ]\n\n    def solve_case(N, Ra, Rm, Cm, k, m, s_values):\n        \"\"\"\n        Solves a single test case for the dendritic ladder network model.\n\n        Returns:\n            list: A list containing the computed transfer function values H(s)\n                  followed by the dominant time constants.\n        \"\"\"\n        gm = 1.0 / Rm\n        ga = 1.0 / Ra\n\n        if N == 1:\n            G = np.array([[gm]])\n            C = np.array([[Cm]])\n        else:\n            G = np.zeros((N, N))\n            \n            # Diagonal elements\n            np.fill_diagonal(G, gm + 2 * ga)\n            G[0, 0] = gm + ga\n            G[N - 1, N - 1] = gm + ga\n            \n            # Off-diagonal elements\n            off_diag_val = -ga\n            np.fill_diagonal(G[1:], off_diag_val)\n            np.fill_diagonal(G[:, 1:], off_diag_val)\n\n            C = np.identity(N) * Cm\n\n        # Calculate Transfer Function H(s)\n        H_values = []\n        for s in s_values:\n            Y_s = G + s * C\n            Z_s = np.linalg.inv(Y_s)\n            # Adjust for 1-based problem indexing to 0-based array indexing\n            H_s = Z_s[m - 1, k - 1]\n            H_values.append(H_s)\n\n        # Calculate Time Constants\n        # Solve the generalized eigenvalue problem G*v = lambda*C*v\n        eigenvalues = linalg.eig(G, C, right=False)\n        \n        # Eigenvalues should be real and positive for this physical system\n        eigenvalues = np.real(eigenvalues)\n        \n        # Filter out potential zero or negative eigenvalues due to numerical instability\n        positive_eigenvalues = eigenvalues[eigenvalues > 0]\n        \n        if positive_eigenvalues.size > 0:\n            time_constants = 1.0 / positive_eigenvalues\n            # Sort in descending order to find dominant (largest) time constants\n            time_constants.sort()\n            dominant_taus = time_constants[::-1]\n            \n            if N >= 2:\n                # Per problem, report the two largest\n                taus_to_report = dominant_taus[:2].tolist()\n            else: # N=1\n                # Report all available (only one)\n                taus_to_report = dominant_taus.tolist()\n        else:\n            taus_to_report = []\n\n        return H_values + taus_to_report\n\n    results = []\n    for case in test_cases:\n        result = solve_case(\n            case[\"N\"], case[\"Ra\"], case[\"Rm\"], case[\"Cm\"],\n            case[\"k\"], case[\"m\"], case[\"s_values\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Analyzing a model in the frequency domain provides deep insights, but simulating its behavior over time is essential for predicting responses to complex, time-varying inputs like spike trains. This final practice translates the compartmental model into a system of ordinary differential equations and explores the numerical methods used to solve them. By implementing and analyzing both implicit and explicit integration schemes, you will confront critical issues of numerical stability and computational cost, gaining practical skills essential for building and running robust neural simulations .",
            "id": "3969084",
            "problem": "Consider a one-dimensional multi-compartment passive neuronal cable model with sealed-end boundary conditions. Each compartment is represented by a node with membrane capacitance and passive leak conductance to ground, and adjacent compartments are coupled by axial conductances. The nodal voltages obey Kirchhoff’s Current Law (KCL), where the sum of capacitive, leak, and axial currents equals the externally injected current. Starting from first principles, implement a matrix-based nodal solution, then analyze numerical conditioning and stability of time-stepping schemes.\n\nUse the following foundational laws and definitions:\n- Kirchhoff’s Current Law (KCL): the algebraic sum of currents leaving a node equals the algebraic sum of currents entering the node, which for each compartment implies that the sum of membrane, leak, and axial currents equals the externally injected current.\n- Ohm’s law for conductance form: $I = G \\Delta V$, where $I$ is current, $G$ is conductance, and $\\Delta V$ is the voltage difference.\n- Capacitor current: $I_C = C \\dfrac{dV}{dt}$, where $C$ is capacitance and $V$ is voltage.\n- Sealed-end boundary condition: no axial current flows out of the terminal compartments, realized by the axial coupling only between adjacent compartments.\n\nDerive the discrete-time linear system needed for an implicit (backward Euler) update and the stability criterion for an explicit Euler scheme:\n- Let there be $N$ compartments with membrane capacitances $C_i$ (Farad) collected into a diagonal matrix $C = \\mathrm{diag}(C_1,\\dots,C_N)$, leak conductances $g_{L,i}$ (Siemens) contributing to a diagonal matrix $G_L = \\mathrm{diag}(g_{L,1},\\dots,g_{L,N})$, and axial conductances $g_{a,i}$ (Siemens) between compartments $i$ and $i+1$ forming a tridiagonal symmetric matrix $G_A$ with diagonal entries $G_{A,ii} = g_{a,i-1} + g_{a,i}$ (with $g_{a,0} = 0$ and $g_{a,N} = 0$ for sealed ends) and off-diagonals $G_{A,i,i+1} = G_{A,i+1,i} = -g_{a,i}$. The total conductance matrix is $G = G_L + G_A$.\n- The continuous-time dynamics follow $C \\dfrac{d\\mathbf{V}}{dt} + G \\mathbf{V} = \\mathbf{I}(t)$, where $\\mathbf{V}(t)$ is the vector of compartment voltages (Volt) and $\\mathbf{I}(t)$ is the vector of externally injected currents (Ampere).\n- Define the system matrix $A = -C^{-1} G$ so that $\\dfrac{d\\mathbf{V}}{dt} = A \\mathbf{V} + C^{-1} \\mathbf{I}(t)$.\n- For a time step of size $\\Delta t$ (second), the backward Euler update for $\\mathbf{V}^{n+1}$ given $\\mathbf{V}^n$ and $\\mathbf{I}^{n+1}$ is $(\\tfrac{C}{\\Delta t} + G)\\mathbf{V}^{n+1} = \\tfrac{C}{\\Delta t}\\mathbf{V}^n + \\mathbf{I}^{n+1}$. The conditioning of the linear system is quantified by the $2$-norm condition number $\\kappa_2(\\tfrac{C}{\\Delta t} + G)$ (dimensionless).\n- The explicit Euler update is $\\mathbf{V}^{n+1} = \\mathbf{V}^n + \\Delta t \\, A \\mathbf{V}^n + \\Delta t \\, C^{-1} \\mathbf{I}^n$. Its linear homogeneous update matrix is $M_{\\mathrm{EE}} = I + \\Delta t \\, A$. For stability in the linear passive case, require the spectral radius $\\rho(M_{\\mathrm{EE}}) \\leq 1$ (dimensionless). A critical time step $\\Delta t_{\\mathrm{crit}}$ (second) for stability is connected to the most negative eigenvalue $\\lambda_{\\min}$ of $A$ by $\\Delta t_{\\mathrm{crit}} = \\dfrac{2}{|\\lambda_{\\min}|}$ when $\\lambda_{\\min} < 0$; if $\\lambda_{\\min} = 0$ then $\\Delta t_{\\mathrm{crit}} = +\\infty$.\n\nYour task is to implement a complete program that:\n- Constructs $C$, $G_L$, $G_A$, and $G$ for each specified test case.\n- Forms $A = -C^{-1} G$.\n- Computes the backward Euler system matrix $S_{\\mathrm{BE}} = \\tfrac{C}{\\Delta t} + G$, the $2$-norm condition number $\\kappa_2(S_{\\mathrm{BE}})$ (dimensionless), performs one backward Euler step from $\\mathbf{V}^0 = \\mathbf{0}$ with a specified constant injection vector $\\mathbf{I}^1$, and returns the mean voltage $\\overline{V}^{1}$ (Volt) after the step.\n- Computes the explicit Euler homogeneous update matrix $M_{\\mathrm{EE}} = I + \\Delta t \\, A$ and its spectral radius $\\rho(M_{\\mathrm{EE}})$ (dimensionless), and returns whether the explicit scheme is linearly stable for the given $\\Delta t$ and parameters as a boolean using the criterion $\\rho(M_{\\mathrm{EE}}) \\leq 1$.\n- Computes the critical time step $\\Delta t_{\\mathrm{crit}} = \\dfrac{2}{|\\lambda_{\\min}|}$ (second) from the eigenvalues of $A$ as specified above.\n\nPhysical units:\n- Capacitance $C_i$ in Farad ($\\mathrm{F}$).\n- Conductances $g_{L,i}$ and $g_{a,i}$ in Siemens ($\\mathrm{S}$).\n- Time step $\\Delta t$ in second ($\\mathrm{s}$).\n- Current injection components $I_i$ in Ampere ($\\mathrm{A}$).\n- Voltages in Volt ($\\mathrm{V}$).\n\nTest suite (zero-based compartment indexing; each test case specifies $N$, $C$ vector, $g_L$ vector or scalar, $g_a$ scalar, $\\Delta t$, injection index $k$, and injection amplitude $I_0$; the injection vector $\\mathbf{I}^1$ has component $I_k = I_0$ and all other components equal to $0$):\n- Case $1$ (general happy path):\n  - $N = 4$\n  - $C = [1.0\\times 10^{-9}, 1.0\\times 10^{-9}, 1.0\\times 10^{-9}, 1.0\\times 10^{-9}]$\n  - $g_L = 5.0\\times 10^{-7}$ (uniform for all compartments)\n  - $g_a = 1.0\\times 10^{-6}$ (uniform axial conductance between neighbors)\n  - $\\Delta t = 1.0\\times 10^{-4}$\n  - $k = 1$\n  - $I_0 = 5.0\\times 10^{-9}$\n- Case $2$ (large time step to probe explicit instability):\n  - $N = 4$\n  - $C = [1.0\\times 10^{-9}, 1.0\\times 10^{-9}, 1.0\\times 10^{-9}, 1.0\\times 10^{-9}]$\n  - $g_L = 5.0\\times 10^{-7}$\n  - $g_a = 1.0\\times 10^{-6}$\n  - $\\Delta t = 5.0\\times 10^{-2}$\n  - $k = 1$\n  - $I_0 = 5.0\\times 10^{-9}$\n- Case $3$ (heterogeneous capacitances and strong axial coupling, small time step to probe conditioning):\n  - $N = 6$\n  - $C = [1.0\\times 10^{-9}, 9.0\\times 10^{-10}, 4.0\\times 10^{-10}, 2.0\\times 10^{-9}, 5.0\\times 10^{-10}, 7.0\\times 10^{-10}]$\n  - $g_L = 2.0\\times 10^{-7}$\n  - $g_a = 8.0\\times 10^{-4}$\n  - $\\Delta t = 1.0\\times 10^{-6}$\n  - $k = 0$\n  - $I_0 = 2.0\\times 10^{-9}$\n- Case $4$ (few compartments, moderate parameters, different injection location):\n  - $N = 3$\n  - $C = [2.0\\times 10^{-9}, 1.0\\times 10^{-9}, 2.0\\times 10^{-10}]$\n  - $g_L = 1.0\\times 10^{-6}$\n  - $g_a = 2.0\\times 10^{-6}$\n  - $\\Delta t = 2.0\\times 10^{-3}$\n  - $k = 2$\n  - $I_0 = 1.0\\times 10^{-9}$\n\nFinal output specification:\n- For each test case, your program must compute and return a list containing:\n  - $\\kappa_2(S_{\\mathrm{BE}})$ (float, dimensionless),\n  - explicit Euler stability flag (boolean),\n  - $\\Delta t_{\\mathrm{crit}}$ (float, in $\\mathrm{s}$),\n  - $\\rho(M_{\\mathrm{EE}})$ (float, dimensionless),\n  - $\\overline{V}^{1}$ (float, in $\\mathrm{V}$).\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these per-case lists, enclosed in square brackets, with no spaces. For example, a valid output format is $[ [x_1,\\dots],[x_2,\\dots],\\dots ]$ but rendered without spaces as $[[x_1,\\dots],[x_2,\\dots],\\dots]$. The numeric values should be raw floats and booleans; do not print units, and do not include any extra text.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The model described is a standard linear passive cable model used in computational neuroscience, based on Kirchhoff's Current Law and Ohm's law. The numerical methods, backward and explicit Euler, and their stability analysis based on matrix eigenvalues and spectral radius, are standard techniques in numerical solution of ordinary differential equations. The parameters provided are physically plausible. Therefore, I will proceed with a full solution.\n\nThe core of the problem is to construct the matrices that describe the linear system, and then use them to analyze the behavior of two different numerical integration schemes.\n\nStep 1: Matrix Construction\nThe system dynamics are governed by the equation $C \\frac{d\\mathbf{V}}{dt} + G \\mathbf{V} = \\mathbf{I}(t)$. We need to construct the capacitance matrix $C$ and the total conductance matrix $G$.\n-   The capacitance matrix $C$ is a diagonal matrix, with the membrane capacitance $C_i$ of each compartment $i$ on the diagonal. Given a vector of capacitance values $\\mathbf{c} = [C_1, C_2, \\dots, C_N]$, the matrix is $C = \\mathrm{diag}(\\mathbf{c})$. Its inverse, $C^{-1}$, is also a diagonal matrix with entries $1/C_i$.\n-   The total conductance matrix $G$ is the sum of the leak conductance matrix $G_L$ and the axial conductance matrix $G_A$.\n-   The leak conductance matrix $G_L$ is diagonal, with the leak conductance $g_{L,i}$ for each compartment on the diagonal: $G_L = \\mathrm{diag}(g_{L,1}, \\dots, g_{L,N})$. For the given test cases, $g_L$ is uniform across all compartments.\n-   The axial conductance matrix $G_A$ represents the coupling between adjacent compartments. For sealed-end boundary conditions, no current flows out of the ends of the cable. The matrix $G_A$ is a symmetric, tridiagonal matrix. For a uniform axial conductance $g_a$ between any two adjacent compartments, its elements are derived from KCL. For an interior compartment $i$, the axial current is the sum of currents to its neighbors: $I_{a,i} = g_a(V_i - V_{i-1}) + g_a(V_i - V_{i+1}) = 2g_aV_i - g_aV_{i-1} - g_aV_{i+1}$. This corresponds to a row in the matrix $G_A \\mathbf{V}$ with entries $[-g_a, 2g_a, -g_a]$. For the first compartment ($i=1$), the current is $g_a(V_1 - V_2)$, giving a row $[g_a, -g_a, \\dots]$. For the last compartment ($i=N$), the current is $g_a(V_N - V_{N-1})$, giving a row $[\\dots, -g_a, g_a]$. Thus, the diagonal of $G_A$ is $[g_a, 2g_a, \\dots, 2g_a, g_a]$ and the first off-diagonals are all $-g_a$.\n-   The total conductance matrix is $G = G_L + G_A$. As $G_L$ is positive definite (all $g_{L,i}>0$) and $G_A$ is a graph Laplacian and thus positive semi-definite, their sum $G$ is symmetric and positive definite.\n\nStep 2: System Matrix and Time Stepping\nThe system equation can be written as $\\frac{d\\mathbf{V}}{dt} = -C^{-1}G \\mathbf{V} + C^{-1}\\mathbf{I}(t)$. The system matrix is thus $A = -C^{-1}G$.\n-   **Backward Euler (Implicit):** The update rule is derived by discretizing the derivative at time $t^{n+1}$: $\\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = A \\mathbf{V}^{n+1} + C^{-1} \\mathbf{I}^{n+1}$. Rearranging gives $(I - \\Delta t A)\\mathbf{V}^{n+1} = \\mathbf{V}^n + \\Delta t C^{-1} \\mathbf{I}^{n+1}$. Substituting $A = -C^{-1}G$ and multiplying by $C$ gives $(C + \\Delta t G)\\mathbf{V}^{n+1} = C \\mathbf{V}^n + \\Delta t \\mathbf{I}^{n+1}$. Finally, dividing by $\\Delta t$ yields the form given in the problem: $(\\frac{C}{\\Delta t} + G)\\mathbf{V}^{n+1} = \\frac{C}{\\Delta t}\\mathbf{V}^n + \\mathbf{I}^{n+1}$.\n    -   The matrix to be inverted is $S_{\\mathrm{BE}} = \\frac{C}{\\Delta t} + G$. Its condition number $\\kappa_2(S_{\\mathrm{BE}})$ measures the sensitivity of the solution of the linear system to perturbations. A high condition number suggests numerical difficulties.\n    -   To compute the voltage vector $\\mathbf{V}^1$ after one step from $\\mathbf{V}^0 = \\mathbf{0}$, we solve the linear system $S_{\\mathrm{BE}}\\mathbf{V}^1 = \\mathbf{I}^1$. The mean voltage is then $\\overline{V}^1 = \\frac{1}{N} \\sum_{i=1}^N V^1_i$.\n\n-   **Explicit Euler (Forward):** The update rule is $\\frac{\\mathbf{V}^{n+1} - \\mathbf{V}^n}{\\Delta t} = A \\mathbf{V}^n + C^{-1} \\mathbf{I}^n$, which rearranges to $\\mathbf{V}^{n+1} = (I + \\Delta t A)\\mathbf{V}^n + \\Delta t C^{-1}\\mathbf{I}^n$.\n    -   The stability of the homogeneous part of the system ($\\mathbf{I}^n = \\mathbf{0}$) is determined by the \"update matrix\" $M_{\\mathrm{EE}} = I + \\Delta t A$. For the solution to remain bounded, the spectral radius $\\rho(M_{\\mathrm{EE}})$ (the largest magnitude of its eigenvalues) must be less than or equal to $1$.\n    -   The eigenvalues of $A$ are real and non-positive because $A$ is similar to a symmetric negative semi-definite matrix ($-C^{-1/2}GC^{-1/2}$). Let $\\lambda_i(A)$ be the eigenvalues of $A$. The eigenvalues of $M_{\\mathrm{EE}}$ are $1 + \\Delta t \\lambda_i(A)$. For stability, we need $|1 + \\Delta t \\lambda_i(A)| \\le 1$ for all $i$. Since $\\lambda_i(A) \\le 0$, this condition is equivalent to $1 + \\Delta t \\lambda_{\\min}(A) \\ge -1$, where $\\lambda_{\\min}(A)$ is the most negative eigenvalue. This simplifies to $\\Delta t \\le \\frac{-2}{\\lambda_{\\min}(A)} = \\frac{2}{|\\lambda_{\\min}(A)|}$.\n    -   The critical time step for stability is therefore $\\Delta t_{\\mathrm{crit}} = \\frac{2}{|\\lambda_{\\min}(A)|}$. For any $\\Delta t > \\Delta t_{\\mathrm{crit}}$, the explicit scheme will be unstable.\n\nStep 3: Implementation\nThe solution will be implemented in Python using the NumPy library for all matrix operations. A function will encapsulate the logic for a single test case, performing matrix construction, condition number calculation, solving the linear system for the backward Euler step, and eigenvalue analysis for the explicit Euler stability and critical time step. This function will be called for each test case provided. The final result is a list of lists, formatted into a single line string with no spaces.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n\n    def solve_case(N, C_vector, g_L_scalar, g_a_scalar, dt, k, I0):\n        \"\"\"\n        Processes a single test case for the neuronal cable model.\n\n        Args:\n            N (int): Number of compartments.\n            C_vector (np.ndarray): Vector of membrane capacitances.\n            g_L_scalar (float): Uniform leak conductance.\n            g_a_scalar (float): Uniform axial conductance.\n            dt (float): Time step size.\n            k (int): Index of the compartment with current injection.\n            I0 (float): Amplitude of the injected current.\n\n        Returns:\n            list: A list containing [kappa_2(S_BE), explicit_euler_stable, \n                                     dt_crit, rho(M_EE), mean_V1].\n        \"\"\"\n        # 1. CONSTRUCT MATRICES\n        C = np.diag(C_vector)\n        C_inv = np.diag(1.0 / C_vector)\n\n        g_L_vector = np.full(N, g_L_scalar)\n        G_L = np.diag(g_L_vector)\n\n        if N > 1:\n            diag_GA = np.full(N, 2 * g_a_scalar)\n            diag_GA[0] = g_a_scalar\n            diag_GA[-1] = g_a_scalar\n            offdiag_GA = np.full(N - 1, -g_a_scalar)\n            G_A = np.diag(diag_GA) + np.diag(offdiag_GA, k=1) + np.diag(offdiag_GA, k=-1)\n        else:  # Handle single compartment case\n            G_A = np.zeros((1, 1))\n        \n        G = G_L + G_A\n        A = -C_inv @ G\n\n        # 2. BACKWARD EULER ANALYSIS\n        S_BE = C / dt + G\n        kappa_S_BE = np.linalg.cond(S_BE, p=2)\n\n        I_vec = np.zeros(N)\n        I_vec[k] = I0\n        \n        # For V_0 = 0, the equation is S_BE * V_1 = I_1\n        V1 = np.linalg.solve(S_BE, I_vec)\n        mean_V1 = np.mean(V1)\n\n        # 3. EXPLICIT EULER ANALYSIS\n        M_EE = np.eye(N) + dt * A\n        eigvals_M_EE = np.linalg.eigvals(M_EE)\n        rho_M_EE = np.max(np.abs(eigvals_M_EE))\n        is_stable = rho_M_EE = 1.0\n\n        # 4. CRITICAL TIME STEP CALCULATION\n        eigvals_A = np.linalg.eigvals(A)\n        # Eigenvalues of A are real and non-positive for this physical system\n        lambda_min = np.min(eigvals_A.real)\n        \n        # Use a small tolerance to check for zero eigenvalue\n        if np.abs(lambda_min)  np.finfo(float).eps * 100:\n            dt_crit = np.inf\n        else:\n            dt_crit = 2.0 / np.abs(lambda_min)\n\n        return [kappa_S_BE, is_stable, dt_crit, rho_M_EE, mean_V1]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'N': 4, 'C': np.array([1.0e-9, 1.0e-9, 1.0e-9, 1.0e-9]), 'g_L': 5.0e-7, 'g_a': 1.0e-6, 'dt': 1.0e-4, 'k': 1, 'I0': 5.0e-9},\n        # Case 2\n        {'N': 4, 'C': np.array([1.0e-9, 1.0e-9, 1.0e-9, 1.0e-9]), 'g_L': 5.0e-7, 'g_a': 1.0e-6, 'dt': 5.0e-2, 'k': 1, 'I0': 5.0e-9},\n        # Case 3\n        {'N': 6, 'C': np.array([1.0e-9, 9.0e-10, 4.0e-10, 2.0e-9, 5.0e-10, 7.0e-10]), 'g_L': 2.0e-7, 'g_a': 8.0e-4, 'dt': 1.0e-6, 'k': 0, 'I0': 2.0e-9},\n        # Case 4\n        {'N': 3, 'C': np.array([2.0e-9, 1.0e-9, 2.0e-10]), 'g_L': 1.0e-6, 'g_a': 2.0e-6, 'dt': 2.0e-3, 'k': 2, 'I0': 1.0e-9},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(\n            N=case['N'],\n            C_vector=case['C'],\n            g_L_scalar=case['g_L'],\n            g_a_scalar=case['g_a'],\n            dt=case['dt'],\n            k=case['k'],\n            I0=case['I0']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Convert list of lists to string and remove all spaces.\n    print(str(results).replace(' ', ''))\n\nsolve()\n```"
        }
    ]
}