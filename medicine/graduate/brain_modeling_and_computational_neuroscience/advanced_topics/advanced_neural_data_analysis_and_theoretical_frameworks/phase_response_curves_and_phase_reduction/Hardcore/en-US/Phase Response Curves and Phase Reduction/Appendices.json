{
    "hands_on_practices": [
        {
            "introduction": "Understanding the theoretical underpinnings of phase reduction begins with the ability to derive a Phase Response Curve (PRC) from a neuron's dynamical equations. This practice provides a hands-on derivation for the canonical theta neuron, a cornerstone model for neuronal spiking. By completing this exercise , you will connect the model's parameters and dynamics directly to the shape of its PRC, revealing its classification as a Type I oscillator.",
            "id": "4009291",
            "problem": "Consider the single-variable theta neuron defined on the circle by the ordinary differential equation $ \\dot{\\theta} = 1 - \\cos\\theta + (1+\\cos\\theta) I $, where $ \\theta \\in [0,2\\pi) $ and $ I  0 $ is a constant baseline input current. Let a small time-dependent perturbation $ \\epsilon u(t) $ be added to the input current, producing the perturbed dynamics $ \\dot{\\theta} = 1 - \\cos\\theta + (1+\\cos\\theta) \\big(I + \\epsilon u(t)\\big) $, with $ 0  \\epsilon \\ll 1 $ and $ u(t) $ bounded. Define the asymptotic phase $ \\phi $ as a reparameterization of $ \\theta $ so that, in the absence of perturbation, $ \\dot{\\phi} $ is constant on the limit cycle. The infinitesimal Phase Response Curve (PRC) is defined as the scalar function $ Z(\\phi) $ that satisfies the reduced phase dynamics $ \\dot{\\phi} = \\omega + \\epsilon Z(\\phi) u(t) $ to first order in $ \\epsilon $, where $ \\omega $ is the natural angular frequency.\n\nStarting from fundamental definitions of the asymptotic phase, isochrons, and the perturbative reduction for a one-dimensional oscillator, derive a closed-form analytical expression for the infinitesimal PRC $ Z(\\theta) $ expressed in terms of the original phase coordinate $ \\theta $ and the parameter $ I $. Then, using only first principles and well-tested facts about one-dimensional flows, prove that $ Z(\\theta) $ is positive for all phases when $ I  0 $, except possibly at isolated points, thereby indicating Type I excitability in the canonical sense of having a purely positive PRC. Your final answer must be the single closed-form expression $ Z(\\theta) $ in terms of $ \\theta $ and $ I $. No numerical approximation is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on the canonical theta neuron model and the standard mathematical framework of phase reduction, which are core topics in computational neuroscience. The givens are complete and consistent, allowing for a unique and meaningful derivation. Therefore, the problem is valid, and we may proceed to the solution.\n\nThe problem asks for the derivation of the infinitesimal Phase Response Curve (PRC), denoted as $Z(\\theta)$, for the theta neuron model. The dynamics of a general one-dimensional oscillator perturbed by a small external input can be written as:\n$$\n\\dot{\\theta} = F(\\theta) + \\epsilon g(\\theta) u(t)\n$$\nIn our case, the unperturbed dynamics are given by $F(\\theta) = 1 - \\cos\\theta + (1+\\cos\\theta)I$, and the perturbation term is derived from the perturbed dynamics $\\dot{\\theta} = 1 - \\cos\\theta + (1+\\cos\\theta) \\big(I + \\epsilon u(t)\\big)$. Expanding this, we get:\n$$\n\\dot{\\theta} = \\big[1 - \\cos\\theta + (1+\\cos\\theta)I\\big] + \\epsilon (1+\\cos\\theta) u(t)\n$$\nThus, we identify a perturbation of the form $g(\\theta) = 1+\\cos\\theta$.\n\nThe asymptotic phase $\\phi$ is defined such that it advances linearly in time for the unperturbed system, i.e., $\\dot{\\phi} = \\omega$, where $\\omega$ is the constant natural angular frequency of the oscillator. The phase $\\phi$ is a function of the state variable $\\theta$, so we can write $\\phi = \\Phi(\\theta)$. The relationship between the rates of change is $\\dot{\\phi} = \\frac{d\\Phi}{d\\theta} \\dot{\\theta}$. For the unperturbed system, this gives $\\omega = \\frac{d\\Phi}{d\\theta} F(\\theta)$, which implies:\n$$\n\\frac{d\\Phi}{d\\theta} = \\frac{\\omega}{F(\\theta)}\n$$\nFor the perturbed system, the phase dynamics are:\n$$\n\\dot{\\phi} = \\frac{d\\Phi}{d\\theta} \\dot{\\theta} = \\frac{\\omega}{F(\\theta)} \\big[F(\\theta) + \\epsilon g(\\theta) u(t)\\big] = \\omega + \\epsilon \\frac{\\omega g(\\theta)}{F(\\theta)} u(t)\n$$\nComparing this to the canonical form of the reduced phase dynamics, $\\dot{\\phi} = \\omega + \\epsilon Z(\\phi) u(t)$, we identify the PRC, expressed as a function of the original coordinate $\\theta$, as:\n$$\nZ(\\theta) = \\frac{\\omega g(\\theta)}{F(\\theta)}\n$$\nTo find the explicit form of $Z(\\theta)$, we first need to calculate the natural frequency $\\omega$. The period of oscillation, $T_0$, is the time taken for $\\theta$ to evolve from $0$ to $2\\pi$. It is given by the integral:\n$$\nT_0 = \\int_{0}^{2\\pi} \\frac{d\\theta}{\\dot{\\theta}} = \\int_{0}^{2\\pi} \\frac{d\\theta}{F(\\theta)} = \\int_{0}^{2\\pi} \\frac{d\\theta}{1 - \\cos\\theta + (1+\\cos\\theta)I}\n$$\nThis integral is best solved using the Weierstrass substitution, $t = \\tan(\\frac{\\theta}{2})$. With this substitution, we have $\\cos\\theta = \\frac{1-t^2}{1+t^2}$ and $d\\theta = \\frac{2 dt}{1+t^2}$. As $\\theta$ goes from $0$ to $2\\pi$, $t$ goes from $0$ to $\\infty$ (as $\\theta \\to \\pi^-$) and then from $-\\infty$ (as $\\theta \\to \\pi^+$) to $0$. Thus, the integral is over the entire real line from $-\\infty$ to $\\infty$.\nThe denominator becomes:\n$$\nF(\\theta(t)) = 1 - \\frac{1-t^2}{1+t^2} + I \\left(1 + \\frac{1-t^2}{1+t^2}\\right) = \\frac{1+t^2-(1-t^2)}{1+t^2} + I \\frac{1+t^2+1-t^2}{1+t^2} = \\frac{2t^2}{1+t^2} + \\frac{2I}{1+t^2} = \\frac{2(t^2+I)}{1+t^2}\n$$\nSubstituting this into the integral for $T_0$:\n$$\nT_0 = \\int_{-\\infty}^{\\infty} \\frac{1+t^2}{2(t^2+I)} \\left(\\frac{2 dt}{1+t^2}\\right) = \\int_{-\\infty}^{\\infty} \\frac{dt}{t^2+I}\n$$\nSince the problem states $I  0$, we can evaluate this standard integral:\n$$\nT_0 = \\left[ \\frac{1}{\\sqrt{I}} \\arctan\\left(\\frac{t}{\\sqrt{I}}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{1}{\\sqrt{I}} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{\\pi}{\\sqrt{I}}\n$$\nThe natural angular frequency is $\\omega = \\frac{2\\pi}{T_0}$.\n$$\n\\omega = \\frac{2\\pi}{\\pi/\\sqrt{I}} = 2\\sqrt{I}\n$$\nNow we can assemble the expression for the PRC, $Z(\\theta)$. We have $\\omega = 2\\sqrt{I}$, $g(\\theta) = 1+\\cos\\theta$, and $F(\\theta) = 1 - \\cos\\theta + I(1+\\cos\\theta)$.\n$$\nZ(\\theta) = \\frac{(2\\sqrt{I})(1+\\cos\\theta)}{1 - \\cos\\theta + I(1+\\cos\\theta)}\n$$\nThis expression can be slightly rearranged by collecting terms in the denominator: $F(\\theta) = (1+I) + (I-1)\\cos\\theta$.\nThe final expression for the PRC is:\n$$\nZ(\\theta) = \\frac{2\\sqrt{I} (1+\\cos\\theta)}{(1+I) + (I-1)\\cos\\theta}\n$$\nThe second part of the problem is to prove that $Z(\\theta)$ is positive for all phases, except possibly at isolated points, for $I  0$.\nThe expression for $Z(\\theta)$ is a ratio. Let's analyze the sign of the numerator and the denominator.\n1.  The factor $2\\sqrt{I}$ is strictly positive since $I0$.\n2.  The factor $1+\\cos\\theta$ is non-negative, since $\\cos\\theta \\in [-1, 1]$. It is equal to $0$ only when $\\cos\\theta = -1$, which occurs at the isolated point $\\theta=\\pi$ in the interval $[0, 2\\pi)$. At all other points, $1+\\cos\\theta  0$.\n3.  The denominator is $F(\\theta) = \\dot{\\theta}$, the instantaneous angular velocity of the unperturbed oscillator. For the system to have a stable limit cycle, as is necessary for the PRC to be well-defined, $\\dot{\\theta}$ must be non-zero along the entire cycle. Fixed points of the flow occur where $F(\\theta)=0$. Let's check for fixed points:\n    $$\n    1 - \\cos\\theta + I(1+\\cos\\theta) = 0 \\implies (1+I) = (1-I)\\cos\\theta \\implies \\cos\\theta = \\frac{1+I}{1-I}\n    $$\n    Since $I0$, we analyze the magnitude of this expression. If $0I1$, then $1+I  1-I  0$, so $\\frac{1+I}{1-I}  1$. If $I1$, then $1-I  0$ and $1+I  0$, so $\\frac{1+I}{1-I}  -1$. If $I=1$, the equation becomes $2 = 0$, which is impossible. In all cases for $I0$, the value of $\\frac{1+I}{1-I}$ is outside the range $[-1, 1]$ of the cosine function. Therefore, there are no real solutions for $\\theta$, which means there are no fixed points.\n    Since $F(\\theta)$ is a continuous function of $\\theta$ and is never zero, it must have a constant sign. We can determine this sign by evaluating $F(\\theta)$ at any point, for example $\\theta=0$:\n    $$\n    F(0) = 1 - \\cos(0) + I(1+\\cos(0)) = 1-1+I(1+1) = 2I\n    $$\n    Since $I0$, $F(0)  0$. Therefore, $F(\\theta)  0$ for all $\\theta \\in [0, 2\\pi)$.\n\nCombining these observations, $Z(\\theta)$ is a product and ratio of terms:\n$$\nZ(\\theta) = \\frac{(\\text{positive}) \\times (\\text{non-negative})}{(\\text{positive})}\n$$\nThis implies that $Z(\\theta) \\ge 0$. The equality to zero occurs only when the numerator term $1+\\cos\\theta = 0$, which is at $\\theta=\\pi$. For all $\\theta \\in [0, 2\\pi)$ such that $\\theta \\neq \\pi$, we have $Z(\\theta)  0$. This proves that the PRC is positive for all phases except at an isolated point, which is a defining characteristic of Type I excitability.\n\nThe final answer is the closed-form expression for $Z(\\theta)$.",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{I} (1+\\cos\\theta)}{1 - \\cos\\theta + I(1+\\cos\\theta)}}\n$$"
        },
        {
            "introduction": "While analytical derivations provide exact formulas for the infinitesimal PRC (iPRC), in practice, we measure phase shifts caused by finite-sized perturbations. This computational exercise bridges the gap between theory and measurement by asking you to compare the iPRC's linear prediction with the \"true\" phase shift obtained from direct numerical simulation of an oscillator. This practice  is crucial for developing an intuition for the validity of the phase reduction approximation and its dependence on perturbation amplitude.",
            "id": "4009264",
            "problem": "Consider the planar oscillator given by the complex normal form of a supercritical Hopf bifurcation, expressed in Cartesian coordinates. The state is $\\mathbf{x}(t) = (x(t), y(t)) \\in \\mathbb{R}^2$, and the dynamics are\n$$\n\\dot{x} = \\lambda x - (x^2 + y^2) x - \\omega y, \\qquad\n\\dot{y} = \\lambda y - (x^2 + y^2) y + \\omega x,\n$$\nwhere $\\lambda  0$ and $\\omega  0$ are parameters. This system has a stable limit cycle at radius $r^\\star = \\sqrt{\\lambda}$ with angular frequency $\\omega$ and period $T = \\frac{2\\pi}{\\omega}$. The asymptotic phase can be defined by the angle $\\theta(t) = \\arctan2(y(t), x(t))$ in radians, with isochrons given by radial rays.\n\nDefine the finite Phase Response Curve (PRC) for a perturbation as follows: starting from an initial state on the limit cycle at phase $\\theta_0 \\in [0, 2\\pi)$, at time $t_{\\mathrm{pulse}}$ apply an instantaneous perturbation $\\delta \\in \\mathbb{R}^2$ to the state (i.e., $\\mathbf{x}(t_{\\mathrm{pulse}}^+) = \\mathbf{x}(t_{\\mathrm{pulse}}^-) + \\delta$). After sufficient time for transients to decay, the asymptotic phase shift $\\Delta \\phi$ is the difference between the perturbed and unperturbed phases measured on the limit cycle, expressed in radians.\n\nIn the small-perturbation limit (infinitesimal perturbations), the infinitesimal Phase Response Curve (iPRC) predicts an asymptotic phase shift $\\Delta \\phi \\approx \\mathbf{Z}(\\theta) \\cdot \\delta$, where $\\mathbf{Z}(\\theta)$ is the iPRC evaluated at the phase $\\theta$ at which the perturbation is applied. The iPRC can be obtained from the gradient of the asymptotic phase on the limit cycle or via the adjoint method, and it must satisfy the standard normalization condition $\\mathbf{Z}(\\theta) \\cdot \\mathbf{f}(\\mathbf{x}^\\star(\\theta)) = \\omega$, where $\\mathbf{f}$ is the vector field and $\\mathbf{x}^\\star(\\theta)$ parameterizes the limit cycle.\n\nYour task is to write a program that:\n- Simulates the oscillator to compute the finite PRC $\\Delta \\phi$ by direct numerical integration and an instantaneous jump at $t_{\\mathrm{pulse}}$, then continues integration until a final time $t_{\\mathrm{final}}$ that is at least $3$ periods after $t_{\\mathrm{pulse}}$.\n- Computes the iPRC-based small-perturbation prediction $\\mathbf{Z}(\\theta_{\\mathrm{pulse}}) \\cdot \\delta$ using the correct $\\mathbf{Z}(\\theta)$ for this oscillator (obtained from first principles, not by heuristic shortcut).\n- Returns the absolute error between the finite PRC (from simulation) and the iPRC prediction, as a float in radians.\n\nAll angles must be expressed in radians. Time must be expressed in seconds. The instantaneous perturbation $\\delta$ will be specified by a magnitude $\\varepsilon  0$ and a direction that is one of the following:\n- Tangential at the phase of the pulse (denoted \"tan\"), meaning $\\delta$ is aligned with the unit tangent vector at $\\theta_{\\mathrm{pulse}}$.\n- Radial at the phase of the pulse (denoted \"rad\"), meaning $\\delta$ is aligned with the unit radial vector at $\\theta_{\\mathrm{pulse}}$.\n- Along the $x$-axis (denoted \"x\"), meaning $\\delta = (\\varepsilon, 0)$.\n- Along the $y$-axis (denoted \"y\"), meaning $\\delta = (0, \\varepsilon)$.\n\nFor each test case, use an initial condition $\\mathbf{x}(0) = (r^\\star \\cos \\theta_0, r^\\star \\sin \\theta_0)$, and set $t_{\\mathrm{pulse}} = s T$ for a given fraction $s \\in (0, 1)$ of the period. Let $t_{\\mathrm{final}} = t_{\\mathrm{pulse}} + 3 T$. The finite PRC $\\Delta \\phi$ must be computed as the wrapped difference of the angles at $t_{\\mathrm{final}}$ between the perturbed and unperturbed trajectories, mapped to the interval $[-\\pi, \\pi]$.\n\nDesign your program to produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element is the absolute error in radians for one test case.\n\nUse the following test suite, which covers a general case, medium-amplitude nonlinearity, exactly radial perturbation, axis-aligned perturbation, and a boundary angle near wrap-around:\n- Case $1$: $\\lambda = 1.0$, $\\omega = 2.0$, $\\theta_0 = 0.3$, $\\varepsilon = 1\\times 10^{-4}$, direction \"tan\", $s = 0.25$.\n- Case $2$: $\\lambda = 1.0$, $\\omega = 2.0$, $\\theta_0 = 1.2$, $\\varepsilon = 0.3$, direction \"tan\", $s = 0.7$.\n- Case $3$: $\\lambda = 1.0$, $\\omega = 2.0$, $\\theta_0 = 2.8$, $\\varepsilon = 0.5$, direction \"rad\", $s = 0.5$.\n- Case $4$: $\\lambda = 1.0$, $\\omega = 2.0$, $\\theta_0 = 0.9$, $\\varepsilon = 0.2$, direction \"x\", $s = 0.4$.\n- Case $5$: $\\lambda = 1.0$, $\\omega = 2.0$, $\\theta_0 = \\pi - 10^{-3}$, $\\varepsilon = 10^{-3}$, direction \"tan\", $s = 0.1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be a float in radians.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We are asked to compare the phase shift of a canonical oscillator model predicted by linear response theory (the infinitesimal Phase Response Curve, or iPRC) with the phase shift computed from direct numerical simulation of the full nonlinear system.\n\nThe system dynamics are given in Cartesian coordinates $\\mathbf{x} = (x, y)$ by:\n$$\n\\dot{x} = \\lambda x - (x^2 + y^2) x - \\omega y\n$$\n$$\n\\dot{y} = \\lambda y - (x^2 + y^2) y + \\omega x\n$$\nwhere $\\lambda  0$ and $\\omega  0$. This is the normal form for a supercritical Hopf bifurcation. Expressing the system in polar coordinates $x = r \\cos \\theta$, $y = r \\sin \\theta$, the dynamics become:\n$$\n\\dot{r} = (\\lambda - r^2)r\n$$\n$$\n\\dot{\\theta} = \\omega\n$$\nFrom these equations, we can see that there is a fixed point at the origin $r=0$ and a circular limit cycle at $r^\\star = \\sqrt{\\lambda}$, where $\\dot{r} = 0$. The limit cycle is stable because for $r  r^\\star$, $\\dot{r}  0$, and for $0  r  r^\\star$, $\\dot{r}  0$. On the limit cycle, the phase $\\theta$ evolves with a constant angular frequency $\\dot{\\theta} = \\omega$, so the period of oscillation is $T = 2\\pi/\\omega$. A key property of this system, evident from $\\dot{\\theta} = \\omega$ being independent of $r$, is that all trajectories rotate with the same angular frequency. Consequently, the isochrons (surfaces of equal asymptotic phase) are radial lines, and the asymptotic phase $\\Phi(x, y)$ is simply the geometric angle $\\theta(x, y) = \\arctan2(y, x)$.\n\nThe first step is to derive the infinitesimal Phase Response Curve (iPRC), denoted by the vector $\\mathbf{Z}(\\theta)$. The iPRC represents the phase shift response to an infinitesimal perturbation and is defined as the gradient of the asymptotic phase function, $\\mathbf{Z}(\\mathbf{x}) = \\nabla \\Phi(\\mathbf{x})$, evaluated on the limit cycle. Given that $\\Phi(x, y) = \\arctan2(y, x)$, its gradient is:\n$$\n\\nabla \\Phi(x,y) = \\left( \\frac{\\partial \\Phi}{\\partial x}, \\frac{\\partial \\Phi}{\\partial y} \\right) = \\left( \\frac{-y}{x^2+y^2}, \\frac{x}{x^2+y^2} \\right)\n$$\nTo find the iPRC $\\mathbf{Z}(\\theta)$, we evaluate this gradient on the limit cycle, which is parameterized by phase $\\theta$ as $x^\\star(\\theta) = r^\\star \\cos\\theta = \\sqrt{\\lambda} \\cos\\theta$ and $y^\\star(\\theta) = r^\\star \\sin\\theta = \\sqrt{\\lambda} \\sin\\theta$. On the limit cycle, $x^2+y^2 = (r^\\star)^2 = \\lambda$. Substituting these into the gradient expression gives:\n$$\n\\mathbf{Z}(\\theta) = \\left( \\frac{-r^\\star \\sin\\theta}{(r^\\star)^2}, \\frac{r^\\star \\cos\\theta}{(r^\\star)^2} \\right) = \\left( \\frac{-\\sin\\theta}{r^\\star}, \\frac{\\cos\\theta}{r^\\star} \\right) = \\left( \\frac{-\\sin\\theta}{\\sqrt{\\lambda}}, \\frac{\\cos\\theta}{\\sqrt{\\lambda}} \\right)\n$$\nWe verify this result using the normalization condition $\\mathbf{Z}(\\theta) \\cdot \\mathbf{f}(\\mathbf{x}^\\star(\\theta)) = \\omega$, where $\\mathbf{f}$ is the vector field. On the limit cycle ($x^2+y^2=\\lambda$), the vector field is $\\mathbf{f}(\\mathbf{x}^\\star(\\theta)) = (-\\omega y, \\omega x) = (-\\omega \\sqrt{\\lambda} \\sin\\theta, \\omega \\sqrt{\\lambda} \\cos\\theta)$. The dot product is:\n$$\n\\mathbf{Z}(\\theta) \\cdot \\mathbf{f}(\\mathbf{x}^\\star(\\theta)) = \\left( \\frac{-\\sin\\theta}{\\sqrt{\\lambda}} \\right) (-\\omega \\sqrt{\\lambda} \\sin\\theta) + \\left( \\frac{\\cos\\theta}{\\sqrt{\\lambda}} \\right) (\\omega \\sqrt{\\lambda} \\cos\\theta) = \\omega \\sin^2\\theta + \\omega \\cos^2\\theta = \\omega\n$$\nThe condition is satisfied, confirming our expression for $\\mathbf{Z}(\\theta)$. The iPRC-predicted phase shift for a perturbation $\\delta$ applied at phase $\\theta_{\\mathrm{pulse}}$ is $\\Delta\\phi_{\\mathrm{iPRC}} = \\mathbf{Z}(\\theta_{\\mathrm{pulse}}) \\cdot \\delta$.\n\nThe second step is the numerical computation of the finite Phase Response Curve (PRC). This requires simulating the perturbed trajectory. The unperturbed oscillator starts at $\\mathbf{x}(0) = (r^\\star \\cos \\theta_0, r^\\star \\sin \\theta_0)$ and evolves according to $\\mathbf{x}_{\\mathrm{unp}}(t) = (r^\\star \\cos(\\theta_0 + \\omega t), r^\\star \\sin(\\theta_0 + \\omega t))$. The analytical phase of the unperturbed oscillator at any time $t$ is $\\phi_{\\mathrm{unp}}(t) = \\theta_0 + \\omega t$.\n\nThe numerical procedure for each test case is as follows:\n1.  Calculate system parameters $r^\\star = \\sqrt{\\lambda}$ and $T = 2\\pi/\\omega$.\n2.  Determine the simulation time points: the pulse time $t_{\\mathrm{pulse}} = sT$ and final time $t_{\\mathrm{final}} = t_{\\mathrm{pulse}} + 3T$.\n3.  Calculate the phase on the limit cycle at the moment of the pulse: $\\theta_{\\mathrm{pulse}} = (\\theta_0 + \\omega t_{\\mathrm{pulse}})$.\n4.  Determine the perturbation vector $\\delta$ of magnitude $\\varepsilon$ based on its specified direction at phase $\\theta_{\\mathrm{pulse}}$. The unit tangent vector (in the direction of flow) is $\\mathbf{u}_{\\mathrm{tan}} = (-\\sin\\theta_{\\mathrm{pulse}}, \\cos\\theta_{\\mathrm{pulse}})$ and the unit radial vector is $\\mathbf{u}_{\\mathrm{rad}} = (\\cos\\theta_{\\mathrm{pulse}}, \\sin\\theta_{\\mathrm{pulse}})$.\n5.  Calculate the iPRC prediction $\\Delta\\phi_{\\mathrm{iPRC}} = \\mathbf{Z}(\\theta_{\\mathrm{pulse}}) \\cdot \\delta$.\n6.  The state of the oscillator just before the pulse is $\\mathbf{x}(t_{\\mathrm{pulse}}^-) = (r^\\star \\cos\\theta_{\\mathrm{pulse}}, r^\\star \\sin\\theta_{\\mathrm{pulse}})$. The state immediately after the perturbation is $\\mathbf{x}(t_{\\mathrm{pulse}}^+) = \\mathbf{x}(t_{\\mathrm{pulse}}^-) + \\delta$.\n7.  Numerically integrate the ODE system from $t = t_{\\mathrm{pulse}}$ to $t = t_{\\mathrm{final}}$, using $\\mathbf{x}(t_{\\mathrm{pulse}}^+)$ as the initial condition. We use a high-precision solver (e.g., a Runge-Kutta method) to find the final state of the perturbed trajectory, $\\mathbf{x}_{\\mathrm{pert}}(t_{\\mathrm{final}})$.\n8.  The final phase of the perturbed trajectory is $\\phi_{\\mathrm{pert}} = \\arctan2(y_{\\mathrm{pert}}(t_{\\mathrm{final}}), x_{\\mathrm{pert}}(t_{\\mathrm{final}}))$.\n9.  The final phase of the unperturbed reference trajectory is known analytically: $\\phi_{\\mathrm{ref}} = \\theta_0 + \\omega t_{\\mathrm{final}}$.\n10. The finite phase shift is the difference between the perturbed and reference final phases, wrapped to the interval $[-\\pi, \\pi]$: $\\Delta\\phi_{\\mathrm{finite}} = ((\\phi_{\\mathrm{pert}} - \\phi_{\\mathrm{ref}} + \\pi) \\pmod{2\\pi}) - \\pi$.\n11. The final result for the test case is the absolute error between the two predictions: $|\\Delta\\phi_{\\mathrm{finite}} - \\Delta\\phi_{\\mathrm{iPRC}}|$.\n\nThis procedure compares the result of a full nonlinear simulation against the linear approximation provided by the iPRC, quantifying the error of the approximation for different perturbation characteristics.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the finite PRC (from simulation) and the \n    iPRC prediction for a supercritical Hopf bifurcation model.\n    \"\"\"\n    test_cases = [\n        # (lambda, omega, theta0, epsilon, direction, s_fraction)\n        (1.0, 2.0, 0.3, 1e-4, \"tan\", 0.25),\n        (1.0, 2.0, 1.2, 0.3, \"tan\", 0.7),\n        (1.0, 2.0, 2.8, 0.5, \"rad\", 0.5),\n        (1.0, 2.0, 0.9, 0.2, \"x\", 0.4),\n        (1.0, 2.0, np.pi - 1e-3, 1e-3, \"tan\", 0.1),\n    ]\n\n    results = []\n    \n    # Define the ODE system for the oscillator in Cartesian coordinates.\n    def dynamics(t, state, lam, om):\n        x, y = state\n        r_sq = x**2 + y**2\n        dxdt = lam * x - r_sq * x - om * y\n        dydt = lam * y - r_sq * y + om * x\n        return [dxdt, dydt]\n\n    for case in test_cases:\n        lam, om, theta0, eps, direction, s = case\n\n        # Calculate system parameters\n        r_star = np.sqrt(lam)\n        T = 2 * np.pi / om\n\n        # Calculate simulation timings\n        t_pulse = s * T\n        t_final = t_pulse + 3 * T\n\n        # Analytically determine the phase at the pulse time\n        theta_pulse = theta0 + om * t_pulse\n\n        # --- Part 1: iPRC Prediction ---\n        \n        # The iPRC vector for this system is Z(theta) = [-sin(theta)/r_star, cos(theta)/r_star]\n        Z_pulse = np.array([-np.sin(theta_pulse) / r_star, np.cos(theta_pulse) / r_star])\n\n        # Construct the perturbation vector delta\n        if direction == \"tan\":\n            # Unit tangent vector in the direction of flow is (-sin(theta), cos(theta))\n            unit_vec = np.array([-np.sin(theta_pulse), np.cos(theta_pulse)])\n        elif direction == \"rad\":\n            # Unit radial vector is (cos(theta), sin(theta))\n            unit_vec = np.array([np.cos(theta_pulse), np.sin(theta_pulse)])\n        elif direction == \"x\":\n            unit_vec = np.array([1.0, 0.0])\n        elif direction == \"y\":\n            unit_vec = np.array([0.0, 1.0])\n        \n        delta = eps * unit_vec\n        \n        delta_phi_iprc = np.dot(Z_pulse, delta)\n\n        # --- Part 2: Finite PRC from Numerical Simulation ---\n        \n        # State on the limit cycle just before the pulse\n        x_pre_pulse = r_star * np.cos(theta_pulse)\n        y_pre_pulse = r_star * np.sin(theta_pulse)\n        state_pre_pulse = np.array([x_pre_pulse, y_pre_pulse])\n\n        # Apply the instantaneous perturbation\n        state_post_pulse = state_pre_pulse + delta\n\n        # Integrate from t_pulse to t_final\n        sol = solve_ivp(\n            fun=dynamics,\n            t_span=[t_pulse, t_final],\n            y0=state_post_pulse,\n            args=(lam, om),\n            method='RK45',\n            atol=1e-11, # Use high precision for accurate error calculation\n            rtol=1e-11,\n        )\n\n        # Final state of the perturbed trajectory\n        state_final_pert = sol.y[:, -1]\n        \n        # Final phase of the perturbed trajectory\n        phi_pert = np.arctan2(state_final_pert[1], state_final_pert[0])\n\n        # Final phase of the unperturbed trajectory (from analytical solution)\n        phi_ref = theta0 + om * t_final\n        \n        # Calculate the phase shift and wrap it to the interval [-pi, pi]\n        phase_diff = phi_pert - phi_ref\n        delta_phi_finite = (phase_diff + np.pi) % (2 * np.pi) - np.pi\n        \n        # --- Part 3: Calculate Absolute Error ---\n        error = np.abs(delta_phi_finite - delta_phi_iprc)\n        results.append(error)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The true power of phase reduction lies in its ability to predict collective behavior in large networks of oscillators. This exercise explores the emergence of synchrony in a population of identical, coupled neurons. By analyzing the stability of the synchronized state , you will derive a fundamental result: the stability of the entire network depends directly on a simple property of the interaction function, which is itself determined by the single-neuron PRC.",
            "id": "4009293",
            "problem": "Consider a population of $N$ identical, weakly coupled neural oscillators whose state on a stable limit cycle can be described by a phase variable $\\theta_{i}(t) \\in [0,2\\pi)$, $i=1,\\dots,N$. Under weak coupling, phase reduction yields the phase dynamics\n$$\n\\frac{d\\theta_{i}}{dt} = \\omega + \\frac{K}{N}\\sum_{j=1}^{N} H\\!\\left(\\theta_{j}-\\theta_{i}\\right),\n$$\nwhere $\\omega$ is the common natural frequency, $K0$ is the coupling strength, and $H(\\phi)$ is a $2\\pi$-periodic interaction function derived from the oscillatorâ€™s Phase Response Curve (PRC) and the synaptic coupling waveform. Assume $H$ is differentiable at $\\phi=0$ and that a fully synchronized solution with $\\theta_{1}(t)=\\cdots=\\theta_{N}(t)=\\Theta(t)$ exists.\n\nAnalyze the linear stability of the fully synchronized state with respect to small phase differences by introducing perturbations $\\delta_{i}(t) = \\theta_{i}(t)-\\Theta(t)$ and linearizing the dynamics for $|\\delta_{i}| \\ll 1$. Work in the phase-difference subspace that excludes the neutrally stable global phase-shift mode. Derive and simplify the Jacobian governing the linearized phase-difference dynamics, identify its nontrivial eigenvalues, and provide the real part of the leading nontrivial eigenvalue $\\lambda_{\\perp}$ in terms of $K$ and $H'(0)$.\n\nYour final answer must be a single closed-form analytic expression for $\\lambda_{\\perp}$, with no inequalities or additional qualifiers. No rounding is required. Angles are to be treated in radians throughout.",
            "solution": "The problem statement is a standard exercise in the stability analysis of synchronized states in coupled oscillator networks, a fundamental topic in computational neuroscience and dynamical systems. The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We proceed with the derivation.\n\nThe dynamics of the system of $N$ coupled phase oscillators are given by:\n$$\n\\frac{d\\theta_{i}}{dt} = \\omega + \\frac{K}{N}\\sum_{j=1}^{N} H(\\theta_{j}-\\theta_{i})\n$$\nfor $i=1, \\dots, N$. Here, $\\theta_i$ is the phase of the $i$-th oscillator, $\\omega$ is the natural frequency, $K  0$ is the coupling strength, and $H(\\phi)$ is the $2\\pi$-periodic interaction function.\n\nFirst, we verify the existence of the fully synchronized solution, where $\\theta_i(t) = \\Theta(t)$ for all $i$. Substituting this into the governing equation, the phase difference term becomes $\\theta_j - \\theta_i = \\Theta(t) - \\Theta(t) = 0$. The equation for each oscillator then simplifies to:\n$$\n\\frac{d\\Theta}{dt} = \\omega + \\frac{K}{N}\\sum_{j=1}^{N} H(0) = \\omega + \\frac{K}{N}(N \\cdot H(0)) = \\omega + K H(0)\n$$\nThis is a first-order linear ordinary differential equation for $\\Theta(t)$, which has the solution $\\Theta(t) = (\\omega + K H(0))t + \\Theta_0$, where $\\Theta_0$ is an initial phase. This confirms that a fully synchronized state with a constant collective frequency $\\omega_{\\text{sync}} = \\omega + K H(0)$ is a valid solution to the system's dynamics.\n\nNext, we analyze the linear stability of this synchronized state. We introduce small perturbations $\\delta_i(t)$ to the synchronous solution for each oscillator:\n$$\n\\theta_i(t) = \\Theta(t) + \\delta_i(t)\n$$\nwhere $|\\delta_i(t)| \\ll 1$. Substituting this into the original dynamical equation gives:\n$$\n\\frac{d}{dt}(\\Theta(t) + \\delta_i(t)) = \\omega + \\frac{K}{N}\\sum_{j=1}^{N} H\\left((\\Theta(t) + \\delta_j(t)) - (\\Theta(t) + \\delta_i(t))\\right)\n$$\n$$\n\\frac{d\\Theta}{dt} + \\frac{d\\delta_i}{dt} = \\omega + \\frac{K}{N}\\sum_{j=1}^{N} H(\\delta_j - \\delta_i)\n$$\nUsing the previously derived expression for $\\frac{d\\Theta}{dt}$, we have:\n$$\n(\\omega + K H(0)) + \\frac{d\\delta_i}{dt} = \\omega + \\frac{K}{N}\\sum_{j=1}^{N} H(\\delta_j - \\delta_i)\n$$\nThis simplifies to the equation for the dynamics of the perturbations:\n$$\n\\frac{d\\delta_i}{dt} = \\frac{K}{N}\\sum_{j=1}^{N} H(\\delta_j - \\delta_i) - K H(0)\n$$\nSince the perturbations $\\delta_i$ are small, the phase difference $\\delta_j - \\delta_i$ is also small. We can therefore perform a first-order Taylor expansion of the interaction function $H(\\phi)$ around $\\phi=0$. Given that $H$ is differentiable at $\\phi=0$, we have:\n$$\nH(\\phi) \\approx H(0) + H'(0)\\phi\n$$\nSubstituting this linearization into the perturbation dynamics yields:\n$$\n\\frac{d\\delta_i}{dt} \\approx \\frac{K}{N}\\sum_{j=1}^{N} \\left[ H(0) + H'(0)(\\delta_j - \\delta_i) \\right] - K H(0)\n$$\n$$\n\\frac{d\\delta_i}{dt} = \\left(\\frac{K}{N}\\sum_{j=1}^{N} H(0)\\right) + \\left(\\frac{K H'(0)}{N}\\sum_{j=1}^{N} (\\delta_j - \\delta_i)\\right) - K H(0)\n$$\nThe first term evaluates to $\\frac{K}{N}(N \\cdot H(0)) = K H(0)$, which cancels with the last term. This leaves the linearized dynamics:\n$$\n\\frac{d\\delta_i}{dt} = \\frac{K H'(0)}{N}\\sum_{j=1}^{N} (\\delta_j - \\delta_i)\n$$\nWe can rewrite the sum as $\\sum_{j=1}^{N} \\delta_j - \\sum_{j=1}^{N} \\delta_i = \\sum_{j=1}^{N} \\delta_j - N\\delta_i$. Thus:\n$$\n\\frac{d\\delta_i}{dt} = \\frac{K H'(0)}{N}\\left( \\sum_{j=1}^{N} \\delta_j - N\\delta_i \\right) = K H'(0) \\left( \\frac{1}{N}\\sum_{j=1}^{N} \\delta_j - \\delta_i \\right)\n$$\nThis is a system of $N$ coupled linear ordinary differential equations for the perturbations $\\delta_i(t)$. To find the eigenvalues, we express the system in matrix form, $\\frac{d\\vec{\\delta}}{dt} = J\\vec{\\delta}$, where $\\vec{\\delta} = (\\delta_1, \\dots, \\delta_N)^T$ and $J$ is the Jacobian matrix. The elements of the Jacobian, $J_{ij} = \\frac{\\partial}{\\partial \\delta_j}(\\frac{d\\delta_i}{dt})$, are:\n$$\nJ_{ij} = K H'(0) \\left( \\frac{1}{N} - \\delta_{ij} \\right)\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The Jacobian matrix is therefore:\n$$\nJ = K H'(0) \\begin{pmatrix}\n\\frac{1}{N}-1  \\frac{1}{N}  \\cdots  \\frac{1}{N} \\\\\n\\frac{1}{N}  \\frac{1}{N}-1  \\cdots  \\frac{1}{N} \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n\\frac{1}{N}  \\frac{1}{N}  \\cdots  \\frac{1}{N}-1\n\\end{pmatrix}\n$$\nThis matrix can be compactly written as $J = K H'(0) \\left(\\frac{1}{N}\\mathbf{1} - I\\right)$, where $\\mathbf{1}$ is the $N \\times N$ matrix of all ones and $I$ is the $N \\times N$ identity matrix.\n\nThe eigenvalues of $J$ determine the stability of the synchronized state. To find them, we first find the eigenvalues of the matrix $M = \\frac{1}{N}\\mathbf{1} - I$. The matrix $\\frac{1}{N}\\mathbf{1}$ is a rank-1 matrix. It has one eigenvalue equal to $1$, with the corresponding eigenvector being $\\vec{v}_1 = (1, 1, \\dots, 1)^T$. The other $N-1$ eigenvalues are $0$, with the corresponding eigenspace being the $(N-1)$-dimensional subspace of vectors whose components sum to zero (i.e., orthogonal to $\\vec{v}_1$).\n\nThe eigenvalues of $M$ are related to the eigenvalues of $\\frac{1}{N}\\mathbf{1}$ by a shift of $-1$.\nThus, $M$ has one eigenvalue $\\lambda_M = 1 - 1 = 0$.\nThe remaining $N-1$ eigenvalues are $\\lambda_M = 0 - 1 = -1$.\n\nThe eigenvalues of the full Jacobian $J = K H'(0) M$ are therefore:\n1. One eigenvalue $\\lambda_0 = K H'(0) \\cdot 0 = 0$. This eigenvalue corresponds to the eigenvector $(1, 1, \\dots, 1)^T$. A perturbation along this vector, $\\delta_i(t) = c$ for all $i$, represents a uniform shift of the phase of the entire synchronized population. This is the neutrally stable global phase-shift mode, whose existence is guaranteed by the rotational symmetry of the system. The problem statement instructs to exclude this mode from the stability analysis.\n\n2. $N-1$ identical eigenvalues $\\lambda_{\\perp} = K H'(0) \\cdot (-1) = -K H'(0)$. These eigenvalues govern the stability of perturbations transverse to the synchronization manifold, i.e., those that desynchronize the oscillators.\n\nThe set of nontrivial eigenvalues consists of $N-1$ identical values equal to $-K H'(0)$. The leading nontrivial eigenvalue (the one with the largest real part) is therefore this value. The problem asks for the real part of this eigenvalue. Since $K$ and $H'(0)$ are real, the eigenvalue $\\lambda_{\\perp}$ is real.\nTherefore, the real part of the leading nontrivial eigenvalue is:\n$$\n\\text{Re}(\\lambda_{\\perp}) = -K H'(0)\n$$\nThe stability of the synchronized state is ensured if $\\text{Re}(\\lambda_{\\perp})  0$, which implies $K H'(0)  0$. As $K0$ is given, this requires $H'(0)0$.",
            "answer": "$$\\boxed{-K H'(0)}$$"
        }
    ]
}