{
    "hands_on_practices": [
        {
            "introduction": "贝叶斯大脑假说的核心在于大脑如何将先验知识与感官证据相结合。本练习将通过一个基本案例——高斯先验和高斯似然的结合——引导你动手推导后验分布。通过这个过程，你将揭示精确度加权平均（precision-weighted averaging）这一优美的计算原则，即最终的信念是先验和证据的加权和，其权重由各自的可靠性（精确度）决定。",
            "id": "4063569",
            "problem": "在贝叶斯大脑假说中，皮层计算通常被建模为概率推断，它将内部生成的预测（先验）与传入的感官证据（似然）相结合，其相对影响由精度（方差的倒数）调节。考虑一个用于单一潜在原因 $s$ 的神经形态感觉估计模块，其先验为 $p(s)=\\mathcal{N}(0,1)$，以及一个标量观测值 $x$，由条件概率 $p(x\\mid s)=\\mathcal{N}(s,0.25)$ 生成。仅从贝叶斯法则 $p(s\\mid x)\\propto p(x\\mid s)\\,p(s)$ 和精度是方差倒数的定义出发，通过在高斯乘积的指数项中显式地配方法，推导后验分布 $p(s\\mid x)$。然后，计算给定 $x$ 时 $s$ 的后验均值和后验方差，并将后验均值解释为先验均值和观测值的精度加权平均值。\n\n将您的最终答案表示为一个单行矩阵，其中包含后验均值和后验方差，以 $x$ 的函数的精确符号形式表示。无需四舍五入。不涉及物理单位。",
            "solution": "问题要求基于指定的先验 $p(s)$ 和似然 $p(x \\mid s)$，推导给定观测值 $x$ 时潜在变量 $s$ 的后验分布 $p(s \\mid x)$。推导必须从贝叶斯法则出发，通过在高斯密度乘积的指数项中通过配方法来完成。随后，需要计算和解释后验均值和方差。\n\n给定的分布是：\n1.  $s$ 的先验分布：$p(s) = \\mathcal{N}(\\mu_{prior}, \\sigma_{prior}^2)$，其中均值为 $\\mu_{prior} = 0$，方差为 $\\sigma_{prior}^2 = 1$。\n2.  给定 $s$ 时观测值 $x$ 的似然：$p(x \\mid s) = \\mathcal{N}(s, \\sigma_{like}^2)$，其中方差为 $\\sigma_{like}^2 = 0.25$。注意，此分布的均值是潜在变量 $s$。\n\n一般高斯分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数 (PDF) 由 $f(y) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y-\\mu)^2}{2\\sigma^2}\\right)$ 给出。\n因此，先验和似然的具体 PDF 为：\n$p(s) = \\frac{1}{\\sqrt{2\\pi(1)}} \\exp\\left(-\\frac{(s-0)^2}{2(1)}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{s^2}{2}\\right)$\n$p(x \\mid s) = \\frac{1}{\\sqrt{2\\pi(0.25)}} \\exp\\left(-\\frac{(x-s)^2}{2(0.25)}\\right) = \\frac{1}{\\sqrt{0.5\\pi}} \\exp\\left(-\\frac{(x-s)^2}{0.5}\\right)$\n\n根据贝叶斯法则，后验分布 $p(s \\mid x)$ 与似然和先验的乘积成正比：\n$p(s \\mid x) \\propto p(x \\mid s) p(s)$\n\n代入 PDF 的表达式，我们得到：\n$p(s \\mid x) \\propto \\left[ \\frac{1}{\\sqrt{0.5\\pi}} \\exp\\left(-\\frac{(x-s)^2}{0.5}\\right) \\right] \\left[ \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{s^2}{2}\\right) \\right]$\n\n由于我们处理的是比例关系，可以忽略常数归一化因子。后验与指数部分成正比：\n$p(s \\mid x) \\propto \\exp\\left(-\\frac{(x-s)^2}{0.5}\\right) \\exp\\left(-\\frac{s^2}{2}\\right) = \\exp\\left(-\\frac{(x-s)^2}{0.5} - \\frac{s^2}{2}\\right)$\n\n让我们分析指数项，我们将其表示为 $\\Phi(s)$：\n$\\Phi(s) = -\\left(\\frac{(s-x)^2}{0.5} + \\frac{s^2}{2}\\right) = -\\left(2(s-x)^2 + \\frac{s^2}{2}\\right)$\n\n为了确定后验分布的形式，我们展开指数中的各项并收集 $s$ 的幂。高斯形式 $\\mathcal{N}(\\mu_{post}, \\sigma_{post}^2)$ 的后验分布将具有形式为 $-\\frac{(s-\\mu_{post})^2}{2\\sigma_{post}^2} + C$ 的指数项，其中 $C$ 是关于 $s$ 的常数。\n$\\Phi(s) = -\\left(2(s^2 - 2sx + x^2) + \\frac{s^2}{2}\\right)$\n$\\Phi(s) = -\\left(2s^2 - 4sx + 2x^2 + \\frac{s^2}{2}\\right)$\n$\\Phi(s) = -\\left(\\left(2 + \\frac{1}{2}\\right)s^2 - 4sx + 2x^2\\right)$\n$\\Phi(s) = -\\left(\\frac{5}{2}s^2 - 4sx + 2x^2\\right)$\n\n现在，我们对包含 $s$ 的项进行配方法。一般形式是 $As^2+Bs+C$。我们从涉及 $s$ 的项中提出因子 $A$：$A(s^2 + \\frac{B}{A}s) + C = A\\left(s+\\frac{B}{2A}\\right)^2 + C - \\frac{B^2}{4A}$。\n在我们的表达式中，括号内的项是 $\\frac{5}{2}s^2 - 4sx + 2x^2$。这里，$A = \\frac{5}{2}$，$B = -4x$。\n$\\frac{5}{2}s^2 - 4sx + 2x^2 = \\frac{5}{2}\\left(s^2 - \\frac{2}{5}(4x)s\\right) + 2x^2$\n$= \\frac{5}{2}\\left(s^2 - \\frac{8x}{5}s\\right) + 2x^2$\n$= \\frac{5}{2}\\left[\\left(s - \\frac{4x}{5}\\right)^2 - \\left(\\frac{4x}{5}\\right)^2\\right] + 2x^2$\n$= \\frac{5}{2}\\left(s - \\frac{4x}{5}\\right)^2 - \\frac{5}{2}\\left(\\frac{16x^2}{25}\\right) + 2x^2$\n$= \\frac{5}{2}\\left(s - \\frac{4x}{5}\\right)^2 - \\frac{8x^2}{5} + 2x^2$\n$= \\frac{5}{2}\\left(s - \\frac{4x}{5}\\right)^2 - \\frac{8x^2}{5} + \\frac{10x^2}{5}$\n$= \\frac{5}{2}\\left(s - \\frac{4x}{5}\\right)^2 + \\frac{2x^2}{5}$\n\n将此代回 $\\Phi(s)$ 的表达式中：\n$\\Phi(s) = -\\left(\\frac{5}{2}\\left(s - \\frac{4x}{5}\\right)^2 + \\frac{2x^2}{5}\\right) = -\\frac{5}{2}\\left(s - \\frac{4x}{5}\\right)^2 - \\frac{2x^2}{5}$\n\n因此，后验分布为：\n$p(s \\mid x) \\propto \\exp\\left(-\\frac{1}{2} \\cdot 5 \\left(s - \\frac{4x}{5}\\right)^2\\right) \\exp\\left(-\\frac{2x^2}{5}\\right)$\n\n项 $\\exp(-2x^2/5)$ 相对于 $s$ 是常数，可以并入归一化常数中。剩余的表达式具有 $s$ 的高斯 PDF 的形式：\n$p(s \\mid x) \\propto \\exp\\left(-\\frac{(s - \\mu_{post})^2}{2\\sigma_{post}^2}\\right)$\n\n通过将推导出的指数项与一般形式进行比较，我们可以确定后验均值 $\\mu_{post}$ 和后验方差 $\\sigma_{post}^2$：\n$\\mu_{post} = \\frac{4x}{5}$\n$\\frac{1}{2\\sigma_{post}^2} = \\frac{5}{2} \\implies \\sigma_{post}^2 = \\frac{1}{5}$\n\n所以，后验分布是一个高斯分布：$p(s \\mid x) = \\mathcal{N}\\left(\\frac{4x}{5}, \\frac{1}{5}\\right)$。\n后验均值是 $\\mu_{post} = \\frac{4x}{5}$。\n后验方差是 $\\sigma_{post}^2 = \\frac{1}{5}$。\n\n为了将后验均值解释为精度加权平均，我们首先定义精度。精度 $\\lambda$ 是方差的倒数，$\\lambda = 1/\\sigma^2$。\n先验精度：$\\lambda_{prior} = 1/\\sigma_{prior}^2 = 1/1 = 1$。\n似然精度：$\\lambda_{like} = 1/\\sigma_{like}^2 = 1/0.25 = 4$。\n\n在高斯先验和高斯似然的情况下，后验均值 $\\mu_{post}$ 的通用公式是先验均值 $\\mu_{prior}$ 和数据 $x$（它是在 $s=x$ 处评估的似然函数的均值）的精度加权平均值：\n$\\mu_{post} = \\frac{\\lambda_{prior}\\mu_{prior} + \\lambda_{like}x}{\\lambda_{prior} + \\lambda_{like}}$\n后验精度是先验精度和似然精度的和：\n$\\lambda_{post} = \\lambda_{prior} + \\lambda_{like}$\n后验方差是后验精度的倒数：\n$\\sigma_{post}^2 = \\frac{1}{\\lambda_{post}} = \\frac{1}{\\lambda_{prior} + \\lambda_{like}}$\n\n让我们用给定的值和这些通用公式来验证我们的结果：\n$\\mu_{prior} = 0$, $\\lambda_{prior} = 1$, $\\lambda_{like} = 4$。\n$\\mu_{post} = \\frac{(1)(0) + (4)x}{1 + 4} = \\frac{4x}{5}$\n$\\sigma_{post}^2 = \\frac{1}{1 + 4} = \\frac{1}{5}$\n\n结果完全匹配。其解释是，后验均值 $\\mu_{post}$ 是先验关于均值的信念（$\\mu_{prior}=0$）和感官证据（$x$）的加权平均值。权重是各自的精度。数据精度为 $4$，而先验精度为 $1$，因此感官数据对最终估计的影响是先验信念的四倍。这可以通过将后验均值写为以下形式看出：\n$\\mu_{post} = \\left(\\frac{\\lambda_{prior}}{\\lambda_{prior}+\\lambda_{like}}\\right)\\mu_{prior} + \\left(\\frac{\\lambda_{like}}{\\lambda_{prior}+\\lambda_{like}}\\right)x = \\left(\\frac{1}{5}\\right)(0) + \\left(\\frac{4}{5}\\right)x = \\frac{4x}{5}$。\n\n最终答案要求将后验均值和后验方差放在一个单行矩阵中。\n后验均值：$\\frac{4x}{5}$\n后验方差：$\\frac{1}{5}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4x}{5}  \\frac{1}{5}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "贝叶斯大脑假说的一个关键优势是它能够对行为做出定量的预测。本练习将理论数学与具体的知觉任务联系起来。通过计算当观察者的先验知识或感官输入的可靠性发生变化时其估计会如何改变，你将学习该模型如何将内部的概率计算与可测量的行为结果联系起来。这个练习展示了我们如何通过实验来检验贝叶斯大脑假说。",
            "id": "4027112",
            "problem": "在贝叶斯大脑假说下的一个一维感知估计任务中，一个潜在刺激 $s \\in \\mathbb{R}$ 由一个高斯先验编码，并通过一个高斯似然被观测。先验是 $p(s) = \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，对于一个观测测量值 $x$，似然是 $p(x \\mid s) = \\mathcal{N}(s, \\sigma_{\\ell}^{2})$。定义先验的精度为 $\\lambda_{0} = 1/\\sigma_{0}^{2}$，似然的精度为 $\\lambda_{\\ell} = 1/\\sigma_{\\ell}^{2}$。假设在平方误差损失下，行为报告的是后验均值。\n\n仅从贝叶斯定理和高斯（正态）概率密度的定义出发，通过对未归一化后验的指数部分进行配方法，推导出后验均值作为 $\\lambda_{0}$、$\\lambda_{\\ell}$、$\\mu_{0}$ 和 $x$ 的函数。然后用此来预测，当操纵先验精度与似然精度时，行为估计值会如何变化。\n\n考虑一个朝向估计任务的以下科学上合理的参数，其中角度以度为单位，方差的单位为 $\\mathrm{deg}^{2}$：\n- 先验均值 $\\mu_{0} = 2^{\\circ}$，\n- 先验方差 $\\sigma_{0}^{2} = 9\\,\\mathrm{deg}^{2}$，\n- 似然方差 $\\sigma_{\\ell}^{2} = 4\\,\\mathrm{deg}^{2}$，\n- 观测测量值 $x = 8^{\\circ}$。\n\n定义基线预测报告 $y_{0}$ 为使用上述参数计算的后验均值。考虑两个操作：\n- 操作 A：将先验精度增加3倍（即用 $3\\lambda_{0}$ 替换 $\\lambda_{0}$），保持 $\\lambda_{\\ell}$ 不变；将预测报告记为 $y_{A}$。\n- 操作 B：将似然精度增加3倍（即用 $3\\lambda_{\\ell}$ 替换 $\\lambda_{\\ell}$），保持 $\\lambda_{0}$ 不变；将预测报告记为 $y_{B}$。\n\n计算贝叶斯观察者对这些操作预测的行为差异 $\\Delta = y_{B} - y_{A}$。以度为单位表示最终答案，并将答案四舍五入到四位有效数字。",
            "solution": "该问题是贝叶斯推断与高斯分布的一个标准应用，这是计算神经科学和贝叶斯大脑假说中的一个基础模型。该设置在科学上是合理的，问题定义清晰，提供了所有必要信息。\n\n我们首先推导在给定测量值 $x$ 的情况下，潜在刺激 $s$ 的后验分布 $p(s \\mid x)$。根据贝叶斯定理，后验分布与似然和先验的乘积成正比：\n$$p(s \\mid x) \\propto p(x \\mid s) p(s)$$\n先验 $p(s)$ 是一个均值为 $\\mu_{0}$、方差为 $\\sigma_{0}^{2}$ 的高斯分布：\n$$p(s) = \\frac{1}{\\sqrt{2\\pi\\sigma_{0}^{2}}} \\exp\\left(-\\frac{(s-\\mu_{0})^{2}}{2\\sigma_{0}^{2}}\\right)$$\n似然 $p(x \\mid s)$ 也是一个均值为 $s$、方差为 $\\sigma_{\\ell}^{2}$ 的高斯分布：\n$$p(x \\mid s) = \\frac{1}{\\sqrt{2\\pi\\sigma_{\\ell}^{2}}} \\exp\\left(-\\frac{(x-s)^{2}}{2\\sigma_{\\ell}^{2}}\\right)$$\n将这两者相乘，我们发现后验分布与以下表达式成正比：\n$$p(s \\mid x) \\propto \\exp\\left(-\\frac{(s-\\mu_{0})^{2}}{2\\sigma_{0}^{2}} - \\frac{(x-s)^{2}}{2\\sigma_{\\ell}^{2}}\\right)$$\n为了找到后验分布的参数，我们关注指数部分。我们用精度 $\\lambda_{0} = 1/\\sigma_{0}^{2}$ 和 $\\lambda_{\\ell} = 1/\\sigma_{\\ell}^{2}$ 来表示方差。指数中的表达式为：\n$$E = -\\frac{1}{2}\\left( \\lambda_{0}(s-\\mu_{0})^{2} + \\lambda_{\\ell}(x-s)^{2} \\right)$$\n我们展开平方项：\n$$E = -\\frac{1}{2}\\left( \\lambda_{0}(s^{2} - 2s\\mu_{0} + \\mu_{0}^{2}) + \\lambda_{\\ell}(x^{2} - 2xs + s^{2}) \\right)$$\n现在，我们按 $s$ 的幂次对各项进行分组：\n$$E = -\\frac{1}{2}\\left( s^{2}(\\lambda_{0} + \\lambda_{\\ell}) - 2s(\\lambda_{0}\\mu_{0} + \\lambda_{\\ell}x) + (\\lambda_{0}\\mu_{0}^{2} + \\lambda_{\\ell}x^{2}) \\right)$$\n目标是为包含 $s$ 的项进行配方法，以匹配高斯指数的形式，即 $-\\frac{(s - \\mu_{\\text{post}})^{2}}{2\\sigma_{\\text{post}}^{2}} = -\\frac{1}{2\\sigma_{\\text{post}}^{2}}(s^{2} - 2s\\mu_{\\text{post}} + \\mu_{\\text{post}}^{2})$。\n令 $\\lambda_{\\text{post}} = 1/\\sigma_{\\text{post}}^{2}$。那么指数为 $-\\frac{\\lambda_{\\text{post}}}{2}(s^{2} - 2s\\mu_{\\text{post}} + \\mu_{\\text{post}}^{2})$。\n比较 $s^{2}$ 的系数，我们确定后验精度 $\\lambda_{\\text{post}}$：\n$$\\lambda_{\\text{post}} = \\lambda_{0} + \\lambda_{\\ell}$$\n这意味着后验方差为 $\\sigma_{\\text{post}}^{2} = \\frac{1}{\\lambda_{0} + \\lambda_{\\ell}}$。\n接下来，比较 $-2s$ 项的系数，我们有：\n$$\\lambda_{\\text{post}}\\mu_{\\text{post}} = \\lambda_{0}\\mu_{0} + \\lambda_{\\ell}x$$\n解出后验均值 $\\mu_{\\text{post}}$，我们得到：\n$$\\mu_{\\text{post}} = \\frac{\\lambda_{0}\\mu_{0} + \\lambda_{\\ell}x}{\\lambda_{0} + \\lambda_{\\ell}}$$\n问题陈述，行为报告即后验均值。我们将报告称为 $y$。所以，$y = \\mu_{\\text{post}}$。这个方程表明，行为估计值是先验均值 $\\mu_{0}$ 和感官测量值 $x$ 的加权平均，其中权重分别是各自的精度 $\\lambda_{0}$ 和 $\\lambda_{\\ell}$。增加先验精度 $\\lambda_{0}$ 会将估计值拉向先验均值 $\\mu_{0}$，而增加似然精度 $\\lambda_{\\ell}$ 会将估计值拉向测量值 $x$。\n\n现在我们计算数值。给定的参数是：\n$\\mu_{0} = 2$\n$\\sigma_{0}^{2} = 9 \\implies \\lambda_{0} = 1/9$\n$\\sigma_{\\ell}^{2} = 4 \\implies \\lambda_{\\ell} = 1/4$\n$x = 8$\n所有涉及角度的值都以度为单位。\n\n对于操作 A，我们将先验精度增加3倍。新的参数是：\n$\\lambda_{0, A} = 3 \\times \\lambda_{0} = 3 \\times \\frac{1}{9} = \\frac{1}{3}$\n$\\lambda_{\\ell, A} = \\lambda_{\\ell} = \\frac{1}{4}$\n预测报告 $y_{A}$ 为：\n$$y_{A} = \\frac{\\lambda_{0, A}\\mu_{0} + \\lambda_{\\ell, A}x}{\\lambda_{0, A} + \\lambda_{\\ell, A}} = \\frac{(\\frac{1}{3})(2) + (\\frac{1}{4})(8)}{\\frac{1}{3} + \\frac{1}{4}} = \\frac{\\frac{2}{3} + 2}{\\frac{4+3}{12}} = \\frac{\\frac{8}{3}}{\\frac{7}{12}} = \\frac{8}{3} \\times \\frac{12}{7} = \\frac{32}{7}$$\n\n对于操作 B，我们将似然精度增加3倍。新的参数是：\n$\\lambda_{0, B} = \\lambda_{0} = \\frac{1}{9}$\n$\\lambda_{\\ell, B} = 3 \\times \\lambda_{\\ell} = 3 \\times \\frac{1}{4} = \\frac{3}{4}$\n预测报告 $y_{B}$ 为：\n$$y_{B} = \\frac{\\lambda_{0, B}\\mu_{0} + \\lambda_{\\ell, B}x}{\\lambda_{0, B} + \\lambda_{\\ell, B}} = \\frac{(\\frac{1}{9})(2) + (\\frac{3}{4})(8)}{\\frac{1}{9} + \\frac{3}{4}} = \\frac{\\frac{2}{9} + 6}{\\frac{4+27}{36}} = \\frac{\\frac{56}{9}}{\\frac{31}{36}} = \\frac{56}{9} \\times \\frac{36}{31} = \\frac{224}{31}$$\n\n最后，我们计算行为差异 $\\Delta = y_{B} - y_{A}$：\n$$\\Delta = \\frac{224}{31} - \\frac{32}{7}$$\n为了减去这两个分数，我们找到一个公分母，即 $31 \\times 7 = 217$。\n$$\\Delta = \\frac{224 \\times 7 - 32 \\times 31}{217} = \\frac{1568 - 992}{217} = \\frac{576}{217}$$\n现在我们计算数值并四舍五入到四位有效数字：\n$$\\Delta = \\frac{576}{217} \\approx 2.654377...$$\n四舍五入到四位有效数字得到 $2.654$。单位是度。",
            "answer": "$$\n\\boxed{2.654}\n$$"
        },
        {
            "introduction": "尽管精确的贝叶斯推断是一个强大的规范性模型，但大脑的神经回路很可能执行的是*近似*推断。本练习探讨了一种常见的近似方法——变分推断，以及一个关键问题：模型错配（model misspecification）。你将研究当大脑用于表示信念的内部模型与真实世界的统计结构不完全匹配时会发生什么，这会导致系统性的估计偏差，从而揭示规范性理论与生物学上可能的实现之间的重要区别。",
            "id": "4027080",
            "problem": "考虑一个符合贝叶斯大脑假说的智能体，它通过变分自由能最小化来执行近似贝叶斯推断。一个神经元群体产生脉冲计数，其被建模为以潜在发放率参数 $\\theta$ 为条件的独立观测值 $y_{1}, y_{2}, y_{3}$。其生成模型由泊松似然和伽马先验定义：对于 $i = 1, 2, 3$，$y_{i} \\mid \\theta \\sim \\mathrm{Poisson}(\\theta)$ 且 $\\theta \\sim \\mathrm{Gamma}(\\alpha_{0}, \\beta_{0})$，其中 $\\mathrm{Gamma}(\\alpha, \\beta)$ 表示形状参数为 $\\alpha$、速率参数为 $\\beta$ 的伽马分布。假设该智能体观测到 $y_{1} = 0$，$y_{2} = 1$，$y_{3} = 0$，先验超参数为 $\\alpha_{0} = 2$ 和 $\\beta_{0} = 0.5$。该智能体的内部变分族是错误设定的：它使用对数正态密度 $q(\\theta) = \\mathrm{LogNormal}(\\mu, \\sigma^{2})$（即 $\\ln \\theta \\sim \\mathcal{N}(\\mu, \\sigma^{2})$）来编码 $\\theta$ 的后验，而不是正确的伽马分布族。\n\n从贝叶斯法则出发得到精确后验 $p(\\theta \\mid y_{1}, y_{2}, y_{3})$，并从变分自由能（负证据下界）的定义出发，通过在变分参数上最小化Kullback-Leibler散度（KL）$\\mathrm{KL}(q \\Vert p)$，推导对数正态分布族内最优 $\\mu$ 和 $\\sigma^{2}$ 的平稳条件。然后，计算在精确后验下的逆速率的后验期望 $\\mathbb{E}_{p}[\\theta^{-1}]$ 和在变分后验下的后验期望 $\\mathbb{E}_{q}[\\theta^{-1}]$，并将由错误设定引起的偏差定义为\n$$\nb \\equiv \\mathbb{E}_{q}[\\theta^{-1}] - \\mathbb{E}_{p}[\\theta^{-1}] \\, .\n$$\n对于给定的数据和先验，计算 $b$ 的值。将最终数值答案四舍五入到四位有效数字。将答案表示为无单位的纯数字。",
            "solution": "该问题植根于贝叶斯统计和计算神经科学的标准原理，特别是变分推断，具有科学依据且表述清晰。\n\n求解过程包括五个主要步骤：\n1.  确定精确的后验分布 $p(\\theta \\mid \\mathbf{y})$。\n2.  在此精确后验下计算期望 $\\mathbb{E}_{p}[\\theta^{-1}]$。\n3.  通过最小化Kullback-Leibler散度（等同于最大化证据下界，ELBO）来推导变分参数 $\\mu$ 和 $\\sigma^2$ 的平稳条件。\n4.  求解最优参数 $\\mu_{opt}$ 和 $\\sigma^2_{opt}$，并计算所得变分后验下的期望 $\\mathbb{E}_{q}[\\theta^{-1}]$。\n5.  计算偏差 $b = \\mathbb{E}_{q}[\\theta^{-1}] - \\mathbb{E}_{p}[\\theta^{-1}]$。\n\n**第一步：精确后验分布**\n生成模型指定了泊松似然和伽马先验。\n潜在发放率 $\\theta$ 的先验分布是伽马分布：\n$$p(\\theta) = \\mathrm{Gamma}(\\theta; \\alpha_{0}, \\beta_{0}) = \\frac{\\beta_{0}^{\\alpha_{0}}}{\\Gamma(\\alpha_{0})} \\theta^{\\alpha_{0}-1} \\exp(-\\beta_{0}\\theta)$$\n给定 $\\theta$ 时，观测值 $\\mathbf{y} = (y_{1}, y_{2}, y_{3})$ 的似然是独立泊松概率的乘积：\n$$p(\\mathbf{y} \\mid \\theta) = \\prod_{i=1}^{3} p(y_{i} \\mid \\theta) = \\prod_{i=1}^{3} \\frac{\\theta^{y_{i}} \\exp(-\\theta)}{y_{i}!} = \\frac{\\theta^{\\sum y_{i}} \\exp(-3\\theta)}{\\prod y_{i}!}$$\n根据贝叶斯法则，后验分布正比于似然与先验的乘积：\n$$p(\\theta \\mid \\mathbf{y}) \\propto p(\\mathbf{y} \\mid \\theta) p(\\theta)$$\n$$p(\\theta \\mid \\mathbf{y}) \\propto \\left( \\theta^{\\sum y_{i}} \\exp(-3\\theta) \\right) \\left( \\theta^{\\alpha_{0}-1} \\exp(-\\beta_{0}\\theta) \\right)$$\n$$p(\\theta \\mid \\mathbf{y}) \\propto \\theta^{\\alpha_{0} + \\sum y_{i} - 1} \\exp(-(\\beta_{0} + 3)\\theta)$$\n这是一个伽马分布的核。由于伽马分布是泊松似然的共轭先验，后验分布也是一个伽马分布，$p(\\theta \\mid \\mathbf{y}) = \\mathrm{Gamma}(\\theta; \\alpha_{n}, \\beta_{n})$，其更新后的超参数为：\n$$\\alpha_{n} = \\alpha_{0} + \\sum_{i=1}^{3} y_{i}$$\n$$\\beta_{n} = \\beta_{0} + 3$$\n使用给定值：$\\alpha_{0} = 2$，$\\beta_{0} = 0.5$，以及观测值 $y_{1}=0, y_{2}=1, y_{3}=0$。\n观测值的总和是 $\\sum y_{i} = 0 + 1 + 0 = 1$。\n后验超参数为：\n$$\\alpha_{n} = 2 + 1 = 3$$\n$$\\beta_{n} = 0.5 + 3 = 3.5$$\n因此，精确的后验分布是 $p(\\theta \\mid \\mathbf{y}) = \\mathrm{Gamma}(\\theta; 3, 3.5)$。\n\n**第二步：精确后验下的期望**\n对于一个随机变量 $X \\sim \\mathrm{Gamma}(\\alpha, \\beta)$，$X^{k}$ 的期望由 $\\mathbb{E}[X^{k}] = \\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)\\beta^{k}}$ 给出（对于 $\\alpha+k > 0$）。我们需要计算 $\\mathbb{E}_{p}[\\theta^{-1}]$，这对应于 $k=-1$。\n$$\\mathbb{E}_{p}[\\theta^{-1}] = \\frac{\\Gamma(\\alpha_{n}-1)}{\\Gamma(\\alpha_{n})\\beta_{n}^{-1}} = \\frac{\\Gamma(\\alpha_{n}-1)\\beta_{n}}{(\\alpha_{n}-1)\\Gamma(\\alpha_{n}-1)} = \\frac{\\beta_{n}}{\\alpha_{n}-1}$$\n该式成立，因为 $\\alpha_{n} = 3 > 1$。代入后验超参数的值：\n$$\\mathbb{E}_{p}[\\theta^{-1}] = \\frac{3.5}{3 - 1} = \\frac{3.5}{2} = 1.75$$\n\n**第三步：变分推断和平稳条件**\n智能体最小化KL散度 $\\mathrm{KL}(q(\\theta) \\Vert p(\\theta \\mid \\mathbf{y}))$，这等同于最大化证据下界（ELBO）$\\mathcal{L}(q)$：\n$$\\mathcal{L}(q) = \\mathbb{E}_{q}[\\ln p(\\theta, \\mathbf{y})] - \\mathbb{E}_{q}[\\ln q(\\theta)]$$\n联合对数概率为 $\\ln p(\\theta, \\mathbf{y}) = \\ln p(\\mathbf{y} \\mid \\theta) + \\ln p(\\theta)$。忽略相对于 $\\theta$ 的常数项：\n$$\\ln p(\\theta, \\mathbf{y}) = (\\alpha_{n}-1)\\ln\\theta - \\beta_{n}\\theta + \\text{constant}$$\n变分族是对数正态分布，$q(\\theta) = \\mathrm{LogNormal}(\\mu, \\sigma^2)$，即 $\\ln\\theta \\sim \\mathcal{N}(\\mu, \\sigma^2)$。对数正态分布的熵为 $\\mathcal{H}(q) = -\\mathbb{E}_{q}[\\ln q(\\theta)] = \\mu + \\frac{1}{2}\\ln(2\\pi e \\sigma^2)$。\nELBO为：\n$$\\mathcal{L}(\\mu, \\sigma^2) = \\mathbb{E}_{q}[(\\alpha_{n}-1)\\ln\\theta - \\beta_{n}\\theta] + \\mu + \\frac{1}{2}\\ln(2\\pi e \\sigma^2) + \\text{const.}$$\n对于 $q(\\theta) \\sim \\mathrm{LogNormal}(\\mu, \\sigma^2)$，我们有 $\\mathbb{E}_{q}[\\ln\\theta] = \\mu$ 和 $\\mathbb{E}_{q}[\\theta] = \\exp(\\mu + \\sigma^2/2)$。\n代入这些期望值：\n$$\\mathcal{L}(\\mu, \\sigma^2) = (\\alpha_{n}-1)\\mu - \\beta_{n}\\exp(\\mu + \\frac{\\sigma^2}{2}) + \\mu + \\frac{1}{2}\\ln\\sigma^2 + \\text{const.}$$\n$$\\mathcal{L}(\\mu, \\sigma^2) = \\alpha_{n}\\mu - \\beta_{n}\\exp(\\mu + \\frac{\\sigma^2}{2}) + \\frac{1}{2}\\ln\\sigma^2 + \\text{const.}$$\n为了找到最优参数，我们将关于 $\\mu$ 和 $\\sigma^2$ 的偏导数设为零以找到平稳点。\n关于 $\\mu$ 的偏导数：\n$$\\frac{\\partial\\mathcal{L}}{\\partial\\mu} = \\alpha_{n} - \\beta_{n}\\exp(\\mu + \\frac{\\sigma^2}{2}) = 0$$\n关于 $\\sigma^2$ 的偏导数（令 $v = \\sigma^2$）：\n$$\\frac{\\partial\\mathcal{L}}{\\partial v} = -\\beta_{n}\\exp(\\mu + \\frac{v}{2}) \\cdot \\frac{1}{2} + \\frac{1}{2v} = 0$$\n这两个方程代表了最优 $\\mu$ 和 $\\sigma^2$ 的平稳条件。\n\n**第四步：变分后验下的期望**\n我们求解平稳条件。从第一个条件：\n$$\\exp(\\mu + \\frac{\\sigma^2}{2}) = \\frac{\\alpha_{n}}{\\beta_{n}}$$\n这意味着变分分布的均值与真实后验的均值相匹配：$\\mathbb{E}_{q}[\\theta] = \\mathbb{E}_{p}[\\theta] = \\alpha_n/\\beta_n$。\n将此代入第二个条件：\n$$-\\beta_{n} \\left( \\frac{\\alpha_{n}}{\\beta_{n}} \\right) \\frac{1}{2} + \\frac{1}{2\\sigma^2} = 0 \\implies -\\frac{\\alpha_{n}}{2} + \\frac{1}{2\\sigma^2} = 0 \\implies \\sigma^2 = \\frac{1}{\\alpha_{n}}$$\n现在，求解 $\\mu$：\n$$\\exp(\\mu + \\frac{1}{2\\alpha_{n}}) = \\frac{\\alpha_{n}}{\\beta_{n}} \\implies \\mu + \\frac{1}{2\\alpha_{n}} = \\ln\\left(\\frac{\\alpha_{n}}{\\beta_{n}}\\right) \\implies \\mu = \\ln\\left(\\frac{\\alpha_{n}}{\\beta_{n}}\\right) - \\frac{1}{2\\alpha_{n}}$$\n因此，最优变分参数为 $\\mu_{opt} = \\ln(\\alpha_n/\\beta_n) - 1/(2\\alpha_n)$ 和 $\\sigma^2_{opt} = 1/\\alpha_n$。\n接下来，我们用这些最优参数计算 $\\mathbb{E}_{q}[\\theta^{-1}]$。对于对数正态分布，$\\theta^k$ 的期望为 $\\mathbb{E}_{q}[\\theta^k] = \\exp(k\\mu + k^2\\sigma^2/2)$。对于 $k=-1$：\n$$\\mathbb{E}_{q}[\\theta^{-1}] = \\exp(-\\mu_{opt} + \\frac{\\sigma^2_{opt}}{2})$$\n代入 $\\mu_{opt}$ 和 $\\sigma^2_{opt}$ 的表达式：\n$$\\mathbb{E}_{q}[\\theta^{-1}] = \\exp\\left(-\\left(\\ln\\left(\\frac{\\alpha_{n}}{\\beta_{n}}\\right) - \\frac{1}{2\\alpha_{n}}\\right) + \\frac{1}{2}\\left(\\frac{1}{\\alpha_{n}}\\right)\\right)$$\n$$\\mathbb{E}_{q}[\\theta^{-1}] = \\exp\\left(-\\ln\\left(\\frac{\\alpha_{n}}{\\beta_{n}}\\right) + \\frac{1}{2\\alpha_{n}} + \\frac{1}{2\\alpha_{n}}\\right) = \\exp\\left(\\ln\\left(\\frac{\\beta_{n}}{\\alpha_{n}}\\right) + \\frac{1}{\\alpha_{n}}\\right)$$\n$$\\mathbb{E}_{q}[\\theta^{-1}] = \\frac{\\beta_{n}}{\\alpha_{n}} \\exp\\left(\\frac{1}{\\alpha_{n}}\\right)$$\n代入数值 $\\alpha_{n}=3$ 和 $\\beta_{n}=3.5$：\n$$\\mathbb{E}_{q}[\\theta^{-1}] = \\frac{3.5}{3} \\exp\\left(\\frac{1}{3}\\right)$$\n\n**第五步：偏差计算**\n偏差 $b$ 定义为在变分后验和精确后验下逆速率的期望之差：\n$$b = \\mathbb{E}_{q}[\\theta^{-1}] - \\mathbb{E}_{p}[\\theta^{-1}]$$\n$$b = \\frac{3.5}{3} \\exp\\left(\\frac{1}{3}\\right) - 1.75$$\n现在我们对该表达式进行数值计算：\n$\\exp(1/3) \\approx 1.395612425$\n$\\mathbb{E}_{q}[\\theta^{-1}] \\approx \\frac{3.5}{3} \\times 1.395612425 \\approx 1.16666... \\times 1.395612425 \\approx 1.628214496$\n$$b \\approx 1.628214496 - 1.75 = -0.121785504$$\n四舍五入到四位有效数字，我们得到 $-0.1218$。",
            "answer": "$$\\boxed{-0.1218}$$"
        }
    ]
}