{
    "hands_on_practices": [
        {
            "introduction": "将理论模型付诸实践的第一步，是将其转换为计算机可以处理的离散形式。本练习将引导你完成一个关键步骤：为广义线性模型构建设计矩阵 (design matrix)。这个练习将演示如何将连续时间的刺激卷积，通过离散化近似，转化为一个可以用标准统计软件进行拟合的线性代数问题，这是理解理论与计算之间联系的基础。",
            "id": "3983850",
            "problem": "考虑一个用于连续时间脉冲序列的单神经元点过程广义线性模型（GLM），其中时间 $t$ 的条件强度依赖于一个经过滤波的外源刺激 $s(t)$，通过一个因果时间核 $g(\\tau)$ 的线性泛函来表示，因此线性预测子包含项 $\\int_{0}^{T_b} g(\\tau)\\, s(t-\\tau)\\, d\\tau$，其中对于 $\\tau \\notin [0, T_b]$ 有 $g(\\tau) = 0$。假设核 $g(\\tau)$ 通过基展开 $g(\\tau) = \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau)$ 进行参数化，其中 $\\{b_j(\\tau)\\}_{j=1}^{p}$ 是支撑集在 $[0, T_b]$ 上的固定因果基函数，$\\{\\theta_j\\}_{j=1}^{p}$ 是待估计的未知系数。因此，与刺激相关的对线性预测子的贡献可以写为 $\\sum_{j=1}^{p} \\theta_j\\, (b_j * s)(t)$，其中 $(b_j * s)(t) \\equiv \\int_{0}^{T_b} b_j(\\tau)\\, s(t-\\tau)\\, d\\tau$。\n\n您需要使用均匀的时间窗宽度 $\\Delta t  0$ 将时间离散化，并在网格 $t_n = n\\, \\Delta t$（$n = 1,2,\\dots,N$）上对所有信号进行采样。对于整数延迟 $\\ell \\in \\{0,1,\\dots,L-1\\}$，定义离散序列 $s[n] \\equiv s(n\\, \\Delta t)$ 和 $b_j[\\ell] \\equiv b_j(\\ell\\, \\Delta t)$，其中 $L \\equiv \\lfloor T_b / \\Delta t \\rfloor + 1$。当 $s[n]$ 的参数超出观测窗口时，取 $s[n] = 0$。使用显式保留 $\\Delta t$ 的黎曼和离散化方法，并且不要将 $\\Delta t$ 吸收到基函数或参数中。\n\n您的任务是：\n1. 从连续时间卷积的定义和 $g(\\tau)$ 的基展开出发，展示离散时间近似如何得出一个与刺激相关的预测子的矩阵-向量乘积 $(X \\boldsymbol{\\theta})[n]$ 表示，其中设计矩阵 $X \\in \\mathbb{R}^{N \\times p}$ 的第 $(n,j)$ 个元素 $X_{n,j}$ 依赖于离散时间刺激历史 $\\{s[n-\\ell]\\}_{\\ell=0}^{L-1}$ 和基函数样本 $\\{b_j[\\ell]\\}_{\\ell=0}^{L-1}$。\n2. 在上述因果支撑集和零填充假设下，用 $\\Delta t$、$\\{b_j[\\ell]\\}$ 和 $\\{s[n-\\ell]\\}$ 给出设计矩阵元素 $X_{n,j}$ 的闭式解析表达式。\n\n答案格式要求：提供 $X_{n,j}$ 的单一闭式解析表达式作为您的最终答案。不需要进行数值舍入。最终表达式中不需要物理单位。",
            "solution": "问题陈述的解析和验证如下。\n\n### 第1步：提取已知条件\n- **模型：** 连续时间中的单神经元点过程广义线性模型（GLM）。\n- **刺激滤波项：** 与刺激相关的对线性预测子的贡献由卷积积分 $u(t) = \\int_{0}^{T_b} g(\\tau)\\, s(t-\\tau)\\, d\\tau$ 给出。\n- **核属性：** 时间核 $g(\\tau)$ 是因果的，其支撑集在区间 $[0, T_b]$ 上，即对于 $\\tau \\notin [0, T_b]$ 有 $g(\\tau) = 0$。\n- **核参数化：** 核在一组由 $p$ 个固定函数 $\\{b_j(\\tau)\\}_{j=1}^{p}$ 构成的基上展开：$g(\\tau) = \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau)$。基函数 $b_j(\\tau)$ 也是因果的，且支撑集在 $[0, T_b]$ 上。系数 $\\{\\theta_j\\}_{j=1}^{p}$ 是待估计的参数。\n- **预测子形式：** 刺激的贡献可以重写为基分量的和：$\\sum_{j=1}^{p} \\theta_j\\, (b_j * s)(t)$，其中 $(b_j * s)(t) \\equiv \\int_{0}^{T_b} b_j(\\tau)\\, s(t-\\tau)\\, d\\tau$。\n- **时间离散化：** 使用均匀的时间窗宽度 $\\Delta t  0$ 将时间离散化，得到时间网格 $t_n = n\\, \\Delta t$，其中 $n = 1, 2, \\dots, N$。\n- **信号离散化：** 在此网格上对连续信号进行采样：对于整数延迟指数 $\\ell \\in \\{0, 1, \\dots, L-1\\}$，有 $s[n] \\equiv s(n\\, \\Delta t)$ 和 $b_j[\\ell] \\equiv b_j(\\ell\\, \\Delta t)$。\n- **延迟定义：** 最大延迟步数由核的支撑集持续时间 $T_b$ 和时间步长 $\\Delta t$ 导出：$L \\equiv \\lfloor T_b / \\Delta t \\rfloor + 1$。\n- **边界条件：** 刺激信号被假定为零填充：如果其时间索引落在观测窗口之外，则 $s[n] = 0$。\n- **近似方法：** 连续时间积分将通过黎曼和进行近似，并显式保留因子 $\\Delta t$。\n- **任务：** 在离散时间线性预测子表示 $(X \\boldsymbol{\\theta})[n]$ 中，推导设计矩阵 $X$ 的第 $(n,j)$ 个元素 $X_{n,j}$ 的表达式。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础：** 该问题坚实地植根于计算神经科学和统计信号处理。使用带基函数展开的GLM来建模神经元放电是一种标准且成熟的技术（例如，Pillow 等人，2008）。该公式在科学上是合理的。\n- **适定性：** 问题是适定的。它要求在指定的离散化方案下，从连续积分公式推导出离散代数表示。指令清晰，预期会有一个唯一答案。\n- **客观性：** 问题陈述使用精确的数学语言表达，没有任何主观或模糊的术语。\n- **缺陷分析：**\n    1.  **科学/事实上不健全：** 无。该模型是现代神经数据分析的基石。\n    2.  **不可形式化/不相关：** 无。该问题是形式化的，并且与实现用于脉冲序列的GLM直接相关。\n    3.  **不完整/矛盾的设置：** 无。所有必要的组成部分——积分形式、基展开、离散化规则（黎曼和）以及离散信号的定义——都已提供。\n    4.  **不切实际/不可行：** 无。这是将此类模型拟合到数据的标准程序。\n    5.  **不适定/结构不良：** 无。该任务是一个直接的数学推导。\n    6.  **伪深刻/琐碎：** 无。该推导是理解和实现这些模型的一个基本步骤。\n    7.  **超出科学可验证性范围：** 无。该推导可进行标准的数学验证。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供完整解答。\n\n***\n\n### 解答推导\n\n目标是在GLM线性预测子中与刺激相关的部分的离散时间公式中，找到设计矩阵 $X$ 的元素 $X_{n,j}$ 的表达式。\n\n我们从线性预测子中经过刺激滤波的分量在时间 $t$ 的连续时间表达式开始：\n$$u(t) = \\int_{0}^{T_b} g(\\tau)\\, s(t-\\tau)\\, d\\tau$$\n滤波器核 $g(\\tau)$ 由基函数 $b_j(\\tau)$ 的线性组合参数化：\n$$g(\\tau) = \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau)$$\n将此展开式代入积分中得到：\n$$u(t) = \\int_{0}^{T_b} \\left( \\sum_{j=1}^{p} \\theta_j\\, b_j(\\tau) \\right) s(t-\\tau)\\, d\\tau$$\n由于求和是有限的且积分收敛，我们可以交换求和与积分的顺序：\n$$u(t) = \\sum_{j=1}^{p} \\theta_j \\left( \\int_{0}^{T_b} b_j(\\tau)\\, s(t-\\tau)\\, d\\tau \\right)$$\n此表达式给出了连续时间预测子。为了获得离散时间版本，我们在离散时间点 $t_n = n\\, \\Delta t$ 处计算 $u(t)$：\n$$u(t_n) \\equiv u[n] = \\sum_{j=1}^{p} \\theta_j \\left( \\int_{0}^{T_b} b_j(\\tau)\\, s(t_n - \\tau)\\, d\\tau \\right)$$\n下一步是离散化积分项。问题指定了黎曼和近似。让我们将第 $j$ 个基函数的积分表示为 $I_j[n]$：\n$$I_j[n] = \\int_{0}^{T_b} b_j(\\tau)\\, s(t_n - \\tau)\\, d\\tau$$\n我们用一个和来近似这个积分。我们将积分区间 $[0, T_b]$ 划分为宽度为 $\\Delta t$ 的子区间。积分变量 $\\tau$ 被离散化为 $\\tau_\\ell = \\ell\\, \\Delta t$，微分元 $d\\tau$ 被近似为 $\\Delta t$。求和将针对离散延迟指数 $\\ell$ 进行。问题定义了离散基函数 $b_j[\\ell]$，其中 $\\ell \\in \\{0, 1, \\dots, L-1\\}$，$L = \\lfloor T_b / \\Delta t \\rfloor + 1$。$\\ell$ 的这个范围覆盖了核的支撑集。这里适合使用左黎曼和，在每个区间的起点计算被积函数的值：\n$$I_j[n] \\approx \\sum_{\\ell=0}^{L-1} \\left[ b_j(\\ell\\, \\Delta t)\\, s(t_n - \\ell\\, \\Delta t) \\right] \\Delta t$$\n注意，求和上限 $L-1 = \\lfloor T_b / \\Delta t \\rfloor$ 确保了参数 $\\ell \\Delta t$ 保持在支撑集 $[0, T_b]$ 的内部或边界上。\n\n现在，我们代入离散时间信号的定义 $s[k] \\equiv s(k\\, \\Delta t)$ 和 $b_j[\\ell] \\equiv b_j(\\ell\\, \\Delta t)$：\n- $b_j(\\ell\\, \\Delta t) = b_j[\\ell]$\n- $s(t_n - \\ell\\, \\Delta t) = s((n-\\ell)\\Delta t) = s[n-\\ell]$\n\n将这些代入求和中，得到第 $j$ 个基分量的卷积的离散近似：\n$$I_j[n] \\approx \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell]$$\n这个表达式表示在离散时间 $n$ 处，通过第 $j$ 个基函数滤波后的刺激。\n\n我们现在可以将此代回离散预测子 $u[n]$ 的表达式中：\n$$u[n] \\approx \\sum_{j=1}^{p} \\theta_j \\left( \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell] \\right)$$\n问题要求将其表示为矩阵-向量乘积的形式 $(X \\boldsymbol{\\theta})[n]$，其中 $\\boldsymbol{\\theta} = [\\theta_1, \\theta_2, \\dots, \\theta_p]^T$ 是参数的列向量。该乘积的第 $n$ 个元素由设计矩阵 $X$ 的第 $n$ 行与向量 $\\boldsymbol{\\theta}$ 的点积给出：\n$$(X \\boldsymbol{\\theta})[n] = \\sum_{j=1}^{p} X_{n,j}\\, \\theta_j$$\n通过将此目标形式与我们推导出的 $u[n]$ 表达式进行比较，我们可以识别出乘以每个 $\\theta_j$ 的项。\n$$u[n] = \\sum_{j=1}^{p} \\underbrace{\\left( \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell] \\right)}_{X_{n,j}} \\theta_j$$\n因此，通过直接观察，设计矩阵 $X$ 的第 $(n,j)$ 个元素为：\n$$X_{n,j} = \\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell]$$\n这是设计矩阵元素的闭式表达式。矩阵 $X$ 的每一列 $j$ 对应于刺激 $s$ 与第 $j$ 个基函数 $b_j$ 的卷积，每一行 $n$ 对应于一个离散时间点。",
            "answer": "$$\\boxed{\\Delta t \\sum_{\\ell=0}^{L-1} b_j[\\ell]\\, s[n-\\ell]}$$"
        },
        {
            "introduction": "模型拟合完成后，正确解释其参数至关重要，但这其中充满了实践中的陷阱。本练习将探讨一个常见挑战：当我们改变测量单位（例如刺激的尺度或时间窗口的宽度）时，模型的参数估计会如何变化？通过这个练习，你将深入理解潜在的连续时间过程与我们拟合的离散时间数据模型之间的精确关系，从而确保你的模型结论具有鲁棒性和可解释性。",
            "id": "3983864",
            "problem": "单个神经元被建模为一个条件点过程，其条件强度函数为 $\\lambda(t)$。该函数由一个基本关系定义：对于足够小的 $dt$，在给定历史 $\\mathcal{H}_t$ 的条件下，区间 $[t, t+dt)$ 内恰好出现一个脉冲的概率为 $P(N(t+dt)-N(t)=1 \\mid \\mathcal{H}_t) \\approx \\lambda(t)\\,dt$。在一个带有对数连接函数的广义线性模型 (GLM) 下，条件强度被指定为 $\\lambda(t) = \\exp(\\beta_0 + \\beta_x x(t))$，其中 $x(t)$ 是一个以伏特为单位测量的刺激协变量，$\\lambda(t)$ 的单位解释为脉冲/秒。\n\n一个离散时间泊松GLM被用于拟合宽度为 $\\Delta$ 秒的时间区间内的脉冲计数 $y_k$，其均值为 $\\mu_k \\approx \\lambda(t_k)\\,\\Delta$。假设在拟合这个离散时间模型时，没有为 $\\Delta$ 包含一个显式的偏移量，而是使用一个线性预测器 $\\theta_0 + \\theta_x z_k$，其中 $z_k$ 是实际提供给模型的回归量。\n\n您将刺激单位从伏特更改为毫伏，通过定义 $x'(t) = s\\,x(t)$ (其中 $s = 1000$)，并将时间区间宽度从 $\\Delta$ 秒更改为 $\\Delta'$ 秒。请从条件强度的基本定义以及针对小时间区间的泊松近似出发，推导这些单位变化如何影响系数，以使 $\\lambda(t)$ 的解释保持为脉冲/秒。特别是，当拟合不带显式偏移量时，请根据 $(\\beta_0, \\beta_x)$、$s$ 和 $\\Delta'$ 推导出新的离散时间系数 $(\\theta'_0, \\theta'_x)$ 的表达式。然后，使用 $\\beta_0 = \\ln(12)$、$\\beta_x = 0.25$ (每伏特)、原始时间区间宽度 $\\Delta = 0.01$ 秒以及新的时间区间宽度 $\\Delta' = 0.002$ 秒这些值，计算针对毫伏尺度刺激 $x'(t)$ 的最终 $(\\theta'_0, \\theta'_x)$。\n\n将您的最终答案表示为一个包含 $\\theta'_0$ 和 $\\theta'_x$ 的行矩阵，形式为精确的封闭解。不需要四舍五入，最终的行矩阵内不应包含任何单位。",
            "solution": "问题要求我们确定，当刺激协变量的单位和时间区间宽度改变时，用于神经脉冲计数的离散时间泊松广义线性模型 (GLM) 的系数如何变化。关键在于将拟合的离散模型的参数与底层的连续时间条件强度函数的参数联系起来，确保物理模型保持不变。\n\n首先，我们建立连续时间模型和离散时间模型之间的关系。连续时间条件强度函数由一个带对数连接函数的GLM给出：\n$$\n\\lambda(t) = \\exp(\\beta_0 + \\beta_x x(t))\n$$\n在这里，$\\lambda(t)$ 的单位是脉冲/秒 (s$^{-1}$)，$x(t)$ 是以伏特 (V) 为单位的刺激，$\\beta_x$ 的单位是 V$^{-1}$，而 $\\beta_0$ 是一个无量纲的基线对数率。\n\n对于一个离散时间模型，脉冲序列被分到宽度为 $\\Delta$ 的时间区间内。在以时间 $t_k$ 为中心的第 $k$ 个时间区间内，期望的脉冲数 $\\mu_k$ 近似为：\n$$\n\\mu_k \\approx \\lambda(t_k) \\Delta\n$$\n离散时间模型是一个带对数连接函数的泊松GLM，所以均值 $\\mu_k$ 通过 $\\mu_k = \\exp(\\eta_k)$ 与线性预测器 $\\eta_k$ 相关。对 $\\mu_k$ 的表达式取自然对数：\n$$\n\\eta_k = \\ln(\\mu_k) = \\ln(\\lambda(t_k) \\Delta) = \\ln(\\lambda(t_k)) + \\ln(\\Delta)\n$$\n代入 $\\lambda(t_k)$ 的表达式：\n$$\n\\eta_k = \\ln(\\exp(\\beta_0 + \\beta_x x(t_k))) + \\ln(\\Delta) = \\beta_0 + \\beta_x x(t_k) + \\ln(\\Delta)\n$$\n这是离散时间模型的完整线性预测器。项 $\\ln(\\Delta)$ 是一个偏移量，即一个系数固定为1的预测变量。问题陈述该模型在拟合时*没有显式的偏移量*。这意味着 $\\ln(\\Delta)$ 项被吸收到拟合模型的截距中。如果拟合模型的形式为 $\\theta_0 + \\theta_x z_k$，其中 $z_k = x(t_k)$ 是回归量，那么通过比较形式，我们会发现 $\\theta_x = \\beta_x$ 且 $\\theta_0 = \\beta_0 + \\ln(\\Delta)$。\n\n现在，我们引入单位的变化。刺激单位从伏特变为毫伏，时间区间宽度也发生改变。新的刺激是 $x'(t) = s\\,x(t)$，其中 $s=1000$ mV/V。新的时间区间宽度是 $\\Delta'$。\n\n底层的物理现实，即条件强度 $\\lambda(t)$，必须保持不变。我们可以用新的刺激变量 $x'(t)$ 来表示 $\\lambda(t)$。由于 $x(t) = x'(t)/s$，我们有：\n$$\n\\lambda(t) = \\exp\\left(\\beta_0 + \\beta_x \\frac{x'(t)}{s}\\right) = \\exp\\left(\\beta_0 + \\left(\\frac{\\beta_x}{s}\\right) x'(t)\\right)\n$$\n这显示了连续时间刺激系数如何随单位缩放而变化。新的系数是 $\\beta'_x = \\beta_x/s$。截距 $\\beta_0$ 保持不变。\n\n我们被要求找出使用新刺激 $x'(t)$ 和新时间区间宽度 $\\Delta'$ 拟合的新离散时间模型的系数 $(\\theta'_0, \\theta'_x)$。这个新模型的线性预测器被指定为：\n$$\n\\eta'_k = \\theta'_0 + \\theta'_x x'(t_k)\n$$\n为了找到 $\\theta'_0$ 和 $\\theta'_x$ 的表达式，我们从第一性原理推导 $\\eta'_k$。在宽度为 $\\Delta'$ 的新时间区间内的期望脉冲计数是 $\\mu'_k = \\lambda(t_k)\\Delta'$。相应的线性预测器是：\n$$\n\\eta'_k = \\ln(\\mu'_k) = \\ln(\\lambda(t_k)\\Delta') = \\ln(\\lambda(t_k)) + \\ln(\\Delta')\n$$\n用 $x(t_k)$ 代入 $\\lambda(t_k)$ 的原始表达式：\n$$\n\\eta'_k = (\\beta_0 + \\beta_x x(t_k)) + \\ln(\\Delta')\n$$\n为了与拟合模型的形式进行比较，我们必须用新的刺激回归量 $x'(t_k)$ 来表示它。使用 $x(t_k) = x'(t_k)/s$：\n$$\n\\eta'_k = \\beta_0 + \\beta_x \\left(\\frac{x'(t_k)}{s}\\right) + \\ln(\\Delta')\n$$\n重新排列各项以匹配形式 $\\theta'_0 + \\theta'_x x'(t_k)$：\n$$\n\\eta'_k = (\\beta_0 + \\ln(\\Delta')) + \\left(\\frac{\\beta_x}{s}\\right) x'(t_k)\n$$\n通过将这个推导出的线性预测器与拟合形式 $\\eta'_k = \\theta'_0 + \\theta'_x x'(t_k)$ 进行比较，我们可以直接确定系数：\n$$\n\\theta'_0 = \\beta_0 + \\ln(\\Delta')\n$$\n$$\n\\theta'_x = \\frac{\\beta_x}{s}\n$$\n这些是新的离散时间系数的一般表达式。\n\n最后，我们使用所提供的数据计算这些系数的数值：\n$\\beta_0 = \\ln(12)$\n$\\beta_x = 0.25$ (每伏特)\n$s = 1000$ (毫伏/伏特)\n$\\Delta' = 0.002$ 秒\n\n将这些值代入我们推导出的表达式中：\n对于截距 $\\theta'_0$：\n$$\n\\theta'_0 = \\ln(12) + \\ln(0.002) = \\ln(12 \\times 0.002) = \\ln(0.024)\n$$\n对于刺激系数 $\\theta'_x$：\n$$\n\\theta'_x = \\frac{0.25}{1000} = 0.00025\n$$\n对于以毫伏为单位的刺激和 $0.002$ 秒的时间区间宽度拟合的离散时间模型，新的系数是 $\\theta'_0 = \\ln(0.024)$ 和 $\\theta'_x = 0.00025$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\ln(0.024)  0.00025 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个模型只有在能准确描述数据时才是有用的。本练习将介绍一个强大的模型诊断工具——时间重整化定理 (time-rescaling theorem)。通过对观测到的脉冲序列应用一个特定的非线性变换，我们可以检验我们构建的条件强度函数是否正确地捕捉了神经脉冲序列的统计结构。这是评估模型拟合优度的核心方法。",
            "id": "3983810",
            "problem": "考虑一个简单的平稳点过程模型，用于描述一个神经元在有限观测窗口内的脉冲序列。该脉冲序列由脉冲时间 $\\{t_i\\}_{i=1}^{N}$ 索引，其条件强度函数为 $\\lambda(t \\mid \\mathcal{H}_t)$，其中 $\\mathcal{H}_t$ 表示截至时间 $t$ 的脉冲历史。条件强度函数由基本极限 $\\lambda(t \\mid \\mathcal{H}_t) = \\lim_{\\Delta t \\to 0^{+}} \\frac{\\mathbb{P}\\{\\text{在 }[t, t+\\Delta t) \\text{内有一个脉冲} \\mid \\mathcal{H}_t\\}}{\\Delta t}$ 定义，而脉冲间隔生存函数由标准的风险-生存关系 $S(s) = \\exp\\!\\left(-\\int_{0}^{s} \\lambda(t_{i-1}+u \\mid \\mathcal{H}_{t_{i-1}+u}) \\, du\\right)$ 给出，其中 $s$ 是自上一个脉冲 $t_{i-1}$ 以来经过的时间。\n\n仅从这些定义以及一个经过充分检验的事实出发——即速率为 $\\lambda(t)$ 的非齐次泊松过程可以通过确定性时间变换 $\\tau(t) = \\int_{0}^{t} \\lambda(u) \\, du$ 映射到速率为 $1$ 的齐次泊松过程——完成以下任务：\n\n1. 陈述针对具有条件强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 的简单点过程的时间重标度定理，并推导出一个对脉冲间隔的单调变换，该变换在正确指定的模型下能产生服从 Uniform$(0,1)$ 分布的独立同分布随机变量。\n\n2. 考虑一个在 $[0, 0.6]$ 秒区间上的广义线性模型 (GLM) 点过程强度，该模型采用指数（对数链接）参数化。在时间 $t_1 = 0.2$ 秒和 $t_2 = 0.6$ 秒观测到两个脉冲。除了一个脉冲历史项外，没有其他协变量。条件强度为\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp\\!\\left(\\beta_0 + \\beta_h \\, \\kappa(t - t_1) \\mathbf{1}\\{t  t_1\\}\\right),\n$$\n其中 $\\beta_0 \\in \\mathbb{R}$ 和 $\\beta_h \\in \\mathbb{R}$ 是参数，脉冲历史核函数为\n$$\n\\kappa(s) = \\begin{cases}\n1,  0 \\leq s  0.5, \\\\\n0,  s \\geq 0.5.\n\\end{cases}\n$$\n假设在 $t_1$ 之前脉冲序列历史为空（即在 $t_1$ 之前没有脉冲）。使用你在第1部分中推导的变换，计算与脉冲间隔 $(t_0, t_1)$ 和 $(t_1, t_2)$ 相关联的两个变换后的变量，其中 $t_0 = 0$。将这对变换值的最终答案表示为关于 $\\beta_0$ 和 $\\beta_h$ 的单个闭式解析表达式，并以行向量的形式呈现。时间单位为秒；变换后的变量是无量纲的。不需要进行数值近似或四舍五入；请给出精确表达式。",
            "solution": "这个问题是有效的，因为它在科学上基于点过程理论和计算神经科学，问题设定良好，具有唯一且有意义的解，并且其表述是客观的。所有必要的信息都已提供，不存在矛盾之处。\n\n问题分为两部分。第一部分要求陈述并推导将一般点过程的脉冲间隔(ISIs)转换为独立同分布(i.i.d.)的Uniform$(0,1)$随机变量的变换。第二部分要求将此变换应用于一个特定的神经脉冲序列的广义线性模型(GLM)。\n\n**第1部分：时间重标度变换**\n\n对于具有给定条件强度函数 $\\lambda(t \\mid \\mathcal{H}_t)$ 的简单点过程，时间重标度定理提供了一种模型评估的方法。如果条件强度的模型是正确的，对观测到的脉冲时间进行一个特定的变换，将得到一组服从已知分布的独立同分布随机变量。\n\n令 $\\{t_i\\}$ 为脉冲时间序列，其中 $t_0$ 是观测周期的开始。第 $i$ 个脉冲间隔是 $\\Delta t_i = t_i - t_{i-1}$。令 $\\Delta T_i$ 为与此间隔对应的随机变量。条件强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 在时间 $t$ 充当该过程的风险率。给定截至上一个脉冲 $t_{i-1}$ 的历史，在下一个小时间间隔内出现脉冲的概率取决于此函数。\n\n生存函数 $S(s \\mid \\mathcal{H}_{t_{i-1}})$，即第 $i$ 个脉冲间隔大于时长 $s$ 的概率，由风险函数的乘积积分给出。问题中提供了这个关系：\n$$\nS(s \\mid \\mathcal{H}_{t_{i-1}}) = \\mathbb{P}(\\Delta T_i  s \\mid \\mathcal{H}_{t_{i-1}}) = \\exp\\left(-\\int_{0}^{s} \\lambda(t_{i-1}+u \\mid \\mathcal{H}_{t_{i-1}+u}) \\, du\\right)\n$$\n通过进行变量代换 $v = t_{i-1}+u$，该积分可以重写在绝对时间轴上：\n$$\nS(s \\mid \\mathcal{H}_{t_{i-1}}) = \\exp\\left(-\\int_{t_{i-1}}^{t_{i-1}+s} \\lambda(v \\mid \\mathcal{H}_v) \\, dv\\right)\n$$\n脉冲间隔的累积分布函数(CDF)，$F(s \\mid \\mathcal{H}_{t_{i-1}}) = \\mathbb{P}(\\Delta T_i \\leq s \\mid \\mathcal{H}_{t_{i-1}})$，就是 $1 - S(s \\mid \\mathcal{H}_{t_{i-1}})$。因此，\n$$\nF(s \\mid \\mathcal{H}_{t_{i-1}}) = 1 - \\exp\\left(-\\int_{t_{i-1}}^{t_{i-1}+s} \\lambda(v \\mid \\mathcal{H}_v) \\, dv\\right)\n$$\n根据概率积分变换(PIT)定理，如果 $X$ 是一个具有累积分布函数 $F_X(x)$ 的连续随机变量，那么随机变量 $Y = F_X(X)$ 在区间 $(0,1)$ 上均匀分布。\n\n将PIT应用于我们的情况，我们可以通过在观测到的脉冲间隔时长 $\\Delta t_i = t_i - t_{i-1}$ 处评估每个脉冲间隔的条件CDF，来定义一组变换后的变量 $z_i$。\n$$\nz_i = F(\\Delta t_i \\mid \\mathcal{H}_{t_{i-1}}) = 1 - \\exp\\left(-\\int_{t_{i-1}}^{t_i} \\lambda(v \\mid \\mathcal{H}_v) \\, dv\\right)\n$$\n如果模型 $\\lambda(t \\mid \\mathcal{H}_t)$ 是对真实数据生成过程的正确描述，那么所得到的变量序列 $\\{z_i\\}$ 将是独立同分布的，并服从Uniform$(0,1)$分布。这个变换就是题目所要求的。\n\n这个结果与非齐次泊松过程的时间重标度有关。积分 $\\tau_i = \\int_{t_{i-1}}^{t_i} \\lambda(v \\mid \\mathcal{H}_v) \\, dv$ 可以被解释为“重标度时间”。该定理指出，这些重标度时间 $\\{\\tau_i\\}$ 是来自速率为 $1$ 的标准指数分布的独立同分布随机变量。指数分布(1)的累积分布函数为 $F(x) = 1 - \\exp(-x)$。对变量 $\\tau_i$ 应用PIT，得到 $z_i = F(\\tau_i) = 1-\\exp(-\\tau_i)$，从而产生相同的Uniform$(0,1)$变量。\n\n**第2部分：应用于GLM脉冲序列**\n\n给定在 $[0, 0.6]$ 秒区间上的一个特定GLM条件强度：\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp\\left(\\beta_0 + \\beta_h \\, \\kappa(t - t_1) \\mathbf{1}\\{t  t_1\\}\\right)\n$$\n其脉冲历史核函数为\n$$\n\\kappa(s) = \\begin{cases} 1,  0 \\leq s  0.5 \\\\ 0,  s \\geq 0.5 \\end{cases}\n$$\n观测到的脉冲发生在 $t_1 = 0.2$ 和 $t_2 = 0.6$。观测从 $t_0 = 0$ 开始。我们需要计算与两个脉冲间隔 $(t_0, t_1)$ 和 $(t_1, t_2)$ 相关联的变换后的变量 $z_1$ 和 $z_2$。\n\n**第一个间隔： $(t_0, t_1) = (0, 0.2)$**\n\n第一个变换后的变量是 $z_1 = 1 - \\exp\\left(-\\int_{0}^{0.2} \\lambda(t \\mid \\mathcal{H}_t) \\, dt\\right)$。\n对于 $t \\in [0, 0.2]$，历史 $\\mathcal{H}_t$ 为空，并且条件 $t  t_1$ (即 $t  0.2$) 为假。指示函数 $\\mathbf{1}\\{t  0.2\\}$ 为 $0$。\n因此，条件强度简化为基线率：\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\beta_0 + \\beta_h \\cdot 0) = \\exp(\\beta_0) \\quad \\text{对于 } t \\in [0, 0.2]\n$$\n在此区间上强度的积分为：\n$$\n\\int_{0}^{0.2} \\exp(\\beta_0) \\, dt = \\exp(\\beta_0) \\int_{0}^{0.2} dt = 0.2 \\exp(\\beta_0)\n$$\n因此，第一个变换后的变量是：\n$$\nz_1 = 1 - \\exp(-0.2 \\exp(\\beta_0))\n$$\n\n**第二个间隔： $(t_1, t_2) = (0.2, 0.6)$**\n\n第二个变换后的变量是 $z_2 = 1 - \\exp\\left(-\\int_{0.2}^{0.6} \\lambda(t \\mid \\mathcal{H}_t) \\, dt\\right)$。\n对于 $t \\in (0.2, 0.6]$，历史 $\\mathcal{H}_t$ 包含在 $t_1 = 0.2$ 处的脉冲。条件 $t  t_1$ 为真，因此指示函数 $\\mathbf{1}\\{t  0.2\\}$ 为 $1$。\n核函数的自变量是 $s = t - t_1 = t - 0.2$。当 $t$ 从 $0.2$ 变化到 $0.6$ 时，$s$ 从 $0$ 变化到 $0.4$。\n根据 $\\kappa(s)$ 的定义，对于 $s \\in [0, 0.4]$（它是 $[0, 0.5)$ 的一个子集），我们有 $\\kappa(s) = 1$。\n因此，对于 $t \\in (0.2, 0.6]$，条件强度是恒定的：\n$$\n\\lambda(t \\mid \\mathcal{H}_t) = \\exp(\\beta_0 + \\beta_h \\cdot 1) = \\exp(\\beta_0 + \\beta_h) \\quad \\text{对于 } t \\in (0.2, 0.6]\n$$\n在此区间上强度的积分为：\n$$\n\\int_{0.2}^{0.6} \\exp(\\beta_0 + \\beta_h) \\, dt = \\exp(\\beta_0 + \\beta_h) \\int_{0.2}^{0.6} dt = (0.6 - 0.2) \\exp(\\beta_0 + \\beta_h) = 0.4 \\exp(\\beta_0 + \\beta_h)\n$$\n因此，第二个变换后的变量是：\n$$\nz_2 = 1 - \\exp(-0.4 \\exp(\\beta_0 + \\beta_h))\n$$\n这对变换值 $(z_1, z_2)$ 需要以行向量的形式呈现。\n$$\n\\begin{pmatrix} z_1  z_2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\exp(-0.2 \\exp(\\beta_0))  1 - \\exp(-0.4 \\exp(\\beta_0 + \\beta_h)) \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 - \\exp(-0.2 \\exp(\\beta_0))  1 - \\exp(-0.4 \\exp(\\beta_0 + \\beta_h)) \\end{pmatrix}}\n$$"
        }
    ]
}