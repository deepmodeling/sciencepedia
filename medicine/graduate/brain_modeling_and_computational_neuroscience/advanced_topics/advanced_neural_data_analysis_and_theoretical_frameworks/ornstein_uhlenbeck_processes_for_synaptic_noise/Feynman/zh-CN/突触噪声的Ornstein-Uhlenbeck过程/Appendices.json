{
    "hands_on_practices": [
        {
            "introduction": "在计算神经科学中，对随机过程进行数值模拟是理解其动态行为的基础。本练习将指导您使用最常见的方法之一——欧拉-丸山（Euler-Maruyama）法——来离散化 Ornstein-Uhlenbeck (OU) 过程。通过从头开始推导该数值格式并分析其稳态方差的误差，您将掌握评估数值模拟准确性的关键技能，这对于任何依赖计算机仿真的研究都至关重要 。",
            "id": "4006881",
            "problem": "一个单室神经元接收突触输入，其净涨落被建模为一个 Ornstein–Uhlenbeck (OU) 过程。令 $X_{t}$ 表示突触变量，假设其遵循如下随机微分方程 (SDE)\n$$\n\\mathrm{d}X_{t} \\;=\\; -\\frac{1}{\\tau}\\,\\big(X_{t}-\\mu\\big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_{t},\n$$\n其中 $\\tau>0$ 是相关时间，$\\mu$ 是平均水平，$\\sigma>0$ 是噪声强度，$W_{t}$ 是标准布朗运动（Wiener 过程）。仅从随机微分方程 (SDE) 的定义、布朗运动的 Itō 增量性质以及通用的 Euler–Maruyama (EM) 构造原理出发，推导出一个时间步进格式，该格式在每个时间步长 $\\,\\Delta t>0\\,$ 上使用一个正态随机变量来推进 $X_{t}$。\n\n然后，将得到的离散时间格式视为一个一阶自回归过程，并且在不借助连续 OU 过程的任何闭式精确解的情况下，推导出该离散时间格式的平稳方差，表示为 $\\Delta t$、$\\tau$ 和 $\\sigma$ 的函数。接下来，直接从其矩方程推导连续时间 OU 过程的平稳方差。定义无量纲步长 $h \\equiv \\Delta t/\\tau$ 和相对平稳方差误差\n$$\n\\varepsilon_{\\mathrm{rel}}(h) \\;\\equiv\\; \\frac{\\operatorname{Var}_{\\mathrm{disc}}(h)-\\operatorname{Var}_{\\mathrm{cont}}}{\\operatorname{Var}_{\\mathrm{cont}}}.\n$$\n对于给定的容差 $\\,\\epsilon \\in (0,1)\\,$，施加精度要求 $\\varepsilon_{\\mathrm{rel}}(h) \\le \\epsilon$，并以 $\\epsilon$ 的闭式表达式形式，确定最大允许无量纲步长 $h_{\\max}$。以 $h_{\\max}$ 的解析表达式形式提供你的最终答案。不需要进行数值计算，并且最终表达式不应包含任何单位。",
            "solution": "该问题首先要求使用 Euler-Maruyama 方法推导 Ornstein-Uhlenbeck (OU) 过程的离散时间近似，然后分析此离散格式及其连续时间对应过程的平稳方差，最后确定对时间步长的精度约束。这个问题是适定的且在科学上是合理的，允许进行完整的推导。\n\nOrnstein-Uhlenbeck 过程由以下随机微分方程 (SDE) 描述：\n$$\n\\mathrm{d}X_{t} = -\\frac{1}{\\tau}(X_{t}-\\mu)\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_{t}\n$$\n其中 $\\tau > 0$、$\\mu$ 和 $\\sigma > 0$ 是常数，$W_t$ 是一个标准 Wiener 过程。\n\n首先，我们推导时间步进格式。Euler-Maruyama 方法在一个小的、有限的时间步长 $\\Delta t > 0$ 上近似该 SDE。我们将时间离散化为 $t_n = n \\Delta t$，并令 $X_n \\equiv X_{t_n}$。该微分方程近似为以下差分方程：\n$$\nX_{n+1} - X_n \\approx -\\frac{1}{\\tau}(X_n - \\mu)\\Delta t + \\sigma (W_{t_{n+1}} - W_{t_n})\n$$\nWiener 过程的增量 $\\Delta W_n \\equiv W_{t_{n+1}} - W_{t_n}$ 是一个均值为 0、方差为 $\\Delta t$ 的正态分布随机变量。因此我们可以写出 $\\Delta W_n = \\sqrt{\\Delta t} Z_n$，其中 $Z_n$ 是一个标准正态随机变量，$Z_n \\sim \\mathcal{N}(0,1)$。将此代入差分方程，得到时间步进格式：\n$$\nX_{n+1} = X_n - \\frac{\\Delta t}{\\tau}(X_n - \\mu) + \\sigma \\sqrt{\\Delta t} Z_n\n$$\n整理各项，我们得到：\n$$\nX_{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)X_n + \\frac{\\Delta t}{\\tau}\\mu + \\sigma \\sqrt{\\Delta t} Z_n\n$$\n这就是所需的一阶自回归 AR(1) 过程。\n\n接下来，我们推导这个离散时间格式的平稳方差，我们将其记为 $\\operatorname{Var}_{\\mathrm{disc}}$。一个平稳过程具有不随时间变化的均值和方差。在平稳状态下，令 $\\mathbb{E}[X_n] = \\mu_{\\mathrm{disc}}$ 且 $\\operatorname{Var}(X_n) = \\sigma^2_{\\mathrm{disc}}$ 对所有 $n$ 成立。对该格式取期望，并利用 $\\mathbb{E}[Z_n]=0$：\n$$\n\\mathbb{E}[X_{n+1}] = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\mathbb{E}[X_n] + \\frac{\\Delta t}{\\tau}\\mu\n$$\n$$\n\\mu_{\\mathrm{disc}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\mu_{\\mathrm{disc}} + \\frac{\\Delta t}{\\tau}\\mu\n$$\n解出 $\\mu_{\\mathrm{disc}}$ 得到 $\\mu_{\\mathrm{disc}} = \\mu$。离散过程的平稳均值与连续过程的均值相匹配。\n\n为了求平稳方差，我们计算该格式的方差。由于 $X_n$ 和随后的噪声项 $Z_n$ 是独立的，它们和的方差等于各项方差的和：\n$$\n\\operatorname{Var}(X_{n+1}) = \\operatorname{Var}\\left(\\left(1 - \\frac{\\Delta t}{\\tau}\\right)X_n + \\sigma \\sqrt{\\Delta t} Z_n\\right)\n$$\n$$\n\\operatorname{Var}(X_{n+1}) = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 \\operatorname{Var}(X_n) + (\\sigma \\sqrt{\\Delta t})^2 \\operatorname{Var}(Z_n)\n$$\n在平稳状态下，$\\operatorname{Var}(X_{n+1}) = \\operatorname{Var}(X_n) = \\sigma^2_{\\mathrm{disc}}$，并且由于 $\\operatorname{Var}(Z_n)=1$：\n$$\n\\sigma^2_{\\mathrm{disc}} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 \\sigma^2_{\\mathrm{disc}} + \\sigma^2 \\Delta t\n$$\n解出 $\\sigma^2_{\\mathrm{disc}}$：\n$$\n\\sigma^2_{\\mathrm{disc}}\\left[1 - \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2\\right] = \\sigma^2 \\Delta t\n$$\n$$\n\\sigma^2_{\\mathrm{disc}}\\left[1 - \\left(1 - 2\\frac{\\Delta t}{\\tau} + \\frac{(\\Delta t)^2}{\\tau^2}\\right)\\right] = \\sigma^2 \\Delta t\n$$\n$$\n\\sigma^2_{\\mathrm{disc}}\\left[2\\frac{\\Delta t}{\\tau} - \\frac{(\\Delta t)^2}{\\tau^2}\\right] = \\sigma^2 \\Delta t\n$$\n假设 $\\Delta t \\neq 0$ 且过程是稳定的（这要求 $2\\frac{\\Delta t}{\\tau} - \\frac{(\\Delta t)^2}{\\tau^2} > 0$，即 $\\Delta t  2\\tau$），我们可以相除得到：\n$$\n\\sigma^2_{\\mathrm{disc}} = \\frac{\\sigma^2 \\Delta t}{\\frac{\\Delta t}{\\tau}\\left(2 - \\frac{\\Delta t}{\\tau}\\right)} = \\frac{\\sigma^2 \\tau}{2 - \\frac{\\Delta t}{\\tau}}\n$$\n因此，离散格式的平稳方差是 $\\operatorname{Var}_{\\mathrm{disc}} = \\frac{\\sigma^2 \\tau}{2 - \\Delta t/\\tau}$。\n\n现在，我们推导连续时间 OU 过程的平稳方差 $\\operatorname{Var}_{\\mathrm{cont}}$。令 $Y_t = X_t - \\mu$。$Y_t$ 的 SDE 是 $\\mathrm{d}Y_t = -\\frac{1}{\\tau}Y_t \\mathrm{d}t + \\sigma \\mathrm{d}W_t$。$X_t$ 的方差等于 $Y_t$ 的方差。我们推导二阶矩 $m_2(t) = \\mathbb{E}[Y_t^2]$ 的微分方程。对 $f(Y) = Y^2$ 使用 Itō 引理，我们有 $\\mathrm{d}f(Y_t) = f'(Y_t)\\mathrm{d}Y_t + \\frac{1}{2}f''(Y_t)(\\mathrm{d}Y_t)^2$。这里，$f'(Y) = 2Y$ 且 $f''(Y) = 2$。二次变分为 $(\\mathrm{d}Y_t)^2 = \\sigma^2 \\mathrm{d}t$。\n$$\n\\mathrm{d}(Y_t^2) = 2Y_t \\left(-\\frac{1}{\\tau}Y_t \\mathrm{d}t + \\sigma \\mathrm{d}W_t\\right) + \\frac{1}{2}(2)(\\sigma^2 \\mathrm{d}t) = \\left(-\\frac{2}{\\tau}Y_t^2 + \\sigma^2\\right)\\mathrm{d}t + 2\\sigma Y_t \\mathrm{d}W_t\n$$\n取期望，并注意到 Itō 积分项的期望为零（$\\mathbb{E}[2\\sigma \\int Y_s \\mathrm{d}W_s] = 0$）：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\mathbb{E}[Y_t^2] = -\\frac{2}{\\tau}\\mathbb{E}[Y_t^2] + \\sigma^2\n$$\n在平稳状态下，时间导数为零，所以 $\\frac{\\mathrm{d}m_2}{\\mathrm{d}t} = 0$。令 $m_{2,\\mathrm{ss}}$ 为平稳二阶矩。\n$$\n0 = -\\frac{2}{\\tau}m_{2,\\mathrm{ss}} + \\sigma^2 \\quad \\implies \\quad m_{2,\\mathrm{ss}} = \\frac{\\sigma^2 \\tau}{2}\n$$\n由于 $Y_t$ 的平稳均值为 0，其平稳方差为 $\\operatorname{Var}_{\\mathrm{cont}} = m_{2,\\mathrm{ss}} = \\frac{\\sigma^2 \\tau}{2}$。\n\n我们现在定义无量纲步长 $h \\equiv \\Delta t / \\tau$ 和相对平稳方差误差 $\\varepsilon_{\\mathrm{rel}}(h)$。\n$$\n\\operatorname{Var}_{\\mathrm{disc}}(h) = \\frac{\\sigma^2 \\tau}{2 - h}\n$$\n$$\n\\varepsilon_{\\mathrm{rel}}(h) = \\frac{\\operatorname{Var}_{\\mathrm{disc}}(h)-\\operatorname{Var}_{\\mathrm{cont}}}{\\operatorname{Var}_{\\mathrm{cont}}} = \\frac{\\frac{\\sigma^2 \\tau}{2-h} - \\frac{\\sigma^2 \\tau}{2}}{\\frac{\\sigma^2 \\tau}{2}}\n$$\n消去项 $\\frac{\\sigma^2 \\tau}{2}$：\n$$\n\\varepsilon_{\\mathrm{rel}}(h) = \\frac{\\frac{2}{2-h} - 1}{1} = \\frac{2 - (2-h)}{2-h} = \\frac{h}{2-h}\n$$\n最后，我们对给定的容差 $\\epsilon \\in (0,1)$ 施加精度要求 $\\varepsilon_{\\mathrm{rel}}(h) \\le \\epsilon$，并求出最大允许步长 $h_{\\max}$。\n$$\n\\frac{h}{2-h} \\le \\epsilon\n$$\n为使离散过程稳定，我们必须有 $h  2$，因此分母 $2-h$ 为正。我们可以在不等式两边同乘以 $2-h$ 而不改变不等号的方向。\n$$\nh \\le \\epsilon(2-h) = 2\\epsilon - \\epsilon h\n$$\n$$\nh + \\epsilon h \\le 2\\epsilon\n$$\n$$\nh(1+\\epsilon) \\le 2\\epsilon\n$$\n由于 $1+\\epsilon > 0$，我们可以相除得到：\n$$\nh \\le \\frac{2\\epsilon}{1+\\epsilon}\n$$\n函数 $\\varepsilon_{\\mathrm{rel}}(h)$ 在 $h \\in [0, 2)$ 上是单调递增的。因此，该不等式对于所有 h 直到等号成立的最大值都成立。最大允许无量纲步长为：\n$$\nh_{\\max} = \\frac{2\\epsilon}{1+\\epsilon}\n$$",
            "answer": "$$\n\\boxed{\\frac{2\\epsilon}{1+\\epsilon}}\n$$"
        },
        {
            "introduction": "虽然基本的 OU 过程是一个强大的模型，但生物物理的真实性常常要求我们对其进行调整，以符合物理定律。例如，突触电导在物理上不能为负值。本练习探讨了如何通过在 $g=0$ 处设置一个反射边界来强制执行这一非负约束，并运用福克-普朗克（Fokker-Planck）方程这一强大的分析工具，来推导这种修正如何改变过程的稳态统计特性 。",
            "id": "4006914",
            "problem": "一个常见的突触电导随机模型是Ornstein-Uhlenbeck (OU) 过程，它在类热涨落的驱动下向基线电导弛豫。设无约束的突触电导过程由以下随机微分方程定义\n$$\n\\mathrm{d}g(t) \\;=\\; -\\frac{g(t)-\\mu}{\\tau}\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t,\n$$\n其中 $g(t)$ 是电导，$\\mu$ 是基线电导，$\\tau$ 是弛豫时间常数，$D$ 是扩散强度，$W_t$ 是标准维纳过程（布朗运动）。在生物物理的现实情境中，电导不能为负，因此需要一个机制来确保 $g(t)\\ge 0$。\n\n1. 对上述随机微分方程提出一个最小的修改，以在 $g=0$ 处施加一个完美反射边界（即，样本路径被约束在 $g(t)\\ge 0$ 且在 $g=0$ 处瞬时反射）。请清楚地指明任何附加项及其定义属性。\n\n2. 使用稳态Fokker–Planck方程，在 $g=0$ 处施加无通量边界条件，并在 $g\\to\\infty$ 处有适当的衰减，推导反射过程在 $[0,\\infty)$ 上的稳态概率密度。然后，以闭合形式计算反射过程的稳态均值和稳态方差。用 $\\mu$, $\\tau$, $D$ 以及标准正态概率密度函数和累积分布函数（分别表示为 $\\phi$ 和 $\\Phi$）来表示你的最终公式，其中\n$$\n\\phi(x)\\;=\\;\\frac{1}{\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right), \n\\qquad\n\\Phi(x)\\;=\\;\\int_{-\\infty}^{x}\\phi(u)\\,\\mathrm{d}u.\n$$\n\n3. 简要说明反射过程的稳态均值和方差与无约束OU过程的相应值相比如何。\n\n最终答案应为由反射过程的稳态均值和稳态方差组成的数对。无需进行数值计算；仅需提供闭合形式的表达式。答案不包含单位。无需对答案进行四舍五-入。",
            "solution": "该问题是有效的，因为它具有科学依据、良定、客观且自洽。它是在应用于计算神经科学的随机过程领域中一个标准的可解问题。\n\n**1. 带反射边界的修正随机微分方程**\n\n无约束的Ornstein-Uhlenbeck (OU) 过程由以下随机微分方程 (SDE) 给出：\n$$\n\\mathrm{d}g(t) \\;=\\; -\\frac{g(t)-\\mu}{\\tau}\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t\n$$\n为了在 $g=0$ 处施加一个完美反射边界，使得过程被约束在 $g(t) \\ge 0$，我们引入一个最小的修改，其形式为一个局部时项，记作 $L_t$。反射过程的SDE变为：\n$$\n\\mathrm{d}g(t) \\;=\\; -\\frac{g(t)-\\mu}{\\tau}\\,\\mathrm{d}t \\;+\\; \\sqrt{2D}\\,\\mathrm{d}W_t \\;+\\; \\mathrm{d}L_t\n$$\n附加项 $L_t$ 是过程在边界 $g=0$ 处的局部时。它是一个从 $L_0=0$ 开始的连续、非减过程，并且仅当过程 $g(t)$ 处于边界时才增加。这可以正式表述为：\n$$\nL_t = \\int_0^t I_{\\{g(s)=0\\}}\\,\\mathrm{d}L_s\n$$\n其中 $I_{\\{g(s)=0\\}}$ 是指示函数，当 $g(s)=0$ 时为1，否则为0。每当轨迹碰到边界 $g=0$ 时，该项提供一个正方向的瞬时“推动”，防止其变为负值。\n\n**2. 稳态概率密度、均值和方差**\n\n对于由 $\\mathrm{d}g(t) = A(g)\\,\\mathrm{d}t + B(g)\\,\\mathrm{d}W_t$ 描述的一维扩散过程，其稳态概率密度函数 $p(g)$ 满足稳态Fokker–Planck方程。该方程指出，概率流 $J(g)$ 必须是常数。概率流定义为：\n$$\nJ(g) = A(g)p(g) - \\frac{1}{2}\\frac{\\mathrm{d}}{\\mathrm{d}g}\\left[B(g)^2 p(g)\\right]\n$$\n对于给定的OU过程，漂移系数为 $A(g) = -\\frac{g-\\mu}{\\tau}$，扩散系数为常数 $B(g)^2 = 2D$。因此，概率流为：\n$$\nJ(g) = -\\frac{g-\\mu}{\\tau}p(g) - D\\frac{\\mathrm{d}p(g)}{\\mathrm{d}g}\n$$\n在 $[0, \\infty)$ 上，反射过程的边界条件是：\n1.  在反射边界 $g=0$ 处有无通量条件，即 $J(0) = 0$。\n2.  概率密度在无穷远处必须消失，即当 $g \\to \\infty$ 时 $p(g) \\to 0$。这意味着 $J(\\infty) = 0$。\n\n由于概率流是常数且在边界处为零，它必须在所有地方都为零：对所有 $g \\ge 0$ 都有 $J(g)=0$。这给我们一个关于 $p(g)$ 的一阶常微分方程：\n$$\n-\\frac{g-\\mu}{\\tau}p(g) - D\\frac{\\mathrm{d}p(g)}{\\mathrm{d}g} = 0\n$$\n$$\n\\frac{\\mathrm{d}p}{p} = -\\frac{g-\\mu}{D\\tau}\\,\\mathrm{d}g\n$$\n对两边积分得到：\n$$\n\\ln p(g) = -\\int \\frac{g-\\mu}{D\\tau}\\,\\mathrm{d}g = -\\frac{(g-\\mu)^2}{2D\\tau} + C_0\n$$\n$$\np(g) = C \\exp\\left(-\\frac{(g-\\mu)^2}{2D\\tau}\\right)\n$$\n其中 $C$ 是一个归一化常数。我们定义无约束过程的方差为 $\\sigma^2 = D\\tau$。那么对于 $g \\ge 0$，密度为 $p(g) = C \\exp\\left(-\\frac{(g-\\mu)^2}{2\\sigma^2}\\right)$。常数 $C$ 由归一化条件 $\\int_0^\\infty p(g)\\,\\mathrm{d}g = 1$ 确定。\n$$\n\\int_0^\\infty C \\exp\\left(-\\frac{(g-\\mu)^2}{2\\sigma^2}\\right)\\,\\mathrm{d}g = 1\n$$\n我们进行变量替换，令 $u = (g-\\mu)/\\sigma$。则 $\\mathrm{d}g = \\sigma\\,\\mathrm{d}u$。积分下限变为 $g=0 \\implies u = -\\mu/\\sigma$。积分上限为 $g=\\infty \\implies u=\\infty$。\n$$\nC\\sigma \\int_{-\\mu/\\sigma}^\\infty \\exp\\left(-\\frac{u^2}{2}\\right)\\,\\mathrm{d}u = 1\n$$\n该积分可以用标准正态累积分布函数 $\\Phi(x) = \\int_{-\\infty}^x \\frac{1}{\\sqrt{2\\pi}}\\exp(-u^2/2)\\,\\mathrm{d}u$ 来表示。\n$$\n\\int_{-\\mu/\\sigma}^\\infty \\exp\\left(-\\frac{u^2}{2}\\right)\\,\\mathrm{d}u = \\sqrt{2\\pi}\\left[\\Phi(\\infty) - \\Phi(-\\mu/\\sigma)\\right] = \\sqrt{2\\pi}\\left[1 - \\Phi(-\\mu/\\sigma)\\right]\n$$\n使用恒等式 $\\Phi(x) + \\Phi(-x) = 1$，这变为 $\\sqrt{2\\pi}\\Phi(\\mu/\\sigma)$。\n所以，$C\\sigma\\sqrt{2\\pi}\\Phi(\\mu/\\sigma) = 1$，这给出 $C = \\frac{1}{\\sigma\\sqrt{2\\pi}\\Phi(\\mu/\\sigma)}$。\n反射过程的稳态概率密度是一个截断正态分布：\n$$\np(g) = \\frac{1}{\\sigma\\sqrt{2\\pi}\\Phi(\\mu/\\sigma)} \\exp\\left(-\\frac{(g-\\mu)^2}{2\\sigma^2}\\right) = \\frac{\\phi((g-\\mu)/\\sigma)}{\\sigma\\Phi(\\mu/\\sigma)}, \\quad \\text{for } g \\ge 0\n$$\n\n**稳态均值 ($E_r[g]$):**\n$$\nE_r[g] = \\int_0^\\infty g\\,p(g)\\,\\mathrm{d}g = \\int_0^\\infty (g-\\mu)p(g)\\,\\mathrm{d}g + \\mu\\int_0^\\infty p(g)\\,\\mathrm{d}g = E_r[g-\\mu] + \\mu\n$$\n令 $z = \\mu/\\sigma$。我们计算 $E_r[g-\\mu]$：\n$$\nE_r[g-\\mu] = \\int_0^\\infty (g-\\mu) \\frac{\\phi((g-\\mu)/\\sigma)}{\\sigma\\Phi(z)}\\,\\mathrm{d}g\n$$\n使用代换 $u=(g-\\mu)/\\sigma$，这变为：\n$$\nE_r[g-\\mu] = \\int_{-z}^\\infty \\sigma u \\frac{\\phi(u)}{\\Phi(z)}\\,\\mathrm{d}u = \\frac{\\sigma}{\\Phi(z)} \\int_{-z}^\\infty u \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{u^2}{2}\\right)\\,\\mathrm{d}u\n$$\n该积分的计算结果为 $\\frac{1}{\\sqrt{2\\pi}}\\left[-\\exp(-u^2/2)\\right]_{-z}^\\infty = \\frac{1}{\\sqrt{2\\pi}}\\exp(-(-z)^2/2) = \\phi(z)$。\n因此，$E_r[g-\\mu] = \\sigma \\frac{\\phi(z)}{\\Phi(z)}$。\n稳态均值为：\n$$\nE_r[g] = \\mu + \\sigma \\frac{\\phi(z)}{\\Phi(z)} = \\mu + \\sqrt{D\\tau} \\frac{\\phi(\\mu/\\sqrt{D\\tau})}{\\Phi(\\mu/\\sqrt{D\\tau})}\n$$\n\n**稳态方差 ($Var_r[g]$):**\n方差由 $\\mathrm{Var}_r[g] = E_r[g^2] - (E_r[g])^2$ 给出。对于在 $[a,\\infty)$ 上截断的正态分布，一个已知的结果是其方差为 $\\sigma^2\\left[1 - \\lambda(\\alpha)( \\lambda(\\alpha) - \\alpha)\\right]$，其中 $\\alpha=(a-\\mu)/\\sigma$ 且 $\\lambda(\\alpha)=\\phi(\\alpha)/(1-\\Phi(\\alpha))$。\n在我们的情况下，$a=0$，所以 $\\alpha = -\\mu/\\sigma = -z$。项 $1-\\Phi(\\alpha) = 1-\\Phi(-z) = \\Phi(z)$。因此 $\\lambda(-z) = \\phi(-z)/\\Phi(z) = \\phi(z)/\\Phi(z)$。\n于是方差为：\n$$\n\\mathrm{Var}_r[g] = \\sigma^2 \\left[ 1 - \\frac{\\phi(z)}{\\Phi(z)} \\left( \\frac{\\phi(z)}{\\Phi(z)} - (-z) \\right) \\right] = \\sigma^2 \\left[ 1 - \\frac{z\\phi(z)}{\\Phi(z)} - \\left(\\frac{\\phi(z)}{\\Phi(z)}\\right)^2 \\right]\n$$\n代入 $\\sigma^2 = D\\tau$ 和 $z=\\mu/\\sqrt{D\\tau}$，我们得到：\n$$\n\\mathrm{Var}_r[g] = D\\tau \\left( 1 - \\frac{\\mu}{\\sqrt{D\\tau}}\\frac{\\phi(\\mu/\\sqrt{D\\tau})}{\\Phi(\\mu/\\sqrt{D\\tau})} - \\left(\\frac{\\phi(\\mu/\\sqrt{D\\tau})}{\\Phi(\\mu/\\sqrt{D\\tau})}\\right)^2 \\right)\n$$\n\n**3. 与无约束过程的比较**\n\n对于标准的（无约束的）OU过程，稳态分布是正态分布 $N(\\mu, \\sigma^2)$，其中 $\\sigma^2=D\\tau$。\n-   **稳态均值：** $E_u[g] = \\mu$。\n-   **稳态方差：** $\\mathrm{Var}_u[g] = D\\tau$。\n\n比较这两个过程：\n-   **均值：** 对于任何有限的 $z$，项 $\\sqrt{D\\tau} \\frac{\\phi(z)}{\\Phi(z)}$ 都是严格为正的。因此，$E_r[g] = \\mu + (\\text{正项}) > \\mu = E_u[g]$。反射过程的均值总是大于无约束过程的均值。这是因为反射边界阻止了向负值的偏移，将概率质量推向更高的值，从而增加了平均值。\n-   **方差：** 项 $1 - z\\frac{\\phi(z)}{\\Phi(z)} - (\\frac{\\phi(z)}{\\Phi(z)})^2$ 小于1，因为减去的项是正的。因此，$\\mathrm{Var}_r[g]  D\\tau = \\mathrm{Var}_u[g]$。反射过程的方差总是小于无约束过程的方差。反射边界截断了状态空间，从而减小了分布的整体展宽。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\mu + \\sqrt{D\\tau} \\frac{\\phi\\left(\\frac{\\mu}{\\sqrt{D\\tau}}\\right)}{\\Phi\\left(\\frac{\\mu}{\\sqrt{D\\tau}}\\right)} \\\\ D\\tau \\left( 1 - \\frac{\\mu}{\\sqrt{D\\tau}}\\frac{\\phi\\left(\\frac{\\mu}{\\sqrt{D\\tau}}\\right)}{\\Phi\\left(\\frac{\\mu}{\\sqrt{D\\tau}}\\right)} - \\left(\\frac{\\phi\\left(\\frac{\\mu}{\\sqrt{D\\tau}}\\right)}{\\Phi\\left(\\frac{\\mu}{\\sqrt{D\\tau}}\\right)}\\right)^2 \\right)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个模型的最终价值体现在其与实验数据的联系能力上。这个实践将理论付诸应用，模拟了一个从可观测数据（如微型兴奋性突触后电流，mEPSCs）中推断潜在突触动力学参数的典型场景。您的任务是推导 OU 过程参数的估计量，从而将在抽象的理论模型和具体的实验测量之间架起一座桥梁，这是成为一名计算建模者的核心技能之一 。",
            "id": "4006846",
            "problem": "在脑建模和计算神经科学的背景下，您面临一项关于突触噪声的建模任务，该噪声由一个 Ornstein-Uhlenbeck 过程表示。微型兴奋性突触后电流 (mEPSC) 被建模为源自一个带有记录噪声的潜在突触电导过程。请使用第一性原理，基于可观测的分布统计量和释放概率，为 Ornstein-Uhlenbeck 参数推导一个估计器。\n\n从以下基础和假设开始：\n\n- 潜在的突触电导 $g(t)$ 服从 Ornstein-Uhlenbeck 随机微分方程\n$$\n\\mathrm{d}g(t) = -\\frac{1}{\\tau}\\left(g(t)-\\mu\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t),\n$$\n其中 $W(t)$ 是一个标准维纳过程（布朗运动），$\\mu$、$\\sigma$、$\\tau$ 是恒定参数。$g(t)$ 的稳态分布是均值为 $\\mu$、方差依赖于 $\\sigma$ 和 $\\tau$ 的高斯分布。\n- 在每次试验中，释放事件以概率 $p$ 发生，且各次试验间独立。设 $I\\in\\{0,1\\}$ 为伯努利指示变量，满足 $\\mathbb{P}(I=1)=p$。在 $I=1$ 的条件下，观测到的 mEPSC 幅值被建模为 $X=G+\\varepsilon$；在 $I=0$ 的条件下，被建模为 $X=\\varepsilon$，其中 $G$ 是从 Ornstein-Uhlenbeck 过程的稳态中抽取的一个样本，而 $\\varepsilon$ 是独立的加性记录噪声。\n- 记录噪声 $\\varepsilon$ 被建模为均值为零、已知方差为 $v_n$ 的高斯噪声，各次试验间独立，且独立于 $G$。\n- 在 $I=1$ 的试验中，间隔为 $\\Delta t$ 的连续两次试验的幅值之间存在相关性，这是由潜在 Ornstein-Uhlenbeck 过程的自相关和加性噪声共同导致的。\n\n对于每个测试用例，您将获得以下数据：\n- 释放概率 $p$（无单位，以小数表示）。\n- 记录噪声方差 $v_n$，单位为平方皮安 (pA$^2$)。\n- 试验间隔 $\\Delta t$，单位为毫秒 (ms)。\n- 在所有试验中观测到的幅值均值 $m_{\\mathrm{obs}}$，单位为皮安 (pA)。\n- 在所有试验中观测到的幅值方差 $s^2_{\\mathrm{obs}}$，单位为平方皮安 (pA$^2$)。\n- 观测到的条件 Pearson 相关系数 $r_{\\mathrm{obs}}$（无单位），这是连续两次试验的幅值之间的相关性，且仅在两次试验都发生释放事件（两次的 $I$ 均为 1）的试验对上进行计算。\n\n您的任务是：\n1. 根据所述假设、Ornstein-Uhlenbeck 稳态特性和独立性结构，推导将可观测统计量 $m_{\\mathrm{obs}}$、$s^2_{\\mathrm{obs}}$、$r_{\\mathrm{obs}}$ 与参数 $\\mu$、$\\sigma$ 和 $\\tau$ 联系起来的表达式，并明确地考虑由随机释放导致的混合效应以及加性记录噪声。\n2. 使用这些推导出的关系式，根据 $(p,v_n,\\Delta t,m_{\\mathrm{obs}},s^2_{\\mathrm{obs}},r_{\\mathrm{obs}})$ 计算参数估计值 $(\\widehat{\\mu},\\widehat{\\sigma},\\widehat{\\tau})$。\n\n单位和输出：\n- 以皮安 (pA) 为单位报告 $\\widehat{\\mu}$。\n- 以皮安每平方根毫秒 (pA$/\\sqrt{\\mathrm{ms}}$) 为单位报告 $\\widehat{\\sigma}$。\n- 以毫秒 (ms) 为单位报告 $\\widehat{\\tau}$。\n- 对于数值输出，不应包含单位字符串；数值必须是四舍五入到六位小数的浮点数。\n\n测试集：\n为以下各组参数集计算 $(\\widehat{\\mu},\\widehat{\\sigma},\\widehat{\\tau})$。所有量均以上述指定的适当单位给出，数值以十进制形式书写。\n\n- 案例 1：$p=0.35$，$v_n=9$，$\\Delta t=2$，$m_{\\mathrm{obs}}=4.2$，$s^2_{\\mathrm{obs}}=58.56$，$r_{\\mathrm{obs}}=0.603108$。\n- 案例 2：$p=0.05$，$v_n=4$，$\\Delta t=5$，$m_{\\mathrm{obs}}=0.4$，$s^2_{\\mathrm{obs}}=9.29$，$r_{\\mathrm{obs}}=0.557019$。\n- 案例 3：$p=0.95$，$v_n=1$，$\\Delta t=1$，$m_{\\mathrm{obs}}=4.75$，$s^2_{\\mathrm{obs}}=7.8875$，$r_{\\mathrm{obs}}=0.614169$。\n- 案例 4：$p=0.4$，$v_n=100$，$\\Delta t=4$，$m_{\\mathrm{obs}}=6.0$，$s^2_{\\mathrm{obs}}=211.6$，$r_{\\mathrm{obs}}=0.358000$。\n- 案例 5：$p=0.5$，$v_n=10$，$\\Delta t=20$，$m_{\\mathrm{obs}}=3.5$，$s^2_{\\mathrm{obs}}=27.25$，$r_{\\mathrm{obs}}=0.183940$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身是针对上述五个案例的一个包含三个浮点数 $[\\widehat{\\mu},\\widehat{\\sigma},\\widehat{\\tau}]$ 的列表，顺序如指定。例如，最终输出格式必须类似于\n$[[\\widehat{\\mu}_1,\\widehat{\\sigma}_1,\\widehat{\\tau}_1],[\\widehat{\\mu}_2,\\widehat{\\sigma}_2,\\widehat{\\tau}_2],\\dots]$\n所有数值都四舍五入到六位小数，且不包含单位字符串。",
            "solution": "本任务是从一组可观测统计量中推导 Ornstein-Uhlenbeck (OU) 过程的参数 $(\\mu, \\sigma, \\tau)$ 的估计量。推导过程基于所提供的模型假设，从第一性原理出发。\n\n潜在的突触电导 $g(t)$ 由 Ornstein-Uhlenbeck 随机微分方程描述：\n$$\n\\mathrm{d}g(t) = -\\frac{1}{\\tau}\\left(g(t)-\\mu\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t)\n$$\n这个过程是基础。其在稳态下的关键统计特性如下：\n1.  $g(t)$ 的平稳分布是一个高斯分布，$G \\sim \\mathcal{N}(\\mu, v_g)$，我们用随机变量 $G$ 来表示这个分布的抽样。\n2.  该分布的均值为 $\\mathbb{E}[G] = \\mu$。\n3.  方差 $v_g = \\mathrm{Var}(G)$ 是过程参数的函数：$v_g = \\frac{\\sigma^2 \\tau}{2}$。\n4.  时间延迟为 $\\Delta t$ 的自相关函数为 $\\mathrm{Corr}(g(t), g(t+\\Delta t)) = e^{-\\Delta t/\\tau}$，由此可得自协方差为 $\\mathrm{Cov}(g(t), g(t+\\Delta t)) = \\mathrm{Var}(G) e^{-\\Delta t/\\tau} = v_g e^{-\\Delta t/\\tau}$。\n\n观测到的 mEPSC 幅值 $X$ 被建模为一个反映随机突触释放的混合模型。释放事件以概率 $p$ 发生，由伯努利变量 $I \\sim \\mathrm{Bernoulli}(p)$ 指示。如果发生释放（$I=1$），观测幅值为 $X = G + \\varepsilon$；如果释放失败（$I=0$），则为 $X = \\varepsilon$。记录噪声 $\\varepsilon$ 独立于信号 $G$，并服从高斯分布 $\\varepsilon \\sim \\mathcal{N}(0, v_n)$。这可以紧凑地写作 $X = I \\cdot G + \\varepsilon$。\n\n我们通过将 $X$ 的理论矩与观测到的统计量（$m_{\\mathrm{obs}}$、$s^2_{\\mathrm{obs}}$、$r_{\\mathrm{obs}}$）联系起来，来推导这些估计量。\n\n**步骤 1：平均电导 $\\mu$ 的估计量推导**\n\n我们将观测到的平均幅值 $m_{\\mathrm{obs}}$ 与 $\\mu$ 联系起来。对 $X = I \\cdot G + \\varepsilon$ 使用全期望定律：\n$$\nm_{\\mathrm{obs}} = \\mathbb{E}[X] = \\mathbb{E}[I \\cdot G + \\varepsilon]\n$$\n由于 $I$、$G$ 和 $\\varepsilon$ 的独立性，且 $\\mathbb{E}[\\varepsilon]=0$：\n$$\nm_{\\mathrm{obs}} = \\mathbb{E}[I] \\mathbb{E}[G] + \\mathbb{E}[\\varepsilon] = p \\cdot \\mu + 0 = p\\mu\n$$\n这提供了一个直接的关系。求解 $\\mu$，我们得到估计量：\n$$\n\\widehat{\\mu} = \\frac{m_{\\mathrm{obs}}}{p}\n$$\n\n**步骤 2：潜在方差 $v_g$ 的推导**\n\n我们将观测到的方差 $s^2_{\\mathrm{obs}}$ 与潜在方差 $v_g$ 联系起来。对 $X$ 使用全方差定律：\n$$\ns^2_{\\mathrm{obs}} = \\mathrm{Var}(X) = \\mathbb{E}[\\mathrm{Var}(X|I)] + \\mathrm{Var}(\\mathbb{E}[X|I])\n$$\n我们分别计算每一项。\n对于第一项 $\\mathbb{E}[\\mathrm{Var}(X|I)]$：\n-   在 $I=1$ 的条件下：$X = G+\\varepsilon$。由于 $G$ 和 $\\varepsilon$ 独立，$\\mathrm{Var}(X|I=1) = \\mathrm{Var}(G) + \\mathrm{Var}(\\varepsilon) = v_g + v_n$。\n-   在 $I=0$ 的条件下：$X = \\varepsilon$。因此，$\\mathrm{Var}(X|I=0) = \\mathrm{Var}(\\varepsilon) = v_n$。\n因此，期望值为：\n$$\n\\mathbb{E}[\\mathrm{Var}(X|I)] = \\mathrm{Var}(X|I=1)\\cdot p + \\mathrm{Var}(X|I=0)\\cdot(1-p) = (v_g + v_n)p + v_n(1-p) = p v_g + v_n\n$$\n对于第二项 $\\mathrm{Var}(\\mathbb{E}[X|I])$：\n-   在 $I=1$ 的条件下：$\\mathbb{E}[X|I=1] = \\mathbb{E}[G+\\varepsilon] = \\mu+0 = \\mu$。\n-   在 $I=0$ 的条件下：$\\mathbb{E}[X|I=0] = \\mathbb{E}[\\varepsilon] = 0$。\n随机变量 $\\mathbb{E}[X|I]$ 以概率 $p$ 取值 $\\mu$，以概率 $1-p$ 取值 $0$。这个类伯努利变量的方差是：\n$$\n\\mathrm{Var}(\\mathbb{E}[X|I]) = \\mathbb{E}[(\\mathbb{E}[X|I])^2] - (\\mathbb{E}[\\mathbb{E}[X|I]])^2 = (\\mu^2 p + 0^2(1-p)) - (p\\mu)^2 = p\\mu^2 - p^2\\mu^2 = p(1-p)\\mu^2\n$$\n将两项合并，总方差为：\n$$\ns^2_{\\mathrm{obs}} = (p v_g + v_n) + p(1-p)\\mu^2\n$$\n求解 $v_g$，我们通过代入 $\\widehat{\\mu}$ 得到估计量 $\\widehat{v_g}$：\n$$\n\\widehat{v_g} = \\frac{s^2_{\\mathrm{obs}} - v_n - p(1-p)\\widehat{\\mu}^2}{p} = \\frac{1}{p}\\left(s^2_{\\mathrm{obs}} - v_n - p(1-p)\\left(\\frac{m_{\\mathrm{obs}}}{p}\\right)^2\\right) = \\frac{1}{p}\\left(s^2_{\\mathrm{obs}} - v_n - \\frac{1-p}{p}m_{\\mathrm{obs}}^2\\right)\n$$\n\n**步骤 3：时间常数 $\\tau$ 的估计量推导**\n\n观测到的相关系数 $r_{\\mathrm{obs}}$ 与 $\\tau$ 相关。该相关系数是在两次试验都发生释放事件（$I_1=1, I_2=1$）的条件下，在时间间隔为 $\\Delta t$ 的两次连续试验（记为 $X_1$ 和 $X_2$）的幅值之间计算的。\n设 $X'_1 = X_1|_{I_1=1} = G_1+\\varepsilon_1$ 和 $X'_2 = X_2|_{I_2=1} = G_2+\\varepsilon_2$。\n$$\nr_{\\mathrm{obs}} = \\mathrm{Corr}(X'_1, X'_2) = \\frac{\\mathrm{Cov}(X'_1, X'_2)}{\\sqrt{\\mathrm{Var}(X'_1)\\mathrm{Var}(X'_2)}}\n$$\n分母中的方差为 $\\mathrm{Var}(X'_1) = \\mathrm{Var}(G_1+\\varepsilon_1) = \\mathrm{Var}(G_1)+\\mathrm{Var}(\\varepsilon_1) = v_g + v_n$。\n分子中的协方差为 $\\mathrm{Cov}(G_1+\\varepsilon_1, G_2+\\varepsilon_2)$。鉴于 $\\varepsilon_1, \\varepsilon_2$ 彼此独立且独立于潜在过程 $G$，该式可简化为：\n$$\n\\mathrm{Cov}(G_1, G_2) + \\mathrm{Cov}(G_1, \\varepsilon_2) + \\mathrm{Cov}(\\varepsilon_1, G_2) + \\mathrm{Cov}(\\varepsilon_1, \\varepsilon_2) = \\mathrm{Cov}(G_1, G_2) = v_g e^{-\\Delta t/\\tau}\n$$\n将这些代入相关系数公式：\n$$\nr_{\\mathrm{obs}} = \\frac{v_g e^{-\\Delta t/\\tau}}{v_g + v_n}\n$$\n我们通过先分离指数项来求解 $\\tau$：\n$$\ne^{-\\Delta t/\\tau} = r_{\\mathrm{obs}} \\frac{v_g + v_n}{v_g} = r_{\\mathrm{obs}}\\left(1 + \\frac{v_n}{v_g}\\right)\n$$\n对两边取自然对数：\n$$\n-\\frac{\\Delta t}{\\tau} = \\ln\\left(r_{\\mathrm{obs}}\\left(1 + \\frac{v_n}{v_g}\\right)\\right)\n$$\n这给出了 $\\tau$ 的估计量：\n$$\n\\widehat{\\tau} = -\\frac{\\Delta t}{\\ln\\left(r_{\\mathrm{obs}}\\left(1 + \\frac{v_n}{\\widehat{v_g}}\\right)\\right)}\n$$\n\n**步骤 4：噪声幅值 $\\sigma$ 的估计量推导**\n\n最后，我们使用定义关系 $v_g = \\frac{\\sigma^2 \\tau}{2}$ 来求解 $\\sigma$。整理公式可得 $\\sigma^2 = \\frac{2v_g}{\\tau}$。取平方根得到 $\\sigma$ 的估计量：\n$$\n\\widehat{\\sigma} = \\sqrt{\\frac{2\\widehat{v_g}}{\\widehat{\\tau}}}\n$$\n参数 $\\sigma$ 必须为非负数，因此我们取正根。至此，我们完成了对所有三个未知参数的推导。\n\n计算步骤是针对每个测试用例，依次应用这四个推导出的公式，并使用所提供的可观测统计量。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes Ornstein-Uhlenbeck process parameters from observable statistics.\n    \"\"\"\n    # Test cases defined as tuples of (p, v_n, Delta_t, m_obs, s^2_obs, r_obs)\n    test_cases = [\n        # p, v_n, Delta_t, m_obs, s^2_obs, r_obs\n        (0.35, 9.0, 2.0, 4.2, 58.56, 0.603108),\n        (0.05, 4.0, 5.0, 0.4, 9.29, 0.557019),\n        (0.95, 1.0, 1.0, 4.75, 7.8875, 0.614169),\n        (0.4, 100.0, 4.0, 6.0, 211.6, 0.358000),\n        (0.5, 10.0, 20.0, 3.5, 27.25, 0.183940),\n    ]\n\n    results_as_lists = []\n    for case in test_cases:\n        p, v_n, delta_t, m_obs, s2_obs, r_obs = case\n\n        # Step 1: Estimate mu\n        # mu_hat = m_obs / p\n        if p == 0:\n            # Avoid division by zero, although not expected in these test cases\n            # Based on validation, p > 0 for all cases.\n            mu_hat = float('nan') \n        else:\n            mu_hat = m_obs / p\n\n        # Step 2: Estimate latent variance v_g\n        # v_g_hat = (s^2_obs - v_n - p*(1-p)*mu_hat^2) / p\n        # which simplifies to avoid re-using mu_hat:\n        # v_g_hat = (s^2_obs - v_n - ((1-p)/p)*m_obs^2) / p\n        if p == 0:\n            v_g_hat = float('nan')\n        else:\n            term_mu_sq = ((1 - p) / p) * (m_obs ** 2)\n            v_g_hat = (s2_obs - v_n - term_mu_sq) / p\n\n        # Step 3: Estimate time constant tau\n        # tau_hat = -delta_t / ln(r_obs * (1 + v_n / v_g_hat))\n        if v_g_hat = 0:\n            tau_hat = float('nan')\n        else:\n            log_arg = r_obs * (1 + v_n / v_g_hat)\n            if log_arg = 0 or log_arg >= 1:\n                tau_hat = float('nan') \n            else:\n                tau_hat = -delta_t / np.log(log_arg)\n\n        # Step 4: Estimate noise amplitude sigma\n        # sigma_hat = sqrt(2 * v_g_hat / tau_hat)\n        if tau_hat = 0 or v_g_hat  0:\n            sigma_hat = float('nan')\n        else:\n            sigma_hat = math.sqrt(2 * v_g_hat / tau_hat)\n\n        # Append results in specified order (mu, sigma, tau), rounded to 6 decimal places.\n        results_as_lists.append([\n            round(mu_hat, 6),\n            round(sigma_hat, 6),\n            round(tau_hat, 6)\n        ])\n        \n    # Format the final output string as a list of lists.\n    # The map(str, ...) will call str() on each sublist, e.g., str([1.0, 2.0, 3.0]) -> '[1.0, 2.0, 3.0]'\n    # Joining these with a comma and enclosing in brackets produces the required format.\n    # To match the example format exactly (no spaces after commas), we build the strings manually.\n    result_strings = []\n    for sublist in results_as_lists:\n        # Convert each float to string, with the required precision.\n        # Although round() was used, printing ensures trailing zeros if needed.\n        str_vals = [f\"{val:.6f}\" for val in sublist]\n        result_strings.append(f\"[{','.join(str_vals)}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}