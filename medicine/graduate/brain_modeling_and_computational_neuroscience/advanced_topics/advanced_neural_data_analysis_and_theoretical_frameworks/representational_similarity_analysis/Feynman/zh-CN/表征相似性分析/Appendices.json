{
    "hands_on_practices": [
        {
            "introduction": "表征相似性分析（RSA）的核心是构建表征非相似性矩阵（RDM）。本练习将引导你完成一个基础但至关重要的任务：从给定的多体素活动模式中，使用欧几里得距离来计算一个RDM。通过这个实践，你将具体理解RDM是如何从原始数据中诞生的，并学会如何通过分析其结构来揭示神经表征中潜在的类别信息。",
            "id": "4015383",
            "problem": "在表征相似性分析（RSA）中，一个核心工具是表征非相似性矩阵（RDM），它总结了由不同实验条件诱发的多体素模式之间的成对非相似性。考虑一个在3个体素上测量的4个实验条件的条件-体素响应矩阵 $X \\in \\mathbb{R}^{4 \\times 3}$：\n$$\nX \\;=\\;\n\\begin{pmatrix}\n5  1  0 \\\\\n4  2  0 \\\\\n0  4  5 \\\\\n1  5  4\n\\end{pmatrix}.\n$$\n假设条件1和2属于类别$\\mathcal{A}$，条件3和4属于类别$\\mathcal{B}$。使用体素响应间的欧几里得距离，计算4x4的RDM，其中第$(i,j)$个元素是条件$i$和$j$的多体素模式之间的距离。然后，通过首先计算类别内平均非相似性（即对 $\\{(1,2),(3,4)\\}$ 的距离均值）和类别间平均非相似性（即对 $\\{(1,3),(1,4),(2,3),(2,4)\\}$ 的距离均值），来量化类别的可分性。定义可分性指数\n$$\nS \\;=\\; \\frac{d_{\\mathrm{between}} - d_{\\mathrm{within}}}{d_{\\mathrm{within}}}.\n$$\n基于这些距离，讨论此数据集中RDM的结构如何反映类别可分性。将 $S$ 的单个数值作为最终答案报告，四舍五入到4位有效数字。该答案是一个无量纲的比率。",
            "solution": "首先验证问题，以确保其具有科学依据、是良定的和客观的。\n\n### 步骤1：提取已知条件\n- 给定了条件-体素响应矩阵 $X \\in \\mathbb{R}^{4 \\times 3}$：\n$$\nX \\;=\\;\n\\begin{pmatrix}\n5  1  0 \\\\\n4  2  0 \\\\\n0  4  5 \\\\\n1  5  4\n\\end{pmatrix}\n$$\n- 问题涉及4个条件和3个体素。\n- 类别成员已定义：条件1和2属于类别 $\\mathcal{A}$，条件3和4属于类别 $\\mathcal{B}$。\n- 非相似性度量是欧几里得距离。\n- 任务是计算4x4的表征非相似性矩阵（RDM）。\n- 类别内平均非相似性 $d_{\\mathrm{within}}$ 是对 $\\{(1,2),(3,4)\\}$ 距离的均值。\n- 类别间平均非相似性 $d_{\\mathrm{between}}$ 是对 $\\{(1,3),(1,4),(2,3),(2,4)\\}$ 距离的均值。\n- 可分性指数定义为 $S = \\frac{d_{\\mathrm{between}} - d_{\\mathrm{within}}}{d_{\\mathrm{within}}}$。\n- 要求的最终答案是 $S$ 的数值，四舍五入到4位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为表征相似性分析（RSA）、RDM和类别可分性是计算神经科学和大脑建模中的标准概念。该问题是良定的，提供了所有必要的数据（矩阵 $X$）、定义（类别分配）和公式（欧几里得距离、$d_{\\mathrm{within}}$、$d_{\\mathrm{between}}$ 和 $S$），以得到唯一解。语言客观且精确。问题是自洽的、一致的，并且没有违反任何基本原则。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答\n4个条件的多体素响应模式是矩阵 $X$ 的行向量。令这些向量表示为 $\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3, \\mathbf{x}_4 \\in \\mathbb{R}^3$：\n$$\n\\mathbf{x}_1 = (5, 1, 0)\n$$\n$$\n\\mathbf{x}_2 = (4, 2, 0)\n$$\n$$\n\\mathbf{x}_3 = (0, 4, 5)\n$$\n$$\n\\mathbf{x}_4 = (1, 5, 4)\n$$\nRDM的第 $(i,j)$ 个元素是响应向量 $\\mathbf{x}_i$ 和 $\\mathbf{x}_j$ 之间的欧几里得距离 $d_{ij}$。两个向量 $\\mathbf{a}=(a_1, a_2, a_3)$ 和 $\\mathbf{b}=(b_1, b_2, b_3)$ 之间的欧几里得距离公式为 $d(\\mathbf{a}, \\mathbf{b}) = \\sqrt{(a_1-b_1)^2 + (a_2-b_2)^2 + (a_3-b_3)^2}$。\n\n首先，我们计算分析所需的成对距离。这些距离构成了4x4 RDM的非对角线元素。RDM是对称的（$d_{ij} = d_{ji}$），且对角线元素为零（$d_{ii}=0$）。\n\n类别内距离为 $d_{12}$（对于类别 $\\mathcal{A}$）和 $d_{34}$（对于类别 $\\mathcal{B}$）：\n$$\nd_{12} = \\sqrt{(5-4)^2 + (1-2)^2 + (0-0)^2} = \\sqrt{1^2 + (-1)^2 + 0^2} = \\sqrt{1+1} = \\sqrt{2}\n$$\n$$\nd_{34} = \\sqrt{(0-1)^2 + (4-5)^2 + (5-4)^2} = \\sqrt{(-1)^2 + (-1)^2 + 1^2} = \\sqrt{1+1+1} = \\sqrt{3}\n$$\n\n类别间距离为 $d_{13}$、$d_{14}$、$d_{23}$ 和 $d_{24}$：\n$$\nd_{13} = \\sqrt{(5-0)^2 + (1-4)^2 + (0-5)^2} = \\sqrt{5^2 + (-3)^2 + (-5)^2} = \\sqrt{25+9+25} = \\sqrt{59}\n$$\n$$\nd_{14} = \\sqrt{(5-1)^2 + (1-5)^2 + (0-4)^2} = \\sqrt{4^2 + (-4)^2 + (-4)^2} = \\sqrt{16+16+16} = \\sqrt{48}\n$$\n$$\nd_{23} = \\sqrt{(4-0)^2 + (2-4)^2 + (0-5)^2} = \\sqrt{4^2 + (-2)^2 + (-5)^2} = \\sqrt{16+4+25} = \\sqrt{45}\n$$\n$$\nd_{24} = \\sqrt{(4-1)^2 + (2-5)^2 + (0-4)^2} = \\sqrt{3^2 + (-3)^2 + (-4)^2} = \\sqrt{9+9+16} = \\sqrt{34}\n$$\n\n完整的RDM为：\n$$\n\\mathrm{RDM} =\n\\begin{pmatrix}\n0  \\sqrt{2}  \\sqrt{59}  \\sqrt{48} \\\\\n\\sqrt{2}  0  \\sqrt{45}  \\sqrt{34} \\\\\n\\sqrt{59}  \\sqrt{45}  0  \\sqrt{3} \\\\\n\\sqrt{48}  \\sqrt{34}  \\sqrt{3}  0\n\\end{pmatrix}\n$$\n\n接下来，我们计算类别内和类别间的平均非相似性。\n类别内平均非相似性 $d_{\\mathrm{within}}$ 是同一类别内各对（即(1,2)和(3,4)）非相似性的均值。\n$$\nd_{\\mathrm{within}} = \\frac{d_{12} + d_{34}}{2} = \\frac{\\sqrt{2} + \\sqrt{3}}{2}\n$$\n类别间平均非相似性 $d_{\\mathrm{between}}$ 是不同类别间各对（即(1,3)、(1,4)、(2,3)和(2,4)）非相似性的均值。\n$$\nd_{\\mathrm{between}} = \\frac{d_{13} + d_{14} + d_{23} + d_{24}}{4} = \\frac{\\sqrt{59} + \\sqrt{48} + \\sqrt{45} + \\sqrt{34}}{4}\n$$\n\nRDM的结构反映了类别的可分性。如果条件按类别排序，RDM会呈现出块状结构。对角块包含类别内的非相似性（例如，左上角的2x2块对应类别 $\\mathcal{A}$，右下角的2x2块对应类别 $\\mathcal{B}$）。非对角块包含类别间的非相似性。对于这个数据集，类别内的非相似性（$\\sqrt{2} \\approx 1.414$ 和 $\\sqrt{3} \\approx 1.732$）显著小于类别间的非相似性（$\\sqrt{59} \\approx 7.68$、$\\sqrt{48} \\approx 6.93$、$\\sqrt{45} \\approx 6.71$、$\\sqrt{34} \\approx 5.83$）。RDM中的这种视觉模式，即对角块的值较低而非对角块的值较高，表明同一类别内项目的神经表征模式彼此之间比与不同类别项目的模式更相似。这意味着数据中存在强烈的类别结构。\n\n最后，我们计算可分性指数 $S$：\n$$\nS = \\frac{d_{\\mathrm{between}} - d_{\\mathrm{within}}}{d_{\\mathrm{within}}}\n$$\n我们代入 $d_{\\mathrm{within}}$ 和 $d_{\\mathrm{between}}$ 的表达式：\n$$\nS = \\frac{\\frac{\\sqrt{59} + \\sqrt{48} + \\sqrt{45} + \\sqrt{34}}{4} - \\frac{\\sqrt{2} + \\sqrt{3}}{2}}{\\frac{\\sqrt{2} + \\sqrt{3}}{2}}\n$$\n为了获得最终的数值答案，我们计算这些表达式的值：\n$$\nd_{\\mathrm{within}} \\approx \\frac{1.41421 + 1.73205}{2} = \\frac{3.14626}{2} \\approx 1.57313\n$$\n$$\nd_{\\mathrm{between}} \\approx \\frac{7.68115 + 6.92820 + 6.70820 + 5.83095}{4} = \\frac{27.14850}{4} \\approx 6.78713\n$$\n现在，我们计算 $S$：\n$$\nS \\approx \\frac{6.78713 - 1.57313}{1.57313} = \\frac{5.21400}{1.57313} \\approx 3.31441\n$$\n四舍五入到4位有效数字，我们得到 $S \\approx 3.314$。$S$ 的这个大的正值从定量上证实了从RDM结构中定性观察到的强类别可分性。",
            "answer": "$$\\boxed{3.314}$$"
        },
        {
            "introduction": "虽然欧几里得距离简单直观，但它忽略了神经数据中普遍存在的噪声相关性。为了更准确地量化表征的几何结构，我们需要一个更复杂的度量。本练习将介绍马氏距离（Mahalanobis distance），它通过对噪声协方差进行归一化（即“白化”数据）来提供一个更稳健的非相似性估计。完成这个练习需要你运用线性代数知识来处理协方差矩阵，这是在高级神经数据分析中一项至关重要的技能。",
            "id": "4015346",
            "problem": "在表征相似性分析 (RSA) 中，一种量化多变量神经模式之间不相似性的常用方法是使用白化空间中的欧几里得距离，这对应于在经验估计的噪声协方差下的马氏距离。考虑一个玩具数据集，其中包含 $3$ 个实验条件下 $2$ 个体素的体素模式，特定于条件的响应向量为 $x_{1} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$，$x_{2} = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}$ 和 $x_{3} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$。假设从基线测量中估计的体素间经验噪声协方差为\n$$\n\\Sigma = \\begin{pmatrix} 2  0.5 \\\\ 0.5  2 \\end{pmatrix}.\n$$\n从协方差的定义和对称正定矩阵的谱性质出发，通过正交对角化构建平方根的逆 $\\,\\Sigma^{-1/2}\\,$，用它来白化模式 $y_{i} = \\Sigma^{-1/2} x_{i}$，计算白化后模式之间的成对欧几里得距离 $d_{12}$、$d_{13}$ 和 $d_{23}$，然后计算这三个距离的算术平均值。将最终数值答案四舍五入到四位有效数字。将最终量表示为无量纲数。",
            "solution": "表征相似性分析 (RSA) 通过不相似性度量来比较特定于条件的多变量模式。当经验噪声协方差 $\\,\\Sigma\\,$ 可用时，两个模式 $\\,x\\,$ 和 $\\,x'\\,$ 之间的马氏距离为\n$$\nd_{M}(x,x') \\equiv \\left( (x - x')^{\\top} \\Sigma^{-1} (x - x') \\right)^{1/2},\n$$\n这等于白化后模式 $\\,y = \\Sigma^{-1/2} x\\,$ 和 $\\,y' = \\Sigma^{-1/2} x'\\,$ 之间的欧几里得距离：\n$$\n\\|y - y'\\|_{2} = \\left\\| \\Sigma^{-1/2} (x - x') \\right\\|_{2} = d_{M}(x,x').\n$$\n因此，要计算白化距离，我们需要 $\\,\\Sigma^{-1/2}\\,$。\n\n基本原理：经验协方差矩阵 $\\,\\Sigma\\,$ 是对称正定的。根据谱定理，任何对称正定矩阵都允许正交对角化 $\\,\\Sigma = U \\Lambda U^{\\top}\\,$，其中 $\\,U\\,$ 是正交规范的，$\\,\\Lambda\\,$ 是具有正元素的对角矩阵。由此得出\n$$\n\\Sigma^{-1/2} = U \\Lambda^{-1/2} U^{\\top},\n$$\n其中 $\\,\\Lambda^{-1/2}\\,$ 是通过取特征值的平方根的倒数形成的对角矩阵。\n\n步骤 1：$\\,\\Sigma\\,$ 的特征分解。矩阵\n$$\n\\Sigma = \\begin{pmatrix} 2  0.5 \\\\ 0.5  2 \\end{pmatrix}\n$$\n具有形式 $\\,\\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}\\,$，其中 $\\,a = 2\\,$ 且 $\\,b = 0.5\\,$。其特征向量为 $\\,u_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\\,$ 和 $\\,u_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\,$，对应的特征值为\n$$\n\\lambda_{1} = a + b = 2.5, \\quad \\lambda_{2} = a - b = 1.5.\n$$\n因此，\n$$\nU = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad \\Lambda = \\begin{pmatrix} 2.5  0 \\\\ 0  1.5 \\end{pmatrix}.\n$$\n定义 $\\,\\alpha = \\lambda_{1}^{-1/2} = \\frac{1}{\\sqrt{2.5}} = \\frac{\\sqrt{2}}{\\sqrt{5}}\\,$ 和 $\\,\\beta = \\lambda_{2}^{-1/2} = \\frac{1}{\\sqrt{1.5}} = \\frac{\\sqrt{2}}{\\sqrt{3}}\\,$。则\n$$\n\\Lambda^{-1/2} = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\beta \\end{pmatrix}.\n$$\n所以，\n$$\n\\Sigma^{-1/2} = U \\Lambda^{-1/2} U^{\\top} = \\frac{1}{2} \n\\begin{pmatrix}\n\\alpha + \\beta  \\alpha - \\beta \\\\\n\\alpha - \\beta  \\alpha + \\beta\n\\end{pmatrix}\n= \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{5}} + \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{5}} - \\frac{1}{\\sqrt{3}} \\\\\n\\frac{1}{\\sqrt{5}} - \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{5}} + \\frac{1}{\\sqrt{3}}\n\\end{pmatrix}.\n$$\n\n步骤 2：白化模式 $\\,y_{i} = \\Sigma^{-1/2} x_{i}\\,$。记 $\\,a \\equiv \\frac{1}{\\sqrt{5}} + \\frac{1}{\\sqrt{3}}\\,$ 和 $\\,b \\equiv \\frac{1}{\\sqrt{5}} - \\frac{1}{\\sqrt{3}}\\,$，使得\n$$\n\\Sigma^{-1/2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}.\n$$\n计算每个 $\\,y_{i}$：\n$$\ny_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 3a + b \\\\ 3b + a \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{4}{\\sqrt{5}} + \\frac{2}{\\sqrt{3}} \\\\ \\frac{4}{\\sqrt{5}} - \\frac{2}{\\sqrt{3}} \\end{pmatrix},\n$$\n$$\ny_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2(a + b) \\\\ 2(a + b) \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{4}{\\sqrt{5}} \\\\ \\frac{4}{\\sqrt{5}} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{\\sqrt{10}} \\\\ \\frac{4}{\\sqrt{10}} \\end{pmatrix},\n$$\n$$\ny_{3} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -b \\\\ -a \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{1}{\\sqrt{3}} - \\frac{1}{\\sqrt{5}} \\\\ -\\left( \\frac{1}{\\sqrt{5}} + \\frac{1}{\\sqrt{3}} \\right) \\end{pmatrix}.\n$$\n\n步骤 3：计算白化空间中的成对欧几里得距离。$\\,y_{i}\\,$ 和 $\\,y_{j}\\,$ 之间的欧几里得距离为 $\\,d_{ij} = \\|y_{i} - y_{j}\\|_{2}\\,$。\n\n首先，\n$$\ny_{1} - y_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{4}{\\sqrt{5}} + \\frac{2}{\\sqrt{3}} \\\\ \\frac{4}{\\sqrt{5}} - \\frac{2}{\\sqrt{3}} \\end{pmatrix}\n- \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{4}{\\sqrt{5}} \\\\ \\frac{4}{\\sqrt{5}} \\end{pmatrix}\n= \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{2}{\\sqrt{3}} \\\\ -\\frac{2}{\\sqrt{3}} \\end{pmatrix}.\n$$\n因此，\n$$\nd_{12}^{2} = \\left\\| \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{2}{\\sqrt{3}} \\\\ -\\frac{2}{\\sqrt{3}} \\end{pmatrix} \\right\\|_{2}^{2}\n= \\frac{1}{2} \\left( \\frac{4}{3} + \\frac{4}{3} \\right) = \\frac{4}{3}, \\quad d_{12} = \\frac{2}{\\sqrt{3}}.\n$$\n\n接着，\n$$\ny_{1} - y_{3} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\sqrt{5} + \\frac{1}{\\sqrt{3}} \\\\ \\sqrt{5} - \\frac{1}{\\sqrt{3}} \\end{pmatrix},\n$$\n所以\n$$\nd_{13}^{2} = \\frac{1}{2} \\left[ \\left( \\sqrt{5} + \\frac{1}{\\sqrt{3}} \\right)^{2} + \\left( \\sqrt{5} - \\frac{1}{\\sqrt{3}} \\right)^{2} \\right]\n= \\frac{1}{2} \\cdot 2 \\left( 5 + \\frac{1}{3} \\right) = \\frac{16}{3},\n\\quad d_{13} = \\frac{4}{\\sqrt{3}}.\n$$\n\n类似地，\n$$\ny_{2} - y_{3} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\sqrt{5} - \\frac{1}{\\sqrt{3}} \\\\ \\sqrt{5} + \\frac{1}{\\sqrt{3}} \\end{pmatrix},\n$$\n得到\n$$\nd_{23}^{2} = \\frac{1}{2} \\left[ \\left( \\sqrt{5} - \\frac{1}{\\sqrt{3}} \\right)^{2} + \\left( \\sqrt{5} + \\frac{1}{\\sqrt{3}} \\right)^{2} \\right] = \\frac{16}{3},\n\\quad d_{23} = \\frac{4}{\\sqrt{3}}.\n$$\n\n步骤 4：计算三个距离的算术平均值，\n$$\n\\bar{d} = \\frac{d_{12} + d_{13} + d_{23}}{3} = \\frac{ \\frac{2}{\\sqrt{3}} + \\frac{4}{\\sqrt{3}} + \\frac{4}{\\sqrt{3}} }{3} = \\frac{10}{3 \\sqrt{3}}.\n$$\n数值上，$\\,\\sqrt{3} \\approx 1.7320508075688772\\,$，所以\n$$\n\\bar{d} \\approx \\frac{10}{3 \\cdot 1.7320508075688772} \\approx \\frac{10}{5.196152422706632} \\approx 1.924500897 \\ldots\n$$\n四舍五入到四位有效数字，\n$$\n\\bar{d} \\approx 1.925.\n$$\n这个最终的量是无量纲的。",
            "answer": "$$\\boxed{1.925}$$"
        },
        {
            "introduction": "我们已经学会了如何计算表征之间的非相似性，但一个更深层次的问题是：这些距离度量究竟意味着什么？本练习是一个理论推导，旨在建立表征非相似性与信息解码之间的桥梁。你将从第一性原理出发，推导出一个解析表达式，它将马氏距离与最优线性分类器的解码准确率直接联系起来。这个重要的结果揭示了RSA的核心思想：表征空间中的几何距离，直接反映了神经编码所承载的、可被下游读取的信息量。",
            "id": "4190802",
            "problem": "在一个双条件神经影像实验中，假设每个条件在 $p$ 个体素或通道上引起一个多变量响应模式，该模式被建模为具有共享协方差的多元高斯分布。具体来说，设条件 $1$ 产生的响应为 $\\mathbf{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{1}, \\boldsymbol{\\Sigma})$，条件 $2$ 产生的响应为 $\\mathbf{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{2}, \\boldsymbol{\\Sigma})$，两者具有相等的先验概率，且 $\\boldsymbol{\\Sigma}$ 是正定的。考虑在这些假设下的贝叶斯最优线性解码器（等同于线性判别分析 (LDA)），它选择一个线性决策边界以最小化分类误差。设两个条件均值之间的马氏距离的平方定义为 $d^{2} = (\\boldsymbol{\\mu}_{2} - \\boldsymbol{\\mu}_{1})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_{2} - \\boldsymbol{\\mu}_{1})$。仅使用多元高斯分布的核心定义、协方差相等情况下的贝叶斯最优线性决策规则以及 $d^{2}$ 的定义，从第一性原理推导出一个关于最优线性分类器期望解码准确率的闭式解析表达式，该表达式是 $d^{2}$ 的函数。定义您使用的任何特殊函数。最后，解释这种函数依赖关系如何正式地将解码准确率与表征相似性分析 (RSA) 中使用的差异性联系起来，RSA 通常使用条件特异性模式之间的马氏距离平方。提供最终答案，形式为仅包含 $d^{2}$ 的单一闭式解析表达式；无需进行数值四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于标准的统计模式识别理论，是一个具有明确目标的适定问题，并提供了一套完整且一致的前提。\n\n我们首先为推导建立理论框架。给定两个条件，我们将其标记为 $C_1$ 和 $C_2$。这些条件的神经响应模式 $\\mathbf{x} \\in \\mathbb{R}^p$ 通过具有共享协方差矩阵 $\\boldsymbol{\\Sigma}$ 的多元高斯分布进行建模：\n- 条件 $C_1$：$\\mathbf{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{1}, \\boldsymbol{\\Sigma})$\n- 条件 $C_2$：$\\mathbf{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{2}, \\boldsymbol{\\Sigma})$\n\n问题陈述了先验概率相等，即 $P(C_1) = P(C_2) = \\frac{1}{2}$。贝叶斯最优分类器旨在最小化误分类概率。在先验概率相等的情况下，这是通过将给定的观测值 $\\mathbf{x}$ 分配给具有较高后验概率的类别来实现的，这简化为将其分配给具有较高似然的类别。决策规则是：\n如果 $p(\\mathbf{x}|C_1) > p(\\mathbf{x}|C_2)$，则将 $\\mathbf{x}$ 分配给 $C_1$，否则分配给 $C_2$。\n\n为了使比较易于处理，我们使用对数似然比。多元正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$ 的概率密度函数是\n$$p(\\mathbf{x}|\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = \\frac{1}{(2\\pi)^{p/2} |\\boldsymbol{\\Sigma}|^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})\\right)$$\n对数似然是\n$$\\ln p(\\mathbf{x}|\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma}) = -\\frac{p}{2}\\ln(2\\pi) -\\frac{1}{2}\\ln|\\boldsymbol{\\Sigma}| -\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})$$\n决策规则基于对数似然比的符号：\n$$\\ln\\left(\\frac{p(\\mathbf{x}|C_1)}{p(\\mathbf{x}|C_2)}\\right) = \\ln p(\\mathbf{x}|C_1) - \\ln p(\\mathbf{x}|C_2) > 0$$\n代入对数似然的表达式，常数项相互抵消，剩下：\n$$\\frac{1}{2} \\left[ (\\mathbf{x}-\\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}_2) - (\\mathbf{x}-\\boldsymbol{\\mu}_1)^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}_1) \\right] > 0$$\n展开二次型：\n$$(\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} - 2\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_2 + \\boldsymbol{\\mu}_2^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_2) - (\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} - 2\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_1 + \\boldsymbol{\\mu}_1^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_1) > 0$$\n项 $\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x}$ 被抵消，从而产生一个线性决策边界。该不等式简化为：\n$$2\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2) - (\\boldsymbol{\\mu}_1^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_2) > 0$$\n这定义了一个线性判别函数。让我们定义一个投影向量 $\\mathbf{w} = \\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)$。决策规则是：如果 $\\mathbf{w}^{\\top}\\mathbf{x} > b$，则分类为 $C_1$，其中 $b = \\frac{1}{2}(\\boldsymbol{\\mu}_1^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_2) = \\frac{1}{2}(\\boldsymbol{\\mu}_1+\\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1-\\boldsymbol{\\mu}_2) = \\frac{1}{2}(\\boldsymbol{\\mu}_1+\\boldsymbol{\\mu}_2)^{\\top}\\mathbf{w}$。\n\n分析的核心是检验标量投影 $y = \\mathbf{w}^{\\top}\\mathbf{x}$ 的分布。由于 $\\mathbf{x}$ 是一个高斯随机向量，而 $y$ 是 $\\mathbf{x}$ 的线性变换，因此 $y$ 是一个标量高斯随机变量。我们需要求出它在每个条件下的均值和方差。\n\n如果 $\\mathbf{x} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_k, \\boldsymbol{\\Sigma})$，那么 $y \\sim \\mathcal{N}(E[y|C_k], Var(y|C_k))$。\n条件均值为：\n$$E[y|C_1] = m_1 = \\mathbf{w}^{\\top}\\boldsymbol{\\mu}_1 = (\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_1$$\n$$E[y|C_2] = m_2 = \\mathbf{w}^{\\top}\\boldsymbol{\\mu}_2 = (\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_2$$\n由于协方差 $\\boldsymbol{\\Sigma}$ 是共享的，所以两个类别的条件方差相同：\n$$Var(y) = \\mathbf{w}^{\\top}\\boldsymbol{\\Sigma}\\mathbf{w} = ((\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1})\\boldsymbol{\\Sigma}(\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2))$$\n由于 $\\boldsymbol{\\Sigma}$ 是对称的，$\\boldsymbol{\\Sigma}^{-1}$ 也是对称的，因此 $(\\boldsymbol{\\Sigma}^{-1})^{\\top} = \\boldsymbol{\\Sigma}^{-1}$。\n$$Var(y) = (\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\Sigma}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2) = (\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)$$\n这个量恰好是均值之间的马氏距离的平方 $d^2$，注意到 $(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top} = -(\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)^{\\top}$，且整个表达式是一个二次型，给出 $(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\mathbf{A}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2) = (\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)^{\\top}\\mathbf{A}(\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)$。\n所以，$Var(y) = d^2$，其中 $d^2 = (\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_2 - \\boldsymbol{\\mu}_1)$。$y$ 的标准差是 $\\sqrt{d^2}$。\n\n投影数据的条件均值之差为：\n$$m_1 - m_2 = \\mathbf{w}^{\\top}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2) = (\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2)^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\boldsymbol{\\mu}_1 - \\boldsymbol{\\mu}_2) = d^2$$\n$y$ 的决策阈值在 $b = \\frac{1}{2}(\\mathbf{w}^{\\top}\\boldsymbol{\\mu}_1 + \\mathbf{w}^{\\top}\\boldsymbol{\\mu}_2) = \\frac{1}{2}(m_1 + m_2)$。这是两个投影均值之间的中点，正如对于具有相等先验概率的最优分类器所预期的那样。\n\n期望解码准确率是每个类别正确分类概率的平均值，按其先验概率加权：\n$$Accuracy = P(\\text{correct}) = P(C_1)P(\\text{correct}|C_1) + P(C_2)P(\\text{correct}|C_2)$$\n$$Accuracy = \\frac{1}{2} P(y > b | C_1) + \\frac{1}{2} P(y \\le b | C_2)$$\n我们对变量进行标准化以计算这些概率。设 $Z \\sim \\mathcal{N}(0, 1)$ 为一个标准正态随机变量。\n对于条件 $C_1$，我们有 $y \\sim \\mathcal{N}(m_1, d^2)$。正确分类的概率是：\n$$P(y > b | C_1) = P\\left(\\frac{y-m_1}{\\sqrt{d^2}} > \\frac{b-m_1}{\\sqrt{d^2}}\\right) = P\\left(Z > \\frac{\\frac{1}{2}(m_1+m_2) - m_1}{\\sqrt{d^2}}\\right)$$\n$$= P\\left(Z > \\frac{\\frac{1}{2}(m_2-m_1)}{\\sqrt{d^2}}\\right) = P\\left(Z > \\frac{-\\frac{1}{2}d^2}{\\sqrt{d^2}}\\right) = P\\left(Z > -\\frac{\\sqrt{d^2}}{2}\\right)$$\n根据标准正态分布的对称性，$P(Z > -a) = P(Z  a)$，这由标准正态分布的累积分布函数 (CDF) $\\Phi(a)$ 给出。\n因此，$P(\\text{correct}|C_1) = \\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right)$。\n\n对于条件 $C_2$，我们有 $y \\sim \\mathcal{N}(m_2, d^2)$。正确分类的概率是：\n$$P(y \\le b | C_2) = P\\left(\\frac{y-m_2}{\\sqrt{d^2}} \\le \\frac{b-m_2}{\\sqrt{d^2}}\\right) = P\\left(Z \\le \\frac{\\frac{1}{2}(m_1+m_2) - m_2}{\\sqrt{d^2}}\\right)$$\n$$= P\\left(Z \\le \\frac{\\frac{1}{2}(m_1-m_2)}{\\sqrt{d^2}}\\right) = P\\left(Z \\le \\frac{\\frac{1}{2}d^2}{\\sqrt{d^2}}\\right) = P\\left(Z \\le \\frac{\\sqrt{d^2}}{2}\\right) = \\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right)$$\n使用的特殊函数是 $\\Phi(z)$，即标准正态分布的累积分布函数，定义为：\n$$\\Phi(z) = \\int_{-\\infty}^{z} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{t^2}{2}\\right) dt$$\n总期望准确率为：\n$$Accuracy = \\frac{1}{2} \\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right) + \\frac{1}{2} \\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right) = \\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right)$$\n此表达式给出了贝叶斯最优线性分类器的期望解码准确率，它仅仅是马氏距离平方 $d^2$ 的函数。\n\n与表征相似性分析 (RSA) 的正式联系现在变得很明显。在 RSA 中，一个核心对象是表征差异矩阵 (RDM)，它量化了由不同实验条件引起的神经模式之间的差异性。马氏距离的平方 $d^2$ 是构建 RDM 的一种有原则且广泛使用的差异性度量，特别是因为它对多变量信息敏感，并且对响应空间的仿射变换不变（当协方差被估计并进行适当变换时）。\n\n我们的推导在这个差异性度量和一个关键的信息论量——神经表征的可辨别性之间，建立了一个直接的、定量的关系。得出的方程，准确率 $= \\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right)$，表明解码准确率是 $\\sqrt{d^2}$（因此也是 $d^2$）的单调递增函数。这意味着，由 $d^2$ 衡量的两个条件神经模式之间更大的差异性，直接意味着它们在神经状态空间中更可分，并且可以被最优线性解码器以更高的准确率区分。因此，RSA 中的马氏距离不仅仅是一个几何描述符；它在功能上与神经编码的信息内容相耦合，特别是与支持线性解码的信息相耦合。",
            "answer": "$$\\boxed{\\Phi\\left(\\frac{\\sqrt{d^2}}{2}\\right)}$$"
        }
    ]
}