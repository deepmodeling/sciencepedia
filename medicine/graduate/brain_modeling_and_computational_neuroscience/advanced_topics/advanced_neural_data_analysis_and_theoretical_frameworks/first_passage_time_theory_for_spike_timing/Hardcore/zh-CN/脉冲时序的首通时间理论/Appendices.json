{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践是一项基石练习。我们将从最简单且非平凡的神经元模型——理想积分发放（perfect integrate-and-fire）模型入手，并利用首渡时间理论推导出其基本的发放统计量：发放率 $r$ 和变异系数 $\\mathrm{CV}$。这项练习将随机过程的抽象数学与可观测且有意义的神经生理学量直接联系起来 。",
            "id": "3980734",
            "problem": "考虑一个由恒定输入和加性高斯噪声驱动的完美整合发放神经元模型。膜电位 $V_t$ 根据随机微分方程 (SDE) 演化\n$$\ndV_t \\;=\\; \\mu\\, dt \\;+\\; \\sigma\\, dW_t,\n$$\n其中 $W_t$ 是标准维纳过程，$\\mu$ 是以 $\\mathrm{mV}/\\mathrm{ms}$ 为单位的恒定漂移，$\\sigma$ 是以 $\\mathrm{mV}/\\sqrt{\\mathrm{ms}}$ 为单位的噪声幅度。神经元从重置电位 $V_0 = V_{\\mathrm{r}}$ 开始，当其首次达到阈值 $V_{\\mathrm{th}}  V_{\\mathrm{r}}$ 时发放一个峰。定义首达时间\n$$\nT \\;=\\; \\inf\\{t \\ge 0 : V_t \\ge V_{\\mathrm{th}}\\}.\n$$\n假设每个峰的峰间期是 $T$ 的一次独立实现，并定义发放频率 $r = 1/\\mathbb{E}[T]$ 和变异系数 $\\mathrm{CV} = \\sqrt{\\mathrm{Var}(T)}/\\mathbb{E}[T]$。使用适用于首达时间理论的第一性原理，从控制 SDE 和边界条件推导 $\\mathbb{E}[T]$ 和 $\\mathrm{Var}(T)$ 的表达式，并据此计算在以下参数值下的 $r$ 和 $\\mathrm{CV}$\n$$\nV_{\\mathrm{th}} - V_{\\mathrm{r}} \\;=\\; 20 \\;\\mathrm{mV}, \\quad \\mu \\;=\\; 5 \\;\\mathrm{mV}/\\mathrm{ms}, \\quad \\sigma \\;=\\; 2 \\;\\mathrm{mV}/\\sqrt{\\mathrm{ms}}.\n$$\n最后，解释在 $V_{\\mathrm{th}} - V_{\\mathrm{r}}$ 和 $\\mu$ 保持不变的情况下，增加 $\\sigma$ 会如何改变发放频率和峰发放时间的规律性。\n\n将发放频率 $r$ 以 $\\mathrm{Hz}$ 表示，变异系数表示为无量纲量。$r$ 和 $\\mathrm{CV}$ 均四舍五入至四位有效数字。你的最终答案必须是包含这两个值的单个复合对象。",
            "solution": "首先对问题陈述进行严格的验证程序。\n\n### 步骤 1：提取已知条件\n-   **控制方程：** 膜电位 $V_t$ 根据随机微分方程 (SDE) $dV_t = \\mu\\, dt + \\sigma\\, dW_t$ 演化。\n-   **参数：** $W_t$ 是标准维纳过程，$\\mu$ 是恒定漂移，$\\sigma$ 是噪声幅度。\n-   **初始条件：** $V_0 = V_{\\mathrm{r}}$。\n-   **边界条件：** 神经元在首次达到阈值 $V_{\\mathrm{th}}$ 时发放一个峰，其中 $V_{\\mathrm{th}}  V_{\\mathrm{r}}$。\n-   **首达时间 (FPT)：** $T = \\inf\\{t \\ge 0 : V_t \\ge V_{\\mathrm{th}}\\}$。\n-   **定义：** 发放频率 $r = 1/\\mathbb{E}[T]$，变异系数 $\\mathrm{CV} = \\sqrt{\\mathrm{Var}(T)}/\\mathbb{E}[T]$。\n-   **数值：** $V_{\\mathrm{th}} - V_{\\mathrm{r}} = 20 \\;\\mathrm{mV}$，$\\mu = 5 \\;\\mathrm{mV}/\\mathrm{ms}$，$\\sigma = 2 \\;\\mathrm{mV}/\\sqrt{\\mathrm{ms}}$。\n-   **要求任务：**\n    1.  从第一性原理推导 $\\mathbb{E}[T]$ 和 $\\mathrm{Var}(T)$ 的表达式。\n    2.  计算 $r$ 和 $\\mathrm{CV}$ 的数值。\n    3.  解释增加 $\\sigma$ 对 $r$ 和峰发放时间规律性的影响。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题描述了一个完美的整合发放神经元，这是计算神经科学中的一个经典基础模型。该 SDE 代表一个带漂移的维纳过程，是随机微积分的基石。该问题牢固地建立在成熟的数理物理和神经科学理论之上。\n-   **良定性：** 该问题要求解带漂移的维纳过程到达恒定吸收边界的首达时间的矩。这是一个经典的、良定的问题，具有唯一且稳定的解，因为漂移 $\\mu  0$ 确保了以概率 1 到达边界。\n-   **客观性：** 该问题使用精确、无歧义的数学和技术语言陈述。它不含主观或基于意见的内容。\n-   **完整性和一致性：** 所有必要的参数（$\\mu$、$\\sigma$ 和电位差 $V_{\\mathrm{th}} - V_{\\mathrm{r}}$）都已提供。单位是一致的。没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、良定的和完整的。这是一个有效的问题，可以使用随机过程理论中的标准方法解决。我们继续进行求解。\n\n### 首达时间矩的推导\n为简化分析，我们平移坐标系。令 $x_t = V_t - V_{\\mathrm{r}}$ 表示相对于重置值的膜电位。该过程从 $x_0 = x(0) = V_0 - V_{\\mathrm{r}} = 0$ 开始。当 $x_t$ 首次达到阈值 $H = V_{\\mathrm{th}} - V_{\\mathrm{r}}$ 时，神经元发放一个峰。$x_t$ 的 SDE 保持不变，因为 $V_{\\mathrm{r}}$ 是一个常数：\n$$\ndx_t = \\mu\\, dt + \\sigma\\, dW_t\n$$\n问题在于求从 $x_0 = 0$ 开始的首达时间 $T = \\inf\\{t \\ge 0 : x_t \\ge H\\}$ 的矩。我们可以通过求解后向科尔莫戈洛夫方程来推导这些矩。令 $M_n(x) = \\mathbb{E}[T^n | x_0=x]$ 为从 $x  H$ 开始，到达 $H$ 的首达时间的 $n$ 阶矩。这些矩满足常微分方程的递归系统：\n$$\n\\mathcal{L} M_n(x) = -n M_{n-1}(x), \\quad n \\ge 1\n$$\n其中 $M_0(x) = 1$，且 $\\mathcal{L}$ 是扩散过程的生成元：\n$$\n\\mathcal{L} = \\mu \\frac{d}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2}{dx^2}\n$$\n边界条件由问题的性质决定。在阈值 $x=H$ 处，粒子被吸收，因此到达该点的时间为 $0$。因此，对于所有 $n \\ge 1$，$M_n(H) = 0$。该问题没有在 $x  0$ 处指定边界。这意味着定义域是 $(-\\infty, H]$。为了得到一个矩为有限的、具有物理意义的解，我们必须在 $x \\to -\\infty$ 时施加一个正则性条件。由于漂移 $\\mu  0$，该过程保证最终会到达 $H$。\n\n**平均首达时间 $\\mathbb{E}[T]$ 的推导**\n对于 $n=1$，我们求解 $M_1(x) = \\mathbb{E}[T | x_0=x]$。控制方程为：\n$$\n\\mu \\frac{dM_1}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2M_1}{dx^2} = -1\n$$\n令 $u(x) = dM_1/dx$，我们得到一个一阶线性常微分方程：$\\frac{\\sigma^2}{2} u' + \\mu u = -1$。其通解为 $u(x) = C_1 \\exp(-\\frac{2\\mu}{\\sigma^2}x) - \\frac{1}{\\mu}$。对 $u(x)$ 积分得到：\n$$\nM_1(x) = -\\frac{C_1\\sigma^2}{2\\mu} \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) - \\frac{x}{\\mu} + C_2\n$$\n当 $x \\to -\\infty$ 时，由于 $\\mu  0$，项 $\\exp(-\\frac{2\\mu}{\\sigma^2}x)$ 发散。为了使 $M_1(x)$ 保持物理上的合理性（即不指数发散），我们必须将此项的系数设为零，即 $C_1 = 0$。\n这将解简化为 $M_1(x) = -x/\\mu + C_2$。应用吸收边界条件 $M_1(H) = 0$：\n$0 = -H/\\mu + C_2 \\implies C_2 = H/\\mu$。\n因此，从任意起始位置 $x$ 开始的平均首达时间是 $M_1(x) = (H-x)/\\mu$。对于我们的问题，神经元从 $x=0$ 开始，所以：\n$$\n\\mathbb{E}[T] = M_1(0) = \\frac{H}{\\mu}\n$$\n\n**方差 $\\mathrm{Var}(T)$ 的推导**\n为了求方差 $\\mathrm{Var}(T) = \\mathbb{E}[T^2] - (\\mathbb{E}[T])^2$，我们必须先求二阶矩 $\\mathbb{E}[T^2] = M_2(0)$。对于 $n=2$，方程为：\n$$\n\\mu \\frac{dM_2}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2M_2}{dx^2} = -2 M_1(x) = -2\\frac{H-x}{\\mu}\n$$\n令 $v(x) = dM_2/dx$，我们有 $\\frac{\\sigma^2}{2} v' + \\mu v = \\frac{2x}{\\mu} - \\frac{2H}{\\mu}$。通解为 $v(x) = v_h(x) + v_p(x)$，其中齐次部分为 $v_h(x) = A \\exp(-\\frac{2\\mu}{\\sigma^2}x)$。形式为 $v_p(x) = ax+b$ 的一个特解得到 $a=2/\\mu^2$ 和 $b = -2H/\\mu^2 - \\sigma^2/\\mu^3$。\n$$\nv(x) = A \\exp\\left(-\\frac{2\\mu}{\\sigma^2}x\\right) + \\frac{2(x-H)}{\\mu^2} - \\frac{\\sigma^2}{\\mu^3}\n$$\n对 $v(x)$ 积分得到 $M_2(x)$。同样，为防止在 $x \\to -\\infty$ 时指数发散，我们必须设 $A=0$。\n$$\nM_2(x) = \\int \\left( \\frac{2(x-H)}{\\mu^2} - \\frac{\\sigma^2}{\\mu^3} \\right) dx = \\frac{(x-H)^2}{\\mu^2} - \\frac{\\sigma^2 x}{\\mu^3} + B\n$$\n应用边界条件 $M_2(H) = 0$：\n$0 = \\frac{(H-H)^2}{\\mu^2} - \\frac{\\sigma^2 H}{\\mu^3} + B \\implies B = \\frac{\\sigma^2 H}{\\mu^3}$。\n二阶矩的完整解是 $M_2(x) = \\frac{(x-H)^2}{\\mu^2} + \\frac{\\sigma^2(H-x)}{\\mu^3}$。\n在起始位置 $x=0$ 处求值：\n$$\n\\mathbb{E}[T^2] = M_2(0) = \\frac{H^2}{\\mu^2} + \\frac{H\\sigma^2}{\\mu^3}\n$$\n那么方差为：\n$$\n\\mathrm{Var}(T) = \\mathbb{E}[T^2] - (\\mathbb{E}[T])^2 = \\left(\\frac{H^2}{\\mu^2} + \\frac{H\\sigma^2}{\\mu^3}\\right) - \\left(\\frac{H}{\\mu}\\right)^2 = \\frac{H\\sigma^2}{\\mu^3}\n$$\n\n### 数值计算\n给定的参数是 $H = V_{\\mathrm{th}} - V_{\\mathrm{r}} = 20 \\;\\mathrm{mV}$，$\\mu = 5 \\;\\mathrm{mV}/\\mathrm{ms}$，以及 $\\sigma = 2 \\;\\mathrm{mV}/\\sqrt{\\mathrm{ms}}$。\n\n**发放频率 $r$**\n平均峰间期为：\n$$\n\\mathbb{E}[T] = \\frac{H}{\\mu} = \\frac{20 \\;\\mathrm{mV}}{5 \\;\\mathrm{mV}/\\mathrm{ms}} = 4 \\;\\mathrm{ms} = 4 \\times 10^{-3} \\;\\mathrm{s}\n$$\n发放频率是平均 ISI 的倒数：\n$$\nr = \\frac{1}{\\mathbb{E}[T]} = \\frac{1}{4 \\times 10^{-3} \\;\\mathrm{s}} = 250 \\;\\mathrm{s}^{-1} = 250 \\;\\mathrm{Hz}\n$$\n四舍五入至四位有效数字，$r = 250.0 \\;\\mathrm{Hz}$。\n\n**变异系数 $\\mathrm{CV}$**\n峰间期的方差为：\n$$\n\\mathrm{Var}(T) = \\frac{H\\sigma^2}{\\mu^3} = \\frac{(20 \\;\\mathrm{mV})(2 \\;\\mathrm{mV}/\\sqrt{\\mathrm{ms}})^2}{(5 \\;\\mathrm{mV}/\\mathrm{ms})^3} = \\frac{20 \\times 4}{125} \\;\\mathrm{ms}^2 = 0.64 \\;\\mathrm{ms}^2\n$$\n变异系数为：\n$$\n\\mathrm{CV} = \\frac{\\sqrt{\\mathrm{Var}(T)}}{\\mathbb{E}[T]} = \\frac{\\sqrt{0.64 \\;\\mathrm{ms}^2}}{4 \\;\\mathrm{ms}} = \\frac{0.8 \\;\\mathrm{ms}}{4 \\;\\mathrm{ms}} = 0.2\n$$\n作为一个无量纲量，四舍五入至四位有效数字，$\\mathrm{CV} = 0.2000$。\n\n### 噪声作用的解释\n推导出的发放频率和变异系数的表达式，可以清晰地解释噪声幅度 $\\sigma$ 的影响。\n\n**对发放频率 ($r$) 的影响**\n发放频率为 $r = 1/\\mathbb{E}[T] = \\mu/H$。这个表达式与噪声幅度 $\\sigma$ 无关。因此，对于这个特定模型，在保持 $\\mu$ 和 $H$ 不变的情况下增加 $\\sigma$ 不会改变平均发放频率。噪声引入了变异性，导致一些峰间期比确定性时间 $H/\\mu$ 短，而另一些则更长，但这些波动完美地相互抵消，使得平均值保持不变。这是完美积分器模型在没有泄漏或其他非线性情况下的一个特有属性。\n\n**对峰发放时间规律性 (CV) 的影响**\n变异系数为 $\\mathrm{CV} = \\sqrt{\\mathrm{Var}(T)}/\\mathbb{E}[T]$。使用我们推导的表达式：\n$$\n\\mathrm{CV} = \\frac{\\sqrt{H\\sigma^2/\\mu^3}}{H/\\mu} = \\frac{\\sigma\\sqrt{H}/\\mu^{3/2}}{H/\\mu} = \\frac{\\sigma}{\\sqrt{H\\mu}}\n$$\n该表达式表明 $\\mathrm{CV}$ 与 $\\sigma$ 成正比。由于 $\\mathrm{CV}$ 衡量的是峰间期的归一化变异性，较大的 $\\mathrm{CV}$ 意味着发放的规律性较差。因此，增加噪声幅度 $\\sigma$ 会增加峰发放时间的变异性，使神经元的发放模式更加不规则。在极限情况 $\\sigma \\to 0$ 时，$\\mathrm{CV} \\to 0$，对应于间隔为 $H/\\mu$ 的完全周期性发放。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 250.0  0.2000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的神经元具有漏电的细胞膜，这一特性可以通过 Ornstein-Uhlenbeck (OU) 过程来描述。本实践将演示一种强大的数学技巧——变量代换——来简化对 OU 过程的分析 。通过对过程进行重新中心化，我们可以将问题转化为标准形式，并推导出平均首渡时间的控制方程，从而加深您对后向 Kolmogorov 方程的理解。",
            "id": "3980743",
            "problem": "一个神经元在平稳噪声驱动下的膜电位被建模为奥恩斯坦-乌伦贝克（OU）过程。具体来说，令 $V(t)$ 满足伊藤随机微分方程（SDE）\n$$\n\\mathrm{d}V(t) \\;=\\; -\\frac{1}{\\tau}\\big(V(t)-\\mu\\big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}W_t,\n$$\n其中 $W_t$ 是标准布朗运动，$\\tau0$ 是膜时间常数，$\\mu\\in\\mathbb{R}$ 是恒定的平均驱动，$\\sigma0$ 是噪声幅度。尖峰阈值是一个固定水平 $\\theta\\in\\mathbb{R}$，初始条件为 $V(0)=v_0$，其中 $v_0  \\theta$。定义首次穿越时间 $T=\\inf\\{t\\ge 0:V(t)\\ge\\theta\\}$。\n\n考虑变换 $X(t)=V(t)-\\mu$，该变换将OU过程中心移至 $0$。令 $b=\\theta-\\mu$ 和 $x_0=v_0-\\mu$。令 $u(x)$ 表示从初始条件 $X(0)=x$ 到吸收边界 $b$ 的平均首次穿越时间 $\\mathbb{E}[T\\,|\\,X(0)=x]$。\n\n从OU过程的伊藤定义和首次穿越时间的定义出发，并使用时间齐次扩散的生成元，确定以下哪个选项正确地描述了中心化后的变换动力学和 $u(x)$ 必须满足的边值问题。\n\nA. 中心化后的过程服从 $\\mathrm{d}X(t)= -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，其中 $X(0)=x_0$，并且 $u(x)$ 求解\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) \\;=\\; -1, \\quad \\text{对于 } x  b,\n$$\n且边界条件为 $u(b)=0$ 和 $\\lim_{x\\to -\\infty} u(x)$ 有界。\n\nB. 中心化后的过程服从 $\\mathrm{d}X(t)= -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t - \\mu\\,\\mathrm{d}t$，其中 $X(0)=x_0$，并且 $u(x)$ 求解\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) - \\left(\\frac{x}{\\tau}+\\mu\\right)\\,u'(x) \\;=\\; -1, \\quad \\text{对于 } x  b,\n$$\n且边界条件为 $u(b)=0$。\n\nC. 中心化后的过程服从 $\\mathrm{d}X(t)= -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，其中 $X(0)=x_0$，并且 $u(x)$ 求解\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) \\;=\\; 0, \\quad \\text{对于 } x  b,\n$$\n且边界条件为 $u(b)=0$。\n\nD. 中心化后的过程服从 $\\mathrm{d}X(t)= -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，其中 $X(0)=x_0$，并且 $u(x)$ 求解\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) \\;=\\; -1, \\quad \\text{对于 } x  b,\n$$\n且边界条件为 $u(b)=1$。",
            "solution": "用户希望我验证问题陈述，如果有效，则为奥恩斯坦-乌伦贝克（OU）过程的平均首次穿越时间（MFPT）推导出正确的边值问题。\n\n### 步骤1：提取已知条件\n- 膜电位 $V(t)$ 的动力学由伊藤随机微分方程（SDE）给出：\n$$\n\\mathrm{d}V(t) = -\\frac{1}{\\tau}\\big(V(t)-\\mu\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n- $W_t$ 是标准布朗运动。\n- $\\tau  0$ 是膜时间常数。\n- $\\mu \\in \\mathbb{R}$ 是恒定的平均驱动。\n- $\\sigma  0$ 是噪声幅度。\n- 尖峰阈值是一个固定水平 $\\theta \\in \\mathbb{R}$。\n- 初始条件是 $V(0) = v_0$，其中 $v_0  \\theta$。\n- 首次穿越时间是 $T = \\inf\\{t \\ge 0 : V(t) \\ge \\theta\\}$。\n- 中心化过程的变换是 $X(t) = V(t) - \\mu$。\n- 变换后的阈值是 $b = \\theta - \\mu$。\n- 变换后的初始条件是 $x_0 = v_0 - \\mu$。\n- 待描述的量是平均首次穿越时间 $u(x) = \\mathbb{E}[T \\,|\\, X(0)=x]$。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述在科学上和数学上都是合理的。\n- **科学依据**：奥恩斯坦-乌伦贝克过程是用于具有线性松弛行为的随机驱动系统的典型模型，在计算神经科学中常用于模拟神经元的阈下膜电位。首次穿越到阈值的概念是神经功能中基于速率编码和时间编码理论的基础。这个问题在该领域内是公认的。\n- **适定性**：对于时间齐次扩散过程，寻找到达边界的平均首次穿越时间是随机过程理论中的一个经典、适定问题。控制方程和边界条件可以从第一性原理推导出来。\n- **客观性和清晰度**：该问题使用精确的数学语言（SDEs，变量和参数的定义）进行陈述。所有术语都是标准的、无歧义的。设置是自洽的，并提供了推导所需边值问题的所有必要信息。\n- **结论**：该问题不违反任何无效标准。它是一个有效、适定的科学问题。\n\n### 步骤3：推导与选项分析\n\n我们继续进行推导。任务分为两部分：确定中心化过程 $X(t)$ 的动力学，并为其平均首次穿越时间 $u(x)$ 推导边值问题。\n\n**第一部分：中心化过程 $X(t)$ 的动力学**\n\n变换由 $X(t) = V(t) - \\mu$ 给出。为了找到 $X(t)$ 的SDE，我们可以对该表达式求微分。由于 $\\mu$ 是一个常数，其微分为零，即 $\\mathrm{d}\\mu = 0$。\n$$\n\\mathrm{d}X(t) = \\mathrm{d}(V(t) - \\mu) = \\mathrm{d}V(t) - \\mathrm{d}\\mu = \\mathrm{d}V(t)\n$$\n现在，我们代入给定的 $V(t)$ 的SDE：\n$$\n\\mathrm{d}X(t) = -\\frac{1}{\\tau}\\big(V(t)-\\mu\\big)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n根据变换的定义，我们有 $X(t) = V(t) - \\mu$。将其代入漂移项，得到 $X(t)$ 的SDE：\n$$\n\\mathrm{d}X(t) = -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t\n$$\n$X(t)$ 的初始条件是 $X(0) = V(0) - \\mu = v_0 - \\mu = x_0$。这是一个中心在 $0$ 的标准奥恩斯坦-乌伦贝克过程。\n\n**第二部分：平均首次穿越时间 $u(x)$ 的边值问题**\n\n对于一维的时间齐次伊藤扩散，\n$$\n\\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + b(X_t)\\,\\mathrm{d}W_t,\n$$\n到达一个边界（在此情况下是位于 $b$ 的上边界）的平均首次穿越时间 $u(x) = \\mathbb{E}[T \\,|\\, X(0)=x]$ 满足以下常微分方程（ODE），这是Dynkin公式的直接推论，也可以使用后向Kolmogorov方程框架推导出来：\n$$\n\\mathcal{L}u(x) = -1\n$$\n其中 $\\mathcal{L}$ 是扩散过程的无穷小生成元，定义为：\n$$\n\\mathcal{L} = a(x)\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{1}{2}b(x)^2\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}\n$$\n对于我们的中心化过程 $X(t)$，我们从其SDE中确定漂移系数和扩散系数：\n- 漂移系数：$a(x) = -\\frac{x}{\\tau}$\n- 扩散系数：$b(x) = \\sigma$\n\n将这些代入生成元 $\\mathcal{L}$ 的表达式中，我们得到：\n$$\n\\mathcal{L} = -\\frac{x}{\\tau}\\frac{\\mathrm{d}}{\\mathrm{d}x} + \\frac{\\sigma^2}{2}\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2}\n$$\n将此生成元应用于 $u(x)$ 并将结果设为 $-1$，得到MFPT的控制ODE：\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) = -1\n$$\n这个方程对所有尚未到达边界的起始位置 $x$ 都有效，即对于 $x  b$。\n\n**第三部分：边界条件**\n\n我们需要两个边界条件来唯一地求解这个二阶ODE。\n1.  **$b$ 处的吸收边界：** 停止时间 $T$ 定义为过程首次达到或超过阈值的时间。如果过程恰好从阈值 $X(0)=b$ 开始，所用时间为 $T=0$。因此，平均时间也为零。这给出了边界条件：\n    $$\n    u(b) = 0\n    $$\n2.  **$x \\to -\\infty$ 处的边界：** 漂移项 $-x/\\tau$ 是恢复性的；对于 $x0$，漂移为正，将过程推向 $0$。这意味着过程无法逃逸到 $-\\infty$。一个从负无穷远处开始的粒子将首先漂移到 $0$ 附近，然后波动直到最终到达 $b$。预期所需的时间会很大但有限。因此，我们要求当起始点趋于负无穷时，平均首次穿越时间不发散。适当的边界条件是：\n    $$\n    \\lim_{x\\to -\\infty} u(x) \\text{ 是有限的。}\n    $$\n\n**正确描述的总结**\n- 中心化过程是 $\\mathrm{d}X(t) = -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$。\n- MFPT $u(x)$ 求解边值问题：\n$$\n\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) = -1, \\quad \\text{对于 } x  b,\n$$\n边界条件为 $u(b)=0$ 和 $\\lim_{x\\to -\\infty} u(x)$ 是有限的。\n\n### 选项评估\n\n**A. 中心化后的过程服从 $\\mathrm{d}X(t)= -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$，其中 $X(0)=x_0$，并且 $u(x)$ 求解 $\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) = -1, \\quad \\text{对于 } x  b$, 且边界条件为 $u(b)=0$ 和 $\\lim_{x\\to -\\infty} u(x)$ 有界。** - 该选项与我们的推导完全一致。\n\n**B. 中心化后的过程服从 $\\mathrm{d}X(t)= -\\frac{X(t)}{\\tau}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t - \\mu\\,\\mathrm{d}t$ ...** - 动力学不正确。由于 $\\mu$ 是常数，$\\mathrm{d}X(t) = \\mathrm{d}V(t)$，变换中不应出现额外的 $\\mu\\,\\mathrm{d}t$ 项。\n\n**C. ... 并且 $u(x)$ 求解 $\\frac{\\sigma^2}{2}\\,u''(x) - \\frac{x}{\\tau}\\,u'(x) = 0$ ...** - 控制方程不正确。右侧应该是 $-1$ 来表示时间流逝。右侧为 $0$ 的方程对应于首次穿越的概率，而不是平均时间。\n\n**D. ... 且边界条件为 $u(b)=1$。** - 吸收边界条件不正确。在阈值处开始，首次穿越时间为 $0$，因此平均时间也必须为 $0$。\n\n结论：选项 A 是唯一正确的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然解析解对于获得深刻见解至关重要，但许多现实的神经元模型过于复杂，无法手动求解。最后的这项实践将引导您实现一种数值方法——有限元法（Finite Element Method, FEM）——来求解平均首渡时间（MFPT）的后向方程，从而弥合理论与应用之间的差距 。您不仅将计算出一个数值解，还将根据已知的解析案例来验证您的代码，这是计算研究中的一项关键技能。",
            "id": "3980694",
            "problem": "考虑一个一维随机整合发放模型，用于描述膜电位 $v(t)$。其阈下动力学由一个在定义域 $v \\in [0,1]$ 上的漂移扩散过程近似，该过程具有恒定的漂移 $b \\in \\mathbb{R}$ 和恒定的扩散系数 $D \\gt 0$。尖峰发放阈值位于 $v = 1$，重置边界位于 $v = 0$，且为反射边界。令 $u(v)$ 表示从电位 $v$ 开始到达阈值的平均首达时间 (MFPT)。根据标准的首达时间理论，$u(v)$ 满足后向 Kolmogorov 方程\n$$\nD\\,u''(v) + b\\,u'(v) = -1 \\quad \\text{for } v \\in (0,1),\n$$\n以及混合边界条件\n$$\nu'(0) = 0 \\quad \\text{(反射)}, \\qquad u(1) = 0 \\quad \\text{(吸收)}.\n$$\n您的任务是，在 $[0,1]$ 的均匀网格上，使用分段线性基函数实现一个连续伽辽金有限元方法，以计算 $u(v)$ 的一个数值近似解 $u_h(v)$，并根据已知的常数 $b$ 和 $D$ 下的解析解，验证 $L^2$-误差 $\\|u - u_h\\|_{L^2(0,1)}$ 的收敛率。\n\n要求：\n- 从漂移扩散的后向算子、平均首达时间以及边值问题弱形式的基本定义出发。在设计您的方法时，不要假定超出这些定义之外的任何预先推导出的公式。\n- 使用一个包含 $N$ 个单元的均匀网格，以及标准的分段线性基函数。在弱形式中，将 $v = 0$ 处的反射边界条件视为自然 (Neumann) 边界条件，并将 $v = 1$ 处的吸收边界条件作为 Dirichlet 条件强制施加。\n- 对于下述每个测试用例，计算网格单元数为 $N \\in \\{\\,20, 40, 80, 160\\,\\}$ 时的数值解，通过数值求积估计 $L^2$-误差，并通过对 $\\log(\\|u - u_h\\|_{L^2})$ 与 $\\log(h)$（其中 $h = 1/N$）进行线性最小二乘拟合，得到观测到的收敛率 $r$。\n\n测试套件：\n- 用例 1：$b = 0.3$, $D = 0.05$。\n- 用例 2：$b = 0.0$, $D = 0.1$。\n- 用例 3：$b = -0.2$, $D = 0.05$。\n\n实现和输出规范：\n- 您的程序必须实现双线性形式和载荷项的有限元组装，求解每个网格尺寸下得到的线性系统，通过高斯求积计算 $L^2$-误差，并通过对每个用例的对数-对数数据进行线性回归来估计收敛率 $r$。\n- 为了与真实解进行比较，请推导并使用与上述混合边界条件下常数 $b$ 和 $D$ 对应的 $u(v)$ 的解析表达式。您必须计算并与精确的 $u(v)$ 进行比较；不要使用代理或数值参考解。\n- 最终输出必须是单行文本，包含三个用例的估计收敛率，四舍五入到三位小数，以逗号分隔的列表形式并用方括号括起来，例如：`[2.000,1.998,2.001]`。",
            "solution": "用户提供了一个问题陈述，在尝试任何解决方案之前需要对其进行严格验证。\n\n### 步骤 1：提取已知条件\n- **模型**：用于膜电位 $v(t)$ 的一维随机整合发放模型。\n- **过程**：阈下动力学由一个漂移扩散过程近似。\n- **定义域**：$v \\in [0,1]$。\n- **参数**：恒定漂移 $b \\in \\mathbb{R}$，恒定扩散系数 $D  0$。\n- **边界**：尖峰阈值位于 $v=1$ (吸收)，重置边界位于 $v=0$ (反射)。\n- **控制方程**：平均首达时间 (MFPT) $u(v)$ 满足后向 Kolmogorov 方程：\n$$ D\\,u''(v) + b\\,u'(v) = -1 \\quad \\text{for } v \\in (0,1) $$\n- **边界条件**：\n$$ u'(0) = 0 \\quad \\text{(反射)} $$\n$$ u(1) = 0 \\quad \\text{(吸收)} $$\n- **数值方法**：使用分段线性基函数的连续伽辽金有限元方法 (FEM)。\n- **网格**：$[0,1]$ 上的均匀网格，包含 $N$ 个单元，其中 $h = 1/N$。\n- **边界条件处理**：将 $v=0$ 处的反射条件作为自然 (Neumann) 边界条件。将 $v=1$ 处的吸收条件作为本质 (Dirichlet) 边界条件。\n- **任务**：\n    1. 实现指定的 FEM 来计算近似解 $u_h(v)$。\n    2. 对网格尺寸 $N \\in \\{20, 40, 80, 160\\}$，计算 $L^2$-误差 $\\|u - u_h\\|_{L^2(0,1)}$。\n    3. 通过对 $\\log(\\|u - u_h\\|_{L^2})$ 与 $\\log(h)$ 进行线性最小二乘拟合来估计收敛率 $r$。\n    4. 推导并使用 $u(v)$ 的精确解析解进行误差计算。\n- **测试用例**：\n    - 用例 1：$b = 0.3$，$D = 0.05$。\n    - 用例 2：$b = 0.0$，$D = 0.1$。\n    - 用例 3：$b = -0.2$，$D = 0.05$。\n- **输出规范**：一个单行字符串，包含三个估计收敛率的逗号分隔列表，四舍五入到三位小数，例如 `[2.000,1.998,2.001]`。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了漂移扩散过程的平均首达时间，这是随机过程理论的基石，在计算神经科学、物理学和金融学中有直接应用。控制方程是稳态后向 Kolmogorov 方程，这是该领域一个标准且基础的椭圆型二阶常微分方程。该模型具有科学合理性。\n2.  **适定性**：该问题是一个带有两个边界条件（一个 Dirichlet，一个 Neumann）的线性二阶常微分方程。这构成了一个适定边值问题，对于给定的参数，可以证明其存在唯一且稳定的解。\n3.  **客观性**：问题陈述使用了精确的数学语言。所有参数、方程和条件都得到了客观的定义。不存在主观或基于观点的陈述。\n4.  **完整性与一致性**：问题提供了所有必要的信息：控制方程、定义域、边界条件、测试用例的参数、要使用的数值方法，以及所需的分析（收敛率估计）。内部没有矛盾。\n5.  **可行性**：推导解析解是常微分方程的标准练习。实现一维伽辽金有限元方法是数值分析中的标准任务。计算量在标准硬件的能力范围之内。\n6.  **结构**：问题结构清晰，要求执行数值方法中标准的验证与确认程序：将数值解与解析解进行比较，以验证理论收敛率。这并非无关紧要，因为它需要推导弱形式、实现 FEM 组装和误差分析。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个适定的、科学合理的、并且信息完整的问题陈述，属于数值分析应用于计算神经科学的领域。我将继续提供完整解答。\n\n### 解答推导与数值策略\n\n#### 1. 解析解\n控制常微分方程 (ODE) 是 $D\\,u''(v) + b\\,u'(v) = -1$。\n令 $w(v) = u'(v)$。关于 $w$ 的方程是一阶线性 ODE $D w' + b w = -1$，或 $w' + (b/D) w = -1/D$。\n\n**情况 A：$b \\neq 0$**\n积分因子为 $I(v) = \\exp\\left(\\int (b/D) \\, dv\\right) = e^{bv/D}$。\n将 ODE 乘以 $I(v)$ 得到 $(w(v) e^{bv/D})' = -\\frac{1}{D} e^{bv/D}$。\n对 $v$ 积分：$w(v) e^{bv/D} = -\\frac{1}{D} \\int e^{bv/D} \\, dv = -\\frac{1}{D} \\frac{D}{b} e^{bv/D} + C_1 = -\\frac{1}{b} e^{bv/D} + C_1$。\n因此，$u'(v) = w(v) = -\\frac{1}{b} + C_1 e^{-bv/D}$。\n反射边界条件 $u'(0) = 0$ 得到 $0 = -1/b + C_1$，所以 $C_1 = 1/b$。\n代入 $C_1$ 得到 $u'(v) = \\frac{1}{b} (e^{-bv/D} - 1)$。\n对 $u'(v)$ 积分以求得 $u(v)$：\n$u(v) = \\int \\frac{1}{b} (e^{-bv/D} - 1) \\, dv = \\frac{1}{b} \\left(-\\frac{D}{b} e^{-bv/D} - v\\right) + C_2$。\n吸收边界条件 $u(1) = 0$ 得到 $0 = \\frac{1}{b} \\left(-\\frac{D}{b} e^{-b/D} - 1\\right) + C_2$，所以 $C_2 = \\frac{1}{b} \\left(\\frac{D}{b} e^{-b/D} + 1\\right)$。\n将 $C_2$ 代回，当 $b \\neq 0$ 时的解析解为：\n$$ u(v) = \\frac{1}{b}(1-v) + \\frac{D}{b^2}\\left(e^{-b/D} - e^{-bv/D}\\right) $$\n\n**情况 B：$b = 0$**\nODE 简化为 $D u'' = -1$，即 $u''(v) = -1/D$。\n积分一次：$u'(v) = -\\frac{v}{D} + C_1$。\n条件 $u'(0)=0$ 意味着 $C_1=0$。\n再次积分：$u(v) = -\\frac{v^2}{2D} + C_2$。\n条件 $u(1)=0$ 意味着 $0 = -1/(2D) + C_2$，所以 $C_2 = 1/(2D)$。\n当 $b=0$ 时的解析解为：\n$$ u(v) = \\frac{1}{2D}(1 - v^2) $$\n\n#### 2. 弱（变分）形式\n为了推导弱形式，我们将 ODE 乘以一个足够正则的测试函数 $\\phi(v)$，并在定义域 $[0,1]$ 上积分。我们从空间 $H^1_E(0,1) = \\{\\phi \\in H^1(0,1) \\mid \\phi(1)=0\\}$ 中选择测试函数，其中 $H^1(0,1)$ 是具有平方可积一阶导数的函数的 Sobolev 空间。\n$$ \\int_0^1 (D u''(v) + b u'(v)) \\phi(v) \\, dv = \\int_0^1 (-1) \\phi(v) \\, dv $$\n对二阶导数项应用分部积分法：\n$$ \\int_0^1 D u''(v) \\phi(v) \\, dv = [D u'(v) \\phi(v)]_0^1 - \\int_0^1 D u'(v) \\phi'(v) \\, dv $$\n边界项 $[D u'(v) \\phi(v)]_0^1 = D u'(1) \\phi(1) - D u'(0) \\phi(0)$ 为零，因为：\n- 在 $v=1$ 处，根据测试函数空间的定义，有 $\\phi(1)=0$。\n- 在 $v=0$ 处，反射边界条件是 $u'(0)=0$。\n这使得反射条件成为弱形式的“自然”边界条件。而“本质”边界条件 $u(1)=0$ 必须在解空间上强制施加。\n弱形式为：求 $u \\in H^1$ 且 $u(1)=0$，使得对于所有 $\\phi \\in H^1_E(0,1)$：\n$$ \\int_0^1 (-D u'(v) \\phi'(v) + b u'(v) \\phi(v)) \\, dv = \\int_0^1 (-1) \\phi(v) \\, dv $$\n这可以抽象地写为 $B(u, \\phi) = L(\\phi)$，其中双线性形式 $B(u, \\phi)$ 和线性泛函 $L(\\phi)$ 分别由等式的左侧和右侧定义。\n\n#### 3. 有限元离散化与伽辽金方法\n我们将定义域 $[0,1]$ 离散化为一个包含 $N$ 个单元的均匀网格，节点为 $v_i = i h$，其中 $i=0, \\dots, N$，$h = 1/N$。我们用一个函数 $u_h(v)$ 来近似解 $u(v)$，该函数是分段线性基函数（“帽函数”）$\\phi_j(v)$ 的线性组合：\n$$ u_h(v) = \\sum_{j=0}^{N} U_j \\phi_j(v) $$\n这里，$U_j = u_h(v_j)$ 是未知的节点值。基函数 $\\phi_j(v)$ 在节点 $v_j$ 处为 1，在所有其他节点 $v_k$ 处为 0。\n通过设置 $U_N = 0$ 来施加本质边界条件 $u(1)=0$。近似解的求和实际上是对未知系数 $j=0, \\dots, N-1$ 进行的。\n在伽辽金方法中，测试函数与基函数取自同一空间，即我们用 $\\phi_i$ 进行测试，其中 $i=0, \\dots, N-1$。\n将 $u_h$ 代入 $u$ 的弱形式，并将 $\\phi_i$ 代入 $\\phi$，得到线性系统 $A U = F$：\n$$ \\sum_{j=0}^{N-1} B(\\phi_j, \\phi_i) U_j = L(\\phi_i) \\quad \\text{for } i=0, \\dots, N-1 $$\n系统矩阵 $A$ 和载荷向量 $F$ 的项由以下公式给出：\n$A_{ij} = B(\\phi_j, \\phi_i) = \\int_0^1 (-D \\phi_j'(v) \\phi_i'(v) + b \\phi_j'(v) \\phi_i(v)) \\, dv$\n$F_i = L(\\phi_i) = \\int_0^1 (-1) \\phi_i(v) \\, dv$\n\n#### 4. 单元组装\n积分是逐个单元计算的。在一个通用单元 $K_e = [v_e, v_{e+1}]$ 上，只有基函数 $\\phi_e$ 和 $\\phi_{e+1}$ 非零。设局部基函数为 $N_1(\\xi) = 1-\\xi/h$ 和 $N_2(\\xi) = \\xi/h$，其中局部坐标 $\\xi = v-v_e \\in [0,h]$。其导数为 $N_1' = -1/h$ 和 $N_2' = 1/h$。\n$2 \\times 2$ 的单元矩阵 $A^e$ 的项为 $A^e_{kl} = \\int_{K_e} (-D N_l' N_k' + b N_l' N_k) \\, dv$。\n- $A^e_{11} = \\int_0^h [-D(-\\frac{1}{h})^2 + b(-\\frac{1}{h})(1-\\frac{\\xi}{h})] d\\xi = -\\frac{D}{h} - \\frac{b}{2}$\n- $A^e_{12} = \\int_0^h [-D(\\frac{1}{h})(-\\frac{1}{h}) + b(\\frac{1}{h})(1-\\frac{\\xi}{h})] d\\xi = \\frac{D}{h} + \\frac{b}{2}$\n- $A^e_{21} = \\int_0^h [-D(-\\frac{1}{h})(\\frac{1}{h}) + b(-\\frac{1}{h})(\\frac{\\xi}{h})] d\\xi = \\frac{D}{h} - \\frac{b}{2}$\n- $A^e_{22} = \\int_0^h [-D(\\frac{1}{h})^2 + b(\\frac{1}{h})(\\frac{\\xi}{h})] d\\xi = -\\frac{D}{h} + \\frac{b}{2}$\n单元载荷向量 $F^e$ 的项为 $F^e_k = \\int_{K_e} (-1) N_k \\, dv$。\n- $F^e_1 = \\int_0^h (-1)(1-\\frac{\\xi}{h}) d\\xi = -\\frac{h}{2}$\n- $F^e_2 = \\int_0^h (-1)(\\frac{\\xi}{h}) d\\xi = -\\frac{h}{2}$\n这些单元贡献被组装成用于求解未知数 $U_0, \\dots, U_{N-1}$ 的全局 $N \\times N$ 系统。所得矩阵是三对角的。\n\n#### 5. 误差计算与收敛率\n$L^2$-误差 $E = \\|u - u_h\\|_{L^2(0,1)}$ 是通过数值计算积分来求得的：\n$$ E^2 = \\int_0^1 (u(v) - u_h(v))^2 \\, dv = \\sum_{e=0}^{N-1} \\int_{v_e}^{v_{e+1}} (u(v) - u_h(v))^2 \\, dv $$\n我们对每个单元使用高阶高斯求积法则以保证精度。对于二阶 ODE，使用分段线性单元的理论收敛率是 $r=2$，意味着 $E \\propto h^r$。通过对一系列网格细化 $h=1/N$ 计算误差，我们可以通过对数据点 $(\\log(h), \\log(E))$ 进行线性拟合的斜率来估计 $r$。\n$$ \\log(E) \\approx r \\log(h) + \\text{const} $$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the result.\n    \"\"\"\n    \n    test_cases = [\n        (0.3, 0.05),  # Case 1: b, D\n        (0.0, 0.1),   # Case 2: b, D\n        (-0.2, 0.05)  # Case 3: b, D\n    ]\n    \n    mesh_sizes = [20, 40, 80, 160]\n    \n    estimated_rates = []\n\n    for b, D in test_cases:\n        \n        # Define the analytical solution for u(v)\n        def u_exact(v, b_val, D_val):\n            v_arr = np.asarray(v)\n            if np.isclose(b_val, 0.0):\n                return (1.0 - v_arr**2) / (2.0 * D_val)\n            else:\n                term1 = (1.0 - v_arr) / b_val\n                exp_term = np.exp(-b_val / D_val) - np.exp(-b_val * v_arr / D_val)\n                term2 = (D_val / b_val**2) * exp_term\n                return term1 + term2\n\n        h_values = []\n        l2_errors = []\n\n        for N in mesh_sizes:\n            h = 1.0 / N\n            h_values.append(h)\n\n            # Assemble the FEM system matrix (A) and load vector (F)\n            # We solve for U_0, ..., U_{N-1}, so system size is N x N.\n            # A is tridiagonal. Store it in banded format for efficiency.\n            A_banded = np.zeros((3, N))\n            F = np.zeros(N)\n\n            # Element matrix components\n            a11 = -D/h - b/2.0\n            a12 = D/h + b/2.0\n            a21 = D/h - b/2.0\n            a22 = -D/h + b/2.0\n            \n            # Element force vector\n            f1 = -h/2.0\n            f2 = -h/2.0\n\n            # Assemble global system\n            # First row (i=0)\n            A_banded[1, 0] = a11\n            A_banded[0, 1] = a12\n            F[0] = f1\n\n            # Interior rows (i=1 to N-2)\n            for i in range(1, N - 1):\n                A_banded[2, i-1] = a21\n                A_banded[1, i] = a22 + a11\n                A_banded[0, i+1] = a12\n                F[i] = f2 + f1\n            \n            # Last row (i=N-1)\n            A_banded[2, N-2] = a21\n            A_banded[1, N-1] = a22 + a11\n            F[N-1] = f2 + f1\n            \n            # Solve the linear system A*U = F\n            # `solve_banded` expects the matrix in a specific banded format, (l, u), ab\n            # Here, l=1 (lower diagonals), u=1 (upper diagonals)\n            U = solve_banded((1, 1), A_banded, F)\n            \n            # Full solution vector including the boundary condition U_N = 0\n            U_full = np.concatenate([U, [0.0]])\n            nodes = np.linspace(0, 1, N + 1)\n\n            # Compute L2 error using numerical quadrature\n            total_error_sq = 0.0\n            for i in range(N):\n                # Integrand for the squared error on element i\n                def error_sq_integrand(v):\n                    # Piecewise linear approximation u_h(v) on element [v_i, v_{i+1}]\n                    u_h = U_full[i] * (nodes[i+1] - v) / h + U_full[i+1] * (v - nodes[i]) / h\n                    # Squared difference\n                    return (u_exact(v, b, D) - u_h)**2\n\n                # Integrate over element [v_i, v_{i+1}]\n                elem_error_sq, _ = quad(error_sq_integrand, nodes[i], nodes[i+1])\n                total_error_sq += elem_error_sq\n            \n            l2_errors.append(np.sqrt(total_error_sq))\n\n        # Estimate convergence rate r by linear regression on log-log data\n        log_h = np.log(h_values)\n        log_err = np.log(l2_errors)\n        \n        # Fit a line: log(err) = r * log(h) + C. The slope is the rate r.\n        rate, _ = np.polyfit(log_h, log_err, 1)\n        estimated_rates.append(rate)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.3f}' for r in estimated_rates)}]\")\n\nsolve()\n```"
        }
    ]
}