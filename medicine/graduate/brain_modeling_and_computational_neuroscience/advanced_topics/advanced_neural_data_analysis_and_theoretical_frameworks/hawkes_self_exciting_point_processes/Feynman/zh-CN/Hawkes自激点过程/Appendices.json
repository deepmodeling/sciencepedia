{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握一个模型，首先需要理解其最基本的属性。对于霍克斯过程，一个核心问题是：在自激和外部驱动的共同作用下，系统最终会达到怎样的平衡状态？本练习  将引导我们探索单变量霍克斯过程的稳态特性。通过推导分支比 $ \\eta $ 和稳态平均强度 $ \\bar{\\lambda} $ 等关键量，我们不仅能深入理解模型参数的物理意义，还能掌握判断过程是否“爆炸”的关键判据，这是后续所有分析的基础。",
            "id": "3986738",
            "problem": "皮层中单个神经元的脉冲序列被建模为实线上的一个线性霍克斯自激点过程，其条件强度 $ \\lambda(t) $ 由标准的因果结构定义：$ \\lambda(t) $ 依赖于一个外生基线驱动以及通过一个因果核函数依赖于该过程的历史。具体来说，假设随着时间 $ t $ 的演进，$ \\lambda(t) $ 由一个恒定的基线 $ \\mu $ (单位为 $ \\mathrm{s}^{-1} $) 加上通过一个非负因果核函数 $ \\phi(u) $ 来自过去脉冲的贡献给出，其中 $ u $ 表示自过去某个脉冲以来经过的时间。其生物学解释是，每个脉冲都会产生一个兴奋性的瞬时增加，这种增加会随时间衰减。\n\n假设以下参数化对于兴奋性突触效应在科学上是有效的：当 $ u > 0 $ 时，$ \\phi(u) = \\alpha \\exp(-\\beta u) $，当 $ u \\leq 0 $ 时，$ \\phi(u) = 0 $，其中 $ \\alpha > 0 $ 且 $ \\beta > 0 $。这些参数满足量纲一致性：$\\mu$ 的单位是 $\\mathrm{s}^{-1}$，$\\phi$ 的单位是 $\\mathrm{s}^{-1}$，因此 $\\alpha$ 的单位是 $\\mathrm{s}^{-1}$，而 $\\beta$ 的单位也是 $\\mathrm{s}^{-1}$。假设该过程已达到一个统计平稳状态，其中平均强度存在且为有限值。\n\n仅从霍克斯过程强度的因果定义以及每个脉冲通过核函数贡献额外的预期未来脉冲这一解释出发，推导下列量关于 $\\mu$、$\\alpha$ 和 $\\beta$ 的闭式表达式：\n\n- 分支比 $\\eta$，定义为单个事件通过自激机制产生的直接后代的期望数量。\n- 平稳平均强度 $\\bar{\\lambda}$，以脉冲/秒（单位 $\\mathrm{s}^{-1}$）表示。\n- 内生事件（由自激产生的事件）的平稳比例和外生事件（由基线驱动产生的移入事件）的平稳比例，每个都表示为 $[0,1]$ 区间内的无量纲量。\n\n假设所有平稳性所需的必要条件都成立。如果推导的有效性需要任何关于参数的条件，请在解题过程中明确说明。请提供精确的最终表达式，无需四舍五入。在你的最终答案中，按顺序 $\\eta$、$ \\bar{\\lambda}$、内生事件比例、外生事件比例，给出所求的四个量。",
            "solution": "该问题要求推导与平稳线性霍克斯自激点过程相关的四个关键量：分支比 $\\eta$、平稳平均强度 $\\bar{\\lambda}$，以及内生和外生事件的平稳比例。该过程由其条件强度函数 $\\lambda(t)$ 定义，该函数依赖于一个恒定的基线率 $\\mu$ 和通过因果核函数 $\\phi(u)$ 体现的过去事件 $\\{t_i\\}$ 的历史。\n\n在时间 $t$ 的条件强度由下式给出：\n$$\n\\lambda(t) = \\mu + \\sum_{t_i  t} \\phi(t - t_i)\n$$\n其中核函数指定为：当 $u > 0$ 时，$\\phi(u) = \\alpha \\exp(-\\beta u)$；当 $u \\leq 0$ 时，$\\phi(u) = 0$。给定的参数为 $\\mu > 0$、$\\alpha > 0$ 和 $\\beta > 0$。\n\n首先，我们推导分支比 $\\eta$。分支比定义为单个父事件产生的直接后代事件的期望数量。在时间 $t_j$ 发生的单个事件，会在所有未来时间 $t > t_j$ 给强度增加一项 $\\phi(t - t_j)$。由这一强度贡献所产生的新事件的期望数量是此函数在所有未来时间上的积分。\n令 $u = t - t_j$ 为自父事件发生以来经过的时间，则后代的期望数量为：\n$$\n\\eta = \\int_{0}^{\\infty} \\phi(u) \\, du\n$$\n代入给定的指数核函数：\n$$\n\\eta = \\int_{0}^{\\infty} \\alpha \\exp(-\\beta u) \\, du\n$$\n这是一个标准的指数积分。由于 $\\alpha$ 是一个常数，我们有：\n$$\n\\eta = \\alpha \\int_{0}^{\\infty} \\exp(-\\beta u) \\, du = \\alpha \\left[ -\\frac{1}{\\beta} \\exp(-\\beta u) \\right]_{0}^{\\infty}\n$$\n计算其极限，并注意到 $\\beta > 0$ 保证了 $\\lim_{u \\to \\infty} \\exp(-\\beta u) = 0$：\n$$\n\\eta = \\alpha \\left( 0 - \\left(-\\frac{1}{\\beta} \\exp(0)\\right) \\right) = \\alpha \\left(\\frac{1}{\\beta}\\right) = \\frac{\\alpha}{\\beta}\n$$\n这个 $\\eta$ 的表达式是无量纲的，因为 $\\alpha$ 和 $\\beta$ 的单位都是 $\\mathrm{s}^{-1}$。\n\n接下来，我们推导平稳平均强度 $\\bar{\\lambda}$。对于一个平稳过程，平均强度 $\\bar{\\lambda}$ 是一个常数，$\\bar{\\lambda} = E[\\lambda(t)]$。我们对条件强度方程取期望：\n$$\n\\bar{\\lambda} = E\\left[\\mu + \\sum_{t_i  t} \\phi(t - t_i)\\right]\n$$\n根据期望的线性性质：\n$$\n\\bar{\\lambda} = E[\\mu] + E\\left[\\sum_{t_i  t} \\phi(t - t_i)\\right] = \\mu + E\\left[\\int_{-\\infty}^{t} \\phi(t-s) \\, dN(s)\\right]\n$$\n其中 $dN(s)$ 是在时间 $s$ 的计数过程增量。对平稳点过程使用坎贝尔定理，该积分的期望是核函数乘以过程的平均速率的积分，即 $E[dN(s)] = \\bar{\\lambda} \\, ds$：\n$$\n\\bar{\\lambda} = \\mu + \\int_{-\\infty}^{t} \\phi(t-s) \\bar{\\lambda} \\, ds\n$$\n进行变量替换，令 $u = t - s$，则 $du = -ds$：\n$$\n\\bar{\\lambda} = \\mu + \\bar{\\lambda} \\int_{0}^{\\infty} \\phi(u) \\, du\n$$\n积分 $\\int_{0}^{\\infty} \\phi(u) \\, du$ 正是我们之前计算的分支比 $\\eta$。这就得到了平均速率的基本自洽方程：\n$$\n\\bar{\\lambda} = \\mu + \\bar{\\lambda} \\eta\n$$\n我们现在可以解出 $\\bar{\\lambda}$：\n$$\n\\bar{\\lambda} (1 - \\eta) = \\mu\n$$\n$$\n\\bar{\\lambda} = \\frac{\\mu}{1 - \\eta}\n$$\n为了使过程平稳且具有有限的正平均强度，我们必须有 $\\bar{\\lambda} > 0$。由于给定 $\\mu > 0$，这要求 $1 - \\eta > 0$，即 $\\eta  1$。这是线性霍克斯过程稳定性的临界条件。代入 $\\eta$ 的表达式，该条件为 $\\frac{\\alpha}{\\beta}  1$，即 $\\alpha  \\beta$。\n将 $\\eta = \\frac{\\alpha}{\\beta}$ 代入 $\\bar{\\lambda}$ 的表达式中：\n$$\n\\bar{\\lambda} = \\frac{\\mu}{1 - \\frac{\\alpha}{\\beta}} = \\frac{\\mu}{\\frac{\\beta - \\alpha}{\\beta}} = \\frac{\\mu \\beta}{\\beta - \\alpha}\n$$\n这个 $\\bar{\\lambda}$ 的表达式在 $\\alpha  \\beta$ 的条件下有效。单位是一致的，因为 $\\mu$ 的单位是 $\\mathrm{s}^{-1}$，而比率 $\\frac{\\beta}{\\beta - \\alpha}$ 是无量纲的。\n\n最后，我们确定内生和外生事件的平稳比例。霍克斯过程可以通过“细化”或“聚类”构造来理解。事件要么是根据速率为 $\\mu$ 的齐次泊松过程到达的“外生”移入事件，要么是由先前事件产生的“内生”后代事件。\n在平稳状态下，事件的总速率为 $\\bar{\\lambda}$。\n根据定义，外生事件的速率为 $\\mu$。\n内生事件的速率是总速率减去外生速率：$\\bar{\\lambda} - \\mu$。\n外生事件的比例是外生速率与总速率之比：\n$$\n\\text{Fraction}_{\\text{exogenous}} = \\frac{\\mu}{\\bar{\\lambda}}\n$$\n使用关系式 $\\bar{\\lambda} = \\frac{\\mu}{1 - \\eta}$，我们发现：\n$$\n\\text{Fraction}_{\\text{exogenous}} = \\frac{\\mu}{\\frac{\\mu}{1 - \\eta}} = 1 - \\eta = 1 - \\frac{\\alpha}{\\beta} = \\frac{\\beta - \\alpha}{\\beta}\n$$\n内生事件的比例是内生速率与总速率之比：\n$$\n\\text{Fraction}_{\\text{endogenous}} = \\frac{\\bar{\\lambda} - \\mu}{\\bar{\\lambda}} = 1 - \\frac{\\mu}{\\bar{\\lambda}}\n$$\n这恰好是 $1$ 减去外生事件的比例：\n$$\n\\text{Fraction}_{\\text{endogenous}} = 1 - (1 - \\eta) = \\eta = \\frac{\\alpha}{\\beta}\n$$\n这个结果是直观的：分支比 $\\eta$，即每个事件的平均后代数，恰好是平稳状态下所有事件中后代事件所占的比例。这两个比例都是无量纲的，并且它们的和为 $1$，符合预期。\n\n按顺序排列，所求的四个量是：\n1.  分支比 $\\eta$：$\\frac{\\alpha}{\\beta}$\n2.  平稳平均强度 $\\bar{\\lambda}$：$\\frac{\\mu \\beta}{\\beta - \\alpha}$\n3.  内生事件的平稳比例：$\\frac{\\alpha}{\\beta}$\n4.  外生事件的平稳比例：$\\frac{\\beta - \\alpha}{\\beta}$\n所有表达式都是在平稳性的必要条件 $\\eta  1$（即 $\\alpha  \\beta$）下推导出来的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\alpha}{\\beta}  \\frac{\\mu \\beta}{\\beta - \\alpha}  \\frac{\\alpha}{\\beta}  \\frac{\\beta - \\alpha}{\\beta} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了霍克斯过程的理论属性后，下一个自然的步骤是学习如何从模型中生成数据。精确的仿真不仅是检验理论预测的工具，也是开发更复杂模型和推理算法的基石。本练习  聚焦于 Ogata 的瘦化算法（thinning algorithm），这是一种用于模拟点过程的标准且精确的方法。通过这个实践，你将掌握如何为一个强度依赖于其自身历史的动态过程生成事件序列，从而将抽象的数学模型转化为具体的数据。",
            "id": "3986744",
            "problem": "一个单变量自激励霍克斯过程（univariate self-exciting Hawkes process）被用来在一个有限窗口 $\\left[0,T\\right]$ 上对单个神经元的尖峰序列进行建模，其条件强度 $\\lambda(t \\mid \\mathcal{H}_t)$ 由一个恒定的基线加上一个因果的、非负的历史滤波器给出：$\\lambda(t) = \\mu + \\sum_{t_i  t} \\phi(t - t_i)$，其中 $\\mu > 0$ 且 $\\phi(\\cdot)$ 的支撑集在 $(0,\\infty)$ 上。考虑广泛使用的指数核函数 $\\phi(u) = \\alpha e^{-\\beta u}$（对于 $u > 0$），其中 $\\alpha > 0$ 且 $\\beta > 0$。并假设分支比 $\\int_0^\\infty \\phi(u)\\,du = \\alpha/\\beta  1$，以使过程是稳定的。你的任务是使用针对这种状态依赖强度的 Ogata 抽样稀疏法（Ogata’s thinning method）来模拟该过程直到时间 $T$，其方式应与点过程的条件强度公理以及非齐次泊松过程（Nonhomogeneous Poisson Process, NHPP）的标准稀疏构造相一致。\n\n哪个选项提供了在这种情况下 Ogata 抽样稀疏算法的正确分步描述，包括：(i) 在每一步构造一个在下一次事件发生前的所有未来时间都有效的控制强度（dominating intensity），(ii) 候选事件时间的生成，(iii) 接受准则，以及 (iv) 在接受和拒绝后正确的状态更新，以及在 $T$ 时刻停止？\n\n选择唯一的最佳选项。\n\nA. 在当前时间 $s$ 和历史 $\\mathcal{H}_s$ 下，计算当前强度 $\\lambda(s)$。由于指数核函数自每个尖峰发生以来是随时间非增的，因此对于 $t \\ge s$，强度被 $\\lambda(s)$ 上界限定。使用恒定的控制速率 $\\bar{\\lambda} = \\lambda(s)$，采样一个候选的到达间隔 $\\Delta \\sim \\mathrm{Exp}(\\bar{\\lambda})$ 并设置 $t' = s + \\Delta$。如果 $t' > T$，则停止。否则，根据历史计算真实强度 $\\lambda(t')$（考虑 $s$ 和 $t'$ 之间的确定性衰减）并抽取 $U \\sim \\mathrm{Unif}(0,1)$。如果 $U \\le \\lambda(t')/\\bar{\\lambda}$，则接受该候选事件。如果接受，则在 $t'$ 记录一个事件，更新历史，设置 $s \\leftarrow t'$，然后重复。如果拒绝，不记录事件，设置 $s \\leftarrow t'$，通过将过去的贡献确定性地衰减到时间 $t'$ 来更新状态，将当前上界重新计算为 $\\bar{\\lambda} \\leftarrow \\lambda(s)$，并重复直到 $t' > T$。\n\nB. 在当前时间 $s$，因为基线是恒定的，所以用基线 $\\bar{\\lambda} = \\mu$ 作为强度上界，采样 $\\Delta \\sim \\mathrm{Exp}(\\bar{\\lambda})$，设置 $t' = s + \\Delta$，如果 $t' > T$ 则停止。否则，计算 $\\lambda(t')$ 并以概率 $\\lambda(t')/\\mu$ 接受。如果拒绝，保持 $s$ 不变，并使用相同的上界 $\\bar{\\lambda} = \\mu$ 重复直到接受，然后设置 $s \\leftarrow t'$ 并继续。\n\nC. 在当前时间 $s$，取上界 $\\bar{\\lambda} = \\lambda(s)$ 并采样 $\\Delta \\sim \\mathrm{Exp}(\\bar{\\lambda})$，设置 $t' = s + \\Delta$，如果 $t' > T$ 则停止。否则，计算 $\\lambda(t')$ 并以概率 $\\left(\\bar{\\lambda} - \\lambda(t')\\right)/\\bar{\\lambda}$ 接受。如果拒绝，将强度保持在其值 $\\lambda(s)$ 不变，保持 $s$ 不变，并从 $\\mathrm{Exp}(\\bar{\\lambda})$ 中重新采样另一个 $\\Delta$。\n\nD. 使用恒定的控制速率 $\\bar{\\lambda} = \\lambda(s)$，采样 $\\Delta \\sim \\mathrm{Exp}(\\bar{\\lambda})$，设置 $t' = s + \\Delta$，并以概率 $\\lambda(t')/\\bar{\\lambda}$ 接受。如果拒绝，不推进时间；而是保持 $s$ 固定，并从相同的 $\\bar{\\lambda}$ 中重新采样 $\\Delta$。如果接受，将时间推进到 $t'$，添加一个事件，并重新计算 $\\bar{\\lambda} = \\lambda(t')$。重复此过程，直到事件数量达到预设计数，然后停止，无论 $T$ 为多少。",
            "solution": "用户希望对问题陈述进行严格验证，如果有效，则进行完整的推导和分析，以确定描述特定霍克斯过程的 Ogata 抽样稀疏算法的正确选项。\n\n### 问题验证\n\n对问题陈述进行严格的验证程序。\n\n**步骤 1：提取已知条件**\n- **过程类型**：单变量自激励霍克斯过程。\n- **模拟窗口**：$\\left[0,T\\right]$。\n- **条件强度**：$\\lambda(t \\mid \\mathcal{H}_t)$ 由 $\\lambda(t) = \\mu + \\sum_{t_i  t} \\phi(t - t_i)$ 给出。\n- **基线率**：$\\mu > 0$。\n- **历史核函数**：$\\phi(u) = \\alpha e^{-\\beta u}$ (对于 $u > 0$)。\n- **核函数参数**：$\\alpha > 0$ 且 $\\beta > 0$。\n- **稳定性条件**：分支比为 $\\int_0^\\infty \\phi(u)\\,du = \\alpha/\\beta  1$。\n- **模拟方法**：Ogata 抽样稀疏法。\n- **目标**：在给定选项中，确定此模拟算法的正确分步描述。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题在科学上和数学上都是合理的。霍克斯过程是一个标准的点过程模型，指数核函数是一个经典选择。条件强度函数定义正确。稳定性条件 $\\alpha/\\beta  1$ 是确保指数核函数过程不会爆炸的正确准则。Ogata 抽样稀疏算法是模拟此类过程的标准且正确的方法。该问题牢固地植根于已建立的随机点过程理论。\n- **适定性**：该问题是适定的。它要求对一个精确定义的模拟任务给出正确的算法描述。基于点过程模拟理论，存在一个唯一的、正确的算法。\n- **客观性**：该问题以精确、客观且无歧义的数学语言陈述。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。它科学合理、适定，并且没有任何无效标准。我现在将进行完整的推导和分析。\n\n### 推导与分析\n\n目标是在区间 $[0, T]$ 上模拟一个条件强度为 $\\lambda(t) = \\mu + \\sum_{t_i  t} \\alpha e^{-\\beta (t - t_i)}$ 的点过程。所用的方法是 Ogata 抽样稀疏算法，它是非齐次泊松过程（NHPPs）稀疏程序的推广。\n\n**Ogata 抽样稀疏算法的原理：**\n核心原理是找到一个控制强度函数 $\\bar{\\lambda}(t)$，使得在模拟区间内的所有 $t$ 都满足 $\\lambda(t) \\le \\bar{\\lambda}(t)$。然后，模拟一个速率为 $\\bar{\\lambda}$ 的更简单的过程（如果 $\\bar{\\lambda}(t)$ 可以选择为常数，则通常是齐次泊松过程），并对生成的候选事件进行“稀疏化”，以恢复强度为 $\\lambda(t)$ 的目标过程的统计特性。\n\n**将原理应用于特定的霍克斯过程：**\n假设我们处于时间 $s$，此时之前的事件历史为 $\\mathcal{H}_s = \\{t_1, t_2, \\dots, t_n\\}$，其中所有 $t_i  s$。在时间 $s$ 的强度为：\n$$ \\lambda(s) = \\mu + \\sum_{t_i \\in \\mathcal{H}_s} \\alpha e^{-\\beta (s - t_i)} $$\n现在，考虑未来某个时间 $t > s$ 的强度，假设在 $s$ 和 $t$ 之间没有新事件发生。强度为：\n$$ \\lambda(t) = \\mu + \\sum_{t_i \\in \\mathcal{H}_s} \\alpha e^{-\\beta (t - t_i)} $$\n由于 $\\alpha > 0$ 和 $\\beta > 0$，每一项 $e^{-\\beta (t - t_i)}$ 都是关于 $t$ 的严格递减函数。因此，它们的和也是关于 $t$ 的严格递减函数。这意味着对于任何 $t > s$，在没有新事件发生的情况下，$\\lambda(t)  \\lambda(s)$。\n\n这个关键属性提供了一个简单的、依赖于状态的，但在局部是恒定的上界。对于从当前时间 $s$ 开始并延伸到下一个事件的区间，强度 $\\lambda(t)$ 被其在该区间开始时的值 $\\lambda(s)$ 上界限定。\n$$ \\lambda(t) \\le \\lambda(s) \\quad \\text{对于 } t \\ge s \\text{ (直到下一个事件)} $$\n因此，我们可以使用 $\\bar{\\lambda} = \\lambda(s)$ 作为我们的控制速率。\n\n**分步算法：**\n设 $s$ 为当前时间，初始化为 $s=0$。\n1.  **建立上界**：计算当前时间 $s$ 的强度：$\\lambda(s) = \\mu + \\sum_{t_i  s} \\alpha e^{-\\beta(s-t_i)}$。将下一步的控制速率设置为 $\\bar{\\lambda} = \\lambda(s)$。\n2.  **生成候选者**：从速率为 $\\bar{\\lambda}$ 的齐次泊松过程中生成一个候选到达间隔时间 $\\Delta$。这等同于从指数分布中抽取 $\\Delta$：$\\Delta \\sim \\mathrm{Exp}(\\bar{\\lambda})$。候选事件时间为 $t' = s + \\Delta$。\n3.  **检查停止条件**：如果 $t' > T$，则超出了模拟窗口。终止模拟。\n4.  **接受/拒绝**：如果 $t' \\le T$，我们必须决定是否接受这个候选者。\n    a. 计算候选时间 $t'$ 的真实强度：$\\lambda(t') = \\mu + \\sum_{t_i  s} \\alpha e^{-\\beta(t'-t_i)}$。注意，这个求和是基于*旧的*历史，只是衰减到新的时间 $t'$。\n    b. 从 $[0, 1]$ 上的均匀分布中生成一个随机数 $U$，即 $U \\sim \\mathrm{Unif}(0,1)$。\n    c. **接受准则**：如果 $U \\le \\frac{\\lambda(t')}{\\bar{\\lambda}}$，则接受候选者。在时间 $t'$ 记录一个事件。当前时间更新为 $s \\leftarrow t'$，并将新事件添加到历史中，从步骤 1 开始重复该过程。\n    d. **拒绝准则**：如果 $U > \\frac{\\lambda(t')}{\\bar{\\lambda}}$，则拒绝候选者。不记录事件。关键的是，时间仍然前进了。系统已经确定性地演化到了时间 $t'$。因此，当前时间必须更新为 $s \\leftarrow t'$。然后从这个新的时间 $s$ 开始，在事件历史不变的情况下，从步骤 1 开始重复该过程。\n\n这个过程正确地模拟了该过程，因为在一个小区间 $[t, t+dt)$ 内发生事件的概率是 $\\lambda(t)dt$。抽样稀疏算法通过以速率 $\\bar{\\lambda} \\ge \\lambda(t)$ 生成候选者，并以概率 $\\lambda(t)/\\bar{\\lambda}$ 接受它们，从而正确地构造了这一点，得到的有效事件速率为 $\\bar{\\lambda} \\times (\\lambda(t)/\\bar{\\lambda}) = \\lambda(t)$。\n\n### 逐项分析\n\n**选项 A：**\n该选项陈述：\n- 在当前时间 $s$ 计算 $\\lambda(s)$。**正确**。\n- 使用 $\\bar{\\lambda} = \\lambda(s)$ 作为控制速率，理由是核函数的贡献具有非增性。**正确**。\n- 采样 $\\Delta \\sim \\mathrm{Exp}(\\bar{\\lambda})$ 并设置 $t' = s + \\Delta$。**正确**。\n- 如果 $t' > T$ 则停止。**正确**。\n- 计算考虑衰减的真实 $\\lambda(t')$，如果 $U \\le \\lambda(t')/\\bar{\\lambda}$ 则接受。**正确**。\n- 接受时：记录事件，更新历史，设置 $s \\leftarrow t'$，重复。**正确**。\n- 拒绝时：不记录事件，设置 $s \\leftarrow t'$，在新的 $s$ 重新计算上界，然后重复。**正确**。这正确地捕捉到了拒绝时推进时间这一基本步骤。\n\n**结论：** 选项 A 中的描述是针对指定霍克斯过程的 Ogata 抽样稀疏算法的完整且准确的实现。**正确**。\n\n**选项 B：**\n该选项陈述：\n- 用 $\\bar{\\lambda} = \\mu$ 作为强度上界。这在根本上是错误的。强度为 $\\lambda(t) = \\mu + \\sum \\phi(\\dots)$，其中求和项是非负的。因此，$\\lambda(t) \\ge \\mu$，$\\mu$ 是一个*下界*，而不是上界。将其用作控制速率 $\\bar{\\lambda}$ 是不正确的，并且会导致接受概率 $\\lambda(t')/\\mu$ 可能大于 1。\n\n**结论：** 该选项提出了一个无效的控制速率。**不正确**。\n\n**选项 C：**\n该选项陈述：\n- 它使用了正确的上界 $\\bar{\\lambda} = \\lambda(s)$。\n- 然而，它使用的接受概率是 $(\\bar{\\lambda} - \\lambda(t'))/\\bar{\\lambda}$。这是 $1 - \\lambda(t')/\\bar{\\lambda}$，这是*拒绝*的概率，而不是接受的概率。\n- 此外，它指出在拒绝时，时间 $s$ 保持不变。这是实现抽样稀疏算法时的一个关键错误。拒绝时不推进时间会导致一个根本上不同且不正确的过程，其中算法会卡在时间 $s$ 直到候选者被接受。\n\n**结论：** 该选项使用了不正确的接受概率，并且关键地，在拒绝时未能推进时间。**不正确**。\n\n**选项 D：**\n该选项陈述：\n- 它使用了正确的上界和接受概率。\n- 然而，与选项 C 一样，它指出在拒绝时，时间 $s$ 保持固定。如上所述，这是算法逻辑中的一个致命缺陷。\n- 此外，它提出了一个基于预设事件计数的停止条件，这与问题陈述中要求在时间窗口 $[0, T]$ 内进行模拟的要求相矛盾。\n\n**结论：** 该选项在拒绝时未能推进时间，并使用了不正确的停止条件。**不正确**。\n\n基于严谨的分析，只有选项 A 提供了关于模拟过程的事实上和算法上都正确的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "建立模型并拟合数据后，我们如何确定这个模型是否真正捕捉了数据的内在规律？一个模型的好坏最终取决于它对数据的描述能力。本练习  介绍了一种强大的模型诊断工具——时间重标度定理（Time-Rescaling Theorem）。该定理提供了一种巧妙的方法，通过对事件时间进行变换，来检验模型的拟合优度。掌握这项技术对于任何严肃的点过程数据分析都是至关重要的，它使我们能够严格地评估并选择最佳模型。",
            "id": "3986869",
            "problem": "您观察到来自单个神经元的脉冲时间 $0  t_1  t_2  \\dots  t_K \\leq T$，并假设它们遵循一个条件强度为 $\\lambda(t)$ 的点过程。您的目标是使用时间重标度定理来评估您的模型 $\\lambda(t)$ 的拟合优度。\n\n以下哪个（些）陈述正确地描述了时间重标度变换的推导、应用及其诊断解释？\n\nA. 根据条件强度的定义，给定 $\\mathcal{H}_{t}$ 时，下一个事件间时间 $\\tau$ 的生存概率为 $\\mathbb{P}\\{\\tau>x\\mid\\mathcal{H}_{t}\\}=\\exp\\!\\left(-\\int_{t}^{t+x}\\lambda(s)\\,ds\\right)$。因此，连续事件间间隔的经典时间重标度变换为 $u_{k}=\\int_{t_{k-1}}^{t_{k}}\\lambda(s)\\,ds$，并且在一个设定正确的模型中，序列 $\\{u_{k}\\}_{k=1}^{K}$ 是独立同分布于参数为1的指数分布 ($\\mathrm{Exponential}(1)$)。\n\nB. 为执行柯尔莫哥洛夫-斯米尔诺夫 (KS) 检验，通过 $z_{k}=1-\\exp(-u_{k})$ 变换 $u_{k}$，使得在正确模型下 $\\{z_{k}\\}$ 独立同分布于 $\\mathrm{Uniform}(0,1)$；然后将经验累积分布函数与 $F(z)=z$ 进行比较。系统性偏差（例如，对于小的 $z$，经验曲线在对角线上方）平均而言表明强度被低估，而偏差在对角线下方则表明强度被高估。\n\nC. 因为 Hawkes 过程是自激励的，所以即使在设定正确的模型下，变换后的变量 $\\{u_{k}\\}$ 仍然保持正自相关；因此，对 $\\{u_{k}\\}$ 进行的 KS 检验是无效的，除非首先对脉冲序列进行稀疏化以减少丛集放电。\n\nD. 只需计算 $u_{k}=\\int_{t_{k-1}}^{t_{k}}\\lambda(s)\\,ds$，然后直接对其与 $\\mathrm{Uniform}(0,1)$ 分布进行柯尔莫哥洛夫-斯米尔诺夫检验，因为在正确设定下 $\\{u_{k}\\}$ 是均匀分布的。\n\nE. 在有限的记录窗口 $[0,T]$ 中，为避免偏差，必须通过将 $z_{K+1}=1-\\exp\\!\\left(-\\int_{t_{K}}^{T}\\lambda(s)\\,ds\\right)$ 添加到 KS 检验样本中，以包含右删失的最终区间，从而使所有观察到的时间跨度都有贡献。",
            "solution": "本题要求推导一个简单点过程的经典时间重标度变换，并解释其在拟合优度检验中的应用，然后评估五个陈述。\n\n### 推导与原理\n\n分析的基础是时间重标度定理，我们将根据所提供的条件强度 $\\lambda(t)$ 的定义来推导它。\n\n设 $0  t_1  \\cdots  t_K \\leq T$ 是观察到的脉冲时间。该过程由其条件强度 $\\lambda(t)$ 表征，$\\lambda(t)$ 是在给定截至时间 $t$ 的过程历史 $\\mathcal{H}_t = \\{t_i : t_i  t\\}$ 的条件下，在时间 $t$ 发生一个事件的瞬时速率。其定义为 $\\mathbb{P}\\{N(t+dt)-N(t)=1\\mid\\mathcal{H}_{t}\\}=\\lambda(t)\\,dt+o(dt)$，其中 $N(t)$ 是计数过程。\n\n首先，我们来推导下一个事件的等待时间的生存函数。设 $\\tau$ 是在给定时间 $t$ 之后，以历史 $\\mathcal{H}_t$ 为条件的下一个脉冲的等待时间。生存函数为 $S(x|\\mathcal{H}_t) = \\mathbb{P}\\{\\tau > x \\mid \\mathcal{H}_t\\}$。事件 $\\{\\tau > x\\}$ 等价于在区间 $(t, t+x]$ 内没有观察到脉冲的事件。\n\n在 $t$ 之后的持续时间 $x'$ 处的等待时间 $\\tau$ 的风险函数定义为 $h(x') = \\lim_{\\Delta x \\to 0} \\frac{\\mathbb{P}\\{x' \\le \\tau  x'+\\Delta x | \\tau \\ge x', \\mathcal{H}_t\\}}{\\Delta x}$。条件 $\\{\\tau \\ge x'\\}$ 意味着在 $(t, t+x']$ 内没有脉冲发生，因此在时间 $t+x'$ 可用的历史是 $\\mathcal{H}_{t+x'}$。在 $[t+x', t+x'+\\Delta x)$ 内发生脉冲的概率由条件强度的基本性质给出：$\\mathbb{P}\\{N(t+x'+\\Delta x)-N(t+x')=1 \\mid \\mathcal{H}_{t+x'}\\} = \\lambda(t+x')\\Delta x + o(\\Delta x)$。因此，风险率恰好是条件强度，即 $h(x') = \\lambda(t+x')$。\n\n生存函数通过以下方式与累积风险函数相关：\n$$ S(x|\\mathcal{H}_t) = \\exp\\left(-\\int_0^x h(u) \\, du\\right) $$\n代入 $h(u) = \\lambda(t+u)$：\n$$ S(x|\\mathcal{H}_t) = \\exp\\left(-\\int_0^x \\lambda(t+u) \\, du\\right) $$\n通过变量替换 $s = t+u$，得到：\n$$ \\mathbb{P}\\{\\tau > x \\mid \\mathcal{H}_t\\} = \\exp\\left(-\\int_{t}^{t+x} \\lambda(s) \\, ds\\right) $$\n该表达式给出了从时间 $t$ 开始的事件间间隔长于 $x$ 的概率。\n\n现在，我们考虑观察到的脉冲间间隔序列，$\\tau_k = t_k - t_{k-1}$，其中 $k=1, \\dots, K$ (设 $t_0=0$)。“时间重标度变换”通过在每个区间上对条件强度进行积分来定义一组新变量：\n$$ u_k = \\int_{t_{k-1}}^{t_k} \\lambda(s) \\, ds $$\n我们希望在模型 $\\lambda(t)$ 正确的假设下，找到这些变量 $\\{u_k\\}$ 的分布。设 $T_k$ 为第 $k$ 个脉冲时间的随机变量。设 $U_k$ 为随机变量 $U_k = \\int_{t_{k-1}}^{T_k} \\lambda(s) \\, ds$。我们求其在历史 $\\mathcal{H}_{t_{k-1}}$ 条件下的分布。对于某个 $y > 0$，$U_k$ 的生存函数是 $\\mathbb{P}\\{U_k > y \\mid \\mathcal{H}_{t_{k-1}}\\}$。\n\n定义函数 $g(t') = \\int_{t_{k-1}}^{t'} \\lambda(s) \\, ds$。由于 $\\lambda(s) \\ge 0$，$g(t')$ 是非递减的。假设 $\\lambda(s)$ 不恒为零，则 $g(t')$ 是严格递增且可逆的。令 $g^{-1}$ 表示其反函数。\n不等式 $U_k > y$ 等价于 $g(T_k) > y$，这意味着 $T_k > g^{-1}(y)$。因此：\n$$ \\mathbb{P}\\{U_k > y \\mid \\mathcal{H}_{t_{k-1}}\\} = \\mathbb{P}\\{T_k > g^{-1}(y) \\mid \\mathcal{H}_{t_{k-1}}\\} = \\mathbb{P}\\{T_k - t_{k-1} > g^{-1}(y) - t_{k-1} \\mid \\mathcal{H}_{t_{k-1}}\\} $$\n使用从 $t_{k-1}$ 开始、持续时间为 $x = g^{-1}(y) - t_{k-1}$ 的事件间间隔的生存函数：\n$$ \\mathbb{P}\\{U_k > y \\mid \\mathcal{H}_{t_{k-1}}\\} = \\exp\\left(-\\int_{t_{k-1}}^{t_{k-1}+x} \\lambda(s) \\, ds\\right) = \\exp\\left(-\\int_{t_{k-1}}^{g^{-1}(y)} \\lambda(s) \\, ds\\right) $$\n根据 $g(t')$ 的定义，该积分为 $g(g^{-1}(y)) = y$。因此：\n$$ \\mathbb{P}\\{U_k > y \\mid \\mathcal{H}_{t_{k-1}}\\} = e^{-y} $$\n这是速率参数为1的标准指数分布（即 $\\mathrm{Exponential}(1)$）的生存函数。由于这个条件分布不依赖于历史 $\\mathcal{H}_{t_{k-1}}$ 的具体实现，随机变量 $\\{U_k\\}$ 是独立同分布 (i.i.d.) 的。\n\n这个结果被称为时间重标度定理，是模型评估的基础。如果模型 $\\lambda(t)$ 正确地捕捉了过程的动态，变换后的脉冲间间隔 $\\{u_k\\}$ 将形成一个来自 $\\mathrm{Exponential}(1)$ 分布的独立同分布序列。\n\n### 拟合优度检验\n\n为了检验观察到的序列 $\\{u_k\\}_{k=1}^K$ 是否与此理论结果一致，可以使用拟合优度检验，例如柯尔莫哥洛夫-斯米尔诺夫 (KS) 检验。通常先将数据变换到均匀分布会很方便。如果一个随机变量 $U$ 服从一个累积分布函数为 $F_U$ 的连续分布，那么变换后的变量 $Z = F_U(U)$ 在 $(0, 1)$ 上均匀分布。\n对于 $U \\sim \\mathrm{Exponential}(1)$，其累积分布函数为 $F(u) = 1 - e^{-u}$ (当 $u \\ge 0$)。因此，我们定义一个新序列：\n$$ z_k = 1 - e^{-u_k} = 1 - \\exp\\left(-\\int_{t_{k-1}}^{t_k} \\lambda(s) \\, ds\\right) $$\n如果模型正确，$\\{z_k\\}$ 将是一个来自 $\\mathrm{Uniform}(0,1)$ 分布的独立同分布序列。KS 检验随后将样本 $\\{z_k\\}$ 的经验累积分布函数 (ECDF)，记为 $\\hat{F}(z)$，与 $\\mathrm{Uniform}(0,1)$ 分布的累积分布函数 $F(z)=z$ 进行比较。\n\n经验累积分布函数与对角线 $y=z$ 的系统性偏差表明模型设定有误。如果经验累积分布函数系统性地位于对角线上方，这意味着存在过多的较小 $z_k$ 值。较小的 $z_k$ 值对应较小的 $u_k$ 值。$u_k = \\int_{t_{k-1}}^{t_k} \\lambda(s) \\, ds$ 的值系统性地偏小，表明建模的强度 $\\lambda(s)$ 平均而言过低（低估），因为它在观察到的脉冲间间隔内未能累积到期望值1。相反，如果经验累积分布函数位于对角线下方，则意味着建模的强度 $\\lambda(s)$ 过高（高估）。\n\n### 陈述评估\n\n**A. 根据条件强度的定义，给定 $\\mathcal{H}_{t}$ 时，下一个事件间时间 $\\tau$ 的生存概率为 $\\mathbb{P}\\{\\tau>x\\mid\\mathcal{H}_{t}\\}=\\exp\\!\\left(-\\int_{t}^{t+x}\\lambda(s)\\,ds\\right)$。因此，连续事件间间隔的经典时间重标度变换为 $u_{k}=\\int_{t_{k-1}}^{t_{k}}\\lambda(s)\\,ds$，并且在一个设定正确的模型中，序列 $\\{u_{k}\\}_{k=1}^{K}$ 是独立同分布于参数为1的指数分布 ($\\mathrm{Exponential}(1)$)。**\n\n该陈述与上述推导完全一致。生存概率的公式是正确的。重标度时间 $u_k$ 的定义是正确的。在一个设定正确的模型下，序列 $\\{u_k\\}$ 呈独立同分布的 $\\mathrm{Exponential}(1)$ 分布，这是时间重标度定理的核心结论。\n**结论：正确。**\n\n**B. 为执行柯尔莫哥洛夫-斯米尔诺夫 (KS) 检验，通过 $z_{k}=1-\\exp(-u_{k})$ 变换 $u_{k}$，使得在正确模型下 $\\{z_{k}\\}$ 独立同分布于 $\\mathrm{Uniform}(0,1)$；然后将经验累积分布函数与 $F(z)=z$ 进行比较。系统性偏差（例如，对于小的 $z$，经验曲线在对角线上方）平均而言表明强度被低估，而偏差在对角线下方则表明强度被高估。**\n\n该陈述正确地描述了将 KS 检验应用于重标度间隔的标准流程。变换 $z_{k}=1-\\exp(-u_{k})$ 是对 $\\mathrm{Exponential}(1)$ 变量的概率积分变换，正确地得出了一个 $\\mathrm{Uniform}(0,1)$ 变量。KS 检验的步骤描述准确。对偏差的诊断性解释也是正确的：如前一节所述，经验累积分布函数在对角线上方意味着小值过多，这对应于对条件强度的低估。\n**结论：正确。**\n\n**C. 因为 Hawkes 过程是自激励的，所以即使在设定正确的模型下，变换后的变量 $\\{u_{k}\\}$ 仍然保持正自相关；因此，对 $\\{u_{k}\\}$ 进行的 KS 检验是无效的，除非首先对脉冲序列进行稀疏化以减少丛集放电。**\n\n该陈述从根本上误解了时间重标度变换的目的。一个设定正确的 Hawkes 过程模型在 $\\lambda(t)$ 的定义中明确包含了自激励（以及任何其他依赖于历史的）成分。变换 $u_k = \\int_{t_{k-1}}^{t_k} \\lambda(s) \\, ds$ 的全部意义就在于解释并消除所有此类时间依赖性。如果模型是正确的，得到的 $\\{u_k\\}$ 序列必须是独立同分布的，意味着它没有自相关。$\\{u_k\\}$ 中持续存在的自相关是模型设定错误的标志，而不是其固有属性。KS 检验之所以有效，正是因为该变换应产生独立同分布的变量。\n**结论：错误。**\n\n**D. 只需计算 $u_{k}=\\int_{t_{k-1}}^{t_{k}}\\lambda(s)\\,ds$，然后直接对其与 $\\mathrm{Uniform}(0,1)$ 分布进行柯尔莫哥洛夫-斯米尔诺夫检验，因为在正确设定下 $\\{u_{k}\\}$ 是均匀分布的。**\n\n该陈述错误地指出了重标度时间 $\\{u_k\\}$ 的分布。如推导所示，$\\{u_k\\}$ 服从 $\\mathrm{Exponential}(1)$ 分布，而非 $\\mathrm{Uniform}(0,1)$ 分布。我们可以对 $\\{u_k\\}$ 应用 KS 检验，检验其是否符合 $\\mathrm{Exponential}(1)$ 的累积分布函数 $F(u)=1-e^{-u}$，但不能检验其是否符合 $\\mathrm{Uniform}(0,1)$ 的累积分布函数。该陈述混淆了重标度时间 $u_k$ 与经过概率积分变换后的值 $z_k$。\n**结论：错误。**\n\n**E. 在有限的记录窗口 $[0,T]$ 中，为避免偏差，必须通过将 $z_{K+1}=1-\\exp\\!\\left(-\\int_{t_{K}}^{T}\\lambda(s)\\,ds\\right)$ 添加到 KS 检验样本中，以包含右删失的最终区间，从而使所有观察到的时间跨度都有贡献。**\n\n该陈述提出了一种处理来自最终区间 $(t_K, T]$ 的右删失数据的错误方法。量 $u_{K+1}^* = \\int_{t_K}^T \\lambda(s)ds$ 并不是一个来自 $\\mathrm{Exponential}(1)$ 分布的实现值；它是下一个重标度间隔的下界，因为我们只知道下一个脉冲发生在时间 $T$ 之后。将这个删失值当作一个完整观测值进行变换，并将其加入样本中以进行标准的 KS 检验，在统计上是无效的。它将一个删失数据点与完整数据点混合在一起，违反了检验的假设。正确处理删失数据需要对检验本身进行修改（例如，使用基于 Kaplan-Meier 的经验累积分布函数），而不是对样本进行这种临时的调整。\n**结论：错误。**",
            "answer": "$$\\boxed{AB}$$"
        }
    ]
}