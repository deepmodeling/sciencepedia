{
    "hands_on_practices": [
        {
            "introduction": "A fundamental question in neuroscience is how a neuron transitions from a quiescent resting state to a repetitively firing state as its input drive increases. Phase-plane analysis reveals that this transition often occurs at a specific type of bifurcation. This exercise guides you through the analytical calculation of a Saddle-Node on Invariant Circle (SNIC) bifurcation, which marks the birth of an oscillatory solution and the onset of tonic spiking. By finding the precise value of the input current $I$ where the system's nullclines become tangent, you will gain a concrete understanding of how the geometric structure of the phase plane governs a neuron's computational capabilities .",
            "id": "4009575",
            "problem": "Consider the dimensionless FitzHugh–Nagumo (FHN) model of excitability used in computational neuroscience, given by the planar system\n$$\n\\frac{dv}{dt} = f(v,w;I) = v - \\frac{v^{3}}{3} - w + I,\\qquad\n\\frac{dw}{dt} = g(v,w) = \\epsilon\\,(v + a - b\\,w),\n$$\nwhere $v$ is the fast membrane potential variable, $w$ is the slow recovery variable, $I$ is a constant external drive (dimensionless current), and $\\epsilon$, $a$, $b$ are positive constants. The $v$-nullcline is the cubic $f(v,w;I) = 0$ and the $w$-nullcline is the straight line $g(v,w) = 0$.\n\nA Saddle-Node on Invariant Circle (SNIC) bifurcation occurs in this model when the two nullclines are tangent at a common equilibrium with collinear gradients of $f$ and $g$ at the intersection point, under a slow-fast separation ($\\epsilon \\ll 1$). Using the foundational definitions of nullclines, the Jacobian of a planar system, and the generic saddle-node tangency criterion expressed in terms of gradients, determine the unique value of the drive $I$ at which the SNIC occurs for the parameter set\n$$\n\\epsilon = 0.08,\\quad a = 0.7,\\quad b = 2,\n$$\nwith the tangency realized on the left branch of the cubic $v$-nullcline (i.e., at a point with $v  0$ where the cubic’s local curvature is positive). Express your final answer as a single closed-form analytic expression for $I$. No rounding is required, and no physical units should be used since the variables and parameters are dimensionless.",
            "solution": "The problem requires finding the value of the external drive $I$ for which the FitzHugh-Nagumo (FHN) model exhibits a Saddle-Node on Invariant Circle (SNIC) bifurcation for a given set of parameters. The FHN model is described by the following system of differential equations:\n$$\n\\frac{dv}{dt} = f(v,w;I) = v - \\frac{v^{3}}{3} - w + I\n$$\n$$\n\\frac{dw}{dt} = g(v,w) = \\epsilon\\,(v + a - b\\,w)\n$$\nThe parameters are given as $\\epsilon = 0.08$, $a = 0.7$, and $b = 2$.\n\nA SNIC bifurcation occurs at an equilibrium point where the system's nullclines are tangent. An equilibrium point $(v_*, w_*)$ is a point where both derivatives are zero, i.e., $f(v_*, w_*; I) = 0$ and $g(v_*, w_*) = 0$. These two conditions define the $v$-nullcline and the $w$-nullcline, respectively.\n\nFirst, we write the equations for the nullclines by setting the derivatives to zero.\nThe $v$-nullcline is given by $f(v,w;I)=0$:\n$$\nv - \\frac{v^{3}}{3} - w + I = 0 \\implies w = v - \\frac{v^{3}}{3} + I\n$$\nThis is a cubic curve in the $v$-$w$ phase plane.\n\nThe $w$-nullcline is given by $g(v,w)=0$:\n$$\n\\epsilon\\,(v + a - b\\,w) = 0\n$$\nSince $\\epsilon  0$, this simplifies to:\n$$\nv + a - b\\,w = 0 \\implies w = \\frac{v+a}{b}\n$$\nThis is a straight line in the $v$-$w$ phase plane.\n\nThe SNIC bifurcation occurs when these two nullclines are tangent at an equilibrium point $(v_*, w_*)$. At the point of tangency, the slopes of the two nullcline curves, viewed as functions of $v$, must be equal.\n\nThe slope of the $v$-nullcline is found by differentiating its equation with respect to $v$:\n$$\n\\frac{dw}{dv} = \\frac{d}{dv} \\left( v - \\frac{v^{3}}{3} + I \\right) = 1 - v^{2}\n$$\nThe slope of the $w$-nullcline is found similarly:\n$$\n\\frac{dw}{dv} = \\frac{d}{dv} \\left( \\frac{v+a}{b} \\right) = \\frac{1}{b}\n$$\nAt the tangency point $v=v_*$, the slopes must be equal:\n$$\n1 - v_*^{2} = \\frac{1}{b}\n$$\nWe can solve this equation for $v_*$. Rearranging gives:\n$$\nv_*^{2} = 1 - \\frac{1}{b}\n$$\n$$\nv_* = \\pm \\sqrt{1 - \\frac{1}{b}}\n$$\nThe problem specifies that the tangency occurs on the left branch of the cubic $v$-nullcline, which corresponds to $v  0$. Therefore, we must select the negative root:\n$$\nv_* = - \\sqrt{1 - \\frac{1}{b}}\n$$\nSubstituting the given parameter $b=2$:\n$$\nv_* = - \\sqrt{1 - \\frac{1}{2}} = - \\sqrt{\\frac{1}{2}} = -\\frac{1}{\\sqrt{2}}\n$$\nAt the equilibrium point $(v_*, w_*)$, both nullcline equations must be satisfied simultaneously:\n1. $w_* = v_* - \\frac{v_*^{3}}{3} + I$\n2. $w_* = \\frac{v_*+a}{b}$\n\nWe can find the required value of $I$ by equating these two expressions for $w_*$:\n$$\n\\frac{v_*+a}{b} = v_* - \\frac{v_*^{3}}{3} + I\n$$\nSolving for $I$:\n$$\nI = \\frac{v_*+a}{b} - v_* + \\frac{v_*^{3}}{3}\n$$\nThis can be simplified by regrouping terms involving $v_*$:\n$$\nI = v_* \\left(\\frac{1}{b} - 1\\right) + \\frac{v_*^{3}}{3} + \\frac{a}{b}\n$$\nFrom our tangency condition, we know that $\\frac{1}{b} - 1 = -v_*^2$. Substituting this into the expression for $I$:\n$$\nI = v_*(-v_*^2) + \\frac{v_*^{3}}{3} + \\frac{a}{b} = -v_*^{3} + \\frac{v_*^{3}}{3} + \\frac{a}{b}\n$$\n$$\nI = -\\frac{2}{3}v_*^{3} + \\frac{a}{b}\n$$\nThis is a general expression for the current $I$ at the SNIC bifurcation point in terms of the voltage $v_*$ and parameters $a$ and $b$.\n\nNow, we substitute the specific values. We have $a = 0.7$, $b = 2$, and we found $v_* = -1/\\sqrt{2}$. First, we compute $v_*^3$:\n$$\nv_*^{3} = \\left(-\\frac{1}{\\sqrt{2}}\\right)^{3} = -\\frac{1}{(\\sqrt{2})^3} = -\\frac{1}{2\\sqrt{2}} = -\\frac{\\sqrt{2}}{4}\n$$\nNow, substitute these values into the expression for $I$:\n$$\nI = -\\frac{2}{3}\\left(-\\frac{\\sqrt{2}}{4}\\right) + \\frac{0.7}{2}\n$$\n$$\nI = \\frac{2\\sqrt{2}}{12} + 0.35 = \\frac{\\sqrt{2}}{6} + \\frac{7}{20}\n$$\nTo express this as a single fraction, we find a common denominator, which is $60$:\n$$\nI = \\frac{10\\sqrt{2}}{60} + \\frac{21}{60} = \\frac{21 + 10\\sqrt{2}}{60}\n$$\nThis is the unique, closed-form analytic expression for the drive $I$ at which the SNIC bifurcation occurs under the specified conditions. Note that the value of $\\epsilon=0.08$ is consistent with the slow-fast separation assumption underlying SNIC bifurcations but is not needed for the calculation of the tangency point itself.",
            "answer": "$$\n\\boxed{\\frac{21 + 10\\sqrt{2}}{60}}\n$$"
        },
        {
            "introduction": "Excitable cells like neurons exhibit an \"all-or-none\" spiking threshold; a stimulus is either too weak and decays, or it is strong enough to trigger a full action potential. This threshold is not a simple voltage value but a dynamic boundary in the phase plane known as a separatrix. In many models, this separatrix is formed by the unstable manifold of a saddle-type fixed point. This computational practice will have you locate this critical saddle point and then trace its unstable manifold, numerically demonstrating how this geometric structure cleanly divides the phase space into regions of sub-threshold and supra-threshold dynamics .",
            "id": "4009653",
            "problem": "You are given a two-dimensional deterministic dynamical system that models a reduced excitable neuron in the phase plane, inspired by the FitzHugh–Nagumo reduction of the Hodgkin–Huxley model. The state variables are the membrane potential $v$ and a slow recovery variable $w$, and the dynamics are defined by\n$$\n\\frac{dv}{dt} = f(v,w) = v - \\frac{v^3}{3} - w + I, \\quad \\frac{dw}{dt} = g(v,w) = \\varepsilon\\,(v + a - b\\,w),\n$$\nwhere $I$ is an external current, $\\varepsilon$ is a small positive constant setting the slow timescale of $w$, $a$ is a bias parameter, and $b$ is a coupling parameter. The phase-plane analysis of this system involves the $v$-nullcline $f(v,w) = 0$ and the $w$-nullcline $g(v,w) = 0$. The $v$-nullcline is a cubic curve in $(v,w)$, and the central “middle branch” corresponds to the portion with $|v|  1$.\n\nStarting from the following foundational definitions and facts:\n- A fixed point $(v^\\ast, w^\\ast)$ satisfies $f(v^\\ast,w^\\ast) = 0$ and $g(v^\\ast,w^\\ast) = 0$ by definition.\n- The Jacobian matrix of the system evaluated at a fixed point is\n$$\nJ(v^\\ast,w^\\ast) = \n\\begin{bmatrix}\n\\frac{\\partial f}{\\partial v}(v^\\ast,w^\\ast)  \\frac{\\partial f}{\\partial w}(v^\\ast,w^\\ast) \\\\\n\\frac{\\partial g}{\\partial v}(v^\\ast,w^\\ast)  \\frac{\\partial g}{\\partial w}(v^\\ast,w^\\ast)\n\\end{bmatrix},\n$$\nwith entries computed from the given $f$ and $g$.\n- In two dimensions, a fixed point is a saddle if and only if $\\det(J(v^\\ast,w^\\ast))  0$, which implies one eigenvalue with positive real part and one with negative real part.\n- The unstable manifold of a saddle is tangent at $(v^\\ast,w^\\ast)$ to the eigenvector of $J(v^\\ast,w^\\ast)$ associated with the eigenvalue whose real part is positive. Integrating the flow forward in time from initial conditions slightly displaced along this eigenvector generates the unstable manifold branches.\n\nYour tasks are:\n1. For each parameter set in the test suite below, locate the fixed point $(v^\\ast, w^\\ast)$ that lies on the middle branch of the cubic $v$-nullcline (select the real solution with $|v^\\ast|$ minimized; if multiple real solutions satisfy $|v^\\ast|  1$, choose the one with the smallest $|v^\\ast|$).\n2. Compute the Jacobian matrix $J(v^\\ast,w^\\ast)$ and decide whether the fixed point is a saddle by evaluating the sign of $\\det(J(v^\\ast,w^\\ast))$.\n3. If the fixed point is a saddle, compute the unstable eigenvector (associated with the eigenvalue of $J$ with the largest real part) and its angle $\\theta$ in radians measured from the positive $v$-axis via $\\theta = \\operatorname{atan2}(e_w,e_v)$, where $(e_v,e_w)$ are the components of the unstable eigenvector. If the largest real part is not positive, report $\\theta$ from that eigenvector but denote that no unstable manifold exists for spiking tests.\n4. Initialize two nearby points on the unstable manifold branches as $(v^\\ast, w^\\ast) \\pm \\delta\\,\\mathbf{e}$, where $\\mathbf{e}$ is the unstable eigenvector normalized to unit length and $\\delta = 10^{-3}$. Integrate the system forward in dimensionless time to $T = 200$ using a numerical ordinary differential equation solver. Define a spike detection criterion by threshold crossing $v(t) \\geq v_{\\mathrm{spike}}$, with $v_{\\mathrm{spike}} = 1.2$. Record, for each branch, whether the event $v(t)$ crosses $v_{\\mathrm{spike}}$ for the first time with an increasing $v(t)$.\n5. Report, for each parameter set, the tuple $[v^\\ast, w^\\ast, \\theta, \\text{spike\\_plus}, \\text{spike\\_minus}, \\text{is\\_middle\\_branch}, \\text{is\\_saddle}]$, where:\n   - $v^\\ast$ and $w^\\ast$ are floats,\n   - $\\theta$ is a float (angle in radians),\n   - $\\text{spike\\_plus}$ and $\\text{spike\\_minus}$ are booleans for the $+\\delta$ and $-\\delta$ unstable branches,\n   - $\\text{is\\_middle\\_branch}$ is a boolean indicating whether $|v^\\ast|  1$,\n   - $\\text{is\\_saddle}$ is a boolean indicating $\\det(J(v^\\ast,w^\\ast))  0$.\n\nUse only dimensionless quantities; no physical units are required. Angles must be reported in radians.\n\nTest suite (each entry is $(\\varepsilon, a, b, I)$):\n- Case 1 (typical excitable/spiking with saddle on middle branch): $(0.08, 0.7, 3.0, 0.5)$.\n- Case 2 (boundary, non-hyperbolic fixed point): $(0.08, 0.0, 1.0, 0.0)$.\n- Case 3 (no saddle, determinant positive): $(0.08, 0.7, 0.2, 0.1)$.\n\nYour program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets. The format must be\n$$\n[ [v^\\ast_1,w^\\ast_1,\\theta_1,\\text{spike\\_plus}_1,\\text{spike\\_minus}_1,\\text{is\\_middle\\_branch}_1,\\text{is\\_saddle}_1], [v^\\ast_2,w^\\ast_2,\\theta_2,\\text{spike\\_plus}_2,\\text{spike\\_minus}_2,\\text{is\\_middle\\_branch}_2,\\text{is\\_saddle}_2], [v^\\ast_3,w^\\ast_3,\\theta_3,\\text{spike\\_plus}_3,\\text{spike\\_minus}_3,\\text{is\\_middle\\_branch}_3,\\text{is\\_saddle}_3] ]\n$$\nwith booleans rendered as Python literals and numbers in standard decimal form.",
            "solution": "The user has provided a problem from the field of computational neuroscience, requiring a phase-plane analysis of a simplified excitable neuron model akin to the FitzHugh-Nagumo system. The problem is well-defined, scientifically sound, and all necessary parameters and procedures are specified. The tasks involve finding a fixed point, analyzing its stability, determining the direction of its unstable manifold (if any), and simulating the system's trajectories to check for spiking behavior.\n\nThe dynamical system is given by the ordinary differential equations (ODEs):\n$$\n\\frac{dv}{dt} = f(v,w) = v - \\frac{v^3}{3} - w + I\n$$\n$$\n\\frac{dw}{dt} = g(v,w) = \\varepsilon (v + a - bw)\n$$\n\nThe solution process will be executed for each parameter set $(\\varepsilon, a, b, I)$ provided in the test suite.\n\n**Step 1: Locating the Fixed Point**\n\nA fixed point $(v^\\ast, w^\\ast)$ of the system is a state where the dynamics cease, i.e., $\\frac{dv}{dt} = 0$ and $\\frac{dw}{dt} = 0$. This provides a system of two algebraic equations:\n1. From the $v$-nullcline, $f(v^\\ast, w^\\ast) = 0$: $v^\\ast - \\frac{(v^\\ast)^3}{3} - w^\\ast + I = 0 \\implies w^\\ast = v^\\ast - \\frac{(v^\\ast)^3}{3} + I$.\n2. From the $w$-nullcline, $g(v^\\ast, w^\\ast) = 0$: Since $\\varepsilon  0$, this simplifies to $v^\\ast + a - bw^\\ast = 0$.\n\nBy substituting the expression for $w^\\ast$ from the $v$-nullcline into the $w$-nullcline equation, we obtain a single equation for $v^\\ast$:\n$$\nv^\\ast + a - b\\left(v^\\ast - \\frac{(v^\\ast)^3}{3} + I\\right) = 0\n$$\nRearranging this gives a cubic polynomial equation in $v^\\ast$:\n$$\n\\frac{b}{3}(v^\\ast)^3 + (1-b)v^\\ast + (a-bI) = 0\n$$\nThe roots of this cubic polynomial determine the $v$-coordinates of the fixed points. We will solve this equation numerically to find all its roots (real and complex). We then filter for the real roots by selecting those with an imaginary part whose magnitude is smaller than a small tolerance (e.g., $10^{-9}$). According to the problem statement, from the set of real roots, we must select the one, denoted $v^\\ast$, that has the minimum absolute value.\n\nOnce $v^\\ast$ is found, the corresponding $w$-coordinate, $w^\\ast$, is calculated from the linear $w$-nullcline equation: $w^\\ast = \\frac{v^\\ast + a}{b}$ (assuming $b \\neq 0$, which is true for all test cases). The boolean flag `is_middle_branch` is then determined by the condition $|v^\\ast|  1$.\n\n**Step 2: Stability Analysis via the Jacobian Matrix**\n\nThe stability of the fixed point $(v^\\ast, w^\\ast)$ is determined by the eigenvalues of the Jacobian matrix $J$ evaluated at that point. The partial derivatives are:\n$$\n\\frac{\\partial f}{\\partial v} = 1 - v^2, \\quad \\frac{\\partial f}{\\partial w} = -1\n$$\n$$\n\\frac{\\partial g}{\\partial v} = \\varepsilon, \\quad \\frac{\\partial g}{\\partial w} = -\\varepsilon b\n$$\nThe Jacobian matrix at $(v^\\ast, w^\\ast)$ is therefore:\n$$\nJ(v^\\ast,w^\\ast) =\n\\begin{bmatrix}\n1 - (v^\\ast)^2  -1 \\\\\n\\varepsilon  -\\varepsilon b\n\\end{bmatrix}\n$$\nA fixed point is a saddle if its Jacobian has a determinant less than zero, i.e., $\\det(J)  0$. This implies the eigenvalues are real and have opposite signs, one positive (unstable direction) and one negative (stable direction). We will compute $\\det(J) = (1-(v^\\ast)^2)(-\\varepsilon b) - (-1)(\\varepsilon) = \\varepsilon [1 - b(1-(v^\\ast)^2)]$ and set the boolean flag `is_saddle` accordingly.\n\n**Step 3: Unstable Eigenvector and Angle**\n\nThe unstable manifold of a saddle point is tangent to the eigenvector associated with the positive eigenvalue. More generally, the problem asks for the eigenvector associated with the eigenvalue having the largest real part. We compute the eigenvalues and eigenvectors of $J(v^\\ast, w^\\ast)$ numerically.\n\nLet $(\\lambda_1, \\lambda_2)$ be the eigenvalues and $(\\mathbf{e}_1, \\mathbf{e}_2)$ be the corresponding eigenvectors. We identify the eigenvalue with the largest real part, say $\\lambda_k$, and its corresponding eigenvector $\\mathbf{e}_k = (e_v, e_w)$.\nThe angle $\\theta$ of this eigenvector relative to the positive $v$-axis is calculated as $\\theta = \\operatorname{atan2}(e_w, e_v)$.\n\nA point of clarification is needed for cases where the eigenvalues are a complex conjugate pair (e.g., an unstable spiral/focus). In such cases, the eigenvectors are also complex. The problem asks for an angle $\\theta$, which implies a real-valued vector. A reasonable interpretation, which will be adopted here, is to use the real part of the complex eigenvector to define the direction for analysis. If $\\mathbf{e}_k = \\mathbf{e}_{\\text{real}} + i \\mathbf{e}_{\\text{imag}}$, we will use the components of $\\mathbf{e}_{\\text{real}}$ to compute $\\theta$.\n\n**Step 4: Numerical Integration and Spike Detection**\n\nTo determine if trajectories starting near the fixed point generate a spike, we perform numerical integration of the ODE system. We define two initial conditions perturbed from the fixed point along the direction of the \"unstable\" eigenvector $\\mathbf{e}$:\n$$\n\\mathbf{y}_{0, \\text{plus}} = (v^\\ast, w^\\ast) + \\delta \\hat{\\mathbf{e}}\n$$\n$$\n\\mathbf{y}_{0, \\text{minus}} = (v^\\ast, w^\\ast) - \\delta \\hat{\\mathbf{e}}\n$$\nwhere $\\hat{\\mathbf{e}}$ is the normalized (unit length) eigenvector direction vector (real part, as discussed), and $\\delta = 10^{-3}$ is the perturbation magnitude.\n\nWe will use the `solve_ivp` function from the `scipy.integrate` library to integrate the system from $t=0$ to $T=200$ for both initial conditions. Spike detection is implemented using the event handling feature of `solve_ivp`. A spike is defined as the event where the trajectory crosses the threshold $v(t) = v_{\\text{spike}} = 1.2$ with a positive velocity ($dv/dt  0$). The event function is $v(t) - 1.2$, and we look for a crossing in the increasing direction. If the event is detected for the `plus` branch, `spike_plus` is `True`; otherwise, it's `False`. The same logic applies to the `minus` branch for `spike_minus`.\n\n**Step 5: Assembling the Final Report**\n\nFor each parameter set, the calculated values—$v^\\ast$, $w^\\ast$, $\\theta$, `spike_plus`, `spike_minus`, `is_middle_branch`, and `is_saddle`—are collected into a list. The final output is a list containing these result lists for all test cases, formatted as specified.",
            "answer": "[[-0.4285376175150824,0.09048746082830588,2.944203135914616,True,False,True,True],[-0.0,0.0,-0.07968310344403167,True,True,True,False],[-0.8353396131495912,-0.676698065747956,-1.3392478440183112,True,True,True,False]]"
        },
        {
            "introduction": "Once a neuron is driven into a repetitive firing regime, a key characteristic is its firing frequency, or the period of its oscillation. For systems exhibiting slow-fast dynamics, such as the FitzHugh-Nagumo model, the oscillation period is dominated by the time spent slowly traversing the stable branches of the fast nullcline. This exercise provides a powerful semi-analytical method to estimate this period. By deriving and numerically integrating the equation for slow passage time, you will deconstruct the relaxation oscillation and calculate its period, linking the geometric shape of the nullclines directly to the temporal dynamics of neural firing .",
            "id": "4009602",
            "problem": "Consider the planar slow-fast neuronal model, a dimensionless form of the FitzHugh–Nagumo system, defined by the ordinary differential equations (ODE) for a membrane voltage variable $V$ and a recovery variable $w$:\n$$\n\\frac{dV}{dt} = f(V,w) = V - \\frac{V^3}{3} - w + I,\n$$\n$$\n\\frac{dw}{dt} = g(V,w) = \\epsilon \\left(V + a - b\\,w\\right),\n$$\nwhere $I$, $a$, $b$, and $\\epsilon$ are parameters with $0  \\epsilon \\ll 1$. The $V$-nullcline is the set of points where $\\frac{dV}{dt} = 0$, i.e., $f(V,w) = 0$, which yields the algebraic relation\n$$\nw = W(V; I) = V - \\frac{V^3}{3} + I.\n$$\nAssume the system is in a relaxation oscillation regime where the trajectory alternates between slow evolution along attracting branches of the $V$-nullcline and fast jumps between branches. For the fast subsystem with $w$ treated as a parameter, the attracting branches of the $V$-nullcline occur where $\\frac{\\partial f}{\\partial V} = 1 - V^2  0$, i.e., for $V  -1$ (left attracting branch) and $V  1$ (right attracting branch). The fold (knee) points are at $V = -1$ and $V = 1$.\n\nUnder the approximation that fast jumps conserve $w$ and occur instantaneously up to specified small durations, the landing points on the opposite attracting branches are determined by solving $W(V; I) = \\text{constant}$ set by the $w$-value at the knee. For the cubic $W(V; I)$ above, the singular fast jumps connect $V = -1$ to $V = 2$ and $V = 1$ to $V = -2$. Therefore, in one oscillation cycle, the slow evolution occurs along:\n- the left attracting branch from $V = -2$ to $V = -1$,\n- the right attracting branch from $V = 2$ to $V = 1$.\n\nYour task is to estimate the oscillation period $T$ by summing the slow passage times along these two attracting branches and the specified fast jump durations. You must start from fundamental definitions and laws (chain rule, nullcline constraint, and projection of slow dynamics along invariant manifolds) and derive the numerical procedure to evaluate the slow passage time integrals along each branch. You must not assume or use any pre-given shortcut formulas. Use numerical quadrature to evaluate the required integrals in terms of $V$ and $W(V; I)$, and add the given fast jump times to obtain $T$ for each parameter set.\n\nImplement a program that, for each parameter set, computes:\n- the time spent on the left branch from $V = -2$ to $V = -1$,\n- the time spent on the right branch from $V = 2$ to $V = 1$,\n- the sum of the two specified fast jump durations,\nand returns the total period $T$ as a float.\n\nYour program must produce a single line of output containing the results as a comma-separated list of floats rounded to six decimal places and enclosed in square brackets (e.g., \"[$t_1$, $t_2$, $t_3$]\").\n\nUse the following test suite, expressed as tuples $(\\epsilon, a, b, I, \\tau_1, \\tau_2)$, where $\\tau_1$ and $\\tau_2$ are the durations of the two fast jumps (in the same dimensionless time units as $t$):\n\n- Test case $1$ (general case): $(0.05, 0.7, 0.8, 0.5, 0.0, 0.0)$.\n- Test case $2$ (smaller $\\epsilon$ boundary): $(0.01, 0.7, 0.8, 0.5, 0.0, 0.0)$.\n- Test case $3$ (no coupling in $w$-equation, nonzero jump times): $(0.05, 0.7, 0.0, 0.5, 0.005, 0.005)$.\n- Test case $4$ (negative $a$, moderate $b$): $(0.03, -0.2, 0.5, 0.3, 0.01, 0.02)$.\n- Test case $5$ (very small $\\epsilon$, stronger $b$): $(0.005, 0.2, 1.0, 0.0, 0.0, 0.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$result_1$, $result_2$, $result_3$, $result_4$, $result_5$]\"), where each $result_i$ is the estimated period $T$ for the corresponding test case, rounded to six decimal places. No other output is permitted.",
            "solution": "The problem is valid. It is a well-posed problem in computational neuroscience and dynamical systems, based on the established FitzHugh–Nagumo model. The parameters and conditions provided are complete, consistent, and scientifically sound.\n\nThe objective is to estimate the period, $T$, of a relaxation oscillation in a slow-fast planar system. The total period is the sum of the time spent evolving along two slow branches of the $V$-nullcline and the durations of two fast jumps.\n$$\nT = T_{\\text{left}} + T_{\\text{right}} + \\tau_{\\text{jumps}}\n$$\nwhere $T_{\\text{left}}$ is the time on the left attracting branch, $T_{\\text{right}}$ is the time on the right attracting branch, and $\\tau_{\\text{jumps}} = \\tau_1 + \\tau_2$ is the total specified duration for the fast jumps.\n\nThe core of the problem is to derive an expression for the slow passage times, $T_{\\text{left}}$ and $T_{\\text{right}}$, from fundamental principles. The system dynamics are governed by:\n$$\n\\frac{dV}{dt} = V - \\frac{V^3}{3} - w + I\n$$\n$$\n\\frac{dw}{dt} = \\epsilon \\left(V + a - b\\,w\\right)\n$$\nIn the limit where $\\epsilon$ is very small ($0  \\epsilon \\ll 1$), the system exhibits slow-fast dynamics. The variable $V$ is fast, and $w$ is slow. During the slow phases of the oscillation, the trajectory is constrained to lie on the stable branches of the $V$-nullcline, which is defined by setting $\\frac{dV}{dt} = 0$:\n$$\nw = W(V; I) = V - \\frac{V^3}{3} + I\n$$\nThis equation represents an algebraic constraint between $V$ and $w$ during slow evolution. To find the effective dynamics of $V$ along this nullcline, we can differentiate the constraint with respect to time $t$. Using the chain rule:\n$$\n\\frac{dw}{dt} = \\frac{d}{dt} \\left( V(t) - \\frac{V(t)^3}{3} + I \\right) = \\left( 1 - V^2 \\right) \\frac{dV}{dt}\n$$\nWe have a second expression for $\\frac{dw}{dt}$ from the original system equations. By equating these two expressions, we can describe the evolution of the system projected onto the slow manifold:\n$$\n\\left( 1 - V^2 \\right) \\frac{dV}{dt} = \\epsilon \\left(V + a - b\\,w\\right)\n$$\nNow, we enforce the slow-manifold constraint by substituting $w = W(V; I)$ into the right-hand side of the equation:\n$$\n\\left( 1 - V^2 \\right) \\frac{dV}{dt} = \\epsilon \\left(V + a - b\\left[V - \\frac{V^3}{3} + I\\right]\\right)\n$$\nThis yields a single ordinary differential equation for $V(t)$ valid during the slow evolution phases:\n$$\n\\frac{dV}{dt} = \\frac{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)}{1 - V^2}\n$$\nTo find the time taken for $V$ to travel from a starting value $V_{\\text{start}}$ to an ending value $V_{\\text{end}}$, we rearrange the equation to separate variables and integrate:\n$$\ndt = \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\nThe total time for a slow segment is the integral of $dt$:\n$$\nT_{\\text{slow}} = \\int_{V_{\\text{start}}}^{V_{\\text{end}}} \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\nThis general formula can now be applied to the two specific segments of the oscillation cycle described in the problem.\n\n$1$. The time on the left branch, $T_{\\text{left}}$, where the system evolves from $V = -2$ to $V = -1$:\n$$\nT_{\\text{left}} = \\int_{-2}^{-1} \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\nIn this interval, $V$ increases, so $\\frac{dV}{dt}  0$. The term $1-V^2$ is negative for $V \\in [-2, -1]$. Therefore, the polynomial in the denominator must also be negative, ensuring the integrand is positive.\n\n$2$. The time on the right branch, $T_{\\text{right}}$, where the system evolves from $V = 2$ to $V = 1$:\n$$\nT_{\\text{right}} = \\int_{2}^{1} \\frac{1 - V^2}{\\epsilon \\left( \\frac{b}{3}V^3 + (1-b)V + (a-bI) \\right)} dV\n$$\nIn this interval, $V$ decreases, so $\\frac{dV}{dt}  0$. The term $1-V^2$ is negative for $V \\in [1, 2]$. Therefore, the polynomial in the denominator must be positive. This makes the integrand negative. However, integrating from a larger limit ($V=2$) to a smaller limit ($V=1$) correctly yields a positive time duration.\n\nThese integrals do not generally have simple closed-form analytical solutions and must be evaluated using numerical quadrature. The final period $T$ for each parameter set $(\\epsilon, a, b, I, \\tau_1, \\tau_2)$ is then calculated as:\n$$\nT = T_{\\text{left}} + T_{\\text{right}} + \\tau_1 + \\tau_2\n$$\nThe numerical implementation will define a function for the integrand and use a scientific library function such as `scipy.integrate.quad` to compute the definite integrals for $T_{\\text{left}}$ and $T_{\\text{right}}$.",
            "answer": "[29.932938,149.664692,30.010000,44.974485,385.122602]"
        }
    ]
}