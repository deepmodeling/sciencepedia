{
    "hands_on_practices": [
        {
            "introduction": "理解尖峰推断的第一步是掌握正向模型——即神经元尖峰如何产生钙信号。本练习将让您亲手实践基本的一阶自回归（AR(1)）模型，观察离散的尖峰如何转化为平滑、衰减的钙信号。这为您后续解决逆问题，即从信号中推断尖峰，打下直观的基础。",
            "id": "4019639",
            "problem": "考虑一个神经元在尖峰活动下的细胞内钙离子浓度的标准生成模型，其中连续时间钙离子浓度 $C(t)$ 服从一阶线性动力学，具有指数衰减和尖峰驱动的增量。具体来说，在尖峰之间，动力学遵循线性常微分方程 (ODE) $dC(t)/dt = -C(t)/\\tau$，每个尖峰在 $C(t)$ 中产生一个幅度为 $\\alpha$ 的瞬时增量。当以固定间隔 $\\Delta t$ 采样时，此连续时间模型为采样序列 $C_t = C(t\\!=\\!t\\Delta t)$ 导出一个离散时间的一阶自回归 (AR(1)) 过程，其中 $C_t$ 的更新由样本间的指数衰减和来自尖峰的加性贡献决定。\n\n假设以下科学标准条件：\n- 采样间隔为 $\\Delta t = 1$ (任意时间单位)，因此时间索引为 $t \\in \\{0,1,2,\\dots\\}$。\n- 衰减因子为 $\\gamma = \\exp(-\\Delta t/\\tau)$，其数值为 $\\gamma = 0.95$。\n- 尖峰幅度为 $\\alpha = 1$ (每次尖峰的无量纲幅度增量)。\n- 尖峰序列 $s_t$ 是无量纲的，在尖峰时刻取值为 1，其他时候为 0。恰好有两个尖峰：一个在 $t=10$ 时，一个在 $t=20$ 时，因此 $s_{10} = 1$，$s_{20} = 1$，对于所有其他 $t$，$s_t = 0$。\n- 初始钙离子浓度为 $C_0 = 0$，并且在 $t=10$ 之前没有活动。\n\n忽略任何观测噪声、基线荧光偏移或其他测量效应，并将 $C_t$ 视为无量纲。\n\n仅使用这些前提（样本间的指数衰减和尖峰时刻的单位增量），计算 $t=10,11,\\dots,25$ 时的离散时间钙离子浓度 $C_t$，结果表示为关于 0.95 的幂的精确解析表达式。将最终答案表示为一个单行矩阵，列出 $C_{10}, C_{11}, \\dots, C_{25}$，不进行任何数值四舍五入或近似。由于 $C_t$ 是无量纲的，最终答案不需要单位。表达式中不要包含任何百分比。",
            "solution": "该问题要求基于一个生成模型计算离散时间钙离子浓度序列 $C_t$。\n\n首先，我们必须验证问题陈述的有效性。\n给定条件如下：\n- 一个连续时间钙离子浓度模型，其在尖峰之间的动力学为 $dC(t)/dt = -C(t)/\\tau$，每个尖峰产生幅度为 $\\alpha$ 的瞬时增量。\n- 一个离散时间表示 $C_t = C(t\\Delta t)$，它是一个一阶自回归 (AR(1)) 过程。\n- 采样间隔：$\\Delta t = 1$。\n- 衰减因子：$\\gamma = \\exp(-\\Delta t/\\tau) = 0.95$。\n- 尖峰幅度：$\\alpha = 1$。\n- 尖峰序列：在 $t=10$ 和 $t=20$ 时 $s_t=1$，对于所有其他非负整数时间 $t$，$s_t=0$。\n- 初始条件：$C_0 = 0$。\n- 该模型被视为精确模型，没有噪声或其他测量伪影。\n\n该问题具有科学依据，因为这个 AR(1) 模型是计算神经科学中用于尖峰推断的钙离子动力学的一个标准简化表示。它的提法是适定的，所有必需的参数、初始条件和输入都已指定，确保了唯一解的存在。语言客观而精确。该问题并非不完整、矛盾、不切实际或不适定的。因此，该问题被认为是有效的，可以推导出解答。\n\n钙离子浓度 $C_t$ 的离散时间动力学可以根据问题描述来构建。在时间步 $t$ 的值是前一个时间步 $C_{t-1}$ 的衰减值与在时间 $t$ 发生的任何尖峰的贡献之和。在一个时间步 $\\Delta t$ 内的衰减由因子 $\\gamma$ 给出。来自尖峰的贡献是幅度 $\\alpha$。因此，该 AR(1) 模型的更新规则是：\n$$C_t = \\gamma C_{t-1} + \\alpha s_t$$\n\n代入给定值 $\\gamma = 0.95$ 和 $\\alpha = 1$，方程变为：\n$$C_t = 0.95 C_{t-1} + s_t$$\n\n初始条件是 $C_0=0$。尖峰序列 $s_t$ 仅在 $t=10$ 和 $t=20$ 时非零。\n\n我们可以通过展开来求解这个线性递推关系，这揭示了其通解是尖峰序列与系统冲激响应的卷积。在时间 $t$ 的解是所有过去尖峰响应的总和，并经过适当衰减。\n对于在时间 $t_0$ 的单个尖峰，对于 $t \\ge t_0$ 的响应是 $C_t = \\alpha \\gamma^{t-t_0}$。由于系统是线性的，总响应是每个单独尖峰响应的叠加。\n给定的尖峰序列由两个尖峰组成，一个在 $t=10$，一个在 $t=20$。总钙离子浓度 $C_t$ 是这两个事件响应的总和：\n$$C_t = \\alpha \\sum_{\\text{spike times } t_i \\le t} \\gamma^{t-t_i}$$\n当 $\\alpha=1$ 且尖峰时间为 $\\{10, 20\\}$ 时，这变为：\n$$C_t = \\begin{cases} 0  \\text{for } t  10 \\\\ \\gamma^{t-10}  \\text{for } 10 \\le t  20 \\\\ \\gamma^{t-10} + \\gamma^{t-20}  \\text{for } t \\ge 20 \\end{cases}$$\n\n使用此通用形式，并代入 $\\gamma=0.95$，我们可以计算 $t=10, 11, \\dots, 25$ 所需的值。\n\n对于 $t \\in \\{10, 11, \\dots, 19\\}$：\n$C_t = (0.95)^{t-10}$。\n$C_{10} = (0.95)^{10-10} = (0.95)^0 = 1$。\n$C_{11} = (0.95)^{11-10} = (0.95)^1 = 0.95$。\n$C_{12} = (0.95)^{12-10} = (0.95)^2$。\n...\n$C_{19} = (0.95)^{19-10} = (0.95)^9$。\n\n对于 $t \\in \\{20, 21, \\dots, 25\\}$：\n$C_t = (0.95)^{t-10} + (0.95)^{t-20}$。\n$C_{20} = (0.95)^{20-10} + (0.95)^{20-20} = (0.95)^{10} + (0.95)^0 = 1 + (0.95)^{10}$。\n$C_{21} = (0.95)^{21-10} + (0.95)^{21-20} = (0.95)^{11} + (0.95)^1 = 0.95 + (0.95)^{11}$。\n$C_{22} = (0.95)^{22-10} + (0.95)^{22-20} = (0.95)^{12} + (0.95)^2$。\n$C_{23} = (0.95)^{23-10} + (0.95)^{23-20} = (0.95)^{13} + (0.95)^3$。\n$C_{24} = (0.95)^{24-10} + (0.95)^{24-20} = (0.95)^{14} + (0.95)^4$。\n$C_{25} = (0.95)^{25-10} + (0.95)^{25-20} = (0.95)^{15} + (0.95)^5$。\n\n我们现在按要求将所需的 16 个值按顺序列出作为最终答案。\n$C_{10} = 1$\n$C_{11} = 0.95$\n$C_{12} = (0.95)^2$\n$C_{13} = (0.95)^3$\n$C_{14} = (0.95)^4$\n$C_{15} = (0.95)^5$\n$C_{16} = (0.95)^6$\n$C_{17} = (0.95)^7$\n$C_{18} = (0.95)^8$\n$C_{19} = (0.95)^9$\n$C_{20} = 1 + (0.95)^{10}$\n$C_{21} = 0.95 + (0.95)^{11}$\n$C_{22} = (0.95)^2 + (0.95)^{12}$\n$C_{23} = (0.95)^3 + (0.95)^{13}$\n$C_{24} = (0.95)^4 + (0.95)^{14}$\n$C_{25} = (0.95)^5 + (0.95)^{15}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1  0.95  (0.95)^{2}  (0.95)^{3}  (0.95)^{4}  (0.95)^{5}  (0.95)^{6}  (0.95)^{7}  (0.95)^{8}  (0.95)^{9}  1+(0.95)^{10}  0.95+(0.95)^{11}  (0.95)^{2}+(0.95)^{12}  (0.95)^{3}+(0.95)^{13}  (0.95)^{4}+(0.95)^{14}  (0.95)^{5}+(0.95)^{15} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在理解了信号的生成过程之后，下一步自然是学习如何逆转这一过程：从钙信号中推断尖峰。本练习将通过让您手动执行近端梯度法的一个步骤，来揭开“反卷积”算法的神秘面纱，该算法是解决此类任务的核心工具。通过这个练习，您将清晰地看到算法如何在数据保真度与尖峰稀疏性之间进行权衡。",
            "id": "4019632",
            "problem": "考虑一个钙成像生成模型，其中钙脉冲响应由一个衰减参数为 $\\gamma \\in (0,1)$ 且振幅为1的1阶自回归（AR($1$)）过程产生。在离散时间中，当时间窗宽度归一化为$1$时，脉冲响应为 $g_{t} = \\gamma^{t}$（$t \\geq 0$）。设脉冲序列为一个向量 $s \\in \\mathbb{R}^{T}$，观测到的荧光被建模为 $y \\approx H s$（此步骤中忽略基线和测量噪声），其中 $H \\in \\mathbb{R}^{T \\times T}$ 是由脉冲响应构建的下三角托普利兹卷积矩阵。在本问题中，取 $T = 2$，$\\gamma = \\frac{1}{2}$，观测值为 $y = \\begin{pmatrix} 1  0 \\end{pmatrix}^{\\top}$。相应的托普利兹矩阵为\n$$\nH = \\begin{pmatrix}\n1  0 \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}.\n$$\n我们的目标是通过最小化凸目标函数\n$$\nf(s) = \\frac{1}{2} \\| y - H s \\|_{2}^{2} + \\lambda \\| s \\|_{1},\n$$\n来推断脉冲序列，其中正则化参数设为 $\\lambda = 0.1$。从初始条件 $s^{(0)} = \\begin{pmatrix} 0  0 \\end{pmatrix}^{\\top}$ 开始，使用固定步长 $\\eta = \\frac{1}{\\| H \\|^{2}}$ 执行一步近端梯度，其中 $\\| H \\|$ 表示 $H$ 的谱范数。精确计算更新后的迭代值 $s^{(1)}$。请使用 LaTeX 的 $\\texttt{pmatrix}$ 环境将最终答案表示为单个行向量，并且不要四舍五入；请提供精确的闭式表达式。",
            "solution": "钙成像模型使用线性卷积，通过源自1阶自回归（AR($1$)）脉冲响应的托普利兹算子 $H$，将脉冲 $s$ 映射到荧光 $y$。脉冲推断的目标函数是\n$$\nf(s) = g(s) + h(s),\n$$\n其中光滑的数据拟合项是\n$$\ng(s) = \\frac{1}{2} \\| y - H s \\|_{2}^{2},\n$$\n非光滑正则化项是\n$$\nh(s) = \\lambda \\| s \\|_{1}.\n$$\n近端梯度法应用以下迭代\n$$\ns^{(k+1)} = \\operatorname{prox}_{\\eta h}\\!\\left(s^{(k)} - \\eta \\nabla g(s^{(k)})\\right),\n$$\n其中 $\\eta$ 的选择使其不大于 $\\nabla g$ 的利普希茨常数的倒数，对于二次函数 $g$，该常数等于 $H$ 的谱范数的平方，即 $\\| H \\|^{2}$。此处指定 $\\eta = \\frac{1}{\\| H \\|^{2}}$。\n\n首先，计算光滑部分的梯度。由于\n$$\ng(s) = \\frac{1}{2} \\| y - H s \\|_{2}^{2},\n$$\n梯度为\n$$\n\\nabla g(s) = H^{\\top} (H s - y).\n$$\n当 $s^{(0)} = \\begin{pmatrix} 0  0 \\end{pmatrix}^{\\top}$ 时，我们有\n$$\n\\nabla g(s^{(0)}) = H^{\\top} (H s^{(0)} - y) = H^{\\top} (0 - y) = - H^{\\top} y.\n$$\n因此，前向（梯度）步为\n$$\ns^{(0)} - \\eta \\nabla g(s^{(0)}) = 0 - \\eta (- H^{\\top} y) = \\eta H^{\\top} y.\n$$\n\n接下来，显式计算 $H^{\\top} y$。给定\n$$\nH = \\begin{pmatrix}\n1  0 \\\\\n\\frac{1}{2}  1\n\\end{pmatrix},\n\\quad\nH^{\\top} = \\begin{pmatrix}\n1  \\frac{1}{2} \\\\\n0  1\n\\end{pmatrix},\n\\quad\ny = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n我们得到\n$$\nH^{\\top} y = \\begin{pmatrix}\n1  \\frac{1}{2} \\\\\n0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\ 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\ 0\n\\end{pmatrix}.\n$$\n因此，\n$$\ns^{(0)} - \\eta \\nabla g(s^{(0)}) = \\eta \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n\n现在计算步长 $\\eta = \\frac{1}{\\| H \\|^{2}}$。谱范数的平方满足\n$$\n\\| H \\|^{2} = \\lambda_{\\max}\\!\\left(H^{\\top} H\\right),\n$$\n其中 $\\lambda_{\\max}(\\cdot)$ 表示最大特征值。计算\n$$\nH^{\\top} H\n=\n\\begin{pmatrix}\n1  \\frac{1}{2} \\\\\n0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0 \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 + \\left(\\frac{1}{2}\\right)^{2}  \\frac{1}{2} \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{5}{4}  \\frac{1}{2} \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}.\n$$\n$H^{\\top} H$ 的特征多项式为\n$$\n\\det\\!\\left(\n\\begin{pmatrix}\n\\frac{5}{4}  \\frac{1}{2} \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}\n-\n\\lambda\n\\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}\n\\right)\n=\n\\left(\\frac{5}{4} - \\lambda\\right)\\left(1 - \\lambda\\right) - \\left(\\frac{1}{2}\\right)^{2}\n=\n\\lambda^{2} - \\frac{9}{4} \\lambda + 1.\n$$\n求解 $\\lambda^{2} - \\frac{9}{4}\\lambda + 1 = 0$ 得到\n$$\n\\lambda = \\frac{1}{8}\\left(9 \\pm \\sqrt{17}\\right),\n$$\n所以\n$$\n\\lambda_{\\max}\\!\\left(H^{\\top} H\\right) = \\frac{1}{8}\\left(9 + \\sqrt{17}\\right),\n\\quad\n\\eta = \\frac{1}{\\| H \\|^{2}} = \\frac{1}{\\lambda_{\\max}(H^{\\top} H)} = \\frac{8}{9 + \\sqrt{17}}.\n$$\n\n缩放的 $\\ell_{1}$ 范数的近端算子是可分的，并由逐元素软阈值给出。对于一个向量 $v$ 和阈值 $\\tau  0$，\n$$\n\\operatorname{prox}_{\\tau \\| \\cdot \\|_{1}}(v) = S_{\\tau}(v),\n$$\n其中\n$$\n\\left[S_{\\tau}(v)\\right]_{i} = \\operatorname{sign}(v_{i}) \\max\\!\\left(|v_{i}| - \\tau, 0\\right).\n$$\n在我们的例子中，近端算子的参数是 $v = \\eta H^{\\top} y = \\begin{pmatrix} \\eta \\\\ 0 \\end{pmatrix}$，阈值为 $\\tau = \\eta \\lambda = \\frac{8}{9 + \\sqrt{17}} \\cdot 0.1 = \\frac{4}{5(9 + \\sqrt{17})}$。因此，\n$$\ns^{(1)} = S_{\\eta \\lambda}\\!\\left(\\eta H^{\\top} y\\right)\n=\n\\begin{pmatrix}\n\\max\\!\\left(\\eta - \\eta \\lambda, 0\\right) \\\\\n\\max\\!\\left(0 - \\eta \\lambda, 0\\right)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\eta (1 - \\lambda) \\\\\n0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{8}{9 + \\sqrt{17}} \\cdot \\frac{9}{10} \\\\\n0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{36}{5(9 + \\sqrt{17})} \\\\\n0\n\\end{pmatrix}.\n$$\n\n最后，将 $s^{(1)}$ 表示为单个行向量：\n$$\ns^{(1)} = \\begin{pmatrix} \\frac{36}{5(9 + \\sqrt{17})}  0 \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{36}{5\\left(9+\\sqrt{17}\\right)}  0\\end{pmatrix}}$$"
        },
        {
            "introduction": "真实世界的生物数据很少完全符合简单的线性模型。这项高级编程练习将挑战您去探索一个关键的非线性效应：钙指示剂的饱和。通过模拟一个接近真实情况的场景，并应用一个简化的线性反卷积方法，您将亲眼观察并量化模型不匹配如何导致尖峰检测失败，从而深刻理解在推断中使用更符合生物物理现实模型的重要性。",
            "id": "4019651",
            "problem": "给定一个用于细胞内钙离子浓度和指示剂荧光的生物物理生成模型。在频率为 $100$ 赫兹时，出现一串包含五个动作电位（峰电位）的爆发，这意味着峰间间隔为 $10$ 毫秒。钙离子浓度 $C(t)$（单位：纳摩尔）遵循线性时不变动力学，具有指数衰减和在峰电位时刻的瞬时增量。荧光由一个一对一结合模型生成，其解离常数低于钙浓度峰值，从而引发饱和。\n\n基本原理：\n- 钙动力学被建模为一个一阶线性系统，假设在峰电位时刻存在瞬时流入：$$\\frac{dC(t)}{dt} = -\\frac{1}{\\tau} C(t) + A \\sum_i \\delta(t - t_i),$$ 其中 $\\tau$（单位：秒）是钙衰减时间常数，$A$（单位：纳摩尔）是每个峰电位引起的增量，$t_i$ 是峰电位时刻。\n- 指示剂荧光由平衡状态下的质量作用结合模型建模，其希尔系数为 $1$：$$F(t) = F_0 + F_{\\max} \\frac{C(t)}{K_d + C(t)},$$ 其中 $F_0$ 是基线荧光，$F_{\\max}$ 是最大荧光变化量，$K_d$（单位：纳摩尔）是解离常数。\n- 一种线性反卷积方法错误地假设荧光与钙浓度成正比，即 $F(t) \\approx \\alpha C(t)$（对于某个常数 $\\alpha$），并通过对线性钙动力学进行逆运算来估计峰电位。\n\n任务：\n1. 在一个足够长的时间窗口内模拟钙浓度 $C(t)$，该窗口需包含整个爆发及其后续影响，并以固定的时间步长进行采样。使用 $C(0) = 0$，衰减时间常数 $\\tau = 0.3$ 秒，峰电位幅度 $A = 200$ 纳摩尔，以及从 $t = 0.2$ 秒开始的五个频率为 $100$ 赫兹的峰电位（即，在 $t \\in \\{0.2, 0.21, 0.22, 0.23, 0.24\\}$ 秒）。使用 $\\Delta t = 0.001$ 秒（即 $1$ 毫秒）的采样间隔。不存在测量噪声。使用 $F_0 = 0$ 和 $F_{\\max} = 1$（无单位）。\n2. 使用上述结合公式生成荧光 $F(t)$。\n3. 实现一个线性反卷积估计器，该估计器首先通过在 $C \\approx 0$ 处进行小信号线性化，将荧光映射为估计的钙浓度 $C_{\\text{hat}}(t)$，然后对线性钙动力学进行逆运算以估计峰电位序列 $s_{\\text{hat}}(t)$。该逆运算应从采样间隔 $\\Delta t$ 下的钙动力学差分方程形式推导得出。\n4. 通过检测 $s_{\\text{hat}}(t)$ 中超过检测阈值的局部最大值来计数推断出的峰电位。使用 $0.75$（无量纲）的检测阈值，并将时间索引 $n$ 处的局部最大值定义为满足 $s_{\\text{hat}}[n] \\ge s_{\\text{hat}}[n-1]$、$s_{\\text{hat}}[n] \\ge s_{\\text{hat}}[n+1]$ 和 $s_{\\text{hat}}[n] \\ge 0.75$ 的点。对阈值判断使用“大于或等于”准则。真实的峰电位计数为 $5$。\n5. 计算峰电位计数的欠估计偏差，定义为 $$b = \\text{true\\_count} - \\text{inferred\\_count},$$ 当有峰电位被漏检时，这是一个非负整数。\n\n测试套件：\n运行您的程序，测试以下解离常数（单位：纳摩尔），并保持所有其他参数不变：\n- 情况 1：$K_d = 150$\n- 情况 2：$K_d = 300$\n- 情况 3：$K_d = 800$\n- 情况 4：$K_d = 934$（约等于该爆发串预期的动态钙峰值）\n- 情况 5：$K_d = 5000$（一个近似于近线性区域的高值）\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含五个测试用例的欠估计偏差值，按顺序排列，格式为用方括号括起来的逗号分隔列表（例如，“[b1,b2,b3,b4,b5]”）。每个 $b_i$ 必须是整数。不应打印任何其他文本。所有时间单位为秒，钙浓度单位为纳摩尔，荧光无单位。",
            "solution": "该问题要求分析钙成像数据峰电位推断中一个常见的失败模式。具体来说，它要求量化当底层荧光信号由一个饱和的、非线性的钙指示剂生成时，线性反卷积算法引入的欠估计偏差。我们将首先通过正向模拟生物物理模型来生成钙和荧光信号，然后应用指定的逆（反卷积）算法来推断峰电位，最后针对不同水平的指示剂饱和度计算由此产生的偏差。\n\n**1. 正向模型：模拟钙和荧光动力学**\n\n第一步是生成真实的细胞内钙浓度 `$C(t)$` 和相应的荧光信号 `$F(t)`。\n\n**1.1. 钙浓度模拟**\n钙浓度 `$C(t)`` 由以下一阶线性微分方程建模：\n$$\n\\frac{dC(t)}{dt} = -\\frac{1}{\\tau} C(t) + A \\sum_i \\delta(t - t_i)\n$$\n其中 `$\\tau = 0.3$` 秒是衰减时间常数，`$A = 200$` 纳摩尔（nM）是每个峰电位引起的钙流入量，`$\\delta(t - t_i)` 表示在每个峰电位时刻 `$t_i$` 的狄拉克δ函数。峰电位序列由 `$5$` 个频率为 `$100$` Hz 的动作电位组成，发生在 `$t \\in \\{0.2, 0.21, 0.22, 0.23, 0.24\\}$` 秒。\n\n对于数值模拟，我们在 `$\\Delta t = 0.001$` 秒的时间间隔上对该方程进行离散化。齐次方程 `$\\frac{dC}{dt} = -C/\\tau$` 在一个时间步长内的解是一个指数衰减。δ函数对应于瞬时增加。这导出了离散时间更新规则：\n$$\nC[n] = C[n-1] \\cdot \\gamma + A \\cdot s[n]\n$$\n其中 `$C[n] = C(n\\Delta t)$` 是在时间步 `$n$` 的钙浓度，`$\\gamma = e^{-\\Delta t/\\tau}$` 是每个时间步的衰减因子，`$s[n]$` 是峰电位序列的离散表示，如果一个峰电位发生在对应于 `$n$` 的时间窗内，则 `$s[n]=1$`，否则 `$s[n]=0$`。模拟以初始条件 `$C[0] = 0$` 开始。\n\n**1.2. 荧光信号生成**\n荧光信号 `$F(t)$` 由钙浓度 `$C(t)$` 通过一个由希尔方程（希尔系数为 `$1$`）描述的一对一结合模型生成：\n$$\nF(t) = F_0 + F_{\\max} \\frac{C(t)}{K_d + C(t)}\n$$\n给定参数 `$F_0 = 0$` 和 `$F_{\\max} = 1$`，该式可简化为：\n$$\nF(t) = \\frac{C(t)}{K_d + C(t)}\n$$\n这里，`$K_d$` 是钙指示剂的解离常数。这个方程引入了一个关键的非线性。当钙浓度 `$C(t)$` 远小于 `$K_d$` 时，该关系近似线性：`$F(t) \\approx C(t)/K_d$`。然而，当 `$C(t)$` 变得与 `$K_d$` 相当或更大时，荧光信号开始饱和，趋近于其最大值 `$1$`。这种饱和是线性反卷积方法的主要误差来源。\n\n**2. 逆问题：线性峰电位反卷积**\n\n该任务指定了一种线性反卷积方法来从荧光信号中估计峰电位序列。该方法错误地假设了荧光和钙之间存在线性关系。\n\n**2.1. 钙浓度估计**\n该方法首先从荧光轨迹中估计钙浓度。它通过在 `$C=0$` 附近使用荧光模型的小信号线性化来实现这一点。`$F(C)$` 在 `$C=0$` 处的泰勒展开式为 `$F(C) \\approx F(0) + F'(0) \\cdot C$`。\n对于 `$F(C) = C/(K_d + C)$`，我们有 `$F(0)=0$` 和导数 `$F'(C) = K_d/(K_d + C)^2$`，这给出 `$F'(0) = 1/K_d$`。\n因此，线性近似为 `$F(t) \\approx \\frac{1}{K_d} C(t)$`。\n为了从荧光中估计钙浓度，该关系被反转：\n$$\nC_{\\text{hat}}(t) = K_d \\cdot F(t)\n$$\n代入 `$F(t)$` 的表达式揭示了估计的本质：\n$$\nC_{\\text{hat}}(t) = K_d \\frac{C(t)}{K_d + C(t)}\n$$\n这表明只有在线性区域，即 `$C(t) \\ll K_d$` 时，才有 `$C_{\\text{hat}}(t) \\approx C(t)`。在饱和区域（`$C(t) \\gg K_d$`），`$C_{\\text{hat}}(t)` 逼近上限 `$K_d$`，严重低估了真实的钙浓度。\n\n**2.2. 峰电位序列估计**\n接下来，算法对离散化的钙动力学进行逆运算以估计峰电位序列。从离散更新规则 `$C[n] = \\gamma C[n-1] + A s[n]$` 开始，我们可以解出 `$s[n]$`：\n$$\ns[n] = \\frac{1}{A} (C[n] - \\gamma C[n-1])\n$$\n该公式应用于估计的钙轨迹 `$C_{\\text{hat}}[n]$` 以获得估计的峰电位序列 `$s_{\\text{hat}}[n]$`：\n$$\ns_{\\text{hat}}[n] = \\frac{1}{A} (C_{\\text{hat}}[n] - \\gamma C_{\\text{hat}}[n-1])\n$$\n其中 `$\\gamma = e^{-\\Delta t/\\tau}$` 与之前相同。由于 `$C_{\\text{hat}}[n]$` 在高活动期间低估了真实的钙动力学，增量 `$(C_{\\text{hat}}[n] - \\gamma C_{\\text{hat}}[n-1])$` 将小于真实增量，导致在峰电位时刻 `$s_{\\text{hat}}[n]  1$`，尤其是在爆发串中饱和度变得更加显著的后续峰电位处。\n\n**3. 峰电位计数和偏差计算**\n\n最后，我们量化反卷积算法的性能。\n\n**3.1. 峰电位检测**\n通过在估计的峰电位序列 `$s_{\\text{hat}}[n]$` 中找到超过给定阈值的局部最大值来识别推断出的峰电位。如果在时间索引 `$n$` 处满足以下所有三个条件，则计数一个峰电位：\n1. `$s_{\\text{hat}}[n] \\ge s_{\\text{hat}}[n-1]$`\n2. `$s_{\\text{hat}}[n] \\ge s_{\\text{hat}}[n+1]$`\n3. `$s_{\\text{hat}}[n] \\ge 0.75$`（检测阈值）\n\n**3.2. 欠估计偏差**\n欠估计偏差 `$b$` 是算法漏检的峰电位数量：\n$$\nb = \\text{true\\_count} - \\text{inferred\\_count}\n$$\n真实的峰电位数量为 `$5$`。我们将为解离常数 `$K_d$` 的五个不同值计算 `$b$`，这些值系统地改变了指示剂的饱和程度。我们预计，对于低 `$K_d$`（高饱和度），`$b$` 会较高，而对于高 `$K_d$`（近线性区域），`$b$` 会趋向于 `$0$`。",
            "answer": "[4,3,1,1,0]"
        }
    ]
}