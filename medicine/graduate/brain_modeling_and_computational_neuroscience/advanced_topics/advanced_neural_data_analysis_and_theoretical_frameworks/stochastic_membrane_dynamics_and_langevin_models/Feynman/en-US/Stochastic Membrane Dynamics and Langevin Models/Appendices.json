{
    "hands_on_practices": [
        {
            "introduction": "Building realistic models of neurons requires translating physical phenomena into precise mathematical equations. This first practice focuses on a crucial step: converting a physical description of a noisy input current, characterized by its intensity $D$, into the standard form of a stochastic differential equation (SDE) with noise amplitude $\\sigma$. Mastering this conversion  is fundamental to ensuring that our mathematical models accurately represent the underlying biophysics of neuronal noise.",
            "id": "4022817",
            "problem": "Consider a single-compartment passive neuronal membrane with capacitance $C$, leak conductance $g_{L}$, and leak reversal potential $E_{L}$. The membrane voltage $V(t)$ obeys the capacitive law $C\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)$, where the total current $I_{\\mathrm{tot}}(t)$ consists of a deterministic component and an additive zero-mean Gaussian white current noise $\\xi(t)$. Let the deterministic component be given by $I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L})$, and assume the noise has autocorrelation $\\langle \\xi(t)\\,\\xi(t') \\rangle = 2D\\,\\delta(t - t')$, where $D$ is the current noise intensity and $\\delta(\\cdot)$ is the Dirac delta function. Suppose the corresponding stochastic membrane equation is written in the Itō form of a Stochastic Differential Equation (SDE) as\n$$\ndV = a(V,t)\\,dt + \\sigma\\,dW_{t},\n$$\nwhere $a(V,t)$ is the deterministic drift, $\\sigma$ is the noise amplitude, and $W_{t}$ is a standard Wiener process (Brownian motion). Using only first principles that relate Gaussian white noise to increments of a standard Wiener process, and the capacitive law $C\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)$, derive a closed-form analytic expression for the amplitude $\\sigma$ in terms of $D$ and $C$, assuming the noise enters the voltage equation as $\\xi(t)/C$. Express your final answer as a single analytic expression. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the noise amplitude $\\sigma$ in a stochastic differential equation (SDE) representation of a passive neuronal membrane, based on its underlying physical description.\n\nFirst, we perform a formal validation of the problem statement.\n\n### Step 1: Extract Givens\n- A single-compartment passive neuronal membrane with capacitance $C$, leak conductance $g_L$, and leak reversal potential $E_L$.\n- The governing equation for the membrane voltage $V(t)$ is the capacitive law: $C\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)$.\n- The total current is $I_{\\mathrm{tot}}(t) = I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) + \\xi(t)$.\n- The noise $\\xi(t)$ is a zero-mean Gaussian white current noise.\n- The autocorrelation of the noise is given by $\\langle \\xi(t)\\,\\xi(t') \\rangle = 2D\\,\\delta(t - t')$, where $D$ is the current noise intensity and $\\delta(\\cdot)$ is the Dirac delta function.\n- The corresponding stochastic process for the voltage is expressed as an Itō SDE: $dV = a(V,t)\\,dt + \\sigma\\,dW_{t}$, where $a(V,t)$ is the drift, $\\sigma$ is the noise amplitude, and $W_t$ is a standard Wiener process.\n- An explicit assumption is made that the noise term enters the voltage equation as $\\xi(t)/C$.\n- The objective is to find a closed-form expression for $\\sigma$ in terms of $D$ and $C$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard exercise in computational neuroscience, representing the Ornstein-Uhlenbeck process for membrane potential. The model is based on fundamental principles of circuit theory (capacitive law, Ohm's law for the leak current) and stochastic calculus. All components are well-established in the field.\n- **Well-Posed:** The problem provides a complete set of definitions and relationships to uniquely determine the parameter $\\sigma$ from the parameters $D$ and $C$.\n- **Objective:** The problem is stated using precise mathematical and physical terminology, free of ambiguity or subjective claims.\n- **Conclusion:** The problem is valid as it is scientifically sound, self-contained, and well-posed. No flaws listed in the validation checklist are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n### Derivation\nWe begin with the provided capacitive law for the membrane potential $V(t)$:\n$$\nC\\,\\frac{dV}{dt} = I_{\\mathrm{tot}}(t)\n$$\nSubstituting the expression for the total current $I_{\\mathrm{tot}}(t)$ gives:\n$$\nC\\,\\frac{dV}{dt} = I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) + \\xi(t)\n$$\nTo obtain an equation for the rate of change of voltage, $\\frac{dV}{dt}$, we divide by the capacitance $C$:\n$$\n\\frac{dV}{dt} = \\frac{1}{C} \\left( I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) \\right) + \\frac{\\xi(t)}{C}\n$$\nThis is a Langevin equation. The first term on the right-hand side is the deterministic part, and the second term, $\\frac{\\xi(t)}{C}$, is the stochastic part.\n\nTo formalize this as an Itō stochastic differential equation (SDE), we multiply by an infinitesimal time increment $dt$. This yields the informal expression:\n$$\ndV = \\left[ \\frac{1}{C} \\left( I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) \\right) \\right] dt + \\frac{\\xi(t)}{C} dt\n$$\nWe are given that this equation corresponds to the Itō SDE form:\n$$\ndV = a(V,t)\\,dt + \\sigma\\,dW_{t}\n$$\nBy comparing the two forms, we can identify the drift term $a(V,t)$ and the relationship between the noise terms. The drift is:\n$$\na(V,t) = \\frac{1}{C} \\left( I_{\\mathrm{app}}(t) - g_{L}\\,(V - E_{L}) \\right)\n$$\nThe stochastic components must be equivalent:\n$$\n\\sigma\\,dW_{t} = \\frac{\\xi(t)}{C} dt\n$$\nThis last expression is a formal identification relating the infinitesimal increment of a Wiener process, $dW_t$, to the ill-defined product of a white noise process and $dt$. To make this relationship rigorous and find $\\sigma$, we must compare the statistical properties of both sides, specifically their variance over a small time interval $\\Delta t$.\n\nLet's first analyze the Itō form. The stochastic increment over a time interval $\\Delta t$ is $\\Delta V_{\\text{stoch}} = \\sigma \\Delta W_t$, where $\\Delta W_t = W_{t+\\Delta t} - W_t$. A standard Wiener process $W_t$ has increments $\\Delta W_t$ that are normally distributed with a mean of $0$ and a variance of $\\Delta t$.\n$$\n\\langle \\Delta W_t \\rangle = 0\n$$\n$$\n\\text{Var}(\\Delta W_t) = \\langle (\\Delta W_t)^2 \\rangle - (\\langle \\Delta W_t \\rangle)^2 = \\langle (\\Delta W_t)^2 \\rangle = \\Delta t\n$$\nThe variance of the stochastic voltage increment from the SDE is therefore:\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\langle (\\sigma \\Delta W_t)^2 \\rangle = \\sigma^2 \\langle (\\Delta W_t)^2 \\rangle = \\sigma^2 \\Delta t\n$$\n\nNext, we analyze the Langevin form. The stochastic voltage increment over a time interval $\\Delta t$ is obtained by integrating the noise term:\n$$\n\\Delta V_{\\text{stoch}} = \\int_t^{t+\\Delta t} \\frac{\\xi(s)}{C} ds = \\frac{1}{C} \\int_t^{t+\\Delta t} \\xi(s) ds\n$$\nThe variance of this increment is:\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\left\\langle \\left( \\frac{1}{C} \\int_t^{t+\\Delta t} \\xi(s) ds \\right) \\left( \\frac{1}{C} \\int_t^{t+\\Delta t} \\xi(s') ds' \\right) \\right\\rangle\n$$\n$$\n= \\frac{1}{C^2} \\left\\langle \\int_t^{t+\\Delta t} ds \\int_t^{t+\\Delta t} ds' \\, \\xi(s) \\xi(s') \\right\\rangle\n$$\nWe can move the expectation operator inside the integrals:\n$$\n= \\frac{1}{C^2} \\int_t^{t+\\Delta t} ds \\int_t^{t+\\Delta t} ds' \\, \\langle \\xi(s) \\xi(s') \\rangle\n$$\nWe are given the autocorrelation of the white noise: $\\langle \\xi(s) \\xi(s') \\rangle = 2D\\,\\delta(s - s')$. Substituting this into the expression gives:\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\frac{1}{C^2} \\int_t^{t+\\Delta t} ds \\int_t^{t+\\Delta t} ds' \\, (2D\\,\\delta(s - s'))\n$$\nWe evaluate the inner integral with respect to $s'$ first. The sifting property of the Dirac delta function $\\delta(s-s')$ means the integral is non-zero only at $s'=s$.\n$$\n\\int_t^{t+\\Delta t} 2D\\,\\delta(s - s') ds' = 2D\n$$\nThis holds because $s$ is in the interval $[t, t+\\Delta t]$, so the point $s'=s$ is always within the domain of integration.\nSubstituting this result back into the outer integral yields:\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\frac{1}{C^2} \\int_t^{t+\\Delta t} 2D \\, ds = \\frac{2D}{C^2} \\int_t^{t+\\Delta t} ds\n$$\nEvaluating the final simple integral:\n$$\n\\langle (\\Delta V_{\\text{stoch}})^2 \\rangle = \\frac{2D}{C^2} [s]_t^{t+\\Delta t} = \\frac{2D}{C^2} ( (t+\\Delta t) - t ) = \\frac{2D}{C^2} \\Delta t\n$$\nNow, we equate the two expressions for the variance of the stochastic voltage increment over $\\Delta t$:\n$$\n\\sigma^2 \\Delta t = \\frac{2D}{C^2} \\Delta t\n$$\nDividing both sides by $\\Delta t$ (for $\\Delta t > 0$):\n$$\n\\sigma^2 = \\frac{2D}{C^2}\n$$\nFinally, solving for the noise amplitude $\\sigma$, which must be a non-negative real number:\n$$\n\\sigma = \\sqrt{\\frac{2D}{C^2}} = \\frac{\\sqrt{2D}}{\\sqrt{C^2}} = \\frac{\\sqrt{2D}}{|C|}\n$$\nSince capacitance $C$ is a physical quantity that is strictly positive, $|C| = C$. Therefore, the final expression for $\\sigma$ is:\n$$\n\\sigma = \\frac{\\sqrt{2D}}{C}\n$$\nThis expression relates the amplitude of the noise term in the Itō SDE to the physical parameters of current noise intensity $D$ and membrane capacitance $C$.",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{2D}}{C}}\n$$"
        },
        {
            "introduction": "Once a stochastic model is formulated, we need tools to analyze its behavior and make testable predictions. This exercise  guides you through the derivation of the time evolution for the mean and variance of a neuron's membrane potential, modeled by the classic Ornstein-Uhlenbeck process. By applying Itô's lemma, you will uncover how the model's parameters shape the central tendencies and fluctuations of the voltage, providing a direct link between the model's structure and its statistical output.",
            "id": "4022871",
            "problem": "A single-compartment passive neuronal membrane driven by a constant input and additive current noise can be modeled by the stochastic differential equation (SDE) for the membrane potential $V_{t}$:\n$$\n\\mathrm{d}V_{t}=\\left[-\\frac{1}{\\tau_{m}}\\left(V_{t}-E_{L}\\right)+\\frac{I_{0}}{C}\\right]\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t},\n$$\nwhere $W_{t}$ is a standard Wiener process, $E_{L}$ is the leak reversal potential, $\\tau_{m}>0$ is the membrane time constant, $C>0$ is the membrane capacitance, $I_{0}$ is a constant input current, and $\\sigma\\ge 0$ sets the strength of additive Gaussian white noise. Define $a=\\frac{E_{L}}{\\tau_{m}}+\\frac{I_{0}}{C}$ and $b=\\frac{1}{\\tau_{m}}$ so that the drift is linear, $(a-bV_{t})$, and the noise is additive, $\\sigma$.\n\nStarting only from this SDE together with the basic properties of the Wiener process and either Itô calculus or the Fokker–Planck equation (FPE), do the following:\n\n- Derive closed ordinary differential equations for the time evolution of the first moment $m(t)=\\langle V_{t}\\rangle$ and the variance $s^{2}(t)=\\mathrm{Var}(V_{t})$.\n- Solve these equations for their steady-state values $m_{\\infty}$ and $s^{2}_{\\infty}$, and state the condition on parameters under which these steady states exist.\n\nExpress your final steady-state results in terms of $a$, $b$, and $\\sigma$ only, and present them as a single row matrix $\\big[m_{\\infty}\\ \\ s^{2}_{\\infty}\\big]$. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of ordinary differential equations (ODEs) for the mean and variance of the membrane potential $V_{t}$ governed by a stochastic differential equation (SDE), and the subsequent calculation of the steady-state values of these moments.\n\nFirst, we validate the problem.\n\n### Step 1: Extract Givens\n- The SDE for the membrane potential $V_{t}$ is:\n$$\n\\mathrm{d}V_{t}=\\left[-\\frac{1}{\\tau_{m}}\\left(V_{t}-E_{L}\\right)+\\frac{I_{0}}{C}\\right]\\mathrm{d}t+\\sigma\\,\\mathrm{d}W_{t}\n$$\n- $W_{t}$ is a standard Wiener process.\n- $E_{L}$ is the leak reversal potential.\n- $\\tau_{m}>0$ is the membrane time constant.\n- $C>0$ is the membrane capacitance.\n- $I_{0}$ is a constant input current.\n- $\\sigma\\ge 0$ is the noise strength.\n- $a=\\frac{E_{L}}{\\tau_{m}}+\\frac{I_{0}}{C}$\n- $b=\\frac{1}{\\tau_{m}}$\n- First moment: $m(t)=\\langle V_{t}\\rangle$\n- Variance: $s^{2}(t)=\\mathrm{Var}(V_{t})$\n- Task: Derive ODEs for $m(t)$ and $s^{2}(t)$, solve for their steady-state values ($m_{\\infty}$, $s^{2}_{\\infty}$), and state the condition for the existence of these steady states.\n- The final result should be expressed in terms of $a$, $b$, and $\\sigma$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing the Ornstein-Uhlenbeck process, a canonical model for a leaky integrator neuron with noisy input. All terms are defined, and the parameters have physically meaningful constraints ($\\tau_{m}>0$, $C>0$, $\\sigma\\ge 0$). The task is well-posed, involving standard analytical techniques (Itô calculus or the Fokker-Planck equation) to characterize the moments of the process. The problem is self-contained, objective, and does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\nFirst, we rewrite the SDE using the provided definitions for $a$ and $b$:\n$$\n-\\frac{1}{\\tau_{m}}\\left(V_{t}-E_{L}\\right)+\\frac{I_{0}}{C} = -\\frac{V_{t}}{\\tau_{m}} + \\frac{E_{L}}{\\tau_{m}} + \\frac{I_{0}}{C} = -b V_{t} + a\n$$\nThe SDE becomes:\n$$\n\\mathrm{d}V_{t} = (a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t}\n$$\nThis is the equation for an Ornstein-Uhlenbeck process.\n\n**Derivation of the ODE for the mean $m(t)$**\nThe mean is defined as $m(t) = \\langle V_{t} \\rangle$. To find its time evolution, we take the expectation of the SDE.\n$$\n\\mathrm{d}\\langle V_{t} \\rangle = \\langle \\mathrm{d}V_{t} \\rangle = \\langle (a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t} \\rangle\n$$\nUsing the linearity of the expectation operator:\n$$\n\\mathrm{d}\\langle V_{t} \\rangle = \\langle (a - bV_{t})\\mathrm{d}t \\rangle + \\langle \\sigma\\mathrm{d}W_{t} \\rangle = (a - b\\langle V_{t} \\rangle)\\mathrm{d}t + \\sigma\\langle \\mathrm{d}W_{t} \\rangle\n$$\nA fundamental property of the standard Wiener process is that the expectation of its increment is zero, $\\langle \\mathrm{d}W_{t} \\rangle = 0$. Therefore, the equation simplifies to:\n$$\n\\mathrm{d}\\langle V_{t} \\rangle = (a - b\\langle V_{t} \\rangle)\\mathrm{d}t\n$$\nSubstituting $m(t) = \\langle V_{t} \\rangle$ and dividing by $\\mathrm{d}t$, we obtain the ODE for the mean:\n$$\n\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = a - b m(t)\n$$\n\n**Derivation of the ODE for the variance $s^{2}(t)$**\nThe variance is $s^{2}(t) = \\mathrm{Var}(V_{t}) = \\langle V_{t}^{2} \\rangle - \\langle V_{t} \\rangle^{2} = \\langle V_{t}^{2} \\rangle - m(t)^{2}$. We first need to find the ODE for the second moment, $\\langle V_{t}^{2} \\rangle$. We apply Itô's lemma to the function $f(V_{t}) = V_{t}^{2}$.\nItô's lemma states that for a function $f(X_{t})$ of an Itô process $X_{t}$,\n$$\n\\mathrm{d}f(X_{t}) = \\frac{\\partial f}{\\partial t}\\mathrm{d}t + \\frac{\\partial f}{\\partial x}\\mathrm{d}X_{t} + \\frac{1}{2}\\frac{\\partial^{2} f}{\\partial x^{2}}(\\mathrm{d}X_{t})^{2}\n$$\nIn our case, $X_{t} = V_{t}$ and $f$ is not an explicit function of time, so $\\frac{\\partial f}{\\partial t}=0$. We have $\\frac{\\partial f}{\\partial V_{t}} = 2V_{t}$ and $\\frac{\\partial^{2} f}{\\partial V_{t}^{2}} = 2$. The quadratic variation term $(\\mathrm{d}V_{t})^{2}$ is calculated using the Itô rules ($\\mathrm{d}t \\cdot \\mathrm{d}t = 0$, $\\mathrm{d}t \\cdot \\mathrm{d}W_{t} = 0$, $\\mathrm{d}W_{t} \\cdot \\mathrm{d}W_{t} = \\mathrm{d}t$):\n$$\n(\\mathrm{d}V_{t})^{2} = ((a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t})^{2} = \\sigma^{2}(\\mathrm{d}W_{t})^{2} = \\sigma^{2}\\mathrm{d}t\n$$\nApplying Itô's lemma to $f(V_{t}) = V_{t}^{2}$:\n$$\n\\mathrm{d}(V_{t}^{2}) = (2V_{t})\\mathrm{d}V_{t} + \\frac{1}{2}(2)(\\mathrm{d}V_{t})^{2}\n$$\n$$\n\\mathrm{d}(V_{t}^{2}) = 2V_{t}((a - bV_{t})\\mathrm{d}t + \\sigma\\mathrm{d}W_{t}) + \\sigma^{2}\\mathrm{d}t\n$$\n$$\n\\mathrm{d}(V_{t}^{2}) = (2aV_{t} - 2bV_{t}^{2} + \\sigma^{2})\\mathrm{d}t + 2\\sigma V_{t}\\mathrm{d}W_{t}\n$$\nNow, we take the expectation of this equation. The expectation of the Itô integral term $\\langle 2\\sigma V_{t}\\mathrm{d}W_{t} \\rangle$ is zero.\n$$\n\\mathrm{d}\\langle V_{t}^{2} \\rangle = \\langle (2aV_{t} - 2bV_{t}^{2} + \\sigma^{2})\\mathrm{d}t \\rangle = (2a\\langle V_{t} \\rangle - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2})\\mathrm{d}t\n$$\nThis gives the ODE for the second moment:\n$$\n\\frac{\\mathrm{d}\\langle V_{t}^{2} \\rangle}{\\mathrm{d}t} = 2a m(t) - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2}\n$$\nNow we find the time derivative of the variance $s^{2}(t)$:\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}(\\langle V_{t}^{2} \\rangle - m(t)^{2}) = \\frac{\\mathrm{d}\\langle V_{t}^{2} \\rangle}{\\mathrm{d}t} - 2m(t)\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t}\n$$\nSubstituting the ODEs we derived:\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = (2a m(t) - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2}) - 2m(t)(a - b m(t))\n$$\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = 2a m(t) - 2b\\langle V_{t}^{2} \\rangle + \\sigma^{2} - 2a m(t) + 2b m(t)^{2}\n$$\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = \\sigma^{2} - 2b(\\langle V_{t}^{2} \\rangle - m(t)^{2})\n$$\nSubstituting $s^{2}(t) = \\langle V_{t}^{2} \\rangle - m(t)^{2}$, we get the ODE for the variance:\n$$\n\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = \\sigma^{2} - 2b s^{2}(t)\n$$\n\n**Steady-State Solutions and Condition for Existence**\nThe steady state is reached as $t \\to \\infty$, where the time derivatives of the moments are zero. Let $m_{\\infty}$ and $s^{2}_{\\infty}$ denote the steady-state mean and variance, respectively.\nFor the mean, we set $\\frac{\\mathrm{d}m(t)}{\\mathrm{d}t} = 0$:\n$$\n0 = a - b m_{\\infty} \\implies b m_{\\infty} = a \\implies m_{\\infty} = \\frac{a}{b}\n$$\nFor the variance, we set $\\frac{\\mathrm{d}s^{2}(t)}{\\mathrm{d}t} = 0$:\n$$\n0 = \\sigma^{2} - 2b s^{2}_{\\infty} \\implies 2b s^{2}_{\\infty} = \\sigma^{2} \\implies s^{2}_{\\infty} = \\frac{\\sigma^{2}}{2b}\n$$\nThese steady-state solutions exist and are stable if the system converges to them over time. The solutions to the linear ODEs for $m(t)$ and $s^{2}(t)$ converge to their respective fixed points $m_{\\infty}$ and $s^{2}_{\\infty}$ if the coefficients of the linear terms, $-b$ and $-2b$, are negative. This requires $b > 0$. From the problem statement, $b = 1/\\tau_{m}$ and $\\tau_{m} > 0$, so the condition $b > 0$ is always satisfied. Thus, a stable steady state always exists under the given conditions.\n\nThe final steady-state results in terms of $a$, $b$, and $\\sigma$ are:\n$m_{\\infty} = \\frac{a}{b}$\n$s^{2}_{\\infty} = \\frac{\\sigma^{2}}{2b}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{a}{b} & \\frac{\\sigma^{2}}{2b} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Theoretical models come to life through simulation and experiment. This final practice  immerses you in a practical scenario: designing a dynamic clamp protocol to inject a controlled, noisy conductance into a neuron. You will confront the real-world challenge of numerical stability, calculating the necessary update rates to ensure your simulation is not only statistically correct but also computationally sound, a vital skill for any computational neuroscientist.",
            "id": "4022784",
            "problem": "A single-compartment neuronal membrane is driven by a dynamic clamp that injects a noisy conductance process into the membrane. The membrane dynamics are modeled as a linear passive membrane with a leak conductance and an injected conductance that multiplies the membrane voltage relative to a reversal potential. The goal is to design a discrete-time protocol for the conductance process that achieves a specified stationary mean and variance, and to compute the minimal update rate that guarantees numerical stability under a forward-Euler discretization of the membrane equation.\n\nFundamental base and definitions:\n- Let the membrane capacitance be $C$ in farads and the leak conductance be $g_L$ in siemens. The membrane voltage $V(t)$ obeys the passive membrane equation with dynamic clamp injected conductance $g(t)$:\n$$\nC \\frac{dV}{dt} = - g_L \\left(V - E_L\\right) - g(t) \\left(V - E_{\\mathrm{rev}}\\right) .\n$$\nFor stability of a forward-Euler discretization, the linear coefficient multiplying $V$ is determined by the total conductance $G_{\\mathrm{tot}}(t) = g_L + g(t)$; the reversal potentials $E_L$ and $E_{\\mathrm{rev}}$ do not affect the stability condition of the linear update.\n- Two conductance noise protocols are considered:\n  1. Gaussian white conductance noise: a sequence $\\{g_n\\}_{n \\in \\mathbb{Z}_{\\ge 0}}$ of independent identically distributed samples with $g_n \\sim \\mathcal{N}(\\mu, \\sigma^2)$, where $\\mu$ is the desired mean and $\\sigma^2$ is the desired variance, both in siemens and siemens squared, respectively.\n  2. Ornstein–Uhlenbeck (OU) conductance noise: a continuous-time Langevin process $g(t)$ satisfying\n$$\ndg(t) = - \\frac{g(t) - \\mu}{\\tau} \\, dt + \\sqrt{\\frac{2 \\sigma^2}{\\tau}} \\, dW_t ,\n$$\nwhere $W_t$ is a standard Wiener process, $\\mu$ is the desired stationary mean in siemens, $\\sigma^2$ is the desired stationary variance in siemens squared, and $\\tau$ is the correlation time in seconds. This stochastic differential equation has stationary mean $\\mu$ and stationary variance $\\sigma^2$.\n- The discrete-time update of the membrane voltage under forward Euler with sample period $\\Delta t$ is:\n$$\nV_{n+1} = V_n + \\frac{\\Delta t}{C} \\left[ - g_L \\left(V_n - E_L\\right) - g_n \\left(V_n - E_{\\mathrm{rev}}\\right) \\right] ,\n$$\nwhere $g_n$ is the value of the injected conductance at time step $n$. This linear update is numerically stable if and only if the multiplicative factor on $V_n$ satisfies $\\left|1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)\\right| < 1$.\n- To design for probabilistic stability when $g_n$ is random, define a reliability level $p \\in (0,1)$ and the corresponding normal quantile $z_p$ as $z_p = \\Phi^{-1}(p)$, where $\\Phi$ is the cumulative distribution function of the standard normal distribution. Then a high-probability bound on the conductance is $g_{\\max} = \\mu + z_p \\sigma$. Using this bound in the deterministic stability criterion yields:\n$$\n0  \\Delta t  \\frac{2 C}{g_L + g_{\\max}} .\n$$\n- For the OU process when discretized by the Euler–Maruyama method, the deterministic part of the recursion is $g_{n+1} = g_n + \\Delta t \\left(-\\frac{g_n - \\mu}{\\tau}\\right) + \\text{noise}$, which is an autoregressive coefficient $1 - \\frac{\\Delta t}{\\tau}$. Euler–Maruyama stability of this coefficient requires $0  \\Delta t  2 \\tau$. Alternatively, an exact discrete-time OU update that preserves the continuous-time stationary mean and variance for any $\\Delta t > 0$ is defined by\n$$\ng_{n+1} = \\mu + \\phi \\left(g_n - \\mu\\right) + \\sigma_d \\, \\xi_n ,\n$$\nwhere $\\phi = e^{-\\Delta t / \\tau}$, $\\sigma_d = \\sqrt{ \\sigma^2 \\left(1 - e^{-2 \\Delta t / \\tau}\\right) }$, and $\\xi_n \\sim \\mathcal{N}(0,1)$. This exact update is unconditionally stable in mean-square sense for any $\\Delta t > 0$.\n\nTasks:\n1. For each parameter set, design the discrete-time conductance update rule that achieves the specified stationary mean and variance:\n   - For Gaussian noise, use $g_n = \\mu + \\sigma \\xi_n$ with $\\xi_n \\sim \\mathcal{N}(0,1)$ independently at each time step.\n   - For OU noise, use the exact discrete-time update $g_{n+1} = \\mu + \\phi \\left(g_n - \\mu\\right) + \\sigma_d \\xi_n$, with $\\phi$ and $\\sigma_d$ as defined above.\n2. Compute the minimal update rate $f_s$ in hertz such that the forward-Euler membrane update is numerically stable with reliability level $p$, using the bound on $g_{\\max} = \\mu + z_p \\sigma$. For OU noise, additionally enforce the Euler–Maruyama constraint $0  \\Delta t  2 \\tau$ when this discretization is used; when the exact discrete-time OU update is used, this additional constraint is not required. In this problem, enforce both constraints and select the strictest bound. To ensure strict inequalities in implementation, use a safety margin factor $\\alpha = 0.999$ and set\n$$\n\\Delta t = \\alpha \\cdot \\min\\left( \\frac{2 C}{g_L + g_{\\max}}, \\, 2 \\tau \\right)\n$$\nfor OU, and\n$$\n\\Delta t = \\alpha \\cdot \\frac{2 C}{g_L + g_{\\max}}\n$$\nfor Gaussian noise. Then compute $f_s = \\frac{1}{\\Delta t}$, expressed in hertz.\n3. For OU noise, compute the discrete-time parameters $\\phi$ and $\\sigma_d$ at the selected $\\Delta t$; for Gaussian noise, set $\\phi = 0$ and the per-step noise amplitude to be $a = \\sigma$.\n\nTest suite:\nProvide the following parameter sets, each expressed in SI units (farads, siemens, seconds), and probability as a decimal. For each, compute the result and return it as a list $[f_s, a, \\phi]$, where $f_s$ is in hertz, $a$ is the per-step noise amplitude in siemens (equal to $\\sigma$ for Gaussian and to $\\sigma_d$ for OU), and $\\phi$ is the OU autoregressive coefficient (set to $0$ for Gaussian). Round each reported float to $6$ decimal places.\n\n- Case $1$ (OU, moderate variability, membrane-limited):\n  - Type: OU\n  - $C = 2 \\times 10^{-10}$, $g_L = 1 \\times 10^{-8}$, $\\mu = 3 \\times 10^{-7}$, $\\sigma = 1 \\times 10^{-7}$, $\\tau = 5 \\times 10^{-3}$, $p = 0.9973$.\n- Case $2$ (OU, fast correlation, OU-limited):\n  - Type: OU\n  - $C = 2 \\times 10^{-10}$, $g_L = 1 \\times 10^{-8}$, $\\mu = 5 \\times 10^{-8}$, $\\sigma = 2 \\times 10^{-8}$, $\\tau = 2 \\times 10^{-4}$, $p = 0.99$.\n- Case $3$ (Gaussian, high variance):\n  - Type: Gaussian\n  - $C = 2 \\times 10^{-10}$, $g_L = 1 \\times 10^{-8}$, $\\mu = 8 \\times 10^{-7}$, $\\sigma = 3 \\times 10^{-7}$, $p = 0.999$.\n- Case $4$ (OU, large mean and leak):\n  - Type: OU\n  - $C = 1 \\times 10^{-10}$, $g_L = 3 \\times 10^{-8}$, $\\mu = 1.2 \\times 10^{-6}$, $\\sigma = 4 \\times 10^{-7}$, $\\tau = 2 \\times 10^{-3}$, $p = 0.95$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case’s result is itself a bracketed comma-separated list. For example, the output must look like `[[f_{s,1},a_1,phi_1],[f_{s,2},a_2,phi_2],...]` with no spaces. All reported $f_s$ must be in hertz, rounded to $6$ decimal places. All reported amplitudes $a$ and coefficients $\\phi$ must be rounded to $6$ decimal places.",
            "solution": "The problem requires the design of a discrete-time noisy conductance protocol and the calculation of associated parameters for numerical stability and statistical correctness. The solution entails a multi-step calculation for each specified parameter set, founded on principles of numerical stability for ordinary differential equations and properties of stochastic processes.\n\nFirst, we address the numerical stability of the forward-Euler discretization of the membrane voltage equation. The equation is given by:\n$$\nC \\frac{dV}{dt} = - g_L \\left(V - E_L\\right) - g(t) \\left(V - E_{\\mathrm{rev}}\\right)\n$$\nRearranging the terms linear in $V(t)$ yields:\n$$\nC \\frac{dV}{dt} = - \\left(g_L + g(t)\\right) V(t) + \\left(g_L E_L + g(t) E_{\\mathrm{rev}}\\right)\n$$\nThe forward-Euler update for a time step $\\Delta t$ is:\n$$\nV_{n+1} = V_n + \\frac{\\Delta t}{C} \\left[ - \\left(g_L + g_n\\right) V_n + \\left(g_L E_L + g_n E_{\\mathrm{rev}}\\right) \\right]\n$$\nwhere $g_n$ is the conductance value at the $n$-th time step. This can be written as a linear recurrence relation for $V_n$:\n$$\nV_{n+1} = \\left[ 1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right) \\right] V_n + \\frac{\\Delta t}{C} \\left(g_L E_L + g_n E_{\\mathrm{rev}}\\right)\n$$\nFor this update to be numerically stable, the magnitude of the multiplicative factor on $V_n$ must be less than $1$:\n$$\n\\left| 1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right) \\right|  1\n$$\nThis inequality resolves to:\n$$\n-1  1 - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)  1\n$$\n$$\n-2  - \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)  0\n$$\n$$\n0  \\frac{\\Delta t}{C} \\left(g_L + g_n\\right)  2\n$$\nSince $\\Delta t$, $C$, $g_L$, and $g_n$ (as a physical conductance) are non-negative, the lower bound $0$ is always satisfied. The stability is therefore governed by the upper bound:\n$$\n\\Delta t  \\frac{2C}{g_L + g_n}\n$$\nSince $g_n$ is a random variable, we must ensure this condition holds with high probability. We establish a maximum conductance value, $g_{\\max}$, that is exceeded with a small probability $1-p$. For a normally distributed conductance process with mean $\\mu$ and standard deviation $\\sigma$, this high-probability maximum is defined as $g_{\\max} = \\mu + z_p \\sigma$, where $z_p = \\Phi^{-1}(p)$ is the quantile of the standard normal distribution for the reliability level $p$. Substituting $g_{\\max}$ into the stability condition gives a deterministic bound on the time step, $\\Delta t_{mem}$:\n$$\n\\Delta t_{mem} = \\frac{2C}{g_L + g_{\\max}}\n$$\nFor the Ornstein-Uhlenbeck (OU) process, if discretized using the Euler-Maruyama method, an additional stability constraint arises from the discretization of the process itself, which requires $0  \\Delta t  2\\tau$. The problem specifies that this constraint must be considered alongside the membrane stability constraint. Therefore, for the OU case, the upper bound on $\\Delta t$ is the minimum of these two constraints:\n$$\n\\Delta t_{bound} = \\min\\left( \\frac{2C}{g_L + g_{\\max}}, 2\\tau \\right)\n$$\nFor the Gaussian white noise case, there is no time correlation, so no such constraint on $\\Delta t$ from the noise process exists. The bound is determined only by membrane stability:\n$$\n\\Delta t_{bound} = \\frac{2C}{g_L + g_{\\max}}\n$$\nTo ensure strict inequality, a safety factor $\\alpha=0.999$ is applied. The final time step $\\Delta t$ is thus $\\Delta t = \\alpha \\cdot \\Delta t_{bound}$. The minimal update rate is then $f_s = 1/\\Delta t$.\n\nThe final step is to compute the parameters for the discrete-time conductance update at the calculated $\\Delta t$.\n- For Gaussian white noise, the process is memoryless. Each sample $g_n$ is drawn from $\\mathcal{N}(\\mu, \\sigma^2)$. This is implemented as $g_n = \\mu + \\sigma \\xi_n$ where $\\xi_n \\sim \\mathcal{N}(0,1)$. The problem asks for the per-step noise amplitude $a$, which is $a = \\sigma$, and the autoregressive coefficient $\\phi$, which is $0$ for a memoryless process.\n- For the OU process, an exact discrete-time update rule is used, which preserves the stationary statistics for any $\\Delta t$. The update is $g_{n+1} = \\mu + \\phi(g_n - \\mu) + \\sigma_d \\xi_n$. The parameters $\\phi$ and $\\sigma_d$ depend on $\\Delta t$:\n$$\n\\phi = e^{-\\Delta t / \\tau}\n$$\nThe per-step noise amplitude $a = \\sigma_d$ is given by:\n$$\n\\sigma_d = \\sqrt{\\sigma^2 \\left(1 - e^{-2\\Delta t / \\tau}\\right)}\n$$\nThis can also be written in terms of $\\phi$ as $\\sigma_d = \\sigma \\sqrt{1 - \\phi^2}$.\n\nThe procedure for each test case is as follows:\n1. Determine the noise type (Gaussian or OU).\n2. Calculate the standard normal an-quantile $z_p = \\Phi^{-1}(p)$.\n3. Compute the high-probability maximum conductance $g_{\\max} = \\mu + z_p \\sigma$.\n4. Calculate the stability bound(s). For OU, $\\Delta t_{bound} = \\min(\\frac{2C}{g_L + g_{\\max}}, 2\\tau)$; for Gaussian, $\\Delta t_{bound} = \\frac{2C}{g_L + g_{\\max}}$.\n5. Apply the safety factor to find the time step: $\\Delta t = \\alpha \\cdot \\Delta t_{bound}$.\n6. Compute the minimal update rate $f_s = 1/\\Delta t$.\n7. For OU noise, compute $\\phi = e^{-\\Delta t / \\tau}$ and $a = \\sigma\\sqrt{1-e^{-2\\Delta t/\\tau}}$. For Gaussian noise, set $\\phi = 0$ and $a = \\sigma$.\n8. Assemble the results as $[f_s, a, \\phi]$ and round each value to $6$ decimal places.\n\nThis procedure will be systematically applied to each of the four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the minimal update rate and discrete-time parameters for a noisy\n    conductance process based on numerical stability criteria.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'OU', 'C': 2e-10, 'g_L': 1e-8, 'mu': 3e-7, 'sigma': 1e-7, 'tau': 5e-3, 'p': 0.9973},\n        {'type': 'OU', 'C': 2e-10, 'g_L': 1e-8, 'mu': 5e-8, 'sigma': 2e-8, 'tau': 2e-4, 'p': 0.99},\n        {'type': 'Gaussian', 'C': 2e-10, 'g_L': 1e-8, 'mu': 8e-7, 'sigma': 3e-7, 'tau': None, 'p': 0.999},\n        {'type': 'OU', 'C': 1e-10, 'g_L': 3e-8, 'mu': 1.2e-6, 'sigma': 4e-7, 'tau': 2e-3, 'p': 0.95},\n    ]\n\n    results = []\n    alpha = 0.999 # Safety margin factor\n\n    for case in test_cases:\n        # Unpack parameters\n        case_type = case['type']\n        C = case['C']\n        g_L = case['g_L']\n        mu = case['mu']\n        sigma = case['sigma']\n        tau = case['tau']\n        p = case['p']\n\n        # Step 1: Calculate the normal quantile z_p\n        z_p = norm.ppf(p)\n\n        # Step 2: Calculate the high-probability maximum conductance g_max\n        g_max = mu + z_p * sigma\n        \n        # Step 3: Calculate the stability bound from the membrane equation\n        dt_mem = (2 * C) / (g_L + g_max)\n\n        # Step 4: Determine the overall time step bound\n        if case_type == 'OU':\n            # For OU, also consider the Euler-Maruyama stability constraint\n            dt_ou = 2 * tau\n            dt_bound = min(dt_mem, dt_ou)\n        else: # Gaussian case\n            dt_bound = dt_mem\n\n        # Step 5: Apply the safety factor to get the final time step\n        dt = alpha * dt_bound\n        \n        # Step 6: Compute the minimal update rate\n        fs = 1 / dt\n\n        # Step 7: Compute the discrete-time parameters a and phi\n        if case_type == 'OU':\n            phi = np.exp(-dt / tau)\n            # The definition is a = sigma_d\n            sigma_d = np.sqrt(sigma**2 * (1 - np.exp(-2 * dt / tau)))\n            a = sigma_d\n        else: # Gaussian case\n            phi = 0.0\n            a = sigma\n\n        # Round results to 6 decimal places\n        fs_rounded = round(fs, 6)\n        a_rounded = round(a, 6)\n        phi_rounded = round(phi, 6)\n        \n        results.append([fs_rounded, a_rounded, phi_rounded])\n\n    # Final print statement in the exact required format.\n    # e.g., [[f1,a1,p1],[f2,a2,p2],...] with no spaces.\n    case_strings = []\n    for res in results:\n        # Format each sublist without spaces\n        case_strings.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```"
        }
    ]
}