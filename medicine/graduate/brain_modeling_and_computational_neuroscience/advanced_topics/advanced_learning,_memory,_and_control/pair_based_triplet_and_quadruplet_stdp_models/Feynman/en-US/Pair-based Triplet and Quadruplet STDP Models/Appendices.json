{
    "hands_on_practices": [
        {
            "introduction": "Before building complex models, we must understand how to parameterize the simplest ones. This exercise  simulates a common task in computational neuroscience: fitting the parameters of the classic pair-based Spike-Timing-Dependent Plasticity (STDP) model to noisy, experimental-like data. By performing a log-linear regression, you will extract the fundamental time constants, $ \\tau_{+} $ and $ \\tau_{-} $, and amplitudes, $ A_{+} $ and $ A_{-} $, that define the STDP learning window, a crucial first step in any modeling endeavor.",
            "id": "4007206",
            "problem": "You are given a model-fitting task grounded in the principles of Spike-Timing-Dependent Plasticity (STDP). Spike-Timing-Dependent Plasticity (STDP) specifies a synaptic weight change $\\Delta w$ as a function of the relative timing $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$ between a postsynaptic spike occurring at time $t_{\\text{post}}$ and a presynaptic spike occurring at time $t_{\\text{pre}}$. In the pair-based STDP model, the synaptic update is modeled by an exponential kernel in the causal regime ($\\Delta t > 0$) and the anti-causal regime ($\\Delta t < 0$). This exponential window arises from the interaction of presynaptic and postsynaptic activity traces that decay with characteristic time constants; those trace time constants and amplitudes subsequently parameterize higher-order triplet and quadruplet STDP models. In this problem, you will infer the exponential window parameters and validate predictions on new pairings.\n\nAssume the following well-tested pair-based STDP model: for $\\Delta t > 0$, the synaptic potentiation is $\\Delta w(\\Delta t) = A_{+} \\exp\\!\\left(-\\frac{\\Delta t}{\\tau_{+}}\\right)$, and for $\\Delta t < 0$, the synaptic depression is $\\Delta w(\\Delta t) = -A_{-} \\exp\\!\\left(\\frac{\\Delta t}{\\tau_{-}}\\right)$, where $A_{+} > 0$ and $A_{-} > 0$ are amplitude parameters (dimensionless) and $\\tau_{+} > 0$ and $\\tau_{-} > 0$ are time constants (in seconds). All times $\\Delta t$ must be expressed in seconds, and all synaptic changes $\\Delta w$ are dimensionless.\n\nYour program must implement the following, for each test case:\n1. Construct a training dataset of measured $\\Delta w$ values for specified training time differences $\\Delta t$, by starting from a known ground-truth parameter set $(A_{+}, \\tau_{+}, A_{-}, \\tau_{-})$ and adding specified small additive measurement noise to each training $\\Delta w$ value. The measurement noise values are provided and must be added directly (they are dimensionless).\n2. Fit the parameters $(A_{+}, \\tau_{+}, A_{-}, \\tau_{-})$ from the noisy training data by least-squares on the logarithmically transformed magnitudes, consistent with the exponential window assumption.\n3. Using the fitted parameters, predict $\\Delta w$ for a provided validation set of new $\\Delta t$ values (with no noise).\n4. Compute the root-mean-square error (RMSE) between the predicted $\\Delta w$ values and the ground-truth (noise-free) $\\Delta w$ values derived from the known parameter set for the validation $\\Delta t$ values.\n5. Report the RMSE for each test case.\n\nUnits and numerical specification:\n- All $\\Delta t$ values are provided in seconds and must be used as such.\n- All $\\Delta w$ values are dimensionless.\n- Angles do not appear in this problem.\n- The final numerical outputs must be floats rounded to six decimal places.\n\nTest suite:\n- Case 1 (general case with moderate sampling and small noise):\n  - Ground-truth parameters: $A_{+} = 0.0100$, $\\tau_{+} = 0.0200$ s, $A_{-} = 0.0120$, $\\tau_{-} = 0.0250$ s.\n  - Training time differences:\n    - Positive branch ($\\Delta t > 0$): $\\{0.001, 0.005, 0.010, 0.020, 0.030\\}$ s.\n    - Negative branch ($\\Delta t < 0$): $\\{-0.001, -0.005, -0.010, -0.020, -0.030\\}$ s.\n  - Additive measurement noise to training $\\Delta w$ (apply element-wise):\n    - Positive branch: $\\{0.000020, -0.000015, 0.000010, -0.000002, 0.000000\\}$.\n    - Negative branch: $\\{-0.000020, 0.000012, -0.000010, 0.000002, 0.000000\\}$.\n  - Validation time differences:\n    - Positive branch: $\\{0.004, 0.015, 0.025\\}$ s.\n    - Negative branch: $\\{-0.004, -0.015, -0.025\\}$ s.\n- Case 2 (boundary case with minimal sampling and no noise):\n  - Ground-truth parameters: $A_{+} = 0.0120$, $\\tau_{+} = 0.0100$ s, $A_{-} = 0.0110$, $\\tau_{-} = 0.0350$ s.\n  - Training time differences:\n    - Positive branch: $\\{0.005, 0.030\\}$ s.\n    - Negative branch: $\\{-0.005, -0.030\\}$ s.\n  - Additive measurement noise: all zeros for both branches.\n  - Validation time differences:\n    - Positive branch: $\\{0.012\\}$ s.\n    - Negative branch: $\\{-0.012\\}$ s.\n- Case 3 (edge case with asymmetric time constants and small noise):\n  - Ground-truth parameters: $A_{+} = 0.0065$, $\\tau_{+} = 0.0050$ s, $A_{-} = 0.0130$, $\\tau_{-} = 0.0500$ s.\n  - Training time differences:\n    - Positive branch: $\\{0.001, 0.003, 0.007\\}$ s.\n    - Negative branch: $\\{-0.010, -0.030, -0.050\\}$ s.\n  - Additive measurement noise:\n    - Positive branch: $\\{0.000005, -0.000003, 0.000000\\}$.\n    - Negative branch: $\\{0.000020, -0.000010, 0.000000\\}$.\n  - Validation time differences:\n    - Positive branch: $\\{0.0025, 0.0060\\}$ s.\n    - Negative branch: $\\{-0.020, -0.040\\}$ s.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, rounded to six decimal places, in the order of the test cases: $[\\text{rmse\\_case1},\\text{rmse\\_case2},\\text{rmse\\_case3}]$.",
            "solution": "The user wants to solve a model-fitting problem based on the Spike-Timing-Dependent Plasticity (STDP) model.\n\n### 1. Problem Validation\n\nThe problem is first validated against the required criteria.\n\n*   **Extraction of Givens**:\n    *   **Model**: The synaptic weight change $\\Delta w$ is given as a function of the time difference $\\Delta t = t_{\\text{post}} - t_{\\text{pre}}$.\n        *   For potentiation ($\\Delta t > 0$): $\\Delta w(\\Delta t) = A_{+} \\exp(-\\Delta t / \\tau_{+})$.\n        *   For depression ($\\Delta t < 0$): $\\Delta w(\\Delta t) = -A_{-} \\exp(\\Delta t / \\tau_{-})$.\n        *   Parameters are amplitudes $A_{+}, A_{-} > 0$ and time constants $\\tau_{+}, \\tau_{-} > 0$.\n    *   **Task**: A multi-step process involving data generation, parameter fitting, prediction, and error calculation is defined for three distinct test cases.\n        1.  Generate noisy training data from given ground-truth parameters.\n        2.  Fit the four model parameters $(A_{+}, \\tau_{+}, A_{-}, \\tau_{-})$ using least-squares on the log-transformed magnitudes of the training data.\n        3.  Predict $\\Delta w$ for a validation set of $\\Delta t$ values using the fitted parameters.\n        4.  Calculate the Root-Mean-Square Error (RMSE) between these predictions and the noise-free ground-truth values.\n    *   **Data**: All ground-truth parameters, training time differences, additive noise values, and validation time differences are explicitly provided for three separate test cases.\n    *   **Output**: The final result must be a list of RMSE values for the three cases, rounded to six decimal places.\n\n*   **Validation Verdict**:\n    *   **Scientific Grounding**: The problem is based on the standard pair-based exponential model of STDP, a fundamental and well-established concept in computational neuroscience. The model and its parameters are consistent with scientific literature. This criterion is met.\n    *   **Well-Posedness**: The problem is well-posed. The task is to implement a clearly defined numerical procedure. The fitting method, log-linear regression, is specified, which yields a unique solution for the parameters given the data. The provided data sets, even the minimal one in Case 2, contain sufficient points (at least two) to fit a linear model, ensuring a solution exists.\n    *   **Objectivity**: The problem is stated in precise, objective mathematical and procedural terms. All data is numerical, and there are no subjective elements. This criterion is met.\n    *   **Completeness and Consistency**: The problem is self-contained. All necessary formulas, parameters, and data sets are provided. The noise values are small enough that they do not change the sign of the training $\\Delta w$ values, which is crucial for the logarithmic transformation. The setup is consistent and complete.\n\n*   **Conclusion**: The problem is valid. It is a well-defined computational task grounded in established scientific principles. I will proceed to develop the solution.\n\n### 2. Solution Design\n\nThe core of the problem is to fit the parameters of an exponential model by transforming it into a linear one. The positive and negative branches of the STDP curve are independent and can be fitted separately.\n\n*   **Positive Branch ($\\Delta t > 0$)**:\n    *   The model is $\\Delta w = A_{+} \\exp(-\\Delta t / \\tau_{+})$.\n    *   Taking the natural logarithm of both sides yields: $\\ln(\\Delta w) = \\ln(A_{+}) - (1/\\tau_{+}) \\Delta t$.\n    *   This is a linear equation of the form $y = c + m x$, where $y = \\ln(\\Delta w)$, $x = \\Delta t$, the intercept is $c = \\ln(A_{+})$, and the slope is $m = -1/\\tau_{+}$.\n    *   We can perform a linear regression on the training data pairs $(\\Delta t_{\\text{train}}, \\ln(\\Delta w_{\\text{train}}))$ to find the best-fit slope $\\hat{m}_{+}$ and intercept $\\hat{c}_{+}$.\n    *   The fitted parameters are then recovered as: $\\hat{A}_{+} = \\exp(\\hat{c}_{+})$ and $\\hat{\\tau}_{+} = -1/\\hat{m}_{+}$.\n\n*   **Negative Branch ($\\Delta t < 0$)**:\n    *   The model is $\\Delta w = -A_{-} \\exp(\\Delta t / \\tau_{-})$. We work with the magnitude $|\\Delta w| = A_{-} \\exp(\\Delta t / \\tau_{-})$.\n    *   Taking the natural logarithm gives: $\\ln(|\\Delta w|) = \\ln(A_{-}) + (1/\\tau_{-}) \\Delta t$.\n    *   This is again a linear equation $y = c + m x$, where $y = \\ln(|\\Delta w|)$, $x = \\Delta t$, the intercept is $c = \\ln(A_{-})$, and the slope is $m = 1/\\tau_{-}$.\n    *   We perform a linear regression on the training data pairs $(\\Delta t_{\\text{train}}, \\ln(|\\Delta w_{\\text{train}}|))$ to find the best-fit slope $\\hat{m}_{-}$ and intercept $\\hat{c}_{-}$.\n    *   The fitted parameters are recovered as: $\\hat{A}_{-} = \\exp(\\hat{c}_{-})$ and $\\hat{\\tau}_{-} = 1/\\hat{m}_{-}$.\n\n*   **Algorithm for each test case**:\n    1.  **Data Generation**:\n        *   For the positive training $\\Delta t$ values, calculate the ground-truth $\\Delta w$ using the given $A_{+}$ and $\\tau_{+}$. Add the specified noise to get the training $\\Delta w$ values.\n        *   Similarly, for the negative training $\\Delta t$ values, calculate ground-truth $\\Delta w$ using $A_{-}$ and $\\tau_{-}$ and add the corresponding noise.\n    2.  **Parameter Fitting**:\n        *   Using the positive training data $(\\Delta t, \\Delta w)$, compute $(\\Delta t, \\ln(\\Delta w))$ and perform a linear regression (e.g., using `numpy.polyfit` with degree $1$) to obtain $\\hat{m}_{+}$ and $\\hat{c}_{+}$. Calculate $\\hat{A}_{+}$ and $\\hat{\\tau}_{+}$.\n        *   Using the negative training data $(\\Delta t, \\Delta w)$, compute $(\\Delta t, \\ln(|\\Delta w|))$ and perform a linear regression to obtain $\\hat{m}_{-}$ and $\\hat{c}_{-}$. Calculate $\\hat{A}_{-}$ and $\\hat{\\tau}_{-}$.\n    3.  **Prediction**:\n        *   Use the full fitted model with parameters $(\\hat{A}_{+}, \\hat{\\tau}_{+}, \\hat{A}_{-}, \\hat{\\tau}_{-})$ to calculate the predicted $\\Delta w_{\\text{pred}}$ for all $\\Delta t$ values in the validation set.\n    4.  **Error Calculation**:\n        *   Use the ground-truth model with parameters $(A_{+}, \\tau_{+}, A_{-}, \\tau_{-})$ to calculate the true $\\Delta w_{\\text{gt}}$ for all $\\Delta t$ values in the validation set.\n        *   Compute the RMSE: $\\text{RMSE} = \\sqrt{\\text{mean}[(\\Delta w_{\\text{pred}} - \\Delta w_{\\text{gt}})^2]}$.\n    5.  **Output**: Store the calculated RMSE value, rounded to six decimal places.\n\nThis procedure will be implemented for each of the three test cases provided. The case with no noise (Case 2) serves as a control, where the fitted parameters should exactly match the ground-truth parameters, leading to an RMSE of $0$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the STDP model-fitting problem for three test cases.\n    For each case, it:\n    1. Generates noisy training data from ground-truth parameters.\n    2. Fits the STDP model parameters via log-linear regression.\n    3. Predicts weight changes for a validation set using the fitted model.\n    4. Computes the RMSE between predictions and ground-truth values.\n    \"\"\"\n    test_cases = [\n        {\n            \"gt_params\": {\"A_p\": 0.0100, \"tau_p\": 0.0200, \"A_n\": 0.0120, \"tau_n\": 0.0250},\n            \"train_dt_p\": [0.001, 0.005, 0.010, 0.020, 0.030],\n            \"train_dt_n\": [-0.001, -0.005, -0.010, -0.020, -0.030],\n            \"noise_p\": [0.000020, -0.000015, 0.000010, -0.000002, 0.000000],\n            \"noise_n\": [-0.000020, 0.000012, -0.000010, 0.000002, 0.000000],\n            \"val_dt\": [0.004, 0.015, 0.025, -0.004, -0.015, -0.025],\n        },\n        {\n            \"gt_params\": {\"A_p\": 0.0120, \"tau_p\": 0.0100, \"A_n\": 0.0110, \"tau_n\": 0.0350},\n            \"train_dt_p\": [0.005, 0.030],\n            \"train_dt_n\": [-0.005, -0.030],\n            \"noise_p\": [0.0, 0.0],\n            \"noise_n\": [0.0, 0.0],\n            \"val_dt\": [0.012, -0.012],\n        },\n        {\n            \"gt_params\": {\"A_p\": 0.0065, \"tau_p\": 0.0050, \"A_n\": 0.0130, \"tau_n\": 0.0500},\n            \"train_dt_p\": [0.001, 0.003, 0.007],\n            \"train_dt_n\": [-0.010, -0.030, -0.050],\n            \"noise_p\": [0.000005, -0.000003, 0.000000],\n            \"noise_n\": [0.000020, -0.000010, 0.000000],\n            \"val_dt\": [0.0025, 0.0060, -0.020, -0.040],\n        },\n    ]\n\n    results = []\n\n    def stdp_model(dt, A_p, tau_p, A_n, tau_n):\n        \"\"\"Calculates delta_w based on the STDP model.\"\"\"\n        if dt > 0:\n            return A_p * np.exp(-dt / tau_p)\n        elif dt  0:\n            return -A_n * np.exp(dt / tau_n)\n        else:\n            return 0.0\n\n    for case in test_cases:\n        gt_params = case[\"gt_params\"]\n        \n        # 1. Construct training dataset\n        train_dt_p = np.array(case[\"train_dt_p\"])\n        train_dt_n = np.array(case[\"train_dt_n\"])\n        noise_p = np.array(case[\"noise_p\"])\n        noise_n = np.array(case[\"noise_n\"])\n\n        # Positive branch training data\n        dw_gt_p = gt_params[\"A_p\"] * np.exp(-train_dt_p / gt_params[\"tau_p\"])\n        dw_train_p = dw_gt_p + noise_p\n\n        # Negative branch training data\n        dw_gt_n = -gt_params[\"A_n\"] * np.exp(train_dt_n / gt_params[\"tau_n\"])\n        dw_train_n = dw_gt_n + noise_n\n\n        # 2. Fit parameters from noisy training data\n        \n        # Fit positive branch\n        # y = ln(dw) = ln(A_p) - (1/tau_p)*dt. This is a line y = c + m*x\n        # m = -1/tau_p, c = ln(A_p)\n        log_dw_train_p = np.log(dw_train_p)\n        m_p, c_p = np.polyfit(train_dt_p, log_dw_train_p, 1)\n        \n        tau_p_fit = -1 / m_p\n        A_p_fit = np.exp(c_p)\n\n        # Fit negative branch\n        # y = ln(|dw|) = ln(A_n) + (1/tau_n)*dt. This is a line y = c + m*x\n        # m = 1/tau_n, c = ln(A_n)\n        log_abs_dw_train_n = np.log(np.abs(dw_train_n))\n        m_n, c_n = np.polyfit(train_dt_n, log_abs_dw_train_n, 1)\n\n        tau_n_fit = 1 / m_n\n        A_n_fit = np.exp(c_n)\n        \n        fitted_params = {\n            \"A_p\": A_p_fit, \"tau_p\": tau_p_fit, \n            \"A_n\": A_n_fit, \"tau_n\": tau_n_fit\n        }\n\n        # 3. Predict dw for validation set\n        val_dt = np.array(case[\"val_dt\"])\n        dw_pred = np.array([stdp_model(dt, **fitted_params) for dt in val_dt])\n\n        # 4. Compute RMSE against ground-truth values\n        dw_gt_val = np.array([stdp_model(dt, **gt_params) for dt in val_dt])\n        \n        rmse = np.sqrt(np.mean((dw_pred - dw_gt_val)**2))\n        \n        results.append(f\"{rmse:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Advanced STDP models that incorporate triplet and quadruplet interactions offer richer dynamics but also present implementation challenges. This practice  guides you through a critical validation step: comparing the \"ground truth\" outcome from an exact analytical formula with the result of a practical time-stepped numerical simulation. By quantifying the discrepancy, you will gain direct insight into the nature and impact of numerical approximation errors, such as those from the Euler method, when simulating synaptic plasticity.",
            "id": "4007267",
            "problem": "A computational neuroscience validation task is to compare analytical predictions from kernel-based formulations of Spike-Timing-Dependent Plasticity (STDP) with time-stepped simulation results for controlled spike trains across multiple parameter regimes and quantify discrepancies. Spike-Timing-Dependent Plasticity (STDP) is modeled using pre-synaptic and post-synaptic spike trains represented as sums of Dirac delta functions. Let the pre-synaptic spike train be $s_{\\mathrm{pre}}(t) = \\sum_{i} \\delta(t - t^{\\mathrm{pre}}_{i})$ and the post-synaptic spike train be $s_{\\mathrm{post}}(t) = \\sum_{j} \\delta(t - t^{\\mathrm{post}}_{j})$. Let the pre-synaptic trace $x(t)$ and the post-synaptic trace $y(t)$ obey the linear ordinary differential equations $dx/dt = -x/\\tau_{x} + s_{\\mathrm{pre}}(t)$ and $dy/dt = -y/\\tau_{y} + s_{\\mathrm{post}}(t)$, with $x(t)$ and $y(t)$ incremented by $1$ at the times of the respective spikes and decaying exponentially with time constants $\\tau_{x}  0$ and $\\tau_{y}  0$.\n\nThe synaptic weight change $\\Delta w$ accumulates at spike events via three interaction orders:\n- Pair-based interactions: At each post-synaptic spike at time $t^{\\mathrm{post}}_{j}$, an increment $A_{+} \\, x(t^{\\mathrm{post}}_{j})$ is added; at each pre-synaptic spike at time $t^{\\mathrm{pre}}_{i}$, a decrement $A_{-} \\, y(t^{\\mathrm{pre}}_{i})$ is added with a negative sign (i.e., $-A_{-} \\, y(t^{\\mathrm{pre}}_{i})$), where $A_{+} \\ge 0$ and $A_{-} \\ge 0$ are amplitudes.\n- Triplet interactions: At each post-synaptic spike at time $t^{\\mathrm{post}}_{j}$, an increment $A_{3+} \\, x(t^{\\mathrm{post}}_{j}) \\, y(t^{\\mathrm{post}}_{j})$ is added; at each pre-synaptic spike at time $t^{\\mathrm{pre}}_{i}$, a decrement $A_{3-} \\, x(t^{\\mathrm{pre}}_{i}) \\, y(t^{\\mathrm{pre}}_{i})$ is added with a negative sign (i.e., $-A_{3-} \\, x(t^{\\mathrm{pre}}_{i}) \\, y(t^{\\mathrm{pre}}_{i})$), where $A_{3+} \\ge 0$ and $A_{3-} \\ge 0$ are amplitudes.\n- Quadruplet interactions: At each post-synaptic spike at time $t^{\\mathrm{post}}_{j}$, an increment $A_{4+} \\, x(t^{\\mathrm{post}}_{j}) \\, y(t^{\\mathrm{post}}_{j})^{2}$ is added; at each pre-synaptic spike at time $t^{\\mathrm{pre}}_{i}$, a decrement $A_{4-} \\, x(t^{\\mathrm{pre}}_{i})^{2} \\, y(t^{\\mathrm{pre}}_{i})$ is added with a negative sign (i.e., $-A_{4-} \\, x(t^{\\mathrm{pre}}_{i})^{2} \\, y(t^{\\mathrm{pre}}_{i})$), where $A_{4+} \\ge 0$ and $A_{4-} \\ge 0$ are amplitudes.\n\nAnalytical predictions for the traces at spike times follow from the exponential decay solution of the linear ordinary differential equations with delta inputs. Specifically, for any time $t$, the traces satisfy $x(t) = \\sum_{i: t^{\\mathrm{pre}}_{i}  t} \\exp\\!\\big(-(t - t^{\\mathrm{pre}}_{i})/\\tau_{x}\\big)$ and $y(t) = \\sum_{j: t^{\\mathrm{post}}_{j}  t} \\exp\\!\\big(-(t - t^{\\mathrm{post}}_{j})/\\tau_{y}\\big)$, ensuring only strictly earlier spikes contribute before updates at time $t$. Using these expressions, the analytical weight change is obtained by summing the specified pair-based, triplet, and quadruplet increments at all spike times.\n\nA time-stepped numerical simulation is to be implemented using a fixed base step $\\Delta t  0$. Between time grid points, the traces are updated using an explicit Euler step for the decay dynamics, and at exact spike times the updates to the weight $\\Delta w$ are applied using the current trace values just before any increments from spikes occurring at that time, after which the traces are incremented by the number of spikes occurring at that instant. The base step is allowed to be partitioned so that the grid includes all spike times exactly, while keeping explicit Euler updates between consecutive grid points.\n\nYour program must, for each test case, compute:\n- An analytical weight change $\\Delta w_{\\mathrm{analytic}}$ using closed-form trace values at spike times.\n- A simulated weight change $\\Delta w_{\\mathrm{sim}}$ using the explicit Euler method with the described event handling.\n- A discrepancy value defined as the absolute difference $|\\Delta w_{\\mathrm{analytic}} - \\Delta w_{\\mathrm{sim}}|$.\n\nAll spike times must be in seconds, and all time constants in seconds. The synaptic weight change is dimensionless. The final outputs must be floats.\n\nUse the following test suite with controlled spike trains and parameters:\n- Test case $1$ (happy path): pre-synaptic spikes at times $[0.0, 0.03, 0.06]$ seconds; post-synaptic spikes at times $[0.01, 0.04, 0.07]$ seconds; time constants $\\tau_{x} = 0.02$ seconds and $\\tau_{y} = 0.02$ seconds; amplitudes $A_{+} = 0.005$, $A_{-} = 0.006$, $A_{3+} = 0.002$, $A_{3-} = 0.001$, $A_{4+} = 0.0005$, $A_{4-} = 0.0004$; base step $\\Delta t = 0.0005$ seconds.\n- Test case $2$ (synchronous events and symmetry): pre-synaptic spikes at times $[0.0, 0.05]$ seconds; post-synaptic spikes at times $[0.0, 0.05]$ seconds; time constants $\\tau_{x} = 0.02$ seconds and $\\tau_{y} = 0.02$ seconds; amplitudes $A_{+} = 0.010$, $A_{-} = 0.010$, $A_{3+} = 0.002$, $A_{3-} = 0.002$, $A_{4+} = 0.0001$, $A_{4-} = 0.0001$; base step $\\Delta t = 0.001$ seconds.\n- Test case $3$ (fast dynamics, dense spikes): pre-synaptic spikes at times $[0.0, 0.004, 0.008, 0.012]$ seconds; post-synaptic spikes at times $[0.002, 0.006, 0.010]$ seconds; time constants $\\tau_{x} = 0.003$ seconds and $\\tau_{y} = 0.003$ seconds; amplitudes $A_{+} = 0.004$, $A_{-} = 0.004$, $A_{3+} = 0.0015$, $A_{3-} = 0.0010$, $A_{4+} = 0.0003$, $A_{4-} = 0.00025$; base step $\\Delta t = 0.001$ seconds.\n- Test case $4$ (slow dynamics, widely spaced spikes): pre-synaptic spikes at times $[0.0, 0.1, 0.2]$ seconds; post-synaptic spikes at times $[0.05, 0.15, 0.25]$ seconds; time constants $\\tau_{x} = 0.05$ seconds and $\\tau_{y} = 0.05$ seconds; amplitudes $A_{+} = 0.006$, $A_{-} = 0.005$, $A_{3+} = 0.0025$, $A_{3-} = 0.0015$, $A_{4+} = 0.0006$, $A_{4-} = 0.0005$; base step $\\Delta t = 0.002$ seconds.\n\nYour program should produce a single line of output containing the discrepancy results for the four test cases as a comma-separated list enclosed in square brackets (e.g., $[d_{1},d_{2},d_{3},d_{4}]$), where each $d_{k}$ is the absolute difference $|\\Delta w_{\\mathrm{analytic}} - \\Delta w_{\\mathrm{sim}}|$ for test case $k$ expressed as a float with no units.",
            "solution": "The user has provided a computational neuroscience problem requiring the validation of a numerical simulation of a Spike-Timing-Dependent Plasticity (STDP) model against its analytical solution. The model incorporates pair-based, triplet, and quadruplet interactions. The task is to compute the total synaptic weight change $\\Delta w$ using both an analytical formulation and a time-stepped numerical simulation, and then find the absolute difference between the two results for several test cases.\n\n### Problem Validation\n\nFirst, the problem statement must be rigorously validated.\n\n**Step 1: Extracted Givens**\n- Pre-synaptic spike train: $s_{\\mathrm{pre}}(t) = \\sum_{i} \\delta(t - t^{\\mathrm{pre}}_{i})$.\n- Post-synaptic spike train: $s_{\\mathrm{post}}(t) = \\sum_{j} \\delta(t - t^{\\mathrm{post}}_{j})$.\n- Pre-synaptic trace dynamics: $dx/dt = -x/\\tau_{x} + s_{\\mathrm{pre}}(t)$, with $\\tau_{x}  0$.\n- Post-synaptic trace dynamics: $dy/dt = -y/\\tau_{y} + s_{\\mathrm{post}}(t)$, with $\\tau_{y}  0$.\n- Trace update rule: Traces are incremented by $1$ at spike times.\n- Weight change rules ($\\Delta w$):\n  - At post-synaptic spike $t^{\\mathrm{post}}_{j}$: $\\Delta w$ increases by $A_{+} \\, x(t^{\\mathrm{post}}_{j}) + A_{3+} \\, x(t^{\\mathrm{post}}_{j}) \\, y(t^{\\mathrm{post}}_{j}) + A_{4+} \\, x(t^{\\mathrm{post}}_{j}) \\, y(t^{\\mathrm{post}}_{j})^{2}$, where $A_{+}, A_{3+}, A_{4+} \\ge 0$.\n  - At pre-synaptic spike $t^{\\mathrm{pre}}_{i}$: $\\Delta w$ decreases by $A_{-} \\, y(t^{\\mathrm{pre}}_{i}) + A_{3-} \\, x(t^{\\mathrm{pre}}_{i}) \\, y(t^{\\mathrm{pre}}_{i}) + A_{4-} \\, x(t^{\\mathrm{pre}}_{i})^{2} \\, y(t^{\\mathrm{pre}}_{i})$, where $A_{-}, A_{3-}, A_{4-} \\ge 0$.\n- Analytical trace solution: $x(t) = \\sum_{i: t^{\\mathrm{pre}}_{i}  t} \\exp\\!\\big(-(t - t^{\\mathrm{pre}}_{i})/\\tau_{x}\\big)$ and $y(t) = \\sum_{j: t^{\\mathrm{post}}_{j}  t} \\exp\\!\\big(-(t - t^{\\mathrm{post}}_{j})/\\tau_{y}\\big)$.\n- Numerical simulation method: Explicit Euler with a fixed base step $\\Delta t$, where the time grid is guaranteed to include all spike times. Updates to $\\Delta w$ use trace values just before the spike-induced increment, after which traces are incremented.\n- Objective: Compute $\\Delta w_{\\mathrm{analytic}}$, $\\Delta w_{\\mathrm{sim}}$, and the discrepancy $|\\Delta w_{\\mathrm{analytic}} - \\Delta w_{\\mathrm{sim}}|$.\n- Test cases provide specific values for spike times, time constants, amplitudes, and $\\Delta t$.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding**: The problem describes a well-established family of STDP models from computational neuroscience. The differential equations for traces are standard models for leaky integrators, and the pair, triplet, and quadruplet interaction terms are found in the relevant scientific literature (e.g., Pfister  Gerstner, 2006). The problem is scientifically sound.\n- **Well-Posedness and Completeness**: All necessary parameters, initial conditions ($x(0)=0, y(0)=0$), equations, and update rules are explicitly provided. The distinction between the analytical and numerical calculation is clear, as is the order of operations for the simulation (update weight, then update trace). The problem is self-contained and well-posed.\n- **Objectivity and Consistency**: The terminology is precise and objective. There are no contradictions. For instance, the instruction that for the analytical solution \"only strictly earlier spikes contribute\" is a non-ambiguous definition, and the simulation rule to \"use trace values just before any increments\" is likewise clear.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically valid, well-posed, and internally consistent. There are no flaws. Therefore, I will proceed with formulating and implementing the solution.\n\n### Principle-Based Solution Design\n\nThe solution requires implementing two distinct methods to calculate the total synaptic weight change, $\\Delta w$.\n\n**1. Analytical Calculation ($\\Delta w_{\\mathrm{analytic}}$)**\n\nThe analytical calculation relies on the closed-form solutions for the synaptic traces $x(t)$ and $y(t)$. The total weight change is the sum of all individual changes occurring at each spike time.\n\nThe algorithm is as follows:\n1.  Identify the set of all unique spike times, $\\{t_k\\} = \\{t^{\\mathrm{pre}}_{i}\\} \\cup \\{t^{\\mathrm{post}}_{j}\\}$, and sort them chronologically.\n2.  Initialize the total weight change $\\Delta w_{\\mathrm{analytic}} = 0$.\n3.  Iterate through each unique spike time $t_k$ in the sorted list.\n4.  At each $t_k$, calculate the values of the pre-synaptic trace $x(t_k)$ and post-synaptic trace $y(t_k)$ using the provided analytical formulas. These formulas sum the contributions from all spikes that occurred *strictly before* $t_k$:\n    $$x(t_k) = \\sum_{i: t^{\\mathrm{pre}}_{i}  t_k} \\exp\\!\\left(-\\frac{t_k - t^{\\mathrm{pre}}_{i}}{\\tau_{x}}\\right)$$\n    $$y(t_k) = \\sum_{j: t^{\\mathrm{post}}_{j}  t_k} \\exp\\!\\left(-\\frac{t_k - t^{\\mathrm{post}}_{j}}{\\tau_{y}}\\right)$$\n5.  If $t_k$ is a post-synaptic spike time, calculate the potentiation increment and add it to $\\Delta w_{\\mathrm{analytic}}$. If multiple spikes occur at $t_k$, this is applied for each one:\n    $$\\Delta w_{\\mathrm{pot}}(t_k) = A_{+} x(t_k) + A_{3+} x(t_k) y(t_k) + A_{4+} x(t_k) y(t_k)^2$$\n6.  If $t_k$ is a pre-synaptic spike time, calculate the depression decrement and add it to $\\Delta w_{\\mathrm{analytic}}$. Note the overall negative sign:\n    $$\\Delta w_{\\mathrm{dep}}(t_k) = - \\left( A_{-} y(t_k) + A_{3-} x(t_k) y(t_k) + A_{4-} x(t_k)^2 y(t_k) \\right)$$\n7.  The final $\\Delta w_{\\mathrm{analytic}}$ is the sum of all such increments and decrements over all spike times.\n\n**2. Numerical Simulation ($\\Delta w_{\\mathrm{sim}}$)**\n\nThe numerical simulation uses a discrete time-stepping approach with the explicit Euler method to approximate the trace dynamics. The problem specifies a procedure that splits the dynamics into discrete events (spikes) and continuous evolution (decay).\n\nThe algorithm is as follows:\n1.  Determine the maximum simulation time $t_{\\mathrm{max}}$ from the given spike trains.\n2.  Discretize the time into steps of size $\\Delta t$, from $t=0$ to $t_{\\mathrm{max}}$. The test cases are designed such that all spike times are integer multiples of $\\Delta t$, simplifying the grid. We create a mapping from simulation step index $i$ to the number of pre- and post-synaptic spikes occurring at time $t_i = i \\cdot \\Delta t$.\n3.  Initialize traces $x=0$, $y=0$, and total weight change $\\Delta w_{\\mathrm{sim}} = 0$.\n4.  Iterate from step $i=0$ to $i=t_{\\mathrm{max}}/\\Delta t$. At each step, let the current time be $t_i = i \\cdot \\Delta t$. The variables $x$ and $y$ hold the trace values at the beginning of the time step, just before any events at $t_i$ are processed.\n    a.  **Weight Update:** Check for pre- and post-synaptic spikes at time $t_i$. The weight change is calculated using the current trace values, $x$ and $y$.\n        - For each post-synaptic spike: $\\Delta w_{\\mathrm{sim}} \\mathrel{+}= A_{+} x + A_{3+} x y + A_{4+} x y^2$.\n        - For each pre-synaptic spike: $\\Delta w_{\\mathrm{sim}} \\mathrel{-}= A_{-} y + A_{3-} x y + A_{4-} x^2 y$.\n    b.  **Trace Increment:** After the weight update, the traces are instantaneously incremented by the number of spikes at $t_i$. Let $n_{\\mathrm{pre}}$ and $n_{\\mathrm{post}}$ be the spike counts.\n        $$x \\leftarrow x + n_{\\mathrm{pre}}$$\n        $$y \\leftarrow y + n_{\\mathrm{post}}$$\n    c.  **Trace Evolution:** The new trace values are evolved over the interval $\\Delta t$ using the explicit Euler method for the decay dynamics, $dx/dt=-x/\\tau_x$ and $dy/dt=-y/\\tau_y$. The updated values become the trace states for the beginning of the next time step, $t_{i+1}$.\n        $$x \\leftarrow x \\cdot \\left(1 - \\frac{\\Delta t}{\\tau_x}\\right)$$\n        $$y \\leftarrow y \\cdot \\left(1 - \\frac{\\Delta t}{\\tau_y}\\right)$$\n5.  After the loop completes, $\\Delta w_{\\mathrm{sim}}$ holds the total simulated weight change.\n\n**3. Discrepancy Calculation**\n\nThe final required value is the absolute difference between the analytical and simulated results, $|\\Delta w_{\\mathrm{analytic}} - \\Delta w_{\\mathrm{sim}}|$. This difference quantifies the numerical error introduced by the explicit Euler approximation, which approximates the true exponential decay, $e^{-\\Delta t/\\tau}$, with its first-order Taylor expansion, $1 - \\Delta t/\\tau$.\n\nThe following Python code implements these three components for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom collections import Counter\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for the STDP model validation.\n    \"\"\"\n    test_cases = [\n        {\n            \"t_pre\": [0.0, 0.03, 0.06], \"t_post\": [0.01, 0.04, 0.07],\n            \"tau_x\": 0.02, \"tau_y\": 0.02,\n            \"A_p\": 0.005, \"A_m\": 0.006, \"A_3p\": 0.002, \"A_3m\": 0.001,\n            \"A_4p\": 0.0005, \"A_4m\": 0.0004, \"dt\": 0.0005\n        },\n        {\n            \"t_pre\": [0.0, 0.05], \"t_post\": [0.0, 0.05],\n            \"tau_x\": 0.02, \"tau_y\": 0.02,\n            \"A_p\": 0.010, \"A_m\": 0.010, \"A_3p\": 0.002, \"A_3m\": 0.002,\n            \"A_4p\": 0.0001, \"A_4m\": 0.0001, \"dt\": 0.001\n        },\n        {\n            \"t_pre\": [0.0, 0.004, 0.008, 0.012], \"t_post\": [0.002, 0.006, 0.010],\n            \"tau_x\": 0.003, \"tau_y\": 0.003,\n            \"A_p\": 0.004, \"A_m\": 0.004, \"A_3p\": 0.0015, \"A_3m\": 0.0010,\n            \"A_4p\": 0.0003, \"A_4m\": 0.00025, \"dt\": 0.001\n        },\n        {\n            \"t_pre\": [0.0, 0.1, 0.2], \"t_post\": [0.05, 0.15, 0.25],\n            \"tau_x\": 0.05, \"tau_y\": 0.05,\n            \"A_p\": 0.006, \"A_m\": 0.005, \"A_3p\": 0.0025, \"A_3m\": 0.0015,\n            \"A_4p\": 0.0006, \"A_4m\": 0.0005, \"dt\": 0.002\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        dw_analytic = calculate_analytic_dw(**params)\n        dw_sim = calculate_simulated_dw(**params)\n        discrepancy = abs(dw_analytic - dw_sim)\n        results.append(discrepancy)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_analytic_dw(t_pre, t_post, tau_x, tau_y, A_p, A_m, A_3p, A_3m, A_4p, A_4m, dt):\n    \"\"\"\n    Calculates the total weight change using the analytical formulas.\n    \"\"\"\n    t_pre_np = np.array(t_pre)\n    t_post_np = np.array(t_post)\n    \n    all_spike_times = sorted(list(set(t_pre) | set(t_post)))\n    \n    delta_w = 0.0\n\n    post_spike_counts = Counter(t_post)\n    pre_spike_counts = Counter(t_pre)\n\n    for t_event in all_spike_times:\n        # Calculate traces using spikes that occurred strictly before t_event\n        pre_spikes_before = t_pre_np[t_pre_np  t_event]\n        post_spikes_before = t_post_np[t_post_np  t_event]\n\n        x_t = np.sum(np.exp(-(t_event - pre_spikes_before) / tau_x)) if pre_spikes_before.size > 0 else 0.0\n        y_t = np.sum(np.exp(-(t_event - post_spikes_before) / tau_y)) if post_spikes_before.size > 0 else 0.0\n\n        # Process post-synaptic events at t_event\n        if t_event in post_spike_counts:\n            num_spikes = post_spike_counts[t_event]\n            dw_potentiation = A_p * x_t + A_3p * x_t * y_t + A_4p * x_t * y_t**2\n            delta_w += num_spikes * dw_potentiation\n\n        # Process pre-synaptic events at t_event\n        if t_event in pre_spike_counts:\n            num_spikes = pre_spike_counts[t_event]\n            dw_depression = A_m * y_t + A_3m * x_t * y_t + A_4m * x_t**2 * y_t\n            delta_w -= num_spikes * dw_depression\n            \n    return delta_w\n\ndef calculate_simulated_dw(t_pre, t_post, tau_x, tau_y, A_p, A_m, A_3p, A_3m, A_4p, A_4m, dt):\n    \"\"\"\n    Calculates the total weight change using time-stepped simulation.\n    \"\"\"\n    all_times = list(set(t_pre) | set(t_post))\n    if not all_times:\n        return 0.0\n    \n    t_max = max(all_times)\n\n    # Use rounding to map spike times to integer grid indices robustly\n    pre_spike_indices = {int(round(t / dt)): count for t, count in Counter(t_pre).items()}\n    post_spike_indices = {int(round(t / dt)): count for t, count in Counter(t_post).items()}\n    \n    num_steps = int(round(t_max / dt)) + 1\n    \n    x, y, delta_w = 0.0, 0.0, 0.0\n\n    for i in range(num_steps):\n        # x and y represent the trace values at the beginning of the step t=i*dt,\n        # evolved from the previous step.\n\n        # Check for spikes at current time step i and update weight\n        n_post = post_spike_indices.get(i, 0)\n        n_pre = pre_spike_indices.get(i, 0)\n\n        if n_post > 0:\n            dw_potentiation = A_p * x + A_3p * x * y + A_4p * x * y**2\n            delta_w += n_post * dw_potentiation\n        if n_pre > 0:\n            dw_depression = A_m * y + A_3m * x * y + A_4m * x**2 * y\n            delta_w -= n_pre * dw_depression\n\n        # Instantaneously increment traces due to spikes\n        x += n_pre\n        y += n_post\n\n        # Evolve traces over dt using explicit Euler method for the next step\n        x *= (1.0 - dt / tau_x)\n        y *= (1.0 - dt / tau_y)\n\n    return delta_w\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "In discrete-time simulations, the handling of simultaneous events can dramatically alter a model's behavior, a nuance often overlooked in theoretical descriptions. This exercise  challenges you to analyze the impact of the order of updates when a presynaptic and postsynaptic spike arrive at the exact same time in a complex triplet/quadruplet model. Calculating the net weight change, $ \\Delta w_{\\text{net}} $, under different policies reveals how seemingly arbitrary implementation choices can determine whether a synapse potentiates or depresses, highlighting the importance of precise algorithmic specification.",
            "id": "4007284",
            "problem": "A pair-based, triplet, and quadruplet spike-timing-dependent plasticity (STDP) model is implemented using event-triggered updates and exponentially decaying traces. Spike-Timing-Dependent Plasticity (STDP) assigns a synaptic weight change $\\Delta w$ at presynaptic and postsynaptic spike times according to local, causal measurements obtained from decaying traces: a presynaptic trace $x(t)$ and a postsynaptic trace $y(t)$, together with slower traces $x_s(t)$ and $y_s(t)$ that capture burst-like or higher-order temporal context. Long-Term Potentiation (LTP) is applied at postsynaptic spike times and Long-Term Depression (LTD) is applied at presynaptic spike times. The following event-based rules are used:\n\n- At a postsynaptic spike at time $t$, LTP is computed from the current traces and then the postsynaptic traces are incremented:\n  $$\\Delta w_{\\text{post}}(t) = +A_{+}\\,x(t) + A_{3+}\\,x(t)\\,y_s(t) + A_{4+}\\,x(t)\\,y(t)\\,y_s(t),$$\n  followed by\n  $$y(t) \\leftarrow y(t) + 1,\\quad y_s(t) \\leftarrow y_s(t) + 1.$$\n\n- At a presynaptic spike at time $t$, LTD is computed from the current traces and then the presynaptic traces are incremented:\n  $$\\Delta w_{\\text{pre}}(t) = -A_{-}\\,y(t) - A_{3-}\\,y(t)\\,x_s(t) - A_{4-}\\,y(t)\\,x(t)\\,x_s(t),$$\n  followed by\n  $$x(t) \\leftarrow x(t) + 1,\\quad x_s(t) \\leftarrow x_s(t) + 1.$$\n\nBetween spikes, traces decay exponentially, but for this problem no inter-spike decay occurs within the time window of interest. Consider a near-simultaneous presynaptic spike and postsynaptic spike arriving at the exact same timestamp $t_0$. Two order-of-updates policies are possible when both events occupy the same discrete time bin:\n\n- Policy $\\mathcal{P}_{\\text{pre}\\rightarrow\\text{post}}$: handle the presynaptic spike first at time $t_0$, then the postsynaptic spike at time $t_0$.\n- Policy $\\mathcal{P}_{\\text{post}\\rightarrow\\text{pre}}$: handle the postsynaptic spike first at time $t_0$, then the presynaptic spike at time $t_0$.\n\nImmediately before $t_0$, the traces and parameters have the following values:\n$$x(t_0^{-}) = 0.30,\\quad y(t_0^{-}) = 0.25,\\quad x_s(t_0^{-}) = 0.50,\\quad y_s(t_0^{-}) = 0.20,$$\n$$A_{+} = 0.010,\\quad A_{-} = 0.012,\\quad A_{3+} = 0.006,\\quad A_{3-} = 0.004,\\quad A_{4+} = 0.003,\\quad A_{4-} = 0.002.$$\n\nAssume the convention that at each spike event the weight update uses the trace values as they exist at the instant of that event, and only after computing the eventâ€™s $\\Delta w$ does the corresponding trace increment occur. Compute the net weight change $\\Delta w_{\\text{net}}$ at $t_0$ under each policy, and identify the correct statement below about the sign and approximate magnitude of $\\Delta w_{\\text{net}}$ for each policy.\n\nA. Under $\\mathcal{P}_{\\text{pre}\\rightarrow\\text{post}}$, $\\Delta w_{\\text{net}} \\approx +0.01118$ (potentiation); under $\\mathcal{P}_{\\text{post}\\rightarrow\\text{pre}}$, $\\Delta w_{\\text{net}} \\approx -0.01447$ (depression).\n\nB. Both policies yield identical $\\Delta w_{\\text{net}} \\approx 0$, because simultaneous spikes abolish causality and higher-order terms cancel.\n\nC. Under $\\mathcal{P}_{\\text{pre}\\rightarrow\\text{post}}$, $\\Delta w_{\\text{net}} \\approx -0.01788$ (depression); under $\\mathcal{P}_{\\text{post}\\rightarrow\\text{pre}}$, $\\Delta w_{\\text{net}} \\approx +0.00341$ (potentiation).\n\nD. The policy choice affects only the quadruplet term slightly, so the difference is negligible and $\\Delta w_{\\text{net}}$ differs by approximately $0.00005$ between policies; the pair-based contribution is identical under both policies.",
            "solution": "To determine the net weight change, $\\Delta w_{\\text{net}}$, under each policy, we must carefully apply the update rules in the specified order. The net change is the sum of the change from the presynaptic event, $\\Delta w_{\\text{pre}}$, and the postsynaptic event, $\\Delta w_{\\text{post}}$.\n\nThe initial state of the traces immediately before the spikes at time $t_0$ is given as:\n*   $x(t_0^{-}) = 0.30$\n*   $y(t_0^{-}) = 0.25$\n*   $x_s(t_0^{-}) = 0.50$\n*   $y_s(t_0^{-}) = 0.20$\n\nAnd the parameters are:\n*   $A_{+} = 0.010, A_{-} = 0.012$\n*   $A_{3+} = 0.006, A_{3-} = 0.004$\n*   $A_{4+} = 0.003, A_{4-} = 0.002$\n\n### Analysis of Policy $\\mathcal{P}_{\\text{pre}\\rightarrow\\text{post}}$ (Presynaptic First)\n\n1.  **Handle Presynaptic Spike:** The LTD is calculated using the initial trace values.\n    $$ \\Delta w_{\\text{pre}} = -A_{-}\\,y(t_0^{-}) - A_{3-}\\,y(t_0^{-})\\,x_s(t_0^{-}) - A_{4-}\\,y(t_0^{-})\\,x(t_0^{-})\\,x_s(t_0^{-}) $$\n    $$ \\Delta w_{\\text{pre}} = -(0.012)(0.25) - (0.004)(0.25)(0.50) - (0.002)(0.25)(0.30)(0.50) $$\n    $$ \\Delta w_{\\text{pre}} = -0.003 - 0.0005 - 0.000075 = -0.003575 $$\n    After this, the presynaptic traces are incremented:\n    *   $x(t_0) = x(t_0^{-}) + 1 = 1.30$\n    *   $x_s(t_0) = x_s(t_0^{-}) + 1 = 1.50$\n\n2.  **Handle Postsynaptic Spike:** The LTP is calculated using the *updated* presynaptic traces. The postsynaptic traces are still at their initial values.\n    $$ \\Delta w_{\\text{post}} = +A_{+}\\,x(t_0) + A_{3+}\\,x(t_0)\\,y_s(t_0^{-}) + A_{4+}\\,x(t_0)\\,y(t_0^{-})\\,y_s(t_0^{-}) $$\n    $$ \\Delta w_{\\text{post}} = (0.010)(1.30) + (0.006)(1.30)(0.20) + (0.003)(1.30)(0.25)(0.20) $$\n    $$ \\Delta w_{\\text{post}} = 0.013 + 0.00156 + 0.000195 = +0.014755 $$\n\n3.  **Net Change:**\n    $$ \\Delta w_{\\text{net}} = \\Delta w_{\\text{pre}} + \\Delta w_{\\text{post}} = -0.003575 + 0.014755 = +0.01118 $$\nThis policy results in net potentiation.\n\n### Analysis of Policy $\\mathcal{P}_{\\text{post}\\rightarrow\\text{pre}}$ (Postsynaptic First)\n\n1.  **Handle Postsynaptic Spike:** The LTP is calculated using the initial trace values.\n    $$ \\Delta w_{\\text{post}} = +A_{+}\\,x(t_0^{-}) + A_{3+}\\,x(t_0^{-})\\,y_s(t_0^{-}) + A_{4+}\\,x(t_0^{-})\\,y(t_0^{-})\\,y_s(t_0^{-}) $$\n    $$ \\Delta w_{\\text{post}} = (0.010)(0.30) + (0.006)(0.30)(0.20) + (0.003)(0.30)(0.25)(0.20) $$\n    $$ \\Delta w_{\\text{post}} = 0.003 + 0.00036 + 0.000045 = +0.003405 $$\n    After this, the postsynaptic traces are incremented:\n    *   $y(t_0) = y(t_0^{-}) + 1 = 1.25$\n    *   $y_s(t_0) = y_s(t_0^{-}) + 1 = 1.20$\n\n2.  **Handle Presynaptic Spike:** The LTD is calculated using the *updated* postsynaptic traces. The presynaptic traces are still at their initial values.\n    $$ \\Delta w_{\\text{pre}} = -A_{-}\\,y(t_0) - A_{3-}\\,y(t_0)\\,x_s(t_0^{-}) - A_{4-}\\,y(t_0)\\,x(t_0^{-})\\,x_s(t_0^{-}) $$\n    $$ \\Delta w_{\\text{pre}} = -(0.012)(1.25) - (0.004)(1.25)(0.50) - (0.002)(1.25)(0.30)(0.50) $$\n    $$ \\Delta w_{\\text{pre}} = -0.015 - 0.0025 - 0.000375 = -0.017875 $$\n\n3.  **Net Change:**\n    $$ \\Delta w_{\\text{net}} = \\Delta w_{\\text{post}} + \\Delta w_{\\text{pre}} = +0.003405 - 0.017875 = -0.01447 $$\nThis policy results in net depression.\n\n### Conclusion\n\nThe calculations show that:\n*   Under policy $\\mathcal{P}_{\\text{pre}\\rightarrow\\text{post}}$, the net weight change is $\\approx +0.01118$ (potentiation).\n*   Under policy $\\mathcal{P}_{\\text{post}\\rightarrow\\text{pre}}$, the net weight change is $\\approx -0.01447$ (depression).\n\nThese results directly match the values presented in option A.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}