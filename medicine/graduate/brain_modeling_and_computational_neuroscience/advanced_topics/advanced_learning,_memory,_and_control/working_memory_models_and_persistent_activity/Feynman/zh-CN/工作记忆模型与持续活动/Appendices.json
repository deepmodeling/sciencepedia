{
    "hands_on_practices": [
        {
            "introduction": "我们从工作记忆的基础模型——线性循环网络开始。本练习揭示了吸引子假说的核心原理，即网络的内部连接如何在外部刺激消失后维持活动。通过运用线性系统理论 ，你将推导出网络连接性所需满足的基本条件，从而使其能够作为一种记忆装置。",
            "id": "4033660",
            "problem": "考虑一个用于工作记忆的线性循环速率网络模型，该模型包含 $N$ 个单元，其活动向量 $\\mathbf{x}(t) \\in \\mathbb{R}^{N}$ 的演化遵循以下方程\n$$\n\\tau \\,\\dot{\\mathbf{x}}(t) \\,=\\, -\\mathbf{x}(t) + J\\,\\mathbf{x}(t) + \\mathbf{I}(t),\n$$\n其中 $\\tau > 0$ 是单细胞膜时间常数，$J \\in \\mathbb{R}^{N \\times N}$ 是突触连接矩阵，$\\mathbf{I}(t)$ 是一个外部输入，它在 $t  t_{0}$ 时编码一个刺激，并在 $t \\geq t_{0}$ 时被移除，因此在延迟期间 $\\mathbf{I}(t) = \\mathbf{0}$。工作记忆问题在于，网络在输入被移除后是表现出持续活动、边缘积分还是活动衰减。对于具有常数 $A$ 的线性自治系统 $\\dot{\\mathbf{x}}(t) = A\\,\\mathbf{x}(t)$，其通解由 $A$ 的谱通过矩阵指数确定，而系统的长期行为则由具有最大实部的特征值决定。\n\n从网络方程和线性动力系统的基本性质出发，重新表述延迟期间的自治动力学，推导有效系统矩阵的谱如何控制渐近行为，并推导 $J$ 的最大特征值满足以下三种情况的条件：(i) 持续活动，此处定义为在 $t \\geq t_{0}$ 时沿至少一个模式的活动不衰减或增长；(ii) 边缘积分，定义为沿至少一个模式既不增长也不衰减（渐近恒定振幅）；(iii) 衰减，定义为所有模式的活动随时间消失。令 $\\lambda_{\\max} \\equiv \\max_{i} \\Re \\lambda_{i}(J)$ 表示 $J$ 的特征值 $\\lambda_{i}(J)$ 中最大的实部。\n\n最后，计算主导指数速率常数 $r_{\\mathrm{dom}}$，该常数决定了沿具有最大实部的模式的渐近指数增长或衰减，并用 $\\tau$ 和 $\\lambda_{\\max}$ 表示。将 $r_{\\mathrm{dom}}$ 以 $\\mathrm{s}^{-1}$ 为单位表示。你的最终答案必须是 $r_{\\mathrm{dom}}$ 的一个单一闭式表达式。",
            "solution": "用户希望分析一个线性循环速率网络模型，并推导不同动态行为的条件，最终求出主导指数速率常数。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n\n问题提供了以下信息：\n- 网络活动向量 $\\mathbf{x}(t) \\in \\mathbb{R}^{N}$ 根据以下微分方程演化：\n$$\n\\tau \\,\\dot{\\mathbf{x}}(t) \\,=\\, -\\mathbf{x}(t) + J\\,\\mathbf{x}(t) + \\mathbf{I}(t)\n$$\n- $\\tau  0$ 是单细胞膜时间常数。\n- $J \\in \\mathbb{R}^{N \\times N}$ 是突触连接矩阵。\n- $\\mathbf{I}(t)$ 是一个外部输入，在 $t \\geq t_0$（延迟期间）时为零。\n- 感兴趣的三种行为定义如下：\n  - (i) **持续活动**：在 $t \\geq t_{0}$ 时，沿至少一个模式的活动不衰减或增长。\n  - (ii) **边缘积分**：沿至少一个模式既不增长也不衰减（渐近恒定振幅）。\n  - (iii) **衰减**：所有模式的活动随时间消失。\n- 符号 $\\lambda_{\\max} \\equiv \\max_{i} \\Re \\lambda_{i}(J)$ 表示 $J$ 的特征值 $\\lambda_{i}(J)$ 中最大的实部。\n- 目标是重新表述动力学，推导关于 $\\lambda_{\\max}$ 的三种行为的条件，并计算主导指数速率常数 $r_{\\mathrm{dom}}$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据**：该模型是计算神经科学中用于研究网络动力学和工作记忆的标准线性速率模型。使用线性系统理论和特征值进行分析是针对此模型的基本且正确的方法。该问题在科学上是合理的。\n- **适定性**：问题陈述清晰。给出了控制方程，指明了延迟期间的条件，并提供了动力学机制的定义。它要求进行特定的推导并求出最终量 $r_{\\mathrm{dom}}$，该量可以根据给定信息唯一确定。\n- **客观性**：问题使用精确的数学语言和公认的科学术语表达，没有主观性或歧义。\n\n**1.3. 结论与行动**\n\n该问题是有效的，因为它具有科学依据、适定且客观。没有矛盾、信息缺失或其他缺陷。我将继续进行求解。\n\n### 步骤2：解题推导\n\n分析始于网络的动力学方程：\n$$\n\\tau \\,\\dot{\\mathbf{x}}(t) \\,=\\, -\\mathbf{x}(t) + J\\,\\mathbf{x}(t) + \\mathbf{I}(t)\n$$\n问题指出，在延迟期间（即 $t \\geq t_0$），外部输入被移除，因此 $\\mathbf{I}(t) = \\mathbf{0}$。所以，延迟期间的动力学方程为：\n$$\n\\tau \\,\\dot{\\mathbf{x}}(t) \\,=\\, -\\mathbf{x}(t) + J\\,\\mathbf{x}(t)\n$$\n我们可以将右侧的活动向量 $\\mathbf{x}(t)$ 提取出来。令 $I$ 为 $N \\times N$ 单位矩阵，我们有：\n$$\n\\tau \\,\\dot{\\mathbf{x}}(t) \\,=\\, (J - I)\\,\\mathbf{x}(t)\n$$\n为了将其重构为线性自治系统的标准形式 $\\dot{\\mathbf{x}}(t) = A\\,\\mathbf{x}(t)$，我们除以时间常数 $\\tau$（这是允许的，因为 $\\tau  0$）：\n$$\n\\dot{\\mathbf{x}}(t) \\,=\\, \\frac{1}{\\tau}(J - I)\\,\\mathbf{x}(t)\n$$\n这就是延迟期间重构后的自治系统。有效系统矩阵为 $A = \\frac{1}{\\tau}(J - I)$。\n\n该线性系统的通解由矩阵指数给出：\n$$\n\\mathbf{x}(t) = \\exp(A(t - t_0))\\,\\mathbf{x}(t_0)\n$$\n其中 $\\mathbf{x}(t_0)$ 是网络在延迟期开始时的状态。当 $t \\to \\infty$ 时，系统的渐近行为由矩阵 $A$ 的特征值决定。设 $A$ 的特征值为 $\\mu_i$。解可以表示为与这些特征值相关的模式的叠加。长期行为由对应于最大实部特征值的模式主导，我们将其表示为 $\\mu_{\\max} = \\max_i \\Re(\\mu_i)$。\n\n我们需要将 $A$ 的特征值 $\\mu_i$ 与连接矩阵 $J$ 的特征值 $\\lambda_i$ 联系起来。设 $v_i$ 是 $J$ 的一个特征向量，对应于特征值 $\\lambda_i$，使得 $Jv_i = \\lambda_i v_i$。我们可以将矩阵 $A$ 应用于这个特征向量 $v_i$：\n$$\nA\\,v_i = \\frac{1}{\\tau}(J - I)\\,v_i = \\frac{1}{\\tau}(Jv_i - Iv_i) = \\frac{1}{\\tau}(\\lambda_i v_i - v_i) = \\frac{\\lambda_i - 1}{\\tau} v_i\n$$\n这表明 $v_i$ 也是 $A$ 的一个特征向量，其对应的特征值为 $\\mu_i = \\frac{\\lambda_i - 1}{\\tau}$。这个关系对所有特征值都成立。\n\n每个特征值 $\\mu_i$ 的实部由下式给出：\n$$\n\\Re(\\mu_i) = \\Re\\left(\\frac{\\lambda_i - 1}{\\tau}\\right)\n$$\n由于 $\\tau$ 是一个正实数，我们可以写出：\n$$\n\\Re(\\mu_i) = \\frac{\\Re(\\lambda_i) - 1}{\\tau}\n$$\n因此，$A$ 的具有最大实部的特征值 $\\mu_{\\max}$ 与 $J$ 的具有最大实部的特征值 $\\lambda_{\\max} \\equiv \\max_i \\Re(\\lambda_i(J))$ 的关系如下：\n$$\n\\mu_{\\max} = \\max_i \\Re(\\mu_i) = \\max_i \\left( \\frac{\\Re(\\lambda_i) - 1}{\\tau} \\right) = \\frac{(\\max_i \\Re(\\lambda_i)) - 1}{\\tau} = \\frac{\\lambda_{\\max} - 1}{\\tau}\n$$\n系统的渐近行为取决于 $\\mu_{\\max}$ 的符号：\n- 如果 $\\mu_{\\max}  0$，主导模式呈指数增长，导致活动无界。\n- 如果 $\\mu_{\\max} = 0$，主导模式具有恒定振幅（或以恒定振幅振荡），而所有其他模式要么稳定要么衰减。\n- 如果 $\\mu_{\\max}  0$，所有模式都呈指数衰减至零。\n\n现在我们可以为三种指定的行为推导出关于 $\\lambda_{\\max}$ 的条件：\n\n(i) **持续活动**：这被定义为不衰减或增长的活动。这对应于活动不消失的情况，要求至少有一个模式不衰减。这种情况发生在 $\\mu_{\\max} \\geq 0$ 时。\n$$\n\\frac{\\lambda_{\\max} - 1}{\\tau} \\geq 0 \\quad \\implies \\quad \\lambda_{\\max} - 1 \\geq 0 \\quad \\implies \\quad \\lambda_{\\max} \\geq 1\n$$\n\n(ii) **边缘积分**：这被定义为既不增长也不衰减。这对应于一个系统，其主导模式是稳定的但不衰减，即它有一个纯虚特征值，而所有其他特征值都具有非正实部。这正是 $\\mu_{\\max} = 0$ 的情况。\n$$\n\\frac{\\lambda_{\\max} - 1}{\\tau} = 0 \\quad \\implies \\quad \\lambda_{\\max} - 1 = 0 \\quad \\implies \\quad \\lambda_{\\max} = 1\n$$\n\n(iii) **衰减**：这被定义为活动随时间消失。这要求所有模式都呈指数衰减，这种情况发生在 $\\mu_{\\max}  0$ 时。\n$$\n\\frac{\\lambda_{\\max} - 1}{\\tau}  0 \\quad \\implies \\quad \\lambda_{\\max} - 1  0 \\quad \\implies \\quad \\lambda_{\\max}  1\n$$\n这三个关于 $\\lambda_{\\max}$ 的条件对网络在延迟期间的长期行为进行了分类。\n\n最后，我们被要求计算主导指数速率常数 $r_{\\mathrm{dom}}$。沿主导模式的活动演化与 $\\exp(\\mu_{\\max} t)$ 成正比。这种指数演化的速率常数就是 $\\mu_{\\max}$。因此，$r_{\\mathrm{dom}} = \\mu_{\\max}$。\n代入我们找到的用 $\\lambda_{\\max}$ 和 $\\tau$ 表示的 $\\mu_{\\max}$ 表达式：\n$$\nr_{\\mathrm{dom}} = \\frac{\\lambda_{\\max} - 1}{\\tau}\n$$\n鉴于 $\\tau$ 的单位是时间（例如，秒，s），而 $\\lambda_{\\max}$ 是一个无量纲的特征值，所以 $r_{\\mathrm{dom}}$ 的单位是时间的倒数（例如，s$^{-1}$），符合要求。",
            "answer": "$$\n\\boxed{\\frac{\\lambda_{\\max} - 1}{\\tau}}\n$$"
        },
        {
            "introduction": "虽然线性模型提供了关键的洞见，但真实的神经回路依赖于兴奋和抑制之间精妙的平衡。本练习将探讨一个双种群（兴奋性-抑制性）速率模型，这是皮层回路建模的基石 。你的任务是分析并确定，为了稳定一个本身不稳定的兴奋性种群，需要多强的反馈抑制，从而揭示一个创造稳定记忆状态的关键机制。",
            "id": "4033663",
            "problem": "考虑一个用于描述工作记忆（WM）的局部皮层微回路的标准双群体速率模型，该模型包含一个兴奋性群体和一个抑制性群体。围绕一个不动点对动力学进行线性化，以获得关于小偏差 $\\delta r_{E}(t)$ 和 $\\delta r_{I}(t)$ 的系统：\n$$\n\\tau_{E}\\,\\frac{d}{dt}\\,\\delta r_{E}(t) \\;=\\; -\\,\\delta r_{E}(t) \\;+\\; w_{EE}\\,\\delta r_{E}(t) \\;-\\; w_{EI}\\,\\delta r_{I}(t),\n$$\n$$\n\\tau_{I}\\,\\frac{d}{dt}\\,\\delta r_{I}(t) \\;=\\; -\\,\\delta r_{I}(t) \\;+\\; w_{IE}\\,\\delta r_{E}(t) \\;-\\; w_{II}\\,\\delta r_{I}(t).\n$$\n这里 $\\tau_{E} \\,\\, 0$ 和 $\\tau_{I} \\,\\, 0$ 是时间常数，而 $w_{EE}, w_{EI}, w_{IE}, w_{II}$ 是非负的突触增益。假设存在兴奋性爆发趋势 $w_{EE} \\,\\, 1$，并设 $w_{EI} \\,\\, 0$，$w_{IE} \\,\\, 0$，$w_{II} \\,\\ge\\, 0$。你可以假设参数满足\n$$\n\\frac{w_{EE}-1}{\\tau_{E}} \\;  \\; \\frac{1+w_{II}}{\\tau_{I}},\n$$\n因此，任何可能的镇定（如果可实现的话）都不会因为雅可比矩阵的正迹而被排除。\n\n仅使用动力系统的线性稳定性第一性原理，并且不借助任何预先指定的快捷公式，确定临界的兴奋性到抑制性增益 $w_{IE}^{\\star}$，该增益将雅可比矩阵的特征值置于复平面的闭合左半平面，从而对兴奋性爆发进行临界镇定。将你的最终答案表示为关于 $w_{EE}$、$w_{EI}$ 和 $w_{II}$ 的闭式符号表达式。不需要进行数值舍入，最终答案是无量纲的。",
            "solution": "该问题要求找到突触增益 $w_{IE}$ 的临界值，记为 $w_{IE}^{\\star}$，该值使得线性化的双群体神经速率模型达到临界稳定。分析将从动力系统的线性稳定性理论的第一性原理出发。\n\n偏离不动点的小偏差 $\\delta r_{E}(t)$ 和 $\\delta r_{I}(t)$ 的动力学由以下线性常微分方程组给出：\n$$\n\\tau_{E}\\,\\frac{d}{dt}\\,\\delta r_{E}(t) \\;=\\; (w_{EE}-1)\\,\\delta r_{E}(t) \\;-\\; w_{EI}\\,\\delta r_{I}(t)\n$$\n$$\n\\tau_{I}\\,\\frac{d}{dt}\\,\\delta r_{I}(t) \\;=\\; w_{IE}\\,\\delta r_{E}(t) \\;-\\; (1+w_{II})\\,\\delta r_{I}(t)\n$$\n我们可以将此系统表示为标准矩阵形式 $\\frac{d}{dt}\\mathbf{x}(t) = \\mathbf{J}\\mathbf{x}(t)$，其中 $\\mathbf{x}(t)$ 是状态向量，$\\mathbf{J}$ 是系统在不动点处评估的雅可比矩阵。首先，我们重新整理方程以分离出时间导数：\n$$\n\\frac{d}{dt}\\,\\delta r_{E}(t) \\;=\\; \\frac{w_{EE}-1}{\\tau_{E}}\\,\\delta r_{E}(t) \\;-\\; \\frac{w_{EI}}{\\tau_{E}}\\,\\delta r_{I}(t)\n$$\n$$\n\\frac{d}{dt}\\,\\delta r_{I}(t) \\;=\\; \\frac{w_{IE}}{\\tau_{I}}\\,\\delta r_{E}(t) \\;-\\; \\frac{1+w_{II}}{\\tau_{I}}\\,\\delta r_{I}(t)\n$$\n状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} \\delta r_{E}(t) \\\\ \\delta r_{I}(t) \\end{pmatrix}$。因此，雅可比矩阵 $\\mathbf{J}$ 为：\n$$\n\\mathbf{J} = \\begin{pmatrix}\n\\frac{w_{EE}-1}{\\tau_{E}}  -\\frac{w_{EI}}{\\tau_{E}} \\\\\n\\frac{w_{IE}}{\\tau_{I}}  -\\frac{1+w_{II}}{\\tau_{I}}\n\\end{pmatrix}\n$$\n不动点的稳定性由雅可比矩阵 $\\mathbf{J}$ 的特征值 $\\lambda$ 决定。特征值是特征方程 $\\det(\\mathbf{J} - \\lambda\\mathbf{I}) = 0$ 的根，其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。对于一个二维系统，该方程可以写成一般形式：\n$$\n\\lambda^2 - \\text{Tr}(\\mathbf{J})\\lambda + \\det(\\mathbf{J}) = 0\n$$\n为使不动点稳定，所有特征值的实部都必须为负，即 $\\text{Re}(\\lambda)  0$。对于一个二维系统，其稳定性的充要条件（劳斯-赫尔维茨判据）是：\n1. $\\text{Tr}(\\mathbf{J})  0$\n2. $\\det(\\mathbf{J})  0$\n\n让我们计算 $\\mathbf{J}$ 的迹和行列式。迹是主对角线元素之和：\n$$\n\\text{Tr}(\\mathbf{J}) = \\frac{w_{EE}-1}{\\tau_{E}} - \\frac{1+w_{II}}{\\tau_{I}}\n$$\n问题陈述中给出的条件是 $\\frac{w_{EE}-1}{\\tau_{E}}  \\frac{1+w_{II}}{\\tau_{I}}$，这等价于 $\\frac{w_{EE}-1}{\\tau_{E}} - \\frac{1+w_{II}}{\\tau_{I}}  0$。因此，根据假设，条件 $\\text{Tr}(\\mathbf{J})  0$ 成立。这确保了特征值之和 $\\lambda_1 + \\lambda_2$ 为负，从而排除了由两个正实部特征值或具有正实部的复特征值（不稳定螺线点或节点）引起的不稳定性。\n\n接下来，我们计算 $\\mathbf{J}$ 的行列式：\n$$\n\\det(\\mathbf{J}) = \\left(\\frac{w_{EE}-1}{\\tau_{E}}\\right)\\left(-\\frac{1+w_{II}}{\\tau_{I}}\\right) - \\left(-\\frac{w_{EI}}{\\tau_{E}}\\right)\\left(\\frac{w_{IE}}{\\tau_{I}}\\right)\n$$\n$$\n\\det(\\mathbf{J}) = -\\frac{(w_{EE}-1)(1+w_{II})}{\\tau_{E}\\tau_{I}} + \\frac{w_{EI}w_{IE}}{\\tau_{E}\\tau_{I}}\n$$\n$$\n\\det(\\mathbf{J}) = \\frac{w_{EI}w_{IE} - (w_{EE}-1)(1+w_{II})}{\\tau_{E}\\tau_{I}}\n$$\n在已确定 $\\text{Tr}(\\mathbf{J})  0$ 的情况下，系统的稳定性仅取决于 $\\det(\\mathbf{J})$ 的符号。如果 $\\det(\\mathbf{J})  0$，系统是稳定的；如果 $\\det(\\mathbf{J})  0$，系统是不稳定的。一个满足 $\\text{Tr}(\\mathbf{J})  0$ 和 $\\det(\\mathbf{J})  0$ 的不稳定系统对应于一个鞍点，它有一个正实特征值和一个负实特征值。正特征值将导致问题中提到的“兴奋性爆发”。\n\n问题要求的是临界增益 $w_{IE}^{\\star}$，它将系统置于稳定性的边界上，即特征值位于复平面的闭合左半平面。在 $\\text{Tr}(\\mathbf{J})  0$ 的条件下，从稳定到不稳定的转变发生在行列式穿过零时。因此，临界稳定条件是 $\\det(\\mathbf{J}) = 0$。在这一点上，其中一个特征值为零（$\\lambda_1\\lambda_2 = \\det(\\mathbf{J}) = 0$），对应于一个鞍结分岔。\n\n我们将行列式设为零，然后求解 $w_{IE}$，我们将其标记为 $w_{IE}^{\\star}$：\n$$\n\\det(\\mathbf{J}) = \\frac{w_{EI}w_{IE}^{\\star} - (w_{EE}-1)(1+w_{II})}{\\tau_{E}\\tau_{I}} = 0\n$$\n由于时间常数 $\\tau_{E}$ 和 $\\tau_{I}$ 严格为正，它们的乘积 $\\tau_{E}\\tau_{I}$ 非零。因此，要使分式为零，分子必须为零：\n$$\nw_{EI}w_{IE}^{\\star} - (w_{EE}-1)(1+w_{II}) = 0\n$$\n我们现在可以解出 $w_{IE}^{\\star}$。问题指定了 $w_{EE}  1$，$w_{EI}  0$ 和 $w_{II} \\ge 0$。\n$$\nw_{EI}w_{IE}^{\\star} = (w_{EE}-1)(1+w_{II})\n$$\n由于 $w_{EI}  0$，我们可以用它来除，以分离出 $w_{IE}^{\\star}$：\n$$\nw_{IE}^{\\star} = \\frac{(w_{EE}-1)(1+w_{II})}{w_{EI}}\n$$\n这就是兴奋性到抑制性突触增益的临界值。对于任何 $w_{IE}  w_{IE}^{\\star}$，行列式将为正（因为 $w_{EI}0$），系统将是稳定的。对于 $w_{IE}  w_{IE}^{\\star}$，行列式将为负，系统将是不稳定的。因此，值 $w_{IE}^{\\star}$ 代表了为抵抗兴奋性爆发而临界镇定系统所需的最小增益。",
            "answer": "$$\\boxed{\\frac{(w_{EE}-1)(1+w_{II})}{w_{EI}}}$$"
        },
        {
            "introduction": "速率模型是强大的抽象，但它们如何与单个神经元的脉冲活动联系起来？最后一个练习将通过一个泄漏整合发放（LIF）神经元网络来弥合这一差距 。挑战在于，你需要通过数值方法求解网络自洽的放电率，从而将微观的神经元属性和突触噪声与宏观的持续活动现象联系起来。",
            "id": "4033679",
            "problem": "给定一个工作记忆网络的同质群体平均场抽象模型，该网络由渗漏整合发放（LIF）神经元建模。每个神经元接收来自群体的循环兴奋性输入和外部泊松输入。在扩散近似下，总输入可由平均漂移和高斯噪声概括，稳态下的神经元发放率由LIF传递函数给出。不动点群体发放率通过求解自洽方程 $r = \\Phi(\\mu(r), \\sigma(r))$ 来定义，其中 $\\mu$ 和 $\\sigma$ 分别是单个神经元有效输入的均值和标准差。\n\n基本原理：\n- 具有恒定渗漏和高斯白噪声输入的渗漏整合发放（LIF）膜方程为\n$$\\tau_m \\frac{dV}{dt} = -\\left(V - V_r\\right) + \\tau_m I_{\\text{mean}}(r) + \\sqrt{\\tau_m I_{\\text{var}}(r)} \\,\\xi(t),$$\n其中 $V$ 是膜电位，$V_r$ 是复位电位，$\\tau_m$ 是膜时间常数，$\\xi(t)$ 是标准高斯白噪声，$I_{\\text{mean}}(r)$ 是单位时间的平均输入电流，$I_{\\text{var}}(r)$ 是单位时间的输入方差。当 $V$ 达到阈值 $V_{\\text{th}}$ 时，会发放一个脉冲，$V$ 被复位到 $V_r$，并在不应期 $\\tau_{\\text{ref}}$ 内保持该值。\n- 在一个同质群体中，神经元接收循环输入和外部泊松输入，突触是瞬时的，其幅度为 $J$，入度为 $K$，到达率等于突触前发放率。在此情况下，扩散近似导致\n$$I_{\\text{mean}}(r) = J_{\\text{rec}} K_{\\text{rec}} r + J_{\\text{ext}} K_{\\text{ext}} r_{\\text{ext}} + I_{\\text{bias}},$$\n$$I_{\\text{var}}(r) = J_{\\text{rec}}^2 K_{\\text{rec}} r + J_{\\text{ext}}^2 K_{\\text{ext}} r_{\\text{ext}},$$\n其中 $J_{\\text{rec}}$ 和 $J_{\\text{ext}}$ 是突触幅度（单位为伏特/脉冲），$K_{\\text{rec}}$ 和 $K_{\\text{ext}}$ 是入度，$r$ 是待确定的群体发放率，$r_{\\text{ext}}$ 是外部发放率，$I_{\\text{bias}}$ 是单位时间的恒定偏置电流。输入LIF传递函数的有效均值和标准差为\n$$\\mu(r) = \\tau_m I_{\\text{mean}}(r), \\qquad \\sigma(r) = \\sqrt{\\tau_m I_{\\text{var}}(r)},$$\n其单位为伏特。\n- LIF传递函数 $\\Phi(\\mu,\\sigma)$ 是单个LIF神经元在均值为 $\\mu$、标准差为 $\\sigma$ 的高斯白噪声输入下的稳态发放率。它通过相应随机微分方程的平均首达时间得到，并可以通过Fokker–Planck形式主义进行数值计算。在确定性特殊情况 $\\sigma = 0$下，如果 $\\mu \\le V_{\\text{th}}$ 则没有发放，如果 $\\mu  V_{\\text{th}}$，脉冲间期为\n$$T_{\\text{det}}(\\mu) = \\tau_{\\text{ref}} + \\tau_m \\ln\\left(\\frac{\\mu - V_r}{\\mu - V_{\\text{th}}}\\right),$$\n因此发放率为 $r_{\\text{det}}(\\mu) = 1 / T_{\\text{det}}(\\mu)$。\n\n任务：\n- 实现一个程序，对每个给定的参数集，通过求解自洽方程 $r = \\Phi(\\mu(r), \\sigma(r))$ 来计算以赫兹（$\\text{Hz} = \\text{s}^{-1}$）为单位的不动点发放率 $r$。使用一个稳健的数值方法求解 $r \\ge 0$，并使用上述精确的确定性LIF表达式处理确定性情况 $\\sigma \\approx 0$。所有计算中，时间单位必须是秒，电位单位必须是伏特；最终的发放率必须以$\\text{Hz}$报告。\n- LIF传递函数必须从第一性原理计算，即通过对高斯输入下LIF神经元的Fokker–Planck描述所蕴含的平均首达时间积分进行数值评估。除这些原理外，不要假设任何快捷公式；确定性分支可以使用上述精确的闭式解。\n- 数值要求：对不动点使用基于区间套和二分法的求解器，确保发放率的收敛绝对容差在$10^{-8}$以内。在评估积分时，通过在适当情况下使用稳定的特殊函数来确保数值稳定性。\n- 输出规范：对于下方的测试套件，生成单行输出，其中包含计算出的不动点发放率，以逗号分隔并用方括号括起。每个发放率必须四舍五入到六位小数，并以$\\text{Hz}$表示。\n\n测试套件：\n对于每种情况，参数以 $(\\tau_m, \\tau_{\\text{ref}}, V_r, V_{\\text{th}}, J_{\\text{rec}}, K_{\\text{rec}}, J_{\\text{ext}}, K_{\\text{ext}}, r_{\\text{ext}}, I_{\\text{bias}})$ 的形式给出，单位为 $(\\text{s}, \\text{s}, \\text{V}, \\text{V}, \\text{V}, 1, \\text{V}, 1, \\text{Hz}, \\text{V}/\\text{s})$。\n1. 一般稳定性（“理想路径”）：$(0.02, 0.002, 0.0, 1.0, 0.005, 100, 0.005, 800, 3.0, 0.0)$。\n2. 无循环连接的边界情况：$(0.02, 0.002, 0.0, 1.0, 0.0, 0, 0.006, 500, 2.5, 0.0)$。\n3. 负偏置下的噪声主导情况：$(0.02, 0.002, 0.0, 1.0, 0.003, 200, 0.02, 100, 20.0, -10.0)$。\n4. 高于阈值的确定性漂移：$(0.02, 0.002, 0.0, 1.0, 0.0, 0, 0.0, 0, 0.0, 80.0)$。\n\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表并用方括号括起（例如，“[r1,r2,r3,r4]”），其中每个 $r_i$ 是一个以$\\text{Hz}$为单位、四舍五入到六位小数的浮点数。",
            "solution": "该问题要求计算一个由渗漏整合发放（LIF）神经元组成的同质群体的稳态不动点发放率 $r$。网络动力学由一个自洽方程描述，我们必须对其进行数值求解。问题的核心是从第一性原理实现LIF传递函数 $\\Phi(\\mu, \\sigma)$。\n\n需要求解的核心方程是关于群体发放率 $r$ 的不动点方程：\n$$\nr = \\Phi(\\mu(r), \\sigma(r))\n$$\n这里，$\\Phi(\\mu, \\sigma)$ 是传递函数，它给出单个神经元的发放率，作为其平均输入驱动 $\\mu$ 和输入标准差 $\\sigma$ 的函数。由于循环连接的存在，这些输入统计量本身也依赖于群体发放率 $r$。\n\n平均输入 $\\mu(r)$ 和输入标准差 $\\sigma(r)$ 是从突触输入的扩散近似推导出来的。总输入电流的均值 $I_{\\text{mean}}(r)$ 和方差 $I_{\\text{var}}(r)$ 由以下公式给出：\n$$\nI_{\\text{mean}}(r) = J_{\\text{rec}} K_{\\text{rec}} r + J_{\\text{ext}} K_{\\text{ext}} r_{\\text{ext}} + I_{\\text{bias}}\n$$\n$$\nI_{\\text{var}}(r) = J_{\\text{rec}}^2 K_{\\text{rec}} r + J_{\\text{ext}}^2 K_{\\text{ext}} r_{\\text{ext}}\n$$\n其中 $r$ 是以赫兹（$\\text{s}^{-1}$）为单位的群体发放率。那么，有效平均电位 $\\mu(r)$ 和标准差 $\\sigma(r)$ 为：\n$$\n\\mu(r) = \\tau_m I_{\\text{mean}}(r)\n$$\n$$\n\\sigma(r) = \\sqrt{\\tau_m I_{\\text{var}}(r)}\n$$\n请注意，当存在循环连接时（$J_{\\text{rec}}K_{\\text{rec}} \\neq 0$），$\\mu(r)$ 和 $\\sigma(r)$ 都是未知发放率 $r$ 的函数。\n\n传递函数 $\\Phi(\\mu, \\sigma)$ 给出由以下随机微分方程控制的LIF神经元的发放率：\n$$\n\\tau_m \\frac{dV}{dt} = -V + \\mu(r) + \\sigma(r) \\xi(t)\n$$\n其中静息电位 $V_L$ 被隐式地设为0，膜电位 $V(t)$ 是相对于此静息电位的。对于此问题，我们给定一个非零的复位电位 $V_r$，因此有效漂移是从任意电位 $V$ 朝向 $\\mu(r)$。发放率是平均脉冲间期的倒数，该间期是绝对不应期 $\\tau_{\\text{ref}}$ 与膜电位从复位电位 $V_r$ 到达阈值 $V_{\\text{th}}$ 的平均首达时间 $\\langle T \\rangle$ 之和。\n$$\n\\Phi(\\mu, \\sigma) = \\frac{1}{\\tau_{\\text{ref}} + \\langle T \\rangle}\n$$\n问题要求从第一性原理计算 $\\langle T \\rangle$，这涉及两种情况。\n\n**1. 随机情况（$\\sigma  0$）**\n对于非零噪声项，平均首达时间 $\\langle T \\rangle$ 由Siegert公式给出，该公式从 $V(t)$ 概率分布的Fokker-Planck方程推导得出。$\\langle T \\rangle$ 的积分为：\n$$\n\\langle T \\rangle = \\tau_m \\sqrt{\\pi} \\int_{y_r}^{y_{\\text{th}}} e^{x^2}(1 + \\text{erf}(x)) dx\n$$\n其中积分限是归一化电位：$y_r = (V_r - \\mu)/\\sigma$ 和 $y_{\\text{th}} = (V_{\\text{th}} - \\mu)/\\sigma$。直接对此积分进行数值评估是有问题的，因为即使对于中等大小的 $|x|$，$e^{x^2}$ 项也会溢出。\n为确保数值稳定性，我们重构被积函数。使用互补误差函数的恒等式 $\\text{erfc}(-x) = 1 + \\text{erf}(x)$，积分变为：\n$$\n\\langle T \\rangle = \\tau_m \\sqrt{\\pi} \\int_{y_r}^{y_{\\text{th}}} e^{x^2}\\text{erfc}(-x) dx\n$$\n然后我们引入缩放互补误差函数 $\\text{erfcx}(z) = e^{z^2}\\text{erfc}(z)$，该函数在数值上是稳定的，并且在标准科学库中可用。通过令 $z = -x$，被积函数变为 $\\sqrt{\\pi} \\text{erfcx}(-x)$。这种形式是稳健的，适合数值积分。\n\n**2. 确定性情况（$\\sigma \\approx 0$）**\n在没有噪声的情况下，神经元的膜电位按确定性方式演化。\n$$\n\\tau_m \\frac{dV}{dt} = -(V - \\mu)\n$$\n如果平均驱动 $\\mu$ 小于或等于阈值 $V_{\\text{th}}$，神经元将永远不会发放脉冲，因此发放率为0。如果 $\\mu  V_{\\text{th}}$，神经元会周期性地发放。从 $V_r$ 到达 $V_{\\text{th}}$ 所需的时间通过对 $dt = \\tau_m dV/(\\mu - V)$ 积分得到。\n$$\nT_{\\text{passage}} = \\int_{V_r}^{V_{\\text{th}}} \\frac{\\tau_m}{\\mu - V} dV = \\tau_m \\left[-\\ln(\\mu-V)\\right]_{V_r}^{V_{\\text{th}}} = \\tau_m \\ln\\left(\\frac{\\mu - V_r}{\\mu - V_{\\text{th}}}\\right)\n$$\n总脉冲间期为 $T_{\\text{det}} = \\tau_{\\text{ref}} + T_{\\text{passage}}$，发放率为 $\\Phi = 1/T_{\\text det}$。当 $\\sigma$ 低于一个小的数值阈值时，使用此闭式表达式。\n\n**求解不动点方程**\n我们需要找到函数 $f(r) = r - \\Phi(\\mu(r), \\sigma(r))$ 的根。按照要求，我们使用一个稳健的基于区间套和二分法的算法。Brent方法是一个很好的选择，其实现为 `scipy.optimize.brentq`。该方法需要一个区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 异号。对于发放率 $r$，一个具有物理意义的区间是 $[0, 1/\\tau_{\\text{ref}}]$，因为发放率不能为负，也不能超过由不应期设定的最大可能速率。\n让我们检查一下函数在该区间边界处的值：\n- 在 $r=0$ 处，$f(0) = 0 - \\Phi(\\mu(0), \\sigma(0))$。由于 $\\Phi$ 代表发放率，它必须是非负的，因此 $\\Phi(\\mu(0), \\sigma(0)) \\ge 0$。于是，$f(0) \\le 0$。\n- 在 $r=1/\\tau_{\\text{ref}}$ 处，$f(1/\\tau_{\\text{ref}}) = 1/\\tau_{\\text{ref}} - \\Phi(\\mu(1/\\tau_{\\text{ref}}), \\sigma(1/\\tau_{\\text{ref}}))$。传递函数 $\\Phi$ 永远不会超过 $1/\\tau_{\\text{ref}}$，所以 $\\Phi \\le 1/\\tau_{\\text{ref}}$。因此，$f(1/\\tau_{\\text{ref}}) \\ge 0$。\n\n由于 $f(0) \\le 0$ 且 $f(1/\\tau_{\\text{ref}}) \\ge 0$，如果 $f(r)$ 是连续的，则在区间 $[0, 1/\\tau_{\\text{ref}}]$ 内保证存在一个根。$\\mu(r)$ 和 $\\sigma(r)$ 的连续性是显而易见的。$\\Phi(\\mu, \\sigma)$ 的连续性来自于确定性区域和随机性区域之间的平滑过渡以及积分的连续性。因此，`brentq` 非常适合在期望的 $10^{-8}$ 容差内找到不动点发放率 $r$。\n\n实现将包含一个用于求解根的主函数，该函数又会调用一个计算 $\\Phi(\\mu, \\sigma)$ 的函数。这个传递函数将处理确定性和随机性两种情况，后者将在数值稳定的被积函数上使用 `scipy.integrate.quad`。此过程将应用于测试套件中提供的每个参数集。",
            "answer": "[13.916120,0.771960,4.871926,46.261981]"
        }
    ]
}