{
    "hands_on_practices": [
        {
            "introduction": "要理解癫痫的动力学，一个核心的出发点是掌握神经元兴奋性的生物物理基础。神经元的兴奋性与跨膜离子浓度梯度密切相关，而细胞外钾离子（$[K^+]_o$）的缓慢积累被认为是癫痫发生（ictogenesis）的关键机制之一。这项练习将通过推导和应用能斯特方程（Nernst equation），让您亲手计算$[K^+]_o$的微小变化如何显著改变钾离子的平衡电位，从而使神经元去极化并逼近放电阈值，为网络层面的过度兴奋和癫痫样活动创造条件 ()。",
            "id": "4017239",
            "problem": "在癫痫动力学的计算模型中，癫痫发生的一个核心机制是通过细胞外离子积累对离子反转电位进行缓慢调制。考虑钾离子并假设其行为符合理想溶液（活度系数等于$1$）。从平衡时电化学势相等以及理想溶液中化学势的热力学定义出发，推导钾离子的能斯特关系式，并用它来确定产生$+10$毫伏的钾离子能斯特电位去极化漂移所需的细胞外钾离子浓度变化。假设温度 $T=310\\,\\mathrm{K}$，普适气体常数 $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，法拉第常数 $F=96485\\,\\mathrm{C\\,mol^{-1}}$，基线细胞内钾离子浓度 $[K]_i=140\\,\\mathrm{mM}$，以及基线细胞外钾离子浓度 $[K]_o^{(0)}=3.0\\,\\mathrm{mM}$。钾离子的电荷数取 $z=+1$。\n\n计算在钾离子能斯特电位上产生 $\\Delta E_K=+10\\,\\mathrm{mV}$ 的去极化漂移所需的变化量 $\\Delta [K]_o=[K]_o^{(\\mathrm{new})}-[K]_o^{(0)}$。将您的答案四舍五入到三位有效数字，并以毫摩尔 (mM) 为单位表示最终数值。然后，利用膜生物物理学和基于电导的模型的核心原理，定性解释钾离子反转电位的这种漂移如何调节神经元兴奋性，并如何在癫痫动力学的网络模型中促进向癫痫发作状态的转变。",
            "solution": "这个问题具有科学依据，提法恰当，并为完整解答提供了所有必要信息。我们将首先推导能斯特关系式，然后计算所需的细胞外钾离子浓度变化，最后对生物物理学意义进行定性解释。\n\n首先，我们推导具有电荷 $z_j$ 的一般离子种类 $j$ 的能斯特关系式。推导从电化学势 $\\tilde{\\mu}_j$ 的定义开始，电化学势是化学势 $\\mu_j$ 和每摩尔电势能的总和。\n$$\n\\tilde{\\mu}_j = \\mu_j + z_j F \\phi\n$$\n其中 $F$ 是法拉第常数，$\\phi$ 是电势。对于理想溶液，化学势由下式给出：\n$$\n\\mu_j = \\mu_j^0 + RT \\ln[j]\n$$\n这里，$\\mu_j^0$ 是标准化学势，$R$ 是普适气体常数，$T$ 是绝对温度，$[j]$ 是离子的摩尔浓度。将这些结合起来，得到电化学势的完整表达式：\n$$\n\\tilde{\\mu}_j = \\mu_j^0 + RT \\ln[j] + z_j F \\phi\n$$\n在平衡状态下，没有离子跨膜的净通量。当细胞内的电化学势（细胞内，下标 $i$）等于细胞外的电化学势（细胞外，下标 $o$）时，此条件得到满足：\n$$\n\\tilde{\\mu}_{j,i} = \\tilde{\\mu}_{j,o}\n$$\n代入 $\\tilde{\\mu}_j$ 的表达式：\n$$\n\\mu_j^0 + RT \\ln[j]_i + z_j F \\phi_i = \\mu_j^0 + RT \\ln[j]_o + z_j F \\phi_o\n$$\n标准化学势 $\\mu_j^0$ 在两侧相同，因此可以消去。重新整理各项，求解跨膜电势差，该电势差定义为能斯特电位 $E_j = \\phi_i - \\phi_o$：\n$$\nz_j F (\\phi_i - \\phi_o) = RT \\ln[j]_o - RT \\ln[j]_i\n$$\n$$\nz_j F E_j = RT \\left( \\ln[j]_o - \\ln[j]_i \\right)\n$$\n利用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到：\n$$\nz_j F E_j = RT \\ln\\left(\\frac{[j]_o}{[j]_i}\\right)\n$$\n最后，求解 $E_j$ 得到能斯特方程：\n$$\nE_j = \\frac{RT}{z_j F} \\ln\\left(\\frac{[j]_o}{[j]_i}\\right)\n$$\n对于钾离子 ($K^+$)，电荷为 $z_K = +1$。因此，钾离子的能斯特电位 $E_K$ 为：\n$$\nE_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o}{[K]_i}\\right)\n$$\n\n接下来，我们利用这个关系式来确定产生 $\\Delta E_K = +10\\,\\mathrm{mV}$ 的去极化漂移所需的细胞外钾离子浓度变化 $\\Delta [K]_o$。设基线状态用上标 $(0)$ 表示，新状态用上标 $(\\mathrm{new})$ 表示。\n基线钾离子能斯特电位为：\n$$\nE_K^{(0)} = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(0)}}{[K]_i}\\right)\n$$\n细胞外浓度变化后的新电位为：\n$$\nE_K^{(\\mathrm{new})} = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_i}\\right)\n$$\n能斯特电位的变化量 $\\Delta E_K$ 是新电位与基线电位之差：\n$$\n\\Delta E_K = E_K^{(\\mathrm{new})} - E_K^{(0)} = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_i}\\right) - \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(0)}}{[K]_i}\\right)\n$$\n提出公因子 $\\frac{RT}{F}$ 并合并对数项：\n$$\n\\Delta E_K = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}/[K]_i}{[K]_o^{(0)}/[K]_i}\\right) = \\frac{RT}{F} \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_o^{(0)}}\\right)\n$$\n现在我们可以求解新的细胞外钾离子浓度与旧的浓度之比。\n$$\n\\frac{\\Delta E_K F}{RT} = \\ln\\left(\\frac{[K]_o^{(\\mathrm{new})}}{[K]_o^{(0)}}\\right)\n$$\n对两边取指数，得到：\n$$\n\\frac{[K]_o^{(\\mathrm{new})}}{[K]_o^{(0)}} = \\exp\\left(\\frac{\\Delta E_K F}{RT}\\right)\n$$\n因此，新的浓度为：\n$$\n[K]_o^{(\\mathrm{new})} = [K]_o^{(0)} \\exp\\left(\\frac{\\Delta E_K F}{RT}\\right)\n$$\n我们已知以下数值：\n$\\Delta E_K = +10\\,\\mathrm{mV} = 0.010\\,\\mathrm{V}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 310\\,\\mathrm{K}$\n$F = 96485\\,\\mathrm{C\\,mol^{-1}}$\n$[K]_o^{(0)} = 3.0\\,\\mathrm{mM}$\n细胞内浓度 $[K]_i = 140\\,\\mathrm{mM}$ 是恒定的，并且由于它被消去了，所以没有出现在最终的表达式中。\n\n首先，我们使用一致的国际单位制（SI）单位计算无量纲指数。注意，$1\\,\\mathrm{V} = 1\\,\\mathrm{J\\,C^{-1}}$。\n$$\n\\frac{\\Delta E_K F}{RT} = \\frac{(0.010\\,\\mathrm{V})(96485\\,\\mathrm{C\\,mol^{-1}})}{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(310\\,\\mathrm{K})} = \\frac{964.85\\,\\mathrm{J\\,mol^{-1}}}{2577.34\\,\\mathrm{J\\,mol^{-1}}} \\approx 0.37435\n$$\n现在，我们计算新的细胞外钾离子浓度：\n$$\n[K]_o^{(\\mathrm{new})} = (3.0\\,\\mathrm{mM}) \\exp(0.37435) \\approx (3.0\\,\\mathrm{mM})(1.45403) \\approx 4.36209\\,\\mathrm{mM}\n$$\n需要计算的量是变化量 $\\Delta [K]_o$：\n$$\n\\Delta [K]_o = [K]_o^{(\\mathrm{new})} - [K]_o^{(0)} = 4.36209\\,\\mathrm{mM} - 3.0\\,\\mathrm{mM} = 1.36209\\,\\mathrm{mM}\n$$\n将结果四舍五入到三位有效数字，我们得到 $\\Delta [K]_o \\approx 1.36\\,\\mathrm{mM}$。\n\n最后，我们定性解释钾离子反转电位的这种漂移如何调节神经元兴奋性，并促进向癫痫发作状态的转变。\n1.  **钾离子在静息膜电位中的作用：** 在大多数处于静息状态的神经元中，由于高密度的钾离子漏通道，细胞膜主要对钾离子 ($K^+$) 具有通透性。因此，神经元的静息膜电位 (RMP) 非常接近钾离子的能斯特电位 $E_K$。通常，$E_K$ 是高度负性的（例如，大约 $-90\\,\\mathrm{mV}$），这建立了神经元的超极化静息状态。\n\n2.  **$E_K$ 去极化的效应：** 细胞外钾离子浓度 $[K]_o$ 的增加（一种被称为高钾血症的情况）使得比值 $[K]_o / [K]_i$ 变大。从能斯特方程可以看出，这使得对数 $\\ln([K]_o/[K]_i)$ 的负值变小（或更正），导致 $E_K$ 漂移到一个更小的负值（即去极化）。在这个问题中，一个 $+10\\,\\mathrm{mV}$ 的漂移可能会使 $E_K$ 从，例如，$-94\\,\\mathrm{mV}$ 移动到 $-84\\,\\mathrm{mV}$。由于 RMP 紧随 $E_K$ 变化，RMP 也发生去极化。\n\n3.  **神经元兴奋性的调节：** 一个去极化的神经元，其膜电位更接近于发放动作电位的阈值。这意味着一个更小的兴奋性突触后电位 (EPSP) 或一个更弱的外部刺激现在就足以触发一个锋电位。因此，神经元变得更易兴奋，并且对突触输入的响应更有可能发放动作电位。\n\n4.  **向癫痫发作状态的转变：** 在神经网络中，这种兴奋性的增加可以启动一个病理性正反馈循环，这是癫痫发生（癫痫产生）的一个关键机制。其过程如下：\n    *   神经元放电增加导致在动作电位的复极化阶段，$K^+$ 离子从神经元外流到有限的细胞外空间。\n    *   这种外流导致 $[K]_o$ 进一步增加。\n    *   升高的 $[K]_o$ 进一步使周围神经元的 $E_K$ 和 RMP 去极化，使它们更易兴奋和放电。\n    *   这就形成了一个恶性循环：放电 $\\rightarrow$ $[K]_o$ 增加 $\\rightarrow$ 更多去极化 $\\rightarrow$ 更多放电。这种失控的兴奋可导致高度同步、高频的爆发性活动，这是脑电图上癫痫发作的特征。包含了动态离子浓度的基于电导的模型能够明确地捕捉到这种由细胞外钾离子的缓慢动力学驱动的，从稳定的低活动状态到病理性的癫痫样状态的转变。",
            "answer": "$$\n\\boxed{1.36}\n$$"
        },
        {
            "introduction": "在从单个神经元的兴奋性转向大规模神经网络的集体行为时，速率模型（rate models）为我们提供了强大的分析工具。Wilson-Cowan模型是研究兴奋性（E）和抑制性（I）神经元群体相互作用的典范，它揭示了网络如何从一个稳定的静息态转变为节律性的振荡活动，这正是癫痫发作的一个关键特征。这项练习将引导您运用线性系统理论，从第一性原理出发，解析并计算出导致这种振荡（通过Hopf分岔）产生的临界耦合强度，并通过数值方法验证您的理论预测 ()。",
            "id": "4017283",
            "problem": "考虑在计算神经科学中用于研究癫痫动力学和致痫机制的 Wilson-Cowan 率模型，该模型包含一个兴奋性群体和一个抑制性群体。兴奋性群体的活动由 $E(t)$ 表示，抑制性群体的活动由 $I(t)$ 表示。假设两个群体均采用阈值线性传递函数，其斜率（增益）分别为 $g_E$ 和 $g_I$，阈值分别为 $\\theta_E$ 和 $\\theta_I$，动力学方程如下：\n$$\n\\tau_E \\frac{dE}{dt} = -E + S_E\\big(w_{EE} E - w_{EI} I + P_E\\big), \\quad\n\\tau_I \\frac{dI}{dt} = -I + S_I\\big(w_{IE} E - w_{II} I + P_I\\big),\n$$\n其中 $\\tau_E$ 和 $\\tau_I$ 是膜时间常数（单位为秒），$w_{EE}$ 是兴奋性到兴奋性的耦合，$w_{EI}$ 是抑制性到兴奋性的输入，$w_{IE}$ 是兴奋性到抑制性的输入，$w_{II}$ 是抑制性自耦合，$P_E$ 和 $P_I$ 是恒定的外部输入。阈值线性传递函数为\n$$\nS_E(x) = \\max\\{0,\\, g_E\\,(x - \\theta_E)\\}, \\quad S_I(x) = \\max\\{0,\\, g_I\\,(x - \\theta_I)\\}.\n$$\n\n你将在不动点对两个群体都高于阈值的区域进行研究，因此可以使用恒定斜率 $g_E$ 和 $g_I$ 进行有效的线性化。从这些模型定义和标准线性系统理论出发，根据第一性原理，推导当参数 $w_{EE}$ 变化时，振荡开始（Hopf 分岔）的解析条件，该条件应以围绕不动点线性化系统的雅可比矩阵表示。利用二维线性系统的迹和行列式条件，获得临界 $w_{EE}$ 的显式表达式，在该临界值下，共轭特征值对的实部穿过零。不要假定任何已有的公式；从上述定义和一般线性化步骤开始。\n\n然后，设计并实现一个数值线性稳定性分析，通过计算在解析预测的 $w_{EE}$ 值略低于和略高于该值时的雅可比特征值，来验证解析临界值。具体而言：\n- 计算高于阈值区域中线性化系统的雅可比矩阵 $A$ 及其特征值。\n- 检查当 $w_{EE}$ 略小于临界值时，不动点是否为稳定焦点（实部为负且虚部非零）。\n- 检查当 $w_{EE}$ 略大于临界值时，不动点是否为不稳定焦点（实部为正且虚部非零），或者在边界情况下，特征值是否为实数（无振荡）且一个实部变为正数。\n\n对于下方的每个测试用例，计算：\n- 解析预测的临界耦合 $w_{EE}^{\\star}$（无单位）。\n- 一个布尔值，指示在 $w_{EE}^{\\star}$ 处的雅可比矩阵行列式是否为正（这是 Hopf 分岔的必要条件）。\n- 一个布尔值，指示系统在略低于 $w_{EE}^{\\star}$ 时是否稳定（特征值的最大实部为负）。\n- 一个布尔值，指示系统在略高于 $w_{EE}^{\\star}$ 时是否不稳定（特征值的最大实部为正）。\n- 一个布尔值，指示在略低于 $w_{EE}^{\\star}$ 时特征值是否形成复共轭对（虚部非零）。\n- 一个布尔值，指示在略高于 $w_{EE}^{\\star}$ 时特征值是否形成复共轭对。\n\n使用以下参数集测试套件，这些参数集旨在探索与癫痫发作建模相关的典型、边界和边缘情况区域：\n\n- 测试用例 1（典型的“理想路径”）：\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.01$ s\n  - $g_E = 1.0$ s$^{-1}$, $g_I = 1.2$ s$^{-1}$\n  - $w_{EI} = 2.5$, $w_{IE} = 2.5$, $w_{II} = 0.5$\n  - $\\theta_E = 0.5$, $\\theta_I = 0.5$\n  - $P_E = 1.0$, $P_I = 1.0$\n\n- 测试用例 2（在起始点行列式为零的边界条件）：\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.01$ s\n  - $g_E = 1.0$ s$^{-1}$, $g_I = 1.0$ s$^{-1}$\n  - $w_{EI} = 1.5$, $w_{IE} = 3.0$, $w_{II} = 0.5$\n  - $\\theta_E = 0.5$, $\\theta_I = 0.5$\n  - $P_E = 1.0$, $P_I = 1.0$\n\n- 测试用例 3（相等的时间常数，强交叉耦合）：\n  - $\\tau_E = 0.02$ s, $\\tau_I = 0.02$ s\n  - $g_E = 1.6$ s$^{-1}$, $g_I = 1.4$ s$^{-1}$\n  - $w_{EI} = 1.3$, $w_{IE} = 1.3$, $w_{II} = 0.3$\n  - $\\theta_E = 0.4$, $\\theta_I = 0.4$\n  - $P_E = 0.9$, $P_I = 0.9$\n\n你的程序必须：\n- 实现 $w_{EE}^{\\star}$ 的解析推导，并为每个测试用例计算其值。\n- 构建雅可比矩阵，并在 $w_{EE}^{\\star} - \\varepsilon$ 和 $w_{EE}^{\\star} + \\varepsilon$ 处执行特征值分析，其中小偏移量 $\\varepsilon = 10^{-3}$。\n- 将所有测试用例的输出聚合为单行，格式化为 Python 风格的列表的列表：\n  $[[w_{EE}^{\\star}, d_+, s_-, u_+, c_-, c_+], \\ldots]$\n  其中 $w_{EE}^{\\star}$ 是一个四舍五入到 $6$ 位小数的浮点数，$d_+$ 是在 $w_{EE}^{\\star}$ 处行列式为正的布尔值，$s_-$ 是低于临界值时稳定的布尔值，$u_+$ 是高于临界值时不稳定的布尔值，$c_-$ 是低于临界值时为复数的布尔值，$c_+$ 是高于临界值时为复数的布尔值。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[[r_1,b_1,b_2,b_3,b_4,b_5],[r_2,\\ldots],[r_3,\\ldots]]$）。\n- 所有报告的量都是无单位的布尔值或浮点数；表示浮点数时无需单位。\n\n角度单位不适用。输出的任何地方均未使用百分比。模型和参数值在所述背景下是科学上合理且自洽的。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n\n**模型方程：**\n双群体 Wilson-Cowan 模型的动力学由以下公式给出：\n$$\n\\tau_E \\frac{dE}{dt} = -E + S_E\\big(w_{EE} E - w_{EI} I + P_E\\big)\n$$\n$$\n\\tau_I \\frac{dI}{dt} = -I + S_I\\big(w_{IE} E - w_{II} I + P_I\\big)\n$$\n\n**传递函数：**\n阈值线性传递函数为：\n$$\nS_E(x) = \\max\\{0,\\, g_E\\,(x - \\theta_E)\\}\n$$\n$$\nS_I(x) = \\max\\{0,\\, g_I\\,(x - \\theta_I)\\}\n$$\n\n**参数：**\n- 时间常数：$\\tau_E$, $\\tau_I$（单位为秒）\n- 增益：$g_E$, $g_I$（单位为 s$^{-1}$）\n- 耦合权重：$w_{EE}$, $w_{EI}$, $w_{IE}$, $w_{II}$（无单位）\n- 外部输入：$P_E$, $P_I$（无单位）\n- 阈值：$\\theta_E$, $\\theta_I$（无单位）\n\n**假设：**\n分析将在不动点对两个群体都高于阈值的区域进行。这意味着对于不动点附近的任何输入 $x$，$S_E(x) = g_E(x - \\theta_E)$ 且 $S_I(x) = g_I(x - \\theta_I)$。\n\n**数值任务参数：**\n- 稳定性检查的扰动：$\\varepsilon = 10^{-3}$\n- 测试用例 1：$\\tau_E = 0.02$, $\\tau_I = 0.01$, $g_E = 1.0$, $g_I = 1.2$, $w_{EI} = 2.5$, $w_{IE} = 2.5$, $w_{II} = 0.5$, $\\theta_E = 0.5$, $\\theta_I = 0.5$, $P_E = 1.0$, $P_I = 1.0$。\n- 测试用例 2：$\\tau_E = 0.02$, $\\tau_I = 0.01$, $g_E = 1.0$, $g_I = 1.0$, $w_{EI} = 1.5$, $w_{IE} = 3.0$, $w_{II} = 0.5$, $\\theta_E = 0.5$, $\\theta_I = 0.5$, $P_E = 1.0$, $P_I = 1.0$。\n- 测试用例 3：$\\tau_E = 0.02$, $\\tau_I = 0.02$, $g_E = 1.6$, $g_I = 1.4$, $w_{EI} = 1.3$, $w_{IE} = 1.3$, $w_{II} = 0.3$, $\\theta_E = 0.4$, $\\theta_I = 0.4$, $P_E = 0.9$, $P_I = 0.9$。\n\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行严格评估。\n\n- **科学依据**：该问题基于 Wilson-Cowan 模型，这是理论和计算神经科学中的一个经典模型，用于描述相互作用的神经元群体的大尺度动力学。研究该模型中的 Hopf 分岔是探究神经振荡起始机制的标准方法，包括与癫痫（致痫机制）相关的现象。该模型和分析牢固地植根于已确立的科学原理。\n- **适定性**：该问题是适定的。它要求进行特定的解析推导（Hopf 分岔参数的临界值）和一系列明确定义的数值检验。为每个测试用例提供了所有必要的参数。目标明确，且存在唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n该问题没有说明中列出的任何缺陷。它在科学上是合理的、自洽的，并且可以形式化。所提供的参数在模型背景下是物理上可信的。参数 $P_E, \\theta_E, P_I, \\theta_I$ 定义了不动点，但由于假设在活动区域内传递函数为阈值线性增益函数，通过雅可比矩阵进行的稳定性分析不依赖于不动点的具体坐标，而仅依赖于系统参数。因此，这些参数的存在不会产生冲突，并且在稳定性计算中不使用它们是给定假设下模型结构的直接结果。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n## 解答推导与实施计划\n\n问题的核心是对 Wilson-Cowan 系统进行线性稳定性分析，并找出当参数 $w_{EE}$ 变化时发生 Hopf 分岔的条件。\n\n**1. 系统线性化**\n在系统不动点 $(E^*, I^*)$ 处于“高于阈值”区域的假设下，发放率函数变为线性：\n$$ S_E(x) = g_E(x - \\theta_E) $$\n$$ S_I(x) = g_I(x - \\theta_I) $$\n将这些代入模型方程，得到一个线性常微分方程组：\n$$ \\tau_E \\frac{dE}{dt} = -E + g_E(w_{EE} E - w_{EI} I + P_E - \\theta_E) $$\n$$ \\tau_I \\frac{dI}{dt} = -I + g_I(w_{IE} E - w_{II} I + P_I - \\theta_I) $$\n我们可以将其重写为标准形式 $\\frac{d\\vec{x}}{dt} = A\\vec{x} + \\vec{b}$，其中 $\\vec{x} = [E, I]^T$：\n$$ \\frac{dE}{dt} = \\frac{1}{\\tau_E}[(g_E w_{EE} - 1)E - g_E w_{EI}I + g_E(P_E - \\theta_E)] $$\n$$ \\frac{dI}{dt} = \\frac{1}{\\tau_I}[g_I w_{IE}E - (g_I w_{II} + 1)I + g_I(P_I - \\theta_I)] $$\n不动点的稳定性由雅可比矩阵 $A$ 的特征值决定，对于这个线性系统，雅可比矩阵就是 $E$ 和 $I$ 的系数矩阵：\n$$\nA =\n\\begin{pmatrix}\n\\frac{\\partial (dE/dt)}{\\partial E}  \\frac{\\partial (dE/dt)}{\\partial I} \\\\\n\\frac{\\partial (dI/dt)}{\\partial E}  \\frac{\\partial (dI/dt)}{\\partial I}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{g_E w_{EE} - 1}{\\tau_E}  -\\frac{g_E w_{EI}}{\\tau_E} \\\\\n\\frac{g_I w_{IE}}{\\tau_I}  -\\frac{g_I w_{II} + 1}{\\tau_I}\n\\end{pmatrix}\n$$\n\n**2. Hopf 分岔条件**\n当雅可比矩阵的一对复共轭特征值穿过虚轴时，发生 Hopf 分岔。对于二维系统，这对应于分岔点的两个条件：\n1. 雅可比矩阵的迹为零：$\\text{Tr}(A) = 0$。这确保了特征值的实部为零（$\\lambda = \\pm i\\omega$）。\n2. 雅可比矩阵的行列式为正：$\\text{Det}(A)  0$。这确保了特征值为纯虚数（且非零），对应于振荡。如果 $\\text{Det}(A) \\le 0$，则特征值为实数。\n\n雅可比矩阵的迹为：\n$$\n\\text{Tr}(A) = \\frac{g_E w_{EE} - 1}{\\tau_E} - \\frac{g_I w_{II} + 1}{\\tau_I}\n$$\n\n**3. 临界耦合 $w_{EE}^{\\star}$ 的推导**\n我们通过将迹设为零来找到分岔参数的临界值 $w_{EE}^{\\star}$：\n$$\n\\frac{g_E w_{EE}^{\\star} - 1}{\\tau_E} - \\frac{g_I w_{II} + 1}{\\tau_I} = 0\n$$\n求解 $w_{EE}^{\\star}$：\n$$\n\\frac{g_E w_{EE}^{\\star} - 1}{\\tau_E} = \\frac{g_I w_{II} + 1}{\\tau_I}\n$$\n$$\ng_E w_{EE}^{\\star} - 1 = \\frac{\\tau_E}{\\tau_I}(g_I w_{II} + 1)\n$$\n$$\ng_E w_{EE}^{\\star} = 1 + \\frac{\\tau_E}{\\tau_I}(1 + g_I w_{II})\n$$\n$$\nw_{EE}^{\\star} = \\frac{1}{g_E} \\left( 1 + \\frac{\\tau_E}{\\tau_I}(1 + g_I w_{II}) \\right)\n$$\n这是临界兴奋性到兴奋性耦合的解析表达式，在该值处，不动点的稳定性发生改变，可能通过 Hopf 分岔。\n\n**4. 数值验证**\n数值任务是验证这个解析结果。对于每个测试用例，我们将：\n1.  使用推导出的公式计算 $w_{EE}^{\\star}$。\n2.  构建在 $w_{EE} = w_{EE}^{\\star}$ 处求值的雅可比矩阵 $A$，并计算其行列式 $\\text{Det}(A^\\star)$。如果 $\\text{Det}(A^\\star)  0$，则布尔值 $d_+$ 为真。\n3.  为 $w_{EE} = w_{EE}^{\\star} - \\varepsilon$ 构建雅可比矩阵 $A_{below}$，其中 $\\varepsilon = 10^{-3}$。我们计算其特征值。如果特征值的最大实部为负，则布尔值 $s_-$（低于临界值时稳定）为真。如果特征值形成复共轭对，则布尔值 $c_-$（低于临界值时为复数）为真。\n4.  为 $w_{EE} = w_{EE}^{\\star} + \\varepsilon$ 构建雅可比矩阵 $A_{above}$。我们计算其特征值。如果特征值的最大实部为正，则布尔值 $u_+$（高于临界值时不稳定）为真。如果特征值形成复共轭对，则布尔值 $c_+$（高于临界值时为复数）为真。\n结果（$w_{EE}^{\\star}$、$d_+$、$s_-$、$u_+$、$c_-$、$c_+$）将被计算并按要求格式化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Wilson-Cowan stability problem for the given test cases.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Each tuple contains: (tau_E, tau_I, g_E, g_I, w_EI, w_IE, w_II)\n    # The parameters theta_E, theta_I, P_E, P_I are not needed for the\n    # linear stability analysis in the above-threshold regime.\n    test_cases = [\n        # Test Case 1\n        (0.02, 0.01, 1.0, 1.2, 2.5, 2.5, 0.5),\n        # Test Case 2\n        (0.02, 0.01, 1.0, 1.0, 1.5, 3.0, 0.5),\n        # Test Case 3\n        (0.02, 0.02, 1.6, 1.4, 1.3, 1.3, 0.3),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = analyze_case(params)\n        all_results.append(result)\n\n    # Format the final output as a Python-style list of lists.\n    # Example: [[r1,b1,b2,b3,b4,b5],[r2,...],[r3,...]]\n    formatted_results = []\n    for res in all_results:\n        # Format the float to 6 decimal places, and booleans to lowercase true/false\n        w_ee_str = f\"{res[0]:.6f}\"\n        bool_strs = [str(b).lower() for b in res[1:]]\n        formatted_results.append(f\"[{w_ee_str},{','.join(bool_strs)}]\")\n    \n    final_output_str = f\"[{','.join(formatted_results)}]\"\n    print(final_output_str)\n\ndef analyze_case(params):\n    \"\"\"\n    Performs the full analytical and numerical analysis for a single parameter set.\n    \n    Args:\n        params (tuple): A tuple of model parameters (tau_E, tau_I, g_E, g_I, \n                        w_EI, w_IE, w_II).\n    \n    Returns:\n        list: A list containing [w_ee_star, d_plus, s_minus, u_plus, c_minus, c_plus].\n    \"\"\"\n    tau_E, tau_I, g_E, g_I, w_EI, w_IE, w_II = params\n    epsilon = 1e-3\n    # A small tolerance for floating point comparisons to zero.\n    zero_tol = 1e-9\n\n    # 1. Analytically compute the critical coupling w_EE_star\n    # This is derived from the condition Tr(J) = 0.\n    w_ee_star = (1.0 / g_E) * (1.0 + (tau_E / tau_I) * (1.0 + g_I * w_II))\n\n    def get_jacobian_and_eigs(w_ee, p):\n        \"\"\"Helper to compute Jacobian and its eigenvalues for a given w_ee.\"\"\"\n        tE, tI, gE, gI, wEI, wIE, wII = p\n        \n        # Elements of the Jacobian matrix A\n        A11 = (gE * w_ee - 1.0) / tE\n        A12 = (-gE * wEI) / tE\n        A21 = (gI * wIE) / tI\n        A22 = (-gI * wII - 1.0) / tI\n        \n        jacobian = np.array([[A11, A12], [A21, A22]])\n        eigs = np.linalg.eigvals(jacobian)\n        return jacobian, eigs\n\n    # 2. Check determinant at w_EE = w_ee_star\n    # A Hopf bifurcation requires Det(J) > 0 at the critical point where Tr(J) = 0.\n    J_star, _ = get_jacobian_and_eigs(w_ee_star, params)\n    det_at_star = np.linalg.det(J_star)\n    d_plus = det_at_star > zero_tol\n\n    # 3. Analyze stability just below the critical value\n    _, eigs_below = get_jacobian_and_eigs(w_ee_star - epsilon, params)\n    # System is stable if the largest real part of eigenvalues is negative.\n    s_minus = np.max(eigs_below.real)  0.0\n    # Eigenvalues are complex if any eigenvalue has a non-zero imaginary part.\n    c_minus = np.any(np.abs(eigs_below.imag) > zero_tol)\n\n    # 4. Analyze stability just above the critical value\n    _, eigs_above = get_jacobian_and_eigs(w_ee_star + epsilon, params)\n    # System is unstable if the largest real part of eigenvalues is positive.\n    u_plus = np.max(eigs_above.real) > 0.0\n    # Check for complex conjugate eigenvalues.\n    c_plus = np.any(np.abs(eigs_above.imag) > zero_tol)\n\n    return [w_ee_star, d_plus, s_minus, u_plus, c_minus, c_plus]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在理解了癫痫如何发生之后，计算神经科学的一个重要目标是探索其内在的控制机制和潜在的治疗策略。稳态可塑性（homeostatic plasticity）是一种生物学上合理的机制，它通过调节突触强度来维持网络的长期兴奋性平衡。本练习将挑战您在一个受反复刺激的Wilson-Cowan模型中，实现一个抑制性突触的稳态可塑性规则，并模拟评估该机制是否能有效稳定网络，防止其在持续的扰动下进入癫痫样的活动状态 ()。",
            "id": "4017271",
            "problem": "考虑一个用于皮层网络动力学的、基于发放率的双群体 Wilson-Cowan (WC) 模型，该模型由一个活动为 $E(t) \\in [0,1]$ 的兴奋性群体和一个活动为 $I(t) \\in [0,1]$ 的抑制性群体组成。假设突触相互作用由有效耦合系数概括，并且从抑制到兴奋的抑制性突触效能根据一个稳态抑制性可塑性规则进行自适应调整，该规则试图维持一个目标兴奋性设定点。令神经元传递函数为一个S型激活函数 $S(u) = \\dfrac{1}{1 + \\exp\\left(-a\\left(u - \\theta\\right)\\right)}$，其增益为 $a$，阈值为 $\\theta$。有量纲的时间尺度 $t$ 以秒为单位，兴奋性和抑制性群体的时间常数分别为 $\\tau_E$ 和 $\\tau_I$。\n\n具有抑制性可塑性的 WC 动力学由以下常微分方程 (ODEs) 组指定：\n$$\n\\frac{dE}{dt} = \\frac{-E + S\\left(c_1 E - w_{EI}(t) I + P(t) + h_E\\right)}{\\tau_E}, \\quad\n\\frac{dI}{dt} = \\frac{-I + S\\left(c_3 E - w_{II} I + h_I\\right)}{\\tau_I},\n$$\n$$\n\\frac{dw_{EI}}{dt} = \\frac{\\eta \\left(E - E_{\\mathrm{set}}\\right) - \\beta \\left(w_{EI} - w_{0}\\right)}{\\tau_w},\n$$\n其中 $c_1$、$c_3$ 和 $w_{II}$ 是固定的耦合参数，$w_{EI}(t)$ 是从抑制性群体到兴奋性群体的自适应抑制性权重，$h_E$ 和 $h_I$ 是恒定偏置项，$P(t)$ 是一个时变的外部兴奋性输入，$\\eta$ 是可塑性速率，$E_{\\mathrm{set}}$ 是兴奋性设定点，$\\beta$ 是一个泄漏项，它将 $w_{EI}$ 拉向其基线值 $w_0$，$\\tau_w$ 是抑制性可塑性的时间尺度。抑制性权重 $w_{EI}(t)$ 是有界的，使得 $w_{\\min} \\le w_{EI}(t) \\le w_{\\max}$；当 $w_{EI}$ 达到 $w_{\\min}$（或 $w_{\\max}$）时，其时间导数被约束为非负（或非正），以确保其保持在界限内。\n\n定义外部输入 $P(t)$ 以模拟周期性扰动，其由一个基线加上一连串矩形脉冲构成：\n$$\nP(t) = P_{\\mathrm{base}} + \\sum_{k=1}^{K} A_p \\, \\mathbf{1}_{[t_k, t_k + d_p]}(t),\n$$\n其中 $\\mathbf{1}_{[t_k, t_k + d_p]}(t)$ 是区间 $[t_k, t_k + d_p]$ 的指示函数。设参数为 $K = 5$，脉冲起始时间 $\\{t_k\\} = \\{5, 10, 15, 20, 25\\}$ (秒)，脉冲持续时间 $d_p = 0.5$ (秒)，脉冲振幅 $A_p = 3.0$，基线 $P_{\\mathrm{base}} = 1.8$。使用 $a = 4.0$，$\\theta = 2.5$，$\\tau_E = 0.02$ (秒)，$\\tau_I = 0.01$ (秒)，$c_1 = 12.0$，$c_3 = 13.0$，$w_{II} = 11.0$，$h_E = 0.0$，$h_I = 0.0$，基线抑制性权重 $w_0 = 9.0$，抑制性权重边界 $w_{\\min} = 0.5$，$w_{\\max} = 20.0$，泄漏项 $\\beta = 0.1$，可塑性时间尺度 $\\tau_w = 5.0$ (秒)。初始条件为 $E(0) = 0.05$，$I(0) = 0.05$，$w_{EI}(0) = w_0$。\n\n一次癫痫发作在操作上定义为：兴奋性活动 $E(t)$ 超过癫痫阈值 $E_{\\mathrm{sz}} = 0.6$ 的任何连续时间区间，且持续时间至少为 $T_{\\min} = 0.3$ 秒。如果在整个仿真时域 $T_{\\mathrm{sim}} = 30.0$ 秒内，癫痫发作次数为零，并且长期兴奋性活动在容差范围内与设定点匹配，则系统被宣告为通过抑制性可塑性达到稳定；具体来说，如果在最后 $T_{\\mathrm{tail}} = 5.0$ 秒内 $E(t)$ 的时间平均值（记为 $\\overline{E}_{\\mathrm{tail}}$）满足 $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$（其中 $\\varepsilon = 0.05$）。\n\n任务：\n- 实现一个数值积分器，以在给定参数和分段常数输入 $P(t)$ 的情况下，在 $t \\in [0, T_{\\mathrm{sim}}]$ 上求解该 ODE 系统，确保 $w_{EI}(t)$ 的动力学遵守抑制性权重的边界规则。\n- 根据上述阈值和最小持续时间定义检测癫痫发作，并计算发作次数。\n- 计算 $\\overline{E}_{\\mathrm{tail}}$，即 $E(t)$ 在 $t \\in [T_{\\mathrm{sim}} - T_{\\mathrm{tail}}, T_{\\mathrm{sim}}]$ 上的平均值。\n- 对于下面的每个测试套件中的参数集，根据上述标准判断系统是否稳定（布尔值）。\n\n测试套件（每个案例指定 $(\\eta, E_{\\mathrm{set}})$）：\n1. 案例 1（一般情况）：$\\eta = 0.05$，$E_{\\mathrm{set}} = 0.20$。\n2. 案例 2（无塑性边界）：$\\eta = 0.00$，$E_{\\mathrm{set}} = 0.20$。\n3. 案例 3（快速塑性边缘）：$\\eta = 0.50$，$E_{\\mathrm{set}} = 0.20$。\n4. 案例 4（设定点接近癫痫阈值）：$\\eta = 0.05$，$E_{\\mathrm{set}} = 0.55$。\n5. 案例 5（慢速塑性边缘）：$\\eta = 0.005$，$E_{\\mathrm{set}} = 0.20$。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4,result5]”），每个结果是一个布尔值，表示相应测试案例是否稳定。时间必须以秒为单位处理，所有计算必须遵守指定的单位和定义。不需要用户输入；程序必须运行五个测试案例并打印最终列表。",
            "solution": "核心目标是评估抑制性可塑性（被建模为抑制性突触强度的稳态自适应）是否能够稳定网络兴奋性，以抵抗可能引发癫痫样发作的周期性扰动。推导始于经典的基于发放率的神经元群体动力学和S型输入输出关系，以及一个有原则的稳态可塑性规则。\n\n基本基础：\n- Wilson-Cowan 率方程捕捉了兴奋性和抑制性神经元群体之间的相互作用，将群体平均活动动力学表示为向非线性传递函数的松弛过程：$\\dfrac{dE}{dt} = \\dfrac{-E + S(\\cdot)}{\\tau_E}$ 和 $\\dfrac{dI}{dt} = \\dfrac{-I + S(\\cdot)}{\\tau_I}$。这些模型在计算神经科学中用于模拟皮层动力学和癫痫机制，其中升高的周期性兴奋和减弱的抑制可能导致病理振荡。\n- S型传递函数 $S(u) = \\dfrac{1}{1 + \\exp(-a(u - \\theta))}$ 表示对具有增益 $a$ 和阈值 $\\theta$ 的突触输入的饱和发放率响应。\n- 稳态抑制性可塑性假定抑制性突触会进行自适应调整以维持一个兴奋性设定点 $E_{\\mathrm{set}}$，这通常由一个缓慢的动力学过程表示：$\\dfrac{dw_{EI}}{dt} = \\dfrac{\\eta (E - E_{\\mathrm{set}}) - \\beta (w_{EI} - w_0)}{\\tau_w}$；泄漏项 $\\beta (w_{EI} - w_0)$ 将自适应过程正则化，使其朝向一个基线值 $w_0$ 以防止漂移，并且为符合生理现实，$w_{EI}$ 是有界的。\n\n模型规格与逻辑：\n1. 动力学：\n   - 兴奋性群体接收自身兴奋 $c_1 E$、通过 $-w_{EI}(t) I$ 的抑制、外部驱动 $P(t)$ 以及偏置 $h_E$。其净输入为 $u_E = c_1 E - w_{EI} I + P(t) + h_E$，因此 $\\dfrac{dE}{dt} = \\dfrac{-E + S(u_E)}{\\tau_E}$。\n   - 抑制性群体接收兴奋 $c_3 E$、自身抑制 $-w_{II} I$ 以及偏置 $h_I$。其净输入为 $u_I = c_3 E - w_{II} I + h_I$，因此 $\\dfrac{dI}{dt} = \\dfrac{-I + S(u_I)}{\\tau_I}$。\n   - 抑制性可塑性演化为 $\\dfrac{dw_{EI}}{dt} = \\dfrac{\\eta (E - E_{\\mathrm{set}}) - \\beta (w_{EI} - w_0)}{\\tau_w}$，其边界 $w_{\\min} \\le w_{EI} \\le w_{\\max}$ 通过在 $w_{EI}$ 处于边界且导数会将其推向更越界时将向外的导数置零来强制执行。\n\n2. 外部扰动：\n   - 输入 $P(t)$ 是一个基线加上一连串在时刻 $t_k$ 具有振幅 $A_p$ 和持续时间 $d_p$ 的矩形脉冲，产生能够引发类似癫痫的 $E(t)$ 增加的周期性扰动。这种构造允许对抵抗重复挑战的稳定性进行系统性评估。\n\n3. 癫痫检测与稳定标准：\n   - 一次癫痫发作通过阈值穿越来定义：$E(t)  E_{\\mathrm{sz}}$ 连续持续至少 $T_{\\min}$。在算法上，检查 $E(t)$ 的时间序列；识别并测量高于阈值的连续片段。满足最小持续时间的片段被计数。\n   - 稳定性的定义是，在整个仿真时域 $T_{\\mathrm{sim}}$ 内满足两个条件：癫痫发作次数为零，且兴奋性活动收敛到设定点。后者通过计算最后 $T_{\\mathrm{tail}}$ 内的时间平均值 $\\overline{E}_{\\mathrm{tail}}$ 并检查 $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$ 来评估。\n\n算法步骤：\n- 实现 $S(u) = \\dfrac{1}{1+\\exp(-a(u - \\theta))}$。\n- 通过对脉冲窗口上的指示函数求和并加上基线来实现 $P(t)$。由于 ODE 是数值求解的，因此使用一个给定 $t$ 返回 $P(t)$ 的函数。\n- 构建 ODE 右侧函数 $f(t, x)$，其中 $x = [E, I, w_{EI}]$，通过在 $w_{EI}$ 处于边界且原始导数会将其推离该边界时将其导数钳位到零来强制执行 $w_{EI}$ 的有界动力学。\n- 在 $t \\in [0, T_{\\mathrm{sim}}]$ 上使用数值积分器，并采用适合检测 $T_{\\min}$ 长度发作的采样网格。固定的评估网格（例如，$\\Delta t = 10^{-3}$ 秒）确保最小持续时间的检测是可靠的：$N = T_{\\mathrm{sim}} / \\Delta t$ 个样本。\n- 求解后，计算：\n  - 布尔掩码 $M[i] = (E(t_i)  E_{\\mathrm{sz}})$。\n  - 识别 $M$ 中值为 $1$ 的连续片段；对每个片段，计算其持续时间 $n_{\\mathrm{seg}} \\times \\Delta t$，如果 $\\ge T_{\\min}$ 则计为一次癫痫发作。\n  - 在 $t \\in [T_{\\mathrm{sim}} - T_{\\mathrm{tail}}, T_{\\mathrm{sim}}]$ 上计算 $\\overline{E}_{\\mathrm{tail}}$。\n- 对于每个测试案例，如果癫痫计数为零且 $\\left|\\overline{E}_{\\mathrm{tail}} - E_{\\mathrm{set}}\\right| \\le \\varepsilon$，则宣告稳定。\n\n测试套件理据：\n- 案例 1 考察了中等可塑性速率和低设定点；预计抑制性自适应将足以增加 $w_{EI}$ 以抵消扰动，从而不产生发作并收敛到设定点。\n- 案例 2 移除了可塑性（$\\eta = 0$），作为一个边界情况；由于重复的脉冲，癫痫可能复发，且没有稳态校正可用。\n- 案例 3 设置了高可塑性速率；快速的自适应可能会过冲并破坏动力学稳定性，可能阻止收敛或诱发发作。\n- 案例 4 将设定点置于癫痫阈值附近；即使有可塑性，将活动维持在 $E_{\\mathrm{sz}}$ 附近也可能使系统对脉冲敏感，可能因发作或设定点不匹配而未能满足稳定标准。\n- 案例 5 使用了慢速可塑性；在 $T_{\\mathrm{sim}}$ 内，自适应可能过于迟缓，无法避免发作，或者无法达到设定点容差。\n\n最终程序为所有五个案例实现这些步骤，按顺序汇总稳定性的布尔值，并以列表表示形式打印单行结果。所有物理量均使用秒作为时间单位；活动是无量纲的分数。不涉及角度或百分比，消除了单位歧义。输出严格遵守指定格式，无附加文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Model parameters (fixed across cases)\na = 4.0\ntheta = 2.5\ntau_E = 0.02  # seconds\ntau_I = 0.01  # seconds\nc1 = 12.0\nc3 = 13.0\nw_II = 11.0\nh_E = 0.0\nh_I = 0.0\nw0 = 9.0\nw_min = 0.5\nw_max = 20.0\nbeta = 0.1\ntau_w = 5.0  # seconds\n\n# External input parameters\nP_base = 1.8\nA_p = 3.0\npulse_times = np.array([5.0, 10.0, 15.0, 20.0, 25.0])\npulse_duration = 0.5\n\n# Simulation parameters\nT_sim = 30.0  # seconds\ndt = 1e-3     # seconds, for sampling\nt_eval = np.arange(0.0, T_sim + dt, dt)\n\n# Seizure detection parameters\nE_seizure = 0.6\nT_min = 0.3   # seconds\nT_tail = 5.0  # seconds\neps_tol = 0.05\n\ndef S(u):\n    \"\"\"Sigmoidal transfer function.\"\"\"\n    return 1.0 / (1.0 + np.exp(-a * (u - theta)))\n\ndef P_of_t(t):\n    \"\"\"External input P(t) = baseline + sum of rectangular pulses.\"\"\"\n    p = P_base\n    # Add rectangular pulses\n    for tk in pulse_times:\n        if tk = t  tk + pulse_duration:\n            p += A_p\n    return p\n\ndef rhs(t, x, eta, E_set):\n    \"\"\"Right-hand side of the ODE system: [E, I, w_EI].\"\"\"\n    E, I, wEI = x\n\n    # Net inputs\n    uE = c1 * E - wEI * I + P_of_t(t) + h_E\n    uI = c3 * E - w_II * I + h_I\n\n    # Population dynamics\n    dE = (-E + S(uE)) / tau_E\n    dI = (-I + S(uI)) / tau_I\n\n    # Plasticity raw derivative\n    dw_raw = (eta * (E - E_set) - beta * (wEI - w0)) / tau_w\n\n    # Enforce bounds on wEI by zeroing outward derivative at the bounds\n    if wEI = w_min and dw_raw  0.0:\n        dw = 0.0\n    elif wEI >= w_max and dw_raw > 0.0:\n        dw = 0.0\n    else:\n        dw = dw_raw\n\n    return np.array([dE, dI, dw])\n\ndef simulate_case(eta, E_set):\n    \"\"\"Simulate one parameter case and evaluate stabilization.\"\"\"\n    # Initial conditions\n    x0 = np.array([0.05, 0.05, w0])\n\n    # Integrate ODE\n    sol = solve_ivp(\n        fun=lambda t, x: rhs(t, x, eta=eta, E_set=E_set),\n        t_span=(0.0, T_sim),\n        y0=x0,\n        method=\"RK45\",\n        t_eval=t_eval,\n        rtol=1e-6,\n        atol=1e-9,\n    )\n\n    E_series = sol.y[0, :]\n    # Ensure bounds on wEI in state (in case of numerical drift)\n    # Note: rhs already enforces bounds in derivatives; clipping here is conservative.\n    w_series = np.clip(sol.y[2, :], w_min, w_max)\n\n    # Seizure detection: contiguous segments with E > E_seizure for >= T_min\n    above = E_series > E_seizure\n    # Find segment boundaries\n    # We consider transitions from False->True as starts and True->False as ends.\n    diff = np.diff(above.astype(np.int8))\n    starts = np.where(diff == 1)[0] + 1\n    ends = np.where(diff == -1)[0] + 1\n    # Handle case where series starts above threshold\n    if above[0]:\n        starts = np.r_[0, starts]\n    # Handle case where series ends above threshold\n    if above[-1]:\n        ends = np.r_[ends, above.size]\n\n    # Count segments meeting minimum duration\n    min_len = int(np.ceil(T_min / dt))\n    seizure_count = 0\n    for s, e in zip(starts, ends):\n        seg_len = e - s\n        if seg_len >= min_len:\n            seizure_count += 1\n\n    # Compute tail average over last T_tail seconds\n    tail_start_idx = int((T_sim - T_tail) / dt)\n    E_tail = E_series[tail_start_idx:]\n    E_tail_mean = float(np.mean(E_tail))\n\n    # Stabilization criterion\n    stabilized = (seizure_count == 0) and (abs(E_tail_mean - E_set) = eps_tol)\n    return stabilized\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (eta, E_set)\n        (0.05, 0.20),   # Case 1: moderate plasticity\n        (0.00, 0.20),   # Case 2: no plasticity\n        (0.50, 0.20),   # Case 3: fast plasticity\n        (0.05, 0.55),   # Case 4: set-point near seizure threshold\n        (0.005, 0.20),  # Case 5: slow plasticity\n    ]\n\n    results = []\n    for eta, E_set in test_cases:\n        result = simulate_case(eta, E_set)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}