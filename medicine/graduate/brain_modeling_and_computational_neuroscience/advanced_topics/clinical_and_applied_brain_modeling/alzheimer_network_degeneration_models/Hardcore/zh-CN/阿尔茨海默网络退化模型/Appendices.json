{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的全脑模型之前，掌握求解网络退化模型核心方程的方法至关重要。本练习  为您提供了一个基础但关键的实践机会。通过对一个小型三区域网络进行计算，您将使用谱方法（特征分解）来精确追踪病理蛋白随时间的演化，从而深入理解不同网络模式（特征向量）如何以不同速率衰减。",
            "id": "3962308",
            "problem": "考虑一个阿尔茨海默病（AD）病理的线性网络退化模型，其中浓度向量 $x(t) \\in \\mathbb{R}^{3}$ 在一个三区域结构网络上演化，其演化过程由以下常微分方程决定：\n$$\n\\frac{d}{dt}x(t) = -\\left( \\kappa L + \\lambda I \\right) x(t),\n$$\n其中扩散强度 $\\kappa  0$，均匀清除率 $\\lambda  0$，图拉普拉斯矩阵 $L \\in \\mathbb{R}^{3 \\times 3}$，以及单位矩阵 $I \\in \\mathbb{R}^{3 \\times 3}$。三个节点分别对应内嗅皮层、海马体和后扣带回。假设拉普拉斯矩阵是如下的对称路径图拉普拉斯矩阵：\n$$\nL = \\begin{pmatrix}\n1  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{pmatrix},\n$$\n且在时间 $t=0$ 时的初始 AD 病理浓度为\n$$\nx(0) = \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.1 \\end{pmatrix}\n$$\n单位为标准化摄取值比率（SUVR）。设生物物理参数为 $\\kappa = 0.5$ $\\text{年}^{-1}$，$\\lambda = 0.2$ $\\text{年}^{-1}$，并评估在时间 $t = 3$ 年时的状态。\n\n从对称矩阵和线性时不变系统的基本性质出发，通过对拉普拉斯矩阵进行特征分解来推导解析解，并计算在 $t=3$ 年时的状态 $x(t)$。将最终状态的每个分量以 SUVR 单位表示，并将每个分量四舍五入到四位有效数字。你的最终答案必须是一个单行向量。",
            "solution": "该模型是一个线性时不变系统：\n$$\n\\frac{d}{dt}x(t) = -\\left( \\kappa L + \\lambda I \\right) x(t),\n$$\n其中 $L$ 是对称的。对于对称矩阵，存在一个标准正交特征基 $U \\in \\mathbb{R}^{3 \\times 3}$，使得\n$$\nL = U \\Lambda U^{\\top},\n$$\n其中 $\\Lambda = \\operatorname{diag}(\\lambda_{0}, \\lambda_{1}, \\lambda_{2})$ 包含 $L$ 的特征值，且 $U^{\\top}U = I$。\n\n定义模态坐标 $y(t) = U^{\\top} x(t)$。将 $x(t) = U y(t)$ 代入微分方程得到\n$$\n\\frac{d}{dt}(U y(t)) = -\\left( \\kappa U \\Lambda U^{\\top} + \\lambda I \\right) U y(t).\n$$\n使用 $U^{\\top}U = I$ 并在方程左侧乘以 $U^{\\top}$，\n$$\n\\frac{d}{dt} y(t) = -\\left( \\kappa \\Lambda + \\lambda I \\right) y(t),\n$$\n该方程解耦为三个标量常微分方程\n$$\n\\frac{d}{dt} y_{i}(t) = -\\left( \\kappa \\lambda_{i} + \\lambda \\right) y_{i}(t), \\quad i = 0,1,2.\n$$\n其解为\n$$\ny_{i}(t) = \\exp\\!\\left( -(\\kappa \\lambda_{i} + \\lambda) t \\right) y_{i}(0).\n$$\n变换回原始坐标，\n$$\nx(t) = U y(t) = U \\exp\\!\\left( -(\\kappa \\Lambda + \\lambda I) t \\right) y(0) = U \\exp\\!\\left( -(\\kappa \\Lambda + \\lambda I) t \\right) U^{\\top} x(0),\n$$\n这就是矩阵指数解的谱形式。\n\n我们现在计算给定的路径图拉普拉斯矩阵的特征分解\n$$\nL = \\begin{pmatrix}\n1  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{pmatrix}.\n$$\n对于三个节点的路径图，其特征值是已知的，或者可以通过求解 $\\det(L - \\mu I) = 0$ 得到，结果为\n$$\n\\lambda_{0} = 0, \\quad \\lambda_{1} = 1, \\quad \\lambda_{2} = 3.\n$$\n一组对应的标准正交特征向量为\n$$\nv_{0} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad\nv_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}, \\quad\nv_{2} = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix}.\n$$\n将这些向量作为 $U = [v_{0}\\; v_{1}\\; v_{2}]$ 的列向量。\n\n将初始条件投影到模态坐标：\n$$\ny(0) = U^{\\top} x(0) = \\begin{pmatrix}\nv_{0}^{\\top} x(0) \\\\\nv_{1}^{\\top} x(0) \\\\\nv_{2}^{\\top} x(0)\n\\end{pmatrix}.\n$$\n计算每个分量：\n- 对于 $v_{0}$，\n$$\ny_{0}(0) = v_{0}^{\\top} x(0) = \\frac{1}{\\sqrt{3}} (1.0 + 0.3 + 0.1) = \\frac{1.4}{\\sqrt{3}}.\n$$\n- 对于 $v_{1}$，\n$$\ny_{1}(0) = v_{1}^{\\top} x(0) = \\frac{1}{\\sqrt{2}} (1.0 - 0.1) = \\frac{0.9}{\\sqrt{2}}.\n$$\n- 对于 $v_{2}$，\n$$\ny_{2}(0) = v_{2}^{\\top} x(0) = \\frac{1}{\\sqrt{6}} (1.0 - 2 \\cdot 0.3 + 0.1) = \\frac{0.5}{\\sqrt{6}}.\n$$\n\n当 $\\kappa = 0.5$ $\\text{年}^{-1}$，$\\lambda = 0.2$ $\\text{年}^{-1}$，且 $t = 3$ 年时，模态衰减因子为\n$$\n\\exp\\!\\left( -(\\kappa \\lambda_{0} + \\lambda) t \\right) = \\exp(-0.2 \\cdot 3) = \\exp(-0.6),\n$$\n$$\n\\exp\\!\\left( -(\\kappa \\lambda_{1} + \\lambda) t \\right) = \\exp(-(0.5 \\cdot 1 + 0.2) \\cdot 3) = \\exp(-2.1),\n$$\n$$\n\\exp\\!\\left( -(\\kappa \\lambda_{2} + \\lambda) t \\right) = \\exp(-(0.5 \\cdot 3 + 0.2) \\cdot 3) = \\exp(-5.1).\n$$\n因此\n$$\ny(t) = \\begin{pmatrix}\n\\exp(-0.6)\\, \\frac{1.4}{\\sqrt{3}} \\\\\n\\exp(-2.1)\\, \\frac{0.9}{\\sqrt{2}} \\\\\n\\exp(-5.1)\\, \\frac{0.5}{\\sqrt{6}}\n\\end{pmatrix}.\n$$\n重建 $x(t)$ 如下\n$$\nx(t) = U y(t) = \\sum_{i=0}^{2} \\left[ \\exp\\!\\left( -(\\kappa \\lambda_{i} + \\lambda) t \\right) \\, y_{i}(0) \\, v_{i} \\right].\n$$\n为了进行数值计算，使用作用于 $x(0)$ 的投影矩阵 $v_{i} v_{i}^{\\top}$ 会很方便。各部分的贡献如下：\n- 对于 $v_{0}$，\n$$\nv_{0} v_{0}^{\\top} x(0) = \\frac{1}{3} \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.1 \\end{pmatrix}\n= \\frac{1}{3} \\begin{pmatrix} 1.4 \\\\ 1.4 \\\\ 1.4 \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1.4}{3} \\\\ \\frac{1.4}{3} \\\\ \\frac{1.4}{3} \\end{pmatrix}.\n$$\n乘以 $\\exp(-0.6)$ 得到 $v_{0}$ 对每个分量的贡献：\n$$\n\\exp(-0.6) \\cdot \\frac{1.4}{3} \\approx 0.5488116360940264 \\cdot 0.4666666666666667 \\approx 0.256112096843879.\n$$\n- 对于 $v_{1}$，\n$$\nv_{1} v_{1}^{\\top} x(0) = \\frac{1}{2} \\begin{pmatrix} 1  0  -1 \\\\ 0  0  0 \\\\ -1  0  1 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.1 \\end{pmatrix}\n= \\frac{1}{2} \\begin{pmatrix} 0.9 \\\\ 0 \\\\ -0.9 \\end{pmatrix}\n= \\begin{pmatrix} 0.45 \\\\ 0 \\\\ -0.45 \\end{pmatrix}.\n$$\n乘以 $\\exp(-2.1)$ 得到\n$$\n\\exp(-2.1) \\cdot \\begin{pmatrix} 0.45 \\\\ 0 \\\\ -0.45 \\end{pmatrix}\n\\approx 0.1224564282529819 \\cdot \\begin{pmatrix} 0.45 \\\\ 0 \\\\ -0.45 \\end{pmatrix}\n= \\begin{pmatrix} 0.055105392713841 \\\\ 0 \\\\ -0.055105392713841 \\end{pmatrix}.\n$$\n- 对于 $v_{2}$，\n$$\nv_{2} v_{2}^{\\top} x(0) = \\frac{1}{6} \\begin{pmatrix} 1  -2  1 \\\\ -2  4  -2 \\\\ 1  -2  1 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.3 \\\\ 0.1 \\end{pmatrix}\n= \\frac{1}{6} \\begin{pmatrix} 0.5 \\\\ -1.0 \\\\ 0.5 \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{12} \\\\ -\\frac{1}{6} \\\\ \\frac{1}{12} \\end{pmatrix}.\n$$\n乘以 $\\exp(-5.1)$ 得到\n$$\n\\exp(-5.1) \\cdot \\begin{pmatrix} \\frac{1}{12} \\\\ -\\frac{1}{6} \\\\ \\frac{1}{12} \\end{pmatrix}\n\\approx 0.00609678 \\cdot \\begin{pmatrix} \\frac{1}{12} \\\\ -\\frac{1}{6} \\\\ \\frac{1}{12} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{0.00609678}{12} \\\\ -\\frac{0.00609678}{6} \\\\ \\frac{0.00609678}{12} \\end{pmatrix}\n\\approx \\begin{pmatrix} 0.000508065 \\\\ -0.001016130 \\\\ 0.000508065 \\end{pmatrix}.\n$$\n\n将三个贡献按分量相加得到\n$$\nx_{1}(3) \\approx 0.256112096843879 + 0.055105392713841 + 0.000508065 \\approx 0.3117255547,\n$$\n$$\nx_{2}(3) \\approx 0.256112096843879 + 0 - 0.001016130 \\approx 0.2550959668,\n$$\n$$\nx_{3}(3) \\approx 0.256112096843879 - 0.055105392713841 + 0.000508065 \\approx 0.2015147692.\n$$\n\n四舍五入到四位有效数字，并以标准化摄取值比率（SUVR）单位表示，在 $t=3$ 年时的最终状态向量为\n$$\n\\begin{pmatrix}\n0.3117  0.2551  0.2015\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.3117  0.2551  0.2015 \\end{pmatrix}}$$"
        },
        {
            "introduction": "掌握了基本的模拟方法后，我们将探讨一个关键的建模决策：如何表示大脑连接。本练习  旨在比较有向网络与其对称化版本上的病理分期差异。您将通过编程实现并观察到，连接的方向性会从根本上改变病理扩散的预测序列，这对于构建符合生物学真实性的模型是一个至关重要的考量。",
            "id": "3962345",
            "problem": "您的任务是实现并分析一个基于第一性原理的、用于阿尔茨海默病（AD）网络退化的网络分期模型。核心问题是，在节点 $A$ 处播种病理时，有向连接表示与其对称化对应物之间的早期分期顺序是否会以及为何会产生差异。您的程序必须从第一性原理推导出一个连续时间线性扩散模型，计算在有向和对称化传播算子下每个节点的阈值穿越时间，并汇总所提供测试套件的结果。\n\n基本基础和建模要求：\n- 从脑区网络的有向邻接矩阵 $A$ 的定义开始，其中 $A_{ij}$ 是分配给从节点 $i$ 到节点 $j$ 的有向边的非负权重。使用惯例，即在节点 $A$ 处播种对应于初始状态向量 $x(0)$，该向量是在节点 $A$ 的索引处为 $1$、其余处为 $0$ 的单位向量。\n- 使用线性时不变正系统的原理：非负连接性、叠加原理以及使用一个生成算子的连续时间演化，该生成算子在每个节点产生与非负传入连接和当前状态成正比的非负变化率。从这些原理出发，推导出控制与沿有向边传播一致的连续时间线性扩散的最小方程组。不要假设或引入任何快捷公式；请自行推导。\n- 通过标准无向对称化规则 $S = \\frac{1}{2}(A + A^\\top)$，结合 $A$ 及其转置来定义对称化邻接矩阵 $S$。\n- 将每个节点 $i$ 的分期时间定义为其状态 $x_i(t)$ 达到或超过逐节点阈值 $\\theta$ 的最早非负时间 $t_i$。如果 $x_i(t)$ 在指定的有限时间范围 $T_{\\max}$ 内从未达到 $\\theta$，则指定 $t_i = \\infty$。\n- 所有时间均以任意时间单位报告；无需进行物理单位转换。\n\n计算要求：\n- 实现推导出的连续时间模型，以计算有向和对称化两种情况下的 $x(t)$。使用适用于具有常数生成算子的线性时不变系统的精确矩阵求解方法。对于每个节点和每种情况，通过在 $[0, T_{\\max}]$ 上进行稳健的数值搜索来确定阈值穿越时间，该搜索应遵循由传播算子在非负初始条件下的正性所隐含的单调性。使用定义明确的数值停止准则。\n- 播种始终在节点 $A$ 处进行。\n- 为每个测试用例返回两个浮点数列表：首先是有向模型下的阈值穿越时间列表，然后是对称化模型下的列表。节点顺序必须与测试用例中定义的节点顺序相匹配。\n- 如果一个节点在 $T_{\\max}$ 前从未达到阈值，则将其时间编码为 $\\infty$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一对用方括号括起来的列表。例如，结构应类似于 $[[\\dots,\\dots],[\\dots,\\dots],[\\dots,\\dots]]$，不含空格。浮点数必须精确打印到小数点后六位，$\\infty$ 表示为字符串 $inf$。\n\n测试套件：\n- 测试用例 1（有向不对称性，种子节点有强传入连接）：\n  - 节点和顺序：$[A,B,C,D,E]$。\n  - 有向边和权重：$A \\to B$ 权重为 $0.6$，$B \\to C$ 权重为 $0.5$，$D \\to A$ 权重为 $1.2$，所有其他条目均为 $0.0$。\n  - 阈值 $\\theta = 0.1$，速率常数 $\\beta = 1.0$，时间范围 $T_{\\max} = 4.0$。\n  - 预期：在有向传播下，当在 $A$ 处播种时，节点 $D$ 不会早期受累，因为 $D$ 只有指向 $A$ 的连接。在对称化下，$D \\to A$ 的边会贡献一个等效的 $A \\to D$ 分量，可能逆转相对于 $B$ 和 $C$ 的早期受累顺序。\n- 测试用例 2（双向平衡，方向性应不产生影响）：\n  - 节点和顺序：$[A,B,C]$。\n  - 有向边和权重：$A \\leftrightarrow B$ 双向权重均为 $0.7$，$A \\leftrightarrow C$ 双向权重均为 $0.7$，所有其他条目均为 $0.0$。\n  - 阈值 $\\theta = 0.2$，速率常数 $\\beta = 1.0$，时间范围 $T_{\\max} = 3.0$。\n  - 预期：由于固有的双向性，有向模型和对称化模型将产生相同的分期结果。\n- 测试用例 3（早期受累的方向性逆转）：\n  - 节点和顺序：$[A,B,C,D]$。\n  - 有向边和权重：$A \\to B$ 权重为 $0.2$，$C \\to A$ 权重为 $1.0$，所有其他条目均为 $0.0$。\n  - 阈值 $\\theta = 0.05$，速率常数 $\\beta = 1.0$，时间范围 $T_{\\max} = 2.0$。\n  - 预期：在以 $A$ 为种子的有向传播下，节点 $C$ 没有从 $A$ 出发的路径，因此受累较晚或不可达。在对称化下，$C$ 和 $A$ 变为双向连接，具有等效的无向权重，可能使节点 $C$ 比节点 $B$ 更早受累，从而逆转早期受累的顺序。\n\n答案类型和汇总：\n- 对于每个测试用例，按照该用例指定的节点顺序，生成两个浮点数列表，分别对应于 $[t^{\\text{directed}}_A,\\dots]$ 和 $[t^{\\text{sym}}_A,\\dots]$。\n- 您的程序必须生成单行输出，将三个测试用例的结果汇总到一个方括号列表中，不含空格，每个浮点数精确打印到小数点后六位，不可达的节点打印为 $inf$。例如：$[[t_{1,\\text{dir}},t_{1,\\text{sym}}],[t_{2,\\text{dir}},t_{2,\\text{sym}}],[t_{3,\\text{dir}},t_{3,\\text{sym}}]]$，其中每个 $t_{\\cdot}$ 本身是该测试用例节点顺序的列表。",
            "solution": "该问题要求推导和实现一个用于网络退化的连续时间线性模型，特别是为了比较有向和对称化脑网络之间的疾病分期。\n\n### 基于第一性原理的模型推导\n\n该模型描述了病理浓度的演化，由状态向量 $\\mathbf{x}(t) \\in \\mathbb{R}^N$ 表示，其中 $N$ 是脑区（节点）的数量，$x_i(t)$ 是节点 $i$ 在时间 $t$ 的病理浓度。推导遵循线性时不变（LTI）正系统的第一性原理。\n\n1.  **从第一性原理出发的系统动力学**：核心建模假设是，一个节点上病理的变化率与从相连节点流入的病理成正比。问题陈述指明，“生成算子在每个节点产生与非负传入连接和当前状态成正比的非负变化率”。\n\n    设 $A$ 为有向邻接矩阵，其中 $A_{ij} \\ge 0$ 是从节点 $i$ 到节点 $j$ 的连接权重。因此，从节点 $j$ 到节点 $i$ 的传入连接由权重 $A_{ji}$ 给出。\n\n    节点 $i$ 的病理变化率 $\\dot{x}_i(t)$ 是所有其他节点贡献的总和。来自节点 $j$ 的贡献与其当前状态 $x_j(t)$ 以及从 $j$ 到 $i$ 的传入连接强度 $A_{ji}$ 成正比。使用一个全局速率常数 $\\beta  0$，此关系表示为：\n    $$ \\dot{x}_i(t) = \\beta \\sum_{j=1}^{N} A_{ji} x_j(t) $$\n    该模型遵循“非负变化率”的原则。由于 $\\beta  0$，$A_{ji} \\ge 0$，并且我们在一个正系统中操作，其中对于所有 $t \\ge 0$（给定 $x_j(0) \\ge 0$），$x_j(t) \\ge 0$，因此可以得出 $\\dot{x}_i(t) \\ge 0$。这意味着任何节点的病理浓度都是时间的非递减函数，代表一个纯粹的累积过程。这种解释是与所有规定相符的最直接和最简约的解释，排除了其他常见的网络模型，如图拉普拉斯扩散（$\\dot{\\mathbf{x}} = -\\beta L \\mathbf{x}$），后者不能保证非负的变化率。\n\n2.  **矩阵表述**：这个包含 $N$ 个微分方程的系统可以用矩阵形式写出。认识到求和 $\\sum_{j=1}^{N} A_{ji} x_j(t)$ 是矩阵-向量积 $A^\\top \\mathbf{x}(t)$ 的第 $i$ 个元素，我们得到 LTI 系统：\n    $$ \\dot{\\mathbf{x}}(t) = \\beta A^\\top \\mathbf{x}(t) $$\n    系统的生成算子是 $G = \\beta A^\\top$。如果一个系统的生成算子具有非负的非对角元素，则该系统是“正”的。在这里，对于 $i \\neq j$，$G$ 的元素是 $G_{ij} = \\beta A_{ji} \\ge 0$，满足正性条件。\n\n3.  **有向模型 vs. 对称化模型**：\n    -   对于**有向模型**，生成算子是 $G_{\\text{dir}} = \\beta A^\\top$。\n    -   对于**对称化模型**，我们首先使用标准规则定义对称化邻接矩阵 $S$：$S = \\frac{1}{2}(A + A^\\top)$。通过在通用形式中用 $S$ 替换 $A$ 来导出相应的生成算子。由于 $S$ 是对称的（$S=S^\\top$），生成算子是 $G_{\\text{sym}} = \\beta S^\\top = \\beta S$。\n\n4.  **系统求解**：LTI 系统 $\\dot{\\mathbf{x}}(t) = G \\mathbf{x}(t)$ 在初始条件 $\\mathbf{x}(0)$ 下的解由矩阵指数给出：\n    $$ \\mathbf{x}(t) = e^{tG} \\mathbf{x}(0) $$\n    在特定节点（例如，索引为 $k$）播种病理对应于初始状态向量 $\\mathbf{x}(0)$ 为标准基向量 $\\mathbf{e}_k$，该向量在索引 $k$ 处为 $1$，其余处为 $0$。\n\n### 分期时间计算\n\n节点 $i$ 的分期时间 $t_i$ 是其状态 $x_i(t)$ 达到阈值 $\\theta$ 的最早时间。这需要找到方程 $f(t) = x_i(t) - \\theta = 0$ 的根。\n\n1.  **状态计算**：单个节点 $i$ 在时间 $t$ 的状态是状态向量 $\\mathbf{x}(t)$ 的第 $i$ 个分量：\n    $$ x_i(t) = \\mathbf{e}_i^\\top \\mathbf{x}(t) = \\mathbf{e}_i^\\top e^{tG} \\mathbf{x}(0) $$\n    在计算上，我们使用库函数计算矩阵指数（例如 `scipy.linalg.expm`）来计算完整的向量 $\\mathbf{x}(t)$，然后提取第 $i$ 个分量。\n\n2.  **数值搜索**：由于 $x_i(t)$ 是一个单调非递减函数，且方程 $x_i(t) = \\theta$ 可能没有简单的解析解，因此适合使用数值求根方法。二分法提供了一种稳健的方法。\n    -   **初始化**：我们在区间 $[0, T_{\\max}]$ 中搜索 $t_i$。\n    -   **边界检查**：\n        -   如果 $x_i(0) \\ge \\theta$（对于种子节点成立，因为 $\\theta  1$），则 $t_i = 0$。\n        -   如果 $x_i(T_{\\max})  \\theta$，则在时间范围内未达到阈值，因此 $t_i = \\infty$。\n    -   **二分法算法**：如果解存在于 $(0, T_{\\max}]$ 内，我们迭代地将搜索区间 $[t_{low}, t_{high}]$ 对半分割。在每一步中，我们计算 $t_{mid} = (t_{low} + t_{high})/2$ 处的 $x_i(t_{mid})$。如果 $x_i(t_{mid})  \\theta$，则根在 $[t_{mid}, t_{high}]$ 内；否则，根在 $[t_{low}, t_{mid}]$ 内。此过程重复固定次数的迭代（例如 100 次）以达到足够的精度。$t_i$ 的最终估计值是最终区间的上界 $t_{high}$。\n\n这种结合了基于第一性原理的模型推导和稳健的数值求解方法，使得可以按照问题要求，直接比较有向和对称化网络表示之间的分期时间。",
            "answer": "[[[0.000000,1.233807,2.502949,inf,inf],[0.000000,1.233807,2.502949,0.222728,inf]],[[0.000000,0.231049,0.231049],[0.000000,0.231049,0.231049]],[[0.000000,3.367296,inf,inf],[0.000000,3.367296,0.287682,inf]]]"
        },
        {
            "introduction": "最后的练习  将所有概念融合到一个现实的研究场景中。计算模型的最终目标之一是解释真实世界的数据。本练习要求您通过系统地搜索参数空间来优化模型，以最佳地再现已知的阿尔茨海默病进展顺序（Braak分期），从而让您亲身体验参数估计和模型验证的核心过程。",
            "id": "3962311",
            "problem": "给定一个阿尔茨海默病线性网络退化模型族，该模型耦合了沿结构性脑网络的扩散传播与局部清除过程。状态向量为 $x(t) \\in \\mathbb{R}^n$，其中 $x_i(t)$ 表示区域 $i$ 在时间 $t$ 的预测局部病理负荷。结构网络由一个非负项且对角线为零的对称邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 编码，对应的组合图拉普拉斯矩阵为 $L = D - A$，其中 $D$ 是对角度矩阵，其元素为 $D_{ii} = \\sum_{j=1}^n A_{ij}$。动力学由线性常微分方程定义\n$$\n\\frac{d x(t)}{dt} = -\\lambda x(t) - \\kappa L x(t),\n$$\n初始条件为 $x(0) = e_s$，其中 $e_s$ 是在种子索引 $s$ 处为 $1$，其他位置为 $0$ 的单位向量。这里，$\\kappa \\ge 0$ 量化了沿网络扩散传播的强度，$\\lambda \\ge 0$ 量化了局部清除的速率。对于每个区域 $i$，预测的阈值穿越时间 $T_i(\\kappa,\\lambda)$ 定义为满足 $x_i(t) \\ge \\theta$ 的最小 $t \\ge 0$，其中 $\\theta  0$ 是一个指定的阈值。如果对于所有 $t \\in [0, T_{\\max}]$ 都有 $x_i(t)  \\theta$，则设置 $T_i(\\kappa,\\lambda) = T_{\\max} + \\Delta t$ 以强制获得一个最大的有限排序。阿尔茨海默病的进展顺序可以用一个整数值的 Braak 分期顺序向量 $b \\in \\{1,2,\\dots,n\\}^n$ 表示，其中 $b_i$ 是区域 $i$ 的名义分期索引。\n\n目标是，对于每个测试用例，在 $\\kappa$ 和 $\\lambda$ 值的离散网格上进行搜索，找到能使预测的阈值穿越时间 $\\{T_i(\\kappa,\\lambda)\\}_{i=1}^n$ 与 Braak 顺序 $\\{b_i\\}_{i=1}^n$ 之间的 Kendall's $\\tau$ 等级相关性（使用对平局具有鲁棒性的 Kendall's $\\tau_b$）最大化的参数对。如果目标值出现平局，选择 $\\lambda$ 最小的解；如果仍然存在平局，选择 $\\kappa$ 最小的解。\n\n使用的基本原理：\n- 用于网络扩散的图拉普拉斯矩阵 $L = D - A$。\n- 时不变系统的线性常微分方程解：如果 $\\frac{dx}{dt} = B x$，则 $x(t) = e^{Bt} x(0)$，其中 $e^{Bt}$ 是矩阵指数。\n- 两个实值列表之间的 Kendall's $\\tau$ 等级相关性 $\\tau_b$。\n\n通过在均匀时间网格 $\\{0, \\Delta t, 2 \\Delta t, \\dots, T_{\\max}\\}$ 上评估 $x(t)$，并记录 $x_i(t)$ 首次超过阈值的时间来计算阈值穿越时间。使用闭式解\n$$\nx(t) = e^{-(\\lambda I + \\kappa L)t} x(0),\n$$\n以及特征分解 $L = V \\,\\mathrm{diag}(\\alpha_1,\\dots,\\alpha_n)\\, V^\\top$（其中 $V^\\top V = I$）来高效计算 $x(t)$：\n$$\nx(t) = V \\,\\mathrm{diag}\\left(e^{-(\\lambda + \\kappa \\alpha_j) t}\\right) V^\\top x(0).\n$$\n\n物理单位：将 $t$ 解释为以年为单位的时间，将 $\\lambda$ 和 $\\kappa$ 解释为以 $1/\\text{年}$ 为单位的速率，将 $\\theta$ 解释为无量纲阈值。报告最终的最佳拟合参数时，将 $\\kappa$ 和 $\\lambda$ 表示为以 $1/\\text{年}$ 为单位、保留六位小数的十进制浮点数。输出中不要包含单位字符串。\n\n角度单位：不适用。\n\n百分比：不适用。\n\n测试套件：\n- 测试用例 $1$（链式网络，“顺利路径”）：\n  - 区域数量：$n = 6$。\n  - 邻接矩阵：\n    $$\n    A^{(1)} =\n    \\begin{pmatrix}\n    0  1  0  0  0  0 \\\\\n    1  0  1  0  0  0 \\\\\n    0  1  0  1  0  0 \\\\\n    0  0  1  0  1  0 \\\\\n    0  0  0  1  0  1 \\\\\n    0  0  0  0  1  0\n    \\end{pmatrix}.\n    $$\n  - 种子索引：$s = 0$（在实现中为零基索引）。\n  - 阈值：$\\theta = 0.02$。\n  - 时间范围：$T_{\\max} = 30$ 年。\n  - 时间步长：$\\Delta t = 0.1$ 年。\n  - Braak 分期顺序：$b^{(1)} = [1, 2, 3, 4, 5, 6]$。\n\n- 测试用例 $2$（星形网络，从中心枢纽快速扩散）：\n  - 区域数量：$n = 6$。\n  - 邻接矩阵：\n    $$\n    A^{(2)} =\n    \\begin{pmatrix}\n    0  1  1  1  1  1 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0 \\\\\n    1  0  0  0  0  0\n    \\end{pmatrix}.\n    $$\n  - 种子索引：$s = 0$。\n  - 阈值：$\\theta = 0.02$。\n  - 时间范围：$T_{\\max} = 30$ 年。\n  - 时间步长：$\\Delta t = 0.1$ 年。\n  - Braak 分期顺序：$b^{(2)} = [1, 2, 3, 4, 5, 6]$。\n\n- 测试用例 $3$（部分断开的网络，存在无法穿越阈值的边缘情况）：\n  - 区域数量：$n = 6$。\n  - 邻接矩阵：\n    $$\n    A^{(3)} =\n    \\begin{pmatrix}\n    0  1  0  0  0  0 \\\\\n    1  0  1  0  0  0 \\\\\n    0  1  0  0  0  0 \\\\\n    0  0  0  0  1  0 \\\\\n    0  0  0  1  0  0 \\\\\n    0  0  0  0  0  0\n    \\end{pmatrix}.\n    $$\n  - 种子索引：$s = 0$。\n  - 阈值：$\\theta = 0.02$。\n  - 时间范围：$T_{\\max} = 30$ 年。\n  - 时间步长：$\\Delta t = 0.1$ 年。\n  - Braak 分期顺序：$b^{(3)} = [1, 2, 3, 4, 5, 6]$。\n\n参数搜索网格（离散，所有测试用例均相同）：\n- 扩散强度：$\\kappa \\in \\{0.05, 0.10, 0.20, 0.35, 0.50, 0.80, 1.20\\}$。\n- 清除速率：$\\lambda \\in \\{0.02, 0.05, 0.10, 0.15, 0.25, 0.40, 0.80\\}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身是一个包含三个浮点数的列表 $[\\kappa^\\ast,\\lambda^\\ast,\\tau^\\ast]$，分别代表以 $1/\\text{年}$ 为单位的最佳拟合扩散强度、以 $1/\\text{年}$ 为单位的最佳拟合清除速率以及最大化的 Kendall's $\\tau$ 值。所有三个浮点数都必须四舍五入到六位小数。例如，一个有效的输出可能如下所示\n$$\n[\\,[0.500000,0.100000,0.733333],\\,[0.800000,0.050000,0.600000],\\,[0.350000,0.150000,0.466667]\\,],\n$$\n但其值为根据指定测试用例计算所得。",
            "solution": "该问题已经过验证，被认为是合理的。它科学地基于计算神经科学中已建立的网络扩散模型，问题设定良好，具有明确的目标和约束，并使用客观、明确的语言进行表述。所有必要的数据和参数均已提供。\n\n该问题要求为基于网络的阿尔茨海默病进展模型找到最优参数 $(\\kappa, \\lambda)$，以最好地重现给定的病理分期顺序。该模型描述了病理在结构性脑网络上的传播，病理由浓度向量 $x(t) \\in \\mathbb{R}^n$ 表示。动力学由一个线性常微分方程（ODE）控制：\n$$\n\\frac{d x(t)}{dt} = -\\lambda x(t) - \\kappa L x(t) = -(\\lambda I + \\kappa L) x(t)\n$$\n这里，$n$ 是大脑区域的数量。参数 $\\kappa \\ge 0$ 表示沿网络连接的扩散传播速率，$\\lambda \\ge 0$ 表示病理的局部清除或衰减速率。网络结构编码在图拉普拉斯矩阵 $L = D - A$ 中，其中 $A$ 是邻接矩阵，$D$ 是对角度矩阵。系统从单个区域 $s$ 的病理种子开始，对应于初始条件 $x(0) = e_s$，其中 $e_s$ 是在索引 $s$ 处为 1、其他位置为 0 的标准基向量。\n\n这是一个时不变线性系统，其解由矩阵指数给出：\n$$\nx(t) = e^{-(\\lambda I + \\kappa L)t} x(0)\n$$\n为了高效计算，我们使用对称图拉普拉斯矩阵 $L$ 的谱特性。设 $L$ 的特征分解为 $L = V \\Lambda V^\\top$，其中 $\\Lambda = \\mathrm{diag}(\\alpha_1, \\dots, \\alpha_n)$ 是特征值的对角矩阵，$V$ 是相应特征向量构成的正交矩阵 ($V^\\top V = I$）。解可以表示为：\n$$\nx(t) = V \\,\\mathrm{diag}\\left(e^{-(\\lambda + \\kappa \\alpha_j) t}\\right)_{j=1}^n V^\\top x(0)\n$$\n一旦 $L$ 的特征分解已知，该公式就可以在任意时间 $t$ 快速计算状态向量 $x(t)$。\n\n模型的输出是一组预测的阈值穿越时间 $\\{T_i(\\kappa, \\lambda)\\}_{i=1}^n$。对于每个区域 $i$，$T_i$ 是其病理水平 $x_i(t)$ 达到或超过给定阈值 $\\theta$ 的最早时间 $t \\ge 0$。在计算上，我们在离散时间网格 $t_k = k \\cdot \\Delta t$（其中 $k=0, 1, \\dots, T_{\\max}/\\Delta t$）上评估 $x(t)$。将满足 $x_i(t_k) \\ge \\theta$ 的第一个时间点 $t_k$ 记录为 $T_i$。如果在时间范围 $[0, T_{\\max}]$ 内从未达到阈值，则分配一个惩罚值 $T_i = T_{\\max} + \\Delta t$，以确保有限的排序，并将这些区域与那些虽然较晚但在时间范围内穿越阈值的区域区分开来。\n\n目标是从指定的离散网格中找到参数对 $(\\kappa, \\lambda)$，使得模型预测的进展顺序（由 $T_i$ 值的排序给出）与由 Braak 分期向量 $b$ 表示的经验病理进展顺序之间的一致性最大化。这种一致性使用 Kendall's $\\tau_b$ 等级相关系数来衡量，它适用于有平局秩的数据。穿越时间的平局是可预见的，特别是在对称区域或不连通分量中。\n\n优化过程是网格搜索。对于每个测试用例，我们将执行以下步骤：\n1. 构建邻接矩阵 $A$ 和相应的图拉普拉斯矩阵 $L$。\n2. 计算 $L$ 的特征值 $\\alpha_j$ 和特征向量 $V$。\n3. 初始化最佳参数集 $(\\kappa^\\ast, \\lambda^\\ast)$ 和最大相关性 $\\tau^\\ast = -2$（一个比任何可能的 $\\tau$ 值都低的值）。\n4. 遍历各自搜索网格中的每一对 $(\\kappa, \\lambda)$。\n5. 对于每一对 $(\\kappa, \\lambda)$：\n    a. 对所有区域 $i$ 和网格 $[0, \\Delta t, \\dots, T_{\\max}]$ 中的所有时间步 $t_k$，计算状态向量的演化 $x_i(t_k)$。\n    b. 通过为每个区域找到第一个满足 $x_i(t_k) \\ge \\theta$ 的时间 $t_k$ 来确定阈值穿越时间向量 $T(\\kappa, \\lambda)$。\n    c. 计算穿越时间向量 $T(\\kappa, \\lambda)$ 与给定的 Braak 分期向量 $b$ 之间的 Kendall's $\\tau_b$ 相关性。\n6. 根据计算出的 $\\tau_b$ 值更新最优参数。如果当前的 $\\tau_b$ 大于 $\\tau^\\ast$，则更新 $(\\kappa^\\ast, \\lambda^\\ast, \\tau^\\ast)$。如果 $\\tau_b$ 等于 $\\tau^\\ast$，则应用指定的平局打破规则：选择 $\\lambda$ 较小的解；如果 $\\lambda$ 也相同，则选择 $\\kappa$ 较小的解。\n\n将此完整过程独立应用于所提供的三个测试用例中的每一个，每个用例都有其独特的网络结构和 Braak 分期。每个测试用例的最终结果是一个三元组 $[\\kappa^\\ast, \\lambda^\\ast, \\tau^\\ast]$。",
            "answer": "[[1.200000,0.020000,1.000000],[0.050000,0.020000,0.466667],[0.350000,0.020000,0.466667]]"
        }
    ]
}