## Introduction
Electroencephalography (EEG) is a powerful tool for observing human brain dynamics with high [temporal resolution](@entry_id:194281). However, interpreting the complex patterns measured at the scalp to infer the underlying neural activity is a significant challenge. This gap between scalp signals and their origins in the brain is bridged by the EEG forward model—a biophysical and mathematical framework that predicts the scalp potentials generated by known electrical sources within the head. Understanding this forward problem is the essential first step before one can attempt to solve the more common "inverse problem" of locating those sources from measured data.

This article provides a comprehensive exploration of EEG [forward modeling](@entry_id:749528), from first principles to practical applications. It will guide you through the core concepts required to understand, build, and utilize these critical models in computational neuroscience. The first chapter, **Principles and Mechanisms**, delves into the fundamental physics, deriving the governing equations from Maxwell's equations and explaining how head anatomy shapes the resulting electric fields. The second chapter, **Applications and Interdisciplinary Connections**, demonstrates how forward models are used to build subject-specific head models, inform experimental design, and integrate EEG with other neurotechnologies like MEG and brain stimulation. Finally, **Hands-On Practices** will offer a chance to apply these concepts through concrete computational exercises, solidifying your understanding of how neural sources translate into measurable EEG signals.

## Principles and Mechanisms

The generation and measurement of Electroencephalography (EEG) signals are governed by fundamental principles of electromagnetism applied to the complex biological medium of the human head. Understanding the EEG forward problem—the prediction of scalp potentials from known neural sources—requires a systematic development of its physical and mathematical foundations. This chapter elucidates these core principles, from the underlying electrodynamic approximations to the practical construction of predictive models.

### The Physical Basis: From Maxwell's Equations to Quasi-Statics

The propagation of electromagnetic fields is completely described by Maxwell's equations. However, for the specific biophysical regime of EEG, these equations can be significantly simplified. The relevant neural signals have frequencies typically below a few hundred hertz ($f \lt 300 \, \text{Hz}$), and the characteristic length scale is the size of the head ($L \approx 0.2 \, \text{m}$). These parameters justify the use of the **electro-quasi-static (EQS)** approximation.

The EQS approximation is valid when the temporal variations of the fields are slow enough that magnetic induction and [electromagnetic wave propagation](@entry_id:272130) effects are negligible. This is the case when the system size $L$ is much smaller than the electromagnetic wavelength $\lambda$ in the medium. The first major consequence of this approximation is that the inductive term in Faraday's law of induction becomes negligible. Faraday's law, $\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}$, simplifies to:
$$ \nabla \times \mathbf{E} \approx \mathbf{0} $$
A vector field with zero curl is conservative, which means the electric field $\mathbf{E}$ can be expressed as the negative gradient of a [scalar potential](@entry_id:276177) field $\phi$.
$$ \mathbf{E}(\mathbf{r}) = -\nabla \phi(\mathbf{r}) $$
This simplification is crucial, as it reduces the problem of finding a vector field $\mathbf{E}$ to the more tractable problem of finding a [scalar field](@entry_id:154310) $\phi$.

A second key simplification within the quasi-static framework concerns the relative contributions of conduction currents and displacement currents. In a conductive dielectric medium like brain tissue, the total current density in response to an electric field has two components: the **[conduction current](@entry_id:265343) density**, $\mathbf{J}_c = \sigma \mathbf{E}$, arising from the drift of ions, and the **displacement current density**, $\mathbf{J}_d = \frac{\partial \mathbf{D}}{\partial t} = \varepsilon \frac{\partial \mathbf{E}}{\partial t}$, arising from the time-varying polarization of the medium. Here, $\sigma$ is the electrical conductivity and $\varepsilon$ is the electric permittivity.

For [time-harmonic fields](@entry_id:755985) oscillating at an angular frequency $\omega = 2\pi f$, the ratio of the magnitudes of these two currents is:
$$ \frac{|\mathbf{J}_d|}{|\mathbf{J}_c|} = \frac{|\varepsilon (\partial \mathbf{E} / \partial t)|}{|\sigma \mathbf{E}|} = \frac{\omega \varepsilon}{\sigma} $$
Displacement currents can be neglected relative to conduction currents when this ratio is much less than one:
$$ \frac{\omega \varepsilon}{\sigma} \ll 1 $$
Let's examine this condition using typical values for brain tissue, which has a conductivity $\sigma$ on the order of $0.3 \, \text{S/m}$ and a [relative permittivity](@entry_id:267815) $\varepsilon_r$ on the order of $10^5$ or higher at low frequencies, though even conservative estimates for $\varepsilon_r$ around $40-80$ suffice to prove the point. At the upper end of the typical EEG frequency range, say $f = 300 \, \text{Hz}$ (so $\omega \approx 1885 \, \text{rad/s}$), and using $\varepsilon = \varepsilon_r \varepsilon_0$ with $\varepsilon_r = 80$ and $\varepsilon_0 \approx 8.85 \times 10^{-12} \, \text{F/m}$, we find :
$$ \frac{\omega \varepsilon}{\sigma} \approx \frac{(1885 \, \text{s}^{-1})(80 \times 8.85 \times 10^{-12} \, \text{F/m})}{0.3 \, \text{S/m}} \approx 4.4 \times 10^{-6} $$
This value is orders of magnitude smaller than one. Therefore, across the entire frequency range relevant to EEG, conduction currents overwhelmingly dominate displacement currents. This justifies modeling the head as a purely resistive (Ohmic) volume conductor, where capacitive effects are ignored .

### The Governing Equation of Volume Conduction

With the physical medium established as a resistive volume conductor, we can formulate the central equation that links neural sources to the resulting potential field. The total current density $\mathbf{J}_{\text{total}}$ within the head is the sum of two distinct types of currents :

1.  **Primary Current Density ($\mathbf{J}^p$)**: Also known as impressed currents, these are the sources of the EEG signal. They are generated by active biological processes, specifically the transmembrane ionic flows driven by electrochemical gradients across the membranes of active neurons. These currents are non-Ohmic; they are the "cause," not the "effect," of the [macroscopic electric field](@entry_id:196409).

2.  **Secondary Current Density ($\mathbf{J}^c$)**: Also known as volume or conduction currents, these are the passive, Ohmic currents that flow through the bulk conductive medium (brain, CSF, skull, scalp) in response to the electric field set up by the primary sources. They are defined by the macroscopic Ohm's law: $\mathbf{J}^c = \boldsymbol{\sigma}\mathbf{E}$.

The conductivity $\boldsymbol{\sigma}$ characterizes the tissue's ability to conduct electricity. It can be modeled in two ways :
*   **Isotropic Conductivity**: In tissues like [gray matter](@entry_id:912560) or CSF, conductivity is often assumed to be the same in all directions. In this case, $\boldsymbol{\sigma}$ is a scalar field, $\sigma(\mathbf{r})$, and the secondary current is always parallel to the electric field: $\mathbf{J}^c(\mathbf{r}) = \sigma(\mathbf{r})\mathbf{E}(\mathbf{r})$.
*   **Anisotropic Conductivity**: In tissues with a preferred structural orientation, like the white matter tracts of the brain or the lamellar structure of the skull, conductivity is direction-dependent. In this case, $\boldsymbol{\sigma}$ is a symmetric, [positive-definite tensor](@entry_id:204409) field, $\boldsymbol{\sigma}(\mathbf{r})$. The current $\mathbf{J}^c(\mathbf{r}) = \boldsymbol{\sigma}(\mathbf{r})\mathbf{E}(\mathbf{r})$ is not necessarily parallel to the electric field $\mathbf{E}(\mathbf{r})$. Symmetry and [positive-definiteness](@entry_id:149643) are physical requirements related to energy conservation and dissipation.

The quasi-static approximation implies that [free charge](@entry_id:264392) does not accumulate in the bulk conductor, so the divergence of the total current density is zero everywhere:
$$ \nabla \cdot \mathbf{J}_{\text{total}} = \nabla \cdot (\mathbf{J}^p + \mathbf{J}^c) = 0 $$
Substituting the expressions for $\mathbf{J}^c$ and $\mathbf{E}$, we arrive at the fundamental governing equation for the EEG [forward problem](@entry_id:749531):
$$ \nabla \cdot (\boldsymbol{\sigma}(-\nabla \phi)) = -\nabla \cdot \mathbf{J}^p $$
$$ \nabla \cdot (\boldsymbol{\sigma}\nabla \phi) = \nabla \cdot \mathbf{J}^p $$
This is a Poisson-type partial differential equation (PDE). It states that the electric potential $\phi$ is determined by the spatial distribution of the head's conductivity $\boldsymbol{\sigma}$ and the sources, which are given by the divergence of the primary current density, $\nabla \cdot \mathbf{J}^p$. Physically, the divergence of $\mathbf{J}^p$ represents the net rate at which charge is transferred from the intracellular to the extracellular space per unit volume, acting as the source for the extracellular potential field.

### Boundary Conditions, Referencing, and Uniqueness

To solve the governing PDE, we must specify how the potential and currents behave at the boundaries between different tissues and at the outer boundary of the head.

At an internal interface between two tissue types (e.g., between the brain and CSF, or CSF and skull), two physical conditions must hold :
1.  **Continuity of Potential**: The electric potential $\phi$ must be continuous across the interface to avoid an infinite electric field.
2.  **Continuity of Normal Current**: In the absence of sources located precisely on the interface, the component of the total current density normal to the interface, $\mathbf{n} \cdot \mathbf{J}_{\text{total}}$, must be continuous. This ensures that charge does not pile up at the boundary. For the secondary currents, this means $\mathbf{n} \cdot \mathbf{J}^c$ is continuous, which translates to:
    $$ \mathbf{n} \cdot (\boldsymbol{\sigma}_1\nabla\phi_1) = \mathbf{n} \cdot (\boldsymbol{\sigma}_2\nabla\phi_2) $$

At the outermost boundary of the head, the scalp-air interface, the conductivity of air is effectively zero. Therefore, no current can flow from the scalp into the air. This imposes a **homogeneous Neumann boundary condition** on the potential :
$$ \mathbf{n} \cdot \mathbf{J}_{\text{total}} = \mathbf{n} \cdot (\boldsymbol{\sigma}_{\text{scalp}}\nabla\phi) = 0 $$
This condition states that the normal derivative of the potential at the scalp surface is zero.

A critical consequence of having a purely Neumann [boundary value problem](@entry_id:138753) is that the solution for the potential $\phi$ is not unique. If $\phi(\mathbf{r})$ is a solution, then $\phi(\mathbf{r}) + c$ is also a solution for any arbitrary constant $c$, because adding a constant does not change the gradient ($\nabla(\phi+c) = \nabla\phi$) and thus leaves both the governing PDE and the Neumann boundary condition unchanged. This is a form of **[gauge freedom](@entry_id:160491)** .

This mathematical ambiguity has a direct physical correlate: absolute potential is not a physically meaningful quantity; only potential *differences* are. All physical quantities, like the electric field $\mathbf{E} = -\nabla\phi$ and the current density $\mathbf{J}^c = -\boldsymbol{\sigma}\nabla\phi$, depend only on the gradient of the potential and are therefore unaffected by this additive constant.

In practice, EEG systems measure potential differences between electrodes. A measurement at an electrode $i$ is always made with respect to a [reference electrode](@entry_id:149412), $\mathbf{r}_{\text{ref}}$:
$$ V_i = \phi(\mathbf{r}_i) - \phi(\mathbf{r}_{\text{ref}}) $$
Choosing a reference electrode effectively "fixes the gauge" by removing the arbitrary constant $c$. If we change the absolute potential by $c$, the measured potential difference remains the same: $(\phi(\mathbf{r}_i)+c) - (\phi(\mathbf{r}_{\text{ref}})+c) = \phi(\mathbf{r}_i) - \phi(\mathbf{r}_{\text{ref}})$. Thus, **referencing** is the practical procedure for dealing with the inherent ambiguity of the absolute potential, and it has no effect on the underlying physical current flows in the head  .

### Modeling the Neural Sources

The primary current density $\mathbf{J}^p$ originates from the collective activity of large populations of neurons. For a source region that is small compared to its distance from the scalp electrodes, its contribution to the [far-field potential](@entry_id:268946) can be effectively approximated by an **[equivalent current dipole](@entry_id:1124623)** .

This simplified source model is characterized by a location $\mathbf{r}_0$ (the center of the active patch) and a vector quantity called the **dipole moment** $\mathbf{p}$. The dipole moment is defined as the integral of the primary current density over the source volume $V_s$:
$$ \mathbf{p} = \int_{V_s} \mathbf{J}^p(\mathbf{r}') \, \mathrm{d}V' $$
The units of $\mathbf{p}$ are ampere-meters (A·m). This single vector compactly represents the net strength and orientation of the distributed primary [current source](@entry_id:275668).

The biophysical origin of scalp-measurable EEG signals is primarily the post-synaptic potentials in the apical dendrites of large cortical pyramidal neurons. These neurons are oriented perpendicular to the cortical surface. When a population of such neurons in a cortical column is synchronously activated, the resulting net primary current flow is also predominantly normal to the cortical surface. This anatomical arrangement gives rise to two fundamental classes of equivalent dipoles:
*   **Radial Dipoles**: Located on the crown of a gyrus, where the cortical surface is parallel to the skull. The equivalent dipole is oriented radially (normal to the skull).
*   **Tangential Dipoles**: Located within the walls of a sulcus, where the cortical surface is perpendicular to the skull. The equivalent dipole is oriented tangentially (parallel to the skull).

### The Influence of Head Geometry and Conductivity

The complex layered structure of the head acts as a spatial filter, altering the electric fields generated by cortical sources as they propagate to the scalp. The most significant contributors to this filtering effect are the layers of cerebrospinal fluid (CSF) and the skull, due to their extreme conductivity values .

The CSF is highly conductive ($\sigma_{\text{csf}} \approx 1.8$ S/m, similar to saline), while the skull is highly resistive ($\sigma_{\text{skull}} \approx 0.01-0.02$ S/m). This creates a dramatic conductivity contrast of about 100:1. When volume currents from the brain reach the CSF-skull interface, they encounter a low-resistance path (tangentially within the CSF) and a high-resistance path (radially through the skull). Consequently, a large fraction of the current is diverted to flow laterally within the CSF layer before diffusely crossing the skull. This phenomenon is often called the **shunting effect** of the CSF.

This shunting and subsequent diffusion through the resistive skull has two major consequences for the scalp potential map:
1.  **Attenuation**: The spreading of current reduces the peak current density that reaches the scalp, leading to a significant reduction in the amplitude of the measured scalp potentials.
2.  **Spatial Blurring**: The tangential smearing of currents acts as a spatial low-pass filter, blurring the scalp potential topography. Sharp potential gradients are smoothed out, and the resulting patterns are broader and more diffuse than they would be at the cortical surface.

These filtering effects manifest differently for radial and tangential sources. The scalp potential topography produced by a **radial dipole** is characterized by a single, circularly symmetric extremum (either a peak or a trough) centered over the source's location . In contrast, a **tangential dipole** produces a characteristic **bipolar pattern**, with a lobe of positive potential and an adjacent lobe of negative potential, separated by a line of zero potential. The shunting effect of the CSF and the low-pass filtering of the skull tend to make the scalp patterns from both source types broad and smooth, with the smearing effect being particularly pronounced for radial sources whose currents are aimed directly at the resistive barrier .

### The Forward Operator: The Lead Field Matrix

In computational modeling, the source space is often discretized into a set of $N$ possible locations for equivalent current dipoles. At each location, the dipole can be represented by three orthogonal components (e.g., in x, y, z directions). The forward problem then becomes a linear mapping from the vector of all $3N$ dipole moment components, $\mathbf{p} \in \mathbb{R}^{3N}$, to the vector of potentials at the $M$ scalp electrodes, $\mathbf{v} \in \mathbb{R}^{M}$.

This linear relationship is captured by the **[lead field matrix](@entry_id:1127135)** (or **gain matrix**), $\mathbf{L} \in \mathbb{R}^{M \times 3N}$:
$$ \mathbf{v} = \mathbf{L}\mathbf{p} $$
The [lead field matrix](@entry_id:1127135) is the cornerstone of EEG [forward modeling](@entry_id:749528) and is essential for solving the inverse problem. Each column of $\mathbf{L}$ represents the vector of scalp potentials generated by a unit source dipole of a specific location and orientation. Therefore, one way to construct $\mathbf{L}$ is to solve the forward PDE $3N$ times, once for each canonical unit dipole, and record the resulting scalp potentials in the corresponding column of the matrix .

For a large number of potential sources, this direct construction can be computationally expensive. A more efficient method is provided by the **Helmholtz [principle of reciprocity](@entry_id:1130171)**. This fundamental theorem of linear, reciprocal media relates the solution of the original [forward problem](@entry_id:749531) to that of a "reciprocal" problem. In the context of EEG, it allows us to compute the lead field by simulating current injection at the electrodes rather than simulating sources in the brain .

The key result is the **lead field theorem for EEG**, which states that the lead field entry $L_{j,m}$—representing the potential at electrode $j$ due to a unit [dipole source](@entry_id:1123789) $m$ with location $\mathbf{r}_m$ and orientation $\mathbf{u}_m$—can be calculated as follows:
$$ L_{j,m} = \mathbf{u}_m \cdot \mathbf{E}^{(j)}(\mathbf{r}_m) $$
Here, $\mathbf{E}^{(j)}(\mathbf{r}_m)$ is the electric field that would be generated at the source location $\mathbf{r}_m$ if one were to perform a reciprocal experiment: inject a unit current into the head at electrode $j$ and withdraw it at the reference electrode. This expression is the dot product of the dipole's orientation vector with the reciprocal electric field vector at the dipole's location.

This powerful result means that to compute the entire [lead field matrix](@entry_id:1127135), we only need to solve the forward problem $M$ times (once for each electrode), rather than $3N$ times (once for each source component). Since the number of electrodes ($M \sim 32-256$) is typically far smaller than the number of potential sources ($N \sim 5000-15000$), the [reciprocity principle](@entry_id:175998) provides a dramatic increase in [computational efficiency](@entry_id:270255) for constructing the [lead field matrix](@entry_id:1127135) .