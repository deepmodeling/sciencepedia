## 引言
宏观脑信号，如脑电图（EEG）和脑磁图（MEG），为无创性地窥探人脑的动态活动提供了独特的窗口。理解这些复杂信号的起源及其与底层[神经计算](@entry_id:154058)的精确关系，是[计算神经科学](@entry_id:274500)领域的核心挑战，对于基础研究和临床诊断都至关重要。然而，从头皮记录到的毫伏级或飞特斯拉级的微弱信号，是数百万[神经元活动](@entry_id:174309)、经过颅骨和头皮扭曲和过滤后的复杂混合体。要从这些信号中准确解读大脑信息，我们必须首先回答一个根本问题：这些信号是如何产生的？它们的物理和生物学基础是什么？

本文旨在系统性地回答这些问题，为你构建一个关于宏观脑[信号建模](@entry_id:181485)的坚实知识框架。在“原理与机制”一章中，我们将深入物理学的核心，探讨[控制信号](@entry_id:747841)生成的电磁学定律和神经元层面的生物物理起源。接着，在“应用与交叉学科联系”一章中，我们将展示这些原理如何转化为强大的计算工具，用于解决从信号预测源活动（正向问题）和从信号反推源活动（逆向问题）的实际难题，并连接到[系统生物医学](@entry_id:900005)等前沿领域。最后，“动手实践”部分将提供具体的编程练习，让你亲手实现和验证关键的建模概念。

让我们从最基本的问题开始：是什么物理原理决定了神经元活动能够在大脑之外被我们探测到？

## 原理与机制

本章旨在深入探讨控制宏观脑信号（如脑电图EEG、脑磁图MEG和局部场电位LFP）生成与传播的基本物理原理和生物物理机制。我们将从电磁学的基本定律出发，建立一个描述神经活动如何在大脑容积导体中产生可测量信号的数学框架。随后的章节将在此基础上讨论更高级的建模技术和应用。

### 宏观信号的电磁学基础

描述生物组织中电磁现象的理论基石是麦克斯韦方程组。然而，对于频率相对较低的[神经信号](@entry_id:153963)（通常低于1 kHz），我们可以对这些方程进行一个至关重要的简化，即**准静态近似 (quasi-static approximation)**。

为了理解这一近似的合理性，我们考虑[安培-麦克斯韦定律](@entry_id:266368)，它描述了电流和变化的电场如何产生磁场。在传导性介质中，总电流密度包含两部分：由电荷载流子（主要是离子）的定向运动构成的**传导电流 (conduction current)** $\mathbf{J}_c = \boldsymbol{\sigma} \mathbf{E}$，以及由电场随时间变化产生的**位移电流 (displacement current)** $\mathbf{J}_d = \boldsymbol{\varepsilon} \frac{\partial \mathbf{E}}{\partial t}$。其中，$\boldsymbol{\sigma}$ 是[电导率张量](@entry_id:155827)，$\boldsymbol{\varepsilon}$ 是[介电常数张量](@entry_id:274052)，$\mathbf{E}$ 是电场。

对于一个[角频率](@entry_id:261565)为 $\omega$ 的正弦[时变场](@entry_id:180620)，这两个电流密度的振幅大小之比为：
$$ \frac{|\mathbf{J}_d|}{|\mathbf{J}_c|} = \frac{|\omega \boldsymbol{\varepsilon} \mathbf{E}|}{|\boldsymbol{\sigma} \mathbf{E}|} = \frac{\omega \varepsilon}{\sigma} $$
其中为简化起见，我们假设介质是各向同性的，即 $\boldsymbol{\sigma} = \sigma \mathbf{I}$ 和 $\boldsymbol{\varepsilon} = \varepsilon \mathbf{I}$。典型的脑灰质电导率约为 $\sigma = 0.3 \, \mathrm{S/m}$，而其在低频下的有效[相对介电常数](@entry_id:267815)由于[细胞膜](@entry_id:146704)的电容效应而非常高，可达 $\varepsilon_r \approx 10^5$，对应 $\varepsilon = \varepsilon_r \varepsilon_0 \approx 8.85 \times 10^{-7} \, \mathrm{F/m}$。我们可以计算出[传导电流](@entry_id:265343)和[位移电流](@entry_id:190231)大小相等的交叉频率 $f_c$ ：
$$ f_c = \frac{\sigma}{2\pi \varepsilon} \approx \frac{0.3}{2\pi \times 8.85 \times 10^{-7}} \approx 5.39 \times 10^4 \, \mathrm{Hz} $$
这个频率远高于神经生理信号的典型范围（例如，EEG/MEG通常关注100 Hz以下的信号）。因此，在研究宏观脑信号的频率范围内，我们总有 $\omega \varepsilon \ll \sigma$，这意味着位移电流可以忽略不计。

准静态近似有两个核心推论：
1.  **电场的无旋性**：由于磁场的时间变化率（[法拉第感应定律](@entry_id:146175)中的 $\partial \mathbf{B}/\partial t$ 项）与位移电流相关且同样可以忽略，电场近似为[无旋场](@entry_id:183486)，即 $\nabla \times \mathbf{E} \approx \mathbf{0}$。这使得我们可以引入一个标量电势 $\phi$，使得 $\mathbf{E} = -\nabla \phi$。
2.  **[电荷守恒](@entry_id:264158)**：[电荷连续性](@entry_id:747292)方程为 $\nabla \cdot \mathbf{J}_{\text{total}} = -\partial \rho / \partial t$。在准静态条件下，宏观尺度上的净电荷积聚速率 $\partial \rho / \partial t$ 也可以忽略不计，因此总电流密度近似为[无散场](@entry_id:260932)，即 $\nabla \cdot \mathbf{J}_{\text{total}} \approx 0$。

这两个推论构成了我们后续所有分析的基础，极大地简化了问题的数学描述。

### 脑组织中的[电流源](@entry_id:275668)

在准静态近似的框架下，我们需要仔细区分大脑中不同性质的电流。总电流密度 $\mathbf{J}_{\text{total}}$ 可以被分解为两个概念上截然不同的部分：**初级电流 (primary current)** $\mathbf{J}_p$ 和**容积电流 (volume current)** $\mathbf{J}_v$ 。

**初级电流** $\mathbf{J}_p$ 是由神经元跨膜离子流等生物化学过程直接驱动的“外加”电流。这些电流的产生不依赖于组织中的[宏观电场](@entry_id:196409) $\mathbf{E}$，而是由突触激活、[离子通道](@entry_id:170762)开放等细胞级事件决定。因此，$\mathbf{J}_p$ 在我们的模型中扮演着“源”的角色。

**容积电流** $\mathbf{J}_v$ 是对[宏观电场](@entry_id:196409) $\mathbf{E}$ 的被动响应，遵循欧姆定律 $\mathbf{J}_v = \boldsymbol{\sigma} \mathbf{E}$。它代表电荷在细胞外液这一导[电介质](@entry_id:266470)中的流动。它的作用是重新分配电荷，以确保在任何时刻都满足[电荷守恒](@entry_id:264158)定律。

#### 从细胞到连续介质：跨膜电流的作用

宏观的初级电流 $\mathbf{J}_p$ 最终起源于微观尺度上穿过神经元[细胞膜](@entry_id:146704)的离子流。我们可以定义一个[粗粒化](@entry_id:141933)的**跨膜电流密度 (transmembrane current density)** $i_m$（单位：A/m³），它表示单位体积组织内由细胞内流向细胞外的净电流。

根据[电荷守恒](@entry_id:264158)，电流从细胞内流出，必然成为细胞外空间的电流来源。因此，在细胞外空间，跨膜电流是容积电流的源，即 $\nabla \cdot \mathbf{J}_v = i_m$。同时，这股电流也必须是细胞内初级电流的汇，即 $\nabla \cdot \mathbf{J}_p = -i_m$ 。将这两个关系相加，我们得到 $\nabla \cdot (\mathbf{J}_p + \mathbf{J}_v) = 0$，这与我们之前基于准静态近似得到的[电荷守恒](@entry_id:264158)定律完全一致。这个关系明确指出，[细胞膜](@entry_id:146704)是连接初级电流和容积电流的桥梁，跨膜电流的分布决定了整个容积导体中电场和电势的模式。

### 场控制方程

基于对电流源和[准静态近似](@entry_id:167818)的理解，我们现在可以推导描述电势 $\phi$ 和磁场 $\mathbf{B}$ 的控制方程。

#### 电势的泊松方程

电势 $\phi$ 是EEG和LFP测量的核心物理量。它的控制方程可以直接从电荷守恒定律导出。将 $\mathbf{J}_{\text{total}} = \mathbf{J}_p + \mathbf{J}_v$、$\mathbf{J}_v = \boldsymbol{\sigma} \mathbf{E}$ 和 $\mathbf{E} = -\nabla\phi$ 代入 $\nabla \cdot \mathbf{J}_{\text{total}} = 0$，我们得到：
$$ \nabla \cdot (\mathbf{J}_p - \boldsymbol{\sigma} \nabla\phi) = 0 $$
整理后，便得到关于电势 $\phi$ 的一个类泊松方程 (Poisson-type equation)  ：
$$ \nabla \cdot (\boldsymbol{\sigma} \nabla\phi) = \nabla \cdot \mathbf{J}_p $$
这个方程是EEG和LFP正向建[模的基](@entry_id:156416)石。它表明，电[势场](@entry_id:143025) $\phi$ 的源是初级电流的散度 $\nabla \cdot \mathbf{J}_p$。而组织的电导率分布 $\boldsymbol{\sigma}(\mathbf{r})$ 和头部各组织的边界则通过调节容积电流 $\mathbf{J}_v$ 的路径来“塑造”电势在空间中的具体形态。因此，$\mathbf{J}_p$ 是驱动力，而 $\mathbf{J}_v$ (及其所依赖的 $\boldsymbol{\sigma}$) 是塑造者 。

#### 磁场的生成

对于MEG测量的磁场 $\mathbf{B}$，其来源是总电流密度 $\mathbf{J}_{\text{total}}$。在准静态近似下，[安培定律](@entry_id:140092)写作 $\nabla \times \mathbf{B} = \mu_0 \mathbf{J}_{\text{total}}$，其中 $\mu_0$ 是[真空磁导率](@entry_id:186031)。与电势不同，磁场是由电流的**环流 (curl)** 成分产生的。通过矢量恒等式，可以得到一个关于 $\mathbf{B}$ 的矢量泊松方程：
$$ -\nabla^2 \mathbf{B} = \mu_0 (\nabla \times \mathbf{J}_{\text{total}}) $$
这个方程表明，只有电流分布中具有非零环流的部分才能产生磁场 。

EEG和MEG之间的一个关键区别在于它们对容积电流的敏感性不同。对于一个理想化的球对称头部模型，可以证明，任何[径向对称](@entry_id:141658)的容积电流 $\mathbf{J}_v$ 在球外部产生的磁场为零。这意味着，在这种模型下，MEG信号几乎完全由初级电流 $\mathbf{J}_p$ 产生。特别是，纯径向的[电流偶极子](@entry_id:1123303)（例如位于脑回顶部的锥体细胞产生的电流）在球对称模型中是“MEG静默”的，即无法被外部磁场传感器探测到。这使得MEG对位于脑沟壁、其偶极子方向与头皮相切的神经活动源更为敏感。

### 神经信号的生物物理起源

理解了控制方程后，下一个关键问题是：大脑中纷繁复杂的神经活动，哪些是宏观信号的主要来源？

#### 开放场与闭合场：为何[突触后电位](@entry_id:177286)是主要来源

神经活动主要包括两种电事件：[动作电位](@entry_id:138506) (Action Potentials, APs) 和突触后电位 (Postsynaptic Potentials, PSPs)。尽管动作电位是神经元信息传递的基本单位，但宏观的EEG/MEG信号主要反映的是成千上万个[神经元同步](@entry_id:183156)产生的突触后电位之和。其原因在于源的几何构型和时间尺度 。

大脑皮层的[锥体细胞](@entry_id:1130331)具有特定的形态和排列方式，它们的顶树突大致相互平行并垂直于皮层表面。当这些细胞的顶树突接收到同步的突触输入时（例如，[兴奋性突触后电位](@entry_id:165648)，EPSP），会形成一个从树突（汇）流向胞体（源）的电流。由于细胞的平行排列，这些微小的[电流偶极子](@entry_id:1123303)在宏观尺度上会发生相长叠加，形成一个强大的等效电流源。这种构型被称为**开放场 (open-field)**。

相比之下，[动作电位](@entry_id:138506)是一个快速的电脉冲，涉及沿轴突传播的局部去极化和复极化过程。其电流回路非常局域化，源和汇相距很近，形成所谓的**闭合场 (closed-field)**。从远处看，这些紧邻的源汇产生的电磁场会相互抵消，其等效的偶极矩非常小，主要表现为衰减更快的[四极矩](@entry_id:157717)或更高阶的[多极矩](@entry_id:191120)。

此外，PSPs的持续时间（几十到上百毫秒）远长于APs（1-2毫秒），这为大量神经元实现时间上的同步提供了更大的可能性。一个简单的量化模型可以说明这一点 。假设一个神经元的PSP产生偶极矩 $Q_s = I_s L$，而AP产生有效偶极矩 $Q_{ap} = \varepsilon I_{ap} d$，其中 $L$ 是树突长度（~600 µm），$d$ 是AP源汇间距（~10 µm），$\varepsilon$ 是闭合场的抵消因子（~0.01）。同时，参与同步PSP的神经元比例 $c_s$（~0.1）也远高于能实现精密同步放电的神经元比例 $c_{ap}$（~0.001）。综合这些因素，[远场](@entry_id:269288)信号振幅之比 $A_{syn}/A_{ap} \propto (c_s I_s L) / (c_{ap} \varepsilon I_{ap} d)$ 可以达到 $10^5$ 的量级，清晰地表明了突触活动的主导地位。

### 容积传导与头部模型

神经源产生的电磁场必须穿过大脑、[脑脊液](@entry_id:898244)、颅骨和头皮才能到达外部传感器。这个过程被称为**容积传导 (volume conduction)**，它显著地影响了我们记录到的信号。

#### 组织界面上的边界条件

头部是由多种电导率差异巨大的组织构成的非均匀导体（例如，颅骨的电导率远低于脑组织）。在求解电势 $\phi$ 的控制方程时，必须在这些组织的界面上施加正确的边界条件 。

假设一个界面 $\Gamma$ 分隔了电导率为 $\sigma_1$ 和 $\sigma_2$ 的两种介质。根据电磁学原理，可以导出两条关键的边界条件：
1.  **电势的连续性**：$\phi_1 = \phi_2$。在界面两侧，电势值是相等的。物理上，这意味着界面上不存在无限薄的电偶极层。
2.  **法向电流密度的连续性**：$\mathbf{n} \cdot (-\sigma_1 \nabla\phi_1) = \mathbf{n} \cdot (-\sigma_2 \nabla\phi_2)$，其中 $\mathbf{n}$ 是界面的[法向量](@entry_id:264185)。这等价于 $\sigma_1 \frac{\partial\phi_1}{\partial n} = \sigma_2 \frac{\partial\phi_2}{\partial n}$。这个条件源于电荷守恒，即在没有表面源的情况下，流入界面的电流必须等于流出界面的电流。

一个直接的推论是，如果 $\sigma_1 \neq \sigma_2$，那么法向电场分量 $E_n = -\partial\phi/\partial n$ 必然是不连续的。这种不连续性对应于在界面上积聚的表面电荷层。正是这些在不同导电层界面上积聚的电荷，显著地改变了容积电流的路径，从而扭曲和重塑了头皮上的电势分布。

#### 头部作为空间低通滤波器

[容积传导](@entry_id:921795)的一个重要后果是空间滤波效应，特别是对于EEG信号。低电导率的颅骨对电[势场](@entry_id:143025)起到了“模糊”或“平滑”的作用。我们可以通过一个简化的平板模型来定量地理解这一点 。

假设颅骨和头皮是一个厚度为 $h$、电导率为 $\sigma$ 的均匀导电板。板的内表面（$z=-h$）的电势分布由大脑活动决定，记为 $\phi_b(x, y)$。板的外表面（$z=0$）与不导电的空气接触，因此法向电流为零（$\partial\phi/\partial z = 0$）。在该模型中[求解拉普拉斯方程](@entry_id:188506) $\nabla^2\phi = 0$，可以得到从内表面到外表面的传递函数 $T(k)$，它描述了空间频率为 $k$ 的电势分量在传播过程中的衰减程度。其解为：
$$ T(k) = \frac{\phi(k, z=0)}{\phi_b(k)} = \frac{1}{\cosh(kh)} $$
其中 $k$ 是[空间频率](@entry_id:270500)的大小。由于双曲余弦函数 $\cosh(x)$ 随 $x$ 的增加而迅速增长，这个结果表明，[空间频率](@entry_id:270500)越高（即电势模式变化越剧烈）的分量，其衰减越严重。换言之，头部作为容积导体，表现为一个**空间低通滤波器 (spatial low-pass filter)**，它削弱了信号的空间细节，限制了EEG的空间分辨率。

### 神经源建模

为了从记录到的宏观信号反推其神经起源（即所谓的“[逆问题](@entry_id:143129)”），我们需要对神经源本身进行简化建模。

#### [等效电流偶极子](@entry_id:1124623)

鉴于宏观信号主要来自大量神经元的同步活动，且传感器距离源区较远，我们可以将一个局部皮层活动区产生的复杂电流分布近似为一个等效的[点源](@entry_id:196698)。由于[生物电](@entry_id:177639)流源没有净的[单极矩](@entry_id:267768)（流入的电荷等于流出的电荷），在[远场](@entry_id:269288)条件下，其电磁场的[主导项](@entry_id:167418)是**[等效电流偶极子](@entry_id:1124623) (Equivalent Current Dipole, ECD)** 。

一个ECD由其位置 $\mathbf{r}_0$ 和偶极矩矢量 $\mathbf{p}$ 描述。偶极矩 $\mathbf{p}$ 是初级电流密度 $\mathbf{J}_p$ 在源区内的空间积分：
$$ \mathbf{p} = \int_{\text{source}} \mathbf{J}_p(\mathbf{r}') dV' $$
在无限均匀的导体中，这样一个ECD产生的[远场](@entry_id:269288)电势为：
$$ \phi(\mathbf{r}) \approx \frac{1}{4\pi\sigma} \frac{\mathbf{p} \cdot (\mathbf{r}-\mathbf{r}_0)}{|\mathbf{r}-\mathbf{r}_0|^3} $$
这个电[势场](@entry_id:143025)以 $1/R^2$ 的形式随距离 $R=|\mathbf{r}-\mathbf{r}_0|$ 衰减。ECD模型是EEG/MEG源定位算法中应用最广泛的源模型，它将一个分布式神经活动简化为几个待求解的参数（位置和矩），极大地简化了[逆问题](@entry_id:143129)。

#### 信号振幅与[神经元同步性](@entry_id:181049)

宏观信号的振幅不仅取决于参与活动的神经元数量 $N$，还强烈地依赖于它们活动的时间**同步性 (synchrony)**。我们可以通过一个简单的模型来量化这种关系 。

考虑 $N$ 个神经元（或神经元集群），每个都产生一个振幅为 $a$、频率为 $\omega$ 的[正弦信号](@entry_id:196767)，但各自具有一个随机相位 $\phi_k$。这些相位的分布可以用一个[冯·米塞斯分布](@entry_id:1133904) (von Mises distribution) 来描述，其集中参数 $\kappa$ 量化了同步程度：$\kappa=0$ 对应完全随机的相位（无同步），$\kappa \to \infty$ 对应完全一致的相位（完美同步）。

通过计算所有[信号叠加](@entry_id:276221)后的[均方根](@entry_id:263605)振幅 $A_{\text{rms}}$，可以得到：
$$ A_{\text{rms}} = a \sqrt{N \left(1 + (N - 1) \left(\frac{I_1(\kappa)}{I_0(\kappa)}\right)^2\right)} $$
其中 $I_0$ 和 $I_1$ 是修正的[贝塞尔函数](@entry_id:265752)。这个表达式揭示了两个重要的极限情况：
1.  **非[相干叠加](@entry_id:170209) (Incoherent Summation)**：当神经元活动完全不同步时（$\kappa \to 0$），$I_1(\kappa)/I_0(\kappa) \to 0$，$A_{\text{rms}} \approx a\sqrt{N}$。这类似于随机游走，总振幅与神经元数量的平方根成正比。
2.  **[相干叠加](@entry_id:170209) (Coherent Summation)**：当神经元活动[完全同步](@entry_id:267706)时（$\kappa \to \infty$），$I_1(\kappa)/I_0(\kappa) \to 1$，$A_{\text{rms}} \approx a\sqrt{N(1 + N - 1)} = aN$。此时，信号振幅与神经元数量成线性正比。

这个结果定量地表明，宏观信号的功率（振幅的平方）可以随着同步性的增强而获得巨大的提升（从 $\propto N$ 增长到 $\propto N^2$）。因此，EEG/MEG[信号功率](@entry_id:273924)的涨落，往往更多地反映了神经元集群同步性的变化，而非仅仅是参与活动神经元数量的增减。