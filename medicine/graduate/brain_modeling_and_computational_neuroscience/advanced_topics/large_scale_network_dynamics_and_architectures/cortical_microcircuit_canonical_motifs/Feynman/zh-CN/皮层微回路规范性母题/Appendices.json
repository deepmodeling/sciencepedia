{
    "hands_on_practices": [
        {
            "introduction": "一个核心的皮层微环路基元是兴奋性（E）和抑制性（I）神经元群体之间的循环连接。理解这些环路的响应特性是理解皮层计算的基础，但它们的行为往往是反直觉的。本练习将通过分析一个经典的双群体速率模型，来揭示一个关键的非直觉特性：抑制性稳定网络（Inhibitory Stabilized Network, ISN）中的“反常效应”（paradoxical effect）。通过严格的数学推导，我们将理解为何在某些条件下，对抑制性神经元施加额外的兴奋性输入反而会导致其发放率下降，这一发现对于我们理解大脑皮层如何在强烈的循环兴奋下维持稳定至关重要。",
            "id": "3973108",
            "problem": "考虑一个规范的双群体皮层微电路，该电路由一个兴奋性群体和一个抑制性群体组成，通过稳态下的耦合速率方程进行建模。设 $r_E$ 和 $r_I$ 分别表示兴奋性群体和抑制性群体的稳态发放率，设 $I_E$ 和 $I_I$ 表示它们的外部输入驱动。该网络遵循不动点方程\n$$\nr_E = \\phi_E\\!\\left(w_{EE}\\,r_E - w_{EI}\\,r_I + I_E\\right), \\quad\nr_I = \\phi_I\\!\\left(w_{IE}\\,r_E - w_{II}\\,r_I + I_I\\right),\n$$\n其中，$w_{EE} \\ge 0$ 和 $w_{IE} \\ge 0$ 分别表示到兴奋性群体和抑制性群体上的兴奋性突触耦合强度，$w_{EI} \\ge 0$ 和 $w_{II} \\ge 0$ 分别表示到兴奋性群体和抑制性群体上的抑制性突触耦合强度。函数 $\\phi_E(\\cdot)$ 和 $\\phi_I(\\cdot)$ 分别是兴奋性群体和抑制性群体的平滑、严格递增的输入-输出（电流-速率）传递函数。假设对于给定的输入对 $(I_E, I_I)$，网络存在一个唯一、稳定的不动点 $(r_E^{\\ast}, r_I^{\\ast})$，并设 $g_E = \\phi_E'\\!\\left(w_{EE}\\,r_E^{\\ast} - w_{EI}\\,r_I^{\\ast} + I_E\\right) > 0$ 和 $g_I = \\phi_I'\\!\\left(w_{IE}\\,r_E^{\\ast} - w_{II}\\,r_I^{\\ast} + I_I\\right) > 0$ 表示传递函数在该不动点处的局部增益（斜率）。\n\n仅使用围绕不动点进行线性化的第一性原理以及对稳态方程进行隐式微分，推导抑制性速率对其自身外部输入的敏感度的精确闭式表达式，\n$$\n\\frac{\\partial r_I^{\\ast}}{\\partial I_I},\n$$\n该表达式仅用参数 $g_E$、$g_I$、$w_{EE}$、$w_{EI}$、$w_{IE}$ 和 $w_{II}$ 来表示。然后，通过分析该表达式在对应于抑制性稳定网络（ISN）的 $g_E\\,w_{EE} > 1$ 条件下和对应于非ISN兴奋性子网络的 $g_E\\,w_{EE}  1$ 条件下的符号，解释为什么在ISN条件下该导数可以为负，而在非ISN条件下为正，假设不动点在这两种情况下都保持稳定。你的最终答案必须是 $\\partial r_I^{\\ast}/\\partial I_I$ 的单一闭式解析表达式。不需要四舍五入，也不需要单位。",
            "solution": "问题要求推导抑制性群体稳态发放率 $r_I^{\\ast}$ 对其自身外部输入 $I_I$ 的敏感度。此敏感度即为偏导数 $\\frac{\\partial r_I^{\\ast}}{\\partial I_I}$。推导必须基于第一性原理，具体而言，通过对稳态方程在不动点 $(r_E^{\\ast}, r_I^{\\ast})$ 附近进行线性化（通过隐式微分）来实现。\n\n稳态发放率由以下不动点方程定义：\n$$\nr_E = \\phi_E(w_{EE}\\,r_E - w_{EI}\\,r_I + I_E) \\quad (1)\n$$\n$$\nr_I = \\phi_I(w_{IE}\\,r_E - w_{II}\\,r_I + I_I) \\quad (2)\n$$\n在稳定不动点 $(r_E^{\\ast}, r_I^{\\ast})$ 处，这些方程成立。我们可以将 $r_E^{\\ast}$ 和 $r_I^{\\ast}$ 视为外部输入 $I_E$ 和 $I_I$ 的隐函数。为了求得 $\\frac{\\partial r_I^{\\ast}}{\\partial I_I}$，我们对两个方程关于 $I_I$ 求导，同时保持 $I_E$ 不变。在不动点处，传递函数的导数分别用 $g_E$ 和 $g_I$ 表示。\n\n首先，我们对等式 $(1)$ 关于 $I_I$ 求导：\n$$\n\\frac{\\partial r_E}{\\partial I_I} = \\frac{\\partial}{\\partial I_I} \\left[ \\phi_E(w_{EE}\\,r_E - w_{EI}\\,r_I + I_E) \\right]\n$$\n对右侧应用链式法则，得到：\n$$\n\\frac{\\partial r_E}{\\partial I_I} = \\phi_E'(w_{EE}\\,r_E - w_{EI}\\,r_I + I_E) \\cdot \\frac{\\partial}{\\partial I_I}(w_{EE}\\,r_E - w_{EI}\\,r_I + I_E)\n$$\n代入给定的定义 $g_E = \\phi_E'(\\cdot)$ 并计算内部导数（注意 $\\frac{\\partial I_E}{\\partial I_I} = 0$）：\n$$\n\\frac{\\partial r_E}{\\partial I_I} = g_E \\left( w_{EE}\\,\\frac{\\partial r_E}{\\partial I_I} - w_{EI}\\,\\frac{\\partial r_I}{\\partial I_I} \\right)\n$$\n重新整理此方程，将包含 $\\frac{\\partial r_E}{\\partial I_I}$ 和 $\\frac{\\partial r_I}{\\partial I_I}$ 的项分组：\n$$\n\\frac{\\partial r_E}{\\partial I_I} - g_E\\,w_{EE}\\,\\frac{\\partial r_E}{\\partial I_I} = -g_E\\,w_{EI}\\,\\frac{\\partial r_I}{\\partial I_I}\n$$\n$$\n(1 - g_E\\,w_{EE})\\frac{\\partial r_E}{\\partial I_I} + g_E\\,w_{EI}\\,\\frac{\\partial r_I}{\\partial I_I} = 0 \\quad (3)\n$$\n接下来，我们对等式 $(2)$ 关于 $I_I$ 求导：\n$$\n\\frac{\\partial r_I}{\\partial I_I} = \\frac{\\partial}{\\partial I_I} \\left[ \\phi_I(w_{IE}\\,r_E - w_{II}\\,r_I + I_I) \\right]\n$$\n应用链式法则：\n$$\n\\frac{\\partial r_I}{\\partial I_I} = \\phi_I'(w_{IE}\\,r_E - w_{II}\\,r_I + I_I) \\cdot \\frac{\\partial}{\\partial I_I}(w_{IE}\\,r_E - w_{II}\\,r_I + I_I)\n$$\n代入定义 $g_I = \\phi_I'(\\cdot)$ 并计算内部导数（注意 $\\frac{\\partial I_I}{\\partial I_I} = 1$）：\n$$\n\\frac{\\partial r_I}{\\partial I_I} = g_I \\left( w_{IE}\\,\\frac{\\partial r_E}{\\partial I_I} - w_{II}\\,\\frac{\\partial r_I}{\\partial I_I} + 1 \\right)\n$$\n重新整理此方程以对各项进行分组：\n$$\n\\frac{\\partial r_I}{\\partial I_I} = g_I\\,w_{IE}\\,\\frac{\\partial r_E}{\\partial I_I} - g_I\\,w_{II}\\,\\frac{\\partial r_I}{\\partial I_I} + g_I\n$$\n$$\n-g_I\\,w_{IE}\\,\\frac{\\partial r_E}{\\partial I_I} + (1 + g_I\\,w_{II})\\frac{\\partial r_I}{\\partial I_I} = g_I \\quad (4)\n$$\n等式 $(3)$ 和 $(4)$ 构成了一个关于两个未知数 $\\frac{\\partial r_E}{\\partial I_I}$ 和 $\\frac{\\partial r_I}{\\partial I_I}$ 的线性方程组。我们可以将此系统写成矩阵形式：\n$$\n\\begin{pmatrix}\n1 - g_E\\,w_{EE}  g_E\\,w_{EI} \\\\\n-g_I\\,w_{IE}  1 + g_I\\,w_{II}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{\\partial r_E}{\\partial I_I} \\\\\n\\frac{\\partial r_I}{\\partial I_I}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\ng_I\n\\end{pmatrix}\n$$\n我们希望求解 $\\frac{\\partial r_I}{\\partial I_I}$。使用克莱姆法则（Cramer's rule），解是两个行列式的比值。分母是系数矩阵的行列式，我们记为 $\\Delta$：\n$$\n\\Delta = \\det \\begin{pmatrix}\n1 - g_E\\,w_{EE}  g_E\\,w_{EI} \\\\\n-g_I\\,w_{IE}  1 + g_I\\,w_{II}\n\\end{pmatrix} = (1 - g_E\\,w_{EE})(1 + g_I\\,w_{II}) + g_E\\,g_I\\,w_{EI}\\,w_{IE}\n$$\n分子是将第二列替换为常数向量后形成的矩阵的行列式：\n$$\n\\Delta_I = \\det \\begin{pmatrix}\n1 - g_E\\,w_{EE}  0 \\\\\n-g_I\\,w_{IE}  g_I\n\\end{pmatrix} = (1 - g_E\\,w_{EE}) g_I\n$$\n因此 $\\frac{\\partial r_I}{\\partial I_I}$ 的解为 $\\frac{\\Delta_I}{\\Delta}$：\n$$\n\\frac{\\partial r_I^{\\ast}}{\\partial I_I} = \\frac{g_I (1 - g_E w_{EE})}{(1 - g_E w_{EE})(1 + g_I w_{II}) + g_E g_I w_{EI} w_{IE}}\n$$\n这就是所要求的闭式表达式。\n\n现在，我们分析这个表达式的符号。问题陈述不动点是稳定的。网络动力学的稳定性由系统雅可比矩阵的特征值决定。该雅可比矩阵的行列式与分母 $\\Delta$ 成正比。稳定性的一个必要条件是该行列式必须为正。因此，稳定性假设意味着 $\\Delta  0$。鉴于此，$\\frac{\\partial r_I^{\\ast}}{\\partial I_I}$ 的符号完全由其分子 $g_I (1 - g_E w_{EE})$ 的符号决定。由于已知 $g_I  0$，符号取决于项 $(1 - g_E w_{EE})$。\n\n情况1：非ISN情况（$g_E\\,w_{EE}  1$）。\n在这种情况下，兴奋性子网络是内在地稳定的。条件 $g_E\\,w_{EE}  1$ 意味着 $(1 - g_E w_{EE})  0$。分子为正，分母为正。因此，\n$$\n\\frac{\\partial r_I^{\\ast}}{\\partial I_I}  0\n$$\n解释：在这种情况下，对抑制性群体的外部驱动 $I_I$ 的增加会导致其发放率 $r_I$ 的增加。这是一个直观的结果。$I_I$ 对I群体的直接兴奋作用主导了网络的反馈效应。反馈回路如下：$r_I$ 的增加会抑制E群体，从而降低 $r_E$。$r_E$ 的降低减少了对I群体的兴奋性输入，这与 $r_I$ 的初始上升相拮抗。然而，由于兴奋性回路连接较弱（$g_E w_{EE}  1$），这种间接的负反馈通路不足以克服直接驱动，净效应是 $r_I$ 的增加。\n\n情况2：抑制性稳定网络（ISN）情况（$g_E\\,w_{EE}  1$）。\n在这种情况下，兴奋性子网络本身是不稳定的；如果没有抑制性反馈，其活动将不受控制地增长。条件 $g_E\\,w_{EE}  1$ 意味着 $(1 - g_E w_{EE})  0$。此时分子为负，而由于整个网络的稳定性，分母保持为正。因此，\n$$\n\\frac{\\partial r_I^{\\ast}}{\\partial I_I}  0\n$$\n解释：这是ISN的一个标志性的悖论效应。对抑制性群体的外部驱动 $I_I$ 的增加，反而导致其稳态发放率 $r_I$ 的净减少。其机制如下：$I_I$ 的微小增加会引起 $r_I$ 的瞬间增加。这种增强的抑制作用强力地抑制了具有强回路连接的兴奋性群体，导致 $r_E$ 的显著下降。条件 $g_E w_{EE}  1$ 表明E群体处于高增益、放大状态，因此来自I细胞的少量额外抑制会导致E细胞活动的巨大减少。$r_E$ 的大幅下降导致从I群体中撤出了大量的兴奋性驱动（$w_{IE}r_E$）。这种兴奋性驱动的撤出非常强烈，以至于它压倒了来自 $I_I$ 的初始直接增加，导致I群体总输入的净减少，从而其发放率 $r_I$ 下降。网络的稳定性由强大、快速的抑制性反馈维持，但这导致了对外部输入的反直觉响应。",
            "answer": "$$\n\\boxed{\\frac{g_I (1 - g_E w_{EE})}{(1 - g_E w_{EE})(1 + g_I w_{II}) + g_E g_I w_{EI} w_{IE}}}\n$$"
        },
        {
            "introduction": "除了对稳定输入的静态响应外，兴奋性-抑制性（E-I）平衡网络还能够产生节律性振荡，这是大脑中普遍存在的一种动态活动模式。本练习将带领我们从静态分析过渡到动态分析，探讨同一个E-I环路是如何在稳定不动点（fixed-point）和极限环振荡（limit-cycle oscillation）这两种功能状态之间轉換的。我们将运用动力学系统中的分岔理论，通过对系统雅可比矩阵的分析，推导出发生霍普夫分岔（Hopf bifurcation）的临界条件。这个练习不仅能锻炼我们的数学分析能力，还能帮助我们深刻理解皮层网络如何根据其内在参数（如循环兴奋强度）在不同的计算模式（如“赢家通吃”或“节律同步”）之间切换。",
            "id": "3973179",
            "problem": "考虑一个由一个兴奋性群体和一个抑制性群体组成的最小循环皮层微电路基序，该基序由具有一阶突触动力学的 Wilson–Cowan 型率方程建模。设兴奋性和抑制性膜变量分别由 $x_{E}(t)$ 和 $x_{I}(t)$ 表示，其对应的发放率分别为 $r_{E}(t) = \\phi_{E}(x_{E}(t))$ 和 $r_{I}(t) = \\phi_{I}(x_{I}(t))$，其中 $\\phi_{E}$ 和 $\\phi_{I}$ 是 S 型输入输出函数。耦合动力学方程为\n$$\n\\tau_{E} \\frac{d x_{E}}{d t} = - x_{E} + w_{EE}\\,r_{E} - w_{EI}\\,r_{I} + I_{E}, \\quad\n\\tau_{I} \\frac{d x_{I}}{d t} = - x_{I} + w_{IE}\\,r_{E} - w_{II}\\,r_{I} + I_{I},\n$$\n其中 $\\tau_{E}  0$ 和 $\\tau_{I}  0$ 是突触时间常数，$w_{EE} \\geq 0$ 是兴奋-兴奋耦合，$w_{EI} \\geq 0$ 是抑制-兴奋耦合，$w_{IE} \\geq 0$ 是兴奋-抑制耦合，$w_{II} \\geq 0$ 是抑制-抑制耦合，以及 $I_{E}, I_{I}$ 是恒定输入。\n\n假设系统存在一个稳定不动点 $(x_{E}^{\\ast}, x_{I}^{\\ast})$，在该点处增益 $g_{E} := \\phi_{E}'(x_{E}^{\\ast})  0$ 和 $g_{I} := \\phi_{I}'(x_{I}^{\\ast})  0$ 是有限的。从光滑动力系统的线性化和局部分岔理论的第一性原理出发，推导当不动点经历 Hopf 分岔（即稳态机制与振荡机制之间的边界）时，临界兴奋性自耦合 $w_{EE}^{\\mathrm{H}}$ 的解析表达式。您的推导必须从不动点处的线性化雅可比矩阵开始，并援引二维连续时间系统中 Hopf 分岔的充分必要条件。您可以将 $g_{E}$ 和 $g_{I}$ 保留为符号形式。清晰地陈述发生 Hopf 分岔必须满足的任何中间条件，但最终报告的量必须是 $w_{EE}^{\\mathrm{H}}$ 的闭式解析表达式。\n\n在您的解释中，简要证明为什么二维光滑率模型不能表现出确定性混沌，并从宏观层面指出，要产生混沌动力学需要增加何种典型的微电路元件。将您推导出的分岔边界与典型的微电路功能联系起来，例如赢者通吃稳态和节律性兴奋-抑制（E–I）相互作用。无需进行数值评估，最终表达式中不应包含任何单位。最终答案必须是 $w_{EE}^{\\mathrm{H}}$ 的单个闭式符号表达式。",
            "solution": "本题的解答始于对给定的Wilson-Cowan模型的动力学方程进行线性化分析，以研究其在不动点附近的稳定性。\n\n双群体率模型的动力学由以下常微分方程组给出：\n$$\n\\dot{x}_{E} = \\frac{1}{\\tau_{E}} \\left( -x_{E} + w_{EE}\\,\\phi_{E}(x_{E}) - w_{EI}\\,\\phi_{I}(x_{I}) + I_{E} \\right)\n$$\n$$\n\\dot{x}_{I} = \\frac{1}{\\tau_{I}} \\left( -x_{I} + w_{IE}\\,\\phi_{E}(x_{E}) - w_{II}\\,\\phi_{I}(x_{I}) + I_{I} \\right)\n$$\n设状态向量为 $\\mathbf{x} = \\begin{pmatrix} x_{E} \\\\ x_{I} \\end{pmatrix}$。该系统可以写成 $\\dot{\\mathbf{x}} = \\mathbf{F}(\\mathbf{x})$。为了分析不动点 $\\mathbf{x}^{\\ast} = \\begin{pmatrix} x_{E}^{\\ast} \\\\ x_{I}^{\\ast} \\end{pmatrix}$ 的稳定性，我们通过计算该不动点处的雅可比矩阵 $J$ 来对系统进行线性化。雅可比矩阵的元素由 $J_{ij} = \\frac{\\partial F_{i}}{\\partial x_{j}}$ 给出，其中 $F_{1} = \\dot{x}_{E}$ 和 $F_{2} = \\dot{x}_{I}$。\n\n偏导数如下：\n$$\n\\frac{\\partial F_{1}}{\\partial x_{E}} = \\frac{1}{\\tau_{E}} \\left( -1 + w_{EE} \\frac{d\\phi_{E}}{dx_{E}} \\right)\n$$\n$$\n\\frac{\\partial F_{1}}{\\partial x_{I}} = \\frac{1}{\\tau_{E}} \\left( -w_{EI} \\frac{d\\phi_{I}}{dx_{I}} \\right)\n$$\n$$\n\\frac{\\partial F_{2}}{\\partial x_{E}} = \\frac{1}{\\tau_{I}} \\left( w_{IE} \\frac{d\\phi_{E}}{dx_{E}} \\right)\n$$\n$$\n\\frac{\\partial F_{2}}{\\partial x_{I}} = \\frac{1}{\\tau_{I}} \\left( -1 - w_{II} \\frac{d\\phi_{I}}{dx_{I}} \\right)\n$$\n在不动点 $(x_{E}^{\\ast}, x_{I}^{\\ast})$ 处对这些求值，并使用给定的增益定义 $g_{E} = \\phi_{E}'(x_{E}^{\\ast})$ 和 $g_{I} = \\phi_{I}'(x_{I}^{\\ast})$，雅可比矩阵为：\n$$\nJ = \\begin{pmatrix}\n\\frac{-1 + w_{EE}g_{E}}{\\tau_{E}}  \\frac{-w_{EI}g_{I}}{\\tau_{E}} \\\\\n\\frac{w_{IE}g_{E}}{\\tau_{I}}  \\frac{-1 - w_{II}g_{I}}{\\tau_{I}}\n\\end{pmatrix}\n$$\n当雅可比矩阵的一对共轭复特征值穿过虚轴时，发生 Hopf 分岔。对于一个二维系统，这要求在分岔点满足两个条件：\n1. 雅可比矩阵的迹必须为零：$\\mathrm{Tr}(J) = 0$。\n2. 雅可比矩阵的行列式必须为正：$\\mathrm{Det}(J)  0$。\n\n雅可比矩阵 $J$ 的迹是其对角元素之和：\n$$\n\\mathrm{Tr}(J) = \\frac{-1 + w_{EE}g_{E}}{\\tau_{E}} + \\frac{-1 - w_{II}g_{I}}{\\tau_{I}}\n$$\n我们将迹设为零，以找到 $w_{EE}$ 的临界值，我们将其表示为 $w_{EE}^{\\mathrm{H}}$。\n$$\n\\frac{-1 + w_{EE}^{\\mathrm{H}}g_{E}}{\\tau_{E}} + \\frac{-1 - w_{II}g_{I}}{\\tau_{I}} = 0\n$$\n为了求解 $w_{EE}^{\\mathrm{H}}$，我们重排方程：\n$$\n\\frac{-1 + w_{EE}^{\\mathrm{H}}g_{E}}{\\tau_{E}} = - \\left( \\frac{-1 - w_{II}g_{I}}{\\tau_{I}} \\right) = \\frac{1 + w_{II}g_{I}}{\\tau_{I}}\n$$\n$$\n-1 + w_{EE}^{\\mathrm{H}}g_{E} = \\frac{\\tau_{E}}{\\tau_{I}}(1 + w_{II}g_{I})\n$$\n$$\nw_{EE}^{\\mathrm{H}}g_{E} = 1 + \\frac{\\tau_{E}}{\\tau_{I}}(1 + w_{II}g_{I})\n$$\n$$\nw_{EE}^{\\mathrm{H}} = \\frac{1}{g_{E}} \\left[ 1 + \\frac{\\tau_{E}}{\\tau_{I}}(1 + w_{II}g_{I}) \\right]\n$$\n通过通分，该表达式可以重写为：\n$$\nw_{EE}^{\\mathrm{H}} = \\frac{1}{g_{E}} \\left[ \\frac{\\tau_{I} + \\tau_{E}(1 + w_{II}g_{I})}{\\tau_{I}} \\right] = \\frac{1}{\\tau_{I}g_{E}} \\left[ \\tau_{I} + \\tau_{E}(1 + w_{II}g_{I}) \\right]\n$$\n这就是 Hopf 分岔处临界兴奋性自耦合的解析表达式。\n\n接下来，我们必须确保第二个条件 $\\mathrm{Det}(J)  0$ 成立。$J$ 的行列式为：\n$$\n\\mathrm{Det}(J) = \\left( \\frac{-1 + w_{EE}g_{E}}{\\tau_{E}} \\right) \\left( \\frac{-1 - w_{II}g_{I}}{\\tau_{I}} \\right) - \\left( \\frac{-w_{EI}g_{I}}{\\tau_{E}} \\right) \\left( \\frac{w_{IE}g_{E}}{\\tau_{I}} \\right)\n$$\n在分岔点 $w_{EE} = w_{EE}^{\\mathrm{H}}$ 处，我们使用从 $\\mathrm{Tr}(J)=0$ 推导出的关系：$\\frac{-1 + w_{EE}^{\\mathrm{H}}g_{E}}{\\tau_{E}} = \\frac{1 + w_{II}g_{I}}{\\tau_{I}}$。将此代入行列式表达式：\n$$\n\\mathrm{Det}(J) = \\left( \\frac{1 + w_{II}g_{I}}{\\tau_{I}} \\right) \\left( \\frac{-1 - w_{II}g_{I}}{\\tau_{I}} \\right) + \\frac{w_{EI}w_{IE}g_{E}g_{I}}{\\tau_{E}\\tau_{I}}\n$$\n$$\n\\mathrm{Det}(J) = -\\frac{(1 + w_{II}g_{I})^2}{\\tau_{I}^2} + \\frac{w_{EI}w_{IE}g_{E}g_{I}}{\\tau_{E}\\tau_{I}}\n$$\n为了使 $\\mathrm{Det}(J)  0$，必须满足以下关于电路参数的中间条件：\n$$\n\\frac{w_{EI}w_{IE}g_{E}g_{I}}{\\tau_{E}\\tau_{I}}  \\frac{(1 + w_{II}g_{I})^2}{\\tau_{I}^2} \\implies w_{EI}w_{IE}g_{E}g_{I}  \\frac{\\tau_{E}}{\\tau_{I}}(1 + w_{II}g_{I})^2\n$$\n该条件确保了在分岔点处的特征值确实是一对纯虚数，从而导致振荡，而不是无振荡的简单稳定性改变（如果 $\\mathrm{Det}(J) \\leq 0$ 则会发生后者）。\n\n关于额外的问题：一个二维光滑连续时间动力系统，例如所描述的系统，不能表现出确定性混沌。这是 Poincaré–Bendixson 定理的直接推论。该定理指出，对于一个二维系统，任何保持在不包含不动点的平面的闭合有界子集中的轨线，都必须渐近地趋向于一个周期轨道（极限环）。混沌轨线是有界的但非周期的，并且不趋向于任何不动点或周期轨道。在二维相空间中，解轨线不能相交（由于唯一性），因此非周期、有界的轨线若不最终与自身相交便无法存在。因此，该模型能产生的最复杂的行为是稳定的极限环振荡。要产生混沌动力学，系统的状态空间必须至少是三维的。一个能实现这一点的典型微电路元件是增加第三个状态变量，例如第二个不同的抑制性群体（如与第一个小白蛋白阳性神经元抑制性群体相互作用的生长抑素阳性中间神经元），或一个活动依赖性适应机制（如尖峰频率适应），它会引入自己的一阶动力学，从而将系统维度增加到三。\n\n推导出的分岔边界 $w_{EE}^{\\mathrm{H}}$ 将皮层微电路的两种功能上不同的机制分开。当 $w_{EE}  w_{EE}^{\\mathrm{H}}$ 时，雅可比矩阵的迹为负，不动点是稳定的。网络在响应恒定输入 $I_E$ 和 $I_I$ 时会稳定在一个恒定的发放率。这种机制支持静态计算，例如在赢者通吃网络中看到的那些，其中电路在竞争者中选择一个单一表征并将其保持为稳态。当 $w_{EE}  w_{EE}^{\\mathrm{H}}$ 时，迹变为正，不动点变得不稳定，并出现一个稳定的极限环。网络产生自发的、节律性的振荡，其中兴奋性和抑制性群体以协调的、周期性的方式发放。这种振荡机制是产生脑节律（如伽马振荡）的典型模型，这些节律对于时间编码、大脑区域间的通信和感觉处理至关重要。参数 $w_{EE}$ 代表循环兴奋的强度，分析表明，足够的正反馈可以使静态失稳，并将 E-I 电路推入动态的、振荡的操作模式。",
            "answer": "$$\n\\boxed{\\frac{1}{\\tau_I g_E} \\left( \\tau_I + \\tau_E (1 + w_{II} g_I) \\right)}\n$$"
        },
        {
            "introduction": "为了更深入地理解皮层计算的时间动态，我们需要超越简单的速率模型，并考虑更具生物真实性的细节，例如突触的短期可塑性（short-term plasticity）和中间神经元的多样性。本练习将构建一个包含小白蛋白（Parvalbumin, PV）和生长抑素（Somatostatin, SOM）两种不同中间神经元的微环路模型，它们分别接收来自兴奋性神经元的具有短时程抑制和短时程易化特性的兴奋性突触输入。通过一个基于 Tsodyks-Markram 模型的编码实践，我们将模拟在阵发性发放刺激下，这两种神经元如何产生动态变化的抑制性输出，并最终影响锥体神经元树突上的信号整合。这个练习将展示不同类型的神经元及其独特的突触特性如何协同工作，实现对皮层信息处理的精确时间调控。",
            "id": "3973193",
            "problem": "考虑一个由单个兴奋性群体（$E$）、一个从 $E$ 接收具有短时程抑制（depressing）特性的兴奋性突触的表达小白蛋白的中间神经元（Parvalbumin-expressing (PV)）以及一个从 $E$ 接收具有短时程易化（facilitating）特性的兴奋性突触的表达生长抑素的中间神经元（Somatostatin-expressing (SOM)）组成的最小正则皮层微回路。两种中间神经元都抑制单个锥体神经元（$P$）：PV 提供快速的胞体周围抑制，而 SOM 提供较慢的树突抑制，后者可以门控树突棘波。该微路由一阵 $E$ 峰冲动驱动。\n\n基本和核心定义：\n- 短期突触可塑性使用 Tsodyks-Markram 形式主义进行建模。每个突触由两个状态变量表征：利用率 $u(t)$ 和可用资源 $x(t)$，以及用于易化和抑制的参数 $(U,\\tau_f,\\tau_d)$。在突触前峰冲动时间 $t_k$ 时，瞬时有效突触幅度由 $a_k = g_{\\max}\\,u_k^-\\,x_k^-$ 给出，其中 $u_k^-$ 和 $x_k^-$ 表示峰冲动前的瞬时值。峰冲动时的更新为\n$$\nu_k^+ = u_k^- + U(1 - u_k^-), \\quad x_k^+ = x_k^-(1 - u_k^+),\n$$\n在峰冲动间隔 $\\Delta t$ 内的衰减为\n$$\nu_{k+1}^- = u_k^+ e^{-\\Delta t/\\tau_f} + U \\left(1 - e^{-\\Delta t/\\tau_f}\\right), \\quad x_{k+1}^- = 1 - \\left(1 - x_k^+\\right) e^{-\\Delta t/\\tau_d}.\n$$\n- $P$ 上的突触后抑制性电导被建模为由中间神经元峰冲动触发的指数和。对于在时间 $s_i$ 到达的每个抑制性峰冲动，其电导贡献为 $g_i(t) = g_{\\text{inh,max}}\\,H(t-s_i)\\,e^{-(t - s_i)/\\tau_{\\text{inh}}}$，其中 $H(\\cdot)$ 是赫维赛德阶跃函数。$P$ 上的总抑制性电导为 $g_{\\text{tot}}(t) = g_{\\text{PV}}(t) + g_{\\text{SOM}}(t)$，即 PV 和 SOM 贡献的总和。\n- 中间神经元的峰冲动被近似为对每个峰冲动的传入兴奋性电导的阈值检测器：如果 $a_k^{E\\to \\text{PV}} \\ge g_{\\text{th,PV}}$，则 PV 对每个 $E$ 峰冲动发放一个峰冲动；如果 $a_k^{E\\to \\text{SOM}} \\ge g_{\\text{th,SOM}}$，则 SOM 对每个 $E$ 峰冲动发放一个峰冲动。\n\n微回路参数（在所有测试案例中固定）：\n- 对于具有短时程抑制的 $E\\to\\text{PV}$ 突触：$U_{\\text{PV}}=0.5$，$\\tau_{f,\\text{PV}}=50\\,\\mathrm{ms}$，$\\tau_{d,\\text{PV}}=800\\,\\mathrm{ms}$，$g_{\\max,\\text{PV-ex}}=0.7$（归一化电导单位），阈值 $g_{\\text{th,PV}}=0.25$。\n- 对于具有短时程易化的 $E\\to\\text{SOM}$ 突触：$U_{\\text{SOM}}=0.05$，$\\tau_{f,\\text{SOM}}=600\\,\\mathrm{ms}$，$\\tau_{d,\\text{SOM}}=200\\,\\mathrm{ms}$，$g_{\\max,\\text{SOM-ex}}=0.7$（归一化电导单位），阈值 $g_{\\text{th,SOM}}=0.15$。\n- 传导和处理延迟：$d_{E\\to\\text{PV}}=1\\,\\mathrm{ms}$，PV 处理延迟 $t_{\\text{lat,PV}}=1\\,\\mathrm{ms}$，$d_{\\text{PV}\\to P}=1\\,\\mathrm{ms}$；$d_{E\\to\\text{SOM}}=2\\,\\mathrm{ms}$，SOM 处理延迟 $t_{\\text{lat,SOM}}=4\\,\\mathrm{ms}$，$d_{\\text{SOM}\\to P}=2\\,\\mathrm{ms}$。因此，总抑制性到达延迟为 $D_{\\text{PV}}=d_{E\\to\\text{PV}}+t_{\\text{lat,PV}}+d_{\\text{PV}\\to P}=3\\,\\mathrm{ms}$ 和 $D_{\\text{SOM}}=d_{E\\to\\text{SOM}}+t_{\\text{lat,SOM}}+d_{\\text{SOM}\\to P}=8\\,\\mathrm{ms}$。\n- $P$ 上的抑制性突触动力学：$g_{\\text{inh,max,PV}}=0.6$，$\\tau_{\\text{inh,PV}}=8\\,\\mathrm{ms}$；$g_{\\text{inh,max,SOM}}=0.8$，$\\tau_{\\text{inh,SOM}}=30\\,\\mathrm{ms}$。\n- 净抑制阈值：$g_{\\text{net}}=0.10$（归一化电导单位）用于定义起始时间。\n- 树突棘波参考时间：$E$ 脉冲串以 $d_{E\\to \\text{dend}}=5\\,\\mathrm{ms}$ 的延迟到达树突；在没有抑制的情况下，预期的树突棘波时间是 $t_{\\text{ds}} = d_{E\\to \\text{dend}} + (N-1)\\Delta t + t_{\\text{lat,ds}}$，其中 $t_{\\text{lat,ds}}=3\\,\\mathrm{ms}$。树突棘波门控标准：如果 $g_{\\text{SOM}}(t_{\\text{ds}}) \\ge g_{\\text{gate}}$，则 SOM 抑制门控树突棘波，其中 $g_{\\text{gate}}=0.35$。\n- 所有时间量均以毫秒（$\\mathrm{ms}$）为单位。所有电导均以归一化单位表示，阈值如上所述。\n\n任务：\n- 给定一个包含 $N$ 个兴奋性峰冲动、峰冲动间隔为 $\\Delta t$（单位 $\\mathrm{ms}$）的脉冲串，从 $t_0=0$ 开始，使用 Tsodyks-Markram 动力学计算序列 $\\{a_k^{E\\to \\text{PV}}\\}$ 和 $\\{a_k^{E\\to \\text{SOM}}\\}$。使用阈值规则和延迟 $D_{\\text{PV}}$ 和 $D_{\\text{SOM}}$ 来确定 PV 和 SOM 抑制性峰冲动到达 $P$ 的时间。\n- 将 $g_{\\text{PV}}(t)$ 和 $g_{\\text{SOM}}(t)$ 构建为其各自抑制性峰冲动的指数和。计算净抑制时间 $t^\\star$，定义为满足 $g_{\\text{tot}}(t) \\ge g_{\\text{net}}$ 的最早时间 $t$。如果在模拟窗口内从未超过此阈值，则为 $t^\\star$ 返回 $-1.0$。\n- 计算门控结果：评估 $g_{\\text{SOM}}(t_{\\text{ds}})$，如果 $g_{\\text{SOM}}(t_{\\text{ds}})\\ge g_{\\text{gate}}$ 则输出整数 $1$，否则输出 $0$。\n\n答案要求：\n- 程序必须实现这些动力学，并为以下 $(N,\\Delta t)$ 值（所有 $\\Delta t$ 单位为 $\\mathrm{ms}$）的测试套件计算输出：\n    1. $(N=5,\\Delta t=5)$\n    2. $(N=3,\\Delta t=12)$\n    3. $(N=8,\\Delta t=2)$\n    4. $(N=1,\\Delta t=10)$\n- 对于每个测试案例，输出必须是一个列表 $[t^\\star, b]$，其中 $t^\\star$ 是四舍五入到一位小数的净抑制起始时间（单位 $\\mathrm{ms}$），$b$ 是整数门控标志（$0$ 或 $1$）。如果不存在起始时间，则 $t^\\star$ 必须是 $-1.0$。\n- 您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，每个测试案例表示为其自己的方括号列表，例如：“[[t1,b1],[t2,b2],[t3,b3],[t4,b4]]”。\n\n科学真实性和推导期望：\n- 从上述基于守恒的 Tsodyks-Markram 方程和指数突触动力学开始。除了这些经过充分测试的模型之外，不要引入任何快捷公式。明确地将抑制性与易化性行为与参数 $(U,\\tau_f,\\tau_d)$ 联系起来，并展示脉冲串时序如何塑造 PV 与 SOM 的峰冲动发放，以及由此产生的抑制时序和树突门控。\n- 不涉及角度。时间必须按规定以 $\\mathrm{ms}$ 为单位报告，门控标志为整数（$0$ 或 $1$）。不需要也不允许使用百分比。",
            "solution": "本题的解答通过对每个给定的参数集 $(N, \\Delta t)$ 模拟指定的皮层微环路动力学来进行。模拟可分为以下几个步骤：\n\n### 1. 建模突触可塑性和中间神经元峰冲动发放\n模拟的核心涉及跟踪从兴奋性群体 ($E$) 到小白蛋白 (PV) 和生长抑素 (SOM) 中间神经元的突触状态。我们使用提供的 Tsodyks-Markram (TM) 模型方程。对于每种突触类型 ($c \\in \\{\\text{PV}, \\text{SOM}\\}$），我们跟踪利用率变量 $u_c(t)$ 和资源变量 $x_c(t)$。\n\n一个兴奋性脉冲串由 $N$ 个峰冲动组成，时间点为 $t_k = k \\cdot \\Delta t$，其中 $k=0, 1, ..., N-1$。在第一个峰冲动 $t_0=0$ 之前，假定突触处于静息状态。对于无限长的前置峰冲动间隔，TM 动力学的稳态解给出了第一个峰冲动之前的初始条件：$x^-(t_0) = 1$ 和 $u^-(t_0) = U$。\n\n对于在时间 $t_k$ 的每个兴奋性峰冲动，我们为 E$\\to$PV 和 E$\\to$SOM 突触执行以下步骤：\na. **计算瞬时幅度**：有效突触幅度是使用峰冲动前的状态变量计算的：\n$$\na_k = g_{\\max} \\, u_k^- \\, x_k^-\n$$\nb. **确定中间神经元峰冲动发放**：将此幅度与中间神经元的峰冲动发放阈值 $g_{\\text{th}}$进行比较。如果 $a_k \\ge g_{\\text{th}}$，则中间神经元发放一个峰冲动。此抑制性峰冲动到达锥体神经元 $P$ 的时间是通过将总延迟 $D_c$ 加到突触前峰冲动时间上来计算的：$s_i = t_k + D_c$。收集 PV 和 SOM 神经元的这些到达时间。\nc. **更新突触状态**：更新状态变量以反映 $t_k$ 时峰冲动的影响。利用率变量增加，资源变量减少：\n$$\nu_k^+ = u_k^- + U(1 - u_k^-)\n$$\n$$\nx_k^+ = x_k^-(1 - u_k^+)\n$$\nd. **模拟峰冲动间隔衰减**：状态变量随后在后续的峰冲动间隔 $\\Delta t$ 内演化。它们根据以下公式向各自的稳态值衰减：\n$$\nu_{k+1}^- = u_k^+ e^{-\\Delta t/\\tau_f} + U \\left(1 - e^{-\\Delta t/\\tau_f}\\right)\n$$\n$$\nx_{k+1}^- = 1 - (1 - x_k^+) e^{-\\Delta t/\\tau_d}\n$$\n这些值 $u_{k+1}^-$ 和 $x_{k+1}^-$ 成为下一个兴奋性峰冲动 $t_{k+1}$ 的新的峰冲动前状态。\n\n对脉冲串中的所有 $N$ 个峰冲动重复此过程，产生两个到达神经元 $P$ 的抑制性峰冲动时间列表：一个用于 PV 峰冲动，一个用于 SOM 峰冲动。E$\\to$PV（短时程抑制）和 E$\\to$SOM（短时程易化）突触的对比参数 ($U, \\tau_f, \\tau_d$) 导致两种中间神经元根据脉冲串频率 ($1/\\Delta t$) 产生不同的峰冲动发放模式。\n\n### 2. 计算总抑制性电导和起始时间 $t^{\\star}$\n神经元 $P$ 上的总抑制性电导 $g_{\\text{tot}}(t)$ 是所有 PV 和 SOM 峰冲动贡献的总和：\n$$\ng_{\\text{tot}}(t) = g_{\\text{PV}}(t) + g_{\\text{SOM}}(t)\n$$\n其中每个分量是在峰冲动到达时间 $\\{s_i\\}$ 处启动的衰减指数之和：\n$$\ng_c(t) = \\sum_{s_i \\in \\text{spikes}_c} g_{\\text{inh,max},c} \\, H(t-s_i) \\, e^{-(t - s_i)/\\tau_{\\text{inh},c}}\n$$\n我们的任务是找到净抑制起始时间 $t^\\star$，定义为 $g_{\\text{tot}}(t) \\ge g_{\\text{net}} = 0.10$ 的最早时间 $t$。\n\n函数 $g_{\\text{tot}}(t)$ 是衰减指数的和。在抑制性峰冲动到达之间，其值是严格递减的。它仅在抑制性峰冲动到达神经元 $P$ 的瞬间不连续地增加。因此，第一次可能超过阈值 $g_{\\text{net}}$ 的时间必须恰好是这些到达时间之一。这允许对 $t^\\star$ 进行高效和精确的计算，而无需进行细粒度的时间步长模拟。\n\n算法如下：\n1.  将所有 PV 和 SOM 峰冲动到达时间合并到一个列表中，并按升序排序：$S = \\{s_1, s_2, ..., s_M\\}$。\n2.  如果列表 $S$ 为空（没有产生抑制性峰冲动），则 $t^\\star = -1.0$。\n3.  否则，遍历排序后的到达时间 $s_j \\in S$。对于每个 $s_j$，计算总电导 $g_{\\text{tot}}(s_j)$。\n4.  第一个满足 $g_{\\text{tot}}(s_j) \\ge g_{\\text{net}}$ 的时间 $s_j$ 就是所需的起始时间 $t^\\star$。然后终止搜索。\n5.  如果循环完成但条件从未满足，则阈值从未被超过，$t^\\star = -1.0$。\n\n### 3. 确定树突棘波门控结果\n第二个要求的输出是一个二进制标志，指示 SOM 抑制是否足够强以门控树突棘波。这是通过在特定时间点 $t_{\\text{ds}}$ 将 SOM 介导的电导 $g_{\\text{SOM}}(t)$ 与门控阈值 $g_{\\text{gate}}$ 进行比较来确定的。\n\n树突棘波的参考时间 $t_{\\text{ds}}$ 是根据最后一个兴奋性峰冲动的时序计算的，并包括树突和处理延迟：\n$$\nt_{\\text{ds}} = d_{E\\to \\text{dend}} + (N-1)\\Delta t + t_{\\text{lat,ds}} = 5 + (N-1)\\Delta t + 3 = 8 + (N-1)\\Delta t\n$$\n然后在此特定时间计算 SOM 电导的值：\n$$\ng_{\\text{SOM}}(t_{\\text{ds}}) = \\sum_{s_i \\in \\text{spikes}_{\\text{SOM}}} g_{\\text{inh,max,SOM}} \\, H(t_{\\text{ds}}-s_i) \\, e^{-(t_{\\text{ds}} - s_i)/\\tau_{\\text{inh,SOM}}}\n$$\n如果 $g_{\\text{SOM}}(t_{\\text{ds}}) \\ge g_{\\text{gate}}=0.35$，则门控标志 $b$ 设置为 $1$，否则为 $0$。\n\n对测试套件中的每个 $(N, \\Delta t)$ 对实施这些步骤以生成最终结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the cortical microcircuit problem for all test cases.\n    \"\"\"\n\n    # Fixed parameters for the microcircuit model\n    params = {\n        # E-PV synapse (depressing)\n        'U_pv': 0.5, 'tau_f_pv': 50.0, 'tau_d_pv': 800.0,\n        'g_max_pv_ex': 0.7, 'g_th_pv': 0.25,\n        # E-SOM synapse (facilitating)\n        'U_som': 0.05, 'tau_f_som': 600.0, 'tau_d_som': 200.0,\n        'g_max_som_ex': 0.7, 'g_th_som': 0.15,\n        # Delays\n        'D_pv': 3.0,  # d_E-PV (1) + t_lat,PV (1) + d_PV-P (1)\n        'D_som': 8.0, # d_E-SOM (2) + t_lat,SOM (4) + d_SOM-P (2)\n        # Inhibitory synapses onto P\n        'g_inh_max_pv': 0.6, 'tau_inh_pv': 8.0,\n        'g_inh_max_som': 0.8, 'tau_inh_som': 30.0,\n        # Net inhibitory onset threshold\n        'g_net': 0.10,\n        # Dendritic spike gating parameters\n        'd_E_dend': 5.0, 't_lat_ds': 3.0, 'g_gate': 0.35,\n    }\n\n    test_cases = [\n        (5, 5.0),\n        (3, 12.0),\n        (8, 2.0),\n        (1, 10.0),\n    ]\n\n    results = []\n    for N, delta_t in test_cases:\n        result = simulate_case(N, delta_t, params)\n        results.append(result)\n\n    # Format the final output as specified\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\ndef simulate_case(N, delta_t, p):\n    \"\"\"\n    Simulates one test case (N, delta_t) and returns [t_star, b].\n    \"\"\"\n    # --- 1. Simulate synaptic dynamics and interneuron spiking ---\n    pv_spike_arrivals = []\n    som_spike_arrivals = []\n\n    # Initial state (at rest before first spike)\n    u_pv, x_pv = p['U_pv'], 1.0\n    u_som, x_som = p['U_som'], 1.0\n\n    for k in range(N):\n        e_spike_time = k * delta_t\n\n        # E - PV synapse\n        a_pv = p['g_max_pv_ex'] * u_pv * x_pv\n        if a_pv = p['g_th_pv']:\n            pv_spike_arrivals.append(e_spike_time + p['D_pv'])\n        \n        # Update PV state (spike part)\n        u_pv_plus = u_pv + p['U_pv'] * (1 - u_pv)\n        x_pv_plus = x_pv * (1 - u_pv_plus)\n\n        # E - SOM synapse\n        a_som = p['g_max_som_ex'] * u_som * x_som\n        if a_som = p['g_th_som']:\n            som_spike_arrivals.append(e_spike_time + p['D_som'])\n            \n        # Update SOM state (spike part)\n        u_som_plus = u_som + p['U_som'] * (1 - u_som)\n        x_som_plus = x_som * (1 - u_som_plus)\n\n        if k  N - 1: # No need to calculate decay after the last spike\n            # Update PV state (decay part)\n            exp_f_pv = np.exp(-delta_t / p['tau_f_pv'])\n            exp_d_pv = np.exp(-delta_t / p['tau_d_pv'])\n            u_pv = u_pv_plus * exp_f_pv + p['U_pv'] * (1 - exp_f_pv)\n            x_pv = 1 - (1 - x_pv_plus) * exp_d_pv\n\n            # Update SOM state (decay part)\n            exp_f_som = np.exp(-delta_t / p['tau_f_som'])\n            exp_d_som = np.exp(-delta_t / p['tau_d_som'])\n            u_som = u_som_plus * exp_f_som + p['U_som'] * (1 - exp_f_som)\n            x_som = 1 - (1 - x_som_plus) * exp_d_som\n\n    # --- 2. Calculate net inhibitory onset time t_star ---\n    all_arrivals = sorted(list(set(pv_spike_arrivals + som_spike_arrivals)))\n    t_star = -1.0\n\n    if all_arrivals:\n        for t in all_arrivals:\n            g_pv_t = 0.0\n            for s in pv_spike_arrivals:\n                if t = s:\n                    g_pv_t += p['g_inh_max_pv'] * np.exp(-(t - s) / p['tau_inh_pv'])\n            \n            g_som_t = 0.0\n            for s in som_spike_arrivals:\n                if t = s:\n                    g_som_t += p['g_inh_max_som'] * np.exp(-(t - s) / p['tau_inh_som'])\n\n            g_total = g_pv_t + g_som_t\n\n            if g_total = p['g_net']:\n                t_star = t\n                break\n    \n    # --- 3. Compute gating outcome b ---\n    t_ds = p['d_E_dend'] + (N - 1) * delta_t + p['t_lat_ds']\n    g_som_at_tds = 0.0\n    for s in som_spike_arrivals:\n        if t_ds = s:\n            g_som_at_tds += p['g_inh_max_som'] * np.exp(-(t_ds - s) / p['tau_inh_som'])\n            \n    b = 1 if g_som_at_tds = p['g_gate'] else 0\n\n    return [np.round(t_star, 1), b]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}