{
    "hands_on_practices": [
        {
            "introduction": "原始的纤维束示踪（tractography）输出，即流线（streamline）计数，是衡量连接权重 $A_{ij}$ 的一种有偏估计。本练习探讨了如何超越简单的计数，获得更具生物物理意义的连接权重。您将学习如何使用先进的方法，如球形反卷积信息流线滤波（SIFT）和基于微结构信息示踪的凸优化建模（COMMIT），来校准每条流线的贡献，这是构建一个有效的结构连接组的关键一步 。",
            "id": "3972555",
            "problem": "您将获得一个通过纤维束成像技术衍生的结构连接性数据集，其中包含一组有限的感兴趣区域和一组有限的纤维束流线。在此类数据集中，每条纤维束流线是轴突束的算法替代物，但已知原始纤维束流线计数会受到局部追踪参数、曲率和长度的偏差影响。对于一对区域 $i,j$，一个具有物理可解释性的边权重是连接 $i$ 和 $j$ 的轴突总横截面积，记为 $A_{ij}$，单位为平方毫米 (mm$^2$)。每个体素包含测得的纤维体积（源自扩散建模），其定义为纤维体积分数 $f_v$ 乘以体素体积 $V_v$，记为 $b_v = f_v V_v$，单位为立方毫米 (mm$^3$)。每条纤维束流线 $k$ 穿过一条路径，在体素 $v$ 内部贡献了一段长度 $l_{vk}$，单位为毫米 (mm)。体素 $v$ 中的总纤维体积可以通过“体积等于横截面积乘以路径长度”这一原理从纤维束流线近似得出，从而得到以下守恒定律：\n$$\n\\sum_{k=1}^{K} w_k \\, l_{vk} \\approx b_v,\n$$\n其中 $w_k$ 是分配给纤维束流线 $k$ 的有效横截面积，单位为 mm$^2$，$K$ 是纤维束流线的总数，$v$ 是体素的索引。对于一条边 $(i,j)$，基于物理原理的权重是：\n$$\nA_{ij} \\equiv \\sum_{k \\in \\mathcal{E}_{ij}} w_k,\n$$\n其中 $\\mathcal{E}_{ij}$ 是连接区域 $i$ 和 $j$ 的纤维束流线集合。\n\n从以下基本依据出发：\n- 纤维体积的定义为横截面积乘以长度，即对每个线段，体积等于面积 $\\times$ 长度，且体素纤维体积 $b_v$ 是该体素内部所有贡献的总和。\n- 算法得出的纤维束流线计数 $S_{ij}$ 是一个代理变量，需要经过校准才能与物理面积相关联。\n- 最小二乘法拟合原理，即选择模型参数以最小化建模量与测量量之间的平方差之和，并通过非负性约束来确保面积的物理合理性。\n\n您的任务是：\n1. 使用每条纤维束流线的恒定横截面积 $a_0$ 来定义朴素边权重，得到 $A_{ij}^{\\text{naive}} = a_0 S_{ij}$。此方法仅使用纤维束流线计数 $S_{ij}$ 和一个校准常数 $a_0$（单位为 mm$^2$/纤维束流线）。\n2. 实现一种简化的球面反卷积信息引导的纤维束成像筛选 (Spherical-deconvolution Informed Filtering of Tractograms, SIFT) 方法（首次出现时需正式定义为“球面反卷积信息引导的纤维束成像筛选 (SIFT)”）。通过寻找一个统一应用于所有纤维束流线的全局缩放因子 $\\alpha \\ge 0$，使得建模的体素纤维体积\n$$\n\\hat{b}_v(\\alpha) = \\sum_{k=1}^{K} (\\alpha a_0) l_{vk}\n$$\n能够最小化总平方误差 $\\sum_v \\left(\\hat{b}_v(\\alpha) - b_v\\right)^2$。使用最小二乘最优性条件推导出 $\\alpha$ 的公式，并强制 $\\alpha \\ge 0$。然后，SIFT校正的边权重为 $A_{ij}^{\\text{SIFT}} = \\alpha a_0 S_{ij}$。单位必须为 mm$^2$。\n3. 实现一种简化的基于微结构信息的纤维束成像凸优化建模 (Convex Optimization Modeling for Microstructure Informed Tractography, COMMIT) 方法（首次出现时需正式定义为“基于微结构信息的纤维束成像凸优化建模 (COMMIT)”）。通过求解非负最小二乘问题\n$$\n\\min_{\\mathbf{w} \\ge 0} \\left\\| \\mathbf{A}\\mathbf{w} - \\mathbf{b} \\right\\|_2^2,\n$$\n其中 $\\mathbf{A} \\in \\mathbb{R}^{V \\times K}$ 的元素为 $A_{vk} = l_{vk}$，$\\mathbf{w} \\in \\mathbb{R}^K$ 包含纤维束流线面积 $w_k$（单位为 mm$^2$），$\\mathbf{b} \\in \\mathbb{R}^{V}$ 包含测得的体素纤维体积 $b_v$（单位为 mm$^3$）。对于边 $(i,j)$，COMMIT校正的边权重为 $A_{ij}^{\\text{COMMIT}} = \\sum_{k \\in \\mathcal{E}_{ij}} w_k$。单位必须为 mm$^2$。\n\n此问题不涉及角度单位。所有长度必须以毫米 (mm) 为单位，体积以立方毫米 (mm$^3$) 为单位，面积以平方毫米 (mm$^2$) 为单位。您的程序必须为每个测试用例计算三元组 $\\left[A_{ij}^{\\text{naive}}, A_{ij}^{\\text{SIFT}}, A_{ij}^{\\text{COMMIT}}\\right]$，并将其作为浮点数以 mm$^2$ 为单位输出，每个数值都需四舍五入到恰好六位小数。\n\n测试套件：\n- 测试用例 1（单一边，两个体素）：\n  - $\\mathbf{A} = \\begin{bmatrix} 1.2  0.5  0.3 \\\\ 0.8  1.0  0.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.24 \\\\ 0.16 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束流线到边的映射：所有3条纤维束流线都属于边 (1,2),\n  - 报告边 (1,2),\n  - $a_0 = 0.05$ (mm$^2$/纤维束流线)。\n- 测试用例 2a（共享的纤维束成像图，边 (1,2)）：\n  - $\\mathbf{A} = \\begin{bmatrix} 0.9  0.7  0.0  0.1 \\\\ 0.4  0.2  0.6  0.5 \\\\ 0.0  0.1  0.8  1.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.25 \\\\ 0.225 \\\\ 0.30 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束流线到边的映射：前2条纤维束流线属于边 (1,2)，后2条属于边 (2,3),\n  - 报告边 (1,2),\n  - $a_0 = 0.04$ (mm$^2$/纤维束流线)。\n- 测试用例 2b（共享的纤维束成像图，边 (2,3)）：\n  - 与测试用例2a相同的 $\\mathbf{A}$ 和 $\\mathbf{b}$,\n  - 纤维束流线到边的映射：前2条纤维束流线属于边 (1,2)，后2条属于边 (2,3),\n  - 报告边 (2,3),\n  - $a_0 = 0.04$ (mm$^2$/纤维束流线)。\n- 测试用例 3（零纤维体积边界）：\n  - $\\mathbf{A} = \\begin{bmatrix} 1.0  1.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.0 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束流线到边的映射：所有2条纤维束流线都属于边 (3,4),\n  - 报告边 (3,4),\n  - $a_0 = 0.03$ (mm$^2$/纤维束流线)。\n- 测试用例 4（过定单纤维束流线拟合）：\n  - $\\mathbf{A} = \\begin{bmatrix} 1.0 \\\\ 1.0 \\end{bmatrix}$ (mm),\n  - $\\mathbf{b} = \\begin{bmatrix} 0.3 \\\\ 0.1 \\end{bmatrix}$ (mm$^3$),\n  - 纤维束流线到边的映射：单条纤维束流线属于边 (4,5),\n  - 报告边 (4,5),\n  - $a_0 = 0.02$ (mm$^2$/纤维束流线)。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献其三元组 $\\left[A_{ij}^{\\text{naive}}, A_{ij}^{\\text{SIFT}}, A_{ij}^{\\text{COMMIT}}\\right]$（单位 mm$^2$），并四舍五入至六位小数。例如，程序必须打印一个包含五个内部列表的列表的字符串表示形式，每个内部列表格式为 $[x_1,x_2,x_3]$，最终输出类似于 $[[t_{1,1},t_{1,2},t_{1,3}],[t_{2,1},t_{2,2},t_{2,3}],\\ldots]$。",
            "solution": "该问题陈述具有科学依据、良定且客观。它提出了连接组学领域一个有效的计算问题，具体涉及校准源自扩散磁共振成像纤维束追踪技术的结构连接性权重。所提供的数据和数学公式是自洽且一致的。\n\n任务是使用三种不同的方法计算结构性脑网络的边权重：一种基于朴素纤维束流线计数的方法，一种简化的全局筛选方法 (SIFT)，以及一种更复杂的针对特定纤维束流线的优化方法 (COMMIT)。对于每种方法，我们将推导其公式，然后将其应用于提供的测试用例。所有数学实体，包括变量、数字和运算符，都按要求使用 LaTeX 格式。\n\n### 1. 朴素边权重 ($A_{ij}^{\\text{naive}}$)\n\n该模型是估计连接强度最直接但在生物物理学上过于简化的方法。它假设每条算法生成的纤维束流线对连接两个区域的总轴突横截面积的贡献是相同且恒定的。\n\n连接区域 $i$ 和区域 $j$ 的朴素边权重 $A_{ij}^{\\text{naive}}$ 定义为连接这些区域的纤维束流线数量 $S_{ij}$ 与一个预定义的、每条纤维束流线的恒定横截面积 $a_0$ 的乘积。$a_0$ 的单位是 mm$^2$/纤维束流线，$S_{ij}$ 是一个无量纲的计数值，因此得到的权重 $A_{ij}^{\\text{naive}}$ 的单位正确地为 mm$^2$。\n\n公式如下：\n$$\nA_{ij}^{\\text{naive}} = a_0 S_{ij}\n$$\n其中 $S_{ij} = |\\mathcal{E}_{ij}|$ 是连接区域 $i$ 和 $j$ 的纤维束流线集合的基数。\n\n### 2. SIFT校正的边权重 ($A_{ij}^{\\text{SIFT}}$)\n\n球面反卷积信息引导的纤维束成像筛选 (SIFT) 方法旨在通过将纤维束流线与底层的生物物理测量值相关联来改进朴素模型。其核心思想是强制要求穿过每个体素的纤维束流线总体积与该体素内测得的纤维体积保持一致。\n\n在这个简化版本中，我们寻找一个单一的全局缩放因子 $\\alpha \\ge 0$，该因子被统一应用于所有纤维束流线的横截面积。体素 $v$ 中的建模纤维体积 $\\hat{b}_v(\\alpha)$ 是该体素内所有纤维束流线段体积的总和：\n$$\n\\hat{b}_v(\\alpha) = \\sum_{k=1}^{K} w_k l_{vk} = \\sum_{k=1}^{K} (\\alpha a_0) l_{vk} = \\alpha a_0 \\sum_{k=1}^{K} l_{vk}\n$$\n这里，$w_k = \\alpha a_0$ 是每条纤维束流线 $k$ 的统一缩放面积，$l_{vk}$ 是纤维束流线 $k$ 在体素 $v$ 中的长度。\n\n我们通过最小化所有 $V$ 个体素上建模的体素体积 $\\hat{b}_v(\\alpha)$ 与测得的体素纤维体积 $b_v$ 之间的总平方误差 $E(\\alpha)$ 来确定最优的 $\\alpha$：\n$$\nE(\\alpha) = \\sum_{v=1}^{V} \\left(\\hat{b}_v(\\alpha) - b_v\\right)^2 = \\sum_{v=1}^{V} \\left( \\alpha a_0 \\sum_{k=1}^{K} l_{vk} - b_v \\right)^2\n$$\n为了找到最小值，我们计算 $E(\\alpha)$ 关于 $\\alpha$ 的导数并将其设为零：\n$$\n\\frac{dE}{d\\alpha} = \\sum_{v=1}^{V} 2 \\left( \\alpha a_0 \\sum_{k=1}^{K} l_{vk} - b_v \\right) \\left( a_0 \\sum_{k=1}^{K} l_{vk} \\right) = 0\n$$\n假设 $a_0 \\neq 0$，我们可以简化为：\n$$\n\\sum_{v=1}^{V} \\left( \\alpha a_0 \\left(\\sum_{k=1}^{K} l_{vk}\\right)^2 - b_v \\sum_{k=1}^{K} l_{vk} \\right) = 0\n$$\n求解 $\\alpha$：\n$$\n\\alpha a_0 \\sum_{v=1}^{V} \\left(\\sum_{k=1}^{K} l_{vk}\\right)^2 = \\sum_{v=1}^{V} b_v \\left(\\sum_{k=1}^{K} l_{vk}\\right)\n$$\n$$\n\\alpha = \\frac{\\sum_{v=1}^{V} b_v \\left(\\sum_{k=1}^{K} l_{vk}\\right)}{a_0 \\sum_{v=1}^{V} \\left(\\sum_{k=1}^{K} l_{vk}\\right)^2}\n$$\n在矩阵表示法中，设 $\\mathbf{A}$ 是一个 $V \\times K$ 矩阵，其元素为 $l_{vk}$；$\\mathbf{b}$ 是一个 $V \\times 1$ 的测量体积向量；$\\mathbf{1}$ 是一个 $K \\times 1$ 的全一向量。令 $\\mathbf{c} = \\mathbf{A}\\mathbf{1}$。向量 $\\mathbf{c}$ 的元素为 $c_v = \\sum_{k=1}^{K} l_{vk}$。$\\alpha$ 的公式变为：\n$$\n\\alpha = \\frac{\\mathbf{b}^T \\mathbf{c}}{a_0 (\\mathbf{c}^T \\mathbf{c})} = \\frac{\\mathbf{b}^T (\\mathbf{A}\\mathbf{1})}{a_0 \\|\\mathbf{A}\\mathbf{1}\\|_2^2}\n$$\n为了强制执行物理约束 $\\alpha \\ge 0$，我们取该值与零之间的最大值。\n$$\n\\alpha = \\max\\left(0, \\frac{\\mathbf{b}^T (\\mathbf{A}\\mathbf{1})}{a_0 \\|\\mathbf{A}\\mathbf{1}\\|_2^2}\\right)\n$$\n然后使用这个全局因子 $\\alpha$ 计算SIFT校正的边权重：\n$$\nA_{ij}^{\\text{SIFT}} = \\alpha a_0 S_{ij}\n$$\n\n### 3. COMMIT校正的边权重 ($A_{ij}^{\\text{COMMIT}}$)\n\n基于微结构信息的纤维束成像凸优化建模 (COMMIT) 框架提供了一个功能更强大且更灵活的模型。它不是应用单一的全局校正因子，而是为每条纤维束流线分配一个独立的横截面积 $w_k \\ge 0$。这使得模型能够考虑到不同纤维束可能具有不同的密度和属性。\n\n该模型假设一个体素中测得的纤维体积 $b_v$ 是穿过该体素的每条纤维束流线贡献的线性和：\n$$\n\\sum_{k=1}^{K} w_k l_{vk} \\approx b_v\n$$\n对于所有体素，这可以同时写成矩阵方程 $\\mathbf{A}\\mathbf{w} \\approx \\mathbf{b}$，其中 $\\mathbf{A}$ 是线段长度 $l_{vk}$ 的矩阵，$\\mathbf{w}$ 是未知的纤维束流线面积 $w_k$ 的向量，$\\mathbf{b}$ 是测得的体素体积 $b_v$ 的向量。\n\n未知的权重 $\\mathbf{w}$ 是通过求解非负最小二乘 (NNLS) 问题找到的，该问题在横截面积不能为负的物理约束下，最小化平方误差：\n$$\n\\min_{\\mathbf{w} \\ge 0} \\|\\mathbf{A}\\mathbf{w} - \\mathbf{b}\\|_2^2\n$$\n这是一个标准的凸优化问题，可以进行数值求解。一旦找到最优向量 $\\mathbf{w}^* = [w_1^*, w_2^*, \\dots, w_K^*]^T$，连接 $(i,j)$ 的COMMIT校正边权重就是构成该边的所有纤维束流线面积的总和：\n$$\nA_{ij}^{\\text{COMMIT}} = \\sum_{k \\in \\mathcal{E}_{ij}} w_k^*\n$$\n该方法优于 SIFT，因为它可以通过为伪迹纤维束流线分配权重 $w_k^*=0$ 来“修剪”它们，并且即使纤维束流线属于同一条边，也可以对它们进行差异化加权，从而反映出更复杂的底层生物学原理。\n\n每个测试用例的步骤是：\n1.  识别纤维束流线的数量 $S_{ij}$以及对应于目标边 $(i, j)$ 的索引。\n2.  使用给定的 $a_0$ 和 $S_{ij}$ 计算 $A_{ij}^{\\text{naive}}$。\n3.  为SIFT模型计算全局标量 $\\alpha$，然后计算 $A_{ij}^{\\text{SIFT}}$。\n4.  求解向量 $\\mathbf{w}$ 的NNLS问题，并对适当的元素求和以找到 $A_{ij}^{\\text{COMMIT}}$。\n5.  按要求格式化结果三元组 $[A_{ij}^{\\text{naive}}, A_{ij}^{\\text{SIFT}}, A_{ij}^{\\text{COMMIT}}]$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Computes and prints structural connectivity edge weights using Naive, SIFT, and COMMIT models.\n    \"\"\"\n    test_cases = [\n        # Test Case 1: single edge, two voxels\n        {\n            \"A\": np.array([[1.2, 0.5, 0.3], [0.8, 1.0, 0.0]]),\n            \"b\": np.array([0.24, 0.16]),\n            \"edge_indices\": [0, 1, 2],  # All 3 streamlines for edge (1,2)\n            \"a0\": 0.05\n        },\n        # Test Case 2a: shared tractogram, edge (1,2)\n        {\n            \"A\": np.array([[0.9, 0.7, 0.0, 0.1], \n                           [0.4, 0.2, 0.6, 0.5], \n                           [0.0, 0.1, 0.8, 1.0]]),\n            \"b\": np.array([0.25, 0.225, 0.30]),\n            \"edge_indices\": [0, 1],  # First 2 streamlines for edge (1,2)\n            \"a0\": 0.04\n        },\n        # Test Case 2b: shared tractogram, edge (2,3)\n        {\n            \"A\": np.array([[0.9, 0.7, 0.0, 0.1],\n                           [0.4, 0.2, 0.6, 0.5],\n                           [0.0, 0.1, 0.8, 1.0]]),\n            \"b\": np.array([0.25, 0.225, 0.30]),\n            \"edge_indices\": [2, 3],  # Last 2 streamlines for edge (2,3)\n            \"a0\": 0.04\n        },\n        # Test Case 3: zero fiber volume boundary\n        {\n            \"A\": np.array([[1.0, 1.0]]),\n            \"b\": np.array([0.0]),\n            \"edge_indices\": [0, 1],  # Both 2 streamlines for edge (3,4)\n            \"a0\": 0.03\n        },\n        # Test Case 4: overdetermined single-streamline fit\n        {\n            \"A\": np.array([[1.0], [1.0]]),\n            \"b\": np.array([0.3, 0.1]),\n            \"edge_indices\": [0],  # The single streamline for edge (4,5)\n            \"a0\": 0.02\n        }\n    ]\n\n    all_results_formatted = []\n\n    for case in test_cases:\n        A = case[\"A\"]\n        b = case[\"b\"]\n        edge_indices = case[\"edge_indices\"]\n        a0 = case[\"a0\"]\n\n        # Number of streamlines for the target edge\n        S_ij = len(edge_indices)\n\n        # 1. Naive model\n        A_naive = a0 * S_ij\n\n        # 2. SIFT model\n        # The vector c has elements c_v = sum_k l_vk\n        # This is equivalent to summing each row of A, or A @ 1_K\n        c = A.sum(axis=1)\n        \n        numerator = b.dot(c)\n        denominator_part = c.dot(c)\n        \n        alpha = 0.0\n        # Avoid division by zero if all streamline lengths are zero\n        if denominator_part > 1e-12:\n            alpha = numerator / (a0 * denominator_part)\n        \n        # Enforce non-negativity constraint\n        alpha = max(0.0, alpha)\n        \n        A_sift = alpha * a0 * S_ij\n\n        # 3. COMMIT model\n        # Solve the non-negative least squares problem: min ||Aw - b||^2 s.t. w >= 0\n        w, _ = nnls(A, b)\n        \n        # Sum the weights of the streamlines belonging to the target edge\n        A_commit = w[edge_indices].sum()\n\n        results_tuple = (A_naive, A_sift, A_commit)\n        all_results_formatted.append(f\"[{','.join(f'{x:.6f}' for x in results_tuple)}]\")\n    \n    # Print final output in the exact specified format\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个结构连接组不仅包含连接强度；信号在区域间传播所需的时间，即传导延迟 $\\tau_{ij}$，对于理解大脑动力学也同样至关重要。本练习深入探讨了信号传播的生物物理学，展示了如何根据白质通路的微观结构特性（如轴突直径和髓鞘化程度）来估计这些延迟 。这将在微米尺度的解剖学和全脑尺度的通信延迟之间架起一座桥梁。",
            "id": "3972521",
            "problem": "考虑连接大脑皮层区域 $i$ 和 $j$ 的一条白质通路，该通路包含两个具有不同微观结构特性的连续髓鞘化节段。第一节段穿过深部白质，第二节段穿过靠近皮层的浅表 $\\mathrm{U}$ 型纤维。对于每个节段，给定其内部轴突直径 $d$ 和髓鞘 $\\mathrm{g}$-比率 $g$。其中 $g$ 定义为 $g = \\frac{r_{i}}{r_{o}}$，$r_{i}$ 是内部（轴突）半径，$r_{o}$ 是包含髓鞘的外部半径。因此，外部纤维直径为 $D_{o} = 2 r_{o} = \\frac{d}{g}$。假设为跳跃式传导，其郎飞氏结（NoR）动力学具有以下经过充分验证的特性：结间长度与外部纤维直径近似成线性比例关系，即 $\\ell = \\eta D_{o}$（其中 $\\eta$ 为无量纲比例常数），且结去极化时间 $\\tau_{n}$ 在整个通路中近似恒定。在这些假设下，节段的传导速度由每次郎飞氏结去极化前进的距离除以结去极化时间决定。\n\n该通路具有以下属性：\n- 节段 $1$：长度 $L_{1} = 40 \\,\\mathrm{mm}$，内径 $d_{1} = 1.3 \\,\\mu \\mathrm{m}$，$\\mathrm{g}$-比率 $g_{1} = 0.62$。\n- 节段 $2$：长度 $L_{2} = 12 \\,\\mathrm{mm}$，内径 $d_{2} = 0.9 \\,\\mu \\mathrm{m}$，$\\mathrm{g}$-比率 $g_{2} = 0.68$。\n- 结间长度缩放因子 $\\eta = 110$（无量纲）。\n- 结去极化时间 $\\tau_{n} = 0.02 \\,\\mathrm{ms}$。\n\n将通路上的有效解剖距离 $d_{ij}$ 定义为两个节段的弧长之和。从 $\\mathrm{g}$-比率的定义出发，并基于结间长度与外部直径成线性比例（比例常数为 $\\eta$）以及结去极化时间 $\\tau_{n}$ 恒定的假设，推导以 $d$ 和 $g$ 表示的节段传导速度。使用此公式计算节段 $1$ 和节段 $2$ 的传导速度。然后，利用连续节段的传导延迟线性相加的物理原理，计算整个通路的总传导延迟 $\\tau_{ij}$。最后，通过等式 $\\tau_{ij} = d_{ij}/v_{ij}$ 定义一个有效的通路级速度 $v_{ij}$，并报告 $\\tau_{ij}$ 的数值。\n\n以 $\\mathrm{ms}$ 为单位表示最终的传导延迟。将您的答案四舍五入到四位有效数字。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 连接大脑皮层区域 $i$ 和 $j$ 的两个连续髓鞘化节段。\n- 节段 $1$（深部白质）：长度 $L_{1} = 40 \\,\\mathrm{mm}$，内部轴突直径 $d_{1} = 1.3 \\,\\mu \\mathrm{m}$，g-比率 $g_{1} = 0.62$。\n- 节段 $2$（浅表U型纤维）：长度 $L_{2} = 12 \\,\\mathrm{mm}$，内部轴突直径 $d_{2} = 0.9 \\,\\mu \\mathrm{m}$，g-比率 $g_{2} = 0.68$。\n- g-比率的定义：$g = r_{i}/r_{o}$，其中 $r_{i}$ 是内半径，$r_{o}$ 是外半径。\n- 外部纤维直径的定义：$D_{o} = 2 r_{o} = d/g$。\n- 结间长度缩放定律：$\\ell = \\eta D_{o}$。\n- 结间长度缩放因子：$\\eta = 110$（无量纲）。\n- 结去极化时间：$\\tau_{n} = 0.02 \\,\\mathrm{ms}$（恒定）。\n- 节段传导速度的定义：每次郎飞氏结（NoR）去极化前进的距离除以结去极化时间。\n- 总延迟原理：连续节段的传导延迟线性相加，$\\tau_{ij} = \\tau_{1} + \\tau_{2}$。\n- 有效解剖距离的定义：$d_{ij} = L_{1} + L_{2}$。\n- 有效通路级速度的定义：$\\tau_{ij} = d_{ij}/v_{ij}$。\n- 最终要求的值：总传导延迟 $\\tau_{ij}$，以 $\\mathrm{ms}$ 为单位，四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n评估问题的有效性。\n- **科学依据**：该问题基于已确立的神经传导生物物理学原理。跳跃式传导模型、g-比率的定义以及结间长度与轴突直径的线性缩放关系是计算神经科学和神经生理学中的标准概念。给定的轴突直径、g-比率和传导参数的数值在人类白质通路的合理生物学范围内。该问题在科学上是合理的。\n- **适定性**：计算总传导延迟所需的所有必要数据、定义和物理原理均已提供。问题是自洽的，其结构可导出一个唯一的数值解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述，不含主观论断。\n\n**步骤 3：结论与操作**\n该问题被判定为**有效**，因为它具有科学依据、适定且客观。将提供完整解答。\n\n**求解过程**\n主要目标是计算信号穿过两个节段的总传导延迟 $\\tau_{ij}$。\n\n首先，我们推导髓鞘化节段传导速度 $v$ 的一般表达式。根据题目陈述，速度是单次结去极化周期内前进的距离（即结间长度 $\\ell$）除以该周期的时间（即结去极化时间 $\\tau_{n}$）。\n$$\nv = \\frac{\\ell}{\\tau_{n}}\n$$\n题目给出了结间长度 $\\ell$ 与外部纤维直径 $D_{o}$ 的线性缩放定律：\n$$\n\\ell = \\eta D_{o}\n$$\n其中 $\\eta$ 是一个无量纲的比例常数。外部直径 $D_{o}$ 通过给定的公式与内部轴突直径 $d$ 和g-比率 $g$ 相关：\n$$\nD_{o} = \\frac{d}{g}\n$$\n将这些关系代入速度方程，得到以给定的微观结构属性 $d$ 和 $g$ 表示的节段传导速度：\n$$\nv = \\frac{\\eta D_{o}}{\\tau_{n}} = \\frac{\\eta}{\\tau_{n}} \\left( \\frac{d}{g} \\right) = \\frac{\\eta d}{g \\tau_{n}}\n$$\n接下来，我们计算总传导延迟 $\\tau_{ij}$。题目指出，连续节段的延迟是线性相加的。总延迟是节段 $1$ 的延迟（$\\tau_{1}$）和节段 $2$ 的延迟（$\\tau_{2}$）之和：\n$$\n\\tau_{ij} = \\tau_{1} + \\tau_{2}\n$$\n每个节段 $k$ 的延迟是其长度 $L_{k}$ 除以其传导速度 $v_{k}$：\n$$\n\\tau_{k} = \\frac{L_{k}}{v_{k}}\n$$\n将推导出的速度表达式 $v_k = \\frac{\\eta d_k}{g_k \\tau_n}$ 代入延迟公式，得到：\n$$\n\\tau_{k} = \\frac{L_{k}}{\\frac{\\eta d_{k}}{g_{k} \\tau_{n}}} = \\frac{L_{k} g_{k} \\tau_{n}}{\\eta d_{k}}\n$$\n因此，总延迟 $\\tau_{ij}$ 可以写为：\n$$\n\\tau_{ij} = \\frac{L_{1} g_{1} \\tau_{n}}{\\eta d_{1}} + \\frac{L_{2} g_{2} \\tau_{n}}{\\eta d_{2}}\n$$\n我们可以提出公因子项 $\\frac{\\tau_{n}}{\\eta}$，以获得一个更简洁的计算表达式：\n$$\n\\tau_{ij} = \\frac{\\tau_{n}}{\\eta} \\left( \\frac{L_{1} g_{1}}{d_{1}} + \\frac{L_{2} g_{2}}{d_{2}} \\right)\n$$\n现在，我们代入所给的数值。为确保量纲一致，所有长度必须使用相同单位。我们将使用毫米（$\\mathrm{mm}$）。内部轴突直径以微米（$\\mu\\mathrm{m}$）为单位，因此我们使用关系式 $1 \\,\\mu\\mathrm{m} = 10^{-3} \\,\\mathrm{mm}$ 将其转换为 $\\mathrm{mm}$。\n\n给定的参数如下：\n- $L_{1} = 40 \\,\\mathrm{mm}$\n- $d_{1} = 1.3 \\,\\mu \\mathrm{m} = 1.3 \\times 10^{-3} \\,\\mathrm{mm}$\n- $g_{1} = 0.62$\n- $L_{2} = 12 \\,\\mathrm{mm}$\n- $d_{2} = 0.9 \\,\\mu \\mathrm{m} = 0.9 \\times 10^{-3} \\,\\mathrm{mm}$\n- $g_{2} = 0.68$\n- $\\eta = 110$\n- $\\tau_{n} = 0.02 \\,\\mathrm{ms}$\n\n我们首先计算括号内的各项。请注意，每一项 $\\frac{Lg}{d}$ 都是无量纲的（$\\mathrm{mm} / \\mathrm{mm}$）。\n$$\n\\frac{L_{1} g_{1}}{d_{1}} = \\frac{(40 \\,\\mathrm{mm}) \\times 0.62}{1.3 \\times 10^{-3} \\,\\mathrm{mm}} = \\frac{24.8}{1.3 \\times 10^{-3}} = \\frac{24800}{1.3} \\approx 19076.923\n$$\n$$\n\\frac{L_{2} g_{2}}{d_{2}} = \\frac{(12 \\,\\mathrm{mm}) \\times 0.68}{0.9 \\times 10^{-3} \\,\\mathrm{mm}} = \\frac{8.16}{0.9 \\times 10^{-3}} = \\frac{8160}{0.9} \\approx 9066.667\n$$\n现在，我们将这两个值相加：\n$$\n\\frac{L_{1} g_{1}}{d_{1}} + \\frac{L_{2} g_{2}}{d_{2}} = 19076.923... + 9066.667... = 28143.590...\n$$\n最后，我们乘以预因子 $\\frac{\\tau_{n}}{\\eta}$：\n$$\n\\tau_{ij} = \\frac{0.02 \\,\\mathrm{ms}}{110} \\times (28143.590...)\n$$\n$$\n\\tau_{ij} \\approx (1.81818... \\times 10^{-4} \\,\\mathrm{ms}) \\times (28143.590...) \\approx 5.117016... \\,\\mathrm{ms}\n$$\n题目要求将最终答案四舍五入到四位有效数字。计算值为 $5.117016... \\,\\mathrm{ms}$。第五位有效数字是 $0$，所以我们向下舍入。\n\n总传导延迟为 $\\tau_{ij} \\approx 5.117 \\,\\mathrm{ms}$。",
            "answer": "$$\n\\boxed{5.117}\n$$"
        },
        {
            "introduction": "手握一个加权的结构连接矩阵 $A$ 后，我们就可以开始预测其对功能的潜在影响。本练习介绍了图拉普拉斯算子 $L = D - A$，这是一个理解网络结构如何约束动力学的强大工具。通过分析 $L$ 的特征值和特征向量，您将学会识别网络的自然活动模式以及信息在大脑中传播的特征时间尺度 。",
            "id": "3972576",
            "problem": "给定代表 $n$ 个大脑区域的结构连接网络，表示为对称非负邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$。度矩阵定义为 $D \\in \\mathbb{R}^{n \\times n}$，其对角线元素为 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$，组合图拉普拉斯矩阵为 $L = D - A$。网络上的线性扩散过程由常微分方程 $\\frac{d x(t)}{d t} = -\\kappa L x(t)$ 建模，其中 $x(t) \\in \\mathbb{R}^{n}$ 是区域在时间 $t$ 的活动状态，$\\kappa > 0$ 是一个扩散系数，单位为 $\\mathrm{s}^{-1}$。对于对称的 $L$，存在一个标准正交特征基 $\\{v_i\\}_{i=1}^{n}$，其对应的非负特征值为 $\\{\\lambda_i\\}_{i=1}^{n}$，满足 $L v_i = \\lambda_i v_i$。沿特征向量的模态解以 $e^{-\\kappa \\lambda_i t}$ 的形式衰减，因此 $\\lambda_i$ 的大小设定了一个扩散时间尺度。\n\n根据这些定义，对每个给定的测试用例：\n- 计算 $L = D - A$。\n- 计算所有特征值 $\\{\\lambda_i\\}_{i=1}^{n}$ 和相关的标准正交特征向量 $\\{v_i\\}_{i=1}^{n}$。\n- 设 $\\epsilon = 10^{-9}$ 为数值容差。将连通分量的数量 $C$ 定义为满足 $|\\lambda_i| \\le \\epsilon$ 的特征值 $\\lambda_i$ 的个数。\n- 将 $\\lambda_{+}$ 定义为最小的严格正特征值，即满足 $\\lambda_i > \\epsilon$ 的最小 $\\lambda_i$。如果不存在这样的特征值，则将 $\\lambda_{+}$ 视为 $0$。\n- 定义最慢的非平凡扩散时间常数 $\\tau_{+} = \\frac{1}{\\kappa \\lambda_{+}}$，并以秒为单位表示。\n- 给定初始条件 $x_0 \\in \\mathbb{R}^{n}$，计算最慢非平凡模式中的能量分数 $f_{+} = \\frac{|\\langle v_{+}, x_0 \\rangle|^2}{\\|x_0\\|_2^2}$，其中 $v_{+}$ 是与 $\\lambda_{+}$ 相关联的特征向量。如果 $\\lambda_{+} = 0$，则设 $f_{+} = 0$。\n\n您的程序必须将此过程应用于以下测试套件，并生成指定的输出。\n\n测试套件：\n- 案例 $1$ (连通链)：\n  - $n = 4$，\n  - $$A_1 = \\begin{bmatrix}\n  0  0.8  0  0 \\\\\n  0.8  0  0.5  0 \\\\\n  0  0.5  0  0.6 \\\\\n  0  0  0.6  0\n  \\end{bmatrix},$$\n  - $\\kappa_1 = 0.2 \\, \\mathrm{s}^{-1}$，\n  - $x_{0,1} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n- 案例 $2$ (不连通：一对节点加一个孤立节点)：\n  - $n = 3$，\n  - $$A_2 = \\begin{bmatrix}\n  0  1.0  0 \\\\\n  1.0  0  0 \\\\\n  0  0  0\n  \\end{bmatrix},$$\n  - $\\kappa_2 = 0.3 \\, \\mathrm{s}^{-1}$，\n  - $x_{0,2} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。\n- 案例 $3$ (两个弱耦合的社群)：\n  - $n = 6$，\n  - $$A_3 = \\begin{bmatrix}\n  0  1  1  0  0  0 \\\\\n  1  0  1  0  0  0 \\\\\n  1  1  0  0.1  0  0 \\\\\n  0  0  0.1  0  1  1 \\\\\n  0  0  0  1  0  1 \\\\\n  0  0  0  1  1  0\n  \\end{bmatrix},$$\n  - $\\kappa_3 = 0.1 \\, \\mathrm{s}^{-1}$，\n  - $x_{0,3} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n\n要求的输出：\n- 对每个案例，计算并返回列表 $[C, \\lambda_{+}, \\tau_{+}, f_{+}]$。\n- 以秒为单位表示 $\\tau_{+}$。\n- 将所有浮点数表示为四舍五入到 $6$ 位小数的小数值。\n- 您的程序应生成一行输出，其中包含所有案例的结果，形式为一个逗号分隔的列表，并用方括号括起来，每个案例的结果本身也是一个列表。例如，输出格式必须为 $[[r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}],[r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}],[r_{3,1}, r_{3,2}, r_{3,3}, r_{3,4}]]$.",
            "solution": "用户提供了一个问题，要求使用谱图论的概念和扩散过程建模来分析结构性大脑网络。我将首先验证问题陈述，然后提供一个全面的解决方案。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n\n问题提供了以下定义和数据：\n-   邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$，对称且非负，代表 $n$ 个区域的结构连通性。\n-   度矩阵 $D \\in \\mathbb{R}^{n \\times n}$ 是对角矩阵，其对角元素为 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。\n-   组合图拉普拉斯矩阵为 $L = D - A$。\n-   线性扩散过程由 $\\frac{d x(t)}{d t} = -\\kappa L x(t)$ 建模，其中 $\\kappa > 0$ 是一个扩散系数，单位为 $\\mathrm{s}^{-1}$。\n-   $L$ 是对称的，因此它有一个标准正交特征基 $\\{v_i\\}_{i=1}^{n}$，其对应的实数、非负特征值为 $\\{\\lambda_i\\}_{i=1}^{n}$，满足 $L v_i = \\lambda_i v_i$。\n-   用于特征值比较的数值容差：$\\epsilon = 10^{-9}$。\n-   连通分量数 $C$：特征值 $\\lambda_i$ 中满足 $|\\lambda_i| \\le \\epsilon$ 的个数。\n-   最小的严格正特征值 $\\lambda_{+}$：满足 $\\lambda_i > \\epsilon$ 的最小 $\\lambda_i$。若不存在，则 $\\lambda_{+} = 0$。\n-   最慢的非平凡扩散时间常数 $\\tau_{+} = \\frac{1}{\\kappa \\lambda_{+}}$。\n-   最慢非平凡模式中的能量分数 $f_{+} = \\frac{|\\langle v_{+}, x_0 \\rangle|^2}{\\|x_0\\|_2^2}$，其中 $v_{+}$ 是 $\\lambda_{+}$ 的特征向量。若 $\\lambda_{+} = 0$，则 $f_{+} = 0$。\n\n测试套件：\n1.  **案例1 (连通链):**\n    -   $n = 4$\n    -   $A_1 = \\begin{bmatrix} 0  0.8  0  0 \\\\ 0.8  0  0.5  0 \\\\ 0  0.5  0  0.6 \\\\ 0  0  0.6  0 \\end{bmatrix}$\n    -   $\\kappa_1 = 0.2 \\, \\mathrm{s}^{-1}$\n    -   $x_{0,1} = \\begin{bmatrix} 1, 0, 0, 0 \\end{bmatrix}^T$\n2.  **案例2 (不连通):**\n    -   $n = 3$\n    -   $A_2 = \\begin{bmatrix} 0  1.0  0 \\\\ 1.0  0  0 \\\\ 0  0  0 \\end{bmatrix}$\n    -   $\\kappa_2 = 0.3 \\, \\mathrm{s}^{-1}$\n    -   $x_{0,2} = \\begin{bmatrix} 0, 0, 1 \\end{bmatrix}^T$\n3.  **案例3 (弱耦合社群):**\n    -   $n = 6$\n    -   $A_3 = \\begin{bmatrix} 0  1  1  0  0  0 \\\\ 1  0  1  0  0  0 \\\\ 1  1  0  0.1  0  0 \\\\ 0  0  0.1  0  1  1 \\\\ 0  0  0  1  0  1 \\\\ 0  0  0  1  1  0 \\end{bmatrix}$\n    -   $\\kappa_3 = 0.1 \\, \\mathrm{s}^{-1}$\n    -   $x_{0,3} = \\begin{bmatrix} 0, 0, 1, 0, 0, 0 \\end{bmatrix}^T$\n\n要求的输出：对每个案例，输出一个列表 $[C, \\lambda_{+}, \\tau_{+}, f_{+}]$，其中浮点数四舍五入至6位小数，并格式化为单行输出。\n\n**步骤2：使用提取的已知信息进行验证**\n\n问题经过了严格的验证。\n-   **科学依据**：该问题基于谱图论的基本原理及其在网络扩散中的应用，这是计算神经科学和物理学中一个标准且成熟的课题。所有定义（度矩阵、图拉普拉斯矩阵、特征值/特征向量）都是标准的。扩散方程 $\\frac{d x}{d t} = -\\kappa L x$ 是图上热/质量传递的典型模型。\n-   **适定性**：该问题在数学上是适定的。邻接矩阵被给定为对称矩阵，这保证了所产生的拉普拉斯矩阵 $L$ 也是对称且半正定的。这确保了所有特征值都是实数且非负，并且存在一个完备的标准正交特征向量基。问题的定义明确处理了边缘情况，例如不存在严格正特征值的情况。\n-   **客观性**：问题以精确、客观的数学语言陈述。没有主观或含糊不清的术语。\n-   **完整与一致性**：为每个案例提供了所有必要的数据（$A$, $\\kappa$, $x_0$）和定义（$\\epsilon$, $C$, $\\lambda_{+}$, 等）。矩阵和向量的维度是一致的。$\\kappa$ 的单位与时间常数 $\\tau_{+}$ 的计算相符。\n-   **现实与可行性**：所提供的矩阵是真实世界连通性的合理简化表示。所需的计算是标准的，可以使用常见的数值库来执行。\n-   **无其他缺陷**：该问题并非无关紧要、比喻性或不可证伪的。它是一项与连接组学相关的直接计算任务。\n\n**步骤3：结论与行动**\n\n问题是有效的。我将继续提供完整的解决方案。\n\n### 解决方案\n\n该问题要求基于从给定结构连通性矩阵导出的图拉普拉斯矩阵的谱特性进行一系列计算。所概述的程序是网络神经科学中的一种标准方法，用于理解静态网络结构的动态含义。\n\n**基于原则的设计**\n\n对于每个测试案例，我们将执行以下一系列步骤，这些步骤基于线性代数和谱图论。\n\n1.  **构建图拉普拉斯矩阵 ($L$)**：\n    给定一个对称的邻接矩阵 $A$，该结构网络是一个无向加权图。一个节点（区域）的强度是其总连接权重。这由度矩阵 $D$ 捕获，它是一个对角矩阵，其中每个对角元素 $D_{ii}$ 是连接到节点 $i$ 的所有边的权重之和，即 $D_{ii} = \\sum_{j=1}^{n} A_{ij}$。图拉普拉斯矩阵 $L = D - A$ 是图论中的一个基本矩阵。其结构编码了节点的度（在对角线上）和邻接关系（在非对角线上）。对于任何向量 $x$，二次型 $x^T L x = \\sum_{i,j} A_{ij}(x_i - x_j)^2$ 衡量了信号 $x$ 在网络各边上的变化。\n\n2.  **拉普拉斯矩阵的特征分解**：\n    由于 $L$ 是实对称矩阵，它可以被其特征向量构成的正交矩阵对角化，并且其特征值 $\\{\\lambda_i\\}$ 是实数。此外，$L$ 是半正定的，意味着对所有 $i$ 都有 $\\lambda_i \\ge 0$。特征值集合（图的谱）揭示了关于图结构的关键信息。特征向量 $\\{v_i\\}$ 构成了 $\\mathbb{R}^n$ 的一个标准正交基。我们将使用为对称矩阵设计的标准数值算法来计算这些特征值和特征向量。特征值将按非递减顺序排序：$0 \\le \\lambda_1 \\le \\lambda_2 \\le \\dots \\le \\lambda_n$。\n\n3.  **确定连通分量的数量 ($C$)**：\n    谱图论的一个关键定理指出，特征值 $\\lambda=0$ 的重数等于图中连通分量的数量。在有断开连接的图上，扩散过程可以在每个分量内达到独立的平衡状态。在数值上，我们计算小于或等于一个小的容差 $\\epsilon$ 的特征值 $\\lambda_i$ 的数量，即 $C = |\\{i : |\\lambda_i| \\le \\epsilon\\}|$。\n\n4.  **识别最慢的非平凡模式 ($\\lambda_{+}$, $v_{+}$) 和时间尺度 ($\\tau_{+}$) **：\n    扩散方程 $\\frac{d x(t)}{d t} = -\\kappa L x(t)$ 在初始条件 $x(0)=x_0$ 下的解可以表示为对各特征模式的求和：$x(t) = \\sum_{i=1}^n \\langle v_i, x_0 \\rangle e^{-\\kappa \\lambda_i t} v_i$。\n    -   对应于 $\\lambda_i = 0$ 的模式是稳态的 ($e^0=1$)，代表了活动在每个连通分量内保持恒定的稳态解。\n    -   对应于 $\\lambda_i > 0$ 的模式是瞬态的，其衰减速率由 $\\kappa \\lambda_i$ 决定。衰减最慢的*非平凡*模式是与最小的严格正特征值相关联的模式，我们将其表示为 $\\lambda_{+}$。这个特征值也被称为图的 Fiedler 值或代数连通度。较小的 $\\lambda_{+}$ 意味着向全网平衡状态的收敛较慢，通常表明存在瓶颈或弱耦合的社群。\n    -   我们通过取集合 $\\{\\lambda_i | \\lambda_i > \\epsilon\\}$ 中的最小值来找到 $\\lambda_{+}$。对应的特征向量是 $v_{+}$。\n    -   这个最慢模式的特征时间常数是 $\\tau_{+} = \\frac{1}{\\kappa \\lambda_{+}}$。该值以秒为单位，为网络中全局信息整合的时间尺度提供了一个定量度量。如果没有这样的 $\\lambda_i > \\epsilon$ 存在（即图没有边），我们取 $\\lambda_{+} = 0$，并因此定义 $\\tau_{+} = 0$ 来处理奇点。\n\n5.  **计算初始状态的能量分数 ($f_{+}$) **：\n    初始条件 $x_0$ 可以投影到特征基上。$x_0$ 在给定特征向量 $v_i$ 上的分量由内积 $\\langle v_i, x_0 \\rangle$ 给出。该投影的模平方 $|\\langle v_i, x_0 \\rangle|^2$ 代表了初始状态在该模式中的“能量”。总能量为 $\\|x_0\\|_2^2$。\n    -   因此，最慢非平凡模式中的能量分数是 $f_{+} = \\frac{|\\langle v_{+}, x_0 \\rangle|^2}{\\|x_0\\|_2^2}$。\n    -   这个值告诉我们特定的初始活动模式 $x_0$ 在多大程度上激发了网络的最慢动态模式。如果 $x_0$ 与 $v_{+}$ 正交，则 $f_{+}=0$，该模式将不会出现在系统的时间演化中。如果 $\\lambda_{+} = 0$（意味着不存在非平凡模式），问题规定将 $f_{+}$ 设为 $0$。\n\n此程序将应用于所有三个测试案例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final results.\n    \"\"\"\n\n    # Numerical tolerance for eigenvalue zero-check\n    epsilon = 1e-9\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.array([\n                [0.0, 0.8, 0.0, 0.0],\n                [0.8, 0.0, 0.5, 0.0],\n                [0.0, 0.5, 0.0, 0.6],\n                [0.0, 0.0, 0.6, 0.0]\n            ]),\n            \"kappa\": 0.2,\n            \"x0\": np.array([1.0, 0.0, 0.0, 0.0])\n        },\n        {\n            \"A\": np.array([\n                [0.0, 1.0, 0.0],\n                [1.0, 0.0, 0.0],\n                [0.0, 0.0, 0.0]\n            ]),\n            \"kappa\": 0.3,\n            \"x0\": np.array([0.0, 0.0, 1.0])\n        },\n        {\n            \"A\": np.array([\n                [0.0, 1.0, 1.0, 0.0, 0.0, 0.0],\n                [1.0, 0.0, 1.0, 0.0, 0.0, 0.0],\n                [1.0, 1.0, 0.0, 0.1, 0.0, 0.0],\n                [0.0, 0.0, 0.1, 0.0, 1.0, 1.0],\n                [0.0, 0.0, 0.0, 1.0, 0.0, 1.0],\n                [0.0, 0.0, 0.0, 1.0, 1.0, 0.0]\n            ]),\n            \"kappa\": 0.1,\n            \"x0\": np.array([0.0, 0.0, 1.0, 0.0, 0.0, 0.0])\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = compute_properties(case[\"A\"], case[\"kappa\"], case[\"x0\"], epsilon)\n        all_results.append(result)\n\n    # Format the final output string as per requirements.\n    output_parts = []\n    for res in all_results:\n        C, lambda_plus, tau_plus, f_plus = res\n        part = f\"[{C},{lambda_plus:.6f},{tau_plus:.6f},{f_plus:.6f}]\"\n        output_parts.append(part)\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    print(final_output_string)\n\ndef compute_properties(A, kappa, x0, epsilon):\n    \"\"\"\n    Computes the required network properties for a single case.\n    \n    Args:\n        A (np.ndarray): The adjacency matrix.\n        kappa (float): The diffusion coefficient.\n        x0 (np.ndarray): The initial condition vector.\n        epsilon (float): The numerical tolerance for zero.\n\n    Returns:\n        list: A list containing [C, lambda_plus, tau_plus, f_plus].\n    \"\"\"\n    # Step 1: Compute the graph Laplacian L = D - A.\n    D = np.diag(np.sum(A, axis=1))\n    L = D - A\n\n    # Step 2: Compute eigenvalues and eigenvectors.\n    # np.linalg.eigh is used for symmetric matrices. It returns sorted eigenvalues.\n    eigenvalues, eigenvectors = np.linalg.eigh(L)\n\n    # Step 3: Compute the number of connected components, C.\n    C = np.sum(np.abs(eigenvalues) <= epsilon)\n\n    # Step 4: Find lambda_plus (smallest strictly positive eigenvalue) and v_plus.\n    lambda_plus = 0.0\n    v_plus = None\n    \n    # Find indices of all strictly positive eigenvalues\n    positive_eval_indices = np.where(eigenvalues > epsilon)[0]\n\n    if len(positive_eval_indices) > 0:\n        # The first one in the sorted list is the smallest positive one.\n        idx_plus = positive_eval_indices[0]\n        lambda_plus = eigenvalues[idx_plus]\n        v_plus = eigenvectors[:, idx_plus]\n\n    # Step 5: Compute the slowest nontrivial diffusion time constant tau_plus.\n    tau_plus = 0.0\n    if lambda_plus > 0:\n        tau_plus = 1.0 / (kappa * lambda_plus)\n\n    # Step 6: Compute the energy fraction in the slowest nontrivial mode, f_plus.\n    f_plus = 0.0\n    # The condition \"If lambda_plus = 0, set f_plus = 0\" is met if v_plus is None.\n    if v_plus is not None:\n        norm_x0_sq = np.dot(x0, x0)\n        # Handle the case of a zero vector for x0, though not in test cases.\n        if norm_x0_sq > 0:\n            # Inner product\n            inner_product = np.dot(v_plus, x0)\n            f_plus = (inner_product**2) / norm_x0_sq\n            \n    return [C, lambda_plus, tau_plus, f_plus]\n\nsolve()\n```"
        }
    ]
}