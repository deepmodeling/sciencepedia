{
    "hands_on_practices": [
        {
            "introduction": "在分析任何动力学系统时，第一步通常是理解其稳态行为。本练习将通过一个简化的、由兴奋性（$E$）和生长抑素（SOM, $S$）神经元群体组成的经典模型，引导你分析去抑制环路的工作点。你将通过解析方法，推导出环路活动的固定点如何随上游VIP神经元输入的变化而改变 。这项基础练习有助于你从数学上理解去抑制如何实现对网络活动的增益调制。",
            "id": "3975335",
            "problem": "考虑一个去抑制性皮层微电路的双群体发放率模型，该模型由一个兴奋性群体（$E$）和一个表达生长抑素的抑制性群体（$S$）组成，受振幅为 $A$ 的血管活性肠肽（VIP）中间神经元输入的驱动，该输入抑制生长抑素群体。假设在工作区域内为 Wilson–Cowan 型动力学，增益为单位增益（即，响应是线性的且严格高于阈值，因此静态非线性可以视为单位映射）。动力学方程为\n$$\\tau_{E}\\,\\frac{dE}{dt}\\;=\\;-E\\;+\\;w_{EE}\\,E\\;-\\;w_{ES}\\,S\\;+\\;I_{E},$$\n$$\\tau_{S}\\,\\frac{dS}{dt}\\;=\\;-S\\;+\\;w_{SE}\\,E\\;-\\;w_{SS}\\,S\\;-\\;k_{V}\\,A\\;+\\;I_{S}.$$\n此处，$w_{EE}\\ge 0$ 是对 $E$ 的循环兴奋，$w_{ES}\\ge 0$ 是从 $S$ 到 $E$ 的抑制强度（在 $E$ 方程中以负号出现），$w_{SE}\\ge 0$ 是从 $E$ 到 $S$ 的兴奋，$w_{SS}\\ge 0$ 概括了 $S$ 内部的有效自抑制，$I_{E}$ 和 $I_{S}$ 是恒定的外部驱动，$k_{V}\\ge 0$ 是 VIP 到 $S$ 的耦合强度，$\\tau_{E},\\tau_{S}0$ 是时间常数。假设参数使得对于所有相关的 $A$，工作点都保持在线性区域内，并且对于每个 $A$ 都存在一个唯一的定点。\n\n从这些方程和零斜线的基本定义出发，推导：\n1. $E$-零斜线和 $S$-零斜线，明确表示为 $(E,S)$ 平面中的直线。\n2. 它们唯一交点 $(E^{\\ast}(A),S^{\\ast}(A))$ 的坐标，表示为 VIP 输入振幅 $A$ 和模型参数的闭式解析函数。\n\n以有序对 $(E^{\\ast}(A),S^{\\ast}(A))$ 的形式提供最终交点。不需要进行数值计算。你的最终答案必须是单一的闭式解析表达式。最终答案中不要包含单位。如果选择简化，请确保代数步骤对于所述的一般非负参数有效。",
            "solution": "该问题提供了一个由两个耦合线性常微分方程组成的系统，描述了兴奋性群体（$E$）和抑制性群体（$S$）的发放率动力学。该系统由以下方程给出：\n$$ \\tau_{E}\\,\\frac{dE}{dt}\\;=\\;-E\\;+\\;w_{EE}\\,E\\;-\\;w_{ES}\\,S\\;+\\;I_{E} $$\n$$ \\tau_{S}\\,\\frac{dS}{dt}\\;=\\;-S\\;+\\;w_{SE}\\,E\\;-\\;w_{SS}\\,S\\;-\\;k_{V}\\,A\\;+\\;I_{S} $$\n该问题在计算神经科学的框架内是适定的且有科学依据的。它要求推导该系统的零斜线和定点。\n\n**1. 零斜线的推导**\n\n对于一个给定的变量，其零斜线是相空间中该变量时间导数等于零的点集。该系统的相空间是 $(E,S)$ 平面。\n\n**$E$-零斜线：**\n$E$-零斜线由条件 $\\frac{dE}{dt} = 0$ 定义。将第一个方程设为零，我们得到：\n$$ 0 = -E + w_{EE}\\,E - w_{ES}\\,S + I_{E} $$\n我们可以重新排列这个方程，将 $S$ 表示为 $E$ 的函数，这就将零斜线定义为 $(E,S)$ 平面中的一条直线。\n$$ w_{ES}\\,S = (w_{EE} - 1)E + I_{E} $$\n假设 $w_{ES} > 0$（因为该项要有意义，抑制必须存在），$E$-零斜线的方程为：\n$$ S = \\frac{w_{EE}-1}{w_{ES}}E + \\frac{I_{E}}{w_{ES}} $$\n这是一个关于 $E$ 和 $S$ 的线性方程。\n\n**$S$-零斜线：**\n$S$-零斜线由条件 $\\frac{dS}{dt} = 0$ 定义。将第二个方程设为零，我们得到：\n$$ 0 = -S + w_{SE}\\,E - w_{SS}\\,S - k_{V}\\,A + I_{S} $$\n同样，我们重新排列以将 $S$ 表示为 $E$ 的函数：\n$$ S + w_{SS}\\,S = w_{SE}\\,E - k_{V}\\,A + I_{S} $$\n$$ (1 + w_{SS})S = w_{SE}\\,E + (I_{S} - k_{V}\\,A) $$\n由于 $w_{SS} \\ge 0$，项 $(1+w_{SS})$ 严格为正。因此，$S$-零斜线的方程为：\n$$ S = \\frac{w_{SE}}{1+w_{SS}}E + \\frac{I_{S} - k_{V}\\,A}{1+w_{SS}} $$\n这也是一个关于 $E$ 和 $S$ 的线性方程。值得注意的是，这条线的垂直截距取决于输入振幅 $A$。\n\n**2. 定点的计算**\n\n系统的定点，记为 $(E^{\\ast}(A), S^{\\ast}(A))$，是 $E$-零斜线和 $S$-零斜线的交点。在该点，两个导数同时为零，即 $\\frac{dE}{dt} = 0$ 且 $\\frac{dS}{dt} = 0$。我们必须求解以下关于 $E$ 和 $S$ 的线性代数方程组：\n$$ (w_{EE}-1)E - w_{ES}S = -I_E \\quad \\quad (1) $$\n$$ w_{SE}E - (1+w_{SS})S = k_V A - I_S \\quad \\quad (2) $$\n为便于求解，我们可以将系统重写为标准形式：\n$$ (1-w_{EE})E + w_{ES}S = I_E $$\n$$ -w_{SE}E + (1+w_{SS})S = I_S - k_V A $$\n这是一个 $2 \\times 2$ 的线性系统。我们可以使用多种方法求解 $E^{\\ast}$ 和 $S^{\\ast}$，例如代入法或克莱姆法则。我们使用克莱姆法则进行系统求解。该系统的矩阵形式为：\n$$ \\begin{pmatrix} 1-w_{EE}  w_{ES} \\\\ -w_{SE}  1+w_{SS} \\end{pmatrix} \\begin{pmatrix} E \\\\ S \\end{pmatrix} = \\begin{pmatrix} I_E \\\\ I_S - k_V A \\end{pmatrix} $$\n系数矩阵的行列式，我们称之为 $\\Delta$，是：\n$$ \\Delta = \\det\\begin{pmatrix} 1-w_{EE}  w_{ES} \\\\ -w_{SE}  1+w_{SS} \\end{pmatrix} = (1-w_{EE})(1+w_{SS}) - (w_{ES})(-w_{SE}) $$\n$$ \\Delta = (1-w_{EE})(1+w_{SS}) + w_{ES}w_{SE} $$\n问题陈述保证了唯一固定点的存在，这意味着 $\\Delta \\neq 0$。\n\n现在我们求坐标 $E^{\\ast}(A)$：\n$$ E^{\\ast}(A) = \\frac{\\det\\begin{pmatrix} I_E  w_{ES} \\\\ I_S - k_V A  1+w_{SS} \\end{pmatrix}}{\\Delta} = \\frac{I_E(1+w_{SS}) - w_{ES}(I_S - k_V A)}{\\Delta} $$\n$$ E^{\\ast}(A) = \\frac{(1+w_{SS})I_E - w_{ES}I_S + w_{ES}k_V A}{(1-w_{EE})(1+w_{SS}) + w_{ES}w_{SE}} $$\n接下来，我们求坐标 $S^{\\ast}(A)$：\n$$ S^{\\ast}(A) = \\frac{\\det\\begin{pmatrix} 1-w_{EE}  I_E \\\\ -w_{SE}  I_S - k_V A \\end{pmatrix}}{\\Delta} = \\frac{(1-w_{EE})(I_S - k_V A) - I_E(-w_{SE})}{\\Delta} $$\n$$ S^{\\ast}(A) = \\frac{(1-w_{EE})(I_S - k_V A) + w_{SE}I_E}{(1-w_{EE})(1+w_{SS}) + w_{ES}w_{SE}} $$\n这些表达式给出了唯一交点 $(E^{\\ast}(A),S^{\\ast}(A))$ 的坐标，作为 VIP 输入振幅 $A$ 和模型参数的闭式解析函数。",
            "answer": "$$\n\\boxed{\\left( \\frac{(1 + w_{SS})I_{E} - w_{ES}I_{S} + w_{ES}k_{V}A}{(1 - w_{EE})(1 + w_{SS}) + w_{ES}w_{SE}}, \\frac{(1 - w_{EE})(I_{S} - k_{V}A) + w_{SE}I_{E}}{(1 - w_{EE})(1 + w_{SS}) + w_{ES}w_{SE}} \\right)}\n$$"
        },
        {
            "introduction": "抽象的网络模型最终根植于具体的细胞生物物理学。本练习旨在弥合这两个层面之间的鸿沟，它将研究单个神经元对去抑制信号的响应。你将推导出去抑制效应的强度如何依赖于一个关键的细胞参数——GABA$_A$受体的反转电位（$E_{\\text{GABA}}$）。这能让你深入洞察那些能够调节环路功能的潜在生物物理机制。",
            "id": "3975281",
            "problem": "一个单室电导点神经元接收由A型γ-氨基丁酸（GABA$_A$）受体介导的突触兴奋和突触抑制。其阈下膜动力学由以下公式描述：\n$$\nC \\frac{dV}{dt} \\;=\\; -g_{L}\\,(V - E_{L}) \\;-\\; g_{E}\\,(V - E_{E}) \\;-\\; g_{I}\\,(V - E_{\\text{GABA}}) \\;+\\; I_{\\text{app}},\n$$\n其中，$C$ 是膜电容，$g_{L}$ 是漏电导，其反转电位为 $E_{L}$，$g_{E}$ 是兴奋性突触电导，其反转电位为 $E_{E}$，$g_{I}$ 是抑制性突触电导，其GABA$_A$反转电位为 $E_{\\text{GABA}}$。定义总电导 $g_{T} = g_{L} + g_{E} + g_{I}$ 和有效反转电位 $E_{\\text{eff}} = \\big(g_{L}E_{L} + g_{E}E_{E} + g_{I}E_{\\text{GABA}}\\big)/g_{T}$。在恒定输入下的稳态中，工作点电压满足 $V^{*} = E_{\\text{eff}}$。\n\n假设在该工作点附近，神经元的发放频率 $r$ 对输入电流 $I_{\\text{app}}$ 的微小变化呈线性响应，其电流-频率增益为\n$$\nr' \\;=\\; \\left.\\frac{\\partial r}{\\partial I_{\\text{app}}}\\right|_{\\text{baseline}},\n$$\n对于所考虑的小扰动，该增益被视为常数。施加一个去抑制操作，使抑制性电导减少一个微小的量 $\\Delta g_{I}$（其中 $\\Delta g_{I}  0$），而 $g_{L}$ 和 $g_{E}$ 保持不变。将此电导变化在施加瞬间的影响建模为一个等效的微小注入电流\n$$\n\\Delta I_{\\text{eq}} \\;=\\; \\big(E_{\\text{GABA}} - V^{*}\\big)\\,\\Delta g_{I},\n$$\n从而产生一个发放频率调制 $\\Delta r = r'\\,\\Delta I_{\\text{eq}}$。\n\n现在考虑在去抑制操作之前，GABA$_A$反转电位发生一个微小偏移 $\\Delta E$，即 $E_{\\text{GABA}} \\mapsto E_{\\text{GABA}} + \\Delta E$。该偏移足够小，使得围绕新工作点的线性化仍然有效。根据上述稳态关系，此偏移将工作点电压调整到一个新的稳态值 $V^{*}(E_{\\text{GABA}}+\\Delta E)$。假设 $r'$ 不受此微小偏移的影响。\n\n推导对 $\\Delta E$ 的一阶灵敏度\n$$\nS \\;=\\; \\left.\\frac{d}{dE_{\\text{GABA}}}\\,\\Delta r\\right|_{\\text{baseline}},\n$$\n即 $E_{\\text{GABA}}$ 的偏移如何改变去抑制引起的发放频率调制的大小。请用一个关于在基线处评估的 $r'$, $\\Delta g_{I}$, $g_{L}$, $g_{E}$ 和 $g_{I}$ 的单一闭式符号表达式来表示你的最终答案。灵敏度的单位为赫兹每伏特；最终的方框表达式中不要包含单位。不需要进行数值四舍五入。",
            "solution": "用户希望解决以下问题：\n一个单室电导点神经元接收由A型γ-氨基丁酸（GABA$_A$）受体介导的突触兴奋和突触抑制。其阈下膜动力学由以下公式描述：\n$$\nC \\frac{dV}{dt} \\;=\\; -g_{L}\\,(V - E_{L}) \\;-\\; g_{E}\\,(V - E_{E}) \\;-\\; g_{I}\\,(V - E_{\\text{GABA}}) \\;+\\; I_{\\text{app}},\n$$\n其中，$C$ 是膜电容，$g_{L}$ 是漏电导，其反转电位为 $E_{L}$，$g_{E}$ 是兴奋性突触电导，其反转电位为 $E_{E}$，$g_{I}$ 是抑制性突触电导，其GABA$_A$反转电位为 $E_{\\text{GABA}}$。定义总电导 $g_{T} = g_{L} + g_{E} + g_{I}$ 和有效反转电位 $E_{\\text{eff}} = \\big(g_{L}E_{L} + g_{E}E_{E} + g_{I}E_{\\text{GABA}}\\big)/g_{T}$。在恒定输入下的稳态中，工作点电压满足 $V^{*} = E_{\\text{eff}}$。\n\n假设在该工作点附近，神经元的发放频率 $r$ 对输入电流 $I_{\\text{app}}$ 的微小变化呈线性响应，其电流-频率增益为\n$$\nr' \\;=\\; \\left.\\frac{\\partial r}{\\partial I_{\\text{app}}}\\right|_{\\text{baseline}},\n$$\n对于所考虑的小扰动，该增益被视为常数。施加一个去抑制操作，使抑制性电导减少一个微小的量 $\\Delta g_{I}$（其中 $\\Delta g_{I}  0$），而 $g_{L}$ 和 $g_{E}$ 保持不变。将此电导变化在施加瞬间的影响建模为一个等效的微小注入电流\n$$\n\\Delta I_{\\text{eq}} \\;=\\; \\big(E_{\\text{GABA}} - V^{*}\\big)\\,\\Delta g_{I},\n$$\n从而产生一个发放频率调制 $\\Delta r = r'\\,\\Delta I_{\\text{eq}}$。\n\n现在考虑在去抑制操作之前，GABA$_A$反转电位发生一个微小偏移 $\\Delta E$，即 $E_{\\text{GABA}} \\mapsto E_{\\text{GABA}} + \\Delta E$。该偏移足够小，使得围绕新工作点的线性化仍然有效。根据上述稳态关系，此偏移将工作点电压调整到一个新的稳态值 $V^{*}(E_{\\text{GABA}}+\\Delta E)$。假设 $r'$ 不受此微小偏移的影响。\n\n推导对 $\\Delta E$ 的一阶灵敏度\n$$\nS \\;=\\; \\left.\\frac{d}{dE_{\\text{GABA}}}\\,\\Delta r\\right|_{\\text{baseline}},\n$$\n即 $E_{\\text{GABA}}$ 的偏移如何改变去抑制引起的发放频率调制的大小。请用一个关于在基线处评估的 $r'$, $\\Delta g_{I}$, $g_{L}$, $g_{E}$ 和 $g_{I}$ 的单一闭式符号表达式来表示你的最终答案。灵敏度的单位为赫兹每伏特；最终的方框表达式中不要包含单位。不需要进行数值四舍五入。\n\n**问题验证**\n\n**第一步：提取已知条件**\n- 运动方程：$C \\frac{dV}{dt} = -g_{L}(V - E_{L}) - g_{E}(V - E_{E}) - g_{I}(V - E_{\\text{GABA}}) + I_{\\text{app}}$\n- 总电导：$g_{T} = g_{L} + g_{E} + g_{I}$\n- 有效反转电位：$E_{\\text{eff}} = (g_{L}E_{L} + g_{E}E_{E} + g_{I}E_{\\text{GABA}})/g_{T}$\n- 稳态电压：$V^{*} = E_{\\text{eff}}$\n- 电流-频率增益：$r' = \\frac{\\partial r}{\\partial I_{\\text{app}}}$，被视为常数。\n- 电导变化 $\\Delta g_I$ 的等效电流：$\\Delta I_{\\text{eq}} = (E_{\\text{GABA}} - V^{*})\\Delta g_{I}$\n- 发放频率调制：$\\Delta r = r'\\Delta I_{\\text{eq}}$\n- 目标量：在基线处评估的灵敏度 $S = \\frac{d}{dE_{\\text{GABA}}}\\Delta r$。\n- 约束条件：最终表达式必须用 $r'$, $\\Delta g_{I}$, $g_{L}$, $g_{E}$ 和 $g_{I}$ 表示。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，使用了计算神经科学中一个标准且被广泛接受的模型（单室电导模型神经元）。所有术语和关系都定义明确且可进行数学形式化。问题设定是自洽且内部一致的，提供了推导所求量所需的所有信息。该问题是适定的，要求计算一个定义明确的函数的导数，该函数存在唯一解。诸如线性增益和小扰动等假设，是此类灵敏度分析的标准做法。该问题既不琐碎也非同义反复，需要在特定的科学背景下正确应用微分学。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n**解答**\n\n目标是计算灵敏度 $S$，其定义为发放频率调制 $\\Delta r$ 关于 GABA$_A$ 反转电位 $E_{\\text{GABA}}$ 的导数。\n发放频率调制由下式给出：\n$$\n\\Delta r = r'\\,\\Delta I_{\\text{eq}}\n$$\n代入等效电流 $\\Delta I_{\\text{eq}}$ 的表达式：\n$$\n\\Delta r = r' \\left(E_{\\text{GABA}} - V^{*}\\right) \\Delta g_{I}\n$$\n此处，$\\Delta r$ 通过两项依赖于 $E_{\\text{GABA}}$：$E_{\\text{GABA}}$ 的显式出现以及通过稳态工作电压 $V^{*}$ 的隐式依赖。为了求得灵敏度 $S$，我们对 $\\Delta r$ 关于 $E_{\\text{GABA}}$ 求导。根据问题陈述，在此运算中，$r'$ 和 $\\Delta g_{I}$ 被视为常数。\n应用求导法则：\n$$\nS = \\frac{d(\\Delta r)}{dE_{\\text{GABA}}} = \\frac{d}{dE_{\\text{GABA}}} \\left[ r' \\left(E_{\\text{GABA}} - V^{*}\\right) \\Delta g_{I} \\right]\n$$\n$$\nS = r' \\Delta g_{I} \\frac{d}{dE_{\\text{GABA}}} \\left( E_{\\text{GABA}} - V^{*} \\right)\n$$\n利用导数的线性性质，我们得到：\n$$\nS = r' \\Delta g_{I} \\left(\\frac{dE_{\\text{GABA}}}{dE_{\\text{GABA}}} - \\frac{dV^{*}}{dE_{\\text{GABA}}}\\right) = r' \\Delta g_{I} \\left(1 - \\frac{dV^{*}}{dE_{\\text{GABA}}}\\right)\n$$\n下一步是计算稳态电压 $V^{*}$ 关于 $E_{\\text{GABA}}$ 的导数。稳态电压由有效反转电位给出：\n$$\nV^{*} = E_{\\text{eff}} = \\frac{g_{L}E_{L} + g_{E}E_{E} + g_{I}E_{\\text{GABA}}}{g_{L} + g_{E} + g_{I}}\n$$\n对于此微分，所有参数（$g_{L}$, $E_{L}$, $g_{E}$, $E_{E}$, $g_{I}$）都在基线处评估，并被视为常数，$E_{\\text{GABA}}$ 是唯一的变量。$V^{*}$ 的表达式是 $E_{\\text{GABA}}$ 的一个线性函数。我们可以重写它以明确显示其依赖关系：\n$$\nV^{*} = \\frac{g_{L}E_{L} + g_{E}E_{E}}{g_{L} + g_{E} + g_{I}} + \\left(\\frac{g_{I}}{g_{L} + g_{E} + g_{I}}\\right) E_{\\text{GABA}}\n$$\n对 $E_{\\text{GABA}}$ 求导，得到 $E_{\\text{GABA}}$ 项的系数：\n$$\n\\frac{dV^{*}}{dE_{\\text{GABA}}} = \\frac{g_{I}}{g_{L} + g_{E} + g_{I}}\n$$\n现在，我们将此结果代回灵敏度 $S$ 的表达式中：\n$$\nS = r' \\Delta g_{I} \\left(1 - \\frac{g_{I}}{g_{L} + g_{E} + g_{I}}\\right)\n$$\n为了得到最终的闭式表达式，我们通过通分来简化括号中的项：\n$$\n1 - \\frac{g_{I}}{g_{L} + g_{E} + g_{I}} = \\frac{(g_{L} + g_{E} + g_{I}) - g_{I}}{g_{L} + g_{E} + g_{I}} = \\frac{g_{L} + g_{E}}{g_{L} + g_{E} + g_{I}}\n$$\n将这个简化后的项代回 $S$ 的表达式中，得到最终答案：\n$$\nS = r' \\Delta g_{I} \\left( \\frac{g_{L} + g_{E}}{g_{L} + g_{E} + g_{I}} \\right)\n$$\n该表达式给出了去抑制引起的频率调制对GABA能反转电位偏移的灵敏度，用基线电导、电导变化的大小以及神经元的电流-频率增益来表示。",
            "answer": "$$\n\\boxed{r' \\Delta g_{I} \\frac{g_{L} + g_{E}}{g_{L} + g_{E} + g_{I}}}\n$$"
        },
        {
            "introduction": "本章的最后一个实践将从解析推导转向计算模拟，这是一项在现代计算神经科学中至关重要的技能。这个挑战性的练习要求你构建并模拟一个包含三种神经元群体的Wilson-Cowan模型，以在数值上探索去抑制现象。通过模拟环路对光遗传学刺激的反应，你将能直接观察并量化去抑制所导致的“反常”兴奋性活动增强效应 ，从而以一种实际操作的方式巩固理论知识。",
            "id": "2589084",
            "problem": "考虑一个三群体 Wilson–Cowan 平均场模型，该模型用于描述皮层微环路的活动，其中包含一个兴奋性群体和两个构成去抑制基序的抑制性亚群体。状态向量为 $x = (E, I_1, I_2)^\\top$，其中 $E$ 是兴奋性群体的发放率，$I_1$ 是一个直接抑制 $E$ 的抑制性群体，而 $I_2$ 是一个优先抑制 $I_1$ 的抑制性群体。光遗传学兴奋被建模为对 $I_2$ 输入的附加驱动。其动力学行为是\n$$\n\\frac{dx}{dt} = -x + S\\!\\left(W x + h + p\\right),\n$$\n其中 $W \\in \\mathbb{R}^{3 \\times 3}$ 是突触连接矩阵（有符号，正值表示净兴奋，负值表示净抑制），$h \\in \\mathbb{R}^3$ 是一个恒定的外部驱动，$p = (0,0,I_{\\mathrm{opto}})^\\top$ 代表对 $I_2$ 的光遗传学（光）驱动，$S(\\cdot)$ 逐元素作用，其 S 型激活函数为\n$$\nS(u) = \\frac{1}{1 + \\exp\\!\\left(-a\\,(u - \\theta)\\right)},\n$$\n其中陡度 $a  0$，阈值 $\\theta \\in \\mathbb{R}$。此处所有变量均为无单位的发放率或无单位的输入。\n\n核心问题是，在何种参数范围内，对去抑制性抑制群体 $I_2$ 的光遗传学兴奋能否同时（i）降低作用于 $E$ 的净抑制性突触电流，以及（ii）在稳态下增加兴奋性群体发放率 $E$。形式上，对于每个固定的 $I_{\\mathrm{opto}} \\ge 0$，令 $x^\\ast(I_{\\mathrm{opto}})$ 表示满足 $x^\\ast = S(W x^\\ast + h + p)$ 的一个稳定稳态。将在稳态下作用于 $E$ 的总抑制性突触电流定义为\n$$\nI_{\\mathrm{inh}\\to E}(I_{\\mathrm{opto}}) \\;=\\; \\sum_{j \\in \\{1,2\\}:\\, W_{E j}  0} \\big(-W_{E j}\\big)\\, x^\\ast_j(I_{\\mathrm{opto}}),\n$$\n其中 $W_{E j}$ 表示 $W$ 矩阵中对应于 $E$ 的行和第 $j$ 列的元素。令 $x^\\ast(0) = (E_0, I_{1,0}, I_{2,0})^\\top$ 和 $I_{\\mathrm{inh}\\to E}(0)$ 为相应的基线稳态量。对于给定的光遗传学驱动范围 $I_{\\mathrm{opto}} \\in [0, I_{\\max}]$，将在特定 $I_{\\mathrm{opto}}$ 下的“伴随兴奋的矛盾性去抑制”条件定义为以下两者的合取：\n- $E(I_{\\mathrm{opto}}) - E_0  0$，\n- $I_{\\mathrm{inh}\\to E}(I_{\\mathrm{opto}}) - I_{\\mathrm{inh}\\to E}(0)  0$。\n\n您的任务是编写一个完整的程序，对于下面测试套件中的每个参数集，计算在指定区间 $[0, I_{\\max}]$ 的网格上采样的 $I_{\\mathrm{opto}}$ 值中，使得在数值计算出的稳定稳态下两个条件同时成立的比例（一个在 $[0,1]$ 之间的实数）。使用不动点迭代 $x_{n+1} = S(W x_n + h + p)$ 来近似 $x^\\ast(I_{\\mathrm{opto}})$，收敛容差为无穷范数下的 $\\|x_{n+1} - x_n\\|_\\infty  10^{-10}$，每个 $I_{\\mathrm{opto}}$ 的最大迭代次数为 $10^6$ 次。在遍历 $I_{\\mathrm{opto}}$ 值时，使用前一个稳态作为初始条件（数值延拓）。将所有量视为无单位的。在判断增加或减少时，设置一个数值裕度 $\\varepsilon = 10^{-8}$ 以避免由数值噪声引起的模糊符号判断；即，测试 $E(I_{\\mathrm{opto}}) - E_0 > \\varepsilon$ 和 $I_{\\mathrm{inh}\\to E}(I_{\\mathrm{opto}}) - I_{\\mathrm{inh}\\to E}(0)  -\\varepsilon$。\n\n对所有测试案例使用以下固定的 sigmoid 参数：$a = 4.0$，$\\theta = 0.5$。对于每个测试案例，在闭区间 $[0, I_{\\max}]$ 上采样 $N$ 个等间距的 $I_{\\mathrm{opto}}$ 值。\n\n测试套件（三个参数集）：\n- 案例 A（去抑制机制，典型）：\n  - $W = \\begin{pmatrix}\n  1.5  -1.6  0.0\\\\\n  1.2  -0.8  -2.0\\\\\n  0.3  0.0  -1.0\n  \\end{pmatrix}$，\n  - $h = \\begin{pmatrix}0.3\\\\0.35\\\\0.2\\end{pmatrix}$，\n  - $I_{\\max} = 0.5$，$N = 51$。\n- 案例 B（无去抑制，对 E 的直接抑制占主导）：\n  - $W = \\begin{pmatrix}\n  1.5  -1.0  -1.2\\\\\n  1.0  -0.5  0.0\\\\\n  0.3  0.0  -1.0\n  \\end{pmatrix}$，\n  - $h = \\begin{pmatrix}0.3\\\\0.35\\\\0.2\\end{pmatrix}$，\n  - $I_{\\max} = 0.5$，$N = 51$。\n- 案例 C（边界情况，$I_2$ 与 E 和 $I_1$ 的输出隔离）：\n  - $W = \\begin{pmatrix}\n  1.5  -1.0  0.0\\\\\n  1.0  -0.5  0.0\\\\\n  0.3  0.0  -1.0\n  \\end{pmatrix}$，\n  - $h = \\begin{pmatrix}0.3\\\\0.35\\\\0.2\\end{pmatrix}$，\n  - $I_{\\max} = 0.5$，$N = 51$。\n\n您的程序必须：\n- 对于每个案例，计算 $I_{\\mathrm{opto}} = 0$ 时的基线稳态，然后在 $[0, I_{\\max}]$ 范围内遍历 $N$ 个 $I_{\\mathrm{opto}}$ 值，计算每个值对应的稳态，评估上述两个条件，并返回两个条件都满足的 $I_{\\mathrm{opto}}$ 采样值所占的比例。\n- 将每个比例四舍五入到恰好三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个案例的三个四舍五入后的比例，格式为逗号分隔的列表并用方括号括起，例如 `[0.123,0.000,1.000]`。",
            "solution": "所提出的问题是一个有效且定义明确的计算任务，其基础是成熟的神经群体动力学理论。它要求对一个三群体 Wilson-Cowan 模型进行数值分析，这是一个研究皮层环路平均场活动的经典框架。研究去抑制子环路的光遗传学刺激如何影响兴奋性群体活动和净抑制性输入，是计算神经科学中一个具有科学意义的问题。问题提供了所有必要的方程、参数和数值规格，使其自成体系、客观且科学上合理。因此，我们将着手解决它。\n\n系统的动力学由以下常微分方程给出：\n$$\n\\frac{dx}{dt} = -x + S\\!\\left(W x + h + p\\right)\n$$\n其中 $x = (E, I_1, I_2)^\\top$ 是发放率的状态向量，$W$ 是连接矩阵，$h$ 是背景驱动，$p = (0, 0, I_{\\mathrm{opto}})^\\top$ 是对 $I_2$ 群体的光遗传学输入。激活函数 $S(\\cdot)$ 是 sigmoid 函数：\n$$\nS(u) = \\frac{1}{1 + \\exp\\!\\left(-a\\,(u - \\theta)\\right)}\n$$\n参数为 $a = 4.0$ 和 $\\theta = 0.5$。\n\n系统的稳态，记为 $x^\\ast$，是动力学的一个不动点，满足 $dx/dt = 0$。这产生了一个非线性代数方程组：\n$$\nx^\\ast = S(W x^\\ast + h + p)\n$$\n问题要求对于指定网格中的每个 $I_{\\mathrm{opto}}$ 值，我们都要求解相应的稳定稳态 $x^\\ast(I_{\\mathrm{opto}})$。指定使用的数值方法是不动点迭代，其表达式为：\n$$\nx_{n+1} = S(W x_n + h + p)\n$$\n从初始猜测 $x_0$ 开始执行此迭代，直到连续迭代之间的变化可以忽略不计，即 $\\|x_{n+1} - x_n\\|_\\infty  10^{-10}$，或达到 $10^6$ 次的最大迭代次数。为了高效地追踪解分支，我们采用数值延拓：为某个 $I_{\\mathrm{opto}}$ 值找到的稳态被用作网格中下一个值的初始猜测。\n\n分析取决于在每个稳态 $x^\\ast(I_{\\mathrm{opto}}) = (E(I_{\\mathrm{opto}}), I_1(I_{\\mathrm{opto}}), I_2(I_{\\mathrm{opto}}))^\\top$ 下评估的两个量：兴奋性发放率 $E(I_{\\mathrm{opto}})$ 和作用于兴奋性群体的总抑制性突触电流 $I_{\\mathrm{inh}\\to E}(I_{\\mathrm{opto}})$。后者定义为：\n$$\nI_{\\mathrm{inh}\\to E}(I_{\\mathrm{opto}}) \\;=\\; \\sum_{j \\in \\{I_1, I_2\\}:\\, W_{E j}  0} \\big(-W_{E j}\\big)\\, x^\\ast_j(I_{\\mathrm{opto}})\n$$\n其中，求和遍历对兴奋性群体 $E$ 具有负连接权重的抑制性群体 $I_1$ 和 $I_2$。设状态向量索引为 $x = (x_1, x_2, x_3)^\\top = (E, I_1, I_2)^\\top$。从群体 $j$到群体 $i$ 的连接为 $W_{ij}$。那么电流为 $I_{\\mathrm{inh}\\to E} = \\sum_{j \\in \\{2,3\\}: W_{1j}0} (-W_{1j}) x_j$。\n\n对于每个测试案例的连接矩阵 $W$，$I_{\\mathrm{inh}\\to E}$ 的具体公式为：\n- **案例 A**：$W_{12} = -1.6$ 且 $W_{13} = 0.0$。只有 $I_1$ 抑制 $E$。因此，$I_{\\mathrm{inh}\\to E} = -W_{12} I_1^\\ast = 1.6 I_1^\\ast$。\n- **案例 B**：$W_{12} = -1.0$ 且 $W_{13} = -1.2$。$I_1$ 和 $I_2$ 都抑制 $E$。因此，$I_{\\mathrm{inh}\\to E} = -W_{12} I_1^\\ast - W_{13} I_2^\\ast = 1.0 I_1^\\ast + 1.2 I_2^\\ast$。\n- **案例 C**：$W_{12} = -1.0$ 且 $W_{13} = 0.0$。只有 $I_1$ 抑制 $E$。因此，$I_{\\mathrm{inh}\\to E} = -W_{12} I_1^\\ast = 1.0 I_1^\\ast$。\n\n核心的“伴随兴奋的矛盾性去抑制”条件在给定的 $I_{\\mathrm{opto}} > 0$ 下满足，如果以下两个不等式都成立（其中带下标 $0$ 的量是在基线 $I_{\\mathrm{opto}}=0$ 时评估的）：\n1. $E(I_{\\mathrm{opto}}) - E_0 > \\varepsilon$\n2. $I_{\\mathrm{inh}\\to E}(I_{\\mathrm{opto}}) - I_{\\mathrm{inh}\\to E}(0)  -\\varepsilon$\n使用数值裕度 $\\varepsilon = 10^{-8}$ 来防止浮点数不精确性。\n\n每个测试案例的总体算法如下：\n1. 定义在区间 $[0, I_{\\max}]$ 上的 $N$ 个等间距的 $I_{\\mathrm{opto}}$ 值组成的网格。\n2. 通过设置 $I_{\\mathrm{opto}}=0$ 并从 $x_0 = (0,0,0)^\\top$ 的初始猜测开始求解不动点方程，计算基线稳态 $x^\\ast(0)$。计算基线量 $E_0$ 和 $I_{\\mathrm{inh}\\to E}(0)$。\n3. 将成功实例的计数器初始化为零。将延拓的初始猜测设为 $x^\\ast(0)$。\n4. 遍历网格中的每个 $I_{\\mathrm{opto}}$ 值。\n5. 对于每个 $I_{\\mathrm{opto}}$，使用从上一步获得的猜测开始的不动点迭代，计算相应的稳态 $x^\\ast(I_{\\mathrm{opto}})$。\n6. 评估矛盾性去抑制的两个条件。如果两者都满足，则计数器加一。\n7. 将下一次迭代的初始猜测更新为新找到的稳态 $x^\\ast(I_{\\mathrm{opto}})$。\n8. 检查完所有 $N$ 个 $I_{\\mathrm{opto}}$ 值后，最终结果是条件满足的比例，计算方法为最终计数值除以 $N$。然后将此分数四舍五入到三位小数。\n\n此过程被系统地应用于所提供的三个测试案例。其实现方式在下一节中提供。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fraction of optogenetic drive levels that induce paradoxical\n    disinhibition with excitation in a three-population Wilson-Cowan model.\n    \"\"\"\n\n    # --- Model and Simulation Parameters ---\n    a = 4.0\n    theta = 0.5\n    tol = 1e-10\n    epsilon = 1e-8\n    max_iter = 1000000\n\n    # --- Test Suite Definition ---\n    test_cases = [\n        {\n            \"W\": np.array([\n                [1.5, -1.6, 0.0],\n                [1.2, -0.8, -2.0],\n                [0.3, 0.0, -1.0]\n            ], dtype=np.float64),\n            \"h\": np.array([0.3, 0.35, 0.2], dtype=np.float64),\n            \"I_max\": 0.5,\n            \"N\": 51\n        },\n        {\n            \"W\": np.array([\n                [1.5, -1.0, -1.2],\n                [1.0, -0.5, 0.0],\n                [0.3, 0.0, -1.0]\n            ], dtype=np.float64),\n            \"h\": np.array([0.3, 0.35, 0.2], dtype=np.float64),\n            \"I_max\": 0.5,\n            \"N\": 51\n        },\n        {\n            \"W\": np.array([\n                [1.5, -1.0, 0.0],\n                [1.0, -0.5, 0.0],\n                [0.3, 0.0, -1.0]\n            ], dtype=np.float64),\n            \"h\": np.array([0.3, 0.35, 0.2], dtype=np.float64),\n            \"I_max\": 0.5,\n            \"N\": 51\n        }\n    ]\n\n    # --- Helper Functions ---\n    def sigmoid(u, a_p, theta_p):\n        \"\"\"Elementwise sigmoid activation function.\"\"\"\n        return 1.0 / (1.0 + np.exp(-a_p * (u - theta_p)))\n\n    def find_steady_state(W_mat, h_vec, p_vec, x_initial, a_p, theta_p, tol_p, max_iter_p):\n        \"\"\"Finds the steady state using fixed-point iteration.\"\"\"\n        x_curr = np.copy(x_initial)\n        for _ in range(max_iter_p):\n            u = W_mat @ x_curr + h_vec + p_vec\n            x_next = sigmoid(u, a_p, theta_p)\n            if np.max(np.abs(x_next - x_curr))  tol_p:\n                return x_next\n            x_curr = x_next\n        # As per problem, assume convergence within max_iter.\n        return x_curr\n\n    def compute_inh_current(W_mat, x_star):\n        \"\"\"Computes the total inhibitory current onto the E-population.\"\"\"\n        current = 0.0\n        # Contribution from I1 (index 1)\n        if W_mat[0, 1]  0:\n            current += -W_mat[0, 1] * x_star[1]\n        # Contribution from I2 (index 2)\n        if W_mat[0, 2]  0:\n            current += -W_mat[0, 2] * x_star[2]\n        return current\n\n    # --- Main Calculation Loop ---\n    all_results = []\n    for case in test_cases:\n        W = case[\"W\"]\n        h = case[\"h\"]\n        I_max = case[\"I_max\"]\n        N = case[\"N\"]\n\n        i_opto_values = np.linspace(0, I_max, N, dtype=np.float64)\n\n        # 1. Baseline calculation (I_opto = 0)\n        p_base = np.array([0.0, 0.0, 0.0], dtype=np.float64)\n        x_init_base = np.zeros(3, dtype=np.float64)\n        x_star_base = find_steady_state(W, h, p_base, x_init_base, a, theta, tol, max_iter)\n        \n        E_0 = x_star_base[0]\n        I_inh_0 = compute_inh_current(W, x_star_base)\n\n        # 2. Sweep over I_opto grid\n        paradox_count = 0\n        x_guess = np.copy(x_star_base)\n\n        for i_opto in i_opto_values:\n            \n            p_current = np.array([0.0, 0.0, i_opto], dtype=np.float64)\n            x_star_current = find_steady_state(W, h, p_current, x_guess, a, theta, tol, max_iter)\n            \n            # Update for numerical continuation\n            x_guess = x_star_current\n\n            E_current = x_star_current[0]\n            I_inh_current = compute_inh_current(W, x_star_current)\n\n            # 3. Check conditions\n            cond1 = (E_current - E_0) > epsilon\n            cond2 = (I_inh_current - I_inh_0)  -epsilon\n\n            if cond1 and cond2:\n                paradox_count += 1\n        \n        # 4. Compute fraction\n        fraction = paradox_count / N\n        all_results.append(fraction)\n\n    # --- Format and Print Final Output ---\n    formatted_results = [f\"{r:.3f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}