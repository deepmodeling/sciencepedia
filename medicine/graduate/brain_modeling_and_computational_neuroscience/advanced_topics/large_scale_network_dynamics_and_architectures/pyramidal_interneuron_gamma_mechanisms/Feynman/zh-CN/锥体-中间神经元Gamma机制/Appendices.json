{
    "hands_on_practices": [
        {
            "introduction": "PING振荡并非凭空出现，而是在网络参数（如神经元兴奋性或突触强度）越过某个临界阈值时从一个稳定的静息状态中“涌现”出来的。本练习将指导您使用经典的Wilson-Cowan模型进行线性稳定性分析，这是一种在计算神经科学中无处不在的强大技术。通过推导Hopf分岔的条件，您将精确地确定振荡产生的阈值，从而深入理解神经调质（如多巴胺）如何通过调节突触增益来控制节律的开关 。",
            "id": "4012014",
            "problem": "考虑一个由兴奋性锥体神经元群体和抑制性中间神经元群体组成的锥体-中间神经元伽马（PING）回路的双群体Wilson–Cowan模型。Wilson–Cowan方程将粗粒度的群体速率描述为\n$$\n\\tau_{E} \\frac{dE}{dt} = -E + S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right), \\quad\n\\tau_{I} \\frac{dI}{dt} = -I + S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right),\n$$\n其中 $E$ 和 $I$ 是兴奋性和抑制性群体的活动，$\\tau_{E}$ 和 $\\tau_{I}$ 是群体时间常数，$w_{EE}$、$w_{EI}$、$w_{IE}$ 和 $w_{II}$ 是有效突触增益，而 $P_{E}$ 和 $P_{I}$ 是持续性输入。函数 $S_{E}(\\cdot)$ 和 $S_{I}(\\cdot)$ 是光滑的饱和S型函数，代表群体输入-输出传递函数。假设在没有振荡的情况下，存在一个稳定的平衡点 $(E^{*}, I^{*})$。\n\n多巴胺通过改变工作点处 $S_{E}(\\cdot)$ 的斜率来调节兴奋性增益。将有效增益定义为平衡点输入处的斜率：$g_{E} = S_{E}'(h_{E}^{*})$ 和 $g_{I} = S_{I}'(h_{I}^{*})$，其中 $h_{E}^{*} = w_{EE} E^{*} - w_{EI} I^{*} + P_{E}$ 且 $h_{I}^{*} = w_{IE} E^{*} - w_{II} I^{*} + P_{I}$。将多巴胺依赖性调制建模为兴奋性增益的线性标度，$g_{E}(D) = g_{E0}\\left(1 + \\eta D\\right)$，其中 $D$ 是一个小的无量纲多巴胺状态变量，敏感度 $\\eta > 0$，而 $g_{I}$ 不受影响。\n\n从Wilson–Cowan形式和基本的线性化原理出发，完成以下任务：\n- 以 $\\tau_{E}$、$\\tau_{I}$、$w_{EE}$、$w_{EI}$、$w_{IE}$、$w_{II}$、$g_{E}$ 和 $g_{I}$ 表示在 $(E^{*}, I^{*})$ 处的雅可比矩阵。\n- 使用二维系统中振荡起始的标准Hopf分岔条件，推导当平衡点通过Hopf分岔失去稳定性时的兴奋性增益阈值 $g_{E}^{\\mathrm{crit}}$ 的条件。以闭式形式表示 $g_{E}^{\\mathrm{crit}}$。\n- 在超临界Hopf分岔和工作点处具有负三阶导数的光滑S型函数（确保饱和）的假设下，使用Hopf范式来表示极限环振幅如何通过与阈值的距离随多巴胺变化，并提供振幅对 $g_{E}(D) - g_{E}^{\\mathrm{crit}}$ 的主阶依赖关系。\n\n您必须从第一性原理（Wilson–Cowan模型的定义、线性化和Hopf条件）出发，论证每一步。提供雅可比矩阵的迹和行列式以及起始频率的清晰中间符号表达式。您最终报告的答案应为增益阈值 $g_{E}^{\\mathrm{crit}}$ 的单一闭式解析表达式。不需要进行数值计算。如果为范式系数引入任何额外符号，请明确定义它们。首字母缩略词在首次使用时必须定义。最终答案必须是无单位的单一解析表达式。",
            "solution": "首先，应对问题进行严格的验证过程。\n\n### 步骤1：提取已知条件\n逐字给出的已知条件如下：\n- **模型方程**：锥体-中间神经元伽马（PING）回路的Wilson–Cowan方程为：\n$$\n\\tau_{E} \\frac{dE}{dt} = -E + S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\\\\n\\tau_{I} \\frac{dI}{dt} = -I + S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right)\n$$\n- **变量与参数**：\n  - $E, I$：兴奋性和抑制性群体活动。\n  - $\\tau_{E}, \\tau_{I}$：群体时间常数。\n  - $w_{EE}, w_{EI}, w_{IE}, w_{II}$：有效突触增益。\n  - $P_{E}, P_{I}$：持续性输入。\n  - $S_{E}(\\cdot), S_{I}(\\cdot)$：光滑的饱和S型传递函数。\n- **平衡点**：存在一个稳定平衡点 $(E^{*}, I^{*})$。\n- **有效增益**：定义为平衡点处S型函数的斜率：\n  - $g_{E} = S_{E}'(h_{E}^{*})$，其中 $h_{E}^{*} = w_{EE} E^{*} - w_{EI} I^{*} + P_{E}$。\n  - $g_{I} = S_{I}'(h_{I}^{*})$，其中 $h_{I}^{*} = w_{IE} E^{*} - w_{II} I^{*} + P_{I}$。\n- **多巴胺调制**：建模为 $g_{E}(D) = g_{E0}\\left(1 + \\eta D\\right)$，其中 $D$ 是一个小的无量纲多巴胺状态变量，敏感度 $\\eta > 0$。增益 $g_{I}$ 不受影响。\n- **假设**：分岔是超临界Hopf分岔，且S型函数在工作点处的第三阶导数为负（$S'''  0$）。\n- **要求推导**：\n  1. 在 $(E^{*}, I^{*})$ 处的雅可比矩阵。\n  2. 发生Hopf分岔的兴奋性增益阈值 $g_{E}^{\\mathrm{crit}}$ 的条件。\n  3. 极限环振幅与阈值距离 $g_{E}(D) - g_{E}^{\\mathrm{crit}}$ 的标度关系。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于Wilson–Cowan模型，这是理论与计算神经科学中描述群体水平神经动力学的基础框架。所要求的分析——线性化和Hopf分岔分析——是研究动力系统的标准且成熟的方法。PING（锥体-中间神经元伽马）机制是关于大脑中伽马波段振荡生成的一个突出且得到实验支持的假说。该问题在科学上是合理的。\n- **良定性**：该问题提供了一个清晰完整的数学模型，并要求基于此模型进行具体推导。所提供的假设（存在稳定不动点，分岔的超临界性质）确保可以推导出唯一且有意义的解。\n- **客观性**：语言技术性强、精确，不含任何主观性或观点。\n- **完整性与一致性**：问题陈述包含了进行推导所需的所有必要方程、定义和假设。不存在内部矛盾。\n- **真实性**：尽管是对神经生物学的简化，Wilson–Cowan模型和PING机制在科学上是可信的，并且是广泛使用的工作模型。参数化是符号性的，因此不会出现物理不一致的问题。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。这是一个对标准计算神经科学模型进行分析的、良定的、有科学依据的练习。可以开始求解过程。\n\n---\n\n该系统是一个二维动力系统，由以下常微分方程描述：\n$$\n\\frac{dE}{dt} = F_{E}(E, I) = \\frac{1}{\\tau_{E}} \\left[ -E + S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\\\\n\\frac{dI}{dt} = F_{I}(E, I) = \\frac{1}{\\tau_{I}} \\left[ -I + S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right]\n$$\n我们通过对系统进行线性化来分析平衡点 $(E^{*}, I^{*})$ 的稳定性。小扰动 $\\delta E = E - E^{*}$ 和 $\\delta I = I - I^{*}$ 的动力学由在该平衡点处计算的雅可比矩阵 $J$ 控制。\n\n**1. 雅可比矩阵的推导**\n雅可比矩阵定义为 $J_{ij} = \\frac{\\partial F_{i}}{\\partial x_{j}}$，其中 $\\mathbf{x} = (E, I)$。我们计算四个分量：\n$J_{11} = \\frac{\\partial F_{E}}{\\partial E} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{E}} \\left[ -1 + \\frac{\\partial}{\\partial E} S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{E}}{\\partial E} = S_{E}' \\cdot w_{EE}$。在平衡点处，$S_{E}'(h_{E}^{*}) = g_{E}$。\n因此，$J_{11} = \\frac{1}{\\tau_{E}} \\left( g_{E} w_{EE} - 1 \\right)$。\n\n$J_{12} = \\frac{\\partial F_{E}}{\\partial I} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{E}} \\left[ \\frac{\\partial}{\\partial I} S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{E}}{\\partial I} = S_{E}' \\cdot (-w_{EI})$。\n因此，$J_{12} = \\frac{1}{\\tau_{E}} \\left( -g_{E} w_{EI} \\right) = - \\frac{g_{E} w_{EI}}{\\tau_{E}}$。\n\n$J_{21} = \\frac{\\partial F_{I}}{\\partial E} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{I}} \\left[ \\frac{\\partial}{\\partial E} S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{I}}{\\partial E} = S_{I}' \\cdot w_{IE}$。在平衡点处，$S_{I}'(h_{I}^{*}) = g_{I}$。\n因此，$J_{21} = \\frac{g_{I} w_{IE}}{\\tau_{I}}$。\n\n$J_{22} = \\frac{\\partial F_{I}}{\\partial I} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{I}} \\left[ -1 + \\frac{\\partial}{\\partial I} S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\n使用链式法则，$\\frac{\\partial S_{I}}{\\partial I} = S_{I}' \\cdot (-w_{II})$。\n因此，$J_{22} = \\frac{1}{\\tau_{I}} \\left( -1 - g_{I} w_{II} \\right) = - \\frac{g_{I} w_{II} + 1}{\\tau_{I}}$。\n\n综合这些分量，在平衡点 $(E^{*}, I^{*})$ 处的雅可比矩阵是：\n$$\nJ = \\begin{pmatrix} \\frac{g_{E} w_{EE} - 1}{\\tau_{E}}  -\\frac{g_{E} w_{EI}}{\\tau_{E}} \\\\ \\frac{g_{I} w_{IE}}{\\tau_{I}}  -\\frac{g_{I} w_{II} + 1}{\\tau_{I}} \\end{pmatrix}\n$$\n\n**2. Hopf分岔条件的推导**\nHopf分岔标志着从稳定不动点到极限环振荡的转变。这种情况发生在雅可比矩阵的特征值（初始位于复平面的左半部分，即实部为负）穿过虚轴时。对于二维系统，这要求特征值为一对纯虚共轭复数，$\\lambda = \\pm i \\omega_{0}$，其中 $\\omega_{0} \\in \\mathbb{R}^{+}$。特征方程为 $\\lambda^2 - \\mathrm{Tr}(J) \\lambda + \\mathrm{Det}(J) = 0$。Hopf分岔的条件是：\n1. $\\mathrm{Tr}(J) = 0$\n2. $\\mathrm{Det}(J)  0$\n\n雅可比矩阵的迹是其对角元素之和：\n$$\n\\mathrm{Tr}(J) = J_{11} + J_{22} = \\frac{g_{E} w_{EE} - 1}{\\tau_{E}} - \\frac{g_{I} w_{II} + 1}{\\tau_{I}}\n$$\n将迹设为零，得到临界兴奋性增益 $g_{E}^{\\mathrm{crit}}$ 的条件：\n$$\n\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} - \\frac{g_{I} w_{II} + 1}{\\tau_{I}} = 0\n$$\n$$\n\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} = \\frac{g_{I} w_{II} + 1}{\\tau_{I}}\n$$\n求解 $g_{E}^{\\mathrm{crit}}$：\n$$\n\\tau_{I} (g_{E}^{\\mathrm{crit}} w_{EE} - 1) = \\tau_{E} (g_{I} w_{II} + 1)\n$$\n$$\ng_{E}^{\\mathrm{crit}} w_{EE} \\tau_{I} - \\tau_{I} = \\tau_{E} g_{I} w_{II} + \\tau_{E}\n$$\n$$\ng_{E}^{\\mathrm{crit}} w_{EE} \\tau_{I} = \\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}\n$$\n这给出了临界增益的闭式表达式：\n$$\ng_{E}^{\\mathrm{crit}} = \\frac{\\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}}{w_{EE} \\tau_{I}}\n$$\n问题陈述初始平衡是稳定的，意味着 $\\mathrm{Tr}(J)  0$。由于 $w_{EE}  0$（兴奋性自连接），$\\mathrm{Tr}(J)$ 是 $g_{E}$ 的增函数。当 $g_{E}$ 增加超过 $g_{E}^{\\mathrm{crit}}$ 时，$\\mathrm{Tr}(J)$ 变为正，导致不稳定性，这与问题设定一致。\n\n雅可比矩阵的行列式是：\n$$\n\\mathrm{Det}(J) = J_{11} J_{22} - J_{12} J_{21} = \\left(\\frac{g_{E} w_{EE} - 1}{\\tau_{E}}\\right) \\left(-\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right) - \\left(-\\frac{g_{E} w_{EI}}{\\tau_{E}}\\right) \\left(\\frac{g_{I} w_{IE}}{\\tau_{I}}\\right)\n$$\n$$\n\\mathrm{Det}(J) = \\frac{-(g_{E} w_{EE} - 1)(g_{I} w_{II} + 1) + g_{E} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}}\n$$\n在分岔点，$\\lambda = \\pm i \\omega_{0}$，其中振荡的起始频率 $\\omega_{0}$ 由 $\\omega_{0}^{2} = \\mathrm{Det}(J)|_{g_{E}=g_{E}^{\\mathrm{crit}}}$ 给出。使用迹条件 $\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} = \\frac{g_{I} w_{II} + 1}{\\tau_{I}}$，我们可以将行列式表示为：\n$$\n\\mathrm{Det}(J)|_{\\mathrm{crit}} = -\\left(\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right)^2 + \\frac{g_{E}^{\\mathrm{crit}} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}}\n$$\n条件 $\\mathrm{Det}(J)  0$ 确保了非零频率。对于PING机制，这由回路结构（$w_{EI}, w_{IE}  0$）所满足。因此，起始频率为：\n$$\n\\omega_0 = \\sqrt{\\frac{g_{E}^{\\mathrm{crit}} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}} - \\left(\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right)^{2}}\n$$\n\n**3. 极限环振幅的标度关系**\n问题指定了超临界Hopf分岔。根据此类分岔的范式理论，新出现的极限环的振幅与距分岔点的距离的平方根成标度关系。设分岔参数为 $\\mu = g_{E}(D) - g_{E}^{\\mathrm{crit}}$。当 $\\mu  0$ 时系统是稳定的，当 $\\mu  0$ 时表现出振荡。\n\n分岔点附近振荡振幅 $r$ 的范式方程为：\n$$\n\\frac{dr}{dt} = \\alpha \\mu r - \\beta r^3 + O(r^5)\n$$\n其中 $\\alpha  0$，且对于超临界分岔，$\\beta  0$。S型函数的三阶导数为负（$S'''  0$）的假设是确保 $\\beta  0$ 的一个充分条件。\n通过令 $\\frac{dr}{dt} = 0$ 来找到极限环的稳态振幅：\n$$\nr(\\alpha \\mu - \\beta r^2) = 0\n$$\n当 $\\mu  0$ 时，这给出了一个 $r0$ 的非平凡稳定解：\n$$\nr = \\sqrt{\\frac{\\alpha}{\\beta}} \\sqrt{\\mu}\n$$\n状态变量 $E(t)$ 和 $I(t)$ 中的振荡振幅与这个范式振幅 $r$ 成正比。因此，在 $(E,I)$ 相平面中极限环的峰-谷振幅，我们称之为 $A$，其主阶依赖关系为：\n$$\nA \\propto \\sqrt{g_{E}(D) - g_{E}^{\\mathrm{crit}}}\n$$\n这个关系表明，当多巴胺 $D$ 使增益 $g_{E}(D)$ 增加到刚好超过临界阈值 $g_{E}^{\\mathrm{crit}}$ 时，节律生成开始，其振荡的振幅从零平滑增长。",
            "answer": "$$\n\\boxed{\\frac{\\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}}{w_{EE} \\tau_{I}}}\n$$"
        },
        {
            "introduction": "PING机制的一个核心特征是兴奋性（E）锥体细胞群和抑制性（I）中间神经元群活动之间的精确时间关系。本练习将焦点放在一个线性化的PING模型上，通过计算E-I群体活动之间的相位滞后，来揭示这种时间结构是如何由突触和膜的时间常数以及传导延迟决定的。掌握这种频域分析方法对于连接神经元的生物物理特性与网络层面的振荡动力学至关重要 。",
            "id": "4012041",
            "problem": "考虑一个简化的锥体-中间神经元网络伽马 (PING) 机制的线性化模型，该模型由一个活动为 $E(t)$ 的兴奋性锥体细胞群和一个活动为 $I(t)$ 的抑制性中间神经元群组成。在一个稳定极限环附近，兴奋性活动可以近似为伽马频率的正弦波，$E(t) = E_{0} \\cos(\\omega t)$，其中 $\\omega = 2 \\pi f$，$f$ 为振荡频率。从 $E$ 到 $I$ 的抑制性通路被建模为一个级联系统，该系统由一个时间常数为 $\\tau_{sI}$ 的突触低通滤波器、一个时间常数为 $\\tau_{mI}$ 的抑制性膜低通滤波器以及兴奋性到抑制性通路上的一个传导延迟 $d_{I}$ 组成。相应的线性常微分方程为：\n$$\n\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I}),\n$$\n$$\n\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t),\n$$\n其中 $s_{I}(t)$ 是抑制性突触驱动，$g_{I}  0$ 是一个恒定增益。假设与上述抑制性通路相比，兴奋性细胞群自身的滤波和传导延迟可以忽略不计，并且系统在频率 $f$ 下以稳态正弦振荡运行，因此抑制性活动的形式为 $I(t) = I_{0} \\cos(\\omega t - \\phi_{EI})$，其中存在某个相位滞后 $\\phi_{EI}  0$。\n\n从这些方程和由正弦输入驱动的线性时不变系统的第一性原理出发，推导相位滞后 $\\phi_{EI}$ 与抑制性通路相位响应之间的解析关系，然后为以下具有伽马节律特征的科学合理参数集计算 $\\phi_{EI}$ 的数值：\n- $f = 40\\,\\mathrm{Hz}$，\n- $\\tau_{sI} = 5 \\times 10^{-3}\\,\\mathrm{s}$，\n- $\\tau_{mI} = 10 \\times 10^{-3}\\,\\mathrm{s}$，\n- $d_{I} = 1.5 \\times 10^{-3}\\,\\mathrm{s}$。\n\n将 $\\phi_{EI}$ 的最终答案以弧度表示，并四舍五入到四位有效数字。最终答案必须是一个单一的实数值。",
            "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 兴奋性细胞群活动：$E(t) = E_{0} \\cos(\\omega t)$\n- 角频率：$\\omega = 2 \\pi f$\n- 抑制性突触驱动 $s_I(t)$ 的微分方程：$\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I})$\n- 抑制性细胞群活动 $I(t)$ 的微分方程：$\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t)$\n- 增益常数：$g_{I}  0$\n- 抑制性细胞群活动形式：$I(t) = I_{0} \\cos(\\omega t - \\phi_{EI})$，相位滞后 $\\phi_{EI}  0$\n- 数值参数：\n    - 频率：$f = 40\\,\\mathrm{Hz}$\n    - 突触时间常数：$\\tau_{sI} = 5 \\times 10^{-3}\\,\\mathrm{s}$\n    - 膜时间常数：$\\tau_{mI} = 10 \\times 10^{-3}\\,\\mathrm{s}$\n    - 传导延迟：$d_{I} = 1.5 \\times 10^{-3}\\,\\mathrm{s}$\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题提出了 PING 机制的一个线性化模型，这是计算神经科学中解释伽马波段振荡的基石。其控制方程是一阶线性常微分方程，是突触和神经元膜低通滤波效应的标准表示。参数值对于皮层回路是生理上真实的。该问题在科学上是合理的。\n- **适定性：** 该问题要求解一个线性时不变 (LTI) 系统对正弦输入的稳态相位响应。这是系统分析中的一个经典且定义明确的问题，它保证了相位滞后存在唯一且稳定的解。\n- **客观性：** 该问题使用精确的数学和科学语言陈述，没有歧义或主观论断。\n\n**第 3 步：结论与行动**\n该问题是有效的。它有科学依据，数学上适定，且陈述客观。将提供一个完整的解答。\n\n所描述的系统由一系列级联的线性时不变 (LTI) 算子组成，将输入信号 $E(t)$ 转换为输出信号 $I(t)$。分析 LTI 系统对正弦输入的稳态响应，最有效的方法是频域分析。我们将用其复传递函数 $H(j\\omega)$ 来表示抑制性通路中的每个组件。\n\n从 $E(t)$ 到 $I(t)$ 的总体转换可以分解为三个相继的阶段：\n1. 一个 $d_I$ 的纯时间延迟。\n2. 一个代表突触动力学的一阶低通滤波器，时间常数为 $\\tau_{sI}$。\n3. 一个增益为 $g_I$、代表抑制性膜动力学的一阶低通滤波器，时间常数为 $\\tau_{mI}$。\n\n让我们求出每个阶段的传递函数。对于一个传递函数为 $H(j\\omega)$ 的 LTI 系统，形式为 $\\exp(j\\omega t)$ 的输入会产生输出 $H(j\\omega)\\exp(j\\omega t)$。复数 $H(j\\omega)$ 的相位，记为 $\\arg\\{H(j\\omega)\\}$，给出了输出相对于输入的相位移。\n\n第一个方程 $\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I})$ 描述了突触滤波器对一个延迟输入的响应。我们可以将延迟和突触滤波器结合起来。从 $E(t)$ 到 $s_I(t)$ 的总转换由该方程控制。我们定义一个中间变量 $E_d(t) = E(t - d_I)$。\n在频域中（或使用相量分析），我们代入 $E(t) = E_0 \\exp(j\\omega t)$，这意味着 $E_d(t) = E_0 \\exp(j\\omega(t-d_I)) = (E_0 \\exp(-j\\omega d_I)) \\exp(j\\omega t)$。我们寻找一个形式为 $s_I(t) = S_I \\exp(j\\omega t)$ 的解。代入第一个微分方程得到：\n$$\n\\tau_{sI} (j\\omega S_I \\exp(j\\omega t)) + S_I \\exp(j\\omega t) = E_0 \\exp(-j\\omega d_I) \\exp(j\\omega t)\n$$\n$$\nS_I (j\\omega \\tau_{sI} + 1) = E_0 \\exp(-j\\omega d_I)\n$$\n突触驱动的复振幅是 $S_I = \\frac{E_0 \\exp(-j\\omega d_I)}{1 + j\\omega \\tau_{sI}}$。\n\n现在，我们将此结果作为输入代入第二个方程 $\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t)$。我们寻求一个形式为 $I(t) = I_{complex} \\exp(j\\omega t)$ 的解，其中 $I_{complex}$ 是抑制性活动的复振幅。\n$$\n\\tau_{mI} (j\\omega I_{complex} \\exp(j\\omega t)) + I_{complex} \\exp(j\\omega t) = g_I (S_I \\exp(j\\omega t))\n$$\n$$\nI_{complex} (j\\omega \\tau_{mI} + 1) = g_I S_I\n$$\n代入 $S_I$ 的表达式：\n$$\nI_{complex} = \\frac{g_I S_I}{1 + j\\omega \\tau_{mI}} = \\frac{g_I}{1 + j\\omega \\tau_{mI}} \\left( \\frac{E_0 \\exp(-j\\omega d_I)}{1 + j\\omega \\tau_{sI}} \\right)\n$$\n从 $E(t)$ 到 $I(t)$ 的总传递函数 $H_{EI}(j\\omega)$ 是它们复振幅之比 $I_{complex}/E_0$：\n$$\nH_{EI}(j\\omega) = \\frac{I_{complex}}{E_0} = \\frac{g_I \\exp(-j\\omega d_I)}{(1 + j\\omega \\tau_{sI})(1 + j\\omega \\tau_{mI})}\n$$\n输出 $I(t)$ 相对于输入 $E(t)$ 的相位移是这个复传递函数的辐角，$\\arg\\{H_{EI}(j\\omega)\\}$。复数乘积/商的相位是它们各自相位的和/差：\n$$\n\\arg\\{H_{EI}(j\\omega)\\} = \\arg\\{g_I\\} + \\arg\\{\\exp(-j\\omega d_I)\\} - \\arg\\{1 + j\\omega \\tau_{sI}\\} - \\arg\\{1 + j\\omega \\tau_{mI}\\}\n$$\n由于 $g_I$ 是一个正实数，$\\arg\\{g_I\\}=0$。$\\exp(-j\\omega d_I)$ 的相位是 $-\\omega d_I$。复数 $1+jx$ 的相位是 $\\arctan(x)$。因此：\n$$\n\\phi_{\\text{shift}} = -\\omega d_I - \\arctan(\\omega \\tau_{sI}) - \\arctan(\\omega \\tau_{mI})\n$$\n问题将输出定义为 $I(t) = I_0 \\cos(\\omega t - \\phi_{EI})$。一个 $\\phi_{\\text{shift}}$ 的相位移对应于形式为 $\\cos(\\omega t + \\phi_{\\text{shift}})$ 的输出。通过比较这两种形式，我们有 $\\cos(\\omega t - \\phi_{EI}) = \\cos(\\omega t + \\phi_{\\text{shift}})$。这意味着 $\\phi_{EI} = -\\phi_{\\text{shift}}$。\n因此，相位滞后 $\\phi_{EI}$ 是：\n$$\n\\phi_{EI} = \\omega d_I + \\arctan(\\omega \\tau_{sI}) + \\arctan(\\omega \\tau_{mI})\n$$\n这就是相位滞后与抑制性通路参数之间的解析关系。\n\n现在，我们使用给定的参数计算其数值。\n首先，计算角频率 $\\omega$：\n$$\n\\omega = 2 \\pi f = 2 \\pi (40\\,\\mathrm{Hz}) = 80 \\pi \\,\\mathrm{rad/s}\n$$\n接下来，计算 $\\phi_{EI}$ 表达式中每一项的值：\n1. 来自传导延迟 $d_I$ 的相位贡献：\n$$\n\\phi_{\\text{delay}} = \\omega d_I = (80 \\pi \\,\\mathrm{s}^{-1}) \\times (1.5 \\times 10^{-3}\\,\\mathrm{s}) = 0.12 \\pi \\,\\mathrm{rad}\n$$\n2. 来自时间常数为 $\\tau_{sI}$ 的突触滤波器的相位贡献：\n$$\n\\phi_{\\text{synapse}} = \\arctan(\\omega \\tau_{sI}) = \\arctan((80 \\pi \\,\\mathrm{s}^{-1}) \\times (5 \\times 10^{-3}\\,\\mathrm{s})) = \\arctan(0.4 \\pi) \\,\\mathrm{rad}\n$$\n3. 来自时间常数为 $\\tau_{mI}$ 的膜滤波器的相位贡献：\n$$\n\\phi_{\\text{membrane}} = \\arctan(\\omega \\tau_{mI}) = \\arctan((80 \\pi \\,\\mathrm{s}^{-1}) \\times (10 \\times 10^{-3}\\,\\mathrm{s})) = \\arctan(0.8 \\pi) \\,\\mathrm{rad}\n$$\n总相位滞后 $\\phi_{EI}$ 是这三项贡献之和：\n$$\n\\phi_{EI} = 0.12 \\pi + \\arctan(0.4 \\pi) + \\arctan(0.8 \\pi)\n$$\n使用数值计算：\n$\\pi \\approx 3.14159265...$\n$$\n0.12 \\pi \\approx 0.376991\\,\\mathrm{rad}\n$$\n$$\n\\arctan(0.4 \\pi) \\approx \\arctan(1.256637)\\approx 0.898393\\,\\mathrm{rad}\n$$\n$$\n\\arctan(0.8 \\pi) \\approx \\arctan(2.513274)\\approx 1.192439\\,\\mathrm{rad}\n$$\n将这些值相加：\n$$\n\\phi_{EI} \\approx 0.376991 + 0.898393 + 1.192439 = 2.467823\\,\\mathrm{rad}\n$$\n四舍五入到四位有效数字，我们得到 $2.468$。",
            "answer": "$$\n\\boxed{2.468}\n$$"
        },
        {
            "introduction": "大脑节律并非孤立运行，它们能与感觉输入或其他脑区的活动实现同步，这是神经信息处理的关键机制。本练习采用一个描述振荡器行为的规范模型——Stuart-Landau方程，来模拟一个类PING节律如何被外部周期性驱动所“夹带”或“同步”。通过编程计算并绘制出著名的“Arnold舌”，您将定量地探索神经同步的原理，并理解振荡器对外部输入的频率和强度的响应范围 。",
            "id": "4011975",
            "problem": "本题要求您在一个锥体-中间神经元伽马（PING）振荡的简化模型中，量化在兴奋性输入受到外部周期性调制下的相位锁定情况，并计算阿诺德舌（发生同步的幅度和频率区域）。目标是确定同步带宽作为调制幅度的函数。本问题侧重于一种基于数学原理的方法，该方法基于在霍普夫分岔附近将耦合的兴奋-抑制群体动力学简化为典范振荡范式。锥体-中间神经元伽马（PING）指的是由兴奋性锥体细胞和抑制性中间神经元相互作用产生的伽马波段振荡。在振荡机制附近，诸如 Wilson-Cowan 群体模型等耦合的兴奋-抑制系统的宏观动力学，可以通过中心流形理论和范式分析，简化为一个由 Stuart-Landau 范式描述的幅度-相位振荡器。在主导阶上，兴奋性输入的外部周期性调制会转化为对振荡器状态实部的周期性驱动。阿诺德舌定义为发生 $1{:}1$ 相位锁定（同步）的驱动幅度和频率的集合。\n\n实现一个典范 Stuart-Landau 振荡器的模拟，该振荡器的实部（代表兴奋性驱动调制）上施加了附加的正弦驱动，并通过分析振荡器与外部驱动之间的相位差来确定相位锁定。使用以下常微分方程（ODEs），这是一个霍普夫分岔附近振荡模式的典范范式：\n$$\n\\frac{dx}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,x - \\omega_0\\,y + A\\,\\cos\\left(2\\pi f_{\\mathrm{ext}} t\\right),\n$$\n$$\n\\frac{dy}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,y + \\omega_0\\,x,\n$$\n其中 $z = x + i\\,y$ 是复振荡器状态，$\\lambda  0$ 控制自持振荡的幅度，$c  0$ 决定非线性饱和，$\\omega_0 = 2\\pi f_0$ 是无驱动振荡器的自然角频率，$A$ 是驱动幅度，$f_{\\mathrm{ext}}$ 是外部驱动频率。\n\n科学基础和假设：\n- 在振荡机制附近，耦合的兴奋-抑制 Wilson-Cowan 动力学允许在霍普夫分岔周围的中心流形上简化为 Stuart-Landau 范式，其中兴奋性输入的外部周期性调制主要投影到简化模式的实部上。\n- 对于 $1{:}1$ 锁定，阿诺德舌由 $(A, f_{\\mathrm{ext}})$ 平面中的参数区域定义，在该区域中，振荡器相对于驱动的相位差是有界的并且渐近恒定。\n\n实现细节：\n- 使用参数 $\\lambda = 1.0$（无量纲），$c = 1.0$（无量纲），$f_0 = 40\\,\\mathrm{Hz}$（因此 $\\omega_0 = 2\\pi \\cdot 40\\,\\mathrm{rad/s}$）。\n- 模拟总时长 $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$，时间步长 $dt = 0.0005\\,\\mathrm{s}$，初始条件为 $x(0) = \\sqrt{\\lambda/c}$，$y(0) = 0$。\n- 对于每个驱动幅度 $A$，在 $[20\\,\\mathrm{Hz}, 60\\,\\mathrm{Hz}]$ 范围内以 $1\\,\\mathrm{Hz}$ 的步长扫描驱动频率 $f_{\\mathrm{ext}}$。\n- 按如下方式确定 $1{:}1$ 相位锁定。以弧度为单位，计算瞬时振荡器相位 $\\phi(t) = \\mathrm{unwrap}(\\arctan2(y(t),x(t)))$。定义相位差 $\\psi(t) = \\phi(t) - 2\\pi f_{\\mathrm{ext}} t$，角度使用弧度。在模拟的最后 $1.5\\,\\mathrm{s}$（即，在丢弃作为瞬态的前半部分时间序列后），通过数值微分计算 $d\\psi/dt$。如果 $d\\psi/dt$ 的平均绝对值小于 $1.0\\,\\mathrm{rad/s}$ 且 $d\\psi/dt$ 的标准差小于 $2.0\\,\\mathrm{rad/s}$，则宣布相位锁定。\n- 对于每个 $A$，同步带宽定义为检测到锁定的 $f_{\\mathrm{ext}}$ 范围（单位为 $\\mathrm{Hz}$），具体为锁定频率集合中 $\\max(f_{\\mathrm{ext}})$ 与 $\\min(f_{\\mathrm{ext}})$ 之差。如果没有频率锁定，则带宽为 $0.0$。根据定义，对于 $A = 0.0$，报告带宽为 $0.0$。\n- 所有频率以 $\\mathrm{Hz}$ 表示，角度以弧度表示。输出的带宽必须是单位为 $\\mathrm{Hz}$ 的浮点数。\n\n测试套件：\n- 使用驱动幅度 $A \\in \\{0.0, 0.02, 0.05, 0.10, 0.20\\}$（无量纲）。\n- 对于每个 $A$，扫描 $f_{\\mathrm{ext}} \\in \\{20, 21, \\dots, 60\\}\\,\\mathrm{Hz}$。\n- 最终输出必须是单行，包含上述幅度的同步带宽，形式为方括号内以逗号分隔的列表，例如 $[b_1,b_2,b_3,b_4,b_5]$，其中每个 $b_k$ 是单位为 $\\mathrm{Hz}$ 的浮点数。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表的结果（例如 $[b_1,b_2,b_3,b_4,b_5]$）。不允许有其他输出。",
            "solution": "问题陈述经评估有效。它在科学上基于动力系统和计算神经科学的既定理论，特别是使用 Stuart-Landau 方程作为霍普夫分岔的范式，这是像锥体-中间神经元伽马（PING）机制这类神经振荡的标准模型。该问题提法恰当，提供了一整套常微分方程（ODEs）、参数、初始条件，以及确定解的清晰、客观的程序。术语精确，设置无矛盾或歧义。\n\n任务是确定一个受驱动的 Stuart-Landau 振荡器的同步带宽，该振荡器可作为振荡不稳定性附近周期性驱动的神经群体动力学的典范模型。同步带宽是振荡器与外部驱动发生相位锁定的驱动频率范围。在驱动幅度和频率的参数空间中，这个区域被称为阿诺德舌。\n\n控制方程为：\n$$\n\\frac{dx}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,x - \\omega_0\\,y + A\\,\\cos\\left(2\\pi f_{\\mathrm{ext}} t\\right)\n$$\n$$\n\\frac{dy}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,y + \\omega_0\\,x\n$$\n在此，振荡器的状态由坐标 $(x(t), y(t))$ 给出。项 $(\\lambda - c\\,(x^2+y^2))$ 控制幅度动力学，其中 $\\lambda  0$ 为自振荡提供能量，$c  0$ 提供非线性饱和，从而形成一个半径为 $r = \\sqrt{x^2+y^2} = \\sqrt{\\lambda/c}$ 的稳定极限环。包含 $\\omega_0 = 2\\pi f_0$ 的项以自然频率 $f_0$ 产生内在振荡。外部驱动是一个振幅为 $A$、频率为 $f_{\\mathrm{ext}}$ 的正弦驱动，施加于 $x$ 分量上，用以模拟兴奋性群体输入的周期性调制。\n\n求解方法包括对参数网格 $(A, f_{\\mathrm{ext}})$ 上的这些常微分方程进行数值模拟，并分析所得时间序列以检测相位锁定。总体步骤如下：\n\n1.  **数值积分**：该常微分方程组被数值求解。鉴于问题指定的小时间步长 $dt = 0.0005\\,\\mathrm{s}$ 和动力学特性，一阶前向欧拉积分方案是足够且计算高效的。对于每个时间步，状态 $(x_{i+1}, y_{i+1})$ 根据状态 $(x_i, y_i)$ 和在时间 $t_i$ 计算的导数进行更新：\n    $$ x_{i+1} = x_i + \\left[ (\\lambda - c(x_i^2+y_i^2))x_i - \\omega_0 y_i + A\\cos(2\\pi f_{\\mathrm{ext}} t_i) \\right] dt $$\n    $$ y_{i+1} = y_i + \\left[ (\\lambda - c(x_i^2+y_i^2))y_i + \\omega_0 x_i \\right] dt $$\n    对于每组参数，模拟运行总时长 $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$，从初始条件 $x(0) = \\sqrt{\\lambda/c} = 1.0$ 和 $y(0) = 0.0$ 开始，这将系统置于其无驱动的极限环上。\n\n2.  **相位锁定分析**：当振荡器的频率与外部驱动同步时，发生相位锁定或同步。这在数学上等同于振荡器与驱动之间的相位差渐近地变为常数。对每次模拟的分析过程如下：\n    - 振荡器的瞬时相位由笛卡尔坐标计算得出：$\\phi(t) = \\mathrm{unwrap}(\\arctan2(y(t),x(t)))$。`unwrap` 函数是必要的，用以校正 $2\\pi$ 的跳变并获得连续的相位变量。\n    - 外部驱动的相位是 $\\phi_{\\mathrm{ext}}(t) = 2\\pi f_{\\mathrm{ext}} t$。\n    - 相位差定义为 $\\psi(t) = \\phi(t) - \\phi_{\\mathrm{ext}}(t)$。\n    - 如果该相位差的变化率 $d\\psi/dt$ 趋近于零，则认为系统是相位锁定的。为了评估这一点，我们分析模拟的后半部分（$t \\in [1.5, 3.0]\\,\\mathrm{s}$），以丢弃初始瞬态。\n    - 时间导数 $d\\psi/dt$ 使用有限差分进行数值计算。\n    - 根据问题的具体标准，如果导数的绝对值的平均值 $\\langle |d\\psi/dt| \\rangle$ 小于 $1.0\\,\\mathrm{rad/s}$，并且导数的标准差 $\\sigma(d\\psi/dt)$ 小于 $2.0\\,\\mathrm{rad/s}$，则宣布锁定。这些阈值确保了相位差平均不漂移且其波动很小。\n\n3.  **同步带宽计算**：问题的核心是确定每个测试的驱动幅度 $A$ 的同步带宽。\n    - 对于给定的 $A$，对频率范围为 $[20, 60]\\,\\mathrm{Hz}$、步长为 $1\\,\\mathrm{Hz}$ 的每个驱动频率 $f_{\\mathrm{ext}}$ 重复进行模拟和相位锁定分析。\n    - 这会生成一个系统处于相位锁定状态的频率集合。\n    - 然后，同步带宽计算为此集合的范围：$\\max(f_{\\mathrm{locked}}) - \\min(f_{\\mathrm{locked}})$。\n    - 如果在扫描范围内没有频率导致锁定，则带宽为 $0.0\\,\\mathrm{Hz}$。根据定义，对于无驱动情况（$A=0.0$），带宽也为 $0.0\\,\\mathrm{Hz}$。\n\n这种系统化的方法使我们能够为给定的模型参数和驱动幅度绘制出 $1{:}1$ 阿诺德舌的宽度。最终输出是这些带宽的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_and_check_locking(A, f_ext, params):\n    \"\"\"\n    Simulates the Stuart-Landau oscillator and checks for phase locking.\n\n    Args:\n        A (float): Forcing amplitude.\n        f_ext (float): Forcing frequency in Hz.\n        params (tuple): A tuple containing model and simulation parameters.\n\n    Returns:\n        bool: True if phase-locked, False otherwise.\n    \"\"\"\n    lambda_val, c_val, f0, T_total, dt = params\n    omega0 = 2.0 * np.pi * f0\n\n    # Simulation setup\n    num_steps = int(T_total / dt)\n    t = np.linspace(0, T_total, num_steps + 1)\n    x = np.zeros(num_steps + 1)\n    y = np.zeros(num_steps + 1)\n\n    # Initial conditions\n    x[0] = np.sqrt(lambda_val / c_val)\n    y[0] = 0.0\n\n    # Forward Euler integration\n    for i in range(num_steps):\n        x_i, y_i, t_i = x[i], y[i], t[i]\n        r_squared = x_i**2 + y_i**2\n        \n        dx = (lambda_val - c_val * r_squared) * x_i - omega0 * y_i + A * np.cos(2 * np.pi * f_ext * t_i)\n        dy = (lambda_val - c_val * r_squared) * y_i + omega0 * x_i\n        \n        x[i+1] = x_i + dx * dt\n        y[i+1] = y_i + dy * dt\n\n    # Analysis of the second half of the simulation\n    analysis_start_index = int((T_total / 2.0) / dt)\n    \n    y_analysis = y[analysis_start_index:]\n    x_analysis = x[analysis_start_index:]\n    t_analysis = t[analysis_start_index:]\n\n    # Phase calculation\n    osc_phase = np.unwrap(np.arctan2(y_analysis, x_analysis))\n    drive_phase = 2.0 * np.pi * f_ext * t_analysis\n    phase_diff = osc_phase - drive_phase\n    \n    # Derivative of phase difference using finite differences\n    if len(phase_diff)  2:\n        return False\n    d_phase_diff_dt = np.diff(phase_diff) / dt\n    \n    # Locking criteria\n    mean_abs_d_psi_dt = np.mean(np.abs(d_phase_diff_dt))\n    std_d_psi_dt = np.std(d_phase_diff_dt)\n    \n    is_locked = mean_abs_d_psi_dt  1.0 and std_d_psi_dt  2.0\n    \n    return is_locked\n\ndef solve():\n    \"\"\"\n    Calculates the entrainment bandwidth for a range of forcing amplitudes.\n    \"\"\"\n    # Define model and simulation parameters from the problem statement.\n    params = {\n        'lambda_val': 1.0,\n        'c_val': 1.0,\n        'f0': 40.0,  # Hz\n        'T_total': 3.0,  # s\n        'dt': 0.0005,  # s\n    }\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0, 0.02, 0.05, 0.10, 0.20\n    ]\n\n    f_ext_scan_range = np.arange(20, 61, 1)  # Frequencies from 20 Hz to 60 Hz in 1 Hz steps.\n    \n    param_tuple = (params['lambda_val'], params['c_val'], params['f0'], params['T_total'], params['dt'])\n\n    bandwidth_results = []\n    \n    for A in test_cases:\n        # Per problem spec, bandwidth is 0.0 for A = 0.0\n        if A == 0.0:\n            bandwidth_results.append(0.0)\n            continue\n            \n        locked_frequencies = []\n        for f_ext in f_ext_scan_range:\n            if simulate_and_check_locking(A, float(f_ext), param_tuple):\n                locked_frequencies.append(f_ext)\n        \n        if not locked_frequencies:\n            bandwidth = 0.0\n        else:\n            # Bandwidth is the span of locked frequencies\n            bandwidth = float(max(locked_frequencies) - min(locked_frequencies))\n            \n        bandwidth_results.append(bandwidth)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, bandwidth_results))}]\")\n\nsolve()\n```"
        }
    ]
}