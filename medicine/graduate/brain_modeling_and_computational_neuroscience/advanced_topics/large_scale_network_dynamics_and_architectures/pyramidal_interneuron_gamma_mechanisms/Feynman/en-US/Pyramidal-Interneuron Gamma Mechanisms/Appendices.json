{
    "hands_on_practices": [
        {
            "introduction": "To understand how the pyramidal-interneuron gamma (PING) circuit generates a rhythm, we must first dissect its fundamental temporal components. The oscillation period critically depends on the time it takes for a signal to travel from the excitatory (E) population to the inhibitory (I) population and back. This exercise uses the tools of linear systems analysis to quantify the phase lag, $\\phi_{EI}$, between the E and I populations. By modeling the inhibitory pathway as a series of filters and delays, you will directly calculate how biophysical parameters like synaptic time constants, membrane time constants, and conduction delays collectively determine the timing of the network .",
            "id": "4012041",
            "problem": "Consider a simplified linearized module of the Pyramidal-Interneuron Network Gamma (PING) mechanism consisting of one excitatory pyramidal population with activity $E(t)$ and one inhibitory interneuron population with activity $I(t)$. Near a stable limit cycle, the excitatory activity can be approximated by a sinusoid at the gamma frequency, $E(t) = E_{0} \\cos(\\omega t)$, where $\\omega = 2 \\pi f$ and $f$ is the oscillation frequency. The inhibitory pathway from $E$ to $I$ is modeled as a cascade of a synaptic low-pass filter with time constant $\\tau_{sI}$, followed by an inhibitory membrane low-pass filter with time constant $\\tau_{mI}$, and a conduction delay $d_{I}$ on the excitatory-to-inhibitory pathway. The corresponding linear ordinary differential equations are:\n$$\n\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I}),\n$$\n$$\n\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t),\n$$\nwhere $s_{I}(t)$ is the inhibitory synaptic drive and $g_{I} > 0$ is a constant gain. Assume that the excitatory population’s own filtering and conduction delays are negligible compared to the inhibitory pathway described above, and that the system is operating at a steady-state sinusoidal oscillation at frequency $f$ so that the inhibitory activity takes the form $I(t) = I_{0} \\cos(\\omega t - \\phi_{EI})$ for some phase lag $\\phi_{EI} > 0$.\n\nStarting from these equations and first principles of linear time-invariant systems driven by sinusoidal inputs, derive the analytic relationship between the phase lag $\\phi_{EI}$ and the inhibitory pathway’s phase response, and then compute the numerical value of $\\phi_{EI}$ for the following scientifically plausible parameter set characteristic of gamma rhythms:\n- $f = 40\\,\\mathrm{Hz}$,\n- $\\tau_{sI} = 5 \\times 10^{-3}\\,\\mathrm{s}$,\n- $\\tau_{mI} = 10 \\times 10^{-3}\\,\\mathrm{s}$,\n- $d_{I} = 1.5 \\times 10^{-3}\\,\\mathrm{s}$.\n\nExpress your final answer for $\\phi_{EI}$ in radians, rounded to four significant figures. The final answer must be a single real-valued number.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Excitatory population activity: $E(t) = E_{0} \\cos(\\omega t)$\n- Angular frequency: $\\omega = 2 \\pi f$\n- Differential equation for inhibitory synaptic drive $s_I(t)$: $\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I})$\n- Differential equation for inhibitory population activity $I(t)$: $\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t)$\n- Gain constant: $g_{I} > 0$\n- Inhibitory population activity form: $I(t) = I_{0} \\cos(\\omega t - \\phi_{EI})$ with phase lag $\\phi_{EI} > 0$\n- Numerical parameters:\n    - Frequency: $f = 40\\,\\mathrm{Hz}$\n    - Synaptic time constant: $\\tau_{sI} = 5 \\times 10^{-3}\\,\\mathrm{s}$\n    - Membrane time constant: $\\tau_{mI} = 10 \\times 10^{-3}\\,\\mathrm{s}$\n    - Conduction delay: $d_{I} = 1.5 \\times 10^{-3}\\,\\mathrm{s}$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem presents a linearized model of the PING mechanism, a cornerstone of computational neuroscience for explaining gamma-band oscillations. The governing equations are first-order linear ordinary differential equations, which are standard representations for low-pass filtering effects of synapses and neuronal membranes. The parameter values are physiologically realistic for cortical circuits. The problem is scientifically sound.\n- **Well-Posed:** The problem asks for the steady-state phase response of a linear time-invariant (LTI) system to a sinusoidal input. This is a classic and well-defined problem in systems analysis, which guarantees a unique and stable solution for the phase lag.\n- **Objective:** The problem is stated using precise mathematical and scientific language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically grounded, mathematically well-posed, and objectively stated. A complete solution will be provided.\n\nThe system described consists of a cascade of linear time-invariant (LTI) operators transforming the input signal $E(t)$ into the output signal $I(t)$. The most efficient method for analyzing the steady-state response of an LTI system to a sinusoidal input is frequency-domain analysis. We will represent each component of the inhibitory pathway by its complex transfer function, $H(j\\omega)$.\n\nThe overall transformation from $E(t)$ to $I(t)$ can be broken down into three sequential stages:\n1. A pure time delay of $d_I$.\n2. A first-order low-pass filter representing the synaptic dynamics, with time constant $\\tau_{sI}$.\n3. A first-order low-pass filter with gain $g_I$ representing the inhibitory membrane dynamics, with time constant $\\tau_{mI}$.\n\nLet us find the transfer function for each stage. An input of the form $\\exp(j\\omega t)$ to an LTI system with transfer function $H(j\\omega)$ produces an output $H(j\\omega)\\exp(j\\omega t)$. The phase of the complex number $H(j\\omega)$, denoted $\\arg\\{H(j\\omega)\\}$, gives the phase shift of the output relative to the input.\n\nThe first equation, $\\tau_{sI} \\frac{d s_{I}(t)}{d t} + s_{I}(t) = E(t - d_{I})$, describes the response of the synaptic filter to a delayed input. We can combine the delay and the synaptic filter. The total transformation from $E(t)$ to $s_I(t)$ is governed by this equation. Let us define an intermediate variable $E_d(t) = E(t - d_I)$.\nIn the frequency domain (or using phasor analysis), we substitute $E(t) = E_0 \\exp(j\\omega t)$, which implies $E_d(t) = E_0 \\exp(j\\omega(t-d_I)) = (E_0 \\exp(-j\\omega d_I)) \\exp(j\\omega t)$. We look for a solution $s_I(t)$ of the form $S_I \\exp(j\\omega t)$. Substituting into the first differential equation gives:\n$$\n\\tau_{sI} (j\\omega S_I \\exp(j\\omega t)) + S_I \\exp(j\\omega t) = E_0 \\exp(-j\\omega d_I) \\exp(j\\omega t)\n$$\n$$\nS_I (j\\omega \\tau_{sI} + 1) = E_0 \\exp(-j\\omega d_I)\n$$\nThe complex amplitude of the synaptic drive is $S_I = \\frac{E_0 \\exp(-j\\omega d_I)}{1 + j\\omega \\tau_{sI}}$.\n\nNow, we use this result as the input to the second equation, $\\tau_{mI} \\frac{d I(t)}{d t} + I(t) = g_{I} \\, s_{I}(t)$. We seek a solution $I(t)$ of the form $I_{complex} \\exp(j\\omega t)$, where $I_{complex}$ is the complex amplitude of the inhibitory activity.\n$$\n\\tau_{mI} (j\\omega I_{complex} \\exp(j\\omega t)) + I_{complex} \\exp(j\\omega t) = g_I (S_I \\exp(j\\omega t))\n$$\n$$\nI_{complex} (j\\omega \\tau_{mI} + 1) = g_I S_I\n$$\nSubstituting the expression for $S_I$:\n$$\nI_{complex} = \\frac{g_I S_I}{1 + j\\omega \\tau_{mI}} = \\frac{g_I}{1 + j\\omega \\tau_{mI}} \\left( \\frac{E_0 \\exp(-j\\omega d_I)}{1 + j\\omega \\tau_{sI}} \\right)\n$$\nThe overall transfer function, $H_{EI}(j\\omega)$, from $E(t)$ to $I(t)$ is the ratio of their complex amplitudes, $I_{complex}/E_0$:\n$$\nH_{EI}(j\\omega) = \\frac{I_{complex}}{E_0} = \\frac{g_I \\exp(-j\\omega d_I)}{(1 + j\\omega \\tau_{sI})(1 + j\\omega \\tau_{mI})}\n$$\nThe phase shift of the output $I(t)$ relative to the input $E(t)$ is the argument of this complex transfer function, $\\arg\\{H_{EI}(j\\omega)\\}$. The phase of a product/quotient of complex numbers is the sum/difference of their individual phases:\n$$\n\\arg\\{H_{EI}(j\\omega)\\} = \\arg\\{g_I\\} + \\arg\\{\\exp(-j\\omega d_I)\\} - \\arg\\{1 + j\\omega \\tau_{sI}\\} - \\arg\\{1 + j\\omega \\tau_{mI}\\}\n$$\nSince $g_I$ is a positive real number, $\\arg\\{g_I\\}=0$. The phase of $\\exp(-j\\omega d_I)$ is $-\\omega d_I$. The phase of a complex number $1+jx$ is $\\arctan(x)$. Therefore:\n$$\n\\phi_{\\text{shift}} = -\\omega d_I - \\arctan(\\omega \\tau_{sI}) - \\arctan(\\omega \\tau_{mI})\n$$\nThe problem defines the output as $I(t) = I_0 \\cos(\\omega t - \\phi_{EI})$. A phase shift of $\\phi_{\\text{shift}}$ corresponds to an output of the form $\\cos(\\omega t + \\phi_{\\text{shift}})$. By comparing the two forms, we have $\\cos(\\omega t - \\phi_{EI}) = \\cos(\\omega t + \\phi_{\\text{shift}})$. This implies $\\phi_{EI} = -\\phi_{\\text{shift}}$.\nThus, the phase lag $\\phi_{EI}$ is:\n$$\n\\phi_{EI} = \\omega d_I + \\arctan(\\omega \\tau_{sI}) + \\arctan(\\omega \\tau_{mI})\n$$\nThis is the analytic relationship between the phase lag and the parameters of the inhibitory pathway.\n\nNow, we compute the numerical value using the provided parameters.\nFirst, calculate the angular frequency $\\omega$:\n$$\n\\omega = 2 \\pi f = 2 \\pi (40\\,\\mathrm{Hz}) = 80 \\pi \\,\\mathrm{rad/s}\n$$\nNext, calculate the arguments for each term in the expression for $\\phi_{EI}$:\n1. The phase contribution from the conduction delay $d_I$:\n$$\n\\phi_{\\text{delay}} = \\omega d_I = (80 \\pi \\,\\mathrm{s}^{-1}) \\times (1.5 \\times 10^{-3}\\,\\mathrm{s}) = 0.12 \\pi \\,\\mathrm{rad}\n$$\n2. The phase contribution from the synaptic filter with time constant $\\tau_{sI}$:\n$$\n\\phi_{\\text{synapse}} = \\arctan(\\omega \\tau_{sI}) = \\arctan((80 \\pi \\,\\mathrm{s}^{-1}) \\times (5 \\times 10^{-3}\\,\\mathrm{s})) = \\arctan(0.4 \\pi) \\,\\mathrm{rad}\n$$\n3. The phase contribution from the membrane filter with time constant $\\tau_{mI}$:\n$$\n\\phi_{\\text{membrane}} = \\arctan(\\omega \\tau_{mI}) = \\arctan((80 \\pi \\,\\mathrm{s}^{-1}) \\times (10 \\times 10^{-3}\\,\\mathrms)) = \\arctan(0.8 \\pi) \\,\\mathrm{rad}\n$$\nThe total phase lag $\\phi_{EI}$ is the sum of these three contributions:\n$$\n\\phi_{EI} = 0.12 \\pi + \\arctan(0.4 \\pi) + \\arctan(0.8 \\pi)\n$$\nUsing numerical values:\n$\\pi \\approx 3.14159265...$\n$$\n0.12 \\pi \\approx 0.376991\\,\\mathrm{rad}\n$$\n$$\n\\arctan(0.4 \\pi) \\approx \\arctan(1.256637)\\approx 0.898393\\,\\mathrm{rad}\n$$\n$$\n\\arctan(0.8 \\pi) \\approx \\arctan(2.513274)\\approx 1.192439\\,\\mathrm{rad}\n$$\nSumming these values:\n$$\n\\phi_{EI} \\approx 0.376991 + 0.898393 + 1.192439 = 2.467823\\,\\mathrm{rad}\n$$\nRounding to four significant figures, we get $2.468$.",
            "answer": "$$\n\\boxed{2.468}\n$$"
        },
        {
            "introduction": "Having examined the temporal building blocks of the PING loop, we now explore how these elements, when connected in a feedback circuit, give rise to spontaneous oscillations. This practice delves into the classic Wilson–Cowan model to demonstrate how a neural network can transition from a stable, non-oscillatory state to a stable, rhythmic state. You will use bifurcation theory to derive the critical threshold for the onset of oscillations, a phenomenon known as a Hopf bifurcation, and see how a neuromodulator like dopamine could theoretically control this transition by altering neuronal gain . This analysis provides a mathematical foundation for understanding rhythmogenesis in the brain.",
            "id": "4012014",
            "problem": "Consider a two-population Wilson–Cowan model of a pyramidal–interneuron gamma (PING) circuit composed of an excitatory pyramidal population and an inhibitory interneuron population. The Wilson–Cowan equations describe the coarse-grained population rates as\n$$\n\\tau_{E} \\frac{dE}{dt} = -E + S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right), \\quad\n\\tau_{I} \\frac{dI}{dt} = -I + S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right),\n$$\nwhere $E$ and $I$ are the excitatory and inhibitory population activities, $\\tau_{E}$ and $\\tau_{I}$ are population time constants, $w_{EE}$, $w_{EI}$, $w_{IE}$, and $w_{II}$ are effective synaptic gains, and $P_{E}$ and $P_{I}$ are tonic inputs. The functions $S_{E}(\\cdot)$ and $S_{I}(\\cdot)$ are smooth, saturating sigmoids representing population input–output transfer functions. Assume a stable equilibrium $(E^{*}, I^{*})$ exists in the absence of oscillations.\n\nDopamine modulates the excitatory gain by altering the slope of $S_{E}(\\cdot)$ at the operating point. Define the effective gains as the slopes at the equilibrium inputs: $g_{E} = S_{E}'(h_{E}^{*})$ and $g_{I} = S_{I}'(h_{I}^{*})$, with $h_{E}^{*} = w_{EE} E^{*} - w_{EI} I^{*} + P_{E}$ and $h_{I}^{*} = w_{IE} E^{*} - w_{II} I^{*} + P_{I}$. Model dopamine-dependent modulation as a linear scaling of the excitatory gain, $g_{E}(D) = g_{E0}\\left(1 + \\eta D\\right)$, for a small, dimensionless dopamine state variable $D$ and sensitivity $\\eta > 0$, while $g_{I}$ is unaffected.\n\nStarting from the Wilson–Cowan form and basic linearization principles, do the following:\n- Derive the Jacobian at $(E^{*}, I^{*})$ in terms of $\\tau_{E}$, $\\tau_{I}$, $w_{EE}$, $w_{EI}$, $w_{IE}$, $w_{II}$, $g_{E}$, and $g_{I}$.\n- Using the standard Hopf bifurcation condition for onset of oscillations in a two-dimensional system, derive the condition for the excitatory gain threshold $g_{E}^{\\mathrm{crit}}$ at which the equilibrium loses stability via a Hopf bifurcation. Express $g_{E}^{\\mathrm{crit}}$ in closed form.\n- Under the assumption of a supercritical Hopf bifurcation and smooth sigmoids with negative third derivative at the operating point (ensuring saturation), use the Hopf normal form to express how the limit cycle amplitude scales with dopamine via the distance to threshold, and provide the amplitude’s leading-order dependence on $g_{E}(D) - g_{E}^{\\mathrm{crit}}$.\n\nYou must justify each step from first principles (definition of the Wilson–Cowan model, linearization, and Hopf conditions). Provide clear intermediate symbolic expressions for the trace and determinant of the Jacobian and the onset frequency. Your final reported answer should be the single closed-form analytic expression for the gain threshold $g_{E}^{\\mathrm{crit}}$. No numerical evaluation is required. If you introduce any additional symbols for normal form coefficients, define them explicitly. Acronyms must be defined on first use. The final answer must be a single analytic expression without units.",
            "solution": "The problem shall first be subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe verbatim givens are as follows:\n- **Model Equations**: The Wilson–Cowan equations for a pyramidal-interneuron gamma (PING) circuit are:\n$$\n\\tau_{E} \\frac{dE}{dt} = -E + S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\\\\n\\tau_{I} \\frac{dI}{dt} = -I + S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right)\n$$\n- **Variables and Parameters**:\n  - $E, I$: excitatory and inhibitory population activities.\n  - $\\tau_{E}, \\tau_{I}$: population time constants.\n  - $w_{EE}, w_{EI}, w_{IE}, w_{II}$: effective synaptic gains.\n  - $P_{E}, P_{I}$: tonic inputs.\n  - $S_{E}(\\cdot), S_{I}(\\cdot)$: smooth, saturating sigmoid transfer functions.\n- **Equilibrium**: A stable equilibrium $(E^{*}, I^{*})$ exists.\n- **Effective Gains**: Defined as the slopes of the sigmoids at equilibrium:\n  - $g_{E} = S_{E}'(h_{E}^{*})$ with $h_{E}^{*} = w_{EE} E^{*} - w_{EI} I^{*} + P_{E}$.\n  - $g_{I} = S_{I}'(h_{I}^{*})$ with $h_{I}^{*} = w_{IE} E^{*} - w_{II} I^{*} + P_{I}$.\n- **Dopamine Modulation**: Modeled as $g_{E}(D) = g_{E0}\\left(1 + \\eta D\\right)$ for a small, dimensionless dopamine state variable $D$ and sensitivity $\\eta > 0$. The gain $g_{I}$ is unaffected.\n- **Assumptions**: The bifurcation is a supercritical Hopf bifurcation, and the sigmoids have a negative third derivative ($S''' < 0$) at the operating point.\n- **Required Derivations**:\n  1. The Jacobian at $(E^{*}, I^{*})$.\n  2. The condition for the excitatory gain threshold $g_{E}^{\\mathrm{crit}}$ for a Hopf bifurcation.\n  3. The scaling of the limit cycle amplitude with the distance to threshold, $g_{E}(D) - g_{E}^{\\mathrm{crit}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientific Grounding**: The problem is based on the Wilson–Cowan model, a foundational framework in theoretical and computational neuroscience for describing population-level neural dynamics. The analysis requested—linearization and Hopf bifurcation analysis—are standard, well-established methods in the study of dynamical systems. The PING (Pyramidal-Interneuron Gamma) mechanism is a prominent and experimentally supported hypothesis for the generation of gamma-band oscillations in the brain. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear and complete mathematical model and asks for specific derivations based on it. The assumptions provided (existence of a stable fixed point, supercritical nature of the bifurcation) ensure that a unique and meaningful solution can be derived.\n- **Objective**: The language is technical, precise, and free from any subjectivity or opinion.\n- **Completeness and Consistency**: The problem statement contains all necessary equations, definitions, and assumptions to proceed with the derivations. There are no internal contradictions.\n- **Realism**: While a simplification of neurobiology, the Wilson-Cowan model and the PING mechanism are scientifically plausible and widely used working models. The parameterization is symbolic, so no issues of physical inconsistency arise.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded exercise in the analysis of a standard computational neuroscience model. The solution process may proceed.\n\n---\n\nThe system is a two-dimensional dynamical system described by the following ordinary differential equations:\n$$\n\\frac{dE}{dt} = F_{E}(E, I) = \\frac{1}{\\tau_{E}} \\left[ -E + S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\\\\n\\frac{dI}{dt} = F_{I}(E, I) = \\frac{1}{\\tau_{I}} \\left[ -I + S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right]\n$$\nWe analyze the stability of the equilibrium point $(E^{*}, I^{*})$ by linearizing the system. The dynamics of small perturbations $\\delta E = E - E^{*}$ and $\\delta I = I - I^{*}$ are governed by the Jacobian matrix $J$ evaluated at this equilibrium.\n\n**1. Derivation of the Jacobian Matrix**\nThe Jacobian matrix is defined as $J_{ij} = \\frac{\\partial F_{i}}{\\partial x_{j}}$ where $\\mathbf{x} = (E, I)$. We calculate the four components:\n$J_{11} = \\frac{\\partial F_{E}}{\\partial E} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{E}} \\left[ -1 + \\frac{\\partial}{\\partial E} S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\nUsing the chain rule, $\\frac{\\partial S_{E}}{\\partial E} = S_{E}' \\cdot w_{EE}$. At the equilibrium, $S_{E}'(h_{E}^{*}) = g_{E}$.\nThus, $J_{11} = \\frac{1}{\\tau_{E}} \\left( g_{E} w_{EE} - 1 \\right)$.\n\n$J_{12} = \\frac{\\partial F_{E}}{\\partial I} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{E}} \\left[ \\frac{\\partial}{\\partial I} S_{E}\\!\\left(w_{EE} E - w_{EI} I + P_{E}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\nUsing the chain rule, $\\frac{\\partial S_{E}}{\\partial I} = S_{E}' \\cdot (-w_{EI})$.\nThus, $J_{12} = \\frac{1}{\\tau_{E}} \\left( -g_{E} w_{EI} \\right) = - \\frac{g_{E} w_{EI}}{\\tau_{E}}$.\n\n$J_{21} = \\frac{\\partial F_{I}}{\\partial E} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{I}} \\left[ \\frac{\\partial}{\\partial E} S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\nUsing the chain rule, $\\frac{\\partial S_{I}}{\\partial E} = S_{I}' \\cdot w_{IE}$. At the equilibrium, $S_{I}'(h_{I}^{*}) = g_{I}$.\nThus, $J_{21} = \\frac{g_{I} w_{IE}}{\\tau_{I}}$.\n\n$J_{22} = \\frac{\\partial F_{I}}{\\partial I} \\bigg|_{(E^{*},I^{*})} = \\frac{1}{\\tau_{I}} \\left[ -1 + \\frac{\\partial}{\\partial I} S_{I}\\!\\left(w_{IE} E - w_{II} I + P_{I}\\right) \\right] \\bigg|_{(E^{*},I^{*})}$\nUsing the chain rule, $\\frac{\\partial S_{I}}{\\partial I} = S_{I}' \\cdot (-w_{II})$.\nThus, $J_{22} = \\frac{1}{\\tau_{I}} \\left( -1 - g_{I} w_{II} \\right) = - \\frac{g_{I} w_{II} + 1}{\\tau_{I}}$.\n\nCombining these components, the Jacobian matrix at the equilibrium $(E^{*}, I^{*})$ is:\n$$\nJ = \\begin{pmatrix} \\frac{g_{E} w_{EE} - 1}{\\tau_{E}} & -\\frac{g_{E} w_{EI}}{\\tau_{E}} \\\\ \\frac{g_{I} w_{IE}}{\\tau_{I}} & -\\frac{g_{I} w_{II} + 1}{\\tau_{I}} \\end{pmatrix}\n$$\n\n**2. Derivation of the Hopf Bifurcation Condition**\nA Hopf bifurcation marks the transition from a stable fixed point to a limit cycle oscillation. This occurs when the eigenvalues of the Jacobian, which are initially in the left half of the complex plane (real part negative), cross the imaginary axis. For a two-dimensional system, this requires the eigenvalues to be a pair of purely imaginary complex conjugates, $\\lambda = \\pm i \\omega_{0}$ with $\\omega_{0} \\in \\mathbb{R}^{+}$. The characteristic equation is $\\lambda^2 - \\mathrm{Tr}(J) \\lambda + \\mathrm{Det}(J) = 0$. The conditions for a Hopf bifurcation are:\n1. $\\mathrm{Tr}(J) = 0$\n2. $\\mathrm{Det}(J) > 0$\n\nThe trace of the Jacobian is the sum of its diagonal elements:\n$$\n\\mathrm{Tr}(J) = J_{11} + J_{22} = \\frac{g_{E} w_{EE} - 1}{\\tau_{E}} - \\frac{g_{I} w_{II} + 1}{\\tau_{I}}\n$$\nSetting the trace to zero gives the condition for the critical excitatory gain, $g_{E}^{\\mathrm{crit}}$:\n$$\n\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} - \\frac{g_{I} w_{II} + 1}{\\tau_{I}} = 0\n$$\n$$\n\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} = \\frac{g_{I} w_{II} + 1}{\\tau_{I}}\n$$\nSolving for $g_{E}^{\\mathrm{crit}}$:\n$$\n\\tau_{I} (g_{E}^{\\mathrm{crit}} w_{EE} - 1) = \\tau_{E} (g_{I} w_{II} + 1)\n$$\n$$\ng_{E}^{\\mathrm{crit}} w_{EE} \\tau_{I} - \\tau_{I} = \\tau_{E} g_{I} w_{II} + \\tau_{E}\n$$\n$$\ng_{E}^{\\mathrm{crit}} w_{EE} \\tau_{I} = \\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}\n$$\nThis yields the closed-form expression for the critical gain:\n$$\ng_{E}^{\\mathrm{crit}} = \\frac{\\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}}{w_{EE} \\tau_{I}}\n$$\nThe problem states the initial equilibrium is stable, meaning $\\mathrm{Tr}(J) < 0$. Since $w_{EE} > 0$ (excitatory self-connection), $\\mathrm{Tr}(J)$ is an increasing function of $g_{E}$. As $g_{E}$ increases past $g_{E}^{\\mathrm{crit}}$, $\\mathrm{Tr}(J)$ becomes positive, leading to instability, which is consistent with the problem setup.\n\nThe determinant of the Jacobian is:\n$$\n\\mathrm{Det}(J) = J_{11} J_{22} - J_{12} J_{21} = \\left(\\frac{g_{E} w_{EE} - 1}{\\tau_{E}}\\right) \\left(-\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right) - \\left(-\\frac{g_{E} w_{EI}}{\\tau_{E}}\\right) \\left(\\frac{g_{I} w_{IE}}{\\tau_{I}}\\right)\n$$\n$$\n\\mathrm{Det}(J) = \\frac{-(g_{E} w_{EE} - 1)(g_{I} w_{II} + 1) + g_{E} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}}\n$$\nAt the bifurcation point, $\\lambda = \\pm i \\omega_{0}$, where the onset frequency of oscillation $\\omega_{0}$ is given by $\\omega_{0}^{2} = \\mathrm{Det}(J)|_{g_{E}=g_{E}^{\\mathrm{crit}}}$. Using the trace condition $\\frac{g_{E}^{\\mathrm{crit}} w_{EE} - 1}{\\tau_{E}} = \\frac{g_{I} w_{II} + 1}{\\tau_{I}}$, we can express the determinant as:\n$$\n\\mathrm{Det}(J)|_{\\mathrm{crit}} = -\\left(\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right)^2 + \\frac{g_{E}^{\\mathrm{crit}} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}}\n$$\nThe condition $\\mathrm{Det}(J) > 0$ ensures a non-zero frequency. For a PING mechanism, this is satisfied by the circuit structure ($w_{EI}, w_{IE} > 0$). The onset frequency is thus:\n$$\n\\omega_0 = \\sqrt{\\frac{g_{E}^{\\mathrm{crit}} g_{I} w_{EI} w_{IE}}{\\tau_{E} \\tau_{I}} - \\left(\\frac{g_{I} w_{II} + 1}{\\tau_{I}}\\right)^{2}}\n$$\n\n**3. Limit Cycle Amplitude Scaling**\nThe problem specifies a supercritical Hopf bifurcation. According to the theory of normal forms for such bifurcations, the amplitude of the emergent limit cycle scales with the square root of the distance from the bifurcation point. Let the bifurcation parameter be $\\mu = g_{E}(D) - g_{E}^{\\mathrm{crit}}$. The system is stable for $\\mu < 0$ and exhibits oscillations for $\\mu > 0$.\n\nThe normal form equation for the amplitude $r$ of the oscillation near the bifurcation is:\n$$\n\\frac{dr}{dt} = \\alpha \\mu r - \\beta r^3 + O(r^5)\n$$\nwhere $\\alpha > 0$ and, for a supercritical bifurcation, $\\beta > 0$. The assumption that the third derivative of the sigmoid functions is negative ($S''' < 0$) is a sufficient condition to ensure $\\beta > 0$.\nThe steady-state amplitude of the limit cycle is found by setting $\\frac{dr}{dt} = 0$:\n$$\nr(\\alpha \\mu - \\beta r^2) = 0\n$$\nThis gives a non-trivial stable solution for $r>0$ when $\\mu>0$:\n$$\nr = \\sqrt{\\frac{\\alpha}{\\beta}} \\sqrt{\\mu}\n$$\nThe amplitude of oscillations in the state variables $E(t)$ and $I(t)$ is directly proportional to this normal form amplitude $r$. Therefore, the peak-to-trough amplitude of the limit cycle in the $(E,I)$ phase plane, let's call it $A$, has the leading-order dependence:\n$$\nA \\propto \\sqrt{g_{E}(D) - g_{E}^{\\mathrm{crit}}}\n$$\nThis relationship shows that as dopamine $D$ increases the gain $g_{E}(D)$ just above the critical threshold $g_{E}^{\\mathrm{crit}}$, rhythmogenesis begins with an oscillation whose amplitude grows smoothly from zero.",
            "answer": "$$\n\\boxed{\\frac{\\tau_{E} + \\tau_{I} + \\tau_{E} g_{I} w_{II}}{w_{EE} \\tau_{I}}}\n$$"
        },
        {
            "introduction": "Brain rhythms do not operate in isolation; their ability to flexibly synchronize with other inputs is key to their computational role. This final hands-on practice addresses the crucial concept of entrainment, where the PING rhythm is controlled by an external periodic drive. You will simulate a canonical model for an oscillator near a Hopf bifurcation—the Stuart-Landau equation—to determine the conditions under which it phase-locks to the external signal. By mapping out the \"Arnold tongue\", you will quantify the entrainment bandwidth as a function of the drive's amplitude, providing insight into how PING oscillations can participate in network-wide communication by synchronizing with other rhythmic activities .",
            "id": "4011975",
            "problem": "You are asked to quantify phase locking in a reduced model of Pyramidal-Interneuron Gamma (PING) oscillations under external periodic modulation of the excitatory input, and to compute the Arnold tongue (the region of amplitude and frequency where entrainment occurs). The goal is to determine the entrainment bandwidth as a function of modulation amplitude. The problem focuses on a mathematically principled approach grounded in the reduction of the coupled excitatory-inhibitory population dynamics near a Hopf bifurcation to a canonical oscillatory normal form. Pyramidal-Interneuron Gamma (PING) refers to gamma-band oscillations generated by the interplay of excitatory pyramidal cells and inhibitory interneurons. Near an oscillatory regime, the macroscopic dynamics of a coupled excitatory-inhibitory system such as the Wilson-Cowan population model can be reduced via center manifold theory and normal form analysis to an amplitude-phase oscillator described by the Stuart-Landau normal form. External periodic modulation of the excitatory input translates, at leading order, to a periodic forcing of the real component of the oscillator state. The Arnold tongue is defined as the set of forcing amplitudes and frequencies for which $1{:}1$ phase locking (entrainment) occurs.\n\nImplement a simulation of the canonical Stuart-Landau oscillator with additive sinusoidal forcing applied to the real component (representing excitatory drive modulation), and determine phase locking by analyzing the phase difference between the oscillator and the external drive. Use the following ordinary differential equations (ODEs), which are a canonical normal form for an oscillatory mode near a Hopf bifurcation:\n$$\n\\frac{dx}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,x - \\omega_0\\,y + A\\,\\cos\\left(2\\pi f_{\\mathrm{ext}} t\\right),\n$$\n$$\n\\frac{dy}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,y + \\omega_0\\,x,\n$$\nwhere $z = x + i\\,y$ is the complex oscillator state, $\\lambda > 0$ controls the amplitude of the self-sustained oscillation, $c > 0$ determines the nonlinear saturation, $\\omega_0 = 2\\pi f_0$ is the natural angular frequency of the unforced oscillator, $A$ is the forcing amplitude, and $f_{\\mathrm{ext}}$ is the external forcing frequency.\n\nScientific base and assumptions:\n- Near an oscillatory regime, the coupled excitatory-inhibitory Wilson-Cowan dynamics admit a reduction to the Stuart-Landau normal form on the center manifold around a Hopf bifurcation, with an external periodic modulation of the excitatory input projected primarily onto the real component of the reduced mode.\n- The Arnold tongue for $1{:}1$ locking is defined by the parameter region in the $(A, f_{\\mathrm{ext}})$ plane for which the oscillator's phase difference relative to the drive is bounded and asymptotically constant.\n\nImplementation details:\n- Use parameters $\\lambda = 1.0$ (dimensionless), $c = 1.0$ (dimensionless), $f_0 = 40\\,\\mathrm{Hz}$ (so $\\omega_0 = 2\\pi \\cdot 40\\,\\mathrm{rad/s}$).\n- Simulate with total time $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$, time step $dt = 0.0005\\,\\mathrm{s}$, and initial condition $x(0) = \\sqrt{\\lambda/c}$, $y(0) = 0$.\n- For each forcing amplitude $A$, scan forcing frequencies $f_{\\mathrm{ext}}$ over $[20\\,\\mathrm{Hz}, 60\\,\\mathrm{Hz}]$ in steps of $1\\,\\mathrm{Hz}$.\n- Determine $1{:}1$ phase locking as follows. Compute the instantaneous oscillator phase $\\phi(t) = \\mathrm{unwrap}(\\arctan2(y(t),x(t)))$ in radians. Define the phase difference $\\psi(t) = \\phi(t) - 2\\pi f_{\\mathrm{ext}} t$, using radians for angles. Over the final $1.5\\,\\mathrm{s}$ of the simulation (i.e., after discarding the first half of the time series as transient), compute $d\\psi/dt$ by numerical differentiation. Declare phase locking if the mean absolute value of $d\\psi/dt$ is less than $1.0\\,\\mathrm{rad/s}$ and the standard deviation of $d\\psi/dt$ is less than $2.0\\,\\mathrm{rad/s}$.\n- For each $A$, the entrainment bandwidth is defined as the span in $f_{\\mathrm{ext}}$ (in $\\mathrm{Hz}$) for which locking is detected, specifically $\\max(f_{\\mathrm{ext}})$ minus $\\min(f_{\\mathrm{ext}})$ over the set of locked frequencies. If no frequencies lock, the bandwidth is $0.0$. For $A = 0.0$, report a bandwidth of $0.0$ by definition.\n- Express all frequencies in $\\mathrm{Hz}$ and angles in radians. The output bandwidths must be floats in $\\mathrm{Hz}$.\n\nTest suite:\n- Use forcing amplitudes $A \\in \\{0.0, 0.02, 0.05, 0.10, 0.20\\}$ (dimensionless).\n- For each $A$, scan $f_{\\mathrm{ext}} \\in \\{20, 21, \\dots, 60\\}\\,\\mathrm{Hz}$.\n- The final output must be a single line containing the entrainment bandwidths for the amplitudes listed above as a comma-separated list enclosed in square brackets, for example, $[b_1,b_2,b_3,b_4,b_5]$, where each $b_k$ is a float in $\\mathrm{Hz}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[b_1,b_2,b_3,b_4,b_5]$). No other output is permitted.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the established theory of dynamical systems and computational neuroscience, specifically using the Stuart-Landau equation as a normal form for a Hopf bifurcation, which is a standard model for neural oscillations like the Pyramidal-Interneuron Gamma (PING) mechanism. The problem is well-posed, providing a complete set of ordinary differential equations (ODEs), parameters, initial conditions, and a clear, objective procedure for determining the solution. The terminology is precise, and the setup is free of contradictions or ambiguities.\n\nThe task is to determine the entrainment bandwidth of a forced Stuart-Landau oscillator, which serves as a canonical model for periodically driven neural population dynamics near an oscillatory instability. The entrainment bandwidth is the range of forcing frequencies for which the oscillator phase-locks to the external drive. This region in the parameter space of forcing amplitude and frequency is known as the Arnold tongue.\n\nThe governing equations are:\n$$\n\\frac{dx}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,x - \\omega_0\\,y + A\\,\\cos\\left(2\\pi f_{\\mathrm{ext}} t\\right)\n$$\n$$\n\\frac{dy}{dt} = \\left(\\lambda - c\\,(x^2+y^2)\\right)\\,y + \\omega_0\\,x\n$$\nHere, the state of the oscillator is given by the coordinates $(x(t), y(t))$. The term $(\\lambda - c\\,(x^2+y^2))$ governs the amplitude dynamics, where $\\lambda > 0$ provides the energy for self-oscillation and $c > 0$ provides nonlinear saturation, leading to a stable limit cycle with radius $r = \\sqrt{x^2+y^2} = \\sqrt{\\lambda/c}$. The term with $\\omega_0 = 2\\pi f_0$ generates the intrinsic oscillation at a natural frequency $f_0$. The external drive is a sinusoidal forcing of amplitude $A$ and frequency $f_{\\mathrm{ext}}$ applied to the $x$-component, modeling a periodic modulation of the excitatory population's input.\n\nThe solution methodology involves numerically simulating these ODEs for a grid of parameters $(A, f_{\\mathrm{ext}})$ and analyzing the resulting time series to detect phase locking. The overall procedure is as follows:\n\n1.  **Numerical Integration**: The system of ODEs is solved numerically. Given the problem's specified small time step $dt = 0.0005\\,\\mathrm{s}$ and the nature of the dynamics, a first-order Forward Euler integration scheme is sufficient and computationally efficient. For each time step, the state $(x_{i+1}, y_{i+1})$ is updated based on the state $(x_i, y_i)$ and the derivatives calculated at time $t_i$:\n    $$ x_{i+1} = x_i + \\left[ (\\lambda - c(x_i^2+y_i^2))x_i - \\omega_0 y_i + A\\cos(2\\pi f_{\\mathrm{ext}} t_i) \\right] dt $$\n    $$ y_{i+1} = y_i + \\left[ (\\lambda - c(x_i^2+y_i^2))y_i + \\omega_0 x_i \\right] dt $$\n    The simulation is run for a total time $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$ for each parameter set, starting from the initial condition $x(0) = \\sqrt{\\lambda/c} = 1.0$ and $y(0) = 0.0$, which places the system on its unforced limit cycle.\n\n2.  **Phase Locking Analysis**: Phase locking, or entrainment, occurs when the oscillator's frequency synchronizes with the external drive. This is mathematically equivalent to the phase difference between the oscillator and the drive becoming constant asymptotically. The analysis proceeds as follows for each simulation:\n    - The instantaneous phase of the oscillator is computed from the Cartesian coordinates: $\\phi(t) = \\mathrm{unwrap}(\\arctan2(y(t),x(t)))$. The `unwrap` function is necessary to correct for jumps of $2\\pi$ and obtain a continuous phase variable.\n    - The phase of the external drive is $\\phi_{\\mathrm{ext}}(t) = 2\\pi f_{\\mathrm{ext}} t$.\n    - The phase difference is defined as $\\psi(t) = \\phi(t) - \\phi_{\\mathrm{ext}}(t)$.\n    - The system is considered phase-locked if the rate of change of this phase difference, $d\\psi/dt$, approaches zero. To assess this, we analyze the latter half of the simulation ($t \\in [1.5, 3.0]\\,\\mathrm{s}$) to discard initial transients.\n    - The time derivative $d\\psi/dt$ is computed numerically using finite differences.\n    - According to the problem's specific criteria, locking is declared if the mean of the absolute value of the derivative, $\\langle |d\\psi/dt| \\rangle$, is less than $1.0\\,\\mathrm{rad/s}$, and the standard deviation of the derivative, $\\sigma(d\\psi/dt)$, is less than $2.0\\,\\mathrm{rad/s}$. These thresholds ensure that the phase difference is not drifting on average and its fluctuations are small.\n\n3.  **Entrainment Bandwidth Calculation**: The core of the problem is to determine the entrainment bandwidth for each tested forcing amplitude $A$.\n    - For a given $A$, the simulation and phase-locking analysis are repeated for each forcing frequency $f_{\\mathrm{ext}}$ in the range $[20, 60]\\,\\mathrm{Hz}$ with a step of $1\\,\\mathrm{Hz}$.\n    - This generates a set of frequencies for which the system is phase-locked.\n    - The entrainment bandwidth is then calculated as the span of this set: $\\max(f_{\\mathrm{locked}}) - \\min(f_{\\mathrm{locked}})$.\n    - If no frequencies in the scanned range result in locking, the bandwidth is $0.0\\,\\mathrm{Hz}$. By definition, for the unforced case ($A=0.0$), the bandwidth is also $0.0\\,\\mathrm{Hz}$.\n\nThis systematic approach allows us to map out the width of the $1{:}1$ Arnold tongue for the given model parameters and forcing amplitudes. The final output is a list of these bandwidths.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_and_check_locking(A, f_ext, params):\n    \"\"\"\n    Simulates the Stuart-Landau oscillator and checks for phase locking.\n\n    Args:\n        A (float): Forcing amplitude.\n        f_ext (float): Forcing frequency in Hz.\n        params (tuple): A tuple containing model and simulation parameters.\n\n    Returns:\n        bool: True if phase-locked, False otherwise.\n    \"\"\"\n    lambda_val, c_val, f0, T_total, dt = params\n    omega0 = 2.0 * np.pi * f0\n\n    # Simulation setup\n    num_steps = int(T_total / dt)\n    t = np.linspace(0, T_total, num_steps + 1)\n    x = np.zeros(num_steps + 1)\n    y = np.zeros(num_steps + 1)\n\n    # Initial conditions\n    x[0] = np.sqrt(lambda_val / c_val)\n    y[0] = 0.0\n\n    # Forward Euler integration\n    for i in range(num_steps):\n        x_i, y_i, t_i = x[i], y[i], t[i]\n        r_squared = x_i**2 + y_i**2\n        \n        dx = (lambda_val - c_val * r_squared) * x_i - omega0 * y_i + A * np.cos(2 * np.pi * f_ext * t_i)\n        dy = (lambda_val - c_val * r_squared) * y_i + omega0 * x_i\n        \n        x[i+1] = x_i + dx * dt\n        y[i+1] = y_i + dy * dt\n\n    # Analysis of the second half of the simulation\n    analysis_start_index = int((T_total / 2.0) / dt)\n    \n    y_analysis = y[analysis_start_index:]\n    x_analysis = x[analysis_start_index:]\n    t_analysis = t[analysis_start_index:]\n\n    # Phase calculation\n    osc_phase = np.unwrap(np.arctan2(y_analysis, x_analysis))\n    drive_phase = 2.0 * np.pi * f_ext * t_analysis\n    phase_diff = osc_phase - drive_phase\n    \n    # Derivative of phase difference using finite differences\n    if len(phase_diff)  2:\n        return False\n    d_phase_diff_dt = np.diff(phase_diff) / dt\n    \n    # Locking criteria\n    mean_abs_d_psi_dt = np.mean(np.abs(d_phase_diff_dt))\n    std_d_psi_dt = np.std(d_phase_diff_dt)\n    \n    is_locked = mean_abs_d_psi_dt  1.0 and std_d_psi_dt  2.0\n    \n    return is_locked\n\ndef solve():\n    \"\"\"\n    Calculates the entrainment bandwidth for a range of forcing amplitudes.\n    \"\"\"\n    # Define model and simulation parameters from the problem statement.\n    params = {\n        'lambda_val': 1.0,\n        'c_val': 1.0,\n        'f0': 40.0,  # Hz\n        'T_total': 3.0,  # s\n        'dt': 0.0005,  # s\n    }\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0, 0.02, 0.05, 0.10, 0.20\n    ]\n\n    f_ext_scan_range = np.arange(20, 61, 1)  # Frequencies from 20 Hz to 60 Hz in 1 Hz steps.\n    \n    param_tuple = (params['lambda_val'], params['c_val'], params['f0'], params['T_total'], params['dt'])\n\n    bandwidth_results = []\n    \n    for A in test_cases:\n        # Per problem spec, bandwidth is 0.0 for A = 0.0\n        if A == 0.0:\n            bandwidth_results.append(0.0)\n            continue\n            \n        locked_frequencies = []\n        for f_ext in f_ext_scan_range:\n            if simulate_and_check_locking(A, float(f_ext), param_tuple):\n                locked_frequencies.append(f_ext)\n        \n        if not locked_frequencies:\n            bandwidth = 0.0\n        else:\n            # Bandwidth is the span of locked frequencies\n            bandwidth = float(max(locked_frequencies) - min(locked_frequencies))\n            \n        bandwidth_results.append(bandwidth)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, bandwidth_results))}]\")\n\nsolve()\n```"
        }
    ]
}