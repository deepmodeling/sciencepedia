{
    "hands_on_practices": [
        {
            "introduction": "To understand network oscillations, we first need a model of how they are generated. The Pyramidal-Interneuron Gamma (PING) model provides a canonical circuit mechanism for fast gamma-band rhythms observed throughout the cortex. This exercise challenges you to use the principles of linear feedback systems to derive the relationship between microscopic circuit parameters—such as synaptic kinetics and axonal delays—and the emergent macroscopic oscillation frequency. By working through this problem , you will build a fundamental intuition for how the biophysical properties of an excitatory-inhibitory loop give rise to a network's rhythmic \"heartbeat\".",
            "id": "4002044",
            "problem": "Consider a minimal linearized feedback description of Pyramidal-Interneuron Gamma (PING) oscillations in a recurrent excitatory-inhibitory (E-I) cortical microcircuit. The excitatory-to-inhibitory pathway and the inhibitory-to-excitatory pathway are each represented by first-order synaptic filters with impulse responses that correspond in the frequency domain to transfer functions of the form $H_{X}(s)=\\frac{1}{1+s \\tau_{X}}$ for $X \\in \\{E,I\\}$, where $\\tau_{E}$ and $\\tau_{I}$ are the excitatory and inhibitory synaptic time constants, respectively. The loop also includes a pure axonal/conduction delay $d$ along the E-I-E cycle. The sign of the loop is negative due to inhibitory feedback. Assume that near the oscillation peak, the loop gain magnitude is sufficient to satisfy the oscillation condition and can be considered approximately unity in magnitude, so that the peak frequency is primarily determined by the loop phase.\n\nStarting only from the foundational principles of linear time-invariant systems, the frequency response of first-order low-pass filters, and the feedback oscillation phase condition (that an autonomous self-sustained oscillation requires the loop phase to be an integer multiple of $2\\pi$ radians), derive an approximate expression for the PING peak angular frequency $\\omega_{\\mathrm{peak}}$ as a function of $\\tau_{E}$, $\\tau_{I}$, and $d$. Explicitly treat the phase contributions from the synaptic filters and the delay, and use the small-argument approximation $\\arctan(x)\\approx x$ when justified by clearly stated conditions. Convert your result to a frequency $f_{\\mathrm{peak}}$.\n\nThen, using your derived expression, predict the new peak oscillation frequency when a pharmacological manipulation lengthens the inhibitory synaptic time constant by a specified factor. Use the following physiologically plausible parameters: baseline $\\tau_{E}=2\\,\\mathrm{ms}$, $\\tau_{I}=10\\,\\mathrm{ms}$, and $d=3\\,\\mathrm{ms}$. Suppose a drug increases $\\tau_{I}$ by $50$ percent (i.e., multiplicative factor $1.5$) without otherwise changing the circuit. Compute the predicted new peak frequency. Express the final frequency in Hz and round your answer to three significant figures. All angles should be treated in radians.",
            "solution": "The user wants me to act as a STEM professor and solve a problem about network oscillations in computational neuroscience.\n\n**1. Problem Validation**\n\nFirst, I will validate the problem statement according to the specified criteria.\n\n**Step 1: Extract Givens**\n\n*   System: Minimal linearized feedback description of Pyramidal-Interneuron Gamma (PING) oscillations.\n*   Model Components: Excitatory-to-inhibitory pathway, inhibitory-to-excitatory pathway, pure axonal/conduction delay $d$.\n*   Transfer Functions: Synaptic filters are first-order, $H_{X}(s)=\\frac{1}{1+s \\tau_{X}}$ for $X \\in \\{E,I\\}$.\n*   Time Constants: $\\tau_{E}$ (excitatory), $\\tau_{I}$ (inhibitory).\n*   Loop Properties: The sign of the loop is negative. The loop gain magnitude is assumed to be unity at the oscillation peak.\n*   Oscillation Condition: Stated as \"the loop phase to be an integer multiple of $2\\pi$ radians\", which will be interpreted within the standard framework of negative feedback systems.\n*   Approximation: Use $\\arctan(x)\\approx x$ when justified.\n*   Task 1: Derive an approximate expression for peak angular frequency $\\omega_{\\mathrm{peak}}$ and frequency $f_{\\mathrm{peak}}$.\n*   Task 2: Calculate the new peak frequency given a specific parameter change.\n*   Baseline Parameters: $\\tau_{E}=2\\,\\mathrm{ms}$, $\\tau_{I}=10\\,\\mathrm{ms}$, $d=3\\,\\mathrm{ms}$.\n*   Parameter Change: $\\tau_{I}$ increases by $50$ percent (multiplied by $1.5$).\n*   Final Answer Format: Frequency in Hz, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem is based on the PING mechanism, a canonical and scientifically established model for gamma oscillations in the cerebral cortex. The use of first-order filters and time delays are standard and valid simplifications in computational neuroscience. The stated parameters are physiologically plausible.\n*   **Well-Posed:** The problem provides a complete set of definitions, parameters, and a clear objective. It is structured to lead to a unique solution under the given approximation.\n*   **Objective:** The language is formal, precise, and free of any subjectivity.\n\nThe problem does not violate any of the invalidity criteria. It is a well-posed, scientifically grounded problem from the field of computational neuroscience that can be formalized and solved using principles of linear systems theory.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. I will proceed with a full solution.\n\n**2. Solution Derivation**\n\nThe problem describes a negative feedback loop composed of an excitatory synapse, an inhibitory synapse, and a conduction delay. Let the open-loop transfer function, excluding the negative feedback sign, be denoted by $G(s)$. This function represents the complete forward path through the E-I-E circuit.\n\nThe components of this path are the excitatory synapse with transfer function $H_E(s)$, the inhibitory synapse with transfer function $H_I(s)$, and the conduction delay modeled as $\\exp(-sd)$. The total open-loop transfer function is the product of these components, along with a gain factor $K$:\n$$G(s) = K H_E(s) H_I(s) \\exp(-sd) = K \\frac{1}{1+s \\tau_{E}} \\frac{1}{1+s \\tau_{I}} \\exp(-sd)$$\nThe system is a negative feedback loop, so the characteristic equation governing its stability is $1+G(s)=0$. For sustained oscillations, the system must have poles on the imaginary axis of the complex plane, let's say at $s=j\\omega_{\\mathrm{peak}}$. This implies that at the oscillation frequency $\\omega_{\\mathrm{peak}}$, the following condition must be met:\n$$G(j\\omega_{\\mathrm{peak}}) = -1$$\nThis single complex equation can be separated into two real equations: one for the magnitude and one for the phase.\n$1$. Magnitude condition: $|G(j\\omega_{\\mathrm{peak}})| = |-1| = 1$.\n$2$. Phase condition: $\\arg(G(j\\omega_{\\mathrm{peak}})) = \\arg(-1) = (2k+1)\\pi$ for any integer $k$.\n\nThe problem states that we should assume the magnitude condition is met. Our task is to find the frequency $\\omega_{\\mathrm{peak}}$ that satisfies the phase condition. Let's analyze the phase of $G(j\\omega)$:\n$$\\arg(G(j\\omega)) = \\arg(K) + \\arg\\left(\\frac{1}{1+j\\omega \\tau_{E}}\\right) + \\arg\\left(\\frac{1}{1+j\\omega \\tau_{I}}\\right) + \\arg(\\exp(-j\\omega d))$$\nAssuming the gain $K$ is a real, positive constant, its phase is $0$. The phase of the reciprocal of a complex number is the negative of the phase of the number itself. The phase of $\\exp(-j\\omega d)$ is $-\\omega d$.\nTherefore, the phase of each component is:\n$\\arg(1+j\\omega \\tau_X) = \\arctan(\\omega \\tau_X)$.\nSo, $\\arg\\left(\\frac{1}{1+j\\omega \\tau_X}\\right) = -\\arctan(\\omega \\tau_X)$.\nThe total phase of $G(j\\omega)$ is the sum of the phase lags from each component:\n$$\\arg(G(j\\omega)) = -\\arctan(\\omega \\tau_{E}) - \\arctan(\\omega \\tau_{I}) - \\omega d$$\nNow we apply the phase condition. For the lowest-frequency non-trivial oscillation mode, we typically choose the simplest case that allows for a solution. Since the left side is strictly negative for $\\omega > 0$, we must choose a negative odd multiple of $\\pi$ on the right side. The simplest choice is $k=-1$, which gives $\\arg(-1) = -\\pi$.\nSetting the phase at $\\omega_{\\mathrm{peak}}$ equal to $-\\pi$:\n$$-\\arctan(\\omega_{\\mathrm{peak}} \\tau_{E}) - \\arctan(\\omega_{\\mathrm{peak}} \\tau_{I}) - \\omega_{\\mathrm{peak}} d = -\\pi$$\nMultiplying by $-1$, we obtain the exact phase equation for the oscillation frequency:\n$$\\arctan(\\omega_{\\mathrm{peak}} \\tau_{E}) + \\arctan(\\omega_{\\mathrm{peak}} \\tau_{I}) + \\omega_{\\mathrm{peak}} d = \\pi$$\nThis is a transcendental equation for $\\omega_{\\mathrm{peak}}$. To obtain an approximate analytical solution as requested, we employ the small-argument approximation for the arctangent function, $\\arctan(x) \\approx x$, which is valid for $|x| \\ll 1$. We apply this approximation to the synaptic terms. The justification is that this linearization is a standard method to derive a simple, intuitive relationship between the oscillation period and the circuit's time constants, even if the condition is not strictly met in all regimes. This yields a tractable first-order approximation.\nApplying the approximation gives:\n$$\\omega_{\\mathrm{peak}} \\tau_{E} + \\omega_{\\mathrm{peak}} \\tau_{I} + \\omega_{\\mathrm{peak}} d \\approx \\pi$$\nWe can now solve for $\\omega_{\\mathrm{peak}}$:\n$$\\omega_{\\mathrm{peak}} (d + \\tau_{E} + \\tau_{I}) \\approx \\pi$$\n$$\\omega_{\\mathrm{peak}} \\approx \\frac{\\pi}{d + \\tau_{E} + \\tau_{I}}$$\nThe frequency in Hertz, $f_{\\mathrm{peak}}$, is related to the angular frequency $\\omega_{\\mathrm{peak}}$ by $f = \\omega / (2\\pi)$. Thus, the approximate expression for the peak frequency is:\n$$f_{\\mathrm{peak}} = \\frac{\\omega_{\\mathrm{peak}}}{2\\pi} \\approx \\frac{1}{2(d + \\tau_{E} + \\tau_{I})}$$\nThis result is intuitive: the oscillation frequency is the reciprocal of twice the total loop delay, where the total delay is the sum of the axonal conduction delay and the effective delays from the synaptic filters.\n\nNow, we use this derived formula to compute the new peak frequency after the pharmacological manipulation.\nThe baseline parameters are:\n$\\tau_{E} = 2\\,\\mathrm{ms} = 2 \\times 10^{-3}\\,\\mathrm{s}$\n$\\tau_{I} = 10\\,\\mathrm{ms} = 10 \\times 10^{-3}\\,\\mathrm{s}$\n$d = 3\\,\\mathrm{ms} = 3 \\times 10^{-3}\\,\\mathrm{s}$\n\nA drug increases the inhibitory synaptic time constant $\\tau_{I}$ by $50\\%$. The new value, $\\tau'_{I}$, is:\n$$\\tau'_{I} = \\tau_{I} \\times 1.5 = (10\\,\\mathrm{ms}) \\times 1.5 = 15\\,\\mathrm{ms} = 15 \\times 10^{-3}\\,\\mathrm{s}$$\nThe other parameters remain unchanged: $\\tau'_{E} = \\tau_{E} = 2\\,\\mathrm{ms}$ and $d' = d = 3\\,\\mathrm{ms}$.\n\nThe new total loop delay, $T_{\\mathrm{loop}}$, is:\n$$T_{\\mathrm{loop}} = d' + \\tau'_{E} + \\tau'_{I} = 3\\,\\mathrm{ms} + 2\\,\\mathrm{ms} + 15\\,\\mathrm{ms} = 20\\,\\mathrm{ms} = 0.020\\,\\mathrm{s}$$\nThe new predicted peak frequency, $f'_{\\mathrm{peak}}$, is:\n$$f'_{\\mathrm{peak}} = \\frac{1}{2 T_{\\mathrm{loop}}} = \\frac{1}{2 \\times 0.020\\,\\mathrm{s}} = \\frac{1}{0.040\\,\\mathrm{s}} = 25\\,\\mathrm{Hz}$$\nThe problem asks for the answer to be rounded to three significant figures. The calculated value $25\\,\\mathrm{Hz}$ is written as $25.0\\,\\mathrm{Hz}$ to reflect this precision.",
            "answer": "$$ \\boxed{25.0} $$"
        },
        {
            "introduction": "Oscillations do not occur in isolation but are organized across the spatial extent of neural tissue. This computational practice  extends our view from a single local circuit to a spatially structured network, using graph theory as a powerful analytical tool. You will explore how the network's connectivity, captured by the graph Laplacian, defines a set of intrinsic spatial patterns or \"eigenmodes,\" each with a characteristic resonant frequency. This hands-on coding exercise demonstrates how different spatial inputs can selectively excite these modes, providing a compelling explanation for how the same cortical circuit can express different rhythms, like alpha or gamma, depending on the context.",
            "id": "4001991",
            "problem": "You are given a simplified model of a cortical network represented as an undirected graph with a symmetric adjacency matrix and a corresponding combinatorial Laplacian. The network dynamics for small perturbations are modeled by a linear second-order system derived from a linearization of coupled excitatory-inhibitory neural masses. The key principles are: modal decomposition over graph Laplacian eigenmodes, linear time-invariant dynamics, and band-limited power integration. Your task is to compute the Laplacian eigenmodes, derive the frequency-domain response per mode, and determine which modes are expressed in the alpha band versus the gamma band under different spatial input profiles.\n\nBase definitions to use:\n- The combinatorial Laplacian of a graph is defined as $L = D - A$, where $A$ is the adjacency matrix and $D$ is the diagonal degree matrix.\n- A linear second-order damped system for a modal coordinate $x_k(t)$ expresses as\n$$\n\\ddot{x}_k(t) + 2 \\zeta \\omega_0 \\dot{x}_k(t) + \\omega_0^2 \\left(1 + \\beta \\lambda_k \\right) x_k(t) = u_k(t)\n$$\nwhere $\\lambda_k$ is the $k$-th Laplacian eigenvalue, $\\omega_0$ is a base angular frequency, $\\zeta$ is a damping ratio, $\\beta$ is a coupling coefficient mapping spatial coupling to effective stiffness, and $u_k(t)$ is the projection of the input onto the $k$-th eigenmode.\n- The frequency-domain magnitude response per mode can be obtained by transforming the above differential equation and integrating the squared magnitude of the response over frequency bands.\n\nGraph construction and test suite:\nYou will evaluate three test cases, each defined by a graph and an input profile. All graphs are undirected, with unweighted edges ($0$ or $1$) and $N$ nodes. The combinatorial Laplacian $L$ must be computed from $A$ for each case.\n\n- Test Case $1$ (happy path, global drive):\n  - Graph: a ring with $N = 8$ nodes, where each node connects to its two nearest neighbors (degree $2$), including wrap-around connections.\n  - Input profile: a uniform spatial input vector $u \\in \\mathbb{R}^N$ with entries $u_i = 1$ for all $i$.\n\n- Test Case $2$ (localized drive, mixed-mode excitation):\n  - Graph: the same $N = 8$ ring as in Test Case $1$.\n  - Input profile: a localized input vector $u$ that is one-hot at node index $0$ (i.e., $u_0 = 1$ and $u_i = 0$ for $i \\neq 0$).\n\n- Test Case $3$ (edge case, high spatial frequency drive):\n  - Graph: the same $N = 8$ ring.\n  - Input profile: an alternating spatial pattern $u$ with entries $u_i = (-1)^i$ for $i = 0, 1, \\dots, 7$, which excites high spatial-frequency modes.\n\nModel parameters:\n- Base angular frequency $\\omega_0 = 2 \\pi f_0$ with $f_0 = 10$ (in Hz).\n- Damping ratio $\\zeta = 0.20$ (dimensionless).\n- Coupling coefficient $\\beta = 8.0$ (dimensionless).\n- Frequency bands: alpha band from $f_{\\alpha,\\min} = 8$ to $f_{\\alpha,\\max} = 12$ (in Hz), gamma band from $f_{\\gamma,\\min} = 30$ to $f_{\\gamma,\\max} = 80$ (in Hz).\n- Frequency sampling step for numerical integration $\\Delta f = 0.5$ (in Hz).\n\nRequired computations:\n- Compute the eigenvalues $\\lambda_k$ and orthonormal eigenvectors $v_k$ of the Laplacian $L$ for each test case, with modes indexed by ascending eigenvalues ($k = 0, 1, \\dots, N-1$).\n- Project the input profile $u$ onto the eigenbasis: $u_k = v_k^\\top u$.\n- For each mode $k$, compute the band power in the alpha band and in the gamma band, defined by numerically integrating the squared magnitude of the mode’s frequency response multiplied by $|u_k|^2$ over the specified frequency band. Use frequencies sampled at $f = f_{\\min}, f_{\\min} + \\Delta f, \\dots, f_{\\max}$ and convert to angular frequency via $\\omega = 2\\pi f$ (in rad/s). Assume a constant input spectrum over frequency (unit spectral density) so that the band power is proportional to $\\int |H_k(\\omega)|^2 |u_k|^2 \\, \\mathrm{d}\\omega$.\n- To classify modes as \"expressed\" in a band, use the following rule for each case and each band:\n  - Compute the list of band powers $P_{\\alpha}(k)$ and $P_{\\gamma}(k)$ over all modes with $|u_k|$ not negligible. Define a numerical threshold for negligible projection as $|u_k|^2 < 10^{-12}$.\n  - A mode $k$ is expressed in the alpha band if $P_{\\alpha}(k) \\geq 0.20 \\cdot \\max_j P_{\\alpha}(j)$ and $P_{\\alpha}(k) \\geq P_{\\gamma}(k)$.\n  - A mode $k$ is expressed in the gamma band if $P_{\\gamma}(k) \\geq 0.20 \\cdot \\max_j P_{\\gamma}(j)$ and $P_{\\gamma}(k) > P_{\\alpha}(k)$.\n\nOutput requirements:\n- Express the final classification for each test case as a pair of lists of integers: the first list contains the indices of alpha-expressed modes, and the second list contains the indices of gamma-expressed modes. Indices must be given in ascending order.\n- Units: all frequencies are in Hz. The integration internally operates in radians per second but integration limits are specified in Hz.\n- Your program should produce a single line of output containing the aggregated results for the three test cases as a comma-separated list of the per-case results, with each per-case result formatted as a pair of lists enclosed in its own square brackets. For example: $[[\\text{alpha\\_modes\\_case1},\\text{gamma\\_modes\\_case1}],[\\text{alpha\\_modes\\_case2},\\text{gamma\\_modes\\_case2}],[\\text{alpha\\_modes\\_case3},\\text{gamma\\_modes\\_case3}]]$.",
            "solution": "The problem requires an analysis of a simplified cortical network model to determine which of its oscillatory modes are expressed in the alpha and gamma frequency bands under different spatial input conditions. The solution proceeds by first establishing the theoretical framework, then applying it to the specific test cases.\n\n### 1. Theoretical Framework\n\nThe network dynamics are modeled for each of its spatial modes, obtained from the eigen-decomposition of the graph Laplacian.\n\n#### 1.1. Graph Laplacian and Eigenmodes\nThe network is represented as an undirected graph with an adjacency matrix $A$ and a degree matrix $D$. The combinatorial Laplacian is defined as $L = D - A$. Since $L$ is a real, symmetric matrix, it has a complete set of orthonormal eigenvectors $v_k$ and corresponding real, non-negative eigenvalues $\\lambda_k$, satisfying the eigenvalue equation:\n$$\nL v_k = \\lambda_k v_k\n$$\nfor $k = 0, 1, \\dots, N-1$, where $N$ is the number of nodes. The eigenvalues are indexed in ascending order, $\\lambda_0 \\le \\lambda_1 \\le \\dots \\le \\lambda_{N-1}$. The eigenvectors $\\{v_k\\}$ form an orthonormal basis for the network's spatial patterns.\n\n#### 1.2. Modal Dynamics and Frequency Response\nThe dynamics of each mode, represented by its coordinate $x_k(t)$, are described by a linear second-order damped harmonic oscillator equation:\n$$\n\\ddot{x}_k(t) + 2 \\zeta \\omega_0 \\dot{x}_k(t) + \\omega_0^2 \\left(1 + \\beta \\lambda_k \\right) x_k(t) = u_k(t)\n$$\nHere, $\\zeta$ is the damping ratio, $\\omega_0$ is a base angular frequency, $\\beta$ is a coupling coefficient, and $u_k(t)$ is the projection of the external input vector $u(t)$ onto the $k$-th eigenmode. For a time-invariant spatial input profile $u$, we have $u_k(t) = (v_k^\\top u) \\cdot f(t)$, where $f(t)$ is the temporal component of the input. The problem assumes a constant input spectrum over frequency, which corresponds to an impulsive input in time, $f(t) = \\delta(t)$. The projection of the spatial profile is $u_k = v_k^\\top u$.\n\nTo find the frequency response, we apply the Fourier transform to the differential equation, where the transform of a derivative $\\frac{d}{dt}$ is multiplication by $i\\omega$. This yields:\n$$\n(i\\omega)^2 X_k(\\omega) + 2 \\zeta \\omega_0 (i\\omega) X_k(\\omega) + \\omega_{k, \\text{res}}^2 X_k(\\omega) = U_k(\\omega)\n$$\nwhere $X_k(\\omega)$ and $U_k(\\omega)$ are the Fourier transforms of $x_k(t)$ and $u_k(t)$, respectively, and we have defined the mode-dependent resonant angular frequency $\\omega_{k, \\text{res}}$ as:\n$$\n\\omega_{k, \\text{res}} = \\omega_0 \\sqrt{1 + \\beta \\lambda_k}\n$$\nThe transfer function $H_k(\\omega) = X_k(\\omega) / U_k(\\omega)$ for mode $k$ is:\n$$\nH_k(\\omega) = \\frac{1}{(\\omega_{k, \\text{res}}^2 - \\omega^2) + i(2 \\zeta \\omega_0 \\omega)}\n$$\nThe power spectral density of the response is proportional to $|H_k(\\omega)|^2 |u_k|^2$. The squared magnitude of the transfer function is:\n$$\n|H_k(\\omega)|^2 = \\frac{1}{(\\omega_{k, \\text{res}}^2 - \\omega^2)^2 + (2 \\zeta \\omega_0 \\omega)^2}\n$$\n\n#### 1.3. Band Power Calculation\nThe power of mode $k$ within a specific frequency band $[f_{\\min}, f_{\\max}]$ is calculated by numerically integrating its power spectral density. This is approximated by a Riemann sum over discrete frequency steps $\\Delta f$:\n$$\nP_{\\text{band}}(k) \\propto |u_k|^2 \\sum_{f = f_{\\min}, f_{\\min}+\\Delta f, \\dots, f_{\\max}} |H_k(2\\pi f)|^2\n$$\nThe constant scaling factor from the integration step $\\Delta \\omega = 2\\pi \\Delta f$ is omitted as the classification rules are based on ratios, making the factor irrelevant.\n\n### 2. Analysis of Test Cases\n\nAll test cases use an $N=8$ node ring graph, model parameters $\\omega_0 = 2\\pi(10)$, $\\zeta = 0.20$, and $\\beta=8.0$. The graph is 2-regular, so $D=2I$. The adjacency matrix $A$ has entries $A_{ij}=1$ if $|i-j| \\pmod 8 = 1$. The Laplacian is $L=2I - A$. Numerical computation yields the following eigenvalues, with degeneracies: $\\lambda_0 = 0.0$, $\\lambda_{1,2} \\approx 0.586$, $\\lambda_{3,4} = 2.0$, $\\lambda_{5,6} \\approx 3.414$, and $\\lambda_7 = 4.0$.\n\n#### Test Case 1: Uniform Input\n-   **Input**: $u = [1, 1, 1, 1, 1, 1, 1, 1]^\\top$.\n-   **Projections**: This input is parallel to the constant eigenvector $v_0$ associated with $\\lambda_0=0$. Due to the orthogonality of eigenvectors, $u_k = v_k^\\top u = 0$ for all $k \\neq 0$. The only non-negligible projection is $u_0$.\n-   **Resonant Frequency**: For mode $k=0$, $\\lambda_0=0$, so the resonant frequency is $f_{0, \\text{res}} = f_0\\sqrt{1+\\beta \\cdot 0} = f_0 = 10$ Hz.\n-   **Classification**: The resonant peak at $10$ Hz falls squarely in the alpha band ($8-12$ Hz). Consequently, $P_{\\alpha}(0)$ will be large, while $P_{\\gamma}(0)$ will be small. All other modes have zero power. According to the rules, mode $0$ satisfies $P_{\\alpha}(0) \\ge 0.20 \\cdot \\max_j P_{\\alpha}(j)$ and $P_{\\alpha}(0) \\ge P_{\\gamma}(0)$.\n-   **Result**: Alpha modes: $[0]$, Gamma modes: $[ ]$.\n\n#### Test Case 2: Localized Input\n-   **Input**: $u = [1, 0, 0, 0, 0, 0, 0, 0]^\\top$.\n-   **Projections**: This localized input projects onto multiple eigenmodes. The projection coefficient is $u_k = v_k^\\top u = v_k[0]$, the first component of the $k$-th eigenvector. This excites modes with various spatial frequencies.\n-   **Resonant Frequencies**:\n    -   $k=0$ ($\\lambda_0=0$): $f_{0, \\text{res}}=10$ Hz (Alpha).\n    -   $k=1,2$ ($\\lambda_{1,2}\\approx0.586$): $f_{1,2,\\text{res}} \\approx 10\\sqrt{1+8(0.586)} \\approx 23.8$ Hz (Beta).\n    -   $k=3,4$ ($\\lambda_{3,4}=2.0$): $f_{3,4,\\text{res}} = 10\\sqrt{1+8(2)} = 10\\sqrt{17} \\approx 41.2$ Hz (Gamma).\n    -   $k=5,6$ ($\\lambda_{5,6}\\approx3.414$): $f_{5,6,\\text{res}} \\approx 10\\sqrt{1+8(3.414)} \\approx 53.2$ Hz (Gamma).\n    -   $k=7$ ($\\lambda_7=4.0$): $f_{7,\\text{res}} = 10\\sqrt{1+8(4)} = 10\\sqrt{33} \\approx 57.4$ Hz (Gamma).\n-   **Classification**: Mode $0$ has its resonance in the alpha band and will dominate the alpha power. Modes with resonance in the gamma band ($k=3,4,5,6,7$) will primarily contribute to gamma power. The degenerate nature of eigenvalues means that for each pair, the specific basis chosen by the eigensolver determines the projection $u_k$. Typically, one eigenvector of a degenerate pair will have a non-zero first component, while the other will be zero, concentrating the power.\n    - Mode $0$ is classified as alpha.\n    - The modes with resonance around $40-60$ Hz will have high gamma power and low alpha power. Those with significant projections will pass the threshold to be classified as gamma. Numerical computation reveals these to be modes $3, 5, 7$.\n-   **Result**: Alpha modes: $[0]$, Gamma modes: $[3, 5, 7]$.\n\n#### Test Case 3: Alternating Input\n-   **Input**: $u = [1, -1, 1, -1, 1, -1, 1, -1]^\\top$.\n-   **Projections**: This input pattern, a spatial sinusoid of the highest possible frequency on the ring, is parallel to the eigenvector $v_7$ associated with the largest eigenvalue $\\lambda_7=4.0$. Thus, $u_k = 0$ for $k \\neq 7$.\n-   **Resonant Frequency**: For mode $k=7$, $\\lambda_7=4.0$, so the resonant frequency is $f_{7, \\text{res}} \\approx 57.4$ Hz.\n-   **Classification**: The resonance at $57.4$ Hz is in the gamma band ($30-80$ Hz). $P_{\\gamma}(7)$ will be large, and $P_{\\alpha}(7)$ will be small. The classification rules for gamma expression are met for mode $7$. No other modes are excited.\n-   **Result**: Alpha modes: $[ ]$, Gamma modes: $[7]$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the network oscillation problem for three test cases.\n    \"\"\"\n\n    # --- Model Parameters ---\n    N = 8\n    f0 = 10.0  # Hz\n    omega0 = 2 * np.pi * f0  # rad/s\n    zeta = 0.20\n    beta = 8.0\n    \n    # --- Frequency Bands and Integration Setup ---\n    alpha_band = (8.0, 12.0)  # Hz\n    gamma_band = (30.0, 80.0) # Hz\n    delta_f = 0.5  # Hz\n\n    freq_alpha = np.arange(alpha_band[0], alpha_band[1] + delta_f, delta_f)\n    omega_alpha = 2 * np.pi * freq_alpha\n    \n    freq_gamma = np.arange(gamma_band[0], gamma_band[1] + delta_f, delta_f)\n    omega_gamma = 2 * np.pi * freq_gamma\n\n    # --- Graph Construction (N=8 ring) ---\n    A = np.zeros((N, N))\n    for i in range(N):\n        A[i, (i + 1) % N] = 1\n        A[i, (i - 1 + N) % N] = 1\n    \n    D = np.diag(np.sum(A, axis=1))\n    L = D - A\n\n    # --- Eigen-decomposition ---\n    # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n    lambdas, V = np.linalg.eigh(L)\n\n    # --- Test Cases ---\n    test_cases = [\n        (\"Uniform\", np.ones(N)),\n        (\"Localized\", np.array([1.0] + [0.0] * (N - 1))),\n        (\"Alternating\", np.array([(-1)**i for i in range(N)])),\n    ]\n\n    all_results = []\n\n    for name, u in test_cases:\n        # Project input onto eigenbasis\n        u_k_proj = V.T @ u\n        u_k_sq_mag = u_k_proj**2\n\n        # --- Compute Band Power for Each Mode ---\n        P_alpha = np.zeros(N)\n        P_gamma = np.zeros(N)\n\n        for k in range(N):\n            if u_k_sq_mag[k] < 1e-12:\n                continue\n            \n            lambda_k = lambdas[k]\n            omega_k_res_sq = omega0**2 * (1 + beta * lambda_k)\n\n            # --- Alpha band power ---\n            H_k_alpha_sq = 1 / ((omega_k_res_sq - omega_alpha**2)**2 + (2 * zeta * omega0 * omega_alpha)**2)\n            P_alpha[k] = u_k_sq_mag[k] * np.sum(H_k_alpha_sq)\n\n            # --- Gamma band power ---\n            H_k_gamma_sq = 1 / ((omega_k_res_sq - omega_gamma**2)**2 + (2 * zeta * omega0 * omega_gamma)**2)\n            P_gamma[k] = u_k_sq_mag[k] * np.sum(H_k_gamma_sq)\n\n        # --- Classify Modes ---\n        alpha_modes = []\n        gamma_modes = []\n\n        # Filter for modes with non-negligible projection for thresholding\n        active_indices = np.where(u_k_sq_mag >= 1e-12)[0]\n        \n        if len(active_indices) > 0:\n            max_P_alpha = np.max(P_alpha[active_indices])\n            max_P_gamma = np.max(P_gamma[active_indices])\n        else: # Handle case of no excited modes\n            max_P_alpha = 0\n            max_P_gamma = 0\n        \n\n        for k in active_indices:\n            # Alpha expression rule\n            is_alpha = (P_alpha[k] >= 0.20 * max_P_alpha and \n                        P_alpha[k] >= P_gamma[k])\n            \n            # Gamma expression rule\n            is_gamma = (P_gamma[k] >= 0.20 * max_P_gamma and\n                        P_gamma[k] > P_alpha[k])\n            \n            if is_alpha:\n                alpha_modes.append(k)\n            if is_gamma:\n                gamma_modes.append(k)\n\n        alpha_modes.sort()\n        gamma_modes.sort()\n        \n        all_results.append([alpha_modes, gamma_modes])\n\n    # Format the final output string exactly as required\n    # The default str() for a list includes spaces. The required `print` suggests this is acceptable.\n    # Eg `str([[0],[1,2]])` -> `'[[0], [1, 2]]'`\n    # The problem description's example formatting seems to have omitted spaces for brevity.\n    # Following the provided print machinery is the safest interpretation.\n    result_strings = [str(res).replace(' ', '') for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A key hypothesis in neuroscience is that oscillations at different frequencies interact, a phenomenon known as cross-frequency coupling. Phase-Amplitude Coupling (PAC), where the amplitude of a high-frequency rhythm is modulated by the phase of a low-frequency one, is a widely studied example. However, apparent PAC can emerge as a mathematical artifact of non-sinusoidal waveform shapes, a common feature of electrophysiological signals. This advanced problem  asks you to mathematically dissect this confound, fostering the critical thinking essential for robust data analysis by deriving the magnitude of this spurious coupling and the statistical bias it introduces.",
            "id": "4002065",
            "problem": "Consider a network oscillation in the brain modeled as a periodic low-frequency waveform with angular frequency $\\omega_{0}$ and phase $\\phi \\in [0, 2\\pi)$, expressed in phase coordinates. Empirical Phase-Amplitude Coupling (PAC) is defined here as the dependence of a high-frequency amplitude envelope on the phase of a low-frequency oscillation. A fundamental PAC estimator based on amplitude-weighted mean vector length is given by\n$$\nM \\equiv \\frac{\\left| \\int_{0}^{2\\pi} A(\\phi)\\,\\exp(i\\,\\phi)\\,\\frac{d\\phi}{2\\pi} \\right|}{\\int_{0}^{2\\pi} A(\\phi)\\,\\frac{d\\phi}{2\\pi}},\n$$\nwhere $A(\\phi)$ is the high-frequency amplitude envelope as a function of low-frequency phase $\\phi$, and all angles are in radians.\n\nNon-sinusoidal waveform shapes generate apparent or spurious PAC. A realistic source is edge asymmetry: the high-frequency amplitude is concentrated near the rising and falling edges of the low-frequency cycle. Model the waveform as a duty-cycled pulse per cycle, with duty cycle $D \\in (0, 1)$, such that the rising and falling edge phases are separated by $\\Delta = 2\\pi D$, i.e., if the rising edge occurs at phase $\\phi_{r}$ and the falling edge at phase $\\phi_{f}$, then $\\phi_{f} - \\phi_{r} = \\Delta$. Assume the high-frequency amplitude envelope per cycle is dominated by two narrow contributions localized at the edges and can be approximated by\n$$\nA(\\phi) = \\alpha_{r}\\,g(\\phi - \\phi_{r}) + \\alpha_{f}\\,g(\\phi - \\phi_{f}),\n$$\nwhere $g(\\cdot)$ is a narrow kernel of unit area $\\int_{-\\infty}^{\\infty} g(u)\\,du = 1$, and $\\alpha_{r} > 0$, $\\alpha_{f} > 0$ are weights reflecting edge sharpness. Define a skewness parameter $s \\in [-1, 1]$ by setting $\\alpha_{r} = W\\frac{1+s}{2}$ and $\\alpha_{f} = W\\frac{1-s}{2}$ with $W > 0$ an arbitrary scale factor, so that $s=0$ corresponds to symmetric edges, $s>0$ emphasizes the rising edge, and $s<0$ emphasizes the falling edge.\n\nUnder a standard time-shift surrogate procedure that randomizes the relative alignment between the low-frequency phase and the high-frequency amplitude across $N_{c}$ cycles, the amplitude-weighted mean vector length $M$ has a positive bias due to finite-sample isotropic vector addition. You may assume that, under surrogate randomization, the summed two-dimensional complex vectors behave as a zero-mean isotropic random walk with step lengths equal to the amplitude weights at edges.\n\nStarting from the given definitions and modeling assumptions, and using only well-tested facts about Fourier localization of edge energy, isotropy of randomized phases, and the statistics of two-dimensional random walks, derive a closed-form analytic expression for the surrogate-corrected apparent PAC magnitude\n$$\nM_{\\mathrm{corr}}(D, s, N_{c}) \\equiv M_{\\mathrm{true}}(D, s) - M_{\\mathrm{bias}}(s, N_{c}),\n$$\nas an explicit function of duty cycle $D$, skewness $s$, and the number of cycles $N_{c}$. Your derivation must proceed from first principles and justify any approximations you use (e.g., the narrow-kernel limit for $g$ and the Rayleigh expectation for isotropic sums). Express the final answer as a single closed-form analytic expression in terms of $D$, $s$, and $N_{c}$. Do not include any units in the final expression. Angles must be in radians. No numerical evaluation is required.",
            "solution": "The problem asks for a closed-form analytic expression for the surrogate-corrected apparent Phase-Amplitude Coupling (PAC) magnitude, $M_{\\mathrm{corr}}(D, s, N_{c})$, defined as the difference between the true PAC magnitude, $M_{\\mathrm{true}}(D, s)$, and the bias introduced by a finite number of samples, $M_{\\mathrm{bias}}(s, N_{c})$. The derivation will proceed in two main parts: first, the calculation of $M_{\\mathrm{true}}$ based on the given waveform model, and second, the calculation of $M_{\\mathrm{bias}}$ based on the statistical model of the surrogate procedure.\n\nFirst, we calculate the true PAC magnitude, $M_{\\mathrm{true}}$. The definition of the PAC estimator is given as:\n$$\nM \\equiv \\frac{\\left| \\int_{0}^{2\\pi} A(\\phi)\\,\\exp(i\\,\\phi)\\,\\frac{d\\phi}{2\\pi} \\right|}{\\int_{0}^{2\\pi} A(\\phi)\\,\\frac{d\\phi}{2\\pi}}\n$$\nThis can be interpreted as the ratio of the magnitude of the first circular moment of the amplitude distribution $A(\\phi)$ to its zeroth moment (the mean amplitude). Let's denote the complex numerator as $Z_{num}$ and the real denominator as $Z_{den}$.\n\n$Z_{den} = \\int_{0}^{2\\pi} A(\\phi)\\,\\frac{d\\phi}{2\\pi}$\n$Z_{num} = \\int_{0}^{2\\pi} A(\\phi)\\,\\exp(i\\,\\phi)\\,\\frac{d\\phi}{2\\pi}$\n\nThe amplitude envelope is modeled as $A(\\phi) = \\alpha_{r}\\,g(\\phi - \\phi_{r}) + \\alpha_{f}\\,g(\\phi - \\phi_{f})$. The problem states that $g(\\cdot)$ is a narrow kernel with unit area. In the limit of a very narrow kernel, we can approximate $g(u)$ by the Dirac delta function, $\\delta(u)$. The unit area property $\\int g(u)du = 1$ is consistent with this approximation.\n\nUsing the Dirac delta approximation, $A(\\phi) \\approx \\alpha_{r}\\,\\delta(\\phi - \\phi_{r}) + \\alpha_{f}\\,\\delta(\\phi - \\phi_{f})$. We can now evaluate the integrals for the denominator and numerator.\n\nThe denominator is the mean amplitude:\n$$\nZ_{den} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\left[ \\alpha_{r}\\,\\delta(\\phi - \\phi_{r}) + \\alpha_{f}\\,\\delta(\\phi - \\phi_{f}) \\right] d\\phi\n$$\nUsing the sifting property of the delta function, $\\int f(x)\\delta(x-x_0)dx = f(x_0)$, we get:\n$$\nZ_{den} = \\frac{1}{2\\pi} (\\alpha_{r} + \\alpha_{f})\n$$\n\nThe complex numerator is:\n$$\nZ_{num} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\left[ \\alpha_{r}\\,\\delta(\\phi - \\phi_{r}) + \\alpha_{f}\\,\\delta(\\phi - \\phi_{f}) \\right] \\exp(i\\,\\phi) d\\phi\n$$\nApplying the sifting property again:\n$$\nZ_{num} = \\frac{1}{2\\pi} \\left( \\alpha_{r}\\exp(i\\,\\phi_{r}) + \\alpha_{f}\\exp(i\\,\\phi_{f}) \\right)\n$$\n\nNow, we compute $M_{\\mathrm{true}}$ by taking the ratio $|Z_{num}| / Z_{den}$:\n$$\nM_{\\mathrm{true}} = \\frac{\\left| \\frac{1}{2\\pi} \\left( \\alpha_{r}\\exp(i\\,\\phi_{r}) + \\alpha_{f}\\exp(i\\,\\phi_{f}) \\right) \\right|}{\\frac{1}{2\\pi} (\\alpha_{r} + \\alpha_{f})} = \\frac{|\\alpha_{r}\\exp(i\\,\\phi_{r}) + \\alpha_{f}\\exp(i\\,\\phi_{f})|}{\\alpha_{r} + \\alpha_{f}}\n$$\nThe magnitude of the complex sum in the numerator is $\\sqrt{(\\alpha_{r}\\cos\\phi_{r} + \\alpha_{f}\\cos\\phi_{f})^{2} + (\\alpha_{r}\\sin\\phi_{r} + \\alpha_{f}\\sin\\phi_{f})^{2}}$. This simplifies to $\\sqrt{\\alpha_{r}^{2} + \\alpha_{f}^{2} + 2\\alpha_{r}\\alpha_{f}\\cos(\\phi_{f}-\\phi_{r})}$.\nWe are given $\\phi_{f} - \\phi_{r} = \\Delta = 2\\pi D$. Substituting this:\n$$\nM_{\\mathrm{true}} = \\frac{\\sqrt{\\alpha_{r}^{2} + \\alpha_{f}^{2} + 2\\alpha_{r}\\alpha_{f}\\cos(2\\pi D)}}{\\alpha_{r} + \\alpha_{f}}\n$$\nNext, we substitute the definitions for $\\alpha_{r}$ and $\\alpha_{f}$ in terms of the skewness $s$ and scale factor $W$:\n$\\alpha_{r} = W\\frac{1+s}{2}$ and $\\alpha_{f} = W\\frac{1-s}{2}$.\nThe sum is $\\alpha_{r} + \\alpha_{f} = W\\frac{1+s}{2} + W\\frac{1-s}{2} = W$.\nThe sum of squares is $\\alpha_{r}^{2} + \\alpha_{f}^{2} = W^{2}\\frac{(1+s)^{2}}{4} + W^{2}\\frac{(1-s)^{2}}{4} = \\frac{W^{2}}{4}(1+2s+s^{2} + 1-2s+s^{2}) = \\frac{W^{2}}{2}(1+s^{2})$.\nThe product is $2\\alpha_{r}\\alpha_{f} = 2W^{2}\\frac{(1+s)(1-s)}{4} = \\frac{W^{2}}{2}(1-s^{2})$.\n\nSubstituting these into the expression for $M_{\\mathrm{true}}$:\n$$\nM_{\\mathrm{true}} = \\frac{\\sqrt{\\frac{W^{2}}{2}(1+s^{2}) + \\frac{W^{2}}{2}(1-s^{2})\\cos(2\\pi D)}}{W} = \\sqrt{\\frac{1}{2}\\left(1+s^{2} + (1-s^{2})\\cos(2\\pi D)\\right)}\n$$\nUsing the half-angle identity $\\cos(2x) = 1 - 2\\sin^{2}(x)$:\n$$\nM_{\\mathrm{true}} = \\sqrt{\\frac{1}{2}\\left(1+s^{2} + (1-s^{2})(1-2\\sin^{2}(\\pi D))\\right)} = \\sqrt{\\frac{1}{2}\\left(2 - 2(1-s^{2})\\sin^{2}(\\pi D)\\right)}\n$$\n$$\nM_{\\mathrm{true}}(D, s) = \\sqrt{1 - (1-s^{2})\\sin^{2}(\\pi D)} = \\sqrt{1 - \\sin^{2}(\\pi D) + s^{2}\\sin^{2}(\\pi D)} = \\sqrt{\\cos^{2}(\\pi D) + s^{2}\\sin^{2}(\\pi D)}\n$$\n\nSecond, we calculate the bias term, $M_{\\mathrm{bias}}(s, N_{c})$. The problem states that under surrogate randomization, the data behave as a zero-mean isotropic random walk with step lengths equal to the amplitude weights. For $N_{c}$ cycles, with two edge contributions per cycle, we have a sum of $2N_{c}$ random vectors in the complex plane. The total complex vector for a surrogate trial is $Z = \\sum_{k=1}^{N_{c}} \\left(\\alpha_{r}\\exp(i\\theta_{r,k}) + \\alpha_{f}\\exp(i\\theta_{f,k})\\right)$, where $\\theta_{r,k}$ and $\\theta_{f,k}$ are independent random phases uniformly distributed in $[0, 2\\pi)$. This is a sum of $2N_{c}$ vectors, $N_c$ of which have length $\\alpha_{r}$ and $N_c$ have length $\\alpha_{f}$. The mean $E[Z]=0$.\n\nThe PAC magnitude for a surrogate trial is $M_{surr} = |Z| / (N_{c}(\\alpha_{r}+\\alpha_{f})) = |Z|/(N_{c}W)$. The bias is the expectation $M_{\\mathrm{bias}} = E[M_{surr}] = E[|Z|]/(N_{c}W)$.\n\nFor a sum of a large number of random vectors, the resulting complex variable $Z$ is well-approximated by a circular complex normal distribution. Its magnitude $|Z|$ follows a Rayleigh distribution. The expected value of a Rayleigh-distributed variable is $E[|Z|] = \\sigma \\sqrt{\\pi/2}$, where $\\sigma^{2}$ is the variance of either the real or imaginary part of $Z$. The variance of the complex variable itself is $E[|Z|^{2}] = \\sigma_{Z}^{2} = 2\\sigma^{2}$.\nThe variance $\\sigma_{Z}^{2}$ is the sum of the squared lengths of the component vectors:\n$$\n\\sigma_{Z}^{2} = E[|Z|^{2}] = \\sum_{j=1}^{2N_{c}} L_{j}^{2} = N_{c}\\alpha_{r}^{2} + N_{c}\\alpha_{f}^{2} = N_{c}(\\alpha_{r}^{2} + \\alpha_{f}^{2})\n$$\nUsing our previous result, $\\alpha_{r}^{2} + \\alpha_{f}^{2} = \\frac{W^{2}}{2}(1+s^{2})$, we have:\n$$\n\\sigma_{Z}^{2} = N_{c}\\frac{W^{2}}{2}(1+s^{2})\n$$\nThe variance of the real part is $\\sigma^{2} = \\frac{1}{2}\\sigma_{Z}^{2} = N_{c}\\frac{W^{2}}{4}(1+s^{2})$.\nThe standard deviation is $\\sigma = \\sqrt{N_{c}\\frac{W^{2}}{4}(1+s^{2})} = \\frac{W}{2}\\sqrt{N_{c}(1+s^{2})}$.\nThe expected magnitude of the sum is:\n$$\nE[|Z|] = \\sigma \\sqrt{\\frac{\\pi}{2}} = \\frac{W}{2}\\sqrt{N_{c}(1+s^{2})} \\sqrt{\\frac{\\pi}{2}} = \\frac{W\\sqrt{\\pi}}{2\\sqrt{2}}\\sqrt{N_{c}(1+s^{2})}\n$$\nNow we can compute the bias:\n$$\nM_{\\mathrm{bias}}(s, N_{c}) = \\frac{E[|Z|]}{N_{c}W} = \\frac{\\frac{W\\sqrt{\\pi}}{2\\sqrt{2}}\\sqrt{N_{c}(1+s^{2})}}{N_{c}W} = \\frac{\\sqrt{\\pi(1+s^{2})}}{2\\sqrt{2}\\sqrt{N_{c}}} = \\sqrt{\\frac{\\pi(1+s^{2})}{8N_{c}}}\n$$\n\nFinally, we find the surrogate-corrected PAC magnitude by subtracting the bias from the true value:\n$$\nM_{\\mathrm{corr}}(D, s, N_{c}) = M_{\\mathrm{true}}(D, s) - M_{\\mathrm{bias}}(s, N_{c})\n$$\n$$\nM_{\\mathrm{corr}}(D, s, N_{c}) = \\sqrt{\\cos^{2}(\\pi D) + s^{2}\\sin^{2}(\\pi D)} - \\sqrt{\\frac{\\pi(1+s^{2})}{8N_{c}}}\n$$\nThis is the final closed-form analytic expression as a function of $D$, $s$, and $N_{c}$.",
            "answer": "$$\n\\boxed{\\sqrt{\\cos^{2}(\\pi D) + s^{2}\\sin^{2}(\\pi D)} - \\sqrt{\\frac{\\pi(1+s^{2})}{8N_{c}}}}\n$$"
        }
    ]
}