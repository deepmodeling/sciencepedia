{
    "hands_on_practices": [
        {
            "introduction": "研究神经振荡的第一步是精确地从记录数据（如局部场电位，LFP）中测量其频率成分。本练习  深入探讨了频谱分析的核心，即基本工具——周期图。通过推导其统计特性，学习者将理解频谱泄漏等关键挑战，并掌握获得可靠频谱估计的先进方法，为分析真实的神经信号奠定坚实的理论基础。",
            "id": "4002012",
            "problem": "考虑一个长度为 $N$ 的零均值、宽义平稳的离散时间局部场电位 (LFP) 信号 $x[n]$，该信号从一个在典型频带（如 delta、theta、beta、gamma）上表现出振荡活动的皮层网络中采样得到。其自协方差序列为 $\\gamma_{x}[\\tau] = \\mathbb{E}\\{x[n] x[n+\\tau]\\}$，功率谱密度 (PSD) $S(\\omega)$ 通过维纳-辛钦定理定义为 $S(\\omega) = \\sum_{\\tau=-\\infty}^{\\infty} \\gamma_{x}[\\tau] \\exp(-\\mathrm{i} \\omega \\tau)$，其中角频率 $\\omega \\in [-\\pi, \\pi]$。一个有限观测窗 $w[n]$ 被应用于 $x[n]$，得到 $x_{w}[n] = w[n] x[n]$，其中 $w[n]$ 仅在 $n \\in \\{0, 1, \\dots, N-1\\}$ 时非零。\n\n从这些定义和傅里叶分析的基本原理出发，推导从 $x_{w}[n]$ 得到的 PSD 的周期图估计量 $I_{N}(\\omega)$，并在 $x[n]$ 是高斯且宽义平稳的假设下，表示其期望 $\\mathbb{E}\\{I_{N}(\\omega)\\}$ 和方差 $\\mathrm{Var}\\{I_{N}(\\omega)\\}$。明确指出与 $w[n]$ 相关的频谱窗 $W_{N}(\\omega)$，并用谱泄漏核来描述偏差 $\\mathbb{E}\\{I_{N}(\\omega)\\} - S(\\omega)$。将您的表达式具体化为矩形窗，即当 $n = 0, 1, \\dots, N-1$ 时 $w[n] = 1$，否则 $w[n] = 0$，并用闭式形式表示相应的谱核。\n\n接下来，提出一种减少泄漏的谱估计策略，该策略专为跨多个频带的网络振荡的 LFP 分析而设计，可使用 Welch 方法（分段、加窗后求平均）或多窗法（使用正交数据窗，如离散扁长球状序列）。通过分析窗的旁瓣结构或窗谱的能量集中度如何影响相邻频带间的泄漏，来证明您选择的合理性。\n\n最后，假设您实现了一个组合策略，其中 LFP 被分割成 $M$ 段，每段使用 $K$ 个等权重的正交窗，并且在固定角频率 $\\omega$ 处对各段和各窗上的独立加窗谱估计进行平均。在独立性近似和高斯假设下，提供一个单一的闭式解析表达式，用真实 PSD $S(\\omega)$、分段数 $M$ 和窗数 $K$ 来表示最终平均估计量在 $\\omega$ 处的方差。将最终答案表示为解析表达式。无需数值四舍五入。",
            "solution": "我们从一个零均值、宽义平稳 (WSS) 的离散时间过程 $x[n]$ 开始，其自协方差为 $\\gamma_{x}[\\tau] = \\mathbb{E}\\{x[n] x[n+\\tau]\\}$，功率谱密度 (PSD) 为 $S(\\omega) = \\sum_{\\tau=-\\infty}^{\\infty} \\gamma_{x}[\\tau] \\exp(-\\mathrm{i} \\omega \\tau)$，其中 $\\omega \\in [-\\pi, \\pi]$。维纳-辛钦定理将 $S(\\omega)$ 与 $\\gamma_{x}[\\tau]$ 联系起来，是进行非参数谱估计的基础。\n\n有限观测将该过程乘以一个确定性窗 $w[n]$，得到 $x_{w}[n] = w[n] x[n]$，$n = 0, 1, \\dots, N-1$。定义加窗数据的有限长度离散时间傅里叶变换 (DTFT) 为\n$$\nX_{w}(\\omega) = \\sum_{n=0}^{N-1} x_{w}[n] \\exp(-\\mathrm{i} \\omega n)\n= \\sum_{n=0}^{N-1} w[n] x[n] \\exp(-\\mathrm{i} \\omega n).\n$$\n周期图估计量定义为\n$$\nI_{N}(\\omega) = \\frac{1}{2 \\pi N} \\left| X_{w}(\\omega) \\right|^{2}.\n$$\n为了分析期望和偏差，我们用窗的 DTFT 来表示 $I_{N}(\\omega)$。定义窗变换为\n$$\nW_{N}(\\omega) = \\sum_{n=0}^{N-1} w[n] \\exp(-\\mathrm{i} \\omega n),\n$$\n并将 $X_{w}(\\omega)$ 写成基础变换与频谱窗的频率卷积。利用 WSS 和高斯假设，周期图的期望可以写成真实 PSD 与窗变换幅值平方的谱卷积，并进行适当归一化。具体来说，\n$$\n\\mathbb{E}\\{ I_{N}(\\omega) \\}\n= \\frac{1}{2 \\pi N} \\mathbb{E}\\{ X_{w}(\\omega) X_{w}^{\\ast}(\\omega) \\}\n= \\frac{1}{2 \\pi} \\int_{-\\pi}^{\\pi} S(\\lambda) \\, F_{N}(\\omega - \\lambda) \\, \\mathrm{d}\\lambda,\n$$\n其中谱核 $F_{N}(\\omega)$ 由下式给出\n$$\nF_{N}(\\omega) = \\frac{1}{2 \\pi N} \\left| W_{N}(\\omega) \\right|^{2}.\n$$\n这表明对于有限的 $N$，周期图是一个有偏估计量，其偏差由真实谱与其同 $F_{N}(\\cdot)$ 的卷积之差决定。偏差为\n$$\n\\mathrm{bias}_{N}(\\omega) = \\mathbb{E}\\{ I_{N}(\\omega) \\} - S(\\omega)\n= \\frac{1}{2 \\pi} \\int_{-\\pi}^{\\pi} S(\\lambda) \\, F_{N}(\\omega - \\lambda) \\, \\mathrm{d}\\lambda - S(\\omega).\n$$\n当 $N \\to \\infty$ 且 $S(\\omega)$ 足够平滑时，$F_{N}(\\omega)$ 在频率上集中为一个狄拉克-德尔塔函数，这意味着 $\\mathbb{E}\\{ I_{N}(\\omega) \\} \\to S(\\omega)$（渐近无偏性）。对于有限的 $N$，$F_{N}(\\omega)$ 中的旁瓣会引起谱泄漏。\n\n具体到矩形窗，即当 $n = 0, 1, \\dots, N-1$ 时 $w[n] = 1$，否则 $w[n] = 0$。则\n$$\nW_{N}(\\omega) = \\sum_{n=0}^{N-1} \\exp(-\\mathrm{i} \\omega n)\n= \\exp\\!\\left( -\\mathrm{i} \\omega \\frac{N-1}{2} \\right) \\frac{\\sin\\!\\left( \\frac{N \\omega}{2} \\right)}{\\sin\\!\\left( \\frac{\\omega}{2} \\right)}.\n$$\n因此，谱核是 Fejér 核：\n$$\nF_{N}(\\omega) = \\frac{1}{2 \\pi N} \\left| W_{N}(\\omega) \\right|^{2}\n= \\frac{1}{2 \\pi N} \\left( \\frac{\\sin\\!\\left( \\frac{N \\omega}{2} \\right)}{\\sin\\!\\left( \\frac{\\omega}{2} \\right)} \\right)^{2}.\n$$\n我们接下来评估 $I_{N}(\\omega)$ 的方差。在高斯性和 WSS 假设下，在不同的傅里叶频率上的傅里叶纵坐标 $X_{w}(\\omega)$ 近似为零均值的复高斯变量。对于矩形窗和傅里叶网格频率，并忽略 $O(1/N)$ 的相关性，$I_{N}(\\omega)$ 的行为类似于复高斯变量的幅值平方，从而呈指数分布。更精确地说，对于固定的 $\\omega$ 和大的 $N$，\n$$\n\\frac{I_{N}(\\omega)}{S(\\omega)} \\approx \\frac{1}{2} \\chi^{2}_{2},\n$$\n这是一个自由度为2的缩放卡方随机变量。$\\frac{1}{2} \\chi^{2}_{2}$ 的均值和方差分别为1和1，这意味着\n$$\n\\mathbb{E}\\{ I_{N}(\\omega) \\} \\approx S(\\omega), \\quad \\mathrm{Var}\\{ I_{N}(\\omega) \\} \\approx S(\\omega)^{2}.\n$$\n因此，原始周期图是渐近无偏但非一致的，因为其方差不随 $N \\to \\infty$ 而消失。\n\n为了减少 LFP 分析中跨多个频带的网络振荡的谱泄漏，可以使用 Welch 方法或多窗法。Welch 方法将数据分段为重叠的窗口，对每段应用一个数据窗（如 Hann 窗）以降低 $F_{N}(\\omega)$ 的旁瓣水平，计算每段的周期图，然后将它们平均。Hann 窗通过抑制旁瓣来减少谱泄漏，但代价是加宽了主瓣（权衡偏差和方差）。多窗法使用 $K$ 个正交的离散扁长球状序列窗（Slepian 序列），这些窗在选定带宽内最大化谱能量集中度，从而减少泄漏，同时在不同窗之间提供近似独立的谱估计。\n\n考虑一个组合策略：将数据分割成 $M$ 段，每段应用 $K$ 个正交窗，在固定的 $\\omega$ 处计算加窗周期图，并用相等的权重平均所有 $M K$ 个估计值。在各段和各窗之间独立性的近似下，并且每个加窗估计的方差与原始周期图的方差相同（当 $K$ 适中且窗在目标频带内具有接近单位的谱能量集中度时，这是合理的），$M K$ 个独立的类指数分布变量的平均值产生一个形状参数为 $M K$ 的伽马分布，其方差与 $M K$ 成反比：\n$$\n\\mathrm{Var}\\left\\{ \\frac{1}{M K} \\sum_{m=1}^{M} \\sum_{k=1}^{K} I_{m,k}(\\omega) \\right\\} \n= \\frac{1}{(M K)^{2}} \\sum_{m=1}^{M} \\sum_{k=1}^{K} \\mathrm{Var}\\{ I_{m,k}(\\omega) \\}\n\\approx \\frac{M K \\, S(\\omega)^{2}}{(M K)^{2}}\n= \\frac{S(\\omega)^{2}}{M K}.\n$$\n这里，$I_{m,k}(\\omega)$ 表示来自第 $m$ 段、使用第 $k$ 个窗的加窗周期图。该近似假设由于加窗和窗的正交性，不同 $(m,k)$ 对之间的协方差可以忽略不计，这是高级非参数谱估计中的一个标准假设。\n\n因此，组合的平均 Welch-多窗估计量在角频率 $\\omega$ 处的方差为\n$$\n\\mathrm{Var}\\{ \\widehat{S}(\\omega) \\} \\approx \\frac{S(\\omega)^{2}}{M K}.\n$$\n这个闭式解析表达式体现了通过分段平均 ($M$) 和窗平均 ($K$) 实现的方差减小，而泄漏则通过窗的谱能量集中度（多窗法）和旁瓣抑制（Welch 加窗法）来减少。",
            "answer": "$$\\boxed{\\frac{S(\\omega)^{2}}{M K}}$$"
        },
        {
            "introduction": "在学习了如何测量振荡之后，一个自然而然的问题是它们是如何产生的。本练习  探讨了伽马振荡的经典生成机制——锥体-中间神经元伽马（PING）模型。通过分析一个简化的线性反馈回路，你将推导出突触特性、传导延迟与所产生的振荡频率之间的关系，从而在细胞组分和网络行为之间建立起关键的联系。",
            "id": "4002044",
            "problem": "考虑一个描述循环兴奋-抑制（E-I）皮层微回路中锥体-中间神经元伽马（PING）振荡的最小线性化反馈模型。兴奋性到抑制性通路和抑制性到兴奋性通路均由一阶突触滤波器表示，其脉冲响应在频域中对应于形式为 $H_{X}(s)=\\frac{1}{1+s \\tau_{X}}$（其中 $X \\in \\{E,I\\}$）的传递函数，其中 $\\tau_{E}$ 和 $\\tau_{I}$ 分别是兴奋性和抑制性突触的时间常数。该环路还包含一个沿着 E-I-E 循环的纯轴突/传导延迟 $d$。由于抑制性反馈，该环路的符号为负。假设在振荡峰值附近，环路增益的幅度足以满足振荡条件，并且可以认为其幅度近似为单位1，因此峰值频率主要由环路相位决定。\n\n仅从线性时不变系统的基本原理、一阶低通滤波器的频率响应以及反馈振荡相位条件（即自主持续振荡要求环路相位是 $2\\pi$ 弧度的整数倍）出发，推导 PING 峰值角频率 $\\omega_{\\mathrm{peak}}$ 作为 $\\tau_{E}$、$\\tau_{I}$ 和 $d$ 的函数的近似表达式。明确处理来自突触滤波器和延迟的相位贡献，并在有明确说明的条件下使用小参数近似 $\\arctan(x)\\approx x$。将您的结果转换为频率 $f_{\\mathrm{peak}}$。\n\n然后，使用您推导的表达式，预测当药理学操作将抑制性突触时间常数延长指定倍数时新的峰值振荡频率。使用以下生理上合理的参数：基线 $\\tau_{E}=2\\,\\mathrm{ms}$，$\\tau_{I}=10\\,\\mathrm{ms}$，以及 $d=3\\,\\mathrm{ms}$。假设一种药物将 $\\tau_{I}$ 增加了 $50$ 百分比（即乘以因子 $1.5$），而没有其他方面改变该回路。计算预测的新峰值频率。以赫兹（Hz）表示最终频率，并将您的答案四舍五入到三位有效数字。所有角度都应以弧度处理。",
            "solution": "该问题描述了一个由兴奋性突触、抑制性突触和传导延迟组成的负反馈环路。令开环传递函数（不包括负反馈符号）表示为 $G(s)$。该函数代表了通过 E-I-E 回路的完整前向路径。\n\n该路径的组成部分是传递函数为 $H_E(s)$ 的兴奋性突触、传递函数为 $H_I(s)$ 的抑制性突触，以及建模为 $\\exp(-sd)$ 的传导延迟。总开环传递函数是这些组件与增益因子 $K$ 的乘积：\n$$G(s) = K H_E(s) H_I(s) \\exp(-sd) = K \\frac{1}{1+s \\tau_{E}} \\frac{1}{1+s \\tau_{I}} \\exp(-sd)$$\n该系统是一个负反馈环路，因此其稳定性的特征方程为 $1+G(s)=0$。为了维持持续振荡，系统必须在复平面的虚轴上具有极点，设为 $s=j\\omega_{\\mathrm{peak}}$。这意味着在振荡频率 $\\omega_{\\mathrm{peak}}$ 处，必须满足以下条件：\n$$G(j\\omega_{\\mathrm{peak}}) = -1$$\n这个单一的复数方程可以分解为两个实数方程：一个关于幅度，一个关于相位。\n$1$. 幅度条件：$|G(j\\omega_{\\mathrm{peak}})| = |-1| = 1$。\n$2$. 相位条件：$\\arg(G(j\\omega_{\\mathrm{peak}})) = \\arg(-1) = (2k+1)\\pi$，其中 $k$ 为任意整数。\n\n问题陈述我们应假设幅度条件已满足。我们的任务是找到满足相位条件的频率 $\\omega_{\\mathrm{peak}}$。让我们分析 $G(j\\omega)$ 的相位：\n$$\\arg(G(j\\omega)) = \\arg(K) + \\arg\\left(\\frac{1}{1+j\\omega \\tau_{E}}\\right) + \\arg\\left(\\frac{1}{1+j\\omega \\tau_{I}}\\right) + \\arg(\\exp(-j\\omega d))$$\n假设增益 $K$ 是一个实数正常数，其相位为 $0$。一个复数倒数的相位是该数本身相位的负值。$\\exp(-j\\omega d)$ 的相位是 $-\\omega d$。\n因此，每个组件的相位是：\n$\\arg(1+j\\omega \\tau_X) = \\arctan(\\omega \\tau_X)$。\n所以，$\\arg\\left(\\frac{1}{1+j\\omega \\tau_X}\\right) = -\\arctan(\\omega \\tau_X)$。\n$G(j\\omega)$ 的总相位是各组件相位延迟的总和：\n$$\\arg(G(j\\omega)) = -\\arctan(\\omega \\tau_{E}) - \\arctan(\\omega \\tau_{I}) - \\omega d$$\n现在我们应用相位条件。对于最低频率的非平凡振荡模式，我们通常选择允许求解的最简单情况。由于当 $\\omega > 0$ 时左侧严格为负，我们必须在右侧选择一个负的奇数倍 $\\pi$。最简单的选择是 $k=-1$，这给出 $\\arg(-1) = -\\pi$。\n将 $\\omega_{\\mathrm{peak}}$ 处的相位设为 $-\\pi$：\n$$-\\arctan(\\omega_{\\mathrm{peak}} \\tau_{E}) - \\arctan(\\omega_{\\mathrm{peak}} \\tau_{I}) - \\omega_{\\mathrm{peak}} d = -\\pi$$\n两边乘以 $-1$，我们得到振荡频率的精确相位方程：\n$$\\arctan(\\omega_{\\mathrm{peak}} \\tau_{E}) + \\arctan(\\omega_{\\mathrm{peak}} \\tau_{I}) + \\omega_{\\mathrm{peak}} d = \\pi$$\n这是一个关于 $\\omega_{\\mathrm{peak}}$ 的超越方程。为了按要求获得近似解析解，我们采用反正切函数的小参数近似 $\\arctan(x) \\approx x$，这在 $|x| \\ll 1$ 时有效。我们将此近似应用于突触项。其理由是，即使在所有情况下条件不被严格满足，这种线性化也是推导振荡周期与电路时间常数之间简单、直观关系的标准方法。这产生了一个易于处理的一阶近似。\n应用近似得到：\n$$\\omega_{\\mathrm{peak}} \\tau_{E} + \\omega_{\\mathrm{peak}} \\tau_{I} + \\omega_{\\mathrm{peak}} d \\approx \\pi$$\n我们现在可以解出 $\\omega_{\\mathrm{peak}}$：\n$$\\omega_{\\mathrm{peak}} (d + \\tau_{E} + \\tau_{I}) \\approx \\pi$$\n$$\\omega_{\\mathrm{peak}} \\approx \\frac{\\pi}{d + \\tau_{E} + \\tau_{I}}$$\n以赫兹为单位的频率 $f_{\\mathrm{peak}}$ 与角频率 $\\omega_{\\mathrm{peak}}$ 的关系是 $f = \\omega / (2\\pi)$。因此，峰值频率的近似表达式为：\n$$f_{\\mathrm{peak}} = \\frac{\\omega_{\\mathrm{peak}}}{2\\pi} \\approx \\frac{1}{2(d + \\tau_{E} + \\tau_{I})}$$\n这个结果很直观：振荡频率是总环路延迟两倍的倒数，其中总延迟是轴突传导延迟和突触滤波器有效延迟的总和。\n\n现在，我们使用这个推导出的公式来计算药理学操作后的新峰值频率。\n基线参数是：\n$\\tau_{E} = 2\\,\\mathrm{ms} = 2 \\times 10^{-3}\\,\\mathrm{s}$\n$\\tau_{I} = 10\\,\\mathrm{ms} = 10 \\times 10^{-3}\\,\\mathrm{s}$\n$d = 3\\,\\mathrm{ms} = 3 \\times 10^{-3}\\,\\mathrm{s}$\n\n一种药物将抑制性突触时间常数 $\\tau_{I}$ 增加了 $50\\%$。新值 $\\tau'_{I}$ 是：\n$$\\tau'_{I} = \\tau_{I} \\times 1.5 = (10\\,\\mathrm{ms}) \\times 1.5 = 15\\,\\mathrm{ms} = 15 \\times 10^{-3}\\,\\mathrm{s}$$\n其他参数保持不变：$\\tau'_{E} = \\tau_{E} = 2\\,\\mathrm{ms}$ 和 $d' = d = 3\\,\\mathrm{ms}$。\n\n新的总环路延迟 $T_{\\mathrm{loop}}$ 是：\n$$T_{\\mathrm{loop}} = d' + \\tau'_{E} + \\tau'_{I} = 3\\,\\mathrm{ms} + 2\\,\\mathrm{ms} + 15\\,\\mathrm{ms} = 20\\,\\mathrm{ms} = 0.020\\,\\mathrm{s}$$\n新的预测峰值频率 $f'_{\\mathrm{peak}}$ 是：\n$$f'_{\\mathrm{peak}} = \\frac{1}{2 T_{\\mathrm{loop}}} = \\frac{1}{2 \\times 0.020\\,\\mathrm{s}} = \\frac{1}{0.040\\,\\mathrm{s}} = 25\\,\\mathrm{Hz}$$\n问题要求将答案四舍五入到三位有效数字。计算出的值 $25\\,\\mathrm{Hz}$ 写作 $25.0\\,\\mathrm{Hz}$ 以反映此精度。",
            "answer": "$$ \\boxed{25.0} $$"
        },
        {
            "introduction": "在局部回路机制的基础上，本练习  将尺度扩展到探究更广泛网络的连接结构如何塑造振荡动态。你将使用图论和拉普拉斯特征模态的概念来表示网络的内在空间模式。通过模拟网络对不同输入的响应，你将观察到网络结构与输入模式如何相互作用，共同决定了哪些频带（如阿尔法波段与伽马波段）的活动将被表达，这揭示了大脑中结构与功能关系的基本原理。",
            "id": "4001991",
            "problem": "给定一个皮层网络的简化模型，该模型表示为一个具有对称邻接矩阵和相应组合拉普拉斯算子的无向图。对于小扰动，网络动力学由一个线性二阶系统建模，该系统源于耦合的兴奋-抑制神经元集群的线性化。核心原理包括：基于图拉普拉斯特征模态的模态分解、线性时不变动力学以及限带功率积分。您的任务是计算拉普拉斯特征模态，推导每个模态的频域响应，并确定在不同空间输入模式下，哪些模态在α波段和γ波段中表达。\n\n使用的基本定义：\n- 图的组合拉普拉斯算子定义为 $L = D - A$，其中 $A$ 是邻接矩阵，$D$ 是对角线度矩阵。\n- 模态坐标 $x_k(t)$ 的线性二阶阻尼系统表示为 $\\ddot{x}_k(t) + 2 \\zeta \\omega_0 \\dot{x}_k(t) + \\omega_0^2 \\left(1 + \\beta \\lambda_k \\right) x_k(t) = u_k(t)$，其中 $\\lambda_k$ 是第 $k$ 个拉普拉斯特征值，$\\omega_0$ 是基础角频率，$\\zeta$ 是阻尼比，$\\beta$ 是将空间耦合映射到有效刚度的耦合系数，而 $u_k(t)$ 是输入在第 $k$ 个特征模态上的投影。\n- 每个模态的频域幅度响应可以通过对上述微分方程进行变换，并在频带上对响应的平方幅度进行积分来获得。\n\n图的构建和测试套件：\n您将评估三个测试用例，每个用例由一个图和一个输入模式定义。所有图都是无向的，具有无权边（$0$ 或 $1$）和 $N$ 个节点。对于每种情况，必须从 $A$ 计算组合拉普拉斯算子 $L$。\n\n- 测试用例 1（理想情况，全局驱动）：\n  - 图：一个有 $N = 8$ 个节点的环形图，其中每个节点连接到其两个最近的邻居（度为 $2$），包括环绕连接。\n  - 输入模式：一个均匀的空间输入向量 $u \\in \\mathbb{R}^N$，其中对于所有 $i$，$u_i = 1$。\n\n- 测试用例 2（局部化驱动，混合模态激励）：\n  - 图：与测试用例 1 中相同的 $N = 8$ 环形图。\n  - 输入模式：一个在节点索引 $0$ 处为 one-hot 的局部化输入向量（即 $u_0 = 1$ 且对于 $i \\neq 0$，$u_i = 0$）。\n\n- 测试用例 3（边缘情况，高空间频率驱动）：\n  - 图：相同的 $N = 8$ 环形图。\n  - 输入模式：一个交替的空间模式 $u$，其条目为 $u_i = (-1)^i$，对于 $i = 0, 1, \\dots, 7$，这会激励高空间频率的模态。\n\n模型参数：\n- 基础角频率 $\\omega_0 = 2 \\pi f_0$，其中 $f_0 = 10$（单位：Hz）。\n- 阻尼比 $\\zeta = 0.20$（无量纲）。\n- 耦合系数 $\\beta = 8.0$（无量纲）。\n- 频带：α波段从 $f_{\\alpha,\\min} = 8$ 到 $f_{\\alpha,\\max} = 12$（单位：Hz），γ波段从 $f_{\\gamma,\\min} = 30$ 到 $f_{\\gamma,\\max} = 80$（单位：Hz）。\n- 用于数值积分的频率采样步长 $\\Delta f = 0.5$（单位：Hz）。\n\n所需计算：\n- 对每个测试用例，计算拉普拉斯算子 $L$ 的特征值 $\\lambda_k$ 和标准正交特征向量 $v_k$，模态按特征值升序索引（$k = 0, 1, \\dots, N-1$）。\n- 将输入模式 $u$ 投影到特征基上：$u_k = v_k^\\top u$。\n- 对于每个模态 $k$，计算其在α波段和γ波段中的波段功率。该功率通过在指定频带上对模态频率响应的平方幅度乘以 $|u_k|^2$ 进行数值积分来定义。使用以 $f = f_{\\min}, f_{\\min} + \\Delta f, \\dots, f_{\\max}$ 采样的频率，并通过 $\\omega = 2\\pi f$ 转换为角频率（单位：rad/s）。假设输入频谱在频率上是恒定的（单位谱密度），因此波段功率与 $\\int |H_k(\\omega)|^2 |u_k|^2 \\, \\mathrm{d}\\omega$ 成正比。\n- 要将模态分类为在某个波段中“表达”，请对每种情况和每个波段使用以下规则：\n  - 计算所有 $|u_k|$ 不可忽略的模态的波段功率列表 $P_{\\alpha}(k)$ 和 $P_{\\gamma}(k)$。将可忽略投影的数值阈值定义为 $|u_k|^2  10^{-12}$。\n  - 如果 $P_{\\alpha}(k) \\geq 0.20 \\cdot \\max_j P_{\\alpha}(j)$ 且 $P_{\\alpha}(k) \\geq P_{\\gamma}(k)$，则模态 $k$ 在α波段中表达。\n  - 如果 $P_{\\gamma}(k) \\geq 0.20 \\cdot \\max_j P_{\\gamma}(j)$ 且 $P_{\\gamma}(k) > P_{\\alpha}(k)$，则模态 $k$ 在γ波段中表达。\n\n输出要求：\n- 将每个测试用例的最终分类表示为一对整数列表：第一个列表包含在α波段表达的模态的索引，第二个列表包含在γ波段表达的模态的索引。索引必须按升序给出。\n- 单位：所有频率都以赫兹（Hz）为单位。积分内部以弧度/秒为单位运算，但积分限制以赫兹指定。\n- 您的程序应生成一行输出，其中包含三个测试用例的汇总结果，格式为逗号分隔的列表，每个用例的结果格式为包含在其自己的方括号中的一对列表。例如：$[[\\text{alpha\\_modes\\_case1},\\text{gamma\\_modes\\_case1}],[\\text{alpha\\_modes\\_case2},\\text{gamma\\_modes\\_case2}],[\\text{alpha\\_modes\\_case3},\\text{gamma\\_modes\\_case3}]]$。",
            "solution": "该问题要求分析一个简化的皮层网络模型，以确定在不同的空间输入条件下，其哪些振荡模态在α和γ频带中表达。解决方案首先建立理论框架，然后将其应用于具体的测试用例。\n\n### 1. 理论框架\n\n网络动力学是为其每个空间模态建模的，这些模态通过图拉普拉斯算子的特征分解获得。\n\n#### 1.1. 图拉普拉斯算子和特征模态\n网络被表示为一个具有邻接矩阵 $A$ 和度矩阵 $D$ 的无向图。组合拉普拉斯算子定义为 $L = D - A$。由于 $L$ 是一个实对称矩阵，它有一套完备的标准正交特征向量 $v_k$ 和对应的实数、非负特征值 $\\lambda_k$，满足特征值方程：\n$$\nL v_k = \\lambda_k v_k\n$$\n对于 $k = 0, 1, \\dots, N-1$，其中 $N$ 是节点数。特征值按升序排列，$\\lambda_0 \\le \\lambda_1 \\le \\dots \\le \\lambda_{N-1}$。特征向量 $\\{v_k\\}$ 构成了网络空间模式的一个标准正交基。\n\n#### 1.2. 模态动力学和频率响应\n每个模态的动力学，由其坐标 $x_k(t)$ 描述，遵循一个线性二阶阻尼谐振子方程：\n$$\n\\ddot{x}_k(t) + 2 \\zeta \\omega_0 \\dot{x}_k(t) + \\omega_0^2 \\left(1 + \\beta \\lambda_k \\right) x_k(t) = u_k(t)\n$$\n这里，$\\zeta$ 是阻尼比，$\\omega_0$ 是基础角频率，$\\beta$ 是耦合系数，而 $u_k(t)$ 是外部输入向量 $u(t)$ 在第 $k$ 个特征模态上的投影。对于一个时不变的空间输入模式 $u$，我们有 $u_k(t) = (v_k^\\top u) \\cdot f(t)$，其中 $f(t)$ 是输入的时域分量。问题假设输入频谱在频率上是恒定的，这对应于时间上的一个脉冲输入，$f(t) = \\delta(t)$。空间模式的投影是 $u_k = v_k^\\top u$。\n\n为了找到频率响应，我们对微分方程应用傅里叶变换，其中导数 $\\frac{d}{dt}$ 的变换是乘以 $i\\omega$。这得到：\n$$\n(i\\omega)^2 X_k(\\omega) + 2 \\zeta \\omega_0 (i\\omega) X_k(\\omega) + \\omega_{k, \\text{res}}^2 X_k(\\omega) = U_k(\\omega)\n$$\n其中 $X_k(\\omega)$ 和 $U_k(\\omega)$ 分别是 $x_k(t)$ 和 $u_k(t)$ 的傅里叶变换，我们定义了依赖于模态的谐振角频率 $\\omega_{k, \\text{res}}$ 为：\n$$\n\\omega_{k, \\text{res}} = \\omega_0 \\sqrt{1 + \\beta \\lambda_k}\n$$\n模态 $k$ 的传递函数 $H_k(\\omega) = X_k(\\omega) / U_k(\\omega)$ 是：\n$$\nH_k(\\omega) = \\frac{1}{(\\omega_{k, \\text{res}}^2 - \\omega^2) + i(2 \\zeta \\omega_0 \\omega)}\n$$\n响应的功率谱密度与 $|H_k(\\omega)|^2 |u_k|^2$ 成正比。传递函数的平方幅度是：\n$$\n|H_k(\\omega)|^2 = \\frac{1}{(\\omega_{k, \\text{res}}^2 - \\omega^2)^2 + (2 \\zeta \\omega_0 \\omega)^2}\n$$\n\n#### 1.3. 波段功率计算\n模态 $k$ 在特定频带 $[f_{\\min}, f_{\\max}]$ 内的功率通过数值积分其功率谱密度来计算。这通过离散频率步长 $\\Delta f$ 上的黎曼和来近似：\n$$\nP_{\\text{band}}(k) \\propto |u_k|^2 \\sum_{f = f_{\\min}, f_{\\min}+\\Delta f, \\dots, f_{\\max}} |H_k(2\\pi f)|^2\n$$\n来自积分步长 $\\Delta \\omega = 2\\pi \\Delta f$ 的常数比例因子被省略，因为分类规则基于比率，这使得该因子无关紧要。\n\n### 2. 测试用例分析\n\n所有测试用例都使用一个 $N=8$ 节点的环形图，模型参数为 $\\omega_0 = 2\\pi(10)$，$\\zeta = 0.20$ 和 $\\beta=8.0$。该图是 2-正则的，所以 $D=2I$。邻接矩阵 $A$ 的条目 $A_{ij}=1$ 如果 $|i-j| \\pmod 8 = 1$。拉普拉斯算子是 $L=2I - A$。数值计算产生以下特征值，带有简并性：$\\lambda_0 = 0.0$，$\\lambda_{1,2} \\approx 0.586$，$\\lambda_{3,4} = 2.0$，$\\lambda_{5,6} \\approx 3.414$ 和 $\\lambda_7 = 4.0$。\n\n#### 测试用例 1：均匀输入\n-   **输入**：$u = [1, 1, 1, 1, 1, 1, 1, 1]^\\top$。\n-   **投影**：此输入与对应于 $\\lambda_0=0$ 的常数特征向量 $v_0$ 平行。由于特征向量的正交性，$u_k = v_k^\\top u = 0$ 对于所有 $k \\neq 0$。唯一不可忽略的投影是 $u_0$。\n-   **谐振频率**：对于模态 $k=0$，$\\lambda_0=0$，所以谐振频率是 $f_{0, \\text{res}} = f_0\\sqrt{1+\\beta \\cdot 0} = f_0 = 10$ Hz。\n-   **分类**：位于 $10$ Hz 的谐振峰值正好落在α波段（$8-12$ Hz）内。因此，$P_{\\alpha}(0)$ 会很大，而 $P_{\\gamma}(0)$ 会很小。所有其他模态的功率为零。根据规则，模态 $0$ 满足 $P_{\\alpha}(0) \\ge 0.20 \\cdot \\max_j P_{\\alpha}(j)$ 和 $P_{\\alpha}(0) \\ge P_{\\gamma}(0)$。\n-   **结果**：α模态：$[0]$，γ模态：$[]$。\n\n#### 测试用例 2：局部化输入\n-   **输入**：$u = [1, 0, 0, 0, 0, 0, 0, 0]^\\top$。\n-   **投影**：这种局部化输入会投影到多个特征模态上。投影系数是 $u_k = v_k^\\top u = v_k[0]$，即第 $k$ 个特征向量的第一个分量。这会激励具有不同空间频率的模态。\n-   **谐振频率**：\n    -   $k=0$ ($\\lambda_0=0$): $f_{0, \\text{res}}=10$ Hz (Alpha)。\n    -   $k=1,2$ ($\\lambda_{1,2}\\approx0.586$): $f_{1,2,\\text{res}} \\approx 10\\sqrt{1+8(0.586)} \\approx 23.8$ Hz (Beta)。\n    -   $k=3,4$ ($\\lambda_{3,4}=2.0$): $f_{3,4,\\text{res}} = 10\\sqrt{1+8(2)} = 10\\sqrt{17} \\approx 41.2$ Hz (Gamma)。\n    -   $k=5,6$ ($\\lambda_{5,6}\\approx3.414$): $f_{5,6,\\text{res}} \\approx 10\\sqrt{1+8(3.414)} \\approx 53.2$ Hz (Gamma)。\n    -   $k=7$ ($\\lambda_7=4.0$): $f_{7,\\text{res}} = 10\\sqrt{1+8(4)} = 10\\sqrt{33} \\approx 57.4$ Hz (Gamma)。\n-   **分类**：模态 $0$ 的谐振在α波段，并将主导α功率。谐振在γ波段的模态（$k=3,4,5,6,7$）将主要贡献于γ功率。特征值的简并性意味着对于每一对，特征求解器选择的特定基决定了投影 $u_k$。通常，一个简并对的一个特征向量的第一个分量非零，而另一个为零，从而集中了功率。\n    - 模态 $0$ 被分类为α。\n    - 谐振频率在 $40-60$ Hz 左右的模态将具有高γ功率和低α功率。那些具有显著投影的模态将通过阈值被分类为γ。数值计算显示这些是模态 $3, 5, 7$。\n-   **结果**：α模态：$[0]$，γ模态：$[3, 5, 7]$。\n\n#### 测试用例 3：交替输入\n-   **输入**：$u = [1, -1, 1, -1, 1, -1, 1, -1]^\\top$。\n-   **投影**：这种输入模式，即环上的最高可能频率的空间正弦波，与对应于最大特征值 $\\lambda_7=4.0$ 的特征向量 $v_7$ 平行。因此，对于 $k \\neq 7$，$u_k = 0$。\n-   **谐振频率**：对于模态 $k=7$，$\\lambda_7=4.0$，所以谐振频率是 $f_{7, \\text{res}} \\approx 57.4$ Hz。\n-   **分类**：$57.4$ Hz 的谐振在γ波段（$30-80$ Hz）内。$P_{\\gamma}(7)$ 将会很大，而 $P_{\\alpha}(7)$ 将会很小。对于模态 $7$，γ表达的分类规则得到满足。没有其他模态被激励。\n-   **结果**：α模态：$[]$，γ模态：$[7]$。",
            "answer": "[[[0],[]],[[0],[3,5,7]],[[],[7]]]"
        }
    ]
}