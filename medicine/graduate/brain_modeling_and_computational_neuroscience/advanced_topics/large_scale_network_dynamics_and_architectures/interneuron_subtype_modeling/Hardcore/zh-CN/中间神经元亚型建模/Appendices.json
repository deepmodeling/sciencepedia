{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的神经元网络模型之前，我们必须首先掌握单个神经元如何整合突触输入的基本原理。本练习将引导你运用经典的被动电缆理论，通过解析推导来探索抑制性突触的位置如何影响其在胞体处产生的“分流”效应。理解这一位置依赖性是阐明不同中间神经元亚型（例如，靶向树突的SST神经元与靶向胞体的PV神经元）功能差异的关键一步。",
            "id": "3991831",
            "problem": "考虑一个被动的、半无限长的树突电缆模型，该模型用于模拟主神经元的树突。电缆沿 $x \\geq 0$ 延伸，胞体位于 $x=0$ 的边界处。该电缆遵循线性、稳态、欧姆性膜物理学：单位长度的轴向电流为 $I_{a}(x) = -\\frac{1}{r_{a}} \\frac{dV}{dx}$，单位长度的膜电流为 $I_{m}(x) = g_{m} V(x)$，其中 $r_{a}$ 是单位长度的轴向电阻，$g_{m}$ 是单位长度的膜电导，$V(x)$ 是相对于静息电位的膜电位。空间常数为 $\\lambda = \\sqrt{\\frac{r_{m}}{r_{a}}}$，其中 $r_{m} = \\frac{1}{g_{m}}$。胞体被建模为 $x=0$ 处的驱动点，一个外部施加的稳恒电流 $I_{0}$ 从此处注入电缆；胞体处的输入电阻定义为 $R_{\\mathrm{in}} = \\frac{V(0)}{I_{0}}$。\n\n一个中间神经元上的GABA能（γ-氨基丁酸）突触在树突上的位置 $x$ 处施加一个局部旁路，该旁路被建模为一个附加的点电导 $g_{s}$，连接到地线，并添加到电缆在该位置 $x$ 的膜上。这个局域化的电导在该点产生一个额外的汇电流 $I_{s} = g_{s} V(x)$。\n\n从电缆的电流守恒和稳态线性膜行为（无电容效应）出发，推导在半无限长电缆上的位置 $x$ 处增加点电导 $g_{s}$ 所引起的胞体输入电阻变化量 $\\Delta R_{\\mathrm{in}}(x)$ 的精确表达式。用 $r_{a}$、$\\lambda$、$g_{s}$ 和 $x$ 表示你的答案。为 $\\Delta R_{\\mathrm{in}}(x)$ 提供一个单一的、闭式解析表达式。不需要进行数值代入。最终答案必须是一个单一的解析表达式；不要在最终的方框表达式中包含单位。",
            "solution": "问题要求计算当一个旁路电导 $g_s$ 被添加到距离胞体 $x$ 处时，半无限长树突电缆的胞体输入电阻变化量 $\\Delta R_{\\mathrm{in}}(x)$。推导过程主要分为三个阶段：首先，我们确定没有旁路时电缆的输入电阻；其次，我们计算存在旁路时的输入电阻；最后，我们计算这两个值之间的差。\n\n首先，我们建立稳态下膜电位 $V(x)$ 的控制方程。电缆中的电流守恒定律规定，轴向电流 $I_a$ 随位置的变化必须与单位长度上流过膜的电流 $I_m$ 相平衡。用数学形式表示为：\n$$\n\\frac{dI_a}{dx} = -I_m(x)\n$$\n问题给出了这些电流的线性欧姆关系：\n$$\nI_{a}(x) = -\\frac{1}{r_{a}} \\frac{dV}{dx} \\quad \\text{和} \\quad I_{m}(x) = g_{m} V(x)\n$$\n其中 $r_a$ 是单位长度的轴向电阻，$g_m$ 是单位长度的膜电导。将这些关系代入守恒定律，得到：\n$$\n\\frac{d}{dx}\\left(-\\frac{1}{r_{a}} \\frac{dV}{dx}\\right) = -g_{m} V(x)\n$$\n$$\n\\frac{d^2V}{dx^2} = r_a g_m V(x)\n$$\n使用定义 $r_m = 1/g_m$ 和空间常数 $\\lambda = \\sqrt{r_m/r_a}$，我们可以将项 $r_a g_m$ 重写为 $r_a/r_m = 1/\\lambda^2$。因此，稳态电缆方程为：\n$$\n\\lambda^2 \\frac{d^2V}{dx^2} - V(x) = 0\n$$\n这个二阶常微分方程的通解是 $V(x) = C_1 \\exp(x/\\lambda) + C_2 \\exp(-x/\\lambda)$。\n\n现在，我们计算基准输入电阻 $R_{\\mathrm{in, baseline}}$。对于从 $x=0$ 延伸至 $x \\to \\infty$ 的半无限长电缆，我们必须有一个物理上现实的解，即在远离电流注入点的地方，电位衰减至静息电位（$V=0$）。这要求当 $x \\to \\infty$ 时 $V(x) \\to 0$，从而设定系数 $C_1 = 0$。因此，电位的形式为：\n$$\nV(x) = C_2 \\exp(-x/\\lambda)\n$$\n常数 $C_2$ 由胞体（$x=0$）处的边界条件确定，在该点注入电流 $I_0$。此电流必须等于在该点进入电缆的轴向电流：\n$$\nI_0 = I_a(0) = -\\frac{1}{r_a} \\frac{dV}{dx}\\bigg|_{x=0}\n$$\n其导数为 $\\frac{dV}{dx} = - \\frac{C_2}{\\lambda} \\exp(-x/\\lambda)$。在 $x=0$ 处，导数为 $-\\frac{C_2}{\\lambda}$。\n$$\nI_0 = -\\frac{1}{r_a} \\left(-\\frac{C_2}{\\lambda}\\right) = \\frac{C_2}{r_a \\lambda} \\implies C_2 = I_0 r_a \\lambda\n$$\n电压分布为 $V(x) = I_0 r_a \\lambda \\exp(-x/\\lambda)$。胞体电位为 $V(0) = I_0 r_a \\lambda$。\n输入电阻定义为 $R_{\\mathrm{in}} = V(0)/I_0$。因此，基准输入电阻为：\n$$\nR_{\\mathrm{in, baseline}} = \\frac{I_0 r_a \\lambda}{I_0} = r_a \\lambda\n$$\n\n接下来，我们计算在位置 $x_s  0$ 处存在旁路电导 $g_s$ 时的输入电阻。电缆现在被分为两个区域：区域1（$0 \\le x  x_s$）和区域2（$x \\ge x_s$）。电缆方程在两个区域都成立，但积分常数不同。\n对于区域1，$0 \\le x  x_s$：$V_1(x) = A_1 \\exp(x/\\lambda) + B_1 \\exp(-x/\\lambda)$。\n对于区域2，$x \\ge x_s$：$V_2(x) = A_2 \\exp(-x/\\lambda)$，因为当 $x \\to \\infty$ 时 $V_2(x) \\to 0$。\n\n我们应用边界条件和匹配条件来求解系数 $A_1$、$B_1$ 和 $A_2$。\n1. 胞体处的电流注入（$x=0$）：$I_0 = -\\frac{1}{r_a} \\frac{dV_1}{dx}|_{x=0} = -\\frac{1}{r_a} \\frac{A_1 - B_1}{\\lambda}$，得到 $B_1 - A_1 = I_0 r_a \\lambda$。\n2. 旁路处电位连续（$x=x_s$）：$V_1(x_s) = V_2(x_s)$，得到 $A_1 \\exp(x_s/\\lambda) + B_1 \\exp(-x_s/\\lambda) = A_2 \\exp(-x_s/\\lambda)$。\n3. 旁路处电流守恒（$x=x_s$）：从左侧到达的轴向电流等于继续向右的轴向电流与通过旁路损失的电流之和。\n$I_a(x_s^-) = I_a(x_s^+) + I_s(x_s)$。\n$-\\frac{1}{r_a} \\frac{dV_1}{dx}|_{x_s} = -\\frac{1}{r_a} \\frac{dV_2}{dx}|_{x_s} + g_s V_1(x_s)$。\n这等效于电位导数的不连续性：$\\frac{dV_2}{dx}|_{x_s} - \\frac{dV_1}{dx}|_{x_s} = r_a g_s V(x_s)$。\n代入导数，得到：\n$-\\frac{A_2}{\\lambda}\\exp(-x_s/\\lambda) - \\left(\\frac{A_1}{\\lambda}\\exp(x_s/\\lambda) - \\frac{B_1}{\\lambda}\\exp(-x_s/\\lambda)\\right) = r_a g_s (A_2 \\exp(-x_s/\\lambda))$。\n乘以 $-\\lambda$ 得到：$A_1\\exp(x_s/\\lambda) - B_1\\exp(-x_s/\\lambda) = -A_2\\exp(-x_s/\\lambda) (1 + r_a \\lambda g_s)$。\n\n现在我们求解这个三元线性方程组以得到这些系数。将条件2和3的方程相加：\n$2A_1\\exp(x_s/\\lambda) = A_2\\exp(-x_s/\\lambda) - A_2\\exp(-x_s/\\lambda)(1+r_a\\lambda g_s) = -A_2\\exp(-x_s/\\lambda)r_a\\lambda g_s$。\n$A_1 = -\\frac{1}{2} A_2 r_a \\lambda g_s \\exp(-2x_s/\\lambda)$。\n将条件3的方程从条件2的方程中减去：\n$2B_1\\exp(-x_s/\\lambda) = A_2\\exp(-x_s/\\lambda) + A_2\\exp(-x_s/\\lambda)(1+r_a\\lambda g_s) = A_2\\exp(-x_s/\\lambda)(2+r_a\\lambda g_s)$。\n$B_1 = \\frac{1}{2} A_2 (2+r_a\\lambda g_s)$。\n\n将 $A_1$ 和 $B_1$ 代入条件1的方程中：\n$\\frac{1}{2} A_2 (2+r_a\\lambda g_s) - (-\\frac{1}{2} A_2 r_a \\lambda g_s \\exp(-2x_s/\\lambda)) = I_0 r_a \\lambda$。\n$\\frac{A_2}{2} (2 + r_a\\lambda g_s + r_a\\lambda g_s \\exp(-2x_s/\\lambda)) = I_0 r_a \\lambda$。\n$A_2 = \\frac{2 I_0 r_a \\lambda}{2 + r_a\\lambda g_s (1+\\exp(-2x_s/\\lambda))}$。\n\n胞体电位为 $V_1(0) = A_1 + B_1$。\n$V_1(0) = -\\frac{1}{2} A_2 r_a \\lambda g_s \\exp(-2x_s/\\lambda) + \\frac{1}{2} A_2 (2+r_a\\lambda g_s) = \\frac{A_2}{2} (2 + r_a\\lambda g_s(1-\\exp(-2x_s/\\lambda)))$。\n代入 $A_2$：\n$V_1(0) = \\frac{I_0 r_a \\lambda}{2 + r_a\\lambda g_s (1+\\exp(-2x_s/\\lambda))} \\times (2 + r_a\\lambda g_s(1-\\exp(-2x_s/\\lambda)))$。\n旁路存在时的输入电阻 $R_{\\mathrm{in, shunted}}(x_s) = V_1(0)/I_0$ 为：\n$$\nR_{\\mathrm{in, shunted}}(x_s) = r_a \\lambda \\frac{2 + r_a\\lambda g_s(1-\\exp(-2x_s/\\lambda))}{2 + r_a\\lambda g_s(1+\\exp(-2x_s/\\lambda))}\n$$\n最后，我们计算输入电阻的变化量 $\\Delta R_{\\mathrm{in}}(x) = R_{\\mathrm{in, shunted}}(x) - R_{\\mathrm{in, baseline}}$。根据题目要求，我们用 $x$ 表示位置。\n$$\n\\Delta R_{\\mathrm{in}}(x) = r_a \\lambda \\left[ \\frac{2 + r_a\\lambda g_s(1-\\exp(-2x/\\lambda))}{2 + r_a\\lambda g_s(1+\\exp(-2x/\\lambda))} - 1 \\right]\n$$\n$$\n\\Delta R_{\\mathrm{in}}(x) = r_a \\lambda \\left[ \\frac{2 + r_a\\lambda g_s - r_a\\lambda g_s\\exp(-2x/\\lambda) - (2 + r_a\\lambda g_s + r_a\\lambda g_s\\exp(-2x/\\lambda))}{2 + r_a\\lambda g_s(1+\\exp(-2x/\\lambda))} \\right]\n$$\n$$\n\\Delta R_{\\mathrm{in}}(x) = r_a \\lambda \\left[ \\frac{-2 r_a\\lambda g_s\\exp(-2x/\\lambda)}{2 + r_a\\lambda g_s(1+\\exp(-2x/\\lambda))} \\right]\n$$\n$$\n\\Delta R_{\\mathrm{in}}(x) = - \\frac{2 (r_a \\lambda)^2 g_s \\exp(-2x/\\lambda)}{2 + r_a\\lambda g_s(1+\\exp(-2x/\\lambda))}\n$$\n这就是由于旁路引起的胞体输入电阻变化的最终闭式表达式。",
            "answer": "$$\\boxed{- \\frac{2 {(r_a \\lambda)}^{2} g_s \\exp(-2x/\\lambda)}{2 + r_a \\lambda g_s (1+\\exp(-2x/\\lambda))}}$$"
        },
        {
            "introduction": "基于前一个练习建立的解析性直觉，我们现在将这些原理应用于一个更接近生物学现实的数值模型中。本练习将理论从连续的电缆方程转化为离散的、多区域的房室模型，这是现代神经元模拟（如NEURON软件包）的核心。你将通过编写代码来量化突触输入的电紧张距离如何改变其对胞体的影响，从而在实际的计算情境中具体化信号衰减的抽象概念。",
            "id": "3991811",
            "problem": "您的任务是，在一个简化的但基于真实形态学的皮层中间神经元多房室模型中，评估位置依赖的电紧张效应。这些房室包括胞体、一个近端树突、一个连接在近端树突上的远端树突，以及轴突起始段 (AIS)。目标是利用被动电缆理论和线性电路分析的基本原理，量化当在这些房室之一打开一个相同电导时，胞体膜电位变化的差异。\n\n基本依据与假设：从基尔霍夫电流定律 (KCL)、线性被动膜理论以及电阻网络的直流稳态分析出发。假设存在一个恒定的膜泄漏，由单位面积特定泄漏电导 $g_L$ 和泄漏反转电位 $E_L$ 描述。细胞质的电阻率为 $R_a$。每个房室都有一个接地的膜泄漏电导（接地设定为 $E_L$，因此在方程中 $E_L$ 表示为 $0$），并通过根据几何形状和 $R_a$ 推导出的轴向电导与其相邻房室耦合。每次在一个房室中打开一个相同的类突触电导 $g_{\\text{syn}}$，该电导连接到一个反转电位 $E_{\\text{syn}}$（相对于 $E_L$ 测量）。由于需要的是稳态响应，因此忽略了电容性成分。\n\n模型结构：模型包含 $4$ 个节点，索引为 $0,1,2,3$，分别代表胞体 ($0$)、近端树突 ($1$)、远端树突 ($2$) 和轴突起始段 (AIS) ($3$)。节点 $i$ 的泄漏电导为 $G_{L,i} = g_L A_i$，其中 $A_i$ 是房室的膜面积。胞体面积建模为半径为 $r_{\\text{soma}}$ 的球体，其面积为 $A_{\\text{soma}} = 4\\pi r_{\\text{soma}}^2$。树突和 AIS 的面积建模为圆柱体，其面积为 $A = 2\\pi r L$。相邻节点之间的轴向耦合电导计算为房室中心之间串联轴向电阻的倒数。具体而言，胞体和近端树突之间的轴向电阻为\n$$\nR_{\\text{ax},\\,\\text{soma-prox}} = R_a \\frac{r_{\\text{soma}}}{\\pi r_{\\text{soma}}^2} + R_a \\frac{L_{\\text{prox}}/2}{\\pi r_{\\text{prox}}^2},\n$$\n近端和远端树突之间的轴向电阻为\n$$\nR_{\\text{ax},\\,\\text{prox-dist}} = R_a \\frac{L_{\\text{prox}}/2}{\\pi r_{\\text{prox}}^2} + R_a \\frac{L_{\\text{dist}}/2}{\\pi r_{\\text{dist}}^2},\n$$\n以及胞体和 AIS 之间的轴向电阻为\n$$\nR_{\\text{ax},\\,\\text{soma-AIS}} = R_a \\frac{r_{\\text{soma}}}{\\pi r_{\\text{soma}}^2} + R_a \\frac{L_{\\text{AIS}}/2}{\\pi r_{\\text{AIS}}^2}.\n$$\n每个连接的相应轴向电导为 $G_{\\text{ax}} = 1 / R_{\\text{ax}}$。\n\n稳态节点方程：设相对于 $E_L$ 的节点电压向量为 $\\mathbf{V} = [V_0, V_1, V_2, V_3]^T$，并通过在每个节点应用 KCL 来定义电导矩阵 $\\mathbf{A}$：\n$$\nA_{ii} = G_{L,i} + \\sum_{j \\in \\mathcal{N}(i)} G_{\\text{ax},ij} + \\delta_{i,k} g_{\\text{syn}}, \\quad A_{ij} = -G_{\\text{ax},ij} \\text{ for } i \\neq j,\n$$\n其中 $\\mathcal{N}(i)$ 是与节点 $i$ 轴向连接的邻居集合，$k$ 是打开突触电导的节点的索引。源向量 $\\mathbf{b}$ 中，$b_k = g_{\\text{syn}} E_{\\text{syn}}$，其他位置为零。通过求解\n$$\n\\mathbf{A} \\mathbf{V} = \\mathbf{b}\n$$\n可获得稳态解。\n\n您的任务：对于下面的每个测试用例，分别计算当 $g_{\\text{syn}}$ 在胞体、近端树突、远端树突和 AIS 处打开时，胞体电压变化 $V_0$（以毫伏为单位）。使用几何形状计算面积和轴向电阻，将 $E_L$ 设为地（$0$），并使用提供的常数。以毫伏表示所有最终电压，并四舍五入到六位小数。\n\n除非另有说明，所有测试用例的通用常数如下：\n- $g_L = 0.1 \\text{ mS/cm}^2$ (即 $g_L = 1\\times 10^{-4} \\text{ S/cm}^2$)。\n- $g_{\\text{syn}} = 1 \\text{ nS}$ (即 $g_{\\text{syn}} = 1\\times 10^{-9} \\text{ S}$)。\n- $E_{\\text{syn}} = 65 \\text{ mV}$ (即 $E_{\\text{syn}} = 0.065 \\text{ V}$，高于 $E_L$)。\n- 在模型中通过选择接地，将 $E_L$ 视为 $0 \\text{ V}$。\n- 细胞质电阻率 $R_a$ 在每个测试用例中指定。\n- 所有形态学尺寸均以微米为单位提供，计算时必须使用 $1 \\text{ cm} = 10{,}000 \\text{ }\\mu\\text{m}$ 转换为厘米。\n\n测试套件（每个用例是一个元组 $(r_{\\text{soma}}, r_{\\text{prox}}, L_{\\text{prox}}, r_{\\text{dist}}, L_{\\text{dist}}, r_{\\text{AIS}}, L_{\\text{AIS}}, R_a)$，所有半径 $r$ 和长度 $L$ 的单位为 $\\mu\\text{m}$，$R_a$ 的单位为 $\\Omega\\cdot\\text{cm}$）：\n1. 用例 $1$ (标准形态)：$(10, 1.2, 120, 0.8, 300, 0.7, 50, 150)$。\n2. 用例 $2$ (极长远端树突)：$(9, 1.0, 80, 0.6, 1000, 0.7, 40, 150)$。\n3. 用例 $3$ (高轴向电阻率)：$(11, 1.1, 150, 0.9, 350, 0.6, 45, 200)$。\n4. 用例 $4$ (微小 AIS)：$(10, 1.0, 100, 0.7, 250, 0.2, 30, 150)$。\n\n输出规格：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身是一个包含四个浮点数（单位为毫伏）的列表，顺序为 $[V_0^{\\text{soma}}, V_0^{\\text{prox}}, V_0^{\\text{dist}}, V_0^{\\text{AIS}}]$。例如，打印输出必须类似于\n`[ [v11, v12, v13, v14], [v21, v22, v23, v24], [v31, v32, v33, v34], [v41, v42, v43, v44] ]`\n其中每个 $v_{ij}$ 都四舍五入到六位小数，并以 $\\text{mV}$ 为单位表示为十进制数。不应打印任何额外文本。",
            "solution": "该问题要求在一个四房室神经元模型中，计算响应在不同位置打开的突触电导时所产生的稳态胞体膜电位变化。这是计算神经科学中的一个经典问题，可以通过线性电路分析来解决，具体方法是在直流 (DC) 稳态条件下，对每个房室（节点）应用基尔霍夫电流定律 (KCL)。\n\n该模型包含四个节点：胞体（索引 $0$）、近端树突（索引 $1$）、远端树突（索引 $2$）和轴突起始段 (AIS)（索引 $3$）。连接性如下：胞体连接到近端树突和 AIS。近端树突连接到胞体和远端树突。电路图可以可视化为一个中央胞体节点 ($0$) 连接到两个分支，一个分支通向近端然后是远端树突 ($0 \\leftrightarrow 1 \\leftrightarrow 2$)，另一个分支通向 AIS ($0 \\leftrightarrow 3$)。\n\n在稳态下，流出每个节点的电流总和必须为零。这些电流包括通过膜的泄漏电流、流向相邻房室的轴向电流和突触电流。通过将泄漏反转电位 $E_L$ 设置为接地参考点 ($0 \\text{ V}$)，KCL 方程构成一个线性方程组 $\\mathbf{A} \\mathbf{V} = \\mathbf{b}$，其中 $\\mathbf{V} = [V_0, V_1, V_2, V_3]^T$ 是每个节点相对于静息电位的稳态电压偏转向量。\n\n为每个测试用例求解 $\\mathbf{V}$ 的过程步骤如下：\n\n1.  **单位转换**：所有以微米 ($\\mu\\text{m}$) 为单位的形态学尺寸都使用转换因子 $1 \\text{ cm} = 10^4 \\text{ }\\mu\\text{m}$ 转换为厘米 ($\\text{cm}$)。所有电学参数均使用国际单位制基本单位（伏特、西门子、欧姆、库仑等），电导以西门子 ($S$) 计算，电阻以欧姆 ($\\Omega$) 计算。\n\n2.  **计算房室面积 ($A_i$):** 对于每个组分 $i$，根据其几何形状计算表面积 $A_i$。设转换后以 $\\text{cm}$ 为单位的半径和长度用撇号表示（例如，$r'_{\\text{soma}}$）。\n    - 胞体（球体，$i=0$）：$A_0 = 4\\pi (r'_{\\text{soma}})^2$\n    - 近端树突（圆柱体，$i=1$）：$A_1 = 2\\pi r'_{\\text{prox}} L'_{\\text{prox}}$\n    - 远端树突（圆柱体，$i=2$）：$A_2 = 2\\pi r'_{\\text{dist}} L'_{\\text{dist}}$\n    - AIS（圆柱体，$i=3$）：$A_3 = 2\\pi r'_{\\text{AIS}} L'_{\\text{AIS}}$\n\n3.  **计算泄漏电导 ($G_{L,i}$):**\n    每个房室的被动泄漏电导是单位面积特定泄漏电导 $g_L = 1 \\times 10^{-4} \\text{ S/cm}^2$ 与房室表面积的乘积。\n    - $G_{L,i} = g_L A_i$ for $i \\in \\{0, 1, 2, 3\\}$。\n\n4.  **计算轴向电导 ($G_{\\text{ax},ij}$):**\n    两个相邻房室 $i$ 和 $j$ 之间的轴向电导是它们中心之间轴向电阻 $R_{\\text{ax},ij}$ 的倒数。电阻使用给定的公式和细胞质电阻率 $R_a$ 计算：\n    - 胞体 ($0$) 到近端树突 ($1$)：\n      $$R_{\\text{ax},01} = R_a \\left( \\frac{r'_{\\text{soma}}}{\\pi (r'_{\\text{soma}})^2} + \\frac{L'_{\\text{prox}}/2}{\\pi (r'_{\\text{prox}})^2} \\right) = R_a \\left( \\frac{1}{\\pi r'_{\\text{soma}}} + \\frac{L'_{\\text{prox}}}{2\\pi (r'_{\\text{prox}})^2} \\right)$$\n    - 近端树突 ($1$) 到远端树突 ($2$)：\n      $$R_{\\text{ax},12} = R_a \\left( \\frac{L'_{\\text{prox}}/2}{\\pi (r'_{\\text{prox}})^2} + \\frac{L'_{\\text{dist}}/2}{\\pi (r'_{\\text{dist}})^2} \\right)$$\n    - 胞体 ($0$) 到 AIS ($3$)：\n      $$R_{\\text{ax},03} = R_a \\left( \\frac{r'_{\\text{soma}}}{\\pi (r'_{\\text{soma}})^2} + \\frac{L'_{\\text{AIS}}/2}{\\pi (r'_{\\text{AIS}})^2} \\right) = R_a \\left( \\frac{1}{\\pi r'_{\\text{soma}}} + \\frac{L'_{\\text{AIS}}}{2\\pi (r'_{\\text{AIS}})^2} \\right)$$\n    相应的轴向电导为 $G_{\\text{ax},01} = 1/R_{\\text{ax},01}$、$G_{\\text{ax},12} = 1/R_{\\text{ax},12}$ 和 $G_{\\text{ax},03} = 1/R_{\\text{ax},03}$。\n\n5.  **构建方程组：**\n    对于突触电导 $g_{\\text{syn}}$ 的每个位置 $k \\in \\{0, 1, 2, 3\\}$，我们组装 $4 \\times 4$ 的电导矩阵 $\\mathbf{A}$ 和 $4 \\times 1$ 的源向量 $\\mathbf{b}$。\n\n    电导矩阵 $\\mathbf{A}$ 的元素由以下公式给出：\n    - 对角线元素：$A_{ii} = G_{L,i} + \\sum_{j \\in \\mathcal{N}(i)} G_{\\text{ax},ij} + \\delta_{i,k} g_{\\text{syn}}$\n    - 非对角线元素：如果节点 $i$ 和 $j$ 相连，则 $A_{ij} = -G_{\\text{ax},ij}$，否则 $A_{ij}=0$。\n    此处，$\\delta_{i,k}$ 是克罗内克 δ 函数，当 $i=k$ 时为 $1$，否则为 $0$。$\\mathcal{N}(i)$ 是节点 $i$ 的邻居集合。\n\n    具体来说，矩阵 $\\mathbf{A}$ 是：\n    $$\n    \\mathbf{A} =\n    \\begin{pmatrix}\n    G_{L,0} + G_{\\text{ax},01} + G_{\\text{ax},03}   -G_{\\text{ax},01}   0   -G_{\\text{ax},03} \\\\\n    -G_{\\text{ax},01}   G_{L,1} + G_{\\text{ax},01} + G_{\\text{ax},12}   -G_{\\text{ax},12}   0 \\\\\n    0   -G_{\\text{ax},12}   G_{L,2} + G_{\\text{ax},12}   0 \\\\\n    -G_{\\text{ax},03}   0   0   G_{L,3} + G_{\\text{ax},03}\n    \\end{pmatrix}\n    +\n    \\begin{pmatrix}\n    \\delta_{0,k}g_{\\text{syn}}   0   0   0 \\\\\n    0   \\delta_{1,k}g_{\\text{syn}}   0   0 \\\\\n    0   0   \\delta_{2,k}g_{\\text{syn}}   0 \\\\\n    0   0   0   \\delta_{3,k}g_{\\text{syn}}\n    \\end{pmatrix}\n    $$\n    源向量 $\\mathbf{b}$ 有一个单个非零项，对应于节点 $k$ 处的突触电流源：\n    $$ b_i = \\delta_{i,k} g_{\\text{syn}} E_{\\text{syn}} $$\n    其中 $g_{\\text{syn}} = 1 \\times 10^{-9} \\text{ S}$ 且 $E_{\\text{syn}} = 0.065 \\text{ V}$。\n\n6.  **求解电压并提取结果：**\n    求解线性系统 $\\mathbf{A} \\mathbf{V} = \\mathbf{b}$ 以获得电压向量 $\\mathbf{V}$。胞体电压变化是第一个元素 $V_0$。对每个突触位置 $k=0, 1, 2, 3$ 重复此计算。一个测试用例的最终结果是四个胞体电压的列表 $[V_{0,k=0}, V_{0,k=1}, V_{0,k=2}, V_{0,k=3}]$。这些值通过乘以 $1000$ 从伏特 (V) 转换为毫伏 (mV)，然后按要求四舍五入到六位小数。对所有四个测试用例重复整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the result.\n    \"\"\"\n    \n    # Define constants\n    G_L_SPECIFIC = 1e-4  # S/cm^2 (0.1 mS/cm^2)\n    G_SYN = 1e-9         # S (1 nS)\n    E_SYN = 0.065        # V (65 mV)\n    \n    # Each case is a tuple of (r_soma, r_prox, L_prox, r_dist, L_dist, r_AIS, L_AIS, Ra)\n    # Dimensions in um, Ra in Ohm*cm\n    test_cases = [\n        # Case 1 (canonical morphology)\n        (10, 1.2, 120, 0.8, 300, 0.7, 50, 150),\n        # Case 2 (very long distal dendrite)\n        (9, 1.0, 80, 0.6, 1000, 0.7, 40, 150),\n        # Case 3 (high axial resistivity)\n        (11, 1.1, 150, 0.9, 350, 0.6, 45, 200),\n        # Case 4 (tiny AIS)\n        (10, 1.0, 100, 0.7, 250, 0.2, 30, 150),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        case_results = compute_somatic_voltages(params, G_L_SPECIFIC, G_SYN, E_SYN)\n        all_results.append(case_results)\n\n    # Format output as a string representing a list of lists of floats\n    output_str = \"[\" + \", \".join([f\"[{', '.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\n\ndef compute_somatic_voltages(params, g_l, g_syn, e_syn):\n    \"\"\"\n    Computes the somatic voltage change for a single test case.\n    The synapse location is moved across the four compartments.\n    \"\"\"\n    r_soma, r_prox, l_prox, r_dist, l_dist, r_ais, l_ais, ra = params\n    \n    # Conversion factor from um to cm\n    um_to_cm = 1e-4\n\n    # Convert dimensions to cm\n    r_soma_cm = r_soma * um_to_cm\n    r_prox_cm = r_prox * um_to_cm\n    l_prox_cm = l_prox * um_to_cm\n    r_dist_cm = r_dist * um_to_cm\n    l_dist_cm = l_dist * um_to_cm\n    r_ais_cm = r_ais * um_to_cm\n    l_ais_cm = l_ais * um_to_cm\n\n    # 1. Calculate compartment areas (cm^2)\n    # Node 0: soma, 1: prox_dend, 2: dist_dend, 3: AIS\n    A_soma = 4 * np.pi * r_soma_cm**2\n    A_prox = 2 * np.pi * r_prox_cm * l_prox_cm\n    A_dist = 2 * np.pi * r_dist_cm * l_dist_cm\n    A_ais  = 2 * np.pi * r_ais_cm * l_ais_cm\n    \n    # 2. Calculate leak conductances (S)\n    G_L_soma = g_l * A_soma\n    G_L_prox = g_l * A_prox\n    G_L_dist = g_l * A_dist\n    G_L_ais  = g_l * A_ais\n\n    # 3. Calculate axial conductances (S)\n    pi = np.pi\n    R_ax_01 = ra * (1 / (pi * r_soma_cm) + (l_prox_cm / 2) / (pi * r_prox_cm**2))\n    R_ax_12 = ra * ((l_prox_cm / 2) / (pi * r_prox_cm**2) + (l_dist_cm / 2) / (pi * r_dist_cm**2))\n    R_ax_03 = ra * (1 / (pi * r_soma_cm) + (l_ais_cm / 2) / (pi * r_ais_cm**2))\n\n    G_ax_01 = 1 / R_ax_01\n    G_ax_12 = 1 / R_ax_12\n    G_ax_03 = 1 / R_ax_03\n\n    # 4. Construct the base conductance matrix (before adding g_syn)\n    A_base = np.zeros((4, 4))\n    \n    # Diagonal elements\n    A_base[0, 0] = G_L_soma + G_ax_01 + G_ax_03\n    A_base[1, 1] = G_L_prox + G_ax_01 + G_ax_12\n    A_base[2, 2] = G_L_dist + G_ax_12\n    A_base[3, 3] = G_L_ais  + G_ax_03\n\n    # Off-diagonal elements\n    A_base[0, 1] = A_base[1, 0] = -G_ax_01\n    A_base[1, 2] = A_base[2, 1] = -G_ax_12\n    A_base[0, 3] = A_base[3, 0] = -G_ax_03\n    \n    somatic_voltages = []\n\n    # 5. Solve for each synapse location k\n    for k in range(4): # k = 0 (soma), 1 (prox), 2 (dist), 3 (AIS)\n        # Construct A and b for current location k\n        A = A_base.copy()\n        A[k, k] += g_syn\n        \n        b = np.zeros(4)\n        b[k] = g_syn * e_syn\n        \n        # Solve the system AV = b\n        V = np.linalg.solve(A, b)\n        \n        # Extract somatic voltage, convert to mV, round, and append\n        v0_mv = V[0] * 1000\n        somatic_voltages.append(round(v0_mv, 6))\n\n    return somatic_voltages\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了单个神经元整合输入的方式后，我们便可以探究不同类型的中间神经元如何共同塑造网络层面的活动。本练习模拟了一个包含小白蛋白（Parvalbumin, $\\mathrm{PV}$）和生长抑素（Somatostatin, $\\mathrm{SST}$）两种主要中间神经元亚型的皮层微环路。通过模拟对每种亚型的光遗传学激活，你将研究它们在产生和调节伽马振荡（一种关键的脑节律）中的独特贡献，这直接对应了计算神经科学中模拟现代实验技术以揭示环路功能的方法。",
            "id": "3991795",
            "problem": "您的任务是为一个锥体-中间神经元网络伽马 (PING) 回路构建并分析一个小型神经元集群模型。该模型增加了两种抑制性中间神经元亚型：表达小清蛋白 ($\\mathrm{PV}$) 的神经元和表达生长抑素 ($\\mathrm{SST}$) 的神经元。目标是定量预测针对 $\\mathrm{PV}$ 与 $\\mathrm{SST}$ 群体的细胞类型特异性光遗传驱动如何改变伽马振荡的频率和功率。\n\n从膜电流平衡和突触滤波推导出的放电率公式出发，考虑一个具有突触滤波状态的三群体放电率模型，该模型近似有限的突触动力学。设兴奋性锥体细胞群体的放电率为 $E(t)$，$\\mathrm{PV}$ 抑制性群体的放电率为 $I(t)$，$\\mathrm{SST}$ 抑制性群体的放电率为 $S(t)$。设 $G_{\\mathrm{pv}}(t)$ 和 $G_{\\mathrm{sst}}(t)$ 为经过滤波的抑制性突触变量，它们以不同的动力学特性介导对兴奋性群体的抑制作用。其动力学方程如下：\n$$\n\\tau_E \\frac{dE}{dt} = -E + \\sigma_E\\!\\left( w_{EE} E - w_{EI} G_{\\mathrm{pv}} - w_{ES} G_{\\mathrm{sst}} + P \\right),\n$$\n$$\n\\tau_{\\mathrm{pv}} \\frac{dI}{dt} = -I + \\sigma_I\\!\\left( w_{IE} E - w_{II} I + D_{\\mathrm{pv}} \\right),\n$$\n$$\n\\tau_{\\mathrm{sst}} \\frac{dS}{dt} = -S + \\sigma_S\\!\\left( w_{SE} E - w_{SI} S + D_{\\mathrm{sst}} \\right),\n$$\n$$\n\\tau_{G\\mathrm{pv}} \\frac{dG_{\\mathrm{pv}}}{dt} = -G_{\\mathrm{pv}} + I,\n\\qquad\n\\tau_{G\\mathrm{sst}} \\frac{dG_{\\mathrm{sst}}}{dt} = -G_{\\mathrm{sst}} + S,\n$$\n其中 $\\sigma_X(x)$ 是群体 $X \\in \\{E, I, S\\}$ 的 S 型输入-输出函数，定义为\n$$\n\\sigma_X(x) = \\frac{1}{1 + \\exp\\!\\left( -a_X \\left( x - \\theta_X \\right) \\right)},\n$$\n其中 $a_X$ 是斜率参数，$\\theta_X$ 是阈值。符号 $w_{EE}, w_{EI}, w_{ES}, w_{IE}, w_{II}, w_{SE}, w_{SI}$ 表示耦合强度，$\\tau_E, \\tau_{\\mathrm{pv}}, \\tau_{\\mathrm{sst}}, \\tau_{G\\mathrm{pv}}, \\tau_{G\\mathrm{sst}}$ 表示时间常数（单位为秒），$P$ 是持续的外部兴奋性驱动，$D_{\\mathrm{pv}}$ 和 $D_{\\mathrm{sst}}$ 分别是施加于 $\\mathrm{PV}$ 和 $\\mathrm{SST}$ 抑制性群体的恒定光遗传驱动。所有放电率和 $\\sigma_X$ 的输出都是在区间 $[0,1]$ 内的无量纲值。光遗传驱动 $D_{\\mathrm{pv}}$ 和 $D_{\\mathrm{sst}}$ 是无量纲输入，它们分别改变 $\\mathrm{PV}$ 和 $\\mathrm{SST}$ 群体的放电率。\n\n使用的基本假设和定义：\n- 群体层面的膜方程产生了一阶低通动力学，其速率具有特征时间常数，这为每个群体采用 $\\tau \\frac{dr}{dt} = -r + \\sigma(\\cdot)$ 的形式提供了依据，其中 $\\sigma(\\cdot)$ 是一个静态非线性函数，代表了源于动作电位产生的生物物理学的 S 型放电率-电流关系。\n- 突触电流由一阶动力学进行滤波，这促使我们引入辅助变量 $G_{\\mathrm{pv}}(t)$ 和 $G_{\\mathrm{sst}}(t)$，它们具有不同的抑制性动力学，能引入对振荡至关重要的相移。\n- PING 中的伽马振荡源于循环的兴奋-抑制环路动力学，其中包含较快的 $\\mathrm{PV}$ 抑制和较慢的 $\\mathrm{SST}$ 抑制。振荡频率可通过 $E(t)$ 在伽马频段的主导谱峰进行量化。\n- 以均匀间隔 $\\Delta t$ 采样的时间序列 $x(t)$ 的离散傅里叶变换在 $f_k = \\frac{k}{N \\Delta t}$ 处产生频率分量，其中 $k \\in \\{0,1,\\dots,\\lfloor N/2 \\rfloor\\}$，功率谱密度可以估计为 $|X_k|^2$，其中 $X_k$ 是傅里叶系数。\n\n您的程序必须实现上述系统，对其进行确定性模拟，并按如下方式计算伽马频率和功率：\n- 使用数值稳定的方法（例如，四阶龙格-库塔法），从初始条件 $E(0)=0.1$, $I(0)=0.1$, $S(0)=0.1$, $G_{\\mathrm{pv}}(0)=0.0$, $G_{\\mathrm{sst}}(0)=0.0$ 开始，以固定的步长 $\\Delta t = 0.0005$ 秒模拟系统，总时长为 $T = 3.0$ 秒。\n- 在舍弃 1.0 秒的初始瞬态过程后，计算 $E(t)$ 在剩余时间窗口内的离散傅里叶变换。将频率（单位：赫兹，$\\mathrm{Hz}$）估计为伽马频段（$30$ 到 $80$ 赫兹）内最大谱峰的位置。如果该频段内的最大峰值在数值上为零（例如，由于谱是平坦的），则返回频率为 $0.0$ 赫兹。\n- 将伽马功率定义为该频率下的峰值功率值，并用伽马频段内的总功率进行归一化。这将得到一个在 $[0,1]$ 区间内的无量纲分数。如果伽马频段的总功率在数值上为零，则返回伽马功率为 $0.0$。\n\n使用以下固定的、在生理学上对皮层微回路 plausible 的参数：\n- 时间常数：$\\tau_E = 0.020$ 秒, $\\tau_{\\mathrm{pv}} = 0.010$ 秒, $\\tau_{\\mathrm{sst}} = 0.040$ 秒, $\\tau_{G\\mathrm{pv}} = 0.005$ 秒, $\\tau_{G\\mathrm{sst}} = 0.020$ 秒。\n- Sigmoid 参数：$a_E = 4.0$, $a_I = 4.0$, $a_S = 4.0$, $\\theta_E = 0.5$, $\\theta_I = 0.3$, $\\theta_S = 0.3$。\n- 耦合强度：$w_{EE} = 12.0$, $w_{EI} = 15.0$, $w_{ES} = 6.0$, $w_{IE} = 15.0$, $w_{II} = 4.0$, $w_{SE} = 8.0$, $w_{SI} = 3.0$。\n- 持续兴奋性驱动：$P = 1.0$。\n\n构建一个测试套件，探究 $\\mathrm{PV}$ 与 $\\mathrm{SST}$ 的光遗传激活如何改变伽马振荡。请精确使用以下五个测试案例，以有序对 $(D_{\\mathrm{pv}}, D_{\\mathrm{sst}})$ 给出：\n- 案例 1：$(0.0, 0.0)$ 无光遗传驱动的基线。\n- 案例 2：$(0.3, 0.0)$ 中等强度的 $\\mathrm{PV}$ 激活。\n- 案例 3：$(0.0, 0.3)$ 中等强度的 $\\mathrm{SST}$ 激活。\n- 案例 4：$(0.8, 0.0)$ 强 $\\mathrm{PV}$ 激活。\n- 案例 5：$(0.0, 0.8)$ 强 $\\mathrm{SST}$ 激活。\n\n您的程序必须为每个测试案例计算两个量：以赫兹为单位的伽马频率和作为无量纲分数的归一化伽马功率。最终输出必须是单行，包含一个列表的列表，其中每个内部列表按上述顺序对应一个测试案例，并包含两个浮点数 $[f, p]$，其中 $f$ 的单位是赫兹，$p$ 是无量纲的。您的程序必须在输出中将每个浮点数四舍五入到 3 位小数。例如，输出格式必须完全如下所示\n`[[f1,p1],[f2,p2],[f3,p3],[f4,p4],[f5,p5]]`\n打印在单行上。\n\n以赫兹（$\\mathrm{Hz}$）为单位回答频率，以无量纲分数回答功率，每个值按要求四舍五入到 3 位小数。不应打印其他任何文本。",
            "solution": "此问题的解决方案分为两个主要阶段：首先，对描述三群体神经元网络动力学的五维耦合常微分方程(ODEs)系统进行数值模拟；其次，对模拟产生的兴奋性群体活动时间序列$E(t)$进行谱分析，以提取伽马振荡的频率和功率。\n\n### 1. 模型与数值积分\n\n系统的状态在任意时刻$t$由向量 $\\vec{y}(t) = [E(t), I(t), S(t), G_{\\mathrm{pv}}(t), G_{\\mathrm{sst}}(t)]^T$ 描述。其随时间的变化由问题中定义的ODE系统 $\\frac{d\\vec{y}}{dt} = \\vec{f}(\\vec{y}, t)$ 决定。\n\n我们将使用四阶龙格-库塔(RK4)方法来数值求解该系统。这是一种精确且稳定的方法，适用于此类非线性动力系统。给定时间$t_n$的状态$\\vec{y}_n$，下一个时间点$t_{n+1} = t_n + \\Delta t$的状态$\\vec{y}_{n+1}$按以下方式计算：\n$$\n\\vec{k}_1 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n)\n$$\n$$\n\\vec{k}_2 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\frac{1}{2}\\vec{k}_1)\n$$\n$$\n\\vec{k}_3 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\frac{1}{2}\\vec{k}_2)\n$$\n$$\n\\vec{k}_4 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\vec{k}_3)\n$$\n$$\n\\vec{y}_{n+1} = \\vec{y}_n + \\frac{1}{6}(\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\n该积分从$t=0$进行到$t=3.0$秒，步长为$\\Delta t=0.0005$秒，使用指定的初始条件。在整个模拟过程中，我们将记录兴奋性群体活动$E(t)$的时间序列以供后续分析。\n\n### 2. 谱分析\n\n为了分析网络的稳态振荡行为，我们舍弃模拟开始后的前1.0秒数据，以排除初始条件引起的瞬态效应。分析将在剩余的2.0秒数据上进行。\n\n1.  **离散傅里叶变换 (DFT)**：我们使用高效的快速傅里叶变换(FFT)算法来计算兴奋性活动$E(t)$的DFT。这将时域信号转换为其频域表示，使我们能够识别出主导的振荡频率。\n\n2.  **功率谱**：功率谱密度(PSD)通过计算DFT系数的模平方得到，它表示信号在每个频率分量上的功率。由于输入信号是实数，我们只关注正频率部分。\n\n3.  **伽马频段分析**：我们筛选出功率谱中频率在30赫兹到80赫兹之间的部分，因为这是伽马振荡的典型范围。\n\n4.  **峰值频率**：在筛选出的伽马频段内，我们找到功率最大的频率。该频率即为所求的伽马振荡频率。如果该频段内没有显著的功率峰值（即功率在数值上为零），则频率为0.0赫兹。\n\n5.  **归一化功率**：归一化伽马功率被定义为峰值频率处的功率与伽马频段内总功率的比值。这个度量量化了主导振荡的强度或“节律性”。如果伽马频段的总功率为零，则归一化功率也为零。\n\n### 3. 实现\n\n上述模拟和分析过程将对五个测试案例中的每一个重复执行，每个案例对应一对不同的光遗传驱动参数$(D_{\\mathrm{pv}}, D_{\\mathrm{sst}})$。最终，我们将收集每个案例计算出的频率和归一化功率，并按照问题指定的格式进行输出，每个数值四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PING model problem by simulating the ODEs and analyzing the output.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    params = {\n        'tau_E': 0.020, 'tau_pv': 0.010, 'tau_sst': 0.040,\n        'tau_Gpv': 0.005, 'tau_Gsst': 0.020,\n        'a_E': 4.0, 'a_I': 4.0, 'a_S': 4.0,\n        'theta_E': 0.5, 'theta_I': 0.3, 'theta_S': 0.3,\n        'w_EE': 12.0, 'w_EI': 15.0, 'w_ES': 6.0,\n        'w_IE': 15.0, 'w_II': 4.0, 'w_SE': 8.0, 'w_SI': 3.0,\n        'P': 1.0,\n    }\n\n    # --- Simulation setup ---\n    T = 3.0  # Total simulation time in seconds\n    dt = 0.0005  # Time step in seconds\n    num_steps = int(T / dt)\n    transient_time = 1.0  # Time to discard in seconds\n    analysis_start_index = int(transient_time / dt)\n\n    # --- Test Cases ---\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Baseline\n        (0.3, 0.0),  # Case 2: Moderate PV activation\n        (0.0, 0.3),  # Case 3: Moderate SST activation\n        (0.8, 0.0),  # Case 4: Strong PV activation\n        (0.0, 0.8),  # Case 5: Strong SST activation\n    ]\n\n    # --- Helper Functions ---\n    def sigmoid(x, a, theta):\n        return 1.0 / (1.0 + np.exp(-a * (x - theta)))\n\n    def derivatives(y, D_pv, D_sst, p):\n        E, I, S, G_pv, G_sst = y\n        \n        dE_dt = (-E + sigmoid(p['w_EE'] * E - p['w_EI'] * G_pv - p['w_ES'] * G_sst + p['P'], p['a_E'], p['theta_E'])) / p['tau_E']\n        dI_dt = (-I + sigmoid(p['w_IE'] * E - p['w_II'] * I + D_pv, p['a_I'], p['theta_I'])) / p['tau_pv']\n        dS_dt = (-S + sigmoid(p['w_SE'] * E - p['w_SI'] * S + D_sst, p['a_S'], p['theta_S'])) / p['tau_sst']\n        dG_pv_dt = (-G_pv + I) / p['tau_Gpv']\n        dG_sst_dt = (-G_sst + S) / p['tau_Gsst']\n        \n        return np.array([dE_dt, dI_dt, dS_dt, dG_pv_dt, dG_sst_dt])\n\n    def rk4_step(y, D_pv, D_sst, p, dt_val):\n        k1 = dt_val * derivatives(y, D_pv, D_sst, p)\n        k2 = dt_val * derivatives(y + 0.5 * k1, D_pv, D_sst, p)\n        k3 = dt_val * derivatives(y + 0.5 * k2, D_pv, D_sst, p)\n        k4 = dt_val * derivatives(y + k3, D_pv, D_sst, p)\n        return y + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n\n    results = []\n\n    for D_pv, D_sst in test_cases:\n        # --- Initialization ---\n        y = np.array([0.1, 0.1, 0.1, 0.0, 0.0])  # E, I, S, G_pv, G_sst\n        E_history = np.zeros(num_steps)\n\n        # --- Simulation Loop ---\n        for i in range(num_steps):\n            E_history[i] = y[0]\n            y = rk4_step(y, D_pv, D_sst, params, dt)\n\n        # --- Spectral Analysis ---\n        E_analysis = E_history[analysis_start_index:]\n        N_fft = len(E_analysis)\n\n        # Compute FFT and power spectrum\n        yf = np.fft.fft(E_analysis)\n        xf = np.fft.fftfreq(N_fft, dt)\n        power = np.abs(yf)**2\n\n        # Filter for gamma band (30-80 Hz) and positive frequencies\n        gamma_mask = (xf >= 30)  (xf = 80)\n        \n        gamma_freqs = xf[gamma_mask]\n        gamma_power = power[gamma_mask]\n        \n        freq_result = 0.0\n        power_result = 0.0\n\n        if len(gamma_power) > 0:\n            peak_power_val = np.max(gamma_power)\n            total_gamma_power = np.sum(gamma_power)\n            \n            # Check for non-zero power to avoid division by zero and find peak\n            if peak_power_val > 1e-12: # Using a small tolerance for numerical zero\n                peak_index_local = np.argmax(gamma_power)\n                freq_result = gamma_freqs[peak_index_local]\n                \n                if total_gamma_power > 1e-12:\n                    power_result = peak_power_val / total_gamma_power\n                else:\n                    power_result = 0.0\n            else:\n                freq_result = 0.0\n                power_result = 0.0\n        \n        results.append([freq_result, power_result])\n\n    # --- Format Output ---\n    output_str = \"[\" + \",\".join([f\"[{f:.3f},{p:.3f}]\" for f, p in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}