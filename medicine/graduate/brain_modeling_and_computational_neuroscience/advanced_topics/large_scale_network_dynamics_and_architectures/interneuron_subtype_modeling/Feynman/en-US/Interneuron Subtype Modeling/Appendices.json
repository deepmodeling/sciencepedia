{
    "hands_on_practices": [
        {
            "introduction": "Understanding how synaptic inputs are integrated is fundamental to modeling any neuron, including interneurons. The efficacy of a synapse is not solely determined by its intrinsic strength but is also heavily influenced by its location on the complex dendritic arbor. This practice guides you through building a multi-compartment model from the ground up, applying principles of linear circuit analysis to quantify how electrotonic distance attenuates synaptic signals as they travel to the soma .",
            "id": "3991811",
            "problem": "You are tasked with assessing location-dependent electrotonic impact in a simplified but morphologically grounded multi-compartment model of a cortical interneuron. The compartments are the soma, a proximal dendrite, a distal dendrite attached to the proximal dendrite, and the axon initial segment (AIS). The objective is to quantify the difference in somatic membrane potential change, in response to opening an identical conductance at one of these compartments, using first principles of passive cable theory and linear circuit analysis.\n\nFundamental base and assumptions: Start from Kirchhoff's Current Law (KCL), linear passive membrane theory, and direct current steady-state analysis of resistive networks. Assume a constant membrane leak described by a specific leak conductance per unit area $g_L$ and a leak reversal potential $E_L$. The cytoplasm has a resistivity $R_a$. Each compartment has a membrane leak conductance to ground (ground is set at $E_L$ so that $E_L$ is represented as $0$ in the equations) and is coupled to its neighbors by axial conductances derived from geometry and $R_a$. An identical synaptic-like conductance $g_{\\text{syn}}$ is opened at one compartment at a time and is connected to a reversal potential $E_{\\text{syn}}$ (measured relative to $E_L$). The capacitive components are neglected because steady-state responses are desired.\n\nModel structure: There are $4$ nodes, indexed $0,1,2,3$ representing soma ($0$), proximal dendrite ($1$), distal dendrite ($2$), and Axon Initial Segment (AIS) ($3$). The leak conductance of node $i$ is $G_{L,i} = g_L A_i$, where $A_i$ is the membrane area of the compartment. Soma area is modeled as a sphere of radius $r_{\\text{soma}}$ with $A_{\\text{soma}} = 4\\pi r_{\\text{soma}}^2$. Dendrite and AIS areas are modeled as cylinders with $A = 2\\pi r L$. Axial coupling conductances between adjacent nodes are computed as the reciprocal of series axial resistances between compartment centers. Specifically, the axial resistance between soma and proximal dendrite is\n$$\nR_{\\text{ax},\\,\\text{soma-prox}} = R_a \\frac{r_{\\text{soma}}}{\\pi r_{\\text{soma}}^2} + R_a \\frac{L_{\\text{prox}}/2}{\\pi r_{\\text{prox}}^2},\n$$\nbetween proximal and distal dendrite is\n$$\nR_{\\text{ax},\\,\\text{prox-dist}} = R_a \\frac{L_{\\text{prox}}/2}{\\pi r_{\\text{prox}}^2} + R_a \\frac{L_{\\text{dist}}/2}{\\pi r_{\\text{dist}}^2},\n$$\nand between soma and AIS is\n$$\nR_{\\textax},\\,\\text{soma-AIS}} = R_a \\frac{r_{\\text{soma}}}{\\pi r_{\\text{soma}}^2} + R_a \\frac{L_{\\text{AIS}}/2}{\\pi r_{\\text{AIS}}^2}.\n$$\nThe corresponding axial conductances are $G_{\\text{ax}} = 1 / R_{\\text{ax}}$ for each connection.\n\nSteady-state nodal equations: Let the vector of node voltages relative to $E_L$ be $\\mathbf{V} = [V_0, V_1, V_2, V_3]^T$, and define the conductance matrix $\\mathbf{A}$ by KCL at each node:\n$$\nA_{ii} = G_{L,i} + \\sum_{j \\in \\mathcal{N}(i)} G_{\\text{ax},ij} + \\delta_{i,k} g_{\\text{syn}}, \\quad A_{ij} = -G_{\\text{ax},ij} \\text{ for } i \\neq j,\n$$\nwhere $\\mathcal{N}(i)$ is the set of neighbors axially connected to node $i$, and $k$ is the index of the node where the synaptic conductance is opened. The source vector $\\mathbf{b}$ has $b_k = g_{\\text{syn}} E_{\\text{syn}}$ and zeros elsewhere. The steady-state solution is obtained by solving\n$$\n\\mathbf{A} \\mathbf{V} = \\mathbf{b}.\n$$\n\nYour task: For each test case below, compute the somatic voltage change $V_0$ in millivolts when $g_{\\text{syn}}$ is opened at the soma, proximal dendrite, distal dendrite, and AIS separately. Use the geometry to compute areas and axial resistances, set $E_L$ as ground ($0$), and use the provided constants. Express all final voltages in millivolts, rounded to six decimal places.\n\nConstants across all test cases unless otherwise specified:\n- $g_L = 0.1 \\text{ mS/cm}^2$ (i.e., $g_L = 1\\times 10^{-4} \\text{ S/cm}^2$).\n- $g_{\\text{syn}} = 1 \\text{ nS}$ (i.e., $g_{\\text{syn}} = 1\\times 10^{-9} \\text{ S}$).\n- $E_{\\text{syn}} = 65 \\text{ mV}$ (i.e., $E_{\\text{syn}} = 0.065 \\text{ V}$ above $E_L$).\n- $E_L$ is treated as $0 \\text{ V}$ in the model by choice of ground.\n- Cytoplasmic resistivity $R_a$ is specified per test case.\n- All morphological dimensions are provided in micrometers and must be converted to centimeters for computations using $1 \\text{ cm} = 10{,}000 \\text{ }\\mu\\text{m}$.\n\nTest suite (each case is a tuple of $(r_{\\text{soma}}, r_{\\text{prox}}, L_{\\text{prox}}, r_{\\text{dist}}, L_{\\text{dist}}, r_{\\text{AIS}}, L_{\\text{AIS}}, R_a)$, all radii $r$ and lengths $L$ in $\\mu\\text{m}$, $R_a$ in $\\Omega\\cdot\\text{cm}$):\n1. Case $1$ (canonical morphology): $(10, 1.2, 120, 0.8, 300, 0.7, 50, 150)$.\n2. Case $2$ (very long distal dendrite): $(9, 1.0, 80, 0.6, 1000, 0.7, 40, 150)$.\n3. Case $3$ (high axial resistivity): $(11, 1.1, 150, 0.9, 350, 0.6, 45, 200)$.\n4. Case $4$ (tiny AIS): $(10, 1.0, 100, 0.7, 250, 0.2, 30, 150)$.\n\nOutput specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list of four floats in millivolts, ordered as $[V_0^{\\text{soma}}, V_0^{\\text{prox}}, V_0^{\\text{dist}}, V_0^{\\text{AIS}}]$. For example, the printed output must look like\n$[ [v_{11}, v_{12}, v_{13}, v_{14}], [v_{21}, v_{22}, v_{23}, v_{24}], [v_{31}, v_{32}, v_{33}, v_{34}], [v_{41}, v_{42}, v_{43}, v_{44}] ]$\nwith each $v_{ij}$ rounded to six decimal places and expressed in $\\text{mV}$ as a decimal number. No additional text should be printed.",
            "solution": "The problem requires the calculation of the steady-state somatic membrane potential change in a four-compartment neuron model in response to a synaptic conductance opened at different locations. This is a classic problem in computational neuroscience that can be solved using linear circuit analysis, specifically by applying Kirchhoff's Current Law (KCL) at each compartment (node) under direct current (DC) steady-state conditions.\n\nThe model consists of four nodes: the soma (index $0$), a proximal dendrite (index $1$), a distal dendrite (index $2$), and the Axon Initial Segment (AIS) (index $3$). The connectivity is as follows: the soma is connected to the proximal dendrite and the AIS. The proximal dendrite is connected to the soma and the distal dendrite. The circuit diagram can be visualized as a central soma node ($0$) connected to two branches, one leading to the proximal and then distal dendrite ($0 \\leftrightarrow 1 \\leftrightarrow 2$) and the other to the AIS ($0 \\leftrightarrow 3$).\n\nAt steady state, the sum of currents flowing out of each node must be zero. The currents include leak current through the membrane, axial currents to adjacent compartments, and the synaptic current. By setting the leak reversal potential $E_L$ to be the ground reference ($0 \\text{ V}$), the KCL equations form a system of linear equations $\\mathbf{A} \\mathbf{V} = \\mathbf{b}$, where $\\mathbf{V} = [V_0, V_1, V_2, V_3]^T$ is the vector of steady-state voltage deflections from rest at each node.\n\nThe procedural steps to solve for $\\mathbf{V}$ for each test case are as follows:\n\n1.  **Unit Conversion**: All morphological dimensions provided in micrometers ($\\mu\\text{m}$) are converted to centimeters ($\\text{cm}$) using the conversion factor $1 \\text{ cm} = 10^4 \\text{ }\\mu\\text{m}$. All electrical parameters are used in base SI units (Volts, Siemens, Ohms, Coulombs, etc.), with conductances computed in Siemens ($S$) and resistances in Ohms ($\\Omega$).\n\n2.  **Calculate Compartment Areas ($A_i$):**\n    For each component $i$, the surface area $A_i$ is calculated based on its geometry. Let the converted radii and lengths in $\\text{cm}$ be denoted by a prime (e.g., $r'_{\\text{soma}}$).\n    - Soma (sphere, $i=0$): $A_0 = 4\\pi (r'_{\\text{soma}})^2$\n    - Proximal Dendrite (cylinder, $i=1$): $A_1 = 2\\pi r'_{\\text{prox}} L'_{\\text{prox}}$\n    - Distal Dendrite (cylinder, $i=2$): $A_2 = 2\\pi r'_{\\text{dist}} L'_{\\text{dist}}$\n    - AIS (cylinder, $i=3$): $A_3 = 2\\pi r'_{\\text{AIS}} L'_{\\text{AIS}}$\n\n3.  **Calculate Leak Conductances ($G_{L,i}$):**\n    The passive leak conductance for each compartment is the product of the specific leak conductance per unit area, $g_L = 1 \\times 10^{-4} \\text{ S/cm}^2$, and the compartment's surface area.\n    - $G_{L,i} = g_L A_i$ for $i \\in \\{0, 1, 2, 3\\}$.\n\n4.  **Calculate Axial Conductances ($G_{\\text{ax},ij}$):**\n    The axial conductance between two adjacent compartments $i$ and $j$ is the reciprocal of the axial resistance $R_{\\text{ax},ij}$ between their centers. The resistances are calculated using the given formulas and cytoplasmic resistivity $R_a$:\n    - Soma ($0$) to Proximal Dendrite ($1$):\n      $$R_{\\text{ax},01} = R_a \\left( \\frac{r'_{\\text{soma}}}{\\pi (r'_{\\text{soma}})^2} + \\frac{L'_{\\text{prox}}/2}{\\pi (r'_{\\text{prox}})^2} \\right) = R_a \\left( \\frac{1}{\\pi r'_{\\text{soma}}} + \\frac{L'_{\\text{prox}}}{2\\pi (r'_{\\text{prox}})^2} \\right)$$\n    - Proximal Dendrite ($1$) to Distal Dendrite ($2$):\n      $$R_{\\text{ax},12} = R_a \\left( \\frac{L'_{\\text{prox}}/2}{\\pi (r'_{\\text{prox}})^2} + \\frac{L'_{\\text{dist}}/2}{\\pi (r'_{\\text{dist}})^2} \\right)$$\n    - Soma ($0$) to AIS ($3$):\n      $$R_{\\text{ax},03} = R_a \\left( \\frac{r'_{\\text{soma}}}{\\pi (r'_{\\text{soma}})^2} + \\frac{L'_{\\text{AIS}}/2}{\\pi (r'_{\\text{AIS}})^2} \\right) = R_a \\left( \\frac{1}{\\pi r'_{\\text{soma}}} + \\frac{L'_{\\text{AIS}}}{2\\pi (r'_{\\text{AIS}})^2} \\right)$$\n    The corresponding axial conductances are $G_{\\text{ax},01} = 1/R_{\\text{ax},01}$, $G_{\\text{ax},12} = 1/R_{\\text{ax},12}$, and $G_{\\text{ax},03} = 1/R_{\\text{ax},03}$.\n\n5.  **Construct the System of Equations:**\n    For each location $k \\in \\{0, 1, 2, 3\\}$ of the synaptic conductance $g_{\\text{syn}}$, we assemble the $4 \\times 4$ conductance matrix $\\mathbf{A}$ and the $4 \\times 1$ source vector $\\mathbf{b}$.\n\n    The elements of the conductance matrix $\\mathbf{A}$ are given by:\n    - Diagonal elements: $A_{ii} = G_{L,i} + \\sum_{j \\in \\mathcal{N}(i)} G_{\\text{ax},ij} + \\delta_{i,k} g_{\\text{syn}}$\n    - Off-diagonal elements: $A_{ij} = -G_{\\text{ax},ij}$ if nodes $i$ and $j$ are connected, and $A_{ij}=0$ otherwise.\n    Here, $\\delta_{i,k}$ is the Kronecker delta, which is $1$ if $i=k$ and $0$ otherwise. $\\mathcal{N}(i)$ is the set of neighbors of node $i$.\n\n    Explicitly, the matrix $\\mathbf{A}$ is:\n    $$\n    \\mathbf{A} =\n    \\begin{pmatrix}\n    G_{L,0} + G_{\\text{ax},01} + G_{\\text{ax},03} & -G_{\\text{ax},01} & 0 & -G_{\\text{ax},03} \\\\\n    -G_{\\text{ax},01} & G_{L,1} + G_{\\text{ax},01} + G_{\\text{ax},12} & -G_{\\text{ax},12} & 0 \\\\\n    0 & -G_{\\text{ax},12} & G_{L,2} + G_{\\text{ax},12} & 0 \\\\\n    -G_{\\text{ax},03} & 0 & 0 & G_{L,3} + G_{\\text{ax},03}\n    \\end{pmatrix}\n    +\n    \\begin{pmatrix}\n    \\delta_{0,k}g_{\\text{syn}} & 0 & 0 & 0 \\\\\n    0 & \\delta_{1,k}g_{\\text{syn}} & 0 & 0 \\\\\n    0 & 0 & \\delta_{2,k}g_{\\text{syn}} & 0 \\\\\n    0 & 0 & 0 & \\delta_{3,k}g_{\\text{syn}}\n    \\end{pmatrix}\n    $$\n    The source vector $\\mathbf{b}$ has a single non-zero entry corresponding to the synaptic current source at node $k$:\n    $$ b_i = \\delta_{i,k} g_{\\text{syn}} E_{\\text{syn}} $$\n    where $g_{\\text{syn}} = 1 \\times 10^{-9} \\text{ S}$ and $E_{\\text{syn}} = 0.065 \\text{ V}$.\n\n6.  **Solve for Voltages and Extract Result:**\n    The linear system $\\mathbf{A} \\mathbf{V} = \\mathbf{b}$ is solved for the voltage vector $\\mathbf{V}$. The somatic voltage change is the first element, $V_0$. This calculation is repeated for each synaptic location $k=0, 1, 2, 3$. The final result for one test case is the list of four somatic voltages $[V_{0,k=0}, V_{0,k=1}, V_{0,k=2}, V_{0,k=3}]$. These values are converted from Volts to millivolts ($\\text{mV}$) by multiplying by $1000$ and then rounded to six decimal places as specified. This entire process is repeated for all four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the result.\n    \"\"\"\n    \n    # Define constants\n    G_L_SPECIFIC = 1e-4  # S/cm^2 (0.1 mS/cm^2)\n    G_SYN = 1e-9         # S (1 nS)\n    E_SYN = 0.065        # V (65 mV)\n    \n    # Each case is a tuple of (r_soma, r_prox, L_prox, r_dist, L_dist, r_AIS, L_AIS, Ra)\n    # Dimensions in um, Ra in Ohm*cm\n    test_cases = [\n        # Case 1 (canonical morphology)\n        (10, 1.2, 120, 0.8, 300, 0.7, 50, 150),\n        # Case 2 (very long distal dendrite)\n        (9, 1.0, 80, 0.6, 1000, 0.7, 40, 150),\n        # Case 3 (high axial resistivity)\n        (11, 1.1, 150, 0.9, 350, 0.6, 45, 200),\n        # Case 4 (tiny AIS)\n        (10, 1.0, 100, 0.7, 250, 0.2, 30, 150),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        case_results = compute_somatic_voltages(params, G_L_SPECIFIC, G_SYN, E_SYN)\n        all_results.append(case_results)\n\n    # Format output as a string representing a list of lists of floats\n    output_str = \"[\" + \", \".join([f\"[{', '.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\n\ndef compute_somatic_voltages(params, g_l, g_syn, e_syn):\n    \"\"\"\n    Computes the somatic voltage change for a single test case.\n    The synapse location is moved across the four compartments.\n    \"\"\"\n    r_soma, r_prox, l_prox, r_dist, l_dist, r_ais, l_ais, ra = params\n    \n    # Conversion factor from um to cm\n    um_to_cm = 1e-4\n\n    # Convert dimensions to cm\n    r_soma_cm = r_soma * um_to_cm\n    r_prox_cm = r_prox * um_to_cm\n    l_prox_cm = l_prox * um_to_cm\n    r_dist_cm = r_dist * um_to_cm\n    l_dist_cm = l_dist * um_to_cm\n    r_ais_cm = r_ais * um_to_cm\n    l_ais_cm = l_ais * um_to_cm\n\n    # 1. Calculate compartment areas (cm^2)\n    # Node 0: soma, 1: prox_dend, 2: dist_dend, 3: AIS\n    A_soma = 4 * np.pi * r_soma_cm**2\n    A_prox = 2 * np.pi * r_prox_cm * l_prox_cm\n    A_dist = 2 * np.pi * r_dist_cm * l_dist_cm\n    A_ais  = 2 * np.pi * r_ais_cm * l_ais_cm\n    \n    # 2. Calculate leak conductances (S)\n    G_L_soma = g_l * A_soma\n    G_L_prox = g_l * A_prox\n    G_L_dist = g_l * A_dist\n    G_L_ais  = g_l * A_ais\n\n    # 3. Calculate axial conductances (S)\n    pi = np.pi\n    R_ax_01 = ra * (1 / (pi * r_soma_cm) + (l_prox_cm / 2) / (pi * r_prox_cm**2))\n    R_ax_12 = ra * ((l_prox_cm / 2) / (pi * r_prox_cm**2) + (l_dist_cm / 2) / (pi * r_dist_cm**2))\n    R_ax_03 = ra * (1 / (pi * r_soma_cm) + (l_ais_cm / 2) / (pi * r_ais_cm**2))\n\n    G_ax_01 = 1 / R_ax_01\n    G_ax_12 = 1 / R_ax_12\n    G_ax_03 = 1 / R_ax_03\n\n    # 4. Construct the base conductance matrix (before adding g_syn)\n    A_base = np.zeros((4, 4))\n    \n    # Diagonal elements\n    A_base[0, 0] = G_L_soma + G_ax_01 + G_ax_03\n    A_base[1, 1] = G_L_prox + G_ax_01 + G_ax_12\n    A_base[2, 2] = G_L_dist + G_ax_12\n    A_base[3, 3] = G_L_ais  + G_ax_03\n\n    # Off-diagonal elements\n    A_base[0, 1] = A_base[1, 0] = -G_ax_01\n    A_base[1, 2] = A_base[2, 1] = -G_ax_12\n    A_base[0, 3] = A_base[3, 0] = -G_ax_03\n    \n    somatic_voltages = []\n\n    # 5. Solve for each synapse location k\n    for k in range(4): # k = 0 (soma), 1 (prox), 2 (dist), 3 (AIS)\n        # Construct A and b for current location k\n        A = A_base.copy()\n        A[k, k] += g_syn\n        \n        b = np.zeros(4)\n        b[k] = g_syn * e_syn\n        \n        # Solve the system AV = b\n        V = np.linalg.solve(A, b)\n        \n        # Extract somatic voltage, convert to mV, round, and append\n        v0_mv = V[0] * 1000\n        somatic_voltages.append(round(v0_mv, 6))\n\n    return somatic_voltages\n\nsolve()\n```"
        },
        {
            "introduction": "Cortical circuits orchestrate complex computations through the coordinated activity of diverse interneuron subtypes, such as Parvalbumin-positive (PV) and Somatostatin-positive (SST) cells. This exercise employs a neural mass model to simulate how these distinct inhibitory populations contribute to network-level phenomena like gamma oscillations. By modeling cell-type-specific optogenetic activation, you will gain hands-on experience in using computational models to predict the outcomes of targeted experimental manipulations .",
            "id": "3991795",
            "problem": "You are tasked with constructing and analyzing a small-scale neural mass model for a pyramidal-interneuron network gamma (PING) circuit augmented with two inhibitory interneuron subtypes: parvalbumin-expressing ($\\mathrm{PV}$) and somatostatin-expressing ($\\mathrm{SST}$) neurons. The aim is to predict quantitatively how cell-type-specific optogenetic drive to $\\mathrm{PV}$ versus $\\mathrm{SST}$ populations alters the gamma oscillation frequency and power.\n\nStarting from the firing-rate formulation derived from balance of membrane currents and synaptic filtering, consider a three-population rate model with synaptic filter states that approximate finite synaptic kinetics. Let the excitatory pyramidal population firing rate be $E(t)$, the $\\mathrm{PV}$ inhibitory population firing rate be $I(t)$, and the $\\mathrm{SST}$ inhibitory population firing rate be $S(t)$. Let $G_{\\mathrm{pv}}(t)$ and $G_{\\mathrm{sst}}(t)$ be filtered inhibitory synaptic variables mediating the inhibitory effect onto the excitatory population with distinct kinetics. The dynamics are\n$$\n\\tau_E \\frac{dE}{dt} = -E + \\sigma_E\\!\\left( w_{EE} E - w_{EI} G_{\\mathrm{pv}} - w_{ES} G_{\\mathrm{sst}} + P \\right),\n$$\n$$\n\\tau_{\\mathrm{pv}} \\frac{dI}{dt} = -I + \\sigma_I\\!\\left( w_{IE} E - w_{II} I + D_{\\mathrm{pv}} \\right),\n$$\n$$\n\\tau_{\\mathrm{sst}} \\frac{dS}{dt} = -S + \\sigma_S\\!\\left( w_{SE} E - w_{SI} S + D_{\\mathrm{sst}} \\right),\n$$\n$$\n\\tau_{G\\mathrm{pv}} \\frac{dG_{\\mathrm{pv}}}{dt} = -G_{\\mathrm{pv}} + I,\n\\qquad\n\\tau_{G\\mathrm{sst}} \\frac{dG_{\\mathrm{sst}}}{dt} = -G_{\\mathrm{sst}} + S,\n$$\nwhere $\\sigma_X(x)$ is a sigmoidal input-output function for population $X \\in \\{E, I, S\\}$ defined by\n$$\n\\sigma_X(x) = \\frac{1}{1 + \\exp\\!\\left( -a_X \\left( x - \\theta_X \\right) \\right)},\n$$\nwith slope parameter $a_X$ and threshold $\\theta_X$. The symbols $w_{EE}, w_{EI}, w_{ES}, w_{IE}, w_{II}, w_{SE}, w_{SI}$ denote coupling strengths, $\\tau_E, \\tau_{\\mathrm{pv}}, \\tau_{\\mathrm{sst}}, \\tau_{G\\mathrm{pv}}, \\tau_{G\\mathrm{sst}}$ denote time constants in seconds, $P$ is tonic external excitatory drive, and $D_{\\mathrm{pv}}$ and $D_{\\mathrm{sst}}$ are constant optogenetic drives to the $\\mathrm{PV}$ and $\\mathrm{SST}$ inhibitory populations respectively. All firing rates and $\\sigma_X$ outputs are dimensionless in the interval $[0,1]$. The optogenetic drives $D_{\\mathrm{pv}}$ and $D_{\\mathrm{sst}}$ are dimensionless inputs that shift the $\\mathrm{PV}$ and $\\mathrm{SST}$ population rates respectively.\n\nFundamental base assumptions and definitions to use:\n- The membrane equation at the population level yields a first-order low-pass dynamics for rates with characteristic time constants, justifying the form $\\tau \\frac{dr}{dt} = -r + \\sigma(\\cdot)$ for each population, where $\\sigma(\\cdot)$ is a static nonlinearity representing a sigmoidal firing rate-current relationship rooted in the biophysics of spike generation.\n- Synaptic currents are filtered by first-order kinetics, motivating the auxiliary variables $G_{\\mathrm{pv}}(t)$ and $G_{\\mathrm{sst}}(t)$ with distinct inhibitory kinetics that introduce phase lags essential for oscillations.\n- Gamma oscillations in PING arise from recurrent excitation-inhibition loop dynamics with faster $\\mathrm{PV}$ inhibition and slower $\\mathrm{SST}$ inhibition. The oscillation frequency is quantifiable from the dominant spectral peak of $E(t)$ in the gamma band.\n- The discrete Fourier transform of a time series $x(t)$ sampled uniformly at interval $\\Delta t$ yields frequency components at $f_k = \\frac{k}{N \\Delta t}$ for $k \\in \\{0,1,\\dots,\\lfloor N/2 \\rfloor\\}$, and the power spectral density can be estimated as $|X_k|^2$ where $X_k$ are the Fourier coefficients.\n\nYour program must implement the above system, simulate it deterministically, and compute the gamma frequency and power as follows:\n- Simulate the system for a duration of $T = 3.0$ seconds with a fixed step size $\\Delta t = 0.0005$ seconds using a numerically stable method (for example, fourth-order Runge-Kutta) from initial conditions $E(0)=0.1$, $I(0)=0.1$, $S(0)=0.1$, $G_{\\mathrm{pv}}(0)=0.0$, $G_{\\mathrm{sst}}(0)=0.0$.\n- After discarding the initial transient of $1.0$ seconds, compute the discrete Fourier transform of $E(t)$ over the remaining time window. Estimate the frequency in Hertz ($\\mathrm{Hz}$) as the location of the largest spectral peak within the gamma band from $30$ to $80$ Hertz. If the largest peak in this band is numerically zero (e.g., due to a flat spectrum), return a frequency of $0.0$ Hertz.\n- Define the gamma power as the peak power value at that frequency normalized by the total power in the gamma band. This yields a dimensionless fraction in $[0,1]$. If the total gamma-band power is numerically zero, return a gamma power of $0.0$.\n\nUse the following fixed parameters, which are physiologically plausible for cortical microcircuits:\n- Time constants: $\\tau_E = 0.020$ seconds, $\\tau_{\\mathrm{pv}} = 0.010$ seconds, $\\tau_{\\mathrm{sst}} = 0.040$ seconds, $\\tau_{G\\mathrm{pv}} = 0.005$ seconds, $\\tau_{G\\mathrm{sst}} = 0.020$ seconds.\n- Sigmoid parameters: $a_E = 4.0$, $a_I = 4.0$, $a_S = 4.0$, $\\theta_E = 0.5$, $\\theta_I = 0.3$, $\\theta_S = 0.3$.\n- Coupling strengths: $w_{EE} = 12.0$, $w_{EI} = 15.0$, $w_{ES} = 6.0$, $w_{IE} = 15.0$, $w_{II} = 4.0$, $w_{SE} = 8.0$, $w_{SI} = 3.0$.\n- Tonic excitatory drive: $P = 1.0$.\n\nConstruct a test suite that probes how $\\mathrm{PV}$ versus $\\mathrm{SST}$ optogenetic activation alters gamma oscillations. Use exactly the following five test cases, specified as ordered pairs $(D_{\\mathrm{pv}}, D_{\\mathrm{sst}})$:\n- Case $1$: $(0.0, 0.0)$ baseline with no optogenetic drive.\n- Case $2$: $(0.3, 0.0)$ moderate $\\mathrm{PV}$ activation.\n- Case $3$: $(0.0, 0.3)$ moderate $\\mathrm{SST}$ activation.\n- Case $4$: $(0.8, 0.0)$ strong $\\mathrm{PV}$ activation.\n- Case $5$: $(0.0, 0.8)$ strong $\\mathrm{SST}$ activation.\n\nYour program must, for each test case, compute two quantities: the gamma frequency in Hertz and the normalized gamma power as a dimensionless fraction. The final output must be a single line containing a list of lists, where each inner list corresponds to one test case in the order above and contains two floats $[f, p]$ with $f$ in Hertz and $p$ dimensionless. Your program must round each float to $3$ decimal places in the output. For example, the output format must be exactly like\n$$\n\\text{[}[f_1,p_1],[f_2,p_2],[f_3,p_3],[f_4,p_4],[f_5,p_5]\\text{]},\n$$\nprinted on a single line.\n\nAnswer the frequencies in $\\mathrm{Hz}$ and the powers as dimensionless fractions, each rounded to $3$ decimal places as specified. No other text should be printed.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n\nThe problem provides the following data and definitions:\n- **System of Equations**: A five-variable system of ordinary differential equations (ODEs) for the firing rates $E(t)$, $I(t)$, $S(t)$, and synaptic filtering variables $G_{\\mathrm{pv}}(t)$, $G_{\\mathrm{sst}}(t)$:\n$$\n\\tau_E \\frac{dE}{dt} = -E + \\sigma_E\\!\\left( w_{EE} E - w_{EI} G_{\\mathrm{pv}} - w_{ES} G_{\\mathrm{sst}} + P \\right)\n$$\n$$\n\\tau_{\\mathrm{pv}} \\frac{dI}{dt} = -I + \\sigma_I\\!\\left( w_{IE} E - w_{II} I + D_{\\mathrm{pv}} \\right)\n$$\n$$\n\\tau_{\\mathrm{sst}} \\frac{dS}{dt} = -S + \\sigma_S\\!\\left( w_{SE} E - w_{SI} S + D_{\\mathrm{sst}} \\right)\n$$\n$$\n\\tau_{G\\mathrm{pv}} \\frac{dG_{\\mathrm{pv}}}{dt} = -G_{\\mathrm{pv}} + I\n$$\n$$\n\\tau_{G\\mathrm{sst}} \\frac{dG_{\\mathrm{sst}}}{dt} = -G_{\\mathrm{sst}} + S\n$$\n- **Sigmoid Function**: The input-output function $\\sigma_X(x)$ for population $X \\in \\{E, I, S\\}$ is given by:\n$$\n\\sigma_X(x) = \\frac{1}{1 + \\exp\\!\\left( -a_X \\left( x - \\theta_X \\right) \\right)}\n$$\n- **Parameters**:\n  - Time constants (s): $\\tau_E = 0.020$, $\\tau_{\\mathrm{pv}} = 0.010$, $\\tau_{\\mathrm{sst}} = 0.040$, $\\tau_{G\\mathrm{pv}} = 0.005$, $\\tau_{G\\mathrm{sst}} = 0.020$.\n  - Sigmoid parameters: $a_E = 4.0$, $a_I = 4.0$, $a_S = 4.0$, $\\theta_E = 0.5$, $\\theta_I = 0.3$, $\\theta_S = 0.3$.\n  - Coupling strengths (dimensionless): $w_{EE} = 12.0$, $w_{EI} = 15.0$, $w_{ES} = 6.0$, $w_{IE} = 15.0$, $w_{II} = 4.0$, $w_{SE} = 8.0$, $w_{SI} = 3.0$.\n  - Tonic excitatory drive (dimensionless): $P = 1.0$.\n- **Simulation Protocol**:\n  - Integration method: Fourth-order Runge-Kutta (RK4).\n  - Total duration: $T = 3.0$ s.\n  - Time step: $\\Delta t = 0.0005$ s.\n  - Initial conditions: $E(0)=0.1$, $I(0)=0.1$, $S(0)=0.1$, $G_{\\mathrm{pv}}(0)=0.0$, $G_{\\mathrm{sst}}(0)=0.0$.\n- **Analysis Protocol**:\n  - Discard initial transient of $1.0$ s.\n  - Compute the Discrete Fourier Transform (DFT) of $E(t)$ over the remaining window.\n  - **Gamma Frequency**: Location of the largest spectral peak in the band $30$ to $80$ Hz. If the peak power in this band is numerically zero, the frequency is $0.0$ Hz.\n  - **Gamma Power**: Peak power value at the identified frequency, normalized by the total power in the $30-80$ Hz gamma band. If total gamma-band power is zero, the normalized power is $0.0$.\n- **Test Cases**: Five pairs of optogenetic drives $(D_{\\mathrm{pv}}, D_{\\mathrm{sst}})$:\n  1. $(0.0, 0.0)$\n  2. $(0.3, 0.0)$\n  3. $(0.0, 0.3)$\n  4. $(0.8, 0.0)$\n  5. $(0.0, 0.8)$\n- **Output Format**: A single-line list of lists `[[f1,p1],[f2,p2],...]`, with each float rounded to $3$ decimal places.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded**: The problem describes a Wilson-Cowan-style neural mass model, a standard and well-validated framework in computational neuroscience for studying population-level brain dynamics. The PING (Pyramidal-Interneuron Network Gamma) mechanism is a canonical theory for gamma oscillation generation. The extension to include distinct PV and SST interneuron subtypes with different kinetics reflects current understanding of cortical microcircuitry. The model is a well-established scientific tool, not pseudoscience.\n- **Well-Posed**: The problem is well-posed. It provides a complete set of initial value problems (IVPs) specified by a system of ODEs, all necessary parameters, and initial conditions. The instructions for numerical simulation (RK4 method, step size, duration) and subsequent data analysis (transient removal, FFT, peak analysis) are explicit and unambiguous, leading to a unique, computable solution.\n- **Objective**: The problem is stated in precise, objective mathematical and algorithmic terms. All parameters are given as fixed numerical values. The evaluation criteria are quantitative and clearly defined. There are no subjective or opinion-based components.\n\nThe problem does not exhibit any of the invalidity flaws. It is self-contained, scientifically sound, and algorithmically specified.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be developed.\n\n## Solution\n\nThe solution requires simulating a five-dimensional system of coupled, nonlinear ordinary differential equations and subsequently performing a spectral analysis on the time series of the excitatory population activity, $E(t)$.\n\n### 1. Model and Numerical Integration\n\nThe state of the system at any time $t$ is described by the vector $\\vec{y}(t) = [E(t), I(t), S(t), G_{\\mathrm{pv}}(t), G_{\\mathrm{sst}}(t)]^T$. The dynamics are governed by the matrix equation $\\frac{d\\vec{y}}{dt} = \\vec{f}(\\vec{y})$. The function $\\vec{f}(\\vec{y})$ is defined by the system of ODEs provided in the problem statement.\n\nTo solve this system numerically, we employ the fourth-order Runge-Kutta (RK4) method. Given the state $\\vec{y}_n$ at time $t_n$, the state $\\vec{y}_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$ is computed as follows:\n$$\n\\vec{k}_1 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n)\n$$\n$$\n\\vec{k}_2 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\frac{1}{2}\\vec{k}_1)\n$$\n$$\n\\vec{k}_3 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\frac{1}{2}\\vec{k}_2)\n$$\n$$\n\\vec{k}_4 = \\Delta t \\cdot \\vec{f}(\\vec{y}_n + \\vec{k}_3)\n$$\n$$\n\\vec{y}_{n+1} = \\vec{y}_n + \\frac{1}{6}(\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\nThis integration is performed from $t=0$ to $t=3.0$ s with a step size of $\\Delta t=0.0005$ s, starting from the specified initial conditions. The entire time series for $E(t)$ is stored for analysis.\n\n### 2. Spectral Analysis\n\nThe analysis is performed on the portion of the $E(t)$ time series after an initial transient period of $1.0$ second is discarded. This ensures that the analysis reflects the settled, long-term behavior of the network, not artifacts from the initial conditions.\n\nLet the analyzed segment of the excitatory activity be $E_{analysis}(t)$, sampled over a duration of $T_{analysis} = 2.0$ s with $N_{fft} = T_{analysis} / \\Delta t = 4000$ points.\n\n1.  **Discrete Fourier Transform (DFT)**: We compute the DFT of $E_{analysis}(t)$ using an efficient Fast Fourier Transform (FFT) algorithm. This transforms the time-domain signal into its frequency-domain representation, $X(f)$.\n    $$\n    X_k = \\sum_{n=0}^{N_{fft}-1} E_{analysis}(t_n) e^{-i 2\\pi k n / N_{fft}}\n    $$\n    The corresponding frequencies are $f_k = k / (N_{fft} \\Delta t)$ for $k = 0, 1, \\dots, N_{fft}-1$.\n\n2.  **Power Spectrum**: The power spectral density (PSD) is estimated as the squared magnitude of the DFT coefficients, $P(f_k) = |X_k|^2$. Due to the symmetry of the FFT for real-valued signals, we only consider the positive frequency components.\n\n3.  **Gamma Band Analysis**: We isolate the part of the power spectrum corresponding to the gamma frequency band, from $f_{min} = 30$ Hz to $f_{max} = 80$ Hz. This involves identifying the array indices $k$ such that $30 \\le f_k \\le 80$.\n\n4.  **Peak Frequency Identification**: Within this gamma band, we find the frequency $f_{peak}$ corresponding to the maximum power value, $P_{peak}$.\n    $$\n    P_{peak} = \\max_{30 \\le f \\le 80} P(f)\n    $$\n    If $P_{peak}$ is numerically zero (i.e., the spectrum is flat and zero within the band), the returned gamma frequency is $0.0$ Hz as per the problem specification.\n\n5.  **Normalized Power Calculation**: The normalized gamma power, $p_{norm}$, is calculated as the ratio of the peak power to the total power integrated across the entire gamma band.\n    $$\n    p_{norm} = \\frac{P_{peak}}{\\sum_{30 \\le f_k \\le 80} P(f_k)}\n    $$\n    If the total power in the gamma band is numerically zero, the normalized power is $0.0$.\n\n### 3. Execution for Test Cases\n\nThis entire procedure—simulation followed by spectral analysis—is repeated for each of the five specified test cases, which differ only in the values of the optogenetic drive parameters $D_{\\mathrm{pv}}$ and $D_{\\mathrm{sst}}$. The resulting pair of values, $[f_{peak}, p_{norm}]$, for each case is collected. Finally, the results are formatted into a single string as a list of lists, with each numerical value rounded to three decimal places.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PING model problem by simulating the ODEs and analyzing the output.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    params = {\n        'tau_E': 0.020, 'tau_pv': 0.010, 'tau_sst': 0.040,\n        'tau_Gpv': 0.005, 'tau_Gsst': 0.020,\n        'a_E': 4.0, 'a_I': 4.0, 'a_S': 4.0,\n        'theta_E': 0.5, 'theta_I': 0.3, 'theta_S': 0.3,\n        'w_EE': 12.0, 'w_EI': 15.0, 'w_ES': 6.0,\n        'w_IE': 15.0, 'w_II': 4.0, 'w_SE': 8.0, 'w_SI': 3.0,\n        'P': 1.0,\n    }\n\n    # --- Simulation setup ---\n    T = 3.0  # Total simulation time in seconds\n    dt = 0.0005  # Time step in seconds\n    num_steps = int(T / dt)\n    transient_time = 1.0  # Time to discard in seconds\n    analysis_start_index = int(transient_time / dt)\n\n    # --- Test Cases ---\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Baseline\n        (0.3, 0.0),  # Case 2: Moderate PV activation\n        (0.0, 0.3),  # Case 3: Moderate SST activation\n        (0.8, 0.0),  # Case 4: Strong PV activation\n        (0.0, 0.8),  # Case 5: Strong SST activation\n    ]\n\n    # --- Helper Functions ---\n    def sigmoid(x, a, theta):\n        return 1.0 / (1.0 + np.exp(-a * (x - theta)))\n\n    def derivatives(y, D_pv, D_sst, p):\n        E, I, S, G_pv, G_sst = y\n        \n        dE_dt = (-E + sigmoid(p['w_EE'] * E - p['w_EI'] * G_pv - p['w_ES'] * G_sst + p['P'], p['a_E'], p['theta_E'])) / p['tau_E']\n        dI_dt = (-I + sigmoid(p['w_IE'] * E - p['w_II'] * I + D_pv, p['a_I'], p['theta_I'])) / p['tau_pv']\n        dS_dt = (-S + sigmoid(p['w_SE'] * E - p['w_SI'] * S + D_sst, p['a_S'], p['theta_S'])) / p['tau_sst']\n        dG_pv_dt = (-G_pv + I) / p['tau_Gpv']\n        dG_sst_dt = (-G_sst + S) / p['tau_Gsst']\n        \n        return np.array([dE_dt, dI_dt, dS_dt, dG_pv_dt, dG_sst_dt])\n\n    def rk4_step(y, D_pv, D_sst, p, dt_val):\n        k1 = dt_val * derivatives(y, D_pv, D_sst, p)\n        k2 = dt_val * derivatives(y + 0.5 * k1, D_pv, D_sst, p)\n        k3 = dt_val * derivatives(y + 0.5 * k2, D_pv, D_sst, p)\n        k4 = dt_val * derivatives(y + k3, D_pv, D_sst, p)\n        return y + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n\n    results = []\n\n    for D_pv, D_sst in test_cases:\n        # --- Initialization ---\n        y = np.array([0.1, 0.1, 0.1, 0.0, 0.0])  # E, I, S, G_pv, G_sst\n        E_history = np.zeros(num_steps)\n\n        # --- Simulation Loop ---\n        for i in range(num_steps):\n            E_history[i] = y[0]\n            y = rk4_step(y, D_pv, D_sst, params, dt)\n\n        # --- Spectral Analysis ---\n        E_analysis = E_history[analysis_start_index:]\n        N_fft = len(E_analysis)\n\n        # Compute FFT and power spectrum\n        yf = np.fft.fft(E_analysis)\n        xf = np.fft.fftfreq(N_fft, dt)\n        power = np.abs(yf)**2\n\n        # Filter for gamma band (30-80 Hz) and positive frequencies\n        gamma_mask = (xf >= 30)  (xf = 80)\n        \n        gamma_freqs = xf[gamma_mask]\n        gamma_power = power[gamma_mask]\n        \n        freq_result = 0.0\n        power_result = 0.0\n\n        if len(gamma_power) > 0:\n            peak_power_val = np.max(gamma_power)\n            total_gamma_power = np.sum(gamma_power)\n            \n            # Check for non-zero power to avoid division by zero and find peak\n            if peak_power_val > 1e-12: # Using a small tolerance for numerical zero\n                peak_index_local = np.argmax(gamma_power)\n                freq_result = gamma_freqs[peak_index_local]\n                \n                if total_gamma_power > 1e-12:\n                    power_result = peak_power_val / total_gamma_power\n                else:\n                    power_result = 0.0\n            else:\n                freq_result = 0.0\n                power_result = 0.0\n        \n        results.append([freq_result, power_result])\n\n    # --- Format Output ---\n    output_str = \"[\" + \",\".join([f\"[{f:.3f},{p:.3f}]\" for f, p in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Synaptic connections are not static; their strength dynamically changes on short timescales, a property known as short-term plasticity (STP). This exercise delves into how STP, specifically synaptic depression and facilitation, shapes the dynamics of a canonical cortical circuit known as the Pyramidal-Interneuron Network Gamma (PING) model. By simulating this network and analyzing its oscillatory output, you will explore how the dynamic properties of synapses are critical for regulating the frequency and amplitude of brain rhythms .",
            "id": "3991773",
            "problem": "A two-population mean-field model is considered to capture oscillatory dynamics associated with Parvalbumin (PV) interneurons inhibiting excitatory (E) pyramidal cells in the Pyramidal-Interneuron Network Gamma (PING) regime. The excitatory population firing rate $E(t)$ and inhibitory population firing rate $I(t)$ are governed by sigmoidal rate dynamics with a first-order inhibitory synaptic gating variable $h(t)$ for PV$\\rightarrow$E synaptic current and short-term plasticity of PV$\\rightarrow$E synapses described by the Tsodyks-Markram model. The governing equations are\n$$\n\\tau_E \\frac{dE}{dt} = -E + r_{E,\\max}\\,\\sigma_E\\!\\left(w_{EE} E - g_{IE,\\max}\\,h + P - \\theta_E\\right),\n$$\n$$\n\\tau_I \\frac{dI}{dt} = -I + r_{I,\\max}\\,\\sigma_I\\!\\left(w_{IE} E + Q - \\theta_I\\right),\n$$\n$$\n\\tau_h \\frac{dh}{dt} = -h + u\\,x\\,I,\n$$\nwhere $\\sigma_E(z) = \\frac{1}{1 + e^{-a_E z}}$ and $\\sigma_I(z) = \\frac{1}{1 + e^{-a_I z}}$; $r_{E,\\max}$ and $r_{I,\\max}$ are maximum firing rates in $\\mathrm{Hz}$, $w_{EE}$ and $w_{IE}$ are coupling strengths, $P$ and $Q$ are external inputs in the same units as the arguments to the sigmoids, $\\theta_E$ and $\\theta_I$ are thresholds, and $\\tau_E$, $\\tau_I$, and $\\tau_h$ are time constants in $\\mathrm{s}$. Short-term plasticity (STP) for PV$\\rightarrow$E synapses follows the Tsodyks-Markram mean-field model\n$$\n\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{\\mathrm{rec}}} - u\\,x\\,I,\\quad\n\\frac{du}{dt} = \\frac{U - u}{\\tau_{\\mathrm{fac}}} + U\\,(1 - u)\\,I,\n$$\nwhere $x(t)$ is the fraction of available synaptic resources, $u(t)$ is the utilization variable, $\\tau_{\\mathrm{rec}}$ is the recovery time constant in $\\mathrm{s}$, $\\tau_{\\mathrm{fac}}$ is the facilitation time constant in $\\mathrm{s}$, and $U$ is the baseline utilization. The effective inhibitory PV$\\rightarrow$E conductance is $g_{IE}(t) = g_{IE,\\max}\\,h(t)$.\n\nTwo PV$\\rightarrow$E synaptic STP types are considered:\n- Depressing: large baseline utilization and dominant recovery, with parameters $(U_{\\mathrm{dep}}, \\tau_{\\mathrm{rec,dep}}, \\tau_{\\mathrm{fac,dep}})$.\n- Facilitating: small baseline utilization and dominant facilitation, with parameters $(U_{\\mathrm{fac}}, \\tau_{\\mathrm{rec,fac}}, \\tau_{\\mathrm{fac,fac}})$.\n\nTo ensure “holding mean conductance constant,” $g_{IE,\\max}$ is set for each STP type such that under a stationary inhibitory rate $I(t) \\equiv r_0$, the stationary mean of $u\\,x$ equals a prescribed target when scaled by $g_{IE,\\max}$. Under constant rate $r_0$, the steady-state solutions of the Tsodyks-Markram model are\n$$\nu^\\ast = \\frac{U\\,(1 + \\tau_{\\mathrm{fac}}\\,r_0)}{1 + \\tau_{\\mathrm{fac}}\\,U\\,r_0},\\quad\nx^\\ast = \\frac{1}{1 + \\tau_{\\mathrm{rec}}\\,u^\\ast\\,r_0},\\quad\ns^\\ast = u^\\ast x^\\ast,\n$$\nand $g_{IE,\\max}$ must satisfy $g_{IE,\\max}\\,s^\\ast = G_{\\mathrm{mean}}$ so that the mean inhibitory conductance equals the specified value $G_{\\mathrm{mean}}$.\n\nFor each test case, simulate the above system with depressing PV$\\rightarrow$E synapses and with facilitating PV$\\rightarrow$E synapses, each with its own $g_{IE,\\max}$ computed from the corresponding $(U, \\tau_{\\mathrm{rec}}, \\tau_{\\mathrm{fac}})$ and $r_0$, but identical $G_{\\mathrm{mean}}$. Use forward Euler numerical integration with fixed time step $\\Delta t$ over total time $T_{\\mathrm{total}}$, and discard an initial transient of duration $T_{\\mathrm{trans}}$ before measuring oscillation properties. Let $E_{\\mathrm{win}}(t)$ denote $E(t)$ restricted to the post-transient window. Define oscillation amplitude $A$ as the difference between the mean of all local maxima of $E_{\\mathrm{win}}(t)$ and the mean of all local minima of $E_{\\mathrm{win}}(t)$, expressed in $\\mathrm{Hz}$. Define oscillation frequency $f$ as the reciprocal of the mean inter-peak interval of $E_{\\mathrm{win}}(t)$, expressed in $\\mathrm{Hz}$. If fewer than two peaks are found, define $f = 0$; if fewer than one peak or one trough is found, define $A = 0$.\n\nCompute, for each test case, the effect of replacing depressing PV$\\rightarrow$E synapses with facilitating ones on Pyramidal-Interneuron Network Gamma (PING) oscillation amplitude and frequency, holding mean conductance constant, by reporting the differences\n$$\n\\Delta A = A_{\\mathrm{fac}} - A_{\\mathrm{dep}},\\quad\n\\Delta f = f_{\\mathrm{fac}} - f_{\\mathrm{dep}},\n$$\nwhere the subscripts $\\mathrm{fac}$ and $\\mathrm{dep}$ refer to facilitating and depressing conditions, respectively. Express both $A$ and $f$ in $\\mathrm{Hz}$.\n\nUse the following fixed model and numerical parameters, which are scientifically plausible and consistent with advanced graduate-level computational neuroscience modeling:\n- Numerical integration: $\\Delta t = 0.0005\\,\\mathrm{s}$, $T_{\\mathrm{total}} = 2.0\\,\\mathrm{s}$, $T_{\\mathrm{trans}} = 1.0\\,\\mathrm{s}$.\n- Rate model parameters: $r_{E,\\max} = 80\\,\\mathrm{Hz}$, $r_{I,\\max} = 150\\,\\mathrm{Hz}$, $a_E = 0.15$, $a_I = 0.15$, $\\theta_E = 20$, $\\theta_I = 15$.\n- Time constants: $\\tau_E = 0.02\\,\\mathrm{s}$, $\\tau_I = 0.01\\,\\mathrm{s}$, $\\tau_h = 0.005\\,\\mathrm{s}$.\n- Synaptic plasticity parameters:\n  - Depressing: $U_{\\mathrm{dep}} = 0.5$, $\\tau_{\\mathrm{rec,dep}} = 0.7\\,\\mathrm{s}$, $\\tau_{\\mathrm{fac,dep}} = 0.05\\,\\mathrm{s}$.\n  - Facilitating: $U_{\\mathrm{fac}} = 0.05$, $\\tau_{\\mathrm{rec,fac}} = 0.2\\,\\mathrm{s}$, $\\tau_{\\mathrm{fac,fac}} = 0.7\\,\\mathrm{s}$.\n\nProvide a test suite of three cases that vary network coupling and drive to test different dynamical regimes:\n- Test case $1$ (typical PING): $w_{EE} = 0.0$, $w_{IE} = 2.5$, $P = 35$, $Q = 0$, $G_{\\mathrm{mean}} = 0.2$, $r_0 = 30$.\n- Test case $2$ (near-threshold): $w_{EE} = 0.0$, $w_{IE} = 1.6$, $P = 22$, $Q = 0$, $G_{\\mathrm{mean}} = 0.2$, $r_0 = 20$.\n- Test case $3$ (strong coupling): $w_{EE} = 0.2$, $w_{IE} = 3.2$, $P = 40$, $Q = 0$, $G_{\\mathrm{mean}} = 0.25$, $r_0 = 35$.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, where each element is the two-element list $[\\Delta A,\\Delta f]$ for the corresponding test case, for example, $[[\\Delta A_1,\\Delta f_1],[\\Delta A_2,\\Delta f_2],[\\Delta A_3,\\Delta f_3]]$. All amplitudes and frequencies must be expressed in $\\mathrm{Hz}$ and appear as floating-point numbers.",
            "solution": "The problem has been validated as scientifically sound, well-posed, and objective. It presents a clearly defined task in computational neuroscience that is based on established models and principles. All necessary equations, parameters, and analysis procedures are provided, allowing for a unique and verifiable solution.\n\nThe problem asks for the simulation of a five-variable system of ordinary differential equations (ODEs) describing a Pyramidal-Interneuron Network Gamma (PING) circuit. The model couples the firing rates of an excitatory population, $E(t)$, and an inhibitory (Parvalbumin, PV) population, $I(t)$, with synaptic dynamics. Specifically, the inhibitory-to-excitatory (PV$\\rightarrow$E) synapse incorporates short-term plasticity (STP), modeled by the Tsodyks-Markram equations for synaptic resource availability, $x(t)$, and utilization, $u(t)$. A fifth variable, $h(t)$, models the first-order kinetics of the inhibitory postsynaptic current.\n\nThe system of ODEs is given by:\n$$\n\\frac{dE}{dt} = \\frac{1}{\\tau_E}\\left[-E + r_{E,\\max}\\,\\sigma_E\\!\\left(w_{EE} E - g_{IE,\\max}\\,h + P - \\theta_E\\right)\\right]\n$$\n$$\n\\frac{dI}{dt} = \\frac{1}{\\tau_I}\\left[-I + r_{I,\\max}\\,\\sigma_I\\!\\left(w_{IE} E + Q - \\theta_I\\right)\\right]\n$$\n$$\n\\frac{dh}{dt} = \\frac{1}{\\tau_h}\\left[-h + u\\,x\\,I\\right]\n$$\n$$\n\\frac{dx}{dt} = \\frac{1 - x}{\\tau_{\\mathrm{rec}}} - u\\,x\\,I\n$$\n$$\n\\frac{du}{dt} = \\frac{U - u}{\\tau_{\\mathrm{fac}}} + U\\,(1 - u)\\,I\n$$\nThe functions $\\sigma_E(z) = (1 + e^{-a_E z})^{-1}$ and $\\sigma_I(z) = (1 + e^{-a_I z})^{-1}$ are the sigmoidal activation functions for the respective populations.\n\nA central component of the problem is the comparison between two types of PV$\\rightarrow$E short-term plasticity: depressing and facilitating. These are defined by distinct parameter sets $(U, \\tau_{\\mathrm{rec}}, \\tau_{\\mathrm{fac}})$. To ensure a fair comparison, the problem mandates that the stationary mean inhibitory conductance is held constant across both conditions. This is achieved by adjusting the maximal conductance, $g_{IE,\\max}$, for each STP type. The adjustment is based on the steady-state value of the synaptic efficacy, $s^\\ast = u^\\ast x^\\ast$, under a constant reference inhibitory firing rate, $r_0$. The steady-state values are:\n$$\nu^\\ast = \\frac{U\\,(1 + \\tau_{\\mathrm{fac}}\\,r_0)}{1 + \\tau_{\\mathrm{fac}}\\,U\\,r_0}, \\quad\nx^\\ast = \\frac{1}{1 + \\tau_{\\mathrm{rec}}\\,u^\\ast\\,r_0}\n$$\nThe maximal conductance is then calculated to satisfy the constraint $g_{IE,\\max}\\, u^\\ast x^\\ast = G_{\\mathrm{mean}}$, yielding:\n$$\ng_{IE,\\max} = \\frac{G_{\\mathrm{mean}}}{u^\\ast x^\\ast}\n$$\nThis normalization ensures that differences in network dynamics arise purely from the dynamic properties of the synapses, not from differences in their average strength.\n\nThe solution is obtained by numerically integrating this system of five ODEs using the forward Euler method with a fixed time step $\\Delta t = 0.0005\\,\\mathrm{s}$ for a total duration of $T_{\\mathrm{total}} = 2.0\\,\\mathrm{s}$. The initial conditions are set to the system's resting state: $E(0)=0$, $I(0)=0$, $h(0)=0$, $x(0)=1$ (all resources available), and $u(0)=U$ (utilization at its baseline).\n\nAfter the simulation, an initial transient period of $T_{\\mathrm{trans}} = 1.0\\,\\mathrm{s}$ is discarded from the time series of the excitatory firing rate, $E(t)$. The analysis is performed on the remaining window, $E_{\\mathrm{win}}(t)$. Oscillation amplitude, $A$, is computed as the difference between the mean of all local maxima (peaks) and the mean of all local minima (troughs) of $E_{\\mathrm{win}}(t)$. Oscillation frequency, $f$, is calculated as the reciprocal of the mean time interval between consecutive peaks. The problem specifies that if fewer than two peaks are detected, $f=0$, and if fewer than one peak or one trough is found, $A=0$. These extrema are identified using a standard peak-finding algorithm.\n\nFor each of the three test cases, this entire procedure (normalization, simulation, and analysis) is performed twice: once with the 'depressing' STP parameters and once with the 'facilitating' STP parameters. The final result for each case is the set of differences:\n$$\n\\Delta A = A_{\\mathrm{fac}} - A_{\\mathrm{dep}}\n$$\n$$\n\\Delta f = f_{\\mathrm{fac}} - f_{\\mathrm{dep}}\n$$\nThe implementation will be modular, with a primary function to manage the test cases and a helper function to execute a single simulation run for a given set of parameters. This design facilitates clarity and correctness in applying the specified logic for each condition to be tested. The use of `numpy` is essential for efficient array manipulation and `scipy.signal.find_peaks` provides a robust method for detecting the extrema required for the analysis.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Solves the computational neuroscience problem by simulating a two-population\n    mean-field model and analyzing its oscillatory dynamics under different\n    synaptic plasticity conditions.\n    \"\"\"\n\n    # --- Fixed Model and Numerical Parameters ---\n    # Numerical integration\n    dt = 0.0005  # s\n    T_total = 2.0  # s\n    T_trans = 1.0  # s\n    \n    # Rate model parameters\n    r_E_max = 80.0  # Hz\n    r_I_max = 150.0 # Hz\n    a_E = 0.15\n    a_I = 0.15\n    theta_E = 20.0\n    theta_I = 15.0\n    \n    # Time constants\n    tau_E = 0.02   # s\n    tau_I = 0.01   # s\n    tau_h = 0.005  # s\n    \n    # Synaptic plasticity parameters\n    stp_params = {\n        'dep': {'U': 0.5, 'tau_rec': 0.7, 'tau_fac': 0.05},\n        'fac': {'U': 0.05, 'tau_rec': 0.2, 'tau_fac': 0.7}\n    }\n\n    # --- Test Cases ---\n    test_cases = [\n        # case 1: typical PING\n        {'w_EE': 0.0, 'w_IE': 2.5, 'P': 35.0, 'Q': 0.0, 'G_mean': 0.2, 'r0': 30.0},\n        # case 2: near-threshold\n        {'w_EE': 0.0, 'w_IE': 1.6, 'P': 22.0, 'Q': 0.0, 'G_mean': 0.2, 'r0': 20.0},\n        # case 3: strong coupling\n        {'w_EE': 0.2, 'w_IE': 3.2, 'P': 40.0, 'Q': 0.0, 'G_mean': 0.25, 'r0': 35.0},\n    ]\n\n    def sigmoid(z, a):\n        return 1.0 / (1.0 + np.exp(-a * z))\n\n    def run_simulation(case_params, stp_type_params):\n        \"\"\"\n        Runs a single simulation for a given set of network and plasticity parameters.\n        Returns oscillation amplitude (A) and frequency (f).\n        \"\"\"\n        # --- 1. Calculate g_IE_max for mean conductance normalization ---\n        U = stp_type_params['U']\n        tau_rec = stp_type_params['tau_rec']\n        tau_fac = stp_type_params['tau_fac']\n        G_mean = case_params['G_mean']\n        r0 = case_params['r0']\n        \n        u_star = (U * (1.0 + tau_fac * r0)) / (1.0 + tau_fac * U * r0)\n        x_star = 1.0 / (1.0 + tau_rec * u_star * r0)\n        s_star = u_star * x_star\n        g_IE_max = G_mean / s_star if s_star > 1e-9 else 0.0\n\n        # --- 2. Numerical Integration (Forward Euler) ---\n        time_steps = np.arange(0, T_total, dt)\n        num_steps = len(time_steps)\n        \n        # State variables\n        E = np.zeros(num_steps)\n        I = np.zeros(num_steps)\n        h = np.zeros(num_steps)\n        x = np.zeros(num_steps)\n        u = np.zeros(num_steps)\n        \n        # Initial conditions (resting state)\n        x[0] = 1.0\n        u[0] = U\n\n        # Unpack case parameters for the loop\n        w_EE, w_IE, P, Q = case_params['w_EE'], case_params['w_IE'], case_params['P'], case_params['Q']\n\n        for i in range(num_steps - 1):\n            # Arguments for sigmoid functions\n            arg_E = w_EE * E[i] - g_IE_max * h[i] + P - theta_E\n            arg_I = w_IE * E[i] + Q - theta_I\n            \n            # Derivatives\n            dE_dt = (-E[i] + r_E_max * sigmoid(arg_E, a_E)) / tau_E\n            dI_dt = (-I[i] + r_I_max * sigmoid(arg_I, a_I)) / tau_I\n            dh_dt = (-h[i] + u[i] * x[i] * I[i]) / tau_h\n            dx_dt = (1.0 - x[i]) / tau_rec - u[i] * x[i] * I[i]\n            du_dt = (U - u[i]) / tau_fac + U * (1.0 - u[i]) * I[i]\n\n            # Update state variables\n            E[i+1] = E[i] + dt * dE_dt\n            I[i+1] = I[i] + dt * dI_dt\n            h[i+1] = h[i] + dt * dh_dt\n            x[i+1] = x[i] + dt * dx_dt\n            u[i+1] = u[i] + dt * du_dt\n\n        # --- 3. Analysis of Oscillation Properties ---\n        trans_steps = int(T_trans / dt)\n        E_win = E[trans_steps:]\n\n        # Find peaks (local maxima) and troughs (local minima)\n        peaks_indices, _ = find_peaks(E_win)\n        troughs_indices, _ = find_peaks(-E_win)\n        \n        # Calculate Amplitude (A)\n        A = 0.0\n        if len(peaks_indices) > 0 and len(troughs_indices) > 0:\n            mean_peaks = np.mean(E_win[peaks_indices])\n            mean_troughs = np.mean(E_win[troughs_indices])\n            A = mean_peaks - mean_troughs\n\n        # Calculate Frequency (f)\n        f = 0.0\n        if len(peaks_indices) > 1:\n            inter_peak_intervals = np.diff(peaks_indices) * dt\n            mean_interval = np.mean(inter_peak_intervals)\n            f = 1.0 / mean_interval if mean_interval > 0 else 0.0\n\n        return A, f\n\n    results = []\n    for case in test_cases:\n        # Run simulation for depressing synapses\n        A_dep, f_dep = run_simulation(case, stp_params['dep'])\n        \n        # Run simulation for facilitating synapses\n        A_fac, f_fac = run_simulation(case, stp_params['fac'])\n        \n        # Calculate differences\n        delta_A = A_fac - A_dep\n        delta_f = f_fac - f_dep\n        \n        results.append([delta_A, delta_f])\n\n    # Final print statement in the exact required format.\n    # Convert each inner list to its string representation.\n    results_str = [str(res) for res in results]\n    # Join them with commas and enclose in brackets.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}