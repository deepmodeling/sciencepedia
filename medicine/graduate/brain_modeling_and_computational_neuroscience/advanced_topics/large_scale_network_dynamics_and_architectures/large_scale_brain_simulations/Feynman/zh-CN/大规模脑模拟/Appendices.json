{
    "hands_on_practices": [
        {
            "introduction": "大规模脑模拟的基石是对其组成部分——单个神经元的精确建模。本练习探讨了无源神经树突的数值模拟，这通常通过求解电缆方程来实现。通过对显式欧拉法进行线性稳定性分析，您将推导出保证模拟稳定性的最大时间步长 $\\Delta t$，这是确保任何神经模拟结果具有物理真实性的基本技能。",
            "id": "3992898",
            "problem": "考虑一个大规模神经元模拟，其中将树突段建模为一维圆柱形电缆，其半径为 $a$，长度被离散化为大小均匀为 $h$ 的隔室。每段电缆的特征在于单位面积的膜电阻 $R_{m}$、单位面积的膜电容 $C_{m}$ 和轴向电阻率 $R_{a}$。假设该电缆是无源的、空间均匀的，并且没有外部电流驱动。令 $V(x,t)$ 表示跨膜电位。\n\n从圆柱形电缆的标准电气定义出发：单位长度的膜电容 $c_{m} = 2 \\pi a C_{m}$、单位长度的膜电导 $g_{m} = \\frac{2 \\pi a}{R_{m}}$ 和单位长度的轴向电阻 $r_{a} = \\frac{R_{a}}{\\pi a^{2}}$。利用这些定义，推导控制 $V(x,t)$ 的偏微分方程，并识别出以下形式中的有效扩散系数 $D$ 和线性衰减率 $\\lambda$\n$$\n\\frac{\\partial V}{\\partial t} = D \\frac{\\partial^{2} V}{\\partial x^{2}} - \\lambda V.\n$$\n然后，考虑在间距为 $h$ 的均匀网格上使用二阶中心差分进行空间半离散化，并使用时间步长为 $\\Delta t$ 的显式前向欧拉时间积分器。对该半离散系统进行线性稳定性分析，并推导出以 $D$、$\\lambda$ 和 $h$ 表示的、保证显式欧拉格式稳定性的最大时间步长 $\\Delta t_{\\max}$。简要说明应用于相同半离散系统的后向（隐式）欧拉格式的相应稳定性约束。\n\n最后，对以下一组典型的生物物理真实树突参数，数值计算 $\\Delta t_{\\max}$：\n- $R_{m} = 1.0 \\ \\Omega \\cdot \\mathrm{m}^{2}$,\n- $C_{m} = 1.0 \\times 10^{-2} \\ \\mathrm{F} \\cdot \\mathrm{m}^{-2}$,\n- $R_{a} = 1.5 \\ \\Omega \\cdot \\mathrm{m}$,\n- $a = 7.5 \\times 10^{-7} \\ \\mathrm{m}$,\n- $h = 2.5 \\times 10^{-5} \\ \\mathrm{m}$.\n\n将最终的 $\\Delta t_{\\max}$ 以秒为单位表示，并将您的数值答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "该问题要求以特定形式推导无源电缆方程，对其数值解进行线性稳定性分析，并对稳定性极限进行数值评估。\n\n首先，我们推导跨膜电位 $V(x,t)$ 的偏微分方程（PDE）。考虑电缆中一个长度为 $\\Delta x$ 的微小圆柱段。轴向电流 $I_a(x,t)$ 沿 x 轴流动。根据应用于轴向电阻的欧姆定律，长度 $\\Delta x$ 上的电压降与轴向电流和单位长度的轴向电阻 $r_a$ 相关。\n$$\nV(x,t) - V(x+\\Delta x, t) = I_a(x,t) (r_a \\Delta x)\n$$\n两边除以 $\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限，我们得到：\n$$\n-\\frac{\\partial V}{\\partial x} = r_a I_a\n$$\n沿该段的轴向电流变化必须与流出膜的电流相平衡，后者是单位长度的膜电流 $i_m$。根据基尔霍夫电流定律：\n$$\nI_a(x,t) - I_a(x+\\Delta x, t) = i_m \\Delta x\n$$\n两边除以 $\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限，我们有：\n$$\n-\\frac{\\partial I_a}{\\partial x} = i_m\n$$\n膜电流 $i_m$ 有一个电容分量 $i_c = c_m \\frac{\\partial V}{\\partial t}$ 和一个电阻（或泄漏）分量 $i_g = g_m V$，其中 $V$ 是相对于静息电位（假设为 $0$）测量的。因此，$i_m = c_m \\frac{\\partial V}{\\partial t} + g_m V$。将此代入电流守恒方程得到：\n$$\n-\\frac{\\partial I_a}{\\partial x} = c_m \\frac{\\partial V}{\\partial t} + g_m V\n$$\n为了获得关于 $V$ 的单一方程，我们将欧姆定律表达式对 $x$ 求导：\n$$\n-\\frac{\\partial^2 V}{\\partial x^2} = r_a \\frac{\\partial I_a}{\\partial x}\n$$\n从电流守恒定律中代入 $\\frac{\\partial I_a}{\\partial x}$ 的表达式：\n$$\n\\frac{1}{r_a} \\frac{\\partial^2 V}{\\partial x^2} = -( -c_m \\frac{\\partial V}{\\partial t} - g_m V ) = c_m \\frac{\\partial V}{\\partial t} + g_m V\n$$\n重新整理此方程以求解 $\\frac{\\partial V}{\\partial t}$：\n$$\nc_m \\frac{\\partial V}{\\partial t} = \\frac{1}{r_a} \\frac{\\partial^2 V}{\\partial x^2} - g_m V\n$$\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{1}{c_m r_a} \\frac{\\partial^2 V}{\\partial x^2} - \\frac{g_m}{c_m} V\n$$\n该方程符合所要求的形式 $\\frac{\\partial V}{\\partial t} = D \\frac{\\partial^2 V}{\\partial x^2} - \\lambda V$。通过比较，我们识别出扩散系数 $D$ 和线性衰减率 $\\lambda$：\n$$\nD = \\frac{1}{c_m r_a} \\quad \\text{和} \\quad \\lambda = \\frac{g_m}{c_m}\n$$\n使用所提供的定义 $c_{m} = 2 \\pi a C_{m}$、$g_{m} = \\frac{2 \\pi a}{R_{m}}$ 和 $r_{a} = \\frac{R_{a}}{\\pi a^{2}}$，我们发现：\n$$\nD = \\frac{1}{(2 \\pi a C_{m}) (\\frac{R_{a}}{\\pi a^{2}})} = \\frac{\\pi a^2}{2 \\pi a C_m R_a} = \\frac{a}{2 C_m R_a}\n$$\n$$\n\\lambda = \\frac{2 \\pi a / R_{m}}{2 \\pi a C_{m}} = \\frac{1}{R_m C_m}\n$$\n\n接下来，我们进行线性稳定性分析。该偏微分方程使用二阶中心差分对拉普拉斯算子在空间上进行半离散化，其中 $V_j(t) \\approx V(j h, t)$：\n$$\n\\frac{d V_j}{d t} = D \\left( \\frac{V_{j+1} - 2V_j + V_{j-1}}{h^2} \\right) - \\lambda V_j\n$$\n应用时间步长为 $\\Delta t$ 的显式前向欧拉法，其中 $V_j^n \\approx V_j(n \\Delta t)$：\n$$\n\\frac{V_j^{n+1} - V_j^n}{\\Delta t} = D \\left( \\frac{V_{j+1}^n - 2V_j^n + V_{j-1}^n}{h^2} \\right) - \\lambda V_j^n\n$$\n$$\nV_j^{n+1} = V_j^n + \\frac{D \\Delta t}{h^2}(V_{j+1}^n - 2V_j^n + V_{j-1}^n) - \\lambda \\Delta t V_j^n\n$$\n$$\nV_j^{n+1} = \\left(1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t\\right)V_j^n + \\frac{D \\Delta t}{h^2}(V_{j+1}^n + V_{j-1}^n)\n$$\n为了进行冯·诺依曼稳定性分析，我们代入试探解 $V_j^n = G^n e^{i k j h}$，其中 $G$ 是放大因子，$k$ 是波数。\n$$\nG^{n+1} e^{i k j h} = \\left(1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t\\right)G^n e^{i k j h} + \\frac{D \\Delta t}{h^2}(G^n e^{i k (j+1) h} + G^n e^{i k (j-1) h})\n$$\n两边除以 $G^n e^{i k j h}$：\n$$\nG = 1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t + \\frac{D \\Delta t}{h^2}(e^{i k h} + e^{-i k h})\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$：\n$$\nG = 1 - \\lambda \\Delta t - \\frac{2D \\Delta t}{h^2}(1 - \\cos(k h))\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nG = 1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right)\n$$\n为保证稳定性，我们需要 $|G| \\le 1$，这等价于 $-1 \\le G \\le 1$。\n项 $\\lambda \\Delta t + \\frac{4D \\Delta t}{h^2}\\sin^2(\\frac{k h}{2})$ 总是非负的，因为所有参数都是正的。因此，条件 $G \\le 1$ 总是得到满足。\n关键条件是 $G \\ge -1$：\n$$\n1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right) \\ge -1\n$$\n这个不等式必须对所有 $k$ 都成立。最严格的情况（最小的 $G$）发生在 $\\sin^2(\\frac{k h}{2})$ 取最大值时，即 $\\sin^2(\\frac{k h}{2}) = 1$。\n$$\n1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2} \\ge -1\n$$\n$$\n2 \\ge \\lambda \\Delta t + \\frac{4D \\Delta t}{h^2} = \\Delta t \\left(\\lambda + \\frac{4D}{h^2}\\right)\n$$\n这得出了对时间步长的稳定性条件：\n$$\n\\Delta t \\le \\frac{2}{\\lambda + \\frac{4D}{h^2}}\n$$\n因此，最大时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda + \\frac{4D}{h^2}} = \\frac{2h^2}{\\lambda h^2 + 4D}\n$$\n\n对于隐式后向欧拉格式，更新规则是：\n$$\n\\frac{V_j^{n+1} - V_j^n}{\\Delta t} = D \\left( \\frac{V_{j+1}^{n+1} - 2V_j^{n+1} + V_{j-1}^{n+1}}{h^2} \\right) - \\lambda V_j^{n+1}\n$$\n同样的冯·诺依曼分析得出的放大因子为：\n$$\nG = \\frac{1}{1 + \\lambda \\Delta t + \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right)}\n$$\n由于所有参数都是正数，分母总是大于或等于 $1$。因此，对于任何 $\\Delta t > 0$，都有 $0  G \\le 1$。条件 $|G| \\le 1$ 总是满足的，这意味着后向欧拉格式对于此问题是无条件稳定的。$\\Delta t$ 的选择受精度考虑的限制，而不是稳定性。\n\n最后，我们使用给定的数值为显式格式计算 $\\Delta t_{\\max}$：\n$R_{m} = 1.0 \\ \\Omega \\cdot \\mathrm{m}^{2}$，$C_{m} = 1.0 \\times 10^{-2} \\ \\mathrm{F} \\cdot \\mathrm{m}^{-2}$，$R_{a} = 1.5 \\ \\Omega \\cdot \\mathrm{m}$，$a = 7.5 \\times 10^{-7} \\ \\mathrm{m}$，以及 $h = 2.5 \\times 10^{-5} \\ \\mathrm{m}$。\n\n首先，计算 $\\lambda$ 和 $D$：\n$$\n\\lambda = \\frac{1}{R_m C_m} = \\frac{1}{(1.0) (1.0 \\times 10^{-2})} = 100 \\ \\mathrm{s}^{-1}\n$$\n$$\nD = \\frac{a}{2 C_m R_a} = \\frac{7.5 \\times 10^{-7}}{2 (1.0 \\times 10^{-2}) (1.5)} = \\frac{7.5 \\times 10^{-7}}{3.0 \\times 10^{-2}} = 2.5 \\times 10^{-5} \\ \\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}\n$$\n现在，将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda + \\frac{4D}{h^2}} = \\frac{2}{100 + \\frac{4(2.5 \\times 10^{-5})}{(2.5 \\times 10^{-5})^2}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{100 + \\frac{1.0 \\times 10^{-4}}{6.25 \\times 10^{-10}}} = \\frac{2}{100 + 1.6 \\times 10^5} = \\frac{2}{160100}\n$$\n$$\n\\Delta t_{\\max} \\approx 1.249219 \\times 10^{-5} \\ \\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\max} = 1.249 \\times 10^{-5} \\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{1.249 \\times 10^{-5}}$$"
        },
        {
            "introduction": "神经元之间的通信通过突触发生，其动态是事件驱动的，也是大规模模拟的核心。本练习要求您逐步计算一个突触在接收到一连串脉冲时其电导 $g(t)$ 的变化，其中包含了轴突延迟、不应期和饱和等多种生物物理现实。通过这个细致的计算，您将亲身体验事件驱动模拟器的核心逻辑，并理解简单的规则如何产生复杂的状态依赖动态。",
            "id": "3992942",
            "problem": "在一个大尺度事件驱动的脑模拟器中，使用了一个基于电导的突触模型来计算一个脉冲序列的突触后电流。突触后膜被电压钳制在一个恒定的维持电位，因此突触后电流由基于电导的突触的欧姆定律给出，$I(t) = g(t)\\,(E_{\\text{syn}} - V_{\\text{hold}})$，其中 $g(t)$ 是突触电导，$E_{\\text{syn}}$ 是突触反转电位。在脉冲到达之间，突触电导遵循一阶弛豫动力学，并在有效脉冲到达时间（脉冲时间加上轴突延迟）发生瞬时跳变。具体来说，当 $t$ 与有效到达时间不重合时，$g(t)$ 遵循线性常微分方程 $\\tau\\frac{dg}{dt} = -g$，其中 $\\tau$ 是突触时间常数。在有效到达时间 $t_k^{\\text{eff}}$，$g$ 更新为 $g(t_k^{\\text{eff}+}) = \\min\\!\\big(g(t_k^{\\text{eff}-}) + \\Delta g,\\; g_{\\text{sat}}\\big)$，其中 $\\Delta g$ 是每个有效脉冲的瞬时电导增量，$g_{\\text{sat}}$ 是一个硬饱和极限。突触处强制执行绝对不应期：在最近一次有效到达之后，任何发生在持续时间为 $t_{\\text{abs}}$ 的窗口内的脉冲到达都将被忽略（即不产生跳变）。轴突延迟 $d$ 将每个突触前脉冲时间 $t_k$ 移至其假定到达时间 $t_k + d$。\n\n给定一个到电压钳制神经元上的单个突触的以下参数和脉冲时间：\n- 突触时间常数 $\\tau = 5\\,\\mathrm{ms}$。\n- 电导增量 $\\Delta g = 1.2\\,\\mathrm{nS}$。\n- 饱和水平 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。\n- 绝对不应期窗口 $t_{\\text{abs}} = 3.0\\,\\mathrm{ms}$。\n- 轴突延迟 $d = 1.5\\,\\mathrm{ms}$。\n- 突触前脉冲时间 $\\{t_k\\} = \\{0\\,\\mathrm{ms},\\; 2\\,\\mathrm{ms},\\; 3.5\\,\\mathrm{ms},\\; 7\\,\\mathrm{ms},\\; 9\\,\\mathrm{ms}\\}$。\n- 反转电位 $E_{\\text{syn}} = 0\\,\\mathrm{mV}$。\n- 维持电位 $V_{\\text{hold}} = -65\\,\\mathrm{mV}$。\n- 初始电导 $g(0)=0\\,\\mathrm{nS}$。\n\n计算在 $t^\\ast = 10.0\\,\\mathrm{ms}$ 时刻由该脉冲序列在指定动力学下产生的突触后电流 $I(t^\\ast)$，包括轴突延迟、绝对不应期和电导饱和的叠加效应。以纳安为单位表示您的最终答案，并四舍五入到四位有效数字。假设单位转换遵循标准的国际单位制（SI）惯例，当 $E_{\\text{syn}} - V_{\\text{hold}} > 0$ 时，报告一个正值表示内向电流。",
            "solution": "该问题要求计算在特定时间 $t^\\ast = 10.0\\,\\mathrm{ms}$ 的突触后电流 $I(t^\\ast)$，该模型是一个基于电导的突触模型。此模型包含了几个动态特征：脉冲之间电导的指数衰减、脉冲到达时电导的瞬时跳变、轴突延迟、绝对不应期和饱和极限。首先，确认问题陈述的有效性。所有参数均已提供，模型在物理和数学上定义明确，单位一致。该问题具有科学依据，适定、客观且完整。因此，可以推导出一个解。\n\n突触后电流 $I(t)$ 由 $I(t) = g(t)(E_{\\text{syn}} - V_{\\text{hold}})$ 给出，其中 $g(t)$ 是随时间变化的突触电导。我们需要确定在 $t^\\ast = 10.0\\,\\mathrm{ms}$ 时 $g(t)$ 的值。\n\n$g(t)$ 的动力学由两条规则支配：\n1. 在有效脉冲到达之间，电导根据微分方程 $\\tau \\frac{dg}{dt} = -g$ 进行衰减。对于一个从 $t_0$ 开始、电导为 $g(t_0)$ 的时间区间，解为 $g(t) = g(t_0) \\exp\\left(-\\frac{t - t_0}{\\tau}\\right)$。\n2. 在一个有效脉冲到达时间 $t_k^{\\text{eff}}$，电导更新为 $g(t_k^{\\text{eff}+}) = \\min\\left(g(t_k^{\\text{eff}-}) + \\Delta g, g_{\\text{sat}}\\right)$。\n\n对于一个在 $t_k$ 时刻的突触前脉冲，其有效到达时间 $t_k^{\\text{eff}} = t_k + d$，前提是该脉冲不处于不应期。如果一个脉冲的假定到达时间 $t_k + d$ 落在*前一个有效脉冲*的绝对不应期窗口 $t_{\\text{abs}}$ 内，则该脉冲是不应的，因此被忽略。如果最后一个有效脉冲在 $t_{\\text{prev}}^{\\text{eff}}$，那么当 $t_k + d  t_{\\text{prev}}^{\\text{eff}} + t_{\\text{abs}}$ 时，新的脉冲是不应的。\n\n我们给定的参数如下：\n- 突触时间常数 $\\tau = 5\\,\\mathrm{ms}$。\n- 电导增量 $\\Delta g = 1.2\\,\\mathrm{nS}$。\n- 饱和水平 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。\n- 绝对不应期窗口 $t_{\\text{abs}} = 3.0\\,\\mathrm{ms}$。\n- 轴突延迟 $d = 1.5\\,\\mathrm{ms}$。\n- 突触前脉冲时间 $\\{t_k\\} = \\{0\\,\\mathrm{ms},\\; 2\\,\\mathrm{ms},\\; 3.5\\,\\mathrm{ms},\\; 7\\,\\mathrm{ms},\\; 9\\,\\mathrm{ms}\\}$。\n- 反转电位 $E_{\\text{syn}} = 0\\,\\mathrm{mV}$。\n- 维持电位 $V_{\\text{hold}} = -65\\,\\mathrm{mV}$。\n- 初始电导 $g(0) = 0\\,\\mathrm{nS}$。\n\n首先，我们确定有效脉冲到达时间的序列。我们将维护一个变量 $t_{\\text{last\\_eff}}$，表示最近一次有效到达的时间，并初始化为 $-\\infty$。\n\n脉冲 1：$t_1 = 0\\,\\mathrm{ms}$。\n假定到达时间：$t_1^{\\text{putative}} = 0 + d = 1.5\\,\\mathrm{ms}$。\n这是第一个脉冲，所以它不可能处于不应期。这是一个有效脉冲。\n有效到达时间 $t_1^{\\text{eff}} = 1.5\\,\\mathrm{ms}$。更新 $t_{\\text{last\\_eff}} = 1.5\\,\\mathrm{ms}$。\n此脉冲的不应期在 $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 1.5 + 3.0 = 4.5\\,\\mathrm{ms}$ 结束。\n\n脉冲 2：$t_2 = 2\\,\\mathrm{ms}$。\n假定到达时间：$t_2^{\\text{putative}} = 2 + d = 3.5\\,\\mathrm{ms}$。\n检查是否处于不应期：$3.5\\,\\mathrm{ms}  4.5\\,\\mathrm{ms}$ 是否成立？是。\n该脉冲处于第一个有效脉冲的不应期窗口内，因此被忽略。$t_{\\text{last\\_eff}}$ 仍为 $1.5\\,\\mathrm{ms}$。\n\n脉冲 3：$t_3 = 3.5\\,\\mathrm{ms}$。\n假定到达时间：$t_3^{\\text{putative}} = 3.5 + d = 5.0\\,\\mathrm{ms}$。\n检查是否处于不应期：$5.0\\,\\mathrm{ms}  4.5\\,\\mathrm{ms}$ 是否成立？否。\n该脉冲是有效的。\n有效到达时间 $t_2^{\\text{eff}} = 5.0\\,\\mathrm{ms}$。更新 $t_{\\text{last\\_eff}} = 5.0\\,\\mathrm{ms}$。\n此脉冲的不应期在 $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 5.0 + 3.0 = 8.0\\,\\mathrm{ms}$ 结束。\n\n脉冲 4：$t_4 = 7\\,\\mathrm{ms}$。\n假定到达时间：$t_4^{\\text{putative}} = 7 + d = 8.5\\,\\mathrm{ms}$。\n检查是否处于不应期：$8.5\\,\\mathrm{ms}  8.0\\,\\mathrm{ms}$ 是否成立？否。\n该脉冲是有效的。\n有效到达时间 $t_3^{\\text{eff}} = 8.5\\,\\mathrm{ms}$。更新 $t_{\\text{last\\_eff}} = 8.5\\,\\mathrm{ms}$。\n此脉冲的不应期在 $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 8.5 + 3.0 = 11.5\\,\\mathrm{ms}$ 结束。\n\n脉冲 5：$t_5 = 9\\,\\mathrm{ms}$。\n假定到达时间：$t_5^{\\text{putative}} = 9 + d = 10.5\\,\\mathrm{ms}$。\n此到达时间晚于我们的目标时间 $t^\\ast=10.0\\,\\mathrm{ms}$，因此它不影响 $g(10.0)$ 的计算。\n\n影响 $t^\\ast = 10.0\\,\\mathrm{ms}$ 时状态的有效脉冲到达时间为 $\\{1.5\\,\\mathrm{ms},\\; 5.0\\,\\mathrm{ms},\\; 8.5\\,\\mathrm{ms}\\}$。现在我们通过这些事件来模拟电导 $g(t)$。\n\n初始状态：在 $t=0$ 时，$g(0) = 0\\,\\mathrm{nS}$。电导保持为 $0$ 直到第一个有效脉冲到达。\n\n在 $t=t_1^{\\text{eff}} = 1.5\\,\\mathrm{ms}$：\n脉冲到达前瞬间的电导是 $g(1.5^{-}) = g(0) \\exp(-1.5/5) = 0\\,\\mathrm{nS}$。\n电导更新：$g(1.5^{+}) = \\min(g(1.5^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(0 + 1.2, 3.0) = 1.2\\,\\mathrm{nS}$。\n\n在 $t=t_2^{\\text{eff}} = 5.0\\,\\mathrm{ms}$：\n自上一个有效脉冲以来经过的时间是 $\\Delta t_1 = 5.0 - 1.5 = 3.5\\,\\mathrm{ms}$。\n电导衰减至 $g(5.0^{-}) = g(1.5^{+}) \\exp(-\\Delta t_1 / \\tau) = 1.2 \\exp(-3.5/5) = 1.2 \\exp(-0.7)\\,\\mathrm{nS}$。\n电导更新：$g(5.0^{+}) = \\min(g(5.0^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(1.2 \\exp(-0.7) + 1.2, 3.0)\\,\\mathrm{nS}$。\n数值上，$1.2 \\exp(-0.7) + 1.2 \\approx 1.2 \\times 0.4966 + 1.2 \\approx 0.5959 + 1.2 = 1.7959\\,\\mathrm{nS}$，小于 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。所以没有发生饱和。\n$g(5.0^{+}) = 1.2 (\\exp(-0.7) + 1)\\,\\mathrm{nS}$。\n\n在 $t=t_3^{\\text{eff}} = 8.5\\,\\mathrm{ms}$：\n自上一个有效脉冲以来经过的时间是 $\\Delta t_2 = 8.5 - 5.0 = 3.5\\,\\mathrm{ms}$。\n电导衰减至 $g(8.5^{-}) = g(5.0^{+}) \\exp(-\\Delta t_2 / \\tau) = [1.2 (\\exp(-0.7) + 1)] \\exp(-3.5/5) = 1.2 (\\exp(-0.7) + 1) \\exp(-0.7)\\,\\mathrm{nS} = 1.2 (\\exp(-1.4) + \\exp(-0.7))\\,\\mathrm{nS}$。\n电导更新：$g(8.5^{+}) = \\min(g(8.5^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(1.2 (\\exp(-1.4) + \\exp(-0.7)) + 1.2, 3.0)\\,\\mathrm{nS}$。\n数值上，$1.2 (\\exp(-1.4) + \\exp(-0.7)) + 1.2 \\approx 1.2 \\times (0.2466 + 0.4966) + 1.2 \\approx 1.2 \\times 0.7432 + 1.2 = 0.8918 + 1.2 = 2.0918\\,\\mathrm{nS}$，小于 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。没有发生饱和。\n$g(8.5^{+}) = 1.2 (\\exp(-1.4) + \\exp(-0.7) + 1)\\,\\mathrm{nS}$。\n\n最后，我们计算目标时间 $t^\\ast = 10.0\\,\\mathrm{ms}$ 的电导。\n自上一个有效脉冲以来经过的时间是 $\\Delta t_3 = 10.0 - 8.5 = 1.5\\,\\mathrm{ms}$。\n电导从 $t=8.5\\,\\mathrm{ms}$ 时的值开始衰减：\n$g(10.0) = g(8.5^{+}) \\exp(-\\Delta t_3 / \\tau) = \\left[1.2 (\\exp(-1.4) + \\exp(-0.7) + 1)\\right] \\exp(-1.5/5)\\,\\mathrm{nS}$。\n$g(10.0) = 1.2 (\\exp(-1.4) + \\exp(-0.7) + 1) \\exp(-0.3)\\,\\mathrm{nS}$。\n$g(10.0) = 1.2 (\\exp(-1.7) + \\exp(-1.0) + \\exp(-0.3))\\,\\mathrm{nS}$。\n\n现在我们代入数值：\n$\\exp(-0.3) \\approx 0.740818$\n$\\exp(-1.0) \\approx 0.367879$\n$\\exp(-1.7) \\approx 0.182684$\n$g(10.0) \\approx 1.2 \\times (0.182684 + 0.367879 + 0.740818)\\,\\mathrm{nS}$\n$g(10.0) \\approx 1.2 \\times (1.291381)\\,\\mathrm{nS} \\approx 1.549657\\,\\mathrm{nS}$。\n\n然后计算突触后电流 $I(t^\\ast)$：\n$I(10.0) = g(10.0) \\times (E_{\\text{syn}} - V_{\\text{hold}})$\n$E_{\\text{syn}} - V_{\\text{hold}} = 0\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = 65\\,\\mathrm{mV}$。\n$I(10.0) \\approx (1.549657\\,\\mathrm{nS}) \\times (65\\,\\mathrm{mV})$。\n单位的乘积是 $(\\mathrm{nS}) \\times (\\mathrm{mV}) = (10^{-9}\\,\\mathrm{S}) \\times (10^{-3}\\,\\mathrm{V}) = 10^{-12}\\,\\mathrm{A} = 1\\,\\mathrm{pA}$。\n$I(10.0) \\approx 1.549657 \\times 65\\,\\mathrm{pA} \\approx 100.7277\\,\\mathrm{pA}$。\n\n问题要求答案以纳安（nA）为单位。因为 $1\\,\\mathrm{nA} = 1000\\,\\mathrm{pA}$：\n$I(10.0) \\approx \\frac{100.7277}{1000}\\,\\mathrm{nA} \\approx 0.1007277\\,\\mathrm{nA}$。\n\n四舍五入到四位有效数字，我们得到 $0.1007\\,\\mathrm{nA}$。问题指定当 $E_{\\text{syn}} - V_{\\text{hold}} > 0$ 时，报告一个正值表示内向电流。我们的驱动力是正的，我们计算出的电流也是正的，这与内向电流一致。",
            "answer": "$$\n\\boxed{0.1007}\n$$"
        },
        {
            "introduction": "我们将视角从单个组件放大到整个系统。模拟一个庞大的神经网络需要高效的计算策略，而算法的选择至关重要。本练习通过比较时间驱动和事件驱动两种主流方法的性能，提供了一个关于模拟器设计的高层次视角，您将量化分析在稀疏连接和低发放率的典型脑网络条件下，为何事件驱动方法通常更优。",
            "id": "3992895",
            "problem": "一个大规模脉冲网络通过两种后端策略进行模拟：一种是基于优先队列的事件驱动引擎，另一种是固定步长的时间驱动循环。该网络有 $N$ 个神经元，每个神经元以概率 $p$ 独立地连接到其他神经元，因此期望出度为 $K = p\\,(N-1) \\approx p\\,N$，期望有向突触总数为 $M \\approx N\\,K$。每个神经元根据速率为 $r$ (单位：$\\text{s}^{-1}$) 的齐次泊松过程发放脉冲。对于每个突触前脉冲，每个输出突触以独立的概率 $q$ 进行释放；一次成功的释放会产生一个带有传导延迟的突触后传递事件，该事件被调度以便未来传递。\n\n事件驱动引擎使用一个日历队列 (CQ) 优先队列来管理延迟的突触后事件。对于每次实现的突触传递，引擎会执行一次到 CQ 的插入操作，一次在事件到期时的移除操作，以及一次突触后突触更新。假设每次操作的成本是恒定的：每次 CQ 插入的成本为 $c_{\\mathrm{ins}}$，每次 CQ 移除的成本为 $c_{\\mathrm{pop}}$，每次突触后突触更新的成本为 $c_{\\mathrm{evt}}$。假设系统处于平稳状态，因此在期望上，每单位模拟时间的插入次数等于移除次数。相对于这些主要操作，忽略所有其他成本（例如，突触前更新的开销）。\n\n时间驱动引擎以大小为 $\\Delta t$ (单位：$\\text{s}$) 的固定时间步长推进。在每个时间步，它会遍历所有突触，无论是否发生突触前脉冲，都确定性地更新它们的状态（例如，指数衰减），每个突触每步的成本是恒定的 $c_{\\mathrm{step}}$。相对于这个主要的每步突触循环，忽略任何额外的脉冲处理开销。\n\n假设有一个中央处理器 (CPU)，它每物理秒可以执行固定数量的基本操作，且该数量对两个引擎都相同，因此模拟时间吞吐量与每单位模拟时间所需基本操作的期望数量成反比。定义事件驱动引擎相对于时间驱动引擎的加速比 $\\mathcal{S}$ 为每单位模拟时间的期望操作计数之比，即 $\\mathcal{S} = C_{\\mathrm{TD}}/C_{\\mathrm{ED}}$，其中 $C_{\\mathrm{TD}}$ 和 $C_{\\mathrm{ED}}$ 分别是时间驱动和事件驱动引擎每单位模拟时间的期望操作计数。\n\n给定以下参数：\n- $N = 10^{6}$，\n- $p = 10^{-3}$，\n- $r = 5$，\n- $q = 0.2$，\n- $\\Delta t = 10^{-4}$，\n- $c_{\\mathrm{ins}} = 3$，\n- $c_{\\mathrm{pop}} = 2$，\n- $c_{\\mathrm{evt}} = 1$，\n- $c_{\\mathrm{step}} = 1$，\n\n计算 $\\mathcal{S}$ 的数值。将答案四舍五入到三位有效数字。将最终加速比表示为一个无单位的无量纲因子。",
            "solution": "首先验证该问题，以确保其具有科学依据、是适定的和客观的。\n\n### 步骤 1：提取给定条件\n- 神经元数量：$N = 10^{6}$\n- 连接概率：$p = 10^{-3}$\n- 期望出度：$K = p\\,(N-1) \\approx p\\,N$\n- 期望突触总数：$M \\approx N\\,K$\n- 每个神经元的脉冲速率：$r = 5 \\, \\text{s}^{-1}$\n- 突触释放概率：$q = 0.2$\n- 时间驱动模拟的时间步长：$\\Delta t = 10^{-4} \\, \\text{s}$\n- 事件驱动每次插入的成本：$c_{\\mathrm{ins}} = 3$\n- 事件驱动每次移除的成本：$c_{\\mathrm{pop}} = 2$\n- 事件驱动每次突触后更新的成本：$c_{\\mathrm{evt}} = 1$\n- 时间驱动每个突触每步的成本：$c_{\\mathrm{step}} = 1$\n- 加速比的定义：$\\mathcal{S} = C_{\\mathrm{TD}}/C_{\\mathrm{ED}}$，其中 $C_{\\mathrm{TD}}$ 和 $C_{\\mathrm{ED}}$ 分别为时间驱动和事件驱动引擎每单位模拟时间的期望操作计数。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题描述了针对大规模脉冲神经网络的两种常见模拟算法（事件驱动与时间驱动）之间的标准性能比较。模型中的假设，如泊松脉冲发放和概率性突触，在理论和计算神经科学中是标准的，用于创建易于处理且信息丰富的模型。所有参数都有定义，其数值对于此类模拟在物理上和计算上都是合理的。成本函数是简化的，但为比较提供了清晰、可形式化的基础。该问题是自洽的，在计算神经科学方面有科学依据，并且是适定的。没有矛盾、歧义或事实错误。\n\n### 步骤 3：结论与行动\n问题有效。继续进行求解。\n\n目标是计算加速比 $\\mathcal{S}$，定义为时间驱动（$C_{\\mathrm{TD}}$）和事件驱动（$C_{\\mathrm{ED}}$）引擎每单位模拟时间的总期望操作计数之比：\n$$\n\\mathcal{S} = \\frac{C_{\\mathrm{TD}}}{C_{\\mathrm{ED}}}\n$$\n\n首先，我们推导 $C_{\\mathrm{ED}}$ 的表达式，即事件驱动引擎每单位模拟时间的期望操作计数。该引擎中的成本与实现的突触传递事件的数量成正比。\n整个网络的总脉冲速率是神经元数量 $N$ 乘以单个神经元的发放速率 $r$。\n$$\n\\text{总脉冲速率} = N \\cdot r\n$$\n每个神经元的期望出度为 $K \\approx pN$。每次脉冲时，一个信号被发送到 $K$ 个输出突触。这些突触中的每一个随后以概率 $q$ 释放。因此，每个突触前脉冲期望实现的传递事件数为 $K \\cdot q$。\n网络中实现突触传递事件的总速率 $R_{\\mathrm{event}}$ 是总脉冲速率与每次脉冲期望传递次数的乘积。\n$$\nR_{\\mathrm{event}} = (N \\cdot r) \\cdot (K \\cdot q)\n$$\n使用近似 $K \\approx pN$，我们得到：\n$$\nR_{\\mathrm{event}} \\approx (N \\cdot r) \\cdot (p \\cdot N \\cdot q) = N^2 p r q\n$$\n对于每个实现的传递事件，引擎执行一次插入、一次移除和一次突触后更新。每个事件的总成本是 $(c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})$。\n每单位模拟时间的总期望操作计数 $C_{\\mathrm{ED}}$ 是事件速率乘以每个事件的成本。\n$$\nC_{\\mathrm{ED}} = R_{\\mathrm{event}} \\cdot (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}}) \\approx N^2 p r q (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})\n$$\n\n接下来，我们推导 $C_{\\mathrm{TD}}$ 的表达式，即时间驱动引擎每单位模拟时间的期望操作计数。该引擎以大小为 $\\Delta t$ 的离散时间步长推进。每单位模拟时间的模拟步数是 $1/\\Delta t$。\n在每个时间步，引擎更新网络中每个突触的状态。突触总数是 $M \\approx N K \\approx N(pN) = N^2 p$。\n每个突触每个时间步的成本是 $c_{\\mathrm{step}}$。因此，每个时间步的总操作计数是 $M \\cdot c_{\\mathrm{step}} \\approx N^2 p c_{\\mathrm{step}}$。\n每单位模拟时间的总期望操作计数 $C_{\\mathrm{TD}}$ 是每个时间步的成本乘以每单位时间的步数。\n$$\nC_{\\mathrm{TD}} = (M \\cdot c_{\\mathrm{step}}) \\cdot \\frac{1}{\\Delta t} \\approx \\frac{N^2 p c_{\\mathrm{step}}}{\\Delta t}\n$$\n\n现在我们可以通过计算 $C_{\\mathrm{TD}}$ 与 $C_{\\mathrm{ED}}$ 的比率来计算加速比 $\\mathcal{S}$。\n$$\n\\mathcal{S} = \\frac{C_{\\mathrm{TD}}}{C_{\\mathrm{ED}}} \\approx \\frac{\\frac{N^2 p c_{\\mathrm{step}}}{\\Delta t}}{N^2 p r q (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})}\n$$\n项 $N^2 p$ 从分子和分母中消去。这表明对于该模型，两个引擎的相对性能与网络大小和连接概率无关。\n$$\n\\mathcal{S} = \\frac{c_{\\mathrm{step}}}{\\Delta t \\cdot r \\cdot q \\cdot (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})}\n$$\n我们现在将给定的数值代入此表达式：\n- $c_{\\mathrm{step}} = 1$\n- $\\Delta t = 10^{-4}$\n- $r = 5$\n- $q = 0.2$\n- $c_{\\mathrm{ins}} = 3$\n- $c_{\\mathrm{pop}} = 2$\n- $c_{\\mathrm{evt}} = 1$\n\n事件驱动的成本总和是 $(c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}}) = (3 + 2 + 1) = 6$。\n分母中的乘积是 $\\Delta t \\cdot r \\cdot q = 10^{-4} \\cdot 5 \\cdot 0.2 = 10^{-4} \\cdot 1 = 10^{-4}$。\n将这些代入 $\\mathcal{S}$ 的表达式中：\n$$\n\\mathcal{S} = \\frac{1}{10^{-4} \\cdot 6} = \\frac{1}{6 \\times 10^{-4}} = \\frac{10^4}{6} = \\frac{10000}{6} = 1666.666...\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\n\\mathcal{S} \\approx 1670\n$$\n以所要求的科学记数法格式表示：\n$$\n\\mathcal{S} \\approx 1.67 \\times 10^{3}\n$$\n这个结果表明，在给定的参数和成本模型下，事件驱动引擎预计比时间驱动引擎快大约 $1670$ 倍。",
            "answer": "$$\n\\boxed{1.67 \\times 10^{3}}\n$$"
        }
    ]
}