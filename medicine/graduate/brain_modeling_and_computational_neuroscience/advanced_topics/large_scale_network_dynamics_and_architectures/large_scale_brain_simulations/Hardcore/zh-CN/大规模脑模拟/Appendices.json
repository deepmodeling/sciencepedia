{
    "hands_on_practices": [
        {
            "introduction": "在构建大规模脑模拟时，一个基本任务是准确地求解描述神经元电压动态的微分方程。这个练习将带你深入了解模拟生物物理学上精细的神经元时所面临的核心数值挑战。通过分析无源电缆方程的数值解法，你将亲手推导显式和隐式积分方案的稳定性条件，这对于在保证模拟结果物理真实性的同时，最大限度地提高计算效率至关重要。",
            "id": "3992898",
            "problem": "考虑一个大规模神经元模拟，其中树突段被模拟为半径为 $a$ 的一维圆柱形电缆，其长度被离散化为大小均匀的隔室，尺寸为 $h$。每个电缆的特征是单位面积的膜电阻 $R_{m}$、单位面积的膜电容 $C_{m}$ 和轴向电阻率 $R_{a}$。假设电缆是无源的、空间均匀的，并且没有外部电流驱动。令 $V(x,t)$ 表示跨膜电位。\n\n从圆柱形电缆的标准电气定义出发：单位长度的膜电容 $c_{m} = 2 \\pi a C_{m}$，单位长度的膜电导 $g_{m} = \\frac{2 \\pi a}{R_{m}}$，以及单位长度的轴向电阻 $r_{a} = \\frac{R_{a}}{\\pi a^{2}}$。使用这些定义，推导控制 $V(x,t)$ 的偏微分方程，并以下列形式确定有效扩散系数 $D$ 和线性衰减率 $\\lambda$\n$$\n\\frac{\\partial V}{\\partial t} = D \\frac{\\partial^{2} V}{\\partial x^{2}} - \\lambda V.\n$$\n然后，考虑一个空间半离散化方案，该方案在间距为 $h$ 的均匀网格上使用二阶中心差分，并使用时间步长为 $\\Delta t$ 的显式前向欧拉时间积分器。对该半离散系统进行线性稳定性分析，并根据 $D$、$\\lambda$ 和 $h$ 推导出保证显式欧拉格式稳定性的最大时间步长 $\\Delta t_{\\max}$。简要解释应用于同一半离散系统的后向（隐式）欧拉格式的相应稳定性约束。\n\n最后，对以下一组典型的生物物理真实树突参数，数值计算 $\\Delta t_{\\max}$：\n- $R_{m} = 1.0 \\ \\Omega \\cdot \\mathrm{m}^{2}$,\n- $C_{m} = 1.0 \\times 10^{-2} \\ \\mathrm{F} \\cdot \\mathrm{m}^{-2}$,\n- $R_{a} = 1.5 \\ \\Omega \\cdot \\mathrm{m}$,\n- $a = 7.5 \\times 10^{-7} \\ \\mathrm{m}$,\n- $h = 2.5 \\times 10^{-5} \\ \\mathrm{m}$。\n\n用秒表示最终的 $\\Delta t_{\\max}$，并将您的数值答案四舍五入到四位有效数字。最终答案必须是单个实数。",
            "solution": "该问题要求以特定形式推导无源电缆方程，对其数值解进行线性稳定性分析，并对稳定性极限进行数值评估。\n\n首先，我们推导跨膜电位 $V(x,t)$ 的偏微分方程（PDE）。考虑电缆上一个长度为 $\\Delta x$ 的微小圆柱段。轴向电流 $I_a(x,t)$ 沿 x 轴流动。根据应用于轴向电阻的欧姆定律，长度 $\\Delta x$ 上的电压降与轴向电流和单位长度轴向电阻 $r_a$ 相关。\n$$\nV(x,t) - V(x+\\Delta x, t) = I_a(x,t) (r_a \\Delta x)\n$$\n两边除以 $\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限，我们得到：\n$$\n-\\frac{\\partial V}{\\partial x} = r_a I_a\n$$\n沿该段轴向电流的变化必须由流出膜的电流平衡，即单位长度的膜电流 $i_m$。根据基尔霍夫电流定律：\n$$\nI_a(x,t) - I_a(x+\\Delta x, t) = i_m \\Delta x\n$$\n两边除以 $\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限，我们有：\n$$\n-\\frac{\\partial I_a}{\\partial x} = i_m\n$$\n膜电流 $i_m$ 有一个电容分量 $i_c = c_m \\frac{\\partial V}{\\partial t}$ 和一个电阻（或漏电）分量 $i_g = g_m V$，其中 $V$ 是相对于静息电位（假定为 $0$）测量的。因此，$i_m = c_m \\frac{\\partial V}{\\partial t} + g_m V$。将此代入电流守恒方程得到：\n$$\n-\\frac{\\partial I_a}{\\partial x} = c_m \\frac{\\partial V}{\\partial t} + g_m V\n$$\n为了得到一个关于 $V$ 的单一方程，我们将欧姆定律表达式对 $x$ 求导：\n$$\n-\\frac{\\partial^2 V}{\\partial x^2} = r_a \\frac{\\partial I_a}{\\partial x}\n$$\n从电流守恒定律代入 $\\frac{\\partial I_a}{\\partial x}$ 的表达式：\n$$\n\\frac{1}{r_a} \\frac{\\partial^2 V}{\\partial x^2} = -( -c_m \\frac{\\partial V}{\\partial t} - g_m V ) = c_m \\frac{\\partial V}{\\partial t} + g_m V\n$$\n重新整理此方程以求解 $\\frac{\\partial V}{\\partial t}$：\n$$\nc_m \\frac{\\partial V}{\\partial t} = \\frac{1}{r_a} \\frac{\\partial^2 V}{\\partial x^2} - g_m V\n$$\n$$\n\\frac{\\partial V}{\\partial t} = \\frac{1}{c_m r_a} \\frac{\\partial^2 V}{\\partial x^2} - \\frac{g_m}{c_m} V\n$$\n该方程符合所要求的形式 $\\frac{\\partial V}{\\partial t} = D \\frac{\\partial^2 V}{\\partial x^2} - \\lambda V$。通过比较，我们确定扩散系数 $D$ 和线性衰减率 $\\lambda$：\n$$\nD = \\frac{1}{c_m r_a} \\quad \\text{和} \\quad \\lambda = \\frac{g_m}{c_m}\n$$\n使用给定的定义 $c_{m} = 2 \\pi a C_{m}$，$g_{m} = \\frac{2 \\pi a}{R_{m}}$，和 $r_{a} = \\frac{R_{a}}{\\pi a^{2}}$，我们发现：\n$$\nD = \\frac{1}{(2 \\pi a C_{m}) (\\frac{R_{a}}{\\pi a^{2}})} = \\frac{\\pi a^2}{2 \\pi a C_m R_a} = \\frac{a}{2 C_m R_a}\n$$\n$$\n\\lambda = \\frac{2 \\pi a / R_{m}}{2 \\pi a C_{m}} = \\frac{1}{R_m C_m}\n$$\n\n接下来，我们进行线性稳定性分析。PDE 在空间上使用二阶中心差分对拉普拉斯算子进行半离散化，其中 $V_j(t) \\approx V(j h, t)$：\n$$\n\\frac{d V_j}{d t} = D \\left( \\frac{V_{j+1} - 2V_j + V_{j-1}}{h^2} \\right) - \\lambda V_j\n$$\n应用时间步长为 $\\Delta t$ 的显式前向欧拉法，其中 $V_j^n \\approx V_j(n \\Delta t)$：\n$$\n\\frac{V_j^{n+1} - V_j^n}{\\Delta t} = D \\left( \\frac{V_{j+1}^n - 2V_j^n + V_{j-1}^n}{h^2} \\right) - \\lambda V_j^n\n$$\n$$\nV_j^{n+1} = V_j^n + \\frac{D \\Delta t}{h^2}(V_{j+1}^n - 2V_j^n + V_{j-1}^n) - \\lambda \\Delta t V_j^n\n$$\n$$\nV_j^{n+1} = \\left(1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t\\right)V_j^n + \\frac{D \\Delta t}{h^2}(V_{j+1}^n + V_{j-1}^n)\n$$\n为了进行冯·诺伊曼稳定性分析，我们代入试探解 $V_j^n = G^n e^{i k j h}$，其中 $G$ 是放大因子， $k$ 是波数。\n$$\nG^{n+1} e^{i k j h} = \\left(1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t\\right)G^n e^{i k j h} + \\frac{D \\Delta t}{h^2}(G^n e^{i k (j+1) h} + G^n e^{i k (j-1) h})\n$$\n两边除以 $G^n e^{i k j h}$：\n$$\nG = 1 - \\frac{2D \\Delta t}{h^2} - \\lambda \\Delta t + \\frac{D \\Delta t}{h^2}(e^{i k h} + e^{-i k h})\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$：\n$$\nG = 1 - \\lambda \\Delta t - \\frac{2D \\Delta t}{h^2}(1 - \\cos(k h))\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nG = 1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right)\n$$\n为保证稳定性，我们需要 $|G| \\le 1$，这等价于 $-1 \\le G \\le 1$。\n由于所有参数均为正，项 $\\lambda \\Delta t + \\frac{4D \\Delta t}{h^2}\\sin^2(\\frac{k h}{2})$ 始终为非负。因此，$G \\le 1 - \\lambda \\Delta t \\le 1$，所以条件 $G \\le 1$ 得到满足。\n关键条件是 $G \\ge -1$：\n$$\n1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right) \\ge -1\n$$\n该不等式必须对所有 $k$ 成立。最严格的情况（$G$ 最小）发生在 $\\sin^2(\\frac{k h}{2})$ 最大时，即 $\\sin^2(\\frac{k h}{2}) = 1$。\n$$\n1 - \\lambda \\Delta t - \\frac{4D \\Delta t}{h^2} \\ge -1\n$$\n$$\n2 \\ge \\lambda \\Delta t + \\frac{4D \\Delta t}{h^2} = \\Delta t \\left(\\lambda + \\frac{4D}{h^2}\\right)\n$$\n这得出了关于时间步长的稳定性条件：\n$$\n\\Delta t \\le \\frac{2}{\\lambda + \\frac{4D}{h^2}}\n$$\n因此，最大时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda + \\frac{4D}{h^2}} = \\frac{2h^2}{\\lambda h^2 + 4D}\n$$\n\n对于隐式后向欧拉格式，更新规则是：\n$$\n\\frac{V_j^{n+1} - V_j^n}{\\Delta t} = D \\left( \\frac{V_{j+1}^{n+1} - 2V_j^{n+1} + V_{j-1}^{n+1}}{h^2} \\right) - \\lambda V_j^{n+1}\n$$\n同样的冯·诺伊曼分析得出放大因子为：\n$$\nG = \\frac{1}{1 + \\lambda \\Delta t + \\frac{4D \\Delta t}{h^2}\\sin^2\\left(\\frac{k h}{2}\\right)}\n$$\n由于所有参数均为正，分母总是大于或等于 $1$。因此，对于任何 $\\Delta t > 0$，都有 $0  G \\le 1$。条件 $|G| \\le 1$ 总是满足，这意味着后向欧拉格式对于此问题是无条件稳定的。$\\Delta t$ 的选择受精度考虑的限制，而不是稳定性。\n\n最后，我们使用给定的数值计算显式格式的 $\\Delta t_{\\max}$：\n$R_{m} = 1.0 \\ \\Omega \\cdot \\mathrm{m}^{2}$，$C_{m} = 1.0 \\times 10^{-2} \\ \\mathrm{F} \\cdot \\mathrm{m}^{-2}$，$R_{a} = 1.5 \\ \\Omega \\cdot \\mathrm{m}$，$a = 7.5 \\times 10^{-7} \\ \\mathrm{m}$，以及 $h = 2.5 \\times 10^{-5} \\ \\mathrm{m}$。\n\n首先，计算 $\\lambda$ 和 $D$：\n$$\n\\lambda = \\frac{1}{R_m C_m} = \\frac{1}{(1.0) (1.0 \\times 10^{-2})} = 100 \\ \\mathrm{s}^{-1}\n$$\n$$\nD = \\frac{a}{2 C_m R_a} = \\frac{7.5 \\times 10^{-7}}{2 (1.0 \\times 10^{-2}) (1.5)} = \\frac{7.5 \\times 10^{-7}}{3.0 \\times 10^{-2}} = 2.5 \\times 10^{-5} \\ \\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}\n$$\n现在，将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda + \\frac{4D}{h^2}} = \\frac{2}{100 + \\frac{4(2.5 \\times 10^{-5})}{(2.5 \\times 10^{-5})^2}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{2}{100 + \\frac{1.0 \\times 10^{-4}}{6.25 \\times 10^{-10}}} = \\frac{2}{100 + 1.6 \\times 10^5} = \\frac{2}{160100}\n$$\n$$\n\\Delta t_{\\max} \\approx 1.249219 \\times 10^{-5} \\ \\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\max} = 1.249 \\times 10^{-5} \\ \\mathrm{s}\n$$",
            "answer": "$$\\boxed{1.249 \\times 10^{-5}}$$"
        },
        {
            "introduction": "神经元通过突触进行离散的、事件驱动的通信，这与神经元内部连续的电压动态形成了对比。这个练习模拟了一个事件驱动模拟器的核心逻辑，让你精确追踪单个突触在响应一系列脉冲时其电导的变化。通过处理轴突延迟、不应期和电导饱和等复杂的非线性动力学，你将对在尖峰神经网络模拟中实现突触可塑性和信息传递的计算机制有更深刻的理解。",
            "id": "3992942",
            "problem": "一个基于电导的突触模型被用于一个大规模、事件驱动的大脑模拟器中，以计算一个脉冲序列的突触后电流。突触后膜被电压钳制在一个恒定的维持电位上，因此突触后电流由基于电导的突触的欧姆定律给出，$I(t) = g(t)\\,(E_{\\text{syn}} - V_{\\text{hold}})$，其中 $g(t)$ 是突触电导，$E_{\\text{syn}}$ 是突触反转电位。在脉冲到达之间，突触电导遵循一阶弛豫动力学，并在有效脉冲到达时间（脉冲时间加上轴突延迟）发生瞬时跳变。具体来说，当 $t$ 与有效到达时间不重合时，$g(t)$ 遵循线性常微分方程 $\\tau \\,\\frac{dg}{dt} = -g$，其中 $\\tau$ 是突触时间常数。在一个有效到达时间 $t_k^{\\text{eff}}$，$g$ 被更新为 $g(t_k^{\\text{eff}+}) = \\min\\!\\big(g(t_k^{\\text{eff}-}) + \\Delta g,\\; g_{\\text{sat}}\\big)$，其中 $\\Delta g$ 是每个有效脉冲的瞬时电导增量，$g_{\\text{sat}}$ 是一个硬饱和极限。突触强制执行绝对不应期：在最近一次有效到达之后，任何发生在持续时间为 $t_{\\text{abs}}$ 的窗口内的脉冲到达都将被忽略（即不产生跳变）。轴突延迟 $d$ 将每个突触前脉冲时间 $t_k$ 移动到其假定到达时间 $t_k + d$。\n\n对于一个电压钳制神经元上的单个突触，给定以下参数和脉冲时间：\n- 突触时间常数 $\\tau = 5\\,\\mathrm{ms}$。\n- 电导增量 $\\Delta g = 1.2\\,\\mathrm{nS}$。\n- 饱和水平 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。\n- 绝对不应期窗口 $t_{\\text{abs}} = 3.0\\,\\mathrm{ms}$。\n- 轴突延迟 $d = 1.5\\,\\mathrm{ms}$。\n- 突触前脉冲时间 $\\{t_k\\} = \\{0\\,\\mathrm{ms},\\; 2\\,\\mathrm{ms},\\; 3.5\\,\\mathrm{ms},\\; 7\\,\\mathrm{ms},\\; 9\\,\\mathrm{ms}\\}$。\n- 反转电位 $E_{\\text{syn}} = 0\\,\\mathrm{mV}$。\n- 维持电位 $V_{\\text{hold}} = -65\\,\\mathrm{mV}$。\n- 初始电导 $g(0)=0\\,\\mathrm{nS}$。\n\n在指定的动力学条件下，计算该脉冲序列在时间 $t^\\ast = 10.0\\,\\mathrm{ms}$ 产生的突触后电流 $I(t^\\ast)$，计算中需包括轴突延迟、绝对不应期和电导饱和的叠加效应。以纳安（nanoamperes）为单位表示您的最终答案，并四舍五入到四位有效数字。假设单位转换遵循标准的国际单位制（SI）惯例，并在 $E_{\\text{syn}} - V_{\\text{hold}}  0$ 时将内向电流报告为正值。",
            "solution": "该问题要求计算一个基于电导的突触模型在特定时间 $t^\\ast = 10.0\\,\\mathrm{ms}$ 的突触后电流 $I(t^\\ast)$。该模型包含几个动态特性：脉冲之间电导的指数衰减、脉冲到达时的瞬时电导跳变、轴突延迟、绝对不应期和饱和极限。首先，确认问题陈述的有效性。所有参数都已提供，模型在物理上和数学上都定义良好，单位也一致。该问题具有科学依据，提法恰当，客观且完整。因此，可以推导出解。\n\n突触后电流 $I(t)$ 由 $I(t) = g(t)(E_{\\text{syn}} - V_{\\text{hold}})$ 给出，其中 $g(t)$ 是随时间变化的突触电导。我们需要确定 $g(t)$ 在 $t^\\ast = 10.0\\,\\mathrm{ms}$ 时的值。\n\n$g(t)$ 的动力学由两条规则控制：\n$1$. 在有效脉冲到达之间，电导根据微分方程 $\\tau \\frac{dg}{dt} = -g$ 衰减。对于一个从 $t_0$ 开始、初始电导为 $g(t_0)$ 的区间，解为 $g(t) = g(t_0) \\exp\\left(-\\frac{t - t_0}{\\tau}\\right)$。\n$2$. 在一个有效脉冲到达时间 $t_k^{\\text{eff}}$，电导更新为 $g(t_k^{\\text{eff}+}) = \\min\\left(g(t_k^{\\text{eff}-}) + \\Delta g, g_{\\text{sat}}\\right)$。\n\n对于一个在 $t_k$ 发生的突触前脉冲，其有效到达时间为 $t_k^{\\text{eff}} = t_k + d$，前提是该脉冲不处于不应期。如果一个脉冲的假定到达时间 $t_k + d$ 落在*前一个有效脉冲*的绝对不应期窗口 $t_{\\text{abs}}$ 内，则该脉冲处于不应期并被忽略。如果最后一个有效脉冲发生在 $t_{\\text{prev}}^{\\text{eff}}$，那么当 $t_k + d \\le t_{\\text{prev}}^{\\text{eff}} + t_{\\text{abs}}$ 时，新的脉冲处于不应期。\n\n我们给定的参数如下：\n- 突触时间常数 $\\tau = 5\\,\\mathrm{ms}$。\n- 电导增量 $\\Delta g = 1.2\\,\\mathrm{nS}$。\n- 饱和水平 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。\n- 绝对不应期窗口 $t_{\\text{abs}} = 3.0\\,\\mathrm{ms}$。\n- 轴突延迟 $d = 1.5\\,\\mathrm{ms}$。\n- 突触前脉冲时间 $\\{t_k\\} = \\{0\\,\\mathrm{ms},\\; 2\\,\\mathrm{ms},\\; 3.5\\,\\mathrm{ms},\\; 7\\,\\mathrm{ms},\\; 9\\,\\mathrm{ms}\\}$。\n- 反转电位 $E_{\\text{syn}} = 0\\,\\mathrm{mV}$。\n- 维持电位 $V_{\\text{hold}} = -65\\,\\mathrm{mV}$。\n- 初始电导 $g(0) = 0\\,\\mathrm{nS}$。\n\n首先，我们确定有效脉冲到达时间的序列。我们将维护一个变量 $t_{\\text{last\\_eff}}$，表示最近一次有效到达的时间，并将其初始化为 $-\\infty$。\n\n脉冲 1: $t_1 = 0\\,\\mathrm{ms}$。\n假定到达时间: $t_1^{\\text{putative}} = 0 + d = 1.5\\,\\mathrm{ms}$。\n这是第一个脉冲，所以它不可能是无效的（处于不应期）。它是一个有效脉冲。\n有效到达时间 $t_1^{\\text{eff}} = 1.5\\,\\mathrm{ms}$。更新 $t_{\\text{last\\_eff}} = 1.5\\,\\mathrm{ms}$。\n此脉冲的不应期在 $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 1.5 + 3.0 = 4.5\\,\\mathrm{ms}$ 结束。\n\n脉冲 2: $t_2 = 2\\,\\mathrm{ms}$。\n假定到达时间: $t_2^{\\text{putative}} = 2 + d = 3.5\\,\\mathrm{ms}$。\n检查是否处于不应期：$3.5\\,\\mathrm{ms} \\le 4.5\\,\\mathrm{ms}$ 吗？是的。\n该脉冲在第一个有效脉冲的不应期窗口内，因此被忽略。$t_{\\text{last\\_eff}}$ 保持为 $1.5\\,\\mathrm{ms}$。\n\n脉冲 3: $t_3 = 3.5\\,\\mathrm{ms}$。\n假定到达时间: $t_3^{\\text{putative}} = 3.5 + d = 5.0\\,\\mathrm{ms}$。\n检查是否处于不应期：$5.0\\,\\mathrm{ms} \\le 4.5\\,\\mathrm{ms}$ 吗？不是。\n该脉冲是有效的。\n有效到达时间 $t_2^{\\text{eff}} = 5.0\\,\\mathrm{ms}$。更新 $t_{\\text{last\\_eff}} = 5.0\\,\\mathrm{ms}$。\n此脉冲的不应期在 $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 5.0 + 3.0 = 8.0\\,\\mathrm{ms}$ 结束。\n\n脉冲 4: $t_4 = 7\\,\\mathrm{ms}$。\n假定到达时间: $t_4^{\\text{putative}} = 7 + d = 8.5\\,\\mathrm{ms}$。\n检查是否处于不应期：$8.5\\,\\mathrm{ms} \\le 8.0\\,\\mathrm{ms}$ 吗？不是。\n该脉冲是有效的。\n有效到达时间 $t_3^{\\text{eff}} = 8.5\\,\\mathrm{ms}$。更新 $t_{\\text{last\\_eff}} = 8.5\\,\\mathrm{ms}$。\n此脉冲的不应期在 $t_{\\text{last\\_eff}} + t_{\\text{abs}} = 8.5 + 3.0 = 11.5\\,\\mathrm{ms}$ 结束。\n\n脉冲 5: $t_5 = 9\\,\\mathrm{ms}$。\n假定到达时间: $t_5^{\\text{putative}} = 9 + d = 10.5\\,\\mathrm{ms}$。\n这个到达时间晚于我们的目标时间 $t^\\ast=10.0\\,\\mathrm{ms}$，所以它不影响 $g(10.0)$ 的计算。\n\n影响 $t^\\ast = 10.0\\,\\mathrm{ms}$ 时状态的有效脉冲到达时间为 $\\{1.5\\,\\mathrm{ms},\\; 5.0\\,\\mathrm{ms},\\; 8.5\\,\\mathrm{ms}\\}$。现在我们通过这些事件来模拟电导 $g(t)$。\n\n初始状态：在 $t=0$ 时，$g(0) = 0\\,\\mathrm{nS}$。电导保持为 0，直到第一个有效脉冲到达。\n\n在 $t=t_1^{\\text{eff}} = 1.5\\,\\mathrm{ms}$ 时：\n脉冲到达前瞬间的电导为 $g(1.5^{-}) = g(0) \\exp(-1.5/5) = 0\\,\\mathrm{nS}$。\n电导被更新：$g(1.5^{+}) = \\min(g(1.5^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(0 + 1.2, 3.0) = 1.2\\,\\mathrm{nS}$。\n\n在 $t=t_2^{\\text{eff}} = 5.0\\,\\mathrm{ms}$ 时：\n自上次有效脉冲以来经过的时间是 $\\Delta t_1 = 5.0 - 1.5 = 3.5\\,\\mathrm{ms}$。\n电导衰减到 $g(5.0^{-}) = g(1.5^{+}) \\exp(-\\Delta t_1 / \\tau) = 1.2 \\exp(-3.5/5) = 1.2 \\exp(-0.7)\\,\\mathrm{nS}$。\n电导被更新：$g(5.0^{+}) = \\min(g(5.0^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(1.2 \\exp(-0.7) + 1.2, 3.0)\\,\\mathrm{nS}$。\n数值上，$1.2 \\exp(-0.7) + 1.2 \\approx 1.2 \\times 0.4966 + 1.2 \\approx 0.5959 + 1.2 = 1.7959\\,\\mathrm{nS}$，小于 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。所以没有发生饱和。\n$g(5.0^{+}) = 1.2 (\\exp(-0.7) + 1)\\,\\mathrm{nS}$。\n\n在 $t=t_3^{\\text{eff}} = 8.5\\,\\mathrm{ms}$ 时：\n自上次有效脉冲以来经过的时间是 $\\Delta t_2 = 8.5 - 5.0 = 3.5\\,\\mathrm{ms}$。\n电导衰减到 $g(8.5^{-}) = g(5.0^{+}) \\exp(-\\Delta t_2 / \\tau) = [1.2 (\\exp(-0.7) + 1)] \\exp(-3.5/5) = 1.2 (\\exp(-0.7) + 1) \\exp(-0.7)\\,\\mathrm{nS} = 1.2 (\\exp(-1.4) + \\exp(-0.7))\\,\\mathrm{nS}$。\n电导被更新：$g(8.5^{+}) = \\min(g(8.5^{-}) + \\Delta g, g_{\\text{sat}}) = \\min(1.2 (\\exp(-1.4) + \\exp(-0.7)) + 1.2, 3.0)\\,\\mathrm{nS}$。\n数值上，$1.2 (\\exp(-1.4) + \\exp(-0.7)) + 1.2 \\approx 1.2 \\times (0.2466 + 0.4966) + 1.2 \\approx 1.2 \\times 0.7432 + 1.2 = 0.8918 + 1.2 = 2.0918\\,\\mathrm{nS}$，小于 $g_{\\text{sat}} = 3.0\\,\\mathrm{nS}$。没有发生饱和。\n$g(8.5^{+}) = 1.2 (\\exp(-1.4) + \\exp(-0.7) + 1)\\,\\mathrm{nS}$。\n\n最后，我们计算目标时间 $t^\\ast = 10.0\\,\\mathrm{ms}$ 时的电导。\n自上次有效脉冲以来经过的时间是 $\\Delta t_3 = 10.0 - 8.5 = 1.5\\,\\mathrm{ms}$。\n电导从其在 $t=8.5\\,\\mathrm{ms}$ 时的值开始衰减：\n$g(10.0) = g(8.5^{+}) \\exp(-\\Delta t_3 / \\tau) = \\left[1.2 (\\exp(-1.4) + \\exp(-0.7) + 1)\\right] \\exp(-1.5/5)\\,\\mathrm{nS}$。\n$g(10.0) = 1.2 (\\exp(-1.4) + \\exp(-0.7) + 1) \\exp(-0.3)\\,\\mathrm{nS}$。\n$g(10.0) = 1.2 (\\exp(-1.7) + \\exp(-1.0) + \\exp(-0.3))\\,\\mathrm{nS}$。\n\n现在我们代入数值：\n$\\exp(-0.3) \\approx 0.740818$\n$\\exp(-1.0) \\approx 0.367879$\n$\\exp(-1.7) \\approx 0.182684$\n$g(10.0) \\approx 1.2 \\times (0.182684 + 0.367879 + 0.740818)\\,\\mathrm{nS}$\n$g(10.0) \\approx 1.2 \\times (1.291381)\\,\\mathrm{nS} \\approx 1.549657\\,\\mathrm{nS}$。\n\n然后计算突触后电流 $I(t^\\ast)$：\n$I(10.0) = g(10.0) \\times (E_{\\text{syn}} - V_{\\text{hold}})$\n$E_{\\text{syn}} - V_{\\text{hold}} = 0\\,\\mathrm{mV} - (-65\\,\\mathrm{mV}) = 65\\,\\mathrm{mV}$。\n$I(10.0) \\approx (1.549657\\,\\mathrm{nS}) \\times (65\\,\\mathrm{mV})$。\n单位的乘积是 $(\\mathrm{nS}) \\times (\\mathrm{mV}) = (10^{-9}\\,\\mathrm{S}) \\times (10^{-3}\\,\\mathrm{V}) = 10^{-12}\\,\\mathrm{A} = 1\\,\\mathrm{pA}$。\n$I(10.0) \\approx 1.549657 \\times 65\\,\\mathrm{pA} \\approx 100.7277\\,\\mathrm{pA}$。\n\n问题要求答案以纳安（nA）为单位。由于 $1\\,\\mathrm{nA} = 1000\\,\\mathrm{pA}$：\n$I(10.0) \\approx \\frac{100.7277}{1000}\\,\\mathrm{nA} \\approx 0.1007277\\,\\mathrm{nA}$。\n\n四舍五入到四位有效数字，我们得到 $0.1007\\,\\mathrm{nA}$。问题指定当 $E_{\\text{syn}} - V_{\\text{hold}} > 0$ 时，将内向电流报告为正值。我们的驱动力是正的，计算出的电流也是正的，这与内向电流一致。",
            "answer": "$$\n\\boxed{0.1007}\n$$"
        },
        {
            "introduction": "大规模脑模拟的性能不仅取决于单个神经元或突触模型的实现，还取决于整个模拟引擎的顶层设计策略。本练习旨在量化对比两种主流的模拟方法：时间驱动（固定步长）和事件驱动。通过建立一个简化的成本模型并计算两种方法的性能加速比，你将学会如何根据网络活动（如脉冲发放率）和稀疏性来权衡不同的算法选择，这是为特定科学问题设计或选择高效模拟工具时的一项关键技能。",
            "id": "3992895",
            "problem": "一个大规模脉冲网络通过两种后端策略进行模拟：一种是基于优先级队列的事件驱动引擎，另一种是固定步长时间驱动循环。该网络有 $N$ 个神经元，每个神经元以概率 $p$ 独立地连接到其他神经元，因此期望出度为 $K = p\\,(N-1) \\approx p\\,N$，期望有向突触总数为 $M \\approx N\\,K$。每个神经元根据速率为 $r$（单位为 $\\text{s}^{-1}$）的齐次泊松过程发放脉冲。每次突触前脉冲发生时，每个传出突触以独立概率 $q$ 释放；一次已实现的释放会产生恰好一个带有传导延迟的突触后传输事件，该事件被调度以备将来传递。\n\n事件驱动引擎使用日历队列（CQ）优先级队列来管理延迟的突触后事件。对于每次已实现的突触传输，引擎执行一次对CQ的插入操作，一次在事件到期时的移除操作，以及一次突触后突触更新。假设每次操作的成本是恒定的：每次CQ插入的成本为 $c_{\\mathrm{ins}}$，每次CQ移除的成本为 $c_{\\mathrm{pop}}$，每次突触后突触更新的成本为 $c_{\\mathrm{evt}}$。假设系统处于平稳状态，因此在期望上，每单位模拟时间的插入次数等于移除次数。相对于这些主要操作，忽略所有其他成本（例如，突触前更新开销）。\n\n时间驱动引擎以大小为 $\\Delta t$（单位为 $\\text{s}$）的固定时间步长推进。在每个时间步，它遍历所有突触，确定性地更新它们的状态（例如，指数衰减），无论是否发生突触前脉冲，每个突触每步的成本是恒定的 $c_{\\mathrm{step}}$。相对于这个主要的每步突触循环，忽略任何额外的脉冲处理开销。\n\n假设一个中央处理器（CPU）每挂钟秒可以执行固定数量的基本操作，且两个引擎相同，因此模拟时间吞吐量与每单位模拟时间所需的期望基本操作数成反比。将事件驱动引擎相对于时间驱动引擎的加速因子 $\\mathcal{S}$ 定义为每单位模拟时间的期望操作数之比，$\\mathcal{S} = C_{\\mathrm{TD}}/C_{\\mathrm{ED}}$，其中 $C_{\\mathrm{TD}}$ 和 $C_{\\mathrm{ED}}$ 分别是时间驱动和事件驱动引擎每单位模拟时间的期望操作数。\n\n给定以下参数：\n- $N = 10^{6}$，\n- $p = 10^{-3}$，\n- $r = 5$，\n- $q = 0.2$，\n- $\\Delta t = 10^{-4}$，\n- $c_{\\mathrm{ins}} = 3$，\n- $c_{\\mathrm{pop}} = 2$，\n- $c_{\\mathrm{evt}} = 1$，\n- $c_{\\mathrm{step}} = 1$，\n\n计算 $\\mathcal{S}$ 的数值。将您的答案四舍五入到三位有效数字。将最终加速表示为一个无单位的无量纲因子。",
            "solution": "首先验证问题，以确保其具有科学依据、是良构的且客观的。\n\n### 步骤 1：提取已知条件\n- 神经元数量：$N = 10^{6}$\n- 连接概率：$p = 10^{-3}$\n- 期望出度：$K = p\\,(N-1) \\approx p\\,N$\n- 期望突触总数：$M \\approx N\\,K$\n- 每个神经元的脉冲速率：$r = 5 \\, \\text{s}^{-1}$\n- 突触释放概率：$q = 0.2$\n- 时间驱动模拟的时间步长：$\\Delta t = 10^{-4} \\, \\text{s}$\n- 事件驱动每次插入的成本：$c_{\\mathrm{ins}} = 3$\n- 事件驱动每次移除的成本：$c_{\\mathrm{pop}} = 2$\n- 事件驱动每次突触后更新的成本：$c_{\\mathrm{evt}} = 1$\n- 时间驱动每个突触每步的成本：$c_{\\mathrm{step}} = 1$\n- 加速的定义：$\\mathcal{S} = C_{\\mathrm{TD}}/C_{\\mathrm{ED}}$，其中 $C_{\\mathrm{TD}}$ 和 $C_{\\mathrm{ED}}$ 分别是时间驱动和事件驱动引擎每单位模拟时间的期望操作数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了针对大规模脉冲神经网络的两种常见模拟算法（事件驱动与时间驱动）之间的标准性能比较。模型假设，如泊松脉冲发放和概率性突触，在理论和计算神经科学中是创建易于处理且信息丰富的模型的标准方法。所有参数都有定义，其数值对于此类模拟在物理上和计算上都是合理的。成本函数虽然简化，但为比较提供了清晰、可形式化的基础。该问题是自洽的，在计算神经科学方面有科学依据，并且是良构的。没有矛盾、歧义或事实错误。\n\n### 步骤 3：结论与行动\n问题有效。继续求解。\n\n目标是计算加速因子 $\\mathcal{S}$，其定义为时间驱动（$C_{\\mathrm{TD}}$）和事件驱动（$C_{\\mathrm{ED}}$）引擎每单位模拟时间的期望总操作数之比：\n$$\n\\mathcal{S} = \\frac{C_{\\mathrm{TD}}}{C_{\\mathrm{ED}}}\n$$\n\n首先，我们推导事件驱动引擎每单位模拟时间的期望操作数 $C_{\\mathrm{ED}}$ 的表达式。该引擎中的成本与已实现的突触传输事件的数量成正比。\n整个网络的总脉冲速率是神经元数量 $N$ 乘以单个神经元的发放速率 $r$。\n$$\n\\text{总脉冲速率} = N \\cdot r\n$$\n每个神经元的期望出度为 $K \\approx pN$。每次脉冲发生时，一个信号被发送到 $K$ 个传出突触。然后，这些突触中的每一个都以概率 $q$ 释放。因此，每次突触前脉冲产生的期望已实现传输事件数为 $K \\cdot q$。\n网络中已实现的突触传输事件的总速率 $R_{\\mathrm{event}}$ 是总脉冲速率与每次脉冲的期望传输次数的乘积。\n$$\nR_{\\mathrm{event}} = (N \\cdot r) \\cdot (K \\cdot q)\n$$\n使用近似 $K \\approx pN$，我们得到：\n$$\nR_{\\mathrm{event}} \\approx (N \\cdot r) \\cdot (p \\cdot N \\cdot q) = N^2 p r q\n$$\n对于每次已实现的传输事件，引擎执行一次插入、一次移除和一次突触后更新。每次事件的总成本为 $(c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})$。\n每单位模拟时间的期望总操作数 $C_{\\mathrm{ED}}$ 是事件速率乘以每次事件的成本。\n$$\nC_{\\mathrm{ED}} = R_{\\mathrm{event}} \\cdot (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}}) \\approx N^2 p r q (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})\n$$\n\n接下来，我们推导时间驱动引擎每单位模拟时间的期望操作数 $C_{\\mathrm{TD}}$ 的表达式。该引擎以大小为 $\\Delta t$ 的离散时间步长推进。每单位模拟时间的模拟步数是 $1/\\Delta t$。\n在每个时间步，引擎更新网络中每个突触的状态。突触总数为 $M \\approx N K \\approx N(pN) = N^2 p$。\n每个突触每个时间步的成本是 $c_{\\mathrm{step}}$。因此，每个时间步的总操作数是 $M \\cdot c_{\\mathrm{step}} \\approx N^2 p c_{\\mathrm{step}}$。\n每单位模拟时间的期望总操作数 $C_{\\mathrm{TD}}$ 是每个时间步的成本乘以每单位时间的步数。\n$$\nC_{\\mathrm{TD}} = (M \\cdot c_{\\mathrm{step}}) \\cdot \\frac{1}{\\Delta t} \\approx \\frac{N^2 p c_{\\mathrm{step}}}{\\Delta t}\n$$\n\n现在我们可以通过计算 $C_{\\mathrm{TD}}$ 与 $C_{\\mathrm{ED}}$ 的比率来计算加速因子 $\\mathcal{S}$。\n$$\n\\mathcal{S} = \\frac{C_{\\mathrm{TD}}}{C_{\\mathrm{ED}}} \\approx \\frac{\\frac{N^2 p c_{\\mathrm{step}}}{\\Delta t}}{N^2 p r q (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})}\n$$\n项 $N^2 p$ 从分子和分母中消去。这表明对于这个模型，两个引擎的相对性能与网络大小和连接概率无关。\n$$\n\\mathcal{S} = \\frac{c_{\\mathrm{step}}}{\\Delta t \\cdot r \\cdot q \\cdot (c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}})}\n$$\n我们现在将给定的数值代入此表达式：\n- $c_{\\mathrm{step}} = 1$\n- $\\Delta t = 10^{-4}$\n- $r = 5$\n- $q = 0.2$\n- $c_{\\mathrm{ins}} = 3$\n- $c_{\\mathrm{pop}} = 2$\n- $c_{\\mathrm{evt}} = 1$\n\n事件驱动成本的总和是 $(c_{\\mathrm{ins}} + c_{\\mathrm{pop}} + c_{\\mathrm{evt}}) = (3 + 2 + 1) = 6$。\n分母中的乘积是 $\\Delta t \\cdot r \\cdot q = 10^{-4} \\cdot 5 \\cdot 0.2 = 10^{-4} \\cdot 1 = 10^{-4}$。\n将这些代入 $\\mathcal{S}$ 的表达式中：\n$$\n\\mathcal{S} = \\frac{1}{10^{-4} \\cdot 6} = \\frac{1}{6 \\times 10^{-4}} = \\frac{10^4}{6} = \\frac{10000}{6} = 1666.666...\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\n\\mathcal{S} \\approx 1670\n$$\n以所要求的科学记数法格式表示：\n$$\n\\mathcal{S} \\approx 1.67 \\times 10^{3}\n$$\n这个结果表明，在给定的参数和成本模型下，事件驱动引擎预计比时间驱动引擎快大约 $1670$ 倍。",
            "answer": "$$\n\\boxed{1.67 \\times 10^{3}}\n$$"
        }
    ]
}