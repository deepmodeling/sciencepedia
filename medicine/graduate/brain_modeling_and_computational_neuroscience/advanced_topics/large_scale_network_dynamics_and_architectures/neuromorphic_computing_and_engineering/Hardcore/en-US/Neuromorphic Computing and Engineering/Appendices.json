{
    "hands_on_practices": [
        {
            "introduction": "The precision of any computation, whether biological or artificial, is fundamentally limited by physical noise. In neuromorphic circuits, thermal noise is a primary constraint that impacts performance. This practice  explores the origin and effect of this noise, starting from the equipartition theorem of statistical mechanics to derive the famous \"$kT/C$\" voltage fluctuation on a capacitor. You will then connect this fundamental physical noise to a critical system-level metric: the timing precision of a spiking neuron.",
            "id": "4004359",
            "problem": "A neuromorphic integrate-and-fire neuron is implemented as a charge-based front-end that integrates current onto a single capacitor. The integrator is periodically reset by shorting the capacitor to a reference node through a Metal-Oxide-Semiconductor (MOS) switch with on-resistance $R_{\\mathrm{on}}$. The ambient temperature is $T$, and the Boltzmann constant is $k_B$. Assume the reset switch is held closed for a duration much longer than $R_{\\mathrm{on}} C$, so that, upon opening, the capacitor is in thermal equilibrium with the resistive switch. Immediately after the switch opens, a constant input current $I$ is applied to the capacitor $C$ starting from the reference potential, and a spike is emitted when the capacitor voltage reaches a fixed threshold $V_{\\mathrm{th}}$. Neglect leak, comparator delay, flicker noise, and any other noise sources besides the thermal noise present on the capacitor at the moment the reset switch opens.\n\nStarting from the equipartition theorem of statistical mechanics and the definition of the electrostatic energy stored in a capacitor, derive an analytic expression for the standard deviation of the spike time, defined as the Root Mean Square (RMS) timing jitter $\\sigma_t$, arising solely from the thermal voltage fluctuation on the capacitor at the reset instant. Express your final answer in seconds as a closed-form symbolic function of $k_B$, $T$, $C$, and $I$ only. Do not introduce any additional parameters. Your answer must be a single closed-form expression.",
            "solution": "The task is to derive the timing jitter induced by thermal fluctuations on the integrating capacitor immediately after reset. The reset is realized with a resistive element at temperature $T$, held long enough that the capacitor reaches thermal equilibrium with the resistor before the switch opens. We proceed in two steps: compute the RMS voltage fluctuation on the capacitor at equilibrium, then translate this voltage noise into spike time jitter via the integration dynamics.\n\nFirst, we use the equipartition theorem, a fundamental result of statistical mechanics. For each quadratic degree of freedom at temperature $T$, the average energy is $\\frac{1}{2} k_B T$. The electrostatic energy stored in a capacitor is given by\n$$\nU = \\frac{1}{2} C V^{2},\n$$\nwhere $C$ is the capacitance and $V$ is the voltage across the capacitor. At thermal equilibrium, the average energy in this quadratic mode equals $\\frac{1}{2} k_B T$. Identifying the quadratic term, we equate the average capacitor energy to $\\frac{1}{2} k_B T$:\n$$\n\\frac{1}{2} C \\,\\mathbb{E}[V^{2}] = \\frac{1}{2} k_B T.\n$$\nAssuming the mean of $V$ is zero relative to the reference node (the reset pin sets the mean to $0$ and the thermal fluctuation is symmetric), we have $\\mathbb{E}[V^{2}] = \\mathrm{Var}(V) = \\sigma_V^{2}$. Thus,\n$$\n\\sigma_V^{2} = \\frac{k_B T}{C},\n$$\nand the Root Mean Square (RMS) voltage fluctuation is\n$$\n\\sigma_V = \\sqrt{\\frac{k_B T}{C}}.\n$$\n\nSecond, we map this voltage noise into spike timing jitter. After the switch opens, the capacitor integrates the constant current $I$ with the dynamics\n$$\n\\frac{dV}{dt} = \\frac{I}{C}.\n$$\nIf the capacitor voltage started exactly at $0$, the deterministic time to reach threshold $V_{\\mathrm{th}}$ would be\n$$\nt_{0} = \\frac{C V_{\\mathrm{th}}}{I}.\n$$\nHowever, due to the thermal fluctuation, the initial voltage at the moment the switch opens is a random variable $\\delta V$ with zero mean and standard deviation $\\sigma_V$. The threshold crossing time is shifted by the amount of time it takes to overcome the initial offset. Because the voltage ramps linearly with slope $\\frac{I}{C}$, a small initial perturbation $\\delta V$ at $t=0$ produces a timing shift\n$$\n\\delta t = -\\frac{\\delta V}{\\frac{dV}{dt}} = -\\frac{\\delta V}{I/C} = -\\frac{C}{I}\\,\\delta V.\n$$\nTherefore, the standard deviation of the spike timing, i.e., the RMS jitter, is\n$$\n\\sigma_t = \\frac{C}{I}\\,\\sigma_V = \\frac{C}{I}\\,\\sqrt{\\frac{k_B T}{C}} = \\frac{\\sqrt{k_B T\\, C}}{I}.\n$$\nThis expression depends only on $k_B$, $T$, $C$, and $I$, as required. The units are seconds: $k_B T$ has units of Joules, multiplying by $C$ (Farads) yields Coulomb squared, its square root is Coulombs, and division by current $I$ (Coulombs per second) yields seconds. Hence the final closed-form expression for the RMS spike timing jitter due solely to thermal initialization noise on the integrating capacitor is\n$$\n\\sigma_t = \\frac{\\sqrt{k_B T\\, C}}{I}.\n$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{k_B T\\, C}}{I}}$$"
        },
        {
            "introduction": "Building brain-like processing elements in silicon requires translating abstract neuron models into efficient physical circuits. Neuromorphic engineers often leverage the subthreshold physics of transistors, where their exponential current-voltage characteristic naturally mimics the behavior of biological ion channels. This exercise  takes you inside a \"log-domain\" implementation of a Leaky Integrate-and-Fire (LIF) neuron, challenging you to derive how a key neural parameter—the membrane time constant $\\tau_m$—can be tuned by the physical properties of the circuit, such as capacitance and bias currents.",
            "id": "4004408",
            "problem": "Consider a neuromorphic implementation of the Leaky Integrate-and-Fire (LIF) neuron in the log-domain using subthreshold Metal-Oxide-Semiconductor Field-Effect Transistors (MOSFETs). The membrane state is represented by a node voltage $V_{m}$ that controls a transistor operating in weak inversion (subthreshold). In this regime, the drain current of a diode-connected MOSFET is well described by the exponential relationship $I = I_{0} \\exp\\!\\left(\\frac{\\kappa V}{U_{T}}\\right)$, where $I_{0}$ is a technology-dependent scale current, $\\kappa$ is the gate coupling coefficient (sometimes called the subthreshold slope factor reciprocal), and $U_{T} = \\frac{k_{B} T}{q}$ is the thermal voltage with $k_{B}$ the Boltzmann constant, $T$ the absolute temperature, and $q$ the elementary charge. The membrane capacitor is connected at the same node and obeys $I_{C} = C \\frac{dV_{m}}{dt}$, where $C$ is the capacitance. A constant bias current $I_{L}$ injects current into the node to set the leak equilibrium, while a diode-connected transistor referenced to the membrane node sinks a current equal to the instantaneous membrane current $I_{m}$ set by $V_{m}$.\n\nStarting from the above subthreshold exponential relation for the membrane current $I_{m}$ in terms of the membrane voltage $V_{m}$, and applying Kirchhoff’s Current Law (KCL) at the membrane node where the capacitor and the leak elements meet, derive the small-signal membrane time constant $\\tau_{m}$ of this log-domain LIF implementation about the fixed point determined by the bias $I_{L}$. Your derivation must begin from the definitions $I_{m} = I_{0} \\exp\\!\\left(\\frac{\\kappa V_{m}}{U_{T}}\\right)$ and $I_{C} = C \\frac{dV_{m}}{dt}$, and should proceed by expressing the dynamics in terms of $I_{m}$, identifying the fixed point, and linearizing the dynamics around that fixed point to obtain $\\tau_{m}$.\n\nExpress your final answer as a closed-form analytic expression in terms of $C$, $\\kappa$, $U_{T}$, and $I_{L}$. Express the time constant in seconds.",
            "solution": "The problem asks for the derivation of the small-signal membrane time constant, $\\tau_{m}$, for a log-domain Leaky Integrate-and-Fire (LIF) neuron model implemented with subthreshold MOSFETs. The derivation will proceed by applying Kirchhoff’s Current Law (KCL) at the membrane node, linearizing the resulting dynamics around the fixed point, and identifying the time constant from the linearized equation.\n\nFirst, we establish the dynamical equation for the circuit by applying KCL at the node with voltage $V_{m}$. The currents involved are:\n$1$. The constant bias current $I_{L}$ being injected into the node.\n$2$. The capacitive current $I_{C} = C \\frac{dV_{m}}{dt}$ flowing out of the node.\n$3$. The membrane current $I_{m}$ sunk by the diode-connected transistor, also flowing out of the node.\n\nAccording to KCL, the sum of currents entering the node must equal the sum of currents leaving the node:\n$$I_{L} = I_{C} + I_{m}$$\n\nWe are given the constitutive relations for the capacitor and the membrane current:\n$$I_{C} = C \\frac{dV_{m}}{dt}$$\n$$I_{m} = I_{0} \\exp\\left(\\frac{\\kappa V_{m}}{U_{T}}\\right)$$\n\nSubstituting these into the KCL equation yields the non-linear ordinary differential equation (ODE) governing the membrane voltage $V_{m}$:\n$$I_{L} = C \\frac{dV_{m}}{dt} + I_{0} \\exp\\left(\\frac{\\kappa V_{m}}{U_{T}}\\right)$$\n\nThe problem suggests proceeding by expressing the dynamics in terms of the membrane current $I_{m}$. To do this, we first need to find an expression for $\\frac{dV_{m}}{dt}$ in terms of $I_{m}$. We start by inverting the relation for $I_{m}$ to solve for $V_{m}$:\n$$I_{m} = I_{0} \\exp\\left(\\frac{\\kappa V_{m}}{U_{T}}\\right) \\implies \\frac{I_{m}}{I_{0}} = \\exp\\left(\\frac{\\kappa V_{m}}{U_{T}}\\right)$$\nTaking the natural logarithm of both sides:\n$$\\ln\\left(\\frac{I_{m}}{I_{0}}\\right) = \\frac{\\kappa V_{m}}{U_{T}}$$\nSolving for $V_{m}$:\n$$V_{m} = \\frac{U_{T}}{\\kappa} \\ln\\left(\\frac{I_{m}}{I_{0}}\\right)$$\nNow, we differentiate $V_{m}$ with respect to time $t$, using the chain rule $\\frac{dV_{m}}{dt} = \\frac{dV_{m}}{dI_{m}} \\frac{dI_{m}}{dt}$:\n$$\\frac{dV_{m}}{dI_{m}} = \\frac{d}{dI_{m}}\\left[ \\frac{U_{T}}{\\kappa} \\ln\\left(\\frac{I_{m}}{I_{0}}\\right) \\right] = \\frac{U_{T}}{\\kappa} \\frac{1}{(I_{m}/I_{0})} \\cdot \\frac{1}{I_{0}} = \\frac{U_{T}}{\\kappa I_{m}}$$\nTherefore, the time derivative of the membrane voltage can be written as:\n$$\\frac{dV_{m}}{dt} = \\left(\\frac{U_{T}}{\\kappa I_{m}}\\right) \\frac{dI_{m}}{dt}$$\nSubstituting this back into the original KCL equation, $I_{L} = C \\frac{dV_{m}}{dt} + I_{m}$, we get the dynamics in terms of $I_{m}$:\n$$I_{L} = C \\left(\\frac{U_{T}}{\\kappa I_{m}}\\right) \\frac{dI_{m}}{dt} + I_{m}$$\nThis equation can be rearranged as:\n$$\\frac{C U_{T}}{\\kappa I_{m}} \\frac{dI_{m}}{dt} + I_{m} = I_{L}$$\nThis is a non-linear ODE for the membrane current $I_{m}$. To find the small-signal time constant, we must linearize this equation around the system's fixed point. The fixed point is the steady-state condition where all time derivatives are zero. Setting $\\frac{dI_{m}}{dt} = 0$ in the equation above, we find the fixed-point current, which we denote as $I_{m, \\text{eq}}$:\n$$0 + I_{m, \\text{eq}} = I_{L} \\implies I_{m, \\text{eq}} = I_{L}$$\nNow, we linearize the dynamics by considering small perturbations $\\delta I_{m}(t)$ around this fixed point:\n$$I_{m}(t) = I_{m, \\text{eq}} + \\delta I_{m}(t) = I_{L} + \\delta I_{m}(t)$$\nThe time derivative is $\\frac{dI_{m}}{dt} = \\frac{d(\\delta I_{m})}{dt}$. Substituting these into the current dynamics equation:\n$$\\frac{C U_{T}}{\\kappa (I_{L} + \\delta I_{m})} \\frac{d(\\delta I_{m})}{dt} + (I_{L} + \\delta I_{m}) = I_{L}$$\nSimplifying the equation:\n$$\\frac{C U_{T}}{\\kappa (I_{L} + \\delta I_{m})} \\frac{d(\\delta I_{m})}{dt} + \\delta I_{m} = 0$$\nFor small signals, we assume the perturbation $\\delta I_{m}$ is much smaller than the steady-state current $I_{L}$ (i.e., $|\\delta I_{m}| \\ll I_{L}$). This allows us to approximate the denominator in the first term: $I_{L} + \\delta I_{m} \\approx I_{L}$. This approximation linearizes the equation:\n$$\\frac{C U_{T}}{\\kappa I_{L}} \\frac{d(\\delta I_{m})}{dt} + \\delta I_{m} = 0$$\nThis is a first-order linear homogeneous differential equation. The standard form for such an equation describing exponential decay is $\\tau \\frac{dy}{dt} + y = 0$, where $\\tau$ is the time constant. By comparing our linearized equation with this standard form, we can directly identify the small-signal membrane time constant $\\tau_{m}$:\n$$\\tau_{m} = \\frac{C U_{T}}{\\kappa I_{L}}$$\nThe units of this expression are Farads-Volts per Ampere, which simplifies to seconds: $\\frac{(\\text{C}/\\text{V}) \\cdot \\text{V}}{\\text{C}/\\text{s}} = \\text{s}$, confirming it represents a time constant. The expression is given in terms of the required parameters $C$, $\\kappa$, $U_{T}$, and $I_{L}$.",
            "answer": "$$\\boxed{\\frac{C U_{T}}{\\kappa I_{L}}}$$"
        },
        {
            "introduction": "The computational power of the brain arises not just from its neurons, but from the massive, plastic web of synaptic connections between them. In neuromorphic hardware, emulating these connections efficiently is paramount, with resistive memory devices emerging as a leading technology for dense, low-power artificial synapses. This practice  focuses on the fundamental cost of learning in such systems by having you derive the energy required to program a single synaptic device, linking its internal state dynamics to the practical energy budget of the system.",
            "id": "4004438",
            "problem": "Consider a two-terminal, non-volatile, resistive synaptic device used in neuromorphic computing. The device’s instantaneous current is given by Ohm’s law as $I(t) = G(x(t))\\,V$, where $G(x)$ is the conductance as a function of an internal state variable $x$, and $V$ is an externally applied voltage pulse of constant amplitude. The internal state $x$ evolves under a field-driven drift model described by $\\frac{dx}{dt} = \\alpha V$, where $\\alpha$ is a positive device constant. The programming energy delivered by the voltage source over a pulse of duration $T$ is defined by the electrical work integral $E = \\int_{0}^{T} V\\,I(t)\\,dt$. You want to set the synapse from an initial conductance $G_{1}$ to a target conductance $G_{2}$ by choosing a pulse duration $T$ consistent with the drift model and constant-amplitude $V$.\n\nStarting from the fundamental definitions above, derive a closed-form expression for the programming energy $E$ required to change the conductance from $G_{1}$ to $G_{2}$, assuming a strictly monotonic and differentiable conductance mapping $G(x)$. Then, specialize your result to the common affine model $G(x) = G_{\\min} + \\kappa x$, with $x \\in [0,1]$, where $G_{\\min} \\geq 0$ and $\\kappa > 0$ are device parameters. Express your final answer exclusively in terms of $V$, $\\alpha$, $\\kappa$, $G_{1}$, and $G_{2}$. Treat energy dimensionally in Joules, but do not include units inside your final boxed expression. No numerical rounding is required. Ensure all steps adhere to physically and mathematically consistent reasoning rooted in the given laws and definitions.",
            "solution": "The derivation begins with the definition of the programming energy $E$ delivered by the voltage source over a pulse of duration $T$:\n$$E = \\int_{0}^{T} P(t)\\,dt = \\int_{0}^{T} V\\,I(t)\\,dt$$\nAccording to the problem statement, the current $I(t)$ follows Ohm's law, $I(t) = G(x(t))\\,V$, where $V$ is a constant. Substituting this into the energy integral gives:\n$$E = \\int_{0}^{T} V^2 G(x(t))\\,dt$$\nThe internal state variable $x(t)$ evolves according to the field-driven drift model, $\\frac{dx}{dt} = \\alpha V$. Since both $\\alpha$ and $V$ are constants during the pulse, this differential equation can be rearranged to provide a change of variables for the integral:\n$$dt = \\frac{dx}{\\alpha V}$$\nWe can now transform the integral over time $t$ into an integral over the state variable $x$. The limits of integration change from the time interval $[0, T]$ to the state variable interval $[x_1, x_2]$, where $x_1$ is the initial state corresponding to conductance $G_1$ (i.e., $G(x_1) = G_1$), and $x_2$ is the final state corresponding to conductance $G_2$ (i.e., $G(x_2) = G_2$).\n$$E = \\int_{x_1}^{x_2} V^2 G(x) \\left(\\frac{dx}{\\alpha V}\\right) = \\frac{V}{\\alpha} \\int_{x_1}^{x_2} G(x) dx$$\nThis expression provides the programming energy for any general, monotonic conductance function $G(x)$.\n\nNext, we specialize this result for the specified affine model, $G(x) = G_{\\min} + \\kappa x$. Substituting this into the general energy expression:\n$$E = \\frac{V}{\\alpha} \\int_{x_1}^{x_2} (G_{\\min} + \\kappa x) dx$$\nEvaluating this definite integral yields:\n$$E = \\frac{V}{\\alpha} \\left[ G_{\\min}x + \\frac{1}{2}\\kappa x^2 \\right]_{x_1}^{x_2}$$\n$$E = \\frac{V}{\\alpha} \\left( (G_{\\min}x_2 + \\frac{1}{2}\\kappa x_2^2) - (G_{\\min}x_1 + \\frac{1}{2}\\kappa x_1^2) \\right)$$\n$$E = \\frac{V}{\\alpha} \\left( G_{\\min}(x_2 - x_1) + \\frac{1}{2}\\kappa (x_2^2 - x_1^2) \\right)$$\nThe problem requires the final answer to be expressed exclusively in terms of $V$, $\\alpha$, $\\kappa$, $G_1$, and $G_2$. Therefore, we must eliminate the state variables $x_1$ and $x_2$, as well as the model parameter $G_{\\min}$. From the affine model definition, we have the following relationships:\n$$G_1 = G_{\\min} + \\kappa x_1 \\implies x_1 = \\frac{G_1 - G_{\\min}}{\\kappa}$$\n$$G_2 = G_{\\min} + \\kappa x_2 \\implies x_2 = \\frac{G_2 - G_{\\min}}{\\kappa}$$\nUsing these, we can express the difference $(x_2 - x_1)$ in terms of conductances:\n$$x_2 - x_1 = \\frac{G_2 - G_{\\min}}{\\kappa} - \\frac{G_1 - G_{\\min}}{\\kappa} = \\frac{G_2 - G_1}{\\kappa}$$\nWe can factor the term $(x_2^2 - x_1^2)$ as $(x_2 - x_1)(x_2 + x_1)$. Substituting the expression for $(x_2 - x_1)$ and finding an expression for $(x_2 + x_1)$:\n$$x_1 + x_2 = \\frac{G_1 - G_{\\min}}{\\kappa} + \\frac{G_2 - G_{\\min}}{\\kappa} = \\frac{G_1 + G_2 - 2G_{\\min}}{\\kappa}$$\nNow, substituting these back into the expression for energy:\n$$E = \\frac{V}{\\alpha} \\left( G_{\\min}\\left(\\frac{G_2 - G_1}{\\kappa}\\right) + \\frac{1}{2}\\kappa \\left(\\frac{G_2 - G_1}{\\kappa}\\right) \\left(\\frac{G_1 + G_2 - 2G_{\\min}}{\\kappa}\\right) \\right)$$\nFactoring out the common term $\\frac{V(G_2 - G_1)}{\\alpha \\kappa}$:\n$$E = \\frac{V(G_2 - G_1)}{\\alpha \\kappa} \\left( G_{\\min} + \\frac{1}{2}(G_1 + G_2 - 2G_{\\min}) \\right)$$\nThe term within the parenthesis simplifies elegantly, eliminating $G_{\\min}$:\n$$G_{\\min} + \\frac{1}{2}G_1 + \\frac{1}{2}G_2 - G_{\\min} = \\frac{1}{2}(G_1 + G_2)$$\nThis term represents the arithmetic mean of the initial and final conductances. Substituting this simplified term back into the energy equation gives:\n$$E = \\frac{V(G_2 - G_1)}{\\alpha \\kappa} \\left(\\frac{G_1 + G_2}{2}\\right)$$\nFinally, applying the difference of squares identity, $(a-b)(a+b) = a^2 - b^2$, where $a=G_2$ and $b=G_1$, we arrive at the closed-form expression for the programming energy:\n$$E = \\frac{V}{2\\alpha\\kappa} (G_2^2 - G_1^2)$$\nThis result depends only on the required variables and is physically consistent. For the energy $E$ to be positive, corresponding to work done on the device, the sign of the constant voltage $V$ must match the sign of $(G_2^2 - G_1^2)$. Since conductance must be non-negative, this is equivalent to $\\text{sgn}(V) = \\text{sgn}(G_2 - G_1)$, which is consistent with the physical intuition that a positive voltage is needed to increase conductance and a negative voltage is needed to decrease it, given $\\alpha > 0$ and $\\kappa > 0$.",
            "answer": "$$\\boxed{\\frac{V(G_{2}^{2} - G_{1}^{2})}{2\\alpha\\kappa}}$$"
        }
    ]
}