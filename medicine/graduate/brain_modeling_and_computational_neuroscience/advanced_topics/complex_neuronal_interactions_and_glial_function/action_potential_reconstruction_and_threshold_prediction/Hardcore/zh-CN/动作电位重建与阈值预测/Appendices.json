{
    "hands_on_practices": [
        {
            "introduction": "将动作电位阈值理解为一个固定的电压值是一种过度简化。在更深层次上，阈值是一个动态现象，源于驱动神经元电压变化的快慢离子电流之间的相互作用。这项练习  将引导您通过一个简化的神经元模型，从动力学系统的角度来探索阈值是如何作为分岔点出现的，从而让您对兴奋性类型（如 SNIC 和 Hopf 分岔）和基础电流（rheobase）等概念建立起基于第一性原理的理解。",
            "id": "3960964",
            "problem": "考虑一个在尖峰放电起始附近的基于电导的神经元的二维简化模型，其中快膜电压变量 $V$ 由内向激活电流和外向电流平衡所产生的三次非线性项近似，慢恢复变量 $w$ 是 $V$ 的线性函数。设显式漏电导 $g_{L}$ 作为一个线性欧姆项进入快电流平衡。该简化后的无量纲系统为\n$$\n\\begin{aligned}\n\\frac{dV}{dt} = f(V,w;I,g_{L}) \\equiv (\\alpha-g_{L})\\,V - \\beta V^{3} - w + I,\\\\\n\\frac{dw}{dt} = \\epsilon\\left(\\kappa V + \\lambda - w\\right),\n\\end{aligned}\n$$\n其中参数 $\\alpha0$, $\\beta0$, $\\kappa0$, $\\lambda \\in \\mathbb{R}$，且 $0\\epsilon\\ll 1$。外部刺激 $I$ 是一个恒定的施加电流。该模型是一个典型的三次快慢简化模型，源于电流守恒定律\n$$\nC\\frac{dV}{dt} = -I_{\\text{ion}}(V,w;g_{L}) + I,\n$$\n其中漏电流是 $V$ 的线性函数，斜率为 $g_{L}$，而快内向电流已被近似为一个 $V$ 的线性项减去一个饱和三次非线性项。$V$-零斜线是三次曲线\n$$\nw = (\\alpha-g_{L})\\,V - \\beta V^{3} + I,\n$$\n而 $w$-零斜线是直线\n$$\nw = \\kappa V + \\lambda.\n$$\n\n回答以下问题：\n\n1) 从这些零斜线以及三次曲线拐点（定义为 $dw/dV = 0$ 的解）出发，确定增加 $g_{L}$ 如何使 $V$-零斜线平移及其拐点在 $(V,w)$-平面上如何移动。用 $(\\alpha-g_{L})$ 和 $\\beta$ 来表述你的结果。\n\n2) 在奇异极限 $\\epsilon\\to 0^{+}$ 下，当 $I$ 从静息状态缓慢增加时，重复性尖峰放电的起始会通过鞍节点不变圆 (SNIC) 分岔或 Hopf 分岔发生，具体取决于几何形状。仅使用零斜线的几何形状和平衡点处的线性化，推导出一个关于 $g_{L}$（相对于其他参数）的条件，用以区分当 $I$ 变化时这两种起始类型。你的条件必须用三次 $V$-零斜线和 $w$-零斜线在其交点处的相对斜率来表述。\n\n3) 在你所确定的导致鞍节点不变圆 (SNIC) 起始的条件下，基电流（即引起重复性尖峰放电的最小恒定电流 $I$）在直线 $w=\\kappa V+\\lambda$ 与三次曲线 $w=(\\alpha-g_{L})V-\\beta V^{3}+I$ 在左拐点（即负 $V$ 值处）相切时达到。通过施加相切条件，推导基电流 $I_{\\mathrm{rh}}(g_{L})$ 关于 $\\alpha$、$\\beta$、$\\kappa$、$\\lambda$ 和 $g_{L}$ 的闭式表达式。将你的最终答案表示为单个解析表达式。无需数值取整。请明确说明你为拐点所做的任何符号选择。\n\n请从基本的电流平衡定律、零斜线和拐点的定义以及线性稳定性判据出发进行推理，避免引用现成的基电流公式。你的最终答案必须是 $I_{\\mathrm{rh}}(g_{L})$ 在无量纲单位下的显式解析表达式，并包含在单个表达式中。",
            "solution": "该问题呈现了一个典型的快慢动力系统，代表了一个简化的基于电导的神经元模型。我们的任务是分析其零斜线的几何特性，推导不同放电起始类型的条件，并最终计算一种特定起始类型的基电流。分析将按要求分三部分进行。\n\n该系统由以下方程给出：\n$$\n\\begin{aligned}\n\\frac{dV}{dt} = (\\alpha-g_{L})\\,V - \\beta V^{3} - w + I \\\\\n\\frac{dw}{dt} = \\epsilon\\left(\\kappa V + \\lambda - w\\right)\n\\end{aligned}\n$$\n$V$-零斜线（其中 $\\frac{dV}{dt}=0$）是三次函数 $w(V) = (\\alpha-g_{L})V - \\beta V^3 + I$。$w$-零斜线（其中 $\\frac{dw}{dt}=0$）是直线 $w(V) = \\kappa V + \\lambda$。参数定义为 $\\alpha0$, $\\beta0$, $\\kappa0$, $\\lambda \\in \\mathbb{R}$ 且 $0\\epsilon\\ll 1$。\n\n**第一部分：漏电导 $g_{L}$ 对 $V$-零斜线及其拐点的影响**\n\n$V$-零斜线的方程是 $w = (\\alpha-g_{L})V - \\beta V^3 + I$。漏电导 $g_L$ 出现在线性项中。增加 $g_L$ 会减小系数 $(\\alpha-g_{L})$。对于给定的 $I$，这会使三次曲线的形状“变平”。当 $V  0$ 时，增加 $g_L$ 会减小零斜线上 $w$ 的值。当 $V  0$ 时，增加 $g_L$ 会增加 $w$ 的值。这构成了一个围绕点 $(0, I)$ 旋转零斜线的剪切变换。\n\n三次 $V$-零斜线的拐点是其局部极值点，由条件 $\\frac{dw}{dV} = 0$ 定义。我们计算关于 $V$ 的导数：\n$$\n\\frac{dw}{dV} = (\\alpha-g_{L}) - 3\\beta V^2\n$$\n将其设为零，得到拐点的 $V$ 坐标：\n$$\n(\\alpha-g_{L}) - 3\\beta V^2 = 0 \\implies V^2 = \\frac{\\alpha-g_{L}}{3\\beta}\n$$\n为使两个实数拐点存在，必须有 $\\alpha-g_{L}  0$。假设此条件成立，则 $V$ 坐标为：\n$$\nV_{\\text{knees}} = \\pm\\sqrt{\\frac{\\alpha-g_{L}}{3\\beta}}\n$$\n随着 $g_L$ 增加，项 $(\\alpha-g_{L})$ 减小。因此，$|V_{\\text{knees}}|$ 的大小减小，这意味着拐点水平向 $w$ 轴（$V=0$）移动。\n\n为了找到拐点的 $w$ 坐标，我们将 $V_{\\text{knees}}$ 代回零斜线方程：\n$$\nw_{\\text{knees}} = (\\alpha-g_{L})V_{\\text{knees}} - \\beta V_{\\text{knees}}^3 + I = V_{\\text{knees}}\\left((\\alpha-g_{L}) - \\beta V_{\\text{knees}}^2\\right) + I\n$$\n使用关系式 $V_{\\text{knees}}^2 = \\frac{\\alpha-g_{L}}{3\\beta}$，我们代入 $\\beta V_{\\text{knees}}^2$ 项：\n$$\nw_{\\text{knees}} = V_{\\text{knees}}\\left((\\alpha-g_{L}) - \\beta \\frac{\\alpha-g_{L}}{3\\beta}\\right) + I = V_{\\text{knees}}\\left((\\alpha-g_{L}) - \\frac{1}{3}(\\alpha-g_{L})\\right) + I = \\frac{2}{3}(\\alpha-g_{L})V_{\\text{knees}} + I\n$$\n代入 $V_{\\text{knees}}$ 的表达式：\n$$\nw_{\\text{knees}} = \\frac{2}{3}(\\alpha-g_{L})\\left(\\pm\\sqrt{\\frac{\\alpha-g_{L}}{3\\beta}}\\right) + I = \\pm\\frac{2(\\alpha-g_{L})^{3/2}}{3\\sqrt{3\\beta}} + I\n$$\n随着 $g_L$ 增加，$(\\alpha-g_{L})$ 减小，因此项 $\\pm\\frac{2(\\alpha-g_{L})^{3/2}}{3\\sqrt{3\\beta}}}$ 的大小也减小。这意味着拐点的 $w$ 坐标向值 $I$ 移动。\n\n总之，增加漏电导 $g_L$ 会导致 $V$-零斜线的两个拐点相互靠近，在 $(V, w)$-平面上收敛于点 $(0, I)$。\n\n**第二部分：区分 SNIC 和 Hopf 分岔起始的条件**\n\n当电流 $I$ 增加时，系统的稳定不动点（静息态）失去稳定性，此时发生重复性尖峰放电。分岔的类型取决于雅可比矩阵的特征值如何穿过虚轴。不动点 $(V_*, w_*)$ 是零斜线的交点。不动点处的雅可比矩阵 $J$ 为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial\\dot{V}}{\\partial V}  \\frac{\\partial\\dot{V}}{\\partial w} \\\\ \\frac{\\partial\\dot{w}}{\\partial V}  \\frac{\\partial\\dot{w}}{\\partial w} \\end{pmatrix}_{(V_*, w_*)} = \\begin{pmatrix} (\\alpha-g_{L}) - 3\\beta V_*^2  -1 \\\\ \\epsilon\\kappa  -\\epsilon \\end{pmatrix}\n$$\n令 $S_V = (\\alpha-g_{L}) - 3\\beta V_*^2$ 为不动点处 $V$-零斜线的斜率。雅可比矩阵变为 $J = \\begin{pmatrix} S_V  -1 \\\\ \\epsilon\\kappa  -\\epsilon \\end{pmatrix}$。\n矩阵的迹和行列式为：\n$$\n\\text{Tr}(J) = S_V - \\epsilon\n$$\n$$\n\\text{Det}(J) = S_V(-\\epsilon) - (-1)(\\epsilon\\kappa) = \\epsilon(\\kappa - S_V)\n$$\n如果 $\\text{Tr}(J)  0$ 且 $\\text{Det}(J)  0$，则不动点是稳定的。在奇异极限 $\\epsilon\\to 0^+$下，这些条件变为 $S_V  0$ 和 $\\kappa  S_V$。神经元的静息态是一个稳定不动点，通常位于负电位 $V_*$ 处。$V$-零斜线呈 N 形，稳定不动点位于斜率 $S_V$ 为负的外部支上。因此，对于静息态，$S_V  0$，并且由于 $\\kappa  0$，稳定性条件得到满足。\n\n随着 $I$ 增加，$V$-零斜线向上平移，不动点 $(V_*, w_*)$ 移动。当 $\\text{Tr}(J)$ 或 $\\text{Det}(J)$ 变为零时，稳定性丧失。\n当 $\\text{Det}(J)=0$ 时发生鞍节点分岔，这意味着 $S_V = \\kappa$。这对应于 $w$-零斜线与 $V$-零斜线相切。\n当 $\\text{Tr}(J)=0$ 而 $\\text{Det}(J)0$ 时发生 Hopf 分岔，这意味着 $S_V = \\epsilon \\approx 0$。\n\n分岔的类型由零斜线的全局几何形状决定。不动点是方程 $(\\alpha-g_{L})V - \\beta V^3 + I = \\kappa V + \\lambda$ 的解，该方程可重写为 $\\beta V^3 + (\\kappa - (\\alpha-g_L))V + \\lambda - I = 0$。$V$ 的实根数量决定了不动点的数量。\n这取决于线性项系数 $\\kappa - (\\alpha-g_L)$ 的符号。\n情况1：$\\kappa  \\alpha-g_L$。函数 $F(V) = \\beta V^3 + (\\kappa - (\\alpha-g_L))V$ 是单调的。对于任何 $I$ 值，总存在唯一一个不动点。随着 $I$ 增加，这个不动点从稳定的左支（$S_V  0$）移动到不稳定的中支（$S_V  0$）。当 $S_V$ 从负值穿过到正值时，稳定性丧失。分岔点在 $\\text{Tr}(J) = S_V - \\epsilon = 0$ 处，即 $S_V=\\epsilon$。由于在这一点 $\\text{Det}(J) = \\epsilon(\\kappa - \\epsilon)  0$（因为 $\\kappa  \\alpha-g_L  0$ 且 $\\epsilon \\ll 1$），这是一个 Hopf 分岔。\n\n情况2：$\\kappa  \\alpha-g_L$。系数 $\\kappa - (\\alpha-g_L)$ 为负。函数 $F(V)$ 是非单调的，根据 $I$ 的值可能有一个或三个实根。这意味着存在一个 $I$ 的范围，使得系统有三个不动点（一个稳定节点、一个鞍点和一个不稳定节点/螺线点）。当 $I$ 从一个低值增加时，初始的稳定静息态（节点）向鞍点移动。在一个临界 $I$ 值时，它们合并并消失。这是一个鞍节点分岔。由于离开分岔点的轨迹在相空间中经历一个大的偏离（一个尖峰），然后返回到鞍节点附近，所以这是一个鞍节点不变圆 (SNIC) 分岔。\n\n因此，区分这两种起始类型的条件是 $w$-零斜线的斜率 $\\kappa$ 与 $V$-零斜线的最大正斜率的比较。$V$-零斜线的斜率是 $S_V(V) = (\\alpha-g_L) - 3\\beta V^2$。其最大值在 $V=0$ 处取得，为 $S_{V, \\text{max}} = \\alpha-g_L$。\n条件是：\n- 如果 $w$-零斜线的斜率小于 $V$-零斜线的最大斜率，即 $\\kappa  \\alpha-g_L$，则为 **SNIC 起始**。\n- 如果 $w$-零斜线的斜率大于 $V$-零斜线的最大斜率，即 $\\kappa  \\alpha-g_L$，则为 **Hopf 起始**。\n\n**第三部分：SNIC 起始的基电流 $I_{\\mathrm{rh}}(g_{L})$**\n\n我们处于 SNIC 机制下，其中 $\\kappa  \\alpha-g_L$。基电流 $I_{\\text{rh}}$ 是导致神经元放电的最小电流，它对应于鞍节点分岔发生时的 $I$ 值。如问题所述并与我们的分析一致，这种情况发生在 $w$-零斜线 $w = \\kappa V + \\lambda$ 与 $V$-零斜线 $w = (\\alpha-g_L)V - \\beta V^3 + I$ 相切时。问题指明此相切发生在“左拐点”，我们将其解释为负电压 $V0$ 处的鞍节点。\n\n在点 $V=V_{\\text{rh}}$ 处相切的条件是：\n1.  $w$ 的值相等：$\\kappa V_{\\text{rh}} + \\lambda = (\\alpha-g_L)V_{\\text{rh}} - \\beta V_{\\text{rh}}^3 + I_{\\text{rh}}$\n2.  斜率（关于 $V$ 的导数）相等：$\\kappa = (\\alpha-g_L) - 3\\beta V_{\\text{rh}}^2$\n\n从第二个条件，我们解出 $V_{\\text{rh}}$：\n$$\n3\\beta V_{\\text{rh}}^2 = \\alpha-g_L-\\kappa \\implies V_{\\text{rh}}^2 = \\frac{\\alpha-g_L-\\kappa}{3\\beta}\n$$\n分岔不动点在左侧，所以我们取 $V_{\\text{rh}}$ 的负根：\n$$\nV_{\\text{rh}} = -\\sqrt{\\frac{\\alpha-g_L-\\kappa}{3\\beta}}\n$$\n这一选择是一致的，因为实数解要求 $\\alpha-g_L-\\kappa  0$，这正是 SNIC 机制的条件。\n\n现在，我们用第一个条件来求解 $I_{\\text{rh}}$：\n$$\nI_{\\text{rh}} = (\\kappa - (\\alpha-g_L))V_{\\text{rh}} + \\beta V_{\\text{rh}}^3 + \\lambda\n$$\n我们可以提出因子 $V_{\\text{rh}}$：\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(\\kappa - (\\alpha-g_L) + \\beta V_{\\text{rh}}^2\\right) + \\lambda\n$$\n代入 $\\beta V_{\\text{rh}}^2 = \\frac{1}{3}(\\alpha-g_L-\\kappa)$：\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(\\kappa - (\\alpha-g_L) + \\frac{1}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(-(\\alpha-g_L-\\kappa) + \\frac{1}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(-\\frac{2}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n现在，代入 $V_{\\text{rh}}$ 的表达式：\n$$\nI_{\\text{rh}} = \\left(-\\sqrt{\\frac{\\alpha-g_L-\\kappa}{3\\beta}}\\right)\\left(-\\frac{2}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n两个负号抵消，得到：\n$$\nI_{\\text{rh}}(g_{L}) = \\frac{2}{3}(\\alpha-g_L-\\kappa) \\sqrt{\\frac{\\alpha-g_L-\\kappa}{3\\beta}} + \\lambda\n$$\n这个表达式可以简化为最终形式：\n$$\nI_{\\text{rh}}(g_{L}) = \\lambda + \\frac{2(\\alpha-g_L-\\kappa)^{3/2}}{3\\sqrt{3\\beta}}\n$$\n这就是在 SNIC 分岔条件下，基电流作为漏电导 $g_L$ 和其他系统参数的函数的闭式表达式。",
            "answer": "$$\n\\boxed{\\lambda + \\frac{2}{3\\sqrt{3\\beta}}(\\alpha - g_{L} - \\kappa)^{3/2}}\n$$"
        },
        {
            "introduction": "神经元很少在孤立状态下放电；它们通过整合来自庞大网络中的突触输入来计算。这项练习  探讨了一个关键问题：位于树突上的突触输入需要多强才能使神经元达到其在胞体的放电阈值？通过比较被动树突和具有主动反向传播特性的树突，您将量化主动树突过程在根本上如何改变突触整合的规则，从而揭示树突计算在神经功能中的重要性。",
            "id": "3960948",
            "problem": "您的任务是，对于位于树突上某一电紧张位置的突触输入，预测在存在和不存在主动树突反向传播两种情况下，引发胞体动作电位（AP）所需的最小突触电导的变化。您的程序必须为每个测试用例计算主动情况下胞体阈值电导与被动情况下胞体阈值电导之间的差值，并以纳西门子（nanosiemens）为单位表示。\n\n从以下基本原理和定义出发：\n\n- 线性化稳态被动电缆关系表明，在电紧张距离 $x/\\lambda$ 处注入一个小的局部突触电流，所产生的胞体电压响应会按因子 $\\exp(-x/\\lambda)$ 指数衰减。\n- 在小信号近似下，突触电流为 $I_{\\mathrm{syn}} \\approx g_{\\mathrm{syn}} \\left(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}\\right)$，其中 $g_{\\mathrm{syn}}$ 是突触电导，$E_{\\mathrm{syn}}$ 是突触反转电位，$V_{\\mathrm{rest}}$ 是静息膜电位。\n- 用于启动峰电位的胞体电压阈值为 $\\Theta_s$，而启动树突峰电位的树突局部激活阈值为 $\\Theta_d$。定义 $\\Delta V_{\\mathrm{th}} = \\Theta_s - V_{\\mathrm{rest}}$ 和 $\\Delta V_{d} = \\Theta_d - V_{\\mathrm{rest}}$。\n- 对于位于电紧张距离 $x/\\lambda$ 处的突触输入，其被动胞体电压响应可以建模为与 $I_{\\mathrm{syn}} R_{\\mathrm{soma}} \\exp(-x/\\lambda)$ 成正比，其中 $R_{\\mathrm{soma}}$ 是胞体输入电阻。\n- 主动反向传播被建模为一个附加的胞体去极化 $S_{\\mathrm{bp}}(x)$，一旦树突位点达到其局部阈值 $\\Theta_d$，该去极化就会被加上。这个反向传播的贡献随突触的电紧张位置按 $\\exp(-x/\\lambda_{\\mathrm{bp}})$ 衰减，其中 $\\lambda_{\\mathrm{bp}}$ 代表主动反向传播期间的有效空间常数。为了使用 $x/\\lambda$ 明确地参数化衰减，定义 $\\rho = \\lambda / \\lambda_{\\mathrm{bp}}$，并将反向传播的胞体贡献建模为 $S_{\\mathrm{bp}}(x) = S_0 \\exp(-\\rho \\, x/\\lambda)$，其中 $S_0$ 是在 $x=0$ 处有效启动的峰电位所能观察到的反向传播胞体去极化，单位为毫伏。\n\n您的任务是：\n\n- 从第一性原理出发，推导出在被动情况和主动情况下达到胞体阈值所需的最小突触电导表达式，同时考虑由树突峰电位触发可能产生的分段条件。\n- 构建一个算法，为下面测试套件中的每组参数，计算主动阈值电导与被动阈值电导之差，即 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$，以纳西门子为单位表示，并四舍五入到三位小数。\n\n单位和约定：\n\n- 所有膜电位必须以毫伏（$\\,\\mathrm{mV}$）为单位。\n- 所有电阻必须以兆欧（$\\,\\mathrm{M\\Omega}$）为单位，并在内部转换为欧姆（$\\,\\Omega$）。\n- 突触电导必须以西门子（$\\,\\mathrm{S}$）为单位计算，最终报告的值必须以纳西门子（$\\,\\mathrm{nS}$）为单位返回。\n- 指数衰减的参数使用电紧张距离 $x/\\lambda$；本问题不使用角度。\n\n您程序的输入在内部固定为以下测试套件。每个测试用例是一个元组\n$\\left(x/\\lambda,\\ \\rho,\\ R_{\\mathrm{soma}},\\ R_{\\mathrm{dend}},\\ V_{\\mathrm{rest}},\\ E_{\\mathrm{syn}},\\ \\Theta_s,\\ \\Theta_d,\\ S_0\\right)$\n，其单位为 $\\left(\\text{无量纲},\\ \\text{无量纲},\\ \\mathrm{M\\Omega},\\ \\mathrm{M\\Omega},\\ \\mathrm{mV},\\ \\mathrm{mV},\\ \\mathrm{mV},\\ \\mathrm{mV},\\ \\mathrm{mV}\\right)$：\n\n- 用例 1：$\\left(0.2,\\ 0.5,\\ 100,\\ 150,\\ -65,\\ 0,\\ -50,\\ -55,\\ 20\\right)$\n- 用例 2：$\\left(1.0,\\ 0.5,\\ 100,\\ 150,\\ -65,\\ 0,\\ -50,\\ -55,\\ 20\\right)$\n- 用例 3：$\\left(3.0,\\ 0.5,\\ 100,\\ 150,\\ -65,\\ 0,\\ -50,\\ -55,\\ 20\\right)$\n- 用例 4：$\\left(0.2,\\ 1.0,\\ 100,\\ 50,\\ -65,\\ 0,\\ -50,\\ -55,\\ 8\\right)$\n- 用例 5：$\\left(2.0,\\ 1.5,\\ 100,\\ 200,\\ -65,\\ 0,\\ -50,\\ -55,\\ 2\\right)$\n\n算法要求：\n\n- 对于每个用例，根据物理推导的条件实现被动阈值和主动阈值逻辑，包括胞体在树突位点触发前仅通过线性求和就达到阈值的可能性，以及一旦触发，反向传播的贡献会降低所需突触电导的可能性。\n- 确保内部单位转换正确：将 $\\mathrm{mV}$ 乘以 $10^{-3}$ 转换为 $\\mathrm{V}$，将 $\\mathrm{M\\Omega}$ 乘以 $10^{6}$ 转换为 $\\Omega$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含五个测试用例按顺序排列的结果，格式为一个由方括号括起来的逗号分隔列表。每个条目都应是阈值电导的变化量 $\\Delta g$，单位为 $\\mathrm{nS}$，四舍五入到三位小数。例如：$\\left[\\text{val}_1,\\text{val}_2,\\text{val}_3,\\text{val}_4,\\text{val}_5\\right]$ 必须在一行上完全按单个 Python 列表字面量的形式打印。",
            "solution": "此问题经评估有效。它在科学上基于计算神经科学的原理，问题陈述清晰，提供了足够的信息以获得唯一解，并且表述客观。该模型虽然经过简化，但却是突触整合和树突计算的标准表示。\n\n任务是计算具有主动树突特性的神经元模型与纯被动模型相比，在引发胞体动作电位（AP）时所需的阈值突触电导的差异。该差异表示为 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n\n首先，让我们根据问题陈述定义关键量。在内部计算中，所有电位单位为伏特（$\\mathrm{V}$），电阻单位为欧姆（$\\Omega$），这些值由给定的毫伏（$\\mathrm{mV}$）和兆欧（$\\mathrm{M\\Omega}$）单位转换而来。\n\n突触电流 $I_{\\mathrm{syn}}$ 由小信号近似给出：\n$$I_{\\mathrm{syn}} = g_{\\mathrm{syn}} (E_{\\mathrm{syn}} - V_{\\mathrm{rest}})$$\n其中 $g_{\\mathrm{syn}}$ 是突触电导，$E_{\\mathrm{syn}}$ 是突触反转电位，$V_{\\mathrm{rest}}$ 是静息膜电位。我们定义突触驱动电位为 $\\Delta V_{\\mathrm{syn}} = E_{\\mathrm{syn}} - V_{\\mathrm{rest}}$。\n\n由于位于电紧张距离 $X = x/\\lambda$ 处的突触电流，胞体的电压变化 $\\Delta V_{\\mathrm{soma}}$ 按因子 $\\exp(-X)$ 衰减：\n$$\\Delta V_{\\mathrm{soma}} = I_{\\mathrm{syn}} R_{\\mathrm{soma}} \\exp(-X)$$\n其中 $R_{\\mathrm{soma}}$ 是胞体输入电阻。\n\n突触所在树突位点的局部电压变化 $\\Delta V_{\\mathrm{local}}$ 由该位置的局部输入电阻 $R_{\\mathrm{dend}}$ 决定：\n$$\\Delta V_{\\mathrm{local}} = I_{\\mathrm{syn}} R_{\\mathrm{dend}}$$\n\n从静息状态达到胞体和树突阈值所需的电压变化为：\n$$\\Delta V_{\\mathrm{th}} = \\Theta_s - V_{\\mathrm{rest}}$$\n$$\\Delta V_{d} = \\Theta_d - V_{\\mathrm{rest}}$$\n\n**步骤 1：被动阈值电导 ($g_{\\mathrm{th}}^{\\mathrm{passive}}$) 的推导**\n\n在被动情况下，当胞体电位达到阈值 $\\Theta_s$ 时，即 $\\Delta V_{\\mathrm{soma}} = \\Delta V_{\\mathrm{th}}$，会触发胞体动作电位。我们可以建立等式并求解阈值电导 $g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n$$\\Delta V_{\\mathrm{th}} = I_{\\mathrm{syn}} R_{\\mathrm{soma}} \\exp(-X)$$\n代入 $I_{\\mathrm{syn}}$ 的表达式：\n$$\\Delta V_{\\mathrm{th}} = g_{\\mathrm{th}}^{\\mathrm{passive}} (E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X)$$\n求解 $g_{\\mathrm{th}}^{\\mathrm{passive}}$：\n$$g_{\\mathrm{th}}^{\\mathrm{passive}} = \\frac{\\Delta V_{\\mathrm{th}}}{(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X)}$$\n\n**步骤 2：主动阈值电导 ($g_{\\mathrm{th}}^{\\mathrm{active}}$) 的推导**\n\n主动情况引入了一个条件非线性：如果局部树突电位达到其阈值 $\\Theta_d$，则一个额外的去极化贡献 $S_{\\mathrm{bp}}(x) = S_0 \\exp(-\\rho X)$ 会被加到胞体上。我们必须确定随着 $g_{\\mathrm{syn}}$ 的增加，哪个阈值会先被达到：是局部树突阈值还是胞体阈值。\n\n让我们找出触发树突阈值所需的电导 $g_{\\mathrm{dend}}$。这发生在 $\\Delta V_{\\mathrm{local}} = \\Delta V_{d}$ 时：\n$$\\Delta V_{d} = I_{\\mathrm{syn}} R_{\\mathrm{dend}} = g_{\\mathrm{dend}} (E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{dend}}$$\n求解 $g_{\\mathrm{dend}}$：\n$$g_{\\mathrm{dend}} = \\frac{\\Delta V_{d}}{(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{dend}}}$$\n\n现在我们比较 $g_{\\mathrm{dend}}$ 和 $g_{\\mathrm{th}}^{\\mathrm{passive}}$ 来确定事件的顺序。\n\n**情况 A：首先达到胞体阈值 ($g_{\\mathrm{th}}^{\\mathrm{passive}} \\le g_{\\mathrm{dend}}$)**\n如果被动地触发胞体所需的电导小于或等于触发树突峰电位所需的电导，那么胞体动作电位将在树突非线性机制介入之前启动。在这种情况下，主动机制是无关的。阈值电导与被动情况下的相同。\n$$g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{th}}^{\\mathrm{passive}}$$\n\n**情况 B：首先达到树突阈值 ($g_{\\mathrm{th}}^{\\mathrm{passive}}  g_{\\mathrm{dend}}$)**\n如果树突位点首先达到其阈值，就会产生反向传播电位 $S_{\\mathrm{bp}}(x)$。我们接着必须检查这个额外的去极化是否足以将胞体电位推过其阈值 $\\Theta_s$。\n\n在树突峰电位被触发的瞬间（即当 $g_{\\mathrm{syn}} = g_{\\mathrm{dend}}$ 时），总的胞体去极化是被动突触贡献和反向传播电位之和：\n$$\\Delta V_{\\mathrm{soma, total}} = \\Delta V_{\\mathrm{soma}}(g_{\\mathrm{dend}}) + S_{\\mathrm{bp}}(x)$$\n此时的突触电流为 $I_{\\mathrm{syn}} = g_{\\mathrm{dend}}(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) = \\Delta V_d / R_{\\mathrm{dend}}$。因此，胞体电压的被动分量为 $\\Delta V_{\\mathrm{soma}}(g_{\\mathrm{dend}}) = (\\Delta V_d / R_{\\mathrm{dend}}) R_{\\mathrm{soma}} \\exp(-X)$。总的胞体电压变化为：\n$$\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}} = \\frac{\\Delta V_d R_{\\mathrm{soma}}}{R_{\\mathrm{dend}}} \\exp(-X) + S_0 \\exp(-\\rho X)$$\n\n由此产生两种子情况：\n\n**B1：树突峰电位足以触发胞体动作电位 ($\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}} \\ge \\Delta V_{\\mathrm{th}}$)**\n如果在树突峰电位发生时，总的胞体去极化足以达到胞体阈值，那么所需的最小电导就是触发树突峰电位所需的电导。\n$$g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{dend}}$$\n\n**B2：树突峰电位不足以触发胞体动作电位 ($\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}}  \\Delta V_{\\mathrm{th}}$)**\n如果胞体阈值尚未达到，我们需要进一步增加突触电导 $g_{\\mathrm{syn}}$。对于任何电导 $g_{\\mathrm{syn}} \\ge g_{\\mathrm{dend}}$，总的胞体电压由 $\\Delta V_{\\mathrm{soma}}(g_{\\mathrm{syn}}) + S_{\\mathrm{bp}}(x)$ 给出。我们需要找到满足以下条件的 $g_{\\mathrm{syn}}$ 值（我们称之为 $g_{\\mathrm{th}}^{\\mathrm{active}}$）：\n$$g_{\\mathrm{th}}^{\\mathrm{active}}(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X) + S_0 \\exp(-\\rho X) = \\Delta V_{\\mathrm{th}}$$\n求解 $g_{\\mathrm{th}}^{\\mathrm{active}}$：\n$$g_{\\mathrm{th}}^{\\mathrm{active}} = \\frac{\\Delta V_{\\mathrm{th}} - S_0 \\exp(-\\rho X)}{(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X)}$$\n\n**步骤 3：算法总结与计算**\n\n最终值 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$ 是通过遵循上述推导的逻辑为每个测试用例计算得出的。所有以 $\\mathrm{mV}$ 和 $\\mathrm{M\\Omega}$ 为单位的输入参数在使用公式前都分别转换为 $\\mathrm{V}$ 和 $\\Omega$。然后使用得到的以西门子（$\\mathrm{S}$）为单位的电导来计算 $\\Delta g$，最后将其乘以 $10^9$ 转换为纳西门子（$\\mathrm{nS}$）并四舍五入到三位小数。\n\n整个算法如下：\n1.  将所有输入参数转换为国际单位制基本单位（$\\mathrm{V}$，$\\Omega$）。\n2.  计算 $g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n3.  计算 $g_{\\mathrm{dend}}$。\n4.  如果 $g_{\\mathrm{th}}^{\\mathrm{passive}} \\le g_{\\mathrm{dend}}$，则设 $g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n5.  如果 $g_{\\mathrm{th}}^{\\mathrm{passive}}  g_{\\mathrm{dend}}$：\n    a. 计算 $\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}}$。\n    b. 如果 $\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}} \\ge \\Delta V_{\\mathrm{th}}$，则设 $g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{dend}}$。\n    c. 否则，使用子情况 B2 中的公式计算 $g_{\\mathrm{th}}^{\\mathrm{active}}$。\n6.  计算 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n7.  将 $\\Delta g$ 从 $\\mathrm{S}$ 转换为 $\\mathrm{nS}$ 并四舍五入。\n\n为每个提供的测试用例执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in threshold synaptic conductance due to active dendritic backpropagation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (x/lambda, rho, R_soma_Mohm, R_dend_Mohm, V_rest_mV, E_syn_mV, Theta_s_mV, Theta_d_mV, S0_mV)\n    test_cases = [\n        (0.2, 0.5, 100, 150, -65, 0, -50, -55, 20),\n        (1.0, 0.5, 100, 150, -65, 0, -50, -55, 20),\n        (3.0, 0.5, 100, 150, -65, 0, -50, -55, 20),\n        (0.2, 1.0, 100, 50, -65, 0, -50, -55, 8),\n        (2.0, 1.5, 100, 200, -65, 0, -50, -55, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        x_lambda, rho, R_soma_Mohm, R_dend_Mohm, V_rest_mV, E_syn_mV, Theta_s_mV, Theta_d_mV, S0_mV = case\n\n        # --- Unit Conversion to base SI units (V, Ohm) ---\n        R_soma = R_soma_Mohm * 1e6\n        R_dend = R_dend_Mohm * 1e6\n        V_rest = V_rest_mV * 1e-3\n        E_syn = E_syn_mV * 1e-3\n        Theta_s = Theta_s_mV * 1e-3\n        Theta_d = Theta_d_mV * 1e-3\n        S0 = S0_mV * 1e-3\n\n        # --- Derived quantities ---\n        delta_V_th = Theta_s - V_rest   # Somatic threshold voltage change\n        delta_V_d = Theta_d - V_rest    # Dendritic threshold voltage change\n        delta_V_syn = E_syn - V_rest      # Synaptic driving potential\n\n        # --- Step 1: Calculate Passive Threshold Conductance ---\n        # The conductance at the synapse needed to reach somatic threshold in a passive dendrite.\n        # Check for division by zero, though not expected with given data.\n        denominator_passive = delta_V_syn * R_soma * np.exp(-x_lambda)\n        if denominator_passive == 0:\n            # Handle case of infinite conductance if necessary\n            g_th_passive = float('inf')\n        else:\n            g_th_passive = delta_V_th / denominator_passive\n\n        # --- Step 2: Calculate Active Threshold Conductance ---\n        \n        # Conductance required to trigger the local dendritic spike\n        denominator_dend = delta_V_syn * R_dend\n        if denominator_dend == 0:\n            g_dend = float('inf')\n        else:\n            g_dend = delta_V_d / denominator_dend\n\n        g_th_active = 0.0\n\n        # Compare passive somatic threshold with dendritic threshold to determine which fires first\n        if g_th_passive = g_dend:\n            # Case A: Somatic AP is triggered before or at the same time as the dendritic spike.\n            # Active mechanism is not engaged or is irrelevant.\n            g_th_active = g_th_passive\n        else:\n            # Case B: Dendritic spike is triggered first.\n            V_soma_at_dend_spike = (delta_V_d * R_soma / R_dend) * np.exp(-x_lambda) + S0 * np.exp(-rho * x_lambda)\n            \n            if V_soma_at_dend_spike >= delta_V_th:\n                # Case B1: The dendritic spike provides enough depolarization to trigger a somatic AP immediately.\n                # The threshold conductance is just that needed for the dendritic spike.\n                g_th_active = g_dend\n            else:\n                # Case B2: More conductance is needed after the dendritic spike.\n                # The total voltage is the sum of passive attenuation and the now-active backpropagation contribution.\n                numerator = delta_V_th - S0 * np.exp(-rho * x_lambda)\n                denominator = delta_V_syn * R_soma * np.exp(-x_lambda)\n                if denominator == 0:\n                    g_th_active = float('inf')\n                else:\n                    g_th_active = numerator / denominator\n\n        # --- Step 3: Calculate the difference and format the output ---\n        delta_g_S = g_th_active - g_th_passive  # Difference in Siemens\n        delta_g_nS = delta_g_S * 1e9         # Convert to nanoSiemens\n        \n        results.append(round(delta_g_nS, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们对大脑活动的许多见解来自于对细胞外电位的记录，但这些信号是如何产生的，我们又该如何准确地解释它们呢？这项练习  深入探讨了将跨膜电流与我们测量的细胞外信号联系起来的正向模型。您将推导并实现一个考虑了脑组织各向异性电导率的模型——这是一个在真实大脑中存在但常被忽略的特性——并量化当错误地假设组织为各向同性时，在推断神经元放电时间上会产生多大的偏差。",
            "id": "3960982",
            "problem": "您正在一个均匀、无限的具有各向异性电导率的欧姆介质中，对由单个神经元电流源产生的细胞外电位进行建模。在准静态近似下，电位场满足一个由点源驱动的散度形式方程。您的任务是推导、实现并使用各向异性电导率的正向模型格林函数，以量化在各向同性的错误假设下推断阈值时间所产生的计时偏差。\n\n从以下基本原理和定义出发，并且不要引用任何预先推导出的各向异性格林函数的目标表达式。您使用的任何特定表达式都必须基于这些基础进行推导。\n\n- 欧姆传导：电流密度为 $ \\mathbf{J} = \\boldsymbol{\\sigma} \\mathbf{E} $，其中 $ \\boldsymbol{\\sigma} $ 是一个常数、对称、正定的电导率张量，而 $ \\mathbf{E} = -\\nabla \\phi $ 是由电位 $ \\phi $ 产生的电场。\n- 电荷守恒和准静态近似意味着控制性偏微分方程（PDE）为 $ \\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla \\phi) = -I \\delta(\\mathbf{r} - \\mathbf{r}_0) $，其中 $ I $ 是注入的电流，$ \\delta(\\cdot) $ 是狄拉克δ分布，$ \\mathbf{r}_0 $ 是源位置。\n- 在一个具有标量电导率 $ s $ 的各向同性介质中，位于 $ \\mathbf{r}_0 $ 的点源在 $ \\mathbb{R}^3 $ 中的各向同性格林函数形式为 $ \\phi(\\mathbf{r}) \\propto \\frac{1}{s \\|\\mathbf{r} - \\mathbf{r}_0\\|} $。\n\n假设神经元跨膜电流的时间进程是已知的，并且在感兴趣的时间区间内单调递增，由一个饱和指数函数建模：\n$$\nI(t) = I_{\\max} \\left(1 - e^{-\\frac{t - t_0}{\\tau}}\\right), \\quad t \\ge t_0,\n$$\n其中 $ I_{\\max}  0 $ 是渐近峰值电流，$ t_0 $ 是起始时间，$ \\tau  0 $ 是上升时间常数。在固定电极位置 $ \\mathbf{r}_e $ 处的细胞外电位通过线性叠加与源电流相关联：\n$$\n\\phi(\\mathbf{r}_e, t) = G(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma}) \\, I(t),\n$$\n其中 $ G(\\cdot; \\boldsymbol{\\sigma}) $ 是在电极-源位移矢量 $ \\mathbf{r}_e - \\mathbf{r}_0 $ 处求值的正向模型格林函数核。\n\n您的目标是：\n\n1.  推导均匀、无限介质中具有对角电导率张量 $ \\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_x, \\sigma_y, \\sigma_z) $ 的闭合形式各向异性格林函数 $ G(\\mathbf{r}; \\boldsymbol{\\sigma}) $。\n2.  给定一个标量各向同性电导率假设 $ s $，推导在相同位移 $ \\mathbf{r} $ 处，各向同性与各向异性正向模型核之间的比率 $ R $，定义为\n$$\nR = \\frac{G_{\\mathrm{iso}}(\\mathbf{r}; s)}{G(\\mathbf{r}; \\boldsymbol{\\sigma})},\n$$\n其中 $ G_{\\mathrm{iso}}(\\mathbf{r}; s) $ 是电导率为 $ s $ 时的各向同性核。\n3.  将在各向同性假设下推断的阈值时间定义为以下方程的解 $ t_{\\mathrm{est}} $\n$$\n\\phi(\\mathbf{r}_e, t_{\\mathrm{est}}) = G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s) \\, I_{\\mathrm{thr}},\n$$\n其中 $ I_{\\mathrm{thr}} $ 是一个固定的膜电流阈值。真实的阈值时间是解算以下方程的 $ t_{\\mathrm{true}} $\n$$\nI(t_{\\mathrm{true}}) = I_{\\mathrm{thr}}.\n$$\n使用推导出的表达式和给定的 $ I(t) $，获得计时偏差的闭合形式公式\n$$\n\\Delta t = t_{\\mathrm{est}} - t_{\\mathrm{true}}.\n$$\n\n然后，实现一个完整、可运行的程序，为以下测试套件计算 $ \\Delta t $。所有时间以毫秒为单位，表示为实值浮点数。\n\n测试套件（每个案例指定 $ (\\sigma_x, \\sigma_y, \\sigma_z) $，单位为西门子/米；$ s $，单位为西门子/米；$ \\mathbf{r}_e - \\mathbf{r}_0 $，单位为米；$ I_{\\max} $ 和 $ I_{\\mathrm{thr}} $，单位为安培；以及 $ (t_0, \\tau) $，单位为秒）：\n\n- 情况1（基线各向同性，理想路径）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.3, 0.3, 0.3) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (50 \\times 10^{-6}, 0, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 情况2（各向异性，电极沿高电导率轴）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.6, 0.3, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (50 \\times 10^{-6}, 0, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 情况3（各向异性，电极沿低电导率轴）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.6, 0.3, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (0, 50 \\times 10^{-6}, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 情况4（各向异性，斜向电极-源位移）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.6, 0.3, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (30 \\times 10^{-6}, 40 \\times 10^{-6}, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 情况5（边界情况：近饱和阈值）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.4, 0.2, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (50 \\times 10^{-6}, 0, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1.9 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.5 \\times 10^{-3} $\n\n您的程序应生成一行输出，其中包含五个案例的计时偏差，以毫秒为单位，格式为方括号括起来的逗号分隔列表（例如，$ [\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4, \\Delta t_5] $）。程序必须完全按照上述定义计算 $ \\Delta t $，并且必须能够直接运行，无需外部输入。通过使用推导出的 $ G(\\mathbf{r}; \\boldsymbol{\\sigma}) $ 和 $ G_{\\mathrm{iso}}(\\mathbf{r}; s) $ 公式，并仅处理物理上有效的配置（例如，不要在 $ \\mathbf{r}_e = \\mathbf{r}_0 $ 处求值，因为格林函数在该点发散），确保科学真实性。不需要角度单位，因为没有使用任何角度量。时间必须以毫秒报告。",
            "solution": "该问题是有效的，因为它具有科学依据、提法恰当、客观，并包含获得唯一解所需的所有信息。其基础的静电学和微积分原理是标准的，并且陈述正确。我们将首先推导必要的解析表达式，然后针对给定的测试用例进行数值实现。\n\n### 第1部分：各向异性格林函数的推导\n\n我们从控制电位$\\phi$的偏微分方程(PDE)开始，该方程描述了在具有各向异性电导率$\\boldsymbol{\\sigma}$的介质中，由位于$\\mathbf{r}_0$处强度为$I$的点电流源驱动的电位：\n$$\n\\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla \\phi) = -I \\delta(\\mathbf{r} - \\mathbf{r}_0)\n$$\n格林函数，记为$G(\\mathbf{r}; \\mathbf{r}_0)$，是该方程在单位源($I=1$)位于$\\mathbf{r}_0$时的解。根据无限、均匀介质的平移不变性，我们可以将源设置在原点$\\mathbf{r}_0 = \\mathbf{0}$，并求解$G(\\mathbf{r}) \\equiv G(\\mathbf{r}; \\mathbf{0})$。对于位于任意$\\mathbf{r}_0$的源，其解则为$G(\\mathbf{r} - \\mathbf{r}_0)$。PDE变为：\n$$\n\\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla G) = -\\delta(\\mathbf{r})\n$$\n问题指定了一个对角电导率张量$\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_x, \\sigma_y, \\sigma_z)$，其中$\\sigma_x, \\sigma_y, \\sigma_z$是常数。散度项展开为：\n$$\n\\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla G) = \\frac{\\partial}{\\partial x}\\left(\\sigma_x \\frac{\\partial G}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(\\sigma_y \\frac{\\partial G}{\\partial y}\\right) + \\frac{\\partial}{\\partial z}\\left(\\sigma_z \\frac{\\partial G}{\\partial z}\\right) = \\sigma_x \\frac{\\partial^2 G}{\\partial x^2} + \\sigma_y \\frac{\\partial^2 G}{\\partial y^2} + \\sigma_z \\frac{\\partial^2 G}{\\partial z^2}\n$$\n因此，该PDE是一个缩放的泊松方程：\n$$\n\\sigma_x \\frac{\\partial^2 G}{\\partial x^2} + \\sigma_y \\frac{\\partial^2 G}{\\partial y^2} + \\sigma_z \\frac{\\partial^2 G}{\\partial z^2} = -\\delta(x)\\delta(y)\\delta(z)\n$$\n为了求解此方程，我们引入一个坐标变换，通过缩放空间使电导率变为各向同性。令$\\mathbf{r}' = (x', y', z')$为新坐标，定义如下：\n$$\nx' = \\frac{x}{\\sqrt{\\sigma_x}}, \\quad y' = \\frac{y}{\\sqrt{\\sigma_y}}, \\quad z' = \\frac{z}{\\sqrt{\\sigma_z}}\n$$\n使用链式法则，二阶偏导数变换如下：\n$$\n\\frac{\\partial^2 G}{\\partial x^2} = \\frac{1}{\\sigma_x} \\frac{\\partial^2 G}{\\partial x'^2}, \\quad \\frac{\\partial^2 G}{\\partial y^2} = \\frac{1}{\\sigma_y} \\frac{\\partial^2 G}{\\partial y'^2}, \\quad \\frac{\\partial^2 G}{\\partial z^2} = \\frac{1}{\\sigma_z} \\frac{\\partial^2 G}{\\partial z'^2}\n$$\n将这些代入PDE得到：\n$$\n\\sigma_x \\left(\\frac{1}{\\sigma_x} \\frac{\\partial^2 G}{\\partial x'^2}\\right) + \\sigma_y \\left(\\frac{1}{\\sigma_y} \\frac{\\partial^2 G}{\\partial y'^2}\\right) + \\sigma_z \\left(\\frac{1}{\\sigma_z} \\frac{\\partial^2 G}{\\partial z'^2}\\right) = -\\delta(x)\\delta(y)\\delta(z)\n$$\n这简化为$\\nabla'^2 G = -\\delta(x)\\delta(y)\\delta(z)$，其中$\\nabla'^2$是带撇坐标系中的拉普拉斯算子。我们还必须变换狄拉克δ函数。利用缩放性质$\\delta(ax) = |a|^{-1}\\delta(x)$，我们有：\n$$\n\\delta(\\mathbf{r}) = \\delta(x)\\delta(y)\\delta(z) = \\delta(\\sqrt{\\sigma_x}x')\\delta(\\sqrt{\\sigma_y}y')\\delta(\\sqrt{\\sigma_z}z') = \\frac{1}{\\sqrt{\\sigma_x\\sigma_y\\sigma_z}} \\delta(x')\\delta(y')\\delta(z') = \\frac{1}{\\sqrt{\\det(\\boldsymbol{\\sigma})}} \\delta(\\mathbf{r}')\n$$\n变换后的PDE现在是标准的泊松方程：\n$$\n\\nabla'^2 G(\\mathbf{r}') = -\\frac{1}{\\sqrt{\\det(\\boldsymbol{\\sigma})}} \\delta(\\mathbf{r}')\n$$\n在$\\mathbb{R}^3$中，方程$\\nabla^2 u = -S \\delta(\\mathbf{r})$的著名解是$u(\\mathbf{r}) = \\frac{S}{4\\pi \\|\\mathbf{r}\\|}$。应用此解，我们得到在带撇坐标系中的解：\n$$\nG(\\mathbf{r}') = \\frac{1}{4\\pi \\sqrt{\\det(\\boldsymbol{\\sigma})}} \\frac{1}{\\|\\mathbf{r}'\\|}\n$$\n最后，我们变换回原始坐标$\\mathbf{r} = (x,y,z)$。范数$\\|\\mathbf{r}'\\|$是：\n$$\n\\|\\mathbf{r}'\\| = \\sqrt{x'^2 + y'^2 + z'^2} = \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}\n$$\n将其代回，我们得到源在原点时的各向异性格林函数：\n$$\nG(\\mathbf{r}; \\boldsymbol{\\sigma}) = \\frac{1}{4\\pi \\sqrt{\\sigma_x \\sigma_y \\sigma_z} \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}}\n$$\n该核表示在各向异性介质中，由于位于原点的单位电流源而在位置$\\mathbf{r}$产生的电位。对于位于$\\mathbf{r}_0$的源和位于$\\mathbf{r}_e$的电极，我们只需将$\\mathbf{r}$替换为位移矢量$\\mathbf{r}_e - \\mathbf{r}_0$。\n\n### 第2部分：比率R的推导\n\n问题将各向同性格林函数$G_{\\mathrm{iso}}(\\mathbf{r}; s)$定义为具有标量电导率$s$的介质中的解。这对应于$\\sigma_x = \\sigma_y = \\sigma_z = s$的特殊情况。将此代入我们推导的各向异性格林函数中：\n$$\nG_{\\mathrm{iso}}(\\mathbf{r}; s) = \\frac{1}{4\\pi \\sqrt{s^3} \\sqrt{\\frac{x^2}{s} + \\frac{y^2}{s} + \\frac{z^2}{s}}} = \\frac{1}{4\\pi s^{3/2} \\frac{\\sqrt{x^2+y^2+z^2}}{\\sqrt{s}}} = \\frac{1}{4\\pi s \\|\\mathbf{r}\\|}\n$$\n这是标准结果，为我们的推导提供了一个合理性检查。比率$R$定义为：\n$$\nR = \\frac{G_{\\mathrm{iso}}(\\mathbf{r}; s)}{G(\\mathbf{r}; \\boldsymbol{\\sigma})} = \\frac{\\frac{1}{4\\pi s \\|\\mathbf{r}\\|}}{\\frac{1}{4\\pi \\sqrt{\\sigma_x \\sigma_y \\sigma_z} \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}}}\n$$\n简化此表达式可得到$R$的公式：\n$$\nR = \\frac{\\sqrt{\\sigma_x \\sigma_y \\sigma_z} \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}}{s \\sqrt{x^2+y^2+z^2}}\n$$\n其中$\\mathbf{r} = (x,y,z) = \\mathbf{r}_e - \\mathbf{r}_0$。\n\n### 第3部分：计时偏差Δt的推导\n\n真实的阈值穿越时间$t_{\\mathrm{true}}$是源电流$I(t)$达到阈值$I_{\\mathrm{thr}}$的时刻：\n$$\nI(t_{\\mathrm{true}}) = I_{\\max} \\left(1 - e^{-\\frac{t_{\\mathrm{true}} - t_0}{\\tau}}\\right) = I_{\\mathrm{thr}}\n$$\n解出$t_{\\mathrm{true}}$：\n$$\n1 - e^{-\\frac{t_{\\mathrm{true}} - t_0}{\\tau}} = \\frac{I_{\\mathrm{thr}}}{I_{\\max}} \\implies e^{-\\frac{t_{\\mathrm{true}} - t_0}{\\tau}} = 1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\n$$\n$$\nt_{\\mathrm{true}} = t_0 - \\tau \\ln\\left(1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\\right)\n$$\n估计时间$t_{\\mathrm{est}}$是通过错误地假设介质为各向同性来推断的。在电极处测量的电位为$\\phi(\\mathbf{r}_e, t_{\\mathrm{est}})$，并将此值等同于各向同性模型在电流为$I_{\\mathrm{thr}}$时预测的电位：\n$$\n\\phi(\\mathbf{r}_e, t_{\\mathrm{est}}) = G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s) \\, I_{\\mathrm{thr}}\n$$\n然而，真实的电位由各向异性模型给出：\n$$\n\\phi(\\mathbf{r}_e, t_{\\mathrm{est}}) = G(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma}) \\, I(t_{\\mathrm{est}})\n$$\n将这两个表达式相等，我们可以找到与推断时间对应的源电流$I(t_{\\mathrm{est}})$：\n$$\nG(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma}) \\, I(t_{\\mathrm{est}}) = G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s) \\, I_{\\mathrm{thr}}\n$$\n$$\nI(t_{\\mathrm{est}}) = \\frac{G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s)}{G(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma})} \\, I_{\\mathrm{thr}} = R \\cdot I_{\\mathrm{thr}}\n$$\n我们现在使用这个有效电流阈值来解$t_{\\mathrm{est}}$：\n$$\nI(t_{\\mathrm{est}}) = I_{\\max} \\left(1 - e^{-\\frac{t_{\\mathrm{est}} - t_0}{\\tau}}\\right) = R \\cdot I_{\\mathrm{thr}}\n$$\n按照与$t_{\\mathrm{true}}$相同的步骤，我们发现：\n$$\nt_{\\mathrm{est}} = t_0 - \\tau \\ln\\left(1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}\\right)\n$$\n只要$I_{\\max}  R \\cdot I_{\\mathrm{thr}}$，这个解就是有效的，测试用例满足这个条件。计时偏差$\\Delta t$是$t_{\\mathrm{est}} - t_{\\mathrm{true}}$的差值：\n$$\n\\Delta t = \\left(t_0 - \\tau \\ln\\left(1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}\\right)\\right) - \\left(t_0 - \\tau \\ln\\left(1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\\right)\\right)\n$$\n$$\n\\Delta t = \\tau \\left[\\ln\\left(1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\\right) - \\ln\\left(1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}\\right)\\right]\n$$\n使用对数恒等式$\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到计时偏差的最终闭合形式表达式：\n$$\n\\Delta t = \\tau \\ln\\left( \\frac{1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}}{1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}} \\right) = \\tau \\ln\\left( \\frac{I_{\\max} - I_{\\mathrm{thr}}}{I_{\\max} - R \\cdot I_{\\mathrm{thr}}} \\right)\n$$\n此公式将被实现以解决给定测试套件的问题。结果将从秒转换为毫秒。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the timing bias in threshold detection due to assuming isotropic\n    conductivity in an anisotropic medium.\n    \"\"\"\n    # Test suite (each case specifies (sigma_x, sigma_y, sigma_z), s, r_vec, I_max, I_thr, (t0, tau))\n    # Units: sigma (S/m), s (S/m), r_vec (m), I (A), t (s)\n    test_cases = [\n        # Case 1: baseline isotropy, happy path\n        {\n            \"sigmas\": (0.3, 0.3, 0.3), \"s\": 0.3, \"r_vec\": (50e-6, 0, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 2: anisotropy, electrode along high-conductivity axis\n        {\n            \"sigmas\": (0.6, 0.3, 0.2), \"s\": 0.3, \"r_vec\": (50e-6, 0, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 3: anisotropy, electrode along low-conductivity axis\n        {\n            \"sigmas\": (0.6, 0.3, 0.2), \"s\": 0.3, \"r_vec\": (0, 50e-6, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 4: anisotropy, oblique electrode-source displacement\n        {\n            \"sigmas\": (0.6, 0.3, 0.2), \"s\": 0.3, \"r_vec\": (30e-6, 40e-6, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 5: boundary case: near-saturation threshold\n        {\n            \"sigmas\": (0.4, 0.2, 0.2), \"s\": 0.3, \"r_vec\": (50e-6, 0, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1.9e-9, \"t0\": 0, \"tau\": 0.5e-3\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_x, sigma_y, sigma_z = case[\"sigmas\"]\n        s = case[\"s\"]\n        r_x, r_y, r_z = case[\"r_vec\"]\n        I_max = case[\"I_max\"]\n        I_thr = case[\"I_thr\"]\n        tau = case[\"tau\"]\n\n        # Calculate the ratio R between isotropic and anisotropic Green's functions\n        \n        # Norm of the displacement vector\n        r_norm_sq = r_x**2 + r_y**2 + r_z**2\n        if r_norm_sq == 0:\n            # Handle the singularity case, though not expected in test data\n            # R is undefined, leading to invalid timing bias.\n            # In a real scenario, this would be an error. Here we can use NaN.\n            results.append(np.nan)\n            continue\n            \n        r_norm = np.sqrt(r_norm_sq)\n\n        # Scaled squared norm in anisotropic space\n        r_scaled_norm_sq = (r_x**2 / sigma_x) + (r_y**2 / sigma_y) + (r_z**2 / sigma_z)\n        r_scaled_norm = np.sqrt(r_scaled_norm_sq)\n        \n        # Determinant of the conductivity tensor\n        det_sigma = sigma_x * sigma_y * sigma_z\n        \n        # Ratio R\n        numerator = np.sqrt(det_sigma) * r_scaled_norm\n        denominator = s * r_norm\n        R = numerator / denominator\n\n        # Calculate the timing bias delta_t in seconds\n        # delta_t = tau * log( (I_max - I_thr) / (I_max - R * I_thr) )\n        log_argument_num = I_max - I_thr\n        log_argument_den = I_max - R * I_thr\n        \n        # Check for physical validity (argument of log must be positive)\n        if log_argument_num = 0 or log_argument_den = 0:\n            # Threshold is unreachable\n            delta_t_s = np.inf\n        else:\n            delta_t_s = tau * np.log(log_argument_num / log_argument_den)\n\n        # Convert to milliseconds and append to results\n        delta_t_ms = delta_t_s * 1000.0\n        results.append(delta_t_ms)\n\n    # Format output as a comma-separated list of floating point numbers\n    # Ensure a consistent representation for floating point numbers\n    formatted_results = [f\"{res:.10f}\".rstrip('0').rstrip('.') if res != 0 else \"0.0\" for res in results]\n    \n    # Custom formatting for case 1 to exactly match 0.0\n    if results[0] == 0:\n        formatted_results[0] = \"0.0\"\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}