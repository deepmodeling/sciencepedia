{
    "hands_on_practices": [
        {
            "introduction": "要理解神经元如何产生动作电位，核心在于分析其从静息状态到发放脉冲的转变。本练习将通过一个虽简化但功能强大的数学模型，深入探讨这一转变过程。通过分析该模型的零斜线和不动点，你将学会如何从第一性原理出发，区分不同类型的放电起始模式（即分岔类型），并推导出诱发脉冲所需的最小电流（即基电流）。这项实践旨在揭示神经元发放阈值背后的动力学机制，是理解神经元兴奋性的基础。",
            "id": "3960964",
            "problem": "考虑一个在峰电位发放（spike onset）附近的基于电导的神经元的二维简化模型。在该模型中，快膜电压变量 $V$ 由内向激活电流和外向电流的平衡所产生的三次非线性项近似，而慢恢复变量 $w$ 是 $V$ 的线性函数。令显式漏电导 $g_{L}$ 作为一个线性欧姆项进入快电流平衡方程。简化后的无量纲系统为\n$$\n\\begin{aligned}\n\\frac{dV}{dt} = f(V,w;I,g_{L}) \\equiv (\\alpha-g_{L})\\,V - \\beta V^{3} - w + I,\\\\\n\\frac{dw}{dt} = \\epsilon\\left(\\kappa V + \\lambda - w\\right),\n\\end{aligned}\n$$\n其中参数 $\\alpha0$，$\\beta0$，$\\kappa0$，$\\lambda \\in \\mathbb{R}$，且 $0  \\epsilon\\ll 1$。外部刺激 $I$ 是一个恒定的施加电流。该模型是一个典型的三次快慢系统简化模型，源于电流守恒定律\n$$\nC\\frac{dV}{dt} = -I_{\\text{ion}}(V,w;g_{L}) + I,\n$$\n其中漏电流是 $V$ 的线性函数，斜率为 $g_{L}$，快内向电流被近似为一个 $V$ 的线性项减去一个饱和三次非线性项。$V$-零斜线是三次曲线\n$$\nw = (\\alpha-g_{L})\\,V - \\beta V^{3} + I,\n$$\n而 $w$-零斜线是直线\n$$\nw = \\kappa V + \\lambda.\n$$\n\n回答以下问题：\n\n1) 从这些零斜线和三次曲线的拐点（knee points）作为 $dw/dV = 0$ 的解的定义出发，确定增加 $g_{L}$ 如何在 $(V,w)$-平面上移动 $V$-零斜线及其拐点。用 $(\\alpha-g_{L})$ 和 $\\beta$ 来表述你的结果。\n\n2) 在奇异极限 $\\epsilon\\to 0^{+}$ 下，当 $I$ 从静息状态缓慢增加时，重复性峰电位发放的起始（onset）通过鞍点-不变圆（SNIC）或 Hopf 分岔发生，具体取决于几何形状。仅使用零斜线的几何形状和平衡点的线性化，推导出一个关于 $g_{L}$（相对于其他参数）的条件，该条件在 $I$ 变化时区分这两种起始类型。你的条件必须用三次 $V$-零斜线与 $w$-零斜线在其交点处的相对斜率来表述。\n\n3) 在你确定的导致鞍点-不变圆（SNIC）起始的条件下，基电流（rheobase）（引起重复性峰电位发放的最小恒定电流 $I$）在直线 $w=\\kappa V+\\lambda$ 与三次曲线 $w=(\\alpha-g_{L})V-\\beta V^{3}+I$ 在左拐点（即，在负 $V$ 处）相切时达到。通过施加相切条件，推导基电流 $I_{\\mathrm{rh}}(g_{L})$ 关于 $\\alpha$、$\\beta$、$\\kappa$、$\\lambda$ 和 $g_{L}$ 的闭式表达式。将你的最终答案表示为单个解析表达式。不需要数值四舍五入。明确说明你为拐点所做的任何符号选择。\n\n请从基本电流平衡定律、零斜线和拐点的定义以及线性稳定性准则出发提供你的推理，并避免引用现成的基电流公式。你的最终答案必须是 $I_{\\mathrm{rh}}(g_{L})$ 在无量纲单位下的显式解析表达式，并包含在单个表达式中。",
            "solution": "该问题提出了一个典型的快慢动力学系统，代表了一个简化的基于电导的神经元模型。我们的任务是分析其零斜线的几何特性，并推导不同放电起始类型的条件，最终计算一种特定起始类型的基电流。分析将按要求分三部分进行。\n\n系统由以下方程给出：\n$$\n\\begin{aligned}\n\\frac{dV}{dt} = (\\alpha-g_{L})\\,V - \\beta V^{3} - w + I \\\\\n\\frac{dw}{dt} = \\epsilon\\left(\\kappa V + \\lambda - w\\right)\n\\end{aligned}\n$$\n$V$-零斜线（其中 $\\frac{dV}{dt}=0$）是三次函数 $w(V) = (\\alpha-g_{L})V - \\beta V^3 + I$。$w$-零斜线（其中 $\\frac{dw}{dt}=0$）是直线 $w(V) = \\kappa V + \\lambda$。参数定义为 $\\alpha0$，$\\beta0$，$\\kappa0$，$\\lambda \\in \\mathbb{R}$，且 $0  \\epsilon\\ll 1$。\n\n**第 1 部分：漏电导 $g_{L}$ 对 $V$-零斜线及其拐点的影响**\n\n$V$-零斜线的方程是 $w = (\\alpha-g_{L})V - \\beta V^3 + I$。漏电导 $g_L$ 出现在线性项中。增加 $g_L$ 会减小系数 $(\\alpha-g_{L})$。对于给定的 $I$，这会使三次曲线的形状“变平”。对于 $V  0$，增加 $g_L$ 会减小零斜线上 $w$ 的值。对于 $V  0$，增加 $g_L$ 会增加 $w$ 的值。这构成了一个围绕点 $(0, I)$ 旋转零斜线的剪切变换。\n\n三次 $V$-零斜线的拐点是其局部极值点，由条件 $\\frac{dw}{dV} = 0$ 定义。我们计算关于 $V$ 的导数：\n$$\n\\frac{dw}{dV} = (\\alpha-g_{L}) - 3\\beta V^2\n$$\n将其设为零，得到拐点的 $V$ 坐标：\n$$\n(\\alpha-g_{L}) - 3\\beta V^2 = 0 \\implies V^2 = \\frac{\\alpha-g_{L}}{3\\beta}\n$$\n为了存在两个实数拐点，必须有 $\\alpha-g_{L}  0$。假设此条件成立，则 $V$ 坐标为：\n$$\nV_{\\text{knees}} = \\pm\\sqrt{\\frac{\\alpha-g_{L}}{3\\beta}}\n$$\n随着 $g_L$ 增加，项 $(\\alpha-g_{L})$ 减小。因此，$|V_{\\text{knees}}|$ 的大小减小，这意味着拐点水平地向 $w$ 轴（$V=0$）移动。\n\n为了找到拐点的 $w$ 坐标，我们将 $V_{\\text{knees}}$ 代回零斜线方程：\n$$\nw_{\\text{knees}} = (\\alpha-g_{L})V_{\\text{knees}} - \\beta V_{\\text{knees}}^3 + I = V_{\\text{knees}}\\left((\\alpha-g_{L}) - \\beta V_{\\text{knees}}^2\\right) + I\n$$\n使用关系式 $V_{\\text{knees}}^2 = \\frac{\\alpha-g_{L}}{3\\beta}$，我们代入 $\\beta V_{\\text{knees}}^2$ 项：\n$$\nw_{\\text{knees}} = V_{\\text{knees}}\\left((\\alpha-g_{L}) - \\beta \\frac{\\alpha-g_{L}}{3\\beta}\\right) + I = V_{\\text{knees}}\\left((\\alpha-g_{L}) - \\frac{1}{3}(\\alpha-g_{L})\\right) + I = \\frac{2}{3}(\\alpha-g_{L})V_{\\text{knees}} + I\n$$\n代入 $V_{\\text{knees}}$ 的表达式：\n$$\nw_{\\text{knees}} = \\frac{2}{3}(\\alpha-g_{L})\\left(\\pm\\sqrt{\\frac{\\alpha-g_{L}}{3\\beta}}\\right) + I = \\pm\\frac{2(\\alpha-g_{L})^{3/2}}{3\\sqrt{3\\beta}} + I\n$$\n随着 $g_L$ 增加，$(\\alpha-g_{L})$ 减小，因此项 $\\pm\\frac{2(\\alpha-g_{L})^{3/2}}{3\\sqrt{3\\beta}}}$ 的大小也减小。这意味着拐点的 $w$ 坐标向值 $I$ 移动。\n\n总之，增加漏电导 $g_L$ 会导致 $V$-零斜线的两个拐点相互靠近，在 $(V, w)$-平面上收敛于点 $(0, I)$。\n\n**第 2 部分：区分 SNIC 和 Hopf 分岔起始的条件**\n\n当系统稳定不动点（静息态）随着电流 $I$ 增加而失去稳定性时，重复性峰电位发放开始。分岔的类型取决于雅可比矩阵的特征值如何穿过虚轴。不动点 $(V_*, w_*)$ 是零斜线的交点。在不动点处的雅可比矩阵 $J$ 是：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial\\dot{V}}{\\partial V}  \\frac{\\partial\\dot{V}}{\\partial w} \\\\ \\frac{\\partial\\dot{w}}{\\partial V}  \\frac{\\partial\\dot{w}}{\\partial w} \\end{pmatrix}_{(V_*, w_*)} = \\begin{pmatrix} (\\alpha-g_{L}) - 3\\beta V_*^2  -1 \\\\ \\epsilon\\kappa  -\\epsilon \\end{pmatrix}\n$$\n令 $S_V = (\\alpha-g_{L}) - 3\\beta V_*^2$ 为不动点处 $V$-零斜线的斜率。雅可比矩阵变为 $J = \\begin{pmatrix} S_V  -1 \\\\ \\epsilon\\kappa  -\\epsilon \\end{pmatrix}$。\n迹和行列式分别为：\n$$\n\\text{Tr}(J) = S_V - \\epsilon\n$$\n$$\n\\text{Det}(J) = S_V(-\\epsilon) - (-1)(\\epsilon\\kappa) = \\epsilon(\\kappa - S_V)\n$$\n如果 $\\text{Tr}(J)  0$ 且 $\\text{Det}(J)  0$，则不动点是稳定的。在奇异极限 $\\epsilon\\to 0^+$下，这些条件变为 $S_V  0$ 和 $\\kappa  S_V$。神经元的静息态是一个稳定的不动点，通常处于负电位 $V_*$。$V$-零斜线呈 N 形，稳定的不动点位于斜率 $S_V$ 为负的外部支上。因此，对于静息态，$S_V  0$，并且由于 $\\kappa  0$，稳定性条件得到满足。\n\n随着 $I$ 的增加，$V$-零斜线向上移动，不动点 $(V_*, w_*)$ 也随之移动。当 $\\text{Tr}(J)$ 或 $\\text{Det}(J)$ 变为零时，稳定性丧失。\n当 $\\text{Det}(J)=0$ 时发生鞍点分岔，这意味着 $S_V = \\kappa$。这对应于 $w$-零斜线与 $V$-零斜线相切。\n当 $\\text{Tr}(J)=0$ 且 $\\text{Det}(J)0$ 时发生 Hopf 分岔，这意味着 $S_V = \\epsilon \\approx 0$。\n\n分岔的类型由零斜线的全局几何形状决定。不动点是 $(\\alpha-g_{L})V - \\beta V^3 + I = \\kappa V + \\lambda$ 的解，可以重写为 $\\beta V^3 + (\\kappa - (\\alpha-g_L))V + \\lambda - I = 0$。$V$ 的实根数量决定了不动点的数量。\n这取决于线性项系数 $\\kappa - (\\alpha-g_L)$ 的符号。\n情况 1：$\\kappa  \\alpha-g_L$。函数 $F(V) = \\beta V^3 + (\\kappa - (\\alpha-g_L))V$ 是单调的。对于任何 $I$ 值，总是只有一个不动点。随着 $I$ 增加，这个不动点从稳定的左支（$S_V  0$）移动到不稳定的中支（$S_V0$）。当 $S_V$ 从负变正时，稳定性丧失。分岔点在 $\\text{Tr}(J) = S_V - \\epsilon = 0$ 处，即 $S_V=\\epsilon$。由于在这一点上 $\\text{Det}(J) = \\epsilon(\\kappa - \\epsilon)  0$（因为 $\\kappa  \\alpha-g_L  0$ 且 $\\epsilon \\ll 1$），这是一个 Hopf 分岔。\n\n情况 2：$\\kappa  \\alpha-g_L$。系数 $\\kappa - (\\alpha-g_L)$ 是负的。函数 $F(V)$ 是非单调的，根据 $I$ 的值可能有一个或三个实根。这意味着存在一个 $I$ 的范围，使得系统有三个不动点（一个稳定结点、一个鞍点和一个不稳定结点/焦点）。当 $I$ 从一个低值增加时，初始的稳定静息态（结点）向鞍点移动。在一个临界 $I$ 值，它们合并并消失。这是一个鞍点分岔。由于离开分岔点的轨迹在相空间中经历一次大范围的偏移（一个峰电位），然后返回到鞍点附近，因此这是一个鞍点-不变圆（SNIC）分岔。\n\n因此，区分这两种起始类型的条件是 $w$-零斜线的斜率 $\\kappa$ 与 $V$-零斜线的最大正斜率的比较。$V$-零斜线的斜率为 $S_V(V) = (\\alpha-g_L) - 3\\beta V^2$。其最大值在 $V=0$ 处取得，为 $S_{V, \\text{max}} = \\alpha-g_L$。\n条件是：\n- 如果 $w$-零斜线的斜率小于 $V$-零斜线的最大斜率，则为 **SNIC 起始**：$\\kappa  \\alpha-g_L$。\n- 如果 $w$-零斜线的斜率大于 $V$-零斜线的最大斜率，则为 **Hopf 起始**：$\\kappa  \\alpha-g_L$。\n\n**第 3 部分：SNIC 起始的基电流 $I_{\\mathrm{rh}}(g_{L})$**\n\n我们处于 SNIC 区域，其中 $\\kappa  \\alpha-g_L$。基电流 $I_{\\text{rh}}$ 是使神经元放电的最小电流，它对应于发生鞍点分岔时的 $I$ 值。正如问题中所述并与我们的分析一致，这种情况发生在 $w$-零斜线 $w = \\kappa V + \\lambda$ 与 $V$-零斜线 $w = (\\alpha-g_L)V - \\beta V^3 + I$ 相切时。问题指明相切发生在“左拐点”，我们将其解释为负电压 $V0$ 处的鞍点。\n\n在点 $V=V_{\\text{rh}}$ 处相切的条件是：\n1.  $w$ 的值相等：$\\kappa V_{\\text{rh}} + \\lambda = (\\alpha-g_L)V_{\\text{rh}} - \\beta V_{\\text{rh}}^3 + I_{\\text{rh}}$\n2.  斜率（关于 $V$ 的导数）相等：$\\kappa = (\\alpha-g_L) - 3\\beta V_{\\text{rh}}^2$\n\n从第二个条件，我们求解 $V_{\\text{rh}}$：\n$$\n3\\beta V_{\\text{rh}}^2 = \\alpha-g_L-\\kappa \\implies V_{\\text{rh}}^2 = \\frac{\\alpha-g_L-\\kappa}{3\\beta}\n$$\n分岔不动点在左侧，所以我们取 $V_{\\text{rh}}$ 的负根：\n$$\nV_{\\text{rh}} = -\\sqrt{\\frac{\\alpha-g_L-\\kappa}{3\\beta}}\n$$\n这个选择是一致的，因为实数解要求 $\\alpha-g_L-\\kappa  0$，这正是 SNIC 区域的条件。\n\n现在，我们使用第一个条件来求解 $I_{\\text{rh}}$：\n$$\nI_{\\text{rh}} = (\\kappa - (\\alpha-g_L))V_{\\text{rh}} + \\beta V_{\\text{rh}}^3 + \\lambda\n$$\n我们可以提出因子 $V_{\\text{rh}}$：\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(\\kappa - (\\alpha-g_L) + \\beta V_{\\text{rh}}^2\\right) + \\lambda\n$$\n代入 $\\beta V_{\\text{rh}}^2 = \\frac{1}{3}(\\alpha-g_L-\\kappa)$:\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(\\kappa - (\\alpha-g_L) + \\frac{1}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(-(\\alpha-g_L-\\kappa) + \\frac{1}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n$$\nI_{\\text{rh}} = V_{\\text{rh}}\\left(-\\frac{2}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n现在，代入 $V_{\\text{rh}}$ 的表达式：\n$$\nI_{\\text{rh}} = \\left(-\\sqrt{\\frac{\\alpha-g_L-\\kappa}{3\\beta}}\\right)\\left(-\\frac{2}{3}(\\alpha-g_L-\\kappa)\\right) + \\lambda\n$$\n两个负号相消，得到：\n$$\nI_{\\text{rh}}(g_{L}) = \\frac{2}{3}(\\alpha-g_L-\\kappa) \\sqrt{\\frac{\\alpha-g_L-\\kappa}{3\\beta}} + \\lambda\n$$\n该表达式可以简化为其最终形式：\n$$\nI_{\\text{rh}}(g_{L}) = \\lambda + \\frac{2(\\alpha-g_L-\\kappa)^{3/2}}{3\\sqrt{3\\beta}}\n$$\n这就是在 SNIC 分岔条件下，基电流作为漏电导 $g_L$ 和其他系统参数的函数的闭式表达式。",
            "answer": "$$\n\\boxed{\\lambda + \\frac{2}{3\\sqrt{3\\beta}}(\\alpha - g_{L} - \\kappa)^{3/2}}\n$$"
        },
        {
            "introduction": "在了解了单个脉冲的产生机制之后，下一步是探究突触输入如何触发这一过程。本练习将从抽象的脉冲发生器模型转向更为真实的场景，即树突整合。你将模拟突触输入的位置以及树突的主动生物物理特性如何改变神经元发放的“规则”，从而凸显树突在预测和达到放电阈值中所扮演的复杂计算角色 。这个练习有助于你理解神经元作为一个复杂的输入整合单元，而不仅仅是一个简单的阈值检测器。",
            "id": "3960948",
            "problem": "您的任务是预测当存在与不存在主动树突反向传播时，在树突上某个电紧张位置的突触输入，引起胞体动作电位（AP）所需的最小突触电导的变化。您的程序必须为每个测试用例计算主动情况下的阈值电导与被动情况下的阈值电导之差，单位为纳西门子。\n\n从以下基础和定义开始：\n\n- 线性化稳态被动电缆关系指出，在电紧张距离 $x/\\lambda$ 处注入的微小局部突触电流，其产生的胞体电压响应会按因子 $\\exp(-x/\\lambda)$ 指数衰减。\n- 在小信号近似下，突触电流为 $I_{\\mathrm{syn}} \\approx g_{\\mathrm{syn}} \\left(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}\\right)$，其中 $g_{\\mathrm{syn}}$ 是突触电导，$E_{\\mathrm{syn}}$ 是突触反转电位，$V_{\\mathrm{rest}}$ 是静息膜电位。\n- 胞体产生发放的电压阈值为 $\\Theta_s$，而启动树突棘波的树突局部激活阈值为 $\\Theta_d$。定义 $\\Delta V_{\\mathrm{th}} = \\Theta_s - V_{\\mathrm{rest}}$ 和 $\\Delta V_{d} = \\Theta_d - V_{\\mathrm{rest}}$。\n- 位于电紧张距离 $x/\\lambda$ 处的突触输入所引起的被动胞体电压响应，可以建模为与 $I_{\\mathrm{syn}} R_{\\mathrm{soma}} \\exp(-x/\\lambda)$ 成正比，其中 $R_{\\mathrm{soma}}$ 是胞体输入电阻。\n- 主动反向传播被建模为一个额外的胞体去极化 $S_{\\mathrm{bp}}(x)$，一旦树突位点达到其局部阈值 $\\Theta_d$，该去极化就会被加上。此反向传播贡献随突触的电紧张位置以 $\\exp(-x/\\lambda_{\\mathrm{bp}})$ 的形式衰减，其中 $\\lambda_{\\mathrm{bp}}$ 代表主动反向传播期间的有效空间常数。为明确使用 $x/\\lambda$ 参数化衰减，定义 $\\rho = \\lambda / \\lambda_{\\mathrm{bp}}$，并将反向传播的胞体贡献建模为 $S_{\\mathrm{bp}}(x) = S_0 \\exp(-\\rho \\, x/\\lambda)$，其中 $S_0$ 是在 $x=0$ 处有效启动的棘波所能观察到的反向传播胞体去极化（单位：毫伏）。\n\n您的任务是：\n\n- 从第一性原理出发，推导在被动情况和主动情况下，达到胞体阈值所需的最小突触电导的表达式，并考虑由树突棘波触发可能产生的分段条件。\n- 构建一个算法，对于下面测试套件中的每组参数，计算主动阈值电导与被动阈值电导之差，即 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$，单位为纳西门子，并四舍五入到三位小数。\n\n单位和约定：\n\n- 所有膜电位必须以毫伏（$\\,\\mathrm{mV}$）为单位进行解释。\n- 所有电阻必须以兆欧（$\\,\\mathrm{M\\Omega}$）为单位进行解释，并在内部转换为欧姆（$\\,\\Omega$）。\n- 突触电导必须以西门子（$\\,\\mathrm{S}$）计算，最终报告的值必须以纳西门子（$\\,\\mathrm{nS}$）为单位返回。\n- 指数衰减参数使用电紧张距离 $x/\\lambda$；本问题不使用角度。\n\n您程序的输入在内部固定为以下测试套件。每个测试用例是一个元组\n$\\left(x/\\lambda,\\ \\rho,\\ R_{\\mathrm{soma}},\\ R_{\\mathrm{dend}},\\ V_{\\mathrm{rest}},\\ E_{\\mathrm{syn}},\\ \\Theta_s,\\ \\Theta_d,\\ S_0\\right)$\n单位为 $\\left(\\text{无量纲},\\ \\text{无量纲},\\ \\mathrm{M\\Omega},\\ \\mathrm{M\\Omega},\\ \\mathrm{mV},\\ \\mathrm{mV},\\ \\mathrm{mV},\\ \\mathrm{mV},\\ \\mathrm{mV}\\right)$:\n\n- 情况 $1$: $\\left(0.2,\\ 0.5,\\ 100,\\ 150,\\ -65,\\ 0,\\ -50,\\ -55,\\ 20\\right)$\n- 情况 $2$: $\\left(1.0,\\ 0.5,\\ 100,\\ 150,\\ -65,\\ 0,\\ -50,\\ -55,\\ 20\\right)$\n- 情况 $3$: $\\left(3.0,\\ 0.5,\\ 100,\\ 150,\\ -65,\\ 0,\\ -50,\\ -55,\\ 20\\right)$\n- 情况 $4$: $\\left(0.2,\\ 1.0,\\ 100,\\ 50,\\ -65,\\ 0,\\ -50,\\ -55,\\ 8\\right)$\n- 情况 $5$: $\\left(2.0,\\ 1.5,\\ 100,\\ 200,\\ -65,\\ 0,\\ -50,\\ -55,\\ 2\\right)$\n\n算法要求：\n\n- 对于每种情况，根据物理推导的条件实现被动阈值和主动阈值逻辑，包括胞体在树突位点触发前纯粹通过线性求和达到阈值的可能性，以及一旦触发，反向传播的贡献会减少所需突触电导的可能性。\n- 确保内部单位转换正确：通过乘以 $10^{-3}$ 将 $\\mathrm{mV}$ 转换为 $\\mathrm{V}$，通过乘以 $10^{6}$ 将 $\\mathrm{M\\Omega}$ 转换为 $\\Omega$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含五个测试用例的结果，形式为一个逗号分隔的列表，并用方括号括起来。每个条目应为阈值电导的变化量 $\\Delta g$，单位为 $\\mathrm{nS}$，四舍五入到三位小数。例如：$\\left[\\text{val}_1,\\text{val}_2,\\text{val}_3,\\text{val}_4,\\text{val}_5\\right]$ 必须在一行上以单个 Python 列表字面量的形式精确打印。",
            "solution": "经评估，此问题有效。其科学基础扎根于计算神经科学的原理，问题陈述清晰，信息充分，可得出唯一解，且表述客观。该模型虽经过简化，却是突触整合与树突计算的标准表示方法。\n\n任务是计算在具有主动树突属性的神经元模型和纯被动模型之间，引发胞体动作电位（AP）所需的阈值突触电导之差。该差异表示为 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n\n首先，让我们根据问题陈述定义关键量。为了进行内部计算，所有电位单位为伏特（$\\mathrm{V}$），电阻单位为欧姆（$\\Omega$），这些都是从给定的毫伏（$\\mathrm{mV}$）和兆欧（$\\mathrm{M\\Omega}$）单位转换而来的。\n\n突触电流 $I_{\\mathrm{syn}}$ 由小信号近似给出：\n$$I_{\\mathrm{syn}} = g_{\\mathrm{syn}} (E_{\\mathrm{syn}} - V_{\\mathrm{rest}})$$\n其中 $g_{\\mathrm{syn}}$ 是突触电导，$E_{\\mathrm{syn}}$ 是突触反转电位，$V_{\\mathrm{rest}}$ 是静息膜电位。我们定义突触驱动电位为 $\\Delta V_{\\mathrm{syn}} = E_{\\mathrm{syn}} - V_{\\mathrm{rest}}$。\n\n由于在电紧张距离 $X = x/\\lambda$ 处的突触电流，胞体上的电压变化 $\\Delta V_{\\mathrm{soma}}$ 会按因子 $\\exp(-X)$ 衰减：\n$$\\Delta V_{\\mathrm{soma}} = I_{\\mathrm{syn}} R_{\\mathrm{soma}} \\exp(-X)$$\n其中 $R_{\\mathrm{soma}}$ 是胞体输入电阻。\n\n在突触所在树突位点的局部电压变化 $\\Delta V_{\\mathrm{local}}$，由该位置的局部输入电阻 $R_{\\mathrm{dend}}$ 决定：\n$$\\Delta V_{\\mathrm{local}} = I_{\\mathrm{syn}} R_{\\mathrm{dend}}$$\n\n从静息状态达到胞体和树突阈值所需的电压变化为：\n$$\\Delta V_{\\mathrm{th}} = \\Theta_s - V_{\\mathrm{rest}}$$\n$$\\Delta V_{d} = \\Theta_d - V_{\\mathrm{rest}}$$\n\n**步骤1：推导被动阈值电导 ($g_{\\mathrm{th}}^{\\mathrm{passive}}$)**\n\n在被动情况下，当胞体电位达到阈值 $\\Theta_s$ 时，即 $\\Delta V_{\\mathrm{soma}} = \\Delta V_{\\mathrm{th}}$，会触发胞体AP。我们可以建立等式并求解阈值电导 $g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n$$\\Delta V_{\\mathrm{th}} = I_{\\mathrm{syn}} R_{\\mathrm{soma}} \\exp(-X)$$\n代入 $I_{\\mathrm{syn}}$ 的表达式：\n$$\\Delta V_{\\mathrm{th}} = g_{\\mathrm{th}}^{\\mathrm{passive}} (E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X)$$\n解出 $g_{\\mathrm{th}}^{\\mathrm{passive}}$：\n$$g_{\\mathrm{th}}^{\\mathrm{passive}} = \\frac{\\Delta V_{\\mathrm{th}}}{(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X)}$$\n\n**步骤2：推导主动阈值电导 ($g_{\\mathrm{th}}^{\\mathrm{active}}$)**\n\n主动情况引入了一个条件非线性：如果局部树突电位达到其阈值 $\\Theta_d$，则会向胞体增加一个额外的去极化贡献 $S_{\\mathrm{bp}}(x) = S_0 \\exp(-\\rho X)$。我们必须确定随着 $g_{\\mathrm{syn}}$ 的增加，哪个阈值会先被达到：是局部树突阈值还是胞体阈值。\n\n让我们找出触发树突阈值所需的电导 $g_{\\mathrm{dend}}$。这发生在 $\\Delta V_{\\mathrm{local}} = \\Delta V_{d}$ 时：\n$$\\Delta V_{d} = I_{\\mathrm{syn}} R_{\\mathrm{dend}} = g_{\\mathrm{dend}} (E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{dend}}$$\n解出 $g_{\\mathrm{dend}}$：\n$$g_{\\mathrm{dend}} = \\frac{\\Delta V_{d}}{(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{dend}}}$$\n\n现在我们比较 $g_{\\mathrm{dend}}$ 和 $g_{\\mathrm{th}}^{\\mathrm{passive}}$ 来确定事件发生的顺序。\n\n**情况A：胞体阈值先达到 ($g_{\\mathrm{th}}^{\\mathrm{passive}} \\le g_{\\mathrm{dend}}$)**\n如果被动触发胞体所需的电导小于或等于触发树突棘波所需的电导，则胞体AP将在树突非线性机制启动前发生。在这种情况下，主动机制是无关的。阈值电导与被动情况相同。\n$$g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{th}}^{\\mathrm{passive}}$$\n\n**情况B：树突阈值先达到 ($g_{\\mathrm{th}}^{\\mathrm{passive}}  g_{\\mathrm{dend}}$)**\n如果树突位点首先达到其阈值，就会产生反向传播电位 $S_{\\mathrm{bp}}(x)$。我们接着必须检查这个额外的去极化是否足以将胞体推过其阈值 $\\Theta_s$。\n\n在树突棘波被触发的瞬间（即 $g_{\\mathrm{syn}} = g_{\\mathrm{dend}}$ 时），总的胞体去极化是突触被动贡献和反向传播电位之和：\n$$\\Delta V_{\\mathrm{soma, total}} = \\Delta V_{\\mathrm{soma}}(g_{\\mathrm{dend}}) + S_{\\mathrm{bp}}(x)$$\n此时的突触电流为 $I_{\\mathrm{syn}} = g_{\\mathrm{dend}}(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) = \\Delta V_d / R_{\\mathrm{dend}}$。\n因此，胞体电压的被动分量为 $\\Delta V_{\\mathrm{soma}}(g_{\\mathrm{dend}}) = (\\Delta V_d / R_{\\mathrm{dend}}) R_{\\mathrm{soma}} \\exp(-X)$。\n总的胞体电压变化为：\n$$\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}} = \\frac{\\Delta V_d R_{\\mathrm{soma}}}{R_{\\mathrm{dend}}} \\exp(-X) + S_0 \\exp(-\\rho X)$$\n\n由此产生两种子情况：\n\n**B1：树突棘波足以触发胞体AP ($\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}} \\ge \\Delta V_{\\mathrm{th}}$)**\n如果在树突棘波发生瞬间，总的胞体去极化足以达到胞体阈值，那么所需的最小电导就是触发树突棘波所需的电导。\n$$g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{dend}}$$\n\n**B2：树突棘波不足以触发胞体AP ($\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}}  \\Delta V_{\\mathrm{th}}$)**\n如果胞体阈值尚未达到，我们需要进一步增加突触电导 $g_{\\mathrm{syn}}$。对于任何电导 $g_{\\mathrm{syn}} \\ge g_{\\mathrm{dend}}$，总的胞体电压由 $\\Delta V_{\\mathrm{soma}}(g_{\\mathrm{syn}}) + S_{\\mathrm{bp}}(x)$ 给出。我们需要找到满足以下条件的 $g_{\\mathrm{syn}}$ 值（我们称之为 $g_{\\mathrm{th}}^{\\mathrm{active}}$）：\n$$g_{\\mathrm{th}}^{\\mathrm{active}}(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X) + S_0 \\exp(-\\rho X) = \\Delta V_{\\mathrm{th}}$$\n解出 $g_{\\mathrm{th}}^{\\mathrm{active}}$：\n$$g_{\\mathrm{th}}^{\\mathrm{active}} = \\frac{\\Delta V_{\\mathrm{th}} - S_0 \\exp(-\\rho X)}{(E_{\\mathrm{syn}} - V_{\\mathrm{rest}}) R_{\\mathrm{soma}} \\exp(-X)}$$\n\n**步骤3：算法总结与计算**\n\n对于每个测试用例，遵循上述推导的逻辑计算最终值 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$。所有以 $\\mathrm{mV}$ 和 $\\mathrm{M\\Omega}$ 为单位的输入参数在使用公式前都将转换为 $\\mathrm{V}$ 和 $\\Omega$。得到的电导单位为西门子（$\\mathrm{S}$），用于计算 $\\Delta g$，最后通过乘以 $10^9$ 将其转换为纳西门子（$\\mathrm{nS}$）并四舍五入到三位小数。\n\n整体算法如下：\n1.  将所有输入参数转换为国际标准单位（$\\mathrm{V}$，$\\Omega$）。\n2.  计算 $g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n3.  计算 $g_{\\mathrm{dend}}$。\n4.  如果 $g_{\\mathrm{th}}^{\\mathrm{passive}} \\le g_{\\mathrm{dend}}$，则设置 $g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n5.  如果 $g_{\\mathrm{th}}^{\\mathrm{passive}}  g_{\\mathrm{dend}}$：\n    a. 计算 $\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}}$。\n    b. 如果 $\\Delta V_{\\mathrm{soma, at\\_dend\\_spike}} \\ge \\Delta V_{\\mathrm{th}}$，则设置 $g_{\\mathrm{th}}^{\\mathrm{active}} = g_{\\mathrm{dend}}$。\n    c. 否则，使用子情况B2的公式计算 $g_{\\mathrm{th}}^{\\mathrm{active}}$。\n6.  计算 $\\Delta g = g_{\\mathrm{th}}^{\\mathrm{active}} - g_{\\mathrm{th}}^{\\mathrm{passive}}$。\n7.  将 $\\Delta g$ 从 $\\mathrm{S}$ 转换为 $\\mathrm{nS}$ 并四舍五入。\n\n对每个给定的测试用例实施此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in threshold synaptic conductance due to active dendritic backpropagation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (x/lambda, rho, R_soma_Mohm, R_dend_Mohm, V_rest_mV, E_syn_mV, Theta_s_mV, Theta_d_mV, S0_mV)\n    test_cases = [\n        (0.2, 0.5, 100, 150, -65, 0, -50, -55, 20),\n        (1.0, 0.5, 100, 150, -65, 0, -50, -55, 20),\n        (3.0, 0.5, 100, 150, -65, 0, -50, -55, 20),\n        (0.2, 1.0, 100, 50, -65, 0, -50, -55, 8),\n        (2.0, 1.5, 100, 200, -65, 0, -50, -55, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        x_lambda, rho, R_soma_Mohm, R_dend_Mohm, V_rest_mV, E_syn_mV, Theta_s_mV, Theta_d_mV, S0_mV = case\n\n        # --- Unit Conversion to base SI units (V, Ohm) ---\n        R_soma = R_soma_Mohm * 1e6\n        R_dend = R_dend_Mohm * 1e6\n        V_rest = V_rest_mV * 1e-3\n        E_syn = E_syn_mV * 1e-3\n        Theta_s = Theta_s_mV * 1e-3\n        Theta_d = Theta_d_mV * 1e-3\n        S0 = S0_mV * 1e-3\n\n        # --- Derived quantities ---\n        delta_V_th = Theta_s - V_rest   # Somatic threshold voltage change\n        delta_V_d = Theta_d - V_rest    # Dendritic threshold voltage change\n        delta_V_syn = E_syn - V_rest      # Synaptic driving potential\n\n        # --- Step 1: Calculate Passive Threshold Conductance ---\n        # The conductance at the synapse needed to reach somatic threshold in a passive dendrite.\n        # Check for division by zero, though not expected with given data.\n        denominator_passive = delta_V_syn * R_soma * np.exp(-x_lambda)\n        if denominator_passive == 0:\n            # Handle case of infinite conductance if necessary\n            g_th_passive = float('inf')\n        else:\n            g_th_passive = delta_V_th / denominator_passive\n\n        # --- Step 2: Calculate Active Threshold Conductance ---\n        \n        # Conductance required to trigger the local dendritic spike\n        denominator_dend = delta_V_syn * R_dend\n        if denominator_dend == 0:\n            g_dend = float('inf')\n        else:\n            g_dend = delta_V_d / denominator_dend\n\n        g_th_active = 0.0\n\n        # Compare passive somatic threshold with dendritic threshold to determine which fires first\n        if g_th_passive = g_dend:\n            # Case A: Somatic AP is triggered before or at the same time as the dendritic spike.\n            # Active mechanism is not engaged or is irrelevant.\n            g_th_active = g_th_passive\n        else:\n            # Case B: Dendritic spike is triggered first.\n            V_soma_at_dend_spike = (delta_V_d * R_soma / R_dend) * np.exp(-x_lambda) + S0 * np.exp(-rho * x_lambda)\n            \n            if V_soma_at_dend_spike >= delta_V_th:\n                # Case B1: The dendritic spike provides enough depolarization to trigger a somatic AP immediately.\n                # The threshold conductance is just that needed for the dendritic spike.\n                g_th_active = g_dend\n            else:\n                # Case B2: More conductance is needed after the dendritic spike.\n                # The total voltage is the sum of passive attenuation and the now-active backpropagation contribution.\n                numerator = delta_V_th - S0 * np.exp(-rho * x_lambda)\n                denominator = delta_V_syn * R_soma * np.exp(-x_lambda)\n                if denominator == 0:\n                    g_th_active = float('inf')\n                else:\n                    g_th_active = numerator / denominator\n\n        # --- Step 3: Calculate the difference and format the output ---\n        delta_g_S = g_th_active - g_th_passive  # Difference in Siemens\n        delta_g_nS = delta_g_S * 1e9         # Convert to nanoSiemens\n        \n        results.append(round(delta_g_nS, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的实践练习将理论与实验现实联系起来，探讨我们如何测量神经活动。本练习深入研究了细胞外记录的物理学原理，展示了脑组织的导电特性如何影响我们测量的电位。通过为各向异性介质推导格林函数，你将能够量化当组织特性被过度简化时，在估计脉冲时间上可能产生的显著误差 。对于任何希望准确解释真实神经生理学数据的人来说，这是一个至关重要的教训。",
            "id": "3960982",
            "problem": "您需要对由单一神经元电流源在均匀、无限、具有各向异性电导率的欧姆介质中产生的细胞外电位进行建模。在准静态近似下，电位场满足一个由点源驱动的散度形式方程。您的任务是推导、实现并使用正向模型格林函数（适用于各向异性电导率），以量化在错误地假设介质为各向同性时，推断阈值时间所产生的计时偏差。\n\n请从以下基本原理和定义出发，不得引用任何预先推导出的各向异性格林函数目标表达式。您使用的任何特定表达式都必须基于这些基本原理推导得出。\n\n- 欧姆传导：电流密度为 $ \\mathbf{J} = \\boldsymbol{\\sigma} \\mathbf{E} $，其中 $ \\boldsymbol{\\sigma} $ 是一个常数、对称、正定的电导率张量，$ \\mathbf{E} = -\\nabla \\phi $ 是由电位 $ \\phi $ 产生的电场。\n- 电荷守恒和准静态近似意味着其控制偏微分方程 (PDE) 为 $ \\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla \\phi) = -I \\delta(\\mathbf{r} - \\mathbf{r}_0) $，其中 $ I $ 是注入电流，$ \\delta(\\cdot) $ 是狄拉克δ分布，$ \\mathbf{r}_0 $ 是源的位置。\n- 在具有标量电导率 $ s $ 的各向同性介质中，位于 $ \\mathbb{R}^3 $ 中 $ \\mathbf{r}_0 $ 处的点源的各向同性格林函数形式为 $ \\phi(\\mathbf{r}) \\propto \\frac{1}{s \\|\\mathbf{r} - \\mathbf{r}_0\\|} $。\n\n假设神经元跨膜电流的时间进程已知，并且在关注的时间区间内单调递增，其模型为一个饱和指数函数\n$$\nI(t) = I_{\\max} \\left(1 - e^{-\\frac{t - t_0}{\\tau}}\\right), \\quad t \\ge t_0,\n$$\n其中 $ I_{\\max}  0 $ 是渐近峰值电流，$ t_0 $ 是起始时间，$ \\tau  0 $ 是上升时间常数。在固定电极位置 $ \\mathbf{r}_e $ 处的细胞外电位通过线性叠加与源电流相关联：\n$$\n\\phi(\\mathbf{r}_e, t) = G(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma}) \\, I(t),\n$$\n其中 $ G(\\cdot; \\boldsymbol{\\sigma}) $ 是在电极-源位移矢量 $ \\mathbf{r}_e - \\mathbf{r}_0 $ 处求值的正向模型格林函数核。\n\n您的目标是：\n\n1. 对于具有对角电导率张量 $ \\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_x, \\sigma_y, \\sigma_z) $ 的均匀、无限介质，推导其闭式各向异性格林函数 $ G(\\mathbf{r}; \\boldsymbol{\\sigma}) $。\n2. 给定一个标量各向同性电导率假设 $ s $，推导在相同位移 $ \\mathbf{r} $ 处，各向同性与各向异性正向模型核之间的比率 $ R $，其定义为\n$$\nR = \\frac{G_{\\mathrm{iso}}(\\mathbf{r}; s)}{G(\\mathbf{r}; \\boldsymbol{\\sigma})},\n$$\n其中 $ G_{\\mathrm{iso}}(\\mathbf{r}; s) $ 是电导率为 $ s $ 时的各向同性核。\n3. 将各向同性假设下推断的阈值时间定义为方程\n$$\n\\phi(\\mathbf{r}_e, t_{\\mathrm{est}}) = G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s) \\, I_{\\mathrm{thr}},\n$$\n的解 $ t_{\\mathrm{est}} $，其中 $ I_{\\mathrm{thr}} $ 是一个固定的膜电流阈值。真实的阈值时间 $ t_{\\mathrm{true}} $ 满足\n$$\nI(t_{\\mathrm{true}}) = I_{\\mathrm{thr}}.\n$$\n利用推导出的表达式和给定的 $ I(t) $，获得计时偏差\n$$\n\\Delta t = t_{\\mathrm{est}} - t_{\\mathrm{true}}.\n$$\n的闭式公式。\n\n然后，实现一个完整的、可运行的程序，为以下测试套件计算 $ \\Delta t $。所有时间均以毫秒为单位，表示为实值浮点数。\n\n测试套件（每个案例指定了 $ (\\sigma_x, \\sigma_y, \\sigma_z) $（单位：西门子/米），$ s $（单位：西门子/米），$ \\mathbf{r}_e - \\mathbf{r}_0 $（单位：米），$ I_{\\max} $ 和 $ I_{\\mathrm{thr}} $（单位：安培），以及 $ (t_0, \\tau) $（单位：秒））：\n\n- 案例 1（基线各向同性，理想路径）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.3, 0.3, 0.3) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (50 \\times 10^{-6}, 0, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 案例 2（各向异性，电极沿高电导率轴）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.6, 0.3, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (50 \\times 10^{-6}, 0, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 案例 3（各向异性，电极沿低电导率轴）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.6, 0.3, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (0, 50 \\times 10^{-6}, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 案例 4（各向异性，斜向电极-源位移）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.6, 0.3, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (30 \\times 10^{-6}, 40 \\times 10^{-6}, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.4 \\times 10^{-3} $\n- 案例 5（边界情况：近饱和阈值）：\n  - $ (\\sigma_x, \\sigma_y, \\sigma_z) = (0.4, 0.2, 0.2) $\n  - $ s = 0.3 $\n  - $ \\mathbf{r}_e - \\mathbf{r}_0 = (50 \\times 10^{-6}, 0, 0) $\n  - $ I_{\\max} = 2 \\times 10^{-9} $, $ I_{\\mathrm{thr}} = 1.9 \\times 10^{-9} $\n  - $ t_0 = 0 $, $ \\tau = 0.5 \\times 10^{-3} $\n\n您的程序应生成单行输出，其中包含五个案例的计时偏差（以毫秒为单位），形式为方括号括起来的逗号分隔列表（例如，$ [\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4, \\Delta t_5] $）。程序必须完全按照上述定义计算 $ \\Delta t $，并且必须能直接运行，无需外部输入。通过使用推导出的 $ G(\\mathbf{r}; \\boldsymbol{\\sigma}) $ 和 $ G_{\\mathrm{iso}}(\\mathbf{r}; s) $ 公式，并仅处理物理上有效的配置（例如，不要在格林函数发散的 $ \\mathbf{r}_e = \\mathbf{r}_0 $ 处进行计算），来确保科学真实性。由于未使用任何角度量，因此不需要角度单位。时间必须以毫秒为单位报告。",
            "solution": "该问题是有效的，因为它具有科学依据、适定、客观，并包含获得唯一解所需的所有信息。其基础的静电学和微积分原理是标准的，并且陈述正确。我们将首先推导必要的解析表达式，然后针对给定的测试案例进行数值实现。\n\n### 第1部分：各向异性格林函数的推导\n\n我们从电位 $\\phi$ 在具有各向异性电导率 $\\boldsymbol{\\sigma}$ 的介质中，由位于 $\\mathbf{r}_0$ 处强度为 $I$ 的点电流源驱动的控制偏微分方程 (PDE) 开始：\n$$\n\\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla \\phi) = -I \\delta(\\mathbf{r} - \\mathbf{r}_0)\n$$\n格林函数，记为 $G(\\mathbf{r}; \\mathbf{r}_0)$，是该方程在 $\\mathbf{r}_0$ 处单位源 ($I=1$) 情况下的解。根据无限、均匀介质的平移不变性，我们可以将源设置在原点 $\\mathbf{r}_0 = \\mathbf{0}$，并求解 $G(\\mathbf{r}) \\equiv G(\\mathbf{r}; \\mathbf{0})$。对于位于任意 $\\mathbf{r}_0$ 的源，其解则为 $G(\\mathbf{r} - \\mathbf{r}_0)$。PDE 变为：\n$$\n\\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla G) = -\\delta(\\mathbf{r})\n$$\n问题指定了一个对角电导率张量 $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_x, \\sigma_y, \\sigma_z)$，其中 $\\sigma_x, \\sigma_y, \\sigma_z$ 是常数。散度项展开为：\n$$\n\\nabla \\cdot (\\boldsymbol{\\sigma} \\nabla G) = \\frac{\\partial}{\\partial x}\\left(\\sigma_x \\frac{\\partial G}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(\\sigma_y \\frac{\\partial G}{\\partial y}\\right) + \\frac{\\partial}{\\partial z}\\left(\\sigma_z \\frac{\\partial G}{\\partial z}\\right) = \\sigma_x \\frac{\\partial^2 G}{\\partial x^2} + \\sigma_y \\frac{\\partial^2 G}{\\partial y^2} + \\sigma_z \\frac{\\partial^2 G}{\\partial z^2}\n$$\n因此，PDE 是一个缩放的泊松方程：\n$$\n\\sigma_x \\frac{\\partial^2 G}{\\partial x^2} + \\sigma_y \\frac{\\partial^2 G}{\\partial y^2} + \\sigma_z \\frac{\\partial^2 G}{\\partial z^2} = -\\delta(x)\\delta(y)\\delta(z)\n$$\n为了求解此方程，我们引入一个坐标变换，对空间进行重新缩放，以使电导率变为各向同性。令 $\\mathbf{r}' = (x', y', z')$ 为新坐标，定义如下：\n$$\nx' = \\frac{x}{\\sqrt{\\sigma_x}}, \\quad y' = \\frac{y}{\\sqrt{\\sigma_y}}, \\quad z' = \\frac{z}{\\sqrt{\\sigma_z}}\n$$\n使用链式法则，二阶偏导数变换如下：\n$$\n\\frac{\\partial^2 G}{\\partial x^2} = \\frac{1}{\\sigma_x} \\frac{\\partial^2 G}{\\partial x'^2}, \\quad \\frac{\\partial^2 G}{\\partial y^2} = \\frac{1}{\\sigma_y} \\frac{\\partial^2 G}{\\partial y'^2}, \\quad \\frac{\\partial^2 G}{\\partial z^2} = \\frac{1}{\\sigma_z} \\frac{\\partial^2 G}{\\partial z'^2}\n$$\n将这些代入 PDE 中：\n$$\n\\sigma_x \\left(\\frac{1}{\\sigma_x} \\frac{\\partial^2 G}{\\partial x'^2}\\right) + \\sigma_y \\left(\\frac{1}{\\sigma_y} \\frac{\\partial^2 G}{\\partial y'^2}\\right) + \\sigma_z \\left(\\frac{1}{\\sigma_z} \\frac{\\partial^2 G}{\\partial z'^2}\\right) = -\\delta(x)\\delta(y)\\delta(z)\n$$\n这简化为 $\\nabla'^2 G = -\\delta(x)\\delta(y)\\delta(z)$，其中 $\\nabla'^2$ 是在撇号坐标系中的拉普拉斯算子。我们还必须变换狄拉克δ函数。使用缩放性质 $\\delta(ax) = |a|^{-1}\\delta(x)$，我们有：\n$$\n\\delta(\\mathbf{r}) = \\delta(x)\\delta(y)\\delta(z) = \\delta(\\sqrt{\\sigma_x}x')\\delta(\\sqrt{\\sigma_y}y')\\delta(\\sqrt{\\sigma_z}z') = \\frac{1}{\\sqrt{\\sigma_x\\sigma_y\\sigma_z}} \\delta(x')\\delta(y')\\delta(z') = \\frac{1}{\\sqrt{\\det(\\boldsymbol{\\sigma})}} \\delta(\\mathbf{r}')\n$$\n变换后的 PDE 现在是标准的泊松方程：\n$$\n\\nabla'^2 G(\\mathbf{r}') = -\\frac{1}{\\sqrt{\\det(\\boldsymbol{\\sigma})}} \\delta(\\mathbf{r}')\n$$\n在 $\\mathbb{R}^3$ 中，方程 $\\nabla^2 u = -S \\delta(\\mathbf{r})$ 的著名解是 $u(\\mathbf{r}) = \\frac{S}{4\\pi \\|\\mathbf{r}\\|}$。应用这个结论，我们得到在撇号坐标系中的解：\n$$\nG(\\mathbf{r}') = \\frac{1}{4\\pi \\sqrt{\\det(\\boldsymbol{\\sigma})}} \\frac{1}{\\|\\mathbf{r}'\\|}\n$$\n最后，我们变换回原始坐标 $\\mathbf{r} = (x,y,z)$。范数 $\\|\\mathbf{r}'\\|$ 为：\n$$\n\\|\\mathbf{r}'\\| = \\sqrt{x'^2 + y'^2 + z'^2} = \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}\n$$\n将此代回，我们得到原点处源的各向异性格林函数：\n$$\nG(\\mathbf{r}; \\boldsymbol{\\sigma}) = \\frac{1}{4\\pi \\sqrt{\\sigma_x \\sigma_y \\sigma_z} \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}}\n$$\n该核表示在各向异性介质中，由位于原点的单位电流源在位置 $\\mathbf{r}$ 处产生的电位。对于位于 $\\mathbf{r}_0$ 的源和位于 $\\mathbf{r}_e$ 的电极，我们只需将 $\\mathbf{r}$ 替换为位移矢量 $\\mathbf{r}_e - \\mathbf{r}_0$。\n\n### 第2部分：比率 $R$ 的推导\n\n问题将各向同性格林函数 $G_{\\mathrm{iso}}(\\mathbf{r}; s)$ 定义为在具有标量电导率 $s$ 的介质中的解。这对应于 $\\sigma_x = \\sigma_y = \\sigma_z = s$ 的特殊情况。将此代入我们推导的各向异性格林函数：\n$$\nG_{\\mathrm{iso}}(\\mathbf{r}; s) = \\frac{1}{4\\pi \\sqrt{s^3} \\sqrt{\\frac{x^2}{s} + \\frac{y^2}{s} + \\frac{z^2}{s}}} = \\frac{1}{4\\pi s^{3/2} \\frac{\\sqrt{x^2+y^2+z^2}}{\\sqrt{s}}} = \\frac{1}{4\\pi s \\|\\mathbf{r}\\|}\n$$\n这是标准结果，为我们的推导提供了合理性检查。比率 $R$ 定义为：\n$$\nR = \\frac{G_{\\mathrm{iso}}(\\mathbf{r}; s)}{G(\\mathbf{r}; \\boldsymbol{\\sigma})} = \\frac{\\frac{1}{4\\pi s \\|\\mathbf{r}\\|}}{\\frac{1}{4\\pi \\sqrt{\\sigma_x \\sigma_y \\sigma_z} \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}}}\n$$\n简化此表达式可得到 $R$ 的公式：\n$$\nR = \\frac{\\sqrt{\\sigma_x \\sigma_y \\sigma_z} \\sqrt{\\frac{x^2}{\\sigma_x} + \\frac{y^2}{\\sigma_y} + \\frac{z^2}{\\sigma_z}}}{s \\sqrt{x^2+y^2+z^2}}\n$$\n其中 $\\mathbf{r} = (x,y,z) = \\mathbf{r}_e - \\mathbf{r}_0$。\n\n### 第3部分：计时偏差 $\\Delta t$ 的推导\n\n真实阈值穿越时间 $t_{\\mathrm{true}}$ 是源电流 $I(t)$ 达到阈值 $I_{\\mathrm{thr}}$ 的时刻：\n$$\nI(t_{\\mathrm{true}}) = I_{\\max} \\left(1 - e^{-\\frac{t_{\\mathrm{true}} - t_0}{\\tau}}\\right) = I_{\\mathrm{thr}}\n$$\n求解 $t_{\\mathrm{true}}$：\n$$\n1 - e^{-\\frac{t_{\\mathrm{true}} - t_0}{\\tau}} = \\frac{I_{\\mathrm{thr}}}{I_{\\max}} \\implies e^{-\\frac{t_{\\mathrm{true}} - t_0}{\\tau}} = 1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\n$$\n$$\nt_{\\mathrm{true}} = t_0 - \\tau \\ln\\left(1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\\right)\n$$\n估计时间 $t_{\\mathrm{est}}$ 是通过错误地假设介质为各向同性来推断的。在电极处测量电位 $\\phi(\\mathbf{r}_e, t_{\\mathrm{est}})$，并将此值等同于电流为 $I_{\\mathrm{thr}}$ 时各向同性模型预测的电位：\n$$\n\\phi(\\mathbf{r}_e, t_{\\mathrm{est}}) = G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s) \\, I_{\\mathrm{thr}}\n$$\n然而，真实的电位由各向异性模型给出：\n$$\n\\phi(\\mathbf{r}_e, t_{\\mathrm{est}}) = G(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma}) \\, I(t_{\\mathrm{est}})\n$$\n将这两个表达式相等，我们可以找到与推断时间相对应的源电流 $I(t_{\\mathrm{est}})$：\n$$\nG(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma}) \\, I(t_{\\mathrm{est}}) = G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s) \\, I_{\\mathrm{thr}}\n$$\n$$\nI(t_{\\mathrm{est}}) = \\frac{G_{\\mathrm{iso}}(\\mathbf{r}_e - \\mathbf{r}_0; s)}{G(\\mathbf{r}_e - \\mathbf{r}_0; \\boldsymbol{\\sigma})} \\, I_{\\mathrm{thr}} = R \\cdot I_{\\mathrm{thr}}\n$$\n我们现在使用这个有效的电流阈值来求解 $t_{\\mathrm{est}}$：\n$$\nI(t_{\\mathrm{est}}) = I_{\\max} \\left(1 - e^{-\\frac{t_{\\mathrm{est}} - t_0}{\\tau}}\\right) = R \\cdot I_{\\mathrm{thr}}\n$$\n按照与求解 $t_{\\mathrm{true}}$ 相同的步骤，我们发现：\n$$\nt_{\\mathrm{est}} = t_0 - \\tau \\ln\\left(1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}\\right)\n$$\n该解在 $I_{\\max}  R \\cdot I_{\\mathrm{thr}}$ 的条件下有效，测试案例满足此条件。计时偏差 $\\Delta t$ 是 $t_{\\mathrm{est}} - t_{\\mathrm{true}}$ 的差值：\n$$\n\\Delta t = \\left(t_0 - \\tau \\ln\\left(1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}\\right)\\right) - \\left(t_0 - \\tau \\ln\\left(1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\\right)\\right)\n$$\n$$\n\\Delta t = \\tau \\left[\\ln\\left(1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}\\right) - \\ln\\left(1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}\\right)\\right]\n$$\n使用对数恒等式 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到计时偏差的最终闭式表达式：\n$$\n\\Delta t = \\tau \\ln\\left( \\frac{1 - \\frac{I_{\\mathrm{thr}}}{I_{\\max}}}{1 - \\frac{R \\cdot I_{\\mathrm{thr}}}{I_{\\max}}} \\right) = \\tau \\ln\\left( \\frac{I_{\\max} - I_{\\mathrm{thr}}}{I_{\\max} - R \\cdot I_{\\mathrm{thr}}} \\right)\n$$\n我们将实现此公式来解决给定测试套件的问题。结果将从秒转换为毫秒。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the timing bias in threshold detection due to assuming isotropic\n    conductivity in an anisotropic medium.\n    \"\"\"\n    # Test suite (each case specifies (sigma_x, sigma_y, sigma_z), s, r_vec, I_max, I_thr, (t0, tau))\n    # Units: sigma (S/m), s (S/m), r_vec (m), I (A), t (s)\n    test_cases = [\n        # Case 1: baseline isotropy, happy path\n        {\n            \"sigmas\": (0.3, 0.3, 0.3), \"s\": 0.3, \"r_vec\": (50e-6, 0, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 2: anisotropy, electrode along high-conductivity axis\n        {\n            \"sigmas\": (0.6, 0.3, 0.2), \"s\": 0.3, \"r_vec\": (50e-6, 0, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 3: anisotropy, electrode along low-conductivity axis\n        {\n            \"sigmas\": (0.6, 0.3, 0.2), \"s\": 0.3, \"r_vec\": (0, 50e-6, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 4: anisotropy, oblique electrode-source displacement\n        {\n            \"sigmas\": (0.6, 0.3, 0.2), \"s\": 0.3, \"r_vec\": (30e-6, 40e-6, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1e-9, \"t0\": 0, \"tau\": 0.4e-3\n        },\n        # Case 5: boundary case: near-saturation threshold\n        {\n            \"sigmas\": (0.4, 0.2, 0.2), \"s\": 0.3, \"r_vec\": (50e-6, 0, 0),\n            \"I_max\": 2e-9, \"I_thr\": 1.9e-9, \"t0\": 0, \"tau\": 0.5e-3\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_x, sigma_y, sigma_z = case[\"sigmas\"]\n        s = case[\"s\"]\n        r_x, r_y, r_z = case[\"r_vec\"]\n        I_max = case[\"I_max\"]\n        I_thr = case[\"I_thr\"]\n        tau = case[\"tau\"]\n\n        # Calculate the ratio R between isotropic and anisotropic Green's functions\n        \n        # Norm of the displacement vector\n        r_norm_sq = r_x**2 + r_y**2 + r_z**2\n        if r_norm_sq == 0:\n            # Handle the singularity case, though not expected in test data\n            # R is undefined, leading to invalid timing bias.\n            # In a real scenario, this would be an error. Here we can use NaN.\n            results.append(np.nan)\n            continue\n            \n        r_norm = np.sqrt(r_norm_sq)\n\n        # Scaled squared norm in anisotropic space\n        r_scaled_norm_sq = (r_x**2 / sigma_x) + (r_y**2 / sigma_y) + (r_z**2 / sigma_z)\n        r_scaled_norm = np.sqrt(r_scaled_norm_sq)\n        \n        # Determinant of the conductivity tensor\n        det_sigma = sigma_x * sigma_y * sigma_z\n        \n        # Ratio R\n        numerator = np.sqrt(det_sigma) * r_scaled_norm\n        denominator = s * r_norm\n        R = numerator / denominator\n\n        # Calculate the timing bias delta_t in seconds\n        # delta_t = tau * log( (I_max - I_thr) / (I_max - R * I_thr) )\n        log_argument_num = I_max - I_thr\n        log_argument_den = I_max - R * I_thr\n        \n        # Check for physical validity (argument of log must be positive)\n        if log_argument_num = 0 or log_argument_den = 0:\n            # Threshold is unreachable\n            delta_t_s = np.inf\n        else:\n            delta_t_s = tau * np.log(log_argument_num / log_argument_den)\n\n        # Convert to milliseconds and append to results\n        delta_t_ms = delta_t_s * 1000.0\n        results.append(delta_t_ms)\n\n    # Format output as a comma-separated list of floating point numbers\n    # Ensure a consistent representation for floating point numbers\n    formatted_results = [f\"{res:.10f}\".rstrip('0').rstrip('.') if res != 0 else \"0.0\" for res in results]\n    \n    # Custom formatting for case 1 to exactly match 0.0\n    if results[0] == 0:\n        formatted_results[0] = \"0.0\"\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}