{
    "hands_on_practices": [
        {
            "introduction": "Oligodendrocytes form myelin sheaths to accelerate the propagation of action potentials, but what is the ideal thickness for this insulation? This exercise guides you through a foundational biophysical model to answer that question. You will explore the critical trade-off between increasing membrane resistance to prevent current leak and maintaining a large axonal cross-section for low axial resistance, ultimately deriving the optimal g-ratio that maximizes conduction velocity. ",
            "id": "3984427",
            "problem": "Consider a myelinated axon whose outer fiber radius $r_{\\mathrm{fiber}}$ is set by glial investment, and whose axon (inner) radius $r_{\\mathrm{axon}}$ is controlled by development and plasticity. Define the g-ratio $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$. Assume saltatory conduction proceeds by charging the downstream membrane across an internode through axial current in the axoplasm, and model the total delay per internode as dominated by the resistance-capacitance product of the axoplasmic resistance over one internode and the effective internodal capacitance of the myelin. Use the following foundational elements from cable theory and membrane biophysics:\n\n- Axoplasmic resistance over length $\\ell$ is $R_{i}(\\ell) = \\rho_{i} \\ell / (\\pi r_{\\mathrm{axon}}^{2})$, where $\\rho_{i}$ is the axoplasmic resistivity.\n- The effective internodal capacitance over length $\\ell$ is $C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell \\, c_{\\mathrm{eff}}$, where $c_{\\mathrm{eff}}$ is the effective specific capacitance of the multilamellar myelin stack. Treat myelin as $N$ capacitors in series, with each bilayer having specific capacitance $c_{0}$ and lamellar thickness $\\delta$, so that $N = (r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})/\\delta$ and $c_{\\mathrm{eff}} = c_{0}/N$.\n- The internode length scales linearly with fiber radius, $\\ell = k_{\\ell} r_{\\mathrm{fiber}}$, where $k_{\\ell}$ is a dimensionless scaling constant.\n- The conduction velocity is proportional to the internode length divided by the resistance-capacitance delay, $v = \\alpha \\, \\ell / (R_{i}(\\ell) \\, C_{\\mathrm{int}}(\\ell))$, where $\\alpha$ is a dimensionless proportionality factor capturing thresholding kinetics at the node.\n\nThe central nervous system (CNS) environment imposes a constraint of fixed fiber volume per unit length, which is proportional to $r_{\\mathrm{fiber}}^{2}$; thus, $r_{\\mathrm{fiber}}$ is held fixed while optimizing $g$.\n\nStarting from these bases, derive $v$ as a function of $g$ and $r_{\\mathrm{fiber}}$, and then determine the value of $g$ that maximizes $v$ under the fixed $r_{\\mathrm{fiber}}$ constraint. Finally, using the following biophysical parameter values,\n$\\rho_{i} = 0.7 \\ \\Omega \\cdot \\mathrm{m}$, $c_{0} = 0.01 \\ \\mathrm{F/m}^{2}$, $\\delta = 8 \\times 10^{-9} \\ \\mathrm{m}$, $k_{\\ell} = 200$, $\\alpha = 1$, and $r_{\\mathrm{fiber}} = 5 \\times 10^{-6} \\ \\mathrm{m}$,\ncompute the predicted optimal $g$.\n\nExpress the final answer as a decimal, rounded to four significant figures. The final answer must be a single number without units.",
            "solution": "The user wants me to critically validate the problem statement before attempting to solve it.\n\n### Step 1: Extract Givens\nThe problem provides the following definitions, relations, and constants:\n- **G-ratio:** $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$, where $r_{\\mathrm{axon}}$ is the axon radius and $r_{\\mathrm{fiber}}$ is the outer fiber radius.\n- **Axoplasmic resistance:** The resistance over a length $\\ell$ is $R_{i}(\\ell) = \\frac{\\rho_{i} \\ell}{\\pi r_{\\mathrm{axon}}^{2}}$, where $\\rho_{i}$ is the axoplasmic resistivity.\n- **Internodal capacitance:** The capacitance over a length $\\ell$ is $C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell \\, c_{\\mathrm{eff}}$, where $c_{\\mathrm{eff}}$ is the effective specific capacitance.\n- **Effective specific capacitance:** $c_{\\mathrm{eff}} = c_{0}/N$, where $c_{0}$ is the specific capacitance of a single bilayer and $N$ is the number of myelin lamellae.\n- **Number of myelin lamellae:** $N = \\frac{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}{\\delta}$, where $\\delta$ is the lamellar thickness.\n- **Internode length:** $\\ell = k_{\\ell} r_{\\mathrm{fiber}}$, where $k_{\\ell}$ is a dimensionless scaling constant.\n- **Conduction velocity:** $v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)}$, where $\\alpha$ is a dimensionless proportionality factor.\n- **Constraint:** The fiber radius $r_{\\mathrm{fiber}}$ is held fixed.\n- **Parameter values:** $\\rho_{i} = 0.7 \\ \\Omega \\cdot \\mathrm{m}$, $c_{0} = 0.01 \\ \\mathrm{F/m}^{2}$, $\\delta = 8 \\times 10^{-9} \\ \\mathrm{m}$, $k_{\\ell} = 200$, $\\alpha = 1$, and $r_{\\mathrm{fiber}} = 5 \\times 10^{-6} \\ \\mathrm{m}$.\n- **Objective:** First, derive $v$ as a function of $g$ and $r_{\\mathrm{fiber}}$. Second, find the value of $g$ that maximizes $v$. Third, compute this optimal $g$ value using the given parameters, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic biophysical modeling exercise in computational neuroscience.\n- **Scientifically Grounded (Critical):** The problem is based on simplified but standard models from cable theory and the biophysics of myelinated axons (e.g., the Rushton model). All principles are well-established in the field.\n- **Well-Posed:** The problem provides a clear objective (maximize velocity $v$) and a clear set of governing equations and constraints. The function to be maximized is well-defined, and a unique solution is expected.\n- **Objective (Critical):** The problem is stated in precise, quantitative terms, free of subjective or ambiguous language.\n- **Completeness and Consistency:** The problem provides all necessary equations, variables, and constants to construct the function for velocity and to perform the optimization. The \"fixed fiber volume per unit length\" is correctly translated into the constraint of a fixed $r_{\\mathrm{fiber}}$.\n- **Realism:** The setup and parameter values are within the range of biophysically plausible values for mammalian CNS neurons.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. It is a formalizable, scientifically sound, and well-posed optimization problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with the solution.\n\n### Derivation of Conduction Velocity\nThe task is to find the conduction velocity $v$ as a function of the g-ratio $g$ and the fiber radius $r_{\\mathrm{fiber}}$. We start with the given expression for velocity:\n$$v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)}$$\nWe will substitute the provided expressions for each term.\n\nFirst, let's express the capacitance $C_{\\mathrm{int}}(\\ell)$ in terms of the fundamental parameters.\nThe number of myelin lamellae is $N = \\frac{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}{\\delta}$.\nThe effective specific capacitance is $c_{\\mathrm{eff}} = \\frac{c_{0}}{N} = \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}}$.\nSubstituting this into the expression for internodal capacitance $C_{\\mathrm{int}}(\\ell)$:\n$$C_{\\mathrm{int}}(\\ell) = 2 \\pi r_{\\mathrm{fiber}} \\ell c_{\\mathrm{eff}} = 2 \\pi r_{\\mathrm{fiber}} \\ell \\left( \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}} \\right)$$\nNow, we can assemble the product $R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)$ which represents the time constant of internodal charging:\n$$R_{i}(\\ell) C_{\\mathrm{int}}(\\ell) = \\left( \\frac{\\rho_{i} \\ell}{\\pi r_{\\mathrm{axon}}^{2}} \\right) \\left( 2 \\pi r_{\\mathrm{fiber}} \\ell \\frac{c_{0} \\delta}{r_{\\mathrm{fiber}} - r_{\\mathrm{axon}}} \\right)$$\nSimplifying this expression:\n$$R_{i}(\\ell) C_{\\mathrm{int}}(\\ell) = \\frac{2 \\rho_{i} c_{0} \\delta \\ell^{2} r_{\\mathrm{fiber}}}{r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}$$\nNow, substitute this back into the equation for velocity $v$:\n$$v = \\frac{\\alpha \\ell}{R_{i}(\\ell) C_{\\mathrm{int}}(\\ell)} = \\frac{\\alpha \\ell}{\\frac{2 \\rho_{i} c_{0} \\delta \\ell^{2} r_{\\mathrm{fiber}}}{r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}} = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta \\ell r_{\\mathrm{fiber}}}$$\nThe problem states that internode length $\\ell$ scales with fiber radius: $\\ell = k_{\\ell} r_{\\mathrm{fiber}}$. Substituting this for $\\ell$:\n$$v = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta (k_{\\ell} r_{\\mathrm{fiber}}) r_{\\mathrm{fiber}}} = \\frac{\\alpha r_{\\mathrm{axon}}^{2}(r_{\\mathrm{fiber}} - r_{\\mathrm{axon}})}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}}$$\nThis is the velocity in terms of $r_{\\mathrm{axon}}$ and $r_{\\mathrm{fiber}}$. The next step is to express this in terms of the g-ratio, $g = r_{\\mathrm{axon}}/r_{\\mathrm{fiber}}$, which implies $r_{\\mathrm{axon}} = g r_{\\mathrm{fiber}}$.\n$$v = \\frac{\\alpha (g r_{\\mathrm{fiber}})^{2}(r_{\\mathrm{fiber}} - g r_{\\mathrm{fiber}})}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}} = \\frac{\\alpha g^{2} r_{\\mathrm{fiber}}^{2} r_{\\mathrm{fiber}}(1 - g)}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}}$$\nThe $r_{\\mathrm{fiber}}^{2}$ terms in the numerator and denominator cancel:\n$$v(g, r_{\\mathrm{fiber}}) = \\frac{\\alpha g^{2} r_{\\mathrm{fiber}}^{3}(1 - g)}{2 \\rho_{i} c_{0} \\delta k_{\\ell} r_{\\mathrm{fiber}}^{2}} = \\left( \\frac{\\alpha}{2 \\rho_{i} c_{0} \\delta k_{\\ell}} \\right) r_{\\mathrm{fiber}} g^{2}(1 - g)$$\nThis is the final expression for $v$ as a function of $g$ and $r_{\\mathrm{fiber}}$.\n\n### Optimization of Conduction Velocity\nThe problem requires finding the value of $g$ that maximizes $v$ under the constraint that $r_{\\mathrm{fiber}}$ is fixed. We can treat the expression for $v$ as a function of $g$ only, $v(g)$.\nLet's define a constant $K$ that groups all the fixed parameters:\n$$K = \\left( \\frac{\\alpha}{2 \\rho_{i} c_{0} \\delta k_{\\ell}} \\right) r_{\\mathrm{fiber}}$$\nAll terms in $K$ are positive constants, so $K > 0$. The velocity function is:\n$$v(g) = K g^{2}(1 - g) = K(g^{2} - g^{3})$$\nThe g-ratio must be in the interval $g \\in (0, 1)$ for a myelinated axon to be physically meaningful. At the boundaries, $v(0) = 0$ and $v(1) = 0$. To find the maximum within this interval, we take the derivative of $v(g)$ with respect to $g$ and set it to zero:\n$$\\frac{dv}{dg} = \\frac{d}{dg} [K(g^{2} - g^{3})] = K(2g - 3g^{2})$$\nSetting the derivative to zero to find critical points:\n$$K(2g - 3g^{2}) = 0$$\nSince $K \\neq 0$, we have:\n$$2g - 3g^{2} = 0 \\implies g(2 - 3g) = 0$$\nThis yields two solutions: $g = 0$ and $g = \\frac{2}{3}$. As noted, $g=0$ corresponds to a minimum velocity of $0$. The non-trivial solution is $g = 2/3$.\nTo confirm this is a maximum, we examine the second derivative:\n$$\\frac{d^{2}v}{dg^{2}} = \\frac{d}{dg} [K(2g - 3g^{2})] = K(2 - 6g)$$\nEvaluate the second derivative at $g = 2/3$:\n$$\\left. \\frac{d^{2}v}{dg^{2}} \\right|_{g=2/3} = K\\left(2 - 6\\left(\\frac{2}{3}\\right)\\right) = K(2 - 4) = -2K$$\nSince $K > 0$, the second derivative is negative, confirming that $g = 2/3$ corresponds to a local maximum. As it's the only critical point in the interval $(0, 1)$, it is the global maximum.\n\n### Computation of the Optimal g-ratio\nThe optimal g-ratio that maximizes conduction velocity, according to this model, is $g = 2/3$. This result is independent of all the specific biophysical parameter values ($\\rho_{i}$, $c_{0}$, $\\delta$, $k_{\\ell}$, $\\alpha$, and $r_{\\mathrm{fiber}}$). These values would be needed to calculate the maximal velocity $v_{\\mathrm{max}}$, but not the optimal ratio $g$.\nThe problem asks for the numerical value of the optimal $g$ rounded to four significant figures.\n$$g = \\frac{2}{3} = 0.666666...$$\nRounding to four significant figures, we get $0.6667$.",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "Beyond influencing conduction speed, glial cells are critical players at the synapse. This computational practice shifts our focus to astrocytes, which meticulously sculpt synaptic transmission by clearing neurotransmitters from the extracellular space. You will model glutamate diffusion and uptake by perisynaptic astrocytic processes, treating the transporter-rich membrane as a partially absorbing boundary. By solving for the dominant clearance time constant, you will gain quantitative insight into how astrocyte geometry and transporter efficacy shape the temporal dynamics of synaptic signaling. ",
            "id": "3984493",
            "problem": "Consider a localized glutamate release into an extracellular microdomain adjacent to a perisynaptic astrocyte process. Assume that the microdomain is radially symmetric, either spherical or cylindrical, and that the enclosing astrocyte membrane is enriched with Excitatory Amino Acid Transporter (EAAT) proteins that act as a partially absorbing boundary. Model glutamate concentration $C(\\mathbf{x},t)$ by the diffusion equation with a Robin (mixed) boundary condition representing transporter-mediated uptake, starting from foundational definitions of diffusion and mass conservation.\n\nFundamental base and assumptions:\n- Fickian diffusion: $\\,\\dfrac{\\partial C}{\\partial t} = D \\nabla^2 C\\,$, with diffusion coefficient $D$.\n- Partially absorbing boundary at the astrocyte membrane: $\\,D\\,\\dfrac{\\partial C}{\\partial n}\\big|_{\\partial \\Omega} + k_m\\, C\\big|_{\\partial \\Omega} = 0\\,$, where $\\dfrac{\\partial}{\\partial n}$ is the outward normal derivative at the boundary $\\partial \\Omega$, and $k_m$ is an effective uptake coefficient (with dimensions of length per time) that aggregates transporter density and single-transporter kinetics.\n- Symmetry at the release center: no-flux at $r=0$ for radial geometries.\n\nWe seek the dominant clearance time constant $\\,\\tau\\,$ that characterizes the asymptotic decay of total extracellular glutamate, which, under these assumptions, is governed by the slowest decaying eigenmode of the diffusion operator subject to the above Robin boundary condition. In radially symmetric geometries, separation of variables reduces the problem to finding the smallest positive spatial eigenvalue parameter $\\,x\\,$ that satisfies a boundary equation, and then computing\n$$\n\\tau \\;=\\; \\frac{1}{\\alpha_1} \\;=\\; \\frac{R^2}{D\\,x^2},\n$$\nwhere $R$ is the microdomain radius and $\\alpha_1$ is the dominant decay rate.\n\nFor a spherical microdomain (three-dimensional ball of radius $R$), the slowest radial mode satisfies the eigenvalue condition\n$$\nx \\cos x \\;+\\; (\\beta - 1)\\, \\sin x \\;=\\; 0,\n$$\nwhere $\\,x = k R\\,$ and $\\,\\beta = \\dfrac{k_m R}{D}\\,$. For a cylindrical microdomain (two-dimensional disk cross-section with axial invariance) the eigenvalue condition is\n$$\n\\beta\\, J_0(x) \\;-\\; x\\, J_1(x) \\;=\\; 0,\n$$\nwhere $J_0$ and $J_1$ are Bessel functions of the first kind and $\\,x = \\lambda R\\,$. In both cases, the decay rate is $\\,\\alpha_1 = D\\,x^2 / R^2\\,$ and the clearance time constant is $\\,\\tau = R^2 / (D\\,x^2)\\,$. If $\\,k_m = 0\\,$ (perfectly reflecting boundary), the constant mode yields $\\,\\alpha_1 = 0\\,$ and the clearance time is infinite.\n\nYour program must:\n- Numerically find the smallest positive root $\\,x > 0\\,$ of the appropriate eigenvalue equation for each test case, using robust one-dimensional root finding with bracketing.\n- Compute the corresponding clearance time constant $\\,\\tau\\,$ in milliseconds, assuming micrometer and millisecond units as specified below.\n- Handle the limit case $\\,k_m = 0\\,$ by returning $+\\infty$ for $\\,\\tau\\,$.\n\nUnits:\n- Use micrometers ($\\mu\\text{m}$) for length, milliseconds ($\\text{ms}$) for time.\n- Diffusion coefficient $D$ must be in $\\mu\\text{m}^2/\\text{ms}$.\n- Uptake coefficient $k_m$ must be in $\\mu\\text{m}/\\text{ms}$.\n- Radius $R$ must be in $\\mu\\text{m}$.\n- Express all outputs for $\\,\\tau\\,$ in $\\text{ms}$ as floating-point numbers.\n\nTest suite:\nProvide results for the following parameter sets, covering different geometries, uptake strengths, and boundary cases.\n- Case $1$ (happy path, spherical, moderate uptake): geometry $=$ sphere, $D = 0.4$ $\\mu\\text{m}^2/\\text{ms}$, $R = 0.5$ $\\mu\\text{m}$, $k_m = 0.05$ $\\mu\\text{m}/\\text{ms}$.\n- Case $2$ (spherical, strong uptake, near-Dirichlet): geometry $=$ sphere, $D = 0.4$, $R = 0.5$, $k_m = 10.0$.\n- Case $3$ (cylindrical, moderate uptake): geometry $=$ cylinder, $D = 0.4$, $R = 0.5$, $k_m = 0.05$.\n- Case $4$ (cylindrical, strong uptake, near-Dirichlet): geometry $=$ cylinder, $D = 0.4$, $R = 0.5$, $k_m = 10.0$.\n- Case $5$ (spherical, extremely weak uptake, near-reflecting): geometry $=$ sphere, $D = 0.4$, $R = 0.5$, $k_m = 0.0001$.\n- Case $6$ (cylindrical, extremely weak uptake, near-reflecting): geometry $=$ cylinder, $D = 0.4$, $R = 0.5$, $k_m = 0.0001$.\n- Case $7$ (spherical, smaller geometry): geometry $=$ sphere, $D = 0.4$, $R = 0.2$, $k_m = 0.05$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the clearance time constant $\\,\\tau\\,$ in $\\text{ms}$ for the corresponding test case, in the same order as above. For example, the output must have the form\n$$\n[\\tau_1,\\tau_2,\\tau_3,\\tau_4,\\tau_5,\\tau_6,\\tau_7].\n$$",
            "solution": "We start from Fickian diffusion and mass balance in a bounded microdomain $\\Omega$ with boundary $\\partial \\Omega$. The concentration $C(\\mathbf{x},t)$ evolves according to\n$$\n\\frac{\\partial C}{\\partial t} = D \\nabla^2 C,\n$$\nwhere $D$ is the diffusion coefficient. Transporters at the perisynaptic astrocyte membrane are modeled as a partially absorbing boundary condition of Robin type,\n$$\nD\\,\\frac{\\partial C}{\\partial n}\\Big|_{\\partial \\Omega} + k_m\\, C\\Big|_{\\partial \\Omega} = 0,\n$$\nwith outward normal derivative $\\dfrac{\\partial}{\\partial n}$, and an uptake coefficient $k_m$ that lumps transporter density and single-transporter kinetics into an effective flux proportional to the local concentration. This boundary condition is standard for reactive boundaries and ensures dimensional consistency: $D$ has units $\\mu\\text{m}^2/\\text{ms}$, $\\dfrac{\\partial C}{\\partial n}$ has units $\\text{concentration}/\\mu\\text{m}$, and $k_m$ has units $\\mu\\text{m}/\\text{ms}$, so both terms have flux units $\\text{concentration}\\cdot\\mu\\text{m}/\\text{ms}$.\n\nTo characterize glutamate clearance, we examine the asymptotic decay of the total mass $M(t) = \\int_{\\Omega} C(\\mathbf{x},t)\\, dV$. With no volumetric reaction, the decay is generated solely by boundary uptake. Separation of variables yields modal solutions\n$$\nC(\\mathbf{x},t) = f(\\mathbf{x})\\, e^{-\\alpha t},\n$$\nwith spatial modes $f$ that solve the Helmholtz equation\n$$\n\\nabla^2 f + \\kappa^2 f = 0,\\quad \\text{with}\\quad \\kappa^2 = \\frac{\\alpha}{D},\n$$\nsubject to the Robin boundary condition\n$$\nD\\,\\frac{\\partial f}{\\partial n}\\Big|_{\\partial \\Omega} + k_m\\, f\\Big|_{\\partial \\Omega} = 0.\n$$\nIn radially symmetric geometries (spherical or cylindrical), the dominant mode has zero angular dependence. Its temporal decay rate $\\alpha_1$ is given by the smallest positive admissible $\\kappa^2$ (hence smallest positive $x$ in the dimensionless boundary condition), and the clearance time constant is\n$$\n\\tau = \\frac{1}{\\alpha_1} = \\frac{R^2}{D\\,x^2}.\n$$\n\nSpherical geometry:\nFor a ball of radius $R$, the spherically symmetric solution is proportional to the spherical Bessel function $j_0(x) = \\dfrac{\\sin x}{x}$, and the boundary condition becomes\n$$\nD\\,\\frac{\\partial}{\\partial r} j_0(k r)\\Big|_{r=R} + k_m\\, j_0(k R) = 0.\n$$\nUsing $j_0'(x) = \\frac{x\\cos x - \\sin x}{x^2}$ and $\\frac{\\partial}{\\partial r} j_0(k r) = k\\, j_0'(k r)$, we obtain\n$$\nD\\,k\\, j_0'(k R) + k_m\\, j_0(k R) = 0.\n$$\nDefine the dimensionless parameter $\\beta = \\dfrac{k_m R}{D}$ and $x = k R$. Multiplying by $\\dfrac{R}{D}$ and simplifying yields\n$$\nx \\cos x + (\\beta - 1)\\,\\sin x = 0.\n$$\nThe smallest positive root $x_1$ of this equation determines the dominant decay rate $\\alpha_1 = D\\,x_1^2 / R^2$, hence the clearance time $\\tau = R^2 / (D\\,x_1^2)$. Two limiting regimes provide physical intuition:\n- Weak uptake ($\\beta \\ll 1$): expand $\\sin x \\approx x - \\frac{x^3}{6}$, $\\cos x \\approx 1 - \\frac{x^2}{2}$, giving\n$$\nx \\left(1 - \\frac{x^2}{2}\\right) + (\\beta - 1)\\left(x - \\frac{x^3}{6}\\right) \\approx \\beta x - x^3\\,\\frac{\\beta + 2}{6} = 0\n\\;\\Rightarrow\\; x^2 \\approx \\frac{6\\beta}{\\beta + 2} \\approx 3\\beta,\n$$\nso\n$$\n\\alpha_1 \\approx \\frac{D\\,(3\\beta)}{R^2} = \\frac{3\\,k_m}{R}\n\\quad\\Rightarrow\\quad \\tau \\approx \\frac{R}{3\\,k_m}.\n$$\n- Strong uptake ($\\beta \\gg 1$): the equation tends to $\\sin x \\approx 0$, so $x_1 \\approx \\pi$, giving\n$$\n\\alpha_1 \\approx \\frac{D\\,\\pi^2}{R^2},\\quad \\tau \\approx \\frac{R^2}{D\\,\\pi^2}.\n$$\n\nCylindrical geometry:\nFor an axially invariant cylinder (disk cross-section of radius $R$), radial modes are given by Bessel functions $J_0(\\lambda r)$. The boundary condition\n$$\nD\\,\\frac{\\partial}{\\partial r} J_0(\\lambda r)\\Big|_{r=R} + k_m\\, J_0(\\lambda R) = 0\n$$\nuses $\\frac{\\partial}{\\partial r} J_0(\\lambda r) = -\\lambda J_1(\\lambda r)$, hence\n$$\n- D\\,\\lambda\\, J_1(\\lambda R) + k_m\\, J_0(\\lambda R) = 0.\n$$\nWith $x = \\lambda R$ and $\\beta = \\dfrac{k_m R}{D}$,\n$$\n\\beta\\, J_0(x) - x\\, J_1(x) = 0.\n$$\nAs before, $\\alpha_1 = D\\,x_1^2 / R^2$ and $\\tau = R^2 / (D\\,x_1^2)$, with limits:\n- Weak uptake ($\\beta \\ll 1$): expand $J_0(x) \\approx 1 - \\frac{x^2}{4}$ and $J_1(x) \\approx \\frac{x}{2} - \\frac{x^3}{16}$, yielding\n$$\n\\beta\\left(1 - \\frac{x^2}{4}\\right) - x\\left(\\frac{x}{2} - \\frac{x^3}{16}\\right) \\approx \\beta - \\left(\\frac{\\beta}{4} + \\frac{1}{2}\\right) x^2 = 0\n\\;\\Rightarrow\\; x^2 \\approx \\frac{2\\beta}{1 + \\beta/2} \\approx 2\\beta,\n$$\nso\n$$\n\\alpha_1 \\approx \\frac{D\\,(2\\beta)}{R^2} = \\frac{2\\,k_m}{R}\n\\quad\\Rightarrow\\quad \\tau \\approx \\frac{R}{2\\,k_m}.\n$$\n- Strong uptake ($\\beta \\gg 1$): the boundary tends to $J_0(x) \\approx 0$, so $x_1 \\approx x_{0}$, the first zero of $J_0$, $x_{0} \\approx 2.404825557$, giving\n$$\n\\alpha_1 \\approx \\frac{D\\,x_0^2}{R^2},\\quad \\tau \\approx \\frac{R^2}{D\\,x_0^2}.\n$$\n\nAlgorithmic design:\n- For each test case, compute $\\beta = \\dfrac{k_m R}{D}$.\n- If $k_m = 0$, return $\\tau = +\\infty$.\n- Otherwise, define the geometry-specific scalar function of $x$:\n  - Sphere: $f_{\\text{sphere}}(x;\\beta) = x \\cos x + (\\beta - 1)\\,\\sin x$.\n  - Cylinder: $f_{\\text{cyl}}(x;\\beta) = \\beta\\, J_0(x) - x\\, J_1(x)$.\n- Find the smallest positive root $x_1$ by scanning for a sign change over a suitably dense grid $x \\in (0,x_{\\max})$ with refinement near $x=0$, then refine the root with bracketing using a robust method such as Brent's algorithm.\n- Compute $\\tau = \\dfrac{R^2}{D\\,x_1^2}$ in milliseconds.\n- Aggregate outputs for all test cases into the specified single-line format.\n\nNumerical robustness:\n- The functions are continuous and oscillatory, ensuring the existence of brackets for roots beyond $x=0$; careful exclusion of the trivial root $x=0$ avoids the non-decaying constant mode.\n- Dense sampling near $x=0$ captures small-$x$ roots expected when $\\beta \\ll 1$.\n- Using bracketing-based solvers prevents convergence to non-physical roots.\n\nThis procedure yields scientifically realistic clearance time constants that reflect how perisynaptic astrocyte geometry ($R$) and transporter efficacy ($k_m$) regulate glutamate removal via diffusion with partially absorbing boundaries.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\nfrom scipy.special import j0, j1\n\ndef smallest_positive_root(func, beta, x_min=1e-9, x_max=50.0):\n    \"\"\"\n    Find the smallest positive root of func(x, beta) = 0 using\n    a scan for sign changes followed by a bracketing root finder.\n    Excludes the trivial root at x=0 by starting at x_min > 0.\n    \"\"\"\n    # Build a nonuniform grid: dense near zero to capture small roots, coarser later.\n    x_grid1 = np.linspace(x_min, 1.0, 5000)\n    x_grid2 = np.linspace(1.0, x_max, 5000)\n    x_grid = np.concatenate((x_grid1, x_grid2))\n    f_vals = func(x_grid, beta)\n\n    # Identify sign changes (f_i * f_{i+1} <= 0 and exclude near-zero trivial root)\n    for i in range(len(x_grid) - 1):\n        f1 = f_vals[i]\n        f2 = f_vals[i + 1]\n        # Skip intervals that include the trivial root ~0\n        if x_grid[i] < 1e-8 and x_grid[i + 1] < 1e-8:\n            continue\n        # Find the first sign change\n        if f1 == 0.0:\n            # Exact zero at grid point: ensure it's not x ~ 0 and return this as the smallest root\n            if x_grid[i] > 1e-8:\n                return x_grid[i]\n            else:\n                continue\n        if f1 * f2 < 0.0 or f2 == 0.0:\n            a = x_grid[i]\n            b = x_grid[i + 1]\n            # Use a robust bracketing solver (Brent's method)\n            sol = root_scalar(lambda x: func(x, beta), bracket=[a, b], method='brentq')\n            if sol.converged:\n                return sol.root\n            # If not converged, continue scanning\n\n    # If no root found within range, raise an error\n    raise RuntimeError(\"No positive root found in the specified range.\")\n\ndef sphere_equation(x, beta):\n    \"\"\"\n    f_sphere(x; beta) = x*cos(x) + (beta - 1.0)*sin(x)\n    \"\"\"\n    return x * np.cos(x) + (beta - 1.0) * np.sin(x)\n\ndef cylinder_equation(x, beta):\n    \"\"\"\n    f_cyl(x; beta) = beta*J0(x) - x*J1(x)\n    \"\"\"\n    return beta * j0(x) - x * j1(x)\n\ndef clearance_time_ms(geometry, D_um2_per_ms, R_um, k_m_um_per_ms):\n    \"\"\"\n    Compute clearance time constant tau (ms) for the given geometry and parameters.\n    - geometry: 'sphere' or 'cylinder'\n    - D_um2_per_ms: diffusion coefficient in um^2/ms\n    - R_um: radius in um\n    - k_m_um_per_ms: uptake coefficient in um/ms\n    Returns tau in ms (float), with np.inf for k_m == 0.\n    \"\"\"\n    if k_m_um_per_ms == 0.0:\n        return float('inf')\n\n    beta = (k_m_um_per_ms * R_um) / D_um2_per_ms\n\n    if geometry == 'sphere':\n        x1 = smallest_positive_root(sphere_equation, beta)\n    elif geometry == 'cylinder':\n        x1 = smallest_positive_root(cylinder_equation, beta)\n    else:\n        raise ValueError(\"Unsupported geometry. Use 'sphere' or 'cylinder'.\")\n\n    alpha1 = D_um2_per_ms * (x1 ** 2) / (R_um ** 2)  # ms^{-1}\n    tau_ms = 1.0 / alpha1\n    return tau_ms\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (geometry, D, R, k_m)\n    test_cases = [\n        (\"sphere\", 0.4, 0.5, 0.05),      # Case 1\n        (\"sphere\", 0.4, 0.5, 10.0),      # Case 2\n        (\"cylinder\", 0.4, 0.5, 0.05),    # Case 3\n        (\"cylinder\", 0.4, 0.5, 10.0),    # Case 4\n        (\"sphere\", 0.4, 0.5, 0.0001),    # Case 5\n        (\"cylinder\", 0.4, 0.5, 0.0001),  # Case 6\n        (\"sphere\", 0.4, 0.2, 0.05),      # Case 7\n    ]\n\n    results = []\n    for geometry, D, R, k_m in test_cases:\n        tau = clearance_time_ms(geometry, D, R, k_m)\n        # Round to 6 decimal places for consistent output; keep 'inf' as is\n        if np.isfinite(tau):\n            tau = round(tau, 6)\n        results.append(tau)\n\n    # Convert results to string, preserving 'inf' formatting\n    def format_val(v):\n        if np.isfinite(v):\n            return f\"{v}\"\n        else:\n            return \"inf\"\n\n    print(f\"[{','.join(map(format_val, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Biological systems rarely optimize a single parameter in isolation; they operate under a web of competing constraints. This final exercise revisits myelination from a systems-level perspective, incorporating the crucial factor of metabolic cost. You will construct and optimize a utility function that weighs the timing benefits of faster conduction against the significant energetic expense of building and maintaining the myelin sheath. This practice illuminates a more realistic design principle, demonstrating how the brain balances performance with efficiency in the investment of its glial resources. ",
            "id": "3984447",
            "problem": "Consider the role of oligodendrocyte-derived myelin in regulating axonal conduction timing and energy usage. Let an axon of radius $a$ be ensheathed by myelin of thickness $m \\geq 0$, forming a fiber with outer radius $x = a + m$. Assume the following well-tested relationships and definitions as a fundamental base for modeling, consistent with saltatory conduction in myelinated fibers and maintenance energetics of glial cells:\n\n1. Conduction velocity scales approximately linearly with fiber diameter, so set $v(x) = c_v x$ with $c_v$ a positive constant measured in $\\mathrm{s}^{-1}$, yielding $v$ in $\\mathrm{m/s}$ when $x$ is in $\\mathrm{m}$.\n2. Internode length scales approximately linearly with fiber diameter, so set $\\ell(x) = c_\\ell x$ with $c_\\ell$ dimensionless and positive.\n3. The number of nodes of Ranvier across a path of length $D$ is $N(x) = D / \\ell(x)$.\n4. The cross-sectional area of the myelin per unit length is $A(x) = \\pi\\left(x^2 - a^2\\right)$, assuming a cylindrical axon and concentric myelin wrap.\n5. Adenosine Triphosphate (ATP) usage per second is comprised of spike-dependent costs and baseline maintenance costs. For a spike rate $\\lambda$ (in $\\mathrm{s}^{-1}$), ATP usage per action potential per node $q$ (in molecules), and a maintenance rate per unit volume $r$ (in molecules $\\mathrm{s}^{-1}\\mathrm{m}^{-3}$), define the total ATP usage rate as\n$$\n\\mathrm{ATP}(x) = \\lambda \\, q \\, N(x) + r \\, A(x) \\, D = \\lambda q \\frac{D}{c_\\ell x} + r D \\pi \\left(x^2 - a^2\\right).\n$$\n6. The inverse conduction time across the path is $\\Delta t^{-1} = v(x)/D$.\n\nDefine a utility function that trades off timing benefits against metabolic cost,\n$$\nU(m) = w_t \\, \\Delta t^{-1} - w_c \\, \\mathrm{ATP}(x),\n$$\nwith $w_t \\geq 0$ and $w_c \\geq 0$ dimensionless weights. The task is to find the myelin thickness $m^\\*$ within a feasible range $m \\in [0, m_{\\max}]$ that maximizes $U(m)$, where $m_{\\max} > 0$ is a biologically plausible upper bound.\n\nYou are to implement a program that, for each test case, computes the optimal myelin thickness $m^\\*$ that maximizes $U(m)$ subject to $0 \\leq m \\leq m_{\\max}$. All lengths are in $\\mathrm{m}$ internally, but the final answers for $m^\\*$ must be expressed in micrometers ($\\mu \\mathrm{m}$), rounded to three decimal places. No angles are involved. The final answers must be printed as a single line, containing a comma-separated list enclosed in square brackets, for example, $[m_1,m_2,\\dots]$, where each $m_i$ is the optimal thickness in $\\mu \\mathrm{m}$ rounded to three decimals.\n\nUse the following fixed constants across all test cases:\n- $c_v = 12 \\times 10^6$ (units: $\\mathrm{s}^{-1}$),\n- $c_\\ell = 200$ (dimensionless),\n- $\\pi = 3.141592653589793$,\n- $q = 1.0 \\times 10^6$ (ATP molecules per action potential per node).\n\nTest Suite:\nFor each case, parameters are provided as $(a, D, w_t, w_c, \\lambda, r, m_{\\max})$, with $a$ in $\\mathrm{m}$, $D$ in $\\mathrm{m}$, $w_t$ and $w_c$ dimensionless, $\\lambda$ in $\\mathrm{s}^{-1}$, $r$ in molecules $\\mathrm{s}^{-1}\\mathrm{m}^{-3}$, and $m_{\\max}$ in $\\mathrm{m}$.\n\n- Case 1 (balanced interior optimum): $(1.0 \\times 10^{-6}, 0.05, 1.0, 1.0 \\times 10^{-6}, 20.0, 1.0 \\times 10^{20}, 6.0 \\times 10^{-6})$.\n- Case 2 (no timing benefit, boundary at zero): $(1.0 \\times 10^{-6}, 0.05, 0.0, 1.0 \\times 10^{-6}, 20.0, 1.0 \\times 10^{20}, 6.0 \\times 10^{-6})$.\n- Case 3 (strong timing benefit, boundary at maximum): $(1.0 \\times 10^{-6}, 0.05, 10.0, 1.0 \\times 10^{-6}, 20.0, 1.0 \\times 10^{20}, 6.0 \\times 10^{-6})$.\n- Case 4 (high maintenance penalty, thinner optimal): $(1.0 \\times 10^{-6}, 0.05, 1.0, 5.0 \\times 10^{-6}, 20.0, 5.0 \\times 10^{20}, 6.0 \\times 10^{-6})$.\n- Case 5 (smaller axon radius, altered geometry): $(0.5 \\times 10^{-6}, 0.05, 1.0, 1.0 \\times 10^{-6}, 20.0, 1.0 \\times 10^{20}, 8.0 \\times 10^{-6})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the optimal $m^\\*$ in $\\mu \\mathrm{m}$ rounded to three decimals, corresponding in order to the above test cases.",
            "solution": "The problem requires finding the optimal myelin thickness $m^*$ that maximizes a given utility function $U(m)$ over a biologically feasible range $m \\in [0, m_{\\max}]$. The utility function balances the benefit of faster signal conduction against the metabolic cost of maintaining the myelin sheath.\n\nThe utility function is defined as:\n$$\nU(m) = w_t \\, \\Delta t^{-1} - w_c \\, \\mathrm{ATP}(x)\n$$\nwhere $w_t \\geq 0$ and $w_c \\geq 0$ are dimensionless weights, $x = a + m$ is the total fiber radius, $\\Delta t^{-1}$ is the inverse conduction time, and $\\mathrm{ATP}(x)$ is the total metabolic cost rate.\n\nThe components are given as:\n1. Inverse conduction time: $\\Delta t^{-1} = v(x)/D = (c_v x)/D$. This term represents the benefit of speed, increasing linearly with the total fiber radius $x$.\n2. Metabolic cost: $\\mathrm{ATP}(x) = \\lambda q \\frac{D}{c_\\ell x} + r D \\pi (x^2 - a^2)$. This term has two components: a cost related to action potentials at the nodes of Ranvier, which decreases as $x$ increases (since internode length $\\ell(x) = c_\\ell x$ increases, reducing the number of nodes), and a cost for myelin volume maintenance, which increases with the myelin cross-sectional area $A(x) = \\pi(x^2 - a^2)$.\n\nTo facilitate optimization, we express the utility function solely in terms of the total fiber radius $x$. Substituting the expressions for $\\Delta t^{-1}$ and $\\mathrm{ATP}(x)$ into the utility function gives:\n$$\nU(x) = w_t \\left( \\frac{c_v x}{D} \\right) - w_c \\left( \\lambda q \\frac{D}{c_\\ell x} + r D \\pi (x^2 - a^2) \\right)\n$$\nThe optimization is performed over the variable $m$ in the interval $[0, m_{\\max}]$. This corresponds to an optimization over $x$ in the interval $[a, a + m_{\\max}]$. We can rearrange the utility function by gathering terms dependent on $x$:\n$$\nU(x) = \\left( \\frac{w_t c_v}{D} \\right) x - \\left( \\frac{w_c \\lambda q D}{c_\\ell} \\right) \\frac{1}{x} - (w_c r D \\pi) x^2 + (w_c r D \\pi a^2)\n$$\nThe last term, $w_c r D \\pi a^2$, is a constant with respect to $x$ and does not influence the location of the maximum. Let us define the following positive constants to simplify the expression:\n- $K_1 = \\frac{w_t c_v}{D}$\n- $K_2 = \\frac{w_c \\lambda q D}{c_\\ell}$\n- $K_3 = w_c r D \\pi$\n\nThe part of the utility function that depends on $x$ is $f(x) = K_1 x - K_2 x^{-1} - K_3 x^2$. To find the value of $x$ that maximizes this function, we compute its derivative with respect to $x$ and set it to zero.\n$$\n\\frac{df}{dx} = K_1 + K_2 x^{-2} - 2 K_3 x\n$$\nSetting the derivative to zero gives the equation for the critical points, $x_c$:\n$$\nK_1 + \\frac{K_2}{x_c^2} - 2 K_3 x_c = 0\n$$\nSince the axon radius $a$ must be positive, we know $x = a + m > 0$, so we can multiply by $x_c^2$:\n$$\nK_1 x_c^2 + K_2 - 2 K_3 x_c^3 = 0\n$$\nRearranging gives a cubic polynomial equation for $x_c$:\n$$\n2 K_3 x_c^3 - K_1 x_c^2 - K_2 = 0\n$$\nTo determine the nature of this critical point, we examine the second derivative of $f(x)$:\n$$\n\\frac{d^2f}{dx^2} = -2 K_2 x^{-3} - 2 K_3\n$$\nGiven that all the fundamental parameters ($w_c, r, D, \\pi, \\lambda, q, c_\\ell$) are non-negative, the constants $K_2$ and $K_3$ are also non-negative. For any physically meaningful case where metabolic costs exist ($w_c > 0$), at least one of $K_2$ or $K_3$ will be positive. Since $x > 0$, the second derivative $\\frac{d^2f}{dx^2}$ will be strictly negative. This indicates that the function $f(x)$ is strictly concave. A strictly concave function has at most one critical point, which must be a global maximum.\n\nThe problem, therefore, reduces to the following procedure:\n1. Calculate the constants $K_1$, $K_2$, and $K_3$ from the given parameters for each test case.\n2. Solve the cubic equation $2 K_3 x^3 - K_1 x^2 - K_2 = 0$ for its real, positive root, $x_c$. Analysis of the polynomial shows that for $K_1, K_2, K_3 > 0$, there is exactly one such root. This root represents the unconstrained optimal fiber radius.\n3. The optimization, however, is constrained to the interval $x \\in [a, a + m_{\\max}]$. Since the utility function is concave, its maximum over this closed interval will occur at $x_c$ if $x_c$ is within the interval, or at the boundary of the interval closest to $x_c$. This can be expressed as clamping the solution to the feasible range:\n$$\nx^* = \\max(a, \\min(x_c, a + m_{\\max}))\n$$\n4. Once the optimal fiber radius $x^*$ is determined, the optimal myelin thickness $m^*$ is calculated as:\n$$\nm^* = x^* - a\n$$\n5. The final result for $m^*$ is converted from meters to micrometers ($\\mu \\mathrm{m}$) by multiplying by $10^6$ and then rounded to three decimal places.\n\nIn the special case where $w_t = 0$ (as in Case 2), the goal becomes maximizing $-w_c \\mathrm{ATP}(x)$, which is equivalent to minimizing the metabolic cost $\\mathrm{ATP}(x)$. The function $\\mathrm{ATP}(x)$ can be shown to be convex, and its minimum is found by a similar derivative analysis, leading to $x_c^3 = K_2 / (2K_3)$. The general cubic solver correctly handles this case when $K_1 = 0$.\n\nIf $w_c = 0$, then $K_2=K_3=0$ and the utility becomes $U(x) = K_1 x$. If $w_t > 0$, this is a linearly increasing function, so the maximum is at the upper bound, $x^* = a + m_{\\max}$. If $w_t$ were also $0$, $U(x)=0$ for all $x$, and any choice is optimal; in this context, $m^*=0$ is the most sensible choice as it implies no investment for no benefit.\nThe provided test cases do not include $w_c = 0$, but the general algorithm remains robust.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal myelin thickness for a set of axonal parameters.\n    \"\"\"\n    # Fixed constants\n    C_V = 12.0e6  # s^-1\n    C_L = 200.0   # dimensionless\n    PI = np.pi\n    Q = 1.0e6     # ATP molecules per AP per node\n\n    # Test cases: (a, D, w_t, w_c, lambda, r, m_max)\n    # All lengths are in meters.\n    test_cases = [\n        (1.0e-6, 0.05, 1.0, 1.0e-6, 20.0, 1.0e20, 6.0e-6),\n        (1.0e-6, 0.05, 0.0, 1.0e-6, 20.0, 1.0e20, 6.0e-6),\n        (1.0e-6, 0.05, 10.0, 1.0e-6, 20.0, 1.0e20, 6.0e-6),\n        (1.0e-6, 0.05, 1.0, 5.0e-6, 20.0, 5.0e20, 6.0e-6),\n        (0.5e-6, 0.05, 1.0, 1.0e-6, 20.0, 1.0e20, 8.0e-6),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a, D, w_t, w_c, lambda_rate, r, m_max = case\n        \n        # The problem requires finding m* that maximizes U(m).\n        # U(m) = w_t * Δt⁻¹ - w_c * ATP(x), where x = a + m.\n        # This is equivalent to maximizing f(x) = K1*x - K2/x - K3*x^2.\n        # The derivative f'(x) = K1 + K2/x^2 - 2*K3*x.\n        # Setting f'(x) = 0 and multiplying by x^2 yields the cubic equation:\n        # 2*K3*x^3 - K1*x^2 - K2 = 0\n\n        # Handle the edge case where w_c is zero.\n        if w_c == 0:\n            if w_t > 0:\n                # U(x) = K1*x, which is maximized at the upper boundary.\n                x_star = a + m_max\n            else:\n                # U(x) = 0, any m is optimal. Choose m=0 for minimal cost.\n                x_star = a\n        else:\n            # Calculate composite constants K1, K2, K3\n            K1 = (w_t * C_V) / D\n            K2 = (w_c * lambda_rate * Q * D) / C_L\n            K3 = w_c * r * D * PI\n\n            # Coefficients of the cubic polynomial: p[0]x^3 + p[1]x^2 + p[2]x + p[3]\n            coeffs = [2 * K3, -K1, 0, -K2]\n            \n            # Find the roots of the cubic equation\n            roots = np.roots(coeffs)\n            \n            # The unconstrained optimum x_c is the single real, positive root.\n            x_c = 0.0\n            for root in roots:\n                if np.isreal(root) and root > 0:\n                    x_c = np.real(root)\n                    break\n            \n            # The constrained optimum x* must lie within the feasible range [a, a + m_max].\n            # Since the utility function is concave, we clamp the solution to this interval.\n            x_star = np.clip(x_c, a, a + m_max)\n\n        # Convert optimal fiber radius back to optimal myelin thickness\n        m_star_meters = x_star - a\n\n        # Convert to micrometers and round to three decimal places\n        m_star_micrometers = m_star_meters * 1e6\n        \n        # Format to ensure three decimal places are printed, even for .000\n        results.append(f\"{m_star_micrometers:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}