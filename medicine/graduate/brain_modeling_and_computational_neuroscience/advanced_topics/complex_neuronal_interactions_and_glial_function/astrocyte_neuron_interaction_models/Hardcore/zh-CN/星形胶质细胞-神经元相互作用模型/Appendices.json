{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个实践将为我们后续的学习打下基础，它构建了一个三方突触中基本相互作用的模型。我们将探讨星形胶质细胞释放的谷氨酸如何通过改变突触前释放概率来调节神经元之间的信号传递。这个练习旨在锻炼我们应用受体结合动力学来理解突触调控机制的能力 。",
            "id": "3962833",
            "problem": "在一个三方突触模型中，星形胶质细胞释放的谷氨酸与突触前代谢型谷氨酸受体 (mGluRs) 结合，从而降低了单个突触前末梢的囊泡释放概率。假设以下建模假设，这些假设基于标准的受体药理学和突触前调制：\n- 谷氨酸与突触前受体之间的结合处于快速平衡状态，其解离常数为 $K_d$，因此在稳态下，被占据受体的比例由结合与解离的平衡决定。\n- 在没有星形胶质细胞信号的情况下，突触前释放概率为 $p_0$。突触前mGluR的激活会以乘法方式下调 $p_0$，下调的幅度与受体占据比例成正比，其效能系数为 $0 \\le \\eta \\le 1$。\n\n仅使用这些假设和第一性原理，推导稳态突触前释放概率 $p$ 作为星形胶质细胞谷氨酸浓度 $[G]$、$K_d$、$p_0$ 和 $\\eta$ 的函数表达式，然后计算当突触前末梢附近微域中的星形胶质细胞谷氨酸浓度达到 $[G] = 1.2\\,\\mu\\mathrm{M}$ 时释放概率的变化量 $\\Delta p = p - p_0$。参数为 $p_0 = 0.25$，$\\eta = 0.40$，以及 $K_d = 1.5\\,\\mu\\mathrm{M}$。将最终数值 $\\Delta p$ 表示为四舍五入到四位有效数字的小数。最终答案中不要包含单位。",
            "solution": "该问题要求推导稳态突触前释放概率 $p$ 的表达式，并在特定条件下对该概率的变化量 $\\Delta p$ 进行数值计算。推导过程将基于受体-配体结合动力学原理和所提供的建模假设。\n\n首先，我们确定突触前代谢型谷氨酸受体 (mGluRs) 的占据比例。问题陈述，由其浓度 $[G]$ 表示的谷氨酸配体与这些受体的结合处于快速平衡状态。这个可逆的结合过程可以写成 $R + G \\rightleftharpoons RG$，其中 $R$ 是未结合的受体，$RG$ 是配体-受体复合物。该平衡由解离常数 $K_d$ 表征，根据质量作用定律定义为：\n$$ K_d = \\frac{[R][G]}{[RG]} $$\n其中 $[R]$ 和 $[RG]$ 分别是未结合受体和已结合受体的浓度。\n\n占据比例，记为 $\\theta$，是被占据受体浓度与受体总浓度 $[R]_{\\text{total}}$ 的比值。受体总浓度是未结合受体和已结合受体浓度之和：$[R]_{\\text{total}} = [R] + [RG]$。因此，占据比例为：\n$$ \\theta = \\frac{[RG]}{[R]_{\\text{total}}} = \\frac{[RG]}{[R] + [RG]} $$\n为了用 $[G]$ 和 $K_d$ 来表示 $\\theta$，我们首先重新整理 $K_d$ 的定义式来解出 $[R]$：\n$$ [R] = K_d \\frac{[RG]}{[G]} $$\n将这个 $[R]$ 的表达式代入 $\\theta$ 方程的分母中，得到：\n$$ \\theta = \\frac{[RG]}{K_d \\frac{[RG]}{[G]} + [RG]} $$\n从分母中提出公因子 $[RG]$，表达式简化为：\n$$ \\theta = \\frac{[RG]}{[RG] \\left( \\frac{K_d}{[G]} + 1 \\right)} = \\frac{1}{\\frac{K_d + [G]}{[G]}} $$\n这就得到了单个结合位点的标准Hill-Langmuir方程：\n$$ \\theta = \\frac{[G]}{[G] + K_d} $$\n该方程给出了稳态下被占据受体的比例，它是谷氨酸浓度 $[G]$ 和受体对谷氨酸的亲和力（与 $K_d$ 成反比）的函数。\n\n第二，我们建立受体占据比例与突触前释放概率之间的关系。问题明确指出，在没有谷氨酸的情况下，基础释放概率为 $p_0$。mGluR激活后，该概率被乘法性下调。下调的幅度与受体占据比例 $\\theta$ 成正比，效能系数为 $\\eta$，其中 $0 \\le \\eta \\le 1$。这意味着从基础概率的减少量 $p_0 - p$ 等于 $p_0$ 乘以 $\\eta \\theta$。这可以写成：\n$$ p = p_0 - p_0 (\\eta \\theta) $$\n提出公因子 $p_0$，我们得到被调制的释放概率 $p$ 的表达式：\n$$ p = p_0 (1 - \\eta \\theta) $$\n这个表达形式正确地描述了当 $[G]=0$ 时，$\\theta=0$，因此 $p=p_0$ 的情形。\n\n现在，我们将这两个结果结合起来，把 $\\theta$ 的表达式代入 $p$ 的方程中。这就得到了稳态突触前释放概率作为所有指定参数的函数的完整模型：\n$$ p([G]) = p_0 \\left( 1 - \\eta \\frac{[G]}{[G] + K_d} \\right) $$\n问题要求计算释放概率的变化量 $\\Delta p = p - p_0$。使用我们刚刚推导出的 $p$ 的表达式：\n$$ \\Delta p = p_0 \\left( 1 - \\eta \\frac{[G]}{[G] + K_d} \\right) - p_0 $$\n$$ \\Delta p = p_0 - p_0 \\eta \\frac{[G]}{[G] + K_d} - p_0 $$\n$$ \\Delta p = -p_0 \\eta \\frac{[G]}{[G] + K_d} $$\n这是释放概率变化量的最终解析表达式。\n\n最后，我们代入给定的数值来计算 $\\Delta p$：\n$p_0 = 0.25$\n$\\eta = 0.40$\n$K_d = 1.5\\,\\mu\\mathrm{M}$\n$[G] = 1.2\\,\\mu\\mathrm{M}$\n\n$[G]$ 和 $K_d$ 的单位相同，确保了它们的比值是一个无量纲量，正如占据比例项所要求的那样。\n$$ \\Delta p = -(0.25)(0.40) \\left( \\frac{1.2}{1.2 + 1.5} \\right) $$\n首先，计算 $p_0$ 和 $\\eta$ 的乘积：\n$$ (0.25)(0.40) = 0.1 $$\n接下来，计算分数项：\n$$ \\frac{1.2}{1.2 + 1.5} = \\frac{1.2}{2.7} = \\frac{12}{27} = \\frac{4}{9} $$\n现在，组合这些项：\n$$ \\Delta p = -0.1 \\times \\frac{4}{9} = -\\frac{0.4}{9} $$\n将此分数计算为小数：\n$$ \\Delta p \\approx -0.044444... $$\n问题要求将值四舍五入到四位有效数字。第一个有效数字是百分位上的4。数四位数字得到 $-0.04444$。由于第五位数字是4，我们舍去（即截断）。\n$$ \\Delta p = -0.04444 $$",
            "answer": "$$\\boxed{-0.04444}$$"
        },
        {
            "introduction": "在单突触相互作用的基础上，这个实践将深入探讨星形胶质细胞在清除神经递质方面至关重要的稳态作用。我们将建立一个模型，观察转运体对谷氨酸的吸收能力受损如何导致谷氨酸水平升高，并量化由此产生的神经元兴奋性毒性损伤风险。这个案例研究展示了计算模型如何将分子层面的功能障碍与病理学后果联系起来 。",
            "id": "3962904",
            "problem": "考虑一个点突触模型，其中星形胶质细胞兴奋性氨基酸转运体 (EAAT) 的摄取调节着细胞外谷氨酸浓度，该浓度记为 $G(t)$，单位为 $\\mu\\mathrm{M}$。假设快速的突触释放事件被时间平均为一个恒定的平均谷氨酸流入量 $J_{\\mathrm{rel}}$，流入一个有效的突触外体积。谷氨酸通过两个过程被清除：(i) 遵循米氏动力学的 EAAT 摄取，以及 (ii) 向大块细胞外空间的线性扩散清除。$G(t)$ 的质量平衡方程为\n$$\n\\frac{dG}{dt} \\;=\\; J_{\\mathrm{rel}} \\;-\\; \\frac{V_{\\max} \\, G}{K_m + G} \\;-\\; k_d \\, G,\n$$\n其中 $V_{\\max}$ 是最大 EAAT 摄取速率，$K_m$ 是转运体的米氏常数，$k_d$ 是扩散清除的有效一级速率常数。\n\n使用以下科学上合理的参数值：\n- $J_{\\mathrm{rel}} = 0.50\\,\\mu\\mathrm{M/s}$，\n- $K_m = 30\\,\\mu\\mathrm{M}$，\n- $k_d = 0.10\\,\\mathrm{s}^{-1}$。\n\n假设基线 EAAT 表达产生的 $V_{\\max}^{\\mathrm{base}} = 4.0\\,\\mu\\mathrm{M/s}$，而降低的 EAAT 表达使转运体密度减半，从而 $V_{\\max}^{\\mathrm{red}} = 2.0\\,\\mu\\mathrm{M/s}$。从上述质量平衡方程以及酶介导转运和质量守恒的原理出发，首先推导出一个用 $J_{\\mathrm{rel}}$、$K_m$、$k_d$ 和 $V_{\\max}$ 表示的显式稳态表达式 $G_{\\mathrm{ss}}(V_{\\max})$，该表达式求解 $\\frac{dG}{dt}=0$。然后，在 $V_{\\max}^{\\mathrm{red}}$ 处计算 $G_{\\mathrm{ss}}$，得到降低摄取后的稳态值 $G_{\\mathrm{ss}}^{\\mathrm{red}}$。\n\n为了评估兴奋性毒性风险，假设环境谷氨酸 $G_{\\mathrm{ss}}$ 对突触外 N-甲基-D-天冬氨酸 (NMDA) 受体进行持续性激活，并采用以下基于受体结合和欧姆定律的简化稳态电流模型：\n- 稳态开放分数是 $P_{\\mathrm{open}} = \\dfrac{G_{\\mathrm{ss}}}{K_d^{\\mathrm{NMDA}} + G_{\\mathrm{ss}}}$，其中 $K_d^{\\mathrm{NMDA}} = 2.0\\,\\mu\\mathrm{M}$，\n- NMDA 总电导是 $g_{\\mathrm{NMDA}} = 2.0\\,\\mathrm{nS}$，\n- 在该膜电位下的镁离子阻断因子是一个常数 $B = 0.23$，\n- 膜电位为 $V = -40\\,\\mathrm{mV}$，NMDA 反转电位为 $E_{\\mathrm{NMDA}} = 0\\,\\mathrm{mV}$。\n\n那么持续性 NMDA 电流为\n$$\nI_{\\mathrm{tonic}} \\;=\\; g_{\\mathrm{NMDA}} \\, B \\, P_{\\mathrm{open}} \\, (V - E_{\\mathrm{NMDA}}).\n$$\n将无量纲的兴奋性毒性风险指数定义为 $R = \\dfrac{I_{\\mathrm{tonic}}}{I_{\\mathrm{th}}}$，其中兴奋性毒性阈值电流为 $I_{\\mathrm{th}} = 10\\,\\mathrm{pA}$。使用上面得到的 $G_{\\mathrm{ss}}^{\\mathrm{red}}$，计算在 EAAT 表达降低情况下的风险指数 $R$，并仅报告此值。将最终结果表示为一个无量纲数，并四舍五入到 4 位有效数字。",
            "solution": "### 步骤 1：提取已知条件\n\n题目提供了以下数学模型和数据：\n\n**谷氨酸浓度 $G(t)$ 的质量平衡：**\n$$\n\\frac{dG}{dt} \\;=\\; J_{\\mathrm{rel}} \\;-\\; \\frac{V_{\\max} \\, G}{K_m + G} \\;-\\; k_d \\, G\n$$\n\n**谷氨酸动力学参数：**\n- 平均谷氨酸流入量：$J_{\\mathrm{rel}} = 0.50\\,\\mu\\mathrm{M/s}$\n- 米氏常数：$K_m = 30\\,\\mu\\mathrm{M}$\n- 扩散清除速率常数：$k_d = 0.10\\,\\mathrm{s}^{-1}$\n- 基线最大 EAAT 摄取速率：$V_{\\max}^{\\mathrm{base}} = 4.0\\,\\mu\\mathrm{M/s}$\n- 降低后的最大 EAAT 摄取速率：$V_{\\max}^{\\mathrm{red}} = 2.0\\,\\mu\\mathrm{M/s}$\n\n**持续性 NMDA 电流模型：**\n$$\nI_{\\mathrm{tonic}} \\;=\\; g_{\\mathrm{NMDA}} \\, B \\, P_{\\mathrm{open}} \\, (V - E_{\\mathrm{NMDA}})\n$$\n其中稳态开放分数为：\n$$\nP_{\\mathrm{open}} = \\dfrac{G_{\\mathrm{ss}}}{K_d^{\\mathrm{NMDA}} + G_{\\mathrm{ss}}}\n$$\n\n**电流计算参数：**\n- NMDA 受体亲和常数：$K_d^{\\mathrm{NMDA}} = 2.0\\,\\mu\\mathrm{M}$\n- NMDA 总电导：$g_{\\mathrm{NMDA}} = 2.0\\,\\mathrm{nS}$\n- 镁离子阻断因子：$B = 0.23$\n- 膜电位：$V = -40\\,\\mathrm{mV}$\n- NMDA 反转电位：$E_{\\mathrm{NMDA}} = 0\\,\\mathrm{mV}$\n\n**兴奋性毒性风险指数：**\n$$\nR = \\dfrac{I_{\\mathrm{tonic}}}{I_{\\mathrm{th}}}\n$$\n- 兴奋性毒性阈值电流：$I_{\\mathrm{th}} = 10\\,\\mathrm{pA}$\n\n**任务：**\n1.  推导显式稳态表达式 $G_{\\mathrm{ss}}(V_{\\max})$。\n2.  在 $V_{\\max}^{\\mathrm{red}}$ 处计算 $G_{\\mathrm{ss}}$，得到 $G_{\\mathrm{ss}}^{\\mathrm{red}}$。\n3.  使用 $G_{\\mathrm{ss}}^{\\mathrm{red}}$ 计算风险指数 $R$ 并四舍五入到 4 位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于生物物理学和计算神经科学的完善原理。谷氨酸浓度动力学模型结合了酶促转运（EAAT）的米氏动力学和扩散的一级动力学，这是一种标准方法。NMDA受体电流模型是基于受体饱和和欧姆定律的简化但常规的表示方法。所述参数值在科学上是合理的，并且其类型和数量级与相关文献中的值一致。\n-   **适定性**：问题结构清晰，要求进行一系列计算。求稳态谷氨酸浓度涉及求解一个二次方程，该方程有一个唯一的、物理上有效（正值）的解。所有后续计算都是显式的，并由所提供的公式和参数确定。该问题是自洽的，并导向一个唯一的数值答案。\n-   **客观性**：问题以精确、客观的数学语言表述。所有术语都有定义，问题的任何部分都不依赖于主观解释。\n-   **综合评估**：该问题不违反任何基本科学原理，可进行数学形式化，是完整的且内部一致的。它是星形胶质细胞-神经元相互作用建模领域的一个适定问题。\n\n### 步骤 3：结论与行动\n\n该问题有效。将提供完整解答。\n\n### 解题推导\n\n第一步是通过将质量平衡方程中的时间导数设为零，来推导稳态谷氨酸浓度 $G_{\\mathrm{ss}}$ 的表达式：\n$$\n\\frac{dG}{dt} = 0\n$$\n这得到了代数方程：\n$$\n0 \\;=\\; J_{\\mathrm{rel}} \\;-\\; \\frac{V_{\\max} \\, G_{\\mathrm{ss}}}{K_m + G_{\\mathrm{ss}}} \\;-\\; k_d \\, G_{\\mathrm{ss}}\n$$\n为了求解 $G_{\\mathrm{ss}}$，我们首先将所有项乘以 $(K_m + G_{\\mathrm{ss}})$ 以消去分数：\n$$\n0 \\;=\\; J_{\\mathrm{rel}}(K_m + G_{\\mathrm{ss}}) \\;-\\; V_{\\max} \\, G_{\\mathrm{ss}} \\;-\\; k_d \\, G_{\\mathrm{ss}}(K_m + G_{\\mathrm{ss}})\n$$\n展开各项，我们得到：\n$$\n0 \\;=\\; J_{\\mathrm{rel}}K_m + J_{\\mathrm{rel}}G_{\\mathrm{ss}} \\;-\\; V_{\\max} G_{\\mathrm{ss}} \\;-\\; k_d K_m G_{\\mathrm{ss}} \\;-\\; k_d G_{\\mathrm{ss}}^2\n$$\n我们可以将其重新排列成标准二次方程 $a x^2 + b x + c = 0$ 的形式，其中 $x = G_{\\mathrm{ss}}$：\n$$\nk_d G_{\\mathrm{ss}}^2 + (V_{\\max} + k_d K_m - J_{\\mathrm{rel}}) G_{\\mathrm{ss}} - J_{\\mathrm{rel}}K_m = 0\n$$\n该二次方程的系数为：\n- $a = k_d$\n- $b = V_{\\max} + k_d K_m - J_{\\mathrm{rel}}$\n- $c = -J_{\\mathrm{rel}}K_m$\n\n使用二次公式 $G_{\\mathrm{ss}} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，解为：\n$$\nG_{\\mathrm{ss}} = \\frac{-(V_{\\max} + k_d K_m - J_{\\mathrm{rel}}) \\pm \\sqrt{(V_{\\max} + k_d K_m - J_{\\mathrm{rel}})^2 - 4(k_d)(-J_{\\mathrm{rel}}K_m)}}{2k_d}\n$$\n简化平方根下的项：\n$$\nG_{\\mathrm{ss}}(V_{\\max}) = \\frac{-(V_{\\max} + k_d K_m - J_{\\mathrm{rel}}) \\pm \\sqrt{(V_{\\max} + k_d K_m - J_{\\mathrm{rel}})^2 + 4k_d J_{\\mathrm{rel}}K_m}}{2k_d}\n$$\n由于谷氨酸浓度必须是一个非负的物理量（$G_{\\mathrm{ss}} \\ge 0$），并且所有参数（$k_d, J_{\\mathrm{rel}}, K_m$）都是正的，我们必须选择能产生正值结果的根。项 $4k_d J_{\\mathrm{rel}}K_m$ 是正的，所以平方根项是实数，并且其绝对值大于 $|V_{\\max} + k_d K_m - J_{\\mathrm{rel}}|$。因此，在分子中选择减号将导致 $G_{\\mathrm{ss}}$ 为负值。所以，我们必须取加号以得到物理上有效的解。这就得到了显式的稳态表达式 $G_{\\mathrm{ss}}(V_{\\max})$。\n\n接下来，我们通过代入 $V_{\\max} = V_{\\max}^{\\mathrm{red}} = 2.0\\,\\mu\\mathrm{M/s}$ 和其他给定的参数值，来计算摄取降低情况下的 $G_{\\mathrm{ss}}$，即 $G_{\\mathrm{ss}}^{\\mathrm{red}}$：\n- $J_{\\mathrm{rel}} = 0.50\\,\\mu\\mathrm{M/s}$\n- $K_m = 30\\,\\mu\\mathrm{M}$\n- $k_d = 0.10\\,\\mathrm{s}^{-1}$\n\n二次方程的系数变为：\n- $a = 0.10$\n- $b = 2.0 + (0.10)(30) - 0.50 = 2.0 + 3.0 - 0.50 = 4.5$\n- $c = -(0.50)(30) = -15$\n\n将这些系数代入二次公式：\n$$\nG_{\\mathrm{ss}}^{\\mathrm{red}} = \\frac{-4.5 + \\sqrt{(4.5)^2 - 4(0.10)(-15)}}{2(0.10)}\n$$\n$$\nG_{\\mathrm{ss}}^{\\mathrm{red}} = \\frac{-4.5 + \\sqrt{20.25 + 6}}{0.2} = \\frac{-4.5 + \\sqrt{26.25}}{0.2}\n$$\n数值上，$\\sqrt{26.25} \\approx 5.123475$。\n$$\nG_{\\mathrm{ss}}^{\\mathrm{red}} = \\frac{-4.5 + 5.123475}{0.2} = \\frac{0.623475}{0.2} = 3.117375\\,\\mu\\mathrm{M}\n$$\n现在，我们使用这个稳态谷氨酸浓度和 $K_d^{\\mathrm{NMDA}} = 2.0\\,\\mu\\mathrm{M}$ 来计算 NMDA 受体开放分数 $P_{\\mathrm{open}}$：\n$$\nP_{\\mathrm{open}} = \\frac{G_{\\mathrm{ss}}^{\\mathrm{red}}}{K_d^{\\mathrm{NMDA}} + G_{\\mathrm{ss}}^{\\mathrm{red}}} = \\frac{3.117375}{2.0 + 3.117375} = \\frac{3.117375}{5.117375} \\approx 0.609190\n$$\n接下来，我们计算持续性 NMDA 电流 $I_{\\mathrm{tonic}}$。驱动力为 $(V - E_{\\mathrm{NMDA}}) = (-40\\,\\mathrm{mV} - 0\\,\\mathrm{mV}) = -40\\,\\mathrm{mV}$。\n$$\nI_{\\mathrm{tonic}} = g_{\\mathrm{NMDA}} \\, B \\, P_{\\mathrm{open}} \\, (V - E_{\\mathrm{NMDA}})\n$$\n$$\nI_{\\mathrm{tonic}} = (2.0\\,\\mathrm{nS})(0.23)(0.609190)(-40\\,\\mathrm{mV})\n$$\n注意到 $1\\,\\mathrm{nS} \\times 1\\,\\mathrm{mV} = 1\\,\\mathrm{pA}$：\n$$\nI_{\\mathrm{tonic}} = (2.0 \\times 0.23 \\times 0.609190 \\times -40)\\,\\mathrm{pA} \\approx -11.2091\\,\\mathrm{pA}\n$$\n负号表示内向电流（正电荷的净流入），这是兴奋性毒性的生物物理基础。兴奋性毒性风险指数 $R$ 定义为该电流与阈值电流 $I_{\\mathrm{th}} = 10\\,\\mathrm{pA}$ 的比值。由于风险指数是潜在危害的非负度量，并且阈值 $I_{\\mathrm{th}}$ 被给定为一个正值，物理上正确的解释是将内向电流的绝对值与阈值进行比较。\n$$\nR = \\frac{|I_{\\mathrm{tonic}}|}{I_{\\mathrm{th}}} = \\frac{|-11.2091\\,\\mathrm{pA}|}{10\\,\\mathrm{pA}} = 1.12091\n$$\n最后，题目要求将结果四舍五入到 4 位有效数字。\n$$\nR \\approx 1.121\n$$",
            "answer": "$$\n\\boxed{1.121}\n$$"
        },
        {
            "introduction": "我们最后的实践将从局部效应迈向网络层面的现象，这是一个重要的跨越。在这里，你将模拟一个环形神经网络，以研究星形胶质细胞缓冲细胞外钾离子的能力——这是其另一项关键的稳态功能——如何影响神经活动的稳定性与传播。这项高级模拟练习展示了星形胶质细胞如何塑造整个神经回路的涌现特性，例如癫痫样活动波的产生与抑制 。",
            "id": "3962880",
            "problem": "考虑一个由纯兴奋性神经元组成的环形网络，该网络通过细胞外钾离子 (K) 缓冲与星形胶质细胞相互作用。该环形网络被建模为一个具有 $N$ 个位点和间距 $\\Delta x$ 的一维周期性晶格，索引为 $i = 0,1,\\dots,N-1$。每个位点 $i$ 包含一个神经元放电率变量 $u_i(t)$ 和一个细胞外钾离子浓度变量 $k_i(t)$。星形胶质细胞的缓冲强度由一个速率参数 $\\gamma \\ge 0$ 表示。神经元间的相互作用是空间局部的、兴奋性的，细胞外钾离子沿环形网络扩散，并根据一个线性汇项被星形胶质细胞吸收。\n\n神经元动力学由一个 Wilson–Cowan 型的平均场放电率方程给出，该方程具有 S 型增益，并受细胞外钾离子调制。具体来说，对于 $i \\in \\{0,\\dots,N-1\\}$，\n$$\n\\tau \\frac{d u_i}{d t} = - u_i + S\\!\\left( J \\sum_{j=0}^{N-1} W_{ij} u_j - \\theta + \\beta \\left(k_i - k_0\\right) \\right),\n$$\n其中 $S(x) = \\frac{1}{1 + e^{-a x}}$ 是一个 S 型输入-输出函数，其斜率参数为 $a > 0$，$J > 0$ 是兴奋性耦合强度，$W_{ij}$ 是环上的一个归一化周期性高斯核，$\\theta$ 是一个有效阈值，$\\beta$ 是钾离子调制的增益，$k_0$ 是基线细胞外钾离子浓度。细胞外钾离子的动力学遵循一个离散的反应扩散方程，其产生项与神经元活动成正比，并包含线性的星形胶质细胞缓冲：\n$$\n\\frac{d k_i}{d t} = D_K \\frac{k_{i+1} - 2 k_i + k_{i-1}}{(\\Delta x)^2} - \\gamma \\left(k_i - k_0\\right) + \\eta u_i,\n$$\n边界条件为周期性边界条件 $k_{-1} \\equiv k_{N-1}$ 和 $k_{N} \\equiv k_{0}$。此处，$D_K$ 是有效扩散系数，$\\eta$ 缩放活动依赖的钾离子释放。离散拉普拉斯算子实现了离子守恒（扩散通量与浓度梯度成正比），而线性汇项 $-\\gamma(k_i - k_0)$ 模拟了星形胶质细胞围绕基线浓度的净吸收，源项 $\\eta u_i$ 模拟了与放电活动成正比的神经元释放。\n\n基本依据和假设：\n- 电荷和质量守恒导致了细胞外空间中离子的扩散动力学，离散地由二阶差分算子表示。\n- 星形胶质细胞缓冲被建模为向基线的一阶线性弛豫，这是对内向整流钾离子通道和转运体净吸收的标准近似。\n- 平均场神经元放电率动力学遵循 Wilson–Cowan 原理，其中放电率弛豫到一个 S 型函数，该函数的输入是突触兴奋和调节性钾离子效应的总和。\n\n环形核 $W_{ij}$ 由一个宽度为 $\\sigma_W$ 的周期性高斯函数定义：\n$$\nW_{ij} = \\frac{1}{Z} \\exp\\!\\left( - \\frac{d(i,j)^2}{2 \\sigma_W^2} \\right),\n$$\n其中 $d(i,j)$ 是最小环上距离，$Z$ 用于归一化，使得对每个 $i$ 都有 $\\sum_{j} W_{ij} = 1$。\n\n初始化：\n- 神经元活动初始时被定位为一个以索引 $i=0$ 为中心的高斯峰：\n$$\nu_i(0) = \\exp\\!\\left( -\\frac{d(i,0)^2}{2 \\sigma_0^2} \\right).\n$$\n- 细胞外钾离子浓度从基线开始：\n$$\nk_i(0) = k_0.\n$$\n\n传播速度和稳定性评估：\n- 传播速度通过神经元活动的阈值穿越时间来定义。对于选定的活动阈值 $u_{\\mathrm{th}}$，位点 $i$ 的首次穿越时间 $t_i$ 是使 $u_i(t)$ 从下方穿越 $u_{\\mathrm{th}}$ 的最小时间 $t$。如果穿越阈值的位点少于一半，则传播速度定义为 $0$。否则，计算在 $t_{i+1} - t_i > 0$ 的连续段上，相邻位点的平均正向穿越时间差 $\\Delta t$，并将速度定义为 $v = \\frac{\\Delta x}{\\Delta t}$，单位为位点/秒 (n/s)。\n- 稳定性被定义为一个布尔条件，即系统在爆发后返回到基线附近并保持有界。具体来说，如果在最终模拟时间 $T_{\\mathrm{end}}$，空间平均值满足 $\\frac{1}{N}\\sum_i u_i(T_{\\mathrm{end}}) \\le \\varepsilon_u$ 和 $\\frac{1}{N}\\sum_i |k_i(T_{\\mathrm{end}}) - k_0| \\le \\varepsilon_k$，并且在整个时间和空间上的最大活动没有饱和，即 $\\max_{i,t} u_i(t)  u_{\\max}$，则稳定性为真。否则，稳定性为假。\n\n实现要求：\n- 用 $N$ 个位点离散化环形网络，并使用合适的 ODE 求解器在时间区间 $[0, T_{\\mathrm{end}}]$ 内，将动力学实现为一个维度为 $2N$ 的常微分方程 (ODE) 系统。\n- 使用科学上合理的参数值，并以位点/秒 (n/s) 为单位报告速度。不使用角度；除了时间单位为秒和速度单位为 n/s 外，所有量纲均为无量纲。\n- 阈值穿越时间必须使用从下方单调穿越来计算，并在需要时在采样时间点之间使用线性插值。\n\n参数：\n- $N = 128$, $\\Delta x = 1$。\n- $\\tau = 0.02$ 秒, $a = 4.0$, $J = 1.1$, $\\theta = 1.5$, $\\beta = 1.0$, $k_0 = 3.5$, $\\sigma_W = 2.0$, $\\sigma_0 = 2.0$。\n- $D_K = 0.08$, $\\eta = 0.5$。\n- 阈值 $u_{\\mathrm{th}} = 0.5$，稳定性容差 $\\varepsilon_u = 0.05$, $\\varepsilon_k = 0.01$，饱和边界 $u_{\\max} = 0.99$。\n- 最终时间 $T_{\\mathrm{end}} = 1.5$ 秒。\n\n测试套件：\n评估系统在以下星形胶质细胞缓冲速率下的表现（涵盖基线、受损和极端边缘情况）：\n1. $\\gamma = 1.0$ (基线完整缓冲)。\n2. $\\gamma = 0.2$ (受损缓冲)。\n3. $\\gamma = 0.0$ (无缓冲，边缘情况)。\n\n程序输出规范：\n您的程序应为每个 $\\gamma$ 值模拟 ODE，计算该情况下的传播速度 $v$（单位为 n/s）和稳定性布尔值，并生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果，每个条目是一个形如 $[v,\\mathrm{stable}]$ 的双元素列表。例如，输出格式必须严格为：\n$$\n\\texttt{[[v\\_1,True],[v\\_2,False],[v\\_3,True]]}\n$$\n其中 $v_i$ 为浮点数，稳定性为布尔值。输出行中不得包含任何额外文本。",
            "solution": "用户提供了一个有效的问题陈述。该问题在计算神经科学原理上具有科学依据，具体而言，它使用了一个 Wilson-Cowan 型神经场模型，并与一个描述离子浓度的反应扩散方程相耦合。该模型是适定的，具有一套完整的参数、初始条件和明确定义的动力学，确保可以计算出唯一解。所有术语都得到了客观和算法化的定义。因此，我将继续提供完整的解决方案。\n\n该问题要求模拟一个由 $N$ 个神经元组成的环形网络，该网络与星形胶质细胞相互作用。$N$ 个位点中每一个的状态由一个神经元放电率 $u_i(t)$ 和一个细胞外钾离子浓度 $k_i(t)$ 来描述。因此，整个系统由一组 $2N$ 个耦合的常微分方程 (ODE) 描述。我们将对该系统进行数值求解，然后分析解，以确定不同星形胶质细胞钾离子缓冲率 $\\gamma$ 值下活动波的传播速度和网络的稳定性。\n\n**1. 模型实现与离散化**\n\n该系统由两组方程定义，适用于 $i = 0, \\dots, N-1$：\n$$\n\\tau \\frac{d u_i}{d t} = - u_i + S\\!\\left( J \\sum_{j=0}^{N-1} W_{ij} u_j - \\theta + \\beta \\left(k_i - k_0\\right) \\right)\n$$\n$$\n\\frac{d k_i}{d t} = D_K \\frac{k_{i+1} - 2 k_i + k_{i-1}}{(\\Delta x)^2} - \\gamma \\left(k_i - k_0\\right) + \\eta u_i\n$$\n为了在数值上实现这一点，我们将系统状态表示为一个大小为 $2N$ 的单个向量 $\\mathbf{y}(t)$，其中前 $N$ 个元素是放电率 $\\mathbf{u}(t) = [u_0, u_1, \\dots, u_{N-1}]^T$，后 $N$ 个元素是钾离子浓度 $\\mathbf{k}(t) = [k_0, k_1, \\dots, k_{N-1}]^T$。该 ODE 系统可以写成 $\\frac{d\\mathbf{y}}{dt} = F(t, \\mathbf{y})$。\n\n突触耦合项 $\\sum_{j=0}^{N-1} W_{ij} u_j$ 是一个矩阵-向量积 $\\mathbf{W}\\mathbf{u}$。权重矩阵 $\\mathbf{W}$ 基于周期性高斯核构建。在大小为 $N$ 的环上，距离 $d(i, j)$ 由 $d(i,j) = \\min(|i-j|, N - |i-j|)$ 给出。元素为 $W_{ij}$ 的矩阵 $\\mathbf{W}$ 经过预先计算和归一化，使得每行之和为 $1$。\n\n钾离子动力学的离散拉普拉斯算子 $\\frac{k_{i+1} - 2k_i + k_{i-1}}{(\\Delta x)^2}$，使用向量化操作可以高效实现。在周期性边界条件下，可以使用循环移位操作来访问整个向量 $\\mathbf{k}$ 的 $k_{i+1}$ 和 $k_{i-1}$，对此 `numpy.roll` 非常适用。\n\n**2. 数值积分**\n\n该 ODE 系统使用 `scipy.integrate` 库中的 `solve_ivp` 函数求解。该函数是一个鲁棒的通用 ODE 求解器。我们使用 'RK45' 方法（一个五(四)阶的显式 Runge-Kutta 方法），这是对此类非刚性问题的良好默认选择。我们启用了 `dense_output=True` 选项，这为解提供了一个插值函数。这对于精确确定速度计算所需的阈值穿越时间至关重要，因为它允许我们在积分区间内的任意点评估解，而不仅仅是在求解器采取的离散步骤上。为了进行分析，解在一个精细的、均匀的时间网格上进行采样。\n\n**3. 传播速度分析**\n\n传播速度 $v$ 是根据每个位点 $i$ 的神经元活动 $u_i(t)$ 首次从下方穿越阈值 $u_{\\mathrm{th}} = 0.5$ 的时间计算的。\n\n算法如下：\n1. 对于每个位点 $i \\in \\{0, \\dots, N-1\\}$，找到 $u_i(t)$ 穿越 $u_{\\mathrm{th}}$ 的首次时间 $t_i$。这是通过扫描精细时间序列 `u_sol[i, :]` 来完成的。当在时间步 $t_j$ 和 $t_{j+1}$ 之间检测到穿越时，使用线性插值来找到一个更精确的穿越时间：$t_{\\text{cross}} = t_j + (t_{j+1} - t_j) \\frac{u_{\\mathrm{th}} - u_i(t_j)}{u_i(t_{j+1}) - u_i(t_j)}$。如果没有发生穿越，$t_i$ 被视为无穷大。\n2. 如果穿越阈值的位点数少于网络大小的一半 ($N/2$)，则认为活动峰未能传播，速度 $v$ 定义为 $0$。\n3. 由于对称的设置（初始条件在 $i=0$，且核函数对称），我们预期会有两个波沿相反方向传播。我们分析沿正向传播的波（从 $i=0$ 到 $i=N/2$）。\n4. 我们计算时间差 $\\Delta t_i = t_{i+1} - t_i$，对于 $i=0, \\dots, N/2-1$。\n5. 根据问题的定义，我们只考虑“正向”传播步骤，即 $\\Delta t_i > 0$。这些正时间差的平均值给出了位点间的平均传播时间，$\\Delta t = \\langle \\Delta t_i \\rangle_{\\Delta t_i > 0}$。\n6. 最终速度为 $v = \\frac{\\Delta x}{\\Delta t}$。由于 $\\Delta x = 1$，这简化为 $v = 1/\\Delta t$。\n\n**4. 稳定性分析**\n\n稳定性是在模拟结束时（$T_{\\mathrm{end}} = 1.5$ 秒）确定的一个布尔属性。当且仅当以下所有三个条件都满足时，系统被认为是稳定的：\n1. 空间平均的神经元活动已返回到低基线：$\\frac{1}{N}\\sum_i u_i(T_{\\mathrm{end}}) \\le \\varepsilon_u$，其中 $\\varepsilon_u = 0.05$。\n2. 空间平均的钾离子浓度与其基线的偏差已稳定下来：$\\frac{1}{N}\\sum_i |k_i(T_{\\mathrm{end}}) - k_0| \\le \\varepsilon_k$，其中 $\\varepsilon_k = 0.01$。\n3. 在整个模拟过程中，神经元活动没有饱和：$\\max_{i,t} u_i(t)  u_{\\max}$，其中 $u_{\\max} = 0.99$。\n\n**5. 执行流程**\n\n主程序遍历指定的星形胶质细胞缓冲率 $\\gamma = \\{1.0, 0.2, 0.0\\}$。对于每个 $\\gamma$：\n1. 设置初始条件：以 $i=0$ 为中心的 $u_i(0)$ 高斯峰，以及均匀基线的 $k_i(0)$。\n2. 从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 对 ODE 系统进行积分。\n3. 将得到的 $\\mathbf{u}(t)$ 和 $\\mathbf{k}(t)$ 时间序列传递给分析函数，以计算传播速度 $v$ 和稳定性布尔值。\n4. 存储对 $[v, \\text{stability}]$。\n5. 最后，将所有 $\\gamma$ 值收集到的结果格式化为问题陈述中指定的精确字符串并打印。\n\n这种结构化的方法确保了模拟和分析完全按照描述执行，从而基于数值分析和计算建模的原理得出一个可验证和可复现的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the neuron-astrocyte ring model ODE system and analyzes\n    the propagation speed and stability for different astrocyte\n    potassium buffering rates.\n    \"\"\"\n    \n    # Define the test cases and parameters from the problem statement.\n    test_cases = [1.0, 0.2, 0.0]  # Values for gamma\n\n    # System parameters\n    N = 128\n    dx = 1.0\n    tau = 0.02\n    a = 4.0\n    J = 1.1\n    theta = 1.5\n    beta = 1.0\n    k0 = 3.5\n    sigma_W = 2.0\n    sigma_0 = 2.0\n    D_K = 0.08\n    eta = 0.5\n    \n    # Analysis parameters\n    u_th = 0.5\n    eps_u = 0.05\n    eps_k = 0.01\n    u_max = 0.99\n    \n    # Simulation parameters\n    T_end = 1.5\n    \n    # --- Pre-computation ---\n\n    # 1. Connectivity Matrix W\n    indices = np.arange(N)\n    dist_matrix = np.abs(indices[:, None] - indices[None, :])\n    dist_matrix = np.minimum(dist_matrix, N - dist_matrix)\n    W_unnormalized = np.exp(-(dist_matrix**2) / (2.0 * sigma_W**2))\n    Z = np.sum(W_unnormalized, axis=1, keepdims=True)\n    W = W_unnormalized / Z\n\n    # 2. Initial Conditions\n    dist_from_0 = np.minimum(indices, N - indices)\n    u_init = np.exp(-(dist_from_0**2) / (2.0 * sigma_0**2))\n    k_init = np.full(N, k0)\n    y0 = np.concatenate([u_init, k_init])\n\n    # --- ODE System and Analysis Functions ---\n\n    def dydt(t, y, gamma_val):\n        \"\"\"The ODE system function for the ring model.\"\"\"\n        u, k = y[:N], y[N:]\n        \n        # Neuronal dynamics (Wilson-Cowan type)\n        synaptic_input = J * (W @ u)\n        total_input = synaptic_input - theta + beta * (k - k0)\n        S_val = 1.0 / (1.0 + np.exp(-a * total_input))\n        dudt = (-u + S_val) / tau\n\n        # Potassium dynamics (Reaction-Diffusion)\n        laplacian_k = (np.roll(k, -1) - 2.0 * k + np.roll(k, 1)) / (dx**2)\n        dkdt = D_K * laplacian_k - gamma_val * (k - k0) + eta * u\n        \n        return np.concatenate([dudt, dkdt])\n\n    def calculate_speed(t_sol, u_sol):\n        \"\"\"Calculates propagation speed from threshold-crossing times.\"\"\"\n        crossing_times = np.full(N, np.inf)\n        for i in range(N):\n            u_i = u_sol[i, :]\n            # Find all indices where u_i crosses u_th from below\n            cross_indices = np.where((u_i[:-1]  u_th)  (u_i[1:] >= u_th))[0]\n            \n            if cross_indices.size > 0:\n                # Take the first crossing\n                j = cross_indices[0]\n                u1, u2 = u_i[j], u_i[j+1]\n                t1, t2 = t_sol[j], t_sol[j+1]\n                \n                # Perform linear interpolation for precise crossing time\n                if u2 > u1:\n                    t_cross = t1 + (t2 - t1) * (u_th - u1) / (u2 - u1)\n                    crossing_times[i] = t_cross\n        \n        num_crossings = np.sum(np.isfinite(crossing_times))\n        if num_crossings  N / 2:\n            return 0.0\n        \n        # Analyze right-propagating wave (i=0 to N/2) due to symmetry\n        time_diffs = []\n        for i in range(N // 2):\n            t_curr = crossing_times[i]\n            t_next = crossing_times[i+1]\n            # Collect positive time differences for forward propagation\n            if np.isfinite(t_curr) and np.isfinite(t_next) and (t_next > t_curr):\n                time_diffs.append(t_next - t_curr)\n        \n        if not time_diffs:\n            return 0.0\n        \n        avg_dt = np.mean(time_diffs)\n        if avg_dt = 0:\n            return 0.0\n        speed = dx / avg_dt\n        return speed\n\n    def check_stability(u_sol, k_sol):\n        \"\"\"Checks if the system meets the stability criteria.\"\"\"\n        u_final_avg = np.mean(u_sol[:, -1])\n        k_final_dev_avg = np.mean(np.abs(k_sol[:, -1] - k0))\n        u_global_max = np.max(u_sol)\n        \n        stable = (u_final_avg = eps_u) and \\\n                 (k_final_dev_avg = eps_k) and \\\n                 (u_global_max  u_max)\n        return stable\n\n    # --- Main Simulation Loop ---\n    \n    results = []\n    for gamma in test_cases:\n        # Solve the ODE system for the current gamma\n        sol = solve_ivp(\n            fun=dydt,\n            t_span=[0, T_end],\n            y0=y0,\n            method='RK45',\n            args=(gamma,),\n            dense_output=True,\n            rtol=1e-6,\n            atol=1e-6\n        )\n\n        # Evaluate the solution on a fine grid for analysis\n        t_eval = np.linspace(0, T_end, 2000)\n        y_eval = sol.sol(t_eval)\n        u_sol = y_eval[:N, :]\n        k_sol = y_eval[N:, :]\n\n        # Perform analyses\n        speed = calculate_speed(t_eval, u_sol)\n        stability = check_stability(u_sol, k_sol)\n        \n        # In Python, boolean True/False must be capitalized for the f-string to work\n        # The output format requires lowercase true/false\n        stability_str = \"True\" if stability else \"False\"\n        results.append(f\"[{speed},{stability_str}]\")\n\n    # Format and print the final output string exactly as specified.\n    final_string = f\"[{','.join(results)}]\"\n    print(final_string)\n\nsolve()\n```"
        }
    ]
}