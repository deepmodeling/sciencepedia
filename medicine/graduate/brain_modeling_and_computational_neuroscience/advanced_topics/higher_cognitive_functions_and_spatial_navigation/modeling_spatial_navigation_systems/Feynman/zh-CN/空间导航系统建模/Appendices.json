{
    "hands_on_practices": [
        {
            "introduction": "路径整合是大脑通过整合自身运动线索来追踪位置的基本机制。然而，用于获取速度和方向的感觉输入不可避免地带有噪声，导致估计误差随时间累积。第一个练习将探讨这种误差累积的动态过程，要求你推导位置不确定性如何作为时间和噪声水平的函数而增长，这是理解航位推算（dead-reckoning）局限性的关键第一步 。",
            "id": "3998099",
            "problem": "考虑一个在平面上导航的智能体的二维路径积分模型。该智能体的真实运动是沿 $x$ 轴以恒定前进速度 $v_{0}$ 运动，其真实航向角 $\\theta_{\\mathrm{true}}(t) = 0$ 对所有 $t \\in [0, T]$ 成立。该智能体通过对带有噪声的前进速度和偏航率的测量值进行积分来估计其位置。设测量到的前进速度为 $v_{m}(t) = v_{0} + n_{v}(t)$，其中 $n_{v}(t)$ 是零均值、平稳的高斯白噪声，其自相关函数为 $\\mathbb{E}[n_{v}(t)n_{v}(s)] = S_{v}\\,\\delta(t-s)$，其中 $S_{v} > 0$ 表示噪声强度（等效于双边功率谱密度（PSD）水平），$\\delta(\\cdot)$ 表示狄拉克δ分布。设测量到的偏航率为 $\\omega_{m}(t) = n_{\\omega}(t)$，其中 $n_{\\omega}(t)$ 是零均值、平稳的高斯白噪声，其自相关函数为 $\\mathbb{E}[n_{\\omega}(t)n_{\\omega}(s)] = S_{\\omega}\\,\\delta(t-s)$，且 $S_{\\omega} > 0$ 是其噪声强度。假设 $n_{v}$ 和 $n_{\\omega}$ 是独立的。\n\n该智能体通过对偏航率进行积分来形成其航向估计：$\\theta_{m}(t) = \\int_{0}^{t} \\omega_{m}(\\tau)\\,d\\tau$，初始条件为 $\\theta_{m}(0) = 0$。位置估计由下式给出\n$$\n\\mathbf{r}_{\\mathrm{est}}(T) = \\int_{0}^{T} v_{m}(t)\\,\\begin{pmatrix}\\cos\\theta_{m}(t) \\\\ \\sin\\theta_{m}(t) \\end{pmatrix}dt,\n$$\n且真实位置为 $\\mathbf{r}_{\\mathrm{true}}(T) = \\begin{pmatrix}v_{0}T \\\\ 0\\end{pmatrix}$。定义位置误差向量 $\\Delta\\mathbf{r}(T) = \\mathbf{r}_{\\mathrm{est}}(T) - \\mathbf{r}_{\\mathrm{true}}(T)$ 和径向均方位置误差\n$$\n\\mathcal{E}(T) = \\mathbb{E}\\left[\\|\\Delta\\mathbf{r}(T)\\|^{2}\\right] = \\mathbb{E}\\left[\\Delta x(T)^{2} + \\Delta y(T)^{2}\\right].\n$$\n\n在小角度近似下，仅保留 $\\theta_{m}(t)$ 的一阶项（即，使用 $\\cos\\theta_{m}(t) \\approx 1$ 和 $\\sin\\theta_{m}(t) \\approx \\theta_{m}(t)$，并忽略 $\\theta_{m}(t)$ 与 $n_{v}(t)$ 的所有乘积以及任何 $k \\geq 2$ 的 $\\theta_{m}(t)^{k}$ 次幂）。从这些假设和上述定义出发，推导 $\\mathbb{E}\\left[\\Delta x(T)^{2}\\right]$ 和 $\\mathbb{E}\\left[\\Delta y(T)^{2}\\right]$ 的时间依赖性的主导阶，从而获得 $\\mathcal{E}(T)$ 的一个闭式表达式，该表达式能识别出由速度噪声和航向噪声引起的关于 $T$ 的主导标度项。\n\n将最终的均方位置误差 $\\mathcal{E}(T)$ 以平方米为单位表示。最终答案必须是关于 $T$、$v_{0}$、$S_{v}$ 和 $S_{\\omega}$ 的单个闭式解析表达式。",
            "solution": "问题陈述被评估为有效。这是一个在计算神经科学和随机过程理论领域内定义明确的问题，其基础是路径积分的既定建模原则。给定条件是自洽、一致和客观的，允许进行严格的数学推导。\n\n目标是计算径向均方位置误差 $\\mathcal{E}(T) = \\mathbb{E}\\left[\\|\\Delta\\mathbf{r}(T)\\|^{2}\\right]$，其中 $\\Delta\\mathbf{r}(T) = \\mathbf{r}_{\\mathrm{est}}(T) - \\mathbf{r}_{\\mathrm{true}}(T)$。误差向量的分量是 $\\Delta x(T)$ 和 $\\Delta y(T)$。总均方误差是各分量均方误差之和：$\\mathcal{E}(T) = \\mathbb{E}[\\Delta x(T)^2] + \\mathbb{E}[\\Delta y(T)^2]$，因为交叉项 $\\mathbb{E}[\\Delta x(T) \\Delta y(T)]$ 将被证明为零。\n\n首先，我们使用提供的定义和近似来表示估计的位置向量 $\\mathbf{r}_{\\mathrm{est}}(T)$。\n估计的速度向量为 $v_{m}(t)\\,\\begin{pmatrix}\\cos\\theta_{m}(t) \\\\ \\sin\\theta_{m}(t) \\end{pmatrix}$。\n使用小角度近似 $\\cos\\theta_{m}(t) \\approx 1$ 和 $\\sin\\theta_{m}(t) \\approx \\theta_{m}(t)$，上式变为：\n$$\n(v_0 + n_v(t)) \\begin{pmatrix} 1 \\\\ \\theta_m(t) \\end{pmatrix} = \\begin{pmatrix} v_0 + n_v(t) \\\\ v_0 \\theta_m(t) + n_v(t)\\theta_m(t) \\end{pmatrix}\n$$\n问题指明我们忽略 $\\theta_m(t)$ 与 $n_v(t)$ 的乘积。因此，近似的速度向量为 $\\begin{pmatrix} v_0 + n_v(t) \\\\ v_0 \\theta_m(t) \\end{pmatrix}$。\n\n估计的位置是该速度向量的积分：\n$$\n\\mathbf{r}_{\\mathrm{est}}(T) = \\int_{0}^{T} \\begin{pmatrix} v_0 + n_v(t) \\\\ v_0 \\theta_m(t) \\end{pmatrix} dt = \\begin{pmatrix} v_0 T + \\int_0^T n_v(t) dt \\\\ v_0 \\int_0^T \\theta_m(t) dt \\end{pmatrix}\n$$\n真实位置由 $\\mathbf{r}_{\\mathrm{true}}(T) = \\begin{pmatrix}v_{0}T \\\\ 0\\end{pmatrix}$ 给出。\n因此，位置误差向量 $\\Delta \\mathbf{r}(T) = \\begin{pmatrix}\\Delta x(T) \\\\ \\Delta y(T) \\end{pmatrix}$ 为：\n$$\n\\Delta x(T) = \\left(v_0 T + \\int_0^T n_v(t) dt\\right) - v_0 T = \\int_0^T n_v(t) dt\n$$\n$$\n\\Delta y(T) = \\left(v_0 \\int_0^T \\theta_m(t) dt\\right) - 0 = v_0 \\int_0^T \\theta_m(t) dt\n$$\n现在，我们计算每个分量的均方误差。\n\n对于 $x$ 分量误差，$\\Delta x(T)$ 仅依赖于速度噪声 $n_v(t)$。\n$$\n\\mathbb{E}\\left[\\Delta x(T)^2\\right] = \\mathbb{E}\\left[\\left(\\int_0^T n_v(t) dt\\right) \\left(\\int_0^T n_v(s) ds\\right)\\right] = \\mathbb{E}\\left[\\int_0^T \\int_0^T n_v(t) n_v(s) dt ds\\right]\n$$\n根据期望的线性性质，我们可以将期望算子移到积分内部：\n$$\n\\mathbb{E}\\left[\\Delta x(T)^2\\right] = \\int_0^T \\int_0^T \\mathbb{E}\\left[n_v(t) n_v(s)\\right] dt ds\n$$\n使用给定的白噪声 $n_v$ 的自相关函数 $\\mathbb{E}[n_v(t)n_v(s)] = S_v \\delta(t-s)$：\n$$\n\\mathbb{E}\\left[\\Delta x(T)^2\\right] = \\int_0^T \\int_0^T S_v \\delta(t-s) dt ds = S_v \\int_0^T \\left(\\int_0^T \\delta(t-s) dt\\right) ds\n$$\n对于任何 $s \\in [0, T]$，关于 $t$ 的内层积分等于 $1$。\n$$\n\\mathbb{E}\\left[\\Delta x(T)^2\\right] = S_v \\int_0^T 1 \\, ds = S_v T\n$$\n该项表示由于前进速度测量中的噪声所导致的误差累积，它遵循随机游走（维纳过程），其方差随时间线性增长。\n\n对于 $y$ 分量误差，$\\Delta y(T)$ 依赖于估计的航向 $\\theta_m(t)$，而后者又依赖于偏航率噪声 $n_\\omega(t)$。\n$$\n\\mathbb{E}\\left[\\Delta y(T)^2\\right] = \\mathbb{E}\\left[\\left(v_0 \\int_0^T \\theta_m(t) dt\\right)^2\\right] = v_0^2 \\mathbb{E}\\left[\\int_0^T \\int_0^T \\theta_m(t) \\theta_m(s) dt ds\\right]\n$$\n$$\n\\mathbb{E}\\left[\\Delta y(T)^2\\right] = v_0^2 \\int_0^T \\int_0^T \\mathbb{E}\\left[\\theta_m(t) \\theta_m(s)\\right] dt ds\n$$\n我们必须首先求出估计的航向角的协方差函数 $\\mathbb{E}[\\theta_m(t)\\theta_m(s)]$。航向 $\\theta_m(t)$ 是偏航率噪声 $n_\\omega(t)$ 的时间积分：\n$$\n\\theta_m(t) = \\int_0^t n_\\omega(\\tau) d\\tau\n$$\n协方差为：\n$$\n\\mathbb{E}[\\theta_m(t)\\theta_m(s)] = \\mathbb{E}\\left[\\left(\\int_0^t n_\\omega(\\tau_1) d\\tau_1\\right) \\left(\\int_0^s n_\\omega(\\tau_2) d\\tau_2\\right)\\right] = \\int_0^t \\int_0^s \\mathbb{E}[n_\\omega(\\tau_1) n_\\omega(\\tau_2)] d\\tau_1 d\\tau_2\n$$\n使用自相关函数 $\\mathbb{E}[n_\\omega(\\tau_1)n_\\omega(\\tau_2)] = S_\\omega \\delta(\\tau_1-\\tau_2)$：\n$$\n\\mathbb{E}[\\theta_m(t)\\theta_m(s)] = \\int_0^s \\left(\\int_0^t S_\\omega \\delta(\\tau_1-\\tau_2) d\\tau_1\\right) d\\tau_2\n$$\n不失一般性地假设 $s \\le t$，对于 $\\tau_2 \\in [0,s]$，内层积分的值为 $S_\\omega$，否则为 $0$。\n$$\n\\mathbb{E}[\\theta_m(t)\\theta_m(s)] = \\int_0^s S_\\omega d\\tau_2 = S_\\omega s\n$$\n通常，$\\mathbb{E}[\\theta_m(t)\\theta_m(s)] = S_\\omega \\min(t,s)$。这表明 $\\theta_m(t)$ 是一个维纳过程。将此代回 $\\mathbb{E}[\\Delta y(T)^2]$ 的表达式中：\n$$\n\\mathbb{E}\\left[\\Delta y(T)^2\\right] = v_0^2 S_\\omega \\int_0^T \\int_0^T \\min(t,s) dt ds\n$$\n这个二重积分可以通过划分积分域来计算：\n$$\n\\int_0^T \\int_0^T \\min(t,s) dt ds = \\int_0^T \\left( \\int_0^t \\min(t,s) ds + \\int_t^T \\min(t,s) ds \\right) dt\n$$\n在第一个内层积分中，$s \\le t$，所以 $\\min(t,s) = s$。在第二个中，$s \\ge t$，所以 $\\min(t,s) = t$。\n$$\n\\int_0^T \\left( \\int_0^t s\\,ds + \\int_t^T t\\,ds \\right) dt = \\int_0^T \\left( \\left[\\frac{s^2}{2}\\right]_0^t + \\left[ts\\right]_t^T \\right) dt\n$$\n$$\n= \\int_0^T \\left( \\frac{t^2}{2} + t(T-t) \\right) dt = \\int_0^T \\left( \\frac{t^2}{2} + tT - t^2 \\right) dt = \\int_0^T \\left( tT - \\frac{t^2}{2} \\right) dt\n$$\n$$\n= \\left[ \\frac{t^2T}{2} - \\frac{t^3}{6} \\right]_0^T = \\frac{T^3}{2} - \\frac{T^3}{6} = \\frac{3T^3 - T^3}{6} = \\frac{2T^3}{6} = \\frac{T^3}{3}\n$$\n因此，$y$ 分量的均方误差为：\n$$\n\\mathbb{E}\\left[\\Delta y(T)^2\\right] = \\frac{1}{3} v_0^2 S_\\omega T^3\n$$\n该项代表了对航向误差积分所产生的误差，航向误差本身也像随机游走一样增长。由此产生的位置误差方差随时间的三次方增长。\n\n因为 $n_v$ 和 $n_\\omega$ 是独立的，所以 $\\Delta x(T)$（$n_v$ 的一个泛函）和 $\\Delta y(T)$（$n_\\omega$ 的一个泛函）也是独立的。由于噪声是零均值的，所以它们俩的均值也都是零。因此，协方差项 $\\mathbb{E}[\\Delta x(T) \\Delta y(T)] = \\mathbb{E}[\\Delta x(T)]\\mathbb{E}[\\Delta y(T)] = 0 \\cdot 0 = 0$。\n\n总径向均方位置误差 $\\mathcal{E}(T)$ 是方差之和：\n$$\n\\mathcal{E}(T) = \\mathbb{E}\\left[\\Delta x(T)^2\\right] + \\mathbb{E}\\left[\\Delta y(T)^2\\right] = S_v T + \\frac{1}{3} v_0^2 S_\\omega T^3\n$$\n该表达式揭示了两种噪声源对时间标度的不同贡献。速度噪声导致的误差方差随时间线性增长，而偏航率（航向）噪声导致的误差方差则以快得多的三次方式增长。对于长的导航时间 $T$，误差将主要由航向积分噪声主导。",
            "answer": "$$\n\\boxed{S_v T + \\frac{1}{3} v_0^2 S_\\omega T^3}\n$$"
        },
        {
            "introduction": "为了建立一个稳定的世界地图，智能体必须将自我中心（egocentric）的感官信息（例如，一个地标的距离和方位）转换到一个固定的参考坐标系（allocentric）中。本练习将研究来自不同感觉运动变量的噪声是如何通过这种几何变换进行传播的。通过分析在参考坐标系中产生的不确定性，你将深入理解坐标系的选择如何从根本上影响估计误差 。",
            "id": "3998156",
            "problem": "一个移动智能体在其空间导航系统中使用自我中心的传感器运动变量来估计视觉路标的异我中心位置。该智能体通过相对于其头中心框架的距离 $\\,\\rho\\,$ 和方位角 $\\,\\beta\\,$ 在自我中心极坐标中表示该路标，并且它还维持对其异我中心头部方向 $\\,\\phi\\,$ 的估计。在世界中心框架中表示的路标的异我中心笛卡尔坐标 $\\,x\\,$ 和 $\\,y\\,$ 由平滑映射 $\\,x = x(\\rho,\\beta,\\phi)\\,$ 和 $\\,y = y(\\rho,\\beta,\\phi)\\,$ 给出，该映射由一个角度为 $\\,\\phi\\,$ 的旋转和从极坐标到笛卡尔坐标的转换复合而成。假设自我中心的测量值受到均值为零、独立的小高斯噪声的干扰，其协方差矩阵为 $\\,\\Sigma_{\\text{ego}} = \\operatorname{diag}(\\sigma_{\\rho}^{2},\\,\\sigma_{\\beta}^{2},\\,\\sigma_{\\phi}^{2})\\,$，并且异我中心的估计是通过将带噪声的变量代入平滑映射中形成的。\n\n从小扰动如何通过可微变换传播的一阶近似出发，推导 $\\,\\begin{pmatrix}x \\\\ y\\end{pmatrix}\\,$ 的异我中心协方差。然后，解释坐标系的选择（自我中心极坐标加头部方向 vs. 异我中心笛卡尔坐标）如何塑造不确定性放大的主方向。最后，用 $\\,\\rho\\,$, $\\,\\sigma_{\\rho}^{2}\\,$, $\\,\\sigma_{\\beta}^{2}\\,$ 和 $\\,\\sigma_{\\phi}^{2}\\,$ 给出一个异我中心协方差矩阵最大特征值的单一闭式解析表达式。不需要四舍五入，最终表达式中不包含单位。",
            "solution": "该问题被认为是有效的，因为它在估计理论和计算神经科学方面有科学依据，问题设定良好，目标明确，信息充分，并且没有矛盾或含糊之处。\n\n任务是推导估计的路标位置的异我中心协方差矩阵，解释不确定性的结构，并找到该协方差矩阵的最大特征值。\n\n首先，我们建立从传感器运动变量 $(\\rho, \\beta, \\phi)$ 到异我中心笛卡尔坐标 $(x, y)$ 的显式变换。变量 $\\rho$ 是到路标的自我中心距离，$\\beta$ 是相对于智能体头部方向的自我中心方位角（角度），$\\phi$ 是异我中心的头部方向。路标相对于世界坐标系x轴的总异我中心角度是头部方向和自我中心方位角之和，即 $\\phi + \\beta$。从极坐标 $(\\text{距离}, \\text{角度})$ 到笛卡尔坐标 $(x,y)$ 的变换是 $x = \\text{距离} \\times \\cos(\\text{角度})$ 和 $y = \\text{距离} \\times \\sin(\\text{角度})$。应用此变换，我们得到映射：\n$$x(\\rho, \\beta, \\phi) = \\rho \\cos(\\phi + \\beta)$$\n$$y(\\rho, \\beta, \\phi) = \\rho \\sin(\\phi + \\beta)$$\n\n问题陈述自我中心变量受到均值为零、独立的小高斯噪声的干扰。设这些变量的向量为 $v = \\begin{pmatrix} \\rho \\\\ \\beta \\\\ \\phi \\end{pmatrix}$。这些变量的协方差矩阵为：\n$$\\Sigma_{\\text{ego}} = \\begin{pmatrix} \\sigma_{\\rho}^{2} & 0 & 0 \\\\ 0 & \\sigma_{\\beta}^{2} & 0 \\\\ 0 & 0 & \\sigma_{\\phi}^{2} \\end{pmatrix}$$\n为了求出异我中心坐标 $f(v) = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ 的协方差，我们使用不确定性传播的一阶近似。对于输入变量中的小扰动 $\\delta v$，输出中的扰动 $\\delta f$ 近似为 $\\delta f \\approx J \\delta v$，其中 $J$ 是变换 $f$ 的雅可比矩阵。输出的协方差矩阵 $\\Sigma_{\\text{allo}}$ 则由下式给出：\n$$\\Sigma_{\\text{allo}} = E[\\delta f \\delta f^T] \\approx E[J \\delta v (J \\delta v)^T] = J E[\\delta v \\delta v^T] J^T = J \\Sigma_{\\text{ego}} J^T$$\n雅可比矩阵 $J$ 是一个 $2 \\times 3$ 的偏导数矩阵：\n$$J = \\frac{\\partial(x, y)}{\\partial(\\rho, \\beta, \\phi)} =\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\rho} & \\frac{\\partial x}{\\partial \\beta} & \\frac{\\partial x}{\\partial \\phi} \\\\\n\\frac{\\partial y}{\\partial \\rho} & \\frac{\\partial y}{\\partial \\beta} & \\frac{\\partial y}{\\partial \\phi}\n\\end{pmatrix}$$\n我们计算所需的偏导数：\n$\\frac{\\partial x}{\\partial \\rho} = \\cos(\\phi + \\beta)$\n$\\frac{\\partial x}{\\partial \\beta} = -\\rho \\sin(\\phi + \\beta)$\n$\\frac{\\partial x}{\\partial \\phi} = -\\rho \\sin(\\phi + \\beta)$\n$\\frac{\\partial y}{\\partial \\rho} = \\sin(\\phi + \\beta)$\n$\\frac{\\partial y}{\\partial \\beta} = \\rho \\cos(\\phi + \\beta)$\n$\\frac{\\partial y}{\\partial \\phi} = \\rho \\cos(\\phi + \\beta)$\n\n因此，雅可比矩阵为：\n$$J = \\begin{pmatrix}\n\\cos(\\phi + \\beta) & -\\rho \\sin(\\phi + \\beta) & -\\rho \\sin(\\phi + \\beta) \\\\\n\\sin(\\phi + \\beta) & \\rho \\cos(\\phi + \\beta) & \\rho \\cos(\\phi + \\beta)\n\\end{pmatrix}$$\n现在我们计算乘积 $J\\Sigma_{\\text{ego}}J^T$。\n$$J\\Sigma_{\\text{ego}} = \\begin{pmatrix}\n\\sigma_{\\rho}^{2}\\cos(\\phi + \\beta) & -\\sigma_{\\beta}^{2}\\rho \\sin(\\phi + \\beta) & -\\sigma_{\\phi}^{2}\\rho \\sin(\\phi + \\beta) \\\\\n\\sigma_{\\rho}^{2}\\sin(\\phi + \\beta) & \\sigma_{\\beta}^{2}\\rho \\cos(\\phi + \\beta) & \\sigma_{\\phi}^{2}\\rho \\cos(\\phi + \\beta)\n\\end{pmatrix}$$\n$$\\Sigma_{\\text{allo}} = (J\\Sigma_{\\text{ego}}) \\begin{pmatrix}\n\\cos(\\phi + \\beta) & \\sin(\\phi + \\beta) \\\\\n-\\rho \\sin(\\phi + \\beta) & \\rho \\cos(\\phi + \\beta) \\\\\n-\\rho \\sin(\\phi + \\beta) & \\rho \\cos(\\phi + \\beta)\n\\end{pmatrix}$$\n令 $c = \\cos(\\phi+\\beta)$ 和 $s = \\sin(\\phi+\\beta)$。\n$\\Sigma_{\\text{allo}}$ 的 $(1,1)$ 元素是：\n$\\Sigma_{11} = (\\sigma_{\\rho}^{2}c)(c) + (-\\sigma_{\\beta}^{2}\\rho s)(-\\rho s) + (-\\sigma_{\\phi}^{2}\\rho s)(-\\rho s) = \\sigma_{\\rho}^{2}c^2 + (\\sigma_{\\beta}^{2}+\\sigma_{\\phi}^{2})\\rho^2 s^2$\n$\\Sigma_{\\text{allo}}$ 的 $(2,2)$ 元素是：\n$\\Sigma_{22} = (\\sigma_{\\rho}^{2}s)(s) + (\\sigma_{\\beta}^{2}\\rho c)(\\rho c) + (\\sigma_{\\phi}^{2}\\rho c)(\\rho c) = \\sigma_{\\rho}^{2}s^2 + (\\sigma_{\\beta}^{2}+\\sigma_{\\phi}^{2})\\rho^2 c^2$\n$\\Sigma_{\\text{allo}}$ 的 $(1,2)$（和 $(2,1)$）元素是：\n$\\Sigma_{12} = (\\sigma_{\\rho}^{2}c)(s) + (-\\sigma_{\\beta}^{2}\\rho s)(\\rho c) + (-\\sigma_{\\phi}^{2}\\rho s)(\\rho c) = (\\sigma_{\\rho}^{2} - (\\sigma_{\\beta}^{2}+\\sigma_{\\phi}^{2})\\rho^2)sc$\n这就完成了异我中心协方差矩阵的推导。\n\n为了进行解释，考虑一个与路标对齐的局部坐标系是很有启发性的。设该坐标系的 u 轴从智能体径向指向路标，v 轴为切向。该坐标系相对于世界坐标系旋转了角度 $\\theta = \\phi+\\beta$。在这个 $(u,v)$ 坐标系中，不确定性更容易描述。距离上的小误差 $\\delta\\rho$ 只会沿径向 u 轴引起误差。来自 $\\beta$ 或 $\\phi$ 的角度小误差会沿切向 v 轴引起误差。由于 $\\beta$ 和 $\\phi$ 是独立的，它们的和的方差是它们方差的和：$\\sigma_{\\text{angle}}^2 = \\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2}$。\n径向方向的方差贡献就是 $\\sigma_{u}^2 = \\sigma_{\\rho}^{2}$。\n切向方向的方差贡献是 $(\\rho \\times \\text{角度误差})^2$，所以 $\\sigma_{v}^2 = \\rho^2 \\sigma_{\\text{angle}}^2 = \\rho^2(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2})$。\n在这个径向-切向坐标系中，不确定性是解耦的，协方差矩阵是对角矩阵：\n$$\\Sigma_{uv} = \\begin{pmatrix} \\sigma_{\\rho}^{2} & 0 \\\\ 0 & \\rho^2(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2}) \\end{pmatrix}$$\n因此，不确定性的主方向与相对于智能体位置的径向和切向方向对齐。选择自我中心极坐标系是“自然的”，因为它的测量轴（距离和方位角）清晰地映射到这些不确定性的主要几何轴（径向和切向）上。异我中心协方差矩阵 $\\Sigma_{\\text{allo}}$ 只是这个对角矩阵 $\\Sigma_{uv}$ 旋转了角度 $\\phi+\\beta$ 的结果。\n\n最后，我们需要找到 $\\Sigma_{\\text{allo}}$ 的最大特征值。矩阵的特征值在旋转（基变换）下是不变的。因此，$\\Sigma_{\\text{allo}}$ 的特征值与更简单的对角矩阵 $\\Sigma_{uv}$ 的特征值相同。对于对角矩阵，特征值是其对角线上的元素：\n$$\\lambda_1 = \\sigma_{\\rho}^{2}$$\n$$\\lambda_2 = \\rho^2(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2})$$\n问题要求一个单一的闭式解析表达式来表示最大特征值 $\\lambda_{\\max}$。它由 $\\max(\\lambda_1, \\lambda_2)$ 给出。两个数 $a$ 和 $b$ 的最大值的一般公式是 $\\max(a, b) = \\frac{1}{2}(a+b+|a-b|)$。应用此公式，我们得到：\n$$\\lambda_{\\max} = \\frac{1}{2} \\left( \\sigma_{\\rho}^{2} + \\rho^2(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2}) + \\left|\\sigma_{\\rho}^{2} - \\rho^2(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2})\\right| \\right)$$\n这个表达式用给定的参数提供了最大特征值。",
            "answer": "$$\\boxed{\\frac{1}{2} \\left( \\sigma_{\\rho}^{2} + \\rho^{2}(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2}) + \\left|\\sigma_{\\rho}^{2} - \\rho^{2}(\\sigma_{\\beta}^{2} + \\sigma_{\\phi}^{2})\\right| \\right)}$$"
        },
        {
            "introduction": "大脑并非通过单个神经元，而是通过大量神经元的集体活动来表征头部方向等变量。最后的这个练习将要求你构建并分析一个群体向量解码器，这是一个从神经群体编码中读取信息的经典模型。通过理论推导和编程实现，你将探索非均匀的神经元调谐特性（生物系统中常见的特征）等因素如何引入系统性偏差并影响解码估计的精度 。",
            "id": "3998140",
            "problem": "你的任务是构建并分析一个用于头朝向细胞神经元群体中头朝向的线性群体向量解码器。假设有一个包含 $N$ 个神经元的群体，其偏好方向 $\\phi \\in [-\\pi,\\pi)$ 从单位圆上的概率密度 $p(\\phi)$ 中抽取。每个神经元在持续时间为 $T$ 秒的观测窗口内，作为一个独立的非齐次泊松过程发放脉冲。在固定的头朝向刺激 $\\theta_0 \\in [-\\pi,\\pi)$ 条件下，偏好方向为 $\\phi$ 的神经元的期望发放率（单位：脉冲/秒）由一个带有基线和乘性异质性的 von Mises 调谐曲线给出：\n- 平均发放率是 $\\lambda(\\phi \\mid \\theta_0) = b + m(\\phi)\\, \\exp\\!\\big(\\kappa \\cos(\\theta_0 - \\phi)\\big)$，其中 $b \\ge 0$ 是基线率，$m(\\phi) \\ge 0$ 是峰值调制，$\\kappa \\ge 0$ 是调谐集中度。\n- 调制为 $m(\\phi) = m \\big[1 + \\varepsilon \\cos(\\phi - \\mu_g)\\big]$，其中 $m \\ge 0$ 是全局调制，$\\varepsilon \\in [0,1)$ 控制异质性强度，$\\mu_g \\in [-\\pi,\\pi)$ 是异质性轴。\n\n线性群体向量解码器形成复数和\n$$\nS \\;=\\; \\sum_{i=1}^{N} r_i \\, e^{\\mathrm{i}\\,\\phi_i},\n$$\n其中 $r_i$ 是神经元 $i$ 在 $T$ 秒持续时间内的脉冲计数，$\\phi_i$ 是其偏好方向。解码的头朝向估计值为\n$$\n\\hat{\\theta} \\;=\\; \\mathrm{arg}\\, S \\;\\in\\; [-\\pi,\\pi),\n$$\n其中 $\\mathrm{arg}$ 返回复数的主辐角，并且环绕约定将角度映射到 $[-\\pi,\\pi)$ 区间内。\n\n需要使用且不能超出的基本原理：\n- 独立的泊松脉冲发放，其脉冲计数 $r_i \\sim \\mathrm{Poisson}\\big(\\Lambda(\\phi_i \\mid \\theta_0)\\big)$ 的均值等于方差，其中 $\\Lambda(\\phi \\mid \\theta_0) = T\\, \\lambda(\\phi \\mid \\theta_0)$。\n- 对于大群体求和使用大数定律，以 $p(\\phi)$ 下的期望代替经验平均值。\n- 对绕其均值扰动的随机向量的角度使用一阶微扰（delta 方法），对 $\\hat{\\theta}$ 围绕平均合向量方向的波动使用小角度近似。\n\n你的任务：\n1. 基于这些基本原理，推导表征解码器偏差和方差所需的大 $N$ 表达式：\n   - 定义平均复数群体向量\n     $$\n     \\mu \\;=\\; \\mathbb{E}[S] \\;=\\; N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0)\\, e^{\\mathrm{i}\\,\\phi}\\, p(\\phi)\\, d\\phi.\n     $$\n     定义渐近平均解码角度 $\\theta_\\star = \\mathrm{arg}\\,\\mu$ 和有符号偏差 $b_{\\mathrm{asym}} = \\mathrm{wrap}(\\theta_\\star - \\theta_0)$（单位为弧度），并环绕至 $[-\\pi,\\pi)$。\n   - 使用围绕 $\\theta_\\star$ 的一阶小角度近似，推导解码器的渐近方差可以表示为\n     $$\n     \\mathrm{Var}(\\hat{\\theta}) \\;\\approx\\; \\frac{N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0)\\, \\sin^2(\\phi - \\theta_\\star)\\, p(\\phi)\\, d\\phi}{\\lvert \\mu \\rvert^2}.\n     $$\n     分子源于独立的泊松变异性在与 $\\mu$ 正交方向上的投影，分母是平均向量幅值的平方。\n   - 对于这些积分，你不能使用任何封闭形式的特殊函数快捷方式；而是将它们表述为需要进行数值计算的积分。\n\n2. 实现一个程序，对于下面测试套件中的每一组参数，通过在 $\\phi \\in [-\\pi,\\pi)$ 上使用足够精细的数值积分来计算上述积分，从而数值计算渐近有符号偏差 $b_{\\mathrm{asym}}$ 和渐近方差 $\\mathrm{Var}(\\hat{\\theta})$。使用双精度算术和在 $[-\\pi,\\pi)$ 上至少有 $4096$ 个点的均匀网格。\n\n3. 角度单位：所有角度，包括 $\\theta_0$、$\\mu_d$ 和 $\\mu_g$，都必须以弧度为单位进行解释和返回。输出的偏差以弧度表示。方差是无单位的，因为它涉及弧度的平方。\n\n4. 偏好方向的群体密度：\n   - 均匀分布：$p(\\phi) = \\frac{1}{2\\pi}$。\n   - 非均匀 von Mises 分布：$p(\\phi) = \\dfrac{\\exp\\!\\big(\\kappa_d \\cos(\\phi - \\mu_d)\\big)}{2\\pi I_0(\\kappa_d)}$，其中 $I_0$ 是零阶第一类修正贝塞尔函数。你必须在网格上对 $p(\\phi)$ 进行数值归一化；不要使用 $I_0$ 的封闭形式。\n\n5. 测试套件。对于以下每种情况，计算并返回配对 $[b_{\\mathrm{asym}}, \\mathrm{Var}(\\hat{\\theta})]$：\n   - 情况 A（理想路径，均匀偏好方向）：\n     - $N = 60$，$\\theta_0 = 0.7$，$\\kappa = 2.0$，$b = 5.0$，$m = 15.0$，$\\varepsilon = 0.0$，$\\mu_g = 0.0$，$T = 0.25$，$p(\\phi)$ 均匀分布。\n   - 情况 B（非均匀偏好方向，聚集在 $0$ 附近）：\n     - $N = 100$，$\\theta_0 = 1.2$，$\\kappa = 2.0$，$b = 5.0$，$m = 10.0$，$\\varepsilon = 0.0$，$\\mu_g = 0.0$，$T = 0.5$，$p(\\phi)$ 为 von Mises 分布，参数为 $\\kappa_d = 1.5$，$\\mu_d = 0.0$。\n   - 情况 C（均匀偏好方向但增益异质）：\n     - $N = 80$，$\\theta_0 = -1.4$，$\\kappa = 1.2$，$b = 8.0$，$m = 12.0$，$\\varepsilon = 0.3$，$\\mu_g = 0.5$，$T = 0.4$，$p(\\phi)$ 均匀分布。\n   - 情况 D（接近环绕的边界情况，聚集在 $\\pi$ 附近）：\n     - $N = 120$，$\\theta_0 = 3.05$，$\\kappa = 3.0$，$b = 3.0$，$m = 9.0$，$\\varepsilon = 0.2$，$\\mu_g = 3.0$，$T = 0.3$，$p(\\phi)$ 为 von Mises 分布，参数为 $\\kappa_d = 2.0$，$\\mu_d = 3.0$。\n\n6. 最终输出格式。你的程序应生成单行输出，其中包含一个逗号分隔的列表，内含上述四种情况的 8 个浮点结果，按以下顺序展平并四舍五入到六位小数：\n$$\n\\big[ b_A,\\; v_A,\\; b_B,\\; v_B,\\; b_C,\\; v_C,\\; b_D,\\; v_D \\big],\n$$\n其中 $b_\\cdot$ 表示指定情况下的有符号偏差 $b_{\\mathrm{asym}}$，$v_\\cdot$ 表示指定情况下的 $\\mathrm{Var}(\\hat{\\theta})$，偏差单位为弧度，方差单位为弧度的平方。打印的行必须与括号格式完全匹配，值之间用逗号分隔，无附加文本。",
            "solution": "该问题具有科学依据，提法明确，客观，并包含足够的信息以获得唯一解。它描述了计算神经科学中用于分析群体编码性能的经典模型。任务涉及从第一性原理进行标准的、尽管详细的推导，然后进行数值实现。因此，该问题被认为是有效的。我们着手进行解答。\n\n解答分为两部分。首先，我们按要求提供群体向量解码器的渐近偏差和方差的理论推导。其次，我们对所得公式进行数值实现，以计算指定测试用例的这些量。\n\n### 理论推导\n\n**1. 模型详述**\n我们考虑一个由 $N$ 个头朝向神经元组成的群体。第 $i$ 个神经元的偏好方向是 $\\phi_i \\in [-\\pi, \\pi)$，从一个概率密度 $p(\\phi)$ 中抽取。对于一个真实的头朝向 $\\theta_0$，神经元 $i$ 作为一个独立的泊松过程发放脉冲，其速率（单位：脉冲/秒）由以下调谐曲线给出：\n$$\n\\lambda(\\phi_i \\mid \\theta_0) = b + m(\\phi_i)\\, \\exp\\!\\big(\\kappa \\cos(\\theta_0 - \\phi_i)\\big)\n$$\n峰值调制 $m(\\phi_i)$ 可能是异质的：\n$$\nm(\\phi_i) = m \\big[1 + \\varepsilon \\cos(\\phi_i - \\mu_g)\\big]\n$$\n在持续时间为 $T$ 的观测区间内，神经元 $i$ 的脉冲计数 $r_i$ 服从泊松分布，$r_i \\sim \\mathrm{Poisson}(\\Lambda(\\phi_i \\mid \\theta_0))$，其中平均脉冲计数为 $\\Lambda(\\phi \\mid \\theta_0) = T\\,\\lambda(\\phi \\mid \\theta_0)$。\n\n群体向量解码器从复数向量 $S$ 的角度估计头朝向 $\\hat{\\theta}$：\n$$\nS = \\sum_{i=1}^{N} r_i \\, e^{\\mathrm{i}\\,\\phi_i}, \\quad \\hat{\\theta} = \\mathrm{arg}\\,S\n$$\n\n**2. 渐近偏差**\n估计器的偏差是其期望值与真值 $\\theta_0$ 之间的差异。对于像 $\\hat{\\theta} = \\mathrm{arg}\\,S$ 这样的非线性估计器，标准做法是通过期望向量的角度 $\\mathrm{arg}\\,\\mathbb{E}[S]$ 来近似估计值的期望 $\\mathbb{E}[\\hat{\\theta}]$。这是大 $N$ 极限，在此极限下 $S$ 围绕其均值的波动变得很小。\n\n我们定义平均复数群体向量 $\\mu = \\mathbb{E}[S]$。利用期望的线性和神经元的独立性：\n$$\n\\mu = \\mathbb{E}\\left[\\sum_{i=1}^{N} r_i \\, e^{\\mathrm{i}\\,\\phi_i}\\right] = \\sum_{i=1}^{N} \\mathbb{E}[r_i] \\, e^{\\mathrm{i}\\,\\phi_i}\n$$\n神经元 $i$ 的脉冲计数的期望是 $\\mathbb{E}[r_i] = \\Lambda(\\phi_i \\mid \\theta_0)$。\n$$\n\\mu = \\sum_{i=1}^{N} \\Lambda(\\phi_i \\mid \\theta_0) \\, e^{\\mathrm{i}\\,\\phi_i}\n$$\n在大群体 $N$ 的极限下，大数定律允许我们用对偏好方向分布 $p(\\phi)$ 的期望来代替对神经元经验样本的求和。这将求和转换为了积分：\n$$\n\\mu = N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0)\\, e^{\\mathrm{i}\\,\\phi}\\, p(\\phi)\\, d\\phi\n$$\n这就是需要进行数值计算的积分。\n渐近解码角度被定义为该平均向量的角度：\n$$\n\\theta_\\star = \\mathrm{arg}\\,\\mu\n$$\n渐近有符号偏差 $b_{\\mathrm{asym}}$ 是此渐近角度与真实刺激角度之间的环绕差，确保结果在 $[-\\pi, \\pi)$ 内：\n$$\nb_{\\mathrm{asym}} = \\mathrm{wrap}(\\theta_\\star - \\theta_0) \\equiv (\\theta_\\star - \\theta_0 + \\pi) \\pmod{2\\pi} - \\pi\n$$\n\n**3. 渐近方差**\n估计器的方差 $\\mathrm{Var}(\\hat{\\theta})$ 使用一阶微扰近似（也称为 delta 方法）进行分析。我们考虑群体向量在其均值附近的小波动 $\\delta S = S - \\mu$。解码角度为 $\\hat{\\theta} = \\arg(\\mu + \\delta S)$。\n\n对于小的 $\\delta S$，角度的变化 $\\delta\\hat{\\theta} = \\hat{\\theta} - \\theta_\\star$ 主要由与平均向量 $\\mu$ 正交的 $\\delta S$ 分量引起。记 $\\mu = |\\mu| e^{\\mathrm{i}\\theta_\\star}$，我们可以将角度波动近似为波动向量 $\\delta S$ 在与 $\\mu$ 正交方向上的投影除以 $\\mu$ 的幅值。设 $\\delta S = \\delta S_x + \\mathrm{i}\\delta S_y$。 $\\mu$ 的方向向量是 $(\\cos\\theta_\\star, \\sin\\theta_\\star)$，正交方向是 $(-\\sin\\theta_\\star, \\cos\\theta_\\star)$。角度的波动是：\n$$\n\\delta\\hat{\\theta} \\approx \\frac{\\delta S_y \\cos\\theta_\\star - \\delta S_x \\sin\\theta_\\star}{|\\mu|}\n$$\n方差为 $\\mathrm{Var}(\\hat{\\theta}) = \\mathbb{E}[(\\delta\\hat{\\theta})^2]$（因为一阶近似下 $\\mathbb{E}[\\delta\\hat{\\theta}] \\approx 0$）。\n$$\n\\mathrm{Var}(\\hat{\\theta}) \\approx \\frac{1}{|\\mu|^2} \\mathrm{Var}\\left( S_y \\cos\\theta_\\star - S_x \\sin\\theta_\\star \\right)\n$$\n其中 $S_x = \\sum_i r_i \\cos\\phi_i$ 和 $S_y = \\sum_i r_i \\sin\\phi_i$。线性组合的方差是：\n$$\n\\mathrm{Var}\\left( S_y \\cos\\theta_\\star - S_x \\sin\\theta_\\star \\right) = \\cos^2\\theta_\\star \\mathrm{Var}(S_y) + \\sin^2\\theta_\\star \\mathrm{Var}(S_x) - 2\\sin\\theta_\\star\\cos\\theta_\\star \\mathrm{Cov}(S_x, S_y)\n$$\n由于神经元是独立的，$S_x$ 和 $S_y$ 的方差和协方差是来自单个神经元贡献的总和：\n$$\n\\mathrm{Var}(S_x) = \\sum_{i=1}^N \\mathrm{Var}(r_i \\cos\\phi_i) = \\sum_{i=1}^N \\cos^2\\phi_i \\mathrm{Var}(r_i)\n$$\n$$\n\\mathrm{Var}(S_y) = \\sum_{i=1}^N \\mathrm{Var}(r_i \\sin\\phi_i) = \\sum_{i=1}^N \\sin^2\\phi_i \\mathrm{Var}(r_i)\n$$\n$$\n\\mathrm{Cov}(S_x, S_y) = \\sum_{i=1}^N \\mathrm{Cov}(r_i \\cos\\phi_i, r_i \\sin\\phi_i) = \\sum_{i=1}^N \\cos\\phi_i \\sin\\phi_i \\mathrm{Var}(r_i)\n$$\n泊松分布的一个关键性质是方差等于均值：$\\mathrm{Var}(r_i) = \\mathbb{E}[r_i] = \\Lambda(\\phi_i \\mid \\theta_0)$。代入此式并通过将求和转换为积分来取大 $N$ 极限：\n$$\n\\mathrm{Var}(S_x) \\approx N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0) \\cos^2\\phi \\, p(\\phi) \\, d\\phi\n$$\n$$\n\\mathrm{Var}(S_y) \\approx N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0) \\sin^2\\phi \\, p(\\phi) \\, d\\phi\n$$\n$$\n\\mathrm{Cov}(S_x, S_y) \\approx N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0) \\cos\\phi \\sin\\phi \\, p(\\phi) \\, d\\phi\n$$\n将这些代回 $\\mathrm{Var}(S_y \\cos\\theta_\\star - S_x \\sin\\theta_\\star)$ 的表达式中：\n\\begin{align*}\n\\text{分子} &= N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0) p(\\phi) \\left[ \\cos^2\\theta_\\star \\sin^2\\phi + \\sin^2\\theta_\\star \\cos^2\\phi - 2\\sin\\theta_\\star\\cos\\theta_\\star\\cos\\phi\\sin\\phi \\right] d\\phi \\\\\n&= N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0) p(\\phi) \\left( \\sin\\phi\\cos\\theta_\\star - \\cos\\phi\\sin\\theta_\\star \\right)^2 d\\phi \\\\\n&= N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0) p(\\phi) \\sin^2(\\phi - \\theta_\\star) d\\phi\n\\end{align*}\n最后，渐近方差是这个分子与平均向量幅值的平方 $|\\mu|^2$ 之比：\n$$\n\\mathrm{Var}(\\hat{\\theta}) \\approx \\frac{N \\int_{-\\pi}^{\\pi} \\Lambda(\\phi \\mid \\theta_0)\\, \\sin^2(\\phi - \\theta_\\star)\\, p(\\phi)\\, d\\phi}{\\lvert \\mu \\rvert^2}\n$$\n这就完成了所需表达式的推导。它们现在可以用于数值实现了。",
            "answer": "[0.000000,0.003929,-0.106540,0.010471,-0.033100,0.026727,-0.023255,0.010196]"
        }
    ]
}