{
    "hands_on_practices": [
        {
            "introduction": "海马体位置细胞最显著的特征是其空间选择性放电，但这一个标志性的特性是如何从根本上产生的呢？本练习将引导你通过一个经典的电导 leaky integrate-and-fire (LIF) 模型，从生物物理的第一性原理出发，构建一个位置野。你将探索空间调谐的兴奋性输入和背景抑制性输入如何相互作用，共同决定神经元的膜电位，并最终通过一个尖峰放电阈值机制，塑造出我们所观察到的位置野 。这个实践将为你提供关于位置细胞调谐特性如何在单细胞层面形成的具体而深刻的物理直觉。",
            "id": "3989050",
            "problem": "考虑一个单室、基于电导的漏电积分放电神经元，用于模拟海马体位置细胞。该神经元接收一组突触电导，这些电导取决于动物的空间位置 $\\mathbf{x}$。我们关注一个一维轨道，其位置 $x \\in [0,L]$。假设动物移动得足够慢，以至于相对于位置而言，膜电位可以被视为处于准稳态机制。该神经元具有被动漏电特性，其特征是漏电电导 $g_{\\mathrm{L}}$ 和漏电反转电位 $E_{\\mathrm{L}}$。它接收一个兴奋性电导 $g_{\\mathrm{E}}(x)$（其兴奋性反转电位为 $E_{\\mathrm{E}}$）和一个抑制性电导 $g_{\\mathrm{I}}(x)$（其抑制性反转电位为 $E_{\\mathrm{I}}$）。假设抑制性电导在空间上是均匀的，即 $g_{\\mathrm{I}}(x) \\equiv g_{\\mathrm{I0}}$，而兴奋性电导在空间上呈高斯函数调谐\n$$\ng_{\\mathrm{E}}(x) = g_{\\mathrm{E0}} \\exp\\!\\left(-\\frac{(x - x_0)^2}{2 \\sigma^2}\\right),\n$$\n其中 $g_{\\mathrm{E0}}$ 是峰值电导，$x_0$ 是位置场的中心，$\\sigma$ 是调谐的空间尺度（标准差）。当膜电位 $V(t)$ 超过一个固定的阈值 $V_{\\mathrm{th}}$ 时，神经元发放脉冲。\n\n从基于电导的漏电积分放电常微分方程出发\n$$\nC_{\\mathrm{m}} \\frac{dV}{dt} = -g_{\\mathrm{L}} \\left(V - E_{\\mathrm{L}}\\right) - g_{\\mathrm{E}}\\!\\left(x(t)\\right)\\left(V - E_{\\mathrm{E}}\\right) - g_{\\mathrm{I0}} \\left(V - E_{\\mathrm{I}}\\right),\n$$\n其中 $C_{\\mathrm{m}}$ 是膜电容，请在 $x(t)$ 的准稳态假设下，从第一性原理推导稳态膜电位 $V_{\\mathrm{ss}}(x)$ 的表达式，并得到使 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 成立的关于 $x$ 的条件。证明这种阈值化处理如何在 $x_0$ 周围定义一个连续的空间区间，并由此推导出位置场宽度 $w$（单位为米）的公式。您的推导必须处理所有边界情况，包括不发放脉冲（$w=0$）以及阈值过低导致在整个轨道上都发放脉冲（$w=L$）的情况。仅使用所述的物理假设和给定的定义。\n\n您的程序必须实现所推导的表达式，计算下面列出的每个测试用例的位置场宽度 $w$，并以米为单位打印宽度。如果推导出的宽度超过轨道长度 $L$，则将其裁剪为 $L$。如果推导出的条件意味着没有超过阈值，则将宽度设置为 $0$。所有量都必须使用国际单位制（SI）处理：电导单位为西门子，电压单位为伏特，位置和宽度单位为米。输出必须是单行，包含一个用方括号括起来的逗号分隔的数值结果列表，其中每个宽度都格式化为十进制数。\n\n使用以下参数集测试套件来评估您的实现。每个用例提供 $(L, g_{\\mathrm{L}}, g_{\\mathrm{I0}}, g_{\\mathrm{E0}}, E_{\\mathrm{L}}, E_{\\mathrm{I}}, E_{\\mathrm{E}}, V_{\\mathrm{th}}, \\sigma, x_0)$:\n\n- 用例 1（具有中等位置场的一般情况）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.050,\\ 0.1,\\ 1.0)$\n- 用例 2（更强的抑制，更窄的位置场）：$(2.0,\\ 2\\times 10^{-8},\\ 3\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.050,\\ 0.1,\\ 1.0)$\n- 用例 3（高阈值导致不发放脉冲）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.010,\\ 0.1,\\ 1.0)$\n- 用例 4（低阈值，整个轨道激活）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.070,\\ 0.1,\\ 1.0)$\n- 用例 5（更宽的兴奋性调谐，更宽的位置场）：$(2.0,\\ 2\\times 10^{-8},\\ 1\\times 10^{-8},\\ 5\\times 10^{-8},\\ -0.065,\\ -0.070,\\ 0.0,\\ -0.050,\\ 0.2,\\ 1.0)$\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如，“[w1,w2,w3,w4,w5]”，其中每个 $w$ 是相应情况下计算出的位置场宽度（单位为米）。",
            "solution": "从基于电导的漏电积分放电动力学开始\n$$\nC_{\\mathrm{m}} \\frac{dV}{dt} = -g_{\\mathrm{L}} \\left(V - E_{\\mathrm{L}}\\right) - g_{\\mathrm{E}}(x(t))\\left(V - E_{\\mathrm{E}}\\right) - g_{\\mathrm{I0}} \\left(V - E_{\\mathrm{I}}\\right).\n$$\n该方程结合了漏电流和突触电流，每个电流都表示为电导乘以驱动力。当膜电位 $V(t)$ 达到阈值 $V_{\\mathrm{th}}$ 时，神经元发放脉冲，之后电压被重置（稳态分析不需要重置动力学）。\n\n在准稳态假设下，我们将位置 $x$ 视为一个参数，并对每个位置 $x$ 处的电压动力学设置 $dV/dt \\approx 0$。求解稳态膜电位 $V_{\\mathrm{ss}}(x)$ 可得\n$$\n0 = -g_{\\mathrm{L}} \\left(V_{\\mathrm{ss}} - E_{\\mathrm{L}}\\right) - g_{\\mathrm{E}}(x)\\left(V_{\\mathrm{ss}} - E_{\\mathrm{E}}\\right) - g_{\\mathrm{I0}} \\left(V_{\\mathrm{ss}} - E_{\\mathrm{I}}\\right),\n$$\n可以重新整理为\n$$\n\\left(g_{\\mathrm{L}} + g_{\\mathrm{E}}(x) + g_{\\mathrm{I0}}\\right) V_{\\mathrm{ss}}(x) = g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{E}}(x) E_{\\mathrm{E}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}.\n$$\n因此，\n$$\nV_{\\mathrm{ss}}(x) = \\frac{g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{E}}(x) E_{\\mathrm{E}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}}{g_{\\mathrm{L}} + g_{\\mathrm{E}}(x) + g_{\\mathrm{I0}}}.\n$$\n\n当 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 时，会发生脉冲发放。定义常数\n$$\nA = g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}, \\quad B = E_{\\mathrm{E}}, \\quad C = g_{\\mathrm{L}} + g_{\\mathrm{I0}},\n$$\n以便\n$$\nV_{\\mathrm{ss}}(x) = \\frac{A + B\\, g_{\\mathrm{E}}(x)}{C + g_{\\mathrm{E}}(x)}.\n$$\n阈值条件 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 变为\n$$\n\\frac{A + B\\, g_{\\mathrm{E}}(x)}{C + g_{\\mathrm{E}}(x)} \\ge V_{\\mathrm{th}}.\n$$\n将两边同时乘以 $C + g_{\\mathrm{E}}(x)$（对于非负电导，该项为正）得到\n$$\nA + B\\, g_{\\mathrm{E}}(x) \\ge V_{\\mathrm{th}} C + V_{\\mathrm{th}} g_{\\mathrm{E}}(x).\n$$\n重新整理关于 $g_{\\mathrm{E}}(x)$ 的项：\n$$\n\\left(B - V_{\\mathrm{th}}\\right) g_{\\mathrm{E}}(x) \\ge V_{\\mathrm{th}} C - A.\n$$\n当 $\\left(B - V_{\\mathrm{th}}\\right) > 0$ 时（这在物理上是合理的，因为兴奋性反转电位通常高于阈值），不等式简化为\n$$\ng_{\\mathrm{E}}(x) \\ge g_{\\mathrm{req}} \\equiv \\frac{V_{\\mathrm{th}} C - A}{B - V_{\\mathrm{th}}}.\n$$\n否则，如果 $\\left(B - V_{\\mathrm{th}}\\right) \\le 0$，兴奋性输入无法将膜电位提升至阈值以上，因为兴奋性驱动力不足。在该情况下，条件简化为检查基线稳态（$g_{\\mathrm{E}}(x) \\approx 0$），即\n$$\nV_{\\mathrm{base}} \\equiv \\frac{A}{C} \\ge V_{\\mathrm{th}}.\n$$\n是否成立。如果 $V_{\\mathrm{base}} \\ge V_{\\mathrm{th}}$，神经元在所有位置都将高于阈值；如果 $V_{\\mathrm{base}}  V_{\\mathrm{th}}$，神经元将永远不会达到阈值。\n\n对于高斯兴奋性电导，\n$$\ng_{\\mathrm{E}}(x) = g_{\\mathrm{E0}} \\exp\\!\\left(-\\frac{(x - x_0)^2}{2 \\sigma^2}\\right),\n$$\n不等式 $g_{\\mathrm{E}}(x) \\ge g_{\\mathrm{req}}$ 变为\n$$\n\\exp\\!\\left(-\\frac{(x - x_0)^2}{2 \\sigma^2}\\right) \\ge \\frac{g_{\\mathrm{req}}}{g_{\\mathrm{E0}}}.\n$$\n对两边取自然对数（注意指数项为正，且右侧必须为正才能有解），我们得到\n$$\n-\\frac{(x - x_0)^2}{2 \\sigma^2} \\ge \\ln\\!\\left(\\frac{g_{\\mathrm{req}}}{g_{\\mathrm{E0}}}\\right),\n$$\n得出\n$$\n(x - x_0)^2 \\le 2 \\sigma^2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right).\n$$\n因此，只要 $0  g_{\\mathrm{req}}  g_{\\mathrm{E0}}$，满足 $V_{\\mathrm{ss}}(x) \\ge V_{\\mathrm{th}}$ 的位置集合就是区间\n$$\nx \\in \\left[x_0 - \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)},\\ x_0 + \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)}\\right].\n$$\n于是，位置场宽度 $w$ 为\n$$\nw = 2 \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)}.\n$$\n\n边界和边缘情况：\n- 如果 $g_{\\mathrm{req}} \\ge g_{\\mathrm{E0}}$，则没有位置满足该不等式，$w = 0$。\n- 如果 $g_{\\mathrm{req}} \\le 0$，则任何非负的兴奋性电导都足以达到阈值。在这种情况下，即使远离中心，神经元也处于或高于阈值，位置场覆盖整个轨道，得到 $w = L$。\n- 如果 $\\left(B - V_{\\mathrm{th}}\\right) \\le 0$，则评估 $V_{\\mathrm{base}} = A/C$。如果 $V_{\\mathrm{base}} \\ge V_{\\mathrm{th}}$，设置 $w = L$；否则，设置 $w = 0$。\n- 如果计算出的宽度 $w$ 超过物理轨道长度 $L$，则将其裁剪为 $w = L$。\n\n每个测试用例的算法步骤：\n1. 读取 $(L, g_{\\mathrm{L}}, g_{\\mathrm{I0}}, g_{\\mathrm{E0}}, E_{\\mathrm{L}}, E_{\\mathrm{I}}, E_{\\mathrm{E}}, V_{\\mathrm{th}}, \\sigma, x_0)$。\n2. 计算 $A = g_{\\mathrm{L}} E_{\\mathrm{L}} + g_{\\mathrm{I0}} E_{\\mathrm{I}}$，$B = E_{\\mathrm{E}}$，$C = g_{\\mathrm{L}} + g_{\\mathrm{I0}}$。\n3. 如果 $(B - V_{\\mathrm{th}}) \\le 0$，当 $A/C \\ge V_{\\mathrm{th}}$ 时设置 $w = L$，否则设置 $w = 0$。\n4. 否则，计算\n   $$\n   g_{\\mathrm{req}} = \\frac{V_{\\mathrm{th}} C - A}{B - V_{\\mathrm{th}}}.\n   $$\n   如果 $g_{\\mathrm{req}} \\le 0$，设置 $w = L$；如果 $g_{\\mathrm{req}} \\ge g_{\\mathrm{E0}}$，设置 $w = 0$；否则设置\n   $$\n   w = 2 \\sigma \\sqrt{2 \\ln\\!\\left(\\frac{g_{\\mathrm{E0}}}{g_{\\mathrm{req}}}\\right)}.\n   $$\n5. 如果 $w  L$，则将 $w$ 裁剪为 $L$。\n6. 将所有 $w$ 值作为单个逗号分隔的列表输出，并用方括号括起来。\n\n对所提供用例的数值评估证实了定性预期：\n- 用例 1：由于兴奋和抑制的平衡，宽度适中。\n- 用例 2：更强的抑制增加了所需的兴奋性电导，并使宽度变窄。\n- 用例 3：高阈值使 $g_{\\mathrm{req}}$ 超过 $g_{\\mathrm{E0}}$，从而得到 $w = 0$。\n- 用例 4：低阈值导致 $g_{\\mathrm{req}} \\le 0$，激活整个轨道，因此 $w = L$。\n- 用例 5：增加 $\\sigma$ 会通过对 $\\sigma$ 的平方根依赖性按比例加宽位置场。\n\n程序实现了此过程，并按指定格式打印了五个用例的宽度（单位为米）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_width(L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0):\n    # Constants derived from the conductance-based steady-state model\n    A = gL * EL + gI0 * EI\n    B = EE\n    C = gL + gI0\n\n    # Handle case where excitatory driving force is insufficient\n    if (B - Vth) = 0:\n        V_base = A / C\n        w = L if V_base >= Vth else 0.0\n        return min(max(w, 0.0), L)\n\n    # Required excitatory conductance to reach threshold\n    g_req = (Vth * C - A) / (B - Vth)\n\n    # Edge cases based on g_req\n    if g_req = 0:\n        # Threshold is low enough that baseline suffices; whole track is active\n        w = L\n    elif g_req >= gE0:\n        # Even peak excitatory conductance is insufficient; no place field\n        w = 0.0\n    else:\n        # Compute width from Gaussian inequality\n        # w = 2 * sigma * sqrt(2 * ln(gE0 / g_req))\n        ratio = gE0 / g_req\n        # Numerical safety: ensure ratio > 1\n        if ratio = 1.0:\n            w = 0.0\n        else:\n            w = 2.0 * sigma * np.sqrt(2.0 * np.log(ratio))\n    # Clip to track length\n    if w > L:\n        w = L\n    if w  0.0:\n        w = 0.0\n    return float(w)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0)\n    test_cases = [\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.050, 0.1, 1.0),\n        (2.0, 2e-8, 3e-8, 5e-8, -0.065, -0.070, 0.0, -0.050, 0.1, 1.0),\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.010, 0.1, 1.0),\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.070, 0.1, 1.0),\n        (2.0, 2e-8, 1e-8, 5e-8, -0.065, -0.070, 0.0, -0.050, 0.2, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0 = case\n        w = compute_width(L, gL, gI0, gE0, EL, EI, EE, Vth, sigma, x0)\n        results.append(f\"{w:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理解了单个位置细胞如何形成其放电野之后，一个自然而然的问题是：大脑如何“读取”整个位置细胞群体的活动，从而精确地推断出自身在环境中的位置？本练习将向你介绍贝叶斯解码这一强大的计算神经科学工具。你将利用贝叶斯定理，根据一组神经元记录到的稀疏放电计数，计算出动物处于各个离散位置的后验概率 。通过计算最大后验概率（MAP）估计，你将亲身体验如何从看似嘈杂的神经信号中解码出清晰的空间信息，这正是大脑无时无刻不在进行的核心计算之一。",
            "id": "3989039",
            "problem": "考虑一个一维线性轨道，其上有离散的候选位置 $x \\in \\{x_1, x_2, x_3\\}$，其中 $x_1 = 0\\,\\text{m}$，$x_2 = 0.5\\,\\text{m}$，$x_3 = 1.0\\,\\text{m}$。一只老鼠在轨道上奔跑，同时在持续时间为 $T = 0.1\\,\\text{s}$ 的固定时间窗口内记录三个海马体位置细胞的脉冲计数。假设在给定位置 $x$ 的条件下，各个细胞的脉冲计数 $\\mathbf{n} = (n_1, n_2, n_3)$ 是相互独立的，并且每个都服从泊松分布，其平均计数 $r_i(x)$ 等于瞬时发放率 $f_i(x)$（单位：赫兹）与时间窗口持续时间 $T$ 的乘积，即 $r_i(x) = f_i(x) T$。这三个细胞在三个候选位置的瞬时发放率如下：\n- 在 $x_1 = 0\\,\\text{m}$ 处：$f_1(x_1) = 35$, $f_2(x_1) = 2$, $f_3(x_1) = 1$。\n- 在 $x_2 = 0.5\\,\\text{m}$ 处：$f_1(x_2) = 8$, $f_2(x_2) = 28$, $f_3(x_2) = 6$。\n- 在 $x_3 = 1.0\\,\\text{m}$ 处：$f_1(x_3) = 5$, $f_2(x_3) = 10$, $f_3(x_3) = 40$。\n假设在时间窗口内观察到的脉冲计数为 $\\mathbf{n} = (3, 2, 0)$。设位置的先验分布是均匀的：$p(x_1) = p(x_2) = p(x_3)$。从贝叶斯定理和上述泊松生成假设出发，推导贝叶斯解码器 $p(x \\mid \\mathbf{n})$（可差一个比例常数），并计算位置的最大后验（MAP）估计。用米来表示MAP估计值。无需四舍五入。",
            "solution": "问题要求推导用于老鼠位置的贝叶斯解码器，并计算位置的最大后验（MAP）估计值。位置 $x$ 是一个来自集合 $\\{x_1, x_2, x_3\\}$ 的离散变量，其中 $x_1 = 0\\,\\text{m}$，$x_2 = 0.5\\,\\text{m}$，$x_3 = 1.0\\,\\text{m}$。观测数据是来自三个位置细胞在时间窗口 $T = 0.1\\,\\text{s}$ 内的脉冲计数的向量 $\\mathbf{n} = (n_1, n_2, n_3) = (3, 2, 0)$。\n\n位置的MAP估计 $\\hat{x}_{\\text{MAP}}$ 是使后验概率 $p(x | \\mathbf{n})$ 最大化的位置 $x$。根据贝叶斯定理，后验概率由下式给出：\n$$p(x | \\mathbf{n}) = \\frac{p(\\mathbf{n} | x) p(x)}{p(\\mathbf{n})}$$\n其中 $p(\\mathbf{n} | x)$ 是似然， $p(x)$ 是位置的先验概率，而 $p(\\mathbf{n})$ 是证据，它作为一个归一化常数。为了找到MAP估计，我们寻求最大化后验概率：\n$$\\hat{x}_{\\text{MAP}} = \\arg\\max_{x \\in \\{x_1, x_2, x_3\\}} p(x | \\mathbf{n})$$\n由于 $p(\\mathbf{n})$ 相对于 $x$ 是一个常数，这等价于最大化分子：\n$$\\hat{x}_{\\text{MAP}} = \\arg\\max_{x \\in \\{x_1, x_2, x_3\\}} p(\\mathbf{n} | x) p(x)$$\n问题陈述位置的先验分布是均匀的，即 $p(x_1) = p(x_2) = p(x_3) = c$，其中 $c$ 是一个常数（具体来说，$c=1/3$）。由于先验概率 $p(x)$ 是一个常数，它不影响最大值的位置。因此，最大化后验概率等价于最大化似然：\n$$\\hat{x}_{\\text{MAP}} = \\arg\\max_{x \\in \\{x_1, x_2, x_3\\}} p(\\mathbf{n} | x)$$\n问题陈述，在给定位置 $x$ 的条件下，三个细胞的脉冲计数是独立的。因此，似然可以表示为每个细胞概率的乘积：\n$$p(\\mathbf{n} | x) = p(n_1 | x) p(n_2 | x) p(n_3 | x) = \\prod_{i=1}^{3} p(n_i | x)$$\n假设每个单独的脉冲计数 $n_i$ 服从泊松分布，其均值为 $r_i(x) = f_i(x)T$，其中 $f_i(x)$ 是发放率，$T$ 是时间窗口。泊松分布的概率质量函数为：\n$$p(n_i | x) = \\frac{(r_i(x))^{n_i} \\exp(-r_i(x))}{n_i!}$$\n将此代入似然函数，得到：\n$$p(\\mathbf{n} | x) = \\prod_{i=1}^{3} \\frac{(f_i(x)T)^{n_i} \\exp(-f_i(x)T)}{n_i!}$$\n由于先验是均匀的，贝叶斯解码器 $p(x | \\mathbf{n})$ 与此似然函数成正比。项 $\\prod_{i=1}^{3} (1/n_i!)$ 相对于 $x$ 是一个常数。因此，解码器（可差一个比例常数）为：\n$$p(x | \\mathbf{n}) \\propto \\prod_{i=1}^{3} (f_i(x)T)^{n_i} \\exp(-f_i(x)T)$$\n为了找到MAP估计，我们可以最大化似然的对数（对数似然），这将乘积转化为和，从而简化计算。最大化 $\\ln(p(\\mathbf{n} | x))$ 等价于最大化 $p(\\mathbf{n} | x)$。\n$$L(x) = \\ln(p(\\mathbf{n} | x)) = \\ln\\left(\\prod_{i=1}^{3} \\frac{(r_i(x))^{n_i} \\exp(-r_i(x))}{n_i!}\\right) = \\sum_{i=1}^{3} [n_i \\ln(r_i(x)) - r_i(x) - \\ln(n_i!)]$$\n项 $\\sum \\ln(n_i!)$ 与 $x$ 无关，在最大化过程中可以省略。我们寻求最大化函数 $L'(x)$：\n$$L'(x) = \\sum_{i=1}^{3} [n_i \\ln(r_i(x)) - r_i(x)]$$\n我们首先计算每个细胞 $i$ 在每个位置 $x_j$ 的平均脉冲计数 $r_i(x_j) = f_i(x_j)T$，其中 $T=0.1\\,\\text{s}$。给定的发放率是：\n在 $x_1 = 0\\,\\text{m}$ 处：$f_1(x_1)=35$, $f_2(x_1)=2$, $f_3(x_1)=1$。\n$r_1(x_1) = 35 \\times 0.1 = 3.5$, $r_2(x_1) = 2 \\times 0.1 = 0.2$, $r_3(x_1) = 1 \\times 0.1 = 0.1$。\n\n在 $x_2 = 0.5\\,\\text{m}$ 处：$f_1(x_2)=8$, $f_2(x_2)=28$, $f_3(x_2)=6$。\n$r_1(x_2) = 8 \\times 0.1 = 0.8$, $r_2(x_2) = 28 \\times 0.1 = 2.8$, $r_3(x_2) = 6 \\times 0.1 = 0.6$。\n\n在 $x_3 = 1.0\\,\\text{m}$ 处：$f_1(x_3)=5$, $f_2(x_3)=10$, $f_3(x_3)=40$。\n$r_1(x_3) = 5 \\times 0.1 = 0.5$, $r_2(x_3) = 10 \\times 0.1 = 1.0$, $r_3(x_3) = 40 \\times 0.1 = 4.0$。\n\n现在我们使用观察到的脉冲计数 $\\mathbf{n} = (3, 2, 0)$ 计算每个位置的 $L'(x)$：\n对于 $x_1 = 0\\,\\text{m}$：\n$$L'(x_1) = [3 \\ln(3.5) - 3.5] + [2 \\ln(0.2) - 0.2] + [0 \\ln(0.1) - 0.1]$$\n$$L'(x_1) = 3 \\ln(3.5) + 2 \\ln(0.2) - 3.8 \\approx 3(1.2528) + 2(-1.6094) - 3.8 = 3.7584 - 3.2188 - 3.8 = -3.2604$$\n\n对于 $x_2 = 0.5\\,\\text{m}$：\n$$L'(x_2) = [3 \\ln(0.8) - 0.8] + [2 \\ln(2.8) - 2.8] + [0 \\ln(0.6) - 0.6]$$\n$$L'(x_2) = 3 \\ln(0.8) + 2 \\ln(2.8) - 4.2 \\approx 3(-0.2231) + 2(1.0296) - 4.2 = -0.6693 + 2.0592 - 4.2 = -2.8101$$\n\n对于 $x_3 = 1.0\\,\\text{m}$：\n$$L'(x_3) = [3 \\ln(0.5) - 0.5] + [2 \\ln(1.0) - 1.0] + [0 \\ln(4.0) - 4.0]$$\n由于 $\\ln(1.0) = 0$：\n$$L'(x_3) = 3 \\ln(0.5) - 0.5 - 1.0 - 4.0 = 3 \\ln(0.5) - 5.5 \\approx 3(-0.6931) - 5.5 = -2.0793 - 5.5 = -7.5793$$\n\n比较三个候选位置的对数似然函数值：\n$L'(x_1) \\approx -3.2604$\n$L'(x_2) \\approx -2.8101$\n$L'(x_3) \\approx -7.5793$\n最大值是 $L'(x_2)$。因此，后验概率 $p(x | \\mathbf{n})$ 在 $x=x_2$ 处最大化。\n\n位置的MAP估计是 $\\hat{x}_{\\text{MAP}} = x_2 = 0.5\\,\\text{m}$。",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "海马体不仅是一个空间位置的编码器，更是一个强大的记忆系统。其 CA3 亚区被广泛认为通过其密集的循环连接网络，实现了“模式补全”——即根据不完整的线索回忆起完整的记忆（例如，一张完整的空间地图）。本练习将让你通过一个简化的 Wilson-Cowan 率模型来模拟 CA3 网络的动力学特性 。你将通过分析该模型的定点和稳定性，推导出触发模式补全所需的最小外界线索相似度阈值，从而深入理解循环神经网络是如何支持记忆的提取和稳定，并将“模式补全”与“模式分离”这些认知层面的概念与具体的网络动力学联系起来。",
            "id": "3989022",
            "problem": "考虑海马体 Cornu Ammonis 区域 3 (CA3) 亚区的一个简化模型，该模型是一个自联想循环网络，支持位置细胞表征中的模式完成和模式分离。设存在一个标量重叠序参量 $m \\in [-1,1]$，用于量化当前网络状态与存储的位置细胞模式（地图）之间的相似性。目标是从第一性原理出发，推导循环动力学何时导致模式完成与模式分离，并设计一个计算模型，以预测作为线索相似度函数的重映射阈值。\n\n推导的基本依据：\n- 用于具有循环耦合的同质群体的 Wilson–Cowan 速率方程：$$\\tau \\frac{dm}{dt} = -m + \\Phi\\big(h\\big),$$ 其中 $\\tau$ 是时间常数，$\\Phi(\\cdot)$ 是 S 型增益函数，$h$ 是群体的总突触输入。\n- 循环兴奋和全局抑制：$$h = \\beta \\left( J m - K m + I s \\right),$$ 其中 $\\beta0$ 是增益（噪声的倒数），$J \\ge 0$ 是由目标地图的 Hebbian 存储产生的有效循环兴奋强度，$K \\ge 0$ 汇总了全局抑制反馈和其他地图的干扰，$I \\ge 0$ 缩放外部线索驱动，$s \\in [0,1]$ 是线索与目标地图的相似度。\n- 一个由双曲正切近似的标准 S 型非线性函数：$$\\Phi(h) = \\tanh(h)。$$\n\n定义和目标：\n- 模式完成定义为收敛到一个稳定的不动点，其重叠度 $m$ 超过预设标准 $m_c \\in (0,1)$。\n- 模式分离定义为未能达到该标准，通常稳定在 $m \\approx 0$ 附近或收敛到另一个吸引子。\n- 重映射阈值 $s^\\star$ 是网络达到 $m \\ge m_c$ 的稳定不动点所需的最小线索相似度 $s$。\n\n任务：\n1. 从 Wilson–Cowan 速率方程和给定的 $h$ 出发，推导 $m$ 的不动点方程和不动点的稳定性条件。\n2. 使用不动点和稳定性条件，推导实现 $m \\ge m_c$ 作为稳定解所需的最小线索相似度 $s^\\star$ 的显式表达式。清晰说明所使用的任何假设和近似。\n3. 实现一个程序，对于下面测试套件中的每组参数，计算重映射阈值 $s^\\star$，应用稳定性条件，并强制执行物理边界：\n   - 如果准则处的不动点对于任何 $s$ 都不稳定，则返回 $-1$。\n   - 如果计算出的 $s^\\star  0$，则返回 $0$。\n   - 如果计算出的 $s^\\star  1$，则返回 $-1$。\n   - 否则，返回 $s^\\star$。\n4. 最终的数值输出必须是无量纲的，并四舍五入到六位小数。\n\n测试套件：\n- 情况 $1$：$(J,K,\\beta,I,m_c) = (0.8, 0.2, 1.5, 1.0, 0.5)$。\n- 情况 $2$：$(J,K,\\beta,I,m_c) = (0.3, 0.1, 2.0, 0.5, 0.6)$。\n- 情况 $3$：$(J,K,\\beta,I,m_c) = (1.6, 0.4, 1.0, 1.0, 0.5)$。\n- 情况 $4$：$(J,K,\\beta,I,m_c) = (1.5, 0.0, 2.0, 1.0, 0.7)$。\n- 情况 $5$：$(J,K,\\beta,I,m_c) = (0.2, 0.15, 1.0, 0.2, 0.6)$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含五个案例的结果，以逗号分隔的列表形式并用方括号括起来，例如 `[x_1,x_2,x_3,x_4,x_5]`，其中每个 $x_i$ 遵循上述规则，并四舍五入到六位小数。不应打印任何额外文本。",
            "solution": "对海马体 CA3 模型的分析遵循应用于所提供的 Wilson-Cowan 速率方程的动力系统理论的基本原理。\n\n### 第一步：不动点方程和稳定性条件的推导\n\n重叠序参量 $m$ 的动力学由以下微分方程控制：\n$$\n\\tau \\frac{dm}{dt} = -m + \\Phi(h)\n$$\n总突触输入 $h$ 由下式给出：\n$$\nh = \\beta \\left( (J - K) m + I s \\right)\n$$\n代入具体的增益函数 $\\Phi(h) = \\tanh(h)$ 和 $h$ 的表达式，我们得到完整的动力学方程：\n$$\n\\tau \\frac{dm}{dt} = -m + \\tanh\\left(\\beta \\left( (J - K) m + I s \\right)\\right)\n$$\n这是一个形式为 $\\tau \\frac{dm}{dt} = F(m)$ 的自治一维动力系统，其中：\n$$\nF(m) = -m + \\tanh\\left(\\beta \\left( (J - K) m + I s \\right)\\right)\n$$\n\n**不动点方程：**\n一个不动点，记为 $m^*$，是系统停止演化的状态，即 $\\frac{dm}{dt} = 0$。这意味着 $F(m^*) = 0$。将动力学方程的右侧设为零，得到不动点方程：\n$$\nm^* = \\tanh\\left(\\beta \\left( (J - K) m^* + I s \\right)\\right)\n$$\n这个超越方程定义了对于给定参数集 $(J, K, \\beta, I, s)$ 的重叠度 $m^*$ 的平衡值。\n\n**稳定性条件：**\n不动点 $m^*$ 的稳定性由 $F(m)$ 在 $m=m^*$ 处的导数的符号决定。如果不动点满足 $\\frac{dF}{dm}|_{m=m^*}  0$，则其是稳定的；如果不动点满足 $\\frac{dF}{dm}|_{m=m^*} > 0$，则其是不稳定的。\n\n我们计算 $F(m)$ 的导数：\n$$\n\\frac{dF}{dm} = \\frac{d}{dm} \\left[ -m + \\tanh\\left(\\beta \\left( (J - K) m + I s \\right)\\right) \\right]\n$$\n使用链式法则，其中 $\\frac{d}{dx}\\tanh(u) = \\text{sech}^2(u)\\frac{du}{dx}$，我们得到：\n$$\n\\frac{dF}{dm} = -1 + \\text{sech}^2\\left(\\beta \\left( (J - K) m + I s \\right)\\right) \\cdot \\frac{d}{dm}\\left[\\beta \\left( (J - K) m + I s \\right)\\right]\n$$\n$$\n\\frac{dF}{dm} = -1 + \\beta(J - K) \\text{sech}^2\\left(\\beta \\left( (J - K) m + I s \\right)\\right)\n$$\n稳定性条件是 $\\frac{dF}{dm}|_{m=m^*}  0$：\n$$\n-1 + \\beta(J - K) \\text{sech}^2\\left(\\beta \\left( (J - K) m^* + I s \\right)\\right)  0\n$$\n$$\n\\beta(J - K) \\text{sech}^2\\left(\\beta \\left( (J - K) m^* + I s \\right)\\right)  1\n$$\n我们可以通过使用恒等式 $\\text{sech}^2(x) = 1 - \\tanh^2(x)$ 和不动点方程 $m^* = \\tanh\\left(\\beta \\left( (J - K) m^* + I s \\right)\\right)$ 来简化这个条件。将这些代入不等式，得到：\n$$\n\\beta(J - K) \\left(1 - \\left[\\tanh\\left(\\beta \\left( (J - K) m^* + I s \\right)\\right)\\right]^2\\right)  1\n$$\n$$\n\\beta(J - K) (1 - (m^*)^2)  1\n$$\n这是适用于任何不动点 $m^*$ 的通用稳定性条件。\n\n### 第二步：重映射阈值 $s^\\star$ 的推导\n\n重映射阈值 $s^\\star$ 定义为实现 $m \\ge m_c$ 的稳定不动点所需的最小线索相似度 $s$。阈值情况恰好发生在系统能够在 $m = m_c$ 处支持一个稳定不动点时。因此，我们将 $m^* = m_c$ 代入不动点方程，并求解相应的相似度，我们将其标记为 $s^\\star$。\n\n在准则 $m_c$ 处的不动点方程是：\n$$\nm_c = \\tanh\\left(\\beta \\left( (J - K) m_c + I s^\\star \\right)\\right)\n$$\n为了求解 $s^\\star$，我们首先对两边应用反双曲正切函数 $\\text{arctanh}(\\cdot)$。函数 $\\text{arctanh}(y)$ 的定义域为 $y \\in (-1, 1)$。由于问题规定 $m_c \\in (0,1)$，因此该应用是有效的。\n$$\n\\text{arctanh}(m_c) = \\beta \\left( (J - K) m_c + I s^\\star \\right)\n$$\n重新整理以分离出 $s^\\star$：\n$$\n\\frac{\\text{arctanh}(m_c)}{\\beta} = (J - K) m_c + I s^\\star\n$$\n$$\nI s^\\star = \\frac{\\text{arctanh}(m_c)}{\\beta} - (J - K) m_c\n$$\n假设 $I > 0$（所有测试用例中都成立，因为 $I \\ge 0$ 且 $I=0$ 的值意味着线索没有影响），我们可以除以 $I$：\n$$\ns^\\star = \\frac{1}{I} \\left[ \\frac{\\text{arctanh}(m_c)}{\\beta} - (J - K) m_c \\right]\n$$\n这就是重映射阈值 $s^\\star$ 的显式表达式。\n\n### 第三步：应用稳定性和物理约束\n\n计算任务要求评估 $s^\\star$，然后应用一系列条件。\n\n1.  **稳定性检查：** 在 $m = m_c$ 处的不动点必须是稳定的。我们应用之前推导的、在 $m^* = m_c$ 处评估的稳定性条件：\n    $$\n    \\beta(J - K) (1 - m_c^2)  1\n    $$\n    这个条件与 $s$ 无关。如果不满足该条件，即如果 $\\beta(J - K) (1 - m_c^2) \\ge 1$，则无论线索相似度 $s$ 如何，$m=m_c$ 处的不动点永远不可能是稳定的。在这种情况下，问题规定输出应为 $-1$。\n\n2.  **$s^\\star$ 的物理边界：** 线索相似度 $s$ 在物理上被限制在区间 $[0,1]$ 内。\n    - 如果计算出的 $s^\\star > 1$，意味着即使是最强的可能线索 ($s=1$) 也不足以达到模式完成的标准。阈值在物理上是不可达的，因此输出必须为 $-1$。\n    - 如果计算出的 $s^\\star  0$，这意味着网络的循环连接 $(J-K)$ 足够强，即使在没有正向线索 ($s=0$) 的情况下，甚至在有反向线索 ($s0$) 的情况下，也能自发地达到状态 $m_c$（或更高）。所需的最小*物理*线索相似度是 $s=0$。因此，阈值实际上是 $0$。\n    - 如果 $0 \\le s^\\star \\le 1$，则计算值是具有物理意义的重映射阈值。\n\n最终返回的值按要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the remapping threshold for a simplified hippocampal CA3 model.\n    \"\"\"\n    # Test suite: (J, K, beta, I, m_c)\n    test_cases = [\n        (0.8, 0.2, 1.5, 1.0, 0.5),\n        (0.3, 0.1, 2.0, 0.5, 0.6),\n        (1.6, 0.4, 1.0, 1.0, 0.5),\n        (1.5, 0.0, 2.0, 1.0, 0.7),\n        (0.2, 0.15, 1.0, 0.2, 0.6),\n    ]\n\n    results = []\n    for case in test_cases:\n        J, K, beta, I, m_c = case\n\n        # 1. Stability Condition Check\n        # The fixed point at m = m_c must be stable.\n        # Condition: beta * (J - K) * (1 - m_c^2)  1\n        stability_term = beta * (J - K) * (1 - m_c**2)\n        if stability_term >= 1:\n            results.append(-1.0)\n            continue\n\n        # 2. Calculate the remapping threshold s_star\n        # s_star = (1/I) * [ (arctanh(m_c) / beta) - (J - K) * m_c ]\n        \n        # Check for I=0 to prevent division by zero, although not in test cases.\n        # If I=0, s_star is only defined if the RHS is also zero.\n        # The problem is structured such that I > 0 in test cases.\n        if I == 0:\n            # If I=0, the cue has no effect. The equation for s_star is undefined.\n            # We can't reach m_c by varying s. This a form of failure.\n            results.append(-1.0) \n            continue\n            \n        # m_c is guaranteed to be in (0,1), so arctanh is defined.\n        term1 = np.arctanh(m_c) / beta\n        term2 = (J - K) * m_c\n        s_star = (term1 - term2) / I\n\n        # 3. Apply physical bounds and problem rules\n        if s_star > 1:\n            # Threshold is physically unreachable\n            results.append(-1.0)\n        elif s_star  0:\n            # Spontaneous completion, minimal physical cue is 0\n            results.append(0.0)\n        else:\n            # Valid threshold\n            results.append(s_star)\n\n    # Format the final output as specified.\n    # Each result is formatted to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}