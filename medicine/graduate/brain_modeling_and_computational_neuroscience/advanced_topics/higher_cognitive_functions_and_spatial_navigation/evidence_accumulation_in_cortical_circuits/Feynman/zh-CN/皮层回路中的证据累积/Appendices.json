{
    "hands_on_practices": [
        {
            "introduction": "在皮层回路中，决策的基础来自于对神经元尖峰序列的解读。这个练习为我们提供了一个核心的数学框架，用于理解如何从离散的神经事件中量化证据。通过为一个泊松尖峰序列推导对数似然比（LLR），我们将精确地看到每个尖峰如何为一个假设贡献一份证据，从而揭示证据累积过程的离散和量化本质。",
            "id": "3979258",
            "problem": "一个皮层决策回路接收一个单一的感觉脉冲序列，该序列可以建模为一个齐次泊松点过程，其率取决于真实的假设：在假设 $H_1$ 下，率为 $\\lambda_1$；在假设 $H_0$ 下，率为 $\\lambda_0$，其中 $\\lambda_1 \\neq \\lambda_0$ 且 $\\lambda_1, \\lambda_0 > 0$。该回路计算对数似然比 (LLR) $\\Lambda_t$，定义为 $\\Lambda_t \\equiv \\ln\\!\\big(p(\\mathcal{N}_{[0,t]} \\mid H_1)/p(\\mathcal{N}_{[0,t]} \\mid H_0)\\big)$，其中 $\\mathcal{N}_{[0,t]}$ 表示直到时间 $t$ 的整个脉冲序列历史。\n\n仅从齐次泊松过程的定义（率 $\\lambda$ 的独立增量和恒定风险率）和似然比的定义出发，推导 $\\Lambda_t$ 关于截至时间 $t$ 的总脉冲数 $N_t$ 和时间 $t$ 本身的显式表达式。从这个表达式中，确定：\n- 在每个观测到的脉冲时刻发生的 $\\Lambda_t$ 的跳跃增量，以及\n- 在假设 $H_1$ 下 $\\Lambda_t$ 的期望瞬时漂移。\n\n将您的最终结果表示为以 $\\lambda_1$ 和 $\\lambda_0$ 为变量的两个闭式解析表达式。无需进行数值计算。",
            "solution": "该问题要求推导一个齐次泊松过程的对数似然比 (LLR)，并随后确定此 LLR 的跳跃增量和期望漂移。该问题是适定的，并且在科学上基于贯序分析理论及其在神经编码中的应用。\n\n首先，我们必须在给定假设下，建立观测到特定脉冲序列历史 $\\mathcal{N}_{[0,t]}$ 的似然。设 $\\mathcal{N}_{[0,t]}$ 由区间 $[0, t]$ 内的脉冲数量 $N_t$ 及其精确时刻 $\\{t_1, t_2, \\dots, t_{N_t}\\}$ 来表征。\n\n对于一个由时变率函数 $\\lambda(s)$ 定义的一般点过程，观测到在 $\\{t_j\\}_{j=1}^{N_t}$ 时刻有脉冲的特定实现的似然由以下似然泛函给出：\n$$ p(\\mathcal{N}_{[0,t]}) \\propto \\left( \\prod_{j=1}^{N_t} \\lambda(t_j) \\right) \\exp\\left( -\\int_0^t \\lambda(s) ds \\right) $$\n问题陈述了该脉冲序列是一个齐次泊松过程，这意味着对于所有的 $s$，率 $\\lambda(s)$ 都是一个常数 $\\lambda$。在假设 $H_i$（其中 $i \\in \\{0, 1\\}$）下，率为 $\\lambda_i$。因此，似然泛函得以简化。\n\n在假设 $H_1$ 下，率为 $\\lambda_1$。观测到脉冲序列历史 $\\mathcal{N}_{[0,t]}$ 的似然为：\n$$ p(\\mathcal{N}_{[0,t]} \\mid H_1) \\propto \\left( \\prod_{j=1}^{N_t} \\lambda_1 \\right) \\exp\\left( -\\int_0^t \\lambda_1 ds \\right) = \\lambda_1^{N_t} \\exp(-\\lambda_1 t) $$\n类似地，在假设 $H_0$ 下，率为 $\\lambda_0$，其似然为：\n$$ p(\\mathcal{N}_{[0,t]} \\mid H_0) \\propto \\lambda_0^{N_t} \\exp(-\\lambda_0 t) $$\n与用于定义概率的无穷小时间窗相关的比例常数，对于两个假设是相同的，并将在似然比中被抵消。\n\n对数似然比 $\\Lambda_t$ 定义为 $\\Lambda_t \\equiv \\ln(p(\\mathcal{N}_{[0,t]} \\mid H_1) / p(\\mathcal{N}_{[0,t]} \\mid H_0))$。我们现在可以代入我们推导出的似然：\n$$ \\Lambda_t = \\ln\\left( \\frac{\\lambda_1^{N_t} \\exp(-\\lambda_1 t)}{\\lambda_0^{N_t} \\exp(-\\lambda_0 t)} \\right) $$\n利用对数的性质，我们可以将各项分离：\n$$ \\Lambda_t = \\ln(\\lambda_1^{N_t}) - \\ln(\\lambda_0^{N_t}) + \\ln(\\exp(-\\lambda_1 t)) - \\ln(\\exp(-\\lambda_0 t)) $$\n$$ \\Lambda_t = N_t \\ln(\\lambda_1) - N_t \\ln(\\lambda_0) - \\lambda_1 t + \\lambda_0 t $$\n这就得到了 $\\Lambda_t$ 关于脉冲数 $N_t$ 和时间 $t$ 的显式表达式：\n$$ \\Lambda_t = N_t \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) - (\\lambda_1 - \\lambda_0) t $$\n这就完成了推导的第一部分。\n\n接下来，我们确定 $\\Lambda_t$ 的跳跃增量。$\\Lambda_t$ 的表达式包含两部分。项 $-(\\lambda_1 - \\lambda_0) t$ 随时间连续线性演化。项 $N_t \\ln(\\lambda_1/\\lambda_0)$ 仅在 $N_t$ 变化时才改变其值。由于 $N_t$ 是脉冲计数，它在每次脉冲发生时增加1。设一个脉冲发生在时间 $t_{spike}$。脉冲前瞬间的 LLR 值为 $\\Lambda_{t_{spike}^-} = (N_{t_{spike}}-1) \\ln(\\frac{\\lambda_1}{\\lambda_0}) - (\\lambda_1 - \\lambda_0) t_{spike}$。脉冲后瞬间的值为 $\\Lambda_{t_{spike}^+} = N_{t_{spike}} \\ln(\\frac{\\lambda_1}{\\lambda_0}) - (\\lambda_1 - \\lambda_0) t_{spike}$。跳跃量 $\\Delta\\Lambda$ 是其差值：\n$$ \\Delta\\Lambda = \\Lambda_{t_{spike}^+} - \\Lambda_{t_{spike}^-} = \\left( N_{t_{spike}} - (N_{t_{spike}}-1) \\right) \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) = \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) $$\n每次观测到的脉冲处的跳跃增量是一个恒定量，等于两率的对数比。\n\n最后，我们确定在假设 $H_1$ 下 $\\Lambda_t$ 的期望瞬时漂移。我们可以将 $\\Lambda_t$ 的动态表示为微分形式。设 $dN_t$ 为无穷小区间 $dt$ 内的脉冲数。\n$$ d\\Lambda_t = d\\left( N_t \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) - (\\lambda_1 - \\lambda_0) t \\right) = \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) dN_t - (\\lambda_1 - \\lambda_0) dt $$\n漂移定义为期望变化率 $E[d\\Lambda_t / dt]$。为了求得此值，我们在 $H_1$ 的统计特性下对 $d\\Lambda_t$ 取期望：\n$$ E[d\\Lambda_t \\mid H_1] = E\\left[ \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) dN_t - (\\lambda_1 - \\lambda_0) dt \\mid H_1 \\right] $$\n根据期望的线性性质：\n$$ E[d\\Lambda_t \\mid H_1] = \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) E[dN_t \\mid H_1] - (\\lambda_1 - \\lambda_0) dt $$\n在假设 $H_1$ 下，该过程具有恒定率 $\\lambda_1$。因此，在一个区间 $dt$ 内的期望脉冲数是 $E[dN_t \\mid H_1] = \\lambda_1 dt$。将此代入方程中：\n$$ E[d\\Lambda_t \\mid H_1] = \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) (\\lambda_1 dt) - (\\lambda_1 - \\lambda_0) dt $$\n期望瞬时漂移通过将上式除以 $dt$ 获得：\n$$ \\frac{E[d\\Lambda_t \\mid H_1]}{dt} = \\lambda_1 \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) - (\\lambda_1 - \\lambda_0) $$\n这个表达式表示当 $H_1$ 确实是真实状态时，支持 $H_1$ 的证据累积的平均速率。",
            "answer": "$$\n\\boxed{\\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right), \\quad \\lambda_1 \\ln\\left(\\frac{\\lambda_1}{\\lambda_0}\\right) - (\\lambda_1 - \\lambda_0)}\n$$"
        },
        {
            "introduction": "感觉证据的可靠性在决策过程中并非总是恒定不变的。这个练习探讨了一个理想的观测者应如何根据证据可靠性的动态变化来加权证据。通过对比一个采用恒定权重的静态累积器和一个能够追踪可靠性变化的自适应累积器，我们可以量化最优策略带来的性能优势，这是高效决策的一个关键原则。",
            "id": "3979278",
            "problem": "你需要分析一个连续时间高斯证据模型下的二择一强迫选择决策，并推导、实现和比较两种累加器的正确选择概率：一种是使用恒定积分权重的稳态漂移扩散模型（DDM），另一种是追踪时变证据可靠性的自适应累加器。该模型旨在捕捉皮层回路中的证据累积过程。\n\n假设决策时域固定为 $T$ 秒，瞬时证据 $m(t)$ 由线性高斯模型给出：\n$$\nm(t) = s \\,\\rho(t) + \\xi(t),\n$$\n其中 $s \\in \\{-1, +1\\}$ 表示真实状态，$\\rho(t)$ 是一个非负时变可靠性剖面（无量纲），$\\xi(t)$ 是零均值高斯白噪声，其单位谱密度使得在权重 $w(t)$ 作用下随时间累积的噪声方差为 $\\int_0^T w(t)^2 \\, dt$。一个累加器计算\n$$\nx(T) = \\int_0^T w(t) \\, m(t) \\, dt,\n$$\n并在截止时间 $T$ 做出选择 $\\hat{s} = \\mathrm{sign}(x(T))$。你的任务是，对于以下两种权重策略，从第一性原理推导出该模型下正确选择的概率 $p_{\\mathrm{corr}}$：\n- 稳态漂移扩散模型：$w(t) = c$，其中 $c$ 是一个与 $t$ 无关的正常数。\n- 自适应可靠性追踪累加器：$w(t) = \\rho(t)$。\n\n在用 $\\rho(t)$ 的积分形式推导出这两种情况下的 $p_{\\mathrm{corr}}$ 后，将稳态 DDM 相对于自适应累加器的性能损失定义为\n$$\n\\Delta = p_{\\mathrm{corr}}^{\\mathrm{adaptive}} - p_{\\mathrm{corr}}^{\\mathrm{stationary}},\n$$\n并以小数形式表示（无量纲）。你的最终程序必须通过时间离散化，使用均匀时间步长 $\\Delta t$ 秒来数值计算 $\\Delta$，并通过黎曼和来近似所需的积分。\n\n在区间 $t \\in [0, T)$ 上实现以下可靠性剖面 $\\rho(t)$，并计算相应的性能损失。在所有情况下，使用 $T = 1$ 秒和 $\\Delta t = 10^{-3}$ 秒。确保可靠性在任何时候都保持非负。\n\n- 测试用例 1（基线恒定可靠性）：对于所有 $t \\in [0, T)$，$\\rho(t) = \\rho_0$ 且 $\\rho_0 = 1$。此用例作为边界条件，预期没有性能损失。\n- 测试用例 2（线性递减可靠性）：$\\rho(t) = \\max\\{\\rho_0 - k t, 0\\}$，其中 $\\rho_0 = 1$ 且 $k = 0.8$ 每秒。\n- 测试用例 3（指数衰减可靠性）：$\\rho(t) = \\rho_0 \\, e^{-\\lambda t}$，其中 $\\rho_0 = 1$ 且 $\\lambda = 2$ 每秒。\n- 测试用例 4（阶跃下降可靠性）：当 $t  t_s$ 时 $\\rho(t) = r_1$，当 $t \\ge t_s$ 时 $\\rho(t) = r_2$，其中 $r_1 = 1$, $r_2 = 0.2$, $t_s = 0.5$ 秒。\n- 测试用例 5（快速三角下降至零）：$\\rho(t) = \\max\\{\\rho_0 \\, (1 - t/t_0), 0\\}$，其中 $\\rho_0 = 1$ 且 $t_0 = 0.2$ 秒。\n\n你的程序应产生单行输出，其中包含按相同顺序排列的五个测试用例的性能损失，形式为一个包含在方括号中的逗号分隔列表，每个值四舍五入到六位小数（例如，$[0.000000,0.012345,0.098765,0.123456,0.654321]$）。不允许有其他输出。所有结果均为无量纲小数；输出中不需要物理单位，但计算必须遵守指定的时间单位（秒）和离散化步长（秒）。",
            "solution": "该问题要求在一个连续时间决策模型中，推导并计算两种证据累积策略之间的性能差异。我们首先对一个通用权重函数 $w(t)$，进行正确选择概率 $p_{\\mathrm{corr}}$ 的形式化推导。\n\n决策变量 $x(T)$ 是加权瞬时证据 $m(t)$ 在固定时域 $[0, T]$ 上的积分：\n$$\nx(T) = \\int_0^T w(t) \\, m(t) \\, dt\n$$\n瞬时证据由 $m(t) = s \\rho(t) + \\xi(t)$ 给出，其中 $s \\in \\{-1, +1\\}$ 是真实状态，$\\rho(t)$ 是时变证据可靠性，$\\xi(t)$ 是零均值单位谱密度高斯白噪声。将 $m(t)$ 代入 $x(T)$ 的表达式中：\n$$\nx(T) = \\int_0^T w(t) [s \\rho(t) + \\xi(t)] dt = s \\int_0^T w(t) \\rho(t) dt + \\int_0^T w(t) \\xi(t) dt\n$$\n决策变量 $x(T)$ 是一个随机变量。由于它是高斯过程 $\\xi(t)$ 的一个线性泛函，$x(T)$ 本身也服从高斯分布。我们来确定它的均值和方差。\n\n$x(T)$ 的均值是其期望值 $E[x(T)]$:\n$$\n\\mu_x = E\\left[s \\int_0^T w(t) \\rho(t) dt + \\int_0^T w(t) \\xi(t) dt\\right]\n$$\n第一项是确定性的。根据期望的线性性质以及 $E[\\xi(t)] = 0$，第二项的均值为零。因此，$x(T)$ 的均值为：\n$$\n\\mu_x = s \\int_0^T w(t) \\rho(t) dt\n$$\n$x(T)$ 的方差 $\\sigma_x^2$ 由下式给出：\n$$\n\\sigma_x^2 = \\mathrm{Var}\\left[s \\int_0^T w(t) \\rho(t) dt + \\int_0^T w(t) \\xi(t) dt\\right] = \\mathrm{Var}\\left[\\int_0^T w(t) \\xi(t) dt\\right]\n$$\n如问题所述，对于单位谱密度的白噪声 $\\xi(t)$，积分噪声的方差是权重函数平方的积分：\n$$\n\\sigma_x^2 = \\int_0^T w(t)^2 dt\n$$\n所以，决策变量的分布是 $x(T) \\sim \\mathcal{N}(\\mu_x, \\sigma_x^2)$。如果 $\\mathrm{sign}(\\hat{s}) = \\mathrm{sign}(x(T)) = s$，则做出正确的决策 $\\hat{s}$。\n\n不失一般性地，假设真实状态为 $s=+1$。如果 $x(T) > 0$，则做出正确决策。正确选择的概率 $p_{\\mathrm{corr}}$ 是 $P(x(T) > 0)$。对于一个高斯变量，这个概率是：\n$$\np_{\\mathrm{corr}} = P(x(T) > 0) = P\\left(\\frac{x(T) - \\mu_x}{\\sigma_x}  \\frac{0 - \\mu_x}{\\sigma_x}\\right) = 1 - \\Phi\\left(-\\frac{\\mu_x}{\\sigma_x}\\right) = \\Phi\\left(\\frac{\\mu_x}{\\sigma_x}\\right)\n$$\n其中 $\\Phi$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数（CDF）。$\\Phi$ 的自变量是决策变量的信噪比（SNR）。对于 $s=+1$：\n$$\n\\mathrm{SNR} = \\frac{\\mu_x}{\\sigma_x} = \\frac{\\int_0^T w(t) \\rho(t) dt}{\\sqrt{\\int_0^T w(t)^2 dt}}\n$$\n（如果我们选择 $s=-1$，$\\mu_x$ 将为负，正确的选择要求 $x(T)0$。最终得到的概率是相同的，因此该推导具有普适性）。\n\n现在我们针对两种指定的权重策略推导 $p_{\\text{corr}}$。\n\n1.  **自适应可靠性追踪累加器：** 权重函数为 $w(t) = \\rho(t)$。该策略对应于一个匹配滤波器，已知其可以最大化信噪比。\n    这种情况下的信噪比为：\n    $$\n    \\mathrm{SNR}_{\\mathrm{adaptive}} = \\frac{\\int_0^T \\rho(t) \\cdot \\rho(t) dt}{\\sqrt{\\int_0^T \\rho(t)^2 dt}} = \\frac{\\int_0^T \\rho(t)^2 dt}{\\sqrt{\\int_0^T \\rho(t)^2 dt}} = \\sqrt{\\int_0^T \\rho(t)^2 dt}\n    $$\n    相应的正确选择概率为：\n    $$\n    p_{\\mathrm{corr}}^{\\mathrm{adaptive}} = \\Phi\\left(\\sqrt{\\int_0^T \\rho(t)^2 dt}\\right)\n    $$\n\n2.  **稳态漂移扩散模型（DDM）：** 权重函数是一个常数，$w(t) = c$，其中 $c > 0$。\n    这种情况下的信噪比为：\n    $$\n    \\mathrm{SNR}_{\\mathrm{stationary}} = \\frac{\\int_0^T c \\cdot \\rho(t) dt}{\\sqrt{\\int_0^T c^2 dt}} = \\frac{c \\int_0^T \\rho(t) dt}{\\sqrt{c^2 T}} = \\frac{c \\int_0^T \\rho(t) dt}{c\\sqrt{T}} = \\frac{\\int_0^T \\rho(t) dt}{\\sqrt{T}}\n    $$\n    常数 $c$ 的值被消去，因此稳态 DDM 的性能与其具体增益无关。正确选择的概率为：\n    $$\n    p_{\\mathrm{corr}}^{\\mathrm{stationary}} = \\Phi\\left(\\frac{\\int_0^T \\rho(t) dt}{\\sqrt{T}}\\right)\n    $$\n\n稳态 DDM 相对于自适应累加器的性能损失 $\\Delta$ 定义为其各自正确选择概率的差值：\n$$\n\\Delta = p_{\\mathrm{corr}}^{\\mathrm{adaptive}} - p_{\\mathrm{corr}}^{\\mathrm{stationary}} = \\Phi\\left(\\sqrt{\\int_0^T \\rho(t)^2 dt}\\right) - \\Phi\\left(\\frac{\\int_0^T \\rho(t) dt}{\\sqrt{T}}\\right)\n$$\n根据柯西-施瓦茨不等式，$\\left(\\int_0^T \\rho(t) dt\\right)^2 = \\left(\\int_0^T 1 \\cdot \\rho(t) dt\\right)^2 \\le \\left(\\int_0^T 1^2 dt\\right) \\left(\\int_0^T \\rho(t)^2 dt\\right) = T \\int_0^T \\rho(t)^2 dt$。这意味着 $\\mathrm{SNR}_{\\mathrm{stationary}}^2 \\le \\mathrm{SNR}_{\\mathrm{adaptive}}^2$。由于信噪比是非负的，且 $\\Phi$ 是一个单调递增函数，我们有 $p_{\\mathrm{corr}}^{\\mathrm{stationary}} \\le p_{\\mathrm{corr}}^{\\mathrm{adaptive}}$，因此 $\\Delta \\ge 0$。当且仅当 $\\rho(t)$ 是常数时（如测试用例 1），等式成立。\n\n对于数值实现，我们将时间区间 $[0, T)$ 离散化为 $N = T/\\Delta t$ 个步骤。积分通过黎曼和近似：\n$$\n\\int_0^T f(t) dt \\approx \\sum_{i=0}^{N-1} f(t_i) \\Delta t\n$$\n其中 $t_i = i \\cdot \\Delta t$。\n信噪比的公式变为：\n$$\n\\mathrm{SNR}_{\\mathrm{adaptive}} \\approx \\sqrt{\\left(\\sum_{i=0}^{N-1} \\rho(t_i)^2\\right) \\Delta t}\n$$\n$$\n\\mathrm{SNR}_{\\mathrm{stationary}} \\approx \\frac{\\left(\\sum_{i=0}^{N-1} \\rho(t_i)\\right) \\Delta t}{\\sqrt{T}}\n$$\n这些表达式将被实现用来计算指定可靠性剖面 $\\rho(t)$ 下的 $\\Delta$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\n# The problem specifies numpy 1.23.5 and scipy 1.11.4.\n# The `from scipy.stats import norm` import is valid under these requirements.\n\ndef solve():\n    \"\"\"\n    Computes the performance loss of a stationary drift-diffusion model (DDM)\n    relative to an adaptive accumulator for several reliability profiles.\n    \"\"\"\n    T = 1.0  # Decision horizon in seconds\n    dt = 1e-3  # Time step for numerical integration in seconds\n\n    def calculate_delta(rho_func, T_val, dt_val):\n        \"\"\"\n        Calculates the performance loss for a given reliability profile.\n\n        Args:\n            rho_func (callable): A function that takes a time array and returns the reliability profile.\n            T_val (float): Total time horizon.\n            dt_val (float): Time step for discretization.\n\n        Returns:\n            float: The performance loss Delta.\n        \"\"\"\n        # Create the discrete time vector\n        t = np.arange(0, T_val, dt_val)\n\n        # Evaluate the reliability profile at each time step\n        rho_t = rho_func(t)\n        \n        # Ensure reliability is non-negative as per problem statement\n        # (covered by max() in function definitions, but good practice to check)\n        if np.any(rho_t  0):\n            # This case should not be reached with the given test cases\n            raise ValueError(\"Reliability profile rho(t) must be non-negative.\")\n\n        # Approximate integrals using Riemann sums\n        # integral_rho_sq = sum(rho(t_i)^2 * dt)\n        integral_rho_sq = np.sum(rho_t**2) * dt_val\n        # integral_rho = sum(rho(t_i) * dt)\n        integral_rho = np.sum(rho_t) * dt_val\n\n        # Calculate the Signal-to-Noise Ratio (SNR) for both models\n        snr_adaptive = np.sqrt(integral_rho_sq)\n        snr_stationary = integral_rho / np.sqrt(T_val)\n\n        # Calculate the probability of correct choice for each model\n        # using the standard normal CDF (Phi function)\n        p_corr_adaptive = norm.cdf(snr_adaptive)\n        p_corr_stationary = norm.cdf(snr_stationary)\n\n        # Calculate the performance loss\n        delta = p_corr_adaptive - p_corr_stationary\n        return delta\n\n    # Define the reliability profiles for the five test cases\n    test_cases = [\n        # Test case 1: constant reliability\n        {\"rho_func\": lambda t: np.full_like(t, 1.0), \"params\": {}},\n        \n        # Test case 2: linearly decreasing reliability\n        {\"rho_func\": lambda t, rho0, k: np.maximum(rho0 - k * t, 0), \"params\": {\"rho0\": 1.0, \"k\": 0.8}},\n        \n        # Test case 3: exponential decay of reliability\n        {\"rho_func\": lambda t, rho0, lam: rho0 * np.exp(-lam * t), \"params\": {\"rho0\": 1.0, \"lam\": 2.0}},\n        \n        # Test case 4: stepwise drop in reliability\n        {\"rho_func\": lambda t, r1, r2, ts: np.where(t  ts, r1, r2), \"params\": {\"r1\": 1.0, \"r2\": 0.2, \"ts\": 0.5}},\n        \n        # Test case 5: fast triangular drop to zero\n        {\"rho_func\": lambda t, rho0, t0: np.maximum(rho0 * (1 - t / t0), 0), \"params\": {\"rho0\": 1.0, \"t0\": 0.2}},\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_func = case[\"rho_func\"]\n        params = case[\"params\"]\n        # Create a partial function with the specific parameters for the case\n        profile_func = lambda t: rho_func(t, **params)\n        delta = calculate_delta(profile_func, T, dt)\n        results.append(delta)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each value rounded to six decimal places, enclosed in brackets.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "抽象的证据累积模型最终必须通过真实的神经回路来实现。这个练习通过模拟兴奋性和抑制性突触输入的相互作用如何塑造整合过程，从而弥合了理论与生物学之间的鸿沟。通过推导该系统的有效时间常数，我们将深入理解生物物理参数如何控制证据累积的时间尺度。",
            "id": "3979223",
            "problem": "考虑一个皮层回路中证据累积变量 $x(t)$ 的最小线性模型，该回路接收由共同刺激 $s(t)$ 驱动的兴奋性和抑制性突触输入。突触电流由一阶动力学建模，累加器是一个漏积分器。具体来说，设兴奋性和抑制性突触状态变量 $u_{E}(t)$ 和 $u_{I}(t)$ 满足\n$$\n\\tau_{E}\\,\\frac{d u_{E}(t)}{dt} = -u_{E}(t) + s(t), \\qquad \\tau_{I}\\,\\frac{d u_{I}(t)}{dt} = -u_{I}(t) + s(t),\n$$\n并令累加器服从\n$$\n\\tau_{m}\\,\\frac{d x(t)}{dt} = -x(t) + g_{E}\\,u_{E}(t) - g_{I}\\,u_{I}(t),\n$$\n其中 $\\tau_{E}  0$、$\\tau_{I}  0$ 和 $\\tau_{m}  0$ 分别是兴奋性、抑制性和膜时间常数，而 $g_{E}  0$、$g_{I}  0$ 是有效突触耦合增益。假设零初始条件，且所有信号都是因果的。\n\n通过 $x(t) = \\int_{0}^{\\infty} k(t')\\,s(t - t')\\,dt'$ 定义从 $s(t)$ 到 $x(t)$ 的线性时不变映射，其中 $k(t)$ 是净兴奋-抑制核。从上述动力学方程出发，仅使用线性时不变系统和一阶突触动力学的基本性质，完成以下任务：\n\n1. 推导净核 $k(t)$ 的显式因果表达式，形式为反映兴奋-抑制平衡的衰减指数和。\n\n2. 将 $x(t)$ 的有效时间常数 $\\tau_{\\mathrm{eff}}$ 定义为从 $s(t)$到$x(t)$ 的传递函数在低频下的最佳一阶近似的参数，即，对于接近 $p=0$ 的拉普拉斯变量 $p$，\n$$\nG(p) \\equiv \\frac{X(p)}{S(p)} \\approx \\frac{G(0)}{1 + p\\,\\tau_{\\mathrm{eff}}}\n$$\n其中 $G(0) \\equiv \\lim_{p\\to 0} G(p)$。假设 $g_{E} \\neq g_{I}$，推导 $\\tau_{\\mathrm{eff}}$ 的闭式解，用 $\\tau_{m}$、$\\tau_{E}$、$\\tau_{I}$、$g_{E}$ 和 $g_{I}$ 表示。\n\n提供 $\\tau_{\\mathrm{eff}}$ 的单一符号表达式作为最终答案。不需要进行数值计算。如果需要进行数值计算，时间应以秒为单位表示。",
            "solution": "该问题描述了一个连接刺激 $s(t)$ 和证据累积变量 $x(t)$ 的线性时不变（LTI）系统。其动力学由一组耦合的一阶线性常微分方程控制。分析此类系统最有效的方法是拉普拉斯变换，它将时域中的微分方程转换为频域（由拉普拉斯变量 $p$ 表示）中的代数方程。给定零初始条件，这简化了变换过程。\n\n设 $S(p)$、$U_E(p)$、$U_I(p)$ 和 $X(p)$ 分别是 $s(t)$、$u_E(t)$、$u_I(t)$ 和 $x(t)$ 的拉普拉斯变换。对给定的动力学方程应用拉普拉斯变换，得到：\n$$\n\\tau_{E}\\,p\\,U_{E}(p) = -U_{E}(p) + S(p) \\quad \\implies \\quad U_{E}(p) = \\frac{S(p)}{1 + p\\,\\tau_{E}}\n$$\n$$\n\\tau_{I}\\,p\\,U_{I}(p) = -U_{I}(p) + S(p) \\quad \\implies \\quad U_{I}(p) = \\frac{S(p)}{1 + p\\,\\tau_{I}}\n$$\n$$\n\\tau_{m}\\,p\\,X(p) = -X(p) + g_{E}\\,U_{E}(p) - g_{I}\\,U_{I}(p) \\quad \\implies \\quad X(p) = \\frac{g_{E}\\,U_{E}(p) - g_{I}\\,U_{I}(p)}{1 + p\\,\\tau_{m}}\n$$\n通过将 $U_E(p)$ 和 $U_I(p)$ 的表达式代入 $X(p)$ 的方程中，我们可以找到总传递函数 $G(p) = X(p)/S(p)$：\n$$\nX(p) = \\frac{1}{1 + p\\,\\tau_{m}} \\left( g_{E}\\,\\frac{S(p)}{1 + p\\,\\tau_{E}} - g_{I}\\,\\frac{S(p)}{1 + p\\,\\tau_{I}} \\right)\n$$\n$$\nG(p) = \\frac{X(p)}{S(p)} = \\frac{1}{1 + p\\,\\tau_{m}} \\left( \\frac{g_{E}}{1 + p\\,\\tau_{E}} - \\frac{g_{I}}{1 + p\\,\\tau_{I}} \\right)\n$$\n这可以写成两项之差：\n$$\nG(p) = \\frac{g_{E}}{(1 + p\\,\\tau_{m})(1 + p\\,\\tau_{E})} - \\frac{g_{I}}{(1 + p\\,\\tau_{m})(1 + p\\,\\tau_{I})}\n$$\n\n**1. 净核 $k(t)$ 的推导**\n\n核 $k(t)$ 是系统的脉冲响应，可以通过求传递函数 $G(p)$ 的拉普拉斯逆变换得到。我们将分别求每一项的逆变换。解的形式取决于时间常数是否不同。问题要求解为衰减指数和，这表明我们应该假设时间常数是不同的。我们假设 $\\tau_m \\ne \\tau_E$ 且 $\\tau_m \\ne \\tau_I$。\n\n考虑第一项，$G_E(p) = \\frac{g_{E}}{(1 + p\\,\\tau_{m})(1 + p\\,\\tau_{E})}$。我们使用部分分式展开：\n$$\nG_E(p) = \\frac{A}{1 + p\\,\\tau_{m}} + \\frac{B}{1 + p\\,\\tau_{E}}\n$$\n使用 Heaviside 覆盖法：\n$$\nA = \\left. \\frac{g_{E}}{1 + p\\,\\tau_{E}} \\right|_{p = -1/\\tau_m} = \\frac{g_{E}}{1 - \\tau_{E}/\\tau_{m}} = \\frac{g_{E}\\,\\tau_{m}}{\\tau_{m} - \\tau_{E}}\n$$\n$$\nB = \\left. \\frac{g_{E}}{1 + p\\,\\tau_{m}} \\right|_{p = -1/\\tau_E} = \\frac{g_{E}}{1 - \\tau_{m}/\\tau_{E}} = \\frac{g_{E}\\,\\tau_{E}}{\\tau_{E} - \\tau_{m}}\n$$\n项 $\\frac{C}{1+p\\tau}$ 的拉普拉斯逆变换是 $\\frac{C}{\\tau} \\exp(-t/\\tau) H(t)$，其中 $H(t)$ 是确保因果性的 Heaviside 阶跃函数。应用此方法：\n$$\n\\mathcal{L}^{-1}\\{G_E(p)\\}(t) = \\left( \\frac{A}{\\tau_m}\\exp(-t/\\tau_m) + \\frac{B}{\\tau_E}\\exp(-t/\\tau_E) \\right) H(t)\n$$\n$$\n\\mathcal{L}^{-1}\\{G_E(p)\\}(t) = \\left( \\frac{g_{E}}{\\tau_{m} - \\tau_{E}}\\exp(-t/\\tau_m) + \\frac{g_{E}}{\\tau_{E} - \\tau_{m}}\\exp(-t/\\tau_E) \\right) H(t)\n$$\n$$\n\\mathcal{L}^{-1}\\{G_E(p)\\}(t) = \\frac{g_{E}}{\\tau_{m} - \\tau_{E}} \\left( \\exp(-t/\\tau_m) - \\exp(-t/\\tau_E) \\right) H(t)\n$$\n根据对称性，第二项 $-\\frac{g_{I}}{(1 + p\\,\\tau_{m})(1 + p\\,\\tau_{I})}$ 的拉普拉斯逆变换是：\n$$\n-\\frac{g_{I}}{\\tau_{m} - \\tau_{I}} \\left( \\exp(-t/\\tau_m) - \\exp(-t/\\tau_I) \\right) H(t)\n$$\n总核 $k(t)$ 是这两个结果的和：\n$$\nk(t) = \\left[ \\frac{g_{E}}{\\tau_{m} - \\tau_{E}} \\left( \\exp(-t/\\tau_m) - \\exp(-t/\\tau_E) \\right) - \\frac{g_{I}}{\\tau_{m} - \\tau_{I}} \\left( \\exp(-t/\\tau_m) - \\exp(-t/\\tau_I) \\right) \\right] H(t)\n$$\n按指数衰减项分组：\n$$\nk(t) = \\left[ \\left(\\frac{g_{E}}{\\tau_{m} - \\tau_{E}} - \\frac{g_{I}}{\\tau_{m} - \\tau_{I}}\\right)\\exp(-t/\\tau_m) - \\frac{g_{E}}{\\tau_{m} - \\tau_{E}}\\exp(-t/\\tau_E) + \\frac{g_{I}}{\\tau_{m} - \\tau_{I}}\\exp(-t/\\tau_I) \\right] H(t)\n$$\n这就提供了 $k(t)$ 作为衰减指数和的显式因果表达式。\n\n**2. 有效时间常数 $\\tau_{\\mathrm{eff}}$ 的推导**\n\n有效时间常数 $\\tau_{\\mathrm{eff}}$ 由 $G(p)$ 在 $p \\to 0$ 时的低频一阶近似定义：\n$$\nG(p) \\approx \\frac{G(0)}{1 + p\\,\\tau_{\\mathrm{eff}}}\n$$\n$G(p)$ 在 $p=0$ 附近的泰勒级数是 $G(p) \\approx G(0) + p\\,G'(0)$。右侧的近似也可以对小 $p$ 进行展开：$\\frac{G(0)}{1 + p\\,\\tau_{\\mathrm{eff}}} \\approx G(0)(1 - p\\,\\tau_{\\mathrm{eff}}) = G(0) - p\\,G(0)\\,\\tau_{\\mathrm{eff}}$。\n通过比较两个展开式中 $p$ 的一阶项，我们发现 $G'(0) = -G(0)\\,\\tau_{\\mathrm{eff}}$。如果 $G(0) \\neq 0$，这就给出了 $\\tau_{\\mathrm{eff}}$ 的公式：\n$$\n\\tau_{\\mathrm{eff}} = -\\frac{G'(0)}{G(0)}\n$$\n首先，我们通过在 $G(p)$ 的表达式中令 $p=0$ 来计算 $G(0)$：\n$$\nG(0) = \\frac{1}{1 + 0} \\left( \\frac{g_{E}}{1 + 0} - \\frac{g_{I}}{1 + 0} \\right) = g_{E} - g_{I}\n$$\n问题中说明 $g_E \\ne g_I$，所以 $G(0) \\ne 0$，$\\tau_{\\mathrm{eff}}$ 是良定义的。\n\n接下来，我们计算 $G'(0)$。我们将 $G(p)$ 对 $p$ 求导，然后在 $p=0$ 处求值。对 $G(p) = (1+p\\tau_m)^{-1} \\left( \\frac{g_E}{1+p\\tau_E} - \\frac{g_I}{1+p\\tau_I} \\right)$ 使用乘法法则：\n$$\nG'(p) = \\frac{d}{dp}\\left[(1+p\\tau_m)^{-1}\\right] \\left( \\frac{g_E}{1+p\\tau_E} - \\frac{g_I}{1+p\\tau_I} \\right) + (1+p\\tau_m)^{-1} \\frac{d}{dp}\\left[ \\frac{g_E}{1+p\\tau_E} - \\frac{g_I}{1+p\\tau_I} \\right]\n$$\n$$\nG'(p) = -\\tau_m(1+p\\tau_m)^{-2} \\left( \\frac{g_E}{1+p\\tau_E} - \\frac{g_I}{1+p\\tau_I} \\right) + (1+p\\tau_m)^{-1} \\left( \\frac{-g_E \\tau_E}{(1+p\\tau_E)^2} + \\frac{g_I \\tau_I}{(1+p\\tau_I)^2} \\right)\n$$\n现在，我们在 $p=0$ 处计算此表达式的值：\n$$\nG'(0) = -\\tau_m(1)^{-2} \\left( g_E - g_I \\right) + (1)^{-1} \\left( -g_E \\tau_E + g_I \\tau_I \\right)\n$$\n$$\nG'(0) = -\\tau_m(g_E - g_I) - g_E \\tau_E + g_I \\tau_I = -g_E\\tau_m + g_I\\tau_m - g_E\\tau_E + g_I\\tau_I\n$$\n$$\nG'(0) = -g_E(\\tau_m + \\tau_E) + g_I(\\tau_m + \\tau_I)\n$$\n最后，我们将 $G(0)$ 和 $G'(0)$ 代入 $\\tau_{\\mathrm{eff}}$ 的表达式中：\n$$\n\\tau_{\\mathrm{eff}} = -\\frac{-g_E(\\tau_m + \\tau_E) + g_I(\\tau_m + \\tau_I)}{g_E - g_I} = \\frac{g_E(\\tau_m + \\tau_E) - g_I(\\tau_m + \\tau_I)}{g_E - g_I}\n$$\n这个表达式可以重新整理成一个更具洞察力的形式：\n$$\n\\tau_{\\mathrm{eff}} = \\frac{g_E\\tau_m - g_I\\tau_m + g_E\\tau_E - g_I\\tau_I}{g_E - g_I} = \\frac{(g_E - g_I)\\tau_m}{g_E - g_I} + \\frac{g_E\\tau_E - g_I\\tau_I}{g_E - g_I}\n$$\n$$\n\\tau_{\\mathrm{eff}} = \\tau_m + \\frac{g_E\\tau_E - g_I\\tau_I}{g_E - g_I}\n$$\n这就是有效时间常数的闭式表达式。",
            "answer": "$$\n\\boxed{\\tau_{m} + \\frac{g_{E}\\tau_{E} - g_{I}\\tau_{I}}{g_{E} - g_{I}}}\n$$"
        }
    ]
}