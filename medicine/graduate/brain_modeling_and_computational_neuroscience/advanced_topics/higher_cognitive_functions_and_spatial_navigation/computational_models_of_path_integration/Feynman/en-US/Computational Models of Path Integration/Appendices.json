{
    "hands_on_practices": [
        {
            "introduction": "Path integration requires tracking not just *where* you are, but also which way you are facing. This exercise demonstrates a fundamental and often counter-intuitive property of movement in two-dimensional space: the final pose depends on the order of operations. By calculating the outcome of a simple path with a rotation and a translation swapped, you will gain a hands-on appreciation for the non-commutative nature of the Special Euclidean group $SE(2)$, the mathematical framework for describing position and orientation. ",
            "id": "3971833",
            "problem": "Consider a simplified path-integration module for allocentric pose in the plane, modeled as elements of the Special Euclidean group in two dimensions (SE(2)). The animal’s pose is represented by a position $(x,y)$ in meters and a heading angle $\\theta$ in radians. Assume piecewise-constant controls: at each step, a rotation by angle $\\Delta \\theta$ updates the heading, and a subsequent translation occurs along the body-forward axis at constant speed $s$ for duration $T$, producing a displacement of magnitude $d = sT$. Use the kinematic base that the translational velocity in the world frame is the body-forward speed projected by the current heading, and that rotations update the heading additively.\n\nFormally:\n- The world-frame displacement from a translation along the body-forward axis of magnitude $d$ at heading $\\theta$ is $\\Delta x = d \\cos(\\theta)$ and $\\Delta y = d \\sin(\\theta)$.\n- The heading update by a rotation $\\Delta \\theta$ is $\\theta \\leftarrow \\theta + \\Delta \\theta$.\n\nThe agent starts at $(x_0,y_0)=(0,0)$ with initial heading $\\theta_0 = 0$. It executes the following sequence of piecewise-constant controls:\n\nSegment $1$: rotate by $\\Delta \\theta_1 = \\pi/6$, then translate with speed $s_1 = 0.5$ m/s for duration $T_1 = 4$ s.\n\nSegment $2$: there are two variants of ordering the rotation and translation:\n- Variant A: rotate by $\\Delta \\theta_2 = -\\pi/3$, then translate with speed $s_2 = 1.2$ m/s for duration $T_2 = 2$ s.\n- Variant B: translate first with the same $s_2$ and $T_2$ at the current heading, then rotate by $\\Delta \\theta_2 = -\\pi/3$.\n\nSegment $3$: rotate by $\\Delta \\theta_3 = \\arctan(1/2)$, then translate with speed $s_3 = 0.8$ m/s for duration $T_3 = 5$ s.\n\nAssume all rotations are instantaneous heading updates occurring between translations, and all translations are along the instantaneous body-forward axis. Using only the above kinematic base, compute the exact final positions $(x_A,y_A)$ and $(x_B,y_B)$ produced by concatenating the operations in Variant A and Variant B, respectively. Then, compute the Euclidean distance between these two final positions to demonstrate the non-commutativity of rotations and translations in SE(2).\n\nUse radians for all angles. Express the final Euclidean distance in meters. Provide the exact value; do not round.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- **Model**: Path integration for pose in the Special Euclidean group $SE(2)$.\n- **State**: Position $(x, y)$ in meters, heading angle $\\theta$ in radians.\n- **Initial State**: $(x_0, y_0) = (0, 0)$, $\\theta_0 = 0$.\n- **Kinematic Rules**:\n  - Rotation: $\\theta \\leftarrow \\theta + \\Delta \\theta$.\n  - Translation: Displacement magnitude $d = sT$. World-frame displacement is $\\Delta x = d \\cos(\\theta)$ and $\\Delta y = d \\sin(\\theta)$.\n- **Control Sequence**:\n  - **Segment 1**: Rotate $\\Delta \\theta_1 = \\pi/6$. Translate with speed $s_1 = 0.5$ m/s for duration $T_1 = 4$ s.\n  - **Segment 2, Variant A**: Rotate $\\Delta \\theta_2 = -\\pi/3$. Translate with speed $s_2 = 1.2$ m/s for duration $T_2 = 2$ s.\n  - **Segment 2, Variant B**: Translate with speed $s_2 = 1.2$ m/s for duration $T_2 = 2$ s. Rotate $\\Delta \\theta_2 = -\\pi/3$.\n  - **Segment 3**: Rotate $\\Delta \\theta_3 = \\arctan(1/2)$. Translate with speed $s_3 = 0.8$ m/s for duration $T_3 = 5$ s.\n- **Task**:\n  1. Compute the final position $(x_A, y_A)$ for the path with Variant A.\n  2. Compute the final position $(x_B, y_B)$ for the path with Variant B.\n  3. Compute the Euclidean distance between $(x_A, y_A)$ and $(x_B, y_B)$.\n  4. Provide the exact value.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific or Factual Soundness**: The problem is scientifically sound. It uses a standard kinematic model for a rigid body moving in a plane, which is a fundamental concept in robotics, physics, and computational neuroscience. The mathematical framework of $SE(2)$ is appropriate.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary initial conditions and control parameters. The sequence of operations is deterministic, leading to a unique solution.\n- **Objectivity**: The problem is stated in precise, objective mathematical language.\n- **Completeness and Consistency**: The problem is self-contained and free of contradictions. All required data is provided.\n- **Realism**: The physical parameters (speeds, durations) are realistic.\n- **Structure**: The problem is clearly structured and asks for a specific, computable result.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n***\n\nThe solution proceeds by computing the agent's state $(x, y, \\theta)$ sequentially for each path. First, we calculate the displacement magnitudes for each segment.\nDisplacement for Segment $1$: $d_1 = s_1 T_1 = (0.5 \\text{ m/s}) \\cdot (4 \\text{ s}) = 2$ m.\nDisplacement for Segment $2$: $d_2 = s_2 T_2 = (1.2 \\text{ m/s}) \\cdot (2 \\text{ s}) = 2.4$ m, which is $\\frac{12}{5}$ m.\nDisplacement for Segment $3$: $d_3 = s_3 T_3 = (0.8 \\text{ m/s}) \\cdot (5 \\text{ s}) = 4$ m.\n\nThe initial state is $(x_0, y_0, \\theta_0) = (0, 0, 0)$.\n\n**State Evolution for Path A**\n\n1.  **After Segment 1 (Rotate, then Translate):**\n    The heading is updated first: $\\theta'_1 = \\theta_0 + \\Delta \\theta_1 = 0 + \\frac{\\pi}{6} = \\frac{\\pi}{6}$.\n    The translation occurs at this new heading:\n    $\\Delta x_1 = d_1 \\cos(\\theta'_1) = 2 \\cos(\\frac{\\pi}{6}) = 2 \\cdot \\frac{\\sqrt{3}}{2} = \\sqrt{3}$.\n    $\\Delta y_1 = d_1 \\sin(\\theta'_1) = 2 \\sin(\\frac{\\pi}{6}) = 2 \\cdot \\frac{1}{2} = 1$.\n    The state after Segment $1$ is $(x_1, y_1, \\theta_1) = (\\sqrt{3}, 1, \\frac{\\pi}{6})$.\n\n2.  **After Segment 2, Variant A (Rotate, then Translate):**\n    Starting from $(x_1, y_1, \\theta_1)$, the heading is updated: $\\theta'_{2A} = \\theta_1 + \\Delta \\theta_2 = \\frac{\\pi}{6} - \\frac{\\pi}{3} = -\\frac{\\pi}{6}$.\n    The translation occurs at this new heading:\n    $\\Delta x_{2A} = d_2 \\cos(\\theta'_{2A}) = \\frac{12}{5} \\cos(-\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{6\\sqrt{3}}{5}$.\n    $\\Delta y_{2A} = d_2 \\sin(\\theta'_{2A}) = \\frac{12}{5} \\sin(-\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot (-\\frac{1}{2}) = -\\frac{6}{5}$.\n    The position is updated:\n    $x_{2A} = x_1 + \\Delta x_{2A} = \\sqrt{3} + \\frac{6\\sqrt{3}}{5} = \\frac{5\\sqrt{3} + 6\\sqrt{3}}{5} = \\frac{11\\sqrt{3}}{5}$.\n    $y_{2A} = y_1 + \\Delta y_{2A} = 1 - \\frac{6}{5} = -\\frac{1}{5}$.\n    The state after Segment $2A$ is $(x_{2A}, y_{2A}, \\theta_{2A}) = (\\frac{11\\sqrt{3}}{5}, -\\frac{1}{5}, -\\frac{\\pi}{6})$.\n\n3.  **After Segment 3 (following Variant A):**\n    The heading is updated: $\\theta'_{3A} = \\theta_{2A} + \\Delta \\theta_3 = -\\frac{\\pi}{6} + \\arctan(\\frac{1}{2})$.\n    For the displacement, we need $\\cos(\\theta'_{3A})$ and $\\sin(\\theta'_{3A})$. Let $\\alpha = \\arctan(\\frac{1}{2})$. A right triangle with opposite side $1$ and adjacent side $2$ has hypotenuse $\\sqrt{1^2+2^2}=\\sqrt{5}$. Thus, $\\cos(\\alpha) = \\frac{2}{\\sqrt{5}}$ and $\\sin(\\alpha) = \\frac{1}{\\sqrt{5}}$.\n    Using sum/difference identities:\n    $\\cos(\\theta'_{3A}) = \\cos(\\alpha - \\frac{\\pi}{6}) = \\cos(\\alpha)\\cos(\\frac{\\pi}{6}) + \\sin(\\alpha)\\sin(\\frac{\\pi}{6}) = \\frac{2}{\\sqrt{5}}\\frac{\\sqrt{3}}{2} + \\frac{1}{\\sqrt{5}}\\frac{1}{2} = \\frac{2\\sqrt{3}+1}{2\\sqrt{5}}$.\n    $\\sin(\\theta'_{3A}) = \\sin(\\alpha - \\frac{\\pi}{6}) = \\sin(\\alpha)\\cos(\\frac{\\pi}{6}) - \\cos(\\alpha)\\sin(\\frac{\\pi}{6}) = \\frac{1}{\\sqrt{5}}\\frac{\\sqrt{3}}{2} - \\frac{2}{\\sqrt{5}}\\frac{1}{2} = \\frac{\\sqrt{3}-2}{2\\sqrt{5}}$.\n    The displacement for Segment $3$ is:\n    $\\Delta x_{3A} = d_3 \\cos(\\theta'_{3A}) = 4 \\cdot \\frac{2\\sqrt{3}+1}{2\\sqrt{5}} = \\frac{2(2\\sqrt{3}+1)}{\\sqrt{5}} = \\frac{4\\sqrt{15}+2\\sqrt{5}}{5}$.\n    $\\Delta y_{3A} = d_3 \\sin(\\theta'_{3A}) = 4 \\cdot \\frac{\\sqrt{3}-2}{2\\sqrt{5}} = \\frac{2(\\sqrt{3}-2)}{\\sqrt{5}} = \\frac{2\\sqrt{15}-4\\sqrt{5}}{5}$.\n    The final position for Path A is $(x_A, y_A)$:\n    $x_A = x_{2A} + \\Delta x_{3A} = \\frac{11\\sqrt{3}}{5} + \\frac{4\\sqrt{15}+2\\sqrt{5}}{5} = \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}$.\n    $y_A = y_{2A} + \\Delta y_{3A} = -\\frac{1}{5} + \\frac{2\\sqrt{15}-4\\sqrt{5}}{5} = \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5}$.\n\n**State Evolution for Path B**\n\n1.  **After Segment 1 (Rotate, then Translate):**\n    This segment is identical to Path A. The state is $(x_1, y_1, \\theta_1) = (\\sqrt{3}, 1, \\frac{\\pi}{6})$.\n\n2.  **After Segment 2, Variant B (Translate, then Rotate):**\n    Starting from $(x_1, y_1, \\theta_1)$, the translation occurs first, using the current heading $\\theta_1$:\n    $\\Delta x_{2B} = d_2 \\cos(\\theta_1) = \\frac{12}{5} \\cos(\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{\\sqrt{3}}{2} = \\frac{6\\sqrt{3}}{5}$.\n    $\\Delta y_{2B} = d_2 \\sin(\\theta_1) = \\frac{12}{5} \\sin(\\frac{\\pi}{6}) = \\frac{12}{5} \\cdot \\frac{1}{2} = \\frac{6}{5}$.\n    The position is updated:\n    $x_{2B} = x_1 + \\Delta x_{2B} = \\sqrt{3} + \\frac{6\\sqrt{3}}{5} = \\frac{11\\sqrt{3}}{5}$.\n    $y_{2B} = y_1 + \\Delta y_{2B} = 1 + \\frac{6}{5} = \\frac{11}{5}$.\n    Then, the heading is updated:\n    $\\theta_{2B} = \\theta_1 + \\Delta \\theta_2 = \\frac{\\pi}{6} - \\frac{\\pi}{3} = -\\frac{\\pi}{6}$.\n    The state after Segment $2B$ is $(x_{2B}, y_{2B}, \\theta_{2B}) = (\\frac{11\\sqrt{3}}{5}, \\frac{11}{5}, -\\frac{\\pi}{6})$.\n\n3.  **After Segment 3 (following Variant B):**\n    The heading entering this segment is $\\theta_{2B} = -\\frac{\\pi}{6}$, which is identical to $\\theta_{2A}$. Since Segment $3$ involves the same operations (rotate by $\\Delta\\theta_3$, translate by $d_3$), the displacement vector $(\\Delta x_{3B}, \\Delta y_{3B})$ will be identical to $(\\Delta x_{3A}, \\Delta y_{3A})$.\n    $\\Delta x_{3B} = \\frac{4\\sqrt{15}+2\\sqrt{5}}{5}$.\n    $\\Delta y_{3B} = \\frac{2\\sqrt{15}-4\\sqrt{5}}{5}$.\n    The final position for Path B is $(x_B, y_B)$:\n    $x_B = x_{2B} + \\Delta x_{3B} = \\frac{11\\sqrt{3}}{5} + \\frac{4\\sqrt{15}+2\\sqrt{5}}{5} = \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}$.\n    $y_B = y_{2B} + \\Delta y_{3B} = \\frac{11}{5} + \\frac{2\\sqrt{15}-4\\sqrt{5}}{5} = \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5}$.\n\n**Euclidean Distance Calculation**\n\nThe final positions are:\n$P_A = (x_A, y_A) = \\left( \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}, \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right)$\n$P_B = (x_B, y_B) = \\left( \\frac{11\\sqrt{3} + 4\\sqrt{15} + 2\\sqrt{5}}{5}, \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right)$\n\nWe compute the difference between these positions to find the distance.\n$\\Delta x_{final} = x_B - x_A = 0$. This occurs due to the specific choice of angles $\\theta_1 = \\pi/6$ and $\\Delta\\theta_2 = -\\pi/3$, which results in $\\cos(\\theta_1) = \\cos(\\theta_1+\\Delta\\theta_2)$.\n$\\Delta y_{final} = y_B - y_A = \\left( \\frac{11 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right) - \\left( \\frac{-1 + 2\\sqrt{15} - 4\\sqrt{5}}{5} \\right) = \\frac{11 - (-1)}{5} = \\frac{12}{5}$.\n\nThe Euclidean distance $D$ is the magnitude of the difference vector $(\\Delta x_{final}, \\Delta y_{final})$:\n$D = \\sqrt{(\\Delta x_{final})^2 + (\\Delta y_{final})^2} = \\sqrt{0^2 + \\left(\\frac{12}{5}\\right)^2} = \\frac{12}{5}$.\n\nThis non-zero distance demonstrates the non-commutativity of rotation and translation operations in $SE(2)$. The final pose depends on the order in which these operations are applied.\nThe distance is $\\frac{12}{5}$ meters, or $2.4$ meters.",
            "answer": "$$\\boxed{\\frac{12}{5}}$$"
        },
        {
            "introduction": "An ideal path integrator is a useful theoretical tool, but real biological systems are subject to noise and systematic errors. This practice moves from ideal kinematics to a more realistic scenario, exploring how a common error—a systematic miscalibration in distance estimation (odometry)—propagates through the integration process. By deriving the final homing error after a simple triangular path, you will see how a low-level imperfection leads to a predictable, measurable error at the behavioral level. ",
            "id": "3971882",
            "problem": "Consider a planar agent performing path integration to return to a nest located at the origin. The agent starts at the nest, moves along a first straight leg of length $L_{1}$ aligned with the positive $x$-axis, then instantaneously turns by an angle $\\theta$ (in radians, counterclockwise) and moves along a second straight leg of length $L_{2}$. After these two legs, the agent attempts to home directly to the nest by moving along a single third straight leg equal to its internally computed home vector.\n\nAssume the following fundamental base:\n- Displacements in the plane sum linearly as vectors in an allocentric frame, and rotations are represented by the rotation matrix $$R(\\phi) = \\begin{pmatrix}\\cos \\phi & -\\sin \\phi \\\\ \\sin \\phi & \\cos \\phi\\end{pmatrix}$$.\n- Path integration accumulates the vectorial sum of traversed displacements to form an internal home vector pointing from the current location to the origin.\n- The agent’s angular estimation is perfect (no heading bias), and rotations are instantaneous at vertices.\n- There is a systematic odometric gain in distance estimation: each traversed distance $d$ is internally encoded as $(1+\\gamma)d$, where $\\gamma$ is a small constant. There are no other sources of noise or leak.\n\nLet the agent, at the end of the second leg, use its internal home vector to generate the third leg, moving exactly by that vector in the plane. Derive, from first principles and the assumptions above, the agent’s final deviation vector from the nest (its final position relative to the origin) after completing the third leg, expressed in terms of $L_{1}$, $L_{2}$, $\\theta$, and $\\gamma$. Express your final answer as a single $1 \\times 2$ row vector containing the $x$- and $y$-components. No numerical evaluation is required, and no units are needed. Angles are in radians.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It provides a clear, formalizable scenario within the established framework of computational models of path integration. All necessary parameters and conditions are specified, and there are no internal contradictions or ambiguities. We may therefore proceed with a formal derivation.\n\nThe agent's movement can be described using vector algebra in a 2D Cartesian coordinate system where the nest is at the origin, $\\vec{p}_{\\text{nest}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$. The problem requires deriving the agent's final position vector, which represents the deviation from the nest.\n\nFirst, we determine the agent's actual physical position after completing the first two legs of its journey. Let $\\vec{P}_{\\text{actual}}$ be this position vector.\n\nThe first leg of the journey is a displacement of length $L_1$ along the positive $x$-axis. The corresponding displacement vector, $\\vec{d}_1$, is:\n$$\n\\vec{d}_1 = \\begin{pmatrix} L_1 \\\\ 0 \\end{pmatrix}\n$$\nThe agent starts at the origin, so its position after the first leg is $\\vec{p}_1 = \\vec{d}_1$.\n\nThe agent then turns by an angle $\\theta$ counterclockwise and moves a distance $L_2$. The direction of this second leg is given by the unit vector $\\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$. The displacement vector for the second leg, $\\vec{d}_2$, is therefore:\n$$\n\\vec{d}_2 = L_2 \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix}\n$$\nThe agent's actual position after the second leg, $\\vec{P}_{\\text{actual}}$, is the vector sum of the displacements of the first two legs:\n$$\n\\vec{P}_{\\text{actual}} = \\vec{d}_1 + \\vec{d}_2 = \\begin{pmatrix} L_1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix}\n$$\n\nNext, we calculate the agent's internally computed home vector, $\\vec{H}$. According to the problem, path integration accumulates the vectorial sum of traversed displacements. However, there is a systematic odometric gain $\\gamma$, such that any traversed distance $d$ is internally encoded as $(1+\\gamma)d$. The agent's heading estimation is perfect, so the directions of the encoded displacements are correct.\n\nThe internally encoded displacement for the first leg, $\\vec{d}'_1$, has a magnitude of $(1+\\gamma)L_1$:\n$$\n\\vec{d}'_1 = (1+\\gamma) \\vec{d}_1 = \\begin{pmatrix} (1+\\gamma)L_1 \\\\ 0 \\end{pmatrix}\n$$\nThe internally encoded displacement for the second leg, $\\vec{d}'_2$, has a magnitude of $(1+\\gamma)L_2$:\n$$\n\\vec{d}'_2 = (1+\\gamma) \\vec{d}_2 = \\begin{pmatrix} (1+\\gamma)L_2 \\cos\\theta \\\\ (1+\\gamma)L_2 \\sin\\theta \\end{pmatrix}\n$$\nThe agent's total integrated displacement vector, $\\vec{D}_{\\text{integrated}}$, is the sum of these encoded displacements:\n$$\n\\vec{D}_{\\text{integrated}} = \\vec{d}'_1 + \\vec{d}'_2 = \\begin{pmatrix} (1+\\gamma)L_1 + (1+\\gamma)L_2 \\cos\\theta \\\\ (1+\\gamma)L_2 \\sin\\theta \\end{pmatrix}\n$$\nThis can be factored as:\n$$\n\\vec{D}_{\\text{integrated}} = (1+\\gamma) \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = (1+\\gamma)\\vec{P}_{\\text{actual}}\n$$\nThe internal home vector, $\\vec{H}$, is defined as the vector pointing from the current location back to the origin. It is therefore the negative of the total integrated displacement vector:\n$$\n\\vec{H} = -\\vec{D}_{\\text{integrated}} = -(1+\\gamma)\\vec{P}_{\\text{actual}}\n$$\n\nFinally, we determine the agent's final position. The problem states that the agent moves along a third leg exactly equal to its internally computed home vector. This means the displacement for the third leg, $\\vec{d}_3$, is equal to $\\vec{H}$.\n$$\n\\vec{d}_3 = \\vec{H}\n$$\nThe agent's final position, $\\vec{P}_{\\text{final}}$, is its position after the second leg, $\\vec{P}_{\\text{actual}}$, plus the displacement of the third leg, $\\vec{d}_3$.\n$$\n\\vec{P}_{\\text{final}} = \\vec{P}_{\\text{actual}} + \\vec{d}_3\n$$\nSubstituting the expressions for $\\vec{P}_{\\text{actual}}$ and $\\vec{d}_3 = \\vec{H}$:\n$$\n\\vec{P}_{\\text{final}} = \\vec{P}_{\\text{actual}} + (-(1+\\gamma)\\vec{P}_{\\text{actual}})\n$$\n$$\n\\vec{P}_{\\text{final}} = (1 - (1+\\gamma))\\vec{P}_{\\text{actual}}\n$$\n$$\n\\vec{P}_{\\text{final}} = -\\gamma \\vec{P}_{\\text{actual}}\n$$\nSubstituting the components of $\\vec{P}_{\\text{actual}}$:\n$$\n\\vec{P}_{\\text{final}} = -\\gamma \\begin{pmatrix} L_1 + L_2 \\cos\\theta \\\\ L_2 \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} -\\gamma(L_1 + L_2 \\cos\\theta) \\\\ -\\gamma L_2 \\sin\\theta \\end{pmatrix}\n$$\nThis vector $\\vec{P}_{\\text{final}}$ represents the final deviation of the agent from the nest. The problem asks for this as a $1 \\times 2$ row vector.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\gamma(L_1 + L_2 \\cos\\theta) & -\\gamma L_2 \\sin\\theta \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The brain's neural integrators are not perfect; they are 'leaky,' meaning their memory of a state passively decays over time. When we model these systems computationally, we must also discretize time, introducing another potential source of instability. This exercise tackles the crucial issue of numerical stability for a discretized leaky integrator, a foundational component in many path integration models. You will derive the Bounded-Input Bounded-Output (BIBO) stability condition, providing a clear mathematical limit on the simulation time step required to prevent the model from producing nonsensical, unbounded outputs. ",
            "id": "3971862",
            "problem": "In models of neural path integration used for head-direction and grid cells, the latent state representing integrated displacement is often implemented as a leaky integrator driven by an estimated velocity input. Consider a one-dimensional leaky path integrator discretized by the forward Euler method with time step $\\Delta t$:\n$$\nx_{k+1} \\;=\\; \\bigl(1 - \\lambda \\,\\Delta t\\bigr)\\,x_k \\;+\\; u_k\\,\\Delta t,\n$$\nwhere $x_k$ is the internal integrator state at discrete time index $k$, $\\lambda > 0$ is the leak constant capturing passive decay due to neural dynamics, and $u_k$ is a bounded input proportional to estimated velocity. Assume $x_0$ is finite and $|u_k| \\le U_{\\max}  \\infty$ for all $k$.\n\nStarting from the definition of bounded-input bounded-output (BIBO) stability for linear time-invariant discrete-time systems and the fundamental solution of linear first-order recursions, derive the necessary and sufficient condition on $\\Delta t$ (as a function of $\\lambda$) that guarantees BIBO stability of this discrete-time integrator for all bounded inputs. Then express the largest allowable time step $\\Delta t_{\\max}$ as a function of $\\lambda$.\n\nFinally, for a leaky integrator with $\\lambda = 9.7\\,\\text{s}^{-1}$, compute $\\Delta t_{\\max}$ in milliseconds and round your answer to four significant figures. Express your final numerical answer in milliseconds. Do not include units in your final boxed answer.",
            "solution": "The problem statement is first validated for correctness and solvability.\n\n### Step 1: Extract Givens\n- The discrete-time leaky integrator model is given by the first-order linear recursion:\n$$x_{k+1} = (1 - \\lambda \\Delta t) x_k + u_k \\Delta t$$\n- $x_k$ is the integrator state at discrete time index $k$.\n- $\\lambda  0$ is the leak constant.\n- $\\Delta t$ is the time step.\n- $u_k$ is the input, which is bounded such that $|u_k| \\le U_{\\max}  \\infty$ for all $k$.\n- $x_0$ is the initial state, which is finite.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The model is a standard forward Euler discretization of the continuous-time leaky integrator differential equation $\\frac{dx}{dt} = -\\lambda x + u$. This is a fundamental model in computational neuroscience for phenomena like path integration and working memory. The concept of Bounded-Input Bounded-Output (BIBO) stability is a cornerstone of linear systems theory. The problem is scientifically and mathematically sound.\n- **Well-Posed:** The problem asks for the derivation of a stability condition and a subsequent numerical calculation. This is a well-defined task with a unique solution based on established principles of discrete-time system analysis.\n- **Objective:** The problem is stated in precise mathematical terms, free of ambiguity or subjective claims.\n- **Completeness and Consistency:** All necessary information ($\\lambda  0$, bounded input) is provided, and there are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe given discrete-time system is a linear time-invariant (LTI) system described by the difference equation:\n$$x_{k+1} = (1 - \\lambda \\Delta t) x_k + u_k \\Delta t$$\nLet us define the constant $a = 1 - \\lambda \\Delta t$. The equation becomes:\n$$x_{k+1} = a x_k + (\\Delta t) u_k$$\nAs suggested by the prompt, we use the fundamental solution of this linear first-order recursion. By unrolling the recursion, we can express $x_k$ in terms of the initial state $x_0$ and the history of the input $u_j$ for $j  k$:\n$$x_1 = a x_0 + (\\Delta t) u_0$$\n$$x_2 = a x_1 + (\\Delta t) u_1 = a(a x_0 + (\\Delta t) u_0) + (\\Delta t) u_1 = a^2 x_0 + a (\\Delta t) u_0 + (\\Delta t) u_1$$\nBy induction, the general solution for $x_k$ is:\n$$x_k = a^k x_0 + \\Delta t \\sum_{j=0}^{k-1} a^{k-1-j} u_j$$\nThe first term, $a^k x_0$, represents the zero-input response (the evolution of the initial state), and the second term, $\\Delta t \\sum_{j=0}^{k-1} a^{k-1-j} u_j$, represents the zero-state response (the evolution due to the input).\n\nA system is defined as Bounded-Input Bounded-Output (BIBO) stable if for every bounded input sequence, the output sequence is also bounded.\nThe input $u_k$ is bounded by assumption: $|u_k| \\le U_{\\max}$ for all $k$.\nTo check if the output $x_k$ is bounded, we take the absolute value of the general solution:\n$$|x_k| = \\left| a^k x_0 + \\Delta t \\sum_{j=0}^{k-1} a^{k-1-j} u_j \\right|$$\nUsing the triangle inequality:\n$$|x_k| \\le |a^k x_0| + \\left| \\Delta t \\sum_{j=0}^{k-1} a^{k-1-j} u_j \\right|$$\n$$|x_k| \\le |a|^k |x_0| + \\Delta t \\sum_{j=0}^{k-1} |a|^{k-1-j} |u_j|$$\nSince $|u_j| \\le U_{\\max}$:\n$$|x_k| \\le |a|^k |x_0| + \\Delta t \\, U_{\\max} \\sum_{j=0}^{k-1} |a|^{k-1-j}$$\nLet $m = k-1-j$. As $j$ ranges from $0$ to $k-1$, $m$ ranges from $k-1$ down to $0$. The sum can be rewritten as:\n$$|x_k| \\le |a|^k |x_0| + \\Delta t \\, U_{\\max} \\sum_{m=0}^{k-1} |a|^m$$\nFor $x_k$ to be bounded for all $k$ and for any finite $x_0$ and any bounded input $u_k$, both terms on the right-hand side must be bounded as $k \\to \\infty$.\n\n1. The first term, $|a|^k |x_0|$, is bounded if $|a| \\le 1$.\n2. The second term contains the partial sum of a geometric series, $\\sum_{m=0}^{k-1} |a|^m$. For this sum to remain bounded as $k \\to \\infty$, the infinite series $\\sum_{m=0}^{\\infty} |a|^m$ must converge. This occurs if and only if $|a|  1$.\n\nIf $|a|  1$, the first term tends to zero as $k \\to \\infty$. The sum in the second term converges to $\\frac{1}{1 - |a|}$. Thus, for any $k$:\n$$|x_k| \\le |x_0| + \\Delta t \\, U_{\\max} \\frac{1}{1 - |a|}$$\nThis shows the output is bounded. If $|a| \\ge 1$, one can construct a bounded input for which the output is unbounded. For example, if $a=1$, the sum becomes $\\sum_{m=0}^{k-1} 1 = k$, which is unbounded. If $a=-1$, a bounded input like $u_k = (-1)^k$ can cause resonant growth. Therefore, the necessary and sufficient condition for BIBO stability is $|a|  1$.\n\nSubstituting $a = 1 - \\lambda \\Delta t$ into the stability condition:\n$$|1 - \\lambda \\Delta t|  1$$\nThis inequality is equivalent to the pair of inequalities:\n$$-1  1 - \\lambda \\Delta t  1$$\nWe analyze each part separately:\n1. Right inequality: $1 - \\lambda \\Delta t  1 \\implies -\\lambda \\Delta t  0$. Since both $\\lambda$ and $\\Delta t$ are given as positive ($\\lambda  0$ and $\\Delta t$ is a time step), their product is positive. Thus, $-\\lambda \\Delta t$ is always negative, and this inequality is always satisfied.\n2. Left inequality: $-1  1 - \\lambda \\Delta t \\implies \\lambda \\Delta t  2$. Since $\\lambda  0$, we can divide by it to get:\n$$\\Delta t  \\frac{2}{\\lambda}$$\nCombining this with the physical constraint that a time step must be positive, $\\Delta t  0$, the necessary and sufficient condition for BIBO stability is:\n$$0  \\Delta t  \\frac{2}{\\lambda}$$\nThe problem asks for the largest allowable time step, $\\Delta t_{\\max}$. This corresponds to the upper boundary of the stability region.\n$$\\Delta t_{\\max} = \\frac{2}{\\lambda}$$\nAt $\\Delta t = \\Delta t_{\\max}$, the system is marginally stable, not BIBO stable, but $\\Delta t_{\\max}$ represents the supremum of the set of time steps for which the system is BIBO stable.\n\nFinally, we compute the numerical value for $\\Delta t_{\\max}$ given $\\lambda = 9.7\\,\\text{s}^{-1}$.\n$$\\Delta t_{\\max} = \\frac{2}{9.7\\,\\text{s}^{-1}} \\approx 0.2061855...\\,\\text{s}$$\nThe problem requires the answer in milliseconds (ms). We convert seconds to milliseconds ($1\\,\\text{s} = 1000\\,\\text{ms}$):\n$$\\Delta t_{\\max} \\approx 0.2061855... \\times 1000\\,\\text{ms} = 206.1855...\\,\\text{ms}$$\nRounding the result to four significant figures:\nThe first four significant figures are $2$, $0$, $6$, $1$. The fifth digit is $8$, which is $5$ or greater, so we round up the last significant digit.\n$$\\Delta t_{\\max} \\approx 206.2\\,\\text{ms}$$\nThe final numerical answer is $206.2$.",
            "answer": "$$\\boxed{206.2}$$"
        }
    ]
}