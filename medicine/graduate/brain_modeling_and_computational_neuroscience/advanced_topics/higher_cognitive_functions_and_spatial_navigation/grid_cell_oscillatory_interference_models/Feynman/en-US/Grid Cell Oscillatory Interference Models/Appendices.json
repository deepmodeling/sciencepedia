{
    "hands_on_practices": [
        {
            "introduction": "The oscillatory interference model posits that grid patterns emerge from the beat patterns created by oscillators whose frequencies are modulated by an animal's velocity. This first practice explores the most fundamental relationship in this model: how the gain of a single velocity-controlled oscillator (VCO) dictates the spatial scale of its output. By working through this derivation, you will solidify your understanding of how the brain can translate dynamic velocity signals into a stable spatial metric. ",
            "id": "3986425",
            "problem": "A planar neuron in the medial entorhinal cortex receives inputs from three Velocity-Controlled Oscillators (VCOs), which are cosine oscillators whose instantaneous phase advances according to the projection of the animal’s velocity onto their preferred directions. Let the preferred unit direction vectors of the three VCOs be $\\mathbf{d}_{1}$, $\\mathbf{d}_{2}$, and $\\mathbf{d}_{3}$, separated by $60^{\\circ}$, and let the animal’s position be $\\mathbf{x}(t)=\\int_{0}^{t}\\mathbf{v}(\\tau)\\,d\\tau$, where $\\mathbf{v}(t)$ is the velocity. Each VCO’s phase relative to a reference oscillator obeys the definition that phase is the time integral of instantaneous angular frequency, with the instantaneous angular frequency offset being proportional to the velocity projection. Specifically, for each $i\\in\\{1,2,3\\}$,\n$$\n\\frac{d\\phi_{i}}{dt}(t)=2\\pi\\,\\alpha\\,\\mathbf{v}(t)\\cdot\\mathbf{d}_{i},\n$$\nwhere $\\phi_{i}(t)$ is the phase in radians and $\\alpha$ is a positive gain constant that converts the velocity projection (in $\\mathrm{m}\\,\\mathrm{s}^{-1}$) into frequency offset (in cycles per second); thus $\\alpha$ has units of cycles per meter. Assume that any common baseline frequency shared with the reference oscillator cancels out in the interference readout, so that only the position-dependent phase remains relevant. The spatial interference pattern produced by combining the three VCOs repeats when each component’s phase advances by $2\\pi$ radians along its own preferred direction.\n\nStarting from the fundamental definitions above (phase is the time integral of angular frequency, position is the time integral of velocity, and one spatial period corresponds to a $2\\pi$ phase advance), derive a closed-form analytic expression for the grid spacing $\\lambda$ (the spatial period in meters) along each $\\mathbf{d}_{i}$ direction in terms of the gain $\\alpha$. Your final answer must be a single symbolic expression. All angles should be treated in radians. Express your final answer for $\\lambda$ in meters. No rounding is required.",
            "solution": "The problem asks for the grid spacing, $\\lambda$, along a preferred direction of a Velocity-Controlled Oscillator (VCO), based on a standard oscillatory interference model for grid cells. To solve this, we must first validate the problem statement.\n\nThe problem is deemed valid. It is scientifically grounded in established theories of computational neuroscience (the oscillatory interference model), it is well-posed with sufficient and consistent information, and it is expressed in objective, formal language. There are no violations of scientific principles, logical inconsistencies, or ambiguities that would prevent a rigorous, unique solution. We may therefore proceed with the derivation.\n\nThe derivation proceeds in two main steps: first, we establish the relationship between the animal's position and the VCO phase, and second, we apply the condition for one spatial period to find the spacing $\\lambda$.\n\nWe begin with the fundamental equation given for the time evolution of the phase $\\phi_i(t)$ of the $i$-th VCO:\n$$\n\\frac{d\\phi_{i}}{dt}(t) = 2\\pi\\,\\alpha\\,\\mathbf{v}(t)\\cdot\\mathbf{d}_{i}\n$$\nHere, $\\phi_i$ is the phase in radians, $\\mathbf{v}(t)$ is the animal's velocity vector, $\\mathbf{d}_i$ is the unit vector for the VCO's preferred direction, and $\\alpha$ is a gain constant with units of cycles per meter. The term $2\\pi$ converts the frequency from cycles per second (Hertz) to angular frequency in radians per second.\n\nTo find the total phase accumulated over a time interval from $t=0$ to $t$, we integrate the above differential equation:\n$$\n\\int_{0}^{t} \\frac{d\\phi_{i}}{d\\tau}\\,d\\tau = \\int_{0}^{t} 2\\pi\\,\\alpha\\,\\mathbf{v}(\\tau)\\cdot\\mathbf{d}_{i}\\,d\\tau\n$$\nAssuming the initial phase is $\\phi_i(0)=0$ (since we are concerned with phase changes), the left side becomes $\\phi_i(t)$. On the right side, the constants $2\\pi$ and $\\alpha$, as well as the constant vector $\\mathbf{d}_i$, can be moved outside the integral. The dot product is a linear operation and can be interchanged with the integration.\n$$\n\\phi_i(t) = 2\\pi\\,\\alpha \\left( \\int_{0}^{t} \\mathbf{v}(\\tau)\\,d\\tau \\right) \\cdot \\mathbf{d}_{i}\n$$\nThe problem provides the definition for the animal's position vector $\\mathbf{x}(t)$ as the time integral of its velocity, assuming it starts from the origin, i.e., $\\mathbf{x}(0) = \\mathbf{0}$:\n$$\n\\mathbf{x}(t) = \\int_{0}^{t} \\mathbf{v}(\\tau)\\,d\\tau\n$$\nSubstituting this into our expression for phase gives the phase as a direct function of the animal's position:\n$$\n\\phi_i(\\mathbf{x}) = 2\\pi\\,\\alpha\\,\\mathbf{x}\\cdot\\mathbf{d}_{i}\n$$\nThis equation reveals that the phase of the oscillator is proportional to the projection of the animal's position vector onto the oscillator's preferred direction vector.\n\nNext, we use the condition that defines the grid spacing $\\lambda$. The problem states that the spatial pattern repeats, defining one spatial period, when the phase advances by $2\\pi$ radians for a movement along the preferred direction. Let us consider a displacement purely along the direction $\\mathbf{d}_i$. The starting position is $\\mathbf{x}_{\\text{start}} = \\mathbf{0}$ and the final position is $\\mathbf{x}_{\\text{end}}$, which is located at a distance $\\lambda$ along the direction $\\mathbf{d}_i$. Thus, the displacement vector is $\\mathbf{x}_{\\text{end}} = \\lambda \\mathbf{d}_i$.\n\nThe change in phase, $\\Delta\\phi_i$, corresponding to this displacement is:\n$$\n\\Delta\\phi_i = \\phi_i(\\mathbf{x}_{\\text{end}}) - \\phi_i(\\mathbf{x}_{\\text{start}})\n$$\nSubstituting our expression for phase in terms of position:\n$$\n\\Delta\\phi_i = (2\\pi\\,\\alpha\\,\\mathbf{x}_{\\text{end}}\\cdot\\mathbf{d}_{i}) - (2\\pi\\,\\alpha\\,\\mathbf{x}_{\\text{start}}\\cdot\\mathbf{d}_{i})\n$$\nWith $\\mathbf{x}_{\\text{start}} = \\mathbf{0}$ and $\\mathbf{x}_{\\text{end}} = \\lambda \\mathbf{d}_i$, the equation becomes:\n$$\n\\Delta\\phi_i = 2\\pi\\,\\alpha\\,(\\lambda \\mathbf{d}_i)\\cdot\\mathbf{d}_{i}\n$$\nSince $\\mathbf{d}_i$ is a unit vector, the dot product $\\mathbf{d}_i \\cdot \\mathbf{d}_i = |\\mathbf{d}_i|^2 = 1^2 = 1$. The expression simplifies to:\n$$\n\\Delta\\phi_i = 2\\pi\\,\\alpha\\,\\lambda\n$$\nAccording to the problem's definition of a spatial period, this phase change must be equal to $2\\pi$ radians.\n$$\n2\\pi = 2\\pi\\,\\alpha\\,\\lambda\n$$\nWe can now solve for the grid spacing $\\lambda$ by dividing both sides by $2\\pi\\alpha$ (noting that $\\alpha$ is a positive constant, so $\\alpha \\neq 0$):\n$$\n\\lambda = \\frac{2\\pi}{2\\pi\\alpha} = \\frac{1}{\\alpha}\n$$\nThe result states that the grid spacing is simply the reciprocal of the gain constant $\\alpha$. This is consistent from a units perspective: if $\\alpha$ is in cycles/meter, then $\\lambda = 1/\\alpha$ is in meters/cycle. Since a spatial period represents one \"cycle\" on the grid, the unit is effectively meters, as required. The information regarding the three VCOs and their $60^{\\circ}$ separation is necessary for determining the hexagonal geometry of the full grid but is not required for calculating the fundamental spacing $\\lambda$ along a single preferred direction, which is solely determined by the gain $\\alpha$.",
            "answer": "$$\n\\boxed{\\frac{1}{\\alpha}}\n$$"
        },
        {
            "introduction": "While a single oscillator can encode distance along one direction, the iconic hexagonal firing pattern of a grid cell requires the combination of several. This exercise transitions from the one-dimensional case to the full two-dimensional grid, modeling the inputs as interfering plane waves. You will derive the primitive lattice vectors that define the hexagonal grid, calculate its spacing and orientation, and demonstrate the model's elegant rotational covariance. ",
            "id": "3986406",
            "problem": "Consider a standard oscillatory interference account of medial entorhinal cortex grid cells in which the spatial firing pattern arises from the linear superposition of three planar membrane current components (plane waves) with equal wavenumber magnitude and distinct directions. Let the spatial drive be modeled as a function $S(\\mathbf{r}) = \\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{r} + \\phi_i)$ at position $\\mathbf{r} \\in \\mathbb{R}^2$, where $\\phi_i$ are fixed phases and the wavevectors satisfy $|\\mathbf{k}_i| = k$ for all $i$ and $\\mathbf{k}_2 = k \\mathbf{d}_2$, $\\mathbf{k}_3 = k \\mathbf{d}_3$ with unit direction vectors $\\mathbf{d}_i \\in \\mathbb{R}^2$ such that the directions are separated by $120^\\circ$ (i.e., the angles differ by $2\\pi/3$ radians). Let the first direction be $\\mathbf{d}_1 = R(\\alpha)\\,\\mathbf{e}_x$, where $\\mathbf{e}_x$ is the unit vector along the $x$-axis and $R(\\alpha)$ is the $2 \\times 2$ rotation matrix by angle $\\alpha$ in radians. The remaining directions are $\\mathbf{d}_2 = R(\\alpha + 2\\pi/3)\\,\\mathbf{e}_x$ and $\\mathbf{d}_3 = R(\\alpha + 4\\pi/3)\\,\\mathbf{e}_x$. Assume the phases $\\phi_i$ are chosen so that the maxima of $S(\\mathbf{r})$ occur at points where each contributing cosine is simultaneously maximized.\n\nStarting from the basic properties of plane waves and the definition of a lattice as the set of positions $\\mathbf{r}$ satisfying linear phase constraints with integer indices, derive the primitive lattice vectors of the spatial code and, from these, compute the lattice spacing $\\lambda$ (defined as the magnitude of either primitive vector) and a well-defined orientation angle of the grid (defined as the angle, in radians, of the primitive vector $\\mathbf{a}_2$ relative to the $x$-axis). Then, using the rotational properties of dot products and rotation matrices, show that rotating the set of direction vectors $\\{\\mathbf{d}_i\\}$ by any angle $\\theta$ rotates the resulting grid by the same angle $\\theta$ while preserving the lattice spacing $\\lambda$.\n\nYour final answer must be a single analytical expression containing two entries: the lattice spacing $\\lambda$ and the grid orientation angle (in radians) expressed in terms of $k$ and $\\alpha$. Express your answer symbolically; do not substitute numerical values. Do not include units in your boxed answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Spatial drive function: $S(\\mathbf{r}) = \\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{r} + \\phi_i)$\n- Position vector: $\\mathbf{r} \\in \\mathbb{R}^2$\n- Phases: $\\phi_i$ are fixed.\n- Wavevector magnitude: $|\\mathbf{k}_i| = k$ for $i \\in \\{1, 2, 3\\}$.\n- Wavevector directions: $\\mathbf{k}_i = k \\mathbf{d}_i$, where the unit direction vectors $\\mathbf{d}_i$ are separated by $120^\\circ$ ($2\\pi/3$ radians).\n- Direction vector definitions:\n  - $\\mathbf{d}_1 = R(\\alpha)\\,\\mathbf{e}_x$\n  - $\\mathbf{d}_2 = R(\\alpha + 2\\pi/3)\\,\\mathbf{e}_x$\n  - $\\mathbf{d}_3 = R(\\alpha + 4\\pi/3)\\,\\mathbf{e}_x$\n- Rotation matrix: $R(\\theta)$ is the standard $2 \\times 2$ rotation matrix for an angle $\\theta$.\n- Maximum condition: The maxima of $S(\\mathbf{r})$ occur at positions $\\mathbf{r}$ where each term $\\cos(\\mathbf{k}_i \\cdot \\mathbf{r} + \\phi_i)$ is simultaneously maximized (equal to $1$).\n- Definition of lattice spacing $\\lambda$: The magnitude of either primitive lattice vector.\n- Definition of grid orientation: The angle of the primitive vector $\\mathbf{a}_2$ relative to the $x$-axis.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes the oscillatory interference model, a cornerstone theory in computational neuroscience for explaining the firing patterns of grid cells. The mathematical formulation is standard and correct.\n- **Well-Posed**: The problem is well-posed. It provides sufficient information and clear definitions to derive the requested quantities ($\\lambda$ and orientation angle) and to construct the required proof. The constraints lead to a unique and meaningful solution.\n- **Objective**: The language is formal, mathematical, and precise, with no subjective or ambiguous statements.\n\nThe problem is free of the specified flaws (e.g., scientific unsoundness, incompleteness, ambiguity). It is a standard, non-trivial problem in theoretical neuroscience.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe vertices of the grid cell's firing lattice are the positions $\\mathbf{r}$ where the spatial drive $S(\\mathbf{r})$ is maximized. According to the problem, this occurs when all three cosine components are simultaneously equal to $1$. Without loss of generality for determining the lattice structure, we can set the phases $\\phi_i$ to $0$ (which corresponds to choosing the origin $\\mathbf{r}=\\mathbf{0}$ as a lattice point). The condition for a point $\\mathbf{r}$ to be a lattice vertex is then:\n$$ \\mathbf{k}_i \\cdot \\mathbf{r} = 2 \\pi n_i, \\quad \\text{for } i \\in \\{1, 2, 3\\}, \\text{ where } n_i \\in \\mathbb{Z} $$\n\nThe wavevectors $\\mathbf{k}_i = k \\mathbf{d}_i$ are defined by direction vectors $\\{\\mathbf{d}_1, \\mathbf{d}_2, \\mathbf{d}_3\\}$ that are separated by $2\\pi/3$ radians. A fundamental property of three coplanar vectors of equal magnitude separated by $120^\\circ$ is that their sum is zero.\n$$ \\mathbf{d}_1 + \\mathbf{d}_2 + \\mathbf{d}_3 = \\mathbf{0} \\implies \\mathbf{k}_1 + \\mathbf{k}_2 + \\mathbf{k}_3 = \\mathbf{0} $$\nSumming the three constraint equations for the lattice points gives:\n$$ (\\mathbf{k}_1 + \\mathbf{k}_2 + \\mathbf{k}_3) \\cdot \\mathbf{r} = 2 \\pi (n_1 + n_2 + n_3) $$\n$$ \\mathbf{0} \\cdot \\mathbf{r} = 2 \\pi (n_1 + n_2 + n_3) \\implies n_1 + n_2 + n_3 = 0 $$\nThis dependency means that only two of the three equations are independent. We can choose the first two to define the lattice:\n$$ \\mathbf{k}_1 \\cdot \\mathbf{r} = 2 \\pi n_1 $$\n$$ \\mathbf{k}_2 \\cdot \\mathbf{r} = 2 \\pi n_2 $$\n\nThese two equations define a lattice in $\\mathbb{R}^2$. The primitive lattice vectors, $\\mathbf{a}_1$ and $\\mathbf{a}_2$, form a basis for this lattice. Any lattice point can be written as $\\mathbf{r} = m_1 \\mathbf{a}_1 + m_2 \\mathbf{a}_2$ for integers $m_1, m_2$. These primitive vectors are related to the wavevectors, which form a basis for the reciprocal lattice. Let $K$ be a matrix whose rows are the basis wavevectors $\\mathbf{k}_1^T$ and $\\mathbf{k}_2^T$:\n$$ K = \\begin{pmatrix} \\mathbf{k}_1^T \\\\ \\mathbf{k}_2^T \\end{pmatrix} = \\begin{pmatrix} k_{1x} & k_{1y} \\\\ k_{2x} & k_{2y} \\end{pmatrix} $$\nThe primitive lattice vectors $\\mathbf{a}_1$ and $\\mathbf{a}_2$ are the columns of a matrix $A$ satisfying the duality condition $K A = 2\\pi I$, where $I$ is the $2 \\times 2$ identity matrix. The matrix of primitive vectors is therefore given by $A = 2\\pi K^{-1}$.\n\nThe components of the wavevectors are:\n$$ \\mathbf{k}_1 = k \\begin{pmatrix} \\cos\\alpha \\\\ \\sin\\alpha \\end{pmatrix}, \\quad \\mathbf{k}_2 = k \\begin{pmatrix} \\cos(\\alpha + 2\\pi/3) \\\\ \\sin(\\alpha + 2\\pi/3) \\end{pmatrix} $$\nSo the matrix of their components is:\n$$ K = k \\begin{pmatrix} \\cos\\alpha & \\sin\\alpha \\\\ \\cos(\\alpha + 2\\pi/3) & \\sin(\\alpha + 2\\pi/3) \\end{pmatrix} $$\nThe determinant of $K$ is:\n$$ \\det(K) = k^2 [\\cos\\alpha \\sin(\\alpha + 2\\pi/3) - \\sin\\alpha \\cos(\\alpha + 2\\pi/3)] = k^2 \\sin((\\alpha + 2\\pi/3) - \\alpha) = k^2 \\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2}k^2 $$\nThe inverse of $K$ is:\n$$ K^{-1} = \\frac{1}{\\det(K)} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3) & -\\sin\\alpha \\\\ -\\cos(\\alpha + 2\\pi/3) & \\cos\\alpha \\end{pmatrix} = \\frac{2}{k^2\\sqrt{3}} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3) & -\\sin\\alpha \\\\ -\\cos(\\alpha + 2\\pi/3) & \\cos\\alpha \\end{pmatrix} $$\nThe matrix of primitive vectors is $A = 2\\pi K^{-1}$:\n$$ A = \\frac{4\\pi}{k^2\\sqrt{3}} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3) & -\\sin\\alpha \\\\ -\\cos(\\alpha + 2\\pi/3) & \\cos\\alpha \\end{pmatrix} $$\nThe columns of $A$ are the primitive vectors $\\mathbf{a}_1$ and $\\mathbf{a}_2$:\n$$ \\mathbf{a}_1 = \\frac{4\\pi}{k\\sqrt{3}} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3) \\\\ -\\cos(\\alpha + 2\\pi/3) \\end{pmatrix}, \\quad \\mathbf{a}_2 = \\frac{4\\pi}{k\\sqrt{3}} \\begin{pmatrix} -\\sin\\alpha \\\\ \\cos\\alpha \\end{pmatrix} $$\n\n**Lattice Spacing, $\\lambda$**\nThe lattice spacing $\\lambda$ is defined as the magnitude of either primitive vector. Let's compute $|\\mathbf{a}_2|$:\n$$ |\\mathbf{a}_2|^2 = \\left(\\frac{4\\pi}{k\\sqrt{3}}\\right)^2 ( (-\\sin\\alpha)^2 + (\\cos\\alpha)^2 ) = \\left(\\frac{4\\pi}{k\\sqrt{3}}\\right)^2 (\\sin^2\\alpha + \\cos^2\\alpha) = \\left(\\frac{4\\pi}{k\\sqrt{3}}\\right)^2 $$\n$$ \\lambda = |\\mathbf{a}_2| = \\frac{4\\pi}{k\\sqrt{3}} $$\nThe magnitude of $\\mathbf{a}_1$ is identical, as expected for a hexagonal lattice.\n\n**Grid Orientation Angle**\nThe grid orientation is the angle of $\\mathbf{a}_2$ with the positive x-axis. The vector part of $\\mathbf{a}_2$ is $(-\\sin\\alpha, \\cos\\alpha)^T$. We can express this vector using a rotation:\n$$ \\begin{pmatrix} -\\sin\\alpha \\\\ \\cos\\alpha \\end{pmatrix} = \\begin{pmatrix} \\cos(\\alpha + \\pi/2) \\\\ \\sin(\\alpha + \\pi/2) \\end{pmatrix} $$\nThis shows that the direction of $\\mathbf{a}_2$ is given by the angle $\\alpha + \\pi/2$.\n\n**Proof of Rotational Covariance**\nWe must show that rotating the set of direction vectors $\\{\\mathbf{d}_i\\}$ by an angle $\\theta$ rotates the resulting grid by $\\theta$ while preserving the lattice spacing $\\lambda$.\nThe original lattice points $\\mathbf{r}$ are defined by the system of equations $\\mathbf{k}_i \\cdot \\mathbf{r} = 2\\pi n_i$.\nLet the new direction vectors be $\\mathbf{d}'_i = R(\\theta)\\mathbf{d}_i$. The new wavevectors are $\\mathbf{k}'_i = k \\mathbf{d}'_i = k R(\\theta) \\mathbf{d}_i = R(\\theta) (k \\mathbf{d}_i) = R(\\theta)\\mathbf{k}_i$.\nThe new lattice points $\\mathbf{r}'$ are defined by the new system of equations:\n$$ \\mathbf{k}'_i \\cdot \\mathbf{r}' = 2\\pi n_i \\implies (R(\\theta)\\mathbf{k}_i) \\cdot \\mathbf{r}' = 2\\pi n_i $$\nA key property of the dot product under rotations is $(R(\\theta)\\mathbf{u}) \\cdot \\mathbf{v} = \\mathbf{u} \\cdot (R(-\\theta)\\mathbf{v})$. Applying this, we get:\n$$ \\mathbf{k}_i \\cdot (R(-\\theta)\\mathbf{r}') = 2\\pi n_i $$\nComparing this with the original condition $\\mathbf{k}_i \\cdot \\mathbf{r} = 2\\pi n_i$, we see that the set of vectors satisfying the new condition is given by $R(-\\theta)\\mathbf{r}' = \\mathbf{r}$.\nApplying the rotation $R(\\theta)$ to both sides gives $\\mathbf{r}' = R(\\theta)\\mathbf{r}$.\nThis proves that every point $\\mathbf{r}'$ in the new lattice is a rotated version of a point $\\mathbf{r}$ in the old lattice. The entire grid is therefore rotated by the angle $\\theta$.\n\nThe lattice spacing $\\lambda$ is the length of a primitive vector. Let $\\mathbf{a}$ be a primitive vector of the original lattice. The corresponding primitive vector of the new lattice is $\\mathbf{a}' = R(\\theta)\\mathbf{a}$. Since rotations are isometries (length-preserving transformations), we have $|\\mathbf{a}'| = |R(\\theta)\\mathbf{a}| = |\\mathbf{a}|$.\nTherefore, the new lattice spacing $\\lambda'$ is equal to the original lattice spacing $\\lambda$. The lattice spacing is invariant under rotation of the wavevectors.\n\nThe final answer consists of the lattice spacing $\\lambda$ and the grid orientation angle.\nLattice Spacing: $\\lambda = \\frac{4\\pi}{k\\sqrt{3}}$\nGrid Orientation: $\\alpha + \\frac{\\pi}{2}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{4\\pi}{k\\sqrt{3}} & \\alpha + \\frac{\\pi}{2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "An essential function of the grid cell system is path integration, but any physical integrator is susceptible to noise accumulation. This final practice confronts this critical issue by modeling the impact of random frequency fluctuations within the velocity-controlled oscillators. By deriving the mean-squared error of the spatial phase over time, you will quantify how noise leads to drift in the grid representation, a fundamental challenge for any neural integrator. ",
            "id": "3986399",
            "problem": "Consider a canonical oscillatory interference model of medial entorhinal cortex grid cells in which a single grid cell’s interferometric phase is constructed from a set of $M$ velocity-controlled oscillators (VCOs). Each velocity-controlled oscillator (VCO) has instantaneous frequency $f_{i}(t)$ given by $f_{i}(t) = f_{0} + \\gamma\\,\\mathbf{k}_{i}\\cdot\\mathbf{v}(t) + \\eta_{i}(t)$, where $f_{0}$ is a constant baseline frequency in $\\mathrm{Hz}$, $\\gamma$ is a gain in $\\mathrm{Hz}\\cdot\\mathrm{s}/\\mathrm{m}$ converting projected speed to frequency, $\\mathbf{k}_{i}$ is a fixed unit direction vector in the plane, $\\mathbf{v}(t)$ is the animal’s velocity, and $\\eta_{i}(t)$ is zero-mean stationary frequency noise in $\\mathrm{Hz}$. The phase of oscillator $i$ is $\\theta_{i}(t) = 2\\pi \\int_{0}^{t} f_{i}(s)\\,\\mathrm{d}s$, in radians. The grid cell’s spatial interferometric phase is defined as a weighted sum of these phases, $\\Phi(t) = \\sum_{i=1}^{M} w_{i}\\,\\theta_{i}(t)$, with fixed weights $w_{i}\\in\\mathbb{R}$.\n\nAssume that the velocity $\\mathbf{v}(t)$ is deterministic and bounded, and that all frequency noises $\\eta_{i}(t)$ are mutually independent, zero-mean, stationary white processes with power spectral density (PSD) $S_{f}$, understood in the time domain by the autocorrelation representation $\\langle \\eta_{i}(t)\\,\\eta_{j}(t')\\rangle = S_{f}\\,\\delta(t-t')\\,\\delta_{ij}$, where $\\delta(\\cdot)$ is the Dirac delta distribution, $\\delta_{ij}$ is the Kronecker delta, and angle brackets denote ensemble expectation. Define the spatial phase error as the deviation of the interferometric phase from its noiseless value, $\\Delta\\phi(t) = \\Phi(t) - \\Phi_{\\text{noiseless}}(t)$, where $\\Phi_{\\text{noiseless}}(t)$ is the value of $\\Phi(t)$ with $\\eta_{i}(t)\\equiv 0$.\n\nStarting only from the definitions above and the stated properties of white noise, derive the expected mean-squared spatial phase error $\\langle \\Delta\\phi^{2}(t)\\rangle$ as an explicit closed-form expression in terms of $S_{f}$, $t$, and the weights $\\{w_{i}\\}_{i=1}^{M}$. Express your final answer in radians squared. No numerical values are required.",
            "solution": "The interferometric phase is defined by $\\Phi(t) = \\sum_{i=1}^{M} w_{i}\\,\\theta_{i}(t)$ with $\\theta_{i}(t) = 2\\pi\\int_{0}^{t} f_{i}(s)\\,\\mathrm{d}s$. Splitting $f_{i}(t)$ into deterministic and stochastic parts,\n\n$$\nf_{i}(t) = f_{0} + \\gamma\\,\\mathbf{k}_{i}\\cdot\\mathbf{v}(t) + \\eta_{i}(t),\n$$\n\nwe write the phase as\n\n$$\n\\theta_{i}(t) = 2\\pi \\int_{0}^{t} \\big(f_{0} + \\gamma\\,\\mathbf{k}_{i}\\cdot\\mathbf{v}(s)\\big)\\,\\mathrm{d}s \\;+\\; 2\\pi \\int_{0}^{t} \\eta_{i}(s)\\,\\mathrm{d}s.\n$$\n\nThe noiseless phase is\n\n$$\n\\theta_{i,\\text{noiseless}}(t) = 2\\pi \\int_{0}^{t} \\big(f_{0} + \\gamma\\,\\mathbf{k}_{i}\\cdot\\mathbf{v}(s)\\big)\\,\\mathrm{d}s,\n$$\n\nso the phase error contribution from oscillator $i$ is\n\n$$\n\\Delta\\theta_{i}(t) = \\theta_{i}(t) - \\theta_{i,\\text{noiseless}}(t) = 2\\pi \\int_{0}^{t} \\eta_{i}(s)\\,\\mathrm{d}s.\n$$\n\nBy definition, the spatial phase error is the weighted sum of these phase errors:\n\n$$\n\\Delta\\phi(t) = \\sum_{i=1}^{M} w_{i}\\,\\Delta\\theta_{i}(t) = 2\\pi \\sum_{i=1}^{M} w_{i} \\int_{0}^{t} \\eta_{i}(s)\\,\\mathrm{d}s.\n$$\n\nWe compute the expected mean-squared phase error using the independence and white-noise properties. Because each $\\eta_{i}(t)$ is zero mean, $\\langle \\Delta\\phi(t)\\rangle = 0$, and\n\n$$\n\\langle \\Delta\\phi^{2}(t)\\rangle = \\langle \\Delta\\phi(t)\\,\\Delta\\phi(t)\\rangle = (2\\pi)^{2} \\left\\langle \\left( \\sum_{i=1}^{M} w_{i} \\int_{0}^{t} \\eta_{i}(u)\\,\\mathrm{d}u \\right) \\left( \\sum_{j=1}^{M} w_{j} \\int_{0}^{t} \\eta_{j}(v)\\,\\mathrm{d}v \\right) \\right\\rangle.\n$$\n\nExpanding the product and using linearity of expectation,\n\n$$\n\\langle \\Delta\\phi^{2}(t)\\rangle = (2\\pi)^{2} \\sum_{i=1}^{M} \\sum_{j=1}^{M} w_{i} w_{j} \\int_{0}^{t} \\int_{0}^{t} \\langle \\eta_{i}(u)\\,\\eta_{j}(v) \\rangle \\,\\mathrm{d}u\\,\\mathrm{d}v.\n$$\n\nIndependence and the autocorrelation representation yield\n\n$$\n\\langle \\eta_{i}(u)\\,\\eta_{j}(v) \\rangle = S_{f}\\,\\delta(u-v)\\,\\delta_{ij}.\n$$\n\nTherefore, only the terms with $i=j$ survive:\n\n$$\n\\langle \\Delta\\phi^{2}(t)\\rangle = (2\\pi)^{2} \\sum_{i=1}^{M} w_{i}^{2} \\int_{0}^{t} \\int_{0}^{t} S_{f}\\,\\delta(u-v) \\,\\mathrm{d}u\\,\\mathrm{d}v.\n$$\n\nEvaluate the double integral by integrating over $v$ first:\n\n$$\n\\int_{0}^{t} \\int_{0}^{t} S_{f}\\,\\delta(u-v) \\,\\mathrm{d}u\\,\\mathrm{d}v = S_{f} \\int_{0}^{t} \\left( \\int_{0}^{t} \\delta(u-v)\\,\\mathrm{d}u \\right) \\mathrm{d}v = S_{f} \\int_{0}^{t} 1\\,\\mathrm{d}v = S_{f}\\,t.\n$$\n\nSubstituting back, we obtain\n\n$$\n\\langle \\Delta\\phi^{2}(t)\\rangle = (2\\pi)^{2}\\,S_{f}\\,t \\,\\sum_{i=1}^{M} w_{i}^{2}.\n$$\n\nThis expression is in radians squared, as required, because each $\\Delta\\theta_{i}(t)$ is in radians and the weights $w_{i}$ are dimensionless.",
            "answer": "$$\\boxed{(2\\pi)^{2}\\,S_{f}\\,t\\,\\sum_{i=1}^{M} w_{i}^{2}}$$"
        }
    ]
}