{
    "hands_on_practices": [
        {
            "introduction": "The oscillatory interference model is built upon the concept of Velocity-Controlled Oscillators (VCOs), whose frequencies are modulated by an animal's movement. This first exercise  takes you back to first principles to derive the foundational relationship between a VCO's velocity gain, $\\alpha$, and the spatial period, $\\lambda$, of its resulting activity pattern. Understanding this direct link is the first step toward building a complete grid cell model.",
            "id": "3986425",
            "problem": "A planar neuron in the medial entorhinal cortex receives inputs from three Velocity-Controlled Oscillators (VCOs), which are cosine oscillators whose instantaneous phase advances according to the projection of the animal’s velocity onto their preferred directions. Let the preferred unit direction vectors of the three VCOs be $\\mathbf{d}_{1}$, $\\mathbf{d}_{2}$, and $\\mathbf{d}_{3}$, separated by $60^{\\circ}$, and let the animal’s position be $\\mathbf{x}(t)=\\int_{0}^{t}\\mathbf{v}(\\tau)\\,d\\tau$, where $\\mathbf{v}(t)$ is the velocity. Each VCO’s phase relative to a reference oscillator obeys the definition that phase is the time integral of instantaneous angular frequency, with the instantaneous angular frequency offset being proportional to the velocity projection. Specifically, for each $i\\in\\{1,2,3\\}$,\n$$\n\\frac{d\\phi_{i}}{dt}(t)=2\\pi\\,\\alpha\\,\\mathbf{v}(t)\\cdot\\mathbf{d}_{i},\n$$\nwhere $\\phi_{i}(t)$ is the phase in radians and $\\alpha$ is a positive gain constant that converts the velocity projection (in $\\mathrm{m}\\,\\mathrm{s}^{-1}$) into frequency offset (in cycles per second); thus $\\alpha$ has units of cycles per meter. Assume that any common baseline frequency shared with the reference oscillator cancels out in the interference readout, so that only the position-dependent phase remains relevant. The spatial interference pattern produced by combining the three VCOs repeats when each component’s phase advances by $2\\pi$ radians along its own preferred direction.\n\nStarting from the fundamental definitions above (phase is the time integral of angular frequency, position is the time integral of velocity, and one spatial period corresponds to a $2\\pi$ phase advance), derive a closed-form analytic expression for the grid spacing $\\lambda$ (the spatial period in meters) along each $\\mathbf{d}_{i}$ direction in terms of the gain $\\alpha$. Your final answer must be a single symbolic expression. All angles should be treated in radians. Express your final answer for $\\lambda$ in meters. No rounding is required.",
            "solution": "The problem asks for the grid spacing, $\\lambda$, along a preferred direction of a Velocity-Controlled Oscillator (VCO), based on a standard oscillatory interference model for grid cells. To solve this, we must first validate the problem statement.\n\nThe problem is deemed valid. It is scientifically grounded in established theories of computational neuroscience (the oscillatory interference model), it is well-posed with sufficient and consistent information, and it is expressed in objective, formal language. There are no violations of scientific principles, logical inconsistencies, or ambiguities that would prevent a rigorous, unique solution. We may therefore proceed with the derivation.\n\nThe derivation proceeds in two main steps: first, we establish the relationship between the animal's position and the VCO phase, and second, we apply the condition for one spatial period to find the spacing $\\lambda$.\n\nWe begin with the fundamental equation given for the time evolution of the phase $\\phi_i(t)$ of the $i$-th VCO:\n$$\n\\frac{d\\phi_{i}}{dt}(t) = 2\\pi\\,\\alpha\\,\\mathbf{v}(t)\\cdot\\mathbf{d}_{i}\n$$\nHere, $\\phi_i$ is the phase in radians, $\\mathbf{v}(t)$ is the animal's velocity vector, $\\mathbf{d}_i$ is the unit vector for the VCO's preferred direction, and $\\alpha$ is a gain constant with units of cycles per meter. The term $2\\pi$ converts the frequency from cycles per second (Hertz) to angular frequency in radians per second.\n\nTo find the total phase accumulated over a time interval from $t=0$ to $t$, we integrate the above differential equation:\n$$\n\\int_{0}^{t} \\frac{d\\phi_{i}}{d\\tau}\\,d\\tau = \\int_{0}^{t} 2\\pi\\,\\alpha\\,\\mathbf{v}(\\tau)\\cdot\\mathbf{d}_{i}\\,d\\tau\n$$\nAssuming the initial phase is $\\phi_i(0)=0$ (since we are concerned with phase changes), the left side becomes $\\phi_i(t)$. On the right side, the constants $2\\pi$ and $\\alpha$, as well as the constant vector $\\mathbf{d}_i$, can be moved outside the integral. The dot product is a linear operation and can be interchanged with the integration.\n$$\n\\phi_i(t) = 2\\pi\\,\\alpha \\left( \\int_{0}^{t} \\mathbf{v}(\\tau)\\,d\\tau \\right) \\cdot \\mathbf{d}_{i}\n$$\nThe problem provides the definition for the animal's position vector $\\mathbf{x}(t)$ as the time integral of its velocity, assuming it starts from the origin, i.e., $\\mathbf{x}(0) = \\mathbf{0}$:\n$$\n\\mathbf{x}(t) = \\int_{0}^{t} \\mathbf{v}(\\tau)\\,d\\tau\n$$\nSubstituting this into our expression for phase gives the phase as a direct function of the animal's position:\n$$\n\\phi_i(\\mathbf{x}) = 2\\pi\\,\\alpha\\,\\mathbf{x}\\cdot\\mathbf{d}_{i}\n$$\nThis equation reveals that the phase of the oscillator is proportional to the projection of the animal's position vector onto the oscillator's preferred direction vector.\n\nNext, we use the condition that defines the grid spacing $\\lambda$. The problem states that the spatial pattern repeats, defining one spatial period, when the phase advances by $2\\pi$ radians for a movement along the preferred direction. Let us consider a displacement purely along the direction $\\mathbf{d}_i$. The starting position is $\\mathbf{x}_{\\text{start}} = \\mathbf{0}$ and the final position is $\\mathbf{x}_{\\text{end}}$, which is located at a distance $\\lambda$ along the direction $\\mathbf{d}_i$. Thus, the displacement vector is $\\mathbf{x}_{\\text{end}} = \\lambda \\mathbf{d}_i$.\n\nThe change in phase, $\\Delta\\phi_i$, corresponding to this displacement is:\n$$\n\\Delta\\phi_i = \\phi_i(\\mathbf{x}_{\\text{end}}) - \\phi_i(\\mathbf{x}_{\\text{start}})\n$$\nSubstituting our expression for phase in terms of position:\n$$\n\\Delta\\phi_i = (2\\pi\\,\\alpha\\,\\mathbf{x}_{\\text{end}}\\cdot\\mathbf{d}_{i}) - (2\\pi\\,\\alpha\\,\\mathbf{x}_{\\text{start}}\\cdot\\mathbf{d}_{i})\n$$\nWith $\\mathbf{x}_{\\text{start}} = \\mathbf{0}$ and $\\mathbf{x}_{\\text{end}} = \\lambda \\mathbf{d}_i$, the equation becomes:\n$$\n\\Delta\\phi_i = 2\\pi\\,\\alpha\\,(\\lambda \\mathbf{d}_i)\\cdot\\mathbf{d}_{i}\n$$\nSince $\\mathbf{d}_i$ is a unit vector, the dot product $\\mathbf{d}_i \\cdot \\mathbf{d}_i = |\\mathbf{d}_i|^2 = 1^2 = 1$. The expression simplifies to:\n$$\n\\Delta\\phi_i = 2\\pi\\,\\alpha\\,\\lambda\n$$\nAccording to the problem's definition of a spatial period, this phase change must be equal to $2\\pi$ radians.\n$$\n2\\pi = 2\\pi\\,\\alpha\\,\\lambda\n$$\nWe can now solve for the grid spacing $\\lambda$ by dividing both sides by $2\\pi\\alpha$ (noting that $\\alpha$ is a positive constant, so $\\alpha \\neq 0$):\n$$\n\\lambda = \\frac{2\\pi}{2\\pi\\alpha} = \\frac{1}{\\alpha}\n$$\nThe result states that the grid spacing is simply the reciprocal of the gain constant $\\alpha$. This is consistent from a units perspective: if $\\alpha$ is in cycles/meter, then $\\lambda = 1/\\alpha$ is in meters/cycle. Since a spatial period represents one \"cycle\" on the grid, the unit is effectively meters, as required. The information regarding the three VCOs and their $60^{\\circ}$ separation is necessary for determining the hexagonal geometry of the full grid but is not required for calculating the fundamental spacing $\\lambda$ along a single preferred direction, which is solely determined by the gain $\\alpha$.",
            "answer": "$$\n\\boxed{\\frac{1}{\\alpha}}\n$$"
        },
        {
            "introduction": "While a single VCO creates a one-dimensional pattern of stripes, grid cells exhibit two-dimensional hexagonal firing fields. This practice  demonstrates how the superposition of three such periodic inputs, modeled as plane waves, generates the full hexagonal lattice. By working through this derivation, you will connect the abstract properties of the input wavevectors to the concrete, measurable features of the grid: its spacing and orientation.",
            "id": "3986406",
            "problem": "Consider a standard oscillatory interference account of medial entorhinal cortex grid cells in which the spatial firing pattern arises from the linear superposition of three planar membrane current components (plane waves) with equal wavenumber magnitude and distinct directions. Let the spatial drive be modeled as a function $S(\\mathbf{r}) = \\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{r} + \\phi_i)$ at position $\\mathbf{r} \\in \\mathbb{R}^2$, where $\\phi_i$ are fixed phases and the wavevectors satisfy $|\\mathbf{k}_i| = k$ for all $i$ and $\\mathbf{k}_2 = k \\mathbf{d}_2$, $\\mathbf{k}_3 = k \\mathbf{d}_3$ with unit direction vectors $\\mathbf{d}_i \\in \\mathbb{R}^2$ such that the directions are separated by $120^\\circ$ (i.e., the angles differ by $2\\pi/3$ radians). Let the first direction be $\\mathbf{d}_1 = R(\\alpha)\\,\\mathbf{e}_x$, where $\\mathbf{e}_x$ is the unit vector along the $x$-axis and $R(\\alpha)$ is the $2 \\times 2$ rotation matrix by angle $\\alpha$ in radians. The remaining directions are $\\mathbf{d}_2 = R(\\alpha + 2\\pi/3)\\,\\mathbf{e}_x$ and $\\mathbf{d}_3 = R(\\alpha + 4\\pi/3)\\,\\mathbf{e}_x$. Assume the phases $\\phi_i$ are chosen so that the maxima of $S(\\mathbf{r})$ occur at points where each contributing cosine is simultaneously maximized.\n\nStarting from the basic properties of plane waves and the definition of a lattice as the set of positions $\\mathbf{r}$ satisfying linear phase constraints with integer indices, derive the primitive lattice vectors of the spatial code and, from these, compute the lattice spacing $\\lambda$ (defined as the magnitude of either primitive vector) and a well-defined orientation angle of the grid (defined as the angle, in radians, of the primitive vector $\\mathbf{a}_2$ relative to the $x$-axis). Then, using the rotational properties of dot products and rotation matrices, show that rotating the set of direction vectors $\\{\\mathbf{d}_i\\}$ by any angle $\\theta$ rotates the resulting grid by the same angle $\\theta$ while preserving the lattice spacing $\\lambda$.\n\nYour final answer must be a single analytical expression containing two entries: the lattice spacing $\\lambda$ and the grid orientation angle (in radians) expressed in terms of $k$ and $\\alpha$. Express your answer symbolically; do not substitute numerical values. Do not include units in your boxed answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\nThe problem is scientifically grounded in the standard oscillatory interference model, is well-posed with sufficient information, and uses objective, formal language. It is valid and a rigorous solution can be derived.\n\n### Solution Derivation\n\nThe vertices of the grid cell's firing lattice are the positions $\\mathbf{r}$ where the spatial drive $S(\\mathbf{r})$ is maximized. According to the problem, this occurs when all three cosine components are simultaneously equal to $1$. Without loss of generality for determining the lattice structure, we can set the phases $\\phi_i$ to $0$ (which corresponds to choosing the origin $\\mathbf{r}=\\mathbf{0}$ as a lattice point). The condition for a point $\\mathbf{r}$ to be a lattice vertex is then:\n$$ \\mathbf{k}_i \\cdot \\mathbf{r} = 2 \\pi n_i, \\quad \\text{for } i \\in \\{1, 2, 3\\}, \\text{ where } n_i \\in \\mathbb{Z} $$\n\nThe wavevectors $\\mathbf{k}_i = k \\mathbf{d}_i$ are defined by direction vectors $\\{\\mathbf{d}_1, \\mathbf{d}_2, \\mathbf{d}_3\\}$ that are separated by $120^\\circ$. A fundamental property of three coplanar vectors of equal magnitude separated by $120^\\circ$ is that their sum is zero.\n$$ \\mathbf{d}_1 + \\mathbf{d}_2 + \\mathbf{d}_3 = \\mathbf{0} \\implies \\mathbf{k}_1 + \\mathbf{k}_2 + \\mathbf{k}_3 = \\mathbf{0} $$\nSumming the three constraint equations for the lattice points gives:\n$$ (\\mathbf{k}_1 + \\mathbf{k}_2 + \\mathbf{k}_3) \\cdot \\mathbf{r} = 2 \\pi (n_1 + n_2 + n_3) \\implies n_1 + n_2 + n_3 = 0 $$\nThis dependency means that only two of the three equations are independent. We can choose the first two to define the lattice:\n$$ \\mathbf{k}_1 \\cdot \\mathbf{r} = 2 \\pi n_1 $$\n$$ \\mathbf{k}_2 \\cdot \\mathbf{r} = 2 \\pi n_2 $$\nSince $\\mathbf{k}_i = k \\mathbf{d}_i$, we can rewrite these as $\\mathbf{d}_i \\cdot \\mathbf{r} = \\frac{2\\pi}{k} n_i$. Let $D$ be the matrix whose rows are the transposes of the first two direction vectors:\n$$ D = \\begin{pmatrix} \\mathbf{d}_1^T \\\\ \\mathbf{d}_2^T \\end{pmatrix} = \\begin{pmatrix} \\cos\\alpha  \\sin\\alpha \\\\ \\cos(\\alpha + 2\\pi/3)  \\sin(\\alpha + 2\\pi/3) \\end{pmatrix} $$\nThe lattice constraints can be written in matrix form as $D \\mathbf{r} = \\frac{2\\pi}{k} \\begin{pmatrix} n_1 \\\\ n_2 \\end{pmatrix}$.\nThe primitive lattice vectors, $\\mathbf{a}_1$ and $\\mathbf{a}_2$, are the columns of a matrix $A$ that generate the lattice for integer steps. The relationship between the direct lattice vectors (in $A$) and the reciprocal direction vectors (in $D$) is $D A = \\frac{2\\pi}{k} I$, where $I$ is the identity matrix. Thus, the matrix of primitive vectors is $A = \\frac{2\\pi}{k} D^{-1}$.\n\nFirst, we compute the determinant of $D$:\n$$ \\det(D) = \\cos\\alpha \\sin(\\alpha + 2\\pi/3) - \\sin\\alpha \\cos(\\alpha + 2\\pi/3) = \\sin((\\alpha + 2\\pi/3) - \\alpha) = \\sin(2\\pi/3) = \\frac{\\sqrt{3}}{2} $$\nNext, we find the inverse of $D$:\n$$ D^{-1} = \\frac{1}{\\det(D)} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3)  -\\sin\\alpha \\\\ -\\cos(\\alpha + 2\\pi/3)  \\cos\\alpha \\end{pmatrix} = \\frac{2}{\\sqrt{3}} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3)  -\\sin\\alpha \\\\ -\\cos(\\alpha + 2\\pi/3)  \\cos\\alpha \\end{pmatrix} $$\nNow we can find the matrix $A$ of primitive vectors:\n$$ A = \\frac{2\\pi}{k} D^{-1} = \\frac{4\\pi}{k\\sqrt{3}} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3)  -\\sin\\alpha \\\\ -\\cos(\\alpha + 2\\pi/3)  \\cos\\alpha \\end{pmatrix} $$\nThe columns of $A$ are the primitive vectors $\\mathbf{a}_1$ and $\\mathbf{a}_2$:\n$$ \\mathbf{a}_1 = \\frac{4\\pi}{k\\sqrt{3}} \\begin{pmatrix} \\sin(\\alpha + 2\\pi/3) \\\\ -\\cos(\\alpha + 2\\pi/3) \\end{pmatrix}, \\quad \\mathbf{a}_2 = \\frac{4\\pi}{k\\sqrt{3}} \\begin{pmatrix} -\\sin\\alpha \\\\ \\cos\\alpha \\end{pmatrix} $$\n\n**Lattice Spacing, $\\lambda$**\nThe lattice spacing $\\lambda$ is defined as the magnitude of either primitive vector. Let's compute $|\\mathbf{a}_2|$:\n$$ |\\mathbf{a}_2|^2 = \\left(\\frac{4\\pi}{k\\sqrt{3}}\\right)^2 ( (-\\sin\\alpha)^2 + (\\cos\\alpha)^2 ) = \\left(\\frac{4\\pi}{k\\sqrt{3}}\\right)^2 (\\sin^2\\alpha + \\cos^2\\alpha) = \\left(\\frac{4\\pi}{k\\sqrt{3}}\\right)^2 $$\n$$ \\lambda = |\\mathbf{a}_2| = \\frac{4\\pi}{k\\sqrt{3}} $$\nThe magnitude of $\\mathbf{a}_1$ is identical, as expected for a hexagonal lattice.\n\n**Grid Orientation Angle**\nThe grid orientation is the angle of $\\mathbf{a}_2$ with the positive x-axis. The vector part of $\\mathbf{a}_2$ is $(-\\sin\\alpha, \\cos\\alpha)^T$. We can express this vector using a rotation:\n$$ \\begin{pmatrix} -\\sin\\alpha \\\\ \\cos\\alpha \\end{pmatrix} = \\begin{pmatrix} \\cos(\\alpha + \\pi/2) \\\\ \\sin(\\alpha + \\pi/2) \\end{pmatrix} $$\nThis shows that the direction of $\\mathbf{a}_2$ is given by the angle $\\alpha + \\pi/2$.\n\n**Proof of Rotational Covariance**\nWe must show that rotating the set of direction vectors $\\{\\mathbf{d}_i\\}$ by an angle $\\theta$ rotates the resulting grid by $\\theta$ while preserving the lattice spacing $\\lambda$.\nThe original lattice points $\\mathbf{r}$ are defined by the system of equations $\\mathbf{k}_i \\cdot \\mathbf{r} = 2\\pi n_i$.\nLet the new direction vectors be $\\mathbf{d}'_i = R(\\theta)\\mathbf{d}_i$. The new wavevectors are $\\mathbf{k}'_i = k \\mathbf{d}'_i = k R(\\theta) \\mathbf{d}_i = R(\\theta) (k \\mathbf{d}_i) = R(\\theta)\\mathbf{k}_i$.\nThe new lattice points $\\mathbf{r}'$ are defined by the new system of equations:\n$$ \\mathbf{k}'_i \\cdot \\mathbf{r}' = 2\\pi n_i \\implies (R(\\theta)\\mathbf{k}_i) \\cdot \\mathbf{r}' = 2\\pi n_i $$\nA key property of the dot product under rotations is $(R(\\theta)\\mathbf{u}) \\cdot \\mathbf{v} = \\mathbf{u} \\cdot (R(-\\theta)\\mathbf{v})$. Applying this, we get:\n$$ \\mathbf{k}_i \\cdot (R(-\\theta)\\mathbf{r}') = 2\\pi n_i $$\nComparing this with the original condition $\\mathbf{k}_i \\cdot \\mathbf{r} = 2\\pi n_i$, we see that the set of vectors satisfying the new condition is given by $R(-\\theta)\\mathbf{r}' = \\mathbf{r}$.\nApplying the rotation $R(\\theta)$ to both sides gives $\\mathbf{r}' = R(\\theta)\\mathbf{r}$.\nThis proves that every point $\\mathbf{r}'$ in the new lattice is a rotated version of a point $\\mathbf{r}$ in the old lattice. The entire grid is therefore rotated by the angle $\\theta$.\n\nThe lattice spacing $\\lambda$ is the length of a primitive vector. Let $\\mathbf{a}$ be a primitive vector of the original lattice. The corresponding primitive vector of the new lattice is $\\mathbf{a}' = R(\\theta)\\mathbf{a}$. Since rotations are isometries (length-preserving transformations), we have $|\\mathbf{a}'| = |R(\\theta)\\mathbf{a}| = |\\mathbf{a}|$.\nTherefore, the new lattice spacing $\\lambda'$ is equal to the original lattice spacing $\\lambda$. The lattice spacing is invariant under rotation of the wavevectors.\n\nThe final answer consists of the lattice spacing $\\lambda$ and the grid orientation angle.\nLattice Spacing: $\\lambda = \\frac{4\\pi}{k\\sqrt{3}}$\nGrid Orientation: $\\alpha + \\frac{\\pi}{2}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{4\\pi}{k\\sqrt{3}}  \\alpha + \\frac{\\pi}{2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "To effectively tile a spatial environment, the brain needs multiple grid cells with identical grid structures (spacing and orientation) but different spatial offsets. This final practice  explores the mechanism that enables this crucial feature. You will first argue why constant phase offsets in the oscillators act to translate the grid's origin and then calculate the precise translation vector, solidifying your understanding of how spatial phase is controlled in the interference model.",
            "id": "3986396",
            "problem": "Consider an oscillatory interference model of grid cells driven by three Velocity-Controlled Oscillators (VCOs). At a fixed time, the spatial interference pattern is modeled as the superposition of three plane waves,\n$$\nU_{\\boldsymbol{\\psi}}(\\mathbf{x}) \\;=\\; \\sum_{i=1}^{3} \\cos\\!\\big(\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i\\big),\n$$\nwhere $\\mathbf{x} \\in \\mathbb{R}^{2}$ denotes position, $\\boldsymbol{\\psi} = (\\psi_1, \\psi_2, \\psi_3)$ are constant phase offsets, and the wavevectors are\n$$\n\\mathbf{k}_1 \\;=\\; k \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{k}_2 \\;=\\; k \\begin{pmatrix} -\\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2} \\end{pmatrix}, \\quad\n\\mathbf{k}_3 \\;=\\; k \\begin{pmatrix} -\\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2} \\end{pmatrix},\n$$\nwith $k  0$ the common magnitude and the orientations separated by $2\\pi/3$ radians. Assume equal amplitudes for the three components, consistent with standard formulations of oscillatory interference grid formation.\n\n1. Using only the fundamental properties of plane waves and linear superposition, argue from first principles why the phase offsets $\\psi_i$ control the spatial origin of the lattice but do not affect the lattice spacing or the lattice orientation. Your argument should refer to the geometry of iso-phase lines of each component and their intersection pattern and should not assume any special nonlinearity beyond the linear superposition given above.\n\n2. Consider two grids $U_{\\boldsymbol{\\psi}}(\\mathbf{x})$ and $U_{\\boldsymbol{\\psi}'}(\\mathbf{x})$ constructed from two different phase-offset triplets $\\boldsymbol{\\psi} = (\\psi_1,\\psi_2,\\psi_3)$ and $\\boldsymbol{\\psi}' = (\\psi_1',\\psi_2',\\psi_3')$. Assume the consistency condition\n$$\n\\psi_1 + \\psi_2 + \\psi_3 \\;=\\; \\psi_1' + \\psi_2' + \\psi_3'\n$$\nholds, which guarantees that the two patterns differ by a pure translation and share the same spacing and orientation. Under this assumption, compute the translation vector $\\boldsymbol{\\Delta} \\in \\mathbb{R}^2$ such that\n$$\nU_{\\boldsymbol{\\psi}'}(\\mathbf{x}) \\;=\\; U_{\\boldsymbol{\\psi}}(\\mathbf{x} + \\boldsymbol{\\Delta}).\n$$\n\nYour final answer must be a single closed-form analytic expression for $\\boldsymbol{\\Delta}$ in terms of $k$, $\\psi_i$, and $\\psi_i'$. No numerical evaluation is required. If multiple branch choices are possible due to $2\\pi$ periodicity, take the principal branch of phase differences (i.e., choose the representatives $\\psi_i' - \\psi_i$ in $(-\\pi,\\pi]$) compatible with the stated consistency condition. Angles must be treated in radians throughout.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and internally consistent. It describes a standard formulation of the oscillatory interference model for grid cells and asks for a rigorous derivation based on the provided equations.\n\n### Part 1: Role of Phase Offsets\n\nThe spatial structure of the interference pattern, specifically its lattice spacing and orientation, is determined entirely by the set of wavevectors $\\{ \\mathbf{k}_1, \\mathbf{k}_2, \\mathbf{k}_3 \\}$. The phase offsets $\\boldsymbol{\\psi} = (\\psi_1, \\psi_2, \\psi_3)$ control the spatial position of the lattice, but not its geometry. This can be understood by examining the properties of the constituent plane waves.\n\n1.  **Lattice Geometry and Wavevectors**: The interference pattern $U_{\\boldsymbol{\\psi}}(\\mathbf{x})$ arises from the superposition of three plane waves. The geometry of the resulting periodic pattern is dictated by the geometric relationships between the wavevectors $\\mathbf{k}_i$.\n    *   **Lattice Spacing**: The spacing of the hexagonal grid is inversely proportional to the common magnitude $k = |\\mathbf{k}_i|$ of the wavevectors. A larger $k$ corresponds to a higher spatial frequency and thus a smaller distance between the peaks of the grid pattern.\n    *   **Lattice Orientation**: The orientation of the grid is determined by the relative angles between the wavevectors. Here, the vectors $\\mathbf{k}_1, \\mathbf{k}_2, \\mathbf{k}_3$ are separated by angles of $2\\pi/3$ radians ($120^\\circ$). This specific symmetric arrangement is what generates a regular hexagonal lattice.\n\n2.  **Effect of Phase on a Single Plane Wave**: Consider a single component of the sum, $f_i(\\mathbf{x}) = \\cos(\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i)$. The lines of constant phase (e.g., the crests of the wave) are given by the condition $\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i = C$, where $C$ is a constant. These are lines in the $\\mathbf{x}$-plane that are perpendicular to the wavevector $\\mathbf{k}_i$. If we change the phase offset from $\\psi_i$ to $\\psi_i'$, a point $\\mathbf{x}$ on a specific iso-phase line is displaced to a new point $\\mathbf{x}'$ such that $\\mathbf{k}_i \\cdot \\mathbf{x}' + \\psi_i' = \\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i$. This implies $\\mathbf{k}_i \\cdot (\\mathbf{x}' - \\mathbf{x}) = \\psi_i - \\psi_i'$. This equation describes a translation of the plane wave pattern in the direction of its wavevector $\\mathbf{k}_i$. The change in phase, $\\psi_i' - \\psi_i$, does not alter the direction or the spacing of these iso-phase lines.\n\n3.  **Effect of Phase on the Superposition**: The total pattern $U_{\\boldsymbol{\\psi}}(\\mathbf{x})$ is the sum of three such plane wave patterns, each consisting of parallel stripes oriented orthogonally to its respective wavevector. The peaks of the resulting hexagonal grid (the \"firing fields\") occur at locations $\\mathbf{x}$ where the three waves interfere constructively, i.e., where all three cosine terms are simultaneously close to their maximum value of $1$.\n    A change in the phase offset vector from $\\boldsymbol{\\psi}$ to $\\boldsymbol{\\psi}'$ shifts each of the three underlying stripe patterns independently, as described above. This changes the locations in space where constructive interference occurs. The entire hexagonal lattice of peaks is therefore translated to a new position. Because the wavevectors $\\mathbf{k}_i$ themselves are unchanged, the fundamental geometry of the interference—the spacing between the peaks and the orientation of the lattice axes—remains invariant.\n\nIn summary, the wavevectors $\\mathbf{k}_i$ define the periodic structure of the lattice, while the phase offsets $\\psi_i$ determine its absolute position, or spatial phase, in the plane.\n\n### Part 2: Calculation of the Translation Vector\n\nWe are looking for a translation vector $\\boldsymbol{\\Delta}$ such that $U_{\\boldsymbol{\\psi}'}(\\mathbf{x}) = U_{\\boldsymbol{\\psi}}(\\mathbf{x} + \\boldsymbol{\\Delta})$ for all $\\mathbf{x} \\in \\mathbb{R}^2$. This gives the equality:\n$$\n\\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i') \\;=\\; \\sum_{i=1}^{3} \\cos\\big(\\mathbf{k}_i \\cdot (\\mathbf{x} + \\boldsymbol{\\Delta}) + \\psi_i\\big)\n$$\nExpanding the argument on the right side, we have:\n$$\n\\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i') \\;=\\; \\sum_{i=1}^{3} \\cos(\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i + \\mathbf{k}_i \\cdot \\boldsymbol{\\Delta})\n$$\nSince this equality must hold for any position $\\mathbf{x}$, and the functions $\\cos(\\mathbf{k}_i \\cdot \\mathbf{x})$ form a set of functions that are not linearly dependent in a trivial way, the most direct way to satisfy the equality is to equate the arguments of the corresponding cosine terms. This yields a system of three conditions:\n$$\n\\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i' \\;=\\; \\mathbf{k}_i \\cdot \\mathbf{x} + \\psi_i + \\mathbf{k}_i \\cdot \\boldsymbol{\\Delta} \\pmod{2\\pi}, \\quad \\text{for } i \\in \\{1, 2, 3\\}\n$$\nAs per the problem statement, we consider the principal branch of phase differences, so we can write this as a system of linear equations for the components of $\\boldsymbol{\\Delta}$:\n$$\n\\mathbf{k}_i \\cdot \\boldsymbol{\\Delta} \\;=\\; \\psi_i' - \\psi_i, \\quad \\text{for } i \\in \\{1, 2, 3\\}\n$$\nLet $\\Delta\\psi_i = \\psi_i' - \\psi_i$. The system is $\\mathbf{k}_i \\cdot \\boldsymbol{\\Delta} = \\Delta\\psi_i$.\n\nThis is a system of three linear equations for the two unknown components of $\\boldsymbol{\\Delta}$. A solution exists if and only if the system is consistent. To check for consistency, we sum the three equations:\n$$\n\\sum_{i=1}^{3} (\\mathbf{k}_i \\cdot \\boldsymbol{\\Delta}) = \\sum_{i=1}^{3} \\Delta\\psi_i\n$$\n$$\n\\left(\\sum_{i=1}^{3} \\mathbf{k}_i\\right) \\cdot \\boldsymbol{\\Delta} = \\sum_{i=1}^{3} (\\psi_i' - \\psi_i)\n$$\nThe sum of the wavevectors is:\n$$\n\\sum_{i=1}^{3} \\mathbf{k}_i = k \\left( \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\end{pmatrix} \\right) = k \\begin{pmatrix} 1 - \\frac{1}{2} - \\frac{1}{2} \\\\ 0 + \\frac{\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\mathbf{0}\n$$\nTherefore, the left side of the consistency condition is $0$. The right side is zero by the problem's assumption that $\\sum \\psi_i' = \\sum \\psi_i$. Thus, the system is consistent, and we can solve for $\\boldsymbol{\\Delta}$ using any two of the three equations.\n\nLet $\\boldsymbol{\\Delta} = \\begin{pmatrix} \\Delta_x \\\\ \\Delta_y \\end{pmatrix}$. Using the equations for $i=1$ and $i=2$:\n1.  $\\mathbf{k}_1 \\cdot \\boldsymbol{\\Delta} = k (1 \\cdot \\Delta_x + 0 \\cdot \\Delta_y) = k \\Delta_x = \\Delta\\psi_1$\n2.  $\\mathbf{k}_2 \\cdot \\boldsymbol{\\Delta} = k (-\\frac{1}{2} \\Delta_x + \\frac{\\sqrt{3}}{2} \\Delta_y) = \\Delta\\psi_2$\n\nFrom equation (1), we find $\\Delta_x$:\n$$\n\\Delta_x = \\frac{\\Delta\\psi_1}{k}\n$$\nSubstitute this into equation (2):\n$$\nk \\left(-\\frac{1}{2} \\frac{\\Delta\\psi_1}{k} + \\frac{\\sqrt{3}}{2} \\Delta_y\\right) = \\Delta\\psi_2\n$$\n$$\n-\\frac{1}{2} \\Delta\\psi_1 + k \\frac{\\sqrt{3}}{2} \\Delta_y = \\Delta\\psi_2\n$$\nSolving for $\\Delta_y$:\n$$\nk \\frac{\\sqrt{3}}{2} \\Delta_y = \\Delta\\psi_2 + \\frac{1}{2} \\Delta\\psi_1\n$$\n$$\n\\Delta_y = \\frac{2}{k\\sqrt{3}} \\left( \\Delta\\psi_2 + \\frac{1}{2} \\Delta\\psi_1 \\right) = \\frac{2\\Delta\\psi_2 + \\Delta\\psi_1}{k\\sqrt{3}}\n$$\nWe can simplify this expression for $\\Delta_y$ using the consistency condition $\\Delta\\psi_1 + \\Delta\\psi_2 + \\Delta\\psi_3 = 0$, which implies $\\Delta\\psi_1 = -(\\Delta\\psi_2 + \\Delta\\psi_3)$:\n$$\n\\Delta_y = \\frac{2\\Delta\\psi_2 + (-\\Delta\\psi_2 - \\Delta\\psi_3)}{k\\sqrt{3}} = \\frac{\\Delta\\psi_2 - \\Delta\\psi_3}{k\\sqrt{3}}\n$$\nThe components of the translation vector $\\boldsymbol{\\Delta}$ are therefore:\n$$\n\\Delta_x = \\frac{\\psi_1' - \\psi_1}{k}\n$$\n$$\n\\Delta_y = \\frac{(\\psi_2' - \\psi_2) - (\\psi_3' - \\psi_3)}{k\\sqrt{3}}\n$$\nThe translation vector $\\boldsymbol{\\Delta}$ is given by:\n$$\n\\boldsymbol{\\Delta} = \\begin{pmatrix}\n\\frac{\\psi_1' - \\psi_1}{k} \\\\\n\\frac{(\\psi_2' - \\psi_2) - (\\psi_3' - \\psi_3)}{k\\sqrt{3}}\n\\end{pmatrix}\n$$\nThis expression gives the precise spatial shift of the grid pattern resulting from a change in the phase offsets that respects the given consistency condition.\nAlternatively, a more symmetric form can be derived using the Moore-Penrose pseudoinverse, yielding $\\boldsymbol{\\Delta} = \\frac{2}{3k^2} \\sum_{i=1}^3 \\mathbf{k}_i (\\psi_i' - \\psi_i)$, which is equivalent to the component-wise result derived above.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\psi_1' - \\psi_1}{k} \\\\ \\frac{(\\psi_2' - \\psi_2) - (\\psi_3' - \\psi_3)}{k\\sqrt{3}} \\end{pmatrix}}\n$$"
        }
    ]
}