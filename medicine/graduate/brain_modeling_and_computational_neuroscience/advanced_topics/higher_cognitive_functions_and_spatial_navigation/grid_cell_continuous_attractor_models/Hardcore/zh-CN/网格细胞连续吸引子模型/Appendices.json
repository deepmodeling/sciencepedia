{
    "hands_on_practices": [
        {
            "introduction": "在深入研究网格细胞如何编码空间之前，我们必须首先理解一个稳定的神经活动模式是如何形成的。这个练习将剖析一个简化模型的动态特性，揭示定义连续吸引子的核心原理：模式的振幅 $A$ 是稳定的，而其位置或相位 $\\boldsymbol{\\phi}$ 是中性的，可以自由移动。通过对一个简化的范式方程进行线性稳定性分析，我们将理解是什么使得这个系统既能维持一个固定的内部“地图”，又能让这个地图根据输入而更新。",
            "id": "3985883",
            "problem": "考虑一个用于内侧内嗅皮层网格细胞的二维、平移不变的神经场模型，该模型支持稳态的六边形发放率模式。设发放率场用 $u(\\mathbf{x}, t)$ 表示，其中 $\\mathbf{x} \\in \\mathbb{R}^{2}$。在标准的对称性和弱非线性假设下，模式形成起始点附近的粗粒化动力学可以简化为一个描述全局模式振幅和相位（晶格位移）的低维系统。具体来说，假设模式振幅 $A(t) \\in \\mathbb{R}$ 和全局相位（晶格位移）$\\boldsymbol{\\phi}(t) = (\\phi_{x}(t), \\phi_{y}(t)) \\in \\mathbb{R}^{2}$ 的慢动力学由以下截断的范式所支配\n$$\n\\frac{dA}{dt} = \\mu A - \\gamma A^{3}, \\qquad \\frac{d\\phi_{x}}{dt} = 0, \\qquad \\frac{d\\phi_{y}}{dt} = 0,\n$$\n其中 $\\mu  0$ 是线性增长参数（由突触核的光谱特性和临界状态下的神经增益设定），$\\gamma  0$ 是主导阶的非线性饱和系数（由神经传递函数和循环相互作用中的高阶项设定）。具有非零振幅的稳态六边形模式对应于 $A^{\\ast}  0$ 和一个任意常数 $\\boldsymbol{\\phi}^{\\ast} \\in \\mathbb{R}^{2}$，这反映了连续的平移对称性。\n\n计算此 $(A, \\phi_{x}, \\phi_{y})$ 系统在 $A^{\\ast}  0$ 和任意 $\\boldsymbol{\\phi}^{\\ast}$ 的稳态点处的向量场的雅可比矩阵，并确定其特征值。使用这些特征值来评估稳态模式对抗振幅和相位扰动的线性稳定性。提供在非平凡稳态振幅下求得的特征值的有序三元组 $(\\lambda_{A}, \\lambda_{\\phi_{x}}, \\lambda_{\\phi_{y}})$。将最终答案表示为仅用 $\\mu$ 表示的单行矩阵。无需数值近似，也无需单位。最终答案必须是单个解析表达式。",
            "solution": "用户希望我分析网格细胞活动简化模型中稳态模式的稳定性。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n- **状态变量**：系统由振幅 $A(t) \\in \\mathbb{R}$ 和相位 $\\boldsymbol{\\phi}(t) = (\\phi_{x}(t), \\phi_{y}(t)) \\in \\mathbb{R}^{2}$ 描述。状态向量实际上是 $(A, \\phi_x, \\phi_y)$。\n- **动力学方程**：\n$$\n\\frac{dA}{dt} = \\mu A - \\gamma A^{3}\n$$\n$$\n\\frac{d\\phi_{x}}{dt} = 0\n$$\n$$\n\\frac{d\\phi_{y}}{dt} = 0\n$$\n- **参数**：$\\mu  0$ 和 $\\gamma  0$。\n- **目标**：计算 $(A, \\phi_{x}, \\phi_{y})$ 系统在振幅 $A^{\\ast}  0$ 的稳态点处的向量场的雅可比矩阵。\n- **目标**：确定该雅可比矩阵的特征值。\n- **目标**：使用特征值评估稳态模式的线性稳定性。\n- **输出要求**：将特征值的有序三元组 $(\\lambda_{A}, \\lambda_{\\phi_{x}}, \\lambda_{\\phi_{y}})$ 以仅用 $\\mu$ 表示的单行矩阵形式提供。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据**：该问题对一个图灵不稳定性附近的模式形成系统使用了标准的范式约简。这是理论物理学和计算神经科学中用于研究连续吸引子的一个典范模型，而连续吸引子被假设为网格细胞发放模式的基础。该模型在科学上是合理且相关的。\n- **适定性**：该问题是适定的。它提供了一套完整的常微分方程，并要求在特定不动点进行标准的线性稳定性分析。该不动点的存在由条件 $\\mu  0$ 和 $\\gamma  0$ 保证。所要求的计算是标准的，并会导出一个唯一的结果。\n- **客观性**：语言精确、技术性强，没有任何主观或模糊的陈述。\n\n**1.3. 结论与行动**\n问题是有效的。它有科学依据、适定且客观。没有矛盾、信息缺失或其他缺陷。我将继续进行求解。\n\n### 步骤2：求解推导\n\n微分方程组由下式给出：\n$$\n\\frac{dA}{dt} = f_A(A, \\phi_x, \\phi_y) = \\mu A - \\gamma A^3\n$$\n$$\n\\frac{d\\phi_x}{dt} = f_{\\phi_x}(A, \\phi_x, \\phi_y) = 0\n$$\n$$\n\\frac{d\\phi_y}{dt} = f_{\\phi_y}(A, \\phi_x, \\phi_y) = 0\n$$\n\n首先，我们找到系统的稳态点（或不动点），记为 $(A^{\\ast}, \\phi_x^{\\ast}, \\phi_y^{\\ast})$。稳态点满足 $\\frac{dA}{dt} = 0$、$\\frac{d\\phi_x}{dt} = 0$ 和 $\\frac{d\\phi_y}{dt} = 0$。\n\n相位分量的方程 $\\frac{d\\phi_x}{dt} = 0$ 和 $\\frac{d\\phi_y}{dt} = 0$ 对任何恒定的 $\\phi_x$ 和 $\\phi_y$ 值都成立。这反映了系统的连续平移对称性，其中任何相位移 $\\boldsymbol{\\phi}$ 都同样有效。\n\n振幅的方程是：\n$$\n\\mu A - \\gamma A^3 = 0\n$$\n$$\nA(\\mu - \\gamma A^2) = 0\n$$\n这个关于 $A$ 的方程有两个解。一个是平凡解 $A = 0$。另一个解通过将括号中的项设为零得到：\n$$\n\\mu - \\gamma A^2 = 0 \\implies A^2 = \\frac{\\mu}{\\gamma}\n$$\n问题指明我们关心的是具有非零振幅 $A^{\\ast}  0$ 的稳态模式。因为 $\\mu  0$ 且 $\\gamma  0$，我们可以取正平方根：\n$$\nA^{\\ast} = \\sqrt{\\frac{\\mu}{\\gamma}}\n$$\n因此，我们感兴趣的稳态点形成一个连续族（一个流形），由 $(A^{\\ast}, \\phi_x^{\\ast}, \\phi_y^{\\ast}) = (\\sqrt{\\frac{\\mu}{\\gamma}}, c_x, c_y)$ 描述，其中 $c_x$ 和 $c_y$ 是任意实常数。\n\n接下来，我们计算向量场 $\\mathbf{F} = (f_A, f_{\\phi_x}, f_{\\phi_y})$ 关于状态变量 $(A, \\phi_x, \\phi_y)$ 的雅可比矩阵 $J$。\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial f_A}{\\partial A}  \\frac{\\partial f_A}{\\partial \\phi_x}  \\frac{\\partial f_A}{\\partial \\phi_y} \\\\\n\\frac{\\partial f_{\\phi_x}}{\\partial A}  \\frac{\\partial f_{\\phi_x}}{\\partial \\phi_x}  \\frac{\\partial f_{\\phi_x}}{\\partial \\phi_y} \\\\\n\\frac{\\partial f_{\\phi_y}}{\\partial A}  \\frac{\\partial f_{\\phi_y}}{\\partial \\phi_x}  \\frac{\\partial f_{\\phi_y}}{\\partial \\phi_y}\n\\end{pmatrix}\n$$\n我们计算偏导数：\n$$\n\\frac{\\partial f_A}{\\partial A} = \\mu - 3\\gamma A^2\n$$\n所有其他偏导数都为零，因为 $f_A$ 不依赖于 $\\phi_x$ 或 $\\phi_y$，而 $f_{\\phi_x}$ 和 $f_{\\phi_y}$ 恒等于零。\n$$\n\\frac{\\partial f_A}{\\partial \\phi_x} = 0, \\quad \\frac{\\partial f_A}{\\partial \\phi_y} = 0\n$$\n$$\n\\frac{\\partial f_{\\phi_x}}{\\partial A} = \\frac{\\partial f_{\\phi_x}}{\\partial \\phi_x} = \\frac{\\partial f_{\\phi_x}}{\\partial \\phi_y} = 0\n$$\n$$\n\\frac{\\partial f_{\\phi_y}}{\\partial A} = \\frac{\\partial f_{\\phi_y}}{\\partial \\phi_x} = \\frac{\\partial f_{\\phi_y}}{\\partial \\phi_y} = 0\n$$\n因此，雅可比矩阵为：\n$$\nJ = \\begin{pmatrix}\n\\mu - 3\\gamma A^2  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n现在，我们在稳态点 $A = A^{\\ast} = \\sqrt{\\frac{\\mu}{\\gamma}}$ 处对该雅可比矩阵求值。我们称之为 $J^{\\ast}$。\n唯一非平凡的元素是左上角的元素：\n$$\n\\frac{\\partial f_A}{\\partial A}\\bigg|_{A=A^{\\ast}} = \\mu - 3\\gamma (A^{\\ast})^2 = \\mu - 3\\gamma \\left(\\frac{\\mu}{\\gamma}\\right) = \\mu - 3\\mu = -2\\mu\n$$\n所以，在稳态点处求值的雅可比矩阵是：\n$$\nJ^{\\ast} = \\begin{pmatrix}\n-2\\mu  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n对角矩阵的特征值 $(\\lambda)$ 是其对角线上的元素。因此，$J^{\\ast}$ 的特征值为：\n$$\n\\lambda_1 = -2\\mu, \\quad \\lambda_2 = 0, \\quad \\lambda_3 = 0\n$$\n第一个特征值 $\\lambda_A = -2\\mu$ 对应于振幅 $A$ 的动力学。由于 $\\mu  0$，该特征值为负，这表明稳态振幅 $A^{\\ast}$ 对小扰动是稳定的。振幅的任何小偏离都将指数衰减回到不动点值。\n\n另外两个特征值 $\\lambda_{\\phi_x} = 0$ 和 $\\lambda_{\\phi_y} = 0$ 对应于相位分量 $\\phi_x$ 和 $\\phi_y$ 的动力学。这些零特征值表示中性或临界稳定性。从物理上讲，这意味着如果相位受到扰动，它既不会返回其原始值，也不会无界增长，而是会稳定在新的值上。这是一个连续吸引子的标志，其中零特征值对应于沿着不动点连续流形（“吸引子状态”）的运动方向。这些是与系统连续平移对称性的自发破缺相关的戈德斯通模。\n\n特征值的有序三元组是 $(\\lambda_{A}, \\lambda_{\\phi_{x}}, \\lambda_{\\phi_{y}}) = (-2\\mu, 0, 0)$。问题要求将其表示为单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-2\\mu  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确立了神经活动模式既稳定又可移动的特性之后，我们现在可以探索其主要功能：路径整合。这个实践性的编程练习将演示外部的速度信号 $\\mathbf{v}(t)$ 如何被转化为活动“孤立波”的平移，从而使神经网络能够追踪个体在空间中的位置。通过将模型模拟的相位轨迹 $\\boldsymbol{\\phi}_{\\mathrm{model}}(t)$ 与真实的物理位移进行比较，我们可以量化模型作为路径整合器的准确性。",
            "id": "3985930",
            "problem": "给定一个速度时间序列和一个平移对称的神经场，该神经场实现了一种典型的网格细胞连续吸引子模型中的二维路径整合机制。您的任务是为环面上的“凸起”相位推导出一个降维动力学描述，并实现一个模拟，以量化模拟的相轨迹与通过对物理位移进行直接积分所预测的相位之间的差异。请使用以下理论基础：二维神经场中的平移不变性意味着存在一个连续的“凸起”解族，而相应的戈德斯通模（Goldstone modes）产生了由输入驱动的“凸起”中心的低维中性动力学。从连续吸引子神经网络（CANN）的公式出发，推导由速度输入驱动的低维相动力学。该比较必须在二维环面上进行，角度以弧度表示。\n\n定义与设置：\n- 考虑一个用于描述活动性 $u(\\mathbf{x}, t)$ 的二维连续吸引子神经场，其中 $\\mathbf{x} \\in \\mathbb{R}^2$。该场具有空间平移不变的循环连接和一个编码速度的外部输入。周期性边界条件将活动“凸起”的中心识别为环面 $\\mathbb{T}^2$ 上的一个相点。\n- 物理速度为 $\\mathbf{v}(t) = (v_x(t), v_y(t))$，单位是 $\\mathrm{m/s}$；物理位移为 $\\mathbf{s}(t) = \\int_0^t \\mathbf{v}(\\tau)\\, d\\tau$，单位是 $\\mathrm{m}$。\n- 环面坐标是角度 $\\boldsymbol{\\phi}(t) = (\\phi_x(t), \\phi_y(t))$，单位是弧度，每个分量都以 $2\\pi$ 为模。沿两个轴的空间周期为 $\\boldsymbol{\\lambda} = (\\lambda_x, \\lambda_y)$，单位是 $\\mathrm{m}$，因此沿轴 $i$ 的位移 $\\lambda_i$ 对应于 $\\phi_i$ 中 $2\\pi$ 的相位前进。\n- 应通过投影到中性平移模上，从CANN推导出降维的低维动力学，并用 $\\mathbf{v}(t)$ 和一个与空间周期 $\\boldsymbol{\\lambda}$ 一致的耦合矩阵来表示相位演化 $\\boldsymbol{\\phi}(t)$。角度必须归一化到区间 $[0, 2\\pi)$。\n\n误差度量：\n- 给定一个模拟的相轨迹 $\\boldsymbol{\\phi}_{\\mathrm{model}}(t)$ 和一个通过使用空间周期 $\\boldsymbol{\\lambda}$ 将物理位移 $\\mathbf{s}(t)$ 映射到环面角度而获得的“真实”相轨迹 $\\boldsymbol{\\phi}_{\\mathrm{true}}(t)$，定义按分量归一化的相位差 $\\Delta_i(t) = \\mathrm{wrap}\\big(\\phi_{\\mathrm{model}, i}(t) - \\phi_{\\mathrm{true}, i}(t)\\big)$，其中 $\\mathrm{wrap}(\\cdot)$ 将角度映射到 $(-\\pi, \\pi]$。在 $\\mathbb{T}^2$ 上的瞬时测地线误差为 $e(t) = \\sqrt{\\Delta_x(t)^2 + \\Delta_y(t)^2}$。所需的标量度量是均方根误差 $E = \\sqrt{\\frac{1}{N} \\sum_{n=1}^{N} e(t_n)^2}$，其中 $t_n$ 是离散时间样本，$N$ 是样本总数。将 $E$ 报告为保留六位小数的浮点数。\n\n角度单位是弧度。速度和空间周期的物理单位按规定分别为米/秒和米；最终误差 $E$ 是一个无量纲的浮点数（以弧度为单位）。\n\n模拟要求：\n- 使用固定时间步长 $dt$ 的离散时间积分，通过累加 $\\mathbf{v}(t) dt$ 来计算 $\\mathbf{s}(t)$，并使用从连续吸引子神经场推导出的降维相动力学来推进模型的相位 $\\boldsymbol{\\phi}_{\\mathrm{model}}(t)$。在每个步骤中，将 $\\boldsymbol{\\phi}_{\\mathrm{model}}(t)$ 的每个分量归一化到 $[0, 2\\pi)$。\n- 通过使用空间周期 $\\boldsymbol{\\lambda}$ 将 $\\mathbf{s}(t)$ 映射到角度来计算 $\\boldsymbol{\\phi}_{\\mathrm{true}}(t)$：每个分量 $\\phi_{\\mathrm{true}, i}(t)$ 是根据周期 $\\lambda_i$ 将物理位移 $s_i(t)$ 缩放到弧度，然后归一化到 $[0, 2\\pi)$。\n- 实现如上定义的归一化差值和均方根误差 $E$。\n\n测试套件：\n实现您的程序以运行以下五个案例，每个案例都由离散时间持续时长 $T$、时间步长 $dt$、空间周期 $\\boldsymbol{\\lambda}$、一个速度时间序列规范以及一个用于推导所得降维相动力学的模型耦合矩阵完全指定。所有角度均以弧度为单位；速度单位为 $\\mathrm{m/s}$；空间周期单位为 $\\mathrm{m}$。\n\n- 案例1（常规“理想路径”）：\n  - $T = 10.0$, $dt = 0.01$, $\\boldsymbol{\\lambda} = (0.5, 0.5)$。\n  - 速度：对于所有 $t \\in [0, T]$，恒为 $\\mathbf{v}(t) = (0.1, 0.05)$。\n  - 模型耦合矩阵等于与 $\\boldsymbol{\\lambda}$ 一致的从速度到相率的真实映射。\n- 案例2（高速度下的边界归一化）：\n  - $T = 2.0$, $dt = 0.005$, $\\boldsymbol{\\lambda} = (0.25, 0.30)$。\n  - 速度：对于所有 $t \\in [0, T]$，恒为 $\\mathbf{v}(t) = (1.2, -0.8)$。\n  - 模型耦合矩阵等于与 $\\boldsymbol{\\lambda}$ 一致的从速度到相率的真实映射。\n- 案例3（增益失配）：\n  - $T = 10.0$, $dt = 0.01$, $\\boldsymbol{\\lambda} = (0.5, 0.5)$。\n  - 速度：对于所有 $t \\in [0, T]$，恒为 $\\mathbf{v}(t) = (0.09, 0.07)$。\n  - 模型耦合矩阵是真实映射的缩放版本，其在 $x$ 和 $y$ 分量上的缩放因子分别为 $1.02$ 和 $0.97$。\n- 案例4（零速度边缘情况）：\n  - $T = 3.0$, $dt = 0.01$, $\\boldsymbol{\\lambda} = (0.5, 0.5)$。\n  - 速度：对于所有 $t \\in [0, T]$，恒为 $\\mathbf{v}(t) = (0.0, 0.0)$。\n  - 模型耦合矩阵等于与 $\\boldsymbol{\\lambda}$ 一致的从速度到相率的真实映射。\n- 案例5（旋转失配和正弦速度）：\n  - $T = 8.0$, $dt = 0.01$, $\\boldsymbol{\\lambda} = (0.45, 0.60)$。\n  - 速度：对于所有 $t \\in [0, T]$，为 $\\mathbf{v}(t) = \\big(0.4 \\sin(2\\pi \\cdot 0.5 \\, t),\\; 0.3 \\cos(2\\pi \\cdot 0.75 \\, t)\\big)$。\n  - 模型耦合矩阵是真实映射在输出（相位）空间中旋转角度 $\\theta = \\pi/12$ 后的版本。\n\n您的程序必须：\n- 对每个案例，生成速度时间序列，使用推导出的降维模型模拟 $\\mathbb{T}^2$ 上的相动力学，根据位移和空间周期计算“真实”相位，然后计算均方根测地线误差 $E$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个浮点数都保留六位小数，且不含空格。例如，输出应类似于 $[\\text{case1},\\text{case2},\\text{case3},\\text{case4},\\text{case5}]$，其中每个条目是对应案例的标量 $E$。",
            "solution": "我们从定义在 $\\mathbb{R}^2$ 上的活动性 $u(\\mathbf{x}, t)$ 的连续吸引子神经网络（CANN）神经场方程开始，该方程具有空间平移不变的循环连接、一个静态非线性项和一个外部输入：\n$$\n\\tau \\frac{\\partial u(\\mathbf{x}, t)}{\\partial t} = -u(\\mathbf{x}, t) + \\int_{\\mathbb{R}^2} w(\\mathbf{x} - \\mathbf{x}') \\, \\phi\\big(u(\\mathbf{x}', t)\\big)\\, d\\mathbf{x}' + I(\\mathbf{x}, t),\n$$\n其中 $\\tau$ 是一个时间常数，$w(\\mathbf{x} - \\mathbf{x}')$ 是一个平移不变核，$\\phi(\\cdot)$ 是一个静态增益函数，$I(\\mathbf{x}, t)$ 是一个外部输入。在网格细胞类连续吸引子的标准假设下，由于平移对称性，存在一个由连续平移 $\\boldsymbol{\\theta} \\in \\mathbb{R}^2$ 参数化的稳态“凸起”解 $u_0(\\mathbf{x} - \\boldsymbol{\\theta})$。连续解族的存在意味着有一对与无穷小平移相关的中性（戈德斯通）模，由空间导数 $\\partial u_0 / \\partial x$ 和 $\\partial u_0 / \\partial y$ 给出。\n\n为了获得“凸起”中心（环面上的相位）的低维动力学，我们将完整动力学投影到由这些中性模张成的子空间上。设与零本征值相关的伴随本征函数表示为 $\\psi_x(\\mathbf{x})$ 和 $\\psi_y(\\mathbf{x})$，并考虑一个使“凸起”中心发生平移的微扰。将神经场方程乘以 $\\psi_i(\\mathbf{x})$ 并在空间上积分，可以分离出移动“凸起”的贡献：\n$$\n\\frac{d\\theta_i}{dt} = \\kappa_i \\int_{\\mathbb{R}^2} I(\\mathbf{x}, t)\\, \\frac{\\partial u_0(\\mathbf{x} - \\boldsymbol{\\theta})}{\\partial x_i}\\, d\\mathbf{x}, \\quad i \\in \\{x, y\\},\n$$\n其中 $\\kappa_i$ 是由伴随模与 $u_0$ 导数的内积决定的归一化常数。如果外部输入通过与“凸起”的空间导数耦合来编码物理速度，一个广泛使用的公式是\n$$\nI(\\mathbf{x}, t) = a_x v_x(t)\\, \\frac{\\partial u_0(\\mathbf{x} - \\boldsymbol{\\theta})}{\\partial x} + a_y v_y(t)\\, \\frac{\\partial u_0(\\mathbf{x} - \\boldsymbol{\\theta})}{\\partial y},\n$$\n其中 $a_x$ 和 $a_y$ 是沿每个轴的增益，$\\mathbf{v}(t) = (v_x(t), v_y(t))$ 是物理速度。代入此输入并利用模的正交性，可以得出“凸起”中心速度与物理速度之间的线性关系：\n$$\n\\frac{d\\boldsymbol{\\theta}}{dt} = \\mathbf{B}\\, \\mathbf{v}(t),\n$$\n其中 $\\mathbf{B} \\in \\mathbb{R}^{2 \\times 2}$ 是一个由神经场、增益选择和“凸起”形状决定的耦合矩阵。周期性边界条件将“凸起”位置沿每个轴以空间周期为模进行识别，从而得到一个环面 $\\mathbb{T}^2$。位移的每个分量 $\\theta_i$ 通过缩放与相位 $\\phi_i$ 相关联，使得物理位移 $\\lambda_i$ 对应于 $2\\pi$ 的相位前进：\n$$\n\\phi_i = \\frac{2\\pi}{\\lambda_i} \\theta_i \\quad \\Rightarrow \\quad \\frac{d\\phi_i}{dt} = \\frac{2\\pi}{\\lambda_i} \\frac{d\\theta_i}{dt} = \\sum_{j \\in \\{x,y\\}} K_{ij}\\, v_j(t),\n$$\n其中\n$$\n\\mathbf{K} = \\operatorname{diag}\\left(\\frac{2\\pi}{\\lambda_x}, \\frac{2\\pi}{\\lambda_y}\\right)\\, \\mathbf{B}.\n$$\n对于一个能与空间周期一致、忠实地将速度转换为相率的理想积分器，位移与相位之间的“真实”映射为\n$$\n\\boldsymbol{\\phi}_{\\mathrm{true}}(t) = \\operatorname{wrap}_{2\\pi}\\left(\\operatorname{diag}\\left(\\frac{2\\pi}{\\lambda_x}, \\frac{2\\pi}{\\lambda_y}\\right) \\, \\mathbf{s}(t)\\right),\n$$\n其中 $\\mathbf{s}(t) = \\int_0^t \\mathbf{v}(\\tau)\\, d\\tau$ 是物理位移，$\\operatorname{wrap}_{2\\pi}(\\cdot)$ 将每个角度分量归一化到 $[0, 2\\pi)$。模拟模型的相位根据以下公式演化：\n$$\n\\boldsymbol{\\phi}_{\\mathrm{model}}(t+\\Delta t) = \\operatorname{wrap}_{2\\pi}\\left(\\boldsymbol{\\phi}_{\\mathrm{model}}(t) + \\Delta t \\, \\mathbf{K}_{\\mathrm{model}} \\, \\mathbf{v}(t)\\right),\n$$\n其中 $\\mathbf{K}_{\\mathrm{model}}$ 是从降维动力学中获得的耦合矩阵（它可能因增益或方向失配而与真实映射不同）。请注意，从CANN的推导通过对称性和模投影确立了这种线性关系的存在；测试套件中使用的具体数值实例化了不同的情况（完美映射、增益失配、旋转失配）。\n\n为了将模拟相位与“真实”相位进行比较，我们按分量计算归一化差值\n$$\n\\Delta_i(t) = \\operatorname{wrap}_{\\pi}\\left(\\phi_{\\mathrm{model}, i}(t) - \\phi_{\\mathrm{true}, i}(t)\\right),\n$$\n其中 $\\operatorname{wrap}_{\\pi}(\\alpha) = ((\\alpha + \\pi) \\bmod 2\\pi) - \\pi$ 将角度映射到 $(-\\pi, \\pi]$。瞬时测地线误差为\n$$\ne(t) = \\sqrt{\\Delta_x(t)^2 + \\Delta_y(t)^2},\n$$\n且均方根误差为\n$$\nE = \\sqrt{\\frac{1}{N} \\sum_{n=1}^{N} e(t_n)^2},\n$$\n我们将其报告为保留六位小数的浮点数。\n\n算法设计：\n- 将时间离散化为 $N = \\lfloor T / dt \\rfloor$ 个步长，样本为 $t_n = n \\cdot dt$，其中 $n = 0, 1, \\ldots, N-1$。\n- 根据每个案例的规范生成速度时间序列 $\\mathbf{v}(t_n)$。\n- 初始化 $\\boldsymbol{\\phi}_{\\mathrm{model}}(0) = (0, 0)$ 和 $\\mathbf{s}(0) = (0, 0)$。\n- 在每个时间步，更新位移 $\\mathbf{s}(t_{n+1}) = \\mathbf{s}(t_n) + dt \\cdot \\mathbf{v}(t_n)$。\n- 通过使用 $\\operatorname{diag}\\left(\\frac{2\\pi}{\\lambda_x}, \\frac{2\\pi}{\\lambda_y}\\right)$ 将 $\\mathbf{s}(t_{n+1})$ 缩放到弧度并归一化到 $[0, 2\\pi)$ 来计算 $\\boldsymbol{\\phi}_{\\mathrm{true}}(t_{n+1})$。\n- 通过将 $dt \\cdot \\mathbf{K}_{\\mathrm{model}}\\mathbf{v}(t_n)$ 加到 $\\boldsymbol{\\phi}_{\\mathrm{model}}(t_n)$ 上并归一化到 $[0, 2\\pi)$ 来更新 $\\boldsymbol{\\phi}_{\\mathrm{model}}(t_{n+1})$。\n- 计算归一化差值 $\\Delta_i(t_n)$、瞬时误差 $e(t_n)$，最后计算所有样本的均方根误差 $E$。\n- 对每个案例重复上述步骤，使用指定的 $\\boldsymbol{\\lambda}$ 和 $\\mathbf{K}_{\\mathrm{model}}$：\n  - 对于理想映射的案例，使用 $\\mathbf{K}_{\\mathrm{model}} = \\operatorname{diag}\\left(\\frac{2\\pi}{\\lambda_x}, \\frac{2\\pi}{\\lambda_y}\\right)$。\n  - 对于增益失配，用指定的因子缩放各分量。\n  - 对于旋转失配，前乘以一个旋转矩阵\n    $$\n    \\mathbf{R}(\\theta) = \\begin{bmatrix}\n    \\cos \\theta  -\\sin \\theta \\\\\n    \\sin \\theta  \\cos \\theta\n    \\end{bmatrix}\n    $$\n    来获得 $\\mathbf{K}_{\\mathrm{model}} = \\mathbf{R}(\\theta) \\operatorname{diag}\\left(\\frac{2\\pi}{\\lambda_x}, \\frac{2\\pi}{\\lambda_y}\\right)$。\n\n数值方面：\n- 归一化是使用模运算对 $[0, 2\\pi)$ 和 $(-\\pi, \\pi]$ 区间按分量执行的。\n- 通过选择相对于速度信号时间尺度足够小的 $dt$ 来最小化离散化误差。\n- 输出为单行，包含每个案例的 $E$ 值，形式为用方括号括起来的逗号分隔列表，每个浮点数保留六位小数，且不含空格。\n\n此设计整合了从CANN进行的基于对称性的降维方法，并实现了在模拟的环面相轨迹与物理积分位移对应的相位之间进行有原则的比较。",
            "answer": "```python\nimport numpy as np\n\ndef wrap_to_2pi(angle):\n    # Wrap angles to [0, 2*pi)\n    return (angle % (2.0 * np.pi))\n\ndef wrap_to_pi(angle):\n    # Wrap angles to (-pi, pi]\n    return ((angle + np.pi) % (2.0 * np.pi)) - np.pi\n\ndef simulate_case(T, dt, lam, velocity_fn, K_model):\n    \"\"\"\n    Simulate phase dynamics on T^2 for a given velocity time series and model coupling.\n    Compute RMS geodesic error against true displacement-derived phase.\n\n    Parameters:\n    - T: duration (seconds)\n    - dt: timestep (seconds)\n    - lam: spatial periods (lambda_x, lambda_y) in meters\n    - velocity_fn: function returning velocity array shape (N, 2)\n    - K_model: 2x2 matrix mapping velocity to phase rate (radians per second)\n    \"\"\"\n    N = int(np.round(T / dt))\n    t = np.arange(N) * dt\n    v = velocity_fn(t)  # shape (N,2)\n\n    # True mapping from displacement to phase\n    K_true = np.diag(2.0 * np.pi / np.array(lam))\n\n    # Initialize displacement and phases\n    s = np.zeros(2)              # physical displacement (m)\n    phi_model = np.zeros(2)      # model phase (rad)\n    phi_true = np.zeros(2)       # true phase (rad)\n\n    errors_sq = np.zeros(N)\n\n    for n in range(N):\n        vn = v[n]\n\n        # Update displacement\n        s = s + dt * vn  # integrate velocity\n\n        # True phase from displacement\n        phi_true = wrap_to_2pi(K_true @ s)\n\n        # Model phase update from velocity\n        phi_model = wrap_to_2pi(phi_model + dt * (K_model @ vn))\n\n        # Wrapped difference and instantaneous geodesic error\n        delta = wrap_to_pi(phi_model - phi_true)\n        errors_sq[n] = np.sum(delta**2)\n\n    rms_error = float(np.sqrt(np.mean(errors_sq)))\n    return rms_error\n\ndef velocity_constant_factory(vx, vy):\n    def vfn(t):\n        return np.column_stack((np.full_like(t, vx, dtype=float),\n                                np.full_like(t, vy, dtype=float)))\n    return vfn\n\ndef velocity_sinusoidal_factory(ax, fx, ay, fy):\n    def vfn(t):\n        vx = ax * np.sin(2.0 * np.pi * fx * t)\n        vy = ay * np.cos(2.0 * np.pi * fy * t)\n        return np.column_stack((vx, vy))\n    return vfn\n\ndef solve():\n    # Define test cases as tuples: (T, dt, lambda, velocity_fn, K_model)\n    test_cases = []\n\n    # Case 1: Happy path\n    T1, dt1 = 10.0, 0.01\n    lam1 = (0.5, 0.5)\n    vfn1 = velocity_constant_factory(0.1, 0.05)\n    K_true1 = np.diag(2.0 * np.pi / np.array(lam1))\n    K_model1 = K_true1.copy()\n    test_cases.append((T1, dt1, lam1, vfn1, K_model1))\n\n    # Case 2: High velocity wrapping\n    T2, dt2 = 2.0, 0.005\n    lam2 = (0.25, 0.30)\n    vfn2 = velocity_constant_factory(1.2, -0.8)\n    K_true2 = np.diag(2.0 * np.pi / np.array(lam2))\n    K_model2 = K_true2.copy()\n    test_cases.append((T2, dt2, lam2, vfn2, K_model2))\n\n    # Case 3: Gain mismatch\n    T3, dt3 = 10.0, 0.01\n    lam3 = (0.5, 0.5)\n    vfn3 = velocity_constant_factory(0.09, 0.07)\n    K_true3 = np.diag(2.0 * np.pi / np.array(lam3))\n    scale = np.diag([1.02, 0.97])\n    K_model3 = scale @ K_true3\n    test_cases.append((T3, dt3, lam3, vfn3, K_model3))\n\n    # Case 4: Zero velocity\n    T4, dt4 = 3.0, 0.01\n    lam4 = (0.5, 0.5)\n    vfn4 = velocity_constant_factory(0.0, 0.0)\n    K_true4 = np.diag(2.0 * np.pi / np.array(lam4))\n    K_model4 = K_true4.copy()\n    test_cases.append((T4, dt4, lam4, vfn4, K_model4))\n\n    # Case 5: Rotational mismatch + sinusoidal velocity\n    T5, dt5 = 8.0, 0.01\n    lam5 = (0.45, 0.60)\n    vfn5 = velocity_sinusoidal_factory(ax=0.4, fx=0.5, ay=0.3, fy=0.75)\n    K_true5 = np.diag(2.0 * np.pi / np.array(lam5))\n    theta = np.pi / 12.0\n    R = np.array([[np.cos(theta), -np.sin(theta)],\n                  [np.sin(theta),  np.cos(theta)]])\n    K_model5 = R @ K_true5\n    test_cases.append((T5, dt5, lam5, vfn5, K_model5))\n\n    results = []\n    for (T, dt, lam, vfn, K_model) in test_cases:\n        rms_err = simulate_case(T, dt, lam, vfn, K_model)\n        results.append(f\"{rms_err:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "一个有效的网格细胞模型应该能产生类似网格的六边形放电模式，但我们如何严格地量化这一特性呢？本练习介绍了“网格度得分”，这是一种标准分析工具，用于衡量空间放电图 $r(\\mathbf{x})$ 的六边形对称性。通过计算空间自相关函数 $A(\\boldsymbol{\\Delta})$ 在不同旋转角度下的相似性，这个练习连接了理论模型的输出与实验数据的验证，是评估任何网格细胞模型有效性的关键一步。",
            "id": "3985974",
            "problem": "在内侧内嗅皮层网格细胞的连续吸引子网络模型中，群体活动中稳定的活动凸起晶格会在二维空间中产生近似六边形的空间发放场。考虑单个神经元在一个有界的二维场地上的空间发放率图谱 $r(\\mathbf{x})$，其中 $\\mathbf{x}\\in\\mathbb{R}^2$ 表示空间位置。空间自相关图从第一性原理定义为 $r(\\mathbf{x})$ 与其自身在空间偏移量为 $\\boldsymbol{\\Delta}$ 时的二维自协方差（并归一化为相关系数），\n$$\nA(\\boldsymbol{\\Delta}) \\equiv \\frac{\\sum_{\\mathbf{x}\\in\\Omega} \\left(r(\\mathbf{x})-\\bar{r}\\right)\\left(r(\\mathbf{x}+\\boldsymbol{\\Delta})-\\bar{r}\\right)}{\\sqrt{\\sum_{\\mathbf{x}\\in\\Omega} \\left(r(\\mathbf{x})-\\bar{r}\\right)^2}\\sqrt{\\sum_{\\mathbf{x}\\in\\Omega} \\left(r(\\mathbf{x}+\\boldsymbol{\\Delta})-\\bar{r}\\right)^2}},\n$$\n其中 $\\Omega$ 是采样的位置集合，$\\bar{r}$ 是在 $\\Omega$ 上的平均发放率。为了评估六边形晶格所预期的六重旋转对称性，我们将 $A(\\boldsymbol{\\Delta})$ 与其旋转版本 $A_\\theta(\\boldsymbol{\\Delta}) \\equiv A(\\mathbf{R}_\\theta \\boldsymbol{\\Delta})$ 进行比较，其中 $\\mathbf{R}_\\theta$ 是按角度 $\\theta$ 进行的平面旋转。在实践中，为避免平庸的中心峰并专注于晶格峰的第一环，比较被限制在 $\\boldsymbol{\\Delta}$ 空间中的一个环形掩模 $\\mathcal{M}$ 内，该掩模排除了原点并覆盖了第一环的峰和谷。\n\n从这些定义以及六边形晶格在 $60^\\circ$ 的倍数旋转下不变但在 $90^\\circ$ 旋转下会改变的几何特性出发，确定以下哪个程序正确定义了网格性得分，并使用以下经验性获得的、$A(\\boldsymbol{\\Delta})$ 与其旋转版本 $A_\\theta(\\boldsymbol{\\Delta})$ 在 $30^\\circ$ 倍数角度下的环形掩模皮尔逊相关性，得出了正确的数值：\n$C(30^\\circ)=0.08$，$C(60^\\circ)=0.62$，$C(90^\\circ)=-0.12$，$C(120^\\circ)=0.58$，$C(150^\\circ)=0.03$。\n\n选择唯一最佳选项。\n\nA. 将网格性得分计算为在空间自相关图上使用环形掩模 $\\mathcal{M}$ 时，最差情况下的六边形对齐相关性与最差情况下的非六边形对齐相关性之间的差值。形式上，\n$$\n\\mathrm{Gridness}=\\min\\{C(60^\\circ),\\,C(120^\\circ)\\}-\\max\\{C(30^\\circ),\\,C(90^\\circ),\\,C(150^\\circ)\\},\n$$\n其数值计算结果为 $0.58-0.08=0.50$。\n\nB. 将网格性得分计算为空间自相关图上“六边形”相关性平均值与“非六边形”相关性平均值之间的差值，\n$$\n\\mathrm{Gridness}=\\frac{C(60^\\circ)+C(120^\\circ)}{2}-\\frac{C(30^\\circ)+C(90^\\circ)+C(150^\\circ)}{3},\n$$\n其数值计算结果为 $0.60-(-0.003\\overline{3})\\approx 0.603\\overline{3}$。\n\nC. 通过旋转 $r(\\mathbf{x})$ 并在环形掩模 $\\mathcal{M}$ 下将其与自身相关联，直接在原始发放率图谱 $r(\\mathbf{x})$ 上计算网格性得分，然后取\n$$\n\\mathrm{Gridness}=\\min\\{C(60^\\circ),\\,C(120^\\circ)\\}-\\max\\{C(30^\\circ),\\,C(90^\\circ),\\,C(150^\\circ)\\},\n$$\n其数值计算结果为 $0.50$。\n\nD. 将网格性得分计算为空间自相关图上最佳六边形对齐与最差非六边形对齐的比值，\n$$\n\\mathrm{Gridness}=\\frac{\\min\\{C(60^\\circ),\\,C(120^\\circ)\\}}{\\max\\{C(30^\\circ),\\,C(90^\\circ),\\,C(150^\\circ)\\}},\n$$\n其数值计算结果为 $\\frac{0.58}{0.08}=7.25$。",
            "solution": "### 问题验证\n\n**步骤1：提取已知信息**\n\n问题陈述提供了以下定义、条件和数据：\n1.  **主题**：内侧内嗅皮层网格细胞的连续吸引子网络模型。\n2.  **发放率图谱**：单个神经元在二维场地上的空间发放率图谱表示为 $r(\\mathbf{x})$，其中 $\\mathbf{x} \\in \\mathbb{R}^2$。\n3.  **空间自相关图定义**：空间自相关图 $A(\\boldsymbol{\\Delta})$ 定义为 $r(\\mathbf{x})$ 的归一化二维自协方差：\n    $$\n    A(\\boldsymbol{\\Delta}) \\equiv \\frac{\\sum_{\\mathbf{x}\\in\\Omega} \\left(r(\\mathbf{x})-\\bar{r}\\right)\\left(r(\\mathbf{x}+\\boldsymbol{\\Delta})-\\bar{r}\\right)}{\\sqrt{\\sum_{\\mathbf{x}\\in\\Omega} \\left(r(\\mathbf{x})-\\bar{r}\\right)^2}\\sqrt{\\sum_{\\mathbf{x}\\in\\Omega} \\left(r(\\mathbf{x}+\\boldsymbol{\\Delta})-\\bar{r}\\right)^2}}\n    $$\n    其中 $\\Omega$ 是采样的位置集合，$\\bar{r}$ 是平均发放率。\n4.  **旋转后的自相关图**：自相关图的旋转版本定义为 $A_\\theta(\\boldsymbol{\\Delta}) \\equiv A(\\mathbf{R}_\\theta \\boldsymbol{\\Delta})$，其中 $\\mathbf{R}_\\theta$ 是按角度 $\\theta$ 进行的平面旋转。\n5.  **环形掩模**：比较被限制在 $\\boldsymbol{\\Delta}$ 空间中的一个环形掩模 $\\mathcal{M}$ 内，该掩模排除了原点并覆盖了第一环的峰和谷。\n6.  **对称性**：六边形晶格在 $60^\\circ$ 的倍数旋转下不变，但在 $90^\\circ$ 旋转下会改变。\n7.  **经验数据**：在掩模 $\\mathcal{M}$ 上，$A(\\boldsymbol{\\Delta})$ 与其旋转版本 $A_\\theta(\\boldsymbol{\\Delta})$ 之间的皮尔逊相关性 $C(\\theta)$ 如下：\n    *   $C(30^\\circ) = 0.08$\n    *   $C(60^\\circ) = 0.62$\n    *   $C(90^\\circ) = -0.12$\n    *   $C(120^\\circ) = 0.58$\n    *   $C(150^\\circ) = 0.03$\n\n**步骤2：使用提取的已知信息进行验证**\n\n问题陈述根据既定标准进行了严格评估：\n*   **科学依据**：该问题牢固地植根于计算神经科学领域，特别是网格细胞活动的分析。空间发放率图谱、空间自相关图（作为归一化的自协方差）、环形掩模的使用以及旋转对称性的评估等定义，都是该研究领域中标准的、成熟的方法，最初在一些奠基性论文（例如，Hafting et al., 2005; Sargolini et al., 2006）中有详细描述。所述的六边形晶格的性质在几何上是正确的。\n*   **适定性**：该问题是适定的。它清晰地定义了所有必要的术语，并提供了评估“网格性得分”所提出公式所需的所有数据。问题是明确的：确定所提供的程序中哪一个是正确的，并能得出正确的数值结果。\n*   **客观性**：语言精确、专业，没有任何主观或基于观点的陈述。\n*   **完整性和一致性**：问题是自洽的。没有缺失的定义或相互矛盾的信息。\n*   **真实性**：所提供的相关性数值对于从神经元记录或模拟中获得的经验数据是符合实际的。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。它在科学上是合理的、适定的、客观的且完整的。因此，我将进行完整的推导和分析。\n\n### 解题推导\n\n目标是确定“网格性得分”的正确定义和计算方法，该度量旨在量化神经元的空间发放模式与六边形晶格的相似程度。\n\n1.  **网格性度量的第一性原理**：一个完美的六边形晶格具有六重旋转对称性。这意味着该模式在旋转 $360^\\circ/6 = 60^\\circ$ 的整数倍时保持不变。空间自相关图 $A(\\boldsymbol{\\Delta})$ 继承了这种对称性。因此，对于一个完美的网格细胞，其自相关图 $A(\\boldsymbol{\\Delta})$ 应与其旋转 $60^\\circ$ 和 $120^\\circ$ 后的版本高度相关。相反，与该对称性不符的角度（如 $30^\\circ$、$90^\\circ$ 或 $150^\\circ$）的旋转应导致较差的对齐，从而产生低相关性。一个鲁棒的网格性得分必须捕捉到这种对比：对于保持对称性的旋转具有高相关性，对于破坏对称性的旋转具有低相关性。\n\n2.  **网格性得分的公式**：在神经科学文献中，网格性得分的标准且最被广泛接受的定义通过比较六边形对称角度（$60^\\circ$ 和 $120^\\circ$）下的相关性与非六边形角度（$30^\\circ$、$90^\\circ$ 和 $150^\\circ$）下的相关性来解决这种对比。该特定公式被设计为保守且对噪声鲁棒。它被定义为在六边形对称角度下找到的*最小*相关性与在非六边形角度下找到的*最大*相关性之间的差值。\n    $$\n    \\mathrm{Gridness} = \\min\\{C(60^\\circ), C(120^\\circ)\\} - \\max\\{C(30^\\circ), C(90^\\circ), C(150^\\circ)\\}\n    $$\n    使用 $\\min$ 确保了只有当自相关图在*所有*测试的六边形对称角度下都表现出强对齐时，得分才会高。使用 $\\max$ 确保了如果在与六边形对称性*不一致*的角度上存在任何显著的相关性（例如，高的 $C(90^\\circ)$ 可能表示类正方形而非六边形对称性），得分会受到惩罚。这种最小-最大公式比使用平均值更鲁棒，因为平均值可能会掩盖单个较差的对齐。计算必须在空间自相关图 $A(\\boldsymbol{\\Delta})$ 上执行，而不是在原始发放率图谱 $r(\\mathbf{x})$ 上，因为该得分旨在测量由自相关图揭示的底层周期性晶格结构的对称性。\n\n3.  **数值计算**：使用所提供的数据，我们可以计算网格性得分。\n    *   数据：$C(30^\\circ)=0.08$，$C(60^\\circ)=0.62$，$C(90^\\circ)=-0.12$，$C(120^\\circ)=0.58$，$C(150^\\circ)=0.03$。\n    *   第一项（最小六边形对齐相关性）：\n        $$\n        \\min\\{C(60^\\circ), C(120^\\circ)\\} = \\min\\{0.62, 0.58\\} = 0.58\n        $$\n    *   第二项（最大非六边形相关性）：\n        $$\n        \\max\\{C(30^\\circ), C(90^\\circ), C(150^\\circ)\\} = \\max\\{0.08, -0.12, 0.03\\} = 0.08\n        $$\n    *   网格性得分：\n        $$\n        \\mathrm{Gridness} = 0.58 - 0.08 = 0.50\n        $$\n\n### 逐项分析\n\n**A. 将网格性得分计算为在空间自相关图上使用环形掩模 $\\mathcal{M}$ 时，最差情况下的六边形对齐相关性与最差情况下的非六边形对齐相关性之间的差值。形式上，$\\mathrm{Gridness}=\\min\\{C(60^\\circ),\\,C(120^\\circ)\\}-\\max\\{C(30^\\circ),\\,C(90^\\circ),\\,C(150^\\circ)\\}$, 其数值计算结果为 $0.58-0.08=0.50$。**\n\n*   **分析**：此选项给出了网格性得分的正确、标准定义。所描述的程序——在空间自相关图上操作并使用最小-最大公式——是标准方法。其数值评估也根据所提供的数据和公式正确执行。\n*   **结论**：**正确**。\n\n**B. 将网格性得分计算为空间自相关图上“六边形”相关性平均值与“非六边形”相关性平均值之间的差值，$\\mathrm{Gridness}=\\frac{C(60^\\circ)+C(120^\\circ)}{2}-\\frac{C(30^\\circ)+C(90^\\circ)+C(150^\\circ)}{3}$, 其数值计算结果为 $0.60-(-0.003\\overline{3})\\approx 0.603\\overline{3}$。**\n\n*   **分析**：这是一个替代性的、但非标准的公式。使用平均值不如最小-最大方法鲁棒，因为单个异常的相关值（例如，一个低的 $C(60^\\circ)$ 和一个高的 $C(120^\\circ)$）会被掩盖，从而为一个缺乏一致六重对称性的模式得出中等得分。既定的科学惯例是选项A中的公式。\n*   **结论**：**不正确**。\n\n**C. 通过旋转 $r(\\mathbf{x})$ 并在环形掩模 $\\mathcal{M}$ 下将其与自身相关联，直接在原始发放率图谱 $r(\\mathbf{x})$ 上计算网格性得分，然后取 $\\mathrm{Gridness}=\\min\\{C(60^\\circ),\\,C(120^\\circ)\\}-\\max\\{C(30^\\circ),\\,C(90^\\circ),\\,C(150^\\circ)\\}$, 其数值计算结果为 $0.50$。**\n\n*   **分析**：此选项犯了一个根本性的概念错误。网格性得分衡量的是发放场*晶格*的周期性和对称性，而不是整个发放率图谱在其环境中的旋转对称性。进行此分析的正确对象是空间自相关图 $A(\\boldsymbol{\\Delta})$，它明确地揭示了周期性结构。将此程序应用于原始发放率图谱 $r(\\mathbf{x})$ 将会测量完全不同的东西，并且无法正确识别网格细胞。例如，通过这种有缺陷的方法，位于场地中心的一个完美的圆形发放场将获得满分。\n*   **结论**：**不正确**。\n\n**D. 将网格性得分计算为空间自相关图上最佳六边形对齐与最差非六边形对齐的比值，$\\mathrm{Gridness}=\\frac{\\min\\{C(60^\\circ),\\,C(120^\\circ)\\}}{\\max\\{C(30^\\circ),\\,C(90^\\circ),\\,C(150^\\circ)\\}}$, 其数值计算结果为 $\\frac{0.58}{0.08}=7.25$。**\n\n*   **分析**：此选项提出了一个基于比率的度量。虽然它抓住了比较轴上与离轴相关性的思想，但这并非标准定义。比率在数值上可能不稳定，特别是当分母（最大离轴相关性）接近于零时，这种情况在实践中可能发生。选项A的减法方法更稳定，并且是该领域公认的标准。\n*   **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}