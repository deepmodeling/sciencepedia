{
    "hands_on_practices": [
        {
            "introduction": "In clinical practice, diagnosing necrotizing retinitis often involves synthesizing multiple, sometimes conflicting, pieces of evidence. A key challenge is distinguishing between ocular toxoplasmosis and cytomegalovirus (CMV) retinitis, especially in complex cases. This exercise  provides a practical application of Bayes' theorem, demonstrating how to formally integrate pre-test clinical suspicion with the diagnostic power of specific findings and laboratory tests to compute a revised, more accurate probability of disease. Mastering this quantitative approach is crucial for making evidence-based decisions when faced with diagnostic uncertainty.",
            "id": "4731290",
            "problem": "A patient with advanced Human Immunodeficiency Virus (HIV) presents with a new, focal necrotizing retinitis. The major competing diagnoses at this stage are ocular toxoplasmosis and cytomegalovirus (CMV) retinitis. Based on the local epidemiology in similar presentations, the pretest probability of ocular toxoplasmosis is $0.25$. On examination, the retinal lesion is adjacent to a pre-existing pigmented chorioretinal scar, and the vitreous has dense inflammatory opacities. An anterior chamber paracentesis is performed and the aqueous humor Polymerase Chain Reaction (PCR) for *Toxoplasma gondii* deoxyribonucleic acid (DNA) returns negative.\n\nFor clinical features interpreted as binary tests where “presence” is a positive test:\n- The sensitivity and specificity of “adjacent pigmented chorioretinal scar near the active lesion” for ocular toxoplasmosis against non-toxoplasmic retinitides (including CMV retinitis) are $0.80$ and $0.90$, respectively.\n- The sensitivity and specificity of “dense vitritis” for ocular toxoplasmosis against non-toxoplasmic retinitides (including CMV retinitis) are $0.70$ and $0.85$, respectively.\n\nFor the aqueous humor PCR for *Toxoplasma gondii* DNA:\n- The sensitivity and specificity are $0.60$ and $0.98$, respectively, with the observed result being negative.\n\nAssume conditional independence of the clinical features and the PCR result given the disease state (ocular toxoplasmosis versus non-toxoplasmic retinitis). Using the foundational laws of conditional probability and the definitions of sensitivity and specificity, compute the posterior probability that this patient has ocular toxoplasmosis given the observed clinical findings and the negative aqueous PCR. Round your final answer to four significant figures and express it as a decimal (do not use a percentage sign).",
            "solution": "The problem asks for the posterior probability that a patient has ocular toxoplasmosis given a set of clinical findings and a laboratory test result. This is a classic application of Bayes' theorem.\n\nLet $T$ be the event that the patient has ocular toxoplasmosis, and let $T'$ be the complementary event that the patient has non-toxoplasmic retinitis (e.g., CMV retinitis).\nThe prior probability of ocular toxoplasmosis is given as:\n$$ P(T) = 0.25 $$\nTherefore, the prior probability of non-toxoplasmic retinitis is:\n$$ P(T') = 1 - P(T) = 1 - 0.25 = 0.75 $$\n\nWe are given three pieces of evidence:\n1.  $S$: The presence of an adjacent pigmented chorioretinal scar near the active lesion. This is treated as a positive test result.\n2.  $V$: The presence of dense vitritis. This is also treated as a positive test result.\n3.  $PCR'$: A negative result from the aqueous humor Polymerase Chain Reaction (PCR) for *Toxoplasma gondii* DNA.\n\nThe problem provides the sensitivity and specificity for each of these findings. We can express these as conditional probabilities.\n\nFor the chorioretinal scar ($S$):\n-   Sensitivity of $S$ for $T$: $P(S|T) = 0.80$.\n-   Specificity of $S$ for $T$: $P(S'|T') = 0.90$. The probability of this finding in a patient without toxoplasmosis (a false positive) is $P(S|T') = 1 - P(S'|T') = 1 - 0.90 = 0.10$.\n\nFor the dense vitritis ($V$):\n-   Sensitivity of $V$ for $T$: $P(V|T) = 0.70$.\n-   Specificity of $V$ for $T$: $P(V'|T') = 0.85$. The probability of this finding in a patient without toxoplasmosis (a false positive) is $P(V|T') = 1 - P(V'|T') = 1 - 0.85 = 0.15$.\n\nFor the aqueous humor PCR test:\nLet $PCR$ denote a positive result and $PCR'$ a negative result. The observed finding is $PCR'$.\n-   Sensitivity of the PCR test for $T$: $P(PCR|T) = 0.60$. The probability of a negative result given the patient has toxoplasmosis (a false negative) is $P(PCR'|T) = 1 - P(PCR|T) = 1 - 0.60 = 0.40$.\n-   Specificity of the PCR test for $T$: $P(PCR'|T') = 0.98$. This is the probability of a correct negative result in a patient without toxoplasmosis.\n\nWe need to compute the posterior probability of toxoplasmosis given all three findings, $P(T | S, V, PCR')$. According to Bayes' theorem:\n$$ P(T | S, V, PCR') = \\frac{P(S, V, PCR' | T) P(T)}{P(S, V, PCR')} $$\n\nThe denominator, $P(S, V, PCR')$, is the total probability of observing all three findings. It can be expanded using the law of total probability:\n$$ P(S, V, PCR') = P(S, V, PCR' | T) P(T) + P(S, V, PCR' | T') P(T') $$\n\nThe problem states that the findings are conditionally independent given the disease state. This allows us to separate the conditional probabilities:\n$$ P(S, V, PCR' | T) = P(S|T) \\cdot P(V|T) \\cdot P(PCR'|T) $$\n$$ P(S, V, PCR' | T') = P(S|T') \\cdot P(V|T') \\cdot P(PCR'|T') $$\n\nSubstituting these into the formula for the posterior probability:\n$$ P(T | S, V, PCR') = \\frac{P(S|T)P(V|T)P(PCR'|T)P(T)}{P(S|T)P(V|T)P(PCR'|T)P(T) + P(S|T')P(V|T')P(PCR'|T')P(T')} $$\n\nLet's calculate the numerical value of the numerator, which we denote as $A$:\n$$ A = P(S|T)P(V|T)P(PCR'|T)P(T) $$\n$$ A = (0.80)(0.70)(0.40)(0.25) $$\n$$ A = (0.56)(0.40)(0.25) = (0.224)(0.25) = 0.056 $$\n\nNext, let's calculate the numerical value of the second term in the denominator, which we denote as $B$:\n$$ B = P(S|T')P(V|T')P(PCR'|T')P(T') $$\n$$ B = (0.10)(0.15)(0.98)(0.75) $$\n$$ B = (0.015)(0.98)(0.75) = (0.0147)(0.75) = 0.011025 $$\n\nThe total denominator is the sum $A + B$:\n$$ P(S, V, PCR') = A + B = 0.056 + 0.011025 = 0.067025 $$\n\nFinally, the posterior probability is the ratio of the numerator to the denominator:\n$$ P(T | S, V, PCR') = \\frac{A}{A+B} = \\frac{0.056}{0.067025} $$\n$$ P(T | S, V, PCR') \\approx 0.83550913838... $$\n\nThe problem asks for the answer to be rounded to four significant figures.\n$$ P(T | S, V, PCR') \\approx 0.8355 $$",
            "answer": "$$\\boxed{0.8355}$$"
        },
        {
            "introduction": "Once a diagnosis of CMV retinitis is established, initiating systemic antiviral therapy is a critical next step, but a \"one-size-fits-all\" approach can be dangerous due to potential drug toxicity. Many antivirals, including the commonly used valganciclovir, are cleared by the kidneys, necessitating dose adjustments in patients with renal impairment. This practice  simulates the essential clinical task of tailoring valganciclovir dosage by using the Cockcroft–Gault equation to estimate creatinine clearance ($CrCl$), a vital skill for balancing therapeutic efficacy with patient safety.",
            "id": "4731293",
            "problem": "A clinician is managing three adults with cytomegalovirus retinitis. For valganciclovir dosing, renal function is estimated by the Cockcroft–Gault equation, a widely accepted method to approximate creatinine clearance ($CrCl$), which is a surrogate for glomerular filtration rate. The equation is\n$$CrCl=\\frac{(140-\\text{age})\\times \\text{weight}}{72\\times S_{cr}},$$\nand for females the result must be multiplied by $0.85$. Here $\\text{age}$ is in years, $\\text{weight}$ is in kilograms, and $S_{cr}$ is serum creatinine in milligrams per deciliter. Assume steady-state serum creatinine and use actual body weight.\n\nValganciclovir dose adjustments for induction therapy in cytomegalovirus retinitis are based on renal function categories defined by $CrCl$ in $\\text{mL/min}$. Use the following well-established adjustment scheme for induction (standard adult induction daily dose is $900$ mg twice daily, i.e., $1{,}800$ mg per day):\n- If $CrCl \\geq 60$ $\\text{mL/min}$: $900$ mg twice daily.\n- If $CrCl$ is $40$ to $59$ $\\text{mL/min}$: $450$ mg twice daily.\n- If $CrCl$ is $25$ to $39$ $\\text{mL/min}$: $450$ mg once daily.\n- If $CrCl$ is $10$ to $24$ $\\text{mL/min}$: $450$ mg every $2$ days.\n- If $CrCl < 10$ $\\text{mL/min}$: do not use valganciclovir tablets.\n\nFor each patient below, compute $CrCl$ using the Cockcroft–Gault equation, round the $CrCl$ to three significant figures, determine the appropriate induction dosing category, and then compute the ratio of the adjusted daily induction dose (in milligrams per day) to the standard adult induction daily dose of $1{,}800$ mg per day. Express the final ratios as unitless numbers.\n\nPatient $A$: male, $\\text{age}=48$, $\\text{weight}=80$, $S_{cr}=1.0$.\n\nPatient $B$: female, $\\text{age}=70$, $\\text{weight}=60$, $S_{cr}=1.2$ (remember to multiply by $0.85$ for females).\n\nPatient $C$: male, $\\text{age}=76$, $\\text{weight}=68$, $S_{cr}=2.0$.\n\nRound each computed $CrCl$ to three significant figures before categorizing the renal function. Report your final three ratios in a single row using the LaTeX \\texttt{pmatrix} format. No intermediate steps are required in the final answer. Units: express $CrCl$ in $\\text{mL/min}$, doses in $\\text{mg}$; the final ratios are unitless.",
            "solution": "The problem is validated as follows.\n\n### Step 1: Extract Givens\n- **Cockcroft–Gault Equation**: $CrCl=\\frac{(140-\\text{age})\\times \\text{weight}}{72\\times S_{cr}}$\n- **Units for Equation**: $\\text{age}$ in years, $\\text{weight}$ in kilograms (kg), $S_{cr}$ (serum creatinine) in milligrams per deciliter (mg/dL), $CrCl$ (creatinine clearance) in milliliters per minute (mL/min).\n- **Female Correction Factor**: The result for females must be multiplied by $0.85$.\n- **Standard Adult Induction Dose**: $900$ mg twice daily, which is $1{,}800$ mg per day.\n- **Valganciclovir Dose Adjustment Scheme based on $CrCl$**:\n    - If $CrCl \\geq 60$ $\\text{mL/min}$: $900$ mg twice daily.\n    - If $CrCl$ is $40$ to $59$ $\\text{mL/min}$: $450$ mg twice daily.\n    - If $CrCl$ is $25$ to $39$ $\\text{mL/min}$: $450$ mg once daily.\n    - If $CrCl$ is $10$ to $24$ $\\text{mL/min}$: $450$ mg every $2$ days.\n    - If $CrCl < 10$ $\\text{mL/min}$: do not use valganciclovir tablets.\n- **Patient A Data**: male, $\\text{age}=48$ years, $\\text{weight}=80$ kg, $S_{cr}=1.0$ mg/dL.\n- **Patient B Data**: female, $\\text{age}=70$ years, $\\text{weight}=60$ kg, $S_{cr}=1.2$ mg/dL.\n- **Patient C Data**: male, $\\text{age}=76$ years, $\\text{weight}=68$ kg, $S_{cr}=2.0$ mg/dL.\n- **Instructions**:\n    1. Compute $CrCl$ for each patient.\n    2. Round each $CrCl$ to three significant figures.\n    3. Determine the dosing category.\n    4. Compute the ratio of the adjusted daily induction dose to the standard daily dose of $1{,}800$ mg.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is firmly grounded in clinical pharmacology and nephrology. The Cockcroft-Gault equation is a standard, albeit older, method for estimating renal function. Valganciclovir dosing adjustments based on creatinine clearance are a critical and established part of clinical practice to prevent drug toxicity. The patient parameters (age, weight, serum creatinine) are realistic.\n- **Well-Posed**: The problem is well-posed. It provides all necessary data, a clear formula, and a deterministic set of rules for categorization and calculation. The objective is unambiguous, and a unique solution can be systematically derived.\n- **Objective**: The problem is stated in precise, objective language, free of ambiguity or subjective interpretation.\n\nThe problem does not exhibit any of the invalidity flaws. It is scientifically sound, formalizable, complete, realistic, and well-structured.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be computed.\n\nThe solution proceeds by calculating the creatinine clearance ($CrCl$) for each patient, determining the appropriate dosing regimen, calculating the adjusted daily dose, and finally computing the ratio of this adjusted dose to the standard dose.\n\n**Patient A: male, $\\text{age}=48$, $\\text{weight}=80$, $S_{cr}=1.0$**\n\nThe Cockcroft-Gault equation for a male is applied:\n$$CrCl_A = \\frac{(140 - \\text{age}) \\times \\text{weight}}{72 \\times S_{cr}}$$\nSubstituting the values for Patient A:\n$$CrCl_A = \\frac{(140 - 48) \\times 80}{72 \\times 1.0} = \\frac{92 \\times 80}{72} = \\frac{7360}{72} \\approx 102.22... \\text{ mL/min}$$\nRounding to three significant figures, $CrCl_A = 102$ mL/min.\nAccording to the dosing scheme, since $102 \\text{ mL/min} \\geq 60 \\text{ mL/min}$, the dose is $900$ mg twice daily.\nThe adjusted daily dose is $900 \\text{ mg} \\times 2 = 1800$ mg/day.\nThe standard daily dose is $1800$ mg/day.\nThe ratio for Patient A is:\n$$R_A = \\frac{\\text{Adjusted Daily Dose}}{\\text{Standard Daily Dose}} = \\frac{1800}{1800} = 1$$\n\n**Patient B: female, $\\text{age}=70$, $\\text{weight}=60$, $S_{cr}=1.2$**\n\nFor a female, the result of the Cockcroft-Gault equation must be multiplied by $0.85$.\n$$CrCl_B = 0.85 \\times \\frac{(140 - \\text{age}) \\times \\text{weight}}{72 \\times S_{cr}}$$\nSubstituting the values for Patient B:\n$$CrCl_B = 0.85 \\times \\frac{(140 - 70) \\times 60}{72 \\times 1.2} = 0.85 \\times \\frac{70 \\times 60}{86.4} = 0.85 \\times \\frac{4200}{86.4} \\approx 0.85 \\times 48.611... \\approx 41.319... \\text{ mL/min}$$\nRounding to three significant figures, $CrCl_B = 41.3$ mL/min.\nAccording to the dosing scheme, $CrCl_B$ falls in the range $40$ to $59$ mL/min ($40 \\leq 41.3 \\leq 59$). The dose is $450$ mg twice daily.\nThe adjusted daily dose is $450 \\text{ mg} \\times 2 = 900$ mg/day.\nThe ratio for Patient B is:\n$$R_B = \\frac{\\text{Adjusted Daily Dose}}{\\text{Standard Daily Dose}} = \\frac{900}{1800} = 0.5$$\n\n**Patient C: male, $\\text{age}=76$, $\\text{weight}=68$, $S_{cr}=2.0$**\n\nThe Cockcroft-Gault equation for a male is applied:\n$$CrCl_C = \\frac{(140 - \\text{age}) \\times \\text{weight}}{72 \\times S_{cr}}$$\nSubstituting the values for Patient C:\n$$CrCl_C = \\frac{(140 - 76) \\times 68}{72 \\times 2.0} = \\frac{64 \\times 68}{144} = \\frac{4352}{144} \\approx 30.222... \\text{ mL/min}$$\nRounding to three significant figures, $CrCl_C = 30.2$ mL/min.\nAccording to the dosing scheme, $CrCl_C$ falls in the range $25$ to $39$ mL/min ($25 \\leq 30.2 \\leq 39$). The dose is $450$ mg once daily.\nThe adjusted daily dose is $450 \\text{ mg} \\times 1 = 450$ mg/day.\nThe ratio for Patient C is:\n$$R_C = \\frac{\\text{Adjusted Daily Dose}}{\\text{Standard Daily Dose}} = \\frac{450}{1800} = \\frac{1}{4} = 0.25$$\n\nThe final three ratios for Patients A, B, and C are $1$, $0.5$, and $0.25$, respectively.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 0.5 & 0.25\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Effective patient management extends beyond diagnosis and treatment initiation; it requires quantitatively monitoring the therapeutic response to ensure the chosen regimen is working. For CMV retinitis, this can be achieved by tracking the decline in intraocular viral load using serial quantitative Polymerase Chain Reaction (qPCR) tests. This advanced exercise  challenges you to apply a first-order kinetic model to longitudinal viral load data, allowing you to calculate the viral clearance half-life ($t_{1/2}$), a powerful and objective metric for assessing treatment efficacy and guiding further clinical decisions.",
            "id": "4731337",
            "problem": "You are provided with longitudinal aqueous humor quantitative Polymerase Chain Reaction (qPCR) measurements of Cytomegalovirus (CMV) copies per milliliter during intravitreal antiviral therapy for CMV retinitis. Assume a continuous-time first-order clearance process, where the instantaneous rate of decline in viral copies is proportional to the current intraocular viral load. From this base, derive an appropriate model to fit the decline, estimate the clearance constant, and compute the corresponding half-life of intraocular viral clearance.\n\nYour program must apply the following rules:\n- Use the assumption that the decline follows continuous-time first-order kinetics, starting from the definition that the time rate of change of the quantity is proportional to the quantity itself.\n- Fit the model parameters by transforming the measurements to a domain in which linear regression is appropriate under an assumption of homoscedastic Gaussian measurement noise after transformation.\n- Treat any non-positive qPCR copy values as below the limit of detection and exclude those points from the parameter estimation. If, after exclusion, fewer than two valid points remain, treat the half-life as not estimable.\n- If the fitted clearance constant implies non-decay (non-positive decay constant), report the half-life as mathematical infinity.\n\nCompute the half-life in days, rounded to three decimal places. Report the final outputs as floats in days. The final output format must be a single line containing a comma-separated list of results enclosed in square brackets, for example, [$r_1$,$r_2$,$r_3$], where each $r_i$ is the half-life in days for the $i$-th test case.\n\nTest Suite (times in days, qPCR copies in copies per milliliter):\n1. Case A (typical CMV decline):\n   - Times: [$0$, $2$, $5$, $9$, $14$]\n   - Copies: [$1.2\\times 10^{6}$, $728000$, $345000$, $128000$, $36000$]\n2. Case B (slower decline under severe immunosuppression):\n   - Times: [$0$, $3$, $7$, $12$, $20$]\n   - Copies: [$8.0\\times 10^{5}$, $595000$, $400000$, $242000$, $108000$]\n3. Case C (rapid decline with final measurement below detection):\n   - Times: [$0$, $3$, $7$, $10$, $14$]\n   - Copies: [$1.0\\times 10^{5}$, $40500$, $12500$, $5000$, $0$]\n4. Case D (near-boundary slow decline):\n   - Times: [$0$, $7$, $14$, $21$, $28$]\n   - Copies: [$2.0\\times 10^{5}$, $174000$, $152000$, $132000$, $114000$]\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., [$r_1$,$r_2$,$r_3$,$r_4$]), where each $r_i$ corresponds to the estimated half-life in days for the respective test case in the order presented.",
            "solution": "The underlying scientific base is continuous-time first-order kinetics for viral clearance in the eye, which is a well-tested approximation for many biological elimination processes when the removal rate is proportional to the amount present. Let the intraocular viral copies be denoted by $C(t)$ at time $t$. The foundational law for first-order processes is the differential equation\n$$\n\\frac{dC(t)}{dt} = -k\\,C(t),\n$$\nwhere $k$ is the clearance constant with units of $\\text{day}^{-1}$ when $t$ is expressed in days. This equation is derived from the principle that the rate of change of a quantity is proportional to its current value, with the proportionality constant $k$ representing the fractional clearance rate per unit time. Solving this ordinary differential equation with initial condition $C(0)=C_0$ yields\n$$\nC(t) = C_0\\,e^{-k t}.\n$$\nThis solution implies that the decline in copies over time follows an exponential decay governed by $k$. The half-life, denoted $t_{1/2}$, is defined as the time at which $C(t)$ reaches half the initial value $C_0$, satisfying $C(t_{1/2}) = \\frac{1}{2} C_0$. Substituting into the solution and solving for $t_{1/2}$ gives\n$$\n\\frac{1}{2} C_0 = C_0\\,e^{-k t_{1/2}} \\quad\\Rightarrow\\quad e^{-k t_{1/2}} = \\frac{1}{2} \\quad\\Rightarrow\\quad t_{1/2} = \\frac{\\ln(2)}{k}.\n$$\n\nMeasured qPCR data consist of pairs $(t_i, C_i)$ with $t_i$ in days and $C_i$ in copies per milliliter. To estimate $k$ from noisy data, transform the model to a linear form by taking the natural logarithm of both sides:\n$$\n\\ln C(t) = \\ln C_0 - k t.\n$$\nThis expresses $\\ln C$ as an affine function of $t$ with slope $-k$ and intercept $\\ln C_0$. Under the assumption that measurement noise is approximately additive and homoscedastic in the $\\ln C$ domain (which is reasonable if errors are multiplicative in $C$ leading to log-normal variability), ordinary least squares on $(t_i, \\ln C_i)$ provides a maximum likelihood estimate of the slope when the residuals are Gaussian.\n\nThe algorithm proceeds as follows:\n1. For each test case, collect all valid pairs $(t_i, C_i)$ where $C_i > 0$. Non-positive values are treated as below the limit of detection and excluded to avoid undefined $\\ln(0)$ values.\n2. If fewer than two valid points remain, the slope is not estimable. In such a scenario, the half-life is reported as mathematical infinity because no decline can be inferred reliably.\n3. Compute $\\ln C_i$ for the valid points and fit a straight line $y_i = m t_i + b$ to $(t_i, y_i)$ where $y_i = \\ln C_i$ using ordinary least squares:\n   $$\n   m = \\frac{\\sum_{i=1}^{n} (t_i - \\bar{t})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (t_i - \\bar{t})^2}, \\quad b = \\bar{y} - m \\bar{t},\n   $$\n   where $\\bar{t}$ and $\\bar{y}$ are sample means of $t_i$ and $y_i$, and $n$ is the number of valid points.\n4. The clearance constant estimate is $\\hat{k} = -m$. If $\\hat{k} \\le 0$, the fitted relationship indicates no decay or growth; in this case, report the half-life as infinity, since $\\frac{\\ln(2)}{\\hat{k}}$ would be undefined or negative physically.\n5. Otherwise, compute the half-life estimate\n   $$\n   \\hat{t}_{1/2} = \\frac{\\ln(2)}{\\hat{k}}\n   $$\n   in days.\n6. Round each $\\hat{t}_{1/2}$ to three decimal places and output the list in the specified single-line format.\n\nApplying this to the provided test suite:\n- Case A data are consistent with a slope near $-0.25\\,\\text{day}^{-1}$, yielding an estimated half-life close to $2.77$ days.\n- Case B produces a slope near $-0.10\\,\\text{day}^{-1}$, with half-life approximately $6.91$ days.\n- Case C, excluding the final zero measurement, yields a slope near $-0.299\\,\\text{day}^{-1}$, with half-life about $2.319$ days.\n- Case D corresponds to a very slow decline with slope near $-0.020\\,\\text{day}^{-1}$, producing a half-life around $34.61$ days.\n\nThe implementation uses numerical computation of the least squares slope and intercept via sample means to ensure reproducibility without external input. The output is the ordered list of half-lives for Cases A through D, each in days rounded to three decimal places, enclosed in square brackets and comma-separated as specified.",
            "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\ndef estimate_half_life(times, copies):\n    \"\"\"\n    Estimate half-life (in days) from time (days) and qPCR copies (copies/mL)\n    using first-order exponential decay transformed to linear regression in log space.\n    Excludes non-positive copies as below detection.\n    Returns float half-life in days; np.inf if k <= 0 or insufficient data.\n    \"\"\"\n    times = np.asarray(times, dtype=float)\n    copies = np.asarray(copies, dtype=float)\n\n    # Exclude non-positive measurements\n    valid_mask = copies > 0\n    t_valid = times[valid_mask]\n    c_valid = copies[valid_mask]\n\n    # Need at least two valid points to estimate slope\n    if t_valid.size < 2:\n        return float('inf')\n\n    # Log-transform copies\n    y = np.log(c_valid)\n    x = t_valid\n\n    # Ordinary least squares for slope and intercept\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n    # Compute covariance and variance\n    cov = np.sum((x - x_mean) * (y - y_mean))\n    var = np.sum((x - x_mean) ** 2)\n\n    # If variance is zero (all times equal), cannot fit\n    if var == 0:\n        return float('inf')\n\n    slope = cov / var  # y = slope * t + intercept\n    k = -slope\n\n    if k <= 0:\n        return float('inf')\n\n    half_life = np.log(2.0) / k  # days\n    return half_life\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        ([0, 2, 5, 9, 14], [1_200_000, 728_000, 345_000, 128_000, 36_000]),\n        # Case B\n        ([0, 3, 7, 12, 20], [800_000, 595_000, 400_000, 242_000, 108_000]),\n        # Case C (final measurement below detection -> 0)\n        ([0, 3, 7, 10, 14], [100_000, 40_500, 12_500, 5_000, 0]),\n        # Case D (slow decline)\n        ([0, 7, 14, 21, 28], [200_000, 174_000, 152_000, 132_000, 114_000]),\n    ]\n\n    results = []\n    for times, copies in test_cases:\n        hl = estimate_half_life(times, copies)\n        if np.isfinite(hl):\n            results.append(f\"{hl:.3f}\")\n        else:\n            results.append(\"inf\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}