## 引言
[光学相干断层扫描](@entry_id:173275)血管成像（OCTA）是一项革命性的成像技术，它首次实现了对眼内微血管网络的无创、高分辨率、三维可视化，为眼科乃至其他医学领域开辟了新的诊断与研究维度。传统血管成像技术（如[荧光素](@entry_id:149391)血管造影）需要注射造影剂且主要提供二维信息，限制了其在频繁监测和深度分辨分析中的应用。OCTA填补了这一关键的知识与技术空白，通过捕捉血液流动的内源性对比信号，安全、快速地揭示了以往难以观察的毛细[血管结构](@entry_id:154220)。本文旨在为读者提供一个关于OCTA技术的全面而深入的指南。在接下来的章节中，我们将首先在“原理与机制”中剖析其核心物理原理与信号处理流程；接着，在“应用与跨学科连接”中，我们将探索其在多种眼科疾病诊断、全身性疾病研究以及与数据科学交叉融合中的广泛应用；最后，通过“动手实践”环节，读者将有机会解决实际问题，从而巩固所学知识。

## 原理与机制

本章旨在深入阐述[光学相干断层扫描](@entry_id:173275)血管成像（OCTA）背后的基本物理原理和核心技术机制。我们将从[光学相干断层扫描](@entry_id:173275)（OCT）信号的产生讲起，逐步深入到运动对比度的检测、信号处理方法，最终探讨实际应用中的关键考量和伪影识别。本章的目标是为读者构建一个系统而严谨的知识框架，使其能够理解OCTA技术如何实现对微血管网络的无创、高分辨率成像。

### [光学相干断层扫描](@entry_id:173275)（OCT）的信号基础：从[相干性](@entry_id:268953)到三维结构

OCTA技术建立在OCT的物理基础之上。OCT是一种利用光的低相干干涉测量原理进行[三维成像](@entry_id:169872)的技术。其核心在于利用一个**宽带光源**，例如[超辐射](@entry_id:149499)[发光二极管](@entry_id:158696)（SLD）或扫频激光器，来实现对组织内部特定深度的光学“切片”。

光源的**[相干长度](@entry_id:139128)**（$l_c$）是一个关键参数，它定义了能够产生有效干涉的路径长度范围。只有当参考臂和样本臂的[光程差](@entry_id:201533)小于[相干长度](@entry_id:139128)时，干涉现象才会发生。这个狭窄的干涉范围被称为**相干门**，正是它赋予了OCT出色的**[轴向分辨率](@entry_id:168954)**（或称深度分辨率）。光源的光谱特性直接决定了[轴向分辨率](@entry_id:168954)。根据维纳-辛钦定理，系统的轴向点扩散函数（PSF）——即系统对一个理想点反射源的响应——其包络是光源功率谱密度傅里叶变换的模。对于一个中心波长为 $\lambda_0$、光谱带宽为 $\Delta\lambda$ 的高斯型光谱，其轴向分辨率 $\delta z$ 可以表示为：

$$ \delta z = \frac{2 \ln 2}{\pi} \frac{\lambda_0^2}{n \Delta\lambda} $$

其中 $n$ 是样本的折射率 。这个关系式清晰地表明，要获得更高的轴向分辨率（即更小的 $\delta z$），需要使用具有更宽光谱带宽（$\Delta\lambda$）的光源。

当光照射到生物组织这样的[复杂介质](@entry_id:164088)时，每个OCT分辨率体素内的信号是由大量亚分辨率散射体（如细胞器、细胞膜等）反射回波的[相干叠加](@entry_id:170209)形成的。这个复杂的干涉过程产生了一种被称为**散斑**（speckle）的颗粒状图案。我们可以将体素内的复数OCT信号 $S$ 建模为大量随机相位的矢量和：

$$ S = \sum_{n=1}^{N} a_n e^{i \phi_n} $$

其中 $a_n$ 和 $\phi_n$ 分别是第 $n$ 个散射体的振幅和相位。当散射体数量 $N$ 足够大且其相位在 $[0, 2\pi)$ 上随机分布时，根据中心极限定理，复数信号 $S$ 的实部和虚部趋向于均值为零的高斯分布。这种信号被称为**充分发展的散斑**（fully developed speckle）。在此条件下，信号的振幅 $A = |S|$ 服从**[瑞利分布](@entry_id:184867)**，而强度 $I = |S|^2$ 服从**[指数分布](@entry_id:273894)** 。理解散斑的统计特性至关重要，因为OCTA正是通过检测散斑信号随时间的变化来提取运动信息的。

### 信号的采集：傅里叶域OCT系统

现代临床OCT系统绝大多数采用**傅里叶域OCT**（FD-OCT）技术，因其相比于传统时域OCT具有显著的速度和灵敏度优势。FD-OCT主要分为两大类：**[谱域](@entry_id:755169)OCT**（SD-OCT）和**扫频OCT**（SS-OCT）。

- **[谱域](@entry_id:755169)OCT（SD-OCT）**：使用宽带光源同时照射样本。从干涉仪返回的光被送入一个光谱仪，通过衍射光栅等色散元件将不同波长的光分光，并由一个线阵相机（line-scan camera）同时记录整个光谱的[干涉图](@entry_id:750737) $I(\lambda)$。

- **扫频OCT（SS-OCT）**：使用一个快速扫频激光器，其输出波长随时间快速变化 $\lambda(t)$。干涉信号则由一个单点[光电探测器](@entry_id:264291)进行高速采集，记录下随时间变化的干涉信号 $I(t)$。

在FD-OCT中，深度分辨的[反射率](@entry_id:155393)剖面（A-scan）是通过对光谱[干涉图](@entry_id:750737)进行傅里叶变换得到的。然而，傅里叶变换算法（特别是[快速傅里叶变换](@entry_id:143432)，FFT）要求输入信号在**频率域**中是均匀采样的。在OCT中，这个频率域对应于**波数**（wavenumber）空间，定义为 $k = 2\pi/\lambda$。问题在于，无论是SD-OCT中与相机像素位置近似线性的波长 $\lambda$，还是SS-OCT中随时间线性变化的波长 $\lambda(t)$，均匀的 $\lambda$ 采样都会导致在 $k$ 空间中的[非均匀采样](@entry_id:752610)。这种非线性关系（$\Delta k \approx (2\pi/\lambda^2)\Delta\lambda$）意味着直接对原始数据进行FFT会引入严重的[图像失真](@entry_id:171444)，包括轴向几何扭曲和点扩散函数的展宽 。

为了解决这个问题，系统必须进行**k空间线性化**。在SD-OCT中，这通常通过数字信号处理完成：将采集到的非均匀 $k$ 空间数据通过**插值重采样**到一个均匀的 $k$ 网格上，然后再进行FFT。而在高性能的SS-OCT系统中，通常采用一种硬件解决方案：一个**k-时钟**（k-clock）。它利用一个辅助的马赫-曾德干涉仪产生一个频率与波数 $k$ 精确成正比的触发信号，从而直接在均匀的 $k$ 间隔上采集数据，避免了数字插值的需要 。对于OCTA而言，精确的k空间线性化尤为关键，因为[插值误差](@entry_id:139425)或采样不均匀会引入帧间的相位不稳定性，从而产生伪影，干扰对血流引起的微小相位和振幅变化的检测 。

### 探测运动：OCTA中的“A”

OCTA的核心思想是在同一位置重复进行OCT扫描，并分析这些重复扫描之间信号的差异，从而区分动态的血细胞和静态的组织。实现这一目标主要有两种机制。

#### 散斑去相关（Speckle Decorrelation）

这是目前商用OCTA系统最主流的技术。其基本原理是：在静态组织中，分辨率体素内的散射体位置固定，因此在短时间内重复扫描得到的散斑图案是高度相关的。相反，在血管内，[红细胞](@entry_id:140482)（RBCs）的流动导致散射体构型不断变化，使得连续扫描得到的散斑信号迅速**去相关**。这种信号变化不仅限于振幅，也包括相位。

去相关算法通过计算重复扫描信号之间的**互[相关系数](@entry_id:147037)**来量化这种变化。一个常用的去相关度量 $D$ 是基于归一化互[相关系数](@entry_id:147037)的幅度 $| \gamma(\Delta t) |$ 定义的，其中 $\Delta t$ 是重复扫描之间的时间间隔：$D(\Delta t) = 1 - |\gamma(\Delta t)|$。当信号完全相关时（静态组织），$|\gamma(\Delta t)| \approx 1$，$D \approx 0$；当信号完全去相关时（快速流动的血液），$|\gamma(\Delta t)| \to 0$，$D \to 1$。

一个具体的振幅去相关算法实例是计算局部窗口内两个振幅图像向量 $\mathbf{I}_1$ 和 $\mathbf{I}_2$ 之间的“余弦相异性”：

$$ D = 1 - \frac{\sum_{i} I_{1i} I_{2i}}{\sqrt{\left(\sum_{i} I_{1i}^{2}\right)\left(\sum_{i} I_{2i}^{2}\right)}} $$

该度量满足理想OCTA算法的几个重要特性：根据柯西-施瓦茨不等式，其值被界定在 $[0, 1]$ 之间；它对两次扫描之间的全局亮度变化（如激[光功率](@entry_id:170412)波动）不敏感，具有**尺度不变性**；并且它能有效地区分静态组织（$D \approx 0$）和血流（$D > 0$）。

至关重要的是，任何能够引起散射体在分辨率体素内发生替换的运动，无论是轴向运动还是**横向运动**，都会导致散斑去相关。这使得基于去相关的OCTA对各种方向的血流都敏感，并且由于它主要依赖于[相关系数](@entry_id:147037)的**幅度**，它对[干涉仪](@entry_id:261784)的系统性[相位噪声](@entry_id:264787)不如多普勒OCT敏感 。

#### 相位分辨多普勒OCT（Doppler OCT）

作为对比，多普勒OCT是另一种探测血流的技术。它利用了运动散射体引起的[多普勒频移](@entry_id:158041)。在FD-OCT中，这表现为连续A-scan之间复数信号的**相位差** $\Delta \phi$。这个相位差与散射体沿光束方向的**轴向速度** $v_z$ 成正比：

$$ \Delta \phi \propto v_z \Delta t $$

其中 $\Delta t$ 是连续A-scan之间的时间间隔。因此，多普勒OCT能够提供定量的轴向血流速度信息。然而，它也存在明显局限性：
1.  **方向依赖性**：它主要对轴向血流敏感，对纯横向血流（$v_z=0$）几乎不敏感。
2.  **相位稳定性要求**：精确测量 $\Delta \phi$ 需要[干涉仪](@entry_id:261784)系统具有极高的相位稳定性，任何系统[抖动](@entry_id:262829)都会被误解为血流信号。
3.  **相位包裹（混叠）**：当血流速度过高，导致 $|\Delta \phi| > \pi$ 时，测量的相位会“包裹”回 $(-\pi, \pi]$ 区间，产生速度混叠，即高速血流可能被误判为低速甚至反向血流。

相比之下，去相关OCTA在高速血流下会表现为饱和，即去相关值达到最大并保持不变，虽然失去了对速度的量化能力，但仍然能正确地识别出“存在快速流动”，而不会像多普勒OCT那样产生误导性的低速信号。这两种技术在不同的血流速度范围内具有互补的优势 。

### 从信号波动到血管图：信号处理与量化

原始的去相关值图充满了噪声，需要经过处理才能生成清晰的血管成像图。

#### 平均的作用

散斑信号本质上是随机的，因此单次计算的去相关值也具有很大的不确定性。为了提高[信噪比](@entry_id:271196)（更准确地说是对比度-噪声比，CNR），OCTA算法通常会在一个小的局部窗口（kernel）内对多个独立的测量结果进行**平均**。在静态组织中，理想的去相关值为0，但由于噪声的存在，实际测量值会在0附近波动。通过平均 $M$ 个独立的测量“[视场](@entry_id:175690)”（looks），可以将这个噪声的方差减小 $M$ 倍，即标准差减小 $\sqrt{M}$ 倍。这极大地抑制了静态组织中的背景噪声，从而凸显出血管内的真实血流信号 。

#### 量化模型

去相关信号的大小不仅与血流的存在有关，还与血流的速度和扫描参数有关。我们可以建立一个简化模型来理解这些关系。假设[红细胞](@entry_id:140482)以速度 $v$ 流过一个横向尺寸为 $L$ 的体素，那么在两次扫描间隔 $\tau$ 内，一个[红细胞](@entry_id:140482)穿越体素的概率可以近似为 $p \approx v\tau/L$。将[红细胞](@entry_id:140482)的过境事件建模为一个泊松过程，可以推导出在仅有血流的体素中，去相关值 $D(\tau)$ 与这些参数的关系为：

$$ D(\tau) = 1 - \exp\left(-\frac{v\tau}{L}\right) $$

。这个模型揭示了去相关信号如何随血流速度 $v$ 和扫描间隔 $\tau$ 增加而增加，并最终趋于饱和。这也解释了选择合适的 $\tau$ 是一个重要的权衡：$\tau$ 太短，慢速血流的去相关信号太弱；$\tau$ 太长，快速血流容易饱和，并且系统对患者的微小运动会更加敏感，从而增加伪影 。

### 实践考量与伪影

将OCTA应用于临床需要理解一些实际限制和图像判读中常见的伪影。

#### 波长选择

OCTA系统的中心波长对成像性能有重要影响，尤其是在需要穿透色素层（如视网膜色素上皮，RPE）对深层结构（如脉络膜）成像时。比较常用的840 nm和1060 nm波段，存在一个关键的权衡：
- **穿透性**：更长的波长（1060 nm）在生物组织中受到的散射和吸收（特别是RPE中黑色素的吸收）更少，因此具有更强的穿透能力，能够更好地显示RPE下方的脉络膜毛细血管层和脉络膜大血管。
- **背向散射信号**：[红细胞](@entry_id:140482)对光的[背向散射](@entry_id:142561)强度随波长增加而减弱。因此，在1060 nm处，来自血流的信号本身比840 nm处要弱。
- **分辨率**：在相同的[数值孔径](@entry_id:138876)（NA）下，横向分辨率与波长成正比（$\Delta x \propto \lambda/\text{NA}$），因此更长的波长会导致横向分辨率下降。而轴向分辨率（$\Delta z \propto \lambda_0^2/\Delta\lambda$）虽然也与波长平方成正比，但可以通过使用更宽带宽的光源来补偿。

综合来看，对于脉络膜毛细血管的成像，1060 nm波长系统带来的穿透性增益通常会超过其[背向散射](@entry_id:142561)信号减弱和横向分辨率稍差的劣势，从而获得更优的成像效果 。

#### [系统设计](@entry_id:755777)与安全

OCTA系统的设计必须在获得足够[信噪比](@entry_id:271196)（SNR）和保障患者眼部安全之间取得平衡。入射到眼内的激[光功率](@entry_id:170412)受到**最大允许曝光量**（MPE）的严格限制。所需的入射功率 $P_{\text{req}}$ 由目标[信噪比](@entry_id:271196)、探测器效率、组织反射率和[采集时间](@entry_id:266526)等因素决定，而最大允许功率 $P_{\text{max}}$ 则由MPE规定的视网膜辐照度限值和眼球的光学参数（如瞳孔直径）决定。系统的最终工作功率必须是这两者中的较小值，即 $P = \min\{P_{\text{req}}, P_{\text{max}}\}$ 。

#### 常见伪影

准确判读OCTA图像需要能够识别各种伪影。以下是一些最常见的伪影及其物理成因  ：

- **投影伪影（Projection Artifacts）**：这是OCTA中最重要且最普遍的伪影之一。其成因是位于上层的运动血细胞对下方静态组织的光照产生了**时间变化的“阴影”**。当光线穿过[上层](@entry_id:198114)血管时，流动的[红细胞](@entry_id:140482)会导致透射光的强度和相位发生波动。这种波动的光继续向下传播，照亮深层的静态组织，然后反射回来。尽管深层组织本身是静止的，但探测到的来自深层的信号却因为这种“闪烁”的照明而随时间变化，从而被算法错误地解读为血流。此外，在上层血管中发生的多重散射光也可能具有恰当的光程，使其信号被错误地定位到深层，这些多重散射信号同样因血流而波动。结果是在无血管的深层组织（如RPE下方）出现与[上层](@entry_id:198114)血管网形态完全一致的虚假血流信号 。

- **运动伪影（Motion Artifacts）**：通常由患者眼球的快速扫视（saccade）引起。当眼球在B-scan重复采样的瞬间发生横向位移时，会导致严重的信号去相关，表现为沿B-scan扫描方向（通常是水平方向）的明亮线条。线条两侧的血管结构可能出现断裂、错位或重影 。

- **眨眼伪影（Blink Artifacts）**：由眨眼时眼睑遮挡光束引起。这会导致信号完全丢失，在平扫（en face）图像上表现为沿B-scan方向的宽暗带，暗带内无任何结构或血流信号 。

- **[暗角](@entry_id:174163)/晕影（Vignetting）**：当光束未对准瞳孔中心或瞳孔过小时，扫描范围边缘的光线会被虹膜遮挡，导致图像周边区域的信号强度下降，表现为平扫图像四周逐渐变暗，血管信号减弱或消失 。

- **离焦伪影（Defocus）**：当成像焦平面与目标组织层不匹配时，会导致图像模糊，横向分辨率下降。在OCTA中，这会使得毛细血管网无法分辨，大血管边缘模糊，对比度下降 。

- **飞蚊症伪影（Floaters）**：玻璃体中的混浊物（飞蚊症）会遮挡和散射光线，在后方的视网膜上投下阴影。由于OCTA扫描过程中光束角度不断变化，这个阴影会在平扫图像上移动，通常表现为沿着慢轴扫描方向（通常是垂直方向）的条状或曲线状信号缺失区域 。

对这些原理和伪影的深刻理解，是充分利用OCTA技术进行临床诊断和科学研究的基石。