{
    "hands_on_practices": [
        {
            "introduction": "细胞如何从一个相同的祖细胞群体中分化成两种截然不同的、稳定的谱系，例如神经视网膜与视网膜色素上皮（RPE）？这个过程的核心是基因调控网络中的“分子开关”。通过分析一个由两个相互抑制的转录因子组成的简化动力学系统，即“基因拨动开关”，我们可以揭示细胞命运决定的基本原理 。这个练习将指导你进行线性稳定性分析，以从数学上推导出系统如何从单一稳定状态（未分化的祖细胞）转变为双稳态（两种不同的细胞命运），从而让你亲身体验连续的生化信号如何触发非此即彼的、决定性的细胞身份转变。",
            "id": "4670423",
            "problem": "在视神经上皮最早分化为神经视网膜和视网膜色素上皮 (RPE) 的过程中，观察到一对相互抑制的、决定细胞命运的转录因子。设 $x(t)$ 表示神经视网膜决定因子的归一化浓度，$y(t)$ 表示 RPE 决定因子的归一化浓度。分子生物学的中心法则指出，DNA 转录为 RNA，RNA 翻译为蛋白质；在调控网络中，蛋白质的产生可被阻遏蛋白以剂量依赖的方式下调，而蛋白质则通过周转被移除。假设两种因子的合成-降解动力学如下，其中抑制作用由一个 Hill 函数描述：\n$$\\frac{dx}{dt}=\\frac{\\alpha}{1+y^{n}}-\\beta x,\\qquad \\frac{dy}{dt}=\\frac{\\alpha}{1+x^{n}}-\\beta y,$$\n其中 $\\alpha>0$ 是最大产出参数，$\\beta>0$ 是一级移除速率，而 $n>0$ 是 Hill 协同性系数。\n\n假设在命运选择之前的祖细胞具有对称性，因此在均一稳态下，对于某个 $s>0$，有 $x=y=s$。仅使用基因调控和动力系统的第一性原理，从该模型中推导出临界产出参数 $\\alpha_{c}$ 作为 $\\beta$ 和 $n$ 的函数的闭式解析表达式。在该临界点，均一稳态失去线性稳定性，并出现两个对应于不同命运的不对称稳定稳态（双稳态）。你的最终答案必须是一个仅用 $\\beta$ 和 $n$ 表示的单一闭式解析表达式。无需进行数值取整。定性地解释该阈值的存在如何与 RPE 与神经视网膜两种结局的出现相关联，但最终答案中不要包含任何定性陈述。",
            "solution": "控制两种转录因子浓度 $x$ 和 $y$ 的方程组如下：\n$$\n\\frac{dx}{dt} = f(x, y) = \\frac{\\alpha}{1+y^{n}} - \\beta x\n$$\n$$\n\\frac{dy}{dt} = g(x, y) = \\frac{\\alpha}{1+x^{n}} - \\beta y\n$$\n\n首先，我们确定均一稳态，其中 $x = y = s$。在稳态下，时间导数为零，即 $\\frac{dx}{dt} = 0$ 和 $\\frac{dy}{dt} = 0$。将 $x=y=s$ 代入任一方程可得：\n$$\n0 = \\frac{\\alpha}{1+s^{n}} - \\beta s\n$$\n这定义了参数与稳态浓度 $s$ 之间的关系：\n$$\n\\alpha = \\beta s (1+s^{n})\n$$\n\n为了确定此稳态的稳定性，我们通过考察系统在该点 $(s, s)$ 的雅可比矩阵 $J$ 来进行线性稳定性分析。雅可比矩阵定义为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial x} & \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x} & \\frac{\\partial g}{\\partial y} \\end{pmatrix}\n$$\n偏导数如下：\n$$\n\\frac{\\partial f}{\\partial x} = -\\beta\n$$\n$$\n\\frac{\\partial f}{\\partial y} = -\\frac{\\alpha n y^{n-1}}{(1+y^{n})^2}\n$$\n$$\n\\frac{\\partial g}{\\partial x} = -\\frac{\\alpha n x^{n-1}}{(1+x^{n})^2}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -\\beta\n$$\n在稳态点 $(x, y) = (s, s)$ 处计算雅可比矩阵：\n$$\nJ(s,s) = \\begin{pmatrix} -\\beta & -\\frac{\\alpha n s^{n-1}}{(1+s^{n})^2} \\\\ -\\frac{\\alpha n s^{n-1}}{(1+s^{n})^2} & -\\beta \\end{pmatrix}\n$$\n我们可以通过代入稳态条件下的 $\\alpha$ 表达式：$\\alpha = \\beta s(1+s^n)$ 来简化非对角线项。\n$$\n-\\frac{\\alpha n s^{n-1}}{(1+s^{n})^2} = -\\frac{[\\beta s(1+s^n)] n s^{n-1}}{(1+s^{n})^2} = -\\frac{\\beta n s^{n}}{1+s^{n}}\n$$\n我们用 $C(s) = \\frac{\\beta n s^{n}}{1+s^{n}}$ 表示该项。雅可比矩阵变为：\n$$\nJ(s,s) = \\begin{pmatrix} -\\beta & -C(s) \\\\ -C(s) & -\\beta \\end{pmatrix}\n$$\n该矩阵的特征值 $\\lambda$ 通过求解特征方程 $\\det(J - \\lambda I) = 0$ 来找到：\n$$\n\\det \\begin{pmatrix} -\\beta - \\lambda & -C(s) \\\\ -C(s) & -\\beta - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\beta - \\lambda)^2 - (-C(s))^2 = 0\n$$\n$$\n(\\beta + \\lambda)^2 = C(s)^2\n$$\n$$\n\\beta + \\lambda = \\pm C(s)\n$$\n两个特征值为：\n$$\n\\lambda_1 = -\\beta + C(s)\n$$\n$$\n\\lambda_2 = -\\beta - C(s)\n$$\n因为 $\\beta > 0$，$n > 0$，且 $s > 0$，所以项 $C(s)$ 严格为正。因此，特征值 $\\lambda_2 = -\\beta - C(s)$ 恒为负。均一稳态的稳定性完全由 $\\lambda_1$ 的符号决定。\n如果 $\\lambda_1 < 0$，即 $-\\beta + C(s) < 0$，或 $C(s) < \\beta$，则稳态是稳定的。\n当 $\\lambda_1$ 从负值穿过零变为正值时，稳态失去稳定性。临界点（或分岔点）恰好在 $\\lambda_1 = 0$ 时发生。这定义了双稳态出现的条件。\n\n设 $\\lambda_1 = 0$，我们得到：\n$$\n-\\beta + C(s_c) = 0 \\implies C(s_c) = \\beta\n$$\n其中 $s_c$ 是分岔点处的临界稳态浓度。代入 $C(s)$ 的表达式：\n$$\n\\frac{\\beta n s_c^{n}}{1+s_c^{n}} = \\beta\n$$\n因为 $\\beta > 0$，我们可以在两边同除以 $\\beta$：\n$$\n\\frac{n s_c^{n}}{1+s_c^{n}} = 1\n$$\n$$\nn s_c^{n} = 1 + s_c^{n}\n$$\n$$\n(n-1)s_c^{n} = 1\n$$\n该方程仅当 $n-1 > 0$（即 $n>1$）时，才有 $s_c$ 的实数正解。这是拨动开关中出现双稳态的一个已知要求；抑制作用必须是协同的。求解 $s_c^n$ 和 $s_c$：\n$$\ns_c^n = \\frac{1}{n-1} \\implies s_c = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}\n$$\n现在，我们将这个临界浓度 $s_c$ 代入稳态关系式 $\\alpha = \\beta s(1+s^n)$，以求得临界产出参数 $\\alpha_c$。\n$$\n\\alpha_c = \\beta s_c (1+s_c^n)\n$$\n代入 $s_c$ 和 $s_c^n$ 的表达式：\n$$\n\\alpha_c = \\beta (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n简化括号中的项：\n$$\n1 + \\frac{1}{n-1} = \\frac{n-1+1}{n-1} = \\frac{n}{n-1}\n$$\n所以，$\\alpha_c$ 的表达式变为：\n$$\n\\alpha_c = \\beta (n-1)^{-1/n} \\left(\\frac{n}{n-1}\\right) = \\beta n (n-1)^{-1/n} (n-1)^{-1}\n$$\n合并 $(n-1)$ 项的指数：\n$$\n\\alpha_c = \\beta n (n-1)^{-(1/n + 1)} = \\beta n (n-1)^{-(1+n)/n}\n$$\n这就是临界产出参数的闭式解析表达式。\n\n定性地讲，这个阈值 $\\alpha_c$ 代表了启动该基因开关所需的最小产出速率。对于 $\\alpha < \\alpha_c$，唯一的稳定结局是均一状态，此时细胞以中等水平共表达两种决定因子，代表一种未分化的祖细胞状态。对于 $\\alpha > \\alpha_c$，该状态变得不稳定，微小的随机波动将驱使细胞朝向两个新的稳定状态之一：高 $x$/低 $y$（神经视网膜）或低 $x$/高 $y$（RPE）。因此，超过这个临界产出阈值是使系统能够从一个单稳态、未定状态转变为一个双稳态机制的事件，在双稳态机制中，确定的、相互排斥的细胞命运得以出现并维持。",
            "answer": "$$\\boxed{\\frac{\\beta n}{(n-1)^{(n+1)/n}}}$$"
        },
        {
            "introduction": "在单个细胞做出命运决定之后，下一个挑战是如何确保为眼部的多个组织结构（如角膜、小梁网和葡萄膜）提供足够数量的细胞。发育过程可以被看作是一个复杂的资源分配问题，其中一个共同的祖细胞池（如颅神经嵴细胞）必须按比例分配给各个谱系。本练习  建立了一个量化模型，将发育视为一个供需系统，以探索祖细胞数量的全局性减少如何不成比例地影响不同组织。通过计算哪个谱系最先出现细胞供应不足，你将学会如何从系统生物学的角度预测特定先天性异常（如眼前节发育不全）的表型。",
            "id": "4670491",
            "problem": "一群颅神经嵴 (NC) 细胞迁移到眼周间充质中，形成眼睛的前节结构。在一个简化的定量模型中，假设存在一个大小为 $N_{0}$ 的单一祖细胞池，它按固定的分配分数 $\\{f_{i}\\}$ 将后代细胞按比例分配给五个源自神经嵴的眼部谱系，这些谱系具有独立的组织需求 $\\{D_{i}\\}$。所考虑的谱系包括角膜内皮 (i = $\\mathrm{CE}$)、角膜基质 (i = $\\mathrm{CS}$)、小梁网 (i = $\\mathrm{TM}$)、巩膜成纤维细胞 (i = $\\mathrm{SC}$) 以及虹膜和睫状体的葡萄膜基质 (i = $\\mathrm{US}$)。基准细胞池大小为 $N_{0} = 2.0 \\times 10^{6}$ 个细胞，分配分数为\n$$\nf_{\\mathrm{CE}} = 0.12,\\quad f_{\\mathrm{CS}} = 0.25,\\quad f_{\\mathrm{TM}} = 0.08,\\quad f_{\\mathrm{SC}} = 0.35,\\quad f_{\\mathrm{US}} = 0.20,\n$$\n以及独立的最低需求量\n$$\nD_{\\mathrm{CE}} = 2.2 \\times 10^{5},\\quad D_{\\mathrm{CS}} = 4.5 \\times 10^{5},\\quad D_{\\mathrm{TM}} = 1.4 \\times 10^{5},\\quad D_{\\mathrm{SC}} = 6.5 \\times 10^{5},\\quad D_{\\mathrm{US}} = 3.9 \\times 10^{5}.\n$$\n通过一个分数损失 $x$ (表示为小数，例如 $x = 0.10$ 表示减少 $10\\%$) 来模拟神经嵴细胞的全局性减少，并假设谱系分配是成比例的，且谱系之间没有代偿性重分配。在这种减少的情况下，对谱系 $i$ 的预期供应量为\n$$\nS_{i}(x) = N_{0}(1 - x) f_{i}.\n$$\n如果 $S_{i}(x) \\geq D_{i}$，组织就能正常形成。\n\n从发育生物学中的按比例分配和供需约束原则出发，推导出一个所有组织都能满足其需求的条件，并计算出最大的分数减少量 $x^{\\ast}$，使得所有五个谱系仍然能满足其需求 $D_{i}$。将 $x^{\\ast}$ 表示为小数，并将您的答案四舍五入到三位有效数字。最后，根据当 $x$ 增加到超过 $x^{\\ast}$ 时哪个谱系首先受到供应限制，简要解释在器官层面上最可能出现的初始表型表现；您的解释应包含在您的推理过程中，但不必反映在最终的数值答案中。",
            "solution": "该问题描述了一个关于眼前节发育过程中细胞分配的定量模型，这些细胞源自一个共同的颅神经嵴 (NC) 细胞池。该模型基于按比例分配和供需约束的原则。所有五个特定眼部谱系正常形成的核心条件是，供应给每个谱系 $i$ 的细胞数量 $S_i(x)$ 必须大于或等于该谱系的最低发育需求 $D_i$。\n\n问题指出，初始祖细胞池的全局性减少通过一个分数损失 $x$ 来建模，此时祖细胞池的大小变为 $N_0(1-x)$。供应给谱系 $i$ 的数量由以下方程给出：\n$$\nS_i(x) = N_0(1-x)f_i\n$$\n其中 $N_0 = 2.0 \\times 10^6$ 是初始细胞池大小，$x$ 是分数损失，$f_i$ 是谱系 $i \\in \\{\\mathrm{CE}, \\mathrm{CS}, \\mathrm{TM}, \\mathrm{SC}, \\mathrm{US}\\}$ 的分配分数。\n\n为了使所有五个组织正常形成，必须同时满足每个谱系的供需条件：\n$$\nS_i(x) \\geq D_i \\quad \\text{for all } i \\in \\{\\mathrm{CE}, \\mathrm{CS}, \\mathrm{TM}, \\mathrm{SC}, \\mathrm{US}\\}\n$$\n代入 $S_i(x)$ 的表达式，我们得到一个由五个不等式组成的系统：\n$$\nN_0(1-x)f_i \\geq D_i\n$$\n为了找到对分数损失 $x$ 的约束，我们可以对每个不等式求解 $x$。假设 $N_0 > 0$ 且 $f_i > 0$，我们可以重新排列不等式：\n$$\n1 - x \\geq \\frac{D_i}{N_0 f_i}\n$$\n$$\nx \\leq 1 - \\frac{D_i}{N_0 f_i}\n$$\n这个不等式定义了为使每个独立谱系 $i$ 满足其需求所允许的最大分数损失 $x_i^{\\text{max}}$：\n$$\nx_i^{\\text{max}} = 1 - \\frac{D_i}{N_0 f_i}\n$$\n项 $N_0 f_i$ 表示在没有任何减少的情况下（即 $x=0$ 时）对谱系 $i$ 的基准供应量，我们称之为 $S_i(0)$。比率 $\\frac{D_i}{S_i(0)}$ 表示为满足最低需求所需的基准供应量的分数。具有最高该比率的谱系对祖细胞池的减少最为脆弱，因为它具有最小的盈余。\n\n让我们使用所提供的数据计算五个谱系中每一个的 $x_i^{\\text{max}}$：$N_0 = 2.0 \\times 10^6$。\n\n1.  **角膜内皮 (CE):** $f_{\\mathrm{CE}} = 0.12$, $D_{\\mathrm{CE}} = 2.2 \\times 10^5$。\n    基准供应量为 $S_{\\mathrm{CE}}(0) = (2.0 \\times 10^6)(0.12) = 2.4 \\times 10^5$。\n    最大分数损失为：\n    $$\n    x_{\\mathrm{CE}}^{\\text{max}} = 1 - \\frac{2.2 \\times 10^5}{2.4 \\times 10^5} = 1 - \\frac{11}{12} = \\frac{1}{12} \\approx 0.08333\n    $$\n\n2.  **角膜基质 (CS):** $f_{\\mathrm{CS}} = 0.25$, $D_{\\mathrm{CS}} = 4.5 \\times 10^5$。\n    基准供应量为 $S_{\\mathrm{CS}}(0) = (2.0 \\times 10^6)(0.25) = 5.0 \\times 10^5$。\n    最大分数损失为：\n    $$\n    x_{\\mathrm{CS}}^{\\text{max}} = 1 - \\frac{4.5 \\times 10^5}{5.0 \\times 10^5} = 1 - 0.9 = 0.10\n    $$\n\n3.  **小梁网 (TM):** $f_{\\mathrm{TM}} = 0.08$, $D_{\\mathrm{TM}} = 1.4 \\times 10^5$。\n    基准供应量为 $S_{\\mathrm{TM}}(0) = (2.0 \\times 10^6)(0.08) = 1.6 \\times 10^5$。\n    最大分数损失为：\n    $$\n    x_{\\mathrm{TM}}^{\\text{max}} = 1 - \\frac{1.4 \\times 10^5}{1.6 \\times 10^5} = 1 - \\frac{7}{8} = \\frac{1}{8} = 0.125\n    $$\n\n4.  **巩膜成纤维细胞 (SC):** $f_{\\mathrm{SC}} = 0.35$, $D_{\\mathrm{SC}} = 6.5 \\times 10^5$。\n    基准供应量为 $S_{\\mathrm{SC}}(0) = (2.0 \\times 10^6)(0.35) = 7.0 \\times 10^5$。\n    最大分数损失为：\n    $$\n    x_{\\mathrm{SC}}^{\\text{max}} = 1 - \\frac{6.5 \\times 10^5}{7.0 \\times 10^5} = 1 - \\frac{13}{14} = \\frac{1}{14} \\approx 0.07143\n    $$\n\n5.  **葡萄膜基质 (US):** $f_{\\mathrm{US}} = 0.20$, $D_{\\mathrm{US}} = 3.9 \\times 10^5$。\n    基准供应量为 $S_{\\mathrm{US}}(0) = (2.0 \\times 10^6)(0.20) = 4.0 \\times 10^5$。\n    最大分数损失为：\n    $$\n    x_{\\mathrm{US}}^{\\text{max}} = 1 - \\frac{3.9 \\times 10^5}{4.0 \\times 10^5} = 1 - 0.975 = 0.025\n    $$\n\n为确保所有五个谱系都满足其需求，分数减少量 $x$ 必须小于或等于*每一个*谱系的最大可容忍减少量。这意味着 $x$ 必须小于或等于所有计算出的 $x_i^{\\text{max}}$ 值中的最小值。因此，满足所有条件的最大分数减少量 $x^{\\ast}$ 是这些值中的最小值：\n$$\nx^{\\ast} = \\min(x_{\\mathrm{CE}}^{\\text{max}}, x_{\\mathrm{CS}}^{\\text{max}}, x_{\\mathrm{TM}}^{\\text{max}}, x_{\\mathrm{SC}}^{\\text{max}}, x_{\\mathrm{US}}^{\\text{max}})\n$$\n$$\nx^{\\ast} = \\min(\\approx 0.08333, 0.10, 0.125, \\approx 0.07143, 0.025)\n$$\n最小值为 $0.025$。\n$$\nx^{\\ast} = 0.025\n$$\n问题要求答案表示为小数，并四舍五入到三位有效数字，即 $0.0250$。\n\n决定此限制的谱系是葡萄膜基质 (US)，因为它具有最小的最大可容忍减少量。这意味着随着神经嵴细胞分数损失 $x$ 的增加，葡萄膜基质是第一个其供应量将低于其发育需求的组织。葡萄膜基质构成虹膜和睫状体。因此，在器官层面上最可能出现的初始表型表现将是这些结构形成中的缺陷。这可能表现为虹膜发育不全（发育不足）、虹膜缺损（虹膜中可见的缝隙或孔洞）或睫状体功能障碍，可能影响房水动力学和眼内压调节。这些结果是眼前节发育不良的标志，这是一类与神经嵴细胞发育失败相关的发育性眼部疾病。",
            "answer": "$$\n\\boxed{0.0250}\n$$"
        },
        {
            "introduction": "掌握了细胞命运决定和细胞数量分配的原理后，我们来探讨发育中的最后一个关键问题：空间组织。细胞不仅需要选择正确的身份并达到足够的数量，还必须在空间上精确排列，形成功能性的组织边界。反应-扩散模型是解释这种模式形成的经典理论框架，它将局部基因调控（如前述的基因开关）与细胞间的空间通讯（扩散）相结合。这项计算实践  邀请你通过编程来模拟视泡中 $Pax6$ 和 $Pax2$ 表达域的形成过程。通过亲手构建并运行这个模型，你将直观地看到一个最初均匀的细胞群体如何在一个形态发生素梯度的引导下，自发地形成清晰的组织边界，从而深入理解形态发生的动力学机制。",
            "id": "4670447",
            "problem": "您需要实现、模拟和分析一个最小基因调控网络，该网络捕捉沿一维轴的早期眼部模式形成，该轴代表视泡的背腹范围。此网络由成对盒基因6 (Pax6) 和成对盒基因2 (Pax2) 组成，并由 Sonic hedgehog (Shh) 提供腹侧形态发生素梯度。将 Pax6 和 Pax2 的浓度建模为一维域 $x \\in [0,L]$ 上的无量纲场 $P_6(x,t)$ 和 $P_2(x,t)$，其中 $L$ 是无量纲的。Sonic hedgehog (Shh) 是一个无量纲的浓度场 $S(x)$，它在时间上是静态的且不扩散。\n\n使用的基本原理和事实：\n- 基因表达调控：生产速率通过S型响应函数依赖于激活子和抑制子；降解与浓度成正比，反映了一级动力学，这与分子生物学中心法则（DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质）和翻译后动力学一致。\n- 用于组织中蛋白质运动的菲克扩散定律：扩散贡献一个与浓度空间二阶导数成正比的项。\n- 早期眼部模式形成观察：Pax6 和 Pax2 相互抑制；Shh 在腹侧促进 Pax2 并抑制 Pax6；出现稳定的高 Pax6 浓度与高 Pax2 浓度的区域，并形成边界。\n\n将最小调控动力学形式化为一个反应扩散系统：\n$$\n\\frac{\\partial P_6}{\\partial t} \\;=\\; \\alpha_6 \\, H_{\\mathrm{act}}\\!\\left(P_6;K_{A6},n_6\\right) \\, H_{\\mathrm{rep}}\\!\\left(P_2;K_{R62},m_{62}\\right) \\, H_{\\mathrm{rep}}\\!\\left(S;K_{RS},m_S\\right) \\;-\\; \\delta_6 \\, P_6 \\;+\\; D_6 \\, \\frac{\\partial^2 P_6}{\\partial x^2},\n$$\n$$\n\\frac{\\partial P_2}{\\partial t} \\;=\\; \\alpha_2 \\, H_{\\mathrm{act}}\\!\\left(S;K_{AS},n_S\\right) \\, H_{\\mathrm{rep}}\\!\\left(P_6;K_{R26},m_{26}\\right) \\;-\\; \\delta_2 \\, P_2 \\;+\\; D_2 \\, \\frac{\\partial^2 P_2}{\\partial x^2}.\n$$\n此处，$H_{\\mathrm{act}}(X;K,n) = \\dfrac{(X/K)^n}{1+(X/K)^n}$ 是一个激活型Hill函数，而 $H_{\\mathrm{rep}}(Y;K,m) = \\dfrac{1}{1+(Y/K)^m}$ 是一个抑制型Hill函数。所有变量和参数都是无量纲的。使用零通量（诺伊曼）边界条件 $\\left.\\dfrac{\\partial P_6}{\\partial x}\\right|_{x=0,L} = 0$ 和 $\\left.\\dfrac{\\partial P_2}{\\partial x}\\right|_{x=0,L} = 0$。\n\n设 Shh 梯度为 logistic 分布曲线：\n$$\nS(x) \\;=\\; \\frac{S_{\\max}}{1 + \\exp\\!\\left(\\frac{x - x_0}{\\sigma}\\right)},\n$$\n其中 $S_{\\max}$、$x_0$ 和 $\\sigma$ 是无量纲常数，且 $x \\in [0,L]$，$L=1$。\n\n将域离散化为 $N$ 个等间距点，其间距为 $\\Delta x = \\dfrac{L}{N-1}$，并使用标准的二阶中心差分以及反射值来近似 $\\dfrac{\\partial^2}{\\partial x^2}$，以强制执行零通量边界。从指定的初始条件开始，随时间向前积分系统，直到达到稳态，稳态定义为：在连续50次检查中，$P_6$ 和 $P_2$ 在整个域上每个时间步长的最大绝对变化量均小于 $\\epsilon = 10^{-6}$，检查每50步执行一次。\n\n对于给定的参数集达到稳态后，检测区域边界，即位置 $x^\\ast$。在该位置，当从 $x=0$（背侧）扫描到 $x=L$（腹侧）时，差值 $D(x) = P_6(x) - P_2(x)$ 的符号从正（Pax6主导）变为负（Pax2主导）。如果 $D(x)$ 的符号不改变，若对所有 $x$ 都有 $D(x) < 0$（处处为Pax2主导），则定义边界为 $x^\\ast = 0$；若对所有 $x$ 都有 $D(x) > 0$（处处为Pax6主导），则定义边界为 $x^\\ast = L$。如果存在多个符号变化点，则选择其 $x$ 值最接近 $L/2$ 的穿越点。在穿越点周围的相邻网格点之间使用线性插值来估计 $x^\\ast$。\n\n所有量均为无量纲；报告边界位置为分数 $x^\\ast/L$，四舍五入到三位小数。\n\n实现程序以计算以下每个测试用例的 $x^\\ast/L$ 值，每个用例均有 $N=201$, $L=1$, $S_{\\max}=1$, $\\alpha_6=1.6$, $\\alpha_2=1.4$, $\\delta_6=\\delta_2=1.0$, $K_{A6}=0.3$, $K_{R62}=0.3$, $K_{RS}=0.5$, $K_{AS}=0.3$, $K_{R26}=0.3$, $n_6=2$, $n_S=2$, $m_{62}=2$, $m_{26}=2$, $m_S=2$。扩散系数 $D_6$ 和 $D_2$ 等于下面特定于用例的 $D$。初始条件是无量纲的，并以定性方式指定；按如下方式进行数值实例化：“中性” (neutral) 指对所有 $x$，$P_6(x,0)=P_2(x,0)=0.01$；“Pax6偏向” (Pax6-biased) 指对 $x \\leq 0.5$，$P_6(x,0)=0.8$，对 $x>0.5$，$P_6(x,0)=0.05$，同时对所有 $x$，$P_2(x,0)=0.05$；“Pax2偏向” (Pax2-biased) 指对 $x > 0.5$，$P_2(x,0)=0.8$，对 $x \\leq 0.5$，$P_2(x,0)=0.05$，同时对所有 $x$，$P_6(x,0)=0.05$。\n\n测试套件（每个元组为 $(x_0,\\sigma,D,\\text{初始条件})$):\n- 用例 1: $(0.50, 0.08, 0.001, \\text{中性})$。\n- 用例 2: $(0.50, 0.30, 0.001, \\text{中性})$。\n- 用例 3: $(0.50, 0.08, 0.050, \\text{中性})$。\n- 用例 4: $(0.50, 0.08, 0.001, \\text{Pax6偏向})$。\n- 用例 5: $(0.50, 0.08, 0.001, \\text{Pax2偏向})$。\n\n您的程序应生成单行输出，其中包含五个边界分数 $x^\\ast/L$（四舍五入到三位小数），形式为方括号内以逗号分隔的列表（例如，“$[0.500,0.412,0.000,0.533,0.467]$”）。打印的单行必须严格符合此格式。",
            "solution": "该解决方案通过数值求解给定的反应扩散方程组来实现。该过程涉及空间离散化、时间积分和后处理以找到区域边界。\n\n**1. 空间离散化**\n将一维域 $x \\in [0, 1]$ 离散化为 $N=201$ 个等间距网格点 $x_i = i \\cdot \\Delta x$，其中 $i = 0, 1, \\dots, N-1$，网格间距为 $\\Delta x = L/(N-1) = 1/200 = 0.005$。连续场 $P_6(x,t)$ 和 $P_2(x,t)$ 由长度为 $N$ 的向量 $\\mathbf{P_6}(t)$ 和 $\\mathbf{P_2}(t)$ 近似，其中第 $i$ 个元素表示在网格点 $x_i$ 处的浓度。\n\n扩散项 $\\frac{\\partial^2 P}{\\partial x^2}$ 使用二阶中心差分格式进行近似。对于内部网格点 $i \\in [1, N-2]$，拉普拉斯算子为：\n$$\n\\left(\\frac{\\partial^2 P}{\\partial x^2}\\right)_i \\approx \\frac{P_{i-1} - 2P_i + P_{i+1}}{(\\Delta x)^2}\n$$\n零通量诺伊曼边界条件通过引入虚拟点或等效地通过为边界节点推导特殊公式来处理。在 $x=x_0$ 处，条件 $\\frac{\\partial P}{\\partial x}=0$ 的中心差分近似意味着 $P_{-1} = P_1$。将此代入 $i=0$ 处的拉普拉斯公式，得到：\n$$\n\\left(\\frac{\\partial^2 P}{\\partial x^2}\\right)_0 \\approx \\frac{2(P_1 - P_0)}{(\\Delta x)^2}\n$$\n类似地，在右边界 $x=x_{N-1}$ 处：\n$$\n\\left(\\frac{\\partial^2 P}{\\partial x^2}\\right)_{N-1} \\approx \\frac{2(P_{N-2} - P_{N-1})}{(\\Delta x)^2}\n$$\n这些公式将用于计算每个网格点上动力学的扩散贡献。\n\n**2. 时间积分**\n空间离散化后，偏微分方程（PDEs）组变成一个大型的耦合常微分方程（ODEs）组，每个网格点和每个物种都有一个方程：\n$$\n\\frac{d P_{6,i}}{dt} = \\text{Reaction}_{6,i} + D_6 \\cdot \\text{Laplacian}_{6,i}\n$$\n$$\n\\frac{d P_{2,i}}{dt} = \\text{Reaction}_{2,i} + D_2 \\cdot \\text{Laplacian}_{2,i}\n$$\n该系统使用显式前向欧拉法随时间向前积分：\n$$\n\\mathbf{P}(t+\\Delta t) = \\mathbf{P}(t) + \\Delta t \\cdot \\frac{d\\mathbf{P}}{dt}\n$$\n时间步长 $\\Delta t$ 必须选择得足够小以确保数值稳定性。对于应用于反应扩散系统的显式格式，扩散项通常施加最严格的约束，约为 $\\Delta t < (\\Delta x)^2 / (2D)$。给定参数，$\\Delta x = 0.005$，最大扩散系数为 $D = 0.050$（在用例3中）。这得出的稳定性极限为 $\\Delta t < (0.005)^2 / (2 \\cdot 0.050) = 2.5 \\times 10^{-4}$。选择时间步长 $\\Delta t = 10^{-4}$，这安全地低于此极限，并应确保所有测试用例的稳定性。\n\n模拟迭代进行，直到满足稳态判据。每50个时间步，计算浓度向量的最大绝对变化量 $\\max(|\\mathbf{P_6}(t) - \\mathbf{P_6}(t_{prev})|)$ 和 $\\max(|\\mathbf{P_2}(t) - \\mathbf{P_2}(t_{prev})|)$。如果两者都小于 $\\epsilon = 10^{-6}$，则计数器加一。否则，重置计数器。当计数器达到50时，模拟终止。\n\n**3. 边界检测**\n一旦找到稳态浓度 $\\mathbf{P_6}$ 和 $\\mathbf{P_2}$，就确定边界位置 $x^\\ast$。\n首先，计算差分向量 $\\mathbf{D} = \\mathbf{P_6} - \\mathbf{P_2}$。\n算法如下：\n- 如果 $\\mathbf{D}$ 的所有元素均为正，则整个域为Pax6主导，所以 $x^\\ast=L=1$。\n- 如果 $\\mathbf{D}$ 的所有元素均为负，则整个域为Pax2主导，所以 $x^\\ast=0$。\n- 否则，找到所有 $D$ 改变符号的索引 $i$，即 $D_i \\cdot D_{i+1} < 0$。这些是包含边界的网格区间。\n- 对于在索引 $i$ 处的每个此类穿越点，使用线性插值找到精确位置：\n$$\nx_{\\text{cross}} = x_i - D_i \\frac{x_{i+1} - x_i}{D_{i+1} - D_i} = x_i - D_i \\frac{\\Delta x}{D_{i+1} - D_i}\n$$\n- 如果找到多个穿越点，则选择其位置 $x_{\\text{cross}}$ 最接近域中心 ($L/2=0.5$) 的一个作为 $x^\\ast$。\n- 每个用例的最终结果是 $x^\\ast/L$，由于 $L=1$，这即是 $x^\\ast$，四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n\n    def H_act(X, K, n):\n        \"\"\"Activating Hill function.\"\"\"\n        # Add a small epsilon to prevent division by zero or issues with X=0, K=0\n        K_safe = K + 1e-9\n        ratio = X / K_safe\n        return np.power(ratio, n) / (1.0 + np.power(ratio, n))\n\n    def H_rep(Y, K, m):\n        \"\"\"Repressive Hill function.\"\"\"\n        K_safe = K + 1e-9\n        ratio = Y / K_safe\n        return 1.0 / (1.0 + np.power(ratio, m))\n\n    def run_simulation(x0, sigma, D, initial_type, params):\n        \"\"\"\n        Runs a single reaction-diffusion simulation until steady state.\n        \"\"\"\n        # Unpack parameters\n        N, L, S_max = params['N'], params['L'], params['S_max']\n        alpha6, alpha2 = params['alpha6'], params['alpha2']\n        delta6, delta2 = params['delta6'], params['delta2']\n        K_A6, K_R62, K_RS = params['K_A6'], params['K_R62'], params['K_RS']\n        K_AS, K_R26 = params['K_AS'], params['K_R26']\n        n6, n_S, m_62, m_26, m_S = params['n6'], params['n_S'], params['m_62'], params['m_26'], params['m_S']\n        D6 = D\n        D2 = D\n        dt = params['dt']\n        epsilon = params['epsilon']\n\n        # Setup grid\n        x = np.linspace(0, L, N)\n        dx = L / (N - 1)\n        dx2 = dx**2\n        \n        # Setup static Shh profile\n        S = S_max / (1.0 + np.exp((x - x0) / sigma))\n\n        # Initial conditions\n        P6 = np.full(N, 0.01)\n        P2 = np.full(N, 0.01)\n\n        if initial_type == 'Pax6-biased':\n            P6[x = 0.5] = 0.8\n            P6[x > 0.5] = 0.05\n            P2[:] = 0.05\n        elif initial_type == 'Pax2-biased':\n            P2[x > 0.5] = 0.8\n            P2[x = 0.5] = 0.05\n            P6[:] = 0.05\n\n        # Time integration loop\n        step = 0\n        consecutive_converged_count = 0\n        max_steps = 2_000_000 # Safety break\n\n        while step  max_steps:\n            P6_old = P6.copy()\n            P2_old = P2.copy()\n            \n            # Reaction terms\n            R6 = alpha6 * H_act(P6, K_A6, n6) * H_rep(P2, K_R62, m_62) * H_rep(S, K_RS, m_S)\n            R2 = alpha2 * H_act(S, K_AS, n_S) * H_rep(P6, K_R26, m_26)\n\n            # Diffusion terms (Laplacian) with Neumann boundary conditions\n            lap_P6 = np.zeros(N)\n            lap_P6[1:-1] = (P6[2:] - 2*P6[1:-1] + P6[:-2]) / dx2\n            lap_P6[0] = 2 * (P6[1] - P6[0]) / dx2\n            lap_P6[-1] = 2 * (P6[-2] - P6[-1]) / dx2\n\n            lap_P2 = np.zeros(N)\n            lap_P2[1:-1] = (P2[2:] - 2*P2[1:-1] + P2[:-2]) / dx2\n            lap_P2[0] = 2 * (P2[1] - P2[0]) / dx2\n            lap_P2[-1] = 2 * (P2[-2] - P2[-1]) / dx2\n\n            # Update concentrations using Forward Euler\n            dP6_dt = R6 - delta6 * P6 + D6 * lap_P6\n            dP2_dt = R2 - delta2 * P2 + D2 * lap_P2\n\n            P6 += dt * dP6_dt\n            P2 += dt * dP2_dt\n            \n            # Ensure concentrations are non-negative\n            P6[P6  0] = 0\n            P2[P2  0] = 0\n\n            step += 1\n\n            # Check for steady state\n            if step % 50 == 0:\n                max_change_p6 = np.max(np.abs(P6 - P6_old))\n                max_change_p2 = np.max(np.abs(P2 - P2_old))\n\n                if max_change_p6  epsilon and max_change_p2  epsilon:\n                    consecutive_converged_count += 1\n                else:\n                    consecutive_converged_count = 0\n                \n                if consecutive_converged_count >= 50:\n                    break\n        \n        return x, P6, P2\n\n    def find_boundary(x, P6, P2, L):\n        \"\"\"\n        Finds the boundary x* from the steady state concentrations.\n        \"\"\"\n        D = P6 - P2\n        \n        # Check for all positive or all negative cases\n        if np.all(D > 0):\n            return L\n        if np.all(D  0):\n            return 0.0\n\n        # Find sign changes from positive to negative\n        crossings = np.where((D[:-1] > 0)  (D[1:] = 0))[0]\n        \n        if len(crossings) == 0:\n             # This can happen if the only crossing is negative to positive\n             # or if the profile is noisy. Fallback to global state.\n             return L if D[-1] > 0 else 0.0\n\n        # Interpolate at each crossing\n        interpolated_crossings = []\n        for i in crossings:\n            x_star = x[i] - D[i] * (x[i+1] - x[i]) / (D[i+1] - D[i])\n            interpolated_crossings.append(x_star)\n        \n        # Select crossing closest to L/2\n        if len(interpolated_crossings) > 1:\n            distances = np.abs(np.array(interpolated_crossings) - L / 2.0)\n            best_idx = np.argmin(distances)\n            return interpolated_crossings[best_idx]\n        else:\n            return interpolated_crossings[0]\n\n    # Global parameters for all simulations\n    common_params = {\n        'N': 201, 'L': 1.0, 'S_max': 1.0,\n        'alpha6': 1.6, 'alpha2': 1.4,\n        'delta6': 1.0, 'delta2': 1.0,\n        'K_A6': 0.3, 'K_R62': 0.3, 'K_RS': 0.5,\n        'K_AS': 0.3, 'K_R26': 0.3,\n        'n6': 2, 'n_S': 2, 'm_62': 2, 'm_26': 2, 'm_S': 2,\n        'dt': 1e-4, 'epsilon': 1e-6\n    }\n    L_val = common_params['L']\n    \n    # Define test cases from the problem statement.\n    test_cases = [\n        (0.50, 0.08, 0.001, 'neutral'),\n        (0.50, 0.30, 0.001, 'neutral'),\n        (0.50, 0.08, 0.050, 'neutral'),\n        (0.50, 0.08, 0.001, 'Pax6-biased'),\n        (0.50, 0.08, 0.001, 'Pax2-biased'),\n    ]\n\n    results = []\n    for case in test_cases:\n        x0, sigma, D, initial = case\n        x_grid, P6_final, P2_final = run_simulation(x0, sigma, D, initial, common_params)\n        x_star = find_boundary(x_grid, P6_final, P2_final, L_val)\n        \n        # Report fraction x*/L rounded to three decimals\n        boundary_fraction = x_star / L_val\n        results.append(f\"{boundary_fraction:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}