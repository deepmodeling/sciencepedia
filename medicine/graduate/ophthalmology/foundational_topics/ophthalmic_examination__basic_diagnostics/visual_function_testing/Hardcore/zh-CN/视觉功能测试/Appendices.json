{
    "hands_on_practices": [
        {
            "introduction": "精确量化视力是临床眼科和视觉科学的基石。本练习旨在帮助您熟练掌握不同视力记录单位之间的转换，例如临床常用的斯内伦（Snellen）分数与科研中广泛使用的logMAR单位。通过这个练习，您将加深对视力定义的理解，并学会如何根据视角计算所需视标的物理尺寸。",
            "id": "4733066",
            "problem": "一位患者的远视力在标准测试距离下使用 Snellen 记法记录为 $20/40$。在临床视觉心理物理学中，小数视力定义为测试距离与“视标设计距离”（Snellen 分数的分母）之比；最小分辨角（MAR）定义为视标中可分辨的最小特征，单位为角分，且为小数视力的倒数；最小分辨角的对数（logMAR）定义为 $\\log_{10}(\\mathrm{MAR})$。另外，物理高度为 $H$ 的物体在观看距离 $d$ 处所对的几何视角 $\\theta$ 遵循眼的小角度光学几何模型，该模型可从欧几里得几何的第一性原理导出：完整的对向角满足 $\\theta = 2 \\arctan\\!\\big(H/(2d)\\big)$，对于足够小的角度，在将 $\\theta$ 转换为弧度后，可以近似为 $\\theta \\approx H/d$。假设采用标准视标设计，其中字母总高度对向角为 $5$ 角分。\n\n从这些核心定义和几何关系出发，对给定的 Snellen 视力 $20/40$ 和观看距离 $d = 4\\,\\mathrm{m}$ 执行以下操作：\n\n1. 将 Snellen 视力 $20/40$ 转换为 logMAR，其中 $\\log_{10}$ 表示以 10 为底的对数。\n2. 以角分为单位，说明 MAR。\n3. 计算在 $d=4\\,\\mathrm{m}$ 处需要多大的物理字母高度 $H$（以毫米为单位），以使总对向角为 $5$ 角分（使用精确的几何关系 $\\theta = 2 \\arctan\\!\\big(H/(2d)\\big)$ 并将角度转换为弧度进行计算；在最终数值计算中不要使用小角度近似）。\n\n将 logMAR 和字母高度四舍五入至四位有效数字。将 MAR 表示为以角分为单位的实数，不进行四舍五入。按以下顺序报告你的最终答案，包含三个量：logMAR（无量纲）、MAR（以角分为单位）和字母高度（以毫米为单位）。",
            "solution": "Snellen 记法 $20/40$ 表示测试距离与视标行的“设计距离”之比。小数视力 $A_{\\mathrm{dec}}$ 定义为\n$$\nA_{\\mathrm{dec}} = \\frac{20}{40} = \\frac{1}{2} = 0.5.\n$$\n根据视觉心理物理学中的定义，最小分辨角（MAR）是最小可分辨特征的角尺寸（单位为角分），并且是小数视力的倒数：\n$$\n\\mathrm{MAR} = \\frac{1}{A_{\\mathrm{dec}}} = \\frac{1}{0.5} = 2 \\text{ arcminutes}.\n$$\n最小分辨角的对数（logMAR）定义为\n$$\n\\mathrm{logMAR} = \\log_{10}(\\mathrm{MAR}) = \\log_{10}(2).\n$$\n符号上，$\\log_{10}(2)$ 是精确值；为了报告一个四位有效数字的数值，计算\n$$\n\\log_{10}(2) \\approx 0.3010 \\quad \\text{(four significant figures)}.\n$$\n\n对于物理字母高度，使用高度 $H$、观看距离 $d$ 和完整对向角 $\\theta$ 之间的精确几何关系：\n$$\n\\theta = 2 \\arctan\\!\\left(\\frac{H}{2 d}\\right).\n$$\n我们已知标准字母总高度应对向 $\\theta = 5$ 角分。为了一致地使用三角函数，将 $\\theta$ 转换为弧度。1 度有 $60$ 角分，180 度有 $\\pi$ 弧度，因此\n$$\n\\theta_{\\mathrm{rad}} = 5 \\times \\frac{1}{60} \\times \\frac{\\pi}{180} = \\frac{5 \\pi}{10800} \\text{ radians}.\n$$\n求解 $H$ 的精确关系式可得\n$$\n\\theta = 2 \\arctan\\!\\left(\\frac{H}{2 d}\\right) \\;\\Rightarrow\\; \\arctan\\!\\left(\\frac{H}{2 d}\\right) = \\frac{\\theta}{2} \\;\\Rightarrow\\; \\frac{H}{2 d} = \\tan\\!\\left(\\frac{\\theta}{2}\\right) \\;\\Rightarrow\\; H = 2 d \\, \\tan\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n代入 $d = 4\\,\\mathrm{m}$ 和 $\\theta_{\\mathrm{rad}} = \\frac{5 \\pi}{10800}$：\n$$\nH = 2 \\times 4 \\times \\tan\\!\\left(\\frac{1}{2} \\cdot \\frac{5 \\pi}{10800}\\right) \\,\\mathrm{m} = 8 \\, \\tan\\!\\left(\\frac{5 \\pi}{21600}\\right) \\,\\mathrm{m}.\n$$\n要以毫米表示高度，需乘以 $1000$：\n$$\nH_{\\mathrm{mm}} = 1000 \\times 8 \\, \\tan\\!\\left(\\frac{5 \\pi}{21600}\\right) = 8000 \\, \\tan\\!\\left(\\frac{5 \\pi}{21600}\\right) \\;\\text{mm}.\n$$\n数值上，由于 $\\frac{5 \\pi}{21600}$ 是一个小角度，我们仍然使用精确的 $\\tan$ 进行计算，然后四舍五入：\n$$\n\\frac{5 \\pi}{21600} \\approx 7.27220521664304 \\times 10^{-4} \\text{ radians},\n$$\n所以\n$$\nH_{\\mathrm{mm}} = 8000 \\, \\tan\\!\\left(7.27220521664304 \\times 10^{-4}\\right) \\,\\text{mm}.\n$$\n计算 $\\tan$ 值并相乘：\n$$\nH_{\\mathrm{mm}} \\approx 5.81776 \\,\\text{mm}.\n$$\n四舍五入至四位有效数字：\n$$\nH_{\\mathrm{mm}} \\approx 5.818 \\,\\text{mm}.\n$$\n\n按要求顺序汇总结果：\n- logMAR（无量纲）：$\\log_{10}(2) \\approx 0.3010$（四位有效数字），\n- MAR：$2$ 角分（精确实数，不四舍五入），\n- 在 $d=4\\,\\mathrm{m}$ 处对向 $5$ 角分的字母高度：$5.818$ 毫米（四位有效数字）。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.3010  2  5.818\\end{pmatrix}}$$"
        },
        {
            "introduction": "视觉功能测试不仅限于中心视力，还包括对周边视觉敏感度的评估，即视野检查。本练习将探讨一个核心的心理物理学原理——空间总和，以及它如何影响视野检查中的刺激检测阈值。通过应用派珀定律（Piper's law），您将学习如何定量预测不同大小的刺激对检测阈值的影响，从而将理论知识与临床实践相结合。",
            "id": "4733089",
            "problem": "一个实验室正在进行静态自动视野检查，以比较在视网膜周边位置上，两种标准 Goldmann 视标大小的检测阈值。在稳定明视觉背景下，水平子午线离心率为 $30^\\circ$ 时，已知 Goldmann III 号和 Goldmann V 号视标都位于完全空间总和范围之外。实验者希望估计，在此离心率下，假设空间部分总和成立，当从 Goldmann III 号视标切换到 Goldmann V 号视标时，差异亮度阈值（检测所需的背景之上的亮度增量）会发生多大变化。\n\n使用以下经过充分验证的事实作为基础：\n- 对于空间总和，差异亮度阈值 $T$ 取决于视标面积 $A$。在完全空间总和（Ricco 定律）下，$T \\propto A^{-1}$。超出临界面积（部分总和）后，周边位置的经验数据能很好地被幂律 $T \\propto A^{-\\beta}$（其中 $0\\beta1$）拟合（Piper 型行为）。在明视觉背景下，离心率为 $30^\\circ$ 时，一个广泛观察到的斜率为 $\\beta = \\tfrac{1}{2}$。\n- Goldmann III 号和 Goldmann V 号视标的标准角直径分别为 $0.43^\\circ$ 和 $1.72^\\circ$。\n- 对于圆形视标，面积与角直径的平方成正比。\n- 以分贝 (dB) 表示的阈值变化定义为 $10 \\log_{10}\\!\\left(\\dfrac{T_{2}}{T_{1}}\\right)$，其中 $T_{1}$ 和 $T_{2}$ 是被比较的阈值。\n\n从这些基础出发，推导并计算在部分总和条件下，当离心率 $30^\\circ$ 时从 Goldmann III 号视标转为 Goldmann V 号视标时，差异亮度阈值的预期带符号变化（以分贝为单位）。负值表示使用较大视标进行检测所需的亮度增量较低。将最终答案四舍五入至四位有效数字，并以 dB（分贝）表示。",
            "solution": "设 $T_{III}$ 和 $T_V$ 分别为 Goldmann III 号和 Goldmann V 号视标的差异亮度阈值。设它们对应的面积为 $A_{III}$ 和 $A_V$，直径为 $d_{III}$ 和 $d_V$。\n\n问题陈述，在部分总和条件下，阈值 $T$ 相对于视标面积 $A$ 遵循幂律关系：\n$$T \\propto A^{-\\beta}$$\n这可以写成方程 $T = k A^{-\\beta}$，其中 $k$ 是比例常数。\n\n因此，两种视标的阈值之比为：\n$$\\frac{T_V}{T_{III}} = \\frac{k A_V^{-\\beta}}{k A_{III}^{-\\beta}} = \\left(\\frac{A_V}{A_{III}}\\right)^{-\\beta}$$\n\n视标是圆形的，所以它们的面积 $A$ 与其直径 $d$ 的平方成正比：\n$$A \\propto d^2$$\n这意味着面积之比可以用直径之比来表示：\n$$\\frac{A_V}{A_{III}} = \\frac{c d_V^2}{c d_{III}^2} = \\left(\\frac{d_V}{d_{III}}\\right)^2$$\n其中 $c$ 是一个几何常数（对于圆形面积，具体为 $c=\\frac{\\pi}{4}$，但其值无关紧要，因为它会被约掉）。\n\n将此面积比代回阈值比方程可得：\n$$\\frac{T_V}{T_{III}} = \\left(\\left(\\frac{d_V}{d_{III}}\\right)^2\\right)^{-\\beta} = \\left(\\frac{d_V}{d_{III}}\\right)^{-2\\beta}$$\n\n问题指定，在给定的视网膜位置和背景下，指数为 $\\beta = \\frac{1}{2}$。代入此值：\n$$\\frac{T_V}{T_{III}} = \\left(\\frac{d_V}{d_{III}}\\right)^{-2\\left(\\frac{1}{2}\\right)} = \\left(\\frac{d_V}{d_{III}}\\right)^{-1} = \\frac{d_{III}}{d_V}$$\n\n给定的直径为 $d_{III} = 0.43^\\circ$ 和 $d_V = 1.72^\\circ$。我们现在可以计算直径之比。\n$$\\frac{d_V}{d_{III}} = \\frac{1.72}{0.43} = 4$$\n这意味着阈值比为：\n$$\\frac{T_V}{T_{III}} = \\frac{1}{4} = 0.25$$\n\n当从 III 号（视标 1）移动到 V 号（视标 2）时，阈值的变化量（以分贝为单位）$\\Delta_{\\text{dB}}$ 定义为：\n$$\\Delta_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{T_V}{T_{III}}\\right)$$\n代入阈值比的值：\n$$\\Delta_{\\text{dB}} = 10 \\log_{10}(0.25)$$\n\n计算数值：\n$$\\Delta_{\\text{dB}} = 10 \\log_{10}\\left(\\frac{1}{4}\\right) = 10 \\log_{10}(4^{-1}) = -10 \\log_{10}(4)$$\n使用对数性质 $\\log(x^y) = y \\log(x)$：\n$$\\Delta_{\\text{dB}} = -10 \\log_{10}(2^2) = -20 \\log_{10}(2)$$\n\n使用高精度的 $\\log_{10}(2) \\approx 0.30102999566$ 值：\n$$\\Delta_{\\text{dB}} \\approx -20 \\times 0.30102999566 = -6.0205999132$$\n问题要求答案四舍五入到四位有效数字。该值为 $-6.02059...$。第四位有效数字是 $0$，其后的数字是 $5$，需要向上取整。因此，该值四舍五入为 $-6.021$。\n\n负号表示 Goldmann V 号视标的阈值低于 III 号视标的阈值，这与较大视标更容易被检测到的原理一致。",
            "answer": "$$\n\\boxed{-6.021}\n$$"
        },
        {
            "introduction": "对比敏感度函数（Contrast Sensitivity Function, CSF）提供了对空间视觉能力的全面描述，是评价视觉系统功能的重要工具。本高阶练习将带您进入现代视觉科学的核心任务之一：将参数模型与实验数据进行拟合。通过亲手实现一个最小二乘法拟合程序，您将获得数据分析、参数估计和理解心理物理学建模数学基础的宝贵实践经验。",
            "id": "4733125",
            "problem": "给定一个用于眼科视觉功能测试的标准模型——人类对比敏感度函数 (CSF) 的参数模型。该模型将敏感度描述为空间频率的函数，定义如下：对于空间频率 $f$（单位：周/度），敏感度 $S(f)$ 为\n$$\nS(f) = S_0 \\exp\\!\\left(-\\alpha \\ln^2\\!\\left(\\frac{f}{f_0}\\right)\\right),\n$$\n其中 $S_0$ 是峰值敏感度（无单位），$f_0$ 是峰值频率（单位：周/度），$\\alpha$ 是一个已知的正常数曲率参数。所有对数均为自然对数。\n\n您的任务是设计并实现一个程序，对每个数据集，通过基于第一性原理的原则性拟合来估计峰值敏感度 $S_0$ 和峰值频率 $f_0$。假设敏感度的测量噪声是乘性的（等价于在对数敏感度上是加性的），在不同频率间是独立的，并且在对数域中近似呈高斯分布。在此假设下，通过最小化观测对数敏感度与模型预测对数敏感度之间的残差平方和来估计 $(S_0, f_0)$。将估计值约束在 $S_0  0$ 和 $f_0  0$ 的范围内。仅使用给定的数据和基本原理；您不得假设或使用任何未从这些原理推导出的、预先存在的封闭形式“捷径”。\n\n重要要求：\n- 全程使用自然对数。\n- 以周/度 (cpd) 为单位报告 $f_0$。\n- 将 $S_0$ 报告为无单位量。\n- 在最终输出中，将 $S_0$ 四舍五入到两位小数，将 $f_0$ 四舍五入到三位小数。\n\n测试套件（每个测试用例提供 $\\alpha$、空间频率 $f_i$（单位：周/度）和观测到的敏感度 $S_i$）：\n- 测试用例 1（无噪声，峰值周围对称采样）：\n  - $\\alpha = 0.4$\n  - $f = [0.5, 1, 2, 4, 8, 16]$ (单位：cpd)\n  - $S = [44.33, 115.89, 206.35, 250.00, 206.35, 115.89]$\n- 测试用例 2（有噪声，峰值周围及尾部密集采样）：\n  - $\\alpha = 0.5$\n  - $f = [0.5, 1, 2, 3, 3.5, 5, 7, 10, 16]$ (单位：cpd)\n  - $S = [34.77, 95.41, 191.91, 210.88, 220.00, 214.71, 166.13, 114.18, 58.87]$\n- 测试用例 3（稀疏采样，中等曲率）：\n  - $\\alpha = 0.6$\n  - $f = [0.75, 2, 6]$ (单位：cpd)\n  - $S = [84.23, 147.00, 74.15]$\n- 测试用例 4（较平坦的CSF，较宽的峰值，伴有中等噪声）：\n  - $\\alpha = 0.15$\n  - $f = [2, 4, 8, 10, 12, 16, 24]$ (单位：cpd)\n  - $S = [131.59, 181.63, 202.48, 200.00, 195.03, 185.75, 165.78]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身是一个二元列表 $[S_0^{\\text{hat}}, f_0^{\\text{hat}}]$，按顺序对应相应的测试用例。\n- 所需格式为：\n  - $[[S_{0,1}^{\\text{hat}}, f_{0,1}^{\\text{hat}}],[S_{0,2}^{\\text{hat}}, f_{0,2}^{\\text{hat}}],[S_{0,3}^{\\text{hat}}, f_{0,3}^{\\text{hat}}],[S_{0,4}^{\\text{hat}}, f_{0,4}^{\\text{hat}}]]$\n- 将 $S_0^{\\text{hat}}$ 四舍五入到两位小数，将 $f_0^{\\text{hat}}$ 四舍五入到三位小数，并以周/度 (cpd) 为单位报告 $f_0^{\\text{hat}}$。",
            "solution": "此问题经评估是有效的，因为它在眼科学领域有科学依据，作为参数估计任务其提法是适定的，并且明确了所有必要的数据和目标约束。\n\n目标是根据一组测量值 $(f_i, S_i)$ 和一个已知的曲率参数 $\\alpha$，为对比敏感度函数 (CSF) 模型估计峰值敏感度 $S_0$ 和峰值频率 $f_0$：\n$$\nS(f) = S_0 \\exp\\!\\left(-\\alpha \\ln^2\\!\\left(\\frac{f}{f_0}\\right)\\right)\n$$\n估计必须基于在对数敏感度域中最小化残差平方和的原理。\n\n### 基于第一性原理的推导\n\n核心原理是对模型的一个变换形式应用最小二乘估计。假设噪声在敏感度 $S$ 上是乘性的，这等价于在对数敏感度 $\\ln(S)$ 上是加性且呈高斯分布。这意味着需要最小化的恰当目标函数是对数域中的误差平方和。\n\n1.  **模型的对数变换：**\n    我们首先对模型方程取自然对数以使其结构线性化。令 $y = \\ln(S)$ 和 $x = \\ln(f)$。\n    $$\n    \\ln(S(f)) = \\ln\\left(S_0 \\exp\\left(-\\alpha \\ln^2\\left(\\frac{f}{f_0}\\right)\\right)\\right)\n    $$\n    使用对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(e^c) = c$：\n    $$\n    \\ln(S(f)) = \\ln(S_0) - \\alpha \\ln^2\\left(\\frac{f}{f_0}\\right)\n    $$\n    使用 $\\ln(a/b) = \\ln(a) - \\ln(b)$ 进一步展开平方项：\n    $$\n    \\ln(S) = \\ln(S_0) - \\alpha (\\ln(f) - \\ln(f_0))^2\n    $$\n    这个方程在敏感度对频率的对数-对数图上描述了一个抛物线。\n\n2.  **通过变量替换进行线性化：**\n    为了简化估计，我们可以将方程重新排列成适合线性回归的形式。令 $y_0 = \\ln(S_0)$ 和 $x_0 = \\ln(f_0)$ 为待估计的变换后参数。对于单个数据点 $(x_i, y_i)$，其中 $x_i = \\ln(f_i)$ 和 $y_i=\\ln(S_i)$，模型为：\n    $$\n    y_i \\approx y_0 - \\alpha(x_i - x_0)^2\n    $$\n    展开二次项：\n    $$\n    y_i \\approx y_0 - \\alpha(x_i^2 - 2x_i x_0 + x_0^2)\n    $$\n    重新整理各项以组合未知数：\n    $$\n    y_i + \\alpha x_i^2 \\approx (y_0 - \\alpha x_0^2) + (2\\alpha x_0) x_i\n    $$\n    该方程现在是线性模型的形式。我们定义一个新的因变量 $z_i = y_i + \\alpha x_i^2$ 和新的系数 $c_0 = y_0 - \\alpha x_0^2$ 及 $c_1 = 2\\alpha x_0$。模型变成一个简单的线性回归：\n    $$\n    z_i \\approx c_0 + c_1 x_i\n    $$\n\n3.  **最小二乘最小化：**\n    我们需要找到估计值 $\\hat{c_0}$ 和 $\\hat{c_1}$ 以最小化残差平方和 $Q$：\n    $$\n    Q(c_0, c_1) = \\sum_{i=1}^n (z_i - (c_0 + c_1 x_i))^2\n    $$\n    为了找到最小值，我们将 $Q$ 对 $c_0$ 和 $c_1$ 的偏导数设为零。\n    $$\n    \\frac{\\partial Q}{\\partial c_0} = \\sum_{i=1}^n 2(z_i - c_0 - c_1 x_i)(-1) = 0 \\implies \\sum_{i=1}^n (z_i - c_0 - c_1 x_i) = 0\n    $$\n    $$\n    \\frac{\\partial Q}{\\partial c_1} = \\sum_{i=1}^n 2(z_i - c_0 - c_1 x_i)(-x_i) = 0 \\implies \\sum_{i=1}^n (z_i x_i - c_0 x_i - c_1 x_i^2) = 0\n    $$\n    这得到简单线性回归的正规方程组：\n    $$\n    \\begin{align*}\n    n c_0 + \\left(\\sum x_i\\right) c_1 = \\sum z_i \\\\\n    \\left(\\sum x_i\\right) c_0 + \\left(\\sum x_i^2\\right) c_1 = \\sum x_i z_i\n    \\end{align*}\n    $$\n    这是一个关于 $(c_0, c_1)$ 的 $2 \\times 2$ 线性方程组。求解该系统可得最小二乘估计值 $\\hat{c_0}$ 和 $\\hat{c_1}$：\n    $$\n    \\hat{c_1} = \\frac{n(\\sum x_i z_i) - (\\sum x_i)(\\sum z_i)}{n(\\sum x_i^2) - (\\sum x_i)^2}\n    $$\n    $$\n    \\hat{c_0} = \\bar{z} - \\hat{c_1} \\bar{x}\n    $$\n    其中 $\\bar{x} = \\frac{1}{n}\\sum x_i$ 和 $\\bar{z} = \\frac{1}{n}\\sum z_i$。\n\n4.  **反变换回原始参数：**\n    一旦计算出 $\\hat{c_0}$ 和 $\\hat{c_1}$，我们就可以恢复原始对数域参数 $\\hat{x_0}$ 和 $\\hat{y_0}$ 的估计值。\n    由 $c_1 = 2\\alpha x_0$ 可得：\n    $$\n    \\hat{x_0} = \\frac{\\hat{c_1}}{2\\alpha}\n    $$\n    由 $c_0 = y_0 - \\alpha x_0^2$ 可得：\n    $$\n    \\hat{y_0} = \\hat{c_0} + \\alpha \\hat{x_0}^2\n    $$\n\n5.  **最终参数估计：**\n    最后，我们通过应用指数函数获得 $S_0$ 和 $f_0$ 的估计值：\n    $$\n    \\hat{f_0} = \\exp(\\hat{x_0})\n    $$\n    $$\n    \\hat{S_0} = \\exp(\\hat{y_0})\n    $$\n    由于指数函数的取值范围是所有正实数，约束条件 $S_0  0$ 和 $f_0  0$ 在此过程中自动得到满足。\n\n这个分步过程提供了从最小二乘最小化第一性原理推导出的 $S_0$ 和 $f_0$ 的估计值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_csf_params(alpha, f_data, s_data):\n    \"\"\"\n    Estimates the parameters S0 and f0 of the CSF model using linear least squares\n    on a transformed version of the model.\n\n    Args:\n        alpha (float): The known curvature parameter.\n        f_data (np.ndarray): Array of spatial frequencies in cycles per degree.\n        s_data (np.ndarray): Array of observed sensitivities.\n\n    Returns:\n        tuple[float, float]: A tuple containing the estimated (S0_hat, f0_hat).\n    \"\"\"\n    # Step 1: Log-transform the data.\n    # The model is S(f) = S0 * exp(-alpha * ln(f/f0)^2).\n    # In the log-log domain, this is ln(S) = ln(S0) - alpha * (ln(f) - ln(f0))^2.\n    # Let x = ln(f) and y = ln(S). The model becomes y = y0 - alpha * (x - x0)^2.\n    x = np.log(f_data)\n    y = np.log(s_data)\n    n = len(f_data)\n\n    # Step 2: Linearize the model.\n    # y = y0 - alpha * (x^2 - 2*x*x0 + x0^2)\n    # y + alpha*x^2 = (y0 - alpha*x0^2) + (2*alpha*x0)*x\n    # This is a linear model z = c0 + c1*x, where:\n    # z = y + alpha*x^2\n    # c1 = 2*alpha*x0\n    # c0 = y0 - alpha*x0^2\n    z = y + alpha * x**2\n\n    # Step 3: Perform linear regression of z on x to find c0 and c1.\n    # We solve the normal equations for simple linear regression.\n    sum_x = np.sum(x)\n    sum_z = np.sum(z)\n    sum_x_sq = np.sum(x**2)\n    sum_xz = np.sum(x * z)\n\n    # Denominator of the ordinary least squares (OLS) estimators\n    denom = n * sum_x_sq - sum_x**2\n\n    # Estimate c1 and c0\n    c1_hat = (n * sum_xz - sum_x * sum_z) / denom\n    c0_hat = np.mean(z) - c1_hat * np.mean(x)\n\n    # Step 4: Back-transform to get estimates for x0 and y0 (log-domain parameters).\n    # x0 = ln(f0), y0 = ln(S0)\n    x0_hat = c1_hat / (2 * alpha)\n    y0_hat = c0_hat + alpha * x0_hat**2\n\n    # Step 5: Transform back to the original parameter space (S0, f0).\n    s0_hat = np.exp(y0_hat)\n    f0_hat = np.exp(x0_hat)\n\n    return s0_hat, f0_hat\n\ndef solve():\n    \"\"\"\n    Main function to run the estimation on all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.4, np.array([0.5, 1, 2, 4, 8, 16]), np.array([44.33, 115.89, 206.35, 250.00, 206.35, 115.89])),\n        (0.5, np.array([0.5, 1, 2, 3, 3.5, 5, 7, 10, 16]), np.array([34.77, 95.41, 191.91, 210.88, 220.00, 214.71, 166.13, 114.18, 58.87])),\n        (0.6, np.array([0.75, 2, 6]), np.array([84.23, 147.00, 74.15])),\n        (0.15, np.array([2, 4, 8, 10, 12, 16, 24]), np.array([131.59, 181.63, 202.48, 200.00, 195.03, 185.75, 165.78]))\n    ]\n    \n    formatted_results = []\n    for alpha, f_data, s_data in test_cases:\n        # Calculate the estimates for the current test case\n        s0_hat, f0_hat = solve_csf_params(alpha, f_data, s_data)\n        \n        # Round the estimates to the specified decimal places\n        s0_rounded = round(s0_hat, 2)\n        f0_rounded = round(f0_hat, 3)\n        \n        # Format the result for this case as a string '[S0,f0]' ensuring trailing zeros\n        result_str = f\"[{s0_rounded:.2f},{f0_rounded:.3f}]\"\n        formatted_results.append(result_str)\n\n    # Final print statement in the exact required format: [[S_hat1, f_hat1],[S_hat2, f_hat2],...]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}