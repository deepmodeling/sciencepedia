{
    "hands_on_practices": [
        {
            "introduction": "在临床诊断中，使用液体抗凝剂会不可避免地稀释原始血液样本，这是分析前误差的一个重要来源。本练习将指导您基于质量守恒的基本原理，推导出适用于任何液体添加剂的稀释校正因子，这是确保定量检测准确性的第一步 。通过这个计算，您将掌握如何从源头上纠正因样本处理引入的系统性偏差。",
            "id": "5091846",
            "problem": "一个进行血浆中可溶性生物标志物分子免疫诊断定量的临床实验室，选择将全血采集到含有柠檬酸钠溶液作为抗凝剂的试管中。该抗凝剂配方为 $3.2\\%$（质量/体积）的柠檬酸钠溶液，试管中预装了 $0.5$ 毫升该溶液。将 $4.5$ 毫升全血通过静脉穿刺抽入试管中，在制备血浆前将样本充分混合。\n\n假设抗凝剂溶液中不含分析物，柠檬酸钠不与分析物发生化学反应（消耗或生成），混合时体积是可加的，并且测量浓度 $C_{\\text{meas}}$ 是由分析物均匀分布在混合后总液相中产生的。使用浓度定义 $C = n/V$（其中 $n$ 是分析物的量，$V$ 是相关液体体积）以及分析物量守恒，从第一性原理推导出一个通用表达式，该表达式将加入抗凝剂前血液中未稀释的分析物浓度 $C_{\\text{true}}$ 与混合后测得的分析物浓度 $C_{\\text{meas}}$ 联系起来，用血液体积 $V_{\\text{blood}}$ 和抗凝剂体积 $V_{\\text{add}}$ 表示。\n\n然后，计算当 $V_{\\text{blood}} = 4.5$ 毫升和 $V_{\\text{add}} = 0.5$ 毫升时，将 $C_{\\text{meas}}$ 转换为 $C_{\\text{true}}$ 的乘法校正因子。将此校正因子的最终答案表示为一个无单位的精确有理数。如果在中间推理中需要任何四舍五入，请以符号形式进行所有量的计算，并按要求精确呈现最终答案。\n\n注意：在进行免疫分析测量之前，红细胞（RBC）已被分离；然而，为了本推导的目的，请如上所述，将测量浓度视为在混合后总液体体积中定义的。根据与分子和免疫诊断实践相关的质量守恒和浓度定义，简要论证您在推导中使用的物理假设。",
            "solution": "该问题要求推导一个校正因子，以解释全血样本被抗凝剂溶液稀释的情况。我们首先根据所提供的信息和基本的守恒原理来形式化该系统。\n\n设 $C_{\\text{true}}$ 为原始未稀释血液样本中分析物的真实浓度。设 $V_{\\text{blood}}$ 为该血液样本的体积。根据浓度定义，原始样本中分析物的总量，记为 $n_{\\text{analyte}}$，由下式给出：\n$$n_{\\text{analyte}} = C_{\\text{true}} \\cdot V_{\\text{blood}}$$\n\n然后将血液与体积为 $V_{\\text{add}}$ 的抗凝剂溶液混合。问题陈述了几个构成我们模型基础的关键假设：\n1. 抗凝剂溶液本身不含分析物。\n2. 混合过程不产生或破坏分析物。\n3. 体积是可加的。\n\n根据前两个假设，分析物量守恒原理要求混合后分析物的总量 $n_{\\text{analyte}}$ 保持不变。根据第三个假设，最终混合物的总体积 $V_{\\text{total}}$ 是各个体积之和：\n$$V_{\\text{total}} = V_{\\text{blood}} + V_{\\text{add}}$$\n\n测得的浓度 $C_{\\text{meas}}$ 定义为均匀分布在整个总体积中的分析物浓度。因此，$C_{\\text{meas}}$ 可以表示为：\n$$C_{\\text{meas}} = \\frac{n_{\\text{analyte}}}{V_{\\text{total}}}$$\n\n将 $n_{\\text{analyte}}$ 和 $V_{\\text{total}}$ 的表达式代入此方程，我们得到：\n$$C_{\\text{meas}} = \\frac{C_{\\text{true}} \\cdot V_{\\text{blood}}}{V_{\\text{blood}} + V_{\\text{add}}}$$\n\n这个方程将测量浓度与真实浓度联系起来。为了找到用 $C_{\\text{meas}}$ 表示 $C_{\\text{true}}$ 的通用表达式，我们重新整理该方程：\n$$C_{\\text{true}} = C_{\\text{meas}} \\cdot \\frac{V_{\\text{blood}} + V_{\\text{add}}}{V_{\\text{blood}}}$$\n\n乘法校正因子，我们可以表示为 $K$，是 $C_{\\text{meas}}$ 必须乘以才能得到 $C_{\\text{true}}$ 的量。从推导出的关系来看，该因子为：\n$$K = \\frac{V_{\\text{blood}} + V_{\\text{add}}}{V_{\\text{blood}}}$$\n这也可以写成 $K = 1 + \\frac{V_{\\text{add}}}{V_{\\text{blood}}}$。\n\n本推导中使用的物理假设的理由如下：\n- **分析物守恒**：这是定量分析中的一个基本假设。为了使生物标志物的测量有效，分析前步骤（如添加抗凝剂）不得改变被测物质的量。如果抗凝剂与分析物结合、降解分析物或被分析物污染，将会引入系统误差（干扰），从而使测量无效。因此，假设守恒等同于假设一个没有此类干扰的理想采集过程。\n- **体积可加性**：假设 $V_{\\text{total}} = V_{\\text{blood}} + V_{\\text{add}}$ 简化了计算。对于混合两种水溶液，如血浆和稀柠檬酸钠溶液，由于分子间作用力变化引起的体积非可加性偏差，与其他分析变异来源相比通常可以忽略不计。在临床化学中，这是一个用于计算稀释因子的标准且合理的近似。\n- **分析物分布**：问题指明测量浓度是在混合后的总液体体积中定义的。这是一个教学上的简化。在实践中，分析物通常局限于血浆部分。更精确的校正会考虑细胞成分所占的体积（血细胞比容）。然而，通过按给定的方式定义问题参数，我们被指示使用这个简化模型，它仍然正确地捕捉了稀释的基本原理。关于抗凝剂浓度（$3.2\\%$）的信息是背景信息，对于稀释计算本身不是必需的。\n\n现在，我们使用问题陈述中提供的具体体积来计算校正因子 $K$ 的数值：\n- 血液体积，$V_{\\text{blood}} = 4.5$ 毫升。\n- 抗凝剂添加物体积，$V_{\\text{add}} = 0.5$ 毫升。\n\n将这些值代入 $K$ 的表达式中：\n$$K = \\frac{4.5 + 0.5}{4.5} = \\frac{5.0}{4.5}$$\n\n为了将其表示为精确的有理数，我们可以将分子和分母同乘以 $10$ 来消除小数：\n$$K = \\frac{50}{45}$$\n\n最后，我们将分子和分母同除以它们的最大公约数 $5$ 来简化分数：\n$$K = \\frac{50 \\div 5}{45 \\div 5} = \\frac{10}{9}$$\n\n这就是所要求的乘法校正因子。为了获得真实的分析物浓度，测量浓度必须乘以 $\\frac{10}{9}$。",
            "answer": "$$\\boxed{\\frac{10}{9}}$$"
        },
        {
            "introduction": "抗凝剂的影响远不止物理稀释，其化学性质同样至关重要，尤其是在分子诊断领域。像EDTA这样的螯合剂会直接与PCR等反应体系中对酶活性至关重要的镁离子（$Mg^{2+}$）结合，从而抑制反应。此项练习  提出了一个更贴近实际的场景，您需要同时考虑来自抗凝剂（EDTA）和反应物（dNTPs）的竞争性螯合效应，并运用化学计量学原理来精确计算需要补充的镁离子总量，以确保分析的有效性。",
            "id": "5091903",
            "problem": "一项基于脱氧核糖核酸 (DNA) 聚合反应的临床分子检测需要镁离子来支持聚合酶的活性。在一项评估抗凝剂选择及其分析影响的实验室自建检测中，一个抽入含乙二胺四乙酸钾 (EDTA) 真空采血管的血浆样本被直接用于聚合酶链式反应的体系中。最终反应体积为 $25\\,\\mu\\mathrm{L}$，其中 $5\\,\\mu\\mathrm{L}$ 为血浆。血浆中的 EDTA 钾浓度为 $5.0\\,\\mathrm{mM}$，在反应的 pH 值下，EDTA 以 $1{:}1$ 的化学计量比螯合镁离子。该反应还包含脱氧核苷三磷酸 (dNTPs)，四种核苷酸（腺嘌呤、胞嘧啶、鸟嘌呤、胸腺嘧啶）的浓度均为 $0.20\\,\\mathrm{mM}$，并且在反应条件下，每种 dNTP 都以有效的 $1{:}1$ 化学计量比螯合镁离子。假设活度系数为 1，并且 EDTA 和 dNTPs 的螯合作用相对于目标游离镁离子浓度而言是有效定量的。\n\n最终反应混合物中的目标游离镁离子浓度为 $1.50\\,\\mathrm{mM}$。预混液中不含其他镁离子来源。一摩尔氯化镁 (MgCl$_2$) 向溶液中提供一摩尔镁离子，氯离子是旁观离子。\n\n使用镁的质量守恒定律和给定的化学计量比，计算在同时存在 EDTA 和 dNTPs 的情况下，为了达到目标游离镁离子浓度，最终反应混合物中必须存在的总氯化镁浓度。请以最终反应混合物中的毫摩尔/升 ($\\mathrm{mM}$) 为单位表示您的答案，并将答案四舍五入到三位有效数字。",
            "solution": "本题的任务是计算在聚合酶链式反应混合物中，为达到指定游离镁离子浓度 $[Mg^{2+}]_{free}$ 所需的总氯化镁浓度 $[MgCl_2]_{total}$。这个计算必须考虑到反应中其他组分，即乙二胺四乙酸 (EDTA) 和脱氧核苷三磷酸 (dNTPs)，所螯合（结合）的镁离子。\n\n解决这个问题的基本原理是镁离子的质量守恒。最终反应混合物中镁离子的总浓度 $[Mg^{2+}]_{total}$ 是游离（未结合）镁离子浓度 $[Mg^{2+}]_{free}$ 和结合态镁离子浓度 $[Mg^{2+}]_{bound}$ 的总和。\n$$[Mg^{2+}]_{total} = [Mg^{2+}]_{free} + [Mg^{2+}]_{bound}$$\n题目说明最终混合物中游离镁离子的目标浓度为 $1.50\\,\\mathrm{mM}$。\n$$[Mg^{2+}]_{free} = 1.50\\,\\mathrm{mM}$$\n结合态镁离子被两种不同的物质螯合：EDTA 和 dNTPs。因此，结合态镁的总浓度是与这两种螯合剂结合的镁浓度的总和。\n$$[Mg^{2+}]_{bound} = [Mg^{2+}]_{\\text{bound to EDTA}} + [Mg^{2+}]_{\\text{bound to dNTPs}}$$\n我们必须在最终反应体积的背景下，计算每种螯合剂所结合的镁的浓度。\n\n首先，我们计算由 EDTA 结合的镁的浓度。EDTA 是从血浆样本中引入反应的。血浆样本的体积为 $V_{plasma} = 5\\,\\mu\\mathrm{L}$，其 EDTA 浓度为 $[EDTA]_{plasma} = 5.0\\,\\mathrm{mM}$。该样本被加入到最终反应体积 $V_{final} = 25\\,\\mu\\mathrm{L}$ 中。因此，EDTA 的浓度被稀释了。反应中 EDTA 的最终浓度 $[EDTA]_{final}$ 由稀释方程 $C_1V_1 = C_2V_2$ 给出：\n$$[EDTA]_{final} = [EDTA]_{plasma} \\times \\frac{V_{plasma}}{V_{final}}$$\n代入给定值：\n$$[EDTA]_{final} = 5.0\\,\\mathrm{mM} \\times \\frac{5\\,\\mu\\mathrm{L}}{25\\,\\mu\\mathrm{L}} = 5.0\\,\\mathrm{mM} \\times 0.2 = 1.0\\,\\mathrm{mM}$$\n题目说明 EDTA 以 $1{:}1$ 的化学计量比螯合镁离子，并且这种螯合是“有效定量的”。这意味着每存在一摩尔的 EDTA，就会结合一摩尔的镁离子。因此，由 EDTA 结合的镁离子浓度等于 EDTA 的最终浓度。\n$$[Mg^{2+}]_{\\text{bound to EDTA}} = [EDTA]_{final} = 1.0\\,\\mathrm{mM}$$\n\n接下来，我们计算由 dNTPs 结合的镁的浓度。最终反应混合物包含四种不同的 dNTPs，每种浓度均为 $0.20\\,\\mathrm{mM}$。所有 dNTPs 的总浓度 $[dNTPs]_{total}$ 为：\n$$[dNTPs]_{total} = 4 \\times 0.20\\,\\mathrm{mM} = 0.80\\,\\mathrm{mM}$$\n题目还说明每种 dNTP 也以有效的 $1{:}1$ 化学计量比螯合镁离子，并且这种结合也是定量的。因此，由 dNTPs 结合的镁离子总浓度等于 dNTPs 的总浓度。\n$$[Mg^{2+}]_{\\text{bound to dNTPs}} = [dNTPs]_{total} = 0.80\\,\\mathrm{mM}$$\n\n现在，我们可以通过将 EDTA 和 dNTPs 的贡献相加来计算结合态镁离子的总浓度：\n$$[Mg^{2+}]_{bound} = [Mg^{2+}]_{\\text{bound to EDTA}} + [Mg^{2+}]_{\\text{bound to dNTPs}} = 1.0\\,\\mathrm{mM} + 0.80\\,\\mathrm{mM} = 1.80\\,\\mathrm{mM}$$\n\n最后，我们可以通过将目标游离浓度和总结合浓度相加来计算反应中所需的镁离子总浓度：\n$$[Mg^{2+}]_{total} = [Mg^{2+}]_{free} + [Mg^{2+}]_{bound} = 1.50\\,\\mathrm{mM} + 1.80\\,\\mathrm{mM} = 3.30\\,\\mathrm{mM}$$\n题目说明镁是以氯化镁 ($MgCl_2$) 的形式提供的，并且一摩尔的 $MgCl_2$ 提供一摩尔的 $Mg^{2+}$ 离子。因此，最终混合物中所需的 $MgCl_2$ 总浓度等于所需的 $Mg^{2+}$ 离子总浓度。\n$$[MgCl_2]_{total} = [Mg^{2+}]_{total} = 3.30\\,\\mathrm{mM}$$\n题目要求答案保留三位有效数字。计算值 $3.30$ 已经是三位有效数字。",
            "answer": "$$\\boxed{3.30}$$"
        },
        {
            "introduction": "尽管化学计量模型在许多应用中非常有用，但它本质上是一个简化的近似。为了更精确地描述和预测抗凝剂的化学影响，我们需要一个基于热力学平衡的更复杂的模型。这项高级实践  将引导您从质量作用定律和质量守恒定律出发，推导出一个描述竞争性结合平衡的数学方程，并利用数值方法求解，从而能够精确预测在复杂化学环境中游离镁离子的浓度。",
            "id": "5091829",
            "problem": "您的任务是为聚合酶链式反应 (PCR) 预混液中的镁离子螯合构建并实现一个热力学平衡模型。该预混液包含乙二胺四乙酸 (EDTA) 和脱氧核糖核苷三磷酸 (dNTPs)。EDTA 和 dNTPs 均可与二价镁离子结合，从而降低聚合酶活性所需的游离镁离子浓度。这与样本采集中的抗凝剂选择直接相关，因为 EDTA 是一种常见的抗凝剂，其在分子检测中的残留会通过降低游离镁离子浓度来影响分析性能。\n\n从以下基本原理开始：\n- 质量作用定律：对于配体和金属之间化学计量比为 $1{:}1$ 的可逆结合反应，在恒定的温度、压力和离子强度下，平衡缔合常数 $K$ 满足 $K = \\dfrac{[\\text{Complex}]}{[\\text{Metal}][\\text{Ligand}]}$。\n- 封闭化学系统中的质量守恒定律：该定律要求每种化学物质的总分析浓度等于其游离形式和络合形式的浓度之和。\n\n为具有两种竞争性 $1{:}1$ 配体的单一金属定义以下物种和参数：\n- $[\\mathrm{M}]$ 是镁离子（$\\mathrm{Mg^{2+}}$）的游离浓度。\n- $[\\mathrm{E}]$ 是 EDTA 的游离浓度。\n- $[\\mathrm{D}]$ 是 dNTP 的游离浓度（被视为代表所有 dNTP 物种总和的单一有效配体）。\n- $[\\mathrm{ME}]$ 是镁-EDTA 络合物的浓度。\n- $[\\mathrm{MD}]$ 是镁-dNTP 络合物的浓度。\n- $K_E$ 是在工作条件（温度、pH、离子强度）下，$\\mathrm{Mg^{2+}}$ 与 EDTA 结合的条件平衡缔合常数，单位为 $\\mathrm{L \\cdot mol^{-1}}$。\n- $K_D$ 是在工作条件下，$\\mathrm{Mg^{2+}}$ 与 dNTP 结合的条件平衡缔合常数，单位为 $\\mathrm{L \\cdot mol^{-1}}$。\n- $M_T$ 是镁的总分析浓度，单位为 $\\mathrm{mol \\cdot L^{-1}}$。\n- $E_T$ 是 EDTA 的总分析浓度，单位为 $\\mathrm{mol \\cdot L^{-1}}$。\n- $D_T$ 是 dNTP 的总分析浓度，单位为 $\\mathrm{mol \\cdot L^{-1}}$。\n\n引入 $1{:}1$ 络合物的质量作用关系和质量平衡关系：\n- $[\\mathrm{ME}] = K_E \\,[\\mathrm{M}]\\,[\\mathrm{E}]$ 和 $[\\mathrm{MD}] = K_D \\,[\\mathrm{M}]\\,[\\mathrm{D}]$。\n- $M_T = [\\mathrm{M}] + [\\mathrm{ME}] + [\\mathrm{MD}]$。\n- $E_T = [\\mathrm{E}] + [\\mathrm{ME}]$。\n- $D_T = [\\mathrm{D}] + [\\mathrm{MD}]$。\n\n您的目标是基于这些基本原理，推导出一个方程，其物理上允许的解能够给出作为 $M_T$、$E_T$、$D_T$、$K_E$ 和 $K_D$ 函数的游离镁浓度 $[\\mathrm{M}]$，然后为该解实现一个鲁棒的数值求解器。允许的解必须满足 $0 \\le [\\mathrm{M}] \\le M_T$。\n\n您的程序必须：\n- 对于每个提供的测试用例，计算平衡游离镁浓度 $[\\mathrm{M}]$，单位为 $\\mathrm{mol \\cdot L^{-1}}$。\n- 使用一种确定性且鲁棒的数值方法，该方法应遵守 $[\\mathrm{M}]$ 的物理边界，并收敛到由控制方程在域 $[\\;0,\\;M_T\\;]$ 上的单调性所蕴含的唯一允许解。\n- 生成一行输出，其中包含所有测试用例的结果，格式为方括号内以逗号分隔的列表。每个结果都必须是代表 $[\\mathrm{M}]$（单位为 $\\mathrm{mol \\cdot L^{-1}}$）的浮点数，并四舍五入到 $6$ 位小数。\n\n测试套件（所有浓度单位均为 $\\mathrm{mol \\cdot L^{-1}}$，常数单位为 $\\mathrm{L \\cdot mol^{-1}}$）：\n- 案例 $1$（典型 PCR，有轻微 EDTA 残留）：$M_T = 3.0\\times 10^{-3}$, $E_T = 5.0\\times 10^{-5}$, $D_T = 8.0\\times 10^{-4}$, $K_E = 1.0\\times 10^{6}$, $K_D = 5.0\\times 10^{4}$。\n- 案例 $2$（无 EDTA，中等浓度 dNTP）：$M_T = 3.0\\times 10^{-3}$, $E_T = 0.0$, $D_T = 8.0\\times 10^{-4}$, $K_E = 1.0\\times 10^{6}$, $K_D = 5.0\\times 10^{4}$。\n- 案例 $3$（来自抗凝管的 EDTA 高度污染）：$M_T = 3.0\\times 10^{-3}$, $E_T = 5.0\\times 10^{-3}$, $D_T = 8.0\\times 10^{-4}$, $K_E = 1.0\\times 10^{6}$, $K_D = 5.0\\times 10^{4}$。\n- 案例 $4$（低镁，过量 dNTP）：$M_T = 5.0\\times 10^{-4}$, $E_T = 0.0$, $D_T = 1.0\\times 10^{-3}$, $K_E = 1.0\\times 10^{6}$, $K_D = 5.0\\times 10^{4}$。\n- 案例 $5$（无竞争物）：$M_T = 3.0\\times 10^{-3}$, $E_T = 0.0$, $D_T = 0.0$, $K_E = 1.0\\times 10^{6}$, $K_D = 5.0\\times 10^{4}$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含结果，格式为方括号内以逗号分隔的列表，例如 $\\verb|[0.002345,0.002987,0.000001]|$。每个数字的单位都必须是 $\\mathrm{mol \\cdot L^{-1}}$，并四舍五入到 $6$ 位小数。",
            "solution": "问题陈述已经过验证，被认为是有效的。它科学地基于化学平衡原理，问题设定良好，信息充分且一致，能够产生唯一的物理解决方案，并以客观、正式的语言陈述。\n\n目标是确定一个包含两种竞争性配体 EDTA 和 dNTPs 的系统中，游离镁离子 $[\\mathrm{M}]$ 的平衡浓度。解决方案需要推导出一个关于 $[\\mathrm{M}]$ 的单一方程，然后对其进行数值求解。\n\n首先，我们得到以下五个描述系统平衡状态的方程组：\n质量作用定律（$1{:}1$ 络合物）：\n$$[\\mathrm{ME}] = K_E [\\mathrm{M}] [\\mathrm{E}] \\quad (1)$$\n$$[\\mathrm{MD}] = K_D [\\mathrm{M}] [\\mathrm{D}] \\quad (2)$$\n质量平衡方程：\n$$M_T = [\\mathrm{M}] + [\\mathrm{ME}] + [\\mathrm{MD}] \\quad (3)$$\n$$E_T = [\\mathrm{E}] + [\\mathrm{ME}] \\quad (4)$$\n$$D_T = [\\mathrm{D}] + [\\mathrm{MD}] \\quad (5)$$\n\n在此，$[\\mathrm{M}]$、$[\\mathrm{E}]$ 和 $[\\mathrm{D}]$ 分别是镁、EDTA 和 dNTPs 的游离浓度。$[\\mathrm{ME}]$ 和 $[\\mathrm{MD}]$ 是相应络合物的浓度。$M_T$、$E_T$ 和 $D_T$ 是总分析浓度，而 $K_E$ 和 $K_D$ 是条件缔合常数。\n\n目标是找到一个仅含单个未知数 $[\\mathrm{M}]$ 的方程。为此，我们将所有其他可变浓度表示为 $[\\mathrm{M}]$ 以及已知的总浓度和常数的函数。\n\n首先，我们将游离配体浓度 $[\\mathrm{E}]$ 和 $[\\mathrm{D}]$ 表示为 $[\\mathrm{M}]$ 的函数。根据 EDTA 的质量平衡方程 ($4$)，我们有 $[\\mathrm{E}] = E_T - [\\mathrm{ME}]$。代入质量作用定律 ($1$) 可得：\n$$[\\mathrm{E}] = E_T - K_E [\\mathrm{M}] [\\mathrm{E}]$$\n求解 $[\\mathrm{E}]$：\n$$[\\mathrm{E}] (1 + K_E [\\mathrm{M}]) = E_T \\implies [\\mathrm{E}] = \\frac{E_T}{1 + K_E [\\mathrm{M}]} \\quad (6)$$\n通过对 dNTP 物种进行完全类似的推导，使用方程 ($5$) 和 ($2$)：\n$$[\\mathrm{D}] = D_T - [\\mathrm{MD}] = D_T - K_D [\\mathrm{M}] [\\mathrm{D}]$$\n$$[\\mathrm{D}] (1 + K_D [\\mathrm{M}]) = D_T \\implies [\\mathrm{D}] = \\frac{D_T}{1 + K_D [\\mathrm{M}]} \\quad (7)$$\n\n接下来，我们找出仅用 $[\\mathrm{M}]$ 表示的络合物浓度 $[\\mathrm{ME}]$ 和 $[\\mathrm{MD}]$ 的表达式。将方程 ($6$) 代回质量作用定律 ($1$)：\n$$[\\mathrm{ME}] = K_E [\\mathrm{M}] \\left( \\frac{E_T}{1 + K_E [\\mathrm{M}]} \\right) = \\frac{K_E E_T [\\mathrm{M}]}{1 + K_E [\\mathrm{M}]} \\quad (8)$$\n类似地，将方程 ($7$) 代入方程 ($2$)：\n$$[\\mathrm{MD}] = K_D [\\mathrm{M}] \\left( \\frac{D_T}{1 + K_D [\\mathrm{M}]} \\right) = \\frac{K_D D_T [\\mathrm{M}]}{1 + K_D [\\mathrm{M}]} \\quad (9)$$\n\n最后，我们将 $[\\mathrm{ME}]$ 和 $[\\mathrm{MD}]$ 的这些表达式代入镁的质量平衡方程 ($3$)：\n$$M_T = [\\mathrm{M}] + \\frac{K_E E_T [\\mathrm{M}]}{1 + K_E [\\mathrm{M}]} + \\frac{K_D D_T [\\mathrm{M}]}{1 + K_D [\\mathrm{M}]}$$\n这就是我们所期望的、将未知数 $[\\mathrm{M}]$ 与已知参数联系起来的方程。为了进行数值求解，我们定义一个函数 $f([\\mathrm{M}])$，其根即为解。为简化符号，令 $x = [\\mathrm{M}]$。\n$$f(x) = x + \\frac{K_E E_T x}{1 + K_E x} + \\frac{K_D D_T x}{1 + K_D x} - M_T = 0$$\n物理上允许的解必须位于区间 $[0, M_T]$ 内，因为游离镁浓度不能为负，也不能超过总浓度。\n\n为了选择一个鲁棒的数值方法，我们分析函数 $f(x)$ 在定义域 $[0, M_T]$ 上的性质。\n当 $x \\ge 0$ 时，该函数是连续的。我们来考察它对 $x$ 的导数：\n$$f'(x) = \\frac{d}{dx} \\left( x + \\frac{K_E E_T x}{1 + K_E x} + \\frac{K_D D_T x}{1 + K_D x} - M_T \\right)$$\n对第二项和第三项使用商法则：\n$$f'(x) = 1 + \\frac{K_E E_T(1 + K_E x) - (K_E E_T x)(K_E)}{(1 + K_E x)^2} + \\frac{K_D D_T(1 + K_D x) - (K_D D_T x)(K_D)}{(1 + K_D x)^2}$$\n$$f'(x) = 1 + \\frac{K_E E_T}{(1 + K_E x)^2} + \\frac{K_D D_T}{(1 + K_D x)^2}$$\n由于所有参数（$K_E, E_T, K_D, D_T$）都是非负的，因此 $f'(x)$ 中的每一项都是非负的。具体来说，对于所有 $x \\ge 0$，$f'(x) \\ge 1$。这证明了 $f(x)$ 在其物理定义域上是严格单调递增的。\n\n一个严格单调的函数最多只有一个根。我们可以通过应用介值定理来保证在 $[0, M_T]$ 区间内存在唯一的根。我们来计算 $f(x)$ 在该区间边界上的值：\n在 $x = 0$ 处：\n$$f(0) = 0 + 0 + 0 - M_T = -M_T$$\n因为 $M_T \\ge 0$，我们有 $f(0) \\le 0$。\n在 $x = M_T$ 处：\n$$f(M_T) = M_T + \\frac{K_E E_T M_T}{1 + K_E M_T} + \\frac{K_D D_T M_T}{1 + K_D M_T} - M_T = \\frac{K_E E_T M_T}{1 + K_E M_T} + \\frac{K_D D_T M_T}{1 + K_D M_T}$$\n右侧的项均为非负，所以 $f(M_T) \\ge 0$。\n\n由于 $f(x)$ 在 $[0, M_T]$ 上是连续且单调的，并且 $f(0) \\le 0$ 和 $f(M_T) \\ge 0$，因此在该区间内存在唯一一个使 $f(x) = 0$ 的根。这证实了使用有界求根算法的有效性。Brent 法是一个绝佳的选择，因为它结合了二分法保证收敛的优点和更快、基于插值的方法的速度。该方法在 `scipy.optimize.brentq` 中可用，非常适合解决此问题。该算法将应用于函数 $f(x)$ 在区间 $[0, M_T]$ 上，以找到 $[\\mathrm{M}]$ 的唯一解。必须单独处理 $M_T = 0$ 的边界情况，因为它会为求解器创建一个零宽度的区间；在这种情况下，解显然是 $[\\mathrm{M}] = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves for the free magnesium concentration\n    in a competitive binding equilibrium system.\n    \"\"\"\n    # Test suite (units for all concentrations are mol/L, and constants are in L/mol).\n    test_cases = [\n        # Case 1 (typical PCR with mild EDTA carryover)\n        (3.0e-3, 5.0e-5, 8.0e-4, 1.0e6, 5.0e4),\n        # Case 2 (no EDTA, moderate dNTP)\n        (3.0e-3, 0.0, 8.0e-4, 1.0e6, 5.0e4),\n        # Case 3 (high EDTA contamination from anticoagulant tube)\n        (3.0e-3, 5.0e-3, 8.0e-4, 1.0e6, 5.0e4),\n        # Case 4 (low magnesium, excess dNTP)\n        (5.0e-4, 0.0, 1.0e-3, 1.0e6, 5.0e4),\n        # Case 5 (no competitors)\n        (3.0e-3, 0.0, 0.0, 1.0e6, 5.0e4),\n    ]\n\n    results = []\n    for case in test_cases:\n        M_T, E_T, D_T, K_E, K_D = case\n\n        # The free magnesium concentration [M] is the root of the function f(M)=0.\n        # f(M) = M + [ME] + [MD] - M_T\n        # where [ME] = (K_E * E_T * M) / (1 + K_E * M)\n        # and   [MD] = (K_D * D_T * M) / (1 + K_D * M)\n        def f(M, M_T, E_T, D_T, K_E, K_D):\n            \"\"\"Target function for root finding, representing the mass balance equation.\"\"\"\n            if M  0: # Concentrations cannot be negative\n                return np.inf\n            # Calculate concentrations of complexes at a given free Mg concentration M\n            # Numerically stable calculation for the complex terms\n            me_complex = (K_E * E_T * M) / (1.0 + K_E * M)\n            md_complex = (K_D * D_T * M) / (1.0 + K_D * M)\n            \n            return M + me_complex + md_complex - M_T\n\n        # Handle the trivial case where total magnesium is zero.\n        if M_T == 0.0:\n            free_M = 0.0\n        else:\n            # The root must be in the interval [0, M_T].\n            # We use Brent's method for robust and efficient root finding.\n            # Lambda wraps f to create a function of a single variable for the solver.\n            try:\n                free_M = brentq(lambda M: f(M, M_T, E_T, D_T, K_E, K_D), 0.0, M_T)\n            except ValueError:\n                # This may occur if f(a) and f(b) do not have opposite signs.\n                # Given our analysis, this can only happen if a root is at an endpoint.\n                # Check endpoints. f(0) is always = 0. If f(M_T) is very close to 0, \n                # numerical precision might cause f(0)*f(M_T) > 0.\n                if np.isclose(f(M_T, M_T, E_T, D_T, K_E, K_D), 0.0):\n                    free_M = M_T\n                elif np.isclose(f(0.0, M_T, E_T, D_T, K_E, K_D), 0.0):\n                    free_M = 0.0\n                else: \n                    # This case should not be reached given the problem physics\n                    free_M = np.nan\n\n        results.append(f\"{free_M:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}