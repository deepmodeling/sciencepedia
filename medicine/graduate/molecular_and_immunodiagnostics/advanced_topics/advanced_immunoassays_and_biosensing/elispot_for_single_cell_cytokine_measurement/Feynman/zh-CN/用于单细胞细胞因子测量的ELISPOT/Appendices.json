{
    "hands_on_practices": [
        {
            "introduction": "ELISpot 实验的成功关键在于准确计数单个斑点。一个核心的实验设计决策是细胞的铺板密度，因为过高的密度会导致斑点重叠，从而无法准确计数。\n\n本练习运用几何概率来模拟斑点重叠（“碰撞”）如何随细胞密度增加。通过推导期望的碰撞次数，学生将从第一性原理层面理解为何存在一个最佳的细胞密度窗口，从而为实验设计的关键步骤提供量化依据。",
            "id": "5112787",
            "problem": "在用于单细胞细胞因子测量的酶联免疫斑点（ELISpot）分析中，每个分泌细胞因子的细胞会在膜上沉积一种不溶性产物，形成一个以细胞位置为中心、半径近似均匀为 $r$ 的圆形斑点。要精确计数分泌细胞因子的细胞，就要求各个斑点是可分辨且不重叠的。考虑一个面积为 $A$ 的单个孔，其中接种了 $N$ 个存活的、分泌细胞因子的细胞，并假设它们在孔表面上独立且均匀分布。定义“碰撞”为任意一对在几何上重叠的斑点（即，其中心之间的距离小于 $2r$）。假设 $r$ 相对于孔的特征长度尺度很小，因此边界效应可以忽略不计。\n\n仅使用几何概率的基本定义、均匀分布点的独立性以及期望的线性性质，推导孔中碰撞的期望数的解析表达式，该表达式是 $N$、$r$ 和 $A$ 的函数。基于你的推导，从第一性原理的角度简要论证为何优化细胞密度（单位面积的细胞数）对于最小化斑点重叠至关重要。将你的最终结果表示为单个封闭形式的解析表达式。无需进行数值计算，最终表达式中也不应包含单位。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、问题良定、客观，并包含了使用指定的第一性原理方法推导解决方案所需的所有必要信息。\n\n该问题要求推导在面积为 $A$ 的孔中独立均匀分布的 $N$ 个分泌细胞因子的细胞之间碰撞的期望数 $E[C]$。每个细胞产生一个半径为 $r$ 的斑点。碰撞定义为两个斑点的几何重叠，即相应细胞中心之间的距离小于 $2r$ 时发生。推导将通过应用期望的线性性质来进行。\n\n设 $N$ 个细胞从 $1$ 到 $N$ 进行索引。设 $C$ 为表示孔中碰撞总数的随机变量。一次碰撞涉及一对斑点。唯一的细胞对总数由二项式系数 $\\binom{N}{2}$ 给出。\n\n让我们为每一对不同的细胞 $(i, j)$（其中 $1 \\le i  j \\le N$）定义一个指示随机变量 $I_{ij}$。变量 $I_{ij}$ 定义如下：\n$$\nI_{ij} =\n\\begin{cases}\n1  \\text{如果斑点 } i \\text{ 和 } j \\text{ 碰撞} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n碰撞总数 $C$ 是对所有唯一细胞对的这些指示变量求和：\n$$\nC = \\sum_{1 \\le i  j \\le N} I_{ij}\n$$\n碰撞的期望数 $E[C]$ 可以通过应用期望的线性性质来找到，该性质指出，随机变量之和的期望等于它们各自期望的和：\n$$\nE[C] = E\\left[\\sum_{1 \\le i  j \\le N} I_{ij}\\right] = \\sum_{1 \\le i  j \\le N} E[I_{ij}]\n$$\n对于任何指示变量，其期望等于它所指示事件的概率。因此，$E[I_{ij}] = P(I_{ij} = 1)$，即斑点 $i$ 和 $j$ 碰撞的概率。我们将此概率记为 $p_{\\text{coll}}$。\n$$\nE[I_{ij}] = p_{\\text{coll}}\n$$\n由于细胞是独立同分布的（在面积 $A$ 上均匀分布），碰撞概率 $p_{\\text{coll}}$ 对于任何细胞对 $(i, j)$ 都是相同的。\n\n求和式中的项数是从 $N$ 个细胞中选择 2 个的方式数，即 $\\binom{N}{2} = \\frac{N(N-1)}{2}$。\n将此代入 $E[C]$ 的表达式中，我们得到：\n$$\nE[C] = \\sum_{1 \\le i  j \\le N} p_{\\text{coll}} = \\binom{N}{2} p_{\\text{coll}} = \\frac{N(N-1)}{2} p_{\\text{coll}}\n$$\n下一步是使用几何概率计算 $p_{\\text{coll}}$。设两个任意细胞 $i$ 和 $j$ 的中心位置为随机变量 $X_i$ 和 $X_j$，它们在面积 $A$ 上独立均匀分布。如果它们中心之间的距离 $d(X_i, X_j)$ 小于 $2r$，则发生碰撞。\n\n为计算此概率，让我们将细胞 $i$ 的位置固定在孔内的某个点 $x_i$。要发生碰撞，细胞 $j$ 的中心 $X_j$ 必须位于以 $x_i$ 为中心、半径为 $2r$ 的圆内。这个“碰撞区域”的面积是：\n$$\nA_{\\text{coll}} = \\pi (2r)^2 = 4\\pi r^2\n$$\n问题陈述指出边界效应可以忽略不计。这个关键假设意味着，对于细胞 $i$ 的任何位置 $x_i$，整个面积为 $A_{\\text{coll}}$ 的碰撞区域都被认为在孔区域 $A$ 之内。\n\n由于细胞 $j$ 在总面积 $A$ 上均匀分布，它落入此碰撞区域的概率是碰撞面积与总面积的比值：\n$$\np_{\\text{coll}} = P(d(X_i, X_j)  2r) = \\frac{A_{\\text{coll}}}{A} = \\frac{4\\pi r^2}{A}\n$$\n这个概率与细胞 $i$ 的具体位置无关，从而证实了 $p_{\\text{coll}}$ 对所有细胞对都是一个常数。\n\n现在，我们将 $p_{\\text{coll}}$ 的这个表达式代回我们的总碰撞期望数方程中：\n$$\nE[C] = \\frac{N(N-1)}{2} \\left(\\frac{4\\pi r^2}{A}\\right)\n$$\n化简此表达式可得到碰撞期望数的最终解析结果：\n$$\nE[C] = \\frac{2\\pi r^2 N(N-1)}{A}\n$$\n该表达式给出了重叠斑点的期望数，它是细胞数 $N$、斑点半径 $r$ 和孔面积 $A$ 的函数。\n\n为了论证为何优化细胞密度至关重要，我们考察 $E[C]$ 与细胞密度 $\\rho = N/A$ 之间的关系。推导出的表达式表明 $E[C]$ 与 $N(N-1)$ 成正比。对于大量细胞（$N \\gg 1$），$N(N-1) \\approx N^2$。因此，碰撞的期望数大约与细胞数的平方成比例：\n$$\nE[C] \\propto \\frac{N^2}{A} = \\left(\\frac{N}{A}\\right) N = \\rho N\n$$\n由于 $N = \\rho A$，我们也可以将其写为 $E[C] \\propto \\rho (\\rho A) = A\\rho^2$。这种对细胞密度 $\\rho$ 的二次方依赖关系是关键所在。这意味着将细胞密度加倍会导致斑点重叠的期望数大约增加四倍。高重叠率损害了 ELISpot 分析的基本原则，即对单个分泌细胞因子的细胞进行计数。如果斑点合并，计数就会变得不准确。相反，如果密度太低，观察到的斑点数量可能太少，无法进行统计上可靠的测量。因此，存在一个最佳的细胞密度范围，它既要平衡足够数量斑点的需求，又要平衡将重叠保持在最低水平的需求。碰撞随密度的强烈非线性增长使得这种优化成为实验设计中的关键步骤。",
            "answer": "$$\n\\boxed{\\frac{2\\pi r^2 N(N-1)}{A}}\n$$"
        },
        {
            "introduction": "在准确计数了真实斑点后，分析的最后一步是将这些计数转化为一个有生物学意义的参数：原始细胞群体中分泌细胞因子的细胞频率。这一步需要一个可靠的统计模型来解释细胞在微孔中分布和产生响应的固有随机性。\n\n本问题介绍了泊松模型（$Poisson$ model）——一个用于模拟稀有事件的统计基石，以及强大的最大似然估计（$Maximum$ $Likelihood$ $Estimation$, MLE）方法。通过推导分泌细胞频率的估计量，学生将学会如何以统计上严谨的方式，将观测到的数据与潜在的生物学参数联系起来。",
            "id": "5112724",
            "problem": "一个研究团队使用酶联免疫斑点（ELISpot）技术来定量外周血单个核细胞样本中细胞因子分泌细胞的频率。他们铺设了 $m$ 个重复孔，每个孔中精确接种了 $n$ 个输入细胞。在每个孔 $i \\in \\{1,2,\\dots,m\\}$ 中，他们观察到一个非负整数的斑点数 $k_{i}$，并将其作为数据。假设在极限稀释条件下，且斑点形成事件相互独立，孔 $i$ 中的总计数 $K_{i}$ 服从均值为 $\\lambda = n p$ 的泊松分布。其中 $p$ 是单细胞分泌频率（即一个随机选择的输入细胞分泌并形成可检测斑点的概率）。假设各孔之间相互独立，且 $p \\in [0,1]$。\n\n从泊松概率质量函数的定义和最大似然原理出发，根据观测数据 $\\{k_{i}\\}_{i=1}^{m}$ 和已知的 $n$，推导出 $p$ 的最大似然估计，并满足约束条件 $0 \\leq p \\leq 1$。将您的最终答案表示为由 $m$、$n$ 和观测值 $\\{k_{i}\\}$ 组成的单个闭式解析表达式。无需进行数值舍入，也无需报告单位。",
            "solution": "本题旨在求解单细胞分泌频率 $p$ 的最大似然估计（MLE），已知条件为来自 $m$ 个重复孔的斑点计数值 $\\{k_i\\}_{i=1}^{m}$，每个孔包含 $n$ 个细胞。\n\n题目陈述为单个孔 $i \\in \\{1, 2, \\dots, m\\}$ 中的斑点数 $K_i$ 提供了模型。假设随机变量 $K_i$ 服从均值为 $\\lambda = np$ 的泊松分布，其中 $n$ 是每个孔的细胞数，$p$ 是单个细胞分泌细胞因子并形成斑点的概率。参数 $p$ 被约束在区间 $[0, 1]$ 内。\n\n在孔 $i$ 中观测到 $k_i$ 个斑点的概率质量函数 (PMF) 由泊松分布给出：\n$$P(K_i = k_i | \\lambda) = \\frac{\\lambda^{k_i} \\exp(-\\lambda)}{k_i!}$$\n代入 $\\lambda = np$，以 $p$ 表示的 PMF 为：\n$$P(K_i = k_i | p, n) = \\frac{(np)^{k_i} \\exp(-np)}{k_i!}$$\n观测值 $\\{k_i\\}_{i=1}^{m}$ 来自 $m$ 个独立的孔。因此，似然函数 $L(p)$，即观测到这一特定数据集的联合概率，是每个孔的独立概率的乘积：\n$$L(p; \\{k_i\\}, n) = \\prod_{i=1}^{m} P(K_i = k_i | p, n) = \\prod_{i=1}^{m} \\frac{(np)^{k_i} \\exp(-np)}{k_i!}$$\n为求 $p$ 的最大似然估计，我们需要在约束条件 $0 \\le p \\le 1$ 下，找到使 $L(p)$ 最大化的 $p$ 值。处理似然函数的自然对数，即对数似然函数 $\\ell(p) = \\ln(L(p))$，会更为方便，因为最大化 $\\ell(p)$ 等价于最大化 $L(p)$，且对数变换能将乘积简化为求和。\n$$\\ell(p) = \\ln\\left( \\prod_{i=1}^{m} \\frac{(np)^{k_i} \\exp(-np)}{k_i!} \\right) = \\sum_{i=1}^{m} \\ln\\left( \\frac{(np)^{k_i} \\exp(-np)}{k_i!} \\right)$$\n利用对数的性质，我们可以展开此表达式：\n$$\\ell(p) = \\sum_{i=1}^{m} \\left[ \\ln((np)^{k_i}) - \\ln(\\exp(np)) - \\ln(k_i!) \\right]$$\n$$\\ell(p) = \\sum_{i=1}^{m} \\left[ k_i \\ln(np) - np - \\ln(k_i!) \\right]$$\n我们可以进一步分离包含 $p$ 的项：\n$$\\ell(p) = \\sum_{i=1}^{m} \\left[ k_i (\\ln(n) + \\ln(p)) - np - \\ln(k_i!) \\right]$$\n$$\\ell(p) = \\left(\\sum_{i=1}^{m} k_i\\right) \\ln(n) + \\left(\\sum_{i=1}^{m} k_i\\right) \\ln(p) - mnp - \\sum_{i=1}^{m} \\ln(k_i!)$$\n为了找到使 $\\ell(p)$ 最大化的 $p$ 值，我们首先通过对 $\\ell(p)$ 关于 $p$ 求导并令其为零来找到临界点。不依赖于 $p$ 的项的导数为零。\n$$\\frac{d\\ell}{dp} = \\frac{d}{dp} \\left[ \\left(\\sum_{i=1}^{m} k_i\\right) \\ln(p) - mnp + (\\text{constants}) \\right]$$\n$$\\frac{d\\ell}{dp} = \\frac{1}{p} \\left(\\sum_{i=1}^{m} k_i\\right) - mn$$\n令导数为零，得到 $p$ 的无约束估计，我们将其记为 $\\hat{p}_{\\text{unc}}$：\n$$\\frac{1}{\\hat{p}_{\\text{unc}}} \\left(\\sum_{i=1}^{m} k_i\\right) - mn = 0$$\n$$\\frac{1}{\\hat{p}_{\\text{unc}}} \\left(\\sum_{i=1}^{m} k_i\\right) = mn$$\n$$\\hat{p}_{\\text{unc}} = \\frac{\\sum_{i=1}^{m} k_i}{mn}$$\n为确认这是一个最大值，我们检查二阶导数：\n$$\\frac{d^2\\ell}{dp^2} = -\\frac{1}{p^2} \\left(\\sum_{i=1}^{m} k_i\\right)$$\n由于对所有 $i$ 都有 $k_i \\ge 0$，所以和 $\\sum k_i$ 是非负的。对于任何 $p > 0$，$p^2$ 是正的。因此，如果 $\\sum k_i > 0$，二阶导数为负，这证实了 $\\ell(p)$ 是 $p$ 的一个凹函数，并且 $\\hat{p}_{\\text{unc}}$ 是一个最大值点。\n\n现在，我们必须施加约束 $p \\in [0, 1]$。最大似然估计 $\\hat{p}_{\\text{MLE}}$ 必须位于此区间内。\n令 $S = \\sum_{i=1}^{m} k_i$。无约束估计为 $\\hat{p}_{\\text{unc}} = S / (mn)$。\n\n情况 1：$S=0$。这意味着所有观测到的计数 $k_i$ 均为 $0$。\n对数似然变为 $\\ell(p) = -mnp - \\sum_{i=1}^{m} \\ln(0!) = -mnp$。其导数为 $\\frac{d\\ell}{dp} = -mn$，由于 $m$ 和 $n$ 是正整数，该导数严格为负。函数 $\\ell(p)$ 在 $p \\in [0, 1]$ 上是严格递减的。因此，在下边界 $p=0$ 处达到最大值。在这种情况下，$\\hat{p}_{\\text{MLE}} = 0$。\n\n情况 2：$S>0$。\n对数似然函数 $\\ell(p)$ 在 $p>0$ 时是凹函数。\n- 如果 $0  \\hat{p}_{\\text{unc}}  1$，无约束最大值位于有效参数空间的内部。因此，最大似然估计就是无约束估计：$\\hat{p}_{\\text{MLE}} = \\hat{p}_{\\text{unc}} = \\frac{\\sum_{i=1}^{m} k_i}{mn}$。\n- 如果 $\\hat{p}_{\\text{unc}} \\ge 1$，无约束最大值位于有效区间的外部或上边界上。由于 $\\ell(p)$ 是凹函数，其导数 $\\frac{d\\ell}{dp} = \\frac{S}{p} - mn = mn(\\frac{\\hat{p}_{\\text{unc}}}{p} - 1)$ 对于所有 $p \\in (0, 1]$ 都是非负的，因为 $\\frac{\\hat{p}_{\\text{unc}}}{p} \\ge 1$。这意味着 $\\ell(p)$ 在 $(0, 1]$ 上是非递减的。因此，在区间 $[0, 1]$ 上的最大值必须在上边界 $p=1$ 处取得。所以，$\\hat{p}_{\\text{MLE}} = 1$。\n- 在 $S>0$ 的情况下，$\\hat{p}_{\\text{unc}} \\le 0$ 是不可能的，因为 $m$、$n$ 和 $S$ 都是正数。\n\n我们可以将这些情况合并为一个单一的表达式。由于 $\\sum k_i \\ge 0$，$m > 0$ 且 $n > 0$，无约束估计 $\\hat{p}_{\\text{unc}}$ 总是非负的。如果 $\\hat{p}_{\\text{unc}}$ 小于或等于 $1$，则最大似然估计就是 $\\hat{p}_{\\text{unc}}$ 的值，否则为 $1$。这可以用最小值函数简洁地写成：\n$$\\hat{p}_{\\text{MLE}} = \\min\\left(1, \\hat{p}_{\\text{unc}}\\right) = \\min\\left(1, \\frac{\\sum_{i=1}^{m} k_i}{mn}\\right)$$\n当所有 $k_i=0$ 时，该表达式正确地计算为 $0$；当 $0  \\frac{\\sum k_i}{mn}  1$ 时，计算为 $\\frac{\\sum k_i}{mn}$；当 $\\frac{\\sum k_i}{mn} \\ge 1$ 时，计算为 $1$。这就是在给定约束条件下 $p$ 的最大似然估计的最终闭式表达式。",
            "answer": "$$\\boxed{\\min\\left(1, \\frac{\\sum_{i=1}^{m} k_i}{mn}\\right)}$$"
        }
    ]
}