{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本节的第一个练习将引导您完成数字PCR分析中最核心的任务：从原始分区数据中估算目标分子的浓度。通过这个练习，您将掌握如何应用泊松分布模型——数字PCR定量的基石——从阳性微孔数和总微孔数推导出最终的浓度值，这是理解和执行dPCR实验所必需的基本技能。",
            "id": "5098729",
            "problem": "一项基于芯片的数字聚合酶链式反应（dPCR）分析被用于量化来自与分子和免疫诊断相关的临床样本中的单一基因靶标。该微流控芯片将反应分配到 $N=20{,}000$ 个纳升级反应孔中，每个孔的体积为 $v=1.2\\,\\mathrm{nL}$。在终点扩增和荧光成像后，有 $k=3{,}000$ 个纳升级反应孔被归类为阳性。假设靶标分子在各个反应孔中随机且独立地分布，进入每个纳升级反应孔的分子数量是一个均值为 $\\lambda$ 的泊松随机变量，并且如果一个纳升级反应孔含有至少一个靶标分子，则称其为阳性。\n\n从分子分配的泊松定律和阳性定义为零计数事件的补集出发，推导出 $\\lambda$ 关于 $N$ 和 $k$ 的最大似然估计量。然后，利用平均占有率和整体浓度之间的关系，计算以“拷贝数/$\\mu\\mathrm{L}$”为单位的估计靶标浓度 $c$。请仔细考虑 $\\mathrm{nL}$ 和 $\\mu\\mathrm{L}$ 之间的单位换算。将 $c$ 的最终数值答案四舍五入到四位有效数字，并以“拷贝数/$\\mu\\mathrm{L}$”表示。",
            "solution": "该问题要求推导每个纳升级反应孔中靶标分子的平均数 $\\lambda$ 的最大似然估计量，并随后计算以“拷贝数/微升”为单位的靶标浓度 $c$。\n\n设 $X_i$ 为第 $i$ 个纳升级反应孔中的靶标分子数，其中 $i = 1, 2, \\dots, N$。根据题意，$X_i$ 服从均值为 $\\lambda$ 的泊松分布。其概率质量函数由下式给出：\n$$P(X_i = m) = \\frac{\\lambda^m \\exp(-\\lambda)}{m!}$$\n其中 $m$ 是一个代表分子数量的非负整数。\n\n一个纳升级反应孔如果含有至少一个靶标分子，即 $X_i \\ge 1$，则定义为阳性。因此，一个纳升级反应孔为阳性的概率 $p$ 是：\n$$p = P(X_i \\ge 1) = 1 - P(X_i = 0) = 1 - \\exp(-\\lambda)$$\n\n该实验包括观察 $N$ 个独立的纳升级反应孔，这可以被建模为一系列 $N$ 次伯努利试验。阳性纳升级反应孔的总数 $k$ 服从参数为 $N$ 和 $p$ 的二项分布。$p$ 的最大似然估计量（MLE）是观测到的比例，$\\hat{p} = k/N$。根据最大似然估计量的不变性原理，我们可以通过 $\\hat{p} = 1 - \\exp(-\\hat{\\lambda})$ 找到 $\\lambda$ 的最大似然估计量 $\\hat{\\lambda}$。\n$$\\exp(-\\hat{\\lambda}) = 1 - \\hat{p} = 1 - \\frac{k}{N}$$\n对两边取自然对数求解 $\\hat{\\lambda}$：\n$$-\\hat{\\lambda} = \\ln\\left(1 - \\frac{k}{N}\\right)$$\n$$\\hat{\\lambda} = -\\ln\\left(1 - \\frac{k}{N}\\right)$$\n这就是 $\\lambda$ 关于 $N$ 和 $k$ 的最大似然估计量。\n\n现在，我们使用给定的数值来计算 $\\hat{\\lambda}$。\n已知：\n纳升级反应孔总数，$N = 20000$。\n阳性纳升级反应孔数，$k = 3000$。\n$$\\hat{\\lambda} = -\\ln\\left(1 - \\frac{3000}{20000}\\right) = -\\ln\\left(1 - 0.15\\right) = -\\ln(0.85)$$\n$$\\hat{\\lambda} \\approx 0.1625189$$\n\n浓度 $c$ 是单位体积内的平均分子数。单个纳升级反应孔中的平均分子数是 $\\lambda$，单个纳升级反应孔的体积是 $v$。因此，估计浓度 $\\hat{c}$ 为：\n$$\\hat{c} = \\frac{\\hat{\\lambda}}{v}$$\n已知：\n每个纳升级反应孔的体积，$v = 1.2\\,\\mathrm{nL}$。\n问题要求浓度以“拷贝数/$\\mu\\mathrm{L}$”为单位。我们必须进行单位换算。\n$1\\,\\mu\\mathrm{L} = 1000\\,\\mathrm{nL}$，所以 $1\\,\\mathrm{nL} = 10^{-3}\\,\\mu\\mathrm{L}$。\n$$v = 1.2 \\times 10^{-3}\\,\\mu\\mathrm{L}$$\n现在我们可以计算估计浓度 $\\hat{c}$：\n$$\\hat{c} = \\frac{-\\ln(0.85)}{1.2 \\times 10^{-3}\\,\\mu\\mathrm{L}} \\approx \\frac{0.1625189}{1.2 \\times 10^{-3}} \\frac{\\text{拷贝数}}{\\mu\\mathrm{L}}$$\n$$\\hat{c} \\approx 135.43244\\,\\frac{\\text{拷贝数}}{\\mu\\mathrm{L}}$$\n将最终答案四舍五入到四位有效数字，我们得到：\n$$\\hat{c} \\approx 135.4\\,\\frac{\\text{拷贝数}}{\\mu\\mathrm{L}}$$",
            "answer": "$$\\boxed{1.354 \\times 10^{2}}$$"
        },
        {
            "introduction": "在掌握了基本定量方法后，我们可以将其扩展到更复杂的临床相关应用中，例如拷贝数变异(CNV)分析。本练习模拟了一个典型的CNV检测场景，您需要同时定量一个目标基因和一个参照基因。这项实践不仅要求您计算两种浓度的比率，还要求您评估该测量值的统计置信度，这在任何精确定量诊断中都是一项至关重要的技能。",
            "id": "5098724",
            "problem": "在一项为分子和免疫诊断拷贝数变异定量而设计的基于芯片的数字聚合酶链式反应（dPCR）检测中，一个样本被分配到等体积的纳米孔中。假设每个纳米孔中，一个生物标志物基因（目标基因，记为 $T$）和一个单拷贝参考基因（参考基因，记为 $R$）的目标分子占据数，分别由独立的泊松随机变量建模，其均值分别为 $\\lambda_T$ 和 $\\lambda_R$。当一个纳米孔含有至少一个可扩增的模板分子时，它被称为“阳性”孔。在泊松模型下，一个纳米孔为阳性的概率是其占据数为零的概率的补集。因此，在 $N$ 个纳米孔中观测到的阳性纳米孔数 $k$ 服从二项分布，其成功概率由底层的泊松均值决定。从这些基础出发，分别根据 $T$ 和 $R$ 观测到的阳性分数，推导出最大似然估计量 $\\hat{\\lambda}_T$ 和 $\\hat{\\lambda}_R$。然后推导相对拷贝数 $\\widehat{\\mathrm{CN}}$ 的估计量，其定义为每个纳米孔泊松均值之比，即 $\\widehat{\\mathrm{CN}} = \\hat{\\lambda}_T / \\hat{\\lambda}_R$，当分配体积相等时，该比值等于浓度比。使用一阶德尔塔方法近似，并假设 $T$ 和 $R$ 的计数是独立的，推导 $\\widehat{\\mathrm{CN}}$ 的一个近似双侧 $95\\%$ 置信区间。\n\n给定 $N_T = N_R = 20{,}000$ 个纳米孔，$T$ 的阳性孔数为 $k_T = 8{,}000$，$R$ 的阳性孔数为 $k_R = 10{,}000$，计算 $\\hat{\\lambda}_T$、$\\hat{\\lambda}_R$、$\\widehat{\\mathrm{CN}}$ 的数值，以及 $\\widehat{\\mathrm{CN}}$ 的 $95\\%$ 置信区间的下限和上限。将所有答案表示为无量纲数，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "解答过程分为三个主要部分：首先，推导泊松均值 $\\lambda$ 的最大似然估计量（MLE）；其次，使用德尔塔方法推导两个此类估计量之比的近似置信区间；最后，计算所需的数值。\n\n**1. 最大似然估计量（MLE）的推导**\n\n设单个纳米孔为阳性的概率为 $p$。由于阳性事件是纳米孔中分子数不为零的事件，其概率为 $p = 1 - e^{-\\lambda}$，其中 $\\lambda$ 是每个纳米孔的平均分子数。在 $N$ 次独立观测中，阳性孔数 $k$ 服从二项分布，其比例的最大似然估计为 $\\hat{p} = k/N$。根据最大似然估计的不变性，$\\lambda$ 的MLE $\\hat{\\lambda}$ 为：\n$$\\hat{\\lambda} = -\\ln(1 - \\hat{p}) = -\\ln\\left(1 - \\frac{k}{N}\\right)$$\n将此公式分别应用于目标基因（$T$）和参考基因（$R$）：\n$$\\hat{\\lambda}_T = -\\ln\\left(1 - \\frac{k_T}{N_T}\\right) \\quad \\text{和} \\quad \\hat{\\lambda}_R = -\\ln\\left(1 - \\frac{k_R}{N_R}\\right)$$\n\n**2. 置信区间的推导**\n\n我们使用一阶德尔塔方法推导相对拷贝数 $\\widehat{\\mathrm{CN}} = \\hat{\\lambda}_T / \\hat{\\lambda}_R$ 的近似方差。首先，推导 $\\hat{\\lambda}$ 的方差。\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}) \\approx \\left(\\frac{d\\hat{\\lambda}}{d\\hat{p}}\\right)^2 \\widehat{\\mathrm{Var}}(\\hat{p}) = \\left(\\frac{1}{1-\\hat{p}}\\right)^2 \\frac{\\hat{p}(1-\\hat{p})}{N} = \\frac{\\hat{p}}{N(1-\\hat{p})} = \\frac{k}{N(N-k)}$$\n对于函数 $\\widehat{\\mathrm{CN}} = g(\\hat{\\lambda}_T, \\hat{\\lambda}_R) = \\hat{\\lambda}_T / \\hat{\\lambda}_R$，其方差可近似为：\n$$\\mathrm{Var}(\\widehat{\\mathrm{CN}}) \\approx (\\widehat{\\mathrm{CN}})^2 \\left( \\frac{\\mathrm{Var}(\\hat{\\lambda}_T)}{\\hat{\\lambda}_T^2} + \\frac{\\mathrm{Var}(\\hat{\\lambda}_R)}{\\hat{\\lambda}_R^2} \\right)$$\n一个近似的双侧 $95\\%$ 置信区间由 $\\widehat{\\mathrm{CN}} \\pm z_{0.975} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}})}$ 给出，其中 $z_{0.975} \\approx 1.96$。\n\n**3. 数值计算**\n\n给定数据：$N_T = 20,000$，$k_T = 8,000$，$N_R = 20,000$，$k_R = 10,000$。\n\n计算 $\\lambda_T$ 和 $\\lambda_R$ 的 MLE：\n$$\\hat{\\lambda}_T = -\\ln\\left(1 - \\frac{8000}{20000}\\right) = -\\ln(0.6) \\approx 0.5108256$$\n$$\\hat{\\lambda}_R = -\\ln\\left(1 - \\frac{10000}{20000}\\right) = -\\ln(0.5) = \\ln(2) \\approx 0.6931472$$\n四舍五入到四位有效数字，$\\hat{\\lambda}_T \\approx 0.5108$ 且 $\\hat{\\lambda}_R \\approx 0.6931$。\n\n计算拷贝数的估计量：\n$$\\widehat{\\mathrm{CN}} = \\frac{\\hat{\\lambda}_T}{\\hat{\\lambda}_R} \\approx \\frac{0.5108256}{0.6931472} \\approx 0.7369656$$\n四舍五入到四位有效数字，$\\widehat{\\mathrm{CN}} \\approx 0.7370$。\n\n计算 $\\hat{\\lambda}_T$ 和 $\\hat{\\lambda}_R$ 的估计方差：\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_T) = \\frac{8000}{20000(12000)} = \\frac{1}{30000}$$\n$$\\widehat{\\mathrm{Var}}(\\hat{\\lambda}_R) = \\frac{10000}{20000(10000)} = \\frac{1}{20000}$$\n\n计算 $\\widehat{\\mathrm{CN}}$ 的估计方差和标准误：\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}}) \\approx (0.7369656)^2 \\left( \\frac{1/30000}{(0.5108256)^2} + \\frac{1/20000}{(0.6931472)^2} \\right)$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\mathrm{CN}}) \\approx (0.543118) \\left( 1.2774 \\times 10^{-4} + 1.0407 \\times 10^{-4} \\right) \\approx 1.2588 \\times 10^{-4}$$\n标准误 $SE(\\widehat{\\mathrm{CN}}) = \\sqrt{1.2588 \\times 10^{-4}} \\approx 0.0112198$。\n\n计算 $95\\%$ 置信区间：\n误差范围 $ME = 1.96 \\times 0.0112198 \\approx 0.0219908$。\n下限：$0.7369656 - 0.0219908 = 0.7149748 \\approx 0.7150$\n上限：$0.7369656 + 0.0219908 = 0.7589564 \\approx 0.7590$\n\n总结，所要求的五个数值是 $\\hat{\\lambda}_T = 0.5108$，$\\hat{\\lambda}_R = 0.6931$，$\\widehat{\\mathrm{CN}} = 0.7370$，置信区间下限 = $0.7150$，置信区间上限 = $0.7590$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5108  0.6931  0.7370  0.7150  0.7590\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理想化的模型在现实世界中总会遇到挑战。最后一个练习将带您深入探讨基于芯片的dPCR系统的一个实际复杂性：微孔体积的不均一性。本练习旨在揭示微流控芯片的物理缺陷如何给测量带来系统性偏差，并指导您使用数学方法来量化这种误差的大小。通过这种方式，您将学会批判性地审视模型假设，并理解其在实际应用中的局限性。",
            "id": "5098714",
            "problem": "一种基于芯片的数字聚合酶链式反应 (PCR) 检测方法将一个样本分配到 $N$ 个纳米孔中，每个纳米孔的体积为 $v_{i}$。在理想的数字PCR (dPCR) 中，每个孔中的目标分子数量通常被建模为一个均值为 $c\\,v_{i}$ 的泊松随机变量，其中 $c$ 是真实的目标浓度。一个孔被判定为阳性的概率于是成为 $c$ 和 $v_{i}$ 的函数。在实践中，工程化制造的芯片表现出孔间体积差异。考虑一个芯片，其孔体积 $v_{i}$ 是独立同分布的，均值为 $\\bar{v} = 1.0\\,\\mathrm{nL}$，变异系数为 $\\mathrm{CV} = 5\\%$。在该芯片上进行的一次实验中，总共 $N$ 个孔中产生了 $k$ 个阳性孔，观测到的阳性比例为 $k/N = 0.3$。\n\n从泊松占据模型和变异系数的定义出发，当孔体积被错误地当作均一处理时，请推导浓度估计值中相对偏差的渐近表达式（精确到体积弥散的二阶）。朴素估计量是通过将所有孔的体积都视为 $\\bar{v}$，并在此假设下对观测到的阳性比例进行反算得到的。将相对偏差定义为 $(\\hat{c} - c)/c$，其中 $\\hat{c}$ 是朴素估计值，而 $c$ 是在实际体积弥散条件下与观测到的阳性比例相符的真实浓度。使用关于孔体积变异性的二阶泰勒展开来量化此偏差，然后针对 $\\bar{v} = 1.0\\,\\mathrm{nL}$，$\\mathrm{CV} = 0.05$ 和 $k/N = 0.3$ 的情况，对该偏差进行数值计算。\n\n将最终的相对偏差表示为一个无量纲的小数，并将答案四舍五入到四位有效数字。",
            "solution": "本解答旨在推导当孔体积存在变异性但被错误地当作均一时，浓度估计产生的相对偏差，并计算其数值。\n\n### 1. 相对偏差的推导\n\n设 $M_i$ 为体积为 $v_i$ 的第 $i$ 个孔中的目标分子数。根据题意，$M_i$ 服从均值为 $\\lambda_i = c\\,v_i$ 的泊松分布，其中 $c$ 是真实浓度。体积为 $v_i$ 的孔呈阳性的概率 $p(v_i)$ 为：\n$$ p(v_i) = 1 - P(M_i = 0) = 1 - \\exp(-c\\,v_i) $$\n由于孔体积 $v_i$ 是一个随机变量 $V$，任何随机选择的孔呈阳性的真实概率 $P_{true}$ 是 $p(V)$ 在 $V$ 的分布上的期望：\n$$ P_{true} = \\mathbb{E}[p(V)] = \\mathbb{E}[1 - \\exp(-c\\,V)] = 1 - \\mathbb{E}[\\exp(-c\\,V)] $$\n为了计算 $\\mathbb{E}[\\exp(-c\\,V)]$，我们对函数 $f(V) = \\exp(-c\\,V)$ 在平均体积 $\\bar{v} = \\mathbb{E}[V]$ 附近进行二阶泰勒展开：\n$$ f(V) \\approx f(\\bar{v}) + f'(\\bar{v})(V - \\bar{v}) + \\frac{f''(\\bar{v})}{2}(V - \\bar{v})^2 $$\n对该展开式取期望，并利用 $\\mathbb{E}[V - \\bar{v}] = 0$ 和 $\\mathbb{E}[(V - \\bar{v})^2] = \\mathrm{Var}(V)$，我们得到：\n$$ \\mathbb{E}[\\exp(-c\\,V)] \\approx \\exp(-c\\,\\bar{v}) + \\frac{c^2 \\exp(-c\\,\\bar{v})}{2} \\mathrm{Var}(V) $$\n将 $\\mathrm{Var}(V) = (\\mathrm{CV} \\cdot \\bar{v})^2$ 代入，其中 $\\mathrm{CV}$ 是变异系数：\n$$ \\mathbb{E}[\\exp(-c\\,V)] \\approx \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n因此，实验中观测到的阳性比例 $k/N$ 应等于 $P_{true}$：\n$$ \\frac{k}{N} \\approx 1 - \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n另一方面，朴素估计量 $\\hat{c}$ 是通过假设所有体积均为 $\\bar{v}$ 得到的：\n$$ \\frac{k}{N} = 1 - \\exp(-\\hat{c}\\,\\bar{v}) $$\n令两个关于 $k/N$ 的表达式相等：\n$$ 1 - \\exp(-\\hat{c}\\,\\bar{v}) \\approx 1 - \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n$$ \\exp(-\\hat{c}\\,\\bar{v}) \\approx \\exp(-c\\,\\bar{v}) \\left( 1 + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 \\right) $$\n对两边取自然对数，并对小量 $\\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2$ 使用一阶泰勒近似 $\\ln(1+x) \\approx x$：\n$$ -\\hat{c}\\,\\bar{v} \\approx -c\\,\\bar{v} + \\frac{1}{2} (c\\,\\bar{v})^2 \\mathrm{CV}^2 $$\n两边同除以 $-\\bar{v}$：\n$$ \\hat{c} \\approx c - \\frac{1}{2} c^2 \\bar{v} \\mathrm{CV}^2 $$\n因此，相对偏差 $(\\hat{c} - c)/c$ 为：\n$$ \\frac{\\hat{c} - c}{c} \\approx -\\frac{1}{2} c\\,\\bar{v}\\,\\mathrm{CV}^2 $$\n由于偏差项本身是 $\\mathrm{CV}^2$ 阶的小量，我们可以用朴素估计值来近似其中的 $c$，即 $c \\approx \\hat{c}$，而不影响表达式的整体精度。同时，从朴素模型我们有 $\\hat{c}\\,\\bar{v} = -\\ln(1 - k/N)$。代入这些关系：\n$$ \\frac{\\hat{c} - c}{c} \\approx -\\frac{1}{2} (\\hat{c}\\,\\bar{v})\\,\\mathrm{CV}^2 = -\\frac{1}{2} \\left[ -\\ln\\left(1 - \\frac{k}{N}\\right) \\right] \\mathrm{CV}^2 = \\frac{1}{2} \\ln\\left(1 - \\frac{k}{N}\\right) \\mathrm{CV}^2 $$\n这个最终表达式将相对偏差与可观测的阳性比例 $k/N$ 和芯片的物理参数 $\\mathrm{CV}$ 联系起来。\n\n### 2. 数值计算\n\n给定 $k/N = 0.3$ 和 $\\mathrm{CV} = 0.05$。\n$$ \\frac{\\hat{c} - c}{c} \\approx \\frac{1}{2} \\ln(1 - 0.3) (0.05)^2 = \\frac{1}{2} \\ln(0.7) (0.0025) $$\n$$ \\ln(0.7) \\approx -0.3566749 $$\n$$ \\frac{\\hat{c} - c}{c} \\approx \\frac{1}{2} (-0.3566749) (0.0025) \\approx -0.0004458436 $$\n四舍五入到四位有效数字，相对偏差为：\n$$ \\frac{\\hat{c} - c}{c} \\approx -0.0004458 $$\n这表明，由于孔体积存在 $5\\%$ 的变异系数，朴素浓度估计值系统性地低估了真实浓度约 $0.045\\%$。",
            "answer": "$$\\boxed{-0.0004458}$$"
        }
    ]
}