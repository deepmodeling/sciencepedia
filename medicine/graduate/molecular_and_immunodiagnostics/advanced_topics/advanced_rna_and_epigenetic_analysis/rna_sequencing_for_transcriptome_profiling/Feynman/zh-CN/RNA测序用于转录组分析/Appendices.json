{
    "hands_on_practices": [
        {
            "introduction": "在测序之后，原始的读数计数需要进行标准化，以解释基因长度和测序文库大小等偏差。这项练习将引导您从第一性原理出发，推导两种常见的标准化单位——每百万转录本的转录本数（$TPM$）和每千碱基转录本每百万映射读数的片段数（$FPKM$）。通过完成此问题，您将深入理解这两种指标的构建方式为何不同，以及为何在跨样本比较基因表达时通常首选$TPM$。",
            "id": "5157658",
            "problem": "一项靶向核糖核酸（RNA）测序实验被用于分析一个诊断基因组合中的三个免疫相关基因。测序仪为每个基因生成片段计数，其有效转录本长度等于其注释长度，且偏差可忽略不计。假设每个测序片段都唯一地映射到这三个基因之一，并且文库中没有其他表达的转录本。\n\n片段计数为 $c = [500, 200, 300]$，转录本长度为 $\\ell = [2000, 1000, 1500]$ 碱基对。假设为单端测序，因此每个计数的片段对应一个读段（read）。仅使用“从转录组中抽样与转录本拷贝数和长度成正比”的核心定义，以及每百万转录本的转录本数（TPM）和每千碱基转录本每百万映射读段的片段数（FPKM）的标准定义，按以下步骤进行，不要引用预先编译好的公式：\n\n1) 从第一性原理出发，定义一个与读段源自给定转录本的概率成正比的长度归一化丰度，并用它来构建单个样本内 TPM 和 FPKM 的表达式。\n\n2) 使用给定数据，计算每个基因的 TPM 和 FPKM 值。\n\n3) 证明在单个样本内，TPM 和 FPKM 对于所有基因都通过一个恒定的乘法因子相关联，并计算该样本的转换因子 $K$。\n\n4) 基于步骤 1 中的构建，简要解释为什么在单个样本内 TPM 和 FPKM 的尺度可能不同，以及为什么在诊断环境中，TPM 通常更适合用于跨样本比较。\n\n仅报告步骤 3 中转换因子 $K$ 的值，四舍五入到四位有效数字。报告的值不应包含任何单位。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、问题定义清晰的且内部一致的。它呈现了转录组数据分析中一个标准的、尽管简化的场景。所有必要的数据和定义都已提供，可以进行严谨的求解。\n\n设基因集合由 $i$ 索引。给定数据为片段计数 $c_i$ 和以碱基对为单位的转录本长度 $\\ell_i$。对于该基因组合中的三个基因，我们有：\n$c = [c_1, c_2, c_3] = [500, 200, 300]$\n$\\ell = [\\ell_1, \\ell_2, \\ell_3] = [2000, 1000, 1500]$\n\n问题假设为单端测序，因此每个片段对应一个读段。\n\n1) 从第一性原理推导 TPM 和 FPKM\n\nRNA 测序的基本假设是，从转录本物种 $i$ 获得的片段数 $c_i$ 与该转录本的拷贝数 $N_i$ 及其长度 $\\ell_i$ 成正比。这可以表示为：\n$$c_i \\propto N_i \\cdot \\ell_i$$\n这意味着潜在的转录本丰度 $N_i$ 与按转录本长度归一化的读段计数成正比：\n$$N_i \\propto \\frac{c_i}{\\ell_i}$$\n项 $\\frac{c_i}{\\ell_i}$ 代表长度归一化的丰度。它与转录本 $i$ 的摩尔量成正比。\n\n每百万转录本的转录本数（TPM）旨在表示在一个包含一百万个总转录本分子的背景中，一个转录本的相对丰度。转录本 $i$ 相对于样本中所有转录本总库的相对丰度由 $\\frac{N_i}{\\sum_j N_j}$ 给出。使用上述比例关系：\n$$\\frac{N_i}{\\sum_j N_j} = \\frac{k \\cdot (c_i / \\ell_i)}{\\sum_j (k \\cdot (c_j / \\ell_j))} = \\frac{c_i / \\ell_i}{\\sum_j (c_j / \\ell_j)}$$\n其中 $k$ 是比例常数。\n为了将其表示为“每百万”的值，我们将此分数乘以 $10^6$。因此，基因 $i$ 的 TPM 定义为：\n$$\\text{TPM}_i = \\frac{c_i / \\ell_i}{\\sum_j (c_j / \\ell_j)} \\times 10^6$$\n这种构造确保了样本中所有 TPM 值的总和始终为 $10^6$。\n\n每千碱基转录本每百万映射读段的片段数（FPKM）的构建方式不同。它首先按测序深度对基因的计数进行归一化，然后再按基因长度进行归一化。\n首先，我们计算每百万映射读段的片段数。映射读段的总数为 $C_{\\text{total}} = \\sum_j c_j$。将 $c_i$ 按此总数归一化并缩放到一百万，得到：$\\frac{c_i}{\\sum_j c_j} \\times 10^6$。\n其次，该值按以千碱基（kb）为单位的转录本长度进行归一化。转录本 $i$ 的长度（以 kb 为单位）为 $\\ell_i' = \\ell_i / 1000$。\n结合这些归一化，基因 $i$ 的 FPKM 为：\n$$\\text{FPKM}_i = \\frac{c_i / (\\ell_i / 1000)}{\\sum_j c_j / 10^6} = \\frac{c_i \\cdot 1000 \\cdot 10^6}{\\ell_i \\cdot \\sum_j c_j} = \\frac{c_i}{\\ell_i} \\cdot \\frac{10^9}{\\sum_j c_j}$$\n\n2) TPM 和 FPKM 值的计算\n\n首先，我们计算长度归一化的计数 $c_i / \\ell_i$：\n对于基因 1： $\\frac{c_1}{\\ell_1} = \\frac{500}{2000} = 0.25$\n对于基因 2： $\\frac{c_2}{\\ell_2} = \\frac{200}{1000} = 0.20$\n对于基因 3： $\\frac{c_3}{\\ell_3} = \\frac{300}{1500} = 0.20$\n\n这些值的总和是 $\\sum_j (c_j / \\ell_j) = 0.25 + 0.20 + 0.20 = 0.65$。\n\n现在我们计算 TPM 值：\n$\\text{TPM}_1 = \\frac{0.25}{0.65} \\times 10^6 \\approx 384615.38$\n$\\text{TPM}_2 = \\frac{0.20}{0.65} \\times 10^6 \\approx 307692.31$\n$\\text{TPM}_3 = \\frac{0.20}{0.65} \\times 10^6 \\approx 307692.31$\n\n接下来，我们计算 FPKM 值。我们需要读段的总数：\n$C_{\\text{total}} = \\sum_j c_j = 500 + 200 + 300 = 1000$。\n\n现在我们使用推导出的公式计算 FPKM 值：\n$\\text{FPKM}_1 = \\frac{c_1}{\\ell_1} \\cdot \\frac{10^9}{\\sum_j c_j} = 0.25 \\cdot \\frac{10^9}{1000} = 0.25 \\times 10^6 = 250000$\n$\\text{FPKM}_2 = \\frac{c_2}{\\ell_2} \\cdot \\frac{10^9}{\\sum_j c_j} = 0.20 \\cdot \\frac{10^9}{1000} = 0.20 \\times 10^6 = 200000$\n$\\text{FPKM}_3 = \\frac{c_3}{\\ell_3} \\cdot \\frac{10^9}{\\sum_j c_j} = 0.20 \\cdot \\frac{10^9}{1000} = 0.20 \\times 10^6 = 200000$\n\n3) 比例性证明及因子 $K$ 的计算\n\n我们希望证明在单个样本内 $\\text{TPM}_i = K \\cdot \\text{FPKM}_i$，其中 $K$ 是一个常数。我们从推导出的表达式开始：\n$$\\text{TPM}_i = \\frac{c_i / \\ell_i}{\\sum_j (c_j / \\ell_j)} \\times 10^6 \\quad (1)$$\n$$\\text{FPKM}_i = \\frac{c_i / \\ell_i}{\\sum_j c_j} \\times 10^9 \\quad (2)$$\n从方程 $(2)$，我们可以分离出项 $c_i / \\ell_i$：\n$$\\frac{c_i}{\\ell_i} = \\text{FPKM}_i \\cdot \\frac{\\sum_j c_j}{10^9}$$\n现在将这个 $c_i / \\ell_i$ 的表达式（以及类似的 $c_j / \\ell_j$ 的表达式）代入方程 $(1)$：\n$$\\text{TPM}_i = \\frac{\\text{FPKM}_i \\cdot (\\sum_k c_k / 10^9)}{\\sum_j \\left( \\text{FPKM}_j \\cdot (\\sum_k c_k / 10^9) \\right)} \\times 10^6$$\n项 $\\frac{\\sum_k c_k}{10^9}$ 对样本内所有基因都是一个常数，可以从分母的求和中提出：\n$$\\text{TPM}_i = \\frac{\\text{FPKM}_i \\cdot \\left(\\frac{\\sum_k c_k}{10^9}\\right)}{\\left(\\frac{\\sum_k c_k}{10^9}\\right) \\cdot \\left(\\sum_j \\text{FPKM}_j\\right)} \\times 10^6$$\n该常数项被消去，剩下：\n$$\\text{TPM}_i = \\frac{\\text{FPKM}_i}{\\sum_j \\text{FPKM}_j} \\times 10^6$$\n这可以写成 $\\text{TPM}_i = K \\cdot \\text{FPKM}_i$，其中因子 $K$ 是：\n$$K = \\frac{10^6}{\\sum_j \\text{FPKM}_j}$$\n由于 $\\sum_j \\text{FPKM}_j$ 对给定样本是一个单一值，因此 $K$ 对于该样本内的所有基因都是一个常数。证明完毕。\n\n为了计算给定数据的 $K$ 值，我们首先对 FPKM 值求和：\n$$\\sum_j \\text{FPKM}_j = 250000 + 200000 + 200000 = 650000$$\n现在，我们计算 $K$：\n$$K = \\frac{10^6}{650000} = \\frac{1000000}{650000} = \\frac{100}{65} = \\frac{20}{13}$$\n数值上，$K \\approx 1.53846...$。四舍五入到四位有效数字，得到 $K = 1.538$。\n\n4) 尺度差异及 TPM 偏好的解释\n\n在单个样本内，TPM 和 FPKM 之间的尺度差异源于它们不同的归一化分母。如上述推导所示：\n- TPM 通过 $\\sum_j (c_j / \\ell_j)$ 进行归一化，该量与样本中转录本分子的总数成正比。\n- FPKM 通过 $\\sum_j c_j$ 进行归一化，即测序读段的总数（文库大小）。\n\n因为这两个总和通常不相等，所以对于给定基因，TPM 和 FPKM 的绝对值会不同。\n\n在跨样本比较中，TPM 通常更受青睐，原因至关重要。根据定义，任何样本中所有 TPM 值的总和都固定为 $10^6$。这意味着 TPM 代表了一个基因的转录本相对于转录本总库的比例（其“摩尔分数”）。相比之下，FPKM 值的总和不是恒定的，并且可能在不同样本之间有显著差异。这是因为 FPKM 的归一化因子，即总读段数 $(\\sum_j c_j)$，本身就依赖于表达谱。少数几个高丰度、长基因的表达变化会极大地改变总读段数，这反过来又会改变所有其他基因的 FPKM 值，即使是那些表达水平没有变化的基因。通过提供一个稳定的“样本内”总和，TPM 为跨不同样本比较基因的相对丰度提供了一个更稳健的度量，这在诊断应用中是一个普遍要求。\n\n要求回答的最终答案是转换因子 $K$ 的值。\n$$K = \\frac{20}{13} \\approx 1.538$$",
            "answer": "$$\\boxed{1.538}$$"
        },
        {
            "introduction": "RNA测序的一个主要目标是识别在不同条件下差异表达的基因。这项实践深入探讨了现代差异表达分析的统计核心，使用负二项式广义线性模型（GLM）来检验基因表达的显著变化。通过为一组假设数据手动计算Wald统计量，您可以直观地理解像DESeq2这样的工具其内部工作原理，并明晰生物学变异和效应大小等因素如何影响统计显著性。",
            "id": "5157644",
            "problem": "一项免疫诊断RNA测序 (RNA-seq) 实验对一个细胞因子基因在两种生物学条件下（对照组和刺激组）的表达谱进行了分析，每种条件下有 $2$ 个生物学重复，且文库大小相等。对于单个基因，观察到的原始计数为：对照组重复 $y_{1}=100$, $y_{2}=110$；刺激组重复 $y_{3}=200$, $y_{4}=220$。假设采用负二项 (NB) 噪声模型，其均值为 $\\mu_{i}$，方差为 $\\operatorname{Var}(Y_{i})=\\mu_{i}+\\alpha \\mu_{i}^{2}$，其中离散度 $\\alpha=0.1$ 为已知。使用广义线性模型 (GLM)，其连接函数为对数连接 $\\eta_{i}=x_{i}^{\\top}\\beta$ 且 $\\mu_{i}=\\exp(\\eta_{i})$，设计矩阵包含一个截距项和一个条件指示变量：对于 $i\\in\\{1,2\\}$（对照组），$x_{i}=(1,0)^{\\top}$；对于 $i\\in\\{3,4\\}$（刺激组），$x_{i}=(1,1)^{\\top}$。文库大小相等，因此不需要设置偏移量。\n\n从NB的均值-方差关系、对数连接函数以及最大似然估计 (MLE) 的大样本正态性出发，推导在该设计下用于检验 $H_{0}:\\beta_{1}=0$（即条件间不存在对数倍数变化）的沃尔德统计量。根据给定的数据和 $\\alpha$ 计算其数值。将最终的沃尔德统计量四舍五入至四位有效数字。最终答案以无量纲值的形式表示。在该指定设计矩阵下，结合差异表达的背景简要解释结果的显著性，但唯一需要报告的值是沃尔德统计量本身。",
            "solution": "用户希望在一个简化的RNA-seq实验中，推导并计算用于检验无差异表达假设（$H_{0}:\\beta_{1}=0$）的沃尔德统计量。\n\n首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **实验设计**：$2$ 个条件（对照组、刺激组），每个条件 $2$ 个重复。\n- **观测计数 ($y_{i}$)**：对照组：$y_{1}=100$, $y_{2}=110$。刺激组：$y_{3}=200$, $y_{4}=220$。\n- **统计模型**：负二项 (NB) 广义线性模型 (GLM)。\n- **均值-方差关系**：$\\operatorname{Var}(Y_{i})=\\mu_{i}+\\alpha \\mu_{i}^{2}$。\n- **离散度参数**：已知常数 $\\alpha=0.1$。\n- **连接函数**：对数连接，$\\mu_{i}=\\exp(\\eta_{i})$。\n- **线性预测器**：$\\eta_{i}=x_{i}^{\\top}\\beta$，其中 $\\beta=(\\beta_{0}, \\beta_{1})^{\\top}$。\n- **设计矩阵 ($X$)**：对于对照组 ($i\\in\\{1,2\\}$)，$x_{i}=(1,0)^{\\top}$。对于刺激组 ($i\\in\\{3,4\\}$)，$x_{i}=(1,1)^{\\top}$。\n- **文库大小**：假定相等，无需偏移项。\n- **核心任务**：推导用于检验 $H_{0}:\\beta_{1}=0$ 的沃尔德统计量。\n- **假设**：最大似然估计 (MLE) 的大样本正态性。\n- **最终输出**：沃尔德统计量的数值，四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述在科学上是合理的，采用了转录组分析中广泛使用的标准负二项GLM框架。问题定义明确，提供了计算所需统计量的所有必要数据（计数、离散度、模型结构）。语言客观、精确。数据和参数是符合实际的。已知离散度的假设简化了计算，但对于一个明确定义的问题来说是一个有效的约束。不存在矛盾、歧义或逻辑缺陷。\n\n### 步骤 3：结论与行动\n问题有效。开始求解。\n\n### 推导与计算\n\n用于检验零假设 $H_{0}: \\beta_{1}=0$ 的沃尔德统计量由参数的最大似然估计 (MLE) 与其标准误的比值给出：\n$$\nW = \\frac{\\hat{\\beta}_{1} - 0}{\\text{SE}(\\hat{\\beta}_{1})} = \\frac{\\hat{\\beta}_{1}}{\\text{SE}(\\hat{\\beta}_{1})}\n$$\n在零假设下，对于足够大的样本量，该统计量近似服从标准正态分布，$W \\sim \\mathcal{N}(0,1)$。推导过程需要求出 MLE $\\hat{\\beta}_{1}$ 及其标准误。\n\n#### 1. $\\beta$ 的最大似然估计\n\nGLM的参数是通过最大化对数似然函数来估计的。对于均值为 $\\mu_{i}$、离散度为 $\\alpha$ 的负二项分布，一组 $n$ 个独立观测值 $\\{y_i\\}_{i=1}^n$ 的对数似然函数为：\n$$\nL(\\beta) = \\sum_{i=1}^{n} \\left[ \\ln\\left(\\frac{\\Gamma(y_i + \\alpha^{-1})}{\\Gamma(y_i+1)\\Gamma(\\alpha^{-1})}\\right) + y_i\\ln\\left(\\frac{\\alpha\\mu_i}{1+\\alpha\\mu_i}\\right) + \\frac{1}{\\alpha}\\ln\\left(\\frac{1}{1+\\alpha\\mu_i}\\right) \\right]\n$$\n其中 $\\mu_i = \\exp(x_i^\\top \\beta)$。为了找到最大似然估计，我们求解得分方程，即将 $L(\\beta)$ 对每个参数 $\\beta_j$ 的偏导数设为零。观测值 $i$ 关于向量 $\\beta$ 的得分方程为：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta} = \\frac{y_i - \\mu_i}{1+\\alpha\\mu_i} x_i\n$$\n整个数据集的得分方程为 $\\sum_{i=1}^{n} \\frac{y_i - \\mu_i}{1+\\alpha\\mu_i} x_i = \\mathbf{0}$。\n\n令 $\\mu_C = \\exp(\\beta_0)$ 为对照组的均值，$\\mu_S = \\exp(\\beta_0 + \\beta_1)$ 为刺激组的均值。设计矩阵指定了 $x_{1,2}=(1,0)^\\top$ 和 $x_{3,4}=(1,1)^\\top$。得分方程为：\n$$\n\\frac{\\partial L}{\\partial \\beta_0} = \\sum_{i=1}^{2} \\frac{y_i - \\mu_C}{1+\\alpha\\mu_C}(1) + \\sum_{i=3}^{4} \\frac{y_i - \\mu_S}{1+\\alpha\\mu_S}(1) = 0\n$$\n$$\n\\frac{\\partial L}{\\partial \\beta_1} = \\sum_{i=1}^{2} \\frac{y_i - \\mu_C}{1+\\alpha\\mu_C}(0) + \\sum_{i=3}^{4} \\frac{y_i - \\mu_S}{1+\\alpha\\mu_S}(1) = 0\n$$\n由第二个方程可得：\n$$\n\\frac{(y_3 - \\mu_S) + (y_4 - \\mu_S)}{1+\\alpha\\mu_S} = 0 \\implies y_3 + y_4 - 2\\mu_S = 0 \\implies \\hat{\\mu}_S = \\frac{y_3+y_4}{2}\n$$\n将此结果代入第一个方程，意味着其第二项为零，从而第一项也必须为零：\n$$\n\\frac{(y_1 - \\mu_C) + (y_2 - \\mu_C)}{1+\\alpha\\mu_C} = 0 \\implies y_1 + y_2 - 2\\mu_C = 0 \\implies \\hat{\\mu}_C = \\frac{y_1+y_2}{2}\n$$\n因此，组均值的最大似然估计是它们各自的经验平均值：\n$$\n\\hat{\\mu}_C = \\frac{100+110}{2} = 105\n$$\n$$\n\\hat{\\mu}_S = \\frac{200+220}{2} = 210\n$$\n现在我们求解 $\\beta$ 的最大似然估计：\n$$\n\\hat{\\mu}_C = \\exp(\\hat{\\beta}_0) = 105 \\implies \\hat{\\beta}_0 = \\ln(105)\n$$\n$$\n\\hat{\\mu}_S = \\exp(\\hat{\\beta}_0 + \\hat{\\beta}_1) = 210 \\implies \\hat{\\beta}_0 + \\hat{\\beta}_1 = \\ln(210)\n$$\n对数倍数变化 $\\beta_1$ 的最大似然估计为：\n$$\n\\hat{\\beta}_1 = \\ln(210) - \\hat{\\beta}_0 = \\ln(210) - \\ln(105) = \\ln\\left(\\frac{210}{105}\\right) = \\ln(2)\n$$\n\n#### 2. $\\hat{\\beta}_1$ 的标准误\n\n标准误由费雪信息矩阵 $\\mathcal{I}(\\beta)$ 的逆矩阵推导得出。$\\hat{\\beta}$ 的方差-协方差矩阵近似为 $\\mathcal{I}(\\hat{\\beta})^{-1}$。对于GLM，费雪信息矩阵为 $\\mathcal{I}(\\beta) = X^\\top W X$，其中 $W$ 是由权重 $w_i$ 构成的对角矩阵。权重由下式给出：\n$$\nw_i = \\frac{(\\partial\\mu_i/\\partial\\eta_i)^2}{\\operatorname{Var}(Y_i)} = \\frac{\\mu_i^2}{\\mu_i + \\alpha \\mu_i^2} = \\frac{\\mu_i}{1+\\alpha\\mu_i}\n$$\n我们在最大似然估计值 $\\hat{\\mu}_C$ 和 $\\hat{\\mu}_S$ 处计算这些权重：\n$$\n\\hat{w}_C = \\frac{\\hat{\\mu}_C}{1+\\alpha\\hat{\\mu}_C} = \\frac{105}{1+(0.1)(105)} = \\frac{105}{1+10.5} = \\frac{105}{11.5}\n$$\n$$\n\\hat{w}_S = \\frac{\\hat{\\mu}_S}{1+\\alpha\\hat{\\mu}_S} = \\frac{210}{1+(0.1)(210)} = \\frac{210}{1+21} = \\frac{210}{22}\n$$\n设计矩阵 $X$ 和对角权重矩阵 $\\hat{W}$ 分别是：\n$$\nX = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  1 \\\\ 1  1 \\end{pmatrix}, \\quad \\hat{W} = \\text{diag}(\\hat{w}_C, \\hat{w}_C, \\hat{w}_S, \\hat{w}_S)\n$$\n在 $\\hat{\\beta}$ 处计算的费雪信息矩阵为：\n$$\n\\mathcal{I}(\\hat{\\beta}) = X^\\top \\hat{W} X = \\begin{pmatrix} 1  1  1  1 \\\\ 0  0  1  1 \\end{pmatrix} \\begin{pmatrix} \\hat{w}_C  0  0  0 \\\\ 0  \\hat{w}_C  0  0 \\\\ 0  0  \\hat{w}_S  0 \\\\ 0  0  0  \\hat{w}_S \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 2\\hat{w}_C+2\\hat{w}_S  2\\hat{w}_S \\\\ 2\\hat{w}_S  2\\hat{w}_S \\end{pmatrix}\n$$\n这个 $2 \\times 2$ 矩阵的逆矩阵是：\n$$\n\\mathcal{I}(\\hat{\\beta})^{-1} = \\frac{1}{\\det(\\mathcal{I}(\\hat{\\beta}))} \\begin{pmatrix} 2\\hat{w}_S  -2\\hat{w}_S \\\\ -2\\hat{w}_S  2\\hat{w}_C+2\\hat{w}_S \\end{pmatrix}\n$$\n行列式为 $\\det(\\mathcal{I}(\\hat{\\beta})) = (2\\hat{w}_C+2\\hat{w}_S)(2\\hat{w}_S) - (2\\hat{w}_S)^2 = 4\\hat{w}_C\\hat{w}_S$。\n$$\n\\mathcal{I}(\\hat{\\beta})^{-1} = \\frac{1}{4\\hat{w}_C\\hat{w}_S} \\begin{pmatrix} 2\\hat{w}_S  -2\\hat{w}_S \\\\ -2\\hat{w}_S  2\\hat{w}_C+2\\hat{w}_S \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2\\hat{w}_C}  -\\frac{1}{2\\hat{w}_C} \\\\ -\\frac{1}{2\\hat{w}_C}  \\frac{1}{2\\hat{w}_C}+\\frac{1}{2\\hat{w}_S} \\end{pmatrix}\n$$\n$\\hat{\\beta}_1$ 的方差是该矩阵的 $(2,2)$ 元素：\n$$\n\\operatorname{Var}(\\hat{\\beta}_1) = \\frac{1}{2\\hat{w}_C} + \\frac{1}{2\\hat{w}_S}\n$$\n代入权重的数值：\n$$\n\\operatorname{Var}(\\hat{\\beta}_1) = \\frac{1}{2(105/11.5)} + \\frac{1}{2(210/22)} = \\frac{11.5}{210} + \\frac{22}{420} = \\frac{23}{420} + \\frac{22}{420} = \\frac{45}{420}\n$$\n化简分数：$\\frac{45}{420} = \\frac{9}{84} = \\frac{3}{28}$。\n标准误是方差的平方根：\n$$\n\\text{SE}(\\hat{\\beta}_1) = \\sqrt{\\frac{3}{28}}\n$$\n\n#### 3. 沃尔德统计量计算\n\n现在我们可以计算沃尔德统计量：\n$$\nW = \\frac{\\hat{\\beta}_1}{\\text{SE}(\\hat{\\beta}_1)} = \\frac{\\ln(2)}{\\sqrt{3/28}} = \\ln(2) \\sqrt{\\frac{28}{3}}\n$$\n数值计算：\n$$\nW \\approx 0.693147 \\times \\sqrt{9.33333...} \\approx 0.693147 \\times 3.05505... \\approx 2.11763\n$$\n四舍五入到四位有效数字，沃尔德统计量为 $2.118$。\n\n#### 简要解释\n\n将计算出的沃尔德统计量 $W \\approx 2.118$ 与标准正态分布进行比较。其对应的双边p值为 $P(|Z| > 2.118) \\approx 0.034$，其中 $Z \\sim \\mathcal{N}(0,1)$。由于该p值小于常规的0.05显著性水平，因此有统计上显著的证据拒绝零假设 $H_{0}: \\beta_{1}=0$。这意味着，在给定模型的情况下，从对照组到刺激组观察到的均值表达量增加两倍不太可能仅仅是由随机机会造成的。我们可以得出结论，该细胞因子基因在刺激反应中存在显著的差异表达（上调）。",
            "answer": "$$\\boxed{2.118}$$"
        },
        {
            "introduction": "除了基因水平的表达量，RNA测序数据还能揭示mRNA加工过程中的变化，例如可变剪接。这项练习介绍了“剪接包含百分比”（PSI, $\\psi$）指标，用以量化外显子跳跃事件，并使用贝叶斯Beta-二项模型从跨越剪接点的读数中估计$\\psi$及其不确定性。这个动手计算展示了一种分析剪接异构体的原则性方法，并强调了在这些复杂测量中量化不确定性的重要性。",
            "id": "5157643",
            "problem": "一个单外显子跳跃的可变剪接事件在一个样本中通过RNA测序（RNA-seq）进行分析。三个剪接点和外显子体被读段（reads）覆盖：上游-外显子剪接点、外显子-下游剪接点、跳跃（上游-下游）剪接点以及外显子体。目标是量化包含水平（定义为剪接包含百分比，PSI），并使用Beta-二项分布框架量化其不确定性。对于此事件，您观察到以下唯一读段计数：上游-外显子剪接点读段 $J_{UE} = 120$，外显子-下游剪接点读段 $J_{ED} = 100$，跳跃剪接点读段 $J_{UD} = 80$，以及完全包含在外显子内的外显子体读段 $B = 60$。假设分子在不同异构体间均匀抽样，跨剪接点的读段具有固定的最小悬挂长度且可唯一比对，并且相对于跨剪接点的读段，外显子体读段存在长度偏倚，因此在以剪接点为中心的定义下，不应将其纳入剪接包含百分比（PSI）的估计量中。\n\n使用以下基本依据：\n- 在均匀抽样下，包含水平参数 $\\psi$ 是指为该事件随机选择的一个分子遵循包含异构体而非跳跃异构体的概率。\n- 跨剪接点的读段唯一地识别了异构体路径。因为包含路径产生两种不同的识别包含事件的剪接点类型，所以包含剪接点读段的总和必须进行归一化，以表示在与单一跳跃剪接点相同的尺度上抽样得到的包含分子数量。\n- 通过在 $\\psi$ 上设置一个Beta先验，并将标记包含事件的剪接点读段建模为成功概率为 $\\psi$ 的二项试验，可以得到一个共轭Beta-二项分布模型。\n\n任务：\n1. 从第一性原理出发，使用 $J_{UE}$、$J_{ED}$ 和 $J_{UD}$ 推导出一个以剪接点为中心的包含计数和总试验次数的估计量，该估计量与将 $\\psi$ 解释为包含与跳跃的伯努利试验成功概率的解释相容。\n2. 使用一个对称Beta先验，其先验均值 $\\mu_{0} = 0.5$ 且先验组内相关系数 $\\rho_{0} = 0.05$（因此对于先验Beta参数 $\\alpha_{0}$ 和 $\\beta_{0}$，有 $\\rho_{0} = 1/(\\alpha_{0} + \\beta_{0} + 1)$），在Beta-二项分布模型下，根据观察到的计数计算 $\\psi$ 的后验标准差。\n3. 仅报告 $\\psi$ 的后验标准差，以无量纲小数形式表示，并四舍五入至四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于分子生物学（可变剪接、RNA测序）和统计学（贝叶斯推断、Beta-二项分布模型）的原理。问题提法清晰、客观，并包含推导唯一解所需的所有必要信息。\n\n该问题需要一个分三部分的解答：首先，从剪接点读段计数中推导出包含事件和总事件的有效数量的估计量；其次，使用Beta-二项分布模型计算剪接包含百分比（$\\psi$）参数的后验标准差；第三，报告这个值。\n\n**第一部分：以剪接点为中心的估计量的推导**\n\n目标是估计参数 $\\psi$，它代表包含可变外显子的转录本的比例。我们已知来自三种剪接点的读段计数：\n-   $J_{UE} = 120$：跨越上游-外显子剪接点的读段，为包含异构体所特有。\n-   $J_{ED} = 100$：跨越外显子-下游剪接点的读段，也为包含异构体所特有。\n-   $J_{UD} = 80$：跨越跳跃剪接点（上游-下游）的读段，为跳跃异构体所特有。\n\n问题指定了一个以剪接点为中心的模型，并指出外显子体读段（$B=60$）存在偏倚，不应使用。核心挑战是如何将这些计数合并为一个一致的包含与跳跃事件的度量，以适用于二项似然框架。\n\n支持跳跃异构体的读段数 $S$ 由跳跃剪接点读段的计数直接给出：\n$$ S = J_{UD} = 80 $$\n然而，包含异构体为测序读段提供了两个不同的剪接点目标（$UE$ 和 $ED$）。简单的求和 $J_{UE} + J_{ED}$ 会相对于只有一个剪接点目标（$UD$）的跳跃异构体而言，过度代表包含异构体。问题指出，包含剪接点读段计数必须“进行归一化，以表示在与单一跳跃剪接点相同的尺度上抽样得到的包含分子数量”。\n\n在均匀抽样假设下，实现这种归一化的一个标准且有原则的方法是，对来自两个包含特异性剪接点的计数进行平均。这产生了一个有效的包含计数 $I$，它与跳跃计数 $S$ 在可比较的尺度上。\n$$ I = \\frac{J_{UE} + J_{ED}}{2} $$\n代入给定值：\n$$ I = \\frac{120 + 100}{2} = \\frac{220}{2} = 110 $$\n这个值 $I=110$ 代表了我们模型中“成功”（包含事件）的次数。总试验次数 $N$ 是有效包含计数和跳跃计数的总和：\n$$ N = I + S = 110 + 80 = 190 $$\n因此，我们二项模型的数据是 $N=190$ 次总事件中的 $I=110$ 次包含事件。\n\n**第二部分：Beta-二项分布建模与后验计算**\n\n我们使用Beta-二项分布模型来寻找 $\\psi$ 的后验分布。该模型定义如下：\n-   $\\psi$ 的先验分布：$\\psi \\sim \\text{Beta}(\\alpha_0, \\beta_0)$\n-   在 $N$ 次试验中观察到 $I$ 次包含事件的似然：$I | \\psi, N \\sim \\text{Binomial}(N, \\psi)$\n\n由于Beta先验和二项似然的共轭性，后验分布也是一个Beta分布：\n$$ \\psi | I, N \\sim \\text{Beta}(\\alpha', \\beta') $$\n其中 $\\alpha' = \\alpha_0 + I$ 且 $\\beta' = \\beta_0 + S = \\beta_0 + (N - I)$。\n\n首先，我们必须确定先验参数 $\\alpha_0$ 和 $\\beta_0$。我们已知一个对称先验，其均值 $\\mu_0 = 0.5$ 且组内相关系数 $\\rho_0 = 0.05$。\n对于一个 $\\text{Beta}(\\alpha_0, \\beta_0)$ 分布，其均值为 $\\mu_0 = \\frac{\\alpha_0}{\\alpha_0 + \\beta_0}$。条件 $\\mu_0 = 0.5$ 意味着 $\\alpha_0 = \\beta_0$。\n组内相关系数由公式 $\\rho_0 = \\frac{1}{\\alpha_0 + \\beta_0 + 1}$ 给出。代入 $\\beta_0 = \\alpha_0$ 和 $\\rho_0 = 0.05$：\n$$ 0.05 = \\frac{1}{\\alpha_0 + \\alpha_0 + 1} = \\frac{1}{2\\alpha_0 + 1} $$\n求解 $\\alpha_0$：\n$$ 2\\alpha_0 + 1 = \\frac{1}{0.05} = 20 $$\n$$ 2\\alpha_0 = 19 $$\n$$ \\alpha_0 = 9.5 $$\n因此，先验参数为 $\\alpha_0 = 9.5$ 和 $\\beta_0 = 9.5$。\n\n接下来，我们通过用我们的数据（$I=110$，$S=80$）更新先验来计算后验参数 $\\alpha'$ 和 $\\beta'$：\n$$ \\alpha' = \\alpha_0 + I = 9.5 + 110 = 119.5 $$\n$$ \\beta' = \\beta_0 + S = 9.5 + 80 = 89.5 $$\n$\\psi$ 的后验分布为 $\\text{Beta}(119.5, 89.5)$。\n\n最后一步是计算该后验分布的标准差。一个 $\\text{Beta}(\\alpha, \\beta)$ 分布的方差为：\n$$ \\text{Var}(\\psi) = \\frac{\\alpha\\beta}{(\\alpha + \\beta)^2 (\\alpha + \\beta + 1)} $$\n代入后验参数 $\\alpha' = 119.5$ 和 $\\beta' = 89.5$：\n$$ \\text{Var}(\\psi|\\text{data}) = \\frac{(119.5)(89.5)}{(119.5 + 89.5)^2 (119.5 + 89.5 + 1)} $$\n$$ \\text{Var}(\\psi|\\text{data}) = \\frac{10695.25}{(209)^2 (210)} = \\frac{10695.25}{(43681)(210)} = \\frac{10695.25}{9173010} $$\n后验标准差 $\\sigma_{\\psi|\\text{data}}$ 是方差的平方根：\n$$ \\sigma_{\\psi|\\text{data}} = \\sqrt{\\frac{10695.25}{9173010}} \\approx \\sqrt{0.0011660005} \\approx 0.03414675 $$\n\n**第三部分：最终答案报告**\n\n问题要求报告 $\\psi$ 的后验标准差，并四舍五入到四位有效数字。\n$$ 0.03414675 \\approx 0.03415 $$\n这个值代表了我们对包含水平 $\\psi$ 估计的不确定性。",
            "answer": "$$\n\\boxed{0.03415}\n$$"
        }
    ]
}