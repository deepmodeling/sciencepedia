{
    "hands_on_practices": [
        {
            "introduction": "在设计任何基于UMI的实验时，首要的挑战是确保UMI库的复杂度足以唯一地标记样本中的大多数分子。如果UMI库太小，不同的分子可能会被偶然标记上相同的UMI，这种“碰撞”现象会导致分子计数的严重低估。这项练习将引导您从第一性原理出发，推导出预期的UMI碰撞率，并计算出为满足特定实验精度要求所需的最小UMI长度，这是确保定量准确性的基础。",
            "id": "5169920",
            "problem": "在一种基于新一代测序 (NGS) 的高通量免疫诊断分析中，唯一分子标识符 (UMI) 被用来标记和去重原始分子，以精确估计其丰度。唯一分子标识符 (UMI) 是一个长度为 $L$ 的随机脱氧核糖核酸 (DNA) 寡核苷酸，其合成方式使得每个位置都从四种核苷酸中独立且均匀地选择。因此，总的 UMI 设计空间为 $M = 4^{L}$ 个不同的条形码。考虑一个包含 $n = 10^{6}$ 个不同分子的文库，每个分子都从 $M$ 种可能性中独立且均匀地被分配一个 UMI。\n\n将预期碰撞率 $\\rho(M,n)$ 定义为，文库中分配的 UMI 不唯一的分子所占的预期比例（以小数表示），这意味着存在至少一个其他分子共享相同的 UMI。仅从有放回独立抽样和 $M$ 个标签上均匀分布的基本概率定义出发，推导 $\\rho(M,n)$ 的一个闭式表达式，然后确定最小的整数 UMI 长度 $L$，使得 $\\rho(4^{L}, 10^{6})  0.01$。将最小整数 $L$ 作为你的最终答案。除了选择最小整数外，不需要进行四舍五入。",
            "solution": "该问题要求两个结果：首先，是预期碰撞率 $\\rho(M, n)$ 的闭式表达式；其次，是满足给定碰撞率条件的最小整数 UMI 长度 $L$。问题陈述科学合理、定义明确且客观。我们可以进行正式的推导。\n\n设 $n$ 为不同分子的数量，$M$ 为 UMI 设计空间的大小。$n$ 个分子中的每一个都通过从 $M$ 个可用的 UMI 中进行有放回的独立抽样来分配一个 UMI，每个 UMI 被选中的概率均为 $1/M$。\n\n我们需要求预期碰撞率 $\\rho(M, n)$，它被定义为所分配的 UMI 不唯一的分子所占的预期比例。设 $C$ 为表示具有非唯一 UMI（即至少有一个其他分子共享其 UMI）的分子总数的随机变量。这类分子的比例是 $C/n$。因此，预期碰撞率是 $\\rho(M, n) = E\\left[\\frac{C}{n}\\right]$。根据期望的线性性质，这等于 $\\frac{1}{n}E[C]$。\n\n为了求出 $C$ 的期望值，我们可以使用指示变量法。对于每个分子 $i \\in \\{1, 2, \\ldots, n\\}$，定义一个指示随机变量 $I_i$ 如下：\n$$\nI_i =\n\\begin{cases}\n1  \\text{如果分子 } i \\text{ 的UMI不唯一} \\\\\n0  \\text{如果分子 } i \\text{ 的UMI唯一}\n\\end{cases}\n$$\n具有非唯一 UMI 的分子总数是这些指示变量的总和：$C = \\sum_{i=1}^{n} I_i$。\n根据期望的线性性质，$C$ 的期望值为：\n$$E[C] = E\\left[\\sum_{i=1}^{n} I_i\\right] = \\sum_{i=1}^{n} E[I_i]$$\n对于指示变量，其期望等于它所指示事件的概率：$E[I_i] = P(I_i = 1)$。\n事件 $I_i = 1$ 发生在分配给分子 $i$ 的 UMI 不唯一时。计算其互补事件 $I_i = 0$（即分子 $i$ 的 UMI 是唯一的）的概率更为简单。\n$$P(I_i = 1) = 1 - P(I_i = 0)$$\n分配给分子 $i$ 的 UMI 是唯一的，当且仅当其他 $n-1$ 个分子没有一个被分配相同的 UMI。设 $U_i$ 是分配给分子 $i$ 的 UMI。对于任何其他分子 $j \\neq i$，其 UMI $U_j$ 与 $U_i$ 不同的概率是 $P(U_j \\neq U_i) = \\frac{M-1}{M}$。这是因为对于 $U_j$ 来说，在 $M$ 种总可能性中有 $M-1$ 个“成功”的结果。\n\n由于其他 $n-1$ 个分子中的每一个的 UMI 都是独立选择的，所以它们所有都与 $U_i$ 不同的概率是它们各自概率的乘积：\n$$P(I_i = 0) = \\left(\\frac{M-1}{M}\\right)^{n-1} = \\left(1 - \\frac{1}{M}\\right)^{n-1}$$\n因此，分子 $i$ 具有非唯一 UMI 的概率是：\n$$P(I_i = 1) = 1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}$$\n根据对称性，这个概率对于所有分子 $i=1, \\ldots, n$ 都是相同的。所以，对于所有 $i$，有 $E[I_i] = 1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}$。\n现在我们可以计算 $E[C]$：\n$$E[C] = \\sum_{i=1}^{n} \\left[1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}\\right] = n \\left[1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}\\right]$$\n最后，我们可以写出预期碰撞率 $\\rho(M, n)$ 的表达式：\n$$\\rho(M, n) = \\frac{E[C]}{n} = \\frac{n \\left[1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}\\right]}{n} = 1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}$$\n这就是所要求的闭式表达式。\n\n现在，我们必须找到最小的整数 UMI 长度 $L$，使得 $\\rho(4^L, 10^6)  0.01$。给定 $n = 10^6$ 且 UMI 设计空间为 $M = 4^L$。\n需要解的不等式是：\n$$1 - \\left(1 - \\frac{1}{4^L}\\right)^{10^6 - 1}  0.01$$\n让我们代入 $M = 4^L$ 和 $n = 10^6$：\n$$1 - \\left(1 - \\frac{1}{M}\\right)^{n-1}  0.01$$\n$$0.99  \\left(1 - \\frac{1}{M}\\right)^{n-1}$$\n为了解出 $M$，我们对两边取自然对数。由于 $\\ln(x)$ 是一个单调递增函数，不等式的方向保持不变：\n$$\\ln(0.99)  (n-1) \\ln\\left(1 - \\frac{1}{M}\\right)$$\n为了使预期碰撞率很小，$M$ 必须远大于 $n$。因此，$1/M$ 非常小。我们可以使用自然对数的泰勒级数近似，即当 $|x|$ 很小时，$\\ln(1+x) \\approx x$。令 $x = -1/M$。近似值为 $\\ln(1 - 1/M) \\approx -1/M$。在这个范围内，这个近似非常精确。\n将此代入不等式中：\n$$\\ln(0.99)  (n-1) \\left(-\\frac{1}{M}\\right) = -\\frac{n-1}{M}$$\n为了分离出 $M$，我们可以将两边同乘以 $-M$。由于 $M > 0$ 且 $\\ln(0.99)  0$，项 $-\\ln(0.99)$ 是正的。这个操作会反转不等号的方向：\n$$-M \\ln(0.99) > n-1$$\n$$M > \\frac{n-1}{-\\ln(0.99)}$$\n现在，我们代入数值 $n = 10^6$：\n$$M > \\frac{10^6 - 1}{-\\ln(0.99)} = \\frac{999999}{-\\ln(0.99)}$$\n使用计算器，$\\ln(0.99) \\approx -0.01005033585$。\n$$M > \\frac{999999}{0.01005033585} \\approx 99499119.4$$\n我们有关系式 $M = 4^L$。所以我们必须找到最小的整数 $L$ 使得：\n$$4^L > 99499119.4$$\n对两边取以 $4$ 为底的对数：\n$$L > \\log_4(99499119.4)$$\n这可以计算为：\n$$L > \\frac{\\ln(99499119.4)}{\\ln(4)}$$\n使用计算器计算对数：$\\ln(99499119.4) \\approx 18.415509$ 且 $\\ln(4) \\approx 1.386294$。\n$$L > \\frac{18.415509}{1.386294} \\approx 13.2839$$\n由于 UMI 长度 $L$ 必须是整数，满足此条件的最小整数值 $L$ 是 $14$。\n为了验证，我们检查一下这个阈值附近的 $4^L$ 的值：\n对于 $L=13$，$M = 4^{13} = 67,108,864$，小于所需的 $99,499,119.4$。\n对于 $L=14$，$M = 4^{14} = 268,435,456$，大于所需的 $99,499,119.4$。\n因此，最小的整数 UMI 长度是 $14$。",
            "answer": "$$\\boxed{14}$$"
        },
        {
            "introduction": "即使拥有足够多样性的UMI库，测序过程本身引入的错误也会对分子计数构成挑战。测序错误可能改变UMI序列，产生从未在原始分子上出现过的人工UMI，从而导致分子数量的虚假膨胀。这项练习旨在让您深入理解这一偏差的来源，通过数学建模来量化其影响，并推导出一个校正因子，以在数据分析中对观察到的分子计数进行调整，从而实现更精确的定量。",
            "id": "5169904",
            "problem": "在使用唯一分子标识符（UMI）的分子和免疫诊断工作流程中，去重过程通常假定UMI序列是无错误的，并且仅在UMI完全相同时才合并测序读数。考虑一个文库，其中每个原始分子都被一个长度为 $L$ 个碱基的UMI标记，该UMI从一个四核苷酸字母表中均匀选择（因此有 $4^{L}$ 种可能的UMI），并且每个分子产生恰好 $r$ 个独立的测序读数。假设每个碱基的测序错误率为 $e$，且在碱基和读数之间是独立的；当UMI中的任何碱基被错误测序时，得到的UMI序列会与真实的UMI不同。假设UMI空间足够大（即 $4^{L}$ 远大于每个分子的读数数量），以至于不同错误UMI之间，或错误UMI与来自另一个分子的真实UMI之间的碰撞可以忽略不计。\n\n从独立测序错误和基本概率的第一性原理出发，推导在去重过程中将UMI视为无错误所引入的期望乘性偏差。将偏差 $b(e,L,r)$ 定义为观测到的唯一UMI数量与真实分子数量之比的期望值减去 $1$，即 $b(e,L,r) = \\frac{\\mathbb{E}[M_{\\text{obs}}]}{N} - 1$，其中 $M_{\\text{obs}}$ 是经过精确匹配去重后观测到的唯一UMI的数量， $N$ 是真实的分子数量。接下来，提出了一个校正因子 $c(e,L,r)$，用它乘以观测到的唯一UMI计数，以使得到的估计量在所述假设下对 $N$ 是无偏的。\n\n将最终的偏差和校正因子表示为依赖于 $e$、$L$ 和 $r$ 的闭式解析表达式。不需要数值近似或四舍五入。您的答案必须是无单位的解析表达式。",
            "solution": "该问题要求在忽略唯一分子标识符（UMI）中的测序错误时，推导分子计数中的乘性偏差，以及一个相应的校正因子。解法将基于所提供的模型和假设，从概率论的第一性原理推导得出。\n\n首先，我们确定与测序单个UMI相关的基本概率。\n一个UMI的长度为 $L$ 个碱基。\n每个碱基的测序错误率为 $e$。\n单个碱基被正确测序的概率是 $1-e$。\n由于测序错误在碱基间是独立的，因此整个长度为 $L$ 的UMI被正确测序的概率是其 $L$ 个碱基各自被正确测序的概率的乘积。设此概率为 $p_c$。\n$$p_c = (1-e)^L$$\n一个UMI被错误测序（即至少有一个碱基出错）的概率是 $p_e$。\n$$p_e = 1 - p_c = 1 - (1-e)^L$$\n\n问题因一个关键假设而得以简化，即UMI空间足够大，使得碰撞可以忽略不计。这意味着：\n1.  任何两个生成的不同错误UMI序列都是唯一的。\n2.  任何错误的UMI序列都与原始样本中存在的任何真实UMI序列不同。\n实际上，每个产生错误UMI的测序事件都会创建一个前所未见的新的、唯一的标识符。多个读数被合并为单一计数的唯一方式是，它们都是无错误的，因此与亲代分子的真实UMI相同。\n\n让我们考虑一个单一的原始分子。它被一个真实的UMI标记，并产生恰好 $r$ 个独立的测序读数。设 $M_{\\text{obs},1}$ 是为这一个分子观测到的唯一UMI的数量。对于 $N$ 个分子，观测到的唯一UMI的总期望数量 $\\mathbb{E}[M_{\\text{obs}}]$ 可以通过利用期望的线性性质和无碰撞假设来找到。无碰撞假设确保了从不同原始分子生成的UMI集合是不相交的。因此，$\\mathbb{E}[M_{\\text{obs}}] = N \\cdot \\mathbb{E}[M_{\\text{obs},1}]$。我们需要求出 $\\mathbb{E}[M_{\\text{obs},1}]$。\n\n设 $K$ 为来自我们单个分子的 $r$ 个读数中的错误读数数量。每个读数都是一次独立的伯努利试验，其错误概率为 $p_e$。因此，$K$ 服从二项分布，$K \\sim \\text{Binomial}(r, p_e)$。\n\n我们可以通过以 $K$ 的值为条件来确定观测到的唯一UMI的数量 $M_{\\text{obs},1}$。\n如果 $K=k$ 且 $k \\in \\{0, 1, \\dots, r-1\\}$，则有 $k$ 个错误读数和 $r-k > 0$ 个正确读数。\n-   根据无碰撞假设，这 $k$ 个错误读数产生 $k$ 个不同的UMI。\n-   这 $r-k$ 个正确读数都产生相同的真实UMI。\n-   观测到的唯一UMI总数为 $k$ (来自错误) $+ 1$ (真实UMI) = $k+1$。\n如果 $K=r$，则所有 $r$ 个读数都是错误的。\n-   这 $r$ 个错误读数产生 $r$ 个不同的UMI。\n-   由于没有正确读数，因此观测不到真实的UMI。\n-   观测到的唯一UMI总数为 $r$。\n\n我们可以用 $K$ 来表示随机变量 $M_{\\text{obs},1}$：\n当 $K  r$ 时，$M_{\\text{obs},1} = K+1$；当 $K=r$ 时，$M_{\\text{obs},1} = r$。这可以使用指示函数 $I(K=r)$ 紧凑地写为：\n$$M_{\\text{obs},1} = K + 1 - I(K=r)$$\n其中，如果 $K=r$，$I(K=r)$ 为 $1$，否则为 $0$。\n\n现在我们可以利用期望的线性性质来求 $M_{\\text{obs},1}$ 的期望值：\n$$\\mathbb{E}[M_{\\text{obs},1}] = \\mathbb{E}[K + 1 - I(K=r)] = \\mathbb{E}[K] + 1 - \\mathbb{E}[I(K=r)]$$\n对于一个二项随机变量 $K \\sim \\text{Binomial}(r, p_e)$，其期望为 $\\mathbb{E}[K] = r \\cdot p_e$。\n指示函数的期望是该事件发生的概率：$\\mathbb{E}[I(K=r)] = P(K=r)$。\n对于二项分布，$P(K=r) = \\binom{r}{r} p_e^r (1-p_e)^{r-r} = p_e^r$。\n代入这些结果可得：\n$$\\mathbb{E}[M_{\\text{obs},1}] = r \\cdot p_e + 1 - p_e^r$$\n代入 $p_e$ 的表达式：\n$$\\mathbb{E}[M_{\\text{obs},1}] = 1 + r(1 - (1-e)^L) - (1 - (1-e)^L)^r$$\n这就是从单个真实分子生成的唯一UMI的期望数量。\n\n现在我们可以推导偏差 $b(e,L,r)$，其定义为 $\\frac{\\mathbb{E}[M_{\\text{obs}}]}{N} - 1$。\n$$b(e,L,r) = \\frac{N \\cdot \\mathbb{E}[M_{\\text{obs},1}]}{N} - 1 = \\mathbb{E}[M_{\\text{obs},1}] - 1$$\n$$b(e,L,r) = \\left( 1 + r(1 - (1-e)^L) - (1 - (1-e)^L)^r \\right) - 1$$\n$$b(e,L,r) = r(1 - (1-e)^L) - (1 - (1-e)^L)^r$$\n这个表达式代表了对真实分子数的期望分数高估。\n\n接下来，我们为 $N$ 的无偏估计量提出了一个校正因子 $c(e,L,r)$。该估计量为 $\\hat{N} = c(e,L,r) \\cdot M_{\\text{obs}}$。要使此估计量无偏，其期望值必须等于真实值 $N$：\n$$\\mathbb{E}[\\hat{N}] = N$$\n$$\\mathbb{E}[c(e,L,r) \\cdot M_{\\text{obs}}] = N$$\n由于 $c(e,L,r)$ 是一个确定性因子，我们有：\n$$c(e,L,r) \\cdot \\mathbb{E}[M_{\\text{obs}}] = N$$\n$$c(e,L,r) \\cdot (N \\cdot \\mathbb{E}[M_{\\text{obs},1}]) = N$$\n对 $N>0$ 求解 $c(e,L,r)$：\n$$c(e,L,r) = \\frac{1}{\\mathbb{E}[M_{\\text{obs},1}]}$$\n代入 $\\mathbb{E}[M_{\\text{obs},1}]$ 的表达式：\n$$c(e,L,r) = \\frac{1}{1 + r(1 - (1-e)^L) - (1 - (1-e)^L)^r}$$\n将观测到的唯一UMI计数 $M_{\\text{obs}}$ 乘以该因子，即可在所述假设下提供对真实分子数 $N$ 的无偏估计。",
            "answer": "$$\\boxed{\\begin{pmatrix} r(1 - (1-e)^{L}) - (1 - (1-e)^{L})^{r}  \\frac{1}{1 + r(1 - (1-e)^{L}) - (1 - (1-e)^{L})^{r}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "UMI策略的真正威力不仅在于精确计数，更在于其能显著提高检测的灵敏度和准确性，尤其是在稀有变异检测等应用中。通过将源自同一原始分子的所有测序读数（即一个“UMI家族”）归类，我们可以构建一个共有序列，有效滤除随机的测序噪声。这项练习将指导您构建一个复杂的贝叶斯模型，该模型不仅考虑了测序质量分数，还整合了先验概率和聚合酶错误模型，最终对一个UMI家族的真实碱基做出统计上稳健的判断，充分展示了UMI在精准诊断中的应用潜力。",
            "id": "5169827",
            "problem": "一项靶向免疫诊断检测采用独特分子标识符（UMI）家族，通过一致性来抑制测序错误。考虑一个基因组位点，其参考碱基为“G”。一个大小为 $n=8$ 的 UMI 家族在该位点提供了碱基检出结果：七个测序片段检出为“A”，其 Phred 质量分数 $Q$ 分别为 $35, 30, 33, 25, 38, 32, 34$；一个测序片段检出为“G”，其 Phred 质量分数为 $Q=40$。Phred 质量分数 $Q$ 与每个测序片段的碱基检出错误概率 $p$ 通过标准定义 $Q = -10 \\log_{10}(p)$ 相关，因此 $p = 10^{-Q/10}$。假设在给定 UMI 家族的潜在模板碱基的条件下，不同测序片段间的测序错误是独立的，并且替换错误会以相等的概率产生三种非真实碱基中的任意一种。\n\n为该 UMI 家族在此位点的潜在模板碱基建立两个互斥假设的模型：\n- $H_{V}$：原始分子在该位点确实是变异的，碱基为“A”。\n- $H_{R}$：原始分子在该位点确实是参考的，碱基为“G”。\n\n在感知 UMI 的贝叶斯建模中，纳入两个错误渠道：\n1. 每个测序片段的测序错误，其特征由每个测序片段的 $p_i = 10^{-Q_i/10}$ 描述。\n2. 一个家族层面的扩增前聚合酶错误，它以概率 $\\epsilon_{\\mathrm{pcr}}$ 将潜在的模板碱基从“G”转换为“A”，此后所有测序片段都源自这个不正确的模板。如果未发生家族层面的错误，则模板保持为“G”，且测序片段遵循每个测序片段的错误模型。\n\n设原始分子在该位点确实是变异的先验概率为 $\\pi_{V}$，确实是参考的先验概率为 $1 - \\pi_{V}$。使用以下参数：$\\pi_{V} = 1.0 \\times 10^{-5}$ 和 $\\epsilon_{\\mathrm{pcr}} = 1.0 \\times 10^{-6}$。使用 Bayes 定理和上述假设，为该 UMI 家族构建贝叶斯一致性模型，并推导该 UMI 家族的潜在模板碱基为变异“A”的后验概率 $P(H_{V} \\mid \\text{data})$。\n\n将最终概率表示为小数，并将您的答案四舍五入到四位有效数字。",
            "solution": "我们首先应用 Bayes 定理。对于由观测到的碱基检出及其 Phred 质量分数给出的数据 $\\mathcal{D}$，变异假设 $H_{V}$ 的后验概率为\n$$\nP(H_{V} \\mid \\mathcal{D}) = \\frac{P(\\mathcal{D} \\mid H_{V}) P(H_{V})}{P(\\mathcal{D} \\mid H_{V}) P(H_{V}) + P(\\mathcal{D} \\mid H_{R}) P(H_{R})},\n$$\n其中 $P(H_{V}) = \\pi_{V}$ 且 $P(H_{R}) = 1 - \\pi_{V}$。\n\n我们必须在所述的错误模型下计算似然 $P(\\mathcal{D} \\mid H_{V})$ 和 $P(\\mathcal{D} \\mid H_{R})$。\n\n在 $H_{V}$ 假设下，潜在的模板碱基是“A”。每个报告为“A”的测序片段是正确的，概率为 $1 - p_i$；每个报告为其他碱基之一的测序片段是错误的。对于那个报告为“G”的单个测序片段，根据均匀替换假设，在真实碱基为“A”且发生测序错误的条件下，特别观测到“G”的概率是 $p_8/3$。因此，\n$$\nL_{V} \\equiv P(\\mathcal{D} \\mid H_{V}) = \\left(\\prod_{i=1}^{7} (1 - p_i)\\right) \\cdot \\frac{p_8}{3}.\n$$\n\n在 $H_{R}$ 假设下，潜在的真实模板碱基是“G”，但由于存在家族层面的错误渠道，这里有一个混合模型。以概率 $\\epsilon_{\\mathrm{pcr}}$，一个早期的聚合酶错误将整个家族的模板转换为“A”，此后测序片段的生成过程和似然与 $H_{V}$ 的情况相匹配。以概率 $1 - \\epsilon_{\\mathrm{pcr}}$，没有发生家族层面的错误，模板保持为“G”。在这种无家族错误的情况下，一个报告为“G”的测序片段是正确的，概率为 $1 - p_i$，而一个报告为“A”的测序片段是一个特定的替换错误，概率为 $p_i/3$。因此，\n$$\nL_{R} \\equiv P(\\mathcal{D} \\mid H_{R}) = \\epsilon_{\\mathrm{pcr}} \\, L_{V} \\;+\\; (1 - \\epsilon_{\\mathrm{pcr}}) \\left[ \\left(\\prod_{i=1}^{7} \\frac{p_i}{3}\\right) \\cdot (1 - p_8) \\right].\n$$\n\n接下来，我们根据 Phred 分数计算每个测序片段的错误概率 $p_i = 10^{-Q_i/10}$：\n- 对于七个检出为“A”的测序片段：\n\n$$\n\\begin{aligned}\np_1 = 10^{-35/10} = 10^{-3.5} \\approx 3.162 \\times 10^{-4}, \\\\\np_2 = 10^{-30/10} = 10^{-3} = 1.000 \\times 10^{-3}, \\\\\np_3 = 10^{-33/10} = 10^{-3.3} \\approx 5.012 \\times 10^{-4}, \\\\\np_4 = 10^{-25/10} = 10^{-2.5} \\approx 3.162 \\times 10^{-3}, \\\\\np_5 = 10^{-38/10} = 10^{-3.8} \\approx 1.585 \\times 10^{-4}, \\\\\np_6 = 10^{-32/10} = 10^{-3.2} \\approx 6.310 \\times 10^{-4}, \\\\\np_7 = 10^{-34/10} = 10^{-3.4} \\approx 3.981 \\times 10^{-4},\n\\end{aligned}\n$$\n\n对于单个检出为“G”的测序片段：\n\n$$\np_8 = 10^{-40/10} = 10^{-4} = 1.000 \\times 10^{-4}.\n$$\n\n\n现在我们计算 $L_{V}$：\n\n$$\n\\prod_{i=1}^{7} (1 - p_i) \\approx (0.9996838)(0.9990000)(0.9994988)(0.9968377)(0.9998415)(0.9993690)(0.9996019) \\approx 0.9938458.\n$$\n\n因此，\n\n$$\nL_{V} = 0.9938458 \\times \\frac{p_8}{3} = 0.9938458 \\times \\frac{1.000 \\times 10^{-4}}{3} \\approx 3.3128 \\times 10^{-5}.\n$$\n\n\n接下来计算 $H_{R}$ 下的无家族错误部分：\n\n$$\n\\left(\\prod_{i=1}^{7} \\frac{p_i}{3}\\right) \\cdot (1 - p_8) = \\left(\\frac{1}{3}\\right)^{7} \\left(\\prod_{i=1}^{7} p_i\\right) \\cdot (1 - p_8).\n$$\n\n我们近似计算\n\n$$\n\\prod_{i=1}^{7} p_i \\approx (3.162 \\times 10^{-4})(1.000 \\times 10^{-3})(5.012 \\times 10^{-4})(3.162 \\times 10^{-3})(1.585 \\times 10^{-4})(6.310 \\times 10^{-4})(3.981 \\times 10^{-4}) \\approx 1.9953 \\times 10^{-23}.\n$$\n\n因为 $\\left(\\frac{1}{3}\\right)^{7} = \\frac{1}{3^{7}} = \\frac{1}{2187} \\approx 4.572 \\times 10^{-4}$ 且 $(1 - p_8) = 0.9999$，我们得到\n\n$$\n\\left(\\prod_{i=1}^{7} \\frac{p_i}{3}\\right) \\cdot (1 - p_8) \\approx (4.572 \\times 10^{-4})(1.9953 \\times 10^{-23})(0.9999) \\approx 9.116 \\times 10^{-27}.\n$$\n\n因此，\n\n$$\nL_{R} = \\epsilon_{\\mathrm{pcr}} \\, L_{V} + (1 - \\epsilon_{\\mathrm{pcr}}) \\times 9.116 \\times 10^{-27} \\approx (1.0 \\times 10^{-6})(3.3128 \\times 10^{-5}) + 9.116 \\times 10^{-27} \\approx 3.3128 \\times 10^{-11}.\n$$\n\n\n最后，应用 Bayes 定理，其中 $\\pi_{V} = 1.0 \\times 10^{-5}$：\n\n$$\nP(H_{V} \\mid \\mathcal{D}) = \\frac{\\pi_{V} L_{V}}{\\pi_{V} L_{V} + (1 - \\pi_{V}) L_{R}}.\n$$\n\n计算分子：\n\n$$\n\\pi_{V} L_{V} = (1.0 \\times 10^{-5})(3.3128 \\times 10^{-5}) = 3.3128 \\times 10^{-10}.\n$$\n\n计算分母：\n\n$$\n\\pi_{V} L_{V} + (1 - \\pi_{V}) L_{R} \\approx 3.3128 \\times 10^{-10} + (0.99999)(3.3128 \\times 10^{-11}) \\approx 3.3128 \\times 10^{-10} + 3.3128 \\times 10^{-11} = 3.6441 \\times 10^{-10}.\n$$\n\n因此，\n\n$$\nP(H_{V} \\mid \\mathcal{D}) \\approx \\frac{3.3128 \\times 10^{-10}}{3.6441 \\times 10^{-10}} \\approx 0.9091.\n$$\n\n表示为小数并四舍五入到四位有效数字，后验概率为 $0.9091$。",
            "answer": "$$\\boxed{0.9091}$$"
        }
    ]
}