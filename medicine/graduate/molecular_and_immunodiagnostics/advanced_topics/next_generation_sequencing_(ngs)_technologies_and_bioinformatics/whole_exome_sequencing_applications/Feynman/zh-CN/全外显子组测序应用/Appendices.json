{
    "hands_on_practices": [
        {
            "introduction": "全外显子组测序的成功在很大程度上依赖于最初的杂交捕获步骤，该步骤选择性地富集基因组的蛋白质编码区。本练习模拟了捕获目标DNA与洗去非特异性结合之间的微妙平衡，探讨了洗涤温度等物理参数如何影响最终的数据质量。通过推导并应用捕获效率模型，您将更深入地理解支撑测序数据分析的湿实验原理。",
            "id": "5171455",
            "problem": "一个临床分子诊断实验室对人类基因组DNA进行全外显子组测序(WES)杂交捕获，用于免疫遗传学应用。设可作图的全基因组区域大小为 $G = 3.2 \\times 10^{9}$ 个碱基，外显子组目标区域大小为 $B = 5.0 \\times 10^{7}$ 个碱基。定义基因组的目标区域分数为 $f_{b} = B/G$。在洗涤前的捕获过程中，预期有比例为 $e_{\\mathrm{on},0}$ 的靶向分子与探针发生有效杂交，有比例为 $e_{\\mathrm{off},0}$ 的非靶向分子发生交叉杂交。在温度 $T$ 下的洗涤步骤中，一个熔解温度为 $T_{m}$ 的结合双链被保留的概率为 $r(T,T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$，其中 $\\beta$ 是一个正常数，反映了双链稳定性对高于 $T_{m}$ 的温度的指数敏感性。假设有以下经实验支持的参数：$e_{\\mathrm{on},0} = 0.60$，$e_{\\mathrm{off},0} = 0.020$，$\\beta = 0.50$ (单位为摄氏度的倒数)，靶向双链的 $T_{m,\\mathrm{on}} = 80$ 摄氏度，主要的非靶向双链的 $T_{m,\\mathrm{off}} = 66$ 摄氏度。\n\n假设聚合酶链式反应 (PCR) 和测序对于靶向分子与非靶向分子是无偏的，因此在温度 $T$ 下捕获和洗涤后，靶向读段的比例（记作 $f_{\\mathrm{on}}(T)$）等于被保留的捕获分子中靶向分子的比例。将洗涤温度 $T$ 下的富集倍数定义为\n$$\n\\mathrm{FE}(T) = \\frac{f_{\\mathrm{on}}(T)}{f_{b}}.\n$$\n从 $f_{b}$，$e_{\\mathrm{on},0}$，$e_{\\mathrm{off},0}$ 和 $r(T,T_{m})$ 的定义出发，并利用捕获和洗涤过程中的分子数量守恒，推导 $\\mathrm{FE}(T)$ 的表达式，并用它计算当洗涤温度从 $T = 72$ 摄氏度增加到 $T = 76$ 摄氏度时，富集倍数的倍数变化。即，计算\n$$\nR = \\frac{\\mathrm{FE}(76)}{\\mathrm{FE}(72)}.\n$$\n将您的答案四舍五入到四位有效数字。将最终结果表示为无量纲数。",
            "solution": "目标是根据捕获、保留和比例测序的第一性原理推导 $\\mathrm{FE}(T)$，然后计算比率 $R = \\mathrm{FE}(76)/\\mathrm{FE}(72)$。\n\n基本定义和假设：\n1. 基因组的目标区域分数为 $f_{b} = B/G$。\n2. 洗涤前，预期被有效捕获的靶向分子的比例为 $e_{\\mathrm{on},0}$；对于非靶向分子，交叉杂交的比例为 $e_{\\mathrm{off},0}$。\n3. 在洗涤温度 $T$ 下，熔解温度为 $T_{m}$ 的双链的保留概率为 $r(T,T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$，这是一个经过充分检验的经验关系，反映了在温度高于 $T_{m}$ 时指数性的去稳定化效应。\n4. 假设下游步骤无偏，洗涤和测序后的靶向读段比例 $f_{\\mathrm{on}}(T)$ 等于被保留的捕获分子中靶向分子的比例。\n\n设输入分子的总数为 $N$。洗涤前被捕获的靶向分子的预期数量为 $N \\cdot f_{b} \\cdot e_{\\mathrm{on},0}$，洗涤前被捕获的非靶向分子的预期数量为 $N \\cdot (1 - f_{b}) \\cdot e_{\\mathrm{off},0}$。在温度 $T$ 下洗涤后，保留的计数变为\n$$\nC_{\\mathrm{on}}(T) = N \\cdot f_{b} \\cdot e_{\\mathrm{on},0} \\cdot r\\!\\big(T, T_{m,\\mathrm{on}}\\big),\n$$\n$$\nC_{\\mathrm{off}}(T) = N \\cdot (1 - f_{b}) \\cdot e_{\\mathrm{off},0} \\cdot r\\!\\big(T, T_{m,\\mathrm{off}}\\big).\n$$\n因此，被保留的捕获分子中靶向分子的比例为\n$$\nf_{\\mathrm{on}}(T) = \\frac{C_{\\mathrm{on}}(T)}{C_{\\mathrm{on}}(T) + C_{\\mathrm{off}}(T)} = \\frac{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)}.\n$$\n根据定义，富集倍数 $\\mathrm{FE}(T)$ 为：\n$$\n\\mathrm{FE}(T) = \\frac{f_{\\mathrm{on}}(T)}{f_{b}} = \\frac{1}{f_{b}} \\cdot \\frac{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)} = \\frac{e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big)}{f_{b} \\, e_{\\mathrm{on},0} \\, r\\!\\big(T, T_{m,\\mathrm{on}}\\big) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r\\!\\big(T, T_{m,\\mathrm{off}}\\big)}.\n$$\n我们需要的比率 $R$ 是：\n$$\nR = \\frac{\\mathrm{FE}(76)}{\\mathrm{FE}(72)} = \\frac{\\frac{e_{\\mathrm{on},0} \\, r(76, T_{m,\\mathrm{on}})}{f_{b} \\, e_{\\mathrm{on},0} \\, r(76, T_{m,\\mathrm{on}}) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(76, T_{m,\\mathrm{off}})}}{\\frac{e_{\\mathrm{on},0} \\, r(72, T_{m,\\mathrm{on}})}{f_{b} \\, e_{\\mathrm{on},0} \\, r(72, T_{m,\\mathrm{on}}) + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(72, T_{m,\\mathrm{off}})}}.\n$$\n现在我们用给定的参数计算。首先计算 $f_{b}$：\n$$\nf_{b} = \\frac{B}{G} = \\frac{5.0 \\times 10^{7}}{3.2 \\times 10^{9}} = \\frac{5.0}{320} = 0.015625.\n$$\n保留函数为 $r(T, T_{m}) = \\exp\\!\\big(-\\beta \\cdot \\max(0, T - T_{m})\\big)$，其中 $\\beta = 0.50$。对于 $T_{m,\\mathrm{on}} = 80$ 的靶向双链，\n$$\nr\\!\\big(72, 80\\big) = \\exp\\!\\big(-0.50 \\cdot \\max(0, 72 - 80)\\big) = \\exp(0) = 1,\n$$\n$$\nr\\!\\big(76, 80\\big) = \\exp\\!\\big(-0.50 \\cdot \\max(0, 76 - 80)\\big) = \\exp(0) = 1.\n$$\n对于 $T_{m,\\mathrm{off}} = 66$ 的非靶向双链，\n$$\nr\\!\\big(72, 66\\big) = \\exp\\!\\big(-0.50 \\cdot (72 - 66)\\big) = \\exp(-3),\n$$\n$$\nr\\!\\big(76, 66\\big) = \\exp\\!\\big(-0.50 \\cdot (76 - 66)\\big) = \\exp(-5).\n$$\n将这些保留概率代入 $R$ 的表达式。由于 $r(76, T_{m,\\mathrm{on}}) = r(72, T_{m,\\mathrm{on}}) = 1$，分子中的 $e_{\\mathrm{on},0}$ 项可以消去：\n$$\nR = \\frac{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(72, T_{m,\\mathrm{off}})}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, r(76, T_{m,\\mathrm{off}})} = \\frac{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, \\exp(-3)}{f_{b} \\, e_{\\mathrm{on},0} + (1 - f_{b}) \\, e_{\\mathrm{off},0} \\, \\exp(-5)}.\n$$\n现在代入数值 $f_{b} = 0.015625$，$e_{\\mathrm{on},0} = 0.60$，$e_{\\mathrm{off},0} = 0.020$：\n$$\nf_{b} \\, e_{\\mathrm{on},0} = 0.015625 \\times 0.60 = 0.009375,\n$$\n$$\n(1 - f_{b}) \\, e_{\\mathrm{off},0} = (1 - 0.015625) \\times 0.020 = 0.984375 \\times 0.020 = 0.0196875.\n$$\n因此，\n$$\nR = \\frac{0.009375 + 0.0196875 \\, \\exp(-3)}{0.009375 + 0.0196875 \\, \\exp(-5)}.\n$$\n为了便于数值计算，将分子和分母同乘以 $320 \\times 10 = 3200$ (不完全消除，但可简化) 或直接计算：\n$$\n\\exp(-3) \\approx 0.049787068, \\quad \\exp(-5) \\approx 0.006737947,\n$$\n得出\n$$\nR \\approx \\frac{0.009375 + 0.0196875 \\times 0.049787068}{0.009375 + 0.0196875 \\times 0.006737947} \\approx \\frac{0.009375 + 0.000980216}{0.009375 + 0.000132711} \\approx \\frac{0.010355216}{0.009507711} \\approx 1.089141856.\n$$\n四舍五入到四位有效数字，得到\n$$\nR \\approx 1.089.\n$$\n这个无量纲值量化了在所述模型和参数下，当洗涤温度从 $72$ 摄氏度增加到 $76$ 摄氏度时，富集倍数的预测倍数增长。",
            "answer": "$$\\boxed{1.089}$$"
        },
        {
            "introduction": "测序完成后，核心的生物信息学挑战是如何将真实的遗传变异与随机的测序错误区分开来。本实践从第一性原理出发，构建了一个模型，深入探讨了变异检测的统计学核心。通过应用二项分布，您将计算观察到杂合变异的概率，从而清晰地理解测序深度和错误率等因素如何决定我们对变异检测的置信度。",
            "id": "5171424",
            "problem": "在针对二倍体基因组中胚系单核苷酸变异的全外显子组测序 (WES) 检测中，考虑一个真实杂合的基因座。覆盖该基因座的读数存在独立的碱基检出错误，单个碱基的错误率为 $\\epsilon$，其中错误意味着真实的核苷酸被报告为三个不正确的核苷酸之一，且每种情况的概率相等。假设每个读数来自参考等位基因或变异等位基因的概率相等，并且在 $D$ 个覆盖读数中的读数抽样是独立的。“变异读数”定义为在该基因座上观察到的碱基与真实变异等位基因相匹配的读数，而不仅仅是一个非参考碱基。基于读数的独立性和杂合性（真实等位基因频率为 $\\frac{1}{2}$）的定义，使用二项抽样模型，从第一性原理出发，推导出在 $D$ 个总读数中观察到至少 $k$ 个变异读数的概率，该概率是 $D$、$k$ 和 $\\epsilon$ 的函数。将最终概率表示为关于 $D$、$k$ 和 $\\epsilon$ 的单个闭式解析表达式。无需进行数值评估。",
            "solution": "问题要求计算在 $D$ 个读数的样本中观察到至少 $k$ 个“变异读数”的概率。这些读数是独立的，每个读数成为“变异读数”的概率是确定的。这是二项分布的一个经典场景。设 $X$ 为随机变量，表示在 $D$ 个总读数中观察到的变异读数数量。那么 $X$ 服从二项分布，$X \\sim B(D, p)$，其中 $p$ 是单个随机选择的读数是“变异读数”的概率。我们的首要任务是推导出这个概率 $p$。\n\n一个读数可以源自参考等位基因或变异等位基因。由于该基因座在二倍体基因组中是杂合的，一个读数源自参考等位基因的概率是 $\\frac{1}{2}$，源自变异等位基因的概率也是 $\\frac{1}{2}$。设 $R_{alt}$ 表示一个读数源自变异等位基因的事件， $R_{ref}$ 表示一个读数源自参考等位基因的事件。我们有：\n$$P(R_{alt}) = \\frac{1}{2}$$\n$$P(R_{ref}) = \\frac{1}{2}$$\n\n设 $O_{alt}$ 为在读数中观察到的碱基是变异等位基因的事件（即，它是一个“变异读数”）。我们可以通过对读数的真实来源进行条件化，使用全概率定律来求得 $O_{alt}$ 的总概率：\n$$p = P(O_{alt}) = P(O_{alt} | R_{alt}) P(R_{alt}) + P(O_{alt} | R_{ref}) P(R_{ref})$$\n\n现在我们必须确定这两个条件概率：\n1.  $P(O_{alt} | R_{alt})$：这是在读数确实来自变异等位基因的条件下，观察到变异等位基因的概率。这种情况发生在碱基被正确读取时，其概率为 $1 - \\epsilon$。\n    $$P(O_{alt} | R_{alt}) = 1 - \\epsilon$$\n\n2.  $P(O_{alt} | R_{ref})$：这是在读数确实来自参考等位基因的条件下，观察到变异等位基因的概率。这种情况只有在发生测序错误时才会发生。发生错误的概率是 $\\epsilon$。问题陈述，当错误发生时，机器会以相等的概率报告三个不正确的核苷酸之一。由于真实的碱基是参考碱基，变异碱基是这三个不正确选项之一。因此，一个错误具体导致变异碱基的概率是 $\\frac{1}{3}$。组合概率是发生错误的概率与该错误产生变异碱基的概率的乘积。\n    $$P(O_{alt} | R_{ref}) = \\epsilon \\times \\frac{1}{3} = \\frac{\\epsilon}{3}$$\n\n将这些条件概率代回 $p$ 的方程中：\n$$p = (1 - \\epsilon) \\left(\\frac{1}{2}\\right) + \\left(\\frac{\\epsilon}{3}\\right) \\left(\\frac{1}{2}\\right)$$\n$$p = \\frac{1}{2} - \\frac{\\epsilon}{2} + \\frac{\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{3\\epsilon}{6} + \\frac{\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{2\\epsilon}{6}$$\n$$p = \\frac{1}{2} - \\frac{\\epsilon}{3}$$\n\n一个读数不是变异读数的互补概率是 $1-p$：\n$$1-p = 1 - \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right) = \\frac{1}{2} + \\frac{\\epsilon}{3}$$\n\n现在我们有了单次试验的概率 $p$，我们可以对 $D$ 次试验中变异读数的总数 $X$ 进行建模。在 $D$ 次试验中观察到恰好 $i$ 个变异读数的概率由二项概率质量函数给出：\n$$P(X=i) = \\binom{D}{i} p^i (1-p)^{D-i}$$\n\n问题要求的是观察到至少 $k$ 个变异读数的概率，即 $P(X \\ge k)$。这是观察到 $k, k+1, \\dots, D$ 个变异读数的概率之和：\n$$P(X \\ge k) = \\sum_{i=k}^{D} P(X=i)$$\n$$P(X \\ge k) = \\sum_{i=k}^{D} \\binom{D}{i} p^i (1-p)^{D-i}$$\n\n将 $p$ 和 $1-p$ 的表达式用 $\\epsilon$ 代入：\n$$P(X \\ge k) = \\sum_{i=k}^{D} \\binom{D}{i} \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right)^i \\left(\\frac{1}{2} + \\frac{\\epsilon}{3}\\right)^{D-i}$$\n\n这个表达式代表了最终答案。它是所求概率关于给定参数 $D$、$k$ 和 $\\epsilon$ 的一个单一、闭式解析表达式。",
            "answer": "$$\\boxed{\\sum_{i=k}^{D} \\binom{D}{i} \\left(\\frac{1}{2} - \\frac{\\epsilon}{3}\\right)^{i} \\left(\\frac{1}{2} + \\frac{\\epsilon}{3}\\right)^{D-i}}$$"
        },
        {
            "introduction": "将变异列表转化为临床可操作的生物标志物，是WES在精准医学中的关键应用。本练习专注于计算肿瘤突变负荷（TMB），这是预测免疫治疗反应的关键指标。您将学习到精确定义的重要性，例如仅使用“可调用区域”内的非同义突变，以确保TMB成为一个稳健且可重复的测量值。",
            "id": "4396805",
            "problem": "一家临床实验室对实体瘤及其匹配的正常组织进行全外显子组测序（WES），以估算肿瘤突变负荷（TMB），此处TMB定义为每兆碱基（megabase）可调用编码序列中非同义体细胞单核苷酸变异的数量。假设以下基本原则：分子生物学的中心法则确立了DNA是可遗传的基质，蛋白质编码序列（外显子组）源自于此；WES靶向蛋白质编码区域（外显子）；单核苷酸变异（SNV）是单个碱基的点突变；可调用区域（callable territory）是靶向碱基中符合预设质量标准（例如，测序深度阈值、比对质量和可比对性）的子集，以确保能够可靠地检测到体细胞变异；根据上述定义，TMB是在可调用编码兆碱基区域内非同义体细胞SNV的密度。\n\n对于单个肿瘤样本，通过与匹配的正常组织进行变异检出，在靶向编码区域中总共鉴定出$N_{\\text{SNV}}^{\\text{total}}=512$个体细胞单核苷酸变异。质量控制和功能注释在靶向外显子组内得出以下划分：\n- 在可调用编码区域内，检测到$N_{\\text{callable}}=438$个体细胞SNV。\n- 在这些可调用的SNV中，$N_{\\text{nonsyn}}=346$个为非同义变异，$N_{\\text{syn}}=92$个为同义变异。\n- 在可调用区域之外（测序深度低或可比对性差），检测到$N_{\\text{noncallable}}=74$个体细胞SNV；根据可调用区域的定义，这些变异被排除在TMB计算之外。\n\n应用实验室的质量过滤器后，可调用编码区域的长度为$L_{\\text{callable}}=28.7$兆碱基。\n\n从上述基本原则出发，推导在此定义下用于计算TMB的解析表达式，然后仅使用适当的计数和区域长度计算该样本的TMB。请以每个兆碱基的突变数表示您的最终答案，并将数值结果四舍五入到四位有效数字。",
            "solution": "该问题要求基于特定定义推导肿瘤突变负荷（TMB）的解析表达式，并随后计算给定肿瘤样本的TMB值。该过程始于对该定义的形式化陈述。\n\n问题将肿瘤突变负荷（TMB）定义为每兆碱基可调用编码序列中非同义体细胞单核苷酸变异的数量。让我们将这个定义形式化为一个数学表达式。\n\n设$TMB$代表肿瘤突变负荷。\n设$N_{\\text{nonsyn}}$为在可调用区域内识别出的非同义体细胞单核苷酸变异的数量。\n设$L_{\\text{callable}}$为可调用编码序列的长度，以兆碱基（Mb）为单位。\n\n根据“每兆碱基……的数量”这一定义，TMB是一个密度，其计算方法是相关变异的数量与计数它们所在的基因组区域长度之比。因此，解析表达式为：\n$$\nTMB = \\frac{N_{\\text{nonsyn}}}{L_{\\text{callable}}}\n$$\n该量的单位将是突变/兆碱基（mut/Mb）。\n\n问题提供了从肿瘤样本分析中得出的以下数据：\n- 靶向编码区域中的体细胞SNV总数：$N_{\\text{SNV}}^{\\text{total}} = 512$\n- 可调用编码区域内的体细胞SNV：$N_{\\text{callable}} = 438$\n- 可调用区域内的非同义体细胞SNV：$N_{\\text{nonsyn}} = 346$\n- 可调用区域内的同义体细胞SNV：$N_{\\text{syn}} = 92$\n- 可调用区域外的体细胞SNV：$N_{\\text{noncallable}} = 74$\n- 可调用编码区域长度：$L_{\\text{callable}} = 28.7$ Mb\n\n为了计算TMB，我们必须根据推导出的公式从该列表中选择正确的值。定义明确要求使用*非同义*SNV的数量。因此，我们必须使用$N_{\\text{nonsyn}} = 346$。其他计数，如同义SNV（$N_{\\text{syn}}$）、不可调用SNV（$N_{\\text{noncallable}}$）和SNV总数（$N_{\\text{SNV}}^{\\text{total}}$），与本问题陈述中定义的TMB计算无关。分母明确为*可调用*编码区域的长度，给定值为$L_{\\text{callable}} = 28.7$ Mb。\n\n将适当的值代入TMB的表达式中：\n$$\nTMB = \\frac{346}{28.7}\n$$\n\n现在，我们进行除法运算以获得一个数值：\n$$\nTMB \\approx 12.0557491289... \\text{ mut/Mb}\n$$\n\n问题要求最终答案四舍五入到四位有效数字。结果的前四位有效数字是$1$、$2$、$0$和$5$。第五位有效数字是$5$，这决定了我们需要将第四位有效数字向上取整。因此，$12.05$变为$12.06$。\n\n该样本最终计算出的TMB为$12.06$ mut/Mb。",
            "answer": "$$\\boxed{12.06}$$"
        }
    ]
}