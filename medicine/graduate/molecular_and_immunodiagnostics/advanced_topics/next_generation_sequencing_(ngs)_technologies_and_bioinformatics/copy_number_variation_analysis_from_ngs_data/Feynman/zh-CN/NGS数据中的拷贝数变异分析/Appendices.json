{
    "hands_on_practices": [
        {
            "introduction": "在基于读数深度的拷贝数变异（CNV）分析中，log2比率是量化基因组变化的通用语言。本练习旨在建立一个核心直觉：在理想化的纯二倍体样本中，一个特定的拷贝数变化（如杂合性缺失或单拷贝增益）会对应一个确切的期望log2比率。通过计算这些基准值，我们为解读更复杂的真实世界数据奠定了基础。",
            "id": "5104032",
            "problem": "一个临床分子和免疫诊断实验室对免疫检查点基因的靶向下一代测序（NGS）数据实施一个基于读取深度的拷贝数变异分析流程。假设存在以下基本关系：\n- 在基于读取深度的拷贝数推断中，当文库制备和捕获效率在所有样本中均一时，每个区段（bin）的期望读取计数与该位点的真实拷贝数 $c$ 成正比。\n- 一个匹配的二倍体参考样本具有基线倍性 $p$，并经过相同的处理。在对文库大小和技术协变量进行归一化后，测试位点与二倍体基线之间的归一化覆盖度的期望倍数变化是比率 $c/p$。\n- 该流程报告以 2 为底的对数转换倍数变化，以量化拷贝数的变动。\n\n在这些假设下，考虑一个基线倍性为 $p=2$ 的肿瘤样本的三种生物学上合理的拷贝数状态：拷贝数为 $c=1$ 的半合子缺失，拷贝数为 $c=3$ 的单拷贝增益，以及拷贝数为 $c=6$ 的高水平局灶性扩增。从读取计数与拷贝数的比例关系以及应用于倍数变化的以 2 为底的对数定义出发，推导每种状态的期望对数转换倍数变化。然后，在一个适用于NGS的计数模型（例如，泊松分布或过度离散的负二项分布）下，简要论证对数转换倍数变化的期望方差将如何随深度变化，并阐明所需的任何假设。\n\n将您的最终答案表示为这三种状态 $(c=1,\\,c=3,\\,c=6)$ 的无量纲以 2 为底的对数比率，按此顺序排列，并四舍五入到四位有效数字。将这三个值以单行矩阵的形式提供。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 每个区段的期望读取计数与真实拷贝数 $c$ 成正比。\n- 一个匹配的二倍体参考样本具有基线倍性 $p$。\n- 归一化覆盖度的期望倍数变化是比率 $c/p$。\n- 该流程报告以 2 为底的对数转换倍数变化。\n- 肿瘤样本的基线倍性为 $p=2$。\n- 考虑三种拷贝数状态：拷贝数为 $c=1$ 的半合子缺失，拷贝数为 $c=3$ 的单拷贝增益，以及拷贝数为 $c=6$ 的高水平局灶性扩增。\n- 任务是推导每种状态的期望对数转换倍数变化，并论证其方差随测序深度的变化规律。\n- 三个对数比率的最终答案必须四舍五入到四位有效数字，并以行矩阵形式呈现。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于从下一代测序（NGS）数据进行拷贝数变异（CNV）分析的标准原则。核心假设——归一化读取深度与潜在的拷贝数成正比——是这类生物信息学方法的根本基础。使用二倍体参考、倍数变化的log-2转换，以及使用泊松或负二项分布对读取计数进行建模，都是计算基因组学中已确立的标准实践。指定的拷贝数状态（$c=1, 3, 6$）是在癌症基因组中观察到的生物学上合理的现象。\n- **定义明确：** 问题定义清晰，提供了计算所要求值的所有必要信息。拷贝数（$c$）、倍性（$p$）和最终报告值（log-2倍数变化）之间的关系已明确说明。关于方差随深度变化的问题需要基于已知统计特性的定性论证，这是该领域的标准练习。\n- **客观性：** 问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n该问题具有科学合理性、定义明确、客观且完整。判定为**有效**。现在开始推导解决方案。\n\n该问题定义了拷贝数与报告的诊断值之间的定量关系。令 $L$ 代表对数转换的倍数变化。根据已知条件，该值计算为倍数变化的以 2 为底的对数，该倍数变化是测试样本拷贝数 $c$ 与参考样本基线倍性 $p$ 的比率。\n\n因此，公式为：\n$$L = \\log_2\\left(\\frac{c}{p}\\right)$$\n问题指明参考样本是二倍体样本，意味着它有两条相关染色体。因此，参考样本的基线倍性为 $p=2$。问题还指出肿瘤样本的基线倍性为 $p=2$，这与参考样本是匹配的正常样本相一致。对数倍数变化的计算使用的是参考样本的倍性。\n\n我们被要求计算肿瘤样本中三种不同拷贝数状态下 $L$ 的期望值：\n1.  **半合子缺失：** 拷贝数为 $c=1$。\n2.  **单拷贝增益：** 拷贝数为 $c=3$。\n3.  **高水平局灶性扩增：** 拷贝数为 $c=6$。\n\n对于每种情况，我们将 $c$ 和 $p$ 的值代入公式。\n\n情况1：半合子缺失 ($c=1$)\n$$L_1 = \\log_2\\left(\\frac{1}{2}\\right) = \\log_2(2^{-1}) = -1$$\n四舍五入到四位有效数字，结果是 $-1.000$。\n\n情况2：单拷贝增益 ($c=3$)\n$$L_2 = \\log_2\\left(\\frac{3}{2}\\right) = \\log_2(1.5)$$\n使用对数换底公式 $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$：\n$$L_2 = \\frac{\\ln(1.5)}{\\ln(2)} \\approx \\frac{0.405465}{0.693147} \\approx 0.5849625$$\n四舍五入到四位有效数字得到 $0.5850$。\n\n情况3：高水平局灶性扩增 ($c=6$)\n$$L_3 = \\log_2\\left(\\frac{6}{2}\\right) = \\log_2(3)$$\n$$L_3 = \\frac{\\ln(3)}{\\ln(2)} \\approx \\frac{1.098612}{0.693147} \\approx 1.5849625$$\n四舍五入到四位有效数字得到 $1.585$。\n\n接下来，我们论证对数转换倍数变化的方差如何随测序深度变化。令 $N_T$ 和 $N_R$ 分别为测试样本和参考样本在给定基因组区段中的归一化读取计数。它们是随机变量。对数比率为 $L = \\log_2(N_T/N_R)$。$L$ 的方差可以使用不确定性传播公式（德尔塔方法）进行近似。首先，为了方便，我们转换为自然对数，因为 $\\log_2(x) = \\ln(x)/\\ln(2)$，因此 $\\text{Var}(\\log_2(x)) = \\frac{1}{(\\ln 2)^2}\\text{Var}(\\ln(x))$。\n\n对于函数 $f(N_T, N_R) = \\ln(N_T) - \\ln(N_R)$，假设 $N_T$ 和 $N_R$ 是独立的（这是对独立测序样本的标准假设），方差为：\n$$\\text{Var}(L) \\approx \\frac{1}{(\\ln 2)^2} \\left[ \\left(\\frac{\\partial f}{\\partial N_T}\\right)^2 \\text{Var}(N_T) + \\left(\\frac{\\partial f}{\\partial N_R}\\right)^2 \\text{Var}(N_R) \\right]$$\n在均值 $\\mu_T = \\mathbb{E}[N_T]$ 和 $\\mu_R = \\mathbb{E}[N_R]$ 处求值的偏导数为 $\\frac{\\partial f}{\\partial N_T} = \\frac{1}{\\mu_T}$ 和 $\\frac{\\partial f}{\\partial N_R} = -\\frac{1}{\\mu_R}$。\n代入这些值得到：\n$$\\text{Var}(L) \\approx \\frac{1}{(\\ln 2)^2} \\left[ \\frac{\\text{Var}(N_T)}{\\mu_T^2} + \\frac{\\text{Var}(N_R)}{\\mu_R^2} \\right]$$\n这表明对数比率的方差取决于读取计数的变异系数（CV）的平方。平均读取计数 $\\mu$ 与测序深度 $D$ 成正比。让我们在建议的计数模型下分析 $\\text{Var}(N)/\\mu^2$ 这一项。\n\n假设1：**泊松模型**。对于NGS计数，一个简单的模型是泊松分布，其中 $\\text{Var}(N) = \\mu$。在这种情况下，CV的平方为：\n$$\\frac{\\text{Var}(N)}{\\mu^2} = \\frac{\\mu}{\\mu^2} = \\frac{1}{\\mu}$$\n因为 $\\mu$ 与测序深度 $D$ 成正比，我们有 $\\frac{1}{\\mu} \\propto \\frac{1}{D}$。因此，对于泊松模型，$\\text{Var}(L) \\propto \\frac{1}{D_T} + \\frac{1}{D_R}$。如果两个样本的深度 $D$ 相当，那么 $\\text{Var}(L) \\propto \\frac{1}{D}$。方差与测序深度成反比。\n\n假设2：**负二项（NB）模型**。真实的NGS数据通常表现出过度离散，即方差大于均值。NB模型通过一个离散参数 $\\alpha$ 来捕捉这一现象，使得 $\\text{Var}(N) = \\mu + \\alpha\\mu^2$。CV的平方为：\n$$\\frac{\\text{Var}(N)}{\\mu^2} = \\frac{\\mu + \\alpha\\mu^2}{\\mu^2} = \\frac{1}{\\mu} + \\alpha$$\n同样，由于 $\\mu \\propto D$，这一项与 $\\frac{1}{D} + \\alpha$ 成正比。因此，对数比率的方差表现为 $\\text{Var}(L) \\propto (\\frac{1}{D_T} + \\alpha_T) + (\\frac{1}{D_R} + \\alpha_R)$。随着深度 $D$ 增加，$\\frac{1}{D}$ 项减小，但方差会趋近于一个由离散参数（$\\alpha_T + \\alpha_R$）决定的非零下限。\n\n在两种合理的模型中，对数转换倍数变化的方差都随着测序深度的增加而减小。更高的深度会带来更精确、更可靠的拷贝数估计。NB模型更真实地预测，即使在非常高的深度下，由于纯粹的计数（散粒）噪声之外的生物和技术因素，仍然会存在一些方差。基本的尺度关系是方差与深度成反比关系。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1.000 & 0.5850 & 1.585\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "真实世界的肿瘤基因组往往表现出非整倍性，即其基线拷贝数并非标准的二倍体。本练习将上一节的概念进行推广，推导出观测到的log2比率、肿瘤基线倍性以及特定位点绝对拷贝数之间的普适性数学关系。掌握这种代数转换是从相对变化走向精确绝对拷贝数定量的关键一步。",
            "id": "5104093",
            "problem": "在根据新一代测序（NGS）的测序深度数据进行拷贝数变异分析时，经过适当的偏差校正（例如，通过全基因组范围对鸟嘌呤-胞嘧啶含量和可比对性进行标准化）后，一个标准的假设是：某个位点的预期测序深度与该位点的DNA绝对拷贝数成正比。设样本中某一位点的绝对拷贝数为 $c$，肿瘤的基线倍性为 $p$。假设拷贝数为 $x$ 时的预期测序深度为 $d_{x}$，并且通过一个未知的实验相关常数 $k$ 满足比例关系，因此 $d_{x} = k x$。设观测片段的深度为 $d = d_{c}$，基线片段的深度为 $d_{p}$。将对数转换的深度比 $r$ 定义为观测深度与基线深度之比以2为底的对数，即 $r = \\log_{2}\\!\\left(\\frac{d}{d_{p}}\\right)$。\n\n仅使用这些定义和比例性前提 $d_{x} = k x$，完成以下任务：\n- 推导一个连接对数转换深度比 $r$、绝对拷贝数 $c$ 和基线倍性 $p$ 的表达式。\n- 通过代数方法反转此关系，将 $c$ 明确地表示为 $r$ 和 $p$ 的函数。\n- 对 $p = 3.2$ 和 $r = -0.321928094$ 计算此表达式的值，并将绝对拷贝数报告为一个纯数字。将最终数值结果四舍五入至四位有效数字。答案中不要报告任何单位，也不要使用百分号。",
            "solution": "问题要求推导对数转换深度比 $r$、绝对拷贝数 $c$ 和基线倍性 $p$ 之间的关系，然后反转此关系以求解 $c$，最后进行数值计算。\n\n首先，确立相关的定义和前提。\n拷贝数为 $x$ 的位点的预期测序深度 $d_x$ 通过一个常数 $k$ 与 $x$ 成正比：\n$$d_x = kx$$\n观测片段的深度 $d$ 对应于绝对拷贝数 $c$，因此：\n$$d = d_c = kc$$\n基线片段的深度 $d_p$ 对应于基线倍性 $p$，因此：\n$$d_p = kp$$\n对数转换的深度比 $r$ 定义为：\n$$r = \\log_{2}\\!\\left(\\frac{d}{d_{p}}\\right)$$\n\n第一个任务是推导连接 $r$、$c$ 和 $p$ 的表达式。我们将 $d$ 和 $d_p$ 的表达式代入 $r$ 的定义中：\n$$r = \\log_{2}\\!\\left(\\frac{kc}{kp}\\right)$$\n未知的实验相关常数 $k$ 同时出现在分子和分母中，并且由于要使测序深度有意义，$k$ 必须为非零值，因此可以消掉：\n$$r = \\log_{2}\\!\\left(\\frac{c}{p}\\right)$$\n这就是连接对数转换深度比 $r$、绝对拷贝数 $c$ 和基线倍性 $p$ 的推导表达式。它表明测序深度的对数比等于其背后拷贝数的对数比，这是此类分析中的一个基本关系。\n\n第二个任务是通过代数方法反转此关系，将 $c$ 明确地表示为 $r$ 和 $p$ 的函数。我们从推导出的方程开始：\n$$r = \\log_{2}\\!\\left(\\frac{c}{p}\\right)$$\n为了分离出包含 $c$ 的项，我们对等式两边应用以2为底的指数函数。这是以2为底的对数运算的逆运算。\n$$2^r = 2^{\\log_{2}(c/p)}$$\n根据对数的定义 $a^{\\log_a(x)} = x$，右侧可以简化为：\n$$2^r = \\frac{c}{p}$$\n最后，为了解出 $c$，我们将等式两边乘以 $p$：\n$$c = p \\cdot 2^r$$\n这个方程将绝对拷贝数 $c$ 表示为基线倍性 $p$ 和对数转换深度比 $r$ 的函数。\n\n第三个任务是使用给定的值 $p = 3.2$ 和 $r = -0.321928094$ 计算此表达式。\n我们将这些值代入 $c$ 的表达式中：\n$$c = 3.2 \\times 2^{-0.321928094}$$\n为了计算 $2^{-0.321928094}$ 这一项，我们可以认识到指数是一个特定的对数值。让我们验证一下 $r$ 是否等于 $\\log_2(4/5)$。\n$$ \\log_{2}\\!\\left(\\frac{4}{5}\\right) = \\log_{2}(4) - \\log_{2}(5) = 2 - \\log_{2}(5) $$\n使用 $\\log_{2}(5) \\approx 2.321928094$ 的标准值，我们得到：\n$$ \\log_{2}\\!\\left(\\frac{4}{5}\\right) \\approx 2 - 2.321928094 = -0.321928094 $$\n指数的值恰好对应于 $\\log_2(4/5)$。因此，我们可以将其代回 $c$ 的计算中：\n$$c = 3.2 \\times 2^{\\log_{2}(4/5)}$$\n再次使用性质 $a^{\\log_a(x)} = x$，表达式简化为：\n$$c = 3.2 \\times \\frac{4}{5}$$\n将分数转换为小数，$\\frac{4}{5} = 0.8$：\n$$c = 3.2 \\times 0.8$$\n进行乘法运算：\n$$c = 2.56$$\n问题要求最终数值结果四舍五入至四位有效数字。计算出的值 $2.56$ 可以通过在末尾添加一个零来表示为四位有效数字：$2.560$。",
            "answer": "$$\\boxed{2.560}$$"
        },
        {
            "introduction": "在临床样本中，肿瘤纯度是影响CNV信号检测的主要混杂因素，因为样本总是肿瘤细胞和正常细胞的混合体。这种混合会“稀释”或减弱原始的CNV信号。本高级练习将探讨如何数学建模这种信号衰减效应，并演示如何利用来自不同CNV事件的观测信号强度来反推估算肿瘤纯度，这是实现精准解读的关键参数。",
            "id": "5104100",
            "problem": "在使用新一代测序（NGS）的靶向肿瘤学检测中，拷贝数变异（CNV）的识别是通过比较肿瘤样本与配对的正常对照样本中的标准化读取深度来完成的。假设以下基本原则：(i) 标准化读取深度与被检测区域的DNA绝对拷贝数成正比，(ii) 肿瘤样本由肿瘤细胞和非肿瘤（正常）细胞混合而成，其中肿瘤纯度 $\\pi$ 代表肿瘤细胞的比例，(iii) 正常细胞具有基线倍性 $p$，以及 (iv) 对数比信号定义为肿瘤覆盖度与正常覆盖度之比的以2为底的对数。考虑一个具有克隆性肿瘤拷贝状态 $c_t$ 和基线倍性 $p$ 的基因组片段，并设 $r$ 表示在这些假设下该片段的期望对数比信号。\n\n任务1（推导）：从读取深度与绝对拷贝数的比例关系以及肿瘤和正常细胞混合贡献的线性关系出发，推导出一个用 $\\pi$、$c_t$ 和 $p$ 表示 $r$ 的闭式表达式。\n\n任务2（应用以解释振幅）：在一个基线倍性 $p=2$ 的免疫肿瘤学基因组合中，通过正交的等位基因特异性分析观察到两个具有已知克隆性肿瘤状态的独立片段：片段A的 $c_t=1$（单拷贝缺失），片段B的 $c_t=3$（单拷贝增加）。它们观测到的对数比振幅（由标准化读取深度计算得出）分别为 $r_A=-0.32193$ 和 $r_B=0.26303$。根据任务1中的模型，计算一个与这两个片段都一致的单一肿瘤纯度 $\\pi$。\n\n报告最终的 $\\pi$ 值，四舍五入至三位有效数字，并以小数形式（无单位）表示。在最终答案中仅提供数值。",
            "solution": "问题陈述已经过严格审查，并被认为是有效的。它在科学上基于从批量新一代测序数据推断拷贝数变异的标准理论模型，问题设定良好，信息充分且一致，足以得出一个唯一解，并以客观、正式的语言表述。没有发现与科学不健全、不完整或模糊性相关的可识别缺陷。\n\n解答按要求分为两部分进行。\n\n**任务1：对数比信号表达式的推导**\n\n设 $D$ 表示标准化读取深度，$C$ 表示基因组片段的绝对DNA拷贝数。\n根据原则(i)，读取深度与拷贝数成正比。我们可以用一个比例常数 $k$ 来表示这种关系：\n$$D = kC$$\n对于配对的正常对照样本，细胞被假定为二倍体（或具有一个普遍的基线倍性 $p$），因此绝对拷贝数为 $C_{normal} = p$。相应的标准化读取深度为：\n$$D_{normal} = kp$$\n对于肿瘤样本，它是一个细胞混合物，其总读取深度由整个细胞群体的平均绝对拷贝数决定。根据原则(ii)，样本由比例为 $\\pi$ 的肿瘤细胞和比例为 $(1-\\pi)$ 的非肿瘤（正常）细胞组成。肿瘤细胞具有克隆性拷贝状态 $c_t$，而正常细胞的拷贝数为 $p$。肿瘤样本中的平均绝对拷贝数 $C_{tumor\\_mix}$ 是组成细胞类型拷贝数的加权平均值：\n$$C_{tumor\\_mix} = \\pi \\cdot c_t + (1-\\pi) \\cdot p$$\n因此，肿瘤样本的期望标准化读取深度为：\n$$D_{tumor\\_mix} = k \\cdot C_{tumor\\_mix} = k(\\pi c_t + (1-\\pi)p)$$\n对数比信号 $r$ 定义为肿瘤覆盖度与正常覆盖度之比的以2为底的对数。代入 $D_{tumor\\_mix}$ 和 $D_{normal}$ 的表达式：\n$$r = \\log_2\\left(\\frac{D_{tumor\\_mix}}{D_{normal}}\\right) = \\log_2\\left(\\frac{k(\\pi c_t + (1-\\pi)p)}{kp}\\right)$$\n比例常数 $k$（其值取决于测序技术和文库制备）在比率中被抵消。这种抵消是基于对数比的CNV分析鲁棒性的基础。最终的 $r$ 的闭式表达式为：\n$$r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)p}{p}\\right)$$\n这个表达式可以稍作整理，以突出与基线的偏差：\n$$r = \\log_2\\left(\\frac{\\pi c_t + p - \\pi p}{p}\\right) = \\log_2\\left(1 + \\frac{\\pi(c_t - p)}{p}\\right)$$\n\n**任务2：应用计算肿瘤纯度**\n\n问题提供了一个基线倍性 $p=2$ 的检测中两个片段的数据。我们需要计算一个与这两个片段的数据都一致的单一肿瘤纯度 $\\pi$。\n\n推导出的表达式为 $r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)p}{p}\\right)$。当 $p=2$ 时，该表达式变为：\n$$r = \\log_2\\left(\\frac{\\pi c_t + (1-\\pi)2}{2}\\right)$$\n\n对于片段A：$c_t = 1$（单拷贝缺失）且 $r_A = -0.32193$。\n将这些值代入表达式：\n$$-0.32193 = \\log_2\\left(\\frac{\\pi(1) + (1-\\pi)2}{2}\\right)$$\n$$-0.32193 = \\log_2\\left(\\frac{\\pi + 2 - 2\\pi}{2}\\right)$$\n$$-0.32193 = \\log_2\\left(\\frac{2 - \\pi}{2}\\right)$$\n为了求解 $\\pi$，我们对两边取以2为底的指数：\n$$2^{-0.32193} = \\frac{2 - \\pi}{2}$$\n数值 $-0.32193$ 是 $\\log_2(0.8)$ 的一个高精度近似值。因此，$2^{-0.32193} \\approx 0.8$。\n$$0.8 = \\frac{2 - \\pi}{2}$$\n$$1.6 = 2 - \\pi$$\n$$\\pi = 2 - 1.6 = 0.4$$\n\n对于片段B：$c_t = 3$（单拷贝增加）且 $r_B = 0.26303$。\n我们进行类似的代入来验证 $\\pi$ 的一致性。\n$$0.26303 = \\log_2\\left(\\frac{\\pi(3) + (1-\\pi)2}{2}\\right)$$\n$$0.26303 = \\log_2\\left(\\frac{3\\pi + 2 - 2\\pi}{2}\\right)$$\n$$0.26303 = \\log_2\\left(\\frac{2 + \\pi}{2}\\right)$$\n对两边取指数：\n$$2^{0.26303} = \\frac{2 + \\pi}{2}$$\n数值 $0.26303$ 是 $\\log_2(1.2)$ 的一个高精度近似值。因此，$2^{0.26303} \\approx 1.2$。\n$$1.2 = \\frac{2 + \\pi}{2}$$\n$$2.4 = 2 + \\pi$$\n$$\\pi = 2.4 - 2 = 0.4$$\n两个片段独立地得出了 $\\pi = 0.4$ 的肿瘤纯度。这证实了在所推导的模型下，所提供数据的内部一致性。\n\n问题要求最终的 $\\pi$ 值四舍五入至三位有效数字。数值 $0.4$ 表示为三位有效数字是 $0.400$。",
            "answer": "$$\\boxed{0.400}$$"
        }
    ]
}