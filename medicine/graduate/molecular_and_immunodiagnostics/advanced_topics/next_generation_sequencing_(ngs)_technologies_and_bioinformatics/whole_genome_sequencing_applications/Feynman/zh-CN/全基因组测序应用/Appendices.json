{
    "hands_on_practices": [
        {
            "introduction": "在解读任何全基因组测序数据之前，首要任务是评估其分析流程的准确性。本练习将引导你应用诊断测试评估中的核心指标，如灵敏度（$\\\\text{sensitivity}$）、特异性（$\\\\text{specificity}$）和精确度（$\\\\text{precision}$），来量化变异检测流程的性能。掌握这些基本计算，对于进行质量控制和理解生物信息学分析流程中不同参数设置下的性能权衡至关重要。",
            "id": "5171851",
            "problem": "一个为分子和免疫诊断实施全基因组测序 (WGS) 的实验室，开发了一套变异检出流程，用于在单个样本中一个包含 $1{,}200{,}000$ 个位点的可检出区域内，检测与免疫功能基因相关的基因组变异。该样本的一个经过审定的金标准真实数据集表明，有 $2{,}400$ 个位点是真正的变异位点（阳性），其余位点是真正的非变异位点（阴性）。该流程在每个位点上的预测结果与真实数据集进行比较，得到以下混淆计数：真阳性 $TP = 2{,}312$，假阳性 $FP = 64$，假阴性 $FN = 88$，以及真阴性 $TN = 1{,}197{,}536$。\n\n从诊断测试和二元分类的核心定义出发，其中“阳性”事件对应“位点存在变异”，“阴性”事件对应“位点不存在变异”，请用 $TP$、$FP$、$TN$ 和 $FN$ 推导灵敏度（真阳性率）、特异度（真阴性率）、精确率（阳性预测值）、召回率以及 $F_{1}$-分数的表达式。然后根据给定的计数计算这五个指标。将每个计算出的指标四舍五入到四位有效数字，并以小数形式表示结果。最终答案必须是一个单行向量，按顺序依次列出灵敏度、特异度、精确率、召回率和 $F_{1}$-分数。",
            "solution": "该问题提供了一组来自全基因组测序 (WGS) 变异检出流程的混淆矩阵计数，并要求推导和计算五个标准性能指标。首先，我们必须验证问题的陈述。\n\n已知条件如下：\n- 总可检出位点数：$1,200,000$\n- 真实数据集中的真阳性（实际变异）：$2,400$\n- 真实数据集中的真阴性（实际非变异）：$1,200,000 - 2,400 = 1,197,600$\n- 流程的混淆计数：\n  - 真阳性 ($TP$): $2,312$\n  - 假阳性 ($FP$): $64$\n  - 假阴性 ($FN$): $88$\n  - 真阴性 ($TN$): $1,197,536$\n\n我们检查内部一致性。\n实际阳性的总数是正确识别的变异 ($TP$) 和漏检的变异 ($FN$) 的总和：\n$P = TP + FN = 2,312 + 88 = 2,400$。这与给定的真实变异位点数相符。\n实际阴性的总数是正确识别的非变异 ($TN$) 和被错误判断为变异的非变异 ($FP$) 的总和：\n$N = TN + FP = 1,197,536 + 64 = 1,197,600$。这与计算出的真实非变异位点数相符。\n总位点数是 $P + N = 2,400 + 1,197,600 = 1,200,000$，这与总可检出区域的大小相符。\n该问题是自洽的，在生物信息学和诊断学领域具有科学依据，并且内部一致。这是一个有效的、定义明确的问题。\n\n我们现在开始解题。核心任务是推导并计算灵敏度、特异度、精确率、召回率和 $F_1$-分数。 “阳性”事件指位点存在变异，“阴性”事件指位点不存在变异。\n\n1.  **灵敏度 (真阳性率, TPR)**\n    灵敏度衡量在所有实际为阳性的样本中，被测试正确识别为阳性的比例。它是在位点确实是变异的情况下，测试结果为阳性的概率。实际阳性的总数是 $P = TP + FN$。\n    灵敏度的表达式为：\n    $$ \\text{Sensitivity} = \\frac{TP}{P} = \\frac{TP}{TP + FN} $$\n    在信息检索和机器学习领域，**召回率 (Recall)** 是灵敏度的同义词。因此，召回率的表达式是相同的：\n    $$ \\text{Recall} = \\frac{TP}{TP + FN} $$\n\n2.  **特异度 (真阴性率, TNR)**\n    特异度衡量在所有实际为阴性的样本中，被测试正确识别为阴性的比例。它是在位点确实是非变异的情况下，测试结果为阴性的概率。实际阴性的总数是 $N = TN + FP$。\n    特异度的表达式为：\n    $$ \\text{Specificity} = \\frac{TN}{N} = \\frac{TN}{TN + FP} $$\n\n3.  **精确率 (阳性预测值, PPV)**\n    精确率衡量在所有被预测为阳性的样本中，实际为阳性的比例。它是在测试结果为阳性的情况下，位点确实是变异的概率。被预测为阳性的总数是 $TP + FP$。\n    精确率的表达式为：\n    $$ \\text{Precision} = \\frac{TP}{TP + FP} $$\n\n4.  **$F_1$-分数**\n    $F_1$-分数是精确率和召回率的调和平均数。它是一个同时考虑了假阳性和假阴性的平衡指标。$F$-分数的通用公式为 $F_{\\beta} = (1+\\beta^2) \\frac{\\text{Precision} \\cdot \\text{Recall}}{(\\beta^2 \\cdot \\text{Precision}) + \\text{Recall}}$。$F_1$-分数设定 $\\beta = 1$。\n    $F_1$-分数的表达式为：\n    $$ F_1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} $$\n    将精确率和召回率的表达式用 $TP$、$FP$ 和 $FN$ 代入：\n    $$ F_1 = 2 \\cdot \\frac{\\left( \\frac{TP}{TP+FP} \\right) \\cdot \\left( \\frac{TP}{TP+FN} \\right)}{\\left( \\frac{TP}{TP+FP} \\right) + \\left( \\frac{TP}{TP+FN} \\right)} = \\frac{2 \\cdot \\frac{TP^2}{(TP+FP)(TP+FN)}}{\\frac{TP(TP+FN) + TP(TP+FP)}{(TP+FP)(TP+FN)}} = \\frac{2 \\cdot TP^2}{TP(TP+FN) + TP(TP+FP)} $$\n    化简后得到：\n    $$ F_1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} $$\n\n现在，我们使用给定的计数来计算这五个指标：$TP = 2,312$，$FP = 64$，$FN = 88$，$TN = 1,197,536$。我们将每个结果四舍五入到四位有效数字。\n\n-   **灵敏度 / 召回率**：\n    $$ \\text{Sensitivity} = \\text{Recall} = \\frac{2,312}{2,312 + 88} = \\frac{2,312}{2,400} = 0.963333... \\approx 0.9633 $$\n\n-   **特异度**：\n    $$ \\text{Specificity} = \\frac{1,197,536}{1,197,536 + 64} = \\frac{1,197,536}{1,197,600} = 0.999946559... \\approx 0.9999 $$\n\n-   **精确率**：\n    $$ \\text{Precision} = \\frac{2,312}{2,312 + 64} = \\frac{2,312}{2,376} = 0.973063973... \\approx 0.9731 $$\n\n-   **$F_1$-分数**：\n    使用简化公式：\n    $$ F_1 = \\frac{2 \\cdot 2,312}{2 \\cdot 2,312 + 64 + 88} = \\frac{4,624}{4,624 + 152} = \\frac{4,624}{4,776} = 0.9681741... \\approx 0.9682 $$\n\n最终计算值，四舍五入到四位有效数字，如下：\n- 灵敏度: $0.9633$\n- 特异度: $0.9999$\n- 精确率: $0.9731$\n- 召回率: $0.9633$\n- $F_1$-分数: $0.9682$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9633  0.9999  0.9731  0.9633  0.9682\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在评估了测序数据的整体质量后，我们将深入探讨其在肿瘤基因组学中的一个核心应用。本练习要求你从基本原理出发，推导出一个连接观察到的变异等位基因频率（$VAF$）、肿瘤纯度（$p$）及局部拷贝数（$CN$）的关键数学模型。通过亲手构建此模型，你将深刻理解如何定量解读体细胞突变信号，从而推断肿瘤样本的生物学特性。",
            "id": "5171705",
            "problem": "一个临床分子和免疫诊断实验室使用全基因组测序 (WGS) 来量化含有肿瘤和正常细胞混合物的肿瘤活检样本中的体细胞单核苷酸变异 (SNV)。变异等位基因频率 (VAF) 定义为在覆盖该位点的所有测序读数中，携带变异等位基因的读数的预期比例。假设以下被广泛接受的WGS抽样和肿瘤-正常细胞混合模型：\n- 测序读数是从样本中存在的等位基因拷贝中均匀随机抽取的，且读数计数反映了潜在的等位基因拷贝数。\n- 活检样本是肿瘤细胞和正常细胞的混合物，其中肿瘤细胞的比例（肿瘤纯度）为 $p$，正常细胞的比例为 $(1-p)$。\n- 正常细胞在该位点是二倍体，总拷贝数为 $2$，并且不携带体细胞SNV的变异等位基因。\n- 肿瘤细胞在该位点的总拷贝数为 $CN$，并且该体细胞SNV是克隆性的（存在于所有肿瘤细胞中）和杂合的，意味着在每个肿瘤细胞的 $CN$ 个等位基因拷贝中，它恰好存在于其中一个拷贝上。\n仅使用这些定义和假设，推导预期VAF作为 $p$ 和 $CN$ 的函数的封闭形式表达式。你的最终答案必须是一个单一的解析表达式。除了 $p$ 和 $CN$ 之外，不要引入任何其他变量。不需要四舍五入，最终答案中也不应包含任何单位。",
            "solution": "该问题要求推导在一个混合的肿瘤-正常细胞样本中，预期变异等位基因频率 (VAF) 的封闭形式表达式。VAF定义为在覆盖该位点的所有测序读数中，携带变异等位基因的读数的预期比例。基于所提供的假设，即读数计数是均匀抽样的并反映了潜在的等位基因拷贝数，VAF可以建模为活检样本整个细胞群中，特定位点上变异等位基因拷贝总数与所有等位基因拷贝总数的比率。\n\n设肿瘤纯度，即活检样本中肿瘤细胞的比例，用 $p$ 表示，其中 $0 \\le p \\le 1$。因此，正常细胞的比例是 $1-p$。\n\n我们将计算一个代表性样本中该位点上变异等位基因的总数和所有等位基因的总数。由于我们计算的是一个比例，样本中细胞的绝对数量无关紧要；我们可以直接使用每种细胞类型的比例及其遗传内容进行计算。对总等位基因池的贡献由细胞比例及其各自的拷贝数加权。\n\n首先，我们确定VAF表达式的分子：变异等位基因拷贝的总数。\n变异等位基因的总数是来自正常细胞群和肿瘤细胞群贡献的总和。\n- **正常细胞：** 这些细胞占细胞群体的比例为 $1-p$。根据题目陈述，正常细胞是二倍体，并且不携带体细胞SNV的变异等位基因。因此，它们对变异等位基因计数的贡献与 $(1-p) \\times 0 = 0$ 成正比。\n- **肿瘤细胞：** 这些细胞占群体的比例为 $p$。题目陈述该体细胞SNV是克隆性的（存在于所有肿瘤细胞中）和杂合的。在此背景下，杂合意味着在每个肿瘤细胞的总共 $CN$ 个等位基因拷贝中，变异恰好存在于 $1$ 个拷贝上，其中 $CN$ 是肿瘤细胞在该位点的总拷贝数。因此，每个肿瘤细胞恰好贡献 $1$ 个变异等位基因。它们对变异等位基因计数的贡献与 $p \\times 1 = p$ 成正比。\n\n混合样本中变异等位基因的总比例计数，我们可以表示为 $N_{var}$，是这些贡献的总和：\n$$ N_{var} \\propto p \\times 1 + (1-p) \\times 0 = p $$\n\n接下来，我们确定VAF表达式的分母：该位点上所有等位基因拷贝的总数，包括变异和非变异（野生型）等位基因。\n- **正常细胞：** 这些细胞占群体的比例为 $1-p$，是二倍体。这意味着它们在该位点的总拷贝数为 $2$。它们对总等位基因计数的贡献与 $(1-p) \\times 2$ 成正比。\n- **肿瘤细胞：** 这些细胞占群体的比例为 $p$，在该位点的总拷贝数为 $CN$。它们对总等位基因计数的贡献与 $p \\times CN$ 成正比。\n\n混合样本中所有等位基因的总比例计数，我们可以表示为 $N_{total}$，是来自正常细胞和肿瘤细胞贡献的总和：\n$$ N_{total} \\propto (1-p) \\times 2 + p \\cdot CN = 2(1-p) + p \\cdot CN $$\n\n预期的VAF是变异等位基因总比例计数与所有等位基因总比例计数的比率。与细胞总数相关的比例常数在比率中被消掉。\n$$ \\text{VAF} = \\frac{N_{var}}{N_{total}} = \\frac{p}{2(1-p) + p \\cdot CN} $$\n这个表达式给出了预期的VAF作为肿瘤纯度 $p$ 和肿瘤特异性拷贝数 $CN$ 的函数，它完全是根据问题陈述中提供的定义和假设推导出来的。",
            "answer": "$$\\boxed{\\frac{p}{2(1-p) + p \\cdot CN}}$$"
        },
        {
            "introduction": "接下来，我们将视角从体细胞突变分析转向鉴定罕见病的致病性种系变异。本练习将演示如何整合群体遗传学原理与临床参数，如疾病流行率（$P$）和外显率（$\\\\pi$），来为一个潜在的致病变异设定一个理论上可信的最高群体频率阈值。这项技能对于使用大型参考数据库（如gnomAD）从WGS数据中筛选致病候选变异至关重要，是临床遗传分析的核心步骤。",
            "id": "5171770",
            "problem": "一个临床实验室使用全基因组测序 (WGS) 来鉴定一种罕见的常染色体显性遗传原发性免疫缺陷病的致病性变异。为了对候选变异进行优先级排序，他们使用基因组聚合数据库 (gnomAD) 进行人群频率过滤。根据群体遗传学和临床外显率的基本原理，在以下假设下，推导单个致病性变异的最大可信人群等位基因频率阈值，该阈值需与观测到的疾病负担相符：\n- 普通人群中的疾病患病率为 $P = \\frac{1}{50{,}000}$。\n- 在 Hardy–Weinberg 平衡 (HWE) 和稀有等位基因近似下，一个人群频率为 $q$ 的等位基因的杂合子基因型频率约为 $2q$，纯合子频率可忽略不计。\n- 该疾病为常染色体显性遗传，致病性变异携带者的临床外显率为 $\\pi = 0.50$。\n- 由于基因座异质性和等位基因异质性，所有疾病病例中最多有 $f_{g} = 0.25$ 的比例可归因于该基因，而该基因所致病例中最多有 $f_{v} = 0.05$ 的比例可归因于正在评估的特定变异。\n- 假设随机交配、群体稳定，并且该变异的致病风险主要由杂合子决定。\n\n仅使用患病率、外显率和 Hardy–Weinberg 平衡的定义，建立一个不等式，为该单一变异对总疾病患病率的贡献设定上限，并求解该不等式以获得最大可信等位基因频率 $q_{\\max}$ 关于 $P$、$f_{g}$、$f_{v}$ 和 $\\pi$ 的闭式表达式。然后，使用上述数值对 $q_{\\max}$ 进行数值计算。\n\n简要解释在实践中如何使用此阈值和基因组聚合数据库 (gnomAD) 的数据来过滤变异，并说明检查按种族分层的等位基因计数的理由。\n\n以等位基因的小数分数形式报告 $q_{\\max}$ 的最终值。将您的答案四舍五入到 $3$ 位有效数字。",
            "solution": "基本依据是 Hardy–Weinberg 平衡 (HWE)、疾病患病率的定义以及临床外显率的定义。设 $q$ 表示一个稀有变异的人群等位基因频率。在 HWE 和稀有等位基因近似下，当 $p \\approx 1 - q \\approx 1$ 时，杂合子基因型频率约为 $2pq \\approx 2q$，而纯合子基因型频率 $q^{2}$ 可忽略不计。\n\n对于一个临床外显率为 $\\pi$ 的常染色体显性遗传致病性变异，由该单一变异导致的受影响人群比例约为\n$$\n\\text{prevalence due to variant} \\approx \\pi \\times (2q) = 2\\pi q,\n$$\n其中我们忽略了 $q^{2}$，因为 $q$ 很小。\n\n设 $P$ 为人群中的总疾病患病率。由于遗传异质性，所有病例中最多有 $f_{g}$ 的比例可归因于该基因，而该基因所致病例中最多有 $f_{v}$ 的比例可归因于该特定变异。因此，人群中所有疾病病例中最多有 $f_{g} f_{v}$ 的比例可归因于该变异。因此，该变异对总疾病患病率的贡献的上限为\n$$\n\\text{prevalence due to variant} \\leq f_{g} f_{v} P.\n$$\n将此与 HWE 下的外显率加权的基因型频率相结合，得到不等式\n$$\n2 \\pi q \\leq f_{g} f_{v} P.\n$$\n对 $q$ 求解，得到最大可信等位基因频率的闭式表达式：\n$$\nq_{\\max} = \\frac{f_{g} f_{v} P}{2 \\pi}.\n$$\n\n现在我们使用给定值 $P = \\frac{1}{50{,}000}$，$f_{g} = 0.25$，$f_{v} = 0.05$ 和 $\\pi = 0.50$ 对 $q_{\\max}$ 进行数值计算：\n$$\nq_{\\max} = \\frac{\\left(0.25\\right)\\left(0.05\\right)\\left(\\frac{1}{50{,}000}\\right)}{2 \\times 0.50}.\n$$\n首先计算分子因子：\n$$\n0.25 \\times 0.05 = 0.0125,\n$$\n因此\n$$\n0.0125 \\times \\frac{1}{50{,}000} = \\frac{0.0125}{50{,}000} = 2.5 \\times 10^{-7}.\n$$\n分母是\n$$\n2 \\times 0.50 = 1.\n$$\n因此，\n$$\nq_{\\max} = \\frac{2.5 \\times 10^{-7}}{1} = 2.5 \\times 10^{-7}.\n$$\n四舍五入到 $3$ 位有效数字，结果为 $2.50 \\times 10^{-7}$。\n\n在基因组聚合数据库 (gnomAD) 过滤中的应用：在实践中，实验室会针对疾病模型计算 $q_{\\max}$，并将其用作一个上限，以过滤掉在基因组聚合数据库 (gnomAD) 中观测到的人群等位基因频率在任何相关种族群体中超过此阈值的变异。由于疾病风险和等位基因频率可能因种族而异，并且抽样方差可能掩盖亚群特异性的富集，因此应检查按种族分层的等位基因计数和频率；一个在全球范围内低于 $q_{\\max}$ 但在特定种族中超过 $q_{\\max}$ 的变异，对于该种族的个体来说，其优先级将被降低。额外的检查包括评估对 gnomAD 频率估计的置信度（例如，覆盖度和位点水平质量）、变异的预测效应与疾病机制的一致性，以及确保过滤过程遵循用于计算 $q_{\\max}$ 的外显率和异质性假设。",
            "answer": "$$\\boxed{2.50 \\times 10^{-7}}$$"
        }
    ]
}