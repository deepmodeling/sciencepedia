{
    "hands_on_practices": [
        {
            "introduction": "任何免疫分析的第一步都是对原始数据进行严谨的处理。本练习将指导您完成放射免疫分析（RIA）中的一个核心操作：将原始放射性计数转换为经过校正的、有意义的信号比值$B/B_{0}$。通过此练习，您不仅将学会如何扣除非特异性结合（NSB）的背景噪音，还将掌握基于泊松统计和误差传播理论计算结果不确定度的关键技能，这是定量实验科学的基础。",
            "id": "5153468",
            "problem": "一个实验室正在评估一种针对小分子激素的竞争性放射免疫分析（RIA）。在RIA中，放射性标记的示踪剂与有限数量的抗体位点结合，而未标记的分析物则竞争这些位点。分离结合态和游离态的示踪剂后，探测器记录结合部分的放射性计数。结合计数包括与抗体的真实特异性结合，以及与基质和表面的非特异性结合。非特异性结合的贡献通过使用含有示踪剂但不含抗体的非特异性结合（NSB）管来近似估算。另外还准备了一组含有零浓度分析物标准品的管子，称为零标准品管，用于量化在没有竞争物存在时的最大特异性结合。加入管中的总示踪剂通过总计数管（T）来验证，这些管子在不进行分离的情况下进行计数。对于一个未知分析物浓度的测试样本，校正后的结合计数相对于零标准品的比率（$B/B_{0}$）的操作性定义是：从样本的结合计数和零标准品的结合计数中都减去NSB以分离出特异性结合，然后计算它们的比率。\n\n放射性衰变的计数过程本质上是随机的，并且在稳定的几何结构和所有管子计数时间恒定的情况下，遵循泊松统计：如果在固定的计数区间内平均计数为$\\mu$，那么计数的方差也是$\\mu$。对于相同条件下的$n$个独立重复管，样本均值$\\bar{X}$是$\\mu$的无偏估计量，并且在泊松模型下，其方差约为$\\mu/n$。\n\n一次分析运行产生了以下原始结合计数数据（所有管子计数时间相同），每种条件下有$n=3$个独立重复：\n\n- 总计数管（T）：$\\{126{,}350,\\ 126{,}980,\\ 127{,}430\\}$。\n- 零标准品管（$B_{0}$）：$\\{71{,}240,\\ 70{,}890,\\ 71{,}610\\}$。\n- 非特异性结合（NSB）管：$\\{4{,}820,\\ 4{,}940,\\ 5{,}030\\}$。\n- 样本管（B）：$\\{59{,}310,\\ 60{,}150,\\ 59{,}780\\}$。\n\n假设：\n- 所有管子具有相同的计数时间和探测效率。\n- 在条件内部和条件之间的重复管是独立的。\n- 泊松模型适用于计数统计。\n\n从上述随机模型和特异性结合的操作性校正出发，使用重复样本的均值计算样本的校正比率$B/B_{0}$，然后利用来自重复样本均值的泊松方差的一阶不确定性传播方法，推导并计算该比率的标准误差（SE）。将最终数值结果四舍五入到四位有效数字。按顺序以两个数字报告您的最终答案：校正后的$B/B_{0}$及其SE。该比率是无量纲的，不需要单位。",
            "solution": "问题陈述提供了来自竞争性放射免疫分析（RIA）的数据，并要求计算校正比率$B/B_{0}$及其相关的标准误差（SE）。该问题具有科学依据，提法明确，并包含唯一解所需的所有必要信息和定义。RIA的基本原理、放射性计数的泊松统计以及不确定性传播都得到了正确陈述。所提供的数据是符合实际的。因此，该问题被认为是有效的，并且可以推导出解决方案。\n\n第一步是计算每种实验条件下原始计数的样本均值。设$n=3$为每种条件的重复次数。代表平均计数的变量是：\n- $\\bar{B}_{0}$：零标准品管的平均计数。\n- $\\overline{\\text{NSB}}$：非特异性结合管的平均计数。\n- $\\bar{B}$：未知样本管的平均计数。\n\n所提供的数据是：\n- $B_{0}$ 计数：$\\{71240, 70890, 71610\\}$\n- NSB 计数：$\\{4820, 4940, 5030\\}$\n- $B$ 计数：$\\{59310, 60150, 59780\\}$\n（总计数数据对于此计算不是必需的）。\n\n样本均值计算如下：\n$$ \\bar{B}_{0} = \\frac{71240 + 70890 + 71610}{3} = \\frac{213740}{3} \\approx 71246.67 $$\n$$ \\overline{\\text{NSB}} = \\frac{4820 + 4940 + 5030}{3} = \\frac{14790}{3} = 4930.0 $$\n$$ \\bar{B} = \\frac{59310 + 60150 + 59780}{3} = \\frac{179240}{3} \\approx 59746.67 $$\n\n问题将校正比率（我们表示为$R$）定义为样本的特异性结合与零标准品的特异性结合之比。特异性结合是通过从总结合计数中减去平均非特异性结合计数来计算的。\n设$B_s$为样本的特异性计数，$B_{0s}$为零标准品的特异性计数。\n$$ B_s = \\bar{B} - \\overline{\\text{NSB}} = \\frac{179240}{3} - 4930.0 = \\frac{164450}{3} \\approx 54816.67 $$\n$$ B_{0s} = \\bar{B}_{0} - \\overline{\\text{NSB}} = \\frac{213740}{3} - 4930.0 = \\frac{198950}{3} \\approx 66316.67 $$\n\n因此，校正比率$R$为：\n$$ R = \\frac{B_s}{B_{0s}} = \\frac{\\bar{B} - \\overline{\\text{NSB}}}{\\bar{B}_{0} - \\overline{\\text{NSB}}} = \\frac{164450/3}{198950/3} = \\frac{164450}{198950} \\approx 0.8265901... $$\n四舍五入到四位有效数字，该比率为$0.8266$。\n\n接下来，我们必须使用一阶不确定性传播来计算该比率的标准误差$SE(R)$。比率$R$是三个独立随机变量的函数：$\\bar{B}$、$\\bar{B}_{0}$和$\\overline{\\text{NSB}}$。对于一个具有独立变量的函数$f(x_1, x_2, ..., x_k)$，其方差的通用公式为：\n$$ \\sigma_f^2 \\approx \\sum_{i=1}^{k} \\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 $$\n在我们的例子中，$R = f(\\bar{B}, \\bar{B}_{0}, \\overline{\\text{NSB}})$，所以其方差$\\sigma_R^2$为：\n$$ \\sigma_R^2 \\approx \\left(\\frac{\\partial R}{\\partial \\bar{B}}\\right)^2 \\sigma_{\\bar{B}}^2 + \\left(\\frac{\\partial R}{\\partial \\bar{B}_{0}}\\right)^2 \\sigma_{\\bar{B}_{0}}^2 + \\left(\\frac{\\partial R}{\\partial \\overline{\\text{NSB}}}\\right)^2 \\sigma_{\\overline{\\text{NSB}}}^2 $$\n\n$R$的偏导数是：\n$$ \\frac{\\partial R}{\\partial \\bar{B}} = \\frac{1}{\\bar{B}_{0} - \\overline{\\text{NSB}}} $$\n$$ \\frac{\\partial R}{\\partial \\bar{B}_{0}} = -\\frac{\\bar{B} - \\overline{\\text{NSB}}}{(\\bar{B}_{0} - \\overline{\\text{NSB}})^2} $$\n$$ \\frac{\\partial R}{\\partial \\overline{\\text{NSB}}} = \\frac{-(\\bar{B}_{0} - \\overline{\\text{NSB}}) - (\\bar{B} - \\overline{\\text{NSB}})(-1)}{(\\bar{B}_{0} - \\overline{\\text{NSB}})^2} = \\frac{\\bar{B} - \\bar{B}_{0}}{(\\bar{B}_{0} - \\overline{\\text{NSB}})^2} $$\n\n问题陈述中指出，计数遵循泊松统计，其中计数的方差等于其均值$\\mu$。对于$n$个重复样本的样本均值$\\bar{X}$，其方差$\\sigma_{\\bar{X}}^2$约为$\\mu/n$。我们使用样本均值$\\bar{X}$作为$\\mu$的最佳估计。因此：\n$$ \\sigma_{\\bar{B}}^2 \\approx \\frac{\\bar{B}}{n}, \\quad \\sigma_{\\bar{B}_{0}}^2 \\approx \\frac{\\bar{B}_{0}}{n}, \\quad \\sigma_{\\overline{\\text{NSB}}}^2 \\approx \\frac{\\overline{\\text{NSB}}}{n} $$\n\n将偏导数和方差代入传播公式：\n$$ \\sigma_R^2 \\approx \\left(\\frac{1}{\\bar{B}_{0} - \\overline{\\text{NSB}}}\\right)^2 \\left(\\frac{\\bar{B}}{n}\\right) + \\left(-\\frac{\\bar{B} - \\overline{\\text{NSB}}}{(\\bar{B}_{0} - \\overline{\\text{NSB}})^2}\\right)^2 \\left(\\frac{\\bar{B}_{0}}{n}\\right) + \\left(\\frac{\\bar{B} - \\bar{B}_{0}}{(\\bar{B}_{0} - \\overline{\\text{NSB}})^2}\\right)^2 \\left(\\frac{\\overline{\\text{NSB}}}{n}\\right) $$\n这可以更紧凑地写为：\n$$ \\sigma_R^2 \\approx \\frac{1}{n(\\bar{B}_{0} - \\overline{\\text{NSB}})^4} \\left[ (\\bar{B}_{0} - \\overline{\\text{NSB}})^2 \\bar{B} + (\\bar{B} - \\overline{\\text{NSB}})^2 \\bar{B}_{0} + (\\bar{B} - \\bar{B}_{0})^2 \\overline{\\text{NSB}} \\right] $$\n\n现在我们代入数值，其中$n=3$：\n$$ \\bar{B}_{0} - \\overline{\\text{NSB}} = \\frac{198950}{3} $$\n$$ \\bar{B} - \\overline{\\text{NSB}} = \\frac{164450}{3} $$\n$$ \\bar{B} - \\bar{B}_0 = \\frac{179240}{3} - \\frac{213740}{3} = -\\frac{34500}{3} = -11500 $$\n\n将这些值代入方差方程：\n$$ \\sigma_R^2 \\approx \\frac{1}{3} \\left[ \\left(\\frac{1}{198950/3}\\right)^2 \\left(\\frac{179240/3}{3}\\right) + \\left(\\frac{164450/3}{(198950/3)^2}\\right)^2\\left(\\frac{213740/3}{3}\\right) + \\left(\\frac{-11500}{(198950/3)^2}\\right)^2\\left(\\frac{4930}{3}\\right) \\right] $$\n逐项计算更为直接：\n- 第1项：$\\left(\\frac{1}{66316.67}\\right)^2 (\\frac{59746.67}{3}) = (2.2739\\times 10^{-10})(19915.56) \\approx 4.526 \\times 10^{-6}$\n- 第2项：$\\left(\\frac{54816.67}{66316.67^2}\\right)^2 (\\frac{71246.67}{3}) = (1.2464\\times 10^{-5})^2 (23748.89) = (1.5535\\times 10^{-10})(23748.89) \\approx 3.689 \\times 10^{-6}$\n- 第3项：$\\left(\\frac{-11500}{66316.67^2}\\right)^2 (\\frac{4930}{3}) = (-2.6146\\times 10^{-6})^2 (1643.33) = (6.836\\times 10^{-12})(1643.33) \\approx 1.123 \\times 10^{-8}$\n\n将这些项相加得到比率的方差：\n$$ \\sigma_R^2 \\approx (4.526 + 3.689 + 0.011) \\times 10^{-6} \\approx 8.226 \\times 10^{-6} $$\n使用更高精度的中间计算得出 $\\sigma_R^2 \\approx 8.2292 \\times 10^{-6}$。\n\n标准误差（SE）是方差的平方根：\n$$ SE(R) = \\sigma_R = \\sqrt{8.2292 \\times 10^{-6}} \\approx 0.00286866... $$\n四舍五入到四位有效数字，标准误差为$0.002869$。\n\n最终结果是：\n- 校正比率$B/B_{0}$：$0.8266$\n- 比率的标准误差：$0.002869$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8266  0.002869 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理想的免疫分析应具有高度特异性，仅对目标分析物产生响应。本练习探讨了竞争性结合理论在评估分析特异性中的应用，即交叉反应性。您将从质量作用定律等基本原理出发，推导出抗体对分析物及其结构相似代谢物的亲和力常数（$K_{d}$）如何决定了检测结果的准确性，并理解交叉反应性在临床诊断中的重要意义。",
            "id": "5153506",
            "problem": "使用单一单克隆抗体对一种小分子激素进行竞争性放射免疫分析（RIA）。该抗体能结合放射性标记的示踪抗原，并与未标记的配体竞争。测定结合的示踪剂分数（记为 $B/B_0$）作为未标记竞争物浓度的函数。在相同的分析条件下获得两条置换曲线：一条用于目标激素（分析物），另一条用于结构相关的代谢物。放射性标记示踪抗原的浓度为 $[L^{*}] = 0.050$ nmol/L，示踪剂-抗体解离常数为 $K_{d}^{*} = 0.200$ nmol/L，分析物-抗体解离常数为 $K_{d}^{A} = 0.400$ nmol/L，代谢物-抗体解离常数为 $K_{d}^{M} = 1.60$ nmol/L。假设每个抗体只有一个结合位点，结合为平衡状态下的竞争性结合，并且 $B/B_0$ 定义为在存在竞争物时结合的示踪剂与不存在竞争物时结合的示踪剂之比，所有测量均在相同的 $[L^{*}]$ 下进行。\n\n仅使用质量作用竞争性结合的第一性原理，计算在 $50\\%$ 置换时的交叉反应性，此处定义为比率\n$$\\text{CR}_{0.5} = \\frac{[C]_{0.5}^{A}}{[C]_{0.5}^{M}},$$\n其中 $[C]_{0.5}^{A}$ 和 $[C]_{0.5}^{M}$ 分别是产生 $B/B_0 = 0.500$ 时的分析物和代谢物的竞争物浓度。将最终的交叉反应性表示为无单位的小数，并将答案四舍五入至三位有效数字。\n\n根据计算出的交叉反应性的大小，简要讨论其对含有生理相关浓度代谢物的患者样本中分析物定量的临床意义。您的讨论应是概念性的；计算出的交叉反应性结果必须作为论证的基础，但最终的数值答案应按上述规定单独报告。",
            "solution": "问题陈述经评估有效。它在科学上基于竞争性配体结合原理和质量作用定律，这些是放射免疫分析（RIA）的基础。该问题提法明确，提供了所有必需的参数以及待计算量的清晰定义。语言客观，情景在免疫诊断的背景下是现实的。\n\n问题要求计算在 $50\\%$ 置换时的交叉反应性，定义为 $\\text{CR}_{0.5} = \\frac{[C]_{0.5}^{A}}{[C]_{0.5}^{M}}$。这需要推导出一个表达式，用于计算能使放射性标记示踪剂结合减少 $50\\%$（即 $B/B_0 = 0.500$）的竞争物浓度 $[C]$。\n\n令 $Ab$ 代表抗体，$L^{*}$ 代表放射性标记示踪抗原，$C$ 代表一种通用的未标记竞争物（可以是分析物 $A$ 或代谢物 $M$）。结合反应处于平衡状态，并受质量作用定律支配。\n\n相关的平衡反应是：\n$1$. 示踪剂结合：$Ab + L^{*} \\rightleftharpoons AbL^{*}$，解离常数为 $K_{d}^{*} = \\frac{[Ab][L^{*}]}{[AbL^{*}]}$。\n$2$. 竞争物结合：$Ab + C \\rightleftharpoons AbC$，解离常数为 $K_{d}^{C} = \\frac{[Ab][C]}{[AbC]}$。\n\n此处，$[Ab]$、$[L^{*}]$ 和 $[C]$ 代表平衡时游离（未结合）物质的摩尔浓度。$[AbL^{*}]$ 和 $[AbC]$ 是结合复合物的浓度。\n\n根据这些定义，我们可以用游离物质来表示结合复合物的浓度：\n$$[AbL^{*}] = \\frac{[Ab][L^{*}]}{K_{d}^{*}}$$\n$$[AbC] = \\frac{[Ab][C]}{K_{d}^{C}}$$\n\n抗体的总浓度 $[Ab]_T$ 是游离形式和结合形式之和：\n$$[Ab]_T = [Ab] + [AbL^{*}] + [AbC]$$\n代入结合复合物的表达式：\n$$[Ab]_T = [Ab] + \\frac{[Ab][L^{*}]}{K_{d}^{*}} + \\frac{[Ab][C]}{K_d^{C}} = [Ab] \\left( 1 + \\frac{[L^{*}]}{K_d^{*}} + \\frac{[C]}{K_d^{C}} \\right)$$\n\n这使我们能够将游离抗体浓度表示为：\n$$[Ab] = \\frac{[Ab]_T}{1 + \\frac{[L^{*}]}{K_d^{*}} + \\frac{[C]}{K_d^{C}}}$$\n\n结合的示踪剂量 $B$ 与示踪剂-抗体复合物的浓度 $[AbL^{*}]$ 成正比。\n$$B \\propto [AbL^{*}] = \\frac{[Ab][L^{*}]}{K_d^{*}} = \\left( \\frac{[Ab]_T}{1 + \\frac{[L^{*}]}{K_d^{*}} + \\frac{[C]}{K_d^{C}}} \\right) \\frac{[L^{*}]}{K_d^{*}}$$\n\n$B_0$ 项表示在没有任何竞争物时（即 $[C] = 0$ 时）结合的示踪剂量。在这种情况下，结合示踪剂的表达式简化为：\n$$B_0 \\propto [AbL^{*}]_0 = \\left( \\frac{[Ab]_T}{1 + \\frac{[L^{*}]}{K_d^{*}}} \\right) \\frac{[L^{*}]}{K_d^{*}}$$\n\n结合的示踪剂分数 $B/B_0$ 是这两个量的比值。比例常数和 $[Ab]_T \\frac{[L^{*}]}{K_d^{*}}$ 项会相互抵消：\n$$\\frac{B}{B_0} = \\frac{[AbL^{*}]}{[AbL^{*}]_0} = \\frac{\\left( \\frac{[Ab]_T}{1 + \\frac{[L^{*}]}{K_d^{*}} + \\frac{[C]}{K_d^{C}}} \\right) \\frac{[L^{*}]}{K_d^{*}}}{\\left( \\frac{[Ab]_T}{1 + \\frac{[L^{*}]}{K_d^{*}}} \\right) \\frac{[L^{*}]}{K_d^{*}}} = \\frac{1 + \\frac{[L^{*}]}{K_d^{*}}}{1 + \\frac{[L^{*}]}{K_d^{*}} + \\frac{[C]}{K_d^{C}}}$$\n该方程将结合分数与示踪剂和竞争物的游离浓度联系起来。在此类分析中的一个标准假设是抗体浓度非常低（限制性试剂），因此结合的配体量与添加的总配体量相比可以忽略不计。这允许用添加的总浓度来近似游离浓度：$[L^{*}] \\approx [L^{*}]_T$ 和 $[C] \\approx [C]_T$。问题给出了单一值 $[L^{*}] = 0.050$ nmol/L，我们将其解释为所有实验中使用的总示踪剂浓度 $[L^{*}]_T$。\n\n我们需要找到导致 $B/B_0 = 0.500$ 的竞争物浓度 $[C]_{0.5}$。将此代入我们的方程：\n$$0.500 = \\frac{1 + \\frac{[L^{*}]_T}{K_d^{*}}}{1 + \\frac{[L^{*}]_T}{K_d^{*}} + \\frac{[C]_{0.5}}{K_d^{C}}}$$\n整理以求解 $[C]_{0.5}$：\n$$0.500 \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} + \\frac{[C]_{0.5}}{K_d^{C}} \\right) = 1 + \\frac{[L^{*}]_T}{K_d^{*}}$$\n$$0.500 \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right) + 0.500 \\frac{[C]_{0.5}}{K_d^{C}} = 1 + \\frac{[L^{*}]_T}{K_d^{*}}$$\n$$0.500 \\frac{[C]_{0.5}}{K_d^{C}} = \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right) - 0.500 \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)$$\n$$0.500 \\frac{[C]_{0.5}}{K_d^{C}} = 0.500 \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)$$\n$$\\frac{[C]_{0.5}}{K_d^{C}} = 1 + \\frac{[L^{*}]_T}{K_d^{*}}$$\n$$[C]_{0.5} = K_d^{C} \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)$$\n这个通用结果被称为竞争性结合的 Cheng-Prusoff 方程，它将实验测定的 IC50 值 $[C]_{0.5}$ 与竞争物的内在亲和力 $K_d^C$ 联系起来。\n\n我们将此公式应用于分析物（$A$）和代谢物（$M$）：\n对于分析物，$C = A$ 且 $K_d^C = K_d^A$：\n$$[C]_{0.5}^{A} = K_d^{A} \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)$$\n对于代谢物，$C = M$ 且 $K_d^C = K_d^M$：\n$$[C]_{0.5}^{M} = K_d^{M} \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)$$\n\n交叉反应性定义为这两个浓度的比值：\n$$\\text{CR}_{0.5} = \\frac{[C]_{0.5}^{A}}{[C]_{0.5}^{M}} = \\frac{K_d^{A} \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)}{K_d^{M} \\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)}$$\n$\\left( 1 + \\frac{[L^{*}]_T}{K_d^{*}} \\right)$ 项在分子和分母中都存在，因此可以消去。这种简化是问题中交叉反应性定义的直接结果。\n$$\\text{CR}_{0.5} = \\frac{K_d^{A}}{K_d^{M}}$$\n\n现在我们代入给定的值：\n$K_{d}^{A} = 0.400$ nmol/L\n$K_{d}^{M} = 1.60$ nmol/L\n\n$$\\text{CR}_{0.5} = \\frac{0.400 \\text{ nmol/L}}{1.60 \\text{ nmol/L}} = \\frac{0.400}{1.60} = 0.250$$\n在 $50\\%$ 置换时的交叉反应性为 $0.250$。\n\n临床意义讨论：\n计算出的交叉反应性 $\\text{CR}_{0.5} = 0.250$ 表明，在该分析中，代谢物在竞争抗体结合方面的效力是分析物的 $25.0\\%$。解离常数（$K_d$）越低，亲和力越高。抗体对分析物的亲和力（$K_d^A = 0.400$ nmol/L）是其对代谢物亲和力（$K_d^M = 1.60$ nmol/L）的四倍。尽管抗体对分析物更具特异性，但 $25.0\\%$ 的交叉反应性是相当大的，并具有显著的临床意义。\n\n在临床环境中，患者样本（例如血浆）可能同时含有目标激素（分析物）及其代谢物。由于代谢物存在交叉反应，RIA 将无法区分它们。代谢物会置换放射性标记的示踪剂，并对测量信号产生贡献，从而错误地提高了分析物的表观浓度。测得的浓度将是真实分析物浓度和代谢物干扰效应的综合结果。具有如此高交叉反应性的分析缺乏特异性。\n\n如果代谢物的浓度与分析物相当或更高，对分析物浓度的过高估计可能会很严重，可能导致误诊、对疾病状态的错误评估或不当的治疗决策。为了使免疫诊断分析在临床上可靠，来自相关物质的交叉反应性理想情况下应可忽略不计（例如，小于 $1\\%$）。$25.0\\%$ 的值使得该分析不适用于对含有代谢物的生物样本中分析物的准确定量，除非在进行 RIA 之前，先通过初步分离步骤（如液相色谱法）去除干扰的代谢物。",
            "answer": "$$\\boxed{0.250}$$"
        },
        {
            "introduction": "为了从完整的剂量-反应曲线中提取最精确的生物物理参数，我们需要将物理模型与先进的统计方法相结合。本练习是一个综合性的计算实践，要求您从头开始构建一个竞争性结合模型，并实施加权非线性最小二乘法来拟合真实的RIA数据。通过该练习，您将掌握如何根据泊松计数统计原理为数据点分配合理的权重，从而精确地估算出解离常数$K_i$等关键参数，这是现代生物数据分析的核心技能。",
            "id": "5153551",
            "problem": "您将获得来自三次竞争性结合放射免疫分析 (RIA) 实验的重复放射性计数数据，在这些实验中，示踪配体和未标记的竞争物都与同一个受体位点结合。您将编写的程序必须实现一个竞争性结合曲线的加权非线性最小二乘拟合，该拟合基于计数统计的、有科学依据的加权方案。目标是为每个数据集估计三个未知参数：竞争物平衡解离常数 $K_i$（纳摩尔）、特异性计数尺度 $c_{\\mathrm{spec}}$（每个测量区间的计数）和背景计数 $c_{\\mathrm{bg}}$（每个测量区间的计数）。您必须汇总每个竞争物浓度下的重复计数，并根据概率性计数方差推导出权重。\n\n使用的基本原理：\n- 单一结合位点的配体-受体结合平衡遵循质量作用定律：$R + L \\rightleftharpoons RL$，示踪配体 $L$ 的平衡解离常数为 $K_d$；以及 $R + I \\rightleftharpoons RI$，竞争物 $I$ 的平衡解离常数为 $K_i$。两种示踪剂竞争同一个受体。\n- 在平衡状态下，被示踪配体 $L$ 占据的受体分数随竞争物浓度的增加而减少。在单一非协同位点、快速平衡以及示踪剂处于非消耗性低浓度的假设下，推导示踪剂占据率对竞争物浓度 $[I]$ 的函数依赖关系，用 $[L]$、$K_d$ 和 $K_i$ 表示。\n- 观测到的放射性计数是示踪剂占据率到特异性计数的线性映射加上一个恒定的背景值：测量的计数 $y$ 满足 $y = c_{\\mathrm{bg}} + c_{\\mathrm{spec}} \\times \\text{(L占据的受体分数)}$。\n- 计数噪声由泊松统计控制。对于均值为 $\\lambda$ 的泊松过程，其方差也是 $\\lambda$。对于具有相同均值的 $n$ 次独立重复测量，样本均值的方差为 $\\lambda / n$。\n\n您的程序必须：\n1. 从质量作用平衡和受体守恒出发，推导并实现竞争性结合模型 $f([I]; K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}})$。除了上述基本定律外，不假设或使用任何预先指定的简化公式。\n2. 对于每个竞争物浓度 $[I]_j$ 及其重复计数 $\\{y_{j,k}\\}$，计算样本均值 $\\bar{y}_j$ 和相应的权重 $w_j$，权重要根据均值的计数方差来确定。使用泊松统计下方差与均值成正比的原理，将 $w_j$ 设为与 $n_j / \\bar{y}_j$ 成正比，其中 $n_j$ 是浓度 $[I]_j$ 下的重复次数。为在 $\\bar{y}_j$ 非常小时保持数值稳定性，您必须实现一个小的正数下限 $\\varepsilon$，使得 $w_j = n_j / \\max(\\bar{y}_j, \\varepsilon)$，其中 $\\varepsilon$ 是严格为正且远小于典型计数值。\n3. 通过最小化加权残差平方和 $\\sum_j w_j \\left(\\bar{y}_j - f([I]_j; K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}})\\right)^2$ 来拟合参数 $(K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}})$。约束所有拟合参数为非负且有限。您必须使用适合最小二乘的标准非线性优化方法来实现拟合。\n4. 生成最终输出为单行，包含一个由三个列表组成的列表。每个内部列表对应一个数据集，且必须包含三个估计参数 $[K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}}]$。$K_i$ 以纳摩尔为单位表示，$c_{\\mathrm{spec}}$ 和 $c_{\\mathrm{bg}}$ 以每个测量区间的计数为单位表示。将每个数字格式化为小数点后恰好有三位的小数。最终输出行必须类似于 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$，且不含空格。\n\n数据集 (测试套件)：\n对于每个数据集，$[L]$（示踪剂浓度）和 $K_d$（示踪剂解离常数）是该实验的已知常数，并在下面提供。竞争物浓度 $[I]_j$ 以纳摩尔为单位，重复计数是每个测量区间的原始积分计数。这些数据集涵盖了一个典型案例、一个低计数边缘案例（包括一个零计数）和一个高占据率案例，用以探测参数的可辨识性和稳健性。\n\n- 数据集 1 (典型情况)：已知 $[L] = 0.2$ 纳摩尔，$K_d = 1.0$ 纳摩尔；竞争物浓度 $[I] = [0, 0.5, 1, 2, 5, 10, 50, 200]$ 纳摩尔，各浓度下的重复计数：\n  - $[I] = 0$: 计数 $[3798, 3860, 3845]$\n  - $[I] = 0.5$: 计数 $[3610, 3564, 3540]$\n  - $[I] = 1$: 计数 $[3365, 3330, 3402]$\n  - $[I] = 2$: 计数 $[2975, 3010, 3004]$\n  - $[I] = 5$: 计数 $[2320, 2298, 2345]$\n  - $[I] = 10$: 计数 $[1758, 1730, 1762]$\n  - $[I] = 50$: 计数 $[860, 845, 868]$\n  - $[I] = 200$: 计数 $[600, 592, 594]$\n\n- 数据集 2 (带有零的低计数边缘情况)：已知 $[L] = 0.1$ 纳摩尔，$K_d = 1.0$ 纳摩尔；竞争物浓度 $[I] = [0, 0.2, 0.5, 2, 5, 20, 100]$ 纳摩尔，各浓度下的重复计数：\n  - $[I] = 0$: 计数 $[40, 42, 41, 43]$\n  - $[I] = 0.2$: 计数 $[39, 38, 40, 41]$\n  - $[I] = 0.5$: 计数 $[36, 37, 35, 38]$\n  - $[I] = 2$: 计数 $[26, 28, 30]$\n  - $[I] = 5$: 计数 $[18, 20, 21]$\n  - $[I] = 20$: 计数 $[10, 9]$\n  - $[I] = 100$: 计数 $[7, 0]$\n\n- 数据集 3 (高占据率，大动态范围)：已知 $[L] = 2.0$ 纳摩尔，$K_d = 0.5$ 纳摩尔；竞争物浓度 $[I] = [0, 0.1, 1, 3, 10, 100]$ 纳摩尔，各浓度下的重复计数：\n  - $[I] = 0$: 计数 $[25013, 24980, 25045]$\n  - $[I] = 0.1$: 计数 $[24510, 24588, 24470]$\n  - $[I] = 1$: 计数 $[20950, 21070, 21010]$\n  - $[I] = 3$: 计数 $[15990, 16020, 16030]$\n  - $[I] = 10$: 计数 $[9020, 8985, 9035]$\n  - $[I] = 100$: 计数 $[2150, 2125, 2100]$\n\n算法要求：\n- 使用适合该目标的加权非线性最小二乘优化器；参数边界必须强制 $K_i \\geq 0$，$c_{\\mathrm{spec}} \\geq 0$，$c_{\\mathrm{bg}} \\geq 0$。\n- 选择有限的正数初始猜测值，不要依赖任何揭示目标公式的预拟合简化方法；根据数据范围和物理约束来证明初始化的合理性。\n- 将 $\\varepsilon$ 实现为一个小的正常数（例如，$\\varepsilon = 10^{-9}$ 计数）以稳定权重。\n\n单位和最终输出：\n- 将 $K_i$ 以纳摩尔为单位表示，$c_{\\mathrm{spec}}$、$c_{\\mathrm{bg}}$ 以每个测量区间的计数为单位表示。\n- 您的程序应生成一行输出，其中包含数据集1、2和3的三个拟合参数列表，分别作为一个用方括号括起来的逗号分隔列表。例如，输出必须遵循格式 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$，每个数字打印到小数点后恰好三位，且不含空格。",
            "solution": "从竞争性放射免疫分析（RIA）数据中估计参数的问题是有效的，因为它在科学上基于质量作用动力学，为数值求解提供了良好定义，并提供了完整且一致的信息。该任务要求从第一性原理推导物理模型，并应用统计上合理的拟合程序。我们现在开始进行求解。\n\n### 步骤 1：竞争性结合模型的推导\n\n该系统涉及一个受体 $R$、一个放射性标记的示踪配体 $L$ 和一个未标记的竞争配体 $I$。两种配体竞争受体上同一个单一、非协同的结合位点。其平衡由质量作用定律描述：\n\n1.  示踪剂结合：$R + L \\rightleftharpoons RL$，平衡解离常数为 $K_d = \\frac{[R][L]}{[RL]}$。\n2.  竞争物结合：$R + I \\rightleftharpoons RI$，平衡解离常数为 $K_i = \\frac{[R][I]}{[RI]}$。\n\n此处，$[X]$ 表示物质 $X$ 在平衡时的摩尔浓度。根据这些定义，我们可以用游离受体浓度 $[R]$ 来表示结合复合物的浓度：\n$$ [RL] = \\frac{[R][L]}{K_d} $$\n$$ [RI] = \\frac{[R][I]}{K_i} $$\n总受体浓度 $[R_T]$ 是守恒的，是游离受体与结合了任一配体的受体之和：\n$$ [R_T] = [R] + [RL] + [RI] $$\n将 $[RL]$ 和 $[RI]$ 的表达式代入守恒方程得：\n$$ [R_T] = [R] + \\frac{[R][L]}{K_d} + \\frac{[R][I]}{K_i} = [R] \\left( 1 + \\frac{[L]}{K_d} + \\frac{[I]}{K_i} \\right) $$\n在RIA中，可观测信号与结合的示踪剂量成正比。因此，我们感兴趣的量是被示踪剂占据的受体分数 $\\theta_L$，定义为：\n$$ \\theta_L = \\frac{[RL]}{[R_T]} $$\n为了找到 $\\theta_L$ 的表达式，我们首先从守恒方程中解出 $[R]$：\n$$ [R] = \\frac{[R_T]}{1 + \\frac{[L]}{K_d} + \\frac{[I]}{K_i}} $$\n现在，我们将这个 $[R]$ 的表达式代回 $[RL]$ 的定义中：\n$$ [RL] = \\frac{[L]}{K_d} [R] = \\frac{[L]}{K_d} \\frac{[R_T]}{1 + \\frac{[L]}{K_d} + \\frac{[I]}{K_i}} $$\n最后，我们可以将占据率分数 $\\theta_L$ 写成竞争物浓度 $[I]$ 的函数：\n$$ \\theta_L([I]) = \\frac{[RL]}{[R_T]} = \\frac{\\frac{[L]}{K_d}}{1 + \\frac{[L]}{K_d} + \\frac{[I]}{K_i}} $$\n此方程假设示踪剂和竞争物的总浓度相对于受体浓度足够大，以至于它们在平衡时的游离浓度 $[L]$ 和 $[I]$ 近似等于添加到分析中的总浓度。问题将每个实验的 $[L]$ 和 $K_d$ 作为已知常数提供。\n\n测量的放射性计数 $y$ 被建模为该占据率的线性函数，并包含一个恒定的背景信号：\n$$ y = c_{\\mathrm{bg}} + c_{\\mathrm{spec}} \\times \\theta_L $$\n其中 $c_{\\mathrm{bg}}$ 代表背景计数（非特异性结合和仪器噪声），而 $c_{\\mathrm{spec}}$ 是一个缩放因子，代表当所有受体都被示踪剂占据时（$\\theta_L=1$）将观察到的特异性计数。\n\n将这些结合起来，得到最终要拟合到数据的模型函数 $f([I]; K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}})$：\n$$ f([I]; K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}}) = c_{\\mathrm{bg}} + c_{\\mathrm{spec}} \\left( \\frac{\\frac{[L]}{K_d}}{1 + \\frac{[L]}{K_d} + \\frac{[I]}{K_i}} \\right) $$\n待估计的参数是竞争物的平衡解离常数 $K_i$、特异性计数尺度 $c_{\\mathrm{spec}}$ 和背景计数 $c_{\\mathrm{bg}}$。\n\n### 步骤 2：统计加权方案\n\n放射性衰变是一个由泊松统计控制的随机过程。对于均值为 $\\lambda$ 的泊松分布，其方差也是 $\\lambda$。记录的计数 $y$ 是该分布的一个样本。当在固定的竞争物浓度 $[I]_j$ 下进行多次重复测量 $\\{y_{j,k}\\}_{k=1}^{n_j}$ 时，样本均值 $\\bar{y}_j = \\frac{1}{n_j}\\sum_k y_{j,k}$ 是真实均值 $\\lambda_j$ 的一个估计。该样本均值的方差是：\n$$ \\mathrm{Var}(\\bar{y}_j) = \\frac{\\mathrm{Var}(y_j)}{n_j} = \\frac{\\lambda_j}{n_j} $$\n在加权最小二乘分析中，每个数据点 $(\\bar{y}_j)$ 的最优权重 $w_j$ 是该点方差的倒数：\n$$ w_j = \\frac{1}{\\mathrm{Var}(\\bar{y}_j)} = \\frac{n_j}{\\lambda_j} $$\n由于真实均值 $\\lambda_j$ 是未知的，它由样本均值 $\\bar{y}_j$ 来估计。这导致了以下由数据驱动的加权方案：\n$$ w_j \\approx \\frac{n_j}{\\bar{y}_j} $$\n为了在平均计数 $\\bar{y}_j$ 为零或接近零时确保数值稳定性，引入了一个小的正数下限 $\\varepsilon$，正如问题陈述中所指定的（$\\varepsilon = 10^{-9}$）：\n$$ w_j = \\frac{n_j}{\\max(\\bar{y}_j, \\varepsilon)} $$\n该加权方案恰当地考虑了异方差性，给予方差较小（即计数较高和/或重复次数较多）的数据点更大的影响。\n\n### 步骤 3：加权非线性最小二乘优化\n\n目标是找到最能描述实验数据的参数向量 $\\mathbf{p} = (K_i, c_{\\mathrm{spec}}, c_{\\mathrm{bg}})$。这是通过最小化加权残差平方和（$\\chi^2$）来实现的，其中残差是观测到的平均计数 $\\bar{y}_j$ 与模型 $f([I]_j; \\mathbf{p})$ 预测值之间的差异：\n$$ \\chi^2(\\mathbf{p}) = \\sum_{j} w_j \\left( \\bar{y}_j - f([I]_j; \\mathbf{p}) \\right)^2 $$\n这是一个非线性优化问题。标准的数值求解器，如 `scipy.optimize.least_squares`，被设计用于最小化残差向量的平方和。为了执行加权拟合，我们为优化器提供一个加权残差向量 $r'_j$：\n$$ r'_j = \\sqrt{w_j} \\left( \\bar{y}_j - f([I]_j; \\mathbf{p}) \\right) $$\n最小化 $\\sum_j (r'_j)^2$ 等价于最小化 $\\chi^2$ 函数。\n\n参数的物理性质施加了约束：解离常数和计数不能为负。因此，优化在以下边界条件下进行：$K_i \\geq 0$，$c_{\\mathrm{spec}} \\geq 0$，以及 $c_{\\mathrm{bg}} \\geq 0$。\n\n### 步骤 4：算法实现与初始参数猜测\n\n对于每个数据集，总体算法按以下步骤进行：\n1.  **数据聚合**：对于每个唯一的竞争物浓度 $[I]_j$，计算重复次数 $n_j$ 和计数的样本均值 $\\bar{y}_j$。\n2.  **权重计算**：使用步骤2中推导的公式计算每个数据点的权重 $w_j$。\n3.  **初始猜测值**：为优化器提供合理的参数初始猜测值 $\\mathbf{p}_0 = (K_{i,0}, c_{\\mathrm{spec},0}, c_{\\mathrm{bg},0})$。这些值基于对数据的简单检查，以确保稳健性：\n    -   $c_{\\mathrm{bg},0}$：最高竞争物浓度下的计数均值，该值近似于基线信号。\n    -   $c_{\\mathrm{spec},0}$：数据中观察到的最大平均计数（在 $[I]=0$ 时），作为特异性信号尺度的粗略估计。\n    -   $K_{i,0}$：非零竞争物浓度的中位数，为结合对竞争物最敏感的浓度范围提供一个数量级上的猜测。\n4.  **优化**：利用 `scipy.optimize.least_squares`，通过最小化加权残差的平方和来找到最优参数 $\\mathbf{p}$，并受非负性约束。\n5.  **输出格式化**：收集每个数据集的最终估计参数，并按要求格式化为三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the radioimmunoassay competitive binding problem for three datasets.\n    \"\"\"\n    epsilon = 1e-9\n\n    # Datasets provided in the problem statement.\n    # Each entry is a dictionary containing known constants L, Kd, and the\n    # experimental data as a list of (competitor_concentration, [replicate_counts]) tuples.\n    datasets = [\n        {\n            \"L\": 0.2, \"Kd\": 1.0,\n            \"data\": [\n                (0, [3798, 3860, 3845]),\n                (0.5, [3610, 3564, 3540]),\n                (1, [3365, 3330, 3402]),\n                (2, [2975, 3010, 3004]),\n                (5, [2320, 2298, 2345]),\n                (10, [1758, 1730, 1762]),\n                (50, [860, 845, 868]),\n                (200, [600, 592, 594])\n            ]\n        },\n        {\n            \"L\": 0.1, \"Kd\": 1.0,\n            \"data\": [\n                (0, [40, 42, 41, 43]),\n                (0.2, [39, 38, 40, 41]),\n                (0.5, [36, 37, 35, 38]),\n                (2, [26, 28, 30]),\n                (5, [18, 20, 21]),\n                (20, [10, 9]),\n                (100, [7, 0])\n            ]\n        },\n        {\n            \"L\": 2.0, \"Kd\": 0.5,\n            \"data\": [\n                (0, [25013, 24980, 25045]),\n                (0.1, [24510, 24588, 24470]),\n                (1, [20950, 21070, 21010]),\n                (3, [15990, 16020, 16030]),\n                (10, [9020, 8985, 9035]),\n                (100, [2150, 2125, 2100])\n            ]\n        }\n    ]\n\n    # Model function for competitive binding\n    # p = [Ki, c_spec, c_bg]\n    def binding_model(p, I, L, Kd):\n        Ki, c_spec, c_bg = p\n        \n        # To avoid division by zero if Ki is at its lower bound of 0\n        # for non-zero I, the term I/Ki becomes inf, and the fraction becomes 0.\n        # This is handled correctly by numpy.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            fraction_bound = ((L / Kd) / (1 + (L / Kd) + (I / Ki)))\n        # Handle the case where I=0 and Ki=0, which would result in nan.\n        # If I=0, the I/Ki term must be 0 regardless of Ki.\n        fraction_bound[I == 0] = ((L / Kd) / (1 + (L / Kd)))\n\n        return c_bg + c_spec * fraction_bound\n\n    # Residuals function for least_squares\n    def residuals(p, I, y_mean, weights, L, Kd):\n        model_y = binding_model(p, I, L, Kd)\n        return np.sqrt(weights) * (y_mean - model_y)\n\n    all_results = []\n\n    for dataset in datasets:\n        # 1. Process data: aggregate replicates and calculate mean counts\n        concentrations = np.array([d[0] for d in dataset[\"data\"]])\n        counts_data = [d[1] for d in dataset[\"data\"]]\n        \n        mean_counts = np.array([np.mean(c) for c in counts_data])\n        num_replicates = np.array([len(c) for c in counts_data])\n\n        # 2. Calculate weights based on Poisson statistics\n        weights = num_replicates / np.maximum(mean_counts, epsilon)\n        \n        # 3. Set initial parameter guesses and bounds\n        L = dataset[\"L\"]\n        Kd = dataset[\"Kd\"]\n        \n        # Initial guesses based on data inspection\n        p0_c_bg = mean_counts[-1] if len(mean_counts) > 0 else 1.0\n        p0_c_spec = mean_counts[0] if len(mean_counts) > 0 else 1.0\n        non_zero_concs = concentrations[concentrations > 0]\n        p0_Ki = np.median(non_zero_concs) if len(non_zero_concs) > 0 else 1.0\n        \n        p0 = [p0_Ki, p0_c_spec, p0_c_bg]\n        bounds = ([0, 0, 0], [np.inf, np.inf, np.inf])\n\n        # 4. Perform weighted nonlinear least squares fitting\n        result = least_squares(\n            residuals,\n            p0,\n            bounds=bounds,\n            args=(concentrations, mean_counts, weights, L, Kd),\n            method='trf'\n        )\n        fit_params = result.x\n        all_results.append(fit_params)\n\n    # 5. Format results for final output\n    results_str = []\n    for params in all_results:\n        # Format: [Ki, c_spec, c_bg] to 3 decimal places\n        formatted_params = f\"[{params[0]:.3f},{params[1]:.3f},{params[2]:.3f}]\"\n        results_str.append(formatted_params)\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(results_str)}]\")\n\n\nsolve()\n```"
        }
    ]
}