{
    "hands_on_practices": [
        {
            "introduction": "定量PCR的核心在于利用标准曲线将循环阈值（$C_t$值）与靶核酸的初始量关联起来。本练习旨在揭示标准曲线斜率与PCR扩增的基本参数——扩增效率之间的深刻数学联系。掌握这一关系是验证和评估任何qPCR检测性能的基石，能让您从根本上理解定量结果的由来。",
            "id": "5145689",
            "problem": "采用一种使用水解探针（TaqMan化学）的定量聚合酶链式反应 (qPCR) 检测方法来检测临床样本中的单拷贝基因组靶标。在qPCR中，循环阈值 (Ct) 定义为荧光信号穿过一个固定阈值时的循环数。使用已知起始拷贝数且跨越了几个数量级的校准标准品构建了一条标准曲线。该检测方法产生了一条线性标准曲线，其回归斜率为$-3.32$（单位：循环数/$\\log_{10}$拷贝数），截距为$38.5$个循环。\n\n假设以下基本事实和定义：\n- 达到阈值前的扩增过程可以很好地近似为每循环恒定效率的指数增长，因此在$c$个循环后，扩增子的拷贝数$N(c) = N_{0} (1+E)^{c}$，其中$N_{0}$是初始拷贝数，$E$是表示为小数的每循环扩增效率。\n- 荧光阈值对应一个固定的扩增子拷贝数$N_{\\text{th}}$，该值对所有标准品和样本都相同。\n- 标准曲线是通过绘制$Ct$对$\\log_{10}(N_{0})$的图得到的，其斜率和截距反映了内在的指数扩增和固定阈值。\n\n从这些假设出发，并利用对数的性质，首先推导标准曲线的斜率如何制约扩增效率$E$，过程中不引入除上述事实之外的任何新的经验性捷径。然后，对于一个含有$10^{4}$个初始拷贝数的样本，使用给定的斜率和截距确定其预期的$Ct$值。\n\n报告$Ct$（单位：循环数）和$E$（以小数形式，而非百分比）的最终数值结果。将两个值都四舍五入到四位有效数字，并按$\\left[ Ct,\\; E \\right]$的顺序以行向量的形式一起提供。",
            "solution": "该问题已经过验证，被认为具有科学依据、提法得当且内部一致。它描述了一个标准的定量聚合酶链式反应 (qPCR) 实验，并基于所提供的模型和数据提出了两个可计算的问题。\n\n该问题要求得到两个主要结果：首先，推导标准曲线斜率和扩增效率之间的关系；其次，计算给定初始拷贝数($N_0$)时的循环阈值($Ct$)和扩增效率($E$)。\n\n首先，我们推导标准曲线斜率($m$)与扩增效率($E$)之间的关系。基本假设是，经过$c$个循环后，扩增子拷贝数$N(c)$由以下指数增长模型给出：\n$$N(c) = N_0 (1+E)^c$$\n其中$N_0$是初始拷贝数，$E$是每循环扩增效率。\n\n循环阈值$Ct$定义为扩增子拷贝数达到固定阈值$N_{\\text{th}}$时的循环数。因此，当$c=Ct$时，我们有：\n$$N_{\\text{th}} = N_0 (1+E)^{Ct}$$\n标准曲线是$Ct$对$\\log_{10}(N_0)$的图。为推导其方程，我们对上式两边取以10为底的对数：\n$$\\log_{10}(N_{\\text{th}}) = \\log_{10}\\left(N_0 (1+E)^{Ct}\\right)$$\n使用对数性质$\\log(ab) = \\log(a) + \\log(b)$，我们可以将右侧的项分开：\n$$\\log_{10}(N_{\\text{th}}) = \\log_{10}(N_0) + \\log_{10}\\left((1+E)^{Ct}\\right)$$\n使用对数性质$\\log(a^b) = b\\log(a)$，我们可以将指数$Ct$移下来：\n$$\\log_{10}(N_{\\text{th}}) = \\log_{10}(N_0) + Ct \\cdot \\log_{10}(1+E)$$\n为了将其表示为标准曲线的线性方程形式$y = mx + b$，其中$y=Ct$且$x=\\log_{10}(N_0)$，我们重新整理方程以解出$Ct$：\n$$Ct \\cdot \\log_{10}(1+E) = -\\log_{10}(N_0) + \\log_{10}(N_{\\text{th}})$$\n$$Ct = \\left(\\frac{-1}{\\log_{10}(1+E)}\\right) \\log_{10}(N_0) + \\frac{\\log_{10}(N_{\\text{th}})}{\\log_{10}(1+E)}$$\n将此推导出的方程与标准线性形式$Ct = m \\cdot \\log_{10}(N_0) + b$进行比较，我们可以确定斜率$m$为：\n$$m = \\frac{-1}{\\log_{10}(1+E)}$$\n这就是根据斜率$m$制约扩增效率$E$的推导关系。\n\n现在，我们可以使用这个关系来计算$E$的值。问题陈述标准曲线的斜率为$m = -3.32$。\n$$-3.32 = \\frac{-1}{\\log_{10}(1+E)}$$\n解出$\\log_{10}(1+E)$：\n$$\\log_{10}(1+E) = \\frac{-1}{-3.32} = \\frac{1}{3.32}$$\n为了解出$E$，我们首先取反对数（即以10为底，对两边取幂）：\n$$1+E = 10^{(1/3.32)}$$\n$$E = 10^{(1/3.32)} - 1$$\n现在，我们可以计算其数值：\n$$E \\approx 10^{0.3012048} - 1 \\approx 2.000906 - 1 = 1.000906$$\n四舍五入到四位有效数字，效率$E$为：\n$$E \\approx 1.001$$\n注意，效率$E=1$对应于每个循环产物的完美倍增，也称为$100\\%$的效率。计算出的值非常接近这个理想情况。\n\n接下来，我们确定含有$N_0 = 10^4$个初始拷贝数的样本的预期$Ct$值。问题通过斜率$m = -3.32$和截距$b = 38.5$提供了标准曲线的线性回归方程：\n$$Ct = m \\cdot \\log_{10}(N_0) + b$$\n代入给定值和指定的$N_0$：\n$$Ct = (-3.32) \\cdot \\log_{10}(10^4) + 38.5$$\n对数项为$\\log_{10}(10^4) = 4$。\n$$Ct = (-3.32) \\cdot 4 + 38.5$$\n$$Ct = -13.28 + 38.5$$\n$$Ct = 25.22$$\n这个值已经有四位有效数字。\n\n最终要求的结果是$Ct$和效率$E$，四舍五入到四位有效数字，并以行向量$[Ct, E]$的形式呈现。\n\n计算出的值为$Ct = 25.22$和$E = 1.001$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n25.22  1.001\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际应用中，qPCR的原始荧光数据并非理想曲线，常常包含必须校正的背景“噪声”或基线“漂移”。本练习将引导您深入研究基线漂移的数学模型，并展示如何通过计算“净化”原始数据以分离出真实的扩增信号。这一过程是所有qPCR分析软件自动执行的关键步骤，理解其原理对排除故障和解读复杂数据至关重要。",
            "id": "5145724",
            "problem": "定量聚合酶链式反应 (qPCR) 检测法使用一种嵌入染料来检测双链脱氧核糖核酸 (dsDNA) 扩增子，该染料的荧光与 dsDNA 浓度成正比。在扩增的早期指数阶段，循环 $c$ 后的扩增子数量遵循 $N(c) = N_{0} (1+E)^{c}$，其中 $N_{0}$ 是初始目标数量，$E \\in (0,1]$ 是每循环效率。每循环的原始荧光信号被建模为依赖于扩增子的信号与由光学和试剂效应引起的加性基线漂移之和。具体来说，对于循环指数 $c$（通过阈值设定中使用的标准插值法处理为连续变量），原始信号为\n$$F_{\\text{raw}}(c) = \\alpha (1+E)^{c} + B(c),$$\n其中 $\\alpha > 0$ 是在指数阶段将扩增子数量与荧光联系起来的比例常数，基线漂移是循环的线性函数，\n$$B(c) = B_{0} + k c,$$\n其中 $B_{0}$ 是基线截距，$k$ 是基线斜率。基线校正后的荧光定义为 $F_{\\text{corr}}(c) = F_{\\text{raw}}(c) - B(c)$。阈值循环 (Ct)，也称为定量循环 (Cq)，定义为基线校正后的荧光首次等于在指数区域内选择的固定阈值 $T$ 时的循环数 $c$（可能是小数）：\n$$F_{\\text{corr}}(c) = T.$$\n\n仅使用上述定义和阈值 $T$ 设定在指数区间内（因此指数模型适用）的假设，从第一性原理推导 Ct 的表达式，然后对以下参数进行数值计算：\n- $B_{0} = 1500$ 任意荧光单位，\n- $k = 18$ 任意荧光单位/循环，\n- $\\alpha = 25$ 任意荧光单位，\n- $E = 0.9$，\n- $T = 2.5 \\times 10^{6}$ 任意荧光单位。\n\n将最终的 Ct 以循环为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求在定量 PCR (qPCR) 检测中，推导并随后对阈值循环（表示为 $C_t$ 或 $C_q$）进行数值评估。\n\n首先，我们根据所提供的定义建立理论框架。在循环 $c$ 时的原始荧光信号 $F_{\\text{raw}}(c)$ 由一个依赖于扩增子的指数项和一个线性基线漂移项 $B(c)$ 的和给出。\n$$F_{\\text{raw}}(c) = \\alpha (1+E)^{c} + B(c)$$\n基线漂移定义为：\n$$B(c) = B_{0} + k c$$\n基线校正后的荧光 $F_{\\text{corr}}(c)$ 定义为原始信号减去基线漂移：\n$$F_{\\text{corr}}(c) = F_{\\text{raw}}(c) - B(c)$$\n将 $F_{\\text{raw}}(c)$ 和 $B(c)$ 的表达式代入 $F_{\\text{corr}}(c)$ 的定义中，得到：\n$$F_{\\text{corr}}(c) = \\left( \\alpha (1+E)^{c} + B(c) \\right) - B(c)$$\n基线漂移项 $B(c)$ 被消去，将基线校正后的荧光表达式简化为：\n$$F_{\\text{corr}}(c) = \\alpha (1+E)^{c}$$\n这一结果意义重大，因为它表明，根据定义，基线校正后的荧光仅取决于指数扩增阶段的参数（$\\alpha$、$E$），而与基线截距 $B_0$ 和斜率 $k$ 无关。\n\n阈值循环 $C_t$ 定义为基线校正后的荧光达到预定阈值 $T$ 时的循环数。在数学上，这表示为：\n$$F_{\\text{corr}}(C_t) = T$$\n通过将我们推导出的 $F_{\\text{corr}}(c)$ 表达式在 $c = C_t$ 时进行代入，我们得到 $C_t$ 的控制方程：\n$$\\alpha (1+E)^{C_t} = T$$\n现在必须求解这个方程以得到 $C_t$。我们进行代数重排。首先，我们通过将两边同时除以 $\\alpha$ 来分离指数项（由于 $\\alpha > 0$，这是允许的）：\n$$(1+E)^{C_t} = \\frac{T}{\\alpha}$$\n接下来，为了求解指数 $C_t$，我们对等式两边取自然对数 ($\\ln$)：\n$$\\ln\\left((1+E)^{C_t}\\right) = \\ln\\left(\\frac{T}{\\alpha}\\right)$$\n使用对数恒等式 $\\ln(x^y) = y \\ln(x)$，我们可以将指数 $C_t$ 移下来：\n$$C_t \\ln(1+E) = \\ln\\left(\\frac{T}{\\alpha}\\right)$$\n最后，我们通过除以 $\\ln(1+E)$ 来分离 $C_t$。由于效率 $E \\in (0,1]$，因此 $1+E \\in (1,2]$，所以 $\\ln(1+E) > 0$，确保了除法是明确定义的。这得出了阈值循环的一般解析表达式：\n$$C_t = \\frac{\\ln\\left(\\frac{T}{\\alpha}\\right)}{\\ln(1+E)}$$\n这是从第一性原理推导出的 $C_t$ 表达式。\n\n现在，我们使用提供的参数对该表达式进行数值计算：\n- 基线截距, $B_{0} = 1500$\n- 基线斜率, $k = 18$\n- 比例常数, $\\alpha = 25$\n- 扩增效率, $E = 0.9$\n- 荧光阈值, $T = 2.5 \\times 10^{6}$\n\n正如在推导过程中所确立的，$B_{0}$ 和 $k$ 这两个参数不出现在 $C_t$ 的最终方程中，因此对其计算是无关的。我们将相关值代入我们推导出的公式中：\n$$C_t = \\frac{\\ln\\left(\\frac{2.5 \\times 10^{6}}{25}\\right)}{\\ln(1+0.9)}$$\n首先，我们简化分子对数的参数：\n$$\\frac{2.5 \\times 10^{6}}{25} = \\frac{2.5}{25} \\times 10^{6} = 0.1 \\times 10^{6} = 10^{5}$$\n$C_t$ 的方程变为：\n$$C_t = \\frac{\\ln(10^{5})}{\\ln(1.9)}$$\n现在，我们计算对数的数值：\n$$\\ln(10^{5}) \\approx 11.51292546$$\n$$\\ln(1.9) \\approx 0.64185389$$\n进行最后的除法运算得出：\n$$C_t \\approx \\frac{11.51292546}{0.64185389} \\approx 17.9371725$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$7$、$9$ 和 $3$。第五位数字是 $7$，大于或等于 $5$，因此我们将第四位有效数字向上取整。\n$$C_t \\approx 17.94$$\n得出的阈值循环约为 $17.94$ 个循环。",
            "answer": "$$\\boxed{17.94}$$"
        },
        {
            "introduction": "为了提高检测通量，多重qPCR检测（multiplex qPCR）利用不同荧光染料在单次反应中同时检测多个靶标。然而，这些染料的光谱存在重叠，其信号会“泄露”到彼此的检测通道中，造成信号交叉干扰（cross-talk）。本练习将应用线性代数方法来执行“颜色补偿”，这是一种数学解混技术，用于从混合信号中准确地恢复每个靶标的真实荧光强度，是多重分析中保证准确定量的核心环节。",
            "id": "5145687",
            "problem": "进行了一项多重定量聚合酶链反应 (qPCR) 检测，其中三种不同的荧光报告分子与扩增子结合，其真实发射强度构成一个列向量 $\\mathbf{x} \\in \\mathbb{R}^{3}$，单位为任意单位 (a.u.)。该仪器使用三个光学通道，报告分子之间存在已知的光谱串扰，且检测器在目标荧光范围内表现出线性行为。在这些条件下，测得的通道强度 $\\mathbf{y} \\in \\mathbb{R}^{3}$ 遵循一个加性线性混合模型。该模型基于叠加原理和线性检测器响应，与低吸光度下的比尔-朗伯定律以及恒定激发下的线性荧光团发射相一致。串扰结构由一个混合矩阵 $\\mathbf{A} \\in \\mathbb{R}^{3 \\times 3}$ 表示，其元素量化了每个报告分子的发射对每个检测通道的贡献。\n\n假设对于一个三报告分子组合和一个校准良好的仪器，有以下经过物理验证的量：\n$$\n\\mathbf{A} = \\begin{bmatrix}\n1  0.2  0 \\\\\n0.1  1  0.15 \\\\\n0  0.1  1\n\\end{bmatrix},\n\\qquad\n\\mathbf{y} = \\begin{bmatrix}\n100 \\\\\n80 \\\\\n60\n\\end{bmatrix} \\text{ a.u.}.\n$$\n确定与这些测量值和线性混合关系一致的未混合真实强度 $\\mathbf{x}$，并根据 $\\mathbf{A}$ 的非对角线元素所隐含的测量信号的相对比例，简要解释通道间的串扰贡献。\n\n以任意单位 (a.u.) 表示未混合强度向量的每个分量。将每个分量四舍五入到四位有效数字。",
            "solution": "该问题要求从测得的通道强度（由向量 $\\mathbf{y}$ 表示）中确定真实的、未混合的荧光报告分子强度（由向量 $\\mathbf{x}$ 表示）。这些量之间的关系由一个线性混合模型给出，这是一个线性方程组：\n$$\n\\mathbf{y} = \\mathbf{A} \\mathbf{x}\n$$\n此处，$\\mathbf{A}$ 是量化报告分子与检测通道之间光谱串扰的混合矩阵。为了求出未混合的强度 $\\mathbf{x}$，我们必须解这个方程组。如果矩阵 $\\mathbf{A}$ 是可逆的，则存在唯一解，由下式给出：\n$$\n\\mathbf{x} = \\mathbf{A}^{-1} \\mathbf{y}\n$$\n首先，我们必须通过验证 $\\mathbf{A}$ 是否可逆来确认该问题是适定的，这当且仅当其行列式 $\\det(\\mathbf{A})$ 不为零时成立。给定的混合矩阵是：\n$$\n\\mathbf{A} = \\begin{bmatrix}\n1  0.2  0 \\\\\n0.1  1  0.15 \\\\\n0  0.1  1\n\\end{bmatrix}\n$$\n行列式可以使用莱布尼茨公式或代数余子式展开来计算。沿第一行进行代数余子式展开：\n$$\n\\det(\\mathbf{A}) = 1 \\begin{vmatrix} 1  0.15 \\\\ 0.1  1 \\end{vmatrix} - 0.2 \\begin{vmatrix} 0.1  0.15 \\\\ 0  1 \\end{vmatrix} + 0 \\begin{vmatrix} 0.1  1 \\\\ 0  0.1 \\end{vmatrix}\n$$\n$$\n\\det(\\mathbf{A}) = 1((1)(1) - (0.15)(0.1)) - 0.2((0.1)(1) - (0.15)(0)) + 0\n$$\n$$\n\\det(\\mathbf{A}) = 1(1 - 0.015) - 0.2(0.1) = 0.985 - 0.02 = 0.965\n$$\n由于 $\\det(\\mathbf{A}) = 0.965 \\neq 0$，矩阵 $\\mathbf{A}$ 是可逆的，因此存在 $\\mathbf{x}$ 的唯一解。\n\n接下来，我们使用公式 $\\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\text{adj}(\\mathbf{A})$ 计算逆矩阵 $\\mathbf{A}^{-1}$，其中 $\\text{adj}(\\mathbf{A})$ 是 $\\mathbf{A}$ 的伴随矩阵（其代数余子式矩阵的转置）。代数余子式矩阵 $\\mathbf{C}$ 的元素为 $C_{ij} = (-1)^{i+j} M_{ij}$，其中 $M_{ij}$ 是元素 $A_{ij}$ 的子式。\n\n代数余子式为：\n$C_{11} = +\\begin{vmatrix} 1  0.15 \\\\ 0.1  1 \\end{vmatrix} = 0.985$\n$C_{12} = -\\begin{vmatrix} 0.1  0.15 \\\\ 0  1 \\end{vmatrix} = -0.1$\n$C_{13} = +\\begin{vmatrix} 0.1  1 \\\\ 0  0.1 \\end{vmatrix} = 0.01$\n\n$C_{21} = -\\begin{vmatrix} 0.2  0 \\\\ 0.1  1 \\end{vmatrix} = -0.2$\n$C_{22} = +\\begin{vmatrix} 1  0 \\\\ 0  1 \\end{vmatrix} = 1$\n$C_{23} = -\\begin{vmatrix} 1  0.2 \\\\ 0  0.1 \\end{vmatrix} = -0.1$\n\n$C_{31} = +\\begin{vmatrix} 0.2  0 \\\\ 1  0.15 \\end{vmatrix} = 0.03$\n$C_{32} = -\\begin{vmatrix} 1  0 \\\\ 0.1  0.15 \\end{vmatrix} = -0.15$\n$C_{33} = +\\begin{vmatrix} 1  0.2 \\\\ 0.1  1 \\end{vmatrix} = 0.98$\n\n代数余子式矩阵是 $\\mathbf{C} = \\begin{bmatrix} 0.985  -0.1  0.01 \\\\ -0.2  1  -0.1 \\\\ 0.03  -0.15  0.98 \\end{bmatrix}$。\n伴随矩阵是 $\\mathbf{C}$ 的转置：\n$$\n\\text{adj}(\\mathbf{A}) = \\mathbf{C}^T = \\begin{bmatrix} 0.985  -0.2  0.03 \\\\ -0.1  1  -0.15 \\\\ 0.01  -0.1  0.98 \\end{bmatrix}\n$$\n因此，逆矩阵是：\n$$\n\\mathbf{A}^{-1} = \\frac{1}{0.965} \\begin{bmatrix} 0.985  -0.2  0.03 \\\\ -0.1  1  -0.15 \\\\ 0.01  -0.1  0.98 \\end{bmatrix}\n$$\n现在，我们可以通过将 $\\mathbf{A}^{-1}$ 与测得的强度向量 $\\mathbf{y}$ 相乘来计算真实强度向量 $\\mathbf{x}$：\n$$\n\\mathbf{x} = \\mathbf{A}^{-1}\\mathbf{y} = \\frac{1}{0.965} \\begin{bmatrix} 0.985  -0.2  0.03 \\\\ -0.1  1  -0.15 \\\\ 0.01  -0.1  0.98 \\end{bmatrix} \\begin{bmatrix} 100 \\\\ 80 \\\\ 60 \\end{bmatrix}\n$$\n进行矩阵向量乘法：\n$$\n\\mathbf{x} = \\frac{1}{0.965} \\begin{bmatrix} (0.985)(100) + (-0.2)(80) + (0.03)(60) \\\\ (-0.1)(100) + (1)(80) + (-0.15)(60) \\\\ (0.01)(100) + (-0.1)(80) + (0.98)(60) \\end{bmatrix}\n$$\n$$\n\\mathbf{x} = \\frac{1}{0.965} \\begin{bmatrix} 98.5 - 16 + 1.8 \\\\ -10 + 80 - 9 \\\\ 1 - 8 + 58.8 \\end{bmatrix} = \\frac{1}{0.965} \\begin{bmatrix} 84.3 \\\\ 61 \\\\ 51.8 \\end{bmatrix}\n$$\n最后，将每个分量除以行列式：\n$x_1 = \\frac{84.3}{0.965} \\approx 87.35751295...$\n$x_2 = \\frac{61}{0.965} \\approx 63.21243523...$\n$x_3 = \\frac{51.8}{0.965} \\approx 53.67875647...$\n\n将每个分量四舍五入到四位有效数字，得到未混合的真实强度：\n$x_1 \\approx 87.36 \\text{ a.u.}$\n$x_2 \\approx 63.21 \\text{ a.u.}$\n$x_3 \\approx 53.68 \\text{ a.u.}$\n\n对于解释部分，混合矩阵的非对角线元素 $A_{ij}$ 代表报告分子 $j$ 的真实强度 ($x_j$) 对通道 $i$ 中测得的信号 ($y_i$) 的贡献分数。\n使用计算出的真实强度，对测量信号的串扰贡献如下：\n- 对于通道 1 ($y_1 = 100$)：串扰来自报告分子 2。其贡献为 $A_{12}x_2 = 0.2 \\times 63.21 = 12.642$ a.u.。这构成了通道 1 总信号的 $\\frac{12.642}{100} \\approx 12.6\\%$。\n- 对于通道 2 ($y_2 = 80$)：串扰来自报告分子 1 和 3。来自报告分子 1 的贡献是 $A_{21}x_1 = 0.1 \\times 87.36 = 8.736$ a.u.。来自报告分子 3 的贡献是 $A_{23}x_3 = 0.15 \\times 53.68 = 8.052$ a.u.。总串扰信号为 $8.736 + 8.052 = 16.788$ a.u.，占通道 2 总信号的 $\\frac{16.788}{80} \\approx 21.0\\%$。\n- 对于通道 3 ($y_3 = 60$)：串扰来自报告分子 2。其贡献为 $A_{32}x_2 = 0.1 \\times 63.21 = 6.321$ a.u.。这构成了通道 3 总信号的 $\\frac{6.321}{60} \\approx 10.5\\%$。\n该分析量化了测量信号是如何由主报告分子信号和其他报告分子的溢出（spillover）组成的，因此需要通过数学解卷积来恢复真实强度。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 87.36  63.21  53.68 \\end{pmatrix}}\n$$"
        }
    ]
}