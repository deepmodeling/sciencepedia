{
    "hands_on_practices": [
        {
            "introduction": "轻度认知障碍 (MCI) 的临床诊断始于神经心理学测试。然而，原始测试分数本身并无意义，除非将其与适当的参照组进行比较。为了客观地评估患者的表现，我们使用基于回归的常模来校正年龄和教育等人口统计学因素的影响，然后将原始分数转换为标准化的 $z$ 分数。\n\n本练习  为您提供了临床神经心理学家核心定量技能的直接实践机会。您将学习如何计算预期分数、标准化患者表现，并应用客观标准来确定不同认知领域的损伤情况，这是MCI评估的基础。",
            "id": "4496131",
            "problem": "一名$72$岁、惯用右手的个体，接受了$16$年正规教育，因疑似轻度认知障碍（MCI）在记忆障碍门诊接受评估。我们对其进行了涵盖四个认知领域的标准神经心理学测试。每项测试都有考虑了年龄和教育程度的基于回归的常模，以及相应的残差标准差。年龄和教育程度分别以$60$岁和$12$年为中心进行中心化，因此测试的常模期望值由以下公式给出：\n$$\nE[\\text{score}] \\;=\\; \\alpha \\;+\\; \\beta_{\\text{age}} \\cdot (\\text{Age} - 60) \\;+\\; \\beta_{\\text{edu}} \\cdot (\\text{Education} - 12).\n$$\n对于原始分数越高表示表现越好的测试，使用期望值和测试的残差标准差将原始分数标准化为$z$分数。对于时间越短表示表现越好的计时测试，进行标准化，使得标准化后的分数越高表示表现越好。\n\n患者的原始分数和回归参数如下：\n- 记忆领域：\n  - 即刻言语列表回忆（回忆出的项目数，范围$0$到$15$）：参数 $\\alpha = 11.0$, $\\beta_{\\text{age}} = -0.04$, $\\beta_{\\text{edu}} = 0.25$, 残差 $\\sigma_{\\epsilon} = 1.2$。原始分数 $= 9$。\n  - 延迟言语列表回忆（回忆出的项目数，范围$0$到$15$）：参数 $\\alpha = 8.5$, $\\beta_{\\text{age}} = -0.03$, $\\beta_{\\text{edu}} = 0.20$, 残差 $\\sigma_{\\epsilon} = 1.0$。原始分数 $= 6$。\n- 执行功能领域：\n  - 连线测验B部分完成时间（秒；数值越低表示表现越好）：参数 $\\alpha = 85$, $\\beta_{\\text{age}} = 0.8$, $\\beta_{\\text{edu}} = -1.5$, 残差 $\\sigma_{\\epsilon} = 18$。原始分数 $= 120$。\n- 语言领域：\n  - 类别流畅性（每分钟说出的动物名）：参数 $\\alpha = 20$, $\\beta_{\\text{age}} = -0.10$, $\\beta_{\\text{edu}} = 0.50$, 残差 $\\sigma_{\\epsilon} = 3$。原始分数 $= 16$。\n- 视空间领域：\n  - Rey–Osterrieth复杂图形测验临摹分数（范围$0$到$36$）：参数 $\\alpha = 29$, $\\beta_{\\text{age}} = -0.05$, $\\beta_{\\text{edu}} = 0.15$, 残差 $\\sigma_{\\epsilon} = 2$。原始分数 $= 26$。\n\n任务：\n- 使用基于回归的期望值和残差标准差，计算每项测试的标准化$z$分数，并对齐方向性，使得所有测试中，更高的标准化值都表示更好的表现。\n- 计算记忆领域的领域水平$z$分数，其值为两个记忆测试$z$分数的算术平均值。执行功能、语言和视空间领域的领域水平$z$分数分别等于其各自的单项测试标准化$z$分数。\n- 使用“如果一个认知领域的领域水平$z$分数小于或等于$-1.5$，则该领域被认为受损”这一标准，对每个领域进行分类。\n- 最后，计算加权总体认知$z$分数\n$$\nz_{\\text{global}} \\;=\\; w_{\\text{mem}} z_{\\text{mem}} \\;+\\; w_{\\text{exec}} z_{\\text{exec}} \\;+\\; w_{\\text{lang}} z_{\\text{lang}} \\;+\\; w_{\\text{vis}} z_{\\text{vis}},\n$$\n权重为 $\\mathbf{w} = (w_{\\text{mem}}, w_{\\text{exec}}, w_{\\text{lang}}, w_{\\text{vis}}) = (0.30,\\, 0.25,\\, 0.25,\\, 0.20)$。\n\n将最终的加权总体认知$z$分数表示为一个实数，四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "首先验证问题，以确保其是适定的、有科学依据且客观的。\n\n### 步骤1：提取已知条件\n- 患者人口学信息：年龄 $= 72$ 岁，教育程度 $= 16$ 年，右利手。\n- 常模模型：$E[\\text{score}] = \\alpha + \\beta_{\\text{age}} \\cdot (\\text{Age} - 60) + \\beta_{\\text{edu}} \\cdot (\\text{Education} - 12)$。\n- 标准化规则：对于分数越高越好的测试，$z = (\\text{Raw Score} - E[\\text{score}]) / \\sigma_{\\epsilon}$。对于分数越低越好的测试，标准化以使更高的$z$分数表示更好的表现。\n- 记忆/即刻回忆（越高越好）：原始分数 $= 9$，$\\alpha = 11.0$, $\\beta_{\\text{age}} = -0.04$, $\\beta_{\\text{edu}} = 0.25$, $\\sigma_{\\epsilon} = 1.2$。\n- 记忆/延迟回忆（越高越好）：原始分数 $= 6$，$\\alpha = 8.5$, $\\beta_{\\text{age}} = -0.03$, $\\beta_{\\text{edu}} = 0.20$, $\\sigma_{\\epsilon} = 1.0$。\n- 执行功能/连线测验B部分（越低越好）：原始分数 $= 120$ 秒，$\\alpha = 85$, $\\beta_{\\text{age}} = 0.8$, $\\beta_{\\text{edu}} = -1.5$, $\\sigma_{\\epsilon} = 18$。\n- 语言/类别流畅性（越高越好）：原始分数 $= 16$，$\\alpha = 20$, $\\beta_{\\text{age}} = -0.10$, $\\beta_{\\text{edu}} = 0.50$, $\\sigma_{\\epsilon} = 3$。\n- 视空间/Rey–Osterrieth临摹（越高越好）：原始分数 $= 26$，$\\alpha = 29$, $\\beta_{\\text{age}} = -0.05$, $\\beta_{\\text{edu}} = 0.15$, $\\sigma_{\\epsilon} = 2$。\n- 领域分数聚合：记忆领域$z$分数是其两个测试$z$分数的算术平均值。其他领域分数是其各自的单项测试$z$分数。\n- 损伤标准：如果一个领域的领域水平$z$分数 $\\le -1.5$，则该领域被认为受损。\n- 总体认知分数：$z_{\\text{global}} = w_{\\text{mem}} z_{\\text{mem}} + w_{\\text{exec}} z_{\\text{exec}} + w_{\\text{lang}} z_{\\text{lang}} + w_{\\text{vis}} z_{\\text{vis}}$。\n- 权重：$(w_{\\text{mem}}, w_{\\text{exec}}, w_{\\text{lang}}, w_{\\text{vis}}) = (0.30, 0.25, 0.25, 0.20)$。\n- 最终指令：将最终的加权总体认知$z$分数四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **有科学依据：**该问题使用标准的神经心理学评估方法，包括基于回归的常模和$z$分数转换。所列的认知测试是标准工具，其方法学与临床神经心理学中诊断轻度认知障碍等病症的实践相符。\n- **适定性：**所有必要的数据（原始分数、回归参数、标准差、公式）均已提供。任务按顺序定义，并可导出一个唯一的数值解。\n- **客观性：**该问题以定量和正式的术语陈述，没有主观或模糊的语言。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题过程\n第一步是为回归模型计算患者特定的人口学变量。患者年龄为$72$岁，教育程度为$16$年。中心化后的变量为：\n- 中心化年龄：$\\text{Age} - 60 = 72 - 60 = 12$。\n- 中心化教育程度：$\\text{Education} - 12 = 16 - 12 = 4$。\n\n接下来，我们计算每项测试的期望分数和标准化$z$分数。\n\n**1. 记忆领域：即刻言语列表回忆**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{mem,imm}} = 11.0 + (-0.04)(\\text{Age} - 60) + (0.25)(\\text{Education} - 12) $$\n$$ E_{\\text{mem,imm}} = 11.0 + (-0.04)(12) + (0.25)(4) = 11.0 - 0.48 + 1.0 = 11.52 $$\n- 标准化$z$分数为：\n$$ z_{\\text{mem,imm}} = \\frac{\\text{Raw Score} - E_{\\text{mem,imm}}}{\\sigma_{\\epsilon}} = \\frac{9 - 11.52}{1.2} = \\frac{-2.52}{1.2} = -2.1 $$\n\n**2. 记忆领域：延迟言语列表回忆**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{mem,del}} = 8.5 + (-0.03)(\\text{Age} - 60) + (0.20)(\\text{Education} - 12) $$\n$$ E_{\\text{mem,del}} = 8.5 + (-0.03)(12) + (0.20)(4) = 8.5 - 0.36 + 0.8 = 8.94 $$\n- 标准化$z$分数为：\n$$ z_{\\text{mem,del}} = \\frac{\\text{Raw Score} - E_{\\text{mem,del}}}{\\sigma_{\\epsilon}} = \\frac{6 - 8.94}{1.0} = -2.94 $$\n\n**3. 执行功能领域：连线测验B部分**\n这是一个“分数越低越好”（计时）的测试。为使其与“标准化值越高表示表现越好”的方向对齐，$z$分数的分子被反转。\n- 期望分数（时间）为：\n$$ E_{\\text{exec}} = 85 + (0.8)(\\text{Age} - 60) + (-1.5)(\\text{Education} - 12) $$\n$$ E_{\\text{exec}} = 85 + (0.8)(12) + (-1.5)(4) = 85 + 9.6 - 6.0 = 88.6 $$\n- 标准化$z$分数为：\n$$ z_{\\text{exec}} = \\frac{E_{\\text{exec}} - \\text{Raw Score}}{\\sigma_{\\epsilon}} = \\frac{88.6 - 120}{18} = \\frac{-31.4}{18} \\approx -1.7444... $$\n\n**4. 语言领域：类别流畅性**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{lang}} = 20 + (-0.10)(\\text{Age} - 60) + (0.50)(\\text{Education} - 12) $$\n$$ E_{\\text{lang}} = 20 + (-0.10)(12) + (0.50)(4) = 20 - 1.2 + 2.0 = 20.8 $$\n- 标准化$z$分数为：\n$$ z_{\\text{lang}} = \\frac{\\text{Raw Score} - E_{\\text{lang}}}{\\sigma_{\\epsilon}} = \\frac{16 - 20.8}{3} = \\frac{-4.8}{3} = -1.6 $$\n\n**5. 视空间领域：Rey–Osterrieth复杂图形测验临摹**\n这是一个“分数越高越好”的测试。\n- 期望分数为：\n$$ E_{\\text{vis}} = 29 + (-0.05)(\\text{Age} - 60) + (0.15)(\\text{Education} - 12) $$\n$$ E_{\\text{vis}} = 29 + (-0.05)(12) + (0.15)(4) = 29 - 0.6 + 0.6 = 29.0 $$\n- 标准化$z$分数为：\n$$ z_{\\text{vis}} = \\frac{\\text{Raw Score} - E_{\\text{vis}}}{\\sigma_{\\epsilon}} = \\frac{26 - 29.0}{2} = \\frac{-3.0}{2} = -1.5 $$\n\n接下来，我们计算领域水平的$z$分数。\n- **记忆领域分数**：$z_{\\text{mem}}$ 是两个记忆测试$z$分数的平均值。\n$$ z_{\\text{mem}} = \\frac{z_{\\text{mem,imm}} + z_{\\text{mem,del}}}{2} = \\frac{-2.1 + (-2.94)}{2} = \\frac{-5.04}{2} = -2.52 $$\n- **其他领域分数**：\n  - 执行功能：$z_{\\text{exec}} = -31.4 / 18$\n  - 语言：$z_{\\text{lang}} = -1.6$\n  - 视空间：$z_{\\text{vis}} = -1.5$\n\n现在，我们根据损伤标准（$z \\le -1.5$）对每个领域进行分类。\n- 记忆：$z_{\\text{mem}} = -2.52 \\le -1.5$。受损。\n- 执行功能：$z_{\\text{exec}} \\approx -1.74 \\le -1.5$。受损。\n- 语言：$z_{\\text{lang}} = -1.6 \\le -1.5$。受损。\n- 视空间：$z_{\\text{vis}} = -1.5 \\le -1.5$。受损。\n所有四个认知领域都达到了损伤标准。\n\n最后，我们计算加权总体认知$z$分数，$z_{\\text{global}}$。\n$$ z_{\\text{global}} = w_{\\text{mem}} z_{\\text{mem}} + w_{\\text{exec}} z_{\\text{exec}} + w_{\\text{lang}} z_{\\text{lang}} + w_{\\text{vis}} z_{\\text{vis}} $$\n权重为 $\\mathbf{w} = (0.30, 0.25, 0.25, 0.20)$。\n$$ z_{\\text{global}} = (0.30)(-2.52) + (0.25)\\left(\\frac{-31.4}{18}\\right) + (0.25)(-1.6) + (0.20)(-1.5) $$\n$$ z_{\\text{global}} = -0.756 + (0.25)(-1.7444...) - 0.40 - 0.30 $$\n$$ z_{\\text{global}} = -0.756 - 0.436111... - 0.40 - 0.30 $$\n$$ z_{\\text{global}} = -1.892111... $$\n\n题目要求将结果四舍五入到四位有效数字。\n数字是 $-1.892111...$。前四位有效数字是 $1$、$8$、$9$ 和 $2$。第五位有效位是 $1$，所以我们向下舍入（即在第四位有效数字处截断）。\n$$ z_{\\text{global}} \\approx -1.892 $$",
            "answer": "$$\\boxed{-1.892}$$"
        },
        {
            "introduction": "MCI通常是一种进展性疾病，因此，随时间监测患者的认知功能是一项关键的临床任务。然而，测试分数的任何变化都可能归因于真实的临床进展或仅仅是随机的测量误差。可靠变化指数 (Reliable Change Index, RCI) 是一种统计工具，可帮助我们区分这两种情况。\n\n此练习  演示了如何计算和解释RCI，这是纵向监测患者认知变化的一项至关重要的技能。它使临床医生能够基于心理测量学原理，更自信地判断疾病是否进展或对治疗有无反应。",
            "id": "4496139",
            "problem": "一名患有遗忘型轻度认知障碍的患者在基线和干预后完成了相同的标准化言语列表学习测试。观察到的原始分数从基线到干预后提高了 $4$ 分。该测试的总体标准差为 $\\sigma = 6$ 分，在相同的重测间隔内，其重测信度为 $r = 0.85$。假设经典测试理论成立，测量误差呈正态分布，无系统性练习效应（因此在零假设下，预期变化为 $0$），不同场合的误差独立，且在相关能力范围内误差具有同方差性。\n\n从经典测试理论中联系观察分数、真实分数、测量误差和测试信度的核心关系出发，推导两次测试分数差异的标准误，并计算该患者观察到的改善的可靠变化指数 (RCI)。使用双侧显著性标准 $\\alpha = 0.05$ 来解释该变化是否超过了可靠变化的阈值，但最终数值答案仅报告 RCI 值。\n\n将最终的 RCI 值四舍五入至四位有效数字。将最终的 RCI 表示为一个无量纲的数字，不要包含任何单位。",
            "solution": "该问题是有效的，因为它科学地基于经典测试理论 (CTT)，设定良好，数据充分且一致，并且陈述客观。\n\n解答首先建立 CTT 的基本原则。一次测试的观察分数 ($X$) 由真实分数 ($T$) 和测量误差 ($E$) 组成。\n$$X = T + E$$\n观察分数方差 ($\\sigma_X^2$) 是真实分数方差 ($\\sigma_T^2$) 和测量误差方差 ($\\sigma_E^2$) 的和，假设真实分数与误差不相关。\n$$\\sigma_X^2 = \\sigma_T^2 + \\sigma_E^2$$\n测试信度 ($r$) 定义为真实分数方差与观察分数方差的比率。\n$$r = \\frac{\\sigma_T^2}{\\sigma_X^2}$$\n根据这个定义，真实分数方差可以表示为 $\\sigma_T^2 = r \\sigma_X^2$。将此代入方差分解方程，可以解出误差方差 $\\sigma_E^2$。\n$$\\sigma_X^2 = r \\sigma_X^2 + \\sigma_E^2$$\n$$\\sigma_E^2 = \\sigma_X^2 - r \\sigma_X^2 = \\sigma_X^2(1 - r)$$\n测量标准误 ($SEM$) 是测量误差的标准差 ($\\sigma_E$)，即误差方差的平方根。\n$$SEM = \\sigma_E = \\sqrt{\\sigma_X^2(1 - r)} = \\sigma_X \\sqrt{1 - r}$$\n问题要求计算可靠变化指数 (RCI)，该指数用于评估两次测试分数变化的显著性。设基线和干预后的观察分数分别为 $X_1$ 和 $X_2$。观察到的差异为 $D = X_2 - X_1$。RCI 是代表此差异的标准化分数，通过将观察到的差异除以差异的标准误 ($S_{\\text{diff}}$) 计算得出。\n$$RCI = \\frac{X_2 - X_1}{S_{\\text{diff}}}$$\n为了推导 $S_{\\text{diff}}$，我们考虑差异分数的方差 $\\text{Var}(D)$。差异分数可以用真实分数和误差来表示：\n$$D = X_2 - X_1 = (T_2 + E_2) - (T_1 + E_1) = (T_2 - T_1) + (E_2 - E_1)$$\nRCI 方法旨在评估观察到的变化是否大于仅由测量误差所能预期的变化。这等同于检验真实分数没有变化的零假设，即 $H_0: T_1 = T_2$ 或 $T_2 - T_1 = 0$。在此零假设下，差异分数简化为：\n$$D = E_2 - E_1$$\n此差异的方差为：\n$$\\text{Var}(D) = \\sigma_{\\text{diff}}^2 = \\text{Var}(E_2 - E_1)$$\n根据不同场合的测量误差是独立的假设，协方差项为零：$\\text{Cov}(E_1, E_2) = 0$。因此，差异的方差是各个误差方差之和。\n$$\\sigma_{\\text{diff}}^2 = \\text{Var}(E_1) + \\text{Var}(E_2)$$\n问题陈述了同方差性的假设，意味着误差方差在整个能力范围内是恒定的，并由此引申，在不同测试中也是恒定的。因此，$\\text{Var}(E_1) = \\text{Var}(E_2) = \\sigma_E^2$。\n$$\\sigma_{\\text{diff}}^2 = \\sigma_E^2 + \\sigma_E^2 = 2\\sigma_E^2$$\n差异的标准误 $S_{\\text{diff}}$ 是该方差的平方根。\n$$S_{\\text{diff}} = \\sqrt{2\\sigma_E^2} = \\sigma_E \\sqrt{2}$$\n代入先前推导出的 $\\sigma_E = SEM = \\sigma_X \\sqrt{1 - r}$ 表达式：\n$$S_{\\text{diff}} = (\\sigma_X \\sqrt{1 - r})\\sqrt{2} = \\sigma_X \\sqrt{2(1 - r)}$$\n现在我们可以写出 RCI 的完整公式。\n$$RCI = \\frac{X_2 - X_1}{\\sigma_X \\sqrt{2(1 - r)}}$$\n问题提供了以下数值：\n观察分数提高：$X_2 - X_1 = 4$ 分。\n测试的总体标准差：$\\sigma = \\sigma_X = 6$ 分。\n重测信度：$r = 0.85$。\n\n我们将这些值代入 RCI 公式。\n$$RCI = \\frac{4}{6 \\sqrt{2(1 - 0.85)}}$$\n首先，计算平方根内的项：\n$$2(1 - 0.85) = 2(0.15) = 0.30$$\n现在将此结果代回 RCI 方程：\n$$RCI = \\frac{4}{6 \\sqrt{0.30}} = \\frac{2}{3 \\sqrt{0.30}}$$\n为了获得数值，我们计算 $0.30$ 的平方根并进行除法运算：\n$$\\sqrt{0.30} \\approx 0.5477225575$$\n$$RCI \\approx \\frac{2}{3 \\times 0.5477225575} \\approx \\frac{2}{1.6431676725} \\approx 1.21716106$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$RCI \\approx 1.217$$\n指定的显著性水平 $\\alpha = 0.05$ 对应于双侧检验的临界 z 值为 $\\pm 1.96$。由于计算出的 RCI 值为 $1.217$，其绝对值小于 $1.96$，因此观察到的 $4$ 分变化不被认为是统计上可靠的；这种变化很可能是由随机测量误差引起的。然而，最终答案仅为 RCI 值本身。",
            "answer": "$$\\boxed{1.217}$$"
        },
        {
            "introduction": "现代MCI的诊断越来越依赖于整合来自多个来源的证据，包括认知表现、脑成像和脑脊液生物标志物，以推断其潜在的病因（如阿尔茨海默病）。贝叶斯定理为我们提供了一个正式的框架，可以根据新证据更新我们对诊断的信念。\n\n这项高级计算练习  将指导您从基本原理出发，构建一个多模态诊断模型。您将学习如何定量地结合不同的生物标志物数据，以计算疾病的后验概率，这是精准神经病学和临床研究前沿的一项关键技能。",
            "id": "4496161",
            "problem": "你的任务是形式化并实现一个有原则的贝叶斯分类器，来估计轻度认知障碍患者因阿尔茨海默病所致的后验概率。该构建必须从贝叶斯定理的基本定义和标准的分布假设开始。你必须整合多种模态的数据：神经心理学评分、结构性磁共振成像和脑脊液生物标志物。该问题纯属数学问题；所有必需的参数都已指定，你将根据下面描述的测试套件计算数值输出。\n\n假设存在以下生成模型。设类别标签为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示由阿尔茨海默病引起的轻度认知障碍，而 $Y=0$ 表示非由阿尔茨海默病引起的轻度认知障碍。特征向量为 $X = (S,H,A,T)$，其中 $S$ 是一个神经心理学综合 $z$-分数（无单位），$H$ 是一个源自结构性磁共振成像的海马体体积 $z$-分数（无单位），$A$ 是脑脊液β-淀粉样蛋白42（$\\mathrm{pg/mL}$），$T$ 是脑脊液磷酸化tau 181蛋白（$\\mathrm{pg/mL}$）。先验概率为 $P(Y=1)=\\pi$ 且 $\\pi = 0.4$，以及 $P(Y=0)=1-\\pi$。\n\n以 $Y=y$ 为条件，并假设特征条件独立和高斯似然。对于每个特征 $X_j$（索引 $j \\in \\{S,H,A,T\\}$）和类别 $y \\in \\{0,1\\}$，\n$$\nX_j \\mid (Y=y) \\sim \\mathcal{N}\\!\\left(\\mu_{j,y}, \\sigma_{j,y}^2\\right).\n$$\n使用以下类别条件参数（所有数值均使用上文指定的自然单位）：\n\n- 对于 $Y=1$（阿尔茨海默病）：\n  - $S$: $\\mu_{S,1} = -1.5$, $\\sigma_{S,1} = 0.5$。\n  - $H$: $\\mu_{H,1} = -1.0$, $\\sigma_{H,1} = 0.6$。\n  - $A$: $\\mu_{A,1} = 450.0$, $\\sigma_{A,1} = 80.0$。\n  - $T$: $\\mu_{T,1} = 80.0$, $\\sigma_{T,1} = 15.0$。\n\n- 对于 $Y=0$（非阿尔茨海默病）：\n  - $S$: $\\mu_{S,0} = -0.75$, $\\sigma_{S,0} = 0.5$。\n  - $H$: $\\mu_{H,0} = -0.3$, $\\sigma_{H,0} = 0.6$。\n  - $A$: $\\mu_{A,0} = 800.0$, $\\sigma_{A,0} = 100.0$。\n  - $T$: $\\mu_{T,0} = 45.0$, $\\sigma_{T,0} = 10.0$。\n\n你的任务是，对于测试套件中每个观测到的特征向量 $x=(s,h,a,t)$，使用基本关系式计算后验概率 $P(Y=1 \\mid X=x)$\n$$\nP(Y=1 \\mid X=x) \\;=\\; \\frac{P(Y=1)\\, \\prod_{j \\in \\mathcal{O}(x)} f_{j,1}(x_j)}{\\sum_{y \\in \\{0,1\\}} P(Y=y)\\, \\prod_{j \\in \\mathcal{O}(x)} f_{j,y}(x_j)},\n$$\n其中 $f_{j,y}(\\cdot)$ 表示参数为 $(\\mu_{j,y},\\sigma_{j,y}^2)$ 的单变量高斯密度，$\\mathcal{O}(x)$ 是 $x$ 中已观测到（非缺失）特征的索引集。如果某个特征值缺失，它将由特殊标记 $\\mathrm{NaN}$ 表示，并且必须在独立性和高斯假设下通过精确的边缘化来处理，这等同于在计算两个类别的似然项乘积时省略该特征。为确保极端输入的数值稳定性，请使用对数和 log-sum-exp 变换来计算密度乘积和归一化。\n\n测试套件。对于以下每个案例，计算标量后验概率 $P(Y=1 \\mid X=x)$，并以四舍五入到 $6$ 位小数的十进制数形式报告。\n\n- 案例 A: $x = (s,h,a,t) = (-1.4,-0.9,430.0,85.0)$。\n- 案例 B: $x = (s,h,a,t) = (-1.0,-0.7,650.0,60.0)$。\n- 案例 C: $x = (s,h,a,t) = (-0.5,0.0,900.0,40.0)$。\n- 案例 D: $x = (s,h,a,t) = (-1.3,-1.1,\\mathrm{NaN},70.0)$。\n- 案例 E: $x = (s,h,a,t) = (-0.6,-0.2,420.0,45.0)$。\n- 案例 F: $x = (s,h,a,t) = (-3.0,-2.5,350.0,120.0)$。\n\n最终输出格式。你的程序应生成单行输出，其中包含结果，按A、B、C、D、E、F的顺序，形式为一个用方括号括起来的逗号分隔列表。每个元素必须是四舍五入到 $6$ 位小数的浮点数。例如，包含三个案例的输出将遵循模式 `[0.123456,0.654321,0.500000]`。",
            "solution": "目标是计算在给定一组观测到的生物标志物向量 $X=x$ 的情况下，患者因阿尔茨海默病导致轻度认知障碍的后验概率，记为 $P(Y=1 \\mid X=x)$。该问题提供了一个基于朴素贝叶斯分类器的生成模型，该模型对四个特征使用高斯似然：神经心理学评分 $S$、海马体体积 $H$、脑脊液β-淀粉样蛋白 $A$ 和脑脊液磷酸化tau蛋白 $T$。\n\n此计算的基本原理是贝叶斯定理，其表述如下：\n$$\nP(Y=1 \\mid X=x) = \\frac{P(X=x \\mid Y=1) P(Y=1)}{P(X=x)}\n$$\n项 $P(X=x)$ 是观测到数据的边际概率，它作为一个归一化常数。它通过对所有可能的类别求和来计算：\n$$\nP(X=x) = \\sum_{y \\in \\{0,1\\}} P(X=x \\mid Y=y) P(Y=y)\n$$\n将此代入主方程，得到后验概率的完整表达式：\n$$\nP(Y=1 \\mid X=x) = \\frac{P(X=x \\mid Y=1) P(Y=1)}{P(X=x \\mid Y=1) P(Y=1) + P(X=x \\mid Y=0) P(Y=0)}\n$$\n问题指定了先验概率 $P(Y=1) = \\pi = 0.4$ 和 $P(Y=0) = 1-\\pi = 0.6$。\n\n项 $P(X=x \\mid Y=y)$ 是特征向量 $x=(s,h,a,t)$ 的类别条件似然。朴素贝叶斯模型的一个关键假设是，在给定类别标签 $Y$ 的条件下，特征是条件独立的。这使我们能够将联合似然表示为单个特征似然的乘积：\n$$\nP(X=x \\mid Y=y) = P(S=s \\mid Y=y) \\cdot P(H=h \\mid Y=y) \\cdot P(A=a \\mid Y=y) \\cdot P(T=t \\mid Y=y)\n$$\n设特征索引为 $j \\in \\{S, H, A, T\\}$。对于每个特征 $X_j$，其似然由一个单变量高斯（正态）概率密度函数（PDF）$f_{j,y}(x_j)$ 建模，其类别特定参数为 $(\\mu_{j,y}, \\sigma_{j,y}^2)$：\n$$\nf_{j,y}(x_j) = P(X_j=x_j \\mid Y=y) = \\frac{1}{\\sqrt{2\\pi\\sigma_{j,y}^2}} \\exp\\left(-\\frac{(x_j - \\mu_{j,y})^2}{2\\sigma_{j,y}^2}\\right)\n$$\n问题要求处理由 $\\mathrm{NaN}$ 表示的缺失数据。在条件独立性假设下，处理缺失特征的正确方法是在分子和分母的乘积中都省略其对应的似然项。这等同于将缺失特征边缘化。\n\n直接计算小概率密度的乘积可能导致数值下溢。为确保稳定性，我们在对数域中进行计算。设 $\\ell_y$ 为类别 $y$ 的未归一化后验概率的对数：\n$$\n\\ell_y = \\log \\left( P(Y=y) \\prod_{j \\in \\mathcal{O}(x)} f_{j,y}(x_j) \\right) = \\log(P(Y=y)) + \\sum_{j \\in \\mathcal{O}(x)} \\log(f_{j,y}(x_j))\n$$\n其中 $\\mathcal{O}(x)$ 是 $x$ 中已观测到（非缺失）特征的索引集。高斯分布的对数概率密度函数（log-PDF）为：\n$$\n\\log(f_{j,y}(x_j)) = -\\frac{(x_j - \\mu_{j,y})^2}{2\\sigma_{j,y}^2} - \\log(\\sigma_{j,y}) - \\frac{1}{2}\\log(2\\pi)\n$$\n我们使用给定的参数计算 $\\ell_1$ 和 $\\ell_0$。然后，后验概率 $P(Y=1 \\mid X=x)$ 可以恢复为：\n$$\nP(Y=1 \\mid X=x) = \\frac{\\exp(\\ell_1)}{\\exp(\\ell_1) + \\exp(\\ell_0)}\n$$\n一种更稳健的计算方法是，在对数优势比上使用 logistic sigmoid 函数，以避免指数运算中出现大的中间值。对数优势比为 $\\Lambda = \\ell_1 - \\ell_0$。后验概率则为：\n$$\nP(Y=1 \\mid X=x) = \\frac{1}{1 + \\exp(-(\\ell_1 - \\ell_0))} = \\frac{1}{1+\\exp(-\\Lambda)}\n$$\n这种表述在数值上是稳定的，并直接得出所需的概率。\n\n对于每个测试案例 $x=(s,h,a,t)$，算法步骤如下：\n1.  用对数先验初始化对数未归一化后验：\n    -   $\\ell_1 = \\log(\\pi) = \\log(0.4)$\n    -   $\\ell_0 = \\log(1-\\pi) = \\log(0.6)$\n2.  对于向量 $x$ 中每个具有观测值 $x_j$ 的特征 $X_j$：\n    a. 使用参数 $(\\mu_{j,1}, \\sigma_{j,1}^2)$ 计算阿尔茨海默病类别（$Y=1$）的对数似然 $\\log(f_{j,1}(x_j))$。\n    b. 将此值加到 $\\ell_1$。\n    c. 使用参数 $(\\mu_{j,0}, \\sigma_{j,0}^2)$ 计算非阿尔茨海默病类别（$Y=0$）的对数似然 $\\log(f_{j,0}(x_j))$。\n    d. 将此值加到 $\\ell_0$。\n    e. 如果特征值缺失（$\\mathrm{NaN}$），则对两个类别完全跳过该特征。\n3.  计算对数优势比：$\\Lambda = \\ell_1 - \\ell_0$。\n4.  计算阿尔茨海默病类别的最终后验概率：$P(Y=1 \\mid X=x) = \\frac{1}{1 + \\exp(-\\Lambda)}$。\n5.  按要求将结果四舍五入到 $6$ 位小数。\n\n此过程将应用于提供的六个测试案例中的每一个，从而得出最终的结果列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Computes the posterior probability of Alzheimer's disease for patients with\n    mild cognitive impairment using a Naive Bayes classifier.\n    \"\"\"\n\n    # Define the prior probability for the Alzheimer's class (Y=1).\n    pi = 0.4\n    log_prior_1 = np.log(pi)\n    log_prior_0 = np.log(1 - pi)\n\n    # Define the class-conditional parameters (means and standard deviations).\n    # The structure is {feature: {'mu': [mu_0, mu_1], 'sigma': [sigma_0, sigma_1]}}.\n    params = {\n        'S': {'mu': [-0.75, -1.5], 'sigma': [0.5, 0.5]},\n        'H': {'mu': [-0.3, -1.0], 'sigma': [0.6, 0.6]},\n        'A': {'mu': [800.0, 450.0], 'sigma': [100.0, 80.0]},\n        'T': {'mu': [45.0, 80.0], 'sigma': [10.0, 15.0]}\n    }\n    feature_names = ['S', 'H', 'A', 'T']\n\n    # Define the test cases from the problem statement.\n    # Missing values are represented by np.nan.\n    test_cases_raw = [\n        (-1.4, -0.9, 430.0, 85.0),  # Case A\n        (-1.0, -0.7, 650.0, 60.0),  # Case B\n        (-0.5, 0.0, 900.0, 40.0),   # Case C\n        (-1.3, -1.1, np.nan, 70.0), # Case D\n        (-0.6, -0.2, 420.0, 45.0),  # Case E\n        (-3.0, -2.5, 350.0, 120.0)  # Case F\n    ]\n\n    results = []\n    for case_values in test_cases_raw:\n        # Initialize log unnormalized posteriors with log priors.\n        log_posterior_unnorm_1 = log_prior_1\n        log_posterior_unnorm_0 = log_prior_0\n\n        # Iterate through each observed feature and add its log-likelihood.\n        for i, value in enumerate(case_values):\n            if not np.isnan(value):\n                feature = feature_names[i]\n                \n                # Parameters for class Y=0 (non-Alzheimer's)\n                mu0 = params[feature]['mu'][0]\n                sigma0 = params[feature]['sigma'][0]\n                \n                # Parameters for class Y=1 (Alzheimer's)\n                mu1 = params[feature]['mu'][1]\n                sigma1 = params[feature]['sigma'][1]\n                \n                # Calculate log-likelihoods using scipy's stable function.\n                log_lik_0 = norm.logpdf(value, loc=mu0, scale=sigma0)\n                log_lik_1 = norm.logpdf(value, loc=mu1, scale=sigma1)\n                \n                log_posterior_unnorm_0 += log_lik_0\n                log_posterior_unnorm_1 += log_lik_1\n        \n        # Calculate the log-odds ratio.\n        log_odds_ratio = log_posterior_unnorm_1 - log_posterior_unnorm_0\n        \n        # Convert log-odds to probability using the logistic sigmoid function.\n        # This is a numerically stable way to compute exp(l1) / (exp(l0) + exp(l1)).\n        prob_1 = 1 / (1 + np.exp(-log_odds_ratio))\n        \n        # Format the result to 6 decimal places.\n        results.append(f\"{prob_1:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}