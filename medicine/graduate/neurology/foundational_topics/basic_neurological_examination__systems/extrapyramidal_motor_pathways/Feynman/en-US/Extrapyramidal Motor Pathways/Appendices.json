{
    "hands_on_practices": [
        {
            "introduction": "Understanding the function of complex neural circuits often begins with simplifying them to their core logic. This exercise models the direct pathway of the basal ganglia as a series of excitatory and inhibitory links. By tracing the effects of these connections in sequence, you will practice applying the fundamental principle of disinhibition, a key mechanism by which the basal ganglia facilitate movement. ",
            "id": "4480419",
            "problem": "A canonical basal ganglia–thalamocortical circuit in the mammalian brain includes the following monosynaptic connections along the so-called direct pathway: from dopamine $D_1$ receptor–expressing striatal medium spiny neurons to the internal segment of the globus pallidus and substantia nigra pars reticulata (jointly denoted as $\\mathrm{GPi/SNr}$), from $\\mathrm{GPi/SNr}$ to ventral thalamic relay neurons, and from ventral thalamic relay neurons to neocortical pyramidal neurons. Assume the following well-established physiological facts as your fundamental base: GABA-mediated synapses are inhibitory and decrease the postsynaptic firing rate relative to baseline, whereas glutamate-mediated synapses are excitatory and increase the postsynaptic firing rate relative to baseline. Further assume small-signal linearization around a steady state so that the sign of the net effect of a serial chain of synapses on an output variable is determined by the parity of inhibitory and excitatory steps in the chain. Define the sign convention so that an inhibitory synapse contributes a factor of $-1$ and an excitatory synapse contributes a factor of $+1$.\n\nUsing only these assumptions, consider a small sustained increase in the firing rate of $D_1$ receptor–expressing striatal medium spiny neurons. Compute the net sign of its effect on thalamocortical drive, defined here as the excitatory output from ventral thalamic relay neurons to cortex, by traversing the direct pathway. Treat the direct pathway as consisting of exactly $3$ sequential synapses: $D_1$ striatal medium spiny neuron to $\\mathrm{GPi/SNr}$, $\\mathrm{GPi/SNr}$ to thalamus, and thalamus to cortex. Use the sign convention above and provide your final result as $+1$ for a net excitatory effect and $-1$ for a net inhibitory effect. No rounding is required; the result is dimensionless.",
            "solution": "The problem is first validated for scientific soundness, consistency, and completeness.\n\n**Step 1: Extraction of Givens**\n- **Circuit Pathway (Direct Pathway):** A series of $3$ monosynaptic connections:\n    1. Dopamine $D_1$ receptor–expressing striatal medium spiny neurons ($D_1$-MSNs) to the internal segment of the globus pallidus and substantia nigra pars reticulata ($\\mathrm{GPi/SNr}$).\n    2. $\\mathrm{GPi/SNr}$ to ventral thalamic relay neurons.\n    3. Ventral thalamic relay neurons to neocortical pyramidal neurons.\n- **Physiological Rules:**\n    1. GABA-mediated synapses are inhibitory.\n    2. Glutamate-mediated synapses are excitatory.\n- **Modeling Assumptions:**\n    1. The system can be analyzed using small-signal linearization around a steady state.\n    2. The net sign of a serial chain of synapses is determined by the parity of inhibitory and excitatory steps.\n- **Sign Convention:**\n    1. An inhibitory synapse contributes a multiplicative factor of $-1$.\n    2. An excitatory synapse contributes a multiplicative factor of $+1$.\n- **Input Perturbation:** A small sustained increase in the firing rate of $D_1$-MSNs.\n- **Output of Interest:** The net effect on thalamocortical drive, defined as the excitatory output from ventral thalamic relay neurons to cortex.\n- **Required Output:** A final result of $+1$ for a net excitatory effect or $-1$ for a net inhibitory effect.\n\n**Step 2: Problem Validation**\nThe problem describes the canonical \"direct pathway\" of the basal ganglia, a fundamental circuit in motor control and decision-making. The components and connections listed are correct according to standard neuroscience literature. The physiological rules about GABA (inhibitory) and glutamate (excitatory) are cornerstones of neurophysiology. The modeling assumption of linearization and sign multiplication is a standard and valid simplification used in systems neuroscience to qualitatively analyze network dynamics. The problem is self-contained, as it relies on \"well-established physiological facts\" which, in the context of a specialized STEM field, implies the use of canonical textbook knowledge. The problem is well-posed, objective, and scientifically grounded. It does not violate any of the invalidity criteria. Therefore, the problem is deemed valid.\n\n**Step 3: Solution Derivation**\nThe problem requires computing the net sign of the effect of an increase in $D_1$-MSN activity on the final cortical output. This is achieved by determining the sign of each of the $3$ synapses in the chain and multiplying them together. The sign of each synapse is determined by its principal neurotransmitter. This requires applying standard neuroanatomical knowledge about the specified circuit.\n\nLet $S_1$, $S_2$, and $S_3$ be the signs of the three sequential synapses. The net sign, $S_{\\text{net}}$, is given by the product:\n$$S_{\\text{net}} = S_1 \\times S_2 \\times S_3$$\n\n1.  **Synapse 1: Striatum ($D_1$-MSN) $\\rightarrow$ $\\mathrm{GPi/SNr}$**\n    The projection neurons of the striatum, the medium spiny neurons (MSNs), are GABAergic. The problem states that GABA-mediated synapses are inhibitory. Based on the given sign convention, an inhibitory synapse contributes a factor of $-1$.\n    $$S_1 = -1$$\n\n2.  **Synapse 2: $\\mathrm{GPi/SNr}$ $\\rightarrow$ Thalamus**\n    The projection neurons of the $\\mathrm{GPi/SNr}$, which form the primary output nuclei of the basal ganglia, are also GABAergic. Their projections to the thalamus are therefore inhibitory.\n    $$S_2 = -1$$\n\n3.  **Synapse 3: Thalamus $\\rightarrow$ Cortex**\n    The ventral thalamic relay neurons that project to the neocortex are glutamatergic. The problem states that glutamate-mediated synapses are excitatory. The problem also defines the \"thalamocortical drive\" as this specific excitatory output.\n    $$S_3 = +1$$\n\nNow, we compute the net sign of the effect by multiplying the signs of the individual synapses in the pathway.\n$$S_{\\text{net}} = S_1 \\times S_2 \\times S_3 = (-1) \\times (-1) \\times (+1)$$\n$$S_{\\text{net}} = (+1) \\times (+1) = +1$$\n\nThe resulting sign is $+1$, which signifies a net excitatory effect. This result is consistent with the known function of the direct pathway, which is to facilitate motor output or action selection. An increase in the activity of $D_1$-MSNs leads to inhibition of the tonically active inhibitory $\\mathrm{GPi/SNr}$ neurons. This disinhibits the thalamus (i.e., increases its activity), which in turn excites the cortex. This chain of effects is summarized by the sequence: increase $\\rightarrow$ inhibition $\\rightarrow$ disinhibition (excitation) $\\rightarrow$ excitation. The overall effect is thus excitatory.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Moving from qualitative logic to quantitative prediction is a crucial step in neuroscience. This practice asks you to apply a more biophysically detailed model to a key synapse in the extrapyramidal system: the inhibitory connection from the Globus Pallidus internus (GPi) to the thalamus. Using a standard input-output function, you will calculate how a reduction in GPi activity, mimicking a therapeutic pallidotomy, quantitatively increases thalamic firing probability, thereby providing a direct link between circuit dynamics and clinical outcomes. ",
            "id": "4480378",
            "problem": "In the basal ganglia–thalamocortical loop, the internal segment of the Globus Pallidus (GPi) exerts tonic inhibitory control over thalamic relay neurons via gamma-aminobutyric acid (GABA) synapses. Consider a single thalamic relay neuron receiving two classes of inputs during a fixed, short observation window: a steady excitatory cortical drive and a barrage of inhibitory synaptic events from GPi neurons whose spikes are approximately Poisson-distributed. Use the following foundational modeling assumptions grounded in standard systems neuroscience:\n\n1. Under stationary conditions and for a sufficiently large number of synapses, the mean inhibitory conductance from GPi onto the thalamic neuron scales linearly with the GPi population firing rate. If $r$ is the GPi firing rate (in $\\mathrm{Hz}$), then the effective inhibitory drive is $w r$, where $w$ is a positive constant with units that render $w r$ commensurate with the excitatory drive term below.\n\n2. Let the net input to the thalamic neuron, after subtracting an effective spike threshold, be expressed as $x = b - w r$, where $b$ is the net excitatory drive minus threshold (both absorbed into a single constant), and $w r$ represents the mean inhibitory effect of GPi.\n\n3. In a short fixed observation window where the neuron either spikes once or not at all, with membrane potential fluctuations that are approximately Gaussian due to the central limit effect of many synaptic inputs, the spike probability is a smooth, saturating function of the normalized input $x$. This mapping is well-approximated by a logistic input–output function arising as a canonical link for noisy-threshold models: $p = \\sigma(\\beta x)$, where $\\sigma(y) = \\frac{1}{1 + \\exp(-y)}$, and $\\beta > 0$ summarizes the inverse scale of the effective noise.\n\nYou are given the following empirically plausible parameterization in normalized units:\n- Baseline GPi firing rate $r_{0} = 70\\,\\mathrm{Hz}$.\n- After pallidotomy, the GPi firing rate decreases by $35\\%$ (i.e., to $r_{1} = r_{0} \\times (1 - 0.35)$).\n- Inhibitory efficacy $w = 0.03$ (in units such that $w r$ is commensurate with $b$).\n- Net excitatory drive minus threshold $b = 3.0$ (same units as $w r$).\n- Inverse noise scale $\\beta = 1.0$ (dimensionless).\n\nStarting from the assumptions above and standard properties of Poisson synaptic input aggregating to Gaussian membrane potential fluctuations, derive the expected thalamic spike probability before and after pallidotomy and then compute the expected change in firing probability $\\Delta p = p_{\\text{after}} - p_{\\text{before}}$. Express your final answer as a dimensionless decimal number. Round your final answer to four significant figures.",
            "solution": "The problem statement is first subjected to validation.\n\n### Step 1: Extract Givens\n- Net input to the thalamic neuron: $x = b - w r$\n- Spike probability function: $p = \\sigma(\\beta x)$, where $\\sigma(y) = \\frac{1}{1 + \\exp(-y)}$\n- Baseline GPi firing rate: $r_{0} = 70\\,\\mathrm{Hz}$\n- Post-pallidotomy GPi firing rate: $r_{1} = r_{0} \\times (1 - 0.35)$\n- Inhibitory efficacy constant: $w = 0.03$\n- Net excitatory drive minus threshold constant: $b = 3.0$\n- Inverse noise scale constant: $\\beta = 1.0$\n- The quantity to be computed is the change in firing probability, $\\Delta p = p_{\\text{after}} - p_{\\text{before}}$.\n- The final answer is to be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The basal ganglia-thalamocortical loop, the inhibitory function of the Globus Pallidus interna (GPi), the disinhibition of the thalamus following a reduction in GPi activity (as in a pallidotomy), and Poisson-to-Gaussian approximations for synaptic input are all standard concepts in systems and computational neuroscience. The logistic function is a canonical choice for a neuron's input-output firing probability curve. The problem is well-posed, providing all necessary mathematical models and parameter values to uniquely determine the required quantity. The language is objective and the parameters, being for a normalized model, are plausible. There are no internal contradictions, ambiguities, or violations of scientific principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe objective is to compute the change in the thalamic neuron's spike probability, $\\Delta p = p_{\\text{after}} - p_{\\text{before}}$, resulting from a change in the GPi firing rate due to pallidotomy.\n\nFirst, we calculate the GPi firing rates before and after the procedure.\nThe baseline firing rate is given as $r_{\\text{before}} = r_{0} = 70\\,\\mathrm{Hz}$.\nThe firing rate after pallidotomy, $r_{\\text{after}}$, is a $35\\%$ reduction from baseline:\n$$r_{\\text{after}} = r_{1} = r_{0} \\times (1 - 0.35) = 70 \\times 0.65 = 45.5\\,\\mathrm{Hz}$$\n\nNext, we calculate the net input, $x$, to the thalamic neuron for both conditions using the formula $x = b - w r$. The given parameters are $b = 3.0$, $w = 0.03$, and $\\beta = 1.0$.\n\nBefore pallidotomy:\n$$x_{\\text{before}} = b - w r_{\\text{before}} = 3.0 - (0.03 \\times 70) = 3.0 - 2.1 = 0.9$$\n\nAfter pallidotomy:\n$$x_{\\text{after}} = b - w r_{\\text{after}} = 3.0 - (0.03 \\times 45.5) = 3.0 - 1.365 = 1.635$$\n\nNow, we compute the corresponding spike probabilities using the logistic function $p = \\sigma(\\beta x) = \\frac{1}{1 + \\exp(-\\beta x)}$.\n\nThe probability before pallidotomy, $p_{\\text{before}}$, is:\n$$p_{\\text{before}} = \\sigma(\\beta x_{\\text{before}}) = \\sigma(1.0 \\times 0.9) = \\sigma(0.9) = \\frac{1}{1 + \\exp(-0.9)}$$\n\nThe probability after pallidotomy, $p_{\\text{after}}$, is:\n$$p_{\\text{after}} = \\sigma(\\beta x_{\\text{after}}) = \\sigma(1.0 \\times 1.635) = \\sigma(1.635) = \\frac{1}{1 + \\exp(-1.635)}$$\n\nThe change in probability, $\\Delta p$, is the difference between these two values:\n$$\\Delta p = p_{\\text{after}} - p_{\\text{before}} = \\frac{1}{1 + \\exp(-1.635)} - \\frac{1}{1 + \\exp(-0.9)}$$\n\nTo obtain the final numerical answer, we evaluate these expressions:\n$$p_{\\text{before}} \\approx \\frac{1}{1 + 0.40657} \\approx \\frac{1}{1.40657} \\approx 0.71095$$\n$$p_{\\text{after}} \\approx \\frac{1}{1 + 0.19495} \\approx \\frac{1}{1.19495} \\approx 0.83685$$\n\nFinally, we compute the difference:\n$$\\Delta p \\approx 0.83685 - 0.71095 = 0.12590$$\n\nRounding the result to four significant figures gives $0.1259$. This positive change indicates an increase in thalamic excitability, consistent with the disinhibitory effect of reducing GPi output.",
            "answer": "$$\\boxed{0.1259}$$"
        },
        {
            "introduction": "The extrapyramidal pathways are central to how the brain selects actions. This hands-on practice guides you through the process of building a computational rate model to simulate this function. You will implement the direct pathway and see firsthand how modulatory signals, such as a phasic burst of dopamine, can alter the circuit's gain to bias selection towards a specific action, illustrating a core principle of reinforcement learning in the brain. ",
            "id": "4480365",
            "problem": "Consider a simplified, channelized rate model of the basal ganglia action selection circuit focusing on extrapyramidal motor pathways. The model includes the Direct Pathway from cortex to striatum ($D_1$-type medium spiny neurons) through to the Globus Pallidus internus (GPi) and onward to thalamus. Dopamine from Substantia Nigra pars compacta (SNc) modulates the excitability of the Direct Pathway. The following scientific facts and core definitions serve as the foundational base: (i) dopamine increases excitability of $D_1$ receptor-expressing striatal neurons, (ii) the Direct Pathway inhibits GPi and Substantia Nigra pars reticulata (SNr), thereby reducing inhibitory output to thalamus, (iii) thalamic disinhibition increases thalamo-cortical drive supporting action selection, and (iv) firing-rate based models approximate population activity in Hertz (Hz).\n\nYou will implement a rate-based model with $N$ action channels indexed by $i \\in \\{0, \\dots, N-1\\}$. For each channel $i$, the cortical input is $c_i$ in $\\mathrm{Hz}$. The model defines the following transformations:\n\n- Striatal Direct Pathway rate: $s_i = \\phi\\!\\left(g_i(D)\\,c_i - \\theta_i\\right)$, where $D$ is the phasic dopamine level from Substantia Nigra pars compacta (SNc), $g_i(D)$ is a dopamine-dependent gain, $\\theta_i$ is a threshold in $\\mathrm{Hz}$, and $\\phi(x) = \\max(0, x)$ is the rectified-linear function.\n\n- GPi output rate (inhibitory to thalamus): $y_i = y_0 - w\\,s_i$, where $y_0$ is a baseline GPi rate in $\\mathrm{Hz}$ and $w > 0$ is the striatonigral inhibitory weight.\n\n- Thalamic output rate with saturating linear readout: $t_i = \\mathrm{clip}\\!\\left(\\eta - \\beta\\,y_i,\\; 0,\\; t_{\\max}\\right)$, where $\\eta$ is a baseline thalamic drive in $\\mathrm{Hz}$, $\\beta > 0$ is a scaling constant, $t_{\\max}$ is a saturation cap in $\\mathrm{Hz}$, and $\\mathrm{clip}(x, a, b) = \\min\\!\\left(b, \\max\\!\\left(a, x\\right)\\right)$.\n\nAssume a dopamine-dependent gain $g_i(D) = g_{0,i}\\,\\bigl(1 + \\alpha_i D\\bigr)$, where $g_{0,i} > 0$ is the baseline gain and $\\alpha_i \\ge 0$ is a dopamine sensitivity parameter reflecting $D_1$ receptor-mediated amplification. All rates are in $\\mathrm{Hz}$, and $D$ is dimensionless.\n\nTask requirements:\n\n1. Derive from the above definitions, in the non-saturated, active regime (i.e., when both $g_i(D)\\,c_i - \\theta_i > 0$ and $0 < \\eta - \\beta\\,y_i < t_{\\max}$), the local slope of the thalamic output with respect to cortical input, $\\dfrac{\\partial t_i}{\\partial c_i}$, as a function of $D$ and the model parameters.\n\n2. Implement a program that, for each test case defined below, computes:\n   - The selected action index after a phasic dopamine increase, defined as the index $i$ that maximizes $t_i$ under the dopamine pulse level $D_{\\text{pulse}}$.\n   - The gain ratio $R$ for the selected action, defined as $R = \\left(\\dfrac{\\partial t_i}{\\partial c_i}\\big|_{D=D_{\\text{pulse}}}\\right) \\Big/ \\left(\\dfrac{\\partial t_i}{\\partial c_i}\\big|_{D=0}\\right)$, evaluated at the provided input parameters. If either condition is not in the non-saturated, active regime (i.e., the derivative is $0$ due to striatal inactivity or thalamic saturation or floor), define $R = 0.0$.\n\n3. Units and output formatting:\n   - All firing rates are in $\\mathrm{Hz}$.\n   - Angles do not appear; therefore, no angle unit is required.\n   - Round the gain ratio $R$ to three decimal places.\n   - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is formatted as $[i,R]$ with no spaces, and the aggregate is a single list. For example: $[[i_1,R_1],[i_2,R_2],[i_3,R_3]]$.\n\nTest suite parameter sets:\n\n- Test Case $1$ (happy path, unsaturated):\n  - $N = 2$\n  - $\\mathbf{c} = [20, 18]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.5, 0.5]$\n  - $\\boldsymbol{\\alpha} = [1.0, 1.0]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.2$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 0.3$\n\n- Test Case $2$ (equal cortical input, differential dopamine sensitivity bias):\n  - $N = 2$\n  - $\\mathbf{c} = [15, 15]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.5, 0.5]$\n  - $\\boldsymbol{\\alpha} = [1.2, 0.8]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.0$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 0.5$\n\n- Test Case $3$ (saturation edge due to large input and dopamine):\n  - $N = 2$\n  - $\\mathbf{c} = [80, 80]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.6, 0.6]$\n  - $\\boldsymbol{\\alpha} = [1.0, 1.0]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.5$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 1.0$\n\n- Test Case $4$ (striatum inactive edge due to low input):\n  - $N = 2$\n  - $\\mathbf{c} = [5, 5]\\,\\mathrm{Hz}$\n  - $\\mathbf{g_0} = [0.3, 0.3]$\n  - $\\boldsymbol{\\alpha} = [1.0, 1.0]$\n  - $\\boldsymbol{\\theta} = [5, 5]\\,\\mathrm{Hz}$\n  - $y_0 = 40\\,\\mathrm{Hz}$, $w = 1.0$, $\\beta = 1.0$, $\\eta = 50\\,\\mathrm{Hz}$, $t_{\\max} = 100\\,\\mathrm{Hz}$\n  - $D_{\\text{pulse}} = 1.0$\n\nYour program must implement the above model, compute the selected action index and the gain ratio $R$ for each test case, round $R$ to three decimal places, and print a single line exactly in the format $[[i_1,R_1],[i_2,R_2],[i_3,R_3],[i_4,R_4]]$.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in established principles of computational neuroscience, well-posed with a clear and complete set of definitions and parameters, and objectively formulated. The problem is solvable as stated. We proceed with the solution, which consists of two main parts: the analytical derivation of the required quantity and the implementation of a program to compute the results for the given test cases.\n\n### Part 1: Derivation of the Thalamic Output Slope\n\nThe first task is to derive the local slope of the thalamic output with respect to the cortical input, $\\dfrac{\\partial t_i}{\\partial c_i}$, for a given action channel $i$. This quantity represents the gain of the cortico-thalamic pathway. The derivation is performed under the \"non-saturated, active regime\", where the neuronal-like units are operating in their linear range.\n\nThe model defines the relationship between cortical input $c_i$ and thalamic output $t_i$ through a sequence of transformations:\n1.  Striatal rate: $s_i = \\phi(g_i(D)c_i - \\theta_i)$, where $\\phi(x) = \\max(0, x)$.\n2.  GPi rate: $y_i = y_0 - w s_i$.\n3.  Thalamic rate: $t_i = \\mathrm{clip}(\\eta - \\beta y_i, 0, t_{\\max})$.\n\nWe can find the derivative $\\dfrac{\\partial t_i}{\\partial c_i}$ by applying the chain rule:\n$$\n\\frac{\\partial t_i}{\\partial c_i} = \\frac{\\partial t_i}{\\partial y_i} \\cdot \\frac{\\partial y_i}{\\partial s_i} \\cdot \\frac{\\partial s_i}{\\partial c_i}\n$$\n\nWe evaluate each partial derivative under the specified regime conditions.\n\n**1. Derivative of Striatal Rate ($s_i$) with respect to Cortical Input ($c_i$)**\nThe striatal rate is $s_i = \\phi(g_i(D)c_i - \\theta_i)$. The \"active regime\" condition is defined as $g_i(D)c_i - \\theta_i > 0$. In this domain, the rectified-linear function $\\phi(x)$ simplifies to $\\phi(x) = x$.\nThus, for an active channel, $s_i = g_i(D)c_i - \\theta_i$.\nThe partial derivative with respect to $c_i$ is:\n$$\n\\frac{\\partial s_i}{\\partial c_i} = \\frac{\\partial}{\\partial c_i} (g_i(D)c_i - \\theta_i) = g_i(D)\n$$\nIf the channel is inactive ($g_i(D)c_i - \\theta_i \\le 0$), $s_i=0$ and the derivative is $0$.\n\n**2. Derivative of GPi Rate ($y_i$) with respect to Striatal Rate ($s_i$)**\nThe GPi rate is a linear function of the striatal rate: $y_i = y_0 - w s_i$.\nThe partial derivative is constant:\n$$\n\\frac{\\partial y_i}{\\partial s_i} = \\frac{\\partial}{\\partial s_i} (y_0 - w s_i) = -w\n$$\n\n**3. Derivative of Thalamic Rate ($t_i$) with respect to GPi Rate ($y_i$)**\nThe thalamic rate is $t_i = \\mathrm{clip}(\\eta - \\beta y_i, 0, t_{\\max})$. The \"non-saturated\" condition is $0 < \\eta - \\beta y_i < t_{\\max}$. In this linear region, the clip function is equal to its argument, $t_i = \\eta - \\beta y_i$.\nThe partial derivative with respect to $y_i$ is:\n$$\n\\frac{\\partial t_i}{\\partial y_i} = \\frac{\\partial}{\\partial y_i} (\\eta - \\beta y_i) = -\\beta\n$$\nIf the thalamic activity is at its floor ($0$) or ceiling ($t_{\\max}$), the derivative is $0$.\n\n**4. Assembling the Final Expression**\nBy multiplying the partial derivatives, we obtain the expression for the slope in the non-saturated, active regime:\n$$\n\\frac{\\partial t_i}{\\partial c_i} = \\left(\\frac{\\partial t_i}{\\partial y_i}\\right) \\left(\\frac{\\partial y_i}{\\partial s_i}\\right) \\left(\\frac{\\partial s_i}{\\partial c_i}\\right) = (-\\beta)(-w)(g_i(D)) = \\beta w g_i(D)\n$$\nFinally, substituting the definition of the dopamine-dependent gain, $g_i(D) = g_{0,i}(1 + \\alpha_i D)$, we get:\n$$\n\\frac{\\partial t_i}{\\partial c_i} = \\beta w g_{0,i}(1 + \\alpha_i D)\n$$\nThis is the final expression for the local slope. If the system is outside this regime at a given $D$, this derivative is $0$.\n\n### Part 2: Computational Logic and Gain Ratio\n\nThe second task is to implement the model to determine the selected action and a gain ratio $R$.\n\n**Selected Action:** The selected action is the channel index $i$ that maximizes the thalamic output $t_i$ when the phasic dopamine level is $D = D_{\\text{pulse}}$. This is found by computing $t_i$ for all channels $i \\in \\{0, \\dots, N-1\\}$ and finding the index of the maximum value.\n\n**Gain Ratio $R$:** The ratio $R$ for the selected action channel $i_{\\text{sel}}$ is defined as:\n$$\nR = \\frac{\\left.\\frac{\\partial t_{i_{\\text{sel}}}}{\\partial c_{i_{\\text{sel}}}}\\right|_{D=D_{\\text{pulse}}}}{\\left.\\frac{\\partial t_{i_{\\text{sel}}}}{\\partial c_{i_{\\text{sel}}}}\\right|_{D=0}}\n$$\nA crucial condition is that if the system state for the selected channel is outside the non-saturated, active regime for either $D = D_{\\text{pulse}}$ or $D=0$, then $R$ is defined to be $0.0$.\n\nLet's analyze the ratio $R$ for the case where both conditions (at $D=D_{\\text{pulse}}$ and $D=0$) are in the active, non-saturated regime. Using the derived slope expression:\n- Numerator (at $D=D_{\\text{pulse}}$): $\\beta w g_{0,i_{\\text{sel}}}(1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}})$\n- Denominator (at $D=0$): $\\beta w g_{0,i_{\\text{sel}}}(1 + \\alpha_{i_{\\text{sel}}} \\cdot 0) = \\beta w g_{0,i_{\\text{sel}}}$\n\nThe ratio simplifies to:\n$$\nR = \\frac{\\beta w g_{0,i_{\\text{sel}}}(1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}})}{\\beta w g_{0,i_{\\text{sel}}}} = 1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}}\n$$\nThis elegant result shows that the gain modulation is directly related to the dopamine sensitivity $\\alpha_i$ and the dopamine level $D_{\\text{pulse}}$, provided the system remains in its linear operating range.\n\nThe algorithm is therefore:\n1.  For a given test case, iterate through each channel $i=0, \\dots, N-1$ with $D=D_{\\text{pulse}}$ to compute all $t_i$ values.\n2.  Determine the selected action index $i_{\\text{sel}} = \\arg\\max_i(t_i)$.\n3.  For this selected channel $i_{\\text{sel}}$, check the non-saturated, active regime conditions for both $D=D_{\\text{pulse}}$ and $D=0$.\n    The conditions for a given $D$ and channel $i$:\n    a. Striatal Activity: $g_{0,i}(1 + \\alpha_i D)c_i - \\theta_i > 0$.\n    b. Thalamic Linearity: First compute $s_i$ and $y_i$, then check $0 < \\eta - \\beta y_i < t_{\\max}$.\n4. If both checks pass (for $D=D_{\\text{pulse}}$ and $D=0$), calculate $R = 1 + \\alpha_{i_{\\text{sel}}} D_{\\text{pulse}}$.\n5. Otherwise, set $R=0.0$.\n6. Format the result as $[i_{\\text{sel}}, R]$ with $R$ rounded to three decimal places.\n\nThis procedure is systematically applied to each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the basal ganglia model problem for the given test suite.\n    \"\"\"\n    \n    test_cases = [\n        # Test Case 1 (happy path, unsaturated)\n        {\n            \"N\": 2, \"c\": [20, 18], \"g0\": [0.5, 0.5], \"alpha\": [1.0, 1.0], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.2, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 0.3\n        },\n        # Test Case 2 (equal cortical input, differential dopamine sensitivity bias)\n        {\n            \"N\": 2, \"c\": [15, 15], \"g0\": [0.5, 0.5], \"alpha\": [1.2, 0.8], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.0, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 0.5\n        },\n        # Test Case 3 (saturation edge due to large input and dopamine)\n        {\n            \"N\": 2, \"c\": [80, 80], \"g0\": [0.6, 0.6], \"alpha\": [1.0, 1.0], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.5, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 1.0\n        },\n        # Test Case 4 (striatum inactive edge due to low input)\n        {\n            \"N\": 2, \"c\": [5, 5], \"g0\": [0.3, 0.3], \"alpha\": [1.0, 1.0], \"theta\": [5, 5],\n            \"y0\": 40, \"w\": 1.0, \"beta\": 1.0, \"eta\": 50, \"t_max\": 100, \"D_pulse\": 1.0\n        }\n    ]\n\n    all_results = []\n\n    def check_regime(c_i, g0_i, alpha_i, theta_i, y0, w, beta, eta, t_max, D):\n        \"\"\"\n        Checks if a channel is in the non-saturated, active regime for a given D.\n        Returns True if in the regime, False otherwise.\n        \"\"\"\n        g_i = g0_i * (1.0 + alpha_i * D)\n        striatal_input = g_i * c_i - theta_i\n        \n        # Condition 1: Striatal activity\n        if striatal_input = 0:\n            return False\n        \n        # Calculate intermediate rates\n        s_i = striatal_input\n        y_i = y0 - w * s_i\n        thalamic_input = eta - beta * y_i\n        \n        # Condition 2: Thalamic non-saturation\n        if not (0  thalamic_input  t_max):\n            return False\n            \n        return True\n\n    def calculate_thalamic_rate(c_i, g0_i, alpha_i, theta_i, y0, w, beta, eta, t_max, D):\n        \"\"\"\n        Computes the thalamic output rate for a single channel.\n        \"\"\"\n        g_i = g0_i * (1.0 + alpha_i * D)\n        s_i = max(0, g_i * c_i - theta_i)\n        y_i = y0 - w * s_i\n        t_i = np.clip(eta - beta * y_i, 0, t_max)\n        return t_i\n\n    for case in test_cases:\n        N = case[\"N\"]\n        c, g0, alpha, theta = case[\"c\"], case[\"g0\"], case[\"alpha\"], case[\"theta\"]\n        y0, w, beta, eta, t_max = case[\"y0\"], case[\"w\"], case[\"beta\"], case[\"eta\"], case[\"t_max\"]\n        D_pulse = case[\"D_pulse\"]\n\n        # 1. Determine the selected action index\n        t_values = []\n        for i in range(N):\n            t_i = calculate_thalamic_rate(c[i], g0[i], alpha[i], theta[i],\n                                          y0, w, beta, eta, t_max, D_pulse)\n            t_values.append(t_i)\n        \n        selected_index = int(np.argmax(t_values))\n\n        # 2. Compute the gain ratio R\n        c_sel = c[selected_index]\n        g0_sel = g0[selected_index]\n        alpha_sel = alpha[selected_index]\n        theta_sel = theta[selected_index]\n        \n        # Check regime for D = D_pulse\n        is_active_at_pulse = check_regime(c_sel, g0_sel, alpha_sel, theta_sel,\n                                          y0, w, beta, eta, t_max, D_pulse)\n        \n        # Check regime for D = 0\n        is_active_at_zero = check_regime(c_sel, g0_sel, alpha_sel, theta_sel,\n                                         y0, w, beta, eta, t_max, 0.0)\n\n        # Calculate R based on the regime checks\n        if is_active_at_pulse and is_active_at_zero:\n            R = 1.0 + alpha_sel * D_pulse\n        else:\n            R = 0.0\n\n        # Format and append the result\n        all_results.append(f\"[{selected_index},{R:.3f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}