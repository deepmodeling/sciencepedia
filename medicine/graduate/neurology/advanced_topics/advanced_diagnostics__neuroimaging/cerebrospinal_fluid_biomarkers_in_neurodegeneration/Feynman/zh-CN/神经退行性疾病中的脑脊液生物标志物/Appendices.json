{
    "hands_on_practices": [
        {
            "introduction": "一种新生物标志物的效用不仅在于其存在，更在于其量化的诊断性能。为了将验证性研究中的原始数据转化为对单个患者有意义的临床决策，我们必须运用诊断统计学的工具。本练习  将指导您如何从列联表数据中计算灵敏度、特异性和似然比等基本指标，然后将这些指标应用于一个真实的临床情境，使用贝叶斯定理将先验概率更新为更具确定性的后验概率。",
            "id": "4468097",
            "problem": "考虑一个临床情景：一名轻度认知障碍 (MCI) 患者正在使用脑脊液 (CSF) 生物标志物比率，特别是磷酸化tau蛋白与淀粉样蛋白-42的比值 ($p\\text{-tau}/A\\beta_{42}$)，来评估其潜在的阿尔茨海默病 (AD) 病理生理学。二元诊断决策规则是：若该比率超过一个经过验证的阈值，则结果为“阳性”，否则为“阴性”。在一项以淀粉样蛋白正电子发射断层扫描 (PET) 或尸检为参考标准的基础验证研究中，观察到以下结果：在 $N_{D} = 180$ 名确诊患有AD病理生理学的个体中，$TP = 155$ 人检测结果为阳性，$FN = 25$ 人检测结果为阴性；在 $N_{\\neg D} = 220$ 名未患有AD病理生理学的个体中，$FP = 44$ 人检测结果为阳性，$TN = 176$ 人检测结果为阴性。\n\n从条件概率的基本定义出发，根据适用情况，用 $P(T^{+} \\mid D)$、$P(T^{-} \\mid \\neg D)$、$P(D \\mid T^{+})$、$P(\\neg D \\mid T^{-})$ 和 $P(T^{+} \\mid D)/P(T^{+} \\mid \\neg D)$ 来定义灵敏度 ($\\text{sensitivity}$)、特异度 ($\\text{specificity}$)、阳性预测值 (PPV)、阴性预测值 (NPV) 以及阳性和阴性似然比 ($LR^{+}$ 和 $LR^{-}$) 。然后，使用上述研究计数，计算 $LR^{+}$。\n\n假设患者潜在患有AD病理生理学的检验前概率为 $P_{\\text{pre}} = 0.35$。CSF生物标志物检测返回了阳性结果。使用基于贝叶斯定理的优势-概率转换来计算检验后概率，具体为\n$$\nP_{\\text{post}} \\;=\\; \\frac{LR \\cdot P_{\\text{pre}}}{1 - P_{\\text{pre}} + LR \\cdot P_{\\text{pre}}},\n$$\n其中对于阳性检测，$LR = LR^{+}$。将最终的检验后概率表示为小数，并将答案四舍五入到四位有效数字。概率是无量纲的，因此不需要单位。",
            "solution": "该问题被评估为具有科学依据、良定、客观且自洽。所提供的数据内部一致，该情景是贝叶斯推断在临床诊断中的一个标准应用。有效问题的所有条件均已满足。\n\n设 $D$ 表示个体确诊患有阿尔茨海默病 (AD) 病理生理学的事件，$\\neg D$ 表示其不存在的事件。设 $T^{+}$ 表示脑脊液 (CSF) 生物标志物比率的阳性检测结果， $T^{-}$ 表示阴性检测结果。\n\n诊断性能指标的基本定义，用条件概率表示如下：\n- **灵敏度** ($\\text{sensitivity}$): 在存在疾病的情况下，检测结果为阳性的概率。其形式化定义为 $\\text{sensitivity} = P(T^{+} \\mid D)$。\n- **特异度** ($\\text{specificity}$): 在不存在疾病的情况下，检测结果为阴性的概率。其形式化定义为 $\\text{specificity} = P(T^{-} \\mid \\neg D)$。\n- **阳性预测值** (PPV): 在检测结果为阳性的情况下，存在疾病的概率。其形式化定义为 $PPV = P(D \\mid T^{+})$。\n- **阴性预测值** (NPV): 在检测结果为阴性的情况下，不存在疾病的概率。其形式化定义为 $NPV = P(\\neg D \\mid T^{-})$。\n- **阳性似然比** ($LR^{+}$): 患病组中检测结果为阳性的概率与非患病组中检测结果为阳性的概率之比。其定义为 $LR^{+} = \\frac{P(T^{+} \\mid D)}{P(T^{+} \\mid \\neg D)}$。\n- **阴性似然比** ($LR^{-}$): 患病组中检测结果为阴性的概率与非患病组中检测结果为阴性的概率之比。其定义为 $LR^{-} = \\frac{P(T^{-} \\mid D)}{P(T^{-} \\mid \\neg D)}$。\n\n问题提供了一项验证研究的以下计数：\n- 患有AD病理生理学的个体数量, $N_{D} = 180$。\n- 真阳性, $TP = 155$。\n- 假阴性, $FN = 25$。\n- 未患有AD病理生理学的个体数量, $N_{\\neg D} = 220$。\n- 假阳性, $FP = 44$。\n- 真阴性, $TN = 176$。\n\n根据这些计数，我们首先计算确定阳性似然比 ($LR^{+}$) 所需的概率。\n\n灵敏度是患病组中检测结果为阳性的概率，估计为：\n$$\n\\text{sensitivity} = P(T^{+} \\mid D) = \\frac{TP}{N_{D}} = \\frac{155}{180}\n$$\n特异度是非患病组中检测结果为阴性的概率：\n$$\n\\text{specificity} = P(T^{-} \\mid \\neg D) = \\frac{TN}{N_{\\neg D}} = \\frac{176}{220}\n$$\n假阳性概率 $P(T^{+} \\mid \\neg D)$ 等于 $1 - \\text{specificity}$：\n$$\nP(T^{+} \\mid \\neg D) = 1 - \\text{specificity} = 1 - \\frac{176}{220} = \\frac{220 - 176}{220} = \\frac{44}{220}\n$$\n这也可以直接计算为 $\\frac{FP}{N_{\\neg D}} = \\frac{44}{220}$。\n\n现在，我们计算阳性似然比 $LR^{+}$：\n$$\nLR^{+} = \\frac{P(T^{+} \\mid D)}{P(T^{+} \\mid \\neg D)} = \\frac{\\text{sensitivity}}{1 - \\text{specificity}} = \\frac{155/180}{44/220}\n$$\n在相除之前，我们先化简分数：\n$$\n\\frac{155}{180} = \\frac{31 \\times 5}{36 \\times 5} = \\frac{31}{36}\n$$\n$$\n\\frac{44}{220} = \\frac{44}{5 \\times 44} = \\frac{1}{5}\n$$\n将这些化简后的分数代入 $LR^{+}$ 的表达式中：\n$$\nLR^{+} = \\frac{31/36}{1/5} = \\frac{31}{36} \\times 5 = \\frac{155}{36}\n$$\n患者的检验前概率为 $P_{\\text{pre}} = 0.35$，并收到了阳性检测结果。检验后概率 $P_{\\text{post}}$ 使用提供的公式计算，其中 $LR = LR^{+}$：\n$$\nP_{\\text{post}} = \\frac{LR^{+} \\cdot P_{\\text{pre}}}{1 - P_{\\text{pre}} + LR^{+} \\cdot P_{\\text{pre}}}\n$$\n让我们代入值 $LR^{+} = \\frac{155}{36}$ 和 $P_{\\text{pre}} = 0.35$：\n$$\nP_{\\text{post}} = \\frac{(\\frac{155}{36}) \\cdot (0.35)}{1 - 0.35 + (\\frac{155}{36}) \\cdot (0.35)}\n$$\n贝叶斯定理的优势形式通常在计算上更简单。检验前优势为：\n$$\n\\text{Odds}_{\\text{pre}} = \\frac{P_{\\text{pre}}}{1 - P_{\\text{pre}}} = \\frac{0.35}{1 - 0.35} = \\frac{0.35}{0.65} = \\frac{35}{65} = \\frac{7}{13}\n$$\n检验后优势通过将检验前优势乘以似然比得到：\n$$\n\\text{Odds}_{\\text{post}} = \\text{Odds}_{\\text{pre}} \\times LR^{+} = \\frac{7}{13} \\times \\frac{155}{36} = \\frac{1085}{468}\n$$\n最后，我们将检验后优势转换回概率：\n$$\nP_{\\text{post}} = \\frac{\\text{Odds}_{\\text{post}}}{1 + \\text{Odds}_{\\text{post}}} = \\frac{1085/468}{1 + 1085/468} = \\frac{1085/468}{(468+1085)/468} = \\frac{1085}{1553}\n$$\n为了得到最终的数值答案，我们进行除法运算并四舍五入到四位有效数字：\n$$\nP_{\\text{post}} = \\frac{1085}{1553} \\approx 0.6986477785...\n$$\n四舍五入到四位有效数字得到 $0.6986$。",
            "answer": "$$\\boxed{0.6986}$$"
        },
        {
            "introduction": "任何定量生物标志物都需要一个“截断值”或阈值来将结果分为“阳性”或“阴性”。这个阈值的选择并非随意的，它代表了在正确识别患者（灵敏度）和正确识别非患者（特异性）之间的一种权衡。本练习  深入探讨了诊断阈值的优化问题，通过推导约登指数（Youden's J statistic）来解决。该指数是受试者工作特征（ROC）曲线上离机会线最远垂直距离的度量，理解这一概念对于解读和开发高性能诊断测试至关重要。",
            "id": "4468159",
            "problem": "一家临床实验室通过量化脑脊液 (CSF) 中苏氨酸217位磷酸化tau蛋白 (p-tau217) 的浓度来辅助诊断阿尔茨海默病 (AD)。考虑一个由决策阈值 $\\tau$ 参数化的二元分类规则，其中当测量浓度 $x \\ge \\tau$ 时，测试结果为阳性 $\\hat{Y}=1$；当 $x  \\tau$ 时，测试结果为阴性 $\\hat{Y}=0$。令真实疾病状态为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示患有AD， $Y=0$ 表示未患AD。\n\n从核心定义出发：灵敏度是条件概率 $P(\\hat{Y}=1 \\mid Y=1)$，特异度是条件概率 $P(\\hat{Y}=0 \\mid Y=0)$。仅使用这些定义和条件概率的标准属性，推导一个依赖于阈值的指数，该指数对于每个 $\\tau$ 都能量化受试者工作特征 (ROC) 点与机会线之间的垂直位移。并论证当假阳性和假阴性权重相等且疾病患病率不纳入标准时，为何可将该指数用作阈值优化标准。\n\n对于一个特定的经过分析验证的临界值 $\\tau^{\\ast}$，实验室报告的灵敏度为 $0.89$，特异度为 $0.92$。计算在 $\\tau^{\\ast}$ 处所推导指数的值。请用一个无单位的小数表示最终答案。如果在计算过程中包含任何解释，请确保最终报告的答案中只出现该指数的值。",
            "solution": "该问题要求从第一性原理出发，推导一个依赖于阈值的指数，并根据一组给定的性能指标计算其值。过程如下：首先，对问题陈述进行形式化验证；然后，推导该指数并论证其用途；最后，计算其值。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- 一个二元分类规则由阈值 $\\tau$ 定义。\n- 当测量浓度 $x$ 时，如果 $x \\ge \\tau$，则测试结果为阳性 $\\hat{Y}=1$；如果 $x  \\tau$，则测试结果为阴性 $\\hat{Y}=0$。\n- 真实疾病状态为 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示存在疾病（AD），$Y=0$ 表示不存在疾病（非AD）。\n- 灵敏度定义为条件概率 $P(\\hat{Y}=1 \\mid Y=1)$。\n- 特异度定义为条件概率 $P(\\hat{Y}=0 \\mid Y=0)$。\n- 任务是推导一个指数，用以量化受试者工作特征（ROC）点与机会线之间的垂直位移。\n- 推导过程必须仅使用所提供的定义和条件概率的标准属性。\n- 当假阳性和假阴性权重相等且疾病患病率不作为考虑因素时，该指数必须适用于阈值优化。\n- 对于一个特定阈值 $\\tau^{\\ast}$，给定值为：灵敏度 = 0.89，特异度 = 0.92。\n- 最终任务是计算在 $\\tau^{\\ast}$ 处所推导指数的值。\n\n**1.2. 验证分析**\n- **科学依据：** 该问题坚实地植根于生物统计学和诊断医学的原理。灵敏度、特异度、ROC曲线和决策阈值等概念是评估二元分类器的标准、成熟的工具。使用生物标志物（p-tau217）诊断阿尔茨海默病的背景具有科学时效性和现实性。\n- **适定性：** 这是一个适定问题。它要求推导一个特定的量（ROC图上的垂直距离）并进行计算。该几何描述唯一地定义了该指数。所提供的数据足以完成计算。\n- **客观性：** 问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n- **完整性与一致性：** 问题是自洽的。它提供了所有必要的定义和数据，内部没有矛盾。\n- **现实性：** 灵敏度（0.89）和特异度（0.92）的值对于一个高性能的诊断测试是现实的。整个场景反映了临床测试验证中的标准程序。\n\n**1.3. 结论**\n该问题有效。这是一个科学上合理、适定且客观的生物统计学问题。\n\n### 步骤 2：推导与求解\n\n求解过程首先定义绘制ROC曲线的空间，然后根据其几何定义推导出指数的表达式。\n\nROC曲线是对于变化的决策阈值 $\\tau$，绘制真阳性率（TPR）相对于假阳性率（FPR）的图。\n\n真阳性率是在受试者患有疾病的条件下，测试结果为阳性的概率。根据问题的定义，这就是灵敏度：\n$$\n\\text{TPR}(\\tau) = P(\\hat{Y}=1 \\mid Y=1) = \\text{Sensitivity}(\\tau)\n$$\n\n假阳性率是在受试者未患疾病的条件下，测试结果为阳性的概率：\n$$\n\\text{FPR}(\\tau) = P(\\hat{Y}=1 \\mid Y=0)\n$$\n\n问题给出了特异度的定义，即真阴性率（TNR）：\n$$\n\\text{Specificity}(\\tau) = P(\\hat{Y}=0 \\mid Y=0)\n$$\n\n对于给定的条件状态 $Y=0$，所有可能的 $\\hat{Y}$ 结果的概率之和必须为 $1$。即 $P(\\hat{Y}=1 \\mid Y=0) + P(\\hat{Y}=0 \\mid Y=0) = 1$。\n代入FPR和特异度的定义，我们得到：\n$$\n\\text{FPR}(\\tau) + \\text{Specificity}(\\tau) = 1\n$$\n这使我们能够用特异度来表示FPR：\n$$\n\\text{FPR}(\\tau) = 1 - \\text{Specificity}(\\tau)\n$$\n\n对于任何给定的阈值 $\\tau$，ROC曲线上的一个点由坐标 $(\\text{FPR}(\\tau), \\text{TPR}(\\tau))$ 定义。使用灵敏度和特异度的定义，该点为 $(1 - \\text{Specificity}(\\tau), \\text{Sensitivity}(\\tau))$。\n\nROC空间中的机会线（或无歧视线）是从 $(0,0)$ 到 $(1,1)$ 的线段。这条线对应于一个性能不优于随机猜测的分类器。该线的方程是 $\\text{TPR} = \\text{FPR}$。\n\n问题要求计算ROC点与机会线之间的垂直位移。对于给定的x坐标 $\\text{FPR}(\\tau)$，ROC曲线上的对应点的y坐标为 $\\text{TPR}(\\tau)$。机会线上具有相同x坐标的点的y坐标等于其x坐标，即 $\\text{FPR}(\\tau)$。\n\n这个垂直位移，我们称之为指数 $J(\\tau)$，是这两个y坐标之间的差：\n$$\nJ(\\tau) = \\text{TPR}(\\tau) - \\text{FPR}(\\tau)\n$$\n代入以灵敏度和特异度表示的表达式，我们得到该指数的公式：\n$$\nJ(\\tau) = \\text{Sensitivity}(\\tau) - (1 - \\text{Specificity}(\\tau))\n$$\n$$\nJ(\\tau) = \\text{Sensitivity}(\\tau) + \\text{Specificity}(\\tau) - 1\n$$\n该指数被称为约登指数（Youden's J statistic）。\n\n接下来，我们在指定的约束条件下论证其作为优化标准的合理性。目标是选择一个能优化测试性能的阈值 $\\tau$，其中“最优”意味着假阳性和假阴性的权重相等，并且决策与疾病患病率无关。\n\n我们可以用错误率来表示 $J(\\tau)$。假阴性率（FNR）是 $P(\\hat{Y}=0 \\mid Y=1) = 1 - P(\\hat{Y}=1 \\mid Y=1) = 1 - \\text{TPR}(\\tau)$。假阳性率（FPR）是 $P(\\hat{Y}=1 \\mid Y=0)$。\n该指数为 $J(\\tau) = \\text{TPR}(\\tau) - \\text{FPR}(\\tau) = (1 - \\text{FNR}(\\tau)) - \\text{FPR}(\\tau) = 1 - (\\text{FNR}(\\tau) + \\text{FPR}(\\tau))$。\n\n因此，最大化 $J(\\tau)$ 在数学上等同于最小化两个条件错误率之和，$\\text{FNR}(\\tau) + \\text{FPR}(\\tau)$。这种最小化对应于一个成本函数，其中假阴性的“成本”和假阳性的“成本”被赋予相同的权重，并且不考虑疾病的基础比率（患病率）。因此，在问题陈述中指定的条件下，最大化 $J(\\tau)$ 是一个有效的优化策略。最大化 $J(\\tau)$ 的阈值 $\\tau$，是那个在患病人群和非患病人群之间提供最大区分度的阈值，该区分度通过灵敏度和特异度之和来衡量。\n\n最后，我们为给定的临界值 $\\tau^{\\ast}$ 计算该指数的值，其中灵敏度 = 0.89，特异度 = 0.92。\n使用推导出的公式：\n$$\nJ(\\tau^{\\ast}) = \\text{Sensitivity}(\\tau^{\\ast}) + \\text{Specificity}(\\tau^{\\ast}) - 1\n$$\n$$\nJ(\\tau^{\\ast}) = 0.89 + 0.92 - 1\n$$\n$$\nJ(\\tau^{\\ast}) = 1.81 - 1\n$$\n$$\nJ(\\tau^{\\ast}) = 0.81\n$$\n在指定阈值下，该指数的值为 $0.81$。",
            "answer": "$$\n\\boxed{0.81}\n$$"
        },
        {
            "introduction": "像阿尔茨海默病这样的神经退行性疾病是复杂的，单个生物标志物通常无法提供全貌。现代诊断学越来越依赖于一组标志物来提高准确性。本练习  在单一测试评估原则的基础上，展示了贝叶斯推断在整合来自多个独立测试证据时的强大能力。您将学习如何使用两种不同脑脊液生物标志物的似然比来倍数更新诊断优势比，从而得出一个远比单一标志物更强的后验概率。",
            "id": "4468115",
            "problem": "一家记忆障碍诊所使用脑脊液 (CSF) 生物标志物来评估患者是否患有阿尔茨海默病 (AD)。考虑一名来自转诊队列的患者，其患AD的检验前概率为 $0.3$。获取了两项CSF检测结果：淀粉样蛋白β 42/40比值 ($A\\beta_{42}/A\\beta_{40}$) 和181位苏氨酸磷酸化tau蛋白 ($p\\text{-tau}_{181}$)。在该队列中，A$\\beta_{42}/A\\beta_{40}$ 检测阳性的阳性似然比 ($LR^+$) 为 $7$，p-tau$_{181}$ 检测阳性的$LR^+$为 $5$。假设在给定疾病状态的情况下，这两个检测结果是条件独立的。从贝叶斯定理和诊断检验中的标准定义出发，推导当两个检测结果均为阳性时，患AD的检验后概率，然后计算其数值。将最终答案四舍五入至 $4$ 位有效数字，并以小数形式表示，不加百分号。",
            "solution": "问题是在两次独立的生物标志物检测结果均为阳性的情况下，计算患阿尔茨海默病 (AD) 的检验后概率。解法将从贝叶斯定理推导得出。\n\n首先，我们将给定信息形式化。\n设 $D$ 代表患者患有阿尔茨海默病的事件。\n设 $D^c$ 代表患者未患阿尔茨海默病的事件。\n设 $T_1^+$ 代表淀粉样蛋白β 42/40比值 ($A\\beta_{42}/A\\beta_{40}$) 检测结果为阳性的事件。\n设 $T_2^+$ 代表181位苏氨酸磷酸化tau蛋白 ($p\\text{-tau}_{181}$) 检测结果为阳性的事件。\n\n给定条件如下：\nAD的检验前概率：$P(D) = 0.3$。\n由此，未患AD的检验前概率为 $P(D^c) = 1 - P(D) = 1 - 0.3 = 0.7$。\n第一次检测的阳性似然比为 $LR_1^+ = \\frac{P(T_1^+|D)}{P(T_1^+|D^c)} = 7$。\n第二次检测的阳性似然比为 $LR_2^+ = \\frac{P(T_2^+|D)}{P(T_2^+|D^c)} = 5$。\n在给定疾病状态的情况下，这两个检测是条件独立的。这意味着：\n$P(T_1^+ \\cap T_2^+ | D) = P(T_1^+|D)P(T_2^+|D)$\n$P(T_1^+ \\cap T_2^+ | D^c) = P(T_1^+|D^c)P(T_2^+|D^c)$\n\n我们需要求的是在两次检测均为阳性的情况下患AD的检验后概率，即 $P(D | T_1^+ \\cap T_2^+)$。\n\n用于诊断检验的贝叶斯定理有一种便捷形式，它涉及到几率和似然比。事件 $A$ 的几率定义为 $Odds(A) = \\frac{P(A)}{1 - P(A)}$。贝叶斯定理可以表示为：\n$$Odds_{post} = Odds_{pre} \\times LR$$\n其中 $Odds_{pre}$ 是考虑新证据之前的几率，$Odds_{post}$ 是考虑新证据之后的几率，$LR$ 是该证据的似然比。\n\n首先，我们计算患AD的检验前几率：\n$$Odds_{pre}(D) = \\frac{P(D)}{P(D^c)} = \\frac{0.3}{0.7} = \\frac{3}{7}$$\n\n接下来，我们需要计算两次检测均为阳性这一组合证据的似然比，即 $T_1^+ \\cap T_2^+$。设其为 $LR_{comb}^+$。\n$$LR_{comb}^+ = \\frac{P(T_1^+ \\cap T_2^+ | D)}{P(T_1^+ \\cap T_2^+ | D^c)}$$\n\n利用给定的条件独立性假设，我们可以写出：\n$$LR_{comb}^+ = \\frac{P(T_1^+|D)P(T_2^+|D)}{P(T_1^+|D^c)P(T_2^+|D^c)}$$\n这个表达式可以重排为各个独立似然比的乘积：\n$$LR_{comb}^+ = \\left(\\frac{P(T_1^+|D)}{P(T_1^+|D^c)}\\right) \\times \\left(\\frac{P(T_2^+|D)}{P(T_2^+|D^c)}\\right) = LR_1^+ \\times LR_2^+$$\n因此，对于条件独立的检测，组合似然比是各个独立似然比的乘积。\n\n现在，我们可以计算组合似然比的数值：\n$$LR_{comb}^+ = 7 \\times 5 = 35$$\n\n我们现在可以使用贝叶斯定理的几率形式来求出患AD的检验后几率：\n$$Odds_{post}(D) = Odds_{pre}(D) \\times LR_{comb}^+$$\n$$Odds_{post}(D) = \\frac{3}{7} \\times 35 = 3 \\times 5 = 15$$\n\n最后，我们将检验后几率转换回概率。如果 $P_{post} = P(D | T_1^+ \\cap T_2^+)$，那么检验后几率为：\n$$Odds_{post}(D) = \\frac{P_{post}}{1 - P_{post}}$$\n我们有 $Odds_{post}(D) = 15$，所以我们可以解出 $P_{post}$：\n$$\\frac{P_{post}}{1 - P_{post}} = 15$$\n$$P_{post} = 15(1 - P_{post})$$\n$$P_{post} = 15 - 15P_{post}$$\n$$16P_{post} = 15$$\n$$P_{post} = \\frac{15}{16}$$\n\n为了得到最终的数值答案，我们将此分数转换为小数：\n$$P_{post} = 0.9375$$\n题目要求答案四舍五入至 $4$ 位有效数字。数值 $0.9375$ 已经恰好有 $4$ 位有效数字 ($9$、$3$、$7$、$5$)。因此，无需进一步四舍五入。\n在两次检测结果均为阳性后，患AD的检验后概率为 $0.9375$。",
            "answer": "$$\\boxed{0.9375}$$"
        }
    ]
}