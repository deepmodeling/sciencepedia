{
    "hands_on_practices": [
        {
            "introduction": "在eQTL分析中，一个核心任务是量化遗传变异对基因表达水平的影响强度。本练习将引导你通过一个理想化的场景，推导并计算由单个顺式eQTL（cis-eQTL）解释的表达方差比例（$R^2$）。通过这个实践（），你将掌握如何将等位基因效应（$\\beta$）、等位基因频率（$p$）和总表型方差联系起来，这是理解eQTL效应大小的基石。",
            "id": "4562167",
            "problem": "考虑一项顺式表达数量性状位点 (cis-eQTL) 定位分析，其中单个基因的信使核糖核酸 (mRNA) 表达通过加性基因型效应进行建模。设个体水平的表达量用 $y$ 表示，该值是在移除已知协变量后，经过对数转换和分位数归一化测得的。设基因型剂量用 $g \\in \\{0,1,2\\}$ 表示，代表次要等位基因的计数。假设如下：\n- 线性模型 $y = \\alpha + \\beta g + \\varepsilon$ 成立，其中 $\\varepsilon$ 是一个与 $g$ 独立的随机残差，$\\alpha$ 和 $\\beta$ 是常数。\n- 次要等位基因频率为 $p = 0.25$。\n- 种群处于 Hardy–Weinberg 平衡 (HWE) 状态，因此 $g$ 可被视为一个进行两次试验且成功概率为 $p$ 的二项随机变量。\n- 表达表型的边缘方差（经协变量校正后）为 $\\mathrm{Var}(y) = 0.8$。\n- 对表达量的每等位基因效应的普通最小二乘 (OLS) 估计值为 $\\beta = 0.3$。\n\n从全方差定律和具有独立残差的线性模型的定义出发，推导出一个由基因型解释的表达方差比例（表示为 $R^{2}$）的解析表达式，该表达式应以 $\\beta$、$p$ 和 $\\mathrm{Var}(y)$ 表示。然后，使用所提供的值计算 $R^{2}$ 的数值。将最终的数值答案四舍五入至三位有效数字，并以无单位的小数形式表示。作为推理的一部分，请将计算出的 $R^{2}$ 的量级与 cis-eQTL 效应大小的典型观测范围进行比较，但请确保最终报告的答案仅为所要求的数字。",
            "solution": "首先将根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 基因表达 $y$ 的模型是一个具有加性基因型效应的线性模型：$y = \\alpha + \\beta g + \\varepsilon$。\n- $y$ 是在移除已知协变量后，经过对数转换和分位数归一化的个体水平表达量。\n- $g$ 是次要等位基因计数的基因型剂量，其中 $g \\in \\{0, 1, 2\\}$。\n- $\\varepsilon$ 是一个与 $g$ 独立的随机残差。\n- $\\alpha$ 和 $\\beta$ 是常数。\n- 次要等位基因频率为 $p = 0.25$。\n- 种群处于 Hardy–Weinberg 平衡 (HWE) 状态。\n- $g$ 被视为一个进行两次试验且成功概率为 $p$ 的二项随机变量。\n- 表达表型的边缘方差为 $\\mathrm{Var}(y) = 0.8$。\n- 对表达量的每等位基因效应的普通最小二乘 (OLS) 估计值为 $\\beta = 0.3$。\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据：** 该问题坚实地基于统计遗传学和生物信息学的原理，特别是在表达数量性状位点 (eQTL) 分析的背景下。加性线性模型、Hardy-Weinberg 平衡以及方差解释的概念都是该领域的标准组成部分。给定的次要等位基因频率 ($p=0.25$)、效应大小 ($\\beta=0.3$) 和总表达方差 ($\\mathrm{Var}(y)=0.8$) 的值对于 cis-eQTL 来说是符合实际的。\n- **适定性：** 这是一个适定问题。它提供了所有必要的信息和清晰的定义，以推导出唯一且有意义的解。问题本身没有歧义。\n- **客观性：** 问题以精确、客观的语言陈述，没有主观论断或偏见。\n- **完整性与一致性：** 问题设定是自洽且内部一致的。没有信息缺失或相互矛盾。\n- **可行性：** 所描述的场景不仅在科学上是合理的，而且代表了真实世界遗传数据分析中使用的标准简化模型。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n目标是推导出由基因型解释的表达方差比例 $R^2$ 的表达式，然后计算其数值。\n\n方差解释比例 $R^2$ 定义为由模型预测变量（基因型 $g$）解释的方差与结果变量（表达量 $y$）总方差之比。\n$$\nR^2 = \\frac{\\mathrm{Var}_{\\text{explained}}}{\\mathrm{Var}_{\\text{total}}} = \\frac{\\mathrm{Var}(\\text{E}[y|g])}{\\mathrm{Var}(y)}\n$$\n\n按照规定，我们从全方差定律开始：\n$$\n\\mathrm{Var}(y) = \\mathrm{E}[\\mathrm{Var}(y|g)] + \\mathrm{Var}(\\mathrm{E}[y|g])\n$$\n这将 $y$ 的总方差划分为两个部分：条件方差的期望值（残差方差）和条件期望的方差（解释方差）。\n\n我们使用给定的线性模型 $y = \\alpha + \\beta g + \\varepsilon$ 来确定这些分量。\n首先，我们求给定 $g$ 时 $y$ 的条件期望：\n$$\n\\mathrm{E}[y|g] = \\mathrm{E}[\\alpha + \\beta g + \\varepsilon | g]\n$$\n由于 $\\alpha$ 和 $\\beta$ 是常数，且在条件中 $g$ 是已知的，我们有：\n$$\n\\mathrm{E}[y|g] = \\alpha + \\beta g + \\mathrm{E}[\\varepsilon|g]\n$$\n问题陈述 $\\varepsilon$ 与 $g$ 独立。因此，$\\mathrm{E}[\\varepsilon|g] = \\mathrm{E}[\\varepsilon]$。在 OLS 框架下，假设 $\\mathrm{E}[\\varepsilon]=0$。因此，条件期望为：\n$$\n\\mathrm{E}[y|g] = \\alpha + \\beta g\n$$\n这一项代表了由基因型预测的表达水平部分。\n\n接下来，我们求这个条件期望的方差，也就是由基因型解释的方差：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\mathrm{Var}(\\alpha + \\beta g)\n$$\n由于 $\\alpha$ 是常数，它对​方差没有贡献。根据方差性质 $\\mathrm{Var}(cX) = c^2\\mathrm{Var}(X)$ 可得：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\mathrm{Var}(\\beta g) = \\beta^2 \\mathrm{Var}(g)\n$$\n\n问题陈述种群处于 Hardy-Weinberg 平衡 (HWE) 状态，并且基因型剂量 $g$ 可以被视为一个具有 $n=2$ 次试验（对于二倍体生物）和成功概率 $p$（次要等位基因频率）的二项随机变量。二项随机变量的方差由 $np(1-p)$ 给出。\n因此，基因型剂量的方差是：\n$$\n\\mathrm{Var}(g) = 2p(1-p)\n$$\n将此代入解释方差的表达式中可得：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\beta^2 [2p(1-p)] = 2p(1-p)\\beta^2\n$$\n\n现在我们回到 $R^2$ 的定义。我们已经有了已解释方差的表达式，并且总方差 $\\mathrm{Var}(y)$ 是已知的。\n由基因型解释的方差比例的解析表达式为：\n$$\nR^2 = \\frac{\\mathrm{Var}(\\mathrm{E}[y|g])}{\\mathrm{Var}(y)} = \\frac{2p(1-p)\\beta^2}{\\mathrm{Var}(y)}\n$$\n这就是所要求的以 $\\beta$、$p$ 和 $\\mathrm{Var}(y)$ 表示的通用公式。\n\n现在，我们将提供的数值代入此表达式：\n- $\\beta = 0.3$\n- $p = 0.25$\n- $\\mathrm{Var}(y) = 0.8$\n\n首先，计算基因型的方差 $\\mathrm{Var}(g)$：\n$$\n\\mathrm{Var}(g) = 2p(1-p) = 2(0.25)(1-0.25) = 2(0.25)(0.75) = 0.5(0.75) = 0.375\n$$\n接下来，计算由基因型解释的方差：\n$$\n\\mathrm{Var}(\\mathrm{E}[y|g]) = \\beta^2 \\mathrm{Var}(g) = (0.3)^2 \\times 0.375 = 0.09 \\times 0.375 = 0.03375\n$$\n最后，计算 $R^2$：\n$$\nR^2 = \\frac{0.03375}{\\mathrm{Var}(y)} = \\frac{0.03375}{0.8} = 0.0421875\n$$\n题目要求将答案四舍五入到三位有效数字。第一位有效数字是 $4$，第二位是 $2$，第三位是 $1$。后面的数字是 $8$，大于或等于 $5$，所以我们将第三位有效数字向上取整。\n$$\nR^2 \\approx 0.0422\n$$\n\n这个值代表单个遗传变异解释了基因表达方差的 $4.22\\%$，对于一个强 cis-eQTL 来说，这是一个合理且常见的效应大小。在诸如基因型-组织表达 (GTEx) 项目等大规模研究中，对于给定基因（即“eGene”）最显著的 cis-eQTL 通常能解释 $1\\%$ 到 $20\\%$ 的表达方差，少数特例甚至超过 $50\\%$。因此，大约 $4\\%$ 的 $R^2$ 值在此生物学背景下是一个可观且符合实际的效应大小。",
            "answer": "$$\n\\boxed{0.0422}\n$$"
        },
        {
            "introduction": "现代遗传学研究广泛依赖基因型填充技术来推断缺失的变异。然而，使用填充的基因型剂量（dosages）而非真实的基因型会给统计推断带来何种影响？本练习（）将深入探讨基因型填充不确定性对eQTL关联检验的影响，让你从第一性原理出发，理解为何使用剂量数据会导致统计功效下降，但效应量估计本身却是无偏的。",
            "id": "4562182",
            "problem": "一位研究人员在 $n$ 个个体的队列中进行表达数量性状基因座 (eQTL) 定位。对于一个在哈迪-温伯格平衡 (Hardy–Weinberg Equilibrium, HWE) 下，次要等位基因频率为 $p$ 的单一位点，其真实的基因型计数 $G_i \\in \\{0,1,2\\}$ 无法直接观测到。取而代之的是，基因型填充提供了一个剂量 $D_i = \\mathbb{E}[G_i \\mid \\mathcal{I}_i]$，其中 $\\mathcal{I}_i$ 表示个体 $i$ 的填充信息，以及每个个体的后验方差 $v_i = \\operatorname{Var}(G_i \\mid \\mathcal{I}_i)$。基因表达通过一个线性回归模型 $Y_i = \\alpha + \\beta G_i + \\varepsilon_i$ 进行建模，其中误差项 $\\varepsilon_i$ 是独立同分布的，满足 $\\mathbb{E}[\\varepsilon_i] = 0$ 和 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2$。然而，分析师使用普通最小二乘法 (Ordinary Least Squares, OLS) 拟合模型 $Y_i = \\alpha + \\beta D_i + \\varepsilon_i$。\n\n仅使用第一性原理，如全方差公式、全协方差公式和 OLS 估计量的性质，分析填充不确定性如何通过剂量方差进入关联检验，以及其对 $Z$ 统计量或 Wald 统计量的影响。假设在 HWE 下 $\\operatorname{Var}(G) = 2p(1-p)$，并根据群体水平的量和填充后验方差为此变异位点定义填充质量度量 $R^2$。根据你的推导，选择所有正确的陈述：\n\nA. 在 $Y$ 对 $D$ 的 OLS 回归中，$\\beta$ 的斜率估计量是无偏的。相对于使用真实基因型，检验 $H_0:\\beta=0$ 的期望 Wald 或 $Z$ 统计量会衰减一个因子 $\\sqrt{R^2}$，其中 $R^2 = 1 - \\mathbb{E}[v_i]/(2p(1-p))$。\n\nB. 将剂量不确定性建模为 $D_i = G_i + \\epsilon_i$ 且 $\\operatorname{Var}(\\epsilon_i) = v_i$ 意味着 $\\operatorname{Var}(D) = \\operatorname{Var}(G) + \\mathbb{E}[v_i]$，因此填充不确定性会增加预测变量的方差，从而提高功效。\n\nC. 填充质量度量 $R^2$ 等于 $\\operatorname{Corr}(D,G)$（未平方），且关联 $Z$ 统计量会减少一个因子 $R^2$。\n\nD. 通过 $R^2$ 阈值筛选变异位点必然会使效应估计向零偏倚，因为保留的变异位点具有 $\\operatorname{Var}(D)  \\operatorname{Var}(G)$。\n\nE. 根据全方差公式，$\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$，这意味着 $R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$；因此，使用剂量的检验具有有效样本量 $n_{\\text{eff}} = R^2 n$。\n\nF. 因为 $R^2$ 量化了被剂量捕获的基因型方差的比例，一个有原则的做法是筛选掉 $R^2$ 值低的变异位点（例如，在大样本中低于 $0.3$ 或对于稀有变异低于 $0.8$），因为它们贡献的有效样本量约为 $n_{\\text{eff}} \\approx R^2 n$，功效有限，且不会提高推断质量。",
            "solution": "在尝试解答之前，首先验证问题陈述，以确保其科学上合理、定义明确且客观。\n\n### 步骤 1：提取已知信息\n-   **队列大小**：$n$ 个个体。\n-   **变异位点**：一个次要等位基因频率为 $p$ 的单一位点。\n-   **遗传模型**：假设满足哈迪-温伯格平衡 (HWE)。\n-   **真实基因型**：$G_i \\in \\{0, 1, 2\\}$，是未观测到的个体 $i$ 的次要等位基因计数。根据 HWE，$\\mathbb{E}[G] = 2p$ 且 $\\operatorname{Var}(G) = 2p(1-p)$。\n-   **填充剂量**：$D_i = \\mathbb{E}[G_i \\mid \\mathcal{I}_i]$，其中 $\\mathcal{I}_i$ 是个体特异的填充信息。\n-   **后验方差**：$v_i = \\operatorname{Var}(G_i \\mid \\mathcal{I}_i)$，即个体 $i$ 填充基因型的不确定性。\n-   **真实表型模型**：$Y_i = \\alpha + \\beta G_i + \\varepsilon_i$。\n-   **误差项**：误差 $\\varepsilon_i$ 是独立同分布 (i.i.d.) 的，满足 $\\mathbb{E}[\\varepsilon_i] = 0$ 和 $\\operatorname{Var}(\\varepsilon_i) = \\sigma^2$。误差 $\\varepsilon_i$ 独立于遗传信息 $G_i$ 和 $\\mathcal{I}_i$。\n-   **拟合模型**：分析师使用普通最小二乘法 (OLS) 拟合模型 $Y_i = \\alpha + \\beta D_i + \\varepsilon_i$。\n-   **目标**：分析从拟合模型得到的 $\\beta$ 的 OLS 估计量和相关 Wald ($Z$) 统计量的性质，并定义一个填充质量度量 $R^2$。\n\n### 步骤 2：使用提取的已知信息进行验证\n-   **科学依据**：该问题描述了统计遗传学和 eQTL 定位中的一个标准场景。基因型填充、剂量（$D_i$）的使用、后验方差（$v_i$）以及线性回归都是现代遗传关联研究的基本组成部分。统计公式，包括将 $D_i$ 和 $v_i$ 定义为条件期望和方差，都是正确的。应用全方差和全协方差公式等第一性原理是恰当的。该问题在科学和数学上是合理的。\n-   **定义明确**：问题陈述清晰，给出了所有必要的定义和假设，以推导使用填充剂量替代真实基因型的后果。问题具体，并导向一个唯一的分析解。\n-   **客观性**：语言技术性强、精确，没有主观或模糊的术语。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。可以进行完整的推导和选项评估。\n\n### 核心关系的推导\n\n我们将使用群体水平的量，这些量对应于其样本估计量的大样本行为。分析依赖于全期望、全方差和全协方差公式。\n\n1.  **$\\operatorname{Var}(G)$、$\\operatorname{Var}(D)$ 和 $\\mathbb{E}[v_i]$ 之间的关系**：\n    全方差公式指出，对于随机变量 $X$ 和 $Z$，$\\operatorname{Var}(X) = \\operatorname{Var}(\\mathbb{E}[X \\mid Z]) + \\mathbb{E}[\\operatorname{Var}(X \\mid Z)]$。\n    令 $X=G$ 且 $Z=\\mathcal{I}$。问题中的量是基于对每个个体 $i$ 的 $\\mathcal{I}_i$ 进行条件化定义的。我们可以将这些视为对个体及其填充信息 $\\mathcal{I}$ 的分布所做的群体水平期望。\n    -   根据定义，$\\mathbb{E}[G \\mid \\mathcal{I}] = D$。因此，$\\operatorname{Var}(\\mathbb{E}[G \\mid \\mathcal{I}]) = \\operatorname{Var}(D)$。\n    -   根据定义，$\\operatorname{Var}(G \\mid \\mathcal{I}) = v$。因此，$\\mathbb{E}[\\operatorname{Var}(G \\mid \\mathcal{I})] = \\mathbb{E}[v_i]$（对所有个体取期望）。\n    -   将这些代入全方差公式，得到基本方程：\n        $$ \\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i] $$\n    这表明填充剂量的方差总是小于或等于真实基因型的方差：$\\operatorname{Var}(D) = \\operatorname{Var}(G) - \\mathbb{E}[v_i] \\le \\operatorname{Var}(G)$。\n\n2.  **$\\beta$ 的 OLS 估计量**：\n    分析师对 $Y$ 和 $D$ 进行回归。此回归的群体 OLS 斜率为 $\\beta_D = \\frac{\\operatorname{Cov}(Y, D)}{\\operatorname{Var}(D)}$。这是 OLS 估计量 $\\hat{\\beta}_D$ 在大样本中收敛到的值。\n    -   让我们分析协方差项：$\\operatorname{Cov}(Y, D) = \\operatorname{Cov}(\\alpha + \\beta G + \\varepsilon, D) = \\beta \\operatorname{Cov}(G, D) + \\operatorname{Cov}(\\varepsilon, D)$。\n    -   非遗传残差 $\\varepsilon$ 独立于遗传填充过程，因此 $\\operatorname{Cov}(\\varepsilon, D) = 0$。\n    -   现在，我们使用全协方差公式分析 $\\operatorname{Cov}(G, D)$：$\\operatorname{Cov}(X,Y) = \\mathbb{E}[\\operatorname{Cov}(X,Y|Z)] + \\operatorname{Cov}(\\mathbb{E}[X|Z], \\mathbb{E}[Y|Z])$。\n    -   令 $X=G, Y=D, Z=\\mathcal{I}$。\n    -   $\\mathbb{E}[G \\mid \\mathcal{I}]=D$。由于 $D$ 是 $\\mathcal{I}$ 的函数，当以 $\\mathcal{I}$ 为条件时，它是一个“常数”，所以 $\\mathbb{E}[D \\mid \\mathcal{I}] = D$ 且 $\\operatorname{Cov}(G, D \\mid \\mathcal{I}) = 0$。\n    -   因此，$\\operatorname{Cov}(G, D) = \\operatorname{Cov}(\\mathbb{E}[G \\mid \\mathcal{I}], \\mathbb{E}[D \\mid \\mathcal{I}]) = \\operatorname{Cov}(D, D) = \\operatorname{Var}(D)$。\n    -   将此代回 $\\beta_D$ 的表达式中：\n        $$ \\beta_D = \\frac{\\beta \\operatorname{Cov}(G, D)}{\\operatorname{Var}(D)} = \\frac{\\beta \\operatorname{Var}(D)}{\\operatorname{Var}(D)} = \\beta $$\n    这证明了当对填充剂量（定义为条件期望）进行回归时，斜率的 OLS 估计量对于真实效应大小 $\\beta$ 是**无偏的**。这类模型，其中 $D_i = \\mathbb{E}[G_i | \\mathcal{I}_i]$，被称为 Berkson 误差模型。\n\n3.  **填充质量 $R^2$**：\n    填充质量的标准度量，记为 $R^2$，是真实基因型 $G$ 和填充剂量 $D$ 之间相关系数的平方。\n    $$ R^2 = (\\operatorname{Corr}(G, D))^2 = \\frac{(\\operatorname{Cov}(G, D))^2}{\\operatorname{Var}(G) \\operatorname{Var}(D)} $$\n    -   使用我们之前的结论 $\\operatorname{Cov}(G, D) = \\operatorname{Var}(D)$：\n        $$ R^2 = \\frac{(\\operatorname{Var}(D))^2}{\\operatorname{Var}(G) \\operatorname{Var}(D)} = \\frac{\\operatorname{Var}(D)}{\\operatorname{Var}(G)} $$\n    -   这证实了 $R^2$ 是被填充剂量捕获的真实基因型方差的比例。\n    -   使用 $\\operatorname{Var}(D) = \\operatorname{Var}(G) - \\mathbb{E}[v_i]$ 和问题给出的 $\\operatorname{Var}(G) = 2p(1-p)$：\n        $$ R^2 = \\frac{\\operatorname{Var}(G) - \\mathbb{E}[v_i]}{\\operatorname{Var}(G)} = 1 - \\frac{\\mathbb{E}[v_i]}{\\operatorname{Var}(G)} = 1 - \\frac{\\mathbb{E}[v_i]}{2p(1-p)} $$\n\n4.  **Wald ($Z$) 统计量和功效**：\n    检验 $H_0: \\beta=0$ 的 Wald 统计量是 $Z = \\hat{\\beta} / \\operatorname{SE}(\\hat{\\beta})$。功效由检验的非中心参数决定，对于大样本 $n$，该参数为 $\\lambda = \\mathbb{E}[\\hat{\\beta}] / \\operatorname{SE}(\\hat{\\beta})$。\n    -   **使用真实基因型 ($G$)**：估计量 $\\hat{\\beta}_G$ 对 $\\beta$ 是无偏的。标准误为 $\\operatorname{SE}(\\hat{\\beta}_G) \\approx \\sqrt{\\frac{\\sigma^2}{n \\operatorname{Var}(G)}}$。非中心参数的平方为：\n        $$ \\lambda_G^2 = \\frac{\\beta^2}{\\operatorname{Var}(\\hat{\\beta}_G)} \\approx \\frac{n \\beta^2 \\operatorname{Var}(G)}{\\sigma^2} $$\n    -   **使用填充剂量 ($D$)**：估计量 $\\hat{\\beta}_D$ 对 $\\beta$ 也是无偏的。用于检验 $H_0$ 的标准误是在原假设 $\\beta=0$ 下估计的。在拟合模型 $Y_i = \\alpha + \\beta D_i + u_i$ 中，原假设下的误差方差就是 $\\operatorname{Var}(\\varepsilon_i)=\\sigma^2$。预测变量的方差是 $\\operatorname{Var}(D)$。所以，标准误为 $\\operatorname{SE}(\\hat{\\beta}_D) \\approx \\sqrt{\\frac{\\sigma^2}{n \\operatorname{Var}(D)}}$。非中心参数的平方为：\n        $$ \\lambda_D^2 = \\frac{\\beta^2}{\\operatorname{Var}(\\hat{\\beta}_D)} \\approx \\frac{n \\beta^2 \\operatorname{Var}(D)}{\\sigma^2} $$\n    -   **比较**：让我们计算非中心参数的比率。\n        $$ \\frac{\\lambda_D}{\\lambda_G} = \\sqrt{\\frac{n \\beta^2 \\operatorname{Var}(D) / \\sigma^2}{n \\beta^2 \\operatorname{Var}(G) / \\sigma^2}} = \\sqrt{\\frac{\\operatorname{Var}(D)}{\\operatorname{Var}(G)}} = \\sqrt{R^2} $$\n    在备择假设下，$Z$ 统计量的期望值（即其非中心性）被一个因子 $\\sqrt{R^2}$ 衰减。在原假设下，检验统计量的方差仍然是 $1$，但在备择假设下，其均值偏移得更少，导致功效损失。\n    -   **有效样本量 ($n_{\\text{eff}}$)**：我们可以通过重写 $\\lambda_D^2$ 来看功效是如何损失的：\n        $$ \\lambda_D^2 = \\frac{n \\beta^2 (R^2 \\operatorname{Var}(G))}{\\sigma^2} = \\frac{(n R^2) \\beta^2 \\operatorname{Var}(G)}{\\sigma^2} $$\n    这表明，一个使用剂量的样本量为 $n$ 的研究，其功效（非中心参数）与一个使用真实基因型的样本量为 $n_{\\text{eff}} = n R^2$ 的研究相同。\n\n### 逐项分析\n\n**A. 在 $Y$ 对 $D$ 的 OLS 回归中，$\\beta$ 的斜率估计量是无偏的。相对于使用真实基因型，检验 $H_0:\\beta=0$ 的期望 Wald 或 $Z$ 统计量会衰减一个因子 $\\sqrt{R^2}$，其中 $R^2 = 1 - \\mathbb{E}[v_i]/(2p(1-p))$。**\n-   **无偏估计量**：如第 2 节推导，OLS 估计量 $\\hat{\\beta}_D$ 对 $\\beta$ 是渐近无偏的。**正确**。\n-   **Z-统计量衰减**：如第 4 节推导，$Z$ 统计量的非中心参数被 $\\sqrt{R^2}$ 衰减。这对应于期望统计量的衰减。**正确**。\n-   **$R^2$ 公式**：如第 3 节推导，$R^2 = 1 - \\mathbb{E}[v_i]/\\operatorname{Var}(G) = 1 - \\mathbb{E}[v_i]/(2p(1-p))$。**正确**。\n该陈述的所有部分都与我们的推导一致。\n**结论：正确**\n\n**B. 将剂量不确定性建模为 $D_i = G_i + \\epsilon_i$ 且 $\\operatorname{Var}(\\epsilon_i) = v_i$ 意味着 $\\operatorname{Var}(D) = \\operatorname{Var}(G) + \\mathbb{E}[v_i]$，因此填充不确定性会增加预测变量的方差，从而提高功效。**\n-   关系式 $\\operatorname{Var}(D) = \\operatorname{Var}(G) + \\mathbb{E}[v_i]$ 是不正确的。我们从全方差公式的推导表明 $\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$，这意味着 $\\operatorname{Var}(D) = \\operatorname{Var}(G) - \\mathbb{E}[v_i]$。填充不确定性*减少*了预测变量的方差。\n-   因为预测变量的方差减少了，功效会*降低*，而不是提高。该陈述的前提和结论都有缺陷。\n**结论：不正确**\n\n**C. 填充质量度量 $R^2$ 等于 $\\operatorname{Corr}(D,G)$（未平方），且关联 $Z$ 统计量会减少一个因子 $R^2$。**\n-   度量 $R^2$ 是*平方*相关系数。从第 3 节我们证明了 $\\operatorname{Corr}(D,G) = \\sqrt{\\frac{\\operatorname{Var}(D)}{\\operatorname{Var}(G)}} = \\sqrt{R^2}$。所以 $R^2 = \\operatorname{Corr}(D,G)$ 的说法是错误的，除非 $R^2=1$ 或 $R^2=0$。\n-   关联 $Z$ 统计量被一个因子 $\\sqrt{R^2}$ 衰减，而不是 $R^2$。卡方统计量 $Z^2$ 被一个因子 $R^2$ 衰减。两个论点都是错误的。\n**结论：不正确**\n\n**D. 通过 $R^2$ 阈值筛选变异位点必然会使效应估计向零偏倚，因为保留的变异位点具有 $\\operatorname{Var}(D)  \\operatorname{Var}(G)$。**\n-   如第 2 节所示，$\\beta$ 的 OLS 估计量是无偏的，无论 $R^2$ 的值如何（只要 $R^20$）。根据 $R^2$ 进行筛选不会对效应估计本身引入偏倚。这与根据统计显著性（p值）进行筛选不同，后者可能导致赢家诅咒偏倚。\n-   虽然前提“保留的变异位点具有 $\\operatorname{Var}(D)  \\operatorname{Var}(G)$”对于任何非完美填充的变异位点都是正确的，但它是功效损失的原因，而不是 $\\hat{\\beta}$ 中偏倚的原因。结论是不正确的。\n**结论：不正确**\n\n**E. 根据全方差公式，$\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$，这意味着 $R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$；因此，使用剂量的检验具有有效样本量 $n_{\\text{eff}} = R^2 n$。**\n-   方差分解 $\\operatorname{Var}(G) = \\operatorname{Var}(D) + \\mathbb{E}[v_i]$ 是全方差公式的直接应用，如第 1 节所示。**正确**。\n-   推论 $R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$ 是填充 $R^2$ 的标准定义，并且由相关性的定义和我们推导出的性质 $\\operatorname{Cov}(G,D)=\\operatorname{Var}(D)$ 得出，如第 3 节所示。**正确**。\n-   有效样本量 $n_{\\text{eff}} = R^2 n$ 是填充对检验统计量非中心参数影响的直接结果，如第 4 节所示。**正确**。\n该陈述的所有部分都是正确的，并且逻辑上是连贯的。\n**结论：正确**\n\n**F. 因为 $R^2$ 量化了被剂量捕获的基因型方差的比例，一个有原则的做法是筛选掉 $R^2$ 值低的变异位点（例如，在大样本中低于 $0.3$ 或对于稀有变异低于 $0.8$），因为它们贡献的有效样本量约为 $n_{\\text{eff}} \\approx R^2 n$，功效有限，且不会提高推断质量。**\n-   该陈述正确地将 $R^2$ 识别为被捕获的方差比例 ($R^2 = \\operatorname{Var}(D)/\\operatorname{Var}(G)$)。\n-   它正确地指出有效样本量约为 $R^2 n$。\n-   基于这一数学事实，它得出结论，即 $R^2$ 值非常低的变异位点功效极其有限。例如，一个 $R^2=0.1$ 的变异位点，其有效样本量仅为一个完美基因分型位点的 $10\\%$。\n-   因此，筛选掉这类变异位点是一个合乎逻辑的、“有原则的”策略，以避免在它们施加的多重检验负担上浪费统计功效，而它们提供的信息又很少。给出的阈值是这一原则的例证。该陈述正确地将数学推导与合理的科学实践联系起来。\n**结论：正确**",
            "answer": "$$\\boxed{AEF}$$"
        },
        {
            "introduction": "基因表达数据，特别是来自RNA测序（RNA-seq）的数据，其统计特性远比正态分布复杂。本练习挑战你超越简单的线性模型，去思考如何处理在低表达基因中常见的零膨胀（zero inflation）问题。通过分析简单方法的缺陷并思考更优模型（如双栏模型或审查回归），你将学会如何处理这类复杂的表型数据（），这是进行稳健eQTL分析的一项高级且关键的技能。",
            "id": "4562156",
            "problem": "一位研究者对 $n$ 个个体中一个低表达基因的批量核糖核酸测序（RNA-seq）数据进行表达数量性状位点（eQTL）作图。设 $G_i \\in \\{0,1,2\\}$ 为个体 $i$ 的单个双等位基因变异的基因型剂量，设 $L_i  0$ 表示个体 $i$ 的文库大小（测序深度），设 $Y_i \\in \\{0,1,2,\\dots\\}$ 为该基因的观测读取计数。假设 $Y_i$ 的数据生成过程遵循两个经过充分检验的基本事实：（i）转录本计数是通过对分子进行采样产生的，在均匀采样下，其近似服从泊松分布，其均值与真实丰度和文库大小成正比；（ii）相对于泊松采样的生物学过离散性可以通过负二项分布来捕捉。进一步假设，由于生物学上的缺失和技术灵敏度限制的混合，许多观测值为零，导致零膨胀。\n\n通过一个双组分混合模型对此进行建模：以概率 $\\pi_i \\in (0,1)$，$Y_i = 0$；否则，$Y_i \\sim \\mathrm{NB}(\\mu_i,\\kappa)$，其中 $\\mathrm{NB}(\\mu,\\kappa)$ 表示均值为 $\\mu$、离散参数为 $\\kappa0$ 的负二项分布。设真实丰度通过一个带偏移量的对数连接函数依赖于基因型和文库大小，\n$$\n\\log \\mu_i \\;=\\; \\alpha \\;+\\; \\beta G_i \\;+\\; \\log L_i,\n$$\n并允许零膨胀概率 $\\pi_i$ 依赖于样本水平的特征，如灵敏度或组成，也可能通过混杂因素依赖于 $G_i$。一位分析师，未意识到零膨胀问题，考虑了实践中常见的两种朴素策略：（a）对 $Y_i$ 拟合一个标准的负二项广义线性模型（GLM），使用对数连接和偏移量 $\\log L_i$，忽略 $\\pi_i$；（b）将计数进行对数转换 $\\log(1+Y_i)$，并对 $G_i$ 拟合一个同方差高斯线性回归。\n\n从基本采样模型（泊松采样因过离散导致负二项分布，灵敏度限制导致混合诱导的零膨胀）出发，推断在 $\\pi_i$ 较大且可能随 $G_i$ 变化时，零膨胀如何影响eQTL检测，重点关注朴素策略下的偏差、方差、功效和I型错误率的校准。然后，提出统计学上合理的建模策略，这些策略直接解决零膨胀问题，同时保持基因型对丰度影响的可解释性，并控制文库大小和批次效应。\n\n下列哪个陈述是正确的？\n\nA. 当许多观测值为零时，零膨胀会降低检测基因型效应的功效，并且如果 $\\pi_i$ 随 $G_i$ 变化或通过混杂因素与 $G_i$ 相关，可能会导致伪关联；一种原则性的补救方法是两部分（Hurdle）模型，该模型通过逻辑斯蒂连接将 $G_i$ 回归到零指示符上，并通过负二项均值回归到正计数上，同时包含偏移量 $\\log L_i$ 和批次的随机效应。\n\nB. 在对 $\\log(1+Y_i)$ 进行对数正态回归时，零膨胀主要导致估计的基因型效应出现向上偏差，从而在保持有效的I型错误率的同时增加了功效；最有效的策略是删除所有 $Y_i=0$ 的样本。\n\nC. 对 $Y_i$ 使用具有固定离散度的标准负二项GLM，并在对数转换前添加一个小的伪计数，可以完全解决零膨胀问题；没有必要显式地对零概率 $\\pi_i$ 建模。\n\nD. 当零值是由检测限而非结构性缺失驱动时，它们可以表示为在某个阈值处的删失；对对数丰度进行带有基因型效应和样本水平随机截距的删失（Tobit）回归，相对于朴素高斯回归，可以改善校准，特别是当与 $\\log L_i$ 的偏移量结合时。\n\nE. 使用Spearman相关性对每百万转录本（TPM）进行基于秩的eQTL测试，并忽略文库大小偏移量，可以自动对零膨胀具有稳健性，并在存在大量零值时最大化功效。\n\n选择所有适用项。",
            "solution": "我们从基本事实出发：RNA-seq计数可以通过对分子的泊松采样来建模，生物学上的过离散性由负二项（NB）分布捕捉。当由于检测限或真实缺失导致许多观测计数为零时，混合模型引入了零膨胀：以概率 $\\pi_i$，$Y_i=0$，以概率 $1-\\pi_i$，$Y_i \\sim \\mathrm{NB}(\\mu_i,\\kappa)$，其中均值 $\\mu_i$ 与文库大小 $L_i$ 和真实丰度成比例。基因型效应通过 $\\log \\mu_i = \\alpha + \\beta G_i + \\log L_i$ 进入对数均值丰度。零概率 $\\pi_i$ 可能依赖于灵敏度、组成，并可能通过混杂因素依赖于 $G_i$（例如，如果 $G_i$ 与影响检测的细胞类型组成相关）。\n\n零膨胀对朴素模型的影响：\n\n- 混合模型下的期望和方差：\n$$\n\\mathbb{E}[Y_i \\mid G_i] \\;=\\; (1-\\pi_i)\\mu_i,\\quad \n\\mathrm{Var}(Y_i \\mid G_i) \\;=\\; (1-\\pi_i)\\left(\\mu_i + \\frac{\\mu_i^2}{\\kappa}\\right) + \\pi_i(1-\\pi_i)\\mu_i^2.\n$$\n相对于均值为 $\\mu_i$ 的纯NB分布，零膨胀将均值降低到 $(1-\\pi_i)\\mu_i$，并通过项 $\\pi_i(1-\\pi_i)\\mu_i^2$ 增大了方差。如果 $\\pi_i$ 很大，方差可能会显著增大。\n\n- 忽略零膨胀的朴素NB GLM：拟合 $Y_i \\sim \\mathrm{NB}(\\tilde\\mu_i,\\tilde\\kappa)$，其中 $\\log \\tilde\\mu_i = \\tilde\\alpha + \\tilde\\beta G_i + \\log L_i$，会迫使额外的零值由离散度 $\\tilde\\kappa$ 或较小的均值来解释。在Kullback–Leibler意义上，伪真参数满足\n$$\n\\tilde\\mu_i \\approx (1-\\pi_i)\\mu_i,\n$$\n直到被 $\\tilde\\kappa$ 吸收的调整项。如果 $\\pi_i$ 随 $G_i$ 变化，则 $\\log \\tilde\\mu_i \\approx \\alpha + \\beta G_i + \\log L_i + \\log(1-\\pi_i)$，因此，关于 $G_i$ 的回归斜率变为 $\\beta + \\frac{\\partial}{\\partial G_i}\\log(1-\\pi_i)$，将丰度效应与零概率效应混为一谈。即使 $\\pi_i$ 是常数，有效均值也被 $(1-\\pi_i)$ 衰减，这降低了信号强度，从而降低了功效。如果 $\\pi_i$ 由于混杂因素（例如，批次或细胞组成）与 $G_i$ 相关，朴素的NB GLM可能会表现出伪关联，因为 $\\log(1-\\pi_i)$ 随 $G_i$ 变化。\n\n- 对 $\\log(1+Y_i)$ 的朴素高斯回归：考虑 $T_i=\\log(1+Y_i)$。在混合模型下，\n$$\n\\mathbb{E}[T_i \\mid G_i] \\;=\\; \\pi_i\\log(1+0) + (1-\\pi_i)\\,\\mathbb{E}\\big[\\log(1+Y_i) \\mid Y_i \\sim \\mathrm{NB}(\\mu_i,\\kappa)\\big] \\;=\\; (1-\\pi_i)\\,\\mathbb{E}\\big[\\log(1+Y_i)\\big].\n$$\n当NB方差适中时，Delta方法近似得出 $\\mathbb{E}[\\log(1+Y_i)] \\approx \\log(1+\\mu_i) - \\frac{\\mathrm{Var}(Y_i)}{2(1+\\mu_i)^2}$。对 $G_i$ 求导，\n$$\n\\frac{\\partial}{\\partial G_i}\\,\\mathbb{E}[T_i \\mid G_i] \\;\\approx\\; (1-\\pi_i)\\,\\frac{\\partial}{\\partial G_i}\\log(1+\\mu_i) \\;+\\; \\text{terms from variance} \\;-\\; \\Big(\\frac{\\partial \\pi_i}{\\partial G_i}\\Big)\\,\\mathbb{E}[\\log(1+Y_i)].\n$$\n如果 $\\pi_i$ 是常数，相对于理想的对数尺度斜率，斜率被 $(1-\\pi_i)$ 缩放，导致衰减。此外，由于 $T_i$ 的方差依赖于 $\\mu_i$ 和 $\\pi_i$，会出现异方差性；使用同方差误差的普通最小二乘法会产生校准不当的标准误。如果 $\\frac{\\partial \\pi_i}{\\partial G_i} \\neq 0$，第二项即使在 $\\beta=0$ 时也可以诱导出明显的基因型效应，导致I型错误率膨胀。删除所有零值（限制于 $Y_i0$）会将估计目标改变为阳性样本中的条件均值，并且如果阳性与否依赖于 $G_i$ 或混杂因素，则会引入选择偏差；这还会减少样本量并丢弃有关零机制的信息。\n\n从基本过程得出的有原则的建模策略：\n\n- 两部分Hurdle模型：设 $Z_i = \\mathbb{I}\\{Y_i0\\}$。模型为\n$$\n\\mathrm{logit}\\,\\Pr(Z_i = 1 \\mid G_i, L_i, \\text{batch}) \\;=\\; \\gamma_0 + \\gamma_1 G_i + \\delta^\\top \\text{batch}_i + \\eta \\log L_i,\n$$\n并且，在 $Z_i=1$ 的条件下，对 $Y_i \\mid Z_i=1 \\sim \\mathrm{NB}(\\mu_i,\\kappa)$ 建模\n$$\n\\log \\mu_i \\;=\\; \\alpha + \\beta G_i + \\log L_i + b_i,\n$$\n其中 $b_i$ 是批次或样本效应的随机截距。这将零生成机制与正值中的丰度分开，避免了 $\\beta$ 与 $\\pi_i$ 的混淆，并通过偏移量正确地解释了 $\\log L_i$。可以对 $\\gamma_1$（存在/缺失）和 $\\beta$（丰度）进行基因型效应检验，并对跨基因和变异进行多重检验校正。\n\n- 零膨胀负二项（ZINB）：或者，在ZINB模型中联合建模 $\\pi_i$ 和 $\\mu_i$；在两个部分中都包含 $G_i$（和 $\\log L_i$）。这直接反映了混合模型，并且当零值反映了技术和生物来源时，可以改善校准和功效。\n\n- 对数丰度的删失（Tobit）回归：如果零值主要来自检测限，那么只有当 $A_i\\tau$ 时才能观测到 $A_i=\\log(\\text{丰度}_i)$；否则，它在 $\\tau$ 处被删失。一个Tobit模型，\n$$\nA_i^\\ast \\;=\\; \\alpha + \\beta G_i + \\log L_i + b_i + \\varepsilon_i, \\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\n$$\n其观测规则为 $A_i = \\max(A_i^\\ast,\\tau)$，将零值视为删失而非结构性的。当检测限占主导时，包含样本水平的随机截距 $b_i$ 和深度偏移量 $\\log L_i$ 可以改善相对于对 $\\log(1+Y_i)$ 进行的朴素高斯回归的校准。\n\n- 稳健方差估计和偏移量：无论选择何种均值模型，将 $\\log L_i$ 作为偏移量并使用批次随机效应可以减少混杂。稳健（三明治）标准误解决了异方差性问题，但不能消除忽略 $\\pi_i$ 带来的偏差。\n\n逐项分析：\n\nA. 这个陈述与推导一致。零膨胀将有效均值降低到 $(1-\\pi_i)\\mu_i$，增大了方差，因此降低了功效。如果 $\\pi_i$ 随 $G_i$ 变化或通过混杂因素相关，朴素模型会将 $\\beta$ 与 $\\pi_i$ 混淆，产生伪关联。一个包含用于零值的逻辑斯蒂部分和用于正计数的NB部分的两部分Hurdle模型，并包括 $\\log L_i$ 作为偏移量和批次随机效应，直接针对混合结构，并保持可解释性。结论：正确。\n\nB. 声称零膨胀主要导致对数正态回归下估计的基因型效应出现向上偏差并保持有效的I型错误率，这与delta方法的分析相矛盾：当 $\\pi_i$ 为常数时，斜率被 $(1-\\pi_i)$ 衰减；当 $\\pi_i$ 随 $G_i$ 变化时，I型错误率可能会膨胀。删除所有零值会引入选择偏差并丢弃信息，不是一个最优策略。结论：不正确。\n\nC. 添加伪计数并拟合标准的NB GLM并没有显式地对 $\\pi_i$ 建模；额外的零值不能被离散度完全吸收，特别是当 $\\pi_i$ 随 $G_i$ 变化时。伪计数改变了尺度，但不能解决由零机制引起的偏差或混杂。结论：不正确。\n\nD. 当零值来自检测限时，将其视为删失是合适的。一个对数丰度的Tobit模型，带有基因型效应、样本水平随机截距和深度偏移量，可以解决删失问题并改善相对于朴素高斯回归的校准。当结构性零值不太可能时，这是一个有原则的替代方案。结论：正确。\n\nE. 基于秩的检验忽略了偏移量，并且可能对零值的结（ties）敏感；如果不为 $\\log L_i$ 或零机制建模，秩并不能自动赋予稳健性，当零模式与 $G_i$ 相关时，功效可能会降低或关联会产生偏差。结论：不正确。\n\n因此，正确的选项是 A 和 D。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}