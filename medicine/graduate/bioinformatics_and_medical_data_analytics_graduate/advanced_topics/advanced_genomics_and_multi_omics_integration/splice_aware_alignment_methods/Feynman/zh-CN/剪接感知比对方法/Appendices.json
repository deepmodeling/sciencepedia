{
    "hands_on_practices": [
        {
            "introduction": "剪接感知比对器必须不断地在将一个读段（read）连续比对（可能带有插入或删除）与将其跨内含子拆分之间做出决定。这一基本选择由一个评分方案决定，该方案平衡了匹配得分与对空位和剪接事件的罚分。本练习 () 提供了应用标准仿射空位罚分和内含子罚分模型来计算和比较比对分数的直接实践，揭示了这些关键比对决策背后的核心逻辑。",
            "id": "4609252",
            "problem": "在核糖核酸测序（RNA-seq）读段到参考基因组的剪接感知比对中，目标是选择一个能够优化加性比对得分的映射，该得分源自序列进化和测序错误的概率模型。一个标准且经过充分检验的评分框架使用仿射空位罚分来模拟插入或缺失，并使用一个单独的内含子罚分来模拟剪接位点。在此框架中，每个匹配的碱基贡献一个匹配得分，而结构事件贡献固定的罚分：\n\n- 每个匹配的碱基对比对得分贡献 $c_{M}$。\n- 长度为 $l$ 的空位（插入或缺失）贡献总罚分 $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$，表示一个空位开放事件和 $l$ 个空位延伸步骤。\n- 在这个简化模型中，一个剪接位点贡献一个单一的内含子罚分 $c_{I}$，与内含子长度无关。\n\n考虑一个长度为 $150$ 碱基对的读段，它有两个候选基因组映射：\n\n1. 候选 A 是一个连续的基因组比对，在读段到参考序列的比对中包含一个长度为 $10$ 的单一缺失，有 $140$ 个匹配的碱基，没有错配。\n2. 候选 B 是一个剪接比对，其中读段被分割成两个各为 $75$ 个碱基的片段，映射到一个内含子两侧的两个外显子上，从而产生 $150$ 个匹配的碱基和一个剪接位点，外显子内部没有错配和基因组空位。\n\n假设评分常数如下：$c_{M}=-2$，$c_{\\text{gap\\_open}}=-5$，$c_{\\text{gap\\_extend}}=-1$，$c_{I}=-20$。将每个候选的比对得分定义为上述所有适用贡献的总和。计算比对得分差异 $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$，其中 $S_{\\text{splice}}$ 是候选 B 的得分，$S_{\\text{deletion}}$ 是候选 A 的得分。请以单个实数形式提供最终答案，无需四舍五入。",
            "solution": "首先验证问题陈述，以确保其科学上合理、内容自洽且定义明确。\n\n**步骤 1：提取已知条件**\n- **读段长度**: $150$ 碱基对 (bp)。\n- **每个碱基的匹配得分**: $c_{M} = -2$。\n- **长度为 $l$ 的空位的仿射空位罚分**: 总贡献为 $c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$。\n- **空位开放罚分**: $c_{\\text{gap\\_open}} = -5$。\n- **空位延伸罚分**: $c_{\\text{gap\\_extend}} = -1$。\n- **每个剪接位点的内含子罚分**: $c_{I} = -20$。\n- **候选 A (缺失比对)**: 一个连续比对，有 $140$ 个匹配的碱基和一个长度为 $l=10$ 的单一缺失。\n- **候选 B (剪接比对)**: 一个剪接比对，有两个各为 $75$ 个碱基的片段，从而产生 $150$ 个匹配的碱基和一个剪接位点。\n- **目标**: 计算比对得分差异 $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$，其中 $S_{\\text{splice}}$ 是候选 B 的得分，$S_{\\text{deletion}}$ 是候选 A 的得分。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题描述了一个用于RNA-seq比对评分的简化但标准且有科学依据的模型。使用仿射空位罚分和特定的内含子罚分是剪接感知比对算法中的常见做法。所提供的参数和比对情景定义清晰、自洽且客观。$150$ bp的读段长度与两个候选的细节一致（候选A：$140$ 个匹配 + 从参考序列中删除的 $10$ 个碱基，总计 $150$ 个读段碱基；候选B：$75+75=150$ 个匹配碱基）。该问题是良定的，因为它包含了计算唯一、有意义的数值解所需的所有信息。问题不违反任何科学原理，没有歧义，并且可以直接求解。\n\n**步骤 3：结论与行动**\n问题被认为是有效的。将推导出解决方案。\n\n**求解过程推导**\n比对得分 $S$ 是通过将所有比对特征（匹配、空位和内含子）的贡献相加计算得出的。\n\n首先，我们计算候选 A（带缺失的连续比对）的得分，记为 $S_{\\text{deletion}}$。\n候选 A 有 $140$ 个匹配的碱基。来自匹配的总贡献是匹配数乘以每个碱基的匹配得分 $c_{M}$。\n来自匹配的贡献 = $140 \\cdot c_{M}$。\n候选 A 有一个长度为 $l=10$ 的单一缺失。这构成了一个空位开放事件和 $10$ 个空位延伸步骤。来自此空位的总罚分贡献由仿射空位罚分公式给出：$c_{\\text{gap\\_open}} + l \\cdot c_{\\text{gap\\_extend}}$，其中 $l=10$。\n来自空位的贡献 = $c_{\\text{gap\\_open}} + 10 \\cdot c_{\\text{gap\\_extend}}$。\n候选 A 中没有剪接位点。\n候选 A 的总得分是这些贡献的总和：\n$$S_{\\text{deletion}} = 140 \\cdot c_{M} + (c_{\\text{gap\\_open}} + 10 \\cdot c_{\\text{gap\\_extend}})$$\n代入给定值：\n$$S_{\\text{deletion}} = 140 \\cdot (-2) + (-5 + 10 \\cdot (-1))$$\n$$S_{\\text{deletion}} = -280 + (-5 - 10)$$\n$$S_{\\text{deletion}} = -280 - 15 = -295$$\n\n接下来，我们计算候选 B（剪接比对）的得分，记为 $S_{\\text{splice}}$。\n候选 B 有 $150$ 个匹配的碱基。来自匹配的贡献是：\n来自匹配的贡献 = $150 \\cdot c_{M}$。\n候选 B 有一个剪接位点，贡献了内含子罚分 $c_{I}$。\n来自内含子的贡献 = $c_{I}$。\n候选 B 的外显子内没有空位。\n候选 B 的总得分是这些贡献的总和：\n$$S_{\\text{splice}} = 150 \\cdot c_{M} + c_{I}$$\n代入给定值：\n$$S_{\\text{splice}} = 150 \\cdot (-2) + (-20)$$\n$$S_{\\text{splice}} = -300 - 20$$\n$$S_{\\text{splice}} = -320$$\n\n最后，我们计算所要求的比对得分差异 $\\Delta S = S_{\\text{splice}} - S_{\\text{deletion}}$。\n$$\\Delta S = (-320) - (-295)$$\n$$\\Delta S = -320 + 295$$\n$$\\Delta S = -25$$\n\n比对得分的差异是 $-25$。这表明，根据指定的评分模型，带有缺失的比对（候选 A）比剪接比对（候选 B）更优，因为它有更高（负值更小）的得分。",
            "answer": "$$\\boxed{-25}$$"
        },
        {
            "introduction": "在确定最佳比对后，量化该选择的置信度至关重要，尤其是在存在多个可能的比对位置时。比对质量（MAPQ）分数提供了这种置信度的概率度量，这对于变异检测等下游分析至关重要。本实践问题 () 演示了如何根据竞争比对的后验概率计算 MAPQ，阐明了贝叶斯原理在生物信息学实践中的应用。",
            "id": "4609207",
            "problem": "一条RNA测序（RNA-seq）读段跨越一个假定的剪接连接点，并由一个使用隐马尔可夫模型（HMM）为剪接比对打分的剪接感知比对器进行评估。该比对器考虑了关于该读段来源的两个互斥候选假设：$H_{A}$，一个与该基因已知注释轨迹一致的经典供体-受体剪接（$\\mathrm{GT}$–$\\mathrm{AG}$）；以及$H_{B}$，一个注释中不存在的非经典供体-受体剪接（$\\mathrm{GC}$–$\\mathrm{AG}$）。对于观测到的碱基和缺口结构，两个假设的HMM似然值相等，即 $P(D \\mid H_{A}) = P(D \\mid H_{B})$，其中 $D$ 表示观测到的读段序列及其比对特征。在此基因座上，经典剪接位点先前的使用情况得到了群体水平的连接计数的支持，从而得出先验概率 $P(H_{A}) = 0.9$ 和 $P(H_{B}) = 0.1$。使用贝叶斯法则，并根据“比对质量（MAPQ）是所报告最佳比对不正确的概率的Phred（PHRED）尺度变换”这一定义，计算将 $H_{A}$ 报告为最佳比对时的 $MAPQ$。\n\n您可以假设：\n- $P(H_{A} \\mid D) = \\dfrac{P(D \\mid H_{A}) P(H_{A})}{P(D \\mid H_{A}) P(H_{A}) + P(D \\mid H_{B}) P(H_{B})}$，$H_{B}$ 的情况类似。\n- 报告的最佳比对的错误概率为 $p_{\\mathrm{error}} = 1 - P_{\\mathrm{best}}$，其中 $P_{\\mathrm{best}}$ 是所选最佳假设的后验概率。\n- 对于概率 $p$，Phred尺度变换为 $Q = -10 \\log_{10}(p)$。\n\n将 $MAPQ$ 的最终值表示为一个不进行四舍五入的精确整数。",
            "solution": "剪接感知比对器产生两个假设 $H_{A}$ 和 $H_{B}$，在隐马尔可夫模型下它们的似然值相等，因此 $P(D \\mid H_{A}) = P(D \\mid H_{B})$。先验概率为 $P(H_{A}) = 0.9$ 和 $P(H_{B}) = 0.1$。根据贝叶斯法则，\n$$\nP(H_{A} \\mid D) = \\frac{P(D \\mid H_{A}) P(H_{A})}{P(D \\mid H_{A}) P(H_{A}) + P(D \\mid H_{B}) P(H_{B})}.\n$$\n因为 $P(D \\mid H_{A}) = P(D \\mid H_{B})$，将这个共同的似然值记为 $L$；那么\n$$\nP(H_{A} \\mid D) = \\frac{L \\cdot 0.9}{L \\cdot 0.9 + L \\cdot 0.1} = \\frac{0.9}{0.9 + 0.1} = 0.9,\n$$\n同样地，\n$$\nP(H_{B} \\mid D) = \\frac{L \\cdot 0.1}{L \\cdot 0.9 + L \\cdot 0.1} = \\frac{0.1}{1.0} = 0.1.\n$$\n要报告的最佳比对是 $H_{A}$，其后验概率为 $P_{\\mathrm{best}} = P(H_{A} \\mid D) = 0.9$。所报告的最佳比对的错误概率，即该报告的比对是错误的概率，为\n$$\np_{\\mathrm{error}} = 1 - P_{\\mathrm{best}} = 1 - 0.9 = 0.1.\n$$\n比对质量（MAPQ）是此错误概率的Phred尺度变换：\n$$\nMAPQ = -10 \\log_{10}(p_{\\mathrm{error}}) = -10 \\log_{10}(0.1).\n$$\n使用恒等式 $\\log_{10}(0.1) = \\log_{10}(10^{-1}) = -1$，我们得到\n$$\nMAPQ = -10 \\cdot (-1) = 10.\n$$\n这已经是一个精确的整数，所以不需要四舍五入。",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "评估剪接感知比对器的整体性能需要稳健和标准化的指标。在评估外显子-外显子连接点检测这一关键任务时，精确率（precision）和灵敏度（sensitivity/recall）为比对器的准确性提供了互补的视角。本练习 () 专注于计算 $F_1$ 分数，即精确率和灵敏度的调和平均数，它为比较不同比对工具或参数设置的性能提供了一个单一、平衡的度量。",
            "id": "4609249",
            "problem": "对一款剪接感知型读段比对器在外显子-外显子连接点检测方面的性能进行评估。评估使用模拟的RNA测序(RNA-seq)数据，其中基准剪接连接点由注释提供。假设评估在连接点水平上进行，一个预测的连接点只有在其供体和受体位点均与注释完全匹配时，才被认为是正确的。设精确率和灵敏度（召回率）由标准的混淆计数比率定义，即精确率 $P = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FP}}$ 和灵敏度 $R = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}$，其中 $\\mathrm{TP}$、$\\mathrm{FP}$ 和 $\\mathrm{FN}$ 分别表示真阳性、假阳性和假阴性。已知该比对器在此基准测试中，于连接点水平上得到的灵敏度为 $R = 0.85$，精确率为 $P = 0.90$。\n\n从两个正实数的调和平均数的数学定义（即其倒数的算术平均数的倒数）出发，推导出一个平衡的汇总统计量 $F_{1}$ 的闭式表达式，该统计量是作为 $P$ 和 $R$ 的调和平均数来同等加权精确率和灵敏度的。然后，代入 $P = 0.90$ 和 $R = 0.85$ 计算其值。以无量纲量的形式报告 $F_{1}$ 分数。将最终数值答案四舍五入至四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n- 上下文是评估一款剪接感知型读段比对器在外显子-外显子连接点检测方面的性能。\n- 当且仅当预测连接点的供体和受体位点均与注释匹配时，该预测才被视为正确。\n- 精确率定义为 $P = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FP}}$。\n- 灵敏度（召回率）定义为 $R = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}$。\n- 真阳性、假阳性和假阴性分别用 $\\mathrm{TP}$、$\\mathrm{FP}$ 和 $\\mathrm{FN}$ 表示。\n- 该比对器的性能指标为 $R = 0.85$ 和 $P = 0.90$。\n- 两个正实数的调和平均数定义为其倒数的算术平均数的倒数。\n- $F_{1}$ 分数定义为 $P$ 和 $R$ 的调和平均数。\n- 任务是推导 $F_{1}$ 分数的闭式表达式，并用给定的 $P$ 和 $R$ 值进行计算。\n- 最终数值答案必须四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n对问题陈述的有效性进行评估：\n- **科学依据**：该问题基于生物信息学和机器学习性能评估的标准原则。精确率（$P$）、灵敏度（$R$）和 $F_{1}$ 分数的定义都是标准的且表述正确。RNA-seq数据分析和剪接连接点检测的背景是基因组学研究中一个公认的领域。\n- **适定性**：该问题是适定的。它提供了推导所求表达式和计算最终值所需的所有必要定义和数值。任务陈述清晰，并能导向一个唯一的、稳定的解。\n- **客观性**：该问题以客观、精确的语言表述。所用术语均为该领域的标准术语，没有歧义。给定的值 $P=0.90$ 和 $R=0.85$ 对于现代比对工具是符合实际的。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它在科学上是合理的、适定的，并且提供了求解所需的所有信息。我现在将进行推导和计算。\n\n问题要求推导 $F_1$ 分数，它被定义为精确率 $P$ 和灵敏度 $R$ 的调和平均数。两个正实数 $x$ 和 $y$ 的调和平均数 $H$ 的定义是它们倒数的算术平均数的倒数。\n\n让我们将此定义形式化。$x$ 和 $y$ 的倒数是 $\\frac{1}{x}$ 和 $\\frac{1}{y}$。\n这些倒数的算术平均数是：\n$$ \\text{倒数的平均值} = \\frac{\\frac{1}{x} + \\frac{1}{y}}{2} $$\n调和平均数是这个量的倒数：\n$$ H(x, y) = \\frac{1}{\\frac{\\frac{1}{x} + \\frac{1}{y}}{2}} $$\n这可以简化为：\n$$ H(x, y) = \\frac{2}{\\frac{1}{x} + \\frac{1}{y}} $$\n为了合并分母中的分数，我们找到公分母 $xy$：\n$$ \\frac{1}{x} + \\frac{1}{y} = \\frac{y}{xy} + \\frac{x}{xy} = \\frac{x+y}{xy} $$\n将此代回 $H(x, y)$ 的表达式中：\n$$ H(x, y) = \\frac{2}{\\frac{x+y}{xy}} $$\n化简这个繁分数即可得到两个数的调和平均数的标准闭式表达式：\n$$ H(x, y) = \\frac{2xy}{x+y} $$\n问题将 $F_1$ 分数定义为精确率 $P$ 和灵敏度 $R$ 的调和平均数。因此，我们将 $x=P$ 和 $y=R$ 代入推导出的表达式中：\n$$ F_1 = \\frac{2PR}{P+R} $$\n这就是所求的 $F_1$ 分数的闭式表达式。\n\n下一步是用给定的值 $P = 0.90$ 和 $R = 0.85$ 来计算该表达式。\n将这些值代入公式：\n$$ F_1 = \\frac{2 \\times 0.90 \\times 0.85}{0.90 + 0.85} $$\n首先，我们分别计算分子和分母。\n分子是：\n$$ 2 \\times 0.90 \\times 0.85 = 1.80 \\times 0.85 = 1.53 $$\n分母是：\n$$ 0.90 + 0.85 = 1.75 $$\n现在，我们计算该分数值：\n$$ F_1 = \\frac{1.53}{1.75} $$\n为了便于计算，我们可以将其表示为整数分数：\n$$ F_1 = \\frac{153}{175} $$\n进行除法运算得到：\n$$ F_1 = 0.874285714... $$\n题目要求最终答案四舍五入到四位有效数字。前四位有效数字是 $8$、$7$、$4$ 和 $2$。第五位有效数字是 $8$，大于或等于 $5$，因此我们必须将第四位有效数字进一位。\n$$ F_1 \\approx 0.8743 $$\n这就是 $F_1$ 分数的最终数值。",
            "answer": "$$\\boxed{0.8743}$$"
        }
    ]
}