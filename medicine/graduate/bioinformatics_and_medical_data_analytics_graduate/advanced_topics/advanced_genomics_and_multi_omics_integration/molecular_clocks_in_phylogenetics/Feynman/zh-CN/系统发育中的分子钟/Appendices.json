{
    "hands_on_practices": [
        {
            "introduction": "第一个练习为分子定年提供了基础性经验。通过应用Jukes-Cantor模型——最简单的核酸替换模型之一——您将从观测到的序列差异中推导并计算分化时间。这项练习揭示了更复杂的系统发育软件背后的核心计算原理，并巩固了遗传距离、替换速率和演化时间之间的基本关系 。",
            "id": "4586166",
            "problem": "在一项临床病毒基因组学研究中，独立抽样了两条甲型流感病毒血凝素编码序列，并在一个足够长的区域上进行了比对，使得观测到的差异中的抽样噪音可以忽略不计。两条比对序列之间观测到的核苷酸差异比例（未校正的汉明距离）为 $p = 0.015$。基于有年代样本的先前分子钟分析表明，两个后代谱系合计的每个位点成对替换累积速率为 $r = 2.4 \\times 10^{-3}$ 替换/位点/年。\n\n假设使用 Jukes–Cantor 1969 (JC69) 核苷酸替换模型，这是一个作用于字母表 $\\{A,C,G,T\\}$ 上的连续时间马尔可夫链 (CTMC)，其状态频率相等，非对角瞬时速率也相等。设单个谱系的 CTMC 的生成元矩阵为 $Q$，其非对角线元素为 $Q_{ij} = \\alpha$（当 $i \\neq j$ 时），对角线元素为 $Q_{ii} = -3\\alpha$。并设单个谱系每个位点的替换速率为 $\\mu = 3\\alpha$。在严格分子钟的假设下，两个后代谱系独立演化了相同的分化时间 $t$，并且成对速率满足 $r = 2\\mu$。\n\n基于这些基础，推导分化时间 $t$ 作为可观测量 $p$ 和已知速率 $r$ 的函数表达式，然后使用给定的 $p$ 和 $r$ 对 $t$ 进行数值计算。将最终数值答案四舍五入到四位有效数字，并以年为单位表示时间。在推导过程中，清晰阐明该表达式有效所需的假设，并说明为使基于模型的反演能够得到有限实数值时间，$p$ 必须满足的任何限制条件。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。这是一个基于基础 Jukes-Cantor 模型的分子系统发育学标准问题。所有必要的参数均已提供，且内部没有矛盾。\n\n解答过程分四个阶段：\n1.  推导观测到的差异比例 $p$ 与分化时间 $t$ 之间的关系。\n2.  对此关系进行反演，以找到 $t$ 作为 $p$ 和成对替换速率 $r$ 的函数表达式。\n3.  陈述假设以及对 $p$ 值的数学限制。\n4.  使用所提供的数据对 $t$ 进行数值计算。\n\n让我们从 Jukes-Cantor 1969 (JC69) 模型开始。它是一个用于核苷酸替换的连续时间马尔可夫链 (CTMC)。对于单个谱系，瞬时速率矩阵 $Q$ 由下式给出\n$$\nQ = \\begin{pmatrix} -3\\alpha & \\alpha & \\alpha & \\alpha \\\\ \\alpha & -3\\alpha & \\alpha & \\alpha \\\\ \\alpha & \\alpha & -3\\alpha & \\alpha \\\\ \\alpha & \\alpha & \\alpha & -3\\alpha \\end{pmatrix}\n$$\n其中 $\\alpha$ 是从任意一种核苷酸替换为任意另一种特定核苷酸的速率。\n\n该问题考虑的是两条在 $t$ 年前从一个共同祖先分化出来的序列。在严格分子钟的假设下，它们沿着两条等长（时长为 $t$）的谱系独立演化。我们想要找到在给定的同源位点上，两条序列中的核苷酸不同的概率 $p$。将此概率记为 $p_{\\text{diff}}(t)$。在时间 $t=0$（共同祖先）时，序列是相同的，所以 $p_{\\text{diff}}(0) = 0$。\n\n让我们对这对位点的状态演化进行建模。一对位点可以处于两种状态之一：“相同”(S) 或 “不同”(D)。\n如果一个谱系发生了替换而另一个没有，则会发生从 S 到 D 的转变。任何核苷酸替换为其他三种中任意一种的速率是 $3\\alpha$。由于这可以在两个谱系中的任何一个发生，因此从 S 到 D 的转变速率是 $2 \\times 3\\alpha = 6\\alpha$。\n如果一个谱系中的核苷酸突变以匹配另一个谱系中的核苷酸，则可能发生从 D 到 S 的转变。例如，如果位点是 A 和 C，那么 A 可以突变为 C（速率为 $\\alpha$），或者 C 可以突变为 A（速率为 $\\alpha$）。因此，从 D 到 S 的总转变速率是 $2\\alpha$。\n\n这定义了一个在 $\\{S, D\\}$ 上的双态 CTMC，处于“不同”状态的概率 $p_{\\text{diff}}(t)$ 遵循以下微分方程：\n$$\n\\frac{dp_{\\text{diff}}(t)}{dt} = (\\text{rate S}\\to\\text{D}) \\cdot p_{\\text{same}}(t) - (\\text{rate D}\\to\\text{S}) \\cdot p_{\\text{diff}}(t)\n$$\n代入速率并利用 $p_{\\text{same}}(t) = 1 - p_{\\text{diff}}(t)$ 这一事实，我们得到：\n$$\n\\frac{dp_{\\text{diff}}(t)}{dt} = 6\\alpha (1 - p_{\\text{diff}}(t)) - 2\\alpha \\, p_{\\text{diff}}(t) = 6\\alpha - 8\\alpha \\, p_{\\text{diff}}(t)\n$$\n这是一个一阶线性常微分方程。其通解形式为 $p_{\\text{diff}}(t) = A \\exp(-8\\alpha t) + B$。通过将导数设为零来求得特解 $B$：$0 = 6\\alpha - 8\\alpha B$，解得 $B = 6\\alpha / (8\\alpha) = 3/4$。所以，$p_{\\text{diff}}(t) = A \\exp(-8\\alpha t) + 3/4$。\n使用初始条件 $p_{\\text{diff}}(0) = 0$，我们求得 $A$：\n$0 = A \\exp(0) + 3/4 \\implies A = -3/4$。\n因此，不同位点的比例作为分化时间 $t$ 的函数是：\n$$\np(t) = \\frac{3}{4} \\left(1 - \\exp(-8\\alpha t)\\right)\n$$\n问题提供了观测到的差异 $p=0.015$，它对应于 $p(t)$。\n\n接下来，我们用给定的成对速率 $r$ 来表示这个方程。单个谱系的替换速率 $\\mu$ 是单位时间内每个位点的预期替换数。对于 JC69 模型，该速率为 $\\mu = 3\\alpha$。成对替换累积速率 $r$ 是两个谱系合并的速率。因此，$r = 2\\mu$。代入 $\\mu = 3\\alpha$，我们得到 $r = 2(3\\alpha) = 6\\alpha$。这使我们可以写出 $\\alpha = r/6$。\n将此代入我们关于 $p(t)$ 的表达式中：\n$$\np = \\frac{3}{4} \\left(1 - \\exp(-8(r/6) t)\\right) = \\frac{3}{4} \\left(1 - \\exp\\left(-\\frac{4}{3}rt\\right)\\right)\n$$\n现在，我们反演这个表达式来求解分化时间 $t$：\n$$\n\\frac{4}{3} p = 1 - \\exp\\left(-\\frac{4}{3}rt\\right)\n$$\n$$\n\\exp\\left(-\\frac{4}{3}rt\\right) = 1 - \\frac{4}{3}p\n$$\n$$\n-\\frac{4}{3}rt = \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n$$\nt = -\\frac{3}{4r} \\ln\\left(1 - \\frac{4}{3}p\\right)\n$$\n这就是我们想要的 $t$ 作为 $p$ 和 $r$ 的函数表达式。\n\n此推导有效的关键假设是：\n1.  Jukes-Cantor 核苷酸替换模型是对演化过程的准确描述。这包括相等的平衡碱基频率（$\\pi_A = \\pi_C = \\pi_G = \\pi_T = 1/4$）和所有类型替换的相等速率。\n2.  严格分子钟成立，意味着替换速率 $\\mu$ 在不同谱系间和随时间推移都是恒定的。\n3.  两个谱系从它们最近的共同祖先分化后独立演化。\n4.  观测到的差异比例 $p$ 没有抽样误差，并准确反映了期望值 $p(t)$。\n\n为了使表达式能得到一个有限、实数且正数的时间 $t$，自然对数的参数必须严格介于 $0$ 和 $1$ 之间：\n$$\n0 < 1 - \\frac{4}{3}p \\le 1\n$$\n不等式的右侧，$1 - \\frac{4}{3}p \\le 1$，意味着 $-\\frac{4}{3}p \\le 0$，这对任何 $p > 0$ 都成立。$p=0$ 的情况得出 $t=0$。\n不等式的左侧，$0 < 1 - \\frac{4}{3}p$，意味着 $\\frac{4}{3}p < 1$，即 $p < 3/4$。\n因此，对可观测量 $p$ 的限制是 $0 \\le p < 0.75$。如果 $p \\ge 0.75$，模型表明序列已经达到替换饱和，无法估算出有限的分化时间。\n\n最后，我们使用给定的值 $p = 0.015$ 和 $r = 2.4 \\times 10^{-3}$ 替换/位点/年 来对 $t$ 进行数值计算。\n首先，我们检查 $p$ 是否在有效范围内：$0.015 < 0.75$，因此计算是有效的。\n将这些值代入推导出的公式中：\n$$\nt = -\\frac{3}{4 \\times (2.4 \\times 10^{-3})} \\ln\\left(1 - \\frac{4}{3} \\times 0.015\\right)\n$$\n首先，计算对数内的项：\n$$\n\\frac{4}{3} \\times 0.015 = 4 \\times 0.005 = 0.02\n$$\n$$\n1 - 0.02 = 0.98\n$$\n现在，将此代回 $t$ 的表达式中：\n$$\nt = -\\frac{3}{9.6 \\times 10^{-3}} \\ln(0.98)\n$$\n前置因子是：\n$$\n\\frac{3}{9.6 \\times 10^{-3}} = \\frac{3}{0.0096} = 312.5\n$$\n所以，表达式变为：\n$$\nt = -312.5 \\times \\ln(0.98)\n$$\n使用计算器计算自然对数：\n$$\n\\ln(0.98) \\approx -0.020202707\n$$\n$$\nt \\approx -312.5 \\times (-0.020202707) \\approx 6.3133459 \\text{ 年}\n$$\n将结果四舍五入到四位有效数字，我们得到 $t \\approx 6.313$ 年。",
            "answer": "$$\\boxed{6.313}$$"
        },
        {
            "introduction": "严格分子钟是一个强大但往往不切实际的假设。这项练习进入了模型检验的关键领域，您将使用从“根到尖”回归分析得到的数据，来比较单一的“全局”时钟与更灵活的“局域”时钟模型。通过使用赤池信息准则（Akaike Information Criterion, AIC），您将学会如何量化地证明选择一个更复杂模型的合理性，这是现代系统发育分析中一项常见且至关重要的任务 。",
            "id": "4586176",
            "problem": "一个病毒学监测项目生成了一个RNA病毒的时间标定系统发育树，其中包含三个支持度高的单系进化枝，记为 $C_1$、$C_2$ 和 $C_3$。对于每个尖端（叶节点）$i$，从该有年代标记的树中提取了根到尖端的遗传距离 $R_i$（单位为每位点替换数）和采样时间 $T_i$（单位为年，所有进化枝均在同一绝对时间轴上测量）。为了评估分子钟行为，使用线性模型 $R_i = a + r T_i + \\varepsilon_i$ 对数据进行了全局根到尖端回归拟合，其中 $a$ 是共享截距，$r$ 是共享速率，$\\varepsilon_i$ 是独立误差。假设误差 $\\varepsilon_i$ 独立同分布于均值为 $0$、方差为 $\\sigma^2$ 的正态分布。\n\n基本原理：\n- 在严格分子钟假设下，分支特异性速率在整个树上是恒定的，这意味着累积替换数与时间之间存在线性关系。根到尖端回归通过拟合线性模型并检查残差中是否存在结构来评估这一点。\n- 对于具有独立同分布正态误差的线性模型，最大似然估计 (MLE) 与普通最小二乘法 (OLS) 产生相同的拟合结果。残差平方和 (SSR) $S = \\sum_i \\varepsilon_i^2$ 是拟合优度的充分统计量，模型选择可以通过Akaike信息准则 (AIC) 进行。对于具有 $p$ 个自由参数和 $n$ 个观测值的正态误差回归，AIC定义为 $\\mathrm{AIC} = 2p - 2 \\hat{\\ell}$，其中 $\\hat{\\ell}$ 是最大化的对数似然。当 $\\sigma^2$ 通过 $\\hat{\\sigma}^2 = S/n$ 估计时，可以得到标准形式 $\\mathrm{AIC} = 2p + n \\ln\\!\\big(S/n\\big) + \\text{constant}$，其中常数项在候选模型之间的差异比较中被抵消。\n\n全局拟合的经验总结：\n- 全局拟合使用了 $n = 90$ 个尖端，得到的残差平方和 (SSR) 为 $S_0 = 820$。\n- 令 $\\mathbf{e}$ 表示全局拟合的残差向量。为了检验是否存在进化枝特异性地偏离类时钟行为，考虑通过预测变量 $\\mathbf{x}_k = \\big(T_i \\,\\mathbb{1}(i \\in C_k)\\big)$，$k \\in \\{1,2,3\\}$，为进化枝添加局部速率偏差参数，同时保留共享截距和共享全局速率。\n- 在将每个 $\\mathbf{x}_k$ 相对于全局截距和时间列进行适当的残差化处理后（以确保有效的偏平方和），添加单个进化枝特异性速率偏差所导致的SSR减少量由 $\\Delta_k$ 给出，计算出的三个进化枝的 $\\Delta_k$ 如下：\n  - $\\Delta_1 = 140$,\n  - $\\Delta_2 = 70$,\n  - $\\Delta_3 = 40$.\n- 由于进化枝特异性预测变量具有不相交的支持集，并且已经相对于基准列进行了残差化处理，因此添加任何进化枝特异性偏差子集所带来的总SSR减少量等于相应 $\\Delta_k$ 的总和。\n\n模型选择：\n- 基准全局时钟模型有 $p_0 = 2$ 个参数（$a$ 和 $r$）。\n- 每增加一个局部速率偏差参数，参数数量就增加1。\n\n问题：在正态误差模型下，使用最大似然估计 (MLE) 原理和Akaike信息准则 (AIC) 进行模型选择，下列选项中哪种局部时钟的分配方案能产生最佳模型（即AIC值最低）？\n\nA. 仅对 $C_1$ 和 $C_2$ 应用局部时钟（保留一个共享截距和全局速率，外加两个进化枝偏差）。\n\nB. 仅对 $C_1$ 应用局部时钟（保留一个共享截距和全局速率，外加一个进化枝偏差）。\n\nC. 对所有三个进化枝 $C_1$、$C_2$ 和 $C_3$ 应用局部时钟（保留一个共享截距和全局速率，外加三个进化枝偏差）。\n\nD. 不应用任何局部时钟；仅保留全局时钟。\n\nE. 仅对 $C_2$ 和 $C_3$ 应用局部时钟（保留一个共享截距和全局速率，外加两个进化枝偏差）。",
            "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n**第1步：提取已知条件**\n- 分析涉及三个单系进化枝：$C_1$、$C_2$ 和 $C_3$。\n- 对于每个尖端 $i$，我们有根到尖端的遗传距离 $R_i$ 和采样时间 $T_i$。\n- 拟合了一个全局线性模型：$R_i = a + r T_i + \\varepsilon_i$。\n- 误差 $\\varepsilon_i$ 独立同分布于均值为 $0$、方差为 $\\sigma^2$ 的正态分布。\n- 尖端总数（观测值数量）为 $n = 90$。\n- 全局拟合（基准模型）有 $p_0 = 2$ 个参数（$a$ 和 $r$），产生的残差平方和 (SSR) 为 $S_0 = 820$。\n- Akaike信息准则 (AIC) 由 $\\mathrm{AIC} = 2p + n \\ln(S/n)$ 给出，忽略一个加性常数，其中 $p$ 是自由参数的数量，$S$ 是给定模型的SSR。\n- 为一个进化枝添加一个局部速率偏差参数会使参数数量 $p$ 增加1。\n- 添加单个进化枝特异性速率偏差参数所导致的SSR减少量为：\n  - 对于 $C_1$：$\\Delta_1 = 140$。\n  - 对于 $C_2$：$\\Delta_2 = 70$。\n  - 对于 $C_3$：$\\Delta_3 = 40$。\n- 具有多个局部时钟的模型的总SSR减少量是所包含进化枝的各个 $\\Delta_k$ 值的总和。\n\n**第2步：使用提取的已知条件进行验证**\n问题陈述描述了分子系统发育学中的一个标准统计过程：使用根到尖端回归来评估严格分子钟假说，并采用像AIC这样的模型选择准则来比较具有不同时钟假设（例如，全局时钟与局部时钟）的模型。\n\n- **科学依据：** 分子钟、根到尖端回归、残差平方和以及Akaike信息准则等概念是生物信息学和统计学中基本且广泛使用的原理。该设置是线性模型比较的一个典型例子。\n- **问题定义明确：** 该问题定义明确。它提供了所有必要的数据（$n$、$S_0$ 和所有的 $\\Delta_k$）以及一个明确的目标函数（最小化AIC），从而可以唯一地确定给定选项中的最佳模型。SSR减少量的可加性是指定的模型结构（具有不相交支持集的残差化预测变量）的有效推论。\n- **客观性：** 问题以精确、客观的数学和统计语言陈述。它没有歧义或主观性陈述。\n\n**第3步：结论与行动**\n问题是有效的。它在科学上合理，定义明确且客观。可以继续进行求解过程。\n\n**求解推导**\n任务是确定所提出的时钟模型中哪一个最受数据支持，其中“最佳”定义为具有最小的Akaike信息准则 (AIC)。用于比较的AIC公式是 $\\mathrm{AIC} = 2p + n \\ln(S/n)$，其中 $p$ 是参数数量，$n$ 是观测值数量，$S$ 是残差平方和 (SSR)。已知 $n = 90$。\n\n我们必须为选项中描述的每个模型计算AIC。\n\n**模型D：仅全局时钟**\n这是基准模型。\n- 参数数量：$p_D = p_0 = 2$（一个截距 $a$，一个速率 $r$）。\n- 残差平方和：$S_D = S_0 = 820$。\n- AIC计算：\n$$ \\mathrm{AIC}_D = 2p_D + n \\ln(S_D/n) = 2(2) + 90 \\ln(820/90) = 4 + 90 \\ln(9.111...) \\approx 4 + 90(2.2095) \\approx 202.86 $$\n\n**模型B：仅对 $C_1$ 应用局部时钟**\n该模型在全局模型的基础上增加了一个局部速率参数。\n- 参数数量：$p_B = p_0 + 1 = 2 + 1 = 3$。\n- 残差平方和：SSR减少了 $\\Delta_1$。\n$$ S_B = S_0 - \\Delta_1 = 820 - 140 = 680 $$\n- AIC计算：\n$$ \\mathrm{AIC}_B = 2p_B + n \\ln(S_B/n) = 2(3) + 90 \\ln(680/90) = 6 + 90 \\ln(7.555...) \\approx 6 + 90(2.0223) \\approx 188.01 $$\n\n**模型A：仅对 $C_1$ 和 $C_2$ 应用局部时钟**\n该模型增加了两个局部速率参数。\n- 参数数量：$p_A = p_0 + 2 = 2 + 2 = 4$。\n- 残差平方和：SSR减少了 $\\Delta_1 + \\Delta_2$。\n$$ S_A = S_0 - (\\Delta_1 + \\Delta_2) = 820 - (140 + 70) = 820 - 210 = 610 $$\n- AIC计算：\n$$ \\mathrm{AIC}_A = 2p_A + n \\ln(S_A/n) = 2(4) + 90 \\ln(610/90) = 8 + 90 \\ln(6.777...) \\approx 8 + 90(1.9137) \\approx 180.23 $$\n\n**模型E：仅对 $C_2$ 和 $C_3$ 应用局部时钟**\n该模型增加了两个局部速率参数。\n- 参数数量：$p_E = p_0 + 2 = 2 + 2 = 4$。\n- 残差平方和：SSR减少了 $\\Delta_2 + \\Delta_3$。\n$$ S_E = S_0 - (\\Delta_2 + \\Delta_3) = 820 - (70 + 40) = 820 - 110 = 710 $$\n- AIC计算：\n$$ \\mathrm{AIC}_E = 2p_E + n \\ln(S_E/n) = 2(4) + 90 \\ln(710/90) = 8 + 90 \\ln(7.888...) \\approx 8 + 90(2.0654) \\approx 193.89 $$\n\n**模型C：对所有三个进化枝 $C_1$、$C_2$ 和 $C_3$ 应用局部时钟**\n该模型增加了三个局部速率参数。\n- 参数数量：$p_C = p_0 + 3 = 2 + 3 = 5$。\n- 残差平方和：SSR减少了 $\\Delta_1 + \\Delta_2 + \\Delta_3$。\n$$ S_C = S_0 - (\\Delta_1 + \\Delta_2 + \\Delta_3) = 820 - (140 + 70 + 40) = 820 - 250 = 570 $$\n- AIC计算：\n$$ \\mathrm{AIC}_C = 2p_C + n \\ln(S_C/n) = 2(5) + 90 \\ln(570/90) = 10 + 90 \\ln(6.333...) \\approx 10 + 90(1.8458) \\approx 176.12 $$\n\n**模型比较**\n计算出的AIC值如下：\n- $\\mathrm{AIC}_D \\approx 202.86$\n- $\\mathrm{AIC}_B \\approx 188.01$\n- $\\mathrm{AIC}_A \\approx 180.23$\n- $\\mathrm{AIC}_E \\approx 193.89$\n- $\\mathrm{AIC}_C \\approx 176.12$\n\n最佳模型是AIC值最低的模型。比较这些值：\n$$ 176.12 < 180.23 < 188.01 < 193.89 < 202.86 $$\n$$ \\mathrm{AIC}_C < \\mathrm{AIC}_A < \\mathrm{AIC}_B < \\mathrm{AIC}_E < \\mathrm{AIC}_D $$\n最小的AIC值对应于模型C。\n\n**逐项分析**\n- **A. 仅对 $C_1$ 和 $C_2$ 应用局部时钟 (...)：** 该模型得出的AIC约为 $180.23$。这不是最低值。**不正确。**\n- **B. 仅对 $C_1$ 应用局部时钟 (...)：** 该模型得出的AIC约为 $188.01$。这不是最低值。**不正确。**\n- **C. 对所有三个进化枝 $C_1$、$C_2$ 和 $C_3$ 应用局部时钟 (...)：** 该模型得出的AIC约为 $176.12$。这是所有候选模型中最低的AIC。**正确。**\n- **D. 不应用任何局部时钟；仅保留全局时钟：** 该模型得出的AIC约为 $202.86$。这是最高的值，表明在所有选项中拟合效果最差。**不正确。**\n- **E. 仅对 $C_2$ 和 $C_3$ 应用局部时钟 (...)：** 该模型得出的AIC约为 $193.89$。这不是最低值。**不正确。**\n\n分析表明，根据Akaike信息准则判断，包含所有三个进化枝的局部时钟的模型在拟合优度（最低的SSR）和模型复杂度（参数数量）之间提供了最佳的平衡。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "现代系统发育定年主要使用贝叶斯框架，该框架整合了序列数据与先验知识（例如化石校准点）。本练习是一项关于数据（似然）与先验假设之间关键相互作用的概念性探索。通过这个假设情景，您将分析一个错误设定的化石先验如何系统性地影响分化时间和速率的估计，从而突显在任何贝叶斯分析中仔细评估先验信息的重要性 。",
            "id": "4586180",
            "problem": "对两个姐妹群进行贝叶斯分子钟分析，分析在严格分子钟下进行，并对其最近共同祖先使用单一化石校准。设序列长度为$L=20{,}000$个位点，观测到的差异数为$K=2{,}400$。假设一个同质泊松替换过程，其中沿某一分支的预期替换数是每位点替换速率$r$与分支时长$t$的乘积，而两个谱系之间观测到的差异反映了沿两个分支累积的替换总和。分析者对每位点每百万年的替换速率$r$使用一个宽泛的先验，该先验建模为形状参数为$a$、速率参数为$b$的伽马分布；对节点年龄$t$使用一个化石校准先验，该先验建模为具有最小界限$t_{\\min}$的截断对数正态分布。\n\n最初，化石校准先验被错误地设定了一个过于严格的最小界限$t_{\\min}=10$百万年（Myr），其众数接近$12$ Myr。经过审查，该先验被修正为一个限制较少的最小界限$t_{\\min}=1$ Myr，众数接近$3$ Myr，同时保持对$r$的伽马先验不变，序列数据$K$和$L$也保持不变。假设严格分子钟在两个分支上具有相同的速率，并且给定$r$、$t$和$L$时$K$的似然来自上述指定的泊松模型。运用贝叶斯法则、分子钟在预期替换数方面的定义，以及单一校准节点下$(r,t)$的可识别性结构，推断当用修正后的校准先验替换错误指定的校准先验时，$(r,t)$的联合后验会如何移动。\n\n当用修正后的校准替换错误指定的校准时，以下哪项陈述最能描述$r$和$t$的后验分布的移动方向和结构性原因？\n\nA. 在年龄最小值过高的情况下，t的后验质量被推向更老的数值，而r的后验则相应地被推向更低的数值，以满足数据所隐含的关于r和t乘积的约束。将年龄最小值修正为限制较少的数值，会使后验沿着由观测差异决定的同一似然脊，向更年轻的t和更高的r移动。\n\nB. 高的年龄最小值先验迫使后验速率$r$升高以匹配观测到的差异，修正它会降低$r$，而$t$大致保持不变，因为似然主要取决于$r$。\n\nC. 在严格分子钟和单次校准下，$r$和$t$的后验是独立于校准先验可识别的；因此，修正年龄最小值不会改变$r$或$t$的后验均值。\n\nD. 修正一个过于严格的年龄最小值必然会同时增加$t$的后验均值和$r$的后验均值，因为两个参数都有了更多的可用先验质量。",
            "solution": "用户需要对问题陈述进行严格验证，然后对选项进行详细的推导和评估。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n-   **分析：** 贝叶斯分子钟。\n-   **分类单元：** 两个姐妹群。\n-   **时钟模型：** 严格分子钟。\n-   **校准：** 对最近共同祖先（MRCA）进行单次化石校准。\n-   **序列数据：** 长度 $L=20{,}000$ 个位点，观测到的差异数 $K=2{,}400$。\n-   **替换模型：** 同质泊松过程。一个分支上的预期替换数是 $r \\times t$，其中 $r$ 是每位点替换速率，$t$ 是分支时长。两个谱系之间观测到的差异反映了两个分支上替换的总和。\n-   **速率 $r$ 的先验：** 伽马分布，$P(r) = \\text{Gamma}(r | a, b)$。此先验不变。\n-   **初始年龄 $t$ 的先验：** 截断对数正态分布，最小界限 $t_{\\min}=10$ 百万年（Myr），众数接近 $12$ Myr。\n-   **修正后年龄 $t$ 的先验：** 截断对数正态分布，最小界限 $t_{\\min}=1$ Myr，众数接近 $3$ Myr。\n-   **不变量：** 对 $r$ 的伽马先验、序列数据 $K$ 和 $L$、严格分子钟模型以及泊松似然框架在两次分析中都保持不变。\n-   **问题：** 当用修正后的 $t$ 的先验替换初始先验时，描述 $(r, t)$ 联合后验分布的变化。\n\n**步骤2：使用提取的给定信息进行验证**\n-   **科学依据：** 问题陈述描述了贝叶斯系统发育定年中一种标准且成熟的方法。严格分子钟、泊松替换过程、速率的伽马先验以及节点年龄的对数正态先验都是 BEAST 或 MrBayes 等软件中的典型选择。该场景在科学上是合理且现实的。\n-   **适定性：** 该问题对于定性分析是适定的。它提供了贝叶斯模型的所有必要组成部分（似然和先验），并要求分析改变其中一个先验的定性效应。该问题具有清晰的逻辑基础，并且可以从贝叶斯统计原理推导出唯一的概念性答案。\n-   **客观性：** 问题使用来自统计学和生物信息学的精确、客观的术语进行陈述。它没有歧义和主观论断。\n-   **验证结论：** 问题没有缺陷。它在科学上是合理的、适定的、客观的，对于任务是完整的，并提出了一个非平凡的概念性问题。\n\n**步骤3：结论和行动**\n问题是**有效的**。现在将进行解答过程。\n\n### 解答推导\n\n这个问题的核心在于贝叶斯框架内似然函数与先验分布之间的相互作用，特别是在参数可识别性的背景下。\n\n**1. 似然函数和参数可识别性**\n两个谱系是姐妹群，从过去时间 $t$ 的一个共同祖先分化而来。在严格分子钟下，进化速率 $r$ 在两个谱系上是相同的。分隔这两个序列的总时间是 $t + t = 2t$。\n\n问题指出，替换数被建模为泊松过程。在总分化路径长度为 $2t$ 的情况下，每位点的预期替换数是进化距离 $d$。这个距离由 $d = r \\times (2t)$ 给出。\n\n序列数据包括在 $L=20{,}000$ 个位点上的 $K=2{,}400$ 个差异。不同位点的比例是 $p = K/L = 2{,}400 / 20{,}000 = 0.12$。这个观测比例 $p$ 是真实进化距离 $d$ 的一个估计，通常需要对同一位点的多次替换进行校正（例如，使用Jukes-Cantor校正，$d = -\\frac{3}{4}\\ln(1 - \\frac{4}{3}p)$）。无论具体的校正方法如何，观测到 $K$ 个差异的似然是预期距离 $d$ 的函数。\n$$P(K | r, t, L) = \\text{Likelihood}(d) = \\text{Likelihood}(2rt)$$\n这意味着似然函数 $L(r, t | K)$ 由乘积 $rt$ 决定。任何能产生相同乘积 $rt$ 的 $(r, t)$ 对都将具有相同的似然。在 $(r, t)$ 的参数空间中，似然函数沿着双曲线 $rt = C$ 形成一个高概率的“脊”，其中 $C = d_{\\text{ML}}/2$ 是由距离的最大似然估计决定的常数。仅凭数据无法区分高速率 $r$ 和短时间 $t$，或低速率 $r$ 和长时间 $t$。这是一个经典的不可识别性问题。\n\n**2. 先验在贝叶斯分析中的作用**\n贝叶斯法则指出，联合后验分布与似然和联合先验分布的乘积成正比：\n$$P(r, t | K, L) \\propto P(K | r, t, L) \\cdot P(r, t)$$\n假设 $r$ 和 $t$ 的先验是独立的，$P(r, t) = P(r) \\cdot P(t)$。\n$$P(r, t | K, L) \\propto \\underbrace{L(r, t | K)}_{\\text{似然}} \\cdot \\underbrace{P(r)}_{\\text{速率先验}} \\cdot \\underbrace{P(t)}_{\\text{年龄先验}}$$\n后验分布将在右侧所有三个组成部分都大的区域具有高密度。似然将后验质量限制在 $rt \\approx C$ 的脊上。然后，$r$ 和 $t$ 的先验决定了后验质量将集中在该脊的*哪个位置*。\n\n**3. 后验移动分析**\n让我们分析 $t$ 的先验 $P(t)$ 的两种情况。\n\n*   **情况1：错误指定、限制性强的先验。** 时间的先验是 $P_1(t)$，一个截断对数正态分布，其 $t_{\\min}=10$ Myr，众数接近 $12$ Myr。这个先验将显著的概率质量放在较大的 $t$ 值上（即 $t \\geq 10$ Myr），而在 $t < 10$ Myr 上的概率为零。为了获得高的后验概率，解必须位于似然脊（$rt \\approx C$）上，并且也处于高先验概率的区域。由于 $P_1(t)$ 迫使 $t$ 变大，似然脊上对应的 $r$ 值必须变小（因为 $r \\approx C/t$）。因此，联合后验分布将集中在一个大 $t$ 和小 $r$ 的区域。\n\n*   **情况2：修正后、限制性较弱的先验。** 先验被替换为 $P_2(t)$，一个截断对数正态分布，其 $t_{\\min}=1$ Myr，众数接近 $3$ Myr。这个先验现在将显著的概率质量放在小得多的 $t$ 值上。似然函数保持不变，因为数据 ($K, L$) 相同。$r$ 的先验 $P(r)$ 也保持不变。在计算新的后验时，模型将再次寻找似然和先验都大的区域。新的先验 $P_2(t)$ 偏好较小的 $t$ 值。为了保持在同一个似然脊上（$rt \\approx C$），较小的 $t$ 值需要较大的 $r$ 值。因此，联合后验分布的质量将移动到一个较小 $t$ 和较大 $r$ 的区域。\n\n**结论：** 将化石先验从偏好老年龄的修正为偏好年轻年龄的，导致后验分布沿着似然脊从一个（高 $t$，低 $r$）的区域移动到一个（低 $t$，高 $r$）的区域。\n\n### 逐项分析选项\n\n**A. 在年龄最小值过高的情况下，t的后验质量被推向更老的数值，而r的后验则相应地被推向更低的数值，以满足数据所隐含的关于r和t乘积的约束。将年龄最小值修正为限制较少的数值，会使后验沿着由观测差异决定的同一似然脊，向更年轻的t和更高的r移动。**\n这个陈述准确地描述了推导出的行为。初始的 $t$ 先验是限制性的，迫使 $t$ 变高，这反过来又迫使 $r$ 变低以匹配似然约束（$rt \\approx C$）。将先验修正为偏好更小的 $t$ 值，使得 $t$ 的后验能够移动到更年轻的年龄，这需要 $r$ 相应地移动到更高的速率以保持在似然脊上。\n**结论：正确**\n\n**B. 高的年龄最小值先验迫使后验速率 $r$ 升高以匹配观测到的差异，修正它会降低 $r$，而 $t$ 大致保持不变，因为似然主要取决于 $r$。**\n这个陈述在两点上是错误的。首先，高的年龄先验（$t$）迫使速率（$r$）*降低*，而不是升高，以维持乘积 $rt$。其次，似然并不主要取决于 $r$；它取决于乘积 $rt$。时间 $t$ 将会显著改变，因为它的先验已被大幅修改。\n**结论：错误**\n\n**C. 在严格分子钟和单次校准下，$r$ 和 $t$ 的后验是独立于校准先验可识别的；因此，修正年龄最小值不会改变 $r$ 或 $t$ 的后验均值。**\n这个陈述从根本上误解了在这种背景下的参数可识别性。在单次校准下，$r$ 和 $t$ *不能*仅从似然中识别出来。数据只能识别它们的乘积。节点年龄 $t$ 的校准先验对于打破这种不可识别性并获得 $r$ 和 $t$ 各自的、定义明确的后验分布是绝对必要的。改变这个关键的先验必然会改变最终的后验。\n**结论：错误**\n\n**D. 修正一个过于严格的年龄最小值必然会同时增加 $t$ 的后验均值和 $r$ 的后验均值，因为两个参数都有了更多的可用先验质量。**\n这个陈述是错误的。将先验从众数接近 $12$ Myr 的修正为众数接近 $3$ Myr 的，将会*降低* $t$ 的后验均值。此外，由于 $r$ 和 $t$ 在后验中是负相关的（由于似然约束 $rt \\approx C$），$t$ 均值的降低将导致 $r$ 均值的*增加*。它们不可能都增加。关于“更多可用先验质量”的推理也具有误导性；关键的变化是 $t$ 的先验质量的位置，而不是其总积分。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}