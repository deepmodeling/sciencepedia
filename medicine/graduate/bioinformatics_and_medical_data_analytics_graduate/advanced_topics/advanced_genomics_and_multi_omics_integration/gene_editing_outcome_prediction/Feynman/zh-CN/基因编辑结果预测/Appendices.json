{
    "hands_on_practices": [
        {
            "introduction": "预测基因编辑结果的第一步是理解其背后的修复机制。本练习旨在对比两种主要的DNA双链断裂修复途径：非同源末端连接（NHEJ）和微同源介导的末端连接（MMEJ）。通过为这两种途径计算预期的移码突变率，您将掌握序列背景和修复途径选择如何从根本上决定编辑结果 。",
            "id": "4566233",
            "problem": "在一个表现出与密码子结构一致的基序三核苷酸周期性的编码外显子内，引入了一个成簇规律间隔短回文重复序列 (CRISPR) 诱导的双链断裂 (DSB)。要求您根据局部序列背景和经验观察到的偏好，预测非同源末端连接 (NHEJ) 和微同源介导的末端连接 (MMEJ) 这两种修复途径的选择，将如何差异性地影响该位点上移码编辑与码内编辑的分布。仅使用编码序列翻译的基本原理和修复机制的标准定义。\n\n假设和观察到的背景：\n- 该外显子富含密码子周期性重复（例如，富含CAG/CAA的区域），因此在切口$\\,\\pm 15\\,$个碱基对 (bp) 范围内，基序扫描识别出微同源对，其距离 $d$ 的分布如下：$d=3$ 的概率为 $0.50$，$d=6$ 的概率为 $0.20$，$d=4$ 的概率为 $0.15$，$d=5$ 的概率为 $0.15$。在MMEJ修复途径下，缺失的大小等于配对微同源序列之间的距离 $d$，且微同源区段长度较短（例如，2 bp），这与局部序列组成一致。\n- 对于该位点的NHEJ修复，在匹配的序列背景下的深度分析显示，其偏向于小的模板化插入，插入缺失（indel）大小分布为：$+1$ bp 的概率为 $0.35$，$+2$ bp 的概率为 $0.15$，$-1$ bp 的概率为 $0.25$，$-2$ bp 的概率为 $0.15$，以及 $-3$ bp 的概率为 $0.10$。\n- 切口发生在密码子相位 $0$（密码子之间），当且仅当净插入缺失长度是 $3$ 的倍数时，编码阅读框得以保留。\n\n问题：基于这些原理和观察结果，对于该靶点，以下哪个陈述最能描述在NHEJ与MMEJ下，移码编辑与码内编辑的预期分布？\n\nA. NHEJ 将比 MMEJ 产生更高比例的码内编辑，因为小插入在各种大小上均匀分布，并且其总和通常是 $3$ 的倍数，而 MMEJ 的缺失与密码子周期性没有关系。\n\nB. 由于 $+1$ bp 和 $+2$ bp 的模板化插入以及 $-1$ bp 和 $-2$ bp 的缺失占主导地位，NHEJ 将富集移码编辑；而 MMEJ 将产生更多的码内缺失，因为在密码子周期性外显子中，微同源距离通常是 $3$ 的倍数；因此，在该位点，MMEJ 下的码内编辑比例将超过 NHEJ。\n\nC. NHEJ 和 MMEJ 下的码内与移码编辑的比例将相似，因为阅读框与插入缺失大小的分布以及微同源间距无关。\n\nD. MMEJ 将主要产生 $+1$ bp 和 $+2$ bp 的插入，使得移码编辑在 MMEJ 下占主导地位；而 NHEJ 将富集 $-3$ bp 的缺失，导致 NHEJ 下的码内编辑比例高于 MMEJ。",
            "solution": "用户希望我解决一个关于CRISPR基因编辑的问题。\n\n**1. 问题验证**\n\n首先，我将根据用户的指示验证问题陈述。\n\n**1.1. 已知条件提取**\n问题提供了以下信息：\n- 在一个编码外显子中引入了一个成簇规律间隔短回文重复序列 (CRISPR) 诱导的双链断裂 (DSB)。\n- 该外显子具有三核苷酸周期性。\n- 需要考虑的两种修复途径是非同源末端连接 (NHEJ) 和微同源介导的末端连接 (MMEJ)。\n- **MMEJ 背景**：\n    - 在切口$\\pm 15$个碱基对 (bp) 范围内识别出微同源对。\n    - 微同源对之间的距离 $d$ 具有以下概率分布：\n        - $P(d=3) = 0.50$\n        - $P(d=6) = 0.20$\n        - $P(d=4) = 0.15$\n        - $P(d=5) = 0.15$\n    - 对于 MMEJ，产生的缺失大小等于距离 $d$。\n- **NHEJ 背景**：\n    - 存在对小模板化插入的偏好。\n    - 插入缺失大小分布如下：\n        - $+1$ bp 插入，概率为 $0.35$。\n        - $+2$ bp 插入，概率为 $0.15$。\n        - $-1$ bp 缺失，概率为 $0.25$。\n        - $-2$ bp 缺失，概率为 $0.15$。\n        - $-3$ bp 缺失，概率为 $0.10$。\n- **移码规则**：\n    - DSB 发生在密码子相位 0（密码子之间）。\n    - 当且仅当净插入缺失长度是 $3$ 的倍数时，编辑是码内的。\n\n**1.2. 根据标准进行验证**\n- **科学依据**：该问题在分子生物学和基因编辑领域有充分的科学依据。CRISPR、DSB、NHEJ、MMEJ、编码外显子、阅读框、移码突变、密码子周期性以及微同源对修复结果的影响等概念都是该领域的既定原则。\n- **定义明确**：该问题定义明确。它为两种修复途径的结果提供了完整的概率分布（对于 MMEJ，$0.50 + 0.20 + 0.15 + 0.15 = 1.00$；对于 NHEJ，$0.35 + 0.15 + 0.25 + 0.15 + 0.10 = 1.00$）。它还提供了一个清晰且数学上精确的规则来确定结果是码内编辑还是移码。这允许对两种途径进行唯一的、定量的比较。\n- **客观性**：问题以客观、科学的语言陈述。数据是定量的，问题要求基于这些数据和基本原则得出结论。没有主观或含糊的语言。\n- **其他缺陷**：问题陈述没有表现出任何列出的缺陷（例如，不完整、矛盾、不可行等）。该前提是基因组学研究中的常见情景，并且数据虽然为问题目的而简化，但是合理的。\n\n**1.3. 结论**\n问题陈述有效。我将继续进行解答。\n\n**2. 解题推导**\n\n核心任务是计算每种修复途径（NHEJ 和 MMEJ）产生码内编辑的概率，然后比较这些概率。根据问题陈述，如果插入缺失长度是 $3$ 的非零倍数，则编辑是码内的。长度为 $0$ 的插入缺失也是码内的，但它不在这两种途径的可能结果中。\n\n**2.1. MMEJ分析**\nMMEJ 途径导致的缺失，其大小由微同源对之间的距离 $d$ 给出。可能的缺失大小为 $-d$，其中 $d \\in \\{3, 4, 5, 6\\}$。如果其大小是 $3$ 的倍数，则结果是码内的。\n码内缺失大小是那些 $d$ 是 $3$ 的倍数的情况。根据给定的分布，这些是 $d=3$ 和 $d=6$。\n在 MMEJ 下发生码内编辑的概率，表示为 $P(\\text{in-frame} | \\text{MMEJ})$，是导致码内缺失事件的概率之和：\n$$P(\\text{in-frame} | \\text{MMEJ}) = P(d=3) + P(d=6)$$\n代入给定的概率：\n$$P(\\text{in-frame} | \\text{MMEJ}) = 0.50 + 0.20 = 0.70$$\n因此，MMEJ介导的修复有 $70\\%$ 的概率导致码内缺失。发生移码的概率是 $1 - 0.70 = 0.30$。\n\n**2.2. NHEJ分析**\nNHEJ 途径导致一系列小插入和缺失（indels）。可能的插入缺失大小为 $\\{+1, +2, -1, -2, -3\\}$ bp。如果其大小是 $3$ 的倍数，则结果是码内的。\n从给定的结果列表中，只有插入缺失大小为 $-3$ bp 是 $3$ 的倍数。\n在 NHEJ 下发生码内编辑的概率，表示为 $P(\\text{in-frame} | \\text{NHEJ})$，是导致插入缺失大小为 $3$ 的倍数的事件的概率：\n$$P(\\text{in-frame} | \\text{NHEJ}) = P(\\text{indel size} = -3)$$\n代入给定的概率：\n$$P(\\text{in-frame} | \\text{NHEJ}) = 0.10$$\n因此，NHEJ介导的修复有 $10\\%$ 的概率导致码内编辑。发生移码的概率是所有其他结果的概率之和：$P(+1) + P(+2) + P(-1) + P(-2) = 0.35 + 0.15 + 0.25 + 0.15 = 0.90$。这与 $1 - 0.10 = 0.90$ 一致。\n\n**2.3. 比较**\n比较两种途径的码内编辑概率：\n- $P(\\text{in-frame} | \\text{MMEJ}) = 0.70$\n- $P(\\text{in-frame} | \\text{NHEJ}) = 0.10$\n\n显然，$0.70 > 0.10$。因此，在这个特定位点，与 NHEJ 相比，MMEJ 预期会产生更高比例的码内编辑。NHEJ 强烈偏向于移码突变（$90\\%$ 的结果），而 MMEJ 则偏向于码内编辑（$70\\%$ 的结果）。\n\n**3. 逐项分析**\n\n**A. NHEJ 将比 MMEJ 产生更高比例的码内编辑，因为小插入在各种大小上均匀分布，并且其总和通常是 $3$ 的倍数，而 MMEJ 的缺失与密码子周期性没有关系。**\n- NHEJ 产生更高比例码内编辑的说法是错误的（$0.10  0.70$）。\n- 小插入“均匀分布”的理由是错误的；给出的概率是 $+1$ bp 为 $0.35$ 和 $+2$ bp 为 $0.15$。\n- MMEJ 缺失与“密码子周期性没有关系”的说法与问题陈述相矛盾。外显子的三核苷酸周期性正是微同源距离 $d=3$ 和 $d=6$ 最常见的原因，从而导致了高比例的码内缺失。\n**结论：不正确。**\n\n**B. 由于 $+1$ bp 和 $+2$ bp 的模板化插入以及 $-1$ bp 和 $-2$ bp 的缺失占主导地位，NHEJ 将富集移码编辑；而 MMEJ 将产生更多的码内缺失，因为在密码子周期性外显子中，微同源距离通常是 $3$ 的倍数；因此，在该位点，MMEJ 下的码内编辑比例将超过 NHEJ。**\n- “NHEJ 将富集移码编辑”的说法是正确的。在 NHEJ 下发生移码的概率是 $0.90$。\n- 对 NHEJ 的推理是正确的：占主导地位的结果（$+1$, $+2$, $-1$, $-2$）都会导致移码，其总概率为 $0.90$。\n- “MMEJ 将产生更多的码内缺失”的说法是正确的。在 MMEJ 下发生码内缺失的概率是 $0.70$。\n- 对 MMEJ 的推理是正确的：微同源距离是 $3$ 的倍数（$d=3$ 和 $d=6$）的频率很高，这是由于外显子的密码子周期性特性。\n- “MMEJ 下的码内编辑比例将超过 NHEJ”的最终结论是正确的（$0.70  0.10$）。\n**结论：正确。**\n\n**C. NHEJ 和 MMEJ 下的码内与移码编辑的比例将相似，因为阅读框与插入缺失大小的分布以及微同源间距无关。**\n- “码内与移码编辑的比例将相似”的说法是错误的。对于 NHEJ，该比例为 $0.10 / 0.90 \\approx 0.11$。对于 MMEJ，该比例为 $0.70 / 0.30 \\approx 2.33$。两者差异巨大。\n- “阅读框与插入缺失大小的分布无关”的理由是根本错误的。阅读框的保留直接且完全取决于插入缺失大小是否为 $3$ 的倍数。\n**结论：不正确。**\n\n**D. MMEJ 将主要产生 $+1$ bp 和 $+2$ bp 的插入，使得移码编辑在 MMEJ 下占主导地位；而 NHEJ 将富集 $-3$ bp 的缺失，导致 NHEJ 下的码内编辑比例高于 MMEJ。**\n- MMEJ 产生插入的说法是错误的。问题陈述 MMEJ 导致缺失。\n- MMEJ 下移码占主导地位的说法是错误的（$P(\\text{frameshift} | \\text{MMEJ}) = 0.30$）。\n- NHEJ “富集 $-3$ bp 的缺失”的说法是错误的。该结果在 NHEJ 分布中概率最低（$0.10$）。\n- NHEJ 的码内编辑比例更高的结论是错误的（$0.10  0.70$）。这个选项错误地交换了两种途径的特征。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在理解了编辑结果是如何产生之后，一项至关重要的任务是评估预测模型的性能。本练习提供了一个包含已编辑等位基因及其模型预测的真实数据集，指导您构建一个混淆矩阵并计算精确率和召回率等关键指标。此练习强调了在基因组学数据分析中，基于测序读数（read count）进行加权评估的重要性 。",
            "id": "4566111",
            "problem": "一个实验室使用成簇的规律间隔的短回文重复序列 (CRISPR) 和 CRISPR 相关蛋白 9 (Cas9) 来编辑一个编码基因。扩增子测序揭示了一组不同的编辑等位基因，每个等位基因都由一个缺失长度 $d$、一个插入长度 $i$ 和一个读数计数 $r$ 来表征。如果净插入缺失长度改变了读码框，则基因编辑结果被分类为移码；根据分子生物学中心法则的标准密码子模型（密码子长度为 $3$ 个核苷酸），当且仅当 $|d - i| \\not\\equiv 0 \\ (\\mathrm{mod}\\ 3)$ 时，这表示为移码，否则为码内。一个二元分类器对于每个等位基因输出一个校准概率 $p$，表示该等位基因为移码的概率。该实验室采用一个决策阈值 $t = 0.65$，如果 $p \\geq t$，则预测标签为移码，否则预测标签为码内。在下游分析中，性能在读数级别进行评估：每个等位基因将其读数计数贡献给混淆矩阵的相应单元格。\n\n给定 $12$ 个等位基因及其属性：\n- 等位基因 $A_1$：$d = 1$，$i = 0$，$r = 120$，$p = 0.92$。\n- 等位基因 $A_2$：$d = 3$，$i = 0$，$r = 80$，$p = 0.78$。\n- 等位基因 $A_3$：$d = 2$，$i = 0$，$r = 60$，$p = 0.61$。\n- 等位基因 $A_4$：$d = 4$，$i = 1$，$r = 150$，$p = 0.40$。\n- 等位基因 $A_5$：$d = 5$，$i = 2$，$r = 90$，$p = 0.67$。\n- 等位基因 $A_6$：$d = 0$，$i = 2$，$r = 70$，$p = 0.55$。\n- 等位基因 $A_7$：$d = 6$，$i = 0$，$r = 110$，$p = 0.28$。\n- 等位基因 $A_8$：$d = 7$，$i = 1$，$r = 50$，$p = 0.72$。\n- 等位基因 $A_9$：$d = 2$，$i = 1$，$r = 95$，$p = 0.83$。\n- 等位基因 $A_{10}$：$d = 0$，$i = 3$，$r = 130$，$p = 0.62$。\n- 等位基因 $A_{11}$：$d = 8$，$i = 2$，$r = 140$，$p = 0.66$。\n- 等位基因 $A_{12}$：$d = 1$，$i = 1$，$r = 75$，$p = 0.35$。\n\n使用规则 $|d - i| \\not\\equiv 0 \\ (\\mathrm{mod}\\ 3)$ 确定真实（ground-truth）的移码与码内，并使用阈值 $t = 0.65$ 确定预测的移码与码内，计算按读数加权的混淆矩阵条目：真阳性 $\\mathrm{TP}$、假阳性 $\\mathrm{FP}$、真阴性 $\\mathrm{TN}$ 和假阴性 $\\mathrm{FN}$，其中阳性类别为移码。然后，从基本定义出发，推导阳性类别的精确率、召回率和 F1-分数。\n\n将混淆矩阵条目表示为整数（读数计数），并将精确率、召回率和 F1-分数表示为最简分数。不要四舍五入。按 $\\mathrm{TP}$、$\\mathrm{FP}$、$\\mathrm{TN}$、$\\mathrm{FN}$、精确率、召回率、F1-分数的顺序报告您的最终结果。",
            "solution": "该问题要求在基因编辑背景下，为一个移码分类器计算按读数加权的混淆矩阵以及衍生的性能指标（精确率、召回率、F1-分数）。分析分三个阶段进行：首先，为每个等位基因确定其真实类别和预测类别；其次，将读数计数聚合到混淆矩阵中；第三，根据矩阵条目计算性能指标。\n\n阳性类别定义为“移码”，阴性类别定义为“码内”。\n\nA. 确定真实类别和预测类别\n\n一个等位基因的真实分类基于其净插入缺失长度，即缺失长度 $d$ 和插入长度 $i$ 之间的绝对差。根据问题描述，如果这个净长度不是 $3$ 的倍数，则该等位基因导致移码。\n- 真实阳性（移码）：$|d - i| \\not\\equiv 0 \\pmod 3$。\n- 真实阴性（码内）：$|d - i| \\equiv 0 \\pmod 3$。\n\n预测分类是通过将分类器的输出概率 $p$ 与给定的阈值 $t = 0.65$ 进行比较来确定的。\n- 预测阳性（移码）：$p \\ge 0.65$。\n- 预测阴性（码内）：$p  0.65$。\n\n我们现在将处理这 $12$ 个等位基因中的每一个，以对其进行分类并确定其对混淆矩阵的贡献，其中 TP、FP、TN 和 FN 分别代表真阳性、假阳性、真阴性和假阴性。\n\n1.  等位基因 $A_1$：$d = 1$，$i = 0$，$r = 120$，$p = 0.92$。\n    - 真实情况：$|1 - 0| = 1$，且 $1 \\not\\equiv 0 \\pmod 3$。实际：阳性。\n    - 预测：$p = 0.92 \\ge 0.65$。预测：阳性。\n    - 结果：真阳性 (TP)。贡献：$120$ 个读数。\n\n2.  等位基因 $A_2$：$d = 3$，$i = 0$，$r = 80$，$p = 0.78$。\n    - 真实情况：$|3 - 0| = 3$，且 $3 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.78 \\ge 0.65$。预测：阳性。\n    - 结果：假阳性 (FP)。贡献：$80$ 个读数。\n\n3.  等位基因 $A_3$：$d = 2$，$i = 0$，$r = 60$，$p = 0.61$。\n    - 真实情况：$|2 - 0| = 2$，且 $2 \\not\\equiv 0 \\pmod 3$。实际：阳性。\n    - 预测：$p = 0.61  0.65$。预测：阴性。\n    - 结果：假阴性 (FN)。贡献：$60$ 个读数。\n\n4.  等位基因 $A_4$：$d = 4$，$i = 1$，$r = 150$，$p = 0.40$。\n    - 真实情况：$|4 - 1| = 3$，且 $3 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.40  0.65$。预测：阴性。\n    - 结果：真阴性 (TN)。贡献：$150$ 个读数。\n\n5.  等位基因 $A_5$：$d = 5$，$i = 2$，$r = 90$，$p = 0.67$。\n    - 真实情况：$|5 - 2| = 3$，且 $3 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.67 \\ge 0.65$。预测：阳性。\n    - 结果：假阳性 (FP)。贡献：$90$ 个读数。\n\n6.  等位基因 $A_6$：$d = 0$，$i = 2$，$r = 70$，$p = 0.55$。\n    - 真实情况：$|0 - 2| = 2$，且 $2 \\not\\equiv 0 \\pmod 3$。实际：阳性。\n    - 预测：$p = 0.55  0.65$。预测：阴性。\n    - 结果：假阴性 (FN)。贡献：$70$ 个读数。\n\n7.  等位基因 $A_7$：$d = 6$，$i = 0$，$r = 110$，$p = 0.28$。\n    - 真实情况：$|6 - 0| = 6$，且 $6 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.28  0.65$。预测：阴性。\n    - 结果：真阴性 (TN)。贡献：$110$ 个读数。\n\n8.  等位基因 $A_8$：$d = 7$，$i = 1$，$r = 50$，$p = 0.72$。\n    - 真实情况：$|7 - 1| = 6$，且 $6 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.72 \\ge 0.65$。预测：阳性。\n    - 结果：假阳性 (FP)。贡献：$50$ 个读数。\n\n9.  等位基因 $A_9$：$d = 2$，$i = 1$，$r = 95$，$p = 0.83$。\n    - 真实情况：$|2 - 1| = 1$，且 $1 \\not\\equiv 0 \\pmod 3$。实际：阳性。\n    - 预测：$p = 0.83 \\ge 0.65$。预测：阳性。\n    - 结果：真阳性 (TP)。贡献：$95$ 个读数。\n\n10. 等位基因 $A_{10}$：$d = 0$，$i = 3$，$r = 130$，$p = 0.62$。\n    - 真实情况：$|0 - 3| = 3$，且 $3 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.62  0.65$。预测：阴性。\n    - 结果：真阴性 (TN)。贡献：$130$ 个读数。\n\n11. 等位基因 $A_{11}$：$d = 8$，$i = 2$，$r = 140$，$p = 0.66$。\n    - 真实情况：$|8 - 2| = 6$，且 $6 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.66 \\ge 0.65$。预测：阳性。\n    - 结果：假阳性 (FP)。贡献：$140$ 个读数。\n\n12. 等位基因 $A_{12}$：$d = 1$，$i = 1$，$r = 75$，$p = 0.35$。\n    - 真实情况：$|1 - 1| = 0$，且 $0 \\equiv 0 \\pmod 3$。实际：阴性。\n    - 预测：$p = 0.35  0.65$。预测：阴性。\n    - 结果：真阴性 (TN)。贡献：$75$ 个读数。\n\nB. 将读数计数聚合到混淆矩阵中\n\n我们对每个类别的读数计数进行求和：\n- $\\mathrm{TP} = (A_1 \\text{的读数}) + (A_9 \\text{的读数}) = 120 + 95 = 215$。\n- $\\mathrm{FP} = (A_2 \\text{的读数}) + (A_5 \\text{的读数}) + (A_8 \\text{的读数}) + (A_{11} \\text{的读数}) = 80 + 90 + 50 + 140 = 360$。\n- $\\mathrm{TN} = (A_4 \\text{的读数}) + (A_7 \\text{的读数}) + (A_{10} \\text{的读数}) + (A_{12} \\text{的读数}) = 150 + 110 + 130 + 75 = 465$。\n- $\\mathrm{FN} = (A_3 \\text{的读数}) + (A_6 \\text{的读数}) = 60 + 70 = 130$。\n\n混淆矩阵的条目是：$\\mathrm{TP} = 215$，$\\mathrm{FP} = 360$，$\\mathrm{TN} = 465$，$\\mathrm{FN} = 130$。\n\nC. 性能指标的计算\n\n这些指标定义如下：\n- 精确率（阳性预测值）：$\\mathrm{Precision} = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FP}}$\n- 召回率（灵敏度）：$\\mathrm{Recall} = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}$\n- F1-分数：$\\mathrm{F1} = 2 \\times \\frac{\\mathrm{Precision} \\times \\mathrm{Recall}}{\\mathrm{Precision} + \\mathrm{Recall}} = \\frac{2\\mathrm{TP}}{2\\mathrm{TP} + \\mathrm{FP} + \\mathrm{FN}}$\n\n代入聚合的读数计数：\n\n- 精确率：\n$$ \\mathrm{Precision} = \\frac{215}{215 + 360} = \\frac{215}{575} $$\n为了化简这个分数，我们找到分子和分母的最大公约数。两者都可以被 $5$ 整除。\n$$ \\frac{215 \\div 5}{575 \\div 5} = \\frac{43}{115} $$\n由于 $43$ 是一个质数且 $115 = 5 \\times 23$，该分数已是最简分数。\n\n- 召回率：\n$$ \\mathrm{Recall} = \\frac{215}{215 + 130} = \\frac{215}{345} $$\n两者都可以被 $5$ 整除。\n$$ \\frac{215 \\div 5}{345 \\div 5} = \\frac{43}{69} $$\n由于 $43$ 是一个质数且 $69 = 3 \\times 23$，该分数已是最简分数。\n\n- F1-分数：\n为了计算的稳定性和简便性，使用直接公式：\n$$ \\mathrm{F1} = \\frac{2 \\times \\mathrm{TP}}{2 \\times \\mathrm{TP} + \\mathrm{FP} + \\mathrm{FN}} = \\frac{2 \\times 215}{2 \\times 215 + 360 + 130} = \\frac{430}{430 + 490} = \\frac{430}{920} $$\n这个分数可以通过除以 $10$ 来化简。\n$$ \\frac{43}{92} $$\n由于 $43$ 是一个质数且 $92 = 2^2 \\times 23$，该分数已是最简分数。\n\n最终结果是：\n- $\\mathrm{TP} = 215$\n- $\\mathrm{FP} = 360$\n- $\\mathrm{TN} = 465$\n- $\\mathrm{FN} = 130$\n- $\\mathrm{Precision} = \\frac{43}{115}$\n- $\\mathrm{Recall} = \\frac{43}{69}$\n- $\\mathrm{F1-score} = \\frac{43}{92}$",
            "answer": "$$ \\boxed{\\begin{pmatrix} 215  360  465  130  \\frac{43}{115}  \\frac{43}{69}  \\frac{43}{92} \\end{pmatrix}} $$"
        },
        {
            "introduction": "生物信息学研究的最终目标之一是构建能够准确预测生物学现象的模型。这项高级练习要求您将MMEJ修复的生物学原理转化为一个形式化的数学模型。通过实现一个包含评分函数和softmax归一化的模型，您将深入了解现代生物信息学工具如何将生物学直觉形式化和定量化，以预测不同删除事件发生的概率 。",
            "id": "4566246",
            "problem": "您的任务是形式化并实现一个有原则的概率模型，用于预测脱氧核糖核酸（DNA）中基因编辑双链断裂后的缺失结果，该模型基于微同源介导的末端连接（MMEJ）机制。该设计必须从广泛接受的生物学观察出发：靠近切割位点的较长局部微同源序列会增加缺失形成的可能性，而离切割位点更远的微同源序列对修复决策的贡献较小。接受缺失结果可被视为相互竞争的备选方案，其概率应被归一化以使总和为 $1$，这与约束条件下的最大熵观点一致。\n\n定义一个评分函数 $S_{\\text{MH}}$，对于 $K$ 个备选方案中的每个候选缺失 $k$，该函数根据候选者的微同源长度 $L_k$（以核苷酸为单位，缩写为 nt）及其与切割位点的距离 $D_k$（以 nt 为单位）赋予一个标量分数。该分数必须由一个按长度索引的权重函数构建，该函数会对与切割位点距离的增加施加惩罚。权重函数在距离参数上必须是单调递减的，并且必须由一个按微同源长度索引的非负基础振幅向量进行参数化。从分数到概率的映射必须对 $K$ 个候选者使用归一化指数函数（即 softmax），并带有一个明确的温度参数来控制锐度。距离以核苷酸为单位测量，概率必须以小数（而非百分比）形式报告。\n\n实现必须遵守以下规范：\n\n- 模型要素：\n  - 一个基础振幅向量 $\\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\dots, \\alpha_J)$，其中对于 $j \\in \\{1, \\dots, J\\}$ 有 $\\alpha_j \\ge 0$，该向量编码了长度为 $j$ nt 的微同源的内在贡献。\n  - 一个距离惩罚率 $\\gamma \\ge 0$，确保权重随 $D_k$ 的增加而减小。\n  - 一个温度参数 $\\tau  0$，用于控制从分数到概率的归一化指数映射的平滑度。\n  - 对于每个候选缺失 $k$，有一个微同源长度 $L_k \\in \\{0,1,\\dots,J\\}$（以 nt 为单位），其中 $L_k = 0$ 表示无微同源，以及一个距离 $D_k \\ge 0$（以 nt 为单位）。\n- 评分规则约束：\n  - 分数 $S_{\\text{MH}}(k)$ 必须是一个函数，它选择适当的按长度索引的权重，并对 $D_k$ 应用单调递减的惩罚。\n  - 如果 $L_k = 0$（无微同源），分数必须默认为 $0$。\n- 概率映射：\n  - 概率向量 $\\mathbf{p} = (p_1, \\dots, p_K)$ 必须通过对候选分数进行由 $\\tau$ 控制的归一化指数运算来计算，并且必须满足 $\\sum_{k=1}^K p_k = 1$。\n- 数值要求：\n  - 距离 $D_k$ 以核苷酸（nt）为单位。\n  - 微同源长度 $L_k$ 以核苷酸（nt）为单位。\n  - 以小数值报告概率。\n  - 对归一化指数使用数值稳定的计算方法。\n\n您的程序必须实现此模型并为以下测试套件生成输出。对于每个测试用例，输入为 $(\\boldsymbol{\\alpha}, \\gamma, \\tau, \\mathbf{L}, \\mathbf{D})$，要求的输出是概率向量 $\\mathbf{p}$。\n\n测试套件（单位：所有 $D_k$ 和 $L_k$ 均以 nt 为单位；概率为小数）：\n\n- 案例 $1$（一般情况）：$J = 5$，$\\boldsymbol{\\alpha} = (0.2, 0.5, 0.9, 1.4, 2.0)$，$\\gamma = 0.1$，$\\tau = 1.0$，$\\mathbf{L} = (1, 2, 4, 5)$，$\\mathbf{D} = (0, 3, 5, 1)$。\n- 案例 $2$（分数相同时的均匀性检查）：$J = 3$，$\\boldsymbol{\\alpha} = (1.0, 1.0, 1.0)$，$\\gamma = 0.0$，$\\tau = 1.0$，$\\mathbf{L} = (2, 2, 2)$，$\\mathbf{D} = (5, 5, 5)$。\n- 案例 $3$（无微同源边界情况）：$J = 4$，$\\boldsymbol{\\alpha} = (0.3, 0.7, 1.2, 1.6)$，$\\gamma = 0.05$，$\\tau = 1.0$，$\\mathbf{L} = (0, 1, 3)$，$\\mathbf{D} = (2, 2, 2)$。\n- 案例 $4$（大距离与中等惩罚）：$J = 4$，$\\boldsymbol{\\alpha} = (0.5, 1.0, 1.5, 2.0)$，$\\gamma = 0.1$, $\\tau = 1.0$，$\\mathbf{L} = (1, 4, 3)$，$\\mathbf{D} = (20, 20, 20)$。\n- 案例 $5$（温度敏感性，锐分布）：$J = 5$，$\\boldsymbol{\\alpha} = (0.2, 0.5, 0.9, 1.4, 2.0)$，$\\gamma = 0.1$，$\\tau = 0.1$，$\\mathbf{L} = (1, 2, 4, 5)$，$\\mathbf{D} = (0, 3, 5, 1)$。\n- 案例 $6$（温度敏感性，平坦分布）：$J = 5$，$\\boldsymbol{\\alpha} = (0.2, 0.5, 0.9, 1.4, 2.0)$，$\\gamma = 0.1$，$\\tau = 5.0$，$\\mathbf{L} = (1, 2, 4, 5)$，$\\mathbf{D} = (0, 3, 5, 1)$。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含所有 6 个案例的结果，格式为一个用方括号括起来的逗号分隔列表，其中每个案例的概率向量本身是一个四舍五入到 6 位小数的小数值列表（例如 `[[0.1,0.2],[0.3,0.7]]`）。不允许有任何额外文本。",
            "solution": "问题陈述已经过验证，并被确定为一个有效、适定的科学建模任务。它在科学上基于分子生物学的既定原则，特别是微同源介导的末端连接（MMEJ）DNA修复途径。所需的模型被规定了充分且一致的约束，使其可以形式化和客观化。其中没有矛盾、歧义或事实不准确之处。\n\n任务是形式化并实现一个概率模型，用以预测 DNA 双链断裂位点的缺失结果。该模型的设计以关键的生物学观察为指导，并在一个标准的统计框架内构建。\n\n**1. 模型形式化**\n\n模型构建分为两个主要阶段：首先，一个量化每种潜在缺失结果倾向性的评分函数；其次，一个将这些分数转换为归一化概率分布的概率映射。\n\n**1.1. 评分函数，$S_{\\text{MH}}(k)$**\n\n问题要求为每个候选缺失 $k$ 设计一个评分函数 $S_{\\text{MH}}(k)$，该函数结合了微同源长度 $L_k$ 及其与切割位点的距离 $D_k$。分数必须基于一个被距离惩罚的、按长度索引的权重函数。\n\n对这些约束的一个标准且直接的解释导向一个乘法形式。基础倾向性由向量 $\\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\dots, \\alpha_J)$ 中的振幅 $\\alpha_{L_k}$ 给出。问题规定 $\\boldsymbol{\\alpha}$ 是一个非负常数向量，其索引对应于以核苷酸为单位的微同源长度。因此，对于一个由长度为 $L_k \\in \\{1, \\dots, J\\}$ 的微同源介导的缺失，其基础分数为 $\\alpha_{L_k}$。\n\n距离惩罚必须是距离 $D_k$ 的单调递减函数，由一个速率参数 $\\gamma \\ge 0$ 调节。这种惩罚的典型函数形式是指数衰减，$e^{-\\gamma D_k}$。\n\n结合这些元素，对于微同源长度 $L_k  0$ 的候选缺失 $k$，其分数为：\n$$\nS_{\\text{MH}}(k) = \\alpha_{L_k} \\cdot \\exp(-\\gamma D_k)\n$$\n问题指出，如果没有微同源，即 $L_k = 0$，则分数默认为 $0$。这反映了 MMEJ 途径对微同源的依赖。因此，完整的评分函数定义为：\n$$\nS_{\\text{MH}}(k) =\n\\begin{cases}\n    \\alpha_{L_k} \\cdot \\exp(-\\gamma D_k)  \\text{if } L_k  0 \\\\\n    0  \\text{if } L_k = 0\n\\end{cases}\n$$\n在实现中，对于给定的微同源长度 $L_k$，相应的振幅 $\\alpha_{L_k}$ 从输入向量 $\\boldsymbol{\\alpha}$ 中获取。如果 $\\boldsymbol{\\alpha}$ 由一个 0-索引的数组表示，则 $\\alpha_{L_k}$ 对应于索引为 $L_k - 1$ 的元素。\n\n**1.2. 概率映射**\n\n问题规定，对于 $K$ 个候选缺失的分数 $\\{S_{\\text{MH}}(1), \\dots, S_{\\text{MH}}(K)\\}$，应使用归一化指数函数（通常称为 softmax 函数）将其转换为概率向量 $\\mathbf{p} = (p_1, \\dots, p_K)$。这一选择与最大熵原理一致，在给定分数所施加的约束条件下，提供了最无偏的分布。\n\n该映射包含一个温度参数 $\\tau  0$，它控制概率分布的锐度。低温（$\\tau \\to 0$）会将概率集中在得分最高的候选者上，而高温（$\\tau \\to \\infty$）则会导致近乎均匀的分布。候选者 $k$ 的概率 $p_k$ 由以下公式给出：\n$$\np_k = \\frac{\\exp(S_{\\text{MH}}(k) / \\tau)}{\\sum_{i=1}^{K} \\exp(S_{\\text{MH}}(i) / \\tau)}\n$$\n这确保了对于所有的 $k$ 都有 $p_k \\ge 0$ 并且 $\\sum_{k=1}^{K} p_k = 1$。\n\n**2. 算法设计与数值稳定性**\n\n直接计算 softmax 公式可能在数值上不稳定。如果分数 $S_{\\text{MH}}(k)$ 很大，$\\exp(S_{\\text{MH}}(k) / \\tau)$ 项可能会导致浮点溢出。为确保数值稳定性，采用了一种标准技术，该技术利用了对于任意常数 $c$ 都有 $\\text{softmax}(\\mathbf{x}) = \\text{softmax}(\\mathbf{x} + c)$ 的性质。通过选择 $c = -\\max(\\mathbf{x})$，我们可以防止溢出。\n\n设缩放后的分数向量为 $\\mathbf{z} = (S_{\\text{MH}}(1)/\\tau, \\dots, S_{\\text{MH}}(K)/\\tau)$。令 $z_{\\max} = \\max_{i} \\{z_i\\}$。则 $p_k$ 的稳定计算公式为：\n$$\np_k = \\frac{\\exp(z_k - z_{\\max})}{\\sum_{i=1}^{K} \\exp(z_i - z_{\\max})}\n$$\n现在指数中的最大项为 $0$，因此 $\\exp(z_k - z_{\\max}) \\le 1$，从而防止了溢出。当 $z_i$ 远小于 $z_{\\max}$ 时，项将正确地向下溢出为 $0$。\n\n**3. 实现策略**\n\n该模型使用 Python 实现，并利用 `numpy` 库进行高效的数值和基于数组的计算。\n对于每个以元组 $(\\boldsymbol{\\alpha}, \\gamma, \\tau, \\mathbf{L}, \\mathbf{D})$ 形式提供的测试用例：\n1. 通过遍历候选缺失来计算一个分数数组。对于每个具有属性 $(L_k, D_k)$ 的候选者 $k$，使用形式化的评分函数计算其分数 $S_{\\text{MH}}(k)$。\n2. 将得到的分数数组除以温度 $\\tau$。\n3. 将数值稳定的 softmax 函数应用于缩放后的分数，以计算最终的概率向量 $\\mathbf{p}$。\n4. 按照要求，将概率四舍五入到 6 位小数。\n5. 收集所有测试用例的最终结果，并根据严格的输出规范将其格式化为单个字符串。",
            "answer": "`[[0.109879,0.130289,0.210287,0.549545],[0.333333,0.333333,0.333333],[0.0,0.244728,0.755272],[0.147253,0.40024,0.452507],[0.0,0.000003,0.021074,0.978923],[0.203657,0.210515,0.231904,0.353924]]`"
        }
    ]
}