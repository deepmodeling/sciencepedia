{
    "hands_on_practices": [
        {
            "introduction": "在定量构效关系（QSAR）研究中，生物活性数据，如半数抑制浓度（$IC_{50}$），其原始标度往往不直接适用于线性回归。此练习将指导您完成从 $IC_{50}$ 到 $\\mathrm{p}IC_{50}$ 的转换，不仅阐明其化学惯例，更重要的是揭示该对数转换在稳定方差和线性化关系方面的关键统计学优势，为构建稳健模型奠定基础。",
            "id": "4602674",
            "problem": "在生物信息学和医学数据分析的定量构效关系（QSAR）建模中，抑制效力通常用摩尔单位的半数抑制浓度（记为 $IC_{50}$）和对数效力标度（记为 $\\mathrm{p}IC_{50}$）来概括。考虑一项检测报告了某个小分子抑制剂的 $IC_{50}$ 值为 $35\\,\\mathrm{nM}$。从以下基本依据出发：\n- 半数抑制浓度 $IC_{50}$ 是指与对照组相比，生物反应降低了 $50\\%$ 时的浓度（单位为 $\\mathrm{M}$）。\n- 常用对数根据规则 $\\log_{10}(ab)=\\log_{10}(a)+\\log_{10}(b)$ 将浓度的乘法尺度压缩为加法尺度。\n- 化学中用于摩尔浓度的 $p$-标度（例如 $\\mathrm{pH}$）是通过以10为底的对数构建的，用于将数量级以线性化形式编码。\n\nA部分。根据 $IC_{50}$（以 $\\mathrm{M}$ 表示）推导一个量纲一致且仅使用所述基本依据的 $\\mathrm{p}IC_{50}$ 的显式解析表达式。\n\nB部分。使用您推导的表达式，为给定的 $IC_{50}$ 值 $35\\,\\mathrm{nM}$ 计算 $\\mathrm{p}IC_{50}$。将最终数值答案四舍五入到四位有效数字。答案以无单位的纯数表示。\n\nC部分。在一个回归情景中，如果 $IC_{50}$ 的响应变异性可以很好地由一个乘性（对数正态）误差模型描述，请从对数正态定义和常用对数的性质出发，提供一个简明的数学论证，解释将 $IC_{50}$ 转换为 $\\mathrm{p}IC_{50}$ 如何通过稳定响应尺度和方差来改善模型训练期间的数值条件。您的解释应涉及对误差分布和响应尺度的影响，但不应依赖于任何特定的算法实现细节或软件设置。\n\n答案只需要一个最终数值：即B部分中按要求四舍五入的值。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，问题提出得当，客观，并包含足够的信息以得出完整解答。\n\n此问题分为三个部分。我们将系统地解决每个部分。\n\nA部分。推导 $\\mathrm{p}IC_{50}$ 的显式解析表达式。\n\n问题要求从基本依据出发推导 $\\mathrm{p}IC_{50}$ 的表达式。关键前提是，摩尔浓度的 $p$-标度是类似于化学中其他 $p$-标度（如 $\\mathrm{pH}$）构建的。\n$\\mathrm{pH}$ 的定义是基于氢离子活度的负常用对数。对于稀溶液，这可以近似为摩尔浓度。\n对数只能对无量纲的量进行运算。因此，任何浓度都必须通过一个标准态浓度进行归一化，按照惯例，该标准态浓度为 $c^\\circ = 1\\,\\mathrm{M}$（摩尔每升）。\n让抑制剂的浓度值用其符号 $IC_{50}$ 表示。对数运算所需的无量纲量是比率 $\\frac{IC_{50}}{c^\\circ}$。遵循 $\\mathrm{pH}$ 的构造方法，$\\mathrm{p}IC_{50}$ 被定义为该无量纲量的负常用对数：\n$$ \\mathrm{p}IC_{50} = -\\log_{10}\\left(\\frac{IC_{50}}{c^\\circ}\\right) $$\n鉴于 $c^\\circ = 1\\,\\mathrm{M}$，该表达式变为：\n$$ \\mathrm{p}IC_{50} = -\\log_{10}\\left(\\frac{IC_{50}}{1\\,\\mathrm{M}}\\right) $$\n问题要求一个以 $\\mathrm{M}$ 为单位的 $IC_{50}$ 来表示的表达式。如果我们让变量 $IC_{50, \\text{in M}}$ 代表以摩尔每升为单位的浓度数值，那么除以 $1\\,\\mathrm{M}$ 的操作就被隐式处理了，表达式简化为：\n$$ \\mathrm{p}IC_{50} = -\\log_{10}(IC_{50, \\text{in M}}) $$\n这是药物化学和药理学中使用的标准定义。\n\nB部分。为给定的 $IC_{50}$ 值计算 $\\mathrm{p}IC_{50}$。\n\n给定值为 $IC_{50} = 35\\,\\mathrm{nM}$。要使用推导出的公式，必须首先将该值转换为摩尔单位（$\\mathrm{M}$）。前缀“纳”（n）对应于因子 $10^{-9}$。\n$$ IC_{50} = 35\\,\\mathrm{nM} = 35 \\times 10^{-9}\\,\\mathrm{M} $$\n现在，我们将以 $\\mathrm{M}$ 为单位的浓度数值代入 A 部分推导的表达式中：\n$$ \\mathrm{p}IC_{50} = -\\log_{10}(35 \\times 10^{-9}) $$\n使用对数性质 $\\log_{10}(ab) = \\log_{10}(a) + \\log_{10}(b):$\n$$ \\mathrm{p}IC_{50} = -(\\log_{10}(35) + \\log_{10}(10^{-9})) $$\n因为 $\\log_{10}(10^{-9}) = -9$，表达式变为：\n$$ \\mathrm{p}IC_{50} = -(\\log_{10}(35) - 9) $$\n$$ \\mathrm{p}IC_{50} = 9 - \\log_{10}(35) $$\n现在，我们计算数值。\n$$ \\log_{10}(35) \\approx 1.544068 $$\n将此值代入 $\\mathrm{p}IC_{50}$ 的表达式中：\n$$ \\mathrm{p}IC_{50} \\approx 9 - 1.544068 = 7.455932 $$\n问题要求将答案四舍五入到四位有效数字。计算值为 $7.455932...$，四舍五入到四位有效数字后为 $7.456$。\n\nC部分。解释 $\\mathrm{p}IC_{50}$ 变换的统计学益处。\n\n在回归情景中，目标通常是建立一个形式为 $Y = f(\\mathbf{X})$ 的关系模型，其中 $Y$ 是响应变量，$\\mathbf{X}$ 是预测变量向量（在QSAR中是分子描述符）。许多标准回归算法，如普通最小二乘法，在误差是加性的、服从正态分布且具有恒定方差（同方差性）时表现最佳。\n\n问题陈述指出，$IC_{50}$ 的变异性由一个乘性（对数正态）误差模型描述。设响应变量为 $Y = IC_{50}$。该模型可以写为：\n$$ Y_i = f(\\mathbf{x}_i) \\cdot \\epsilon_i $$\n其中 $f(\\mathbf{x}_i)$ 是第 $i$ 个化合物（描述符为 $\\mathbf{x}_i$）的真实预测值，$\\epsilon_i$ 是一个乘性误差项。如果 $Y_i$ 服从对数正态分布，那么它的对数服从正态分布。误差项 $\\epsilon_i$ 假定来自一个对数正态分布，其几何平均数通常为 $1$。对数正态分布的一个重要特征是其方差依赖于其均值，这导致了异方差性（误差方差不恒定）。该分布也呈正偏态。\n\n现在，考虑向 $\\mathrm{p}IC_{50}$ 标度的转换。设转换后的响应为 $Z = \\mathrm{p}IC_{50}$。\n$$ Z_i = \\mathrm{p}IC_{50,i} = -\\log_{10}(Y_i) $$\n将此变换应用于乘性误差模型：\n$$ Z_i = -\\log_{10}(f(\\mathbf{x}_i) \\cdot \\epsilon_i) $$\n使用对数规则 $\\log_{10}(ab) = \\log_{10}(a) + \\log_{10}(b):$\n$$ Z_i = -(\\log_{10}(f(\\mathbf{x}_i)) + \\log_{10}(\\epsilon_i)) $$\n$$ Z_i = -\\log_{10}(f(\\mathbf{x}_i)) - \\log_{10}(\\epsilon_i) $$\n此方程表示一个加性误差模型：\n$$ Z_i = g(\\mathbf{x}_i) + \\delta_i $$\n其中 $g(\\mathbf{x}_i) = -\\log_{10}(f(\\mathbf{x}_i))$ 是转换后的模型函数，$\\delta_i = -\\log_{10}(\\epsilon_i)$ 是加性误差项。\n\n该变换为数值条件和模型拟合带来了两个关键的改进：\n1.  **方差稳定化**：根据定义，如果 $\\epsilon_i$ 服从对数正态分布，那么 $\\log_{10}(\\epsilon_i)$ 就服从正态分布。因此，新的误差项 $\\delta_i = -\\log_{10}(\\epsilon_i)$ 也服从正态分布。正态分布的一个关键性质是其方差是恒定的，且独立于其均值。因此，该变换将 $IC_{50}$ 标度下的异方差乘性误差转换为 $\\mathrm{p}IC_{50}$ 标度下的同方差（恒定方差）加性误差。这满足了许多回归算法的一个基本假设。\n2.  **响应和误差分布的对称化**：$IC_{50}$ 值服从对数正态分布，因此是偏态的。对数变换使得转换后的响应变量 $Z$ 及其误差 $\\delta_i$ 的分布对称且呈正态。这提高了参数估计的可靠性和统计显著性检验的有效性。\n\n总而言之，将 $IC_{50}$ 转换为 $\\mathrm{p}IC_{50}$，可将一个乘性的、异方差的、偏态的误差结构转换为一个加性的、同方差的、正态的误差结构。这一变化使数据更好地符合许多回归模型的基本假设，从而提高了所得QSAR模型的数值稳定性和统计有效性。",
            "answer": "$$ \\boxed{7.456} $$"
        },
        {
            "introduction": "在对响应变量和预测变量进行适当处理后，我们可以拟合一个线性模型，但模型产生的系数 $\\\\beta_j$ 究竟意味着什么？本练习深入探讨了如何将模型系数解释为特征重要性的度量，并强调了在描述符不相关与存在共线性这两种情况下解释的巨大差异。这将是关于 QSAR 建模中一个常见陷阱的关键一课。",
            "id": "4602704",
            "problem": "您正在生物信息学和医学数据分析的药物发现工作流程中，建立一个定量构效关系 (QSAR) 线性模型。设响应变量为连续的生物活性，记为 $y \\in \\mathbb{R}^{n}$，分子描述符收集在设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 中。您将每个描述符列 $x_{j}$ 标准化，使其均值为 $0$、方差为 $1$（即 $x_{j} \\leftarrow (x_{j}-\\bar{x}_{j})/s_{x_{j}}$，使得 $\\mathbb{E}[x_{j}]=0$ 且 $\\operatorname{Var}(x_{j})=1$），并将 $y$ 中心化使其均值为 $0$。然后，在通常的 Gauss–Markov 假设下，您拟合了一个普通最小二乘 (OLS) 线性模型 $y = X \\beta + \\varepsilon$，其中 $\\varepsilon$ 是一个均值为零、方差为 $\\sigma^{2}$ 的噪声项。您希望在标准化的描述符空间中，使用每个拟合系数的绝对值 $\\lvert \\hat{\\beta}_{j} \\rvert$ 作为特征重要性的度量。\n\n仅从第一性原理和核心定义（标准化、Pearson 相关性以及 OLS 正规方程）出发，推理分析如何将线性系数解释为重要性度量，以及描述符之间的共线性如何影响该解释。\n\n选择所有正确的陈述。\n\nA. 如果描述符经过标准化且相互不相关（在样本中正交），则按 $\\lvert \\hat{\\beta}_{j} \\rvert$ 对描述符进行排序与按其与响应变量的 Pearson 相关性绝对值 $\\lvert r(x_{j}, y) \\rvert$ 进行排序是相同的。在这种正交情况下，当其他描述符保持不变时，$x_{j}$ 增加1个标准差，$\\lvert \\hat{\\beta}_{j} \\rvert$ 等于 $y$（以其原始单位）的预期变化量。\n\nB. 在标准化的描述符之间存在高度但非完全共线性的情况下，OLS 系数可能在数值上不稳定：数据的微小扰动可能导致 $\\hat{\\beta}$ 发生巨大变化，包括相对于边际相关性 $r(x_{j}, y)$ 的符号翻转。因此，在这种情况下，$\\lvert \\hat{\\beta}_{j} \\rvert$ 可能是衡量特征重要性的一个误导性指标。\n\nC. 在标准化描述符空间中，OLS 系数向量可以写为 $\\hat{\\beta} = R_{XX}^{-1} s_{Xy}$，其中 $R_{XX}$ 是描述符的 $p \\times p$ 样本相关矩阵，$s_{Xy}$ 是样本协方差 $\\operatorname{Cov}(x_{j}, y)$ 的 $p \\times 1$ 向量。等价地，如果 $y$ 也被标准化为单位方差，则 $\\hat{\\beta} = R_{XX}^{-1} r_{Xy}$，其中 $r_{Xy}$ 汇集了 Pearson 相关系数 $r(x_{j}, y)$。因此，将 $\\hat{\\beta}_{j}$ 解释为“重要性”是通过 $R_{XX}^{-1}$ 对所有其他描述符进行隐式条件化的。\n\nD. 如果两个标准化描述符完全共线性（例如，两个相同的圆形指纹），OLS 系数估计值仍然是唯一且有限的，因此任一系数仍然可以直接用作稳定的特征重要性度量。\n\nE. 设 $R_{XX}$ 为标准化描述符的样本相关矩阵。$R_{XX}^{-1}$ 的对角线项等于方差膨胀因子 (VIFs)。在误差方差为 $\\sigma^{2}$ 的同方差线性模型下，$\\hat{\\beta}_{j}$ 的抽样方差满足 $\\operatorname{Var}(\\hat{\\beta}_{j}) = \\sigma^{2} \\, (R_{XX}^{-1})_{jj} / n$，因此，一个大的 VIF 值警示我们 $\\lvert \\hat{\\beta}_{j} \\rvert$ 是一个不稳定的重要性估计。",
            "solution": "问题陈述描述了定量构效关系 (QSAR) 建模中的一个标准场景：解释对预测变量（描述符）已标准化的数据所拟合的普通最小二乘 (OLS) 线性模型的系数。该问题具有科学依据、适定且客观。我们可以进行形式化的推导和评估。\n\n### 第一性原理推导\n\nOLS 线性模型由 $y = X \\beta + \\varepsilon$ 给出，其中 $y \\in \\mathbb{R}^{n}$ 是响应向量，$X \\in \\mathbb{R}^{n \\times p}$ 是预测变量的设计矩阵，$\\beta \\in \\mathbb{R}^{p}$ 是系数向量，$\\varepsilon \\in \\mathbb{R}^{n}$ 是误差向量。选择 OLS 估计值 $\\hat{\\beta}$ 是为了最小化残差平方和 $\\|y - X\\beta\\|^2$。其解由正规方程给出：\n$$ (X^T X) \\hat{\\beta} = X^T y $$\n假设 $X^T X$ 可逆，唯一解为：\n$$ \\hat{\\beta} = (X^T X)^{-1} X^T y $$\n问题陈述指出，预测变量列 $x_j$ 被标准化，使其样本均值为 $0$，样本方差为 $1$；响应向量 $y$ 被中心化，使其样本均值为 $0$。我们用索引 $i=1, \\dots, n$ 表示样本。\n对于一个标准化的预测变量 $x_j$，我们有：\n$$ \\frac{1}{n} \\sum_{i=1}^{n} x_{ij} = 0 \\quad \\text{and} \\quad \\frac{1}{n} \\sum_{i=1}^{n} x_{ij}^2 = 1 $$\n这里为简单起见，我们用除数 $n$ 计算方差；使用 $n-1$ 不会改变核心结果。\n矩阵 $X^T X$ 的第 $(j, k)$ 个元素是 $\\sum_{i=1}^{n} x_{ij} x_{ik}$。\n预测变量 $x_j$ 和 $x_k$ 之间的样本相关性为：\n$$ r(x_j, x_k) = \\frac{\\sum_{i=1}^{n} (x_{ij} - \\bar{x}_j)(x_{ik} - \\bar{x}_k)}{\\sqrt{\\sum_{i=1}^{n} (x_{ij} - \\bar{x}_j)^2} \\sqrt{\\sum_{i=1}^{n} (x_{ik} - \\bar{x}_k)^2}} $$\n由于预测变量是标准化的，$\\bar{x}_j = \\bar{x}_k = 0$，$\\sum_{i=1}^{n} x_{ij}^2 = n$，且 $\\sum_{i=1}^{n} x_{ik}^2 = n$。\n因此，相关性为 $r(x_j, x_k) = \\frac{\\sum_{i=1}^{n} x_{ij} x_{ik}}{n}$。\n设 $R_{XX}$ 为预测变量的 $p \\times p$ 样本相关矩阵。其第 $(j, k)$ 个元素是 $r(x_j, x_k)$。因此我们可以写出：\n$$ X^T X = n R_{XX} $$\n类似地，向量 $X^T y$ 的第 $j$ 个元素是 $\\sum_{i=1}^{n} x_{ij} y_i$。\n标准化的预测变量 $x_j$ 和中心化的响应变量 $y$ 之间的样本协方差是：\n$$ \\operatorname{Cov}(x_j, y) = \\frac{1}{n} \\sum_{i=1}^{n} (x_{ij} - \\bar{x}_j)(y_i - \\bar{y}) = \\frac{1}{n} \\sum_{i=1}^{n} x_{ij} y_i $$\n因为 $\\bar{x}_j=0$ 且 $\\bar{y}=0$。设 $s_{Xy}$ 为这些协方差的向量。那么：\n$$ X^T y = n s_{Xy} $$\n将这些代入 OLS 解中：\n$$ \\hat{\\beta} = (n R_{XX})^{-1} (n s_{Xy}) = R_{XX}^{-1} s_{Xy} $$\n在 Gauss-Markov 假设下，估计量 $\\hat{\\beta}$ 的协方差矩阵为 $\\operatorname{Var}(\\hat{\\beta}) = \\sigma^2(X^T X)^{-1}$，其中 $\\sigma^2$ 是误差项 $\\varepsilon_i$ 的方差。代入 $X^T X = n R_{XX}$：\n$$ \\operatorname{Var}(\\hat{\\beta}) = \\sigma^2 (n R_{XX})^{-1} = \\frac{\\sigma^2}{n} R_{XX}^{-1} $$\n单个系数估计值 $\\hat{\\beta}_j$ 的抽样方差是该矩阵的第 $j$ 个对角元素：\n$$ \\operatorname{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{n} (R_{XX}^{-1})_{jj} $$\n\n有了这些基础性结果，我们可以评估每个陈述。\n\n### 逐项分析\n\n**A. 如果描述符经过标准化且相互不相关（在样本中正交），则按 $\\lvert \\hat{\\beta}_{j} \\rvert$ 对描述符进行排序与按其与响应变量的 Pearson 相关性绝对值 $\\lvert r(x_{j}, y) \\rvert$ 进行排序是相同的。在这种正交情况下，当其他描述符保持不变时，$x_{j}$ 增加1个标准差，$\\lvert \\hat{\\beta}_{j} \\rvert$ 等于 $y$（以其原始单位）的预期变化量。**\n\n如果描述符相互不相关，它们的样本相关矩阵 $R_{XX}$ 就是单位矩阵 $I$。$\\hat{\\beta}$ 的公式变为：\n$$ \\hat{\\beta} = I^{-1} s_{Xy} = s_{Xy} $$\n这意味着对于每个描述符 $j$，$\\hat{\\beta}_j = \\operatorname{Cov}(x_j, y)$。\n$x_j$ 和 $y$ 之间的 Pearson 相关性是 $r(x_j, y) = \\frac{\\operatorname{Cov}(x_j, y)}{s_x s_y}$。由于 $x_j$ 是标准化的，其样本标准差 $s_x$ 为 $1$。所以，$r(x_j, y) = \\frac{\\operatorname{Cov}(x_j, y)}{s_y}$。\n这给出了关系式 $\\hat{\\beta}_j = s_y \\cdot r(x_j, y)$。由于 $s_y$（响应变量的标准差）对所有描述符来说是一个正常数，$\\lvert \\hat{\\beta}_j \\rvert$ 与 $\\lvert r(x_j, y) \\rvert$ 成正比。因此，按系数的绝对值大小对描述符进行排序，等同于按它们与响应变量的绝对相关性进行排序。这部分是正确的。\n\n回归系数 $\\hat{\\beta}_j$ 的解释是，在保持所有其他预测变量不变的情况下，预测变量 $x_j$ 每增加一个单位，响应变量 $y$ 的预期变化。由于预测变量是标准化的， $x_j$ 的一个单位变化等同于原始未标准化描述符的一个标准差变化。响应变量 $y$ 经过中心化但未缩放，因此其单位保持不变。所以，这个解释是正确的。\n\n结论：**正确**。\n\n**B. 在标准化的描述符之间存在高度但非完全共线性的情况下，OLS 系数可能在数值上不稳定：数据的微小扰动可能导致 $\\hat{\\beta}$ 发生巨大变化，包括相对于边际相关性 $r(x_{j}, y)$ 的符号翻转。因此，在这种情况下，$\\lvert \\hat{\\beta}_{j} \\rvert$ 可能是衡量特征重要性的一个误导性指标。**\n\n高度共线性意味着预测变量相关矩阵 $R_{XX}$ 近乎奇异。其逆矩阵 $R_{XX}^{-1}$ 的元素将具有非常大的数值。从公式 $\\hat{\\beta} = R_{XX}^{-1} s_{Xy}$ 可以明显看出，$R_{XX}^{-1}$ 的巨大元素会极大地放大协方差向量 $s_{Xy}$ 或相关矩阵 $R_{XX}$ 中存在的微小变化或噪声。这导致最终的系数估计值 $\\hat{\\beta}$ 发生巨大变化，这正是数值不稳定性的定义。\n符号翻转是多重共线性的一个经典后果。例如，两个预测变量 $x_1$ 和 $x_2$ 可能都与 $y$ 呈正相关，但如果它们彼此之间也高度相关，模型可能会给其中一个分配一个大的正系数，而给另一个分配一个大的负系数，以解释它们的共享方差。一个变量在保持另一个变量不变的情况下的偏效应，其符号可能与其边际效应相反。\n由于这种不稳定性以及可能出现反直觉的系数符号和大小，在存在强共线性的情况下，使用 $\\lvert \\hat{\\beta}_j \\rvert$ 作为特征重要性的直接度量可能具有高度误导性。\n\n结论：**正确**。\n\n**C. 在标准化描述符空间中，OLS 系数向量可以写为 $\\hat{\\beta} = R_{XX}^{-1} s_{Xy}$，其中 $R_{XX}$ 是描述符的 $p \\times p$ 样本相关矩阵，$s_{Xy}$ 是样本协方差 $\\operatorname{Cov}(x_{j}, y)$ 的 $p \\times 1$ 向量。等价地，如果 $y$ 也被标准化为单位方差，则 $\\hat{\\beta} = R_{XX}^{-1} r_{Xy}$，其中 $r_{Xy}$ 汇集了 Pearson 相关系数 $r(x_{j}, y)$。因此，将 $\\hat{\\beta}_{j}$ 解释为“重要性”是通过 $R_{XX}^{-1}$ 对所有其他描述符进行隐式条件化的。**\n\n陈述的第一部分 $\\hat{\\beta} = R_{XX}^{-1} s_{Xy}$ 是直接从上面的第一性原理推导出来的，是正确的。\n第二部分考虑了 $y$ 也被标准化为单位方差的情况，即 $s_y = 1$。在这种情况下，协方差 $\\operatorname{Cov}(x_j, y)$ 等于相关性 $r(x_j, y)$，因为 $r(x_j, y) = \\frac{\\operatorname{Cov}(x_j, y)}{s_j s_y} = \\frac{\\operatorname{Cov}(x_j, y)}{(1)(1)} = \\operatorname{Cov}(x_j, y)$。因此，协方差向量 $s_{Xy}$ 变成了相关性向量 $r_{Xy}$，公式正确地转换为 $\\hat{\\beta} = R_{XX}^{-1} r_{Xy}$。\n陈述的最后一部分正确地解释了 $R_{XX}^{-1}$ 项的作用。这个逆矩阵的存在意味着每个系数 $\\hat{\\beta}_j$ 不仅仅是 $x_j$ 和 $y$ 之间关系的函数，而是针对 $x_j$ 与所有其他预测变量之间关系进行调整后的结果。这种矩阵求逆是在模型中“以其他变量为条件”或“控制其他变量”的数学机制。\n\n结论：**正确**。\n\n**D. 如果两个标准化描述符完全共线性（例如，两个相同的圆形指纹），OLS 系数估计值仍然是唯一且有限的，因此任一系数仍然可以直接用作稳定的特征重要性度量。**\n\n完全共线性意味着设计矩阵 $X$ 的至少一列是其他列的线性组合。例如，如果描述符 $x_j$ 和 $x_k$ 相同，则 $x_j = x_k$。这意味着矩阵 $X^T X$ 是奇异的（不可逆）。如第一性原理推导所示，OLS 解为 $\\hat{\\beta} = (X^T X)^{-1} X^T y$。如果 $X^T X$ 是奇异的，它的逆矩阵就不存在。因此，$\\hat{\\beta}$ 没有唯一解。相反，存在无穷多个解。例如，如果 $x_j = x_k$，任何一对系数 $(\\beta_j, \\beta_k)$，只要它们的和 $\\beta_j + \\beta_k$ 是一个特定的常数，并且其他系数保持不变，都会产生相同的模型拟合度。这些估计值不是唯一的。因此，它们不能作为对任一单个特征的稳定或有意义的重要性度量。\n\n结论：**不正确**。\n\n**E. 设 $R_{XX}$ 为标准化描述符的样本相关矩阵。$R_{XX}^{-1}$ 的对角线项等于方差膨胀因子 (VIFs)。在误差方差为 $\\sigma^{2}$ 的同方差线性模型下，$\\hat{\\beta}_{j}$ 的抽样方差满足 $\\operatorname{Var}(\\hat{\\beta}_{j}) = \\sigma^{2} \\, (R_{XX}^{-1})_{jj} / n$，因此，一个大的 VIF 值警示我们 $\\lvert \\hat{\\beta}_{j} \\rvert$ 是一个不稳定的重要性估计。**\n\n“预测变量相关矩阵的逆矩阵 $(R_{XX}^{-1})_{jj}$ 的对角线元素等于方差膨胀因子 (VIFs)”这一陈述是回归诊断中的一个标准结果。预测变量 $j$ 的 VIF 定义为 $\\text{VIF}_j = 1/(1 - R_j^2)$，其中 $R_j^2$ 是将 $x_j$ 对其他 $p-1$ 个预测变量进行回归得到的决定系数。数学上可以证明 $\\text{VIF}_j = (R_{XX}^{-1})_{jj}$。\n$\\hat{\\beta}_j$ 的抽样方差公式 $\\operatorname{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{n} (R_{XX}^{-1})_{jj}$ 是从上面的第一性原理推导出来的，是正确的。\n结合这两个事实，我们得到 $\\operatorname{Var}(\\hat{\\beta}_j) = \\frac{\\sigma^2}{n} \\text{VIF}_j$。这个方程直接表明，一个大的 VIF（预示着预测变量 $j$ 的高度共线性）会导致其系数估计值 $\\hat{\\beta}_j$ 的抽样方差很大。高方差意味着估计值不精确，并且对特定的数据样本高度敏感，使其成为一个不稳定的估计。一个不稳定的估计不能成为特征重要性的可靠度量。该陈述完全正确。\n\n结论：**正确**。",
            "answer": "$$\\boxed{ABCE}$$"
        },
        {
            "introduction": "模型的有效性可能会被少数几个“影响力点”所破坏，这些数据点（即分子）会不成比例地将回归线拉向自己。本练习将介绍库克距离（Cook's distance），一个用于识别此类影响力点的强大诊断工具。通过推导其公式，您将深刻理解影响力是如何由高杠杆率（奇异的描述符）和大残差（拟合效果差）共同作用产生的，这是构建可信赖 QSAR 模型的关键概念。",
            "id": "4602664",
            "problem": "一名研究人员正在构建一个线性定量构效关系（QSAR）模型，其中生物响应 $y$（例如，$\\log_{10}(\\mathrm{IC}_{50})$）被建模为 $p$ 个分子描述符（包括一个截距项）的线性组合。对于 $n$ 种化合物，这些描述符收集在设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 中。普通最小二乘（OLS）估计量定义为 $\\hat{\\beta} = (X^{\\top}X)^{-1}X^{\\top}y$，拟合响应值为 $\\hat{y} = X\\hat{\\beta}$，残差为 $e = y - \\hat{y}$（其分量为 $e_i$），帽子矩阵为 $H = X(X^{\\top}X)^{-1}X^{\\top}$，其对角线元素 $h_{ii}$ 称为杠杆值。令 $\\hat{\\sigma}^{2}$ 表示 OLS 残差方差估计，并将观测值 $i$ 的标准化残差定义为 $r_i = \\dfrac{e_i}{\\hat{\\sigma}\\sqrt{1 - h_{ii}}}$。\n\n从这些基本定义出发，推导删除观测值 $i$ 引起的拟合响应向量的总体变化表达式，并用它来获得库克距离 $D_i$ 的一个显式解析公式，该公式仅依赖于杠杆值 $h_{ii}$、标准化残差 $r_i$ 和参数数量 $p$。然后，在线性 QSAR 诊断的背景下，解释所推导出的 $D_i$ 形式如何指导强影响点的检测，包括杠杆值和残差大小的作用，以及用于影响筛选的、科学上接受的、考虑模型大小的决策启发式方法。你的最终答案必须是 $D_i$ 关于 $h_{ii}$、$r_i$ 和 $p$ 的单个闭式解析表达式。",
            "solution": "该问题要求推导库克距离 $D_i$ 的一个显式公式，该公式用模型杠杆值 $h_{ii}$、标准化残差 $r_i$ 和参数数量 $p$ 来表示。问题还要求解释其在定量构效关系（QSAR）背景下如何用于识别强影响点。\n\n首先，我们验证问题陈述的有效性。\n该问题提供了普通最小二乘（OLS）线性回归的标准设置。\n**给定条件：**\n- 模型：线性模型，$y = X\\beta + \\epsilon$。\n- OLS 估计量：$\\hat{\\beta} = (X^{\\top}X)^{-1}X^{\\top}y$。\n- 拟合值：$\\hat{y} = X\\hat{\\beta}$。\n- 残差：$e = y - \\hat{y}$。\n- 帽子矩阵：$H = X(X^{\\top}X)^{-1}X^{\\top}$。\n- 杠杆值：$h_{ii}$ 是 $H$ 的对角线元素。\n- 残差方差估计：$\\hat{\\sigma}^{2}$。\n- 标准化残差：$r_i = \\dfrac{e_i}{\\hat{\\sigma}\\sqrt{1 - h_{ii}}}$。\n该问题具有科学依据，提法恰当，客观且内容自洽。这是回归诊断中的一个标准推导。因此，该问题是有效的。\n\n我们开始推导库克距离 $D_i$。库克距离通过量化从数据集中删除观测值 $i$ 时拟合值的总体变化来衡量观测值 $i$ 的影响。其定义为：\n$$ D_i = \\frac{\\sum_{j=1}^{n} (\\hat{y}_j - \\hat{y}_{j(i)})^2}{p \\hat{\\sigma}^2} $$\n其中 $\\hat{y}_{j(i)}$ 是在移除了观测值 $i$ 的回归中获得的第 $j$ 个拟合值。这些拟合值的向量是 $\\hat{y}_{(i)} = X \\hat{\\beta}_{(i)}$，其中 $\\hat{\\beta}_{(i)}$ 是在没有观测值 $i$ 的情况下估计出的系数向量。分子可以写成矩阵形式：\n$$ D_i = \\frac{(\\hat{y} - \\hat{y}_{(i)})^{\\top}(\\hat{y} - \\hat{y}_{(i)})}{p \\hat{\\sigma}^2} $$\n代入 $\\hat{y} = X\\hat{\\beta}$ 和 $\\hat{y}_{(i)} = X\\hat{\\beta}_{(i)}$，我们得到：\n$$ D_i = \\frac{(X\\hat{\\beta} - X\\hat{\\beta}_{(i)})^{\\top}(X\\hat{\\beta} - X\\hat{\\beta}_{(i)})}{p \\hat{\\sigma}^2} = \\frac{(\\hat{\\beta} - \\hat{\\beta}_{(i)})^{\\top}X^{\\top}X(\\hat{\\beta} - \\hat{\\beta}_{(i)})}{p \\hat{\\sigma}^2} $$\n核心任务是找到系数向量变化量 $\\hat{\\beta} - \\hat{\\beta}_{(i)}$ 的一个计算上高效的表达式。回归诊断中的一个关键结果，可以从用于逆矩阵秩-1更新的 Sherman-Morrison-Woodbury 公式推导出来，将这个变化与来自全数据回归的量联系起来：\n$$ \\hat{\\beta} - \\hat{\\beta}_{(i)} = \\frac{(X^{\\top}X)^{-1}x_i e_i}{1 - h_{ii}} $$\n其中 $x_i^{\\top}$ 是设计矩阵 $X$ 的第 $i$ 行，$e_i = y_i - \\hat{y}_i$ 是第 $i$ 个普通残差，而 $h_{ii} = x_i^{\\top}(X^{\\top}X)^{-1}x_i$ 是第 $i$ 个杠杆值。\n\n现在，我们将此表达式代回 $D_i$ 的分子中：\n$$ (\\hat{\\beta} - \\hat{\\beta}_{(i)})^{\\top}X^{\\top}X(\\hat{\\beta} - \\hat{\\beta}_{(i)}) = \\left( \\frac{(X^{\\top}X)^{-1}x_i e_i}{1 - h_{ii}} \\right)^{\\top} X^{\\top}X \\left( \\frac{(X^{\\top}X)^{-1}x_i e_i}{1 - h_{ii}} \\right) $$\n项 $e_i / (1 - h_{ii})$ 是一个标量，因此我们可以将其提出来：\n$$ = \\frac{e_i^2}{(1 - h_{ii})^2} \\left( (X^{\\top}X)^{-1}x_i \\right)^{\\top} X^{\\top}X \\left( (X^{\\top}X)^{-1}x_i \\right) $$\n应用转置法则 $(AB)^{\\top} = B^{\\top}A^{\\top}$：\n$$ = \\frac{e_i^2}{(1 - h_{ii})^2} x_i^{\\top} \\left((X^{\\top}X)^{-1}\\right)^{\\top} X^{\\top}X (X^{\\top}X)^{-1}x_i $$\n由于 $X^{\\top}X$ 是一个对称矩阵，它的逆 $(X^{\\top}X)^{-1}$ 也是对称的。因此，$\\left((X^{\\top}X)^{-1}\\right)^{\\top} = (X^{\\top}X)^{-1}$。表达式简化为：\n$$ = \\frac{e_i^2}{(1 - h_{ii})^2} x_i^{\\top} (X^{\\top}X)^{-1} X^{\\top}X (X^{\\top}X)^{-1}x_i $$\n$$ = \\frac{e_i^2}{(1 - h_{ii})^2} x_i^{\\top} (X^{\\top}X)^{-1}x_i $$\n我们认出项 $x_i^{\\top}(X^{\\top}X)^{-1}x_i$ 就是杠杆值 $h_{ii}$ 的定义。因此，分子是：\n$$ \\text{分子} = \\frac{e_i^2 h_{ii}}{(1 - h_{ii})^2} $$\n将此代回 $D_i$ 的公式中：\n$$ D_i = \\frac{1}{p\\hat{\\sigma}^2} \\frac{e_i^2 h_{ii}}{(1 - h_{ii})^2} $$\n题目要求我们用标准化残差 $r_i$ 来表示这个式子。问题定义了 $r_i = \\frac{e_i}{\\hat{\\sigma}\\sqrt{1 - h_{ii}}}$。两边平方得到 $r_i^2 = \\frac{e_i^2}{\\hat{\\sigma}^2(1 - h_{ii})}$，这意味着 $e_i^2 = r_i^2 \\hat{\\sigma}^2 (1 - h_{ii})$。\n现在，将 $e_i^2$ 的这个表达式代入 $D_i$ 的公式中：\n$$ D_i = \\frac{1}{p\\hat{\\sigma}^2} \\frac{r_i^2 \\hat{\\sigma}^2 (1 - h_{ii}) h_{ii}}{(1 - h_{ii})^2} $$\n$\\hat{\\sigma}^2$ 项被消掉，同时 $(1 - h_{ii})$ 的一个因子也被消掉：\n$$ D_i = \\frac{r_i^2 h_{ii}}{p(1 - h_{ii})} $$\n这个表达式可以重新整理以突出其组成部分：\n$$ D_i = \\frac{r_i^2}{p} \\left( \\frac{h_{ii}}{1 - h_{ii}} \\right) $$\n这个最终形式就是所要求的库克距离的解析公式。\n\n在线性 QSAR 诊断的背景下，这个公式为检测强影响点提供了关键的洞察。一个强影响点是一个数据点，如果移除它，将会导致估计的模型参数 $\\hat{\\beta}$ 以及因此产生的拟合值 $\\hat{y}$ 发生显著变化。该公式表明，由 $D_i$ 测量的影响是两个不同组成部分的函数：\n1. **残差大小**：项 $r_i^2/p$ 反映了模型对该观测值的拟合程度有多差。标准化残差 $r_i$ 衡量了观测响应 $y_i$ 和拟合响应 $\\hat{y}_i$ 之间的距离，并用其标准差的估计值进行缩放。一个大的 $|r_i|$ 表明该点在响应变量方向上是一个离群点。\n2. **杠杆值**：项 $h_{ii}/(1-h_{ii})$ 反映了由于观测值在预测变量空间（即分子描述符空间）中的位置而产生的潜在影响。杠杆值 $h_{ii}$ 的范围从 $1/n$ 到 $1$，衡量了描述符向量 $x_i$ 离描述符数据中心的距离。项 $h_{ii}/(1-h_{ii})$ 是 $h_{ii}$ 的一个单调递增函数，它非线性增长，并在 $h_{ii}$ 趋近于 $1$ 时趋于无穷大。一个具有高杠杆值的点被称为处于“高杠杆”位置。\n\n至关重要的是，一个观测值必须同时具有大残差和高杠杆值才具有强影响。一个杠杆值高但残差小的点（一个“好的”杠杆点）位于描述符空间的远处，但与其他数据的趋势一致，通常会稳定回归模型。相反，一个残差大但杠杆值低的点（一个典型的离群点）的预测变量值接近平均值，因此其将回归线拉向自身的能力有限。一个强影响点既是在 $y$ 方向上的离群点（大的 $r_i$），又是在 $X$ 空间中的偏远点（高的 $h_{ii}$）。\n\n在 QSAR 的实际影响筛选中，不能简单地孤立地检查残差或杠杆值。库克距离将两者结合成一个单一的、可解释的度量。科学上接受的、考虑模型大小的决策启发式方法被用来标记可能具有影响的化合物以进行进一步研究。一个常见且简单的经验法则是将 $D_i > 1$ 的观测值视为具有高影响性。然而，对于更大的样本量，这个阈值可能过于保守。一个更灵敏的、根据样本大小调整的启发式方法是标记 $D_i > 4/n$ 的观测值，其中 $n$ 是化合物的数量。这个标准会根据数据集的大小自动调整影响的阈值，这在 QSAR 研究中是一个关键的考虑因素，因为化合物数量可能从几十个到几千个不等。识别这些点是仔细诊断过程的第一步，该过程可能涉及检查数据录入错误、重新评估分子结构，或考虑该化合物是否代表了当前模型未捕捉到的不同作用机制。",
            "answer": "$$\\boxed{\\frac{r_i^2}{p} \\left( \\frac{h_{ii}}{1 - h_{ii}} \\right)}$$"
        }
    ]
}