{
    "hands_on_practices": [
        {
            "introduction": "打分函数通常由多个能量项组成，其中由溶剂暴露变化驱动的疏水效应是最重要的驱动力之一。本练习  使用广泛应用的溶剂可及表面积（SASA）模型，提供对该效应的手动计算，帮助您具体理解蛋白质-配体结合中的这一基本驱动力。",
            "id": "4599774",
            "problem": "一个对接打分函数包含一个非极性溶剂化自由能项，该项被建模为比例常数与溶剂可及表面积 (SASA) 的乘积，再加上一个偏移量。非极性溶剂化自由能由表达式 $$G_{\\mathrm{np}} = \\gamma A + c,$$ 近似表示，其中 $G_{\\mathrm{np}}$ 是非极性溶剂化自由能，$\\gamma$ 是一个比例常数，$A$ 是溶剂可及表面积 (SASA)，$c$ 是一个与溶质相关的偏移常数。溶剂可及表面积 (SASA) 定义为溶剂探针的中心在溶质的范德华表面上滚动时所描绘的区域面积。\n\n考虑一个配体与蛋白质结合形成一个复合物。游离蛋白质的 SASA 为 $A_{\\mathrm{protein}} = 8.200 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$，游离配体的 SASA 为 $A_{\\mathrm{ligand}} = 6.50 \\times 10^{2}\\ \\mathrm{\\AA}^{2}$，蛋白质-配体复合物的 SASA 为 $A_{\\mathrm{complex}} = 7.800 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$。非极性参数为 $\\gamma = 5.42 \\times 10^{-3}\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$，偏移常数为每个溶质 $c = 0.92\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}$。假设偏移量 $c$ 对每个独立的溶质实体（游离蛋白质、游离配体和复合物）应用一次，且数值相同。\n\n从结合自由能变化的定义（复合物的自由能减去孤立组分自由能的总和）出发，推导结合过程中非极性溶剂化自由能变化的表达式 $$\\Delta G_{\\mathrm{np,bind}} = G_{\\mathrm{np}}(\\mathrm{complex}) - G_{\\mathrm{np}}(\\mathrm{protein}) - G_{\\mathrm{np}}(\\mathrm{ligand}),$$ 并计算其数值。使用 $1\\ \\mathrm{kcal} = 4.184\\ \\mathrm{kJ}$ 将最终能量转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。您的最终答案需要以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其科学上合理、提法得当且客观。\n\n### 第1步：提取已知条件\n-   非极性溶剂化自由能的模型为 $G_{\\mathrm{np}} = \\gamma A + c$。\n-   $G_{\\mathrm{np}}$ 是非极性溶剂化自由能。\n-   $\\gamma$ 是比例常数，给定为 $\\gamma = 5.42 \\times 10^{-3}\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$。\n-   $A$ 是溶剂可及表面积 (SASA)。\n-   $c$ 是偏移常数，给定为每个溶质 $c = 0.92\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}$。\n-   游离蛋白质的 SASA：$A_{\\mathrm{protein}} = 8.200 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$。\n-   游离配体的 SASA：$A_{\\mathrm{ligand}} = 6.50 \\times 10^{2}\\ \\mathrm{\\AA}^{2}$。\n-   蛋白质-配体复合物的 SASA：$A_{\\mathrm{complex}} = 7.800 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$。\n-   偏移量 $c$ 对每个独立的溶质实体（蛋白质、配体、复合物）应用一次。\n-   结合过程中的非极性溶剂化自由能变化定义为 $\\Delta G_{\\mathrm{np,bind}} = G_{\\mathrm{np}}(\\mathrm{complex}) - G_{\\mathrm{np}}(\\mathrm{protein}) - G_{\\mathrm{np}}(\\mathrm{ligand})$。\n-   转换因子为 $1\\ \\mathrm{kcal} = 4.184\\ \\mathrm{kJ}$。\n-   最终答案必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于生物物理化学和计算生物学的原理。模型 $G_{\\mathrm{np}} = \\gamma A + c$ 代表了一种标准（尽管是简化的）方法，用于在分子力学力场和对接打分函数中计算溶剂化自由能的非极性分量。SASA 的概念及其在结合时的变化（埋藏表面积）对于理解蛋白质-配体相互作用中的疏水效应至关重要。所提供的 SASA 数值对于一个典型的蛋白质-配体系统是符合实际的，并且 $\\gamma$ 的值在此类模型的可接受范围内。\n-   **提法得当**：该问题提法得当。它提供了所有必要的数据，对待计算的量有明确的定义，并对最终输出格式有明确的说明。存在唯一解。\n-   **客观性**：该问题以精确、客观和技术性的语言陈述，没有任何主观或有偏见的内容。\n\n### 第3步：结论与行动\n该问题被认为是**有效的**。这是生物信息学和医学数据分析领域的标准计算。现在开始推导解答。\n\n结合过程中的非极性溶剂化自由能变化 $\\Delta G_{\\mathrm{np,bind}}$ 定义为产物（复合物）的自由能与反应物（游离蛋白质和游离配体）的自由能之差。\n$$\n\\Delta G_{\\mathrm{np,bind}} = G_{\\mathrm{np}}(\\mathrm{complex}) - (G_{\\mathrm{np}}(\\mathrm{protein}) + G_{\\mathrm{np}}(\\mathrm{ligand}))\n$$\n$$\n\\Delta G_{\\mathrm{np,bind}} = G_{\\mathrm{np}}(\\mathrm{complex}) - G_{\\mathrm{np}}(\\mathrm{protein}) - G_{\\mathrm{np}}(\\mathrm{ligand})\n$$\n问题指定非极性溶剂化自由能的模型为 $G_{\\mathrm{np}} = \\gamma A + c$，其中 $\\gamma$ 是表面张力系数，$A$ 是溶剂可及表面积 (SASA)，$c$ 是一个偏移常数。问题明确指出，$c$ 对每个独立的溶质实体应用一次。我们将此模型应用于结合方程中的每一项：\n-   对于复合物（一个溶质实体）：$G_{\\mathrm{np}}(\\mathrm{complex}) = \\gamma A_{\\mathrm{complex}} + c$\n-   对于游离蛋白质（一个溶质实体）：$G_{\\mathrm{np}}(\\mathrm{protein}) = \\gamma A_{\\mathrm{protein}} + c$\n-   对于游离配体（一个溶质实体）：$G_{\\mathrm{np}}(\\mathrm{ligand}) = \\gamma A_{\\mathrm{ligand}} + c$\n\n将这些表达式代入 $\\Delta G_{\\mathrm{np,bind}}$ 的方程中：\n$$\n\\Delta G_{\\mathrm{np,bind}} = (\\gamma A_{\\mathrm{complex}} + c) - (\\gamma A_{\\mathrm{protein}} + c) - (\\gamma A_{\\mathrm{ligand}} + c)\n$$\n分配负号并合并同类项：\n$$\n\\Delta G_{\\mathrm{np,bind}} = \\gamma A_{\\mathrm{complex}} + c - \\gamma A_{\\mathrm{protein}} - c - \\gamma A_{\\mathrm{ligand}} - c\n$$\n$$\n\\Delta G_{\\mathrm{np,bind}} = \\gamma (A_{\\mathrm{complex}} - A_{\\mathrm{protein}} - A_{\\mathrm{ligand}}) + (c - c - c)\n$$\n这可以简化为：\n$$\n\\Delta G_{\\mathrm{np,bind}} = \\gamma (A_{\\mathrm{complex}} - A_{\\mathrm{protein}} - A_{\\mathrm{ligand}}) - c\n$$\n项 $(A_{\\mathrm{complex}} - A_{\\mathrm{protein}} - A_{\\mathrm{ligand}})$ 代表结合过程中总 SASA 的变化，我们将其表示为 $\\Delta A_{\\mathrm{bind}}$。\n首先，我们使用所提供的值计算 $\\Delta A_{\\mathrm{bind}}$：\n$A_{\\mathrm{protein}} = 8.200 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$\n$A_{\\mathrm{ligand}} = 6.50 \\times 10^{2}\\ \\mathrm{\\AA}^{2} = 0.650 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$\n$A_{\\mathrm{complex}} = 7.800 \\times 10^{3}\\ \\mathrm{\\AA}^{2}$\n$$\n\\Delta A_{\\mathrm{bind}} = (7.800 \\times 10^{3}\\ \\mathrm{\\AA}^{2}) - (8.200 \\times 10^{3}\\ \\mathrm{\\AA}^{2}) - (0.650 \\times 10^{3}\\ \\mathrm{\\AA}^{2})\n$$\n$$\n\\Delta A_{\\mathrm{bind}} = (7.800 - 8.200 - 0.650) \\times 10^{3}\\ \\mathrm{\\AA}^{2} = -1.050 \\times 10^{3}\\ \\mathrm{\\AA}^{2}\n$$\n这个负值表示溶剂暴露表面积的减少，这在结合过程中是预期的。这种减少通常被称为埋藏表面积 (BSA)。\n\n现在，我们将 $\\gamma$、$\\Delta A_{\\mathrm{bind}}$ 和 $c$ 的值代入简化的 $\\Delta G_{\\mathrm{np,bind}}$ 方程中。\n$\\gamma = 5.42 \\times 10^{-3}\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$\n$c = 0.92\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}$\n$$\n\\Delta G_{\\mathrm{np,bind}} = (5.42 \\times 10^{-3}\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}) \\times (-1.050 \\times 10^{3}\\ \\mathrm{\\AA}^{2}) - 0.92\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\n$$\n计算第一项：\n$$\n(5.42 \\times 10^{-3}) \\times (-1.050 \\times 10^{3}) = (5.42 \\times -1.050) = -5.691\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\n$$\n现在，减去偏移常数 $c$：\n$$\n\\Delta G_{\\mathrm{np,bind}} = -5.691\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1} - 0.92\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1} = -6.611\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1}\n$$\n问题要求最终答案以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位。我们使用转换因子 $1\\ \\mathrm{kcal} = 4.184\\ \\mathrm{kJ}$。\n$$\n\\Delta G_{\\mathrm{np,bind}}[\\mathrm{kJ}\\,\\mathrm{mol}^{-1}] = -6.611\\ \\mathrm{kcal}\\,\\mathrm{mol}^{-1} \\times 4.184\\ \\frac{\\mathrm{kJ}}{\\mathrm{kcal}}\n$$\n$$\n\\Delta G_{\\mathrm{np,bind}}[\\mathrm{kJ}\\,\\mathrm{mol}^{-1}] = -27.660124\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\n最后，我们按照问题陈述中的指示，将结果四舍五入到四位有效数字。\n$$\n\\Delta G_{\\mathrm{np,bind}} \\approx -27.66\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$",
            "answer": "$$\n\\boxed{-27.66}\n$$"
        },
        {
            "introduction": "基于单个能量项的概念，本实践将探讨如何将它们组合成一个经验性打分函数。练习  将引导您通过最小二乘法，将线性模型拟合到实验结合数据上。这是开发许多广泛使用的数据驱动打分函数的基础技术，它在生物物理特征和预测能力之间架起了一座桥梁。",
            "id": "4599711",
            "problem": "在经验性蛋白质-配体对接中，通常使用线性评分函数，通过一组概括了分子间相互作用的工程化特征，来近似负的标准结合自由能，记作 $-\\Delta G^{\\circ}$。考虑一个形式如下的线性评分函数\n$$\nE(x; w) \\equiv \\sum_{k=0}^{p-1} w_k\\, f_k(x),\n$$\n其中 $f_0(x) \\equiv 1$ 是一个截距特征，$k \\geq 1$ 时的 $f_k(x)$ 是复合物 $x$ 的预计算特征。假设对于复合物 $i \\in \\{1,\\dots,n\\}$，测量值遵循加性噪声模型 $y_i = E(x_i; w) + \\varepsilon_i$，其中 $\\varepsilon_i$ 是独立的、均值为零且方差有限的波动。要求您从第一性原理出发，推导在普通最小二乘法 (OLS) 意义下最小化残差平方和的参数矢量 $w$ 所需的必要最优性条件。您的推导必须从最小二乘目标函数的标量形式定义开始，然后推导出严格的矩阵-矢量形式。\n\n然后，使用具有 $p = 3$ 个特征（一个截距加上两个标准化的相互作用特征）的相同线性模型 $E(x; w)$，将 $w$ 拟合到以下包含 $n = 4$ 个蛋白质-配体复合物的训练集。特征 $f_1$ 和 $f_2$ 已在整个训练集上进行了标准化，使其均值为零，并且被构造成彼此不相关，也与截距不相关：\n- 复合物 $i=1$：$(f_0, f_1, f_2) = (1, -1, -1)$，测量值 $y_1 = 10$ $\\mathrm{kJ/mol}$。\n- 复合物 $i=2$：$(f_0, f_1, f_2) = (1, -1, 1)$，测量值 $y_2 = 14$ $\\mathrm{kJ/mol}$。\n- 复合物 $i=3$：$(f_0, f_1, f_2) = (1, 1, -1)$，测量值 $y_3 = 18$ $\\mathrm{kJ/mol}$。\n- 复合物 $i=4$：$(f_0, f_1, f_2) = (1, 1, 1)$，测量值 $y_4 = 22$ $\\mathrm{kJ/mol}$。\n\n通过最小二乘法拟合 $w$ 后，为一个具有标准化特征 $(f_0, f_1, f_2) = (1, 0.3, -0.7)$ 的新复合物 $x^{\\ast}$ 预测其得分 $E(x^{\\ast}; w)$（可解释为 $-\\Delta G^{\\circ}$）。将您的最终数值预测四舍五入至四位有效数字。以 $\\mathrm{kJ/mol}$ 为单位表示最终能量。",
            "solution": "根据既定的验证标准对用户提供的问题进行评估。\n\n### 第1步：提取已知条件\n-   **模型**：线性评分函数 $E(x; w) \\equiv \\sum_{k=0}^{p-1} w_k\\, f_k(x)$ 近似负的标准结合自由能 $-\\Delta G^{\\circ}$。\n-   **截距**：第一个特征是截距，$f_0(x) \\equiv 1$。\n-   **数据模型**：测量值遵循加性噪声模型，$y_i = E(x_i; w) + \\varepsilon_i$，对于 $i \\in \\{1,\\dots,n\\}$。\n-   **噪声特性**：噪声项 $\\varepsilon_i$ 是独立的、均值为零且方差有限的波动。\n-   **目标**：最小化残差平方和（普通最小二乘法）。\n-   **任务1**：从第一性原理出发，从残差平方和的标量形式开始，推导参数矢量 $w$ 的必要最优性条件，并进而得到矩阵-矢量形式。\n-   **任务2**：将该方法应用于一个特定的数据集。\n    -   特征数量, $p=3$。\n    -   复合物数量, $n=4$。\n    -   特征属性：$f_1$ 和 $f_2$ 经过标准化，均值为零，且彼此之间以及与截距均不相关。\n    -   训练数据：\n        -   复合物 $i=1$：特征矢量 $(f_0, f_1, f_2) = (1, -1, -1)$；测量值 $y_1 = 10 \\ \\mathrm{kJ/mol}$。\n        -   复合物 $i=2$：特征矢量 $(f_0, f_1, f_2) = (1, -1, 1)$；测量值 $y_2 = 14 \\ \\mathrm{kJ/mol}$。\n        -   复合物 $i=3$：特征矢量 $(f_0, f_1, f_2) = (1, 1, -1)$；测量值 $y_3 = 18 \\ \\mathrm{kJ/mol}$。\n        -   复合物 $i=4$：特征矢量 $(f_0, f_1, f_2) = (1, 1, 1)$；测量值 $y_4 = 22 \\ \\mathrm{kJ/mol}$。\n    -   预测任务：为一个特征为 $(f_0, f_1, f_2) = (1, 0.3, -0.7)$ 的新复合物 $x^{\\ast}$ 预测得分 $E(x^{\\ast}; w)$。\n    -   四舍五入：最终的数值预测必须四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学上成立**：该问题描述了使用普通最小二乘法 (OLS) 拟合线性模型，这是统计学和机器学习中一个基础且广泛使用的技术。其在构建用于蛋白质-配体对接的经验性评分函数方面的应用，是生物信息学和计算化学中的标准实践。该问题在科学上是合理的。\n-   **适定性**：该问题是适定的。第一部分要求在线性回归理论中进行标准推导。第二部分为特定情况提供了完整的数据集。给定数据的特征矩阵是满秩的，这保证了OLS问题存在唯一解。\n-   **客观性**：该问题使用精确的数学和科学语言陈述。它没有歧义、主观性和不可形式化的概念。\n\n### 第3步：结论与行动\n该问题有效。它在科学上成立、适定且客观。将提供完整的解答。\n\n### 最优性条件（正规方程）的推导\n\n目标是找到最小化残差平方和 (SSR) 的参数矢量 $w$。第 $i$ 个观测值的残差是测量值 $y_i$ 与模型预测值 $E(x_i; w)$ 之间的差。\n\nSSR，记作 $S(w)$，定义为：\n$$\nS(w) = \\sum_{i=1}^{n} (y_i - E(x_i; w))^2 = \\sum_{i=1}^{n} \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right)^2\n$$\n为找到该函数的最小值，我们必须找到其关于 $w$ 的梯度为零矢量的点。这是必要的最优性条件。我们计算 $S(w)$ 关于每个参数 $w_j$（其中 $j \\in \\{0, 1, \\dots, p-1\\}$）的偏导数。\n\n使用链式法则：\n$$\n\\frac{\\partial S}{\\partial w_j} = \\sum_{i=1}^{n} 2 \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right) \\cdot \\frac{\\partial}{\\partial w_j} \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right)\n$$\n内部项的导数为：\n$$\n\\frac{\\partial}{\\partial w_j} \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right) = 0 - \\frac{\\partial}{\\partial w_j} (w_0 f_0(x_i) + \\dots + w_j f_j(x_i) + \\dots) = -f_j(x_i)\n$$\n将此代回，我们得到：\n$$\n\\frac{\\partial S}{\\partial w_j} = \\sum_{i=1}^{n} 2 \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right) (-f_j(x_i)) = -2 \\sum_{i=1}^{n} f_j(x_i) \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right)\n$$\n对每个 $j$ 将此偏导数设为零：\n$$\n\\sum_{i=1}^{n} f_j(x_i) \\left(y_i - \\sum_{k=0}^{p-1} w_k f_k(x_i)\\right) = 0\n$$\n整理各项：\n$$\n\\sum_{i=1}^{n} f_j(x_i) y_i = \\sum_{i=1}^{n} f_j(x_i) \\left(\\sum_{k=0}^{p-1} w_k f_k(x_i)\\right)\n$$\n这个方程可以改写为：\n$$\n\\sum_{k=0}^{p-1} \\left(\\sum_{i=1}^{n} f_j(x_i) f_k(x_i)\\right) w_k = \\sum_{i=1}^{n} f_j(x_i) y_i\n$$\n这代表一个包含 $p$ 个未知数（$w_0, \\dots, w_{p-1}$）的 $p$ 个线性方程组。\n\n为了以矩阵-矢量形式表示，我们定义：\n-   设计矩阵 $X$，一个 $n \\times p$ 矩阵，其元素为 $X_{ik} = f_k(x_i)$。\n-   响应矢量 $y$，一个包含元素 $y_i$ 的 $n \\times 1$ 列矢量。\n-   参数矢量 $w$，一个包含元素 $w_k$ 的 $p \\times 1$ 列矢量。\n$$\nX = \\begin{pmatrix}\nf_0(x_1)  \\dots  f_{p-1}(x_1) \\\\\n\\vdots  \\ddots  \\vdots \\\\\nf_0(x_n)  \\dots  f_{p-1}(x_n)\n\\end{pmatrix}, \\quad\ny = \\begin{pmatrix} y_1 \\\\ \\vdots \\\\ y_n \\end{pmatrix}, \\quad\nw = \\begin{pmatrix} w_0 \\\\ \\vdots \\\\ w_{p-1} \\end{pmatrix}\n$$\n预测值矢量为 $\\hat{y} = Xw$，残差矢量为 $r = y - \\hat{y} = y - Xw$。\nSSR 是残差矢量的欧几里得范数的平方：\n$$\nS(w) = r^T r = (y - Xw)^T (y - Xw)\n$$\n展开此表达式：\n$$\nS(w) = (y^T - w^T X^T)(y - Xw) = y^T y - y^T X w - w^T X^T y + w^T X^T X w\n$$\n由于 $w^T X^T y$ 是一个标量，它等于其转置，即 $(w^T X^T y)^T = y^T X w$。所以我们可以合并中间两项：\n$$\nS(w) = y^T y - 2 w^T X^T y + w^T X^T X w\n$$\n对矢量 $w$ 求梯度（使用矩阵微积分恒等式 $\\nabla_v(v^T a) = a$ 和 $\\nabla_v(v^T A v) = 2Av$（对于对称矩阵 $A$），并注意到 $X^T X$ 是对称的）：\n$$\n\\nabla_w S(w) = -2X^T y + 2X^T X w\n$$\n将梯度设为零，得到最小值的必要条件：\n$$\n-2X^T y + 2X^T X w = 0 \\implies X^T X w = X^T y\n$$\n这就是著名的正规方程，即最优性条件的矩阵-矢量形式。\n\n### 应用于数据集\n\n对于给定的问题，$n=4$ 且 $p=3$。设计矩阵 $X$ 和响应矢量 $y$ 由所提供的数据构建：\n$$\nX = \\begin{pmatrix}\n1  -1  -1 \\\\\n1  -1  1 \\\\\n1  1  -1 \\\\\n1  1  1\n\\end{pmatrix}, \\quad\ny = \\begin{pmatrix} 10 \\\\ 14 \\\\ 18 \\\\ 22 \\end{pmatrix}\n$$\n待求的参数矢量为 $w = (w_0, w_1, w_2)^T$。我们现在求解正规方程 $X^T X w = X^T y$。\n\n首先，计算 $X^T X$：\n$$\nX^T X = \\begin{pmatrix}\n1  1  1  1 \\\\\n-1  -1  1  1 \\\\\n-1  1  -1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  -1  -1 \\\\\n1  -1  1 \\\\\n1  1  -1 \\\\\n1  1  1\n\\end{pmatrix} = \\begin{pmatrix}\n4  0  0 \\\\\n0  4  0 \\\\\n0  0  4\n\\end{pmatrix} = 4I_3\n$$\n矩阵 $X^T X$ 是对角矩阵，因为 $X$ 的列是相互正交的，这是由于特征 $f_1$ 和 $f_2$ 在此训练集上是均值中心化且不相关的结果。\n\n接下来，计算 $X^T y$：\n$$\nX^T y = \\begin{pmatrix}\n1  1  1  1 \\\\\n-1  -1  1  1 \\\\\n-1  1  -1  1\n\\end{pmatrix}\n\\begin{pmatrix} 10 \\\\ 14 \\\\ 18 \\\\ 22 \\end{pmatrix} = \\begin{pmatrix}\n1(10) + 1(14) + 1(18) + 1(22) \\\\\n-1(10) - 1(14) + 1(18) + 1(22) \\\\\n-1(10) + 1(14) - 1(18) + 1(22)\n\\end{pmatrix} = \\begin{pmatrix}\n64 \\\\\n16 \\\\\n8\n\\end{pmatrix}\n$$\n正规方程变为：\n$$\n\\begin{pmatrix}\n4  0  0 \\\\\n0  4  0 \\\\\n0  0  4\n\\end{pmatrix}\n\\begin{pmatrix} w_0 \\\\ w_1 \\\\ w_2 \\end{pmatrix} =\n\\begin{pmatrix} 64 \\\\ 16 \\\\ 8 \\end{pmatrix}\n$$\n这个方程组很容易求解：\n-   $4w_0 = 64 \\implies w_0 = 16$\n-   $4w_1 = 16 \\implies w_1 = 4$\n-   $4w_2 = 8 \\implies w_2 = 2$\n\n因此，最优参数矢量为 $w = (16, 4, 2)^T$。拟合的评分函数为 $E(x; w) = 16 + 4f_1(x) + 2f_2(x)$。\n\n### 对新复合物的预测\n\n我们需要为一个特征矢量为 $f^{\\ast} = (f_0, f_1, f_2)^T = (1, 0.3, -0.7)^T$ 的新复合物 $x^{\\ast}$ 预测得分。预测得分为 $E(x^{\\ast}; w) = (f^{\\ast})^T w$。\n$$\nE(x^{\\ast}; w) = \\begin{pmatrix} 1  0.3  -0.7 \\end{pmatrix} \\begin{pmatrix} 16 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n$$\nE(x^{\\ast}; w) = 1 \\cdot 16 + 0.3 \\cdot 4 + (-0.7) \\cdot 2 = 16 + 1.2 - 1.4 = 15.8\n$$\n问题规定最终的数值预测必须四舍五入到四位有效数字。预测的能量为 $15.8 \\ \\mathrm{kJ/mol}$。表示为四位有效数字，即为 $15.80 \\ \\mathrm{kJ/mol}$。",
            "answer": "$$\n\\boxed{15.80}\n$$"
        },
        {
            "introduction": "虽然简单的模型很有用，但真实的生物系统表现出更大的复杂性，例如分子的pH依赖行为。这项高级实践  解决了质子化状态这一关键问题，它深刻影响着静电相互作用。通过计算由不同微观状态概率加权的平均静电分数，您将学习如何将关键的化学真实性融入到您的打分模型中。",
            "id": "4599800",
            "problem": "一个小分子配体结合在蛋白质口袋中两个可电离残基附近。该配体有两个可滴定位点：一个伯胺，记作 $\\mathrm{N}$，其酸解离常数 $pK_{a}^{\\mathrm{N}} = 8.8$；一个羧酸，记作 $\\mathrm{C}$，其 $pK_{a}^{\\mathrm{C}} = 4.6$。在生理条件下，该蛋白质呈现出两个质子化状态固定的邻近侧链：一个去质子化的天冬氨酸 $\\mathrm{D1}$（形式电荷 $q_{\\mathrm{D1}} = -1$）和一个质子化的赖氨酸 $\\mathrm{K2}$（形式电荷 $q_{\\mathrm{K2}} = +1$），此时 $\\mathrm{pH} = 7.4$。配体位点与蛋白质侧链之间的中心间距离为 $r_{\\mathrm{N,D1}} = 3.0\\,\\mathrm{\\AA}$、$r_{\\mathrm{N,K2}} = 6.5\\,\\mathrm{\\AA}$、$r_{\\mathrm{C,D1}} = 6.0\\,\\mathrm{\\AA}$ 和 $r_{\\mathrm{C,K2}} = 2.8\\,\\mathrm{\\AA}$。假设口袋环境的均匀有效相对介电常数为 $\\epsilon_{r} = 20$。\n\n仅以 Henderson–Hasselbalch 关系式和库仑定律为出发点，通过对配体位点和蛋白质侧链之间的归一化成对库仑相互作用求和，来为对接分数的静电分量建模：\n$$\nS \\;=\\; \\sum_{\\text{pairs }(i,j)} \\frac{q_{i}\\,q_{j}}{\\epsilon_{r}\\, r_{ij}},\n$$\n其中 $q_{i}$ 和 $q_{j}$ 是相互作用位点的形式电荷（以元电荷为单位），$r_{ij}$ 是它们之间的距离（以 $\\mathrm{\\AA}$ 为单位）。将 $\\mathrm{N}$（一个布朗斯特碱）和 $\\mathrm{C}$（一个布朗斯特酸）的质子化视为独立的。枚举由 $\\mathrm{N} \\in \\{\\mathrm{N^{+}}, \\mathrm{N^{0}}\\}$ 和 $\\mathrm{C} \\in \\{\\mathrm{C^{-}}, \\mathrm{C^{0}}\\}$ 定义的四种微观状态，其中 $\\mathrm{N^{+}}$ 带电荷 $q_{\\mathrm{N}} = +1$，$\\mathrm{N^{0}}$ 带电荷 $q_{\\mathrm{N}} = 0$，$\\mathrm{C^{-}}$ 带电荷 $q_{\\mathrm{C}} = -1$，$\\mathrm{C^{0}}$ 带电荷 $q_{\\mathrm{C}} = 0$。\n\n在 $\\mathrm{pH} = 7.4$ 时，使用 Henderson–Hasselbalch 关系式计算每种微观状态的占据概率，然后计算其分数 $S$。最后，计算在 $\\mathrm{pH} = 7.4$ 时的占据概率加权期望分数，\n$$\nS_{\\mathrm{avg}} \\;=\\; \\sum_{\\text{microstates }m} P(m)\\,S(m),\n$$\n将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个配体在蛋白质口袋中结合时的占据概率加权平均静电分数 $S_{\\mathrm{avg}}$。该配体具有两个可滴定位点：一个伯胺 $\\mathrm{N}$ 和一个羧酸 $\\mathrm{C}$。它与两个带电的蛋白质残基相互作用：一个天冬氨酸 $\\mathrm{D1}$（电荷 $q_{\\mathrm{D1}} = -1$）和一个赖氨酸 $\\mathrm{K2}$（电荷 $q_{\\mathrm{K2}} = +1$）。计算过程包括在给定的 $\\mathrm{pH}$ 值下确定配体不同质子化状态（微观状态）的概率，然后用其概率对每个微观状态的静电分数进行加权。\n\n对于一个可滴定基团，其给定质子化状态的概率由 Henderson–Hasselbalch 方程决定。对于一个通用的酸解离平衡 $\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}$，该方程为：\n$$\n\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10} \\left( \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]} \\right)\n$$\n由此，我们可以推导出质子化（酸）形式的概率（或分数占据率）$P(\\mathrm{HA})$ 和去质子化（碱）形式的概率 $P(\\mathrm{A}^{-})$：\n$$\nP(\\mathrm{HA}) = \\frac{1}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}}\n$$\n$$\nP(\\mathrm{A}^{-}) = \\frac{10^{\\mathrm{pH} - \\mathrm{p}K_a}}{1 + 10^{\\mathrm{pH} - \\mathrm{p}K_a}}\n$$\n\n我们将这些公式应用于 $\\mathrm{pH} = 7.4$ 时的两个配体位点。\n\n对于伯胺位点 $\\mathrm{N}$，相关的平衡是其共轭酸 $\\mathrm{N}^{+}$ 解离为中性碱 $\\mathrm{N}^{0}$：$\\mathrm{N}^{+} \\rightleftharpoons \\mathrm{N}^{0} + \\mathrm{H}^{+}$。给定的酸解离常数为 $pK_{a}^{\\mathrm{N}} = 8.8$。质子化形式 $\\mathrm{N}^{+}$ 的电荷为 $q_{\\mathrm{N}} = +1$。其概率为：\n$$\nP(\\mathrm{N}^{+}) = \\frac{1}{1 + 10^{\\mathrm{pH} - pK_{a}^{\\mathrm{N}}}} = \\frac{1}{1 + 10^{7.4 - 8.8}} = \\frac{1}{1 + 10^{-1.4}}\n$$\n去质子化形式 $\\mathrm{N}^{0}$ 的电荷为 $q_{\\mathrm{N}} = 0$。\n\n对于羧酸位点 $\\mathrm{C}$，平衡是中性酸 $\\mathrm{C}^{0}$ 解离为共轭碱 $\\mathrm{C}^{-}$：$\\mathrm{C}^{0} \\rightleftharpoons \\mathrm{C}^{-} + \\mathrm{H}^{+}$。给定的酸解离常数为 $pK_{a}^{\\mathrm{C}} = 4.6$。去质子化形式 $\\mathrm{C}^{-}$ 的电荷为 $q_{\\mathrm{C}} = -1$。其概率为：\n$$\nP(\\mathrm{C}^{-}) = \\frac{10^{\\mathrm{pH} - pK_{a}^{\\mathrm{C}}}}{1 + 10^{\\mathrm{pH} - pK_{a}^{\\mathrm{C}}}} = \\frac{10^{7.4 - 4.6}}{1 + 10^{7.4 - 4.6}} = \\frac{10^{2.8}}{1 + 10^{2.8}}\n$$\n质子化形式 $\\mathrm{C}^{0}$ 的电荷为 $q_{\\mathrm{C}} = 0$。\n\n对于任何给定的具有配体电荷 $q_\\mathrm{N}$ 和 $q_\\mathrm{C}$ 的微观状态，其静电分数 $S$ 由下式给出：\n$$\nS(q_\\mathrm{N}, q_\\mathrm{C}) = \\sum_{\\text{pairs }(i,j)} \\frac{q_{i}\\,q_{j}}{\\epsilon_{r}\\, r_{ij}} = \\frac{q_\\mathrm{N} q_{\\mathrm{D1}}}{\\epsilon_r r_{\\mathrm{N,D1}}} + \\frac{q_\\mathrm{N} q_{\\mathrm{K2}}}{\\epsilon_r r_{\\mathrm{N,K2}}} + \\frac{q_\\mathrm{C} q_{\\mathrm{D1}}}{\\epsilon_r r_{\\mathrm{C,D1}}} + \\frac{q_\\mathrm{C} q_{\\mathrm{K2}}}{\\epsilon_r r_{\\mathrm{C,K2}}}\n$$\n这个表达式可以通过提取配体电荷因子来重新排列：\n$$\nS(q_\\mathrm{N}, q_\\mathrm{C}) = \\frac{1}{\\epsilon_r} \\left[ q_\\mathrm{N} \\left( \\frac{q_{\\mathrm{D1}}}{r_{\\mathrm{N,D1}}} + \\frac{q_{\\mathrm{K2}}}{r_{\\mathrm{N,K2}}} \\right) + q_\\mathrm{C} \\left( \\frac{q_{\\mathrm{D1}}}{r_{\\mathrm{C,D1}}} + \\frac{q_{\\mathrm{K2}}}{r_{\\mathrm{C,K2}}} \\right) \\right]\n$$\n让我们将由固定的蛋白质电荷在配体位点 $\\mathrm{N}$ 和 $\\mathrm{C}$ 处产生的静电势（单位为元电荷每 $\\mathrm{\\AA}$）分别定义为 $V_\\mathrm{N}$ 和 $V_\\mathrm{C}$：\n$$\nV_\\mathrm{N} = \\frac{q_{\\mathrm{D1}}}{r_{\\mathrm{N,D1}}} + \\frac{q_{\\mathrm{K2}}}{r_{\\mathrm{N,K2}}} \\quad \\text{和} \\quad V_\\mathrm{C} = \\frac{q_{\\mathrm{D1}}}{r_{\\mathrm{C,D1}}} + \\frac{q_{\\mathrm{K2}}}{r_{\\mathrm{C,K2}}}\n$$\n那么分数就是 $S(q_\\mathrm{N}, q_\\mathrm{C}) = \\frac{1}{\\epsilon_r} (q_\\mathrm{N} V_\\mathrm{N} + q_\\mathrm{C} V_\\mathrm{C})$。\n\n平均分数 $S_{\\mathrm{avg}}$ 是期望值 $\\langle S \\rangle$。由于位点 $\\mathrm{N}$ 和 $\\mathrm{C}$ 的质子化事件是独立的，我们可以使用期望的线性性质：\n$$\nS_{\\mathrm{avg}} = \\left\\langle \\frac{1}{\\epsilon_r} (q_\\mathrm{N} V_\\mathrm{N} + q_\\mathrm{C} V_\\mathrm{C}) \\right\\rangle = \\frac{1}{\\epsilon_r} ( \\langle q_\\mathrm{N} \\rangle V_\\mathrm{N} + \\langle q_\\mathrm{C} \\rangle V_\\mathrm{C} )\n$$\n其中 $\\langle q_\\mathrm{N} \\rangle$ 和 $\\langle q_\\mathrm{C} \\rangle$ 是配体位点的平均电荷。\n\n位点 $\\mathrm{N}$ 的平均电荷是每种可能电荷乘以其概率的总和：\n$$\n\\langle q_\\mathrm{N} \\rangle = (+1) \\cdot P(\\mathrm{N}^{+}) + (0) \\cdot P(\\mathrm{N}^{0}) = P(\\mathrm{N}^{+}) = \\frac{1}{1 + 10^{-1.4}}\n$$\n位点 $\\mathrm{C}$ 的平均电荷是：\n$$\n\\langle q_\\mathrm{C} \\rangle = (-1) \\cdot P(\\mathrm{C}^{-}) + (0) \\cdot P(\\mathrm{C}^{0}) = -P(\\mathrm{C}^{-}) = -\\frac{10^{2.8}}{1 + 10^{2.8}}\n$$\n\n我们现在将给定的数值代入表达式中。介电常数为 $\\epsilon_r = 20$。\n电势 $V_\\mathrm{N}$ 和 $V_\\mathrm{C}$ 为：\n$$\nV_\\mathrm{N} = \\frac{-1}{3.0} + \\frac{1}{6.5} = \\frac{-6.5 + 3.0}{19.5} = -\\frac{3.5}{19.5} \\approx -0.179487\\,\\mathrm{\\AA}^{-1}\n$$\n$$\nV_\\mathrm{C} = \\frac{-1}{6.0} + \\frac{1}{2.8} = \\frac{-2.8 + 6.0}{16.8} = \\frac{3.2}{16.8} \\approx 0.190476\\,\\mathrm{\\AA}^{-1}\n$$\n平均电荷为：\n$$\n\\langle q_\\mathrm{N} \\rangle = \\frac{1}{1 + 10^{-1.4}} \\approx \\frac{1}{1 + 0.039811} \\approx 0.961713\n$$\n$$\n\\langle q_\\mathrm{C} \\rangle = -\\frac{10^{2.8}}{1 + 10^{2.8}} \\approx -\\frac{630.957}{1 + 630.957} \\approx -0.998418\n$$\n现在，我们计算 $S_{\\mathrm{avg}}$：\n$$\nS_{\\mathrm{avg}} = \\frac{1}{20} \\left[ (0.961713) \\cdot \\left(-\\frac{3.5}{19.5}\\right) + (-0.998418) \\cdot \\left(\\frac{3.2}{16.8}\\right) \\right]\n$$\n$$\nS_{\\mathrm{avg}} \\approx \\frac{1}{20} [ (0.961713) \\cdot (-0.179487) + (-0.998418) \\cdot (0.190476) ]\n$$\n$$\nS_{\\mathrm{avg}} \\approx \\frac{1}{20} [ -0.172610 - 0.190176 ] = \\frac{-0.362786}{20} = -0.0181393\n$$\n将结果四舍五入到四位有效数字得到 $-0.01814$。\n\n计算的最终表达式：\n$$ S_{\\mathrm{avg}} = \\frac{1}{20} \\left[ \\left( \\frac{1}{1+10^{7.4-8.8}} \\right) \\left( \\frac{-1}{3.0} + \\frac{1}{6.5} \\right) + \\left( - \\frac{10^{7.4-4.6}}{1+10^{7.4-4.6}} \\right) \\left( \\frac{-1}{6.0} + \\frac{1}{2.8} \\right) \\right] \\approx -0.01814 $$",
            "answer": "$$\n\\boxed{-0.01814}\n$$"
        }
    ]
}