{
    "hands_on_practices": [
        {
            "introduction": "本练习将侧重于有向无环图（DAGs）的一个核心概念：d-分离。我们将特别探讨“对撞节点”（即两个箭头指向的节点）的独特作用。理解以对撞节点为条件如何影响变量间的关联，是正确识别和避免因果模型中伪相关的基础。本练习为这条非直观但至关重要的规则提供了一个具体的检验。",
            "id": "4557701",
            "problem": "在一项医疗数据的因果分析中，考虑一个有向无环图 (DAG)，该图代表了转化生物信息学中的一个简化路径。其中 $X$ 表示遗传变异，$Y$ 表示环境暴露，$Z$ 表示分子生物标志物，$W$ 表示下游临床结果。该 DAG 的节点集为 $\\{X, Y, Z, W\\}$，有向边为 $X \\to Z$，$Y \\to Z$ 和 $Z \\to W$，无其他边。使用有向无环图中 $d$-分离的形式化定义，按以下步骤进行：\n\n- 枚举 $X$ 和 $Y$ 之间的所有简单路径（无重复节点的路径）。\n- 对于 $X$ 和 $Y$ 之间的每条简单路径 $p$，定义一个指示符 $I(p)$：如果该路径在以 $Z$ 为条件时根据 $d$-分离被阻断，则 $I(p) = 1$；否则 $I(p) = 0$。\n- 定义量 $D$ 为\n$$\nD \\;=\\; \\prod_{p \\in \\mathcal{P}(X,Y)} I(p),\n$$\n其中 $\\mathcal{P}(X,Y)$ 是 $X$ 和 $Y$ 之间所有简单路径的集合。\n\n计算 $D$ 的值。最终答案必须是单个实数。不需要四舍五入，也不包含任何单位。",
            "solution": "该问题要求计算一个量 $D$，该量与指定有向无环图 (DAG) 中的 $d$-分离概念相关。我们必须首先验证问题陈述的有效性。\n\n问题给出了以下已知条件：\n- 一组节点 $V = \\{X, Y, Z, W\\}$，分别代表遗传变异 ($X$)、环境暴露 ($Y$)、分子生物标志物 ($Z$) 和临床结果 ($W$)。\n- 一组有向边 $E = \\{(X,Z), (Y,Z), (Z,W)\\}$，对应于图结构 $X \\to Z$、$Y \\to Z$ 和 $Z \\to W$。\n- 图中不存在其他边的约束。\n- 对于 $X$ 和 $Y$ 之间的任意简单路径 $p$，定义了指示函数 $I(p)$。如果路径 $p$ 在以 $Z$ 为条件时被阻断，则 $I(p)=1$；否则 $I(p)=0$。\n- 定义了量 $D = \\prod_{p \\in \\mathcal{P}(X,Y)} I(p)$，其中 $\\mathcal{P}(X,Y)$ 是 $X$ 和 $Y$ 之间所有简单路径的集合。\n\n该问题具有科学依据，因为它使用了图模型和因果推断理论中的标准、明确定义的概​​念，特别是 DAG 和 $d$-分离。其结构和变量是生物信息学中简化模型的典型代表。该问题是适定 (well-posed) 的，具有完全指定的图和明确的目标。它是客观、完整且无矛盾的。因此，该问题被认为是有效的，我们可以继续求解。\n\n求解过程包括三个步骤：\n1.  识别 $X$ 和 $Y$ 之间的所有简单路径的集合，记为 $\\mathcal{P}(X,Y)$。\n2.  对于此集合中的每条路径，确定其在以 $Z$ 为条件时是否被阻断。\n3.  根据这些确定结果计算 $D$ 的值。\n\n步骤 1：枚举 $X$ 和 $Y$ 之间的简单路径。\n图中的路径是由边连接的节点序列，在路径遍历中不考虑边的方向。简单路径是指不包含重复节点的路径。\n图结构由边 $X \\to Z$，$Y \\to Z$ 和 $Z \\to W$ 给出。\n要找到从 $X$到 $Y$ 的路径，我们从 $X$ 开始。与 $X$ 相邻的唯一节点是 $Z$。从 $Z$ 出发，相邻的节点是 $X$、$Y$ 和 $W$。为了在不重复节点的情况下到达 $Y$，从 $Z$ 出发的唯一可能下一步是到 $Y$。\n因此，$X$ 和 $Y$ 之间只有一条简单路径：路径 $p_1 = (X, Z, Y)$。\n所有简单路径的集合是 $\\mathcal{P}(X,Y) = \\{p_1\\}$。\n\n步骤 2：对路径 $p_1$ 应用 $d$-分离 规则。\n路径 $p_1 = (X, Z, Y)$ 由边 $X \\to Z$ 和 $Y \\to Z$ 组成。当看作路径的一部分时，该结构为 $X \\to Z \\leftarrow Y$。\n在 $d$-分离的术语中，节点 $Z$ 在这条路径上是一个 **对撞节点 (collider)**，因为有两个箭头在 $Z$ 处相遇。\n\n路径被条件集 $S$ 阻断的规则如下：\n如果一条路径包含一个节点 $N$，满足以下条件之一，则该路径被阻断：\n(a) $N$ 是路径上的一个链式节点 ($\\to N \\to$) 或分叉节点 ($\\leftarrow N \\to$)，并且 $N \\in S$。\n(b) $N$ 是路径上的一个对撞节点 ($\\to N \\leftarrow$)，并且 $N$ 及其任何后代都不在 $S$ 中。\n\n我们需要确定路径 $p_1$ 在以集合 $S = \\{Z\\}$ 为条件时是否被阻断。\n路径 $p_1$ 包含对撞节点 $Z$。我们应用规则 (b)。\n要使路径被对撞节点阻断，条件是对撞节点本身 ($Z$) 及其任何后代都不能在条件集 $S$ 中。\n在本例中，条件集是 $S = \\{Z\\}$。对撞节点 $Z$ 本身就在条件集中。\n因此，路径被阻断的条件未被满足。未被阻断的路径被称为是开放的或未阻断的。\n以一个对撞节点（或其后代之一）为条件会打开关联路径。\n所以，路径 $p_1$ 在以 $Z$ 为条件时 **没有被阻断**。\n\n步骤 3：计算 $D$ 的值。\n指示函数 $I(p)$ 的定义是：如果路径 $p$ 被阻断，则 $I(p)=1$；否则 $I(p)=0$。\n对于我们的路径 $p_1$，因为它在以 $Z$ 为条件时没有被阻断，所以指示符的值为 $I(p_1) = 0$。\n\n量 $D$ 是 $X$ 和 $Y$ 之间所有简单路径上这些指示符值的乘积。\n$$\nD = \\prod_{p \\in \\mathcal{P}(X,Y)} I(p)\n$$\n由于 $\\mathcal{P}(X,Y) = \\{p_1\\}$，这个乘积简化为：\n$$\nD = I(p_1)\n$$\n代入我们找到的 $I(p_1)$ 的值：\n$$\nD = 0\n$$\n最终值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在d-分离概念的基础上，本题将从定性的图规则转向定量分析。我们将研究一个经典的“M型结构”DAG，在这种常见情景中，当我们对未观测因素的共同效应进行条件化时，会产生一个伪关联。通过在线性模型中从第一性原理推导条件协方差，您将对对撞分层偏倚（collider stratification bias）如何产生并扭曲统计关系获得更深刻的数学理解。",
            "id": "4557747",
            "problem": "考虑一个生物信息学和医学数据分析流程，其中基因表达 $X$ 和临床结果严重性评分 $Y$ 在存在一个已测量的质量控制变量 $C$ 和两个未观测到的生物学因素 $U$ 和 $V$ 的情况下进行分析。假设存在如下的有向无环图 (DAG)：$X \\leftarrow U \\to C \\leftarrow V \\to Y$，其中 $X$ 到 $Y$ 没有直接的因果边 $(X \\not\\to Y)$，且 $U$ 和 $V$ 是未观测到的。变量 $U$ 代表一个未测量的细胞类型组成因子，它同时影响 $X$ 和 $C$；而 $V$ 代表一个未测量的炎症状态，它同时影响 $C$ 和 $Y$。设该系统由一个具有独立外生分量的线性高斯结构方程模型 (SEM) 控制：\n- $U \\sim \\mathcal{N}(0,\\sigma_{U}^{2})$ 且 $V \\sim \\mathcal{N}(0,\\sigma_{V}^{2})$，其中 $U$ 和 $V$ 相互独立。\n- $\\varepsilon_{X} \\sim \\mathcal{N}(0,\\sigma_{X}^{2})$，$\\varepsilon_{C} \\sim \\mathcal{N}(0,\\sigma_{C}^{2})$ 及 $\\varepsilon_{Y} \\sim \\mathcal{N}(0,\\sigma_{Y}^{2})$，它们相互独立，且独立于 $U$ 和 $V$。\n- 线性结构方程：$X = \\alpha U + \\varepsilon_{X}$，$C = \\beta U + \\gamma V + \\varepsilon_{C}$ 及 $Y = \\delta V + \\varepsilon_{Y}$。\n\n从有向无环图的核心定义和多元高斯模型的性质出发，推导出无条件协方差 $\\operatorname{Cov}(X,Y)$，然后通过量化对撞击节点 $C$ 进行条件化的效应，推导出以参数 $\\alpha, \\beta, \\gamma, \\delta, \\sigma_{U}^{2}, \\sigma_{V}^{2}$ 和 $\\sigma_{C}^{2}$ 表示的条件协方差 $\\operatorname{Cov}(X,Y \\mid C)$。您的推导必须基于第一性原理（多元正态变量的条件分布和线性投影），不得假设任何预先给定的简化公式。请以 $\\operatorname{Cov}(X,Y \\mid C)$ 的单个闭式解析表达式形式提供您的最终答案。不需要数值近似，也不需要单位。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于结构方程模型（SEM）和多元高斯分布的成熟理论，这些是因果推断和生物统计学中的标准工具。该问题设定良好，具有完整且一致的定义和参数，确保可以推导出唯一的解析解。语言客观且正式。因此，我们进行完整推导。\n\n该问题描述了一个由随机变量 $(X, Y, C, U, V)$ 组成的系统。变量 $X, Y, C$ 被定义为独立的、零均值高斯随机变量 $U, V, \\varepsilon_{X}, \\varepsilon_{C}, \\varepsilon_{Y}$ 的线性组合。高斯变量的线性组合本身也是高斯分布。因此，可观测变量向量 $(X, Y, C)^T$ 服从均值向量为零的多元正态分布，因为所有构成变量的均值都为零。我们将此向量表示为 $\\mathbf{Z} = (X, Y, C)^T$。该系统的性质完全由其协方差矩阵 $\\Sigma_{\\mathbf{Z}}$ 决定。\n\n首先，我们按要求推导无条件协方差 $\\operatorname{Cov}(X,Y)$。这是协方差矩阵 $\\Sigma_{\\mathbf{Z}}$ 的一个元素。该矩阵的元素使用协方差算子的线性和指定的独立性条件计算。\n\n结构方程为：\n$X = \\alpha U + \\varepsilon_{X}$\n$Y = \\delta V + \\varepsilon_{Y}$\n$C = \\beta U + \\gamma V + \\varepsilon_{C}$\n\n外生变量的方差和协方差如下：\n$\\operatorname{Var}(U) = \\sigma_{U}^{2}$, $\\operatorname{Var}(V) = \\sigma_{V}^{2}$, $\\operatorname{Var}(\\varepsilon_{X}) = \\sigma_{X}^{2}$, $\\operatorname{Var}(\\varepsilon_{C}) = \\sigma_{C}^{2}$, $\\operatorname{Var}(\\varepsilon_{Y}) = \\sigma_{Y}^{2}$。\n所有外生变量（$U, V, \\varepsilon_{X}, \\varepsilon_{C}, \\varepsilon_{Y}$）都是相互独立的。\n\n我们计算协方差矩阵 $\\Sigma_{\\mathbf{Z}}$ 的元素：\n方差（对角元素）：\n$\\operatorname{Var}(X) = \\operatorname{Cov}(\\alpha U + \\varepsilon_{X}, \\alpha U + \\varepsilon_{X}) = \\alpha^2 \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{X}) = \\alpha^2\\sigma_{U}^{2} + \\sigma_{X}^{2}$。\n$\\operatorname{Var}(Y) = \\operatorname{Cov}(\\delta V + \\varepsilon_{Y}, \\delta V + \\varepsilon_{Y}) = \\delta^2 \\operatorname{Var}(V) + \\operatorname{Var}(\\varepsilon_{Y}) = \\delta^2\\sigma_{V}^{2} + \\sigma_{Y}^{2}$。\n$\\operatorname{Var}(C) = \\operatorname{Cov}(\\beta U + \\gamma V + \\varepsilon_{C}, \\beta U + \\gamma V + \\varepsilon_{C}) = \\beta^2 \\operatorname{Var}(U) + \\gamma^2 \\operatorname{Var}(V) + \\operatorname{Var}(\\varepsilon_{C}) = \\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}$。\n\n协方差（非对角元素）：\n$\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(\\alpha U + \\varepsilon_{X}, \\delta V + \\varepsilon_{Y}) = \\alpha\\delta\\operatorname{Cov}(U,V) + \\alpha\\operatorname{Cov}(U,\\varepsilon_{Y}) + \\delta\\operatorname{Cov}(\\varepsilon_{X},V) + \\operatorname{Cov}(\\varepsilon_{X},\\varepsilon_{Y})$。\n由于所有外生变量的独立性，所有这些协方差项都为零。\n$$ \\operatorname{Cov}(X, Y) = 0 $$\n这个结果与有向无环图理论中的d-分离准则一致。$X$ 和 $Y$ 之间的唯一路径是 $X \\leftarrow U \\to C \\leftarrow V \\to Y$，该路径被冲撞节点 $C$ 阻断。因此，$X$ 和 $Y$ 是无条件独立的。\n\n$\\operatorname{Cov}(X, C) = \\operatorname{Cov}(\\alpha U + \\varepsilon_{X}, \\beta U + \\gamma V + \\varepsilon_{C}) = \\alpha\\beta\\operatorname{Var}(U) = \\alpha\\beta\\sigma_{U}^{2}$。\n$\\operatorname{Cov}(Y, C) = \\operatorname{Cov}(\\delta V + \\varepsilon_{Y}, \\beta U + \\gamma V + \\varepsilon_{C}) = \\gamma\\delta\\operatorname{Var}(V) = \\gamma\\delta\\sigma_{V}^{2}$。\n\n因此，$\\mathbf{Z} = (X, Y, C)^T$ 的完整协方差矩阵为：\n$$\n\\Sigma_{\\mathbf{Z}} =\n\\begin{pmatrix}\n\\alpha^2\\sigma_{U}^{2} + \\sigma_{X}^{2} & 0 & \\alpha\\beta\\sigma_{U}^{2} \\\\\n0 & \\delta^2\\sigma_{V}^{2} + \\sigma_{Y}^{2} & \\gamma\\delta\\sigma_{V}^{2} \\\\\n\\alpha\\beta\\sigma_{U}^{2} & \\gamma\\delta\\sigma_{V}^{2} & \\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}\n\\end{pmatrix}\n$$\n为了求条件协方差 $\\operatorname{Cov}(X,Y \\mid C)$，我们使用分块多元正态向量的条件协方差矩阵公式。我们将向量 $\\mathbf{Z}$ 划分为 $\\mathbf{Z}_1 = (X, Y)^T$ 和 $\\mathbf{Z}_2 = (C)$。协方差矩阵 $\\Sigma_{\\mathbf{Z}}$ 也相应地进行分块：\n$$\n\\Sigma_{\\mathbf{Z}} = \\begin{pmatrix} \\Sigma_{11} & \\Sigma_{12} \\\\ \\Sigma_{21} & \\Sigma_{22} \\end{pmatrix}\n$$\n其中\n$\\Sigma_{11} = \\operatorname{Cov}(\\mathbf{Z}_1) = \\begin{pmatrix} \\operatorname{Var}(X) & \\operatorname{Cov}(X,Y) \\\\ \\operatorname{Cov}(Y,X) & \\operatorname{Var}(Y) \\end{pmatrix} = \\begin{pmatrix} \\alpha^2\\sigma_{U}^{2} + \\sigma_{X}^{2} & 0 \\\\ 0 & \\delta^2\\sigma_{V}^{2} + \\sigma_{Y}^{2} \\end{pmatrix}$\n\n$\\Sigma_{12} = \\operatorname{Cov}(\\mathbf{Z}_1, \\mathbf{Z}_2) = \\begin{pmatrix} \\operatorname{Cov}(X,C) \\\\ \\operatorname{Cov}(Y,C) \\end{pmatrix} = \\begin{pmatrix} \\alpha\\beta\\sigma_{U}^{2} \\\\ \\gamma\\delta\\sigma_{V}^{2} \\end{pmatrix}$\n\n$\\Sigma_{21} = \\operatorname{Cov}(\\mathbf{Z}_2, \\mathbf{Z}_1) = \\Sigma_{12}^T = \\begin{pmatrix} \\alpha\\beta\\sigma_{U}^{2} & \\gamma\\delta\\sigma_{V}^{2} \\end{pmatrix}$\n\n$\\Sigma_{22} = \\operatorname{Var}(\\mathbf{Z}_2) = \\operatorname{Var}(C) = \\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}$\n\n对于多元正态分布，$\\mathbf{Z}_1$ 在给定 $\\mathbf{Z}_2$ 条件下的协方差矩阵由 $\\Sigma_{\\mathbf{Z}}$ 中 $\\Sigma_{22}$ 的舒尔补 (Schur complement) 给出：\n$$\n\\operatorname{Cov}(\\mathbf{Z}_1 \\mid \\mathbf{Z}_2) = \\Sigma_{11} - \\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}\n$$\n给定 $C$ 时 $(X,Y)$ 的条件协方差矩阵为 $\\operatorname{Cov}((X,Y)^T \\mid C) = \\begin{pmatrix} \\operatorname{Var}(X \\mid C) & \\operatorname{Cov}(X,Y \\mid C) \\\\ \\operatorname{Cov}(Y,X \\mid C) & \\operatorname{Var}(Y \\mid C) \\end{pmatrix}$。\n由于 $C$ 是一个标量变量，$\\Sigma_{22}^{-1}$ 就是 $C$ 的方差的倒数：\n$\\Sigma_{22}^{-1} = \\frac{1}{\\operatorname{Var}(C)} = \\frac{1}{\\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}}$。\n\n现在我们计算 $\\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}$ 这一项：\n$$\n\\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21} = \\frac{1}{\\operatorname{Var}(C)} \\begin{pmatrix} \\alpha\\beta\\sigma_{U}^{2} \\\\ \\gamma\\delta\\sigma_{V}^{2} \\end{pmatrix} \\begin{pmatrix} \\alpha\\beta\\sigma_{U}^{2} & \\gamma\\delta\\sigma_{V}^{2} \\end{pmatrix}\n$$\n$$\n= \\frac{1}{\\operatorname{Var}(C)} \\begin{pmatrix} (\\alpha\\beta\\sigma_{U}^{2})^2 & (\\alpha\\beta\\sigma_{U}^{2})(\\gamma\\delta\\sigma_{V}^{2}) \\\\ (\\gamma\\delta\\sigma_{V}^{2})(\\alpha\\beta\\sigma_{U}^{2}) & (\\gamma\\delta\\sigma_{V}^{2})^2 \\end{pmatrix}\n$$\n$$\n= \\frac{1}{\\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}} \\begin{pmatrix} \\alpha^2\\beta^2(\\sigma_{U}^{2})^2 & \\alpha\\beta\\gamma\\delta\\sigma_{U}^{2}\\sigma_{V}^{2} \\\\ \\alpha\\beta\\gamma\\delta\\sigma_{U}^{2}\\sigma_{V}^{2} & \\gamma^2\\delta^2(\\sigma_{V}^{2})^2 \\end{pmatrix}\n$$\n那么条件协方差矩阵为：\n$$\n\\operatorname{Cov}((X,Y)^T \\mid C) = \\Sigma_{11} - \\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}\n$$\n$$\n= \\begin{pmatrix} \\alpha^2\\sigma_{U}^{2} + \\sigma_{X}^{2} & 0 \\\\ 0 & \\delta^2\\sigma_{V}^{2} + \\sigma_{Y}^{2} \\end{pmatrix} - \\frac{1}{\\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}} \\begin{pmatrix} \\alpha^2\\beta^2(\\sigma_{U}^{2})^2 & \\alpha\\beta\\gamma\\delta\\sigma_{U}^{2}\\sigma_{V}^{2} \\\\ \\alpha\\beta\\gamma\\delta\\sigma_{U}^{2}\\sigma_{V}^{2} & \\gamma^2\\delta^2(\\sigma_{V}^{2})^2 \\end{pmatrix}\n$$\n我们需要求的是 $\\operatorname{Cov}(X,Y \\mid C)$，也就是这个最终得到的 $2 \\times 2$ 矩阵的非对角元素。\n$$\n\\operatorname{Cov}(X,Y \\mid C) = 0 - \\frac{\\alpha\\beta\\gamma\\delta\\sigma_{U}^{2}\\sigma_{V}^{2}}{\\beta^2\\sigma_{U}^{2} + \\gamma^2\\sigma_{V}^{2} + \\sigma_{C}^{2}}\n$$\n这个表达式量化了通过对共同效应（冲撞点）$C$ 进行条件化而引出的 $X$ 和 $Y$ 之间的协方差。虽然 $X$ 和 $Y$ 是无条件独立的，但它们在给定条件下变得相关。这种现象被称为冲撞分层偏倚（collider stratification bias）。只要所有的路径系数（$\\alpha, \\beta, \\gamma, \\delta$）和未观测到的共同原因的方差（$\\sigma_U^2, \\sigma_V^2$）都非零，这个推导出的表达式就非零。",
            "answer": "$$\n\\boxed{- \\frac{\\alpha \\beta \\gamma \\delta \\sigma_{U}^{2} \\sigma_{V}^{2}}{\\beta^{2} \\sigma_{U}^{2} + \\gamma^{2} \\sigma_{V}^{2} + \\sigma_{C}^{2}}}\n$$"
        },
        {
            "introduction": "在学会识别混杂和偏倚之后，下一步是正确地估计因果效应。本练习将介绍g-计算公式，这是一种基于观测数据估计干预效应的强大基础方法。通过在一个实际的生物信息学场景中应用这种“标准化”方法，您将学习如何通过对混杂因素进行调整来模拟随机实验，从而获得对治疗效应的无偏估计。",
            "id": "4557812",
            "problem": "考虑一项关于激酶抑制剂的生物信息学和医疗数据分析队列研究，其中治疗剂量由一个连续变量 $X$ （对数剂量）表示，结局 $Y$ 是一个无量纲的标准化肿瘤生长指数，而 $Z$ 是一个表示基线合并症的二元指示变量（$Z=1$ 表示存在，$Z=0$ 表示不存在）。因果关系由一个有向无环图（DAG）描述：$Z \\rightarrow X$，$Z \\rightarrow Y$，$X \\rightarrow Y$，以及 $X \\rightarrow M \\rightarrow Y$，其中 $M$ 是一个捕捉 $X$ 下游药物诱导信号通路的中介变量。假设根据后门准则，$Z$ 是 $X$ 对 $Y$ 因果效应的一个有效调整集，并且满足一致性、给定 $Z$ 下的条件可交换性以及正性这些标准的可识别性条件。\n\n从观测数据中可以合理地获得以下统计摘要：\n- $Z$ 的观测分布为 $\\mathbb{P}(Z=1)=\\frac{1}{3}$ 和 $\\mathbb{P}(Z=0)=\\frac{2}{3}$。\n- 条件期望结局模型（一个在 $X$、$Z$ 及其交互作用上的饱和线性模型，与DAG相容且不以中介变量 $M$ 为条件）是\n$$\n\\mathbb{E}(Y\\mid X,Z)=\\theta_{0}+\\theta_{1}X+\\theta_{2}Z+\\theta_{3}XZ,\n$$\n其参数值为 $\\theta_{0}=10$，$\\theta_{1}=2$，$\\theta_{2}=5$ 和 $\\theta_{3}=1$。\n\n从因果建模中do-算子的核心定义和全期望定律出发，推导在干预 $X=x$ 下干预均值 $\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)$ 的g-计算估计量。然后，使用所提供的观测摘要，在 $x=2$ 处评估此估计量。将最终数值答案四舍五入至四位有效数字。从第一性原理出发，简要解释在无法进行随机实验的情况下，如何从观测数据中估计该估计量，并确保调整集中不包含任何中介变量且满足可识别性条件。",
            "solution": "我们首先回顾在有向无环图（DAG）中识别因果效应所需的核心定义和假设。一个对于 $X$ 对 $Y$ 因果效应的有效调整集 $Z$ 满足后门准则，这意味着 $Z$ 阻断了所有从 $X$到 $Y$ 的后门路径，并且不包含任何 $X$ 的后代。在满足一致性、给定 $Z$ 下的条件可交换性以及正性这些可识别性条件下，干预 $\\mathrm{do}(X=x)$ 下的干预分布可以通过g-计算公式来识别，该公式基于do-算子和全期望定律。具体来说，以 $Z$ 为条件足以消除混杂，从而得出干预均值是通过将给定 $X=x$ 时 $Y$ 的条件期望在 $Z$ 的观测分布上进行平均来获得的。\n\n形式上，在干预 $X=x$ 下，干预均值的目标估计量推导如下。根据一致性，$Y^{x}$ 等于当 $X$ 被设为 $x$ 时观测到的 $Y$。根据给定 $Z$ 下的条件可交换性，我们有 $Y^{x}\\perp\\!\\!\\!\\perp X\\mid Z$。正性要求只要 $\\mathbb{P}(Z=z)>0$，就有 $\\mathbb{P}(X=x\\mid Z=z)>0$。将全期望定律应用于干预分布，我们得到\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)=\\int \\mathbb{E}\\big(Y\\mid X=x,Z=z\\big)\\, \\mathrm{d}F_{Z}(z),\n$$\n其中 $F_{Z}$ 表示 $Z$ 的观测分布。对于离散的 $Z$，这简化为在 $Z$ 的支撑集上的有限求和。\n\n给定所提供的模型，\n$$\n\\mathbb{E}(Y\\mid X,Z)=\\theta_{0}+\\theta_{1}X+\\theta_{2}Z+\\theta_{3}XZ,\n$$\n其中 $\\theta_{0}=10$，$\\theta_{1}=2$，$\\theta_{2}=5$ 和 $\\theta_{3}=1$，我们计算g-计算所需的条件期望：\n\n1. 对于 $Z=0$ 和 $X=x$，\n$$\n\\mathbb{E}(Y\\mid X=x,Z=0)=\\theta_{0}+\\theta_{1}x+\\theta_{2}\\cdot 0+\\theta_{3}\\cdot x\\cdot 0=10+2x.\n$$\n\n2. 对于 $Z=1$ 和 $X=x$，\n$$\n\\mathbb{E}(Y\\mid X=x,Z=1)=\\theta_{0}+\\theta_{1}x+\\theta_{2}\\cdot 1+\\theta_{3}\\cdot x\\cdot 1=10+2x+5+x=15+3x.\n$$\n\n$Z$ 的观测分布为 $\\mathbb{P}(Z=1)=\\frac{1}{3}$ 和 $\\mathbb{P}(Z=0)=\\frac{2}{3}$。因此，干预均值为\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)=\\mathbb{E}\\big(Y\\mid X=x,Z=0\\big)\\,\\mathbb{P}(Z=0)+\\mathbb{E}\\big(Y\\mid X=x,Z=1\\big)\\,\\mathbb{P}(Z=1).\n$$\n在 $x=2$ 处进行评估：\n- $\\mathbb{E}(Y\\mid X=2,Z=0)=10+2\\cdot 2=14$，\n- $\\mathbb{E}(Y\\mid X=2,Z=1)=15+3\\cdot 2=21$。\n\n因此，\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=2)\\big)=14\\cdot \\frac{2}{3}+21\\cdot \\frac{1}{3}=\\frac{28}{3}+\\frac{21}{3}=\\frac{49}{3}.\n$$\n精确到四位有效数字，结果是\n$$\n\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=2)\\big)\\approx 16.33.\n$$\n\n我们现在解释如何从观测数据中估计这个估计量。在Z为有效调整集且满足可识别性假设的DAG下，参数化g-公式（g-计算）估计量的步骤是：首先从观测数据中对给定 $(X,Z)$ 时 $Y$ 的条件期望进行建模，然后在干预 $X=x$ 下，将模型预测的结局在 $Z$ 的经验分布上进行标准化（即，平均）。令 $\\hat{m}(x,z)$ 表示 $\\mathbb{E}(Y\\mid X=x,Z=z)$ 的一个估计，例如通过使用指定模型的线性回归获得，从而得到估计参数 $(\\hat{\\theta}_{0},\\hat{\\theta}_{1},\\hat{\\theta}_{2},\\hat{\\theta}_{3})$。给定一个独立同分布的样本 $\\{(Y_{i},X_{i},Z_{i}):i=1,\\dots,n\\}$，干预均值的代入估计量是\n$$\n\\hat{\\psi}(x)=\\frac{1}{n}\\sum_{i=1}^{n}\\hat{m}(x,Z_{i}).\n$$\n这个估计量是将全期望定律应用于 $Z$ 的观测分布的样本模拟。关键的是，我们不在调整集中以中介变量 $M$ 为条件，以避免因阻断部分因果路径而使总效应产生偏倚。在模型 $\\mathbb{E}(Y\\mid X,Z)$ 设定正确、满足一致性、给定 $Z$ 下的条件可交换性以及正性条件下，$\\hat{\\psi}(x)$ 是 $\\mathbb{E}\\big(Y\\mid \\mathrm{do}(X=x)\\big)$ 的一个一致估计量。在实践中，可以使用灵活的非参数模型或机器学习模型来估计 $\\hat{m}(x,z)$，并结合交叉拟合等技术，前提是同样的可识别性条件得到遵守，并且 $Z$ 的经验分布被用于标准化。最后，诊断应确认正性，即对于观测到的 $Z=z$ 值，接近 $x$ 的治疗水平在数据中有支撑，从而确保有意义的外推。",
            "answer": "$$\\boxed{16.33}$$"
        }
    ]
}