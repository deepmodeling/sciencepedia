{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of survival analysis is estimating the survival function from data where event times are not always fully observed due to right-censoring. This exercise  provides fundamental practice with the two most common non-parametric estimators: the Nelson-Aalen estimator for the cumulative hazard, $\\hat{H}(t)$, and the Kaplan-Meier estimator for the survival function, $\\hat{S}_{\\mathrm{KM}}(t)$. By working through this small dataset, you will solidify your understanding of risk sets, tied events, and the crucial relationship between the hazard and survival functions.",
            "id": "4612121",
            "problem": "A clinical registry tracks time from diagnosis to a molecular relapse for a targeted therapy cohort in months, with right-censoring when patients are lost to follow-up or switch therapies. Assume independent, non-informative right-censoring and that at any time with ties, all events occur before censorings at the same recorded time. Let $T$ denote time-to-relapse, the survival function be $S(t)=\\Pr(Tt)$, the hazard be $h(t)$, and the cumulative hazard be $H(t)=\\int_{0}^{t} h(s)\\,ds$, so that $S(t)=\\exp(-H(t))$. Starting from these definitions and using standard nonparametric constructions justified by counting-process or likelihood arguments under right-censoring, you will estimate the cumulative hazard and survival.\n\nYou are given $n=10$ independent individuals with observed times (in months) and event indicators $\\delta$ ($\\delta=1$ for relapse, $\\delta=0$ for right-censoring):\n- Subject $1$: time $2.1$, $\\delta=1$.\n- Subject $2$: time $4.0$, $\\delta=1$.\n- Subject $3$: time $4.0$, $\\delta=1$.\n- Subject $4$: time $4.0$, $\\delta=0$.\n- Subject $5$: time $5.7$, $\\delta=1$.\n- Subject $6$: time $6.3$, $\\delta=0$.\n- Subject $7$: time $6.3$, $\\delta=1$.\n- Subject $8$: time $9.5$, $\\delta=1$.\n- Subject $9$: time $12.0$, $\\delta=0$.\n- Subject $10$: time $12.0$, $\\delta=1$.\n\nTasks:\n1. Using the above assumptions and foundational definitions, construct the nonparametric cumulative hazard estimator $\\hat H(t)$ and, via the survival–hazard relationship, the transformed survival estimator $\\tilde S(t)=\\exp(-\\hat H(t))$. Explicitly compute $\\hat H(t)$ and $\\tilde S(t)$ on the interval $[0,t_{\\star}]$ with $t_{\\star}=10$ months.\n2. Construct the Kaplan–Meier (KM) product-limit survival estimator $\\hat S_{\\mathrm{KM}}(t)$ and compute $\\hat S_{\\mathrm{KM}}(t_{\\star})$.\n3. Contrast, in words, the event-time jumps of $\\hat H(t)$ and the step sizes of $\\tilde S(t)$ with the Kaplan–Meier steps at the same event times, discussing how tied events and the presence of censoring at event times are handled in the risk sets and how this affects the multiplicative drops.\n\nAnswer specification: Report a single final quantity, the exact ratio $r=\\tilde S(t_{\\star})/\\hat S_{\\mathrm{KM}}(t_{\\star})$, in a closed-form analytic expression. Do not approximate and do not include units in your final reported ratio. No rounding is required. All intermediate computations and reasoning must be shown in your solution.",
            "solution": "The first step is to order the distinct event times and for each, determine the number of events and the size of the risk set. Let $t_{(j)}$ be the $j$-th ordered distinct time at which an event occurs. Let $d_j$ be the number of events (relapses) at $t_{(j)}$, and $Y_j$ be the number of individuals at risk just prior to $t_{(j)}$. The risk set at time $t$, $R(t)$, consists of all individuals $i$ whose observed time $T_i \\ge t$. Thus, $Y_j = |R(t_{(j)})|$.\n\nThe ordered observed times are $2.1, 4.0, 4.0, 4.0, 5.7, 6.3, 6.3, 9.5, 12.0, 12.0$.\nThe distinct event times are $2.1, 4.0, 5.7, 6.3, 9.5, 12.0$.\n\nWe construct a table to organize the calculations:\n- At time $t=0$, the risk set size is $Y=10$.\n- At event time $t_{(1)} = 2.1$:\n  - The risk set $R(2.1)$ comprises all $10$ subjects, so $Y_1=10$.\n  - One event occurs (Subject $1$), so $d_1=1$.\n  - No subjects are censored.\n- At event time $t_{(2)} = 4.0$:\n  - Subject $1$ is no longer at risk. The risk set $R(4.0)$ has $10-1=9$ subjects. So, $Y_2=9$.\n  - Two events occur (Subjects $2, 3$), so $d_2=2$.\n  - One subject (Subject $4$) is censored. Per the problem, this individual is in the risk set at time $4.0$.\n- At event time $t_{(3)} = 5.7$:\n  - At time $4.0$, $2$ events and $1$ censoring occurred. The number of subjects remaining is $9 - 2 - 1 = 6$.\n  - The risk set $R(5.7)$ has these $6$ subjects. So, $Y_3=6$.\n  - One event occurs (Subject $5$), so $d_3=1$.\n- At event time $t_{(4)} = 6.3$:\n  - After the event at $5.7$, $6-1=5$ subjects remain.\n  - The risk set $R(6.3)$ has these $5$ subjects. So, $Y_4=5$.\n  - One event occurs (Subject $7$), so $d_4=1$.\n  - One subject (Subject $6$) is censored at this time.\n- At event time $t_{(5)} = 9.5$:\n  - At time $6.3$, $1$ event and $1$ censoring occurred. The number of subjects remaining is $5 - 1 - 1 = 3$.\n  - The risk set $R(9.5)$ has these $3$ subjects. So, $Y_5=3$.\n  - One event occurs (Subject $8$), so $d_5=1$.\n- The next event time is $t_{(6)} = 12.0$, which is greater than $t_{\\star}=10$.\n\n**Task 1: Compute $\\hat{H}(10)$ and $\\tilde{S}(10)$**\nThe Nelson-Aalen estimator of the cumulative hazard function is given by the sum of the hazard increments at each event time:\n$$ \\hat{H}(t) = \\sum_{j: t_{(j)} \\le t} \\frac{d_j}{Y_j} $$\nWe need to calculate this at $t_{\\star}=10$. The relevant event times are $t_{(j)} \\le 10$, which are $2.1, 4.0, 5.7, 6.3,$ and $9.5$.\n$$ \\hat{H}(10) = \\frac{d_1}{Y_1} + \\frac{d_2}{Y_2} + \\frac{d_3}{Y_3} + \\frac{d_4}{Y_4} + \\frac{d_5}{Y_5} $$\nSubstituting the values we found:\n$$ \\hat{H}(10) = \\frac{1}{10} + \\frac{2}{9} + \\frac{1}{6} + \\frac{1}{5} + \\frac{1}{3} $$\nTo sum these fractions, we find a common denominator, which is $90$.\n$$ \\hat{H}(10) = \\frac{9}{90} + \\frac{20}{90} + \\frac{15}{90} + \\frac{18}{90} + \\frac{30}{90} = \\frac{9+20+15+18+30}{90} = \\frac{92}{90} = \\frac{46}{45} $$\nThe transformed survival estimator $\\tilde{S}(t)$ is defined as $\\exp(-\\hat{H}(t))$. At $t_{\\star}=10$:\n$$ \\tilde{S}(10) = \\exp(-\\hat{H}(10)) = \\exp\\left(-\\frac{46}{45}\\right) $$\n\n**Task 2: Compute $\\hat{S}_{\\mathrm{KM}}(10)$**\nThe Kaplan-Meier product-limit estimator for the survival function is given by:\n$$ \\hat{S}_{\\mathrm{KM}}(t) = \\prod_{j: t_{(j)} \\le t} \\left(1 - \\frac{d_j}{Y_j}\\right) $$\nWe calculate this at $t_{\\star}=10$, using the same event times and values for $d_j$ and $Y_j$.\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\left(1 - \\frac{d_1}{Y_1}\\right) \\left(1 - \\frac{d_2}{Y_2}\\right) \\left(1 - \\frac{d_3}{Y_3}\\right) \\left(1 - \\frac{d_4}{Y_4}\\right) \\left(1 - \\frac{d_5}{Y_5}\\right) $$\nSubstituting the values:\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\left(1 - \\frac{1}{10}\\right) \\left(1 - \\frac{2}{9}\\right) \\left(1 - \\frac{1}{6}\\right) \\left(1 - \\frac{1}{5}\\right) \\left(1 - \\frac{1}{3}\\right) $$\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\left(\\frac{9}{10}\\right) \\left(\\frac{7}{9}\\right) \\left(\\frac{5}{6}\\right) \\left(\\frac{4}{5}\\right) \\left(\\frac{2}{3}\\right) $$\nWe can simplify this product by canceling terms:\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\frac{9 \\cdot 7 \\cdot 5 \\cdot 4 \\cdot 2}{10 \\cdot 9 \\cdot 6 \\cdot 5 \\cdot 3} = \\frac{\\cancel{9} \\cdot 7 \\cdot \\cancel{5} \\cdot 4 \\cdot 2}{10 \\cdot \\cancel{9} \\cdot 6 \\cdot \\cancel{5} \\cdot 3} = \\frac{7 \\cdot 4 \\cdot 2}{10 \\cdot 6 \\cdot 3} = \\frac{56}{180} $$\nSimplifying the fraction by dividing the numerator and denominator by their greatest common divisor, which is $4$:\n$$ \\hat{S}_{\\mathrm{KM}}(10) = \\frac{14}{45} $$\n\n**Task 3: Contrast the Estimators**\nThe Nelson-Aalen estimator $\\hat{H}(t)$ is built on an additive scale. It is a step function that increases only at event times. The jump size at an event time $t_{(j)}$ is $\\Delta \\hat{H}(t_{(j)}) = d_j/Y_j$, which represents the empirical hazard, or instantaneous rate of failure, at that moment. For tied events, as at $t=4.0$ where $d_2=2$, the jump is larger ($2/9$) as it aggregates the risk from all events occurring at that instant.\n\nThe transformed survival estimator $\\tilde{S}(t) = \\exp(-\\hat{H}(t))$ inherits its structure from $\\hat{H}(t)$. It is a continuously decreasing function between events. At an event time $t_{(j)}$, it drops multiplicatively by a factor of $\\exp(-\\Delta \\hat{H}(t_{(j)})) = \\exp(-d_j/Y_j)$. So, $\\tilde{S}(t_{(j)}) = \\tilde{S}(t_{(j)}^{-}) \\times \\exp(-d_j/Y_j)$.\n\nThe Kaplan-Meier estimator $\\hat{S}_{\\mathrm{KM}}(t)$ is also a step function that drops only at event times. Its construction is inherently multiplicative. At an event time $t_{(j)}$, the survival probability is multiplied by the conditional probability of surviving past $t_{(j)}$, given survival until just before $t_{(j)}$. This conditional probability is estimated as $(Y_j - d_j)/Y_j = 1 - d_j/Y_j$. Thus, the multiplicative drop is by a factor of $(1 - d_j/Y_j)$. For tied events, this factor accounts for all $d_j$ failures simultaneously.\n\nThe relationship between the two survival estimators stems from the approximation $\\exp(-x) \\approx 1-x$ for small $x$. The Kaplan-Meier drop factor, $1-d_j/Y_j$, is the first-order Taylor expansion of the drop factor for $\\tilde{S}(t)$, $\\exp(-d_j/Y_j)$. Consequently, $\\hat{S}_{\\mathrm{KM}}(t)$ can be seen as an approximation to $\\tilde{S}(t)$, and they converge to the same true survival function $S(t)$ as the sample size increases. For any finite sample, $\\hat{S}_{\\mathrm{KM}}(t) \\le \\tilde{S}(t)$ because $1-x \\le \\exp(-x)$ for all $x \\ge 0$. In handling tied events and censoring, both methods use the same risk sets $Y_j$ and event counts $d_j$, ensuring consistency in their underlying data structures. The tie-handling rule (events before censoring) is critical for correctly calculating $Y_j$.\n\n**Final Calculation: The Ratio $r$**\nThe final task is to compute the ratio $r = \\tilde{S}(t_{\\star}) / \\hat{S}_{\\mathrm{KM}}(t_{\\star})$ at $t_{\\star}=10$.\n$$ r = \\frac{\\tilde{S}(10)}{\\hat{S}_{\\mathrm{KM}}(10)} = \\frac{\\exp\\left(-\\frac{46}{45}\\right)}{\\frac{14}{45}} $$\n$$ r = \\frac{45}{14} \\exp\\left(-\\frac{46}{45}\\right) $$\nThis is the final exact, closed-form expression for the ratio.",
            "answer": "$$\\boxed{\\frac{45}{14}\\exp\\left(-\\frac{46}{45}\\right)}$$"
        },
        {
            "introduction": "Real-world cohort studies often involve subjects who enter observation at different points in time, a phenomenon known as left-truncation or late entry. Ignoring this feature and assuming all subjects are at risk from time zero leads to biased survival estimates. This practice  demonstrates how to correctly modify the Kaplan-Meier risk sets to account for left-truncation and quantifies the error introduced by the naive approach, reinforcing the importance of properly defining the population at risk at every event time.",
            "id": "4612158",
            "problem": "A cohort study in bioinformatics tracks time from a molecular diagnosis to death for patients with a genomically defined cancer subtype. Patients become eligible and hence enter observation only after a biomarker panel is completed, which induces left truncation: a patient with late biomarker completion enters the risk set only after that time. For each patient, you are given an entry time $L_i$ (the time the patient first becomes observable), an exit time $T_i$ (the time of event or right-censoring), and an event indicator $\\delta_i$ where $\\delta_i = 1$ denotes a death and $\\delta_i = 0$ denotes right-censoring. All times are measured in months from molecular diagnosis.\n\nThe dataset for $6$ patients is:\n- Subject $1$: $L_1 = 6$, $T_1 = 20$, $\\delta_1 = 1$.\n- Subject $2$: $L_2 = 21$, $T_2 = 28$, $\\delta_2 = 0$.\n- Subject $3$: $L_3 = 10$, $T_3 = 30$, $\\delta_3 = 1$.\n- Subject $4$: $L_4 = 15$, $T_4 = 25$, $\\delta_4 = 0$.\n- Subject $5$: $L_5 = 19$, $T_5 = 22$, $\\delta_5 = 1$.\n- Subject $6$: $L_6 = 2$, $T_6 = 27$, $\\delta_6 = 1$.\n\nStarting from core definitions of the survival function and hazard function, derive the Kaplan–Meier (KM) estimator with left truncation by constructing appropriate risk sets and conditional failure probabilities. Then compute the survival probability at $t = 24$ months:\n- First, using left truncation (i.e., late entry) correctly.\n- Second, naively ignoring left truncation (i.e., treating all subjects as at risk from $t = 0$).\n\nFinally, report the numerical difference between these two survival probabilities at $t = 24$ months, defined as $S_{\\text{LT}}(24) - S_{\\text{naive}}(24)$, where $S_{\\text{LT}}$ is the KM survival with left truncation and $S_{\\text{naive}}$ is the KM survival ignoring left truncation. Express your final answer as an exact fraction. In your derivation, explicitly explain why the two estimates differ in terms of the construction of the risk sets and the implied hazard over the event times.",
            "solution": "The problem requires the calculation and comparison of two Kaplan-Meier (KM) survival estimates at time $t=24$ months: one correctly accounting for left-truncation (late entry) and another naively ignoring it. We begin by defining the core concepts.\n\nThe survival function, $S(t)$, is the probability that an individual survives beyond time $t$, i.e., $S(t) = P(T  t)$, where $T$ is the time-to-event random variable. The Kaplan-Meier estimator is a non-parametric method to estimate $S(t)$ from censored data. It is a product-limit estimator given by:\n$$\n\\hat{S}_{\\text{KM}}(t) = \\prod_{j: t_j \\le t} \\left(1 - \\frac{d_j}{n_j}\\right)\n$$\nwhere $t_1  t_2  \\dots  t_k$ are the distinct times at which events (deaths) occur, $d_j$ is the number of events at time $t_j$, and $n_j$ is the number of individuals in the risk set just before time $t_j$.\n\nThe critical distinction between the two required calculations lies in the definition of the risk set. For a subject $i$, we are given an entry time $L_i$, an exit time $T_i$, and an event indicator $\\delta_i$. An event occurred if $\\delta_i=1$, and the subject was right-censored if $\\delta_i=0$.\n\nThe provided data is:\n- Subject $1$: $L_1 = 6$, $T_1 = 20$, $\\delta_1 = 1$ (Event).\n- Subject $2$: $L_2 = 21$, $T_2 = 28$, $\\delta_2 = 0$ (Censored).\n- Subject $3$: $L_3 = 10$, $T_3 = 30$, $\\delta_3 = 1$ (Event).\n- Subject $4$: $L_4 = 15$, $T_4 = 25$, $\\delta_4 = 0$ (Censored).\n- Subject $5$: $L_5 = 19$, $T_5 = 22$, $\\delta_5 = 1$ (Event).\n- Subject $6$: $L_6 = 2$, $T_6 = 27$, $\\delta_6 = 1$ (Event).\n\nThe distinct event times are $t=20$ (Subject $1$), $t=22$ (Subject $5$), $t=27$ (Subject $6$), and $t=30$ (Subject $3$). We order these as $t_1 = 20$, $t_2 = 22$, $t_3 = 27$, and $t_4 = 30$.\n\n**1. KM Estimator with Left Truncation, $S_{\\text{LT}}(t)$**\n\nIn the presence of left truncation, the risk set at time $t$, denoted $R(t)$, includes only those individuals who have entered the study ($L_i \\le t$) and have not yet experienced an event or been censored ($T_i \\ge t$). Therefore, the number of individuals at risk at event time $t_j$ is $n_j = |\\{i: L_i \\le t_j \\text{ and } T_i \\ge t_j\\}|$.\n\n- **At event time $t_1 = 20$**:\n  - Number of events $d_1 = 1$ (Subject $1$).\n  - The risk set consists of subjects with $L_i \\le 20$ and $T_i \\ge 20$.\n    - Subject $1$: $L_1=6 \\le 20$, $T_1=20 \\ge 20$. Yes.\n    - Subject $2$: $L_2=21 \\not\\le 20$. No. Not yet in the study.\n    - Subject $3$: $L_3=10 \\le 20$, $T_3=30 \\ge 20$. Yes.\n    - Subject $4$: $L_4=15 \\le 20$, $T_4=25 \\ge 20$. Yes.\n    - Subject $5$: $L_5=19 \\le 20$, $T_5=22 \\ge 20$. Yes.\n    - Subject $6$: $L_6=2 \\le 20$, $T_6=27 \\ge 20$. Yes.\n  - The number at risk is $n_1 = 5$.\n  - The survival probability past $t=20$ is $S_{\\text{LT}}(20) = 1 - \\frac{d_1}{n_1} = 1 - \\frac{1}{5} = \\frac{4}{5}$.\n\n- **At event time $t_2 = 22$**:\n  - Number of events $d_2 = 1$ (Subject $5$).\n  - The risk set consists of subjects with $L_i \\le 22$ and $T_i \\ge 22$.\n    - Subject $1$: Exited at $t=20$. No.\n    - Subject $2$: $L_2=21 \\le 22$, $T_2=28 \\ge 22$. Yes.\n    - Subject $3$: $L_3=10 \\le 22$, $T_3=30 \\ge 22$. Yes.\n    - Subject $4$: $L_4=15 \\le 22$, $T_4=25 \\ge 22$. Yes.\n    - Subject $5$: $L_5=19 \\le 22$, $T_5=22 \\ge 22$. Yes.\n    - Subject $6$: $L_6=2 \\le 22$, $T_6=27 \\ge 22$. Yes.\n  - The number at risk is $n_2 = 5$.\n  - The cumulative survival probability is $S_{\\text{LT}}(22) = S_{\\text{LT}}(20) \\times \\left(1 - \\frac{d_2}{n_2}\\right) = \\frac{4}{5} \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{4}{5} \\times \\frac{4}{5} = \\frac{16}{25}$.\n\nThe survival function is a step function that is constant between event times. The next event occurs at $t_3 = 27$. Therefore, for any time $t$ such that $22 \\le t  27$, the survival probability is $S_{\\text{LT}}(t) = S_{\\text{LT}}(22)$.\nWe need to find $S_{\\text{LT}}(24)$. Since $22 \\le 24  27$, we have:\n$$S_{\\text{LT}}(24) = S_{\\text{LT}}(22) = \\frac{16}{25}$$\n\n**2. Naive KM Estimator Ignoring Left Truncation, $S_{\\text{naive}}(t)$**\n\nWhen left truncation is ignored, we incorrectly assume all subjects are at risk from time $t=0$ (i.e., $L_i=0$ for all $i$). The risk set at time $t_j$ is simply the total number of subjects who have not yet had an event or been censored before $t_j$.\n\n- **At event time $t_1 = 20$**:\n  - Number of events $d_1 = 1$.\n  - All $6$ subjects are assumed to be at risk since none have been censored or had an event before $t=20$.\n  - The number at risk is $n_1 = 6$.\n  - The survival probability is $S_{\\text{naive}}(20) = 1 - \\frac{1}{6} = \\frac{5}{6}$.\n\n- **At event time $t_2 = 22$**:\n  - Number of events $d_2 = 1$.\n  - At time $t=20$, Subject $1$ had an event. The remaining $5$ subjects are at risk. No other censoring occurred between $t=20$ and $t=22$.\n  - The number at risk is $n_2 = 6 - 1 = 5$.\n  - The cumulative survival probability is $S_{\\text{naive}}(22) = S_{\\text{naive}}(20) \\times \\left(1 - \\frac{1}{5}\\right) = \\frac{5}{6} \\times \\frac{4}{5} = \\frac{20}{30} = \\frac{2}{3}$.\n\nAgain, the survival function is constant between events. The next change to the risk set is Subject $4$ being censored at $t=25$, and the next event is at $t=27$. Therefore, for any time $t$ such that $22 \\le t  25$, the survival probability is $S_{\\text{naive}}(t) = S_{\\text{naive}}(22)$.\nWe need to find $S_{\\text{naive}}(24)$. Since $22 \\le 24  25$, we have:\n$$S_{\\text{naive}}(24) = S_{\\text{naive}}(22) = \\frac{2}{3}$$\n\n**3. Explanation and Difference**\n\nThe difference between the two estimates at $t=24$ months is:\n$$ S_{\\text{LT}}(24) - S_{\\text{naive}}(24) = \\frac{16}{25} - \\frac{2}{3} = \\frac{16 \\times 3}{75} - \\frac{2 \\times 25}{75} = \\frac{48 - 50}{75} = -\\frac{2}{75} $$\n\nThe discrepancy arises from the incorrect construction of the risk set in the naive approach. By ignoring left truncation (late entry), the naive method includes subjects in the risk set before they are actually under observation. For instance, at the first event time $t_1 = 20$, the naive risk set size is $n_1 = 6$. However, Subject $2$ only enters the study at $L_2=21$ and is thus not observable at $t=20$. The correct left-truncated estimator properly excludes this subject, yielding a smaller, correct risk set size of $n_1=5$.\n\nThe hazard at an event time $t_j$ is estimated by the conditional failure probability, $\\frac{d_j}{n_j}$.\n- At $t=20$, the naive approach estimates the hazard as $\\frac{1}{6}$, while the correct LT approach estimates it as $\\frac{1}{5}$.\nBy inflating the denominator ($n_j$), the naive method artificially dilutes the risk pool and systematically *underestimates* the true hazard at early time points. A lower estimated hazard translates to a higher (more optimistic) estimated survival probability. We see this in the first step: $S_{\\text{naive}}(20) = \\frac{5}{6} \\approx 0.833$ is greater than $S_{\\text{LT}}(20) = \\frac{4}{5} = 0.8$. This initial bias propagates through the product-limit calculation, leading to an incorrect final survival estimate. The left-truncated KM estimator correctly conditions on the information that a subject must have survived and entered the study to be at risk, providing an unbiased estimate of the survival function for the population.",
            "answer": "$$\n\\boxed{-\\frac{2}{75}}\n$$"
        },
        {
            "introduction": "When subjects are at risk for multiple, mutually exclusive events, we enter the domain of competing risks. A frequent mistake is to estimate the probability of one event type by treating the other event types as simple right-censoring, which is conceptually incorrect. This exercise  explores from first principles why this approach is flawed, leading to an overestimation of the event probability. You will derive the correct formulation for the cumulative incidence function and see how it differs from the naive Kaplan-Meier complement, a critical distinction for any applied analyst.",
            "id": "4612139",
            "problem": "A bioinformatics and medical data analytics team is studying time to a cause-specific event in a cohort with two mutually exclusive outcomes that terminate follow-up: cause $1$ (the event of interest) and cause $2$ (a competing event). Investigators contemplate using the Kaplan–Meier (KM) estimator for cause $1$, treating cause $2$ as right-censoring, and then taking the complement $1-\\hat{S}_{\\text{KM},1}(t)$ to estimate the probability of cause $1$ by time $t$. Using only core definitions of the survival function, hazard function, and cause-specific hazard in a continuous-time competing risks setting, derive expressions that allow you to compare the quantity that $1-\\hat{S}_{\\text{KM},1}(t)$ targets versus the true probability of experiencing cause $1$ by time $t$. Explain, from first principles, why $1-\\hat{S}_{\\text{KM},1}(t)$ is an overestimate in the presence of competing risks.\n\nThen, consider a homogeneous cohort in which the cause-specific hazard functions are constant over time: $h_{1}(t) = h_{1}$ and $h_{2}(t) = h_{2}$ for all $t \\ge 0$, with $h_{1} = 0.08$ per year and $h_{2} = 0.12$ per year. For time $t = 5$ years, compute the numerical bias defined as\n$$\n\\text{Bias}(t) = \\big(1 - \\hat{S}_{\\text{KM},1}(t)\\big) - \\Pr\\{\\text{cause }1 \\text{ occurs by time } t\\},\n$$\nunder the idealized exponential model where the KM estimator is consistent for $S_{1}(t)$ when cause $2$ is treated as independent right-censoring and both hazards are constant. Round your final numeric answer to four significant figures and express it as a decimal fraction without units.",
            "solution": "The problem asks for a derivation and explanation regarding the estimation of cause-specific event probability in a competing risks setting, followed by a numerical calculation of bias for a specific model.\n\nLet $T$ be the continuous random variable for the time to the first event, and let $J \\in \\{1, 2\\}$ be a random variable indicating the cause of the event. The two causes are mutually exclusive.\n\nThe fundamental quantities in a competing risks framework are the cause-specific hazard functions. For cause $k$, the cause-specific hazard function $h_k(t)$ is defined as the instantaneous rate of failure from cause $k$ at time $t$, given survival up to time $t$:\n$$\nh_k(t) = \\lim_{\\Delta t \\to 0} \\frac{\\Pr(t \\le T  t+\\Delta t, J=k | T \\ge t)}{\\Delta t}\n$$\nThe overall hazard of any event, $h(t)$, is the sum of the cause-specific hazards, as the causes are mutually exclusive:\n$$\nh(t) = h_1(t) + h_2(t)\n$$\nThe overall survival function, $S(t) = \\Pr(T  t)$, which is the probability of being event-free at time $t$, is related to the overall hazard function by:\n$$\nS(t) = \\exp\\left(-\\int_0^t h(u) du\\right) = \\exp\\left(-\\int_0^t [h_1(u) + h_2(u)] du\\right)\n$$\n\nFirst, we address the quantity that $1-\\hat{S}_{\\text{KM},1}(t)$ targets. The problem states that the Kaplan-Meier (KM) estimator is used for cause $1$, treating cause $2$ events as right-censoring. The KM estimator is designed to estimate the survival function in a setting where there is a single type of event and independent censoring. By treating cause $2$ events as censoring, the analysis implicitly assumes that these individuals were at risk of event $1$ but were simply unobserved after the time of their cause $2$ event. This framework estimates a survival function based *only* on the hazard of cause $1$.\n\nThe survival function that corresponds to the hazard $h_1(t)$ alone is:\n$$\nS_{1,\\text{latent}}(t) = \\exp\\left(-\\int_0^t h_1(u) du\\right)\n$$\nThis is a latent, or theoretical, survival function. It represents the survival probability in a hypothetical world where cause $2$ does not exist (i.e., $h_2(u) = 0$ for all $u$). The KM estimator, under the assumption of independent censoring, consistently estimates this latent survival function.\nConsequently, the quantity $1-\\hat{S}_{\\text{KM},1}(t)$ is an estimator for:\n$$\n1 - S_{1,\\text{latent}}(t) = 1 - \\exp\\left(-\\int_0^t h_1(u) du\\right)\n$$\nThis expression represents the probability of experiencing event $1$ by time $t$ in the hypothetical absence of the competing risk (cause $2$).\n\nNext, we derive the expression for the true probability of experiencing cause $1$ by time $t$ in the presence of cause $2$. This quantity is known as the Cumulative Incidence Function (CIF) for cause $1$, denoted $F_1(t)$. It is defined as $F_1(t) = \\Pr(T \\le t, J=1)$.\nThe probability density of failing from cause $1$ at time $u$ is given by the product of the cause-specific hazard for cause $1$ and the overall survival probability up to time $u$:\n$$\nf_1(u) = h_1(u) S(u)\n$$\nTo obtain the cumulative probability $F_1(t)$, we integrate this density from $0$ to $t$:\n$$\nF_1(t) = \\int_0^t f_1(u) du = \\int_0^t h_1(u) S(u) du\n$$\nSubstituting the expression for the overall survival function $S(u)$, we get:\n$$\nF_1(t) = \\int_0^t h_1(u) \\exp\\left(-\\int_0^u [h_1(v) + h_2(v)] dv\\right) du\n$$\nThis is the true probability of experiencing event $1$ by time $t$.\n\nTo explain why $1-\\hat{S}_{\\text{KM},1}(t)$ is an overestimate of the true probability, we must show that, for $t0$,\n$$\n1 - \\exp\\left(-\\int_0^t h_1(u) du\\right) \\ge \\int_0^t h_1(u) \\exp\\left(-\\int_0^u [h_1(v) + h_2(v)] dv\\right) du\n$$\nwhere the inequality is strict if $h_2(u)  0$ over a time interval of non-zero measure within $[0, t]$.\n\nFrom first principles, the survival function $S(u)$ accounts for removal from the risk set by *both* causes. The latent survival function $S_{1,\\text{latent}}(u)$ only accounts for removal by cause $1$. Since $h_2(u) \\ge 0$, it follows that $h_1(u) + h_2(u) \\ge h_1(u)$. Integrating from $0$ to any time $u$ gives $\\int_0^u [h_1(v) + h_2(v)] dv \\ge \\int_0^u h_1(v) dv$.\nTaking the negative exponent, the inequality reverses:\n$$\n\\exp\\left(-\\int_0^u [h_1(v) + h_2(v)] dv\\right) \\le \\exp\\left(-\\int_0^u h_1(v) dv\\right)\n$$\nThis is equivalent to $S(u) \\le S_{1,\\text{latent}}(u)$. This inequality means that at any time $u$, the probability of having survived all events is lower than or equal to the probability of having survived cause $1$ in a world with no competing risks. This is intuitive: more risks lead to lower survival.\n\nThe quantity $1-S_{1,\\text{latent}}(t)$ can be written as $\\int_0^t h_1(u) S_{1,\\text{latent}}(u) du$. The proof is direct: let $H_1(t)=\\int_0^t h_1(u)du$. Then $S_{1,\\text{latent}}(t) = \\exp(-H_1(t))$, and its derivative is $-h_1(t)\\exp(-H_1(t)) = -h_1(t)S_{1,\\text{latent}}(t)$. So, $\\int_0^t h_1(u)S_{1,\\text{latent}}(u)du = \\int_0^t -S'_{1,\\text{latent}}(u)du = -[S_{1,\\text{latent}}(u)]_0^t = - (S_{1,\\text{latent}}(t)-S_{1,\\text{latent}}(0)) = 1-S_{1,\\text{latent}}(t)$.\n\nNow we can compare the two quantities:\n$$\n\\text{Target of } 1-S_{\\text{KM},1}(t) = \\int_0^t h_1(u) S_{1,\\text{latent}}(u) du\n$$\n$$\n\\text{True Probability } F_1(t) = \\int_0^t h_1(u) S(u) du\n$$\nSince we established that $S(u) \\le S_{1,\\text{latent}}(u)$ for all $u \\ge 0$, and assuming $h_1(u) \\ge 0$, it follows that the integrand of the first expression is always greater than or equal to the integrand of the second. Therefore, their integrals must satisfy the same inequality:\n$$\n\\int_0^t h_1(u) S_{1,\\text{latent}}(u) du \\ge \\int_0^t h_1(u) S(u) du\n$$\nThis demonstrates that $1-\\hat{S}_{\\text{KM},1}(t)$ targets a quantity that is an overestimate of the true probability. The overestimation occurs because treating competing events as censoring incorrectly assumes that these subjects remain at risk for the event of interest, when in reality they have been permanently removed from the at-risk population.\n\nNow, we perform the numerical calculation. The model specifies constant cause-specific hazards: $h_1(t) = h_1 = 0.08$ and $h_2(t) = h_2 = 0.12$. The time is $t = 5$ years.\n\nThe quantity estimated by the naive KM approach is:\n$$\n1 - S_{1,\\text{latent}}(t) = 1 - \\exp(-h_1 t)\n$$\nAt $t=5$, this is:\n$$\n1 - \\exp(-0.08 \\times 5) = 1 - \\exp(-0.4)\n$$\nThe true probability of cause $1$ by time $t$, $F_1(t)$, for constant hazards is:\n$$\nF_1(t) = \\int_0^t h_1 \\exp(-(h_1 + h_2)u) du\n$$\nThe overall hazard is $h = h_1 + h_2 = 0.08 + 0.12 = 0.20$.\n$$\nF_1(t) = \\int_0^t h_1 \\exp(-hu) du = h_1 \\left[ \\frac{\\exp(-hu)}{-h} \\right]_0^t = \\frac{h_1}{-h}(\\exp(-ht) - \\exp(0)) = \\frac{h_1}{h}(1 - \\exp(-ht))\n$$\nAt $t=5$, this is:\n$$\nF_1(5) = \\frac{0.08}{0.20}(1 - \\exp(-0.20 \\times 5)) = 0.4(1 - \\exp(-1))\n$$\nThe bias is defined as the difference between these two quantities:\n$$\n\\text{Bias}(t) = \\big(1 - S_{1,\\text{latent}}(t)\\big) - F_1(t)\n$$\n$$\n\\text{Bias}(5) = \\big(1 - \\exp(-0.4)\\big) - \\big(0.4(1 - \\exp(-1))\\big)\n$$\nWe now compute the numerical value:\n$$\n\\exp(-0.4) \\approx 0.6703200459\n$$\n$$\n1 - \\exp(-0.4) \\approx 1 - 0.6703200459 = 0.3296799541\n$$\n$$\n\\exp(-1) \\approx 0.3678794412\n$$\n$$\n1 - \\exp(-1) \\approx 1 - 0.3678794412 = 0.6321205588\n$$\n$$\n0.4(1 - \\exp(-1)) \\approx 0.4 \\times 0.6321205588 = 0.2528482235\n$$\n$$\n\\text{Bias}(5) \\approx 0.3296799541 - 0.2528482235 = 0.0768317306\n$$\nRounding this result to four significant figures gives $0.07683$.",
            "answer": "$$\n\\boxed{0.07683}\n$$"
        }
    ]
}