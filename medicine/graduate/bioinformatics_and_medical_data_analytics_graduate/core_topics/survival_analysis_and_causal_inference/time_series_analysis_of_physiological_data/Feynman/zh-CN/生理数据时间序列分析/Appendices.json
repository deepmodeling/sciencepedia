{
    "hands_on_practices": [
        {
            "introduction": "生理数据分析的第一步是数据采集。将连续的模拟信号（如心跳）转换为一系列数字是一个关键步骤，但也充满了潜在的陷阱。本练习要求您从第一性原理出发，推导信号混叠现象，从而让您从根本上理解采样过程如何在数据中产生误导性的频率。通过将这一知识应用于一个常见的光电容积脉搏波（PPG）信号场景，您将巩固自己在实践中预测和识别此类伪影的能力。",
            "id": "4613653",
            "problem": "一个光电容积脉搏波（PPG）传感器记录一个连续时间生理信号，该信号受到一个窄带肌电伪影的干扰，该伪影被建模为频率为 $f_{0}$（单位为 $\\mathrm{Hz}$）的单个实正弦波。该信号以采样周期 $T_{s}$ 进行均匀采样，产生离散时间序列 $x[n]=x_{c}(nT_{s})$，其中 $f_{s}=1/T_{s}$ 是采样频率（单位为 $\\mathrm{Hz}$）。假设采样是理想、无噪声的，并且采集过程是线性时不变的。\n\n仅从均匀采样的基本定义（即在连续时间内与脉冲串相乘）以及狄拉克梳状函数傅里叶变换的基本性质出发，完成以下任务：\n\n1) 将采样操作建模为 $x_{s}(t)=x_{c}(t)\\sum_{n=-\\infty}^{\\infty}\\delta(t-nT_{s})$，并利用傅里叶变换的卷积-乘法对偶性，推导出采样信号的频谱 $X_{s}(f)$，用原始频谱 $X_{c}(f)$ 和采样频率 $f_{s}$ 表示。您的推导必须指明并论证以 $f_{s}$ 的整数倍为中心的频谱重复的出现。\n\n2) 将问题特殊化到 $x_{c}(t)$ 是一个频率为 $f_{0}>0$、具有任意幅度和相位的单个实正弦波的情况。仅通过援引离散时间复指数的周期性以及实正弦波表示为复指数之和的方法，推导出一个闭式表达式，用于表示当在奈奎斯特区间 $[0,\\,f_{s}/2]$ 上解释时，采样序列 $x[n]$ 所呈现的观测基带频率（单位为 $\\mathrm{Hz}$）。您的表达式必须仅用 $f_{0}$、$f_{s}$ 和一个明确选择的整数来表示，该整数确保基带表示在该区间内具有最小幅度。不要假设任何先验的混叠公式。\n\n3) 一个PPG在以 $f_s=100\\,\\mathrm{Hz}$ 的频率采样时，受到了一个频率为 $f_0=70\\,\\mathrm{Hz}$ 的肌电伪影干扰。使用您在第2部分得到的结果，确定该伪影在采样数据中出现的单个基带频率（单位为 $\\mathrm{Hz}$）。以 $\\mathrm{Hz}$ 为单位表示最终频率。无需四舍五入。",
            "solution": "该问题陈述是基础离散时间信号处理理论中一个适定的练习，具体涉及连续时间信号的采样。它在科学上是合理的，内部一致，并包含了按照要求从第一性原理推导出唯一解所需的所有必要信息。因此，该问题被认为是有效的。\n\n第1部分：采样信号频谱的推导\n\n该问题将采样过程建模为连续时间信号 $x_c(t)$ 与一个周期性脉冲串 $s(t)$ 的乘积，从而产生采样信号 $x_s(t)$。\n$$x_s(t) = x_c(t) s(t) = x_c(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t-nT_s)$$\n这里，$\\delta(t)$ 是狄拉克δ函数，$T_s$ 是采样周期，$n$ 是一个整数。采样频率为 $f_s = 1/T_s$。\n\n采样信号的傅里叶变换 $X_s(f) = \\mathcal{F}\\{x_s(t)\\}$，可以通过应用傅里叶变换的卷积-乘法对偶性来找到。该性质表明，时域中的乘法对应于频域中的卷积。\n$$X_s(f) = \\mathcal{F}\\{x_c(t) s(t)\\} = (\\mathcal{F}\\{x_c(t)\\} * \\mathcal{F}\\{s(t)\\})(f) = (X_c * S)(f)$$\n其中 $X_c(f)$ 是 $x_c(t)$ 的傅里叶变换，$S(f)$ 是脉冲串 $s(t)$ 的傅里叶变换。\n\n为了求得 $S(f)$，我们首先用傅里叶级数表示周期性脉冲串 $s(t)$。$s(t)$ 的周期是 $T_s$。傅里叶级数系数 $c_k$ 由下式给出：\n$$c_k = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} s(t) \\exp(-j 2\\pi k \\frac{t}{T_s}) dt$$\n在积分区间 $[-T_s/2, T_s/2]$ 内，脉冲串 $s(t)$ 就是 $\\delta(t)$。利用δ函数的筛选特性，我们得到：\n$$c_k = \\frac{1}{T_s} \\int_{-T_s/2}^{T_s/2} \\delta(t) \\exp(-j 2\\pi k f_s t) dt = \\frac{1}{T_s} \\exp(0) = \\frac{1}{T_s} = f_s$$\n因此，$s(t)$ 的傅里叶级数表示为：\n$$s(t) = \\sum_{k=-\\infty}^{\\infty} c_k \\exp(j 2\\pi k \\frac{t}{T_s}) = \\sum_{k=-\\infty}^{\\infty} f_s \\exp(j 2\\pi k f_s t)$$\n现在，我们对这个级数逐项进行傅里叶变换以求得 $S(f)$。我们使用标准傅里叶变换对 $\\mathcal{F}\\{\\exp(j 2\\pi f_{c} t)\\} = \\delta(f-f_{c})$。\n$$S(f) = \\mathcal{F}\\left\\{ f_s \\sum_{k=-\\infty}^{\\infty} \\exp(j 2\\pi k f_s t) \\right\\} = f_s \\sum_{k=-\\infty}^{\\infty} \\mathcal{F}\\{\\exp(j 2\\pi k f_s t)\\} = f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s)$$\n这个结果表明，时域中的狄拉克梳状函数的傅里叶变换是频域中的狄拉克梳状函数，其间隔为 $f_s$，并按 $f_s$ 进行缩放。\n\n最后，我们进行卷积运算 $X_s(f) = (X_c * S)(f)$。利用与δ函数卷积的筛选特性 $(g * \\delta(t-t_0))(t) = g(t-t_0)$，我们得到：\n$$X_s(f) = X_c(f) * \\left( f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) \\right)$$\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} (X_c(f) * \\delta(f - kf_s))$$\n$$X_s(f) = f_s \\sum_{k=-\\infty}^{\\infty} X_c(f - kf_s)$$\n这个方程是傅里叶变换的泊松求和公式。它表明，采样信号的频谱 $X_s(f)$ 由原始频谱 $X_c(f)$ 的周期性重复副本组成，这些副本按采样频率 $f_s$ 进行缩放。这些频谱副本以采样频率的整数倍 $k f_s$ 为中心，其中 $k$ 为所有整数。\n\n第2部分：观测基带频率的推导\n\n我们现在将连续时间信号特殊化为一个频率为 $f_0 > 0$，具有任意幅度 $A$ 和任意相位 $\\phi$ 的单个实正弦波：\n$$x_c(t) = A \\cos(2\\pi f_0 t + \\phi)$$\n使用欧拉公式，我们将此正弦波表示为复指数之和：\n$$x_c(t) = \\frac{A}{2} \\left[ \\exp(j(2\\pi f_0 t + \\phi)) + \\exp(-j(2\\pi f_0 t + \\phi)) \\right]$$\n离散时间序列 $x[n]$ 是通过以均匀速率对 $x_c(t)$ 进行采样得到的，其中 $t = nT_s = n/f_s$：\n$$x[n] = x_c(nT_s) = \\frac{A}{2} \\left[ \\exp(j(2\\pi f_0 \\frac{n}{f_s} + \\phi)) + \\exp(-j(2\\pi f_0 \\frac{n}{f_s} + \\phi)) \\right]$$\n令归一化离散时间频率为 $\\omega_0 = 2\\pi (f_0/f_s)$。该序列可以写为：\n$$x[n] = \\frac{A}{2} \\left[ \\exp(j\\phi)\\exp(j \\omega_0 n) + \\exp(-j\\phi)\\exp(-j \\omega_0 n) \\right]$$\n离散时间复指数的一个基本性质是其在频率上的周期性。对于任何整数 $m$，指数 $\\exp(j\\omega n)$ 与 $\\exp(j(\\omega + 2\\pi m)n)$ 是无法区分的：\n$$\\exp(j(\\omega + 2\\pi m)n) = \\exp(j\\omega n) \\exp(j2\\pi mn) = \\exp(j\\omega n) \\cdot 1 = \\exp(j\\omega n)$$\n因为 $m$ 和 $n$ 都是整数。这意味着，如果两个离散时间频率相差 $2\\pi$ 的整数倍，则它们是等效的。\n\n因此，离散时间频率 $\\omega_0$ 与任何频率 $\\omega_0 - 2\\pi k$（对于任何整数 $k$）都是无法区分的。就模拟频率 $f_0$ 而言，这意味着在以频率 $f_s$ 采样后，频率 $f_0$ 与频率 $f_0 - k f_s$ 无法区分。同样，$-f_0$ 与 $-f_0 + k f_s$ 无法区分。采样后正弦波的观测频率将是落入基带范围的频率分量。\n\n问题要求的是奈奎斯特区间 $[0, f_s/2]$ 内的观测频率。这对应于 $[0, \\pi]$ 的离散时间频率范围。令观测到的基带频率为 $f_{obs}$。我们必须找到一个整数 $k$，使得混叠频率（可以认为是 $f_0$ 模 $f_s$ 的余数）落入主值范围 $[-f_s/2, f_s/2]$，然后其幅度给出 $f_{obs}$。\n对于某个整数 $k$，观测频率 $f_{obs}$ 必须满足以下两个条件之一：\n$$f_{obs} = f_0 - k f_s \\quad \\text{或} \\quad f_{obs} = -(f_0 - k f_s)$$\n将这两者结合起来，我们得到 $f_{obs} = |f_0 - k f_s|$。\n我们寻求位于区间 $[0, f_s/2]$ 内的 $f_{obs}$ 的值。这要求我们选择整数 $k$ 以使量 $f_0 - k f_s$ 最接近于零。使幅度 $|f_0 - k f_s|$ 最小化的整数 $k$ 是最接近比率 $f_0/f_s$ 的整数。这可以用四舍五入函数正式表示。\n\n令明确选择的整数为 $k = \\text{round}(f_0/f_s)$，可以写作 $k = \\lfloor f_0/f_s + 1/2 \\rfloor$。\n通过这个 $k$ 的选择，量 $f_0 - k f_s$ 将在范围 $[-f_s/2, f_s/2]$ 内。观测到的基带频率必须为非负值，是这个量的绝对值。\n因此，观测基带频率的闭式表达式为：\n$$f_{obs} = |f_0 - k f_s|, \\quad \\text{其中} \\quad k = \\left\\lfloor \\frac{f_0}{f_s} + \\frac{1}{2} \\right\\rfloor$$\n这个表达式确保 $0 \\le f_{obs} \\le f_s/2$，如要求所述。\n\n第3部分：特定频率的计算\n\n问题提供了以下具体值：\n- 伪影频率: $f_0 = 70\\,\\mathrm{Hz}$\n- 采样频率: $f_s = 100\\,\\mathrm{Hz}$\n\n我们应用第2部分推导出的公式。首先，我们确定整数 $k$：\n$$\\frac{f_0}{f_s} = \\frac{70}{100} = 0.7$$\n$$k = \\left\\lfloor 0.7 + \\frac{1}{2} \\right\\rfloor = \\lfloor 1.2 \\rfloor = 1$$\n现在，我们将 $k$ 的这个值代入 $f_{obs}$ 的表达式中：\n$$f_{obs} = |f_0 - k f_s| = |70 - (1)(100)| = |70 - 100| = |-30|$$\n$$f_{obs} = 30$$\n肌电伪影的观测基带频率是 $30\\,\\mathrm{Hz}$。该值位于指定的奈奎斯特区间 $[0, f_s/2] = [0, 50]\\,\\mathrm{Hz}$ 内。",
            "answer": "$$\\boxed{30}$$"
        },
        {
            "introduction": "采集到时间序列数据后，我们使用统计指标来量化其特征。在心率变异性（HRV）分析中，RMSSD 和 SDNN 是两个最常用的测量指标，但它们的深层含义常常被忽视。本练习将引导您将这些时域统计量与其底层的频域属性联系起来，揭示为何 RMSSD 是高频（短期）自主神经调节的有力标志。这一推导过程将磨练您的直觉，使您不仅能将 HRV 指标看作是数字，更能将其视为洞察生理过程的窗口。",
            "id": "4613609",
            "problem": "考虑一个在静息状态下从单个个体采集的、以均匀心跳采样的离散时间正常心搏间期（R-R间期）测量序列 $\\{x_t\\}_{t=1}^{N}$。假设 $\\{x_t\\}$ 是宽平稳的，其均值为 $\\mu$，方差为 $\\sigma^{2}$，自协方差函数为 $\\gamma(k) = \\mathbb{E}\\!\\left[(x_t-\\mu)(x_{t-k}-\\mu)\\right]$，滞后1阶自相关为 $\\rho_{1} = \\gamma(1)/\\gamma(0) = \\gamma(1)/\\sigma^{2}$。连续差分均方根（RMSSD）定义为\n$$\n\\mathrm{RMSSD} = \\sqrt{\\frac{1}{N-1}\\sum_{t=2}^{N} \\left(x_t - x_{t-1}\\right)^{2}},\n$$\n正常心搏间期标准差（SDNN）定义为\n$$\n\\mathrm{SDNN} = \\sqrt{\\frac{1}{N}\\sum_{t=1}^{N} \\left(x_t - \\bar{x}\\right)^{2}},\n$$\n其中 $\\bar{x}$ 是样本均值。\n\n从宽平稳过程的方差和自协方差的定义出发，并且除了这些定义之外不引用任何预先推导的关系，推导出一个用 $\\sigma^{2}$ 和 $\\gamma(1)$ 表示 $\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right]$ 在大$N$极限下的表达式。利用这个结果，明确展示 $\\mathrm{RMSSD}^{2}$ 如何与 $\\{x_t\\}$ 的短期方差相关联，并获得一个用 $\\rho_{1}$ 表示的 $\\mathrm{RMSSD}$ 和 $\\mathrm{SDNN}$ 之间的闭式关系。然后，利用一阶差分算子 $d_t = x_t - x_{t-1}$ 的线性时不变滤波解释以及 $\\{x_t\\}$ 的功率谱密度 $S_{x}(\\omega)$ 的定义，在不进行数值计算的情况下，解释为什么 $\\mathrm{RMSSD}$ 比 $\\mathrm{SDNN}$ 对高频（短时间尺度）波动更敏感。\n\n作为您的最终输出，提供用滞后1阶自相关 $\\rho_{1}$ 表示的比率 $\\mathrm{RMSSD}/\\mathrm{SDNN}$ 的精确闭式解析表达式。最终答案必须是一个单一的表达式。不要包含任何单位，也不要提供不等式或方程式。无需四舍五入。",
            "solution": "首先对问题陈述进行验证程序。\n\n### 步骤 1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- 一个离散时间的正常心搏间期测量序列：$\\{x_t\\}_{t=1}^{N}$\n- 过程 $\\{x_t\\}$ 是宽平稳的。\n- 过程均值：$\\mu$\n- 过程方差：$\\sigma^{2}$\n- 自协方差函数：$\\gamma(k) = \\mathbb{E}\\!\\left[(x_t-\\mu)(x_{t-k}-\\mu)\\right]$\n- 滞后1阶自相关：$\\rho_{1} = \\gamma(1)/\\gamma(0) = \\gamma(1)/\\sigma^{2}$\n- 连续差分均方根（RMSSD）：$\\mathrm{RMSSD} = \\sqrt{\\frac{1}{N-1}\\sum_{t=2}^{N} \\left(x_t - x_{t-1}\\right)^{2}}$\n- 正常心搏间期标准差（SDNN）：$\\mathrm{SDNN} = \\sqrt{\\frac{1}{N}\\sum_{t=1}^{N} \\left(x_t - \\bar{x}\\right)^{2}}$\n- 样本均值：$\\bar{x}$\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题牢固地植根于时间序列数据的统计分析，特别是在心率变异性（HRV）分析这一成熟领域。宽平稳、自相关、RMSSD 和 SDNN 等概念都是标准、有效且广泛应用于生物医学信号处理中的。问题的前提在事实上是合理的。\n- **适定性**：该问题是适定的。它要求基于所提供的定义和假设推导特定的关系。使用大$N$极限是一种标准且恰当的简化方法，它允许将样本矩视为其总体对应物，从而确保存在唯一且有意义的解析解。\n- **客观性**：该问题使用精确、无歧义的数学语言进行表述。它不含任何主观或基于观点的陈述。\n\n该问题没有表现出任何列出的缺陷（例如，科学上不健全、不完整、模糊不清）。所有术语都是标准的，它们之间的关系可以通过既有的数理统计方法推导出来。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。现提供一个完整的、附有推理的解答。\n\n该问题需要一个包含三部分的推导和解释。我们将按顺序处理每个部分。\n\n首先，我们推导 $\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right]$ 的表达式。期望是针对宽平稳过程 $\\{x_t\\}$ 的系综来计算的。\n根据期望算子的线性性质，我们可以展开平方差：\n$$\n\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right] = \\mathbb{E}\\!\\left[x_t^2 - 2x_t x_{t-1} + x_{t-1}^2\\right] = \\mathbb{E}\\!\\left[x_t^2\\right] - 2\\mathbb{E}\\!\\left[x_t x_{t-1}\\right] + \\mathbb{E}\\!\\left[x_{t-1}^2\\right]\n$$\n对于一个均值为 $\\mu$、方差为 $\\sigma^2$ 的宽平稳过程，我们有以下关系。方差定义为 $\\sigma^2 = \\gamma(0) = \\mathbb{E}\\!\\left[(x_t - \\mu)^2\\right] = \\mathbb{E}\\!\\left[x_t^2\\right] - \\left(\\mathbb{E}[x_t]\\right)^2 = \\mathbb{E}\\!\\left[x_t^2\\right] - \\mu^2$。这给出 $\\mathbb{E}\\!\\left[x_t^2\\right] = \\sigma^2 + \\mu^2$。由于过程是平稳的，各阶矩与时间指数 $t$ 无关，所以 $\\mathbb{E}\\!\\left[x_{t-1}^2\\right] = \\mathbb{E}\\!\\left[x_t^2\\right] = \\sigma^2 + \\mu^2$。\n\n滞后 $k=1$ 时的自协方差定义为 $\\gamma(1) = \\mathbb{E}\\!\\left[(x_t - \\mu)(x_{t-1} - \\mu)\\right]$。将其展开得到：\n$$\n\\gamma(1) = \\mathbb{E}\\!\\left[x_t x_{t-1} - \\mu x_t - \\mu x_{t-1} + \\mu^2\\right] = \\mathbb{E}\\!\\left[x_t x_{t-1}\\right] - \\mu\\mathbb{E}\\!\\left[x_t\\right] - \\mu\\mathbb{E}\\!\\left[x_{t-1}\\right] + \\mu^2\n$$\n由于 $\\mathbb{E}\\!\\left[x_t\\right] = \\mathbb{E}\\!\\left[x_{t-1}\\right] = \\mu$，这可以简化为 $\\gamma(1) = \\mathbb{E}\\!\\left[x_t x_{t-1}\\right] - \\mu^2 - \\mu^2 + \\mu^2 = \\mathbb{E}\\!\\left[x_t x_{t-1}\\right] - \\mu^2$。这给出了交叉矩的表达式：$\\mathbb{E}\\!\\left[x_t x_{t-1}\\right] = \\gamma(1) + \\mu^2$。\n\n将这些结果代回到展开的期望表达式中：\n$$\n\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right] = (\\sigma^2 + \\mu^2) - 2(\\gamma(1) + \\mu^2) + (\\sigma^2 + \\mu^2)\n$$\n$$\n\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right] = \\sigma^2 + \\mu^2 - 2\\gamma(1) - 2\\mu^2 + \\sigma^2 + \\mu^2\n$$\n$$\n\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right] = 2\\sigma^2 - 2\\gamma(1) = 2(\\sigma^2 - \\gamma(1))\n$$\n这就是用 $\\sigma^2$ 和 $\\gamma(1)$ 表示 $\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right]$ 所需的表达式。\n\n其次，我们建立 RMSSD 和 SDNN 之间的关系。在样本数量很大（$N \\to \\infty$）的极限情况下，样本平均值会收敛于系综期望，前提是该过程是遍历的（这对于宽平稳过程通常是假定的）。\n因此，$\\mathrm{RMSSD}^2$ 成为 $\\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right]$ 的一个无偏且一致的估计量：\n$$\n\\lim_{N \\to \\infty} \\mathrm{RMSSD}^2 = \\lim_{N \\to \\infty} \\frac{1}{N-1}\\sum_{t=2}^{N} \\left(x_t - x_{t-1}\\right)^{2} = \\mathbb{E}\\!\\left[(x_t - x_{t-1})^{2}\\right]\n$$\n类似地，$\\mathrm{SDNN}^2$ 是过程方差 $\\sigma^2$ 的一个一致估计量：\n$$\n\\lim_{N \\to \\infty} \\mathrm{SDNN}^2 = \\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{t=1}^{N} \\left(x_t - \\bar{x}\\right)^{2} = \\sigma^2\n$$\n使用这些大$N$近似，我们可以写出：\n$$\n\\mathrm{RMSSD}^2 \\approx 2(\\sigma^2 - \\gamma(1))\n$$\n$\\mathrm{RMSSD}^2$ 这个量与连续差分的方差成正比，因此反映了短期变异性，而这个方程显示了它如何与整个过程的方差（$\\sigma^2$）及其相关结构（$\\gamma(1)$）相关联。\n现在我们引入滞后1阶自相关系数 $\\rho_1 = \\gamma(1)/\\gamma(0)$。由于 $\\gamma(0)=\\sigma^2$，我们有 $\\gamma(1) = \\rho_1 \\sigma^2$。将此代入 $\\mathrm{RMSSD}^2$ 的表达式中：\n$$\n\\mathrm{RMSSD}^2 \\approx 2(\\sigma^2 - \\rho_1 \\sigma^2) = 2\\sigma^2(1 - \\rho_1)\n$$\n最后，我们代入 $\\sigma^2 \\approx \\mathrm{SDNN}^2$：\n$$\n\\mathrm{RMSSD}^2 \\approx 2 \\cdot \\mathrm{SDNN}^2 (1 - \\rho_1)\n$$\n对两边取平方根，得到 RMSSD 和 SDNN 之间的关系：\n$$\n\\mathrm{RMSSD} \\approx \\sqrt{2(1 - \\rho_1)} \\cdot \\mathrm{SDNN}\n$$\n由此，比率 $\\mathrm{RMSSD}/\\mathrm{SDNN}$ 可以用 $\\rho_1$ 来表示。\n\n第三，我们为 RMSSD 和 SDNN 的不同敏感性提供一个频域解释。产生连续差分序列 $d_t = x_t - x_{t-1}$ 的操作可以建模为将信号 $x_t$ 通过一个线性时不变（LTI）滤波器。这个一阶差分滤波器的冲激响应是 $h[n] = \\delta[n] - \\delta[n-1]$，其中 $\\delta[n]$ 是克罗内克（Kronecker）δ函数。\n该滤波器的频率响应 $H(\\omega)$ 是其冲激响应的离散时间傅里叶变换（DTFT）：\n$$\nH(\\omega) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-i\\omega n) = 1 \\cdot \\exp(-i\\omega \\cdot 0) - 1 \\cdot \\exp(-i\\omega \\cdot 1) = 1 - \\exp(-i\\omega)\n$$\n滤波器的功率传输函数是其频率响应的幅值平方：\n$$\n|H(\\omega)|^2 = |1 - \\cos(\\omega) + i\\sin(\\omega)|^2 = (1-\\cos(\\omega))^2 + \\sin^2(\\omega) = 1 - 2\\cos(\\omega) + \\cos^2(\\omega) + \\sin^2(\\omega) = 2 - 2\\cos(\\omega)\n$$\n使用半角恒等式 $1 - \\cos(\\omega) = 2\\sin^2(\\omega/2)$，上式变为：\n$$\n|H(\\omega)|^2 = 4\\sin^2(\\omega/2)\n$$\n输出信号 $d_t$ 的功率谱密度（PSD）是 $S_d(\\omega) = |H(\\omega)|^2 S_x(\\omega)$，其中 $S_x(\\omega)$ 是输入信号 $x_t$ 的功率谱密度。\n差分序列的均值为 $\\mathbb{E}[d_t] = \\mathbb{E}[x_t - x_{t-1}] = \\mu - \\mu = 0$。因此，其方差为 $\\mathbb{E}[d_t^2]$。在大$N$极限下，$\\mathrm{RMSSD}^2 \\approx \\mathbb{E}[d_t^2]$。根据维纳-辛钦定理（Wiener-Khinchin theorem），方差是功率谱密度的积分：\n$$\n\\mathrm{RMSSD}^2 \\approx \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} S_d(\\omega) d\\omega = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |H(\\omega)|^2 S_x(\\omega) d\\omega = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} 4\\sin^2(\\omega/2) S_x(\\omega) d\\omega\n$$\n滤波器的功率传输函数 $|H(\\omega)|^2 = 4\\sin^2(\\omega/2)$ 充当一个加权函数。该函数在 $\\omega=0$（直流频率）处为0，并在 $\\omega=\\pm\\pi$（奈奎斯特频率）处增加到其最大值4。这是一个高通滤波器的特性。因此，RMSSD 是对信号 $x_t$ 中经过滤波以强调其高频分量的功率的度量。\n\n相比之下，$\\mathrm{SDNN}^2$ 是总方差 $\\sigma^2$ 的估计量。方差是零均值过程的总功率，即其功率谱密度在所有频率上的积分：\n$$\n\\mathrm{SDNN}^2 \\approx \\sigma^2 = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} S_x(\\omega) d\\omega\n$$\n这等效于使用一个对所有 $\\omega$ 都有 $|H(\\omega)|^2=1$ 的功率传输函数的滤波器。这是一个全通滤波器，意味着它对所有频率同等加权。\n通过比较加权函数——RMSSD 的高通滤波器与 SDNN 的全通滤波器——可以清楚地看出，RMSSD 内在地对 R-R 间期时间序列中的高频（短时间尺度）波动更为敏感，而 SDNN 则反映了所有频率上的总功率。\n\n最后，问题要求给出比率 $\\mathrm{RMSSD}/\\mathrm{SDNN}$ 的闭式解析表达式。根据我们的推导，我们有：\n$$\n\\frac{\\mathrm{RMSSD}}{\\mathrm{SDNN}} \\approx \\sqrt{2(1 - \\rho_1)}\n$$\n这是基于大$N$近似的最终表达式，这也是该关系的标准背景。",
            "answer": "$$\\boxed{\\sqrt{2(1 - \\rho_{1})}}$$"
        },
        {
            "introduction": "现代生理信号分析越来越依赖于深度学习，但构建有效的模型需要深刻理解其架构。本练习聚焦于时间卷积网络（TCN），这是一种用于序列建模的先进架构。您将从膨胀卷积的背景下推导感受野的概念，探索 TCN 如何在没有循环网络复杂性的情况下，高效地捕捉跨越巨大时间尺度的信息。这种亲身实践的架构分析，对于为心率变异性（HRV）等长生理时间序列设计和部署稳健的深度学习解决方案至关重要。",
            "id": "4613631",
            "problem": "通过使用三次样条插值，以 $f_s = 4$ Hz 的均匀采样率对逐搏间隔数据进行重采样，可以获得一个短期心率变异性（HRV）时间序列。您正在为HRV分析设计一个一维因果时间卷积网络（TCN），以在不使用任何循环连接的情况下，捕捉数分钟内的高频和低频自主神经模式。每个TCN层执行一次步长为$1$的因果扩张卷积，无池化操作，并且所有层使用相同的核大小$k$。设$L$个层的扩张方案为$\\{d_{1}, d_{2}, \\dots, d_{L}\\}$，其中第$\\ell$层的扩张因子$d_{\\ell}$是以该层输入的样本数为单位来度量的。所有卷积都在左侧进行零填充，以保持因果性并保留输出长度。\n\n仅从一维因果卷积和扩张的定义出发，推导TCN输出在任意固定时间索引处相对于原始HRV输入序列的有效感受野长度（以样本为单位）的闭式表达式，记为 $R(L, k, \\{d_{\\ell}\\}_{\\ell=1}^{L})$。然后，将该表达式特化到几何（指数增长）扩张 $d_{\\ell} = 2^{\\ell-1}$ 和恒定核大小 $k = 3$ 的情况。\n\n如果设计要求是感受野必须至少覆盖过去 $T = 300$ 秒的HRV上下文，以稳健地整合多尺度自主神经模式（包括低频分量），请确定在上述特化条件下满足此要求所需的最小层数 $L_{\\min}$。将最终答案表示为单个整数。无需四舍五入。此外，在您的推导中，通过将跨层的扩张变化与所表示的时间尺度范围联系起来，解释为什么扩张机制能够在没有循环的情况下实现HRV模式的多尺度整合。最终答案必须是 $L_{\\min}$ 的单个值（无单位）。",
            "solution": "用户想要解决以下问题：\n通过使用三次样条插值，以 $f_{s} = 4$ Hz 的均匀采样率对逐搏间隔数据进行重采样，可以获得一个短期心率变异性（HRV）时间序列。您正在为HRV分析设计一个一维因果时间卷积网络（TCN），以在不使用任何循环连接的情况下，捕捉数分钟内的高频和低频自主神经模式。每个TCN层执行一次步长为$1$的因果扩张卷积，无池化操作，并且所有层使用相同的核大小$k$。设$L$个层的扩张方案为$\\{d_{1}, d_{2}, \\dots, d_{L}\\}$，其中第$\\ell$层的扩张因子$d_{\\ell}$是以该层输入的样本数为单位来度量的。所有卷积都在左侧进行零填充，以保持因果性并保留输出长度。\n\n仅从一维因果卷积和扩张的定义出发，推导TCN输出在任意固定时间索引处相对于原始HRV输入序列的有效感受野长度（以样本为单位）的闭式表达式，记为 $R(L, k, \\{d_{\\ell}\\}_{\\ell=1}^{L})$。然后，将该表达式特化到几何（指数增长）扩张 $d_{\\ell} = 2^{\\ell-1}$ 和恒定核大小 $k = 3$ 的情况。\n\n如果设计要求是感受野必须至少覆盖过去 $T = 300$ 秒的HRV上下文，以稳健地整合多尺度自主神经模式（包括低频分量），请确定在上述特化条件下满足此要求所需的最小层数 $L_{\\min}$。将最终答案表示为单个整数。无需四舍五入。此外，在您的推导中，通过将跨层的扩张变化与所表示的时间尺度范围联系起来，解释为什么扩张机制能够在没有循环的情况下实现HRV模式的多尺度整合。最终答案必须是 $L_{\\min}$ 的单个值（无单位）。\n\n首先对问题进行验证。\n\n### 第1步：提取已知条件\n- 输入数据：心率变异性（HRV）时间序列。\n- 采样率：$f_s = 4$ Hz。\n- 网络架构：一维因果时间卷积网络（TCN）。\n- 层数：$L$。\n- 卷积属性：\n    - 因果和扩张。\n    - 步长：$1$。\n    - 池化：无。\n    - 核大小：$k$，在各层中保持不变。\n    - 填充：因果填充（左侧零填充）以保持长度。\n- 扩张方案：$\\{d_1, d_2, \\dots, d_L\\}$。\n- 任务1：推导通用感受野长度 $R(L, k, \\{d_\\ell\\}_{\\ell=1}^{L})$。\n- 任务2：将公式特化为几何扩张 $d_\\ell = 2^{\\ell-1}$ 和核大小 $k=3$ 的情况。\n- 任务3：计算使感受野至少覆盖 $T = 300$ 秒上下文所需的最小层数 $L_{\\min}$。\n- 任务4：解释通过扩张实现的多尺度整合。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题在深度学习和生物医学信号处理领域有充分的依据。TCN是时间序列分析的标准架构，其在HRV数据上的应用是一个常见且有效的研究领域。所选参数（$f_s=4$ Hz, $T=300$ s）是短期HRV分析的标准参数。\n- **适定性**：问题陈述清晰，包含了推导感受野公式和计算所需层数的所有必要信息。目标明确。\n- **客观性**：问题使用精确的技术语言表述，没有主观性或模糊性。\n- **缺陷清单**：该问题没有违反任何指定的无效标准。它在科学上是合理的，可形式化的，完整的，现实的，适定的，非平凡的，并且是可验证的。\n\n### 第3步：结论和行动\n问题是**有效的**。将提供完整解答。\n\n### 感受野的推导\n\n设输入序列为 $x$，第 $\\ell$ 层的输出为 $y^{(\\ell)}$。第 $\\ell$ 层中核大小为 $k$、扩张因子为 $d_\\ell$ 的因果扩张卷积，根据其在索引 $\\{t, t-d_\\ell, t-2d_\\ell, \\dots, t-(k-1)d_\\ell\\}$ 处的输入（即第 $\\ell-1$ 层的输出），计算在时间索引 $t$ 处的输出。步长为 $1$。\n\n设 $R_\\ell$ 表示第 $\\ell$ 层的一个输出相对于原始输入序列 $x$ 的感受野大小（以样本为单位）。\n\n对于第一层（$\\ell=1$），卷积直接作用于输入序列 $x$。输出 $y^{(1)}(t)$ 依赖于输入 $\\{x(t), x(t-d_1), \\dots, x(t-(k-1)d_1)\\}$。所跨越的输入样本数量是从最早的样本到最新的样本（含两者）的距离。最新的样本位于索引 $t$，最早的位于 $t-(k-1)d_1$。跨度为 $(t) - (t-(k-1)d_1) + 1 = (k-1)d_1 + 1$。所以，第一层的感受野为：\n$$R_1 = (k-1)d_1 + 1$$\n\n现在考虑第二层（$\\ell=2$）。输出 $y^{(2)}(t)$ 依赖于第1层的输出 $\\{y^{(1)}(t), y^{(1)}(t-d_2), \\dots, y^{(1)}(t-(k-1)d_2)\\}$。要找到 $y^{(2)}(t)$ 相对于原始输入 $x$ 的感受野，我们必须找到影响它的 $x$ 的全部样本范围。能够影响 $y^{(2)}(t)$ 的来自 $x$ 的最新输入是通过 $y^{(1)}(t)$ 传入的，即 $x(t)$。能够影响 $y^{(2)}(t)$ 的来自 $x$ 的最早输入是通过第1层所需的最早输出传入的，即 $y^{(1)}(t-(k-1)d_2)$。$y^{(1)}(t-(k-1)d_2)$ 的感受野从输入索引 $(t-(k-1)d_2) - (k-1)d_1$ 延伸到 $(t-(k-1)d_2)$。因此，$y^{(2)}(t)$ 的完整感受野从索引 $t - (k-1)d_2 - (k-1)d_1$ 延伸到索引 $t$。这个感受野的大小是：\n$$R_2 = (t) - (t - (k-1)d_2 - (k-1)d_1) + 1 = (k-1)d_1 + (k-1)d_2 + 1$$\n\n通过归纳法，我们可以推广这个模式。第 $\\ell$ 层提供的额外跨度是 $(k-1)d_\\ell$。总跨度是每一层跨度之和，再加上当前样本。对于一个有 $L$ 层的TCN，总感受野 $R(L, k, \\{d_\\ell\\}_{\\ell=1}^{L})$ 是每层有效核跨度之和，再加上当前时间步的一个样本。第 $\\ell$ 层滤波器的有效跨度是 $(k-1)d_\\ell$。\n$$R(L, k, \\{d_\\ell\\}_{\\ell=1}^{L}) = 1 + \\sum_{\\ell=1}^{L} (k-1)d_\\ell = 1 + (k-1)\\sum_{\\ell=1}^{L} d_\\ell$$\n这是感受野长度的通用闭式表达式。\n\n### 多尺度整合的解释\n\n扩张机制是TCN能够在没有循环的情况下整合多尺度模式的关键。\n1.  **分层特征提取**：在较低的层（$\\ell$ 较小），扩张因子 $d_\\ell$ 很小。卷积在空间上相近的样本上操作，捕捉细粒度的高频模式。对于HRV，这对应于快速波动，例如与呼吸相关的波动（呼吸性窦性心律不齐，RSA），这些波动属于高频（HF）频段。\n2.  **指数增长的上下文**：在更深的层（$\\ell$ 较大），扩张因子 $d_\\ell$ 呈指数级增长。深层中的卷积结合了来自前一层相距很远的输出。由于这些前一层的输出本身已经是较小时间区域的摘要，因此深层卷积能有效地学习在非常大的时间尺度上“模式的模式”之间的关系。\n3.  **高效的感受野增长**：这种扩张的指数增长使得感受野能够随深度指数增长，而不是像标准CNN中那样线性增长。这意味着TCN可以用适度的层数和不大的核大小实现非常大的感受野。这使得网络能够捕捉HRV的低频（LF）和极低频（VLF）分量，这些分量反映了较慢的自主神经过程，如压力感受器反射控制和体温调节，其时间跨度从几十秒到数分钟不等。\n因此，扩张卷积的堆叠创建了一个滤波器层次结构，每一层专门处理不同的时间尺度，使得网络能够同时建模HRV信号中的短期和长期依赖关系。这是通过前馈架构实现的，避免了循环网络中的梯度消失/爆炸问题和顺序计算的限制。\n\n### 特化与 $L_{\\min}$ 的计算\n\n现在我们将感受野公式特化到给定情况：恒定核大小 $k=3$ 和几何扩张方案 $d_\\ell = 2^{\\ell-1}$。\n将这些代入通用公式：\n$$R(L) = 1 + (3-1)\\sum_{\\ell=1}^{L} 2^{\\ell-1} = 1 + 2\\sum_{\\ell=1}^{L} 2^{\\ell-1}$$\n这个求和是一个有限几何级数。令索引为 $j = \\ell - 1$。该和变为 $\\sum_{j=0}^{L-1} 2^j$。\n几何级数的求和公式是 $\\sum_{j=0}^{n-1} r^j = \\frac{r^n - 1}{r-1}$。\n当 $n=L$ 和 $r=2$ 时，和为：\n$$\\sum_{j=0}^{L-1} 2^j = \\frac{2^L - 1}{2-1} = 2^L - 1$$\n将此结果代回 $R(L)$ 的表达式中：\n$$R(L) = 1 + 2(2^L - 1) = 1 + 2^{L+1} - 2 = 2^{L+1} - 1$$\n这是感受野长度的特化公式。\n\n设计要求是感受野必须至少覆盖 $T = 300$ 秒。采样率为 $f_s = 4$ Hz。我们首先将所需的时间长度转换为样本数。\n$$R_{req} = T \\times f_s = 300 \\, \\text{s} \\times 4 \\, \\text{Hz} = 1200 \\, \\text{samples}$$\n我们需要找到最小的整数 $L$，使得感受野 $R(L)$ 大于或等于 $R_{req}$。\n$$R(L) \\ge R_{req}$$\n$$2^{L+1} - 1 \\ge 1200$$\n$$2^{L+1} \\ge 1201$$\n为了解出 $L$，我们对两边取以2为底的对数：\n$$\\log_2(2^{L+1}) \\ge \\log_2(1201)$$\n$$L+1 \\ge \\log_2(1201)$$\n$$L \\ge \\log_2(1201) - 1$$\n我们可以通过观察2的幂来找到 $\\log_2(1201)$ 的值：\n$$2^{10} = 1024$$\n$$2^{11} = 2048$$\n因为 $1024  1201  2048$，我们知道 $10  \\log_2(1201)  11$。\n因此：\n$$L \\ge (\\text{一个在 } 10 \\text{ 和 } 11 \\text{ 之间的值}) - 1$$\n$$L \\ge (\\text{一个在 } 9 \\text{ 和 } 10 \\text{ 之间的值})$$\n由于 $L$ 必须是整数，满足此不等式的最小整数值是 $10$。\n我们可以验证一下。\n对于 $L=9$：\n$$R(9) = 2^{9+1} - 1 = 2^{10} - 1 = 1024 - 1 = 1023$$\n$1023  1200$，所以 $L=9$ 是不够的。\n对于 $L=10$：\n$$R(10) = 2^{10+1} - 1 = 2^{11} - 1 = 2048 - 1 = 2047$$\n$2047 \\ge 1200$，所以 $L=10$ 是足够的。\n因此，所需的最小层数是 $L_{\\min} = 10$。",
            "answer": "$$\\boxed{10}$$"
        }
    ]
}