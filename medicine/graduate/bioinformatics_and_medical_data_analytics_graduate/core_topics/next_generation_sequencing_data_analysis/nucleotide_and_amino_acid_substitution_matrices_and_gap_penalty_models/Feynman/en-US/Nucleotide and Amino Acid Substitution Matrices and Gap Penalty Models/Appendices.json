{
    "hands_on_practices": [
        {
            "introduction": "Substitution score matrices are the cornerstone of sequence alignment, yet their origins can seem opaque. This exercise demystifies the process by guiding you through the construction of a BLOSUM-like matrix from first principles . By starting with a small block of aligned sequences, you will apply essential concepts like sequence clustering to mitigate sampling bias from closely related proteins and then derive log-odds scores by comparing observed pair frequencies to expected frequencies. This practice provides a concrete understanding of how empirical data is transformed into the scoring systems used daily in bioinformatics research.",
            "id": "4591431",
            "problem": "Consider an ungapped conserved block alignment of four protein sequences, each of length $6$ columns. The sequences are:\n- $S_1$: ACDEFG\n- $S_2$: ACDQFG\n- $S_3$: ASDEFG\n- $S_4$: VCNEYG\n\nAssume that Blocks Substitution Matrix (BLOSUM) clustering is performed using a greedy single-linkage scheme at identity threshold $T = 0.7$. In greedy single-linkage clustering, sequences are treated as nodes in a graph, an edge is drawn between two nodes if their pairwise identity (fraction of identical residues across the aligned columns) is at least $T$, and clusters are the connected components induced by these edges. Within each cluster, assign each sequence a weight equal to the reciprocal of the cluster size, and within-cluster aligned residue pairs are excluded from all subsequent counts. Between clusters, every pair of sequences contributes to observed aligned residue-pair counts, weighted by the product of the weights of the two sequences.\n\nUsing the foundational definitions that log-odds substitution scoring quantifies the information content of observing an aligned residue pair relative to the expectation under independent background composition, perform the following steps from first principles:\n- Determine the clusters at threshold $T$ and the resulting per-sequence weights.\n- Across all columns, enumerate all between-cluster sequence pairs and accumulate weighted counts for each unordered residue pair $\\{i,j\\}$, ignoring within-cluster pairs.\n- Normalize these counts to obtain unordered pair probabilities $p^{\\mathrm{unord}}_{ij}$ over all unordered pairs so that $\\sum_{i \\le j} p^{\\mathrm{unord}}_{ij} = 1$.\n- Convert $p^{\\mathrm{unord}}_{ij}$ to ordered pair probabilities $p_{ij}$ by distributing mass equally between $(i,j)$ and $(j,i)$ for $i \\ne j$, and leaving $p_{ii}$ unchanged, so that $\\sum_{i}\\sum_{j} p_{ij} = 1$.\n- Obtain residue background probabilities $q_i$ from the ordered pair probabilities by summing over alignments to $i$, i.e., $q_i = \\sum_{j} p_{ij}$.\n\nFinally, derive the BLOSUM-like base-$2$ log-odds substitution score for the specific off-diagonal pair $D$ aligned to $N$ using these definitions. Express the final score as an exact base-$2$ logarithm without rounding and without units. No gap penalty model is needed because the block is ungapped, but your derivation should clearly state why gaps would be excluded at this stage under typical block-based substitution matrix construction principles.",
            "solution": "The problem requires the calculation of a BLOSUM-like log-odds score for the amino acid pair (D, N) based on a small, ungapped block alignment of four sequences. The derivation must follow first principles, starting with sequence clustering and weighting, proceeding to pair counting and probability calculations, and concluding with the log-odds score formula.\n\nFirst, we validate the problem statement. The givens are four protein sequences, each of length $L=6$:\n$S_1$: ACDEFG\n$S_2$: ACDQFG\n$S_3$: ASDEFG\n$S_4$: VCNEYG\n\nThe problem as originally presented contained a typographical error in sequence $S_4$. The solution proceeds assuming the corrected sequence $S_4$: `VCNEYG`, which is consistent with the stated length of $L=6$.\n\nThe derivation proceeds in the following steps.\n\n**Step 1: Sequence Clustering and Weighting**\n\nWe first compute the pairwise identity for all sequence pairs. The identity $I(S_a, S_b)$ is the fraction of identical residues in the alignment. The alignment length is $L=6$. The pairs are evaluated against the identity threshold $T = 0.7$.\n\nThe sequences are:\n$S_1$: ACDEFG\n$S_2$: ACDQFG\n$S_3$: ASDEFG\n$S_4$: VCNEYG\n\nPairwise identities:\n- $I(S_1, S_2)$: Matches at columns $1, 2, 3, 5, 6$. Number of matches = $5$. Identity = $5/6 \\approx 0.833$. Since $0.833 > 0.7$, an edge exists between $S_1$ and $S_2$.\n- $I(S_1, S_3)$: Matches at columns $1, 3, 4, 5, 6$. Number of matches = $5$. Identity = $5/6 \\approx 0.833$. Since $0.833 > 0.7$, an edge exists between $S_1$ and $S_3$.\n- $I(S_1, S_4)$: Matches at columns $2, 4, 6$. Number of matches = $3$. Identity = $3/6 = 0.5$. Since $0.5  0.7$, no edge exists between $S_1$ and $S_4$.\n- $I(S_2, S_3)$: Matches at columns $1, 3, 5, 6$. Number of matches = $4$. Identity = $4/6 \\approx 0.667$. Since $0.667  0.7$, no edge exists between $S_2$ and $S_3$.\n- $I(S_2, S_4)$: Matches at columns $2, 6$. Number of matches = $2$. Identity = $2/6 \\approx 0.333$. Since $0.333  0.7$, no edge exists between $S_2$ and $S_4$.\n- $I(S_3, S_4)$: Matches at columns $4, 6$. Number of matches = $2$. Identity = $2/6 \\approx 0.333$. Since $0.333  0.7$, no edge exists between $S_3$ and $S_4$.\n\nBased on single-linkage clustering, we identify connected components. Since $S_1$ is connected to both $S_2$ and $S_3$, the sequences $\\{S_1, S_2, S_3\\}$ form a single cluster. $S_4$ has no edges connecting to it, so it forms a singleton cluster.\nThe clusters are:\n- Cluster 1: $\\{S_1, S_2, S_3\\}$, size $n_1 = 3$.\n- Cluster 2: $\\{S_4\\}$, size $n_2 = 1$.\n\nThe weight for each sequence in a cluster is the reciprocal of the cluster size.\n- For $S_1, S_2, S_3$ in Cluster 1, the weight is $w_1 = w_2 = w_3 = 1/n_1 = 1/3$.\n- For $S_4$ in Cluster 2, the weight is $w_4 = 1/n_2 = 1/1 = 1$.\n\n**Step 2: Accumulate Weighted Pair Counts**\n\nAccording to the rules, we only count residue pairs from sequences in different clusters. The pairs to consider are $(S_1, S_4)$, $(S_2, S_4)$, and $(S_3, S_4)$. Within-cluster pairs like $(S_1, S_2)$ are excluded. The count for each aligned residue pair is weighted by the product of the sequence weights. For all between-cluster pairs here, the weight is $w_i \\times w_4 = (1/3) \\times 1 = 1/3$.\n\nWe enumerate the unordered residue pairs $\\{i,j\\}$ column by column for the between-cluster sequence pairs, and accumulate their weighted counts, denoted $N_{ij}$.\n\n- Alignment pairs from $(S_1, S_4)$: `ACDEFG` vs `VCNEYG` $\\rightarrow$ {A,V}, {C,C}, {D,N}, {E,E}, {F,Y}, {G,G}. Each contributes $1/3$ to its respective count.\n- Alignment pairs from $(S_2, S_4)$: `ACDQFG` vs `VCNEYG` $\\rightarrow$ {A,V}, {C,C}, {D,N}, {Q,E}, {F,Y}, {G,G}. Each contributes $1/3$ to its respective count.\n- Alignment pairs from $(S_3, S_4)$: `ASDEFG` vs `VCNEYG` $\\rightarrow$ {A,V}, {S,C}, {D,N}, {E,E}, {F,Y}, {G,G}. Each contributes $1/3$ to its respective count.\n\nTotal weighted counts for each unordered pair $\\{i,j\\}$:\n- $N_{AV} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{CC} = 1/3 + 1/3 = 2/3$\n- $N_{DN} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{EE} = 1/3 + 1/3 = 2/3$\n- $N_{FY} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{GG} = 1/3 + 1/3 + 1/3 = 1$\n- $N_{EQ} = 1/3$\n- $N_{CS} = 1/3$\n\nAll other pair counts are $0$. The total number of weighted pairs, $N_{tot}$, is the sum of these counts:\n$N_{tot} = 1 + 2/3 + 1 + 2/3 + 1 + 1 + 1/3 + 1/3 = 4 + 6/3 = 4 + 2 = 6$.\nThis matches the total number of contributing pairs ($3$ sequence pairs $\\times 6$ columns) times their weight ($1/3$), i.e., $3 \\times 6 \\times (1/3) = 6$.\n\n**Step 3: Calculate Pair Probabilities ($p^{\\mathrm{unord}}_{ij}$ and $p_{ij}$)**\n\nThe probability of observing an unordered pair $\\{i,j\\}$, $p^{\\mathrm{unord}}_{ij}$, is its weighted count normalized by the total weighted count: $p^{\\mathrm{unord}}_{ij} = N_{ij} / N_{tot}$.\nFor the pair of interest, $\\{D,N\\}$:\n$p^{\\mathrm{unord}}_{DN} = N_{DN} / N_{tot} = 1/6$.\n\nNext, we convert these to ordered pair probabilities, $p_{ij}$, as defined. For $i \\neq j$, $p_{ij} = p_{ji} = p^{\\mathrm{unord}}_{ij} / 2$. For $i=j$, $p_{ii} = p^{\\mathrm{unord}}_{ii}$.\nSince $D \\neq N$, the probability for the ordered pair $(D,N)$ is:\n$p_{DN} = p^{\\mathrm{unord}}_{DN} / 2 = (1/6) / 2 = 1/12$.\n\n**Step 4: Calculate Background Residue Probabilities ($q_i$)**\n\nThe background probability of a residue $i$, $q_i$, is defined in the problem as its overall frequency, derived from the ordered pair probabilities: $q_i = \\sum_{j} p_{ij}$. We need to find $q_D$ and $q_N$.\n\nTo find $q_D$, we sum over all $p_{Dj}$. From the pair counts in Step 2, the only amino acid observed to align with D is N. Therefore, the only non-zero entry in the 'D' row of the ordered probability matrix is $p_{DN}$, which was calculated in Step 3 as $1/12$.\n$q_D = \\sum_{j} p_{Dj} = p_{DN} = 1/12$.\n\nSimilarly, to find $q_N$, we sum over all $p_{Nj}$. The only amino acid observed to align with N is D. The only non-zero entry in the 'N' row is $p_{ND}$. Since $p_{ND} = p_{DN} = 1/12$, we have:\n$q_N = \\sum_{j} p_{Nj} = p_{ND} = 1/12$.\n\nSo, $q_D = 1/12$ and $q_N = 1/12$.\n\n**Step 5: Calculate the Log-Odds Score**\n\nThe log-odds score for a substitution of residue $i$ with residue $j$, $S_{ij}$, compares the observed probability of the alignment, $p_{ij}$, to the expected probability, $e_{ij}$, under a model where residues align randomly according to their background frequencies. The expected probability is $e_{ij} = q_i q_j$. The score is given in base-2 logarithm (bits).\n\n$S_{ij} = \\log_2 \\left( \\frac{p_{ij}}{e_{ij}} \\right) = \\log_2 \\left( \\frac{p_{ij}}{q_i q_j} \\right)$.\n\nWe want to find the score for the pair $(D,N)$, $S_{DN}$:\n- $p_{DN} = 1/12$\n- $q_D = 1/12$\n- $q_N = 1/12$\n\nSubstituting these values:\n$S_{DN} = \\log_2 \\left( \\frac{1/12}{(1/12) \\times (1/12)} \\right) = \\log_2 \\left( \\frac{1}{1/12} \\right) = \\log_2(12)$.\n\nThe final score is requested as an exact base-2 logarithm.\n\n**Exclusion of Gaps**\n\nThe problem specifies an \"ungapped conserved block alignment\", and the procedure for constructing BLOSUM matrices intrinsically excludes gaps from the frequency counts. The rationale is based on the fundamental distinction between substitution and insertion/deletion (indel) events. A substitution matrix like BLOSUM is designed to score the likelihood of one amino acid replacing another over evolutionary time. A gap, represented by a '-', is not an amino acid; it signifies an indel event. The evolutionary processes and probabilities governing substitutions are different from those governing indels. Therefore, scoring alignments involves two separate components: a substitution matrix for matching/mismatching residues and a gap penalty function for indels. To build the substitution matrix, one must isolate pure substitution events. This is achieved by using alignment blocks that are, by definition, free of gaps. Any column containing a gap in the source multiple alignment would be ignored for the purpose of tallying residue-residue pair frequencies.",
            "answer": "$$\\boxed{\\log_{2}(12)}$$"
        },
        {
            "introduction": "While deriving a single scoring matrix is instructive, a more common task in phylogenetics is selecting the best-fitting evolutionary model from a suite of candidates. Different models of nucleotide substitution embody different assumptions about the evolutionary process, ranging from the simple Jukes-Cantor model to the complex General Time Reversible (GTR) model . This practice challenges you to use information criteria like the Akaike Information Criterion ($AIC$) and Bayesian Information Criterion ($BIC$) to quantitatively compare these models, providing hands-on experience with the fundamental trade-off between model fit and parameter complexity.",
            "id": "4591443",
            "problem": "A bioinformatics lab has aggregated high-confidence single-substitution events across a very large ensemble of independent, short evolutionary branches in a clinical genomics pipeline. The events are directed nucleotide changes from an inferred ancestral base to an observed descendant base. Assume the probability of observing an event of type $i \\to j$ (with $i \\neq j$ and $i,j \\in \\{A,C,G,T\\}$) is well-modeled by a multinomial sampling scheme with category probabilities proportional to stationary base frequency–weighted instantaneous substitution flow, i.e., $\\pi_{i} r_{ij}$, where $\\pi_{i}$ is the stationary frequency of base $i$ and $r_{ij}$ is the instantaneous rate from $i$ to $j$. This composite-likelihood approximation is scientifically realistic when multi-hit events are negligible and branch lengths are sufficiently short across the ensemble. Four standard reversible nucleotide substitution models are to be compared: Jukes–Cantor 1969 (JC69), Kimura 2-parameter (K80), Hasegawa–Kishino–Yano 1985 (HKY85), and the General Time Reversible (GTR) model.\n\nObserved directed substitution counts are given by:\n- Transitions: $A \\to G = 520$, $G \\to A = 500$, $C \\to T = 540$, $T \\to C = 515$.\n- Transversions: $A \\to C = 130$, $C \\to A = 125$, $A \\to T = 140$, $T \\to A = 135$, $C \\to G = 110$, $G \\to C = 115$, $G \\to T = 120$, $T \\to G = 118$.\n\nLet $n$ denote the total number of events, let $S_{i} := \\sum_{j \\neq i} c_{ij}$ be the total outgoing counts from base $i$, and let $C_{T}$ and $C_{V}$ denote the total counts of transitions and transversions respectively. You may assume the following well-tested model structures and degrees of freedom under the composite multinomial framework:\n- JC69: equal base frequencies and equal off-diagonal rates, yielding equal category probabilities across the $12$ directed off-diagonal pairs; no free parameter after normalization ($k_{\\mathrm{JC69}} = 0$).\n- K80: equal base frequencies, a transition rate $\\alpha$ and a transversion rate $\\beta$ entering only through their ratio $\\kappa := \\alpha / \\beta$ ($k_{\\mathrm{K80}} = 1$).\n- HKY85: unequal base frequencies $\\pi_{i}$ (subject to $\\sum_{i} \\pi_{i} = 1$) and a transition/transversion ratio $\\kappa$ ($k_{\\mathrm{HKY85}} = 4$, i.e., $3$ independent $\\pi_{i}$ plus $\\kappa$).\n- GTR: six reversible flow parameters for unordered nucleotide pairs under normalization, implemented as symmetric directed-category probabilities across each unordered pair; after normalization there are $5$ free rate parameters ($k_{\\mathrm{GTR}} = 5$). Stationary base frequencies are not separately identifiable in this composite off-diagonal-only formulation.\n\nUse the foundational definitions of the Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC):\n$$\\mathrm{AIC} = -2 \\ln L + 2k, \\quad \\mathrm{BIC} = -2 \\ln L + k \\ln n,$$\nwhere $L$ is the maximized (composite) likelihood under each model and $k$ is the number of free parameters estimated from the counts under the stated composite multinomial parameterization. For each model, derive the maximum likelihood estimates of its parameters from first principles consistent with its constraints, compute the maximized composite log-likelihood $\\ln L$, and then compute both $\\mathrm{AIC}$ and $\\mathrm{BIC}$. Identify the preferred model under each information criterion (i.e., the model with the smallest AIC and the smallest BIC).\n\nFinally, define the penalty-adjusted likelihood under the Akaike Information Criterion (AIC) for the preferred model as\n$$\\Lambda_{\\mathrm{AIC}} := \\exp\\!\\left(-\\frac{\\mathrm{AIC}}{2}\\right).$$\nCompute $\\Lambda_{\\mathrm{AIC}}$ for the preferred model and express your final answer as a single closed-form analytic expression with the numerical counts substituted. No units are required. If you choose to approximate numerically at any step, you must still present the final answer as the exact closed-form expression for $\\Lambda_{\\mathrm{AIC}}$ in terms of elementary functions, with the given integers substituted; do not round the final expression.",
            "solution": "The problem requires a model comparison analysis for four nucleotide substitution models (JC69, K80, HKY85, GTR) using the Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC), based on observed directed substitution counts. The model probabilities are stated to be proportional to $\\pi_i r_{ij}$, where $\\pi_i$ is the stationary frequency of base $i$ and $r_{ij}$ is the instantaneous rate of substitution from $i$ to $j$.\n\nFirst, we aggregate the given substitution counts.\nThe counts are:\n$c_{AG} = 520$, $c_{GA} = 500$, $c_{CT} = 540$, $c_{TC} = 515$.\n$c_{AC} = 130$, $c_{CA} = 125$, $c_{AT} = 140$, $c_{TA} = 135$, $c_{CG} = 110$, $c_{GC} = 115$, $c_{GT} = 120$, $c_{TG} = 118$.\n\nThe total count of transitions is $C_T = c_{AG} + c_{GA} + c_{CT} + c_{TC} = 520 + 500 + 540 + 515 = 2075$.\nThe total count of transversions is $C_V = c_{AC} + c_{CA} + c_{AT} + c_{TA} + c_{CG} + c_{GC} + c_{GT} + c_{TG} = 130+125+140+135+110+115+120+118 = 993$.\nThe total number of observed substitution events is $n = C_T + C_V = 2075 + 993 = 3068$.\n\nThe problem is modeled as a multinomial experiment with $12$ categories (the directed substitutions $i \\to j$, $i \\neq j$). The composite log-likelihood kernel, which we denote $\\ln L$, is given by $\\ln L = \\sum_{i \\neq j} c_{ij} \\ln p_{ij}$, where $p_{ij}$ are the category probabilities under a given model. We omit the multinomial coefficient constant as it does not affect model selection.\n\nWe analyze each model to find its maximized log-likelihood.\n\n**1. Jukes–Cantor (JC69) Model**\nUnder JC69, base frequencies are equal ($\\pi_i = 1/4$) and all substitution rates are equal ($r_{ij} = r$). Thus, the probability $p_{ij} \\propto \\pi_i r_{ij}$ is the same for all $12$ substitution types.\nThe normalization constraint $\\sum_{i \\neq j} p_{ij} = 1$ implies $12 p = 1$, so $p_{ij} = 1/12$ for all $i \\neq j$.\nThere are no free parameters, so $k_{\\mathrm{JC69}} = 0$.\nThe maximized log-likelihood is:\n$$ \\ln L_{\\mathrm{JC69}} = \\sum_{i \\neq j} c_{ij} \\ln\\left(\\frac{1}{12}\\right) = n \\ln\\left(\\frac{1}{12}\\right) = -3068 \\ln(12) $$\n\n**2. Kimura 2-Parameter (K80) Model**\nUnder K80, base frequencies are equal ($\\pi_i = 1/4$). There is one rate for transitions ($\\alpha$) and another for transversions ($\\beta$), with the model parameter being their ratio $\\kappa = \\alpha/\\beta$.\nThere are $4$ transition types and $8$ transversion types.\nThe probability for any transition is $p_T \\propto (1/4)\\alpha$. The probability for any transversion is $p_V \\propto (1/4)\\beta$.\nSo, $p_T/p_V = \\kappa$. The normalization constraint is $4p_T + 8p_V = 1$.\nThe log-likelihood is $\\ln L(\\kappa) = C_T \\ln p_T + C_V \\ln p_V$. The maximum likelihood estimates for the probabilities are $\\hat{p}_T = \\frac{C_T}{4n}$ and $\\hat{p}_V = \\frac{C_V}{8n}$.\nThe maximized log-likelihood is:\n$$ \\ln L_{\\mathrm{K80}} = C_T \\ln\\left(\\frac{C_T}{4n}\\right) + C_V \\ln\\left(\\frac{C_V}{8n}\\right) $$\n$$ \\ln L_{\\mathrm{K80}} = 2075 \\ln\\left(\\frac{2075}{12272}\\right) + 993 \\ln\\left(\\frac{993}{24544}\\right) $$\nThe number of free parameters is $k_{\\mathrm{K80}} = 1$.\n\n**3. Hasegawa–Kishino–Yano (HKY85) Model**\nHKY85 allows for unequal base frequencies $\\pi_i$ and a transition/transversion ratio $\\kappa$. The number of free parameters is $k_{\\mathrm{HKY85}} = 4$.\nThe maximum likelihood estimates for the model parameters are $\\hat{\\kappa} = \\frac{2C_T}{C_V}$ and $\\hat{\\pi}_i = S_i/n$, where $S_i = \\sum_{j \\neq i} c_{ij}$.\nThe counts are: $S_A = 520+130+140=790$, $S_C = 540+125+110=775$, $S_G = 500+115+120=735$, $S_T = 515+135+118=768$.\nThe maximized log-likelihood is:\n$$ \\ln L_{\\mathrm{HKY85}} = \\sum_i S_i \\ln\\left(\\frac{S_i}{n}\\right) + C_T\\ln\\left(\\frac{2C_T}{C_V}\\right) - n\\ln\\left(\\frac{2C_T}{C_V}+2\\right) $$\n\n**4. General Time Reversible (GTR) Model**\nThe GTR model is specified as having symmetric directed-category probabilities, $p_{ij}=p_{ji}$, with $5$ free parameters ($k_{\\mathrm{GTR}} = 5$). This corresponds to a model with $6$ probability parameters for the unordered pairs $\\{i,j\\}$.\nThe MLE for the probability of observing a substitution in the unordered pair $\\{i,j\\}$ is $\\hat{p}_{\\{i,j\\}} = \\frac{c_{ij}+c_{ji}}{2n}$. Let $C_{\\{i,j\\}} = c_{ij}+c_{ji}$.\nThe combined counts are: $C_{\\{AG\\}}=1020, C_{\\{CT\\}}=1055, C_{\\{AC\\}}=255, C_{\\{AT\\}}=275, C_{\\{CG\\}}=225, C_{\\{GT\\}}=238$.\nThe maximized log-likelihood is:\n$$ \\ln L_{\\mathrm{GTR}} = \\sum_{\\{i,j\\}} C_{\\{i,j\\}} \\ln\\left(\\frac{C_{\\{i,j\\}}}{2n}\\right) $$\n\n**Model Comparison**\nWe compute the numerical values for the maximized log-likelihoods:\n- $\\ln L_{\\mathrm{JC69}} = -3068 \\ln(12) \\approx -7622.7$\n- $\\ln L_{\\mathrm{K80}} \\approx 2075 \\ln(0.1691) + 993 \\ln(0.0405) \\approx -6873.0$\n- $\\ln L_{\\mathrm{HKY85}} \\approx -6871.9$\n- $\\ln L_{\\mathrm{GTR}} \\approx -6871.2$\n\nNow we compute AIC and BIC for each model, using $n=3068$ and $\\ln n \\approx 8.029$.\n- $\\mathrm{AIC}_{\\mathrm{JC69}} = -2(-7622.7) + 2(0) = 15245.4$\n- $\\mathrm{BIC}_{\\mathrm{JC69}} = 15245.4 + 0 = 15245.4$\n\n- $\\mathrm{AIC}_{\\mathrm{K80}} = -2(-6873.0) + 2(1) = 13746.0 + 2 = 13748.0$\n- $\\mathrm{BIC}_{\\mathrm{K80}} = 13746.0 + 1 \\ln(3068) \\approx 13746.0 + 8.0 = 13754.0$\n\n- $\\mathrm{AIC}_{\\mathrm{HKY85}} = -2(-6871.9) + 2(4) = 13743.8 + 8 = 13751.8$\n- $\\mathrm{BIC}_{\\mathrm{HKY85}} = 13743.8 + 4 \\ln(3068) \\approx 13743.8 + 32.1 = 13775.9$\n\n- $\\mathrm{AIC}_{\\mathrm{GTR}} = -2(-6871.2) + 2(5) = 13742.4 + 10 = 13752.4$\n- $\\mathrm{BIC}_{\\mathrm{GTR}} = 13742.4 + 5 \\ln(3068) \\approx 13742.4 + 40.1 = 13782.5$\n\nComparing the values (lower is better):\n- By AIC: The K80 model has the lowest AIC ($13748.0$).\n- By BIC: The K80 model has the lowest BIC ($13754.0$).\n\nBoth criteria select the K80 model as the preferred model.\n\n**Final Calculation**\nWe compute the penalty-adjusted likelihood $\\Lambda_{\\mathrm{AIC}} = \\exp(-\\frac{\\mathrm{AIC}}{2})$ for the preferred model, K80.\nUsing the definition of AIC based on the log-likelihood kernel:\n$\\mathrm{AIC}_{\\mathrm{K80}} = -2 \\ln L_{\\mathrm{K80}} + 2k_{\\mathrm{K80}}$\n$$ \\Lambda_{\\mathrm{AIC}} = \\exp\\left(-\\frac{-2 \\ln L_{\\mathrm{K80}} + 2k_{\\mathrm{K80}}}{2}\\right) = \\exp(\\ln L_{\\mathrm{K80}} - k_{\\mathrm{K80}}) = \\exp(\\ln L_{\\mathrm{K80}} - 1) $$\nSubstituting the expression for $\\ln L_{\\mathrm{K80}}$:\n$$ \\Lambda_{\\mathrm{AIC}} = \\exp\\left( C_T \\ln\\left(\\frac{C_T}{4n}\\right) + C_V \\ln\\left(\\frac{C_V}{8n}\\right) - 1 \\right) $$\n$$ \\Lambda_{\\mathrm{AIC}} = \\exp(-1) \\left(\\frac{C_T}{4n}\\right)^{C_T} \\left(\\frac{C_V}{8n}\\right)^{C_V} $$\nWe factor out the terms involving $n$ and powers of $2$:\n$$ \\Lambda_{\\mathrm{AIC}} = \\exp(-1) \\frac{C_T^{C_T} C_V^{C_V}}{ (4n)^{C_T} (8n)^{C_V} } = \\exp(-1) \\frac{C_T^{C_T} C_V^{C_V}}{ 4^{C_T} 8^{C_V} n^{C_T+C_V} } $$\n$$ \\Lambda_{\\mathrm{AIC}} = \\exp(-1) \\frac{C_T^{C_T} C_V^{C_V}}{ (2^2)^{C_T} (2^3)^{C_V} n^n } = \\exp(-1) \\frac{C_T^{C_T} C_V^{C_V}}{ n^n 2^{2C_T+3C_V} } $$\nSubstituting the numerical counts: $C_T=2075$, $C_V=993$, $n=3068$.\nThe exponent for $2$ is $2(2075) + 3(993) = 4150 + 2979 = 7129$.\nThe final expression is:\n$$ \\Lambda_{\\mathrm{AIC}} = \\exp(-1) \\frac{2075^{2075} \\cdot 993^{993}}{3068^{3068} \\cdot 2^{7129}} $$",
            "answer": "$$\n\\boxed{\\exp(-1) \\frac{2075^{2075} \\cdot 993^{993}}{3068^{3068} \\cdot 2^{7129}}}\n$$"
        },
        {
            "introduction": "A high alignment score is meaningless without a statistical context. This practice delves into the Karlin-Altschul statistics that underpin the significance estimates for local alignment scores, such as those produced by BLAST . You will explore the central equation that defines the parameter $\\lambda$, a key component for calculating the P-value of a score. By solving for $\\lambda$ both before and after the practical step of integerizing score values, you will gain a deeper appreciation for the theoretical foundations of sequence comparison and the subtle effects of implementation choices on statistical outcomes.",
            "id": "4591501",
            "problem": "Consider a nucleotide scoring scheme over the alphabet $\\{A, C, G, T\\}$ with uniform background frequencies $q_{A} = q_{C} = q_{G} = q_{T} = \\frac{1}{4}$. The score matrix $S$ assigns $S_{ii} = s_{\\mathrm{m}}$ for matches and $S_{ij} = s_{\\mathrm{x}}$ for mismatches, with $s_{\\mathrm{m}} = 1.64$ and $s_{\\mathrm{x}} = -1.64$. In the theory of local alignments, the parameter $\\lambda$ is defined as the unique positive solution to the moment generating function equation\n$$\\sum_{i,j} q_{i} q_{j} \\exp\\!\\big(\\lambda\\, S_{ij}\\big) = 1.$$\nIntegerization of substitution matrices is a common step when implementing scoring in dynamic programming. Let the integerized matrix $S'$ be obtained by rounding each entry of $S$ to the nearest integer, so that $S'_{ii} = 2$ and $S'_{ij} = -2$.\n\nStarting from fundamental definitions of background frequencies and log-odds scoring, and using the moment generating function equation above, determine the unique positive $\\lambda$ that solves the equation before integerization (using $S$) and after integerization (using $S'$). Then compute the absolute relative change\n$$\\Delta = \\frac{|\\lambda_{\\mathrm{int}} - \\lambda_{\\mathrm{real}}|}{\\lambda_{\\mathrm{real}}},$$\nwhere $\\lambda_{\\mathrm{real}}$ is the solution using $S$ and $\\lambda_{\\mathrm{int}}$ is the solution using $S'$. Express $\\Delta$ as a pure number (dimensionless). Round your final answer to four significant figures.",
            "solution": "The problem is evaluated as scientifically grounded, well-posed, and objective. It is based on the established statistical framework of local sequence alignment (Karlin-Altschul statistics), provides all necessary data and definitions, and is free of ambiguity or contradiction. The condition for the existence of a unique positive $\\lambda$, namely that the expected score is negative, is met for both the real and integerized scoring matrices. We may therefore proceed with the solution.\n\nThe problem requires us to find the parameter $\\lambda$ which is the unique positive solution to the equation:\n$$ \\sum_{i,j} q_{i} q_{j} \\exp(\\lambda S_{ij}) = 1 $$\nThe alphabet is $\\{A, C, G, T\\}$, so there are $4 \\times 4 = 16$ pairs of $(i,j)$. The given background frequencies are uniform: $q_{A} = q_{C} = q_{G} = q_{T} = \\frac{1}{4}$. Thus, for any pair $(i,j)$, the product of background frequencies is $q_{i} q_{j} = (\\frac{1}{4})(\\frac{1}{4}) = \\frac{1}{16}$.\n\nThe summation can be partitioned into two parts: one for matches where $i=j$ and one for mismatches where $i \\neq j$. There are $4$ possible matches $((A,A), (C,C), (G,G), (T,T))$ and $16 - 4 = 12$ possible mismatches. The scoring matrix $S$ has a constant score for all matches, $S_{ii} = s_{\\mathrm{m}}$, and a constant score for all mismatches, $S_{ij} = s_{\\mathrm{x}}$ for $i \\neq j$.\n\nThe equation can thus be written as:\n$$ 4 \\cdot \\left(q_i q_j\\right) \\exp(\\lambda s_{\\mathrm{m}}) + 12 \\cdot \\left(q_i q_j\\right) \\exp(\\lambda s_{\\mathrm{x}}) = 1 $$\nSubstituting $q_i q_j = \\frac{1}{16}$:\n$$ 4 \\cdot \\frac{1}{16} \\exp(\\lambda s_{\\mathrm{m}}) + 12 \\cdot \\frac{1}{16} \\exp(\\lambda s_{\\mathrm{x}}) = 1 $$\n$$ \\frac{1}{4} \\exp(\\lambda s_{\\mathrm{m}}) + \\frac{3}{4} \\exp(\\lambda s_{\\mathrm{x}}) = 1 $$\n\nFirst, we calculate $\\lambda_{\\mathrm{real}}$ using the real-valued score matrix $S$, where $s_{\\mathrm{m}} = 1.64$ and $s_{\\mathrm{x}} = -1.64$.\nSubstituting these values into the equation:\n$$ \\frac{1}{4} \\exp(1.64 \\lambda_{\\mathrm{real}}) + \\frac{3}{4} \\exp(-1.64 \\lambda_{\\mathrm{real}}) = 1 $$\nTo solve this transcendental equation, let $y = \\exp(1.64 \\lambda_{\\mathrm{real}})$. The equation becomes:\n$$ \\frac{1}{4} y + \\frac{3}{4} y^{-1} = 1 $$\nMultiplying the entire equation by $4y$ to clear the denominator and the negative exponent gives:\n$$ y^2 + 3 = 4y $$\nRearranging into a standard quadratic form:\n$$ y^2 - 4y + 3 = 0 $$\nThis quadratic equation can be factored as:\n$$ (y - 1)(y - 3) = 0 $$\nThe solutions for $y$ are $y = 1$ and $y = 3$. We substitute back $y = \\exp(1.64 \\lambda_{\\mathrm{real}})$.\nCase 1: $y = 1$.\n$$ \\exp(1.64 \\lambda_{\\mathrm{real}}) = 1 $$\n$$ 1.64 \\lambda_{\\mathrm{real}} = \\ln(1) = 0 $$\n$$ \\lambda_{\\mathrm{real}} = 0 $$\nThis is the trivial solution. The theory of Karlin-Altschul statistics guarantees a unique positive solution for $\\lambda$ when the expected score is negative, so we seek the non-zero solution.\n\nCase 2: $y = 3$.\n$$ \\exp(1.64 \\lambda_{\\mathrm{real}}) = 3 $$\n$$ 1.64 \\lambda_{\\mathrm{real}} = \\ln(3) $$\n$$ \\lambda_{\\mathrm{real}} = \\frac{\\ln(3)}{1.64} $$\nThis is the required unique positive solution.\n\nNext, we calculate $\\lambda_{\\mathrm{int}}$ using the integerized score matrix $S'$, where $s'_{\\mathrm{m}} = 2$ and $s'_{\\mathrm{x}} = -2$. The procedure is identical. The governing equation is:\n$$ \\frac{1}{4} \\exp(\\lambda s'_{\\mathrm{m}}) + \\frac{3}{4} \\exp(\\lambda s'_{\\mathrm{x}}) = 1 $$\n$$ \\frac{1}{4} \\exp(2 \\lambda_{\\mathrm{int}}) + \\frac{3}{4} \\exp(-2 \\lambda_{\\mathrm{int}}) = 1 $$\nLet $z = \\exp(2 \\lambda_{\\mathrm{int}})$. The equation becomes:\n$$ \\frac{1}{4} z + \\frac{3}{4} z^{-1} = 1 $$\n$$ z^2 - 4z + 3 = 0 $$\nThis is the same quadratic equation as before, with solutions $z=1$ and $z=3$. Again, we discard the solution that leads to $\\lambda_{\\mathrm{int}} = 0$. The unique positive solution comes from $z=3$:\n$$ \\exp(2 \\lambda_{\\mathrm{int}}) = 3 $$\n$$ 2 \\lambda_{\\mathrm{int}} = \\ln(3) $$\n$$ \\lambda_{\\mathrm{int}} = \\frac{\\ln(3)}{2} $$\n\nFinally, we compute the absolute relative change $\\Delta$:\n$$ \\Delta = \\frac{|\\lambda_{\\mathrm{int}} - \\lambda_{\\mathrm{real}}|}{\\lambda_{\\mathrm{real}}} $$\nSubstituting the expressions we found for $\\lambda_{\\mathrm{real}}$ and $\\lambda_{\\mathrm{int}}$:\n$$ \\Delta = \\frac{\\left|\\frac{\\ln(3)}{2} - \\frac{\\ln(3)}{1.64}\\right|}{\\frac{\\ln(3)}{1.64}} $$\nSince $\\ln(3) > 0$, we can factor it out from the numerator and cancel it with the denominator:\n$$ \\Delta = \\frac{\\ln(3) \\left|\\frac{1}{2} - \\frac{1}{1.64}\\right|}{\\ln(3) \\left(\\frac{1}{1.64}\\right)} = 1.64 \\cdot \\left|\\frac{1}{2} - \\frac{1}{1.64}\\right| $$\nAs $1.64  2$, we have $\\frac{1}{2}  \\frac{1}{1.64}$. Therefore, the term inside the absolute value is positive, so we can remove the absolute value bars after reordering:\n$$ \\Delta = 1.64 \\cdot \\left(\\frac{1}{1.64} - \\frac{1}{2}\\right) $$\nDistributing the $1.64$:\n$$ \\Delta = 1.64 \\cdot \\frac{1}{1.64} - 1.64 \\cdot \\frac{1}{2} = 1 - \\frac{1.64}{2} = 1 - 0.82 $$\n$$ \\Delta = 0.18 $$\nThe problem asks for the answer to be rounded to four significant figures.\n$$ \\Delta = 0.1800 $$",
            "answer": "$$\n\\boxed{0.1800}\n$$"
        }
    ]
}