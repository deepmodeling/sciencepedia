{
    "hands_on_practices": [
        {
            "introduction": "比对的统计显著性不仅取决于序列本身的相似度，还深刻地依赖于搜索空间的大小。本练习将引导你推导期望值（E-value）和比特分数（bit score）之间的关键关系，并量化数据库大小的变化如何直接影响我们对一个固定比对分数的信心。这个基础练习阐明了为什么在不同规模的数据库中获得相同分数的比对，其统计意义可能截然不同 。",
            "id": "4538924",
            "problem": "一个研究小组正在两种实际环境中进行蛋白质同源性搜索：一个靶向的临床病原体数据库和一个全面的宏基因组数据库。同一个长度为 $m = 1200$ 个氨基酸的蛋白质查询序列，在与两个数据库中都存在的特定目标序列进行最高分比对时，产生了报告的基础局部比对搜索工具 (Basic Local Alignment Search Tool, BLAST) 比特分 $S' = 65$。病原体数据库的总长度为 $n_{A} = 5.0 \\times 10^{7}$ 个氨基酸，宏基因组数据库的总长度为 $n_{B} = 3.0 \\times 10^{9}$ 个氨基酸。假设 Karlin–Altschul 局部比对得分模型适用，且所用打分系统的统计参数是固定的，并且在此设置中有效长度可视为等于实际长度。\n\n从与 Karlin–Altschul 统计学和 BLAST 比特分相关的基本定义出发，推导出随机高分比对的期望数量（E-值）关于查询序列长度 $m$、数据库长度 $n$ 和比特分 $S'$ 的表达式。然后，使用该表达式，通过计算倍数变化 $\\frac{E_{B}}{E_{A}}$ 来量化 E-值从数据库 A 变到数据库 B 时的变化情况。\n\n提供 $\\frac{E_{B}}{E_{A}}$ 的最终数值，并将您的答案四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "题目要求推导 BLAST E-值关于查询序列长度、数据库长度和比特分的公式，然后使用此公式计算从较小数据库转移到较大数据库时 E-值的倍数变化。\n\n分析始于基本的 Karlin–Altschul 统计模型。原始分 $S$ 大于或等于阈值得分 $x$ 的随机比对的期望数量（E-值, $E$）由下式给出：\n$$E = K m' n' \\exp(-\\lambda x)$$\n在此方程中，$K$ 和 $\\lambda$ 是由打分矩阵和背景氨基酸频率决定的统计参数。$m'$ 和 $n'$ 分别代表查询序列和数据库的有效长度。题目说明允许简化，即有效长度等于实际序列长度，因此 $m' = m$ 且 $n' = n$。对于具有观察到的原始分 $S$ 的特定比对，其 E-值为：\n$$E = K m n \\exp(-\\lambda S)$$\n\n比特分，记作 $S'$，是一个与参数 $K$ 和 $\\lambda$ 无关的标准化得分。原始分 $S$ 和比特分 $S'$ 之间的关系定义为：\n$$S' = \\frac{\\lambda S - \\ln(K)}{\\ln(2)}$$\n为了推导 E-值关于比特分 $S'$ 的表达式，我们首先需要用 $S'$ 来表示 $\\exp(-\\lambda S)$ 这一项。我们重排比特分方程以求解 $\\lambda S$：\n$$S' \\ln(2) = \\lambda S - \\ln(K)$$\n$$\\lambda S = S' \\ln(2) + \\ln(K)$$\n现在，我们可以将此表达式代入 E-值方程的指数部分：\n$$E = K m n \\exp(-(S' \\ln(2) + \\ln(K)))$$\n使用指数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将各项分开：\n$$E = K m n \\exp(-S' \\ln(2)) \\exp(-\\ln(K))$$\n$\\exp(-\\ln(K))$ 项简化为 $\\exp(\\ln(K^{-1}))$，即等于 $K^{-1}$ 或 $\\frac{1}{K}$。将此代回方程得到：\n$$E = K m n \\exp(-S' \\ln(2)) \\frac{1}{K}$$\n参数 $K$ 被消掉，剩下：\n$$E = m n \\exp(-S' \\ln(2))$$\n使用对数和指数的另一个性质，$a \\ln(b) = \\ln(b^a)$ 和 $\\exp(\\ln(x)) = x$，我们可以简化指数项：\n$$\\exp(-S' \\ln(2)) = \\exp(\\ln(2^{-S'})) = 2^{-S'}$$\n这就得出了 E-值关于查询序列长度 $m$、数据库长度 $n$ 和比特分 $S'$ 的最终推导表达式：\n$$E = m n 2^{-S'}$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须计算倍数变化 $\\frac{E_{B}}{E_{A}}$。题目提供了以下数值：\n查询序列长度: $m = 1200$\n比特分: $S' = 65$\n数据库 A 长度: $n_{A} = 5.0 \\times 10^{7}$\n数据库 B 长度: $n_{B} = 3.0 \\times 10^{9}$\n\n使用推导出的公式，我们可以写出在每个数据库中比对的 E-值。查询序列长度 $m$ 和比特分 $S'$ 在两种情况下都是恒定的。\n对于数据库 A：\n$$E_{A} = m n_{A} 2^{-S'}$$\n对于数据库 B：\n$$E_{B} = m n_{B} 2^{-S'}$$\n\n倍数变化是 $E_{B}$ 与 $E_{A}$ 的比率：\n$$\\frac{E_{B}}{E_{A}} = \\frac{m n_{B} 2^{-S'}}{m n_{A} 2^{-S'}}$$\n$m$ 和 $2^{-S'}$ 项被消掉，表明对于给定的查询序列和比对得分，E-值与数据库大小成线性关系。该比率简化为：\n$$\\frac{E_{B}}{E_{A}} = \\frac{n_{B}}{n_{A}}$$\n代入给定的数据库长度数值：\n$$\\frac{E_{B}}{E_{A}} = \\frac{3.0 \\times 10^{9}}{5.0 \\times 10^{7}}$$\n$$\\frac{E_{B}}{E_{A}} = \\frac{3.0}{5.0} \\times \\frac{10^{9}}{10^{7}} = 0.6 \\times 10^{2} = 60$$\n题目要求最终答案四舍五入到四位有效数字。因此，数值 $60$ 必须表示为 $60.00$。",
            "answer": "$$\\boxed{60.00}$$"
        },
        {
            "introduction": "现代生物信息学分析通常涉及并行执行成百上千次序列搜索，这带来了一个统计学上的挑战：如何控制整个实验的总体假阳性率？本练习模拟了一个常见的高通量场景，要求你在一个固定的假阳性“预算”下，计算出适用于每次搜索的统一 $E$-value 阈值。通过这个练习，你将掌握一个基于期望线性性质的简单而强大的方法，来管理多重比较中的统计显著性 。",
            "id": "4538915",
            "problem": "在医学数据分析中，一个转化生物信息学流程在单次运行中执行两个高通量序列比对组件：(i) 一组使用基础局部比对搜索工具（BLAST）进行的 $N_{1} = 35$ 次查询与数据库的比对搜索，以及 (ii) 一组使用隐马尔可夫模型（HMM）评分进行结构域检测的 $N_{2} = 120$ 次基于轮廓的搜索。每次搜索都使用随机高分比对的期望数量（E值）来计算比对显著性。该团队希望通过对两个组件应用一个单一统一的每次搜索E值阈值 $E^{\\ast}$，来强制执行在整个运行中最多为 $B = 5$ 个期望随机匹配的运行级别假阳性预算。\n\n假设为了控制期望计数，搜索是使用标准局部比对统计学校准的，并且可以被视为独立的。请从第一性原理推导出，当统一应用于运行中的所有 $N_{1} + N_{2}$ 次搜索时，满足所述预算的每次搜索E值阈值 $E^{\\ast}$。报告 $E^{\\ast}$ 的数值，四舍五入到四位有效数字。不需要物理单位。",
            "solution": "首先对问题陈述的科学合理性、完整性和客观性进行验证。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的数据和约束条件是：\n- BLAST搜索次数：$N_{1} = 35$\n- 基于HMM的搜索次数：$N_{2} = 120$\n- 运行级别的总假阳性预算：$B = 5$ 个期望的随机匹配\n- 一个单一统一的每次搜索E值阈值，记为 $E^{\\ast}$，将应用于所有搜索。\n- 为了控制期望计数，假设搜索是独立的。\n- 目标是推导出 $E^{\\ast}$ 的数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题定义明确且具有科学依据。\n- **科学依据**：该问题基于生物信息学和统计学的基础概念。E值（期望值）是序列比对中统计显著性的一个标准度量，表示仅凭偶然机会找到的具有相似或更好分数的匹配的期望数量。通过调整每次搜索的阈值来控制期望假阳性总预算的方法，是期望线性性质原理的直接应用，该原理是概率论的基石。该方法类似于用于控制家族性错误率的Bonferroni校正。\n- **适定性**：问题是完整的，提供了计算 $E^{\\ast}$ 唯一值所需的所有必要信息（$N_1$, $N_2$, $B$）。约束条件是一致的，并导向一个有意义的单一解。\n- **客观性**：问题以精确的、定量的术语陈述，没有歧义或主观断言。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将从第一性原理推导解决方案。\n\n### 解的推导\n核心概念是E值的定义。对于单次序列搜索，E值阈值为 $E^{\\ast}$ 意味着我们认为任何得分对应E值等于或小于 $E^{\\ast}$ 的比对都是显著的。根据其定义，E值是在给定大小的数据库中进行搜索时，纯粹由偶然机会产生的得分等于或优于该分数的比对的期望数量。因此，对于一次使用阈值 $E^{\\ast}$ 进行的搜索，其假阳性（随机匹配）的期望数量恰好是 $E^{\\ast}$。\n\n该生物信息学流程总共执行 $N_{total}$ 次搜索。这个总数是两个组件搜索次数的总和：\n$$N_{total} = N_{1} + N_{2}$$\n\n对这 $N_{total}$ 次搜索中的每一次都应用一个统一的E值阈值 $E^{\\ast}$。设 $X_i$ 为表示第 $i$ 次搜索中假阳性匹配数量的随机变量（$i = 1, 2, \\dots, N_{total}$）。$X_i$ 的期望值为：\n$$\\mathbb{E}[X_i] = E^{\\ast}$$\n\n整个运行的期望假阳性总数，记为 $E_{run}$，是每次独立搜索的期望值之和。这是由于期望的线性性质，该性质指出随机变量之和的期望等于它们各自期望之和，即 $\\mathbb{E}[\\sum X_i] = \\sum \\mathbb{E}[X_i]$。这个性质成立，与随机变量是否独立无关。\n\n$$E_{run} = \\sum_{i=1}^{N_{total}} \\mathbb{E}[X_i]$$\n因为对所有的 $i$ 都有 $\\mathbb{E}[X_i] = E^{\\ast}$，我们得到：\n$$E_{run} = \\sum_{i=1}^{N_{total}} E^{\\ast} = N_{total} \\times E^{\\ast}$$\n\n代入 $N_{total} = N_1 + N_2$，方程变为：\n$$E_{run} = (N_{1} + N_{2}) \\times E^{\\ast}$$\n\n问题要求整个运行过程中的期望随机匹配总数最多为指定的预算 $B$。为了找到满足此条件的最宽松（即最大）的阈值，我们将期望假阳性总数设为等于该预算：\n$$(N_{1} + N_{2}) \\times E^{\\ast} = B$$\n\n现在我们可以求解每次搜索的E值阈值 $E^{\\ast}$：\n$$E^{\\ast} = \\frac{B}{N_{1} + N_{2}}$$\n\n现在，我们代入问题中给出的数值：\n- $B = 5$\n- $N_{1} = 35$\n- $N_{2} = 120$\n\n$$E^{\\ast} = \\frac{5}{35 + 120} = \\frac{5}{155}$$\n\n化简分数得到：\n$$E^{\\ast} = \\frac{1}{31}$$\n\n为了提供数值答案，我们计算这个分数的小数值：\n$$E^{\\ast} \\approx 0.0322580645...$$\n\n问题要求将此值四舍五入到四位有效数字。第一个非零数字是 $3$，这是第一位有效数字。随后的三位是 $2$、$2$ 和 $5$。第四位有效数字（$5$）后面的数字是 $8$。由于 $8 \\ge 5$，我们将第四位有效数字向上取整。\n因此，$E^{\\ast}$ 的值四舍五入到四位有效数字是 $0.03226$。",
            "answer": "$$\\boxed{0.03226}$$"
        }
    ]
}