{
    "hands_on_practices": [
        {
            "introduction": "长读长测序的核心优势在于其跨越重复序列的能力，这直接影响最终基因组组装的连续性。读长 N50 是一个关键指标，用于衡量测序读长的整体长度分布。本练习将指导您计算这一重要统计数据，并从第一性原理出发，探讨读长 N50 如何通过解决基因组中的重复区域来影响预期的重叠群 N50 。",
            "id": "4579363",
            "problem": "在长读长测序中，读长分布的一个汇总统计量是读长 N50。给定一个测序数据集，包含 $14$ 条单分子读长，其长度（单位为千碱基）分别为：$25$、$20$、$18$、$15$、$12$、$12$、$10$、$9$、$8$、$7$、$6$、$5$、$4$、$3$。根据读长 N50 的正式定义，即长度至少为 $N$ 的读长共同贡献了至少一半的总测序碱基数，请计算该数据集的读长 N50。以 $\\mathrm{kb}$ 为单位表示读长 N50。无需四舍五入。\n\n然后，在一个理想化的重叠-布局-共有（OLC）组装器下，请从第一性原理出发，解释读长 N50 如何影响预期的 contig N50。在您的解释中，您可以不加证明地假设以下广泛使用的基础：长度为 $G$ 的基因组上读长的起始位置可以很好地用覆盖深度为 $c$ 的均匀泊松过程来近似；长度为 $R$ 的重复序列需要至少一条读长跨越该重复序列及其两侧总长度为 $2u$ 的唯一序列才能被解析；contig 倾向于在未解析的重复序列和覆盖缺口处断裂。这部分不需要计算任何数值；相反，您应推导并给出一个符号表达式，将重复序列被解析的概率与读长分布联系起来，并用它来论证增加读长 N50 如何改变预期的 contig N50。\n\n您最终报告的答案必须仅为计算出的读长 N50（单位为 $\\mathrm{kb}$）。如果需要四舍五入，您应保留四位有效数字，但对于此数据集则不需要。",
            "solution": "该问题提出了两个不同的任务。第一个是针对给定数据集计算读长 N50 的数值。第二个是基于基因组组装的第一性原理，对读长 N50 和 contig N50 之间的关系进行理论解释。\n\n首先，我们来计算读长 N50。根据正式定义，读长 N50 是这样一个长度 $N$，使得长度至少为 $N$ 的测序读长共同贡献了至少总测序碱基数的一半。\n\n给定的数据集包含 $14$ 条读长，其长度（单位为千碱基，kb）如下：$25$、$20$、$18$、$15$、$12$、$12$、$10$、$9$、$8$、$7$、$6$、$5$、$4$、$3$。\n\n计算读长 N50 的步骤如下：\n1.  将所有读长的长度相加，计算总测序碱基数。\n2.  确定目标值，即总碱基数的一半。\n3.  按读长长度降序排列。\n4.  遍历排序后的列表，计算读长长度的累积和。\n5.  N50 是累积和首次达到或超过第 2 步中目标值时所对应读长的长度。\n\n让我们执行这些步骤。\n第 1 步：计算所有读长的总长度。\n总长度 $= 25 + 20 + 18 + 15 + 12 + 12 + 10 + 9 + 8 + 7 + 6 + 5 + 4 + 3 = 154$ kb。\n\n第 2 步：确定总长度的一半。\n目标长度 $= \\frac{1}{2} \\times 154 = 77$ kb。\n\n第 3 步：按长度降序排列读长。给定的列表已经排好序：\n$L_1 = 25$, $L_2 = 20$, $L_3 = 18$, $L_4 = 15$, $L_5 = 12$, $L_6 = 12$, $L_7 = 10$, $L_8 = 9$, $L_9 = 8$, $L_{10} = 7$, $L_{11} = 6$, $L_{12} = 5$, $L_{13} = 4$, $L_{14} = 3$。\n\n第 4 步：计算长度的累积和，并与目标长度 $77$ kb 进行比较。\n-   加上最长的读长 ($L_1 = 25$)：累积和 = $25$ kb。小于 $77$ kb。\n-   加上第二长的读长 ($L_2 = 20$)：累积和 = $25 + 20 = 45$ kb。小于 $77$ kb。\n-   加上第三长的读长 ($L_3 = 18$)：累积和 = $45 + 18 = 63$ kb。小于 $77$ kb。\n-   加上第四长的读长 ($L_4 = 15$)：累积和 = $63 + 15 = 78$ kb。该和大于或等于目标值 $77$ kb。\n\n第 5 步：确定 N50 值。在包含长度为 $15$ kb 的读长后，累积和首次达到阈值。因此，根据定义，该数据集的读长 N50 为 $15$ kb。\n\n接下来，我们讨论问题的第二部分：从第一性原理出发，解释在理想化的 OLC 组装器下，读长 N50 如何影响预期的 contig N50。\n\nContig N50 是衡量组装质量的一个指标，其值越高表示组装的连续性越好（即基因组被组装成更少、更长的片段）。问题指出，contig 会在未解析的重复序列和覆盖缺口处断裂。基因组组装的一个主要挑战是正确解析重复序列。读长 N50 的增加对解析重复序列的能力有直接的积极影响，从而增加了 contig N50。\n\n让我们根据给定的假设来形式化这种关系。一个长度为 $R$ 的重复序列需要至少一条读长来跨越它及其两侧总长度为 $2u$ 的唯一序列。因此，一条能解析该重复序列的读长，其长度 $L$ 必须满足 $L \\geq R + 2u$。\n\n设读长分布由概率密度函数 $f(L)$ 描述。随机选择一条读长，其长度足以解析该重复序列的概率为：\n$$\nP(L \\geq R + 2u) = \\int_{R+2u}^{\\infty} f(L) \\,dL\n$$\n\n问题指出，读长的起始位置由均匀泊松过程建模。基因组单位长度上读长起始的速率为 $\\lambda_{\\text{start}}$。该速率可以用读长总数 $N_{\\text{reads}}$ 和基因组长度 $G$ 表示为 $\\lambda_{\\text{start}} = N_{\\text{reads}}/G$。由于覆盖深度 $c$ 定义为 $c = (N_{\\text{reads}} \\cdot E[L]) / G$，其中 $E[L]$ 是平均读长，我们可以写出 $\\lambda_{\\text{start}} = c / E[L]$。\n\n要使一条读长能够跨越长度为 $R$ 的重复序列及其上游长度为 $u$ 的唯一侧翼序列，它必须在该上游侧翼序列内起始。在这个长度为 $u$ 的区域内起始的读长数量，我们记为 $N_u$，服从均值为 $\\mu_u = \\lambda_{\\text{start}} \\cdot u = \\frac{cu}{E[L]}$ 的泊松分布。\n\n然而，并非所有这些读长都足够长以跨越整个结构。我们可以考虑一个“稀疏化”的泊松过程，只包含那些足够长的读长，即长度满足 $L \\geq R + 2u$ 的读长。这类“跨越”读长在单位长度上起始的速率为 $\\lambda_{\\text{span\\_start}} = \\lambda_{\\text{start}} \\cdot P(L \\geq R + 2u)$。\n\n在上游长度为 $u$ 的侧翼区域内起始的此类跨越读长的数量，我们称之为 $N_{\\text{span}}$，将服从均值为以下值的泊松分布：\n$$\n\\lambda = \\lambda_{\\text{span\\_start}} \\cdot u = \\left( \\frac{c}{E[L]} P(L \\geq R + 2u) \\right) \\cdot u = \\frac{cu}{E[L]} \\int_{R+2u}^{\\infty} f(L) \\,dL\n$$\n如果不存在这样的跨越读长，即 $N_{\\text{span}} = 0$，则认为该重复序列未被解析。此事件的概率由 $k=0$ 时的泊松概率质量函数给出：\n$$\nP(\\text{unresolved}) = P(N_{\\text{span}} = 0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)\n$$\n因此，该重复序列被成功解析的概率为：\n$$\nP(\\text{resolved}) = 1 - P(\\text{unresolved}) = 1 - \\exp\\left(-\\frac{cu}{E[L]} \\int_{R+2u}^{\\infty} f(L) \\,dL\\right)\n$$\n这就是连接重复序列解析概率与读长分布所需的符号表达式。\n\n现在，我们将其与读长 N50 联系起来。读长 N50 是读长分布 $f(L)$ 的一个汇总统计量。更高的读长 N50 意味着分布偏向更长的读长，即总序列数据的更大部分包含在最长的读长中。对于任何给定的重复序列长度 $R$，读长 N50 的增加通常会导致积分 $\\int_{R+2u}^{\\infty} f(L) \\,dL$ 的值增加。这个积分代表了理论上能够跨越该重复序列的读长比例。\n\n随着这个积分项 $P(L \\geq R + 2u)$ 的增加，我们 $P(\\text{resolved})$ 表达式中指数函数的参数会变得更负。因此，$\\exp(-\\lambda)$ 项会变小，而总的解析概率 $P(\\text{resolved}) = 1 - \\exp(-\\lambda)$ 会增加，并趋近于 $1$。\n\n总而言之，推理链如下：\n1.  增加的读长 N50 意味着读长分布 $f(L)$ 具有更重的尾部，即更多和/或更长的长读长。\n2.  这导致随机选择的读长足以跨越长度为 $R$ 的重复序列的概率 $P(L \\geq R + 2u)$ 更高。\n3.  更高的 $P(L \\geq R + 2u)$ 增加了重复序列被解析的概率 $P(\\text{resolved})$。\n4.  由于 contig 在未解析的重复序列处断裂，更高的解析概率意味着整个基因组中的 contig 断裂点更少。\n5.  更少的断裂点会产生更连续的组装，这通过更高的预期 contig N50 来衡量。\n\n因此，更高的读长 N50 是更高 contig N50 的一个强有力的预测指标，因为它直接增强了组装器解析重复序列的能力，而重复序列是导致组装片段化的主要原因。",
            "answer": "$$\\boxed{15}$$"
        },
        {
            "introduction": "在评估基因组组装的质量时，连续性是最重要的衡量标准之一。重叠群 N50 和 NG50 是评估组装连续性的两个黄金标准指标。本练习提供了一个计算这些指标的实践机会，帮助您理解 N50（相对于组装总长度）和 NG50（相对于预估的基因组大小）之间的关键区别，这对于客观评价组装的完整性和连续性至关重要 。",
            "id": "4579430",
            "problem": "在用于长读长测序的单倍型解析脱氧核糖核酸（DNA）组装评估中，诸如 $N50$ 和 $NG50$ 等连续性指标被广泛报道。请使用以下基本原理从头构建这些指标：一个基因组组装是一个由长度为 $\\{L_i\\}$ 的重叠群（contig）组成的多重集，这些重叠群可以按长度非递增顺序排序为 $L_1 \\geq L_2 \\geq \\dots \\geq L_n$。前 $k$ 个重叠群的累积长度为 $S_k = \\sum_{i=1}^{k} L_i$，而组装总长度为 $S_n = \\sum_{i=1}^{n} L_i$。估计的单倍体基因组大小是一个已知的外部量 $G$，当组装不完整时，该值可能会超过 $S_n$。\n\n请从这些定义和事实出发，为 $N50$ 和 $NG50$ 推导出正式的定义和分步计算流程，这些流程仅依赖于排序后的重叠群长度，并且对于 $NG50$，还依赖于已知或估计的基因组大小。然后，将您推导出的流程应用于以下来自一个长读长组装的母本单倍型重叠群集合，其长度以兆碱基（Mb）为单位给出，并已按非递增顺序排序：\n$$\n25.0,\\;22.0,\\;20.0,\\;18.0,\\;16.0,\\;14.0,\\;12.0,\\;10.0,\\;9.0,\\;8.0,\\;7.5,\\;6.5,\\;5.0,\\;4.5,\\;4.0,\\;3.5,\\;3.0,\\;2.5,\\;2.0,\\;1.5.\n$$\n假设估计的单倍体基因组大小为 $G = 230$ 兆碱基。请遵循您推导出的流程，计算以兆碱基为单位的 $N50$ 和 $NG50$ 值，然后计算比率 $N50/NG50$。将最终比率四舍五入至六位有效数字，并将其报告为一个不带单位的纯数。",
            "solution": "题目陈述经评估有效。其科学依据扎根于基因组组装评估的既定原则，题目设定完备，提供了所有必要信息，且其表述客观。因此，我们可以进行正式求解。\n\n该问题要求推导组装连续性指标 $N50$ 和 $NG50$ 的正式定义和计算流程，然后将它们应用于一个给定的已排序的重叠群长度数据集。\n\n设重叠群长度的多重集为 $\\{L_i\\}_{i=1}^{n}$，按非递增顺序排序，使得 $L_1 \\geq L_2 \\geq \\dots \\geq L_n$。\n组装的总长度由 $S_n = \\sum_{i=1}^{n} L_i$ 给出。\n估计的单倍体基因组大小是一个外部参数，用 $G$ 表示。\n\n**N50 计算流程**\n\n$N50$ 指标定义为：在构成至少 $50\\%$ 组装总长度 $S_n$ 的最小重叠群集合中，最短的那个重叠群的长度。\n\n1.  计算组装总长度，$S_n = \\sum_{i=1}^{n} L_i$。\n2.  确定目标长度，即组装总长度的一半：$T_{N50} = 0.5 \\times S_n$。\n3.  找到最小的整数索引 $k$，使得前 $k$ 个最长重叠群（按长度降序排列）的累积长度总和大于或等于 $T_{N50}$。数学上，即找到满足以下不等式的最小 $k \\in \\{1, 2, \\dots, n\\}$：\n    $$S_k = \\sum_{i=1}^{k} L_i \\geq T_{N50}$$\n4.  $N50$ 的值即为第 $k$ 个重叠群的长度 $L_k$。\n    $$N50 = L_k$$\n\n**NG50 计算流程**\n\n$NG50$ 指标与 $N50$ 类似，但它使用估计的基因组大小 $G$ 作为参考，而不是组装总长度 $S_n$。这提供了一个相对于外部、更客观的基因组完整性标准的连续性度量。\n\n1.  使用给定的估计单倍体基因组大小 $G$。\n2.  确定目标长度，即估计基因组大小的一半：$T_{NG50} = 0.5 \\times G$。\n3.  找到最小的整数索引 $m$，使得前 $m$ 个最长重叠群的累积长度总和大于或等于 $T_{NG50}$。数学上，即找到满足以下不等式的最小 $m \\in \\{1, 2, \\dots, n\\}$：\n    $$S_m = \\sum_{i=1}^{m} L_i \\geq T_{NG50}$$\n4.  $NG50$ 的值即为第 $m$ 个重叠群的长度 $L_m$。\n    $$NG50 = L_m$$\n\n**应用于给定数据**\n\n已排序的重叠群长度列表（单位为兆碱基，Mb）如下：\n$\\{L_i\\} = \\{25.0, 22.0, 20.0, 18.0, 16.0, 14.0, 12.0, 10.0, 9.0, 8.0, 7.5, 6.5, 5.0, 4.5, 4.0, 3.5, 3.0, 2.5, 2.0, 1.5\\}$。\n重叠群的数量为 $n = 20$。\n估计的单倍体基因组大小为 $G = 230$ Mb。\n\n首先，我们计算组装总长度 $S_n$：\n$$S_{20} = 25.0 + 22.0 + 20.0 + 18.0 + 16.0 + 14.0 + 12.0 + 10.0 + 9.0 + 8.0 + 7.5 + 6.5 + 5.0 + 4.5 + 4.0 + 3.5 + 3.0 + 2.5 + 2.0 + 1.5$$\n$$S_{20} = 194.0 \\text{ Mb}$$\n\n**N50 计算**\n\n1.  目标长度为 $T_{N50} = 0.5 \\times S_{20} = 0.5 \\times 194.0 = 97.0$ Mb。\n2.  我们计算累积和 $S_k$，直到总和至少达到 $97.0$：\n    $S_1 = L_1 = 25.0$\n    $S_2 = S_1 + L_2 = 25.0 + 22.0 = 47.0$\n    $S_3 = S_2 + L_3 = 47.0 + 20.0 = 67.0$\n    $S_4 = S_3 + L_4 = 67.0 + 18.0 = 85.0$\n    $S_5 = S_4 + L_5 = 85.0 + 16.0 = 101.0$\n3.  累积和 $S_5 = 101.0$ 是第一个超过目标值 $97.0$ 的。因此，索引为 $k=5$。\n4.  $N50$ 的值是第 $5$ 个重叠群的长度 $L_5$。\n    $$N50 = 16.0 \\text{ Mb}$$\n\n**NG50 计算**\n\n1.  目标长度为 $T_{NG50} = 0.5 \\times G = 0.5 \\times 230.0 = 115.0$ Mb。\n2.  我们继续计算累积和 $S_m$，直到总和至少达到 $115.0$：\n    我们已有 $S_5 = 101.0$。\n    $S_6 = S_5 + L_6 = 101.0 + 14.0 = 115.0$\n3.  累积和 $S_6 = 115.0$ 是第一个大于或等于目标值 $115.0$ 的。因此，索引为 $m=6$。\n4.  $NG50$ 的值是第 $6$ 个重叠群的长度 $L_6$。\n    $$NG50 = 14.0 \\text{ Mb}$$\n\n**计算比率 N50/NG50**\n\n最后一步是计算 $N50$ 与 $NG50$ 的比率，并四舍五入到六位有效数字。\n$$\\frac{N50}{NG50} = \\frac{16.0}{14.0} = \\frac{8}{7}$$\n换算成小数为：\n$$\\frac{8}{7} \\approx 1.142857142...$$\n四舍五入到六位有效数字需要检查第七位有效数字。前六位是 $1, 1, 4, 2, 8, 5$。第七位是 $7$。由于 $7 \\geq 5$，我们将第六位数字向上取整。\n$$1.142857... \\approx 1.14286$$\n最终的比率是一个纯数。",
            "answer": "$$\\boxed{1.14286}$$"
        },
        {
            "introduction": "对于单倍型解析组装，不仅要组装得长，还要分得准。评估单倍型定相的准确性是保证最终组装质量的关键步骤。转换错误率 (switch error rate) 是衡量定相准确性的核心指标，它量化了在相邻杂合变异位点之间发生定相转换错误的频率。通过这个练习，您将学会如何根据一个高可信度的“真实”数据集来计算转换错误率，从而掌握评估单倍型解析组装质量的核心技能 。",
            "id": "4579441",
            "problem": "一个由长读长测序生成的单倍型解析组装正在与人类染色体上一个 $5$ 兆碱基窗口内的高置信度真实集进行评估。考虑以下基于标准定相定义的设置。杂合变异被定义为两条同源染色体携带不同等位基因的任何位点。定相将每个杂合变异分配到两个单倍型中的一个，而两个相邻杂合变异之间的相位转换指示了当按坐标顺序从第一个位点移动到第二个位点时，单倍型分配是保持不变还是翻转。每个定相块的方向是任意的，因此只有相邻杂合变异之间的相对相位转换对于真实性评估才有意义。\n\n给定一个杂合变异的真实集和来自该组装的相应定相调用集。为了计算相对于真实集的转换错误率，只考虑那些在两个集合中都存在且已定相，并且在任一集合中都不跨越定相断裂点的相邻杂合变异对。由于缺失或未定相的变异会破坏邻接关系，因此可比较的相邻对分解为不相交的运行片段，在这些片段中，连续的真实杂合变异在调用集中都存在且已定相。在该区域，真实集和调用集杂合变异的交集形成了 $6$ 个运行片段，其长度分别为 $50$、$63$、$37$、$42$、$30$ 和 $58$。在这些运行片段中，与真实集相位转换不一致（即，调用集的相对转换与真实集的相对转换不同）的相邻杂合变异对的数量分别为 $5$、$7$、$3$、$2$、$1$ 和 $4$。\n\n使用单倍型定相和相位转换的基本定义，计算转换错误率，即具有不正确相位转换的可比较相邻杂合变异对的分数。将您的最终答案表示为小数并四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是可靠的。它在科学上基于生物信息学和基因组学的原理，特别是单倍型定相和组装评估。该问题提法恰当、客观，并包含得出唯一解所需的所有必要信息。\n\n主要任务是计算单倍型解析组装的转换错误率。根据问题的定义，转换错误率是具有不正确相位转换的可比较相邻杂合变异对的分数。这可以用数学方式表示为：\n$$\n\\text{Switch Error Rate} = \\frac{\\text{Total number of switch errors}}{\\text{Total number of comparable adjacent pairs}}\n$$\n\n首先，我们必须确定可比较的相邻杂合变异对的总数。问题指出，分析仅限于在真实集和调用集中都存在且已定相的变异的不相交运行片段。一个长度为 $L$ 的运行片段，定义为包含 $L$ 个连续的杂合变异，将有 $L-1$ 对相邻变异。\n\n这 $6$ 个不相交的运行片段的长度分别为 $L_1 = 50$、$L_2 = 63$、$L_3 = 37$、$L_4 = 42$、$L_5 = 30$ 和 $L_6 = 58$。\n\n每个运行片段中的相邻对数，记为 $P_i$，计算公式为 $P_i = L_i - 1$。\n对第一个运行片段：$P_1 = L_1 - 1 = 50 - 1 = 49$\n对第二个运行片段：$P_2 = L_2 - 1 = 63 - 1 = 62$\n对第三个运行片段：$P_3 = L_3 - 1 = 37 - 1 = 36$\n对第四个运行片段：$P_4 = L_4 - 1 = 42 - 1 = 41$\n对第五个运行片段：$P_5 = L_5 - 1 = 30 - 1 = 29$\n对第六个运行片段：$P_6 = L_6 - 1 = 58 - 1 = 57$\n\n可比较的相邻对总数 $P_{total}$ 是所有运行片段中相邻对数的总和：\n$$\nP_{total} = \\sum_{i=1}^{6} P_i = P_1 + P_2 + P_3 + P_4 + P_5 + P_6\n$$\n$$\nP_{total} = 49 + 62 + 36 + 41 + 29 + 57 = 274\n$$\n或者，也可以将其计算为所有运行片段长度的总和减去运行片段的数量：\n$$\nP_{total} = \\left(\\sum_{i=1}^{6} L_i\\right) - 6 = (50 + 63 + 37 + 42 + 30 + 58) - 6 = 280 - 6 = 274\n$$\n\n接下来，我们必须确定转换错误的总数。转换错误被定义为调用集中的相位转换与真实集不一致的相邻杂合变异对。问题提供了每个运行片段中此类错误的数量：$E_1 = 5$、$E_2 = 7$、$E_3 = 3$、$E_4 = 2$、$E_5 = 1$ 和 $E_6 = 4$。\n\n转换错误的总数 $E_{total}$ 是所有运行片段中错误数的总和：\n$$\nE_{total} = \\sum_{i=1}^{6} E_i = E_1 + E_2 + E_3 + E_4 + E_5 + E_6\n$$\n$$\nE_{total} = 5 + 7 + 3 + 2 + 1 + 4 = 22\n$$\n\n现在，我们可以通过将转换错误的总数除以可比较的相邻对总数来计算转换错误率：\n$$\n\\text{Switch Error Rate} = \\frac{E_{total}}{P_{total}} = \\frac{22}{274}\n$$\n该分数可化简为：\n$$\n\\frac{22}{274} = \\frac{11}{137}\n$$\n为了将其表示为小数，我们进行除法运算：\n$$\n\\frac{11}{137} \\approx 0.08029197...\n$$\n问题要求答案四舍五入到四位有效数字。第一位有效数字是 $8$。第四位有效数字是 $9$（在万分位上）。$9$ 后面的数字是 $1$，小于 $5$，因此我们向下取整（即，保持 $9$ 不变）。\n\n因此，转换错误率四舍五入到四位有效数字为 $0.08029$。",
            "answer": "$$\\boxed{0.08029}$$"
        }
    ]
}