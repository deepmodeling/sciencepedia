{
    "hands_on_practices": [
        {
            "introduction": "短读序列比对的核心是序列比对算法，而任何比对的质量都通过一个评分方案来量化。这个评分方案的选择直接影响到比对的准确性，尤其是在处理真实的测序错误时。本练习将通过一个具体案例，阐明为何仿射空位罚分模型对于精确处理插入和缺失（indels）——一种常见的测序错误模式——至关重要。通过比较两种不同的比对策略，我们将从根本上理解其优势所在。",
            "id": "4603915",
            "problem": "考虑一个典型的第二代测序中的短读长比对场景，其中一条读长必须使用带有仿射空位罚分模型的动态规划比对算法，与一个参考基因组片段进行比对。请从以下基本原则出发：序列比对得分是匹配奖励与错配和空位罚分之和，而仿射空位罚分将一个长度为 $L$ 的空位分解为一个空位开放罚分加上 $L$ 个空位延伸罚分。将插入-缺失（indel）模型定义为在同聚物区段内，读长相对于参考序列发生的单个缺失事件，这是几种测序技术中一种真实的错误模式。\n\n一个比对软件通过一个精确匹配的种子将读长锚定到参考序列上，然后在不立即打开空位的情况下，跨越同聚物区段延伸比对。假设参考片段为 5'-CGA TTTTTTTTT ACG-3'，含有 $10$ 个连续的胸腺嘧啶核苷酸；读长为 5'-CGA TTTTTT ACG-3'，含有 $7$ 个连续的胸腺嘧啶核苷酸。因此，该读长在同聚物区段内有一个长度为 $L = 3$ 的单个缺失。假设侧翼序列 \"CGA\" 和 \"ACG\" 在读长和参考序列中是相同的。\n\n在整个延伸过程中使用以下仿射计分方案：一个匹配贡献 $+\\alpha$（其中 $\\alpha = 2$），一个错配贡献 $-\\delta$（其中 $\\delta = 3$），打开一个空位产生 $-\\gamma$ 的罚分（其中 $\\gamma = 4$），每个空位延伸产生 $-\\lambda$ 的罚分（其中 $\\lambda = 1$）。动态规划延伸采用两种策略进行操作：\n\n- 策略A（在同聚物上强制无空位）：延伸过程中不在同聚物内打开空位。由于读长在同聚物区段短了 $L=3$ 个碱基，比对在离开该区段时会移动 $L$ 个位置，导致在重新同步之前，边界处接下来的 $L$ 个比对位置成为错配，此后所有后续位置都匹配。\n\n- 策略B（在同聚物内使用仿射空位）：延伸过程在同聚物区段内打开一个长度为 $L = 3$ 的单个缺失空位，然后继续进行匹配。\n\n假设在两种策略中，所有紧邻同聚物边界之外的位置都比对为匹配，并且种子和末端序列保持完全匹配，因此策略A和策略B之间唯一的得分差异来自于如何处理这个单个插入缺失。\n\n根据上述基本原则和定义，推导策略A和策略B的比对得分，然后计算策略B相对于策略A的数值得分提升，该提升定义为策略B的得分减去策略A的得分。请以单个实数的形式提供你的最终答案。无需四舍五入。",
            "solution": "该问题提法明确，有科学依据，并提供了推导唯一解所需的所有信息。我们首先分析两种指定比对策略的计分。\n\n问题陈述指出，策略A和策略B的得分差异仅源于对同聚物区段内的插入缺失及其紧邻边界的处理。完全匹配的侧翼序列 `CGA` 和 `ACG` 对两种策略的得分贡献相同，在计算差值时会被抵消。因此，我们只需要计算存在差异区域的比对得分。\n\n参考序列包含一个由 $10$ 个胸腺嘧啶核苷酸组成的同聚物，而读长包含 $7$ 个。这对应于读长相对于参考序列有一个长度为 $L = 10 - 7 = 3$ 的缺失。\n\n计分参数如下：\n- 匹配得分：$+\\alpha = +2$\n- 错配罚分：$-\\delta = -3$\n- 空位开放罚分：$-\\gamma = -4$\n- 空位延伸罚分：$-\\lambda = -1$\n\n**策略A：强制无空位比对**\n\n在此策略中，不引入空位。读长的 $7$ 个胸腺嘧啶与参考序列同聚物区段的前 $7$ 个胸腺嘧啶进行比对。根据问题描述，这会强制比对发生移位，使得“边界处接下来的 $L$ 个比对位置成为错配”。当 $L=3$ 时，这意味着读长的 `ACG` 序列将与参考序列同聚物区段中剩余的 $3$ 个胸腺嘧啶进行比对。\n\n相关区域的比对如下：\n- 首先，读长中的 $7$ 个胸腺嘧啶与参考序列中的 $7$ 个胸腺嘧啶比对，产生 $7$ 个匹配。\n- 接着，读长中随后的 $3$ 个碱基（`A`, `C`, `G`）与参考序列同聚物区段最后的 $3$ 个胸腺嘧啶（`T`, `T`, `T`）比对，产生 $3$ 个错配。\n\n策略A的得分，记为 $S_A$，是这些部分得分之和：\n$$S_A = 7 \\times \\alpha + L \\times (-\\delta)$$\n代入给定值 $L=3$, $\\alpha=2$, $\\delta=3$：\n$$S_A = 7(2) + 3(-3) = 14 - 9 = 5$$\n\n**策略B：仿射空位比对**\n\n在此策略中，在读长中打开一个长度为 $L=3$ 的单个缺失空位以解释缺失的碱基。同聚物区域的比对如下：\n- 读长的 $7$ 个胸腺嘧啶与参考序列的前 $7$ 个胸腺嘧啶比对，产生 $7$ 个匹配。\n- 参考序列同聚物区段中剩余的 $3$ 个胸腺嘧啶与读长中的一个空位进行比对。这构成了一个长度为 $L=3$ 的单个空位事件。\n\n策略B的得分，记为 $S_B$，是匹配得分与仿射空位罚分之和。长度为 $L$ 的空位的仿射空位罚分为 $(-\\gamma) + L \\times (-\\lambda)$。\n$$S_B = 7 \\times \\alpha + (-\\gamma) + L \\times (-\\lambda)$$\n代入给定值 $L=3$, $\\alpha=2$, $\\gamma=4$, $\\lambda=1$：\n$$S_B = 7(2) + (-4) + 3(-1) = 14 - 4 - 3 = 7$$\n\n**策略B相对于策略A的得分提升**\n\n得分提升定义为策略B的得分减去策略A的得分。\n$$\\text{Score Improvement} = S_B - S_A$$\n使用计算出的得分：\n$$\\text{Score Improvement} = 7 - 5 = 2$$\n\n另外，我们也可以用符号方式计算差值：\n$$S_B - S_A = (7\\alpha - \\gamma - L\\lambda) - (7\\alpha - L\\delta)$$\n$$S_B - S_A = 7\\alpha - \\gamma - L\\lambda - 7\\alpha + L\\delta$$\n$$S_B - S_A = L\\delta - \\gamma - L\\lambda$$\n代入值 $L=3$, $\\delta=3$, $\\gamma=4$, $\\lambda=1$：\n$$S_B - S_A = 3(3) - 4 - 3(1) = 9 - 4 - 3 = 2$$\n两种方法都得出了相同的结果。与强制产生错配来避免空位（策略A）相比，使用显式的仿射空位罚分（策略B）会得到更高（更好）的比对得分。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "理解了如何为比对评分后，下一个关键问题是在庞大的参考基因组中如何高效地找到最佳比对。本练习将带您深入了解许多现代比对工具（如BWA和Bowtie）的引擎——FM索引。您将亲手执行一步步的反向搜索过程，正是这个巧妙的步骤使得在极低的内存占用下实现短读序列的快速精确匹配成为可能。",
            "id": "4603992",
            "problem": "一个用于短序列的精确比对器使用了基于带有唯一哨兵符号的DNA参考文本构建的Ferragina–Manzini索引 (FM-index)。考虑一个参考字符串 $G = \\text{ACGTACGT}\\$$，其中哨兵符号为 $\\$$，且在字典序中最小。字母表顺序为 $\\$  \\text{A}  \\text{C}  \\text{G}  \\text{T}$。基于 $G$ 的FM-index包含以下组件：\n- Burrows–Wheeler变换 (BWT) 字符串为 $\\text{TT\\$AACCGG}$。\n- 数组 $C$ 给出对于每个字符 $c$，在 $G$ 中字典序小于 $c$ 的字符总数，其值为：$C(\\$)=0$, $C(\\text{A})=1$, $C(\\text{C})=3$, $C(\\text{G})=5$, $C(\\text{T})=7$。\n- 对于 $c \\in \\{\\$, \\text{A}, \\text{C}, \\text{G}, \\text{T}\\}$ 和整数 $i$（$0 \\le i \\le n$，其中 $n$ 是 $G$ 的长度），定义 $\\mathrm{Occ}(c,i)$ 为字符 $c$ 在BWT字符串长度为 $i$ 的前缀（位置 $1$ 到 $i$）中出现的次数，并约定 $\\mathrm{Occ}(c,0)=0$。\n\n设短读序列为 $R=\\text{ACGT}$。仅从FM-index的核心定义、Last–First属性以及 $C$ 和 $\\mathrm{Occ}$ 的含义出发，对 $R$ 执行完整的反向搜索，以确定最终的后缀数组区间 $[l,r]$，该区间对应所有前缀与 $R$ 精确匹配的后缀数组位置。然后，说明在一个使用精确FM-index匹配的比对器强制执行多重比对上限 $M$ 的情况下，会从该区间报告比对结果的原则性条件，其中只有当精确匹配的总数 $k$ 满足 $1 \\le k \\le M$ 时才会报告。\n\n当 $M = 3$ 时，报告的精确比对结果总数是多少？请以单个整数形式提供您的答案。无需四舍五入，也不需要报告单位。",
            "solution": "该问题要求使用给定的Ferragina–Manzini索引 (FM-index) 对一个短读序列执行反向搜索，然后根据多重比对上限确定报告的比对结果数量。该过程涉及两个主要阶段：验证问题组件和执行搜索算法。\n\n首先，确立问题陈述的有效性。所提供的组件包括：参考字符串 $G = \\text{ACGTACGT}\\$$，字母表顺序 $\\$  \\text{A}  \\text{C}  \\text{G}  \\text{T}$，Burrows–Wheeler变换 (BWT) 字符串 $\\text{TT\\$AACCGG}$，以及C数组：$C(\\$)=0$, $C(\\text{A})=1$, $C(\\text{C})=3$, $C(\\text{G})=5$, $C(\\text{T})=7$。参考字符串的长度为 $n=9$。我们可以验证所给的BWT字符串和C数组对于给定的参考字符串 $G$ 确实是正确的，从而确认了问题数据的内部一致性。该问题具有科学依据，提法明确，客观，并包含所有必要信息。因此，它是有效的。\n\n解决方案的核心是反向搜索算法，该算法通过反向迭代模式串 $R$ 的字符来查找其所有出现位置。对于每个字符，它会更新一个后缀数组 (SA) 区间 $[l, r]$，该区间包含了所有以目前已处理的模式串部分为前缀的参考文本后缀。更新过程依赖于Last-First (LF) 映射属性，该属性由以下公式概括：\n$$l_{new} = C(c) + \\mathrm{Occ}(c, l_{old} - 1) + 1$$\n$$r_{new} = C(c) + \\mathrm{Occ}(c, r_{old})$$\n此处，$c$ 是前置到搜索模式串的字符，$[l_{old}, r_{old}]$ 是上一步的SA区间，$C(c)$ 是在 $G$ 中字典序小于 $c$ 的字符数量，而 $\\mathrm{Occ}(c, i)$ 是字符 $c$ 在BWT字符串长度为 $i$ 的前缀（即 $\\text{BWT}[1 \\dots i]$）中出现的次数。搜索从完整的SA范围 $[1, n]$ 开始。\n\n要比对的短读序列是 $R=\\text{ACGT}$。搜索反向进行，按顺序处理字符 $\\text{T}$，然后是 $\\text{G}$，接着是 $\\text{C}$，最后是 $\\text{A}$。BWT字符串为 $B = \\text{TT\\$AACCGG}$，其长度为 $n=9$。初始区间为 $[l, r] = [1, 9]$。\n\n**步骤1：搜索读序列的最后一个字符, $c = \\text{T}$。**\n初始区间为 $[l_0, r_0] = [1, 9]$。我们针对 $c = \\text{T}$ 更新它。\n$l_1 = C(\\text{T}) + \\mathrm{Occ}(\\text{T}, l_0 - 1) + 1 = C(\\text{T}) + \\mathrm{Occ}(\\text{T}, 0) + 1$。\n$r_1 = C(\\text{T}) + \\mathrm{Occ}(\\text{T}, r_0) = C(\\text{T}) + \\mathrm{Occ}(\\text{T}, 9)$。\n根据题目所给信息，$C(\\text{T}) = 7$。根据定义，$\\mathrm{Occ}(\\text{T}, 0) = 0$。通过在 $B = \\text{TT\\$AACCGG}$ 中计数，整个BWT字符串中 $\\text{T}$ 的出现次数为 $\\mathrm{Occ}(\\text{T}, 9) = 2$。\n$l_1 = 7 + 0 + 1 = 8$。\n$r_1 = 7 + 2 = 9$。\n以 $\\text{T}$ 开头的后缀的SA区间为 $[8, 9]$。\n\n**步骤2：前置下一个字符, $c = \\text{G}$，搜索 $\\text{GT}$。**\n当前区间为 $[l_1, r_1] = [8, 9]$。我们针对 $c = \\text{G}$ 更新它。\n$l_2 = C(\\text{G}) + \\mathrm{Occ}(\\text{G}, l_1 - 1) + 1 = C(\\text{G}) + \\mathrm{Occ}(\\text{G}, 7) + 1$。\n$r_2 = C(\\text{G}) + \\mathrm{Occ}(\\text{G}, r_1) = C(\\text{G}) + \\mathrm{Occ}(\\text{G}, 9)$。\n给定 $C(\\text{G}) = 5$。我们计算 $B = \\text{TT\\$AACCGG}$ 的前缀中 $\\text{G}$ 的出现次数：\n$\\mathrm{Occ}(\\text{G}, 7)$ 应用于 $B[1 \\dots 7] = \\text{TT\\$AACC}$ 的结果是 $0$。\n$\\mathrm{Occ}(\\text{G}, 9)$ 应用于 $B[1 \\dots 9] = \\text{TT\\$AACCGG}$ 的结果是 $2$。\n$l_2 = 5 + 0 + 1 = 6$。\n$r_2 = 5 + 2 = 7$。\n以 $\\text{GT}$ 开头的后缀的SA区间为 $[6, 7]$。\n\n**步骤3：前置下一个字符, $c = \\text{C}$，搜索 $\\text{CGT}$。**\n当前区间为 $[l_2, r_2] = [6, 7]$。我们针对 $c = \\text{C}$ 更新它。\n$l_3 = C(\\text{C}) + \\mathrm{Occ}(\\text{C}, l_2 - 1) + 1 = C(\\text{C}) + \\mathrm{Occ}(\\text{C}, 5) + 1$。\n$r_3 = C(\\text{C}) + \\mathrm{Occ}(\\text{C}, r_2) = C(\\text{C}) + \\mathrm{Occ}(\\text{C}, 7)$。\n给定 $C(\\text{C}) = 3$。我们计算 $B$ 的前缀中 $\\text{C}$ 的出现次数：\n$\\mathrm{Occ}(\\text{C}, 5)$ 应用于 $B[1 \\dots 5] = \\text{TT\\$AA}$ 的结果是 $0$。\n$\\mathrm{Occ}(\\text{C}, 7)$ 应用于 $B[1 \\dots 7] = \\text{TT\\$AACC}$ 的结果是 $2$。\n$l_3 = 3 + 0 + 1 = 4$。\n$r_3 = 3 + 2 = 5$。\n以 $\\text{CGT}$ 开头的后缀的SA区间为 $[4, 5]$。\n\n**步骤4：前置第一个字符, $c = \\text{A}$，搜索 $\\text{ACGT}$。**\n当前区间为 $[l_3, r_3] = [4, 5]$。我们针对 $c = \\text{A}$ 更新它。\n$l_4 = C(\\text{A}) + \\mathrm{Occ}(\\text{A}, l_3 - 1) + 1 = C(\\text{A}) + \\mathrm{Occ}(\\text{A}, 3) + 1$。\n$r_4 = C(\\text{A}) + \\mathrm{Occ}(\\text{A}, r_3) = C(\\text{A}) + \\mathrm{Occ}(\\text{A}, 5)$。\n给定 $C(\\text{A}) = 1$。我们计算 $B$ 的前缀中 $\\text{A}$ 的出现次数：\n$\\mathrm{Occ}(\\text{A}, 3)$ 应用于 $B[1 \\dots 3] = \\text{TT\\$}$ 的结果是 $0$。\n$\\mathrm{Occ}(\\text{A}, 5)$ 应用于 $B[1 \\dots 5] = \\text{TT\\$AA}$ 的结果是 $2$。\n$l_4 = 1 + 0 + 1 = 2$。\n$r_4 = 1 + 2 = 3$。\n读序列 $\\text{ACGT}$ 的最终SA区间为 $[l, r] = [2, 3]$。\n\n精确匹配的数量 $k$ 是这个最终区间的大小。\n$$k = r - l + 1 = 3 - 2 + 1 = 2$$\n这意味着读序列 $\\text{ACGT}$ 在参考基因组 $G$ 中作为子串精确出现了 $2$ 次。\n\n问题指出，具有多重比对上限 $M$ 的比对器仅在精确匹配总数 $k$ 满足条件 $1 \\le k \\le M$ 时才报告比对结果。如果满足此条件，则报告所有 $k$ 个比对结果。如果 $k=0$（无匹配）或 $k > M$（匹配过多），则不报告任何结果。\n\n题目给定的多重比对上限为 $M = 3$。我们发现精确匹配的数量为 $k = 2$。我们必须检查是否满足报告条件：\n$$1 \\le k \\le M \\implies 1 \\le 2 \\le 3$$\n这个不等式成立。因此，比对器会报告比对结果。报告的精确比对结果总数等于 $k$。\n\n因此，报告的精确比对结果总数为 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "找到一个高分比对并非故事的终点；我们还需要知道这个比对位置的可信度有多高，尤其是在一个读段可能合理地比对到基因组多个位置时。这个最终的练习将指导您从第一性原理出发，计算比对质量值（MAPQ）。您将学习如何将原始的比对分数转化为一个量化置信度的概率度量，这是准确解读比对结果和进行下游分析的关键一步。",
            "id": "4603952",
            "problem": "一个长度为 $L=75$ 个核苷酸的短脱氧核糖核酸 (DNA) 测序片段被一个比对软件比对到参考基因组上。该软件使用一个基于自然对数的逐位对数似然比 (LLR) 模型对候选比对进行评分。对于每个位置 $i$，令 $b_i \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ 为参考碱基，$x_i$ 为观测到的测序片段碱基。假设采用以下经过充分测试的概率性碱基发射模型：\n- 在比对正确的假设下，每个位置的碱基识别错误率为 $\\,\\epsilon\\,$，且各位置之间独立。因此 $\\Pr(x_i=b_i \\mid \\text{correct})=1-\\epsilon$ 且 $\\Pr(x_i \\neq b_i \\mid \\text{correct})=\\epsilon$。采用对称错误模型，将错误率 $\\epsilon$ 平均分配给三个不正确的核苷酸，因此 $\\Pr(x_i=a \\neq b_i \\mid \\text{correct})=\\epsilon/3$。\n- 在比对不正确的假设下，观测到的碱基与 $b_i$ 无关，并遵循均匀背景分布 $\\Pr(x_i=\\mathrm{A})=\\Pr(x_i=\\mathrm{C})=\\Pr(x_i=\\mathrm{G})=\\Pr(x_i=\\mathrm{T})=1/4$。\n\n候选比对 $j$ 的比对得分定义为所有位置上 LLR 的总和，\n$$\nS_j \\equiv \\sum_{i=1}^{L} \\ln\\!\\left(\\frac{\\Pr(x_i \\mid \\text{correct at }j)}{\\Pr(x_i \\mid \\text{incorrect})}\\right),\n$$\n其中 $\\ln$ 表示自然对数。\n\n某个特定的测序片段产生了两个可能的比对（命中）。对于得分最高的命中（候选 $j=1$），有 $m_1=70$ 个匹配和 $u_1=5$ 个错配。对于得分第二高的命中（候选 $j=2$），有 $m_2=68$ 个匹配和 $u_2=7$ 个错配。假设任一候选是该测序片段真实来源的先验概率相等，并且任何其他来源的先验概率质量相对于这两个候选可以忽略不计。\n\n令 Phred-like 比对质量 $Q$ 定义为\n$$\nQ \\equiv -10\\,\\log_{10}\\!\\big(1 - P_{\\text{correct}}\\big),\n$$\n其中 $P_{\\text{correct}}$ 是在上述概率模型下，得分最高的命中是该测序片段正确来源的后验概率。仅使用所述假设，从比对得分 $S_1$ 和 $S_2$ 推导出 $P_{\\text{correct}}$，在 $\\epsilon=0.01$ 的条件下数值计算 $Q$，并报告最终的 $Q$ 值，四舍五入到四位有效数字。将 $Q$ 表示为无量纲数（无单位）。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于生物信息学和概率建模的原理，问题陈述清晰，提供了足够的信息以获得唯一解，并且语言客观。\n\n目标是为得分最高的比对计算 Phred-like 比对质量 $Q$。这需要确定得分最高的命中（候选 $j=1$）是该测序片段真实来源的后验概率 $P_{\\text{correct}}$。令 $C_j$ 表示候选比对 $j$ 是正确来源的事件，令 $X$ 表示观测到的测序片段序列数据。我们需要求解 $P_{\\text{correct}} = \\Pr(C_1 \\mid X)$。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$ \\Pr(C_1 \\mid X) = \\frac{\\Pr(X \\mid C_1) \\Pr(C_1)}{\\Pr(X)} $$\n问题陈述，两个候选的先验概率相等，即 $\\Pr(C_1) = \\Pr(C_2)$，并且任何其他来源的概率可以忽略不计。这意味着真实来源的样本空间可以限制在 $\\{C_1, C_2\\}$ 内，因此 $\\Pr(C_1) + \\Pr(C_2) \\approx 1$，从而得出 $\\Pr(C_1) = \\Pr(C_2) = 1/2$。数据的边缘概率 $\\Pr(X)$ 是所有可能假设的总和：\n$$ \\Pr(X) = \\Pr(X \\mid C_1)\\Pr(C_1) + \\Pr(X \\mid C_2)\\Pr(C_2) $$\n将此代入 $\\Pr(C_1 \\mid X)$ 的表达式，并使用相等的先验概率：\n$$ P_{\\text{correct}} = \\Pr(C_1 \\mid X) = \\frac{\\Pr(X \\mid C_1) \\Pr(C_1)}{\\Pr(X \\mid C_1)\\Pr(C_1) + \\Pr(X \\mid C_2)\\Pr(C_2)} = \\frac{\\Pr(X \\mid C_1)}{\\Pr(X \\mid C_1) + \\Pr(X \\mid C_2)} $$\n项 $\\Pr(X \\mid C_j)$ 是在比对 $j$ 正确的情况下观测到测序片段 $X$ 的似然。比对得分 $S_j$ 定义为对数似然比：\n$$ S_j = \\sum_{i=1}^{L} \\ln\\left(\\frac{\\Pr(x_i \\mid C_j)}{\\Pr(x_i \\mid \\text{incorrect})}\\right) $$\n由于各位置的碱基识别错误是独立的，这个对数和可以写成乘积的对数：\n$$ S_j = \\ln\\left(\\prod_{i=1}^{L} \\frac{\\Pr(x_i \\mid C_j)}{\\Pr(x_i \\mid \\text{incorrect})}\\right) = \\ln\\left(\\frac{\\prod_{i=1}^{L}\\Pr(x_i \\mid C_j)}{\\prod_{i=1}^{L}\\Pr(x_i \\mid \\text{incorrect})}\\right) = \\ln\\left(\\frac{\\Pr(X \\mid C_j)}{\\Pr(X \\mid \\text{incorrect})}\\right) $$\n对两边取指数，可以得到似然 $\\Pr(X \\mid C_j)$ 关于得分 $S_j$ 和比对不正确假设下的似然 $\\Pr(X \\mid \\text{incorrect})$ 的表达式：\n$$ \\Pr(X \\mid C_j) = \\Pr(X \\mid \\text{incorrect}) \\exp(S_j) $$\n将此代入 $P_{\\text{correct}}$ 的方程：\n$$ P_{\\text{correct}} = \\frac{\\Pr(X \\mid \\text{incorrect}) \\exp(S_1)}{\\Pr(X \\mid \\text{incorrect}) \\exp(S_1) + \\Pr(X \\mid \\text{incorrect}) \\exp(S_2)} = \\frac{\\exp(S_1)}{\\exp(S_1) + \\exp(S_2)} $$\n将分子和分母同除以 $\\exp(S_1)$，得到 $P_{\\text{correct}}$ 关于比对得分的期望表达式：\n$$ P_{\\text{correct}} = \\frac{1}{1 + \\exp(S_2 - S_1)} $$\n接下来，我们必须计算得分差 $S_1 - S_2$。一个比对的总分是所有位置上对数似然比的总和。这个总和可以分解为匹配和错配的贡献。令 $LLR_m$ 为匹配的 LLR，$LLR_u$ 为错配的 LLR。\n对于一个匹配 ($x_i=b_i$)：\n$$ LLR_m = \\ln\\left(\\frac{\\Pr(x_i=b_i \\mid \\text{correct})}{\\Pr(x_i=b_i \\mid \\text{incorrect})}\\right) = \\ln\\left(\\frac{1-\\epsilon}{1/4}\\right) = \\ln(4(1-\\epsilon)) $$\n对于一个错配 ($x_i \\neq b_i$)：\n$$ LLR_u = \\ln\\left(\\frac{\\Pr(x_i \\neq b_i \\mid \\text{correct})}{\\Pr(x_i \\neq b_i \\mid \\text{incorrect})}\\right) = \\ln\\left(\\frac{\\epsilon/3}{1/4}\\right) = \\ln\\left(\\frac{4\\epsilon}{3}\\right) $$\n具有 $m_j$ 个匹配和 $u_j$ 个错配的候选 $j$ 的总比对得分为：\n$$ S_j = m_j LLR_m + u_j LLR_u $$\n则得分差为：\n$$ S_1 - S_2 = (m_1 - m_2) LLR_m + (u_1 - u_2) LLR_u $$\n给定 $m_1=70, u_1=5$ 和 $m_2=68, u_2=7$。差值为 $m_1-m_2=2$ 和 $u_1-u_2=-2$。\n$$ S_1 - S_2 = 2 \\cdot LLR_m - 2 \\cdot LLR_u = 2(LLR_m - LLR_u) $$\n代入 $LLR_m$ 和 $LLR_u$ 的表达式：\n$$ S_1 - S_2 = 2\\left[\\ln(4(1-\\epsilon)) - \\ln\\left(\\frac{4\\epsilon}{3}\\right)\\right] = 2\\ln\\left(\\frac{4(1-\\epsilon)}{4\\epsilon/3}\\right) = 2\\ln\\left(\\frac{3(1-\\epsilon)}{\\epsilon}\\right) $$\n错误概率（即最佳命中不正确的概率）是 $1 - P_{\\text{correct}}$：\n$$ 1 - P_{\\text{correct}} = 1 - \\frac{1}{1 + \\exp(S_2 - S_1)} = \\frac{\\exp(S_2 - S_1)}{1 + \\exp(S_2 - S_1)} = \\frac{1}{\\exp(S_1 - S_2) + 1} $$\n代入 $S_1 - S_2$ 的表达式：\n$$ 1 - P_{\\text{correct}} = \\frac{1}{\\exp\\left(2\\ln\\left(\\frac{3(1-\\epsilon)}{\\epsilon}\\right)\\right) + 1} = \\frac{1}{\\left(\\frac{3(1-\\epsilon)}{\\epsilon}\\right)^2 + 1} $$\n现在我们可以用 $\\epsilon$ 来表示比对质量 $Q$：\n$$ Q = -10\\,\\log_{10}(1 - P_{\\text{correct}}) = -10\\,\\log_{10}\\left(\\frac{1}{1 + \\left(\\frac{3(1-\\epsilon)}{\\epsilon}\\right)^2}\\right) = 10\\,\\log_{10}\\left(1 + \\left(\\frac{3(1-\\epsilon)}{\\epsilon}\\right)^2\\right) $$\n给定 $\\epsilon=0.01$。我们现在可以对这个表达式进行数值计算。\n首先，计算括号内的项：\n$$ \\frac{3(1-\\epsilon)}{\\epsilon} = \\frac{3(1-0.01)}{0.01} = \\frac{3 \\times 0.99}{0.01} = 3 \\times 99 = 297 $$\n现在，将这个值代入 $Q$ 的表达式中：\n$$ Q = 10\\,\\log_{10}(1 + 297^2) = 10\\,\\log_{10}(1 + 88209) = 10\\,\\log_{10}(88210) $$\n使用计算器计算对数：\n$$ \\log_{10}(88210) \\approx 4.945523 $$\n因此，比对质量为：\n$$ Q = 10 \\times 4.945523 \\approx 49.45523 $$\n将结果四舍五入到四位有效数字，得到 $49.46$。",
            "answer": "$$\\boxed{49.46}$$"
        }
    ]
}