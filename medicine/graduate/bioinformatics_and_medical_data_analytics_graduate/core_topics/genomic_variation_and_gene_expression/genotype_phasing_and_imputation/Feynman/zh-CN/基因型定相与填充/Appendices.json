{
    "hands_on_practices": [
        {
            "introduction": "基因型定相的目标是将二倍体生物中观察到的无序等位基因（基因型）解析为构成两条同源染色体的有序等位基因序列（单倍型）。这是理解遗传变异在染色体上具体分布的第一步。在评估定相算法的准确性时，准确理解“单倍型”和“转换错误”（switch error）等基本术语至关重要。 这个练习旨在通过一个简单的双杂合子位点场景，帮助您巩固这些核心定义。",
            "id": "4569491",
            "problem": "一个二倍体生物携带两条同源染色体。在一个双等位基因座上，基因型记录了存在于两条同源染色体上的等位基因的无序多重集；如果两个等位基因不同，则该基因型被称为杂合的。单倍型是沿着单条同源染色体的等位基因的有序序列，而定相（phasing）则是将每个基因座上观察到的等位基因分配给两个单倍型中的一个。考虑一个个体，其在基因座1的观察基因为 $A/G$，在基因座2的观察基因为 $T/C$。仅使用二倍性、杂合性、单倍型和跨基因座定相一致性的核心定义，确定哪个选项正确地列举了与观察到的基因型一致的所有可能的定相单倍型对，并正确地定义了在跨越基因座1和2的片段上构成转换错误的具体情况。\n  \nA. 与观察到的基因型一致的唯一可能的定相单倍型对是 $\\{(A,T),(G,C)\\}$ 和 $\\{(A,C),(G,T)\\}$。基因座1和2之间的转换错误意味着，相对于真实的定相，推断出的基因座2的等位基因在染色体上的分配相对于基因座1的分配是颠倒的，从而产生了互补的定相单倍型对；等效地说，这两个基因座之间的相对相位被反转了。\n\nB. 可能的定相单倍型包括 $\\{(A,T),(G,C)\\}$、$\\{(A,C),(G,T)\\}$，以及 $\\{(A,G),(T,C)\\}$，因为每个基因座可以任意地在染色体间配对。转换错误是指在任一基因座上，推断出的等位基因与真实的等位基因不匹配的任何情况，无论是否为杂合。\n\nC. 可能的单倍型正好是 $\\{(A,T),(G,C)\\}$ 和 $\\{(A,C),(G,T)\\}$，但转换错误被定义为错误分配基因座1的等位基因而保持基因座2正确；纯合位点上的错误分配也构成转换错误。\n\nD. 可能的单倍型是 $\\{(A,T),(G,C)\\}$ 和 $\\{(A,C),(G,T)\\}$，但转换错误仅在基因座1和2之间的减数分裂重组改变了真实的单倍型时发生；因此，当真实情况是 $\\{(A,T),(G,C)\\}$ 时，推断出 $\\{(A,C),(G,T)\\}$ 并不构成转换错误。",
            "solution": "该问题旨在评估对基因型定相基本概念的理解，包括单倍型对的构成和转换错误的定义。\n\n1.  **确定可能的单倍型对**：\n    -   个体在基因座1的基因型是 $A/G$，在基因座2是 $T/C$。这意味着该个体的两条同源染色体中，一条在基因座1有A，另一条有G；一条在基因座2有T，另一条有C。\n    -   单倍型是单条染色体上的等位基因序列。因此，我们需要将这些等位基因组合成两条单倍型，且这两条单倍型组合起来必须能重现观察到的基因型。\n    -   **可能性 1（耦合相）**：一条染色体携带 $(A, T)$，另一条携带 $(G, C)$。这对单倍型 $\\{(A,T), (G,C)\\}$ 组合后，在基因座1得到 $A/G$，在基因座2得到 $T/C$。这与观察到的基因型一致。\n    -   **可能性 2（排斥相）**：一条染色体携带 $(A, C)$，另一条携带 $(G, T)$。这对单倍型 $\\{(A,C), (G,T)\\}$ 组合后，在基因座1得到 $A/G$，在基因座2得到 $C/T$。这也与观察到的基因型一致。\n    -   其他组合，例如 $\\{(A,G), (T,C)\\}$（如选项B所述），是不正确的，因为 $(A,G)$ 不是一个跨基因座的单倍型，而是同一个基因座上的两个等位基因。因此，与观察到的基因型一致的单倍型对只有 $\\{(A,T), (G,C)\\}$ 和 $\\{(A,C), (G,T)\\}$。\n\n2.  **定义转换错误 (Switch Error)**：\n    -   转换错误是评估定相准确性的核心指标，特指在**连续的两个杂合位点**之间，推断的相对相位与真实相位相反。\n    -   假设真实的单倍型对是 $\\{(A,T), (G,C)\\}$。如果定相算法推断出单倍型对是 $\\{(A,C), (G,T)\\}$，那么在基因座1和2之间就发生了一次转换错误。相对于基因座1的分配（染色体1=A, 染色体2=G），基因座2的分配（染色体1=C, 染色体2=T）被颠倒了（本应是染色体1=T, 染色体2=C）。\n    -   选项A准确地描述了这一点：“转换错误意味着，相对于真实的定相，推断出的基因座2的等位基因在染色体上的分配相对于基因座1的分配是颠倒的”。\n    -   选项B对单倍型对的列举是错误的。\n    -   选项C对转换错误的定义不完整，并且错误地包含了纯合位点。转换错误是关于杂合位点之间的相对相位的。\n    -   选项D混淆了推断错误（转换错误）和生物学事件（减数分裂重组）。定相是一个推断过程，其错误与真实的重组事件是两个不同的概念。\n\n因此，选项A是唯一完全正确的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "基因型填充算法通常不直接输出最可能的基因型，而是为每个基因型（例如，次要等位基因计数为 $0$、$1$ 或 $2$）提供一个后验概率。为了在下游分析（如关联研究）中使用这些不确定的信息，我们常常计算一个称为“剂量”（dosage）的期望值。 这个练习将指导您如何根据给定的后验概率计算基因型剂量，并思考如何从根本上评估模型概率的准确性（即校准度）。",
            "id": "4569492",
            "problem": "考虑一个具有指定次要等位基因的单一位点的双等位基因单核苷酸多态性 (SNP)。设未观测的基因型由随机变量 $G \\in \\{0,1,2\\}$ 表示，代表次要等位基因的数量。一个基于隐马尔可夫模型 (HMM) 的填补算法，在给定观测数据的情况下，生成了关于 $G$ 的后验分布，表示为 $P(G=0 \\mid \\text{data}) = 0.1$，$P(G=1 \\mid \\text{data}) = 0.3$ 和 $P(G=2 \\mid \\text{data}) = 0.6$。仅使用概率论中条件期望的核心定义，以及将填补剂量解释为后验分布下的预期次要等位基因计数，计算该 SNP 的填补剂量 $\\hat{d}$。\n\n然后，仅使用概率校准的基本原理，简要地用文字解释，在一个拥有可用真实标签基因型的大型队列中，您将如何评估此类后验基因型概率是否针对真实基因型进行了校准，而无需在本问题中计算任何数值指标。\n\n请提供填补剂量的精确值（无需四舍五入）。剂量无需单位。",
            "solution": "该问题被评估为有效。它在科学上基于统计遗传学和概率论的原理，定义明确，提供了所有必要信息，并且没有歧义或矛盾。\n\n该问题包含两部分。第一部分要求计算单核苷酸多态性 (SNP) 的填补剂量，第二部分要求对如何评估基因型概率的校准情况进行概念性解释。\n\n**第一部分：计算填补剂量**\n\n问题将未观测的基因型定义为离散随机变量 $G$，它代表一个双等位基因 SNP 上次要等位基因的数量。$G$ 的可能值为 $g \\in \\{0, 1, 2\\}$，分别对应零个、一个或两个次要等位基因拷贝。\n\n一个填补算法生成了以观测数据为条件的 $G$ 的后验概率分布。这些概率给出如下：\n$P(G=0 \\mid \\text{data}) = 0.1$\n$P(G=1 \\mid \\text{data}) = 0.3$\n$P(G=2 \\mid \\text{data}) = 0.6$\n\n问题指出，填补剂量（表示为 $\\hat{d}$）应被解释为在该后验分布下的预期次要等位基因计数。这等同于计算随机变量 $G$ 在给定数据下的条件期望，写作 $E[G \\mid \\text{data}]$。\n\n根据离散随机变量期望的核心定义，期望值是每个可能值与其对应概率乘积的和。将此定义应用于条件情境中，我们得到：\n$$ \\hat{d} = E[G \\mid \\text{data}] = \\sum_{g \\in \\{0,1,2\\}} g \\cdot P(G=g \\mid \\text{data}) $$\n\n现在我们可以将给定的值代入此公式：\n$$ \\hat{d} = (0 \\cdot P(G=0 \\mid \\text{data})) + (1 \\cdot P(G=1 \\mid \\text{data})) + (2 \\cdot P(G=2 \\mid \\text{data})) $$\n$$ \\hat{d} = (0 \\cdot 0.1) + (1 \\cdot 0.3) + (2 \\cdot 0.6) $$\n$$ \\hat{d} = 0 + 0.3 + 1.2 $$\n$$ \\hat{d} = 1.5 $$\n\n因此，该 SNP 的填补剂量为 $1.5$。这个值代表在给定观测数据和模型的情况下，我们预期该个体拥有的次要等位基因的平均数量。\n\n**第二部分：评估概率校准**\n\n问题的第二部分要求解释如何使用基本原理和一个具有已知真实基因型的大型队列来评估后验基因型概率是否经过校准。\n\n概率校准，从其最根本的意义上讲，意味着如果一个模型以概率 $p$ 预测一个结果，那么在做出该预测的许多实例中，该结果应该以大约 $p$ 的频率被观察到。\n\n为了根据真实标签基因型来评估后验基因型概率（例如，对于 $g \\in \\{0, 1, 2\\}$ 的 $P(G=g \\mid \\text{data})$）的校准情况，可以执行以下概念性步骤：\n1.  选取一个大型个体队列，对于这个队列中的个体，我们既有模型得出的填补后验概率，也有通过实验确定的真实基因型。\n2.  为了检查特定基因型（例如 $G=2$）的校准情况，根据个体被预测的后验概率 $P(G=2 \\mid \\text{data})$ 将他们分组。例如，一个分组可以包含所有模型预测其 $P(G=2 \\mid \\text{data})$ 在 $[0.55, 0.65]$ 范围内的个体。\n3.  在每个分组内，计算经验频率：数出真实基因型确实为 $G=2$ 的个体数量，然后用这个数量除以该分组内的总个体数。\n4.  如果模型校准良好，这个计算出的经验频率应该接近该分组的平均预测概率（例如，对于 $[0.55, 0.65]$ 这个分组，大约为 $0.6$）。\n5.  对覆盖 $0$ 到 $1$ 范围的多个概率分组，以及对所有可能的基因型状态（$G=0$，$G=1$ 和 $G=2$），重复此过程，以形成对模型校准情况的全面评估。一个校准良好的模型，其赋予的概率与在所有基因型和所有概率水平上观察到的频率之间将表现出高度的一致性。",
            "answer": "$$\\boxed{1.5}$$"
        },
        {
            "introduction": "在评估基因型定相的质量时，转换错误率（Switch Error Rate, SER）是一个关键指标。它量化了在连续的杂合位点之间，推断出的单倍型错误地从一条染色体“跳”到另一条的频率。 这个练习不仅展示了如何计算这一重要的质量控制指标，更重要的是，它促使我们思考这种错误率水平如何从根本上影响依赖于单倍型完整性的下游分析，例如基因型填充的准确性。",
            "id": "4569545",
            "problem": "在基因型定相和填充中，一个常见的质量指标是推断出的单倍型在连续杂合位点之间错误地切换其亲本来源分配的速率。考虑一个根据亲子三人组衍生的外部真实数据集评估的定相染色体片段，该片段包含$T$个相邻的杂合位点对，这些位点对定义了潜在的相位转换位置（杂合转换）。假设经过校阅，在该片段上识别出$E$个错误的相位转换。使用将每个杂合转换视为相位转换正确与否的伯努利试验的基本定义，并将转换错误率定义为错误转换的期望分数，计算当$T = 1{,}000$次转换和$E = 25$次错误转换时的转换错误率。请以小数形式陈述你的最终答案，并四舍五入到四位有效数字。然后，基于单倍型推断的基本原理以及基于隐马尔可夫模型（HMM）的定相在不同连锁不平衡（LD）和次要等位基因频率（MAF）区域的行为，论证此水平的转换错误率预计将如何影响下游基于单倍型的填充准确性及相关分析。在你的数值答案中不要使用百分号；将该速率表示为无单位的小数。",
            "solution": "该问题要求根据给定数据计算转换错误率，并随后论证其对下游生物信息学分析的影响。验证过程确认了该问题在科学上是合理的、阐述清晰的，并包含完整解答所需的所有信息。\n\n首先，让我们将转换错误率（$SER$）的计算形式化。问题指出，$T$个相邻的杂合位点对（或称杂合转换）中的每一个都可以被视为一次伯努利试验。在这种情况下，一次试验代表了发生相位转换错误的机会。每次试验的结果是二元的：要么相位被正确推断，要么是错误的。问题给出了此类转换的总数$T$和观测到的错误相位转换总数$E$。\n\n给定的数值为：\n- 杂合转换的总数，$T = 1,000$。\n- 错误相位转换的次数，$E = 25$。\n\n问题将转换错误率定义为错误转换的期望分数。对于一系列伯努利试验，我们所关注事件（在此情况下为错误）的概率的最佳估计是其发生的相对频率。因此，转换错误率$SER$计算为观测到的错误数与总错误机会数之比：\n$$\nSER = \\frac{E}{T}\n$$\n将给定的数值代入此方程，得出：\n$$\nSER = \\frac{25}{1,000} = 0.025\n$$\n问题要求最终答案以小数形式表示，并四舍五入到四位有效数字。数字$0.025$有两位有效数字（$2$和$5$）。为了以四位有效数字表示，我们在后面追加两个零，得到$0.02500$。\n\n接下来，我们必须根据基本原理，论证此水平的转换错误率对下游基于单倍型的分析（如填充）的影响。$SER$为$0.025$意味着，平均而言，相邻杂合位点之间有$2.5\\%$的相位连接是不正确的。这意味着每$40$个这样的转换中就有一个是错误的。\n\n基于单倍型的填充的基本原理是，通过利用一个密集基因分型的已知单倍型参考面板，来推断研究样本中未分型的变异。算法（通常基于隐马尔可夫模型HMM）通过识别与研究个体的稀疏、已定相的单倍型框架相匹配的参考单倍型片段来工作。然后，算法从匹配度最高的参考单倍型中“复制”等位基因，以填补缺失的基因型。\n\n相位转换错误从根本上破坏了这一过程。当算法错误地交换了父源和母源的染色体片段时，就会发生转换错误。例如，如果两个连续杂合位点的真实父源和母源单倍型分别是$H_{pat} = \\dots A \\dots T \\dots$和$H_{mat} = \\dots G \\dots C \\dots$，那么这些位点之间的转换错误将导致推断出的单倍型为，例如，$\\dots A \\dots C \\dots$。这就产生了一个*嵌合*或*镶嵌*的单倍型，这种单倍型在个体中并不存在，并且极不可能存在于参考面板中，因为它是两种不同祖先背景的人工构造。\n\n这种嵌合单倍型对填充准确性的影响是严重的，尤其是在紧随转换错误之后的区域。当基于HMM的填充算法遇到一个转换错误时，当前追踪的参考单倍型会突然不再与个体的推断单倍型匹配。模型被迫转换到另一个不同的参考单倍型，以解释转换后观察到的数据。这种突然且人为的转换引入了很高的错误概率。本质上，转换错误破坏了单倍型块的完整性，导致填充算法“迷失方向”，并在试图重新找到匹配时犯错。这导致在转换错误位点周围的填充质量（以$r^2$等指标衡量）出现局部下降。\n\n这种影响的程度受到局部基因组背景的调节，特别是连锁不平衡（$LD$）和次要等位基因频率（$MAF$）。\n- 在高$LD$区域，长距离内的等位基因强相关，单倍型较长且多样性较低。单个转换错误的破坏性极高，因为它破坏了一个长的、保守的单倍型块，产生了一个在群体模型下概率非常低的序列。这使得该块内任何变异的填充，特别是那些依赖于这种长程背景的稀有变异，极易出错。\n- 在低$LD$区域（例如，重组热点），单倍型较短且更混杂。定相算法在这些区域自然会遇到更多困难，通常导致更高密度的转换错误。虽然在已经碎片化的区域中，单个错误可能被认为损害较小，但多个邻近错误的累积效应会降低整个低$LD$片段的填充质量。\n- 低$MAF$（稀有）变异的填充受到定相错误的过度影响。稀有变异通常存在于单个、长的祖先单倍型上。该单倍型的完整性对于它们的准确填充至关重要。$0.025$的转换错误率高到足以频繁地破坏这些携带稀有变异的单倍型，从而显著降低依赖于填充数据的稀有变异关联研究的效力和准确性。\n\n总而言之，$0.025$的转换错误率给数据带来了显著的嵌合单倍型负担。这通过导致与参考面板的局部不匹配、在底层的HMM中强制进行错误的状​​态转换，直接降低了下游填充的性能，并最终导致填充准确性的可测量下降，对稀有遗传变异的推断影响尤为严重。",
            "answer": "$$\n\\boxed{0.02500}\n$$"
        }
    ]
}