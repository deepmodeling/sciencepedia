{
    "hands_on_practices": [
        {
            "introduction": "位置权重矩阵（Position Weight Matrix, PWM）是表示DNA结合基序的核心工具。在实践中，我们从少量已知的结合位点序列中构建PWM，但这可能导致对某些碱基的观察计数为零，从而产生不可靠的概率估计。本练习将引导你使用带有狄利克雷伪计数的贝叶斯方法来构建一个更稳健的PWM，并探讨不同伪计数策略（例如均匀伪计数与背景加权伪计数）对模型参数的影响 。",
            "id": "4586777",
            "problem": "量化脱氧核糖核酸（DNA）结合位点比对中基序的一种常用方法是使用位置权重矩阵（PWM），其条目表示在基序的某个位置上观测到某个碱基相对于已知背景分布的对数几率。为了从每个位置的观测计数构建PWM，通常的做法是假设碱基的出现遵循一个多项式抽样模型，并对每个位置的碱基概率施加一个狄利克雷先验。狄利克雷先验是多项式分布的共轭先验，这使得后验分布具有解析上易于处理的性质。\n\n考虑一个包含 $N=5$ 个结合位点的比对中的单个基序列 $j$，其观测计数为 $(n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j}) = (3, 0, 1, 1)$，且已知背景分布为 $b = (b_{A}, b_{C}, b_{G}, b_{T}) = (0.3, 0.2, 0.2, 0.3)$。假设在第j列的碱基概率 $p_{j} = (p_{A,j}, p_{C,j}, p_{G,j}, p_{T,j})$ 上有一个狄利克雷先验，采用两种不同的伪计数方案，它们具有相同的总先验强度 $\\alpha_{0}=1$：\n1. 均匀伪计数方案，其先验参数为 $\\alpha^{(u)} = (\\alpha_{A}^{(u)}, \\alpha_{C}^{(u)}, \\alpha_{G}^{(u)}, \\alpha_{T}^{(u)}) = (0.25, 0.25, 0.25, 0.25)$。\n2. 背景加权伪计数方案，其先验参数为 $\\alpha^{(b)} = (\\alpha_{A}^{(b)}, \\alpha_{C}^{(b)}, \\alpha_{G}^{(b)}, \\alpha_{T}^{(b)}) = (0.3, 0.2, 0.2, 0.3)$。\n\n从多项式似然和狄利克雷先验的性质出发，推导两种伪计数方案下 $p_{C,j}$ 的后验均值估计，然后构建第 $j$ 列胞嘧啶对应的PWM对数几率条目，其定义为 $w_{C,j} = \\log_{2}\\big(p_{C,j}/b_{C}\\big)$。最后，计算均匀和背景加权胞嘧啶PWM条目之间的差值 $w_{C,j}^{(u)} - w_{C,j}^{(b)}$，并给出其值。将最终答案四舍五入到四位有效数字，并以比特为单位表示。",
            "solution": "该问题要求计算在DNA结合位点比对的特定列 $j$ 中，胞嘧啶（$C$）的两个位置权重矩阵（PWM）条目之间的差值。这两个条目是在贝叶斯框架内，根据两种不同的先验假设（伪计数方案）推导出来的。\n\n该问题基于狄利克雷分布和多项式分布之间的共轭先验关系。给定在第 $j$ 列，DNA四种碱基 $\\{A, C, G, T\\}$ 的一组观测计数，记为向量 $n_j = (n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j})$，这些计数的似然由一个多项式分布建模，其参数为 $p_j = (p_{A,j}, p_{C,j}, p_{G,j}, p_{T,j})$，其中 $p_{k,j}$ 是在位置 $j$ 观测到碱基 $k$ 的未知概率。\n\n在概率向量 $p_j$ 上施加一个狄利克雷先验分布。该先验由伪计数向量 $\\alpha = (\\alpha_{A}, \\alpha_{C}, \\alpha_{G}, \\alpha_{T})$ 参数化。给定观测计数 $n_j$，$p_j$ 的后验分布也是一个狄利克雷分布，其更新后的参数为 $\\alpha' = \\alpha + n_j = (\\alpha_{A}+n_{A,j}, \\alpha_{C}+n_{C,j}, \\alpha_{G}+n_{G,j}, \\alpha_{T}+n_{T,j})$。\n\n在第 $j$ 列特定碱基 $k$ 的概率的后验均值估计，记为 $\\hat{p}_{k,j}$，由以下公式给出：\n$$\n\\hat{p}_{k,j} = E[p_{k,j} | n_j, \\alpha] = \\frac{\\alpha_k + n_{k,j}}{\\sum_{i \\in \\{A,C,G,T\\}} (\\alpha_i + n_{i,j})}\n$$\n设 $N = \\sum_{i} n_{i,j}$ 为观测位点的总数，$\\alpha_0 = \\sum_{i} \\alpha_i$ 为总先验强度（总伪计数）。该公式简化为：\n$$\n\\hat{p}_{k,j} = \\frac{n_{k,j} + \\alpha_k}{N + \\alpha_0}\n$$\n问题提供以下数据：\n- 位点数 $N=5$。\n- 第 $j$ 列的观测计数：$(n_{A,j}, n_{C,j}, n_{G,j}, n_{T,j}) = (3, 0, 1, 1)$。具体来说，$n_{C,j} = 0$。\n- 总先验强度 $\\alpha_0 = 1$。\n- 背景分布 $b = (b_{A}, b_{C}, b_{G}, b_{T}) = (0.3, 0.2, 0.2, 0.3)$。具体来说，$b_C = 0.2$。\n\n我们现在将计算两种伪计数方案下胞嘧啶的后验均值概率 $\\hat{p}_{C,j}$。\n\n1.  **均匀伪计数方案：**\n    先验参数为 $\\alpha^{(u)} = (0.25, 0.25, 0.25, 0.25)$。胞嘧啶的伪计数为 $\\alpha_{C}^{(u)} = 0.25$。\n    $p_{C,j}$ 的后验均值估计为：\n    $$\n    \\hat{p}_{C,j}^{(u)} = \\frac{n_{C,j} + \\alpha_{C}^{(u)}}{N + \\alpha_0} = \\frac{0 + 0.25}{5 + 1} = \\frac{0.25}{6} = \\frac{1}{24}\n    $$\n    胞嘧啶对应的PWM条目 $w_{C,j}^{(u)}$ 定义为对数几率分数：\n    $$\n    w_{C,j}^{(u)} = \\log_{2}\\left(\\frac{\\hat{p}_{C,j}^{(u)}}{b_C}\\right) = \\log_{2}\\left(\\frac{1/24}{0.2}\\right) = \\log_{2}\\left(\\frac{1/24}{1/5}\\right) = \\log_{2}\\left(\\frac{5}{24}\\right)\n    $$\n\n2.  **背景加权伪计数方案：**\n    先验参数为 $\\alpha^{(b)} = (0.3, 0.2, 0.2, 0.3)$。胞嘧啶的伪计数为 $\\alpha_{C}^{(b)} = 0.2$。\n    $p_{C,j}$ 的后验均值估计为：\n    $$\n    \\hat{p}_{C,j}^{(b)} = \\frac{n_{C,j} + \\alpha_{C}^{(b)}}{N + \\alpha_0} = \\frac{0 + 0.2}{5 + 1} = \\frac{0.2}{6} = \\frac{1/5}{6} = \\frac{1}{30}\n    $$\n    胞嘧啶对应的PWM条目 $w_{C,j}^{(b)}$ 为：\n    $$\n    w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{\\hat{p}_{C,j}^{(b)}}{b_C}\\right) = \\log_{2}\\left(\\frac{1/30}{0.2}\\right) = \\log_{2}\\left(\\frac{1/30}{1/5}\\right) = \\log_{2}\\left(\\frac{5}{30}\\right) = \\log_{2}\\left(\\frac{1}{6}\\right)\n    $$\n\n最后，我们计算两个PWM条目之间的差值 $w_{C,j}^{(u)} - w_{C,j}^{(b)}$。\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{5}{24}\\right) - \\log_{2}\\left(\\frac{1}{6}\\right)\n$$\n利用对数的性质 $\\log(x) - \\log(y) = \\log(x/y)$，我们得到：\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}\\left(\\frac{5/24}{1/6}\\right) = \\log_{2}\\left(\\frac{5}{24} \\times 6\\right) = \\log_{2}\\left(\\frac{30}{24}\\right) = \\log_{2}\\left(\\frac{5}{4}\\right)\n$$\n为了求出数值，我们计算该表达式：\n$$\nw_{C,j}^{(u)} - w_{C,j}^{(b)} = \\log_{2}(1.25)\n$$\n使用换底公式 $\\log_2(x) = \\frac{\\ln(x)}{\\ln(2)}$：\n$$\n\\log_{2}(1.25) = \\frac{\\ln(1.25)}{\\ln(2)} \\approx \\frac{0.22314355}{0.69314718} \\approx 0.32192809 \\text{ 比特}\n$$\n将结果四舍五入到四位有效数字，得到 $0.3219$。",
            "answer": "$$\\boxed{0.3219}$$"
        },
        {
            "introduction": "拥有一个PWM模型后，下一步便是在基因组序列中扫描潜在的功能位点。然而，仅凭一个高分值的匹配并不足以得出结论，我们必须评估其统计显著性。本练习将教你如何为一个给定的PWM得分计算其$p$值和$E$值，从而理解一个得分在随机背景下的罕见程度，这是从海量序列数据中区分真实信号与随机噪声的关键一步 。",
            "id": "4586666",
            "problem": "一个实验室正在使用位置权重矩阵 (PWM) 扫描脱氧核糖核酸 (DNA) 序列中的转录因子结合基序。该 PWM 的宽度为 $w = 8$，并且在每个位置 $i \\in \\{1,\\dots,8\\}$，它为碱基 A 分配概率 $\\theta_{i,A} = \\frac{1}{2}$，为每个非 A 碱基 $b \\in \\{C,G,T\\}$ 分配概率 $\\theta_{i,b} = \\frac{1}{6}$。背景核苷酸分布是独立同分布的，其中 $b_{A} = b_{C} = b_{G} = b_{T} = \\frac{1}{4}$。一个长度为 8 的序列 $x_{1:8}$ 的得分 $S(x_{1:8})$ 定义为以自然对数为单位的各位置对数似然比之和，即 $S(x_{1:8}) = \\sum_{i=1}^{8} \\ln\\!\\left(\\frac{\\theta_{i,x_{i}}}{b_{x_{i}}}\\right)$。对于一个阈值 $t$，背景 p 值的定义为在背景模型下 $S(x_{1:8}) \\ge t$ 的概率。E 值是在扫描序列时预期超过阈值的次数，在此设置中，其模型为计分窗口数乘以背景 p 值。\n\n仅从这些定义和背景模型中固有的独立性假设出发，完成以下任务：\n- 推导出每个位置的不同得分值的集合，并将总分 $S(x_{1:8})$ 表示为 $x_{1:8}$ 中等于 A 的位置数 $k$ 的函数。\n- 使用背景模型，推导出 $k$ 的精确分布，并将精确的背景 p 值 $\\Pr(S \\ge t)$ 在 $t$ 等于某个 $k$ 可实现的得分时，表示为此分布的尾部概率。\n- 该实验室扫描一条长度为 $L = 32775$ 的 DNA 序列的两条链，对两条链上所有可能的窗口进行评分，总共有 $N = 2\\,(L - w + 1)$ 个窗口。确定以自然对数为单位的最小得分阈值 $t^{\\ast}$，使得背景中预期超过阈值的次数（E 值）恰好为 $1$。\n\n请以自然对数为单位，用精确的封闭形式表达式给出您的最终阈值 $t^{\\ast}$。不要四舍五入。",
            "solution": "我们从位置权重矩阵 (PWM) 和背景模型下的得分定义开始。根据定义，对于一个长度为 $w$ 的序列 $x_{1:w}$，其对数似然比得分为\n$$\nS(x_{1:w}) \\;=\\; \\sum_{i=1}^{w} \\ln\\!\\left(\\frac{\\theta_{i,x_{i}}}{b_{x_{i}}}\\right).\n$$\n在此， $w = 8$，在每个位置 $i$，$\\theta_{i,A} = \\frac{1}{2}$ 且对于 $b \\in \\{C,G,T\\}$ 有 $\\theta_{i,b} = \\frac{1}{6}$，背景概率为 $b_{A} = b_{C} = b_{G} = b_{T} = \\frac{1}{4}$。\n\n首先，我们推导每个位置的不同得分值。在任何位置 $i$：\n- 如果 $x_{i} = A$，则该位置的贡献为 $\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{4}}\\right) = \\ln 2$。\n- 如果 $x_{i} \\in \\{C,G,T\\}$，则该位置的贡献为 $\\ln\\!\\left(\\frac{\\frac{1}{6}}{\\frac{1}{4}}\\right) = \\ln\\!\\left(\\frac{2}{3}\\right)$。\n\n因此，每个位置只有两种得分值：$\\ln 2$ 和 $\\ln\\!\\left(\\frac{2}{3}\\right)$。令 $k$ 表示 8 个位置中 $x_{i} = A$ 的位置数量。那么总分是\n$$\nS \\;=\\; k \\cdot \\ln 2 + (8 - k)\\cdot \\ln\\!\\left(\\frac{2}{3}\\right).\n$$\n这可以等价地改写为\n$$\nS \\;=\\; 8 \\cdot \\ln\\!\\left(\\frac{2}{3}\\right) + k \\cdot \\left[\\ln 2 - \\ln\\!\\left(\\frac{2}{3}\\right)\\right]\n\\;=\\; 8 \\cdot \\ln\\!\\left(\\frac{2}{3}\\right) + k \\cdot \\ln 3.\n$$\n\n接下来，我们推导在背景模型下 $k$ 的精确分布。在背景模型下，各个位置的碱基是独立的，其中 $b_{A} = \\frac{1}{4}$ 且 $b_{\\text{non-}A} = \\frac{3}{4}$。因此，一个长度为 8 的随机背景序列中 A 碱基的数量 $k$ 服从参数为 $n = 8$ 和 $p = \\frac{1}{4}$ 的二项分布：\n$$\nk \\sim \\text{Binomial}\\!\\left(8, \\frac{1}{4}\\right),\n\\quad \\text{so} \\quad\n\\Pr(k = j) \\;=\\; \\binom{8}{j} \\left(\\frac{1}{4}\\right)^{j} \\left(\\frac{3}{4}\\right)^{8-j}.\n$$\n因为 $S$ 是 $k$ 的单调递增函数（$k$ 的每次增加都会用一个 $\\ln 2$ 替换一个 $\\ln\\!\\left(\\frac{2}{3}\\right)$，从而增加总和），任何等于某个整数 $k$ 的可实现得分 $S$ 的阈值 $t$ 都对应于 $k$ 的一个尾部事件。具体来说，如果对于某个整数 $k_{0} \\in \\{0,1,\\dots,8\\}$，有 $t = k_{0} \\cdot \\ln 2 + (8 - k_{0})\\cdot \\ln\\!\\left(\\frac{2}{3}\\right)$，那么\n$$\n\\Pr(S \\ge t) \\;=\\; \\Pr(k \\ge k_{0}) \\;=\\; \\sum_{j = k_{0}}^{8} \\binom{8}{j} \\left(\\frac{1}{4}\\right)^{j} \\left(\\frac{3}{4}\\right)^{8-j}.\n$$\n\n我们现在确定最小得分阈值 $t^{\\ast}$，使得在扫描一条长度为 $L = 32775$ 的序列的两条链时，预期超过阈值的次数恰好为 $1$。计分窗口的数量是\n$$\nN \\;=\\; 2 \\, (L - w + 1) \\;=\\; 2 \\, (32775 - 8 + 1) \\;=\\; 2 \\cdot 32768 \\;=\\; 65536.\n$$\n对于给定的阈值 $t$，根据定义，背景中预期超过阈值的次数（E 值）为\n$$\nE(t) \\;=\\; N \\cdot \\Pr(S \\ge t).\n$$\n我们寻求最小阈值 $t^{\\ast}$ 使得 $E(t^{\\ast}) = 1$。考虑对应于 $k=8$ 的最高可实现得分的阈值：\n$$\nt_{8} \\;=\\; 8 \\cdot \\ln 2.\n$$\n在此阈值下，唯一达到或超过该阈值的序列是所有 8 个位置都为 A 的序列，所以\n$$\n\\Pr(S \\ge t_{8}) \\;=\\; \\Pr(k = 8) \\;=\\; \\left(\\frac{1}{4}\\right)^{8} \\;=\\; \\frac{1}{4^{8}} \\;=\\; \\frac{1}{65536}.\n$$\n因此，\n$$\nE(t_{8}) \\;=\\; N \\cdot \\Pr(S \\ge t_{8}) \\;=\\; 65536 \\cdot \\frac{1}{65536} \\;=\\; 1.\n$$\n由于 $S$ 是 $k$ 的严格递增函数，任何严格大于 $t_{8}$ 的阈值 $t$ 都会有 $\\Pr(S \\ge t) = 0$，因此 $E(t) = 0$。而对于区间 $[t_{8}, t_{7})$ 内的任何阈值（其中 $t_7$ 是 $k=7$ 时的得分），其尾部概率将与 $t_8$ 处的相同，即 $\\Pr(S \\ge t) = \\Pr(k = 8)$，因此 E 值也同样为 $1$。因此，实现 $E = 1$ 的最小可实现阈值恰好是 $t^{\\ast} = t_{8} = 8 \\cdot \\ln 2$。\n\n因此，以自然对数为单位，所需的阈值为\n$$\nt^{\\ast} \\;=\\; 8 \\cdot \\ln 2.\n$$",
            "answer": "$$\\boxed{8\\ln 2}$$"
        },
        {
            "introduction": "在许多生物学场景中，我们拥有的只是一组怀疑包含共同基序的未对齐序列，而基序本身及其位置都是未知的。期望最大化（Expectation-Maximization, EM）算法是解决此类“从零开始”的基序发现问题的经典方法。通过亲手完成一次完整的EM迭代，你将深入理解算法如何通过在“期望”步骤中猜测基序位置的概率，并在“最大化”步骤中利用这些猜测来更新基序模型，从而从杂乱的数据中学习到隐藏的模式 。",
            "id": "4586657",
            "problem": "考虑一个应用于脱氧核糖核酸序列的“每条序列零次或一次出现”（ZOOPS）概率性基序发现模型。设序列数量为 $N=3$，每条序列的长度为 $L=4$，字母表为 $\\{A,C,G,T\\}$。假设一个宽度为 $W=2$ 的基序。背景分布是独立同分布的，其中 $b(A)=b(C)=b(G)=b(T)=\\frac{1}{4}$。初始的位置权重矩阵（PWM）$\\{\\theta_{j,b}\\}$ 和基序出现混合参数 $\\lambda$ 如下：\n- 位置 $j=1$：$\\theta_{1,A}=\\frac{1}{2}$，$\\theta_{1,C}=\\frac{1}{4}$，$\\theta_{1,G}=\\frac{1}{8}$，$\\theta_{1,T}=\\frac{1}{8}$。\n- 位置 $j=2$：$\\theta_{2,A}=\\frac{1}{8}$，$\\theta_{2,C}=\\frac{1}{2}$，$\\theta_{2,G}=\\frac{1}{4}$，$\\theta_{2,T}=\\frac{1}{8}$。\n- 混合参数：$\\lambda=\\frac{1}{2}$。\n\n假设如果一个基序出现在一条序列中，其起始位置 $s$ 在 $K=L-W+1=3$ 个可能的起始点上均匀分布，因此 $\\Pr(s\\mid\\text{基序存在})=\\frac{1}{K}$。观察到的三个序列是：\n- $S^{(1)}=\\text{ACGA}$，\n- $S^{(2)}=\\text{TTAC}$，\n- $S^{(3)}=\\text{GCAC}$。\n\n从潜变量混合模型的基本定义以及最大化期望完整数据对数似然的期望最大化（EM）原则出发，在上述独立性假设下的 ZOOPS 模型中，精确地执行一次期望步骤（E-step）和一次最大化步骤（M-step）。在 E 步骤中，计算潜变量的后验责任，该潜变量用于索引序列中基序的缺失或其起始位置。在 M 步骤中，通过最大化受归一化约束的期望完整数据对数似然来更新混合参数 $\\lambda$ 和 PWM $\\{\\theta_{j,b}\\}$，不使用任何伪计数。\n\n从基本原理出发，推导您使用的表达式，并为给定的数据集和初始参数明确执行所有计算。最后，仅报告更新后的基序概率 $\\theta_{1,A}^{\\text{new}}$（即经过单次 EM 迭代后，基序位置 $j=1$ 处碱基 $A$ 的概率）。将您的最终答案表示为精确分数，不要四舍五入。",
            "solution": "期望最大化（EM）算法的目标是找到参数的最大似然估计，其中模型依赖于未观察到的潜变量。设观测数据为 $S = \\{S^{(1)}, S^{(2)}, ..., S^{(N)}\\}$，潜变量为 $Z = \\{z_1, z_2, ..., z_N\\}$。在 ZOOPS 模型中，潜变量 $z_i$ 表示第 $i$ 条序列中基序的起始位置。$z_i$ 可以取值 $\\{0, 1, ..., K\\}$，其中 $K=L-W+1$。$z_i=0$ 表示序列 $S^{(i)}$ 中没有基序，$z_i = s > 0$ 表示基序从位置 $s$ 开始。设模型参数为 $\\Theta = (\\lambda, \\theta)$。\n\n**E步骤：计算后验责任**\n\nE步骤计算在给定数据和当前参数 $\\Theta^{\\text{old}}$ 的情况下潜变量的后验概率。这些被称为“责任”，记为 $\\gamma_i(s) = p(z_i=s | S^{(i)}, \\Theta^{\\text{old}})$。根据贝叶斯法则：\n$$ \\gamma_i(s) = \\frac{p(S^{(i)}, z_i=s | \\Theta^{\\text{old}})}{p(S^{(i)} | \\Theta^{\\text{old}})} = \\frac{p(S^{(i)}, z_i=s | \\Theta^{\\text{old}})}{\\sum_{s'=0}^{K} p(S^{(i)}, z_i=s' | \\Theta^{\\text{old}})} $$\n联合概率 $p(S^{(i)}, z_i=s | \\Theta)$ 可以分解为 $p(S^{(i)} | z_i=s, \\Theta) p(z_i=s | \\Theta)$。\n潜变量的先验概率由模型定义：\n- $p(z_i=0 | \\Theta) = 1-\\lambda$（无基序）\n- $p(z_i=s > 0 | \\Theta) = \\lambda \\cdot \\frac{1}{K}$（基序从位置 $s$ 开始）\n\n在给定潜变量的情况下，序列的似然 $p(S^{(i)} | z_i=s, \\Theta)$ 如下：\n- 如果没有基序 ($s=0$)，整个序列由背景分布生成：$p(S^{(i)} | z_i=0, \\Theta) = \\prod_{j=1}^{L} b(S^{(i)}_j)$。\n- 如果基序从位置 $s>0$ 开始，序列的基序部分由 PWM 生成，其余部分由背景生成：\n$$ p(S^{(i)} | z_i=s, \\Theta) = \\left( \\prod_{j'=1}^{W} \\theta_{j', S^{(i)}_{s+j'-1}} \\right) \\left( \\prod_{j \\notin [s, s+W-1]} b(S^{(i)}_j) \\right) $$\n我们可以将此重写为：\n$$ p(S^{(i)} | z_i=s, \\Theta) = \\left( \\prod_{j=1}^{L} b(S^{(i)}_j) \\right) \\cdot \\frac{\\prod_{j'=1}^{W} \\theta_{j', S^{(i)}_{s+j'-1}}}{\\prod_{j'=1}^{W} b(S^{(i)}_{s+j'-1})} $$\n给定参数为 $N=3, L=4, W=2, K=3$。$\\lambda = 1/2$。背景概率 $b(b) = 1/4$。\n$p(S^{(i)} | z_i=0, \\Theta) = (1-\\lambda) \\prod_{j=1}^{L} b(S_j^{(i)}) = \\frac{1}{2} (\\frac{1}{4})^4 = \\frac{1}{512}$。\n$p(S^{(i)}, z_i=s>0 | \\Theta) = \\frac{\\lambda}{K} \\cdot p(S^{(i)} | z_i=s, \\Theta) = \\frac{1/2}{3} \\cdot \\left( \\prod_{j=1}^{L} b(S_j^{(i)}) \\right) \\frac{\\prod_{j'=1}^{W} \\theta_{j', S^{(i)}_{s+j'-1}}}{\\prod_{j'=1}^{W} b(S^{(i)}_{s+j'-1})}$。\n设 $P_b(s) = \\prod_{j'=1}^{W} \\theta_{j', S^{(i)}_{s+j'-1}}$，$B(s) = \\prod_{j'=1}^{W} b(S^{(i)}_{s+j'-1})$。\n$\\gamma_i(s)$ 的计算可以简化，因为 $\\prod b(S_j^{(i)})$ 项在分子和分母中都会消掉。\n设 $p_i(s) = p(S^{(i)}, z_i=s | \\Theta)$。\n$p_i(0) \\propto 1-\\lambda = 1/2$。\n$p_i(s>0) \\propto \\frac{\\lambda}{K} \\frac{P_i(s)}{B(s)}$。对于 $W=2$ 且背景均匀，$B(s) = (1/4)^2 = 1/16$。\n$p_i(s>0) \\propto \\frac{1/2}{3} \\frac{P_i(s)}{1/16} = \\frac{8}{3} P_i(s)$。\n\n**对序列1: $S^{(1)}=\\text{ACGA}$**\n- $s=1$ (AC): $P_1(1) = \\theta_{1,A} \\theta_{2,C} = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$。$p_1(1) \\propto \\frac{8}{3} \\cdot \\frac{1}{4} = \\frac{2}{3}$。\n- $s=2$ (CG): $P_1(2) = \\theta_{1,C} \\theta_{2,G} = \\frac{1}{4} \\cdot \\frac{1}{4} = \\frac{1}{16}$。$p_1(2) \\propto \\frac{8}{3} \\cdot \\frac{1}{16} = \\frac{1}{6}$。\n- $s=3$ (GA): $P_1(3) = \\theta_{1,G} \\theta_{2,A} = \\frac{1}{8} \\cdot \\frac{1}{8} = \\frac{1}{64}$。$p_1(3) \\propto \\frac{8}{3} \\cdot \\frac{1}{64} = \\frac{1}{24}$。\n- $s=0$: $p_1(0) \\propto 1/2$。\n归一化常数 $Z_1 = \\frac{1}{2} + \\frac{2}{3} + \\frac{1}{6} + \\frac{1}{24} = \\frac{12+16+4+1}{24} = \\frac{33}{24} = \\frac{11}{8}$。\n- $\\gamma_1(0) = \\frac{1/2}{11/8} = \\frac{4}{11}$。\n- $\\gamma_1(1) = \\frac{2/3}{11/8} = \\frac{16}{33}$。\n- $\\gamma_1(2) = \\frac{1/6}{11/8} = \\frac{4}{33}$。\n- $\\gamma_1(3) = \\frac{1/24}{11/8} = \\frac{1}{33}$。\n\n**对序列2: $S^{(2)}=\\text{TTAC}$**\n- $s=1$ (TT): $P_2(1) = \\theta_{1,T} \\theta_{2,T} = \\frac{1}{8} \\cdot \\frac{1}{8} = \\frac{1}{64}$。$p_2(1) \\propto \\frac{8}{3} \\cdot \\frac{1}{64} = \\frac{1}{24}$。\n- $s=2$ (TA): $P_2(2) = \\theta_{1,T} \\theta_{2,A} = \\frac{1}{8} \\cdot \\frac{1}{8} = \\frac{1}{64}$。$p_2(2) \\propto \\frac{8}{3} \\cdot \\frac{1}{64} = \\frac{1}{24}$。\n- $s=3$ (AC): $P_2(3) = \\theta_{1,A} \\theta_{2,C} = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$。$p_2(3) \\propto \\frac{8}{3} \\cdot \\frac{1}{4} = \\frac{2}{3}$。\n- $s=0$: $p_2(0) \\propto 1/2$。\n归一化常数 $Z_2 = \\frac{1}{2} + \\frac{1}{24} + \\frac{1}{24} + \\frac{2}{3} = \\frac{12+1+1+16}{24} = \\frac{30}{24} = \\frac{5}{4}$。\n- $\\gamma_2(0) = \\frac{1/2}{5/4} = \\frac{2}{5}$。\n- $\\gamma_2(1) = \\frac{1/24}{5/4} = \\frac{1}{30}$。\n- $\\gamma_2(2) = \\frac{1/24}{5/4} = \\frac{1}{30}$。\n- $\\gamma_2(3) = \\frac{2/3}{5/4} = \\frac{8}{15}$。\n\n**对序列3: $S^{(3)}=\\text{GCAC}$**\n- $s=1$ (GC): $P_3(1) = \\theta_{1,G} \\theta_{2,C} = \\frac{1}{8} \\cdot \\frac{1}{2} = \\frac{1}{16}$。$p_3(1) \\propto \\frac{8}{3} \\cdot \\frac{1}{16} = \\frac{1}{6}$。\n- $s=2$ (CA): $P_3(2) = \\theta_{1,C} \\theta_{2,A} = \\frac{1}{4} \\cdot \\frac{1}{8} = \\frac{1}{32}$。$p_3(2) \\propto \\frac{8}{3} \\cdot \\frac{1}{32} = \\frac{1}{12}$。\n- $s=3$ (AC): $P_3(3) = \\theta_{1,A} \\theta_{2,C} = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$。$p_3(3) \\propto \\frac{8}{3} \\cdot \\frac{1}{4} = \\frac{2}{3}$。\n- $s=0$: $p_3(0) \\propto 1/2$。\n归一化常数 $Z_3 = \\frac{1}{2} + \\frac{1}{6} + \\frac{1}{12} + \\frac{2}{3} = \\frac{6+2+1+8}{12} = \\frac{17}{12}$。\n- $\\gamma_3(0) = \\frac{1/2}{17/12} = \\frac{6}{17}$。\n- $\\gamma_3(1) = \\frac{1/6}{17/12} = \\frac{2}{17}$。\n- $\\gamma_3(2) = \\frac{1/12}{17/12} = \\frac{1}{17}$。\n- $\\gamma_3(3) = \\frac{2/3}{17/12} = \\frac{8}{17}$。\n\n**M步骤：更新参数**\n\n在M步骤中，我们相对于参数 $\\Theta = (\\lambda, \\theta)$ 最大化期望完整数据对数似然 $Q(\\Theta|\\Theta^{\\text{old}})$。\n$$ Q(\\Theta|\\Theta^{\\text{old}}) = \\sum_{i=1}^N \\sum_{s=0}^K p(z_i=s | S^{(i)}, \\Theta^{\\text{old}}) \\ln p(S^{(i)}, z_i=s | \\Theta) $$\n$$ Q(\\Theta|\\Theta^{\\text{old}}) = \\sum_{i=1}^N \\sum_{s=0}^K \\gamma_i(s) \\ln p(S^{(i)}, z_i=s | \\Theta) $$\n\n**更新 $\\lambda^{\\text{new}}$**\n$\\lambda$ 的更新规则是所有序列中存在基序的后验概率的平均值。\n$$ \\lambda^{\\text{new}} = \\frac{1}{N} \\sum_{i=1}^N \\sum_{s=1}^K \\gamma_i(s) = \\frac{1}{N} \\sum_{i=1}^N (1 - \\gamma_i(0)) $$\n\n**更新 $\\theta_{k,b}^{\\text{new}}$**\n更新后的 PWM 参数 $\\theta_{k,b}^{\\text{new}}$ 是在位置 $k$ 观察到碱基 $b$ 的期望计数除以在位置 $k$ 观察到任何碱基的总期望计数。\n$$ \\theta_{k,b}^{\\text{new}} = \\frac{\\text{在位置 } k \\text{ 期望看到的碱基 } b \\text{ 的计数}}{\\text{在位置 } k \\text{ 期望看到的总计数}} = \\frac{\\sum_{i=1}^N \\sum_{s=1}^K \\gamma_i(s) I(S^{(i)}_{s+k-1} = b)}{\\sum_{i=1}^N \\sum_{s=1}^K \\gamma_i(s)} $$\n其中 $I(\\cdot)$ 是指示函数。\n\n我们需要计算 $\\theta_{1,A}^{\\text{new}}$。这需要计算在基序位置 $k=1$ 处碱基 $A$ 的期望计数。\n分母是所有基序存在的责任之和：\n$$ \\text{分母} = \\sum_{i=1}^N (1 - \\gamma_i(0)) = (1-\\frac{4}{11}) + (1-\\frac{2}{5}) + (1-\\frac{6}{17}) = \\frac{7}{11} + \\frac{3}{5} + \\frac{11}{17} $$\n$$ = \\frac{7 \\cdot 5 \\cdot 17 + 3 \\cdot 11 \\cdot 17 + 11 \\cdot 11 \\cdot 5}{11 \\cdot 5 \\cdot 17} = \\frac{595 + 561 + 605}{935} = \\frac{1761}{935} $$\n分子是碱基 $A$ 在位置1的期望计数， $c_{1,A}$：\n$$ c_{1,A} = \\sum_{i=1}^N \\sum_{s=1}^K \\gamma_i(s) I(S^{(i)}_{s} = A) $$\n- 对 $S^{(1)}=\\text{ACGA}$：只有 $s=1$ 时，位置1是'A' ($S^{(1)}_1 = A$)。贡献为 $\\gamma_1(1) = \\frac{16}{33}$。\n- 对 $S^{(2)}=\\text{TTAC}$：只有 $s=3$ 时，位置1是'A' ($S^{(2)}_3 = A$)。贡献为 $\\gamma_2(3) = \\frac{8}{15}$。\n- 对 $S^{(3)}=\\text{GCAC}$：只有 $s=3$ 时，位置1是'A' ($S^{(3)}_3 = A$)。贡献为 $\\gamma_3(3) = \\frac{8}{17}$。\n\n所以，分子为：\n$$ c_{1,A} = \\frac{16}{33} + \\frac{8}{15} + \\frac{8}{17} = \\frac{16}{3 \\cdot 11} + \\frac{8}{3 \\cdot 5} + \\frac{8}{17} $$\n$$ = \\frac{16 \\cdot 5 \\cdot 17 + 8 \\cdot 11 \\cdot 17 + 8 \\cdot 3 \\cdot 5 \\cdot 11}{3 \\cdot 11 \\cdot 5 \\cdot 17} = \\frac{1360 + 1496 + 1320}{2805} = \\frac{4176}{2805} $$\n最后，更新后的概率 $\\theta_{1,A}^{\\text{new}}$ 为：\n$$ \\theta_{1,A}^{\\text{new}} = \\frac{c_{1,A}}{\\sum_{i=1}^N (1 - \\gamma_i(0))} = \\frac{4176/2805}{1761/935} = \\frac{4176}{2805} \\cdot \\frac{935}{1761} $$\n由于 $2805 = 3 \\cdot 935$，我们可以简化：\n$$ \\theta_{1,A}^{\\text{new}} = \\frac{4176}{3 \\cdot 935} \\cdot \\frac{935}{1761} = \\frac{4176}{3 \\cdot 1761} $$\n$4176 \\div 3 = 1392$，$1761 \\div 3 = 587$。\n$$ \\theta_{1A}^{\\text{new}} = \\frac{1392}{1761} $$\n再次除以3：\n$$ \\theta_{1A}^{\\text{new}} = \\frac{1392 \\div 3}{1761 \\div 3} = \\frac{464}{587} $$\n数字 587 是一个质数，所以这个分数是最简形式。",
            "answer": "$$\n\\boxed{\\frac{464}{587}}\n$$"
        }
    ]
}