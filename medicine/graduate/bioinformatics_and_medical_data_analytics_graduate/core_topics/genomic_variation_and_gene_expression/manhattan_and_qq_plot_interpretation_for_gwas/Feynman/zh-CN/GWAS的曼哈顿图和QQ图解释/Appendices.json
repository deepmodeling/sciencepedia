{
    "hands_on_practices": [
        {
            "introduction": "曼哈顿图上的每一个点都代表着一个独立的统计检验。本练习将揭示从统计模型的效应量（$\\hat{\\beta}$）和标准误（$\\mathrm{SE}$）到决定其在图上垂直位置的 $-\\log_{10}(p)$ 值的基本转换过程 。掌握这一核心计算是将潜在的遗传关联可视化的第一步，它将抽象的统计结果与直观的图形表示联系起来。",
            "id": "4580204",
            "problem": "全基因组关联研究（GWAS）通常使用转换后$p$值的曼哈顿图和分位数-分位数（QQ）图来总结单核苷酸多态性（SNP）的关联结果，并评估原假设下检验统计量的校准情况。考虑通过广义线性模型分析单个SNP，其中遗传效应参数$\\beta$的最大似然估计量$\\hat{\\beta}$及其标准误$\\mathrm{SE}$已获得。\n\n从最大似然估计量的大样本理论出发，假设在标准正则性条件和无关联的原假设（$\\beta=0$）下，由$\\hat{\\beta}$和$\\mathrm{SE}$构成的标准化检验统计量服从标准正态分布。利用这一事实和$\\beta=0$的双边检验定义，推导标准化检验统计量与序对$(\\hat{\\beta}, \\mathrm{SE})$之间的关系，然后用该统计量和标准正态累积分布函数表示双边$p$值。\n\n最后，在双边检验下，计算当$\\hat{\\beta}=0.05$和$\\mathrm{SE}=0.01$时曼哈顿图的纵坐标$-\\log_{10}(p)$。将最终的$-\\log_{10}(p)$值四舍五入至四位有效数字。最终答案以无单位的纯数表示。",
            "solution": "用户提供了一个生物信息学和统计遗传学领域的问题，要求在全基因组关联研究（GWAS）的框架下推导检验统计量和$p$值，并进行一次具体计算。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 分析涉及单核苷酸多态性（SNP）和广义线性模型。\n- 遗传效应的最大似然估计量为$\\hat{\\beta}$，其标准误为$\\mathrm{SE}$。\n- 在原假设$H_0: \\beta=0$和大样本理论下，一个标准化的检验统计量服从标准正态分布$N(0, 1)$。\n- 检验是针对$\\beta=0$的双边检验。\n- 用于计算的具体值为$\\hat{\\beta}=0.05$和$\\mathrm{SE}=0.01$。\n- 期望的输出是曼哈顿图的纵坐标$-\\log_{10}(p)$，并四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据充分：** 该问题坚实地基于最大似然理论和假设检验（特别是Wald检验）的成熟原则，这些是统计遗传学和GWAS分析的基础。所作假设（最大似然估计的渐近正态性）是标准的。\n- **问题定义明确：** 问题定义清晰，提供了所有必要信息和明确的目标。从理论前提​​到数值计算的路径清晰明确，能导向唯一解。\n- **客观性：** 语言正式且精确，没有主观性。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它科学合理、定义明确且客观。将提供详细的解答。\n\n**推导与求解**\n\n问题从一个前提开始：对于大样本量，最大似然估计量$\\hat{\\beta}$近似服从正态分布。该分布以真实参数值$\\beta$为中心，其方差是标准误的平方，即$\\mathrm{SE}^2$。\n数学上，这表示为：\n$$\n\\hat{\\beta} \\approx N(\\beta, \\mathrm{SE}^2)\n$$\n原假设（$H_0$）假定没有遗传关联，这对应于参数$\\beta$等于零，即$H_0: \\beta=0$。在此假设下，估计量的分布变为：\n$$\n\\hat{\\beta} \\mid H_0 \\approx N(0, \\mathrm{SE}^2)\n$$\n为了构建一个标准化的检验统计量，我们减去原假设下的均值（为$0$）并除以标准差（即标准误$\\mathrm{SE}$）。设这个标准化的检验统计量为$Z$。\n因此，检验统计量与序对$(\\hat{\\beta}, \\mathrm{SE})$之间的关系为：\n$$\nZ = \\frac{\\hat{\\beta} - 0}{\\mathrm{SE}} = \\frac{\\hat{\\beta}}{\\mathrm{SE}}\n$$\n如问题所述，并由正态分布的性质证实，这个$Z$统计量在原假设下服从标准正态分布：\n$$\nZ \\mid H_0 \\sim N(0, 1)\n$$\n下一步是定义双边检验的$p$值。双边检验考虑在任一方向上（$\\beta > 0$或$\\beta  0$）不利于原假设的证据。$p$值是在假设$H_0$为真的前提下，观测到至少与从数据中计算出的检验统计量一样极端的统计量的概率。对于双边检验，“至少一样极端”对应于统计量的绝对值。\n\n令$z_{obs}$为从我们的数据中计算出的检验统计量的观测值。$p$值由下式给出：\n$$\np = P(|Z| \\ge |z_{obs}| \\mid H_0)\n$$\n其中$Z \\sim N(0, 1)$。这可以展开为：\n$$\np = P(Z \\ge |z_{obs}|) + P(Z \\le -|z_{obs}|)\n$$\n由于标准正态分布关于$0$的对称性，我们有$P(Z \\le -|z_{obs}|) = P(Z \\ge |z_{obs}|)$。因此，$p$值的表达式简化为：\n$$\np = 2 \\times P(Z \\ge |z_{obs}|)\n$$\n令$\\Phi(\\cdot)$表示标准正态分布的累积分布函数（CDF），即$\\Phi(x) = P(Z \\le x)$。尾部概率$P(Z \\ge |z_{obs}|)$可以用CDF表示为$1 - \\Phi(|z_{obs}|)$。\n将此代入$p$值的表达式中，得到最终关系：\n$$\np = 2 \\times (1 - \\Phi(|z_{obs}|))\n$$\n现在，我们可以使用给定的值进行计算：$\\hat{\\beta}=0.05$和$\\mathrm{SE}=0.01$。\n\n首先，我们计算检验统计量的观测值$z_{obs}$：\n$$\nz_{obs} = \\frac{\\hat{\\beta}}{\\mathrm{SE}} = \\frac{0.05}{0.01} = 5\n$$\n接下来，我们使用上面推导的公式计算双边$p$值：\n$$\np = 2 \\times (1 - \\Phi(5))\n$$\n$\\Phi(5)$的值非常接近$1$。使用高精度计算器计算标准正态CDF，我们发现单侧尾部概率$P(Z > 5)$约为$2.8665157 \\times 10^{-7}$。\n因此，$p$值为：\n$$\np = 2 \\times P(Z \\ge 5) \\approx 2 \\times (2.8665157 \\times 10^{-7}) = 5.7330314 \\times 10^{-7}\n$$\n最后，我们计算曼哈顿图的纵坐标，定义为$-\\log_{10}(p)$：\n$$\n-\\log_{10}(p) = -\\log_{10}(5.7330314 \\times 10^{-7})\n$$\n利用对数的性质，$\\log_{10}(a \\times 10^b) = \\log_{10}(a) + b$：\n$$\n-\\log_{10}(p) = -(\\log_{10}(5.7330314) + \\log_{10}(10^{-7})) = -(\\log_{10}(5.7330314) - 7) = 7 - \\log_{10}(5.7330314)\n$$\n计算对数值：\n$$\n\\log_{10}(5.7330314) \\approx 0.758384\n$$\n所以，纵坐标为：\n$$\n-\\log_{10}(p) \\approx 7 - 0.758384 = 6.241616\n$$\n问题要求将此最终值四舍五入至四位有效数字。前四位有效数字是$6, 2, 4, 1$。第五位有效数字是$6$，大于或等于$5$，所以我们将第四位数字向上取整。\n$$\n6.241616 \\rightarrow 6.242\n$$\n计算出的曼哈顿图纵坐标为$6.242$。",
            "answer": "$$\\boxed{6.242}$$"
        },
        {
            "introduction": "在进行数百万次检验时，传统的 $p$ 值阈值（如 $0.05$）会产生大量假阳性结果。本练习探讨如何通过计算Bonferroni校正等多重检验校正阈值来控制全基因组范围内的错误发现率 。理解这一概念对于正确解读曼哈顿图的“天际线”并识别真正显著的关联至关重要，这是区分统计噪声和潜在生物学信号的关键。",
            "id": "4580282",
            "problem": "一个联盟对一个复杂性状进行了一项大型多队列全基因组关联研究（GWAS），汇总了来自不同平台的插补基因型。经过质量控制，最终的关联扫描评估了 $M = 7.5 \\times 10^{6}$ 个单核苷酸多态性（SNP）。为了在全族错误率（family-wise error rate, FWER）控制下解释曼哈顿图和分位数-分位数（QQ）图，该研究设定的目标是在所有 $M$ 个假设检验中，全族错误率为 $\\alpha = 0.05$。\n\n从生物信息学和医学数据分析中多重检验的基本原理出发：\n- 使用全族错误率的定义，即在 $M$ 个原假设中至少有一个被错误拒绝的概率。\n- 在除了边际 $p$-值同分布外没有其他分布假设的情况下，应用并集界（union bound）推导确保FWER控制的单次检验阈值。\n- 在 $M$ 个检验相互独立的假设下，推导确保FWER控制的精确单次检验阈值。\n\n然后，对于给定的 $M$ 和 $\\alpha$：\n1. 计算由并集界推导出的 Bonferroni 单次检验 $p$-值阈值。\n2. 计算由独立性假设推导出的 Šidák 单次检验 $p$-值阈值。\n3. 计算乘法差异 $\\rho$，定义为 Šidák 阈值与 Bonferroni 阈值的比率。\n\n最后，根据 SNP 之间的连锁不平衡，简要论证在解释具有相关标记的真实 GWAS 中的曼哈顿图和 QQ 图时，这两个阈值中哪一个更为保守。\n\n将报告的每个数值四舍五入到四位有效数字，并用标准的以10为底的科学记数法表示 $p$-值阈值。不需要物理单位。",
            "solution": "该问题经确认为科学上合理、定义明确且客观。它是统计遗传学中的一个标准问题，可以使用多重假设检验的既定原则来解决。\n\n令 $M$ 为检验的单核苷酸多态性（SNP）总数，即 $M = 7.5 \\times 10^{6}$。令 $\\alpha$ 为期望的全族错误率（FWER），给定为 $\\alpha = 0.05$。对于每个 SNP $i \\in \\{1, 2, \\dots, M\\}$，我们检验一个原假设 $H_{0i}$，即该 SNP 与性状无关。每次检验的结果是一个 $p$-值 $P_i$。\n\n全族错误率（FWER）定义为在所有 $M$ 次检验中犯至少一次 I 类错误（错误地拒绝一个真实的原假设）的概率。令 $E_i$ 为第 $i$ 次检验犯 I 类错误的事件。假设在所有原假设均为真的最坏情况下，FWER 由下式给出：\n$$\n\\text{FWER} = P\\left(\\bigcup_{i=1}^{M} E_i\\right)\n$$\n我们寻求一个单次检验的显著性阈值，称之为 $p_{th}$，使得当 $P_i \\le p_{th}$ 时我们拒绝 $H_{0i}$。在原假设下，$p$-值在 $[0, 1]$ 上均匀分布，因此单次检验犯 I 类错误的概率是 $P(E_i) = P(P_i \\le p_{th}) = p_{th}$。\n\n**Bonferroni 阈值的推导（并集界）**\n\nBonferroni 校正是使用布尔不等式（Boole's inequality），也称为并集界（union bound）推导出来的。该不等式指出，对于任何事件集合，其并集的概率小于或等于它们各自概率的总和。此推导不对检验的依赖结构做任何假设。\n$$\n\\text{FWER} = P\\left(\\bigcup_{i=1}^{M} E_i\\right) \\le \\sum_{i=1}^{M} P(E_i)\n$$\n代入 $P(E_i) = p_{th}$：\n$$\n\\text{FWER} \\le \\sum_{i=1}^{M} p_{th} = M \\cdot p_{th}\n$$\n为确保 FWER 控制在水平 $\\alpha$，我们强制执行以下条件：\n$$\nM \\cdot p_{th} \\le \\alpha\n$$\n这就得出了 Bonferroni 单次检验阈值 $p_{Bonf}$：\n$$\np_{Bonf} = \\frac{\\alpha}{M}\n$$\n\n**Šidák 阈值的推导（独立性假设）**\n\nŠidák 校正假设所有 $M$ 个检验都是相互独立的。在此假设下，事件并集的概率可以精确计算。不犯任何 I 类错误的概率是每次独立检验中不犯 I 类错误的概率的乘积：\n$$\nP(\\text{no Type I errors}) = P\\left(\\bigcap_{i=1}^{M} E_i^c\\right) = \\prod_{i=1}^{M} P(E_i^c)\n$$\n其中 $E_i^c$ 是事件 $E_i$ 的补集。单次检验不犯 I 类错误的概率是 $P(E_i^c) = 1 - P(E_i) = 1 - p_{th}$。\n$$\nP(\\text{no Type I errors}) = \\prod_{i=1}^{M} (1 - p_{th}) = (1 - p_{th})^M\n$$\nFWER 是至少犯一次 I 类错误的概率，即 1 减去不犯任何 I 类错误的概率：\n$$\n\\text{FWER} = 1 - P(\\text{no Type I errors}) = 1 - (1 - p_{th})^M\n$$\n为了将 FWER 精确控制在水平 $\\alpha$，我们设定：\n$$\n1 - (1 - p_{th})^M = \\alpha\n$$\n解出 $p_{th}$，得到 Šidák 单次检验阈值 $p_{Sidak}$：\n$$\n(1 - p_{Sidak})^M = 1 - \\alpha\n$$\n$$\n1 - p_{Sidak} = (1 - \\alpha)^{1/M}\n$$\n$$\np_{Sidak} = 1 - (1 - \\alpha)^{1/M}\n$$\n\n**数值计算**\n\n给定 $M = 7.5 \\times 10^{6}$ 和 $\\alpha = 0.05$。\n\n1.  **Bonferroni 单次检验 $p$-值阈值 ($p_{Bonf}$):**\n    $$\n    p_{Bonf} = \\frac{\\alpha}{M} = \\frac{0.05}{7.5 \\times 10^{6}} = \\frac{5 \\times 10^{-2}}{7.5 \\times 10^{6}} = \\frac{2}{3} \\times 10^{-8} \\approx 6.6667 \\times 10^{-9}\n    $$\n    四舍五入到四位有效数字，$p_{Bonf} = 6.667 \\times 10^{-9}$。\n\n2.  **Šidák 单次检验 $p$-值阈值 ($p_{Sidak}$):**\n    $$\n    p_{Sidak} = 1 - (1 - 0.05)^{1/(7.5 \\times 10^{6})} = 1 - (0.95)^{1/(7.5 \\times 10^{6})}\n    $$\n    要计算这个值，对于很小的 $x$，我们可以使用近似 $1 - \\exp(x) \\approx -x$。我们来计算指数：\n    $$\n    \\frac{1}{M} \\ln(1-\\alpha) = \\frac{1}{7.5 \\times 10^{6}} \\ln(0.95) \\approx \\frac{-0.05129329}{7.5 \\times 10^{6}} \\approx -6.8391059 \\times 10^{-9}\n    $$\n    所以，$p_{Sidak} = 1 - \\exp\\left(\\frac{\\ln(0.95)}{7.5 \\times 10^{6}}\\right) \\approx 1 - \\exp(-6.8391059 \\times 10^{-9})$。\n    使用近似可得 $p_{Sidak} \\approx -(-6.8391059 \\times 10^{-9}) = 6.8391059 \\times 10^{-9}$。\n    四舍五入到四位有效数字，$p_{Sidak} = 6.839 \\times 10^{-9}$。\n\n3.  **乘法差异 ($\\rho$):**\n    $$\n    \\rho = \\frac{p_{Sidak}}{p_{Bonf}} = \\frac{6.8391059 \\times 10^{-9}}{6.666666... \\times 10^{-9}} \\approx 1.0258659\n    $$\n    四舍五入到四位有效数字，$\\rho = 1.026$。这表明 Šidák 阈值比 Bonferroni 阈值稍微不那么严格（即更大）。\n\n**GWAS 中保守性的论证**\n\n在真实 GWAS 的背景下，**Bonferroni 阈值比 Šidák 阈值更保守**。一个更保守的阈值是一个更严格（即更小）的阈值，这使得宣布结果具有统计显著性更加困难，从而减少了发现的数量。\n\n我们的计算表明 $p_{Bonf}  p_{Sidak}$。对于任何 $M > 1$ 和 $\\alpha \\in (0, 1)$，这个数学关系都成立，这意味着 Bonferroni 阈值在数值上总是更小，因此更严格。\n\n从连锁不平衡（LD）的角度论证如下：\n-   **连锁不平衡（Linkage Disequilibrium, LD）** 指的是不同位点等位基因的非随机关联。在 GWAS 中，染色体上物理位置相近的 SNP 通常会一起遗传，这意味着它们的基因型（以及它们的检验统计量）是正相关的。\n-   **Šidák 校正**明确假设 $M$ 个检验是独立的。LD 的存在直接违反了这一假设。\n-   **Bonferroni 校正**基于并集界，不对依赖性做任何假设。它是一种通用的 FWER 控制器。然而，因为它考虑了最坏的依赖情况，所以它被认为是过于保守的，特别是当检验呈正相关时，就像 LD 中的 SNP 一样。正相关意味着有效独立检验的数量远小于 $M$。\n-   事实上，对于具有广泛 LD 的典型 GWAS 数据集，这两种方法都过于保守。然而，问题是问两者中哪一个*更*保守。由于 $p_{Bonf}$ 总是小于 $p_{Sidak}$，并且这种关系不受相关性存在的影响，因此 Bonferroni 校正仍然是更保守的方法。它对原始检验数（$M$）进行了过度校正，而没有对 LD 引入的冗余进行任何调整，导致在这两者之间产生了最严格的显著性标准。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 6.667 \\times 10^{-9}  6.839 \\times 10^{-9}  1.026 \\end{pmatrix} } $$"
        },
        {
            "introduction": "一张清晰、信号明确的曼哈顿图背后是严格的质量控制。本练习将深入探讨一个关键的质控步骤：过滤违反哈迪-温伯格平衡（HWE）的变异，因为这通常是基因分型错误的标志 。通过这个案例，你将学习这些技术误差如何产生虚假的关联信号并导致QQ图膨胀，并设计一个合理的过滤器来净化数据，同时避免移除真实的疾病关联。",
            "id": "4580225",
            "problem": "一项关于某种二元性状疾病的病例-对照全基因组关联研究（GWAS）包含了 $n_{\\text{cases}} = 20{,}000$ 例病例和 $n_{\\text{controls}} = 30{,}000$ 名对照，这些样本使用高密度芯片进行基因分型，并随后进行了基因型填充。曼哈顿图显示，在8号染色体的一个片段上，存在一个由高度显著的单核苷酸多态性（SNP）组成的密集簇；而分位数-分位数图（QQ图）显示，在基因组控制（GC）膨胀因子 $\\lambda_{\\text{GC}} \\approx 1.15$ 的情况下，观察值很早就偏离了零假设的期望线。可疑区域中的变异具有较低的填充质量，并在对照组中表现出过高的杂合性。已知全基因组中有 $m = 8 \\times 10^{6}$ 个次要等位基因频率（MAF）$\\ge 0.01$ 的常见变异，以及另外 $m_{\\text{rare}} = 12 \\times 10^{6}$ 个 MAF $ 0.01$ 的罕见变异。\n\n从哈迪-温伯格平衡（HWE）的基本定义出发：对于一个双等位基因位点，在一个随机交配、无分层、无选择、无突变、无迁移的群体中，如果参考等位基因的频率为 $p$，备选等位基因的频率为 $q = 1 - p$，则预期的基因型频率为 $p^2$、$2pq$ 和 $q^2$。HWE检验评估观察到的基因型计数是否偏离这些期望值；在HWE的零假设下，HWE检验的p值在 $\\left[0,1\\right]$ 区间上呈均匀分布。在GWAS中，曼哈顿图中的伪关联峰和QQ图中的膨胀可能源于系统性的基因分型或基因型填充假象，这些假象会引起HWE偏离，并与病例-对照状态产生伪相关（例如，病例和对照之间存在差异的批次效应）。\n\n以下哪种策略最恰当地解释了哈迪-温伯格平衡的违背如何产生伪曼哈顿峰，并设计了一个科学合理的、基于HWE的变异过滤器来减少此类假象，同时保留真实的关联信号？此外，在你选择的过滤器下，根据在零假设下HWE的p值是均匀分布这一事实，陈述在完美的HWE零模型下，预期被移除的常见变异数量。\n\nA. 在所有样本中合并计算HWE的p值，并在全基因组范围内移除任何HWE $p  10^{-2}$ 的变异。这将积极抑制伪峰，而不会影响真实信号。在零假设下，预期被移除的常见变异数量为 $8 \\times 10^{4}$。\n\nB. 仅在对照组中计算HWE的p值，并在每个祖源群体内进行分层，过滤掉任何层中HWE $p  10^{-6}$ 的常见变异（MAF $\\ge 0.01$）；对于罕见变异（MAF $ 0.01$），不应用HWE过滤器，而是依赖于正交的质量指标。这针对的是导致对照组杂合子过多或过少的假象，并避免移除在病例中可能偏离HWE的真实疾病信号。在零假设下，预期被移除的常见变异数量为 $8$。\n\nC. 仅在病例组中计算HWE的p值，并在全基因组范围内移除任何HWE $p  10^{-6}$ 的变异。这能保留统计功效并避免移除致病变异。在零假设下，预期被移除的常见变异数量为 $8$。\n\nD. 不使用HWE过滤，因为QQ图的膨胀（$\\lambda_{\\text{GC}} \\approx 1.15$）表明这是一个高度多基因的性状。相反，依赖于更严格的Bonferroni关联阈值。在零假设下，预期被移除的常见变异数量为 $0$。\n\n选择唯一最佳选项。",
            "solution": "我们从哈迪-温伯格平衡（HWE）的定义开始。对于一个等位基因频率分别为 $p$ 和 $q = 1 - p$ 的双等位基因位点，在一个理想的随机交配群体中，预期的基因型比例为 $p^{2}$（纯合参考型）、$2pq$（杂合型）和 $q^{2}$（纯合备选型）。HWE检验将观察到的基因型计数与这些期望值进行比较，并产生一个p值，在HWE的零假设下，该p值在 $\\left[0,1\\right]$ 区间上是均匀分布的。因此，如果使用一个HWE p值阈值 $\\alpha$ 作为零假设下的质量控制过滤器，预期被移除的变异比例是 $\\alpha$。对于 $m$ 个独立的常见变异，预期被移除的数量是 $m \\alpha$。\n\n将HWE与曼哈顿图和分位数-分位数（QQ）图联系起来：曼哈顿图总结了全基因组的关联p值；QQ图将观察到的关联检验统计量的分布与其在零假设下的期望分布进行比较。系统性的基因分型或基因型填充错误会造成并非由真实生物学效应引起的HWE偏离。例如，等位基因检出偏倚可能导致杂合子过少或过多，而病例和对照之间不同的批次效应可能将此类偏倚与表型联系起来。这会使关联统计量膨胀，并在基因型质量较低的区域产生低p值簇（伪峰）。在QQ图中，这表现为超出仅由多基因性所预期的早期膨胀，特别是当这种膨胀与集中在特定区域的质量问题和HWE偏离同时出现时。\n\n在病例-对照研究中，由于外显率效应，真实的致病变异可能在病例中违背HWE，而对照组在排除群体结构或选择的情况下，应严格遵守HWE。因此，在对照组中（并在祖源分层内）计算HWE是标准做法，以避免过滤掉在病例中合理偏离HWE的真实信号。此外，在极低的次要等位基因频率（MAF）下，HWE检验的统计功效较低且行为存在偏倚，因此，依赖于MAF的应用是审慎的：对常见变异应用严格的HWE阈值，而对罕见变异避免或放宽HWE过滤器，转而依赖正交的质量指标（例如，测序深度、等位基因平衡、孟德尔一致性或针对基因型不确定性校正的哈迪-温伯格平衡检验）。\n\n我们现在分析每个选项。\n\n选项 A：在所有样本中计算HWE，并使用一个宽松的阈值 $p  10^{-2}$。在p值均匀分布的零假设下，对于 $m = 8 \\times 10^{6}$ 个常见变异，预期被移除的数量为 $m \\alpha = \\left(8 \\times 10^{6}\\right) \\times \\left(10^{-2}\\right) = 8 \\times 10^{4}$，这与陈述的数量相符。然而，这种方法存在两个缺陷。首先，使用所有样本可能会不当地移除真实的关联信号，因为与疾病相关的位点可能在病例中偏离HWE。其次，$10^{-2}$ 的阈值并非一个假象富集阈值；它过于宽松，以至于在完美的HWE下会移除大约1%的所有常见变异，包括许多高质量的变异，从而降低统计功效并可能使下游分析产生偏倚。它也未能解决按祖源进行分层的必要性，而这对于避免由群体结构引起的伪偏离至关重要。结论：不正确。\n\n选项 B：仅在对照组中计算HWE，按祖源分层，对常见变异使用 $p  10^{-6}$ 的严格过滤器，对罕见变异不使用HWE过滤器，而是依赖正交的质量指标。这符合最佳实践的推理：当假象引起HWE偏离且在病例和对照之间存在差异时，就会产生伪峰；在对照组中检验HWE可以避免移除真正的疾病相关变异。按祖源分层可以适应群体亚结构。所选的 $10^{-6}$ 阈值足够严格，主要针对由技术误差而非随机波动引起的显著偏离，尤其是在大样本中。对于常见变异，在零假设下，预期被移除的数量为 $m \\alpha = \\left(8 \\times 10^{6}\\right) \\times \\left(10^{-6}\\right) = 8$。对于罕见变异，HWE检验不稳定；避免一概而论的HWE过滤可以防止不合理地移除真实变异，而是利用为罕见变异质量量身定制的指标。该选项也直接解释了假象如何产生伪曼哈顿峰以及该过滤器如何解决它们。结论：正确。\n\n选项 C：仅在病例组中计算HWE，并使用 $p  10^{-6}$ 的过滤器。虽然如上计算，在零假设下预期被移除的常见变异数量为 $8$，但这种设计在概念上存在缺陷。真正的致病变异可能在受影响的群体中偏离HWE，因为外显率会改变病例中的基因型频率，因此在病例中进行HWE过滤会优先移除真实的关联信号，使结果偏向于零假设。它也未能按祖源进行分层，也没有解决在对照组中检测假象的问题。结论：不正确。\n\n选项 D：放弃HWE过滤，将QQ图的膨胀完全视为多基因性，并仅通过更严格的Bonferroni阈值进行补偿。这忽略了假象的经验线索：低质量区域中集中的曼哈顿峰和对照组中的HWE偏离。更严格的显著性阈值并不能修正系统性偏倚；它可能使伪峰未被处理，并降低检测真实关联的统计功效。质量控制，包括适当应用的HWE过滤，是在进行关联检验和多重检验校正之前减少假象所必需的。结论：不正确。\n\n因此，最佳选择是选项B。在选项B下，零假设下预期被移除的常见变异数量为 $8$。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}