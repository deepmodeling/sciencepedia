{
    "hands_on_practices": [
        {
            "introduction": "在解读一个变异的生物学意义之前，我们必须首先确认其技术上的可靠性。对于杂合变异，等位基因平衡（Allele Balance, AB）是一个关键的质量控制指标，它检验了支持参考等位基因和备选等位基因的测序读段是否大致遵循预期的 $1:1$ 比例。本练习将通过一个典型的场景，运用统计学原理来评估一个杂合变异检出的可靠性()。",
            "id": "4616746",
            "problem": "在一个通过变异检出格式 (VCF) 流程处理的人类种系样本中，观察到一个单核苷酸变异。深度字段 ($DP$) 报告了覆盖该基因座的总测序读数数量，等位基因深度字段 ($AD$) 按顺序报告了支持参考等位基因和变异等位基因的测序读数数量。等位基因平衡 (AB) 定义为在该基因座位点上，分配给变异等位基因的测序读数占所有分配给等位基因的测序读数的比例。假设在标准高通量测序中，对于一个真实的二倍体杂合基因型，每条测序读数来自两条染色体拷贝之一，并且将一条测序读数分配给参考或变异等位基因是一个独立试验；因此，在杂合基因型下，变异等位基因的测序读数计数遵循成功概率为 $0.5$ 的二项分布。\n\n给定 $DP=80$ 和 $AD=\\{48,32\\}$。使用上述定义和针对种系杂合单核苷酸变异的标准质量控制 (QC) 启发式方法——即，典型的杂合子筛选器要求等位基因平衡在区间 $[0.3,0.7]$ 内，变异等位基因的测序读数计数至少为 $10$，并且观察到的等位基因平衡在二项分布的高斯近似下，在置信水平 $0.95$ 时应与 $0.5$ 统计上一致——根据这些字段计算等位基因平衡 $AB$。然后，基于第一性原理和所给假设，论证在该些典型的 QC 阈值下，此杂合检出结果是否可靠。\n\n仅报告 $AB$ 的数值，以小数形式表示，并四舍五入到四位有效数字。",
            "solution": "本题要求计算一个单核苷酸变异的等位基因平衡 ($AB$)，并根据一套标准的质量控制 (QC) 标准，评估其作为杂合检出结果的可靠性。\n\n首先，我们必须验证题目陈述。\n已知条件如下：\n- 基因座的总测序深度，$DP = 80$。\n- 等位基因深度计数，$AD = \\{48, 32\\}$。\n- 等位基因平衡 ($AB$) 的定义：分配给变异等位基因的测序读数的比例。\n- 真实杂合基因型的模型：变异等位基因的测序读数计数遵循成功概率为 $p=0.5$ 的二项分布。\n- QC 标准 1：$AB \\in [0.3, 0.7]$。\n- QC 标准 2：变异等位基因的测序读数计数 $\\ge 10$。\n- QC 标准 3：观察到的 $AB$ 必须在使用高斯近似的情况下，在 $0.95$ 的置信水平上与 $p=0.5$ 统计上一致。\n\n该问题有科学依据、定义明确且客观。所提供的数据和模型在基因组学和变异检出领域是标准的。数据内部一致，问题没有歧义。因此，该问题被认为是有效的。\n\n我们开始解题。\n\n等位基因深度字段 $AD=\\{48, 32\\}$ 分别指明了支持参考等位基因的测序读数数量 $N_{REF}$ 和支持变异等位基因的测序读数数量 $N_{ALT}$。\n因此，我们有：\n$N_{REF} = 48$\n$N_{ALT} = 32$\n\n支持这两种等位基因的总测序读数数量为 $n = N_{REF} + N_{ALT} = 48 + 32 = 80$。这与给定的总深度 $DP=80$ 一致。\n\n等位基因平衡 ($AB$) 定义为分配给变异等位基因的测序读数的比例。其计算方式如下：\n$$AB = \\frac{N_{ALT}}{N_{REF} + N_{ALT}} = \\frac{32}{80} = 0.4$$\n题目要求将此值以小数形式报告，并四舍五入到四位有效数字，即 $0.4000$。\n\n接下来，我们必须通过对照所提供的三个 QC 启发式方法来评估此杂合检出结果是否可靠。\n\n1.  **标准 1：等位基因平衡范围**\n    筛选器要求等位基因平衡在区间 $[0.3, 0.7]$ 内。我们计算出的等位基因平衡是 $AB=0.4$。由于 $0.3 \\le 0.4 \\le 0.7$，此标准得到满足。\n\n2.  **标准 2：变异等位基因测序读数计数**\n    筛选器要求变异等位基因的测序读数计数 $N_{ALT}$ 至少为 $10$。我们观察到的计数为 $N_{ALT}=32$。由于 $32 \\ge 10$，此标准也得到满足。\n\n3.  **标准 3：统计一致性**\n    此标准要求在 $0.95$ 的置信水平上，观察到的等位基因平衡与真实杂合子 ($p=0.5$) 的理论期望值统计上一致。我们被要求使用二项分布的高斯近似。\n\n    设 $p$ 为变异等位基因的真实比例。对于一个杂合二倍体基因座，原假设为 $H_0: p = p_0 = 0.5$。观察到的样本比例是 $\\hat{p} = AB = 0.4$。试验次数是总测序读数，$n=80$。\n\n    中心极限定理指出，对于足够大的样本量 $n$，样本比例 $\\hat{p}$ 的抽样分布可以用均值为 $p$、标准差（标准误）为 $SE = \\sqrt{\\frac{p(1-p)}{n}}$ 的正态（高斯）分布来近似。这种近似的有效性取决于 $np \\ge 5$ 和 $n(1-p) \\ge 5$。在我们的原假设下，$n p_0 = 80 \\times 0.5 = 40$ 且 $n(1-p_0) = 80 \\times 0.5 = 40$。两个值都远大于 $5$，因此高斯近似是合理的。\n\n    我们通过在原假设 $p_0=0.5$ 下为样本比例 $\\hat{p}$ 构建一个 $95\\%$ 的置信区间（或更准确地说，一个接受域）来检验统计一致性。如果我们观察到的 $\\hat{p}=0.4$ 落在此区域内，我们则认为它是一致的。\n\n    原假设下的标准误为：\n    $$SE_0 = \\sqrt{\\frac{p_0(1-p_0)}{n}} = \\sqrt{\\frac{0.5 \\times (1-0.5)}{80}} = \\sqrt{\\frac{0.25}{80}} = \\sqrt{\\frac{1}{320}}$$\n    $$SE_0 \\approx 0.0559017$$\n\n    对于 $95\\%$ 的置信水平，显著性水平为 $\\alpha = 1 - 0.95 = 0.05$。对于双尾检验，我们使用 z-分数 $z_{\\alpha/2} = z_{0.025}$，它对应于标准正态分布的上 $2.5\\%$ 尾部。其值为 $z_{0.025} \\approx 1.96$。\n\n    $\\hat{p}$ 的 $95\\%$ 接受域由以下公式给出：\n    $$[p_0 - z_{\\alpha/2} \\cdot SE_0, p_0 + z_{\\alpha/2} \\cdot SE_0]$$\n    代入数值：\n    $$[0.5 - 1.96 \\times \\sqrt{\\frac{1}{320}}, 0.5 + 1.96 \\times \\sqrt{\\frac{1}{320}}]$$\n    $$[0.5 - 1.96 \\times 0.0559017, 0.5 + 1.96 \\times 0.0559017]$$\n    $$[0.5 - 0.109567, 0.5 + 0.109567]$$\n    $$[0.390433, 0.609567]$$\n\n    我们将观察到的等位基因平衡 $AB=0.4$ 与此区间进行比较。由于 $0.390433 \\le 0.4 \\le 0.609567$，观察值落在 $95\\%$ 的接受域内。因此，在 $\\alpha=0.05$ 的水平上，观察到的与完美 $0.5$ 平衡的偏差在统计上不显著。此标准得到满足。\n\n    一种等效的方法是计算我们观察值的 z-统计量，并将其与 $\\pm 1.96$ 的临界值进行比较：\n    $$z = \\frac{\\hat{p} - p_0}{SE_0} = \\frac{0.4 - 0.5}{\\sqrt{1/320}} = \\frac{-0.1}{0.0559017} \\approx -1.7888$$\n    由于 $|-1.7888|  1.96$，我们未能拒绝原假设，从而证实了统计一致性。\n\n总之，具有 $DP=80$ 和 $AD=\\{48,32\\}$ 的变异检出成功通过了所有三个指定的 QC 筛选器：\n1.  等位基因平衡 $AB=0.4$ 在 $[0.3, 0.7]$ 区间内。\n2.  变异等位基因计数 $N_{ALT}=32$ 是 $\\ge 10$。\n3.  在 $95\\%$ 的置信水平上，等位基因平衡与杂合基因型的期望值 $0.5$ 统计上一致。\n\n基于这一全面评估，在给定的 QC 启发式方法下，该杂合检出结果被认为是可靠的。最终答案唯一要求的数值是等位基因平衡 $AB$。",
            "answer": "$$\\boxed{0.4000}$$"
        },
        {
            "introduction": "原始的基因组坐标（如染色体、位置、参考和备选碱基）对于临床和科研交流而言是不够直观和标准化的。人类基因组变异协会（Human Genome Variation Society, HGVS）命名法是描述基因变异的黄金标准。本练习旨在将原始的VCF（Variant Call Format）数据转换为标准的HGVS命名，并揭示在存在多个转录本时，同一基因组变异可能导致不同蛋白质水平后果的关键复杂性()。",
            "id": "4616883",
            "problem": "一个实验室使用变异调用格式 (VCF) 在基因组参考联盟人类构建版本 38 (GRCh38) 上鉴定出了一个单核苷酸变异。该变异由标准 VCF 字段指定如下：染色体为 \"chr12\"，位置为 $112{,}036$，参考等位基因为 \"G\"，备选等位基因为 \"A\"。该基因位于正链上，并具有三个经过临床审编的转录本，这些转录本具有不同的编码序列结构。目的是将此 VCF 变异转换为每个转录本登录号的人类基因组变异协会 (HGVS) 编码 DNA (c.) 和蛋白质 (p.) 注释，并在存在多个转录本时量化蛋白质水平上的模糊性。\n\n使用以下科学上可靠且被广泛接受的基础：\n- 分子生物学的中心法则：脱氧核糖核酸 (DNA) 转录为核糖核酸 (RNA)，并通过解释编码 DNA 序列中连续的三联体（密码子）翻译成蛋白质。\n- HGVS 编码 DNA 编号从标准起始密码子 \"ATG\" 的腺嘌呤 (A) 开始，记为 $c.1$，每个编码碱基递增 $1$。编码 DNA 起始位点上游的碱基被索引为负数位置 $c.-n$。蛋白质氨基酸位置从起始蛋氨酸开始计数，记为 $p.1$。\n- 蛋白质变化 $p.XmY$ 表示位置 $m$ 的氨基酸 $X$ 被替换为氨基酸 $Y$。如果一个变异位于编码序列之外，以至于无法推断其对蛋白质的影响，则将蛋白质注释表示为 $p.?$。如果一个密码子改变了其编码的氨基酸，则应用标准遗传密码将三联体映射到氨基酸。\n\n转录本特异性数据（所有位置均为 GRCh38 上的基因组位置；所有转录本均位于正链上）：\n1. 转录本登录号 \"NM\\_000AAA.1\"：在变异位置 $112{,}036$ 之前，该转录本中共有 $66$ 个编码碱基。跨越编码 DNA 位置 $c.67$ 到 $c.69$ 的参考密码子是 \"GAA\"。\n2. 转录本登录号 \"NM\\_000BBB.2\"：在变异位置 $112{,}036$ 之前，该转录本中共有 $63$ 个编码碱基。跨越编码 DNA 位置 $c.64$ 到 $c.66$ 的参考密码子是 \"GAT\"。\n3. 转录本登录号 \"NM\\_000CCC.3\"：该转录本的编码 DNA 起始位置在基因组位置 $112{,}051$。\n\n任务：\n- 对于每个转录本，使用编码 DNA 编号的定义，推导出该变异的 HGVS 编码 DNA (c.) 注释。\n- 对于 \"NM\\_000AAA.1\" 和 \"NM\\_000BBB.2\"，通过确定受影响的密码子位置，并在指定的编码 DNA 位置上应用单核苷酸变化 \"G\" 到 \"A\" 前后的标准遗传密码，来确定 HGVS 蛋白质 (p.) 注释。对于 \"NM\\_000CCC.3\"，根据 HGVS 规则确定适当的 HGVS 蛋白质 (p.) 注释。\n- 最后，计算这三个转录本产生的不同 HGVS 蛋白质水平注释的数量。\n\n将最终答案表示为一个无量纲的整数。不需要四舍五入。",
            "solution": "该问题要求将一个以变异调用格式 (VCF) 指定的单核苷酸变异转换为一个基因的三个不同转录本的人类基因组变异协会 (HGVS) 注释。随后，必须量化不同蛋白质水平后果的数量。\n\n首先，对问题进行验证。\n\n**第 1 步：提取已知信息**\n- **变异数据**：\n  - 参考基因组：基因组参考联盟人类构建版本 38 (GRCh38)\n  - 染色体：\"chr12\"\n  - 基因组位置：$112,036$\n  - 参考等位基因 (REF)：\"G\"\n  - 备选等位基因 (ALT)：\"A\"\n- **基因数据**：\n  - 该基因位于正链上。\n- **HGVS 规则**：\n  - 编码 DNA (c.) 编号：从 'ATG' 起始密码子的 'A' 开始，记为 $c.1$。上游的碱基编号为 $c.-n$。\n  - 蛋白质 (p.) 编号：从起始蛋氨酸开始，记为 $p.1$。\n  - 蛋白质变化注释：$p.XmY$（位置 $m$ 的氨基酸 $X$ 变为氨基酸 $Y$）。\n  - 非编码区影响注释：$p.?$。\n- **转录本特异性数据**：\n  1.  **转录本 \"NM_000AAA.1\"**：\n      - 在位置 $112,036$ 之前的总编码碱基数：$66$。\n      - 从 $c.67$ 到 $c.69$ 的参考密码子：\"GAA\"。\n  2.  **转录本 \"NM_000BBB.2\"**：\n      - 在位置 $112,036$ 之前的总编码碱基数：$63$。\n      - 从 $c.64$ 到 $c.66$ 的参考密码子：\"GAT\"。\n  3.  **转录本 \"NM_000CCC.3\"**：\n      - 编码 DNA 起始 ($c.1$) 基因组位置：$112,051$。\n\n**第 2 步：使用提取的已知信息进行验证**\n该问题具有科学依据，依赖于分子生物学的中心法则以及标准、明确的生物信息学格式 (VCF) 和命名法 (HGVS)。为每个转录本提供的数据（编码碱基计数、起始位点）是充分且内部一致的，允许正式应用 HGVS 规则。任务明确，能够推导出唯一的解。问题提法得当、客观，并且没有任何列出的缺陷。\n\n**结论**：问题有效。\n\n**求解过程**\n\n基因组变异位于 GRCh38 组装上的 `chr12:g.112036GA`。由于该基因位于正链上，参考等位基因为 'G'，备选等位基因为 'A'。我们将逐一分析每个转录本。\n\n**对转录本 1 \"NM_000AAA.1\" 的分析**\n\n*   **HGVS 编码 DNA (c.) 注释**：\n    问题指出，在该转录本中，有 $66$ 个编码碱基位于基因组位置 $112,036$ 之前。根据 HGVS 规则，编号从 $c.1$ 开始，变异位置的碱基是第 $(66+1)$ 个编码碱基。因此，该变异的编码 DNA 位置是 $c.67$。变化是从 'G' 到 'A'。\n    HGVS 编码 DNA 注释为 `NM_000AAA.1:c.67GA`。\n\n*   **HGVS 蛋白质 (p.) 注释**：\n    变异位于编码位置 $c.67$。为找到受影响的氨基酸位置，我们使用公式 $m = \\lceil \\frac{c_{pos}}{3} \\rceil$，其中 $c_{pos}$ 是编码 DNA 位置。\n    $$m = \\left\\lceil \\frac{67}{3} \\right\\rceil = \\lceil 22.333... \\rceil = 23$$\n    该变异影响蛋白质位置 $p.23$ 的氨基酸。\n    $c.67$ 处的变异碱基是跨越位置 $c.67$、$c.68$ 和 $c.69$ 的密码子的第一个碱基。问题提供的参考密码子是 \"GAA\"。替换 $c.67\\text{G}\\text{A}$ 改变了这个密码子。\n    - 参考密码子：GAA\n    - 改变后的密码子：AAA\n    应用标准遗传密码：\n    - GAA 编码谷氨酸 (E)。\n    - AAA 编码赖氨酸 (K)。\n    该变化是位置 $23$ 处的谷氨酸被替换为赖氨酸。\n    HGVS 蛋白质注释为 $p.\\text{Glu}23\\text{Lys}$，或使用单字母代码表示为 $p.\\text{E}23\\text{K}$。\n\n**对转录本 2 \"NM_000BBB.2\" 的分析**\n\n*   **HGVS 编码 DNA (c.) 注释**：\n    在基因组位置 $112,036$ 之前有 $63$ 个编码碱基。因此，变异位置的碱基是第 $(63+1)$ 个编码碱基，即 $c.64$。变化是从 'G' 到 'A'。\n    HGVS 编码 DNA 注释为 `NM_000BBB.2:c.64GA`。\n\n*   **HGVS 蛋白质 (p.) 注释**：\n    变异位于编码位置 $c.64$。受影响的氨基酸位置是：\n    $$m = \\left\\lceil \\frac{64}{3} \\right\\rceil = \\lceil 21.333... \\rceil = 22$$\n    该变异影响蛋白质位置 $p.22$ 的氨基酸。\n    $c.64$ 处的变异碱基是跨越位置 $c.64$、$c.65$ 和 $c.66$ 的密码子的第一个碱基。给定的参考密码子是 \"GAT\"。替换 $c.64\\text{G}\\text{A}$ 改变了这个密码子。\n    - 参考密码子：GAT\n    - 改变后的密码子：AAT\n    应用标准遗传密码：\n    - GAT 编码天冬氨酸 (D)。\n    - AAT 编码天冬酰胺 (N)。\n    该变化是位置 $22$ 处的天冬氨酸被替换为天冬酰胺。\n    HGVS 蛋白质注释为 $p.\\text{Asp}22\\text{Asn}$，或使用单字母代码表示为 $p.\\text{D}22\\text{N}$。\n\n**对转录本 3 \"NM_000CCC.3\" 的分析**\n\n*   **HGVS 编码 DNA (c.) 注释**：\n    变异的基因组位置是 $112,036$。编码 DNA 起始 ($c.1$) 位于基因组位置 $112,051$。该变异位于编码起始位点的上游。距离为：\n    $$112,051 - 112,036 = 15 \\text{ bases}$$\n    根据 HGVS 命名法，起始密码子上游的位置从 $c.1$ 开始负向编号。因此，该变异位于位置 $c.1-15$，记为 $c.-15$。\n    HGVS 编码 DNA 注释为 `NM_000CCC.3:c.-15GA`。\n\n*   **HGVS 蛋白质 (p.) 注释**：\n    该变异位于 $5'$ 非翻译区 (UTR)，在编码序列之外。根据问题的定义和标准的 HGVS 规则，当无法直接确定变异对蛋白质序列的影响时（如非编码变异的情况），使用注释 $p.?$。\n    HGVS 蛋白质注释为 $p.?$。\n\n**最终计算：不同蛋白质注释的数量**\n\n我们已经为这些转录本推导出了以下三个蛋白质水平的注释：\n1.  对于 \"NM_000AAA.1\"：$p.\\text{E}23\\text{K}$（位置 $23$ 的错义变异）\n2.  对于 \"NM_000BBB.2\"：$p.\\text{D}22\\text{N}$（位置 $22$ 的错义变异）\n3.  对于 \"NM_000CCC.3\"：$p.?$（一个蛋白质后果未知的上游变异）\n\n这三个注释，$p.\\text{E}23\\text{K}$、$p.\\text{D}22\\text{N}$ 和 $p.?$，彼此都是不同的。它们代表了在不同位置上的不同类型的后果，或者缺乏可预测的编码变化。\n\n因此，这三个转录本产生的不同 HGVS 蛋白质水平注释的数量是 $3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "预测错义变异的功能影响，往往需要超越简单的氨基酸替换信息。整合蛋白质的三维结构信息，是评估变异潜在危害的一种强大方法。这项高级练习将指导您设计一个量化风险评分模型，该模型结合了变异位点与蛋白质功能残基的空间邻近性，以及氨基酸替换所引起的理化性质变化()。",
            "id": "4616706",
            "problem": "给定一个简化的计算框架，用于通过来自蛋白质数据银行 (PDB) 的三维蛋白质结构，根据错义变体与功能性残基的空间邻近性对其进行注释。任务是设计并实现一个程序，为每个变体生成一个基于公认生物学原理和基本数学构造的无量纲、基于距离的风险评分。\n\n在您的推导中使用的基本基础和假设：\n- 分子生物学中心法则确立了脱氧核糖核酸 (DNA) 中的序列变化可以改变氨基酸序列，从而改变蛋白质的结构和功能。在蛋白质结构中，残基排列在三维空间中，并具有以埃 ($\\text{\\AA}$) 为单位的笛卡尔坐标。\n- 在三维欧几里得空间中，两个残基坐标之间的物理距离是欧几里得范数，对于向量为 $\\mathbf{x}, \\mathbf{y} \\in \\mathbb{R}^3$ 的点定义为 $d(\\mathbf{x}, \\mathbf{y}) = \\lVert \\mathbf{x} - \\mathbf{y} \\rVert_2$，单位为 $\\text{\\AA}$。\n- 功能性残基（例如，活性位点和结合残基）通常介导生化活性，在三维空间中更接近这些残基的变体比远处变体更有可能影响功能。\n- 氨基酸替换的严重性取决于物理化学性质（如电荷、极性、芳香性）的变化，以及甘氨酸和脯氨酸的特殊结构作用。您必须使用基于这些性质的确定性函数，独立于距离来量化替换的严重性。\n\n唯一确定风险函数的必需推导约束：\n- 令 $d \\geq 0$ 表示从变体残基到最近功能性残基的最小欧几里得距离，单位为 $\\text{\\AA}$。\n- 令 $w \\geq 1$ 表示一个替换严重性权重，该权重由参考氨基酸和替换氨基酸之间的物理化学性质变化（电荷、极性、芳香性以及一个甘氨酸/脯氨酸结构指示符）确定性地导出，并遵循以下构建约束：\n  1. 电荷类别取值于 $\\{-1, 0, +1\\}$，分别对应负电荷、中性和正电荷的侧链。极性是二元的，取值于 $\\{0,1\\}$，分别表示非极性和极性。芳香性是二元的，取值于 $\\{0,1\\}$，分别表示非芳香性和芳香性。甘氨酸/脯氨酸指示符是二元的，取值于 $\\{0,1\\}$，如果两种氨基酸中恰好有一个是甘氨酸或脯氨酸，则为 $1$，否则为 $0$。\n  2. 该权重必须是这些性质绝对差值的加和，其中甘氨酸/脯氨酸指示符的贡献是二元性质差异权重的一半。具体而言，规定 $w = 1 + \\Delta_{\\text{charge}} + \\Delta_{\\text{polarity}} + \\Delta_{\\text{aromatic}} + 0.5 \\cdot I_{\\text{G/P}}$，其中每个 $\\Delta$ 是绝对差值，而 $I_{\\text{G/P}} \\in \\{0,1\\}$ 如上定义。\n- 距离效应必须是在 $d$ 上的简单指数衰减，具有一个正的衰减常数 $\\lambda$（单位为 $\\text{\\AA}$），意味着邻近强度按 $\\exp(-d / \\lambda)$ 衰减。\n- 邻近性和替换严重性的组合必须产生一个在 $[0,1)$ 区间内的无量纲分数，该分数对于固定的 $w$ 是关于 $d$ 的单调递减函数，对于固定的 $d$ 是关于 $w$ 的单调递增函数，并且当距离有效无限大或严重性权重有效为零时，该分数必须等于 $0$。对一个与 $w \\cdot \\exp(-d/\\lambda)$ 成比例的强度进行泊松无事件变换，以获得与约束条件一致的唯一无量纲、类似概率的风险。\n\n在这些约束条件下，设计一个程序，为给定的示例蛋白质结构和变体集计算每个变体的基于距离的风险评分。使用以下测试套件以确保覆盖一般情况和边界情况。\n\n蛋白质规格：\n- 残基索引从 $1$ 到 $10$，对于每个有结构覆盖的索引，提供一个三维笛卡尔坐标 $(x,y,z)$，单位为埃 ($\\text{\\AA}$)。\n- 坐标映射如下：\n  - 索引 $1$：$(-3.0, 1.0, 0.0)$\n  - 索引 $2$：$(-1.0, 0.5, 0.0)$\n  - 索引 $3$：$(0.0, 0.0, 0.0)$\n  - 索引 $4$：$(1.0, 0.0, 0.0)$\n  - 索引 $5$：缺失 (无结构覆盖)\n  - 索引 $6$：$(8.0, 0.5, 0.0)$\n  - 索引 $7$：$(10.0, 0.0, 0.0)$\n  - 索引 $8$：$(11.0, 0.0, 0.0)$\n  - 索引 $9$：$(20.0, 0.0, 0.0)$\n  - 索引 $10$：$(30.0, 0.0, 0.0)$\n- 功能性残基集合 $F = \\{3, 7\\}$，假设其坐标如上所述。\n- 按索引排列的参考氨基酸序列：\n  - $1$: $\\text{M}$, $2$: $\\text{R}$, $3$: $\\text{K}$, $4$: $\\text{G}$, $5$: $\\text{L}$, $6$: $\\text{V}$, $7$: $\\text{H}$, $8$: $\\text{S}$, $9$: $\\text{Y}$, $10$: $\\text{W}$。\n\n物理化学性质：\n- 电荷类别映射，取值于 $\\{-1,0,+1\\}$：负电荷 $\\{\\text{D}, \\text{E}\\}$，正电荷 $\\{\\text{K}, \\text{R}, \\text{H}\\}$，所有其他为中性。\n- 极性映射，取值于 $\\{0,1\\}$：极性 $\\{\\text{S}, \\text{T}, \\text{N}, \\text{Q}, \\text{Y}, \\text{C}, \\text{H}, \\text{D}, \\text{E}, \\text{K}, \\text{R}\\}$，所有其他为非极性。\n- 芳香性映射，取值于 $\\{0,1\\}$：芳香性 $\\{\\text{F}, \\text{Y}, \\text{W}, \\text{H}\\}$，所有其他为非芳香性。\n- 用于 $I_{\\text{G/P}}$ 的甘氨酸/脯氨酸集合 $\\{\\text{G}, \\text{P}\\}$。\n\n距离衰减常数：\n- 使用 $\\lambda = 3.0 \\ \\text{\\AA}$。\n\n错义变体测试套件：\n- 案例 $1$：索引 $3$，替换氨基酸 $\\text{E}$。\n- 案例 $2$：索引 $4$，替换氨基酸 $\\text{A}$。\n- 案例 $3$：索引 $10$，替换氨基酸 $\\text{F}$。\n- 案例 $4$：索引 $5$，替换氨基酸 $\\text{P}$ （注意：结构覆盖缺失）。\n- 案例 $5$：索引 $7$，替换氨基酸 $\\text{P}$。\n\n计算要求：\n- 将每个变体映射到其残基索引并确认结构覆盖。如果覆盖缺失，则将与功能性残基的最小距离视为有效无限大，从而使距离驱动的强度为 $0$。\n- 对于有覆盖的残基，计算从变体残基坐标到功能性残基坐标集合的最小欧几里得距离 $d$（单位：$\\text{\\AA}$）。\n- 根据上述可加性质变化规则，精确计算替换严重性权重 $w$。\n- 推导满足约束条件的无量纲风险函数 $r(d, w)$。使用指定的 $\\lambda$ 和基于指数衰减邻近强度的标准泊松无事件变换。\n- 您的程序必须输出单行内容，其中包含五个测试案例的风险评分，以逗号分隔，并按上述顺序列出。每个风险评分必须是四舍五入到六位小数的浮点数。最终输出必须格式化为 Python 列表字面量，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$。",
            "solution": "用户提供的问题已经过严格验证，并被确定为 **有效**。该问题具有科学依据、适定、客观且内部一致。因此，我们可以进行正式的求解。\n\n任务是为蛋白质中的错义变体推导出一个无量纲的、基于距离的风险评分，并将其应用于一组已定义的测试案例。推导过程必须遵循一套特定的物理化学和数学约束。\n\n### 1. 风险评分函数 $r(d, w)$ 的推导\n\n问题要求风险评分 $r$ 依赖于两个量：从变体残基到一组功能性残基的最小欧几里得距离 $d$，以及一个替换严重性权重 $w$。该评分必须构建为“一个与 $w \\cdot \\exp(-d/\\lambda)$ 成比例的强度的泊松无事件变换”。\n\n令泊松过程的强度表示为 $\\mathcal{I}$。问题陈述该强度与严重性权重 $w$ 和一个指数距离衰减项的乘积成正比。\n$$\n\\mathcal{I}(d, w) \\propto w \\cdot \\exp\\left(-\\frac{d}{\\lambda}\\right)\n$$\n此处，$d$ 是以埃 ($\\text{\\AA}$) 为单位的距离，$w$ 是一个无量纲权重，$\\lambda$ 是以 $\\text{\\AA}$ 为单位的距离衰减常数。指数的参数 $-d/\\lambda$ 是无量纲的，符合要求。\n\n问题要求一个“唯一”的函数。这意味着任何任意的比例常数都应被解决。产生唯一函数的最简单、最直接的解释是将无量纲的比例常数设为 $1$。因此，我们将强度定义为：\n$$\n\\mathcal{I}(d, w) = w \\cdot \\exp\\left(-\\frac{d}{\\lambda}\\right)\n$$\n在泊松过程中，给定平均速率（强度）为 $\\mu$ 时，观察到恰好 $k$ 个事件的概率是 $P(X=k) = \\frac{\\mu^k e^{-\\mu}}{k!}$。“无事件”结果（即 $k=0$）的概率是：\n$$\nP(X=0) = \\frac{\\mathcal{I}^0 e^{-\\mathcal{I}}}{0!} = e^{-\\mathcal{I}}\n$$\n风险评分 $r(d, w)$ 被定义为“风险事件”*确实*发生的概率，这是无事件概率的补集。\n$$\nr(d, w) = 1 - P(X=0) = 1 - e^{-\\mathcal{I}(d, w)}\n$$\n代入强度 $\\mathcal{I}(d, w)$ 的表达式，我们得到最终的、唯一的风险评分函数：\n$$\nr(d, w) = 1 - \\exp\\left(-w \\cdot \\exp\\left(-\\frac{d}{\\lambda}\\right)\\right)\n$$\n此函数满足所有规定的约束条件：它是无量纲的，位于 $[0, 1)$ 区间内，对于 $d$ 是单调递减的，对于 $w$ 是单调递增的，并且当 $d \\to \\infty$ 时趋近于 $0$。对于位于没有结构覆盖的残基上的变体，我们被指示将 $d$ 视为有效无限大。在这种情况下，$\\exp(-d/\\lambda) \\to 0$，导致外层指数的参数变为 $0$，从而得到 $r = 1 - e^0 = 1 - 1 = 0$。\n\n### 2. 替换严重性权重 $w$ 的定义\n\n权重 $w$ 是参考（REF）氨基酸和替换（ALT）氨基酸之间物理化学性质变化的确定性函数。这些性质包括电荷、极性、芳香性，以及一个特殊的甘氨酸/脯氨酸结构指示符。\n公式给出如下：\n$$\nw = 1 + \\Delta_{\\text{charge}} + \\Delta_{\\text{polarity}} + \\Delta_{\\text{aromatic}} + 0.5 \\cdot I_{\\text{G/P}}\n$$\n其中：\n- $\\Delta_{\\text{property}} = |\\text{property}_{\\text{REF}} - \\text{property}_{\\text{ALT}}|$。\n- 电荷映射到 $\\{-1, 0, +1\\}$。\n- 极性和芳香性映射到 $\\{0, 1\\}$。\n- $I_{\\text{G/P}}$ 是一个指示变量，如果 REF 或 ALT 氨基酸中恰好有一个是甘氨酸（G）或脯氨酸（P），则为 $1$，否则为 $0$。这是一个逻辑异或（XOR）。\n\n### 3. 在测试套件上的应用\n\n我们现在将这些推导出的函数应用于五个指定的测试案例。\n\n**给定数据：**\n- 功能性残基集合 $F = \\{3, 7\\}$。\n- 坐标：$\\mathbf{c}_3 = (0.0, 0.0, 0.0)$，$\\mathbf{c}_7 = (10.0, 0.0, 0.0)$。\n- 距离衰减常数：$\\lambda = 3.0 \\ \\text{\\AA}$。\n\n**案例 1：索引 $3$ 处的变体, K$\\to$E**\n- **距离 ($d$)**：该变体位于残基 $3$，这是一个功能性位点。坐标为 $\\mathbf{v}_1 = (0.0, 0.0, 0.0)$。到集合 $F$ 的距离为 $d = \\min(\\lVert \\mathbf{v}_1 - \\mathbf{c}_3 \\rVert_2, \\lVert \\mathbf{v}_1 - \\mathbfc_7 \\rVert_2) = \\min(0, 10) = 0 \\ \\text{\\AA}$。\n- **权重 ($w$)**：对于 REF=K, ALT=E。\n  - K：电荷=$+1$，极性=$1$，芳香性=$0$。\n  - E：电荷=$-1$，极性=$1$，芳香性=$0$。\n  - $\\Delta_{\\text{charge}}=|1 - (-1)|=2$。$\\Delta_{\\text{polarity}}=|1-1|=0$。$\\Delta_{\\text{aromatic}}=|0-0|=0$。$I_{\\text{G/P}}=0$。\n  - $w = 1 + 2 + 0 + 0 + 0.5 \\cdot 0 = 3.0$。\n- **风险 ($r$)**：$r(0, 3.0) = 1 - \\exp(-3.0 \\cdot \\exp(-0/3.0)) = 1 - \\exp(-3.0 \\cdot 1) = 1 - e^{-3.0} \\approx 0.950213$。\n\n**案例 2：索引 $4$ 处的变体, G$\\to$A**\n- **距离 ($d$)**：该变体位于残基 $4$，坐标为 $\\mathbf{v}_2 = (1.0, 0.0, 0.0)$。\n  - $d = \\min(\\lVert (1,0,0) - (0,0,0) \\rVert_2, \\lVert (1,0,0) - (10,0,0) \\rVert_2) = \\min(1, 9) = 1.0 \\ \\text{\\AA}$。\n- **权重 ($w$)**：对于 REF=G, ALT=A。\n  - G：电荷=$0$，极性=$0$，芳香性=$0$，是 G/P。\n  - A：电荷=$0$，极性=$0$，芳香性=$0$，不是 G/P。\n  - 所有 $\\Delta$ 项均为 $0$。$I_{\\text{G/P}}=1$，因为恰好有一个是 G/P 氨基酸。\n  - $w = 1 + 0 + 0 + 0 + 0.5 \\cdot 1 = 1.5$。\n- **风险 ($r$)**：$r(1.0, 1.5) = 1 - \\exp(-1.5 \\cdot \\exp(-1.0/3.0)) \\approx 1 - \\exp(-1.5 \\cdot 0.71653) \\approx 1 - \\exp(-1.0748) \\approx 0.658620$。\n\n**案例 3：索引 $10$ 处的变体, W$\\to$F**\n- **距离 ($d$)**：该变体位于残基 $10$，坐标为 $\\mathbf{v}_3 = (30.0, 0.0, 0.0)$。\n  - $d = \\min(\\lVert (30,0,0) - (0,0,0) \\rVert_2, \\lVert (30,0,0) - (10,0,0) \\rVert_2) = \\min(30, 20) = 20.0 \\ \\text{\\AA}$。\n- **权重 ($w$)**：对于 REF=W, ALT=F。\n  - W：电荷=$0$，极性=$0$，芳香性=$1$。\n  - F：电荷=$0$，极性=$0$，芳香性=$1$。\n  - 所有性质差异均为 $0$。$I_{\\text{G/P}}=0$。\n  - $w = 1 + 0 + 0 + 0 + 0.5 \\cdot 0 = 1.0$。\n- **风险 ($r$)**：$r(20.0, 1.0) = 1 - \\exp(-1.0 \\cdot \\exp(-20.0/3.0)) \\approx 1 - \\exp(-\\exp(-6.66\\bar{6})) \\approx 1 - \\exp(-0.001272) \\approx 0.001271$。\n\n**案例 4：索引 $5$ 处的变体, L$\\to$P**\n- **距离 ($d$)**：残基 $5$ 没有结构覆盖。根据问题说明，距离 $d$ 被视为有效无限大。\n- **权重 ($w$)**：权重的计算被距离所抢占。\n- **风险 ($r$)**：对于 $d \\to \\infty$，风险评分为 $r = 0.0$。\n\n**案例 5：索引 $7$ 处的变体, H$\\to$P**\n- **距离 ($d$)**：该变体位于残基 $7$，一个功能性位点。坐标为 $\\mathbf{v}_5 = (10.0, 0.0, 0.0)$。\n  - $d = \\min(\\lVert (10,0,0) - (0,0,0) \\rVert_2, \\lVert (10,0,0) - (10,0,0) \\rVert_2) = \\min(10, 0) = 0 \\ \\text{\\AA}$。\n- **权重 ($w$)**：对于 REF=H, ALT=P。\n  - H：电荷=$+1$，极性=$1$，芳香性=$1$，不是 G/P。\n  - P：电荷=$0$，极性=$0$，芳香性=$0$，是 G/P。\n  - $\\Delta_{\\text{charge}}=|1-0|=1$。$\\Delta_{\\text{polarity}}=|1-0|=1$。$\\Delta_{\\text{aromatic}}=|1-0|=1$。$I_{\\text{G/P}}=1$。\n  - $w = 1 + 1 + 1 + 1 + 0.5 \\cdot 1 = 4.5$。\n- **风险 ($r$)**：$r(0, 4.5) = 1 - \\exp(-4.5 \\cdot \\exp(-0/3.0)) = 1 - \\exp(-4.5 \\cdot 1) = 1 - e^{-4.5} \\approx 0.988891$。\n\n**计算得分摘要：**\n- 案例 1：$0.950213$\n- 案例 2：$0.658620$\n- 案例 3：$0.001271$\n- 案例 4：$0.000000$\n- 案例 5：$0.988891$\n这些值将由程序计算并按要求格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the variant risk scoring problem by deriving and applying a\n    distance- and severity-based risk function.\n    \"\"\"\n    \n    # 1. Define all givens from the problem statement.\n    \n    # Physicochemical property mappings for all 20 standard amino acids.\n    # Charge: -1 (negative), 0 (neutral), +1 (positive)\n    CHARGE_MAP = {aa: 0 for aa in \"ACFGILMNPQSTVWY\"}\n    CHARGE_MAP.update({aa: -1 for aa in \"DE\"})\n    CHARGE_MAP.update({aa: 1 for aa in \"HKR\"})\n\n    # Polarity: 0 (nonpolar), 1 (polar)\n    POLARITY_MAP = {aa: 0 for aa in \"AFGILMPVW\"}\n    POLARITY_MAP.update({aa: 1 for aa in \"CDEHKNQRSTY\"})\n\n    # Aromaticity: 0 (non-aromatic), 1 (aromatic)\n    AROMATICITY_MAP = {aa: 0 for aa in \"ACDEGILKMNPQRSTV\"}\n    AROMATICITY_MAP.update({aa: 1 for aa in \"FHWY\"})\n\n    # Set of amino acids with special structural roles (Glycine/Proline)\n    GP_SET = {'G', 'P'}\n\n    # Protein structural and sequence data\n    COORDS = {\n        1: np.array([-3.0, 1.0, 0.0]),\n        2: np.array([-1.0, 0.5, 0.0]),\n        3: np.array([0.0, 0.0, 0.0]),\n        4: np.array([1.0, 0.0, 0.0]),\n        # Index 5 is missing\n        6: np.array([8.0, 0.5, 0.0]),\n        7: np.array([10.0, 0.0, 0.0]),\n        8: np.array([11.0, 0.0, 0.0]),\n        9: np.array([20.0, 0.0, 0.0]),\n        10: np.array([30.0, 0.0, 0.0]),\n    }\n    \n    REF_SEQ = {\n        1: 'M', 2: 'R', 3: 'K', 4: 'G', 5: 'L',\n        6: 'V', 7: 'H', 8: 'S', 9: 'Y', 10: 'W'\n    }\n    \n    FUNCTIONAL_RESIDUES_INDICES = {3, 7}\n    FUNCTIONAL_COORDS = [COORDS[i] for i in FUNCTIONAL_RESIDUES_INDICES]\n\n    # Distance decay constant\n    LAMBDA = 3.0\n\n    # Test suite of missense variants\n    test_cases = [\n        {'index': 3, 'alt': 'E'},\n        {'index': 4, 'alt': 'A'},\n        {'index': 10, 'alt': 'F'},\n        {'index': 5, 'alt': 'P'},\n        {'index': 7, 'alt': 'P'},\n    ]\n\n    results = []\n\n    # 2. Process each test case.\n    for case in test_cases:\n        variant_index = case['index']\n        alt_aa = case['alt']\n\n        # Handle variants in residues with no structural coverage\n        if variant_index not in COORDS:\n            # Per problem, distance is effectively infinite, risk is 0.\n            results.append(0.0)\n            continue\n        \n        # A. Calculate minimal Euclidean distance 'd'\n        variant_coord = COORDS[variant_index]\n        min_dist = min([np.linalg.norm(variant_coord - fc) for fc in FUNCTIONAL_COORDS])\n        \n        # B. Calculate substitution severity weight 'w'\n        ref_aa = REF_SEQ[variant_index]\n        \n        delta_charge = abs(CHARGE_MAP[ref_aa] - CHARGE_MAP[alt_aa])\n        delta_polarity = abs(POLARITY_MAP[ref_aa] - POLARITY_MAP[alt_aa])\n        delta_aromaticity = abs(AROMATICITY_MAP[ref_aa] - AROMATICITY_MAP[alt_aa])\n        \n        # I_GP is 1 if exactly one is G or P, 0 otherwise (XOR)\n        i_gp = int((ref_aa in GP_SET) ^ (alt_aa in GP_SET))\n        \n        w = 1 + delta_charge + delta_polarity + delta_aromaticity + 0.5 * i_gp\n\n        # C. Calculate the risk score 'r(d, w)'\n        # r(d, w) = 1 - exp(-w * exp(-d / lambda))\n        intensity = w * np.exp(-min_dist / LAMBDA)\n        risk_score = 1 - np.exp(-intensity)\n        \n        results.append(risk_score)\n\n    # 3. Format and print the final output.\n    # The output must be a single line, formatted as a Python list literal,\n    -    # with each score rounded to six decimal places.\n    formatted_results = [f\"{score:.6f}\" for score in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}