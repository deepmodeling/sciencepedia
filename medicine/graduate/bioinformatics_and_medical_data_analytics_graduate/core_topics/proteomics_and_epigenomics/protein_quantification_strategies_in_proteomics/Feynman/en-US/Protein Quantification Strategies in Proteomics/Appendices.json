{
    "hands_on_practices": [
        {
            "introduction": "A pervasive challenge in label-free proteomics is the presence of missing intensity values, particularly for low-abundance peptides that fall below the instrument's limit of detection. These values are not missing at random but are 'left-censored,' a crucial distinction for accurate statistical modeling. This practice guides you through a principled method for data imputation by modeling log-intensities as a Gaussian distribution and calculating the expected value for a missing measurement, conditional on it being below the detection limit . Mastering this technique is vital for preventing biased downstream analyses and rescuing valuable information from incomplete data.",
            "id": "4601128",
            "problem": "In label-free shotgun proteomics using Liquid Chromatography–Mass Spectrometry (LC–MS), replicate peptide intensities on the logarithm base two scale are often modeled as realizations from a Gaussian distribution due to approximate homoscedasticity at the log scale. Consider a peptide with three observed replicate log-intensities $\\{18.0, 18.5, 17.8\\}$ and two additional replicate measurements missing due to a detection limit at $17.5$ (left-censoring). Assume replicate log-intensities are independent and identically distributed as $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$. Under a left-censored Gaussian imputation strategy that imputes each missing value by the conditional expectation $E[X \\mid X \\leq L]$, where $L$ is the detection limit, proceed as follows:\n\n- Estimate $\\mu$ and $\\sigma$ from the observed values only using the maximum likelihood estimators under the Gaussian model.\n- Starting from the definition of the Gaussian probability density function and the definition of conditional expectation, derive an analytic expression for $E[X \\mid X \\leq L]$ in terms of $\\mu$, $\\sigma$, $L$, the standard normal probability density function $\\varphi(\\cdot)$, and the standard normal cumulative distribution function $\\Phi(\\cdot)$.\n- Evaluate this expression numerically at the estimated $\\mu$ and $\\sigma$ and $L=17.5$ to obtain the single imputation value to be used for each missing replicate.\n\nReport the numeric value to be used to impute each missing replicate. Round your answer to four significant figures. Express the result in log base two intensity units.",
            "solution": "The problem requires the calculation of an imputation value for missing data in a proteomics experiment. The imputation is based on the conditional expectation of a left-censored Gaussian random variable. The solution proceeds in three steps as requested: first, estimating the parameters of the Gaussian distribution from the observed data; second, deriving an analytical expression for the conditional expectation; and third, numerically evaluating this expression.\n\n### Step 1: Parameter Estimation\n\nThe observed log-intensities are a set of $n=3$ measurements: $x_{obs} = \\{18.0, 18.5, 17.8\\}$. We are instructed to estimate the mean $\\mu$ and standard deviation $\\sigma$ of the underlying Gaussian distribution $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ using only these observed values. The maximum likelihood estimators (MLEs) for the parameters of a Gaussian distribution based on a sample $\\{x_1, x_2, \\dots, x_n\\}$ are the sample mean and the sample standard deviation (with a denominator of $n$).\n\nThe MLE for the mean, $\\hat{\\mu}$, is the sample mean:\n$$\n\\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^{n} x_i\n$$\nSubstituting the given values:\n$$\n\\hat{\\mu} = \\frac{18.0 + 18.5 + 17.8}{3} = \\frac{54.3}{3} = 18.1\n$$\n\nThe MLE for the variance, $\\hat{\\sigma}^2$, is given by:\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n} \\sum_{i=1}^{n} (x_i - \\hat{\\mu})^2\n$$\nSubstituting the data and the estimated mean:\n$$\n\\hat{\\sigma}^2 = \\frac{1}{3} \\left[ (18.0 - 18.1)^2 + (18.5 - 18.1)^2 + (17.8 - 18.1)^2 \\right]\n$$\n$$\n\\hat{\\sigma}^2 = \\frac{1}{3} \\left[ (-0.1)^2 + (0.4)^2 + (-0.3)^2 \\right]\n$$\n$$\n\\hat{\\sigma}^2 = \\frac{1}{3} \\left[ 0.01 + 0.16 + 0.09 \\right] = \\frac{0.26}{3}\n$$\nThe MLE for the standard deviation, $\\hat{\\sigma}$, is the square root of the variance:\n$$\n\\hat{\\sigma} = \\sqrt{\\frac{0.26}{3}}\n$$\n\n### Step 2: Derivation of the Conditional Expectation\n\nWe need to derive an analytic expression for $E[X \\mid X \\leq L]$, where $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ and $L$ is the left-censoring threshold. Let $f(x)$ and $F(x)$ be the probability density function (PDF) and cumulative distribution function (CDF) of $X$, respectively.\n\nBy definition, the conditional expectation is:\n$$\nE[X \\mid X \\leq L] = \\frac{\\int_{-\\infty}^{L} x f(x) \\,dx}{P(X \\leq L)}\n$$\nThe PDF of $X$ is $f(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$. The denominator is $P(X \\leq L) = F(L)$. We can standardize this probability. Let $Z = \\frac{X-\\mu}{\\sigma}$ be a standard normal random variable, $Z \\sim \\mathcal{N}(0, 1)$.\n$$\nP(X \\leq L) = P\\left(\\frac{X-\\mu}{\\sigma} \\leq \\frac{L-\\mu}{\\sigma}\\right) = P\\left(Z \\leq \\frac{L-\\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right)\n$$\nwhere $\\Phi(\\cdot)$ is the CDF of the standard normal distribution.\n\nNow, we evaluate the integral in the numerator. We use the same change of variable, $z = \\frac{x-\\mu}{\\sigma}$, which implies $x = \\mu + \\sigma z$ and $dx = \\sigma \\,dz$. The upper limit of integration for $z$ becomes $\\frac{L-\\mu}{\\sigma}$.\n$$\n\\int_{-\\infty}^{L} x f(x) \\,dx = \\int_{-\\infty}^{(L-\\mu)/\\sigma} (\\mu + \\sigma z) \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) (\\sigma \\,dz)\n$$\nLet $\\varphi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right)$ be the PDF of the standard normal distribution. The integral simplifies to:\n$$\n\\int_{-\\infty}^{(L-\\mu)/\\sigma} (\\mu + \\sigma z) \\varphi(z) \\,dz = \\mu \\int_{-\\infty}^{(L-\\mu)/\\sigma} \\varphi(z) \\,dz + \\sigma \\int_{-\\infty}^{(L-\\mu)/\\sigma} z \\varphi(z) \\,dz\n$$\nThe first term is $\\mu \\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right)$. For the second term, we find the antiderivative of $z\\varphi(z)$:\n$$\n\\int z \\varphi(z) \\,dz = \\int z \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) \\,dz\n$$\nUsing the substitution $u = -z^2/2$, we have $du = -z \\,dz$. This gives:\n$$\n-\\int \\frac{1}{\\sqrt{2\\pi}} \\exp(u) \\,du = -\\frac{1}{\\sqrt{2\\pi}} \\exp(u) = -\\varphi(z)\n$$\nTherefore, the definite integral is:\n$$\n\\sigma \\int_{-\\infty}^{(L-\\mu)/\\sigma} z \\varphi(z) \\,dz = \\sigma \\left[ -\\varphi(z) \\right]_{-\\infty}^{(L-\\mu)/\\sigma} = \\sigma \\left( -\\varphi\\left(\\frac{L-\\mu}{\\sigma}\\right) - \\lim_{z \\to -\\infty} (-\\varphi(z)) \\right)\n$$\nSince $\\lim_{z \\to -\\infty} \\varphi(z) = 0$, this term becomes $-\\sigma\\varphi\\left(\\frac{L-\\mu}{\\sigma}\\right)$.\n\nCombining the two parts of the numerator:\n$$\n\\int_{-\\infty}^{L} x f(x) \\,dx = \\mu \\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right) - \\sigma \\varphi\\left(\\frac{L-\\mu}{\\sigma}\\right)\n$$\nFinally, dividing by the denominator $P(X \\leq L) = \\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right)$:\n$$\nE[X \\mid X \\leq L] = \\frac{\\mu \\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right) - \\sigma \\varphi\\left(\\frac{L-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right)} = \\mu - \\sigma \\frac{\\varphi\\left(\\frac{L-\\mu}{\\sigma}\\right)}{\\Phi\\left(\\frac{L-\\mu}{\\sigma}\\right)}\n$$\nThis is the desired analytic expression for the single imputation value.\n\n### Step 3: Numerical Evaluation\n\nWe now substitute the estimated parameters and the given detection limit into the derived formula.\nThe parameters are $\\hat{\\mu} = 18.1$ and $\\hat{\\sigma} = \\sqrt{0.26/3}$. The detection limit is $L = 17.5$.\n\nFirst, calculate the standardized Z-score for the detection limit:\n$$\n\\alpha = \\frac{L - \\hat{\\mu}}{\\hat{\\sigma}} = \\frac{17.5 - 18.1}{\\sqrt{0.26/3}} = \\frac{-0.6}{\\sqrt{0.08666...}} \\approx \\frac{-0.6}{0.294392} \\approx -2.03810\n$$\nNext, we evaluate the standard normal PDF $\\varphi(\\alpha)$ and CDF $\\Phi(\\alpha)$ at this value:\n$$\n\\varphi(-2.03810) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(-2.03810)^2}{2}\\right) \\approx 0.049995\n$$\n$$\n\\Phi(-2.03810) = \\int_{-\\infty}^{-2.03810} \\varphi(z) \\,dz \\approx 0.020782\n$$\nNow, compute the inverse Mills ratio term:\n$$\n\\frac{\\varphi(\\alpha)}{\\Phi(\\alpha)} \\approx \\frac{0.049995}{0.020782} \\approx 2.40566\n$$\nFinally, calculate the imputed value using the derived expression:\n$$\nE[X \\mid X \\leq L] \\approx \\hat{\\mu} - \\hat{\\sigma} \\left( \\frac{\\varphi(\\alpha)}{\\Phi(\\alpha)} \\right)\n$$\n$$\nE[X \\mid X \\leq L] \\approx 18.1 - \\left(\\sqrt{\\frac{0.26}{3}}\\right) \\times (2.40566)\n$$\n$$\nE[X \\mid X \\leq L] \\approx 18.1 - (0.294392) \\times (2.40566) \\approx 18.1 - 0.70823\n$$\n$$\nE[X \\mid X \\leq L] \\approx 17.39177\n$$\nThe problem requires the answer to be rounded to four significant figures. The four significant figures are $1$, $7$, $3$, and $9$. The fifth digit is $1$, so we round down.\n\nThe numeric value to be used to impute each missing replicate is $17.39$.",
            "answer": "$$\n\\boxed{17.39}\n$$"
        },
        {
            "introduction": "Once peptide-level intensities have been obtained and pre-processed, the next critical step is to infer the abundance of their parent proteins. This is not a simple summation, as different peptides from the same protein can yield vastly different signal intensities. This exercise explores two widely-used strategies for this inference: the robust Top3 method, which relies on the most intense and reliably measured peptides, and the iBAQ method, which attempts to normalize for the number of observable peptides . By calculating and comparing these estimators, you will gain insight into how different quantification assumptions can influence protein-level conclusions.",
            "id": "4601115",
            "problem": "A label-free, bottom-up Liquid Chromatography–Mass Spectrometry (LC–MS) experiment quantifies proteins by integrating first-stage mass spectrometry (MS1) peptide signals that are proportional to the underlying protein amount under the following assumptions: complete digestion into proteotypic peptides, linear detector response, negligible shared peptides, and peptide response factors approximately constant for peptides from the same protein after appropriate normalization. Under these conditions, peptide MS1 intensity is proportional to protein molar amount, and additive across proteotypic peptides.\n\nTwo widely used estimators in proteomics are the Top3 method, which uses the three most intense proteotypic peptides to approximate protein abundance, and Intensity-Based Absolute Quantification (iBAQ), which normalizes the summed peptide intensities by the number of theoretically observable proteotypic peptides for the protein. Consider a protein for which the measured proteotypic peptide MS1 intensities are $[\\,2.1 \\times 10^{6},\\,1.9 \\times 10^{6},\\,1.5 \\times 10^{6},\\,0.9 \\times 10^{6}\\,]$, and for which the number of theoretically observable peptides is $8$.\n\nUsing only the foundational proportionality and additivity assumptions stated above, derive how the Top3 and iBAQ estimators relate to the peptide intensities, compute each estimator for this protein, and then compute the ratio of the Top3 estimate to the iBAQ estimate. Express the final ratio as a unitless real number and round your answer to four significant figures.",
            "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- **Experiment Type:** Label-free, bottom-up Liquid Chromatography–Mass Spectrometry (LC–MS).\n- **Quantification Principle:** Protein amount is quantified by integrating first-stage mass spectrometry (MS1) peptide signals.\n- **Assumptions:**\n    1.  MS1 peptide signal is proportional to the underlying protein amount.\n    2.  Complete digestion into proteotypic peptides.\n    3.  Linear detector response.\n    4.  Negligible shared peptides.\n    5.  Peptide response factors are approximately constant for peptides from the same protein after appropriate normalization.\n    6.  Peptide MS1 intensity is proportional to protein molar amount.\n    7.  Peptide MS1 intensity is additive across proteotypic peptides.\n- **Estimator Definitions:**\n    1.  **Top3 method:** Uses the three most intense proteotypic peptides to approximate protein abundance.\n    2.  **Intensity-Based Absolute Quantification (iBAQ):** Normalizes the summed peptide intensities by the number of theoretically observable proteotypic peptides for the protein.\n- **Data for a specific protein:**\n    - Measured proteotypic peptide MS1 intensities: $[\\,2.1 \\times 10^{6},\\,1.9 \\times 10^{6},\\,1.5 \\times 10^{6},\\,0.9 \\times 10^{6}\\,]$.\n    - Number of theoretically observable peptides: $8$.\n- **Task:**\n    1.  Derive how Top3 and iBAQ estimators relate to peptide intensities.\n    2.  Compute each estimator.\n    3.  Compute the ratio of the Top3 estimate to the iBAQ estimate.\n    4.  Provide the ratio as a real number rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly grounded in the principles of quantitative proteomics. LC-MS, Top3, and iBAQ are standard, well-established methods. The assumptions listed are idealized but common starting points for modeling protein quantification.\n- **Well-Posed:** The problem provides all necessary data and definitions to calculate the requested quantities. The definitions for the Top3 and iBAQ estimators are stated clearly, and the data required for their calculation are provided. A unique numerical solution exists.\n- **Objective:** The problem is stated in precise, objective, and technical language, free of any subjectivity or bias.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, self-contained, and well-posed. A solution will be derived.\n\n### Solution Derivation\n\nThe problem requires the calculation of two estimators for protein abundance, Top3 and iBAQ, and their subsequent ratio. Let the set of measured peptide intensities for the protein be denoted by $I$. The given intensities are:\n$$\nI = \\{2.1 \\times 10^{6}, 1.9 \\times 10^{6}, 1.5 \\times 10^{6}, 0.9 \\times 10^{6}\\}\n$$\nLet $N_{obs}$ be the number of theoretically observable peptides, which is given as $N_{obs} = 8$.\n\n**1. Top3 Estimator ($E_{Top3}$)**\n\nThe Top3 method uses the three most intense proteotypic peptides. Based on the additivity assumption, this estimator is the sum of the intensities of these three peptides. First, we identify the three highest intensities from the set $I$. By inspection, these are $2.1 \\times 10^{6}$, $1.9 \\times 10^{6}$, and $1.5 \\times 10^{6}$.\n\nThe Top3 estimator, $E_{Top3}$, is therefore the sum of these values:\n$$\nE_{Top3} = (2.1 \\times 10^{6}) + (1.9 \\times 10^{6}) + (1.5 \\times 10^{6})\n$$\n$$\nE_{Top3} = (2.1 + 1.9 + 1.5) \\times 10^{6}\n$$\n$$\nE_{Top3} = 5.5 \\times 10^{6}\n$$\n\n**2. Intensity-Based Absolute Quantification (iBAQ) Estimator ($E_{iBAQ}$)**\n\nThe iBAQ method, as defined in the problem, normalizes the summed peptide intensities by the number of theoretically observable proteotypic peptides. This means we sum all measured intensities and divide by $N_{obs}$.\n\nFirst, we calculate the sum of all measured intensities, $\\sum I_i$:\n$$\n\\sum I_i = (2.1 \\times 10^{6}) + (1.9 \\times 10^{6}) + (1.5 \\times 10^{6}) + (0.9 \\times 10^{6})\n$$\n$$\n\\sum I_i = (2.1 + 1.9 + 1.5 + 0.9) \\times 10^{6}\n$$\n$$\n\\sum I_i = 6.4 \\times 10^{6}\n$$\n\nThe iBAQ estimator, $E_{iBAQ}$, is this sum divided by $N_{obs}$:\n$$\nE_{iBAQ} = \\frac{\\sum I_i}{N_{obs}} = \\frac{6.4 \\times 10^{6}}{8}\n$$\n$$\nE_{iBAQ} = 0.8 \\times 10^{6}\n$$\n\n**3. Ratio of the Estimators**\n\nThe final step is to compute the ratio, $R$, of the Top3 estimate to the iBAQ estimate.\n$$\nR = \\frac{E_{Top3}}{E_{iBAQ}} = \\frac{5.5 \\times 10^{6}}{0.8 \\times 10^{6}}\n$$\nThe factor of $10^{6}$ cancels out:\n$$\nR = \\frac{5.5}{0.8}\n$$\n$$\nR = 6.875\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value, $6.875$, already has exactly four significant figures. Therefore, no further rounding is necessary.",
            "answer": "$$\n\\boxed{6.875}\n$$"
        },
        {
            "introduction": "A typical proteomics experiment compares protein levels across conditions, resulting in thousands of statistical tests and a corresponding list of $p$-values. If we use a classical significance threshold like $p  0.05$ for each test, a large number of false positives are expected by pure chance. This practice introduces the essential statistical concept of the False Discovery Rate (FDR) and walks through the application of the Benjamini-Hochberg procedure . This method provides a powerful and standard way to correct for multiple comparisons, allowing you to generate a statistically sound list of differentially abundant proteins.",
            "id": "4601070",
            "problem": "In label-free quantitative proteomics using mass spectrometry (MS), protein-level differential abundance analyses across biological conditions produce a list of hypotheses with corresponding $p$-values. To control the expected proportion of false discoveries among rejected hypotheses, one uses the false discovery rate (FDR). Consider five proteins whose statistical tests yield the following set of $p$-values: $\\{0.001, 0.02, 0.04, 0.15, 0.5\\}$. Starting from the foundational definition that, under the null hypothesis, $p$-values are stochastically uniform on $[0,1]$ and the false discovery rate is the expected value of the ratio of false rejections to total rejections, derive the adjusted $q$-values according to the Benjamini–Hochberg (BH) procedure and determine which hypotheses would be called discoveries at an FDR level $\\alpha = 0.05$ in the context of controlling errors across protein quantification tests. Report only the total number of discoveries at FDR level $0.05$. No rounding is required for the final reported quantity.",
            "solution": "The user has provided a problem statement that requires validation.\n\n### Step 1: Extract Givens\n-   **Topic**: Label-free quantitative proteomics, false discovery rate (FDR) control.\n-   **Data**: A set of five $p$-values from statistical tests on five proteins: $\\{0.001, 0.02, 0.04, 0.15, 0.5\\}$.\n-   **Method**: The Benjamini–Hochberg (BH) procedure is to be used.\n-   **FDR Level**: $\\alpha = 0.05$.\n-   **Task**:\n    1.  Derive the adjusted $q$-values according to the BH procedure.\n    2.  Determine which hypotheses are discoveries at the specified FDR level.\n    3.  Report the total number of discoveries.\n-   **Theoretical Premise**: Under the null hypothesis, $p$-values are stochastically uniform on the interval $[0,1]$.\n-   **Definition**: The false discovery rate (FDR) is the expected value of the ratio of false rejections to total rejections.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is well-grounded in statistics and its application to bioinformatics, specifically proteomics. The use of $p$-values, FDR, and the Benjamini-Hochberg procedure are standard and fundamental concepts for multiple hypothesis testing correction. The premise of uniformly distributed $p$-values under the null hypothesis is a cornerstone of these statistical methods. The problem is scientifically sound.\n2.  **Well-Posed**: The problem is well-posed. It provides a specific dataset (the $p$-values), a clearly defined algorithm (Benjamini-Hochberg), and a specific significance threshold ($\\alpha$). The question asks for a determinate integer value (the number of discoveries), which can be uniquely calculated from the given information.\n3.  **Objective**: The problem is stated in precise, objective, and quantitative terms. There is no ambiguity or subjective language.\n4.  **Completeness and Consistency**: The problem is self-contained and provides all necessary information to arrive at a solution. The number of tests, the $p$-values, and the desired FDR control level are all explicitly stated.\n5.  **Plausibility**: The scenario and the given $p$-values are realistic for a small-scale proteomics experiment.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is scientifically sound, well-posed, objective, and complete. A rigorous and unique solution can be derived. Proceeding to the solution.\n\nThe problem requires the application of the Benjamini–Hochberg (BH) procedure to control the false discovery rate (FDR) for a set of $p$-values from multiple hypothesis tests.\n\nThe total number of hypotheses (proteins) being tested is $m=5$. The set of observed $p$-values is $P = \\{0.001, 0.02, 0.04, 0.15, 0.5\\}$. The desired FDR control level is $\\alpha = 0.05$.\n\nThe BH procedure consists of the following steps:\n1.  Order the $m$ $p$-values from smallest to largest: $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$.\n2.  Find the largest rank $k$ such that its corresponding $p$-value, $p_{(k)}$, satisfies the condition $p_{(k)} \\le \\frac{k}{m} \\alpha$.\n3.  Reject all null hypotheses $H_{(i)}$ for $i=1, \\dots, k$. The number of discoveries is $k$.\n\nLet's apply this procedure.\nFirst, we sort the given $p$-values in ascending order and assign their ranks, from $i=1$ to $m=5$:\n-   $p_{(1)} = 0.001$\n-   $p_{(2)} = 0.02$\n-   $p_{(3)} = 0.04$\n-   $p_{(4)} = 0.15$\n-   $p_{(5)} = 0.5$\n\nNext, for each rank $i$, we calculate the BH threshold, $\\frac{i}{m} \\alpha$, and check if $p_{(i)}$ is less than or equal to this threshold. Here, $m=5$ and $\\alpha=0.05$, so the threshold is $\\frac{i}{5}(0.05) = i \\times 0.01$.\n\n-   For $i=1$: Threshold is $1 \\times 0.01 = 0.01$. We check if $p_{(1)} \\le 0.01$. Since $0.001 \\le 0.01$, the condition holds.\n-   For $i=2$: Threshold is $2 \\times 0.01 = 0.02$. We check if $p_{(2)} \\le 0.02$. Since $0.02 \\le 0.02$, the condition holds.\n-   For $i=3$: Threshold is $3 \\times 0.01 = 0.03$. We check if $p_{(3)} \\le 0.03$. Since $0.04  0.03$, the condition fails.\n-   For $i=4$: Threshold is $4 \\times 0.01 = 0.04$. Since we have already found a rank for which the condition fails, and the $p$-values are increasing, subsequent tests will also fail. However, for completeness: $0.15  0.04$, so the condition fails.\n-   For $i=5$: Threshold is $5 \\times 0.01 = 0.05$. We check if $p_{(5)} \\le 0.05$. Since $0.5  0.05$, the condition fails.\n\nThe largest rank $k$ for which the condition $p_{(k)} \\le \\frac{k}{m} \\alpha$ is met is $k=2$. According to the BH procedure, we reject the null hypotheses corresponding to the $p$-values $p_{(1)}$ and $p_{(2)}$. Therefore, the number of discoveries is $2$.\n\nThe problem also asks to derive the adjusted $p$-values, known as $q$-values. The $q$-value for the $i$-th ordered $p$-value is defined as:\n$$q_{(i)} = \\min_{j=i, \\dots, m} \\left( \\frac{m}{j} p_{(j)} \\right)$$\nThis definition ensures that the resulting $q$-values are monotonically non-decreasing, i.e., $q_{(1)} \\le q_{(2)} \\le \\dots \\le q_{(m)}$. A more direct way to calculate them is to first compute the raw value $p'_{(i)} = \\frac{m}{i} p_{(i)}$ for each $i$, and then enforce monotonicity by setting $q_{(i)} = p'_{(i)}$ for $i=m$ and $q_{(i)} = \\min(p'_{(i)}, q_{(i+1)})$ for $i = m-1, \\dots, 1$.\n\nLet's compute the raw values $\\frac{m}{i}p_{(i)}$:\n-   For $i=1$: $\\frac{5}{1} p_{(1)} = 5 \\times 0.001 = 0.005$\n-   For $i=2$: $\\frac{5}{2} p_{(2)} = 2.5 \\times 0.02 = 0.05$\n-   For $i=3$: $\\frac{5}{3} p_{(3)} = \\frac{5}{3} \\times 0.04 = \\frac{0.2}{3} \\approx 0.0667$\n-   For $i=4$: $\\frac{5}{4} p_{(4)} = 1.25 \\times 0.15 = 0.1875$\n-   For $i=5$: $\\frac{5}{5} p_{(5)} = 1 \\times 0.5 = 0.5$\n\nNow we enforce monotonicity to obtain the final $q$-values, starting from $i=5$ and moving backward to $i=1$:\n-   $q_{(5)} = \\frac{5}{5} p_{(5)} = 0.5$\n-   $q_{(4)} = \\min\\left( \\frac{5}{4} p_{(4)}, q_{(5)} \\right) = \\min(0.1875, 0.5) = 0.1875$\n-   $q_{(3)} = \\min\\left( \\frac{5}{3} p_{(3)}, q_{(4)} \\right) = \\min\\left( \\frac{0.2}{3}, 0.1875 \\right) = \\frac{0.2}{3}$\n-   $q_{(2)} = \\min\\left( \\frac{5}{2} p_{(2)}, q_{(3)} \\right) = \\min\\left( 0.05, \\frac{0.2}{3} \\right) = 0.05$\n-   $q_{(1)} = \\min\\left( \\frac{5}{1} p_{(1)}, q_{(2)} \\right) = \\min(0.005, 0.05) = 0.005$\n\nThe set of ordered $q$-values is $\\{0.005, 0.05, \\frac{0.2}{3}, 0.1875, 0.5\\}$.\nAn equivalent way to determine discoveries is to find all hypotheses for which $q_{(i)} \\le \\alpha$.\n-   $q_{(1)} = 0.005 \\le 0.05$ (Discovery)\n-   $q_{(2)} = 0.05 \\le 0.05$ (Discovery)\n-   $q_{(3)} = \\frac{0.2}{3} \\approx 0.0667  0.05$ (Not a discovery)\n-   $q_{(4)} = 0.1875  0.05$ (Not a discovery)\n-   $q_{(5)} = 0.5  0.05$ (Not a discovery)\n\nBoth methods confirm that there are $2$ discoveries at an FDR level of $\\alpha = 0.05$. The total number of discoveries is $2$.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}