{
    "hands_on_practices": [
        {
            "introduction": "在任何生物医学研究中，严谨的研究设计都是至关重要的第一步。本练习将置信区间的理论定义与样本量确定的实际任务联系起来，旨在阐明统计功效与实验资源之间的基本权衡。通过推导置信区间宽度、样本量和方差之间的关系，您将具体理解如何规划实验以达到预期的估计精度。",
            "id": "4560495",
            "problem": "一种全身性炎症的临床生物标志物以毫克/升（mg/L）为单位进行量化。研究人员计划进行一项研究，以置信水平 $1 - \\alpha = 0.95$ 的双侧置信区间（CI）来估计该生物标志物的总体均值水平，记为 $\\mu$。根据先前对独立队列的荟萃分析，该生物标志物的受试者内测量过程和生物学变异性可以通过均值为 $\\mu$、已知方差为 $\\sigma^{2}$ 的独立同分布（i.i.d.）高斯观测值 $X_{1}, X_{2}, \\dots, X_{n}$ 得到很好的建模。该荟萃分析提供了一个经过外部验证的方差估计值 $\\sigma^{2} = 64$ (mg/L)$^{2}$，在研究计划阶段可将其视为已知。\n\n从双侧置信区间的核心定义以及已知方差的高斯模型下样本均值的抽样分布出发，推导一个连接置信区间宽度 $W$、样本量 $n$、方差 $\\sigma^{2}$ 以及标准正态分布的相应分位点的关系式。然后，使用该关系式，确定能保证在置信水平 $0.95$ 下，为 $\\mu$ 设计的双侧置信区间的总宽度 $W = 3$ mg/L 的最小整数 $n$。\n\n将最终的样本量 $n$ 以单个整数形式报告。如果计算中出现非整数，选择满足宽度约束 $W \\leq 3$ mg/L 的最小整数 $n$。最终的数值答案中不要包含任何单位。",
            "solution": "该问题要求在已知总体方差 $\\sigma^2$ 的情况下，确定为总体均值 $\\mu$ 达到指定置信区间宽度所需的最小样本量 $n$。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件：**\n- 待估计的总体参数：总体生物标志物均值水平 $\\mu$。\n- 数据模型：独立同分布（i.i.d.）的高斯观测值 $X_{1}, X_{2}, \\dots, X_{n}$。\n- 观测值分布：$X_i \\sim N(\\mu, \\sigma^2)$。\n- 已知总体方差：$\\sigma^2 = 64$ (mg/L)$^2$。\n- 置信水平：$1 - \\alpha = 0.95$。\n- 期望的双侧置信区间总宽度：$W = 3$ mg/L。\n- 约束条件：最终样本量 $n$ 必须是满足宽度要求的最小整数。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题牢固地建立在假设检验和估计的标准统计理论之上，特别是关于已知方差的正态分布均值置信区间的构建。这是生物统计学和临床试验设计中的一个典型问题。所提供的值对于生物学测量是合理的。\n- **适定性：** 该问题是适定的。它提供了所有必要的信息（$\\sigma^2$、置信水平、目标宽度），以确定样本量 $n$ 的唯一整数解。\n- **客观性：** 问题陈述客观、精确，没有歧义或主观性语言。\n\n**1.3. 结论：**\n该问题是有效的。它在科学上是合理的、适定的和客观的。没有矛盾、信息缺失或违反基本原则的地方。我们可以继续进行求解。\n\n### 步骤2：推导与求解\n\n总体均值 $\\mu$ 的估计量是样本均值 $\\bar{X}$，定义为：\n$$\n\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i\n$$\n鉴于 $X_i$ 是从正态分布 $N(\\mu, \\sigma^2)$ 中抽取的独立同分布随机变量，样本均值 $\\bar{X}$ 的抽样分布也是正态分布。$\\bar{X}$ 的均值为 $E[\\bar{X}] = \\mu$，其方差为 $\\text{Var}(\\bar{X}) = \\frac{\\sigma^2}{n}$。因此，抽样分布为：\n$$\n\\bar{X} \\sim N\\left(\\mu, \\frac{\\sigma^2}{n}\\right)\n$$\n为了构建置信区间，我们使用一个其分布不依赖于未知参数 $\\mu$ 的枢轴量。我们对 $\\bar{X}$ 进行标准化，得到一个标准正态随机变量 $Z$：\n$$\nZ = \\frac{\\bar{X} - \\mu}{\\sigma / \\sqrt{n}} \\sim N(0, 1)\n$$\n置信水平为 $1 - \\alpha$ 的双侧置信区间由以下概率陈述构建：\n$$\nP(-z_{\\alpha/2} \\le Z \\le z_{\\alpha/2}) = 1 - \\alpha\n$$\n其中 $z_{\\alpha/2}$ 是标准正态分布的上 $\\alpha/2$ 分位点，定义为 $P(Z > z_{\\alpha/2}) = \\alpha/2$。\n\n代入 $Z$ 的表达式可得：\n$$\nP\\left(-z_{\\alpha/2} \\le \\frac{\\bar{X} - \\mu}{\\sigma / \\sqrt{n}} \\le z_{\\alpha/2}\\right) = 1 - \\alpha\n$$\n我们整理不等式以分离出参数 $\\mu$：\n$$\n-z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\bar{X} - \\mu \\le z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n$$\n-\\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le -\\mu \\le -\\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n$$\n\\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le \\mu \\le \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n这就定义了 $\\mu$ 的 $100(1-\\alpha)\\%$ 置信区间：\n$$\n\\text{CI} = \\left[ \\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}, \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right]\n$$\n该置信区间的总宽度 $W$ 是上界与下界之差：\n$$\nW = \\left( \\bar{X} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right) - \\left( \\bar{X} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\right) = 2 z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}}\n$$\n这个方程提供了所需的连接宽度 $W$、样本量 $n$、标准差 $\\sigma$ 和标准正态分位点 $z_{\\alpha/2}$ 的关系。\n\n问题要求总宽度为 $W = 3$ mg/L。更准确地说，计划的宽度应最多为 $3$ mg/L。因此，我们得到不等式：\n$$\nW \\le 3 \\implies 2 z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{n}} \\le 3\n$$\n我们现在可以解出 $n$：\n$$\n\\sqrt{n} \\ge \\frac{2 z_{\\alpha/2} \\sigma}{3}\n$$\n$$\nn \\ge \\left( \\frac{2 z_{\\alpha/2} \\sigma}{3} \\right)^2\n$$\n现在我们代入给定的值。\n置信水平为 $1 - \\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。标准正态分布对应的分位点是 $z_{0.025}$。这个值使得累积概率为 $1 - 0.025 = 0.975$。$z_{0.025}$ 的标准值约为 $1.96$。\n已知方差为 $\\sigma^2 = 64$ (mg/L)$^2$，所以标准差为 $\\sigma = \\sqrt{64} = 8$ mg/L。\n最大期望宽度为 $W = 3$ mg/L。\n\n将这些值代入关于 $n$ 的不等式中：\n$$\nn \\ge \\left( \\frac{2 \\times 1.96 \\times 8}{3} \\right)^2\n$$\n$$\nn \\ge \\left( \\frac{31.36}{3} \\right)^2\n$$\n$$\nn \\ge (10.4533...)^2\n$$\n$$\nn \\ge 109.2718...\n$$\n由于样本量 $n$ 必须是整数，我们必须取大于或等于 $109.2718...$ 的最小整数。这是为了确保满足宽度约束 $W \\le 3$。因此，所需的最小样本量为 $n=110$。",
            "answer": "$$\\boxed{110}$$"
        },
        {
            "introduction": "收集数据后，我们使用估计量来推断总体参数，但如何选择一个“好”的估计量呢？本练习深入探讨了最大似然估计（MLE）这一推导估计量的基本原则，并探讨了估计量偏差的关键概念。通过推导正态分布方差的 MLE 并证明其存在偏差，您将体会到常用统计公式背后的理论精妙之处，并理解为何需要进行诸如贝塞尔校正等调整。",
            "id": "4560497",
            "problem": "一个分析II期肿瘤学研究中血浆代谢组学特征的联合体，收集了对数转换后生物标志物浓度的 $n$ 个独立技术重复测量值，记为 $X_{1}, X_{2}, \\dots, X_{n}$。假设一个概率模型，其中这些重复测量值是独立同分布的，来自一个具有未知均值和方差的高斯（正态）随机样本，具体来说，$X_{i} \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，其中 $\\mu \\in \\mathbb{R}$ 且 $\\sigma^{2} > 0$。使用最大似然估计（MLE）的第一性原理，推导使 $(\\mu, \\sigma^{2})$ 的似然最大化的估计量，然后严格证明 $\\sigma^{2}$ 的最大似然估计量是否是无偏的。通过在真实模型下求该估计量的期望值，并将其简化为闭式解析表达式，来精确量化任何偏差。你的论证应调用期望和方差的核心定义、性质，以及模型所蕴含的独立性结构，而不依赖任何快捷公式。这种偏差对生物信息学流程中下游的置信区间构建有直接影响；因此，你必须计算出确切的偏差项作为最终结果。请提供 $\\sigma^{2}$ 的最大似然估计量偏差的单一闭式符号表达式作为你的最终答案。无需四舍五入。",
            "solution": "问题要求推导高斯分布参数 $(\\mu, \\sigma^{2})$ 的最大似然估计量（MLEs），并随后计算方差估计量 $\\hat{\\sigma}^{2}_{MLE}$ 的偏差。\n\n数据由 $n$ 个独立同分布（i.i.d.）的随机变量 $X_{1}, X_{2}, \\dots, X_{n}$ 组成，其中每个 $X_{i}$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态（高斯）分布。单个观测值 $X_{i}$ 的概率密度函数（PDF）由下式给出：\n$$f(x_{i} | \\mu, \\sigma^{2}) = \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}} \\exp\\left(-\\frac{(x_{i} - \\mu)^{2}}{2\\sigma^{2}}\\right)$$\n\n由于观测值是独立同分布的，联合概率密度函数，即似然函数 $L(\\mu, \\sigma^{2} | \\mathbf{x})$，是各个概率密度函数的乘积：\n$$L(\\mu, \\sigma^{2} | \\mathbf{x}) = \\prod_{i=1}^{n} f(x_{i} | \\mu, \\sigma^{2}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}} \\exp\\left(-\\frac{(x_{i} - \\mu)^{2}}{2\\sigma^{2}}\\right)$$\n$$L(\\mu, \\sigma^{2} | \\mathbf{x}) = \\left(\\frac{1}{2\\pi\\sigma^{2}}\\right)^{n/2} \\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2}\\right)$$\n\n为了简化最大化过程，我们使用对数似然函数 $\\ell(\\mu, \\sigma^{2}) = \\ln L(\\mu, \\sigma^{2})$。\n$$\\ell(\\mu, \\sigma^{2}) = \\ln\\left[ \\left(2\\pi\\sigma^{2}\\right)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2}\\right) \\right]$$\n$$\\ell(\\mu, \\sigma^{2}) = -\\frac{n}{2}\\ln(2\\pi\\sigma^{2}) - \\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2}$$\n$$\\ell(\\mu, \\sigma^{2}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^{2}) - \\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2}$$\n\n为了找到最大似然估计量，我们计算对数似然函数关于 $\\mu$ 和 $\\sigma^{2}$ 的偏导数，并令它们为零。这些被称为得分方程。\n\n首先，对于 $\\mu$：\n$$\\frac{\\partial\\ell}{\\partial\\mu} = \\frac{\\partial}{\\partial\\mu} \\left[ -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^{2}) - \\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2} \\right]$$\n$$\\frac{\\partial\\ell}{\\partial\\mu} = -\\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{n} 2(x_{i} - \\mu)(-1) = \\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)$$\n将导数设为零以找到 $\\mu$ 的临界点：\n$$\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\hat{\\mu}) = 0 \\implies \\sum_{i=1}^{n}x_{i} - n\\hat{\\mu} = 0$$\n$$\\hat{\\mu}_{MLE} = \\frac{1}{n}\\sum_{i=1}^{n}x_{i} = \\bar{x}$$\n均值 $\\mu$ 的最大似然估计量是样本均值 $\\bar{X}$。\n\n接下来，对于 $\\sigma^{2}$：\n$$\\frac{\\partial\\ell}{\\partial\\sigma^{2}} = \\frac{\\partial}{\\partial\\sigma^{2}} \\left[ -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^{2}) - \\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2} \\right]$$\n$$\\frac{\\partial\\ell}{\\partial\\sigma^{2}} = -\\frac{n}{2\\sigma^{2}} + \\frac{1}{2(\\sigma^{2})^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2}$$\n将此导数设为零，并用估计量符号 $\\hat{\\sigma}^{2}$ 替换：\n$$-\\frac{n}{2\\hat{\\sigma}^{2}} + \\frac{1}{2(\\hat{\\sigma}^{2})^{2}}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2} = 0$$\n乘以 $2(\\hat{\\sigma}^{2})^{2}$ 得到：\n$$-n\\hat{\\sigma}^{2} + \\sum_{i=1}^{n}(x_{i} - \\mu)^{2} = 0$$\n$$\\hat{\\sigma}^{2} = \\frac{1}{n}\\sum_{i=1}^{n}(x_{i} - \\mu)^{2}$$\n根据最大似然估计量的不变性，我们将 $\\mu$ 的最大似然估计量 $\\hat{\\mu}_{MLE} = \\bar{x}$ 代入此表达式：\n$$\\hat{\\sigma}^{2}_{MLE} = \\frac{1}{n}\\sum_{i=1}^{n}(x_{i} - \\bar{x})^{2}$$\n这就是方差 $\\sigma^{2}$ 的最大似然估计量。\n\n现在我们必须确定 $\\hat{\\sigma}^{2}_{MLE}$ 是否是无偏估计量。如果一个参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的期望值等于该参数的真实值，即 $E[\\hat{\\theta}] = \\theta$，则该估计量是无偏的。偏差定义为 $\\text{Bias}(\\hat{\\theta}) = E[\\hat{\\theta}] - \\theta$。我们必须计算 $E[\\hat{\\sigma}^{2}_{MLE}]$。\n\n$$E[\\hat{\\sigma}^{2}_{MLE}] = E\\left[ \\frac{1}{n}\\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2} \\right] = \\frac{1}{n} E\\left[ \\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2} \\right]$$\n\n为了计算平方和的期望，我们通过加上和减去真实均值 $\\mu$ 来重写该项：\n$$\\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2} = \\sum_{i=1}^{n}((X_{i} - \\mu) - (\\bar{X} - \\mu))^{2}$$\n展开二项式：\n$$= \\sum_{i=1}^{n} \\left[ (X_{i} - \\mu)^{2} - 2(X_{i} - \\mu)(\\bar{X} - \\mu) + (\\bar{X} - \\mu)^{2} \\right]$$\n$$= \\sum_{i=1}^{n}(X_{i} - \\mu)^{2} - 2(\\bar{X} - \\mu)\\sum_{i=1}^{n}(X_{i} - \\mu) + \\sum_{i=1}^{n}(\\bar{X} - \\mu)^{2}$$\n交叉项可以简化，注意到 $\\sum_{i=1}^{n}(X_{i} - \\mu) = n\\bar{X} - n\\mu = n(\\bar{X} - \\mu)$：\n$$= \\sum_{i=1}^{n}(X_{i} - \\mu)^{2} - 2n(\\bar{X} - \\mu)^{2} + n(\\bar{X} - \\mu)^{2}$$\n$$= \\sum_{i=1}^{n}(X_{i} - \\mu)^{2} - n(\\bar{X} - \\mu)^{2}$$\n现在，我们利用期望的线性性质来求此表达式的期望：\n$$E\\left[\\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2}\\right] = E\\left[\\sum_{i=1}^{n}(X_{i} - \\mu)^{2}\\right] - E\\left[n(\\bar{X} - \\mu)^{2}\\right]$$\n$$E\\left[\\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2}\\right] = \\sum_{i=1}^{n}E\\left[(X_{i} - \\mu)^{2}\\right] - nE\\left[(\\bar{X} - \\mu)^{2}\\right]$$\n根据方差的定义，$\\text{Var}(Y) = E[(Y - E[Y])^{2}]$。对于每个 $X_{i}$，$E[X_{i}] = \\mu$，所以 $E[(X_{i} - \\mu)^{2}] = \\text{Var}(X_{i}) = \\sigma^{2}$。对于样本均值 $\\bar{X}$，$E[\\bar{X}] = \\mu$，所以 $E[(\\bar{X} - \\mu)^{2}] = \\text{Var}(\\bar{X})$。$n$ 个独立同分布随机变量的样本均值的方差是 $\\text{Var}(\\bar{X}) = \\frac{\\sigma^{2}}{n}$。\n\n将这些代入期望平方和的方程中：\n$$\\sum_{i=1}^{n}E\\left[(X_{i} - \\mu)^{2}\\right] = \\sum_{i=1}^{n}\\sigma^{2} = n\\sigma^{2}$$\n$$nE\\left[(\\bar{X} - \\mu)^{2}\\right] = n \\text{Var}(\\bar{X}) = n\\left(\\frac{\\sigma^{2}}{n}\\right) = \\sigma^{2}$$\n因此：\n$$E\\left[\\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2}\\right] = n\\sigma^{2} - \\sigma^{2} = (n-1)\\sigma^{2}$$\n现在我们可以求出方差的最大似然估计量的期望：\n$$E[\\hat{\\sigma}^{2}_{MLE}] = \\frac{1}{n}E\\left[\\sum_{i=1}^{n}(X_{i} - \\bar{X})^{2}\\right] = \\frac{1}{n}(n-1)\\sigma^{2} = \\frac{n-1}{n}\\sigma^{2}$$\n由于对于任何有限的 $n$，$E[\\hat{\\sigma}^{2}_{MLE}] = \\frac{n-1}{n}\\sigma^{2} \\neq \\sigma^{2}$，因此 $\\sigma^{2}$ 的最大似然估计量是一个有偏估计量。\n\n最后，我们精确地量化偏差：\n$$\\text{Bias}(\\hat{\\sigma}^{2}_{MLE}) = E[\\hat{\\sigma}^{2}_{MLE}] - \\sigma^{2}$$\n$$\\text{Bias}(\\hat{\\sigma}^{2}_{MLE}) = \\frac{n-1}{n}\\sigma^{2} - \\sigma^{2} = \\left(\\frac{n-1}{n} - 1\\right)\\sigma^{2}$$\n$$\\text{Bias}(\\hat{\\sigma}^{2}_{MLE}) = \\left(\\frac{n-1-n}{n}\\right)\\sigma^{2} = -\\frac{1}{n}\\sigma^{2}$$\n偏差是一个负项，表明方差的最大似然估计量系统性地低估了真实方差 $\\sigma^{2}$。这个低估的量级是 $\\frac{\\sigma^{2}}{n}$。",
            "answer": "$$\\boxed{-\\frac{\\sigma^{2}}{n}}$$"
        },
        {
            "introduction": "经典的统计方法通常依赖于诸如数据正态性的假设，而这些假设在真实的生物信息学数据中往往不成立。这项基于模拟的练习直面这一挑战，通过比较经典的t-置信区间与现代、稳健的 BCa（偏差校正和加速）自助法置信区间在处理偏态数据时的性能。通过亲手实现和评估，您将学会诊断传统方法的局限性，并应用强大的重采样技术在实际场景中构建更可靠的置信区间。",
            "id": "4560482",
            "problem": "给定一个严格为正的生物标志物的独立同分布（i.i.d.）样本，其总体分布呈正偏态。这在生物信息学和医学数据分析中对于类似浓度的测量是一种常见情况。假设该生物标志物浓度的分布为对数正态分布，这对于非负的、乘性生物过程是符合实际的。请专注于估计其总体均值。你的任务是通过模拟研究两种均值置信区间方法的覆盖概率：Student $t$ 置信区间和非参数自助法偏差校正和加速（BCa）置信区间。\n\n设计应仅基于基础且经过充分检验的原理：中心极限定理、置信区间作为具有名义覆盖率的区间估计量的定义、在正态性假设下当方差未知时标准化样本均值服从 Student $t$ 分布的原理、用于近似抽样分布的非参数自助法重抽样，以及用于估计 BCa 区间中加速常数的刀切法（jackknife）。除这些基础原理外，不得假设任何额外的简化公式。\n\n定义和要求：\n- 设 $X_1,\\dots,X_n$ 是来自参数为 $(\\mu, \\sigma)$ 的对数正态分布的独立同分布样本，即 $\\log(X_i) \\sim \\mathcal{N}(\\mu, \\sigma^2)$。$X$ 的总体均值为 $\\theta = \\mathbb{E}[X] = \\exp(\\mu + \\sigma^2/2)$。\n- 均值的 Student $t$ 置信区间是根据样本均值和样本标准差构造的。对于给定的 $\\alpha \\in (0,1)$，其名义水平为 $1-\\alpha$。\n- 偏差校正和加速（BCa）置信区间是一种非参数自助法置信区间，它使用通过刀切法计算的偏差校正项和加速项。使用对原始样本的非参数自助法重抽样来近似均值的抽样分布。使用刀切法来估计加速参数。\n- 对于一个置信区间 $\\mathcal{I}(X_1,\\dots,X_n)$，其关于 $\\theta$ 的覆盖概率为 $\\mathbb{P}(\\theta \\in \\mathcal{I}(X_1,\\dots,X_n))$。你将通过蒙特卡洛方法，计算多次独立模拟数据集中指示函数 $\\mathbf{1}\\{\\theta \\in \\mathcal{I}\\}$ 的平均值来估计该概率。\n\n实现一个程序，该程序：\n1. 对于下面测试套件中的每一组参数，从指定的对数正态分布中重复模拟 $R$ 个独立的、大小为 $n$ 的数据集 $X_1,\\dots,X_n$。\n2. 对每个数据集，计算：\n   - 一个名义水平为 $1-\\alpha$ 的双侧 Student $t$ 均值置信区间，\n   - 一个相同名义水平的双侧非参数自助法 BCa 均值置信区间，使用 $B$ 次自助法复制和刀切法计算加速参数。\n3. 对于每种方法和每组参数，通过计算相对于真实均值 $\\theta = \\exp(\\mu + \\sigma^2/2)$ 的覆盖指示函数的蒙特卡洛平均值，来计算经验覆盖概率。\n4. 使用固定的伪随机数生成器种子 $20231105$ 以确保每次运行结果的可复现性。\n\n蒙特卡洛指南：\n- 你的覆盖率蒙特卡洛估计量必须是取值于 $\\{0,1\\}$ 的指示变量的样本均值，结果为一个在 $[0,1]$ 内的浮点数。\n- 为确保 BCa 计算的数值稳定性，必要时应将任何累积分布函数的参数或分位数概率水平裁剪到开区间 $(0,1)$ 内。\n\n不涉及角度或物理单位。所有概率必须以小数表示，而非百分比。将报告的每个覆盖率和差异值四舍五入到四位小数；打印时允许省略末尾的零。\n\n测试套件：\n- 情况 A（中等 $n$，中等偏度）：$n=20$, $\\mu=2.0$, $\\sigma=1.0$, $\\alpha=0.05$, $B=500$, $R=200$。\n- 情况 B（较大 $n$，轻微偏度）：$n=50$, $\\mu=2.0$, $\\sigma=0.5$, $\\alpha=0.05$, $B=400$, $R=200$。\n- 情况 C（较小 $n$，重度偏度）：$n=15$, $\\mu=1.5$, $\\sigma=1.2$, $\\alpha=0.05$, $B=500$, $R=200$。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。\n- 对于按 A、B、C 顺序排列的每个测试用例，附加三个浮点数：\n  1. Student $t$ 置信区间的经验覆盖率，\n  2. BCa 置信区间的经验覆盖率，\n  3. “BCa 覆盖率减去 $t$ 覆盖率”的差值。\n- 因此，输出必须是包含 9 个浮点数的单行：$[t_A, bca_A, \\Delta_A, t_B, bca_B, \\Delta_B, t_C, bca_C, \\Delta_C]$，其中每个条目都按要求四舍五入到四位小数。",
            "solution": "所给问题要求进行一项模拟研究，以比较在估计对数正态分布均值时，Student t 置信区间和非参数自助法偏差校正和加速（BCa）置信区间的经验覆盖概率。该问题在科学和数学上是适定的，为进行严谨的计算实验提供了所有必要的参数和定义。其背景，即对偏态生物标志物数据的估计，是生物统计学中一个成熟的领域。待比较的方法——一种经典的参数方法和一种现代的、计算密集型的非参数方法——都是统计推断中的标准工具。目标是量化在处理偏态数据时，每种方法的实际覆盖概率与其名义置信水平的对比情况。该问题是有效的，我将着手提供一个完整的解决方案。\n\n解决方案的核心是蒙特卡洛模拟。对于给定的一组参数——样本量 $n$、对数正态分布参数 $\\mu$ 和 $\\sigma$ 以及显著性水平 $\\alpha$——我们将在 $R$ 次独立重复中执行以下步骤：\n1.  从参数为 $(\\mu, \\sigma)$ 的对数正态分布中生成一个样本 $X_1, \\dots, X_n$。其基础的正态分布为 $\\log(X_i) \\sim \\mathcal{N}(\\mu, \\sigma^2)$。\n2.  计算真实的总体均值，这是我们置信区间的目标。对于对数正态分布，该值为 $\\theta = \\mathbb{E}[X] = \\exp(\\mu + \\sigma^2/2)$。\n3.  构建一个双侧的 $(1-\\alpha)$ Student t 均值置信区间。\n4.  构建一个双侧的 $(1-\\alpha)$ BCa 自助法均值置信区间。\n5.  对每个区间，记录它是否成功捕获了真实均值 $\\theta$。\n在所有 $R$ 次重复完成后，每种方法的经验覆盖概率被估计为相应区间包含 $\\theta$ 的次数所占的比例。\n\n在此，我们详细阐述每种置信区间方法背后的理论原理。\n\n**Student t 置信区间**\n该区间是频率派推断的基石。对于一个样本 $\\{x_1, \\dots, x_n\\}$，样本均值为 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^n x_i$，样本标准差为 $s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^n (x_i - \\bar{x})^2}$。中心极限定理（CLT）指出，对于足够大的样本量 $n$，标准化均值 $\\frac{\\bar{X} - \\theta}{S/\\sqrt{n}}$ 的抽样分布近似于自由度为 $n-1$ 的 Student t 分布。这为构建置信区间提供了基础：\n$$ \\mathcal{I}_t = \\left[ \\bar{x} - t_{1-\\alpha/2, n-1} \\frac{s}{\\sqrt{n}}, \\quad \\bar{x} + t_{1-\\alpha/2, n-1} \\frac{s}{\\sqrt{n}} \\right] $$\n其中 $t_{1-\\alpha/2, n-1}$ 是自由度为 $n-1$ 的 Student t 分布的 $(1-\\alpha/2)$ 分位数。该区间的有效性依赖于样本均值抽样分布的正态性。对于来自像对数正态分布这样的高度偏态分布的小样本，此假设被违反，实际覆盖概率可能与名义水平 $1-\\alpha$ 有显著偏差。\n\n**非参数自助法 BCa 置信区间**\n自助法是一种重抽样方法，用于在不对总体作出强分布假设的情况下近似统计量的抽样分布。BCa 区间通过引入两个校正因子来增强简单的百分位自助法：一个偏差校正项 $z_0$ 和一个加速项 $a$。这些因子调整区间端点，以解决自助法分布中的偏度和估计量方差的非恒定性问题，从而获得更高阶的准确性。\n\nBCa 区间的构建过程如下：\n1.  **自助法重抽样**：通过从原始样本中有放回地抽取 $n$ 个观测值来生成 $B$ 个自助法样本。对每个自助法样本，计算感兴趣的统计量（即样本均值），得到一组自助法估计值 $\\{\\hat{\\theta}^*_1, \\dots, \\hat{\\theta}^*_B\\}$。这个集合被称为自助法分布，用作对样本均值 $\\hat{\\theta}$ 真实抽样分布的经验近似。\n\n2.  **偏差校正 ($z_0$)**：偏差校正因子衡量自助法分布的中位数偏差。其计算公式为：\n    $$ z_0 = \\Phi^{-1} \\left( \\frac{1}{B} \\sum_{b=1}^{B} \\mathbf{1}\\{\\hat{\\theta}^*_b  \\hat{\\theta}\\} \\right) $$\n    其中 $\\hat{\\theta}$ 是原始数据的样本均值，$\\Phi^{-1}$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的逆累积分布函数（CDF），$\\mathbf{1}\\{\\cdot\\}$ 是指示函数。如果自助法分布是中位数无偏的（即其中位数等于 $\\hat{\\theta}$），则该比例为 $0.5$，$z_0=0$。\n\n3.  **加速项 ($a$)**：加速项考虑了估计量标准误随参数的变化率。它捕捉了抽样分布的偏度。该项使用刀切法进行估计：\n    -   计算 $n$ 个均值的刀切估计量 $\\hat{\\theta}_{(i)}$，每个估计量都是通过从原始样本中剔除第 $i$ 个观测值得到的。\n    -   设 $\\hat{\\theta}_{(\\cdot)} = \\frac{1}{n}\\sum_{i=1}^n \\hat{\\theta}_{(i)}$ 为这些刀切估计量的均值。\n    -   加速项则为：\n        $$ a = \\frac{\\sum_{i=1}^n (\\hat{\\theta}_{(\\cdot)} - \\hat{\\theta}_{(i)})^3}{6 \\left[ \\sum_{i=1}^n (\\hat{\\theta}_{(\\cdot)} - \\hat{\\theta}_{(i)})^2 \\right]^{3/2}} $$\n\n4.  **调整后的区间端点**：BCa 区间使用调整后的概率水平 $\\alpha_1$ 和 $\\alpha_2$ 来从自助法分布中找到端点。它们通过 $z_0$ 和 $a$ 计算得出：\n    $$ \\alpha_1 = \\Phi \\left( z_0 + \\frac{z_0 + z_{\\alpha/2}}{1 - a(z_0 + z_{\\alpha/2})} \\right) $$\n    $$ \\alpha_2 = \\Phi \\left( z_0 + \\frac{z_0 + z_{1-\\alpha/2}}{1 - a(z_0 + z_{1-\\alpha/2})} \\right) $$\n    其中 $\\Phi$ 是标准正态 CDF，$z_p = \\Phi^{-1}(p)$ 是标准正态分位数函数。\n\n5.  **最终区间**：BCa 置信区间由排序后的自助法分布 $\\{\\hat{\\theta}^*_b\\}$ 的 $\\alpha_1$ 和 $\\alpha_2$ 分位数给出：\n    $$ \\mathcal{I}_{BCa} = \\left[ \\hat{\\theta}^*_{(\\alpha_1)}, \\hat{\\theta}^*_{(\\alpha_2)} \\right] $$\n\n这种复杂的程序有望产生更接近名义水平 $1-\\alpha$ 的覆盖概率，特别是在测试套件中指定的小样本量和高偏度的挑战性情景下。该模拟将为这一理论优势提供定量证据。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t, norm\n\ndef t_interval(data, alpha):\n    \"\"\"\n    Computes the two-sided Student's t-confidence interval for the mean.\n    \"\"\"\n    n = len(data)\n    if n  2:\n        return np.nan, np.nan\n    \n    mean = np.mean(data)\n    std_dev = np.std(data, ddof=1)\n    se = std_dev / np.sqrt(n)\n    \n    t_critical = t.ppf(1 - alpha / 2, df=n - 1)\n    \n    lower = mean - t_critical * se\n    upper = mean + t_critical * se\n    \n    return lower, upper\n\ndef bca_interval(data, alpha, B, stat_func, rng):\n    \"\"\"\n    Computes the nonparametric bootstrap BCa confidence interval for a statistic.\n    \"\"\"\n    n = len(data)\n    if n  2:\n        return np.nan, np.nan\n\n    # Original statistic from the sample\n    theta_hat = stat_func(data)\n\n    # 1. Generate bootstrap replicates of the statistic\n    bootstrap_indices = rng.choice(n, size=(B, n), replace=True)\n    bootstrap_samples = data[bootstrap_indices]\n    bootstrap_stats = np.apply_along_axis(stat_func, 1, bootstrap_samples)\n\n    # 2. Bias-correction factor (z0)\n    # Proportion of bootstrap stats less than the original stat\n    prop_less = np.sum(bootstrap_stats  theta_hat) / B\n    # Clip for numerical stability if prop_less is 0 or 1\n    prop_less_clipped = np.clip(prop_less, 1e-10, 1 - 1e-10)\n    z0 = norm.ppf(prop_less_clipped)\n\n    # 3. Acceleration factor (a) using jackknife\n    jackknife_stats = np.zeros(n)\n    for i in range(n):\n        jackknife_sample = np.delete(data, i)\n        jackknife_stats[i] = stat_func(jackknife_sample)\n    \n    jackknife_mean = np.mean(jackknife_stats)\n    \n    # Calculate numerator and denominator for 'a'\n    numerator = np.sum((jackknife_mean - jackknife_stats) ** 3)\n    sum_sq_diffs = np.sum((jackknife_mean - jackknife_stats) ** 2)\n\n    # Handle cases where all jackknife estimates are identical (sum_sq_diffs=0)\n    if sum_sq_diffs == 0:\n        a = 0.0\n    else:\n        denominator = 6 * (sum_sq_diffs ** 1.5)\n        a = numerator / denominator\n\n    # 4. Adjusted interval endpoints (alpha1, alpha2)\n    z_alpha_half = norm.ppf(alpha / 2)\n    z_1m_alpha_half = norm.ppf(1 - alpha / 2)\n\n    # Numerators for the adjustment fractions\n    num1 = z0 + z_alpha_half\n    num2 = z0 + z_1m_alpha_half\n    \n    # Denominators for adjustment fractions, preventing division by zero\n    den1 = 1 - a * num1\n    if den1 == 0: den1 = 1e-10\n    den2 = 1 - a * num2\n    if den2 == 0: den2 = 1e-10\n\n    # Arguments for the final CDF evaluation\n    arg1 = z0 + num1 / den1\n    arg2 = z0 + num2 / den2\n\n    alpha1 = norm.cdf(arg1)\n    alpha2 = norm.cdf(arg2)\n    \n    # 5. Final interval from quantiles of the bootstrap distribution\n    # Using np.quantile handles interpolation for non-integer indices\n    lower = np.quantile(bootstrap_stats, alpha1)\n    upper = np.quantile(bootstrap_stats, alpha2)\n\n    return lower, upper\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (moderate n, moderate skew)\n        {'n': 20, 'mu': 2.0, 'sigma': 1.0, 'alpha': 0.05, 'B': 500, 'R': 200},\n        # Case B (larger n, mild skew)\n        {'n': 50, 'mu': 2.0, 'sigma': 0.5, 'alpha': 0.05, 'B': 400, 'R': 200},\n        # Case C (small n, heavy skew)\n        {'n': 15, 'mu': 1.5, 'sigma': 1.2, 'alpha': 0.05, 'B': 500, 'R': 200},\n    ]\n\n    # Initialize the random number generator with the specified seed\n    seed = 20231105\n    rng = np.random.default_rng(seed)\n\n    results = []\n    \n    stat_func = np.mean\n\n    for case in test_cases:\n        n, mu, sigma, alpha, B, R = case.values()\n\n        # True population mean for the log-normal distribution\n        theta_true = np.exp(mu + (sigma**2) / 2)\n\n        t_coverage_count = 0\n        bca_coverage_count = 0\n\n        for _ in range(R):\n            # 1. Generate a dataset from the log-normal distribution\n            # The `mean` and `sigma` arguments of rng.lognormal correspond to the\n            # mean and std. dev. of the underlying normal distribution.\n            data = rng.lognormal(mean=mu, sigma=sigma, size=n)\n\n            # 2. Compute the t-interval and check coverage\n            t_low, t_high = t_interval(data, alpha)\n            if t_low = theta_true = t_high:\n                t_coverage_count += 1\n\n            # 3. Compute the BCa interval and check coverage\n            bca_low, bca_high = bca_interval(data, alpha, B, stat_func, rng)\n            if bca_low = theta_true = bca_high:\n                bca_coverage_count += 1\n\n        # Calculate empirical coverage probabilities\n        t_coverage = t_coverage_count / R\n        bca_coverage = bca_coverage_count / R\n        coverage_diff = bca_coverage - t_coverage\n        \n        results.extend([\n            round(t_coverage, 4),\n            round(bca_coverage, 4),\n            round(coverage_diff, 4)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}