{
    "hands_on_practices": [
        {
            "introduction": "任何模型的性能都取决于其参数如何从数据中估算。在医学领域，尤其是在罕见病研究中，我们常常面临样本量小的问题。本练习旨在揭示最大似然估计（ML）的缺陷，例如“零频数问题”，并展示后验最大化（MAP）估计如何通过融合先验知识来提供更稳健和现实的参数估计。",
            "id": "4588350",
            "problem": "一家医院正在构建一个二元朴素贝叶斯分类器，用于诊断一种罕见疾病。该疾病由类别标签 $y \\in \\{0,1\\}$ 表示，其中 $y=1$ 表示患病。该分类器使用单一的二元症状指示器 $x \\in \\{0,1\\}$，如果患者报告了某种特定症状，则 $x=1$。根据疾病登记处的数据，目标人群中的疾病患病率为 $p(y=1)=\\pi$，其中 $\\pi=0.005$。现有少量带标签的训练集：在 $n_{1}=4$ 名已知患病患者 ($y=1$) 中，有 $k_{1}=1$ 名报告了该症状 ($x=1$)；在 $n_{0}=6$ 名已知非患病对照组 ($y=0$) 中，有 $k_{0}=0$ 名报告了该症状 ($x=1$)。\n\n令 $\\theta_{1}=p(x=1 \\mid y=1)$ 且 $\\theta_{0}=p(x=1 \\mid y=0)$。考虑两种估计策略：\n- 最大似然估计 (ML)，仅使用观测计数。\n- 最大后验估计 (MAP)，使用与临床知识一致的独立 Beta 先验：$\\theta_{1} \\sim \\mathrm{Beta}(\\alpha_{1},\\beta_{1})$，其中 $\\alpha_{1}=2, \\beta_{1}=2$；以及 $\\theta_{0} \\sim \\mathrm{Beta}(\\alpha_{0},\\beta_{0})$，其中 $\\alpha_{0}=2, \\beta_{0}=198$。\n\n仅使用基本定义（朴素贝叶斯建模假设下的后验概率贝叶斯定理，以及 Beta 先验与伯努利似然的共轭性），计算在每种估计策略下，一个 $x=1$ 的新患者的后验患病概率，即 $p_{\\mathrm{ML}}(y=1 \\mid x=1)$ 和 $p_{\\mathrm{MAP}}(y=1 \\mid x=1)$。然后通过差值量化后验概率的下游变化：\n$$\\Delta \\equiv p_{\\mathrm{MAP}}(y=1 \\mid x=1) - p_{\\mathrm{ML}}(y=1 \\mid x=1).$$\n报告 $\\Delta$ 的单一数值，四舍五入到四位有效数字。答案以纯小数形式表示（不带百分号）。",
            "solution": "本题要求在朴素贝叶斯分类器的两种不同参数估计方案下——最大似然估计 (ML) 和最大后验估计 (MAP)——计算给定症状下患病的后验概率 $p(y=1 \\mid x=1)$，并进行比较。最终目标是计算这两种方法得到的后验概率之差 $\\Delta$。\n\n首先，我们使用贝叶斯定理建立后验概率的一般公式。朴素贝叶斯模型假设特征 $x$ 在给定类别 $y$ 的条件下与其他特征是条件独立的。由于只有一个特征，这个假设自然满足。在出现症状 ($x=1$) 的条件下患有该疾病 ($y=1$) 的后验概率是：\n$$p(y=1 \\mid x=1) = \\frac{p(x=1 \\mid y=1) p(y=1)}{p(x=1)}$$\n分母 $p(x=1)$ 是证据的边际概率，可以使用全概率定律展开：\n$$p(x=1) = p(x=1 \\mid y=1) p(y=1) + p(x=1 \\mid y=0) p(y=0)$$\n使用题目中提供的符号：\n-   疾病患病率（疾病的先验概率）是 $p(y=1) = \\pi$。\n-   非患病状态的概率是 $p(y=0) = 1 - \\pi$。\n-   患病患者中出现症状的类条件概率是 $\\theta_1 = p(x=1 \\mid y=1)$。\n-   非患病患者中出现症状的类条件概率是 $\\theta_0 = p(x=1 \\mid y=0)$。\n\n将这些代入后验概率公式，得到：\n$$p(y=1 \\mid x=1) = \\frac{\\theta_1 \\pi}{\\theta_1 \\pi + \\theta_0 (1-\\pi)}$$\n给定 $\\pi = 0.005$，所以 $1-\\pi = 0.995$。问题的核心在于使用 ML 和 MAP 方法估计参数 $\\theta_1$ 和 $\\theta_0$。\n\n**1. 最大似然估计 (ML)**\n\n伯努利分布（用于模拟我们的二元症状 $x$）参数的 ML 估计就是样本中的成功比例。\n-   对于患病组 ($y=1$)，在 $n_1=4$ 名患者中有 $k_1=1$ 例出现该症状 ($x=1$)。$\\theta_1$ 的 ML 估计是：\n$$\\hat{\\theta}_{1, \\mathrm{ML}} = \\frac{k_1}{n_1} = \\frac{1}{4} = 0.25$$\n-   对于非患病组 ($y=0$)，在 $n_0=6$ 名患者中有 $k_0=0$ 例出现该症状 ($x=1$)。$\\theta_0$ 的 ML 估计是：\n$$\\hat{\\theta}_{0, \\mathrm{ML}} = \\frac{k_0}{n_0} = \\frac{0}{6} = 0$$\n\n现在，我们使用这些 ML 估计值来计算后验概率 $p_{\\mathrm{ML}}(y=1 \\mid x=1)$：\n$$p_{\\mathrm{ML}}(y=1 \\mid x=1) = \\frac{\\hat{\\theta}_{1, \\mathrm{ML}} \\pi}{\\hat{\\theta}_{1, \\mathrm{ML}} \\pi + \\hat{\\theta}_{0, \\mathrm{ML}} (1-\\pi)} = \\frac{0.25 \\times 0.005}{0.25 \\times 0.005 + 0 \\times 0.995}$$\n$$p_{\\mathrm{ML}}(y=1 \\mid x=1) = \\frac{0.00125}{0.00125 + 0} = 1$$\n这个结果表明，在 ML 估计下，观察到该症状就意味着肯定患有此病。这是零频率问题的直接后果：由于小型训练集中的非患病个体都没有出现该症状，模型错误地学习到非患病者不可能出现该症状。\n\n**2. 最大后验估计 (MAP)**\n\nMAP 估计融合了关于参数的先验信念，这有助于对估计进行正则化，并避免像零频率这样的问题。题目指定了 $\\theta_1$ 和 $\\theta_0$ 的 Beta 先验。Beta 分布是伯努利似然的共轭先验，这简化了后验分布的计算。\n\n对于一个具有 $\\mathrm{Beta}(\\alpha, \\beta)$ 先验的参数 $\\theta$，在 $n$ 次试验中观察到 $k$ 次成功后，其后验分布为 $\\mathrm{Beta}(k+\\alpha, n-k+\\beta)$。MAP 估计是该后验分布的众数。一个 $\\mathrm{Beta}(a,b)$ 分布（其中 $a, b > 1$）的众数由 $\\frac{a-1}{a+b-2}$ 给出。\n\n-   对于 $\\theta_1$，其先验为 $\\mathrm{Beta}(\\alpha_1, \\beta_1)$，其中 $\\alpha_1=2, \\beta_1=2$。数据为 $k_1=1, n_1=4$。$\\theta_1$ 的后验分布是：\n$$\\theta_1 \\mid \\text{data} \\sim \\mathrm{Beta}(k_1+\\alpha_1, n_1-k_1+\\beta_1) = \\mathrm{Beta}(1+2, 4-1+2) = \\mathrm{Beta}(3, 5)$$\n由于后验分布的两个参数（$3$ 和 $5$）都大于 $1$，MAP 估计即为众数：\n$$\\hat{\\theta}_{1, \\mathrm{MAP}} = \\frac{(k_1+\\alpha_1)-1}{(k_1+\\alpha_1) + (n_1-k_1+\\beta_1)-2} = \\frac{3-1}{3+5-2} = \\frac{2}{6} = \\frac{1}{3}$$\n-   对于 $\\theta_0$，其先验为 $\\mathrm{Beta}(\\alpha_0, \\beta_0)$，其中 $\\alpha_0=2, \\beta_0=198$。数据为 $k_0=0, n_0=6$。$\\theta_0$ 的后验分布是：\n$$\\theta_0 \\mid \\text{data} \\sim \\mathrm{Beta}(k_0+\\alpha_0, n_0-k_0+\\beta_0) = \\mathrm{Beta}(0+2, 6-0+198) = \\mathrm{Beta}(2, 204)$$\n后验分布的参数（$2$ 和 $204$）也大于 $1$。MAP 估计是：\n$$\\hat{\\theta}_{0, \\mathrm{MAP}} = \\frac{(k_0+\\alpha_0)-1}{(k_0+\\alpha_0) + (n_0-k_0+\\beta_0)-2} = \\frac{2-1}{2+204-2} = \\frac{1}{204}$$\n\n现在我们使用这些 MAP 估计值来计算后验概率 $p_{\\mathrm{MAP}}(y=1 \\mid x=1)$。我们使用参数的精确分数形式，以及 $\\pi = 0.005 = \\frac{1}{200}$ 和 $1-\\pi = 0.995 = \\frac{199}{200}$：\n$$p_{\\mathrm{MAP}}(y=1 \\mid x=1) = \\frac{\\hat{\\theta}_{1, \\mathrm{MAP}} \\pi}{\\hat{\\theta}_{1, \\mathrm{MAP}} \\pi + \\hat{\\theta}_{0, \\mathrm{MAP}} (1-\\pi)} = \\frac{\\frac{1}{3} \\times \\frac{1}{200}}{\\frac{1}{3} \\times \\frac{1}{200} + \\frac{1}{204} \\times \\frac{199}{200}}$$\n为简化这个繁分数，我们可以从分子和分母的和的每一项中消去 $\\frac{1}{200}$ 这一项：\n$$p_{\\mathrm{MAP}}(y=1 \\mid x=1) = \\frac{\\frac{1}{3}}{\\frac{1}{3} + \\frac{199}{204}} = \\frac{\\frac{1}{3}}{\\frac{1 \\times 68}{3 \\times 68} + \\frac{199}{204}} = \\frac{\\frac{1}{3}}{\\frac{68}{204} + \\frac{199}{204}} = \\frac{\\frac{1}{3}}{\\frac{267}{204}}$$\n$$p_{\\mathrm{MAP}}(y=1 \\mid x=1) = \\frac{1}{3} \\times \\frac{204}{267} = \\frac{68}{267}$$\n\n**3. 量化变化**\n\n最后一步是计算差值 $\\Delta$：\n$$\\Delta = p_{\\mathrm{MAP}}(y=1 \\mid x=1) - p_{\\mathrm{ML}}(y=1 \\mid x=1)$$\n$$\\Delta = \\frac{68}{267} - 1 = \\frac{68 - 267}{267} = -\\frac{199}{267}$$\n为了给出数值答案，我们计算其小数值并四舍五入到四位有效数字：\n$$\\Delta = -\\frac{199}{267} \\approx -0.74531835...$$\n四舍五入到四位有效数字得到 $-0.7453$。这个显著的负差异凸显了 MAP 估计的强大正则化效应，它将后验概率从过于自信的 ML 模型产生的极端值 $1$ 拉了回来。",
            "answer": "$$\\boxed{-0.7453}$$"
        },
        {
            "introduction": "在认识到严格独立性假设的局限性后，下一步自然是放宽这一假设。本练习将介绍半朴素贝叶斯分类器，这是一种强大的混合模型，它将特征分组，假设组间独立，但允许组内特征存在依赖关系。你将构建这样一个模型，结合不同的概率分布来处理多样化的数据类型，并了解它如何提供一个更精细、更准确的诊断工具。",
            "id": "4588292",
            "problem": "在生物信息学和医疗数据分析的医学诊断背景下，考虑一个二元疾病指标 $D \\in \\{0,1\\}$，其中 $D=1$ 表示存在疾病，$D=0$ 表示不存在疾病。两个二元特征 $X_{1}$ 和 $X_{2}$ 源自基因表达阈值（当相应的生物标志物过表达时，每个特征等于 $1$，否则等于 $0$）。假设有以下科学上合理的数据：\n- 疾病患病率：$P(D=1)=0.02$ 和 $P(D=0)=0.98$。\n- 在患病（$D=1$）的情况下，特征是条件正相关的，其边际概率为 $P(X_{1}=1 \\mid D=1)=0.70$ 和 $P(X_{2}=1 \\mid D=1)=0.60$，联合概率为 $P(X_{1}=1, X_{2}=1 \\mid D=1)=0.55$。这些值意味着 $P(X_{1}=1, X_{2}=0 \\mid D=1)=0.15$，$P(X_{1}=0, X_{2}=1 \\mid D=1)=0.05$ 和 $P(X_{1}=0, X_{2}=0 \\mid D=1)=0.25$，这与边际概率一致，并展示了正向条件依赖性，因为 $P(X_{1}=1, X_{2}=1 \\mid D=1)=0.55 > 0.70 \\times 0.60=0.42$。\n- 在未患病（$D=0$）的情况下，特征是条件独立的，有 $P(X_{1}=1 \\mid D=0)=0.10$，$P(X_{2}=1 \\mid D=0)=0.15$，因此 $P(X_{1}=1, X_{2}=1 \\mid D=0)=0.10 \\times 0.15=0.015$。\n\n朴素贝叶斯（NB）分类器将给定 $D$ 的 $X_1$ 和 $X_2$ 建模为条件独立的，因此对于任何 $d \\in \\{0,1\\}$，有\n$$\nP_{\\text{NB}}(X_{1}=x_{1}, X_{2}=x_{2} \\mid D=d) = P(X_{1}=x_{1} \\mid D=d)\\, P(X_{2}=x_{2} \\mid D=d).\n$$\n一个正确指定的相依模型使用真实的联合分布 $P(X_{1}, X_{2} \\mid D)$，而不使用独立性假设。\n\n仅从贝叶斯定理和后验优势比的定义出发，推导当患者表现为 $X_{1}=1$ 和 $X_{2}=1$ 时，由朴素贝叶斯独立性假设引起的后验优势比的乘性偏差。将乘性偏差定义为\n$$\nB \\equiv \\frac{O_{\\text{NB}}(D=1 \\mid X_{1}=1, X_{2}=1)}{O_{\\text{true}}(D=1 \\mid X_{1}=1, X_{2}=1)},\n$$\n其中 $O(\\cdot)$ 表示后验优势比。使用上述数据计算 $B$，并将您的最终结果表示为一个无量纲小数。将您的答案四舍五入到四位有效数字。不要使用百分号。",
            "solution": "问题要求计算当患者表现为特征 $X_1=1$ 和 $X_2=1$ 时，由朴素贝叶斯（NB）独立性假设引起的后验优势比的乘性偏差。偏差 $B$ 定义为由NB模型计算的后验优势比与真实后验优势比的比率。令证据表示为 $X = (X_{1}=1, X_{2}=1)$。\n\n首先，我们建立后验优势比的一般形式。给定证据 $X$，患有疾病（$D=1$）相对于不患疾病（$D=0$）的后验优势比定义为：\n$$\nO(D=1 \\mid X) = \\frac{P(D=1 \\mid X)}{P(D=0 \\mid X)}\n$$\n通过将贝叶斯定理 $P(D=d \\mid X) = \\frac{P(X \\mid D=d)P(D=d)}{P(X)}$ 应用于分子和分母，我们得到：\n$$\nO(D=1 \\mid X) = \\frac{\\frac{P(X \\mid D=1)P(D=1)}{P(X)}}{\\frac{P(X \\mid D=0)P(D=0)}{P(X)}}\n$$\n证据的边际概率 $P(X)$ 被消去，得到后验优势比的表达式为似然比与先验优势比的乘积：\n$$\nO(D=1 \\mid X) = \\left(\\frac{P(X \\mid D=1)}{P(X \\mid D=0)}\\right) \\left(\\frac{P(D=1)}{P(D=0)}\\right)\n$$\n\n乘性偏差 $B$ 定义为：\n$$\nB \\equiv \\frac{O_{\\text{NB}}(D=1 \\mid X)}{O_{\\text{true}}(D=1 \\mid X)}\n$$\n其中 $O_{\\text{NB}}$ 是使用朴素贝叶斯假设计算的优势比，$O_{\\text{true}}$ 是使用真实条件概率计算的优势比。\n\n使用推导出的后验优势比公式，我们可以写出真实优势比和NB优势比。令 $X$ 表示具体观测值 $(X_1=1, X_2=1)$。\n真实的后验优势比为：\n$$\nO_{\\text{true}}(D=1 \\mid X) = \\frac{P(X_{1}=1, X_{2}=1 \\mid D=1)}{P(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}\n$$\n朴素贝叶斯后验优势比为：\n$$\nO_{\\text{NB}}(D=1 \\mid X) = \\frac{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1)}{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}\n$$\n将这些表达式代入偏差 $B$ 的定义中：\n$$\nB = \\frac{\\frac{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1)}{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}}{\\frac{P(X_{1}=1, X_{2}=1 \\mid D=1)}{P(X_{1}=1, X_{2}=1 \\mid D=0)} \\times \\frac{P(D=1)}{P(D=0)}}\n$$\n先验优势比项 $\\frac{P(D=1)}{P(D=0)}$ 被消去，剩下似然比的比率：\n$$\nB = \\frac{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1)}{P(X_{1}=1, X_{2}=1 \\mid D=1)} \\times \\frac{P(X_{1}=1, X_{2}=1 \\mid D=0)}{P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)}\n$$\n现在我们必须使用所提供的数据计算此表达式中的四个条件概率。\n\n1.  $D=1$ 时的真实条件概率：问题明确给出了相依特征的联合概率：\n    $$P(X_{1}=1, X_{2}=1 \\mid D=1) = 0.55$$\n\n2.  $D=1$ 时的朴素贝叶斯条件概率：NB模型假设条件独立，使用给定的边际概率：\n    $$P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=1) = P(X_{1}=1 \\mid D=1) P(X_{2}=1 \\mid D=1) = 0.70 \\times 0.60 = 0.42$$\n\n3.  $D=0$ 时的真实条件概率：问题陈述对于 $D=0$，特征是条件独立的。因此，真实的联合概率是边际概率的乘积：\n    $$P(X_{1}=1, X_{2}=1 \\mid D=0) = P(X_{1}=1 \\mid D=0) P(X_{2}=1 \\mid D=0) = 0.10 \\times 0.15 = 0.015$$\n\n4.  $D=0$ 时的朴素贝叶斯条件概率：NB模型同样假设条件独立：\n    $$P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0) = P(X_{1}=1 \\mid D=0) P(X_{2}=1 \\mid D=0) = 0.10 \\times 0.15 = 0.015$$\n\n由于对于 $D=0$ 类别，特征是真实条件独立的，因此NB假设成立，且 $P(X_{1}=1, X_{2}=1 \\mid D=0) = P_{\\text{NB}}(X_{1}=1, X_{2}=1 \\mid D=0)$。这两项的比率为 $1$。\n\n将这些值代入偏差 $B$ 的表达式中：\n$$\nB = \\frac{0.42}{0.55} \\times \\frac{0.015}{0.015} = \\frac{0.42}{0.55} \\times 1\n$$\n$$\nB = \\frac{0.42}{0.55}\n$$\n进行除法运算：\n$$\nB \\approx 0.76363636...\n$$\n按照要求，将结果四舍五入到四位有效数字，我们得到：\n$$\nB \\approx 0.7636\n$$\n这个偏差因子小于 $1$，表明朴素贝叶斯分类器低估了两种生物标志物均过表达的患者的疾病后验优势比，因为它未能考虑患病人群中特征之间的正向条件依赖性。",
            "answer": "$$\\boxed{0.7636}$$"
        },
        {
            "introduction": "在认识到严格独立性假设的局限性后，下一步自然是放宽这一假设。本练习将介绍半朴素贝叶斯分类器，这是一种强大的混合模型，它将特征分组，假设组间独立，但允许组内特征存在依赖关系。你将构建这样一个模型，结合不同的概率分布来处理多样化的数据类型，并了解它如何提供一个更精细、更准确的诊断工具。",
            "id": "4588344",
            "problem": "考虑一个二元疾病变量 $Y \\in \\{0,1\\}$，其中 $Y=1$ 表示由感染引起的急性全身性炎症，$Y=0$ 表示无感染。现有从一名患者身上测得的两个特征组：一个是由C-反应蛋白（mg/L）和白细胞介素-6（pg/mL）组成的生物标志物组 $\\mathbf{X}=(X_1, X_2)$，另一个是由咳嗽 $(S_1 \\in \\{0,1\\})$ 和发烧 $(S_2 \\in \\{0,1\\})$ 的二元指标组成的症状组 $\\mathbf{S}=(S_1,S_2)$。先验概率为 $p(Y=1)=0.25$ 和 $p(Y=0)=0.75$。\n\n为了放宽经典朴素贝叶斯分类器的特征独立性假设，我们假设一个带有分组特征的半朴素贝叶斯（SNB）模型：各组在给定 $Y$ 的条件下是条件独立的，但组内特征可能相关，并通过适当的组内分布进行建模。基本推导应从贝叶斯定理 $p(y \\mid \\text{data}) \\propto p(y)\\,p(\\text{data} \\mid y)$ 和全概率定律开始。\n\n假设以下科学上合理的组内模型：\n\n- 生物标志物由以 $Y$ 为条件的二元多元正态（MVN）分布建模，其参数为\n$$\n\\boldsymbol{\\mu}_1=\\begin{pmatrix}35\\\\20\\end{pmatrix},\\quad\n\\boldsymbol{\\Sigma}_1=\\begin{pmatrix}100  40\\\\ 40  25\\end{pmatrix}\n\\quad\\text{对于 }Y=1,\n$$\n$$\n\\boldsymbol{\\mu}_0=\\begin{pmatrix}10\\\\5\\end{pmatrix},\\quad\n\\boldsymbol{\\Sigma}_0=\\begin{pmatrix}64  0\\\\ 0  16\\end{pmatrix}\n\\quad\\text{对于 }Y=0.\n$$\n\n- 症状由以 $Y$ 为条件的联合伯努利分布建模，其参数为\n$$\np(S_1=1,S_2=1\\mid Y=1)=0.50,\\;\np(S_1=1,S_2=0\\mid Y=1)=0.10,\\;\np(S_1=0,S_2=1\\mid Y=1)=0.30,\\;\np(S_1=0,S_2=0\\mid Y=1)=0.10,\n$$\n$$\np(S_1=1,S_2=1\\mid Y=0)=0.05,\\;\np(S_1=1,S_2=0\\mid Y=0)=0.10,\\;\np(S_1=0,S_2=1\\mid Y=0)=0.15,\\;\np(S_1=0,S_2=0\\mid Y=0)=0.70.\n$$\n\n一名患者的数据为 $X_1=30$，$X_2=15$，$S_1=1$ 和 $S_2=1$。从贝叶斯定理和SNB分组条件独立性假设出发，推导出分组似然形式 $p(\\mathbf{X},\\mathbf{S}\\mid Y=y)$，并用指定的组内模型进行实例化，然后计算后验概率 $p(Y=1\\mid \\mathbf{X}=(30,15), \\mathbf{S}=(1,1))$，结果表示为一个实数。将最终数值答案以小数形式表示。将答案四舍五入到 $4$ 位有效数字。",
            "solution": "首先，验证问题是有科学依据的、良定的、客观的和完整的。所有必要的参数，包括先验概率，以及两个不同特征组（生物标志物和症状）的条件似然模型均已提供。多元正态（MVN）分布的协方差矩阵是正定的，联合伯努利分布的概率是有效的。该问题是使用半朴素贝叶斯模型进行贝叶斯推断的一个标准应用，可以推导出唯一且有意义的解。\n\n目标是计算在给定一组生物标志物 $\\mathbf{X}$ 和症状 $\\mathbf{S}$ 的测量值的情况下，患者患有疾病（$Y=1$）的后验概率。具体的患者数据为 $\\mathbf{x} = \\begin{pmatrix}X_1\\\\X_2\\end{pmatrix} = \\begin{pmatrix}30\\\\15\\end{pmatrix}$ 和 $\\mathbf{s} = (S_1, S_2) = (1, 1)$。我们旨在求得 $p(Y=1 \\mid \\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s})$。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$\np(Y=y \\mid \\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s}) = \\frac{p(\\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s} \\mid Y=y) p(Y=y)}{p(\\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s})}\n$$\n分母 $p(\\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s})$ 是边际似然或证据，它作为一个归一化常数。它是使用全概率定律计算的：\n$$\np(\\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s}) = \\sum_{j \\in \\{0,1\\}} p(\\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s} \\mid Y=j) p(Y=j)\n$$\n因此，对于 $Y=1$ 的情况，后验概率为：\n$$\np(Y=1 \\mid \\mathbf{x}, \\mathbf{s}) = \\frac{p(\\mathbf{x}, \\mathbf{s} \\mid Y=1) p(Y=1)}{p(\\mathbf{x}, \\mathbf{s} \\mid Y=1) p(Y=1) + p(\\mathbf{x}, \\mathbf{s} \\mid Y=0) p(Y=0)}\n$$\n半朴素贝叶斯（SNB）模型假设特征组 $\\mathbf{X}$ 和 $\\mathbf{S}$ 在给定类变量 $Y$ 的条件下是条件独立的。这使我们能够将联合条件似然写成组内条件似然的乘积：\n$$\np(\\mathbf{X}=\\mathbf{x}, \\mathbf{S}=\\mathbf{s} \\mid Y=y) = p(\\mathbf{X}=\\mathbf{x} \\mid Y=y) p(\\mathbf{S}=\\mathbf{s} \\mid Y=y)\n$$\n为了简化计算，我们可以计算每个类别的未归一化后验得分，称之为 $A_1$ 和 $A_0$，然后进行归一化。\n$$\nA_y = p(\\mathbf{x} \\mid Y=y) p(\\mathbf{s} \\mid Y=y) p(Y=y)\n$$\n那么，所求的后验概率为 $p(Y=1 \\mid \\mathbf{x}, \\mathbf{s}) = \\frac{A_1}{A_1 + A_0}$。\n\n首先，我们计算类别 $Y=1$（感染）的得分 $A_1$。\n先验概率给定为 $p(Y=1)=0.25$。\n症状 $\\mathbf{s}=(1,1)$ 的条件似然给定为 $p(S_1=1, S_2=1 \\mid Y=1) = 0.50$。\n生物标志物 $\\mathbf{X}$ 的条件似然由一个二元MVN概率密度函数（PDF）$f(\\mathbf{x}; \\boldsymbol{\\mu}_1, \\boldsymbol{\\Sigma}_1)$ 给出，其中 $k=2$：\n$$\np(\\mathbf{x} \\mid Y=1) = \\frac{1}{(2\\pi)^{k/2} |\\boldsymbol{\\Sigma}_1|^{1/2}} \\exp\\left(-\\frac{1}{2} (\\mathbf{x}-\\boldsymbol{\\mu}_1)^T \\boldsymbol{\\Sigma}_1^{-1} (\\mathbf{x}-\\boldsymbol{\\mu}_1)\\right)\n$$\n$Y=1$ 的参数是 $\\boldsymbol{\\mu}_1=\\begin{pmatrix}35\\\\20\\end{pmatrix}$ 和 $\\boldsymbol{\\Sigma}_1=\\begin{pmatrix}100  40\\\\ 40  25\\end{pmatrix}$。\n数据向量为 $\\mathbf{x}=\\begin{pmatrix}30\\\\15\\end{pmatrix}$，因此偏差为 $\\mathbf{x}-\\boldsymbol{\\mu}_1 = \\begin{pmatrix}30-35\\\\15-20\\end{pmatrix} = \\begin{pmatrix}-5\\\\-5\\end{pmatrix}$。\n协方差矩阵的行列式为 $|\\boldsymbol{\\Sigma}_1| = (100)(25) - (40)(40) = 2500 - 1600 = 900$。\n逆矩阵为 $\\boldsymbol{\\Sigma}_1^{-1} = \\frac{1}{900}\\begin{pmatrix}25  -40\\\\-40  100\\end{pmatrix}$。\n马氏距离的平方是：\n$$\n(\\mathbf{x}-\\boldsymbol{\\mu}_1)^T \\boldsymbol{\\Sigma}_1^{-1} (\\mathbf{x}-\\boldsymbol{\\mu}_1) = \\begin{pmatrix}-5  -5\\end{pmatrix} \\frac{1}{900}\\begin{pmatrix}25  -40\\\\-40  100\\end{pmatrix} \\begin{pmatrix}-5\\\\-5\\end{pmatrix} = \\frac{1}{900} \\begin{pmatrix}-5  -5\\end{pmatrix} \\begin{pmatrix}75\\\\-300\\end{pmatrix} = \\frac{1}{900}(-375+1500) = \\frac{1125}{900} = 1.25\n$$\n似然值为 $p(\\mathbf{x} \\mid Y=1) = \\frac{1}{2\\pi\\sqrt{900}} \\exp\\left(-\\frac{1.25}{2}\\right) = \\frac{1}{60\\pi} \\exp(-0.625)$。\n现在，我们计算 $A_1$：\n$$\nA_1 = \\left(\\frac{1}{60\\pi} \\exp(-0.625)\\right) \\times 0.50 \\times 0.25 = \\frac{0.125}{60\\pi} \\exp(-0.625)\n$$\n$A_1 \\approx (0.002839655) \\times 0.125 \\approx 0.000354957$。\n\n接下来，我们计算类别 $Y=0$（无感染）的得分 $A_0$。\n先验概率为 $p(Y=0)=0.75$。\n症状的条件似然为 $p(S_1=1, S_2=1 \\mid Y=0) = 0.05$。\n生物标志物的条件似然为 $f(\\mathbf{x}; \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0)$，其 $Y=0$ 时的参数为：$\\boldsymbol{\\mu}_0=\\begin{pmatrix}10\\\\5\\end{pmatrix}$ 和 $\\boldsymbol{\\Sigma}_0=\\begin{pmatrix}64  0\\\\ 0  16\\end{pmatrix}$。\n偏差为 $\\mathbf{x}-\\boldsymbol{\\mu}_0 = \\begin{pmatrix}30-10\\\\15-5\\end{pmatrix} = \\begin{pmatrix}20\\\\10\\end{pmatrix}$。\n行列式为 $|\\boldsymbol{\\Sigma}_0| = (64)(16) = 1024$。\n逆矩阵为 $\\boldsymbol{\\Sigma}_0^{-1} = \\begin{pmatrix}1/64  0\\\\ 0  1/16\\end{pmatrix}$。\n马氏距离的平方是：\n$$\n(\\mathbf{x}-\\boldsymbol{\\mu}_0)^T \\boldsymbol{\\Sigma}_0^{-1} (\\mathbf{x}-\\boldsymbol{\\mu}_0) = \\begin{pmatrix}20  10\\end{pmatrix} \\begin{pmatrix}1/64  0\\\\0  1/16\\end{pmatrix} \\begin{pmatrix}20\\\\10\\end{pmatrix} = \\frac{20^2}{64} + \\frac{10^2}{16} = \\frac{400}{64} + \\frac{100}{16} = 6.25 + 6.25 = 12.5\n$$\n似然值为 $p(\\mathbf{x} \\mid Y=0) = \\frac{1}{2\\pi\\sqrt{1024}} \\exp\\left(-\\frac{12.5}{2}\\right) = \\frac{1}{64\\pi} \\exp(-6.25)$。\n现在，我们计算 $A_0$：\n$$\nA_0 = \\left(\\frac{1}{64\\pi} \\exp(-6.25)\\right) \\times 0.05 \\times 0.75 = \\frac{0.0375}{64\\pi} \\exp(-6.25)\n$$\n$A_0 \\approx (9.59869 \\times 10^{-6}) \\times 0.0375 \\approx 3.5995 \\times 10^{-7}$。\n\n最后，我们计算后验概率：\n$$\np(Y=1 \\mid \\mathbf{x}, \\mathbf{s}) = \\frac{A_1}{A_1 + A_0} = \\frac{0.000354957}{0.000354957 + 0.00000035995} = \\frac{0.000354957}{0.000355317} \\approx 0.9989869\n$$\n将最终答案四舍五入到 $4$ 位有效数字，我们得到 $0.9990$。",
            "answer": "$$\\boxed{0.9990}$$"
        }
    ]
}