{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本节的第一个练习将探讨在类别不平衡的数据集中，标准准确率可能产生的误导性。我们将通过一个脓毒症早期检测的实际场景，计算并比较标准准确率和平衡准确率，从而直观地理解为什么后者能为我们提供更公正的模型性能评估。",
            "id": "4561150",
            "problem": "一个医院质量改进团队正在评估一个用于从成人重症监护室的电子健康记录中早期检测Sepsis-3的二元分类器。测试集包含 $N$ 个患者事件，每个事件都被临床医生在 $6$ 小时的预测窗口内标记为脓毒症阳性或脓毒症阴性。评估得出以下混淆矩阵计数：真正例 (TP) 案例 $TP = 280$，假正例 (FP) 案例 $FP = 2880$，真负例 (TN) 案例 $TN = 16320$，以及假负例 (FN) 案例 $FN = 520$。使用基于混淆矩阵的类别条件率和总体正确性的规范定义，计算该分类器的标准准确率和平衡准确率。然后，将其差异量化为 $($标准准确率$)$ $-$ $($平衡准确率$)$ 定义的差值。仅报告此差异作为您的最终数值答案，表示为小数并四舍五入到四位有效数字。",
            "solution": "用户要求基于所提供的混淆矩阵，计算一个二元分类器的标准准确率与平衡准确率之间的差异。\n\n首先，需要对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n问题提供了一个二元分类任务的混淆矩阵中的以下计数：\n-   真正例：$TP = 280$\n-   假正例：$FP = 2880$\n-   真负例：$TN = 16320$\n-   假负例：$FN = 520$\n任务是计算差值：$($标准准确率$)$ $-$ $($平衡准确率$)$，并报告四舍五入到四位有效数字的结果。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据，使用了机器学习和医学统计学领域的标准且明确定义的度量标准（准确率、平衡准确率、混淆矩阵）。Sepsis-3 检测的背景是生物信息学中一个有效且重要的研究领域。所提供的数据是数值计数，内部是一致的。患者事件的总数 $N$ 可以通过所有混淆矩阵条目的总和来计算。该问题提法恰当、客观，并包含推导出唯一解所需的所有必要信息。没有违反任何科学原理，数据虽然表明数据集高度不平衡，但对于一个真实的医学筛查场景来说是合理的。\n\n**结论**\n问题有效。可以开始求解过程。\n\n**求解推导**\n目标是计算差异 $\\Delta$，其定义为标准准确率 ($ACC$) 和平衡准确率 ($BA$) 之间的差值。\n$$ \\Delta = ACC - BA $$\n\n首先，我们定义标准准确率。它是所有正确预测数与总预测数的比率。\n$$ ACC = \\frac{TP + TN}{TP + FP + TN + FN} $$\n\n接下来，我们定义平衡准确率。它是真正例率 ($TPR$) 和真负例率 ($TNR$) 的算术平均值。\n$$ BA = \\frac{TPR + TNR}{2} $$\n\n真正例率，也称为灵敏度或召回率，是实际正例中被正确识别的比例。\n$$ TPR = \\frac{TP}{TP + FN} $$\n\n真负例率，也称为特异度，是实际负例中被正确识别的比例。\n$$ TNR = \\frac{TN}{TN + FP} $$\n\n现在我们将给定值代入这些定义中。\n-   $TP = 280$\n-   $FP = 2880$\n-   $TN = 16320$\n-   $FN = 520$\n\n首先，我们计算样本总数 $N$。\n$$ N = TP + FP + TN + FN = 280 + 2880 + 16320 + 520 = 20000 $$\n\n现在，我们计算标准准确率 ($ACC$)。\n$$ ACC = \\frac{TP + TN}{N} = \\frac{280 + 16320}{20000} = \\frac{16600}{20000} = 0.83 $$\n\n接下来，我们计算实际正例数 ($P$) 和实际负例数 ($N_{neg}$)。\n-   实际正例：$P = TP + FN = 280 + 520 = 800$\n-   实际负例：$N_{neg} = TN + FP = 16320 + 2880 = 19200$\n\n我们现在可以计算 $TPR$ 和 $TNR$。\n$$ TPR = \\frac{TP}{P} = \\frac{280}{800} = \\frac{28}{80} = \\frac{7}{20} = 0.35 $$\n$$ TNR = \\frac{TN}{N_{neg}} = \\frac{16320}{19200} = \\frac{1632}{1920} = \\frac{17 \\times 96}{20 \\times 96} = \\frac{17}{20} = 0.85 $$\n\n利用 $TPR$ 和 $TNR$，我们计算平衡准确率 ($BA$)。\n$$ BA = \\frac{TPR + TNR}{2} = \\frac{0.35 + 0.85}{2} = \\frac{1.20}{2} = 0.60 $$\n\n最后，我们计算所要求的差异 $\\Delta$。\n$$ \\Delta = ACC - BA = 0.83 - 0.60 = 0.23 $$\n\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。计算出的值 $0.23$ 可以写成 $0.2300$ 以满足此要求。这种差异凸显了在类别不平衡的情况下，标准准确率可能是一个具有误导性的指标。$83\\%$ 的高准确率主要是由模型正确分类占多数的负类的能力驱动的，而 $60\\%$ 的平衡准确率通过对正类和负类的性能给予同等权重，提供了一个更真实的评估，揭示了模型在临床上至关重要的正类（脓毒症）上表现不佳（$TPR = 35\\%$）。",
            "answer": "$$\\boxed{0.2300}$$"
        },
        {
            "introduction": "在理解了标准准确率的局限性后，我们来看一个更极端的例子，以深化对类别不平衡问题的认识。这个练习模拟了在大型生物样本库中筛选罕见药物不良反应的场景，在这种情况下，准确率指标会彻底失效。通过构建并分析不同的混淆矩阵，您将发现即使分类器达到接近完美的准确率，其 $F_1$ 分数也可能趋近于零，这表明模型在识别关键的少数类方面可能毫无价值。",
            "id": "4561157",
            "problem": "在一个生物样本库队列中，使用一个二元分类器来筛选一种罕见的药物不良反应表型。设队列大小为 $N = 100000$，疾病患病率为 $\\pi = 0.001$，因此真正阳性的个体数量为 $P = \\pi N = 100$，真正阴性的个体数量为 $N - P = 99900$。对于任何二元分类器，混淆矩阵的计数定义为真阳性 (TP)、假阳性 (FP)、真阴性 (TN) 和假阴性 (FN)。分类中的标准评估指标，即准确率 (accuracy)、精确率 (precision)、召回率 (recall) 和 $F_1$ 分数（$F_1$ 分数是精确率和召回率的调和平均数），是通过它们的基本定义从这些计数中推导出来的。\n\n考虑同一模型的五个候选工作点，每个工作点在该队列上产生不同的混淆矩阵。仅使用混淆矩阵计数和上述评估指标的基本定义，确定哪些选项同时表现出高准确率（准确率至少为 $99\\%$）和接近于零的 $F_1$ 分数（$F_1 \\le 0.02$）。\n\n选择所有适用项。\n\nA. $(TP, FP, TN, FN) = (0, 0, 99900, 100)$\n\nB. $(TP, FP, TN, FN) = (1, 9, 99891, 99)$\n\nC. $(TP, FP, TN, FN) = (80, 20, 99880, 20)$\n\nD. $(TP, FP, TN, FN) = (20, 5000, 94900, 80)$\n\nE. $(TP, FP, TN, FN) = (5, 500, 99400, 95)$",
            "solution": "在进行求解之前，将对问题陈述进行验证。\n\n### 第1步：提取已知条件\n\n- 队列大小：$N = 100000$\n- 疾病患病率：$\\pi = 0.001$\n- 真正阳性的个体数量（病例）：$P = \\pi N = 0.001 \\times 100000 = 100$\n- 真正阴性的个体数量（对照）：$N - P = 100000 - 100 = 99900$\n- 混淆矩阵计数：真阳性 ($TP$)、假阳性 ($FP$)、真阴性 ($TN$)、假阴性 ($FN$)。\n- 评估指标：准确率、精确率、召回率和 $F_1$ 分数。\n- $F_1$ 分数定义：精确率和召回率的调和平均数。\n- 选择条件：\n    1. 准确率 $\\ge 99\\%$ (即 $\\ge 0.99$)\n    2. $F_1$ 分数 $\\le 0.02$\n- 候选工作点，以 $(TP, FP, TN, FN)$ 元组形式表示：\n    - A: $(0, 0, 99900, 100)$\n    - B: $(1, 9, 99891, 99)$\n    - C: $(80, 20, 99880, 20)$\n    - D: $(20, 5000, 94900, 80)$\n    - E: $(5, 500, 99400, 95)$\n\n### 第2步：使用提取的已知条件进行验证\n\n必须评估问题陈述的科学合理性、一致性和适定性。\n\n1.  **科学依据和客观性**：该问题基于机器学习、统计学和生物信息学中使用的分类评估指标的标准、普遍接受的定义。所有术语都是客观且精确定义的。\n2.  **适定性和一致性**：一个关键的一致性检查是，每个选项提供的混淆矩阵计数之和是否等于正确的阳性和阴性病例数。\n    - 总阳性数必须等于 $P = TP + FN = 100$。\n    - 总阴性数必须等于 $N - P = TN + FP = 99900$。\n\n    我们来检查每个选项：\n    - **A**: $TP + FN = 0 + 100 = 100$。$TN + FP = 99900 + 0 = 99900$。**一致。**\n    - **B**: $TP + FN = 1 + 99 = 100$。$TN + FP = 99891 + 9 = 99900$。**一致。**\n    - **C**: $TP + FN = 80 + 20 = 100$。$TN + FP = 99880 + 20 = 99900$。**一致。**\n    - **D**: $TP + FN = 20 + 80 = 100$。$TN + FP = 94900 + 5000 = 99900$。**一致。**\n    - **E**: $TP + FN = 5 + 95 = 100$。$TN + FP = 99400 + 500 = 99900$。**一致。**\n\n所有选项都与指定的队列构成内部一致。问题陈述明确无歧义，提供了所有必要的信息，并且没有违反任何科学或数学原理。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。将推导解答。\n\n### 指标推导与选项分析\n\n所需的评估指标定义如下：\n\n-   **准确率 (Accuracy)**：$Accuracy = \\frac{TP + TN}{TP + FP + TN + FN} = \\frac{TP + TN}{N}$\n-   **精确率 (Precision)**：$Precision = \\frac{TP}{TP + FP}$\n-   **召回率 (Recall)**：$Recall = \\frac{TP}{TP + FN} = \\frac{TP}{P}$\n-   **$F_1$ 分数 ($F_1$-score)**：精确率和召回率的调和平均数。\n    $$F_1 = \\frac{2 \\cdot Precision \\cdot Recall}{Precision + Recall} = \\frac{2TP}{2TP + FP + FN}$$\n    如果 $TP = 0$，则精确率 (Precision) 和召回率 (Recall) 均为 $0$，按照惯例，$F_1 = 0$。所提供的公式对这种情况是鲁棒的。\n\n需要满足的条件是 $Accuracy \\ge 0.99$ 和 $F_1 \\le 0.02$。我们现在将根据这两个条件评估每个选项。\n\n#### 选项 A：$(TP, FP, TN, FN) = (0, 0, 99900, 100)$\n\n-   **准确率**：\n    $$Accuracy = \\frac{0 + 99900}{100000} = 0.999$$\n    条件 $0.999 \\ge 0.99$ **满足**。\n-   **$F_1$ 分数**：\n    由于 $TP = 0$，根据定义，$F_1 = 0$。\n    条件 $0 \\le 0.02$ **满足**。\n\n两个条件都满足。因此，选项A是正确的。\n\n#### 选项 B：$(TP, FP, TN, FN) = (1, 9, 99891, 99)$\n\n-   **准确率**：\n    $$Accuracy = \\frac{1 + 99891}{100000} = \\frac{99892}{100000} = 0.99892$$\n    条件 $0.99892 \\ge 0.99$ **满足**。\n-   **$F_1$ 分数**：\n    $$F_1 = \\frac{2TP}{2TP + FP + FN} = \\frac{2 \\cdot 1}{2 \\cdot 1 + 9 + 99} = \\frac{2}{2 + 108} = \\frac{2}{110} \\approx 0.01818$$\n    条件 $0.01818 \\le 0.02$ **满足**。\n\n两个条件都满足。因此，选项B是正确的。\n\n#### 选项 C：$(TP, FP, TN, FN) = (80, 20, 99880, 20)$\n\n-   **准确率**：\n    $$Accuracy = \\frac{80 + 99880}{100000} = \\frac{99960}{100000} = 0.9996$$\n    条件 $0.9996 \\ge 0.99$ **满足**。\n-   **$F_1$ 分数**：\n    $$F_1 = \\frac{2TP}{2TP + FP + FN} = \\frac{2 \\cdot 80}{2 \\cdot 80 + 20 + 20} = \\frac{160}{160 + 40} = \\frac{160}{200} = 0.8$$\n    条件 $0.8 \\le 0.02$ **不满足**。\n\n一个条件不满足。因此，选项C是不正确的。\n\n#### 选项 D：$(TP, FP, TN, FN) = (20, 5000, 94900, 80)$\n\n-   **准确率**：\n    $$Accuracy = \\frac{20 + 94900}{100000} = \\frac{94920}{100000} = 0.9492$$\n    条件 $0.9492 \\ge 0.99$ **不满足**。\n\n由于准确率条件不满足，无需计算 $F_1$ 分数。因此，选项D是不正确的。\n\n#### 选项 E：$(TP, FP, TN, FN) = (5, 500, 99400, 95)$\n\n-   **准确率**：\n    $$Accuracy = \\frac{5 + 99400}{100000} = \\frac{99405}{100000} = 0.99405$$\n    条件 $0.99405 \\ge 0.99$ **满足**。\n-   **$F_1$ 分数**：\n    $$F_1 = \\frac{2TP}{2TP + FP + FN} = \\frac{2 \\cdot 5}{2 \\cdot 5 + 500 + 95} = \\frac{10}{10 + 595} = \\frac{10}{605} = \\frac{2}{121} \\approx 0.01653$$\n    条件 $0.01653 \\le 0.02$ **满足**。\n\n两个条件都满足。因此，选项E是正确的。\n\n### 选项评估总结\n- **选项A**：准确率为 $99.9\\%$。$F_1$ 分数为 $0$。**正确。**\n- **选项B**：准确率为 $99.892\\%$。$F_1$ 分数约为 $\\approx 0.0182$。**正确。**\n- **选项C**：准确率为 $99.96\\%$。$F_1$ 分数为 $0.8$。**不正确。**\n- **选项D**：准确率为 $94.92\\%$。**不正确。**\n- **选项E**：准确率为 $99.405\\%$。$F_1$ 分数约为 $\\approx 0.0165$。**正确。**\n\n满足两个条件（$Accuracy \\ge 0.99$ 和 $F_1 \\le 0.02$）的选项是 A、B 和 E。",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "前面的练习处理的是硬性分类标签，但许多现代分类器会输出概率分数。此练习将我们的讨论从混淆矩阵计数推进到对连续分数分布的评估。我们将探讨接收者操作特征曲线下面积 (AUC) 与阳性预测值 (PPV) 之间的重要区别，这两个指标在评估概率模型时至关重要。通过一个基于高斯分布的假设场景，您将从第一性原理出发进行推导，揭示为何一个具有高 AUC（优异的排序能力）的模型在应用于罕见事件预测时，其 PPV（实际临床效用）可能非常低。",
            "id": "3118923",
            "problem": "一个二元分类器产生一个连续分数 $S$，通过设置阈值来决定类别归属：如果 $S \\ge \\tau$，则预测 $\\hat{Y} = 1$，否则预测 $\\hat{Y} = 0$。假设类条件分数分布是具有等方差和位置偏移的高斯分布：$S \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ 和 $S \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$，其中 $\\mu_{0} = 0$，$\\mu_{1} = 0.2$，$\\sigma = 0.1$。阳性类的患病率为 $\\pi = \\mathbb{P}(Y=1) = 0.001$，代表一个极度不平衡的场景。使用以下核心定义：受试者工作特征（ROC）曲线下面积（AUC）为 $AUC = \\mathbb{P}(S_{1}  S_{0})$，其中 $S_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ 和 $S_{0} \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$ 是独立的；在阈值 $\\tau$ 下的真阳性率（TPR）和假阳性率（FPR）分别为 $\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)$ 和 $\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=0)$；在阈值 $\\tau$ 下的阳性预测值（PPV）为 $\\mathrm{PPV}(\\tau) = \\mathbb{P}(Y=1 \\mid S \\ge \\tau)$。\n\n从这些定义出发，不使用任何预先推导的快捷公式，完成以下任务：\n1. 使用所述高斯模型从第一性原理推导 $AUC$，并用数值验证 $AUC  0.9$。\n2. 为高斯模型推导 $\\mathrm{TPR}(\\tau)$ 和 $\\mathrm{FPR}(\\tau)$，然后使用贝叶斯法则将 $\\mathrm{PPV}(\\tau)$ 表示为 $\\pi$、$\\mathrm{TPR}(\\tau)$ 和 $\\mathrm{FPR}(\\tau)$ 的函数。将满足 $\\mathrm{TPR}(\\tau) \\ge 0.5$ 的阈值定义为“合理阈值”。指出在该集合中哪个 $\\tau$ 值可以最大化 $\\mathrm{PPV}(\\tau)$，并计算相应的最大 $\\mathrm{PPV}$ 值。将最终数值答案四舍五入到四位有效数字，并以纯小数形式表示（不带百分号）。\n\n最后，解释结果，说明为什么在极度不平衡的情况下，报告阳性预测值（PPV）和受试者工作特征曲线下面积（AUC）对于理解实际效用是必要的。\n\n仅提供在约束条件 $\\mathrm{TPR}(\\tau) \\ge 0.5$ 下的最大 $\\mathrm{PPV}$ 的数值，四舍五入到四位有效数字，作为你的最终答案。",
            "solution": "该问题被评估为有效，因为它在科学上基于概率论和统计学习，定义和参数齐全，问题明确且客观。没有矛盾、歧义或事实错误。\n\n该问题要求对特定高斯模型下的二元分类器评估指标进行多部分推导和计算。\n\n**第一部分：AUC 的推导与验证**\n\nROC 曲线下面积（AUC）定义为一个随机抽取的阳性实例的分数高于一个随机抽取的阴性实例的分数的概率：$AUC = \\mathbb{P}(S_{1}  S_{0})$。这里，$S_{1} \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ 和 $S_{0} \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$ 分别是代表阳性类和阴性类分数的独立随机变量。\n\n我们定义一个新的随机变量 $D = S_{1} - S_{0}$。我们希望计算的概率是 $\\mathbb{P}(D  0)$。由于 $S_{1}$ 和 $S_{0}$ 是独立的高斯随机变量，它们的差 $D$ 也是一个高斯随机变量。其均值和方差为：\n$$\n\\mathbb{E}[D] = \\mathbb{E}[S_{1}] - \\mathbb{E}[S_{0}] = \\mu_{1} - \\mu_{0}\n$$\n$$\n\\mathrm{Var}(D) = \\mathrm{Var}(S_{1} - S_{0}) = \\mathrm{Var}(S_{1}) + (-1)^{2}\\mathrm{Var}(S_{0}) = \\sigma^{2} + \\sigma^{2} = 2\\sigma^{2}\n$$\n所以，$D \\sim \\mathcal{N}(\\mu_{1} - \\mu_{0}, 2\\sigma^{2})$。为了求 $\\mathbb{P}(D  0)$，我们对变量 $D$ 进行标准化：\n$$\n\\mathbb{P}(D  0) = \\mathbb{P}\\left(\\frac{D - (\\mu_{1} - \\mu_{0})}{\\sqrt{2\\sigma^{2}}}  \\frac{0 - (\\mu_{1} - \\mu_{0})}{\\sqrt{2\\sigma^{2}}}\\right)\n$$\n令 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。表达式变为：\n$$\nAUC = \\mathbb{P}\\left(Z  -\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\n$$\n利用标准正态分布的对称性，$\\mathbb{P}(Z  -z) = \\mathbb{P}(Z  z)$，这是标准正态分布的累积分布函数（CDF），记为 $\\Phi(z)$。\n$$\nAUC = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{\\sigma\\sqrt{2}}\\right)\n$$\n我们已知 $\\mu_{1} = 0.2$，$\\mu_{0} = 0$，以及 $\\sigma = 0.1$。代入这些值：\n$$\nAUC = \\Phi\\left(\\frac{0.2 - 0}{0.1\\sqrt{2}}\\right) = \\Phi\\left(\\frac{2}{\\sqrt{2}}\\right) = \\Phi(\\sqrt{2})\n$$\n数值上，$\\sqrt{2} \\approx 1.414$。标准正态累积分布函数的值是 $\\Phi(1.414) \\approx 0.92135$。这个值大于 $0.9$，证实了问题中所述的条件。\n\n**第二部分：PPV 的推导与最大化**\n\n首先，我们推导在给定阈值 $\\tau$ 下的真阳性率（$\\mathrm{TPR}$）和假阳性率（$\\mathrm{FPR}$）的表达式。\n$\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)$。阳性类的分数分布为 $S \\mid Y=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$。\n$$\n\\mathrm{TPR}(\\tau) = \\mathbb{P}\\left(\\frac{S - \\mu_{1}}{\\sigma} \\ge \\frac{\\tau - \\mu_{1}}{\\sigma} \\mid Y=1\\right) = \\mathbb{P}\\left(Z \\ge \\frac{\\tau - \\mu_{1}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)\n$$\n$\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=0)$。阴性类的分数分布为 $S \\mid Y=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$。\n$$\n\\mathrm{FPR}(\\tau) = \\mathbb{P}\\left(\\frac{S - \\mu_{0}}{\\sigma} \\ge \\frac{\\tau - \\mu_{0}}{\\sigma} \\mid Y=0\\right) = \\mathbb{P}\\left(Z \\ge \\frac{\\tau - \\mu_{0}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right)\n$$\n接下来，我们使用贝叶斯法则来表示阳性预测值（$\\mathrm{PPV}$）。\n$$\n\\mathrm{PPV}(\\tau) = \\mathbb{P}(Y=1 \\mid S \\ge \\tau) = \\frac{\\mathbb{P}(S \\ge \\tau \\mid Y=1) \\mathbb{P}(Y=1)}{\\mathbb{P}(S \\ge \\tau)}\n$$\n分母是全概率 $\\mathbb{P}(S \\ge \\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)\\mathbb{P}(Y=1) + \\mathbb{P}(S \\ge \\tau \\mid Y=0)\\mathbb{P}(Y=0)$。\n使用先验定义和患病率 $\\pi = \\mathbb{P}(Y=1)$：\n$$\n\\mathrm{PPV}(\\tau) = \\frac{\\mathrm{TPR}(\\tau) \\cdot \\pi}{\\mathrm{TPR}(\\tau) \\cdot \\pi + \\mathrm{FPR}(\\tau) \\cdot (1-\\pi)}\n$$\n我们需要在由 $\\mathrm{TPR}(\\tau) \\ge 0.5$ 定义的“合理阈值”范围内最大化这个 $\\mathrm{PPV}(\\tau)$。\n$$\n\\mathrm{TPR}(\\tau) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right) \\ge 0.5 \\implies \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right) \\le 0.5\n$$\n由于 $\\Phi(z)$ 是一个单调递增函数且 $\\Phi(0) = 0.5$，这个不等式等价于：\n$$\n\\frac{\\tau - \\mu_{1}}{\\sigma} \\le 0 \\implies \\tau \\le \\mu_{1}\n$$\n所以，合理阈值的集合是区间 $(-\\infty, \\mu_{1}]$。为了最大化 $\\mathrm{PPV}(\\tau)$，我们可以分析似然比 $L(\\tau) = \\frac{\\mathrm{TPR}(\\tau)}{\\mathrm{FPR}(\\tau)}$ 的行为，因为 $\\mathrm{PPV}(\\tau) = \\frac{L(\\tau)\\pi}{L(\\tau)\\pi + (1-\\pi)}$ 是 $L(\\tau)$ 的一个单调递增函数。\n$$\nL(\\tau) = \\frac{1 - \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)}{1 - \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right)}\n$$\n$\\ln(L(\\tau))$ 对 $\\tau$ 的导数由下式给出：\n$$\n\\frac{d}{d\\tau}\\ln(L(\\tau)) = \\frac{1}{\\sigma}\\left[ \\frac{\\phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right)}{1 - \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right)} - \\frac{\\phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)}{1 - \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)} \\right]\n$$\n其中 $\\phi(z)$ 是标准正态概率密度函数（PDF）。$h(z) = \\frac{\\phi(z)}{1-\\Phi(z)}$ 这一项是标准正态分布的风险率，它是 $z$ 的一个严格递增函数。\n由于 $\\mu_{1}  \\mu_{0}$，我们有 $\\frac{\\tau - \\mu_{1}}{\\sigma}  \\frac{\\tau - \\mu_{0}}{\\sigma}$。因为 $h(z)$ 是递增的，所以 $h\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)  h\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right)$。因此，导数 $\\frac{d}{d\\tau}\\ln(L(\\tau))$ 总是正的。这意味着 $L(\\tau)$ 是 $\\tau$ 的一个单调递增函数，因此 $\\mathrm{PPV}(\\tau)$ 也随 $\\tau$ 单调递增。\n\n为了在集合 $\\tau \\in (-\\infty, \\mu_{1}]$ 上最大化 $\\mathrm{PPV}(\\tau)$，我们必须选择 $\\tau$ 的最大可能值，即区间的右边界 $\\tau = \\mu_{1}$。\n\n因此，最大 PPV 在 $\\tau = \\mu_{1} = 0.2$ 时取得。我们来计算这个值。\n当 $\\tau = 0.2$ 时：\n$$\n\\mathrm{TPR}(0.2) = 1 - \\Phi\\left(\\frac{0.2 - 0.2}{0.1}\\right) = 1 - \\Phi(0) = 1 - 0.5 = 0.5\n$$\n$$\n\\mathrm{FPR}(0.2) = 1 - \\Phi\\left(\\frac{0.2 - 0}{0.1}\\right) = 1 - \\Phi(2)\n$$\n使用值 $\\Phi(2) \\approx 0.97725$，我们得到 $\\mathrm{FPR}(0.2) \\approx 1 - 0.97725 = 0.02275$。\n患病率为 $\\pi = 0.001$。现在我们计算最大 PPV：\n$$\n\\mathrm{PPV}_{\\max} = \\mathrm{PPV}(0.2) = \\frac{0.5 \\times 0.001}{0.5 \\times 0.001 + (1 - \\Phi(2)) \\times (1 - 0.001)}\n$$\n$$\n\\mathrm{PPV}_{\\max} \\approx \\frac{0.0005}{0.0005 + 0.02275 \\times 0.999} = \\frac{0.0005}{0.0005 + 0.02272725} = \\frac{0.0005}{0.02322725} \\approx 0.02152644\n$$\n四舍五入到四位有效数字，最大 PPV 是 $0.02153$。\n\n**解释**\n\n结果揭示了两个关键性能指标之间的严重脱节。约 $0.921$ 的 AUC 表明分类器具有出色的区分能力，这意味着它非常擅长将阳性实例的排序排在阴性实例之前。在与患病率无关的意义上，该模型是强大的。\n\n然而，在合理约束（$\\mathrm{TPR} \\ge 0.5$）下的最大阳性预测值（PPV）仅约为 $0.0215$。这意味着即使分类器在此范围内被调至最优点，其预测为阳性的实例中，只有约 $2.15\\%$ 是真正的阳性。其超过 $97\\%$ 的阳性预测都是误报。\n\n这种差异源于极端的类别不平衡（$\\pi=0.001$）。AUC 独立于类别患病率，仅衡量分数分布的分离程度。相比之下，PPV 对患病率高度敏感。由于绝大多数是阴性实例（$99.9\\%$），即使假阳性率很低（$\\mathrm{FPR} \\approx 2.28\\%$），产生的假阳性绝对数量也完全超过了真阳性的数量。\n\n因此，在像罕见病筛查或欺诈检测这样的不平衡领域的实际应用中，单独报告高 AUC 可能是危险的误导。它宣传了模型的潜力，但掩盖了其糟糕的现实世界性能。PPV 提供了必要的背景信息，揭示了误报的高昂代价，并对模型的实际效用给出了现实的评估。报告这两个指标至关重要：AUC 用于评估模型的内在可分性，PPV 用于评估其在实际类别分布背景下的预测性能。",
            "answer": "$$\\boxed{0.02153}$$"
        }
    ]
}