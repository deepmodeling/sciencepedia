{
    "hands_on_practices": [
        {
            "introduction": "在分析RNA测序（RNA-seq）数据时，原始读数（raw counts）会受到基因长度和测序深度（文库大小）等技术因素的影响，因此无法直接用于样本间的比较。为了获得可靠的基因丰度估计，必须进行归一化。本练习将带您从第一性原理出发，亲手计算百万转录本（Transcripts Per Million, TPM）值，这是一种核心的归一化方法，能够同时校正基因长度和文库大小的影响，是处理基因表达特征的基础技能。",
            "id": "4562784",
            "problem": "在临床生物信息学中，您正在为RNA测序数据构建用于下游预后建模的基因表达特征。特征工程中使用的一种核心归一化方法是每百万转录本 (Transcripts Per Million, TPM)，该方法通过对基因长度和文库大小进行校正，以得出跨样本可比较的丰度估计值。考虑一个示例数据集，包含$3$个基因，标记为$G_1$、$G_2$和$G_3$，其长度分别为$L_{G_1} = 1000$个碱基对 (bp)，$L_{G_2} = 2000$ bp，以及$L_{G_3} = 500$ bp。两个患者样本$S_1$和$S_2$观测到的基因水平读数计数$r_{g,s}$如下：对于$S_1$，$(r_{G_1,S_1}, r_{G_2,S_1}, r_{G_3,S_1}) = (300, 200, 200)$；对于$S_2$，$(r_{G_1,S_2}, r_{G_2,S_2}, r_{G_3,S_2}) = (200, 600, 250)$。请使用适用于RNA测序归一化的第一性原理，即表达量估计必须校正基因长度（通过将计数按以千碱基为单位测量的基因长度进行缩放）和样本特异性的文库大小（通过将样本内的丰度重新缩放到一个$10^6$的固定常数），推导出每个样本中每个基因的每百万转录本 (TPM) 值。作为推导过程的一部分，请明确验证每个样本内的TPM值之和为$10^6$。最后，报告样本$S_2$中基因$G_3$的TPM值。将最终数值答案四舍五入至四位有效数字，并以纯数字形式表示（无单位）。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于RNA测序数据归一化的原理，提法得当，提供了所有必要信息，并且语言客观。该问题要求为一个示例数据集计算每百万转录本 (TPM) 值，这是生物信息学中的一个标准流程。\n\nTPM的计算是一个两步归一化过程。首先，对读数计数按基因长度进行归一化。其次，对它们按测序深度（文库大小）进行归一化，以使其在样本间具有可比性。\n\n设$r_{g,s}$为样本$s$中基因$g$的原始读数计数。\n设$L_g$为基因$g$的长度，单位为碱基对 (bp)。\n\n给定数据如下：\n基因长度：\n$L_{G_1} = 1000$ bp\n$L_{G_2} = 2000$ bp\n$L_{G_3} = 500$ bp\n\n样本$S_1$的读数计数：\n$(r_{G_1,S_1}, r_{G_2,S_1}, r_{G_3,S_1}) = (300, 200, 200)$\n\n样本$S_2$的读数计数：\n$(r_{G_1,S_2}, r_{G_2,S_2}, r_{G_3,S_2}) = (200, 600, 250)$\n\nTPM的计算按以下步骤进行：\n\n**步骤1：按基因长度进行归一化。**\n首先，我们按规定将基因长度从碱基对 (bp) 转换为千碱基 (kb)。设$L'_g$为基因$g$的长度，单位为kb。\n$$L'_g = \\frac{L_g}{1000}$$\n对于我们的$3$个基因：\n$L'_{G_1} = \\frac{1000}{1000} = 1.0 \\text{ kb}$\n$L'_{G_2} = \\frac{2000}{1000} = 2.0 \\text{ kb}$\n$L'_{G_3} = \\frac{500}{1000} = 0.5 \\text{ kb}$\n\n接下来，我们计算每个样本中每个基因的每千碱基读数 (RPK) 率。\n$$RPK_{g,s} = \\frac{r_{g,s}}{L'_g}$$\n\n**样本$S_1$的计算：**\n$RPK_{G_1,S_1} = \\frac{r_{G_1,S_1}}{L'_{G_1}} = \\frac{300}{1.0} = 300$\n$RPK_{G_2,S_1} = \\frac{r_{G_2,S_1}}{L'_{G_2}} = \\frac{200}{2.0} = 100$\n$RPK_{G_3,S_1} = \\frac{r_{G_3,S_1}}{L'_{G_3}} = \\frac{200}{0.5} = 400$\n\n**样本$S_2$的计算：**\n$RPK_{G_1,S_2} = \\frac{r_{G_1,S_2}}{L'_{G_1}} = \\frac{200}{1.0} = 200$\n$RPK_{G_2,S_2} = \\frac{r_{G_2,S_2}}{L'_{G_2}} = \\frac{600}{2.0} = 300$\n$RPK_{G_3,S_2} = \\frac{r_{G_3,S_2}}{L'_{G_3}} = \\frac{250}{0.5} = 500$\n\n**步骤2：按文库大小归一化并缩放到$10^6$。**\n我们通过对该样本内所有基因的RPK值求和，计算出每个样本的归一化因子$T_s$。\n$$T_s = \\sum_{g} RPK_{g,s}$$\n然后，通过将其RPK值除以归一化因子再乘以$10^6$，计算出每个基因的TPM值。\n$$TPM_{g,s} = \\left(\\frac{RPK_{g,s}}{T_s}\\right) \\times 10^6$$\n\n**样本$S_1$的计算：**\n首先，计算归一化因子$T_{S_1}$：\n$T_{S_1} = RPK_{G_1,S_1} + RPK_{G_2,S_1} + RPK_{G_3,S_1} = 300 + 100 + 400 = 800$\n\n现在，计算$S_1$中每个基因的TPM值：\n$TPM_{G_1,S_1} = \\left(\\frac{300}{800}\\right) \\times 10^6 = 0.375 \\times 10^6 = 375000$\n$TPM_{G_2,S_1} = \\left(\\frac{100}{800}\\right) \\times 10^6 = 0.125 \\times 10^6 = 125000$\n$TPM_{G_3,S_1} = \\left(\\frac{400}{800}\\right) \\times 10^6 = 0.5 \\times 10^6 = 500000$\n\n对$S_1$的验证：TPM的总和必须为$10^6$。\n$\\sum_{g} TPM_{g,S_1} = 375000 + 125000 + 500000 = 1000000 = 10^6$。条件满足。\n\n**样本$S_2$的计算：**\n首先，计算归一化因子$T_{S_2}$：\n$T_{S_2} = RPK_{G_1,S_2} + RPK_{G_2,S_2} + RPK_{G_3,S_2} = 200 + 300 + 500 = 1000$\n\n现在，计算$S_2$中每个基因的TPM值：\n$TPM_{G_1,S_2} = \\left(\\frac{200}{1000}\\right) \\times 10^6 = 0.2 \\times 10^6 = 200000$\n$TPM_{G_2,S_2} = \\left(\\frac{300}{1000}\\right) \\times 10^6 = 0.3 \\times 10^6 = 300000$\n$TPM_{G_3,S_2} = \\left(\\frac{500}{1000}\\right) \\times 10^6 = 0.5 \\times 10^6 = 500000$\n\n对$S_2$的验证：TPM的总和必须为$10^6$。\n$\\sum_{g} TPM_{g,S_2} = 200000 + 300000 + 500000 = 1000000 = 10^6$。条件满足。\n\n问题要求的是样本$S_2$中基因$G_3$的TPM值。根据上述计算：\n$TPM_{G_3,S_2} = 500000$\n\n最终答案必须四舍五入到四位有效数字。精确值为$500000$。为了用四位有效数字表示这个值，我们使用科学记数法：$5.000 \\times 10^5$。",
            "answer": "$$\\boxed{5.000 \\times 10^{5}}$$"
        },
        {
            "introduction": "任何归一化方法都建立在特定的假设之上，当这些假设在实际生物学场景中不成立时，归一化不仅无法消除偏差，反而可能引入新的错误。本练习提供了一个深刻的反例，旨在培养您的批判性思维。通过一个假设但合理的场景，您将计算并发现，当看家基因（housekeeping genes）的表达并非恒定时，看似简单的全局总数缩放（如每百万读数CPM）会如何掩盖甚至扭曲真实的生物学信号。",
            "id": "4562808",
            "problem": "一个研究团队正在进行RNA测序（RNA-seq），以测量某种处理下的基因表达变化。他们考虑一个感兴趣的基因 $G_{T}$ 和一组看家基因 $H_{1}, H_{2}, H_{3}$。看家基因通常用于定义全局表达基线，但在本实验中，这些看家基因受到了处理的生物学影响。该团队使用基于总读数计数的全局缩放方法，类似于每百万计数（CPM），具体如下：对于样本 $s$，基因 $g$ 的标准化值为 $x_{g,s}/T_{s}$，其中 $x_{g,s}$ 是观测到的原始计数，而 $T_{s}=\\sum_{g}x_{g,s}$ 是样本 $s$ 中的总计数。对于基因 $G_{T}$，其标准化倍数变化定义为处理组中其标准化值与对照组中其标准化值的比值，而标准化log2倍数变化是该比值的以2为底的对数。\n\n假设以下观测到的原始计数在科学上是合理的，并且与测序深度和表达水平自洽：\n- 对照组样本计数：$x_{G_{T},\\mathrm{ctrl}}=100$， $x_{H_{1},\\mathrm{ctrl}}=100$， $x_{H_{2},\\mathrm{ctrl}}=100$， $x_{H_{3},\\mathrm{ctrl}}=100$。\n- 处理组样本计数：$x_{G_{T},\\mathrm{trt}}=200$， $x_{H_{1},\\mathrm{trt}}=150$， $x_{H_{2},\\mathrm{trt}}=150$， $x_{H_{3},\\mathrm{trt}}=150$。\n\n将原始计数视为与真实表达量乘以样本特异性文库大小成正比。你可以假设没有其他基因对总计数有贡献。根据第一性原理，计算在使用定义的全局总计数缩放方法时，$G_{T}$ 的标准化log2倍数变化。将您的答案表示为一个精确的以2为底的对数表达式。不要近似，也不要包含任何单位。",
            "solution": "RNA测序（RNA-seq）定量的基本前提是，样本 $s$ 中基因 $g$ 的观测原始计数 $x_{g,s}$ 与 $s$ 中 $g$ 的真实表达水平以及样本特异性文库大小 $L_{s}$ 成正比。通过总计数进行的全局缩放，通过将每个 $x_{g,s}$ 除以样本总数 $T_{s}=\\sum_{g}x_{g,s}$ 来校正 $L_{s}$ 的差异，从而得到一个标准化值 $x_{g,s}/T_{s}$，该值与样本 $s$ 中基因 $g$ 的真实表达分数成正比。\n\n在给定的标准化方法下，一个基因在处理组和对照组之间的倍数变化定义为处理组的标准化值与对照组的标准化值的比值。log2倍数变化是该比值的以2为底的对数，即 $\\log_{2}$。\n\n我们根据这些定义逐步进行计算。\n\n首先，计算每个样本中的总计数：\n- 对照组总数：\n$$\nT_{\\mathrm{ctrl}}=x_{G_{T},\\mathrm{ctrl}}+x_{H_{1},\\mathrm{ctrl}}+x_{H_{2},\\mathrm{ctrl}}+x_{H_{3},\\mathrm{ctrl}}=100+100+100+100=400.\n$$\n- 处理组总数：\n$$\nT_{\\mathrm{trt}}=x_{G_{T},\\mathrm{trt}}+x_{H_{1},\\mathrm{trt}}+x_{H_{2},\\mathrm{trt}}+x_{H_{3},\\mathrm{trt}}=200+150+150+150=650.\n$$\n\n接下来，在全局缩放条件下计算每种情况下 $G_{T}$ 的标准化值：\n- 对照组中 $G_{T}$ 的标准化值：\n$$\n\\frac{x_{G_{T},\\mathrm{ctrl}}}{T_{\\mathrm{ctrl}}}=\\frac{100}{400}=\\frac{1}{4}.\n$$\n- 处理组中 $G_{T}$ 的标准化值：\n$$\n\\frac{x_{G_{T},\\mathrm{trt}}}{T_{\\mathrm{trt}}}=\\frac{200}{650}=\\frac{4}{13}.\n$$\n\n将这些标准化值的比值作为 $G_{T}$ 的标准化倍数变化进行计算：\n$$\n\\text{FC}_{\\mathrm{norm}}=\\frac{\\frac{x_{G_{T},\\mathrm{trt}}}{T_{\\mathrm{trt}}}}{\\frac{x_{G_{T},\\mathrm{ctrl}}}{T_{\\mathrm{ctrl}}}}=\\frac{\\frac{200}{650}}{\\frac{100}{400}}=\\frac{200}{650}\\cdot\\frac{400}{100}=\\frac{800}{650}=\\frac{16}{13}.\n$$\n\n最后，计算标准化的log2倍数变化：\n$$\n\\log_{2}\\left(\\text{FC}_{\\mathrm{norm}}\\right)=\\log_{2}\\left(\\frac{16}{13}\\right).\n$$\n\n为了将此解释为证明衰减效应的一个反例，请注意 $G_{T}$ 原始计数的真实倍数变化是\n$$\n\\text{FC}_{\\mathrm{raw}}=\\frac{200}{100}=2,\n$$\n其真实的log2倍数变化为 $\\log_{2}(2)=1$。在通过总计数进行全局缩放后，标准化倍数变化变为 $\\frac{16}{13}$，该值严格小于 $2$，而标准化的log2倍数变化 $\\log_{2}\\left(\\frac{16}{13}\\right)$ 严格小于 $1$。出现衰减是因为看家基因 $H_{1},H_{2},H_{3}$ 在处理后表达增加，导致 $T_{\\mathrm{trt}}$ 相对于 $T_{\\mathrm{ctrl}}$ 膨胀；除以较大的 $T_{\\mathrm{trt}}$ 会使得处理组中 $G_{T}$ 的标准化值相对于对照组的减少程度，大于在看家基因真正不变的情况下的减少程度。这从第一性原理证明了，当看家基因存在差异表达时，全局缩放会削弱真实的治疗效果。\n\n因此，所要求的精确的以2为底的对数表达式是 $\\log_{2}\\left(\\frac{16}{13}\\right)$。",
            "answer": "$$\\boxed{\\log_{2}\\!\\left(\\frac{16}{13}\\right)}$$"
        }
    ]
}