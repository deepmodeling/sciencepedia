{
    "hands_on_practices": [
        {
            "introduction": "信息论的核心概念——熵，为我们提供了一种量化不确定性的基本方法。在生物信息学中，这可以直接应用于衡量生物序列（如DNA或蛋白质）中包含的信息量。本练习将通过一个具体的核苷酸分布，指导您从第一性原理计算香农熵，并将其与最大熵进行比较，从而让您直观地理解序列的组成偏好如何影响其信息含量。",
            "id": "4573945",
            "problem": "一个单核苷酸发射模型被用来总结一个表现出组分偏向性的短基因组区域中的碱基组成。设 $X$ 是一个定义在脱氧核糖核酸（DNA）字母表 $\\{A,C,G,T\\}$ 上的离散随机变量，其概率质量函数为 $P(A)=0.4$, $P(C)=0.1$, $P(G)=0.1$, $P(T)=0.4$。从离散随机变量香农熵的基本定义和对数换底公式出发，推导以比特（bits）为单位的熵 $H(X)$ 的表达式，并为给定分布计算其值。然后，通过计算比率 $H(X)/\\log_{2}(4)$ 来量化此熵与一个四符号字母表可达到的最大值的接近程度。将此单一比率作为最终结果，并四舍五入至 $4$ 位有效数字。",
            "solution": "该问题要求计算给定DNA字母表上概率分布的香农熵，然后求出此熵与相同大小字母表的最大可能熵的比率。\n\n**步骤1：问题验证**\n\n已知条件如下：\n- 一个定义在字母表 $\\mathcal{X} = \\{A, C, G, T\\}$ 上的离散随机变量 $X$。\n- 概率质量函数（PMF）为 $P(X=A)=0.4$, $P(X=C)=0.1$, $P(X=G)=0.1$, 以及 $P(X=T)=0.4$。\n\n问题验证如下：\n- **科学依据：** 香农熵、DNA碱基组成和组分偏向性等概念是信息论和生物信息学中的标准概念。所提供的概率为非负数，且总和为 $1$：$0.4 + 0.1 + 0.1 + 0.4 = 1.0$。该问题在科学上和数学上都是合理的。\n- **适定性：** 问题提供了所有必要信息（字母表和概率质量函数），并明确说明了目标。问题清晰无歧义，且有唯一、稳定的解。\n- **客观性：** 问题以精确、客观的语言表述。\n\n该问题被视为有效。\n\n**步骤2：熵 $H(X)$ 的推导与计算**\n\n对于具有来自字母表 $\\mathcal{X}$ 的结果 $x_i$ 和概率质量函数 $P(x_i)$ 的离散随机变量 $X$，香农熵的基本定义由下式给出：\n$$\nH(X) = -\\sum_{x_i \\in \\mathcal{X}} P(x_i) \\log_b(P(x_i))\n$$\n对数的底 $b$ 决定了熵的单位。对于以比特（bits）为单位的熵，底必须为 $b=2$。\n$$\nH(X)_{\\text{bits}} = -\\sum_{x_i \\in \\mathcal{X}} P(x_i) \\log_2(P(x_i))\n$$\n问题要求从一个通用底数开始，并使用换底公式。我们从自然对数（底为 $e$，单位为奈特 nats）开始。换底公式为 $\\log_b(a) = \\frac{\\log_c(a)}{\\log_c(b)}$。要从一个通用底数 $c$（例如 $e$）转换到 $b=2$，我们有：\n$$\n\\log_2(z) = \\frac{\\log_c(z)}{\\log_c(2)}\n$$\n将此代入以比特为单位的熵公式中：\n$$\nH(X) = -\\sum_{x_i \\in \\mathcal{X}} P(x_i) \\frac{\\log_c(P(x_i))}{\\log_c(2)} = \\frac{1}{\\log_c(2)} \\left( -\\sum_{x_i \\in \\mathcal{X}} P(x_i) \\log_c(P(x_i)) \\right)\n$$\n这明确地显示了转换过程。在我们的计算中，我们将直接使用以2为底的公式。\n\n字母表为 $\\mathcal{X} = \\{A, C, G, T\\}$，概率为 $P(A) = 0.4$，$P(C) = 0.1$，$P(G) = 0.1$，以及 $P(T) = 0.4$。\n\n熵 $H(X)$ 为：\n$$\nH(X) = -[P(A)\\log_2(P(A)) + P(C)\\log_2(P(C)) + P(G)\\log_2(P(G)) + P(T)\\log_2(P(T))]\n$$\n代入给定的概率：\n$$\nH(X) = -[0.4 \\log_2(0.4) + 0.1 \\log_2(0.1) + 0.1 \\log_2(0.1) + 0.4 \\log_2(0.4)]\n$$\n由于概率的对称性（$P(A)=P(T)$ 和 $P(C)=P(G)$），我们可以简化表达式：\n$$\nH(X) = -[2 \\cdot (0.4 \\log_2(0.4)) + 2 \\cdot (0.1 \\log_2(0.1))]\n$$\n$$\nH(X) = -[0.8 \\log_2(0.4) + 0.2 \\log_2(0.1)]\n$$\n我们可以使用自然对数和换底公式 $\\log_2(z) = \\frac{\\ln(z)}{\\ln(2)}$ 来表示这些对数：\n$$\nH(X) = - \\left[ 0.8 \\frac{\\ln(0.4)}{\\ln(2)} + 0.2 \\frac{\\ln(0.1)}{\\ln(2)} \\right] = -\\frac{1}{\\ln(2)} [0.8 \\ln(0.4) + 0.2 \\ln(0.1)]\n$$\n\n**步骤3：最大熵的确定**\n\n对于具有 $|\\mathcal{X}| = K$ 个结果的离散随机变量，当概率分布为均匀分布时，即对所有 $i$ 都有 $P(x_i) = 1/K$，熵达到最大值。在本例中，字母表大小为 $K=4$。最大熵 $H_{\\text{max}}$ 为：\n$$\nH_{\\text{max}} = -\\sum_{i=1}^{4} P(x_i) \\log_2(P(x_i)) = -\\sum_{i=1}^{4} \\frac{1}{4} \\log_2\\left(\\frac{1}{4}\\right)\n$$\n$$\nH_{\\text{max}} = -4 \\cdot \\frac{1}{4} \\log_2\\left(\\frac{1}{4}\\right) = -\\log_2(4^{-1}) = \\log_2(4)\n$$\n因为 $4=2^2$，最大熵为：\n$$\nH_{\\text{max}} = \\log_2(2^2) = 2 \\text{ bits}\n$$\n\n**步骤4：比率的计算**\n\n问题要求计算比率 $H(X)/\\log_2(4)$，即计算出的熵与该字母表大小的最大可能熵之比。这也称为归一化熵。\n$$\n\\text{Ratio} = \\frac{H(X)}{H_{\\text{max}}} = \\frac{H(X)}{\\log_2(4)}\n$$\n代入 $H(X)$ 和 $H_{\\text{max}}$ 的表达式：\n$$\n\\text{Ratio} = \\frac{-[0.8 \\log_2(0.4) + 0.2 \\log_2(0.1)]}{2}\n$$\n$$\n\\text{Ratio} = -[0.4 \\log_2(0.4) + 0.1 \\log_2(0.1)]\n$$\n现在，我们对这个表达式进行数值计算：\n$$\n\\text{Ratio} = - \\left[ 0.4 \\left(\\frac{\\ln(0.4)}{\\ln(2)}\\right) + 0.1 \\left(\\frac{\\ln(0.1)}{\\ln(2)}\\right) \\right]\n$$\n$$\n\\text{Ratio} = - \\frac{1}{\\ln(2)} [0.4 \\ln(0.4) + 0.1 \\ln(0.1)]\n$$\n使用数值 $\\ln(0.4) \\approx -0.9162907$ 和 $\\ln(0.1) \\approx -2.3025851$ 以及 $\\ln(2) \\approx 0.6931472$：\n$$\n0.4 \\ln(0.4) \\approx 0.4 \\times (-0.9162907) = -0.3665163\n$$\n$$\n0.1 \\ln(0.1) \\approx 0.1 \\times (-2.3025851) = -0.2302585\n$$\n$$\n\\text{Ratio} \\approx - \\frac{1}{0.6931472} [-0.3665163 - 0.2302585] = - \\frac{-0.5967748}{0.6931472}\n$$\n$$\n\\text{Ratio} \\approx 0.8609640\n$$\n将此结果四舍五入到 $4$ 位有效数字，我们看第五位有效数字。由于 $6 \\geq 5$，我们将第四位数字向上取整：\n$$\n\\text{Ratio} \\approx 0.8610\n$$\n该值表示给定分布的熵占最大可能熵的比例，表明存在中等程度的组分偏向性（值为 $1$ 表示没有偏向性，而值越接近 $0$ 表示偏向性越极端）。",
            "answer": "$$\\boxed{0.8610}$$"
        },
        {
            "introduction": "在掌握了如何衡量单个变量的不确定性之后，下一步是理解变量之间的关系。条件熵衡量的是在已知一个变量的情况下，另一个变量剩下的不确定性，这是评估预测模型和诊断测试性能的关键。本练习模拟了一个临床场景，要求您计算分子检测结果和临床紧急程度之间的条件熵 $H(X|Y)$ 与 $H(Y|X)$，并解释两者为何通常不相等，从而加深您对信息流和变量依赖性的理解。",
            "id": "4573980",
            "problem": "一个临床生物信息学团队正在验证一种二元分子检测方法 $X \\in \\{\\text{阳性}, \\text{阴性}\\}$，用于急诊科的分诊。分诊变量 $Y \\in \\{\\text{低}, \\text{中}, \\text{高}\\}$ 表示临床紧急程度。在一个大型队列上的经验联合分布 $\\Pr(X,Y)$ 由下表总结（表项为 $\\Pr(X=x, Y=y)$）：\n$$\n\\begin{array}{c|ccc}\n  Y=\\text{低}  Y=\\text{中}  Y=\\text{高} \\\\\n\\hline\nX=\\text{阳性}  0.06  0.20  0.24 \\\\\nX=\\text{阴性}  0.24  0.20  0.06 \\\\\n\\end{array}\n$$\n仅使用信息论中香农熵和条件熵的基本定义，以及以2为底的对数，根据给定的联合分布表计算条件熵 $H(X \\mid Y)$ 和 $H(Y \\mid X)$（单位为比特），从定义和表中隐含的任何中间量开始计算。然后，从第一性原理出发，解释为什么在此类生物医学分类场景中，$H(X \\mid Y)$ 和 $H(Y \\mid X)$ 的大小通常不同。\n\n使用以2为底的对数（比特）。将每个最终数值四舍五入到4位有效数字。将您的最终数值答案以行矩阵 $\\big(H(X \\mid Y)\\;\\;H(Y \\mid X)\\big)$ 的形式报告，两个条目都以比特为单位。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 第1步：提取已知条件\n-   一个用于分子检测的二元随机变量，$X \\in \\{\\text{阳性}, \\text{阴性}\\}$。\n-   一个用于临床紧急程度的离散随机变量，$Y \\in \\{\\text{低}, \\text{中}, \\text{高}\\}$。\n-   联合概率分布 $\\Pr(X, Y)$ 由下表给出：\n    -   $\\Pr(X=\\text{阳性}, Y=\\text{低}) = 0.06$\n    -   $\\Pr(X=\\text{阳性}, Y=\\text{中}) = 0.20$\n    -   $\\Pr(X=\\text{阳性}, Y=\\text{高}) = 0.24$\n    -   $\\Pr(X=\\text{阴性}, Y=\\text{低}) = 0.24$\n    -   $\\Pr(X=\\text{阴性}, Y=\\text{中}) = 0.20$\n    -   $\\Pr(X=\\text{阴性}, Y=\\text{高}) = 0.06$\n-   任务是计算条件熵 $H(X \\mid Y)$ 和 $H(Y \\mid X)$（单位为比特，使用以2为底的对数）。\n-   任务要求从第一性原理出发，解释为什么 $H(X \\mid Y)$ 和 $H(Y \\mid X)$ 通常不同。\n-   最终数值需四舍五入到4位有效数字。\n-   最终答案必须是行矩阵 $\\big(H(X \\mid Y)\\;\\;H(Y \\mid X)\\big)$。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学或事实不健全性**：该问题在科学上是合理的。它将信息论中已确立的概念（香农熵、条件熵）应用于生物信息学中一个合理的场景。所提供的联合概率为非负数，且总和为$1.0$：$0.06 + 0.20 + 0.24 + 0.24 + 0.20 + 0.06 = 1.00$。这构成了一个有效的离散概率分布。\n2.  **非形式化或不相关**：该问题与信息论基础主题直接相关，并且在数学上是良好形式化的。\n3.  **不完整或矛盾的设置**：该问题是自洽的。联合概率表提供了计算熵所需的边际概率和条件概率的所有必要信息。\n4.  **不切实际或不可行**：在临床数据分析的背景下，该场景和概率值是现实的。\n5.  **不适定或结构不良**：该问题是适定的。熵和条件熵的定义是唯一的，从而可以得出一个单一、稳定的解。\n6.  **伪深刻、琐碎或同义反复**：该问题需要进行非平凡的计算，并基于基本原理进行概念性解释，使其成为一项实质性的练习。\n7.  **超出科学可验证性范围**：计算过程在数学上是可验证的。\n\n### 第3步：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n解答过程首先从给定的联合概率表中计算出必要的边际概率和条件概率。然后，利用这些概率根据其基本定义计算条件熵 $H(X \\mid Y)$ 和 $H(Y \\mid X)$。最后，解释了这两个量之间通常不相等的原因。所有对数均以2为底。\n\n**1. 边际概率的计算**\n\n首先，我们通过对联合概率表的行和列求和来计算边际概率 $\\Pr(X=x)$ 和 $\\Pr(Y=y)$。\n对于变量 $X$：\n$$\n\\Pr(X=\\text{阳性}) = \\Pr(X=\\text{阳}, Y=\\text{低}) + \\Pr(X=\\text{阳}, Y=\\text{中}) + \\Pr(X=\\text{阳}, Y=\\text{高})\n$$\n$$\n\\Pr(X=\\text{阳性}) = 0.06 + 0.20 + 0.24 = 0.50\n$$\n$$\n\\Pr(X=\\text{阴性}) = \\Pr(X=\\text{阴}, Y=\\text{低}) + \\Pr(X=\\text{阴}, Y=\\text{中}) + \\Pr(X=\\text{阴}, Y=\\text{高})\n$$\n$$\n\\Pr(X=\\text{阴性}) = 0.24 + 0.20 + 0.06 = 0.50\n$$\n对于变量 $Y$：\n$$\n\\Pr(Y=\\text{低}) = \\Pr(X=\\text{阳}, Y=\\text{低}) + \\Pr(X=\\text{阴}, Y=\\text{低}) = 0.06 + 0.24 = 0.30\n$$\n$$\n\\Pr(Y=\\text{中}) = \\Pr(X=\\text{阳}, Y=\\text{中}) + \\Pr(X=\\text{阴}, Y=\\text{中}) = 0.20 + 0.20 = 0.40\n$$\n$$\n\\Pr(Y=\\text{高}) = \\Pr(X=\\text{阳}, Y=\\text{高}) + \\Pr(X=\\text{阴}, Y=\\text{高}) = 0.24 + 0.06 = 0.30\n$$\n\n**2. 条件熵 $H(X \\mid Y)$ 的计算**\n\n条件熵 $H(X \\mid Y)$ 定义为给定 $Y$ 时 $X$ 的条件分布熵的期望值。\n$$\nH(X \\mid Y) = \\sum_{y \\in \\mathcal{Y}} \\Pr(Y=y) H(X \\mid Y=y)\n$$\n其中 $H(X \\mid Y=y) = - \\sum_{x \\in \\mathcal{X}} \\Pr(X=x \\mid Y=y) \\log_2(\\Pr(X=x \\mid Y=y))$。\n\n首先，我们计算所需的条件概率 $\\Pr(X=x \\mid Y=y) = \\frac{\\Pr(X=x, Y=y)}{\\Pr(Y=y)}$。\n- 对于 $Y=\\text{低}$：\n  $\\Pr(X=\\text{阳} \\mid Y=\\text{低}) = \\frac{0.06}{0.30} = 0.20$\n  $\\Pr(X=\\text{阴} \\mid Y=\\text{低}) = \\frac{0.24}{0.30} = 0.80$\n- 对于 $Y=\\text{中}$：\n  $\\Pr(X=\\text{阳} \\mid Y=\\text{中}) = \\frac{0.20}{0.40} = 0.50$\n  $\\Pr(X=\\text{阴} \\mid Y=\\text{中}) = \\frac{0.20}{0.40} = 0.50$\n- 对于 $Y=\\text{高}$：\n  $\\Pr(X=\\text{阳} \\mid Y=\\text{高}) = \\frac{0.24}{0.30} = 0.80$\n  $\\Pr(X=\\text{阴} \\mid Y=\\text{高}) = \\frac{0.06}{0.30} = 0.20$\n\n接下来，我们计算特定的条件熵：\n$H(X \\mid Y=\\text{低}) = -[0.20 \\log_2(0.20) + 0.80 \\log_2(0.80)] \\approx -[0.20(-2.3219) + 0.80(-0.3219)] \\approx 0.72193 \\text{ 比特}$\n$H(X \\mid Y=\\text{中}) = -[0.50 \\log_2(0.50) + 0.50 \\log_2(0.50)] = -[0.50(-1) + 0.50(-1)] = 1 \\text{ 比特}$\n$H(X \\mid Y=\\text{高}) = -[0.80 \\log_2(0.80) + 0.20 \\log_2(0.20)] \\approx 0.72193 \\text{ 比特}$\n\n最后，我们计算加权平均值：\n$$\nH(X \\mid Y) = (0.30 \\times 0.72193) + (0.40 \\times 1) + (0.30 \\times 0.72193)\n$$\n$$\nH(X \\mid Y) \\approx 0.21658 + 0.40000 + 0.21658 \\approx 0.83316 \\text{ 比特}\n$$\n四舍五入到4位有效数字，$H(X \\mid Y) \\approx 0.8332$ 比特。\n\n**3. 条件熵 $H(Y \\mid X)$ 的计算**\n\n类似地，条件熵 $H(Y \\mid X)$ 定义为：\n$$\nH(Y \\mid X) = \\sum_{x \\in \\mathcal{X}} \\Pr(X=x) H(Y \\mid X=x)\n$$\n其中 $H(Y \\mid X=x) = - \\sum_{y \\in \\mathcal{Y}} \\Pr(Y=y \\mid X=x) \\log_2(\\Pr(Y=y \\mid X=x))$。\n\n首先，我们计算所需的条件概率 $\\Pr(Y=y \\mid X=x) = \\frac{\\Pr(X=x, Y=y)}{\\Pr(X=x)}$。\n- 对于 $X=\\text{阳性}$：\n  $\\Pr(Y=\\text{低} \\mid X=\\text{阳}) = \\frac{0.06}{0.50} = 0.12$\n  $\\Pr(Y=\\text{中} \\mid X=\\text{阳}) = \\frac{0.20}{0.50} = 0.40$\n  $\\Pr(Y=\\text{高} \\mid X=\\text{阳}) = \\frac{0.24}{0.50} = 0.48$\n- 对于 $X=\\text{阴性}$：\n  $\\Pr(Y=\\text{低} \\mid X=\\text{阴}) = \\frac{0.24}{0.50} = 0.48$\n  $\\Pr(Y=\\text{中} \\mid X=\\text{阴}) = \\frac{0.20}{0.50} = 0.40$\n  $\\Pr(Y=\\text{高} \\mid X=\\text{阴}) = \\frac{0.06}{0.50} = 0.12$\n\n接下来，我们计算特定的条件熵：\n$H(Y \\mid X=\\text{阳性}) = -[0.12\\log_2(0.12) + 0.40\\log_2(0.40) + 0.48\\log_2(0.48)]$\n$H(Y \\mid X=\\text{阳性}) \\approx -[0.12(-3.0589) + 0.40(-1.3219) + 0.48(-1.0589)] \\approx -[-0.36707 - 0.52877 - 0.50827] \\approx 1.4041 \\text{ 比特}$\n由于概率值的对称性，$H(Y \\mid X=\\text{阴性}) = H(Y \\mid X=\\text{阳性})$。\n$H(Y \\mid X=\\text{阴性}) = -[0.48\\log_2(0.48) + 0.40\\log_2(0.40) + 0.12\\log_2(0.12)] \\approx 1.4041 \\text{ 比特}$\n\n最后，我们计算加权平均值：\n$$\nH(Y \\mid X) = (0.50 \\times 1.4041) + (0.50 \\times 1.4041) = 1.4041 \\text{ 比特}\n$$\n四舍五入到4位有效数字，$H(Y \\mid X) \\approx 1.404$ 比特。\n\n**4. 关于 $H(X \\mid Y)$ 和 $H(Y \\mid X)$ 之间差异的解释**\n\n从第一性原理出发，条件熵、联合熵和边际熵之间的关系由熵的链式法则给出：\n$$\nH(X, Y) = H(X) + H(Y \\mid X)\n$$\n$$\nH(X, Y) = H(Y) + H(X \\mid Y)\n$$\n将联合熵 $H(X, Y)$ 的这两个表达式相等，得到：\n$$\nH(X) + H(Y \\mid X) = H(Y) + H(X \\mid Y)\n$$\n重排这个恒等式得到：\n$$\nH(Y \\mid X) - H(X \\mid Y) = H(Y) - H(X)\n$$\n这个基本关系表明，$H(Y \\mid X)$ 和 $H(X \\mid Y)$ 相等，当且仅当边际熵 $H(Y)$ 和 $H(X)$ 相等。\n\n$H(X)$ 表示在了解临床紧急程度之前关于检测结果的先验不确定性。$H(Y)$ 表示在了解检测结果之前关于临床紧急程度的先验不确定性。在生物医学分类场景中，这两个量通常不相等。这种不等性产生主要有两个原因：\n1.  **结果数量不同**：变量可能具有不同数量的可能状态。在这个问题中，$X$ 是二元的 ($|\\mathcal{X}|=2$)，而 $Y$ 是三元的 ($|\\mathcal{Y}|=3$)。更大的状态空间通常允许更高的最大熵。\n2.  **边际概率分布不同**：即使结果数量相同，它们的概率分布形状也几乎总是不同。人群中不同临床状态（$Y$）的患病率分布通常与诊断测试（$X$）结果的分布方式不同。\n\n对于这个具体问题，我们可以计算边际熵来验证这一原理：\n$$\nH(X) = -\\sum_{x \\in \\mathcal{X}} \\Pr(X=x) \\log_2(\\Pr(X=x)) = -[0.5 \\log_2(0.5) + 0.5 \\log_2(0.5)] = 1 \\text{ 比特}\n$$\n$$\nH(Y) = -\\sum_{y \\in \\mathcal{Y}} \\Pr(Y=y) \\log_2(\\Pr(Y=y)) = -[0.3 \\log_2(0.3) + 0.4 \\log_2(0.4) + 0.3 \\log_2(0.3)]\n$$\n$$\nH(Y) = -[2 \\times 0.3 \\log_2(0.3) + 0.4 \\log_2(0.4)] \\approx -[0.6(-1.7370) + 0.4(-1.3219)] \\approx 1.5710 \\text{ 比特}\n$$\n由于 $H(X) = 1$ 且 $H(Y) \\approx 1.5710$，我们有 $H(X) \\neq H(Y)$。因此，必然有 $H(X \\mid Y) \\neq H(Y \\mid X)$。差值为 $H(Y) - H(X) \\approx 1.5710 - 1 = 0.5710$，这与我们直接计算的差值 $H(Y \\mid X) - H(X \\mid Y) \\approx 1.4041 - 0.8332 = 0.5709$ 相符（微小的差异是由于中间步骤的四舍五入造成的）。因此，这个解释得到了数据的验证。\n\n总之，$H(X \\mid Y)$ 衡量的是在观察到三元临床状态后，二元检测结果的平均剩余不确定性；而 $H(Y \\mid X)$ 衡量的是在观察到二元检测结果后，三元临床状态的平均剩余不确定性。它们是关于不同变量在给定另一变量信息条件下的不确定性度量，并且仅当它们的初始、无条件不确定性恰好相同时才相等，这种情况在实践中通常不满足。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8332  1.404\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在医学数据分析中，我们观察到的变量间关联可能具有误导性，这通常是由未被观察的混杂变量引起的。信息论工具，特别是互信息和条件互信息，为我们提供了一个严谨的框架来剖析这些复杂关系。本练习通过一个经典的辛普森悖论案例，要求您计算互信息 $I(X;Y)$ 和条件互信息 $I(X;Y|Z)$，以揭示治疗和康复结果之间的表面关联在控制了病情严重程度后便会消失，这突显了信息论在严谨的因果推断中的强大作用。",
            "id": "4573951",
            "problem": "一位医学数据科学家正在分析一个观测数据集，以评估一种新疗法。设 $X \\in \\{0,1\\}$ 表示治疗分配，其中 $X=1$ 表示新疗法，$X=0$ 表示标准疗法。设 $Y \\in \\{0,1\\}$ 表示结果，其中 $Y=1$ 表示康复，$Y=0$ 表示未康复。设 $Z \\in \\{0,1\\}$ 是一个二元混杂因素，表示严重程度组，其中 $Z=0$ 表示低严重程度，$Z=1$ 表示高严重程度。该研究旨在理解 $X$ 和 $Y$ 之间的关联，包括边际关联和以 $Z$ 为条件时的关联，使用以 2 为底的对数计算的互信息 (MI) 和条件互信息 (CMI)。\n\n该数据集包含 $N=400$ 名患者，平均分配在严重程度组 $Z=0$ 和 $Z=1$ 之间：\n\n-   对于 $Z=0$（低严重程度），有 $200$ 名患者。其中，$40$ 人接受新疗法（$X=1$），$160$ 人接受标准疗法（$X=0$）。在这 $200$ 人中，$180$ 人康复（$Y=1$），$20$ 人未康复（$Y=0$）。联合计数如下：\n    -   $(X=1,Y=1)$: $36$，\n    -   $(X=1,Y=0)$: $4$，\n    -   $(X=0,Y=1)$: $144$，\n    -   $(X=0,Y=0)$: $16$。\n\n-   对于 $Z=1$（高严重程度），有 $200$ 名患者。其中，$160$ 人接受新疗法（$X=1$），$40$ 人接受标准疗法（$X=0$）。在这 $200$ 人中，$60$ 人康复（$Y=1$），$140$ 人未康复（$Y=0$）。联合计数如下：\n    -   $(X=1,Y=1)$: $48$，\n    -   $(X=1,Y=0)$: $112$，\n    -   $(X=0,Y=1)$: $12$，\n    -   $(X=0,Y=0)$: $28$。\n\n假设香农熵和互信息的定义适用。仅使用基本原理，从汇总数据（即忽略 $Z$）中推导出互信息 $I(X;Y)$ 和条件互信息 $I(X;Y \\mid Z)$。使用以 2 为底的对数，以比特为单位进行计算。\n\n哪个选项最能描述该数据集和您计算出的量？\n\nA. $I(X;Y)$ 严格为正（约 $0.10$ 比特），而 $I(X;Y \\mid Z)=0$；因此，表观关联完全由混杂因素 $Z$ 解释。\n\nB. $I(X;Y)=0$，而 $I(X;Y \\mid Z)$ 严格为正；因此，以 $Z$ 为条件揭示了一个隐藏的关联。\n\nC. $I(X;Y)$ 和 $I(X;Y \\mid Z)$ 均为严格为正且近似相等。\n\nD. $I(X;Y)$ 和 $I(X;Y \\mid Z)$ 均为零；因此，$X$ 和 $Y$ 在边际上和条件上都是独立的。",
            "solution": "用户提供了一个问题，要求根据给定的数据集计算和解释互信息 ($I(X;Y)$) 和条件互信息 ($I(X;Y \\mid Z)$)。\n\n### 第 1 步：问题验证\n\n**已知条件：**\n问题提供了以下数据和定义：\n-   总共 $N=400$ 名患者。\n-   变量：治疗 $X \\in \\{0,1\\}$，结果 $Y \\in \\{0,1\\}$，混杂因素 $Z \\in \\{0,1\\}$。\n-   对数以 2 为底。\n-   对于 $Z=0$（低严重程度），$N_0 = 200$ 名患者：\n    -   $N(X=1,Y=1,Z=0) = 36$\n    -   $N(X=1,Y=0,Z=0) = 4$\n    -   $N(X=0,Y=1,Z=0) = 144$\n    -   $N(X=0,Y=0,Z=0) = 16$\n-   对于 $Z=1$（高严重程度），$N_1 = 200$ 名患者：\n    -   $N(X=1,Y=1,Z=1) = 48$\n    -   $N(X=1,Y=0,Z=1) = 112$\n    -   $N(X=0,Y=1,Z=1) = 12$\n    -   $N(X=0,Y=0,Z=1) = 28$\n\n**使用提取的已知条件进行验证：**\n让我们验证所提供计数的内部一致性。\n-   对于 $Z=0$：\n    -   $N(X=1, Z=0) = 36+4 = 40$。\n    -   $N(X=0, Z=0) = 144+16 = 160$。\n    -   $N(Y=1, Z=0) = 36+144 = 180$。\n    -   $N(Y=0, Z=0) = 4+16 = 20$。\n    -   $Z=0$ 的总数：$36+4+144+16=200$。这些计数与问题陈述中描述的边际总数一致。\n-   对于 $Z=1$：\n    -   $N(X=1, Z=1) = 48+112 = 160$。\n    -   $N(X=0, Z=1) = 12+28 = 40$。\n    -   $N(Y=1, Z=1) = 48+12 = 60$。\n    -   $N(Y=0, Z=1) = 112+28 = 140$。\n    -   $Z=1$ 的总数：$48+112+12+28=200$。这些计数与问题陈述中描述的边际总数一致。\n\n该问题具有科学依据，使用信息论中的标准概念来分析数据集，这是医学数据分析中的常见任务。设置是完整的，提供了所有必要的数据。问题是适定的、客观的，并且不包含任何矛盾。该情景是辛普森悖论的一个经典例证。\n\n**判定：** 问题有效。\n\n### 第 2 步：解答推导\n\n解答需要计算互信息 $I(X;Y)$ 和条件互信息 $I(X;Y \\mid Z)$。\n\n**1. 边际互信息 $I(X;Y)$ 的计算**\n\n首先，我们跨混杂因素 $Z$ 汇总数据，以获得 $(X,Y)$ 的边际计数。\n-   $N(X=1, Y=1) = N(X=1, Y=1, Z=0) + N(X=1, Y=1, Z=1) = 36 + 48 = 84$\n-   $N(X=1, Y=0) = N(X=1, Y=0, Z=0) + N(X=1, Y=0, Z=1) = 4 + 112 = 116$\n-   $N(X=0, Y=1) = N(X=0, Y=1, Z=0) + N(X=0, Y=1, Z=1) = 144 + 12 = 156$\n-   $N(X=0, Y=0) = N(X=0, Y=0, Z=0) + N(X=0, Y=0, Z=1) = 16 + 28 = 44$\n\n患者总数为 $N = 84+116+156+44 = 400$。根据这些计数，我们推导出联合概率分布 $P(X,Y)$：\n-   $P(X=1, Y=1) = 84/400 = 0.21$\n-   $P(X=1, Y=0) = 116/400 = 0.29$\n-   $P(X=0, Y=1) = 156/400 = 0.39$\n-   $P(X=0, Y=0) = 44/400 = 0.11$\n\n接下来，我们找到边际概率 $P(X)$ 和 $P(Y)$：\n-   $P(X=1) = P(X=1, Y=1) + P(X=1, Y=0) = 0.21 + 0.29 = 0.5$\n-   $P(X=0) = P(X=0, Y=1) + P(X=0, Y=0) = 0.39 + 0.11 = 0.5$\n-   $P(Y=1) = P(X=1, Y=1) + P(X=0, Y=1) = 0.21 + 0.39 = 0.6$\n-   $P(Y=0) = P(X=1, Y=0) + P(X=0, Y=0) = 0.29 + 0.11 = 0.4$\n\n互信息定义为 $I(X;Y) = \\sum_{x,y} P(x,y) \\log_2 \\frac{P(x,y)}{P(x)P(y)}$。\n让我们计算边际概率的乘积 $P(x)P(y)$:\n-   $P(X=1)P(Y=1) = 0.5 \\times 0.6 = 0.3$\n-   $P(X=1)P(Y=0) = 0.5 \\times 0.4 = 0.2$\n-   $P(X=0)P(Y=1) = 0.5 \\times 0.6 = 0.3$\n-   $P(X=0)P(Y=0) = 0.5 \\times 0.4 = 0.2$\n\n由于 $P(X,Y) \\neq P(X)P(Y)$，变量不是边际独立的，因此 $I(X;Y)$ 必须严格为正。\n$$ I(X;Y) = P(1,1)\\log_2\\frac{P(1,1)}{P(1)P(1)} + P(1,0)\\log_2\\frac{P(1,0)}{P(1)P(0)} + P(0,1)\\log_2\\frac{P(0,1)}{P(0)P(1)} + P(0,0)\\log_2\\frac{P(0,0)}{P(0)P(0)} $$\n$$ I(X;Y) = 0.21\\log_2\\frac{0.21}{0.3} + 0.29\\log_2\\frac{0.29}{0.2} + 0.39\\log_2\\frac{0.39}{0.3} + 0.11\\log_2\\frac{0.11}{0.2} $$\n$$ I(X;Y) = 0.21\\log_2(0.7) + 0.29\\log_2(1.45) + 0.39\\log_2(1.3) + 0.11\\log_2(0.55) $$\n使用 $\\log_2(a) \\approx 3.3219 \\ln(a)$:\n$$ I(X;Y) \\approx 0.21(-0.5146) + 0.29(0.5362) + 0.39(0.3785) + 0.11(-0.8625) $$\n$$ I(X;Y) \\approx -0.1081 + 0.1555 + 0.1476 - 0.0949 \\approx 0.1001 \\text{ 比特} $$\n所以，$I(X;Y)$ 严格为正，约为 $0.10$ 比特。\n\n**2. 条件互信息 $I(X;Y \\mid Z)$ 的计算**\n\nCMI 定义为 $I(X;Y \\mid Z) = \\sum_{z} P(z) I(X;Y \\mid Z=z)$。\n数据集被平均分配，所以 $P(Z=0) = 200/400 = 0.5$ 且 $P(Z=1) = 200/400 = 0.5$。\n我们需要为每个 $z$ 值计算 $I(X;Y \\mid Z=z)$。\n\n**对于 $Z=0$（低严重程度）：**\n计数是针对 $N_0=200$ 名患者给出的。我们计算在 $Z=0$ 条件下的条件概率：\n-   $P(X=1 \\mid Z=0) = (36+4)/200 = 40/200 = 0.2$\n-   $P(X=0 \\mid Z=0) = (144+16)/200 = 160/200 = 0.8$\n-   $P(Y=1 \\mid Z=0) = (36+144)/200 = 180/200 = 0.9$\n-   $P(Y=0 \\mid Z=0) = (4+16)/200 = 20/200 = 0.1$\n联合条件概率 $P(X,Y \\mid Z=0)$ 是：\n-   $P(X=1, Y=1 \\mid Z=0) = 36/200 = 0.18$\n-   $P(X=1, Y=0 \\mid Z=0) = 4/200 = 0.02$\n-   $P(X=0, Y=1 \\mid Z=0) = 144/200 = 0.72$\n-   $P(X=0, Y=0 \\mid Z=0) = 16/200 = 0.08$\n\n我们检查条件独立性：$P(X,Y \\mid Z=0) \\stackrel{?}{=} P(X \\mid Z=0) P(Y \\mid Z=0)$。\n-   $P(X=1 \\mid Z=0)P(Y=1 \\mid Z=0) = 0.2 \\times 0.9 = 0.18 = P(X=1, Y=1 \\mid Z=0)$\n-   $P(X=1 \\mid Z=0)P(Y=0 \\mid Z=0) = 0.2 \\times 0.1 = 0.02 = P(X=1, Y=0 \\mid Z=0)$\n-   $P(X=0 \\mid Z=0)P(Y=1 \\mid Z=0) = 0.8 \\times 0.9 = 0.72 = P(X=0, Y=1 \\mid Z=0)$\n-   $P(X=0 \\mid Z=0)P(Y=0 \\mid Z=0) = 0.8 \\times 0.1 = 0.08 = P(X=0, Y=0 \\mid Z=0)$\n由于等式对所有 $(x,y)$ 对都成立，变量 $X$ 和 $Y$ 在 $Z=0$ 条件下是条件独立的。因此，$I(X;Y \\mid Z=0) = 0$。\n\n**对于 $Z=1$（高严重程度）：**\n计数是针对 $N_1=200$ 名患者给出的。我们计算在 $Z=1$ 条件下的条件概率：\n-   $P(X=1 \\mid Z=1) = (48+112)/200 = 160/200 = 0.8$\n-   $P(X=0 \\mid Z=1) = (12+28)/200 = 40/200 = 0.2$\n-   $P(Y=1 \\mid Z=1) = (48+12)/200 = 60/200 = 0.3$\n-   $P(Y=0 \\mid Z=1) = (112+28)/200 = 140/200 = 0.7$\n联合条件概率 $P(X,Y \\mid Z=1)$ 是：\n-   $P(X=1, Y=1 \\mid Z=1) = 48/200 = 0.24$\n-   $P(X=1, Y=0 \\mid Z=1) = 112/200 = 0.56$\n-   $P(X=0, Y=1 \\mid Z=1) = 12/200 = 0.06$\n-   $P(X=0, Y=0 \\mid Z=1) = 28/200 = 0.14$\n\n我们检查条件独立性：$P(X,Y \\mid Z=1) \\stackrel{?}{=} P(X \\mid Z=1) P(Y \\mid Z=1)$。\n-   $P(X=1 \\mid Z=1)P(Y=1 \\mid Z=1) = 0.8 \\times 0.3 = 0.24 = P(X=1, Y=1 \\mid Z=1)$\n-   $P(X=1 \\mid Z=1)P(Y=0 \\mid Z=1) = 0.8 \\times 0.7 = 0.56 = P(X=1, Y=0 \\mid Z=1)$\n-   $P(X=0 \\mid Z=1)P(Y=1 \\mid Z=1) = 0.2 \\times 0.3 = 0.06 = P(X=0, Y=1 \\mid Z=1)$\n-   $P(X=0 \\mid Z=1)P(Y=0 \\mid Z=1) = 0.2 \\times 0.7 = 0.14 = P(X=0, Y=0 \\mid Z=1)$\n由于等式对所有 $(x,y)$ 对都成立，变量 $X$ 和 $Y$ 在 $Z=1$ 条件下也是条件独立的。因此，$I(X;Y \\mid Z=1) = 0$。\n\n最后，我们计算总的 CMI：\n$$ I(X;Y \\mid Z) = P(Z=0)I(X;Y \\mid Z=0) + P(Z=1)I(X;Y \\mid Z=1) $$\n$$ I(X;Y \\mid Z) = 0.5 \\times 0 + 0.5 \\times 0 = 0 $$\n\n**结果总结：**\n-   $I(X;Y) \\approx 0.10$ 比特（严格为正）\n-   $I(X;Y \\mid Z) = 0$ 比特\n\n这个结果展示了一个经典的混杂案例，通常与辛普森悖论相关。在低严重程度（$Z=0$）或高严重程度（$Z=1$）组内，治疗 $X$ 和结果 $Y$ 之间没有关联。然而，由于治疗分配与严重程度组高度相关（低严重程度组接受标准疗法，高严重程度组接受新疗法），当数据汇总时，出现了一种伪关联。互信息 $I(X;Y) > 0$ 捕捉到了这种表观的边际关联，而 $I(X;Y \\mid Z)=0$ 正确地显示了在考虑了混杂因素 $Z$ 之后关联的缺失。\n\n### 第 3 步：逐项分析\n\n**A. $I(X;Y)$ 严格为正（约 $0.10$ 比特），而 $I(X;Y \\mid Z)=0$；因此，表观关联完全由混杂因素 $Z$ 解释。**\n这个陈述准确地反映了我们的计算结果。我们发现 $I(X;Y) \\approx 0.10$ 比特且 $I(X;Y \\mid Z) = 0$。混杂因素 $Z$ 完全解释了表观关联的这一解释是从这些信息论量得出的正确结论。\n**判定：正确**\n\n**B. $I(X;Y)=0$，而 $I(X;Y \\mid Z)$ 严格为正；因此，以 $Z$ 为条件揭示了一个隐藏的关联。**\n这个陈述与我们的发现相矛盾。我们计算出 $I(X;Y) > 0$ 和 $I(X;Y \\mid Z) = 0$。此选项描述了相反的情况。\n**判定：不正确**\n\n**C. $I(X;Y)$ 和 $I(X;Y \\mid Z)$ 均为严格为正且近似相等。**\n这个陈述是不正确的，因为我们的计算显示 $I(X;Y \\mid Z) = 0$。这种情况将意味着 $Z$ 不是一个混杂因素，并且没有显著地调节 $X$ 和 $Y$ 之间的关系。\n**判定：不正确**\n\n**D. $I(X;Y)$ 和 $I(X;Y \\mid Z)$ 均为零；因此，$X$ 和 $Y$ 在边际上和条件上都是独立的。**\n这个陈述是不正确的，因为我们的计算显示 $I(X;Y) > 0$。这将意味着 $X$ 和 $Y$ 之间没有任何关系。\n**判定：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}