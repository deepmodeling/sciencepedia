{
    "hands_on_practices": [
        {
            "introduction": "To quantitatively understand gene expression, we must first translate the central dogma into a mathematical framework. This initial practice guides you through creating a fundamental model of transcription and translation using simple, yet powerful, first-order kinetics. By deriving the steady-state protein abundance and analyzing its sensitivity to each underlying rate, you will develop a foundational intuition for how cellular parameters collectively determine protein levels, a cornerstone of systems biology analysis .",
            "id": "4566761",
            "problem": "Consider a single gene expressed in a homogeneous cell population under steady environmental conditions. Messenger Ribonucleic Acid (mRNA) transcripts are synthesized by transcription at a constant rate $r_{\\text{tx}}$ (mRNA molecules per hour). Each mRNA produces protein by translation at a constant rate $r_{\\text{tl}}$ (proteins per mRNA per hour). Both mRNA and protein are removed by first-order processes with decay rate constants $\\gamma_m$ (per hour) and $\\gamma_p$ (per hour), respectively. Let $M(t)$ denote the mRNA abundance (molecules) and $P(t)$ the protein abundance (molecules) at time $t$, and assume a well-mixed compartment with deterministic mass-action dynamics. Using the Central Dogma of Molecular Biology and first-order birth–death process assumptions as the fundamental base, derive an expression for the steady-state protein abundance $P^{*}$ implied by this linear system. Then, quantify the local sensitivity of $P^{*}$ to each parameter $r_{\\text{tx}}$, $r_{\\text{tl}}$, $\\gamma_m$, and $\\gamma_p$ using the normalized logarithmic sensitivity coefficients defined for a generic parameter $x$ by $S_{x}=\\frac{\\partial \\ln P^{*}}{\\partial \\ln x}$.\n\nProvide your final answer as a single row matrix containing five entries in the following order: the steady-state protein abundance $P^{*}$, followed by the four normalized sensitivities $S_{r_{\\text{tx}}}$, $S_{r_{\\text{tl}}}}$, $S_{\\gamma_m}$, and $S_{\\gamma_p}$. Do not include units in the final matrix.",
            "solution": "The problem describes a two-stage model of constitutive gene expression, encompassing transcription and translation, based on the Central Dogma of Molecular Biology. The dynamics of the system can be represented by a pair of coupled linear ordinary differential equations (ODEs) for the abundance of messenger RNA, $M(t)$, and protein, $P(t)$.\n\nThe rate of change of the mRNA abundance, $\\frac{dM(t)}{dt}$, is given by the balance between its synthesis (transcription) and its degradation. The synthesis occurs at a constant rate $r_{\\text{tx}}$. The degradation is a first-order process, meaning the removal rate is proportional to the current abundance, with a rate constant of $\\gamma_m$. Thus, the first ODE is:\n$$\n\\frac{dM(t)}{dt} = r_{\\text{tx}} - \\gamma_m M(t)\n$$\n\nSimilarly, the rate of change of the protein abundance, $\\frac{dP(t)}{dt}$, is determined by the balance between its synthesis (translation) and its degradation. The synthesis rate is proportional to the number of available mRNA molecules, $M(t)$, with a rate constant $r_{\\text{tl}}$. The degradation is also a first-order process with a rate constant $\\gamma_p$. This leads to the second ODE:\n$$\n\\frac{dP(t)}{dt} = r_{\\text{tl}} M(t) - \\gamma_p P(t)\n$$\n\nThe problem asks for the steady-state protein abundance, denoted by $P^{*}$. At steady state, the abundances of mRNA and protein no longer change with time. This condition is mathematically expressed by setting the time derivatives to zero: $\\frac{dM}{dt} = 0$ and $\\frac{dP}{dt} = 0$. Let $M^{*}$ and $P^{*}$ be the steady-state abundances.\n\nFrom the first equation at steady state:\n$$\n0 = r_{\\text{tx}} - \\gamma_m M^{*}\n$$\nSolving for the steady-state mRNA abundance $M^{*}$ yields:\n$$\nM^{*} = \\frac{r_{\\text{tx}}}{\\gamma_m}\n$$\n\nNow, we use the second equation at steady state:\n$$\n0 = r_{\\text{tl}} M^{*} - \\gamma_p P^{*}\n$$\nSolving for the steady-state protein abundance $P^{*}$ gives:\n$$\nP^{*} = \\frac{r_{\\text{tl}}}{\\gamma_p} M^{*}\n$$\nSubstituting the expression for $M^{*}$ into the equation for $P^{*}$, we obtain the final expression for the steady-state protein abundance:\n$$\nP^{*} = \\frac{r_{\\text{tl}}}{\\gamma_p} \\left( \\frac{r_{\\text{tx}}}{\\gamma_m} \\right) = \\frac{r_{\\text{tx}} r_{\\text{tl}}}{\\gamma_m \\gamma_p}\n$$\nThis is the first required result.\n\nNext, we must quantify the local sensitivity of $P^{*}$ to each of the four parameters: $r_{\\text{tx}}$, $r_{\\text{tl}}$, $\\gamma_m$, and $\\gamma_p$. The sensitivity is measured by the normalized logarithmic sensitivity coefficient, defined as $S_{x} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln x}$ for a generic parameter $x$. This quantity measures the fractional change in $P^{*}$ resulting from a fractional change in $x$.\n\nA useful property of this definition is that $\\frac{\\partial \\ln P^{*}}{\\partial \\ln x} = \\frac{x}{P^{*}} \\frac{\\partial P^{*}}{\\partial x}$. However, it is often simpler to first take the natural logarithm of the expression for $P^{*}$ and then differentiate.\nThe natural logarithm of $P^{*}$ is:\n$$\n\\ln(P^{*}) = \\ln\\left(\\frac{r_{\\text{tx}} r_{\\text{tl}}}{\\gamma_m \\gamma_p}\\right)\n$$\nUsing the properties of logarithms, this can be expanded as:\n$$\n\\ln(P^{*}) = \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p)\n$$\nNow we can compute the four sensitivity coefficients by taking the partial derivative of $\\ln(P^{*})$ with respect to the natural logarithm of each parameter.\n\n1. Sensitivity to the transcription rate, $r_{\\text{tx}}$:\n$$\nS_{r_{\\text{tx}}} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln r_{\\text{tx}}} = \\frac{\\partial}{\\partial \\ln r_{\\text{tx}}} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right]\n$$\nSince $\\ln(r_{\\text{tl}})$, $\\ln(\\gamma_m)$, and $\\ln(\\gamma_p)$ are treated as constants with respect to the differentiation variable $\\ln(r_{\\text{tx}})$, this simplifies to:\n$$\nS_{r_{\\text{tx}}} = \\frac{\\partial \\ln(r_{\\text{tx}})}{\\partial \\ln r_{\\text{tx}}} = 1\n$$\n\n2. Sensitivity to the translation rate, $r_{\\text{tl}}$:\n$$\nS_{r_{\\text{tl}}} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln r_{\\text{tl}}} = \\frac{\\partial}{\\partial \\ln r_{\\text{tl}}} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right] = \\frac{\\partial \\ln(r_{\\text{tl}})}{\\partial \\ln r_{\\text{tl}}} = 1\n$$\n\n3. Sensitivity to the mRNA decay rate, $\\gamma_m$:\n$$\nS_{\\gamma_m} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln \\gamma_m} = \\frac{\\partial}{\\partial \\ln \\gamma_m} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right] = -\\frac{\\partial \\ln(\\gamma_m)}{\\partial \\ln \\gamma_m} = -1\n$$\n\n4. Sensitivity to the protein decay rate, $\\gamma_p$:\n$$\nS_{\\gamma_p} = \\frac{\\partial \\ln P^{*}}{\\partial \\ln \\gamma_p} = \\frac{\\partial}{\\partial \\ln \\gamma_p} \\left[ \\ln(r_{\\text{tx}}) + \\ln(r_{\\text{tl}}) - \\ln(\\gamma_m) - \\ln(\\gamma_p) \\right] = -\\frac{\\partial \\ln(\\gamma_p)}{\\partial \\ln \\gamma_p} = -1\n$$\n\nIn summary, the steady-state protein abundance is directly proportional to the synthesis rates ($r_{\\text{tx}}$, $r_{\\text{tl}}$) and inversely proportional to the decay rates ($\\gamma_m$, $\\gamma_p$). The sensitivities of $1$ indicate that a $1\\%$ increase in a synthesis rate leads to a $1\\%$ increase in protein abundance. The sensitivities of $-1$ indicate that a $1\\%$ increase in a decay rate leads to a $1\\%$ decrease in protein abundance.\n\nThe final answer is a row matrix containing $P^{*}$, $S_{r_{\\text{tx}}}$, $S_{r_{\\text{tl}}}$, $S_{\\gamma_m}$, and $S_{\\gamma_p}$ in that order.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{r_{\\text{tx}} r_{\\text{tl}}}{\\gamma_m \\gamma_p} & 1 & 1 & -1 & -1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building on our steady-state model, we now zoom in on a critical regulatory step: translation initiation. This process is far from simple, and genetic variants can disrupt it in subtle ways. This exercise challenges you to apply the eukaryotic scanning model and probability theory to predict the quantitative impact of an upstream start codon (uAUG), a common type of genetic variant, on the final protein output. Mastering this allows you to connect a specific molecular event to its functional consequence, a key skill in interpreting the effects of genetic variation .",
            "id": "4566762",
            "problem": "A clinical variant in the $5^{\\prime}$ untranslated region (UTR) of a human gene introduces an upstream AUG (uAUG) that creates an upstream open reading frame (uORF). Under the eukaryotic scanning model, the $43\\mathrm{S}$ preinitiation complex (PIC) binds at the $5^{\\prime}$ cap and scans in the $5^{\\prime} \\to 3^{\\prime}$ direction. At each AUG, initiation can occur with a probability that depends on the local Kozak context and other features. If the PIC initiates at a uAUG and translates a uORF, it may, after termination, retain the small subunit and reinitiate scanning with some probability, potentially initiating at the downstream main AUG. Assume the following for a specific transcript quantified by ribosome profiling-derived predictors:\n- In the reference allele (no uAUG present), the main start codon (mAUG) has a predicted recognition probability $p_{m} = 0.72$.\n- In the variant allele, a strong uAUG with predicted recognition probability $p_{u} = 0.85$ appears upstream of the mAUG, defining a uORF of length $21$ codons that terminates $35$ nucleotides upstream of the mAUG. For this geometry, the probability of small-subunit retention and reinitiation on the same scanning pass is estimated as $r = 0.20$.\n- When the PIC encounters any AUG, recognition is an independent Bernoulli event with the stated probability for that AUG. If a uORF is initiated, the scanning pass proceeds to the mAUG only if reinitiation occurs; otherwise, the complex dissociates and the main AUG is not used on that pass. Assume no additional uAUGs, no internal entry, and neglect drop-off during scanning and any post-transcriptional decay effects.\n\nUsing only these assumptions and the core scanning model of eukaryotic translation initiation, compute the expected fold-change in initiation probability at the mAUG for the variant relative to the reference, that is, compute $\\frac{P_{\\text{variant}}(\\text{init at mAUG})}{P_{\\text{reference}}(\\text{init at mAUG})}$. Report a single number as a decimal rounded to $4$ significant figures. Do not use a percent sign.",
            "solution": "The objective is to compute the fold-change in the probability of translation initiation at the main start codon (mAUG) for a gene variant relative to its reference allele. This is the ratio of the initiation probability in the variant to the initiation probability in the reference.\n\nLet $P_{\\text{reference}}$ be the probability of initiation at the mAUG in the reference allele.\nLet $P_{\\text{variant}}$ be the probability of initiation at the mAUG in the variant allele.\n\nFirst, we calculate $P_{\\text{reference}}$.\nIn the reference allele, there is no upstream AUG (uAUG). According to the scanning model, the preinitiation complex (PIC) binds and scans to the mAUG. The problem states that the recognition probability of the mAUG is $p_m$. Therefore, the probability that a scanning PIC initiates at the mAUG is simply:\n$$\nP_{\\text{reference}} = p_m\n$$\n\nNext, we calculate $P_{\\text{variant}}$.\nIn the variant allele, a scanning PIC encounters the uAUG first. Two mutually exclusive events can lead to initiation at the downstream mAUG:\n\n1.  **Leaky Scanning**: The PIC scans over the uAUG without initiating translation. This occurs with probability $1 - p_u$. The PIC then continues scanning until it reaches the mAUG, at which point it initiates with probability $p_m$. The combined probability of this path is the product of the probabilities of these independent events:\n    $$\n    P(\\text{Path 1}) = (1 - p_u) \\cdot p_m\n    $$\n\n2.  **Initiation at uAUG and Reinitiation**: The PIC initiates translation at the uAUG, which occurs with probability $p_u$. After translating the uORF, the small ribosomal subunit may be retained and resume scanning. This reinitiation event occurs with probability $r$. If reinitiation is successful, the PIC continues to scan and reaches the mAUG, where it initiates with probability $p_m$. The combined probability of this path is the product of this sequence of independent events:\n    $$\n    P(\\text{Path 2}) = p_u \\cdot r \\cdot p_m\n    $$\n\nThe total probability of initiation at the mAUG in the variant allele, $P_{\\text{variant}}$, is the sum of the probabilities of these two disjoint paths:\n$$\nP_{\\text{variant}} = P(\\text{Path 1}) + P(\\text{Path 2}) = (1 - p_u)p_m + p_u r p_m\n$$\nWe can factor out $p_m$:\n$$\nP_{\\text{variant}} = p_m (1 - p_u + p_u r) = p_m (1 - p_u(1 - r))\n$$\n\nNow, we can compute the desired fold-change, which is the ratio $\\frac{P_{\\text{variant}}}{P_{\\text{reference}}}$.\n$$\n\\text{Fold-change} = \\frac{P_{\\text{variant}}}{P_{\\text{reference}}} = \\frac{p_m (1 - p_u(1 - r))}{p_m}\n$$\nThe term $p_m$ cancels out:\n$$\n\\text{Fold-change} = 1 - p_u(1 - r)\n$$\nSubstituting the given numerical values, $p_u = 0.85$ and $r = 0.20$:\n$$\n\\text{Fold-change} = 1 - 0.85 \\times (1 - 0.20)\n$$\n$$\n\\text{Fold-change} = 1 - 0.85 \\times 0.80\n$$\n$$\n\\text{Fold-change} = 1 - 0.68 = 0.32\n$$\nThe problem requires the answer to be reported as a decimal rounded to $4$ significant figures.\n$$\n\\text{Fold-change} = 0.3200\n$$",
            "answer": "$$ \\boxed{0.3200} $$"
        },
        {
            "introduction": "In a real-world clinical context, a single variant can disrupt multiple stages of gene expression, and our predictions for each effect carry different levels of certainty. This final practice simulates the challenge of variant prioritization by asking you to synthesize multiple lines of evidence into a single, interpretable pathogenicity score. You will construct a weighted model that integrates predicted effects on splicing, mRNA stability, and translation efficiency, learning how to combine disparate data sources to assess a variant's overall functional impact—a cornerstone of computational genomics in medicine .",
            "id": "4566707",
            "problem": "You are given a set of patient-specific variant effect predictions related to gene expression mechanisms, specifically splicing, alternative polyadenylation, and translation efficiency. Using a principled model grounded in the Central Dogma of Molecular Biology and steady-state kinetics of messenger ribonucleic acid (mRNA) and protein, design a program that integrates these predictions into a composite pathogenicity score. The program must compute, for each provided test case, a dimensionless scalar that estimates the expected fractional reduction in functional protein output attributable to the variant. The output for all test cases must be reported on a single line as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places.\n\nFundamental base and required modeling assumptions:\n\n- Begin from the Central Dogma of Molecular Biology, which states that deoxyribonucleic acid (DNA) is transcribed to mRNA and mRNA is translated to protein. At steady state, the abundance of mRNA is set by a balance of production and degradation, and protein production is proportional to mRNA abundance times translation efficiency.\n- Let $r_{\\mathrm{tx}}$ denote the transcription rate of pre-mRNA, $s$ denote the fraction of transcripts that are correctly spliced and competent for export and translation (functional isoforms), $k_{\\mathrm{deg}}$ denote the mRNA decay rate constant, and $\\mathrm{TE}$ denote translation efficiency (proteins produced per mRNA per unit time). At steady state, the expected protein production rate is proportional to $P \\propto \\dfrac{r_{\\mathrm{tx}} \\cdot s}{k_{\\mathrm{deg}}} \\cdot \\mathrm{TE}$.\n- Consider a variant that perturbs splicing, polyadenylation, and translation. The perturbed values are $s'$, $k_{\\mathrm{deg}}'$, and $\\mathrm{TE}'$. Assuming the transcription rate $r_{\\mathrm{tx}}$ is unchanged by the variant, the ratio of variant to baseline protein output is\n$$\nR \\;=\\; \\frac{P'}{P} \\;=\\; \\left(\\frac{s'}{s}\\right) \\cdot \\left(\\frac{k_{\\mathrm{deg}}}{k_{\\mathrm{deg}}'}\\right) \\cdot \\left(\\frac{\\mathrm{TE}'}{\\mathrm{TE}}\\right).\n$$\n- To translate predictions into the above quantities:\n    - Splicing: Let the baseline functional isoform fraction be $F_0 \\in [0,1]$. Let the predicted change in the functional isoform's Percent Spliced In (PSI) be $\\Delta \\psi$ (expressed as a decimal, not a percentage). Then $s = F_0$ and $s' = \\mathrm{clip}(F_0 + \\Delta \\psi, 0, 1)$, with ratio $\\dfrac{s'}{s} = \\dfrac{\\mathrm{clip}(F_0 + \\Delta \\psi, 0, 1)}{F_0}$ for $F_0 > 0$.\n    - Alternative polyadenylation: Let the proximal polyadenylation site usage be $u_{\\mathrm{prox}} \\in [0,1]$ with a predicted change $\\Delta u$ (decimal). Let the proximal and distal $3'$ untranslated region (UTR) lengths be $L_{\\mathrm{prox}}$ and $L_{\\mathrm{dist}}$ in nucleotides. The baseline effective UTR length is $L = u_{\\mathrm{prox}} L_{\\mathrm{prox}} + (1-u_{\\mathrm{prox}}) L_{\\mathrm{dist}}$, and the perturbed length is $L' = u_{\\mathrm{prox}}' L_{\\mathrm{prox}} + (1-u_{\\mathrm{prox}}') L_{\\mathrm{dist}}$ where $u_{\\mathrm{prox}}' = \\mathrm{clip}(u_{\\mathrm{prox}} + \\Delta u, 0, 1)$. Empirically, longer $3'$ UTRs tend to increase decay. Model the decay change with sensitivity $\\gamma > 0$ as $k_{\\mathrm{deg}}' = k_{\\mathrm{deg}} \\cdot \\exp\\!\\left(\\gamma \\cdot \\frac{L' - L}{L}\\right)$, yielding the factor $\\dfrac{k_{\\mathrm{deg}}}{k_{\\mathrm{deg}}'} = \\exp\\!\\left(-\\gamma \\cdot \\frac{L' - L}{L}\\right)$.\n    - Translation efficiency: Let the predicted translation efficiency fold-change be $f_{\\mathrm{TE}} = \\dfrac{\\mathrm{TE}'}{\\mathrm{TE}}$, where $f_{\\mathrm{TE}} > 0$.\n- Evidence reliability weighting: Let $w_s, w_p, w_t \\in [0,1]$ be reliability weights for splicing, polyadenylation, and translation predictions, respectively, with the constraint $w_s + w_p + w_t = 1$. To attenuate uncertain effects, combine in log-space to obtain\n$$\n\\log R_{\\mathrm{weighted}} \\;=\\; w_s \\log\\!\\left(\\frac{s'}{s}\\right) \\;+\\; w_p \\log\\!\\left(\\exp\\!\\left(-\\gamma \\cdot \\frac{L' - L}{L}\\right)\\right) \\;+\\; w_t \\log\\!\\left(f_{\\mathrm{TE}}\\right),\n$$\nwhich simplifies to\n$$\nR_{\\mathrm{weighted}} \\;=\\; \\left(\\frac{s'}{s}\\right)^{w_s} \\cdot \\left(\\exp\\!\\left(-\\gamma \\cdot \\frac{L' - L}{L}\\right)\\right)^{w_p} \\cdot \\left(f_{\\mathrm{TE}}\\right)^{w_t}.\n$$\n- The composite pathogenicity score is defined as\n$$\nS \\;=\\; \\mathrm{clip}\\!\\left(1 - R_{\\mathrm{weighted}}, \\; 0, \\; 1\\right),\n$$\nwhich captures the fractional reduction in functional protein output due to the variant, bounded between $0$ and $1$.\n\nYour task:\n\n- Implement a program that, for each test case in the test suite below, computes $S$ following the above definitions. No physical units are required because the output is dimensionless.\n- Edge-case handling: Apply clipping for $s'$ and $u_{\\mathrm{prox}}'$ to the interval $[0,1]$. Assume $F_0 > 0$ and $L > 0$. Assume $f_{\\mathrm{TE}} > 0$. The exponential and power operations must be defined for all inputs under these constraints.\n- The final output format must be a single line containing the results as a comma-separated list enclosed in square brackets (for example, $[s_1,s_2,s_3]$) with each $s_i$ rounded to $6$ decimal places.\n\nTest suite:\n\nProvide exactly the following five test cases as ordered inputs to your program. Each case is a tuple of parameters $(F_0, \\Delta \\psi, u_{\\mathrm{prox}}, \\Delta u, L_{\\mathrm{prox}}, L_{\\mathrm{dist}}, \\gamma, f_{\\mathrm{TE}}, w_s, w_p, w_t)$.\n\n- Case $1$ (general integration, all effects present): $(0.7, -0.2, 0.6, -0.3, 800, 1600, 0.35, 0.8, 0.5, 0.3, 0.2)$.\n- Case $2$ (no predicted effect): $(0.6, 0.0, 0.5, 0.0, 1000, 1500, 0.3, 1.0, 0.4, 0.4, 0.2)$.\n- Case $3$ (severe splicing loss-of-function): $(0.9, -0.9, 0.5, 0.05, 900, 1400, 0.25, 1.0, 0.8, 0.1, 0.1)$.\n- Case $4$ (putative beneficial variant; tests clipping at $0$): $(0.75, 0.1, 0.4, 0.3, 800, 1800, 0.4, 1.2, 0.4, 0.4, 0.2)$.\n- Case $5$ (near-boundary baseline functional fraction, strong polyadenylation effect): $(0.05, -0.04, 0.7, -0.2, 700, 1700, 0.6, 0.9, 0.2, 0.6, 0.2)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[0.123456,0.000000,0.987654,0.000000,0.543210]$), with each value rounded to $6$ decimal places.",
            "solution": "The solution proceeds by first dissecting the provided quantitative model and then structuring a program to implement it. The core task is to calculate a composite pathogenicity score, $S$, which represents the fractional reduction in functional protein output due to a genetic variant. This score integrates predicted effects on three key stages of gene expression: splicing, mRNA stability (via alternative polyadenylation), and translation.\n\nThe model begins with a steady-state representation of protein production, $P$, where $P$ is proportional to the product of mRNA production and translation efficiency. The production of mature, translatable mRNA is determined by the transcription rate, $r_{\\mathrm{tx}}$, the fraction of transcripts correctly spliced, $s$, and the mRNA decay rate constant, $k_{\\mathrm{deg}}$. The protein production rate is then given by $P \\propto \\frac{r_{\\mathrm{tx}} \\cdot s}{k_{\\mathrm{deg}}} \\cdot \\mathrm{TE}$, where $\\mathrm{TE}$ is the translation efficiency.\n\nA variant is assumed to perturb the baseline parameters $s$, $k_{\\mathrm{deg}}$, and $\\mathrm{TE}$ to new values $s'$, $k_{\\mathrm{deg}}'$, and $\\mathrm{TE}'$, respectively, while leaving the transcription rate $r_{\\mathrm{tx}}$ unchanged. The ratio of the variant protein output, $P'$, to the baseline output, $P$, is therefore:\n$$\nR = \\frac{P'}{P} = \\left(\\frac{s'}{s}\\right) \\cdot \\left(\\frac{k_{\\mathrm{deg}}}{k_{\\mathrm{deg}}'}\\right) \\cdot \\left(\\frac{\\mathrm{TE}'}{\\mathrm{TE}}\\right)\n$$\nThis ratio $R$ represents the relative functional protein output of the variant allele. Our objective is to calculate this value by modeling each of its three constituent terms.\n\n**1. Splicing Effect Term: $\\left(\\frac{s'}{s}\\right)$**\n\nThis term quantifies the change in the fraction of functional mRNA isoforms. The baseline fraction of functional isoforms is given as $s = F_0$, where $F_0 \\in [0, 1]$. A variant's effect is given by a predicted change, $\\Delta\\psi$, in the \"Percent Spliced In\" (PSI) of the functional isoform. The new fraction of functional isoforms, $s'$, is thus modeled as $s' = F_0 + \\Delta\\psi$. To ensure this fraction remains physically meaningful (i.e., within the range $[0, 1]$), it is clipped:\n$$\ns' = \\mathrm{clip}(F_0 + \\Delta\\psi, 0, 1)\n$$\nThe splicing effect term is the ratio of the new fraction to the old:\n$$\n\\text{Splicing Ratio} = \\frac{s'}{s} = \\frac{\\mathrm{clip}(F_0 + \\Delta\\psi, 0, 1)}{F_0}\n$$\nThe problem statement guarantees $F_0 > 0$, so this division is always defined.\n\n**2. mRNA Stability Effect Term: $\\left(\\frac{k_{\\mathrm{deg}}}{k_{\\mathrm{deg}}'}\\right)$**\n\nThis term quantifies the change in mRNA stability, which is inversely related to the decay rate constant $k_{\\mathrm{deg}}$. The model links mRNA stability to the length of the $3'$ untranslated region ($3'$ UTR), mediated by alternative polyadenylation (APA). A shift in APA site usage alters the effective $3'$ UTR length. Let $u_{\\mathrm{prox}}$ be the baseline usage of a proximal polyadenylation site, and $L_{\\mathrm{prox}}$ and $L_{\\mathrm{dist}}$ be the lengths of the resulting short and long $3'$ UTRs, respectively. The baseline average UTR length, $L$, is a weighted average:\n$$\nL = u_{\\mathrm{prox}} L_{\\mathrm{prox}} + (1 - u_{\\mathrm{prox}}) L_{\\mathrm{dist}}\n$$\nA variant induces a change $\\Delta u$ in proximal site usage. The new usage, $u'_{\\mathrm{prox}}$, is clipped to the interval $[0, 1]$:\n$$\nu'_{\\mathrm{prox}} = \\mathrm{clip}(u_{\\mathrm{prox}} + \\Delta u, 0, 1)\n$$\nThis leads to a new average UTR length, $L'$:\n$$\nL' = u'_{\\mathrm{prox}} L_{\\mathrm{prox}} + (1 - u'_{\\mathrm{prox}}) L_{\\mathrm{dist}}\n$$\nThe model then posits an exponential relationship between the change in UTR length and the change in decay rate, governed by a sensitivity parameter $\\gamma > 0$:\n$$\nk_{\\mathrm{deg}}' = k_{\\mathrm{deg}} \\cdot \\exp\\left(\\gamma \\cdot \\frac{L' - L}{L}\\right)\n$$\nThe required ratio for the mRNA stability effect is therefore:\n$$\n\\text{Stability Ratio} = \\frac{k_{\\mathrm{deg}}}{k_{\\mathrm{deg}}'} = \\exp\\left(-\\gamma \\cdot \\frac{L' - L}{L}\\right)\n$$\nThis assumes $L > 0$, which is guaranteed by the problem statement.\n\n**3. Translation Efficiency Effect Term: $\\left(\\frac{\\mathrm{TE}'}{\\mathrm{TE}}\\right)$**\n\nThis term is provided directly as a predicted fold-change, $f_{\\mathrm{TE}}$, where $f_{\\mathrm{TE}} > 0$.\n$$\n\\text{Translation Ratio} = \\frac{\\mathrm{TE}'}{\\mathrm{TE}} = f_{\\mathrm{TE}}\n$$\n\n**4. Weighted Aggregation and Final Score**\n\nThe three effect ratios are not combined directly. Instead, they are weighted based on the reliability of the underlying predictions, given by weights $w_s, w_p, w_t \\in [0, 1]$ that sum to $1$. The aggregation is performed via a weighted geometric mean, which is equivalent to a linear combination in log-space. This attenuates the impact of less certain predictions. The final weighted ratio, $R_{\\mathrm{weighted}}$, is:\n$$\nR_{\\mathrm{weighted}} = \\left(\\frac{s'}{s}\\right)^{w_s} \\cdot \\left(\\frac{k_{\\mathrm{deg}}}{k_{\\mathrm{deg}}'}\\right)^{w_p} \\cdot \\left(f_{\\mathrm{TE}}\\right)^{w_t}\n$$\nThe composite pathogenicity score $S$ is defined as the fractional reduction in protein output, which is $1 - R_{\\mathrm{weighted}}$. This score is also clipped to the $[0, 1]$ range to handle cases where a variant might be predicted to be neutral ($R_{\\mathrm{weighted}} \\approx 1$) or beneficial ($R_{\\mathrm{weighted}} > 1$).\n$$\nS = \\mathrm{clip}(1 - R_{\\mathrm{weighted}}, 0, 1)\n$$\nThe algorithm will implement these calculations step-by-step for each of the provided test cases. The `numpy` library is suitable for numerical operations like `clip` and `exp`. The final results are collected and formatted as a comma-separated string, with each value rounded to six decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a composite pathogenicity score for genetic variants based on a\n    model of gene expression, integrating effects on splicing, alternative\n    polyadenylation, and translation efficiency.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of parameters:\n    # (F_0, delta_psi, u_prox, delta_u, L_prox, L_dist, gamma, f_TE, w_s, w_p, w_t)\n    test_cases = [\n        # Case 1 (general integration, all effects present)\n        (0.7, -0.2, 0.6, -0.3, 800, 1600, 0.35, 0.8, 0.5, 0.3, 0.2),\n        # Case 2 (no predicted effect)\n        (0.6, 0.0, 0.5, 0.0, 1000, 1500, 0.3, 1.0, 0.4, 0.4, 0.2),\n        # Case 3 (severe splicing loss-of-function)\n        (0.9, -0.9, 0.5, 0.05, 900, 1400, 0.25, 1.0, 0.8, 0.1, 0.1),\n        # Case 4 (putative beneficial variant; tests clipping at 0)\n        (0.75, 0.1, 0.4, 0.3, 800, 1800, 0.4, 1.2, 0.4, 0.4, 0.2),\n        # Case 5 (near-boundary baseline functional fraction, strong polyadenylation effect)\n        (0.05, -0.04, 0.7, -0.2, 700, 1700, 0.6, 0.9, 0.2, 0.6, 0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        F0, delta_psi, u_prox, delta_u, L_prox, L_dist, gamma, f_TE, ws, wp, wt = case\n\n        # 1. Splicing effect term\n        # The base fraction s is F0.\n        # The perturbed fraction s' is clipped to [0, 1].\n        s_prime = np.clip(F0 + delta_psi, 0.0, 1.0)\n        # Splicing ratio is s'/s. F0 > 0 is guaranteed by the problem.\n        splicing_ratio = s_prime / F0\n\n        # 2. mRNA stability effect term (from alternative polyadenylation)\n        # Baseline effective 3' UTR length\n        L = u_prox * L_prox + (1.0 - u_prox) * L_dist\n        # Perturbed proximal polyA site usage, clipped to [0, 1]\n        u_prox_prime = np.clip(u_prox + delta_u, 0.0, 1.0)\n        # Perturbed effective 3' UTR length\n        L_prime = u_prox_prime * L_prox + (1.0 - u_prox_prime) * L_dist\n\n        # Calculate decay rate ratio. L > 0 is guaranteed.\n        # If L' == L, the exponent is 0 and the ratio is 1.\n        if L == 0:\n             # This case is excluded by the problem statement (L > 0)\n             # but handle defensively.\n             stability_ratio = 1.0\n        else:\n             stability_ratio = np.exp(-gamma * (L_prime - L) / L)\n\n        # 3. Translation efficiency effect term\n        # This is given directly by f_TE.\n        translation_ratio = f_TE\n\n        # 4. Weighted aggregation of effects (weighted geometric mean)\n        # The power calculation correctly handles a base of 0 if the exponent is positive.\n        R_weighted = (splicing_ratio ** ws) * \\\n                     (stability_ratio ** wp) * \\\n                     (translation_ratio ** wt)\n\n        # 5. Composite pathogenicity score S\n        # The score is the fractional reduction in protein, clipped to [0, 1].\n        S = np.clip(1.0 - R_weighted, 0.0, 1.0)\n        \n        results.append(S)\n\n    # Format the results as specified: a list of numbers rounded to 6 decimal places,\n    # enclosed in square brackets and separated by commas.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}