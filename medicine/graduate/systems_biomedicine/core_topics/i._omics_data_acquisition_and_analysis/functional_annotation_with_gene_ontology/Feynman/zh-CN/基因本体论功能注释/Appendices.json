{
    "hands_on_practices": [
        {
            "introduction": "基因富集分析的有效性取决于将目标基因集与一个恰当的“全景”或背景基因集进行比较。这个练习  通过定量计算的方式，展示了一个看似微小的错误——使用整个基因组作为背景，而不是实验中可检测到的基因集——如何导致结果出现显著偏差。掌握这一概念是进行任何有效富集分析的基础。",
            "id": "4344210",
            "problem": "在使用基因本体论 (GO) 进行功能注释时，我们会检验一组差异表达基因相对于一个合适的背景集是否在某个 GO 术语上富集。合适的背景是该检测方法能够检测到的基因集合，而不是整个基因组。考虑以下这个科学上真实的简化场景，它旨在分离出选择不正确背景所带来的影响。\n\n一项靶向检测研究了一个包含 $N=30$ 个基因的精选基因板。经过严格的质量控制后，该基因板中只有 $D=20$ 个基因被认为是可检测的。一个特定的 GO 术语 $T$ 注释了完整基因板中 $N=30$ 个基因里的 $K_{\\mathrm{genome}}=10$ 个，以及 $D=20$ 个可检测基因中的 $K_{\\mathrm{detectable}}=8$ 个。在一个感兴趣的对比中，差异分析产生了一个大小为 $n=5$ 的基因集，其中有 $k=3$ 个基因被术语 $T$ 注释。\n\n仅从无放回抽样和组合计数的基本原理出发，并将单侧富集显著性视为从一个包含总共 $N$ 个项目、其中 $K$ 个为注释项的背景中，进行 $n$ 次抽取，抽到至少 $k$ 个注释项的概率，请完成以下任务：\n\n1. 对于参数为 $(N,K)$ 的背景，推导在 $n$ 次抽样中观察到至少 $k$ 个注释基因的单侧尾部概率的通用计数表达式。\n2. 使用观测到的 $(n=5, k=3)$，对两种背景选择——不正确的“基因组”背景 $(N=30, K=10)$ 和正确的可检测背景 $(N=20, K=8)$——分别计算此概率。\n3. 将显著性膨胀因子定义为 $I = p_{\\mathrm{detectable}} / p_{\\mathrm{genome}}$，其中 $p_{\\mathrm{detectable}}$ 是在可检测背景下的单侧 $p$ 值，$p_{\\mathrm{genome}}$ 是在基因组背景下的单侧 $p$ 值。计算 $I$。\n\n将 $I$ 报告为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "对于一个给定的术语，基因本体论 (GO) 富集检验将研究集内观察到的注释基因数与从指定背景进行无放回随机抽样所期望的分布进行比较。一项检测的正确背景是该检测方法能够检测到的基因集合；使用过大或过小的背景会改变零分布，并可能使显著性产生偏差。\n\n基本原理：从一个有限总体中进行无放回抽样，该总体共有 $N$ 个项目，其中 $K$ 个是“已注释”的（成功），$N-K$ 个是“未注释”的（失败）。无放回地抽取 $n$ 个项目，得到一个随机变量 $X$，它等于抽中已注释项目的数量。$X$ 的精确分布是源于组合计数的超几何分布：抽取恰好 $i$ 个已注释项目和 $n-i$ 个未注释项目的方法数，等于选择已注释项目的方法数与选择未注释项目的方法数的乘积，再除以从 $N$ 个项目中选择 $n$ 个项目的总方法数。\n\n1. 单侧尾部概率的推导。在 $n$ 次抽样中观察到恰好 $i$ 个注释项的概率是\n$$\n\\Pr(X=i) = \\frac{\\binom{K}{i}\\,\\binom{N-K}{n-i}}{\\binom{N}{n}},\n$$\n这是通过计数得到的：选择 $i$ 个注释项有 $\\binom{K}{i}$ 种方式，选择 $n-i$ 个非注释项有 $\\binom{N-K}{n-i}$ 种方式，然后用大小为 $n$ 的子集总数 $\\binom{N}{n}$ 进行归一化。对于观察到 $k$ 个或更多注释项的单侧富集显著性是上尾概率\n$$\np(N,K;n,k) \\equiv \\Pr(X \\ge k) = \\sum_{i=k}^{\\min\\{K,n\\}} \\frac{\\binom{K}{i}\\,\\binom{N-K}{n-i}}{\\binom{N}{n}}.\n$$\n\n2. 使用观测值 $n=5$ 和 $k=3$ 对两种背景分别进行评估。\n\n(a) 不正确的“基因组”背景：$(N,K)=(30,10)$。\n这里 $\\min\\{K,n\\}=\\min\\{10,5\\}=5$，所以\n$$\np_{\\mathrm{genome}} = \\sum_{i=3}^{5} \\frac{\\binom{10}{i}\\,\\binom{20}{5-i}}{\\binom{30}{5}}.\n$$\n计算每一项：\n- 对于 $i=3$：$\\binom{10}{3}=120$，$\\binom{20}{2}=190$，乘积为 $120 \\times 190 = 22800$。\n- 对于 $i=4$：$\\binom{10}{4}=210$，$\\binom{20}{1}=20$，乘积为 $210 \\times 20 = 4200$。\n- 对于 $i=5$：$\\binom{10}{5}=252$，$\\binom{20}{0}=1$，乘积为 $252 \\times 1 = 252$。\n\n分子之和：$22800 + 4200 + 252 = 27252$。\n\n分母：$\\binom{30}{5} = 142506$。\n\n因此\n$$\np_{\\mathrm{genome}} = \\frac{27252}{142506}.\n$$\n此分数可通过将分子和分母同除以 $18$ 来简化：\n$$\n\\frac{27252}{142506} = \\frac{1514}{7917}.\n$$\n\n(b) 正确的可检测背景：$(N,K)=(20,8)$。\n这里 $\\min\\{K,n\\}=\\min\\{8,5\\}=5$，所以\n$$\np_{\\mathrm{detectable}} = \\sum_{i=3}^{5} \\frac{\\binom{8}{i}\\,\\binom{12}{5-i}}{\\binom{20}{5}}.\n$$\n计算每一项：\n- 对于 $i=3$：$\\binom{8}{3}=56$，$\\binom{12}{2}=66$，乘积为 $56 \\times 66 = 3696$。\n- 对于 $i=4$：$\\binom{8}{4}=70$，$\\binom{12}{1}=12$，乘积为 $70 \\times 12 = 840$。\n- 对于 $i=5$：$\\binom{8}{5}=56$，$\\binom{12}{0}=1$，乘积为 $56 \\times 1 = 56$。\n\n分子之和：$3696 + 840 + 56 = 4592$。\n\n分母：$\\binom{20}{5} = 15504$。\n\n因此\n$$\np_{\\mathrm{detectable}} = \\frac{4592}{15504}.\n$$\n此分数可通过将分子和分母同除以 $16$ 来简化：\n$$\n\\frac{4592}{15504} = \\frac{287}{969}.\n$$\n\n3. 计算定义的显著性膨胀因子 $I$\n$$\nI \\equiv \\frac{p_{\\mathrm{detectable}}}{p_{\\mathrm{genome}}} = \\frac{\\frac{287}{969}}{\\frac{1514}{7917}} = \\frac{287 \\times 7917}{969 \\times 1514}.\n$$\n分子与分子相乘，分母与分母相乘：\n$$\n287 \\times 7917 = 2{,}272{,}179, \\quad 969 \\times 1514 = 1{,}467{,}066.\n$$\n因此\n$$\nI = \\frac{2{,}272{,}179}{1{,}467{,}066} \\approx 1.54879\\ldots\n$$\n四舍五入到四位有效数字，\n$$\nI \\approx 1.549.\n$$\n\n解释：因为在可检测基因中，该 GO 术语的频率 ($K_{\\mathrm{detectable}}/D = 8/20 = 0.4$) 高于在基因组背景中的频率 ($K_{\\mathrm{genome}}/N = 10/30 \\approx 0.333\\ldots$)，所以使用基因组背景会降低零假设的期望值，并产生一个更小的单侧尾部概率。在这个构造的例子中，由此产生的偏差使表观显著性膨胀了大约 $I \\approx 1.549$ 倍。",
            "answer": "$$\\boxed{1.549}$$"
        },
        {
            "introduction": "“真路径规则”是在基因本体论（Gene Ontology, GO）中传递注释的核心原则，但它仅适用于特定的关系类型。本练习  展示了一个将 `regulates`（调控）关系误解为简单的层次关系（如 `is_a` 或 `part_of`）会导致生物学上错误结论的场景。通过解决这个问题，学习者将学会批判性地评估注释路径，并理解关系语义对于准确功能解释的重要性。",
            "id": "4344264",
            "problem": "在基因本体论（Gene Ontology, GO）的生物学过程（Biological Process, BP）领域中，术语被组织在一个有向无环图（Directed Acyclic Graph, DAG）中，其中的边表示“is_a”（是一种）、“part_of”（是……的一部分）和“regulates”（调控，包括“positively_regulates”和“negatively_regulates”）等关系。被广泛使用的“真实路径原则”适用于“is_a”和“part_of”关系，支持注释沿着这些关系从子术语向上溯源至其所有祖先术语。而“regulates”系列关系不表示类归属关系，因此根据定义，它不保证向上溯源的有效性。请考虑以下在一个真核模式生物系统中科学上合理的BP子图和基因注释：\n- 术语和关系：\n  - $t_1$：细胞周期过程。\n  - $t_2$：细胞周期过程的调控，存在关系 $t_2 \\xrightarrow{\\mathrm{regulates}} t_1$。\n  - $t_3$：细胞周期过程的正向调控，存在关系 $t_3 \\xrightarrow{\\mathrm{is\\_a}} t_2$。\n  - $t_4$：DNA复制，存在关系 $t_4 \\xrightarrow{\\mathrm{part\\_of}} t_1$。\n  - $t_5$：检查点信号传导，存在关系 $t_5 \\xrightarrow{\\mathrm{regulates}} t_4$。\n- 带有证据的基因产物注释：\n  - $g_1 \\rightarrow t_5$，证据为“源于直接实验推断”（Inferred from Direct Assay, IDA）。\n  - $g_2 \\rightarrow t_3$，证据为“源于突变表型推断”（Inferred from Mutant Phenotype, IMP）。\n  - $g_3 \\rightarrow t_4$，证据为“源于直接实验推断”（Inferred from Direct Assay, IDA）。\n  - $g_4 \\rightarrow t_1$，证据为“可追溯的作者声明”（Traceable Author Statement, TAS）。\n\n假设一个注释引擎执行无限制的向上溯源，它将“regulates”关系视为与“part_of”和“is_a”关系相同（即，它会遍历任何类型的边，仿佛它们都能证明类归属关系）。仅使用上述核心定义和集合逻辑，从第一性原理出发，推断这种无限制的溯源如何扩增了注释到$t_1$的基因产物集合。\n\n您的任务有两部分：\n- 首先，利用该图和注释，识别出在无限制溯源下，哪些特定路径将本不应根据“真实路径原则”计数的基因产物添加到了$t_1$。\n- 其次，选择一个规则集，该规则集能防止这种扩增，同时保留所有沿着“is_a”和“part_of”关系的有效向上溯源。对于您选择的选项，应用该规则集后，注释到$t_1$的独特基因产物的预测数量必须与定义所蕴含的逻辑上正确的计数相匹配。\n\n哪个选项既识别了一个能防止扩增的规则集，又给出了溯源后注释到$t_1$的独特基因产物的正确预测数量？\n\nA. 采用以下规则集：仅沿着“is_a”和“part_of”关系应用向上溯源；绝不遍历任何包含“regulates”族系边（即“regulates”、“positively_regulates”或“negatively_regulates”）的路径，无论后续是什么边；如果存在“NOT”等限定词，则将其作为溯源的阻断器。溯源后$t_1$的预测数量：$2$。\n\nB. 允许沿着“is_a”和“part_of”向上溯源，并且仅当“regulates”跳跃之后紧跟着一个“part_of”跳跃时，才允许单次的“regulates”跳跃；在所有其他情况下禁止“regulates”。溯源后$t_1$的预测数量：$3$。\n\nC. 允许沿着所有边类型向上溯源，但在溯源后，移除那些其直接注释术语名称包含子字符串“regulation of”的基因产物。溯源后$t_1$的预测数量：$3$。\n\nD. 禁止跨越“negatively_regulates”边向上溯源，但允许跨越“regulates”和“positively_regulates”边；在其他方面，像往常一样跨越“is_a”和“part_of”进行溯源。溯源后$t_1$的预测数量：$4$。",
            "solution": "问题的核心是根据基因本体论（GO）的“真实路径原则”确定哪些基因产物应被正确地注释到术语 $t_1$（细胞周期过程），然后评估哪个选项提供的规则集能准确地重现这一结果。\n\n**1. 确定正确的注释集（基于真实路径原则）**\n“真实路径原则”规定，注释仅能沿着表示类归属或部分-整体关系的路径（主要是 `is_a` 和 `part_of`）向上传播。`regulates` 关系不属于此类，因此不能用于注释传播。\n*   **$g_4$**: 直接注释到 $t_1$，因此被包含在内。\n*   **$g_3$**: 注释到 $t_4$。路径 $g_3 \\rightarrow t_4 \\xrightarrow{\\mathrm{part\\_of}} t_1$ 仅包含一条 `part_of` 边，这是一条有效的传播路径。因此，$g_3$ 被包含在内。\n*   **$g_2$**: 注释到 $t_3$。路径是 $g_2 \\rightarrow t_3 \\xrightarrow{\\mathrm{is\\_a}} t_2 \\xrightarrow{\\mathrm{regulates}} t_1$。由于此路径包含一条 `regulates` 边，传播在此中断。因此，$g_2$ 不被包含。从生物学上讲，一个细胞周期过程的“正向调控者”本身不是该过程的一部分。\n*   **$g_1$**: 注释到 $t_5$。路径是 $g_1 \\rightarrow t_5 \\xrightarrow{\\mathrm{regulates}} t_4 \\xrightarrow{\\mathrm{part\\_of}} t_1$。此路径也包含一条 `regulates` 边，因此传播中断。因此，$g_1$ 不被包含。\n\n根据正确的逻辑推断，注释到 $t_1$ 的基因产物集合应为 $\\{g_3, g_4\\}$，总数为 2。\n\n**2. 评估选项**\n*   **A**: 规则集明确指出仅沿着 `is_a` 和 `part_of` 关系传播。这精确地执行了“真实路径原则”。应用此规则，我们将得到集合 $\\{g_3, g_4\\}$，数量为 2。该选项的规则和预测数量均正确。\n*   **B**: 规则集创建了一个特例，允许在特定条件下（`regulates` 后跟 `part_of`）沿着 `regulates` 传播。这将错误地包含 $g_1$（因为路径是 $t_5 \\xrightarrow{\\mathrm{regulates}} t_4 \\xrightarrow{\\mathrm{part\\_of}} t_1$）。结果集将是 $\\{g_1, g_3, g_4\\}$，数量为 3。此规则集不正确。\n*   **C**: 此规则集依赖于不稳健的字符串匹配。它会排除 $g_2$（因其术语名包含 \"regulation of\"），但不会排除 $g_1$（其术语名是 \"checkpoint signaling\"）。结果集将是 $\\{g_1, g_3, g_4\\}$，数量为 3。此规则集不正确。\n*   **D**: 此规则集错误地允许沿着 `regulates` 和 `positively_regulates` 传播，这违反了 GO 的核心原则。它将错误地包含 $g_1$ 和 $g_2$。结果集将是 $\\{g_1, g_2, g_3, g_4\\}$，数量为 4。此规则集不正确。\n\n**结论：**\n只有选项 A 提出的规则集与 GO 的“真实路径原则”一致，并得出了逻辑上正确的注释数量。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "人们通常认为GO层次结构中更深的术语更具特异性，但这是一种可能产生误导的启发式方法。本练习  引入了信息熵（Information Content, IC）作为一种更严谨、由数据驱动的特异性度量方法，并通过计算证明了一个较浅的术语实际上可能比一个更深的术语提供更多信息。这项技能对于基因间语义相似性计算或更细致地解释富集结果等高级应用至关重要。",
            "id": "4344258",
            "problem": "考虑基因本体论（GO），它表示为一个有向无环图（DAG）。根据GO的“真实路径规则”，如果一个基因被注释到一个术语 $t$，那么它也被隐式地注释到 $t$ 在DAG中的每一个祖先术语。设研究队列中的基因总数为 $N$，定义观察到术语 $t$ 的注释的概率为 $p(t)$，其中 $p(t)$ 是在计算了祖先传播的注释后，注释到 $t$ 的基因所占的比例。根据信息论，一个术语的信息含量（IC）定义为 $IC(t)=-\\log p(t)$，其中 $\\log$ 表示自然对数。深度定义为从DAG根节点到某个术语的最短路径长度。\n\n给定以下包含 $N=1000$ 个基因的GO子图。术语及其深度如下：根节点 $r$ 深度为 $0$；$a$ 和 $b$ 深度为 $1$；$c$、$d$、$e$、$f$ 和 $g$ 深度为 $2$；$h$ 和 $i$ 深度为 $3$。父子关系如下：\n- $r \\rightarrow a$, $r \\rightarrow b$\n- $a \\rightarrow c$, $a \\rightarrow d$\n- $b \\rightarrow e$, $b \\rightarrow f$, $b \\rightarrow g$\n- $e \\rightarrow h$\n- $c \\rightarrow i$, $d \\rightarrow i$ (因此 $i$ 有两个父节点)\n\n假设在 $N=1000$ 个基因中，直接注释（未进行祖先传播）的计数如下：$50$ 个基因注释到 $a$， $50$ 个基因注释到 $b$， $60$ 个基因注释到 $c$， $40$ 个基因注释到 $d$， $20$ 个基因注释到 $e$， $250$ 个基因注释到 $f$， $30$ 个基因注释到 $g$， $300$ 个基因注释到 $h$，以及 $200$ 个基因注释到 $i$。没有基因直接注释到 $r$。\n\n使用真实路径规则，定义一个术语 $t$ 的支持度，记为 $\\mathrm{support}(t)$，即直接注释到 $t$ 或通过其后代术语注释的基因数量。那么 $p(t)=\\mathrm{support}(t)/N$ 且 $IC(t)=-\\log p(t)$。基于这些定义：\n- 计算术语 $a$、$b$、$c$、$d$、$e$、$f$、$g$、$h$ 和 $i$ 的 $p(t)$ 和 $IC(t)$。\n- 分析在此子图中 $IC$ 与深度的关系，并找出深度可作为特异性的误导性指标的任何情况。\n\n选择所有正确的陈述：\n\nA. 在这些术语中，最深的术语具有最高的 $IC$，因此深度是特异性的一个普遍可靠的指标。\n\nB. 深度为 $2$ 的术语 $g$ 比深度为 $3$ 的术语 $i$ 具有更高的 $IC$，这表明当较浅分支中的注释频率较低时，深度可能成为特异性的一个误导性指标。\n\nC. 由于 $i$ 有两个父节点，$\\mathrm{support}(c)$ 和 $\\mathrm{support}(d)$ 相对于单继承的树形结构有所增加，这降低了 $IC(c)$ 和 $IC(d)$，从而削弱了深度与 $IC$ 之间任何朴素的相关性。\n\nD. 如果 $p(t)$ 仅使用直接注释计算（忽略祖先传播），根据定义，$IC$ 将与深度无关。\n\nE. 将 $IC(t)=-\\log p(t)$ 中的对数从自然对数底更改为以10为底，将反转该子图中术语按 $IC$ 的排名。",
            "solution": "为了解决这个问题，我们首先需要根据“真实路径规则”计算每个术语的支持度（support），然后计算其概率（p）和信息含量（IC）。\n\n**1. 计算支持度（Support）**\n一个术语 $t$ 的支持度是直接注释到 $t$ 或其任何后代术语的基因总数。我们假设每个基因只有一个直接注释，因此直接注释集是不相交的。基因总数 $N=1000$。\n\n*   叶节点：\n    *   $\\mathrm{support}(h) = C(h) = 300$\n    *   $\\mathrm{support}(i) = C(i) = 200$\n    *   $\\mathrm{support}(g) = C(g) = 30$\n    *   $\\mathrm{support}(f) = C(f) = 250$\n*   中间节点：\n    *   $\\mathrm{support}(e) = C(e) + \\mathrm{support}(h) = 20 + 300 = 320$\n    *   $\\mathrm{support}(d) = C(d) + \\mathrm{support}(i) = 40 + 200 = 240$ (因为 $i$ 是 $d$ 的后代)\n    *   $\\mathrm{support}(c) = C(c) + \\mathrm{support}(i) = 60 + 200 = 260$ (因为 $i$ 也是 $c$ 的后代)\n*   顶层节点（根除外）：\n    *   $\\mathrm{support}(b) = C(b) + \\mathrm{support}(e) + \\mathrm{support}(f) + \\mathrm{support}(g) = C(b) + (C(e) + C(h)) + C(f) + C(g) = 50 + (20+300) + 250 + 30 = 650$\n    *   $\\mathrm{support}(a) = C(a) + C(c) + C(d) + C(i) = 50 + 60 + 40 + 200 = 350$\n\n**2. 计算概率（p）和信息含量（IC）**\n$p(t) = \\mathrm{support}(t) / N$ and $IC(t) = -\\log p(t)$。\n*   $p(g) = 30/1000 = 0.03 \\implies IC(g) \\approx 3.507$ (深度 2)\n*   $p(i) = 200/1000 = 0.2 \\implies IC(i) \\approx 1.609$ (深度 3)\n*   $p(h) = 300/1000 = 0.3 \\implies IC(h) \\approx 1.204$ (深度 3)\n\n**3. 评估选项**\n*   **A:** 错误。最深的术语是 $h$ 和 $i$，但它们的 $IC$ 值（1.204 和 1.609）远低于深度为 2 的术语 $g$ 的 $IC$ 值（3.507）。这证明深度并非特异性的可靠指标。\n*   **B:** 正确。计算表明，$IC(g) \\approx 3.507 > IC(i) \\approx 1.609$，尽管 $g$ 的深度（2）小于 $i$ 的深度（3）。这是因为术语 $g$ 及其后代（此例中没有）的注释频率非常低，使其成为一个信息量大、特异性高的术语。\n*   **C:** 正确。术语 $i$ 有两个父节点（$c$ 和 $d$），因此其支持度（200个基因）同时贡献给了 $c$ 和 $d$ 的支持度计算。这增加了 $c$ 和 $d$ 的支持度，从而降低了它们的 $IC$ 值。这种多重继承的DAG结构是深度与 $IC$ 之间关系复杂化的一个重要原因。\n*   **D:** 错误。如果只使用直接注释，IC 仍然依赖于经验性的、任意的注释计数，这些计数与深度没有固定的关系。例如，直接注释到深度3的术语 $h$ 的基因（300个）远多于深度2的术语 $g$（30个），导致 $IC_{direct}(h)  IC_{direct}(g)$。IC 并非与深度无关。\n*   **E:** 错误。改变对数的底数只是对所有IC值进行一个常数因子的缩放（$IC_{10}(t) = IC_e(t) / \\ln(10)$）。这不会改变术语按IC值的排名。\n\n因此，正确的陈述是B和C。",
            "answer": "$$\\boxed{BC}$$"
        }
    ]
}