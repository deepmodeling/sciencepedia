{
    "hands_on_practices": [
        {
            "introduction": "This exercise grounds our understanding in the fundamental biophysics of gene regulation. By applying the principles of statistical thermodynamics , you will derive from first principles how a mutation affecting a transcription factor's binding affinity, represented by a change in Gibbs free energy $\\Delta \\Delta G$, quantitatively alters gene expression. This practice provides a rigorous link between DNA sequence and regulatory function, forming the basis for predictive models of cis-regulatory logic.",
            "id": "4395664",
            "problem": "In the statistical thermodynamic model of transcriptional regulation, a promoter-enhancer system is described by a set of binding microstates corresponding to the occupancy of regulatory proteins at their sites. Under the Central Dogma of molecular biology, transcription is initiated when RNA polymerase (RNAP) is recruited to the promoter, and in the equilibrium thermodynamic framework the probability of RNAP occupancy is given by a ratio of Boltzmann-weighted microstates over the partition function. Consider an enhancer with two transcription factors (TFs), denoted as A and B, each binding independently to a unique site, and a promoter-bound RNAP. Assume the following context and definitions:\n\n- Each binding microstate is characterized by an energy that is additive across bound species and includes interaction energies only when RNAP and a TF are simultaneously bound. Specifically, if TF A is bound concurrently with RNAP, the energy is lowered by an interaction energy $\\epsilon_{A} > 0$, and analogously for TF B with interaction energy $\\epsilon_{B} > 0$. There is no direct interaction between TF A and TF B beyond their additive contributions to the energy, and no three-body interaction beyond the product of pairwise interactions.\n- For each species $i \\in \\{A, B, P\\}$ (where $P$ denotes RNAP), the effective binding weight is $w_{i} = \\frac{[i]}{C_{0}} \\exp\\!\\left(-\\frac{\\Delta G_{i}}{R T}\\right)$, where $[i]$ is the free concentration, $C_{0}$ is a reference concentration, $\\Delta G_{i}$ is the standard binding free energy for species $i$ at its site, $R$ is the gas constant, and $T$ is the absolute temperature.\n- When RNAP and TF $i$ are co-bound, the microstate weight is multiplied by $r_{i} = \\exp\\!\\left(\\frac{\\epsilon_{i}}{R T}\\right)$, reflecting the favorable interaction energy $\\epsilon_{i}$.\n- The predicted expression level is proportional to the equilibrium probability that RNAP is bound to the promoter, and proportionality constants cancel when taking ratios of expression between conditions.\n\nA point mutation in the enhancer changes the motif affinity of TF A by an amount $\\Delta \\Delta G$, so that TF A’s binding free energy becomes $\\Delta G_{A}^{\\text{mut}} = \\Delta G_{A} + \\Delta \\Delta G$. All other parameters remain unchanged.\n\nStarting from the principle that microstate probabilities are given by Boltzmann weights and that the partition function is the sum over all microstates, derive the exact closed-form expression for the ratio of predicted expression in the mutant relative to the wild type, $\\frac{E_{\\text{mut}}}{E_{\\text{wt}}}$, in terms of $\\Delta \\Delta G$, $R$, $T$, $w_{A}$, $w_{B}$, $w_{P}$, $r_{A}$, and $r_{B}$. Do not assume any limiting regime (such as weak binding or saturation), and do not introduce any heuristic approximations. Express your final answer as a single analytic expression. No numerical substitution is required.",
            "solution": "The problem requires the derivation of the ratio of gene expression levels for a mutant versus a wild-type transcriptional system, based on a statistical thermodynamic model. The system consists of a promoter that binds RNA polymerase (RNAP, denoted P) and an enhancer with two independent sites for transcription factors (TFs) A and B.\n\nFirst, I shall validate the problem statement.\n\n### Step 1: Extract Givens\n-   System components: Transcription factors A and B, RNA Polymerase P.\n-   Binding model: Independent binding to unique sites.\n-   Energy model: Additive energies for bound species. An interaction energy $\\epsilon_{A} > 0$ exists for co-binding of A and P, and $\\epsilon_{B} > 0$ for B and P. No direct A-B interaction.\n-   Binding weights: $w_{i} = \\frac{[i]}{C_{0}} \\exp(-\\frac{\\Delta G_{i}}{R T})$ for $i \\in \\{A, B, P\\}$.\n-   Interaction factors: $r_{i} = \\exp(\\frac{\\epsilon_{i}}{R T})$ for $i \\in \\{A, B\\}$. The weight of a state with P and TF $i$ co-bound is multiplied by $r_{i}$.\n-   Gene Expression: $E \\propto P(\\text{RNAP bound})$, where $P(\\text{RNAP bound})$ is the equilibrium probability of RNAP occupying the promoter.\n-   Mutation: A mutation changes the binding free energy of TF A from $\\Delta G_{A}$ to $\\Delta G_{A}^{\\text{mut}} = \\Delta G_{A} + \\Delta \\Delta G$. All other parameters are constant.\n-   Objective: Derive the closed-form expression for the ratio $\\frac{E_{\\text{mut}}}{E_{\\text{wt}}}$ in terms of $\\Delta \\Delta G$, $R$, $T$, $w_{A}$, $w_{B}$, $w_{P}$, $r_{A}$, and $r_{B}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the Shea-Ackers model of transcriptional regulation, a cornerstone of quantitative systems biology. It is well-posed, with all necessary parameters and relationships defined to derive a unique solution. The language is objective and precise. The problem is self-contained, consistent, and does not violate any scientific principles. It is a formalizable and relevant problem in its specified field.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with a full derivation.\n\nThe core of the statistical thermodynamic model is the partition function, $Z$, which is the sum of the statistical weights of all possible microstates of the system. The probability of any particular configuration is the ratio of its weight to the partition function.\n\nThe system has $3$ species (A, B, P) that can be either bound or unbound, leading to $2^{3} = 8$ possible microstates. Let us enumerate the microstates and their corresponding statistical weights for the wild-type (wt) system. The weight of the empty state (no proteins bound) is defined as $1$.\n\nThe microstates and their weights are:\n1.  Empty state: weight = $1$\n2.  Only A bound: weight = $w_{A}$\n3.  Only B bound: weight = $w_{B}$\n4.  Only P bound: weight = $w_{P}$\n5.  A and B bound: weight = $w_{A} w_{B}$ (independent binding)\n6.  A and P bound: weight = $w_{A} w_{P} r_{A}$ (with interaction)\n7.  B and P bound: weight = $w_{B} w_{P} r_{B}$ (with interaction)\n8.  A, B, and P bound: weight = $w_{A} w_{B} w_{P} r_{A} r_{B}$ (pairwise interactions are multiplicative)\n\nThe wild-type partition function, $Z_{\\text{wt}}$, is the sum of these weights:\n$$Z_{\\text{wt}} = 1 + w_{A} + w_{B} + w_{P} + w_{A} w_{B} + w_{A} w_{P} r_{A} + w_{B} w_{P} r_{B} + w_{A} w_{B} w_{P} r_{A} r_{B}$$\nThis expression can be factored by grouping terms based on the occupancy of P:\n$$Z_{\\text{wt}} = (1 + w_{A} + w_{B} + w_{A} w_{B}) + w_{P}(1 + w_{A} r_{A} + w_{B} r_{B} + w_{A} w_{B} r_{A} r_{B})$$\nFactoring further yields a more compact form:\n$$Z_{\\text{wt}} = (1+w_{A})(1+w_{B}) + w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})$$\n\nThe predicted expression level, $E_{\\text{wt}}$, is proportional to the probability of RNAP being bound. This probability, $P_{\\text{wt}}(\\text{P bound})$, is the sum of weights of all microstates containing P, divided by the partition function $Z_{\\text{wt}}$.\nThe sum of weights for states with P bound is the second term in the grouped expression for $Z_{\\text{wt}}$:\n$$\\sum W(\\text{P bound}) = w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})$$\nTherefore, the probability is:\n$$P_{\\text{wt}}(\\text{P bound}) = \\frac{w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})}{Z_{\\text{wt}}} = \\frac{w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})}{(1+w_{A})(1+w_{B}) + w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})}$$\n\nNow, we consider the effect of the mutation. The mutation changes the binding free energy of TF A by $\\Delta \\Delta G$, such that $\\Delta G_{A}^{\\text{mut}} = \\Delta G_{A} + \\Delta \\Delta G$. This affects the binding weight $w_{A}$. The new weight, $w_{A}^{\\text{mut}}$, is:\n$$w_{A}^{\\text{mut}} = \\frac{[A]}{C_{0}} \\exp\\left(-\\frac{\\Delta G_{A}^{\\text{mut}}}{RT}\\right) = \\frac{[A]}{C_{0}} \\exp\\left(-\\frac{\\Delta G_{A} + \\Delta \\Delta G}{RT}\\right)$$\n$$w_{A}^{\\text{mut}} = \\left(\\frac{[A]}{C_{0}} \\exp\\left(-\\frac{\\Delta G_{A}}{RT}\\right)\\right) \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right) = w_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right)$$\n\nTo find the expression probability for the mutant, $P_{\\text{mut}}(\\text{P bound})$, we replace $w_{A}$ with $w_{A}^{\\text{mut}}$ in the wild-type probability expression. All other parameters remain unchanged.\nThe mutant partition function, $Z_{\\text{mut}}$, is:\n$$Z_{\\text{mut}} = (1+w_{A}^{\\text{mut}})(1+w_{B}) + w_{P}(1+w_{A}^{\\text{mut}} r_{A})(1+w_{B} r_{B})$$\nThe probability of RNAP binding for the mutant is:\n$$P_{\\text{mut}}(\\text{P bound}) = \\frac{w_{P}(1+w_{A}^{\\text{mut}} r_{A})(1+w_{B} r_{B})}{Z_{\\text{mut}}}$$\n\nThe problem asks for the ratio of expression levels, $\\frac{E_{\\text{mut}}}{E_{\\text{wt}}}$. Since expression is proportional to the RNAP binding probability, the proportionality constant cancels out:\n$$\\frac{E_{\\text{mut}}}{E_{\\text{wt}}} = \\frac{P_{\\text{mut}}(\\text{P bound})}{P_{\\text{wt}}(\\text{P bound})}$$\nSubstituting the expressions for the probabilities:\n$$\\frac{E_{\\text{mut}}}{E_{\\text{wt}}} = \\frac{\\frac{w_{P}(1+w_{A}^{\\text{mut}} r_{A})(1+w_{B} r_{B})}{Z_{\\text{mut}}}}{\\frac{w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})}{Z_{\\text{wt}}}}$$\nThe terms $w_{P}$ and $(1+w_{B} r_{B})$ cancel, simplifying the ratio to:\n$$\\frac{E_{\\text{mut}}}{E_{\\text{wt}}} = \\frac{1+w_{A}^{\\text{mut}} r_{A}}{1+w_{A} r_{A}} \\cdot \\frac{Z_{\\text{wt}}}{Z_{\\text{mut}}}$$\nNow, we substitute the expressions for $Z_{\\text{wt}}$, $Z_{\\text{mut}}$, and $w_{A}^{\\text{mut}}$:\n$$\\frac{E_{\\text{mut}}}{E_{\\text{wt}}} = \\frac{1+w_{A} r_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right)}{1+w_{A} r_{A}} \\times \\frac{(1+w_{A})(1+w_{B}) + w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B})}{(1+w_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right))(1+w_{B}) + w_{P}(1+w_{A} r_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right))(1+w_{B} r_{B})}$$\nThis can be written as a single fraction:\n$$\\frac{E_{\\text{mut}}}{E_{\\text{wt}}} = \\frac{\\left(1+w_{A} r_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right)\\right) \\left[ (1+w_{A})(1+w_{B}) + w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B}) \\right]}{\\left(1+w_{A} r_{A}\\right) \\left[ (1+w_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right))(1+w_{B}) + w_{P}(1+w_{A} r_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right))(1+w_{B} r_{B}) \\right]}$$\nThis is the final, exact closed-form expression for the ratio of mutant to wild-type expression levels.",
            "answer": "$$\\boxed{\\frac{\\left(1+w_{A} r_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right)\\right) \\left( (1+w_{A})(1+w_{B}) + w_{P}(1+w_{A} r_{A})(1+w_{B} r_{B}) \\right)}{\\left(1+w_{A} r_{A}\\right) \\left( (1+w_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right))(1+w_{B}) + w_{P}(1+w_{A} r_{A} \\exp\\left(-\\frac{\\Delta \\Delta G}{RT}\\right))(1+w_{B} r_{B}) \\right)}}$$"
        },
        {
            "introduction": "Building on the principles of concentration-dependent regulation, this practice explores how these concepts apply in a pharmacological context. You will model the competitive action of agonist and antagonist drugs on a nuclear hormone receptor to predict the resulting steady-state messenger ribonucleic acid (mRNA) level . This exercise connects molecular binding events, described by dissociation constants such as $K_{A}$ and $K_{I}$, to macroscopic cellular outcomes, demonstrating the quantitative basis of modern drug action.",
            "id": "4395603",
            "problem": "A nuclear hormone receptor (NHR) acts as a ligand-activated transcription factor (TF) that regulates a single target gene. In the nucleus, the receptor has a single ligand-binding pocket that can bind either an agonist or an antagonist competitively, forming $1:1$ complexes. Assume the following biophysical and kinetic bases hold:\n\n- Law of mass action at equilibrium applies to receptor–ligand binding. For a ligand $L$ binding receptor $R$ to form complex $RL$, the dissociation constant satisfies $K_{d,L} = [R][L]/[RL]$.\n- Agonist and antagonist, denoted $A$ and $I$, compete for the same site and only one ligand binds per receptor at a time.\n- Ligands are present in large excess relative to receptor, so free ligand concentrations equal the stated values of $[A]$ and $[I]$.\n- Transcriptional competence is determined by efficacy: unliganded receptor has efficacy $\\varepsilon_{0}$, the agonist-bound receptor has efficacy $\\varepsilon_{A}$, and the antagonist-bound receptor has efficacy $\\varepsilon_{I}$. The concentration of transcriptionally competent receptor is $[R_{\\text{act}}] = \\varepsilon_{0}[R] + \\varepsilon_{A}[RA] + \\varepsilon_{I}[RI]$.\n- The transcriptionally competent receptor binds a single deoxyribonucleic acid (DNA) response element on the target promoter via reversible $1:1$ binding with dissociation constant $K_{\\text{DNA}}$, and the instantaneous transcription initiation rate is proportional to the promoter occupancy by $R_{\\text{act}}$.\n- Messenger ribonucleic acid (mRNA) is synthesized at rate $r_{\\max}\\times p_{\\text{bound}}$ and degraded with first-order kinetics with rate constant $k_{\\deg}$.\n\nIn a particular experiment, the nuclear receptor total concentration is $R_{T} = 10$ nM. The agonist and antagonist free concentrations are $[A] = 8$ nM and $[I] = 60$ nM. The dissociation constants are $K_{A} = 5$ nM for the agonist and $K_{I} = 20$ nM for the antagonist. The efficacies are $\\varepsilon_{0} = 0.05$, $\\varepsilon_{A} = 1$, and $\\varepsilon_{I} = 0$. The DNA binding dissociation constant is $K_{\\text{DNA}} = 2$ nM. The maximal transcription initiation rate is $r_{\\max} = 10$ nM/min, and the mRNA degradation rate constant is $k_{\\deg} = 0.1$ min$^{-1}$.\n\nUsing only the assumptions stated above and first principles, compute the steady-state mRNA concentration for this gene under these ligand conditions. Express your final answer in nM and round to three significant figures.",
            "solution": "The problem asks for the steady-state concentration of messenger ribonucleic acid (mRNA), denoted $[mRNA]_{ss}$, for a gene regulated by a nuclear hormone receptor. The solution requires a step-by-step calculation based on the provided biophysical model.\n\nFirst, we establish the ordinary differential equation governing the concentration of mRNA, $[mRNA]$. The rate of change of $[mRNA]$ is the difference between its synthesis rate and its degradation rate.\nThe synthesis rate is given as $r_{\\max} \\times p_{\\text{bound}}$, where $r_{\\max}$ is the maximal transcription rate and $p_{\\text{bound}}$ is the promoter occupancy by the active receptor complex.\nThe degradation is a first-order process with rate constant $k_{\\deg}$, so the degradation rate is $k_{\\deg} [mRNA]$.\nThus, the governing equation is:\n$$ \\frac{d[mRNA]}{dt} = r_{\\max} p_{\\text{bound}} - k_{\\deg} [mRNA] $$\nAt steady-state, the concentration of mRNA is constant, so $\\frac{d[mRNA]}{dt} = 0$. This leads to:\n$$ r_{\\max} p_{\\text{bound}} = k_{\\deg} [mRNA]_{ss} $$\nSolving for the steady-state mRNA concentration, we get:\n$$ [mRNA]_{ss} = \\frac{r_{\\max}}{k_{\\deg}} p_{\\text{bound}} $$\n\nThe next step is to determine the promoter occupancy, $p_{\\text{bound}}$. The problem states that the transcriptionally competent receptor, $R_{\\text{act}}$, binds to a single DNA response element ($D$) in a reversible $1:1$ reaction with dissociation constant $K_{\\text{DNA}}$.\n$$ R_{\\text{act}} + D \\rightleftharpoons R_{\\text{act}}D $$\nThe dissociation constant is $K_{\\text{DNA}} = \\frac{[R_{\\text{act}}][D]}{[R_{\\text{act}}D]}$.\nThe promoter occupancy, $p_{\\text{bound}}$, is the fraction of total DNA response elements that are bound by $R_{\\text{act}}$:\n$$ p_{\\text{bound}} = \\frac{[R_{\\text{act}}D]}{[D]_{\\text{total}}} = \\frac{[R_{\\text{act}}D]}{[D] + [R_{\\text{act}}D]} $$\nBy rearranging the expression for $K_{\\text{DNA}}$ to $[D] = \\frac{K_{\\text{DNA}}[R_{\\text{act}}D]}{[R_{\\text{act}}]}$, and substituting this into the equation for $p_{\\text{bound}}$, we can express occupancy in terms of the free concentration of the active receptor, $[R_{\\text{act}}]$:\n$$ p_{\\text{bound}} = \\frac{[R_{\\text{act}}D]}{\\frac{K_{\\text{DNA}}[R_{\\text{act}}D]}{[R_{\\text{act}}]} + [R_{\\text{act}}D]} = \\frac{1}{\\frac{K_{\\text{DNA}}}{[R_{\\text{act}}]} + 1} = \\frac{[R_{\\text{act}}]}{K_{\\text{DNA}} + [R_{\\text{act}}]} $$\n\nNow, we must find the concentration of the transcriptionally competent receptor, $[R_{\\text{act}}]$. It is defined as a weighted sum of the concentrations of the different receptor forms: unliganded ($R$), agonist-bound ($RA$), and antagonist-bound ($RI$).\n$$ [R_{\\text{act}}] = \\varepsilon_{0}[R] + \\varepsilon_{A}[RA] + \\varepsilon_{I}[RI] $$\nwhere $\\varepsilon_{0}$, $\\varepsilon_{A}$, and $\\varepsilon_{I}$ are the respective efficacies.\n\nTo find $[R]$, $[RA]$, and $[RI]$, we use the principle of mass conservation for the total receptor concentration, $R_T$:\n$$ R_T = [R] + [RA] + [RI] $$\nThe agonist ($A$) and antagonist ($I$) bind competitively to the receptor. Their binding equilibria are described by their respective dissociation constants, $K_A$ and $K_I$:\n$$ K_A = \\frac{[R][A]}{[RA]} \\implies [RA] = \\frac{[R][A]}{K_A} $$\n$$ K_I = \\frac{[R][I]}{[RI]} \\implies [RI] = \\frac{[R][I]}{K_I} $$\nWe substitute these expressions for $[RA]$ and $[RI]$ into the mass balance equation:\n$$ R_T = [R] + \\frac{[R][A]}{K_A} + \\frac{[R][I]}{K_I} = [R] \\left( 1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I} \\right) $$\nFrom this, we can solve for the free unliganded receptor concentration, $[R]$:\n$$ [R] = \\frac{R_T}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} $$\nThe concentrations of the complexed forms are then:\n$$ [RA] = \\frac{[R][A]}{K_A} = \\frac{R_T \\left( \\frac{[A]}{K_A} \\right)}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} $$\n$$ [RI] = \\frac{[R][I]}{K_I} = \\frac{R_T \\left( \\frac{[I]}{K_I} \\right)}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} $$\n\nNow, we substitute these expressions for $[R]$, $[RA]$, and $[RI]$ into the definition of $[R_{\\text{act}}]$:\n$$ [R_{\\text{act}}] = \\frac{R_T \\varepsilon_{0}}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} + \\frac{R_T \\varepsilon_{A} \\left( \\frac{[A]}{K_A} \\right)}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} + \\frac{R_T \\varepsilon_{I} \\left( \\frac{[I]}{K_I} \\right)}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} $$\nCombining terms, we get a single expression for $[R_{\\text{act}}]$:\n$$ [R_{\\text{act}}] = R_T \\frac{\\varepsilon_{0} + \\varepsilon_{A}\\frac{[A]}{K_A} + \\varepsilon_{I}\\frac{[I]}{K_I}}{1 + \\frac{[A]}{K_A} + \\frac{[I]}{K_I}} $$\n\nWe now have all the necessary components. We can proceed with substituting the given numerical values.\nThe given parameters are:\n$R_{T} = 10 \\text{ nM}$\n$[A] = 8 \\text{ nM}$\n$[I] = 60 \\text{ nM}$\n$K_{A} = 5 \\text{ nM}$\n$K_{I} = 20 \\text{ nM}$\n$\\varepsilon_{0} = 0.05$\n$\\varepsilon_{A} = 1$\n$\\varepsilon_{I} = 0$\n$K_{\\text{DNA}} = 2 \\text{ nM}$\n$r_{\\max} = 10 \\text{ nM/min}$\n$k_{\\deg} = 0.1 \\text{ min}^{-1}$\n\nFirst, we calculate the dimensionless ligand concentration terms:\n$$ \\frac{[A]}{K_A} = \\frac{8}{5} = 1.6 $$\n$$ \\frac{[I]}{K_I} = \\frac{60}{20} = 3 $$\n\nNext, we calculate $[R_{\\text{act}}]$:\n$$ [R_{\\text{act}}] = (10 \\text{ nM}) \\frac{0.05 + (1)(1.6) + (0)(3)}{1 + 1.6 + 3} $$\n$$ [R_{\\text{act}}] = (10 \\text{ nM}) \\frac{0.05 + 1.6}{5.6} = (10 \\text{ nM}) \\frac{1.65}{5.6} $$\n$$ [R_{\\text{act}}] = \\frac{16.5}{5.6} \\text{ nM} = \\frac{165}{56} \\text{ nM} \\approx 2.9464 \\text{ nM} $$\n\nNow, we use this value to calculate the promoter occupancy, $p_{\\text{bound}}$:\n$$ p_{\\text{bound}} = \\frac{[R_{\\text{act}}]}{K_{\\text{DNA}} + [R_{\\text{act}}]} = \\frac{\\frac{165}{56} \\text{ nM}}{2 \\text{ nM} + \\frac{165}{56} \\text{ nM}} $$\n$$ p_{\\text{bound}} = \\frac{\\frac{165}{56}}{\\frac{2 \\times 56 + 165}{56}} = \\frac{165}{112 + 165} = \\frac{165}{277} $$\n$p_{\\text{bound}} \\approx 0.59567$\n\nFinally, we calculate the steady-state mRNA concentration, $[mRNA]_{ss}$:\n$$ [mRNA]_{ss} = \\frac{r_{\\max}}{k_{\\deg}} p_{\\text{bound}} = \\frac{10 \\text{ nM/min}}{0.1 \\text{ min}^{-1}} \\times \\frac{165}{277} $$\n$$ [mRNA]_{ss} = (100 \\text{ nM}) \\times \\frac{165}{277} = \\frac{16500}{277} \\text{ nM} $$\n$$ [mRNA]_{ss} \\approx 59.566787... \\text{ nM} $$\n\nThe problem requires the final answer to be rounded to three significant figures.\n$$ [mRNA]_{ss} \\approx 59.6 \\text{ nM} $$",
            "answer": "$$\\boxed{59.6}$$"
        },
        {
            "introduction": "This final practice transitions from modeling single genes to inferring system-wide regulatory networks, a core task in systems biology. You will design and implement a Bayesian statistical model to integrate evidence from two distinct high-throughput experiments—ChIP-seq and expression profiling—to predict causal transcription factor-target relationships across the genome . This exercise showcases how probabilistic reasoning, using tools like Bayes' theorem and likelihood ratios, can synthesize multi-modal data and manage uncertainty in complex biological systems.",
            "id": "4395615",
            "problem": "You are asked to design and implement a principled Bayesian integrative model to infer causal transcription factor–target relationships from two data modalities: Chromatin Immunoprecipitation followed by sequencing (ChIP-seq) and expression perturbation. The setting is as follows. For a single transcription factor and a collection of genes, you observe, for each gene indexed by $g$, a ChIP-seq derived binding score $b_g$ (treated as a dimensionless normalized continuous score) and a log$_2$ fold-change in expression $e_g$ (dimensionless) obtained under a transcription factor perturbation experiment. The modeling task is to combine these two orthogonal signals to infer, for each gene, whether the transcription factor causally regulates it.\n\nFundamental base to use:\n- The Central Dogma of molecular biology implies that transcription factors modulate transcription, which can be assayed by perturbation experiments; binding evidence from ChIP-seq indicates physical occupancy near regulatory regions.\n- Bayes’ theorem for inverse probability: for a latent discrete variable $z_g \\in \\{0,1\\}$ indicating whether the transcription factor causally regulates gene $g$ ($z_g=1$) or not ($z_g=0$), with prior probability $p(z_g=1)=\\pi$, and observed data $x_g=(b_g,e_g)$, the posterior is obtained by $p(z_g=1 \\mid x_g) \\propto p(z_g=1) \\, p(x_g \\mid z_g=1)$.\n- A well-tested measurement model assumption: conditional independence of measurements given the latent regulatory state, that is, $p(b_g,e_g \\mid z_g) = p(b_g \\mid z_g) \\, p(e_g \\mid z_g)$.\n- A well-tested distributional model for measurement variability: Gaussian noise around different mean levels for the two groups $z_g \\in \\{0,1\\}$.\n\nModel specification to implement:\n- Latent causal indicator $z_g \\in \\{0,1\\}$ with prior $p(z_g=1)=\\pi$ and $p(z_g=0)=1-\\pi$.\n- Conditional on $z_g$, assume Gaussian observation models with different parameters across the two classes and conditional independence across modalities:\n  - $b_g \\mid z_g=1 \\sim \\mathcal{N}(\\mu_{b,1}, \\sigma_{b,1}^2)$ and $b_g \\mid z_g=0 \\sim \\mathcal{N}(\\mu_{b,0}, \\sigma_{b,0}^2)$,\n  - $e_g \\mid z_g=1 \\sim \\mathcal{N}(\\mu_{e,1}, \\sigma_{e,1}^2)$ and $e_g \\mid z_g=0 \\sim \\mathcal{N}(\\mu_{e,0}, \\sigma_{e,0}^2)$.\n- For each gene, you must compute:\n  1. The posterior probability $p(z_g=1 \\mid b_g, e_g)$.\n  2. The base-$10$ logarithm of the Bayes factor $\\log_{10}\\mathrm{BF}_g$, where $\\mathrm{BF}_g$ is the likelihood ratio $\\mathrm{BF}_g = \\dfrac{p(b_g \\mid z_g=1)p(e_g \\mid z_g=1)}{p(b_g \\mid z_g=0)p(e_g \\mid z_g=0)}$.\n  3. A posterior uncertainty measure defined as the Shannon entropy of the Bernoulli posterior, $H_g = -\\left[p(z_g=1 \\mid b_g,e_g)\\log p(z_g=1 \\mid b_g,e_g) + (1-p(z_g=1 \\mid b_g,e_g))\\log(1-p(z_g=1 \\mid b_g,e_g))\\right]$ in natural units (nats).\n- For each test case, apply a decision rule: classify a gene as causally regulated if and only if $p(z_g=1 \\mid b_g, e_g) \\ge \\tau$, where $\\tau$ is a specified threshold.\n\nYour program must implement numerically stable computations using logarithms to avoid underflow when evaluating Gaussian likelihoods and Bayes factors.\n\nTest suite:\nImplement your solution for the following three test cases. Each case specifies $(\\pi, \\mu_{b,1}, \\sigma_{b,1}, \\mu_{b,0}, \\sigma_{b,0}, \\mu_{e,1}, \\sigma_{e,1}, \\mu_{e,0}, \\sigma_{e,0})$, the list of observed $(b_g,e_g)$ pairs, and the decision threshold $\\tau$.\n\n- Case $1$ (general integration, moderate prior):\n  - Parameters: $\\pi = 0.3$, $\\mu_{b,1} = 2.0$, $\\sigma_{b,1} = 1.0$, $\\mu_{b,0} = 0.0$, $\\sigma_{b,0} = 1.5$, $\\mu_{e,1} = 1.0$, $\\sigma_{e,1} = 0.7$, $\\mu_{e,0} = 0.0$, $\\sigma_{e,0} = 0.7$.\n  - Genes: $(b_g,e_g)$ in the order $[(3.0, 1.5), (2.5, -0.2), (-0.5, 1.2), (0.1, 0.0), (1.2, 0.6)]$.\n  - Threshold: $\\tau = 0.5$.\n\n- Case $2$ (stringent prior and decision threshold):\n  - Parameters: $\\pi = 0.1$, $\\mu_{b,1} = 2.0$, $\\sigma_{b,1} = 1.0$, $\\mu_{b,0} = 0.0$, $\\sigma_{b,0} = 1.5$, $\\mu_{e,1} = 1.0$, $\\sigma_{e,1} = 0.7$, $\\mu_{e,0} = 0.0$, $\\sigma_{e,0} = 0.7$.\n  - Genes: $(b_g,e_g)$ in the order $[(0.0, 0.0), (4.5, 2.0), (-1.0, -0.8), (2.0, 0.9), (1.0, 0.2)]$.\n  - Threshold: $\\tau = 0.8$.\n\n- Case $3$ (binding non-informative, expression informative):\n  - Parameters: $\\pi = 0.5$, $\\mu_{b,1} = 0.0$, $\\sigma_{b,1} = 2.0$, $\\mu_{b,0} = 0.0$, $\\sigma_{b,0} = 2.0$, $\\mu_{e,1} = 1.2$, $\\sigma_{e,1} = 0.5$, $\\mu_{e,0} = 0.0$, $\\sigma_{e,0} = 1.0$.\n  - Genes: $(b_g,e_g)$ in the order $[(3.0, 1.1), (-2.0, 0.9), (0.0, -0.1), (1.0, 2.0)]$.\n  - Threshold: $\\tau = 0.5$.\n\nOutput specification:\n- For each test case, produce a list with four elements in the following order:\n  $[ \\text{posteriors}, \\text{count}, \\text{log10BFs}, \\text{entropies} ]$, where:\n  - $\\text{posteriors}$ is the list of $p(z_g=1 \\mid b_g,e_g)$ for all genes in the case, each rounded to $3$ decimal places,\n  - $\\text{count}$ is the integer number of genes with $p(z_g=1 \\mid b_g,e_g) \\ge \\tau$ in the case,\n  - $\\text{log10BFs}$ is the list of $\\log_{10}\\mathrm{BF}_g$ for all genes in the case, each rounded to $3$ decimal places,\n  - $\\text{entropies}$ is the list of $H_g$ in nats for all genes in the case, each rounded to $3$ decimal places.\n- Your program should produce a single line of output containing the results for all three test cases as a comma-separated list enclosed in square brackets with no spaces. For example, a syntactically valid shape is $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot]]$. No additional text should be printed.",
            "solution": "The problem statement has been critically examined and is determined to be **valid**. It is scientifically grounded in established principles of molecular biology and Bayesian statistics, is well-posed with a complete and consistent set of definitions and parameters, and is expressed in objective, formal language. There are no identifiable flaws.\n\nThe task is to implement a Bayesian integrative model to infer transcription factor-target gene relationships from two data types: ChIP-seq binding scores ($b_g$) and expression log-fold changes ($e_g$). For each gene $g$, we will compute the posterior probability of it being a causal target, the Bayes factor for the causal model, and the entropy of the posterior distribution.\n\nThe solution is constructed upon the following principles:\n\n**1. Bayesian Inference Framework**\n\nThe core of the model is Bayes' theorem, which allows us to update our prior belief about the regulatory status of a gene in light of observed data. For each gene $g$, we have a latent binary variable $z_g \\in \\{0, 1\\}$, where $z_g=1$ indicates that the gene is causally regulated by the transcription factor, and $z_g=0$ indicates it is not. The prior probability of regulation is given as $p(z_g=1) = \\pi$.\n\nThe posterior probability of regulation, given the observed data $x_g = (b_g, e_g)$, is given by:\n$$\np(z_g=1 \\mid b_g, e_g) = \\frac{p(b_g, e_g \\mid z_g=1) p(z_g=1)}{p(b_g, e_g)}\n$$\nThe denominator, $p(b_g, e_g)$, is the marginal likelihood or evidence, obtained by the law of total probability:\n$$\np(b_g, e_g) = p(b_g, e_g \\mid z_g=1) p(z_g=1) + p(b_g, e_g \\mid z_g=0) p(z_g=0)\n$$\nwhere $p(z_g=0) = 1 - \\pi$.\n\n**2. Conditional Independence and Likelihood Models**\n\nA key modeling assumption is the conditional independence of the two data modalities given the latent regulatory state $z_g$. This is a standard and practical assumption in data integration, reflecting that the physical binding event (ChIP-seq) and its functional consequence (expression change) are distinct measurements whose noise processes are independent, conditional on the true underlying state. This allows us to write the joint likelihood as a product of individual likelihoods:\n$$\np(b_g, e_g \\mid z_g) = p(b_g \\mid z_g) \\, p(e_g \\mid z_g)\n$$\nThe problem specifies that each of these conditional likelihoods follows a Gaussian distribution:\n- For binding scores: $b_g \\mid z_g=k \\sim \\mathcal{N}(\\mu_{b,k}, \\sigma_{b,k}^2)$ for $k \\in \\{0,1\\}$.\n- For expression data: $e_g \\mid z_g=k \\sim \\mathcal{N}(\\mu_{e,k}, \\sigma_{e,k}^2)$ for $k \\in \\{0,1\\}$.\n\n**3. Numerically Stable Computation using Log-Probabilities**\n\nDirect evaluation of Gaussian probability densities can result in numerical underflow, as these values can be extremely small. All computations should therefore be performed in logarithmic space. The log-probability density function of a Gaussian distribution $\\mathcal{N}(x; \\mu, \\sigma^2)$ is:\n$$\n\\log p(x; \\mu, \\sigma^2) = -\\frac{1}{2} \\log(2\\pi\\sigma^2) - \\frac{(x-\\mu)^2}{2\\sigma^2}\n$$\nWe define the log-likelihood of the data for gene $g$ under each hypothesis:\n- Log-likelihood for the `regulated` state ($z_g=1$):\n  $$\n  \\ell_1(g) = \\log p(b_g, e_g \\mid z_g=1) = \\log p(b_g \\mid z_g=1) + \\log p(e_g \\mid z_g=1)\n  $$\n- Log-likelihood for the `unregulated` state ($z_g=0$):\n  $$\n  \\ell_0(g) = \\log p(b_g, e_g \\mid z_g=0) = \\log p(b_g \\mid z_g=0) + \\log p(e_g \\mid z_g=0)\n  $$\n\n**4. Derivation of Required Quantities**\n\nWith these principles, we can derive the expressions for the three required outputs for each gene.\n\n**4.1. Bayes Factor ($\\mathrm{BF}_g$)**\n\nThe Bayes factor is the ratio of the likelihoods of the two competing hypotheses. It quantifies the evidence provided by the data in favor of the regulated model ($z_g=1$) over the unregulated model ($z_g=0$).\n$$\n\\mathrm{BF}_g = \\frac{p(b_g, e_g \\mid z_g=1)}{p(b_g, e_g \\mid z_g=0)}\n$$\nIn log space, this becomes a simple subtraction:\n$$\n\\log \\mathrm{BF}_g = \\ell_1(g) - \\ell_0(g)\n$$\nThe problem requires the base-$10$ logarithm, which is obtained by a change of base:\n$$\n\\log_{10} \\mathrm{BF}_g = \\frac{\\log \\mathrm{BF}_g}{\\log 10}\n$$\n\n**4.2. Posterior Probability ($p(z_g=1 \\mid b_g, e_g)$)**\n\nThe posterior probability can be expressed in terms of the Bayes factor and the prior odds, $\\frac{\\pi}{1-\\pi}$. This formulation is numerically superior.\n$$\np(z_g=1 \\mid b_g, e_g) = \\frac{p(b_g, e_g \\mid z_g=1) \\pi}{p(b_g, e_g \\mid z_g=1) \\pi + p(b_g, e_g \\mid z_g=0) (1-\\pi)}\n$$\nDividing the numerator and denominator by $p(b_g, e_g \\mid z_g=0) (1-\\pi)$ gives:\n$$\np(z_g=1 \\mid b_g, e_g) = \\frac{\\frac{p(b_g, e_g \\mid z_g=1)}{p(b_g, e_g \\mid z_g=0)} \\frac{\\pi}{1-\\pi}}{\\frac{p(b_g, e_g \\mid z_g=1)}{p(b_g, e_g \\mid z_g=0)} \\frac{\\pi}{1-\\pi} + 1} = \\frac{\\mathrm{BF}_g \\cdot \\frac{\\pi}{1-\\pi}}{1 + \\mathrm{BF}_g \\cdot \\frac{\\pi}{1-\\pi}}\n$$\nThis expression is a logistic sigmoid function. Let an intermediate variable $\\alpha_g$ be the log-posterior odds:\n$$\n\\alpha_g = \\log\\left(\\mathrm{BF}_g \\cdot \\frac{\\pi}{1-\\pi}\\right) = (\\ell_1(g) - \\ell_0(g)) + (\\log(\\pi) - \\log(1-\\pi)) = \\log \\mathrm{BF}_g + \\mathrm{logit}(\\pi)\n$$\nThen the posterior probability is:\n$$\np(z_g=1 \\mid b_g, e_g) = \\frac{e^{\\alpha_g}}{1+e^{\\alpha_g}} = \\frac{1}{1+e^{-\\alpha_g}} = \\mathrm{sigmoid}(\\alpha_g)\n$$\nThis form is numerically stable and straightforward to implement.\n\n**4.3. Posterior Entropy ($H_g$)**\n\nThe posterior distribution for $z_g$ is a Bernoulli distribution with parameter $p_g = p(z_g=1 \\mid b_g, e_g)$. The Shannon entropy of this distribution, measured in natural units (nats), quantifies the uncertainty remaining after observing the data.\n$$\nH_g = - \\sum_{k \\in \\{0,1\\}} p(z_g=k \\mid b_g, e_g) \\log p(z_g=k \\mid b_g, e_g)\n$$\n$$\nH_g = - \\left[ p_g \\log p_g + (1-p_g) \\log(1-p_g) \\right]\n$$\nSpecial care is taken for the cases where $p_g=0$ or $p_g=1$, where the entropy is $0$, as $\\lim_{x\\to 0} x\\log x = 0$.\n\n**5. Algorithmic Implementation**\n\nThe overall algorithm proceeds as follows for each test case:\n1. Initialize empty lists for `posteriors`, `log10BFs`, `entropies`, and an integer `count` to $0$.\n2. For each gene $g$ with observations $(b_g, e_g)$:\n   a. Calculate the four component log-likelihoods using the Gaussian `logpdf`: $\\log p(b_g \\mid z_g=1)$, $\\log p(b_g \\mid z_g=0)$, $\\log p(e_g \\mid z_g=1)$, $\\log p(e_g \\mid z_g=0)$.\n   b. Sum these to get the total log-likelihoods $\\ell_1(g)$ and $\\ell_0(g)$.\n   c. Compute $\\log \\mathrm{BF}_g = \\ell_1(g) - \\ell_0(g)$ and convert to base-$10$: $\\log_{10} \\mathrm{BF}_g = \\log \\mathrm{BF}_g / \\log(10)$.\n   d. Compute the log-prior odds, $\\mathrm{logit}(\\pi) = \\log(\\pi) - \\log(1-\\pi)$.\n   e. Compute the posterior probability $p_g = \\mathrm{sigmoid}(\\log \\mathrm{BF}_g + \\mathrm{logit}(\\pi))$.\n   f. Compute the posterior entropy $H_g$ from $p_g$.\n   g. Append the rounded values of $p_g$, $\\log_{10} \\mathrm{BF}_g$, and $H_g$ to their respective lists.\n   h. If $p_g \\ge \\tau$, increment `count`.\n3. Assemble the final list for the test case: `[posteriors, count, log10BFs, entropies]`.\n4. Repeat for all test cases and format the final output as a list of lists.",
            "answer": "[[[0.957,0.306,0.274,0.048,0.441],1,[1.524,-0.010,-0.142,-1.492,0.203],[0.176,0.617,0.589,0.191,0.689]],[[0.011,0.963,0.003,0.457,0.044],1,[-0.812,2.392,-1.602,0.771,-0.222],[0.061,0.157,0.021,0.691,0.180]],[[0.825,0.758,0.320,0.941],3,[0.725,0.505,-0.323,1.282],[0.460,0.551,0.628,0.229]]]"
        }
    ]
}