{
    "hands_on_practices": [
        {
            "introduction": "基因的调控始于转录因子（Transcription Factors, TFs）与DNA的结合。然而，在真核生物中，DNA紧密地缠绕在核小体上，构成了对TF结合的物理障碍。本练习将引导你使用连续时间马尔可夫链的动力学模型，来量化染色质重塑如何通过改变DNA的可及性，从而直接控制TF的结合速率，帮助你为染色质的“看门人”角色建立起定量的直觉。",
            "id": "4338614",
            "problem": "一个转录因子 (TF; Transcription Factor) 特异性地结合到一个基因组位点，其双分子结合速率常数为 $k_{\\text{on}}$，单分子解离速率常数为 $k_{\\text{off}}$。该转录因子的浓度为 $C$。当该位点位于裸露DNA上时，它始终是可及的。当该位点位于核小体DNA上时，由于染色质重塑剂 (CR; Chromatin Remodeler) 的活动，它会在不可及的关闭状态和可及的开放状态之间随机切换，其开放速率为 $k_{r}$ (重塑)，关闭速率为 $k_{c}$ (再核小体化)。假设TF结合只在开放状态下发生，并且当TF结合到位点时，不会发生再核小体化。\n\n从化学动力学和连续时间马尔可夫链中稳态概率流的核心定义出发，推导在以下每种情况下，TF结合到该位点的稳态期望速率（事件/秒）：\n1. 裸露DNA（始终可及）。\n2. 具有随机开放和关闭的核小体DNA。\n\n然后，使用您推导出的表达式，通过比较基线“低重塑”条件和“高重塑”条件，计算染色质重塑使核小体位点的结合起始频率增加了多少。使用以下参数值：\n- $k_{\\text{on}} = 1.0 \\times 10^{6}\\ \\text{M}^{-1}\\ \\text{s}^{-1}$，\n- $k_{\\text{off}} = 1.0 \\times 10^{-1}\\ \\text{s}^{-1}$，\n- $C = 1.0 \\times 10^{-8}\\ \\text{M}$，\n- $k_{c} = 2.0 \\times 10^{-1}\\ \\text{s}^{-1}$，\n- 基线开放速率 $k_{r}^{(0)} = 1.0 \\times 10^{-3}\\ \\text{s}^{-1}$，\n- 重塑后开放速率 $k_{r}^{(1)} = 5.0 \\times 10^{-2}\\ \\text{s}^{-1}$。\n\n将由重塑引起的倍数增加定义为在 $k_{r}^{(1)}$ 条件下的核小体结合起始速率与在 $k_{r}^{(0)}$ 条件下的核小体结合起始速率之比。将最终的倍数增加结果四舍五入到四位有效数字。最终答案必须是一个没有单位的单一数字。如果您进行任何速率的中间数值计算，请以 $\\text{s}^{-1}$ 为单位表示。",
            "solution": "该问题要求推导两种情况下TF结合起始的稳态速率：一个位于裸露DNA上的持续可及位点和一个位于核小体DNA上的随机可及位点。我们将这两种情况都建模为连续时间马尔可夫链，并通过求解稳态概率来找到结合通量。\n\n首先，我们将TF结合的有效一级速率常数定义为 $k'_{\\text{on}} = k_{\\text{on}}C$，其中 $k_{\\text{on}}$ 是双分子结合速率常数，$C$ 是TF浓度。\n\n**1. 裸露DNA（始终可及）**\n\n对于裸露DNA，结合位点始终是可及的。该系统可以用两种状态来描述：\n- 状态U：位点未结合 (Unbound)。\n- 状态B：位点已与TF结合 (Bound)。\n\n动力学方案是一个简单的可逆反应：\n$$\n\\text{U} \\underset{k_{\\text{off}}}{\\stackrel{k'_{\\text{on}}}{\\rightleftharpoons}} \\text{B}\n$$\n其中 $k'_{\\text{on}} = k_{\\text{on}}C$。\n\n在稳态下，从U到B的流速必须等于从B到U的流速。设 $P(\\text{U})$ 和 $P(\\text{B})$ 分别为处于未结合和已结合状态的稳态概率。\n平衡方程为：\n$$\nk'_{\\text{on}} P(\\text{U}) = k_{\\text{off}} P(\\text{B})\n$$\n此外，概率之和必须为1：\n$$\nP(\\text{U}) + P(\\text{B}) = 1\n$$\n根据平衡方程，我们将 $P(\\text{B})$ 表示为 $P(\\text{U})$ 的函数：\n$$\nP(\\text{B}) = \\frac{k'_{\\text{on}}}{k_{\\text{off}}} P(\\text{U})\n$$\n将此代入归一化条件：\n$$\nP(\\text{U}) + \\frac{k'_{\\text{on}}}{k_{\\text{off}}} P(\\text{U}) = 1 \\implies P(\\text{U}) \\left(1 + \\frac{k'_{\\text{on}}}{k_{\\text{off}}}\\right) = 1\n$$\n求解 $P(\\text{U})$：\n$$\nP(\\text{U}) = \\frac{1}{1 + \\frac{k'_{\\text{on}}}{k_{\\text{off}}}} = \\frac{k_{\\text{off}}}{k_{\\text{off}} + k'_{\\text{on}}}\n$$\n结合起始速率 $R_{\\text{naked}}$ 是从状态U到状态B的单向通量，它由该转变的速率常数与处于初始状态U的概率的乘积给出。\n$$\nR_{\\text{naked}} = k'_{\\text{on}} P(\\text{U}) = k_{\\text{on}}C \\cdot \\frac{k_{\\text{off}}}{k_{\\text{off}} + k_{\\text{on}}C}\n$$\n\n**2. 核小体DNA（随机可及性）**\n\n对于核小体DNA，结合位点的可及性是受调控的。该系统可用三种状态描述：\n- 状态C：位点位于一个关闭的、不可及的核小体上（且未结合）。\n- 状态O：位点位于一个开放的、可及的核小体上（且未结合）。\n- 状态B：位点位于一个开放的核小体上，并与TF结合。\n\n根据问题描述，动力学方案为：\n$$\n\\text{C} \\underset{k_c}{\\stackrel{k_r}{\\rightleftharpoons}} \\text{O} \\underset{k_{\\text{off}}}{\\stackrel{k'_{\\text{on}}}{\\rightleftharpoons}} \\text{B}\n$$\n其中 $k_r$ 是染色质开放速率，$k_c$ 是关闭速率，$k'_{\\text{on}} = k_{\\text{on}}C$。关键约束是TF只能结合到开放状态（O），并且当TF结合时核小体不能关闭（没有从B到C的转变）。\n\n设 $P(\\text{C})$、$P(\\text{O})$ 和 $P(\\text{B})$ 为稳态概率。状态间流的细致平衡方程为：\n1.  涉及状态C的流：$k_r P(\\text{C}) = k_c P(\\text{O})$\n2.  涉及状态B的流：$k'_{\\text{on}} P(\\text{O}) = k_{\\text{off}} P(\\text{B})$\n3.  归一化条件：$P(\\text{C}) + P(\\text{O}) + P(\\text{B}) = 1$\n\n我们可以将 $P(\\text{C})$ 和 $P(\\text{B})$ 表示为 $P(\\text{O})$ 的函数：\n根据方程(1)：\n$$\nP(\\text{C}) = \\frac{k_c}{k_r} P(\\text{O})\n$$\n根据方程(2)：\n$$\nP(\\text{B}) = \\frac{k'_{\\text{on}}}{k_{\\text{off}}} P(\\text{O})\n$$\n将这些代入归一化方程(3)：\n$$\n\\frac{k_c}{k_r} P(\\text{O}) + P(\\text{O}) + \\frac{k'_{\\text{on}}}{k_{\\text{off}}} P(\\text{O}) = 1\n$$\n提取公因子 $P(\\text{O})$：\n$$\nP(\\text{O}) \\left( \\frac{k_c}{k_r} + 1 + \\frac{k'_{\\text{on}}}{k_{\\text{off}}} \\right) = 1\n$$\n求解 $P(\\text{O})$：\n$$\nP(\\text{O}) = \\frac{1}{1 + \\frac{k'_{\\text{on}}}{k_{\\text{off}}} + \\frac{k_c}{k_r}}\n$$\n结合起始速率 $R_{\\text{nuc}}$ 是从未结合的开放状态(O)到结合状态(B)的单向通量。这是结合起始的唯一途径。\n$$\nR_{\\text{nuc}} = k'_{\\text{on}} P(\\text{O}) = \\frac{k'_{\\text{on}}}{1 + \\frac{k'_{\\text{on}}}{k_{\\text{off}}} + \\frac{k_c}{k_r}} = \\frac{k_{\\text{on}}C}{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_r}}\n$$\n\n**3. 倍数增加计算**\n\n我们被要求计算由于染色质重塑速率从基线 $k_{r}^{(0)}$ 增加到更高速率 $k_{r}^{(1)}$ 所引起的结合起始频率的倍数增加。倍数增加定义为相应速率的比值，$R_{\\text{nuc}}^{(1)} / R_{\\text{nuc}}^{(0)}$。\n\n设 $R_{\\text{nuc}}^{(0)}$ 为当 $k_r = k_{r}^{(0)}$ 时的速率，而 $R_{\\text{nuc}}^{(1)}$ 为当 $k_r = k_{r}^{(1)}$ 时的速率。\n$$\nR_{\\text{nuc}}^{(0)} = \\frac{k_{\\text{on}}C}{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_{r}^{(0)}}}\n$$\n$$\nR_{\\text{nuc}}^{(1)} = \\frac{k_{\\text{on}}C}{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_{r}^{(1)}}}\n$$\n倍数增加是它们的比值：\n$$\n\\text{Fold-Increase} = \\frac{R_{\\text{nuc}}^{(1)}}{R_{\\text{nuc}}^{(0)}} = \\frac{\\frac{k_{\\text{on}}C}{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_{r}^{(1)}}}}{\\frac{k_{\\text{on}}C}{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_{r}^{(0)}}}} = \\frac{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_{r}^{(0)}}}{1 + \\frac{k_{\\text{on}}C}{k_{\\text{off}}} + \\frac{k_c}{k_{r}^{(1)}}}\n$$\n现在，我们代入给定的数值：\n- $k_{\\text{on}} = 1.0 \\times 10^{6}\\ \\text{M}^{-1}\\ \\text{s}^{-1}$\n- $k_{\\text{off}} = 1.0 \\times 10^{-1}\\ \\text{s}^{-1}$\n- $C = 1.0 \\times 10^{-8}\\ \\text{M}$\n- $k_{c} = 2.0 \\times 10^{-1}\\ \\text{s}^{-1}$\n- $k_{r}^{(0)} = 1.0 \\times 10^{-3}\\ \\text{s}^{-1}$\n- $k_{r}^{(1)} = 5.0 \\times 10^{-2}\\ \\text{s}^{-1}$\n\n首先，我们计算无量纲比率：\n$$\n\\frac{k_{\\text{on}}C}{k_{\\text{off}}} = \\frac{(1.0 \\times 10^{6}\\ \\text{M}^{-1}\\ \\text{s}^{-1})(1.0 \\times 10^{-8}\\ \\text{M})}{1.0 \\times 10^{-1}\\ \\text{s}^{-1}} = \\frac{1.0 \\times 10^{-2}\\ \\text{s}^{-1}}{1.0 \\times 10^{-1}\\ \\text{s}^{-1}} = 0.1\n$$\n$$\n\\frac{k_c}{k_{r}^{(0)}} = \\frac{2.0 \\times 10^{-1}\\ \\text{s}^{-1}}{1.0 \\times 10^{-3}\\ \\text{s}^{-1}} = 200\n$$\n$$\n\\frac{k_c}{k_{r}^{(1)}} = \\frac{2.0 \\times 10^{-1}\\ \\text{s}^{-1}}{5.0 \\times 10^{-2}\\ \\text{s}^{-1}} = 4\n$$\n现在，我们在倍数增加的表达式中使用这些值：\n$$\n\\text{Fold-Increase} = \\frac{1 + 0.1 + 200}{1 + 0.1 + 4} = \\frac{201.1}{5.1}\n$$\n进行最后的除法运算：\n$$\n\\text{Fold-Increase} \\approx 39.4313725...\n$$\n作为中间结果，结合速率为：\n- $R_{\\text{nuc}}^{(0)} = \\frac{1.0 \\times 10^{-2}}{201.1}\\ \\text{s}^{-1} \\approx 4.973 \\times 10^{-5}\\ \\text{s}^{-1}$\n- $R_{\\text{nuc}}^{(1)} = \\frac{1.0 \\times 10^{-2}}{5.1}\\ \\text{s}^{-1} \\approx 1.961 \\times 10^{-3}\\ \\text{s}^{-1}$\n\n将最终的倍数增加结果四舍五入到四位有效数字，得到 $39.43$。",
            "answer": "$$\n\\boxed{39.43}\n$$"
        },
        {
            "introduction": "在理解了染色质结构的关键作用之后，我们需要思考如何精确地测量表观遗传标记。DNA甲基化是一种核心的表观遗传修饰，而亚硫酸氢盐测序（Bisulfite Sequencing）是检测它的金标准技术。本练习将深入探讨该技术的生物物理基础，通过将化学转换过程建模为一级反应，从而推导出校正其固有测量偏差的公式，这对于准确解读实验数据至关重要。",
            "id": "4338644",
            "problem": "亚硫酸氢盐测序 (BS-seq) 通过将未甲基化的胞嘧啶化学转化为尿嘧啶来推断胞嘧啶甲基化，经过聚合酶链式反应和测序后，这些尿嘧啶被读取为胸腺嘧啶，而甲基化的胞嘧啶对转化具有更强的抵抗性，并被读取为胞嘧啶。考虑一个在大量细胞混合物中的单一基因组胞嘧啶，其真实甲基化分数为 $m \\in [0,1]$。假设以下基础且经过充分检验的生物物理和统计学原理：(i) 亚硫酸氢钠对胞嘧啶的转化在时间上遵循一级反应，因此，对于一个脱氨速率常数为 $k$ 的胞嘧啶种类，在处理时间 $t$ 下，到时间 $t$ 为止的转化概率为 $1-\\exp(-k t)$；(ii) 甲基化和未甲基化的胞嘧啶具有不同的有效速率常数，分别为 $k_{m}$ 和 $k_{u}$，且 $k_{m} \\ll k_{u}$；(iii) 分子是从混合物中独立同分布地抽取的，因此群体水平的读数是混合权重为 $m$ 的伯努利混合分布的期望。\n\n将该位点观察到的甲基化分数 $\\hat{m}$ 定义为，在测序错误可忽略不计的情况下，经过亚硫酸氢盐处理和测序后报告为胞嘧啶的读数所占的比例。从上述原理出发，并且不引用任何预先推导的BS-seq校正公式，完成以下任务：\n\n- 推导未甲基化和甲基化胞嘧啶的期望转化概率，将其表示为 $k_{u}$、$k_{m}$ 和 $t$ 的函数。\n- 使用概率混合模型，推导观察到的胞嘧啶检出分数 $\\hat{m}$ 的期望值，将其表示为真实甲基化分数 $m$、未甲基化胞嘧啶的转化概率和甲基化胞嘧啶的非转化概率的函数。\n- 对此关系进行代数求解，以获得 $m$ 的一个封闭形式表达式，该表达式用可观察量 $\\hat{m}$ 以及动力学参数 $k_{u}$、$k_{m}$ 和 $t$ 表示。\n\n将您的最终答案表示为 $m$ 的单个封闭形式解析表达式，该表达式是 $\\hat{m}$、$k_{u}$、$k_{m}$ 和 $t$ 的函数。无需进行数值评估。如果为了可识别性需要对参数施加任何约束，请在您的推导中说明。最终答案必须是一个无单位的单一表达式。",
            "solution": "我们将亚硫酸氢钠转化建模为关于时间的一级反应，这是单分子转化的标准动力学模型。对于一个速率常数为 $k$ 的胞嘧啶种类，在处理时长 $t$ 下，到时间 $t$ 转化发生的概率为 $1-\\exp(-k t)$，而到时间 $t$ 未发生转化的概率为 $\\exp(-k t)$。我们区分两种物质：未甲基化的胞嘧啶，其速率常数为 $k_{u}$；以及甲基化的胞嘧啶，其速率常数为 $k_{m}$。由于甲基的保护作用，通常满足 $k_{m} \\ll k_{u}$。\n\n步骤 $1$：推导每种物质的转化概率。\n- 对于一个未甲基化的胞嘧啶，到时间 $t$ 的转化概率为\n$$\n\\alpha \\equiv 1 - \\exp(-k_{u} t),\n$$\n其不转化的概率为\n$$\n1 - \\alpha = \\exp(-k_{u} t).\n$$\n- 对于一个甲基化的胞嘧啶，到时间 $t$ 的转化概率为\n$$\n\\gamma \\equiv 1 - \\exp(-k_{m} t),\n$$\n其不转化（即抵抗转化）的概率为\n$$\n\\beta \\equiv 1 - \\gamma = \\exp(-k_{m} t).\n$$\n\n步骤 $2$：用 $m$、$\\alpha$ 和 $\\beta$ 表示观察到的胞嘧啶检出分数的期望值。\n在亚硫酸氢盐测序读数中，如果在处理过程中碱基未被转化，则被检出为胞嘧啶；如果被转化，则被检出为胸腺嘧啶。忽略测序错误，一个读数报告为胞嘧啶的概率是来自甲基化和未甲基化分子的不转化概率的混合，并按其丰度加权：\n$$\n\\mathbb{E}[\\hat{m}] = m \\cdot \\Pr(\\text{C call} \\mid \\text{methylated}) + (1 - m) \\cdot \\Pr(\\text{C call} \\mid \\text{unmethylated}).\n$$\n代入不转化的概率，得到\n$$\n\\mathbb{E}[\\hat{m}] = m \\cdot \\beta + (1 - m) \\cdot (1 - \\alpha).\n$$\n使用上述动力学定义，这变为\n$$\n\\mathbb{E}[\\hat{m}] = m \\cdot \\exp(-k_{m} t) + (1 - m) \\cdot \\exp(-k_{u} t).\n$$\n\n步骤 $3$：用 $\\hat{m}$、$k_{u}$、$k_{m}$ 和 $t$ 表示 $m$ 并求解。\n假设测序深度足够，使得 $\\hat{m}$ 集中在其期望值附近，为了推导校正公式，我们设 $\\hat{m} \\approx \\mathbb{E}[\\hat{m}]$。然后\n$$\n\\hat{m} = m \\cdot \\exp(-k_{m} t) + (1 - m) \\cdot \\exp(-k_{u} t).\n$$\n整理得，\n$$\n\\hat{m} = m \\cdot \\exp(-k_{m} t) + \\exp(-k_{u} t) - m \\cdot \\exp(-k_{u} t)\n= \\exp(-k_{u} t) + m \\left[\\exp(-k_{m} t) - \\exp(-k_{u} t)\\right].\n$$\n因此，\n$$\nm = \\frac{\\hat{m} - \\exp(-k_{u} t)}{\\exp(-k_{m} t) - \\exp(-k_{u} t)}.\n$$\n\n可识别性与约束条件：分母 $\\exp(-k_{m} t) - \\exp(-k_{u} t)$ 必须非零。在实际情况 $k_{m} \\neq k_{u}$ 和 $t > 0$ 的条件下，我们有 $\\exp(-k_{m} t) \\neq \\exp(-k_{u} t)$。在通常的实践中，$k_{m} < k_{u}$，因此 $\\exp(-k_{m} t) > \\exp(-k_{u} t)$，确保分母为正。此外，$k_{u} \\geq 0$，$k_{m} \\geq 0$ 且 $t \\geq 0$。\n\n该表达式明确地校正了观察到的胞嘧啶分数 $\\hat{m}$，针对在一级动力学条件下未甲基化胞嘧啶的不完全转化和甲基化胞嘧啶的潜在过度转化，从而量化并消除了由不完全转化引入的偏差。",
            "answer": "$$\\boxed{\\frac{\\hat{m}-\\exp(-k_{u} t)}{\\exp(-k_{m} t)-\\exp(-k_{u} t)}}$$"
        },
        {
            "introduction": "在探索了单个分子互作和一种测量技术后，我们现在将视角提升到系统层面。本练习模拟了一个真实的生物信息学分析流程，通过分析全基因组范围的CUT&RUN和ATAC-seq数据，来研究关键的抑制性复合物（Polycomb Repressive Complex $2$, PRC$2$）与染色质可及性之间的关系。通过对原始测序读数进行标准化处理并计算扰动后的变化，你将学习如何运用真实的基因组学数据类型来检验重要的生物学假说。",
            "id": "4338626",
            "problem": "给定代表多梳抑制复合物 2 (PRC2) 的靶向切割和核酸酶释放技术 (CUT&RUN) 以及基于转座酶可及性染色质测序技术 (ATAC-seq) 的染色质可及性的配对图谱，每项均在对照组和长链非编码RNA (lncRNA) 敲低条件下，在一组具有已知长度的共享基因组窗口上进行测量。根据系统生物医学中基于测序的占位分析的基本原理，假设一个基因组窗口中的预期占位或可及性信号与映射到该窗口的比对读数数量成正比，与文库大小（总比对读数）成反比，并与该窗口的基因组跨度成反比。在此模型下，将条件 $X \\in \\{C, K\\}$ 中PRC$2$的归一化单位碱基信号定义为\n$$\ns_{R}^{(X)}(i) \\equiv \\frac{x_{i}^{(X)}}{L_{R}^{(X)} \\cdot \\ell_i},\n$$\n并将可及性的归一化单位碱基信号定义为\n$$\ns_{A}^{(X)}(i) \\equiv \\frac{a_{i}^{(X)}}{L_{A}^{(X)} \\cdot \\ell_i},\n$$\n其中 $x_{i}^{(X)}$ 和 $a_{i}^{(X)}$ 分别是PRC$2$和可及性的原始读数计数，$L_{R}^{(X)}$ 和 $L_{A}^{(X)}$ 是相应的文库大小（总比对读数），而 $\\ell_i$ 是窗口 $i$ 的长度（单位为碱基对）。使用一个小的伪计数 $\\varepsilon = 10^{-12}$ 来避免除以零或对零取对数。\n\n您的任务是实现一个程序，为每个提供的测试用例计算：\n- lncRNA敲低条件下PRC$2$占位的全局变化，\n$$\n\\Delta_R \\equiv \\log_2\\left(\\frac{\\sum_{i} s_{R}^{(K)}(i) + \\varepsilon}{\\sum_{i} s_{R}^{(C)}(i) + \\varepsilon}\\right),\n$$\n- 染色质可及性的全局变化，\n$$\n\\Delta_A \\equiv \\log_2\\left(\\frac{\\sum_{i} s_{A}^{(K)}(i) + \\varepsilon}{\\sum_{i} s_{A}^{(C)}(i) + \\varepsilon}\\right),\n$$\n- 以及PRC$2$和可及性的每个窗口对数倍数变化之间的皮尔逊相关系数，\n$$\nd_R(i) \\equiv \\log_2\\left(\\frac{s_{R}^{(K)}(i) + \\varepsilon}{s_{R}^{(C)}(i) + \\varepsilon}\\right), \\quad\nd_A(i) \\equiv \\log_2\\left(\\frac{s_{A}^{(K)}(i) + \\varepsilon}{s_{A}^{(C)}(i) + \\varepsilon}\\right),\n$$\n$$\nr \\equiv \\frac{\\sum_i \\left(d_R(i) - \\overline{d_R}\\right)\\left(d_A(i) - \\overline{d_A}\\right)}{\\sqrt{\\sum_i \\left(d_R(i) - \\overline{d_R}\\right)^2} \\cdot \\sqrt{\\sum_i \\left(d_A(i) - \\overline{d_A}\\right)^2}},\n$$\n并约定如果 $d_R$ 或 $d_A$ 的方差为零（导致 $r$ 未定义），则将 $r$ 定义为 $0$。\n\n科学真实性约束：假设窗口不重叠并覆盖与Polycomb靶向相关的区域，观察到的计数来自于与潜在占位或可及性成比例的独立抽样，并且文库大小和窗口长度是主要的归一化因子。\n\n请实现您的程序以评估以下测试套件。每个测试用例指定了窗口长度 $\\{\\ell_i\\}$，对照组 $\\{x_i^{(C)}\\}$ 和敲低组 $\\{x_i^{(K)}\\}$ 的PRC$2$计数及其文库大小 $L_R^{(C)}$ 和 $L_R^{(K)}$，以及对照组 $\\{a_i^{(C)}\\}$ 和敲低组 $\\{a_i^{(K)}\\}$ 的ATAC计数及其文库大小 $L_A^{(C)}$ 和 $L_A^{(K)}$：\n\n- 测试用例 1（典型变化：PRC$2$减少，可及性增加）：\n  - 窗口长度 $\\{\\ell_i\\} = \\{1000, 800, 1200, 600, 1000\\}$\n  - PRC$2$对照组计数 $\\{x_i^{(C)}\\} = \\{500, 400, 600, 200, 300\\}$，PRC$2$敲低组计数 $\\{x_i^{(K)}\\} = \\{300, 250, 350, 120, 150\\}$\n  - PRC$2$文库大小 $L_R^{(C)} = 20000000$, $L_R^{(K)} = 22000000$\n  - 可及性对照组计数 $\\{a_i^{(C)}\\} = \\{200, 220, 180, 150, 190\\}$，可及性敲低组计数 $\\{a_i^{(K)}\\} = \\{260, 300, 240, 200, 230\\}$\n  - 可及性文库大小 $L_A^{(C)} = 25000000$, $L_A^{(K)} = 23000000$\n\n- 测试用例 2（无变化；边界条件）：\n  - 窗口长度 $\\{\\ell_i\\} = \\{1000, 1000, 1000, 1000\\}$\n  - PRC$2$对照组计数 $\\{x_i^{(C)}\\} = \\{100, 100, 100, 100\\}$，PRC$2$敲低组计数 $\\{x_i^{(K)}\\} = \\{100, 100, 100, 100\\}$\n  - PRC$2$文库大小 $L_R^{(C)} = 10000000$, $L_R^{(K)} = 10000000$\n  - 可及性对照组计数 $\\{a_i^{(C)}\\} = \\{80, 120, 90, 110\\}$，可及性敲低组计数 $\\{a_i^{(K)}\\} = \\{80, 120, 90, 110\\}$\n  - 可及性文库大小 $L_A^{(C)} = 10000000$, $L_A^{(K)} = 10000000$\n\n- 测试用例 3（低计数含零；测试伪计数处理）：\n  - 窗口长度 $\\{\\ell_i\\} = \\{500, 1500, 800, 1200\\}$\n  - PRC$2$对照组计数 $\\{x_i^{(C)}\\} = \\{0, 10, 0, 5\\}$，PRC$2$敲低组计数 $\\{x_i^{(K)}\\} = \\{0, 5, 0, 2\\}$\n  - PRC$2$文库大小 $L_R^{(C)} = 5000000$, $L_R^{(K)} = 6000000$\n  - 可及性对照组计数 $\\{a_i^{(C)}\\} = \\{50, 0, 40, 0\\}$，可及性敲低组计数 $\\{a_i^{(K)}\\} = \\{25, 0, 80, 0\\}$\n  - 可及性文库大小 $L_A^{(C)} = 8000000$, $L_A^{(K)} = 7000000$\n\n- 测试用例 4（PRC$2$增加，可及性减少；零方差相关性边缘情况）：\n  - 窗口长度 $\\{\\ell_i\\} = \\{500, 500, 500\\}$\n  - PRC$2$对照组计数 $\\{x_i^{(C)}\\} = \\{120, 80, 60\\}$，PRC$2$敲低组计数 $\\{x_i^{(K)}\\} = \\{240, 160, 120\\}$\n  - PRC$2$文库大小 $L_R^{(C)} = 15000000$, $L_R^{(K)} = 15000000$\n  - 可及性对照组计数 $\\{a_i^{(C)}\\} = \\{300, 200, 100\\}$，可及性敲低组计数 $\\{a_i^{(K)}\\} = \\{150, 100, 50\\}$\n  - 可及性文库大小 $L_A^{(C)} = 12000000$, $L_A^{(K)} = 10000000$\n\n对于每个测试用例，您的程序必须返回一个包含三个实数 $[\\Delta_R, \\Delta_A, r]$ 的列表。将所有测试用例的输出聚合到一行中，形式为列表的列表。您的程序应生成单行输出，其中包含结果，格式为一个用方括号括起来的逗号分隔列表（例如，$[[result1,result2,result3]$，其中每个 $resultj$ 本身就是一个列表 $[\\Delta_R, \\Delta_A, r]$）。",
            "solution": "用户提供的问题陈述成功通过了验证。它在科学上基于基因组学和生物信息学的原理，在数学上是适定的，包含了所有必要信息和明确的定义，并以客观的术语表述。未检测到任何可能导致其无效的缺陷。因此，我将提供一个完整的解决方案。\n\n该问题要求实现一个计算分析流程，以量化和比较来自新一代测序数据的多梳抑制复合物$2$（PRC$2$）占位和染色质可及性的变化。该分析基于一个已定义的生物物理和统计模型。解决方案分为三个主要部分：数据归一化、信号变化量化和相关性分析。\n\n**1. 测序数据的归一化**\n\n像CUT&RUN和ATAC-seq这类基于测序的分析方法，其基本原理是映射到特定基因组区域的读数数量与该区域中感兴趣的生物信号（例如，蛋白质占位或DNA可及性）成正比。然而，在给定的基因组窗口 $i$ 和实验条件 $X$ 下，表示为PRC$2$的 $x_{i}^{(X)}$ 和可及性的 $a_{i}^{(X)}$ 的原始读数计数是不能直接比较的。它们至少受到两个主要技术因素的干扰：\n- **测序深度（文库大小）：** 一个具有更大数据总量（文库大小，$L$）的实验将系统性地在所有窗口产生更高的计数，而与生物学变化无关。\n- **基因组窗口长度：** 即使单位碱基对的信号密度是均匀的，一个更长的基因组窗口（$\\ell_i$）也有更大的机会偶然累积读数。\n\n为了解释这些因素并推导出一个可比较的信号密度度量，该问题定义了一个归一化单位碱基信号。对于条件 $X \\in \\{C, K\\}$（对照组，敲低组）中的PRC$2$，窗口 $i$ 的归一化信号为：\n$$\ns_{R}^{(X)}(i) \\equiv \\frac{x_{i}^{(X)}}{L_{R}^{(X)} \\cdot \\ell_i}\n$$\n同样，对于可及性，归一化信号为：\n$$\ns_{A}^{(X)}(i) \\equiv \\frac{a_{i}^{(X)}}{L_{A}^{(X)} \\cdot \\ell_i}\n$$\n这些公式有效地计算了信号密度，代表了映射到给定窗口的总文库读数部分，并按窗口的碱基对长度进行了归一化。这种归一化方法是一种简化但标准且有原则的方法，类似于每百万比对读数中每千碱基的读数（RPKM）等指标。\n\n**2. 全局和局部信号变化的量化**\n\n有了归一化信号，我们就可以量化lncRNA敲低的效果。该问题指定了两个分析层面：全局和局部。\n\n- **全局变化：** 为了评估在整个分析窗口集合中信号的总体变化，定义了全局变化指标 $\\Delta_R$ 和 $\\Delta_A$。它们的计算方法是：首先将每个条件下所有窗口的归一化单位碱基信号相加，然后计算这些总和的比值的以2为底的对数。\n$$\n\\Delta_R \\equiv \\log_2\\left(\\frac{\\sum_{i} s_{R}^{(K)}(i) + \\varepsilon}{\\sum_{i} s_{R}^{(C)}(i) + \\varepsilon}\\right), \\quad \\Delta_A \\equiv \\log_2\\left(\\frac{\\sum_{i} s_{A}^{(K)}(i) + \\varepsilon}{\\sum_{i} s_{A}^{(C)}(i) + \\varepsilon}\\right)\n$$\n例如，$\\Delta_R = -1$ 的值表示在敲低后，所研究位点上的总PRC$2$信号减少了$2$倍。添加小的伪计数 $\\varepsilon = 10^{-12}$ 是为了确保数值稳定性，防止在某个条件的总信号为零时出现除以零或对零取对数的情况。\n\n- **局部变化：** 为了理解单个窗口的行为，计算了每个窗口的对数倍数变化。其定义如下：\n$$\nd_R(i) \\equiv \\log_2\\left(\\frac{s_{R}^{(K)}(i) + \\varepsilon}{s_{R}^{(C)}(i) + \\varepsilon}\\right), \\quad d_A(i) \\equiv \\log_2\\left(\\frac{s_{A}^{(K)}(i) + \\varepsilon}{s_{A}^{(C)}(i) + \\varepsilon}\\right)\n$$\n这些值，$d_R(i)$ 和 $d_A(i)$，构成了对扰动的局部响应向量，从而能够更细致地观察生物学效应。\n\n**3. 局部变化的相关性**\n\n最后的任务是确定PRC$2$占位的局部变化与染色质可及性的局部变化之间是否存在关系。PRC$2$（一个抑制性复合物）与开放染色质之间的典型拮抗作用表明，在PRC$2$丢失的地方，可及性应该增加，反之亦然。这种反比关系可以使用局部对数倍数变化向量 $d_R$ 和 $d_A$ 之间的皮尔逊相关系数 $r$ 来量化。\n皮尔逊相关系数的公式是：\n$$\nr \\equiv \\frac{\\operatorname{cov}(d_R, d_A)}{\\sigma_{d_R} \\sigma_{d_A}} = \\frac{\\sum_i \\left(d_R(i) - \\overline{d_R}\\right)\\left(d_A(i) - \\overline{d_A}\\right)}{\\sqrt{\\sum_i \\left(d_R(i) - \\overline{d_R}\\right)^2} \\cdot \\sqrt{\\sum_i \\left(d_A(i) - \\overline{d_A}\\right)^2}}\n$$\n其中 $\\overline{d_R}$ 和 $\\overline{d_A}$ 分别是各自对数倍数变化向量的均值。系数 $r$ 的范围从 $-1$（完全负相关）到 $+1$（完全正相关），$0$ 表示没有线性相关性。该问题正确地指定了一个约定来处理相关性在数学上未定义的情况，即其中一个信号在所有窗口中没有变化（即其方差 $\\sigma^2$ 为零）。在这种情况下， $r$ 被定义为 $0$。\n\n**计算算法**\n\n对于每个测试用例，实现将按以下步骤进行：\n1.  将所有输入数据——窗口长度、读数计数和文库大小——表示为数值数组和标量变量。\n2.  使用上面定义的逐元素公式，计算四个归一化信号向量：$s_{R}^{(C)}$、$s_{R}^{(K)}$、$s_{A}^{(C)}$ 和 $s_{A}^{(K)}$。\n3.  通过对相应的信号向量求和，加上伪计数 $\\varepsilon$，然后取比值的以2为底的对数，来计算全局变化指标 $\\Delta_R$ 和 $\\Delta_A$。\n4.  计算两个每个窗口的对数倍数变化向量 $d_R$ 和 $d_A$。\n5.  计算 $d_R$ 和 $d_A$ 向量的方差。如果任一方差为零，则将皮尔逊相关系数 $r$ 设为 $0$。否则，使用标准公式计算 $r$。\n6.  收集该测试用例的三个结果值 $[\\Delta_R, \\Delta_A, r]$。\n7.  将所有测试用例的结果聚合成一个最终的列表的列表以供输出。\n这个过程系统地将所提供的生物统计模型转化为一组具体的计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes global signal changes and local correlation for paired\n    genomic sequencing data based on a provided normalization model.\n    \"\"\"\n    \n    # Pseudocount to avoid numerical instability\n    epsilon = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"l\": [1000, 800, 1200, 600, 1000],\n            \"x_c\": [500, 400, 600, 200, 300],\n            \"x_k\": [300, 250, 350, 120, 150],\n            \"L_R_C\": 20000000,\n            \"L_R_K\": 22000000,\n            \"a_c\": [200, 220, 180, 150, 190],\n            \"a_k\": [260, 300, 240, 200, 230],\n            \"L_A_C\": 25000000,\n            \"L_A_K\": 23000000,\n        },\n        {\n            \"l\": [1000, 1000, 1000, 1000],\n            \"x_c\": [100, 100, 100, 100],\n            \"x_k\": [100, 100, 100, 100],\n            \"L_R_C\": 10000000,\n            \"L_R_K\": 10000000,\n            \"a_c\": [80, 120, 90, 110],\n            \"a_k\": [80, 120, 90, 110],\n            \"L_A_C\": 10000000,\n            \"L_A_K\": 10000000,\n        },\n        {\n            \"l\": [500, 1500, 800, 1200],\n            \"x_c\": [0, 10, 0, 5],\n            \"x_k\": [0, 5, 0, 2],\n            \"L_R_C\": 5000000,\n            \"L_R_K\": 6000000,\n            \"a_c\": [50, 0, 40, 0],\n            \"a_k\": [25, 0, 80, 0],\n            \"L_A_C\": 8000000,\n            \"L_A_K\": 7000000,\n        },\n        {\n            \"l\": [500, 500, 500],\n            \"x_c\": [120, 80, 60],\n            \"x_k\": [240, 160, 120],\n            \"L_R_C\": 15000000,\n            \"L_R_K\": 15000000,\n            \"a_c\": [300, 200, 100],\n            \"a_k\": [150, 100, 50],\n            \"L_A_C\": 12000000,\n            \"L_A_K\": 10000000,\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Convert inputs to numpy arrays for vectorized operations\n        l_arr = np.array(case[\"l\"], dtype=np.float64)\n        x_c_arr = np.array(case[\"x_c\"], dtype=np.float64)\n        x_k_arr = np.array(case[\"x_k\"], dtype=np.float64)\n        a_c_arr = np.array(case[\"a_c\"], dtype=np.float64)\n        a_k_arr = np.array(case[\"a_k\"], dtype=np.float64)\n\n        # 1. Calculate normalized per-base signals\n        s_r_c = x_c_arr / (case[\"L_R_C\"] * l_arr)\n        s_r_k = x_k_arr / (case[\"L_R_K\"] * l_arr)\n        s_a_c = a_c_arr / (case[\"L_A_C\"] * l_arr)\n        s_a_k = a_k_arr / (case[\"L_A_K\"] * l_arr)\n\n        # 2. Calculate global changes (Delta_R, Delta_A)\n        sum_s_r_c = np.sum(s_r_c)\n        sum_s_r_k = np.sum(s_r_k)\n        delta_r = np.log2((sum_s_r_k + epsilon) / (sum_s_r_c + epsilon))\n\n        sum_s_a_c = np.sum(s_a_c)\n        sum_s_a_k = np.sum(s_a_k)\n        delta_a = np.log2((sum_s_a_k + epsilon) / (sum_s_a_c + epsilon))\n\n        # 3. Calculate per-window log-fold changes (d_R, d_A)\n        d_r = np.log2((s_r_k + epsilon) / (s_r_c + epsilon))\n        d_a = np.log2((s_a_k + epsilon) / (s_a_c + epsilon))\n        \n        # 4. Calculate Pearson correlation coefficient (r)\n        # Handle the special case where variance is zero.\n        if np.var(d_r) == 0.0 or np.var(d_a) == 0.0:\n            r = 0.0\n        else:\n            # Use numpy's built-in correlation coefficient function\n            corr_matrix = np.corrcoef(d_r, d_a)\n            r = corr_matrix[0, 1]\n            # Ensure stability for near-zero variance due to float precision\n            if np.isnan(r):\n                r = 0.0\n\n        all_results.append([delta_r, delta_a, r])\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list is \"[item1, item2, ...]\"\n    # so joining these string representations with a comma produces the desired output.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}