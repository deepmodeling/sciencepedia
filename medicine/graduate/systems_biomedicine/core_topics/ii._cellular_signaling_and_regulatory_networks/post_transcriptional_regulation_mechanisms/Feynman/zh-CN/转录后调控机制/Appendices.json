{
    "hands_on_practices": [
        {
            "introduction": "为了定量地理解转录后调控，第一步是建立一个描述信使核糖核酸（$mRNA$）生命周期的数学模型。这个练习将指导你通过基本的质量作用动力学原理，构建一个包含前体$mRNA$（$pre-mRNA$）加工、成熟$mRNA$出核和降解过程的区室模型。通过推导细胞质中成熟$mRNA$的稳态丰度 ，你将掌握分析这类动态系统的基本方法，并揭示一个重要的系统层面的特性：在线性通路中，中间步骤的速率常数可能不影响最终产物的稳态水平。",
            "id": "4376249",
            "problem": "在系统生物医学框架内，考虑一个单细胞中的双室转录后调控模型。在核室中，新合成的未加工前体信使核糖核酸（pre-mRNA）分子以转录速率 $\\alpha$（单位：分子/单位时间）产生。这些核内pre-mRNA分子以一级核加工速率 $k_{p}$（单位：/单位时间）被加工成熟的核信使核糖核酸（mRNA）。成熟的核mRNA以一级输出速率 $k_{e}$（单位：/单位时间）被输出到细胞质。在细胞质室中，成熟的mRNA以一级细胞质降解速率 $\\delta$（单位：/单位时间）被降解。假设以下基本依据：\n- 分子生物学的中心法则确立了信使核糖核酸（mRNA）从脱氧核糖核酸（DNA）合成、加工、并输出到细胞质，在细胞质中可以被翻译和降解。\n- 根据质量作用动力学，每个单分子转换的瞬时速率与所涉及的底物物种的丰度成正比，比例常数由速率参数给出。\n\n使用这些依据为核pre-mRNA、成熟核mRNA和细胞质成熟mRNA的丰度建立一个动力学系统，将丰度视为绝对分子数。假设所有参数 $\\alpha$、$k_{p}$、$k_{e}$ 和 $\\delta$ 均为正常数，不存在核内降解，且系统达到时不变稳态。\n\n从你构建的质量作用动力学系统出发，推导细胞质成熟mRNA的稳态丰度，将其表示为关于 $\\alpha$、$k_{p}$、$k_{e}$ 和 $\\delta$ 的闭式解析表达式。以分子数表示最终丰度。以单个闭式表达式的形式提供答案，且表达式内不应包含单位。无需进行数值计算或四舍五入。",
            "solution": "该问题要求基于一个双室转录后调控模型，推导细胞质成熟信使核糖核酸（mRNA）的稳态丰度。该问题是有效的，因为它在分子生物学上具有科学依据，提法得当且客观。它提供了一套完整的参数和约束，以构建一个可解的数学模型。\n\n首先，我们定义变量来表示系统中各物种的丰度（绝对分子数），作为时间 $t$ 的函数。\n设 $P(t)$ 为核pre-mRNA的丰度。\n设 $N(t)$ 为成熟核mRNA的丰度。\n设 $C(t)$ 为细胞质成熟mRNA的丰度。\n\n问题陈述描述了以下过程，我们基于质量作用动力学原理将其转化为一个常微分方程（ODE）组：\n\n1.  **核pre-mRNA ($P(t)$):** pre-mRNA以恒定的转录速率 $\\alpha$ 产生。它以一级速率 $k_{p}$ 被加工成成熟核mRNA而被消耗，意味着消耗速率为 $k_{p}P(t)$。问题指明没有其他针对 $P(t)$ 的产生或消耗项。\n    $P(t)$ 的变化率由以下公式给出：\n    $$ \\frac{dP}{dt} = \\alpha - k_{p}P(t) $$\n\n2.  **成熟核mRNA ($N(t)$):** 成熟核mRNA由pre-mRNA加工产生，速率为 $k_{p}P(t)$。它以一级速率 $k_{e}$ 被输出到细胞质而被消耗，意味着消耗速率为 $k_{e}N(t)$。问题声明假设无核内降解。\n    $N(t)$ 的变化率由以下公式给出：\n    $$ \\frac{dN}{dt} = k_{p}P(t) - k_{e}N(t) $$\n\n3.  **细胞质成熟mRNA ($C(t)$):** 细胞质mRNA由成熟核mRNA输出产生，速率为 $k_{e}N(t)$。它以一级速率 $\\delta$ 被降解而消耗，意味着消耗速率为 $\\delta C(t)$。\n    $C(t)$ 的变化率由以下公式给出：\n    $$ \\frac{dC}{dt} = k_{e}N(t) - \\delta C(t) $$\n\n问题要求的是稳态丰度。在稳态下，系统是时不变的，这意味着每个物种的变化率都为零。我们将稳态丰度表示为 $P_{ss}$、$N_{ss}$ 和 $C_{ss}$。\n$$ \\frac{dP}{dt} = 0, \\quad \\frac{dN}{dt} = 0, \\quad \\frac{dC}{dt} = 0 $$\n\n我们依次求解所得的代数方程组。\n\n从 $P(t)$ 的方程，我们得到：\n$$ 0 = \\alpha - k_{p}P_{ss} $$\n求解 $P_{ss}$ 得：\n$$ k_{p}P_{ss} = \\alpha $$\n$$ P_{ss} = \\frac{\\alpha}{k_{p}} $$\n\n接下来，我们使用 $N(t)$ 的稳态方程：\n$$ 0 = k_{p}P_{ss} - k_{e}N_{ss} $$\n$$ k_{e}N_{ss} = k_{p}P_{ss} $$\n我们代入刚刚找到的 $P_{ss}$ 的表达式：\n$$ k_{e}N_{ss} = k_{p}\\left(\\frac{\\alpha}{k_{p}}\\right) = \\alpha $$\n求解 $N_{ss}$ 得：\n$$ N_{ss} = \\frac{\\alpha}{k_{e}} $$\n\n最后，我们使用 $C(t)$ 的稳态方程来求得所需量 $C_{ss}$：\n$$ 0 = k_{e}N_{ss} - \\delta C_{ss} $$\n$$ \\delta C_{ss} = k_{e}N_{ss} $$\n我们代入 $N_{ss}$ 的表达式：\n$$ \\delta C_{ss} = k_{e}\\left(\\frac{\\alpha}{k_{e}}\\right) = \\alpha $$\n求解 $C_{ss}$ 得到细胞质成熟mRNA的稳态丰度：\n$$ C_{ss} = \\frac{\\alpha}{\\delta} $$\n\n这个结果表明，在稳态下，mRNA的总产生速率（$\\alpha$）与总降解速率（$\\delta C_{ss}$）完全平衡。由速率 $k_p$ 和 $k_e$ 控制的中间加工和输出步骤决定了前体物种的稳态水平，但在所指定的途径是线性和不可逆的条件下，它们不影响细胞质mRNA的最终稳态水平。",
            "answer": "$$\\boxed{\\frac{\\alpha}{\\delta}}$$"
        },
        {
            "introduction": "在系统生物学研究中，一个核心挑战是从充满相关性和间接影响的观测数据中，准确推断出因果调控关系。这个高级练习将引导你进入计算系统生物学的领域，应用线性结构模型来解决这个问题。你将通过编程实现一个因果推断模型 ，以量化一个$RNA$结合蛋白（$RBP$）对$mRNA$半衰期和翻译效率的直接影响，同时校正潜在的混杂因素。这个练习不仅能锻炼你的计算技能，更重要的是，它展示了如何从复杂的观测数据中获得更可靠的生物学见解。",
            "id": "4376240",
            "problem": "您会获得与特定 RNA 结合蛋白 (RBP) 进行转录后调控相关的每个转录本的测量数据。目标是使用一个有原则的模型，从观测到的特征中推断因果调控效应，该模型会考虑已测量的混杂因素。其科学基础包括分子生物学中心法则、信使核糖核酸 (mRNA) 半衰期（定义为降解前的预期时间）、核糖体密度（作为翻译效率的代理指标），以及标准的因果图模型假设。增强型交联免疫沉淀 (eCLIP) 占有率被用作 RBP 在转录本上结合概率的代理指标。所有变化都定义为相对于适当匹配的对照组的差异，因此残余基线偏移实际上为零，可以省略截距项。\n\n假设存在同时影响 eCLIP 占有率、mRNA 半衰期变化和核糖体密度变化的已测量混杂因素。设变量为：\n- eCLIP 占有率 $O$ (范围在 $[0,1]$ 内，无单位)，\n- mRNA 半衰期变化 $H$ ($\\log_2$ 倍数变化，无单位)，\n- 核糖体密度变化 $R$ ($\\log_2$ 倍数变化，无单位)，\n- 一个由可测量混杂因素组成的向量 $C = (C_1, C_2)$ (无单位)。\n\n您需要假设存在以下线性结构方程，其噪声项独立且均值为零，并且没有截距项（因为所有变量都是相对于对照组的变化）：\n- $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$，其中 $\\mathbb{E}[\\varepsilon_H \\mid O, C] = 0$，\n- $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$，其中 $\\mathbb{E}[\\varepsilon_R \\mid O, H, C] = 0$。\n\n根据后门准则，当以可测量的混杂因素 $C$ 为条件时，$O$ 对 $H$ 的因果效应由偏回归系数 $\\beta_{OH}$ 识别。在受控直接效应的标准可识别条件下，$O$ 对 $R$ 不经由 $H$ 介导的直接因果效应，可通过对 $R$ 关于 $(O, H, C)$ 进行多元回归得到的偏回归系数 $\\gamma_{OR}$ 来识别。\n\n您的任务是实现一个程序，为每个提供的数据集估计：\n- 通过对 $(O, C_1, C_2)$ 上的 $H$ 进行无截距项的最小二乘回归，来估计 eCLIP 占有率对半衰期的调整后因果效应 $\\beta_{OH}$，以及\n- 通过对 $(O, H, C_1, C_2)$ 上的 $R$ 进行无截距项的最小二乘回归，来估计 eCLIP 占有率对核糖体密度的调整后直接因果效应 $\\gamma_{OR}$。\n\n所有数据集都规模小、确定性且具有科学合理性。它们被设计为满足线性关系，并包含轻微的噪声项以避免精确的共线性，同时保持结果的可解释性。每个数据集对应于索引为 $i = 1, \\dots, n$ 的转录本。\n\n测试套件。对于以下每种情况，请使用给定的精确数组。所有数值均无单位。\n\n情况 A (一般情况，可识别，存在介导效应和直接效应):\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.01,\\,0.39,\\,0.82,\\,-0.02,\\,0.40,\\,0.81\\,]$\n- $R$: $[\\,0.087,\\,0.613,\\,1.174,\\,0.146,\\,0.70,\\,1.247\\,]$\n\n情况 B (对 $R$ 没有直接效应，仅通过 $H$ 介导):\n- $O$: $[\\,0.2,\\,0.6,\\,1.0,\\,0.4,\\,0.8,\\,1.2\\,]$\n- $C_1$: $[\\,0,\\,1,\\,2,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,1,\\,1,\\,2,\\,2,\\,2\\,]$\n- $H$: $[\\,0.175,\\,0.505,\\,0.860,\\,0.330,\\,0.680,\\,1.025\\,]$\n- $R$: $[\\,0.090,\\,0.454,\\,0.838,\\,0.164,\\,0.544,\\,0.920\\,]$\n\n情况 C (对 $R$ 有负向直接效应，对 $H$ 的效应较弱):\n- $O$: $[\\,0.1,\\,0.3,\\,0.5,\\,0.7,\\,0.9\\,]$\n- $C_1$: $[\\,0,\\,1,\\,0,\\,1,\\,2\\,]$\n- $C_2$: $[\\,1,\\,0,\\,2,\\,1,\\,0\\,]$\n- $H$: $[\\, -0.19,\\,0.34,\\,-0.36,\\,0.17,\\,0.695\\,]$\n- $R$: $[\\,0.05,\\,0.05,\\,-0.05,\\,-0.05,\\,-0.05\\,]$\n\n算法要求：\n- 对于每种情况，按照规定为两个回归构建设计矩阵，省略截距列。\n- 使用普通最小二乘法估计系数。如果设计矩阵不是满秩，请使用数值稳定的求解器返回的最小范数最小二乘解。\n- 提取 $H$ 模型中与 $O$ 相乘的系数作为 $\\beta_{OH}$。\n- 提取 $R$ 模型中与 $O$ 相乘的系数作为 $\\gamma_{OR}$。\n\n角度单位不适用。没有物理单位；所有量均为无量纲。不得使用百分比；请使用给定的小数。\n\n输出规范：\n- 对于每种情况，返回一个包含两个浮点数的列表 $[\\,\\widehat{\\beta}_{OH},\\,\\widehat{\\gamma}_{OR}\\,]$，每个数四舍五入到三位小数。\n- 将三种情况的结果汇总到程序打印的单行中，作为一个列表的列表，不带任何额外文本。确切格式必须是：\n\"[ [bA,gA], [bB,gB], [bC,gC] ]\"，但除了分隔数字和括号所必需的逗号和括号外，不含空格，且每个数字都显示为恰好三位小数，例如：\"[[0.500,0.400],[0.600,0.000],[0.100,-0.500]]\"。\n\n您的程序应生成一行输出，其中包含按上述描述的方括号内逗号分隔列表形式的结果。",
            "solution": "用户提供了一个系统生物医学领域的问题，重点是转录后基因调控。任务是使用指定的线性结构模型，从观测数据中估计因果参数。\n\n该问题已经过验证，并被确定为健全的。它在科学上植根于分子生物学，并采用标准的因果推断统计方法，特别是用于调整混杂因素的回归分析。该问题定义明确、客观，并为获得唯一解提供了所有必要的数据和规范。\n\n问题的核心是从一组线性结构方程中估计两个参数 $\\beta_{OH}$ 和 $\\gamma_{OR}$：\n1. $H = \\beta_{OH}\\, O + \\beta_{CH}^{\\top} C + \\varepsilon_H$\n2. $R = \\gamma_{OR}\\, O + \\gamma_{HR}\\, H + \\gamma_{CR}^{\\top} C + \\varepsilon_R$\n\n其中 $O$ 代表 eCLIP 占有率，$H$ 是 mRNA 半衰期变化，$R$ 是核糖体密度变化，$C=(C_1, C_2)$ 是一个由可测量混杂因素组成的向量。模型需在无截距项的情况下进行拟合，因为所有变量都定义为相对于对照组的变化。\n\n规定的估计方法是普通最小二乘法 (OLS)。对于形如 $y = X\\beta + \\varepsilon$ 的一般线性模型，参数向量 $\\beta$ 的 OLS 估计量 $\\hat{\\beta}$ 是使残差平方和 $\\|y - X\\hat{\\beta}\\|_2^2$ 最小化的向量。这可以通过求解正规方程 $X^\\top X \\hat{\\beta} = X^\\top y$ 来找到。一种数值稳定的求解方法，同时也能处理设计矩阵 $X$ 不是列满秩的情况，是使用基于奇异值分解 (SVD) 的求解器，例如 `numpy.linalg.lstsq` 函数。该函数在秩亏的情况下会按要求返回最小范数解。\n\n我们必须为每个提供的数据集执行两次独立的回归。\n\n首先，为了估计 $\\beta_{OH}$，我们考虑 $H$ 的模型：\n$$ H = \\beta_{OH} O + \\beta_{C_1H} C_1 + \\beta_{C_2H} C_2 + \\varepsilon_H $$\n这对应于一个线性回归问题，其中响应向量 $y_H$ 是 $H$ 的观测值集合。设计矩阵 $X_H$ 是将 $O$、$C_1$ 和 $C_2$ 的观测向量作为其列来构建的。\n$$ y_H = \\begin{pmatrix} H_1 \\\\ \\vdots \\\\ H_n \\end{pmatrix}, \\quad X_H = \\begin{pmatrix} O_1  C_{1,1}  C_{2,1} \\\\ \\vdots  \\vdots  \\vdots \\\\ O_n  C_{1,n}  C_{2,n} \\end{pmatrix} $$\n待估计的系数向量是 $\\beta_H = [\\beta_{OH}, \\beta_{C_1H}, \\beta_{C_2H}]^{\\top}$。通过使用最小二乘法求解线性系统 $X_H \\beta_H = y_H$，我们得到估计值 $\\hat{\\beta}_H$。所需参数的估计值 $\\widehat{\\beta}_{OH}$ 是向量 $\\hat{\\beta}_H$ 的第一个元素。\n\n其次，为了估计 $\\gamma_{OR}$，我们使用 $R$ 的模型：\n$$ R = \\gamma_{OR} O + \\gamma_{HR} H + \\gamma_{C_1R} C_1 + \\gamma_{C_2R} C_2 + \\varepsilon_R $$\n在这里，响应向量 $y_R$ 是 $R$ 的观测值集合。设计矩阵 $X_R$ 由 $O$、$H$、$C_1$ 和 $C_2$ 的观测向量构建而成。关键要注意，此回归中使用了 $H$ 的*测量*值作为预测变量，这与受控直接效应的识别策略是一致的。\n$$ y_R = \\begin{pmatrix} R_1 \\\\ \\vdots \\\\ R_n \\end{pmatrix}, \\quad X_R = \\begin{pmatrix} O_1  H_1  C_{1,1}  C_{2,1} \\\\ \\vdots  \\vdots  \\vdots  \\vdots \\\\ O_n  H_n  C_{1,n}  C_{2,n} \\end{pmatrix} $$\n系数向量是 $\\gamma_R = [\\gamma_{OR}, \\gamma_{HR}, \\gamma_{C_1R}, \\gamma_{C_2R}]^{\\top}$。通过最小二乘法求解系统 $X_R \\gamma_R = y_R$ 得到估计值 $\\hat{\\gamma}_R$。直接因果效应的估计值 $\\widehat{\\gamma}_{OR}$ 是 $\\hat{\\gamma}_R$ 的第一个元素。\n\n此过程将应用于提供的三种情况（A、B 和 C）中的每一种。得到的 $\\beta_{OH}$ 和 $\\gamma_{OR}$ 的估计值将被收集并四舍五入到三位小数。最终的实现将为所有测试用例自动化此过程，并按规定格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates causal effects from transcriptional data using OLS regression.\n\n    For each test case, the function performs two linear regressions without intercept:\n    1. Regresses H on (O, C1, C2) to find beta_OH.\n    2. Regresses R on (O, H, C1, C2) to find gamma_OR.\n\n    The results are formatted and printed as specified in the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.01, 0.39, 0.82, -0.02, 0.40, 0.81]),\n            'R': np.array([0.087, 0.613, 1.174, 0.146, 0.70, 1.247]),\n        },\n        {\n            'name': 'B',\n            'O': np.array([0.2, 0.6, 1.0, 0.4, 0.8, 1.2]),\n            'C1': np.array([0, 1, 2, 0, 1, 2]),\n            'C2': np.array([1, 1, 1, 2, 2, 2]),\n            'H': np.array([0.175, 0.505, 0.860, 0.330, 0.680, 1.025]),\n            'R': np.array([0.090, 0.454, 0.838, 0.164, 0.544, 0.920]),\n        },\n        {\n            'name': 'C',\n            'O': np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n            'C1': np.array([0, 1, 0, 1, 2]),\n            'C2': np.array([1, 0, 2, 1, 0]),\n            'H': np.array([-0.19, 0.34, -0.36, 0.17, 0.695]),\n            'R': np.array([0.05, 0.05, -0.05, -0.05, -0.05]),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Extract data for the current case\n        O, C1, C2, H, R = case['O'], case['C1'], case['C2'], case['H'], case['R']\n\n        # --- Regression 1: Estimate beta_OH ---\n        # Model: H = beta_OH*O + beta_C1H*C1 + beta_C2H*C2\n        # Design matrix X_H, response vector y_H = H\n        X_H = np.vstack([O, C1, C2]).T \n        \n        # Solve for coefficients using least squares.\n        # np.linalg.lstsq returns a tuple, the first element is the solution vector.\n        coeffs_H = np.linalg.lstsq(X_H, H, rcond=None)[0]\n        beta_OH = coeffs_H[0]\n\n        # --- Regression 2: Estimate gamma_OR ---\n        # Model: R = gamma_OR*O + gamma_HR*H + gamma_C1R*C1 + gamma_C2R*C2\n        # Design matrix X_R, response vector y_R = R\n        X_R = np.vstack([O, H, C1, C2]).T\n\n        # Solve for coefficients using least squares.\n        coeffs_R = np.linalg.lstsq(X_R, R, rcond=None)[0]\n        gamma_OR = coeffs_R[0]\n        \n        all_results.append((beta_OH, gamma_OR))\n\n    # Format the final output string exactly as required.\n    # Each number is formatted to three decimal places.\n    # The final string is a list of lists, e.g., [[bA,gA],[bB,gB],...].\n    results_str_list = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in all_results]\n    final_output = f\"[{','.join(results_str_list)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}