{
    "hands_on_practices": [
        {
            "introduction": "对细胞周期调控的深入理解，不仅在于掌握其核心分子和通路的概念，更在于具备构建和分析定量模型的能力。这些模型使我们能够预测细胞行为，并为复杂的生物医学问题（如癌症治疗）设计干预策略。本章的动手实践将引导您完成这一过程，从构建细胞周期引擎的基本模块开始，逐步扩展到复杂的检查点调控网络，并最终将其应用于解决实际的治疗问题。\n\n本练习关注细胞周期最核心的“引擎”之一：细胞周期蛋白（cyclin）的积累如何触发CDK介导的细胞周期时相转换。我们将推导出一个精确的数学表达式，计算出在特定时间内达到转换阈值所需的细胞周期蛋白合成速率。这个练习旨在巩固您对基本质量平衡动力学（mass-balance kinetics）和超敏开关（ultrasensitive switches）的理解，这些都是系统生物学中的基础概念。",
            "id": "4323668",
            "problem": "系统生物医学关于细胞周期的核心观点是，当细胞周期蛋白依赖性激酶 (CDK) 的活性超过一个由上游信号和网络超敏性决定的阈值时，细胞就会承诺进入下一个阶段（例如，G$_{1}$/S 检验点）。考虑一个简化的、充分混合的细胞周期蛋白合成与降解模块，该模块控制着 CDK 的活化。其中，细胞周期蛋白浓度 $X(t)$ 遵循一阶质量平衡动力学 $dX/dt = \\alpha - \\delta X$ 演化，其中 $\\alpha$ 表示恒定的合成速率，$\\delta$ 表示一阶降解速率。假设初始细胞周期蛋白水平为 $X(0) = X_{0}$，并且 CDK 活性是细胞周期蛋白的 Hill 型函数，由 $C(X) = \\dfrac{X^{n}}{K^{n} + X^{n}}$ 给出，其中 $K$ 是半活化常数，$n$ 是反映 CDK 活化协同性的 Hill 系数。\n\n当 CDK 活性达到目标阈值 $\\theta$（其中 $0  \\theta  1$）时，将触发检验点决策。请从线性质量平衡动力学和单调 Hill 活化的第一性原理出发，推导出所需的恒定细胞周期蛋白合成速率 $\\alpha$ 的精确闭式表达式，以确保在指定的决策时间 $T > 0$ 时满足 $C\\big(X(T)\\big) = \\theta$。该表达式应以 $\\delta$、$K$、$n$、$\\theta$、$T$ 和 $X_{0}$ 表示。假设 $\\delta > 0$、$K > 0$、$n > 0$ 且 $X_{0} \\ge 0$。\n\n将您的最终答案表示为 $\\alpha$ 的单个解析表达式，其物理单位为浓度/时间。无需进行数值计算。请勿在最终的方框答案中包含单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 细胞周期蛋白浓度 $X(t)$ 的演化由一阶线性常微分方程 (ODE) 控制：$\\frac{dX}{dt} = \\alpha - \\delta X$。\n- 细胞周期蛋白浓度的初始条件为 $X(0) = X_{0}$。\n- 合成速率 $\\alpha$ 是一个常数。\n- 一阶降解速率为 $\\delta$，且 $\\delta > 0$。\n- CDK 活性 $C(X)$ 是细胞周期蛋白浓度 $X$ 的 Hill 型函数：$C(X) = \\dfrac{X^{n}}{K^{n} + X^{n}}$。\n- 半活化常数为 $K$，且 $K > 0$。\n- Hill 系数为 $n$，且 $n > 0$。\n- 当 CDK 活性达到阈值 $\\theta$ 时触发检验点决策，其中 $0  \\theta  1$。\n- 决策在指定的时刻 $T > 0$ 做出，使得 $C\\big(X(T)\\big) = \\theta$。\n- 初始细胞周期蛋白水平满足 $X_{0} \\ge 0$。\n- 目标是推导合成速率 $\\alpha$ 的闭式表达式，用 $\\delta$、$K$、$n$、$\\theta$、$T$ 和 $X_{0}$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题使用了系统生物学中一个标准且成熟的数学模型。微分方程 $\\frac{dX}{dt} = \\alpha - \\delta X$ 代表了一个基本的生灭过程（零阶生成，一阶降解），而 Hill 函数是用于描述生化网络中超敏反应和协同结合的经典模型。这些都是该领域的基本工具。\n- **适定性：** 这是一个适定的问题。它要求找到一个参数 $\\alpha$，在给定时间满足特定条件。这涉及到求解一个线性常微分方程（在给定初始条件下有唯一解），然后求解一个代数方程。将 CDK 活性与细胞周期蛋白浓度联系起来的函数是单调的，确保了对于给定的活性水平，存在唯一的目标浓度。随后的关于 $\\alpha$ 的方程是线性的，保证了唯一解的存在。\n- **客观性：** 该问题使用精确的数学定义和客观的语言陈述，没有歧义或主观论断。\n- **其他缺陷：**\n  - 问题是自洽且内部一致的。\n  - 参数和条件（例如 $\\delta > 0$、$T > 0$、$0  \\theta  1$）在物理上和数学上都是合理的。\n  - 问题并非无足轻重，需要一系列逻辑严密的数学步骤来解决。\n\n### 步骤 3：结论与行动\n问题有效。将推导一个完整的解。\n\n解题策略包括三个主要步骤：\n1.  确定在时间 $T$ 满足检验点条件 $C(X_T) = \\theta$ 的目标细胞周期蛋白浓度，记为 $X_T$。\n2.  求解关于 $X(t)$ 的线性常微分方程，找到细胞周期蛋白浓度作为时间函数的通用表达式，其中包含未知参数 $\\alpha$。\n3.  在步骤 2 的解中令 $t=T$，将其等同于步骤 1 中找到的目标浓度 $X_T$，然后求解得到的关于 $\\alpha$ 的代数方程。\n\n首先，我们确定目标细胞周期蛋白浓度，记为 $X(T)$。条件由下式给出：\n$$C\\big(X(T)\\big) = \\frac{X(T)^n}{K^n + X(T)^n} = \\theta$$\n我们求解这个关于 $X(T)$ 的代数方程：\n$$X(T)^n = \\theta (K^n + X(T)^n)$$\n$$X(T)^n = \\theta K^n + \\theta X(T)^n$$\n$$X(T)^n - \\theta X(T)^n = \\theta K^n$$\n$$X(T)^n (1 - \\theta) = \\theta K^n$$\n$$X(T)^n = \\frac{\\theta}{1 - \\theta} K^n$$\n由于 $n > 0$，我们可以对两边取 $n$ 次根。因为 $0  \\theta  1$，所以项 $\\frac{\\theta}{1-\\theta}$ 是正的，确保了 $X(T)$ 有一个实数正解。\n$$X(T) = \\left( \\frac{\\theta}{1 - \\theta} \\right)^{\\frac{1}{n}} K$$\n\n接下来，我们求解关于 $X(t)$ 的一阶线性常微分方程：\n$$\\frac{dX}{dt} = \\alpha - \\delta X$$\n这可以改写为标准形式 $\\frac{dX}{dt} + \\delta X = \\alpha$。\n积分因子为 $I(t) = \\exp\\left(\\int \\delta \\, dt\\right) = \\exp(\\delta t)$。\n将常微分方程两边乘以积分因子：\n$$\\exp(\\delta t) \\frac{dX}{dt} + \\delta \\exp(\\delta t) X = \\alpha \\exp(\\delta t)$$\n左边是乘积 $X(t) \\exp(\\delta t)$ 的导数：\n$$\\frac{d}{dt} \\left( X(t) \\exp(\\delta t) \\right) = \\alpha \\exp(\\delta t)$$\n对两边关于 $t$ 积分：\n$$X(t) \\exp(\\delta t) = \\int \\alpha \\exp(\\delta t) \\, dt = \\frac{\\alpha}{\\delta} \\exp(\\delta t) + C_{int}$$\n其中 $C_{int}$ 是积分常数。\n求解 $X(t)$ 得到通解：\n$$X(t) = \\frac{\\alpha}{\\delta} + C_{int} \\exp(-\\delta t)$$\n我们使用初始条件 $X(0) = X_0$ 来确定 $C_{int}$：\n$$X(0) = X_0 = \\frac{\\alpha}{\\delta} + C_{int} \\exp(0) = \\frac{\\alpha}{\\delta} + C_{int}$$\n因此，积分常数为 $C_{int} = X_0 - \\frac{\\alpha}{\\delta}$。\n将此代入 $X(t)$ 的通解中，得到特解：\n$$X(t) = \\frac{\\alpha}{\\delta} + \\left(X_0 - \\frac{\\alpha}{\\delta}\\right) \\exp(-\\delta t)$$\n\n最后，我们将时间 $T$ 所需的浓度与常微分方程解在时间 $T$ 给出的浓度相等。\n$$X(T) = \\left( \\frac{\\theta}{1 - \\theta} \\right)^{\\frac{1}{n}} K = \\frac{\\alpha}{\\delta} + \\left(X_0 - \\frac{\\alpha}{\\delta}\\right) \\exp(-\\delta T)$$\n现在我们必须求解合成速率 $\\alpha$。让我们重新整理方程以分离含有 $\\alpha$ 的项：\n$$\\left( \\frac{\\theta}{1 - \\theta} \\right)^{\\frac{1}{n}} K = \\frac{\\alpha}{\\delta} + X_0 \\exp(-\\delta T) - \\frac{\\alpha}{\\delta} \\exp(-\\delta T)$$\n$$\\left( \\frac{\\theta}{1 - \\theta} \\right)^{\\frac{1}{n}} K - X_0 \\exp(-\\delta T) = \\frac{\\alpha}{\\delta} \\left(1 - \\exp(-\\delta T)\\right)$$\n求解 $\\alpha$：\n$$\\alpha = \\frac{\\delta}{1 - \\exp(-\\delta T)} \\left( K \\left( \\frac{\\theta}{1 - \\theta} \\right)^{\\frac{1}{n}} - X_0 \\exp(-\\delta T) \\right)$$\n该表达式给出了在给定的系统参数和初始条件下，为在精确指定的时间 $T$ 达到 CDK 活性阈值 $\\theta$ 所需的恒定细胞周期蛋白合成速率 $\\alpha$。单位是一致的：$\\delta$ 的单位是 $1/\\text{时间}$，而括号中的项的单位是浓度，因此 $\\alpha$ 的单位是浓度/时间。",
            "answer": "$$\\boxed{\\frac{\\delta}{1 - \\exp(-\\delta T)} \\left( K \\left( \\frac{\\theta}{1 - \\theta} \\right)^{\\frac{1}{n}} - X_{0} \\exp(-\\delta T) \\right)}$$"
        },
        {
            "introduction": "在细胞周期进程的基础模型之上，本练习引入了一个关键的调控层：DNA损伤检查点。我们将通过对Chk1-Cdc25-CDK信号级联通路的建模，来预测DNA损伤后细胞周期停滞的持续时间。这个问题展示了定量模型如何将分子层面的动力学（如蛋白质磷酸化和降解）与细胞层面的表型（如周期停滞的时长）联系起来。",
            "id": "4323627",
            "problem": "DNA损伤诱导的细胞周期阻滞的一个核心特征是从检查点激酶1 (Checkpoint kinase 1, Chk1) 到细胞分裂周期蛋白25 (Cell division cycle 25, Cdc25) 的信号转导，这会降低细胞周期蛋白依赖性激酶 (Cyclin-dependent kinase, CDK) 的活性，并延长S期或G2期阻滞。当DNA损伤发生时，Chk1会磷酸化Cdc25，促进14-3-3蛋白的结合以及Cdc25的核输出或隔离，从而降低其对CDK上抑制性磷酸化位点的磷酸酶活性。在没有持续损伤信号的情况下，由于去磷酸化和蛋白水解机制，Chk1的活性会随时间衰减。考虑一个基于以下假设和测量的系统生物医学描述：\n\n- Chk1的活性，记为 $A(t)$，在损伤响应峰值后呈指数衰减，即 $A(t) = A_{0} \\exp(-k_{d} t)$，测得其半衰期为 $t_{1/2} = 1.5$ h，初始活性为 $A_{0} = 3.0$ 任意单位 (a.u.)。\n- Cdc25的抑制性磷酸化遵循质量作用动力学，其磷酸化速率常数为每个单位Chk1活性的 $k_{p}$，以及一个组成性去磷酸化速率常数 $k_{u}$，两者的时间尺度均为小时。在Chk1衰减的时间尺度上，假设Cdc25的磷酸化状态处于准稳态，因此Cdc25的抑制分数为 $f_{i}(t) = \\dfrac{k_{p} A(t)}{k_{p} A(t) + k_{u}}$，活性分数为 $f_{a}(t) = \\dfrac{k_{u}}{k_{p} A(t) + k_{u}}$。使用 $k_{p} = 0.6$ h$^{-1}$ a.u.$^{-1}$ 和 $k_{u} = 0.3$ h$^{-1}$。\n- 由于CDK-Cdc25-Wee1模块中的正反馈，Cdc25对CDK的激活是协同的。将无量纲的CDK活性建模为活性Cdc25分数的希尔函数：$\\dfrac{V_{\\text{CDK}}(t)}{V_{\\max}} = \\dfrac{f_{a}(t)^{n}}{f_{a}(t)^{n} + K^{n}}$，其中希尔系数 $n = 4$，半饱和参数 $K = 0.35$ (无量纲)。\n- 当CDK活性相对于 $V_{\\max}$ 超过一个固定阈值 $\\theta$ 时，S期或G2期阻滞结束，其中 $\\theta = 0.8$。\n\n基于这些前提和定义，通过确定时间 $t$，使得 $\\dfrac{V_{\\text{CDK}}(t)}{V_{\\max}}$ 首次等于 $\\theta$，来推导阻滞持续时间 $t^{\\ast}$。给定测量的Chk1衰减动力学以及上述质量作用和希尔函数关系。最终时间以小时为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取给定条件\n- Chk1 活性衰减函数：$A(t) = A_{0} \\exp(-k_{d} t)$\n- Chk1 活性半衰期：$t_{1/2} = 1.5$ h\n- 初始 Chk1 活性：$A_{0} = 3.0$ a.u.\n- Cdc25 的抑制分数：$f_{i}(t) = \\dfrac{k_{p} A(t)}{k_{p} A(t) + k_{u}}$\n- Cdc25 的活性分数：$f_{a}(t) = \\dfrac{k_{u}}{k_{p} A(t) + k_{u}}$\n- 磷酸化速率常数：$k_{p} = 0.6$ h$^{-1}$ a.u.$^{-1}$\n- 去磷酸化速率常数：$k_{u} = 0.3$ h$^{-1}$\n- 无量纲 CDK 活性函数：$\\dfrac{V_{\\text{CDK}}(t)}{V_{\\max}} = \\dfrac{f_{a}(t)^{n}}{f_{a}(t)^{n} + K^{n}}$\n- 希尔系数：$n = 4$\n- 半饱和参数：$K = 0.35$ (无量纲)\n- 阻滞解除的 CDK 活性阈值：$\\theta = 0.8$\n- 任务是求出阻滞持续时间 $t^{\\ast}$。\n\n### 步骤 2：使用提取的给定条件进行验证\n根据已建立的验证标准对问题进行评估。\n- **科学依据：** 该问题描述了Chk1-Cdc25-CDK信号通路的简化数学模型，该通路是G2/M期DNA损伤检查点的基石。使用指数衰减来描述蛋白质活性，使用准稳态质量作用动力学来描述磷酸化/去磷酸化，以及使用希尔函数来模拟协同生化激活，这些都是系统生物学和系统生物医学中标准且广为接受的技术。这些前提在科学上是合理的。\n- **问题明确：** 该问题提供了一个明确的目标：计算阻滞持续时间 $t^{\\ast}$。所有必要的函数形式、参数和常数（$A_0$、$t_{1/2}$、$k_p$、$k_u$、$n$、$K$、$\\theta$）都已明确提供。将 $t^{\\ast}$ 定义为CDK活性越过特定阈值的时间，这使得可以建立一个可解的方程。该问题是自洽的，其结构可以得到一个唯一的、有意义的解。\n- **客观性：** 该问题使用精确、定量和无偏见的语言陈述。没有主观或基于意见的元素。参数给出了指定的单位（或为无量纲），并且模型是形式化定义的。\n\n该问题没有表现出验证标准中列出的任何缺陷（例如，科学上不合理、不完整、模棱两可）。这是一个基于已确立的生物物理建模原则的形式化、定量问题。\n\n### 步骤 3：结论与行动\n该问题是有效的。现在将推导完整的解。\n\n目标是确定阻滞持续时间 $t^{\\ast}$，即相对CDK活性 $\\dfrac{V_{\\text{CDK}}(t)}{V_{\\max}}$ 首次达到阈值 $\\theta$ 的时间。我们首先建立定义此条件的方程：\n$$\n\\dfrac{V_{\\text{CDK}}(t^{\\ast})}{V_{\\max}} = \\theta\n$$\n我们已知CDK活性的希尔函数模型。将其代入我们的条件中，得到：\n$$\n\\dfrac{f_{a}(t^{\\ast})^{n}}{f_{a}(t^{\\ast})^{n} + K^{n}} = \\theta\n$$\n我们的第一步是求解此方程，得到阻滞解除时刻的Cdc25活性分数 $f_{a}(t^{\\ast})$。\n$$\nf_{a}(t^{\\ast})^{n} = \\theta (f_{a}(t^{\\ast})^{n} + K^{n})\n$$\n$$\nf_{a}(t^{\\ast})^{n} = \\theta f_{a}(t^{\\ast})^{n} + \\theta K^{n}\n$$\n$$\nf_{a}(t^{\\ast})^{n} (1 - \\theta) = \\theta K^{n}\n$$\n$$\nf_{a}(t^{\\ast})^{n} = \\dfrac{\\theta K^{n}}{1 - \\theta}\n$$\n对两边取 $n$ 次方根，我们得到所需的Cdc25活性分数：\n$$\nf_{a}(t^{\\ast}) = K \\left( \\dfrac{\\theta}{1 - \\theta} \\right)^{1/n}\n$$\n接下来，我们使用所提供的 $f_{a}(t)$ 的准稳态表达式，将Cdc25的这个活性分数与Chk1的活性 $A(t^{\\ast})$ 联系起来：\n$$\nf_{a}(t^{\\ast}) = \\dfrac{k_{u}}{k_{p} A(t^{\\ast}) + k_{u}}\n$$\n我们重排这个方程以求解 $A(t^{\\ast})$：\n$$\nk_{p} A(t^{\\ast}) + k_{u} = \\dfrac{k_{u}}{f_{a}(t^{\\ast})}\n$$\n$$\nk_{p} A(t^{\\ast}) = \\dfrac{k_{u}}{f_{a}(t^{\\ast})} - k_{u} = k_{u} \\left( \\dfrac{1 - f_{a}(t^{\\ast})}{f_{a}(t^{\\ast})} \\right)\n$$\n$$\nA(t^{\\ast}) = \\dfrac{k_{u}}{k_{p}} \\left( \\dfrac{1 - f_{a}(t^{\\ast})}{f_{a}(t^{\\ast})} \\right)\n$$\n现在，我们使用Chk1活性指数衰减的模型 $A(t) = A_{0} \\exp(-k_{d} t)$。首先，我们必须根据给定的半衰期 $t_{1/2}$ 来确定衰减常数 $k_d$。根据半衰期的定义，$A(t_{1/2}) = A_0/2$。\n$$\nA_0 \\exp(-k_d t_{1/2}) = \\frac{A_0}{2}\n$$\n$$\n\\exp(-k_d t_{1/2}) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-k_d t_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\nk_d = \\dfrac{\\ln(2)}{t_{1/2}}\n$$\n最后，我们将来自Chk1衰减模型的 $A(t^{\\ast})$ 表达式与我们从Cdc25平衡中推导出的表达式相等：\n$$\nA_{0} \\exp(-k_{d} t^{\\ast}) = \\dfrac{k_u}{k_p} \\left( \\dfrac{1 - f_{a}(t^{\\ast})}{f_{a}(t^{\\ast})} \\right)\n$$\n我们求解 $t^{\\ast}$：\n$$\n\\exp(-k_{d} t^{\\ast}) = \\dfrac{k_u}{A_0 k_p} \\left( \\dfrac{1 - f_{a}(t^{\\ast})}{f_{a}(t^{\\ast})} \\right)\n$$\n$$\n-k_d t^{\\ast} = \\ln\\left( \\dfrac{k_u}{A_0 k_p} \\left( \\dfrac{1 - f_{a}(t^{\\ast})}{f_{a}(t^{\\ast})} \\right) \\right)\n$$\n$$\nt^{\\ast} = -\\dfrac{1}{k_d} \\ln\\left( \\dfrac{k_u}{A_0 k_p} \\left( \\dfrac{1-f_{a}(t^{\\ast})}{f_{a}(t^{\\ast})} \\right) \\right) = \\dfrac{1}{k_d} \\ln\\left( \\dfrac{A_0 k_p}{k_u} \\left( \\dfrac{f_{a}(t^{\\ast})}{1-f_{a}(t^{\\ast})} \\right) \\right)\n$$\n代入 $k_d$ 和 $f_a(t^*)$ 的表达式：\n$$\nt^{\\ast} = \\dfrac{t_{1/2}}{\\ln(2)} \\ln\\left( \\dfrac{A_0 k_p}{k_u} \\dfrac{K \\left( \\frac{\\theta}{1 - \\theta} \\right)^{1/n}}{1 - K \\left( \\frac{\\theta}{1 - \\theta} \\right)^{1/n}} \\right)\n$$\n我们现在代入给定的数值：$t_{1/2} = 1.5$ h, $A_0 = 3.0$ a.u., $k_p = 0.6$ h$^{-1}$ a.u.$^{-1}$, $k_u = 0.3$ h$^{-1}$, $n = 4$, $K = 0.35$ 和 $\\theta = 0.8$。\n\n首先，计算所需的Cdc25活性分数 $f_{a}(t^{\\ast})$：\n$$\nf_{a}(t^{\\ast}) = 0.35 \\left( \\dfrac{0.8}{1 - 0.8} \\right)^{1/4} = 0.35 \\left( \\dfrac{0.8}{0.2} \\right)^{1/4} = 0.35 \\times (4)^{1/4} = 0.35 \\times \\sqrt{2}\n$$\n$f_{a}(t^{\\ast}) \\approx 0.35 \\times 1.41421356 \\approx 0.49497475$\n\n接下来，计算 $t^{\\ast}$ 表达式中对数的参数：\n$$\n\\dfrac{A_0 k_p}{k_u} = \\dfrac{3.0 \\times 0.6}{0.3} = \\dfrac{1.8}{0.3} = 6.0\n$$\n$$\n\\dfrac{f_{a}(t^{\\ast})}{1-f_{a}(t^{\\ast})} = \\dfrac{0.49497475}{1 - 0.49497475} = \\dfrac{0.49497475}{0.50502525} \\approx 0.98010\n$$\n完整的参数是：$6.0 \\times 0.98010 = 5.8806$。\n为了精确，让我们使用精确表达式重新计算：\n$$\n\\dfrac{f_{a}(t^{\\ast})}{1-f_{a}(t^{\\ast})} = \\dfrac{0.35\\sqrt{2}}{1-0.35\\sqrt{2}}\n$$\n对数的参数：\n$$\n\\dfrac{A_0 k_p}{k_u} \\dfrac{f_{a}(t^{\\ast})}{1-f_{a}(t^{\\ast})} = 6.0 \\times \\dfrac{0.35\\sqrt{2}}{1-0.35\\sqrt{2}} = \\dfrac{2.1\\sqrt{2}}{1-0.35\\sqrt{2}}\n$$\n$$\n\\approx \\dfrac{2.1 \\times 1.41421356}{1 - 0.35 \\times 1.41421356} = \\dfrac{2.96984848}{1 - 0.49497475} = \\dfrac{2.96984848}{0.50502525} \\approx 5.88053\n$$\n现在，将此代入 $t^{\\ast}$ 的方程中：\n$$\nt^{\\ast} = \\dfrac{1.5}{\\ln(2)} \\ln(5.88053) \\approx \\dfrac{1.5}{0.693147} \\times 1.77168 \\approx 2.16404 \\times 1.77168 \\approx 3.83415 \\text{ h}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nt^{\\ast} \\approx 3.834 \\text{ h}\n$$",
            "answer": "$$\n\\boxed{3.834}\n$$"
        },
        {
            "introduction": "最后的实践将我们对检查点调控的理解带入药物治疗领域。通过结合药代动力学（药物在体内的过程）和药效动力学（药物对细胞的影响）模型，我们将设计一个程序来寻找Chk1抑制剂的最佳给药方案。这项练习弥合了细胞周期基础模型与其实际应用于癌症治疗之间的鸿沟，这正是系统生物医学的一个核心目标。",
            "id": "4323643",
            "problem": "设计一个程序，计算一种检验点激酶1 (Chk1) 抑制剂的最佳离散时间给药方案，该方案旨在固定的治疗周期内，在最大化肿瘤细胞杀伤的同时，最小化正常细胞中由复制压力引发的致死效应。该程序必须实现一个基于核心原理和定义的药代动力学-药效动力学检验点模型。模型组件定义如下。\n\n从以下基本依据出发。\n\n1. 具有一级消除的单室药代动力学模型：如果 $C(t)$ 是药物浓度，则\n$$\\frac{dC(t)}{dt}=-k_{\\mathrm{e}}\\,C(t)+\\sum_{j} D_{j}\\,\\delta(t-t_{j})/V,$$\n其中 $k_{\\mathrm{e}}$ 是消除速率常数，$D_{j}$ 是在时间 $t_{j}$ 的瞬时推注剂量，$V$ 是分布容积，$\\delta(\\cdot)$ 是狄拉克δ分布。假设 $V=1$，因此剂量 $D_{j}$ 会使 $C$ 瞬时增加 $D_{j}$。\n\n2. 通过经过充分检验的药效学公式——Hill型抑制函数来描述靶点结合：瞬时Chk1抑制分数为\n$$I(t)=\\frac{C(t)^{h}}{EC_{50}^{\\,h}+C(t)^{h}},$$\n其中 $EC_{50}$ 是达到半数最大抑制效应时的浓度，$h$ 是Hill系数。\n\n3. 基于风险的生存力动态学，作为一种基于一级损失的唯象生存模型：令 $V_{\\mathrm{T}}(t)$ 和 $V_{\\mathrm{N}}(t)$ 分别为肿瘤细胞和正常细胞的生存力。假设\n$$\\frac{dV_{\\mathrm{T}}(t)}{dt}=-k_{\\mathrm{T}}\\,S_{\\mathrm{T}}\\,I(t)\\,V_{\\mathrm{T}}(t),\\qquad \\frac{dV_{\\mathrm{N}}(t)}{dt}=-k_{\\mathrm{N}}\\,S_{\\mathrm{N}}\\,I(t)\\,V_{\\mathrm{N}}(t),$$\n其中 $k_{\\mathrm{T}}$ 和 $k_{\\mathrm{N}}$ 是风险率系数，$S_{\\mathrm{T}}$ 和 $S_{\\mathrm{N}}$ 是敏感性乘数，分别反映肿瘤细胞和正常细胞对复制压力的依赖性和检验点依赖性。初始条件为 $V_{\\mathrm{T}}(0)=1$ 和 $V_{\\mathrm{N}}(0)=1$。\n\n4. 用于权衡肿瘤细胞杀伤与正常细胞中由复制压力致死效应的目标泛函：\n$$J=\\left(1-V_{\\mathrm{T}}(T)\\right)-\\lambda\\,\\left(1-V_{\\mathrm{N}}(T)\\right),$$\n其中 $T$ 是固定的治疗周期，$\\lambda \\ge 0$ 是一个惩罚权重。\n\n离散化与控制参数化。\n\n- 在时间步长为 $\\Delta t$（单位：小时）的均匀网格上演化系统，使用算子分裂更新方法，在每个网格点 $t_{n}$ 处，首先，如果 $t_{n}=t_{j}$，则施加任何计划的推注剂量 $D_j$；然后计算抑制作用 $I(t_{n})$；接着通过风险模型以乘法方式更新生存力；最后通过一级消除更新在 $\\Delta t$ 时间段内的药物浓度：\n$$\n\\begin{aligned}\n\\text{若 } t_{n}\\in\\{t_{j}\\}\\text{ 则 }C \\leftarrow C+D(t_{n}), \\\\\nI \\leftarrow \\frac{C^{h}}{EC_{50}^{\\,h}+C^{h}}, \\\\\nV_{\\mathrm{T}} \\leftarrow V_{\\mathrm{T}}\\cdot \\exp\\left(-k_{\\mathrm{T}}\\,S_{\\mathrm{T}}\\,I\\,\\Delta t\\right), \\quad V_{\\mathrm{N}} \\leftarrow V_{\\mathrm{N}}\\cdot \\exp\\left(-k_{\\mathrm{N}}\\,S_{\\mathrm{N}}\\,I\\,\\Delta t\\right), \\\\\nC \\leftarrow C\\cdot \\exp\\left(-k_{\\mathrm{e}}\\,\\Delta t\\right).\n\\end{aligned}\n$$\n- 消除速率常数为 $k_{\\mathrm{e}}=\\ln(2)/t_{1/2}$，其中 $t_{1/2}$ 是消除半衰期（单位：小时）。\n- 给药被限制在一组固定的、等间距的给药时间点 $\\{t_{0},t_{1},\\dots,t_{M-1}\\}$ 上，在治疗周期 $[0,T]$ 内的时间间隔为 $\\Delta t_{\\mathrm{slot}}$（单位：小时）。在每个时间点，允许的剂量来自一个有限的离散集合 $\\{0,\\delta,2\\delta,\\dots,D_{\\max}\\}$，其中 $\\delta$ 是每个时间点的剂量增量，$D_{\\max}$ 是每个时间点的最大剂量。总累积剂量约束为 $\\sum_{j} D_{j}\\le D_{\\mathrm{tot}}^{\\max}$。\n- 单位：时间单位为小时，浓度单位为微摩尔，剂量单位为微摩尔，使得当 $V=1$ 时，剂量 $D_{j}$ 会使浓度 $C$ 瞬时增加 $D_{j}$ 微摩尔。\n\n优化问题。\n\n- 在满足每个时间点和总剂量约束的可行剂量向量 $\\mathbf{D}=[D_{0},\\dots,D_{M-1}]$ 的组合集合中，选择使上述定义的 $J$ 最大化的 $\\mathbf{D}$。\n- 结果相同时按如下规则处理：如果两个方案的 $|J_{1}-J_{2}|  \\varepsilon$ 且 $\\varepsilon=10^{-9}$，优先选择肿瘤杀伤效果 $\\left(1-V_{\\mathrm{T}}(T)\\right)$ 更大的方案；如果在此条件下仍在 $\\varepsilon$ 范围内相同，则选择剂量向量字典序最小的方案（升序比较）。\n\n数值输出要求。\n\n- 对于每个测试用例，您的程序必须输出一个包含四个元素的列表：最优剂量向量 $\\mathbf{D}$（一个浮点数列表）、最优目标值 $J$（浮点数）、肿瘤杀伤率 $\\left(1-V_{\\mathrm{T}}(T)\\right)$（浮点数）和正常细胞杀伤率 $\\left(1-V_{\\mathrm{N}}(T)\\right)$（浮点数）。\n- 剂量以微摩尔表示，时间以小时表示，所有报告的浮点数均需精确到小数点后 $4$ 位。肿瘤和正常细胞杀伤率是无量纲分数，必须以小数形式报告（而非百分比）。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的逗号分隔列表，每个测试用例的结果本身也是一个列表。例如，输出格式为 \"[[case1_result],[case2_result],[case3_result]]\"，不含空格。\n\n测试套件。\n\n为以下三个测试用例实现并求解该优化问题，每个案例由 $(t_{1/2},EC_{50},h,k_{\\mathrm{T}},S_{\\mathrm{T}},k_{\\mathrm{N}},S_{\\mathrm{N}},\\lambda,T,\\Delta t,\\Delta t_{\\mathrm{slot}},\\delta,D_{\\max},D_{\\mathrm{tot}}^{\\max})$ 和给药时间点集合指定：\n\n- 案例 $1$（理想路径）：$(t_{1/2}=\\,$$8$$,EC_{50}=\\,$$1.0$$,h=\\,$$2$$,k_{\\mathrm{T}}=\\,$$0.08$$,S_{\\mathrm{T}}=\\,$$1.5$$,k_{\\mathrm{N}}=\\,$$0.05$$,S_{\\mathrm{N}}=\\,$$0.6$$,\\lambda=\\,$$0.6$$,T=\\,$$72$$,\\Delta t=\\,$$0.5$$,\\Delta t_{\\mathrm{slot}}=\\,$$24$$,\\delta=\\,$$0.5$$,D_{\\max}=\\,$$2.0$$,D_{\\mathrm{tot}}^{\\max}=\\,$$4.0$$)$，给药时间点为 $t\\in\\{\\,0,\\,24,\\,48\\,\\}$。\n- 案例 $2$（边界情况，具有强烈的正常细胞惩罚）：$(t_{1/2}=\\,$$8$$,EC_{50}=\\,$$0.8$$,h=\\,$$2$$,k_{\\mathrm{T}}=\\,$$0.06$$,S_{\\mathrm{T}}=\\,$$1.2$$,k_{\\mathrm{N}}=\\,$$0.05$$,S_{\\mathrm{N}}=\\,$$0.9$$,\\lambda=\\,$$3.0$$,T=\\,$$48$$,\\Delta t=\\,$$0.5$$,\\Delta t_{\\mathrm{slot}}=\\,$$24$$,\\delta=\\,$$0.5$$,D_{\\max}=\\,$$2.0$$,D_{\\mathrm{tot}}^{\\max}=\\,$$3.0$$)$，给药时间点为 $t\\in\\{\\,0,\\,24\\,\\}$。\n- 案例 $3$（边缘情况，高清除率和更频繁的给药点）：$(t_{1/2}=\\,$$3$$,EC_{50}=\\,$$1.2$$,h=\\,$$2$$,k_{\\mathrm{T}}=\\,$$0.10$$,S_{\\mathrm{T}}=\\,$$1.3$$,k_{\\mathrm{N}}=\\,$$0.06$$,S_{\\mathrm{N}}=\\,$$0.7$$,\\lambda=\\,$$0.5$$,T=\\,$$60$$,\\Delta t=\\,$$0.25$$,\\Delta t_{\\mathrm{slot}}=\\,$$12$$,\\delta=\\,$$0.5$$,D_{\\max}=\\,$$1.5$$,D_{\\mathrm{tot}}^{\\max}=\\,$$3.0$$)$，给药时间点为 $t\\in\\{\\,0,\\,12,\\,24,\\,36,\\,48\\,\\}$。\n\n算法要求。\n\n- 对每个案例，从离散集合中枚举所有满足 $\\sum_{j} D_{j}\\le D_{\\mathrm{tot}}^{\\max}$ 的可行剂量向量，模拟系统以计算 $J$，并根据平局打破规则选择最优方案。\n- 使用上述指定的离散更新方案。使用 $k_{\\mathrm{e}}=\\ln(2)/t_{1/2}$。\n- 最终打印的行必须是一个表示三个案例结果列表的单字符串，不含额外文本或空白字符。所有浮点数必须精确到小数点后 $4$ 位。",
            "solution": "该问题要求设计一个程序，通过解决一个组合优化问题来找到最佳的药物给药方案。鉴于测试用例中给药方案的搜索空间是离散且有限的，可以通过穷举搜索（或称暴力枚举）来找到全局最优解。解决方案的逻辑遵循三个主要步骤：生成所有可行的给药方案，为每个方案模拟系统动态，并根据预设的目标函数和决胜规则选择最佳方案。\n\n**1. 生成可行的给药方案**\n此步骤的目标是构建一个包含所有待评估的剂量向量的集合。\n- 首先，确定在单个给药时间点上所有可能的剂量值，即从0到$D_{\\max}$，以$\\delta$为增量的离散集合。\n- 接着，使用组合学方法（如笛卡尔积，在Python中可通过`itertools.product`实现）生成所有可能的剂量向量$\\mathbf{D}$。每个向量的长度等于给药时间点的数量。\n- 最后，遍历所有生成的剂量向量，并筛选出那些满足总剂量约束（即$\\sum D_j \\le D_{\\mathrm{tot}}^{\\max}$）的向量。这个子集就是所有需要模拟的可行方案。\n\n**2. 模拟系统动态**\n对于每个可行的给药方案，需要运行一个前向模拟来计算其对肿瘤和正常细胞生存力的最终影响。\n- 模拟的准备工作包括：计算药物消除速率常数$k_e = \\ln(2)/t_{1/2}$，并建立一个从模拟时间步到给药剂量的映射。\n- 模拟的核心是一个循环，该循环在从$t=0$到$t=T$的时间网格上，以步长$\\Delta t$推进系统状态 $(C, V_{\\mathrm{T}}, V_{\\mathrm{N}})$。初始状态为 $(0, 1, 1)$。\n- 在每个时间步，严格按照问题中定义的算子分裂方法更新状态：\n    1.  **给药**：将当前时间点计划的任何剂量加入到药物浓度$C$中。\n    2.  **抑制计算**：使用给药后的浓度$C$和Hill方程计算瞬时抑制水平$I$。\n    3.  **生存力更新**：根据指数衰减模型更新肿瘤和正常细胞的生存力$V_{\\mathrm{T}}$和$V_{\\mathrm{N}}$。这个乘法更新是相应的一阶微分方程在时间段$\\Delta t$上的精确解。\n    4.  **药物消除**：同样，使用指数衰减的精确解来更新药物浓度$C$，以反映在一个时间步长$\\Delta t$内的清除。\n\n**3. 优化与决胜**\n在所有方案都模拟完毕后，根据目标函数$J$和决胜规则来确定最优方案。\n- 对每个方案，利用模拟得到的最终生存力$V_{\\mathrm{T}}(T)$和$V_{\\mathrm{N}}(T)$，计算出其对应的肿瘤杀伤率$TK = 1 - V_{\\mathrm{T}}(T)$，正常细胞杀伤率$NK = 1 - V_{\\mathrm{N}}(T)$，以及最终的目标函数值$J = TK - \\lambda \\cdot NK$。\n- 遍历所有方案的结果，同时维护一个“当前最佳”方案的记录。根据以下层次化标准进行比较和更新：\n    a) 首先，选择$J$值最高的方案。\n    b) 如果$J$值在极小的容差$\\varepsilon$内相同，则选择$TK$值更高的方案。\n    c) 如果$J$和$TK$值均在容差$\\varepsilon$内相同，则选择剂量向量在字典序上最小的方案。\n- 这个过程确保了最终选出的方案是唯一的，并且严格符合问题的所有优化要求。最终结果根据指定的格式（浮点数精度、列表结构）进行输出。\n\n下面提供的Python代码实现了这一完整的算法逻辑。",
            "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Main function to solve the Chk1 inhibitor dosing optimization problem\n    for the specified test cases.\n    \"\"\"\n    # Define test cases as per the problem statement\n    # Format: (t_1/2, EC50, h, k_T, S_T, k_N, S_N, lambda, T, dt, dt_slot, delta, D_max, D_tot_max, slots)\n    test_cases = [\n        (8, 1.0, 2, 0.08, 1.5, 0.05, 0.6, 0.6, 72, 0.5, 24, 0.5, 2.0, 4.0, [0, 24, 48]),\n        (8, 0.8, 2, 0.06, 1.2, 0.05, 0.9, 3.0, 48, 0.5, 24, 0.5, 2.0, 3.0, [0, 24]),\n        (3, 1.2, 2, 0.10, 1.3, 0.06, 0.7, 0.5, 60, 0.25, 12, 0.5, 1.5, 3.0, [0, 12, 24, 36, 48])\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        t_half, ec50, h, k_T, s_T, k_N, s_N, lam, T, dt, dt_slot, delta, d_max, d_tot_max, slots = case\n        \n        # --- 1. Generate Admissible Dose Schedules ---\n        \n        possible_doses = np.arange(0, d_max + 1e-9, delta)\n        num_slots = len(slots)\n        \n        admissible_schedules = []\n        # Generate all combinations of doses for the available slots\n        for schedule in itertools.product(possible_doses, repeat=num_slots):\n            # Check the total dose constraint\n            if np.sum(schedule) = d_tot_max + 1e-9:\n                admissible_schedules.append(list(schedule))\n\n        # --- 2. Find Optimal Schedule by Simulation and Comparison ---\n\n        best_schedule = None\n        best_J = -np.inf\n        best_tumor_kill = -np.inf\n        best_normal_kill = -np.inf\n        epsilon = 1e-9\n\n        # Derived parameters for simulation\n        k_e = np.log(2) / t_half\n        num_steps = int(T / dt)\n\n        for schedule in admissible_schedules:\n            # Create a dictionary mapping simulation steps to doses\n            dose_events = {int(slot_time / dt): dose for slot_time, dose in zip(slots, schedule) if dose > 0}\n            \n            # --- 2a. System Simulation ---\n            C, V_T, V_N = 0.0, 1.0, 1.0\n            \n            # The loop runs up to num_steps, covering the interval [0, T-dt].\n            # The final state is after the last step.\n            for n in range(num_steps):\n                # Follow the specified operator-splitting update scheme\n                \n                # 1. Apply bolus dose\n                dose_at_n = dose_events.get(n, 0.0)\n                C_after_dose = C + dose_at_n\n\n                # 2. Compute inhibition\n                if C_after_dose > 0:\n                    I = np.power(C_after_dose, h) / (np.power(ec50, h) + np.power(C_after_dose, h))\n                else:\n                    I = 0.0\n\n                # 3. Update viabilities\n                V_T *= np.exp(-k_T * s_T * I * dt)\n                V_N *= np.exp(-k_N * s_N * I * dt)\n\n                # 4. Update drug concentration (elimination)\n                C = C_after_dose * np.exp(-k_e * dt)\n\n            # --- 2b. Evaluate objective and apply tie-breaking rules ---\n            \n            current_tumor_kill = 1.0 - V_T\n            current_normal_kill = 1.0 - V_N\n            current_J = current_tumor_kill - lam * current_normal_kill\n\n            is_new_best = False\n            if current_J > best_J + epsilon:\n                is_new_best = True\n            elif abs(current_J - best_J) = epsilon:\n                if current_tumor_kill > best_tumor_kill + epsilon:\n                    is_new_best = True\n                elif abs(current_tumor_kill - best_tumor_kill) = epsilon:\n                    # Lexicographical comparison for the final tie-break\n                    if best_schedule is None or list(schedule)  best_schedule:\n                        is_new_best = True\n\n            if is_new_best:\n                best_J = current_J\n                best_tumor_kill = current_tumor_kill\n                best_normal_kill = current_normal_kill\n                best_schedule = list(schedule)\n\n        # --- 3. Format result for the current case ---\n        \n        # Format the dose vector as floats\n        formatted_schedule = [float(d) for d in best_schedule]\n        \n        # Construct the string for the current case's result\n        dose_str = f'[{\",\".join([f\"{d:.4f}\" for d in formatted_schedule])}]'\n        case_str = f'[{dose_str},{best_J:.4f},{best_tumor_kill:.4f},{best_normal_kill:.4f}]'\n        all_results.append(case_str)\n\n    # --- 4. Print final output in the required format ---\n    # Final print statement must be a single line with no extra text or whitespace\n    final_output_string = f\"[{','.join(all_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}