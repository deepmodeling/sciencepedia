{
    "hands_on_practices": [
        {
            "introduction": "掌握模块度分析的第一步是亲手计算一个简单网络的模块度得分。这个练习将指导你为一个基础的四节点网络计算模块度 $Q$ 值，让你深入理解模块度是如何量化社区内部连接相对于随机预期的密集程度的。通过这个计算，你将学会如何判断一个特定的网络划分是否揭示了有意义的社区结构。",
            "id": "4365529",
            "problem": "在系统生物医学中，分子相互作用网络中的社群结构通常通过模块度分数来量化，该分数将观测到的模块内连通性与一个度保持的随机零模型进行比较。考虑一个无向简单加权网络，其节点集为 $\\{1,2,3,4\\}$，边为 $(1,2)$、$(2,3)$、$(3,4)$，每条边的权重均为 $1$。设 $A_{ij}$ 表示对称加权邻接矩阵的元素，设 $k_i$ 表示节点强度（与节点 $i$ 相关联的边的权重之和）。设 $m$ 表示总边权重，因此 $2m=\\sum_{i}k_i$。度保持零模型（配置模型 (CM)）的期望邻接 $\\mathbb{E}[A_{ij}]$ 仅取决于 $\\{k_i\\}$ 和 $m$。\n\n从模块度的基本定义（即观测到的社群内部边权重比例与其在度保持零模型下期望值之间的归一化差异）出发，推导出对于划分 $\\{\\{1,2\\},\\{3,4\\}\\}$ 的模块度 $Q$ 的表达式，并计算其在该网络中的值。根据 $Q$ 的符号，判断该划分是否相对于随机情况增加了 $Q$ 值。将最终数值结果表示为一个精确的有理数，不要四舍五入。",
            "solution": "用户提供的问题经评估为有效。它具有网络理论的科学依据，问题表述清晰且有唯一答案，是客观的，并包含了求解所需的所有信息。\n\n该问题要求针对一个给定加权网络的特定划分，推导并计算其模块度分数 $Q$。如前所述，模块度的基本定义是观测到的社群内部边权重比例与其在度保持零模型（配置模型）下的期望值之间的归一化差异。\n\n首先，我们根据给定条件对网络结构和属性进行形式化描述。\n该网络有一个节点集 $V=\\{1,2,3,4\\}$ 和三条边，每条边的权重均为 $1$：$(1,2)$、$(2,3)$ 和 $(3,4)$。\n加权邻接矩阵 $A$（其中 $A_{ij}$ 是节点 $i$ 和 $j$ 之间边的权重）为：\n$$\nA = \\begin{pmatrix}\n0  1  0  0 \\\\\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  1  0\n\\end{pmatrix}\n$$\n节点 $i$ 的强度，记为 $k_i$，是与其连接的所有边的权重之和，$k_i = \\sum_j A_{ij}$。我们计算每个节点的强度：\n- $k_1 = A_{12} = 1$\n- $k_2 = A_{21} + A_{23} = 1 + 1 = 2$\n- $k_3 = A_{32} + A_{34} = 1 + 1 = 2$\n- $k_4 = A_{43} = 1$\n\n网络的总边权重 $m$ 是所有边权重之和：$m = 1+1+1=3$。这可以通过关系式 $2m = \\sum_i k_i$ 来验证，即 $2m = k_1+k_2+k_3+k_4 = 1+2+2+1=6$，因此 $m=3$。\n\n指定的划分将节点分为两个社群：$C_1 = \\{1,2\\}$ 和 $C_2 = \\{3,4\\}$。\n\n我们可以从第一性原理推导出模块度 $Q$ 的表达式。设 $L_s$ 为社群 $s$ 内部的边权重之和，设 $K_s$ 为社群 $s$ 中所有节点的强度之和。设 $m$ 为网络中的总边权重。\n\n落在社群 $s$ 内部的总边权重比例为 $e_{ss} = \\frac{L_s}{m}$。\n连接到社群 $s$ 中节点的所有边的“末端”（或配置模型中的“桩”）所占的比例为 $a_s = \\frac{K_s}{2m}$。在一个通过随机均匀连接桩来形成边的随机网络中，随机选择的一条边的两端都落在社群 $s$ 内部的概率是 $a_s \\times a_s = a_s^2$。$a_s^2$ 这一项代表了在度保持零模型下，社群 $s$ 内部的期望总边权重比例。\n\n模块度 $Q$ 是对划分中所有社群的观测比例和期望比例之差求和：\n$$\nQ = \\sum_{s} (e_{ss} - a_s^2) = \\sum_{s} \\left[ \\frac{L_s}{m} - \\left(\\frac{K_s}{2m}\\right)^2 \\right]\n$$\n这是加权网络模块度的一种标准且直接的公式。现在，我们为给定的划分计算必要的量。\n\n对于社群 $C_1 = \\{1,2\\}$：\n- 社群内部权重 $L_1$ 是边 $(1,2)$ 的权重，因此 $L_1 = 1$。\n- 节点强度之和 $K_1$ 为 $k_1 + k_2 = 1 + 2 = 3$。\n\n对于社群 $C_2 = \\{3,4\\}$：\n- 社群内部权重 $L_2$ 是边 $(3,4)$ 的权重，因此 $L_2 = 1$。\n- 节点强度之和 $K_2$ 为 $k_3 + k_4 = 2 + 1 = 3$。\n\n网络总权重为 $m=3$，且 $2m=6$。\n\n现在我们可以计算每个社群对 $Q$ 的贡献项。\n\n来自 $C_1$ 的贡献：\n$$e_{11} - a_1^2 = \\frac{L_1}{m} - \\left(\\frac{K_1}{2m}\\right)^2 = \\frac{1}{3} - \\left(\\frac{3}{6}\\right)^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4}$$\n$$ = \\frac{4}{12} - \\frac{3}{12} = \\frac{1}{12}$$\n\n来自 $C_2$ 的贡献：\n$$e_{22} - a_2^2 = \\frac{L_2}{m} - \\left(\\frac{K_2}{2m}\\right)^2 = \\frac{1}{3} - \\left(\\frac{3}{6}\\right)^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4}$$\n$$ = \\frac{4}{12} - \\frac{3}{12} = \\frac{1}{12}$$\n\n总模块度 $Q$ 是这些贡献的总和：\n$$Q = (e_{11} - a_1^2) + (e_{22} - a_2^2) = \\frac{1}{12} + \\frac{1}{12} = \\frac{2}{12} = \\frac{1}{6}$$\n\n计算出的模块度为 $Q = \\frac{1}{6}$。\n\n模块度分数的符号表明该划分是否识别出一个比随机预期更显著的社群结构。由于 $Q > 0$，划分 $\\{\\{1,2\\},\\{3,4\\}\\}$ 中社群内部边的密度（总权重）大于配置模型零假设下的期望值。因此，这个划分反映了网络中有意义的社群结构，并且它相对于随机基线增加了 $Q$ 值。",
            "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$"
        },
        {
            "introduction": "生物网络常常呈现特殊的结构，例如转录因子-基因调控网络就是典型的二分图。这个练习将模块度的概念扩展到二分网络，你需要为一个模拟的基因调控网络计算其专门的二分模块度。通过解决这个问题，你将学会如何为具有两类不同节点的网络评估社区结构的强度，这是分析多组学数据时的一项关键技能。",
            "id": "4365476",
            "problem": "考虑一个系统生物医学中的小型基因调控网络，该网络被建模为一个加权二分图，其中转录因子（TFs）和基因构成两个不相交的节点集。转录因子集为 $\\{T_1, T_2\\}$，基因集为 $\\{G_1, G_2\\}$。边权重表示从实验分析中推断出的归一化调控相互作用强度，且只存在从转录因子到基因的相互作用。为了对二分结构进行模块度分析，将该图视为无向图。非零边权重为：$w_{T_1 G_1} = 2$，$w_{T_1 G_2} = 1$，$w_{T_2 G_1} = 1$ 以及 $w_{T_2 G_2} = 3$。所有其他转录因子-基因对的权重为 $0$。考虑将网络划分为 $2$ 个社群：一个社群包含 $(T_1, G_1)$，另一个社群包含 $(T_2, G_2)$。使用标准的二分图模块度计算此划分的模块度 $Q$。该模块度通过在保持节点强度的二分配置零模型下，将观察到的转录因子-基因权重与其期望值进行比较。将您的最终答案表示为一个无单位的最简分数。",
            "solution": "用户提供的问题已经过分析，被认为是有效的。该问题具有科学依据、问题明确且客观，并为得出唯一解提供了所有必要信息。\n\n该问题要求计算一个给定加权二分图划分的模块度 $Q$。该图表示一个基因调控网络，包含两个不相交的节点集：一个转录因子（TFs）集 $U = \\{T_1, T_2\\}$，和一个基因集 $V = \\{G_1, G_2\\}$。\n\n二分图的标准模块度，记为 $Q_b$，其定义是基于社群内部的实际边权重与在适当的零模型下期望的边权重之间的比较。对于加权二分图，其公式为：\n$$Q_b = \\frac{1}{m} \\sum_{i \\in U, j \\in V} \\left( A_{ij} - \\frac{k_i d_j}{m} \\right) \\delta(c_i, c_j)$$\n其中：\n- $A_{ij}$ 是来自第一个节点集（TFs）的节点 $i$ 与来自第二个节点集（基因）的节点 $j$ 之间边的权重。\n- $m$ 是网络中所有边的总权重。\n- $k_i$ 是节点 $i \\in U$ 的强度（加权度），计算方式为 $k_i = \\sum_{j \\in V} A_{ij}$。\n- $d_j$ 是节点 $j \\in V$ 的强度（加权度），计算方式为 $d_j = \\sum_{i \\in U} A_{ij}$。\n- $c_i$ 是节点 $i$ 所属的社群。\n- $\\delta(c_i, c_j)$ 是克罗内克 delta 函数，如果节点 $i$ 和 $j$ 在同一个社群中 ($c_i=c_j$)，则其值为 $1$，否则为 $0$。\n\n首先，我们必须根据给定的问题陈述计算必要的量。\n\n给定的边权重为：\n- $w_{T_1 G_1} = A_{T_1, G_1} = 2$\n- $w_{T_1 G_2} = A_{T_1, G_2} = 1$\n- $w_{T_2 G_1} = A_{T_2, G_1} = 1$\n- $w_{T_2 G_2} = A_{T_2, G_2} = 3$\n\n所有边的总权重 $m$ 是这些权重之和：\n$$m = A_{T_1, G_1} + A_{T_1, G_2} + A_{T_2, G_1} + A_{T_2, G_2} = 2 + 1 + 1 + 3 = 7$$\n\n接下来，我们计算每个节点的强度（加权度）。\n对于集合 $U$ 中的转录因子节点：\n- $k_{T_1} = A_{T_1, G_1} + A_{T_1, G_2} = 2 + 1 = 3$\n- $k_{T_2} = A_{T_2, G_1} + A_{T_2, G_2} = 1 + 3 = 4$\n\n对于集合 $V$ 中的基因节点：\n- $d_{G_1} = A_{T_1, G_1} + A_{T_2, G_1} = 2 + 1 = 3$\n- $d_{G_2} = A_{T_1, G_2} + A_{T_2, G_2} = 1 + 3 = 4$\n\n问题指定了一个划分为 $2$ 个社群的方案：\n- 社群 $1$ ($C_1$): 包含节点 $\\{T_1, G_1\\}$。\n- 社群 $2$ ($C_2$): 包含节点 $\\{T_2, G_2\\}$。\n\n模块度公式对所有属于同一社群的节点对 $(i,j)$（其中 $i \\in U$ 且 $j \\in V$）的贡献求和。项 $\\delta(c_i, c_j)$ 确保了这一点。\n对于给定的划分，来自不同集合 $(U, V)$ 且处于同一社群的节点对是 $C_1$ 中的 $(T_1, G_1)$ 和 $C_2$ 中的 $(T_2, G_2)$。所有其他节点对，$(T_1, G_2)$ 和 $(T_2, G_1)$，处于不同的社群中，因此它们对总和的贡献为零。\n\n因此，模块度的计算简化为：\n$$Q = \\frac{1}{m} \\left[ \\left( A_{T_1, G_1} - \\frac{k_{T_1} d_{G_1}}{m} \\right) + \\left( A_{T_2, G_2} - \\frac{k_{T_2} d_{G_2}}{m} \\right) \\right]$$\n\n现在我们将计算出的值代入此表达式：\n- $m = 7$\n- $A_{T_1, G_1} = 2$ 且 $A_{T_2, G_2} = 3$\n- $k_{T_1} = 3$ 且 $d_{G_1} = 3$\n- $k_{T_2} = 4$ 且 $d_{G_2} = 4$\n\n$$Q = \\frac{1}{7} \\left[ \\left( 2 - \\frac{3 \\times 3}{7} \\right) + \\left( 3 - \\frac{4 \\times 4}{7} \\right) \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\left( 2 - \\frac{9}{7} \\right) + \\left( 3 - \\frac{16}{7} \\right) \\right]$$\n为了进行括号内的减法运算，我们找到一个共同的分母：\n$$Q = \\frac{1}{7} \\left[ \\left( \\frac{14}{7} - \\frac{9}{7} \\right) + \\left( \\frac{21}{7} - \\frac{16}{7} \\right) \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\frac{5}{7} + \\frac{5}{7} \\right]$$\n$$Q = \\frac{1}{7} \\left[ \\frac{10}{7} \\right]$$\n$$Q = \\frac{10}{49}$$\n分数 $\\frac{10}{49}$ 已经是最简形式，因为 $10$ 和 $49$ 的最大公约数为 $1$。\n给定划分的模块度是 $\\frac{10}{49}$。",
            "answer": "$$\\boxed{\\frac{10}{49}}$$"
        },
        {
            "introduction": "许多生物过程，如信号传导和基因调控，本质上是有方向性的，因此需要使用有向网络来表示。本练习挑战你计算一个小型有向网络的模块度，这要求你区分节点的入度 $k^{\\text{in}}$ 和出度 $k^{\\text{out}}$。这个实践将使你掌握在分析具有因果或方向性关系的网络时，如何正确应用模块度分析，从而能够更精确地揭示其中的功能模块。",
            "id": "4365539",
            "problem": "在系统生物医学中，有向生物分子相互作用网络（如基因调控网络GRN）中的社区检测通常通过一个称为网络模块度的标量来量化。该模块度衡量了给定的划分在多大程度上将边集中在社区内部，超出了在保持入度和出度序列不变的随机零模型下的预期。考虑一个有向网络，其节点为 $1$、$2$ 和 $3$，有向边为 $1 \\to 2$、$2 \\to 3$ 和 $3 \\to 1$。设节点的划分为 $\\{\\{1,2\\},\\{3\\}\\}$，其中节点 $1$ 和 $2$ 组成一个社区，节点 $3$ 单独在另一个社区中。使用保持每个节点的入度和出度的有向网络标准配置模型零系综，计算此划分的模块度 $Q$。你的计算必须按以下步骤进行：首先明确计算每个节点 $i \\in \\{1,2,3\\}$ 的入度 $k_{i}^{\\text{in}}$ 和出度 $k_{i}^{\\text{out}}$，然后评估观察到的社区内部边数及其在零模型下的期望值，最后将这些组合成指定划分的模块度 $Q$。将你的最终答案表示为一个精确的有理数，不要四舍五入。",
            "solution": "该问题要求计算一个特定有向网络的给定划分的模块度 $Q$。有向网络的模块度衡量了与随机零模型相比，边在社区内部集中的程度。对于一个有向网络划分为一组社区 $\\{c\\}$，模块度 $Q$ 的标准定义如下：\n\n$$ Q = \\frac{1}{M} \\sum_{i,j} \\left[ A_{ij} - P_{ij} \\right] \\delta(c_i, c_j) $$\n\n其中：\n- $M$ 是网络中的总边数。\n- $A_{ij}$ 是邻接矩阵元素，如果存在从节点 $i$到节点 $j$ 的有向边，则其值为 $1$，否则为 $0$。\n- $P_{ij}$ 是在配置零模型中从节点 $i$到节点 $j$ 存在一条边的概率，由 $P_{ij} = \\frac{k_i^{\\text{out}} k_j^{\\text{in}}}{M}$ 给出。这里，$k_i^{\\text{out}}$ 是节点 $i$ 的出度，$k_j^{\\text{in}}$ 是节点 $j$ 的入度。\n- $c_i$ 是节点 $i$ 的社区分配。\n- $\\delta(c_i, c_j)$ 是克罗内克δ函数，如果节点 $i$ 和 $j$ 在同一个社区中（$c_i = c_j$），则为 $1$，否则为 $0$。\n\n计算将按照问题陈述中概述的步骤进行。\n\n首先，我们从问题描述中确定网络的属性。\n网络有节点 $V = \\{1, 2, 3\\}$。\n有向边为 $1 \\to 2$、$2 \\to 3$ 和 $3 \\to 1$。\n总边数是 $M=3$。\n邻接矩阵 $A$ 是：\n$$ A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 1  0  0 \\end{pmatrix} $$\n\n指定的划分为 $\\{\\{1,2\\},\\{3\\}\\}$。我们记社区 $C_1 = \\{1, 2\\}$ 和社区 $C_2 = \\{3\\}$。\n\n**步骤1：计算每个节点的入度和出度。**\n\n- 对于节点 $1$：有一条出边（$1 \\to 2$）和一条入边（$3 \\to 1$）。\n  $$ k_1^{\\text{out}} = 1, \\quad k_1^{\\text{in}} = 1 $$\n- 对于节点 $2$：有一条出边（$2 \\to 3$）和一条入边（$1 \\to 2$）。\n  $$ k_2^{\\text{out}} = 1, \\quad k_2^{\\text{in}} = 1 $$\n- 对于节点 $3$：有一条出边（$3 \\to 1$）和一条入边（$2 \\to 3$）。\n  $$ k_3^{\\text{out}} = 1, \\quad k_3^{\\text{in}} = 1 $$\n出度之和为 $\\sum_{i} k_i^{\\text{out}} = 1+1+1=3$，入度之和为 $\\sum_{j} k_j^{\\text{in}} = 1+1+1=3$。正如预期的那样，这两个和都等于总边数 $M$。\n\n**步骤2：评估观察到的社区内部边数。**\n\n模块度公式可以表示为社区内部边所占比例与零模型下此类边的期望比例之间的差值。\n社区内部边所占比例由 $\\frac{1}{M}\\sum_{i,j} A_{ij} \\delta(c_i, c_j)$ 给出。\n我们对起始和终止于同一社区的边数进行求和。\n- 对于社区 $C_1 = \\{1, 2\\}$，我们检查 $i,j \\in \\{1,2\\}$ 的边 $(i,j)$。唯一的此类边是 $1 \\to 2$。因此，内部边数为 $L_{C_1} = 1$。\n- 对于社区 $C_2 = \\{3\\}$，我们检查 $i,j \\in \\{3\\}$ 的边 $(i,j)$。节点 $3$ 上没有自环。因此，内部边数为 $L_{C_2} = 0$。\n\n观察到的社区内部总边数为 $L = L_{C_1} + L_{C_2} = 1 + 0 = 1$。\n观察到的社区内部边所占比例为 $\\frac{L}{M} = \\frac{1}{3}$。\n\n**步骤3：评估零模型下期望的社区内部边数。**\n\n社区内部边的期望比例由 $\\frac{1}{M}\\sum_{i,j} P_{ij} \\delta(c_i, c_j) = \\frac{1}{M^2}\\sum_{i,j} k_i^{\\text{out}} k_j^{\\text{in}} \\delta(c_i, c_j)$ 给出。\n该项可以通过对每个社区的贡献求和来计算。设 $K_c^{\\text{out}} = \\sum_{i \\in c} k_i^{\\text{out}}$ 和 $K_c^{\\text{in}} = \\sum_{j \\in c} k_j^{\\text{in}}$。期望比例为 $\\sum_{c} \\frac{K_c^{\\text{out}} K_c^{\\text{in}}}{M^2}$。\n\n- 对于社区 $C_1 = \\{1, 2\\}$:\n  总出度为 $K_{C_1}^{\\text{out}} = k_1^{\\text{out}} + k_2^{\\text{out}} = 1 + 1 = 2$。\n  总入度为 $K_{C_1}^{\\text{in}} = k_1^{\\text{in}} + k_2^{\\text{in}} = 1 + 1 = 2$。\n  $C_1$ 内部边的期望比例为 $\\frac{K_{C_1}^{\\text{out}} K_{C_1}^{\\text{in}}}{M^2} = \\frac{2 \\times 2}{3^2} = \\frac{4}{9}$。\n\n- 对于社区 $C_2 = \\{3\\}$:\n  总出度为 $K_{C_2}^{\\text{out}} = k_3^{\\text{out}} = 1$。\n  总入度为 $K_{C_2}^{\\text{in}} = k_3^{\\text{in}} = 1$。\n  $C_2$ 内部边的期望比例为 $\\frac{K_{C_2}^{\\text{out}} K_{C_2}^{\\text{in}}}{M^2} = \\frac{1 \\times 1}{3^2} = \\frac{1}{9}$。\n\n社区内部边的总期望比例是这些贡献的总和：\n$$ \\frac{4}{9} + \\frac{1}{9} = \\frac{5}{9} $$\n\n**步骤4：组合这些分量以计算模块度 $Q$。**\n\n模块度 $Q$ 是观察到的社区内部边比例与期望比例之间的差值：\n$$ Q = (\\text{观察到的比例}) - (\\text{期望的比例}) $$\n$$ Q = \\frac{1}{3} - \\frac{5}{9} $$\n为了相减，我们找到一个公分母，即 $9$：\n$$ Q = \\frac{3}{9} - \\frac{5}{9} = -\\frac{2}{9} $$\n\n给定划分的模块度为 $-\\frac{2}{9}$。负值表示在指定的配置零模型下，给定划分的内部边数少于随机预期的数量。",
            "answer": "$$\\boxed{-\\frac{2}{9}}$$"
        }
    ]
}