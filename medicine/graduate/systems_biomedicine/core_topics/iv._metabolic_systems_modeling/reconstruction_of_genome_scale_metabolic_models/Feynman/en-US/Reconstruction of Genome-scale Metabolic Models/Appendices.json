{
    "hands_on_practices": [
        {
            "introduction": "The foundation of a reliable genome-scale metabolic model (GEM) rests upon the accuracy of its individual biochemical reactions. A fundamental, non-negotiable principle is the conservation of mass and charge in every conversion. This practice challenges you to perform a critical curation task: auditing and correcting a reaction to ensure it is elementally and electrically balanced, a core skill for building high-quality metabolic reconstructions. ",
            "id": "4383604",
            "problem": "A Genome-Scale Metabolic Model (GEM) represents biochemical reactions with explicit stoichiometric coefficients for metabolites in defined cellular compartments and requires strict conservation of mass and electric charge. Consider the cytosolic carbonic anhydrase reaction in a human cell that has been incorrectly encoded in the model as\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}},\n$$\nwhere the subscripts $\\mathrm{c}$ and $\\mathrm{m}$ denote the cytosolic and mitochondrial compartments, respectively. At physiological pH, use the following metabolite formulas and net charges:\n- $\\mathrm{CO_2}$: formula $C_1O_2$, net charge $0$.\n- $\\mathrm{H_2O}$: formula $H_2O_1$, net charge $0$.\n- $\\mathrm{HCO_3^-}$: formula $C_1H_1O_3$, net charge $-1$.\n- $\\mathrm{H^+}$: formula $H_1$, net charge $+1$.\n\nStarting from the fundamental principles of conservation of mass (each element count is conserved across the reaction) and conservation of electric charge (the algebraic sum of charges must be equal for reactants and products), perform a mass and charge audit of the given reaction. Because purely enzymatic conversions do not translocate species across compartments, first correct the compartmental assignment of water by placing $\\mathrm{H_2O}$ in the cytosolic compartment. Then, determine the single stoichiometric coefficient $n$ to be assigned to $\\mathrm{H^+}_{\\mathrm{c}}$ on the product side so that both mass and charge are conserved in the corrected cytosolic reaction:\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}.\n$$\nProvide the value of $n$ as your final answer. No units are required. The final answer must be a single real-valued number. If you compute a non-integer value, do not round; report the exact value. If you compute an integer value, report it exactly.",
            "solution": "The problem as stated is subjected to validation against the principles of scientific soundness, consistency, and formalizability.\n\n**Problem Validation**\n\n**Step 1: Extracted Givens**\n- **Initial reaction (incorrect):** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}}$\n- **Compartment definitions:** $\\mathrm{c}$ for cytosol, $\\mathrm{m}$ for mitochondrion.\n- **Metabolite properties (at physiological pH):**\n  - $\\mathrm{CO_2}$: Formula $C_1O_2$, Net charge $0$.\n  - $\\mathrm{H_2O}$: Formula $H_2O_1$, Net charge $0$.\n  - $\\mathrm{HCO_3^-}$: Formula $C_1H_1O_3$, Net charge $-1$.\n  - $\\mathrm{H^+}$: Formula $H_1$, Net charge $+1$.\n- **Correction instructions:**\n  1. The reaction is purely enzymatic and does not involve translocation; therefore, $\\mathrm{H_2O}$ must be assigned to the cytosolic compartment, $\\mathrm{H_2O_c}$.\n  2. The reaction must be balanced for both mass and charge by introducing a proton, $\\mathrm{H^+_c}$, on the product side with an unknown stoichiometric coefficient, $n$.\n- **Final reaction form to be balanced:** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}$.\n\n**Step 2: Validation of Extracted Givens**\n- **Scientifically Grounded:** The problem is centered on the carbonic anhydrase reaction, a fundamental biochemical process. It correctly applies the principles of mass and charge conservation, which are inviolable laws in chemistry and physics. The context of Genome-Scale Metabolic Models (GEMs) and compartmentalization is central to the field of systems biology. The premise is scientifically sound.\n- **Well-Posed:** The problem provides all necessary information (atomic compositions, charges, and the structural form of the corrected reaction) to determine a single unknown variable, $n$. This structure leads to a unique and stable solution.\n- **Objective:** The problem is stated using precise chemical and mathematical terminology. It is free of ambiguity, subjectivity, or opinion.\n\n**Step 3: Verdict and Action**\n- **Verdict:** The problem is valid. It is scientifically grounded, well-posed, and internally consistent.\n- **Action:** Proceed with the solution.\n\n**Solution Derivation**\n\nThe fundamental principles governing any valid biochemical reaction are the conservation of mass for each element and the conservation of total electric charge. The problem requires us to find the stoichiometric coefficient $n$ for the proton $\\mathrm{H^+_c}$ that satisfies these principles for the cytosolic carbonic anhydrase reaction.\n\nThe corrected reaction to be balanced is:\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\nSince all species are in the same cytosolic compartment ($\\mathrm{c}$), the compartment labels can be omitted for the balancing calculation without loss of generality. The reaction stoichiometry is thus:\n$$\n1\\,\\mathrm{CO_2} + 1\\,\\mathrm{H_2O} \\rightarrow 1\\,\\mathrm{HCO_3^-} + n\\,\\mathrm{H^+}\n$$\nWe will now perform an audit for each element (Carbon, Oxygen, Hydrogen) and for the net electric charge.\n\n**1. Mass Balance Audit:**\n\nLet us tabulate the number of atoms for each element on the reactant and product sides of the equation.\n\n- **Carbon (C):**\n  - Reactants: $1$ atom from $\\mathrm{CO_2}$ (formula $C_1O_2$).\n  - Products: $1$ atom from $\\mathrm{HCO_3^-}$ (formula $C_1H_1O_3$).\n  - The balance equation is $1 = 1$. This is satisfied and provides no constraint on $n$.\n\n- **Oxygen (O):**\n  - Reactants: $2$ atoms from $\\mathrm{CO_2}$ + $1$ atom from $\\mathrm{H_2O}$ (formula $H_2O_1$). Total is $2 + 1 = 3$.\n  - Products: $3$ atoms from $\\mathrm{HCO_3^-}$.\n  - The balance equation is $3 = 3$. This is also satisfied and provides no constraint on $n$.\n\n- **Hydrogen (H):**\n  - Reactants: $2$ atoms from $\\mathrm{H_2O}$ (formula $H_2O_1$).\n  - Products: $1$ atom from $\\mathrm{HCO_3^-}$ + $n \\times 1$ atoms from $n\\,\\mathrm{H^+}$ (formula $H_1$). Total is $1 + n$.\n  - To conserve mass, the number of hydrogen atoms on both sides must be equal:\n  $$\n  2 = 1 + n\n  $$\n\n**2. Charge Balance Audit:**\n\nNext, we balance the net electric charge.\n\n- **Reactants:**\n  - $\\mathrm{CO_2}$ has a charge of $0$.\n  - $\\mathrm{H_2O}$ has a charge of $0$.\n  - The total charge on the reactant side is $0 + 0 = 0$.\n\n- **Products:**\n  - $\\mathrm{HCO_3^-}$ has a charge of $-1$.\n  - $n\\,\\mathrm{H^+}$ contributes a total charge of $n \\times (+1) = +n$.\n  - The total charge on the product side is $-1 + n$.\n\n- To conserve charge, the net charges on both sides must be equal:\n  $$\n  0 = -1 + n\n  $$\n\n**3. Solving for $n$:**\n\nWe have derived two independent equations for the unknown coefficient $n$. A consistent problem formulation must yield the same value for $n$ from both equations.\n\nFrom the hydrogen mass balance:\n$$\n2 = 1 + n \\implies n = 2 - 1 = 1\n$$\nFrom the electric charge balance:\n$$\n0 = -1 + n \\implies n = 1\n$$\nBoth equations yield a consistent result, $n=1$. This confirms the correctness of the approach and the well-posed nature of the problem.\n\nTherefore, the stoichiometrically correct and charge-balanced reaction for carbonic anhydrase in the cytosol is:\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + 1\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\nThe value of the stoichiometric coefficient $n$ is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Once individual reactions are validated, the focus shifts to the network's overall topology. A common issue in draft reconstructions is the presence of 'gaps'—metabolites that are produced but not consumed, or vice versa—which can lead to isolated subnetworks. This practice introduces a graph-based method to identify such structural inconsistencies by analyzing network connectivity after removing ubiquitous 'currency metabolites,' a standard procedure to reveal the core metabolic map. ",
            "id": "4383591",
            "problem": "You are given a representation of a genome-scale metabolic network consisting of metabolites and reactions. The reconstruction principle is that the stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ encodes, for each metabolite $i \\in \\{1,\\dots,m\\}$ and each reaction $j \\in \\{1,\\dots,n\\}$, a stoichiometric coefficient $S_{ij}$, where $S_{ij} > 0$ indicates production of metabolite $i$ in reaction $j$, and $S_{ij} < 0$ indicates consumption. A reaction connects substrates to products in a bipartite graph between metabolites and reactions. To analyze structural connectivity relevant for Systems Biomedicine, it is common to remove currency metabolites that act as ubiquitous cofactors to avoid spurious connectivity.\n\nStarting from these foundational definitions, define an undirected metabolite graph $G = (V,E)$ as follows:\n- The vertex set $V$ contains all non-currency metabolites that appear in at least one reaction.\n- For each reaction $j$, let $\\mathcal{S}_j = \\{i \\mid S_{ij} < 0\\}$ be the substrate set and $\\mathcal{P}_j = \\{i \\mid S_{ij} > 0\\}$ be the product set. After removing currency metabolites, for every pair $(u,v)$ with $u \\in \\mathcal{S}_j$ and $v \\in \\mathcal{P}_j$, add an undirected edge $\\{u,v\\}$ to $E$.\n\nDefine the set of currency metabolites $\\mathcal{C}$ as the union of:\n- A provided explicit set of currency names, and\n- A high-degree set $\\{i \\in V_{\\text{all}} \\mid d(i) > k\\}$, where $d(i)$ is the number of distinct reactions in which metabolite $i$ participates as a substrate or product (prior to currency removal), and $k$ is a provided integer threshold.\n\nExchange reactions and transport reactions provide boundary connectivity to the environment or between compartments. Let $\\mathcal{B}$ be the set of non-currency metabolites that participate in any exchange reaction or transport reaction. A connected component $C \\subseteq V$ is called isolated if $C \\cap \\mathcal{B} = \\emptyset$.\n\nYour task is to compute the connected components of $G$ after currency removal and identify isolated subnetworks. For each test case, output a list of integers where the first integer is the number of isolated components, followed by the sizes of each isolated component in ascending order.\n\nInput representation is abstracted as structured parameters rather than an explicit matrix $S$. Each reaction $j$ is specified by its name, and two lists: substrates and products. Each substrate or product is a pair $(\\text{name}, \\text{coefficient})$, where the coefficient is a positive integer that corresponds to $|S_{ij}|$; the sign is implied by its role as a substrate or product. Reaction names that start with the prefix $\"EX\\_\"$ denote exchange reactions, and names that start with the prefix $\"T\\_\"$ denote transport reactions.\n\nYou must implement the construction of $G$ and the identification of isolated components as described, strictly adhering to the mathematical definitions above. There are no physical units involved. Angles are not applicable. Percentages are not applicable.\n\nTest suite:\n- Test case $1$ (general case):\n  - Metabolites: $\\{\\text{\"glc\\_\\_D\\_e\"}, \\text{\"glc\\_\\_D\\_c\"}, \\text{\"g6p\\_c\"}, \\text{\"f6p\\_c\"}, \\text{\"pyr\\_c\"}, \\text{\"lac\\_\\_L\\_e\"}, \\text{\"lac\\_\\_L\\_c\"}, \\text{\"atp\\_c\"}, \\text{\"adp\\_c\"}, \\text{\"pi\\_c\"}, \\text{\"h2o\\_c\"}, \\text{\"h\\_c\"}, \\text{\"nad\\_c\"}, \\text{\"nadh\\_c\"}, \\text{\"fa\\_c\"}, \\text{\"lipid\\_c\"}\\}$.\n  - Currency names: $\\{\\text{\"atp\\_c\"}, \\text{\"adp\\_c\"}, \\text{\"pi\\_c\"}, \\text{\"h2o\\_c\"}, \\text{\"h\\_c\"}, \\text{\"nad\\_c\"}, \\text{\"nadh\\_c\"}\\}$.\n  - Degree threshold $k = 4$.\n  - Reactions:\n    - $\\text{\"EX\\_glc\\_\\_D\\_e\"}$: substrates $\\{(\\text{\"glc\\_\\_D\\_e\"}, 1)\\}$, products $\\{\\}$.\n    - $\\text{\"T\\_glc\\_e\\_c\"}$: substrates $\\{(\\text{\"glc\\_\\_D\\_e\"}, 1)\\}$, products $\\{(\\text{\"glc\\_\\_D\\_c\"}, 1)\\}$.\n    - $\\text{\"HK\"}$: substrates $\\{(\\text{\"glc\\_\\_D\\_c\"}, 1), (\\text{\"atp\\_c\"}, 1)\\}$, products $\\{(\\text{\"g6p\\_c\"}, 1), (\\text{\"adp\\_c\"}, 1)\\}$.\n    - $\\text{\"PGI\"}$: substrates $\\{(\\text{\"g6p\\_c\"}, 1)\\}$, products $\\{(\\text{\"f6p\\_c\"}, 1)\\}$.\n    - $\\text{\"GAPDH\"}$: substrates $\\{(\\text{\"f6p\\_c\"}, 1), (\\text{\"nad\\_c\"}, 1)\\}$, products $\\{(\\text{\"pyr\\_c\"}, 1), (\\text{\"nadh\\_c\"}, 1)\\}$.\n    - $\\text{\"LDH\"}$: substrates $\\{(\\text{\"pyr\\_c\"}, 1), (\\text{\"nad\\_c\"}, 1)\\}$, products $\\{(\\text{\"lac\\_\\_L\\_c\"}, 1), (\\text{\"nadh\\_c\"}, 1)\\}$.\n    - $\\text{\"T\\_lac\\_c\\_e\"}$: substrates $\\{(\\text{\"lac\\_\\_L\\_c\"}, 1)\\}$, products $\\{(\\text{\"lac\\_\\_L\\_e\"}, 1)\\}$.\n    - $\\text{\"FA\\_synthesis\"}$: substrates $\\{(\\text{\"fa\\_c\"}, 1)\\}$, products $\\{(\\text{\"lipid\\_c\"}, 1)\\}$.\n- Test case $2$ (edge case dominated by currency; isolation emerges after removal):\n  - Metabolites: $\\{\\text{\"A\\_c\"}, \\text{\"B\\_c\"}, \\text{\"C\\_c\"}, \\text{\"ATP\\_c\"}, \\text{\"ADP\\_c\"}, \\text{\"NAD\\_c\"}, \\text{\"NADX\\_c\"}, \\text{\"H2O\\_c\"}, \\text{\"H\\_c\"}, \\text{\"X\\_e\"}\\}$.\n  - Currency names: $\\{\\text{\"ATP\\_c\"}, \\text{\"ADP\\_c\"}, \\text{\"NAD\\_c\"}, \\text{\"NADX\\_c\"}, \\text{\"H2O\\_c\"}, \\text{\"H\\_c\"}\\}$.\n  - Degree threshold $k = 2$.\n  - Reactions:\n    - $\\text{\"R1\"}$: substrates $\\{(\\text{\"A\\_c\"}, 1), (\\text{\"ATP\\_c\"}, 1)\\}$, products $\\{(\\text{\"B\\_c\"}, 1), (\\text{\"ADP\\_c\"}, 1)\\}$.\n    - $\\text{\"R2\"}$: substrates $\\{(\\text{\"B\\_c\"}, 1), (\\text{\"NAD\\_c\"}, 1)\\}$, products $\\{(\\text{\"C\\_c\"}, 1), (\\text{\"NADX\\_c\"}, 1)\\}$.\n    - $\\text{\"R3\"}$: substrates $\\{(\\text{\"C\\_c\"}, 1), (\\text{\"H2O\\_c\"}, 1)\\}$, products $\\{(\\text{\"A\\_c\"}, 1), (\\text{\"H\\_c\"}, 1)\\}$.\n    - $\\text{\"EX\\_X\\_e\"}$: substrates $\\{(\\text{\"X\\_e\"}, 1)\\}$, products $\\{\\}$.\n- Test case $3$ (boundary condition; fully connected without currency cofactors):\n  - Metabolites: $\\{\\text{\"m1\\_c\"}, \\text{\"m2\\_c\"}, \\text{\"m3\\_e\"}\\}$.\n  - Currency names: $\\{\\}$.\n  - Degree threshold $k = 1$.\n  - Reactions:\n    - $\\text{\"T\\_m3\\_e\\_c\"}$: substrates $\\{(\\text{\"m3\\_e\"}, 1)\\}$, products $\\{(\\text{\"m1\\_c\"}, 1)\\}$.\n    - $\\text{\"R1\"}$: substrates $\\{(\\text{\"m1\\_c\"}, 1)\\}$, products $\\{(\\text{\"m2\\_c\"}, 1)\\}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case result formatted as a list: $[\\text{count}, \\text{size}_1, \\dots, \\text{size}_r]$. For example, the output should look like $[[\\dots],[\\dots],[\\dots]]$ with no spaces.",
            "solution": "The problem requires the analysis of a metabolic network's structure by identifying isolated connected components within a specially constructed metabolite graph. The solution involves a multi-step process: identifying currency metabolites, constructing an undirected graph based on reaction stoichiometry, determining network boundaries, and finally, using graph traversal algorithms to find and classify connected components. Each step is grounded in established principles of metabolic network analysis.\n\nThe process begins with the formal definition of the metabolic network components. The network is described by a set of metabolites, $V_{\\text{all}}$, and a set of reactions. The stoichiometry is implicitly defined for each reaction $j$ by its set of substrates, $\\mathcal{S}_j$, and products, $\\mathcal{P}_j$. A stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ can be conceptualized, where $m = |V_{\\text{all}}|$ and $n$ is the number of reactions. For a metabolite $i$ and reaction $j$, $S_{ij} < 0$ if $i \\in \\mathcal{S}_j$, $S_{ij} > 0$ if $i \\in \\mathcal{P}_j$, and $S_{ij} = 0$ otherwise.\n\n**Step 1: Identification of Currency Metabolites**\n\nA critical preparatory step in metabolic network analysis is the removal of \"currency metabolites.\" These are ubiquitous molecules like ATP ($atp_c$), water ($h2o_c$), or cofactors ($nad_c$, $nadh_c$) that participate in a vast number of reactions. Including them in a connectivity graph would create a densely connected, biologically uninformative network, as they would spuriously link otherwise distant pathways. The problem defines the set of currency metabolites, $\\mathcal{C}$, as the union of two subsets:\n1.  An explicitly provided list of metabolite names.\n2.  A set of high-degree metabolites, defined as $\\{i \\in V_{\\text{all}} \\mid d(i) > k\\}$, where $d(i)$ is the degree of metabolite $i$, calculated as the number of distinct reactions in which it participates (either as a substrate or a product), and $k$ is a given integer threshold.\n\nThe first step of the algorithm is to compute this set $\\mathcal{C}$. This involves iterating through all reactions to tabulate the participation count for each metabolite in $V_{\\text{all}}$ to determine their degrees $d(i)$, and then combining the high-degree metabolites with the explicit list.\n\n**Step 2: Construction of the Metabolite Graph $G = (V, E)$**\n\nOnce the currency metabolites $\\mathcal{C}$ are identified, the metabolite graph $G$ can be constructed. The vertices and edges are defined as follows:\n- The vertex set $V$ consists of all non-currency metabolites: $V = V_{\\text{all}} \\setminus \\mathcal{C}$.\n- The edge set $E$ is constructed by examining each reaction $j$. For a given reaction, we consider the set of non-currency substrates, $\\mathcal{S}'_j = \\mathcal{S}_j \\setminus \\mathcal{C}$, and the set of non-currency products, $\\mathcal{P}'_j = \\mathcal{P}_j \\setminus \\mathcal{C}$. An undirected edge $\\{u, v\\}$ is added to the edge set $E$ for every pair of metabolites $(u, v)$ where $u \\in \\mathcal{S}'_j$ and $v \\in \\mathcal{P}'_j$. This rule effectively creates a complete bipartite subgraph between the non-currency substrates and products for each reaction, linking metabolites that are one reaction step apart.\n\nThis construction results in an undirected graph where nodes are metabolites and an edge signifies that two metabolites can be converted into one another through a chain of one or more reactions.\n\n**Step 3: Identification of Boundary Metabolites and Isolated Components**\n\nTo determine if a subnetwork is \"isolated,\" we must first define the system's boundary. The boundary is represented by metabolites that can be exchanged with the environment or transported between compartments. The problem defines exchange and transport reactions as those whose names begin with the prefixes `\"EX_\"` or `\"T_\"`, respectively. The set of boundary metabolites, $\\mathcal{B}$, is formally defined as the set of all non-currency metabolites ($i \\in V$) that participate in any such boundary reaction.\n\nA connected component of the graph $G$ represents a subnetwork of inter-convertible metabolites. A component $C \\subseteq V$ is defined as **isolated** if it has no connection to the external environment, which translates to the formal condition: $C \\cap \\mathcal{B} = \\emptyset$. In other words, an isolated component is a group of metabolites that can be transformed among themselves but cannot be produced from or consumed into the external environment or other compartments via the defined boundary reactions.\n\n**Step 4: Algorithmic Implementation and Component Analysis**\n\nThe computational task is to implement the above definitions to find the number of isolated components and their respective sizes. The algorithm proceeds as follows:\n1.  First, parse the input data for all metabolites ($V_{\\text{all}})$, reactions, explicit currency names, and the degree threshold $k$.\n2.  Construct the full currency set $\\mathcal{C}$ by first computing the degree of every metabolite across all reactions and adding those with $d(i) > k$ to the explicit currency set.\n3.  Define the vertex set $V$ as $V_{\\text{all}} \\setminus \\mathcal{C}$. An adjacency list is a suitable data structure to represent the graph $G=(V, E)$, initialized as empty for all vertices in $V$.\n4.  Populate the adjacency list by iterating through each reaction. For each reaction, identify the non-currency substrates $\\mathcal{S}'_j$ and non-currency products $\\mathcal{P}'_j$. For every $u \\in \\mathcal{S}'_j$ and $v \\in \\mathcal{P}'_j$, add an edge between $u$ and $v$ in the adjacency list.\n5.  Determine the set of boundary metabolites $\\mathcal{B}$ by iterating through all reactions with names prefixed by `\"EX_\"` or `\"T_\"` and collecting all participating non-currency metabolites.\n6.  Find the connected components of $G$. This is a standard graph problem solvable with algorithms like Breadth-First Search (BFS) or Depth-First Search (DFS). A set of visited vertices is maintained. Iterate through all vertices in $V$; if a vertex has not been visited, start a traversal (e.g., BFS) from it, marking all reachable vertices as visited and grouping them into a new component.\n7.  For each identified component $C$, check for isolation by testing if its intersection with the boundary set $\\mathcal{B}$ is empty.\n8.  Collect the sizes (number of vertices) of all components found to be isolated.\n9.  The final output for the test case is a list containing the count of isolated components, followed by their sizes sorted in ascending order.\n\nThis structured, principle-based approach ensures a correct and rigorous analysis of the metabolic network's topology as specified.",
            "answer": "```python\nimport collections\n\n# No external libraries beyond the standard library and the specified ones are needed.\n# numpy and scipy are not required for this problem as it is a graph theory problem on unweighted graphs,\n# which can be solved efficiently with standard Python data structures.\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the processing of test cases and printing the final result.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (general case)\n        {\n            \"metabolites\": {\"glc__D_e\", \"glc__D_c\", \"g6p_c\", \"f6p_c\", \"pyr_c\", \"lac__L_e\", \"lac__L_c\", \"atp_c\", \"adp_c\", \"pi_c\", \"h2o_c\", \"h_c\", \"nad_c\", \"nadh_c\", \"fa_c\", \"lipid_c\"},\n            \"currency_names\": {\"atp_c\", \"adp_c\", \"pi_c\", \"h2o_c\", \"h_c\", \"nad_c\", \"nadh_c\"},\n            \"k\": 4,\n            \"reactions\": [\n                {\"name\": \"EX_glc__D_e\", \"substrates\": [(\"glc__D_e\", 1)], \"products\": []},\n                {\"name\": \"T_glc_e_c\", \"substrates\": [(\"glc__D_e\", 1)], \"products\": [(\"glc__D_c\", 1)]},\n                {\"name\": \"HK\", \"substrates\": [(\"glc__D_c\", 1), (\"atp_c\", 1)], \"products\": [(\"g6p_c\", 1), (\"adp_c\", 1)]},\n                {\"name\": \"PGI\", \"substrates\": [(\"g6p_c\", 1)], \"products\": [(\"f6p_c\", 1)]},\n                {\"name\": \"GAPDH\", \"substrates\": [(\"f6p_c\", 1), (\"nad_c\", 1)], \"products\": [(\"pyr_c\", 1), (\"nadh_c\", 1)]},\n                {\"name\": \"LDH\", \"substrates\": [(\"pyr_c\", 1), (\"nad_c\", 1)], \"products\": [(\"lac__L_c\", 1), (\"nadh_c\", 1)]},\n                {\"name\": \"T_lac_c_e\", \"substrates\": [(\"lac__L_c\", 1)], \"products\": [(\"lac__L_e\", 1)]},\n                {\"name\": \"FA_synthesis\", \"substrates\": [(\"fa_c\", 1)], \"products\": [(\"lipid_c\", 1)]},\n            ]\n        },\n        # Test case 2 (edge case dominated by currency)\n        {\n            \"metabolites\": {\"A_c\", \"B_c\", \"C_c\", \"ATP_c\", \"ADP_c\", \"NAD_c\", \"NADX_c\", \"H2O_c\", \"H_c\", \"X_e\"},\n            \"currency_names\": {\"ATP_c\", \"ADP_c\", \"NAD_c\", \"NADX_c\", \"H2O_c\", \"H_c\"},\n            \"k\": 2,\n            \"reactions\": [\n                {\"name\": \"R1\", \"substrates\": [(\"A_c\", 1), (\"ATP_c\", 1)], \"products\": [(\"B_c\", 1), (\"ADP_c\", 1)]},\n                {\"name\": \"R2\", \"substrates\": [(\"B_c\", 1), (\"NAD_c\", 1)], \"products\": [(\"C_c\", 1), (\"NADX_c\", 1)]},\n                {\"name\": \"R3\", \"substrates\": [(\"C_c\", 1), (\"H2O_c\", 1)], \"products\": [(\"A_c\", 1), (\"H_c\", 1)]},\n                {\"name\": \"EX_X_e\", \"substrates\": [(\"X_e\", 1)], \"products\": []},\n            ]\n        },\n        # Test case 3 (boundary condition)\n        {\n            \"metabolites\": {\"m1_c\", \"m2_c\", \"m3_e\"},\n            \"currency_names\": set(),\n            \"k\": 1,\n            \"reactions\": [\n                {\"name\": \"T_m3_e_c\", \"substrates\": [(\"m3_e\", 1)], \"products\": [(\"m1_c\", 1)]},\n                {\"name\": \"R1\", \"substrates\": [(\"m1_c\", 1)], \"products\": [(\"m2_c\", 1)]},\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(process_case(case))\n    \n    # Format the final output string to precisely match the required format: [[...],[...]] with no spaces.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\n\ndef process_case(case):\n    \"\"\"\n    Processes a single test case according to the problem description.\n    \"\"\"\n    all_metabolites = case[\"metabolites\"]\n    reactions = case[\"reactions\"]\n    k_threshold = case[\"k\"]\n    explicit_currency_names = case[\"currency_names\"]\n\n    # Step 1: Identify Currency Metabolites (C)\n    # Calculate degree d(i) for each metabolite.\n    metabolite_degrees = collections.defaultdict(int)\n    metabolite_reaction_participation = collections.defaultdict(set)\n    for reaction in reactions:\n        reaction_metabolites = set()\n        for met_name, _ in reaction[\"substrates\"]:\n            reaction_metabolites.add(met_name)\n        for met_name, _ in reaction[\"products\"]:\n            reaction_metabolites.add(met_name)\n        \n        for met_name in reaction_metabolites:\n            metabolite_reaction_participation[met_name].add(reaction[\"name\"])\n    \n    for met_name, participating_reactions in metabolite_reaction_participation.items():\n        metabolite_degrees[met_name] = len(participating_reactions)\n\n    # Determine the full currency set.\n    currency_metabolites = set(explicit_currency_names)\n    for met_name, degree in metabolite_degrees.items():\n        if degree > k_threshold:\n            currency_metabolites.add(met_name)\n\n    # Step 2  3: Define Graph Vertices (V) and Construct Graph (G)\n    graph_vertices = all_metabolites - currency_metabolites\n    adj = {met: set() for met in graph_vertices}\n\n    for reaction in reactions:\n        non_currency_substrates = {\n            met_name for met_name, _ in reaction[\"substrates\"] if met_name in graph_vertices\n        }\n        non_currency_products = {\n            met_name for met_name, _ in reaction[\"products\"] if met_name in graph_vertices\n        }\n        for sub in non_currency_substrates:\n            for prod in non_currency_products:\n                adj[sub].add(prod)\n                adj[prod].add(sub)\n    \n    # Step 4: Identify Boundary Metabolites (B)\n    boundary_metabolites = set()\n    for reaction in reactions:\n        if reaction[\"name\"].startswith(\"EX_\") or reaction[\"name\"].startswith(\"T_\"):\n            for met_name, _ in reaction[\"substrates\"]:\n                if met_name in graph_vertices:\n                    boundary_metabolites.add(met_name)\n            for met_name, _ in reaction[\"products\"]:\n                if met_name in graph_vertices:\n                    boundary_metabolites.add(met_name)\n\n    # Step 5: Find Connected Components\n    visited = set()\n    components = []\n    for met in graph_vertices:\n        if met not in visited:\n            component = set()\n            q = collections.deque([met])\n            visited.add(met)\n            component.add(met)\n            while q:\n                current_met = q.popleft()\n                for neighbor in adj[current_met]:\n                    if neighbor not in visited:\n                        visited.add(neighbor)\n                        component.add(neighbor)\n                        q.append(neighbor)\n            components.append(component)\n    \n    # Step 6  7: Identify Isolated Components and collect sizes\n    isolated_component_sizes = []\n    for component in components:\n        if not component.intersection(boundary_metabolites):\n            isolated_component_sizes.append(len(component))\n            \n    isolated_component_sizes.sort()\n    \n    return [len(isolated_component_sizes)] + isolated_component_sizes\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "A structurally sound model can be used for predictive simulations, with Flux Balance Analysis (FBA) being the cornerstone technique. For eukaryotic systems, accurately representing metabolic compartmentalization is crucial for meaningful predictions. This practice explores how explicitly modeling distinct metabolite pools (e.g., cytosolic vs. mitochondrial) and the transport reactions that connect them can significantly alter predicted metabolic fluxes and cellular objectives, such as ATP production. ",
            "id": "4383433",
            "problem": "A developer is asked to examine how compartment-specific treatment of a shuttle metabolite and explicit transport capacity affect steady-state pathway fluxes and redox coupling in a genome-scale metabolic reconstruction setting. The mathematical base is the law of mass conservation and steady-state balance, which gives the linear constraint $S v = 0$, where $S$ is the stoichiometric matrix and $v$ is the reaction flux vector. The approach is Flux Balance Analysis (FBA), which is formulated as a linear program: maximize a linear objective $c^\\top v$ subject to $S v = 0$ and bound constraints $\\ell \\le v \\le u$. Flux Balance Analysis (FBA) relies on known stoichiometries and the assumption of quasi-steady state for internal metabolites.\n\nYou will construct and compare two small compartmental metabolic models that include cytosolic glycolysis, cytosolic lactate dehydrogenase, pyruvate transport into mitochondria, a simplified tricarboxylic acid cycle producing mitochondrial reduced nicotinamide adenine dinucleotide (NADH), an electron transport chain that uses oxygen to convert reduced nicotinamide adenine dinucleotide (NADH) to adenosine triphosphate (ATP), and a malate-mediated redox shuttle. The first model uses a single compartment version of malate (unsplit malate), implicitly allowing unlimited mixing of redox equivalents via this metabolite. The second model splits malate into cytosolic and mitochondrial forms (explicit compartments), adds an explicit transport reaction for malate with a finite capacity, and recomputes the FBA optimum. Your program must compute how this split and transport capacity change pathway fluxes and the compartmental redox balance.\n\nFundamental base:\n- Conservation of mass at steady state: $S v = 0$.\n- Linear programming objective: maximize $c^\\top v$ as a proxy for cellular performance (here, ATP drain).\n- Exchange reactions are sources or sinks for external metabolites with bounds representing availability or removal.\n- Reaction bounds model reversibility and capacity limits.\n\nModel A (unsplit malate):\n- Metabolites (internal and external): $\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, $\\mathrm{ATP}$.\n- Reactions (with stoichiometry, each coefficient is in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$ units):\n    1. $\\mathrm{EX\\_glc}$: $+\\mathrm{Glc\\_ext}$, bounds $[0, G_{\\max}]$.\n    2. $\\mathrm{EX\\_o2}$: $+\\mathrm{O2\\_ext}$, bounds $[0, O_{\\max}]$.\n    3. $\\mathrm{EX\\_lac}$: $-\\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    4. $\\mathrm{R1\\_Glycolysis}$: $-\\mathrm{Glc\\_ext} + 2\\,\\mathrm{Pyr\\_c} + 2\\,\\mathrm{NADH\\_c} + 2\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    5. $\\mathrm{R2\\_LDH}$: $-\\mathrm{Pyr\\_c} - \\mathrm{NADH\\_c} + \\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    6. $\\mathrm{T\\_pyr}$: $-\\mathrm{Pyr\\_c} + \\mathrm{Pyr\\_m}$, bounds $[0, \\infty)$.\n    7. $\\mathrm{R7\\_TCA}$: $-\\mathrm{Pyr\\_m} + 4\\,\\mathrm{NADH\\_m} + 1\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    8. $\\mathrm{R3\\_MDH\\_c}$: $-\\mathrm{NADH\\_c} + \\mathrm{Mal}$, bounds $[0, \\infty)$.\n    9. $\\mathrm{R4\\_MDH\\_m}$: $-\\mathrm{Mal} + \\mathrm{NADH\\_m}$, bounds $[0, \\infty)$.\n    10. $\\mathrm{R5\\_ETC}$: $-\\mathrm{NADH\\_m} - 0.5\\,\\mathrm{O2\\_ext} + 2.5\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    11. $\\mathrm{ATP\\_drain}$: $-\\mathrm{ATP}$, bounds $[0, \\infty)$; this is the objective reaction to maximize.\n\nModel B (split malate with transport capacity):\n- Metabolites: $\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal\\_c}$, $\\mathrm{Mal\\_m}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, $\\mathrm{ATP}$.\n- Reactions:\n    1. $\\mathrm{EX\\_glc}$: $+\\mathrm{Glc\\_ext}$, bounds $[0, G_{\\max}]$.\n    2. $\\mathrm{EX\\_o2}$: $+\\mathrm{O2\\_ext}$, bounds $[0, O_{\\max}]$.\n    3. $\\mathrm{EX\\_lac}$: $-\\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    4. $\\mathrm{R1\\_Glycolysis}$: $-\\mathrm{Glc\\_ext} + 2\\,\\mathrm{Pyr\\_c} + 2\\,\\mathrm{NADH\\_c} + 2\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    5. $\\mathrm{R2\\_LDH}$: $-\\mathrm{Pyr\\_c} - \\mathrm{NADH\\_c} + \\mathrm{Lac\\_ext}$, bounds $[0, \\infty)$.\n    6. $\\mathrm{T\\_pyr}$: $-\\mathrm{Pyr\\_c} + \\mathrm{Pyr\\_m}$, bounds $[0, \\infty)$.\n    7. $\\mathrm{R7\\_TCA}$: $-\\mathrm{Pyr\\_m} + 4\\,\\mathrm{NADH\\_m} + 1\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    8. $\\mathrm{R3s\\_MDH\\_c}$: $-\\mathrm{NADH\\_c} + \\mathrm{Mal\\_c}$, bounds $[0, \\infty)$.\n    9. $\\mathrm{T\\_mal}$: $-\\mathrm{Mal\\_c} + \\mathrm{Mal\\_m}$, bounds $[0, T_{\\max}]$ (unidirectional capacity).\n    10. $\\mathrm{R4s\\_MDH\\_m}$: $-\\mathrm{Mal\\_m} + \\mathrm{NADH\\_m}$, bounds $[0, \\infty)$.\n    11. $\\mathrm{R5\\_ETC}$: $-\\mathrm{NADH\\_m} - 0.5\\,\\mathrm{O2\\_ext} + 2.5\\,\\mathrm{ATP}$, bounds $[0, \\infty)$.\n    12. $\\mathrm{ATP\\_drain}$: $-\\mathrm{ATP}$, bounds $[0, \\infty)$; objective to maximize.\n\nObjective and constraints:\n- Maximize $\\mathrm{ATP\\_drain}$ flux for each model subject to $S v = 0$ and bounds. This is a linear program solved by minimizing $-v_{\\mathrm{ATP\\_drain}}$ to achieve the maximum, with equality constraints $S v = 0$.\n\nComputed quantities per test case:\n- $\\Delta \\mathrm{ATP} = v_{\\mathrm{ATP\\_drain}}^{\\text{split}} - v_{\\mathrm{ATP\\_drain}}^{\\text{unsplit}}$ in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n- $\\mathrm{ATP\\_unsplit}$ and $\\mathrm{ATP\\_split}$ in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n- Cytosolic lactate dehydrogenase fraction under the split model: $f_{\\mathrm{LDH}}^{\\text{split}} = v_{\\mathrm{R2\\_LDH}}^{\\text{split}} / \\left(2\\, v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}}\\right)$, expressed as a decimal in $[0,1]$; if $v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}} = 0$, define $f_{\\mathrm{LDH}}^{\\text{split}} = 0$.\n- Electron transport chain flux under the split model: $v_{\\mathrm{R5\\_ETC}}^{\\text{split}}$ in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$.\n\nUnits:\n- All fluxes are to be reported in $\\mathrm{mmol}\\,\\mathrm{gDW}^{-1}\\,\\mathrm{h}^{-1}$, expressed as decimal numbers.\n\nTest suite:\n- Case $1$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 10, 5)$.\n- Case $2$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 0, 5)$.\n- Case $3$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (10, 10, 0)$.\n- Case $4$: $(G_{\\max}, O_{\\max}, T_{\\max}) = (1, 10, 1000)$.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of lists, one per test case, where each inner list is $[\\mathrm{ATP\\_unsplit}, \\mathrm{ATP\\_split}, \\Delta \\mathrm{ATP}, f_{\\mathrm{LDH}}^{\\text{split}}, v_{\\mathrm{R5\\_ETC}}^{\\text{split}}]$. The outer list must be printed as a comma-separated list enclosed in square brackets, for example, $[[x_1,x_2,x_3,x_4,x_5],[\\dots],\\dots]$.",
            "solution": "The problem presented is a comparative study of two simplified metabolic models using Flux Balance Analysis (FBA). The objective is to quantify the effects of compartmentalization and transport capacity on metabolic fluxes, specifically on adenosine triphosphate (ATP) production. The problem is scientifically grounded in the principles of stoichiometry and steady-state mass balance, and it is mathematically well-posed as a series of linear programming (LP) problems. All necessary data, including reaction stoichiometries, metabolite lists, and reaction bounds for four separate test cases, are provided. Therefore, the problem is deemed valid and a formal solution can be constructed.\n\nThe core of the problem lies in formulating and solving two distinct LP problems, one for each model (Model A: unsplit malate; Model B: split malate), for each of the four test cases. The general form of the FBA linear program is:\n$$\n\\begin{align*}\n\\text{maximize} \\quad  c^\\top v \\\\\n\\text{subject to} \\quad  S v = 0 \\\\\n \\ell \\le v \\le u\n\\end{align*}\n$$\nwhere $S$ is the stoichiometric matrix, $v$ is the vector of reaction fluxes, $c$ is the objective vector, and $\\ell$ and $u$ are the lower and upper bounds on the fluxes, respectively. The objective is to maximize the flux through the `ATP_drain` reaction, which represents the cell's total ATP production rate. This maximization is achieved by minimizing $-v_{\\mathrm{ATP\\_drain}}$.\n\nFirst, we define Model A (unsplit malate).\nThis model consists of $m=9$ metabolites and $n=11$ reactions. The metabolites are $\\mathrm{Glc\\_ext}$, $\\mathrm{O2\\_ext}$, $\\mathrm{Lac\\_ext}$, $\\mathrm{Mal}$, $\\mathrm{Pyr\\_c}$, $\\mathrm{Pyr\\_m}$, $\\mathrm{NADH\\_c}$, $\\mathrm{NADH\\_m}$, and $\\mathrm{ATP}$. The reactions are indexed as follows:\n$v_0$: $\\mathrm{EX\\_glc}$, $v_1$: $\\mathrm{EX\\_o2}$, $v_2$: $\\mathrm{EX\\_lac}$, $v_3$: $\\mathrm{R1\\_Glycolysis}$, $v_4$: $\\mathrm{R2\\_LDH}$, $v_5$: $\\mathrm{T\\_pyr}$, $v_6$: $\\mathrm{R7\\_TCA}$, $v_7$: $\\mathrm{R3\\_MDH\\_c}$, $v_8$: $\\mathrm{R4\\_MDH\\_m}$, $v_9$: $\\mathrm{R5\\_ETC}$, $v_{10}$: $\\mathrm{ATP\\_drain}$.\n\nThe $9 \\times 11$ stoichiometric matrix $S_A$ is constructed based on the reaction definitions. The rows correspond to the metabolites and the columns to the reactions.\n$$\nS_A = \\begin{pmatrix}\n 1  0  0  -1  0  0  0  0  0  0  0 \\\\\n 0  1  0  0  0  0  0  0  0  -0.5  0 \\\\\n 0  0  -1  0  1  0  0  0  0  0  0 \\\\\n 0  0  0  0  0  0  0  1  -1  0  0 \\\\\n 0  0  0  2  -1  -1  0  0  0  0  0 \\\\\n 0  0  0  0  0  1  -1  0  0  0  0 \\\\\n 0  0  0  2  -1  0  0  -1  0  0  0 \\\\\n 0  0  0  0  0  0  4  0  1  -1  0 \\\\\n 0  0  0  2  0  0  1  0  0  2.5  -1\n\\end{pmatrix}\n$$\nThe flux bounds are $\\ell_i = 0$ for all reactions $i$. The upper bounds $u_i$ are infinite for all reactions except for $v_0$ ($\\mathrm{EX\\_glc}$) and $v_1$ ($\\mathrm{EX\\_o2}$), which are constrained by $u_0 = G_{\\max}$ and $u_1 = O_{\\max}$, respectively. The objective vector $c_A$ is a vector of zeros with a $1$ at the position corresponding to $v_{10}$ ($\\mathrm{ATP\\_drain}$).\n\nNext, we define Model B (split malate with transport capacity).\nThis model is more detailed, with $m=10$ metabolites and $n=12$ reactions. Malate is split into cytosolic ($\\mathrm{Mal\\_c}$) and mitochondrial ($\\mathrm{Mal\\_m}$) pools, and an explicit transport reaction, $\\mathrm{T\\_mal}$, is introduced. The reactions are indexed as:\n$v_0$: $\\mathrm{EX\\_glc}$, $v_1$: $\\mathrm{EX\\_o2}$, $v_2$: $\\mathrm{EX\\_lac}$, $v_3$: $\\mathrm{R1\\_Glycolysis}$, $v_4$: $\\mathrm{R2\\_LDH}$, $v_5$: $\\mathrm{T\\_pyr}$, $v_6$: $\\mathrm{R7\\_TCA}$, $v_7$: $\\mathrm{R3s\\_MDH\\_c}$, $v_8$: $\\mathrm{T\\_mal}$, $v_9$: $\\mathrm{R4s\\_MDH\\_m}$, $v_{10}$: $\\mathrm{R5\\_ETC}$, $v_{11}$: $\\mathrm{ATP\\_drain}$.\n\nThe $10 \\times 12$ stoichiometric matrix $S_B$ is:\n$$\nS_B = \\begin{pmatrix}\n 1  0  0  -1  0  0  0  0  0  0  0  0 \\\\\n 0  1  0  0  0  0  0  0  0  0  -0.5  0 \\\\\n 0  0  -1  0  1  0  0  0  0  0  0  0 \\\\\n 0  0  0  0  0  0  0  1  -1  0  0  0 \\\\\n 0  0  0  0  0  0  0  0  1  -1  0  0 \\\\\n 0  0  0  2  -1  -1  0  0  0  0  0  0 \\\\\n 0  0  0  0  0  1  -1  0  0  0  0  0 \\\\\n 0  0  0  2  -1  0  0  -1  0  0  0  0 \\\\\n 0  0  0  0  0  0  4  0  0  1  -1  0 \\\\\n 0  0  0  2  0  0  1  0  0  0  2.5  -1\n\\end{pmatrix}\n$$\nThe flux lower bounds are again $\\ell_i=0$ for all reactions. The upper bounds $u_i$ are infinite except for $u_0 = G_{\\max}$, $u_1 = O_{\\max}$, and $u_8 = T_{\\max}$ (for the $\\mathrm{T\\_mal}$ transporter). The objective vector $c_B$ is a vector of zeros with a $1$ at the position for $v_{11}$ ($\\mathrm{ATP\\_drain}$).\n\nFor each of the four test cases defined by the tuple $(G_{\\max}, O_{\\max}, T_{\\max})$, the following procedure is executed:\n1. The LP problem for Model A is solved using the corresponding $G_{\\max}$ and $O_{\\max}$ values to obtain the optimal flux vector $v^{\\text{unsplit}}$. The optimal objective value gives $\\mathrm{ATP\\_unsplit} = v_{\\mathrm{ATP\\_drain}}^{\\text{unsplit}}$.\n2. The LP problem for Model B is solved using the corresponding $G_{\\max}$, $O_{\\max}$, and $T_{\\max}$ values to obtain the optimal flux vector $v^{\\text{split}}$.\n3. The following quantities are calculated from the solution vectors:\n   - $\\mathrm{ATP\\_split} = v_{\\mathrm{ATP\\_drain}}^{\\text{split}}$ (from $v^{\\text{split}}$ at index $11$).\n   - $\\Delta \\mathrm{ATP} = \\mathrm{ATP\\_split} - \\mathrm{ATP\\_unsplit}$.\n   - $v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}}$ (from $v^{\\text{split}}$ at index $3$) and $v_{\\mathrm{R2\\_LDH}}^{\\text{split}}$ (from $v^{\\text{split}}$ at index $4$) are used to compute the cytosolic lactate dehydrogenase fraction, $f_{\\mathrm{LDH}}^{\\text{split}} = v_{\\mathrm{R2\\_LDH}}^{\\text{split}} / (2 \\cdot v_{\\mathrm{R1\\_Glycolysis}}^{\\text{split}})$, which is defined as $0$ if the denominator is $0$.\n   - $v_{\\mathrm{R5\\_ETC}}^{\\text{split}}$ is extracted from $v^{\\text{split}}$ at index $10$.\n4. The five computed values, $[\\mathrm{ATP\\_unsplit}, \\mathrm{ATP\\_split}, \\Delta \\mathrm{ATP}, f_{\\mathrm{LDH}}^{\\text{split}}, v_{\\mathrm{R5\\_ETC}}^{\\text{split}}]$, are collected for each test case.\n\nThis procedure is implemented programmatically, utilizing `scipy.optimize.linprog` to solve the linear programs. The final output is an aggregation of the results from all four test cases, formatted as a list of lists.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Constructs and solves two Flux Balance Analysis (FBA) problems,\n    Model A (unsplit malate) and Model B (split malate), for four\n    different test cases to analyze the effect of compartmentalization\n    and transport capacity on metabolic fluxes.\n    \"\"\"\n\n    test_cases = [\n        # (G_max, O_max, T_max)\n        (10, 10, 5),\n        (10, 0, 5),\n        (10, 10, 0),\n        (1, 10, 1000),\n    ]\n\n    # --- Model A: Unsplit Malate ---\n    # Metabolites (9): Glc_ext, O2_ext, Lac_ext, Mal, Pyr_c, Pyr_m, NADH_c, NADH_m, ATP\n    # Reactions (11): EX_glc, EX_o2, EX_lac, R1, R2, T_pyr, R7, R3, R4, R5, ATP_drain\n    S_A = np.array([\n        # EXg, EXo, EXl,  R1,  R2, T pyr, R7, R3,  R4,   R5,   AD\n        [1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Glc_ext\n        [0.0, 1.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0, 0.0, -0.5, 0.0], # O2_ext\n        [0.0, 0.0, -1.0, 0.0, 1.0,  0.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Lac_ext\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 1.0, -1.0, 0.0, 0.0], # Mal\n        [0.0, 0.0, 0.0,  2.0, -1.0, -1.0, 0.0, 0.0, 0.0,  0.0, 0.0], # Pyr_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  1.0, -1.0, 0.0, 0.0,  0.0, 0.0], # Pyr_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0], # NADH_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 4.0, 0.0,  1.0, -1.0, 0.0], # NADH_m\n        [0.0, 0.0, 0.0,  2.0, 0.0,  0.0, 1.0, 0.0,  0.0,  2.5, -1.0] # ATP\n    ])\n    num_fluxes_A = S_A.shape[1]\n    c_A = np.zeros(num_fluxes_A)\n    c_A[10] = -1.0  # Maximize ATP_drain (index 10) by minimizing its negative\n    b_eq_A = np.zeros(S_A.shape[0])\n\n    # --- Model B: Split Malate ---\n    # Metabolites (10): Glc_ext, O2_ext, Lac_ext, Mal_c, Mal_m, Pyr_c, Pyr_m, NADH_c, NADH_m, ATP\n    # Reactions (12): EX_glc, EX_o2, EX_lac, R1, R2, T_pyr, R7, R3s, T_mal, R4s, R5, ATP_drain\n    S_B = np.array([\n        # EXg, EXo, EXl,  R1,  R2, T pyr, R7, R3s,T mal, R4s,   R5,   AD\n        [1.0, 0.0, 0.0, -1.0, 0.0,  0.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Glc_ext\n        [0.0, 1.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0, 0.0, 0.0, -0.5,  0.0], # O2_ext\n        [0.0, 0.0, -1.0, 0.0, 1.0,  0.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Lac_ext\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 1.0, -1.0, 0.0,  0.0,  0.0], # Mal_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 0.0, 0.0,  1.0, -1.0, 0.0,  0.0], # Mal_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, -1.0, 0.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Pyr_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  1.0, -1.0, 0.0, 0.0, 0.0,  0.0,  0.0], # Pyr_m\n        [0.0, 0.0, 0.0,  2.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0,  0.0,  0.0], # NADH_c\n        [0.0, 0.0, 0.0,  0.0, 0.0,  0.0, 4.0, 0.0,  0.0, 1.0, -1.0,  0.0], # NADH_m\n        [0.0, 0.0, 0.0,  2.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0,  2.5, -1.0] # ATP\n    ])\n    num_fluxes_B = S_B.shape[1]\n    c_B = np.zeros(num_fluxes_B)\n    c_B[11] = -1.0  # Maximize ATP_drain (index 11)\n    b_eq_B = np.zeros(S_B.shape[0])\n\n    results = []\n    \n    TOL = 1e-9 # Tolerance for floating point comparisons\n\n    for G_max, O_max, T_max in test_cases:\n        # Solve for Model A\n        bounds_A = [(0, None)] * num_fluxes_A\n        bounds_A[0] = (0, G_max)  # EX_glc\n        bounds_A[1] = (0, O_max)  # EX_o2\n        res_A = linprog(c=c_A, A_eq=S_A, b_eq=b_eq_A, bounds=bounds_A, method='highs')\n        \n        fluxes_A = res_A.x if res_A.success else np.zeros(num_fluxes_A)\n        atp_unsplit = fluxes_A[10] if fluxes_A[10] > TOL else 0.0\n\n        # Solve for Model B\n        bounds_B = [(0, None)] * num_fluxes_B\n        bounds_B[0] = (0, G_max)  # EX_glc\n        bounds_B[1] = (0, O_max)  # EX_o2\n        bounds_B[8] = (0, T_max)  # T_mal\n        res_B = linprog(c=c_B, A_eq=S_B, b_eq=b_eq_B, bounds=bounds_B, method='highs')\n\n        fluxes_B = res_B.x if res_B.success else np.zeros(num_fluxes_B)\n\n        # Calculate required quantities\n        atp_split = fluxes_B[11] if fluxes_B[11] > TOL else 0.0\n        delta_atp = atp_split - atp_unsplit\n        \n        v_r1_split = fluxes_B[3] # R1_Glycolysis\n        v_r2_split = fluxes_B[4] # R2_LDH\n        \n        denominator = 2 * v_r1_split\n        if denominator > TOL:\n            f_ldh_split = v_r2_split / denominator\n        else:\n            f_ldh_split = 0.0\n            \n        v_r5_etc_split = fluxes_B[10] if fluxes_B[10] > TOL else 0.0\n        \n        # Collect and format results\n        case_results = [\n            round(atp_unsplit, 5),\n            round(atp_split, 5),\n            round(delta_atp, 5),\n            round(f_ldh_split, 5),\n            round(v_r5_etc_split, 5)\n        ]\n        results.append(case_results)\n\n    # Format final output string\n    inner_results_str = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(inner_results_str)}]\")\n\nsolve()\n```"
        }
    ]
}