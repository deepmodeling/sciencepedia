{
    "hands_on_practices": [
        {
            "introduction": "基因组尺度代谢模型（GEM）的基石是单个的生化反应。对每一个反应而言，质量守恒和电荷守恒是必须严格遵守的基本物理化学原理。本练习将引导你审计一个反应的化学计量，这是一个在模型构建和修正过程中的关键常规任务，以确保在进行任何模拟分析之前模型的物理化学有效性。",
            "id": "4383604",
            "problem": "基因组尺度代谢模型（GEM）用明确的化学计量系数表示在特定细胞区室中代谢物的生化反应，并要求严格的质量和电荷守恒。考虑人体细胞中的胞质碳酸酐酶反应，该反应在模型中被错误地编码为\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}},\n$$\n其中下标 $\\mathrm{c}$ 和 $\\mathrm{m}$ 分别表示胞质区室和线粒体区室。在生理pH值下，使用以下代谢物分子式和净电荷：\n- $\\mathrm{CO_2}$：分子式 $C_1O_2$，净电荷 $0$。\n- $\\mathrm{H_2O}$：分子式 $H_2O_1$，净电荷 $0$。\n- $\\mathrm{HCO_3^-}$：分子式 $C_1H_1O_3$，净电荷 $-1$。\n- $\\mathrm{H^+}$：分子式 $H_1$，净电荷 $+1$。\n\n从质量守恒（反应前后每种元素的数量守恒）和电荷守恒（反应物和产物的电荷代数和必须相等）的基本原理出发，对给定反应进行质量和电荷审计。由于纯粹的酶促转化不会使物质跨区室转运，首先通过将 $\\mathrm{H_2O}$ 置于胞质区室来纠正水的区室分配。然后，确定在产物侧分配给 $\\mathrm{H^+}_{\\mathrm{c}}$ 的单一化学计量系数 $n$，使得在修正后的胞质反应中质量和电荷均守恒：\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}.\n$$\n请提供 $n$ 的值作为最终答案。不需要单位。最终答案必须是单个实数值。如果计算出非整数值，请不要四舍五入，报告精确值。如果计算出整数值，请准确报告。",
            "solution": "根据科学合理性、一致性和可形式化原则，对所述问题进行验证。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- **初始反应（不正确）：** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{m}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}}$\n- **区室定义：** $\\mathrm{c}$ 代表胞质，$\\mathrm{m}$ 代表线粒体。\n- **代谢物性质（在生理pH值下）：**\n  - $\\mathrm{CO_2}$：分子式 $C_1O_2$，净电荷 $0$。\n  - $\\mathrm{H_2O}$：分子式 $H_2O_1$，净电荷 $0$。\n  - $\\mathrm{HCO_3^-}$：分子式 $C_1H_1O_3$，净电荷 $-1$。\n  - $\\mathrm{H^+}$：分子式 $H_1$，净电荷 $+1$。\n- **修正说明：**\n  1. 该反应是纯粹的酶促反应，不涉及物质转运；因此，$\\mathrm{H_2O}$ 必须分配到胞质区室，即 $\\mathrm{H_2O_c}$。\n  2. 必须通过在产物侧引入一个质子 $\\mathrm{H^+_c}$（其化学计量系数 $n$ 未知）来平衡反应的质量和电荷。\n- **待平衡的最终反应形式：** $\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}$。\n\n**步骤2：验证提取的已知条件**\n- **科学依据：** 该问题围绕碳酸酐酶反应展开，这是一个基本的生化过程。它正确地应用了质量守恒和电荷守恒原理，这些是化学和物理学中不可违背的定律。基因组尺度代谢模型（GEM）和区室化的背景是系统生物学领域的核心。该问题的前提是科学合理的。\n- **适定性：** 该问题提供了确定单一未知变量 $n$ 所需的所有信息（原子组成、电荷以及修正后反应的结构形式）。这种结构导向一个唯一且稳定的解。\n- **客观性：** 该问题使用精确的化学和数学术语进行陈述，没有歧义、主观性或个人观点。\n\n**步骤3：结论与行动**\n- **结论：** 问题有效。它具有科学依据，是适定的，并且内部一致。\n- **行动：** 开始求解。\n\n**解题推导**\n\n任何有效的生化反应都必须遵循基本原理：各元素质量守恒和总电荷守恒。本题要求我们找到质子 $\\mathrm{H^+_c}$ 的化学计量系数 $n$，以满足胞质碳酸酐酶反应的这些原理。\n\n需要平衡的修正后反应为：\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + n\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\n由于所有物质都位于同一个胞质区室（$\\mathrm{c}$），在进行平衡计算时可以省略区室标签而不失一般性。因此，反应的化学计量关系如下：\n$$\n1\\,\\mathrm{CO_2} + 1\\,\\mathrm{H_2O} \\rightarrow 1\\,\\mathrm{HCO_3^-} + n\\,\\mathrm{H^+}\n$$\n我们现在将对每种元素（碳、氧、氢）以及净电荷进行审计。\n\n**1. 质量平衡审计：**\n\n让我们将方程式反应物侧和产物侧每种元素的原子数量制成表格。\n\n- **碳 (C)：**\n  - 反应物：$1$ 个原子来自 $\\mathrm{CO_2}$（分子式 $C_1O_2$）。\n  - 产物：$1$ 个原子来自 $\\mathrm{HCO_3^-}$（分子式 $C_1H_1O_3$）。\n  - 平衡方程为 $1 = 1$。此方程已满足，但未对 $n$ 提供任何约束。\n\n- **氧 (O)：**\n  - 反应物：$2$ 个原子来自 $\\mathrm{CO_2}$ + $1$ 个原子来自 $\\mathrm{H_2O}$（分子式 $H_2O_1$）。总数为 $2 + 1 = 3$。\n  - 产物：$3$ 个原子来自 $\\mathrm{HCO_3^-}$。\n  - 平衡方程为 $3 = 3$。此方程也已满足，同样未对 $n$ 提供任何约束。\n\n- **氢 (H)：**\n  - 反应物：$2$ 个原子来自 $\\mathrm{H_2O}$（分子式 $H_2O_1$）。\n  - 产物：$1$ 个原子来自 $\\mathrm{HCO_3^-}$ + $n \\times 1$ 个原子来自 $n\\,\\mathrm{H^+}$（分子式 $H_1$）。总数为 $1 + n$。\n  - 为实现质量守恒，两侧的氢原子数必须相等：\n  $$\n  2 = 1 + n\n  $$\n\n**2. 电荷平衡审计：**\n\n接下来，我们平衡净电荷。\n\n- **反应物：**\n  - $\\mathrm{CO_2}$ 的电荷为 $0$。\n  - $\\mathrm{H_2O}$ 的电荷为 $0$。\n  - 反应物侧的总电荷为 $0 + 0 = 0$。\n\n- **产物：**\n  - $\\mathrm{HCO_3^-}$ 的电荷为 $-1$。\n  - $n\\,\\mathrm{H^+}$ 贡献的总电荷为 $n \\times (+1) = +n$。\n  - 产物侧的总电荷为 $-1 + n$。\n\n- 为实现电荷守恒，两侧的净电荷必须相等：\n  $$\n  0 = -1 + n\n  $$\n\n**3. 求解 $n$：**\n\n我们为未知系数 $n$ 推导出了两个独立的方程。一个一致的问题表述必须从这两个方程中得出相同的 $n$ 值。\n\n根据氢原子质量守恒：\n$$\n2 = 1 + n \\implies n = 2 - 1 = 1\n$$\n根据电荷守恒：\n$$\n0 = -1 + n \\implies n = 1\n$$\n两个方程均得出一致的结果 $n=1$。这证实了该方法的正确性以及问题的适定性。\n\n因此，胞质中化学计量正确且电荷平衡的碳酸酐酶反应为：\n$$\n\\mathrm{CO_2}_{\\mathrm{c}} + \\mathrm{H_2O}_{\\mathrm{c}} \\rightarrow \\mathrm{HCO_3^-}_{\\mathrm{c}} + 1\\,\\mathrm{H^+}_{\\mathrm{c}}\n$$\n化学计量系数 $n$ 的值为 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "为了模拟细胞生长，基因组尺度代谢模型需要一个特殊的“生物质目标函数”（BOF）。这个伪反应以精确的比例消耗前体代谢物（如氨基酸、核苷酸、脂质等），以合成一克细胞干重。本练习将展示如何将关于细胞大分子组成的实验数据，转化为生物质反应中的化学计量系数，这是针对特定生物体和生长条件定制模型的关键一步。",
            "id": "4383603",
            "problem": "在平衡指数生长条件下生长的某微生物物种，其大分子组成已按克干重（gDW）基准测定。您正在为一个基因组尺度代谢模型构建一个生物质伪反应，其中生物质产物代表产生的一克干重。在此模型中，您使用聚合残基伪代谢物来表示大分子，这些伪代谢物的分子量已经校正了聚合过程中失去的水的质量。该生物质伪反应应以精确反映测得组成的量消耗这些伪代谢物，并且化学计量系数的单位必须是毫摩尔每克干重（mmol/gDW）。\n\n已知：\n- 大分子类别的质量分数（克/克干重）：\n  - 蛋白质：$0.55$\n  - 核糖核酸（RNA）：$0.20$\n  - 脱氧核糖核酸（DNA）：$0.03$\n  - 脂质（集总）：$0.12$\n  - 碳水化合物（聚糖，以聚合葡萄糖残基形式）：$0.10$\n- 聚合残基的分子量（克/摩尔）：\n  - 平均氨基酸残基（Protein_res）：$110$\n  - 核糖核苷酸单磷酸残基（rNMP_res）：$324$\n  - 脱氧核糖核苷酸单磷酸残基（dNMP_res）：$308$\n  - 集总脂质单元（Lipid_unit）：$700$\n  - 脱水葡萄糖残基（Glycan_res）：$162$\n\n任务：\n1. 从质量守恒和物质的量的定义出发，为每种聚合残基伪代谢物 $i$ 推导其化学计量系数 $s_{i}$（单位为 mmol/gDW）的通用表达式，该表达式是其质量分数 $f_{i}$（单位为 g/gDW）和其聚合残基分子量 $M_{i}$（单位为 g/mol）的函数。当产生1克干重生物质时，系数 $s_{i}$ 应为负值以表示消耗。\n2. 使用给定数据，计算伪代谢物 Protein_res、rNMP_res、dNMP_res、Lipid_unit 和 Glycan_res 的五个化学计量系数。在您报告的答案中，不要包含任何能量辅因子或无机副产物，也不要包含生物质产物项。\n\n将您的最终答案报告为一个包含五个化学计量系数的单行向量，顺序为 [Protein_res, rNMP_res, dNMP_res, Lipid_unit, Glycan_res]。在适当时，将精确值表示为最简分数。单位是毫摩尔每克干重，但不要在最终向量中包含单位。",
            "solution": "该问题是有效的，因为它具有科学依据、提法恰当、客观、自洽且一致。所提供的数据对于一个微生物系统是合理的，并且足以得出一个完整、唯一的解。质量分数的总和为 $0.55 + 0.20 + 0.03 + 0.12 + 0.10 = 1.00$，这证实了组成数据的一致性。我们将继续进行求解。\n\n该问题分为两个任务：首先，推导化学计量系数的通用表达式；其次，计算它们的具体值。\n\n**任务1：化学计量系数 $s_i$ 的通用表达式推导**\n\n生物质伪反应表示消耗前体代谢物以产生1克干重（gDW）的生物质。对于给定的前体伪代谢物 $i$，反应可以写成：\n$$\n\\dots + s_i \\cdot \\text{Metabolite}_i + \\dots \\longrightarrow 1 \\cdot \\text{Biomass}\n$$\n在此表达式中，化学计量系数 $s_i$ 代表每单位产生的生物质所消耗的代谢物 $i$ 的摩尔数（或毫摩尔数）。根据代谢建模的惯例，反应物（消耗的物质）的系数为负，而产物（生成的物质）的系数为正。问题规定 $s_i$ 的单位为毫摩尔每克干重（mmol/gDW）。\n\n设 $f_i$ 为生物质中大分子类别 $i$ 的质量分数，单位为组分 $i$ 的克数每克总干重（g/gDW）。要产生1克干重的生物质，必须合成质量为 $m_i$ 的组分 $i$。该质量由下式给出：\n$$\nm_i = f_i \\cdot (1 \\text{ gDW}) = f_i \\text{ [g]}\n$$\n组分 $i$ 的物质的量（单位为摩尔），记为 $n_i$，与其质量 $m_i$ 和分子量 $M_i$ 相关。问题提供了 $M_i$ 的单位为克每摩尔（g/mol）。关系式为：\n$$\nn_i = \\frac{m_i}{M_i}\n$$\n代入 $m_i$ 的表达式：\n$$\nn_i = \\frac{f_i}{M_i}\n$$\n$n_i$ 的单位是 $\\frac{\\text{g/gDW}}{\\text{g/mol}} = \\frac{\\text{mol}}{\\text{gDW}}$。这给出了生产1克干重生物质所需的组分 $i$ 的摩尔量。\n\n问题要求化学计量系数 $s_i$ 的单位为毫摩尔每克干重（mmol/gDW）。为了从摩尔转换为毫摩尔，我们使用转换因子 $1 \\text{ mol} = 1000 \\text{ mmol}$。\n$$\n|s_i| = n_i \\cdot 1000 \\left[\\frac{\\text{mmol}}{\\text{mol}}\\right] = \\frac{1000 \\cdot f_i}{M_i}\n$$\n$|s_i|$ 的单位是 $\\left[\\frac{\\text{mol}}{\\text{gDW}}\\right] \\cdot \\left[\\frac{\\text{mmol}}{\\text{mol}}\\right] = \\left[\\frac{\\text{mmol}}{\\text{gDW}}\\right]$，这符合要求。\n\n最后，由于组分 $i$ 是反应物（被消耗），其化学计量系数必须为负。因此，$s_i$ 的通用表达式是：\n$$\ns_i = -\\frac{1000 \\cdot f_i}{M_i}\n$$\n其中 $f_i$ 的单位是 g/gDW，$M_i$ 的单位是 g/mol。\n\n**任务2：化学计量系数的计算**\n\n我们现在应用这个推导出的公式，使用所提供的数据来计算五个所要求的化学计量系数。\n\n1.  **Protein_res（氨基酸残基）：**\n    $f_{\\text{protein}} = 0.55$ g/gDW\n    $M_{\\text{protein\\_res}} = 110$ g/mol\n    $$\n    s_{\\text{protein\\_res}} = -\\frac{1000 \\times 0.55}{110} = -\\frac{550}{110} = -5\n    $$\n\n2.  **rNMP_res（用于RNA的核糖核苷酸残基）：**\n    $f_{\\text{RNA}} = 0.20$ g/gDW\n    $M_{\\text{rNMP\\_res}} = 324$ g/mol\n    $$\n    s_{\\text{rNMP\\_res}} = -\\frac{1000 \\times 0.20}{324} = -\\frac{200}{324} = -\\frac{100}{162} = -\\frac{50}{81}\n    $$\n\n3.  **dNMP_res（用于DNA的脱氧核糖核苷酸残基）：**\n    $f_{\\text{DNA}} = 0.03$ g/gDW\n    $M_{\\text{dNMP\\_res}} = 308$ g/mol\n    $$\n    s_{\\text{dNMP\\_res}} = -\\frac{1000 \\times 0.03}{308} = -\\frac{30}{308} = -\\frac{15}{154}\n    $$\n\n4.  **Lipid_unit（集总脂质单元）：**\n    $f_{\\text{lipid}} = 0.12$ g/gDW\n    $M_{\\text{lipid\\_unit}} = 700$ g/mol\n    $$\n    s_{\\text{lipid\\_unit}} = -\\frac{1000 \\times 0.12}{700} = -\\frac{120}{700} = -\\frac{12}{70} = -\\frac{6}{35}\n    $$\n\n5.  **Glycan_res（用于碳水化合物的脱水葡萄糖残基）：**\n    $f_{\\text{carb}} = 0.10$ g/gDW\n    $M_{\\text{glycan\\_res}} = 162$ g/mol\n    $$\n    s_{\\text{glycan\\_res}} = -\\frac{1000 \\times 0.10}{162} = -\\frac{100}{162} = -\\frac{50}{81}\n    $$\n\n只考虑这些大分子前体，最终的生物质伪反应将是：\n$$\n5 \\text{ Protein\\_res} + \\frac{50}{81} \\text{ rNMP\\_res} + \\frac{15}{154} \\text{ dNMP\\_res} + \\frac{6}{35} \\text{ Lipid\\_unit} + \\frac{50}{81} \\text{ Glycan\\_res} \\longrightarrow 1 \\text{ Biomass}\n$$\n最终答案中报告的化学计量系数必须是计算出的负值。按要求的顺序 [Protein_res, rNMP_res, dNMP_res, Lipid_unit, Glycan_res]，这五个系数是 $[-5, -\\frac{50}{81}, -\\frac{15}{154}, -\\frac{6}{35}, -\\frac{50}{81}]$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -5 & -\\frac{50}{81} & -\\frac{15}{154} & -\\frac{6}{35} & -\\frac{50}{81} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个代谢网络的重建草图通常会存在缺口，即缺失的反应会导致“断头路”代谢物或不连通的代谢途径。对网络图进行拓扑分析是识别这些结构性问题的有效方法。本练习将介绍一种诊断模型不完整性的计算方法，通过将网络表示为图、移除普遍存在的“货币代谢物”并寻找孤立的连通组件，你可以系统地定位模型中需要进一步修正的区域，例如补充缺失的转运或酶促反应。",
            "id": "4383591",
            "problem": "给定一个由代谢物和反应组成的基因组尺度代谢网络的表示。其重构原理是：化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 为每个代谢物 $i \\in \\{1,\\dots,m\\}$ 和每个反应 $j \\in \\{1,\\dots,n\\}$ 编码了一个化学计量系数 $S_{ij}$，其中 $S_{ij} > 0$ 表示在反应 $j$ 中生成代谢物 $i$，而 $S_{ij} < 0$ 表示消耗。在代谢物和反应之间构成的二分图中，一个反应将底物连接到产物。为了分析与系统生物医学相关的结构连通性，通常会移除作为普遍存在的辅因子的通用代谢物，以避免虚假连通性。\n\n基于这些基本定义，如下定义一个无向代谢物图 $G = (V,E)$：\n- 顶点集 $V$ 包含所有出现在至少一个反应中的非通用代谢物。\n- 对于每个反应 $j$，令 $\\mathcal{S}_j = \\{i \\mid S_{ij} < 0\\}$ 为底物集，$\\mathcal{P}_j = \\{i \\mid S_{ij} > 0\\}$ 为产物集。移除通用代谢物后，对于每一对 $u \\in \\mathcal{S}_j$ 和 $v \\in \\mathcal{P}_j$ 的 $(u,v)$，向 $E$ 中添加一条无向边 $\\{u,v\\}$。\n\n定义通用代谢物集合 $\\mathcal{C}$ 为以下两者的并集：\n- 一个明确提供的通用代谢物名称集合，以及\n- 一个高度集 $\\{i \\in V_{\\text{all}} \\mid d(i) > k\\}$，其中 $d(i)$ 是代谢物 $i$ （在移除通用代谢物之前）作为底物或产物参与的不同反应的数量，而 $k$ 是一个给定的整数阈值。\n\n交换反应和转运反应提供了与环境或区室之间的边界连通性。令 $\\mathcal{B}$ 为参与任何交换反应或转运反应的非通用代谢物集合。如果一个连通分量 $C \\subseteq V$ 满足 $C \\cap \\mathcal{B} = \\emptyset$，则称其为孤立的。\n\n您的任务是计算移除通用代谢物后图 $G$ 的连通分量，并识别出孤立的子网络。对于每个测试用例，输出一个整数列表，其中第一个整数是孤立分量的数量，后面是每个孤立分量的大小，按升序排列。\n\n输入表示被抽象为结构化参数，而非显式的矩阵 $S$。每个反应 $j$ 由其名称和两个列表（底物和产物）指定。每个底物或产物都是一个配对 $(\\text{name}, \\text{coefficient})$，其中系数是一个正整数，对应于 $|S_{ij}|$；其符号由其作为底物或产物的角色所隐含。名称以前缀 $\"EX\\_\"$ 开始的反应表示交换反应，名称以前缀 $\"T\\_\"$ 开始的反应表示转运反应。\n\n您必须按照上述描述实现图 $G$ 的构建和孤立分量的识别，并严格遵守上述数学定义。\n\n测试套件：\n- 测试用例 1 (一般情况):\n  - 代谢物: $\\{\\text{\"glc\\_\\_D\\_e\"}, \\text{\"glc\\_\\_D\\_c\"}, \\text{\"g6p\\_c\"}, \\text{\"f6p\\_c\"}, \\text{\"pyr\\_c\"}, \\text{\"lac\\_\\_L\\_e\"}, \\text{\"lac\\_\\_L\\_c\"}, \\text{\"atp\\_c\"}, \\text{\"adp\\_c\"}, \\text{\"pi\\_c\"}, \\text{\"h2o\\_c\"}, \\text{\"h\\_c\"}, \\text{\"nad\\_c\"}, \\text{\"nadh\\_c\"}, \\text{\"fa\\_c\"}, \\text{\"lipid\\_c\"}\\}$。\n  - 通用代谢物名称: $\\{\\text{\"atp\\_c\"}, \\text{\"adp\\_c\"}, \\text{\"pi\\_c\"}, \\text{\"h2o\\_c\"}, \\text{\"h\\_c\"}, \\text{\"nad\\_c\"}, \\text{\"nadh\\_c\"}\\}$。\n  - 度阈值 $k = 4$。\n  - 反应:\n    - $\\text{\"EX\\_glc\\_\\_D\\_e\"}$: 底物 $\\{(\\text{\"glc\\_\\_D\\_e\"}, 1)\\}$，产物 $\\{\\}$。\n    - $\\text{\"T\\_glc\\_e\\_c\"}$: 底物 $\\{(\\text{\"glc\\_\\_D\\_e\"}, 1)\\}$，产物 $\\{(\\text{\"glc\\_\\_D\\_c\"}, 1)\\}$。\n    - $\\text{\"HK\"}$: 底物 $\\{(\\text{\"glc\\_\\_D\\_c\"}, 1), (\\text{\"atp\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"g6p\\_c\"}, 1), (\\text{\"adp\\_c\"}, 1)\\}$。\n    - $\\text{\"PGI\"}$: 底物 $\\{(\\text{\"g6p\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"f6p\\_c\"}, 1)\\}$。\n    - $\\text{\"GAPDH\"}$: 底物 $\\{(\\text{\"f6p\\_c\"}, 1), (\\text{\"nad\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"pyr\\_c\"}, 1), (\\text{\"nadh\\_c\"}, 1)\\}$。\n    - $\\text{\"LDH\"}$: 底物 $\\{(\\text{\"pyr\\_c\"}, 1), (\\text{\"nad\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"lac\\_\\_L\\_c\"}, 1), (\\text{\"nadh\\_c\"}, 1)\\}$。\n    - $\\text{\"T\\_lac\\_c\\_e\"}$: 底物 $\\{(\\text{\"lac\\_\\_L\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"lac\\_\\_L\\_e\"}, 1)\\}$。\n    - $\\text{\"FA\\_synthesis\"}$: 底物 $\\{(\\text{\"fa\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"lipid\\_c\"}, 1)\\}$。\n- 测试用例 2 (由通用代谢物主导的边界情况；移除后出现孤立):\n  - 代谢物: $\\{\\text{\"A\\_c\"}, \\text{\"B\\_c\"}, \\text{\"C\\_c\"}, \\text{\"ATP\\_c\"}, \\text{\"ADP\\_c\"}, \\text{\"NAD\\_c\"}, \\text{\"NADX\\_c\"}, \\text{\"H2O\\_c\"}, \\text{\"H\\_c\"}, \\text{\"X\\_e\"}\\}$。\n  - 通用代谢物名称: $\\{\\text{\"ATP\\_c\"}, \\text{\"ADP\\_c\"}, \\text{\"NAD\\_c\"}, \\text{\"NADX\\_c\"}, \\text{\"H2O\\_c\"}, \\text{\"H\\_c\"}\\}$。\n  - 度阈值 $k = 2$。\n  - 反应:\n    - $\\text{\"R1\"}$: 底物 $\\{(\\text{\"A\\_c\"}, 1), (\\text{\"ATP\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"B\\_c\"}, 1), (\\text{\"ADP\\_c\"}, 1)\\}$。\n    - $\\text{\"R2\"}$: 底物 $\\{(\\text{\"B\\_c\"}, 1), (\\text{\"NAD\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"C\\_c\"}, 1), (\\text{\"NADX\\_c\"}, 1)\\}$。\n    - $\\text{\"R3\"}$: 底物 $\\{(\\text{\"C\\_c\"}, 1), (\\text{\"H2O\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"A\\_c\"}, 1), (\\text{\"H\\_c\"}, 1)\\}$。\n    - $\\text{\"EX\\_X\\_e\"}$: 底物 $\\{(\\text{\"X\\_e\"}, 1)\\}$，产物 $\\{\\}$。\n- 测试用例 3 (边界条件；无通用辅因子时完全连通):\n  - 代谢物: $\\{\\text{\"m1\\_c\"}, \\text{\"m2\\_c\"}, \\text{\"m3\\_e\"}\\}$。\n  - 通用代谢物名称: $\\{\\}$。\n  - 度阈值 $k = 1$。\n  - 反应:\n    - $\\text{\"T\\_m3\\_e\\_c\"}$: 底物 $\\{(\\text{\"m3\\_e\"}, 1)\\}$，产物 $\\{(\\text{\"m1\\_c\"}, 1)\\}$。\n    - $\\text{\"R1\"}$: 底物 $\\{(\\text{\"m1\\_c\"}, 1)\\}$，产物 $\\{(\\text{\"m2\\_c\"}, 1)\\}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果格式化为一个列表：$[\\text{count}, \\text{size}_1, \\dots, \\text{size}_r]$。例如，输出应类似于 $[[\\dots],[\\dots],[\\dots]]$，不含空格。",
            "solution": "该问题要求通过在一个特殊构建的代谢物图中识别孤立的连通分量，来分析代谢网络的结构。解决方案涉及一个多步骤过程：识别通用代谢物，基于反应化学计量构建无向图，确定网络边界，最后使用图遍历算法来查找和分类连通分量。每一步都基于代谢网络分析的既定原则。\n\n该过程始于对代谢网络组件的正式定义。该网络由一组代谢物 $V_{\\text{all}}$ 和一组反应来描述。每个反应 $j$ 的化学计量由其底物集 $\\mathcal{S}_j$ 和产物集 $\\mathcal{P}_j$ 隐式定义。可以概念化一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$，其中 $m = |V_{\\text{all}}|$，$n$ 是反应的数量。对于代谢物 $i$ 和反应 $j$，$S_{ij} < 0$ 如果 $i \\in \\mathcal{S}_j$，$S_{ij} > 0$ 如果 $i \\in \\mathcal{P}_j$，否则 $S_{ij} = 0$。\n\n**步骤 1：识别通用代谢物**\n\n代谢网络分析中一个关键的准备步骤是移除“通用代谢物”。这些是普遍存在的分子，如 ATP ($atp_c$)、水 ($h2o_c$) 或辅因子 ($nad_c$, $nadh_c$)，它们参与大量反应。将它们包含在连通性图中会创建一个密集的、生物学上无信息的网络，因为它们会虚假地连接原本不相关的通路。问题将通用代谢物集合 $\\mathcal{C}$ 定义为两个子集的并集：\n1.  一个明确提供的代谢物名称列表。\n2.  一个高度代谢物集，定义为 $\\{i \\in V_{\\text{all}} \\mid d(i) > k\\}$，其中 $d(i)$ 是代谢物 $i$ 的度，计算为它作为底物或产物参与的不同反应的数量，而 $k$ 是一个给定的整数阈值。\n\n算法的第一步是计算这个集合 $\\mathcal{C}$。这包括遍历所有反应，为 $V_{\\text{all}}$ 中的每个代谢物统计其参与次数以确定其度 $d(i)$，然后将高度代谢物与明确列表合并。\n\n**步骤 2：构建代谢物图 $G = (V, E)$**\n\n一旦识别出通用代谢物 $\\mathcal{C}$，就可以构建代谢物图 $G$。顶点和边的定义如下：\n- 顶点集 $V$ 由所有非通用代谢物组成：$V = V_{\\text{all}} \\setminus \\mathcal{C}$。\n- 边集 $E$ 是通过检查每个反应 $j$ 来构建的。对于一个给定的反应，我们考虑非通用底物集 $\\mathcal{S}'_j = \\mathcal{S}_j \\setminus \\mathcal{C}$ 和非通用产物集 $\\mathcal{P}'_j = \\mathcal{P}_j \\setminus \\mathcal{C}$。对于每一对代谢物 $(u, v)$，其中 $u \\in \\mathcal{S}'_j$ 且 $v \\in \\mathcal{P}'_j$ 向边集 $E$ 中添加一条无向边 $\\{u, v\\}$。此规则有效地在每个反应的非通用底物和产物之间创建了一个完全二分亚图，将相隔一个反应步骤的代谢物连接起来。\n\n这种构建方法产生一个无向图，其中节点是代谢物，边表示两个代谢物可以通过一个或多个反应链相互转化。\n\n**步骤 3：识别边界代谢物和孤立分量**\n\n要确定一个子网络是否“孤立”，我们必须首先定义系统边界。边界由可以与环境交换或在区室之间转运的代谢物表示。问题将交换反应和转运反应定义为名称分别以前缀 `\"EX_\"` 或 `\"T_\"` 开始的反应。边界代谢物集合 $\\mathcal{B}$ 被正式定义为参与任何此类边界反应的所有非通用代谢物（$i \\in V$）的集合。\n\n图 $G$ 的一个连通分量代表一个由可相互转化的代谢物组成的子网络。一个分量 $C \\subseteq V$ 被定义为**孤立的**，如果它与外部环境没有连接，这可以转化为正式条件：$C \\cap \\mathcal{B} = \\emptyset$。换句话说，一个孤立分量是一组可以在内部相互转化，但不能通过定义的边界反应从外部环境或其他区室生成或消耗的代谢物。\n\n**步骤 4：算法实现与分量分析**\n\n计算任务是实现上述定义，以找到孤立分量的数量及其各自的大小。算法流程如下：\n1.  首先，解析所有代谢物（$V_{\\text{all}}$）、反应、明确的通用代谢物名称和度阈值 $k$ 的输入数据。\n2.  构建完整的通用代谢物集合 $\\mathcal{C}$，方法是首先计算每个代谢物在所有反应中的度，并将度 $d(i) > k$ 的代谢物添加到明确的通用代谢物集合中。\n3.  定义顶点集 $V$ 为 $V_{\\text{all}} \\setminus \\mathcal{C}$。邻接表是表示图 $G=(V, E)$ 的合适数据结构，为 $V$ 中的所有顶点初始化为空。\n4.  通过遍历每个反应来填充邻接表。对于每个反应，识别非通用底物 $\\mathcal{S}'_j$ 和非通用产物 $\\mathcal{P}'_j$。对于每个 $u \\in \\mathcal{S}'_j$ 和 $v \\in \\mathcal{P}'_j$，在邻接表中于 $u$ 和 $v$ 之间添加一条边。\n5.  通过遍历所有名称以前缀 `\"EX_\"` 或 `\"T_\"` 开始的反应，并收集所有参与的非通用代谢物，来确定边界代谢物集合 $\\mathcal{B}$。\n6.  查找 $G$ 的连通分量。这是一个标准的图问题，可以用广度优先搜索（BFS）或深度优先搜索（DFS）等算法解决。维护一个已访问顶点的集合。遍历 $V$ 中的所有顶点；如果一个顶点尚未被访问，则从它开始进行遍历（例如，BFS），将所有可达顶点标记为已访问，并将它们分组到一个新的分量中。\n7.  对于每个识别出的分量 $C$，通过测试其与边界集 $\\mathcal{B}$ 的交集是否为空来检查其是否孤立。\n8.  收集所有被发现是孤立的分量的大小（顶点数）。\n9.  测试用例的最终输出是一个列表，其中包含孤立分量的数量，后面是按升序排列的它们的大小。\n\n这种结构化的、基于原则的方法确保了对代谢网络拓扑的正确和严谨的分析，符合规定。",
            "answer": "$$\\boxed{[[1,2],[1,3],[1,1]]}$$"
        }
    ]
}