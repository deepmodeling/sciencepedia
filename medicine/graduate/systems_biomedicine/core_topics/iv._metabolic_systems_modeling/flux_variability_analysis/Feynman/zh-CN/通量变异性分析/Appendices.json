{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握通量变异性分析（FVA），最好的方法莫过于亲手实现它。本练习将指导您从零开始，为一系列小型代谢网络编写 FVA 的计算过程。通过解决这个编码问题 ，您不仅能巩固对通量平衡分析（FBA）和 FVA 核心数学公式的理解，还能体会到如何将理论转化为可执行的分析工具。",
            "id": "4343372",
            "problem": "考虑一个稳态代谢网络，其模型包括一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$、一个通量向量 $v \\in \\mathbb{R}^{n}$、下界 $l \\in \\mathbb{R}^{n}$、上界 $u \\in \\mathbb{R}^{n}$ 以及一个目标向量 $c \\in \\mathbb{R}^{n}$。基础假设如下：在稳态下，细胞内代谢物浓度不发生改变，这强制执行了质量守恒约束 $S v = 0$；并且每个反应通量 $v_j$ 都受到 $l_j \\le v_j \\le u_j$ 的限制。在通量平衡分析（Flux Balance Analysis, FBA）中，最优生长是通过求解一个线性规划问题获得的，该问题在满足 $S v = 0$ 和 $l \\le v \\le u$ 的条件下最大化线性目标 $c^\\top v$。随后，通量变异性分析（Flux Variability Analysis, FVA）用于表征在所有维持接近最优目标值的稳态通量分布中，每个单独通量 $v_j$ 的允许变化范围。具体来说，对于一个固定的比例 $\\alpha \\in (0,1]$，FVA 寻找每个通量 $v_j$ 在满足 $S v = 0$、$l \\le v \\le u$ 和 $c^\\top v \\ge \\alpha \\, c^\\top v^\\*$ 条件下的最小值和最大值，其中 $v^\\*$ 表示 FBA 问题的任意最优解。\n\n你的任务是，对于每个给定的网络，从头开始实现通量变异性分析（FVA）的计算，其中近最优性阈值固定为 $\\alpha = 0.95$。使用线性规划首先通过最大化 $c^\\top v$ 来获得 $v^\\*$，然后对于每个通量分量 $v_j$，在满足稳态约束、边界条件和近最优性约束 $c^\\top v \\ge 0.95 \\, c^\\top v^\\*$ 的情况下，计算其最小值和最大值。所有答案都应报告为不带物理单位的纯浮点数。\n\n形式上，对于每个具有数据 $(S, c, l, u)$ 的测试用例：\n- 求解 FBA 问题：最大化 $c^\\top v$ 使得 $S v = 0$ 且 $l \\le v \\le u$，并令 $v^\\*$ 为一个最优通量向量，$z^\\* = c^\\top v^\\*$ 为其最优值。\n- 对于每个反应索引 $j \\in \\{1,\\dots,n\\}$，求解两个线性规划问题以获得通量变异性分析的边界：\n  - 最小化 $v_j$ 使得 $S v = 0$，$l \\le v \\le u$，且 $c^\\top v \\ge 0.95 \\, z^\\*$.\n  - 最大化 $v_j$ 使得 $S v = 0$，$l \\le v \\le u$，且 $c^\\top v \\ge 0.95 \\, z^\\*$.\n\n使用以下包含三个网络的测试套件。每个网络都由其化学计量矩阵 $S$、目标向量 $c$、下界 $l$ 和上界 $u$ 描述。在所有情况下，所有边界都是包含性的。代谢物数量 $m$ 和反应数量 $n$ 都很小，矩阵和向量均已明确给出。\n\n测试用例 1（具有单一生物质途径的简单链式反应）：\n- $m = 2$, $n = 3$.\n- $$S = \\begin{bmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix}.$$\n- $$c = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.$$\n- $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ 1000 \\\\ 1000 \\end{bmatrix}.$$\n\n测试用例 2（具有两个生物质途径的分支网络，其中一个有上限）：\n- $m = 2$, $n = 4$.\n- $$S = \\begin{bmatrix}\n1  -1  0  -1 \\\\\n0  1  -1  0\n\\end{bmatrix}.$$\n- $$c = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{bmatrix}.$$\n- $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ 1000 \\\\ 1000 \\\\ 8 \\end{bmatrix}.$$\n\n测试用例 3（被阻断的分支迫使采用唯一的生物质途径）：\n- $m = 2$, $n = 4$.\n- $$S = \\begin{bmatrix}\n1  -1  0  -1 \\\\\n0  1  -1  0\n\\end{bmatrix}.$$\n- $$c = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{bmatrix}.$$\n- $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ 0 \\\\ 1000 \\\\ 6 \\end{bmatrix}.$$\n\n你的程序应为每个测试用例计算一个由数对 $\\big[\\min(v_j), \\max(v_j)\\big]$（$j = 1, \\dots, n$）组成的列表，所有计算均在 $c^\\top v \\ge 0.95 \\, c^\\top v^\\*$ 的约束下进行。将这三个列表按测试用例的顺序汇总成一个列表的列表。将报告的每个边界四舍五入到 $6$ 位小数。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且其本身是按反应索引顺序排列的 $n$ 个数对的列表，例如 $\\big[[[\\min(v_1),\\max(v_1)],\\dots],\\dots\\big]$。",
            "solution": "用户要求为几个小型代谢网络实现通量变异性分析（Flux Variability Analysis, FVA）。此分析是系统生物学中的一种标准技术。该问题在科学上是合理的、提法明确且完整的。\n\n对于每个由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$、目标向量 $c \\in \\mathbb{R}^{n}$ 以及通量边界向量 $l, u \\in \\mathbb{R}^{n}$ 定义的测试用例，求解过程分为两个主要阶段。\n\n**第 1 步：通量平衡分析 (FBA)**\n\n首先，通过求解一个线性规划（Linear Programming, LP）问题来确定生物学目标函数可能的最大值 $z^\\*$。这就是 FBA 问题，其数学形式为：\n$$\n\\begin{aligned}\n\\text{maximize} \\quad  z = c^\\top v \\\\\n\\text{subject to} \\quad  S v = 0, \\\\\n l \\le v \\le u.\n\\end{aligned}\n$$\n在此公式中，$v \\in \\mathbb{R}^n$ 代表反应通量向量。等式约束 $S v = 0$ 强制执行稳态下的质量守恒定律，确保内部代谢物的浓度保持不变。不等式约束 $l \\le v \\le u$ 定义了每个通量的可行范围，这取决于热力学可行性和酶容量。目标函数的最优值记为 $z^\\*$，对应于一个最优通量分布 $v^\\*$。\n\n**第 2 步：通量变异性分析 (FVA)**\n\n第二阶段计算每个单独反应 $v_j$（对于 $j \\in \\{1, \\dots, n\\}$）的全部可能通量范围，条件是网络维持一个接近最优的目标值。问题指定了一个 $α = 0.95$ 的近最优性阈值。这个要求为系统增加了一个新约束：\n$$\nc^\\top v \\ge \\alpha z^\\*\n$$\n此约束确保任何有效的通量分布 $v$ 产生的目标值至少为理论最大值 $z^\\*$ 的 $95\\%$。\n\n为了确定每个反应 $v_j$ 的变异性，需要求解两个独立的 LP 问题：一个用于最小可能通量，另一个用于最大可能通量。\n\n对于每个反应索引 $j \\in \\{1, \\dots, n\\}$：\n\n1.  **最小化 $v_j$**：最小通量通过求解以下问题找到：\n    $$\n    \\begin{aligned}\n    v_j^{\\text{min}} = \\min_{v} \\quad  v_j \\\\\n    \\text{subject to} \\quad  S v = 0, \\\\\n     l \\le v \\le u, \\\\\n     c^\\top v \\ge \\alpha z^\\*.\n    \\end{aligned}\n    $$\n\n2.  **最大化 $v_j$**：最大通量通过求解以下问题找到：\n    $$\n    \\begin{aligned}\n    v_j^{\\text{max}} = \\max_{v} \\quad  v_j \\\\\n    \\text{subject to} \\quad  S v = 0, \\\\\n     l \\le v \\le u, \\\\\n     c^\\top v \\ge \\alpha z^\\*.\n    \\end{aligned}\n    $$\n\n数对 $[v_j^{\\text{min}}, v_j^{\\text{max}}]$ 构成了反应 $j$ 的通量变异范围。此过程必须对所有反应进行迭代，因此每个网络总共需要求解 $2n$ 个 LP 问题。\n\n**示例说明：测试用例 2**\n\n为了演示该方法，我们考虑测试用例 2：\n- $S = \\begin{bmatrix} 1  -1  0  -1 \\\\ 0  1  -1  0 \\end{bmatrix}$，有 $n=4$ 个反应。\n- $c = [0, 0, 1, 1]^T$.\n- $l = [0, 0, 0, 0]^T$, $u = [10, 1000, 1000, 8]^T$.\n\n稳态约束 $S v = 0$ 得到以下关系：\n$$\nv_1 - v_2 - v_4 = 0 \\quad \\text{和} \\quad v_2 - v_3 = 0\n$$\n这些可以简化为 $v_2 = v_3$ 和 $v_1 = v_2 + v_4$。\n\n**测试用例 2 的 FBA：**\n目标是最大化 $z = c^\\top v = v_3 + v_4$。代入稳态关系式，$z = v_3 + (v_1 - v_2) = v_3 + (v_1 - v_3) = v_1$。目标简化为最大化 $v_1$。边界条件指定 $0 \\le v_1 \\le 10$。因此，最优目标值为 $z^\\* = 10$。\n\n**测试用例 2 的 FVA：**\n近最优性约束是 $c^\\top v = v_1 \\ge \\alpha z^\\* = 0.95 \\times 10 = 9.5$。\n所有 FVA 子问题的完整约束集是：\n- $v_2 = v_3$\n- $v_1 = v_2 + v_4$\n- $9.5 \\le v_1 \\le 10$\n- $0 \\le v_2 \\le 1000$\n- $0 \\le v_3 \\le 1000$\n- $0 \\le v_4 \\le 8$\n- 所有通量 $v_j \\ge 0$。\n\n让我们求解通量 $v_2$ 的范围：\n- **最小化 $v_2$**：为了最小化 $v_2 = v_1 - v_4$，我们必须选择允许的最小 $v_1$ 和允许的最大 $v_4$。我们设置 $v_1 = 9.5$。约束 $v_1 - v_4 = v_2 \\ge 0$ 和 $v_4 \\le 8$ 意味着我们可以设置 $v_4=8$。这给出了一个最小值 $v_2^{\\text{min}} = 9.5 - 8 = 1.5$。\n- **最大化 $v_2$**：为了最大化 $v_2 = v_1 - v_4$，我们必须选择最大的 $v_1$ 和最小的 $v_4$。我们设置 $v_1 = 10$ 和 $v_4 = 0$。这给出了一个最大值 $v_2^{\\text{max}} = 10 - 0 = 10$。\n因此，$v_2$（以及 $v_3$）的变异范围是 $[1.5, 10.0]$。\n\n使用 `scipy.optimize.linprog` 函数求解 LP 问题，对三个测试用例中的所有反应系统地执行这整个过程。最终结果按规定格式进行汇总和格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef _solve_fva_for_case(S, c_obj, l, u, alpha):\n    \"\"\"\n    Performs Flux Variability Analysis for a single metabolic network case.\n    \"\"\"\n    m, n = S.shape\n\n    # Step 1: Flux Balance Analysis (FBA) to find the optimal objective value z*\n    # We maximize c_obj.T @ v by minimizing -c_obj.T @ v.\n    c_fba = -c_obj\n    bounds_fba = list(zip(l, u))\n\n    fba_result = linprog(c=c_fba, A_eq=S, b_eq=np.zeros(m), bounds=bounds_fba, method='highs')\n\n    if not fba_result.success:\n        # For a valid problem, FBA should be feasible.\n        raise ValueError(\"FBA optimization failed for a test case.\")\n\n    z_opt = -fba_result.fun\n\n    # Step 2: Flux Variability Analysis (FVA)\n    fva_threshold = alpha * z_opt\n\n    # Common constraints for all FVA LPs:\n    # S @ v = 0 (equality)\n    # l = v = u (bounds)\n    # c_obj.T @ v >= fva_threshold  => -c_obj.T @ v = -fva_threshold (inequality)\n    A_ub_fva = -c_obj.reshape(1, -1)\n    b_ub_fva = np.array([-fva_threshold])\n    \n    variability_results = []\n    \n    for j in range(n):\n        # -- Minimize v_j --\n        c_min = np.zeros(n)\n        c_min[j] = 1\n        min_result = linprog(c=c_min, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=np.zeros(m), bounds=bounds_fba, method='highs')\n        min_vj = min_result.fun if min_result.success else np.nan\n\n        # -- Maximize v_j --\n        c_max = np.zeros(n)\n        c_max[j] = -1\n        max_result = linprog(c=c_max, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=np.zeros(m), bounds=bounds_fba, method='highs')\n        max_vj = -max_result.fun if max_result.success else np.nan\n\n        # Round to 6 decimal places as required.\n        variability_results.append([round(min_vj, 6), round(max_vj, 6)])\n        \n    return variability_results\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (\n            np.array([[1, -1, 0], [0, 1, -1]]),\n            np.array([0, 0, 1]),\n            np.array([0, 0, 0]),\n            np.array([10, 1000, 1000]),\n        ),\n        # Test Case 2\n        (\n            np.array([[1, -1, 0, -1], [0, 1, -1, 0]]),\n            np.array([0, 0, 1, 1]),\n            np.array([0, 0, 0, 0]),\n            np.array([10, 1000, 1000, 8]),\n        ),\n        # Test Case 3\n        (\n            np.array([[1, -1, 0, -1], [0, 1, -1, 0]]),\n            np.array([0, 0, 1, 1]),\n            np.array([0, 0, 0, 0]),\n            np.array([10, 0, 1000, 6]),\n        ),\n    ]\n\n    alpha = 0.95\n    results = []\n    for S, c, l, u in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        case_result = _solve_fva_for_case(S, c, l, u, alpha)\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # Convert the list of lists of lists to a string and remove spaces to match the specified output format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "在确定了最优生长表型后，细胞内部的代谢网络往往仍保有相当大的灵活性。本练习将探讨 FVA 如何揭示这种灵活性，特别是在存在无效循环（futile cycles）的情况下。通过分析一个包含循环途径的简化网络 ，您将学会如何利用 FVA 的结果来识别和量化那些在不影响整体目标（如生物量生产）的前提下，仍能自由变化的内部通量。",
            "id": "1434692",
            "problem": "一个假设的微生物利用一个简化的代谢网络，将底物 `M1` 转化为一种有价值的产物 `M4`，后者随后用于生物质的生成。该网络在稳态下运行，并由以下不可逆反应组成：\n\n*   **R_in (底物摄取):** `- M1`\n*   **R1:** `M1 - M2`\n*   **R2:** `M2 - M3`\n*   **R3:** `M3 - M2`\n*   **R4:** `M3 - M4`\n*   **R_obj (生物质目标):** `M4 -`\n\n通过 `R_in` 摄取底物 `M1` 的通量恒定为 10 mmol/gDW/hr (毫摩尔/克干重/小时)。反应 `R2` 和 `R3` 形成一个循环。由于催化这两个反应的酶存在细胞资源限制，它们的通量之和不能超过 50 mmol/gDW/hr。该生物体的代谢被优化，以实现生物质目标反应 `R_obj` 的最大可能速率。\n\n使用通量变异性分析 (FVA)，确定在生物质目标 `R_obj` 最大化的条件下，反应 `R2` 的最小和最大可能稳态通量。\n\n答案以两个数值表示：`R2` 的最小可能通量和最大可能通量，单位为 mmol/gDW/hr。",
            "solution": "设反应 $R_{\\text{in}}$、$R1$、$R2$、$R3$、$R4$ 和 $R_{\\text{obj}}$ 的稳态通量分别表示为 $v_{\\text{in}}$、$v_{1}$、$v_{2}$、$v_{3}$、$v_{4}$ 和 $v_{\\text{obj}}$。所有反应都是不可逆的，因此所有通量均为非负值。给定的固定摄取通量为 $v_{\\text{in}}=10$，酶资源约束为 $v_{2}+v_{3} \\leq 50$。\n\n写出每种代谢物的稳态质量平衡方程：\n- 对于 $M1$: $v_{\\text{in}} - v_{1} = 0 \\implies v_{1} = v_{\\text{in}} = 10$。\n- 对于 $M2$: $v_{1} + v_{3} - v_{2} = 0 \\implies v_{2} = v_{1} + v_{3} = 10 + v_{3}$。\n- 对于 $M3$: $v_{2} - v_{3} - v_{4} = 0 \\implies v_{4} = v_{2} - v_{3}$。\n- 对于 $M4$: $v_{4} - v_{\\text{obj}} = 0 \\implies v_{\\text{obj}} = v_{4}$。\n\n将 $v_{2} = 10 + v_{3}$ 代入 $M3$ 的平衡方程，得到\n$$\nv_{4} = (10 + v_{3}) - v_{3} = 10 \\implies v_{\\text{obj}} = 10.\n$$\n因此，最大生物质目标为 $v_{\\text{obj}}^{\\max} = 10$，只要满足可行性约束，这个值就可以达到。\n\n为了在最大目标值下进行通量变异性分析，我们设定 $v_{\\text{obj}} = 10$ (等价于 $v_{4} = 10$)，并确定在以下约束条件下 $v_{2}$ 的范围：\n$$\nv_{2} = 10 + v_{3}, \\quad v_{2} + v_{3} \\leq 50, \\quad v_{2} \\geq 0, \\quad v_{3} \\geq 0.\n$$\n将 $v_{2} = 10 + v_{3}$ 代入酶约束条件中：\n$$\n(10 + v_{3}) + v_{3} \\leq 50 \\implies 10 + 2v_{3} \\leq 50 \\implies v_{3} \\leq 20.\n$$\n由于反应不可逆，$v_{3} \\geq 0$，因此 $0 \\leq v_{3} \\leq 20$。所以\n$$\nv_{2} = 10 + v_{3} \\implies 10 \\leq v_{2} \\leq 30.\n$$\n这个区间是可行的，并且在此区间内始终保持 $v_{\\text{obj}} = 10$，因为 $v_{4} = v_{2} - v_{3} = 10$ 恒成立。\n\n因此，在生物质目标最大化的条件下，$v_{2}$ 的最小可能值为 $10$，$v_{2}$ 的最大可能值为 $30$，单位均为 mmol/gDW/hr。",
            "answer": "$$\\boxed{\\begin{pmatrix}10  30\\end{pmatrix}}$$"
        },
        {
            "introduction": "代谢网络是一个高度关联的系统，对一个反应的局部扰动可能会引发全局性的、甚至有违直觉的响应。本练习旨在挑战您的直觉，展示一个看似收紧的约束如何出乎意料地扩大了网络中另一个反应的通量范围。通过解决这个问题 ，您将深刻理解 FVA 作为一种系统级分析工具的强大之处，它能够揭示这些复杂的、非局域性的相互作用，而这对于理性设计和改造代谢网络至关重要。",
            "id": "4343402",
            "problem": "考虑一个单室稳态代谢网络，其中包含三种内部代谢物：$S$、$B$ 和 $C$。该网络由以下不可逆反应组成，其通量分别为 $v_1, v_2, \\dots, v_7$：\n\n$R_1$：吸收，$\\emptyset \\rightarrow S$，通量 $v_1$。\n\n$R_2$：转化，$S \\rightarrow B$，通量 $v_2$。\n\n$R_3$：转化，$S \\rightarrow C$，通量 $v_3$。\n\n$R_4$：由 $B$ 生成生物质，$B \\rightarrow \\text{Biomass}$，通量 $v_4$。\n\n$R_5$：由 $C$ 生成生物质，$C \\rightarrow \\text{Biomass}$，通量 $v_5$。\n\n$R_6$：互变，$B \\rightarrow C$，通量 $v_6$。\n\n$R_7$：互变，$C \\rightarrow B$，通量 $v_7$。\n\n假设采用标准的通量平衡分析（Flux Balance Analysis, FBA）公式：对于内部代谢物 $S$、$B$ 和 $C$，稳态质量平衡为 $S v = 0$，同时反应速率具有上界和下界。一个反应的通量变异性分析（Flux Variability Analysis, FVA）被定义为：在满足约束条件 $S v = 0$、给定边界以及目标通量保持在FBA确定的最优值这一要求下，该反应的可行通量值范围。\n\n施加以下边界条件：\n\n$0 \\leq v_1 \\leq 10$, $0 \\leq v_2 \\leq 10$, $0 \\leq v_3 \\leq 10$, $0 \\leq v_4 \\leq 10$, $0 \\leq v_5 \\leq 10$, $0 \\leq v_6 \\leq 10$, and $0 \\leq v_7 \\leq 2$.\n\n目标是最大化生物质生成通量 $v_4$。\n\n1. 仅使用稳态约束和边界条件，确定在上述基准边界下的最优目标值 $v_4^{\\star}$，然后计算当 $v_4$ 被约束为等于 $v_4^{\\star}$ 时 $v_6$ 的FVA范围。将此范围的宽度以纯数字形式报告。\n\n2. 现在收紧单个边界，将 $v_4$ 的上界从 $10$ 减少到 $9$，同时保持所有其他边界不变。确定在此收紧边界下的新最优目标值 $v_4^{\\star}$，并计算当 $v_4$ 被约束为等于这个新的 $v_4^{\\star}$ 时 $v_6$ 的FVA范围。将此范围的宽度以纯数字形式报告。\n\n3. 计算从基准情况到收紧边界情况，$v_6$ 的FVA范围宽度的增加量。将最终数值答案以无单位的纯数字形式表示。无需四舍五入；报告精确值。",
            "solution": "用户提出了一个关于通量平衡分析（FBA）和通量变异性分析（FVA）领域的问题，这些是系统生物医学中的既定方法。在尝试解决问题之前，需要对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n\n- **代谢物（内部）：** $S$、$B$、$C$。\n- **反应与通量：**\n  - $R_1: \\emptyset \\rightarrow S$，通量 $v_1$。\n  - $R_2: S \\rightarrow B$，通量 $v_2$。\n  - $R_3: S \\rightarrow C$，通量 $v_3$。\n  - $R_4: B \\rightarrow \\text{Biomass}$，通量 $v_4$。\n  - $R_5: C \\rightarrow \\text{Biomass}$，通量 $v_5$。\n  - $R_6: B \\rightarrow C$，通量 $v_6$。\n  - $R_7: C \\rightarrow B$，通量 $v_7$。\n- **约束条件：** 稳态质量平衡，$S v = 0$。\n- **目标（第1和2部分）：** 最大化生物质生成通量 $v_4$。\n- **基准边界（第1部分）：**\n  - $0 \\leq v_1 \\leq 10$\n  - $0 \\leq v_2 \\leq 10$\n  - $0 \\leq v_3 \\leq 10$\n  - $0 \\leq v_4 \\leq 10$\n  - $0 \\leq v_5 \\leq 10$\n  - $0 \\leq v_6 \\leq 10$\n  - $0 \\leq v_7 \\leq 2$\n- **收紧边界（第2部分）：** 与基准相同，除了 $0 \\leq v_4 \\leq 9$。\n- **任务：**\n  1. 对于基准边界，找到最优目标值 $v_4^{\\star}$，然后当 $v_4=v_4^{\\star}$ 时，求出 $v_6$ 的FVA范围宽度。\n  2. 对于收紧边界，找到新的最优目标值 $v_4^{\\star}$，然后当 $v_4$ 固定为此新最优值时，求出 $v_6$ 的FVA范围宽度。\n  3. 计算从情况1到情况2，$v_6$ 的FVA范围宽度的增加量。\n\n**步骤2：使用提取的给定信息进行验证**\n\n- **科学依据：** 该问题基于通量平衡分析和通量变异性分析，这些是代谢工程和系统生物学中标准、成熟的计算技术。这些概念在科学上是合理的。\n- **适定性：** 该问题提供了一个明确定义的代谢网络、一组线性约束（稳态和通量边界）以及一个线性目标函数。这构成了一个标准的线性规划（LP）问题，该问题是适定的，并保证存在解。FVA后处理也是一个标准且明确定义的过程。\n- **客观性：** 问题以精确的数学和形式化语言陈述，没有主观性或歧义。\n\n所有给定信息都是自洽和一致的。该问题不违反任何无效标准。\n\n**步骤3：结论与行动**\n\n此问题是**有效的**。将提供完整解答。\n\n### 解答\n\n首先，我们为三种内部代谢物 $S$、$B$ 和 $C$ 写出稳态质量平衡方程 $S v = 0$。\n\n对于代谢物 $S$：$v_1 - v_2 - v_3 = 0$\n对于代谢物 $B$：$v_2 - v_4 + v_7 - v_6 = 0$\n对于代谢物 $C$：$v_3 - v_5 + v_6 - v_7 = 0$\n\n这可以写成矩阵形式 $S v = 0$，其中 $v = [v_1, v_2, v_3, v_4, v_5, v_6, v_7]^T$，化学计量矩阵 $S$ 为：\n$$\nS = \\begin{pmatrix}\n1  -1  -1  0  0  0  0 \\\\\n0  1  0  -1  0  -1  1 \\\\\n0  0  1  0  -1  1  -1\n\\end{pmatrix}\n$$\n\n问题分为三个部分。\n\n**第1部分：基准情况**\n\n首先，我们执行FBA以找到目标通量 $v_4$ 的最大可能值。问题是在稳态约束和基准边界条件下最大化 $v_4$。\n\n从第二个稳态方程，我们可以将目标通量表示为：\n$v_4 = v_2 - v_6 + v_7$。\n为了最大化 $v_4$，我们必须最大化 $v_2$ 和 $v_7$，并最小化 $v_6$。边界条件为 $v_2 \\leq 10$，$v_7 \\leq 2$ 和 $v_6 \\geq 0$。这表明理论最大值为 $v_4 = 10 - 0 + 2 = 12$。然而，通量 $v_4$ 本身受到 $v_4 \\leq 10$ 的约束。我们来检验 $v_4 = 10$ 是否可实现。\n\n如果我们设置 $v_4 = 10$，方程变为 $10 = v_2 - v_6 + v_7$。为实现此目的，我们尝试将 $v_2$ 设为其最大值 $v_2 = 10$。这得到 $10 = 10 - v_6 + v_7$，简化为 $v_6 = v_7$。\n\n现在我们检查与其他约束的一致性：\n- 第一个方程是 $v_1 = v_2 + v_3$。当 $v_2 = 10$ 时，我们有 $v_1 = 10 + v_3$。边界 $v_1 \\leq 10$ 迫使 $v_3=0$，进而得到 $v_1=10$。两者都在其边界范围内。\n- 第三个方程是 $v_3 - v_5 + v_6 - v_7 = 0$。使用 $v_3=0$ 和 $v_6=v_7$，我们得到 $0 - v_5 + v_7 - v_7 = 0$，得出 $v_5=0$。这符合其边界 $0 \\leq v_5 \\leq 10$。\n- 条件 $v_6 = v_7$ 也必须满足边界 $0 \\leq v_6 \\leq 10$ 和 $0 \\leq v_7 \\leq 2$。如果我们为 $v_6$ 和 $v_7$ 选择任何满足 $v_6=v_7$ 且 $0 \\leq v_6 \\leq 2$ 的值，这是可能的。\n由于对于 $v_4=10$ 存在一个可行的通量分布，最优目标值为 $v_4^{\\star} = 10$。\n\n接下来，我们对通量 $v_6$ 执行FVA，同时将 $v_4$ 固定在 $v_4^{\\star}=10$。我们需要在这些条件下找到 $v_6$ 的最小和最大可能值。约束条件是：\n1. $v_1 - v_2 - v_3 = 0$\n2. $v_2 - 10 - v_6 + v_7 = 0 \\implies v_2 = 10 + v_6 - v_7$\n3. $v_3 - v_5 - v_7 + v_6 = 0 \\implies v_3 = v_5 - v_6 + v_7$\n4. 给定的通量边界。\n\n从 $v_2 = 10 + v_6 - v_7$ 和边界 $v_2 \\leq 10$，我们有 $10 + v_6 - v_7 \\leq 10$，简化为 $v_6 \\leq v_7$。\n从 $v_1 = v_2 + v_3 = (10 + v_6 - v_7) + (v_5 - v_6 + v_7) = 10 + v_5$。边界 $v_1 \\leq 10$ 意味着 $10+v_5 \\leq 10$，所以 $v_5 \\leq 0$。由于 $v_5 \\geq 0$，我们必须有 $v_5 = 0$。\n\n因此，对于FVA，系统受 $v_5=0$ 和 $v_6 \\leq v_7$ 的约束。\n- 求 $\\min(v_6)$：下界是 $v_6 \\geq 0$。我们检查 $v_6=0$ 是否可行。如果 $v_6=0$，则需要 $0 \\leq v_7$。我们可以选择任何满足 $0 \\leq v_7 \\leq 2$ 的 $v_7$。例如，选择 $v_7=1$ 得到 $v_2 = 10+0-1 = 9$ 和 $v_3 = 0-0+1=1$，两者都有效。因此，$\\min(v_6)=0$。\n- 求 $\\max(v_6)$：我们有约束条件 $v_6 \\leq v_7$ 和 $v_7 \\leq 2$。它们共同意味着 $v_6 \\leq 2$。$v_6=2$ 是否可行？如果 $v_6=2$，那么必须有 $2 \\leq v_7$。结合 $v_7 \\leq 2$，这迫使 $v_7=2$。我们来检查一下：$v_2 = 10+2-2=10$（有效），$v_3 = 0-2+2=0$（有效）。因此，$\\max(v_6)=2$。\n\n在基准情况下，$v_6$ 的FVA范围是 $[0, 2]$。此范围的宽度是 $2-0=2$。\n\n**第2部分：收紧边界情况**\n\n现在的边界与基准情况相同，除了 $v_4$ 的边界是 $0 \\leq v_4 \\leq 9$。\n我们再次最大化 $v_4=v_2-v_6+v_7$。由于在没有 $v_4$ 边界的情况下可实现的最大值是 $10$，新的最大值将受限于新的边界。因此，新的最优目标值是 $v_4^{\\star} = 9$。这是可行的，如通量分布 $v=\\{10, 10, 0, 9, 1, 3, 2\\}$ 所示，它满足所有边界。\n\n现在我们对 $v_6$ 执行FVA，同时将 $v_4$ 固定在 $v_4^{\\star}=9$。约束条件是：\n1. $v_1 - v_2 - v_3 = 0$\n2. $v_2 - 9 - v_6 + v_7 = 0 \\implies v_2 = 9 + v_6 - v_7$\n3. $v_3 - v_5 - v_7 + v_6 = 0 \\implies v_3 = v_5 - v_6 + v_7$\n4. 所有边界，包括收紧的 $v_4=9$ 边界。\n\n从 $v_2 = 9 + v_6 - v_7$ 和边界 $v_2 \\leq 10$，我们推断出 $9 + v_6 - v_7 \\leq 10$，得到 $v_6 - v_7 \\leq 1$。\n从 $v_1 = v_2 + v_3 = (9 + v_6 - v_7) + (v_5 - v_6 + v_7) = 9 + v_5$。边界 $v_1 \\leq 10$ 意味着 $9+v_5 \\leq 10$，得出 $v_5 \\leq 1$。\n我们还需要 $v_3 \\geq 0$，所以 $v_5 - v_6 + v_7 \\geq 0$，这意味着 $v_6 \\leq v_5 + v_7$。\n\n为了找到 $v_6$ 的范围，我们必须在以下条件下找到其最小值和最大值：\n- $v_6 - v_7 \\leq 1$\n- $v_6 \\leq v_5 + v_7$\n- $0 \\leq v_5 \\leq 1$\n- $0 \\leq v_7 \\leq 2$\n- $v_6 \\geq 0$\n\n- 求 $\\min(v_6)$：我们可以测试 $v_6=0$。约束条件变为 $0 - v_7 \\leq 1$（对于 $v_7 \\geq 0$ 恒成立）和 $0 \\leq v_5 + v_7$（对于 $v_5, v_7 \\geq 0$ 恒成立）。我们可以轻松找到有效的通量，例如，$v_5=0, v_7=1$。这得到 $v_2=8$ 和 $v_3=1$。因此，$\\min(v_6)=0$。\n- 求 $\\max(v_6)$：我们需要满足 $v_6 \\leq v_7 + 1$ 和 $v_6 \\leq v_5 + v_7$。为了获得 $v_6$ 的最大可能值，我们应该为 $v_5$ 和 $v_7$ 选择最大可能的值，即 $v_5=1$ 和 $v_7=2$。\n  - 第一个不等式：$v_6 \\leq 2 + 1 = 3$。\n  - 第二个不等式：$v_6 \\leq 1 + 2 = 3$。\n  两个约束都表明 $v_6$ 的上限为 $3$。$v_6=3$ 是否可行？这将需要找到 $v_5, v_7$ 使得 $3 \\leq v_7+1$（即 $v_7 \\geq 2$）和 $3 \\leq v_5+v_7$（即 $v_5+v_7 \\geq 3$）。考虑到边界 $v_7 \\leq 2$ 和 $v_5 \\leq 1$，这些不等式迫使 $v_7=2$ 和 $v_5=1$。我们来检查这一点：$v_6=3, v_7=2, v_5=1$。\n   - $v_2 = 9 + 3 - 2 = 10$（有效）。\n   - $v_3 = 1 - 3 + 2 = 0$（有效）。\n   - $v_1 = 9+v_5 = 9+1=10$（有效）。\n  因此，$\\max(v_6)=3$ 是可实现的。\n\n新的 $v_6$ 的FVA范围是 $[0, 3]$。此范围的宽度是 $3-0=3$。\n\n**第3部分：FVA范围宽度的增加**\n\n在基准情况下，$v_6$ 的FVA范围宽度为 $2$。\n在收紧边界情况下，$v_6$ 的FVA范围宽度为 $3$。\n宽度的增加量是两者之差：\n增加量 = (收紧情况下的宽度) - (基准情况下的宽度) = $3 - 2 = 1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}