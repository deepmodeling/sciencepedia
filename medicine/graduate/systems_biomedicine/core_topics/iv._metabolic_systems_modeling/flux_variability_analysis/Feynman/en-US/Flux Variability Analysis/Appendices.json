{
    "hands_on_practices": [
        {
            "introduction": "Flux Variability Analysis (FVA) provides a window into the flexibility of metabolic networks. To build a solid foundation, we begin with the simplest possible topology: a linear, unbranched pathway. This exercise  demonstrates how the steady-state assumption fundamentally constrains the system, revealing the tight coupling between reaction fluxes in series. By solving this problem, you will gain an intuitive grasp of how mass conservation dictates flux relationships, a core principle that scales up to genome-wide models.",
            "id": "1434665",
            "problem": "A bioengineered microorganism is designed to produce a specialty chemical, 'P', through a simplified linear metabolic pathway. The pathway starts with the uptake of a nutrient, 'Substrate_in' ($S_{in}$), from the environment at a rate $v_{uptake}$. This substrate is then converted into an intermediate 'S' at a rate $v_1$, which is subsequently converted into the final product 'P' at a rate $v_2$. The pathway can be represented as:\n\n$S_{in} \\xrightarrow{v_{uptake}} S_0 \\xrightarrow{v_1} S_1 \\xrightarrow{v_2} P$\n\nThe analysis of this system is based on the following well-established biophysical principles and constraints:\n1. The system operates at a steady state, meaning the concentrations of the internal metabolites ($S_0$ and $S_1$) remain constant over time.\n2. All reactions are considered irreversible, implying that all fluxes ($v_{uptake}, v_1, v_2$) are non-negative values.\n3. The nutrient uptake is limited by the cell's transport capacity, constraining the uptake flux to the range $0 \\le v_{uptake} \\le V_{max}$.\n\nThe microorganism is cultured under conditions where its metabolic state is optimized for high yield. Specifically, we are only considering states where the production rate of P, given by the flux $v_2$, is maintained at a level of at least 90% of its absolute theoretical maximum.\n\nLet the set of all possible values for flux $v_1$ that satisfy these conditions be described by the interval $R_1 = [v_{1,min}, v_{1,max}]$, and the corresponding set for flux $v_2$ be $R_2 = [v_{2,min}, v_{2,max}]$. Which of the following statements correctly describes the relationship between these two intervals?\n\nA. $R_1$ is identical to $R_2$.\n\nB. $R_1$ is a wider interval that strictly contains $R_2$ (i.e., $R_2 \\subset R_1$ and $R_2 \\neq R_1$).\n\nC. $R_2$ is a wider interval that strictly contains $R_1$ (i.e., $R_1 \\subset R_2$ and $R_1 \\neq R_2$).\n\nD. $R_1$ and $R_2$ are non-overlapping intervals.\n\nE. The relationship depends on the specific kinetic properties of the enzymes involved, which are not provided.",
            "solution": "At steady state, the internal metabolite balances impose equalities of the fluxes along the linear pathway. For metabolite $S_{0}$,\n$$\n\\frac{d[S_{0}]}{dt}=v_{uptake}-v_{1}=0 \\;\\;\\Rightarrow\\;\\; v_{1}=v_{uptake}.\n$$\nFor metabolite $S_{1}$,\n$$\n\\frac{d[S_{1}]}{dt}=v_{1}-v_{2}=0 \\;\\;\\Rightarrow\\;\\; v_{2}=v_{1}.\n$$\nTherefore,\n$$\nv_{uptake}=v_{1}=v_{2}.\n$$\n\nIrreversibility implies non-negativity of all fluxes, and the uptake capacity imposes $0\\leq v_{uptake}\\leq V_{max}$. Using $v_{uptake}=v_{1}=v_{2}$, it follows that\n$$\n0\\leq v_{1}\\leq V_{max},\\quad 0\\leq v_{2}\\leq V_{max}.\n$$\n\nThe absolute theoretical maximum of $v_{2}$ under these constraints is\n$$\nv_{2,\\max}=V_{max}.\n$$\nRestricting to high-yield states with $v_{2}\\geq \\frac{9}{10}V_{max}$ yields\n$$\nR_{2}=\\left[\\frac{9}{10}V_{max},\\,V_{max}\\right].\n$$\nSince $v_{1}=v_{2}$ for every feasible steady state in this linear pathway, the admissible values of $v_{1}$ under the same high-yield requirement are identical:\n$$\nR_{1}=\\left[\\frac{9}{10}V_{max},\\,V_{max}\\right]=R_{2}.\n$$\n\nHence, $R_{1}$ is identical to $R_{2}$.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from concept to application, this practice challenges you to implement the FVA algorithm from first principles . Writing the code to perform FVA solidifies the theoretical understanding of the method, requiring you to formulate and solve the series of linear programming problems that define the flux ranges. This exercise is essential for developing the practical skills needed to analyze metabolic models, providing hands-on experience with defining objective functions, handling constraints, and exploring the solution space of near-optimal metabolic states.",
            "id": "4343372",
            "problem": "Consider a steady-state metabolic network modeled by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$, a flux vector $v \\in \\mathbb{R}^{n}$, lower bounds $l \\in \\mathbb{R}^{n}$, upper bounds $u \\in \\mathbb{R}^{n}$, and an objective vector $c \\in \\mathbb{R}^{n}$. The foundational base assumptions are the following: at steady state, intracellular metabolite concentrations do not change, which enforces the mass conservation constraint $S v = 0$, and each reaction flux $v_j$ is bounded by $l_j \\le v_j \\le u_j$. In Flux Balance Analysis (FBA), the optimal growth is obtained by the linear program that maximizes the linear objective $c^T v$ subject to $S v = 0$ and $l \\le v \\le u$. Flux Variability Analysis (FVA) then characterizes the allowable variation in each individual flux $v_j$ among all steady-state flux distributions that maintain a near-optimal objective value. Specifically, for a fixed fraction $\\alpha \\in (0,1]$, FVA finds the minimum and maximum values of each flux $v_j$ subject to $S v = 0$, $l \\le v \\le u$, and $c^T v \\ge \\alpha \\, c^T v^\\*$, where $v^\\*$ denotes any optimal solution of the FBA problem.\n\nYour task is to implement, from first principles, the computation of Flux Variability Analysis (FVA) for all reactions in each provided network, with the near-optimality threshold fixed at $\\alpha = 0.95$. Use linear programming to first obtain $v^\\*$ by maximizing $c^T v$, then for each flux component $v_j$ compute its minimum and maximum subject to the steady-state constraints, bounds, and the near-optimality constraint $c^T v \\ge 0.95 \\, c^T v^\\*$. All answers should be reported as plain floating-point numbers without physical units.\n\nFormally, for each test case with data $(S, c, l, u)$:\n- Solve the FBA problem: maximize $c^T v$ such that $S v = 0$ and $l \\le v \\le u$, and let $v^\\*$ be an optimal flux vector and $z^\\* = c^T v^\\*$ its optimal value.\n- For each reaction index $j \\in \\{1,\\dots,n\\}$, solve two linear programs to obtain the Flux Variability Analysis bounds:\n  - Minimize $v_j$ such that $S v = 0$, $l \\le v \\le u$, and $c^T v \\ge 0.95 \\, z^\\*$.\n  - Maximize $v_j$ such that $S v = 0$, $l \\le v \\le u$, and $c^T v \\ge 0.95 \\, z^\\*$.\n\nUse the following test suite of three networks. Each network is described by its stoichiometric matrix $S$, objective vector $c$, lower bounds $l$, and upper bounds $u$. In all cases, all bounds are inclusive. The numbers of metabolites $m$ and reactions $n$ are small, and the matrices and vectors are given explicitly.\n\nTest Case $1$ (simple chain with a single biomass route):\n- $m = 2$, $n = 3$.\n- $$S = \\begin{bmatrix}\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix}.$$\n- $$c = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.$$\n- $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ 1000 \\\\ 1000 \\end{bmatrix}.$$\n\nTest Case $2$ (branched network with two biomass routes, one capped):\n- $m = 2$, $n = 4$.\n- $$S = \\begin{bmatrix}\n1  -1  0  -1 \\\\\n0  1  -1  0\n\\end{bmatrix}.$$\n- $$c = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{bmatrix}.$$\n- $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ 1000 \\\\ 1000 \\\\ 8 \\end{bmatrix}.$$\n\nTest Case $3$ (blocked branch forcing a unique biomass route):\n- $m = 2$, $n = 4$.\n- $$S = \\begin{bmatrix}\n1  -1  0  -1 \\\\\n0  1  -1  0\n\\end{bmatrix}.$$\n- $$c = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{bmatrix}.$$\n- $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ 0 \\\\ 1000 \\\\ 6 \\end{bmatrix}.$$\n\nYour program should compute, for each test case, a list of pairs $\\big[\\min(v_j), \\max(v_j)\\big]$ for $j = 1, \\dots, n$, all under the constraint $c^T v \\ge 0.95 \\, c^T v^\\*$. Aggregate the three lists into a single list of lists in the order of the test cases. Round each reported bound to $6$ decimal places.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of $n$ pairs in the reaction index order, for example, $\\big[[[\\min(v_1),\\max(v_1)],\\dots],\\dots\\big]$.",
            "solution": "The user has requested an implementation of Flux Variability Analysis (FVA) for several small metabolic networks. This analysis is a standard technique in systems biology. The problem is scientifically sound, well-posed, and complete.\n\nThe solution proceeds in two main stages for each provided test case, which is defined by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$, an objective vector $c \\in \\mathbb{R}^{n}$, and flux bounds vectors $l, u \\in \\mathbb{R}^{n}$.\n\n**Step 1: Flux Balance Analysis (FBA)**\n\nFirst, the maximum possible value of the biological objective function, $z^\\*$, is determined by solving a Linear Programming (LP) problem. This is the FBA problem, formulated as:\n$$\n\\begin{aligned}\n\\text{maximize} \\quad  z = c^T v \\\\\n\\text{subject to} \\quad  S v = 0, \\\\\n l \\le v \\le u.\n\\end{aligned}\n$$\nIn this formulation, $v \\in \\mathbb{R}^n$ represents the vector of reaction fluxes. The equality constraint $S v = 0$ enforces the mass conservation law at steady state, ensuring that the concentrations of internal metabolites remain constant. The inequality constraints $l \\le v \\le u$ define the feasible range for each flux, dictated by thermodynamic feasibility and enzymatic capacity. The optimal value of the objective function is denoted as $z^\\*$, corresponding to an optimal flux distribution $v^\\*$.\n\n**Step 2: Flux Variability Analysis (FVA)**\n\nThe second stage calculates the full range of possible fluxes for each individual reaction $v_j$ (for $j \\in \\{1, \\dots, n\\}$), under the condition that the network maintains a near-optimal objective value. The problem specifies a near-optimality threshold of $\\alpha = 0.95$. This requirement adds a new constraint to the system:\n$$\nc^T v \\ge \\alpha z^\\*\n$$\nThis constraint ensures that any valid flux distribution $v$ yields an objective value of at least $95\\%$ of the theoretical maximum, $z^\\*$.\n\nTo determine the variability for each reaction $v_j$, two separate LP problems are solved: one for the minimum possible flux and one for the maximum.\n\nFor each reaction index $j \\in \\{1, \\dots, n\\}$:\n\n1.  **Minimization of $v_j$**: The minimum flux is found by solving:\n    $$\n    \\begin{aligned}\n    v_j^{\\text{min}} = \\min_{v} \\quad  v_j \\\\\n    \\text{subject to} \\quad  S v = 0, \\\\\n     l \\le v \\le u, \\\\\n     c^T v \\ge \\alpha z^\\*.\n    \\end{aligned}\n    $$\n\n2.  **Maximization of $v_j$**: The maximum flux is found by solving:\n    $$\n    \\begin{aligned}\n    v_j^{\\text{max}} = \\max_{v} \\quad  v_j \\\\\n    \\text{subject to} \\quad  S v = 0, \\\\\n     l \\le v \\le u, \\\\\n     c^T v \\ge \\alpha z^\\*.\n    \\end{aligned}\n    $$\n\nThe pair $[v_j^{\\text{min}}, v_j^{\\text{max}}]$ constitutes the flux variability range for reaction $j$. This process must be iterated over all a total of $2n$ LPs are solved for each network.\n\n**Illustrative Example: Test Case 2**\n\nTo demonstrate the method, we consider Test Case $2$:\n- $S = \\begin{bmatrix} 1  -1  0  -1 \\\\ 0  1  -1  0 \\end{bmatrix}$, with $n=4$ reactions.\n- $c = [0, 0, 1, 1]^T$.\n- $l = [0, 0, 0, 0]^T$, $u = [10, 1000, 1000, 8]^T$.\n\nThe steady-state constraints $S v = 0$ yield the relationships:\n$$\nv_1 - v_2 - v_4 = 0 \\quad \\text{and} \\quad v_2 - v_3 = 0\n$$\nThese simplify to $v_2 = v_3$ and $v_1 = v_2 + v_4$.\n\n**FBA for Test Case 2:**\nThe objective is to maximize $z = c^T v = v_3 + v_4$. Substituting the steady-state relations, $z = v_3 + (v_1 - v_2) = v_3 + (v_1 - v_3) = v_1$. The objective simplifies to maximizing $v_1$. The bounds specify $0 \\le v_1 \\le 10$. Therefore, the optimal objective value is $z^\\* = 10$.\n\n**FVA for Test Case 2:**\nThe near-optimality constraint is $c^T v = v_1 \\ge \\alpha z^\\* = 0.95 \\times 10 = 9.5$.\nThe complete set of constraints for all FVA subproblems is:\n- $v_2 = v_3$\n- $v_1 = v_2 + v_4$\n- $9.5 \\le v_1 \\le 10$\n- $0 \\le v_2 \\le 1000$\n- $0 \\le v_3 \\le 1000$\n- $0 \\le v_4 \\le 8$\n- All fluxes $v_j \\ge 0$.\n\nLet's find the range for flux $v_2$:\n- **Minimize $v_2$**: To minimize $v_2 = v_1 - v_4$, we must select the smallest permissible $v_1$ and the largest permissible $v_4$. We set $v_1 = 9.5$. The constraints $v_1 - v_4 = v_2 \\ge 0$ and $v_4 \\le 8$ imply we can set $v_4=8$. This gives a minimum value $v_2^{\\text{min}} = 9.5 - 8 = 1.5$.\n- **Maximize $v_2$**: To maximize $v_2 = v_1 - v_4$, we must select the largest $v_1$ and smallest $v_4$. We set $v_1 = 10$ and $v_4 = 0$. This gives a maximum value $v_2^{\\text{max}} = 10 - 0 = 10$.\nThus, the variability range for $v_2$ (and $v_3$) is $[1.5, 10.0]$.\n\nThis entire procedure is implemented systematically for all reactions in each of the three test cases using the `scipy.optimize.linprog` function to solve the LPs. The final results are aggregated and formatted as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef _solve_fva_for_case(S, c_obj, l, u, alpha):\n    \"\"\"\n    Performs Flux Variability Analysis for a single metabolic network case.\n    \"\"\"\n    m, n = S.shape\n\n    # Step 1: Flux Balance Analysis (FBA) to find the optimal objective value z*\n    # We maximize c_obj.T @ v by minimizing -c_obj.T @ v.\n    c_fba = -c_obj\n    bounds_fba = list(zip(l, u))\n\n    fba_result = linprog(c=c_fba, A_eq=S, b_eq=np.zeros(m), bounds=bounds_fba, method='highs')\n\n    if not fba_result.success:\n        # For a valid problem, FBA should be feasible.\n        raise ValueError(\"FBA optimization failed for a test case.\")\n\n    z_opt = -fba_result.fun\n\n    # Step 2: Flux Variability Analysis (FVA)\n    fva_threshold = alpha * z_opt\n\n    # Common constraints for all FVA LPs:\n    # S @ v = 0 (equality)\n    # l = v = u (bounds)\n    # c_obj.T @ v >= fva_threshold  => -c_obj.T @ v = -fva_threshold (inequality)\n    A_ub_fva = -c_obj.reshape(1, -1)\n    b_ub_fva = np.array([-fva_threshold])\n    \n    variability_results = []\n    \n    for j in range(n):\n        # -- Minimize v_j --\n        c_min = np.zeros(n)\n        c_min[j] = 1\n        min_result = linprog(c=c_min, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=np.zeros(m), bounds=bounds_fba, method='highs')\n        min_vj = min_result.fun if min_result.success else np.nan\n\n        # -- Maximize v_j --\n        c_max = np.zeros(n)\n        c_max[j] = -1\n        max_result = linprog(c=c_max, A_ub=A_ub_fva, b_ub=b_ub_fva, A_eq=S, b_eq=np.zeros(m), bounds=bounds_fba, method='highs')\n        max_vj = -max_result.fun if max_result.success else np.nan\n\n        # Round to 6 decimal places as required.\n        variability_results.append([round(min_vj, 6), round(max_vj, 6)])\n        \n    return variability_results\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (\n            np.array([[1, -1, 0], [0, 1, -1]]),\n            np.array([0, 0, 1]),\n            np.array([0, 0, 0]),\n            np.array([10, 1000, 1000]),\n        ),\n        # Test Case 2\n        (\n            np.array([[1, -1, 0, -1], [0, 1, -1, 0]]),\n            np.array([0, 0, 1, 1]),\n            np.array([0, 0, 0, 0]),\n            np.array([10, 1000, 1000, 8]),\n        ),\n        # Test Case 3\n        (\n            np.array([[1, -1, 0, -1], [0, 1, -1, 0]]),\n            np.array([0, 0, 1, 1]),\n            np.array([0, 0, 0, 0]),\n            np.array([10, 0, 1000, 6]),\n        ),\n    ]\n\n    alpha = 0.95\n    results = []\n    for S, c, l, u in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        case_result = _solve_fva_for_case(S, c, l, u, alpha)\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # Convert the list of lists of lists to a string and remove spaces to match the specified output format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "One of the most powerful applications of FVA is its ability to uncover non-obvious, system-wide effects. This advanced exercise  presents a seemingly paradoxical scenario where tightening a constraint on one reaction paradoxically increases the flexibility of another. Solving this problem will deepen your understanding of metabolic rerouting and the interconnected nature of cellular metabolism, demonstrating that local perturbations can have complex and non-local consequences that are difficult to predict without a systems-level analysis.",
            "id": "4343402",
            "problem": "Consider a steady-state metabolic network in a single compartment with three internal metabolites, $S$, $B$, and $C$. The network consists of the following irreversible reactions with fluxes $v_1, v_2, \\dots, v_7$:\n\n$R_1$: Uptake, $\\emptyset \\rightarrow S$, flux $v_1$.\n\n$R_2$: Conversion, $S \\rightarrow B$, flux $v_2$.\n\n$R_3$: Conversion, $S \\rightarrow C$, flux $v_3$.\n\n$R_4$: Biomass from $B$, $B \\rightarrow \\text{Biomass}$, flux $v_4$.\n\n$R_5$: Biomass from $C$, $C \\rightarrow \\text{Biomass}$, flux $v_5$.\n\n$R_6$: Interconversion, $B \\rightarrow C$, flux $v_6$.\n\n$R_7$: Interconversion, $C \\rightarrow B$, flux $v_7$.\n\nAssume a standard Flux Balance Analysis (FBA) formulation: steady-state mass balance $S v = 0$ for the internal metabolites $S$, $B$, and $C$, together with lower and upper bounds on reaction rates. The Flux Variability Analysis (FVA) of a reaction is defined as the range of its feasible flux values under the constraints $S v = 0$, the given bounds, and the requirement that the objective flux is held at its optimal value as determined by FBA.\n\nImpose the following bounds:\n\n$0 \\leq v_1 \\leq 10$, $0 \\leq v_2 \\leq 10$, $0 \\leq v_3 \\leq 10$, $0 \\leq v_4 \\leq 10$, $0 \\leq v_5 \\leq 10$, $0 \\leq v_6 \\leq 10$, and $0 \\leq v_7 \\leq 2$.\n\nThe objective is to maximize the biomass production flux $v_4$.\n\n1. Using only the steady-state constraints and bounds, determine the optimal objective value $v_4^{\\star}$ under the baseline bounds above, and then compute the FVA range of $v_6$ when $v_4$ is constrained to equal $v_4^{\\star}$. Report the width of this range as a pure number.\n\n2. Now tighten a single bound by reducing the upper bound on $v_4$ from $10$ to $9$ while keeping all other bounds unchanged. Determine the new optimal objective value $v_4^{\\star}$ under this tightened bound, and compute the FVA range of $v_6$ when $v_4$ is constrained to equal this new $v_4^{\\star}$. Report the width of this range as a pure number.\n\n3. Compute the increase in the width of the FVA range for $v_6$ from the baseline case to the tightened-bound case. Express your final numerical answer as a pure number with no units. No rounding is required; report an exact value.",
            "solution": "The user has posed a problem in the domain of Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA), which are established methods in systems biomedicine. The problem is to be validated before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Metabolites (internal):** $S$, $B$, $C$.\n- **Reactions and Fluxes:**\n  - $R_1: \\emptyset \\rightarrow S$, flux $v_1$.\n  - $R_2: S \\rightarrow B$, flux $v_2$.\n  - $R_3: S \\rightarrow C$, flux $v_3$.\n  - $R_4: B \\rightarrow \\text{Biomass}$, flux $v_4$.\n  - $R_5: C \\rightarrow \\text{Biomass}$, flux $v_5$.\n  - $R_6: B \\rightarrow C$, flux $v_6$.\n  - $R_7: C \\rightarrow B$, flux $v_7$.\n- **Constraint:** Steady-state mass balance, $S v = 0$.\n- **Objective (Part 1  2):** Maximize biomass production flux $v_4$.\n- **Baseline Bounds (Part 1):**\n  - $0 \\leq v_1 \\leq 10$\n  - $0 \\leq v_2 \\leq 10$\n  - $0 \\leq v_3 \\leq 10$\n  - $0 \\leq v_4 \\leq 10$\n  - $0 \\leq v_5 \\leq 10$\n  - $0 \\leq v_6 \\leq 10$\n  - $0 \\leq v_7 \\leq 2$\n- **Tightened Bounds (Part 2):** Same as baseline, except $0 \\leq v_4 \\leq 9$.\n- **Tasks:**\n  1. For baseline bounds, find the optimal objective value $v_4^{\\star}$, then find the FVA range width for $v_6$ when $v_4=v_4^{\\star}$.\n  2. For tightened bounds, find the new optimal objective value $v_4^{\\star}$, then find the FVA range width for $v_6$ when $v_4$ is fixed to this new optimum.\n  3. Compute the increase in the FVA range width for $v_6$ from case 1 to case 2.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is based on Flux Balance Analysis and Flux Variability Analysis, which are standard, well-established computational techniques in metabolic engineering and systems biology. The concepts are scientifically sound.\n- **Well-Posed:** The problem provides a clearly defined metabolic network, a set of linear constraints (steady-state and flux bounds), and a linear objective function. This constitutes a standard Linear Programming (LP) problem, which is well-posed and guarantees a solution exists. The FVA post-processing is also a standard and well-defined procedure.\n- **Objective:** The problem is stated in precise mathematical and formal language, free of subjectivity or ambiguity.\n\nAll givens are self-contained and consistent. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A full solution will be provided.\n\n### Solution\n\nFirst, we write the steady-state mass balance equations, $S v = 0$, for the three internal metabolites $S$, $B$, and $C$.\n\nFor metabolite $S$: $v_1 - v_2 - v_3 = 0$\nFor metabolite $B$: $v_2 - v_4 + v_7 - v_6 = 0$\nFor metabolite $C$: $v_3 - v_5 + v_6 - v_7 = 0$\n\nThis can be written in matrix form $S v = 0$ where $v = [v_1, v_2, v_3, v_4, v_5, v_6, v_7]^T$ and the stoichiometric matrix $S$ is:\n$$\nS = \\begin{pmatrix}\n1  -1  -1  0  0  0  0 \\\\\n0  1  0  -1  0  -1  1 \\\\\n0  0  1  0  -1  1  -1\n\\end{pmatrix}\n$$\n\nThe problem is divided into three parts.\n\n**Part 1: Baseline Case**\n\nFirst, we perform FBA to find the maximum possible value of the objective flux, $v_4$. The problem is to maximize $v_4$ subject to the steady-state constraints and the baseline bounds.\n\nFrom the second steady-state equation, we can express the objective flux as:\n$v_4 = v_2 - v_6 + v_7$.\nTo maximize $v_4$, we must maximize $v_2$ and $v_7$ and minimize $v_6$. The bounds are $v_2 \\leq 10$, $v_7 \\leq 2$, and $v_6 \\geq 0$. This suggests a theoretical maximum of $v_4 = 10 - 0 + 2 = 12$. However, the flux $v_4$ itself is constrained by $v_4 \\leq 10$. Let's test if $v_4 = 10$ is achievable.\n\nIf we set $v_4 = 10$, the equation becomes $10 = v_2 - v_6 + v_7$. To achieve this, let's try to set $v_2$ to its maximum, $v_2 = 10$. This gives $10 = 10 - v_6 + v_7$, which simplifies to $v_6 = v_7$.\n\nNow we check consistency with other constraints:\n- The first equation is $v_1 = v_2 + v_3$. With $v_2 = 10$, we have $v_1 = 10 + v_3$. The bound $v_1 \\leq 10$ forces $v_3=0$, which in turn gives $v_1=10$. Both are within their bounds.\n- The third equation is $v_3 - v_5 + v_6 - v_7 = 0$. Using $v_3=0$ and $v_6=v_7$, we get $0 - v_5 + v_7 - v_7 = 0$, which yields $v_5=0$. This is compliant with its bound $0 \\leq v_5 \\leq 10$.\n- The condition $v_6 = v_7$ must also satisfy the bounds $0 \\leq v_6 \\leq 10$ and $0 \\leq v_7 \\leq 2$. This is possible if we choose any value for $v_6$ and $v_7$ such that $v_6=v_7$ and $0 \\leq v_6 \\leq 2$.\nSince a feasible flux distribution exists for $v_4=10$, the optimal objective value is $v_4^{\\star} = 10$.\n\nNext, we perform FVA for flux $v_6$, holding $v_4$ fixed at $v_4^{\\star}=10$. We need to find the minimum and maximum possible values of $v_6$ under these conditions. The constraints are:\n1. $v_1 - v_2 - v_3 = 0$\n2. $v_2 - 10 - v_6 + v_7 = 0 \\implies v_2 = 10 + v_6 - v_7$\n3. $v_3 - v_5 - v_7 + v_6 = 0 \\implies v_3 = v_5 - v_6 + v_7$\n4. The given flux bounds.\n\nFrom $v_2 = 10 + v_6 - v_7$ and the bound $v_2 \\leq 10$, we have $10 + v_6 - v_7 \\leq 10$, which simplifies to $v_6 \\leq v_7$.\nFrom $v_1 = v_2 + v_3 = (10 + v_6 - v_7) + (v_5 - v_6 + v_7) = 10 + v_5$. The bound $v_1 \\leq 10$ implies $10+v_5 \\leq 10$, so $v_5 \\leq 0$. With $v_5 \\geq 0$, we must have $v_5 = 0$.\n\nSo, for the FVA, the system is constrained by $v_5=0$ and $v_6 \\leq v_7$.\n- To find $\\min(v_6)$: The lower bound is $v_6 \\geq 0$. We check if $v_6=0$ is feasible. If $v_6=0$, then we need $0 \\leq v_7$. We can choose any $v_7$ such that $0 \\leq v_7 \\leq 2$. For instance, picking $v_7=1$ gives $v_2 = 10+0-1 = 9$ and $v_3 = 0-0+1=1$, which are both valid. Thus, $\\min(v_6)=0$.\n- To find $\\max(v_6)$: We have the constraints $v_6 \\leq v_7$ and $v_7 \\leq 2$. Together, they imply $v_6 \\leq 2$. Is $v_6=2$ feasible? If $v_6=2$, then we must have $2 \\leq v_7$. Combined with $v_7 \\leq 2$, this forces $v_7=2$. Let's check: $v_2 = 10+2-2=10$ (valid), $v_3 = 0-2+2=0$ (valid). Thus, $\\max(v_6)=2$.\n\nThe FVA range for $v_6$ in the baseline case is $[0, 2]$. The width of this range is $2-0=2$.\n\n**Part 2: Tightened-Bound Case**\n\nThe bounds are now identical to the baseline, except for $v_4$, which is $0 \\leq v_4 \\leq 9$.\nWe again maximize $v_4=v_2-v_6+v_7$. Since the achievable maximum without the bound on $v_4$ was $10$, the new maximum will be limited by the new bound. Thus, the new optimal objective value is $v_4^{\\star} = 9$. This is feasible, as shown by the flux distribution $v=\\{10, 10, 0, 9, 1, 3, 2\\}$, which respects all bounds.\n\nNow we perform FVA on $v_6$ with $v_4$ fixed at $v_4^{\\star}=9$. The constraints are:\n1. $v_1 - v_2 - v_3 = 0$\n2. $v_2 - 9 - v_6 + v_7 = 0 \\implies v_2 = 9 + v_6 - v_7$\n3. $v_3 - v_5 - v_7 + v_6 = 0 \\implies v_3 = v_5 - v_6 + v_7$\n4. All bounds, including the tightened $v_4=9$ bound.\n\nFrom $v_2 = 9 + v_6 - v_7$ and the bound $v_2 \\leq 10$, we deduce $9 + v_6 - v_7 \\leq 10$, which gives $v_6 - v_7 \\leq 1$.\nFrom $v_1 = v_2 + v_3 = (9 + v_6 - v_7) + (v_5 - v_6 + v_7) = 9 + v_5$. The bound $v_1 \\leq 10$ implies $9+v_5 \\leq 10$, yielding $v_5 \\leq 1$.\nWe also need $v_3 \\geq 0$, so $v_5 - v_6 + v_7 \\geq 0$, which means $v_6 \\leq v_5 + v_7$.\n\nTo find the range of $v_6$, we must find its minimum and maximum subject to:\n- $v_6 - v_7 \\leq 1$\n- $v_6 \\leq v_5 + v_7$\n- $0 \\leq v_5 \\leq 1$\n- $0 \\leq v_7 \\leq 2$\n- $v_6 \\geq 0$\n\n- To find $\\min(v_6)$: We can test $v_6=0$. The constraints become $0 - v_7 \\leq 1$ (always true for $v_7 \\geq 0$) and $0 \\leq v_5 + v_7$ (always true for $v_5, v_7 \\geq 0$). We can easily find valid fluxes, e.g., $v_5=0, v_7=1$. This gives $v_2=8$ and $v_3=1$. Thus, $\\min(v_6)=0$.\n- To find $\\max(v_6)$: We need to satisfy $v_6 \\leq v_7 + 1$ and $v_6 \\leq v_5 + v_7$. To get the highest possible value for $v_6$, we should choose the largest possible values for $v_5$ and $v_7$, which are $v_5=1$ and $v_7=2$.\n  - First inequality: $v_6 \\leq 2 + 1 = 3$.\n  - Second inequality: $v_6 \\leq 1 + 2 = 3$.\n  Both constraints suggest an upper limit of $v_6=3$. Is $v_6=3$ feasible? This would require finding $v_5, v_7$ such that $3 \\leq v_7+1$ (i.e., $v_7 \\geq 2$) and $3 \\leq v_5+v_7$ (i.e., $v_5+v_7 \\geq 3$). Given the bounds $v_7 \\leq 2$ and $v_5 \\leq 1$, these inequalities force $v_7=2$ and $v_5=1$. Let's check this point: $v_6=3, v_7=2, v_5=1$.\n   - $v_2 = 9 + 3 - 2 = 10$ (valid).\n   - $v_3 = 1 - 3 + 2 = 0$ (valid).\n   - $v_1 = 9+v_5 = 9+1=10$ (valid).\n  So, $\\max(v_6)=3$ is achievable.\n\nThe new FVA range for $v_6$ is $[0, 3]$. The width of this range is $3-0=3$.\n\n**Part 3: Increase in FVA Range Width**\n\nThe width of the FVA range for $v_6$ in the baseline case was $2$.\nThe width of the FVA range for $v_6$ in the tightened-bound case is $3$.\nThe increase in the width is the difference between the two:\nIncrease = (Width in tightened case) - (Width in baseline case) = $3 - 2 = 1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}