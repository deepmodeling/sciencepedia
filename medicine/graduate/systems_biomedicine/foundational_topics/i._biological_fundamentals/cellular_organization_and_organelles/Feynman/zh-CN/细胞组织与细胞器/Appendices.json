{
    "hands_on_practices": [
        {
            "introduction": "细胞过程依赖分子马达将化学能转化为机械功。本练习通过为细胞内运输的关键参与者——驱动蛋白（kinesin）——建立模型，来探讨这种能量转换的基本原理。通过计算失速力（即马达能产生的最大力），你将直接把三磷酸腺苷（ATP）水解的热力学能与马达的机械输出联系起来，从而定量理解其工作极限 。",
            "id": "4325955",
            "problem": "由三磷酸腺苷（ATP）驱动的驱动蛋白（kinesin）是一种二聚体马达蛋白，它通过将 ATP 水解的化学自由能转化为对抗外部负载的机械功，沿着微管前进。考虑一个紧密耦合的单循环化学-机械模型，在该模型中，每水解一个 ATP 分子，就发生一次大小为 $d$ 的净正向步进。假设负载相关的跃迁速率通过 Bell 型势垒形变遵循局部细致平衡，其中正向跃迁的有效负载分布长度为 $\\delta$。在外部负载 $F$ 下，粗粒化的正向和反向循环速率建模为\n$$\nk_{+}(F) \\;=\\; k_{\\text{ATP}} \\,\\exp\\!\\left(\\frac{\\Delta \\mu_{\\text{ATP}}}{k_{B} T}\\right)\\,\\exp\\!\\left(-\\,\\frac{F\\,\\delta}{k_{B} T}\\right),\n\\qquad\nk_{-}(F) \\;=\\; k_{\\text{ATP}} \\,\\exp\\!\\left(\\frac{F\\,(d-\\delta)}{k_{B} T}\\right),\n$$\n其中 $k_{\\text{ATP}}$ 是无负载时 ATP 的转换尝试频率，$\\Delta \\mu_{\\text{ATP}}$ 是在给定溶液条件下每个 ATP 分子可用的化学自由能，$k_{B}$ 是 Boltzmann 常数，$T$ 是绝对温度。沿轨道的稳态漂移速度 $v(F)$ 定义为 $v(F) = d\\,[\\,k_{+}(F) - k_{-}(F)\\,]$。失速力 $F_{\\text{stall}}$ 由条件 $v(F_{\\text{stall}})=0$ 定义。\n\n从非平衡热力学基本原理（热激活跃迁的局部细致平衡和化学势的定义）出发，根据循环亲和势推导失速条件，并计算以下参数值下的 $F_{\\text{stall}}$：\n- 步长：$d = 8.2\\,\\text{nm}$，\n- 负载分布长度：$\\delta = 3.0\\,\\text{nm}$，\n- 尝试频率：$k_{\\text{ATP}} = 80\\,\\text{s}^{-1}$，\n- 温度：$T = 310\\,\\text{K}$，\n- ATP 水解的标准转化 Gibbs 自由能：$\\Delta G^{\\circ'} = -30.5\\,\\text{kJ/mol}$，\n- 浓度：$[\\text{ATP}] = 1.0\\,\\text{mM}$，$[\\text{ADP}] = 10.0\\,\\mu\\text{M}$，$[\\text{Pi}] = 1.0\\,\\text{mM}$。\n\n使用每个 ATP 分子的化学自由能关系式，\n$$\n\\Delta \\mu_{\\text{ATP}} \\;=\\; -\\,\\frac{\\Delta G^{\\circ'}}{N_{A}} \\;+\\; k_{B} T \\,\\ln\\!\\left(\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]}\\right),\n$$\n其中 $N_{A}$ 是 Avogadro 数，$R = N_{A} k_{B}$ 是摩尔气体常数。取 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$，$N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$，以及 $R = 8.314462618\\,\\text{J/mol/K}$。以皮牛顿（pN）为单位表示最终的失速力，并将答案四舍五入到四位有效数字。",
            "solution": "用户希望我解决以下问题：\n由三磷酸腺苷（ATP）驱动的驱动蛋白（kinesin）是一种二聚体马达蛋白，它通过将 ATP 水解的化学自由能转化为对抗外部负载的机械功，沿着微管前进。考虑一个紧密耦合的单循环化学-机械模型，在该模型中，每水解一个 ATP 分子，就发生一次大小为 $d$ 的净正向步进。假设负载相关的跃迁速率通过 Bell 型势垒形变遵循局部细致平衡，其中正向跃迁的有效负载分布长度为 $\\delta$。在外部负载 $F$ 下，粗粒化的正向和反向循环速率建模为\n$$\nk_{+}(F) \\;=\\; k_{\\text{ATP}} \\,\\exp\\!\\left(\\frac{\\Delta \\mu_{\\text{ATP}}}{k_{B} T}\\right)\\,\\exp\\!\\left(-\\,\\frac{F\\,\\delta}{k_{B} T}\\right),\n\\qquad\nk_{-}(F) \\;=\\; k_{\\text{ATP}} \\,\\exp\\!\\left(\\frac{F\\,(d-\\delta)}{k_{B} T}\\right),\n$$\n其中 $k_{\\text{ATP}}$ 是无负载时 ATP 的转换尝试频率，$\\Delta \\mu_{\\text{ATP}}$ 是在给定溶液条件下每个 ATP 分子可用的化学自由能，$k_{B}$ 是 Boltzmann 常数，$T$ 是绝对温度。沿轨道的稳态漂移速度 $v(F)$ 定义为 $v(F) = d\\,[\\,k_{+}(F) - k_{-}(F)\\,]$。失速力 $F_{\\text{stall}}$ 由条件 $v(F_{\\text{stall}})=0$ 定义。\n\n从非平衡热力学基本原理（热激活跃迁的局部细致平衡和化学势的定义）出发，根据循环亲和势推导失速条件，并计算以下参数值下的 $F_{\\text{stall}}$：\n- 步长：$d = 8.2\\,\\text{nm}$，\n- 负载分布长度：$\\delta = 3.0\\,\\text{nm}$，\n- 尝试频率：$k_{\\text{ATP}} = 80\\,\\text{s}^{-1}$，\n- 温度：$T = 310\\,\\text{K}$，\n- ATP 水解的标准转化 Gibbs 自由能：$\\Delta G^{\\circ'} = -30.5\\,\\text{kJ/mol}$，\n- 浓度：$[\\text{ATP}] = 1.0\\,\\text{mM}$，$[\\text{ADP}] = 10.0\\,\\mu\\text{M}$，$[\\text{Pi}] = 1.0\\,\\text{mM}$。\n\n使用每个 ATP 分子的化学自由能关系式，\n$$\n\\Delta \\mu_{\\text{ATP}} \\;=\\; -\\,\\frac{\\Delta G^{\\circ'}}{N_{A}} \\;+\\; k_{B} T \\,\\ln\\!\\left(\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]}\\right),\n$$\n其中 $N_{A}$ 是 Avogadro 数，$R = N_{A} k_{B}$ 是摩尔气体常数。取 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$，$N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$，以及 $R = 8.314462618\\,\\text{J/mol/K}$。以皮牛顿（pN）为单位表示最终的失速力，并将答案四舍五入到四位有效数字。\n\n### 第 1 步：提取已知条件\n\n提供的数据和定义如下：\n- 正向速率：$k_{+}(F) = k_{\\text{ATP}} \\exp(\\frac{\\Delta \\mu_{\\text{ATP}}}{k_{B} T})\\exp(-\\frac{F\\delta}{k_{B} T})$\n- 反向速率：$k_{-}(F) = k_{\\text{ATP}} \\exp(\\frac{F(d-\\delta)}{k_{B} T})$\n- 速度：$v(F) = d [k_{+}(F) - k_{-}(F)]$\n- 失速条件：$v(F_{\\text{stall}}) = 0$\n- 每个分子的化学自由能：$\\Delta \\mu_{\\text{ATP}} = -\\frac{\\Delta G^{\\circ'}}{N_{A}} + k_{B} T \\ln(\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]})$\n- 步长：$d = 8.2\\,\\text{nm}$\n- 负载分布长度：$\\delta = 3.0\\,\\text{nm}$\n- 尝试频率：$k_{\\text{ATP}} = 80\\,\\text{s}^{-1}$\n- 温度：$T = 310\\,\\text{K}$\n- 标准自由能：$\\Delta G^{\\circ'} = -30.5\\,\\text{kJ/mol}$\n- 浓度：$[\\text{ATP}] = 1.0\\,\\text{mM}$，$[\\text{ADP}] = 10.0\\,\\mu\\text{M}$，$[\\text{Pi}] = 1.0\\,\\text{mM}$\n- 常数：$k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J/K}$，$N_{A} = 6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}$，$R = 8.314462618\\,\\text{J/mol/K}$\n\n### 第 2 步：使用提取的已知条件进行验证\n\n该问题具有科学依据，采用了单分子生物物理学和化学热力学中的标准模型（Bell 模型、化学势的定义）。所提供的参数对于在生理条件下运行的 kinesin 马达是物理上真实的。该问题是适定的，提供了推导失速力唯一解所需的所有方程、常数和参数。术语精确且客观。没有矛盾、歧义或事实错误。该问题是定量生物物理学中的一个有效练习。\n\n### 第 3 步：结论和行动\n\n问题是有效的。将提供完整解答。\n\n### 解答\n\n解答过程分两个阶段。首先，我们从给定的动力学模型中推导失速力 $F_{\\text{stall}}$ 的一般表达式。其次，我们使用给定的参数计算 $F_{\\text{stall}}$ 的数值。\n\n**1. 失速力条件的推导**\n\n失速力 $F_{\\text{stall}}$ 定义为使马达净速度为零的外部负载 $F$。\n$$\nv(F_{\\text{stall}}) = 0\n$$\n使用给定的速度表达式 $v(F) = d[k_{+}(F) - k_{-}(F)]$，并注意到步长 $d$ 非零，失速条件意味着正向和反向有效速率必须相等：\n$$\nk_{+}(F_{\\text{stall}}) = k_{-}(F_{\\text{stall}})\n$$\n这个条件表明，在特定负载 $F_{\\text{stall}}$ 下，化学-机械循环已达到细致平衡状态。我们代入速率 $k_{+}(F)$ 和 $k_{-}(F)$ 的给定表达式：\n$$\nk_{\\text{ATP}} \\,\\exp\\!\\left(\\frac{\\Delta \\mu_{\\text{ATP}}}{k_{B} T}\\right)\\,\\exp\\!\\left(-\\,\\frac{F_{\\text{stall}}\\,\\delta}{k_{B} T}\\right) = k_{\\text{ATP}} \\,\\exp\\!\\left(\\frac{F_{\\text{stall}}\\,(d-\\delta)}{k_{B} T}\\right)\n$$\n尝试频率前置因子 $k_{\\text{ATP}}$ 出现在等式两侧，因此可以消去。我们可以合并左侧的指数项：\n$$\n\\exp\\!\\left(\\frac{\\Delta \\mu_{\\text{ATP}} - F_{\\text{stall}}\\,\\delta}{k_{B} T}\\right) = \\exp\\!\\left(\\frac{F_{\\text{stall}}\\,(d-\\delta)}{k_{B} T}\\right)\n$$\n由于指数函数是一对一的，我们可以令指数的参数相等：\n$$\n\\frac{\\Delta \\mu_{\\text{ATP}} - F_{\\text{stall}}\\,\\delta}{k_{B} T} = \\frac{F_{\\text{stall}}\\,(d-\\delta)}{k_{B} T}\n$$\n两边同乘以 $k_{B} T$ 将方程简化为：\n$$\n\\Delta \\mu_{\\text{ATP}} - F_{\\text{stall}}\\,\\delta = F_{\\text{stall}}\\,(d-\\delta)\n$$\n现在我们求解 $F_{\\text{stall}}$，将所有含 $F_{\\text{stall}}$ 的项移到一边：\n$$\n\\Delta \\mu_{\\text{ATP}} = F_{\\text{stall}}\\,\\delta + F_{\\text{stall}}\\,d - F_{\\text{stall}}\\,\\delta\n$$\n涉及负载分布因子 $\\delta$ 的项相互抵消：\n$$\n\\Delta \\mu_{\\text{ATP}} = F_{\\text{stall}}\\,d\n$$\n求解 $F_{\\text{stall}}$，我们得到失速条件：\n$$\nF_{\\text{stall}} = \\frac{\\Delta \\mu_{\\text{ATP}}}{d}\n$$\n这个结果有明确的物理解释。在失速状态下，马达在一个步进中对抗负载所做的机械功 $W_{\\text{mech}} = F_{\\text{stall}}d$，必须与一个 ATP 分子水解所提供的化学自由能 $\\Delta \\mu_{\\text{ATP}}$ 完全平衡。这对应于在失速状态下能量转换的热力学效率为 $100\\%$，这是此类理想化的紧密耦合模型的一个关键特征。请注意，失速力与动力学参数 $k_{\\text{ATP}}$ 和 $\\delta$ 无关，因为它是一个纯粹的热力学性质。\n\n**2. 失速力的数值计算**\n\n为了计算 $F_{\\text{stall}}$，我们必须首先计算 $\\Delta \\mu_{\\text{ATP}}$ 的值。给定的公式是：\n$$\n\\Delta \\mu_{\\text{ATP}} = -\\frac{\\Delta G^{\\circ'}}{N_{A}} + k_{B} T \\ln\\!\\left(\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]}\\right)\n$$\n使用关系式 $R = N_{A} k_{B}$，这可以改写为用摩尔量表示的形式，便于计算：\n$$\n\\Delta \\mu_{\\text{ATP}} = \\frac{1}{N_{A}} \\left( - \\Delta G^{\\circ'} + RT \\ln\\!\\left(\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]}\\right) \\right)\n$$\n让我们首先计算释放的摩尔自由能，$\\Delta G_{\\text{released}} = - \\Delta G^{\\circ'} + RT \\ln(\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]})$。\n\n首先，我们确定反应商。浓度必须以摩尔单位（M）表示。\n$[\\text{ATP}] = 1.0\\,\\text{mM} = 1.0 \\times 10^{-3}\\,\\text{M}$\n$[\\text{ADP}] = 10.0\\,\\mu\\text{M} = 10.0 \\times 10^{-6}\\,\\text{M} = 1.0 \\times 10^{-5}\\,\\text{M}$\n$[\\text{Pi}] = 1.0\\,\\text{mM} = 1.0 \\times 10^{-3}\\,\\text{M}$\n\n浓度比为：\n$$\n\\frac{[\\text{ATP}]}{[\\text{ADP}][\\text{Pi}]} = \\frac{1.0 \\times 10^{-3}\\,\\text{M}}{(1.0 \\times 10^{-5}\\,\\text{M})(1.0 \\times 10^{-3}\\,\\text{M})} = \\frac{10^{-3}}{10^{-8}} = 10^{5}\n$$\n对数的参数是无量纲的，符合要求。\n\n现在，我们计算摩尔自由能的两个项。\n标准自由能项是：\n$$\n-\\Delta G^{\\circ'} = -(-30.5\\,\\text{kJ/mol}) = 30.5\\,\\text{kJ/mol} = 30500\\,\\text{J/mol}\n$$\n与浓度相关的项是：\n$$\nRT \\ln(10^{5}) = (8.314462618\\,\\text{J/mol/K})(310\\,\\text{K})\\ln(10^{5})\n$$\n$$\nRT \\ln(10^{5}) \\approx (2577.4834\\,\\text{J/mol})(11.512925) \\approx 29676.01\\,\\text{J/mol}\n$$\n每摩尔释放的总自由能是：\n$$\n\\Delta G_{\\text{released}} \\approx 30500\\,\\text{J/mol} + 29676.01\\,\\text{J/mol} = 60176.01\\,\\text{J/mol}\n$$\n为了求得每个分子的能量 $\\Delta \\mu_{\\text{ATP}}$，我们除以 Avogadro 数 $N_{A}$：\n$$\n\\Delta \\mu_{\\text{ATP}} = \\frac{60176.01\\,\\text{J/mol}}{6.02214076 \\times 10^{23}\\,\\text{mol}^{-1}} \\approx 9.99246 \\times 10^{-20}\\,\\text{J}\n$$\n现在我们可以用 $F_{\\text{stall}} = \\frac{\\Delta \\mu_{\\text{ATP}}}{d}$ 来计算失速力。步长必须以米为单位：\n$d = 8.2\\,\\text{nm} = 8.2 \\times 10^{-9}\\,\\text{m}$。\n$$\nF_{\\text{stall}} = \\frac{9.99246 \\times 10^{-20}\\,\\text{J}}{8.2 \\times 10^{-9}\\,\\text{m}} \\approx 1.21859 \\times 10^{-11}\\,\\text{N}\n$$\n问题要求答案以皮牛顿（pN）为单位，其中 $1\\,\\text{pN} = 10^{-12}\\,\\text{N}$。\n$$\nF_{\\text{stall}} \\approx 1.21859 \\times 10^{-11}\\,\\text{N} \\times \\frac{1\\,\\text{pN}}{10^{-12}\\,\\text{N}} = 12.1859\\,\\text{pN}\n$$\n最后，将结果四舍五入到四位有效数字，得到：\n$$\nF_{\\text{stall}} \\approx 12.19\\,\\text{pN}\n$$",
            "answer": "$$\n\\boxed{12.19}\n$$"
        },
        {
            "introduction": "细胞器的正常功能取决于从胞质溶胶中合成的蛋白质的选择性输入。本实践深入探讨线粒体蛋白质输入的动力学，这是一个由特异性分子识别和内膜电化学势共同驱动的过程。通过推导稳态输入速率，你将分析受体结合亲和力和膜电压如何协同控制蛋白质转运到线粒体基质的效率 。",
            "id": "4325921",
            "problem": "一种含有前导序列的核编码线粒体蛋白通过外膜转位酶（TOM）和内膜转位酶（TIM）途径被输入。考虑以下基于经过充分检验的动力学和热力学原理的机理和生物物理解释。蛋白质（$P$）首先与外膜上的一个TOM受体位点（$R$）结合，形成受体-蛋白复合物（$PR$）。该复合物随后通过TOM通道转运，与TIM23转位酶结合，完成向基质的输入。这两个基本步骤被建模如下：\n\n1. 外膜上的受体结合遵循二级缔合和一级解离动力学：$R + P \\xrightleftharpoons[k_{\\text{off}}]{k_{\\text{on}}} PR$，其中缔合速率常数为 $k_{\\text{on}}$，解离速率常数为 $k_{\\text{off}}$。\n\n2. 通过TIM23的转运由内膜电位 $\\Delta \\psi$（基质侧为负）驱动。对于携带净正电荷 $z$ 的前导序列，电压辅助的转运速率常数 $k_{\\text{trans}}$ 通过Eyring型势垒调制模型来描述，其中电场将活化能垒降低了电功 $z F |\\Delta \\psi|$ 的一个分数 $\\gamma$：\n$$\nk_{\\text{trans}} \\;=\\; k_{0} \\,\\exp\\!\\left(\\frac{\\gamma \\, z \\, F \\, |\\Delta \\psi|}{R \\, T}\\right),\n$$\n其中 $k_{0}$ 是零电位下的基准速率， $F$ 是法拉第常数， $R$ 是气体常数， $T$ 是绝对温度。\n\n假设每个线粒体有 $N_{R}$ 个独立的受体-通道单元（有效的TOM-TIM通道）。将 $P$ 视为具有均一的近膜浓度 $[P]$，并假设受体占据处于准稳态，即 $PR$ 的形成与消耗达到平衡。在这些假设下，总稳态输入通量（单位时间内每个线粒体输入的蛋白质数量）等于每个被占据单元的转运速率乘以被占据单元的数量。\n\n使用以下参数值：\n- $N_{R} = 200$,\n- $[P] = 1.0 \\times 10^{-7} \\ \\mathrm{M}$,\n- $k_{\\text{on}} = 2.0 \\times 10^{6} \\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$,\n- $k_{\\text{off}} = 1.0 \\ \\mathrm{s}^{-1}$,\n- $k_{0} = 8.0 \\ \\mathrm{s}^{-1}$,\n- $z = 9$,\n- $\\gamma = 0.03$,\n- $\\Delta \\psi = -150 \\ \\mathrm{mV}$ (在公式中使用 $|\\Delta \\psi|$),\n- $F = 96485 \\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$,\n- $R = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}$,\n- $T = 310 \\ \\mathrm{K}$,\n\n根据上述原理，推导总稳态输入速率 $J_{\\text{tot}}$ 的解析表达式，然后计算其数值。以每个线粒体每秒（$\\mathrm{s}^{-1}$）为单位表示最终输入速率，并将您的答案四舍五入到三位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取的已知条件\n- **模型：**一种核编码的线粒体蛋白（$P$）通过TOM和TIM途径输入。\n- **过程步骤1（结合）：**一个可逆反应 $R + P \\xrightleftharpoons[k_{\\text{off}}]{k_{\\text{on}}} PR$，其中 $R$ 是一个TOM受体位点，$PR$ 是受体-蛋白复合物。动力学为二级缔合（$k_{\\text{on}}$）和一级解离（$k_{\\text{off}}$）。\n- **过程步骤2（转运）：**转运速率常数 $k_{\\text{trans}}$ 是电压依赖性的，由Eyring型方程给出：\n$$k_{\\text{trans}} = k_{0} \\exp\\left(\\frac{\\gamma \\, z \\, F \\, |\\Delta \\psi|}{R \\, T}\\right)$$\n其中 $k_0$ 是基准速率，$\\gamma$ 是一个分数常数，$z$ 是前导序列的电荷，$F$ 是法拉第常数，$|\\Delta \\psi|$ 是内膜电位的大小，$R$ 是气体常数，$T$ 是绝对温度。\n- **假设：**\n    1. 每个线粒体有 $N_{R}$ 个独立的受体-通道单元。\n    2. 膜附近的蛋白质浓度是均一的，为 $[P]$。\n    3. 受体-蛋白复合物 $PR$ 处于准稳态。\n    4. 总稳态输入通量 $J_{\\text{tot}}$ 是每个被占据单元的转运速率乘以被占据单元的数量。\n- **参数值：**\n    - 每个线粒体的总受体单元数，$N_{R} = 200$。\n    - 蛋白质浓度，$[P] = 1.0 \\times 10^{-7} \\ \\mathrm{M}$。\n    - 缔合速率常数，$k_{\\text{on}} = 2.0 \\times 10^{6} \\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$。\n    - 解离速率常数，$k_{\\text{off}} = 1.0 \\ \\mathrm{s}^{-1}$。\n    - 基准转运速率，$k_{0} = 8.0 \\ \\mathrm{s}^{-1}$。\n    - 前导序列的净电荷，$z = 9$。\n    - 电压依赖因子，$\\gamma = 0.03$。\n    - 内膜电位，$\\Delta \\psi = -150 \\ \\mathrm{mV}$。\n    - 法拉第常数，$F = 96485 \\ \\mathrm{C}\\,\\mathrm{mol}^{-1}$。\n    - 气体常数，$R = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}$。\n    - 绝对温度，$T = 310 \\ \\mathrm{K}$。\n- **目标：**推导总稳态输入速率 $J_{\\text{tot}}$ 的解析表达式，并计算其数值，单位为每个线粒体每秒（$\\mathrm{s}^{-1}$），四舍五入到三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估。\n- **科学性：**该问题使用标准的生物物理学原理描述了线粒体蛋白质输入。受体-配体结合模型遵循质量作用动力学，而电压依赖性转运速率则通过一个物理上合理的类Eyring方程进行建模。这些是化学动力学和生物物理学中公认的形式体系。参数在现实的生理和生物物理范围内。\n- **良态问题：**该问题提供了一个清晰的、定量的模型和一套完整的参数，足以推导出唯一的解。\n- **客观性：**问题以精确、定量和无偏见的语言陈述。\n- **完整性和一致性：**提供了所有必需的常数和变量。对 $k_{\\text{trans}}$ 方程中指数项 $\\frac{\\gamma \\, z \\, F \\, |\\Delta \\psi|}{R \\, T}$ 的单位检查证实其为无量纲：分子的单位是 $(\\text{无单位}) \\cdot (\\text{无单位}) \\cdot (\\mathrm{C}\\,\\mathrm{mol}^{-1}) \\cdot (\\mathrm{V}) = \\mathrm{J}\\,\\mathrm{mol}^{-1}$，与分母的单位 $(\\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}) \\cdot (\\mathrm{K}) = \\mathrm{J}\\,\\mathrm{mol}^{-1}$ 相匹配。因此，该设置是一致的。\n\n### 步骤3：结论与行动\n该问题有效。这是一个基于标准模型的、定义明确的生物物理计算。将推导解答。\n\n### 推导与解答\n\n总输入通量 $J_{\\text{tot}}$ 定义为每个被占据受体的转运速率 $k_{\\text{trans}}$ 与被占据受体数量 $N_{\\text{occ}}$ 的乘积。\n$$J_{\\text{tot}} = k_{\\text{trans}} N_{\\text{occ}}$$\n为求得 $N_{\\text{occ}}$，我们对受体-蛋白复合物 $PR$ 使用准稳态假设。设 $N_{R}$ 为总受体数，$N_{\\text{occ}}$ 为被占据的受体数，$N_{\\text{free}}$ 为游离受体数。我们有 $N_{R} = N_{\\text{occ}} + N_{\\text{free}}$。\n\n在稳态下，$PR$ 复合物的生成速率等于其消失速率。生成速率与游离受体数量和蛋白质浓度 $[P]$ 成正比。生成速率为 $k_{\\text{on}} [P] N_{\\text{free}}$。$PR$ 复合物可以通过两条途径消失：以速率常数 $k_{\\text{off}}$ 解离回 $R+P$，以及以速率常数 $k_{\\text{trans}}$ 正向转运到基质中。因此，总消失速率为 $(k_{\\text{off}} + k_{\\text{trans}}) N_{\\text{occ}}$。\n\n令速率相等：\n$$k_{\\text{on}} [P] N_{\\text{free}} = (k_{\\text{off}} + k_{\\text{trans}}) N_{\\text{occ}}$$\n将 $N_{\\text{free}} = N_{R} - N_{\\text{occ}}$ 代入方程：\n$$k_{\\text{on}} [P] (N_{R} - N_{\\text{occ}}) = (k_{\\text{off}} + k_{\\text{trans}}) N_{\\text{occ}}$$\n$$k_{\\text{on}} [P] N_{R} - k_{\\text{on}} [P] N_{\\text{occ}} = (k_{\\text{off}} + k_{\\text{trans}}) N_{\\text{occ}}$$\n求解 $N_{\\text{occ}}$：\n$$k_{\\text{on}} [P] N_{R} = (k_{\\text{on}} [P] + k_{\\text{off}} + k_{\\text{trans}}) N_{\\text{occ}}$$\n$$N_{\\text{occ}} = N_{R} \\frac{k_{\\text{on}} [P]}{k_{\\text{on}} [P] + k_{\\text{off}} + k_{\\text{trans}}}$$\n现在我们将这个 $N_{\\text{occ}}$ 的表达式代入总通量 $J_{\\text{tot}}$ 的方程中：\n$$J_{\\text{tot}} = k_{\\text{trans}} \\left( N_{R} \\frac{k_{\\text{on}} [P]}{k_{\\text{on}} [P] + k_{\\text{off}} + k_{\\text{trans}}} \\right)$$\n这就是每个线粒体总输入速率所需的解析表达式。\n\n接下来，我们计算数值。\n首先，计算转运速率常数 $k_{\\text{trans}}$。膜电位的大小为 $|\\Delta \\psi| = |-150 \\ \\mathrm{mV}| = 150 \\ \\mathrm{mV} = 0.150 \\ \\mathrm{V}$。\n指数函数的参数为：\n$$\\frac{\\gamma \\, z \\, F \\, |\\Delta \\psi|}{R \\, T} = \\frac{(0.03)(9)(96485 \\ \\mathrm{C}\\,\\mathrm{mol}^{-1})(0.150 \\ \\mathrm{V})}{(8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1})(310 \\ \\mathrm{K})}$$\n分子计算：\n$$\\gamma \\, z \\, F \\, |\\Delta \\psi| = 0.27 \\times 96485 \\ \\mathrm{C}\\,\\mathrm{mol}^{-1} \\times 0.150 \\ \\mathrm{V} \\approx 3907.64 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}$$\n分母计算：\n$$R \\, T = 8.314 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1} \\times 310 \\ \\mathrm{K} \\approx 2577.34 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}$$\n指数的值为：\n$$\\frac{3907.64}{2577.34} \\approx 1.51614$$\n现在，我们求 $k_{\\text{trans}}$：\n$$k_{\\text{trans}} = k_{0} \\exp(1.51614) = (8.0 \\ \\mathrm{s}^{-1}) \\times \\exp(1.51614) \\approx (8.0 \\ \\mathrm{s}^{-1}) \\times 4.5546 \\approx 36.4368 \\ \\mathrm{s}^{-1}$$\n我们还需要计算 $k_{\\text{on}} [P]$ 这一项：\n$$k_{\\text{on}} [P] = (2.0 \\times 10^{6} \\ \\mathrm{M}^{-1}\\mathrm{s}^{-1})(1.0 \\times 10^{-7} \\ \\mathrm{M}) = 0.2 \\ \\mathrm{s}^{-1}$$\n现在，我们有了 $J_{\\text{tot}}$ 表达式的所有组成部分。另一个速率是 $k_{\\text{off}} = 1.0 \\ \\mathrm{s}^{-1}$。\n$$J_{\\text{tot}} = (36.4368 \\ \\mathrm{s}^{-1}) (200) \\left( \\frac{0.2 \\ \\mathrm{s}^{-1}}{0.2 \\ \\mathrm{s}^{-1} + 1.0 \\ \\mathrm{s}^{-1} + 36.4368 \\ \\mathrm{s}^{-1}} \\right)$$\n$$J_{\\text{tot}} = (36.4368 \\ \\mathrm{s}^{-1}) (200) \\left( \\frac{0.2}{37.6368} \\right)$$\n$$J_{\\text{tot}} \\approx (36.4368 \\ \\mathrm{s}^{-1}) (200) (0.0053139)$$\n$$J_{\\text{tot}} \\approx 38.724 \\ \\mathrm{s}^{-1}$$\n按要求将最终答案四舍五入到三位有效数字：\n$$J_{\\text{tot}} \\approx 38.7 \\ \\mathrm{s}^{-1}$$\n这表示在指定的稳态条件下，每个线粒体每秒输入的蛋白质分子数量。",
            "answer": "$$\n\\boxed{38.7}\n$$"
        },
        {
            "introduction": "细胞组织并非一成不变，它涉及细胞器之间动态的通讯和调控。这个问题要求你对一个至关重要的信号系统进行建模：细胞内钙振荡，它由胞质溶胶和内质网之间的相互作用精心调控。通过实施并模拟一个成熟的动力学模型，你将获得计算系统生物学的实践经验，并探索反馈机制如何产生复杂的、随时间变化的细胞行为 。",
            "id": "4325949",
            "problem": "考虑一个描述钙在细胞质和内质网（ER）之间循环的单细胞模型。该细胞包含肌浆/内质网钙ATP酶（SERCA）泵，它将钙离子从细胞质主动转运到内质网；被动的内质网到细胞质的泄漏通道；以及肌醇$1,4,5$-三磷酸（IP3）受体，它将钙从内质网释放到细胞质。假设在模拟的时间尺度上，质膜通量可以忽略不计。设细胞质游离钙浓度为 $c(t)$（单位 $\\mu\\mathrm{M}$），内质网游离钙浓度为 $c_{\\mathrm{er}}(t)$（单位 $\\mu\\mathrm{M}$），IP3受体失活门为 $h(t)$（无量纲）。设细胞质与内质网的体积比为 $\\gamma$（无量纲）。所有时间均以秒（$\\mathrm{s}$）为单位。该模型必须根据以下原理和定义构建：\n\n- 仅存在室间通量的情况下，跨细胞质和内质网区室的质量守恒意味着从内质网到细胞质的净通量会增加 $c(t)$ 并减少 $c_{\\mathrm{er}}(t)$，其变化与区室体积比成比例。因此，\n$$\n\\frac{d c}{d t} = J_{\\mathrm{leak}} + J_{\\mathrm{IP3R}} - J_{\\mathrm{SERCA}}, \\quad \\frac{d c_{\\mathrm{er}}}{d t} = -\\frac{1}{\\gamma}\\,\\frac{d c}{d t}.\n$$\n\n- 从内质网到细胞质的被动泄漏通量与浓度差成正比：\n$$\nJ_{\\mathrm{leak}} = k_{\\mathrm{leak}} \\left(c_{\\mathrm{er}} - c\\right),\n$$\n其中 $k_{\\mathrm{leak}}$ 的单位是 $\\mathrm{s}^{-1}$。\n\n- SERCA泵通量遵循源自泵结合位点质量作用定律的Hill型摄取动力学：\n$$\nJ_{\\mathrm{SERCA}} = v_{\\mathrm{serca}} \\frac{c^{2}}{K_{\\mathrm{serca}}^{2} + c^{2}},\n$$\n其中 $v_{\\mathrm{serca}}$ 的单位是 $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$，$K_{\\mathrm{serca}}$ 的单位是 $\\mu\\mathrm{M}$。\n\n- IP3受体的开放概率由用于IP3结合和钙激活的快速激活门以及一个较慢的钙依赖性失活门控制。使用简化的De Young–Keizer/Li–Rinzel公式，定义稳态激活门和失活门动力学如下：\n$$\nm_{\\infty}(I) = \\frac{I}{I + d_{1}}, \\quad n_{\\infty}(c) = \\frac{c}{c + d_{5}},\n$$\n$$\nQ_{2}(I,c) = d_{2}\\,\\frac{I + d_{1}}{I + d_{3}}, \\quad h_{\\infty}(I,c) = \\frac{Q_{2}}{Q_{2} + c}, \\quad \\tau_{h}(I,c) = \\frac{1}{a_{2} \\left(Q_{2} + c\\right)},\n$$\n以及\n$$\n\\frac{d h}{d t} = \\frac{h_{\\infty}(I,c) - h}{\\tau_{h}(I,c)}.\n$$\nIP3受体通量由下式给出：\n$$\nJ_{\\mathrm{IP3R}} = k_{\\mathrm{ipr}}\\,p_{\\mathrm{open}}(I,c,h)\\,\\left(c_{\\mathrm{er}} - c\\right),\n$$\n其中开放概率为\n$$\np_{\\mathrm{open}}(I,c,h) = \\left[m_{\\infty}(I)\\right]^{3}\\,\\left[n_{\\infty}(c)\\right]^{3}\\,h^{3},\n$$\n且 $k_{\\mathrm{ipr}}$ 的单位是 $\\mathrm{s}^{-1}$。\n\n常数 $d_{1}$、$d_{2}$、$d_{3}$、$d_{5}$ 和 $a_{2}$ 是正的且不随时间变化。单位为：$d_{1}$、$d_{2}$、$d_{3}$、$d_{5}$ 的单位是 $\\mu\\mathrm{M}$，$a_{2}$ 的单位是 $\\mathrm{s}^{-1}\\,\\mu\\mathrm{M}^{-1}$。\n\n初始条件必须为\n$$\nc(0) = 0.1 \\ \\mu\\mathrm{M}, \\quad c_{\\mathrm{er}}(0) = 400 \\ \\mu\\mathrm{M}, \\quad h(0) = h_{\\infty}\\left(I, c(0)\\right).\n$$\n\n设固定参数为\n$$\n\\gamma = 5.0, \\quad K_{\\mathrm{serca}} = 0.2 \\ \\mu\\mathrm{M}, \\quad d_{1} = 0.13 \\ \\mu\\mathrm{M}, \\quad d_{2} = 1.049 \\ \\mu\\mathrm{M}, \\quad d_{3} = 0.94 \\ \\mu\\mathrm{M}, \\quad d_{5} = 0.08 \\ \\mu\\mathrm{M}, \\quad a_{2} = 0.2 \\ \\mathrm{s}^{-1}\\,\\mu\\mathrm{M}^{-1}.\n$$\n\n您的任务是编写一个完整、可运行的程序，该程序：\n- 对每个测试用例，使用适合潜在刚性动力学的数值稳定方法，在区间 $[0, 200]$ $\\mathrm{s}$ 上积分上述常微分方程组。\n- 根据细胞质钙时间序列 $c(t)$，通过在分析窗口 $[50, 200]$ $\\mathrm{s}$ 内检测 $c(t)$ 的峰值并计算平均峰间距，来计算主要的细胞质钙振荡频率（单位 $\\mathrm{Hz}$）。如果检测到的峰值少于2个（最小突起高度为 $0.05$ $\\mu\\mathrm{M}$），则该测试用例返回 $0.0$。将最终频率表示为以$\\mathrm{Hz}$为单位的浮点数。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序列出结果，并四舍五入到三位小数（例如，$\\left[\\text{result}_{1},\\text{result}_{2},\\ldots\\right]$）。\n\n使用以下测试套件来评估不同的动力学机制：\n- 测试用例1（一般振荡机制）：$I = 0.5$ $\\mu\\mathrm{M}$, $v_{\\mathrm{serca}} = 5.0$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{leak}} = 0.01$ $\\mathrm{s}^{-1}$, $k_{\\mathrm{ipr}} = 0.5$ $\\mathrm{s}^{-1}$。\n- 测试用例2（边界低IP3机制）：$I = 0.2$ $\\mu\\mathrm{M}$, $v_{\\mathrm{serca}} = 5.0$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{leak}} = 0.01$ $\\mathrm{s}^{-1}$, $k_{\\mathrm{ipr}} = 0.5$ $\\mathrm{s}^{-1}$。\n- 测试用例3（高SERCA摄取）：$I = 0.5$ $\\mu\\mathrm{M}$, $v_{\\mathrm{serca}} = 15.0$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{leak}} = 0.01$ $\\mathrm{s}^{-1}$, $k_{\\mathrm{ipr}} = 0.5$ $\\mathrm{s}^{-1}$。\n- 测试用例4（增强的泄漏）：$I = 0.5$ $\\mu\\mathrm{M}$, $v_{\\mathrm{serca}} = 5.0$ $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$, $k_{\\mathrm{leak}} = 0.05$ $\\mathrm{s}^{-1}$, $k_{\\mathrm{ipr}} = 0.5$ $\\mathrm{s}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]$），其中每个 $\\text{result}_{i}$ 是测试用例 $i$ 的主要振荡频率（单位 $\\mathrm{Hz}$），并四舍五入到三位小数。",
            "solution": "### 第1步：提取给定信息\n\n**状态变量：**\n- $c(t)$：细胞质游离钙浓度，单位 $\\mu\\mathrm{M}$。\n- $c_{\\mathrm{er}}(t)$：内质网游离钙浓度，单位 $\\mu\\mathrm{M}$。\n- $h(t)$：IP3受体失活门（无量纲）。\n\n**微分方程：**\n1.  $\\frac{d c}{d t} = J_{\\mathrm{leak}} + J_{\\mathrm{IP3R}} - J_{\\mathrm{SERCA}}$\n2.  $\\frac{d c_{\\mathrm{er}}}{d t} = -\\frac{1}{\\gamma}\\,\\frac{d c}{d t}$\n3.  $\\frac{d h}{d t} = \\frac{h_{\\infty}(I,c) - h}{\\tau_{h}(I,c)}$\n\n**通量和门控定义：**\n- 被动泄漏通量：$J_{\\mathrm{leak}} = k_{\\mathrm{leak}} \\left(c_{\\mathrm{er}} - c\\right)$\n- SERCA泵通量：$J_{\\mathrm{SERCA}} = v_{\\mathrm{serca}} \\frac{c^{2}}{K_{\\mathrm{serca}}^{2} + c^{2}}$\n- IP3受体通量：$J_{\\mathrm{IP3R}} = k_{\\mathrm{ipr}}\\,p_{\\mathrm{open}}(I,c,h)\\,\\left(c_{\\mathrm{er}} - c\\right)$\n- IP3R开放概率：$p_{\\mathrm{open}}(I,c,h) = \\left[m_{\\infty}(I)\\right]^{3}\\,\\left[n_{\\infty}(c)\\right]^{3}\\,h^{3}$\n- IP3R门控变量：\n    - $m_{\\infty}(I) = \\frac{I}{I + d_{1}}$\n    - $n_{\\infty}(c) = \\frac{c}{c + d_{5}}$\n    - $Q_{2}(I,c) = d_{2}\\,\\frac{I + d_{1}}{I + d_{3}}$\n    - $h_{\\infty}(I,c) = \\frac{Q_{2}}{Q_{2} + c}$\n    - $\\tau_{h}(I,c) = \\frac{1}{a_{2} \\left(Q_{2} + c\\right)}$\n\n**固定参数和单位：**\n- $\\gamma = 5.0$（无量纲）\n- $K_{\\mathrm{serca}} = 0.2 \\ \\mu\\mathrm{M}$\n- $d_{1} = 0.13 \\ \\mu\\mathrm{M}$\n- $d_{2} = 1.049 \\ \\mu\\mathrm{M}$\n- $d_{3} = 0.94 \\ \\mu\\mathrm{M}$\n- $d_{5} = 0.08 \\ \\mu\\mathrm{M}$\n- $a_{2} = 0.2 \\ \\mathrm{s}^{-1}\\,\\mu\\mathrm{M}^{-1}$\n- $k_{\\mathrm{leak}}$: $\\mathrm{s}^{-1}$\n- $v_{\\mathrm{serca}}$: $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{ipr}}$: $\\mathrm{s}^{-1}$\n- $I$: $\\mu\\mathrm{M}$\n\n**初始条件：**\n- $c(0) = 0.1 \\ \\mu\\mathrm{M}$\n- $c_{\\mathrm{er}}(0) = 400 \\ \\mu\\mathrm{M}$\n- $h(0) = h_{\\infty}\\left(I, c(0)\\right)$\n\n**任务：**\n1.  在 $t \\in [0, 200] \\ \\mathrm{s}$ 上积分ODE系统。\n2.  根据在区间 $[50, 200] \\ \\mathrm{s}$ 上的时间序列，计算 $c(t)$ 的主要振荡频率（单位 $\\mathrm{Hz}$）。\n3.  频率由平均峰间距确定。峰值必须具有至少 $0.05 \\ \\mu\\mathrm{M}$ 的突起高度。\n4.  如果检测到的峰值少于2个，则频率为 $0.0 \\ \\mathrm{Hz}$。\n5.  输出单行：一个用方括号括起来的逗号分隔列表，包含每个测试用例的频率，结果四舍五入到三位小数。\n\n**测试用例（参数 $[I, v_{\\mathrm{serca}}, k_{\\mathrm{leak}}, k_{\\mathrm{ipr}}]$）：**\n1.  $[0.5 \\ \\mu\\mathrm{M}, 5.0 \\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}, 0.01 \\ \\mathrm{s}^{-1}, 0.5 \\ \\mathrm{s}^{-1}]$\n2.  $[0.2 \\ \\mu\\mathrm{M}, 5.0 \\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}, 0.01 \\ \\mathrm{s}^{-1}, 0.5 \\ \\mathrm{s}^{-1}]$\n3.  $[0.5 \\ \\mu\\mathrm{M}, 15.0 \\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}, 0.01 \\ \\mathrm{s}^{-1}, 0.5 \\ \\mathrm{s}^{-1}]$\n4.  $[0.5 \\ \\mu\\mathrm{M}, 5.0 \\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}, 0.05 \\ \\mathrm{s}^{-1}, 0.5 \\ \\mathrm{s}^{-1}]$\n\n### 第2步：使用提取的给定信息进行验证\n\n- **科学依据：** 该问题描述了一个简化的Li-Rinzel模型，这是一个用于细胞内钙动力学的成熟且广泛使用的数学模型。通量（$J_{\\mathrm{leak}}$、$J_{\\mathrm{SERCA}}$、$J_{\\mathrm{IP3R}}$）基于标准的生物物理和酶动力学原理（菲克扩散定律、Hill动力学和Hodgkin-Huxley型通道门控）。该模型在科学上是合理的。\n- **适定性：** 该问题提供了一个完整的常微分方程（ODE）系统，包括所有必要的功能形式、参数值和初始条件。任务明确定义：积分系统并执行特定的时间序列分析。这种结构确保了唯一解的存在。\n- **客观性：** 问题使用精确的数学和科学语言陈述。没有主观或含糊的术语。\n- **完整性和一致性：** 为每个测试用例提供了所有必需的参数。对微分方程中所有项的单位进行的分析证实了它们在量纲上是一致的。从 $c$ 和 $c_{\\mathrm{er}}$ 的方程导出的守恒定律简化了系统，但没有引入矛盾。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。它在科学上是合理的，是适定的，并且为求解提供了所有必要的信息。\n\n### 求解\n\n该问题要求对一个模拟细胞内钙动力学的三变量常微分方程（ODE）系统进行数值积分，然后对所得的细胞质钙浓度 $c(t)$ 进行频率分析。\n\n**1. 通过守恒定律简化系统**\n\n给定的ODE是：\n$$\n\\frac{d c}{d t} = J_{\\mathrm{net}}\n$$\n$$\n\\frac{d c_{\\mathrm{er}}}{d t} = -\\frac{1}{\\gamma}\\,\\frac{d c}{d t}\n$$\n其中 $J_{\\mathrm{net}} = J_{\\mathrm{leak}} + J_{\\mathrm{IP3R}} - J_{\\mathrm{SERCA}}$。第二个方程意味着一个守恒定律。重新排列得到 $\\gamma \\frac{d c_{\\mathrm{er}}}{d t} + \\frac{d c}{d t} = 0$，这是不正确的。正确的关系源于总钙量守恒，$N = c V_{cyt} + c_{er} V_{er}$。两边除以 $V_{er}$ 并对时间求导，得到 $\\frac{d}{dt}(c \\frac{V_{cyt}}{V_{er}} + c_{er}) = \\frac{d}{dt}(c \\gamma + c_{er}) = 0$。然而，问题陈述提供了 $\\frac{dc_{er}}{dt} = -\\frac{1}{\\gamma} \\frac{dc}{dt}$。这导致了量 $c_{\\mathrm{er}}(t) + \\frac{1}{\\gamma}c(t)$ 的守恒。我们定义一个常数 $C_0$：\n$$\nC_0 = c_{\\mathrm{er}}(0) + \\frac{1}{\\gamma}c(0)\n$$\n这使我们能够用 $c(t)$ 代数地表示 $c_{\\mathrm{er}}(t)$：\n$$\nc_{\\mathrm{er}}(t) = C_0 - \\frac{1}{\\gamma}c(t)\n$$\n通过将此表达式代入通量方程，原始的关于 $(c, c_{\\mathrm{er}}, h)$ 的三变量ODE系统可以简化为关于状态变量 $(c, h)$ 的计算效率更高的二变量ODE系统。\n\n**2. 简化的ODE系统**\n\n状态向量为 $y(t) = [c(t), h(t)]^T$。简化的系统为：\n\n1.  $\\frac{dc}{dt} = k_{\\mathrm{leak}} \\left( (C_0 - \\frac{c}{\\gamma}) - c \\right) + k_{\\mathrm{ipr}} p_{\\mathrm{open}}(I,c,h) \\left( (C_0 - \\frac{c}{\\gamma}) - c \\right) - v_{\\mathrm{serca}} \\frac{c^{2}}{K_{\\mathrm{serca}}^{2} + c^{2}}$\n2.  $\\frac{dh}{dt} = \\frac{h_{\\infty}(I,c) - h}{\\tau_{h}(I,c)}$\n\n其中 $p_{\\mathrm{open}}$、$h_{\\infty}$ 和 $\\tau_h$ 是 $c$、$h$ 和IP3浓度参数 $I$ 的函数，如问题中所定义。$h(0)$ 的初始条件计算为 $h_{\\infty}(I, c(0))$。\n\n**3. 数值积分**\n\n问题指出动力学可能是刚性的。当系统中存在广泛不同的时间尺度时（例如，快速的钙变化与缓慢的失活门动力学），就会发生这种情况。标准的显式ODE求解器可能会变得数值不稳定，或需要过小的步长。因此，需要一个专为刚性ODE设计的求解器。SciPy库中的`scipy.integrate.solve_ivp`函数提供了几种合适的方法。`LSODA`方法是一个稳健的选择，因为它能自动检测刚性并能在非刚性（Adams）和刚性（BDF）求解器之间切换，从而同时提供准确性和效率。该系统在时间区间 $[0, 200] \\ \\mathrm{s}$上进行积分。解在足够多的时间点上进行评估（例如，$\\Delta t = 0.05 \\ \\mathrm{s}$），以精确解析振荡的形状，用于后续分析。\n\n**4. 频率分析**\n\n在获得细胞质钙的时间序列 $c(t)$ 后，计算其主要振荡频率。\n-   分析仅限于时间窗口 $[50, 200] \\ \\mathrm{s}$，以排除初始瞬态并分析伪稳态振荡行为。\n-   使用`scipy.signal.find_peaks`函数来识别此窗口内 $c(t)$ 信号的局部最大值的时间点。一个峰值被认为是显著的，需要至少 $0.05 \\ \\mu\\mathrm{M}$ 的突起高度，这可以滤除微小的波动和噪声。突起高度衡量一个峰值从其周围信号中突出的程度。\n-   如果在时间 $t_1, t_2, \\dots, t_N$ 检测到至少两个显著的峰值，则振荡的平均周期 $\\bar{T}$ 计算为峰间距的平均值：\n    $$\n    \\bar{T} = \\frac{1}{N-1}\\sum_{i=1}^{N-1}(t_{i+1} - t_i) = \\frac{t_N - t_1}{N-1}\n    $$\n-   主要频率 $f$（单位为赫兹，$\\mathrm{Hz}$）是平均周期的倒数：\n    $$\n    f = \\frac{1}{\\bar{T}}\n    $$\n-   如果找到的峰值少于两个，则表明系统要么没有振荡，要么振荡太小不满足突起高度的标准。在这种情况下，根据问题规范，频率报告为 $0.0 \\ \\mathrm{Hz}$。\n\n对四个测试用例中的每一个重复此过程，收集并格式化所得频率以用于最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Solves the calcium dynamics ODE system for four test cases and calculates\n    the oscillation frequency for each.\n    \"\"\"\n    \n    # Fixed model parameters\n    gamma = 5.0\n    K_serca = 0.2\n    d1 = 0.13\n    d2 = 1.049\n    d3 = 0.94\n    d5 = 0.08\n    a2 = 0.2\n\n    # Fixed initial conditions\n    c0 = 0.1\n    cer0 = 400.0\n\n    # Test cases: tuples of (I, v_serca, k_leak, k_ipr)\n    test_cases = [\n        (0.5, 5.0, 0.01, 0.5),   # Case 1: General oscillatory regime\n        (0.2, 5.0, 0.01, 0.5),   # Case 2: Boundary low-IP3 regime\n        (0.5, 15.0, 0.01, 0.5),  # Case 3: High SERCA uptake\n        (0.5, 5.0, 0.05, 0.5),   # Case 4: Enhanced leak\n    ]\n\n    results = []\n\n    def calcium_model(t, y, params):\n        \"\"\"\n        Defines the reduced 2-variable ODE system for calcium dynamics.\n        State vector y = [c, h].\n        \"\"\"\n        c, h = y\n        I, v_serca, k_leak, k_ipr, C0 = params\n\n        # Algebraic relation for c_er from the conservation law\n        c_er = C0 - c / gamma\n\n        # Flux expressions\n        j_leak = k_leak * (c_er - c)\n        j_serca = v_serca * c**2 / (K_serca**2 + c**2)\n        \n        m_inf = I / (I + d1)\n        n_inf = c / (c + d5)\n        p_open = (m_inf**3) * (n_inf**3) * (h**3)\n        j_ip3r = k_ipr * p_open * (c_er - c)\n\n        # Rate of change of cytosolic calcium concentration\n        dc_dt = j_leak + j_ip3r - j_serca\n\n        # Rate of change of the inactivation gate h\n        Q2 = d2 * (I + d1) / (I + d3)\n        h_inf = Q2 / (Q2 + c)\n        tau_h = 1.0 / (a2 * (Q2 + c))\n        dh_dt = (h_inf - h) / tau_h\n\n        return [dc_dt, dh_dt]\n\n    for case in test_cases:\n        I, v_serca, k_leak, k_ipr = case\n        \n        # Calculate the conserved quantity C0 from initial conditions\n        C0_val = cer0 + c0 / gamma\n        \n        # Calculate the initial condition for h\n        Q2_0 = d2 * (I + d1) / (I + d3)\n        h_inf_0 = Q2_0 / (Q2_0 + c0)\n        h0 = h_inf_0\n\n        y0 = [c0, h0]\n        current_params = (I, v_serca, k_leak, k_ipr, C0_val)\n\n        # Set up and run the ODE solver\n        t_span = [0.0, 200.0]\n        # Use enough points for accurate peak detection\n        t_eval = np.linspace(t_span[0], t_span[1], 4001)\n        \n        sol = solve_ivp(\n            fun=calcium_model,\n            t_span=t_span,\n            y0=y0,\n            method='LSODA',  # Robust method for potentially stiff problems\n            args=(current_params,),\n            t_eval=t_eval,\n        )\n        \n        t = sol.t\n        c = sol.y[0]\n\n        # --- Frequency Analysis ---\n        analysis_start_time = 50.0\n        min_prominence = 0.05\n        \n        # Isolate the analysis window [50, 200] s\n        start_idx = np.searchsorted(t, analysis_start_time, side='left')\n        \n        t_analysis = t[start_idx:]\n        c_analysis = c[start_idx:]\n        \n        # Find peaks with specified prominence\n        peaks, _ = find_peaks(c_analysis, prominence=min_prominence)\n        \n        frequency = 0.0\n        if len(peaks) >= 2:\n            peak_times = t_analysis[peaks]\n            # Calculate mean period from the first to the last peak\n            mean_period = (peak_times[-1] - peak_times[0]) / (len(peaks) - 1)\n            if mean_period > 1e-9: # Avoid division by zero\n                frequency = 1.0 / mean_period\n        \n        results.append(frequency)\n    \n    # Format the final output string as specified\n    # Rounding to 3 decimal places is handled by the f-string format specifier\n    output_str = f\"[{','.join([f'{r:.3f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}