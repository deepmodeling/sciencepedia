{
    "hands_on_practices": [
        {
            "introduction": "在系统生物医学中，我们经常需要测量如基因表达水平等连续变量。一个关键挑战是如何从有限的实验次数中，同时估计真实的平均效应及其变异性。本练习将演示一个用于解决此场景的核心贝叶斯工作流程。你将使用正态-逆伽马共轭先验来为具有未知均值和方差的正态分布建模，并推导出简洁的更新规则，将先验知识与观测数据相结合。 该实践对于量化许多生物测量模型中的不确定性至关重要。",
            "id": "4318423",
            "problem": "一个系统生物医学实验室正在使用源自患者的类器官复制品，量化一个应激通路基因对小分子扰动的转录响应。设观测到的 log$_{2}$ 倍数变化测量值被建模为来自具有未知均值和方差的正态分布的独立同分布样本，因此 $y_i \\mid \\mu, \\sigma^{2} \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，其中 $i = 1, \\dots, n$，且 log$_{2}$ 倍数变化是无量纲的。为了在有限复制的情况下实现连贯的不确定性量化，为参数对 $(\\mu, \\sigma^{2})$ 选择了一个共轭先验。\n\n通过将条件先验 $p(\\mu \\mid \\sigma^{2})$ 指定为正态分布，并将边际先验 $p(\\sigma^{2})$ 指定为逆伽马分布，来构建正态-逆伽马 (NIG) 共轭先验，其超参数如下：\n$$m_0 = 0.10, \\quad \\kappa_0 = 4, \\quad \\alpha_0 = 3, \\quad \\beta_0 = 0.02.$$\n采用以下参数化形式\n$$p(\\mu \\mid \\sigma^{2}) = \\sqrt{\\frac{\\kappa_0}{2\\pi \\sigma^{2}}}\\,\\exp\\!\\left(-\\frac{\\kappa_0}{2\\sigma^{2}}(\\mu - m_0)^{2}\\right),$$\n以及逆伽马密度函数\n$$p(\\sigma^{2}) = \\frac{\\beta_0^{\\alpha_0}}{\\Gamma(\\alpha_0)}\\,(\\sigma^{2})^{-(\\alpha_0+1)}\\,\\exp\\!\\left(-\\frac{\\beta_0}{\\sigma^{2}}\\right), \\quad \\sigma^{2} > 0,$$\n其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n从贝叶斯定理和上述定义出发，推导联合后验分布 $p(\\mu, \\sigma^{2} \\mid y_{1:n})$，并证明它是一个正态-逆伽马分布，其更新后的超参数 $\\{m_n, \\kappa_n, \\alpha_n, \\beta_n\\}$ 用观测测量的充分统计量表示，即样本大小 $n$、样本均值 $\\bar{y}$ 和校正平方和 $S = \\sum_{i=1}^{n}(y_i - \\bar{y})^{2}$。\n\n然后，对于以下 $n = 12$ 个观测到的 log$_{2}$ 倍数变化测量值\n$$y_1 = 0.30,\\; y_2 = -0.05,\\; y_3 = 0.12,\\; y_4 = 0.18,\\; y_5 = 0.26,\\; y_6 = 0.09,$$\n$$y_7 = 0.02,\\; y_8 = 0.21,\\; y_9 = 0.15,\\; y_{10} = 0.11,\\; y_{11} = 0.19,\\; y_{12} = 0.14,$$\n计算充分统计量 $(n, \\bar{y}, S)$ 并评估后验超参数 $(m_n, \\kappa_n, \\alpha_n, \\beta_n)$。\n\n将您的最终数值四舍五入到四位有效数字，并按 $(m_n, \\kappa_n, \\alpha_n, \\beta_n)$ 的顺序列在一个单行矩阵中。",
            "solution": "用户想要解决一个贝叶斯推断问题。我将首先验证问题陈述，如果有效，则继续进行详细的推导和计算。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n\n-   **似然模型**：数据 $y_i$（其中 $i=1, \\dots, n$）是来自正态分布的独立同分布（i.i.d.）样本，$y_i \\mid \\mu, \\sigma^2 \\sim \\mathcal{N}(\\mu, \\sigma^2)$。\n-   **先验分布**：为参数 $(\\mu, \\sigma^2)$ 指定了一个正态-逆伽马 (NIG) 共轭先验。\n    -   $\\mu$ 的条件先验：$p(\\mu \\mid \\sigma^2)$ 是正态分布，其密度为 $p(\\mu \\mid \\sigma^{2}) = \\sqrt{\\frac{\\kappa_0}{2\\pi \\sigma^{2}}}\\,\\exp\\!\\left(-\\frac{\\kappa_0}{2\\sigma^{2}}(\\mu - m_0)^{2}\\right)$。这对应于 $\\mu \\mid \\sigma^2 \\sim \\mathcal{N}(m_0, \\sigma^2/\\kappa_0)$。\n    -   $\\sigma^2$ 的边际先验：$p(\\sigma^2)$ 是逆伽马分布，其密度为 $p(\\sigma^{2}) = \\frac{\\beta_0^{\\alpha_0}}{\\Gamma(\\alpha_0)}\\,(\\sigma^{2})^{-(\\alpha_0+1)}\\,\\exp\\!\\left(-\\frac{\\beta_0}{\\sigma^{2}}\\right)$。这对应于 $\\sigma^2 \\sim \\text{Inverse-Gamma}(\\alpha_0, \\beta_0)$。\n-   **先验超参数**：$m_0 = 0.10$, $\\kappa_0 = 4$, $\\alpha_0 = 3$, $\\beta_0 = 0.02$。\n-   **观测数据**：提供了 $n = 12$ 个测量值：$y = (0.30, -0.05, 0.12, 0.18, 0.26, 0.09, 0.02, 0.21, 0.15, 0.11, 0.19, 0.14)$。\n-   **任务1**：推导联合后验分布 $p(\\mu, \\sigma^2 \\mid y_{1:n})$，并证明它是一个NIG分布，其更新后的超参数 $\\{m_n, \\kappa_n, \\alpha_n, \\beta_n\\}$ 用充分统计量 $(n, \\bar{y}, S)$ 表示，其中 $\\bar{y} = \\frac{1}{n}\\sum_{i=1}^n y_i$ 且 $S = \\sum_{i=1}^n (y_i - \\bar{y})^2$。\n-   **任务2**：为给定数据计算充分统计量和后验超参数的值。\n-   **输出格式**：$(m_n, \\kappa_n, \\alpha_n, \\beta_n)$ 的最终数值四舍五入到四位有效数字，以行矩阵形式呈现。\n\n**步骤2：使用提取的给定信息进行验证**\n\n-   **科学依据**：该问题是贝叶斯统计的一个标准应用。使用正态-逆伽马共轭先验的正态似然模型是一个教科书式的例子，广泛应用于包括系统生物医学在内的许多科学领域，用于对具有未知均值和方差的正态分布数据进行建模。该问题在科学上和数学上都是合理的。\n-   **适定性**：问题定义清晰。使用共轭先验确保了后验分布与先验分布属于同一族，并且其参数可以解析推导。问题要求进行此推导和后续计算，两者都导向一个唯一的解。\n-   **客观性**：问题使用精确的数学语言和客观数据陈述。没有主观或含糊的陈述。\n\n问题陈述没有违反任何指定的无效标准。它是完整的、一致的、有科学依据的并且是适定的。\n\n**步骤3：结论和行动**\n\n问题有效。我将继续进行详细解答。\n\n### 后验分布的推导\n\n根据贝叶斯定理，在给定数据 $y_{1:n}$ 的情况下，参数 $(\\mu, \\sigma^2)$ 的联合后验分布与似然函数和先验分布的乘积成正比：\n$$ p(\\mu, \\sigma^2 \\mid y_{1:n}) \\propto p(y_{1:n} \\mid \\mu, \\sigma^2) p(\\mu, \\sigma^2) $$\n联合先验 $p(\\mu, \\sigma^2)$ 可以表示为 $p(\\mu \\mid \\sigma^2)p(\\sigma^2)$。\n\n对于来自 $\\mathcal{N}(\\mu, \\sigma^2)$ 的 $n$ 个独立同分布观测值，其似然函数为：\n$$ p(y_{1:n} \\mid \\mu, \\sigma^2) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - \\mu)^2}{2\\sigma^2}\\right) = (2\\pi)^{-n/2} (\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\mu)^2\\right) $$\n\n联合先验分布由指定的条件先验和边际先验的乘积给出：\n$$ p(\\mu, \\sigma^2) = p(\\mu \\mid \\sigma^2) p(\\sigma^2) = \\left[ \\sqrt{\\frac{\\kappa_0}{2\\pi \\sigma^{2}}}\\,\\exp\\!\\left(-\\frac{\\kappa_0}{2\\sigma^{2}}(\\mu - m_0)^{2}\\right) \\right] \\left[ \\frac{\\beta_0^{\\alpha_0}}{\\Gamma(\\alpha_0)}\\,(\\sigma^{2})^{-(\\alpha_0+1)}\\,\\exp\\!\\left(-\\frac{\\beta_0}{\\sigma^{2}}\\right) \\right] $$\n忽略不依赖于 $\\mu$ 或 $\\sigma^2$ 的常数，先验分布正比于：\n$$ p(\\mu, \\sigma^2) \\propto (\\sigma^2)^{-1/2} \\exp\\left(-\\frac{\\kappa_0}{2\\sigma^2}(\\mu - m_0)^2\\right) (\\sigma^2)^{-(\\alpha_0+1)} \\exp\\left(-\\frac{\\beta_0}{\\sigma^2}\\right) $$\n$$ p(\\mu, \\sigma^2) \\propto (\\sigma^2)^{-(\\alpha_0 + 3/2)} \\exp\\left(-\\frac{1}{2\\sigma^2} \\left[ \\kappa_0(\\mu-m_0)^2 + 2\\beta_0 \\right] \\right) $$\n\n将似然函数核与先验核相乘，我们得到后验分布的核：\n$$ p(\\mu, \\sigma^2 \\mid y_{1:n}) \\propto (\\sigma^2)^{-n/2} \\exp\\left(-\\frac{1}{2\\sigma^2} \\sum_{i=1}^{n} (y_i - \\mu)^2\\right) \\times (\\sigma^2)^{-(\\alpha_0 + 3/2)} \\exp\\left(-\\frac{1}{2\\sigma^2} \\left[ \\kappa_0(\\mu-m_0)^2 + 2\\beta_0 \\right] \\right) $$\n合并各项：\n$$ p(\\mu, \\sigma^2 \\mid y_{1:n}) \\propto (\\sigma^2)^{-(n/2 + \\alpha_0 + 3/2)} \\exp\\left(-\\frac{1}{2\\sigma^2} \\left[ \\sum_{i=1}^{n} (y_i - \\mu)^2 + \\kappa_0(\\mu-m_0)^2 + 2\\beta_0 \\right] \\right) $$\n\n为确定后验分布的形式，我们通过对 $\\mu$ 进行配方来分析指数项。让我们展开包含 $\\mu$ 的项：\n$$ \\sum_{i=1}^{n} (y_i - \\mu)^2 + \\kappa_0(\\mu-m_0)^2 $$\n我们使用恒等式 $\\sum (y_i-\\mu)^2 = \\sum (y_i-\\bar{y}+\\bar{y}-\\mu)^2 = \\sum(y_i-\\bar{y})^2 + n(\\bar{y}-\\mu)^2 = S + n(\\bar{y}-\\mu)^2$。\n表达式变为：\n$$ S + n(\\bar{y}-\\mu)^2 + \\kappa_0(\\mu-m_0)^2 = S + n(\\mu^2 - 2\\mu\\bar{y} + \\bar{y}^2) + \\kappa_0(\\mu^2 - 2\\mu m_0 + m_0^2) $$\n$$ = S + (n+\\kappa_0)\\mu^2 - 2(n\\bar{y}+\\kappa_0 m_0)\\mu + (n\\bar{y}^2 + \\kappa_0 m_0^2) $$\n令 $\\kappa_n = \\kappa_0 + n$。对 $\\mu$ 进行配方：\n$$ = (n+\\kappa_0) \\left[ \\mu^2 - 2\\frac{n\\bar{y}+\\kappa_0 m_0}{n+\\kappa_0}\\mu \\right] + S + n\\bar{y}^2 + \\kappa_0 m_0^2 $$\n令 $m_n = \\frac{\\kappa_0 m_0 + n\\bar{y}}{\\kappa_0 + n}$。表达式为：\n$$ \\kappa_n \\left[ (\\mu-m_n)^2 - m_n^2 \\right] + S + n\\bar{y}^2 + \\kappa_0 m_0^2 = \\kappa_n(\\mu-m_n)^2 + S + n\\bar{y}^2 + \\kappa_0 m_0^2 - \\kappa_n m_n^2 $$\n不含 $\\mu$ 的项简化为：\n$$ S + n\\bar{y}^2 + \\kappa_0 m_0^2 - (\\kappa_0+n)\\left(\\frac{\\kappa_0 m_0 + n\\bar{y}}{\\kappa_0+n}\\right)^2 = S + \\frac{(n\\bar{y}^2 + \\kappa_0 m_0^2)(\\kappa_0+n) - (\\kappa_0 m_0 + n\\bar{y})^2}{\\kappa_0+n} $$\n$$ = S + \\frac{n\\kappa_0(\\bar{y}-m_0)^2}{\\kappa_0+n} $$\n将此代回后验核的指数项中，得到：\n$$ \\kappa_n(\\mu-m_n)^2 + S + \\frac{n\\kappa_0}{\\kappa_0+n}(\\bar{y}-m_0)^2 + 2\\beta_0 $$\n因此，完整的后验核为：\n$$ p(\\mu, \\sigma^2 \\mid y_{1:n}) \\propto (\\sigma^2)^{-(\\alpha_0 + n/2 + 3/2)} \\exp\\left(-\\frac{1}{2\\sigma^2} \\left[\\kappa_n(\\mu-m_n)^2 + 2\\beta_0 + S + \\frac{n\\kappa_0}{\\kappa_0+n}(\\bar{y}-m_0)^2 \\right] \\right) $$\n该表达式具有正态-逆伽马分布的形式，$p(\\mu, \\sigma^2) \\propto (\\sigma^2)^{-(\\alpha_n+3/2)}\\exp\\left(-\\frac{1}{2\\sigma^2}[\\kappa_n(\\mu-m_n)^2+2\\beta_n]\\right)$。\n通过比较各项，我们可以确定更新后的超参数：\n1.  $\\kappa_n = \\kappa_0 + n$\n2.  $m_n = \\frac{\\kappa_0 m_0 + n\\bar{y}}{\\kappa_0 + n}$\n3.  $\\alpha_n = \\alpha_0 + \\frac{n}{2}$\n4.  $2\\beta_n = 2\\beta_0 + S + \\frac{n\\kappa_0}{\\kappa_0+n}(\\bar{y}-m_0)^2 \\implies \\beta_n = \\beta_0 + \\frac{1}{2}S + \\frac{n\\kappa_0}{2(\\kappa_0+n)}(\\bar{y}-m_0)^2$\n\n推导到此结束。后验分布为 $p(\\mu, \\sigma^2 \\mid y_{1:n}) \\sim \\text{NIG}(m_n, \\kappa_n, \\alpha_n, \\beta_n)$。\n\n### 后验超参数的计算\n\n首先，我们从数据中计算充分统计量。\n-   样本大小 $n = 12$。\n-   样本和：$\\sum_{i=1}^{12} y_i = 0.30 - 0.05 + 0.12 + 0.18 + 0.26 + 0.09 + 0.02 + 0.21 + 0.15 + 0.11 + 0.19 + 0.14 = 1.72$。\n-   样本均值：$\\bar{y} = \\frac{1.72}{12} = \\frac{43}{300} \\approx 0.14333...$\n-   数据平方和：$\\sum_{i=1}^{12} y_i^2 = 0.30^2 + (-0.05)^2 + \\dots + 0.14^2 = 0.3498$。\n-   校正平方和：$S = \\sum y_i^2 - n\\bar{y}^2 = 0.3498 - 12\\left(\\frac{1.72}{12}\\right)^2 = 0.3498 - \\frac{1.72^2}{12} = 0.3498 - \\frac{2.9584}{12} = 0.3498 - 0.246533... = 0.103266...$\n\n现在，我们使用上面推导出的更新公式和先验超参数 $m_0=0.10, \\kappa_0=4, \\alpha_0=3, \\beta_0=0.02$。\n\n-   $\\kappa_n = \\kappa_0 + n = 4 + 12 = 16$。\n-   $\\alpha_n = \\alpha_0 + \\frac{n}{2} = 3 + \\frac{12}{2} = 3 + 6 = 9$。\n-   $m_n = \\frac{\\kappa_0 m_0 + n\\bar{y}}{\\kappa_0 + n} = \\frac{4(0.10) + 12(\\frac{1.72}{12})}{4+12} = \\frac{0.4 + 1.72}{16} = \\frac{2.12}{16} = 0.1325$。\n-   $\\beta_n = \\beta_0 + \\frac{1}{2}S + \\frac{n\\kappa_0}{2(\\kappa_0+n)}(\\bar{y}-m_0)^2$。\n    各个项分别为：\n    -   $\\beta_0 = 0.02$。\n    -   $\\frac{1}{2}S = \\frac{1}{2}(0.103266...) = 0.051633...$\n    -   最后一项：\n        $\\frac{n\\kappa_0}{2(\\kappa_0+n)}(\\bar{y}-m_0)^2 = \\frac{12 \\cdot 4}{2(16)}\\left(\\frac{1.72}{12}-0.10\\right)^2 = 1.5 \\left(\\frac{1.72-1.2}{12}\\right)^2 = 1.5\\left(\\frac{0.52}{12}\\right)^2 = 1.5 \\frac{0.2704}{144} = 0.0028166...$\n    -   对 $\\beta_n$ 的各项求和：\n        $\\beta_n = 0.02 + 0.051633... + 0.0028166... = 0.07445$。\n\n后验超参数为：\n$m_n = 0.1325$\n$\\kappa_n = 16$\n$\\alpha_n = 9$\n$\\beta_n = 0.07445$\n\n按照要求将这些值四舍五入到四位有效数字：\n$m_n = 0.1325$\n$\\kappa_n = 16.00$\n$\\alpha_n = 9.000$\n$\\beta_n = 0.07445$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1325  16.00  9.000  0.07445\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "想象一下，你正在研究一种疾病在不同医院的患病率。虽然每家医院都有其特定的数据，但它们都是一个更大群体的一部分，它们的结果应该能够相互提供信息。本练习将探讨贝塔-二项式分层模型，这是一个处理此类场景的强大工具。通过推导后验预测分布，你将看到贝叶斯推断如何自然地产生“部分池化”或“收缩”效应，即对单个组的估计是在局部数据和全局平均值之间的一种合理折衷。 这种在相关组之间“借用信息”的原则是现代生物医学统计学的基石。",
            "id": "4318486",
            "problem": "一个由多家医院的系统生物医学实验室组成的联盟正在使用定量聚合酶链式反应（qPCR）监测直肠拭子中特定抗生素抗性基因的携带情况。在任何一家医院 $j$ 中，某一天患者层面的携带结果被建模为可交换的伯努利试验，其未知的潜在流行率为 $\\theta_{j} \\in (0,1)$。在不同医院之间，假定潜在流行率 $\\theta_{j}$ 来自一个共同的群体水平分布，该分布反映了医院间的异质性。\n\n假设一项先前对多家医院进行的荟萃分析得出了一个科学上合理的群体水平先验，即潜在流行率服从超参数为 $\\alpha$ 和 $\\beta$ 的 Beta 分布，即 $\\theta_{j} \\sim \\operatorname{Beta}(\\alpha,\\beta)$。在某一天，特定医院 $j^{\\star}$ 处理了 $n$ 个独立同分布的患者拭子，其中有 $x$ 个对该抗性基因呈阳性反应。在医院 $j^{\\star}$ 的 Beta-二项可交换模型下，通过对潜在流行率 $\\theta_{j^{\\star}}$ 进行积分，从第一性原理推导该医院下一次伯努利试验 $Y_{\\text{next}} \\in \\{0,1\\}$ 的后验预测分布。明确展示部分池化如何通过这次积分，以医院特定的经验比例和群体水平先验均值的凸组合形式出现。\n\n对于一个具体计算，设医院 $j^{\\star}$ 的参数为 $\\alpha = 1.5$，$\\beta = 6.5$，$n = 12$ 和 $x = 7$。在该模型下，计算后验预测概率 $\\mathbb{P}(Y_{\\text{next}} = 1 \\mid \\text{data from } j^{\\star})$。将最终概率表示为小数，并四舍五入到四位有效数字。",
            "solution": "该问题提法清晰，在贝叶斯统计及其在系统生物医学中的应用框架内具有科学依据，并为得出唯一解提供了所有必要信息。\n\n令 $\\theta_{j^{\\star}} \\in (0,1)$ 表示特定医院 $j^{\\star}$ 中抗生素抗性基因的潜在流行率。为方便表示，我们将其简记为 $\\theta$。问题提供了一个层次模型结构。\n\n首先，我们定义潜在流行率 $\\theta$ 的先验分布。根据先前的荟萃分析，它是一个超参数为 $\\alpha$ 和 $\\beta$ 的 Beta 分布。其先验概率密度函数（PDF）为：\n$$\np(\\theta) = \\operatorname{Beta}(\\theta; \\alpha, \\beta) = \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}\n$$\n其中 $B(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha+\\beta)}$ 是 Beta 函数。\n\n其次，我们定义在给定潜在流行率 $\\theta$ 的情况下观测到数据的似然函数。数据包含 $n$ 个独立同分布（i.i.d.）的患者拭子，这些拭子被建模为可交换的伯努利试验。在 $n$ 次试验中，阳性拭子的数量 $x$ 服从二项分布。似然函数为：\n$$\np(x \\mid n, \\theta) = \\binom{n}{x} \\theta^x (1-\\theta)^{n-x}\n$$\n为简洁起见，我们将观测数据表示为 $D = \\{x, n\\}$。\n\n为了推导后验预测分布，我们必须首先求出给定数据 $D$ 时 $\\theta$ 的后验分布。根据贝叶斯定理，后验概率密度函数 $p(\\theta \\mid D)$ 与似然函数和先验的乘积成正比：\n$$\np(\\theta \\mid D) \\propto p(D \\mid \\theta) p(\\theta)\n$$\n代入似然函数和先验的表达式：\n$$\np(\\theta \\mid D) \\propto \\left[ \\binom{n}{x} \\theta^x (1-\\theta)^{n-x} \\right] \\left[ \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)} \\right]\n$$\n由于 $\\binom{n}{x}$ 和 $B(\\alpha, \\beta)$ 是关于 $\\theta$ 的常数，我们可以合并包含 $\\theta$ 的项：\n$$\np(\\theta \\mid D) \\propto \\theta^x (1-\\theta)^{n-x} \\theta^{\\alpha-1} (1-\\theta)^{\\beta-1} = \\theta^{\\alpha+x-1} (1-\\theta)^{\\beta+n-x-1}\n$$\n这个表达式是 Beta 分布的核。因此，$\\theta$ 的后验分布也是一个 Beta 分布，这一性质称为共轭性。更新后的超参数为 $\\alpha' = \\alpha+x$ 和 $\\beta' = \\beta+n-x$。完整的后验概率密度函数为：\n$$\np(\\theta \\mid D) = \\operatorname{Beta}(\\theta; \\alpha+x, \\beta+n-x) = \\frac{\\theta^{\\alpha+x-1} (1-\\theta)^{\\beta+n-x-1}}{B(\\alpha+x, \\beta+n-x)}\n$$\n\n现在，我们可以推导新伯努利试验 $Y_{\\text{next}} \\in \\{0, 1\\}$ 的后验预测分布。我们关心的是下一次试验成功的概率（即拭子呈阳性），即 $\\mathbb{P}(Y_{\\text{next}}=1 \\mid D)$。这个概率是通过将新观测的似然函数在参数 $\\theta$ 的后验分布上进行边缘化（积分）得到的：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\int_{0}^{1} \\mathbb{P}(Y_{\\text{next}}=1 \\mid \\theta, D) p(\\theta \\mid D) \\,d\\theta\n$$\n在可交换性假设下，给定参数 $\\theta$，下一次试验的结果与过去的数据 $D$ 条件独立。因此，$\\mathbb{P}(Y_{\\text{next}}=1 \\mid \\theta, D) = \\mathbb{P}(Y_{\\text{next}}=1 \\mid \\theta) = \\theta$。积分变为：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\int_{0}^{1} \\theta \\cdot p(\\theta \\mid D) \\,d\\theta\n$$\n根据定义，这个积分是 $\\theta$ 在后验分布下的期望值，即 $\\mathbb{E}[\\theta \\mid D]$。一个 Beta 分布 $\\operatorname{Beta}(\\alpha', \\beta')$ 的均值为 $\\frac{\\alpha'}{\\alpha'+\\beta'}$。对于我们的后验分布 $\\operatorname{Beta}(\\theta; \\alpha+x, \\beta+n-x)$，其均值为：\n$$\n\\mathbb{E}[\\theta \\mid D] = \\frac{\\alpha+x}{(\\alpha+x) + (\\beta+n-x)} = \\frac{\\alpha+x}{\\alpha+\\beta+n}\n$$\n所以，得到阳性结果的后验预测概率为：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\frac{\\alpha+x}{\\alpha+\\beta+n}\n$$\n伯努利试验 $Y_{\\text{next}}$ 的后验预测分布是一个参数为 $p = \\mathbb{P}(Y_{\\text{next}}=1 \\mid D)$ 的伯努利分布。\n\n为了展示这个结果如何体现部分池化，可将该表达式重写为医院特定的阳性经验比例 $\\frac{x}{n}$ 和群体水平先验均值流行率 $\\mathbb{E}[\\theta] = \\frac{\\alpha}{\\alpha+\\beta}$ 的一个凸组合。通过代数运算，该表达式等价于：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\left( \\frac{n}{n + \\alpha+\\beta} \\right) \\left( \\frac{x}{n} \\right) + \\left( \\frac{\\alpha+\\beta}{n + \\alpha+\\beta} \\right) \\left( \\frac{\\alpha}{\\alpha+\\beta} \\right)\n$$\n这里，权重 $\\frac{n}{n+\\alpha+\\beta}$ 应用于医院特定的经验比例（$\\frac{x}{n}$），而互补的权重 $\\frac{\\alpha+\\beta}{n+\\alpha+\\beta}$ 应用于群体水平的先验均值（$\\frac{\\alpha}{\\alpha+\\beta}$）。项 $\\alpha+\\beta$ 可以被解释为“先验样本量”或先验信念强度的度量。因此，后验估计被从局部数据“拉向”全局均值，这种效应被称为部分池化或收缩。收缩的程度取决于观测样本量（$n$）和先验有效样本量（$\\alpha+\\beta$）的相对大小。\n\n对于具体计算，给定值为 $\\alpha = 1.5$，$\\beta = 6.5$，$n = 12$ 和 $x = 7$。\n后验预测概率 $\\mathbb{P}(Y_{\\text{next}} = 1 \\mid D)$ 使用上面推导的公式计算：\n$$\n\\mathbb{P}(Y_{\\text{next}}=1 \\mid D) = \\frac{\\alpha+x}{\\alpha+\\beta+n} = \\frac{1.5+7}{1.5+6.5+12} = \\frac{8.5}{8+12} = \\frac{8.5}{20}\n$$\n计算小数值：\n$$\n\\frac{8.5}{20} = 0.425\n$$\n题目要求答案四舍五入到四位有效数字。这得到 $0.4250$。\n让我们也计算一下部分池化的分量来验证：\n先验均值: $\\frac{\\alpha}{\\alpha+\\beta} = \\frac{1.5}{1.5+6.5} = \\frac{1.5}{8} = 0.1875$.\n经验比例: $\\frac{x}{n} = \\frac{7}{12} \\approx 0.5833$.\n权重为：\n数据权重: $\\frac{n}{n+\\alpha+\\beta} = \\frac{12}{12+8} = \\frac{12}{20} = 0.6$.\n先验权重: $\\frac{\\alpha+\\beta}{n+\\alpha+\\beta} = \\frac{8}{12+8} = \\frac{8}{20} = 0.4$.\n后验均值为 $(0.6) \\times (\\frac{7}{12}) + (0.4) \\times (0.1875) = 0.35 + 0.075 = 0.425$。计算结果一致。最终概率为 $0.4250$。",
            "answer": "$$\\boxed{0.4250}$$"
        },
        {
            "introduction": "生物系统并非由孤立的变量构成，而是由相互作用的组件组成的复杂网络。为了理解这些系统，我们需要能够捕捉这些复杂依赖关系的模型，例如基因调控通路中的模型。本练习将介绍贝叶斯网络（Bayesian network），这是一种表示复杂概率关系的图形化模型。你将学习马尔可夫毯（Markov blanket）的概念，它定义了一个节点的“局部邻域”，其中包含了预测该节点所需的所有信息。 通过计算给定其马尔可夫毯的节点的全条件分布，你将执行吉布斯采样（Gibbs sampling）中的基本计算步骤，这是一种在复杂模型中进行推断的广泛使用的算法。",
            "id": "4318431",
            "problem": "在一个系统生物医学的背景下，考虑一个贝叶斯网络片段，该网络模拟一个基因调控模块。一个二元基因激活节点 $G \\in \\{0,1\\}$ 受两个二元父节点调控：一个转录因子活性节点 $T \\in \\{0,1\\}$ 和一个上游刺激节点 $S \\in \\{0,1\\}$。激活的基因 $G$ 有两个子节点：一个二元下游通路读出值 $C \\in \\{0,1\\}$（它也依赖于一个辅助调节剂 $H \\in \\{0,1\\}$），以及一个二元测量节点 $M \\in \\{0,1\\}$（它代表一个直接依赖于 $G$ 的检测试验）。有向边为 $T \\to G$、$S \\to G$、$G \\to C$、$H \\to C$ 和 $G \\to M$。您将专注于在给定其马尔可夫毯的情况下 $G$ 的条件分布。\n\n假设以下条件概率表是经过科学校准和固定的：\n- 对于给定其父节点 $(T,S)$ 的 $G$：\n  - $P(G=1 \\mid T=1,S=1) = \\frac{3}{4}$，\n  - $P(G=1 \\mid T=1,S=0) = \\frac{1}{2}$，\n  - $P(G=1 \\mid T=0,S=1) = \\frac{1}{3}$，\n  - $P(G=1 \\mid T=0,S=0) = \\frac{1}{5}$。\n- 对于给定 $(G,H)$ 的读出值 $C$：\n  - $P(C=1 \\mid G=1,H=1) = \\frac{4}{5}$，\n  - $P(C=1 \\mid G=0,H=1) = \\frac{2}{5}$，\n  - $P(C=1 \\mid G=1,H=0) = \\frac{1}{2}$，\n  - $P(C=1 \\mid G=0,H=0) = \\frac{1}{10}$。\n- 对于给定 $G$ 的试验 $M$：\n  - $P(M=0 \\mid G=1) = \\frac{1}{4}$，\n  - $P(M=0 \\mid G=0) = \\frac{4}{5}$。\n\n假设在用于近似推断的吉布斯采样器的当前状态下，$G$ 的马尔可夫毯中的变量具有以下值：$T=1$、$S=0$、$H=1$、$C=1$ 和 $M=0$。您可以假设，在给定此马尔可夫毯的情况下，任何不在马尔可夫毯中的变量都与 $G$ 条件独立。\n\n任务：\n- 仅使用基本定义（贝叶斯网络的乘积分解、贝叶斯法则和马尔可夫毯的定义），从第一性原理推导出完整的条件分布 $P(G=1 \\mid T=1,S=0,H=1,C=1,M=0)$ 并计算其精确值。请以最简分数形式提供最终答案，不要四舍五入。\n- 用一句话简要说明，为什么在吉布斯采样更新中，$G$ 的马尔可夫毯之外的节点不会进入 $G$ 的完整条件分布。\n\n您最终报告的答案必须是一个精确分数形式的实数值，没有单位。不要四舍五入。",
            "solution": "任务是计算给定贝叶斯网络中基因激活节点 $G$ 的完整条件概率 $P(G=1 \\mid T=1,S=0,H=1,C=1,M=0)$，并论证使用马尔可夫毯的合理性。\n\n首先，我们必须识别节点 $G$ 的马尔可夫毯，记作 $MB(G)$。在贝叶斯网络中，一个节点的马尔可夫毯由其父节点、其子节点以及其子节点的其他父节点（共父节点）组成。\n根据问题陈述，有向边为 $T \\to G$、$S \\to G$、$G \\to C$、$H \\to C$ 和 $G \\to M$。\n- $G$ 的父节点是边指向 $G$ 的节点：$\\{T, S\\}$。\n- $G$ 的子节点是边从 $G$ 指出的节点：$\\{C, M\\}$。\n- $G$ 的共父节点是 $G$ 的子节点的其他父节点。子节点 $C$ 除了 $G$ 之外还有父节点 $H$。子节点 $M$ 没有其他父节点。因此，唯一的共父节点是 $\\{H\\}$。\n\n将这些集合合并， $G$ 的马尔可夫毯是 $MB(G) = \\{T, S, C, H, M\\}$。问题中给出的条件变量集合 $\\{T=1, S=0, H=1, C=1, M=0\\}$ 对应于对 $G$ 的马尔可夫毯中节点的一次赋值。我们将此赋值表示为 $mb_G$。\n\n贝叶斯网络的一个基本属性是，在给定其马尔可夫毯的情况下，一个节点与网络中所有其他节点条件独立。这意味着对于吉布斯采样更新或任何条件概率查询，我们只需要考虑这个局部邻域内的节点。$G$ 的完整条件概率的表达式为：\n$$ P(G \\mid mb_G) = P(G \\mid T, S, H, C, M) $$\n根据条件概率的定义和贝叶斯网络的链式法则，该分布与给定其父节点的 $G$ 的条件概率以及 $G$ 的每个子节点给定其各自父节点的条件概率的乘积成正比。\n$$ P(G \\mid mb_G) \\propto P(G, mb_G) = P(G, T, S, H, C, M) $$\n假设 $T$、$S$ 和 $H$ 是根节点，网络中所有变量的联合概率可以分解为 $P(T,S,H,G,C,M) = P(T)P(S)P(H)P(G \\mid T,S)P(C \\mid G,H)P(M \\mid G)$。当以 $mb_G$ 为条件时，$P(T)$、$P(S)$ 和 $P(H)$ 项对于 $G$ 的所有值都是常数，并将在归一化过程中被抵消。因此，$G$ 的完整条件分布可以简化为仅与完整联合分布中涉及 $G$ 的项成正比：\n$$ P(G \\mid T, S, H, C, M) \\propto P(G \\mid T, S) P(C \\mid G, H) P(M \\mid G) $$\n我们需要计算 $P(G=1 \\mid T=1,S=0,H=1,C=1,M=0)$。我们可以通过计算 $G=1$ 和 $G=0$ 的未归一化值，然后进行归一化，来利用这种比例关系。\n\n设 $\\tilde{P}(G=g)$ 为在给定马尔可夫毯的观测状态 $\\{T=1,S=0,H=1,C=1,M=0\\}$ 的情况下，状态 $g \\in \\{0,1\\}$ 的未归一化概率。\n对于 $G=1$：\n$$ \\tilde{P}(G=1) = P(G=1 \\mid T=1, S=0) \\times P(C=1 \\mid G=1, H=1) \\times P(M=0 \\mid G=1) $$\n使用所提供的条件概率表（CPT）中的值：\n- $P(G=1 \\mid T=1, S=0) = \\frac{1}{2}$\n- $P(C=1 \\mid G=1, H=1) = \\frac{4}{5}$\n- $P(M=0 \\mid G=1) = \\frac{1}{4}$\n因此，$G=1$ 的未归一化项为：\n$$ \\tilde{P}(G=1) = \\frac{1}{2} \\times \\frac{4}{5} \\times \\frac{1}{4} = \\frac{4}{40} = \\frac{1}{10} $$\n对于 $G=0$：\n$$ \\tilde{P}(G=0) = P(G=0 \\mid T=1, S=0) \\times P(C=1 \\mid G=0, H=1) \\times P(M=0 \\mid G=0) $$\n我们需要从给定的CPT中推导出所需的概率。一个变量的概率之和必须为1。\n- $P(G=0 \\mid T=1,S=0) = 1 - P(G=1 \\mid T=1,S=0) = 1 - \\frac{1}{2} = \\frac{1}{2}$\n- $P(C=1 \\mid G=0, H=1) = \\frac{2}{5}$\n- $P(M=0 \\mid G=0) = \\frac{4}{5}$\n因此，$G=0$ 的未归一化项为：\n$$ \\tilde{P}(G=0) = \\frac{1}{2} \\times \\frac{2}{5} \\times \\frac{4}{5} = \\frac{8}{50} = \\frac{4}{25} $$\n为了求得最终概率，我们将这些值进行归一化：\n$$ P(G=1 \\mid mb_G) = \\frac{\\tilde{P}(G=1)}{\\tilde{P}(G=1) + \\tilde{P}(G=0)} = \\frac{\\frac{1}{10}}{\\frac{1}{10} + \\frac{4}{25}} $$\n为了计算分母中的和，我们找到一个公分母，即 $50$：\n$$ \\frac{1}{10} + \\frac{4}{25} = \\frac{5}{50} + \\frac{8}{50} = \\frac{13}{50} $$\n将此结果代回概率表达式中：\n$$ P(G=1 \\mid mb_G) = \\frac{\\frac{1}{10}}{\\frac{13}{50}} = \\frac{1}{10} \\times \\frac{50}{13} = \\frac{50}{130} = \\frac{5}{13} $$\n完整条件概率的精确值为 $\\frac{5}{13}$。\n\n关于任务的第二部分，对于为何马尔可夫毯之外的节点不进入完整条件分布的论证，是贝叶斯网络定义的直接结果。\n由于贝叶斯网络结构中固有的条件独立性（由d-分离准则形式化地捕获），任何节点在给定其马尔可夫毯的情况下，都与图中的所有其他节点条件独立。",
            "answer": "$$\n\\boxed{\\frac{5}{13}}\n$$"
        }
    ]
}