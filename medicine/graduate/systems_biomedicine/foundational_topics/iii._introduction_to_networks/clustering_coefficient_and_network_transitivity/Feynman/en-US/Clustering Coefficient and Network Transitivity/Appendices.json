{
    "hands_on_practices": [
        {
            "introduction": "To understand the significance of clustering in real-world biological networks, it is crucial to first establish a baseline using a simple null model. This exercise involves deriving the expected network transitivity in an Erdős–Rényi random graph, where every connection forms with the same independent probability. By completing this foundational calculation , you will see how the clustering in a completely random network provides a benchmark against which the highly structured nature of biological systems can be quantified and appreciated.",
            "id": "4327825",
            "problem": "A simplified baseline model for a biomolecular interaction network treats the network as an undirected, simple graph generated by the Erdős–Rényi (ER) model, where every possible pair of distinct biomolecular entities (nodes) is connected independently with probability $p$ in a graph on $n$ nodes, denoted $G(n,p)$. In systems biomedicine, network transitivity (also known as the global clustering coefficient) quantifies the propensity of triadic closure: the tendency that if two biomolecules both interact with a third, they also interact with each other. The global transitivity is defined using two motif counts: the total number of triangles and the total number of connected triples (wedges). A triangle is an unordered triple of distinct nodes $\\{i,j,k\\}$ with all three possible edges present. A connected triple (wedge) is an unordered triple of distinct nodes with exactly two edges present that share a common center node, and we count wedges by summing, at each node, the number of unordered neighbor pairs.\n\nLet $N_{\\triangle}$ denote the total number of triangles in $G(n,p)$ and let $N_{\\wedge}$ denote the total number of wedges in $G(n,p)$, obtained by summing over nodes the number of unordered neighbor pairs. The global transitivity is then defined as $T = \\dfrac{3 N_{\\triangle}}{N_{\\wedge}}$, where the factor of $3$ accounts for the three wedges contained in each triangle, one centered at each vertex of the triangle.\n\nStarting only from the ER generative assumptions (edge independence with probability $p$), the combinatorial definitions above, and standard properties of binomially distributed degrees in $G(n,p)$, derive expressions for the expected number of triangles $\\mathbb{E}[N_{\\triangle}]$ and the expected number of wedges $\\mathbb{E}[N_{\\wedge}]$. Then compute the ratio\n$$\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]},$$\nexpressed as a closed-form analytic expression in terms of $n$ and $p$. Provide only this ratio as your final answer. No rounding is required and no units are involved.",
            "solution": "The problem asks for the derivation of the ratio $\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]}$ in an Erdős–Rényi (ER) graph $G(n,p)$, where $N_{\\triangle}$ is the number of triangles and $N_{\\wedge}$ is the number of wedges (connected triples). We proceed by first calculating the expected value of each quantity.\n\nFirst, let us calculate the expected number of triangles, $\\mathbb{E}[N_{\\triangle}]$.\nA triangle is formed by a set of three distinct nodes, say $\\{i, j, k\\}$, if the edges $(i,j)$, $(j,k)$, and $(k,i)$ all exist in the graph. In the $G(n,p)$ model, each possible edge exists independently with probability $p$.\n\nThe total number of ways to choose an unordered set of $3$ distinct nodes from the $n$ nodes in the graph is given by the binomial coefficient $\\binom{n}{3}$.\nLet us define an indicator random variable $I_{ijk}$ for each distinct triple of nodes $\\{i, j, k\\}$. The variable $I_{ijk}$ is defined as:\n$$\nI_{ijk} = \\begin{cases} 1  \\text{if nodes } \\{i, j, k\\} \\text{ form a triangle} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe total number of triangles in the graph, $N_{\\triangle}$, is the sum of these indicator variables over all possible distinct triples:\n$$\nN_{\\triangle} = \\sum_{1 \\le i  j  k \\le n} I_{ijk}\n$$\nBy linearity of expectation, the expected number of triangles is:\n$$\n\\mathbb{E}[N_{\\triangle}] = \\mathbb{E}\\left[\\sum_{1 \\le i  j  k \\le n} I_{ijk}\\right] = \\sum_{1 \\le i  j  k \\le n} \\mathbb{E}[I_{ijk}]\n$$\nThe expected value of an indicator variable is the probability of the event it indicates. The event that $\\{i, j, k\\}$ forms a triangle occurs if and only if the three edges $(i,j)$, $(j,k)$, and $(k,i)$ are all present. Due to the independence of edges in the ER model, the probability of this is $p \\times p \\times p = p^3$.\n$$\n\\mathbb{E}[I_{ijk}] = P(I_{ijk}=1) = p^3\n$$\nThe number of terms in the summation is the total number of distinct triples, which is $\\binom{n}{3}$. Therefore, the expected number of triangles is:\n$$\n\\mathbb{E}[N_{\\triangle}] = \\binom{n}{3} p^3 = \\frac{n(n-1)(n-2)}{3 \\cdot 2 \\cdot 1} p^3 = \\frac{n(n-1)(n-2)}{6} p^3\n$$\n\nNext, we calculate the expected number of wedges, $\\mathbb{E}[N_{\\wedge}]$.\nThe problem provides a specific counting method for $N_{\\wedge}$: \"summing, at each node, the number of unordered neighbor pairs\". Let $k_j$ be the degree of node $j$. The number of unordered pairs of neighbors of node $j$ is $\\binom{k_j}{2}$. Thus, the total number of wedges is given by:\n$$\nN_{\\wedge} = \\sum_{j=1}^{n} \\binom{k_j}{2}\n$$\nThis quantity counts the number of paths of length $2$ in the graph. Using linearity of expectation, we have:\n$$\n\\mathbb{E}[N_{\\wedge}] = \\mathbb{E}\\left[\\sum_{j=1}^{n} \\binom{k_j}{2}\\right] = \\sum_{j=1}^{n} \\mathbb{E}\\left[\\binom{k_j}{2}\\right]\n$$\nDue to the symmetry of the $G(n,p)$ model, the expected value $\\mathbb{E}\\left[\\binom{k_j}{2}\\right]$ is the same for all nodes $j$. We can therefore calculate it for an arbitrary node and multiply by $n$.\n$$\n\\mathbb{E}[N_{\\wedge}] = n \\cdot \\mathbb{E}\\left[\\binom{k_1}{2}\\right]\n$$\nLet us find an alternative way to express this expectation. A wedge, or a path of length $2$, is defined by a central node and two of its neighbors. Let's consider a specific ordered triple of distinct nodes $(i, j, k)$. This forms a wedge with $j$ as the center if edges $(i,j)$ and $(k,j)$ exist. The number of possible ordered triples of distinct nodes is $n(n-1)(n-2)$.\nThe total number of wedges, $N_{\\wedge}$, can be seen as the number of pairs of edges that share a vertex. Let $W_{ijk}$ be an indicator variable that is $1$ if the path $i-j-k$ exists (i.e., edges $(i,j)$ and $(j,k)$ are present).\nThe total number of such paths of length $2$, counted by ordered triples of nodes, would be $\\sum_{(i,j,k)} W_{ijk}$. The expectation is $n(n-1)(n-2)p^2$. However, the quantity $N_{\\wedge}$ corresponds to unordered pairs of neighbors at each center.\nAn unordered pair of neighbors $\\{i,k\\}$ of a central node $j$ corresponds to exactly one wedge centered at $j$. The number of ways to choose a central node $j$ is $n$. The number of ways to choose two other distinct nodes $i$ and $k$ to be the endpoints is $\\binom{n-1}{2}$.\nLet's define an indicator random variable $W_{j, \\{i,k\\}}$ for each potential wedge, where $j$ is the center and $\\{i,k\\}$ are the endpoints.\n$$\nW_{j, \\{i,k\\}} = \\begin{cases} 1  \\text{if edges } (i,j) \\text{ and } (k,j) \\text{ exist} \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe total number of wedges is the sum of these indicators over all possible choices of a center $j$ and a pair of endpoints $\\{i,k\\}$:\n$$\nN_{\\wedge} = \\sum_{j=1}^{n} \\sum_{1 \\le i  k \\le n, i,k \\ne j} W_{j, \\{i,k\\}}\n$$\nBy linearity of expectation:\n$$\n\\mathbb{E}[N_{\\wedge}] = \\sum_{j=1}^{n} \\sum_{1 \\le i  k \\le n, i,k \\ne j} \\mathbb{E}[W_{j, \\{i,k\\}}]\n$$\nFor any such potential wedge, the two edges $(i,j)$ and $(k,j)$ are distinct and thus exist independently with probability $p$. Therefore:\n$$\n\\mathbb{E}[W_{j, \\{i,k\\}}] = P(\\text{edge }(i,j)\\text{ exists AND edge }(k,j)\\text{ exists}) = p \\cdot p = p^2\n$$\nThe total number of potential wedges is the number of ways to choose a center node ($n$ ways) times the number of ways to choose two endpoints from the remaining $n-1$ nodes ($\\binom{n-1}{2}$ ways).\n$$\n\\mathbb{E}[N_{\\wedge}] = n \\cdot \\binom{n-1}{2} \\cdot p^2 = n \\cdot \\frac{(n-1)(n-2)}{2} p^2\n$$\n\nFinally, we compute the required ratio.\nWe have derived:\n$$\n\\mathbb{E}[N_{\\triangle}] = \\frac{n(n-1)(n-2)}{6} p^3\n$$\n$$\n\\mathbb{E}[N_{\\wedge}] = \\frac{n(n-1)(n-2)}{2} p^2\n$$\nThe ratio is therefore:\n$$\n\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]} = \\frac{3 \\left( \\frac{n(n-1)(n-2)}{6} p^3 \\right)}{\\frac{n(n-1)(n-2)}{2} p^2}\n$$\nAssuming $n \\ge 3$, the term $n(n-1)(n-2)$ is non-zero and cancels out from the numerator and the denominator.\n$$\n\\frac{3\\,\\mathbb{E}[N_{\\triangle}]}{\\mathbb{E}[N_{\\wedge}]} = \\frac{\\frac{3}{6} p^3}{\\frac{1}{2} p^2} = \\frac{\\frac{1}{2} p^3}{\\frac{1}{2} p^2}\n$$\nThe factors of $\\frac{1}{2}$ cancel, and the powers of $p$ simplify:\n$$\n\\frac{p^3}{p^2} = p\n$$\nThis result indicates that for an ER random graph, the expected transitivity is simply the edge probability $p$. This reflects the fact that the formation of edges is independent, so the existence of a wedge does not alter the probability of the third, closing edge.",
            "answer": "$$\\boxed{p}$$"
        },
        {
            "introduction": "Systems biomedicine often employs two different metrics to quantify network clustering: the average local clustering coefficient ($\\bar{C}$) and the global transitivity ($C_T$). Although related, these measures can yield different insights, as they weight network regions differently. This practice  challenges you to dissect their distinct properties by calculating the precise change in each metric after adding a single edge to a network, demonstrating how global transitivity is more sensitive to changes around high-degree hubs.",
            "id": "4327826",
            "problem": "In a Protein-Protein Interaction (PPI) network representing a single cell type, consider a simple modification around a single high-degree hub protein. The network has $N$ proteins (nodes) and an undirected simple graph structure. One protein $h$ is a hub with degree $k$, where $k \\geq 2$ and $k \\ll N$ is not assumed. Two specific neighbors of $h$, labeled $u$ and $v$, currently have degree $1$ each (their only interaction is with $h$), and there is no interaction between $u$ and $v$. You introduce a single additional interaction (edge) between $u$ and $v$, thereby closing exactly one triangle $h$-$u$-$v$-$h$. The rest of the network is unchanged by this intervention.\n\nLet $\\bar{C}$ denote the average of node-wise local clustering coefficients (with the standard convention that nodes of degree less than $2$ have local clustering coefficient $0$), and let $C_T$ denote the network transitivity, defined as three times the number of triangles divided by the number of connected triples of vertices, where a connected triple is defined with respect to a designated center node.\n\nAssume that before adding the edge between $u$ and $v$, the network has a total of $T_0$ triangles and a total of $W_0$ connected triples, with $W_0  0$. After the edge is added, all changes arise only from the local neighborhood of $h$, $u$, and $v$ as described above.\n\nUsing only standard definitions, derive exact symbolic expressions for the changes $\\Delta \\bar{C}$ and $\\Delta C_T$ induced by adding the single edge between $u$ and $v$, expressed solely in terms of $N$, $k$, $T_0$, and $W_0$. Provide your final answer as a single row matrix $\\big(\\Delta \\bar{C},\\, \\Delta C_T\\big)$ containing closed-form expressions. Do not approximate or round; an exact analytic expression is required.",
            "solution": "The problem asks for the change in two network metrics, the average local clustering coefficient ($\\bar{C}$) and the network transitivity ($C_T$), resulting from the addition of a single edge to a given network. Let the initial state of the network be denoted by subscript $0$ and the final state after adding the edge $(u, v)$ be denoted by subscript $1$.\n\nThe network is an undirected simple graph with $N$ nodes. Initially, it contains a hub node $h$ with degree $k_{h,0} = k \\ge 2$. Two of its neighbors, $u$ and $v$, have an initial degree of $1$, so their only connections are to $h$. Thus, the edges $(u, h)$ and $(v, h)$ exist in the initial graph, and these are the only edges incident to $u$ and $v$. There is no initial edge between $u$ and $v$. A new edge $(u, v)$ is added, forming the triangle $h-u-v$.\n\n**Part 1: Calculation of the change in average local clustering coefficient, $\\Delta \\bar{C}$**\n\nThe average local clustering coefficient is defined as $\\bar{C} = \\frac{1}{N} \\sum_{i=1}^{N} C_i$, where $C_i$ is the local clustering coefficient of node $i$. The change is $\\Delta \\bar{C} = \\bar{C}_1 - \\bar{C}_0 = \\frac{1}{N} \\sum_{i=1}^{N} (C_{i,1} - C_{i,0}) = \\frac{1}{N} \\sum_{i=1}^{N} \\Delta C_i$.\n\nThe local clustering coefficient for a node $i$ with degree $k_i \\ge 2$ is $C_i = \\frac{2E_i}{k_i(k_i-1)}$, where $E_i$ is the number of edges between the neighbors of node $i$. By convention, if $k_i  2$, $C_i = 0$.\n\nWe must identify which nodes experience a change in their local clustering coefficient. A node's $C_i$ value changes if either its degree $k_i$ changes, or the number of edges between its neighbors $E_i$ changes. The addition of the edge $(u, v)$ only affects the degrees of nodes $u$ and $v$. The number of edges between neighbors can only change for nodes that have both $u$ and $v$ as neighbors. The only such node is $h$. Therefore, we only need to compute $\\Delta C_i$ for $i \\in \\{h, u, v\\}$. For any other node $j \\notin \\{h, u, v\\}$, its degree is unchanged, and the new edge $(u,v)$ does not connect any two of its neighbors (since this would imply $j$ is connected to both $u$ and $v$, which is impossible given $k_{u,0}=1$ and $k_{v,0}=1$), so $\\Delta C_j = 0$.\n\nThe total change is $\\sum_{i=1}^{N} \\Delta C_i = \\Delta C_h + \\Delta C_u + \\Delta C_v$.\n\n1.  **Node $u$**:\n    -   Initial state: $k_{u,0} = 1$. By convention, $C_{u,0} = 0$.\n    -   Final state: The edge $(u, v)$ is added. The degree becomes $k_{u,1} = k_{u,0} + 1 = 2$. The neighbors of $u$ are now $\\{h, v\\}$. There is an edge between $h$ and $v$ because $v$ is a neighbor of $h$. So, the number of edges between the neighbors of $u$ is $E_u = 1$.\n    -   $C_{u,1} = \\frac{2E_u}{k_{u,1}(k_{u,1}-1)} = \\frac{2 \\times 1}{2(2-1)} = 1$.\n    -   $\\Delta C_u = C_{u,1} - C_{u,0} = 1 - 0 = 1$.\n\n2.  **Node $v$**:\n    -   By symmetry with node $u$, the calculation is identical.\n    -   Initial state: $k_{v,0} = 1$, so $C_{v,0} = 0$.\n    -   Final state: $k_{v,1} = 2$. Neighbors are $\\{h, u\\}$. The edge $(h, u)$ exists. $E_v = 1$.\n    -   $C_{v,1} = \\frac{2 E_v}{k_{v,1}(k_{v,1}-1)} = \\frac{2 \\times 1}{2(2-1)} = 1$.\n    -   $\\Delta C_v = C_{v,1} - C_{v,0} = 1 - 0 = 1$.\n\n3.  **Node $h$**:\n    -   Initial state: Degree is $k_{h,0} = k$. Let $T_{h,0}$ be the number of triangles involving $h$, which is equal to the number of edges between its neighbors. $C_{h,0} = \\frac{2T_{h,0}}{k(k-1)}$.\n    -   Final state: The degree of $h$ is unchanged, $k_{h,1} = k$. The set of its neighbors is also unchanged. The new edge $(u, v)$ connects two of its neighbors. This increases the number of triangles involving $h$ by exactly one (the triangle $h-u-v$).\n    -   The new number of triangles is $T_{h,1} = T_{h,0} + 1$.\n    -   $C_{h,1} = \\frac{2T_{h,1}}{k(k-1)} = \\frac{2(T_{h,0} + 1)}{k(k-1)}$.\n    -   $\\Delta C_h = C_{h,1} - C_{h,0} = \\frac{2(T_{h,0} + 1)}{k(k-1)} - \\frac{2T_{h,0}}{k(k-1)} = \\frac{2}{k(k-1)}$.\n\nCombining these changes:\n$\\Delta \\bar{C} = \\frac{1}{N}(\\Delta C_h + \\Delta C_u + \\Delta C_v) = \\frac{1}{N}\\left(\\frac{2}{k(k-1)} + 1 + 1\\right) = \\frac{1}{N}\\left(2 + \\frac{2}{k(k-1)}\\right)$.\nSimplifying the expression:\n$\\Delta \\bar{C} = \\frac{2}{N}\\left(1 + \\frac{1}{k(k-1)}\\right) = \\frac{2}{N}\\left(\\frac{k(k-1) + 1}{k(k-1)}\\right) = \\frac{2(k^2 - k + 1)}{N k(k-1)}$.\n\n**Part 2: Calculation of the change in network transitivity, $\\Delta C_T$**\n\nNetwork transitivity is defined as $C_T = \\frac{3 \\times (\\text{number of triangles})}{(\\text{number of connected triples})} = \\frac{3T}{W}$.\nThe change is $\\Delta C_T = C_{T,1} - C_{T,0} = \\frac{3T_1}{W_1} - \\frac{3T_0}{W_0}$.\nThe problem provides the initial values $T_0$ and $W_0$. We need to find the final values $T_1$ and $W_1$.\n\n1.  **Change in the number of triangles ($\\Delta T$)**:\n    -   A new triangle is formed by adding an edge $(u, v)$ if there is at least one node $x$ that is a common neighbor to both $u$ and $v$ in the initial graph.\n    -   From the problem statement, $u$ and $v$ are neighbors of $h$. The initial degrees of $u$ and $v$ are $k_{u,0}=1$ and $k_{v,0}=1$, with their only connection being to $h$. Thus, $h$ is the only common neighbor of $u$ and $v$.\n    -   Adding the edge $(u, v)$ therefore creates exactly one new triangle, $h-u-v$.\n    -   $\\Delta T = T_1 - T_0 = 1$, so $T_1 = T_0 + 1$.\n\n2.  **Change in the number of connected triples ($\\Delta W$)**:\n    -   A connected triple is a path of length 2, centered at some node $i$. The total number of connected triples in a graph is $W = \\sum_{i \\in V} \\binom{k_i}{2}$.\n    -   The change $\\Delta W$ is given by $\\Delta W = W_1 - W_0 = \\sum_{i \\in V} \\left( \\binom{k_{i,1}}{2} - \\binom{k_{i,0}}{2} \\right)$.\n    -   The degrees of all nodes are unchanged, except for $u$ and $v$.\n    -   For node $u$: $k_{u,0}=1$, $k_{u,1}=2$. Change in triples centered at $u$ is $\\binom{2}{2} - \\binom{1}{2} = 1 - 0 = 1$.\n    -   For node $v$: $k_{v,0}=1$, $k_{v,1}=2$. Change in triples centered at $v$ is $\\binom{2}{2} - \\binom{1}{2} = 1 - 0 = 1$.\n    -   For all other nodes $j \\notin \\{u, v\\}$, $k_{j,1}=k_{j,0}$, so the contribution to the sum is $0$.\n    -   The total change is $\\Delta W = 1 + 1 = 2$.\n    -   So, $W_1 = W_0 + 2$.\n\nNow, we can compute $\\Delta C_T$:\n$\\Delta C_T = \\frac{3T_1}{W_1} - \\frac{3T_0}{W_0} = \\frac{3(T_0 + 1)}{W_0 + 2} - \\frac{3T_0}{W_0}$.\nTo simplify, we find a common denominator:\n$\\Delta C_T = 3 \\left( \\frac{(T_0 + 1)W_0 - T_0(W_0 + 2)}{W_0(W_0 + 2)} \\right)$.\n$\\Delta C_T = 3 \\left( \\frac{T_0 W_0 + W_0 - T_0 W_0 - 2T_0}{W_0(W_0 + 2)} \\right)$.\n$\\Delta C_T = \\frac{3(W_0 - 2T_0)}{W_0(W_0 + 2)}$.\n\nThe derived expressions for $\\Delta \\bar{C}$ and $\\Delta C_T$ are in terms of the allowed variables $N$, $k$, $T_0$, and $W_0$.\n\nThe final answer is a row matrix containing these two expressions.\nThe first element is $\\Delta \\bar{C} = \\frac{2(k^2 - k + 1)}{N k(k-1)}$.\nThe second element is $\\Delta C_T = \\frac{3(W_0 - 2T_0)}{W_0(W_0 + 2)}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2(k^2 - k + 1)}{N k (k-1)}  \\frac{3(W_0 - 2T_0)}{W_0 (W_0 + 2)} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Aggregate network statistics can sometimes conceal more than they reveal. This thought experiment explores the relationship between the global transitivity ($C_T$) and the local, degree-dependent clustering profile ($C(k)$), which is critical for understanding concepts like network hierarchy. By analyzing two hypothetical networks with identical global transitivity but opposing local clustering trends , you will develop a crucial intuition for why summary statistics must be interpreted with caution and how degree-specific analysis can uncover deeper structural organization.",
            "id": "4327856",
            "problem": "Consider undirected, simple networks used to model cellular interaction topologies in Systems Biomedicine. The local clustering coefficient at node $i$, denoted $C_i$, is defined as the fraction of $i$-centered connected triples (also known as wedges) that participate in a triangle at $i$. The global transitivity ($C_T$) is defined as the fraction of all connected triples in the network that are closed by triangles. The degree-dependent clustering $C(k)$ is defined as the average of $C_i$ over all nodes with degree $k$.\n\nConstruct two network ensembles on the same fixed degree sequence that have identical global transitivity $C_T$ but different functional forms of $C(k)$ across degree classes, and explain why an aggregate measure like $C_T$ can mask heterogeneity in $C(k)$.\n\nSpecifically, consider a population of $N = 12$ nodes partitioned into two degree classes: $N_H = 4$ “high-degree” nodes each with degree $k_H = 4$, and $N_L = 8$ “low-degree” nodes each with degree $k_L = 2$. Let $W$ denote the total number of connected triples (wedges) in the network. In a wedge-closing generative scheme, each wedge centered at node $i$ is independently closed into a triangle with node-specific probability $p_i$, and triangles arise only from such closures. In ensemble $\\mathcal{A}$, let $p_i = p_H$ for high-degree nodes and $p_i = p_L$ for low-degree nodes, with $p_H = 1/2$ and $p_L = 0$. In ensemble $\\mathcal{B}$, let $p_i = p_H'$ for high-degree nodes and $p_i = p_L'$ for low-degree nodes, with $p_H' = 1/6$ and $p_L' = 1$.\n\nUsing only the core definitions above and first-principles counting arguments on connected triples and triangles:\n- derive the expected global transitivity $C_T$ for $\\mathcal{A}$ and $\\mathcal{B}$,\n- derive the expected degree-dependent clustering values $C(k_H)$ and $C(k_L)$ for $\\mathcal{A}$ and $\\mathcal{B}$,\n- interpret the results in terms of how global transitivity can mask heterogeneity in $C(k)$.\n\nSelect the statement(s) that are correct.\n\nA. With $p_H = 1/2$, $p_L = 0$ for ensemble $\\mathcal{A}$ and $p_H' = 1/6$, $p_L' = 1$ for ensemble $\\mathcal{B}$, both ensembles have the same global transitivity $C_T = 12/32$, while $C(k)$ increases with $k$ in $\\mathcal{A}$ and decreases with $k$ in $\\mathcal{B}$.\n\nB. Global transitivity $C_T$ equals the simple arithmetic mean of the local clustering coefficients $C_i$ over nodes; therefore, any heterogeneity in $C(k)$ is reflected one-to-one in $C_T$.\n\nC. For the specified degree sequence, if two networks share the same $C_T$, then they must have identical $C(k)$ across degree classes, because identical $C_T$ constrains where triangles occur.\n\nD. The wedge-weighted average of node-wise closure probabilities $p_i$ determines $C_T$; many distinct functions $C(k)$ (e.g., increasing versus decreasing with $k$) can yield the same $C_T$ when the wedge-weighted average is matched.",
            "solution": "We proceed from first principles using the definitions provided.\n\nFirst, we compute the total number of connected triples (wedges). A node of degree $k$ contributes $\\binom{k}{2}$ wedges centered at that node. Therefore, with $N_H = 4$ nodes of degree $k_H = 4$ and $N_L = 8$ nodes of degree $k_L = 2$, the total wedge count is\n$$\nW \\;=\\; N_H \\binom{k_H}{2} \\;+\\; N_L \\binom{k_L}{2}\n\\;=\\; 4 \\cdot \\binom{4}{2} \\;+\\; 8 \\cdot \\binom{2}{2}\n\\;=\\; 4 \\cdot 6 \\;+\\; 8 \\cdot 1\n\\;=\\; 24 \\;+\\; 8\n\\;=\\; 32.\n$$\n\nUnder the wedge-closing generative scheme, a wedge centered at node $i$ is closed with probability $p_i$. Each closed wedge participates in exactly one triangle, but each triangle closes exactly $3$ wedges (one at each of its vertices). Thus, the expected number of closed wedges equals $3$ times the expected number of triangles, and the global transitivity is the fraction of wedges that are closed:\n$$\nC_T \\;=\\; \\frac{\\text{expected number of closed wedges}}{W}\n\\;=\\; \\frac{\\sum_i p_i \\binom{k_i}{2}}{W}.\n$$\nEquivalently, $C_T$ is the wedge-weighted average of $p_i$ across nodes.\n\nThe expected local clustering $C_i$ for node $i$ is the fraction of its own wedges that are closed, which in this generative model is simply $p_i$. Therefore, for a degree class $k$, the expected $C(k)$ equals the average $p_i$ within that class, which here is the class-specific parameter ($p_H$ for high-degree, $p_L$ for low-degree in ensemble $\\mathcal{A}$; $p_H'$ and $p_L'$ respectively in ensemble $\\mathcal{B}$).\n\nWe now evaluate the two ensembles.\n\nEnsemble $\\mathcal{A}$:\n- High-degree nodes: $p_H = 1/2$, each contributes $\\binom{4}{2} = 6$ wedges; total closed wedges from high-degree class is $4 \\cdot 6 \\cdot (1/2) = 12$.\n- Low-degree nodes: $p_L = 0$, each contributes $\\binom{2}{2} = 1$ wedge; total closed wedges from low-degree class is $8 \\cdot 1 \\cdot 0 = 0$.\n- Total expected closed wedges: $12 + 0 = 12$.\nTherefore,\n$$\nC_T^{(\\mathcal{A})} \\;=\\; \\frac{12}{32} \\;=\\; \\frac{3}{8} \\;=\\; 0.375.\n$$\nDegree-dependent clustering in $\\mathcal{A}$:\n$$\nC^{(\\mathcal{A})}(k_H) \\;=\\; p_H \\;=\\; \\frac{1}{2}, \\quad\nC^{(\\mathcal{A})}(k_L) \\;=\\; p_L \\;=\\; 0.\n$$\nThus $C(k)$ increases with $k$.\n\nEnsemble $\\mathcal{B}$:\n- High-degree nodes: $p_H' = 1/6$, each contributes $6$ wedges; closed wedges from high-degree class is $4 \\cdot 6 \\cdot (1/6) = 4$.\n- Low-degree nodes: $p_L' = 1$, each contributes $1$ wedge; closed wedges from low-degree class is $8 \\cdot 1 \\cdot 1 = 8$.\n- Total expected closed wedges: $4 + 8 = 12$.\nTherefore,\n$$\nC_T^{(\\mathcal{B})} \\;=\\; \\frac{12}{32} \\;=\\; \\frac{3}{8} \\;=\\; 0.375.\n$$\nDegree-dependent clustering in $\\mathcal{B}$:\n$$\nC^{(\\mathcal{B})}(k_H) \\;=\\; p_H' \\;=\\; \\frac{1}{6}, \\quad\nC^{(\\mathcal{B})}(k_L) \\;=\\; p_L' \\;=\\; 1.\n$$\nThus $C(k)$ decreases with $k$.\n\nInterpretation:\nGlobal transitivity $C_T$ is a wedge-weighted average of node-wise closure probabilities, so it can be matched across ensembles even when the degree-dependent clustering functions $C(k)$ differ markedly. In ensemble $\\mathcal{A}$, triangles are concentrated around high-degree nodes (yielding higher $C(k)$ at large $k$), whereas in ensemble $\\mathcal{B}$, triangles are concentrated around low-degree nodes (yielding higher $C(k)$ at small $k$). The identical values $C_T^{(\\mathcal{A})} = C_T^{(\\mathcal{B})}$ demonstrate that the aggregate measure can mask heterogeneity in how clustering depends on degree.\n\nOption-by-option analysis:\n\nA. This statement asserts equal $C_T = 12/32$ for both ensembles and describes $C(k)$ increasing with $k$ in $\\mathcal{A}$ and decreasing with $k$ in $\\mathcal{B}$. Our derivations yield $C_T^{(\\mathcal{A})} = C_T^{(\\mathcal{B})} = 12/32$ and $C^{(\\mathcal{A})}(k_H) = 1/2  C^{(\\mathcal{A})}(k_L) = 0$, while $C^{(\\mathcal{B})}(k_H) = 1/6  C^{(\\mathcal{B})}(k_L) = 1$. This is consistent. Verdict: Correct.\n\nB. This claims $C_T$ equals the simple arithmetic mean of $C_i$ across nodes. From the definition and the wedge-counting derivation, $C_T = \\left(\\sum_i p_i \\binom{k_i}{2}\\right)/W$, which is a wedge-weighted average of $p_i$ (and of $C_i$), not the unweighted mean over nodes. Therefore, heterogeneity can be masked when the wedge weights differ by degree. Verdict: Incorrect.\n\nC. This claims identical $C_T$ implies identical $C(k)$ across degree classes. Our construction provides a counterexample: $\\mathcal{A}$ and $\\mathcal{B}$ share $C_T = 0.375$ but have different $C(k)$ functions (increasing versus decreasing). Verdict: Incorrect.\n\nD. This states that the wedge-weighted average of $p_i$ determines $C_T$, permitting many distinct $C(k)$ functions to yield the same $C_T$. This matches the derivation $C_T = \\left(\\sum_i p_i \\binom{k_i}{2}\\right)/W$ and our explicit ensembles. Verdict: Correct.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}