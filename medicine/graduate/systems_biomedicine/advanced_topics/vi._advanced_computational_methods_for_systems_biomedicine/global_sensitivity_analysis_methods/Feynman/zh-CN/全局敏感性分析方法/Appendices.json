{
    "hands_on_practices": [
        {
            "introduction": "这个练习将对比局部、基于梯度的灵敏度与全局、基于方差的灵敏度。通过一个简单的解析模型，你将发现参数的重要性排序会根据评估其在单一点的影响还是在整个不确定性范围内的影响而发生根本性改变 。本练习旨在强调，在分析参数并非固定于标称值的复杂系统时，采用全局方法的必要性。",
            "id": "4348244",
            "problem": "在系统生物医学使用的简化通路级抽象中，考虑一个无量纲读数，其模型为可加输出 $Y=\\sin(X_{1})+X_{2}^{2}$，其中 $X_{1}$ 和 $X_{2}$ 代表独立的上游因子。假设 $X_{1}\\sim\\mathrm{Unif}(0,1)$ 和 $X_{2}\\sim\\mathrm{Unif}(0,1)$ 是独立的，并且三角函数的参数以弧度为单位。这两个输入将根据两种敏感性概念进行排序：\n- 一种局部的、基于梯度的排序，该排序评估在标称工作点 $(x_{1}^{\\ast},x_{2}^{\\ast})=(\\tfrac{1}{2},\\tfrac{1}{2})$ 处偏导数的绝对大小。\n- 一种全局的、基于方差的排序，该排序使用最初为全局敏感性分析中的独立输入提出的一阶基于方差的敏感性指数，将输出方差中可归因于每个输入的部分分配给该输入。\n\n从期望、方差、独立性和偏导数的基本定义出发，推导模型 $Y=\\sin(X_{1})+X_{2}^{2}$ 的两种排序。然后，按照 $\\left(|\\partial Y/\\partial X_{1}|,\\;|\\partial Y/\\partial X_{2}|,\\;S_{1},\\;S_{2}\\right)$ 的顺序，报告一个行向量，该向量由在 $(x_{1}^{\\ast},x_{2}^{\\ast})$ 处的局部梯度绝对值和两个一阶基于方差的敏感性指数组成。将这四个数字中的每一个都四舍五入到四位有效数字，并以无单位的形式表示最终的数值。",
            "solution": "对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **模型：** 无量纲读数为 $Y=\\sin(X_{1})+X_{2}^{2}$。\n-   **输入：** $X_{1}$ 和 $X_{2}$ 是独立的上游因子。\n-   **分布：** $X_{1}\\sim\\mathrm{Unif}(0,1)$ 和 $X_{2}\\sim\\mathrm{Unif}(0,1)$。正弦函数的参数以弧度为单位。\n-   **局部敏感性分析：** 需要进行局部的、基于梯度的排序。这涉及评估在标称工作点 $(x_{1}^{\\ast},x_{2}^{\\ast})=(\\tfrac{1}{2},\\tfrac{1}{2})$ 处偏导数的绝对大小 $|\\partial Y/\\partial X_{i}|$。\n-   **全局敏感性分析：** 需要进行全局的、基于方差的排序。这涉及计算每个输入的一阶基于方差的敏感性指数 $S_i$。\n-   **输出要求：** 按照 $\\left(|\\partial Y/\\partial X_{1}|,\\;|\\partial Y/\\partial X_{2}|,\\;S_{1},\\;S_{2}\\right)$ 的顺序，报告由四个值组成的行向量，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它在敏感性分析领域提出了一个明确定义的问题，这是系统建模（包括系统生物医学）中的一个标准工具。模型 $Y=\\sin(X_{1})+X_{2}^{2}$ 是一个常见的基准函数。输入由标准概率分布描述。敏感性分析的方法——局部偏导数和全局一阶Sobol'指数——在文献中有严格的定义。该问题是自洽的、客观的，并且没有矛盾或歧义。它需要直接应用微积分和概率论。\n\n### 第3步：结论与行动\n该问题被认为是有效的。将提供一个完整的、附有推理的解答。\n\n***\n\n解答分为两部分，分别对应局部和全局敏感性分析。\n\n### 第1部分：局部的、基于梯度的敏感性分析\n\n输出 $Y$ 对输入 $X_i$ 在特定工作点处的局部敏感性，由模型函数关于该输入的偏导数在该点处的值的绝对大小来量化。\n\n模型由下式给出：\n$$ Y(X_1, X_2) = \\sin(X_1) + X_2^2 $$\n\n$Y$ 关于 $X_1$ 和 $X_2$ 的偏导数是：\n$$ \\frac{\\partial Y}{\\partial X_1} = \\frac{\\partial}{\\partial X_1} \\left( \\sin(X_1) + X_2^2 \\right) = \\cos(X_1) $$\n$$ \\frac{\\partial Y}{\\partial X_2} = \\frac{\\partial}{\\partial X_2} \\left( \\sin(X_1) + X_2^2 \\right) = 2X_2 $$\n\n在标称工作点 $(x_{1}^{\\ast},x_{2}^{\\ast})=(\\frac{1}{2},\\frac{1}{2})$ 处评估这些导数。\n对于 $X_1$：\n$$ \\left. \\frac{\\partial Y}{\\partial X_1} \\right|_{(1/2, 1/2)} = \\cos\\left(\\frac{1}{2}\\right) $$\n绝对值为 $|\\cos(\\frac{1}{2})|$。由于 $\\frac{1}{2}$ 弧度位于第一象限，$\\cos(\\frac{1}{2})$ 为正。\n$$ \\left| \\frac{\\partial Y}{\\partial X_1} \\right| = \\cos\\left(\\frac{1}{2}\\right) \\approx 0.87758256... $$\n\n对于 $X_2$：\n$$ \\left. \\frac{\\partial Y}{\\partial X_2} \\right|_{(1/2, 1/2)} = 2 \\times \\frac{1}{2} = 1 $$\n绝对值为：\n$$ \\left| \\frac{\\partial Y}{\\partial X_2} \\right| = |1| = 1 $$\n\n四舍五入到四位有效数字，局部敏感性度量对于 $X_1$ 是 $0.8776$，对于 $X_2$ 是 $1.000$。局部排序是 $X_2 > X_1$。\n\n### 第2部分：全局的、基于方差的敏感性分析\n\n全局敏感性分析评估输入在其整个变化范围内的影响。一阶敏感性指数 $S_i$ 衡量总输出方差 $\\mathrm{Var}(Y)$ 中可归因于输入 $X_i$ 主效应的部分。其定义为：\n$$ S_i = \\frac{V_i}{\\mathrm{Var}(Y)} = \\frac{\\mathrm{Var}(\\mathbb{E}[Y|X_i])}{\\mathrm{Var}(Y)} $$\n其中 $V_i = \\mathrm{Var}(\\mathbb{E}[Y|X_i])$ 是 $X_i$ 的一阶效应方差。总方差为 $\\mathrm{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$。\n\n模型 $Y=\\sin(X_{1})+X_{2}^{2}$ 是一个形式为 $Y=f_1(X_1) + f_2(X_2)$ 的可加模型，其中 $f_1(X_1) = \\sin(X_1)$ 且 $f_2(X_2) = X_2^2$。由于输入 $X_1$ 和 $X_2$ 是独立的，随机变量 $f_1(X_1)$ 和 $f_2(X_2)$ 也是独立的。对于这样的模型，总方差分解为各项方差之和：\n$$ \\mathrm{Var}(Y) = \\mathrm{Var}(f_1(X_1) + f_2(X_2)) = \\mathrm{Var}(f_1(X_1)) + \\mathrm{Var}(f_2(X_2)) $$\n一阶效应方差也得到简化：\n$V_1 = \\mathrm{Var}(\\mathbb{E}[Y|X_1]) = \\mathrm{Var}(\\mathbb{E}[f_1(X_1) + f_2(X_2)|X_1]) = \\mathrm{Var}(f_1(X_1) + \\mathbb{E}[f_2(X_2)])$。因为 $\\mathbb{E}[f_2(X_2)]$ 是一个常数，所以这简化为 $V_1 = \\mathrm{Var}(f_1(X_1))$。\n类似地，$V_2 = \\mathrm{Var}(\\mathbb{E}[Y|X_2]) = \\mathrm{Var}(f_2(X_2))$。\n\n因此，敏感性指数为：\n$$ S_1 = \\frac{\\mathrm{Var}(f_1(X_1))}{\\mathrm{Var}(f_1(X_1)) + \\mathrm{Var}(f_2(X_2))} $$\n$$ S_2 = \\frac{\\mathrm{Var}(f_2(X_2))}{\\mathrm{Var}(f_1(X_1)) + \\mathrm{Var}(f_2(X_2))} $$\n我们现在必须计算 $\\mathrm{Var}(f_1(X_1)) = \\mathrm{Var}(\\sin(X_1))$ 和 $\\mathrm{Var}(f_2(X_2)) = \\mathrm{Var}(X_2^2)$。\n\n**计算 $\\mathrm{Var}(X_2^2)$：**\n$X_2$ 在 $[0, 1]$ 上均匀分布，即 $X_2 \\sim \\mathrm{Unif}(0,1)$。其概率密度函数为 $p(x_2)=1$，其中 $x_2 \\in [0, 1]$。\n我们需要 $\\mathbb{E}[X_2^2]$ 和 $\\mathbb{E}[(X_2^2)^2] = \\mathbb{E}[X_2^4]$。\n$$ \\mathbb{E}[X_2^2] = \\int_0^1 x_2^2 p(x_2) \\,dx_2 = \\int_0^1 x_2^2 \\,dx_2 = \\left[ \\frac{x_2^3}{3} \\right]_0^1 = \\frac{1}{3} $$\n$$ \\mathbb{E}[X_2^4] = \\int_0^1 x_2^4 p(x_2) \\,dx_2 = \\int_0^1 x_2^4 \\,dx_2 = \\left[ \\frac{x_2^5}{5} \\right]_0^1 = \\frac{1}{5} $$\n方差为：\n$$ \\mathrm{Var}(X_2^2) = \\mathbb{E}[X_2^4] - (\\mathbb{E}[X_2^2])^2 = \\frac{1}{5} - \\left(\\frac{1}{3}\\right)^2 = \\frac{1}{5} - \\frac{1}{9} = \\frac{9-5}{45} = \\frac{4}{45} $$\n\n**计算 $\\mathrm{Var}(\\sin(X_1))$：**\n$X_1$ 也在 $[0, 1]$ 上均匀分布，即 $X_1 \\sim \\mathrm{Unif}(0,1)$。\n我们需要 $\\mathbb{E}[\\sin(X_1)]$ 和 $\\mathbb{E}[\\sin^2(X_1)]$。\n$$ \\mathbb{E}[\\sin(X_1)] = \\int_0^1 \\sin(x_1) \\,dx_1 = [-\\cos(x_1)]_0^1 = -\\cos(1) - (-\\cos(0)) = 1 - \\cos(1) $$\n为了求 $\\mathbb{E}[\\sin^2(X_1)]$，我们使用恒等式 $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$。\n$$ \\mathbb{E}[\\sin^2(X_1)] = \\int_0^1 \\sin^2(x_1) \\,dx_1 = \\int_0^1 \\frac{1-\\cos(2x_1)}{2} \\,dx_1 = \\frac{1}{2} \\left[ x_1 - \\frac{\\sin(2x_1)}{2} \\right]_0^1 $$\n$$ \\mathbb{E}[\\sin^2(X_1)] = \\frac{1}{2} \\left( \\left(1 - \\frac{\\sin(2)}{2}\\right) - (0-0) \\right) = \\frac{1}{2} - \\frac{\\sin(2)}{4} $$\n方差为：\n$$ \\mathrm{Var}(\\sin(X_1)) = \\mathbb{E}[\\sin^2(X_1)] - (\\mathbb{E}[\\sin(X_1)])^2 = \\left(\\frac{1}{2} - \\frac{\\sin(2)}{4}\\right) - (1 - \\cos(1))^2 $$\n\n**数值计算与最终指数：**\n让我们计算数值。\n$V_2 = \\mathrm{Var}(X_2^2) = \\frac{4}{45} \\approx 0.088888...$\n对于 $V_1 = \\mathrm{Var}(\\sin(X_1))$：\n$\\cos(1) \\approx 0.540302$\n$\\sin(2) \\approx 0.909297$\n$\\mathrm{Var}(\\sin(X_1)) \\approx \\left(\\frac{1}{2} - \\frac{0.909297}{4}\\right) - (1 - 0.540302)^2$\n$\\mathrm{Var}(\\sin(X_1)) \\approx (0.5 - 0.227324) - (0.459698)^2$\n$\\mathrm{Var}(\\sin(X_1)) \\approx 0.272676 - 0.211322 \\approx 0.061354$\n所以，$V_1 \\approx 0.061354$。\n\n总方差为 $\\mathrm{Var}(Y) = V_1 + V_2 \\approx 0.061354 + 0.088889 = 0.150243$。\n\n敏感性指数为：\n$$ S_1 = \\frac{V_1}{\\mathrm{Var}(Y)} \\approx \\frac{0.061354}{0.150243} \\approx 0.408366... $$\n$$ S_2 = \\frac{V_2}{\\mathrm{Var}(Y)} \\approx \\frac{0.088889}{0.150243} \\approx 0.591634... $$\n\n四舍五入到四位有效数字，全局敏感性指数为 $S_1 = 0.4084$ 和 $S_2 = 0.5916$。全局排序是 $X_2 > X_1$。\n\n### 结果总结\n所要求的量为：\n1.  在 $(\\frac{1}{2}, \\frac{1}{2})$ 处的 $|\\partial Y/\\partial X_{1}| = \\cos(\\frac{1}{2}) \\approx 0.8776$\n2.  在 $(\\frac{1}{2}, \\frac{1}{2})$ 处的 $|\\partial Y/\\partial X_{2}| = 1 = 1.000$\n3.  $S_1 \\approx 0.4084$\n4.  $S_2 \\approx 0.5916$\n\n最终的行向量由这四个值组成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8776 & 1.000 & 0.4084 & 0.5916\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习超越了简单的加性效应，使用一个经典的乘法模型来探讨参数间相互作用的关键概念。你将计算一阶（$S_i$）和总效应（$T_i$）Sobol指数，以量化参数的影响在多大程度上来自其直接效应，以及在多大程度上来自其与其他参数的协同效应 。这个练习对于理解基于方差的GSA如何将输出不确定性分解为来自单个输入及其相互作用的贡献至关重要。",
            "id": "4348293",
            "problem": "在一个简化的系统生物医学模型中，某表型由两个独立的通路活性调控，假设其输出被建模为乘性响应 $Y = X_{1} X_{2}$，其中 $X_{1}$ 和 $X_{2}$ 独立同分布于 $\\mathrm{Unif}(0,1)$。使用基于方差的全局敏感性分析对独立输入的“第一性原理”定义，计算该模型的一阶 Sobol 指数 $S_{1}$ 和 $S_{2}$ 以及全效应 Sobol 指数 $T_{1}$ 和 $T_{2}$。然后，基于您的方差分解，说明由 $X_{1}$ 和 $X_{2}$ 之间的交互作用引起的方差是否超过任一主效应引起的方差。以精确值（不四舍五入）报告 $S_{1}$、$S_{2}$、$T_{1}$、$T_{2}$，并按 $S_{1}$、$S_{2}$、$T_{1}$、$T_{2}$ 的顺序将最终答案表示为行向量。无需单位。",
            "solution": "我们从基于方差的全局敏感性分析对独立输入的基本定义开始，这些定义源于 Hoeffding–Sobol 方差分析 (ANOVA) 分解。对于具有独立输入的平方可积模型输出 $Y=f(X_{1},X_{2})$，其方差可正交分解为\n$$\n\\operatorname{Var}(Y) = V_{1} + V_{2} + V_{12},\n$$\n其中 $V_{i} = \\operatorname{Var}(\\mathbb{E}[Y \\mid X_{i}])$ 是一阶方差分量，$V_{12}$ 是二阶（交互作用）方差分量。一阶 Sobol 指数定义为\n$$\nS_{i} = \\frac{V_{i}}{\\operatorname{Var}(Y)},\n$$\n全效应指数定义为\n$$\nT_{i} = \\frac{\\mathbb{E}\\!\\left[\\operatorname{Var}(Y \\mid X_{-i})\\right]}{\\operatorname{Var}(Y)} = 1 - \\frac{\\operatorname{Var}(\\mathbb{E}[Y \\mid X_{-i}])}{\\operatorname{Var}(Y)},\n$$\n其中 $X_{-i}$ 表示除 $X_{i}$ 之外的所有输入。对于两个输入的情况，$T_{1} = S_{1} + S_{12}$ 且 $T_{2} = S_{2} + S_{12}$，其中 $S_{12} = V_{12}/\\operatorname{Var}(Y)$。\n\n对于给定的模型 $Y = X_{1} X_{2}$，其中 $X_{1}, X_{2} \\stackrel{\\text{i.i.d.}}{\\sim} \\mathrm{Unif}(0,1)$ 且相互独立，我们计算必要的期望和方差。\n\n首先，计算 $\\mathbb{E}[Y]$ 和 $\\operatorname{Var}(Y)$：\n- 由于 $X_{1}$ 和 $X_{2}$ 独立同分布且 $\\mathbb{E}[X_{i}] = \\frac{1}{2}$，我们有\n$$\n\\mathbb{E}[Y] = \\mathbb{E}[X_{1} X_{2}] = \\mathbb{E}[X_{1}] \\, \\mathbb{E}[X_{2}] = \\frac{1}{4}.\n$$\n- 此外，$\\mathbb{E}[X_{i}^{2}] = \\frac{1}{3}$，因此\n$$\n\\mathbb{E}[Y^{2}] = \\mathbb{E}[X_{1}^{2} X_{2}^{2}] = \\mathbb{E}[X_{1}^{2}] \\, \\mathbb{E}[X_{2}^{2}] = \\frac{1}{9}.\n$$\n因此，\n$$\n\\operatorname{Var}(Y) = \\mathbb{E}[Y^{2}] - \\left(\\mathbb{E}[Y]\\right)^{2} = \\frac{1}{9} - \\left(\\frac{1}{4}\\right)^{2} = \\frac{1}{9} - \\frac{1}{16} = \\frac{16 - 9}{144} = \\frac{7}{144}.\n$$\n\n接下来，计算一阶方差分量 $V_{1}$ 和 $V_{2}$：\n- 计算条件期望\n$$\n\\mathbb{E}[Y \\mid X_{1}] = \\mathbb{E}[X_{1} X_{2} \\mid X_{1}] = X_{1} \\, \\mathbb{E}[X_{2}] = \\frac{X_{1}}{2}.\n$$\n因此\n$$\nV_{1} = \\operatorname{Var}(\\mathbb{E}[Y \\mid X_{1}]) = \\operatorname{Var}\\!\\left(\\frac{X_{1}}{2}\\right) = \\frac{1}{4} \\operatorname{Var}(X_{1}) = \\frac{1}{4} \\cdot \\frac{1}{12} = \\frac{1}{48}.\n$$\n根据对称性，$V_{2} = \\frac{1}{48}$。\n\n因此，一阶 Sobol 指数为\n$$\nS_{1} = \\frac{V_{1}}{\\operatorname{Var}(Y)} = \\frac{\\frac{1}{48}}{\\frac{7}{144}} = \\frac{1}{48} \\cdot \\frac{144}{7} = \\frac{3}{7},\n\\qquad\nS_{2} = \\frac{V_{2}}{\\operatorname{Var}(Y)} = \\frac{3}{7}.\n$$\n\n现在计算全效应指数。我们使用两种等价的途径来验证一致性。\n\n途径 1（利用补集主效应）：\n- 由于 $\\mathbb{E}[Y \\mid X_{2}] = \\frac{X_{2}}{2}$，我们有\n$$\n\\operatorname{Var}(\\mathbb{E}[Y \\mid X_{2}]) = \\operatorname{Var}\\!\\left(\\frac{X_{2}}{2}\\right) = \\frac{1}{48}.\n$$\n因此\n$$\nT_{1} = 1 - \\frac{\\operatorname{Var}(\\mathbb{E}[Y \\mid X_{2}])}{\\operatorname{Var}(Y)} = 1 - \\frac{\\frac{1}{48}}{\\frac{7}{144}} = 1 - \\frac{3}{7} = \\frac{4}{7}.\n$$\n根据对称性，\n$$\nT_{2} = \\frac{4}{7}.\n$$\n\n途径 2（通过条件方差的期望计算）：\n- 计算\n$$\n\\operatorname{Var}(Y \\mid X_{1}) = \\operatorname{Var}(X_{1} X_{2} \\mid X_{1}) = X_{1}^{2} \\operatorname{Var}(X_{2}) = X_{1}^{2} \\cdot \\frac{1}{12}.\n$$\n因此\n$$\n\\mathbb{E}[\\operatorname{Var}(Y \\mid X_{1})] = \\frac{1}{12} \\mathbb{E}[X_{1}^{2}] = \\frac{1}{12} \\cdot \\frac{1}{3} = \\frac{1}{36}.\n$$\n因此\n$$\nT_{1} = \\frac{\\mathbb{E}[\\operatorname{Var}(Y \\mid X_{1})]}{\\operatorname{Var}(Y)} = \\frac{\\frac{1}{36}}{\\frac{7}{144}} = \\frac{1}{36} \\cdot \\frac{144}{7} = \\frac{4}{7},\n$$\n同样地，$T_{2} = \\frac{4}{7}$，与前一途径的结果一致。\n\n交互作用评估。交互作用方差分数是\n$$\nS_{12} = 1 - S_{1} - S_{2} = 1 - \\frac{3}{7} - \\frac{3}{7} = \\frac{1}{7}.\n$$\n因此，在该模型中，交互作用的贡献 $\\frac{1}{7}$ 未超过任一主效应的贡献 $\\frac{3}{7}$。每个主效应都主导着交互作用，尽管交互作用是不可忽略的，这体现在每个输入的 $T_{i}$ 和 $S_{i}$ 之间存在大小为 $\\frac{1}{7}$ 的差距。\n\n按 $S_{1}$、$S_{2}$、$T_{1}$、$T_{2}$ 的顺序收集所要求的指数，得到精确值\n$$\n\\left(\\frac{3}{7}, \\frac{3}{7}, \\frac{4}{7}, \\frac{4}{7}\\right).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3}{7} & \\frac{3}{7} & \\frac{4}{7} & \\frac{4}{7}\\end{pmatrix}}$$"
        },
        {
            "introduction": "最后的这个实践练习将理论与应用相结合，将GSA应用于一个简化的代谢通路模型——这是系统生物医学中的一个常见情景。由于该模型无法进行解析分析，你将实现一个基于蒙特卡洛的计算流程来估计灵敏度指数，并利用这些指数来识别一个稳健的治疗靶点 。本练习展示了GSA作为一种在不确定性下，为现实生物系统进行模型引导决策的实用工具所具有的强大能力。",
            "id": "4348228",
            "problem": "给定一个简化的、稳态的、基于通量的线性代谢途径模型，该途径包含三个不可逆的酶促步骤。该途径通过三个酶（表示为步骤 $1$、步骤 $2$ 和步骤 $3$）将外部底物转化为最终产物。对于每个步骤 $i \\in \\{1,2,3\\}$，有效通量由一个饱和门近似，该饱和门将输入通量映射到输出通量，这代表了下游通量有界且随着上游可用性的增加而饱和的思想。该映射被设计为对酶最大速率严格递增，对酶饱和参数严格递减，这与标准的 Michaelis–Menten 单调性一致，同时在全球敏感性分析中保持计算上的易处理性。\n\n基本原理和定义。设 $Y = f(\\mathbf{X})$ 是一个标量模型输出，它是独立输入参数 $\\mathbf{X} = (X_1,\\dots,X_d)$ 的函数，并具有有限方差 $\\mathrm{Var}(Y)$。通过基于方差的 Sobol 指数进行的全局敏感性分析由方差分解定义。参数 $X_i$ 的一阶 Sobol 指数为 $S_i = \\mathrm{Var}(\\mathbb{E}[Y \\mid X_i]) / \\mathrm{Var}(Y)$。参数 $X_i$ 的全阶 Sobol 指数为 $S_{T_i} = 1 - \\mathrm{Var}(\\mathbb{E}[Y \\mid \\mathbf{X}_{-i}]) / \\mathrm{Var}(Y)$，其中 $\\mathbf{X}_{-i}$ 表示除 $X_i$ 之外的所有参数。这些指数分别量化了 $X_i$ 的孤立主效应以及包括高阶交互作用在内的 $X_i$ 的总体效应。使用 Saltelli–Jansen 方案的蒙特卡罗估计量在独立采样下为这些量提供了相合的近似。\n\n模型和参数。外部底物可用性是一个固定的非负标量 $S_{\\mathrm{in}}$。酶促步骤由最大速率 $V_1$, $V_2$, $V_3$ 和饱和参数 $K_1$, $K_2$, $K_3$ 参数化。途径通量 $J$ 递归定义为\n$$\nv_1 \\;=\\; \\frac{V_1\\, S_{\\mathrm{in}}}{K_1 + S_{\\mathrm{in}}},\\quad\nv_2 \\;=\\; \\frac{V_2\\, v_1}{K_2 + v_1},\\quad\nv_3 \\;=\\; \\frac{V_3\\, v_2}{K_3 + v_2},\\quad\nJ \\;=\\; v_3.\n$$\n所有量纲均为无量纲。不确定参数是独立的，并在指定区间上服从均匀分布。您将使用带有 Saltelli–Jansen 估计量的蒙特卡罗采样方法，为每个参数 $V_1$, $K_1$, $V_2$, $K_2$, $V_3$, $K_3$ 估计一阶和全阶 Sobol 指数。对于给定的样本量 $N$，构造两个独立的样本矩阵 $\\mathbf{A}, \\mathbf{B} \\in [0,1]^{N \\times d}$，通过仿射映射将每列转换到其物理范围，并计算估计量\n$$\n\\widehat{\\mathrm{Var}}(Y) \\;=\\; \\mathrm{Var}\\big(\\{f(\\mathbf{A}), f(\\mathbf{B})\\}\\big),\\quad\n\\widehat{S}_i \\;=\\; \\frac{\\frac{1}{N}\\sum_{n=1}^{N} f(\\mathbf{B}^{(n)})\\,\\big(f(\\mathbf{A}_{B_i}^{(n)}) - f(\\mathbf{A}^{(n)})\\big)}{\\widehat{\\mathrm{Var}}(Y)},\n$$\n$$\n\\widehat{S}_{T_i} \\;=\\; \\frac{\\frac{1}{N}\\sum_{n=1}^{N} \\big(f(\\mathbf{A}^{(n)}) - f(\\mathbf{A}_{B_i}^{(n)})\\big)^2}{2\\,\\widehat{\\mathrm{Var}}(Y)},\n$$\n其中 $\\mathbf{A}_{B_i}$ 是将矩阵 $\\mathbf{A}$ 的第 $i$ 列替换为矩阵 $\\mathbf{B}$ 的第 $i$ 列得到的矩阵，而 $f(\\cdot)$ 表示在参数矢量处评估的通量 $J$。\n\n治疗靶点解释。假设一种治疗性抑制降低了某个步骤 $i$ 的 $V_i$，而其他参数在其先验范围内仍然不确定。因为 $J$ 在每个 $V_i$ 上都是严格递增的，所以 $V_i$ 的全阶指数 $\\widehat{S}_{T_i}$ 越大，表明 $V_i$ 对通量变异性的总体影响（包括相互作用）越强。一个稳健的治疗靶点是步骤索引 $i \\in \\{1,2,3\\}$，其对应的 $V_i$ 具有最大的全阶指数，因为降低该 $V_i$ 将在各种不确定性下最强烈、最稳健地降低 $J$。\n\n测试套件。使用以下三个测试用例来探究不同的机制：\n- 用例 $1$（平衡机制）：$S_{\\mathrm{in}} = 1.0$, $V_1, V_2, V_3 \\sim \\mathcal{U}[0.5,2.0]$, $K_1, K_2, K_3 \\sim \\mathcal{U}[0.1,1.0]$，样本量 $N=8000$。\n- 用例 $2$（下游限制机制）：$S_{\\mathrm{in}} = 1.0$, $V_1, V_2 \\sim \\mathcal{U}[1.0,2.0]$, $V_3 \\sim \\mathcal{U}[0.1,0.5]$, $K_1, K_2, K_3 \\sim \\mathcal{U}[0.2,1.2]$，样本量 $N=8000$。\n- 用例 $3$（上游限制且第一步弱饱和机制）：$S_{\\mathrm{in}} = 0.5$, $V_1 \\sim \\mathcal{U}[0.4,1.2]$, $V_2, V_3 \\sim \\mathcal{U}[1.0,2.0]$, $K_1 \\sim \\mathcal{U}[1.0,5.0]$, $K_2, K_3 \\sim \\mathcal{U}[0.1,0.5]$，样本量 $N=8000$。\n\n最终输出规范。对于每个测试用例，计算 $V_1, V_2, V_3$ 的全阶指数 $\\widehat{S}_{T_i}$，并选择稳健的治疗靶点，即对应于这三个全阶指数中最大值的整数步骤索引 $i \\in \\{1,2,3\\}$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[i_1,i_2,i_3]$）的结果，其中 $i_1, i_2, i_3$ 分别是用例 1、2 和 3 选定的靶点。不涉及物理单位；所有量纲均为无量纲。不使用角度。不使用百分比。所有数值结果均为指定的整数。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确且客观。它基于系统生物学和全局敏感性分析的既定原则，提出了一个明确的计算任务。所有必要的数据和定义都已提供。\n\n目标是使用全局敏感性分析 (GSA) 在一个简化的三步代谢途径模型中确定最稳健的治疗靶点。治疗靶点被定义为酶促步骤 $i \\in \\{1, 2, 3\\}$，其最大速率 $V_i$ 具有最大的全阶 Sobol 指数 $S_{T_i}$。该指数定量了 $V_i$ 对输出方差的总贡献，包括其直接效应以及与所有其他不确定参数相互作用产生的效应。将使用蒙特卡罗估计方法对三种不同的参数机制进行分析。\n\n该模型描述了通过线性途径的稳态通量 $J$。该通量是一系列三个不可逆酶促步骤的输出，其中一个步骤的输出是下一个步骤的输入。该系统由以下方程定义：\n$$v_1 = \\frac{V_1 S_{\\mathrm{in}}}{K_1 + S_{\\mathrm{in}}}$$\n$$v_2 = \\frac{V_2 v_1}{K_2 + v_1}$$\n$$v_3 = \\frac{V_3 v_2}{K_3 + v_2}$$\n最终通量，即模型输出 $Y$，由 $J = v_3$ 给出。该模型有 $d=6$ 个不确定输入参数，$\\mathbf{X} = (V_1, K_1, V_2, K_2, V_3, K_3)$，这些参数被假定为独立的，并在指定范围内均匀分布。与问题陈述一致，我们将在实现中将这些参数分配给索引 0 到 5。用于靶点选择的目标参数是 $V_1, V_2, V_3$，对应于索引 $i=0, 2, 4$。\n\n为了估计 Sobol 指数，我们将实现 Saltelli-Jansen 方案，这是一种广泛使用的基于方差的蒙特卡罗方法。对于给定的样本量 $N$，其过程如下：\n\n1.  **样本生成**：生成两个大小为 $N \\times d$ 的独立样本矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$。这些矩阵的每个元素都从标准均匀分布 $\\mathcal{U}[0,1]$ 中抽取。\n\n2.  **参数缩放**：必须将单位超立方体中的样本转换到其物理参数范围。对于每个参数 $X_i \\sim \\mathcal{U}[a_i, b_i]$，一个样本 $x_{u} \\in [0,1]$ 被缩放为 $x_{p} = a_i + (b_i - a_i)x_{u}$。此仿射变换应用于 $\\mathbf{A}$ 和 $\\mathbf{B}$ 的每一列，以创建物理参数矩阵 $\\mathbf{A}_{\\text{scaled}}$ 和 $\\mathbf{B}_{\\text{scaled}}$。\n\n3.  **模型评估**：对 $\\mathbf{A}_{\\text{scaled}}$ 和 $\\mathbf{B}_{\\text{scaled}}$ 中的每一行（参数集）评估代谢模型 $f(\\mathbf{X}) = J$，从而产生两个长度为 $N$ 的输出值向量 $f(\\mathbf{A})$ 和 $f(\\mathbf{B})$。\n\n4.  **总方差估计**：模型输出的总方差 $\\mathrm{Var}(Y)$ 是根据 $2N$ 个模型评估的组合集来估计的。样本方差计算如下：\n    $$\\widehat{\\mathrm{Var}}(Y) = \\mathrm{Var}\\big(\\{f(\\mathbf{A}), f(\\mathbf{B})\\}\\big)$$\n    这通过连接 $f(\\mathbf{A})$ 和 $f(\\mathbf{B})$ 向量并计算标准样本方差（分母为 $2N-1$）来实现。\n\n5.  **全阶指数估计**：为了估计参数 $X_i$ 的全阶指数 $\\widehat{S}_{T_i}$，需要创建一个额外的矩阵 $\\mathbf{A}_{B_i}$。该矩阵是 $\\mathbf{A}$ 的一个副本，其中第 $i$ 列被替换为 $\\mathbf{B}$ 的第 $i$ 列。然后对这个新矩阵的缩放版本中的每个参数集评估模型，得到输出向量 $f(\\mathbf{A}_{B_i})$。然后使用提供的 Jansen 估计量来估计全阶指数：\n    $$\\widehat{S}_{T_i} = \\frac{\\frac{1}{N}\\sum_{n=1}^{N} \\big(f(\\mathbf{A}^{(n)}) - f(\\mathbf{A}_{B_i}^{(n)})\\big)^2}{2\\,\\widehat{\\mathrm{Var}}(Y)}$$\n    对每个目标参数执行此计算：$V_1$（索引 $i=0$）、$V_2$（索引 $i=2$）和 $V_3$（索引 $i=4$）。\n\n6.  **靶点识别**：对于三个测试用例中的每一个，我们计算 $V_1, V_2, V_3$ 的 $\\widehat{S}_{T}$。稳健的治疗靶点是步骤索引（$1, 2$ 或 $3$），其对应于具有最高 $\\widehat{S}_{T_i}$ 值的参数 $V_i$。\n\n实现将使用 Python 和 `numpy` 库进行，以实现高效的向量化计算。使用固定的随机种子来确保随机蒙特卡罗模拟是可复现的。该算法遍历三个测试用例中的每一个，执行敏感性分析，为每个用例确定最佳靶点，并汇编最终结果列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs global sensitivity analysis for a metabolic pathway model to find\n    the most robust therapeutic target for three different parameter regimes.\n    \"\"\"\n    # Set a random seed for reproducibility of the Monte Carlo simulation.\n    np.random.seed(42)\n\n    def model(params, S_in):\n        \"\"\"\n        Computes the flux J for a given set of parameters.\n        The function is vectorized to handle N-dimensional parameter arrays.\n        Parameter order: V1, K1, V2, K2, V3, K3\n        \"\"\"\n        # params is an (N, 6) numpy array. We transpose and unpack.\n        V1, K1, V2, K2, V3, K3 = params.T\n\n        v1 = (V1 * S_in) / (K1 + S_in)\n        v2 = (V2 * v1) / (K2 + v1)\n        v3 = (V3 * v2) / (K3 + v2)\n        J = v3\n        return J\n\n    def scale_samples(samples, bounds):\n        \"\"\"\n        Scales samples from the unit hypercube [0, 1]^d to their physical ranges.\n        \"\"\"\n        N, d = samples.shape\n        scaled = np.zeros_like(samples)\n        for i in range(d):\n            min_val, max_val = bounds[i]\n            scaled[:, i] = min_val + samples[:, i] * (max_val - min_val)\n        return scaled\n\n    # Define the three test cases as specified in the problem statement.\n    # Parameter order is [V1, K1, V2, K2, V3, K3].\n    test_cases = [\n        {\n            \"name\": \"Case 1 (balanced)\",\n            \"S_in\": 1.0,\n            \"N\": 8000,\n            \"bounds\": [\n                (0.5, 2.0), (0.1, 1.0), (0.5, 2.0),\n                (0.1, 1.0), (0.5, 2.0), (0.1, 1.0)\n            ],\n        },\n        {\n            \"name\": \"Case 2 (downstream-limited)\",\n            \"S_in\": 1.0,\n            \"N\": 8000,\n            \"bounds\": [\n                (1.0, 2.0), (0.2, 1.2), (1.0, 2.0),\n                (0.2, 1.2), (0.1, 0.5), (0.2, 1.2)\n            ],\n        },\n        {\n            \"name\": \"Case 3 (upstream-limited)\",\n            \"S_in\": 0.5,\n            \"N\": 8000,\n            \"bounds\": [\n                (0.4, 1.2), (1.0, 5.0), (1.0, 2.0),\n                (0.1, 0.5), (1.0, 2.0), (0.1, 0.5)\n            ],\n        },\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        S_in = case[\"S_in\"]\n        bounds = case[\"bounds\"]\n        d = len(bounds)\n\n        # 1. Generate two independent sample matrices A and B from U[0,1]\n        A_unit = np.random.rand(N, d)\n        B_unit = np.random.rand(N, d)\n\n        # 2. Scale samples to their physical ranges\n        A_scaled = scale_samples(A_unit, bounds)\n        B_scaled = scale_samples(B_unit, bounds)\n\n        # 3. Evaluate the model for matrices A and B\n        y_A = model(A_scaled, S_in)\n        y_B = model(B_scaled, S_in)\n\n        # 4. Estimate the total variance Var(Y) from the combined outputs\n        # We use the sample variance (ddof=1) over the 2N samples.\n        var_Y = np.var(np.concatenate([y_A, y_B]), ddof=1)\n        \n        # Handle the edge case of zero variance to prevent division by zero\n        if var_Y  1e-12: # Using a small tolerance for floating point comparison\n            # If variance is zero, all sensitivity indices are zero.\n            # The choice of target is arbitrary; we can default to 1.\n            final_results.append(1)\n            continue\n            \n        total_indices = {}\n        # The parameters of interest are V1, V2, V3.\n        # Their indices in the parameter array are 0, 2, 4.\n        # We map these to the therapeutic target step indices 1, 2, 3.\n        v_indices_map = {0: 1, 2: 2, 4: 3}\n\n        for param_idx, step_idx in v_indices_map.items():\n            # 5. Construct matrix A_B_i and evaluate the model\n            A_B_i_scaled = A_scaled.copy()\n            A_B_i_scaled[:, param_idx] = B_scaled[:, param_idx]\n            \n            y_A_B_i = model(A_B_i_scaled, S_in)\n            \n            # 6. Estimate the total-order index S_T_i\n            numerator = np.mean((y_A - y_A_B_i)**2)\n            s_ti = numerator / (2 * var_Y)\n            total_indices[step_idx] = s_ti\n\n        # 7. Identify the step with the maximum total-order index\n        best_target = max(total_indices, key=total_indices.get)\n        final_results.append(best_target)\n\n    # Print the results in the required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}