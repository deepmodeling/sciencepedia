{
    "hands_on_practices": [
        {
            "introduction": "要进行跨组学QTL分析，我们首先必须理解关联检验的统计学基础。本练习将指导您推导单SNP关联统计量（$z$-分数）的联合分布，揭示连锁不平衡（LD）如何从根本上塑造我们检验结果的相关性结构。掌握这一概念对于准确解释全基因组范围内的关联信号至关重要。",
            "id": "4395278",
            "problem": "在系统生物医学中，考虑一项跨组学数量性状基因座 (QTL) 分析，其中分子表型是一个整合的跨组学性状，该性状由信使核糖核酸 (mRNA)、蛋白质和代谢物水平的标准化聚合构建而成。假设有 $n$ 个个体和 $p$ 个单核苷酸多态性 (SNP)。用 $\\mathbf{y} \\in \\mathbb{R}^{n}$ 表示标准化的跨组学性状向量（均值为 $0$，方差为 $1$），用 $\\mathbf{G} \\in \\mathbb{R}^{n \\times p}$ 表示 $p$ 个 SNP 的标准化基因型矩阵（每个 SNP 列的均值为 $0$，方差为 $1$）。假设线性模型为\n$$\n\\mathbf{y} = \\mathbf{G}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\boldsymbol{\\theta} \\in \\mathbb{R}^{p}$ 是 SNP 对跨组学性状的效应大小，而 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$ 表示个体间的独立残差变异。定义连锁不平衡 (LD) 矩阵为\n$$\n\\mathbf{R} = \\frac{1}{n}\\mathbf{G}^{\\top}\\mathbf{G},\n$$\n根据所述的标准化，这是由连锁不平衡 (LD) 引起的 SNP 间的经验相关矩阵。\n\n对于 SNP $j$，通过对每个 SNP 进行单独的普通最小二乘 (OLS) 回归来构建一个基于汇总数据的关联统计量，\n$$\n\\mathbf{y} = \\alpha_{j}\\mathbf{1} + \\beta_{j}\\mathbf{g}_{j} + \\boldsymbol{\\varepsilon}_{j},\n$$\n其中 $\\mathbf{g}_{j}$ 表示 $\\mathbf{G}$ 的第 $j$ 列，然后将估计效应与其标准误的比值构造成 $z$ 统计量。从 OLS 估计量及其抽样方差出发，推导在原假设 $\\boldsymbol{\\theta} = \\mathbf{0}$ 下 $z$ 统计量的形式以及跨 SNP 的 $z$ 统计量向量的联合抽样分布，并明确说明连锁不平衡 (LD) 是如何（通过 $\\mathbf{R}$）进入这个分布的。\n\n然后，考虑一个具有 $p = 2$ 个 SNP 的基因座，其连锁不平衡 (LD) 相关系数为 $r$，因此\n$$\n\\mathbf{R} = \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix}.\n$$\n在原假设 $\\boldsymbol{\\theta} = \\mathbf{0}$ 和上述模型假设下，计算线性对比 $z_{1} - z_{2}$ 的方差（用 $r$ 表示）。请提供仅以 $r$ 为函数的 $\\mathrm{Var}(z_{1} - z_{2})$ 的最终标量表达式。不需要单位。不要四舍五入，需要一个精确的封闭形式表达式。",
            "solution": "该问题要求得到两个主要结果：首先，在原假设 $\\boldsymbol{\\theta} = \\mathbf{0}$ 下，推导单个 SNP 的 $z$ 统计量形式以及 $z$ 统计量向量的联合抽样分布；其次，对于一个具有两个 SNP 且连锁不平衡相关系数为 $r$ 的基因座，计算对比 $z_{1} - z_{2}$ 的方差。\n\n分析过程分为两部分。首先，我们推导 $z$ 统计量的一般分布。其次，我们将此结果应用于给定的具体情况。\n\n**第一部分：$z$ 统计量及其分布的推导**\n\n我们首先研究 SNP $j$ 的单 SNP 普通最小二乘 (OLS) 回归模型：\n$$\n\\mathbf{y} = \\alpha_{j}\\mathbf{1} + \\beta_{j}\\mathbf{g}_{j} + \\boldsymbol{\\varepsilon}_{j}\n$$\n这里，$\\mathbf{y} \\in \\mathbb{R}^{n}$ 是表型向量，$\\mathbf{g}_{j} \\in \\mathbb{R}^{n}$ 是 SNP $j$ 的基因型向量，$\\mathbf{1}$ 是一个全为 1 的向量。问题陈述，表型向量 $\\mathbf{y}$ 和每个基因型向量 $\\mathbf{g}_{j}$ 都经过标准化，均值为 $0$，方差为 $1$。\n\n设 $\\mathbf{X}_{j} = [\\mathbf{1}, \\mathbf{g}_j]$ 为该回归的设计矩阵。$\\alpha_j$ 和 $\\beta_j$ 的 OLS 估计量由 $\\begin{pmatrix} \\hat{\\alpha}_j \\\\ \\hat{\\beta}_j \\end{pmatrix} = (\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j})^{-1}\\mathbf{X}_{j}^{\\top}\\mathbf{y}$ 给出。\n\n由于标准化，$\\mathbf{X}_j$ 的列是正交的。我们有 $\\mathbf{1}^{\\top}\\mathbf{g}_{j} = \\sum_{i=1}^{n} g_{ij} = n \\bar{g}_{j} = 0$。\n因此，矩阵 $\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j}$ 是块对角矩阵：\n$$\n\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j} = \\begin{pmatrix} \\mathbf{1}^{\\top}\\mathbf{1}  \\mathbf{1}^{\\top}\\mathbf{g}_{j} \\\\ \\mathbf{g}_{j}^{\\top}\\mathbf{1}  \\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} \\end{pmatrix} = \\begin{pmatrix} n  0 \\\\ 0  \\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} \\end{pmatrix}\n$$\n$\\mathbf{g}_{j}$ 的方差为 $1$ 的条件意味着 $\\frac{1}{n} \\sum_{i=1}^n (g_{ij} - \\bar{g}_j)^2 = 1$。由于 $\\bar{g}_j = 0$，这简化为 $\\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} = 1$，即 $\\mathbf{g}_{j}^{\\top}\\mathbf{g}_{j} = n$。\n代入此结果，我们得到：\n$$\n\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j} = \\begin{pmatrix} n  0 \\\\ 0  n \\end{pmatrix} \\quad \\implies \\quad (\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j})^{-1} = \\begin{pmatrix} \\frac{1}{n}  0 \\\\ 0  \\frac{1}{n} \\end{pmatrix}\n$$\n那么，OLS 估计向量为：\n$$\n\\begin{pmatrix} \\hat{\\alpha}_j \\\\ \\hat{\\beta}_j \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{n}  0 \\\\ 0  \\frac{1}{n} \\end{pmatrix} \\begin{pmatrix} \\mathbf{1}^{\\top}\\mathbf{y} \\\\ \\mathbf{g}_{j}^{\\top}\\mathbf{y} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{n}\\mathbf{1}^{\\top}\\mathbf{y} \\\\ \\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{y} \\end{pmatrix}\n$$\n由于 $\\mathbf{y}$ 也被标准化为均值 $0$，所以 $\\mathbf{1}^{\\top}\\mathbf{y} = n\\bar{y} = 0$。因此，截距的估计量为 $\\hat{\\alpha}_{j} = 0$。SNP 效应大小 $\\beta_j$ 的估计量为：\n$$\n\\hat{\\beta}_{j} = \\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{y}\n$$\n$\\hat{\\beta}_j$ 的抽样方差由 $\\mathrm{Var}(\\hat{\\beta}_{j}) = (\\sigma_{j}^{2}) [(\\mathbf{X}_{j}^{\\top}\\mathbf{X}_{j})^{-1}]_{22}$ 给出，其中 $(\\sigma_{j}^{2})$ 是残差 $\\boldsymbol{\\varepsilon}_{j}$ 的方差。从完整模型 $\\mathbf{y} = \\mathbf{G}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$ 可知，残差方差为 $\\sigma^2$。因此，我们有 $\\mathrm{Var}(\\hat{\\beta}_{j}) = \\sigma^2 \\cdot \\frac{1}{n} = \\frac{\\sigma^2}{n}$。\n\nSNP $j$ 的 $z$ 统计量是估计效应与其标准误的比值，即 $z_j = \\hat{\\beta}_j / \\mathrm{SE}(\\hat{\\beta}_j)$。\n$$\nz_{j} = \\frac{\\hat{\\beta}_{j}}{\\sqrt{\\sigma^2/n}} = \\frac{\\frac{1}{n}\\mathbf{g}_{j}^{\\top}\\mathbf{y}}{\\sigma/\\sqrt{n}} = \\frac{1}{\\sigma\\sqrt{n}}\\mathbf{g}_{j}^{\\top}\\mathbf{y}\n$$\n在原假设 $H_0: \\boldsymbol{\\theta} = \\mathbf{0}$ 下，完整模型简化为 $\\mathbf{y} = \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^{2}\\mathbf{I}_{n})$。所陈述的向量 $\\mathbf{y}$ 标准化为方差为 $1$ 的条件意味着，在 $H_0$ 下，任何分量 $y_i$ 的方差都为 $1$。由于 $\\mathrm{Var}(y_i) = \\mathrm{Var}(\\varepsilon_i) = \\sigma^2$，这意味着 $\\sigma^2 = 1$。\n\n当 $\\sigma^2=1$ 时，$z$ 统计量变为：\n$$\nz_{j} = \\frac{1}{\\sqrt{n}}\\mathbf{g}_{j}^{\\top}\\mathbf{y}\n$$\n我们可以将 $z$ 统计量向量 $\\mathbf{z} = (z_1, z_2, \\ldots, z_p)^{\\top}$ 表示为矩阵形式。\n$$\n\\mathbf{z} = \\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{y}\n$$\n现在我们来求在 $H_0$ 下 $\\mathbf{z}$ 的联合分布。在 $H_0$ 下，由于 $\\sigma^{2} = 1$，$\\mathbf{y} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}_{n})$。因为 $\\mathbf{z}$ 是正态分布向量 $\\mathbf{y}$ 的线性变换，所以 $\\mathbf{z}$ 本身也服从多元正态分布。\n\n$\\mathbf{z}$ 的均值为：\n$$\nE[\\mathbf{z}] = E\\left[\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{y}\\right] = \\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}E[\\mathbf{y}] = \\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{0} = \\mathbf{0}\n$$\n$\\mathbf{z}$ 的协方差矩阵为：\n$$\n\\mathrm{Cov}(\\mathbf{z}) = \\mathrm{Var}(\\mathbf{z}) = \\mathrm{Var}\\left(\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\mathbf{y}\\right) = \\left(\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\right) \\mathrm{Var}(\\mathbf{y}) \\left(\\frac{1}{\\sqrt{n}}\\mathbf{G}^{\\top}\\right)^{\\top}\n$$\n代入 $\\mathrm{Var}(\\mathbf{y}) = \\mathbf{I}_{n}$：\n$$\n\\mathrm{Cov}(\\mathbf{z}) = \\frac{1}{n} \\mathbf{G}^{\\top}\\mathbf{I}_{n}\\mathbf{G} = \\frac{1}{n}\\mathbf{G}^{\\top}\\mathbf{G}\n$$\n问题将连锁不平衡 (LD) 矩阵定义为 $\\mathbf{R} = \\frac{1}{n}\\mathbf{G}^{\\top}\\mathbf{G}$。因此，$\\mathrm{Cov}(\\mathbf{z}) = \\mathbf{R}$。\n\n在原假设下，$z$ 统计量向量的联合抽样分布是一个均值向量为 $\\mathbf{0}$、协方差矩阵为 $\\mathbf{R}$ 的多元正态分布：\n$$\n\\mathbf{z} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})\n$$\n\n**第二部分：对比 $z_1 - z_2$ 的方差**\n\n我们被要求计算一个具有 $p=2$ 个 SNP 的基因座的 $\\mathrm{Var}(z_{1} - z_{2})$，其连锁不平衡 (LD) 矩阵由下式给出：\n$$\n\\mathbf{R} = \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix}\n$$\n根据第一部分的结果，向量 $\\mathbf{z} = (z_1, z_2)^{\\top}$ 的协方差矩阵是 $\\mathbf{R}$。我们可以写出：\n$$\n\\mathrm{Cov}(\\mathbf{z}) = \\begin{pmatrix} \\mathrm{Var}(z_1)  \\mathrm{Cov}(z_1, z_2) \\\\ \\mathrm{Cov}(z_2, z_1)  \\mathrm{Var}(z_2) \\end{pmatrix} = \\begin{pmatrix} 1  r \\\\ r  1 \\end{pmatrix}\n$$\n这给了我们 $\\mathrm{Var}(z_1) = 1$, $\\mathrm{Var}(z_2) = 1$ 以及 $\\mathrm{Cov}(z_1, z_2) = r$。\n\n使用两个随机变量之差的方差的一般公式：\n$$\n\\mathrm{Var}(z_1 - z_2) = \\mathrm{Var}(z_1) + \\mathrm{Var}(z_2) - 2\\mathrm{Cov}(z_1, z_2)\n$$\n代入协方差矩阵中的值：\n$$\n\\mathrm{Var}(z_1 - z_2) = 1 + 1 - 2(r) = 2 - 2r\n$$\n线性对比 $z_1 - z_2$ 的方差是 $2 - 2r$。",
            "answer": "$$\n\\boxed{2 - 2r}\n$$"
        },
        {
            "introduction": "在识别出显著的QTL后，下一步是量化其影响并理解其在生物通路中的作用。本实践问题将演示如何将一个分子性状（如转录本丰度）的方差分解为来自多个独立遗传变异的贡献。您将进一步看到这种遗传影响如何通过中心法则传播到下游性状（蛋白质丰度），从而为跨组学因果关系提供一个定量的视角。",
            "id": "4395232",
            "problem": "在一项针对单个基因、跨越信使核糖核酸（mRNA）和蛋白质的跨组学数量性状基因座分析中，给定三个处于哈迪-温伯格平衡中的独立顺式变异。设变异 $i$ 的基因型剂量为 $G_i \\in \\{0,1,2\\}$，表示效应等位基因的数量，其等位基因频率为 $p_i$。转录本丰度 $Y_{m}$ 已被标准化为单位方差，即 $\\operatorname{Var}(Y_{m}) = 1$。从一个包含所有三个变异的转录本丰度联合加性模型中，已知以下群体数量：\n- 等位基因频率：$p_1 = 0.20$，$p_2 = 0.35$，$p_3 = 0.50$。\n- 对标准化转录本丰度的每个等位基因效应（来自一个包含所有三个变异的单一联合回归，使用中心化的预测变量）：$b_1 = 0.18$，$b_2 = -0.12$，$b_3 = 0.10$。\n\n假设：\n- 基因型 $(G_1,G_2,G_3)$ 相互独立，且每个都遵循哈迪-温伯格平衡。\n- 回归是加性的，没有交互作用项（无上位性），并使用中心化的基因型 $G_i - \\mathbb{E}[G_i]$。\n- 残差与所有预测变量不相关。\n\n此外，蛋白质丰度 $Y_{p}$ 通过转录本的线性中介作用建模，其残差独立，模型为 $Y_{p} = \\alpha Y_{m} + \\eta$，其中 $\\eta$ 与 $Y_{m}$ 独立，并且通过标准化使得 $\\operatorname{Var}(Y_{p}) = 1$。耦合系数为 $\\alpha = 0.60$。\n\n仅使用方差、协方差和线性模型的基本定义，并以分子生物学中心法则作为中介结构的概念性理由，从第一性原理出发，推导如何将由三个变异解释的 $Y_{m}$ 方差分解为加性成分，然后通过线性中介传播此分解，以获得由这些顺式变异通过 $Y_{m}$ 解释的 $Y_{p}$ 方差比例。以小数比例形式表示您的最终答案，并四舍五入到四位有效数字。在最终答案中，仅报告通过转录本介导的、由顺式变异解释的蛋白质水平的方差比例。",
            "solution": "目标是确定蛋白质丰度（$Y_p$）中由三个独立的顺式遗传变异解释的方差比例，这些变异的效应是通过信使RNA（$Y_m$）的丰度来介导的。这需要一个两步过程：首先，计算由这些变异解释的 $Y_m$ 方差；其次，通过给定的中介模型将此已解释方差传播到 $Y_p$。\n\n步骤1：计算每个基因型的方差。\n问题陈述，对于每个变异 $i$，基因型剂量 $G_i$ 是集合 $\\{0, 1, 2\\}$ 中的一个整数，代表效应等位基因的数量。该群体处于哈迪-温伯格平衡（HWE）状态，效应等位基因频率为 $p_i$。在HWE下，三种可能基因型的概率是：\n- $P(G_i=2) = p_i^2$（效应等位基因纯合子）\n- $P(G_i=1) = 2p_i(1-p_i)$（杂合子）\n- $P(G_i=0) = (1-p_i)^2$（非效应等位基因纯合子）\n\n根据第一性原理，基因型剂量 $G_i$ 的期望值为：\n$$ \\mathbb{E}[G_i] = (2 \\cdot p_i^2) + (1 \\cdot 2p_i(1-p_i)) + (0 \\cdot (1-p_i)^2) = 2p_i^2 + 2p_i - 2p_i^2 = 2p_i $$\n$G_i$ 的方差为 $\\operatorname{Var}(G_i) = \\mathbb{E}[G_i^2] - (\\mathbb{E}[G_i])^2$。我们首先计算二阶矩：\n$$ \\mathbb{E}[G_i^2] = (2^2 \\cdot p_i^2) + (1^2 \\cdot 2p_i(1-p_i)) + (0^2 \\cdot (1-p_i)^2) = 4p_i^2 + 2p_i - 2p_i^2 = 2p_i^2 + 2p_i $$\n因此，方差为：\n$$ \\operatorname{Var}(G_i) = (2p_i^2 + 2p_i) - (2p_i)^2 = 2p_i^2 + 2p_i - 4p_i^2 = 2p_i - 2p_i^2 = 2p_i(1-p_i) $$\n使用给定的等位基因频率：\n- 对于变异1，$p_1 = 0.20$。\n  $\\operatorname{Var}(G_1) = 2p_1(1-p_1) = 2(0.20)(1-0.20) = 2(0.20)(0.80) = 0.32$。\n- 对于变异2，$p_2 = 0.35$。\n  $\\operatorname{Var}(G_2) = 2p_2(1-p_2) = 2(0.35)(1-0.35) = 2(0.35)(0.65) = 0.455$。\n- 对于变异3，$p_3 = 0.50$。\n  $\\operatorname{Var}(G_3) = 2p_3(1-p_3) = 2(0.50)(1-0.50) = 2(0.50)(0.50) = 0.50$。\n\n步骤2：计算由变异解释的转录本丰度（$Y_m$）的方差比例。\n转录本丰度 $Y_m$ 被建模为中心化基因型的线性加性函数：\n$$ Y_m = \\beta_0 + \\sum_{i=1}^{3} b_i (G_i - \\mathbb{E}[G_i]) + \\epsilon_m $$\n其中 $b_i$ 是每个等位基因的效应，$\\epsilon_m$ 是与基因型不相关的残差项。$Y_m$ 的总方差可以被分解。由遗传学解释的 $Y_m$ 部分是 $Y_{m,g} = \\sum_{i=1}^{3} b_i (G_i - \\mathbb{E}[G_i])$。这个遗传成分的方差是：\n$$ \\operatorname{Var}(Y_{m,g}) = \\operatorname{Var}\\left(\\sum_{i=1}^{3} b_i (G_i - \\mathbb{E}[G_i])\\right) $$\n由于变异（$G_1, G_2, G_3$）被设定为相互独立，因此对于 $i \\neq j$ 的任意两项 $b_i(G_i - \\mathbb{E}[G_i])$ 和 $b_j(G_j - \\mathbb{E}[G_j])$ 之间的协方差为零。因此，和的方差等于方差的和：\n$$ \\operatorname{Var}(Y_{m,g}) = \\sum_{i=1}^{3} \\operatorname{Var}(b_i (G_i - \\mathbb{E}[G_i])) = \\sum_{i=1}^{3} b_i^2 \\operatorname{Var}(G_i - \\mathbb{E}[G_i]) = \\sum_{i=1}^{3} b_i^2 \\operatorname{Var}(G_i) $$\n由变异解释的 $Y_m$ 方差比例，记作 $R^2_m$，是遗传方差与总方差的比率：\n$$ R^2_m = \\frac{\\operatorname{Var}(Y_{m,g})}{\\operatorname{Var}(Y_m)} $$\n鉴于 $Y_m$ 已被标准化为单位方差，$\\operatorname{Var}(Y_m) = 1$。因此，$R^2_m = \\operatorname{Var}(Y_{m,g})$。\n代入给定的效应大小 $b_1 = 0.18$、$b_2 = -0.12$、$b_3 = 0.10$ 和计算出的基因型方差：\n$$ R^2_m = b_1^2 \\operatorname{Var}(G_1) + b_2^2 \\operatorname{Var}(G_2) + b_3^2 \\operatorname{Var}(G_3) $$\n$$ R^2_m = (0.18)^2(0.32) + (-0.12)^2(0.455) + (0.10)^2(0.50) $$\n$$ R^2_m = (0.0324)(0.32) + (0.0144)(0.455) + (0.01)(0.50) $$\n$$ R^2_m = 0.010368 + 0.006552 + 0.005 $$\n$$ R^2_m = 0.02192 $$\n\n步骤3：通过中介模型将已解释的方差传播到蛋白质丰度（$Y_p$）。\n蛋白质丰度 $Y_p$ 被建模为 $Y_m$ 的线性函数：\n$$ Y_p = \\alpha Y_m + \\eta $$\n其中 $\\alpha = 0.60$ 是耦合系数，$\\eta$ 是一个独立于 $Y_m$ 的残差项。\n为了找到由顺式变异解释的 $Y_p$ 的分量，我们将 $Y_m$ 的分解代入方程。设 $Y_m = Y_{m,g} + \\epsilon'_m$，其中 $Y_{m,g}$ 是遗传成分，$\\epsilon'_m$ 是非遗传成分（残差，包括截距）。\n$$ Y_p = \\alpha (Y_{m,g} + \\epsilon'_m) + \\eta = \\alpha Y_{m,g} + \\alpha \\epsilon'_m + \\eta $$\n代表顺式变异通过转录本介导的对蛋白质丰度的遗传效应的项是 $\\alpha Y_{m,g}$。\n这个成分的方差是：\n$$ \\operatorname{Var}(\\alpha Y_{m,g}) = \\alpha^2 \\operatorname{Var}(Y_{m,g}) = \\alpha^2 R^2_m $$\n由顺式变异通过 $Y_m$ 介导解释的 $Y_p$ 方差比例是此方差与 $Y_p$ 总方差的比率：\n$$ \\text{Proportion} = \\frac{\\operatorname{Var}(\\alpha Y_{m,g})}{\\operatorname{Var}(Y_p)} $$\n问题陈述 $Y_p$ 也被标准化为单位方差，因此 $\\operatorname{Var}(Y_p) = 1$。所求的比例因此是：\n$$ \\text{Proportion} = \\frac{\\alpha^2 R^2_m}{1} = \\alpha^2 R^2_m $$\n代入 $\\alpha$ 和 $R^2_m$ 的值：\n$$ \\text{Proportion} = (0.60)^2 \\times 0.02192 = 0.36 \\times 0.02192 = 0.0078912 $$\n最后，将结果四舍五入到四位有效数字，得到 $0.007891$。\n这个值代表了蛋白质丰度中可归因于给定顺式作用遗传变异的方差比例，其影响通过它们对转录本丰度的效应来传递。",
            "answer": "$$\n\\boxed{0.007891}\n$$"
        },
        {
            "introduction": "全基因组发现研究中的一个关键挑战是“赢家诅咒”，这是一种选择性偏倚，它会夸大显著发现的效应量。本练习通过为截断正态分布推导其偏倚，深入探讨了这种偏倚的统计学本质。更重要的是，您将学习并应用一种条件似然方法来校正这种偏倚，从而获得对真实遗传效应更准确的估计。",
            "id": "4395285",
            "problem": "一项跨组学研究在一个系统生物医学队列中调查了一个加性基因型到代谢物的数量性状位点。在线性模型中，将单核苷酸变异剂量 $g \\in \\{0,1,2\\}$ 对代谢物浓度的自然对数 $m$（代谢组学层）进行回归，并对协变量进行调整，该模型中每个等位基因效应的最大似然估计量表示为 $\\hat{\\beta}$。在独立同分布误差的线性回归的标准正则性条件下，假设大样本分布为 $\\hat{\\beta} \\sim \\mathcal{N}(\\beta, s^{2})$，其中 $\\beta$ 是真实的每个等位基因的对数倍数变化，$s$ 是标准误。\n\n发现阶段使用应用于代谢组学层的全基因组筛选规则：只有估计效应为正且超过标准化阈值的位点才会被用于多组学整合。具体来说，设 $z_{\\star}$ 为标准化截断值，且 $c = z_{\\star} s$；选择事件为 $\\hat{\\beta} > c$。这种选择规则可能会夸大已发现位点中的 $\\hat{\\beta}$（“赢家诅咒”）。\n\n给定一个已发现的位点，其观测值为 $\\hat{\\beta} = 0.90$ 和 $s = 0.12$，筛选阈值为 $z_{\\star} = 5$（因此 $c = z_{\\star} s = 0.60$），请完成以下任务：\n\n1. 从 $\\hat{\\beta}$ 的渐近正态性和选择事件 $\\hat{\\beta} > c$ 出发，推导条件期望 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c]$，并证明对于任何有限的 $\\beta$ 和 $s > 0$，差值 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c] - \\beta$ 严格为正，从而量化赢家诅咒。\n\n2. 在事件 $\\hat{\\beta} > c$ 下，使用单个观测值 $\\hat{\\beta} = x$ 的条件（截断）似然，通过关于 $\\beta$ 最大化条件似然，推导偏差校正效应 $\\tilde{\\beta}$ 的估计方程。然后，使用 $x = 0.90$、$s = 0.12$ 和 $c = 0.60$，数值求解该估计方程，以获得条件似然校正后的估计值 $\\tilde{\\beta}$。\n\n3. 针对相同设定，提出一个参数化自助法方案（概念上，无需运行模拟），该方案将估计并减去选择引起的偏倚，并解释它如何与第1部分中推导出的截断正态期望相关联。\n\n将第2部分得到的最终校正后的每个等位基因效应 $\\tilde{\\beta}$ 报告为单个数值。答案保留四位有效数字。将校正后的效应表示为每个等位基因的自然对数倍数变化。",
            "solution": "首先评估问题的有效性。\n\n### 第1步：提取已知条件\n-   每个等位基因效应的估计量 $\\hat{\\beta}$ 服从大样本正态分布：$\\hat{\\beta} \\sim \\mathcal{N}(\\beta, s^{2})$，其中 $\\beta$ 是真实效应，$s$ 是标准误。\n-   一个位点被继续研究的选择规则是 $\\hat{\\beta} > c$。\n-   选择截断值定义为 $c = z_{\\star} s$。\n-   单个已发现位点的观测数据：\n    -   观测效应估计值：$\\hat{\\beta}$ 的一个观测值，我们记为 $x = 0.90$。\n    -   标准误：$s = 0.12$。\n    -   标准化筛选阈值：$z_{\\star} = 5$。\n-   根据给定值，选择截断值为 $c = z_{\\star} s = 5 \\times 0.12 = 0.60$。因此，选择事件为 $\\hat{\\beta} > 0.60$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上基于成熟的统计领域——数量遗传学，并解决了全基因组关联研究中常见的选择偏倚或“赢家诅咒”问题。在渐近理论下，使用正态近似来处理回归系数 $\\hat{\\beta}$ 是标准做法。问题是适定的，提供了所有必要的参数和一组明确的任务（一个推导，一个数值计算，以及一个概念性解释）。语言客观而精确。所提供的数据内部一致（观测值 $x=0.90$ 满足选择标准 $\\hat{\\beta} > 0.60$），并且在遗传关联研究的背景下是物理上合理的。因此，该问题被认为是有效的。\n\n### 第3步：结论与行动\n问题有效。下面提供完整解答。\n\n---\n\n按要求分三部分呈现解答。\n\n### 第1部分：条件期望与赢家诅咒\n\n设 $Y$ 是一个代表估计量 $\\hat{\\beta}$ 的随机变量，因此 $Y \\sim \\mathcal{N}(\\beta, s^{2})$。其概率密度函数（PDF）为 $f_Y(y) = \\frac{1}{s\\sqrt{2\\pi}} \\exp\\left(-\\frac{(y-\\beta)^2}{2s^2}\\right)$。设 $\\phi(\\cdot)$ 和 $\\Phi(\\cdot)$ 分别表示标准正态分布 $\\mathcal{N}(0, 1)$ 的概率密度函数（PDF）和累积分布函数（CDF）。$Y$ 的 PDF可以写成 $f_Y(y) = \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right)$。\n\n选择事件的概率为：\n$$ P(Y > c) = \\int_c^{\\infty} \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right) dy $$\n令 $u = \\frac{y-\\beta}{s}$，则 $dy = s du$。积分下限变为 $\\alpha = \\frac{c-\\beta}{s}$。\n$$ P(Y > c) = \\int_{\\alpha}^{\\infty} \\phi(u) du = 1 - \\Phi(\\alpha) = 1 - \\Phi\\left(\\frac{c-\\beta}{s}\\right) $$\n在 $Y > c$ 的条件下，$Y$ 的条件概率密度函数为：\n$$ f_{Y|Y>c}(y) = \\frac{f_Y(y)}{P(Y > c)} = \\frac{\\frac{1}{s}\\phi\\left(\\frac{y-\\beta}{s}\\right)}{1 - \\Phi\\left(\\frac{c-\\beta}{s}\\right)} \\quad \\text{for } y > c $$\n条件期望 $\\mathbb{E}[Y \\mid Y > c]$ 为：\n$$ \\mathbb{E}[Y \\mid Y > c] = \\int_c^{\\infty} y f_{Y|Y>c}(y) dy = \\frac{1}{1 - \\Phi(\\alpha)} \\int_c^{\\infty} y \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right) dy $$\n使用相同的代换 $u = \\frac{y-\\beta}{s}$（因此 $y = su + \\beta$）：\n$$ \\int_c^{\\infty} y \\frac{1}{s} \\phi\\left(\\frac{y-\\beta}{s}\\right) dy = \\int_{\\alpha}^{\\infty} (su+\\beta) \\phi(u) du = s \\int_{\\alpha}^{\\infty} u\\phi(u)du + \\beta \\int_{\\alpha}^{\\infty} \\phi(u)du $$\n第二个积分是 $\\beta (1 - \\Phi(\\alpha))$。对于第一个积分，我们注意到 $\\frac{d}{du}\\phi(u) = -u\\phi(u)$。\n$$ s \\int_{\\alpha}^{\\infty} u\\phi(u)du = -s \\int_{\\alpha}^{\\infty} (-\\phi'(u))du = s [-\\phi(u)]_{\\alpha}^{\\infty} = s(0 - (-\\phi(\\alpha))) = s\\phi(\\alpha) $$\n合并各项，分子变为 $s\\phi(\\alpha) + \\beta(1-\\Phi(\\alpha))$。除以分母 $P(Y > c)=1-\\Phi(\\alpha)$：\n$$ \\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c] = \\frac{s\\phi(\\alpha) + \\beta(1-\\Phi(\\alpha))}{1 - \\Phi(\\alpha)} = \\beta + s \\frac{\\phi(\\alpha)}{1 - \\Phi(\\alpha)} $$\n代回 $\\alpha = \\frac{c-\\beta}{s}$：\n$$ \\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c] = \\beta + s \\frac{\\phi\\left(\\frac{c-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n项 $\\frac{\\phi(z)}{1-\\Phi(z)}$ 被称为逆米尔斯比。选择偏倚，即“赢家诅咒”，是条件期望与真实参数 $\\beta$ 之间的差值：\n$$ \\text{Bias} = \\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c] - \\beta = s \\frac{\\phi\\left(\\frac{c-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n为了证明这个偏倚是严格为正的，我们分析它的组成部分。给定标准误 $s$ 大于0。标准正态PDF $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$ 对所有实数 $z$ 都是严格为正的。标准正态CDF $\\Phi(z)$ 是一个严格递增的函数，其值域为 $(0,1)$，这意味着 $1 - \\Phi(z)$ 对所有实数 $z$ 都是严格为正的。由于偏倚是严格为正的量的乘积和比率，因此对于任何有限的 $\\beta$ 和 $s > 0$，它都是严格为正的。\n\n### 第2部分：条件似然估计\n\n给定 $\\hat{\\beta}$ 的单个观测值 $x$，已知该观测值因 $\\hat{\\beta} > c$ 而被选中，相关的似然是条件似然。这基于第1部分推导出的条件PDF，在 $x$ 处求值：\n$$ L(\\beta; x | \\hat{\\beta} > c) = f_{\\hat{\\beta}|\\hat{\\beta}>c}(x) = \\frac{\\frac{1}{s}\\phi\\left(\\frac{x-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n为了找到在这个条件模型下 $\\beta$ 的最大似然估计量（MLE），我们记为 $\\tilde{\\beta}$，我们需要最大化对数似然函数 $\\ell(\\beta) = \\ln L(\\beta; x)$。\n$$ \\ell(\\beta) = \\ln\\left(\\frac{1}{s}\\phi\\left(\\frac{x-\\beta}{s}\\right)\\right) - \\ln\\left(1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)\\right) $$\n$$ \\ell(\\beta) = -\\ln(s) - \\ln(\\sqrt{2\\pi}) - \\frac{(x-\\beta)^2}{2s^2} - \\ln\\left(1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)\\right) $$\n我们将 $\\ell(\\beta)$ 对 $\\beta$ 求导，并令结果为0。设 $u = \\frac{c-\\beta}{s}$，则 $\\frac{du}{d\\beta} = -\\frac{1}{s}$。\n$$ \\frac{\\partial\\ell}{\\partial\\beta} = -\\frac{2(x-\\beta)(-1)}{2s^2} - \\frac{1}{1-\\Phi(u)} \\cdot \\frac{d}{d\\beta}\\left(1-\\Phi(u)\\right) $$\n$$ \\frac{\\partial\\ell}{\\partial\\beta} = \\frac{x-\\beta}{s^2} - \\frac{1}{1-\\Phi(u)} \\left(-\\phi(u) \\frac{du}{d\\beta}\\right) = \\frac{x-\\beta}{s^2} - \\frac{\\phi(u)}{1-\\Phi(u)} \\left(-\\frac{1}{s}\\right) $$\n$$ \\frac{\\partial\\ell}{\\partial\\beta} = \\frac{x-\\beta}{s^2} - \\frac{1}{s} \\frac{\\phi\\left(\\frac{c-\\beta}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\beta}{s}\\right)} $$\n将导数设为零，得到 $\\tilde{\\beta}$ 的估计方程：\n$$ \\frac{x-\\tilde{\\beta}}{s^2} = \\frac{1}{s} \\frac{\\phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)} $$\n$$ x - \\tilde{\\beta} = s \\frac{\\phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)} $$\n这可以重排为 $\\tilde{\\beta} = x - s \\frac{\\phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\tilde{\\beta}}{s}\\right)}$。校正项是第1部分中的解析偏倚，在校正后的估计值 $\\tilde{\\beta}$ 处求值。\n\n我们使用给定值 $x=0.90$、$s=0.12$ 和 $c=0.60$ 数值求解此方程。\n$$ \\tilde{\\beta} = 0.90 - 0.12 \\frac{\\phi\\left(\\frac{0.60-\\tilde{\\beta}}{0.12}\\right)}{1-\\Phi\\left(\\frac{0.60-\\tilde{\\beta}}{0.12}\\right)} $$\n这是一个非线性方程，可以用不动点迭代法或求根算法求解。设初始猜测值为 $\\beta_0 = x = 0.90$。\n第一次迭代是：\n$$ \\beta_1 = 0.90 - 0.12 \\frac{\\phi\\left(\\frac{0.60-0.90}{0.12}\\right)}{1-\\Phi\\left(\\frac{0.60-0.90}{0.12}\\right)} = 0.90 - 0.12 \\frac{\\phi(-2.5)}{1-\\Phi(-2.5)} $$\n使用标准正态分布表值，$\\phi(-2.5) \\approx 0.017528$ 和 $\\Phi(-2.5) \\approx 0.006210$。注意 $1 - \\Phi(-2.5) = \\Phi(2.5) \\approx 0.99379$。\n$$ \\beta_1 \\approx 0.90 - 0.12 \\left(\\frac{0.017528}{0.99379}\\right) \\approx 0.90 - 0.12(0.017637) \\approx 0.90 - 0.002116 = 0.897884 $$\n继续这个迭代过程直到收敛：\n$\\beta_2 \\approx 0.897791$\n$\\beta_3 \\approx 0.897786$\n序列收敛很快。$\\tilde{\\beta}$ 的解，保留四位有效数字，是 $0.8978$。\n\n### 第3部分：参数化自助法方案\n\n参数化自助法可用于估计选择偏倚并校正观测估计值 $x$。目标是估计偏倚项 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c] - \\beta$，它依赖于未知的真实 $\\beta$。\n\n概念方案如下：\n1.  **初始估计**：获取真实效应 $\\beta$ 的一个初始、合理的估计值。一个合适的选择是第2部分中计算的条件 MLE，$\\tilde{\\beta} \\approx 0.8978$。我们将其表示为 $\\hat{\\beta}_{\\text{init}}$。\n\n2.  **自助法模拟**：执行大量的自助法重复，次数为 $B$（例如，$B=10,000$）。对于每次重复 $b=1, \\dots, B$：\n    a.  **生成数据**：从假定的抽样分布中模拟一个新的效应估计值 $\\hat{\\beta}^{*}_b$，使用初始估计值作为真实均值：$\\hat{\\beta}^{*}_b \\sim \\mathcal{N}(\\hat{\\beta}_{\\text{init}}, s^2)$。这里，从 $\\mathcal{N}(0.8978, (0.12)^2)$ 中抽取一个样本。\n    b.  **应用选择**：通过应用选择规则来模仿研究的发现过程。仅当 $\\hat{\\beta}^{*}_b$ 超过截断值 $c$ 时才保留它。即，如果 $\\hat{\\beta}^{*}_b > 0.60$。\n\n3.  **偏倚估计**：在所有 $B$ 次重复之后，计算*被选中*的自助法估计值的平均值。设这个集合为 $S = \\{\\hat{\\beta}^{*}_b \\mid \\hat{\\beta}^{*}_b > c\\}$。平均值为 $\\bar{\\beta}^{*} = \\frac{1}{|S|} \\sum_{\\hat{\\beta}^{*} \\in S} \\hat{\\beta}^{*}$。\n    估计的偏倚是这个条件均值与用于模拟的均值之差：$\\widehat{\\text{Bias}} = \\bar{\\beta}^{*} - \\hat{\\beta}_{\\text{init}}$。\n\n4.  **偏倚校正**：从原始的、未校正的观测值 $x$ 中减去估计的偏倚：\n    $$ \\hat{\\beta}_{\\text{corrected}} = x - \\widehat{\\text{Bias}} = 0.90 - (\\bar{\\beta}^{*} - 0.8978) $$\n\n**与第1部分的关系**：参数化自助法为第1部分的解析结果提供了一个数值上的蒙特卡洛近似。当真实效应被假定为 $\\hat{\\beta}_{\\text{init}}$ 时，被选中的自助法样本的平均值 $\\bar{\\beta}^{*}$ 是条件期望 $\\mathbb{E}[\\hat{\\beta} \\mid \\hat{\\beta} > c]$ 的数值估计。因此，估计的偏倚 $\\widehat{\\text{Bias}}$ 是第1部分中推导出的解析偏倚量的数值估计：\n$$ \\widehat{\\text{Bias}} = \\bar{\\beta}^{*} - \\hat{\\beta}_{\\text{init}} \\approx s \\frac{\\phi\\left(\\frac{c-\\hat{\\beta}_{\\text{init}}}{s}\\right)}{1-\\Phi\\left(\\frac{c-\\hat{\\beta}_{\\text{init}}}{s}\\right)} $$\n本质上，自助法程序通过模拟数据生成和选择过程，来经验性地衡量第1部分中的解析公式以闭合形式描述的膨胀（赢家诅咒）。",
            "answer": "$$\\boxed{0.8978}$$"
        }
    ]
}