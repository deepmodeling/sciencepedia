{
    "hands_on_practices": [
        {
            "introduction": "要理解复杂性状的遗传图谱，首先必须掌握连锁不平衡（LD）这一基本概念，它描述了群体中等位基因之间的非随机关联。本练习将通过直接从观察到的单倍型数据中推导连锁不平衡的关键度量指标 $D$ 和 $r^2$，为您打下坚实的理论基础。此外，通过模拟重组导致的连锁不平衡随世代衰减的过程，本练习将揭示连锁不平衡的动态特性，这对于理解全基因组关联研究（GWAS）的结果至关重要。",
            "id": "4352653",
            "problem": "考虑两个双等位基因座，第一个基因座的等位基因为 $\\{A,a\\}$，第二个基因座的等位基因为 $\\{B,b\\}$，存在于一个大的随机交配群体中。您对一个包含 $N$ 个单倍型的随机样本进行基因分型和定相，并观察到以下单倍型计数：$n_{AB} = 210$，$n_{Ab} = 90$，$n_{aB} = 70$，$n_{ab} = 130$，因此 $N = 500$。设 $X$ 为一个指示随机变量，当抽样单倍型携带等位基因 $A$ 时其值为 $1$，否则为 $0$；设 $Y$ 为一个指示随机变量，当抽样单倍型携带等位基因 $B$ 时其值为 $1$，否则为 $0$。仅使用二元随机变量的概率、期望、协方差和相关性的核心定义，以及标准的离散世代重组模型（无选择、突变、迁移或基因转换的随机交配），完成以下任务：\n\n1. 根据观察到的计数，计算样本单倍型频率、边际等位基因频率 $p_{A}$ 和 $p_{B}$，然后推导经典连锁不平衡（LD）系数 $D$，其定义为协方差 $\\operatorname{Cov}(X,Y)$。\n\n2. 从第一性原理出发，推导 $X$ 和 $Y$ 之间的平方相关系数 $r^{2}$，用 $D$、$p_{A}$ 和 $p_{B}$ 表示您的结果。\n\n3. 从离散世代重组过程和重组与非重组配子的全概率定律出发，推导 $t$ 代后的期望LD，$D_{t}$，作为初始LD和每代重组率 $c$ 的封闭形式函数。\n\n报告 $D$ 和 $r^{2}$ 的数值，保留四位有效数字，并将 $D_{t}$ 表示为一个包含 $c$ 和 $t$ 的解析表达式，其中初始 $D$ 的数值系数保留四位有效数字。本题中所有量均为无量纲量；最终数值答案中不包含任何单位。",
            "solution": "该问题经证实具有科学依据、问题明确且客观。这是理论群体遗传学中的一个标准问题，提供了所有必要的数据和定义。我们进行完整解答。\n\n该问题分为三个部分。首先，我们根据给定的计数计算样本单倍型和等位基因频率，然后用这些频率计算连锁不平衡系数 $D$。其次，我们推导平方相关系数 $r^2$ 并计算其数值。第三，我们推导 $t$ 代后的期望连锁不平衡 $D_t$，作为初始不平衡和重组率 $c$ 的函数。\n\n**第1部分：频率和连锁不平衡系数 $D$ 的计算**\n\n抽样单倍型总数为 $N$。给定的计数为 $n_{AB} = 210$，$n_{Ab} = 90$，$n_{aB} = 70$，$n_{ab} = 130$。\n$$N = n_{AB} + n_{Ab} + n_{aB} + n_{ab} = 210 + 90 + 70 + 130 = 500$$\n样本单倍型频率（$p_{uv}$）估计为观察到的计数除以总样本量：\n$$p_{AB} = \\frac{n_{AB}}{N} = \\frac{210}{500} = 0.42$$\n$$p_{Ab} = \\frac{n_{Ab}}{N} = \\frac{90}{500} = 0.18$$\n$$p_{aB} = \\frac{n_{aB}}{N} = \\frac{70}{500} = 0.14$$\n$$p_{ab} = \\frac{n_{ab}}{N} = \\frac{130}{500} = 0.26$$\n这些频率之和为 $0.42 + 0.18 + 0.14 + 0.26 = 1.00$，符合要求。\n\n等位基因 $A$（$p_A$）和 $B$（$p_B$）的边际等位基因频率是通过将携带它们的单倍型的频率相加来计算的：\n$$p_A = P(X=1) = p_{AB} + p_{Ab} = 0.42 + 0.18 = 0.60$$\n$$p_B = P(Y=1) = p_{AB} + p_{aB} = 0.42 + 0.14 = 0.56$$\n备择等位基因 $a$ 和 $b$ 的频率为：\n$$p_a = P(X=0) = 1 - p_A = 1 - 0.60 = 0.40$$\n$$p_b = P(Y=0) = 1 - p_B = 1 - 0.56 = 0.44$$\n\n连锁不平衡系数 $D$ 定义为指示随机变量 $X$ 和 $Y$ 的协方差，$D = \\operatorname{Cov}(X,Y)$。根据定义，协方差为 $\\operatorname{Cov}(X,Y) = E[XY] - E[X]E[Y]$。\n对于指示变量 $X$，其期望为 $E[X] = 1 \\cdot P(X=1) + 0 \\cdot P(X=0) = P(X=1) = p_A$。\n同样，对于指示变量 $Y$，$E[Y] = p_B$。\n乘积 $XY$ 也是一个指示变量。当且仅当 $X=1$ 且 $Y=1$ 时，其值为 $1$，这对应于携带 $AB$ 单倍型的情况。因此，其期望为 $E[XY] = 1 \\cdot P(X=1, Y=1) + 0 \\cdot P(\\text{not } (X=1,Y=1)) = P(X=1, Y=1) = p_{AB}$。\n将这些期望值代入协方差公式，得到 $D$ 的标准表达式：\n$$D = p_{AB} - p_A p_B$$\n使用计算出的频率值：\n$$D = 0.42 - (0.60)(0.56) = 0.42 - 0.336 = 0.084$$\n保留四位有效数字，初始连锁不平衡（我们记为 $D_0$）为 $0.08400$。\n\n**第2部分：平方相关系数 $r^2$ 的推导与计算**\n\n两个随机变量 $X$ 和 $Y$ 之间的平方相关系数 $r^2$ 定义为：\n$$r^2 = \\frac{(\\operatorname{Cov}(X,Y))^2}{\\operatorname{Var}(X)\\operatorname{Var}(Y)}$$\n从第1部分可知，$\\operatorname{Cov}(X,Y) = D$。\n接下来，我们必须求出指示变量 $X$ 和 $Y$ 的方差。对于像 $X$ 这样的伯努利随机变量，其方差为 $\\operatorname{Var}(X) = E[X^2] - (E[X])^2$。由于 $X$ 只取值 $0$ 和 $1$，因此 $X^2 = X$。所以，$E[X^2]=E[X]=p_A$。\n$X$ 的方差为：\n$$\\operatorname{Var}(X) = E[X] - (E[X])^2 = p_A - (p_A)^2 = p_A(1 - p_A)$$\n同样，$Y$ 的方差为：\n$$\\operatorname{Var}(Y) = p_B(1 - p_B)$$\n将协方差和方差代入 $r^2$ 的公式，得到用 $D$、$p_A$ 和 $p_B$ 表示的所需表达式：\n$$r^2 = \\frac{D^2}{p_A(1-p_A)p_B(1-p_B)}$$\n现在，我们使用计算出的参数计算其数值：\n$$r^2 = \\frac{(0.084)^2}{(0.60)(1-0.60)(0.56)(1-0.56)} = \\frac{0.007056}{(0.60)(0.40)(0.56)(0.44)}$$\n$$r^2 = \\frac{0.007056}{(0.24)(0.2464)} = \\frac{0.007056}{0.059136} \\approx 0.119317...$$\n保留四位有效数字，$r^2$ 为 $0.1193$。\n\n**第3部分：连锁不平衡随世代衰减的推导**\n\n我们的目标是找到第 $t$ 代的LD系数 $D_t$ 的表达式，该表达式是初始LD $D_0$ 和重组率 $c$ 的函数。在给定的模型假设（无选择、突变或迁移的随机交配）下，等位基因频率 $p_A$ 和 $p_B$ 不随时间变化。\n\n设 $p_{AB}^{(t)}$ 为第 $t$ 代 $AB$ 单倍型的频率。第 $t$ 代的LD为 $D_t = p_{AB}^{(t)} - p_A p_B$。为了找到 $D_t$ 的一般形式，我们必须首先建立 $p_{AB}^{(t)}$ 的递推关系。\n下一代 $AB$ 单倍型的频率 $p_{AB}^{(t+1)}$ 由第 $t$ 代的频率和重组率 $c$ 决定。我们使用全概率定律。第 $t+1$ 代的 $AB$ 配子可以通过两种互斥的方式形成：\n1.  它是一个非重组配子。这种情况发生的概率为 $1-c$。要产生一个 $AB$ 配子，亲本染色体必须是 $AB$ 单倍型。在第 $t$ 代的基因库中，这种染色体的频率是 $p_{AB}^{(t)}$。\n2.  它是一个重组配子。这种情况发生的概率为 $c$。要产生一个 $AB$ 配子，亲本基因型必须从一条染色体提供一个 $A$ 等位基因，并从其同源染色体提供一个 $B$ 等位基因。在随机交配的群体中，抽取这些等位基因的概率就是它们频率的乘积，$p_A p_B$。\n\n综合这些可能性，我们得到单倍型频率的递推关系：\n$$p_{AB}^{(t+1)} = (1-c)p_{AB}^{(t)} + c p_A p_B$$\n现在，我们用LD系数来表示这个关系。根据定义，$p_{AB}^{(t)} = D_t + p_A p_B$ 且 $p_{AB}^{(t+1)} = D_{t+1} + p_A p_B$。将它们代入递推关系：\n$$D_{t+1} + p_A p_B = (1-c)(D_t + p_A p_B) + c p_A p_B$$\n展开右侧：\n$$D_{t+1} + p_A p_B = (1-c)D_t + (1-c)p_A p_B + c p_A p_B$$\n$$D_{t+1} + p_A p_B = (1-c)D_t + p_A p_B$$\n两边减去 $p_A p_B$ 得到 $D_t$ 的递推关系：\n$$D_{t+1} = (1-c)D_t$$\n这是一个简单的几何级数。从第 $t=0$ 代的初始不平衡 $D_0$ 开始，我们可以展开这个递推关系：\n$$D_1 = (1-c)D_0$$\n$$D_2 = (1-c)D_1 = (1-c)^2 D_0$$\n通过归纳法，任意第 $t$ 代的解为：\n$$D_t = (1-c)^t D_0$$\n题目要求用初始LD系数 $D_0$ 的数值（我们计算出为 $0.084$）来表示这个表达式。保留四位有效数字为 $0.08400$。因此，最终的表达式是：\n$$D_t = 0.08400(1-c)^t$$\n这个方程描述了连锁不平衡因重组而随时间指数衰减的过程。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.08400  0.1193  0.08400(1-c)^{t} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理解了局部的遗传关联模式之后，我们将视野放大到性状本身的整体遗传结构。本练习利用经典的双生子研究——一个强大的自然实验——来估计性状的狭义遗传力（$h^2$），即加性遗传方差在总表型方差中所占的比例。通过这个实践，您将学会推导法尔科纳公式（Falconer's formula），更重要的是，它将引导您批判性地思考模型背后的假设，特别是共享环境效应与非加性遗传效应之间的混淆问题。",
            "id": "4352561",
            "problem": "在一个源于单一、随机交配群体的大型双生子登记库中，测量了一个复杂的数量性状。假设遵循数量遗传学和经典双生子设计的以下基本前提：(i) 性状方差可以分解为加性遗传方差、共享环境方差和独特环境方差；(ii) 同卵 (MZ) 双生子在整个基因组中共享几乎所有按亲缘关系相同的分离等位基因，而异卵 (DZ) 双生子平均共享一半；(iii) 满足同等环境假定 (EEA)，且不存在选型交配、基因-环境相关或基因-环境交互作用；以及 (iv) 测量误差归因于独特环境方差组分。设表型方差被缩放为1。\n\n将加性遗传方差定义为 $V_{A}$，共享环境方差定义为 $V_{C}$，独特环境方差定义为 $V_{E}$。设观察到的同卵双生子对内性状相关性为 $r_{MZ} = 0.68$，异卵双生子对内性状相关性为 $r_{DZ} = 0.44$。\n\n仅使用上述基本前提，在加性遗传-共同环境-独特环境 (ACE) 模型中，推导同卵和异卵双生子的预期对内相关性表达式（作为 $V_{A}$、$V_{C}$ 和 $V_{E}$ 的函数），并由此获得以 $r_{MZ}$ 和 $r_{DZ}$ 表示的窄义遗传力 $h^{2}$ 的估计量。然后，使用给定的相关性计算 $h^{2}$ 的数值。将最终的遗传力表示为小数，并四舍五入到四位有效数字。\n\n最后，基于相同的前提，分析在仅有 $r_{MZ}$ 和 $r_{DZ}$ 可用的情况下，共享环境方差 $V_{C}$ 相对于显性遗传方差 $V_{D}$ 的可识别性，并形式化地描述在何种条件下，$r_{DZ}$ 相对于 $\\tfrac{1}{2} r_{MZ}$ 的模式可以为判断共享环境或显性遗传哪个是加性效应之外的额外相似性的更合理解释来源提供信息。在您的分析中，请勿引入双生子相关性之外的任何其他数据源。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上植根于数量遗传学的原理，特别是经典的双生子研究设计。该问题提法恰当，为推导所要求的量和分析提供了充分且一致的信息。其语言客观，并采用了该领域的标准术语。\n\n该问题要求基于加性遗传-共同环境-独特环境 (ACE) 模型进行若干推导和一次计算，然后对模型的可识别性进行理论分析。\n\n**第一部分：ACE模型中双生子相关性的推导**\n\n个体表型 $P$ 的基本模型由其构成组分的总和给出：\n$$ P = A + C + E $$\n其中，$A$ 代表加性遗传效应，$C$ 代表共享或共同环境效应，$E$ 代表独特或非共享环境效应。\n\n总表型方差 $V_P$ 是这些组分方差的总和，根据问题陈述的前提，假设它们是不相关的：\n$$ V_P = V_A + V_C + V_E $$\n问题指明表型方差被缩放为1，因此 $V_P = 1$。这意味着：\n$$ V_A + V_C + V_E = 1 $$\n\n双生子对中两个成员（用下标1和2表示）之间性状的相关性定义为它们的表型协方差与总表型方差的比值：\n$$ r = \\frac{\\text{Cov}(P_1, P_2)}{V_P} $$\n由于 $V_P = 1$，相关性就等于协方差：\n$$ r = \\text{Cov}(P_1, P_2) = \\text{Cov}(A_1 + C_1 + E_1, A_2 + C_2 + E_2) $$\n展开协方差，并使用 $A$、$C$ 和 $E$ 组分相互不相关的假设，我们得到：\n$$ r = \\text{Cov}(A_1, A_2) + \\text{Cov}(C_1, C_2) + \\text{Cov}(E_1, E_2) $$\n\n我们现在将此应用于同卵 (MZ) 和异卵 (DZ) 双生子。\n\n对于**同卵 (MZ) 双生子**，他们基因上是相同的，共享100%的等位基因。因此，他们加性遗传效应的协方差就是总加性遗传方差：\n$$ \\text{Cov}(A_1, A_2) = V_A $$\n根据共享环境的定义，他们完全共享此组分。因此，他们共享环境效应的协方差就是总共享环境方差：\n$$ \\text{Cov}(C_1, C_2) = V_C $$\n根据定义，任何两个个体（包括双生子）之间的独特环境都是不相关的。\n$$ \\text{Cov}(E_1, E_2) = 0 $$\n将这些组分相加，得到同卵双生子的预期相关性：\n$$ r_{MZ} = V_A + V_C $$\n\n对于**异卵 (DZ) 双生子**，他们平均共享50%的分离等位基因，因此他们加性遗传效应的协方差是加性遗传方差的一半：\n$$ \\text{Cov}(A_1, A_2) = \\frac{1}{2} V_A $$\n在同等环境假定 (EEA) 下，假设异卵双生子与同卵双生子在相同程度上共享他们的共同环境。因此：\n$$ \\text{Cov}(C_1, C_2) = V_C $$\n他们的独特环境也是不相关的：\n$$ \\text{Cov}(E_1, E_2) = 0 $$\n将这些组分相加，得到异卵双生子的预期相关性：\n$$ r_{DZ} = \\frac{1}{2} V_A + V_C $$\n\n**第二部分：窄义遗传力 ($h^2$) 估计量的推导**\n\n窄义遗传力 $h^2$ 定义为总表型方差中可归因于加性遗传方差的比例：\n$$ h^2 = \\frac{V_A}{V_P} $$\n由于 $V_P = 1$，我们有 $h^2 = V_A$。我们可以通过解上面推导出的线性方程组来获得 $V_A$ 的估计量：\n1. $r_{MZ} = V_A + V_C$\n2. $r_{DZ} = \\frac{1}{2} V_A + V_C$\n\n用第一个方程减去第二个方程可以消去 $V_C$：\n$$ r_{MZ} - r_{DZ} = (V_A + V_C) - \\left(\\frac{1}{2} V_A + V_C\\right) $$\n$$ r_{MZ} - r_{DZ} = V_A - \\frac{1}{2} V_A = \\frac{1}{2} V_A $$\n解出 $V_A$ 得：\n$$ V_A = 2(r_{MZ} - r_{DZ}) $$\n因此，窄义遗传力的估计量为：\n$$ h^2 = 2(r_{MZ} - r_{DZ}) $$\n这通常被称为 Falconer 公式。\n\n**第三部分：$h^2$ 的数值计算**\n\n使用给定的相关性值，$r_{MZ} = 0.68$ 和 $r_{DZ} = 0.44$：\n$$ h^2 = 2(0.68 - 0.44) = 2(0.24) = 0.48 $$\n问题要求答案四舍五入到四位有效数字，即 $0.4800$。\n\n**第四部分：$V_C$ 与 $V_D$ 可识别性的分析**\n\n问题的最后一部分要求在仅有双生子相关性数据可用的情况下，分析共享环境方差 ($V_C$) 与显性遗传方variance ($V_D$) 的可识别性。这需要将标准的 ACE 模型与一个替代模型——ADE 模型进行比较，后者包含显性效应但排除了共享环境。\n\n在 ADE 模型中，表型为 $P = A + D + E$，方差为 $V_P = V_A + V_D + V_E = 1$。相关性由协方差推导得出：\n- 同卵双生子共享100%的加性效应和100%的显性效应。因此，$r_{MZ} = \\text{Cov}(A_1, A_2) + \\text{Cov}(D_1, D_2) = V_A + V_D$。\n- 异卵双生子共享50%的加性效应。在任一给定基因座上，他们共享两个按亲缘关系相同的等位基因的概率是 $\\frac{1}{4}$，因此他们显性效应的协方差是 $\\frac{1}{4}V_D$。因此，$r_{DZ} = \\frac{1}{2}V_A + \\frac{1}{4}V_D$。\n\n**可识别性问题**：仅有两个可观测量（$r_{MZ}$ 和 $r_{DZ}$），我们最多只能唯一地解出两个未知参数。ACE 模型估计 $V_A$ 和 $V_C$。ADE 模型估计 $V_A$ 和 $V_D$。仅从同卵和异卵双生子数据中，不可能同时估计 $V_A$、$V_C$ 和 $V_D$；这是双生子设计中的一个经典混淆。在完整的 ACDE 模型中，$V_C$ 和 $V_D$ 参数是不可识别的。\n\n**形式化条件**：然而，我们可以利用相关性的模式来推断哪个模型（ACE 或 ADE）为数据提供了更合理的解释。这取决于比较 $r_{DZ}$ 与 $\\frac{1}{2}r_{MZ}$。\n\n让我们分析每个模型中的关系：\n\n情况1：**ACE 模型**。我们有 $r_{MZ} = V_A + V_C$ 和 $r_{DZ} = \\frac{1}{2}V_A + V_C$。\n让我们用 $r_{MZ}$ 来表示 $r_{DZ}$：\n从第一个方程，我们得到 $V_A = r_{MZ} - V_C$。\n代入第二个方程：\n$$ r_{DZ} = \\frac{1}{2}(r_{MZ} - V_C) + V_C = \\frac{1}{2}r_{MZ} - \\frac{1}{2}V_C + V_C = \\frac{1}{2}r_{MZ} + \\frac{1}{2}V_C $$\n由于方差必须为非负值 ($V_C \\ge 0$)，ACE 模型意味着：\n$$ r_{DZ} \\ge \\frac{1}{2}r_{MZ} $$\n具体来说，如果共享环境效应对相似性有贡献 ($V_C > 0$)，那么 $r_{DZ}$ 将大于 $r_{MZ}$ 的一半。\n\n情况2：**ADE 模型**。我们有 $r_{MZ} = V_A + V_D$ 和 $r_{DZ} = \\frac{1}{2}V_A + \\frac{1}{4}V_D$。\n让我们用 $r_{MZ}$ 来表示 $r_{DZ}$。一个直接的方法是比较 $r_{DZ}$ 与 $\\frac{1}{2}r_{MZ}$：\n$$ \\frac{1}{2}r_{MZ} = \\frac{1}{2}(V_A + V_D) = \\frac{1}{2}V_A + \\frac{1}{2}V_D $$\n现在，考虑它们的差值：\n$$ \\frac{1}{2}r_{MZ} - r_{DZ} = \\left(\\frac{1}{2}V_A + \\frac{1}{2}V_D\\right) - \\left(\\frac{1}{2}V_A + \\frac{1}{4}V_D\\right) = \\frac{1}{4}V_D $$\n由于显性方差必须为非负值 ($V_D \\ge 0$)，ADE 模型意味着：\n$$ \\frac{1}{2}r_{MZ} - r_{DZ} \\ge 0 \\implies r_{DZ} \\le \\frac{1}{2}r_{MZ} $$\n具体来说，如果存在显性效应 ($V_D > 0$)，那么 $r_{DZ}$ 将小于 $r_{MZ}$ 的一半。\n\n**分析结论**：区分共享环境影响与显性遗传影响的条件是比较 $r_{DZ}$ 与 $\\frac{1}{2} r_{MZ}$。\n- 如果 $r_{DZ} > \\frac{1}{2} r_{MZ}$，双生子相似性的模式表明存在共享环境效应 ($V_C$)。\n- 如果 $r_{DZ}  \\frac{1}{2} r_{MZ}$，该模式表明存在显性遗传效应 ($V_D$)。\n- 如果 $r_{DZ} = \\frac{1}{2} r_{MZ}$，数据与一个简单的 AE 模型一致，其中 $V_C$ 和 $V_D$ 都不是重要因素。\n\n对于给定的数据（$r_{MZ} = 0.68$，$r_{DZ} = 0.44$），我们有 $\\frac{1}{2}r_{MZ} = \\frac{1}{2}(0.68) = 0.34$。由于 $r_{DZ} = 0.44 > 0.34$，数据强烈表明存在共享环境效应，这证明了使用 ACE 模型而非 ADE 模型是合理的。",
            "answer": "$$\n\\boxed{0.4800}\n$$"
        },
        {
            "introduction": "对于许多复杂疾病，我们通常将其风险理解为源于一个潜在的、无法直接观测的连续“易感性”。本练习旨在解决一个关键的实际问题：如何将真实世界中病例-对照研究的输出（比值比，OR）转换为理论易感性尺度上的效应量。掌握这种转换对于比较不同研究中的遗传效应、整合来自不同性状的数据以及构建准确的疾病预测模型至关重要。",
            "id": "4352629",
            "problem": "一家生物银行对一种加性双等位基因单核苷酸变异（将效应等位基因的数量编码为 $x \\in \\{0,1,2\\}$）进行了一项病例对照研究。对疾病状态 $Y \\in \\{0,1\\}$（病例为 $Y=1$）进行的逻辑斯谛回归得出了 $x$ 的每等位基因比值比 $\\mathrm{OR}$。该疾病的人群患病率（人群中受影响个体的比例）为 $K$。该研究采用回顾性确定方法，病例和对照组数量相等，但逻辑斯谛回归模型被正确设定。\n\n采用易感性阈值模型：存在一个潜在易感性 $L \\sim \\mathcal{N}(\\mu(x),1)$，使得 $Y=1$ 当且仅当 $L  t$，其中 $t$ 是由人群患病率 $K$ 设定的阈值，且 $\\mu(x)$ 与 $x$ 呈线性关系。假设遗传效应微小，即每等位基因对疾病风险的影响很弱。\n\n仅从以下原则出发：\n- 逻辑斯谛模型规定 $\\Pr(Y=1 \\mid x) = \\mathrm{expit}(\\alpha + b x)$，其中 $\\mathrm{expit}(u) = \\frac{1}{1+\\exp(-u)}$ 且 $b = \\ln(\\mathrm{OR})$ 是每等位基因的对数比值比系数。\n- 在病例对照抽样下，逻辑斯谛斜率参数 $b$ 是人群对数比值比的一致估计。\n- 在易感性阈值模型中，当 $L \\sim \\mathcal{N}(\\mu(x),1)$ 且阈值 $t = \\Phi^{-1}(1-K)$ 时，$\\Pr(Y=1 \\mid x) = \\Phi(\\mu(x) - t)$，其中 $\\Phi$ 是标准正态累积分布函数，$\\phi$ 是其概率密度函数。\n- 对于微小效应，可以通过匹配 $\\Pr(Y=1 \\mid x)$ 在基线风险处关于 $x$ 的导数来进行一阶（局部）近似。\n\n执行以下操作：\n1. 使用上述原则，推导易感性尺度上的每等位基因效应（记为 $\\beta_{L}$，其中 $\\mu(x) = \\beta_{L} x$ 且易感性方差为 $1$）的解析表达式，该表达式仅用 $K$ 和 $b = \\ln(\\mathrm{OR})$ 表示。您的推导必须明确地用 $K$ 表示 $t$，并在适当的地方使用 $\\phi(t)$ 和 $\\Phi^{-1}$。\n2. 将您的表达式应用于具体值 $K = 0.10$ 和 $\\mathrm{OR} = 1.20$，计算 $\\beta_{L}$ 的数值（以易感性的标准差为单位）。将您的答案四舍五入到四位有效数字。最终数值答案中不要包含任何单位。",
            "solution": "该问题是有效的，因为它在科学上基于统计遗传学的原理，提法得当，客观，并包含足够的信息以得到唯一解。我现在将继续进行推导和计算。\n\n该问题要求将逻辑斯谛回归模型中的每等位基因比值比（$\\mathrm{OR}$）转换为潜在易感性尺度上的效应大小（$\\beta_L$）。这是通过关联两个不同的关于成为病例概率 $\\Pr(Y=1 \\mid x)$ 的数学模型来实现的，其中 $x \\in \\{0, 1, 2\\}$ 是效应等位基因的数量。该关系是通过假设遗传效应微小，并匹配两种模型在对应于 $x=0$ 的基线风险水平下的一阶近似来建立的。\n\n第一个模型是逻辑斯谛回归模型，其中给定基因型 $x$ 时成为病例的概率是：\n$$ P(x) = \\Pr(Y=1 \\mid x) = \\mathrm{expit}(\\alpha + b x) = \\frac{1}{1 + \\exp(-(\\alpha + b x))} $$\n这里，$b = \\ln(\\mathrm{OR})$ 是每等位基因的对数比值比。\n\n第二个模型是易感性阈值模型。一个潜在的连续性状，即易感性 $L$，被假设服从正态分布 $L \\sim \\mathcal{N}(\\mu(x), 1)$，其中平均易感性 $\\mu(x)$ 是等位基因计数 $x$ 的线性函数，方差被标准化为 $1$。如果个体的易感性 $L$ 超过某个阈值 $t$，则该个体为病例（$Y=1$）。阈值 $t$ 由疾病的人群患病率 $K$ 决定，使得对于一个平均个体，$\\Pr(L  t)$ 对应于 $K$。根据模型设定，成为病例的概率是：\n$$ P(x) = \\Pr(L  t \\mid x) = \\Phi(\\mu(x) - t) $$\n其中 $\\Phi$ 是标准正态分布的累积分布函数（CDF）。平均易感性由 $\\mu(x) = \\beta_L x$ 给出，其中 $\\beta_L$ 是易感性尺度上的每等位基因效应。阈值 $t$ 由基线基因型 $x=0$ 的患病率 $K$ 设定。该组的平均易感性为 $\\mu(0) = 0$。该组的患病率，在微小效应的假设下，我们近似为总体人群患病率 $K$，即 $P(0) = \\Phi(0 - t) = \\Phi(-t)$。由于 $\\Phi(-t) = 1 - \\Phi(t)$，我们有 $K = 1-\\Phi(t)$，这意味着 $\\Phi(t) = 1-K$。因此，阈值为 $t = \\Phi^{-1}(1-K)$。将 $\\mu(x) = \\beta_L x$ 代入概率表达式得到：\n$$ P(x) = \\Phi(\\beta_L x - t) $$\n\n为了关联这两个模型，我们使用所提供的原则，即通过匹配 $P(x)$ 在基线 $x=0$ 处关于 $x$ 的导数来进行一阶近似。\n\n首先，我们求逻辑斯谛模型概率函数的导数：\n$$ \\frac{d P(x)}{dx} = \\frac{d}{dx} \\left( \\frac{1}{1 + \\exp(-(\\alpha + b x))} \\right) $$\n使用链式法则，并且知道 expit 函数 $\\mathrm{expit}(u)$ 的导数是 $\\mathrm{expit}(u)(1-\\mathrm{expit}(u))$，我们得到：\n$$ \\frac{d P(x)}{dx} = b \\cdot \\mathrm{expit}(\\alpha + b x) \\cdot (1 - \\mathrm{expit}(\\alpha + b x)) = b \\cdot P(x) \\cdot (1-P(x)) $$\n在基线 $x=0$ 处，概率是 $P(0)$，它对应于人群患病率 $K$。因此，$P(0) = K$。计算在 $x=0$ 处的导数：\n$$ \\left. \\frac{d P(x)}{dx} \\right|_{x=0} = b \\cdot P(0) \\cdot (1-P(0)) = b K (1-K) $$\n\n接下来，我们求易感性阈值模型概率函数的导数：\n$$ \\frac{d P(x)}{dx} = \\frac{d}{dx} \\Phi(\\beta_L x - t) $$\n使用链式法则，并且知道标准正态累积分布函数 $\\Phi(u)$ 的导数是其概率密度函数（PDF） $\\phi(u)$，我们得到：\n$$ \\frac{d P(x)}{dx} = \\phi(\\beta_L x - t) \\cdot \\frac{d}{dx}(\\beta_L x - t) = \\beta_L \\phi(\\beta_L x - t) $$\n计算此导数在 $x=0$ 处的值：\n$$ \\left. \\frac{d P(x)}{dx} \\right|_{x=0} = \\beta_L \\phi(0 - t) = \\beta_L \\phi(-t) $$\n由于标准正态概率密度函数 $\\phi$ 是一个偶函数，$\\phi(-t) = \\phi(t)$。所以，\n$$ \\left. \\frac{d P(x)}{dx} \\right|_{x=0} = \\beta_L \\phi(t) $$\n\n现在，我们令两个在 $x=0$ 处的导数表达式相等：\n$$ b K (1-K) = \\beta_L \\phi(t) $$\n解出 $\\beta_L$，我们得到：\n$$ \\beta_L = \\frac{b K (1-K)}{\\phi(t)} $$\n最后，代入 $b = \\ln(\\mathrm{OR})$ 和 $t = \\Phi^{-1}(1-K)$，我们得到了用 $K$ 和 $\\mathrm{OR}$ 表示的 $\\beta_L$ 的解析表达式：\n$$ \\beta_L = \\frac{\\ln(\\mathrm{OR}) \\cdot K (1-K)}{\\phi(\\Phi^{-1}(1-K))} $$\n这就完成了任务的第一部分。\n\n对于第二部分，我们将此公式应用于给定值：$K = 0.10$ 和 $\\mathrm{OR} = 1.20$。\n\n首先，我们计算必要的组成部分：\n对数比值比是 $b = \\ln(1.20)$。\n疾病患病率是 $K = 0.10$。$K(1-K)$ 这一项是 $0.10 \\times (1-0.10) = 0.10 \\times 0.90 = 0.09$。\n易感性阈值 $t$ 是 $t = \\Phi^{-1}(1 - 0.10) = \\Phi^{-1}(0.90)$。使用标准正态分布表或计算器，我们发现：\n$$ t \\approx 1.28155 $$\n接下来，我们计算标准正态概率密度函数 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$ 在 $t$ 处的值：\n$$ \\phi(t) = \\phi(1.28155) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(1.28155)^2}{2}\\right) \\approx 0.17550 $$\n对数比值比是：\n$$ b = \\ln(1.20) \\approx 0.18232 $$\n现在我们将这些数值代入 $\\beta_L$ 的表达式中：\n$$ \\beta_L = \\frac{b \\cdot K(1-K)}{\\phi(t)} \\approx \\frac{0.18232 \\times 0.09}{0.17550} $$\n$$ \\beta_L \\approx \\frac{0.0164088}{0.17550} \\approx 0.093500 $$\n按要求将结果四舍五入到四位有效数字，我们得到 $\\beta_L = 0.09350$。",
            "answer": "$$\n\\boxed{0.09350}\n$$"
        }
    ]
}