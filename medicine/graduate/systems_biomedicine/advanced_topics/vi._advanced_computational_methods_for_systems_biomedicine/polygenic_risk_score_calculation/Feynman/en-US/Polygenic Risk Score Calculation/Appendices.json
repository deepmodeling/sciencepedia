{
    "hands_on_practices": [
        {
            "introduction": "Understanding a polygenic risk score begins with its fundamental definition as a weighted sum of risk alleles. This first exercise walks you through the core mechanics of this calculation for a hypothetical individual and a small set of genetic variants. By then standardizing the raw score against a small cohort, you will practice transforming an absolute value into a relative, interpretable metric, which is a crucial step for comparing risk across a population .",
            "id": "4375612",
            "problem": "In systems biomedicine, the additive genetic model for complex traits represents the aggregate effect of many loci as a linear predictor on an unobserved liability. Under this model, a Polygenic Risk Score (PRS) is constructed from Single Nucleotide Polymorphism (SNP) genotypes coded as allele dosages and locus-specific weights derived from a Genome-Wide Association Study (GWAS). Consider three SNPs with effect-size weights $w=(0.05,\\,-0.02,\\,0.03)$, where each entry corresponds to the contribution per additional effect allele at that locus to the underlying liability. A cohort of $N=5$ individuals has SNP dosage vectors\n$x_{\\mathrm{A}}=(2,\\,1,\\,0)$,\n$x_{\\mathrm{B}}=(1,\\,0,\\,1)$,\n$x_{\\mathrm{C}}=(0,\\,2,\\,2)$,\n$x_{\\mathrm{D}}=(2,\\,0,\\,2)$,\n$x_{\\mathrm{E}}=(0,\\,1,\\,0)$,\nwith the entries for each $x$ denoting the count of effect alleles $\\{0,1,2\\}$ at each of the three loci. Using the additive genetic model and treating this cohort as the normalization population, compute the PRS for individual $\\mathrm{A}$ and then standardize this score by subtracting the cohort mean and dividing by the cohort standard deviation, using the population variance (divide by $N$, not $N-1$). Express the final standardized score for individual $\\mathrm{A}$ as a decimal and round your answer to $4$ significant figures.",
            "solution": "The additive genetic model for complex traits posits that the liability contributed by genetic variation can be approximated as a linear combination of locus-specific effects and allele dosages. Let the Polygenic Risk Score (PRS) for individual $i$ be denoted by $S_{i}$, and let $w=(w_{1},w_{2},w_{3})$ be the vector of SNP weights, and $x_{i}=(x_{i1},x_{i2},x_{i3})$ be the genotype dosage vector for individual $i$. The PRS is defined from first principles of the linear predictor as\n$$\nS_{i}=\\sum_{j=1}^{3} w_{j}\\,x_{ij}.\n$$\nTo place this PRS on a standardized scale that is comparable across the cohort, we compute the cohort mean\n$$\n\\mu=\\frac{1}{N}\\sum_{i=1}^{N} S_{i},\n$$\nthe population variance\n$$\n\\sigma^{2}=\\frac{1}{N}\\sum_{i=1}^{N} \\left(S_{i}-\\mu\\right)^{2},\n$$\nand the standard deviation $\\sigma=\\sqrt{\\sigma^{2}}$. The standardized score (a $z$-score on the liability scale induced by the linear predictor) for individual $i$ is then\n$$\nZ_{i}=\\frac{S_{i}-\\mu}{\\sigma}.\n$$\n\nWe now compute $S_{i}$ for each cohort member using $w=(0.05,\\,-0.02,\\,0.03)$.\n\n- Individual $\\mathrm{A}$ has $x_{\\mathrm{A}}=(2,\\,1,\\,0)$, so\n$$\nS_{\\mathrm{A}}=0.05\\cdot 2 + (-0.02)\\cdot 1 + 0.03\\cdot 0 = 0.10 - 0.02 + 0 = 0.08.\n$$\n- Individual $\\mathrm{B}$ has $x_{\\mathrm{B}}=(1,\\,0,\\,1)$, so\n$$\nS_{\\mathrm{B}}=0.05\\cdot 1 + (-0.02)\\cdot 0 + 0.03\\cdot 1 = 0.05 + 0 + 0.03 = 0.08.\n$$\n- Individual $\\mathrm{C}$ has $x_{\\mathrm{C}}=(0,\\,2,\\,2)$, so\n$$\nS_{\\mathrm{C}}=0.05\\cdot 0 + (-0.02)\\cdot 2 + 0.03\\cdot 2 = 0 - 0.04 + 0.06 = 0.02.\n$$\n- Individual $\\mathrm{D}$ has $x_{\\mathrm{D}}=(2,\\,0,\\,2)$, so\n$$\nS_{\\mathrm{D}}=0.05\\cdot 2 + (-0.02)\\cdot 0 + 0.03\\cdot 2 = 0.10 + 0 + 0.06 = 0.16.\n$$\n- Individual $\\mathrm{E}$ has $x_{\\mathrm{E}}=(0,\\,1,\\,0)$, so\n$$\nS_{\\mathrm{E}}=0.05\\cdot 0 + (-0.02)\\cdot 1 + 0.03\\cdot 0 = 0 - 0.02 + 0 = -0.02.\n$$\n\nThe cohort PRS values are $\\{0.08,\\,0.08,\\,0.02,\\,0.16,\\,-0.02\\}$. The cohort size is $N=5$, hence the mean is\n$$\n\\mu=\\frac{1}{5}\\left(0.08+0.08+0.02+0.16-0.02\\right)=\\frac{0.32}{5}=0.064.\n$$\nWe compute the deviations and their squares:\n$$\n\\begin{aligned}\nS_{\\mathrm{A}}-\\mu &= 0.08-0.064=0.016, & (S_{\\mathrm{A}}-\\mu)^{2} &= 0.000256, \\\\\nS_{\\mathrm{B}}-\\mu &= 0.08-0.064=0.016, & (S_{\\mathrm{B}}-\\mu)^{2} &= 0.000256, \\\\\nS_{\\mathrm{C}}-\\mu &= 0.02-0.064=-0.044, & (S_{\\mathrm{C}}-\\mu)^{2} &= 0.001936, \\\\\nS_{\\mathrm{D}}-\\mu &= 0.16-0.064=0.096, & (S_{\\mathrm{D}}-\\mu)^{2} &= 0.009216, \\\\\nS_{\\mathrm{E}}-\\mu &= -0.02-0.064=-0.084, & (S_{\\mathrm{E}}-\\mu)^{2} &= 0.007056.\n\\end{aligned}\n$$\nSumming these squared deviations gives\n$$\n\\sum_{i=1}^{5}\\left(S_{i}-\\mu\\right)^{2} = 0.000256+0.000256+0.001936+0.009216+0.007056 = 0.01872.\n$$\nThus the population variance and standard deviation are\n$$\n\\sigma^{2}=\\frac{1}{5}\\cdot 0.01872 = 0.003744, \\qquad \\sigma=\\sqrt{0.003744}.\n$$\nThe standardized score for individual $\\mathrm{A}$ is\n$$\nZ_{\\mathrm{A}}=\\frac{S_{\\mathrm{A}}-\\mu}{\\sigma}=\\frac{0.016}{\\sqrt{0.003744}}.\n$$\nEvaluating the square root, $\\sqrt{0.003744}\\approx 0.061188234$, so\n$$\nZ_{\\mathrm{A}}\\approx \\frac{0.016}{0.061188234}\\approx 0.261488.\n$$\nRounded to $4$ significant figures, the standardized score for individual $\\mathrm{A}$ is $0.2615$.",
            "answer": "$$\\boxed{0.2615}$$"
        },
        {
            "introduction": "The simple additive model for PRS assumes that genetic variants contribute independently to risk, but this is rarely true in practice due to linkage disequilibrium (LD). This exercise introduces a common and practical method to address this challenge: LD clumping. You will apply a defined algorithm to prune a set of correlated single nucleotide polymorphisms (SNPs), retaining a smaller, more independent set of variants before calculating the final score, thereby preventing the inflation of risk from double-counting correlated signals .",
            "id": "4375562",
            "problem": "In a single locus region on chromosome $1$, consider seven single nucleotide polymorphisms (SNPs) with genomic base-pair positions, genome-wide association study $p$-values, and pairwise linkage disequilibrium (LD) measured by the squared correlation $r^{2}$, as listed below. Use a clumping procedure with a symmetric genomic window of $\\pm 120{,}000$ base pairs around each SNP (inclusive of the boundary) and an LD threshold of $r^{2} \\geq 0.20$. Clumping is performed by ranking SNPs by ascending $p$-value, iteratively selecting the next unpruned SNP as an index SNP, and then pruning any other SNPs that lie within the specified window of that index SNP and have $r^{2}$ with that index SNP greater than or equal to the LD threshold. Once a SNP is pruned it cannot be selected later, and index SNPs are never pruned by later, less significant SNPs. All SNPs listed are eligible; there is no $p$-value exclusion aside from the ranking used for clumping.\n\nSNPs and data:\n- rsA at position $10{,}050{,}000$ with $p=3.0 \\times 10^{-6}$ and effect size (per effect allele) $\\beta=0.10$.\n- rsB at position $10{,}115{,}000$ with $p=1.5 \\times 10^{-7}$ and $\\beta=0.14$.\n- rsC at position $10{,}170{,}000$ with $p=2.0 \\times 10^{-4}$ and $\\beta=-0.06$.\n- rsD at position $10{,}240{,}000$ with $p=4.0 \\times 10^{-6}$ and $\\beta=0.09$.\n- rsE at position $10{,}300{,}000$ with $p=6.0 \\times 10^{-3}$ and $\\beta=0.04$.\n- rsF at position $10{,}380{,}000$ with $p=9.0 \\times 10^{-8}$ and $\\beta=0.12$.\n- rsG at position $10{,}500{,}000$ with $p=1.5 \\times 10^{-2}$ and $\\beta=-0.05$.\n\nNonzero pairwise $r^{2}$ values for SNP pairs lying within $\\pm 120{,}000$ base pairs of each other are:\n- $r^{2}(\\mathrm{rsA},\\mathrm{rsB})=0.80$, $r^{2}(\\mathrm{rsA},\\mathrm{rsC})=0.18$.\n- $r^{2}(\\mathrm{rsB},\\mathrm{rsC})=0.15$.\n- $r^{2}(\\mathrm{rsC},\\mathrm{rsD})=0.22$.\n- $r^{2}(\\mathrm{rsD},\\mathrm{rsE})=0.05$.\n- $r^{2}(\\mathrm{rsE},\\mathrm{rsF})=0.35$.\n- $r^{2}(\\mathrm{rsF},\\mathrm{rsG})=0.05$.\n\nFor any SNP pair not listed above, either the genomic distance exceeds $\\pm 120{,}000$ base pairs (so it is outside the clumping window for that pair) or $r^{2}$ is effectively negligible (less than $0.01$) and thus below threshold.\n\nAn individual has the following genotypes coded as the count of the GWAS effect allele for each SNP: rsA $=2$, rsB $=1$, rsC $=0$, rsD $=1$, rsE $=2$, rsF $=0$, rsG $=2$. Assume the effect alleles used to code genotypes match the effect alleles for which the GWAS effect sizes $\\beta$ are reported.\n\nStarting from the above information and definitions common in systems biomedicine, first determine the set of retained SNPs after LD clumping under the stated window and threshold. Then, using only the retained SNPs, form the polygenic risk score (PRS) for this individual as a weighted sum over retained variants, with weights given by the corresponding $\\beta$ and additive genotype coding. Report the final PRS as a single real number. Round your answer to four significant figures. The PRS is dimensionless; express it without any unit.",
            "solution": "The solution requires a two-step process: first, applying the LD clumping algorithm to select a set of approximately independent SNPs, and second, calculating the PRS using only these retained SNPs.\n\n**Part 1: LD Clumping Procedure**\n\n1.  **Rank SNPs by P-value:** The SNPs are ranked in ascending order of their $p$-values to prioritize the most statistically significant associations.\n    1.  rsF ($p = 9.0 \\times 10^{-8}$)\n    2.  rsB ($p = 1.5 \\times 10^{-7}$)\n    3.  rsA ($p = 3.0 \\times 10^{-6}$)\n    4.  rsD ($p = 4.0 \\times 10^{-6}$)\n    5.  rsC ($p = 2.0 \\times 10^{-4}$)\n    6.  rsE ($p = 6.0 \\times 10^{-3}$)\n    7.  rsG ($p = 1.5 \\times 10^{-2}$)\n\n2.  **Iterative Clumping:** We iterate through the ranked list, selecting the most significant unpruned SNP as an index SNP in each step.\n\n    *   **Iteration 1:**\n        *   **Index SNP:** rsF (pos $10{,}380{,}000$). It is retained.\n        *   **Window:** $[10{,}260{,}000, 10{,}500{,}000]$.\n        *   **Check neighbors:**\n            *   rsE (pos $10{,}300{,}000$) is in the window. $r^{2}(\\mathrm{rsE},\\mathrm{rsF})=0.35 \\geq 0.20$. **Prune rsE**.\n            *   rsG (pos $10{,}500{,}000$) is in the window. $r^{2}(\\mathrm{rsF},\\mathrm{rsG})=0.05  0.20$. rsG is not pruned.\n\n    *   **Iteration 2:**\n        *   **Index SNP:** rsB (pos $10{,}115{,}000$), the next unpruned SNP in the list. It is retained.\n        *   **Window:** $[9{,}995{,}000, 10{,}235{,}000]$.\n        *   **Check neighbors:**\n            *   rsA (pos $10{,}050{,}000$) is in the window. $r^{2}(\\mathrm{rsA},\\mathrm{rsB})=0.80 \\geq 0.20$. **Prune rsA**.\n            *   rsC (pos $10{,}170{,}000$) is in the window. $r^{2}(\\mathrm{rsB},\\mathrm{rsC})=0.15  0.20$. rsC is not pruned.\n\n    *   **Iteration 3:**\n        *   The next SNP in the list is rsA, which is already pruned. The next unpruned SNP is rsD.\n        *   **Index SNP:** rsD (pos $10{,}240{,}000$). It is retained.\n        *   **Window:** $[10{,}120{,}000, 10{,}360{,}000]$.\n        *   **Check neighbors:**\n            *   rsC (pos $10{,}170{,}000$) is in the window. $r^{2}(\\mathrm{rsC},\\mathrm{rsD})=0.22 \\geq 0.20$. **Prune rsC**.\n\n    *   **Iteration 4:**\n        *   The next SNPs in the list are rsC and rsE, both of which are pruned. The next unpruned SNP is rsG.\n        *   **Index SNP:** rsG (pos $10{,}500{,}000$). It is retained.\n        *   There are no other unpruned SNPs to check within its window.\n\n3.  **Final Retained Set:** The clumping procedure terminates. The retained SNPs are $\\{\\text{rsB, rsD, rsF, rsG}\\}$.\n\n**Part 2: PRS Calculation**\n\nThe PRS is the sum of the retained SNPs' effect sizes ($\\beta$) weighted by the individual's genotype (allele count $G$).\n$$\n\\text{PRS} = \\sum_{i \\in \\{\\text{retained}\\}} \\beta_i G_i\n$$\nThe relevant data for the retained SNPs are:\n-   rsB: $\\beta_B = 0.14$, Genotype $G_B = 1$\n-   rsD: $\\beta_D = 0.09$, Genotype $G_D = 1$\n-   rsF: $\\beta_F = 0.12$, Genotype $G_F = 0$\n-   rsG: $\\beta_G = -0.05$, Genotype $G_G = 2$\n\nNow, we calculate the PRS:\n$$\n\\text{PRS} = (0.14 \\times 1) + (0.09 \\times 1) + (0.12 \\times 0) + (-0.05 \\times 2)\n$$\n$$\n\\text{PRS} = 0.14 + 0.09 + 0 - 0.10\n$$\n$$\n\\text{PRS} = 0.23 - 0.10 = 0.13\n$$\nRounding to four significant figures, the final PRS is $0.1300$.",
            "answer": "$$\n\\boxed{0.1300}\n$$"
        },
        {
            "introduction": "Beyond accounting for correlations between SNPs, the accuracy of a PRS depends critically on the quality of the weights themselves, which are derived from GWAS summary statistics. These estimates are subject to statistical noise and biases like the 'winner's curse'. This advanced exercise demonstrates how Bayesian shrinkage offers a principled way to regularize effect size estimates, pulling them toward a more conservative and robust value. You will derive and apply the formula for a posterior mean effect size, a cornerstone of modern PRS methods that significantly improves predictive power .",
            "id": "4375580",
            "problem": "In the construction of a Polygenic Risk Score (PRS), single-nucleotide polymorphism (SNP) weights are often estimated from genome-wide association summary statistics and then regularized toward zero to reduce estimation noise. Consider a single SNP whose marginal effect estimate on a continuous liability scale is $\\hat{\\beta} = 0.05$ with standard error $SE = 0.02$, obtained from a large-sample generalized linear model where the asymptotic sampling distribution of $\\hat{\\beta}$ is approximately Gaussian. Suppose the true SNP effect $\\beta$ is modeled with a zero-mean Gaussian prior with variance $\\tau^{2} = 0.001$, reflecting prior belief in small effects.\n\nStarting from Bayesâ€™ theorem and the properties of the Gaussian distribution under conjugacy, and taking as the fundamental base the large-sample normality of maximum likelihood estimators and the normal-normal conjugate prior-likelihood system, derive the posterior mean $\\mathbb{E}[\\beta \\mid \\hat{\\beta}]$ under the assumptions:\n- Prior: $\\beta \\sim \\mathcal{N}(0, \\tau^{2})$.\n- Likelihood: $\\hat{\\beta} \\mid \\beta \\sim \\mathcal{N}(\\beta, SE^{2})$.\n\nThen evaluate the derived expression numerically at $\\hat{\\beta} = 0.05$, $SE = 0.02$, and $\\tau^{2} = 0.001$. Interpret the posterior mean as the shrunken weight for this SNP to be used in the PRS. Report the final numerical value for the shrunken weight. Round your answer to six significant figures. No units are required.",
            "solution": "The problem asks for the derivation and calculation of the posterior mean of a SNP's true effect size, $\\beta$, using a Bayesian framework with a normal-normal conjugate model.\n\n**Part 1: Derivation of the Posterior Mean**\n\nWe are given:\n-   A prior distribution for the true effect size: $\\beta \\sim \\mathcal{N}(0, \\tau^{2})$.\n-   A likelihood for the observed effect size based on the sampling distribution: $\\hat{\\beta} \\mid \\beta \\sim \\mathcal{N}(\\beta, SE^{2})$.\n\nAccording to Bayes' theorem, the posterior distribution of $\\beta$ given the data $\\hat{\\beta}$ is proportional to the product of the likelihood and the prior:\n$$\np(\\beta \\mid \\hat{\\beta}) \\propto p(\\hat{\\beta} \\mid \\beta) p(\\beta)\n$$\nSubstituting the Gaussian probability density functions (and ignoring constant normalization terms):\n$$\np(\\beta \\mid \\hat{\\beta}) \\propto \\exp\\left(-\\frac{(\\hat{\\beta} - \\beta)^2}{2SE^2}\\right) \\exp\\left(-\\frac{\\beta^2}{2\\tau^2}\\right)\n$$\nWe combine the terms in the exponent:\n$$\np(\\beta \\mid \\hat{\\beta}) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(\\hat{\\beta} - \\beta)^2}{SE^2} + \\frac{\\beta^2}{\\tau^2} \\right] \\right)\n$$\nTo find the form of the posterior, we expand the squared terms in the exponent and rearrange them into a quadratic form in $\\beta$:\n$$\n\\begin{aligned}\n\\frac{(\\hat{\\beta} - \\beta)^2}{SE^2} + \\frac{\\beta^2}{\\tau^2} = \\frac{\\hat{\\beta}^2 - 2\\hat{\\beta}\\beta + \\beta^2}{SE^2} + \\frac{\\beta^2}{\\tau^2} \\\\\n= \\beta^2 \\left(\\frac{1}{SE^2} + \\frac{1}{\\tau^2}\\right) - 2\\beta \\frac{\\hat{\\beta}}{SE^2} + \\frac{\\hat{\\beta}^2}{SE^2}\n\\end{aligned}\n$$\nThis expression is a quadratic in $\\beta$, which indicates that the posterior distribution $p(\\beta \\mid \\hat{\\beta})$ is also Gaussian. A Gaussian distribution $\\mathcal{N}(\\mu_{\\text{post}}, \\sigma_{\\text{post}}^2)$ has a PDF proportional to $\\exp\\left(-\\frac{(\\beta - \\mu_{\\text{post}})^2}{2\\sigma_{\\text{post}}^2}\\right)$, which expands to $\\exp\\left(-\\frac{1}{2\\sigma_{\\text{post}}^2}[\\beta^2 - 2\\mu_{\\text{post}}\\beta + \\mu_{\\text{post}}^2]\\right)$.\n\nBy comparing the coefficients of the $\\beta^2$ and $\\beta$ terms, we can find the posterior mean $\\mu_{\\text{post}}$ and variance $\\sigma_{\\text{post}}^2$. The coefficient of $\\beta^2$ gives the posterior precision (inverse variance):\n$$\n\\frac{1}{\\sigma_{\\text{post}}^2} = \\frac{1}{SE^2} + \\frac{1}{\\tau^2}\n$$\nThe coefficient of the linear term in $\\beta$ gives the mean:\n$$\n\\frac{2\\mu_{\\text{post}}}{2\\sigma_{\\text{post}}^2} = \\frac{\\mu_{\\text{post}}}{\\sigma_{\\text{post}}^2} = \\frac{\\hat{\\beta}}{SE^2}\n$$\nSolving for the posterior mean, $\\mu_{\\text{post}} = \\mathbb{E}[\\beta \\mid \\hat{\\beta}]$:\n$$\n\\mu_{\\text{post}} = \\sigma_{\\text{post}}^2 \\left(\\frac{\\hat{\\beta}}{SE^2}\\right) = \\left(\\frac{1}{\\frac{1}{SE^2} + \\frac{1}{\\tau^2}}\\right) \\left(\\frac{\\hat{\\beta}}{SE^2}\\right) = \\left(\\frac{SE^2 \\tau^2}{SE^2 + \\tau^2}\\right) \\left(\\frac{\\hat{\\beta}}{SE^2}\\right)\n$$\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\left(\\frac{\\tau^2}{SE^2 + \\tau^2}\\right) \\hat{\\beta}\n$$\nThis is the formula for the shrunken effect size.\n\n**Part 2: Numerical Calculation**\n\nWe are given the following values:\n-   $\\hat{\\beta} = 0.05$\n-   $SE = 0.02$, so $SE^2 = (0.02)^2 = 0.0004$\n-   $\\tau^2 = 0.001$\n\nSubstitute these into the derived formula:\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\left(\\frac{0.001}{0.0004 + 0.001}\\right) \\times 0.05\n$$\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\left(\\frac{0.001}{0.0014}\\right) \\times 0.05 = \\left(\\frac{10}{14}\\right) \\times 0.05 = \\frac{5}{7} \\times 0.05\n$$\n$$\n\\mathbb{E}[\\beta \\mid \\hat{\\beta}] = \\frac{0.25}{7} = \\frac{1}{28} \\approx 0.0357142857...\n$$\nRounding the result to six significant figures, we get $0.0357143$. This is the posterior mean, which serves as the shrunken weight for the SNP in the PRS.",
            "answer": "$$\n\\boxed{0.0357143}\n$$"
        }
    ]
}