{
    "hands_on_practices": [
        {
            "introduction": "在任何数据分析任务中，首要步骤都是从原始测量数据中提取有意义的统计量。本练习将指导您完成这一基础过程，从一个小型假设数据集出发，计算典型相关性分析（CCA）所需的核心要素——协方差矩阵。通过这个过程，您将亲手实践CCA问题的构建，并思考在系统生物医学常见的高维场景下，这些估计量所面临的挑战和相应的解决方法。",
            "id": "4322590",
            "problem": "一项系统生物医学研究收集了同一队列中 $n$ 名患者的两种组学视图。设 $X \\in \\mathbb{R}^{n \\times p}$ 表示 $p$ 个基因的转录本丰度，$Y \\in \\mathbb{R}^{n \\times q}$ 表示 $q$ 种代谢物的强度，两者均在相同的 $n$ 名患者上测量。考虑以下来自 $n = 4$ 名患者的经验数据，其中 $p = 2$，$q = 2$：\n$$\nX \\;=\\; \\begin{pmatrix}\n2  0 \\\\\n0  2 \\\\\n2  2 \\\\\n4  2\n\\end{pmatrix},\n\\qquad\nY \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n1  3 \\\\\n2  3 \\\\\n3  4\n\\end{pmatrix}.\n$$\n从第一性原理（即，将经验均值和协方差定义为总体均值和协方差的样本模拟）出发，完成以下任务：\n1) 计算 $X$ 和 $Y$ 的列经验均值，并构建列中心化数据矩阵。使用均值未知的多元正态模型的最大似然归一化方法，计算经验协方差 $\\hat{\\Sigma}_{XX} \\in \\mathbb{R}^{p \\times p}$、$\\hat{\\Sigma}_{YY} \\in \\mathbb{R}^{q \\times q}$ 和经验互协方差 $\\hat{\\Sigma}_{XY} \\in \\mathbb{R}^{p \\times q}$，每个都用因子 $1/n$ 定义。\n2) 在系统生物医学的多视图学习背景下，简要讨论 $n$ 与 $p$ 和 $q$ 的关系如何影响这些估计量的偏差和条件数，以及当 $n$ 相对于 $p$ 或 $q$ 不大时，通常采用哪些有原则的补救措施。\n3) 仅使用典型相关分析（CCA）的变分定义——即，在由 $1/n$ 归一化协方差计算的单位经验方差约束下，对线性组合 $a \\in \\mathbb{R}^{p}$ 和 $b \\in \\mathbb{R}^{q}$ 最大化 $a^{\\top}X$ 和 $b^{\\top}Y$ 之间的经验相关性——推导出确定典型相关的代数条件，然后计算给定 $X$ 和 $Y$ 的最大典型相关。\n\n将第 $3$ 部分的最终数值答案四舍五入到四位有效数字。不需要物理单位，也不涉及角度。",
            "solution": "该问题是有效的，因为它在科学上基于标准多元统计，问题提出得当，客观，并包含唯一解所需的所有信息。我们按顺序解决问题的三个部分。\n\n给定的数据矩阵为 $X \\in \\mathbb{R}^{n \\times p}$ 和 $Y \\in \\mathbb{R}^{n \\times q}$，其中 $n=4$，$p=2$，$q=2$。\n$$\nX \\;=\\; \\begin{pmatrix}\n2  0 \\\\\n0  2 \\\\\n2  2 \\\\\n4  2\n\\end{pmatrix},\n\\qquad\nY \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n1  3 \\\\\n2  3 \\\\\n3  4\n\\end{pmatrix}.\n$$\n\n第1部分：经验均值和协方差的计算\n\n首先，我们计算列经验均值 $\\bar{x} \\in \\mathbb{R}^{p}$ 和 $\\bar{y} \\in \\mathbb{R}^{q}$。\n对于矩阵 $X$，均值向量 $\\bar{x}$ 的分量为：\n$$ \\bar{x}_1 = \\frac{1}{4}(2+0+2+4) = \\frac{8}{4} = 2 $$\n$$ \\bar{x}_2 = \\frac{1}{4}(0+2+2+2) = \\frac{6}{4} = \\frac{3}{2} = 1.5 $$\n所以，$\\bar{x} = \\begin{pmatrix} 2 \\\\ 1.5 \\end{pmatrix}$。\n\n对于矩阵 $Y$，均值向量 $\\bar{y}$ 的分量为：\n$$ \\bar{y}_1 = \\frac{1}{4}(1+1+2+3) = \\frac{7}{4} = 1.75 $$\n$$ \\bar{y}_2 = \\frac{1}{4}(1+3+3+4) = \\frac{11}{4} = 2.75 $$\n所以，$\\bar{y} = \\begin{pmatrix} 1.75 \\\\ 2.75 \\end{pmatrix}$。\n\n接下来，我们构建列中心化数据矩阵，$X_c = X - \\mathbf{1}\\bar{x}^{\\top}$ 和 $Y_c = Y - \\mathbf{1}\\bar{y}^{\\top}$，其中 $\\mathbf{1}$ 是一个由 $n=4$ 个1组成的列向量。\n$$\nX_c = \\begin{pmatrix}\n2-2  0-1.5 \\\\\n0-2  2-1.5 \\\\\n2-2  2-1.5 \\\\\n4-2  2-1.5\n\\end{pmatrix}\n= \\begin{pmatrix}\n0  -1.5 \\\\\n-2  0.5 \\\\\n0  0.5 \\\\\n2  0.5\n\\end{pmatrix}\n$$\n$$\nY_c = \\begin{pmatrix}\n1-1.75  1-2.75 \\\\\n1-1.75  3-2.75 \\\\\n2-1.75  3-2.75 \\\\\n3-1.75  4-2.75\n\\end{pmatrix}\n= \\begin{pmatrix}\n-0.75  -1.75 \\\\\n-0.75  0.25 \\\\\n0.25  0.25 \\\\\n1.25  1.25\n\\end{pmatrix}\n$$\n现在，我们使用指定的最大似然归一化因子 $1/n$ 计算经验协方差矩阵。\n$X$ 的经验协方差为 $\\hat{\\Sigma}_{XX} = \\frac{1}{n} X_c^{\\top}X_c$：\n$$\n\\hat{\\Sigma}_{XX} = \\frac{1}{4} \\begin{pmatrix} 0  -2  0  2 \\\\ -1.5  0.5  0.5  0.5 \\end{pmatrix} \\begin{pmatrix} 0  -1.5 \\\\ -2  0.5 \\\\ 0  0.5 \\\\ 2  0.5 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 8  0 \\\\ 0  3 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  0.75 \\end{pmatrix}\n$$\n$Y$ 的经验协方差为 $\\hat{\\Sigma}_{YY} = \\frac{1}{n} Y_c^{\\top}Y_c$：\n$$\n\\hat{\\Sigma}_{YY} = \\frac{1}{4} \\begin{pmatrix} -0.75  -0.75  0.25  1.25 \\\\ -1.75  0.25  0.25  1.25 \\end{pmatrix} \\begin{pmatrix} -0.75  -1.75 \\\\ -0.75  0.25 \\\\ 0.25  0.25 \\\\ 1.25  1.25 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2.75  2.75 \\\\ 2.75  4.75 \\end{pmatrix} = \\begin{pmatrix} 11/16  11/16 \\\\ 11/16  19/16 \\end{pmatrix}\n$$\n经验互协方差为 $\\hat{\\Sigma}_{XY} = \\frac{1}{n} X_c^{\\top}Y_c$：\n$$\n\\hat{\\Sigma}_{XY} = \\frac{1}{4} \\begin{pmatrix} 0  -2  0  2 \\\\ -1.5  0.5  0.5  0.5 \\end{pmatrix} \\begin{pmatrix} -0.75  -1.75 \\\\ -0.75  0.25 \\\\ 0.25  0.25 \\\\ 1.25  1.25 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4  2 \\\\ 1.5  3.5 \\end{pmatrix} = \\begin{pmatrix} 1  0.5 \\\\ 0.375  0.875 \\end{pmatrix}\n$$\n\n第2部分：估计量属性的讨论\n\n在像系统生物医学这样的多视图学习应用中，经常会遇到“高维、小样本”的情况，即特征数量（$p$ 和 $q$）远超样本数量（$n$），即 $p \\gg n$ 和 $q \\gg n$。这种情况严重影响了经验协方差估计量的性质。\n\n1.  偏差和方差：协方差的MLE估计量（使用 $1/n$ 归一化）是已知的有偏估计量，会低估真实方差。虽然无偏估计量（使用 $1/(n-1)$ 归一化）可以纠正这一点，但对于大的 $n$，差异是微不足道的。在高维设置中，主要问题是估计量的高方差。样本特征值比总体特征值更分散，导致不稳定性以及样本外性能差。\n\n2.  条件数和奇异性：当 $p > n-1$ 或 $q > n-1$ 时，中心化数据矩阵 $X_c$ 或 $Y_c$ 将是秩亏的（其列秩最多为 $n-1$）。因此，经验协方差矩阵 $\\hat{\\Sigma}_{XX} = \\frac{1}{n} X_c^{\\top}X_c$ 和 $\\hat{\\Sigma}_{YY} = \\frac{1}{n} Y_c^{\\top}Y_c$ 会变得奇异（不可逆）。这对经典CCA是灾难性的，因为其求解需要对这些矩阵求逆。\n\n为解决这些问题，需要有原则的补救措施：\n- 正则化：最常用的方法是正则化CCA（RCCA）。将单位矩阵的倍数加到经验协方差矩阵上，即 $\\hat{\\Sigma}_{XX} + \\lambda_x I$ 和 $\\hat{\\Sigma}_{YY} + \\lambda_y I$。这种 Tikhonov 正则化使矩阵变为正定和可逆的，改善了它们的条件数。正则化参数 $\\lambda_x, \\lambda_y > 0$ 通常通过交叉验证来选择。这会引入偏差但减少方差，从而得到一个更好的整体模型。\n- 稀疏性：在高维情况下，通常假设只有一部分特征是相关的。稀疏CCA方法对典型向量 $a$ 和 $b$ 施加惩罚（例如，L1范数）。这鼓励稀疏性（许多零元素），有效地执行特征选择。这不仅对问题进行了正则化，还增强了可解释性，这在系统生物医学中识别关键生物标志物方面是一个至关重要的方面。\n\n第3部分：最大典型相关的推导与评估\n\n典型相关分析（CCA）旨在寻找 $X$ 和 $Y$ 中变量的线性组合，使其相关性最大。设典型变量为 $u = X_c a$ 和 $v = Y_c b$，其中 $a \\in \\mathbb{R}^p$ 和 $b \\in \\mathbb{R}^q$ 是典型权重向量。变分问题是在归一化约束下最大化相关性 $\\rho = \\text{corr}(u,v)$。\n相关性定义为：\n$$ \\rho = \\frac{\\text{cov}(u, v)}{\\sqrt{\\text{var}(u) \\text{var}(v)}} = \\frac{a^{\\top}\\hat{\\Sigma}_{XY}b}{\\sqrt{(a^{\\top}\\hat{\\Sigma}_{XX}a)(b^{\\top}\\hat{\\Sigma}_{YY}b)}} $$\n优化问题被表述为在单位方差约束下最大化协方差 $a^{\\top}\\hat{\\Sigma}_{XY}b$：\n$$ \\max_{a,b} a^{\\top}\\hat{\\Sigma}_{XY}b \\quad \\text{subject to} \\quad a^{\\top}\\hat{\\Sigma}_{XX}a = 1 \\text{ and } b^{\\top}\\hat{\\Sigma}_{YY}b = 1 $$\n我们使用拉格朗日乘子法求解此问题。拉格朗日函数为：\n$$ \\mathcal{L}(a, b, \\lambda_a, \\lambda_b) = a^{\\top}\\hat{\\Sigma}_{XY}b - \\frac{\\lambda_a}{2}(a^{\\top}\\hat{\\Sigma}_{XX}a - 1) - \\frac{\\lambda_b}{2}(b^{\\top}\\hat{\\Sigma}_{YY}b - 1) $$\n求导并令其为零，得到耦合方程组：\n$$ \\frac{\\partial\\mathcal{L}}{\\partial a} = \\hat{\\Sigma}_{XY}b - \\lambda_a \\hat{\\Sigma}_{XX}a = 0 \\implies \\hat{\\Sigma}_{XY}b = \\lambda_a \\hat{\\Sigma}_{XX}a $$\n$$ \\frac{\\partial\\mathcal{L}}{\\partial b} = \\hat{\\Sigma}_{YX}a - \\lambda_b \\hat{\\Sigma}_{YY}b = 0 \\implies \\hat{\\Sigma}_{YX}a = \\lambda_b \\hat{\\Sigma}_{YY}b $$\n其中 $\\hat{\\Sigma}_{YX} = \\hat{\\Sigma}_{XY}^{\\top}$。用 $a^{\\top}$ 左乘第一个方程，用 $b^{\\top}$ 左乘第二个方程，并应用约束条件，可得 $\\lambda_a = \\lambda_b = a^{\\top}\\hat{\\Sigma}_{XY}b = \\rho$。典型相关 $\\rho$ 就是拉格朗日乘子。\n\n为了推导代数条件，我们求解 $a$ 和 $b$。假设 $\\hat{\\Sigma}_{XX}$ 和 $\\hat{\\Sigma}_{YY}$ 是可逆的（对于此问题它们是可逆的，因为 $n-1 > p,q$）：\n$$ a = \\frac{1}{\\rho}\\hat{\\Sigma}_{XX}^{-1}\\hat{\\Sigma}_{XY}b $$\n将此代入第二个方程：\n$$ \\hat{\\Sigma}_{YX}\\left(\\frac{1}{\\rho}\\hat{\\Sigma}_{XX}^{-1}\\hat{\\Sigma}_{XY}b\\right) = \\rho\\hat{\\Sigma}_{YY}b $$\n$$ \\hat{\\Sigma}_{YX}\\hat{\\Sigma}_{XX}^{-1}\\hat{\\Sigma}_{XY}b = \\rho^2\\hat{\\Sigma}_{YY}b $$\n$$ (\\hat{\\Sigma}_{YY}^{-1}\\hat{\\Sigma}_{YX}\\hat{\\Sigma}_{XX}^{-1}\\hat{\\Sigma}_{XY})b = \\rho^2 b $$\n这是一个标准的特征值问题。典型相关的平方 $\\rho^2$ 是矩阵 $K = \\hat{\\Sigma}_{YY}^{-1}\\hat{\\Sigma}_{YX}\\hat{\\Sigma}_{XX}^{-1}\\hat{\\Sigma}_{XY}$ 的特征值。最大典型相关是 $K$ 的最大特征值的平方根。一个等价的问题是找到 $\\rho^2$ 作为 $K' = \\hat{\\Sigma}_{XX}^{-1}\\hat{\\Sigma}_{XY}\\hat{\\Sigma}_{YY}^{-1}\\hat{\\Sigma}_{YX}$ 的特征值。\n\n我们现在计算给定数据的最大典型相关。我们使用矩阵 $K'$：\n$$ \\hat{\\Sigma}_{XX}^{-1} = \\begin{pmatrix} 2  0 \\\\ 0  3/4 \\end{pmatrix}^{-1} = \\begin{pmatrix} 1/2  0 \\\\ 0  4/3 \\end{pmatrix} $$\n$$ \\det(\\hat{\\Sigma}_{YY}) = (\\frac{11}{16})(\\frac{19}{16}) - (\\frac{11}{16})^2 = \\frac{11}{16}\\frac{8}{16} = \\frac{11}{32} $$\n$$ \\hat{\\Sigma}_{YY}^{-1} = \\frac{32}{11} \\begin{pmatrix} 19/16  -11/16 \\\\ -11/16  11/16 \\end{pmatrix} = \\frac{2}{11} \\begin{pmatrix} 19  -11 \\\\ -11  11 \\end{pmatrix} $$\n我们计算 $K' = (\\hat{\\Sigma}_{XX}^{-1} \\hat{\\Sigma}_{XY}) (\\hat{\\Sigma}_{YY}^{-1} \\hat{\\Sigma}_{YX})$：\n$$ \\hat{\\Sigma}_{XX}^{-1} \\hat{\\Sigma}_{XY} = \\begin{pmatrix} 1/2  0 \\\\ 0  4/3 \\end{pmatrix} \\begin{pmatrix} 1  1/2 \\\\ 3/8  7/8 \\end{pmatrix} = \\begin{pmatrix} 1/2  1/4 \\\\ 1/2  7/6 \\end{pmatrix} $$\n$$ \\hat{\\Sigma}_{YY}^{-1} \\hat{\\Sigma}_{YX} = \\frac{2}{11} \\begin{pmatrix} 19  -11 \\\\ -11  11 \\end{pmatrix} \\begin{pmatrix} 1  3/8 \\\\ 1/2  7/8 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 27  -5 \\\\ -11  11 \\end{pmatrix} $$\n$$ K' = \\begin{pmatrix} 1/2  1/4 \\\\ 1/2  7/6 \\end{pmatrix} \\frac{1}{11} \\begin{pmatrix} 27  -5 \\\\ -11  11 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 27/2-11/4  -5/2+11/4 \\\\ 27/2-77/6  -5/2+77/6 \\end{pmatrix} $$\n$$ K' = \\frac{1}{11} \\begin{pmatrix} 43/4  1/4 \\\\ 4/6  62/6 \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 43/4  1/4 \\\\ 2/3  31/3 \\end{pmatrix} = \\begin{pmatrix} 43/44  1/44 \\\\ 2/33  31/33 \\end{pmatrix} $$\n$K'$ 的特征值 $\\lambda = \\rho^2$ 是特征方程 $\\det(K' - \\lambda I) = 0$ 的根：\n$$ ( \\frac{43}{44} - \\lambda ) ( \\frac{31}{33} - \\lambda ) - ( \\frac{1}{44} ) ( \\frac{2}{33} ) = 0 $$\n$$ \\lambda^2 - (\\frac{43}{44}+\\frac{31}{33})\\lambda + \\frac{43 \\cdot 31 - 2}{44 \\cdot 33} = 0 $$\n迹为 $\\text{tr}(K') = \\frac{129+124}{132} = \\frac{253}{132} = \\frac{23 \\cdot 11}{12 \\cdot 11} = \\frac{23}{12}$。\n行列式为 $\\det(K') = \\frac{1333-2}{1452} = \\frac{1331}{1452} = \\frac{11^3}{12 \\cdot 11^2} = \\frac{11}{12}$。\n特征方程为 $\\lambda^2 - \\frac{23}{12}\\lambda + \\frac{11}{12} = 0$，即 $12\\lambda^2 - 23\\lambda + 11 = 0$。\n对这个二次方程进行因式分解：$(12\\lambda - 11)(\\lambda - 1) = 0$。\n根是 $\\lambda_1 = 1$ 和 $\\lambda_2 = 11/12$。\n特征值是典型相关的平方，$\\rho^2$。最大特征值是 $\\lambda_{\\max} = 1$。因此，最大典型相关是 $\\rho_{\\max} = \\sqrt{1} = 1$。\n这个结果是预料之中的。如果 $p+q \\ge n$，则保证存在一个为1的典型相关。在这个问题中，$p+q = 2+2=4$ 且 $n=4$。由于 $4 \\ge 4$，至少保证存在一个完全相关。\n四舍五入到四位有效数字的值为 $1.000$。",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "典型相关性分析的求解可以超越直接解广义特征值问题。本练习介绍了一种更为优雅且数值上更稳定的方法：数据白化。该方法通过线性变换，将原始数据投影到一个新空间，使得新变量内部不相关且方差为一。在这个“白化”空间中，寻找最大相关的投影问题被简化为一个标准的奇异值分解（SVD）问题，这揭示了CCA与SVD之间深刻的内在联系。",
            "id": "4322598",
            "problem": "一项系统生物医学研究旨在调查在一组患者中，基因表达测量值和蛋白质丰度测量值是如何协变的。设随机向量 $x \\in \\mathbb{R}^{2}$ (基因表达) 和 $y \\in \\mathbb{R}^{2}$ (蛋白质丰度)，每个向量都经过中心化处理，使其在所有患者中的均值为零。假设以下经验估计的二阶统计量在科学上是合理的且内部一致：\n- 模态内协方差矩阵为 $\\Sigma_{xx} = \\begin{pmatrix}4  0 \\\\ 0  1\\end{pmatrix}$ 和 $\\Sigma_{yy} = \\begin{pmatrix}9  0 \\\\ 0  4\\end{pmatrix}$，它们是对称正定矩阵。\n- 跨模态协方差矩阵为 $\\Sigma_{xy} = \\begin{pmatrix}3  1 \\\\ \\tfrac{3}{4}  1\\end{pmatrix}$。\n\n典范相关分析 (Canonical Correlation Analysis, CCA) 旨在寻找线性组合 $a^{\\top} x$ 和 $b^{\\top} y$，以在归一化约束 $a^{\\top} \\Sigma_{xx} a = 1$ 和 $b^{\\top} \\Sigma_{yy} b = 1$ 下最大化其相关性。在多视图学习中，解决此问题的标准方法是先对每个视图进行白化，然后分析经过适当归一化的跨协方差矩阵的奇异值。\n\n从协方差、线性变换下的相关性以及对称正定矩阵的谱特性的基本定义出发，执行以下任务：\n- 计算对称平方根的逆 $\\Sigma_{xx}^{-1/2}$ 和 $\\Sigma_{yy}^{-1/2}$。\n- 使用它们计算白化后的跨协方差 $C = \\Sigma_{xx}^{-1/2} \\Sigma_{xy} \\Sigma_{yy}^{-1/2}$。\n- 执行奇异值分解 (Singular Value Decomposition, SVD)，即分解 $C = U \\,\\mathrm{diag}(\\rho_{1}, \\rho_{2})\\, V^{\\top}$，其中 $U$ 和 $V$ 是标准正交矩阵，并找出最大的奇异分量 $(\\rho_{1}, u_{1}, v_{1})$。\n- 在原始变量空间中重构最大的典范方向 $a$ 和 $b$，使得 $a^{\\top} \\Sigma_{xx} a = 1$ 和 $b^{\\top} \\Sigma_{yy} b = 1$。\n\n作为你的最终答案，报告最大的典范相关系数 $\\rho_{1}$，以一个实数的形式。无需四舍五入；提供精确值，不带单位。",
            "solution": "问题要求在给定两个随机向量 $x \\in \\mathbb{R}^{2}$ 和 $y \\in \\mathbb{R}^{2}$ 的协方差矩阵的情况下，计算它们之间最大的典范相关系数。问题陈述已经过验证，被认为是可靠、适定和自洽的。\n\n典范相关分析 (CCA) 旨在找到变量的线性组合 $u = a^{\\top}x$ 和 $v = b^{\\top}y$，使其相关性最大化。相关性由下式给出：\n$$\n\\rho = \\frac{\\text{Cov}(u, v)}{\\sqrt{\\text{Var}(u) \\text{Var}(v)}} = \\frac{a^{\\top} \\Sigma_{xy} b}{\\sqrt{(a^{\\top} \\Sigma_{xx} a)(b^{\\top} \\Sigma_{yy} b)}}\n$$\n问题指定了归一化约束 $a^{\\top} \\Sigma_{xx} a = 1$ 和 $b^{\\top} \\Sigma_{yy} b = 1$，这将目标简化为最大化 $\\rho = a^{\\top} \\Sigma_{xy} b$。\n\n这个约束优化问题可以通过首先对变量进行“白化”来解决。我们定义白化后的变量 $\\tilde{x} = \\Sigma_{xx}^{-1/2} x$ 和 $\\tilde{y} = \\Sigma_{yy}^{-1/2} y$。这些新变量的协方差矩阵是单位矩阵：\n$$\n\\text{Cov}(\\tilde{x}) = \\Sigma_{xx}^{-1/2} \\Sigma_{xx} (\\Sigma_{xx}^{-1/2})^{\\top} = \\Sigma_{xx}^{-1/2} \\Sigma_{xx} \\Sigma_{xx}^{-1/2} = I\n$$\n$$\n\\text{Cov}(\\tilde{y}) = \\Sigma_{yy}^{-1/2} \\Sigma_{yy} (\\Sigma_{yy}^{-1/2})^{\\top} = \\Sigma_{yy}^{-1/2} \\Sigma_{yy} \\Sigma_{yy}^{-1/2} = I\n$$\n白化变量的跨协方差矩阵是：\n$$\nC = \\text{Cov}(\\tilde{x}, \\tilde{y}) = \\Sigma_{xx}^{-1/2} \\Sigma_{xy} (\\Sigma_{yy}^{-1/2})^{\\top} = \\Sigma_{xx}^{-1/2} \\Sigma_{xy} \\Sigma_{yy}^{-1/2}\n$$\n就白化变量而言，典范变量由投影向量 $u$ 和 $v$ 定义，使得 $a = \\Sigma_{xx}^{-1/2} u$ 和 $b = \\Sigma_{yy}^{-1/2} v$。归一化约束变为：\n$$\na^{\\top} \\Sigma_{xx} a = (\\Sigma_{xx}^{-1/2} u)^{\\top} \\Sigma_{xx} (\\Sigma_{xx}^{-1/2} u) = u^{\\top} \\Sigma_{xx}^{-1/2} \\Sigma_{xx} \\Sigma_{xx}^{-1/2} u = u^{\\top}u = 1\n$$\n$$\nb^{\\top} \\Sigma_{yy} b = (\\Sigma_{yy}^{-1/2} v)^{\\top} \\Sigma_{yy} (\\Sigma_{yy}^{-1/2} v) = v^{\\top} \\Sigma_{yy}^{-1/2} \\Sigma_{yy} \\Sigma_{yy}^{-1/2} v = v^{\\top}v = 1\n$$\n需要最大化的相关性是 $\\rho = u^{\\top} C v$，约束条件是 $u^{\\top}u = 1$ 和 $v^{\\top}v = 1$。这个问题的解由矩阵 $C$ 的奇异值分解 (SVD) 给出。$\\rho$ 的最大值是 $C$ 的最大奇异值。\n\n步骤如下：\n\n1.  **计算对称平方根的逆 $\\Sigma_{xx}^{-1/2}$ 和 $\\Sigma_{yy}^{-1/2}$。**\n    给定的协方差矩阵是对角矩阵：\n    $$\n    \\Sigma_{xx} = \\begin{pmatrix}4  0 \\\\ 0  1\\end{pmatrix}, \\quad \\Sigma_{yy} = \\begin{pmatrix}9  0 \\\\ 0  4\\end{pmatrix}\n    $$\n    对于对角矩阵，其平方根的逆可以通过对每个对角元素取平方根的倒数得到。\n    $$\n    \\Sigma_{xx}^{-1/2} = \\begin{pmatrix}4^{-1/2}  0 \\\\ 0  1^{-1/2}\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ 0  1\\end{pmatrix}\n    $$\n    $$\n    \\Sigma_{yy}^{-1/2} = \\begin{pmatrix}9^{-1/2}  0 \\\\ 0  4^{-1/2}\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{3}  0 \\\\ 0  \\frac{1}{2}\\end{pmatrix}\n    $$\n\n2.  **计算白化后的跨协方差矩阵 $C$。**\n    $C = \\Sigma_{xx}^{-1/2} \\Sigma_{xy} \\Sigma_{yy}^{-1/2}$，其中 $\\Sigma_{xy} = \\begin{pmatrix}3  1 \\\\ \\frac{3}{4}  1\\end{pmatrix}$。\n    $$\n    C = \\begin{pmatrix}\\frac{1}{2}  0 \\\\ 0  1\\end{pmatrix} \\begin{pmatrix}3  1 \\\\ \\frac{3}{4}  1\\end{pmatrix} \\begin{pmatrix}\\frac{1}{3}  0 \\\\ 0  \\frac{1}{2}\\end{pmatrix}\n    $$\n    首先，我们计算乘积 $\\Sigma_{xx}^{-1/2} \\Sigma_{xy}$：\n    $$\n    \\begin{pmatrix}\\frac{1}{2}  0 \\\\ 0  1\\end{pmatrix} \\begin{pmatrix}3  1 \\\\ \\frac{3}{4}  1\\end{pmatrix} = \\begin{pmatrix}(\\frac{1}{2})(3)  (\\frac{1}{2})(1) \\\\ (1)(\\frac{3}{4})  (1)(1)\\end{pmatrix} = \\begin{pmatrix}\\frac{3}{2}  \\frac{1}{2} \\\\ \\frac{3}{4}  1\\end{pmatrix}\n    $$\n    接下来，我们将此结果乘以 $\\Sigma_{yy}^{-1/2}$：\n    $$\n    C = \\begin{pmatrix}\\frac{3}{2}  \\frac{1}{2} \\\\ \\frac{3}{4}  1\\end{pmatrix} \\begin{pmatrix}\\frac{1}{3}  0 \\\\ 0  \\frac{1}{2}\\end{pmatrix} = \\begin{pmatrix}(\\frac{3}{2})(\\frac{1}{3})  (\\frac{1}{2})(\\frac{1}{2}) \\\\ (\\frac{3}{4})(\\frac{1}{3})  (1)(\\frac{1}{2})\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2}  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{1}{2}\\end{pmatrix}\n    $$\n\n3.  **求 $C$ 的奇异值。**\n    典范相关系数是 $C$ 的奇异值。矩阵的奇异值是 $C^{\\top}C$ 的特征值的平方根。由于我们的矩阵 $C$ 是对称的，其奇异值是其特征值的绝对值。我们通过求解特征方程 $\\det(C - \\rho I) = 0$ 来找到 $C$ 的特征值 $\\rho$。\n    $$\n    \\det\\begin{pmatrix}\\frac{1}{2} - \\rho  \\frac{1}{4} \\\\ \\frac{1}{4}  \\frac{1}{2} - \\rho\\end{pmatrix} = 0\n    $$\n    $$\n    \\left(\\frac{1}{2} - \\rho\\right)^2 - \\left(\\frac{1}{4}\\right)^2 = 0\n    $$\n    $$\n    \\left(\\frac{1}{2} - \\rho\\right)^2 = \\frac{1}{16}\n    $$\n    两边取平方根：\n    $$\n    \\frac{1}{2} - \\rho = \\pm\\frac{1}{4}\n    $$\n    这得到两个特征值：\n    $$\n    \\rho = \\frac{1}{2} \\mp \\frac{1}{4}\n    $$\n    特征值为 $\\rho_{1} = \\frac{1}{2} + \\frac{1}{4} = \\frac{3}{4}$ 和 $\\rho_{2} = \\frac{1}{2} - \\frac{1}{4} = \\frac{1}{4}$。\n    由于两者均为正，它们也是 $C$ 的奇异值。最大的典范相关系数是最大的奇异值 $\\rho_{1}$。\n\n因此，最大的典范相关系数是 $\\frac{3}{4}$。题目要求的其他步骤，即寻找典范方向 $a$ 和 $b$，对于最终答案不是必需的，但它们可以从对应于此奇异值的奇异向量中导出。",
            "answer": "$$\\boxed{\\frac{3}{4}}$$"
        },
        {
            "introduction": "在系统生物医学中，应用CCA的最终目的是从多组学数据中提炼出有意义的生物学洞见。本项高级实践旨在连接理论与应用，指导您构建一个完整的计算分析流程。这个练习涵盖了在真实世界分析中至关重要的步骤，包括为处理共线性而引入的正则化，利用结构系数评估变量重要性，以及最终将这些重要性分数汇总以获得生物学通路层面的评分。",
            "id": "4322575",
            "problem": "给定一个双视图多元设定，这是系统生物医学多组学整合中的典型场景。一个视图包含基因水平的测量数据，另一个视图包含代谢物水平的测量数据。需要通过典型相关分析 (Canonical Correlation Analysis, CCA) 来总结这两个视图之间的关系，并从 CCA 解中计算变量水平的重要性得分，然后将这些得分聚合为通路水平的得分。\n\n您的任务是编写一个完整、可运行的程序。对于下面测试套件中的每个测试用例，该程序需要根据 CCA 衍生的变量重要性计算通路水平的得分，并返回得分最高通路的索引（从零开始）。程序必须遵循下面的算法规范，并生成单行输出，其中包含一个由方括号括起来的、逗号分隔的索引列表。\n\n使用的基本原理和定义：\n- 对于数据矩阵 $X \\in \\mathbb{R}^{n \\times p_x}$ 和 $Y \\in \\mathbb{R}^{n \\times p_y}$（其列已标准化为零均值和单位方差），样本协方差矩阵定义为 $S_{xx} = \\frac{1}{n} X^\\top X$，$S_{yy} = \\frac{1}{n} Y^\\top Y$，以及互协方差 $S_{xy} = \\frac{1}{n} X^\\top Y$。典型相关分析 (CCA) 旨在寻找权重矩阵 $A \\in \\mathbb{R}^{p_x \\times k}$ 和 $B \\in \\mathbb{R}^{p_y \\times k}$，以使典型变量 $U = X A$ 和 $V = Y B$ 在正交性约束下，最大化 $U$ 和 $V$ 相应列之间的成对相关性。\n- 为了以数值稳定的方式计算 CCA，请使用白化和奇异值分解 (SVD)：对于给定的岭参数 $\\lambda \\ge 0$，设 $\\tilde{S}_{xx} = S_{xx} + \\lambda I_{p_x}$ 和 $\\tilde{S}_{yy} = S_{yy} + \\lambda I_{p_y}$。通过特征分解计算逆平方根 $\\tilde{S}_{xx}^{-1/2}$ 和 $\\tilde{S}_{yy}^{-1/2}$，构建 $K = \\tilde{S}_{xx}^{-1/2} S_{xy} \\tilde{S}_{yy}^{-1/2}$，并计算其 SVD $K = U \\Sigma V^\\top$。典型权重矩阵则为 $A = \\tilde{S}_{xx}^{-1/2} U$ 和 $B = \\tilde{S}_{yy}^{-1/2} V$。典型相关性由奇异值（$\\Sigma$ 的对角线）给出。\n- 对于变量重要性，使用结构系数：对于第 $r$ 个典型变量对，为 $X$ 视图中的变量 $j$ 定义 $s_{jr} = \\operatorname{corr}(X_{\\cdot j}, U_{\\cdot r})$，为 $Y$ 视图中的变量 $\\ell$ 定义 $t_{\\ell r} = \\operatorname{corr}(Y_{\\cdot \\ell}, V_{\\cdot r})$。使用等于典型相关性平方的权重，对前 $k$ 个典型对进行聚合：如果 $\\rho_r$ 是第 $r$ 个典型相关性，定义 $w_r = \\rho_r^2$，并将每个变量的重要性设为 $I^X_j = \\sum_{r=1}^k w_r \\, s_{jr}^2$ 和 $I^Y_\\ell = \\sum_{r=1}^k w_r \\, t_{\\ell r}^2$。\n- 将每个视图的重要性归一化，使其总和为一：$\\tilde{I}^X_j = I^X_j / \\sum_{j=1}^{p_x} I^X_j$ 和 $\\tilde{I}^Y_\\ell = I^Y_\\ell / \\sum_{\\ell=1}^{p_y} I^Y_\\ell$，约定如果总和为零，则归一化向量为零向量。\n- 给定通路映射 $P_X : \\{1,\\dots,p_x\\} \\to \\{0,\\dots,m-1\\}$ 和 $P_Y : \\{1,\\dots,p_y\\} \\to \\{0,\\dots,m-1\\}$，将通路 $p \\in \\{0,\\dots,m-1\\}$ 的未归一化通路得分定义为 $S_p = \\sum_{j: P_X(j)=p} \\tilde{I}^X_j + \\sum_{\\ell: P_Y(\\ell)=p} \\tilde{I}^Y_\\ell$。将通路得分在所有通路中进行归一化，使其总和为一：$\\hat{S}_p = S_p / \\sum_{q=0}^{m-1} S_q$（如果分母为零，则所有 $\\hat{S}_p = 0$）。最后，返回具有最大 $\\hat{S}_p$ 的索引 $p$（若得分相同，则选择最小的索引）。\n\n实现要求：\n1. 在计算 $S_{xx}$、$S_{yy}$ 和 $S_{xy}$ 之前，将 $X$ 和 $Y$ 的列标准化为零均值和单位方差。使用样本均值和总体标准差（为保持一致性，在方差计算中除以 $n$）。\n2. 使用上文所述的、带有岭参数 $\\lambda$ 的基于 SVD 的 CCA 过程。\n3. 按照规定计算结构系数和变量重要性，聚合到通路，并输出具有最高归一化得分的通路索引。\n\n角度单位不适用。不涉及物理单位。\n\n测试套件：\n对于下方的每个测试用例，请完全按照规定构建 $X$ 和 $Y$。所有数字均为实数标量。每个数字都必须按其书面形式处理。\n\n- 测试用例 1（理想情况，两个相关的潜在因子）：\n  - 样本量 $n = 8$，变量数 $p_x = 4$，$p_y = 3$，典型对数量 $k = 2$，岭参数 $\\lambda = 0.001$。\n  - 潜在因子和噪声：\n    - $z_1 = [-1.0,\\,-0.5,\\,0.0,\\,0.5,\\,1.0,\\,-0.8,\\,0.3,\\,0.9]$，\n      $z_2 = [0.7,\\,-1.2,\\,0.5,\\,-0.3,\\,1.1,\\,-0.4,\\,0.2,\\,-0.6]$。\n    - $e_{X0} = [0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.02,\\,0.03,\\,-0.01,\\,0.00]$，\n      $e_{X1} = [0.01,\\,-0.02,\\,0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.02,\\,0.03]$，\n      $e_{X2} = [0.05,\\,-0.04,\\,0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.02,\\,0.03]$，\n      $e_{X3} = [0.01,\\,0.00,\\,-0.01,\\,0.02,\\,-0.02,\\,0.01,\\,0.00,\\,-0.01]$。\n    - $e_{Y0} = [0.01,\\,-0.02,\\,0.00,\\,0.02,\\,-0.01,\\,0.00,\\,0.01,\\,-0.01]$，\n      $e_{Y1} = [0.02,\\,-0.01,\\,0.01,\\,-0.02,\\,0.00,\\,0.02,\\,-0.01,\\,0.00]$，\n      $e_{Y2} = [0.03,\\,-0.02,\\,0.01,\\,0.00,\\,-0.01,\\,0.02,\\,-0.02,\\,0.01]$。\n  - 通过以下方式构建 $X$（列 $X_0,\\dots,X_3$）和 $Y$（列 $Y_0,\\dots,Y_2$）：\n    - $X_0 = z_1 + 0.1 \\cdot e_{X0}$，\n      $X_1 = -0.5 \\cdot z_2 + 0.1 \\cdot e_{X1}$，\n      $X_2 = 0.1 \\cdot e_{X2}$，\n      $X_3 = 0.5 \\cdot z_1 + 0.5 \\cdot z_2 + 0.1 \\cdot e_{X3}$。\n    - $Y_0 = 0.9 \\cdot z_1 + 0.1 \\cdot e_{Y0}$，\n      $Y_1 = -0.4 \\cdot z_2 + 0.1 \\cdot e_{Y1}$，\n      $Y_2 = 0.1 \\cdot e_{Y2}$。\n  - 通路映射：\n    - $P_X = [0,\\,1,\\,2,\\,2]$ 将 $X$ 的变量 $0,1,2,3$ 映射到通路 $0,1,2,2$。\n    - $P_Y = [0,\\,1,\\,2]$ 将 $Y$ 的变量 $0,1,2$ 映射到通路 $0,1,2$。\n  - 共有 $m = 3$ 个通路，索引为 $0,1,2$。\n\n- 测试用例 2（单一主导相关性，近乎完美的配对）：\n  - $n = 6$，$p_x = 2$，$p_y = 3$，$k = 1$，$\\lambda = 0.000001$。\n  - 定义：\n    - $X_0 = [-1.0,\\,-0.6,\\,-0.2,\\,0.2,\\,0.6,\\,1.0]$，\n      $X_1 = [0.05,\\,-0.03,\\,0.02,\\,-0.01,\\,0.00,\\,-0.02]$。\n    - $Y_0 = X_0 + 0.01 \\cdot [0.1,\\,-0.2,\\,0.0,\\,0.2,\\,-0.1,\\,0.0]$，\n      $Y_1 = [0.20,\\,-0.10,\\,0.00,\\,0.10,\\,-0.05,\\,0.00]$，\n      $Y_2 = [0.03,\\,-0.02,\\,0.01,\\,0.00,\\,-0.01,\\,0.02]$。\n  - 通路映射：\n    - $P_X = [0,\\,1]$，\n    - $P_Y = [0,\\,1,\\,1]$。\n  - 共有 $m = 2$ 个通路，索引为 $0,1$。\n\n- 测试用例 3（需要岭正则化处理的共线性问题）：\n  - $n = 6$，$p_x = 3$，$p_y = 1$，$k = 1$，$\\lambda = 0.1$。\n  - 定义：\n    - $X_0 = [-1.0,\\,-0.5,\\,0.0,\\,0.5,\\,1.0,\\,1.5]$，\n      $X_1 = 2.0 \\cdot X_0 + 0.01 \\cdot [0.1,\\,-0.2,\\,0.0,\\,0.1,\\,-0.1,\\,0.0]$，\n      $X_2 = [0.05,\\,-0.04,\\,0.03,\\,-0.02,\\,0.01,\\,0.00]$。\n    - $Y_0 = X_0 + 0.05 \\cdot [0.1,\\,-0.1,\\,0.0,\\,0.1,\\,-0.1,\\,0.2]$。\n  - 通路映射：\n    - $P_X = [0,\\,1,\\,2]$，\n    - $P_Y = [0]$。\n  - 共有 $m = 3$ 个通路，索引为 $0,1,2$。\n\n输出规范：\n- 您的程序必须为测试套件中的每个测试用例实现上述过程。对于每个测试用例，计算归一化通路得分 $\\{\\hat{S}_p\\}_{p=0}^{m-1}$ 并输出具有最大 $\\hat{S}_p$ 的索引 $p$（如果有任何平局，则选择最小的索引）。\n- 最终的程序输出必须是单行，包含三个测试用例的三个索引列表，其格式必须与示例 $\\texttt{[0,1,2]}$ 完全一致，即一个由方括号括起来的、逗号分隔的列表。",
            "solution": "该问题要求实现一个多步骤分析流程，从以矩阵 $X$ 和 $Y$ 表示的两组多组学数据中，识别出最显著的生物通路。该流程涉及数据标准化、正则化典型相关分析 (CCA)、通过结构系数计算变量重要性，以及将这些重要性聚合成通路水平得分。解决方案通过系统地实现这些指定步骤来展开。\n\n### 第 1 步：数据标准化\n设输入数据矩阵为 $X \\in \\mathbb{R}^{n \\times p_x}$ 和 $Y \\in \\mathbb{R}^{n \\times p_y}$，其中 $n$ 是样本数，$p_x$ 和 $p_y$ 分别是每个视图中的变量数（例如基因和代谢物）。第一步是将每个变量（列）标准化，使其均值为 $0$，总体标准差为 $1$。对于给定的列向量 $v \\in \\mathbb{R}^n$，其样本均值为 $\\mu = \\frac{1}{n}\\sum_{i=1}^n v_i$，总体标准差为 $\\sigma = \\sqrt{\\frac{1}{n}\\sum_{i=1}^n (v_i - \\mu)^2}$，其标准化版本 $v_{std}$ 由 $v_{std, i} = (v_i - \\mu)/\\sigma$ 给出。这确保了所有变量都在可比较的尺度上，这是像 CCA 这样基于协方差的方法的先决条件。如果一个变量的标准差为零（即它是一个常数），其标准化形式是一个零向量。\n\n### 第 2 步：正则化典型相关分析 (CCA)\nCCA 旨在找到 $X$ 和 $Y$ 中变量的线性组合，使得这些线性组合之间的相关性最大化。这些线性组合构成了典型变量。该问题指定了一种数值稳定、基于 SVD 的 CCA 方法。\n\n**2a. 协方差矩阵：** 标准化后，计算样本协方差矩阵。对于标准化数据矩阵 $X_{std}$ 和 $Y_{std}$，它们是：\n$$\nS_{xx} = \\frac{1}{n} X_{std}^\\top X_{std} \\quad \\in \\mathbb{R}^{p_x \\times p_x} \\\\\nS_{yy} = \\frac{1}{n} Y_{std}^\\top Y_{std} \\quad \\in \\mathbb{R}^{p_y \\times p_y} \\\\\nS_{xy} = \\frac{1}{n} X_{std}^\\top Y_{std} \\quad \\in \\mathbb{R}^{p_x \\times p_y}\n$$\n\n**2b. 岭正则化：** 为了处理潜在的共线性并确保协方差矩阵是可逆的，将一个小的岭惩罚 $\\lambda \\ge 0$ 加到 $S_{xx}$ 和 $S_{yy}$ 的对角线上：\n$$\n\\tilde{S}_{xx} = S_{xx} + \\lambda I_{p_x} \\\\\n\\tilde{S}_{yy} = S_{yy} + \\lambda I_{p_y}\n$$\n这使得矩阵成为严格正定矩阵。\n\n**2c. 通过逆平方根进行矩阵白化：** 通过使用正则化协方差矩阵的逆平方根对数据进行“白化”变换。对于一个对称正定矩阵 $M$，其逆平方根 $M^{-1/2}$ 可以通过特征分解计算。如果 $M = Q \\Lambda Q^\\top$，其中 $Q$ 是特征向量矩阵，$\\Lambda$ 是特征值 $\\lambda_i$ 的对角矩阵，那么 $M^{-1/2} = Q \\Lambda^{-1/2} Q^\\top$，其中 $\\Lambda^{-1/2}$ 是对角线元素为 $1/\\sqrt{\\lambda_i}$ 的对角矩阵。此方法用于计算 $\\tilde{S}_{xx}^{-1/2}$ 和 $\\tilde{S}_{yy}^{-1/2}$。\n\n**2d. 核矩阵的 SVD：** 构建一个核矩阵 $K$：\n$$\nK = \\tilde{S}_{xx}^{-1/2} S_{xy} \\tilde{S}_{yy}^{-1/2}\n$$\n然后计算 $K$ 的奇异值分解 (SVD)：$K = U_{svd} \\Sigma V_{svd}^\\top$。$\\Sigma$ 对角线上的奇异值是典型相关性 $\\rho_r$。定义线性组合的典型权重矩阵 $A \\in \\mathbb{R}^{p_x \\times k}$ 和 $B \\in \\mathbb{R}^{p_y \\times k}$，可以使用奇异向量恢复：\n$$\nA = \\tilde{S}_{xx}^{-1/2} U_{svd} \\\\\nB = \\tilde{S}_{yy}^{-1/2} V_{svd}\n$$\n\n### 第 3 步：变量重要性计算\n每个原始变量的重要性使用结构系数进行评估。\n\n**3a. 典型变量和结构系数：** 前 $k$ 个分量的典型变量是 $U = X_{std} A_{\\cdot, 1:k}$ 和 $V = Y_{std} B_{\\cdot, 1:k}$。对于 $X$ 视图中的第 $j$ 个变量和第 $r$ 个典型变量对，结构系数定义为它们的皮尔逊相关系数：$s_{jr} = \\operatorname{corr}(X_{std, \\cdot j}, U_{\\cdot r})$。类似地，对于 $Y$ 视图，$t_{\\ell r} = \\operatorname{corr}(Y_{std, \\cdot \\ell}, V_{\\cdot r})$。由于 $X_{std}$ 和 $Y_{std}$ 的列具有单位方差和零均值，并且典型变量 $U$ 和 $V$ 也具有零均值，相关性公式简化为 $\\operatorname{corr}(X_{std, \\cdot j}, U_{\\cdot r}) = \\operatorname{cov}(X_{std, \\cdot j}, U_{\\cdot r}) / \\sigma_{U_{\\cdot r}}$。\n\n**3b. 聚合和归一化的重要性：** 每个变量的重要性通过对前 $k$ 个典型分量进行加权聚合，权重为典型相关性的平方，$w_r = \\rho_r^2$。\n$$\nI^X_j = \\sum_{r=1}^k w_r \\, s_{jr}^2 \\quad \\text{和} \\quad I^Y_\\ell = \\sum_{r=1}^k w_r \\, t_{\\ell r}^2\n$$\n然后，这些原始重要性得分在每个视图内部进行归一化，使其总和为一，得到 $\\tilde{I}^X_j$ 和 $\\tilde{I}^Y_\\ell$。如果一个视图的总重要性为零，则其所有归一化得分都为零。\n\n### 第 4 步：通路得分聚合\n使用预定义的集合将变量级别的重要性映射到通路级别的得分。\n\n**4a. 未归一化的通路得分：** 给定从变量到 $m$ 个通路之一的映射 $P_X$ 和 $P_Y$，通路 $p$ 的得分是属于该通路的所有变量的归一化重要性之和：\n$$\nS_p = \\sum_{j: P_X(j)=p} \\tilde{I}^X_j + \\sum_{\\ell: P_Y(\\ell)=p} \\tilde{I}^Y_\\ell\n$$\n\n**4b. 归一化的通路得分：** 然后将这些得分在所有通路中进行归一化，使其总和为一，从而在通路上创建一个最终的概率分布：\n$$\n\\hat{S}_p = S_p / \\sum_{q=0}^{m-1} S_q\n$$\n\n### 第 5 步：最终选择\n最终结果是具有最高归一化得分 $\\hat{S}_p$ 的通路的从零开始的索引。平局通过选择最小的索引来解决，这是标准 `argmax` 函数的固有行为。此过程独立应用于提供的每个测试用例。",
            "answer": "[0,0,0]"
        }
    ]
}