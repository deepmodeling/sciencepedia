{
    "hands_on_practices": [
        {
            "introduction": "掌握流行病学建模的核心在于分析其长期行为。一个关键问题是：在什么条件下，疾病会在人群中持续存在？这个练习将指导你推导一个包含出生和死亡动态的SIR模型的地方性平衡点。通过这项实践，你将掌握求解模型稳态的核心技能，并理解如何用基本再生数 $R_0$ 来解释这些平衡点的存在与特征。",
            "id": "4355270",
            "problem": "考虑一个带有生命动态的房室易感-感染-恢复 (SIR) 模型，该模型代表了一个宿主种群，其中康复的个体获得了持久的适应性免疫。令 $S(t)$、$I(t)$ 和 $R(t)$ 分别表示易感、感染和康复个体的数量，并令 $N(t)=S(t)+I(t)+R(t)$ 表示总人口。假设传播是频率依赖性的，人均出生和死亡率为恒定速率 $\\mu$，传播参数为 $\\beta$，恢复率为 $\\gamma$。在人口统计学平衡状态下，假设 $N(t)$ 是恒定的，并将此常数表示为 $N$。该模型由以下系统给出\n$$\n\\frac{dS}{dt}=\\mu N - \\frac{\\beta S I}{N} - \\mu S,\\quad\n\\frac{dI}{dt}=\\frac{\\beta S I}{N} - (\\gamma+\\mu) I,\\quad\n\\frac{dR}{dt}=\\gamma I - \\mu R.\n$$\n利用流量平衡、疾病以速率 $\\beta$ 按易感者比例传播以及感染者以速率 $\\gamma+\\mu$ 被移除这些基本事实，推导 $I^{*}0$ 的地方性平衡点 $(S^{*},I^{*},R^{*})$。令 $R_{0}$ 表示基本再生数，其定义为一个典型的感染宿主被引入一个完全易感的种群中所引起的预期二次感染数。假设 $R_{0}1$，以便地方性平衡点可以存在。从第一性原理出发，用 $R_{0}$ 和 $N$ 来表示 $S^{*}$，并仅报告 $S^{*}$ 的最终符号表达式。将 $S^{*}$ 表示为个体数量。不要四舍五入；请提供一个精确的封闭形式表达式。",
            "solution": "该问题是适定的、有科学依据且客观的，满足所有有效性标准。它提出了一个带有生命动态的标准易感-感染-恢复 (SIR) 模型，并要求推导地方性平衡点处的易感种群规模。\n\n描述该模型的常微分方程组为：\n$$\n\\frac{dS}{dt} = \\mu N - \\frac{\\beta S I}{N} - \\mu S \\\\\n\\frac{dI}{dt} = \\frac{\\beta S I}{N} - (\\gamma+\\mu) I \\\\\n\\frac{dR}{dt} = \\gamma I - \\mu R\n$$\n此处，$S(t)$、$I(t)$ 和 $R(t)$ 分别是易感、感染和康复个体的数量。总人口为 $N = S+I+R$，在人口统计学平衡状态下假定为常数。参数包括人均出生/死亡率 $\\mu$、传播参数 $\\beta$ 和恢复率 $\\gamma$。\n\n目标是找到地方性平衡点处的易感种群 $S^*$ 关于总人口 $N$ 和基本再生数 $R_0$ 的表达式。地方性平衡点是一个稳态 $(S^*, I^*, R^*)$，此时疾病在种群中持续存在，数学上意味着 $I^*  0$。在任何平衡点，所有种群的变化率都为零（流量平衡原则）。\n$$\n\\frac{dS}{dt} = 0, \\quad \\frac{dI}{dt} = 0, \\quad \\frac{dR}{dt} = 0\n$$\n\n首先，我们必须推导基本再生数 $R_0$ 的表达式。根据问题中的定义，$R_0$ 是指将单个感染者引入一个完全易感的种群中所引起的预期二次感染数。\n在一个完全易感的种群中，$S(t) \\approx N$。一个普通感染者引起新感染的速率由项 $\\frac{\\beta S}{N}$ 给出。当 $S=N$ 时，该速率变为 $\\frac{\\beta N}{N} = \\beta$。\n个体从感染类 $I$ 中移除，或是通过康复（速率为 $\\gamma$），或是通过死亡（速率为 $\\mu$）。因此，个体的总移除率为 $\\gamma+\\mu$。感染期的预期持续时间是该速率的倒数，即 $\\frac{1}{\\gamma+\\mu}$。\n基本再生数是感染率和感染持续时间的乘积：\n$$\nR_0 = (\\text{感染率}) \\times (\\text{感染持续时间}) = \\beta \\times \\frac{1}{\\gamma+\\mu} = \\frac{\\beta}{\\gamma+\\mu}\n$$\n问题陈述我们假设 $R_0  1$，这是地方性平衡点存在的必要条件。\n\n接下来，我们求解地方性平衡值 $S^*$。我们使用感染类的平衡条件 $\\frac{dI}{dt} = 0$：\n$$\n\\frac{\\beta S^* I^*}{N} - (\\gamma+\\mu) I^* = 0\n$$\n我们可以提取公因子 $I^*$：\n$$\nI^* \\left( \\frac{\\beta S^*}{N} - (\\gamma+\\mu) \\right) = 0\n$$\n这个方程有两个可能的解。一个是 $I^*=0$，对应于无病平衡点。另一个解定义了地方性平衡点，通过将括号中的项设为零得到，因为我们已知 $I^*  0$。\n$$\n\\frac{\\beta S^*}{N} - (\\gamma+\\mu) = 0\n$$\n求解 $S^*$，我们得到：\n$$\n\\frac{\\beta S^*}{N} = \\gamma+\\mu\n$$\n$$\nS^* = \\frac{N(\\gamma+\\mu)}{\\beta}\n$$\n这个表达式用模型参数给出了 $S^*$。最后一步是用 $R_0$ 和 $N$ 来表示 $S^*$。根据我们对 $R_0$ 的推导，我们有：\n$$\nR_0 = \\frac{\\beta}{\\gamma+\\mu}\n$$\n对此表达式取倒数，得到：\n$$\n\\frac{1}{R_0} = \\frac{\\gamma+\\mu}{\\beta}\n$$\n我们可以将此直接代入我们关于 $S^*$ 的表达式中：\n$$\nS^* = N \\left( \\frac{\\gamma+\\mu}{\\beta} \\right) = N \\left( \\frac{1}{R_0} \\right)\n$$\n因此，地方性平衡点处的易感个体数量为：\n$$\nS^* = \\frac{N}{R_0}\n$$\n这是理论流行病学中的一个经典结果。它表明，要使疾病保持地方性流行，易感人群在总人口中的比例必须等于基本再生数的倒数。",
            "answer": "$$\\boxed{\\frac{N}{R_{0}}}$$"
        },
        {
            "introduction": "在构建模型之后，一个至关重要的问题随之而来：我们能否从可观测数据中唯一地确定模型的参数？这个问题引出了结构可辨识性的概念，它是连接理论模型与现实世界数据的桥梁。这项练习提供了一种严谨的方法，通过对模型微分方程的代数变换，来评估模型参数是否可以从理想化的输出数据中被唯一确定。",
            "id": "4355225",
            "problem": "考虑经典的易感-感染-康复 (SIR) 仓室模型，由以下常微分方程组 (ODEs) 定义\n$$\n\\frac{dS}{dt} = -\\beta S I,\\quad \\frac{dI}{dt} = \\beta S I - \\gamma I,\\quad \\frac{dR}{dt} = \\gamma I,\n$$\n其中 $S(t)$、$I(t)$ 和 $R(t)$ 分别表示在时间 $t$ 的易感人群、感染人群和康复人群，$\\beta$ 和 $\\gamma$ 是未知的正常数参数，分别代表传播率和恢复率。假设在 $t \\in [0,T]$ 上可以完美且连续地观测到 $I(t)$，其中 $I(t)$ 在 $[0,T]$ 上二阶连续可微且不恒为零。\n\n针对具有无噪声连续时间输出的确定性ODE模型中的参数，给出结构可辨识性的精确定义。然后，从SIR ODEs和唯一的观测值 $I(t)$ 出发，消除未观测到的仓室 $S(t)$ 和 $R(t)$，以推导出一个仅涉及 $I(t)$、其时间导数以及参数 $\\beta$ 和 $\\gamma$ 的输入-输出关系。使用此关系，评估仅从 $I(t)$ 是否可以结构性地辨识 $\\beta$ 和 $\\gamma$。如果可以，推导出 $\\gamma$ 的一个闭式解析表达式，该表达式用 $I(t)$、$\\frac{dI}{dt}(t)$ 和 $\\frac{d^{2}I}{dt^{2}}(t)$ 在两个不同时间点 $t_{1}, t_{2} \\in (0,T)$ 的值表示，且在这两个时间点上，您推导的表达式是良定义的（即不会发生除以零的情况）。将您的最终答案表示为 $\\gamma$ 关于 $I(t_{1})$、$I(t_{2})$、$\\frac{dI}{dt}(t_{1})$、$\\frac{dI}{dt}(t_{2})$、$\\frac{d^{2}I}{dt^{2}}(t_{1})$ 和 $\\frac{d^{2}I}{dt^{2}}(t_{2})$ 的单个解析表达式。不需要数值近似。",
            "solution": "**1. 结构可辨识性的定义**\n\n在确定性ODE模型 $\\frac{d\\mathbf{x}}{dt} = f(\\mathbf{x}, \\mathbf{u}, \\boldsymbol{\\theta})$ 的背景下，其观测输出为 $\\mathbf{y} = g(\\mathbf{x}, \\mathbf{u}, \\boldsymbol{\\theta})$，其中 $\\mathbf{x}$ 是状态向量，$\\mathbf{u}$ 是输入向量，$\\boldsymbol{\\theta}$ 是参数向量，$\\mathbf{y}$ 是输出向量。如果对于任意两个容许的参数向量 $\\boldsymbol{\\theta}$ 和 $\\boldsymbol{\\theta}^*$，条件 $\\mathbf{y}(t, \\boldsymbol{\\theta}) = \\mathbf{y}(t, \\boldsymbol{\\theta}^*)$ (对于观测区间内的所有 $t$) 能够推出 $\\theta_i = \\theta_i^*$，则称参数 $\\theta_i$ 是**结构上全局可辨识的**。如果模型的所有参数都是结构可辨识的，则整个模型是结构可辨识的。此分析假设对输出 $\\mathbf{y}(t)$ 的观测是完美的、无噪声的，并且模型结构是精确的。\n\n**2. 输入-输出关系的推导**\n\n目标是通过消除未观测到的状态 $S(t)$ 和 $R(t)$，找到一个仅涉及观测变量 $I(t)$、其导数以及参数 $\\beta$ 和 $\\gamma$ 的微分方程。状态 $R(t)$ 未出现在 $S(t)$ 和 $I(t)$ 的方程中，因此我们只需要消除 $S(t)$。\n\n从第二个ODE，我们有：\n$$\n\\frac{dI}{dt} = \\beta S I - \\gamma I\n$$\n由于 $I(t)$ 不恒为零，在 $[0,T]$ 内存在一个开区间，其中 $I(t)  0$。在这样的区间上，我们可以除以 $I$：\n$$\n\\frac{1}{I}\\frac{dI}{dt} = \\beta S - \\gamma\n$$\n我们可以重新整理这个方程，用可观测的 $I(t)$ 及其导数，以及参数 $\\gamma$ 来表示 $\\beta S$ 项：\n$$\n\\beta S = \\frac{1}{I}\\frac{dI}{dt} + \\gamma\n$$\n现在，我们将这个表达式对时间 $t$ 求导。左边变为 $\\beta \\frac{dS}{dt}$，右边使用商法则求导：\n$$\n\\beta \\frac{dS}{dt} = \\frac{d}{dt} \\left( \\frac{1}{I}\\frac{dI}{dt} + \\gamma \\right) = \\frac{\\frac{d^2I}{dt^2}I - \\left(\\frac{dI}{dt}\\right)^2}{I^2}\n$$\n根据SIR模型的第一个ODE，我们有 $\\frac{dS}{dt} = -\\beta S I$。将此代入上述方程的左边得到：\n$$\n\\beta(-\\beta S I) = -(\\beta S)(\\beta I) = \\frac{I\\frac{d^2I}{dt^2} - \\left(\\frac{dI}{dt}\\right)^2}{I^2}\n$$\n现在，我们代入之前推导出的 $\\beta S$ 的表达式：\n$$\n-\\left(\\frac{1}{I}\\frac{dI}{dt} + \\gamma\\right)(\\beta I) = \\frac{I\\frac{d^2I}{dt^2} - \\left(\\frac{dI}{dt}\\right)^2}{I^2}\n$$\n简化左侧：\n$$\n-\\beta \\left(\\frac{dI}{dt} + \\gamma I\\right) = \\frac{I\\frac{d^2I}{dt^2} - \\left(\\frac{dI}{dt}\\right)^2}{I^2}\n$$\n这个方程就是所求的输入-输出关系，因为它只涉及可观测的 $I(t)$、其导数 $\\frac{dI}{dt}$ 和 $\\frac{d^2I}{dt^2}$，以及参数 $\\beta$ 和 $\\gamma$。为方便起见，我们定义 $I' \\equiv \\frac{dI}{dt}$ 和 $I'' \\equiv \\frac{d^2I}{dt^2}$：\n$$\n\\beta(I' + \\gamma I) = \\frac{(I')^2 - I I''}{I^2} = \\left(\\frac{I'}{I}\\right)^2 - \\frac{I''}{I}\n$$\n\n**3. 结构可辨识性评估**\n\n我们定义函数 $Z(t) = \\left(\\frac{I'(t)}{I(t)}\\right)^2 - \\frac{I''(t)}{I(t)}$，由于 $I(t)$ 及其导数被完美观测，因此 $Z(t)$ 是已知的。输入-输出关系为：\n$$\n\\beta I'(t) + \\beta\\gamma I(t) = Z(t)\n$$\n这是一个关于参数组合 $c_1 = \\beta$ 和 $c_2 = \\beta\\gamma$ 的线性单代数方程。为了唯一确定两个未知数，我们需要两个独立的方程。我们可以通过在两个表达式良定义的不同时间点 $t_1$ 和 $t_2$ 对该关系进行求值来生成这两个方程：\n$$\n\\beta I'(t_1) + \\beta\\gamma I(t_1) = Z(t_1) \\\\\n\\beta I'(t_2) + \\beta\\gamma I(t_2) = Z(t_2)\n$$\n这是一个关于 $(\\beta, \\beta\\gamma)$ 的线性系统：\n$$\n\\begin{pmatrix} I'(t_1)  I(t_1) \\\\ I'(t_2)  I(t_2) \\end{pmatrix} \\begin{pmatrix} \\beta \\\\ \\beta\\gamma \\end{pmatrix} = \\begin{pmatrix} Z(t_1) \\\\ Z(t_2) \\end{pmatrix}\n$$\n当且仅当系数矩阵的行列式不为零时，$(\\beta, \\beta\\gamma)$ 存在唯一解：\n$$\n\\det \\begin{pmatrix} I'(t_1)  I(t_1) \\\\ I'(t_2)  I(t_2) \\end{pmatrix} = I'(t_1)I(t_2) - I'(t_2)I(t_1) \\neq 0\n$$\n这个条件等价于 $\\frac{I'(t_1)}{I(t_1)} \\neq \\frac{I'(t_2)}{I(t_2)}$，意味着 $I(t)$ 的对数导数不是常数。对于一个非简单的指数函数的非平凡流行病轨迹，这个条件通常是成立的。假设可以找到这样的 $t_1$ 和 $t_2$，我们就可以唯一地解出 $\\beta$ 和 $\\beta\\gamma$。由于给定 $\\beta  0$，我们接着可以唯一地确定 $\\gamma = (\\beta\\gamma)/\\beta$。因此，参数 $\\beta$ 和 $\\gamma$ 都可以从对 $I(t)$ 的无噪声连续观测中被结构性地辨识。\n\n**4. $\\gamma$ 表达式的推导**\n\n我们求解关于 $\\beta$ 和 $\\beta\\gamma$ 的线性系统。使用克莱姆法则，令 $c_1 = \\beta$ 和 $c_2 = \\beta\\gamma$。解是：\n$$\nc_1 = \\beta = \\frac{\\det \\begin{pmatrix} Z(t_1)  I(t_1) \\\\ Z(t_2)  I(t_2) \\end{pmatrix}}{\\det \\begin{pmatrix} I'(t_1)  I(t_1) \\\\ I'(t_2)  I(t_2) \\end{pmatrix}} = \\frac{Z(t_1)I(t_2) - Z(t_2)I(t_1)}{I'(t_1)I(t_2) - I'(t_2)I(t_1)}\n$$\n$$\nc_2 = \\beta\\gamma = \\frac{\\det \\begin{pmatrix} I'(t_1)  Z(t_1) \\\\ I'(t_2)  Z(t_2) \\end{pmatrix}}{\\det \\begin{pmatrix} I'(t_1)  I(t_1) \\\\ I'(t_2)  I(t_2) \\end{pmatrix}} = \\frac{I'(t_1)Z(t_2) - I'(t_2)Z(t_1)}{I'(t_1)I(t_2) - I'(t_2)I(t_1)}\n$$\n参数 $\\gamma$ 是 $c_2/c_1$ 的比值：\n$$\n\\gamma = \\frac{c_2}{c_1} = \\frac{I'(t_1)Z(t_2) - I'(t_2)Z(t_1)}{Z(t_1)I(t_2) - Z(t_2)I(t_1)}\n$$\n问题要求用 $I$、$I'$ 和 $I''$ 表示表达式。我们代入 $Z(t) = \\frac{(I'(t))^2 - I(t)I''(t)}{I(t)^2}$。为简洁起见，令 $I_k \\equiv I(t_k)$，$I'_k \\equiv \\frac{dI}{dt}(t_k)$，以及 $I''_k \\equiv \\frac{d^2I}{dt^2}(t_k)$。\n因此，$Z_k = \\frac{(I'_k)^2 - I_k I''_k}{I_k^2}$。\n\n$\\gamma$ 的分子是 $N_{\\gamma} = I'_1 Z_2 - I'_2 Z_1$：\n$$\nN_{\\gamma} = I'_1 \\left( \\frac{(I'_2)^2 - I_2 I''_2}{I_2^2} \\right) - I'_2 \\left( \\frac{(I'_1)^2 - I_1 I''_1}{I_1^2} \\right) = \\frac{I_1^2 I'_1 ((I'_2)^2 - I_2 I''_2) - I_2^2 I'_2 ((I'_1)^2 - I_1 I''_1)}{I_1^2 I_2^2}\n$$\n$\\gamma$ 的分母是 $D_{\\gamma} = Z_1 I_2 - Z_2 I_1$：\n$$\nD_{\\gamma} = \\left( \\frac{(I'_1)^2 - I_1 I''_1}{I_1^2} \\right) I_2 - \\left( \\frac{(I'_2)^2 - I_2 I''_2}{I_2^2} \\right) I_1 = \\frac{I_2 I_1^2 ((I'_1)^2 - I_1 I''_1) - I_1 I_2^2 ((I'_2)^2 - I_2 I''_2)}{I_1^2 I_2^2}\n$$\n等等，分母的推导有误。\n$D_{\\gamma} = Z_1 I_2 - Z_2 I_1 = \\frac{(I'_1)^2 - I_1 I''_1}{I_1^2} I_2 - \\frac{(I'_2)^2 - I_2 I''_2}{I_2^2} I_1$.\n要通分，分母是 $I_1^2 I_2^2$。\n$D_{\\gamma} = \\frac{I_2^2 ((I'_1)^2 - I_1 I''_1) I_2 - I_1^2 ((I'_2)^2 - I_2 I''_2) I_1}{I_1^2 I_2^2} = \\frac{I_2^3 ((I'_1)^2 - I_1 I''_1) - I_1^3 ((I'_2)^2 - I_2 I''_2)}{I_1^2 I_2^2}$.\n是的，原文推导是正确的。\n分子和分母表达式中的公因子 $(I_1^2 I_2^2)^{-1}$ 会消掉。因此，我们有：\n$$\n\\gamma = \\frac{N_{\\gamma}}{D_{\\gamma}} = \\frac{I_1^2 I'_1 ((I'_2)^2 - I_2 I''_2) - I_2^2 I'_2 ((I'_1)^2 - I_1 I''_1)}{I_2^3 ((I'_1)^2 - I_1 I''_1) - I_1^3 ((I'_2)^2 - I_2 I''_2)}\n$$\n这就是用所需量表示的 $\\gamma$ 的闭式解析表达式。只要分母不为零，此表达式就是良定义的，这与方程组为 $\\beta$ 和 $\\gamma$ 产生唯一、非平凡解的条件有关。用问题陈述中的符号重新表示，即可得到最终答案。",
            "answer": "$$\n\\boxed{\\frac{I(t_1)^2 \\frac{dI}{dt}(t_1) \\left(\\left(\\frac{dI}{dt}(t_2)\\right)^2 - I(t_2) \\frac{d^{2}I}{dt^{2}}(t_2)\\right) - I(t_2)^2 \\frac{dI}{dt}(t_2) \\left(\\left(\\frac{dI}{dt}(t_1)\\right)^2 - I(t_1) \\frac{d^{2}I}{dt^{2}}(t_1)\\right)}{I(t_2)^3 \\left(\\left(\\frac{dI}{dt}(t_1)\\right)^2 - I(t_1) \\frac{d^{2}I}{dt^{2}}(t_1)\\right) - I(t_1)^3 \\left(\\left(\\frac{dI}{dt}(t_2)\\right)^2 - I(t_2) \\frac{d^{2}I}{dt^{2}}(t_2)\\right)}}\n$$"
        },
        {
            "introduction": "真实世界的免疫和流行病学系统往往比简单的SIR模型复杂得多，常常涉及多种病原株的相互作用，并可能产生非线性的动态行为。本练习将引导你进入计算建模的世界，探索一个包含交叉保护和协同感染的双菌株模型，这种复杂性可能导致“双稳态”现象的出现。这项计算实践要求你实现一个常微分方程模型，并通过数值模拟进行分岔分析，这是现代系统生物学研究中探索复杂系统行为的基石。",
            "id": "4355220",
            "problem": "考虑一个宿主种群，该种群由一个包含协同感染（Co-Infection）和交叉保护（Cross-Protection）的双品系易感-感染-易感（SIS）框架建模，各品系仅通过质量作用传播和种群守恒耦合。设仓室为：易感者$s$、品系$1$单一感染者$x_1$、品系$2$单一感染者$x_2$以及协同感染者$x_{12}$。假设总人口恒定并归一化为$1$，因此$s + x_1 + x_2 + x_{12} = 1$。传播遵循质量作用发生率，恢复是线性的，协同感染会改变传播能力，交叉保护会降低二次感染的速率。其控制性常微分方程（ODE）如下：\n$$\n\\begin{aligned}\n\\lambda_1 = \\beta \\left(x_1 + \\sigma \\, x_{12}\\right), \\\\\n\\lambda_2 = \\beta \\left(x_2 + \\sigma \\, x_{12}\\right), \\\\\n\\frac{dx_1}{dt} = \\lambda_1 \\, s - \\gamma \\, x_1 - (1 - c)\\,\\lambda_2 \\, x_1, \\\\\n\\frac{dx_2}{dt} = \\lambda_2 \\, s - \\gamma \\, x_2 - (1 - c)\\,\\lambda_1 \\, x_2, \\\\\n\\frac{dx_{12}}{dt} = (1 - c)\\,\\big(\\lambda_2 \\, x_1 + \\lambda_1 \\, x_2\\big) - \\gamma_{12} \\, x_{12},\n\\end{aligned}\n$$\n其中$s = 1 - x_1 - x_2 - x_{12}$，参数包括$\\beta$（传播率，单位：天$^{-1}$）、$\\gamma$（单一感染恢复率，单位：天$^{-1}$）、$\\gamma_{12}$（协同感染恢复率，单位：天$^{-1}$）、$\\sigma$（协同感染传播增效，无量纲）和$c$（交叉保护强度，无量纲，其中$c \\in [0,1]$）。质量作用发生率和线性恢复是基本基础，而守恒定律$s + x_1 + x_2 + x_{12} = 1$确保了生物学上的可行性。\n\n将双稳态定义为至少两个渐近稳定平衡点的共存，使得无病平衡点（其中$x_1 + x_2 + x_{12} \\approx 0$）和正的流行病平衡点（其中$x_1 + x_2 + x_{12}  0$）在相同的参数值下均为局部稳定。在数值上，对于一个固定的$(\\sigma,c)$对，如果ODE系统的两次模拟（使用不同的初始条件）收敛到不同的渐近总感染水平$x_1 + x_2 + x_{12}$，且两者之差至少为阈值$\\varepsilon = 10^{-3}$，其中一个轨迹接近零总感染（低于$\\varepsilon$），另一个轨迹接近一个严格为正的水平（高于$\\varepsilon$），则声明存在双稳态。使用两种确定性初始状态：一个低感染初始条件$x_1(0) = 10^{-6}$，$x_2(0) = 0$，$x_{12}(0) = 0$，和一个高感染初始条件$x_{12}(0) = 0.4$，$x_1(0) = 0.1$，$x_2(0) = 0.1$，其中$s(0)$由守恒定律计算得出。\n\n通过在指定范围内均匀网格上扫描$\\sigma$和$c$来进行分岔分析，并对每一对参数使用上述标准评估是否存在双稳态。对于下方的每个测试用例，计算检测到双稳态的网格点$(\\sigma,c)$的比例（以小数表示）。所有输出均为无量纲小数；不要包含百分号。\n\n使用以下测试套件，其中速率单位明确为天$^{-1}$，模拟时间单位为天：\n\n- 测试用例$1$（顺利情况，由于强协同感染增效和慢协同感染恢复，预期出现向后分岔）：$\\beta = 0.95$，$\\gamma = 1.0$，$\\gamma_{12} = 0.5$，$\\sigma \\in [2.5,4.0]$，$c \\in [0.0,0.4]$，网格分辨率$9 \\times 9$，时间范围$T = 500$天。\n- 测试用例$2$（边界区域，协同感染增效较弱且协同感染恢复较快）：$\\beta = 0.98$，$\\gamma = 1.0$，$\\gamma_{12} = 0.8$，$\\sigma \\in [1.5,2.5]$，$c \\in [0.2,0.6]$，网格分辨率$9 \\times 9$，时间范围$T = 500$天。\n- 测试用例$3$（单稳态流行病，传播率高且无协同感染优势）：$\\beta = 1.3$，$\\gamma = 1.0$，$\\gamma_{12} = 1.0$，$\\sigma \\in [1.0,1.2]$，$c \\in [0.4,0.8]$，网格分辨率$9 \\times 9$，时间范围$T = 300$天。\n\n您的程序必须：\n- 实现所述的ODE模型。\n- 对每个测试用例，在指定的$\\sigma$和$c$范围内，以给定的分辨率构建一个均匀网格。\n- 对每个$(\\sigma,c)$对，使用指定的初始条件运行两次模拟，直到给定的时间$T$，并使用阈值$\\varepsilon = 10^{-3}$判断是否出现双稳态。\n- 对每个测试用例，计算存在双稳态的网格点所占的比例，四舍五入到三位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如$[r_1,r_2,r_3]$，其中每个$r_i$是对应测试用例的十进制比例，四舍五入到三位小数。",
            "solution": "该问题描述了一个双品系易感-感染-易感（SIS）模型，其仓室包括易感者（$s$）、品系1单一感染者（$x_1$）、品系2单一感染者（$x_2$）和协同感染者（$x_{12}$）。总人口是守恒的，并归一化为1，因此在所有时间$t \\ge 0$，$s(t) + x_1(t) + x_2(t) + x_{12}(t) = 1$。其动态由一个包含三个自治常微分方程的系统控制，分别对应于受感染仓室$x_1$、$x_2$和$x_{12}$，而易感仓室$s$则通过代数关系确定。\n\n该常微分方程系统如下：\n$$\n\\begin{aligned}\n\\frac{dx_1}{dt} = \\lambda_1 s - \\gamma x_1 - (1 - c)\\lambda_2 x_1 \\\\\n\\frac{dx_2}{dt} = \\lambda_2 s - \\gamma x_2 - (1 - c)\\lambda_1 x_2 \\\\\n\\frac{dx_{12}}{dt} = (1 - c)(\\lambda_2 x_1 + \\lambda_1 x_2) - \\gamma_{12} x_{12}\n\\end{aligned}\n$$\n其中感染力为$\\lambda_1 = \\beta (x_1 + \\sigma x_{12})$和$\\lambda_2 = \\beta (x_2 + \\sigma x_{12})$，易感者比例为$s = 1 - x_1 - x_2 - x_{12}$。参数$\\beta, \\gamma, \\gamma_{12}, \\sigma, c$分别代表传播率、单一感染恢复率、协同感染恢复率、协同感染传播乘子和交叉保护强度。\n\n核心任务是通过在三个不同的测试用例中，在一个均匀网格上扫描参数$\\sigma$和$c$来进行分岔分析。对于网格上的每个点$(\\sigma, c)$，我们必须确定系统是否表现出双稳态。问题为双稳态提供了一个精确的数值定义：如果从两个不同初始条件开始的模拟收敛到不同的渐近状态，其中一个状态是总感染接近零的无病平衡点（DFE），另一个是具有显著感染水平的流行病平衡点，则系统是双稳态的。\n\n指定的两个初始条件是：\n1.  **低感染初始条件**：$x_1(0) = 10^{-6}, x_2(0) = 0, x_{12}(0) = 0$。这代表将少量品系1引入一个完全易感的种群。\n2.  **高感染初始条件**：$x_1(0) = 0.1, x_2(0) = 0.1, x_{12}(0) = 0.4$。这代表一个已有大部分人口被感染的状态。\n\n在给定的$(\\sigma, c)$对下，双稳态的数值判据是：在最终模拟时间$T$，来自两次模拟的总感染水平$I_{\\text{total}} = x_1 + x_2 + x_{12}$（分别表示为$I_{\\text{low}}$和$I_{\\text{high}}$）满足以下条件：\n1.  最终状态的差值至少为$\\varepsilon = 10^{-3}$：$|I_{\\text{high}} - I_{\\text{low}}| \\ge \\varepsilon$。\n2.  一个轨迹收敛到接近零的感染水平：例如，$I_{\\text{low}}  \\varepsilon$。\n3.  另一个轨迹收敛到一个严格为正的水平：例如，$I_{\\text{high}} \\ge \\varepsilon$。\n\n根据此类流行病学模型的性质，当无病平衡点对小扰动稳定，但足够大的扰动能将系统推向一个稳定的流行病平衡点时，就会出现双稳态情景（特别是向后分岔）。这对应于低感染初始条件的模拟收敛到接近零的状态，而高感染初始条件的模拟收敛到正的流行病状态的情况。因此，这些条件可以实现为：$I_{\\text{low}}  \\varepsilon$ 并且 $(I_{\\text{high}} - I_{\\text{low}}) \\ge \\varepsilon$。这个公式是鲁棒的，因为第二部分 $(I_{\\text{high}} - I_{\\text{low}}) \\ge \\varepsilon$ 暗示了$I_{\\text{high}} \\ge \\varepsilon$（因为$I_{\\text{low}}  0$）并且两个状态有足够的差异。\n\n解决方案按以下步骤进行：\n1.  根据ODE系统定义一个计算状态变量$(x_1, x_2, x_{12})$导数的函数。该函数将作为数值ODE求解器的输入。\n2.  遍历问题陈述中提供的三个测试用例。\n3.  对每个测试用例，使用指定的范围和分辨率生成一个均匀的$(\\sigma, c)$值网格。\n4.  对于网格上的每个$(\\sigma, c)$对：\n    a. 使用鲁棒的求解器（如`scipy.integrate.solve_ivp`）从$t=0$到指定的时间范围$T$对ODE系统进行数值积分。此操作执行两次：一次用于低感染初始条件，一次用于高感染初始条件。为优化性能，求解器被配置为仅返回最终时间点$t=T$的解。\n    b. 从两次模拟的最终状态计算总感染水平$I_{\\text{low}}$和$I_{\\text{high}}$。\n    c. 应用双稳态判据：如果$I_{\\text{low}}  10^{-3}$且$(I_{\\text{high}} - I_{\\text{low}}) \\ge 10^{-3}$，则该点计为双稳态。\n5.  在扫描完一个测试用例的整个网格后，通过将双稳态点的计数除以网格中的总点数来计算双稳态点的比例。\n6.  收集所有三个测试用例的结果比例，将它们四舍五入到三位小数，并以方括号内的逗号分隔列表格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the two-strain SIS model problem by scanning parameter space\n    to find regions of bistability.\n    \"\"\"\n\n    def ode_system(t, y, beta, gamma, gamma12, sigma, c):\n        \"\"\"\n        Defines the system of Ordinary Differential Equations for the SIS model.\n        \n        Args:\n            t (float): Time.\n            y (np.ndarray): State vector [x1, x2, x12].\n            beta (float): Transmission rate.\n            gamma (float): Recovery rate for single infection.\n            gamma12 (float): Recovery rate for co-infection.\n            sigma (float): Co-infection transmissibility synergy.\n            c (float): Cross-protection strength.\n\n        Returns:\n            list[float]: The derivatives [dx1/dt, dx2/dt, dx12/dt].\n        \"\"\"\n        x1, x2, x12 = y[0], y[1], y[2]\n\n        # Enforce non-negativity for physical realism, as numerical errors\n        # can lead to small negative values.\n        x1 = max(0.0, x1)\n        x2 = max(0.0, x2)\n        x12 = max(0.0, x12)\n        \n        s = 1.0 - (x1 + x2 + x12)\n        s = max(0.0, s)\n\n        lambda1 = beta * (x1 + sigma * x12)\n        lambda2 = beta * (x2 + sigma * x12)\n        \n        dx1_dt = lambda1 * s - gamma * x1 - (1.0 - c) * lambda2 * x1\n        dx2_dt = lambda2 * s - gamma * x2 - (1.0 - c) * lambda1 * x2\n        dx12_dt = (1.0 - c) * (lambda2 * x1 + lambda1 * x2) - gamma12 * x12\n        \n        return [dx1_dt, dx2_dt, dx12_dt]\n\n    def check_bistability(params):\n        \"\"\"\n        Runs two simulations for a given parameter set to check for bistability.\n\n        Args:\n            params (tuple): A tuple of parameters (beta, gamma, gamma12, sigma, c, T).\n        \n        Returns:\n            bool: True if bistability is detected, False otherwise.\n        \"\"\"\n        beta, gamma, gamma12, sigma, c, T = params\n        \n        epsilon = 1e-3\n        t_span = [0, T]\n        ode_args = (beta, gamma, gamma12, sigma, c)\n\n        # 1. Low-infection initial condition\n        y0_low = [1e-6, 0.0, 0.0]\n        sol_low = solve_ivp(\n            fun=ode_system, t_span=t_span, y0=y0_low, args=ode_args,\n            method='RK45', t_eval=[T]\n        )\n        if not sol_low.success: return False\n        I_total_low = np.sum(sol_low.y[:, -1])\n\n        # 2. High-infection initial condition\n        y0_high = [0.1, 0.1, 0.4]\n        sol_high = solve_ivp(\n            fun=ode_system, t_span=t_span, y0=y0_high, args=ode_args,\n            method='RK45', t_eval=[T]\n        )\n        if not sol_high.success: return False\n        I_total_high = np.sum(sol_high.y[:, -1])\n\n        # Apply the bistability criterion as per problem statement's logic\n        # Bistability exists if the low-IC run converges to near-zero infection\n        # and the high-IC run converges to a sufficiently different endemic state.\n        is_bistable = (I_total_low  epsilon) and ((I_total_high - I_total_low) >= epsilon)\n        \n        return is_bistable\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'beta': 0.95, 'gamma': 1.0, 'gamma12': 0.5, 'sigma_range': [2.5, 4.0], 'c_range': [0.0, 0.4], 'grid_res': (9, 9), 'T': 500},\n        # Case 2\n        {'beta': 0.98, 'gamma': 1.0, 'gamma12': 0.8, 'sigma_range': [1.5, 2.5], 'c_range': [0.2, 0.6], 'grid_res': (9, 9), 'T': 500},\n        # Case 3\n        {'beta': 1.3, 'gamma': 1.0, 'gamma12': 1.0, 'sigma_range': [1.0, 1.2], 'c_range': [0.4, 0.8], 'grid_res': (9, 9), 'T': 300},\n    ]\n\n    results = []\n    for case in test_cases:\n        beta = case['beta']\n        gamma = case['gamma']\n        gamma12 = case['gamma12']\n        T = case['T']\n        \n        sigma_grid = np.linspace(case['sigma_range'][0], case['sigma_range'][1], case['grid_res'][0])\n        c_grid = np.linspace(case['c_range'][0], case['c_range'][1], case['grid_res'][1])\n        \n        bistable_count = 0\n        total_points = len(sigma_grid) * len(c_grid)\n        \n        for sigma in sigma_grid:\n            for c in c_grid:\n                params = (beta, gamma, gamma12, sigma, c, T)\n                if check_bistability(params):\n                    bistable_count += 1\n        \n        fraction = bistable_count / total_points if total_points > 0 else 0.0\n        results.append(round(fraction, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}