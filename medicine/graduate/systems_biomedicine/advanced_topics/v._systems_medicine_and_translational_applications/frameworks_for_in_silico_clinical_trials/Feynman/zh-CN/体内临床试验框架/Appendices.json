{
    "hands_on_practices": [
        {
            "introduction": "体外临床试验（ISCT）的核心目标之一是预测干预措施（如新药）在虚拟患者群体中的因果效应。本练习将引导您运用 g-computation 公式，这是从一个明确的因果模型推导出可计算的治疗效果估计值的强大框架。通过完成这个练习 ，您将掌握将抽象的因果理论转化为具体代码的实践技能，从而能够量化静态和动态治疗策略的平均治疗效果。",
            "id": "4343764",
            "problem": "您的任务是在计算机模拟临床试验 (ISCT) 的背景下，使用 g-computation 方法构建一个基于第一性原理的平均处理效应计算估计器。请从潜在结果框架和形式化的可识别性假设出发，推导出在特定干预下平均潜在结果的可计算表达式。然后，将所得估计器实现为一个完整的、可运行的程序，并用其评估一个已定义的测试套件。\n\n设定如下。令 $L$ 为基线协变量，$A \\in \\{0,1\\}$ 为二元处理，$Y$ 为标量结果。潜在结果 $Y^a$ 表示在处理水平 $A=a$ 下本应观测到的结果。假设存在一个结构因果模型 (SCM)，其结果结构方程如下：\n$$\nY \\;=\\; \\beta_0 + \\beta_1 A + \\beta_2 L + \\beta_3 A L + \\beta_4 L^2 + \\epsilon,\n$$\n其中 $\\epsilon \\sim \\mathcal{N}(0,\\sigma_\\epsilon^2)$，独立于 $L$，且在以 $L$ 为条件下独立于 $A$。基线协变量的分布为 $L \\sim \\mathcal{N}(\\mu, \\sigma^2)$。您应将 $\\beta_0,\\beta_1,\\beta_2,\\beta_3,\\beta_4,\\mu,\\sigma,\\sigma_\\epsilon$ 视为将由下文测试套件指定的参数。您不能使用 $A$ 的观测分配机制来估计因果效应；相反，您必须使用从第一性原理推导出的 g-computation 公式来评估干预估计量。\n\n任务：\n- 从潜在结果的基本定义以及标准的可识别性假设（一致性、给定 $L$ 的条件可交换性、正性）出发，为静态干预 $A=a$（其中 $a \\in \\{0,1\\}$）下的平均潜在结果 $E[Y^a]$ 推导出一个可计算的公式。\n- 将推导推广到动态阈值策略 $d_c(L) = \\mathbb{I}\\{L>c\\}$，并对任意实数阈值 $c$ 得出 $E[Y^{d_c}]$。\n- 将推导出的公式实现为一个程序，该程序对测试套件中的每组参数，按照下列确切顺序列出并计算以下量：\n  1. $E[Y^0]$，浮点数。\n  2. $E[Y^1]$，浮点数。\n  3. 平均处理效应 $E[Y^1] - E[Y^0]$，浮点数。\n  4. $E[Y^{d_{c_1}}]$，浮点数。\n  5. $E[Y^{d_{c_2}}]$，浮点数。\n  6. $E[Y^{d_{c_3}}]$，浮点数。\n\n所有输出必须是四舍五入到六位小数的浮点数。\n\n推导使用的基本原理：\n- 潜在结果定义：$Y^a$ 是在干预 $A=a$ 下的结果。\n- 一致性：$Y = Y^A$。\n- 给定 $L$ 的条件可交换性：对于每个 $a \\in \\{0,1\\}$，$Y^a \\perp A \\mid L$。\n- 正性：对于所有在 $L$ 支持集内的 $l$，对于每个 $a \\in \\{0,1\\}$，$P(A=a \\mid L=l) > 0$。\n- 全期望定律和标准概率演算。\n- 正态分布 $\\mathcal{N}(\\mu,\\sigma^2)$ 的性质以及截断正态变量的矩。\n\n测试套件：\n为 $3$ 组参数提供结果。每组参数指定 $(\\beta_0,\\beta_1,\\beta_2,\\beta_3,\\beta_4,\\mu,\\sigma,\\sigma_\\epsilon)$ 以及三个阈值 $(c_1,c_2,c_3)$，用于定义动态策略 $d_{c_j}(L) = \\mathbb{I}\\{L>c_j\\}$。\n\n- 情况 1：\n  - 参数：$(\\beta_0,\\beta_1,\\beta_2,\\beta_3,\\beta_4,\\mu,\\sigma,\\sigma_\\epsilon) = (2.0,\\,1.2,\\,0.5,\\,0.8,\\,0.3,\\,0.5,\\,1.0,\\,1.0)$。\n  - 阈值：$(c_1,c_2,c_3) = (0.0,\\,1.5,\\,-2.0)$。\n\n- 情况 2：\n  - 参数：$(\\beta_0,\\beta_1,\\beta_2,\\beta_3,\\beta_4,\\mu,\\sigma,\\sigma_\\epsilon) = (0.0,\\,0.7,\\,0.0,\\,1.5,\\,0.1,\\,-0.25,\\,0.5,\\,0.5)$。\n  - 阈值：$(c_1,c_2,c_3) = (-1.0,\\,0.0,\\,0.5)$。\n\n- 情况 3：\n  - 参数：$(\\beta_0,\\beta_1,\\beta_2,\\beta_3,\\beta_4,\\mu,\\sigma,\\sigma_\\epsilon) = (-1.0,\\,2.0,\\,1.0,\\,-0.4,\\,0.0,\\,1.0,\\,2.0,\\,2.0)$。\n  - 阈值：$(c_1,c_2,c_3) = (1.0,\\,3.0,\\,-1.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。结果的顺序应与上述各量的列出顺序一致，并按 $3$ 种情况依次连接。例如，输出必须如下所示：\n$[r_1,r_2,\\dots,r_{18}]$\n其中每个 $r_k$ 都是一个四舍五入到六位小数的浮点数，方括号前后不应有任何额外文本。",
            "solution": "该问题要求在一个特定的结构因果模型 (SCM) 中，基于 g-computation 公式推导并实现一个平均处理效应的计算估计器。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **变量**：基线协变量 $L$，二元处理 $A \\in \\{0, 1\\}$，标量结果 $Y$。\n- **潜在结果**：$Y^a$ 是在干预 $A=a$ 下的结果。\n- **结构因果模型 (SCM)**：$Y = \\beta_0 + \\beta_1 A + \\beta_2 L + \\beta_3 A L + \\beta_4 L^2 + \\epsilon$。\n- **分布**：\n    - 误差项：$\\epsilon \\sim \\mathcal{N}(0, \\sigma_\\epsilon^2)$，其中 $\\epsilon$ 独立于 $L$，且在以 $L$ 为条件下独立于 $A$。\n    - 协变量：$L \\sim \\mathcal{N}(\\mu, \\sigma^2)$。\n- **参数**：$\\beta_0, \\beta_1, \\beta_2, \\beta_3, \\beta_4, \\mu, \\sigma, \\sigma_\\epsilon$。\n- **可识别性假设**：\n    - 一致性：$Y = Y^A$。\n    - 条件可交换性：对于 $a \\in \\{0, 1\\}$，$Y^a \\perp A \\mid L$。\n    - 正性：对于所有在 $L$ 支持集内的 $l$ 且对于 $a \\in \\{0, 1\\}$，$P(A=a \\mid L=l) > 0$。\n- **动态策略**：$d_c(L) = \\mathbb{I}\\{L>c\\}$，其中 $\\mathbb{I}\\{\\cdot\\}$ 是指示函数。\n- **待计算量**：对于每个测试用例，计算：$E[Y^0]$、$E[Y^1]$、$E[Y^1] - E[Y^0]$、$E[Y^{d_{c_1}}]$、$E[Y^{d_{c_2}}]$、$E[Y^{d_{c_3}}]$。\n- **测试套件**：提供了三组参数 $(\\beta_0, \\dots, \\sigma_\\epsilon)$ 和阈值 $(c_1, c_2, c_3)$。\n\n**第 2 步：使用提取的已知条件进行验证**\n根据指定标准对问题进行评估：\n- **科学基础**：该问题牢固地建立在现代因果推断的标准框架之内，具体使用了 Pearl 的 SCM 和潜在结果（Neyman-Rubin）模型。g-computation 公式是因果效应估计的基石。所有组成部分都具有科学合理性。\n- **问题定义明确**：问题已完全指定。给出了数据的生成模型，定义了所有参数，并且目标估计量是精确的数学量。可以从所提供的信息中推导出唯一、稳定的解。\n- **客观性**：问题陈述是形式化和数学化的，没有歧义或主观语言。\n\n该问题未表现出任何缺陷，如科学上不合理、不完整、矛盾或不可行。使用可识别性假设来推导公式，然后在真实的 SCM 上进行评估，是一种标准且有效的教学方法。此任务并非微不足道，需要涉及正态分布和截断正态分布矩的推导和计算。\n\n**第 3 步：结论与行动**\n该问题被判定为**有效**。将构建一个基于第一性原理的解决方案。\n\n### 估计量的推导\n\n目标是推导在不同干预下平均潜在结果的可计算公式。\n\n**1. 静态干预：$E[Y^a]$**\n\n我们感兴趣的量是在固定处理水平 $A=a$ 下的平均潜在结果 $E[Y^a]$。推导从此定义开始，并应用概率论的基本原理和给定的因果假设。\n\n根据全期望定律，我们可以通过对协变量 $L$ 取条件来表达 $Y^a$ 的期望：\n$$E[Y^a] = E_L[E[Y^a \\mid L]]$$\n这可以写成关于 $L$ 分布的积分形式：\n$$E[Y^a] = \\int E[Y^a \\mid L=l] p(l) dl$$\n其中 $p(l)$ 是 $L$ 的概率密度函数。\n\n标准的可识别性假设使我们能够将潜在结果 $Y^a$ 与观测结果 $Y$ 联系起来。\n- 根据**条件可交换性** ($Y^a \\perp A \\mid L$)，我们可以在条件期望中引入观测处理 $A$：\n  $E[Y^a \\mid L=l] = E[Y^a \\mid L=l, A=a]$。\n- 根据**一致性** ($Y=Y^A$)，对于实际接受了处理 $a$（即 $A=a$）的个体，其观测结果即为其潜在结果，因此 $Y=Y^a$。这使我们能够在期望中用观测结果替换潜在结果：\n  $E[Y^a \\mid L=l, A=a] = E[Y \\mid L=l, A=a]$。\n\n结合这些步骤，得到 g-computation 公式：\n$$E[Y^a] = E_L[E[Y \\mid L, A=a]] = \\int E[Y \\mid L=l, A=a] p(l) dl$$\n\n内部的条件期望 $E[Y \\mid L=l, A=a]$ 由 SCM 决定：\n$$Y = \\beta_0 + \\beta_1 A + \\beta_2 L + \\beta_3 A L + \\beta_4 L^2 + \\epsilon$$\n在给定 $L=l$ 和 $A=a$ 的条件下取期望：\n$$E[Y \\mid L=l, A=a] = E[\\beta_0 + \\beta_1 a + \\beta_2 l + \\beta_3 a l + \\beta_4 l^2 + \\epsilon \\mid L=l, A=a]$$\n由于期望的线性性质以及 $E[\\epsilon \\mid L=l, A=a] = E[\\epsilon] = 0$（根据假设），我们得到：\n$$E[Y \\mid L, A=a] = \\beta_0 + \\beta_1 a + \\beta_2 L + \\beta_3 a L + \\beta_4 L^2$$\n\n现在，我们计算关于 $L \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 分布的外部期望：\n$$E[Y^a] = E_L[\\beta_0 + \\beta_1 a + \\beta_2 L + \\beta_3 a L + \\beta_4 L^2]$$\n再次使用期望的线性性质：\n$$E[Y^a] = \\beta_0 + \\beta_1 a + \\beta_2 E[L] + \\beta_3 a E[L] + \\beta_4 E[L^2]$$\n正态分布 $L \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的前两阶矩为 $E[L]=\\mu$ 和 $E[L^2] = \\text{Var}(L) + (E[L])^2 = \\sigma^2 + \\mu^2$。代入这些值可得：\n$$E[Y^a] = \\beta_0 + \\beta_1 a + \\beta_2 \\mu + \\beta_3 a \\mu + \\beta_4 (\\sigma^2 + \\mu^2)$$\n\n对于 $a=0$ 和 $a=1$：\n$$E[Y^0] = \\beta_0 + \\beta_2 \\mu + \\beta_4 (\\sigma^2 + \\mu^2)$$\n$$E[Y^1] = \\beta_0 + \\beta_1 + \\beta_2 \\mu + \\beta_3 \\mu + \\beta_4 (\\sigma^2 + \\mu^2)$$\n平均处理效应 (ATE) 是：\n$$ATE = E[Y^1] - E[Y^0] = \\beta_1 + \\beta_3 \\mu$$\n\n**2. 动态策略：$E[Y^{d_c}]$**\n\n动态策略为 $d_c(L) = \\mathbb{I}\\{L>c\\}$，该策略在 $L>c$ 时分配处理 $A=1$，在 $L \\le c$ 时分配处理 $A=0$。此策略下的潜在结果记为 $Y^{d_c(L)}$。\n根据定义，这可以写成：\n$$Y^{d_c(L)} = Y^1 \\cdot \\mathbb{I}\\{L>c\\} + Y^0 \\cdot \\mathbb{I}\\{L \\le c\\}$$\n我们可以通过代入 $Y^1$ 和 $Y^0$ 之间的结构关系来简化此表达式。从 SCM 中，$Y^a$ 的结构方程为 $Y^a = \\beta_0 + \\beta_1 a + \\beta_2 L + \\beta_3 a L + \\beta_4 L^2 + \\epsilon$。\n因此，$Y^1 = Y^0 + \\beta_1 + \\beta_3 L$。将此代入 $Y^{d_c(L)}$ 的表达式中：\n$$Y^{d_c(L)} = (Y^0 + \\beta_1 + \\beta_3 L) \\cdot \\mathbb{I}\\{L>c\\} + Y^0 \\cdot \\mathbb{I}\\{L \\le c\\}$$\n$$Y^{d_c(L)} = Y^0 (\\mathbb{I}\\{L>c\\} + \\mathbb{I}\\{L \\le c\\}) + (\\beta_1 + \\beta_3 L) \\cdot \\mathbb{I}\\{L>c\\}$$\n由于 $\\mathbb{I}\\{L>c\\} + \\mathbb{I}\\{L \\le c\\} = 1$：\n$$Y^{d_c(L)} = Y^0 + (\\beta_1 + \\beta_3 L) \\cdot \\mathbb{I}\\{L>c\\}$$\n现在，我们取此表达式的期望：\n$$E[Y^{d_c(L)}] = E[Y^0 + (\\beta_1 + \\beta_3 L) \\cdot \\mathbb{I}\\{L>c\\}]$$\n$$E[Y^{d_c(L)}] = E[Y^0] + E[(\\beta_1 + \\beta_3 L) \\cdot \\mathbb{I}\\{L>c\\}]$$\n$$E[Y^{d_c(L)}] = E[Y^0] + \\beta_1 E[\\mathbb{I}\\{L>c\\}] + \\beta_3 E[L \\cdot \\mathbb{I}\\{L>c\\}]$$\n我们需要计算以下各项：\n1.  \n$E[Y^0]$：我们已经推导出此项为 $\\beta_0 + \\beta_2 \\mu + \\beta_4 (\\sigma^2 + \\mu^2)$。\n2.  \n$E[\\mathbb{I}\\{L>c\\}] = P(L>c)$。令 $Z = (L-\\mu)/\\sigma$ 为标准化变量，$Z \\sim \\mathcal{N}(0,1)$。那么 $L>c$ 等价于 $Z > (c-\\mu)/\\sigma$。令 $\\alpha = (c-\\mu)/\\sigma$。\n    $$P(L>c) = P(Z > \\alpha) = 1 - \\Phi(\\alpha)$$\n    其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数 (CDF)。\n3.  \n$E[L \\cdot \\mathbb{I}\\{L>c\\}]$。这是 $L$ 的一阶部分矩。\n    $$E[L \\cdot \\mathbb{I}\\{L>c\\}] = \\int_c^\\infty l \\cdot p(l) dl$$\n    我们进行变量替换，令 $z=(l-\\mu)/\\sigma$，因此 $l=\\mu+\\sigma z$ 且 $p(l)dl = \\phi(z)dz$，其中 $\\phi(\\cdot)$ 是标准正态分布的概率密度函数 (PDF)。积分下限变为 $\\alpha=(c-\\mu)/\\sigma$。\n    $$\\int_\\alpha^\\infty (\\mu+\\sigma z)\\phi(z)dz = \\mu \\int_\\alpha^\\infty \\phi(z)dz + \\sigma \\int_\\alpha^\\infty z\\phi(z)dz$$\n    第一个积分是 $\\mu P(Z>\\alpha) = \\mu(1-\\Phi(\\alpha))$。\n    第二个积分是 $\\int_\\alpha^\\infty z \\frac{1}{\\sqrt{2\\pi}}e^{-z^2/2} dz$。此积分的结果为 $\\phi(\\alpha)$。\n    因此，\n    $$E[L \\cdot \\mathbb{I}\\{L>c\\}] = \\mu(1-\\Phi(\\alpha)) + \\sigma \\phi(\\alpha)$$\n\n综合所有部分，最终公式为：\n$$E[Y^{d_c(L)}] = (\\beta_0 + \\beta_2 \\mu + \\beta_4 (\\sigma^2 + \\mu^2)) + \\beta_1(1 - \\Phi(\\alpha)) + \\beta_3(\\mu(1 - \\Phi(\\alpha)) + \\sigma \\phi(\\alpha))$$\n其中 $\\alpha = (c-\\mu)/\\sigma$。这些推导出的公式现在可以实现了。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Main function to solve the causal inference problem for all test cases.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (parameters_dict, thresholds_tuple)\n    test_cases = [\n        (\n            {'beta0': 2.0, 'beta1': 1.2, 'beta2': 0.5, 'beta3': 0.8, 'beta4': 0.3, 'mu': 0.5, 'sigma': 1.0, 'sigma_epsilon': 1.0},\n            (0.0, 1.5, -2.0)\n        ),\n        (\n            {'beta0': 0.0, 'beta1': 0.7, 'beta2': 0.0, 'beta3': 1.5, 'beta4': 0.1, 'mu': -0.25, 'sigma': 0.5, 'sigma_epsilon': 0.5},\n            (-1.0, 0.0, 0.5)\n        ),\n        (\n            {'beta0': -1.0, 'beta1': 2.0, 'beta2': 1.0, 'beta3': -0.4, 'beta4': 0.0, 'mu': 1.0, 'sigma': 2.0, 'sigma_epsilon': 2.0},\n            (1.0, 3.0, -1.0)\n        )\n    ]\n\n    all_results = []\n    \n    for params, thresholds in test_cases:\n        # Unpack parameters for clarity\n        beta0 = params['beta0']\n        beta1 = params['beta1']\n        beta2 = params['beta2']\n        beta3 = params['beta3']\n        beta4 = params['beta4']\n        mu = params['mu']\n        sigma = params['sigma']\n\n        # Task 1  2: Calculate E[Y^0] and E[Y^1]\n        # First two moments of L ~ N(mu, sigma^2)\n        E_L = mu\n        E_L2 = sigma**2 + mu**2\n        \n        # E[Y^0] = beta0 + beta2*E[L] + beta4*E[L^2]\n        EY0 = beta0 + beta2 * E_L + beta4 * E_L2\n        \n        # E[Y^1] = E[Y^0] + beta1 + beta3*E[L]\n        EY1 = EY0 + beta1 + beta3 * E_L\n        \n        # Task 3: Calculate Average Treatment Effect (ATE)\n        # ATE = E[Y^1] - E[Y^0] = beta1 + beta3*E[L]\n        ATE = beta1 + beta3 * E_L\n\n        results_for_case = [\n            round(EY0, 6),\n            round(EY1, 6),\n            round(ATE, 6)\n        ]\n\n        # Inner function to compute E[Y^d_c] for a given threshold c\n        def calculate_EY_dc(c):\n            \"\"\"\n            Calculates the average potential outcome under the dynamic policy d_c(L).\n            \"\"\"\n            if sigma == 0:\n                # Handle degenerate case where L is a constant\n                if mu > c:\n                     # Policy sets A=1 with certainty\n                     return EY1\n                else: \n                     # Policy sets A=0 with certainty\n                     return EY0\n\n            # Standardized threshold\n            alpha = (c - mu) / sigma\n            \n            # P(L > c) = 1 - Phi(alpha)\n            prob_L_gt_c = 1.0 - norm.cdf(alpha)\n            \n            # E[L * I(L > c)] = mu * (1 - Phi(alpha)) + sigma * phi(alpha)\n            E_L_indicator = mu * prob_L_gt_c + sigma * norm.pdf(alpha)\n            \n            # E[Y^d_c] = E[Y^0] + beta1*P(L>c) + beta3*E[L*I(L>c)]\n            EY_dc = EY0 + beta1 * prob_L_gt_c + beta3 * E_L_indicator\n            \n            return EY_dc\n\n        # Tasks 4, 5, 6: Calculate E[Y^d_c] for each threshold\n        c1, c2, c3 = thresholds\n        EY_dc1 = calculate_EY_dc(c1)\n        EY_dc2 = calculate_EY_dc(c2)\n        EY_dc3 = calculate_EY_dc(c3)\n        \n        results_for_case.extend([\n            round(EY_dc1, 6),\n            round(EY_dc2, 6),\n            round(EY_dc3, 6)\n        ])\n        \n        all_results.extend(results_for_case)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在构建复杂的生物医学模型时，一个常见的陷阱是“殊途同归”（equifinality），即多组截然不同的模型参数却能产生无法区分的输出。这种情况，也称为结构不可辨识性，意味着仅靠现有数据无法唯一确定模型的内部机制。本练习  通过一个经典的药代动力学模型，挑战您识别并理解这一现象，并促使您思考如何通过修改实验设计来打破这种模糊性，从而确保模型参数的可信度。",
            "id": "4343782",
            "problem": "考虑一个系统生物医学中的计算机模拟临床试验框架，该框架使用标准的单室静脉推注药代动力学/药效动力学 (PK/PD) 模型。药代动力学质量平衡由质量守恒给出：体内药物总量 $A(t)$ 服从 $\\frac{dA(t)}{dt} = - CL \\, C(t)$，其中 $A(t) = V \\, C(t)$，$CL$ 是清除率，$V$ 是表观分布容积，$C(t)$ 是血浆浓度。在 $t=0$ 时给予一个已知的推注剂量 $D$，因此 $A(0) = D$ 且 $C(0) = D/V$。由于校准限制无法进行绝对定量，本试验中使用的临床检测仅在采样时间 $t \\in \\{1,2,4\\}$ 小时提供归一化的浓度时间曲线 $B(t) = \\frac{C(t)}{C(0)}$。在基线方案中没有收集其他测量数据。\n\n模拟了两位虚拟患者：\n- 患者 $1$：$(CL_1, V_1) = (0.5 \\,\\text{L/h}, 10 \\,\\text{L})$。\n- 患者 $2$：$(CL_2, V_2) = (1.0 \\,\\text{L/h}, 20 \\,\\text{L})$。\n\n要求您从第一性原理（质量守恒和上述定义）出发进行推理，以评估等效终局性（equifinality）：即在选定的测量和方案下，不同参数集产生无法区分的输出的现象。然后，提出能够打破这种等效性的实验设计修改方案。\n\n选择所有正确的陈述。\n\nA. 在仅记录 $t \\in \\{1,2,4\\}$ 小时 $B(t)$ 的基线方案下，患者 $1$ 和患者 $2$ 在所有 $t \\ge 0$ 的时间里产生相同的 $B(t)$ 轨迹。\n\nB. 对于推注剂量，通过在基线方案中增加一个在 $t=0$ 时的绝对血浆浓度测量值（即除了 $B(t)$ 之外还观察 $C(0)$），足以唯一地恢复 $V$ 和 $CL$，从而打破患者 $1$ 和患者 $2$ 之间的等效性。\n\nC. 将推注给药替换为具有已知输入速率 $R_{\\text{in}}$ 的恒速静脉输注，并在浓度上升阶段和输注停止后对绝对浓度进行采样，可以分别识别 $V$（从初始斜率）和 $CL$（从终末斜率），从而打破等效性。\n\nD. 增加 $B(t)$ 的给药后采样时间点（不进行任何绝对浓度测量）将通过更好地解析 $B(t)$ 的曲率来打破等效性。\n\nE. 给予两种不同的推注剂量但继续只记录 $B(t)$ 将打破等效性，因为 $B(t)$ 依赖于剂量，所以比较不同剂量下的响应可以分别识别 $V$ 和 $CL$。",
            "solution": "问题陈述具有科学依据、提法明确且客观。它描述了药代动力学中一个经典的结构可识别性问题。下面开始解答。\n\n首先，我们从给定的第一性原理推导测量输出 $B(t)$ 的数学表达式。该模型由两个方程定义：\n1. 体内药物总量 $A(t)$ 的质量平衡：$\\frac{dA(t)}{dt} = -CL \\cdot C(t)$。\n2. 药物总量与浓度 $C(t)$ 之间的关系：$A(t) = V \\cdot C(t)$。\n\n这里，$CL$ 是清除率，$V$ 是表观分布容积。我们可以合并这两个方程。通过对第二个方程关于时间 $t$ 求导，我们得到 $\\frac{dA(t)}{dt} = V \\frac{dC(t)}{dt}$。将其与第一个方程联立，可得：\n$$V \\frac{dC(t)}{dt} = -CL \\cdot C(t)$$\n$$\\frac{dC(t)}{dt} = -\\frac{CL}{V} C(t)$$\n我们定义消除速率常数 $k_e = \\frac{CL}{V}$。该微分方程简化为 $\\frac{dC(t)}{dt} = -k_e C(t)$。\n这是一个一阶线性常微分方程。其解是一个指数衰减函数：\n$$C(t) = C(0) e^{-k_e t} = C(0) e^{-(CL/V)t}$$\n问题陈述中提到，在 $t=0$ 时给予推注剂量 $D$，所以 $A(0)=D$。根据 $A(t)=VC(t)$，我们有 $C(0) = D/V$。\n测量的输出是归一化的浓度时间曲线 $B(t)$：\n$$B(t) = \\frac{C(t)}{C(0)} = \\frac{C(0) e^{-(CL/V)t}}{C(0)} = e^{-(CL/V)t}$$\n这个推导表明，在基线方案下，唯一可以识别的量是比率 $k_e = CL/V$。单独的参数 $CL$ 和 $V$ 无法仅从 $B(t)$ 的测量中被分别识别。这被称为结构不可识别性。\n\n现在，我们对两位虚拟患者进行评估：\n- 患者 $1$：$(CL_1, V_1) = (0.5 \\,\\text{L/h}, 10 \\,\\text{L})$。消除速率常数为 $k_{e1} = \\frac{CL_1}{V_1} = \\frac{0.5 \\,\\text{L/h}}{10 \\,\\text{L}} = 0.05 \\,\\text{h}^{-1}$。\n- 患者 $2$：$(CL_2, V_2) = (1.0 \\,\\text{L/h}, 20 \\,\\text{L})$。消除速率常数为 $k_{e2} = \\frac{CL_2}{V_2} = \\frac{1.0 \\,\\text{L/h}}{20 \\,\\text{L}} = 0.05 \\,\\text{h}^{-1}$。\n\n由于 $k_{e1} = k_{e2}$，两位患者在所有时间 $t \\ge 0$ 的可观察输出是相同的：\n$$B_1(t) = e^{-0.05t} \\quad \\text{和} \\quad B_2(t) = e^{-0.05t}$$\n这证实了等效终局性：不同的参数集 $(CL_1, V_1)$ 和 $(CL_2, V_2)$ 在指定的测量方案下产生无法区分的输出。\n\n现在，我们逐一评估每个陈述。\n\n**A. 在仅记录 $t \\in \\{1,2,4\\}$ 小时 $B(t)$ 的基线方案下，患者 $1$ 和患者 $2$ 在所有 $t \\ge 0$ 的时间里产生相同的 $B(t)$ 轨迹。**\n\n如上所示，函数 $B(t)$ 仅依赖于比率 $CL/V$。对于两位患者，该比率均为 $0.05 \\,\\text{h}^{-1}$。因此，他们的归一化浓度曲线 $B(t)$ 不仅在采样时间 $t \\in \\{1,2,4\\}$ 时相同，而且在所有 $t \\ge 0$ 的时间里都由完全相同的数学函数 $B(t) = e^{-0.05t}$ 描述。\n**结论：正确。**\n\n**B. 对于推注剂量，通过在基线方案中增加一个在 $t=0$ 时的绝对血浆浓度测量值（即除了 $B(t)$ 之外还观察 $C(0)$），足以唯一地恢复 $V$ 和 $CL$，从而打破患者 $1$ 和患者 $2$ 之间的等效性。**\n\n一个增强的方案提供了两条信息：\n1. $B(t)$ 的时间曲线，这可以确定 $k_e = CL/V$。从 A 部分我们知道，两位患者的 $k_e$ 均为 $0.05 \\,\\text{h}^{-1}$。\n2. 绝对浓度 $C(0)$ 的测量值。\n初始浓度定义为 $C(0) = D/V$。剂量 $D$ 是已知的。因此，如果测量了 $C(0)$，我们就可以直接计算分布容积：\n$$V = \\frac{D}{C(0)}$$\n一旦确定了 $V$，我们就可以使用从 $B(t)$ 中获得的 $k_e$ 值来计算清除率：\n$$CL = k_e \\cdot V$$\n对于这两位患者，假设剂量 $D$ 已知，他们的初始浓度将是不同的：$C_1(0) = D/V_1 = D/10$ 和 $C_2(0) = D/V_2 = D/20$。由于 $C_1(0) \\ne C_2(0)$，测量 $C(0)$ 将立即区分这两位患者，并允许唯一地确定他们各自的参数集 $(V_1, CL_1)$ 和 $(V_2, CL_2)$。这打破了等效性。\n**结论：正确。**\n\n**C. 将推注给药替换为具有已知输入速率 $R_{\\text{in}}$ 的恒速静脉输注，并在浓度上升阶段和输注停止后对绝对浓度进行采样，可以分别识别 $V$（从初始斜率）和 $CL$（从终末斜率），从而打破等效性。**\n\n对于从 $t=0$ 开始且 $C(0)=0$ 的恒速静脉输注，质量平衡方程为 $\\frac{dA(t)}{dt} = R_{\\text{in}} - CL \\cdot C(t)$。代入 $A(t) = VC(t)$，我们得到：\n$$V \\frac{dC(t)}{dt} = R_{\\text{in}} - CL \\cdot C(t) \\implies \\frac{dC(t)}{dt} = \\frac{R_{\\text{in}}}{V} - \\frac{CL}{V} C(t)$$\n在输注刚开始时 ($t \\to 0^+$)，$C(t)$ 接近于 $0$，因此方程近似为 $\\frac{dC(t)}{dt} \\approx \\frac{R_{\\text{in}}}{V}$。浓度曲线的初始斜率与 $1/V$ 成正比。通过测量这个初始斜率并知道 $R_{\\text{in}}$，就可以确定 $V$。在某个时间 $T$ 停止输注后，对于 $t>T$，$R_{\\text{in}}=0$，方程变回 $\\frac{dC(t)}{dt} = -\\frac{CL}{V} C(t)$。在这个终末阶段，$\\ln(C(t))$ 对 $t$ 的斜率为 $-CL/V$。所以，这个“终末斜率”可以确定比率 $k_e = CL/V$。通过从初始阶段识别出的 $V$ 和从终末阶段识别出的 $CL/V$，可以计算出 $CL = (CL/V) \\cdot V$。这种实验设计允许分别识别 $V$ 和 $CL$。患者 $1$ ($V_1 = 10 \\,\\text{L}$) 和患者 $2$ ($V_2 = 20 \\,\\text{L}$) 将具有不同的初始斜率，从而打破了等效性。\n**结论：正确。**\n\n**D. 增加 $B(t)$ 的给药后采样时间点（不进行任何绝对浓度测量）将通过更好地解析 $B(t)$ 的曲率来打破等效性。**\n\n如初始分析所示，出现等效终局性的原因是可观察函数 $B(t)=e^{-(CL/V)t}$ 在结构上仅依赖于比率 $CL/V$。对于两位患者，此函数均为 $B(t) = e^{-0.05t}$。两位患者生成了数学上完全相同的输出函数。增加更多的采样点，无论多少或在何处，都只会在这条相同的曲线上提供更多的点。虽然更多的数据可以提高参数 $k_e=CL/V$ 估计的精度，但它不能提供任何信息来单独区分 $CL$ 和 $V$。指数衰减的“曲率”完全由 $k_e$ 决定，而 $k_e$ 对两位患者来说是相同的。这是一个结构可识别性问题，而不是一个可以通过更多同类数据解决的实践问题。\n**结论：错误。**\n\n**E. 给予两种不同的推注剂量但继续只记录 $B(t)$ 将打破等效性，因为 $B(t)$ 依赖于剂量，所以比较不同剂量下的响应可以分别识别 $V$ 和 $CL$。**\n\n这个陈述的前提是错误的。如前所述，可观察量是 $B(t) = C(t)/C(0)$。在任意时间 $t$ 的浓度是 $C(t) = (D/V)e^{-(CL/V)t}$，初始浓度是 $C(0) = D/V$。$C(t)$ 和 $C(0)$ 都与剂量 $D$ 成正比。在它们的比率中，剂量 $D$ 被消掉了：\n$$B(t) = \\frac{(D/V)e^{-(CL/V)t}}{D/V} = e^{-(CL/V)t}$$\n归一化浓度 $B(t)$ 与剂量 $D$ 无关。对于给定的患者，给予不同剂量将产生完全相同的 $B(t)$ 曲线。这个实验没有提供任何新的信息来打破等效终局性。\n**结论：错误。**",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "一个模型的预测能力只有在得到严格、无偏的验证时才有意义。在体外临床试验中，由于数据具有复杂的多层次结构（如多中心、多批次、重复测量），设计一个可靠的验证策略尤其具有挑战性。本练习  模拟了一个真实世界的场景，要求您在多种方案中选择最佳的验证策略，以避免“数据泄露”并确保验证结果能真实反映模型在未来特定部署环境中的性能。",
            "id": "4343706",
            "problem": "一个计算机模拟（in-silico）临床试验框架正在被开发，用于预测个体患者对转移性结直肠癌新组合疗法的响应概率。该引擎集成了一个机制性药代动力学-药效动力学模型、一个系统级肿瘤生长模型和一个纵向生物标志物面板。现有来自 $S$ 家医院的多中心数据，每家医院都有患者随时间重复测量的数据。试验申办方计划在未来的一个检测周期 $\\tau^\\star$ 期间，首先在一家特定医院 $s^\\star$ 部署该系统，届时当地实验室的检测版本将从 $\\mathrm{v1}$ 切换到 $\\mathrm{v2}$。历史数据包含 $N$ 名患者（索引为 $i \\in \\{1,\\dots,N\\}$）、访视（索引为 $t$）、中心（索引为 $s \\in \\{1,\\dots,S\\}$）和检测周期（索引为 $\\tau \\in \\{\\mathrm{v1},\\mathrm{v2}\\}$），构成一个数据集\n$$\n\\mathcal{D} \\;=\\; \\big\\{ (x_{i,t,s,\\tau},\\, y_{i,t,s,\\tau}) \\big\\},\n$$\n其中 $x_{i,t,s,\\tau}$ 表示协变量和生物标志物，$y_{i,t,s,\\tau} \\in \\{0,1\\}$ 表示根据纵向结果得出的响应者状态。\n\n建模工作流包括两个阶段：校准阶段和验证阶段。在校准阶段，机制模型 $M_\\theta$ 的模型参数 $\\theta$ 和预处理映射 $\\phi$（包括归一化和批次校正）是使用校准数据 $\\mathcal{D}_{\\mathrm{cal}}$，通过最大似然估计或贝叶斯后验推断来估计的。在验证阶段，预测性能通过在留出数据 $\\mathcal{D}_{\\mathrm{val}}$ 上的风险泛函进行量化，\n$$\n\\widehat{R}_{\\mathrm{val}} \\;=\\; \\frac{1}{|\\mathcal{D}_{\\mathrm{val}}|} \\sum_{(x,y)\\in \\mathcal{D}_{\\mathrm{val}}} L\\!\\left( f_{\\theta,\\phi}(x),\\, y \\right),\n$$\n其中 $f_{\\theta,\\phi}$ 是由校准后的模型和预处理所导出的预测映射，$L$ 是一个有界损失函数（例如，负对数似然或布里尔分数）。目标部署分布是\n$$\nP^\\star(X,Y) \\;\\text{ over }\\; (X,Y) \\;\\text{ at site } s^\\star \\text{ during epoch } \\tau^\\star,\n$$\n验证的目的是估计泛化风险 $R^\\star \\equiv \\mathbb{E}_{(X,Y)\\sim P^\\star}\\big[ L(f_{\\theta,\\phi}(X), Y) \\big]$。\n\n假设以下经过充分检验的事实和核心定义：\n- 校准是参数推断：通过优化一个拟合准则（最大似然或后验），从 $\\mathcal{D}_{\\mathrm{cal}}$ 中估计 $\\theta$（以及任何预处理 $\\phi$），而不访问 $\\mathcal{D}_{\\mathrm{val}}$。\n- 验证是性能估计：使用独立于校准的数据来估计 $R^\\star$，以防止乐观偏差。\n- 数据泄露发生在以下情况：$\\theta$ 或 $\\phi$ 的任何组成部分直接或间接地使用了来自 $\\mathcal{D}_{\\mathrm{val}}$ 的信息，或来自与 $\\mathcal{D}_{\\mathrm{val}}$ 中单位统计相关的单位的信息（例如，同一患者、共享的纵向轨迹，或使用 $\\mathcal{D}_{\\mathrm{val}}$ 拟合的特定于中心和周期的变换）。\n- 基于独立性的风险估计：如果对于与 $\\theta$ 和 $\\phi$ 相关的生成过程，$\\mathcal{D}_{\\mathrm{val}} \\perp\\!\\!\\!\\perp \\mathcal{D}_{\\mathrm{cal}}$，并且如果 $P(\\mathcal{D}_{\\mathrm{val}})$ 与 $P^\\star$ 紧密匹配，则在标准正则性条件下，$\\widehat{R}_{\\mathrm{val}}$ 是 $R^\\star$ 的一个无偏或低偏差估计量。\n\n您必须在候选的留出策略中做出选择，以实现严格的校准-验证分离，在多中心、多周期结构和重复测量的情况下避免数据泄露，并最大化验证与在 $(s^\\star,\\tau^\\star)$ 进行预期部署的相关性。\n\n考虑以下候选策略：\n\nA. 在患者层面，从所有中心和周期中随机抽取比例为 $p$（$p \\in (0,1)$）的患者放入 $\\mathcal{D}_{\\mathrm{val}}$，确保没有患者同时出现在两个划分中。在划分前使用整个数据集 $\\mathcal{D}$ 估计归一化参数（例如，z-分数）和进行批次校正，以协调特征。通过使用 $\\mathcal{D}_{\\mathrm{val}}$ 一次性选择最佳模型来调整超参数。\n\nB. 留一中心法：将 $\\mathcal{D}_{\\mathrm{val}}$ 设置为来自中心 $s^\\star$ 在所有周期 $\\tau \\in \\{\\mathrm{v1},\\mathrm{v2}\\}$ 的所有患者；将 $\\mathcal{D}_{\\mathrm{cal}}$ 设置为所有其他中心的数据。拟合一个能感知中心的批次校正，该校正使用完整数据集来估计包括 $s^\\star$ 在内的所有中心的特定参数，以改善协调性。在 $\\mathcal{D}_{\\mathrm{cal}}$ 内部使用交叉验证进行模型调优。\n\nC. 留出预定部署集群法：将 $\\mathcal{D}_{\\mathrm{val}}$ 设置为仅来自中心 $s^\\star$ 在周期 $\\tau^\\star$ 的所有患者；将 $\\mathcal{D}_{\\mathrm{cal}}$ 设置为来自 $\\{1,\\dots,S\\}\\setminus\\{s^\\star\\}$ 在所有周期的所有患者，以及可选地，仅当没有使用来自 $s^\\star$ 的任何数据拟合预处理或模型参数时，才包括来自中心 $s^\\star$ 在较早周期 $\\tau \\neq \\tau^\\star$ 的患者。严格在 $\\mathcal{D}_{\\mathrm{cal}}$ 内部使用嵌套交叉验证来估计所有预处理映射 $\\phi$（归一化和批次校正）并调优超参数，不学习针对 $s^\\star$ 的任何特定于中心的参数。将从 $\\mathcal{D}_{\\mathrm{cal}}$ 学到的 $\\phi$ 应用于 $\\mathcal{D}_{\\mathrm{val}}$ 而不重新拟合。\n\nD. 每位患者内部留一访视法：为每位患者 $i$ 分配一部分访视到 $\\mathcal{D}_{\\mathrm{val}}$，其余访视到 $\\mathcal{D}_{\\mathrm{cal}}$，确保没有访视被重复使用。使用在 $\\mathcal{D}$ 上估计的全局均值和方差来标准化特征，以处理检测方法的变更。在 $\\mathcal{D}_{\\mathrm{cal}}$ 内部使用交叉验证进行模型调优。\n\n哪种策略能最好地强制执行校准与验证的分离，在存在重复测量和中心-周期效应的情况下避免数据泄露，并最大化验证与估计 $R^\\star$ 的相关性？选择一个选项。\n\n您的答案应基于上述定义和事实进行第一性原理推理。特别是，要对跨患者、访视、中心和周期的条件独立性进行推理；讨论使用 $\\mathcal{D}_{\\mathrm{val}}$（或相关单位）来拟合 $\\theta$ 或 $\\phi$ 的影响；并证明为什么所选策略产生的估计量 $\\widehat{R}_{\\mathrm{val}}$ 对 $R^\\star$ 的偏差最小，同时保持对在 $(s^\\star,\\tau^\\star)$ 部署的现实相关性。",
            "solution": "该问题要求为计算机模拟临床试验模型选择最佳的验证策略。目标是在一个特定的未来部署场景中——即在医院 $s^\\star$ 的检测周期 $\\tau^\\star$ 期间——获得对模型性能 $R^\\star$ 的可靠估计。策略的选择必须遵循严格的校准-验证分离、避免数据泄露以及最大化验证估计与目标部署场景相关性的原则。数据具有层次化或集群化结构：重复测量（访视 $t$）嵌套在患者 $i$ 内部，而患者又嵌套在中心-周期组合 $(s, \\tau)$ 内部。\n\n让我们分析一下有效估计泛化风险 $R^\\star$ 的核心要求。\n1.  **验证集的相关性**：验证数据的分布 $P(\\mathcal{D}_{\\mathrm{val}})$ 必须尽可能地与目标部署分布 $P^\\star(X,Y)$ 相匹配。目标分布是为来自中心 $s^\\star$ 和周期 $\\tau^\\star$ 的数据定义的。因此，理想的验证集 $\\mathcal{D}_{\\mathrm{val}}$ 应完全由来自这个 $(s^\\star, \\tau^\\star)$ 集群的数据组成。\n2.  **校准集和验证集的独立性**：用于验证的数据 $\\mathcal{D}_{\\mathrm{val}}$ 必须在统计上独立于用于校准的数据 $\\mathcal{D}_{\\mathrm{cal}}$。鉴于数据的集群化结构，这种独立性必须在最高的相关层级上成立。在集群内部分割数据（例如，从同一患者身上取不同的时间点）会违反这种独立性，因为这些数据点共享未观察到的混杂因素（例如，患者特异性生物学特征）。因此，数据分割必须在患者层面进行，或者为了跨中心泛化，则在中心层面进行。\n3.  **无数据泄露**：所有模型参数 $\\theta$ 和预处理参数 $\\phi$ 的估计必须仅使用来自 $\\mathcal{D}_{\\mathrm{cal}}$ 的信息。任何使用来自 $\\mathcal{D}_{\\mathrm{val}}$ 的信息来确定 $\\theta$ 或 $\\phi$ 的行为都构成数据泄露，并导致对风险的估计 $\\widehat{R}_{\\mathrm{val}}$ 产生乐观偏差。这包括在分割前对整个数据集 $\\mathcal{D}$ 拟合归一化常数（例如，用于z-分数的均值、标准差）或批次校正参数。超参数调优也必须在不“偷看”最终验证集的情况下进行。\n\n基于这些原则，我们可以评估每个候选策略。\n\n**选项 A 的分析：**\n该策略建议随机抽样患者到 $\\mathcal{D}_{\\mathrm{val}}$ 中。\n- **相关性**：$\\mathcal{D}_{\\mathrm{val}}$ 将是来自所有中心 $s \\in \\{1,\\dots,S\\}$ 和所有周期 $\\tau \\in \\{\\mathrm{v1},\\mathrm{v2}\\}$ 的患者的混合体。其分布是历史数据的平均值，与中心 $s^\\star$ 和周期 $\\tau^\\star$ 的特定目标分布 $P^\\star$ 不匹配。这种划分评估的是平均性能，而不是在特定部署环境中的性能。\n- **数据泄露**：该策略明确指出：“使用整个数据集 $\\mathcal{D}$ 估计归一化参数……和批次校正”。这是一个教科书式的数据泄露案例。预处理映射 $\\phi$ 是使用来自 $\\mathcal{D}_{\\mathrm{val}}$ 的数据学习的，违反了分离原则。此外，它建议：“通过使用 $\\mathcal{D}_{\\mathrm{val}}$ 选择最佳模型来调整超参数”。这是另一种形式的数据泄露，通常称为“不当调优”，即验证集被用于模型选择，而不是用于最终的、无偏的性能评估。\n- **结论**：**不正确**。该策略在相关性和数据泄露两个标准上都失败了。\n\n**选项 B 的分析：**\n该策略建议采用留一中心法交叉验证，其中 $\\mathcal{D}_{\\mathrm{val}}$ 包含来自目标中心 $s^\\star$ 的所有数据。\n- **相关性**：将 $\\mathcal{D}_{\\mathrm{val}}$ 设置为中心 $s^\\star$ 的数据是朝向相关性迈出的良好一步，因为它测试了对正确的目标患者群体的泛化能力。然而，它包含了来自所有周期 $\\tau \\in \\{\\mathrm{v1},\\mathrm{v2}\\}$ 的数据，因此它没有精确地针对未来的周期 $\\tau^\\star = \\mathrm{v2}$。它估计的是在中心 $s^\\star$ 上，对新旧检测版本平均后的性能。\n- **数据泄露**：该策略指出：“拟合一个能感知中心的批次校正，该校正使用完整数据集来估计包括 $s^\\star$ 在内的所有中心的特定参数”。这构成了数据泄露。通过使用来自验证中心 $s^\\star$ 本身的数据来拟合该中心的批次校正参数，模型在预处理阶段就获得了关于验证集分布的信息。这将导致性能估计出现乐观偏差。\n- **结论**：**不正确**。尽管比选项A具有更好的相关性，但它犯了一个关键的数据泄露错误。\n\n**选项 C 的分析：**\n该策略建议留出特定的部署集群：$\\mathcal{D}_{\\mathrm{val}}$ 被设置为仅来自中心 $s^\\star$ 在周期 $\\tau^\\star$ 的所有患者。\n- **相关性**：这种对 $\\mathcal{D}_{\\mathrm{val}}$ 的选择是理想的。验证集中的数据直接从目标分布 $P^\\star$ 中抽样。因此，得到的风险估计 $\\widehat{R}_{\\mathrm{val}}$ 将是真实泛化风险 $R^\\star$ 的一个最大化相关的估计量。\n- **数据泄露**：该策略在避免泄露方面是明确且正确的：“严格在 $\\mathcal{D}_{\\mathrm{cal}}$ 内部使用嵌套交叉验证来估计所有预处理映射 $\\phi$（归一化和批次校正）并调优超参数”。这确保了来自 $\\mathcal{D}_{\\mathrm{val}}$ 的任何信息都不会影响校准后的模型 $f_{\\theta,\\phi}$。它还正确地指定了应用已学习的预处理的程序：“将从 $\\mathcal{D}_{\\mathrm{cal}}$ 学到的 $\\phi$ 应用于 $\\mathcal{D}_{\\mathrm{val}}$ 而不重新拟合。”这模拟了现实世界中的场景，即一个固定的模型和预处理流程被应用于新的、未见过的数据。该策略还通过分离整个中心-周期集群来正确处理了数据的集群性质。关于将来自 $s^\\star, \\tau \\neq \\tau^\\star$ 的数据包含在 $\\mathcal{D}_{\\mathrm{cal}}$ 中的复杂可选条款可能措辞略有不佳，但其描述的核心程序（将目标集群 $(s^\\star, \\tau^\\star)$ 隔离用于验证，并在剩余数据上拟合所有内容）在根本上是合理的，并且是最佳实践。\n- **结论**：**正确**。该策略是唯一满足所有三个标准的：它最大化了相关性，通过尊重数据层次结构确保了严格的校准-验证独立性，并明确规定了一个避免所有形式数据泄露的程序。\n\n**选项 D 的分析：**\n该策略建议在每位患者内部进行留一访视法交叉验证。\n- **独立性**：这违反了 $\\mathcal{D}_{\\mathrm{cal}}$ 和 $\\mathcal{D}_{\\mathrm{val}}$ 之间独立性的基本要求。来自同一患者的重复测量是高度相关的。在某些访视上训练模型，并在同一患者的其他访视上进行测试，这使得模型能够利用患者特异性效应，从而得到的是插值性能的估计，而不是对新患者的泛化性能。由此产生的性能估计 $\\widehat{R}_{\\mathrm{val}}$ 将会非常乐观，并且不能代表在新队列上的性能。\n- **相关性**：此验证方案衡量的是为*已在系统中*的患者预测未来结果的能力。而目标是估计在中心 $s^\\star$ 的*新患者*上的性能。该策略与既定目标完全不符。\n- **数据泄露**：它还建议“使用在 $\\mathcal{D}$ 上估计的全局均值和方差来标准化特征”，这与选项 A 中的泄露错误相同。\n- **结论**：**不正确**。该策略在每个关键方面都存在缺陷：它违反了独立性假设，存在数据泄露问题，并且提供的性能估计与既定目标无关。\n\n总而言之，策略C是唯一一个将验证问题正确地表述为对一个新的、特定分布的泛化问题，并为估计相应风险提供了严谨、无泄露程序的策略。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}