{
    "hands_on_practices": [
        {
            "introduction": "我们从群体建模的基本构建模块——逻辑斯谛增长方程——开始我们的探索。这项练习将引导你求解该方程的解析解，它描述了像CAR-T细胞这样的群体如何在有限环境中扩增。通过推导解并解释其参数，你将对资源限制（由承载能力$K$代表）如何决定治疗的最终效果获得核心理解。",
            "id": "4361771",
            "problem": "考虑嵌合抗原受体（CAR）T细胞在过继性转移到实体瘤患者体内后的体内扩增。一个广泛使用的粗粒度种群模型假设CAR-T细胞丰度 $T(t)$ 满足以下常微分方程\n$$\\frac{dT}{dt} = r\\,T\\left(1 - \\frac{T}{K}\\right),$$\n其中 $r>0$ 是在低 $T$ 时的内在人均增长率，而 $K>0$ 是由肿瘤微环境约束（例如，抗原可及性、葡萄糖和氧气等代谢资源、抑制性细胞因子和空间限制）施加的有限上界。假设初始条件为 $T(0)=T_0$，且 $0  T_0  K$。请推导并给出该逻辑斯谛方程的解析解 $T(t)$。",
            "solution": "该问题要求求解逻辑斯谛增长常微分方程的初值问题。\n### 步骤1：分离变量\n给定的微分方程是：\n$$ \\frac{dT}{dt} = rT\\left(1 - \\frac{T}{K}\\right) $$\n这是一个可分离变量的方程。我们将所有含 $T$ 的项移到左边，所有含 $t$ 的项移到右边：\n$$ \\frac{dT}{T(1 - T/K)} = r\\,dt $$\n$$ \\frac{K\\,dT}{T(K - T)} = r\\,dt $$\n### 步骤2：部分分式分解\n为了对左侧进行积分，我们使用部分分式分解。我们寻找常数 $A$ 和 $B$ 使得：\n$$ \\frac{K}{T(K-T)} = \\frac{A}{T} + \\frac{B}{K-T} $$\n通分得到 $K = A(K-T) + BT$。\n- 令 $T=0$，我们得到 $K = A \\cdot K \\implies A=1$。\n- 令 $T=K$，我们得到 $K = B \\cdot K \\implies B=1$。\n因此，左侧可以写成：\n$$ \\left(\\frac{1}{T} + \\frac{1}{K-T}\\right)dT = r\\,dt $$\n### 步骤3：积分\n现在我们对两边进行积分：\n$$ \\int \\left(\\frac{1}{T} + \\frac{1}{K-T}\\right)dT = \\int r\\,dt $$\n$$ \\ln|T| - \\ln|K-T| = rt + C_1 $$\n其中 $C_1$ 是积分常数。由于 $0  T_0  K$ 且群体不会穿过0或 $K$，我们可以去掉绝对值符号：\n$$ \\ln\\left(\\frac{T}{K-T}\\right) = rt + C_1 $$\n### 步骤4：求解 $T(t)$\n为了求解 $T(t)$，我们首先对两边取指数：\n$$ \\frac{T}{K-T} = e^{rt+C_1} = e^{C_1}e^{rt} $$\n令 $A = e^{C_1}$ 为一个新的常数。\n$$ \\frac{T}{K-T} = A e^{rt} $$\n### 步骤5：应用初始条件\n我们使用初始条件 $T(0)=T_0$ 来确定常数 $A$：\n$$ \\frac{T_0}{K-T_0} = A e^{r \\cdot 0} = A $$\n所以 $A = \\frac{T_0}{K-T_0}$。\n### 步骤6：代入常数并化简\n将 $A$ 的表达式代回方程：\n$$ \\frac{T}{K-T} = \\left(\\frac{T_0}{K-T_0}\\right)e^{rt} $$\n现在，我们解出 $T$：\n$$ T = (K-T)\\left(\\frac{T_0}{K-T_0}\\right)e^{rt} $$\n$$ T = K\\left(\\frac{T_0}{K-T_0}\\right)e^{rt} - T\\left(\\frac{T_0}{K-T_0}\\right)e^{rt} $$\n$$ T\\left[1 + \\left(\\frac{T_0}{K-T_0}\\right)e^{rt}\\right] = K\\left(\\frac{T_0}{K-T_0}\\right)e^{rt} $$\n$$ T\\left[\\frac{K-T_0+T_0 e^{rt}}{K-T_0}\\right] = K\\frac{T_0 e^{rt}}{K-T_0} $$\n$$ T(t) = \\frac{K T_0 e^{rt}}{K - T_0 + T_0 e^{rt}} $$\n为了得到与标准形式匹配的最终答案，我们将分子和分母同时除以 $T_0 e^{rt}$：\n$$ T(t) = \\frac{K}{\\frac{K-T_0}{T_0 e^{rt}} + 1} = \\frac{K}{1 + \\left(\\frac{K - T_0}{T_0}\\right)e^{-rt}} $$\n这就是逻辑斯谛方程的解。",
            "answer": "$$\n\\boxed{T(t) = \\frac{K}{1 + \\left(\\frac{K - T_0}{T_0}\\right) \\exp(-rt)}}\n$$"
        },
        {
            "introduction": "在有限增长概念的基础上，我们现在引入一个捕食者-猎物模型来描述CAR-T细胞与肿瘤细胞之间的相互作用。本练习将介绍一种强大的技术——无量纲化，它通过减少参数数量来简化复杂系统。通过对模型进行尺度变换，你将揭示出主导治疗动态的核心无量纲参数，从而更深刻地洞察肿瘤生长、CAR-T杀伤、增殖和衰减之间的平衡。",
            "id": "4361877",
            "problem": "一个用于嵌合抗原受体（CAR）T细胞免疫疗法的最小相互作用模型，耦合了肿瘤细胞群体动力学和效应CAR-T细胞动力学。令 $T(t)$ 表示时间 $t$ 时的肿瘤细胞， $E(t)$ 表示CAR-T细胞。假设肿瘤细胞呈逻辑斯谛增长，并通过与CAR-T细胞的质量作用相遇而被杀死；而CAR-T细胞在遇到肿瘤细胞时增殖，并以一个基准速率死亡。该有量纲模型为\n$$\n\\frac{dT}{dt} \\;=\\; r\\,T\\left(1 - \\frac{T}{K}\\right) \\;-\\; \\kappa\\,E\\,T,\n\\qquad\n\\frac{dE}{dt} \\;=\\; \\eta\\,E\\,T \\;-\\; \\delta\\,E,\n$$\n其中 $r$ 是肿瘤的内禀人均增长率，$K$ 是肿瘤的环境承载力，$\\kappa$ 是单位CAR-T细胞的人均细胞毒性速率常数，$\\eta$ 是每次遇到肿瘤细胞时CAR-T细胞的增殖速率常数，$\\delta$ 是CAR-T细胞的死亡速率。所有参数均为正，且其单位与所述过程一致。\n\n从这些控制方程和标准的质量作用及逻辑斯谛增长假设出发，通过引入一个重新标度的时间 $\\tau$、一个重新标度的肿瘤变量 $x(\\tau)$ 和一个重新标度的CAR-T变量 $y(\\tau)$，根据以下要求进行系统的无量纲化：\n- 分别使用肿瘤的内禀时间尺度和环境承载力作为特征时间和特征肿瘤尺度。\n- 选择CAR-T细胞的尺度，使得重新标度的肿瘤方程中肿瘤-CAR-T相互作用项的系数为1。\n\n推导以 $x(\\tau)$ 和 $y(\\tau)$ 表示的完全无量纲化的系统，并确定控制其动力学和结果的完整独立无量纲参数组合集。将最终答案表示为一个单行向量，其中包含这些独立的无量纲参数，每个参数都写成由原始有量纲参数 $r$、$K$、$\\kappa$、$\\eta$ 和 $\\delta$ 组成的闭式解析表达式。最终答案中不需要数值，也不应包含任何单位。最终答案必须只包含所要求的行向量。",
            "solution": "该问题要求对一个描述肿瘤细胞群体 $T(t)$ 和CAR-T效应细胞群体 $E(t)$ 动力学的耦合常微分方程组进行无量纲化。\n\n控制方程（有量纲）如下所示：\n$$\n\\frac{dT}{dt} = rT\\left(1 - \\frac{T}{K}\\right) - \\kappa ET \\label{eq:T}\n$$\n$$\n\\frac{dE}{dt} = \\eta ET - \\delta E \\label{eq:E}\n$$\n所有参数 $r, K, \\kappa, \\eta, \\delta$ 均为正常数。\n\n根据题目要求，我们引入时间 $\\tau$、肿瘤细胞 $x(\\tau)$ 和CAR-T细胞 $y(\\tau)$ 的无量纲变量。标度关系定义如下：\n$$\nt = t_c \\tau\n$$\n$$\nT(t) = T_c x(\\tau)\n$$\n$$\nE(t) = E_c y(\\tau)\n$$\n其中 $t_c$、$T_c$ 和 $E_c$ 分别是时间、肿瘤群体和CAR-T细胞群体的特征尺度。\n\n问题指定了其中两个尺度的选择：\n1.  特征时间 $t_c$ 是肿瘤的内禀时间尺度。参数 $r$ 是肿瘤的内禀人均增长率，其单位为 $(\\text{时间})^{-1}$。$r$ 的倒数提供了一个自然的肿瘤生长的时间尺度。因此，我们设：\n    $$\n    t_c = \\frac{1}{r}\n    $$\n2.  特征肿瘤群体 $T_c$ 是肿瘤的环境承载力 $K$。因此，我们设：\n    $$\n    T_c = K\n    $$\n\n因此，变量 $t$ 和 $T$ 的标度关系为：\n$$\nt = \\frac{\\tau}{r}, \\qquad T(t) = K x(\\tau)\n$$\n\n特征CAR-T细胞尺度 $E_c$ 的选择应使重新标度的肿瘤方程中肿瘤-CAR-T相互作用项的系数为1。我们将通过强制执行此条件来确定 $E_c$。\n\n首先，我们使用链式法则变换时间导数：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau}\n$$\n从 $t = \\tau/r$，我们得到 $\\frac{dt}{d\\tau} = \\frac{1}{r}$，这意味着 $\\frac{d\\tau}{dt} = r$。因此，导数算子变换为：\n$$\n\\frac{d}{dt} = r \\frac{d}{d\\tau}\n$$\n\n现在，我们将标度关系代入第一个关于肿瘤群体的微分方程：\n$$\nr \\frac{d(Kx)}{d\\tau} = r(Kx)\\left(1 - \\frac{Kx}{K}\\right) - \\kappa(E_c y)(Kx)\n$$\n$$\nrK \\frac{dx}{d\\tau} = rKx(1 - x) - \\kappa E_c K xy\n$$\n为简化起见，我们将整个方程除以因子 $rK$（因为 $r > 0$ 且 $K > 0$）：\n$$\n\\frac{dx}{d\\tau} = x(1 - x) - \\frac{\\kappa E_c}{r} xy\n$$\n根据问题的要求，相互作用项 $xy$ 的系数必须为1。这给了我们以下条件：\n$$\n\\frac{\\kappa E_c}{r} = 1\n$$\n求解 $E_c$，我们得到CAR-T细胞群体的特征尺度：\n$$\nE_c = \\frac{r}{\\kappa}\n$$\n在选择了 $E_c$ 后，$E(t)$ 的标度关系为 $E(t) = \\frac{r}{\\kappa} y(\\tau)$，肿瘤群体的无量纲方程变为：\n$$\n\\frac{dx}{d\\tau} = x(1 - x) - xy\n$$\n\n接下来，我们使用现在已完全确定的标度关系，对第二个关于CAR-T细胞群体的微分方程进行无量纲化：\n$$\nt = \\frac{\\tau}{r}, \\quad T = Kx, \\quad E = \\frac{r}{\\kappa} y, \\quad \\frac{d}{dt} = r\\frac{d}{d\\tau}\n$$\n将这些代入关于 $dE/dt$ 的方程中：\n$$\nr \\frac{d}{d\\tau}\\left(\\frac{r}{\\kappa}y\\right) = \\eta\\left(\\frac{r}{\\kappa}y\\right)(Kx) - \\delta\\left(\\frac{r}{\\kappa}y\\right)\n$$\n$$\nr\\left(\\frac{r}{\\kappa}\\right)\\frac{dy}{d\\tau} = \\left(\\frac{\\eta rK}{\\kappa}\\right)xy - \\left(\\frac{\\delta r}{\\kappa}\\right)y\n$$\n为了分离出 $\\frac{dy}{d\\tau}$，我们将整个方程除以因子 $r(\\frac{r}{\\kappa}) = \\frac{r^2}{\\kappa}$：\n$$\n\\frac{dy}{d\\tau} = \\frac{\\frac{\\eta rK}{\\kappa}}{\\frac{r^2}{\\kappa}} xy - \\frac{\\frac{\\delta r}{\\kappa}}{\\frac{r^2}{\\kappa}} y\n$$\n简化系数：\n$$\n\\frac{dy}{d\\tau} = \\left(\\frac{\\eta rK}{\\kappa} \\cdot \\frac{\\kappa}{r^2}\\right) xy - \\left(\\frac{\\delta r}{\\kappa} \\cdot \\frac{\\kappa}{r^2}\\right) y\n$$\n$$\n\\frac{dy}{d\\tau} = \\left(\\frac{\\eta K}{r}\\right) xy - \\left(\\frac{\\delta}{r}\\right) y\n$$\n这个方程也可以写成 $\\frac{dy}{d\\tau} = \\left(\\frac{\\eta K}{r}x - \\frac{\\delta}{r}\\right) y$。\n\n完整的无量纲系统是：\n$$\n\\frac{dx}{d\\tau} = x(1 - x) - xy\n$$\n$$\n\\frac{dy}{d\\tau} = \\left(\\frac{\\eta K}{r}\\right) xy - \\left(\\frac{\\delta}{r}\\right) y\n$$\n该系统的动力学由作为系数出现的无量纲参数组合所控制。这是两个独立的组合：\n1.  第二个方程中 $xy$ 项的系数：$\\frac{\\eta K}{r}$\n2.  第二个方程中 $y$ 项的系数：$\\frac{\\delta}{r}$\n\n这两组参数代表了控制系统动力学的完整的独立无量纲参数集。它们是由原始的五个有量纲参数（$r, K, \\kappa, \\eta, \\delta$）的组合构建的。参数 $\\kappa$ 已被吸收到CAR-T细胞变量 $y$ 的标度中。\n\n最终答案是这两个参数的集合，表示为一个行向量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\eta K}{r}  \\frac{\\delta}{r}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论分析提供了“为什么”，而数值模拟则回答了“如果……会怎样”。在最后的这项实践中，你将把捕食者-猎物模型转化为计算机模拟，以预测不同虚拟患者情景下的治疗结果。你将实现该模型，进行数值积分，并确定肿瘤根除或复发等临床相关终点。这项练习弥合了抽象数学模型与其实际应用于个性化医疗之间的鸿沟，让你能够探索参数变化如何导致截然不同的临床轨迹。",
            "id": "4361819",
            "problem": "肿瘤细胞和嵌合抗原受体T细胞（CAR-T）之间的动态相互作用可以从第一性原理出发，利用质量守恒、资源限制和质量作用相遇动力学进行建模。肿瘤的生长受到有限资源和空间的限制，这促使了逻辑斯谛增长。CAR-T细胞与肿瘤细胞的相互作用体现在两个方面：通过杀伤肿瘤细胞来减少其数量，以及在抗原识别后自身扩增，同时CAR-T细胞也会自然衰减。您的任务是，在给定特定参数和初始条件的情况下，实现并模拟一个模型，以估算肿瘤被清除或肿瘤再生这两个事件中，任意一个最早发生的时间。\n\n使用以下源自经过充分检验的系统生物医学原理的建模假设：\n- 肿瘤细胞群体 $T(t)$ 以内在增长率 $r$ 和环境承载力 $K$ 进行逻辑斯谛增长，并通过CAR-T介导的杀伤作用而减少，其减少速率与肿瘤细胞和CAR-T细胞数量的乘积（质量作用）成正比。\n- CAR-T细胞群体 $E(t)$ 在接触肿瘤细胞后发生净增殖，增殖速率与乘积 $T(t)E(t)$ 成正比，系数为 $\\alpha$，同时每个细胞以速率 $\\delta$ 衰减。\n\n根据这些假设：\n- 肿瘤动力学满足以下常微分方程\n$$\\frac{dT}{dt} = r\\,T\\left(1-\\frac{T}{K}\\right) - \\kappa\\,E\\,T,$$\n其中 $r$ 的单位是 $\\text{天}^{-1}$，$K$ 的单位是 $\\text{细胞}$，$\\kappa$ 的单位是 $\\text{细胞}^{-1}\\,\\text{天}^{-1}$。\n- CAR-T动力学满足以下常微分方程\n$$\\frac{dE}{dt} = \\alpha\\,T\\,E - \\delta\\,E,$$\n其中 $\\alpha$ 的单位是 $\\text{细胞}^{-1}\\,\\text{天}^{-1}$，$\\delta$ 的单位是 $\\text{天}^{-1}$。\n- 初始条件为 $T(0)=T_0$ 和 $E(0)=E_0$，其中 $T_0$ 和 $E_0$ 的单位是 $\\text{细胞}$。\n\n定义两个具有临床意义的阈值：\n- 当 $T(t) \\le T_{\\text{erad}}$ 时，定义为肿瘤清除，其中 $T_{\\text{erad}} = 1.0$ 个 $\\text{细胞}$。\n- 当 $T(t) \\ge T_{\\text{reg}}$ 时，定义为肿瘤再生（逃逸），其中 $T_{\\text{reg}} = 0.8\\,K$ 个 $\\text{细胞}$。\n\n估算最早的时间 $t^\\ast$（单位：天），在该时间点 $T(t)$ 首次满足 $T(t) \\le T_{\\text{erad}}$ 或 $T(t) \\ge T_{\\text{reg}}$。如果在 $t_{\\max}=180$ 天的模拟时限内两个事件都未发生，则返回哨兵值 $-1.0$。最终答案以天为单位，四舍五入到两位小数，但哨兵值必须精确为 $-1.0$。\n\n实现一个程序，对该耦合系统进行积分，并使用鲁棒的事件检测功能来检测首次阈值穿越。使用固定的环境承载力 $K=10^9$ 个 $\\text{细胞}$。假设时间单位为天，所有细胞计数单位为 $\\text{细胞}$。模型必须以适当的精度进行数值积分，以正确检测到第一个事件。每个测试用例的输出是一个浮点数，四舍五入到两位小数（或 $-1.0$），代表估算出的最早事件发生时间（单位：天）。\n\n测试套件：\n模拟以下四位假想患者，每位由参数值 $(r,\\kappa,\\alpha,\\delta)$ 和初始条件 $(T_0,E_0)$ 指定，其中所有数值均采用上述定义的单位。\n\n- 案例 $1$ （预期清除）：$(r=$$0.03$$, \\kappa=$$1\\times10^{-9}$$, \\alpha=$$5\\times10^{-9}$$, \\delta=$$0.10$$)$, $(T_0=$$1\\times10^{8}$$, E_0=$$5\\times10^{7}$$)$。\n- 案例 $2$ （预期再生）：$(r=$$0.04$$, \\kappa=$$1\\times10^{-10}$$, \\alpha=$$1\\times10^{-9}$$, \\delta=$$0.20$$)$, $(T_0=$$1\\times10^{8}$$, E_0=$$1\\times10^{6}$$)$。\n- 案例 $3$ （时限内无事件发生）：$(r=$$0.001$$, \\kappa=$$5\\times10^{-11}$$, \\alpha=$$5\\times10^{-10}$$, \\delta=$$0.05$$)$, $(T_0=$$1\\times10^{8}$$, E_0=$$1\\times10^{5}$$)$。\n- 案例 $4$ （临界动力学）：$(r=$$0.03$$, \\kappa=$$5\\times10^{-10}$$, \\alpha=$$3\\times10^{-9}$$, \\delta=$$0.20$$)$, $(T_0=$$1\\times10^{8}$$, E_0=$$1\\times10^{7}$$)$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是以天为单位的浮点数时间，四舍五入到两位小数，如果到 $t_{\\max}$ 时仍未发生事件，则为精确的 $-1.0$。不应打印任何额外文本。",
            "solution": "所提出的问题是一个定义明确的耦合非线性常微分方程（ODE）系统的初值问题，这是系统生物学和计算科学中的一项标准任务。该模型是捕食者-猎物范式的一个变体，专门用于描述肿瘤细胞（$T$）作为猎物和嵌合抗原受体T细胞（$E$）作为捕食者的动力学。\n\n该系统由以下方程组控制：\n$$\n\\frac{dT}{dt} = r\\,T\\left(1 - \\frac{T}{K}\\right) - \\kappa\\,E\\,T\n$$\n$$\n\\frac{dE}{dt} = \\alpha\\,T\\,E - \\delta\\,E\n$$\n在这里，肿瘤群体 $T(t)$ 表现出逻辑斯谛增长，其内在增长率为 $r$，环境承载力为 $K$。它通过与CAR-T细胞 $E(t)$ 的相互作用而被消耗，这是一个质量作用动力学项，速率常数为 $\\kappa$。CAR-T细胞群体 $E(t)$ 在遇到肿瘤细胞后增殖，同样由一个质量作用项控制，速率常数为 $\\alpha$，并以速率 $\\delta$ 进行自然的一阶衰减。系统的初始状态由 $T(0) = T_0$ 和 $E(0) = E_0$ 给出。\n\n由于这些耦合方程的非线性特性，通常无法获得解析解。因此，我们必须借助数值积分来近似求解随时间变化的轨迹 $T(t)$ 和 $E(t)$。任务的核心是确定肿瘤细胞群体 $T(t)$ 穿过两个指定阈值之一的最早时间 $t^\\ast$：\n1.  **清除：** $T(t) \\le T_{\\text{erad}}$，其中 $T_{\\text{erad}} = 1.0$。\n2.  **再生：** $T(t) \\ge T_{\\text{reg}}$，其中 $T_{\\text{reg}} = 0.8\\,K = 8 \\times 10^8$。\n\n这类需要找到ODE解满足特定条件的时间的问题，被称为事件查找问题。现代数值ODE求解器为此提供了鲁棒的机制。我们将使用 `scipy.integrate.solve_ivp` 函数，它是Python的SciPy库中一个功能强大且通用的ODE求解器。\n\n`solve_ivp` 函数允许指定事件函数。当一个事件函数的值穿过零点时，一个事件就被触发。我们定义两个与我们的阈值相对应的此类函数：\n-   对于清除事件，事件函数为 $g_{\\text{erad}}(t, y) = y_0 - T_{\\text{erad}}$，其中 $y_0$ 代表肿瘤细胞群体 $T(t)$。如果此函数在减小过程中变为零（即 $T(t)$ 下降到 $T_{\\text{erad}}$），积分应停止。这通过将事件的 `direction` 属性设置为 $-1$ 来指定。\n-   对于再生事件，事件函数为 $g_{\\text{reg}}(t, y) = y_0 - T_{\\text{reg}}$。如果此函数在增加过程中变为零（即 $T(t)$ 上升到 $T_{\\text{reg}}$），积分应停止。这通过将事件的 `direction` 属性设置为 $1$ 来指定。\n\n对于这两个事件函数，我们都将 `terminal` 属性设置为 `True`。这会指示求解器在检测到这些事件中的第一个时立即终止积分。终止的时间点正是我们所寻求的最早事件时间 $t^\\ast$。\n\n每个测试用例的总体算法如下：\n1.  定义一个Python函数，该函数根据当前状态 $[T, E]$、时间 $t$ 和模型参数 $(r, \\kappa, \\alpha, \\delta, K)$ 计算导数 $[\\frac{dT}{dt}, \\frac{dE}{dt}]$。\n2.  如上所述定义两个事件函数，并适当地设置它们的 `terminal` 和 `direction` 属性。\n3.  将积分时间范围设置为从 $t=0$ 到 $t=t_{\\text{max}} = 180$ 天。\n4.  使用导数函数、时间范围、初始条件 $(T_0, E_0)$、模型参数和事件函数列表调用 `solve_ivp`。我们使用 `LSODA` 方法，这是一种备受推崇的自适应求解器，适用于非刚性和刚性问题，并启用 `dense_output=True` 以实现精确的事件定位。\n5.  积分后，我们检查求解器的状态。如果触发了事件，求解器会终止，事件时间是解输出中的最后一个时间点 `sol.t[-1]`。该值四舍五入到两位小数。\n6.  如果在时间范围 $[0, t_{\\text{max}}]$ 内没有触发事件，求解器将完成整个区间的计算。在这种情况下，我们报告哨兵值 $-1.0$。\n\n此过程被系统地应用于四个测试用例中的每一个，以生成最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves a system of ODEs modeling CAR-T cell and tumor dynamics\n    to find the earliest time of tumor eradication or regrowth.\n    \"\"\"\n    # Define global constants and thresholds\n    K = 1.0e9  # cells, tumor carrying capacity\n    T_erad = 1.0  # cells, eradication threshold\n    T_reg = 0.8 * K  # cells, regrowth threshold\n    t_max = 180.0  # days, simulation horizon\n\n    # Test suite: (r, kappa, alpha, delta, T0, E0)\n    test_cases = [\n        # Case 1 (anticipated eradication)\n        (0.03, 1e-9, 5e-9, 0.10, 1e8, 5e7),\n        # Case 2 (anticipated regrowth)\n        (0.04, 1e-10, 1e-9, 0.20, 1e8, 1e6),\n        # Case 3 (no event within horizon)\n        (0.001, 5e-11, 5e-10, 0.05, 1e8, 1e5),\n        # Case 4 (borderline dynamics)\n        (0.03, 5e-10, 3e-9, 0.20, 1e8, 1e7),\n    ]\n\n    results = []\n\n    def model(t, y, r, kappa, alpha, delta, K_val):\n        \"\"\"\n        Defines the coupled ODE system for tumor (T) and CAR-T cells (E).\n        y = [T, E]\n        \"\"\"\n        T, E = y\n        # Ensure cell counts do not become negative in the numerical solution\n        T = max(0, T)\n        E = max(0, E)\n        \n        dT_dt = r * T * (1 - T / K_val) - kappa * E * T\n        dE_dt = alpha * T * E - delta * E\n        return [dT_dt, dE_dt]\n\n    # Define event for tumor eradication\n    def event_eradication(t, y, r, kappa, alpha, delta, K_val):\n        return y[0] - T_erad\n    event_eradication.terminal = True\n    event_eradication.direction = -1  # Event triggers when T crosses T_erad from above\n\n    # Define event for tumor regrowth\n    def event_regrowth(t, y, r, kappa, alpha, delta, K_val):\n        return y[0] - T_reg\n    event_regrowth.terminal = True\n    event_regrowth.direction = 1  # Event triggers when T crosses T_reg from below\n\n    for params in test_cases:\n        r_case, kappa_case, alpha_case, delta_case, T0_case, E0_case = params\n        \n        y0 = [T0_case, E0_case]\n        t_span = (0, t_max)\n        \n        # Package arguments for the model and event functions\n        args = (r_case, kappa_case, alpha_case, delta_case, K)\n\n        sol = solve_ivp(\n            fun=model,\n            t_span=t_span,\n            y0=y0,\n            method='LSODA',  # General-purpose solver for stiff/non-stiff problems\n            args=args,\n            events=[event_eradication, event_regrowth],\n            dense_output=True, # Recommended for accurate event location\n        )\n\n        # sol.status == 1 indicates that a terminal event was triggered\n        if sol.status == 1 and sol.t_events and any(len(e) > 0 for e in sol.t_events):\n            # The integration stops at the first terminal event.\n            # The time of this event is the last time point in the solution.\n            event_time = sol.t[-1]\n            results.append(round(event_time, 2))\n        else:\n            # No event occurred within the simulation horizon\n            results.append(-1.0)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}