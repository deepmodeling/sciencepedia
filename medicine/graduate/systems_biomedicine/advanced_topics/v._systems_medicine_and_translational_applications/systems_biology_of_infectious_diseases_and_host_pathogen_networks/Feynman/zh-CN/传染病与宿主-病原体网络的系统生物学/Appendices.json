{
    "hands_on_practices": [
        {
            "introduction": "本练习将我们的研究立足于感染的分子层面图谱，从一个简单的相互作用列表转向一个定量的网络表示。通过分析一个假设的宿主-病原体相互作用网络（HPIN），你将练习计算如度分布等基本网络属性，并构建一个单模投影。这些都是从复杂生物数据中揭示模式，并理解病原体如何系统性地劫持宿主细胞功能的关键技能。",
            "id": "4390326",
            "problem": "在传染病的系统生物学中，宿主-病原体相互作用网络量化了宿主蛋白如何与病原体蛋白相互作用。考虑一个二分宿主-病原体相互作用网络 (HPIN)，其宿主集合大小为 $|H|=4$，病原体集合大小为 $|P|=3$，以及一个二元相互作用矩阵 $B \\in \\{0,1\\}^{4 \\times 3}$，其中 $B_{i\\alpha}=1$ 表示宿主 $H_i$ 和病原体 $P_\\alpha$ 之间存在相互作用，而 $B_{i\\alpha}=0$ 表示不存在。令\n$$\nB=\\begin{pmatrix}\n1 & 0 & 1\\\\\n0 & 1 & 1\\\\\n1 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n仅使用二分图中度的基本定义和二元向量间的余弦相似度，执行以下操作：\n\n1.  用 $B$ 定义宿主度 $k^{(H)}_i$ 和病原体度 $k^{(P)}_\\alpha$，并计算给定 $B$ 的宿主度分布和病原体度分布。\n\n2.  使用 $B$ 的行向量间的余弦相似度构建加权单模宿主投影矩阵 $S \\in \\mathbb{R}^{4 \\times 4}$，其元素为\n$$\ns_{ij}=\\begin{cases}\n\\dfrac{\\sum_{\\alpha=1}^{3} B_{i\\alpha}B_{j\\alpha}}{\\sqrt{\\sum_{\\alpha=1}^{3} B_{i\\alpha}}\\sqrt{\\sum_{\\alpha=1}^{3} B_{j\\alpha}}}, & i \\neq j \\\\\n0, & i=j\n\\end{cases}\n$$\n其中分子是二元相互作用概况的点积，分母是欧几里得范数的乘积。\n\n最后，计算所有满足 $i<j$ 的 $s_{ij}$ 值的平均值。",
            "solution": "首先，我们根据二分图邻接矩阵 $B$ 的定义来计算宿主和病原体节点的度。宿主 $H_i$ 的度 $k^{(H)}_i$ 是矩阵 $B$ 第 $i$ 行的元素之和。病原体 $P_\\alpha$ 的度 $k^{(P)}_\\alpha$ 是矩阵 $B$ 第 $\\alpha$ 列的元素之和。\n$$k^{(H)}_i = \\sum_{\\alpha=1}^{3} B_{i\\alpha}, \\quad k^{(P)}_\\alpha = \\sum_{i=1}^{4} B_{i\\alpha}$$\n\n**1. 计算度分布**\n\n计算宿主度：\n-   $k^{(H)}_1 = 1+0+1 = 2$\n-   $k^{(H)}_2 = 0+1+1 = 2$\n-   $k^{(H)}_3 = 1+1+0 = 2$\n-   $k^{(H)}_4 = 0+0+1 = 1$\n宿主度集为 $\\{1, 2, 2, 2\\}$。\n\n计算病原体度：\n-   $k^{(P)}_1 = 1+0+1+0 = 2$\n-   $k^{(P)}_2 = 0+1+1+0 = 2$\n-   $k^{(P)}_3 = 1+1+0+1 = 3$\n病原体度集为 $\\{2, 2, 3\\}$。\n\n**2. 计算单模投影相似度**\n\n接下来，我们计算单模宿主投影矩阵 $S$ 中所有 $i < j$ 的元素 $s_{ij}$。该值是宿主 $i$ 和 $j$ 的相互作用向量（即矩阵 $B$ 的行向量）之间的余弦相似度。\n$$s_{ij} = \\frac{B_i \\cdot B_j}{\\|B_i\\|_2 \\|B_j\\|_2} = \\frac{\\sum_{\\alpha} B_{i\\alpha}B_{j\\alpha}}{\\sqrt{k^{(H)}_i} \\sqrt{k^{(H)}_j}}$$\n其中 $B_i$ 是矩阵 $B$ 的第 $i$ 行。\n\n-   $s_{12} = \\frac{(1,0,1) \\cdot (0,1,1)}{\\sqrt{2}\\sqrt{2}} = \\frac{0+0+1}{2} = \\frac{1}{2}$\n-   $s_{13} = \\frac{(1,0,1) \\cdot (1,1,0)}{\\sqrt{2}\\sqrt{2}} = \\frac{1+0+0}{2} = \\frac{1}{2}$\n-   $s_{14} = \\frac{(1,0,1) \\cdot (0,0,1)}{\\sqrt{2}\\sqrt{1}} = \\frac{0+0+1}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$\n-   $s_{23} = \\frac{(0,1,1) \\cdot (1,1,0)}{\\sqrt{2}\\sqrt{2}} = \\frac{0+1+0}{2} = \\frac{1}{2}$\n-   $s_{24} = \\frac{(0,1,1) \\cdot (0,0,1)}{\\sqrt{2}\\sqrt{1}} = \\frac{0+0+1}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}}$\n-   $s_{34} = \\frac{(1,1,0) \\cdot (0,0,1)}{\\sqrt{2}\\sqrt{1}} = \\frac{0+0+0}{\\sqrt{2}} = 0$\n\n**3. 计算平均相似度**\n\n最后，我们计算所有满足 $i < j$ 的 $s_{ij}$ 值的平均值。共有 $\\binom{4}{2} = \\frac{4 \\times 3}{2} = 6$ 个这样的值。\n$$\\text{平均值} = \\frac{1}{6} \\sum_{i<j} s_{ij} = \\frac{1}{6} (s_{12} + s_{13} + s_{14} + s_{23} + s_{24} + s_{34})$$\n$$\\text{平均值} = \\frac{1}{6} \\left( \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{\\sqrt{2}} + \\frac{1}{2} + \\frac{1}{\\sqrt{2}} + 0 \\right)$$\n$$\\text{平均值} = \\frac{1}{6} \\left( \\frac{3}{2} + \\frac{2}{\\sqrt{2}} \\right) = \\frac{1}{6} \\left( \\frac{3}{2} + \\sqrt{2} \\right)$$\n将表达式通分，得到：\n$$\\text{平均值} = \\frac{3/2 + \\sqrt{2}}{6} = \\frac{3 + 2\\sqrt{2}}{12}$$",
            "answer": "$$\n\\boxed{\\frac{3+2\\sqrt{2}}{12}}\n$$"
        },
        {
            "introduction": "在静态网络视图的基础上，我们现在将探讨宿主体内感染随时间演变的动态过程，这是连接分子相互作用与疾病表型的桥梁。此问题介绍了一个经典的靶细胞限制模型，它是病毒数学模型的基石，通过一组常微分方程（ODEs）来描述。通过推导和计算基本再生数（$R_0$）和初始病毒增长率，你将亲身体验决定感染能否建立及其进展速度的核心概念。",
            "id": "4390304",
            "problem": "考虑一个标准的靶细胞限制的宿主内病毒动力学模型，该模型描述了在一个体积为 $1$ 毫升的充分混合区室内的急性感染，其中细胞和病毒粒子的密度单位为每毫升。令 $T(t)$ 表示易感靶细胞的浓度（细胞/毫升），$I(t)$ 表示已感染细胞的浓度（细胞/毫升），$V(t)$ 表示游离病毒粒子的浓度（病毒粒子/毫升）。该模型由以下常微分方程组控制：\n$$\n\\frac{dT}{dt} = \\lambda - d\\,T - \\beta\\,T\\,V,\\quad\n\\frac{dI}{dt} = \\beta\\,T\\,V - \\delta\\,I,\\quad\n\\frac{dV}{dt} = p\\,I - c\\,V,\n$$\n其中 $\\lambda$ 是靶细胞生成率（细胞/毫升/天），$d$ 是靶细胞的自然死亡率（天$^{-1}$），$\\beta$ 是质量作用感染系数（毫升/天/病毒粒子），$p$ 是每个已感染细胞的病毒粒子产生率（病毒粒子/天/细胞），$c$ 是病毒粒子清除率（天$^{-1}$），$\\delta$ 是已感染细胞的死亡率（天$^{-1}$）。假设在感染早期阶段，$T(t)$ 保持在其无感染稳态 $T_{0}$ 附近。\n\n从该模型和第一性原理出发，推导基本再生数 $R_{0}$（定义为将单个已感染细胞引入一个靶细胞浓度为 $T_{0}$ 的宿主后，该细胞产生的预期新感染细胞数）以及病毒粒子浓度 $V(t)$ 的初始指数增长率（定义为在 $T = T_{0}$ 时线性化的 $(I,V)$ 子系统的主特征值）。然后，使用参数值 $\\lambda = 10^{5}$ 细胞/毫升/天，$d = 0.1$ 天$^{-1}$，$\\beta = 2 \\times 10^{-7}$ 毫升/天/病毒粒子，$p = 500$ 病毒粒子/天/细胞，$c = 5$ 天$^{-1}$，以及 $\\delta = 0.5$ 天$^{-1}$，计算 $R_{0}$（无量纲）的数值和 $V(t)$ 的初始指数增长率（单位为天$^{-1}$）。将两个报告的数值均四舍五入至四位有效数字，并以天$^{-1}$ 为单位表示增长率。",
            "solution": "该问题提供了一个标准的靶细胞限制病毒动力学模型，并要求推导和计算基本再生数 $R_0$ 和初始病毒增长率。该问题提法明确，具有科学依据，并包含获得唯一解所需的所有信息。\n\n常微分方程组如下：\n$$\n\\frac{dT}{dt} = \\lambda - d\\,T - \\beta\\,T\\,V\n$$\n$$\n\\frac{dI}{dt} = \\beta\\,T\\,V - \\delta\\,I\n$$\n$$\n\\frac{dV}{dt} = p\\,I - c\\,V\n$$\n其中 $T(t)$，$I(t)$ 和 $V(t)$ 分别是易感靶细胞、已感染细胞和游离病毒粒子的浓度。参数 $\\lambda$、$d$、$\\beta$、$p$、$c$ 和 $\\delta$ 已在问题描述中定义。\n\n首先，我们确定无感染稳态。这是没有感染时的平衡点，即 $I=0$ 且 $V=0$。在第一个方程中令 $\\frac{dT}{dt} = 0$、$I=0$ 和 $V=0$，得到：\n$$\n0 = \\lambda - d\\,T_0\n$$\n求解靶细胞的稳态浓度 $T_0$，我们发现：\n$$\nT_0 = \\frac{\\lambda}{d}\n$$\n\n接下来，我们使用所提供的第一性原理定义来推导基本再生数 $R_0$：将单个已感染细胞引入一个易感靶细胞浓度为 $T_0$ 的群体中，所产生的预期新感染细胞数。我们可以追踪引入一个已感染细胞的后果。\n1.  一个已感染细胞 $I$ 以单个细胞速率 $\\delta$被清除。因此，单个已感染细胞的平均寿命是 $\\frac{1}{\\delta}$。\n2.  一个已感染细胞以速率 $p$ 产生病毒粒子。在其整个寿命中，单个已感染细胞平均总共会产生 $p \\times \\frac{1}{\\delta} = \\frac{p}{\\delta}$ 个病毒粒子。\n3.  这些新产生的病毒粒子 $V$ 以单个病毒粒子速率 $c$ 被清除。因此，一个游离病毒粒子的平均寿命是 $\\frac{1}{c}$。\n4.  在其寿命期间，每个病毒粒子都可以感染易感细胞。在一个易感细胞浓度为 $T_0$ 的群体中，单个病毒粒子导致新感染的速率是 $\\beta T_0$。\n5.  单个病毒粒子在其平均寿命内感染的新细胞总数是感染速率乘以其寿命：$(\\beta T_0) \\times \\frac{1}{c} = \\frac{\\beta T_0}{c}$。\n6.  基本再生数 $R_0$ 是由单个初始感染细胞产生的二次感染总数。这是初始细胞产生的病毒粒子总数与每个病毒粒子产生的新感染数之积。\n$$\nR_0 = \\left(\\text{每个已感染细胞产生的病毒粒子数}\\right) \\times \\left(\\text{每个病毒粒子的感染数}\\right) = \\left(\\frac{p}{\\delta}\\right) \\times \\left(\\frac{\\beta T_0}{c}\\right) = \\frac{\\beta p T_0}{c \\delta}\n$$\n代入 $T_0 = \\frac{\\lambda}{d}$ 的表达式，我们得到 $R_0$ 关于模型参数的最终表达式：\n$$\nR_0 = \\frac{\\beta p \\lambda}{c d \\delta}\n$$\n\n接下来，我们推导感染的初始指数增长率。问题将其定义为线性化的 $(I,V)$ 子系统的主特征值，假设靶细胞群体保持恒定在 $T(t) \\approx T_0$。感染区室的子系统是：\n$$\n\\frac{dI}{dt} = \\beta\\,T_0\\,V - \\delta\\,I\n$$\n$$\n\\frac{dV}{dt} = p\\,I - c\\,V\n$$\n这是一个线性常微分方程组。我们可以将其写成矩阵形式 $\\frac{d\\mathbf{x}}{dt} = J\\mathbf{x}$，其中 $\\mathbf{x} = \\begin{pmatrix} I \\\\ V \\end{pmatrix}$，$J$ 是在无感染平衡点 $(T_0, 0, 0)$ 处求值的感染子系统的雅可比矩阵：\n$$\nJ = \\begin{pmatrix} -\\delta  \\beta T_0 \\\\ p  -c \\end{pmatrix}\n$$\n指数增长率是矩阵 $J$ 的一个特征值 $r$。特征值是特征方程 $\\det(J - rI) = 0$ 的根，其中 $I$ 是单位矩阵。\n$$\n\\det\\begin{pmatrix} -\\delta - r  \\beta T_0 \\\\ p  -c - r \\end{pmatrix} = 0\n$$\n$$\n(-\\delta - r)(-c - r) - p \\beta T_0 = 0\n$$\n$$\nr^2 + (\\delta + c)r + \\delta c - p \\beta T_0 = 0\n$$\n我们使用二次公式求解这个关于 $r$ 的二次方程：\n$$\nr = \\frac{-(\\delta + c) \\pm \\sqrt{(\\delta + c)^2 - 4(1)(\\delta c - p \\beta T_0)}}{2}\n$$\n$$\nr = \\frac{-(\\delta + c) \\pm \\sqrt{(\\delta - c)^2 + 4 p \\beta T_0}}{2}\n$$\n初始指数增长率是主（较大的）特征值，对应于“+”号。令其为 $r_{dom}$：\n$$\nr_{dom} = \\frac{-(\\delta + c) + \\sqrt{(\\delta - c)^2 + 4 p \\beta T_0}}{2}\n$$\n代入 $T_0 = \\frac{\\lambda}{d}$：\n$$\nr_{dom} = \\frac{-(\\delta + c) + \\sqrt{(\\delta - c)^2 + 4 p \\beta \\frac{\\lambda}{d}}}{2}\n$$\n\n现在，我们使用给定的参数计算数值：\n$\\lambda = 10^{5}$ 细胞/毫升/天，$d = 0.1$ 天$^{-1}$，$\\beta = 2 \\times 10^{-7}$ 毫升/天/病毒粒子，$p = 500$ 病毒粒子/天/细胞，$c = 5$ 天$^{-1}$，以及 $\\delta = 0.5$ 天$^{-1}$。\n\n首先，我们计算 $T_0$：\n$$\nT_0 = \\frac{\\lambda}{d} = \\frac{10^5}{0.1} = 10^6 \\text{ 细胞/毫升}\n$$\n\n接下来，我们计算 $R_0$：\n$$\nR_0 = \\frac{\\beta p \\lambda}{c d \\delta} = \\frac{(2 \\times 10^{-7}) (500) (10^5)}{(5)(0.1)(0.5)} = \\frac{10}{0.25} = 40\n$$\n四舍五入到四位有效数字，$R_0 = 40.00$。\n\n最后，我们计算初始增长率 $r_{dom}$：\n$$\nr_{dom} = \\frac{-(\\delta + c) + \\sqrt{(\\delta - c)^2 + 4 p \\beta T_0}}{2}\n$$\n我们代入参数值：\n$\\delta + c = 0.5 + 5 = 5.5$\n$\\delta - c = 0.5 - 5 = -4.5$\n$4 p \\beta T_0 = 4 (500) (2 \\times 10^{-7}) (10^6) = 400$\n将这些值代入 $r_{dom}$ 的表达式：\n$$\nr_{dom} = \\frac{-5.5 + \\sqrt{(-4.5)^2 + 400}}{2} = \\frac{-5.5 + \\sqrt{20.25 + 400}}{2} = \\frac{-5.5 + \\sqrt{420.25}}{2}\n$$\n$\\sqrt{420.25} = 20.5$。\n$$\nr_{dom} = \\frac{-5.5 + 20.5}{2} = \\frac{15}{2} = 7.5\n$$\n单位是天$^{-1}$。四舍五入到四位有效数字，增长率为 $7.500$ 天$^{-1}$。\n\n要求的两个值是 $R_0 = 40.00$ 和初始增长率 $r_{dom} = 7.500$ 天$^{-1}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 40.00  7.500 \\end{pmatrix}}$$"
        },
        {
            "introduction": "传染病系统并非一成不变，而是在持续演化，这给治疗和预防带来了巨大挑战。本练习深入探讨病原体的演化动力学，通过量化突变如何相互作用以影响病毒适应度——即所谓的“上位性”（epistasis）概念。利用假设的实验数据，你将估算相对适应度并计算上位性系数，从而将可观察的基因型计数与塑造病毒演化的适应度景观（fitness landscape）的基本原理联系起来。",
            "id": "4390293",
            "problem": "一种单倍体RNA病毒在宿主细胞培养物中复制，其中两个病毒基因座（表示为 $A$ 和 $B$）各有两种等位基因（$0$ 和 $1$）。基因座 $A$ 上的等位基因 $1$ 调节与宿主限制因子的结合，而基因座 $B$ 上的等位基因 $1$ 调节对宿主先天免疫效应子的逃避。您进行了一个单次感染周期的实验，其中四种基因型 $A0B0$、$A1B0$、$A0B1$ 和 $A1B1$ 以相等的初始频率混合，并在恒定环境下传代一次。感染复数（MOI）被控制，使得共感染可以忽略不计，且各基因型独立复制。然后，您对 $9100$ 个病毒基因组进行测序，获得了基因型计数：$A0B0$ 为 $2000$，$A1B0$ 为 $2400$，$A0B1$ 为 $2200$，$A1B1$ 为 $2500$。\n\n假设群体遗传学和系统生物学中存在以下经过充分检验的基础理论：\n- 对于离散时间内的单倍体选择，选择后的基因型频率 $f_{ij}'$ 满足 $f_{ij}' \\propto f_{ij} w_{ij}$，其中 $w_{ij}$ 是基因型 $ij \\in \\{00,10,01,11\\}$ 的每个周期的绝对适应度，比例关系通过平均适应度进行归一化。\n- 当所有基因型的初始频率相等时，选择后的频率与其绝对适应度成正比。\n- 在一个双基因座加性基线模型中，在加性适应度尺度上，基因座 $A$ 和 $B$ 上等位基因 $1$ 的单基因座效应分别表示为 $a$ 和 $b$。上位性系数 $\\epsilon$ 量化了双突变体的适应度与基于单突变体的加性预期之间的偏差。\n\n仅使用这些原理，通过缩放使 $w_{00}=1$ 来估计相对适应度，推断单基因座效应 $a$ 和 $b$，并计算上位性系数 $\\epsilon$。根据 $\\epsilon$ 的符号，在您的推理中说明该相互作用是拮抗性上位性还是协同性上位性。将 $\\epsilon$ 的最终数值答案四舍五入到四位有效数字。$\\epsilon$ 不需要单位。",
            "solution": "该问题要求我们基于单周期选择实验后的基因型计数来估计相对适应度和上位性。\n\n首先，根据问题的设定，由于所有基因型的初始频率相等，选择后的频率与其绝对适应度成正比。因此，最终观测到的基因型计数 $N_{ij}$ 也与绝对适应度 $w_{ij}$ 成正比。\n\n我们可以通过将所有适应度值相对于参考基因型 $A0B0$（表示为 $00$）进行归一化来计算相对适应度 $W_{ij}$。\n$$W_{ij} = \\frac{w_{ij}}{w_{00}} = \\frac{N_{ij}}{N_{00}}$$\n        \n使用给定的计数：\n-   $N_{00} = 2000$ (基因型 $A0B0$)\n-   $N_{10} = 2400$ (基因型 $A1B0$)\n-   $N_{01} = 2200$ (基因型 $A0B1$)\n-   $N_{11} = 2500$ (基因型 $A1B1$)\n\n我们计算出相对适应度：\n-   $W_{00} = \\frac{2000}{2000} = 1$\n-   $W_{10} = \\frac{2400}{2000} = 1.2$\n-   $W_{01} = \\frac{2200}{2000} = 1.1$\n-   $W_{11} = \\frac{2500}{2000} = 1.25$\n\n接下来，我们应用双基因座加性适应度模型。在该模型中，相对适应度由以下公式描述：\n-   $W_{10} = W_{00} + a$\n-   $W_{01} = W_{00} + b$\n-   $W_{11} = W_{00} + a + b + \\epsilon$\n其中，$a$ 和 $b$ 分别是等位基因 $1$ 在基因座 $A$ 和 $B$ 上的单基因座效应，$\\epsilon$ 是上位性系数。\n\n利用我们计算出的相对适应度，我们可以推断出这些参数：\n-   单基因座效应 $a$:\n    $a = W_{10} - W_{00} = 1.2 - 1 = 0.2$\n-   单基因座效应 $b$:\n    $b = W_{01} - W_{00} = 1.1 - 1 = 0.1$\n\n最后，我们计算上位性系数 $\\epsilon$：\n$$\\epsilon = W_{11} - (W_{00} + a + b)$$\n$$\\epsilon = 1.25 - (1 + 0.2 + 0.1) = 1.25 - 1.3 = -0.05$$\n\n由于上位性系数 $\\epsilon = -0.05$ 为负值，这表明两个突变之间的相互作用是**拮抗性上位性**（antagonistic epistasis）。这意味着双突变体的适应度增益小于两个单突变体适应度增益的总和。\n\n问题要求将 $\\epsilon$ 的最终数值答案四舍五入到四位有效数字。计算出的值为 $-0.05$。要表示为四位有效数字，可以写作 $-0.05000$ 或使用科学记数法。\n$$\\epsilon = -5.000 \\times 10^{-2}$$",
            "answer": "$$\\boxed{-5.000 \\times 10^{-2}}$$"
        }
    ]
}