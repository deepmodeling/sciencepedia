{
    "hands_on_practices": [
        {
            "introduction": "The decision for a T cell to attack a target cell is made at the immunological synapse, where a complex balance of stimulatory and inhibitory signals is integrated. Immune checkpoint blockade therapies function by tilting this balance in favor of activation. This first practice provides a quantitative, biophysical model of this process, allowing you to calculate the precise amount of antigenic signal required to trigger a T-cell response under the influence of a PD-1 blocking antibody .",
            "id": "4355764",
            "problem": "A cytotoxic T lymphocyte engages a tumor cell within an immunological synapse. A minimal receptor-level model integrates stimulatory and inhibitory cues to determine whether the T cell surpasses an activation threshold. The three principal membrane-proximal inputs considered are T Cell Receptor (TCR) engagement with peptide–Major Histocompatibility Complex (peptide–MHC), co-stimulation via Cluster of Differentiation 28 (CD28) binding to Cluster of Differentiation 80/86 (CD80/CD86), and inhibition via Programmed Cell Death Protein 1 (PD-1) binding to Programmed Death-Ligand 1 (PD-L1). Assume all bindings occur in two dimensions at the synaptic interface and reach rapid equilibrium relative to signaling.\n\nUse the following foundations:\n- The law of mass action at equilibrium for a receptor–ligand pair in two dimensions: the two-dimensional dissociation constant satisfies $K_{d}^{2D} = \\dfrac{[\\mathrm{R}]_{\\mathrm{free}}[\\mathrm{L}]_{\\mathrm{free}}}{[\\mathrm{RL}]}$, where all bracketed quantities are areal densities.\n- The net dimensionless signaling input is modeled as $S = w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$, where $\\theta_{\\mathrm{X}}$ denotes the fractional occupancy of receptor $\\mathrm{X}$ and $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$ is the effective inhibitory engagement under blockade.\n\nExperimental co-administration of a PD-1 blocking antibody renders a fraction $b$ of PD-1 receptors unavailable for ligand binding. Model this as $\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = (1-b)\\,\\theta_{\\mathrm{PD1}}$, i.e., blockade reduces the effective inhibitory engagement proportionally to the fraction of unblocked receptors. The T cell activates when $S$ equals an activation threshold $\\Theta_{\\mathrm{act}}$.\n\nAssume:\n- The peptide–MHC areal density on the tumor membrane is $A$ (unknown, in molecules per $\\mu\\mathrm{m}^{2}$).\n- The CD80 areal density on the tumor membrane is $B = 60$ molecules per $\\mu\\mathrm{m}^{2}$.\n- The PD-L1 areal density on the tumor membrane is $P = 100$ molecules per $\\mu\\mathrm{m}^{2}$.\n- Two-dimensional dissociation constants: $K_{d,\\mathrm{TCR}}^{2D} = 80$ molecules per $\\mu\\mathrm{m}^{2}$, $K_{d,\\mathrm{CD28}}^{2D} = 40$ molecules per $\\mu\\mathrm{m}^{2}$, $K_{d,\\mathrm{PD1}}^{2D} = 50$ molecules per $\\mu\\mathrm{m}^{2}$.\n- Weights: $w_{\\mathrm{TCR}} = 1.0$, $w_{\\mathrm{CD28}} = 0.5$, $w_{\\mathrm{PD1}} = 0.8$.\n- PD-1 blockade fraction: $b = 0.75$.\n- Activation threshold: $\\Theta_{\\mathrm{act}} = 0.7$.\n\nAssume ligand depletion by binding is negligible at the synapse for each pairwise interaction. Starting from the equilibrium definition of the dissociation constant and the stated signal integration model, determine the minimal peptide–MHC areal density $A^{\\ast}$ such that $S = \\Theta_{\\mathrm{act}}$ at steady state. Express your final answer as a single real number in molecules per $\\mu\\mathrm{m}^{2}$, and round your answer to four significant figures.",
            "solution": "The goal is to find the minimal peptide–MHC areal density, which we will denote as $A^{\\ast}$, that satisfies the T-cell activation condition $S = \\Theta_{\\mathrm{act}}$. The total signal $S$ is given by the linear integration model:\n$$S = w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}}$$\nThe activation condition is therefore:\n$$w_{\\mathrm{TCR}}\\,\\theta_{\\mathrm{TCR}} + w_{\\mathrm{CD28}}\\,\\theta_{\\mathrm{CD28}} - w_{\\mathrm{PD1}}\\,\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = \\Theta_{\\mathrm{act}}$$\nOur first step is to express the fractional occupancies $\\theta_{\\mathrm{X}}$ in terms of the given parameters. The fractional occupancy of a receptor $\\mathrm{R}$ is defined as $\\theta_{\\mathrm{R}} = \\frac{[\\mathrm{RL}]}{[\\mathrm{R}]_{\\mathrm{total}}}$, where $[\\mathrm{R}]_{\\mathrm{total}} = [\\mathrm{R}]_{\\mathrm{free}} + [\\mathrm{RL}]$. From the law of mass action, $K_{d}^{2D} = \\frac{[\\mathrm{R}]_{\\mathrm{free}}[\\mathrm{L}]_{\\mathrm{free}}}{[\\mathrm{RL}]}$, we can write $[\\mathrm{R}]_{\\mathrm{free}} = \\frac{K_{d}^{2D}[\\mathrm{RL}]}{[\\mathrm{L}]_{\\mathrm{free}}}$.\n\nSubstituting this into the total receptor concentration gives:\n$$[\\mathrm{R}]_{\\mathrm{total}} = \\frac{K_{d}^{2D}[\\mathrm{RL}]}{[\\mathrm{L}]_{\\mathrm{free}}} + [\\mathrm{RL}] = [\\mathrm{RL}] \\left( \\frac{K_{d}^{2D}}{[\\mathrm{L}]_{\\mathrm{free}}} + 1 \\right) = [\\mathrm{RL}] \\frac{K_{d}^{2D} + [\\mathrm{L}]_{\\mathrm{free}}}{[\\mathrm{L}]_{\\mathrm{free}}}$$\nRearranging to find the fractional occupancy $\\theta_{\\mathrm{R}} = \\frac{[\\mathrm{RL}]}{[\\mathrm{R}]_{\\mathrm{total}}}$:\n$$\\theta_{\\mathrm{R}} = \\frac{[\\mathrm{L}]_{\\mathrm{free}}}{K_{d}^{2D} + [\\mathrm{L}]_{\\mathrm{free}}}$$\nThe problem states that we can assume ligand depletion is negligible. This implies that the free ligand concentration is approximately equal to the total ligand concentration, i.e., $[\\mathrm{L}]_{\\mathrm{free}} \\approx [\\mathrm{L}]_{\\mathrm{total}}$. For each receptor-ligand pair, we can use the total ligand areal density in the formula for $\\theta$.\n\nLet's calculate the fractional occupancies for the co-stimulatory and inhibitory receptors.\n\nFor the CD28-CD80 interaction:\nThe ligand is CD80, with total areal density $B = 60$. The dissociation constant is $K_{d,\\mathrm{CD28}}^{2D} = 40$.\n$$\\theta_{\\mathrm{CD28}} = \\frac{B}{K_{d,\\mathrm{CD28}}^{2D} + B} = \\frac{60}{40 + 60} = \\frac{60}{100} = 0.6$$\n\nFor the PD-1-PD-L1 interaction:\nThe ligand is PD-L1, with total areal density $P = 100$. The dissociation constant is $K_{d,\\mathrm{PD1}}^{2D} = 50$.\n$$\\theta_{\\mathrm{PD1}} = \\frac{P}{K_{d,\\mathrm{PD1}}^{2D} + P} = \\frac{100}{50 + 100} = \\frac{100}{150} = \\frac{2}{3}$$\nThe effective inhibitory signal is modulated by the blocking antibody fraction $b = 0.75$.\n$$\\theta_{\\mathrm{PD1}}^{\\mathrm{eff}} = (1-b)\\,\\theta_{\\mathrm{PD1}} = (1 - 0.75) \\left(\\frac{2}{3}\\right) = (0.25) \\left(\\frac{2}{3}\\right) = \\frac{1}{4} \\cdot \\frac{2}{3} = \\frac{2}{12} = \\frac{1}{6}$$\nNow, we substitute these values, along with the given weights and activation threshold, into the activation condition equation to solve for the required TCR fractional occupancy, $\\theta_{\\mathrm{TCR}}$.\n$w_{\\mathrm{TCR}} = 1.0$, $w_{\\mathrm{CD28}} = 0.5$, $w_{\\mathrm{PD1}} = 0.8$, $\\Theta_{\\mathrm{act}} = 0.7$.\n$$(1.0)\\,\\theta_{\\mathrm{TCR}} + (0.5)(0.6) - (0.8)\\left(\\frac{1}{6}\\right) = 0.7$$\n$$\\theta_{\\mathrm{TCR}} + 0.3 - \\frac{0.8}{6} = 0.7$$\nLet's work with fractions to maintain precision. $0.3 = \\frac{3}{10}$, $0.8 = \\frac{8}{10} = \\frac{4}{5}$, and $0.7 = \\frac{7}{10}$.\n$$\\theta_{\\mathrm{TCR}} + \\frac{3}{10} - \\left(\\frac{4}{5} \\cdot \\frac{1}{6}\\right) = \\frac{7}{10}$$\n$$\\theta_{\\mathrm{TCR}} + \\frac{3}{10} - \\frac{4}{30} = \\frac{7}{10}$$\n$$\\theta_{\\mathrm{TCR}} + \\frac{3}{10} - \\frac{2}{15} = \\frac{7}{10}$$\nNow, we isolate $\\theta_{\\mathrm{TCR}}$:\n$$\\theta_{\\mathrm{TCR}} = \\frac{7}{10} - \\frac{3}{10} + \\frac{2}{15} = \\frac{4}{10} + \\frac{2}{15} = \\frac{2}{5} + \\frac{2}{15}$$\nTo add these fractions, we find a common denominator, which is $15$.\n$$\\theta_{\\mathrm{TCR}} = \\frac{2 \\cdot 3}{5 \\cdot 3} + \\frac{2}{15} = \\frac{6}{15} + \\frac{2}{15} = \\frac{8}{15}$$\nFinally, we find the peptide–MHC areal density, $A^{\\ast}$, that gives this required TCR occupancy. The ligand for TCR is peptide–MHC, with density $A$.\n$$\\theta_{\\mathrm{TCR}} = \\frac{A^{\\ast}}{K_{d,\\mathrm{TCR}}^{2D} + A^{\\ast}}$$\nWe have $\\theta_{\\mathrm{TCR}} = \\frac{8}{15}$ and $K_{d,\\mathrm{TCR}}^{2D} = 80$.\n$$\\frac{8}{15} = \\frac{A^{\\ast}}{80 + A^{\\ast}}$$\nWe solve for $A^{\\ast}$ by cross-multiplication:\n$$8(80 + A^{\\ast}) = 15 A^{\\ast}$$\n$$640 + 8 A^{\\ast} = 15 A^{\\ast}$$\n$$640 = 15 A^{\\ast} - 8 A^{\\ast}$$\n$$640 = 7 A^{\\ast}$$\n$$A^{\\ast} = \\frac{640}{7}$$\nThe problem asks for a real number rounded to four significant figures.\n$$A^{\\ast} \\approx 91.42857...$$\nRounding to four significant figures gives:\n$$A^{\\ast} \\approx 91.43$$\nThe minimal peptide–MHC areal density required for T-cell activation under these conditions is $91.43$ molecules per $\\mu\\mathrm{m}^{2}$.",
            "answer": "$$\\boxed{91.43}$$"
        },
        {
            "introduction": "Building on the principles of single-cell signaling, we now scale up to model the effect of therapies on an entire tumor population. A key question in oncology is whether combining two drugs produces an effect greater than what would be expected from their individual activities—a phenomenon known as synergy. This exercise guides you through calculating the Bliss independence synergy score for a combination of anti-PD-1 and anti-CTLA-4 antibodies, providing a standard framework to quantify therapeutic interactions within a mechanistic model .",
            "id": "4355759",
            "problem": "Consider a mechanistic model of tumor cell population dynamics under immune checkpoint blockade combination therapy in systems biomedicine. Tumor cells undergo exponential dynamics described by the ordinary differential equation $dN/dt = \\lambda(c_A,c_B)\\,N$, where $N$ is the tumor cell count and $\\lambda(c_A,c_B)$ is the net per-capita rate given by $\\lambda(c_A,c_B) = r - k(c_A,c_B)$. The parameter $r$ is the tumor cell proliferation rate and $k(c_A,c_B)$ is the effective immune-mediated killing rate that depends on the doses $c_A$ and $c_B$ of two monoclonal antibodies: anti-Programmed cell death protein 1 (PD-1) and anti-Cytotoxic T-lymphocyte-associated protein 4 (CTLA-4), respectively.\n\nAssume that antibody binding follows mass-action equilibrium. Let $K_A$ and $K_B$ be the dissociation constants for antibody binding to PD-1 and CTLA-4, respectively. The fraction of inhibitory signaling remaining after blockade is modeled by $s_P(c_A) = \\frac{K_A}{K_A + c_A}$ for PD-1 and $s_C(c_B) = \\frac{K_B}{K_B + c_B}$ for CTLA-4. The inhibitory signals multiplicatively attenuate the baseline killing potential $k_0$ according to\n$$\nk(c_A,c_B) = k_0 \\left(1 - \\sigma_P\\,s_P(c_A)\\right)\\left(1 - \\sigma_C\\,s_C(c_B)\\right),\n$$\nwhere $\\sigma_P \\in (0,1)$ and $\\sigma_C \\in (0,1)$ quantify the fractional suppressive strengths of PD-1 and CTLA-4 signaling on cytotoxic T cell killing, respectively. In the absence of antibody, use $s_P(0) = 1$ and $s_C(0) = 1$.\n\nDefine the relative viability at time $T$ under a dosing condition $(c_A,c_B)$ as the ratio of the treated population to the untreated control population at the same $T$:\n$$\nv(c_A,c_B) = \\frac{N(T; c_A,c_B)}{N(T; 0,0)}.\n$$\nAssume the no-interaction baseline for combination therapy is statistical independence of survival fractions, so that the expected combined viability equals the product of single-agent viabilities. Let the Bliss independence synergy on the viability scale be the deviation of the observed combined viability from this independence baseline:\n$$\n\\epsilon = v(c_A,c_B) - v(c_A,0)\\,v(0,c_B).\n$$\n\nUse the parameter values $r = 0.03$ day$^{-1}$, $k_0 = 0.05$ day$^{-1}$, $\\sigma_P = 0.6$, $\\sigma_C = 0.5$, $K_A = 10$ mg/L, $K_B = 5$ mg/L, $c_A = 10$ mg/L, $c_B = 15$ mg/L, and $T = 30$ days. Compute $\\epsilon$ and express your final answer as a dimensionless decimal. Round your answer to four significant figures.",
            "solution": "The core of the problem is to solve the ordinary differential equation (ODE) for tumor cell population dynamics and then use this solution to compute a synergy metric.\n\nThe governing ODE is $dN/dt = \\lambda(c_A,c_B)N$, where $N$ is the tumor cell count and $\\lambda(c_A,c_B)$ is the net growth rate, which is constant for fixed drug concentrations $c_A$ and $c_B$. This is a linear first-order ODE with the general solution:\n$$\nN(t) = N(0) \\exp(\\lambda(c_A,c_B) t)\n$$\nwhere $N(0)$ is the initial a tumor cell count at $t=0$.\n\nThe relative viability $v(c_A,c_B)$ at time $T$ is defined as the ratio of the tumor cell count in the treated condition $(c_A,c_B)$ to the count in the untreated condition $(0,0)$:\n$$\nv(c_A,c_B) = \\frac{N(T; c_A,c_B)}{N(T; 0,0)} = \\frac{N(0) \\exp(\\lambda(c_A,c_B) T)}{N(0) \\exp(\\lambda(0,0) T)}\n$$\nThe initial cell count $N(0)$ cancels out, yielding:\n$$\nv(c_A,c_B) = \\exp\\left( \\left[ \\lambda(c_A,c_B) - \\lambda(0,0) \\right] T \\right)\n$$\nThe net growth rate is given by $\\lambda(c_A,c_B) = r - k(c_A,c_B)$. Substituting this into the expression for viability gives:\n$$\n\\lambda(c_A,c_B) - \\lambda(0,0) = \\left( r - k(c_A,c_B) \\right) - \\left( r - k(0,0) \\right) = k(0,0) - k(c_A,c_B)\n$$\nSo, the viability can be expressed in terms of the killing rates:\n$$\nv(c_A,c_B) = \\exp\\left( \\left[ k(0,0) - k(c_A,c_B) \\right] T \\right)\n$$\nThe problem asks for the Bliss independence synergy, $\\epsilon$, defined as:\n$$\n\\epsilon = v(c_A,c_B) - v(c_A,0)\\,v(0,c_B)\n$$\nTo compute $\\epsilon$, we must first calculate the values of the three viability terms: $v(c_A,c_B)$, $v(c_A,0)$, and $v(0,c_B)$. This requires calculating the corresponding killing rates $k$ for four conditions: combination therapy $(c_A,c_B)$, monotherapy A $(c_A,0)$, monotherapy B $(0,c_B)$, and untreated control $(0,0)$.\n\nThe killing rate is given by:\n$$\nk(c_A,c_B) = k_0 \\left(1 - \\sigma_P\\,s_P(c_A)\\right)\\left(1 - \\sigma_C\\,s_C(c_B)\\right)\n$$\nwhere $s_P(c_A) = \\frac{K_A}{K_A + c_A}$ and $s_C(c_B) = \\frac{K_B}{K_B + c_B}$. In the absence of drugs, $c_A=0$ and $c_B=0$, so $s_P(0)=1$ and $s_C(0)=1$.\n\nWe are given the following parameter values:\n$r = 0.03$ day$^{-1}$\n$k_0 = 0.05$ day$^{-1}$\n$\\sigma_P = 0.6$\n$\\sigma_C = 0.5$\n$K_A = 10$ mg/L\n$K_B = 5$ mg/L\n$c_A = 10$ mg/L\n$c_B = 15$ mg/L\n$T = 30$ days\n\nFirst, we calculate the remaining signaling fractions, $s_P(c_A)$ and $s_C(c_B)$:\n$$\ns_P(c_A) = \\frac{10}{10 + 10} = \\frac{10}{20} = 0.5\n$$\n$$\ns_C(c_B) = \\frac{5}{5 + 15} = \\frac{5}{20} = 0.25\n$$\n\nNext, we calculate the four required killing rates:\n1.  Untreated control $(c_A=0, c_B=0)$:\n    $k(0,0) = k_0(1 - \\sigma_P s_P(0))(1 - \\sigma_C s_C(0)) = k_0(1 - \\sigma_P)(1 - \\sigma_C)$\n    $k(0,0) = 0.05 \\times (1 - 0.6) \\times (1 - 0.5) = 0.05 \\times 0.4 \\times 0.5 = 0.01$ day$^{-1}$\n\n2.  Combination therapy $(c_A=10, c_B=15)$:\n    $k(c_A,c_B) = k_0(1 - \\sigma_P s_P(c_A))(1 - \\sigma_C s_C(c_B))$\n    $k(10,15) = 0.05 \\times (1 - 0.6 \\times 0.5) \\times (1 - 0.5 \\times 0.25)$\n    $k(10,15) = 0.05 \\times (1 - 0.3) \\times (1 - 0.125) = 0.05 \\times 0.7 \\times 0.875 = 0.030625$ day$^{-1}$\n\n3.  Monotherapy A $(c_A=10, c_B=0)$:\n    $k(c_A,0) = k_0(1 - \\sigma_P s_P(c_A))(1 - \\sigma_C s_C(0))$\n    $k(10,0) = 0.05 \\times (1 - 0.6 \\times 0.5) \\times (1 - 0.5) = 0.05 \\times 0.7 \\times 0.5 = 0.0175$ day$^{-1}$\n\n4.  Monotherapy B $(c_A=0, c_B=15)$:\n    $k(0,c_B) = k_0(1 - \\sigma_P s_P(0))(1 - \\sigma_C s_C(c_B))$\n    $k(0,15) = 0.05 \\times (1 - 0.6) \\times (1 - 0.5 \\times 0.25) = 0.05 \\times 0.4 \\times 0.875 = 0.0175$ day$^{-1}$\n\nNow we calculate the viability terms using $v = \\exp([k_{control} - k_{treat}] T)$ with $T=30$ days.\n1.  Viability under combination therapy:\n    $v(c_A,c_B) = \\exp([k(0,0) - k(c_A,c_B)]T)$\n    $v(10,15) = \\exp([0.01 - 0.030625] \\times 30) = \\exp(-0.020625 \\times 30) = \\exp(-0.61875)$\n\n2.  Viability under monotherapy A:\n    $v(c_A,0) = \\exp([k(0,0) - k(c_A,0)]T)$\n    $v(10,0) = \\exp([0.01 - 0.0175] \\times 30) = \\exp(-0.0075 \\times 30) = \\exp(-0.225)$\n\n3.  Viability under monotherapy B:\n    $v(0,c_B) = \\exp([k(0,0) - k(0,c_B)]T)$\n    $v(0,15) = \\exp([0.01 - 0.0175] \\times 30) = \\exp(-0.0075 \\times 30) = \\exp(-0.225)$\n\nFinally, we compute the synergy $\\epsilon$:\n$$\n\\epsilon = v(c_A,c_B) - v(c_A,0)\\,v(0,c_B)\n$$\n$$\n\\epsilon = \\exp(-0.61875) - \\exp(-0.225) \\times \\exp(-0.225)\n$$\n$$\n\\epsilon = \\exp(-0.61875) - \\exp(-0.45)\n$$\nUsing a calculator for the numerical values:\n$$\n\\exp(-0.61875) \\approx 0.5386203\n$$\n$$\n\\exp(-0.45) \\approx 0.6376282\n$$\n$$\n\\epsilon \\approx 0.5386203 - 0.6376282 = -0.0990079\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\epsilon \\approx -0.09901\n$$\nThe negative value indicates that on the viability scale, the combination shows antagonism relative to the Bliss independence model, despite the underlying mechanism on the killing rate being synergistic. This is a consequence of the nonlinear mapping from killing rate to viability.",
            "answer": "$$\\boxed{-0.09901}$$"
        },
        {
            "introduction": "A major challenge in the clinical application of immunotherapy is interpreting radiographic scans, where treatment-induced inflammation can mimic tumor growth, a phenomenon called pseudoprogression. Distinguishing this from true disease progression is critical for patient management. This final hands-on practice is a computational exercise where you will build a dynamic model that simulates both viable tumor and inflammatory components, and then apply a classification rule inspired by clinical criteria (RECIST) to identify pseudoprogression from simulated longitudinal data .",
            "id": "4355760",
            "problem": "You are tasked with designing and implementing a program that models radiographic response under immune checkpoint blockade and classifies whether an observed early increase in the measured lesion size represents pseudoprogression rather than true progression, drawing on a mechanistic model consistent with Response Evaluation Criteria in Solid Tumors (RECIST) principles. Build the model and classification rule from first principles and well-tested assumptions as follows.\n\nBase modeling assumptions and definitions:\n- Let the latent viable tumor burden be denoted by $x(t)$, defined as a dimensionless normalized sum of diameters representing viable tumor. Under immune checkpoint blockade, assume logistic growth with immune-mediated cytotoxicity modeled by mass-action interaction with effector activity. Specifically,\n$$\n\\frac{dx}{dt} = r\\,x(t)\\left(1 - \\frac{x(t)}{K}\\right) - k\\,E_{\\mathrm{kill}}(t)\\,x(t),\n$$\nwhere $r$ is the baseline per capita growth rate, $K$ is the carrying capacity, $k$ is the effective kill coefficient, and $E_{\\mathrm{kill}}(t)$ is the time-dependent effector activity induced by checkpoint blockade.\n- Let the inflammatory and edema component be denoted by $y(t)$, representing non-viable tissue changes that can transiently enlarge radiographic size after therapy initiation. Assume this component is driven by an acute infiltration impulse that decays exponentially, and is cleared with first-order kinetics:\n$$\n\\frac{dy}{dt} = \\alpha\\,u(t) - \\beta\\,y(t), \\quad u(t) = u_0\\,e^{-\\lambda t},\n$$\nwhere $\\alpha$ scales infiltration magnitude, $\\beta$ is the clearance rate, and $u_0$ with $\\lambda$ define the amplitude and decay of the acute drive.\n- The effector activity induced by checkpoint blockade increases towards a plateau according to a standard approach-to-steady-state:\n$$\nE_{\\mathrm{kill}}(t) = E_0 + (E_{\\max} - E_0)\\left(1 - e^{-\\gamma t}\\right),\n$$\nwith $E_0$ the pre-therapy baseline, $E_{\\max}$ the maximal activity, and $\\gamma$ the activation rate constant.\n- The measured normalized sum of diameters $S(t)$ (unitless, normalized) combines viable tumor and inflammatory components with additive measurement noise:\n$$\nS(t) = x(t) + c\\,y(t) + \\varepsilon(t), \\quad \\varepsilon(t) \\sim \\mathcal{N}(0,\\sigma^2),\n$$\nwhere $c$ scales the contribution of inflammation to the measured size, and $\\sigma$ is the noise standard deviation.\n\nRECIST-inspired operational definitions for classification:\n- Define the baseline measurement $S_b = S(t_0)$ at the first time point $t_0$.\n- Define a progression threshold factor $\\tau = 0.2$ so that candidate progression at time $t_i$ occurs if $S(t_i) \\geq S_b(1+\\tau)$.\n- Define confirmation of progression if at the subsequent scheduled time point $t_{i+1}$, the inequality $S(t_{i+1}) \\geq S_b(1+\\tau)$ also holds.\n- Define pseudoprogression operationally as: a candidate progression time $t_i$ exists, progression is not confirmed at $t_{i+1}$, and the latent viable tumor burden is non-increasing over the interval, i.e., $x(t_{i+1}) \\leq x(t_i)$.\n\nYour program must:\n1. Implement the system of ordinary differential equations for $x(t)$ and $y(t)$ using the parameters provided in each test case.\n2. Compute $S(t)$ at specified discrete time points by adding independent Gaussian noise with variance $\\sigma^2$ to the deterministic $x(t) + c\\,y(t)$.\n3. Apply the classification rule above to return a boolean indicating pseudoprogression for each test case. If candidate progression occurs at the last available time point so that confirmation is impossible, classify as not pseudoprogression.\n\nTime points:\n- Use the discrete time vector $t = [\\,0,\\,1,\\,2,\\,3,\\,4\\,]$ (unitless time).\n\nTest suite:\nProvide four parameter sets that collectively probe distinct scenarios. All parameters are dimensionless and normalized.\n\n- Test Case A (happy path: pseudoprogression due to transient inflammation with underlying tumor decreasing):\n    - $r = 0.4$, $K = 100$, $k = 0.3$, $E_0 = 0.05$, $E_{\\max} = 0.9$, $\\gamma = 1.5$,\n    - $\\alpha = 1.0$, $\\beta = 2.0$, $u_0 = 100.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: early $S(t)$ crosses $S_b(1+\\tau)$, drops below at the next time point, and $x(t)$ is non-increasing across that interval.\n\n- Test Case B (true progression: sustained increase with minimal inflammation, underlying tumor increasing):\n    - $r = 0.6$, $K = 100$, $k = 0.05$, $E_0 = 0.05$, $E_{\\max} = 0.3$, $\\gamma = 1.0$,\n    - $\\alpha = 1.0$, $\\beta = 2.0$, $u_0 = 5.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: $S(t)$ surpasses $S_b(1+\\tau)$ and remains above at the next time point, with $x(t)$ increasing.\n\n- Test Case C (edge case: unconfirmed candidate progression driven by transient inflammation, but underlying tumor increasing):\n    - $r = 0.5$, $K = 100$, $k = 0.1$, $E_0 = 0.02$, $E_{\\max} = 0.2$, $\\gamma = 1.0$,\n    - $\\alpha = 1.0$, $\\beta = 2.0$, $u_0 = 80.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: $S(t)$ crosses $S_b(1+\\tau)$ then falls below, but $x(t)$ increases; therefore not pseudoprogression.\n\n- Test Case D (boundary: candidate progression occurs only at the last time point, hence cannot be confirmed):\n    - $r = 0.07$, $K = 200$, $k = 0.0$, $E_0 = 0.0$, $E_{\\max} = 0.0$, $\\gamma = 1.0$,\n    - $\\alpha = 0.5$, $\\beta = 2.0$, $u_0 = 5.0$, $\\lambda = 1.0$, $c = 0.6$,\n    - $x(0) = 60.0$, $y(0) = 0.0$, $\\sigma = 0.5$.\n    Expected behavior: $S(t)$ crosses $S_b(1+\\tau)$ only at $t=4$, with no $t=5$ to confirm; therefore not pseudoprogression.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,\\text{result}_1,\\,\\text{result}_2,\\,\\text{result}_3,\\,\\text{result}_4\\,]$), where each $\\text{result}_i$ is a boolean classification for the corresponding test case.\n\nNo physical units are used; all variables are dimensionless or normalized. Angles are not used. Express and compute all quantities as pure numbers, and ensure that the final printed output matches the specified format exactly.",
            "solution": "The problem requires the design and implementation of a computational model to distinguish between pseudoprogression and true progression in cancer immunotherapy, based on a set of coupled ordinary differential equations (ODEs) and RECIST-inspired classification rules.\n\nThe solution proceeds in two main stages: first, numerically solving the system of ODEs for the latent state variables, and second, applying the specified classification logic to the observable, noisy measurements.\n\nThe mathematical model is defined by a system of two first-order ODEs for the latent viable tumor burden, $x(t)$, and the inflammatory component, $y(t)$:\n$$\n\\frac{dx}{dt} = r\\,x(t)\\left(1 - \\frac{x(t)}{K}\\right) - k\\,E_{\\mathrm{kill}}(t)\\,x(t)\n$$\n$$\n\\frac{dy}{dt} = \\alpha\\,u_0\\,e^{-\\lambda t} - \\beta\\,y(t)\n$$\nThe dynamics of $x(t)$ are governed by logistic growth, with a tumor-killing term proportional to the product of the tumor burden and the effector activity, $E_{\\mathrm{kill}}(t)$. The dynamics of $y(t)$ are driven by a transient inflammatory impulse, $u(t) = u_0\\,e^{-\\lambda t}$, and are subject to first-order clearance. The therapy-induced effector activity, $E_{\\mathrm{kill}}(t)$, follows a saturating exponential increase towards a maximum level $E_{\\max}$:\n$$\nE_{\\mathrm{kill}}(t) = E_0 + (E_{\\max} - E_0)\\left(1 - e^{-\\gamma t}\\right)\n$$\nThe observable, the measured sum of lesion diameters $S(t)$, is a linear combination of the latent states with additive Gaussian noise $\\varepsilon(t) \\sim \\mathcal{N}(0, \\sigma^2)$:\n$$\nS(t) = x(t) + c\\,y(t) + \\varepsilon(t)\n$$\nGiven the initial conditions $x(0)$ and $y(0)$, and a set of parameters, this system of ODEs does not have a simple analytical solution. Therefore, a numerical approach is required. We will use a robust numerical ODE solver, specifically the `solve_ivp` function from the `scipy.integrate` library, which implements methods like the Runge-Kutta family to approximate the solution at discrete time points. The problem specifies the evaluation times as $t = [\\,0,\\,1,\\,2,\\,3,\\,4\\,]$.\n\nThe core of the implementation for each test case is as follows:\n1.  **Define the ODE System**: A function is defined to compute the derivatives $[dx/dt, dy/dt]$ given the current time $t$, the state vector $[x, y]$, and the set of model parameters.\n2.  **Solve Numerically**: `solve_ivp` is called with the ODE system function, the time interval $[0, 4]$, the initial conditions $[x(0), y(0)]$, and the specific time points $t=[\\,0,\\,1,\\,2,\\,3,\\,4\\,]$ for which the solution is required. The solver returns the values of $x(t_i)$ and $y(t_i)$ at these points.\n3.  **Construct Observable Signal**: The deterministic part of the signal, $x(t_i) + c\\,y(t_i)$, is computed. To simulate measurement uncertainty, independent and identically distributed random values are drawn from a Gaussian distribution $\\mathcal{N}(0, \\sigma^2)$ and added to the deterministic signal at each time point, yielding the final measured values $S(t_i)$. For reproducibility, the random number generator is initialized with a fixed seed.\n4.  **Apply Classification Rule**: The boolean classification for pseudoprogression is determined by applying the given operational rules. Let $S_b = S(t_0)$ be the baseline measurement and $\\tau = 0.2$ be the progression factor. A boolean flag, `is_pseudoprogression`, is initialized to `False`. The algorithm then iterates through the time points $t_i$ for $i \\in \\{1, 2, 3\\}$. The loop terminates before the last point because confirmation requires a subsequent measurement, $t_{i+1}$. For each $t_i$, the following three conditions are checked:\n    a.  **Candidate Progression**: $S(t_i) \\geq S_b(1+\\tau)$.\n    b.  **Non-confirmation**: $S(t_{i+1})  S_b(1+\\tau)$.\n    c.  **Non-increasing Latent Tumor**: $x(t_{i+1}) \\leq x(t_i)$.\n\nIf all three conditions are met for any $t_i$ in the checked range, pseudoprogression is identified. The flag `is_pseudoprogression` is set to `True`, and the search for that test case terminates. If the loop completes without finding such an instance, the flag remains `False`. This logic correctly handles the boundary condition where candidate progression occurs at the last time point ($t_4$), as the loop for `i` will not include this index.\n\nThis entire procedure is encapsulated and repeated for each of the four provided test cases, and the final boolean results are aggregated into a list.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Models radiographic response under immune checkpoint blockade and classifies pseudoprogression.\n    \"\"\"\n    # Define common parameters for the simulation\n    time_points = np.array([0.0, 1.0, 2.0, 3.0, 4.0])\n    recist_tau = 0.2\n\n    # Define the four test cases with their specific parameters\n    test_cases = [\n        # Test Case A: Pseudoprogression expected\n        {\n            'r': 0.4, 'K': 100, 'k': 0.3, 'E0': 0.05, 'Emax': 0.9, 'gamma': 1.5,\n            'alpha': 1.0, 'beta': 2.0, 'u0': 100.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        },\n        # Test Case B: True progression expected\n        {\n            'r': 0.6, 'K': 100, 'k': 0.05, 'E0': 0.05, 'Emax': 0.3, 'gamma': 1.0,\n            'alpha': 1.0, 'beta': 2.0, 'u0': 5.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        },\n        # Test Case C: Unconfirmed progression, but not pseudoprogression (x(t) increases)\n        {\n            'r': 0.5, 'K': 100, 'k': 0.1, 'E0': 0.02, 'Emax': 0.2, 'gamma': 1.0,\n            'alpha': 1.0, 'beta': 2.0, 'u0': 80.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        },\n        # Test Case D: Boundary case (progression at last time point)\n        {\n            'r': 0.07, 'K': 200, 'k': 0.0, 'E0': 0.0, 'Emax': 0.0, 'gamma': 1.0,\n            'alpha': 0.5, 'beta': 2.0, 'u0': 5.0, 'lam': 1.0, 'c': 0.6,\n            'x0': 60.0, 'y0': 0.0, 'sigma': 0.5\n        }\n    ]\n\n    # Initialize a random number generator with a fixed seed for reproducible noise\n    rng = np.random.default_rng(0)\n\n    final_results = []\n\n    def ode_system(t, z, p):\n        \"\"\"\n        Defines the system of ordinary differential equations for tumor and inflammation.\n        z: state vector [x, y]\n        p: dictionary of parameters\n        \"\"\"\n        x, y = z\n        E_kill = p['E0'] + (p['Emax'] - p['E0']) * (1.0 - np.exp(-p['gamma'] * t))\n        dxdt = p['r'] * x * (1.0 - x / p['K']) - p['k'] * E_kill * x\n        dydt = p['alpha'] * p['u0'] * np.exp(-p['lam'] * t) - p['beta'] * y\n        return [dxdt, dydt]\n\n    for params in test_cases:\n        # Set initial conditions for the current case\n        z0 = [params['x0'], params['y0']]\n\n        # Solve the ODE system numerically\n        solution = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, params),\n            t_span=(time_points[0], time_points[-1]),\n            y0=z0,\n            t_eval=time_points,\n            method='RK45',\n            dense_output=True\n        )\n        x_t = solution.y[0]\n        y_t = solution.y[1]\n\n        # Generate noisy measurements for S(t)\n        noise = rng.normal(0, params['sigma'], size=len(time_points))\n        S_t = x_t + params['c'] * y_t + noise\n\n        # Apply classification logic\n        is_pseudoprogression = False\n        S_baseline = S_t[0]\n        progression_threshold = S_baseline * (1.0 + recist_tau)\n\n        # Iterate through time points to check for pseudoprogression signature.\n        # The loop runs up to the second to last time point, as a subsequent\n        # time point is needed for confirmation.\n        for i in range(1, len(time_points) - 1):\n            # 1. Check for candidate progression at time t_i\n            candidate_progression = (S_t[i] >= progression_threshold)\n            \n            if candidate_progression:\n                # 2. Check for non-confirmation at the next time point t_{i+1}\n                progression_not_confirmed = (S_t[i+1]  progression_threshold)\n                \n                # 3. Check for non-increasing latent tumor burden over the interval\n                tumor_non_increasing = (x_t[i+1] = x_t[i])\n                \n                if progression_not_confirmed and tumor_non_increasing:\n                    is_pseudoprogression = True\n                    break  # An instance of pseudoprogression is found\n\n        final_results.append(is_pseudoprogression)\n\n    # Format the final output as specified\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}