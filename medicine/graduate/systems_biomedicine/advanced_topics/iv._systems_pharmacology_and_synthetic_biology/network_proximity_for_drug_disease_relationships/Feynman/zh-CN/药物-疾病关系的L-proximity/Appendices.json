{
    "hands_on_practices": [
        {
            "introduction": "在评估药物-疾病网络邻近性时，一个基础性问题是：我们应该将观测到的邻近度与什么进行比较？此练习探讨了两种核心的零假设模型——标签置换和边重连——并分析了它们在控制网络拓扑结构方面的差异。通过这个思想实验，你将学会如何选择一个能够精确反映你所研究的科学问题的统计基线。",
            "id": "4366983",
            "problem": "一个人类蛋白质-蛋白质相互作用网络（Protein-Protein Interaction (PPI) network）被建模为一个简单连通图 $G = (V,E)$，其中 $V$ 是蛋白质集合，$E$ 是物理相互作用集合。令 $|V| = N$，并令 $d(u,v)$ 表示节点 $u \\in V$ 和 $v \\in V$ 之间的无权最短路径距离。考虑一种药物，其特征是一组靶点 $T \\subset V$，且 $|T| = m$；以及一种疾病，其特征是一组相关基因 $S \\subset V$，且 $|S| = n$。一种广泛使用的药物-疾病网络邻近性定义为平均交叉最短路径距离\n$$\n\\Delta(T,S) = \\frac{1}{mn}\\sum_{t \\in T}\\sum_{s \\in S} d(t,s).\n$$\n您的目标是检验观测到的 $\\Delta(T,S)$ 是否显著小于随机期望值，以表明药物靶点和疾病基因之间的邻近性。正在考虑两种零模型：\n\n零模型1（标签置换零模型）：在固定的网络 $G$ 上，通过在度匹配约束下抽样 $T' \\subset V$（$|T'| = m$）和 $S' \\subset V$（$|S'| = n$）来随机化标签，使得 $T'$ 和 $S'$ 的经验度分布与 $T$ 和 $S$ 的经验度分布相匹配（在允许的容差范围内），并计算多次实现的 $\\Delta(T',S')$ 以获得经验期望值。\n\n零模型2（边重连零模型）：通过度保持的边重连（精确保持度序列的类似配置模型的重连方法）生成替代网络 $G'$，在每个 $G'$ 上计算 $\\Delta(T,S)$，并汇总以获得经验期望值。\n\n从图上的最短路径距离的定义、度序列保持的含义，以及高阶拓扑结构（例如，聚类、同配性和模块性）在决定路径长度分布中的作用出发，分析在检验药物-疾病邻近性时，哪种零模型能更好地控制网络拓扑。您的分析必须从这些核心定义开始，并通过推导每种零模型下的预期邻近性表达式，以及解释度序列之外的网络特征如何影响 $\\Delta(T,S)$ 来进行。\n\n为了使分析有据可依，请考虑以下科学上合理的情景：一个人类PPI网络有 $N = 5000$，平均度 $\\langle k \\rangle \\approx 8$，所有节点对的经验平均成对最短路径距离为 $\\bar{d}_G \\approx 3.2$，具有高聚类系数和模块化社群结构。在度保持的重连下，替代网络 $G'$ 降低了聚类并部分破坏了模块性，得到的经验平均成对最短路径距离为 $\\bar{d}_{G'} \\approx 2.7$，且直径分位数相似。对于一个特定的药物和疾病，观测到的邻近性为 $\\Delta(T,S) = 2.9$，其中 $m = 20$，$n = 30$。\n\n在药物-疾病邻近性的统计检验中，关于控制网络拓扑，哪个陈述最准确？\n\nA. 带有度匹配的标签置换能更好地控制网络拓扑，因为它保持 $G$ 不变，从而保留了由聚类和模块性产生的所有路径距离 $d(u,v)$，同时调整了 $T$ 和 $S$ 中由度驱动的选择偏差，因此是根据 $G$ 的实际拓扑来估计预期的 $\\Delta$。\n\nB. 带有度保持的边重连能更好地控制网络拓扑，因为它消除了来自聚类和社群结构的偏差，只留下度的影响；因此它为任何网络上的 $\\Delta$ 提供了最中性的基准。\n\nC. 如果度序列被保留，那么两种零模型在控制拓扑方面是等效的，因为最短路径距离仅取决于度序列。\n\nD. 不带度匹配的标签置换在拓扑控制方面更可取，因为 $T'$ 和 $S'$ 是均匀抽样的，从而在 $G$ 上同时抵消了度的影响和社群结构。\n\nE. 通过要求在 $G$ 上的标签置换和在 $G'$ 上的边重连下都具有显著性来结合两种零模型，可以提供比单独使用任一种都更严格的拓扑控制，因为两种零模型之间的任何差异都反映了真实的生物信号，而不是结构性伪影。\n\n选择唯一一个最佳选项，该选项正确地描述了在此背景下能更好地控制网络拓扑的零模型，并使用所提供的情景和关于图与最短路径的第一性原理推理来证明您的选择。",
            "solution": "该问题要求分析两种用于评估蛋白质-蛋白质相互作用（PPI）网络中药物-疾病邻近性统计显著性的零模型。任务的核心是确定哪种零模型能更好地控制网络拓扑。\n\n### 步骤1：问题验证\n\n我将首先提取给定信息并验证问题陈述。\n\n**已知条件：**\n1.  **网络模型：** 一个简单连通图 $G = (V,E)$，其中 $V$ 是蛋白质集合，$E$ 是物理相互作用集合。\n2.  **网络大小：** $|V| = N$。\n3.  **距离度量：** $d(u,v)$ 是节点 $u, v \\in V$ 之间的无权最短路径距离。\n4.  **药物/疾病集合：** 一种药物由其靶点集 $T \\subset V$ 表示，大小为 $|T| = m$。一种疾病由其相关基因集 $S \\subset V$ 表示，大小为 $|S| = n$。\n5.  **邻近性度量：** 平均交叉最短路径距离定义为 $\\Delta(T,S) = \\frac{1}{mn}\\sum_{t \\in T}\\sum_{s \\in S} d(t,s)$。\n6.  **假设检验：** 目标是检验观测到的 $\\Delta(T,S)$ 是否显著小于随机期望值。\n7.  **零模型1（标签置换）：** 在固定的图 $G$ 上，在度匹配约束下随机抽样集合 $T'$ 和 $S'$，大小分别为 $|T'| = m$ 和 $|S'| = n$。零分布由 $\\Delta(T',S')$ 构成。\n8.  **零模型2（边重连）：** 集合 $T$ 和 $S$ 固定，但图 $G$ 通过度保持的边重连被随机化为替代图 $G'$。零分布由在每个 $G'$ 上计算的 $\\Delta(T,S)$ 构成。\n9.  **情景数据：**\n    *   $N = 5000$。\n    *   平均度 $\\langle k \\rangle \\approx 8$。\n    *   $G$ 上的平均成对最短路径距离：$\\bar{d}_G \\approx 3.2$。\n    *   $G$ 具有高聚类和模块化社群结构。\n    *   通过重连生成的替代图 $G'$ 具有降低的聚类和模块性。\n    *   $G'$ 上的平均成对最短路径距离：$\\bar{d}_{G'} \\approx 2.7$。\n    *   特定情况下的观测邻近性：$\\Delta(T,S) = 2.9$。\n    *   集合大小：$m = 20$，$n = 30$。\n\n**验证：**\n1.  **科学基础：** 该问题牢固地植根于网络科学和系统生物医学。将PPI网络建模为图、使用最短路径距离表示邻近性、以及应用零模型进行统计检验，都是标准且成熟的方法。所描述的两种零模型——带度匹配的标签置换和保持度的边重连——是网络分析中的典型方法。\n2.  **问题的适定性：** 问题是精确的：“分析哪种零模型能更好地控制网络拓扑”。定义清晰，提供的情景数据一致，并用以说明核心概念。可以推导出一个唯一的、有理有据的答案。\n3.  **客观性：** 问题以客观、正式的语言陈述，没有主观或带偏见的措辞。\n\n**结论：** 问题陈述是有效的。它科学上合理、适定、客观且完整。它提出了一个关于网络分析中统计零模型选择的非凡概念性挑战。我现在将开始推导解决方案。\n\n### 步骤2：推导与分析\n\n核心问题是在此假设检验的背景下，“控制网络拓扑”意味着什么。网络 $G$ 的拓扑结构包含其所有的结构特征，从局部的（度序列）到中尺度的（聚类、模体、社群结构）和全局的（路径长度分布、直径）。这些特征共同决定了所有成对最短路径距离的集合 $\\{d(u,v)\\}_{u,v \\in V}$。邻近性度量 $\\Delta(T,S)$ 是这些距离的一个子集的平均值。\n\n零模型的目的是生成一个“随机”构型的系综，这些构型与观测数据共享某些属性，观测到的统计量可以与之进行比较。对于这个问题，一个有效的零模型应该保留进行生物学假设检验的结构背景（网络拓扑），同时随机化正在研究的特定元素（基因/靶点的选择）。\n\n**零模型1（带度匹配的标签置换）的分析**\n\n该模型在固定的真实网络 $G$ 上操作。这意味着网络的整个拓扑结构——包括情景中提到的其高聚类和模块性——都被保留了下来。所有可能的最短路径距离集合 $\\{d(u,v)\\}$ 是不变的。零假设检验的是，特定的节点集 $T$ 和 $S$ 是否比具有相似度特征的随机选择的集合 $T'$ 和 $S'$ *在同一个网络上* 的预期距离显著更近。\n\n在此零模型下，邻近性的期望值 $E_{1}[\\Delta(T',S')]$ 代表了在图 $G$ 上，两个大小分别为 $m$ 和 $n$ 且具有指定度分布的节点集之间的平均距离。该值将受到 $G$ 的全局路径长度属性的影响。鉴于情景中 $\\bar{d}_G \\approx 3.2$，我们可以预期 $E_{1}[\\Delta(T',S')]$ 会接近这个值，并受到度匹配约束的轻微调节（例如，如果 $T$ 和 $S$ 由高度节点（中心节点）组成，预期距离将小于全局平均值）。\n\n通过将观测到的 $\\Delta(T,S)$ 与 $\\Delta(T',S')$ 的分布进行比较，我们将 $T$ 和 $S$ 中特定节点选择的影响与网络的背景结构以及与节点度相关的任何潜在抽样偏差分离开来。这是在生物网络的固定背景下测试特定、局部化关系的正确方法。因此，该模型恰当地控制了整个网络拓扑。\n\n**零模型2（边重连）的分析**\n\n该模型固定了节点集 $T$ 和 $S$，但随机化了网络的边结构，从而创建了一个替代图的系综 $\\{G'\\}$。唯一被严格保留的拓扑属性是度序列。如问题所述，像聚类和模块性这样的高阶结构——这些是真实生物网络的特征——被破坏了。\n\n这种对拓扑的破坏对最短路径距离有直接而显著的影响。重连过程将一个结构化的、“块状的”网络转变为一个更同质化、随机的网络。在这种随机图中，捷径更多，导致路径长度普遍减小。情景量化了这种效应：平均路径长度从 $\\bar{d}_G \\approx 3.2$ 下降到 $\\bar{d}_{G'} \\approx 2.7$。\n\n因此，该零模型下的邻近性期望值 $E_{2}[\\Delta(T,S)_{\\text{on } G'}]$ 将围绕 $\\bar{d}_{G'} \\approx 2.7$。这里的零假设是：“固定的集合 $T$ 和 $S$ 在真实网络 $G$ 上的距离，与它们在一个仅共享相同度序列的随机图上的预期距离是否不同？”\n\n在我们的情景中，观测到的邻近性是 $\\Delta(T,S) = 2.9$。将其与约 2.7 的零期望值进行比较，我们发现观测值比期望值 *更大*。这个检验将无法发现显著的邻近性；它甚至可能得出节点显著 *分离* 的结论。这个反直觉的结果之所以出现，是因为零模型创造了一个所有东西都被人为拉近的基准。该检验不再是关于 $T$ 和 $S$ 之间的关系。相反，它实际上是在检验真实网络的模块性和聚类（这些在 $G'$ 中是不存在的）是否相对于随机图增加了路径长度。这是一个不同的科学问题，而不是检验药物-疾病邻近性的本意。该模型未能控制相关的拓扑背景；事实上，它主动地将其消除了。\n\n**分析结论**\n零模型1（标签置换）在控制网络拓扑方面更优越，因为它保留了网络 $G$ 的整个拓扑结构作为检验的背景。零模型2（边重连）丢弃了关键的高阶拓扑结构，从根本上改变了路径长度分布，因此提供了一个不合适的比较基准。\n\n### 步骤3：选项评估\n\n**A. 带有度匹配的标签置换能更好地控制网络拓扑，因为它保持 $G$ 不变，从而保留了由聚类和模块性产生的所有路径距离 $d(u,v)$，同时调整了 $T$ 和 $S$ 中由度驱动的选择偏差，因此是根据 $G$ 的实际拓扑来估计预期的 $\\Delta$。**\n该陈述是对分析的精确且正确的总结。它正确地指出，保持 $G$ 不变可以保留完整的拓扑结构。它准确地描述了度匹配在纠正选择偏差中的作用。它正确地得出结论，该过程建立了一个以实际网络结构为基准的零假设。该选项是 **正确的**。\n\n**B. 带有度保持的边重连能更好地控制网络拓扑，因为它消除了来自聚类和社群结构的偏差，只留下度的影响；因此它为任何网络上的 $\\Delta$ 提供了最中性的基准。**\n该陈述将聚类和社群结构错误地描述为应被移除的“偏差”。在生物网络的背景下，这些特征是其组织和功能的基本方面，而不是伪影。破坏它们并不能为原始网络创造一个“中性基准”；它为一个不同的、随机的网络创造了基准。这个推理是有缺陷的。该选项是 **不正确的**。\n\n**C. 如果度序列被保留，那么两种零模型在控制拓扑方面是等效的，因为最短路径距离仅取决于度序列。**\n该陈述的前提在事实上是错误的。最短路径距离并不仅仅取决于度序列。两个具有相同度序列的图可以有截然不同的结构（例如，聚类、直径、路径长度分布）。所提供的情景通过具有相同度序列的图的 $\\bar{d}_G \\approx 3.2$ 和 $\\bar{d}_{G'} \\approx 2.7$ 证明了这一点。因此，两种零模型等效的结论也是错误的。该选项是 **不正确的**。\n\n**D. 不带度匹配的标签置换在拓扑控制方面更可取，因为 $T'$ 和 $S'$ 是均匀抽样的，从而在 $G$ 上同时抵消了度的影响和社群结构。**\n虽然在固定的 $G$ 上进行标签置换能正确保留拓扑，但省略度匹配是一个严重的缺陷。如果真实的集合 $T$ 和 $S$ 偏向于高度节点（一种常见情况），将其邻近性与均匀随机集合的邻近性进行比较，很可能会产生一个虚假的显著结果。该检验将仅仅是检测到中心节点彼此靠近，而不是一个特定的功能联系。声称这能“抵消……社群结构”也是无稽之谈；抽样不会改变 $G$ 的结构。该选项提出了一个比问题中描述的更弱的零模型。该选项是 **不正确的**。\n\n**E. 通过要求在 $G$ 上的标签置换和在 $G'$ 上的边重连下都具有显著性来结合两种零模型，可以提供比单独使用任一种都更严格的拓扑控制，因为两种零模型之间的任何差异都反映了真实的生物信号，而不是结构性伪影。**\n这种方法混淆了两个不同的统计问题。如前分析，这两种零模型检验的是不同的假设。它们结果之间的差异不一定是“真实的生物信号”，而是反映了所控制的不同属性。在所提供的情景中，一个药物-疾病对在零模型1下可能是显著邻近的，但在零模型2下可能是显著分离的（或不邻近）。要求在两种模型下都显著是一个过于保守和概念上混乱的策略，而不是一个“更严格”的策略。该选项是 **不正确的**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实的蛋白质相互作用网络往往不是完全连通的，这给基于最短路径的邻近性计算带来了挑战。此练习将指导你处理网络中的不连通部分，并量化一种常用简化方法（即仅使用最大连通分量）可能引入的偏差。完成此练习有助于培养你在处理不完美的真实世界数据时进行严谨分析的能力。",
            "id": "4366923",
            "problem": "蛋白质-蛋白质相互作用（PPI）网络表示为一个无向、无权重的图 $G=(V,E)$，该图可能是不连通的。该网络包含多个连通分量；最大连通分量（LCC）在总共 $18{,}000$ 个节点中包含 $15{,}000$ 个节点。考虑嵌入在图 $G$ 中的一个药物靶点集 $S$ 和一个疾病蛋白集 $T$，其中 $|S|=10$ 且 $|T|=12$。在药物靶点中，有 $7$ 个在 LCC 内， $3$ 个在 LCC 外。在疾病蛋白中，有 $9$ 个在 LCC 内， $3$ 个在 LCC 外。\n\n将 $S$ 和 $T$ 之间的网络邻近度定义为从 $S$ 到 $T$ 的平均最近邻最短路径距离：\n$$\n\\delta(S,T)=\\frac{1}{|S|}\\sum_{s\\in S}\\min_{t\\in T} d_G(s,t),\n$$\n其中 $d_G(s,t)$ 表示在图 $G$ 中以跳数计算的最短路径长度。对于位于不同连通分量中的节点对，采用一个有限的惩罚距离 $D_{\\infty}=7$。因此，如果 $s$ 与所有 $t\\in T$ 都不在同一个连通分量中，则 $\\min_{t\\in T} d_G(s,t)$ 的值取为 $D_{\\infty}$。\n\n为了模拟系统生物医学中通常将计算限制在最大连通分量（LCC）内的做法，定义 LCC 限制的邻近度\n$$\n\\delta_{\\mathrm{LCC}}(S,T)=\\frac{1}{|S\\cap \\mathrm{LCC}|}\\sum_{s\\in S\\cap \\mathrm{LCC}} \\min_{t\\in T\\cap \\mathrm{LCC}} d_G(s,t),\n$$\n该值通过在测量距离前移除所有不在 LCC 内的节点来计算。\n\n对图 $G$ 的经验观察表明：\n- 对于 $S\\cap \\mathrm{LCC}$ 中的 $7$ 个药物靶点，其到 $T\\cap \\mathrm{LCC}$ 的最近邻距离为 $\\{1,2,2,3,3,4,5\\}$ 跳。\n- 在 LCC 之外的 $3$ 个药物靶点中，恰好有 1 个与 $T$ 中的 1 个疾病蛋白共享一个小连通分量，距离为 $2$ 跳；其余 2 个药物靶点所在的连通分量中没有疾病蛋白。\n\n从连通分量、最短路径距离以及上述邻近度定义的基本概念出发，阐述在不连通的 PPI 网络中使用基于最短路径的邻近度时，将计算限制在 LCC 内的理由。然后，根据以上数据，计算定义为\n$$\nb=\\delta_{\\mathrm{LCC}}(S,T)-\\delta(S,T),\n$$\n的有符号偏差。将你的最终数值答案四舍五入到四位有效数字。不需要单位。",
            "solution": "该问题陈述经评估具有科学依据、问题明确、客观且内容完整。它提出了一个基于网络的系统生物医学中的标准任务，提供了所有必要的定义、数据和约束，以得出一个唯一且可验证的解。其前提条件一致，术语精确。因此，该问题是有效的。\n\n根据问题陈述的要求，解答分为两部分：首先，阐述将网络邻近度计算限制在最大连通分量（LCC）内的理由；其次，计算有符号偏差 $b$。\n\n**第一部分：在邻近度计算中限制于 LCC 的理由**\n\n最短路径距离 $d_G(s,t)$ 的使用是许多网络邻近度度量的基础。在一个不连通的图 $G$ 中，图被划分为两个或多个连通分量。根据定义，位于不同分量中的节点之间不存在路径。因此，这些节点之间的最短路径距离是无限的，即 $d_G(s,t) = \\infty$。\n\n这为那些需要对这些距离进行平均的邻近度度量提出了重大挑战。一个包含哪怕一个无穷大值的平均值本身也是无穷大，这使得该度量失去了信息价值。例如，如果任何药物靶点 $s \\in S$ 位于一个不含任何来自 $T$ 的疾病蛋白的连通分量中，定义 $\\delta(S,T)=\\frac{1}{|S|}\\sum_{s\\in S}\\min_{t\\in T} d_G(s,t)$ 就会出现问题。在这种情况下，$\\min_{t\\in T} d_G(s,t) = \\infty$，导致 $\\delta(S,T)$ 发散。\n\n存在两种主要策略来解决这个问题：\n1.  **分配有限惩罚值：** 这种方法在问题中已明确提及，它用一个较大的有限惩罚值 $D_{\\infty}$ 来替代无限距离。在此，如果一个源节点 $s$ 与所有目标节点 $t \\in T$ 都不连通，其对总和的贡献被设为 $D_{\\infty}=7$。虽然这使得计算变得可行，但它引入了对一个任意参数的关键依赖。$D_{\\infty}$ 的选择可以显著改变最终的邻近度得分以及任何后续的统计评估（例如 Z-score）。更高的 $D_{\\infty}$ 会更严厉地惩罚不连通性。由于缺乏理论上合理的 $D_{\\infty}$ 值，这种方法主观且可能不稳定。\n\n2.  **限制于 LCC：** 源自高通量实验的蛋白质-蛋白质相互作用（PPI）网络通常具有一个“巨型”或最大连通分量（LCC），其中包含了绝大多数节点（在本例中，为 $18,000$ 个节点中的 $15,000$ 个，约占 $83.3\\%$)。其余节点分散在众多小的、孤立的连通分量中。将分析限制在 LCC 内的科学理由是，该分量代表了细胞核心的、相互连接的功能机制。较小的分量通常被解释为包含功能上不那么核心的蛋白质，或者可能代表实验假象或不完整的数据。通过聚焦于 LCC，分析范围内的所有节点根据定义都是相互可达的，确保了所有最短路径距离 $d_G(s,t)$ 都是有限且明确定义的。这种方法避免了像 $D_{\\infty}$ 这样的任意惩罚值的需要，从而得到更稳健且无参数的距离计算。其主要缺点是丢失了 LCC 外部节点的信息，而这些节点可能含有相关的生物信号。本题中偏差的计算旨在量化这种信息损失的影响。\n\n总之，在系统生物医学中，将计算限制在 LCC 内是一种务实且常见的方法，其前提假设是大多数重要的生物过程都发生在网络最大的相互连接区域内，从而确保基于最短路径的度量是明确定义的，并且不会被任意的惩罚参数所扭曲。\n\n**第二部分：有符号偏差 $b$ 的计算**\n\n有符号偏差定义为 $b=\\delta_{\\mathrm{LCC}}(S,T)-\\delta(S,T)$。我们将分别计算每一项。\n\n**计算 $\\delta_{\\mathrm{LCC}}(S,T)$:**\nLCC 限制的邻近度定义为：\n$$\n\\delta_{\\mathrm{LCC}}(S,T)=\\frac{1}{|S\\cap \\mathrm{LCC}|}\\sum_{s\\in S\\cap \\mathrm{LCC}} \\min_{t\\in T\\cap \\mathrm{LCC}} d_G(s,t)\n$$\n根据问题陈述，LCC 中的药物靶点数量为 $|S\\cap \\mathrm{LCC}| = 7$。这 $7$ 个靶点到 LCC 内疾病蛋白 ($T\\cap \\mathrm{LCC}$) 的最近邻距离集合为 $\\{1,2,2,3,3,4,5\\}$。\n这些距离的总和是：\n$$\n\\sum_{s\\in S\\cap \\mathrm{LCC}} \\min_{t\\in T\\cap \\mathrm{LCC}} d_G(s,t) = 1+2+2+3+3+4+5 = 20\n$$\n因此，LCC 限制的邻近度为：\n$$\n\\delta_{\\mathrm{LCC}}(S,T) = \\frac{20}{7}\n$$\n\n**计算 $\\delta(S,T)$:**\n全局邻近度定义为：\n$$\n\\delta(S,T)=\\frac{1}{|S|}\\sum_{s\\in S}\\min_{t\\in T} d_G(s,t)\n$$\n已知 $|S|=10$。该总和可以分解为对 LCC 内靶点的求和与对 LCC 外靶点的求和：\n$$\n\\sum_{s\\in S}\\min_{t\\in T} d_G(s,t) = \\sum_{s\\in S\\cap \\mathrm{LCC}}\\min_{t\\in T} d_G(s,t) + \\sum_{s\\in S\\setminus \\mathrm{LCC}}\\min_{t\\in T} d_G(s,t)\n$$\n对于第一项，考虑一个靶点 $s \\in S\\cap \\mathrm{LCC}$。它与所有 $t \\in T\\cap \\mathrm{LCC}$ 连通，但与所有 $t \\in T\\setminus \\mathrm{LCC}$ 不连通。因此，最小距离将是到其自身分量（LCC）内的一个节点的距离：\n$$\n\\min_{t\\in T} d_G(s,t) = \\min(\\min_{t\\in T\\cap \\mathrm{LCC}} d_G(s,t), \\min_{t\\in T\\setminus \\mathrm{LCC}} d_G(s,t)) = \\min(\\min_{t\\in T\\cap \\mathrm{LCC}} d_G(s,t), \\infty) = \\min_{t\\in T\\cap \\mathrm{LCC}} d_G(s,t)\n$$\n这 $7$ 个靶点的总和与之前计算的相同：\n$$\n\\sum_{s\\in S\\cap \\mathrm{LCC}}\\min_{t\\in T} d_G(s,t) = 20\n$$\n对于第二项，我们考虑 LCC 之外的 $|S\\setminus \\mathrm{LCC}| = 3$ 个靶点。\n- 一个靶点位于一个小连通分量中，与来自 $T$ 的单个疾病蛋白相距 $2$ 跳。对于这个靶点，它到 $T$ 中任何蛋白的最小距离就是这个值，因为 $T$ 中的所有其他蛋白都在不同的分量中（LCC 或其他分量），因此距离无限远。所以，它的贡献是 $2$。\n- 其余两个靶点所在的连通分量中没有来自 $T$ 的疾病蛋白。根据问题的规则，对于这些靶点，最小距离被赋予惩罚值 $D_{\\infty}=7$。这两个靶点每个的贡献都是 $7$。\nLCC 之外靶点的总和是：\n$$\n\\sum_{s\\in S\\setminus \\mathrm{LCC}}\\min_{t\\in T} d_G(s,t) = 2 + 7 + 7 = 16\n$$\n因此，$S$ 中所有靶点的总和为 $20 + 16 = 36$。\n全局邻近度为：\n$$\n\\delta(S,T) = \\frac{36}{10} = 3.6\n$$\n\n**计算偏差 $b$:**\n现在我们计算有符号偏差：\n$$\nb = \\delta_{\\mathrm{LCC}}(S,T) - \\delta(S,T) = \\frac{20}{7} - 3.6 = \\frac{20}{7} - \\frac{36}{10} = \\frac{20}{7} - \\frac{18}{5}\n$$\n为了进行分数相减，我们找到一个公分母，即 $35$：\n$$\nb = \\frac{20 \\times 5}{35} - \\frac{18 \\times 7}{35} = \\frac{100 - 126}{35} = -\\frac{26}{35}\n$$\n最后，我们将此分数转换为小数，并四舍五入到四位有效数字：\n$$\nb = -\\frac{26}{35} \\approx -0.742857...\n$$\n四舍五入到四位有效数字得出：\n$$\nb \\approx -0.7429\n$$\n负偏差表明，与包含不连通节点惩罚的全局计算相比，将分析限制在 LCC 内导致了更低（即更近）的邻近度值。这是因为全局计算被分配给两个完全孤立的药物靶点的高额惩罚成本（$D_\\infty=7$）所抬高。",
            "answer": "$$\\boxed{-0.7429}$$"
        },
        {
            "introduction": "计算出邻近性得分后，最后一步是评估其统计显著性。此练习将带你深入了解如何通过蒙特卡洛模拟来计算经验$p$值，这是网络医学中的一个标准方法。你将学习如何根据先验科学假设选择单侧检验或双侧检验，并掌握在面对非对称零分布时计算稳健$p$值的正确方法。",
            "id": "4366966",
            "problem": "给定一个人类蛋白质-蛋白质相互作用网络 $G=(V,E)$。一种药物 $A$ 有一组靶点 $T_A \\subset V$，一种疾病 $B$ 与一个基因模块 $D_B \\subset V$ 相关。定义网络邻近性统计量 $s_{AB}$ 为从每个药物靶点到最近的疾病基因的最短路径距离的平均值，即：\n$$\ns_{AB} \\;=\\; \\frac{1}{|T_A|} \\sum_{t \\in T_A} \\min_{d \\in D_B} \\operatorname{dist}(t,d).\n$$\n假设要在零模型下评估 $s_{AB}$，在该模型中，$T_A$ 和 $D_B$ 都在同一网络 $G$ 中被随机化，通过抽样得到与观测集大小相匹配且近似保留原始节点度序列的集合（以控制与度相关的偏倚）。您进行了 $M=10000$ 次零假设下的蒙特卡洛抽样，得到零假设对 $(T_A^{(m)},D_B^{(m)})$，它们满足 $|T_A^{(m)}|=|T_A|$ 和 $|D_B^{(m)}|=|D_B|$，并且随机化集合中的每个节点都被选择为尽可能接近相应观测集中一个不同节点的度。\n\n在您的真实数据中，观测到的邻近性为 $s_{AB}^{\\mathrm{obs}} = 2.10$。在 $M=10000$ 次零假设抽样中，您计算出 $s_{AB}^{(m)}$ 的经验零均值为 $\\hat{\\mu} = 2.70$，并记录了以下尾部计数：\n- 在 $M$ 个零假设值中，有 $c_{\\mathrm{left}} = 285$ 个满足 $s_{AB}^{(m)} \\le 2.10$，\n- 在 $M$ 个零假设值中，有 $c_{\\mathrm{right}} = 21$ 个满足 $s_{AB}^{(m)} \\ge 3.30$。\n\n假设 $s_{AB}$ 的零分布可能是偏态的，并且您希望得到的 $p$ 值在有限样本中仍然有效。\n\n在这种情况下，关于计算经验 $p$ 值以及解释单侧检验与双侧检验，以下哪些陈述是正确的？选择所有适用项。\n\nA) 用于检验药物是否比随机预期更接近疾病模块（左尾邻近性检验）的一个合适的经验单侧 $p$ 值，是由满足 $s_{AB}^{(m)} \\le s_{AB}^{\\mathrm{obs}}$ 的零假设重复样本的比例给出，并使用加一校正，即 $p_{\\mathrm{prox}} = \\dfrac{1 + c_{\\mathrm{left}}}{1 + M}$。当 $M=10000$ 且 $c_{\\mathrm{left}}=285$ 时，得出 $p_{\\mathrm{prox}} \\approx 0.0286$。\n\nB) 无论零分布的形状或偏度如何，一个有效的经验双侧 $p$ 值总可以通过将单侧左尾 $p$ 值加倍来获得，即 $p_{\\mathrm{two}} = 2\\, p_{\\mathrm{prox}}$。\n\nC) 一个对偏度具有稳健性的有效经验双侧 $p$ 值，可以通过计算相对于经验零均值 $\\hat{\\mu}$ 而言，在任一尾部至少与 $s_{AB}^{\\mathrm{obs}}$ 一样极端的零假设重复样本数量来获得，并使用加一校正：\n$$\np_{\\mathrm{two}} \\;=\\; \\frac{1 + \\#\\{m : s_{AB}^{(m)} \\le \\hat{\\mu} - |s_{AB}^{\\mathrm{obs}} - \\hat{\\mu}|\\} + \\#\\{m : s_{AB}^{(m)} \\ge \\hat{\\mu} + |s_{AB}^{\\mathrm{obs}} - \\hat{\\mu}|\\}}{1 + M}.\n$$\n当 $\\hat{\\mu}=2.70$，$s_{AB}^{\\mathrm{obs}}=2.10$，$M=10000$，$c_{\\mathrm{left}}=285$ 且 $c_{\\mathrm{right}}=21$ 时，这给出了 $p_{\\mathrm{two}} \\approx 0.0307$。\n\nD) 通过从 $V$ 中均匀抽取而不考虑度序列来随机化 $T_A$ 和 $D_B$，对于检验邻近性通常是无偏的，因为度的影响会在排列中被平均掉。\n\nE) 如果先验科学假说指明具有治疗相关性的药物倾向于比预期更接近疾病模块，那么单侧左尾检验是合适的，并且通常比双侧检验更具统计功效；只有当任一方向的偏差（邻近或分离）都具有科学意义时，双侧检验才是更可取的。",
            "solution": "问题陈述已经过验证，被认为是合理的。它提出了系统生物医学中的一个标准场景，涉及对药物靶点和疾病相关基因之间网络邻近性的统计评估。所有定义都清晰，所提供的数据一致，问题涉及统计假设检验的既定原则。\n\n以下是对每个选项的详细分析。\n\n提供的核心数据如下：\n- 蛋白质-蛋白质相互作用网络是 $G=(V,E)$。\n- 药物靶点集是 $T_A \\subset V$。\n- 疾病基因集是 $D_B \\subset V$。\n- 邻近性统计量是 $s_{AB} = \\frac{1}{|T_A|} \\sum_{t \\in T_A} \\min_{d \\in D_B} \\operatorname{dist}(t,d)$。\n- 观测到的邻近性是 $s_{AB}^{\\mathrm{obs}} = 2.10$。\n- 蒙特卡洛零假设重复样本数量是 $M = 10000$。\n- 零分布的经验均值是 $\\hat{\\mu} = 2.70$。\n- 左尾计数是 $c_{\\mathrm{left}} = \\#\\{m : s_{AB}^{(m)} \\le 2.10\\} = 285$。\n- 特定阈值的右尾计数是 $c_{\\mathrm{right}} = \\#\\{m : s_{AB}^{(m)} \\ge 3.30\\} = 21$。\n\n主要假设是药物是否显著接近疾病模块，这意味着对邻近性（距离）统计量 $s_{AB}$ 进行左尾检验。$s_{AB}$ 值越小，表示邻近性越高。\n\n### 选项A分析\n\n该选项提出了一个用于左尾检验的单侧经验 $p$ 值的公式。建议的公式是 $p_{\\mathrm{prox}} = \\dfrac{1 + c_{\\mathrm{left}}}{1 + M}$。这是一个用于从蒙特卡洛模拟中计算 $p$ 值的标准且推荐的公式。计数 $c_{\\mathrm{left}}$ 是统计量值与观测值一样极端或更极端的零假设重复样本数量 ($s_{AB}^{(m)} \\le s_{AB}^{\\mathrm{obs}}$)。在分子和分母上都加 1，通常称为“加一校正”，是一种确保 $p$ 值永不为 0 的方法，使其成为一个更保守和稳定的估计量，尤其是在 $c_{\\mathrm{left}}$ 非常小的时候。这种表述确保了在零假设下，$p$ 值的期望是无偏的。\n\n我们来验证一下计算过程：\n给定 $M = 10000$ 且 $c_{\\mathrm{left}} = 285$：\n$$\np_{\\mathrm{prox}} = \\frac{1 + 285}{1 + 10000} = \\frac{286}{10001} \\approx 0.02859714\n$$\n四舍五入到四位小数得到 $0.0286$。该公式和计算都是正确的。这代表了一种计算单侧经验 $p$ 值的有效方法。\n\n结论：**正确**。\n\n### 选项B分析\n\n该选项声称，一个有效的双侧 $p$ 值**总是**可以通过将单侧左尾 $p$ 值加倍来获得 ($p_{\\mathrm{two}} = 2\\, p_{\\mathrm{prox}}$)。这是一个常见的程序，但其有效性严格地取决于零分布是否围绕其中心对称。问题明确指出，$s_{AB}$ 的零分布“可能是偏态的”。对于一个偏态分布，两个尾部的大小是不相等的。根据我们的数据，观测值 $s_{AB}^{\\mathrm{obs}} = 2.10$ 位于左尾，均值为 $\\hat{\\mu}=2.70$。与均值的距离是 $|2.10 - 2.70| = 0.60$。在另一侧尾部等距的点将是 $2.70 + 0.60 = 3.30$。左尾的零假设值数量为 $c_{\\mathrm{left}}=285$，而在相应的右尾（大于等于 $3.30$）的数量为 $c_{\\mathrm{right}}=21$。由于 $285 \\neq 21$，零分布显然是偏态的。将左尾概率加倍将错误地假设相反方向上同样极端的偏差具有相同的概率。这将导致一个不准确的双侧 $p$ 值。因此，声称该方法“无论形状或偏度如何”都有效的说法是错误的。\n\n结论：**错误**。\n\n### 选项C分析\n\n该选项提出了一种计算对偏度具有稳健性的双侧 $p$ 值的方法。该方法将“极端性”区域定义为所有与经验均值 $\\hat{\\mu}$ 的距离至少与观测值 $s_{AB}^{\\mathrm{obs}}$ 一样远的值。建议的公式是：\n$$\np_{\\mathrm{two}} \\;=\\; \\frac{1 + \\#\\{m : s_{AB}^{(m)} \\le \\hat{\\mu} - |s_{AB}^{\\mathrm{obs}} - \\hat{\\mu}|\\} + \\#\\{m : s_{AB}^{(m)} \\ge \\hat{\\mu} + |s_{AB}^{\\mathrm{obs}} - \\hat{\\mu}|\\}}{1 + M}\n$$\n这是一种有原则的方法。它将零分布中心等距或更远的两个尾部的计数相加。让我们计算阈值和计数：\n- 与均值的偏差是 $|s_{AB}^{\\mathrm{obs}} - \\hat{\\mu}| = |2.10 - 2.70| = 0.60$。\n- 左尾阈值是 $\\hat{\\mu} - 0.60 = 2.70 - 0.60 = 2.10$。低于或等于此阈值的零假设值数量为 $c_{\\mathrm{left}} = 285$。\n- 右尾阈值是 $\\hat{\\mu} + 0.60 = 2.70 + 0.60 = 3.30$。高于或等于此阈值的零假设值数量为 $c_{\\mathrm{right}} = 21$。\n\n极端值的总计数为 $c_{\\mathrm{left}} + c_{\\mathrm{right}} = 285 + 21 = 306$。\n应用加一校正公式：\n$$\np_{\\mathrm{two}} = \\frac{1 + (c_{\\mathrm{left}} + c_{\\mathrm{right}})}{1 + M} = \\frac{1 + 306}{1 + 10000} = \\frac{307}{10001} \\approx 0.03069693\n$$\n四舍五入到四位小数得到 $0.0307$。对于一个可能偏态的分布，该公式是计算双侧经验 $p$ 值的一种有效且稳健的方法，并且计算是正确的。\n\n结论：**正确**。\n\n### 选项D分析\n\n该选项建议，一个更简单的零模型，即从所有顶点 $V$ 的集合中均匀抽取随机节点集 $T_A$ 和 $D_B$ 而不考虑节点度，是“通常无偏的”。这一说法根本上是错误的，并且代表了网络分析中的一个重大的方法论缺陷。已知蛋白质-蛋白质相互作用网络具有高度异质的度分布（它们是“无标度的”）。根据定义，高度节点（中枢节点）到网络大部分区域的路径都很短。如果药物靶点或疾病基因恰好是高度蛋白，它们将仅仅因为其高连通性而表现出与其他许多蛋白质（包括彼此之间）的短最短路径距离，而不一定是因为特定的生物学关系。一个不控制这种度偏倚的零模型会系统性地为任何包含中枢节点的基因群找到“显著的”邻近性。问题陈述本身正确地指出了需要“近似保留度序列...以控制与度相关的偏倚”。因此，不考虑度的随机化是一个有偏的过程，会导致假阳性率的膨胀。\n\n结论：**错误**。\n\n### 选项E分析\n\n该选项讨论了在单侧检验和双侧检验之间的选择。它指出，如果*先验*假说是治疗性药物比预期更接近疾病模块，那么单侧左尾检验是合适的并且更具统计功效。这是统计假设检验的一个核心原则。当在观察数据之前就已形成一个有方向性的科学假说时，进行单侧检验是合理的。通过将整个拒绝域（例如 $\\alpha = 0.05$）集中在一个尾部，与将拒绝域分到两个尾部（例如，每个尾部 $\\alpha/2 = 0.025$）的双侧检验相比，它在检测假设方向上的效应时具有更大的统计功效。该陈述还正确地指出，当与零假设的任何显著偏差，无论是邻近（更近）还是分离（更远），都具有科学意义时，双侧检验是更可取的。在寻找治疗效果的背景下，假说几乎总是有方向性的（邻近），这使得单侧检验成为更合适和更具统计功效的选择。\n\n结论：**正确**。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}