{
    "hands_on_practices": [
        {
            "introduction": "A core task in preclinical drug development is to quantify whether a combination of agents works better than expected. This practice introduces the Bliss independence model, a fundamental concept for defining synergy. You will translate raw cell proliferation data into normalized viabilities and calculate a synergy score, providing a quantitative basis for classifying a drug pair as synthetically lethal based on its deviation from non-interaction .",
            "id": "4354444",
            "problem": "A cell population of size $N_0$ proliferates according to exponential growth under each condition, consistent with first principles for well-mixed populations in the absence of resource limitation: $N(t) = N_0 \\exp(\\mu t)$, where $N(t)$ is the cell number at time $t$ and $\\mu$ is the net per-capita growth rate. In a drug-combination experiment evaluating potential synthetic lethality, the following net growth rates (in $\\text{h}^{-1}$) are measured over $t = 72$ hours:\n- Control (vehicle): $\\mu_C = \\frac{\\ln 2}{24}$.\n- Agent $A$ alone: $\\mu_A = 0.015$.\n- Agent $B$ alone: $\\mu_B = 0.020$.\n- Combination $A+B$: $\\mu_{AB} = -0.005$.\n\nDefine the normalized viability under condition $X \\in \\{A, B, AB\\}$ as the ratio $W_X = \\frac{N_X(t)}{N_C(t)}$, where $N_C(t)$ is the control cell count at time $t$. Under the assumption of independence of effects (Bliss independence), the expected combined viability in the absence of interaction equals the product of the single-agent viabilities. The Bliss synergy score is defined as the deviation of the observed combined viability from this independence expectation at time $t$.\n\nUsing only the exponential growth law and the independence principle, compute the Bliss synergy score at $t = 72$ hours. Round your answer to four significant figures and report it as a unitless decimal number.\n\nAdditionally, adopt the following operational criterion for synthetic lethality: the combination is called synthetically lethal if (i) both single agents are non-lethal, quantified as $W_A > \\theta$ and $W_B > \\theta$ with $\\theta = 0.2$, (ii) the combination is lethal, quantified as $W_{AB}  \\lambda$ with $\\lambda = 0.1$, and (iii) the Bliss deviation is strictly negative. Based on your computed quantities, determine whether the combination qualifies as synthetically lethal under these criteria. Your final reported answer should be only the Bliss synergy score rounded as specified; do not include any units or categorical labels in the final answer.",
            "solution": "The problem requires the calculation of the Bliss synergy score for a drug combination and an assessment of whether the combination is synthetically lethal based on a given set of criteria. The starting point is the exponential growth law for cell populations.\n\nFirst, I will validate the problem statement.\n**Step 1: Extract Givens**\n- Cell growth model: $N(t) = N_0 \\exp(\\mu t)$\n- Time point for analysis: $t = 72$ hours\n- Net growth rates ($\\text{h}^{-1}$):\n  - Control: $\\mu_C = \\frac{\\ln 2}{24}$\n  - Agent A: $\\mu_A = 0.015$\n  - Agent B: $\\mu_B = 0.020$\n  - Combination A+B: $\\mu_{AB} = -0.005$\n- Normalized viability definition: $W_X = \\frac{N_X(t)}{N_C(t)}$ for $X \\in \\{A, B, AB\\}$\n- Bliss independence model: Expected combined viability $W_{AB, \\text{exp}} = W_A \\cdot W_B$\n- Bliss synergy score definition: The deviation of the observed combined viability ($W_{AB, \\text{obs}}$) from the independence expectation ($W_{AB, \\text{exp}}$).\n- Synthetic lethality criteria:\n  - (i) Non-lethal single agents: $W_A  \\theta$ and $W_B  \\theta$, with $\\theta = 0.2$.\n  - (ii) Lethal combination: $W_{AB}  \\lambda$, with $\\lambda = 0.1$.\n  - (iii) Synergistic interaction: The Bliss deviation is strictly negative.\n- Final answer requirement: Report the Bliss synergy score rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using standard models (exponential growth) and concepts (Bliss independence, synergy score) from quantitative pharmacology and systems biology. The provided growth rates are physically realistic for in-vitro cell culture experiments; for instance, $\\mu_C$ corresponds to a $24$-hour doubling time, a common value. The problem is well-posed, providing all necessary definitions, constants, and data for a unique solution. The language is objective and precise. There are no internal contradictions or missing pieces of information. The problem is not trivial, as it requires careful application of the provided definitions and a multi-step calculation.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with a full solution.\n\nThe normalized viability $W_X$ for condition $X$ at time $t$ is defined as the ratio of the cell number under condition $X$ to the cell number in the control condition. Using the exponential growth law, this can be expressed in terms of the growth rates:\n$$W_X(t) = \\frac{N_X(t)}{N_C(t)} = \\frac{N_0 \\exp(\\mu_X t)}{N_0 \\exp(\\mu_C t)} = \\exp((\\mu_X - \\mu_C) t)$$\nThis expression is valid for $X \\in \\{A, B, AB\\}$. The analysis is performed at $t=72$ hours.\n\nFirst, we calculate the viabilities of the single agents, $W_A$ and $W_B$.\nFor Agent A:\n$$W_A = \\exp\\left((\\mu_A - \\mu_C)t\\right) = \\exp\\left(\\left(0.015 - \\frac{\\ln 2}{24}\\right) \\cdot 72\\right)$$\n$$W_A = \\exp\\left(0.015 \\cdot 72 - \\frac{\\ln 2}{24} \\cdot 72\\right) = \\exp(1.08 - 3\\ln 2) = \\exp(1.08) \\exp(-\\ln(2^3)) = \\frac{\\exp(1.08)}{8}$$\nFor Agent B:\n$$W_B = \\exp\\left((\\mu_B - \\mu_C)t\\right) = \\exp\\left(\\left(0.020 - \\frac{\\ln 2}{24}\\right) \\cdot 72\\right)$$\n$$W_B = \\exp\\left(0.020 \\cdot 72 - \\frac{\\ln 2}{24} \\cdot 72\\right) = \\exp(1.44 - 3\\ln 2) = \\exp(1.44) \\exp(-\\ln 8) = \\frac{\\exp(1.44)}{8}$$\n\nNext, we calculate the observed viability of the combination, $W_{AB, \\text{obs}}$.\n$$W_{AB, \\text{obs}} = \\exp\\left((\\mu_{AB} - \\mu_C)t\\right) = \\exp\\left(\\left(-0.005 - \\frac{\\ln 2}{24}\\right) \\cdot 72\\right)$$\n$$W_{AB, \\text{obs}} = \\exp\\left(-0.005 \\cdot 72 - \\frac{\\ln 2}{24} \\cdot 72\\right) = \\exp(-0.36 - 3\\ln 2) = \\exp(-0.36) \\exp(-\\ln 8) = \\frac{\\exp(-0.36)}{8}$$\n\nThe Bliss independence model posits that the expected viability of the combination is the product of the individual viabilities:\n$$W_{AB, \\text{exp}} = W_A \\cdot W_B = \\left(\\frac{\\exp(1.08)}{8}\\right) \\cdot \\left(\\frac{\\exp(1.44)}{8}\\right) = \\frac{\\exp(1.08 + 1.44)}{64} = \\frac{\\exp(2.52)}{64}$$\n\nThe Bliss synergy score, $S_{\\text{Bliss}}$, is the deviation of the observed viability from the expected viability. The problem states that for synthetic lethality (a form of synergy), this deviation must be negative. Synergy implies the observed effect (cell killing or growth inhibition) is stronger than expected, which means the observed viability is lower than the expected viability ($W_{AB, \\text{obs}}  W_{AB, \\text{exp}}$). Therefore, the score must be defined as:\n$$S_{\\text{Bliss}} = W_{AB, \\text{obs}} - W_{AB, \\text{exp}}$$\nSubstituting the expressions we derived:\n$$S_{\\text{Bliss}} = \\frac{\\exp(-0.36)}{8} - \\frac{\\exp(2.52)}{64}$$\n\nNow, we compute the numerical value.\n$W_{AB, \\text{obs}} = \\frac{\\exp(-0.36)}{8} \\approx \\frac{0.6976763}{8} \\approx 0.0872095$\n$W_{AB, \\text{exp}} = \\frac{\\exp(2.52)}{64} \\approx \\frac{12.427179}{64} \\approx 0.1941747$\n$$S_{\\text{Bliss}} \\approx 0.0872095 - 0.1941747 \\approx -0.1069652$$\nRounding to four significant figures, the Bliss synergy score is $-0.1070$.\n\nAs a component of the reasoning process, we assess the criteria for synthetic lethality.\n(i) Non-lethal single agents: Check if $W_A  0.2$ and $W_B  0.2$.\n$W_A = \\frac{\\exp(1.08)}{8} \\approx \\frac{2.94468}{8} \\approx 0.3681$. Since $0.3681  0.2$, this is met.\n$W_B = \\frac{\\exp(1.44)}{8} \\approx \\frac{4.22070}{8} \\approx 0.5276$. Since $0.5276  0.2$, this is met.\nCondition (i) is satisfied.\n\n(ii) Lethal combination: Check if $W_{AB}  0.1$.\n$W_{AB, \\text{obs}} \\approx 0.0872$. Since $0.0872  0.1$, condition (ii) is satisfied.\n\n(iii) Synergistic interaction: Check if the Bliss deviation is strictly negative.\n$S_{\\text{Bliss}} \\approx -0.1070$. Since $-0.1070  0$, condition (iii) is satisfied.\n\nAll three criteria are met, so the combination qualifies as synthetically lethal under the provided operational definition. The final answer is the Bliss synergy score itself.",
            "answer": "$$\\boxed{-0.1070}$$"
        },
        {
            "introduction": "Beyond controlled experiments, signatures of synthetic lethality can be found in large-scale observational data from patient populations. If two genes are synthetically lethal, mutations in them should be mutually exclusive within a tumor cohort. This exercise applies Fisher's exact test to a contingency table of mutation data, a classic bioinformatics technique to determine if the observed depletion of double mutants is statistically significant .",
            "id": "4354592",
            "problem": "In a cohort of $20$ tumors of the same cancer type, two genes $G_{1}$ and $G_{2}$ are profiled for loss-of-function mutations using a validated next-generation sequencing panel. Let $X$ denote the number of tumors that carry mutations in both $G_{1}$ and $G_{2}$. The following marginal counts are observed: the number of tumors with a $G_{1}$ mutation is $10$, the number of tumors with a $G_{2}$ mutation is $8$, and the observed number of double-mutant tumors is $X_{\\text{obs}}=0$. Synthetic lethality is expected to manifest as mutual exclusivity, that is, a depletion of double mutants relative to the null hypothesis of no interaction.\n\nTask:\n1. Formulate the $2 \\times 2$ contingency table for mutation status of $G_{1}$ and $G_{2}$ across the $20$ tumors using the counts above. Use the standard cell ordering where the four counts are $(a,b;c,d)$ with $a$ representing the number of double mutants, $b$ the number of tumors mutated in $G_{1}$ only, $c$ the number of tumors mutated in $G_{2}$ only, and $d$ the number of tumors mutated in neither gene.\n2. Under the null hypothesis that mutations in $G_{1}$ and $G_{2}$ are independent with fixed margins (total mutations per gene and total tumors fixed), derive the exact probability mass function for the number of double mutants $X$ using first principles of sampling without replacement, and identify the distributional family it belongs to.\n3. Using the distribution from part $2$, compute the one-sided Fisherâ€™s exact test $p$-value for mutual exclusivity, defined as the probability of observing a table with $X \\leq X_{\\text{obs}}$ given the fixed margins. Express the final $p$-value as a unitless decimal and round your answer to four significant figures.",
            "solution": "The problem requires a statistical analysis of mutation data for two genes, $G_1$ and $G_2$, across a cohort of $20$ tumors. The analysis involves constructing a contingency table, deriving a probability distribution under a null hypothesis, and calculating a $p$-value for mutual exclusivity using Fisher's exact test.\n\nLet $N=20$ be the total number of tumors.\nLet $M_1$ denote the event that a tumor has a mutation in gene $G_1$, and $M_2$ denote the event that a tumor has a mutation in gene $G_2$.\nThe provided marginal counts are:\n- The number of tumors with a $G_1$ mutation, $n(M_1) = 10$.\n- The number of tumors with a $G_2$ mutation, $n(M_2) = 8$.\nLet $X$ be the number of tumors with mutations in both genes, i.e., $X = n(M_1 \\cap M_2)$. The observed value is $X_{\\text{obs}} = 0$.\n\n**1. Formulation of the Contingency Table**\n\nA $2 \\times 2$ contingency table organizes the mutation status for the two genes. The cells of the table, $(a, b; c, d)$, are defined as:\n- $a = n(M_1 \\cap M_2)$: Number of tumors with mutations in both $G_1$ and $G_2$.\n- $b = n(M_1 \\cap M_2^c)$: Number of tumors with a mutation in $G_1$ only.\n- $c = n(M_1^c \\cap M_2)$: Number of tumors with a mutation in $G_2$ only.\n- $d = n(M_1^c \\cap M_2^c)$: Number of tumors with mutations in neither gene.\n\nThe marginal totals are related to these cell counts:\n- Total with $G_1$ mutation: $a + b = n(M_1) = 10$.\n- Total with $G_2$ mutation: $a + c = n(M_2) = 8$.\n- Total tumors: $a + b + c + d = N = 20$.\n\nUsing the observed value $a = X_{\\text{obs}} = 0$, we can determine the other cell counts:\n- $b = n(M_1) - a = 10 - 0 = 10$.\n- $c = n(M_2) - a = 8 - 0 = 8$.\n- $d = N - (a + b + c) = 20 - (0 + 10 + 8) = 2$.\n\nThus, the observed contingency table is:\n| | $G_2$ Mutated | $G_2$ Wild-Type | Total |\n|---|---|---|---|\n| $G_1$ Mutated | $a=0$ | $b=10$ | $10$ |\n| $G_1$ Wild-Type | $c=8$ | $d=2$ | $10$ |\n| Total | $8$ | $12$ | $20$ |\n\nThe counts in the standard cell ordering $(a,b;c,d)$ are $(0, 10; 8, 2)$.\n\n**2. Derivation of the Probability Mass Function (PMF)**\n\nUnder the null hypothesis ($H_0$), mutations in $G_1$ and $G_2$ are independent events, conditional on the observed marginal totals being fixed. The number of $G_1$ mutants ($10$), the number of $G_2$ mutants ($8$), and the total number of tumors ($20$) are considered fixed. We wish to find the probability distribution of $X$, the number of double mutants.\n\nThis can be framed as a problem of sampling without replacement. We have a population of $N=20$ tumors. Within this population, there is a sub-population of $n(M_1) = 10$ tumors with a $G_1$ mutation. We can think of these as \"successes\". We then draw a sample of size $n(M_2) = 8$ (the tumors with a $G_2$ mutation) from the total population of $20$. We want to find the probability that this sample contains exactly $x$ \"successes\" (i.e., tumors that also have a $G_1$ mutation).\n\nThe total number of ways to choose a sample of $n(M_2)=8$ tumors from the full cohort of $N=20$ is given by the binomial coefficient $\\binom{N}{n(M_2)} = \\binom{20}{8}$.\n\nTo obtain exactly $x$ double mutants, we must select:\n- $x$ tumors from the $n(M_1)=10$ tumors that have a $G_1$ mutation. The number of ways to do this is $\\binom{n(M_1)}{x} = \\binom{10}{x}$.\n- The remaining $n(M_2) - x = 8 - x$ tumors must be selected from the $N - n(M_1) = 20 - 10 = 10$ tumors that do not have a $G_1$ mutation. The number of ways to do this is $\\binom{N - n(M_1)}{n(M_2) - x} = \\binom{10}{8-x}$.\n\nBy the multiplication principle, the total number of ways to obtain a sample with exactly $x$ double mutants is the product $\\binom{10}{x}\\binom{10}{8-x}$.\n\nThe probability of observing exactly $x$ double mutants, $P(X=x)$, is the ratio of the number of favorable outcomes to the total number of possible outcomes:\n$$ P(X=x) = \\frac{\\binom{10}{x}\\binom{10}{8-x}}{\\binom{20}{8}} $$\nThis is the probability mass function (PMF) for the number of double mutants, $X$.\n\nThis distribution is a member of the **Hypergeometric distribution** family. The general PMF for a hypergeometric random variable is $P(K=k) = \\frac{\\binom{m}{k}\\binom{N-m}{n-k}}{\\binom{N}{n}}$, where $N$ is the population size, $m$ is the number of success states in the population, $n$ is the number of draws, and $k$ is the number of observed successes. In our context, $N=20$, $m=10$, $n=8$, and $k=x$.\n\n**3. Calculation of the p-value**\n\nThe problem specifies that synthetic lethality is expected to manifest as mutual exclusivity, which corresponds to a depletion of double mutants. We are asked to compute a one-sided $p$-value, which is the probability of observing a result as extreme as or more extreme than the observation, in the direction of the alternative hypothesis (depletion).\n\nThe observed number of double mutants is $X_{\\text{obs}} = 0$. The $p$-value is therefore $P(X \\leq X_{\\text{obs}})$ under the null hypothesis.\n$$ p\\text{-value} = P(X \\leq 0) $$\nSince the number of mutants $X$ cannot be negative, this simplifies to:\n$$ p\\text{-value} = P(X=0) $$\nUsing the PMF derived in part 2 with $x=0$:\n$$ p = P(X=0) = \\frac{\\binom{10}{0}\\binom{10}{8-0}}{\\binom{20}{8}} = \\frac{\\binom{10}{0}\\binom{10}{8}}{\\binom{20}{8}} $$\nWe calculate the binomial coefficients:\n- $\\binom{10}{0} = 1$\n- $\\binom{10}{8} = \\frac{10!}{8! (10-8)!} = \\frac{10 \\times 9}{2 \\times 1} = 45$\n- $\\binom{20}{8} = \\frac{20!}{8! (20-8)!} = \\frac{20 \\times 19 \\times 18 \\times 17 \\times 16 \\times 15 \\times 14 \\times 13}{8 \\times 7 \\times 6 \\times 5 \\times 4 \\times 3 \\times 2 \\times 1} = 125970$\n\nSubstituting these values into the expression for the $p$-value:\n$$ p = \\frac{1 \\times 45}{125970} = \\frac{45}{125970} $$\nNow, we compute the decimal value:\n$$ p \\approx 0.0003572279... $$\nRounding to four significant figures, we get:\n$$ p \\approx 0.0003572 $$\nThis low $p$-value suggests that the observed depletion of double mutants ($X_{\\text{obs}}=0$) is statistically significant, providing evidence for a mutually exclusive relationship between mutations in $G_1$ and $G_2$, which is a signature of synthetic lethality.",
            "answer": "$$\n\\boxed{0.0003572}\n$$"
        },
        {
            "introduction": "Computational systems biology provides powerful tools for predicting genetic interactions *in silico* before performing costly experiments. This practice utilizes Flux Balance Analysis (FBA), a constraint-based modeling approach, to simulate a cell's metabolic capabilities. By systematically simulating single and double reaction knockouts, you will identify synthetic lethal pairs, defined as pairs whose simultaneous deletion is lethal while individual deletions are tolerated .",
            "id": "4354454",
            "problem": "You are given the task of identifying synthetic lethal reaction pairs in small metabolic networks using steady-state constraint-based modeling. The starting point is the fundamental steady-state mass balance for intracellular metabolites represented by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times n}$ and a flux vector $v \\in \\mathbb{R}^{n}$, constrained by the linear system\n$$\nS v = 0,\n$$\nwith flux bounds\n$$\n\\ell \\le v \\le u,\n$$\nwhere $\\ell, u \\in \\mathbb{R}^{n}$ are the lower and upper bounds, respectively. The biomass production is modeled by a linear objective function $\\max \\; c^{\\top} v$, where $c \\in \\mathbb{R}^{n}$ is zero everywhere except for the biomass drain reaction(s). Viability is defined by the existence of a feasible steady state with maximal objective value strictly greater than a threshold $\\tau$, where $\\tau$ is a small positive scalar.\n\nA synthetic lethal reaction pair is defined here as an unordered pair of distinct reactions $\\{i,j\\}$ satisfying the following four conditions:\n1. The wild-type (no deletions) maximal objective value is strictly greater than $\\tau$.\n2. The maximal objective value after deletion of reaction $i$ alone is strictly greater than $\\tau$.\n3. The maximal objective value after deletion of reaction $j$ alone is strictly greater than $\\tau$.\n4. The maximal objective value after simultaneous deletion of reactions $i$ and $j$ is less than or equal to $\\tau$ (including infeasibility).\n\nA deletion of reaction $k$ is implemented by enforcing $v_k = 0$.\n\nFor all computations, use the following threshold $\\tau$: $\\tau = 10^{-6}$. All linear programs should be solved as exact maximization of $c^{\\top} v$ subject to $S v = 0$ and $\\ell \\le v \\le u$. If a linear program is infeasible, treat its maximal objective as $0$.\n\nYou must implement a program that, for each test case below, enumerates all unordered reaction index pairs $\\{i,j\\}$ with $0 \\le i lt; j \\le n-1$ that satisfy the synthetic lethality definition above. Use zero-based indexing for reactions. Report each pair as a two-element list $[i,j]$. For each test case, return a list of such pairs, sorted in lexicographic order. The final output must aggregate the lists for all provided test cases in order, producing a single line that is a list containing one element per test case.\n\nTest Suite:\nEach test case provides $(S, \\ell, u, c)$ explicitly.\n\nTest case $1$ (redundant parallel routes to biomass):\n- Metabolites (rows of $S$): $[A, B, C, BM]$.\n- Reactions (columns of $S$): $0:$ uptake $\\rightarrow A$, $1:$ $A \\rightarrow B$, $2:$ $A \\rightarrow C$, $3:$ $B \\rightarrow BM$, $4:$ $C \\rightarrow BM$, $5:$ $BM \\rightarrow$ drain.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{4 \\times 6}$:\n$$\nS = \\begin{bmatrix}\n1  -1  -1  0  0  0 \\\\\n0  1  0  -1  0  0 \\\\\n0  0  1  0  -1  0 \\\\\n0  0  0  1  1  -1\n\\end{bmatrix}.\n$$\n- Bounds $\\ell, u \\in \\mathbb{R}^{6}$:\n$$\n\\ell = [0, 0, 0, 0, 0, 0], \\quad u = [10, 1000, 1000, 1000, 1000, 1000].\n$$\n- Objective vector $c \\in \\mathbb{R}^{6}$:\n$$\nc = [0, 0, 0, 0, 0, 1].\n$$\n\nTest case $2$ (single essential linear pathway, no synthetic lethality expected):\n- Metabolites (rows of $S$): $[A, D, BM]$.\n- Reactions (columns of $S$): $0:$ uptake $\\rightarrow A$, $1:$ $A \\rightarrow D$, $2:$ $D \\rightarrow BM$, $3:$ $BM \\rightarrow$ drain.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{3 \\times 4}$:\n$$\nS = \\begin{bmatrix}\n1  -1  0  0 \\\\\n0  1  -1  0 \\\\\n0  0  1  -1\n\\end{bmatrix}.\n$$\n- Bounds $\\ell, u \\in \\mathbb{R}^{4}$:\n$$\n\\ell = [0, 0, 0, 0], \\quad u = [10, 1000, 1000, 1000].\n$$\n- Objective vector $c \\in \\mathbb{R}^{4}$:\n$$\nc = [0, 0, 0, 1].\n$$\n\nTest case $3$ (reversible interconversion supporting rerouting):\n- Metabolites (rows of $S$): $[A, B, C, BM]$.\n- Reactions (columns of $S$): $0:$ uptake $\\rightarrow A$, $1:$ $A \\rightarrow B$, $2:$ $B \\leftrightarrow C$ (reversible), $3:$ $B \\rightarrow BM$, $4:$ $C \\rightarrow BM$, $5:$ $BM \\rightarrow$ drain.\n- Stoichiometric matrix $S \\in \\mathbb{R}^{4 \\times 6}$:\n$$\nS = \\begin{bmatrix}\n1  -1  0  0  0  0 \\\\\n0  1  -1  -1  0  0 \\\\\n0  0  1  0  -1  0 \\\\\n0  0  0  1  1  -1\n\\end{bmatrix}.\n$$\n- Bounds $\\ell, u \\in \\mathbb{R}^{6}$:\n$$\n\\ell = [0, 0, -1000, 0, 0, 0], \\quad u = [10, 1000, 1000, 1000, 1000, 1000].\n$$\n- Objective vector $c \\in \\mathbb{R}^{6}$:\n$$\nc = [0, 0, 0, 0, 0, 1].\n$$\n\nYour program must:\n- Solve the linear program for each test case to compute the maximal objective.\n- Determine all synthetic lethal pairs per the definition, using $\\tau = 10^{-6}$.\n- Produce a single line of output containing the lists for all test cases as a comma-separated list enclosed in square brackets, with no spaces. For example, a valid output format is $[[[i_1,j_1],[i_2,j_2]],[],[[k_1,\\ell_1]]]$.\n\nThe final answer must be a complete, runnable program as specified. No physical units, angles, or percentages are involved in this problem. All numerical values are given explicitly above without units, and all outputs are lists of integers.",
            "solution": "The problem is assessed to be **valid**. It is scientifically grounded in the well-established field of constraint-based modeling of metabolic networks, specifically Flux Balance Analysis (FBA). The problem is well-posed, providing a clear, formal definition of synthetic lethality and all necessary parameters ($S, \\ell, u, c, \\tau$) to solve for it. The definitions are mathematically precise and objective, with no ambiguities, contradictions, or reliance on non-scientific premises.\n\nThe core of this problem is to identify synthetic lethal reaction pairs by systematically simulating the effect of single and double reaction deletions on a metabolic network's ability to produce biomass. This is achieved using Flux Balance Analysis (FBA), a mathematical approach for analyzing metabolic fluxes at steady-state.\n\nThe metabolic network is described by the steady-state mass balance equation:\n$$\nS v = 0\n$$\nwhere $S \\in \\mathbb{R}^{m \\times n}$ is the stoichiometric matrix for $m$ metabolites and $n$ reactions, and $v \\in \\mathbb{R}^{n}$ is the vector of reaction fluxes. The fluxes are further constrained by lower and upper bounds:\n$$\n\\ell \\le v \\le u\n$$\nThe cellular objective, typically biomass production, is assumed to be a linear combination of fluxes, which we seek to maximize:\n$$\n\\max \\quad c^{\\top} v\n$$\nwhere the vector $c \\in \\mathbb{R}^{n}$ defines the objective function. This formulation constitutes a Linear Program (LP).\n\nA reaction $k$ is deleted (or \"knocked out\") by setting its corresponding flux $v_k$ to zero. This is implemented by modifying its bounds such that $\\ell_k = u_k = 0$.\n\nThe problem defines a synthetic lethal pair $\\{i, j\\}$ based on four conditions related to network viability. Viability is determined by comparing the maximal objective value (biomass production) against a small positive threshold, $\\tau = 10^{-6}$. Let $Z(\\mathcal{K})$ denote the maximal objective value for a network where the set of reactions $\\mathcal{K}$ has been deleted.\nThe conditions for a pair $\\{i, j\\}$ to be synthetic lethal are:\n1.  Wild-type viability: $Z(\\emptyset)  \\tau$\n2.  Single-mutant $i$ viability: $Z(\\{i\\})  \\tau$\n3.  Single-mutant $j$ viability: $Z(\\{j\\})  \\tau$\n4.  Double-mutant lethality: $Z(\\{i, j\\}) \\le \\tau$\n\nTo solve this, a systematic computational procedure is followed for each test case:\n\nFirst, we require a function to solve the FBA problem for a given set of parameters. Standard LP solvers are typically designed for minimization problems of the form $\\min a^{\\top}x$. To solve our maximization problem $\\max c^{\\top}v$, we can equivalently solve $\\min (-c)^{\\top}v$. The optimal value of the maximization is then the negative of the result from the minimization. If the LP is infeasible, the problem states to treat the maximal objective as $0$.\n\nThe algorithm for identifying synthetic lethal pairs is as follows:\n\n1.  **Solve for Wild-Type (WT) Growth**: An LP is solved using the original, unmodified bounds $\\ell$ and $u$. Let the result be $Z_{WT} = Z(\\emptyset)$. If $Z_{WT} \\le \\tau$, the wild-type network is non-viable. According to condition $1$, no synthetic lethal pairs can exist, so the process terminates for this test case, yielding an empty list.\n\n2.  **Evaluate Single Deletions**: For each reaction $k \\in \\{0, 1, \\dots, n-1\\}$, a single-deletion LP is solved. A temporary set of bounds $(\\ell', u')$ is created where $\\ell'_k = u'_k = 0$, and the maximal objective $Z_k = Z(\\{k\\})$ is computed.\n\n3.  **Identify Non-Essential Reactions**: A reaction $k$ is non-essential if its deletion does not render the network non-viable, i.e., $Z_k  \\tau$. Conditions $2$ and $3$ of the synthetic lethality definition require that both reactions in a synthetic lethal pair must be non-essential. We therefore compile a list of all non-essential reaction indices.\n\n4.  **Evaluate Double Deletions**: We iterate through all unique unordered pairs $\\{i, j\\}$ of non-essential reactions, ensuring $i  j$ to maintain lexicographical order and avoid redundant computations. For each pair, a double-deletion LP is solved by setting the bounds for both reaction $i$ and $j$ to zero ($\\ell'_i = u'_i = 0$ and $\\ell'_j = u'_j = 0$).\n\n5.  **Classify Synthetic Lethal Pairs**: Let the result of the double-deletion LP for the pair $\\{i, j\\}$ be $Z_{ij} = Z(\\{i, j\\})$. If $Z_{ij} \\le \\tau$, this satisfies condition $4$. Since conditions $1$, $2$, and $3$ are already satisfied by the preceding steps, the pair $\\{i, j\\}$ is classified as synthetic lethal and added to our results list.\n\nThis procedure exhaustively checks all valid candidate pairs against the four criteria, ensuring a correct and complete enumeration of synthetic lethal pairs for each provided metabolic network model. The final implementation will utilize `numpy` for efficient array and matrix operations, and `scipy.optimize.linprog` to solve the required linear programs.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    Identifies synthetic lethal reaction pairs in metabolic networks using FBA.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([\n                [1, -1, -1, 0, 0, 0],\n                [0, 1, 0, -1, 0, 0],\n                [0, 0, 1, 0, -1, 0],\n                [0, 0, 0, 1, 1, -1]\n            ]),\n            np.array([0, 0, 0, 0, 0, 0], dtype=float),\n            np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float),\n            np.array([0, 0, 0, 0, 0, 1], dtype=float)\n        ),\n        # Test case 2\n        (\n            np.array([\n                [1, -1, 0, 0],\n                [0, 1, -1, 0],\n                [0, 0, 1, -1]\n            ]),\n            np.array([0, 0, 0, 0], dtype=float),\n            np.array([10, 1000, 1000, 1000], dtype=float),\n            np.array([0, 0, 0, 1], dtype=float)\n        ),\n        # Test case 3\n        (\n            np.array([\n                [1, -1, 0, 0, 0, 0],\n                [0, 1, -1, -1, 0, 0],\n                [0, 0, 1, 0, -1, 0],\n                [0, 0, 0, 1, 1, -1]\n            ]),\n            np.array([0, 0, -1000, 0, 0, 0], dtype=float),\n            np.array([10, 1000, 1000, 1000, 1000, 1000], dtype=float),\n            np.array([0, 0, 0, 0, 0, 1], dtype=float)\n        )\n    ]\n    \n    tau = 1e-6\n    all_results = []\n\n    for S, l, u, c in test_cases:\n        sl_pairs = find_synthetic_lethal_pairs(S, l, u, c, tau)\n        all_results.append(sl_pairs)\n\n    # Format output to be a single string without spaces.\n    results_as_strings = []\n    for res in all_results:\n        # Convert list to string and remove spaces\n        res_str = str(res).replace(\" \", \"\")\n        results_as_strings.append(res_str)\n\n    print(f\"[{','.join(results_as_strings)}]\")\n\ndef solve_fba(c_obj, S, l_bounds, u_bounds):\n    \"\"\"\n    Solves the FBA linear program: max c'v s.t. Sv=0, l = v = u.\n    Returns the maximal objective value. Treats infeasible cases as 0.\n    \"\"\"\n    m, n = S.shape\n    b_eq = np.zeros(m)\n    bounds = list(zip(l_bounds, u_bounds))\n\n    # linprog minimizes, so we minimize -c'v to maximize c'v\n    res = linprog(-c_obj, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if res.success:\n        # Return the maximum value (negate the minimized value)\n        return -res.fun\n    else:\n        # Per problem spec, treat infeasible or failed optimization as 0 growth.\n        return 0.0\n\ndef find_synthetic_lethal_pairs(S, l, u, c, tau):\n    \"\"\"\n    Finds all synthetic lethal reaction pairs for a given metabolic model.\n    \"\"\"\n    n_reactions = S.shape[1]\n\n    # 1. Check wild-type viability\n    wt_growth = solve_fba(c, S, l, u)\n    if wt_growth = tau:\n        return []\n\n    # 2. Evaluate all single knockouts\n    single_ko_growths = []\n    for i in range(n_reactions):\n        l_ko = np.copy(l)\n        u_ko = np.copy(u)\n        l_ko[i], u_ko[i] = 0.0, 0.0\n        growth = solve_fba(c, S, l_ko, u_ko)\n        single_ko_growths.append(growth)\n\n    # 3. Identify non-essential reactions (Conditions 2  3)\n    non_essential_indices = [\n        i for i, g in enumerate(single_ko_growths) if g  tau\n    ]\n\n    # 4. Evaluate double knockouts of non-essential reactions\n    sl_pairs = []\n    for i_idx, i in enumerate(non_essential_indices):\n        for j in non_essential_indices[i_idx + 1:]:\n            # Pair is (i, j) with i  j, ensuring lexicographical order and uniqueness\n            l_dko = np.copy(l)\n            u_dko = np.copy(u)\n            l_dko[i], u_dko[i] = 0.0, 0.0\n            l_dko[j], u_dko[j] = 0.0, 0.0\n            \n            dko_growth = solve_fba(c, S, l_dko, u_dko)\n            \n            # 5. Check for synthetic lethality (Condition 4)\n            if dko_growth = tau:\n                sl_pairs.append([i, j])\n                \n    return sl_pairs\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}