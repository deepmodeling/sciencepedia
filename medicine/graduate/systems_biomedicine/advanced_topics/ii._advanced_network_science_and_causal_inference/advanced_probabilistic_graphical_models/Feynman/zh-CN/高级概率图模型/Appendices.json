{
    "hands_on_practices": [
        {
            "introduction": "在系统生物医学中，许多连续变量（如基因表达水平）之间的关系通常用多元高斯分布来建模。掌握高斯分布的条件性质是进行推断和理解模型结构的基础。本练习将从第一性原理出发，推导多元高斯分布中的条件分布公式，并通过一个具体的计算来应用它，这有助于加深对舒尔补 (Schur complement) 在协方差矩阵中所扮演角色的理解 。",
            "id": "4313546",
            "problem": "在一项系统生物医学研究中，两个基因模块的联合对数表达（由随机向量 $X_A \\in \\mathbb{R}^2$ 和 $X_B \\in \\mathbb{R}^2$ 表示）被建模为一个多元正态分布。联合分布为 $X = \\begin{pmatrix} X_A \\\\ X_B \\end{pmatrix} \\sim \\mathcal{N}(\\mu, \\Sigma)$，其均值和协方差被分块表示为\n$$\n\\mu \\;=\\; \\begin{pmatrix} \\mu_A \\\\ \\mu_B \\end{pmatrix}, \n\\qquad\n\\Sigma \\;=\\; \\begin{pmatrix} \\Sigma_{AA}  \\Sigma_{AB} \\\\ \\Sigma_{BA}  \\Sigma_{BB} \\end{pmatrix},\n$$\n其中\n$$\n\\mu_A \\;=\\; \\begin{pmatrix} 0.5 \\\\ -0.2 \\end{pmatrix}, \n\\quad\n\\mu_B \\;=\\; \\begin{pmatrix} 0.1 \\\\ 0.3 \\end{pmatrix}, \n$$\n$$\n\\Sigma_{AA} \\;=\\; \\begin{pmatrix} 1.8  0.3 \\\\ 0.3  1.2 \\end{pmatrix}, \n\\quad\n\\Sigma_{BB} \\;=\\; \\begin{pmatrix} 2.0  0.5 \\\\ 0.5  1.5 \\end{pmatrix}, \n\\quad\n\\Sigma_{AB} \\;=\\; \\begin{pmatrix} 0.6  0.2 \\\\ 0.1  0.5 \\end{pmatrix},\n$$\n且 $\\Sigma_{BA} = \\Sigma_{AB}^{\\top}$。\n\n任务：\n1) 从联合多元正态密度出发，仅使用配方法和标准分块矩阵恒等式等基本线性代数知识，推导出条件分布 $p(X_A \\mid X_B = x_B)$ 的闭合形式。您的推导必须明确指出哪个舒尔补（Schur complement）出现在条件协方差中，并且不能以任何专门的条件高斯公式作为起点。\n\n2) 在观测值为 $X_B = b$，其中 $b = \\begin{pmatrix} 0.2 \\\\ 0.0 \\end{pmatrix}$，且评估点为 $x_A = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix}$ 的情况下，计算条件密度值 $p(X_A = x_A \\mid X_B = b)$。将最终答案表示为一个四舍五入到四位有效数字的实数。\n\n所有矩阵和向量在维度上与生物学背景一致，并假定定义了一个有效的正定协方差。使用对数表达的自然单位；无需进行单位转换。答案必须以实数形式给出，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的。这是一个基于多元统计理论的适定数学问题，提供了所有必要的数据，且没有内部矛盾。\n\n解决方案按要求分为两部分：首先是条件分布的推导，其次是数值计算。\n\n**第1部分：条件分布 $p(X_A \\mid X_B = x_B)$ 的推导**\n\n一个均值为 $\\mu = \\begin{pmatrix} \\mu_A \\\\ \\mu_B \\end{pmatrix}$、协方差为 $\\Sigma = \\begin{pmatrix} \\Sigma_{AA}  \\Sigma_{AB} \\\\ \\Sigma_{BA}  \\Sigma_{BB} \\end{pmatrix}$ 的多元正态随机向量 $X = \\begin{pmatrix} X_A \\\\ X_B \\end{pmatrix}$ 的联合概率密度函数由下式给出：\n$$\np(x_A, x_B) = \\frac{1}{\\sqrt{(2\\pi)^d |\\Sigma|}} \\exp \\left( -\\frac{1}{2} (x-\\mu)^\\top \\Sigma^{-1} (x-\\mu) \\right)\n$$\n其中 $x = \\begin{pmatrix} x_A \\\\ x_B \\end{pmatrix}$，$d$ 是 $X$ 的总维度。条件密度 $p(x_A \\mid x_B)$ 与联合密度成正比，即 $p(x_A \\mid x_B) \\propto p(x_A, x_B)$，在这里我们将 $x_B$ 视为一个固定向量。\n\n推导的核心是分析联合密度指数中的二次型。令 $\\Lambda = \\Sigma^{-1}$ 为精度矩阵，与 $\\Sigma$ 一致地进行分块：\n$$\n\\Lambda = \\begin{pmatrix} \\Lambda_{AA}  \\Lambda_{AB} \\\\ \\Lambda_{BA}  \\Lambda_{BB} \\end{pmatrix}\n$$\n二次型为\n$$\nQ(x_A, x_B) = \\begin{pmatrix} x_A - \\mu_A \\\\ x_B - \\mu_B \\end{pmatrix}^\\top \\begin{pmatrix} \\Lambda_{AA}  \\Lambda_{AB} \\\\ \\Lambda_{BA}  \\Lambda_{BB} \\end{pmatrix} \\begin{pmatrix} x_A - \\mu_A \\\\ x_B - \\mu_B \\end{pmatrix}\n$$\n展开得\n$$\nQ(x_A, x_B) = (x_A-\\mu_A)^\\top \\Lambda_{AA} (x_A-\\mu_A) + (x_A-\\mu_A)^\\top \\Lambda_{AB} (x_B-\\mu_B) + (x_B-\\mu_B)^\\top \\Lambda_{BA} (x_A-\\mu_A) + (x_B-\\mu_B)^\\top \\Lambda_{BB} (x_B-\\mu_B)\n$$\n由于 $\\Lambda$ 是对称的，$\\Lambda_{BA} = \\Lambda_{AB}^\\top$，因此两个交叉项是相等的标量。\n$$\nQ(x_A, x_B) = (x_A-\\mu_A)^\\top \\Lambda_{AA} (x_A-\\mu_A) + 2(x_A-\\mu_A)^\\top \\Lambda_{AB} (x_B-\\mu_B) + (\\text{不含 } x_A \\text{ 的项})\n$$\n为了找到 $p(x_A \\mid x_B)$ 的形式，我们对 $x_A$ 进行配方。涉及 $x_A$ 的项为：\n$$\nx_A^\\top \\Lambda_{AA} x_A - 2\\mu_A^\\top \\Lambda_{AA} x_A + 2(x_B-\\mu_B)^\\top \\Lambda_{BA} x_A = x_A^\\top \\Lambda_{AA} x_A - 2(\\mu_A^\\top \\Lambda_{AA} - (x_B-\\mu_B)^\\top \\Lambda_{BA}) x_A\n$$\n$$\n= x_A^\\top \\Lambda_{AA} x_A - 2(\\Lambda_{AA}\\mu_A - \\Lambda_{AB}(x_B-\\mu_B))^\\top x_A\n$$\n这是一个关于 $x_A$ 的二次型。通过配方，我们可以确定条件高斯分布的均值和协方差。一个二次型 $(x-m)^\\top C^{-1} (x-m)$ 展开为 $x^\\top C^{-1} x - 2m^\\top C^{-1} x + m^\\top C^{-1} m$。\n比较这些项，我们确定条件精度矩阵为 $\\Lambda_{AA}$，条件均值 $\\mu_{A|B}$ 满足 $\\Lambda_{AA}\\mu_{A|B} = \\Lambda_{AA}\\mu_A - \\Lambda_{AB}(x_B-\\mu_B)$。\n\n因此，条件分布 $p(X_A \\mid X_B=x_B)$ 的协方差为：\n$$\n\\Sigma_{A|B} = \\Lambda_{AA}^{-1}\n$$\n条件分布的均值为：\n$$\n\\mu_{A|B} = \\Lambda_{AA}^{-1}(\\Lambda_{AA}\\mu_A - \\Lambda_{AB}(x_B-\\mu_B)) = \\mu_A - \\Lambda_{AA}^{-1}\\Lambda_{AB}(x_B-\\mu_B)\n$$\n为了用 $\\Sigma$ 的分块来表示这些量，我们使用分块矩阵求逆公式：\n$$\n\\Lambda_{AA} = (\\Sigma_{AA} - \\Sigma_{AB}\\Sigma_{BB}^{-1}\\Sigma_{BA})^{-1}\n\\qquad\n\\Lambda_{AB} = -\\Lambda_{AA}\\Sigma_{AB}\\Sigma_{BB}^{-1}\n$$\n根据第一个恒等式，条件协方差为：\n$$\n\\Sigma_{A|B} = \\Lambda_{AA}^{-1} = \\Sigma_{AA} - \\Sigma_{AB}\\Sigma_{BB}^{-1}\\Sigma_{BA}\n$$\n这个表达式 $\\Sigma_{AA} - \\Sigma_{AB}\\Sigma_{BB}^{-1}\\Sigma_{BA}$ 是矩阵 $\\Sigma$ 中块 $\\Sigma_{BB}$ 的**舒尔补（Schur complement）**。\n\n将 $\\Lambda_{AB}$ 的表达式代入均值的方程中：\n$$\n\\mu_{A|B} = \\mu_A - (\\Lambda_{AA}^{-1})(-\\Lambda_{AA}\\Sigma_{AB}\\Sigma_{BB}^{-1})(x_B-\\mu_B) = \\mu_A + \\Sigma_{AB}\\Sigma_{BB}^{-1}(x_B-\\mu_B)\n$$\n因此，条件分布是一个多元正态分布 $p(X_A \\mid X_B=x_B) = \\mathcal{N}(\\mu_{A|B}, \\Sigma_{A|B})$，其均值和协方差如上所推导。\n\n**第2部分：数值计算**\n\n我们需要计算当 $x_A = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix}$ 和 $b = \\begin{pmatrix} 0.2 \\\\ 0.0 \\end{pmatrix}$ 时 $p(X_A = x_A \\mid X_B = b)$ 的值。\n\n1.  **计算 $\\Sigma_{BB}^{-1}$**：\n    $\\det(\\Sigma_{BB}) = (2.0)(1.5) - (0.5)(0.5) = 2.75$。\n    $\\Sigma_{BB}^{-1} = \\frac{1}{2.75} \\begin{pmatrix} 1.5  -0.5 \\\\ -0.5  2.0 \\end{pmatrix}$。\n\n2.  **计算条件均值 $\\mu_{A|B}$**：\n    $\\mu_{A|B} = \\mu_A + \\Sigma_{AB}\\Sigma_{BB}^{-1}(b-\\mu_B)$。\n    $b - \\mu_B = \\begin{pmatrix} 0.2 \\\\ 0.0 \\end{pmatrix} - \\begin{pmatrix} 0.1 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix}$。\n    $\\Sigma_{AB}\\Sigma_{BB}^{-1} = \\begin{pmatrix} 0.6  0.2 \\\\ 0.1  0.5 \\end{pmatrix} \\frac{1}{2.75} \\begin{pmatrix} 1.5  -0.5 \\\\ -0.5  2.0 \\end{pmatrix} = \\frac{1}{2.75} \\begin{pmatrix} 0.8  0.1 \\\\ -0.1  0.95 \\end{pmatrix}$。\n    $\\mu_{A|B} = \\begin{pmatrix} 0.5 \\\\ -0.2 \\end{pmatrix} + \\frac{1}{2.75} \\begin{pmatrix} 0.8  0.1 \\\\ -0.1  0.95 \\end{pmatrix} \\begin{pmatrix} 0.1 \\\\ -0.3 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ -0.2 \\end{pmatrix} + \\frac{1}{2.75} \\begin{pmatrix} 0.05 \\\\ -0.295 \\end{pmatrix} = \\begin{pmatrix} 0.5 + 1/55 \\\\ -0.2 - 59/550 \\end{pmatrix} = \\begin{pmatrix} 57/110 \\\\ -169/550 \\end{pmatrix}$。\n    $\\mu_{A|B} \\approx \\begin{pmatrix} 0.51818 \\\\ -0.30727 \\end{pmatrix}$。\n\n3.  **计算条件协方差 $\\Sigma_{A|B}$**：\n    $\\Sigma_{A|B} = \\Sigma_{AA} - \\Sigma_{AB}\\Sigma_{BB}^{-1}\\Sigma_{BA}$。\n    $\\Sigma_{AB}\\Sigma_{BB}^{-1}\\Sigma_{BA} = \\frac{1}{2.75} \\begin{pmatrix} 0.8  0.1 \\\\ -0.1  0.95 \\end{pmatrix} \\begin{pmatrix} 0.6  0.1 \\\\ 0.2  0.5 \\end{pmatrix} = \\frac{1}{2.75} \\begin{pmatrix} 0.5  0.13 \\\\ 0.13  0.465 \\end{pmatrix} = \\begin{pmatrix} 2/11  13/275 \\\\ 13/275  93/550 \\end{pmatrix}$。\n    $\\Sigma_{A|B} = \\begin{pmatrix} 1.8  0.3 \\\\ 0.3  1.2 \\end{pmatrix} - \\begin{pmatrix} 2/11  13/275 \\\\ 13/275  93/550 \\end{pmatrix} = \\begin{pmatrix} 89/55  139/550 \\\\ 139/550  567/550 \\end{pmatrix}$。\n\n4.  **评估PDF（概率密度函数）**：\n    条件PDF为 $p(x_A \\mid b) = \\frac{1}{\\sqrt{(2\\pi)^2 |\\Sigma_{A|B}|}} \\exp\\left(-\\frac{1}{2} (x_A - \\mu_{A|B})^\\top \\Sigma_{A|B}^{-1} (x_A - \\mu_{A|B})\\right)$。\n    \n    行列式：$|\\Sigma_{A|B}| = (\\frac{89}{55})(\\frac{567}{550}) - (\\frac{139}{550})^2 = \\frac{485309}{302500}$。\n    \n    向量差：$\\Delta x = x_A - \\mu_{A|B} = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix} - \\begin{pmatrix} 57/110 \\\\ -169/550 \\end{pmatrix} = \\begin{pmatrix} -13/110 \\\\ 114/550 \\end{pmatrix} = \\frac{1}{550}\\begin{pmatrix} -65 \\\\ 114 \\end{pmatrix}$。\n    \n    二次型：$Q_A = (\\Delta x)^\\top \\Sigma_{A|B}^{-1} (\\Delta x)$。\n    $\\Sigma_{A|B}^{-1} = \\frac{1}{|\\Sigma_{A|B}|} \\begin{pmatrix} 567/550  -139/550 \\\\ -139/550  89/55 \\end{pmatrix} = \\frac{302500}{485309} \\frac{1}{550} \\begin{pmatrix} 567  -139 \\\\ -139  890 \\end{pmatrix} = \\frac{550}{485309} \\begin{pmatrix} 567  -139 \\\\ -139  890 \\end{pmatrix}$。\n    $Q_A = \\left(\\frac{1}{550}\\begin{pmatrix} -65  114 \\end{pmatrix}\\right) \\left(\\frac{550}{485309} \\begin{pmatrix} 567  -139 \\\\ -139  890 \\end{pmatrix}\\right) \\left(\\frac{1}{550}\\begin{pmatrix} -65 \\\\ 114 \\end{pmatrix}\\right)$。\n    $Q_A = \\frac{1}{550 \\cdot 485309} \\left[ (-65)(567(-65) - 139(114)) + 114(-139(-65) + 890(114)) \\right]$。\n    $Q_A = \\frac{1}{266919450} \\left[ 16021995 \\right] \\approx 0.06002626$。\n    \n    密度值为：\n    $p(x_A \\mid b) = \\frac{1}{2\\pi \\sqrt{\\frac{485309}{302500}}} \\exp\\left(-\\frac{1}{2} \\cdot \\frac{16021995}{266919450}\\right)$。\n    $p(x_A \\mid b) = \\frac{550}{2\\pi \\sqrt{485309}} \\exp(-0.03001313) \\approx \\frac{275}{\\pi (696.641)} \\times 0.970431$。\n    $p(x_A \\mid b) \\approx 0.125655 \\times 0.970431 \\approx 0.121939$。\n\n四舍五入到四位有效数字得到 $0.1219$。",
            "answer": "$$\\boxed{0.1219}$$"
        },
        {
            "introduction": "构建好概率图模型后，我们常常需要根据观测到的证据来推断未知变量的状态，这就是所谓的“推断”问题。对于树状结构的模型，信念传播（或和-积算法）是一种高效的精确推断方法。本练习将以一个简化的生物信号通路为例，指导你逐步完成在连接树上的信念传播过程，从而计算在给定证据下的后验概率 。",
            "id": "4313547",
            "problem": "考虑一个经过整理的系统生物医学通路片段，该片段表示为一个贝叶斯网络，其中包含捕获转录因子激活状态、下游基因表达状态、磷酸化事件状态和检测读数状态的二元变量。令 $X_A \\in \\{0,1\\}$ 表示转录因子的激活状态， $X_B \\in \\{0,1\\}$ 表示目标基因的表达状态， $X_C \\in \\{0,1\\}$ 表示所编码蛋白质的磷酸化状态， $X_E \\in \\{0,1\\}$ 表示一个二元免疫测定读数。其有向边为 $X_A \\rightarrow X_B \\rightarrow X_C \\rightarrow X_E$，编码了联合分布的以下分解形式：\n$$p(x_A,x_B,x_C,x_E) = p(x_A)\\,p(x_B \\mid x_A)\\,p(x_C \\mid x_B)\\,p(x_E \\mid x_C).$$\n假设以下条件概率表 (CPT) 已通过先前的实验得到科学验证：\n- 转录因子的先验概率：$p(X_A=1) = \\frac{2}{5}$，$p(X_A=0) = \\frac{3}{5}$。\n- 给定转录因子下的基因表达：$p(X_B=1 \\mid X_A=1) = \\frac{3}{5}$，$p(X_B=0 \\mid X_A=1) = \\frac{2}{5}$，$p(X_B=1 \\mid X_A=0) = \\frac{1}{5}$，$p(X_B=0 \\mid X_A=0) = \\frac{4}{5}$。\n- 给定基因表达下的磷酸化：$p(X_C=1 \\mid X_B=1) = \\frac{4}{5}$，$p(X_C=0 \\mid X_B=1) = \\frac{1}{5}$，$p(X_C=1 \\mid X_B=0) = \\frac{1}{10}$，$p(X_C=0 \\mid X_B=0) = \\frac{9}{10}$。\n- 给定磷酸化下的检测读数：$p(X_E=1 \\mid X_C=1) = \\frac{9}{10}$，$p(X_E=1 \\mid X_C=0) = \\frac{1}{5}$，$p(X_E=0 \\mid X_C=1) = \\frac{1}{10}$，$p(X_E=0 \\mid X_C=0) = \\frac{4}{5}$。\n假设观测到的检测读数为阳性，即证据为 $X_E = 1$。\n\n构建一个联结树，其团为 $\\{X_A,X_B\\}$、$\\{X_B,X_C\\}$ 和 $\\{X_C,X_E\\}$。识别相邻团之间的分隔集，并使用给定的 CPT 和先验概率初始化团势。在该树上使用信念传播 (BP) 算法（也称为和-积算法）：\n1. 计算从团 $\\{X_A,X_B\\}$ 经过分隔集 $\\{X_B\\}$ 发送到团 $\\{X_B,X_C\\}$ 的消息，并显式地将该消息归一化，使其条目之和为 $1$，同时报告归一化常数。\n2. 计算从团 $\\{X_C,X_E\\}$ 经过分隔集 $\\{X_C\\}$ 发送到团 $\\{X_B,X_C\\}$ 的消息，其中结合了证据 $X_E=1$，并显式地将该消息归一化，使其条目之和为 $1$，同时报告归一化常数。\n3. 通过将根团 $\\{X_B,X_C\\}$ 的初始势与传入的归一化消息相乘，形成其更新后的势，并显式地将该更新后的势归一化，使其条目之和为 $1$，同时报告归一化常数。\n4. 从归一化后的根团势中，通过边缘化求得后验概率 $p(X_B=1 \\mid X_E=1)$。\n\n你必须在每一步验证归一化（即消息条目之和以及更新后的团势条目之和等于 $1$）。请将最终答案表示为最简分数。无需四舍五入，无适用单位。",
            "solution": "问题陈述提供了一个有效的、良构的关于贝叶斯网络的概率推断任务。所有必需的条件概率表 (CPT)、网络结构、证据和目标查询都已明确给出。该问题在系统生物医学建模的背景下具有科学依据，并且没有矛盾或歧义。我将开始解题。\n\n该问题要求在从贝叶斯网络 $X_A \\rightarrow X_B \\rightarrow X_C \\rightarrow X_E$ 派生出的联结树上执行信念传播。给定的联结树是一个团链 $C_1 - C_2 - C_3$，其中 $C_1 = \\{X_A, X_B\\}$，$C_2 = \\{X_B, X_C\\}$，$C_3 = \\{X_C, X_E\\}$。分隔集为 $S_{12} = C_1 \\cap C_2 = \\{X_B\\}$ 和 $S_{23} = C_2 \\cap C_3 = \\{X_C\\}$。我们将 $C_2$ 指定为根团。信念传播算法将执行一个“向根收集”阶段，其中消息从叶团（$C_1$ 和 $C_3$）传递到根团（$C_2$）。\n\n首先，我们将联合分布分解式 $p(x_A,x_B,x_C,x_E) = p(x_A)\\,p(x_B \\mid x_A)\\,p(x_C \\mid x_B)\\,p(x_E \\mid x_C)$ 中的概率因子分配给各个团，以初始化它们的势。\n- 因子 $p(x_A)p(x_B|x_A)$ 被分配给 $C_1$，因此初始势为 $\\psi_1(x_A, x_B) = p(x_A)p(x_B|x_A)$。\n- 因子 $p(x_C|x_B)$ 被分配给 $C_2$，因此初始势为 $\\psi_2(x_B, x_C) = p(x_C|x_B)$。\n- 因子 $p(x_E|x_C)$ 被分配给 $C_3$，因此初始势为 $\\psi_3(x_C, x_E) = p(x_E|x_C)$。\n\n给定的证据是 $X_E=1$。这个证据必须被整合到包含 $X_E$ 的团（即 $C_3$）的势中。我们通过设置 $X_E=1$ 来为 $C_3$ 定义一个新的势：$\\psi'_3(x_C) = \\psi_3(x_C, X_E=1) = p(X_E=1|x_C)$。\n\n现在我们按照问题中列出的四个步骤进行计算。\n\n**1. 计算从 $\\{X_A,X_B\\}$ 到 $\\{X_B,X_C\\}$ 的消息**\n\n消息 $m_{1 \\to 2}$ 从团 $C_1$ 经过分隔集 $S_{12}=\\{X_B\\}$ 发送到 $C_2$。未归一化的消息 $\\tilde{m}_{1 \\to 2}(x_B)$ 是通过将 $C_1$ 中不在 $S_{12}$ 内的变量边缘化掉来计算的。\n$$ \\tilde{m}_{1 \\to 2}(x_B) = \\sum_{x_A \\in \\{0,1\\}} \\psi_1(x_A, x_B) = \\sum_{x_A} p(x_A) p(x_B | x_A) $$\n这个和对应于边缘概率 $p(x_B)$。我们来计算它的值：\n$$ \\tilde{m}_{1 \\to 2}(X_B=1) = p(X_A=1)p(X_B=1|X_A=1) + p(X_A=0)p(X_B=1|X_A=0) = \\left(\\frac{2}{5}\\right)\\left(\\frac{3}{5}\\right) + \\left(\\frac{3}{5}\\right)\\left(\\frac{1}{5}\\right) = \\frac{6}{25} + \\frac{3}{25} = \\frac{9}{25} $$\n$$ \\tilde{m}_{1 \\to 2}(X_B=0) = p(X_A=1)p(X_B=0|X_A=1) + p(X_A=0)p(X_B=0|X_A=0) = \\left(\\frac{2}{5}\\right)\\left(\\frac{2}{5}\\right) + \\left(\\frac{3}{5}\\right)\\left(\\frac{4}{5}\\right) = \\frac{4}{25} + \\frac{12}{25} = \\frac{16}{25} $$\n问题要求对这个消息进行归一化。归一化常数 $Z_1$ 是消息条目之和：\n$$ Z_1 = \\tilde{m}_{1 \\to 2}(X_B=1) + \\tilde{m}_{1 \\to 2}(X_B=0) = \\frac{9}{25} + \\frac{16}{25} = \\frac{25}{25} = 1 $$\n归一化常数为 $1$。因此，归一化后的消息 $m_{1 \\to 2}(x_B) = \\tilde{m}_{1 \\to 2}(x_B) / Z_1$ 与未归一化的消息相同：$m_{1 \\to 2}(X_B=1) = \\frac{9}{25}$ 和 $m_{1 \\to 2}(X_B=0) = \\frac{16}{25}$。作为验证，归一化消息的条目之和必须为 $1$：$\\frac{9}{25} + \\frac{16}{25} = 1$。\n\n**2. 计算从 $\\{X_C,X_E\\}$ 到 $\\{X_B,X_C\\}$ 的消息**\n\n消息 $m_{3 \\to 2}$ 从团 $C_3$ 经过分隔集 $S_{23}=\\{X_C\\}$ 发送到 $C_2$。我们首先将证据 $X_E=1$ 整合到 $C_3$ 的势中，得到 $\\psi'_3(x_C) = p(X_E=1|x_C)$。未归一化的消息 $\\tilde{m}_{3 \\to 2}(x_C)$ 是在整合证据后，对 $C_3$ 中不属于 $S_{23}$ 的变量求和得到的。在这里，$C_3$ 中剩下的唯一变量是 $X_C$，它在分隔集中。因此，消息就是结合了证据的势：\n$$ \\tilde{m}_{3 \\to 2}(x_C) = \\psi'_3(x_C) = p(X_E=1|x_C) $$\n我们来计算它的值：\n$$ \\tilde{m}_{3 \\to 2}(X_C=1) = p(X_E=1|X_C=1) = \\frac{9}{10} $$\n$$ \\tilde{m}_{3 \\to 2}(X_C=0) = p(X_E=1|X_C=0) = \\frac{1}{5} $$\n归一化常数 $Z_3$ 是消息条目之和：\n$$ Z_3 = \\tilde{m}_{3 \\to 2}(X_C=1) + \\tilde{m}_{3 \\to 2}(X_C=0) = \\frac{9}{10} + \\frac{1}{5} = \\frac{9}{10} + \\frac{2}{10} = \\frac{11}{10} $$\n归一化常数为 $\\frac{11}{10}$。归一化后的消息 $m_{3 \\to 2}(x_C) = \\tilde{m}_{3 \\to 2}(x_C) / Z_3$ 是：\n$$ m_{3 \\to 2}(X_C=1) = \\frac{9/10}{11/10} = \\frac{9}{11} $$\n$$ m_{3 \\to 2}(X_C=0) = \\frac{1/5}{11/10} = \\frac{2/10}{11/10} = \\frac{2}{11} $$\n作为验证，其和为 $\\frac{9}{11} + \\frac{2}{11} = 1$。\n\n**3. 在根团 $\\{X_B,X_C\\}$ 处形成并归一化更新后的势**\n\n根团 $C_2 = \\{X_B, X_C\\}$ 处的未归一化更新后势（或信念）是其初始势 $\\psi_2(x_B, x_C)$ 与所有传入的归一化消息的乘积：\n$$ \\tilde{\\beta}_2(x_B, x_C) = \\psi_2(x_B, x_C) \\times m_{1 \\to 2}(x_B) \\times m_{3 \\to 2}(x_C) $$\n我们计算这个势的四个条目：\n$$ \\tilde{\\beta}_2(1,1) = p(X_C=1|X_B=1) \\times m_{1 \\to 2}(1) \\times m_{3 \\to 2}(1) = \\left(\\frac{4}{5}\\right) \\left(\\frac{9}{25}\\right) \\left(\\frac{9}{11}\\right) = \\frac{324}{1375} $$\n$$ \\tilde{\\beta}_2(1,0) = p(X_C=0|X_B=1) \\times m_{1 \\to 2}(1) \\times m_{3 \\to 2}(0) = \\left(\\frac{1}{5}\\right) \\left(\\frac{9}{25}\\right) \\left(\\frac{2}{11}\\right) = \\frac{18}{1375} $$\n$$ \\tilde{\\beta}_2(0,1) = p(X_C=1|X_B=0) \\times m_{1 \\to 2}(0) \\times m_{3 \\to 2}(1) = \\left(\\frac{1}{10}\\right) \\left(\\frac{16}{25}\\right) \\left(\\frac{9}{11}\\right) = \\frac{144}{2750} = \\frac{72}{1375} $$\n$$ \\tilde{\\beta}_2(0,0) = p(X_C=0|X_B=0) \\times m_{1 \\to 2}(0) \\times m_{3 \\to 2}(0) = \\left(\\frac{9}{10}\\right) \\left(\\frac{16}{25}\\right) \\left(\\frac{2}{11}\\right) = \\frac{288}{2750} = \\frac{144}{1375} $$\n归一化常数 $Z_2$ 是这些条目之和：\n$$ Z_2 = \\frac{324}{1375} + \\frac{18}{1375} + \\frac{72}{1375} + \\frac{144}{1375} = \\frac{324+18+72+144}{1375} = \\frac{558}{1375} $$\n归一化常数为 $\\frac{558}{1375}$。归一化后的更新势为 $\\beta_2(x_B, x_C) = \\tilde{\\beta}_2(x_B, x_C) / Z_2$。这个归一化后的势代表后验概率 $p(x_B, x_C|X_E=1)$。其条目之和必须为 $1$，这一点通过除以总和得到了验证。\n\n**4. 通过边缘化求得后验概率 $p(X_B=1 \\mid X_E=1)$**\n\n给定证据下 $X_B$ 的后验概率是通过将归一化的根团势 $\\beta_2(x_B, x_C)$ 对 $X_C$ 进行边缘化来求得的。\n$$ p(X_B=1|X_E=1) = \\sum_{x_C \\in \\{0,1\\}} \\beta_2(X_B=1, x_C) = \\beta_2(1,1) + \\beta_2(1,0) $$\n使用未归一化的值和最终的归一化常数：\n$$ p(X_B=1|X_E=1) = \\frac{\\tilde{\\beta}_2(1,1) + \\tilde{\\beta}_2(1,0)}{Z_2} = \\frac{\\frac{324}{1375} + \\frac{18}{1375}}{\\frac{558}{1375}} = \\frac{\\frac{342}{1375}}{\\frac{558}{1375}} = \\frac{342}{558} $$\n为了得到最终答案，我们必须将此分数化为最简形式。分子和分母都可以被 $2$ 整除：\n$$ \\frac{342}{558} = \\frac{171}{279} $$\n分子的各位数字之和为 $1+7+1=9$，分母的各位数字之和为 $2+7+9=18$。两者都可以被 $9$ 整除：\n$$ \\frac{171}{279} = \\frac{171 \\div 9}{279 \\div 9} = \\frac{19}{31} $$\n由于 $19$ 和 $31$ 都是质数，所以这是最简分数。",
            "answer": "$$ \\boxed{\\frac{19}{31}} $$"
        },
        {
            "introduction": "概率图模型的一个核心优势在于它能清晰地表示变量间的条件独立关系。然而，在实际数据分析中，不恰当的条件作用会引入偏倚，导致错误的结论，其中“对撞偏倚”就是一个典型陷阱。本练习通过一个案例对照研究的例子，让你运用d-分离的规则来分析和理解当对一个对撞节点的后代（如根据疾病状态选择研究对象）进行条件化时，原本独立的风险因素为何会变得相关 。",
            "id": "4313534",
            "problem": "考虑一个用于系统生物医学中病例-对照研究的有向无环图（DAG），其中包含二元变量：两个上游风险因子 $X_1 \\in \\{0,1\\}$ 和 $X_2 \\in \\{0,1\\}$，一个疾病指标 $D \\in \\{0,1\\}$，以及一个患者选择指标 $S \\in \\{0,1\\}$。该图包含边 $X_1 \\rightarrow D \\leftarrow X_2$ 和 $D \\rightarrow S$。在无条件下，$X_1$ 和 $X_2$ 是独立的：$X_1 \\sim \\operatorname{Bern}(p_1)$，$X_2 \\sim \\operatorname{Bern}(p_2)$，且 $P(X_1, X_2) = P(X_1) P(X_2)$。\n\n疾病遵循噪声或（noisy-or）机制：\n$$\nP(D = 1 \\mid X_1 = x_1, X_2 = x_2) = 1 - (1 - q_0) (1 - q_1)^{x_1} (1 - q_2)^{x_2},\n$$\n其中 $q_0$ 是基线激活概率，$q_1, q_2$ 量化了 $X_1$ 和 $X_2$ 对 $D$ 的因果强度。患者选择 $S$ 仅依赖于疾病 $D$：\n$$\nP(S = 1 \\mid D = 1) = s_1, \\quad P(S = 1 \\mid D = 0) = s_0,\n$$\n其中 $0  s_0  s_1  1$。使用 d-分离的定义和贝叶斯网络的概率语义，来推断在无条件和以 $S=1$ 为条件两种情况下，$X_1$ 和 $X_2$ 之间的（不）依赖结构。\n\n为了进行具体评估，取参数 $p_1 = 0.2$，$p_2 = 0.2$，$q_0 = 0.05$，$q_1 = 0.4$，$q_2 = 0.4$，$s_1 = 0.9$ 和 $s_0 = 0.1$。将在选定队列 $S = 1$ 中的条件优势比定义为\n$$\n\\operatorname{OR}(X_1, X_2 \\mid S = 1) = \\frac{P(X_1 = 1, X_2 = 1 \\mid S = 1) \\cdot P(X_1 = 0, X_2 = 0 \\mid S = 1)}{P(X_1 = 1, X_2 = 0 \\mid S = 1) \\cdot P(X_1 = 0, X_2 = 1 \\mid S = 1)}。\n$$\n\n下列哪些陈述是正确的？选择所有适用项。\n\nA. 根据 d-分离，$X_1$ 和 $X_2$ 无条件独立，并且在以 $S=1$ 为条件时保持独立，因为对撞节点的后代节点进行条件化不会影响对撞路径。\n\nB. 以 $S=1$ 为条件会通过对撞节点 $D$ 的后代节点进行条件化，从而打开路径 $X_1 \\rightarrow D \\leftarrow X_2$，在 $X_1$ 和 $X_2$ 之间引入统计依赖性。\n\nC. 使用指定的参数，$\\operatorname{OR}(X_1, X_2 \\mid S = 1)  1$。\n\nD. 使用指定的参数，$\\operatorname{Cov}(X_1, X_2 \\mid S = 1) = 0$。\n\nE. 以 $D=1$ 为条件会保持 $X_1$ 和 $X_2$ 之间的独立性，因为 $D$ 是一个对撞节点。",
            "solution": "用户希望我验证问题陈述，然后提供详细的解决方案。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- **图结构：** 一个有向无环图（DAG），包含二元变量和边 $X_1 \\rightarrow D \\leftarrow X_2$ 以及 $D \\rightarrow S$。\n- **变量：**\n    - $X_1 \\in \\{0,1\\}, X_2 \\in \\{0,1\\}$：上游风险因子。\n    - $D \\in \\{0,1\\}$：疾病指标。\n    - $S \\in \\{0,1\\}$：患者选择指标。\n- **概率模型：**\n    - $X_1 \\sim \\operatorname{Bern}(p_1)$，$X_2 \\sim \\operatorname{Bern}(p_2)$。\n    - 无条件独立性：$P(X_1, X_2) = P(X_1) P(X_2)$。\n    - $D$ 的条件概率（噪声或机制）：$P(D = 1 \\mid X_1 = x_1, X_2 = x_2) = 1 - (1 - q_0) (1 - q_1)^{x_1} (1 - q_2)^{x_2}$。\n    - $S$ 的条件概率：$P(S = 1 \\mid D = 1) = s_1$ 和 $P(S = 1 \\mid D = 0) = s_0$，约束条件为 $0  s_0  s_1  1$。\n- **用于评估的参数：**\n    - $p_1 = 0.2$\n    - $p_2 = 0.2$\n    - $q_0 = 0.05$\n    - $q_1 = 0.4$\n    - $q_2 = 0.4$\n    - $s_1 = 0.9$\n    - $s_0 = 0.1$\n- **定义：**\n    - 选定队列中的条件优势比：\n      $$\n      \\operatorname{OR}(X_1, X_2 \\mid S = 1) = \\frac{P(X_1 = 1, X_2 = 1 \\mid S = 1) \\cdot P(X_1 = 0, X_2 = 0 \\mid S = 1)}{P(X_1 = 1, X_2 = 0 \\mid S = 1) \\cdot P(X_1 = 0, X_2 = 1 \\mid S = 1)}\n      $$\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学基础：** 该问题牢固地植根于概率图模型理论及其在流行病学和系统生物医学中的应用。结构 $X_1 \\rightarrow D \\leftarrow X_2$ 和 $D \\rightarrow S$ 是对撞偏倚（也称为伯克森悖论或选择偏倚）的一个经典例子，这是因果推断和混杂研究中的一个关键概念。噪声或模型是多重原因相互作用的标准参数化方法。\n- **良态性：** 该问题提供了贝叶斯网络的完整规范：一个DAG和每个节点的条件概率分布。所有参数都已给出，问题要求基于此模型评估特定陈述，这是一个定义明确的任务。参数的约束是一致的。\n- **客观性：** 问题陈述使用精确的数学语言表达，没有任何主观性或歧义。\n\n**第3步：结论与行动**\n\n问题陈述是有效的。它在科学上是合理的、良态的且客观的，代表了其领域中的一个典型问题。我将继续进行解答。\n\n### 求解推导\n\n该问题涉及两个风险因子 $X_1$ 和 $X_2$ 之间的（不）依赖关系，既包括无条件情况，也包括以选择变量 $S$ 为条件的情况。\n\n**使用 d-分离分析 DAG：**\n图的结构为 $X_1 \\rightarrow D \\leftarrow X_2$ 和 $D \\rightarrow S$。$X_1$ 和 $X_2$ 之间唯一的路径是 $X_1 \\rightarrow D \\leftarrow X_2$。\n1.  **无条件独立性：** 在路径 $X_1 \\rightarrow D \\leftarrow X_2$上，节点 $D$ 是一个“对撞节点”，因为有两条箭头指向它。根据 d-分离的规则，包含未被条件化的对撞节点的路径是阻塞的。由于这是 $X_1$ 和 $X_2$ 之间的唯一路径，所以 $X_1$ 和 $X_2$ 是 d-分离的。这意味着它们无条件独立，记为 $X_1 \\perp \\! \\! \\! \\perp X_2$。这与问题陈述 $P(X_1, X_2) = P(X_1)P(X_2)$ 一致。\n\n2.  **条件独立性：**\n    *   以对撞节点 $D$ 为条件：d-分离规则指出，对一个对撞节点进行条件化会*打开*该路径。因此，$X_1$ 和 $X_2$ 在给定 $D$ 的情况下不是 d-分离的，这意味着它们在给定 $D$ 的情况下是条件依赖的。我们将其记为 $X_1 \\not\\perp \\! \\! \\! \\perp X_2 \\mid D$。\n    *   以对撞节点的后代节点 $S$ 为条件：节点 $S$ 是对撞节点 $D$ 的一个后代。对对撞节点的后代进行条件化同样会打开该路径。因此，$X_1$ 和 $X_2$ 在给定 $S$ 的情况下不是 d-分离的，意味着它们变为条件依赖。我们将其记为 $X_1 \\not\\perp \\! \\! \\! \\perp X_2 \\mid S$。这种现象是一种选择偏倚。直观地说，如果我们根据一个由疾病（$D$）引起的变量（$S$）来选择研究对象，而该疾病又是由两个独立因子（$X_1, X_2$）引起的，那么在被选中的群体中，这两个因子将表现出统计上的依赖性。\n\n有了这些原则，我们就可以评估每个选项了。\n\n**逐项分析**\n\n**A. 根据 d-分离，$X_1$ 和 $X_2$ 无条件独立，并且在以 $S=1$ 为条件时保持独立，因为对撞节点的后代节点进行条件化不会影响对撞路径。**\n\n这个陈述包含两个论点。第一个论点，$X_1$ 和 $X_2$ 无条件独立，根据我们的 d-分离分析是正确的。然而，第二个论点，即在以 $S=1$ 为条件时它们仍然保持独立，是错误的。其给出的理由，“对撞节点的后代节点进行条件化不会影响对撞路径”，是对 d-分离规则的错误陈述。对对撞节点的后代进行条件化会*打开*路径，从而引入依赖性。\n**结论：错误。**\n\n**B. 以 $S=1$ 为条件会通过对撞节点 $D$ 的后代节点进行条件化，从而打开路径 $X_1 \\rightarrow D \\leftarrow X_2$，在 $X_1$ 和 $X_2$ 之间引入统计依赖性。**\n\n这个陈述是对 d-分离规则的精确和正确应用。路径 $X_1 \\rightarrow D \\leftarrow X_2$ 因对撞节点 $D$ 而在无条件下被阻塞。以 $D$ 的后代节点 $S$ 为条件，会解除该路径的阻塞，从而在 $X_1$ 和 $X_2$ 之间引入统计关联。\n**结论：正确。**\n\n**C. 使用指定的参数，$\\operatorname{OR}(X_1, X_2 \\mid S = 1)  1$。**\n\n要验证这一点，我们必须计算优势比。优势比为 $1$ 对应于独立。既然我们已经从 d-分离中确定 $X_1$ 和 $X_2$ 在以 $S=1$ 为条件下变得依赖，我们预期 $\\operatorname{OR} \\neq 1$。由两个协同原因引起的对撞偏倚中典型的“解释消除”效应表明存在负相关，即 $\\operatorname{OR}  1$。让我们进行计算。\n\n优势比为 $\\operatorname{OR}(X_1, X_2 \\mid S = 1) = \\frac{P(X_1=1,X_2=1 \\mid S=1) \\cdot P(X_1=0,X_2=0 \\mid S=1)}{P(X_1=1,X_2=0 \\mid S=1) \\cdot P(X_1=0,X_2=1 \\mid S=1)}$。\n根据贝叶斯法则，$P(x_1, x_2 \\mid S=1) = \\frac{P(S=1 \\mid x_1, x_2) P(x_1, x_2)}{P(S=1)}$。分母 $P(S=1)$ 在优势比计算中会约掉。所以，\n$$ \\operatorname{OR}(X_1, X_2 \\mid S = 1) = \\frac{\\left[P(S=1 \\mid X_1=1,X_2=1) P(X_1=1,X_2=1)\\right] \\cdot \\left[P(S=1 \\mid X_1=0,X_2=0) P(X_1=0,X_2=0)\\right]}{\\left[P(S=1 \\mid X_1=1,X_2=0) P(X_1=1,X_2=0)\\right] \\cdot \\left[P(S=1 \\mid X_1=0,X_2=1) P(X_1=0,X_2=1)\\right]} $$\n由于 $X_1$ 和 $X_2$ 无条件独立，$P(x_1, x_2) = P(x_1)P(x_2)$，这可以简化为：\n$$ \\operatorname{OR}(X_1, X_2 \\mid S = 1) = \\frac{P(S=1 \\mid X_1=1,X_2=1) \\cdot P(S=1 \\mid X_1=0,X_2=0)}{P(S=1 \\mid X_1=1,X_2=0) \\cdot P(S=1 \\mid X_1=0,X_2=1)} $$\n首先，计算 $P(S=1 \\mid x_1, x_2) = \\sum_d P(S=1 \\mid D=d) P(D=d \\mid x_1, x_2) = s_1 P(D=1 \\mid x_1, x_2) + s_0 (1 - P(D=1 \\mid x_1, x_2)) = s_0 + (s_1 - s_0) P(D=1 \\mid x_1, x_2)$。\n使用 $s_0 = 0.1$ 和 $s_1 = 0.9$，得到 $P(S=1 \\mid x_1, x_2) = 0.1 + 0.8 \\cdot P(D=1 \\mid x_1, x_2)$。\n接下来，使用 $q_0=0.05, q_1=0.4, q_2=0.4$ 计算每种组合的 $P(D=1 \\mid x_1, x_2)$：\n$P(D=1|X_1=0, X_2=0) = 1 - (1-0.05) = 0.05$。\n$P(D=1|X_1=1, X_2=0) = 1 - (1-0.05)(1-0.4) = 1 - (0.95)(0.6) = 1 - 0.57 = 0.43$。\n$P(D=1|X_1=0, X_2=1) = 1 - (1-0.05)(1-0.4) = 1 - (0.95)(0.6) = 1 - 0.57 = 0.43$。\n$P(D=1|X_1=1, X_2=1) = 1 - (1-0.05)(1-0.4)(1-0.4) = 1 - (0.95)(0.36) = 1 - 0.342 = 0.658$。\n\n现在计算 $P(S=1 \\mid x_1, x_2)$：\n$P(S=1|X_1=0, X_2=0) = 0.1 + 0.8 \\cdot (0.05) = 0.1 + 0.04 = 0.14$。\n$P(S=1|X_1=1, X_2=0) = 0.1 + 0.8 \\cdot (0.43) = 0.1 + 0.344 = 0.444$。\n$P(S=1|X_1=0, X_2=1) = 0.1 + 0.8 \\cdot (0.43) = 0.1 + 0.344 = 0.444$。\n$P(S=1|X_1=1, X_2=1) = 0.1 + 0.8 \\cdot (0.658) = 0.1 + 0.5264 = 0.6264$。\n\n最后，计算优势比：\n$$ \\operatorname{OR}(X_1, X_2 \\mid S = 1) = \\frac{(0.6264) \\cdot (0.14)}{(0.444) \\cdot (0.444)} = \\frac{0.087696}{0.197136} \\approx 0.44485 $$\n因为 $0.44485  1$，所以该陈述正确。\n**结论：正确。**\n\n**D. 使用指定的参数，$\\operatorname{Cov}(X_1, X_2 \\mid S = 1) = 0$。**\n\n协方差定义为 $\\operatorname{Cov}(X_1, X_2 \\mid S = 1) = E[X_1 X_2 \\mid S=1] - E[X_1 \\mid S=1]E[X_2 \\mid S=1]$。\n对于二元变量，当且仅当它们的条件协方差为零时，$X_1$ 和 $X_2$ 在给定 $S=1$ 的条件下是条件独立的。也就是说，$\\operatorname{Cov}(X_1, X_2 \\mid S = 1) = 0 \\iff X_1 \\perp \\! \\! \\! \\perp X_2 \\mid S=1$。\n根据 B 中的分析，我们知道以 $S=1$ 为条件会引入依赖性，所以 $X_1 \\not\\perp \\! \\! \\! \\perp X_2 \\mid S=1$。C 中的计算也证实了这一点，它显示优势比不为 $1$。因此，协方差不可能为零。\n**结论：错误。**\n\n**E. 以 $D=1$ 为条件会保持 $X_1$ 和 $X_2$ 之间的独立性，因为 $D$ 是一个对撞节点。**\n\n这个陈述的推理有缺陷。正如我们最初的 d-分离分析所确立的，对像 $D$ 这样的对撞节点进行条件化会*打开*路径 $X_1 \\rightarrow D \\leftarrow X_2$，从而在 $X_1$ 和 $X_2$ 之间*引入*依赖性。该陈述声称的恰恰相反，即对对撞节点进行条件化会保持独立性。\n**结论：错误。**",
            "answer": "$$\\boxed{BC}$$"
        }
    ]
}