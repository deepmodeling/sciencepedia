{
    "hands_on_practices": [
        {
            "introduction": "在能够运用因果网络进行推断之前，我们必须首先学会如何“阅读”它们。此练习的核心是d-分离（d-separation）准则，这是从图结构中判断变量间条件独立性的语法规则。通过分析一个包含对撞（collider）结构的简单基因调控模型，您将练习识别路径何时被阻断或打开，这是理解数据中相关性来源的关键一步。",
            "id": "4318044",
            "problem": "一位研究人员将一个细胞基因调控情景建模为一个贝叶斯网络 (BN) 中的有向无环图 (DAG)，其中节点包括基因表达潜能 $G$、外部刺激 $S$ 和测得的信使RNA表达 $E$。该图具有有向边 $G \\to E$、$S \\to E$ 和 $G \\to S$。假设在马尔可夫性质和常用的忠实性假设下，遵循标准的贝叶斯网络语义。研究人员希望使用 d-分离的概念来判断结构性条件独立关系，其定义如下：如果两个变量之间的一条路径上存在一个非碰撞点且该点在条件集中，或者路径上存在一个碰撞点且该碰撞点及其任何后代都不在条件集中，那么这条路径就被该条件集阻断；否则该路径是活跃的。在马尔可夫和忠实性假设下，d-分离意味着条件独立。\n\n基于此，判断在给定的 DAG 中 $(G, S, E)$ 之间哪些独立关系成立，并解释碰撞结构。选择唯一最佳选项。\n\nA. $G \\perp S$ 和 $G \\perp S \\mid E$ 均成立；$E$ 是一个碰撞点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$。\n\nB. $G \\not\\perp S$ 但 $G \\perp S \\mid E$ 成立；$E$ 是一个碰撞点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$，使得 $G$ 和 $S$ 之间没有活跃路径。\n\nC. $G \\not\\perp S$ 和 $G \\not\\perp S \\mid E$ 均成立；$E$ 是路径 $G \\to E \\leftarrow S$ 上的一个碰撞点，以 $E$ 为条件打开了该碰撞路径，而直接边 $G \\to S$ 仍然是一条活跃路径。\n\nD. $G \\perp S$ 但 $G \\not\\perp S \\mid E$ 成立；$E$ 是一个碰撞点，以 $E$ 为条件打开了路径 $G \\to E \\leftarrow S$。",
            "solution": "### 问题验证\n\n**第一步：提取已知条件**\n\n- **模型：** 一个表示贝叶斯网络 (BN) 的有向无环图 (DAG)。\n- **节点：**\n    - $G$: 基因表达潜能\n    - $S$: 外部刺激\n    - $E$: 测得的信使RNA表达\n- **有向边：** 图结构由边 $G \\to E$、$S \\to E$ 和 $G \\to S$ 定义。\n- **假设：**\n    - 标准的贝叶斯网络语义。\n    - 应用于 DAG 的马尔可夫性质。\n    - 忠实性假设。\n- **关键定义 (d-分离)：** 两个变量之间的路径被一个条件集阻断，如果满足以下任一条件：\n    1. 路径上存在一个非碰撞点，且该点在条件集中，或者\n    2. 路径上存在一个碰撞点，且该碰撞点及其任何后代都不在条件集中。\n    否则，该路径是活跃的。\n- **推理规则：** 在所述假设下，d-分离意味着条件独立。根据忠实性假设，反之亦然：条件独立意味着 d-分离。\n\n**第二步：使用提取的已知条件进行验证**\n\n根据验证标准评估问题陈述：\n\n- **科学基础：** 问题使用了图模型和贝叶斯统计领域中标准且完善的概念（DAG、BN、d-分离、马尔可夫性质、忠实性）。将其应用于基因调控是系统生物学中一个常见且恰当的用例。该模型是一个简化模型，但为了阐明这些原理，它在科学上是合理的。\n- **定义明确：** 问题提供了一个完全指定的 DAG 和一个用于判断条件独立的精确规则（d-分离）。问题是明确的，要求从给定结构中确定一组特定的关系，这会导出一个唯一解。\n- **客观性：** 问题以统计学和计算机科学中常见的精确、形式化的语言陈述。它没有主观或模糊的术语。\n\n问题没有表现出任何诸如科学不合理、信息缺失或逻辑矛盾等缺陷。由边 $G \\to S$、$G \\to E$ 和 $S \\to E$ 给出的 DAG 确实是无环的。前提条件是一致且充分的，足以得出一个确定的答案。\n\n**第三步：结论与行动**\n\n问题是 **有效的**。将推导一个完整的解。\n\n### 解题推导\n\n问题要求我们确定给定贝叶斯网络中节点 $G$、$S$ 和 $E$ 之间的独立关系。网络结构是一个 DAG，节点为 $\\{G, S, E\\}$，有向边为 $\\{G \\to S, G \\to E, S \\to E\\}$。我们使用 d-分离原则来评估独立性。如果两个节点之间的所有路径都被阻断，则它们是独立的（或条件独立的）。\n\n**1. 分析 $G$ 和 $S$ 之间的路径**\n\n$G$ 节点和 $S$ 节点之间有两条路径：\n- **路径1：** 直接边 $G \\to S$。\n- **路径2：** 路径 $G \\to E \\leftarrow S$。\n\n**2. 分析边际独立性 $G \\perp S$**\n\n为了检查边际独立性，我们使用一个空条件集 $\\emptyset$。我们必须检查 $G$ 和 $S$ 之间的所有路径是否都被 $\\emptyset$ 阻断。\n\n- **路径 1 ($G \\to S$)：** 这是一条直接的活跃路径。长度为 1 的路径不能被空集阻断，因为它上面没有中间节点（碰撞点或非碰撞点）。因此，这条路径是 **活跃的**。\n- **路径 2 ($G \\to E \\leftarrow S$)：** 在这条路径上，节点 $E$ 是一个 **碰撞点**，因为有两个箭头指向它 ($G \\to E$ 和 $S \\to E$)。根据 d-分离规则，如果一个包含碰撞点的路径中，该碰撞点及其任何后代都不在条件集中，那么该路径被阻断。这里，条件集是 $\\emptyset$。碰撞点是 $E$。$E$ 不在 $\\emptyset$ 中。在这个图中，节点 $E$ 没有后代。因此，满足了阻断条件。这条路径是 **被阻断的**。\n\n由于路径 1 ($G \\to S$) 是活跃的，并非所有 $G$ 和 $S$ 之间的路径都被阻断。因此，$G$ 和 $S$ 不是 d-分离的。在忠实性假设下，这意味着它们不是边际独立的：$G \\not\\perp S$。\n\n**3. 分析条件独立性 $G \\perp S \\mid E$**\n\n为了检查给定 $E$ 的条件独立性，我们使用条件集 $\\{E\\}$。我们必须检查 $G$ 和 $S$ 之间的所有路径是否都被 $\\{E\\}$ 阻斷。\n\n- **路径 1 ($G \\to S$)：** 该路径不包含任何中间节点。条件变量 $E$ 不在这条路径上。因此，以 $E$ 为条件对这条路径没有影响。它仍然是 **活跃的**。\n- **路径 2 ($G \\to E \\leftarrow S$)：** 这条路径包含碰撞点 $E$。d-分离规则指出，碰撞路径被阻斷，*除非* 碰撞点或其後代在條件集中。这里，碰撞点 $E$ *在* 条件集 $\\{E\\}$ 中。因此，以 $E$ 为条件会 **解除阻断** 或 **打开** 这条路径。路径变得 **活跃**。这是一个经典的“解释消除”效应：了解一个共同效应（$E$）的值可以在其原因（$G$ 和 $S$）之间引入依赖关系。\n\n由于在以 $E$ 为条件时路径 1 和路径 2 都变得活跃，$G$ 和 $S$ 没有被 $E$ d-分离。在忠实性假设下，这意味着它们在给定 $E$ 的情况下不是条件独立的：$G \\not\\perp S \\mid E$。\n\n**研究结果总结：**\n- 边际独立性：$G \\not\\perp S$。\n- 条件独立性：$G \\not\\perp S \\mid E$。\n- 碰撞结构：节点 $E$ 是路径 $G \\to E \\leftarrow S$ 上的一个碰撞点。\n\n### 选项评估\n\n现在，我们根据我们的推导评估每个选项。\n\n**A. $G \\perp S$ 和 $G \\perp S \\mid E$ 均成立；$E$ 是一个碰撞点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$。**\n- 陈述“$G \\perp S$ ... 成立”是 **错误的**。我们发现 $G \\not\\perp S$。\n- 陈述“$G \\perp S \\mid E$ ... 成立”是 **错误的**。我们发现 $G \\not\\perp S \\mid E$。\n- 陈述“以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$”是 **错误的**。以碰撞点为条件会*解除阻断*该路径。\n因此，此选项是 **错误的**。\n\n**B. $G \\not\\perp S$ 但 $G \\perp S \\mid E$ 成立；$E$ 是一个碰撞点，以 $E$ 为条件阻断了路径 $G \\to E \\leftarrow S$，使得 $G$ 和 $S$ 之间没有活跃路径。**\n- 陈述“$G \\not\\perp S$”是正确的。\n- 陈述“$G \\perp S \\mid E$ 成立”是 **错误的**。我们发现 $G \\not\\perp S \\mid E$。\n- 陈述“以 $E$ 为条件阻断了路径”是 **错误的**。\n- 短语“使得 $G$ 和 $S$ 之间没有活跃路径”是 **错误的**，因为路径 $G \\to S$ 仍然活跃，并且路径 $G \\to E \\leftarrow S$ 变得活跃。\n因此，此选项是 **错误的**。\n\n**C. $G \\not\\perp S$ 和 $G \\not\\perp S \\mid E$ 均成立；$E$ 是路径 $G \\to E \\leftarrow S$ 上的一个碰撞点，以 $E$ 为条件打开了该碰撞路径，而直接边 $G \\to S$ 仍然是一条活跃路径。**\n- 陈述“$G \\not\\perp S$ ... 成立”是 **正确的**。\n- 陈述“$G \\not\\perp S \\mid E$ ... 成立”是 **正确的**。\n- 描述“$E$ 是路径 $G \\to E \\leftarrow S$ 上的一个碰撞点”是 **正确的**。\n- 解释“以 $E$ 为条件打开了该碰撞路径”是 **正确的**。\n- 解释“直接边 $G \\to S$ 仍然是一条活跃路径”是 **正确的**。\n根据我们的分析，这个选项准确地描述了 $G$ 和 $S$ 之间关系的所有方面。因此，这个选项是 **正确的**。\n\n**D. $G \\perp S$ 但 $G \\not\\perp S \\mid E$ 成立；$E$ 是一个碰撞点，以 $E$ 为条件打开了路径 $G \\to E \\leftarrow S$。**\n- 陈述“$G \\perp S$ ... 成立”是 **错误的**。由于存在直接边，我们发现 $G \\not\\perp S$。\n- 陈述的其余部分，“$G \\not\\perp S \\mid E$ 成立”以及所提供的理由是正确的，但初始前提是错误的。\n因此，此选项是 **错误的**。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "理解了d-分离的抽象规则后，通过一个具体的计算实例可以更深刻地体会其在实践中的威力，尤其是对撞偏倚（collider bias）的警示。此练习构建了一个线性高斯结构因果模型，您将亲手计算在调节一个对撞节点前后，两个变量间相关性的戏剧性变化。这个过程将清晰地揭示，在没有因果理论指导下的统计“校正”为何可能产生误导性的结论。",
            "id": "4318057",
            "problem": "在一项关于炎症反应的系统生物医学研究中，考虑一个由线性高斯结构因果模型（SCM）建模的因果数据生成过程。设 $U$ 是一个未观测到的全身性炎症因子，它影响两个循环生物标志物 $X$ 和 $Y$。一个分诊评分 $Z$ 由这两个生物标志物计算得出，并用于入院决策。其因果结构由一个有向无环图给出，箭头为 $U \\to X$、$U \\to Y$、$X \\to Z$ 和 $Y \\to Z$，因此 $Z$ 是 $X$ 和 $Y$ 的一个对撞因子。假设这些变量由以下具有独立高斯噪声的线性系统生成：\n$$\nU \\sim \\mathcal{N}(0,1), \\quad \\varepsilon_{1} \\sim \\mathcal{N}(0,1), \\quad \\varepsilon_{2} \\sim \\mathcal{N}(0,1), \\quad \\varepsilon_{3} \\sim \\mathcal{N}\\!\\left(0,\\tfrac{1}{10}\\right),\n$$\n$$\nX = U + \\varepsilon_{1}, \\quad Y = U + \\varepsilon_{2}, \\quad Z = X + Y + \\varepsilon_{3},\n$$\n其中所有四个噪声项相互独立，且独立于 $U$。\n\n仅使用关于多变量正态变量的期望、方差、协方差和相关性的基本定义和经过检验的事实，完成以下任务：\n\n1) 确定 $X$ 和 $Y$ 之间的边际皮尔逊相关性并说明其符号。\n\n2) 一位分析师错误地对对撞因子 $Z$ 进行了调整。在此线性高斯设定下，计算以 $Z$ 为条件的 $X$ 和 $Y$ 之间的皮尔逊相关性。将此伪条件相关性报告为一个精确的实数。\n\n你的最终答案必须是第 2) 部分得到的伪条件相关性的单一数值。不涉及单位。不要四舍五入；请提供精确值。",
            "solution": "用户提供了一个关于线性高斯结构因果模型（SCM）的问题陈述，并要求计算一个边际相关性和一个条件相关性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n问题提供了以下信息：\n- 由有向无环图定义的因果结构：$U \\to X$、$U \\to Y$、$X \\to Z$、$Y \\to Z$。\n- 一组结构方程：\n  - $X = U + \\varepsilon_{1}$\n  - $Y = U + \\varepsilon_{2}$\n  - $Z = X + Y + \\varepsilon_{3}$\n- 外生变量的分布：\n  - $U \\sim \\mathcal{N}(0,1)$\n  - $\\varepsilon_{1} \\sim \\mathcal{N}(0,1)$\n  - $\\varepsilon_{2} \\sim \\mathcal{N}(0,1)$\n  - $\\varepsilon_{3} \\sim \\mathcal{N}(0,\\frac{1}{10})$\n- 一个独立性假设：$U, \\varepsilon_{1}, \\varepsilon_{2}, \\varepsilon_{3}$ 相互独立。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于结构因果模型这一成熟的框架，这是统计学、计量经济学和系统生物学中用于建模因果关系的标准工具。所描述的模型是用于说明混杂和对撞偏倚的典型例子。它在科学上是合理的。\n- **适定性**：该问题是适定的。变量 $(X, Y, Z)$ 是独立高斯变量的线性组合，这意味着它们构成一个多变量正态分布。对于这样的分布，所有的边际和条件相关性都是唯一定义的，并且可以从协方差矩阵中计算出来。\n- **客观性**：问题使用精确的数学语言陈述，没有主观或含糊的术语。\n- 该问题是自洽的、一致的，并且不违反任何物理或数学原理。这是因果推断中的一个标准练习。\n\n**步骤 3：结论和行动**\n问题是有效的。现在推导求解过程。\n\n### 求解推导\n\n求解需要计算两个量：边际相关性 $\\operatorname{Corr}(X, Y)$ 和条件相关性 $\\operatorname{Corr}(X, Y | Z)$。最终答案是第二个量的值。\n\n两个随机变量 $A$ 和 $B$ 之间的皮尔逊相关系数定义为 $\\operatorname{Corr}(A, B) = \\frac{\\operatorname{Cov}(A, B)}{\\sqrt{\\operatorname{Var}(A) \\operatorname{Var}(B)}}$。\n\n首先，我们确定变量 $X$ 和 $Y$ 的均值、方差和协方差。\n均值为：\n$E[X] = E[U + \\varepsilon_{1}] = E[U] + E[\\varepsilon_{1}] = 0 + 0 = 0$。\n$E[Y] = E[U + \\varepsilon_{2}] = E[U] + E[\\varepsilon_{2}] = 0 + 0 = 0$。\n\n方差是利用源变量的独立性计算的：\n$\\operatorname{Var}(X) = \\operatorname{Var}(U + \\varepsilon_{1}) = \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{1}) = 1 + 1 = 2$。\n$\\operatorname{Var}(Y) = \\operatorname{Var}(U + \\varepsilon_{2}) = \\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{2}) = 1 + 1 = 2$。\n\n$X$ 和 $Y$ 之间的协方差为：\n$\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(U + \\varepsilon_{1}, U + \\varepsilon_{2})$。\n利用协方差的双线性和 $U, \\varepsilon_{1}, \\varepsilon_{2}$ 的相互独立性：\n$\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(U, U) + \\operatorname{Cov}(U, \\varepsilon_{2}) + \\operatorname{Cov}(\\varepsilon_{1}, U) + \\operatorname{Cov}(\\varepsilon_{1}, \\varepsilon_{2})$\n$\\operatorname{Cov}(X, Y) = \\operatorname{Var}(U) + 0 + 0 + 0 = 1$。\n\n**1) $X$ 和 $Y$ 之间的边际相关性**\n\n使用上面推导出的量：\n$$\n\\operatorname{Corr}(X, Y) = \\frac{\\operatorname{Cov}(X, Y)}{\\sqrt{\\operatorname{Var}(X) \\operatorname{Var}(Y)}} = \\frac{1}{\\sqrt{2 \\cdot 2}} = \\frac{1}{2}\n$$\n边际相关性为正，这是预期的，因为 $U$ 是 $X$ 和 $Y$ 的共同原因。\n\n**2) 以 $Z$ 为条件的 $X$ 和 $Y$ 之间的伪相关性**\n\n由于 $(X, Y, Z)$ 是联合高斯分布，以 $Z$ 为条件的 $X$ 和 $Y$ 之间的相关性是偏相关 $\\rho_{XY \\cdot Z}$，可以使用以下公式计算：\n$$\n\\rho_{XY \\cdot Z} = \\frac{\\rho_{XY} - \\rho_{XZ}\\rho_{YZ}}{\\sqrt{(1 - \\rho_{XZ}^2)(1 - \\rho_{YZ}^2)}}\n$$\n其中 $\\rho_{AB}$ 表示 $\\operatorname{Corr}(A, B)$。我们已经求得 $\\rho_{XY} = \\frac{1}{2}$。现在我们需要计算 $\\rho_{XZ}$ 和 $\\rho_{YZ}$。这需要 $Z$ 的方差以及协方差 $\\operatorname{Cov}(X, Z)$ 和 $\\operatorname{Cov}(Y, Z)$。\n\n首先，用独立的源变量表示 $Z$：\n$Z = X + Y + \\varepsilon_{3} = (U + \\varepsilon_{1}) + (U + \\varepsilon_{2}) + \\varepsilon_{3} = 2U + \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3}$。\n\n$Z$ 的方差为：\n$\\operatorname{Var}(Z) = \\operatorname{Var}(2U + \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3})$\n由于 $U, \\varepsilon_{1}, \\varepsilon_{2}, \\varepsilon_{3}$ 的相互独立性：\n$\\operatorname{Var}(Z) = \\operatorname{Var}(2U) + \\operatorname{Var}(\\varepsilon_{1}) + \\operatorname{Var}(\\varepsilon_{2}) + \\operatorname{Var}(\\varepsilon_{3}) = 2^2\\operatorname{Var}(U) + \\operatorname{Var}(\\varepsilon_{1}) + \\operatorname{Var}(\\varepsilon_{2}) + \\operatorname{Var}(\\varepsilon_{3})$\n$\\operatorname{Var}(Z) = 4(1) + 1 + 1 + \\frac{1}{10} = 6 + \\frac{1}{10} = \\frac{61}{10}$。\n\n现在，我们计算协方差 $\\operatorname{Cov}(X, Z)$：\n$\\operatorname{Cov}(X, Z) = \\operatorname{Cov}(X, X + Y + \\varepsilon_{3}) = \\operatorname{Cov}(X, X) + \\operatorname{Cov}(X, Y) + \\operatorname{Cov}(X, \\varepsilon_{3})$\n$\\operatorname{Cov}(X, Z) = \\operatorname{Var}(X) + \\operatorname{Cov}(X, Y) + \\operatorname{Cov}(U + \\varepsilon_{1}, \\varepsilon_{3})$\n由于 $U$ 和 $\\varepsilon_{1}$ 独立于 $\\varepsilon_{3}$，所以 $\\operatorname{Cov}(U + \\varepsilon_{1}, \\varepsilon_{3}) = 0$。\n$\\operatorname{Cov}(X, Z) = 2 + 1 + 0 = 3$。\n\n根据模型结构中关于 $X$ 和 $Y$ 的对称性，我们可以推断出 $\\operatorname{Cov}(Y, Z) = 3$。让我们验证一下：\n$\\operatorname{Cov(Y, Z)} = \\operatorname{Cov}(Y, X + Y + \\varepsilon_{3}) = \\operatorname{Cov}(Y, X) + \\operatorname{Var}(Y) + \\operatorname{Cov}(Y, \\varepsilon_{3}) = 1 + 2 + 0 = 3$。\n\n现在我们可以计算相关性 $\\rho_{XZ}$ 和 $\\rho_{YZ}$：\n$$\n\\rho_{XZ} = \\operatorname{Corr}(X, Z) = \\frac{\\operatorname{Cov}(X, Z)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Z)}} = \\frac{3}{\\sqrt{2 \\cdot \\frac{61}{10}}} = \\frac{3}{\\sqrt{\\frac{61}{5}}}\n$$\n$$\n\\rho_{YZ} = \\operatorname{Corr}(Y, Z) = \\frac{\\operatorname{Cov}(Y, Z)}{\\sqrt{\\operatorname{Var}(Y)\\operatorname{Var}(Z)}} = \\frac{3}{\\sqrt{2 \\cdot \\frac{61}{10}}} = \\frac{3}{\\sqrt{\\frac{61}{5}}}\n$$\n我们需要这些相关性的平方：\n$\\rho_{XZ}^2 = \\rho_{YZ}^2 = \\frac{3^2}{(\\sqrt{61/5})^2} = \\frac{9}{61/5} = \\frac{45}{61}$。\n\n现在我们将所有相关性值代入偏相关公式：\n$$\n\\rho_{XY \\cdot Z} = \\frac{\\rho_{XY} - \\rho_{XZ}\\rho_{YZ}}{\\sqrt{(1 - \\rho_{XZ}^2)(1 - \\rho_{YZ}^2)}} = \\frac{\\frac{1}{2} - \\left(\\frac{45}{61}\\right)}{\\sqrt{\\left(1 - \\frac{45}{61}\\right)\\left(1 - \\frac{45}{61}\\right)}} = \\frac{\\frac{1}{2} - \\frac{45}{61}}{1 - \\frac{45}{61}}\n$$\n我们计算分子和分母：\n分子： $\\frac{1}{2} - \\frac{45}{61} = \\frac{61 \\cdot 1 - 45 \\cdot 2}{122} = \\frac{61 - 90}{122} = -\\frac{29}{122}$。\n分母： $1 - \\frac{45}{61} = \\frac{61 - 45}{61} = \\frac{16}{61}$。\n\n最后，条件相关性为：\n$$\n\\rho_{XY \\cdot Z} = \\frac{-29/122}{16/61} = -\\frac{29}{122} \\cdot \\frac{61}{16}\n$$\n由于 $122 = 2 \\cdot 61$，我们可以简化：\n$$\n\\rho_{XY \\cdot Z} = -\\frac{29}{2 \\cdot 61} \\cdot \\frac{61}{16} = -\\frac{29}{2 \\cdot 16} = -\\frac{29}{32}\n$$\n这个结果展示了对撞偏倚现象。以对撞因子 $Z$ 为条件，在 $X$ 和 $Y$ 之间引入了一个强的负相关，改变了它们最初的正边际相关性。\n伪条件相关性恰好是 $-\\frac{29}{32}$。",
            "answer": "$$\\boxed{-\\frac{29}{32}}$$"
        },
        {
            "introduction": "我们已经学习了如何从图中读取独立性，并认识到错误调节变量所带来的偏倚。现在，我们将更进一步，学习如何利用图结构来匡正偏倚，即使存在未观测到的混杂因素。这个练习引入了前门准则（front-door criterion），这是一种强大的因果效应识别策略。通过计算一个信号通路模型中的因果效应$E[Y \\mid do(X=x)]$，您将掌握如何利用中介变量打开一条识别因果关系的“前门”，从而绕过由未观测混杂因子所导致的“后门”路径。",
            "id": "4318079",
            "problem": "考虑一个系统生物医学中的信号模块，该模块由一个有向无环图（DAG）表示，其节点包括受体磷酸化 $X \\in \\{0,1\\}$、衔接蛋白活化 $M \\in \\{0,1\\}$ 和下游转录反应 $Y \\in \\{0,1\\}$。假设该因果结构满足前门准则：存在一条有向路径 $X \\to M \\to Y$；可能存在一个未观测到的 $X$ 和 $Y$ 的共同原因 $U$，其边为 $U \\to X$ 和 $U \\to Y$；不存在从 $X$ 到 $Y$ 绕过 $M$ 的直接效应；并且在以 $X$ 为条件后，不存在 $M$ 和 $Y$ 的未观测到的共同原因。观测分布的经验估计如下：$p(M=1 \\mid X=1) = 0.8$，$p(M=1 \\mid X=0) = 0.2$，对所有 $X$，$p(Y=1 \\mid M=1, X) = 0.7$，对所有 $X$，$p(Y=1 \\mid M=0, X) = 0.1$，以及 $p(X=1) = 0.5$。仅使用干预的语义（do算子）和适用于前门准则的概率法则，从第一性原理推导出 $E[Y \\mid do(X=x)]$ 关于观测量的表达式，并计算因果效应差 $E[Y \\mid do(X=1)] - E[Y \\mid do(X=0)]$。将最终数值答案表示为不带单位的小数。",
            "solution": "该问题要求计算一个生物信号系统的因果效应差 $E[Y \\mid do(X=1)] - E[Y \\mid do(X=0)]$。该系统由一个有向无环图（DAG）描述，涉及受体磷酸化状态 $X$、衔接蛋白活化状态 $M$、下游反应 $Y$ 以及 $X$ 和 $Y$ 的一个未观测到的共同原因 $U$。变量 $X$、$M$ 和 $Y$ 是二元变量，取值为 $\\{0,1\\}$。对于像 $Y$ 这样的二元变量，其期望值等于它处于状态 1 的概率。因此，我们必须计算 $P(Y=1 \\mid do(X=1)) - P(Y=1 \\mid do(X=0))$。\n\n问题陈述该因果结构满足前门准则。这意味着存在一组特定的条件独立性，使我们能够从观测数据中识别出 $X$ 对 $Y$ 的因果效应，即使存在未观测到的混杂因子 $U$。所述结构包含一条因果路径 $X \\to M \\to Y$ 和一条混杂的后门路径 $X \\leftarrow U \\to Y$。前门准则允许我们通过使用中介变量 $M$ 来估计因果效应。\n\n我们将基于 do 算子的语义和前门准则保证的图形属性，从第一性原理推导干预概率 $P(Y=y \\mid do(X=x))$ 的表达式。\n\n首先，我们通过对中介变量 $M$ 的所有状态求和来表示 $X$ 对 $Y$ 的总因果效应。由于问题陈述中没有绕过 $M$ 的从 $X$到 $Y$ 的直接效应，所有 $X$ 对 $Y$ 的影响都必须通过 $M$ 传递。这使得我们可以使用中介公式来链接因果效应：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{m} P(Y=y \\mid do(M=m)) P(M=m \\mid do(X=x)) $$\n这个公式将问题分解为两个子问题：\n1.  识别 $X$ 对 $M$ 的因果效应，由 $P(M=m \\mid do(X=x))$ 给出。\n2.  识别 $M$ 对 $Y$ 的因果效应，由 $P(Y=y \\mid do(M=m))$ 给出。\n\n对于第一项 $P(M=m \\mid do(X=x))$，前门准则要求从 $X$ 到 $M$ 没有未被阻断的后门路径。给定结构中混杂因子 $U$ 只影响 $X$ 和 $Y$，满足此条件。因此，$X$ 对 $M$ 的因果效应等于观测到的条件概率分布：\n$$ P(M=m \\mid do(X=x)) = P(M=m \\mid X=x) $$\n\n对于第二项 $P(Y=y \\mid do(M=m))$，$M$ 和 $Y$ 之间的关系被后门路径 $M \\leftarrow X \\leftarrow U \\to Y$ 所混淆。前门准则要求该路径可以通过以 $X$ 为条件来阻断。因此，我们可以使用后门调整公式来识别 $M$ 对 $Y$ 的因果效应，使用 $X$ 作为调整集：\n$$ P(Y=y \\mid do(M=m)) = \\sum_{x'} P(Y=y \\mid M=m, X=x') P(X=x') $$\n\n结合这两个结果，得到前门调整公式：\n$$ P(Y=y \\mid do(X=x)) = \\sum_{m} P(M=m \\mid X=x) \\left[ \\sum_{x'} P(Y=y \\mid M=m, X=x') P(X=x') \\right] $$\n我们从问题陈述中获得了计算此量所需的所有观测概率。变量 $y$、$m$、$x$ 和 $x'$ 的取值范围都是 $\\{0,1\\}$。\n\n让我们首先计算内层括号中的部分，它代表 $M$ 对 $Y$ 的因果效应，我们将其记为 $P^*(Y=1 \\mid M=m) = P(Y=1 \\mid do(M=m))$。\n给定的数据是：\n- $P(X=1) = 0.5$，这意味着 $P(X=0) = 1 - 0.5 = 0.5$。\n- 对于所有 $X$，$P(Y=1 \\mid M=1, X) = 0.7$。\n- 对于所有 $X$，$P(Y=1 \\mid M=0, X) = 0.1$。\n\n对于 $m=1$：\n$$ P^*(Y=1 \\mid M=1) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=1, X=x') P(X=x') $$\n$$ P^*(Y=1 \\mid M=1) = P(Y=1 \\mid M=1, X=0)P(X=0) + P(Y=1 \\mid M=1, X=1)P(X=1) $$\n$$ P^*(Y=1 \\mid M=1) = (0.7)(0.5) + (0.7)(0.5) = 0.35 + 0.35 = 0.7 $$\n\n对于 $m=0$：\n$$ P^*(Y=1 \\mid M=0) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=0, X=x') P(X=x') $$\n$$ P^*(Y=1 \\mid M=0) = P(Y=1 \\mid M=0, X=0)P(X=0) + P(Y=1 \\mid M=0, X=1)P(X=1) $$\n$$ P^*(Y=1 \\mid M=0) = (0.1)(0.5) + (0.1)(0.5) = 0.05 + 0.05 = 0.1 $$\n\n现在我们计算当 $x=1$ 和 $x=0$ 时，量 $E[Y \\mid do(X=x)] = P(Y=1 \\mid do(X=x))$ 的值。\n\n对于 $x=1$：\n$$ P(Y=1 \\mid do(X=1)) = \\sum_{m \\in \\{0,1\\}} P(M=m \\mid X=1) P^*(Y=1 \\mid M=m) $$\n$$ P(Y=1 \\mid do(X=1)) = P(M=0 \\mid X=1)P^*(Y=1 \\mid M=0) + P(M=1 \\mid X=1)P^*(Y=1 \\mid M=1) $$\n给定 $P(M=1 \\mid X=1) = 0.8$，我们有 $P(M=0 \\mid X=1) = 1 - 0.8 = 0.2$。\n$$ P(Y=1 \\mid do(X=1)) = (0.2)(0.1) + (0.8)(0.7) = 0.02 + 0.56 = 0.58 $$\n所以，$E[Y \\mid do(X=1)] = 0.58$。\n\n对于 $x=0$：\n$$ P(Y=1 \\mid do(X=0)) = \\sum_{m \\in \\{0,1\\}} P(M=m \\mid X=0) P^*(Y=1 \\mid M=m) $$\n$$ P(Y=1 \\mid do(X=0)) = P(M=0 \\mid X=0)P^*(Y=1 \\mid M=0) + P(M=1 \\mid X=0)P^*(Y=1 \\mid M=1) $$\n给定 $P(M=1 \\mid X=0) = 0.2$，我们有 $P(M=0 \\mid X=0) = 1 - 0.2 = 0.8$。\n$$ P(Y=1 \\mid do(X=0)) = (0.8)(0.1) + (0.2)(0.7) = 0.08 + 0.14 = 0.22 $$\n所以，$E[Y \\mid do(X=0)] = 0.22$。\n\n最后，我们计算因果效应差：\n$$ E[Y \\mid do(X=1)] - E[Y \\mid do(X=0)] = 0.58 - 0.22 = 0.36 $$\n这个值表示当受体磷酸化被迫从非激活状态转为激活状态时，下游转录反应概率的平均增加量。",
            "answer": "$$\n\\boxed{0.36}\n$$"
        }
    ]
}