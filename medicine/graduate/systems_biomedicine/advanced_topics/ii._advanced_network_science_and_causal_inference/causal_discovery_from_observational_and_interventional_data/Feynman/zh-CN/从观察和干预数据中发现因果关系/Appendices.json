{
    "hands_on_practices": [
        {
            "introduction": "因果推断的核心挑战之一是区分相关性与因果关系，而潜变量混杂是造成两者差异的关键因素。本练习通过一个简单的线性高斯模型，引导你从第一性原理出发，推导混杂偏倚的具体形式，从而深刻理解为何观测数据上的回归分析可能得出误导性结论。这个练习也将这一统计差异与部分祖先图（PAG）中的双向边概念联系起来，为理解更高级的因果发现算法奠定基础。",
            "id": "4322754",
            "problem": "一个系统生物医学团队研究一个小型基因调控模块，该模块具有两个观测到的信使RNA表达水平$G_{1}$和$G_{2}$，以及一个与这两个基因的启动子结合的未观测到的转录因子$L$。他们收集了两个数据集：一个是在基线条件下的观测数据集，另一个是干预数据集，在干预数据集中，$G_{1}$通过CRISPR干扰扰动（建模为完美干预）被强制设定为一个固定水平。该模块由一个线性高斯结构因果模型建模，其结构方程如下：\n$$\nG_{1} \\;=\\; a_{1} L + \\epsilon_{1}, \\quad G_{2} \\;=\\; a_{2} L + \\epsilon_{2},\n$$\n其中 $L \\sim \\mathcal{N}(0,\\sigma_{L}^{2})$, $\\epsilon_{1} \\sim \\mathcal{N}(0,\\sigma_{1}^{2})$ 和 $\\epsilon_{2} \\sim \\mathcal{N}(0,\\sigma_{2}^{2})$，并且 $L$、$\\epsilon_{1}$ 和 $\\epsilon_{2}$ 相互独立。不存在直接的因果效应 $G_{1} \\to G_{2}$；$G_{1}$ 和 $G_{2}$ 之间所有的关联（如果存在的话）都是通过 $L$ 产生的。干预是do算子 $\\mathrm{do}(G_{1} = g)$，它切断所有指向 $G_{1}$ 的边，并将 $G_{1}$ 的值设为 $g$。\n\n根据因果发现的基本原理，当可能存在潜在混杂因素时，部分祖先图（PAG）是马尔可夫等价类的适当摘要图，而快速因果推断（FCI）算法输出一个PAG，其双向边表示观测变量之间可能存在潜在混杂。\n\n仅使用这些定义和上述模型，进行以下推导：\n- 基于结构方程所蕴含的协方差结构，计算 $G_{2}$ 对 $G_{1}$ 的观测最小二乘回归系数，记为 $\\beta_{\\mathrm{obs}}$。\n- 计算 $G_{1}$ 对 $G_{2}$ 的干预因果效应，定义为导数 $\\beta_{\\mathrm{do}} = \\frac{d}{dg}\\,\\mathbb{E}[\\,G_{2} \\mid \\mathrm{do}(G_{1}=g)\\,]$。\n- 令 $\\Delta = \\beta_{\\mathrm{obs}} - \\beta_{\\mathrm{do}}$。提供一个用 $a_{1}$、$a_{2}$、$\\sigma_{L}^{2}$ 和 $\\sigma_{1}^{2}$ 表示的 $\\Delta$ 的闭式解析表达式，并解释 $\\Delta$ 的符号和大小如何指示由于未观测到的转录因子 $L$ 的存在，在 $G_{1}$ 和 $G_{2}$ 之间的PAG中存在双向边。\n\n你的最终答案必须是 $\\Delta$ 的单个闭式表达式。无需四舍五入，也无需单位。",
            "solution": "经评估，问题陈述有效。它在科学上基于结构因果模型和因果发现的原理，问题提出得很好，目标明确，信息充分，并使用了客观、正式的语言。因此，我们可以进行推导。\n\n问题要求基于所提供的线性高斯结构因果模型（SCM）推导三个量：观测回归系数 $\\beta_{\\mathrm{obs}}$，干预因果效应 $\\beta_{\\mathrm{do}}$，以及它们的差值 $\\Delta = \\beta_{\\mathrm{obs}} - \\beta_{\\mathrm{do}}$。\n\nSCM由以下公式给出：\n$$\nG_{1} = a_{1} L + \\epsilon_{1}\n$$\n$$\nG_{2} = a_{2} L + \\epsilon_{2}\n$$\n其中 $L \\sim \\mathcal{N}(0,\\sigma_{L}^{2})$, $\\epsilon_{1} \\sim \\mathcal{N}(0,\\sigma_{1}^{2})$ 和 $\\epsilon_{2} \\sim \\mathcal{N}(0,\\sigma_{2}^{2})$ 是相互独立的随机变量。\n\n**1. 计算观测回归系数 $\\beta_{\\mathrm{obs}}$**\n\n$G_{2}$ 对 $G_{1}$ 的观测最小二乘回归系数定义为 $\\beta_{\\mathrm{obs}} = \\frac{\\mathrm{Cov}(G_{1}, G_{2})}{\\mathrm{Var}(G_{1})}$。我们首先计算 $G_{1}$ 的方差以及 $G_{1}$ 和 $G_{2}$ 之间的协方差。\n\n$G_{1}$ 的方差是：\n$$\n\\mathrm{Var}(G_{1}) = \\mathrm{Var}(a_{1} L + \\epsilon_{1})\n$$\n由于 $L$ 和 $\\epsilon_{1}$ 是独立的，它们的和的方差是它们方差的和：\n$$\n\\mathrm{Var}(G_{1}) = \\mathrm{Var}(a_{1} L) + \\mathrm{Var}(\\epsilon_{1}) = a_{1}^{2} \\mathrm{Var}(L) + \\mathrm{Var}(\\epsilon_{1})\n$$\n代入给定的方差：\n$$\n\\mathrm{Var}(G_{1}) = a_{1}^{2} \\sigma_{L}^{2} + \\sigma_{1}^{2}\n$$\n\n$G_{1}$ 和 $G_{2}$ 之间的协方差是：\n$$\n\\mathrm{Cov}(G_{1}, G_{2}) = \\mathrm{Cov}(a_{1} L + \\epsilon_{1}, a_{2} L + \\epsilon_{2})\n$$\n使用协方差的双线性性质：\n$$\n\\mathrm{Cov}(G_{1}, G_{2}) = \\mathrm{Cov}(a_{1} L, a_{2} L) + \\mathrm{Cov}(a_{1} L, \\epsilon_{2}) + \\mathrm{Cov}(\\epsilon_{1}, a_{2} L) + \\mathrm{Cov}(\\epsilon_{1}, \\epsilon_{2})\n$$\n由于 $L$、$\\epsilon_{1}$ 和 $\\epsilon_{2}$ 相互独立，涉及不同变量的协方差项为零：\n$$\n\\mathrm{Cov}(G_{1}, G_{2}) = a_{1}a_{2}\\mathrm{Cov}(L, L) + 0 + 0 + 0 = a_{1}a_{2}\\mathrm{Var}(L)\n$$\n代入 $L$ 的给定方差：\n$$\n\\mathrm{Cov}(G_{1}, G_{2}) = a_{1} a_{2} \\sigma_{L}^{2}\n$$\n\n现在，我们可以计算 $\\beta_{\\mathrm{obs}}$：\n$$\n\\beta_{\\mathrm{obs}} = \\frac{\\mathrm{Cov}(G_{1}, G_{2})}{\\mathrm{Var}(G_{1})} = \\frac{a_{1} a_{2} \\sigma_{L}^{2}}{a_{1}^{2} \\sigma_{L}^{2} + \\sigma_{1}^{2}}\n$$\n\n**2. 计算干预因果效应 $\\beta_{\\mathrm{do}}$**\n\n干预因果效应定义为 $\\beta_{\\mathrm{do}} = \\frac{d}{dg}\\,\\mathbb{E}[\\,G_{2} \\mid \\mathrm{do}(G_{1}=g)\\,]$。干预 $\\mathrm{do}(G_{1}=g)$ 通过将 $G_{1}$ 的结构方程替换为赋值 $G_{1}=g$ 来修改SCM，从而切断所有指向 $G_{1}$ 的因果箭头。修改后的SCM为：\n$$\nG_{1} = g\n$$\n$$\nG_{2} = a_{2} L + \\epsilon_{2}\n$$\n外生变量 $L$ 和 $\\epsilon_{2}$ 的分布不受此干预的影响。我们在这个干预后模型中计算 $G_{2}$ 的期望值：\n$$\n\\mathbb{E}[\\,G_{2} \\mid \\mathrm{do}(G_{1}=g)\\,] = \\mathbb{E}[a_{2} L + \\epsilon_{2}]\n$$\n根据期望的线性性质：\n$$\n\\mathbb{E}[\\,G_{2} \\mid \\mathrm{do}(G_{1}=g)\\,] = a_{2}\\mathbb{E}[L] + \\mathbb{E}[\\epsilon_{2}]\n$$\n给定 $L \\sim \\mathcal{N}(0,\\sigma_{L}^{2})$ 和 $\\epsilon_{2} \\sim \\mathcal{N}(0,\\sigma_{2}^{2})$，它们的期望值为 $\\mathbb{E}[L]=0$ 和 $\\mathbb{E}[\\epsilon_{2}]=0$。\n$$\n\\mathbb{E}[\\,G_{2} \\mid \\mathrm{do}(G_{1}=g)\\,] = a_{2}(0) + 0 = 0\n$$\n在干预下，$G_{2}$ 的期望值为 $0$，这是一个不依赖于干预值 $g$ 的常数。因果效应 $\\beta_{\\mathrm{do}}$ 是该期望值相对于 $g$ 的导数：\n$$\n\\beta_{\\mathrm{do}} = \\frac{d}{dg}(0) = 0\n$$\n这个结果是符合预期的，因为在模型中没有从 $G_{1}$ 到 $G_{2}$ 的直接因果路径。通过干预对 $G_1$ 的任何改变都不会对 $G_2$ 产生影响。\n\n**3. $\\Delta$的计算与解释**\n\n量 $\\Delta$ 是观测回归系数与真实因果效应之间的差值：\n$$\n\\Delta = \\beta_{\\mathrm{obs}} - \\beta_{\\mathrm{do}}\n$$\n代入推导出的 $\\beta_{\\mathrm{obs}}$ 和 $\\beta_{\\mathrm{do}}$ 的表达式：\n$$\n\\Delta = \\frac{a_{1} a_{2} \\sigma_{L}^{2}}{a_{1}^{2} \\sigma_{L}^{2} + \\sigma_{1}^{2}} - 0 = \\frac{a_{1} a_{2} \\sigma_{L}^{2}}{a_{1}^{2} \\sigma_{L}^{2} + \\sigma_{1}^{2}}\n$$\n这个量 $\\Delta$ 代表混杂偏倚。它是从观测数据中测得的关联（$\\beta_{\\mathrm{obs}}$）与真实因果效应（$\\beta_{\\mathrm{do}}$）之间的差值。在此模型中，真实的因果效应为零，所以 $\\Delta=\\beta_{\\mathrm{obs}}$。\n\n在部分祖先图（PAG）中存在双向边 $G_{1} \\leftrightarrow G_{2}$ 意味着存在一个潜在的共同原因。像FCI这样的算法通过检测无法用直接因果关系或其他观测变量解释的统计依赖性来推断这种结构。在这个双变量系统中，该算法将检验 $G_{1}$ 和 $G_{2}$ 的边缘依赖性。它们是相关的，当且仅当它们的协方差不为零。根据我们的计算，$\\mathrm{Cov}(G_{1}, G_{2}) = a_{1} a_{2} \\sigma_{L}^{2}$。只要 $a_{1} \\neq 0$、$a_{2} \\neq 0$ 且 $\\sigma_{L}^{2} > 0$，这个协方差就不为零，而这些正是 $L$ 成为一个活跃的共同原因的条件。\n\n量 $\\Delta$ 是这种混杂的直接度量。\n- 如果 $\\Delta = 0$，则意味着 $a_{1}=0$、$a_{2}=0$ 或 $\\sigma_{L}^{2}=0$。在这些情况中的任何一种，混杂路径 $G_{1} \\leftarrow L \\rightarrow G_{2}$ 都会被打破，$G_{1}$ 和 $G_{2}$ 之间没有关联（$\\beta_{\\mathrm{obs}}=0$），因此没有证据表明存在双向边。\n- 如果 $\\Delta \\neq 0$，则存在一个非零的统计关联（$\\beta_{\\mathrm{obs}} \\neq 0$），这完全是由于共同原因 $L$ 造成的，因为真实的因果效应 $\\beta_{\\mathrm{do}}$ 为零。这种关联与因果之间的差异（$\\Delta \\neq 0$）正是混杂的特征。因果发现算法会检测到这种关联，并且在没有直接因果路径可以解释的情况下，会推断出存在一个潜在混杂因素，这在PAG中由双向边 $G_{1} \\leftrightarrow G_{2}$ 表示。\n- $\\Delta$ 的符号和大小量化了混杂程度。其符号由 $a_{1}a_{2}$ 决定，表示混杂因素是引起正相关还是负相关。其大小反映了混杂路径相对于 $G_1$ 总方差的强度。\n\n总之，$\\Delta$ 是由 $L$ 引起的混杂的统计证据，这为在相应的PAG中绘制 $G_{1}$ 和 $G_{2}$ 之间的双向边提供了理由。",
            "answer": "$$\\boxed{\\frac{a_{1} a_{2} \\sigma_{L}^{2}}{a_{1}^{2} \\sigma_{L}^{2} + \\sigma_{1}^{2}}}$$"
        },
        {
            "introduction": "当混杂因素无法被观测时，经典的后门调整方法将失效。本练习展示了一种强大的替代方案——前门准则，它利用一个中介变量来识别被混杂的因果效应。通过逐步应用do-calculus的规则，你将学会如何形式化地处理因果问题，并将不可直接计算的因果量转化为可从观测数据中估计的统计量。",
            "id": "4322794",
            "problem": "考虑一个单细胞中的简易生化信号网络，表示为一个有向无环图 (DAG)。一个潜在的细胞状态 $S$ 调节配体分泌 $L$ 和下游表型 $Y$，一个膜受体磷酸化状态 $R$ 被 $L$ 激活，而 $Y$ 由 $R$ 驱动。结构假设如下：\n- 该 DAG 具有有向边 $S \\to L$、$S \\to Y$、$L \\to R$ 和 $R \\to Y$。\n- 不存在直接的因果边 $L \\to Y$。\n- 不存在边 $S \\to R$。\n因此，所有从 $L$ 到 $Y$ 的有向因果路径都经过 $R$，对于因果效应 $L \\to R$ 没有未测量的混杂，唯一的未测量混杂是通过 $S$ 存在于 $L$ 和 $Y$ 之间。变量均为二元变量：$L \\in \\{0,1\\}$、$R \\in \\{0,1\\}$、$Y \\in \\{0,1\\}$。\n\n使用 do-算子 $\\mathrm{do}(\\cdot)$ 的语义、干预创建的修改图中的 d-分离（进入受干预节点的箭头被移除）以及 do-演算来推导因果效应 $P(Y=1 \\mid \\mathrm{do}(L=1))$。您必须通过相应修改图中的适当 d-分离陈述来证明每次转换的合理性。\n\n给定以下观测分布：\n$$\nP(L=1) = \\frac{1}{2}, \\quad P(L=0) = \\frac{1}{2},\n$$\n$$\nP(R=1 \\mid L=0) = \\frac{1}{5}, \\quad P(R=1 \\mid L=1) = \\frac{4}{5},\n$$\n$$\nP(Y=1 \\mid R=0, L=0) = \\frac{1}{10}, \\quad P(Y=1 \\mid R=0, L=1) = \\frac{3}{10},\n$$\n$$\nP(Y=1 \\mid R=1, L=0) = \\frac{3}{5}, \\quad P(Y=1 \\mid R=1, L=1) = \\frac{7}{10}.\n$$\n对于上述每个条件概率，当 $Y=0$ 时的互补概率是 $1$ 减去所列出的值。\n\n仅从核心定义——因果 DAG 的马尔可夫分解、do-算子语义（进入受干预变量的箭头被移除）、d-分离和 do-演算规则——出发，推导出 $P(Y=1 \\mid \\mathrm{do}(L=1))$ 关于给定观测量的精确封闭形式表达式，并进行数值计算。将最终概率表示为精确的有理数。不需要四舍五入。",
            "solution": "问题要求在一个特定的生化信号网络中，计算配体分泌 $L$ 对下游表型 $Y$ 的因果效应，记为 $P(Y=1 \\mid \\mathrm{do}(L=1))$。该网络的因果结构由一个有向无环图（DAG）给出，我们称之为 $G$。图的节点是 $S$（潜在细胞状态）、$L$（配体）、$R$（受体）和 $Y$（表型）。有向边为 $S \\to L$、$S \\to Y$、$L \\to R$ 和 $R \\to Y$。变量 $S$ 是未观测到的，通过后门路径 $L \\leftarrow S \\to Y$ 充当 $L$ 和 $Y$ 之间关系的混杂因子。由于这种混杂，因果效应无法通过简单的条件化来识别，即 $P(Y=1 \\mid \\mathrm{do}(L=1)) \\neq P(Y=1 \\mid L=1)$。\n\n这个问题可以通过应用 do-演算的原理，根据给定的观测概率推导出因果效应的表达式来解决。指定的图结构是一个满足“前门”准则的典型场景，它允许通过中介变量 $R$ 来识别因果效应。我们将从第一性原理推导前门调整公式。\n\n我们的目标是计算 $P(Y=y \\mid \\mathrm{do}(L=l))$，稍后我们将设 $y=1$ 和 $l=1$。推导过程如下：\n\n首先，我们通过对干预后分布应用全概率定律，将中介变量 $R$ 引入表达式中：\n$$ P(Y=y \\mid \\mathrm{do}(L=l)) = \\sum_{r} P(Y=y \\mid R=r, \\mathrm{do}(L=l)) P(R=r \\mid \\mathrm{do}(L=l)) $$\n这里，求和是针对 $R$ 的所有可能值，即 $r \\in \\{0, 1\\}$。我们现在必须将求和中的这两项（涉及 $\\mathrm{do}$-算子）转换为可以从观测数据中估计的表达式。\n\n1.  **对 $P(R=r \\mid \\mathrm{do}(L=l))$ 的分析**\n    该项表示 $L$ 对 $R$ 的因果效应。如果从 $L$ 到 $R$ 没有开放的后门路径，我们可以使用 do-演算的规则 2，将干预 $\\mathrm{do}(L=l)$ 替换为观测 $L=l$。形式上，如果 $(R \\perp\\!\\!\\perp L)_{G_{\\underline{L}}}$，则 $P(R=r \\mid \\mathrm{do}(L=l)) = P(R=r \\mid L=l)$，其中 $G_{\\underline{L}}$ 是图 $G$ 移除了边 $L \\to R$ 后的图。\n    在我们的图 $G$ 中，$L$ 和 $R$ 之间唯一的后门路径是 $L \\leftarrow S \\to Y \\leftarrow R$。这条路径被阻塞，因为它包含一个对撞节点 $Y$。因此，d-分离条件 $(R \\perp\\!\\!\\perp L)_{G_{\\underline{L}}}$ 成立。\n    因此，我们可以写出：\n    $$ P(R=r \\mid \\mathrm{do}(L=l)) = P(R=r \\mid L=l) $$\n    这个量可以从提供的观测数据中获得。\n\n2.  **对 $P(Y=y \\mid R=r, \\mathrm{do}(L=l))$ 的分析**\n    这一项更复杂。我们的策略是依次应用 do-演算的规则。\n    a. 首先，我们使用规则 2 将观测 $R=r$ 转换为干预 $\\mathrm{do}(R=r)$。如果 $(Y \\perp\\!\\!\\perp R \\mid L)_{G_{\\bar{L}\\underline{R}}}$ 成立，这是允许的。图 $G_{\\bar{L}\\underline{R}}$ 是通过移除指向 $L$ 的入边（即 $S \\to L$）和从 $R$ 指出的出边（即 $R \\to Y$）形成的。在这个修改后的图中，边是 $L \\to R$ 和 $S \\to Y$。$Y$ 和 $R$ 之间没有路径，因此 d-分离条件不言自明地成立。\n    因此，$P(Y=y \\mid R=r, \\mathrm{do}(L=l)) = P(Y=y \\mid \\mathrm{do}(R=r), \\mathrm{do}(L=l))$。\n\n    b. 接下来，我们使用规则 3 移除干预 $\\mathrm{do}(L=l)$。如果 $(Y \\perp\\!\\!\\perp L \\mid R)_{G_{\\bar{L}\\bar{R}}}$ 成立，这是允许的。图 $G_{\\bar{L}\\bar{R}}$ 是通过移除所有指向 $L$ 和 $R$ 的入边（即 $S \\to L$ 和 $L \\to R$）形成的。剩下的边是 $S \\to Y$ 和 $R \\to Y$。在这个图中，$L$ 是一个孤立节点，没有到 $Y$ 的路径。因此，d-分离准则成立。\n    因此，$P(Y=y \\mid \\mathrm{do}(R=r), \\mathrm{do}(L=l)) = P(Y=y \\mid \\mathrm{do}(R=r))$。\n\n    c. 最后，我们必须识别表达式 $P(Y=y \\mid \\mathrm{do}(R=r))$，即 $R$ 对 $Y$ 的因果效应。该效应受到后门路径 $R \\leftarrow L \\leftarrow S \\to Y$ 的混杂。我们可以通过对 $L$ 进行条件化来阻断这条路径，使用后门调整公式。这个公式本身可以从 do-演算中推导出来。我们需要证明 $L$ 满足对 $(R, Y)$ 的后门准则：\n    (i) 在 $G$ 中，$L$ 不是 $R$ 的后代。这是正确的。\n    (ii) $L$ 阻断了 $R$ 和 $Y$ 之间的每一条后门路径。唯一的此类路径是 $R \\leftarrow L \\leftarrow S \\to Y$，它被 $L$ 阻断。这也是正确的。\n    因此，后门调整公式适用：\n    $$ P(Y=y \\mid \\mathrm{do}(R=r)) = \\sum_{l'} P(Y=y \\mid R=r, L=l') P(L=l') $$\n    其中求和是针对 $L$ 的所有值 $l'$。此表达式中的所有量都是观测性的。\n\n综合这些步骤，我们推导出 $P(Y=y \\mid R=r, \\mathrm{do}(L=l)) = \\sum_{l'} P(Y=y \\mid R=r, L=l') P(L=l')$。\n\n现在，我们将这些结果代入原始方程：\n$$ P(Y=y \\mid \\mathrm{do}(L=l)) = \\sum_{r} P(R=r \\mid L=l) \\left( \\sum_{l'} P(Y=y \\mid R=r, L=l') P(L=l') \\right) $$\n这就是前门调整公式。我们现在可以代入给定的数值来计算 $P(Y=1 \\mid \\mathrm{do}(L=1))$。\n\n参数为 $y=1$ 和 $l=1$：\n$$ P(Y=1 \\mid \\mathrm{do}(L=1)) = \\sum_{r \\in \\{0, 1\\}} P(R=r \\mid L=1) \\left( \\sum_{l' \\in \\{0, 1\\}} P(Y=1 \\mid R=r, L=l') P(L=l') \\right) $$\n我们首先为每个 $r$ 值计算内层求和。问题陈述 $P(L=0) = \\frac{1}{2}$ 和 $P(L=1) = \\frac{1}{2}$。\n\n对于 $r=0$:\n$$ \\sum_{l'} P(Y=1 \\mid R=0, L=l') P(L=l') = P(Y=1 \\mid R=0, L=0)P(L=0) + P(Y=1 \\mid R=0, L=1)P(L=1) $$\n$$ = \\left(\\frac{1}{10}\\right) \\left(\\frac{1}{2}\\right) + \\left(\\frac{3}{10}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{20} + \\frac{3}{20} = \\frac{4}{20} = \\frac{1}{5} $$\n\n对于 $r=1$:\n$$ \\sum_{l'} P(Y=1 \\mid R=1, L=l') P(L=l') = P(Y=1 \\mid R=1, L=0)P(L=0) + P(Y=1 \\mid R=1, L=1)P(L=1) $$\n$$ = \\left(\\frac{3}{5}\\right) \\left(\\frac{1}{2}\\right) + \\left(\\frac{7}{10}\\right) \\left(\\frac{1}{2}\\right) = \\frac{3}{10} + \\frac{7}{20} = \\frac{6}{20} + \\frac{7}{20} = \\frac{13}{20} $$\n\n现在我们可以计算最终表达式。我们需要 $P(R=r \\mid L=1)$。给定 $P(R=1 \\mid L=1) = \\frac{4}{5}$。\n因此，$P(R=0 \\mid L=1) = 1 - P(R=1 \\mid L=1) = 1 - \\frac{4}{5} = \\frac{1}{5}$。\n\n将这些代入主公式：\n$$ P(Y=1 \\mid \\mathrm{do}(L=1)) = P(R=0 \\mid L=1) \\left(\\frac{1}{5}\\right) + P(R=1 \\mid L=1) \\left(\\frac{13}{20}\\right) $$\n$$ = \\left(\\frac{1}{5}\\right) \\left(\\frac{1}{5}\\right) + \\left(\\frac{4}{5}\\right) \\left(\\frac{13}{20}\\right) $$\n$$ = \\frac{1}{25} + \\frac{52}{100} = \\frac{1}{25} + \\frac{13}{25} $$\n$$ = \\frac{14}{25} $$\n设置 $L=1$ 对 $Y=1$ 概率的因果效应是 $\\frac{14}{25}$。",
            "answer": "$$\\boxed{\\frac{14}{25}}$$"
        },
        {
            "introduction": "真实的科学探索常常需要结合观测数据和实验干预数据来揭示复杂的因果网络。本综合练习将引导你应用因果马尔可夫条件和忠实性假设，整合这两种数据类型来重构一个生物信号通路的部分因果图。你需要利用条件独立性约束来确定图的骨架和v-结构，再利用干预实验的结果来进一步确定边的方向，最终深入理解马尔可夫等价类及其包含的因果图数量。",
            "id": "4322795",
            "problem": "一个系统生物医学团队研究一个细胞因子信号模块，该模块涉及在观测和完美干预两种机制下于稳态时测量的六个分子变量。设这些变量为 $X_J$ (Janus激酶活性, JAK)，$X_S$ (信号转导与转录激活因子3磷酸化, STAT3)，$X_C$ (细胞因子信号传导抑制因子3表达, SOCS3)，$X_L$ (白细胞介素-6浓度, IL-6)，$X_K$ (活化B细胞的核因子κ-轻链增强子激活, NF-$\\kappa$B) 和 $X_T$ (肿瘤坏死因子浓度, TNF)。假设因果充足性、无环性，并且观测联合分布对于底层的因果有向无环图（DAG）是忠实的。该团队从大样本观测数据中估计出以下最小条件独立性约束（所示的条件集是最小的，并且在给定剩余变量的任何子集的情况下，没有其他条件独立性成立）：\n- $X_J \\perp X_L \\mid \\emptyset$\n- $X_J \\perp X_K \\mid \\emptyset$\n- $X_J \\perp X_T \\mid \\emptyset$\n- $X_J \\perp X_C \\mid \\{X_S\\}$\n- $X_L \\perp X_C \\mid \\{X_S\\}$\n- $X_K \\perp X_S \\mid \\{X_L\\}$\n- $X_T \\perp X_S \\mid \\{X_L\\}$\n- $X_K \\perp X_C \\mid \\{X_L, X_S\\}$\n- $X_T \\perp X_C \\mid \\{X_L, X_S\\}$\n\n该团队还进行了Pearl的$\\operatorname{do}(\\cdot)$算子意义下的完美干预：\n- 在$\\operatorname{do}(X_J=x)$下，只有$X_S$和$X_C$的分布发生变化；$X_L$，$X_K$和$X_T$的分布保持不变。\n- 在$\\operatorname{do}(X_S=s)$下，只有$X_C$的分布发生变化；$X_J$，$X_L$，$X_K$和$X_T$的分布保持不变。\n- 没有对$X_L$，$X_K$或$X_T$进行干预。\n\n任务：仅使用d-分离、因果马尔可夫条件、忠实性以及切断指向被干预节点的入边的完美干预语义的基本定义，首先构建与上述约束一致的、代表马尔可夫等价类的完全部分有向无环图（CPDAG）。然后，使用马尔可夫等价类的定义和CPDAG中链组件的性质，确定该等价类中不同DAG的数量。请以单个精确整数形式提供最终答案。无需四舍五入，也无需单位。",
            "solution": "用户希望我解决一个因果发现问题。\n\n### 步骤1：提取给定信息\n**变量：** 变量集合为 $\\mathcal{V} = \\{X_J, X_S, X_C, X_L, X_K, X_T\\}$，代表6个分子组分。\n**假设：**\n1.  因果充足性：不存在未测量的共同原因。\n2.  无环性：因果图是一个有向无环图（DAG）。\n3.  忠实性：观测联合分布对于底层的因果DAG是忠实的。这意味着分布中的所有条件独立性都由DAG的d-分离性质所蕴含。\n\n**观测数据（条件独立性约束）：**\n所提供的最小条件独立性（CI）列表是详尽无遗的。\n1.  $X_J \\perp X_L \\mid \\emptyset$\n2.  $X_J \\perp X_K \\mid \\emptyset$\n3.  $X_J \\perp X_T \\mid \\emptyset$\n4.  $X_J \\perp X_C \\mid \\{X_S\\}$\n5.  $X_L \\perp X_C \\mid \\{X_S\\}$\n6.  $X_K \\perp X_S \\mid \\{X_L\\}$\n7.  $X_T \\perp X_S \\mid \\{X_L\\}$\n8.  $X_K \\perp X_C \\mid \\{X_L, X_S\\}$\n9.  $X_T \\perp X_C \\mid \\{X_L, X_S\\}$\n\n**干预数据：**\n1.  在$\\operatorname{do}(X_J=x)$下：$X_S$和$X_C$的分布改变；$X_L, X_K, X_T$的分布不变。\n2.  在$\\operatorname{do}(X_S=s)$下：$X_C$的分布改变；$X_J, X_L, X_K, X_T$的分布不变。\n\n### 步骤2：使用提取的给定信息进行验证\n该问题在科学上植根于因果推断和系统生物学领域，利用了诸如DAG、d-分离、忠实性和Pearl的$\\operatorname{do}$-演算等标准且定义明确的概念。问题是客观的，提供了精确的约束。它是自洽的，似乎没有内部矛盾。所提供的数据（观测和干预数据）是用于推断图结构的形式化约束。问题是适定的，导向一个唯一的因果图马尔可夫等价类。问题并非微不足道，需要系统地应用因果发现算法。它没有违反任何无效性标准。\n\n### 步骤3：结论和行动\n问题被认为是有效的。将提供一个完整的解决方案。\n\n### 解答\n\n任务有两部分：首先，构建代表与给定数据一致的DAG马尔可夫等价类的完全部分有向无环图（CPDAG），其次，确定该等价类中不同DAG的数量。\n\n#### 第1部分：从观测数据构建因果图\n\n我们使用一种基于约束的方法，类似于PC算法，该方法包括三个主要阶段：骨架发现、v-结构定向和方向传播。\n\n**1. 骨架发现：**\n因果图的骨架是一个无向图，其中任意两个变量之间存在一条边，当且仅当它们在给定其他变量的任何子集下都不是条件独立的。问题指出，给定的9个条件独立性是唯一成立的。因此，不在该列表中的任何变量对之间都存在一条边。变量对的总数为$\\binom{6}{2} = 15$。给出了9个不相邻的对。剩下的$15 - 9 = 6$对必须是相邻的。\n\n不相邻的对（没有边）是：\n$(X_J, X_L), (X_J, X_K), (X_J, X_T), (X_J, X_C), (X_L, X_C), (X_K, X_S), (X_T, X_S), (X_K, X_C), (X_T, X_C)$。\n\n相邻的对（在骨架中有边）是：\n1.  $X_J - X_S$\n2.  $X_S - X_C$\n3.  $X_S - X_L$\n4.  $X_L - X_K$\n5.  $X_L - X_T$\n6.  $X_K - X_T$\n\n因此，骨架由这6条边构成。\n\n**2. V-结构定向：**\n我们识别未屏蔽的对撞节点（v-结构）。一个未屏蔽三元组是一组三个节点$X-Y-Z$，其中$X$和$Z$不相邻。如果中间节点$Y$不在使$X$和$Z$条件独立的最小分离集$S_{XZ}$中，则该三元组被定向为v-结构$X \\to Y \\leftarrow Z$。\n\n让我们检查骨架中所有的未屏蔽三元组：\n-   $X_J-X_S-X_L$：节点$X_J$和$X_L$不相邻。条件独立性为$X_J \\perp X_L \\mid \\emptyset$。分离集为$S_{JL} = \\emptyset$。中间节点$X_S$不在$S_{JL}$中。因此，这是一个v-结构：$X_J \\to X_S \\leftarrow X_L$。\n-   $X_J-X_S-X_C$：节点$X_J$和$X_C$不相邻。条件独立性为$X_J \\perp X_C \\mid \\{X_S\\}$。分离集为$S_{JC} = \\{X_S\\}$。中间节点$X_S$在$S_{JC}$中。这不是一个v-结构。\n-   $X_C-X_S-X_L$：节点$X_C$和$X_L$不相邻。条件独立性为$X_L \\perp X_C \\mid \\{X_S\\}$。分离集为$S_{LC} = \\{X_S\\}$。中间节点$X_S$在$S_{LC}$中。这不是一个v-结构。\n-   $X_S-X_L-X_K$：节点$X_S$和$X_K$不相邻。条件独立性为$X_K \\perp X_S \\mid \\{X_L\\}$。分离集为$S_{SK} = \\{X_L\\}$。中间节点$X_L$在$S_{SK}$中。这不是一个v-结构。\n-   $X_S-X_L-X_T$：节点$X_S$和$X_T$不相邻。条件独立性为$X_T \\perp X_S \\mid \\{X_L\\}$。分离集为$S_{ST} = \\{X_L\\}$。中间节点$X_L$在$S_{ST}$中。这不是一个v-结构。\n\n唯一识别出的v-结构是 $X_J \\to X_S \\leftarrow X_L$。\n\n**3. 方向传播（Meek法则）：**\n我们对部分有向图应用定向规则来定向更多的边，确保不产生新的v-结构或环。\n-   **法则1（避免新v-结构）：** 如果我们有$A \\to B - C$且$A, C$不相邻，我们必须将边定向为$B \\to C$。\n    -   我们有结构$X_J \\to X_S - X_C$。节点$X_J$和$X_C$不相邻。应用此法则，我们必须将$X_S-X_C$定向为$X_S \\to X_C$。如果我们将它定向为$X_S \\leftarrow X_C$，我们会创建一个新的v-结构$X_J \\to X_S \\leftarrow X_C$，根据忠实性，这将意味着$X_J \\perp X_C \\mid \\emptyset$。这与给定的条件独立性$X_J \\perp X_C \\mid \\{X_S\\}$相矛盾。\n-   重复应用此法则及其他Meek法则，根据观测数据无法找到更多强制性的方向。例如，考虑一个非v-结构的三元组，如$X_S-X_L-X_K$，我们知道$X_S \\leftarrow X_L$（来自v-结构）。该三元组要么是链$X_S \\leftarrow X_L \\leftarrow X_K$，要么是叉$X_S \\leftarrow X_L \\to X_K$。两者都与$X_L$在分离集$S_{SK}$中相一致，因此仅凭此信息无法定向边$X_L-X_K$。\n\n从观测数据推导出的CPDAG是：\n-   有向边：$X_J \\to X_S$, $X_L \\to X_S$, $X_S \\to X_C$。\n-   无向边：$X_L - X_K$, $X_L - X_T$, $X_K - X_T$。这些边在顶点集$\\{X_L, X_K, X_T\\}$上构成一个团。\n\n#### 第2部分：整合干预数据\n\n完美干预$\\operatorname{do}(X=x)$的效果是在真实DAG中移除所有指向$X$的入边。因此，只有$X$及其后代节点的分布会改变。\n-   $\\operatorname{do}(X_J=x)$：$X_S$和$X_C$改变，而$X_L, X_K, X_T$不变。这意味着在真实DAG中，$\\{X_S, X_C\\}$必须是$X_J$的后代，而$\\{X_L, X_K, X_T\\}$则不能是。我们当前的CPDAG中存在有向路径$X_J \\to X_S \\to X_C$，这与干预结果一致。它也显示没有从$X_J$到$\\{X_L, X_K, X_T\\}$中任何一个节点的有向路径。此干预证实了$X_J \\to X_S$和$X_S \\to X_C$的方向，但没有为定向剩余的边提供新信息。\n-   $\\operatorname{do}(X_S=s)$：$X_C$改变，而$X_J, X_L, X_K, X_T$不变。这意味着$X_C$是$X_S$的后代，而$\\{X_J, X_L, X_K, X_T\\}$不是。\n    -   $X_S \\to X_C$的方向是一致的。\n    -   在我们的CPDAG中，$X_J$和$X_L$是$X_S$的父节点（$X_J \\to X_S, X_L \\to S$），因此它们是祖先而不是后代。这是一致的。\n    -   $\\{X_K, X_T\\}$中的节点要成为$X_S$的后代，必须存在一条有向路径$X_S \\to \\dots \\to X_K$（或$X_T$）。这样的路径必须经过$X_L$。然而，在CPDAG中，$X_L$和$X_S$之间的边是一条强制边$X_L \\to X_S$。等价类中的任何DAG都必须包含这条边。从$X_S$到$X_L$的有向路径会产生一个环（$X_S \\to \\dots \\to X_L \\to X_S$），这是不允许的。因此，不可能存在从$X_S$到$\\{X_L, X_K, X_T\\}$中任何节点的有向路径。这已经是观测CPDAG所蕴含的结论。\n\n干预数据与从观测数据推导出的CPDAG一致，但没有提供额外的约束来定向剩余的无向边。最终的CPDAG保持不变。\n\n#### 第3部分：计算等价类中的DAG数量\n\n最终的CPDAG具有以下结构：\n-   有向边：$X_J \\to X_S$, $X_L \\to X_S$, $X_S \\to X_C$。\n-   在顶点集$\\{X_L, X_K, X_T\\}$上的一个无向团。\n\n这个CPDAG代表一个DAG的马尔可夫等价类。该类中所有的DAG都必须包含这三条有向边。它们之间的差异在于无向边的方向。节点集$\\{X_L, X_K, X_T\\}$及其间的无向边构成一个单独的链组件。\n\n为了求出该类中DAG的数量，我们必须计算在不产生环或新v-结构的情况下，对该链组件的边进行定向的方法数。\n1.  **环：** 在$\\{X_L, X_K, X_T\\}$团内部定向边只可能在该团内部产生环。无法与图的其余部分形成环，因为唯一的连接是$X_L \\to X_S$，并且没有从$\\{J, S, C\\}$回到$\\{L, K, T\\}$的路径。因此，该团的任何无环定向都是全局无环的。\n2.  **新v-结构：** 一个新的v-结构$A \\to B \\leftarrow C$要求$A$和$C$不相邻。如果我们在$\\{X_L, X_K, X_T\\}$团内部定向边，任何潜在的对撞节点$B \\in \\{X_L, X_K, X_T\\}$的父节点$A, C$也都在该团内。但是在团中的所有节点都是相互邻接的。因此，任何形成的$A \\to B \\leftarrow C$结构都会是屏蔽的对撞节点，而不是v-结构。\n\n因此，该等价类中DAG的数量就是将无向团$\\{X_L, X_K, X_T\\}$的边定向以形成一个DAG的方法数。一个有$k$个顶点的完全无向图（团）可以通过$k!$种方式定向成一个DAG，这对应于这$k$个顶点的$k!$种可能的拓扑排序。\n\n对于$\\{X_L, X_K, X_T\\}$上的团，我们有$k=3$个顶点。\n不同DAG的数量是 $k! = 3! = 3 \\times 2 \\times 1 = 6$。",
            "answer": "$$\\boxed{6}$$"
        }
    ]
}