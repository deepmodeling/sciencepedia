{
    "hands_on_practices": [
        {
            "introduction": "理解药物作用的基础在于量化其与分子靶点的结合程度。此练习将药物在体内的时变浓度（药代动力学）与基于质量作用定律的不同亲和力靶点的分数占据率联系起来。掌握这项练习将使您能够预测药物对靶点网络的瞬时效应，这是药理学中的一项核心技能 ()。",
            "id": "4336175",
            "problem": "在一个组织水平的药物-靶标相互作用网络中，一个小分子配体 $L$ 通过独立的边 $L + T_{i} \\rightleftharpoons LT_{i}$（对于 $i \\in \\{1,2,3\\}$）与三个不同的靶标节点 $T_{1}$、$T_{2}$ 和 $T_{3}$ 结合。该系统在特定条件下进行研究，其中每个靶标的结合动力学相对于配体浓度的时间变化而言是快速的，且靶标是不可耗尽的，从而使得游离配体的浓度等于药代动力学浓度曲线。配体的药代动力学浓度曲线由以下双指数函数给出\n$$\n[L](t) = 1.2 \\times 10^{4}\\,\\exp(-0.3\\,t) + 3.0 \\times 10^{3}\\,\\exp(-0.02\\,t),\n$$\n其中 $t$ 是以 $\\mathrm{h}$ 为单位的时间，$ [L](t) $ 的单位是 $\\mathrm{nM}$。三个靶标边的平衡解离常数分别为 $K_{d,1} = 50\\,\\mathrm{nM}$，$K_{d,2} = 500\\,\\mathrm{nM}$ 和 $K_{d,3} = 5000\\,\\mathrm{nM}$。\n\n严格从可逆结合的质量作用定律、平衡解离常数 $K_{d,i}$ 的定义以及靶标质量守恒出发，推导每个靶标边的分数占有率 $\\theta_{i}(t)$ 关于 $[L](t)$ 和 $K_{d,i}$ 的表达式。然后，使用该表达式构建加权网络占有率\n$$\nO(t) = w_{1}\\,\\theta_{1}(t) + w_{2}\\,\\theta_{2}(t) + w_{3}\\,\\theta_{3}(t),\n$$\n其中边权重为 $w_{1} = 0.5$，$w_{2} = 0.3$ 和 $w_{3} = 0.2$，并计算在 $t = 24\\,\\mathrm{h}$ 时的 $O(t)$。将 $O(24\\,\\mathrm{h})$ 以无单位小数形式报告，并四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估具有科学依据、提法明确、客观且完整。所有提供的数据、条件和假设在物理和数学上都是一致的，构成了一个化学动力学和药理学中的标准问题。因此，该问题被认为是有效的，并将提供解答。\n\n第一个任务是为每个靶标边推导分数占有率 $\\theta_{i}(t)$ 的表达式。分析从规定的基本原理开始。\n\n对于每个靶标 $T_i$，配体 $L$ 的可逆结合由以下平衡描述：\n$$\nL + T_{i} \\rightleftharpoons LT_{i}\n$$\n其中 $i \\in \\{1,2,3\\}$。\n\n应用于平衡状态的质量作用定律定义了平衡解离常数 $K_{d,i}$：\n$$\nK_{d,i} = \\frac{[L][T_i]}{[LT_i]}\n$$\n在此表达式中，$[L]$ 是游离配体的浓度，$[T_i]$ 是游离靶标的浓度，$[LT_i]$ 是配体-靶标复合物的浓度。\n\n靶标的质量守恒原理要求靶标的总浓度 $[T_i]_{\\text{total}}$ 是游离形式和结合形式之和：\n$$\n[T_i]_{\\text{total}} = [T_i] + [LT_i]\n$$\n分数占有率 $\\theta_i$ 定义为与配体结合的靶标占总靶标群体的比例：\n$$\n\\theta_i = \\frac{[LT_i]}{[T_i]_{\\text{total}}}\n$$\n将靶标守恒的表达式代入分母，得到：\n$$\n\\theta_i = \\frac{[LT_i]}{[T_i] + [LT_i]}\n$$\n为了用 $[L]$ 和 $K_{d,i}$ 表示 $\\theta_i$，我们首先重新整理 $K_{d,i}$ 的定义式，以求解游离靶标浓度 $[T_i]$：\n$$\n[T_i] = K_{d,i} \\frac{[LT_i]}{[L]}\n$$\n现在，将这个 $[T_i]$ 的表达式代入 $\\theta_i$ 方程的分母中：\n$$\n\\theta_i = \\frac{[LT_i]}{K_{d,i} \\frac{[LT_i]}{[L]} + [LT_i]}\n$$\n假设存在不可忽略的结合量（$[LT_i] > 0$），我们可以从分母中提出 $[LT_i]$ 并与分子相消：\n$$\n\\theta_i = \\frac{1}{\\frac{K_{d,i}}{[L]} + 1}\n$$\n将分子和分母同乘以 $[L]$，得到最终的、更常见的形式，即希尔-朗缪尔方程（Hill-Langmuir equation）：\n$$\n\\theta_i = \\frac{[L]}{[L] + K_{d,i}}\n$$\n问题陈述指出，结合动力学是快速的且靶标是不可耗尽的，这证明了在任何给定时间 $t$ 使用此平衡表达式并将游离配体浓度 $[L]$ 等同于给定的药代动力学浓度曲线 $[L](t)$ 是合理的。因此，每个靶标随时间变化的分数占有率为：\n$$\n\\theta_i(t) = \\frac{[L](t)}{[L](t) + K_{d,i}}\n$$\n推导至此完成。\n\n第二个任务是计算在 $t = 24\\,\\mathrm{h}$ 时的加权网络占有率 $O(t)$。首先，我们必须计算在 $t=24\\,\\mathrm{h}$ 时的配体浓度 $[L](t)$。\n药代动力学曲线由下式给出：\n$$\n[L](t) = 1.2 \\times 10^{4}\\,\\exp(-0.3\\,t) + 3.0 \\times 10^{3}\\,\\exp(-0.02\\,t)\n$$\n代入 $t = 24\\,\\mathrm{h}$：\n$$\n[L](24) = 1.2 \\times 10^{4}\\,\\exp(-0.3 \\times 24) + 3.0 \\times 10^{3}\\,\\exp(-0.02 \\times 24)\n$$\n$$\n[L](24) = 1.2 \\times 10^{4}\\,\\exp(-7.2) + 3.0 \\times 10^{3}\\,\\exp(-0.48)\n$$\n计算指数项并求出浓度：\n$$\n[L](24) \\approx (1.2 \\times 10^{4})(7.4658 \\times 10^{-4}) + (3.0 \\times 10^{3})(0.61878)\n$$\n$$\n[L](24) \\approx 8.9590 + 1856.35\n$$\n$$\n[L](24) \\approx 1865.31\\,\\mathrm{nM}\n$$\n我们将此值记为 $L_{24}$。所以，$L_{24} \\approx 1865.31\\,\\mathrm{nM}$。\n\n接下来，我们使用推导出的公式和给定的 $K_d$ 值：$K_{d,1} = 50\\,\\mathrm{nM}$，$K_{d,2} = 500\\,\\mathrm{nM}$ 和 $K_{d,3} = 5000\\,\\mathrm{nM}$，计算在 $t=24\\,\\mathrm{h}$ 时每个靶标的分数占有率。\n对于靶标 $T_1$：\n$$\n\\theta_1(24) = \\frac{L_{24}}{L_{24} + K_{d,1}} = \\frac{1865.31}{1865.31 + 50} = \\frac{1865.31}{1915.31} \\approx 0.97389\n$$\n对于靶标 $T_2$：\n$$\n\\theta_2(24) = \\frac{L_{24}}{L_{24} + K_{d,2}} = \\frac{1865.31}{1865.31 + 500} = \\frac{1865.31}{2365.31} \\approx 0.78861\n$$\n对于靶标 $T_3$：\n$$\n\\theta_3(24) = \\frac{L_{24}}{L_{24} + K_{d,3}} = \\frac{1865.31}{1865.31 + 5000} = \\frac{1865.31}{6865.31} \\approx 0.27170\n$$\n最后，我们使用给定的权重 $w_{1} = 0.5$，$w_{2} = 0.3$ 和 $w_{3} = 0.2$ 计算加权网络占有率 $O(24\\,\\mathrm{h})$：\n$$\nO(t) = w_{1}\\,\\theta_{1}(t) + w_{2}\\,\\theta_{2}(t) + w_{3}\\,\\theta_{3}(t)\n$$\n$$\nO(24) = (0.5)\\,\\theta_{1}(24) + (0.3)\\,\\theta_{2}(24) + (0.2)\\,\\theta_{3}(24)\n$$\n$$\nO(24) \\approx (0.5)(0.97389) + (0.3)(0.78861) + (0.2)(0.27170)\n$$\n$$\nO(24) \\approx 0.486945 + 0.236583 + 0.054340\n$$\n$$\nO(24) \\approx 0.777868\n$$\n根据要求，将结果四舍五入到四位有效数字：\n$$\nO(24\\,\\mathrm{h}) \\approx 0.7779\n$$",
            "answer": "$$\\boxed{0.7779}$$"
        },
        {
            "introduction": "药物的治疗效果不仅取决于其峰值效应，还取决于其作用在一段时间内的持续时间和强度。此练习通过在时间范围内对瞬时占据率进行积分来计算累积结合量，从而建立在前一个练习的基础上。它引入了一个加权函数来模拟药物预期疗效与非预期毒性之间的平衡 ()。",
            "id": "4336195",
            "problem": "一种小分子药物在人体系统中与多个蛋白质靶点结合，通过单次静脉快速推注给药。该系统可以使用一级消除和快速结合动力学的一室药代动力学（PK）模型进行建模，该动力学在效应部位达到准平衡状态。假设血浆中的游离药物浓度近似于效应部位的浓度。每个靶点的药效学（PD）靶点占有率通过标准的质量作用平衡占有率模型进行建模。在有限时间范围内的累积网络级靶点占有率定义为靶点占有率的加权和，以反映有益和有害通路的影响。\n\n考虑以下科学上合理且自洽的设定：\n- 剂量为 $D = 100$ mg，分布容积为 $V = 10$ L，分子量为 $M = 500$ g/mol，血浆中的游离（未结合）分数为 $f_u = 0.5$。消除速率常数为 $k = 0.2$ h$^{-1}$。\n- 有两个靶点：靶点 $\\mathrm{E}$（与疗效相关）的平衡解离常数为 $K_{d,E} = 100$ nM，靶点 $\\mathrm{T}$（与毒性相关）的平衡解离常数为 $K_{d,T} = 1000$ nM。\n- 设游离药物浓度随时间变化的函数为 $C_{\\mathrm{free}}(t)$，靶点 $i \\in \\{\\mathrm{E}, \\mathrm{T}\\}$ 的占有率（分数占有）为 $\\theta_i(t) = \\dfrac{C_{\\mathrm{free}}(t)}{K_{d,i} + C_{\\mathrm{free}}(t)}$，这是在靶点丰度远低于配体浓度时，由平衡质量作用结合推导出的。\n- 定义网络级占有函数为 $\\theta(t) = w_E\\,\\theta_E(t) - w_T\\,\\theta_T(t)$，其中权重 $w_E = 1.0$ 和 $w_T = 0.5$ 分别代表驱动疗效的占有强度和驱动毒性的占有所带来的惩罚。\n- 时间范围为 $T = 24$ h。\n\n从上述基本的 PK-PD 定义和质量作用定律出发，计算累积靶点占有率\n$$\\int_0^T \\theta(t)\\,dt.$$\n结果以小时为单位，并将最终数值结果四舍五入至四位有效数字。除了进行计算，解答还必须阐明累积占有积分对于多靶点药物的疗效和毒性的科学相关性，并基于所述模型和假设进行解释。",
            "solution": "该问题是有效的，因为它科学地基于已建立的药代动力学（PK）和药效学（PD）原理，问题设定良好，提供了所有必要信息，并使用客观、可形式化的语言。\n\n首先，我们阐述待计算量的科学相关性。累积靶点占有率，由积分 $\\int_0^T \\theta(t)\\,dt$ 表示，是系统药理学中用于量化药物在特定时间段内总体效应的基本概念。被积函数 $\\theta(t) = w_E\\,\\theta_E(t) - w_T\\,\\theta_T(t)$ 代表药物的瞬时净效应，它平衡了药物对疗效靶点（E）的有益作用和对毒性靶点（T）的有害作用。这个函数的积分，通常被称为“效应曲线下面积”，汇集了在整个时间范围 $T$ 内的净效应。项 $\\int_0^T w_E\\,\\theta_E(t)\\,dt$ 量化了总的有益占有，假设其与总体治疗效果相关。相反，项 $\\int_0^T w_T\\,\\theta_T(t)\\,dt$ 量化了总的毒性占有，这与不良反应的累积负担有关。因此，总积分 $\\int_0^T \\theta(t)\\,dt$ 是衡量药物在有限时期内治疗指数的一个关键 PK/PD 指标。最大化该值是药物设计和剂量优化的一个关键目标，因为它旨在最大化治疗效益，同时最小化毒理学风险，从而反映出药物有利的效益-风险概况。\n\n现在，我们进行计算。\n\n第一步是确定游离药物浓度随时间变化的函数 $C_{\\mathrm{free}}(t)$。对于单次静脉快速推注的一室模型，总血浆浓度根据以下方程呈指数衰减：\n$C_{\\mathrm{total}}(t) = C_{\\mathrm{total}}(0) \\exp(-kt)$\n其中 $k$ 是消除速率常数，$C_{\\mathrm{total}}(0)$ 是初始总浓度。\n\n我们根据剂量 $D$ 和分布容积 $V$ 计算 $C_{\\mathrm{total}}(0)$。首先，我们必须确保单位一致。我们将剂量从质量单位转换为摩尔，然后计算摩尔浓度。\n剂量（克）：$D = 100$ mg $= 0.1$ g。\n分子量：$M = 500$ g/mol。\n药物摩尔数：$n = \\frac{D}{M} = \\frac{0.1\\,\\text{g}}{500\\,\\text{g/mol}} = 2 \\times 10^{-4}$ mol。\n初始总浓度：$C_{\\mathrm{total}}(0) = \\frac{n}{V} = \\frac{2 \\times 10^{-4}\\,\\text{mol}}{10\\,\\text{L}} = 2 \\times 10^{-5}$ M。\n\n平衡解离常数 $K_d$ 以纳摩尔（nM）为单位。我们将 $C_{\\mathrm{total}}(0)$ 转换为 nM：\n$C_{\\mathrm{total}}(0) = 2 \\times 10^{-5}\\,\\text{mol/L} \\times \\frac{10^9\\,\\text{nmol/mol}}{1} = 20000$ nM。\n\n问题陈述血浆中的游离药物浓度近似于效应部位的浓度。游离浓度通过游离分数 $f_u$ 与总浓度相关：\n$C_{\\mathrm{free}}(t) = f_u \\times C_{\\mathrm{total}}(t)$。\n初始游离浓度，我们记为 $C_0$，为：\n$C_0 = C_{\\mathrm{free}}(0) = f_u \\times C_{\\mathrm{total}}(0) = 0.5 \\times 20000\\,\\text{nM} = 10000$ nM。\n\n因此，游离药物浓度随时间变化的函数为：\n$C_{\\mathrm{free}}(t) = C_0 \\exp(-kt) = 10000 \\exp(-0.2t)$，其中 $t$ 的单位是小时。\n\n问题要求计算累积靶点占有率：\n$$I = \\int_0^T \\theta(t)\\,dt = \\int_0^T \\left(w_E\\,\\theta_E(t) - w_T\\,\\theta_T(t)\\right) dt$$\n代入靶点占有率的表达式 $\\theta_i(t) = \\dfrac{C_{\\mathrm{free}}(t)}{K_{d,i} + C_{\\mathrm{free}}(t)}$，我们得到：\n$$I = \\int_0^T \\left( w_E \\frac{C_{\\mathrm{free}}(t)}{K_{d,E} + C_{\\mathrm{free}}(t)} - w_T \\frac{C_{\\mathrm{free}}(t)}{K_{d,T} + C_{\\mathrm{free}}(t)} \\right) dt$$\n我们可以将积分分成两部分：\n$$I = w_E \\int_0^T \\frac{C_0 \\exp(-kt)}{K_{d,E} + C_0 \\exp(-kt)} dt - w_T \\int_0^T \\frac{C_0 \\exp(-kt)}{K_{d,T} + C_0 \\exp(-kt)} dt$$\n让我们求解积分的一般形式 $\\int \\frac{C_0 \\exp(-kt)}{K_{d} + C_0 \\exp(-kt)} dt$。我们使用换元法。令 $u = K_{d} + C_0 \\exp(-kt)$。那么，其微分为 $du = -k C_0 \\exp(-kt) dt$，这意味着 $C_0 \\exp(-kt) dt = -\\frac{1}{k} du$。\n积分变为：\n$$\\int \\frac{1}{u} \\left(-\\frac{1}{k}\\right) du = -\\frac{1}{k} \\ln|u|$$\n将 $u$ 代回并计算从 $0$ 到 $T$ 的定积分：\n$$\\int_0^T \\frac{C_0 \\exp(-kt)}{K_{d} + C_0 \\exp(-kt)} dt = \\left[ -\\frac{1}{k} \\ln\\left(K_{d} + C_0 \\exp(-kt)\\right) \\right]_0^T$$\n$$= -\\frac{1}{k} \\left[ \\ln\\left(K_{d} + C_0 \\exp(-kT)\\right) - \\ln\\left(K_{d} + C_0 \\exp(-k \\cdot 0)\\right) \\right]$$\n$$= \\frac{1}{k} \\left[ \\ln\\left(K_{d} + C_0\\right) - \\ln\\left(K_{d} + C_0 \\exp(-kT)\\right) \\right] = \\frac{1}{k} \\ln\\left(\\frac{K_{d} + C_0}{K_{d} + C_0 \\exp(-kT)}\\right)$$\n现在我们将这个结果应用于总积分 $I$ 的疗效和毒性部分：\n$$I = \\frac{w_E}{k} \\ln\\left(\\frac{K_{d,E} + C_0}{K_{d,E} + C_0 \\exp(-kT)}\\right) - \\frac{w_T}{k} \\ln\\left(\\frac{K_{d,T} + C_0}{K_{d,T} + C_0 \\exp(-kT)}\\right)$$\n我们代入给定的数值：\n$C_0 = 10000$ nM\n$k = 0.2$ h$^{-1}$\n$T = 24$ h\n$w_E = 1.0$\n$w_T = 0.5$\n$K_{d,E} = 100$ nM\n$K_{d,T} = 1000$ nM\n\n指数项为 $kT = 0.2 \\times 24 = 4.8$。\n因此, $\\exp(-kT) = \\exp(-4.8)$。\n\n对于疗效部分：\n$$I_E = \\frac{1.0}{0.2} \\ln\\left(\\frac{100 + 10000}{100 + 10000 \\exp(-4.8)}\\right) = 5 \\ln\\left(\\frac{10100}{100 + 10000 \\exp(-4.8)}\\right)$$\n$$I_E \\approx 5 \\ln\\left(\\frac{10100}{100 + 10000 \\times 0.00822975}\\right) = 5 \\ln\\left(\\frac{10100}{182.2975}\\right) \\approx 5 \\ln(55.4042) \\approx 5 \\times 4.014704 \\approx 20.07352$$\n\n对于毒性部分：\n$$I_T = \\frac{0.5}{0.2} \\ln\\left(\\frac{1000 + 10000}{1000 + 10000 \\exp(-4.8)}\\right) = 2.5 \\ln\\left(\\frac{11000}{1000 + 10000 \\exp(-4.8)}\\right)$$\n$$I_T \\approx 2.5 \\ln\\left(\\frac{11000}{1000 + 82.2975}\\right) = 2.5 \\ln\\left(\\frac{11000}{1082.2975}\\right) \\approx 2.5 \\ln(10.16357) \\approx 2.5 \\times 2.318817 \\approx 5.79704$$\n\n总累积占有率为两者之差：\n$$I = I_E - I_T \\approx 20.07352 - 5.79704 = 14.27648$$\n占有率 $\\theta_i$ 是无量纲的，时间 $t$ 的单位是小时（h），所以积分的单位是小时。\n将结果四舍五入到四位有效数字，得到 $14.28$。\n最终结果以小时为单位表示。",
            "answer": "$$\\boxed{14.28}$$"
        },
        {
            "introduction": "系统药理学的一个主要目标是计算预测新的药物-靶点相互作用，但我们如何知道我们的预测是否有意义？这个问题解决了评估药物-靶点相互作用（DTI）预测模型的关键任务，特别是在已知相互作用和非相互作用之间存在巨大类别不平衡的情况下。它要求从第一性原理出发，理解为什么在这种情况下，像精确率-召回率曲线下面积（AUPRC）这样的指标比受试者工作特征曲线下面积（AUROC）更具信息量 ()。",
            "id": "4336153",
            "problem": "在高度不平衡的二部图上评估药物-靶点相互作用（DTI）预测器时，两个常用的指标是受试者工作特征曲线下面积（AUROC）和精确率-召回率曲线下面积（AUPRC）。考虑一个DTI筛选任务，其中一个评分函数为每个药物-靶点对分配一个连续分数，旨在反映其相互作用的概率。令 $Y \\in \\{0,1\\}$ 表示真实的相互作用标签，$S \\in \\mathbb{R}$ 表示分数。对于一个阈值 $ \\tau \\in \\mathbb{R}$，当 $S \\ge \\tau$ 时，导出的分类器预测为阳性。受试者工作特征（ROC）曲线绘制了当 $\\tau$ 变化时真阳性率（TPR）对假阳性率（FPR）的图像，而精确率-召回率（PR）曲线则绘制了当 $\\tau$ 变化时精确率对召回率的图像。在这里，召回率是 $\\mathbb{P}(S \\ge \\tau \\mid Y=1)$，精确率是 $\\mathbb{P}(Y=1 \\mid S \\ge \\tau)$。\n\n仅使用上述核心概率定义和全概率定律，从第一性原理出发，论证为什么AUROC对类别不平衡相对不敏感，而AUPRC直接依赖于基线阳性率 $ \\pi = \\mathbb{P}(Y=1)$。然后，在随机、无信息的评分函数（即分数 $S$ 与标签 $Y$ 独立，$S \\perp Y$）的假设下，用 $ \\pi $ 推导出期望的AUPRC。\n\n最后，考虑一个真实的DTI二部图设置，其中有 $N_D = 1200$ 种药物和 $N_T = 18000$ 个靶点，以及 $M = 150000$ 个已知的相互作用对，所有未知的配对在评估中均被视为阴性。在此设置下，首先将基线阳性率表示为 $ \\pi = \\frac{M}{N_D N_T} $，然后将其代入你推导出的表达式中，计算随机评分模型的期望AUPRC。将你的最终答案表示为一个最简分数。该量是无量纲的，因此不需要单位。",
            "solution": "问题陈述被评估为有效。它在科学上基于统计机器学习和性能评估的原理，特别是在系统生物医学的背景下。问题提法恰当，为得出唯一解提供了所有必要的定义和数据。语言客观，场景对于DTI领域是现实的。\n\n问题要求一个分为三部分的解答：首先，从第一性原理出发，论证AUROC和AUPRC对类别不平衡的差异性敏感度；其次，推导一个无信息的随机分类器的期望AUPRC；第三，为一个特定的DTI场景计算该值。\n\n**第一部分：AUROC和AUPRC对类别不平衡的敏感性**\n\n我们从提供的概率定义开始。基线阳性率，或称类别流行率，是 $\\pi = \\mathbb{P}(Y=1)$。因此，阴性类别的流行率是 $\\mathbb{P}(Y=0) = 1-\\pi$。\n\n首先，考虑受试者工作特征曲线下面积（AUROC）。ROC曲线是真阳性率（TPR）对假阳性率（FPR）的图。这些率的定义是：\n-   真阳性率（也称为召回率）：$\\text{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)$\n-   假阳性率：$\\text{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=0)$\n\nTPR和FPR都是条件概率，其中条件事件是真实的类别标签（TPR为 $Y=1$，FPR为 $Y=0$）。TPR的计算只涉及阳性实例的分数，而FPR的计算只涉及阴性实例的分数。这两个定义都不直接涉及类别流行率 $\\pi$。ROC曲线的形状由阳性和阴性类别的分数分布 $\\mathbb{P}(S|Y=1)$ 和 $\\mathbb{P}(S|Y=0)$ 之间的分离程度决定。由于ROC图的两个轴都独立于 $\\pi$，曲线本身及其面积（AUROC）对类别不平衡不敏感。\n\n接下来，考虑精确率-召回率曲线下面积（AUPRC）。PR曲线是精确率对召回率的图。我们已经有了召回率的定义，即TPR。精确率的定义是：\n-   精确率：$\\text{Precision}(\\tau) = \\mathbb{P}(Y=1 \\mid S \\ge \\tau)$\n\n为了理解其对 $\\pi$ 的依赖关系，我们使用贝叶斯定理来展开精确率的定义：\n$$ \\text{Precision}(\\tau) = \\frac{\\mathbb{P}(S \\ge \\tau \\mid Y=1) \\mathbb{P}(Y=1)}{\\mathbb{P}(S \\ge \\tau)} $$\n分母 $\\mathbb{P}(S \\ge \\tau)$ 可以使用全概率定律展开：\n$$ \\mathbb{P}(S \\ge \\tau) = \\mathbb{P}(S \\ge \\tau \\mid Y=1)\\mathbb{P}(Y=1) + \\mathbb{P}(S \\ge \\tau \\mid Y=0)\\mathbb{P}(Y=0) $$\n代入TPR、FPR和 $\\pi$ 的定义：\n$$ \\mathbb{P}(S \\ge \\tau) = \\text{TPR}(\\tau) \\cdot \\pi + \\text{FPR}(\\tau) \\cdot (1-\\pi) $$\n现在，将此代回精确率的表达式，并注意到 $\\text{Recall}(\\tau) = \\text{TPR}(\\tau)$：\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\cdot \\pi + \\text{FPR}(\\tau) \\cdot (1-\\pi)} $$\n这个方程表明，精确率是类别流行率 $\\pi$ 的一个显式函数。在一个高度不平衡的设置中，阴性样本的数量远大于阳性样本的数量，$\\pi$ 非常小，而 $(1-\\pi)$ 接近于 $1$。分母被 $\\text{FPR}(\\tau) \\cdot (1-\\pi)$ 这一项主导。一个小的FPR，在平衡设置中可能是可以接受的，但当阴性类别巨大时，会导致精确率急剧下降。由于PR曲线的一个轴（精确率）直接依赖于 $\\pi$，整个曲线及其面积（AUPRC）都对类别不平衡敏感。\n\n**第二部分：随机、无信息评分函数的期望AUPRC**\n\n问题陈述评分函数是随机且无信息的，这被形式化为分数 $S$ 在统计上独立于真实标签 $Y$，记为 $S \\perp Y$。\n这种独立性意味着，无论真实类别标签如何，获得分数 $S \\ge \\tau$ 的条件概率是相同的：\n$$ \\mathbb{P}(S \\ge \\tau \\mid Y=1) = \\mathbb{P}(S \\ge \\tau \\mid Y=0) $$\n使用TPR和FPR的定义，这意味着：\n$$ \\text{TPR}(\\tau) = \\text{FPR}(\\tau) $$\n对于任何给定的阈值 $\\tau$，随机分类器从真阳性和真阴性群体中产生相同的阳性率。这是一个无信息模型的标志。这种分类器的ROC曲线是从 $(0,0)$ 到 $(1,1)$ 的对角线，产生的AUROC为 $0.5$。\n\n现在我们分析AUPRC。我们将条件 $\\text{FPR}(\\tau) = \\text{TPR}(\\tau)$（或 $\\text{FPR}(\\tau) = \\text{Recall}(\\tau)$）代入第一部分推导出的精确率方程中：\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\cdot \\pi + \\text{Recall}(\\tau) \\cdot (1-\\pi)} $$\n对于任何使得 $\\text{Recall}(\\tau) > 0$ 的阈值 $\\tau$，我们可以从分母中提取因子 $\\text{Recall}(\\tau)$：\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\left[ \\pi + (1-\\pi) \\right]} $$\n$$ \\text{Precision}(\\tau) = \\frac{\\text{Recall}(\\tau) \\cdot \\pi}{\\text{Recall}(\\tau) \\cdot 1} $$\n$$ \\text{Precision}(\\tau) = \\pi $$\n这个结果表明，对于一个无信息的分类器，对于任何大于0的召回率值，其精确率是恒定的，等于基线阳性率 $\\pi$。当阈值 $\\tau$ 从其最大值变化到最小值时，召回率的范围是从 $0$ 到 $1$。因此，PR曲线是在召回率区间 $[0, 1]$ 上高度为 $\\pi$ 的一条水平线。\n这条曲线下面积，即AUPRC，是一个高为 $\\pi$、宽为 $1$ 的矩形的面积。\n$$ \\text{AUPRC}_{\\text{random}} = \\text{height} \\times \\text{width} = \\pi \\times 1 = \\pi $$\n因此，随机分类器的期望AUPRC就是基线阳性率 $\\pi$。\n\n**第三部分：针对特定DTI设置的计算**\n\n问题为DTI筛选任务提供了以下值：\n-   药物数量，$N_D = 1200$\n-   靶点数量，$N_T = 18000$\n-   已知相互作用对（阳性）数量，$M = 150000$\n\n可能的药物-靶点对总数是 $N_{total} = N_D \\times N_T$。基线阳性率 $\\pi$ 是整个数据集中真阳性样本的比例：\n$$ \\pi = \\frac{M}{N_D N_T} $$\n我们将给定的数值代入此表达式：\n$$ \\pi = \\frac{150000}{1200 \\times 18000} $$\n为了化简这个分数，我们可以消去公因子。\n$$ \\pi = \\frac{150000}{21600000} $$\n我们可以从分子和分母中消去四个零（一个 $10^4$ 的因子）：\n$$ \\pi = \\frac{15}{2160} $$\n现在我们来约简这个分数。分子是 $15 = 3 \\times 5$。分母 $2160$ 可以被 $5$ 整除（因为它以 $0$ 结尾），也可以被 $3$ 整除（因为其各位数字之和 $2+1+6+0=9$ 可以被 $3$ 整除）。我们把分子分母都除以 $15$：\n$$ 2160 \\div 15 = (2160 \\div 3) \\div 5 = 720 \\div 5 = 144 $$\n所以，分数化简为：\n$$ \\pi = \\frac{1}{144} $$\n正如第二部分所推导的，随机评分模型的期望AUPRC等于这个基线阳性率 $\\pi$。因此，期望的AUPRC是 $\\frac{1}{144}$。这个分数已经是最简分数。",
            "answer": "$$\n\\boxed{\\frac{1}{144}}\n$$"
        }
    ]
}