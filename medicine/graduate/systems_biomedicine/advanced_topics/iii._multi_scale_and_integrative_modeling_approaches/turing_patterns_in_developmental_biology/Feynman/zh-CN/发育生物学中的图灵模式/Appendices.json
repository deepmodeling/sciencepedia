{
    "hands_on_practices": [
        {
            "introduction": "在分析任何反应-扩散系统时，第一步是确定其基准状态。本练习将指导你计算系统的空间均匀稳态，这个状态是任何空间图案形成之前的“空白画布”。通过计算该稳态下的雅可比矩阵，我们为后续的线性稳定性分析奠定基础，从而能够预测系统对微小扰动的响应。",
            "id": "4396888",
            "problem": "考虑一个用于发育模式形成的经典反应-扩散模型，该模型包含两种相互作用的化学物质，即激活剂 $u(x,t)$ 和抑制剂 $v(x,t)$，它们存在于一个长度为 $L$ 的一维组织上。其动力学由以下质量平衡形式决定\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u\\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; f(u,v), \n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v\\,\\frac{\\partial^2 v}{\\partial x^2} \\;+\\; g(u,v),\n$$\n其中 $D_u$ 和 $D_v$ 是正常数扩散系数，$f(u,v)$ 和 $g(u,v)$ 编码了局部反应动力学。假设采用 Schnakenberg 动力学，其定义为经过充分检验的激活剂-抑制剂反应速率\n$$\nf(u,v) \\;=\\; a \\;-\\; u \\;+\\; u^{2}\\,v,\n\\qquad\ng(u,v) \\;=\\; b \\;-\\; u^{2}\\,v,\n$$\n其中 $a>0$ 和 $b>0$ 是反映补给速率的常数。均匀稳态 $(u_0,v_0)$ 是指任何一对常数 $u(x,t)\\equiv u_0$, $v(x,t)\\equiv v_0$，它们在没有输运的情况下满足反应平衡，即 $f(u_0,v_0)=0$ 和 $g(u_0,v_0)=0$。$(u_0,v_0)$ 附近的线性化动力学由雅可比矩阵描述\n$$\nJ(u_0,v_0) \\;=\\; \n\\begin{pmatrix}\nf_u(u_0,v_0)  f_v(u_0,v_0) \\\\\ng_u(u_0,v_0)  g_v(u_0,v_0)\n\\end{pmatrix},\n$$\n其中 $f_u=\\frac{\\partial f}{\\partial u}$, $f_v=\\frac{\\partial f}{\\partial v}$, $g_u=\\frac{\\partial g}{\\partial u}$ 以及 $g_v=\\frac{\\partial g}{\\partial v}$。\n\n从上述定义和质量平衡原理出发，请确定均匀稳态 $(u_0,v_0)$（用 $a$ 和 $b$ 表示），并计算在该稳态下雅可比矩阵的各项 $f_u(u_0,v_0)$, $f_v(u_0,v_0)$, $g_u(u_0,v_0)$ 和 $g_v(u_0,v_0)$。将您的最终答案表示为一个单行矩阵，其中包含按以下顺序排列的六个量\n$$\n(u_0,\\; v_0,\\; f_u(u_0,v_0),\\; f_v(u_0,v_0),\\; g_u(u_0,v_0),\\; g_v(u_0,v_0)).\n$$\n请提供精确的解析表达式；不需要数值近似或四舍五入，且最终表达式中不应包含单位。",
            "solution": "首先对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 反应-扩散系统：\n  $$ \\frac{\\partial u}{\\partial t} = D_u\\,\\frac{\\partial^2 u}{\\partial x^2} + f(u,v) $$\n  $$ \\frac{\\partial v}{\\partial t} = D_v\\,\\frac{\\partial^2 v}{\\partial x^2} + g(u,v) $$\n- 物种：激活剂 $u(x,t)$，抑制剂 $v(x,t)$。\n- 域：一维，长度 $L$。\n- 扩散系数：$D_u > 0$ 和 $D_v > 0$。\n- 反应动力学 (Schnakenberg)：\n  $$ f(u,v) = a - u + u^{2}v $$\n  $$ g(u,v) = b - u^{2}v $$\n- 常数：$a > 0$ 和 $b > 0$。\n- 均匀稳态 $(u_0, v_0)$：一个常数解，满足 $f(u_0, v_0) = 0$ 和 $g(u_0, v_0) = 0$。\n- 雅可比矩阵：\n  $$\n  J(u_0,v_0) =\n  \\begin{pmatrix}\n  f_u(u_0,v_0)  f_v(u_0,v_0) \\\\\n  g_u(u_0,v_0)  g_v(u_0,v_0)\n  \\end{pmatrix}\n  $$\n  其中 $f_u = \\frac{\\partial f}{\\partial u}$，$f_v = \\frac{\\partial f}{\\partial v}$，$g_u = \\frac{\\partial g}{\\partial u}$ 以及 $g_v = \\frac{\\partial g}{\\partial v}$。\n- 任务：确定六个量 $(u_0, v_0, f_u(u_0,v_0), f_v(u_0,v_0), g_u(u_0,v_0), g_v(u_0,v_0))$ 并将它们表示为一个单行矩阵。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学依据：** 该问题描述了 Schnakenberg 模型，这是一个经典且完善的反应-扩散系统，用于研究模式形成（图灵斑图）。整个公式在数学生物学和系统生物医学中都是标准的。\n- **适定性：** 该问题是适定的。它要求通过求解一个由两个非线性方程组成的方程组来找到稳态，然后计算偏导数并在该状态下求值。定义和目标都非常精确，可以导出一个唯一的解析解。\n- **客观性：** 问题陈述是形式化和定量化的，使用了精确的数学定义，没有任何主观性或模糊性。\n\n该问题没有任何列出的缺陷。它在科学上是合理的，形式上是完整的，内部是一致的，并且需要对此类系统研究至关重要的标准解析推导。\n\n**步骤 3：结论与行动**\n问题是**有效的**。现在开始推导解答。\n\n第一步是通过求解反应动力学处于平衡状态所定义的代数方程组，即 $f(u_0, v_0) = 0$ 和 $g(u_0, v_0) = 0$，来确定均匀稳态 $(u_0, v_0)$。\n方程组为：\n$$ a - u_0 + u_0^{2}v_0 = 0 \\quad (1) $$\n$$ b - u_0^{2}v_0 = 0 \\quad (2) $$\n从方程 $(2)$ 中，我们可以直接表示出 $u_0^{2}v_0$ 这一项：\n$$ u_0^{2}v_0 = b $$\n因为题目说明 $b > 0$ 且浓度 $u_0, v_0$ 必须为非负数，所以可以得出 $u_0 \\neq 0$。\n现在，将此结果代入方程 $(1)$：\n$$ a - u_0 + b = 0 $$\n求解 $u_0$ 可得激活剂的稳态浓度：\n$$ u_0 = a + b $$\n为了求出 $v_0$，我们将 $u_0$ 的表达式代回到方程 $(2)$ 的关系式 $u_0^{2}v_0 = b$ 中：\n$$ (a+b)^{2}v_0 = b $$\n求解 $v_0$ 可得抑制剂的稳态浓度：\n$$ v_0 = \\frac{b}{(a+b)^{2}} $$\n因此，唯一的均匀稳态是 $(u_0, v_0) = (a+b, \\frac{b}{(a+b)^{2}})$。\n\n下一步是计算雅可比矩阵的各项，这需要计算 $f(u,v)$ 和 $g(u,v)$ 的偏导数。\n反应动力学为：\n$$ f(u,v) = a - u + u^{2}v $$\n$$ g(u,v) = b - u^{2}v $$\n关于 $u$ 和 $v$ 的偏导数是：\n$$ f_u = \\frac{\\partial f}{\\partial u} = -1 + 2uv $$\n$$ f_v = \\frac{\\partial f}{\\partial v} = u^{2} $$\n$$ g_u = \\frac{\\partial g}{\\partial u} = -2uv $$\n$$ g_v = \\frac{\\partial g}{\\partial v} = -u^{2} $$\n现在，我们在稳态 $(u_0, v_0)$ 处计算这些偏导数的值。让我们首先计算乘积 $u_0v_0$，它同时出现在 $f_u$ 和 $g_u$ 中：\n$$ u_0v_0 = (a+b) \\left( \\frac{b}{(a+b)^{2}} \\right) = \\frac{b}{a+b} $$\n使用这个中间结果，我们可以计算出雅可比矩阵的每一项：\n$$ f_u(u_0,v_0) = -1 + 2u_0v_0 = -1 + 2\\left(\\frac{b}{a+b}\\right) = \\frac{-(a+b) + 2b}{a+b} = \\frac{b-a}{a+b} $$\n$$ f_v(u_0,v_0) = u_0^{2} = (a+b)^{2} $$\n$$ g_u(u_0,v_0) = -2u_0v_0 = -2\\left(\\frac{b}{a+b}\\right) = -\\frac{2b}{a+b} $$\n$$ g_v(u_0,v_0) = -u_0^{2} = -(a+b)^{2} $$\n所需的六个量是：\n1.  $u_0 = a+b$\n2.  $v_0 = \\frac{b}{(a+b)^{2}}$\n3.  $f_u(u_0,v_0) = \\frac{b-a}{a+b}$\n4.  $f_v(u_0,v_0) = (a+b)^{2}$\n5.  $g_u(u_0,v_0) = -\\frac{2b}{a+b}$\n6.  $g_v(u_0,v_0) = -(a+b)^{2}$\n\n按照要求，将这些量排列成一个行矩阵作为最终答案。",
            "answer": "$$ \\boxed{\\begin{pmatrix} a+b  \\frac{b}{(a+b)^{2}}  \\frac{b-a}{a+b}  (a+b)^{2}  -\\frac{2b}{a+b}  -(a+b)^{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在掌握了如何建立模型的基础之上，我们现在转向预测模型的动态行为。本练习将图灵的扩散驱动不稳定性理论应用于一个具体的参数化模型。你将利用前面练习中计算稳态和雅可比矩阵的技能，来检验扩散系数的差异是否能促使一个原本稳定的均匀态发生破缺，从而形成空间图案。",
            "id": "4396936",
            "problem": "考虑一个均匀二维组织上的无量纲双物种反应-扩散系统，称为 Schnakenberg 模型：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u \\nabla^2 u \\;+\\; a \\;-\\; u \\;+\\; u^2 v, \n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v \\nabla^2 v \\;+\\; b \\;-\\; u^2 v,\n$$\n其中 $u$ 和 $v$ 是两种相互作用的形态发生素的浓度，$D_u$ 和 $D_v$ 是它们的扩散系数，$a$ 和 $b$ 是正的供给参数。取 $a=0.2$，$b=1.2$，$D_u=1$，$D_v=16$。\n\n从构成图灵斑图形成基础的扩散驱动不稳定性的定义出发，使用对空间均匀扰动和空间傅里叶模式的第一性原理线性稳定性分析来：\n\n- 通过求解稳态条件下的反应项，推导出均匀稳态 $(u^\\ast,v^\\ast)$。\n- 将局部反应项 $f(u,v)=a-u+u^2 v$ 和 $g(u,v)=b-u^2 v$ 在 $(u^\\ast,v^\\ast)$ 附近进行线性化，并写出在 $(u^\\ast,v^\\ast)$ 处求值的雅可比矩阵元素 $f_u$、$f_v$、$g_u$ 和 $g_v$。\n- 对于波数大小为 $k$ 的空间傅里叶模式，将依赖于 $k$ 的线性化算子表示为 $J - k^2 \\text{diag}(D_u,D_v)$，并由此获得线性化系统的依赖于 $k$ 的迹 $\\tau(k)$ 和行列式 $\\Delta(k)$。\n- 使用 $2\\times 2$ 线性系统的基本稳定性判据，陈述在没有扩散（$k=0$）时均匀稳态是线性稳定的条件，以及对于某个 $k>0$ 发生扩散驱动不稳定性（图灵不稳定性）所需的附加条件。\n\n计算量\n$$\n\\Delta_{\\mathrm{T}} \\;=\\; \\left(f_u D_v + g_v D_u\\right)^2 \\;-\\; 4\\,D_u D_v\\,\\left(f_u g_v - f_v g_u\\right),\n$$\n使用给定的参数对其进行数值计算，并利用其符号以及 $k=0$ 的判据来判断均匀稳态是否在 $k=0$ 时稳定，但在某个 $k>0$ 时不稳定。报告 $\\Delta_{\\mathrm{T}}$ 的值，四舍五入到四位有效数字。由于模型是无量纲的，因此不需要单位。",
            "solution": "Schnakenberg 反应-扩散模型由下式给出\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D_u \\nabla^2 u \\;+\\; f(u,v), \n\\qquad\n\\frac{\\partial v}{\\partial t} \\;=\\; D_v \\nabla^2 v \\;+\\; g(u,v),\n$$\n其中 $f(u,v)=a-u+u^2 v$ 和 $g(u,v)=b-u^2 v$。空间均匀稳态 $(u^\\ast,v^\\ast)$ 满足 $f(u^\\ast,v^\\ast)=0$ 和 $g(u^\\ast,v^\\ast)=0$。\n\n求解 $g(u^\\ast,v^\\ast)=0$ 得到 $b = (u^\\ast)^2 v^\\ast$。代入 $f(u^\\ast,v^\\ast)=0$ 得到 $a - u^\\ast + (u^\\ast)^2 v^\\ast = a - u^\\ast + b = 0$，因此\n$$\nu^\\ast \\;=\\; a+b, \n\\qquad\nv^\\ast \\;=\\; \\frac{b}{(u^\\ast)^2} \\;=\\; \\frac{b}{(a+b)^2}.\n$$\n对于 $a=0.2$ 和 $b=1.2$，\n$$\nu^\\ast \\;=\\; 0.2+1.2 \\;=\\; 1.4 \\;=\\; \\frac{7}{5}, \n\\qquad\nv^\\ast \\;=\\; \\frac{1.2}{(1.4)^2} \\;=\\; \\frac{1.2}{1.96} \\;=\\; \\frac{30}{49}.\n$$\n方便起见，记下 $u^\\ast v^\\ast = \\dfrac{b}{a+b} = \\dfrac{1.2}{1.4} = \\dfrac{6}{7}$。\n\n在 $(u^\\ast,v^\\ast)$ 处求值的反应动力学的雅可比矩阵，其元素为\n$$\nf_u \\;=\\; \\frac{\\partial f}{\\partial u}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; -1 + 2 u^\\ast v^\\ast, \n\\qquad\nf_v \\;=\\; \\frac{\\partial f}{\\partial v}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; (u^\\ast)^2,\n$$\n$$\ng_u \\;=\\; \\frac{\\partial g}{\\partial u}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; -2 u^\\ast v^\\ast, \n\\qquad\ng_v \\;=\\; \\frac{\\partial g}{\\partial v}\\bigg|_{(u^\\ast,v^\\ast)} \\;=\\; -(u^\\ast)^2.\n$$\n使用 $u^\\ast v^\\ast = \\dfrac{6}{7}$ 和 $(u^\\ast)^2 = \\left(\\dfrac{7}{5}\\right)^2 = \\dfrac{49}{25}$，我们得到\n$$\nf_u \\;=\\; -1 + 2\\cdot\\frac{6}{7} \\;=\\; \\frac{5}{7}, \n\\quad\nf_v \\;=\\; \\frac{49}{25}, \n\\quad\ng_u \\;=\\; -2\\cdot\\frac{6}{7} \\;=\\; -\\frac{12}{7}, \n\\quad\ng_v \\;=\\; -\\frac{49}{25}.\n$$\n\n为分析空间傅里叶模式的稳定性，考虑与 $\\exp(\\lambda t + i \\mathbf{k}\\cdot \\mathbf{x})$ 成正比的扰动，其波数大小为 $k=|\\mathbf{k}|$。扩散项在对角线上贡献了 $-D_u k^2$ 和 $-D_v k^2$。依赖于 $k$ 的线性化算子是\n$$\nA(k) \\;=\\; \n\\begin{pmatrix}\nf_u  f_v \\\\\ng_u  g_v\n\\end{pmatrix}\n\\;-\\;\n\\begin{pmatrix}\nD_u  0 \\\\\n0  D_v\n\\end{pmatrix}\nk^2.\n$$\n特征多项式为\n$$\n\\lambda^2 \\;-\\; \\tau(k)\\,\\lambda \\;+\\; \\Delta(k) \\;=\\; 0,\n$$\n其中\n$$\n\\tau(k) \\;=\\; f_u + g_v \\;-\\; (D_u + D_v)\\,k^2,\n\\qquad\n\\Delta(k) \\;=\\; f_u g_v - f_v g_u \\;-\\; \\big(f_u D_v + g_v D_u\\big)\\,k^2 \\;+\\; D_u D_v\\,k^4.\n$$\n对于一个 $2\\times 2$ 实系统，线性稳定性要求 $\\tau(k)  0$ 和 $\\Delta(k) > 0$。当均匀稳态在 $k=0$ 时是稳定的，但在某个 $k>0$ 时不稳定，就会发生扩散驱动（图灵）不稳定性。由于当 $D_u+D_v>0$ 时 $\\tau(k)$ 是关于 $k^2$ 的严格递减函数，如果 $\\tau(0)  0$，那么对于所有 $k>0$ 都有 $\\tau(k)  0$，稳定性的丧失只能通过 $\\Delta(k)$ 在某个 $k>0$ 时变为负值而发生。将 $\\Delta(k)$ 写为\n$$\n\\Delta(k) \\;=\\; \\Delta_0 \\;-\\; m\\,k^2 \\;+\\; p\\,k^4,\n$$\n其中\n$$\n\\Delta_0 \\;=\\; f_u g_v - f_v g_u, \n\\qquad\nm \\;=\\; f_u D_v + g_v D_u, \n\\qquad\np \\;=\\; D_u D_v,\n$$\n可以看出 $\\Delta(k)$ 是一个关于 $k^2$ 的开口向上的二次函数。为了存在一个 $k^2>0$ 的区间使得 $\\Delta(k)  0$，必须满足 $\\Delta_0>0$，$m>0$，且判别式\n$$\n\\Delta_{\\mathrm{T}} \\;=\\; m^2 \\;-\\; 4 p \\Delta_0\n$$\n严格为正；不稳定带则位于两个正根 $k^2_{\\pm} = \\dfrac{m \\pm \\sqrt{\\Delta_{\\mathrm{T}}}}{2p}$ 之间。此外，在 $k=0$ 处的稳定性要求\n$$\n\\tau(0) \\;=\\; f_u + g_v \\;\\; 0, \n\\qquad \n\\Delta_0 \\;\\; 0.\n$$\n\n我们现在用给定的参数 $D_u=1$ 和 $D_v=16$ 来计算这些量。首先，是 $k=0$ 时的判据：\n$$\n\\tau(0) \\;=\\; f_u + g_v \\;=\\; \\frac{5}{7} - \\frac{49}{25} \\;=\\; \\frac{125 - 343}{175} \\;=\\; -\\frac{218}{175} \\;\\; 0,\n$$\n$$\n\\Delta_0 \\;=\\; f_u g_v - f_v g_u \\;=\\; \\frac{5}{7}\\left(-\\frac{49}{25}\\right) - \\frac{49}{25}\\left(-\\frac{12}{7}\\right) \\;=\\; -\\frac{245}{175} + \\frac{588}{175} \\;=\\; \\frac{343}{175} \\;=\\; \\frac{49}{25} \\;\\; 0.\n$$\n因此，在没有扩散（$k=0$）的情况下，均匀稳态是线性稳定的。接下来，计算控制 $k$ 依赖性的系数：\n$$\nm \\;=\\; f_u D_v + g_v D_u \\;=\\; \\frac{5}{7}\\cdot 16 \\;+\\; \\left(-\\frac{49}{25}\\right)\\cdot 1 \\;=\\; \\frac{80}{7} - \\frac{49}{25} \\;=\\; \\frac{2000 - 343}{175} \\;=\\; \\frac{1657}{175} \\;\\; 0,\n$$\n$$\np \\;=\\; D_u D_v \\;=\\; 1\\cdot 16 \\;=\\; 16.\n$$\n因此，图灵判别式为\n$$\n\\Delta_{\\mathrm{T}} \\;=\\; m^2 - 4 p \\Delta_0 \n\\;=\\; \\left(\\frac{1657}{175}\\right)^2 \\;-\\; 4\\cdot 16 \\cdot \\frac{49}{25}\n\\;=\\; \\frac{2{,}745{,}649}{30{,}625} \\;-\\; \\frac{3136 \\times 1225}{25 \\times 1225}\n\\;=\\; \\frac{2{,}745{,}649 - 3{,}841{,}600}{30{,}625}\n\\;=\\; -\\frac{1{,}095{,}951}{30{,}625}.\n$$\n数值上，\n$$\n\\Delta_{\\mathrm{T}} \\;\\approx\\; -35.786155102\\ldots\n$$\n四舍五入到四位有效数字，\n$$\n\\Delta_{\\mathrm{T}} \\;\\approx\\; -35.79.\n$$\n\n因为 $\\tau(0)  0$ 且 $\\Delta_0 > 0$，所以稳态在 $k=0$ 时是线性稳定的。由于 $\\Delta_{\\mathrm{T}}  0$，二次函数 $\\Delta(k)$ 没有关于 $k^2$ 的实根，因此对于所有 $k\\ge 0$ 都有 $\\Delta(k) > 0$；对于所有空间波数，该稳态都保持稳定，并且对于给定的参数，不会发生扩散驱动（图灵）不稳定性。",
            "answer": "$$\\boxed{-35.79}$$"
        },
        {
            "introduction": "理论分析可以告诉我们图案是否能够形成，但只有通过数值模拟，我们才能亲眼观察到它们如何涌现和演化。本练习将引导你从理论预测走向计算实践，通过编程实现并比较两种不同的数值方法。此过程不仅能让你将抽象的理论付诸实践，还能让你深入理解在模拟扩散主导的系统中常见的计算刚度问题及其解决方案。",
            "id": "4396910",
            "problem": "考虑一个一维、周期性的反应扩散系统，该系统针对两种相互作用的形态发生素，能够在发育生物学中产生 Turing 斑图。设在长度为 $L$ 的区域上，浓度为 $u(x,t)$ 和 $v(x,t)$，边界条件为周期性，其动力学由以下方程组控制：\n$$\n\\frac{\\partial u}{\\partial t} = f(u,v) + D_u \\frac{\\partial^2 u}{\\partial x^2}, \\quad \\frac{\\partial v}{\\partial t} = g(u,v) + D_v \\frac{\\partial^2 v}{\\partial x^2},\n$$\n其中 $D_u$ 和 $D_v$ 是扩散系数，$(f,g)$ 是反应项。使用 Schnakenberg 动力学，这是一种广泛用于 Turing 斑图分析的激活子-抑制子模型：\n$$\nf(u,v) = a - u + u^2 v, \\quad g(u,v) = b - u^2 v,\n$$\n参数 $a>0$, $b>0$。空间均匀稳态 $(u^\\ast,v^\\ast)$ 满足：\n$$\nu^\\ast = a + b, \\quad v^\\ast = \\frac{b}{(a+b)^2}.\n$$\n在 $(u^\\ast,v^\\ast)$ 附近对系统进行线性化，得到：\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\tilde u \\\\ \\tilde v\n\\end{pmatrix}\n=\nJ\n\\begin{pmatrix}\n\\tilde u \\\\ \\tilde v\n\\end{pmatrix}\n+\nD \\frac{\\partial^2}{\\partial x^2}\n\\begin{pmatrix}\n\\tilde u \\\\ \\tilde v\n\\end{pmatrix},\n$$\n其中 $\\tilde u=u-u^\\ast$，$\\tilde v=v-v^\\ast$，$J$ 是在 $(u^\\ast,v^\\ast)$ 处求值的 $(f,g)$ 的 Jacobian 矩阵，且 $D = \\text{diag}(D_u,D_v)$。在具有 $N$ 个等距点的网格上应用离散 Fourier 变换 (DFT)，可为每个波数 $k$ 得到独立的线性常微分方程，其中 Laplacian 算子的作用等同于乘以 $-k^2$。用 $\\mathbf{U}_k(t)$ 表示波数 $k$ 的 Fourier 模向量。那么\n$$\n\\frac{d}{dt}\\mathbf{U}_k(t) = \\left(J - k^2 D\\right)\\mathbf{U}_k(t).\n$$\n\n要求您实现一种半隐式谱方法时间步进法，该方法对扩散项进行隐式处理，对反应项进行显式处理。对于大小为 $\\Delta t$ 的单个时间步，该方法通过求解以下方程来更新每个模式：\n$$\n\\left(I + \\Delta t\\, k^2 D\\right)\\,\\mathbf{U}_k^{n+1} = \\mathbf{U}_k^n + \\Delta t\\, J\\,\\mathbf{U}_k^n,\n$$\n因此\n$$\n\\mathbf{U}_k^{n+1} = \\underbrace{\\left(I + \\Delta t\\, k^2 D\\right)^{-1}\\left(I + \\Delta t\\, J\\right)}_{G_k(\\Delta t)} \\mathbf{U}_k^n.\n$$\n投影到反应 Jacobian 矩阵 $J$ 的一个特征值为 $r$ 的特征向量上，并通过该特征向量上的 Rayleigh 商定义有效扩散系数 $D_{\\mathrm{eff}}$，则标量模振幅 $A_k^n$ 遵循以下更新规则：\n$$\nA_k^{n+1}=\\frac{A_k^n+\\Delta t\\,R_k^n}{1+\\Delta t\\,D_\\mathrm{eff} k^2},\n$$\n其中对于线性化反应，$R_k^n = r\\,A_k^n$。相比之下，一个完全显式的前向 Euler 格式通过以下方式更新每个模式：\n$$\n\\mathbf{U}_k^{n+1} = \\left(I + \\Delta t\\,(J - k^2 D)\\right)\\mathbf{U}_k^n.\n$$\n\n从反应扩散方程、稳态附近的线性化以及 Laplacian 算子映射为 $-k^2$ 的 DFT 性质出发，推导出上述的半隐式逐模式更新规则。然后，实现一个程序，对于每个给定的参数集，计算并比较显式 Euler 方法和半隐式谱方法在时间步进方面的线性稳定性。使用以下稳定性判据：\n\n- 显式 Euler 方法：对于每个离散波数 $k$ 和 $J - k^2 D$ 的每个特征值 $\\lambda_k$，放大因子为 $1 + \\Delta t\\,\\lambda_k$。如果对于该 $k$ 值，$\\left|1 + \\Delta t\\,\\lambda_k\\right| \\leq 1$ 成立，则该格式在该 $k$ 处是线性稳定的。对于一个给定的 $\\lambda_k$ 且 $\\mathrm{Re}(\\lambda_k)  0$，满足此不等式的最大允许时间步长为\n$$\n\\Delta t_{\\max}(\\lambda_k) = -\\frac{2\\,\\mathrm{Re}(\\lambda_k)}{|\\lambda_k|^2}.\n$$\n如果在任何 $k$ 处的任何特征值的 $\\mathrm{Re}(\\lambda_k) \\ge 0$，那么最大稳定时间步长为 $0$。\n\n- 半隐式谱格式：对于每个离散波数 $k$，计算上面给出的放大矩阵 $G_k(\\Delta t)$。如果对于所有离散的 $k$，$G_k(\\Delta t)$ 的谱半径小于或等于 $1$，则该格式是线性稳定的。最大稳定时间步长 $\\Delta t_{\\max}$ 是使得 $\\max_k \\rho\\left(G_k(\\Delta t)\\right)\\le 1$ 的最大 $\\Delta t$。通过在正区间上对 $\\Delta t$ 进行二分法来数值确定 $\\Delta t_{\\max}$。\n\n此外，通过评估 $J - k^2 D$ 在所有离散 $k$ 上的特征值的最大实部来检测是否存在 Turing 不稳定带。如果 $\\max_k \\max_{\\lambda\\in \\mathrm{eig}(J - k^2 D)} \\mathrm{Re}(\\lambda) > 0$，则存在扩散驱动的不稳定性。\n\n实现您的程序以计算：\n1. 显式 Euler 格式在所有离散 $k$ 上的最大稳定时间步长 $\\Delta t_{\\max}^{\\mathrm{explicit}}$。\n2. 半隐式谱格式在所有离散 $k$ 上的最大稳定时间步长 $\\Delta t_{\\max}^{\\mathrm{semi}}$。\n3. 一个布尔指示符，用于指示是否存在如上定义的 Turing 不稳定带。\n\n您的程序必须使用以下测试套件，每个套件由 $(a,b,D_u,D_v,L,N)$ 指定：\n- 测试用例 1（稳定，中等刚性扩散）：$(a,b)=(0.2,1.3)$, $(D_u,D_v)=(1.0,10.0)$, $L=50$, $N=128$。\n- 测试用例 2（潜在的 Turing 不稳定带）：$(a,b)=(0.2,1.3)$, $(D_u,D_v)=(1.0,40.0)$, $L=50$, $N=128$。\n- 测试用例 3（接近边界且抑制作用更强）：$(a,b)=(0.25,0.9)$, $(D_u,D_v)=(1.0,50.0)$, $L=50$, $N=128$。\n\n所有量均为无量纲。对于在 $0 \\le n \\le \\frac{N}{2}$ 范围内的整数 $n$，使用离散波数 $k_n = \\frac{2\\pi}{L}\\,n$。\n\n最终输出格式：您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，本身是一个包含三个条目的列表 $[\\Delta t_{\\max}^{\\mathrm{explicit}},\\Delta t_{\\max}^{\\mathrm{semi}},\\text{unstable\\_band}]$。将时间步长值表示为保留六位小数的浮点数，将不稳定性指示符表示为布尔值。例如：\n$$\n[\\,[0.012345,0.067890,\\mathrm{False}],\\,[\\ldots],\\,[\\ldots]\\,].\n$$",
            "solution": "该问题陈述是一项定义明确、具有科学依据的计算系统生物学和数值分析练习。它要求对应用于线性化反应扩散系统的两种数值格式进行稳定性分析的推导和实现。所有参数、方程和评估标准都得到了明确且一致的定义。因此，该问题是有效的，我将继续提供完整解答。\n\n问题的核心是分析应用于线性化反应扩散系统 Fourier 模式的时间步进格式的线性稳定性。对于给定的波数 $k$，系统在 Fourier 空间中的演化由以下线性常微分方程描述：\n$$\n\\frac{d}{dt}\\mathbf{U}_k(t) = M_k \\mathbf{U}_k(t)\n$$\n其中 $\\mathbf{U}_k$ 是浓度 $u$ 和 $v$ 的 Fourier 振幅向量，$M_k$ 是该模式的系统矩阵：\n$$\nM_k = J - k^2 D\n$$\n这里，$J$ 是反应动力学的 Jacobian 矩阵，$D = \\mathrm{diag}(D_u, D_v)$ 是扩散系数的对角矩阵。\n\n首先，我们必须为 Schnakenberg 动力学 $f(u,v) = a - u + u^2 v$ 和 $g(u,v) = b - u^2 v$ 推导出 Jacobian 矩阵 $J$。偏导数如下：\n$$\n\\frac{\\partial f}{\\partial u} = -1 + 2uv, \\quad \\frac{\\partial f}{\\partial v} = u^2\n$$\n$$\n\\frac{\\partial g}{\\partial u} = -2uv, \\quad \\frac{\\partial g}{\\partial v} = -u^2\n$$\n因此，Jacobian 矩阵为：\n$$\nJ(u,v) = \\begin{pmatrix} -1 + 2uv  u^2 \\\\ -2uv  -u^2 \\end{pmatrix}\n$$\n我们在指定的均匀稳态 $(u^\\ast, v^\\ast)$ 处对 $J$ 求值，其中 $u^\\ast = a+b$ 且 $v^\\ast = b/(a+b)^2$。乘积 $u^\\ast v^\\ast$ 可简化为：\n$$\nu^\\ast v^\\ast = (a+b) \\left( \\frac{b}{(a+b)^2} \\right) = \\frac{b}{a+b}\n$$\n将此代入 Jacobian 矩阵得到：\n$$\nJ = J(u^\\ast, v^\\ast) = \\begin{pmatrix} -1 + 2\\frac{b}{a+b}  (a+b)^2 \\\\ -2\\frac{b}{a+b}  -(a+b)^2 \\end{pmatrix} = \\begin{pmatrix} \\frac{b-a}{a+b}  (a+b)^2 \\\\ -\\frac{2b}{a+b}  -(a+b)^2 \\end{pmatrix}\n$$\n这个仅依赖于反应参数 $a$ 和 $b$ 的矩阵将为每个测试用例计算。\n\n该分析考虑了一组离散波数 $k_n$，对应于将长度为 $L$ 的区域离散化为 $N$ 个点。对于从 $0$ 到 $N/2$ 的整数 $n$，波数由 $k_n = \\frac{2\\pi}{L}n$ 给出。\n\n**1. Turing 不稳定性分析**\n\n如果一个对非空间扰动稳定的空间均匀稳态由于扩散而变得不稳定，就会发生 Turing（扩散驱动的）不稳定性。当任何具有 $k > 0$ 的模式呈指数增长时，就会发生这种情况。模式的增长率由矩阵 $M_k = J - k^2 D$ 的特征值的实部给出。因此，不稳定性条件为 $\\max_{k, \\lambda \\in \\mathrm{eig}(M_k)} \\mathrm{Re}(\\lambda) > 0$。分析还必须检查 $k=0$ 的情况（无扩散）。对于 Turing 斑图，我们要求在 $k=0$ 时稳定，即 $J$ 的所有特征值 $\\lambda$ 的 $\\mathrm{Re}(\\lambda)  0$，并且对于某些 $k>0$ 不稳定。问题将此简化为寻找是否存在任何模式具有正的特征值实部。我们将为所有离散的 $k_n$ 计算 $M_k$ 的特征值，并找出它们中的最大实部。如果该最大值为正，则存在 Turing 不稳定带。\n\n**2. 显式 Euler 格式稳定性**\n\n前向 Euler 方法将系统更新为 $\\mathbf{U}_k^{n+1} = \\mathbf{U}_k^n + \\Delta t \\, M_k \\, \\mathbf{U}_k^n$。放大矩阵为 $I + \\Delta t M_k$。为了保证稳定性，该矩阵的谱半径必须小于或等于 $1$。如果 $\\lambda_k$ 是 $M_k$ 的一个特征值，那么 $1 + \\Delta t \\lambda_k$ 就是放大矩阵的一个特征值。稳定性条件是对于 $M_k$ 的所有特征值和所有波数 $k$，都有 $|1 + \\Delta t \\lambda_k| \\le 1$。\n\n对于一个特征值 $\\lambda_k = x + iy$，条件变为 $|(1+\\Delta t x) + i(\\Delta t y)|^2 \\le 1$，展开为 $(1+\\Delta t x)^2 + (\\Delta t y)^2 \\le 1$。这简化为 $\\Delta t^2(x^2+y^2) + 2\\Delta t x \\le 0$，或 $\\Delta t^2 |\\lambda_k|^2 + 2\\Delta t \\mathrm{Re}(\\lambda_k) \\le 0$。\n假设 $\\Delta t > 0$，我们可以除以它：$\\Delta t |\\lambda_k|^2 \\le -2\\mathrm{Re}(\\lambda_k)$。\n为了使这个方程对于 $\\Delta t$ 有正解，我们必须有 $\\mathrm{Re}(\\lambda_k)  0$。在这种情况下，此特定模式的最大允许时间步长为：\n$$\n\\Delta t_{\\max}(\\lambda_k) = -\\frac{2\\mathrm{Re}(\\lambda_k)}{|\\lambda_k|^2}\n$$\n如果对于任何模式，$\\mathrm{Re}(\\lambda_k) \\ge 0$，则系统是物理上不稳定或临界稳定的，任何正的时间步长 $\\Delta t > 0$ 都将导致数值不稳定性。因此，最大稳定时间步长为 $\\Delta t = 0$。该格式的总体最大稳定时间步长是这些单个最大值在所有 $k_n$ 和所有相应特征值上的最小值。\n\n**3. 半隐式谱格式稳定性**\n\n问题提供了半隐式格式的更新规则：\n$$\n\\mathbf{U}_k^{n+1} = \\left(I + \\Delta t\\, k^2 D\\right)^{-1}\\left(I + \\Delta t\\, J\\right) \\mathbf{U}_k^n = G_k(\\Delta t) \\mathbf{U}_k^n\n$$\n其中 $G_k(\\Delta t)$ 是放大矩阵。如果其谱半径 $\\rho(G_k(\\Delta t))$ 对所有波数 $k_n$ 都小于或等于 $1$，则该格式是稳定的。目标是找到满足此条件的最大 $\\Delta t$，该条件对所有 $k_n$ 同时成立：\n$$\n\\Delta t_{\\max}^{\\mathrm{semi}} = \\sup\\left\\{\\Delta t > 0 \\mid \\max_{k_n} \\rho\\left(G_k(\\Delta t)\\right) \\le 1\\right\\}\n$$\n函数 $F(\\Delta t) = \\max_{k_n} \\rho\\left(G_k(\\Delta t)\\right)$ 随 $\\Delta t$ 单调递增。我们正在寻找 $F(\\Delta t) - 1 = 0$ 的根。这是像二分法这样的数值求根方法的完美应用。我们定义一个函数 `check_stability(dt)`，它计算 $\\max_{k_n} \\rho(G_k(\\Delta t))$，如果它 $\\le 1$ 则返回 `True`。然后我们通过从一个区间 $[0, \\Delta t_{\\mathrm{high}}]$ 开始并反复缩小它来搜索满足此条件的最大 `dt`。\n\n矩阵求逆 $(I + \\Delta t k^2 D)^{-1}$ 在计算上是廉价的，因为 $D$ 是对角矩阵，所以 $(I + \\Delta t k^2 D)$ 也是对角矩阵：\n$$\n(I + \\Delta t k^2 D)^{-1} = \\begin{pmatrix} (1 + \\Delta t k^2 D_u)^{-1}  0 \\\\ 0  (1 + \\Delta t k^2 D_v)^{-1} \\end{pmatrix}\n$$\n\n对于每个测试用例，总体算法按以下步骤进行：\n1.  根据参数 $a$ 和 $b$ 计算常数 Jacobian 矩阵 $J$。\n2.  生成离散波数集合 $\\{k_n\\}$。\n3.  遍历每个 $k_n$ 以找到 $M_k = J - k_n^2 D$ 的特征值。使用这些来确定 $\\Delta t_{\\max}^{\\mathrm{explicit}}$ 和 Turing 不稳定性标志。\n4.  对半隐式格式实现一个关于 $\\Delta t$ 的二分法搜索。该搜索将依赖于一个辅助函数，该函数通过计算 $\\max_{k_n} \\rho(G_k(\\Delta t))$ 来检查稳定性。\n5.  格式化并记录三个结果值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Turing pattern stability problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, b, Du, Dv, L, N)\n    test_cases = [\n        (0.2, 1.3, 1.0, 10.0, 50, 128),\n        (0.2, 1.3, 1.0, 40.0, 50, 128),\n        (0.25, 0.9, 1.0, 50.0, 50, 128),\n    ]\n\n    results = []\n    # Bisection search parameters for the semi-implicit scheme\n    bisection_low = 0.0\n    bisection_high = 20.0  # A sufficiently large upper bound for dt\n    bisection_iter = 100\n\n    for case in test_cases:\n        a, b, Du, Dv, L, N = case\n\n        # 1. Calculate the Jacobian matrix J at the steady state\n        u_star = a + b\n        v_star = b / (a + b)**2\n        \n        j11 = (b-a)/(a+b)\n        j12 = u_star**2\n        j21 = -2*b/(a+b)\n        j22 = -u_star**2\n        \n        J = np.array([[j11, j12], [j21, j22]])\n        D = np.diag([Du, Dv])\n\n        # 2. Generate discrete wavenumbers k\n        n = np.arange(N // 2 + 1)\n        k_values = (2 * np.pi / L) * n\n\n        # 3. Analyze Explicit Euler stability and Turing instability\n        dt_explicit_max = float('inf')\n        max_real_part_global = -float('inf')\n        \n        for k in k_values:\n            k_squared = k**2\n            M_k = J - k_squared * D\n            eigenvalues = np.linalg.eigvals(M_k)\n\n            for eig in eigenvalues:\n                real_part = eig.real\n                max_real_part_global = max(max_real_part_global, real_part)\n\n                if real_part >= 0:\n                    dt_explicit_max = 0.0\n                elif dt_explicit_max > 0: # Avoid division by zero if unstable\n                    dt_lambda = -2 * real_part / (np.abs(eig)**2)\n                    dt_explicit_max = min(dt_explicit_max, dt_lambda)\n\n        unstable_band = max_real_part_global > 0\n\n        # 4. Analyze Semi-Implicit stability using bisection search\n        def check_semi_implicit_stability(dt):\n            if dt == 0:\n                return True\n            max_rho = 0.0\n            B = np.eye(2) + dt * J\n            for k in k_values:\n                k_squared = k**2\n                # Inverse of (I + dt*k^2*D) is diag(1/(1+dt*k^2*D_i))\n                A_inv_diag = 1.0 / (1.0 + dt * k_squared * np.array([Du, Dv]))\n                A_inv = np.diag(A_inv_diag)\n                \n                G_k = A_inv @ B\n                \n                rho = np.max(np.abs(np.linalg.eigvals(G_k)))\n                max_rho = max(max_rho, rho)\n            \n            return max_rho = 1.0\n\n        low, high = bisection_low, bisection_high\n        for _ in range(bisection_iter):\n            mid = (low + high) / 2\n            if check_semi_implicit_stability(mid):\n                low = mid  # This dt is stable, try for a larger one\n            else:\n                high = mid # This dt is unstable, reduce the upper bound\n        \n        dt_semi_implicit_max = low\n        \n        results.append((dt_explicit_max, dt_semi_implicit_max, unstable_band))\n\n    # 5. Format and print the final output\n    result_strings = []\n    for res_tuple in results:\n        # Format the numbers and the boolean as required.\n        # Python's default bool __str__ is 'True'/'False', which is what is needed.\n        formatted_string = f\"[{res_tuple[0]:.6f},{res_tuple[1]:.6f},{res_tuple[2]}]\"\n        result_strings.append(formatted_string)\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}