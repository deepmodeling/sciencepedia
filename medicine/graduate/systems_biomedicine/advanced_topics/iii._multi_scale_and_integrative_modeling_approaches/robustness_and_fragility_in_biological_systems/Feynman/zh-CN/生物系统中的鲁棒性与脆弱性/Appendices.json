{
    "hands_on_practices": [
        {
            "introduction": "负反馈是生物系统中实现稳健性的一个基本机制，从基因调控到生理稳态无处不在。本练习将通过一个简洁的生物合成模块，让你亲手推导并量化负反馈是如何降低系统对外部扰动的敏感性的。通过这个实践，你将从第一性原理出发，深刻理解反馈增益 $K$ 在增强系统稳健性中的关键作用。",
            "id": "4384434",
            "problem": "一个最小的生物合成控制模块被建模如下。令 $x(t)$ 表示基因产物的浓度。在质量作用动力学下，$x(t)$ 由上游控制器信号 $u(t)$ 以速率 $k_{u}\\,u(t)$ 产生，并以速率 $k_{d}\\,x(t)$ 通过一级过程降解，其中 $k_{u}0$ 且 $k_{d}0$。控制器实现了一个线性负反馈，使得 $u(t)=u_{0}-K\\,x(t)$，其中 $K \\ge 0$，$u_{0}$ 是一个恒定的设定点指令。\n\n从质量作用产生和一级损失的定义出发，并使用稳态定义 $\\dot{x}=0$，推导稳态 $x^{\\ast}$ 作为 $k_{u}$、$k_{d}$、$K$ 和 $u_{0}$ 的函数。将绝对稳态输入灵敏度定义为 $S_{u}=\\frac{\\partial x^{\\ast}}{\\partial u_{0}}$，并且仅使用这些基础，获得 $S_{u}$ 的闭式表达式，并解释它如何依赖于 $K$（就对 $u_{0}$ 变化的鲁棒性而言）。\n\n最终答案只需提供 $S_{u}$ 关于 $k_{u}$、$k_{d}$ 和 $K$ 的代数表达式。不要包含单位。无需四舍五入。",
            "solution": "该问题陈述被评估为具有科学依据、提法得当且客观。它描述了一个常用于系统生物学中的负反馈回路的标准最小模型，该模型基于已确立的动力学原理。所有参数和目标都定义清晰，没有内部矛盾或信息缺失。该问题是有效的。\n\n基因产物浓度 $x(t)$ 的动态行为由其产生和降解之间的平衡所决定。变化率 $\\dot{x} = \\frac{dx}{dt}$ 由以下常微分方程描述：\n$$\n\\frac{dx}{dt} = \\text{产生速率} - \\text{降解速率}\n$$\n根据问题陈述，在质量作用动力学下，产生速率由控制器信号 $u(t)$ 驱动，为 $k_{u}\\,u(t)$。降解是一个一级过程，速率为 $k_{d}\\,x(t)$。因此，控制方程为：\n$$\n\\frac{dx}{dt} = k_{u}\\,u(t) - k_{d}\\,x(t)\n$$\n控制器实现了一个线性负反馈，其中信号 $u(t)$ 定义为：\n$$\nu(t) = u_{0} - K\\,x(t)\n$$\n这里，$u_{0}$ 是一个恒定的设定点指令，$K \\ge 0$ 是反馈增益。将 $u(t)$ 的这个表达式代入速率方程，得到：\n$$\n\\frac{dx}{dt} = k_{u}\\,(u_{0} - K\\,x(t)) - k_{d}\\,x(t)\n$$\n展开这个方程得到：\n$$\n\\frac{dx}{dt} = k_{u}\\,u_{0} - k_{u}\\,K\\,x(t) - k_{d}\\,x(t)\n$$\n问题要求找到稳态浓度 $x^{\\ast}$。根据定义，稳态是浓度不再随时间变化的条件，即 $\\frac{dx}{dt} = 0$。令 $x^{\\ast}$ 为稳态时的 $x$ 值。方程变为：\n$$\n0 = k_{u}\\,u_{0} - k_{u}\\,K\\,x^{\\ast} - k_{d}\\,x^{\\ast}\n$$\n为了求解 $x^{\\ast}$，我们将包含 $x^{\\ast}$ 的项组合在一起：\n$$\nk_{u}\\,K\\,x^{\\ast} + k_{d}\\,x^{\\ast} = k_{u}\\,u_{0}\n$$\n在左边提取公因子 $x^{\\ast}$ 得到：\n$$\nx^{\\ast}(k_{u}\\,K + k_{d}) = k_{u}\\,u_{0}\n$$\n分离 $x^{\\ast}$，我们得到稳态浓度作为系统参数的函数的表达式：\n$$\nx^{\\ast} = \\frac{k_{u}\\,u_{0}}{k_{d} + k_{u}\\,K}\n$$\n接下来，我们被要求找到绝对稳态输入灵敏度 $S_{u}$，它被定义为稳态浓度 $x^{\\ast}$ 对输入指令 $u_{0}$ 的偏导数：\n$$\nS_{u} = \\frac{\\partial x^{\\ast}}{\\partial u_{0}}\n$$\n我们将此定义应用于推导出的 $x^{\\ast}$ 表达式。参数 $k_{u}$、$k_{d}$ 和 $K$ 相对于 $u_{0}$ 是常数。\n$$\nS_{u} = \\frac{\\partial}{\\partial u_{0}} \\left( \\frac{k_{u}\\,u_{0}}{k_{d} + k_{u}\\,K} \\right)\n$$\n由于项 $\\frac{k_{u}}{k_{d} + k_{u}\\,K}$ 是 $u_{0}$ 的一个常数乘数，微分很简单：\n$$\nS_{u} = \\frac{k_{u}}{k_{d} + k_{u}\\,K}\n$$\n这就是灵敏度 $S_{u}$ 的闭式表达式。\n\n最后，我们必须解释这种灵敏度如何依赖于反馈增益 $K$。量 $S_{u}$ 衡量了当输入信号 $u_{0}$ 发生单位变化时，稳态输出 $x^{\\ast}$ 变化了多少。一个较小的 $S_{u}$ 值表明系统输出受输入指令的变化或扰动的影响较小，这一特性被称为鲁棒性。\n\n分析 $S_{u}$ 的表达式，分子 $k_{u}$ 是一个正常数。分母是 $k_{d} + k_{u}\\,K$。因为 $k_{u}  0$ 且 $k_{d}  0$，并且反馈增益 $K \\ge 0$，所以分母是严格为正的。\n当反馈增益 $K$ 从 0 开始增加时，项 $k_{u}\\,K$ 也增加。这导致整个分母 $k_{d} + k_{u}\\,K$ 增加。因此，分数 $S_{u}$ 的值减小。\n\n在没有反馈的情况下（$K=0$），灵敏度达到其最大值 $S_{u} = \\frac{k_{u}}{k_{d}}$，这对应于开环灵敏度。随着负反馈强度（$K$）的增加，灵敏度 $S_{u}$ 被抑制。因此，负反馈降低了系统输出对其输入指令信号变化的灵敏度，从而增强了系统的鲁棒性。这展示了控制理论应用于生物系统的一个基本原理：负反馈是实现鲁棒性的关键机制。",
            "answer": "$$\n\\boxed{\\frac{k_{u}}{k_{d} + k_{u} K}}\n$$"
        },
        {
            "introduction": "虽然系统在特定条件下表现出稳健性，但它们也可能在参数变化的临界点附近变得极其脆弱，这种现象被称为“临界点”或“分岔”。本练习将通过一个非线性动力学模型，让你探索系统如何随着控制参数的变化而改变其稳定性。你将亲手计算系统的“稳健性边界”，并观察当系统接近分岔点时，这个边界是如何收缩的，从而揭示稳健性与脆弱性之间的深刻联系。",
            "id": "4384463",
            "problem": "一个单物种调控模块在唯象层面上由一维常微分方程（ODE）$\\dot{x}=\\mu - x^{2},$建模，其中 $x$ 是效应物种的浓度，$\\mu$ 是一个控制参数，代表由上游信号和环境条件引起的净生产驱动。该系统会受到沿 $x$ 坐标的瞬时状态扰动（例如，在 $t=0$ 时刻改变 $x$ 但不改变 $\\mu$ 的瞬时基因敲降或过表达脉冲）。\n\n仅使用动力系统理论中关于一维流的核心定义，回答以下问题：\n\n1. 确定稳态数量发生变化的参数 $\\mu$ 的值。您的推导必须从稳态是矢量场的零点的定义出发，并评估当 $\\mu$ 变化时稳态集合的定性变化。\n\n2. 将稳态对瞬时状态扰动的鲁棒性定义为：将系统从稳定稳态驱动到不再返回该稳态的轨道所需的最小扰动幅度 $x$。当存在稳定稳态时，计算这个最小扰动幅度 $\\Delta x_{\\text{crit}}(\\mu)$ 作为 $\\mu$ 的函数。您的推导必须识别状态空间中的吸引盆边界，并利用流的几何形状来确定逃逸条件。\n\n将您的最终答案以一个包含分岔参数值和鲁棒性裕度的双元素行矩阵形式给出，格式为 $\\left(\\mu_{c},\\,\\Delta x_{\\text{crit}}(\\mu)\\right)$。本题不需要四舍五入。最终答案中不要包含单位。",
            "solution": "该问题被验证为具有科学依据、问题明确、客观且自洽。它是一维动力系统理论和分岔分析中的一个标准练习，直接适用于系统生物学中的唯象模型。\n\n按要求，分析分为两部分进行。\n\n**第1部分：分岔参数值的确定**\n\n系统的稳态，记为 $x^*$，是状态空间中状态变量变化率为零的点。对于给定的一维常微分方程（ODE），此条件表示为 $\\dot{x} = 0$。\n\n控制方程为：\n$$\n\\dot{x} = f(x; \\mu) = \\mu - x^{2}\n$$\n其中 $x$ 是状态变量，$\\mu$ 是一个控制参数。\n\n为求稳态，我们令 $\\dot{x} = 0$：\n$$\n\\mu - (x^*)^{2} = 0\n$$\n求解 $x^*$，我们得到：\n$$\n(x^*)^{2} = \\mu\n$$\n该方程确定了稳态是参数 $\\mu$ 的函数。我们必须分析 $x^*$ 的实数解，因为浓度必须是实数。\n\n1.  如果 $\\mu  0$，存在两个不同的实数稳态：\n    $$\n    x_{1,2}^* = \\pm\\sqrt{\\mu}\n    $$\n2.  如果 $\\mu = 0$，存在一个单一的实数稳态：\n    $$\n    x^* = 0\n    $$\n3.  如果 $\\mu  0$，$x^*$ 没有实数解，意味着系统没有稳态。\n\n当参数 $\\mu$ 经过使方程 $(x^*)^2 = \\mu$ 实根数量改变的值时，稳态的数量发生定性变化。这个转变恰好发生在 $\\mu = 0$。对于 $\\mu  0$，没有稳态。在 $\\mu = 0$ 时，出现一个稳态。对于 $\\mu  0$，这个单一状态分裂成两个不同的稳态。这种产生一对稳态（一个稳定，一个不稳定）的分岔类型被称为鞍结分岔 (saddle-node bifurcation)。\n\n因此，稳态数量发生变化的参数 $\\mu$ 的值是 $\\mu_c = 0$。\n\n**第2部分：鲁棒性裕度的计算**\n\n首先，我们必须确定系统的稳定稳态。在一维系统中，稳态 $x^*$ 的稳定性由矢量场导数的符号决定，即 $f'(x^*) = \\frac{df}{dx}\\bigg|_{x=x^*}$。如果 $f'(x^*)  0$，稳态是稳定的；如果 $f'(x^*)  0$，稳态是不稳定的。\n\n$f(x; \\mu) = \\mu - x^2$ 的导数是：\n$$\nf'(x) = -2x\n$$\n仅当 $\\mu  0$ 时存在稳定稳态，此时我们有两个稳态，$x_1^* = \\sqrt{\\mu}$ 和 $x_2^* = -\\sqrt{\\mu}$。我们评估每个稳态的稳定性：\n\n1.  对于 $x_1^* = \\sqrt{\\mu}$：\n    $$\n    f'(\\sqrt{\\mu}) = -2\\sqrt{\\mu}\n    $$\n    由于 $\\mu  0$，所以 $\\sqrt{\\mu}  0$，因此 $f'(\\sqrt{\\mu})  0$。这个稳态是**稳定的**。我们将其表示为 $x^*_{\\text{stable}} = \\sqrt{\\mu}$。\n\n2.  对于 $x_2^* = -\\sqrt{\\mu}$：\n    $$\n    f'(-\\sqrt{\\mu}) = -2(-\\sqrt{\\mu}) = 2\\sqrt{\\mu}\n    $$\n    由于 $\\mu  0$，所以 $2\\sqrt{\\mu}  0$，因此 $f'(-\\sqrt{\\mu})  0$。这个稳态是**不稳定的**。我们将其表示为 $x^*_{\\text{unstable}} = -\\sqrt{\\mu}$。\n\n问题将鲁棒性 $\\Delta x_{\\text{crit}}(\\mu)$ 定义为将系统从稳定稳态驱动到不再返回的轨道所需的最小扰动幅度。这需要确定稳定稳态 $x^*_{\\text{stable}} = \\sqrt{\\mu}$ 的吸引盆。\n\n实线上的流由 $\\dot{x} = \\mu - x^2$ 的符号决定。这个二次方程的根是 $\\pm\\sqrt{\\mu}$。\n- 当 $x  \\sqrt{\\mu}$ 时，$\\dot{x}  0$，所以轨道向 $x^*_{\\text{stable}}$ 移动。\n- 当 $-\\sqrt{\\mu}  x  \\sqrt{\\mu}$ 时，$\\dot{x}  0$，所以轨道向 $x^*_{\\text{stable}}$ 移动。\n- 当 $x  -\\sqrt{\\mu}$ 时，$\\dot{x}  0$，所以轨道远离区间 $[-\\sqrt{\\mu}, \\infty)$ 并朝 $-\\infty$ 移动。\n\n不稳定的稳态 $x^*_{\\text{unstable}} = -\\sqrt{\\mu}$ 作为一个分界线。它是稳定稳态 $x^*_{\\text{stable}}$ 吸引盆的边界。$x^*_{\\text{stable}}$ 的吸引盆是区间 $(-\\sqrt{\\mu}, \\infty)$。任何从 $x_0  -\\sqrt{\\mu}$ 开始的轨道都将收敛到 $\\sqrt{\\mu}$。任何从 $x_0  -\\sqrt{\\mu}$ 开始的轨道都将逃逸到 $-\\infty$。\n\n系统初始处于稳定稳态 $x^*_{\\text{stable}} = \\sqrt{\\mu}$。一个扰动 $\\Delta x$ 将系统移动到一个新状态 $x_{\\text{new}} = \\sqrt{\\mu} + \\Delta x$。\n要逃离吸引盆，受扰动的状态必须被推到或越过吸引盆的边界。\n一个正向扰动 ($\\Delta x  0$) 导致 $x_{\\text{new}}  \\sqrt{\\mu}$，这仍在吸引盆内。系统将简单地松弛回 $\\sqrt{\\mu}$。\n因此，逃逸只能由负向扰动（$\\Delta x  0$）引起。\n\n逃逸的临界条件是当受扰动的状态达到吸引盆边界时：\n$$\nx_{\\text{new}} = x^*_{\\text{unstable}}\n$$\n$$\n\\sqrt{\\mu} + \\Delta x = -\\sqrt{\\mu}\n$$\n求解临界扰动 $\\Delta x_{\\text{crit}}$，我们发现：\n$$\n\\Delta x_{\\text{crit}} = -2\\sqrt{\\mu}\n$$\n问题要求的是最小扰动*幅度*。幅度是这个扰动的绝对值：\n$$\n|\\Delta x_{\\text{crit}}| = |-2\\sqrt{\\mu}|\n$$\n由于此分析在 $\\mu  0$ 时有效，$\\sqrt{\\mu}$ 是实数且为正。因此，幅度为：\n$$\n\\Delta x_{\\text{crit}}(\\mu) = 2\\sqrt{\\mu}\n$$\n这是将系统从 $x=\\sqrt{\\mu}$ 移动到其吸引盆边界并导致其逃逸所需的最小扰动幅度。这个函数在 $\\mu  0$ 时有定义，而这恰好是稳定稳态存在的条件。\n\n结合两部分的结果，我们得到分岔参数值为 $\\mu_c = 0$，鲁棒性裕度为 $\\Delta x_{\\text{crit}}(\\mu) = 2\\sqrt{\\mu}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  2\\sqrt{\\mu} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实生物系统的复杂性源于其庞大的组件网络，而不仅仅是简单的调控模块。本练习将引导你从分析简单模块转向评估复杂网络，通过使用通量平衡分析（FBA）——一种在系统生物学中用于分析全基因组尺度代谢网络的强大计算方法。你将通过编程模拟基因敲除对细胞生长速率的影响，从而具体地量化代谢网络对遗传扰动的稳健性，并理解冗余通路在其中扮演的角色。",
            "id": "4384444",
            "problem": "考虑一个使用通量平衡分析（Flux Balance Analysis, FBA）进行分析的玩具代谢网络。通量平衡分析（FBA）利用代谢的稳态质量平衡模型来计算最优通量分布，该分布在化学计量约束和反应界限的限制下，最大化一个指定的目标（通常是生物量增长）。其基本依据是稳态下的质量守恒定律，该定律被编码为线性系统约束 $S v = \\mathbf{0},$ 其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。每个反应通量 $v_i$ 也受到下界和上界 $\\ell_i \\le v_i \\le u_i$ 的约束。目标是最大化 $c^\\top v$，其中 $c$ 是选择生物量生成反应的目标系数向量。基因敲除通过删除它们所控制的反应来建模，具体实现方式是将相关反应的界限设置为 $0 \\le v_i \\le 0$。\n\n该网络包含三种内部代谢物 $A$、$B$ 和 $C$，以及五个不可逆反应 $R_1,\\dots,R_5$，具体如下：\n- $R_1$：将 $A$ 摄入细胞，在内部产生 $A$；此反应的上限受环境相关的摄取极限 $U_A$ 限制，下限为 $0$。\n- $R_2$：转化 $A \\to B$。\n- $R_3$：转化 $B \\to C$。\n- $R_4$：转化 $C \\to \\text{Biomass}$；这是生物量生成反应，定义了生长速率。\n- $R_5$：备用捷径 $A \\to C$。\n\n针对内部代谢物 $A$、$B$、$$C$$ 和反应 $R_1,\\dots,R_5$ 的化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 5}$ 为\n$$\nS = \\begin{bmatrix}\n1  -1  0  0  -1 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  1\n\\end{bmatrix}.\n$$\n目标是最大化生物量通量，其目标向量为\n$$\nc = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix}.\n$$\n\n所有反应 $R_2, R_3, R_4, R_5$ 均为不可逆反应，其界限为 $0 \\le v_i \\le U_i$，其中 $U_i$ 是一个上限参数。反应 $R_1$ 的界限为 $0 \\le v_1 \\le U_A$。基因到反应的映射关系为：\n- $G_{\\text{upt}} \\mapsto R_1$,\n- $G_{A \\to B} \\mapsto R_2$,\n- $G_{B \\to C} \\mapsto R_3$,\n- $G_{C \\to Bio} \\mapsto R_4$,\n- $G_{A \\to C\\_\\text{alt}} \\mapsto R_5$.\n\n对于给定的环境，定义野生型最优生长速率 $z_{\\text{wt}} = \\max_{v} \\{ c^\\top v : S v = 0, \\ \\ell \\le v \\le u \\}$，单位为每小时 $(1/\\text{h})$。对于每个单基因敲除 $g$，通过将其关联反应的界限设置为 $0 \\le v_i \\le 0$ 来删除该反应，并在相同环境下计算 $z_g$。定义敲除体 $g$ 的相对生长率为 $r_g = z_g / z_{\\text{wt}}$（当 $z_{\\text{wt}}  0$ 时），并按惯例在 $z_{\\text{wt}} = 0$ 时设置 $r_g = 0$（以避免除以零）。对于给定的环境，定义稳健性指标：\n- 各敲除体中的最小相对生长率 $$r_{\\min} = \\min_g r_g$$，\n- 各敲除体的平均相对生长率 $$\\bar{r} = \\frac{1}{N} \\sum_{g} r_g$$，其中 $N$ 为基因数量，\n- 相对生长率达到或超过阈值 $\\alpha$ 的敲除体比例，即 $$f_\\alpha = \\frac{1}{N} \\left| \\{ g : r_g \\ge \\alpha \\} \\right|$$，以小数表示。\n\n使用线性规划来解决每个 FBA 问题。不使用角度。所有生长速率必须以 $1/\\text{h}$ 表示。阈值为 $\\alpha = 0.5$。\n\n测试套件（每个环境指定上限 $U_A, U_{R2}, U_{R3}, U_{R5}$；所有其他反应上限设置为 $1000$；所有下限均为 $0$）：\n1. 环境 $1$（备用途径存在，主途径容量受限的正常情况）：$U_A = 10$, $U_{R2} = 5$, $U_{R3} = 1000$, $U_{R5} = 1000$。\n2. 环境 $2$（底物限制）：$U_A = 1$, $U_{R2} = 5$, $U_{R3} = 1000$, $U_{R5} = 1000$。\n3. 环境 $3$（备用途径禁用）：$U_A = 10$, $U_{R2} = 5$, $U_{R3} = 1000$, $U_{R5} = 0$。\n4. 环境 $4$（无底物；边界情况）：$U_A = 0$, $U_{R2} = 5$, $U_{R3} = 1000$, $U_{R5} = 1000$。\n\n你的程序必须使用上述流程，为每个环境计算三元组 $[r_{\\min}, \\bar{r}, f_\\alpha]$。最终输出必须是单行文本，包含环境 $1$ 到 $4$ 的结果按序连接而成的、用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,\\dots,x_{12}]$，其中条目为浮点数。所有生长速率的单位为 $1/\\text{h}$，比例为 $[0,1]$ 区间内的小数。不应打印其他任何文本。",
            "solution": "目标是利用基于质量守恒定律和线性优化的通量平衡分析（FBA）来表征基因单敲除后生长速率的稳健性。在稳态下，细胞内代谢物浓度满足 $S v = \\mathbf{0}$，其中 $S$ 是化学计量矩阵，$v$ 是通量向量。每个反应通量 $v_i$ 受界限 $\\ell_i \\le v_i \\le u_i$ 约束。生物量生长速率是目标 $c^\\top v$，其中 $c$ 选择生物量反应。通量平衡分析被构建为一个线性规划问题：\n$$\n\\text{maximize } c^\\top v \\quad \\text{subject to } S v = 0, \\ \\ell \\le v \\le u.\n$$\n这可以通过在相同约束条件下最小化 $-c^\\top v$ 来通过线性规划求解。\n\n我们通过删除反应来模拟基因敲除：如果一个基因控制反应 $i$，我们将其界限设置为 $0 \\le v_i \\le 0$，从而移除其贡献。对于每个环境，我们计算野生型最优生长速率 $z_{\\text{wt}}$，然后对每个基因 $g$，我们在敲除条件下计算 $z_g$，并推导出相对生长率 $r_g = z_g / z_{\\text{wt}}$（如果 $z_{\\text{wt}}  0$），否则设置 $r_g = 0$。\n\n网络规格提供了 $S$ 和 $c$：\n$$\nS = \\begin{bmatrix}\n1  -1  0  0  -1 \\\\\n0  1  -1  0  0 \\\\\n0  0  1  -1  1\n\\end{bmatrix}, \\quad\nc = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix}.\n$$\n反应 $R_1,\\dots,R_5$ 分别代表摄取、途径步骤、生物量反应和一条备用捷径。所有反应都是不可逆的，下界 $\\ell_i = 0$，上界根据每个环境定义：$u_1 = U_A$，$u_2 = U_{R2}$，$u_3 = U_{R3}$，$u_4 = 1000$，$u_5 = U_{R5}$。基因到反应的映射关系为 $G_{\\text{upt}} \\mapsto R_1$，$G_{A \\to B} \\mapsto R_2$，$G_{B \\to C} \\mapsto R_3$，$G_{C \\to Bio} \\mapsto R_4$，$G_{A \\to C\\_\\text{alt}} \\mapsto R_5$。\n\n对于每个环境，流程如下：\n1. 构建野生型线性规划问题：在 $S v = \\mathbf{0}$ 和界限 $\\ell \\le v \\le u$ 的约束下，最小化 $-c^\\top v$。求解得到 $z_{\\text{wt}} = c^\\top v^\\star$，即最优生物量通量，单位为 $1/\\text{h}$。\n2. 对于每个基因敲除，将相关反应的界限修改为 $0 \\le v_i \\le 0$，求解线性规划问题得到 $z_g$，然后计算 $r_g$。如果 $z_{\\text{wt}} = 0$，则将所有 $r_g$ 设置为 $0$，以避免除以零并表示无生长基线。\n3. 计算稳健性指标：$r_{\\min} = \\min_g r_g$，$\\bar{r} = \\frac{1}{N} \\sum_g r_g$（其中 $N = 5$ 个基因），以及 $f_\\alpha = \\frac{1}{N} \\left| \\{ g : r_g \\ge \\alpha \\} \\right|$（其中 $\\alpha = 0.5$）。\n\n对所选测试环境的科学解释：\n- 环境 $1$ 中 $U_A = 10$ 且 $U_{R2} = 5$，这使得主途径 $A \\to B \\to C \\to \\text{Biomass}$ 通过 $R_2$ 最多只能携带 $5$ 个单位的通量，但备用途径 $A \\to C$ 可以补充高达 $1000$，从而实现由总摄取驱动的生长；因此，除了摄取和生物量转化反应外，大多数敲除都是非必需的。当 $U_A$ 超过主途径瓶颈时，删除备用途径会降低可达到的生长速率，导致该敲除的相对生长率为 $0.5$。\n- 环境 $2$ 中 $U_A = 1$，是底物限制的；备用途径不是必需的，因为主途径的容量超过了底物供应量，因此删除备用途径没有影响。\n- 环境 $3$ 通过 $U_{R5} = 0$ 禁用了备用途径；即使 $U_A = 10$，主途径在 $U_{R2} = 5$ 处的瓶颈也将野生型生长速率限制在 $5$，敲除主途径步骤会导致零生长，反映了其脆弱性。\n- 环境 $4$ 中没有底物（$U_A = 0$）；野生型生长速率为零，按照惯例，相对生长率均设置为 $0$。\n\n算法实现使用线性规划（例如，标准求解器中的 Highs 方法）来可靠地解决每个优化问题。最终程序计算所有环境的指标，并打印一个单行的逗号分隔列表 $[r_{\\min}^{(1)}, \\bar{r}^{(1)}, f_\\alpha^{(1)}, r_{\\min}^{(2)}, \\bar{r}^{(2)}, f_\\alpha^{(2)}, r_{\\min}^{(3)}, \\bar{r}^{(3)}, f_\\alpha^{(3)}, r_{\\min}^{(4)}, \\bar{r}^{(4)}, f_\\alpha^{(4)}]$。所有生长速率都以 $1/\\text{h}$ 表示，比例是小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef fba_optimal_growth(S, c, bounds):\n    \"\"\"\n    Solve the FBA problem: maximize c^T v subject to S v = 0 and bounds.\n    Implemented as minimizing -c^T v.\n    Returns the optimal objective value (growth rate) and the flux vector.\n    \"\"\"\n    # Convert maximization to minimization\n    obj = -c  # minimize -c^T v\n    A_eq = S\n    b_eq = np.zeros(S.shape[0])\n\n    # SciPy linprog expects bounds as a list of (lower, upper) for each variable\n    res = linprog(c=obj, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method=\"highs\")\n    if res.success:\n        growth = float(c @ res.x)\n        return growth, res.x\n    else:\n        # Infeasible or failed optimization implies zero growth in this simplified context\n        return 0.0, np.zeros(S.shape[1])\n\ndef robustness_metrics_for_environment(U_A, U_R2, U_R3, U_R5, alpha=0.5):\n    \"\"\"\n    Compute robustness metrics (min relative growth, mean relative growth, fraction = alpha)\n    for a given environment defined by upper bounds.\n    \"\"\"\n    # Stoichiometric matrix S (3 metabolites x 5 reactions)\n    S = np.array([\n        [1, -1,  0,  0, -1],  # A balance: R1 produces A; R2 and R5 consume A\n        [0,  1, -1,  0,  0],  # B balance: R2 produces B; R3 consumes B\n        [0,  0,  1, -1,  1],  # C balance: R3 produces C; R4 consumes C; R5 produces C\n    ], dtype=float)\n\n    # Objective: maximize v4 (biomass)\n    c = np.array([0, 0, 0, 1, 0], dtype=float)\n\n    # Default upper bounds\n    U_R4 = 1000.0  # Biomass reaction upper bound\n    # Lower bounds are zero for all reactions (irreversible)\n    lb = [0.0, 0.0, 0.0, 0.0, 0.0]\n    ub = [float(U_A), float(U_R2), float(U_R3), float(U_R4), float(U_R5)]\n    bounds_wt = list(zip(lb, ub))\n\n    # Wild-type optimal growth\n    z_wt, _ = fba_optimal_growth(S, c, bounds_wt)\n\n    # Gene to reaction index mapping\n    gene_to_rxn = {\n        \"G_upt\": 0,         # R1\n        \"G_AtoB\": 1,        # R2\n        \"G_BtoC\": 2,        # R3\n        \"G_CtoBio\": 3,      # R4\n        \"G_AtoC_alt\": 4,    # R5\n    }\n\n    # Compute growth under each single gene knockout\n    rel_growths = []\n    genes = [\"G_upt\", \"G_AtoB\", \"G_BtoC\", \"G_CtoBio\", \"G_AtoC_alt\"]\n    for g in genes:\n        rxn_idx = gene_to_rxn[g]\n        bounds_ko = bounds_wt.copy()\n        bounds_ko[rxn_idx] = (0.0, 0.0)  # delete the reaction\n        z_ko, _ = fba_optimal_growth(S, c, bounds_ko)\n        if z_wt  0.0:\n            rel_growths.append(z_ko / z_wt)\n        else:\n            # By convention when wild-type growth is zero, set relative growth to zero\n            rel_growths.append(0.0)\n\n    rel_growths = np.array(rel_growths, dtype=float)\n    r_min = float(np.min(rel_growths))\n    r_mean = float(np.mean(rel_growths))\n    frac_alpha = float(np.mean(rel_growths = alpha))\n\n    return r_min, r_mean, frac_alpha\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is (U_A, U_R2, U_R3, U_R5)\n    test_cases = [\n        (10.0, 5.0, 1000.0, 1000.0),  # Environment 1\n        (1.0, 5.0, 1000.0, 1000.0),   # Environment 2\n        (10.0, 5.0, 1000.0, 0.0),     # Environment 3\n        (0.0, 5.0, 1000.0, 1000.0),   # Environment 4\n    ]\n\n    alpha = 0.5\n    results = []\n    for U_A, U_R2, U_R3, U_R5 in test_cases:\n        rmin, rmean, frac = robustness_metrics_for_environment(U_A, U_R2, U_R3, U_R5, alpha=alpha)\n        results.extend([rmin, rmean, frac])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}