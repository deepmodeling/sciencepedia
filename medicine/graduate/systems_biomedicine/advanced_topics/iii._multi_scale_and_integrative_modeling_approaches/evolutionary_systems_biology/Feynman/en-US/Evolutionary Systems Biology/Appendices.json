{
    "hands_on_practices": [
        {
            "introduction": "This first exercise tackles a cornerstone of population genetics: mutation-selection balance. We will analyze a simple dynamical system to derive the equilibrium frequency of a deleterious allele, which is determined by the interplay between its constant introduction via mutation and its removal by natural selection . This practice hones crucial skills in analyzing ordinary differential equations and applying asymptotic approximations, powerful tools for simplifying and understanding complex biological models.",
            "id": "4339039",
            "problem": "In a systems biomedicine context, consider a large asexual cell population where a deleterious allele arises from a wild-type allele at a forward mutation rate per unit time denoted by $\\mu > 0$, and cells carrying the deleterious allele experience a constant per capita Malthusian fitness disadvantage $s > 0$ relative to wild-type due to enhanced clearance or reduced proliferation. Assume that back mutation is negligible and that demographic stochasticity can be ignored on the time scale of interest, so that the allele-frequency dynamics are well approximated by a continuous-time ordinary differential equation (ODE) expressing a balance between mutation influx and selection removal. Let $q(t)$ denote the frequency of the deleterious allele at time $t$, with $q(0) \\in [0,1]$, and suppose the dynamics obey\n$$\n\\dot{q}(t) \\equiv \\frac{dq}{dt} = \\mu \\big(1 - q(t)\\big) - s\\, q(t).\n$$\nStarting from this ODE and the interpretation of its terms as fluxes between genetic states, derive the equilibrium frequency $q^{\\ast}$ and establish its local stability. Using asymptotic reasoning based on a separation of scales, identify the parameter regime under which the leading-order approximation $q^{\\ast} \\approx \\mu/s$ holds, and justify this approximation with an explicit expansion to first nontrivial order. Express your final answer as the exact closed-form expression for $q^{\\ast}$ in terms of $\\mu$ and $s$. No numerical evaluation is required.",
            "solution": "To find the equilibrium frequency, $q^{\\ast}$, we set the rate of change of the allele frequency to zero:\n$$\n\\frac{dq}{dt} = \\mu(1 - q^{\\ast}) - sq^{\\ast} = 0\n$$\nSolving this linear equation for $q^{\\ast}$:\n$$\n\\mu - \\mu q^{\\ast} - sq^{\\ast} = 0\n$$\n$$\n\\mu = (\\mu + s)q^{\\ast}\n$$\nThis gives the exact expression for the equilibrium frequency:\n$$\nq^{\\ast} = \\frac{\\mu}{\\mu + s}\n$$\nSince $\\mu > 0$ and $s > 0$, the frequency $q^{\\ast}$ is always between 0 and 1.\n\nTo analyze the local stability of this equilibrium, we examine the derivative of the rate function, $f(q) = \\mu(1 - q) - sq$, with respect to $q$:\n$$\nf'(q) = \\frac{d}{dq} \\left( \\mu - \\mu q - sq \\right) = -\\mu - s\n$$\nSince $\\mu > 0$ and $s > 0$, the derivative $f'(q^{\\ast}) = -(\\mu + s)$ is always negative. A negative derivative indicates that the equilibrium is locally stable. Any small perturbation from $q^{\\ast}$ will decay, and the frequency will return to its equilibrium value.\n\nThe approximation $q^{\\ast} \\approx \\mu/s$ is valid when the mutation rate is much smaller than the selection disadvantage, i.e., $\\mu \\ll s$. To see this, we can rewrite the exact solution:\n$$\nq^{\\ast} = \\frac{\\mu}{s\\left(1 + \\frac{\\mu}{s}\\right)} = \\frac{\\mu}{s} \\left(1 + \\frac{\\mu}{s}\\right)^{-1}\n$$\nWhen $\\mu/s$ is a small parameter, we can use the geometric series expansion $(1+x)^{-1} \\approx 1 - x$ for small $x$. Applying this, we get:\n$$\nq^{\\ast} \\approx \\frac{\\mu}{s} \\left(1 - \\frac{\\mu}{s}\\right) = \\frac{\\mu}{s} - \\frac{\\mu^2}{s^2}\n$$\nThe leading-order term of this expansion is $\\mu/s$, confirming that this is a good approximation when selection is much stronger than mutation.\n\nThe question asks for the exact closed-form expression.",
            "answer": "$$\n\\boxed{\\frac{\\mu}{\\mu+s}}\n$$"
        },
        {
            "introduction": "A central task in modern evolutionary biology is to quantify the forces of evolution from empirical data. This practice bridges theory and application by demonstrating how to estimate a selection coefficient, $s$, from allele frequency time-series data . By linearizing the classic logistic growth equation, you will see how a fundamental model of population dynamics directly informs the statistical methods used to analyze results from experimental evolution.",
            "id": "4339123",
            "problem": "Consider a large, well-mixed, asexual cell population in which two genotypes compete. Let the frequency of the focal genotype at time $t$ be $p(t)$. Assume Malthusian (continuous-time) selection with a constant selection coefficient $s$ such that the frequency dynamics follow the replicator equation, and that the population size is sufficiently large to neglect genetic drift. Deep sequencing at discrete times provides allele counts for the focal genotype, with $k_t$ successes out of $n_t$ total reads at time $t$, yielding the empirical frequency $\\hat{p}_t = k_t/n_t$. The observed data are:\n- $(t, k_t, n_t) = (0, 100, 1000)$,\n- $(t, k_t, n_t) = (5, 200, 1000)$,\n- $(t, k_t, n_t) = (10, 350, 1000)$,\n- $(t, k_t, n_t) = (15, 550, 1000)$,\n- $(t, k_t, n_t) = (20, 700, 1000)$.\n\nUsing a Generalized Linear Model (GLM) with binomial likelihood and the logit link, fit a logistic regression of $\\ln\\!\\left(\\frac{\\hat{p}_t}{1 - \\hat{p}_t}\\right)$ against time $t$ to estimate the selection coefficient $s$. For computational tractability in this setting, you may treat $\\hat{p}_t$ as noise-free estimates of $p(t)$ and perform ordinary least squares on the transformed response $\\ln\\!\\left(\\frac{\\hat{p}_t}{1 - \\hat{p}_t}\\right)$ versus $t$.\n\nDerive, from first principles appropriate to evolutionary systems biology, the relationship connecting selection to the time evolution of the logit transform of the allele frequency, justify why the GLM slope corresponds to $s$ under the stated model, and enumerate the assumptions under which this estimator is unbiased.\n\nCompute the numerical estimate $\\hat{s}$ from the given data. Round your final numerical estimate to four significant figures and express it in day$^{-1}$. Provide only the numerical value as your final answer.",
            "solution": "To find the relationship between the selection coefficient $s$ and the allele frequency $p(t)$, we start with the continuous-time replicator equation, which describes selection in a large asexual population:\n$$\n\\frac{dp}{dt} = s \\cdot p(t) \\cdot (1 - p(t))\n$$\nThis is a separable ordinary differential equation. We can rearrange and integrate it to find the solution for $p(t)$:\n$$\n\\frac{dp}{p(1-p)} = s \\, dt\n$$\nUsing the partial fraction identity $\\frac{1}{p(1-p)} = \\frac{1}{p} + \\frac{1}{1-p}$, we integrate both sides:\n$$\n\\int \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = \\int s \\, dt\n$$\n$$\n\\ln(p) - \\ln(1-p) = st + C\n$$\nwhere $C$ is the constant of integration. The left side is the logit of the frequency, $\\text{logit}(p(t)) = \\ln\\left(\\frac{p(t)}{1-p(t)}\\right)$. This gives the relationship:\n$$\n\\ln\\left(\\frac{p(t)}{1-p(t)}\\right) = st + \\text{logit}(p(0))\n$$\nThis result shows that the logit of the allele frequency is a linear function of time, with a slope equal to the selection coefficient $s$. Therefore, we can estimate $s$ by performing a linear regression of the logit-transformed empirical frequencies against time. This method assumes that the population is large (negligible genetic drift), reproduction is asexual, and the selection coefficient $s$ is constant.\n\nFirst, we calculate the empirical frequencies $\\hat{p}_t$ and their logit transformations $y_t = \\ln(\\hat{p}_t / (1-\\hat{p}_t))$ from the data:\n- $t=0$: $\\hat{p}_0 = 100/1000 = 0.1 \\implies y_0 = \\ln(0.1/0.9) \\approx -2.19722$\n- $t=5$: $\\hat{p}_5 = 200/1000 = 0.2 \\implies y_5 = \\ln(0.2/0.8) \\approx -1.38629$\n- $t=10$: $\\hat{p}_{10} = 350/1000 = 0.35 \\implies y_{10} = \\ln(0.35/0.65) \\approx -0.61904$\n- $t=15$: $\\hat{p}_{15} = 550/1000 = 0.55 \\implies y_{15} = \\ln(0.55/0.45) \\approx 0.20067$\n- $t=20$: $\\hat{p}_{20} = 700/1000 = 0.7 \\implies y_{20} = \\ln(0.7/0.3) \\approx 0.84730$\n\nWe now perform an ordinary least squares regression of $y_t$ on $t$. The slope of the line, $\\hat{s}$, is given by:\n$$\n\\hat{s} = \\frac{\\sum (t_i - \\bar{t})(y_i - \\bar{y})}{\\sum (t_i - \\bar{t})^2}\n$$\nThe mean time is $\\bar{t} = (0+5+10+15+20)/5 = 10$.\nThe mean of the logit values is $\\bar{y} \\approx (-2.19722 - 1.38629 - 0.61904 + 0.20067 + 0.84730)/5 \\approx -0.63092$.\n\nNumerator: $\\sum (t_i - \\bar{t})(y_i - \\bar{y})$\n- $(0-10)(-2.19722 - (-0.63092)) = 15.6630$\n- $(5-10)(-1.38629 - (-0.63092)) = 3.77685$\n- $(10-10)(-0.61904 - (-0.63092)) = 0$\n- $(15-10)(0.20067 - (-0.63092)) = 4.15795$\n- $(20-10)(0.84730 - (-0.63092)) = 14.7822$\nSum of products = $38.3800$\n\nDenominator: $\\sum (t_i - \\bar{t})^2 = (0-10)^2 + (5-10)^2 + (10-10)^2 + (15-10)^2 + (20-10)^2 = 100 + 25 + 0 + 25 + 100 = 250$.\n\nThe estimated selection coefficient is:\n$$\n\\hat{s} = \\frac{38.3800}{250} = 0.15352\n$$\nRounding to four significant figures gives $\\hat{s} = 0.1535$ day$^{-1}$.",
            "answer": "$$\\boxed{0.1535}$$"
        },
        {
            "introduction": "This final practice delves into the core of evolutionary systems biology by exploring how interactions between components can give rise to non-additive effects. We will model a simple gene regulatory circuit to show how a nonlinear genotype-phenotype map can generate epistasis at the level of organismal fitness, even when the underlying mutations affect independent biophysical parameters . This exercise highlights the critical concept that complex evolutionary outcomes are often emergent properties of the underlying biological network.",
            "id": "4339126",
            "problem": "A bacterial promoter is activated by binding of a Transcription Factor (TF). Let the steady-state expression level $E$ (in molecules per cell) as a function of intracellular TF concentration $x$ (in nanomolar) be given by the Hill function\n$$\nE(x) = E_{\\max}\\,\\frac{x^{n}}{K^{n} + x^{n}},\n$$\nwhere $E_{\\max} > 0$ is the maximal expression, $K > 0$ is the activation constant, and $n \\geq 1$ is the Hill coefficient. Assume a wild-type background with $E_{\\max} = 100$ molecules per cell, $K = 30\\,\\mathrm{nM}$, $n = 2$, and $x_0 = 20\\,\\mathrm{nM}$.\n\nConsider two single mutations:\n- A promoter mutation $P$ that increases $E_{\\max}$ by a multiplicative factor $a = 2$ (for any $x$).\n- A TF mutation $T$ that increases the intracellular TF concentration by a multiplicative factor $b = 1.5$, so that the concentration becomes $b\\,x_0$ in the mutant background.\n\nDefine four genotypes by the mutation presence-absence indicators $(i,j) \\in \\{0,1\\}^2$ for $(P,T)$ so that $i=1$ if the promoter mutation is present and $j=1$ if the TF mutation is present. Under genotype $(i,j)$, the expression is\n$$\nE_{ij} \\equiv E(i,j) = a^{i}\\,E_{\\max}\\,\\frac{(b^{j}x_0)^{n}}{K^{n} + (b^{j}x_0)^{n}}.\n$$\n\nSuppose organismal fitness is measured using a fixed expression threshold, modeling a viability decision: define\n$$\nW_{ij} = \\begin{cases}\n1, & \\text{if } E_{ij} \\geq \\Theta,\\\\\n0, & \\text{if } E_{ij} < \\Theta,\n\\end{cases}\n$$\nwith threshold $\\Theta = 70$ molecules per cell. Using the additive epistasis coefficient\n$$\n\\varepsilon = W_{11} - W_{10} - W_{01} + W_{00},\n$$\ncompute the numerical value of $\\varepsilon$ for the given parameter values. Provide your answer as a single number without units. No rounding is required.",
            "solution": "To compute the epistasis coefficient, we must first calculate the expression level $E_{ij}$ and the corresponding fitness $W_{ij}$ for all four genotypes: wild-type (0,0), promoter mutant (1,0), TF mutant (0,1), and double mutant (1,1). The given parameters are $E_{\\max} = 100$, $K = 30$, $n = 2$, $x_0 = 20$, $a = 2$, $b = 1.5$, and the fitness threshold is $\\Theta = 70$.\n\n1.  **Wild type (0,0):** $i=0, j=0$. The expression is:\n    $$\n    E_{00} = 100\\,\\frac{20^{2}}{30^{2} + 20^{2}} = 100\\,\\frac{400}{900 + 400} = 100\\,\\frac{400}{1300} = \\frac{400}{13} \\approx 30.77\n    $$\n    Since $E_{00} < 70$, the fitness is $W_{00} = 0$.\n\n2.  **Promoter mutant (1,0):** $i=1, j=0$. The maximal expression is scaled by $a=2$:\n    $$\n    E_{10} = (2 \\times 100)\\,\\frac{20^{2}}{30^{2} + 20^{2}} = 2 \\times E_{00} = \\frac{800}{13} \\approx 61.54\n    $$\n    Since $E_{10} < 70$, the fitness is $W_{10} = 0$.\n\n3.  **TF mutant (0,1):** $i=0, j=1$. The TF concentration is scaled by $b=1.5$, becoming $1.5 \\times 20 = 30$ nM.\n    $$\n    E_{01} = 100\\,\\frac{30^{2}}{30^{2} + 30^{2}} = 100\\,\\frac{900}{1800} = 100 \\times \\frac{1}{2} = 50\n    $$\n    Since $E_{01} < 70$, the fitness is $W_{01} = 0$.\n\n4.  **Double mutant (1,1):** $i=1, j=1$. Both parameters are scaled:\n    $$\n    E_{11} = (2 \\times 100)\\,\\frac{30^{2}}{30^{2} + 30^{2}} = 200 \\times \\frac{1}{2} = 100\n    $$\n    Since $E_{11} \\geq 70$, the fitness is $W_{11} = 1$.\n\nNow, we use these fitness values to compute the additive epistasis coefficient, $\\varepsilon$:\n$$\n\\varepsilon = W_{11} - W_{10} - W_{01} + W_{00}\n$$\nSubstituting the calculated fitness values:\n$$\n\\varepsilon = 1 - 0 - 0 + 0 = 1\n$$\nThe result shows strong positive epistasis. Although neither single mutation is sufficient to reach the fitness threshold, their combination successfully does, highlighting how nonlinear genotype-phenotype-fitness maps can create complex genetic interactions.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}