{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础计算开始，该计算应用了“简单异速标度法”。这种方法使用一个基于生理学原理（如克莱伯定律）的固定标度指数，来预测人体总清除率。通过这个练习，你将掌握从动物数据外推到人类的基本换算机制，并理解总清除率与单位体重清除率之间的重要区别。",
            "id": "4989692",
            "problem": "在转化医学中，人体药物清除率的跨物种预测依赖于有生物学基础的异速生长关系。考虑三种物种按公斤体重归一化的全身清除率 (CL)：小鼠为 $CL_{\\mathrm{mouse}} = 50$ $\\mathrm{mL\\,min^{-1}\\,kg^{-1}}$，大鼠为 $CL_{\\mathrm{rat}} = 30$ $\\mathrm{mL\\,min^{-1}\\,kg^{-1}}$，猴为 $CL_{\\mathrm{monkey}} = 8$ $\\mathrm{mL\\,min^{-1}\\,kg^{-1}}$。使用以下典型体重：$M_{\\mathrm{mouse}} = 0.025$ $\\mathrm{kg}$ (小鼠)，$M_{\\mathrm{rat}} = 0.25$ $\\mathrm{kg}$ (大鼠)，以及 $M_{\\mathrm{monkey}} = 3.5$ $\\mathrm{kg}$ (猴)，并假设人体体重 $M_{\\mathrm{human}} = 70$ $\\mathrm{kg}$。假设总清除率遵循与体重相关的幂律关系，且该关系与哺乳动物的基础代谢标度一致，因此总清除率的指数为 $0.75$。仅使用这些数据和假设，通过适当的对数线性估计方法从动物数据中首先获得一个跨物种比例常数，然后外推至人体，从而估算人体总清除率。在计算出人体总清除率后，简要检查推算得出的人体单位体重清除率是否与跨物种观察到的下降趋势一致。将最终的人体总清除率以 $\\mathrm{L\\,h^{-1}}$ 为单位表示，并将最终数值答案四舍五入至三位有效数字。",
            "solution": "用户希望我解决这个问题。我将执行用户的请求。\n### 问题验证\n\n#### 步骤1：提取已知条件\n问题陈述中提供的数据、变量和假设如下：\n-   按公斤体重归一化的全身清除率 (CL)：\n    -   $CL_{\\mathrm{mouse}} = 50$ $\\mathrm{mL\\,min^{-1}\\,kg^{-1}}$\n    -   $CL_{\\mathrm{rat}} = 30$ $\\mathrm{mL\\,min^{-1}\\,kg^{-1}}$\n    -   $CL_{\\mathrm{monkey}} = 8$ $\\mathrm{mL\\,min^{-1}\\,kg^{-1}}$\n-   典型体重：\n    -   $M_{\\mathrm{mouse}} = 0.025$ $\\mathrm{kg}$\n    -   $M_{\\mathrm{rat}} = 0.25$ $\\mathrm{kg}$\n    -   $M_{\\mathrm{monkey}} = 3.5$ $\\mathrm{kg}$\n    -   $M_{\\mathrm{human}} = 70$ $\\mathrm{kg}$\n-   假设：总清除率 ($CL_{total}$) 遵循与体重 ($M$) 相关的幂律关系。\n-   假设：总清除率的指数为 $0.75$。\n-   任务：估算人体总清除率 ($CL_{total, human}$)。\n-   方法：使用对数线性估计从动物数据中找到一个跨物种比例常数，然后外推至人体。\n-   计算后检查：验证预测的人体单位体重清除率与观察到的物种趋势的一致性。\n-   最终答案格式：将 $CL_{total, human}$ 以 $\\mathrm{L\\,h^{-1}}$ 表示，并四舍五入至三位有效数字。\n\n#### 步骤2：使用提取的已知条件进行验证\n对问题进行严格的验证检查。\n\n-   **科学依据**：该问题基于药代动力学中公认的异速生长标度原理，这是转化医学的基石。幂律关系 $Y = aM^b$ 是标准模型。使用源自克莱伯定律（关于基础代謝率）的指数 $b=0.75$ 来标度药物清除率等生理参数，是一种常见且科学合理的假设。所提供的物种质量和清除率数据是现实的。该问题在科学上是有效的。\n-   **适定性**：该问题是适定的。它提供了三个数据点来确定一个指定模型（$CL_{total} = aM^{0.75}$）中的单个参数（比例常数）。使用“对数线性估计”的指令指导了方法论，暗示了对对数转换后的数据进行拟合的过程。在此框架内存在唯一解。\n-   **客观性**：该问题使用精确、定量和无偏见的语言进行陈述。所有参数和假设都得到了明确定义。\n-   **完整性与一致性**：该问题是自洽的。它提供了所有必要的数据和模型假设。固定的指数（$0.75$）和三个数据点造成了一种情况，即必须对参数估计值求平均，这是一个标准程序，并不矛盾。\n-   **现实性与可行性**：给出的物种质量和清除率值在合理范围内。该任务是临床前药物开发中的一项标准计算。\n\n#### 步骤3：结论与行动\n该问题科学合理、适定、客观且完整。判定为**有效**。我将继续进行完整解答。\n\n### 解答\n\n在不同物种间，总全身清除率（$CL_{total}$）与体重（$M$）之间关系的基本原理是异速生长标度方程，这是一种幂律形式：\n$$CL_{total} = a \\cdot M^{b}$$\n其中，$a$ 是异速生长系数（一个比例常数），$b$ 是异速生长指数。\n\n问题陈述指数与哺乳动物基础代谢标度一致，因此我们已知 $b = 0.75$。因此模型为：\n$$CL_{total} = a \\cdot M^{0.75}$$\n所提供的清除率数据是按公斤体重归一化的。我们将此归一化清除率表示为 $CL_{norm}$。总清除率和归一化清除率之间的关系是：\n$$CL_{norm} = \\frac{CL_{total}}{M}$$\n将 $CL_{total}$ 的异速生长方程代入此定义，我们得到归一化清除率的标度关系：\n$$CL_{norm} = \\frac{a \\cdot M^{0.75}}{M^1} = a \\cdot M^{0.75 - 1} = a \\cdot M^{-0.25}$$\n为了使用“对数线性估计”来估计系数 $a$，我们通过对等式两边取自然对数来线性化这个幂律方程：\n$$\\ln(CL_{norm}) = \\ln(a \\cdot M^{-0.25})$$\n$$\\ln(CL_{norm}) = \\ln(a) - 0.25 \\ln(M)$$\n这个方程的形式为 $y = c + mx$，其中 $y = \\ln(CL_{norm})$，$x = \\ln(M)$，截距为 $c = \\ln(a)$，斜率为 $m = -0.25$。由于斜率是固定的，从三个动物数据点中找到截距 $\\ln(a)$ 的单一值的最合适方法是为每个物种计算 $\\ln(a)$，然后计算其平均值。\n\n我们可以重新排列线性化方程来求解 $\\ln(a)$：\n$$\\ln(a) = \\ln(CL_{norm}) + 0.25 \\ln(M)$$\n现在，我们为三个物种中的每一个计算这个值：\n\n1.  **小鼠**: $M_{\\mathrm{mouse}} = 0.025 \\mathrm{\\,kg}$, $CL_{norm, \\mathrm{mouse}} = 50 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$\n    $$\\ln(a_{\\mathrm{mouse}}) = \\ln(50) + 0.25 \\ln(0.025) \\approx 3.9120 + 0.25(-3.6889) \\approx 2.9898$$\n\n2.  **大鼠**: $M_{\\mathrm{rat}} = 0.25 \\mathrm{\\,kg}$, $CL_{norm, \\mathrm{rat}} = 30 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$\n    $$\\ln(a_{\\mathrm{rat}}) = \\ln(30) + 0.25 \\ln(0.25) \\approx 3.4012 + 0.25(-1.3863) \\approx 3.0546$$\n\n3.  **猴**: $M_{\\mathrm{monkey}} = 3.5 \\mathrm{\\,kg}$, $CL_{norm, \\mathrm{monkey}} = 8 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$\n    $$\\ln(a_{\\mathrm{monkey}}) = \\ln(8) + 0.25 \\ln(3.5) \\approx 2.0794 + 0.25(1.2528) \\approx 2.3926$$\n\n$\\ln(a)$ 的平均值是：\n$$\\overline{\\ln(a)} = \\frac{\\ln(a_{\\mathrm{mouse}}) + \\ln(a_{\\mathrm{rat}}) + \\ln(a_{\\mathrm{monkey}})}{3}$$\n$$\\overline{\\ln(a)} \\approx \\frac{2.9898 + 3.0546 + 2.3926}{3} = \\frac{8.4370}{3} \\approx 2.8123$$\n通过对此平均值取指数，可以找到跨物种比例常数 $a$。这等同于取各个 $a_i$ 值的几何平均值。\n$$a = \\exp(\\overline{\\ln(a)}) \\approx \\exp(2.8123) \\approx 16.648$$\n$a$ 的单位是这样的：当它乘以 $M^{0.75}$（单位为 $\\mathrm{kg}^{0.75}$）时，结果的单位是 $\\mathrm{mL\\,min^{-1}}$。因此，$a$ 的单位是 $\\mathrm{mL\\,min^{-1}\\,kg^{-0.75}}$。\n\n有了这个常数，我们现在可以使用 $M_{\\mathrm{human}} = 70 \\mathrm{\\,kg}$ 来预测人体总清除率：\n$$CL_{total, \\mathrm{human}} = a \\cdot (M_{\\mathrm{human}})^{0.75}$$\n$$CL_{total, \\mathrm{human}} \\approx 16.648 \\cdot (70)^{0.75} \\approx 16.648 \\cdot (24.228) \\approx 403.32 \\mathrm{\\,mL\\,min^{-1}}$$\n问题要求答案以升/小时（$\\mathrm{L\\,h^{-1}}$）为单位。我们进行单位换算：\n$$CL_{total, \\mathrm{human}} \\approx 403.32 \\frac{\\mathrm{mL}}{\\mathrm{min}} \\times \\frac{1 \\mathrm{\\,L}}{1000 \\mathrm{\\,mL}} \\times \\frac{60 \\mathrm{\\,min}}{1 \\mathrm{\\,h}}$$\n$$CL_{total, \\mathrm{human}} \\approx 403.32 \\times 0.06 \\mathrm{\\,L\\,h^{-1}} \\approx 24.199 \\mathrm{\\,L\\,h^{-1}}$$\n四舍五入到三位有效数字，估计的人体总清除率为 $24.2 \\mathrm{\\,L\\,h^{-1}}$。\n\n最后，我们执行要求的一致性检查。我们计算推算得出的人体单位体重清除率 $CL_{norm, \\mathrm{human}}$，并检查它是否遵循在动物物种中观察到的下降趋势。\n$$CL_{norm, \\mathrm{human}} = \\frac{CL_{total, \\mathrm{human}}}{M_{\\mathrm{human}}} \\approx \\frac{403.32 \\mathrm{\\,mL\\,min^{-1}}}{70 \\mathrm{\\,kg}} \\approx 5.76 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$$\n让我们将此与给定数据进行比较：\n-   $CL_{norm, \\mathrm{mouse}} = 50 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$\n-   $CL_{norm, \\mathrm{rat}} = 30 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$\n-   $CL_{norm, \\mathrm{monkey}} = 8 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$\n预测的人体值为 $5.76 \\mathrm{\\,mL\\,min^{-1}\\,kg^{-1}}$，小于猴子的值。归一化清除率序列（$50 > 30 > 8 > 5.76$）显示出随着体重的增加而持续下降。这是预期的结果，因为归一化清除率的标度指数是负的（$-0.25$）。此检查证实了结果的一致性。",
            "answer": "$$\\boxed{24.2}$$"
        },
        {
            "introduction": "在实践中，异速标度指数本身通常是未知的，需要从数据中估计。本练习将指导你完成一个核心的计算任务：通过对数-对数线性回归，根据多物种数据拟合异速标度模型，从而同时估计出标度系数 $a$ 和指数 $b$。掌握这种数据驱动的方法对于准确预测药物特异性的人体药代动力学参数至关重要。",
            "id": "4989779",
            "problem": "给定您一些物种间的全身清除率测量值及相关的体重数据，要求您根据以下转化原则，通过拟合一个跨物种的缩放关系来推断人体的总清除率。在药代动力学 (PK) 中，总清除率定义为 $CL = \\frac{\\text{消除速率}}{\\text{浓度}}$，其物理单位为体积/时间（此处为升/小时，$L/h$）。在哺乳动物物种中，许多转运和代谢过程已被充分证明遵循由资源分配网络产生的尺度不变模式，当一个变量对体重作图时，这通常表现为幂律关系。假设总清除率随体重在物种间单调平滑地变化，并且清除率与体重之间的乘性幂律关系提供了一个合理的一阶近似，那么清除率的对数对体重的对数作图时，应呈现线性趋势。因此，在对数空间中进行线性回归是一种合适且广泛使用的方法，用以估计一个可以外推至人类的缩放定律。\n\n任务：实现一个程序，对每个提供的测试用例数据集执行以下步骤：\n- 计算每个物种的体重 $M$ 和清除率 $CL$ 的自然对数（以 $e$ 为底）。\n- 通过普通最小二乘法 (OLS) 对数据对 $\\left(\\ln(M_i), \\ln(CL_i)\\right)$ 拟合一条直线，估计斜率 $\\hat{b}$ 和截距 $\\hat{c}$。\n- 转换回原始尺度，得到缩放系数 $\\hat{a} = e^{\\hat{c}}$ 和指数 $\\hat{b}$。\n- 使用在原始尺度上拟合的幂律模型，在指定的人体体重 $M_{human}$ 下预测人体清除率 $CL_{human}$。\n- 将每个预测的 $CL_{human}$ 以 $L/h$ 为单位表示，并四舍五入至 $3$ 位小数。\n\n使用以下测试用例数据集，每个数据集包含 $(M,CL)$ 对和一个用于预测的目标人体体重：\n- 测试用例 $1$（基线三物种拟合）：小鼠 $CL = 0.8$ $L/h$，$M = 0.02$ $kg$；大鼠 $CL = 1.2$ $L/h$，$M = 0.3$ $kg$；狗 $CL = 3.5$ $L/h$，$M = 10$ $kg$；在 $M_{human} = 70$ $kg$ 时进行预测。\n- 测试用例 $2$（边界双物种拟合）：小鼠 $CL = 0.8$ $L/h$，$M = 0.02$ $kg$；狗 $CL = 3.5$ $L/h$，$M = 10$ $kg$；在 $M_{human} = 70$ $kg$ 时进行预测。\n- 测试用例 $3$（扩展四物种拟合）：小鼠 $CL = 0.8$ $L/h$，$M = 0.02$ $kg$；大鼠 $CL = 1.2$ $L/h$，$M = 0.3$ $kg$；猴子 $CL = 2.6$ $L/h$，$M = 5$ $kg$；狗 $CL = 3.5$ $L/h$，$M = 10$ $kg$；在 $M_{human} = 70$ $kg$ 时进行预测。\n\n您的程序应生成单行输出，其中包含三个预测的人体清除率，单位为 $L/h$，四舍五入至 $3$ 位小数，并聚合为方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3]$，其中每个 $x_i$ 是一个四舍五入到 $3$ 位小数的浮点数。",
            "solution": "该问题要求实现一个异速生长缩放程序，以根据其他哺乳动物物种的清除率数据来预测人体的总清除率 ($CL_{human}$)。该程序基于药理学和生理学中一个公认的原则：许多生理参数，包括药物清除率，会根据幂律关系随体重 ($M$) 变化。\n\n该关系的基本模型是异速生长方程：\n$$\nCL = a M^b\n$$\n其中 $CL$ 表示总清除率（单位为 $L/h$），$M$ 是体重（单位为 $kg$），$a$ 是异速生长缩放系数， $b$ 是异速生长缩放指数。该方程描述了清除率和体重之间的非线性关系。\n\n为了便于参数估计，这个幂律模型通常通过对数变换进行线性化。对等式两边取自然对数（以 $e$ 为底）可得：\n$$\n\\ln(CL) = \\ln(a M^b) = \\ln(a) + b \\ln(M)\n$$\n这个变换后的方程形式为一条直线 $y = c + bx$，其中：\n- $y = \\ln(CL)$ 是因变量。\n- $x = \\ln(M)$ 是自变量。\n- $b$ 是直线的斜率，直接对应于异速生长指数。\n- $c = \\ln(a)$ 是y轴截距，即异速生长系数的对数。\n\n给定一组 $n$ 个物种间的数据点 $(M_i, CL_i)$，我们首先计算它们的自然对数，得到变换后的数据对 $(x_i, y_i) = (\\ln(M_i), \\ln(CL_i))$。接下来的任务是为这些变换后的数据点找到最佳拟合线。指定的方法是普通最小二乘法 (OLS) 回归。OLS通过最小化观测值 $y_i$ 与线性模型预测值 $\\hat{y}_i = \\hat{c} + \\hat{b}x_i$ 之间的平方差之和来估计参数 $\\hat{b}$ (斜率) 和 $\\hat{c}$ (截距)。\n\nOLS估计的解析解为：\n$$\n\\hat{b} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}\n$$\n$$\n\\hat{c} = \\bar{y} - \\hat{b}\\bar{x}\n$$\n其中 $\\bar{x}$ 是 $x_i$ 值的平均值，$\\bar{y}$ 是 $y_i$ 值的平均值。\n\n一旦通过线性回归确定了估计值 $\\hat{b}$ 和 $\\hat{c}$，就可以通过对截距取指数来恢复异速生长缩放系数 $\\hat{a}$：\n$$\n\\hat{a} = e^{\\hat{c}}\n$$\n完整的拟合幂律模型则为：\n$$\n\\widehat{CL} = \\hat{a} M^{\\hat{b}}\n$$\n为了预测人体清除率 $CL_{human}$，我们将指定的人体体重 $M_{human}$ 代入此模型：\n$$\nCL_{human} = \\hat{a} (M_{human})^{\\hat{b}}\n$$\n等效地，可以先在对数空间中进行预测，然后将结果转换回来：\n$$\n\\ln(CL_{human}) = \\hat{c} + \\hat{b} \\ln(M_{human})\n$$\n$$\nCL_{human} = e^{\\ln(CL_{human})}\n$$\n对于每个给定的测试用例，计算实现将遵循以下步骤：\n$1.$ 对于给定的一组物种数据 $(M_i, CL_i)$，创建两个数组，一个用于体重，一个用于清除率。\n$2.$ 对这两个数组按元素应用自然对数，得到 $x_i = \\ln(M_i)$ 和 $y_i = \\ln(CL_i)$。\n$3.$ 对 $(x, y)$ 数据对进行线性回归，以找到斜率 $\\hat{b}$ 和截距 $\\hat{c}$。一个数值库函数，例如阶数为 $1$ 的 `numpy.polyfit`，适合此目的。\n$4.$ 使用估计的参数 $\\hat{b}$ 和 $\\hat{c}$ 以及给定的人体体重 $M_{human}$，使用公式 $CL_{human} = e^{\\hat{c} + \\hat{b} \\ln(M_{human})}$ 计算预测的人体清除率 $CL_{human}$。\n$5.$ 按照要求，将最终计算出的 $CL_{human}$ 值四舍五入到 $3$ 位小数。\n对所有三个测试用例重复此过程，以生成最终的预测清除率列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Performs allometric scaling to predict human drug clearance from interspecies data.\n\n    For each test case, the function:\n    1. Takes species body mass (M) and total clearance (CL) data.\n    2. Log-transforms the data (ln(M), ln(CL)).\n    3. Fits a linear model ln(CL) = b*ln(M) + c using ordinary least squares (OLS).\n    4. Uses the fitted model to predict human clearance at a target human mass.\n    5. Collects and formats the results as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (masses, clearances, human_mass)\n    test_cases = [\n        # Test case 1 (baseline three-species fit)\n        (np.array([0.02, 0.3, 10]), np.array([0.8, 1.2, 3.5]), 70),\n        # Test case 2 (boundary with two-species fit)\n        (np.array([0.02, 10]), np.array([0.8, 3.5]), 70),\n        # Test case 3 (expanded four-species fit)\n        (np.array([0.02, 0.3, 5, 10]), np.array([0.8, 1.2, 2.6, 3.5]), 70),\n    ]\n\n    results = []\n    for case in test_cases:\n        masses, clearances, human_mass = case\n\n        # 1. Compute the natural logarithm of body mass M and clearance CL.\n        log_mass = np.log(masses)\n        log_clearance = np.log(clearances)\n\n        # 2. Fit a straight line using Ordinary Least Squares (OLS) via np.polyfit.\n        # np.polyfit(x, y, 1) returns [slope, intercept] for the best-fit line y = slope*x + intercept.\n        slope_b, intercept_c = np.polyfit(log_mass, log_clearance, 1)\n\n        # 3. Transform back to the original scale (not strictly needed for prediction,\n        # but demonstrates the principle).\n        # scaling_coeff_a = np.exp(intercept_c)\n        # scaling_exponent_b = slope_b\n\n        # 4. Predict the human clearance CL_human at M_human.\n        # This can be done in log-space first, then exponentiating.\n        # ln(CL_human) = c + b * ln(M_human)\n        log_human_mass = np.log(human_mass)\n        log_predicted_human_clearance = intercept_c + slope_b * log_human_mass\n        \n        # CL_human = exp(ln(CL_human))\n        predicted_human_clearance = np.exp(log_predicted_human_clearance)\n\n        # 5. Express the result rounded to 3 decimal places.\n        rounded_result = round(predicted_human_clearance, 3)\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个可靠的预测模型不仅在于其预测的准确性，还在于其稳健性。本高级练习引入了敏感性分析的概念，这是一个评估模型对特定数据点依赖程度的关键步骤。你将通过编程比较包含和排除最小物种（小鼠）数据时模型参数和预测结果的变化，从而学会批判性地评估预测的稳定性，并识别模型何时可能对单个数据源过度敏感。",
            "id": "4989745",
            "problem": "考虑转化医学中的跨物种药代动力学缩放，其中，药物清除率 (CL) 被建模为遵循跨物种体重的异速生长幂律。设 $CL$ 表示以 $\\mathrm{L/h}$ 为单位的清除率，$M$ 表示以 $\\mathrm{kg}$ 为单位的体重。经验观察支持幂律形式 $CL = a \\, M^{b}$，其中 $a$ 是比例系数，$b$ 是异速生长指数。其科学原理是，由于几何和能量约束，包括肝血流量和代谢能力在内的生理过程会随体重而缩放，而这些关系可以通过幂律关系来捕捉。\n\n从该幂律形式以及自然对数和普通最小二乘法 (OLS) 的定义出发，通过将模型转换为对数空间中的线性关系，推导一种从多物种数据中估计 $a$ 和 $b$ 的方法。使用此推导出的方法来：\n- 使用完整数据集估计指数 $b$ 和系数 $a$。\n- 排除最小的物种 (mouse) 后，重新估计指数 $b$ 和系数 $a$。\n- 使用两组拟合参数，在指定的人类体重 $M_{human}$ 下预测人类清除率 $CL_{human}$。\n- 通过计算指数的绝对变化量 $\\Delta b = |b_{\\text{all}} - b_{\\text{no\\_mouse}}|$ 和比率 $r = \\frac{CL_{human}^{\\text{no\\_mouse}}}{CL_{human}^{\\text{all}}}$ 来量化敏感性。\n\n您必须在对数转换后的数据上使用 OLS 进行计算，其中每个物种 $i$ 贡献一个数据对 $(M_i, CL_i)$（$M_i$ 单位为 $\\mathrm{kg}$，$CL_i$ 单位为 $\\mathrm{L/h}$），并且预测使用单位为 $\\mathrm{kg}$ 的 $M_{human}$。所有预测的清除率必须以 $\\mathrm{L/h}$ 为单位表示。所有浮点数输出必须四舍五入到 $6$ 位小数。\n\n对于每个测试用例，您将获得：\n- 一个物种记录列表 $(\\text{name}_i, M_i, CL_i)$；名为 \"mouse\" 的物种是最小的物种，在敏感性重新拟合中必须被排除。\n- 用于预测的人类体重 $M_{human}$（单位为 $\\mathrm{kg}$）。\n- 敏感性阈值 $\\tau_b$ 和 $\\tau_r$；定义一个布尔敏感性标志 $\\text{flag}$，如果 $|\\Delta b| > \\tau_b$ 或 $|r - 1| > \\tau_r$，则 $\\text{flag} = \\text{True}$，否则为 $\\text{False}$。\n\n您的程序必须处理以下测试套件并产生指定的输出：\n\n测试套件（每个物种记录为 $(\\text{name}, M, CL)$，其中 $M$ 的单位为 $\\mathrm{kg}$，$CL$ 的单位为 $\\mathrm{L/h}$）：\n1. 案例 A（异速生长关系对齐良好，中等噪声）：\n   - 物种：\n     - $($\"mouse\"$, M = 0.025, CL = 0.016)$\n     - $($\"rat\"$, M = 0.300, CL = 0.090)$\n     - $($\"rabbit\"$, M = 2.500, CL = 0.420)$\n     - $($\"monkey\"$, M = 5.000, CL = 0.650)$\n     - $($\"dog\"$, M = 12.000, CL = 1.250)$\n     - $($\"minipig\"$, M = 35.000, CL = 2.800)$\n   - 人类体重：$M_{human} = 70.000$\n   - 阈值：$\\tau_b = 0.100$, $\\tau_r = 0.200$\n\n2. 案例 B（mouse 为清除率较高的离群值）：\n   - 物种：\n     - $($\"mouse\"$, M = 0.025, CL = 0.060)$\n     - $($\"rat\"$, M = 0.300, CL = 0.090)$\n     - $($\"rabbit\"$, M = 2.500, CL = 0.420)$\n     - $($\"monkey\"$, M = 5.000, CL = 0.650)$\n     - $($\"dog\"$, M = 12.000, CL = 1.250)$\n     - $($\"minipig\"$, M = 35.000, CL = 2.800)$\n   - 人类体重：$M_{human} = 70.000$\n   - 阈值：$\\tau_b = 0.100$, $\\tau_r = 0.200$\n\n3. 案例 C（物种集有限，存在潜在不稳定性）：\n   - 物种：\n     - $($\"mouse\"$, M = 0.020, CL = 0.012)$\n     - $($\"rat\"$, M = 0.300, CL = 0.085)$\n     - $($\"monkey\"$, M = 3.500, CL = 0.580)$\n     - $($\"dog\"$, M = 10.000, CL = 1.100)$\n   - 人类体重：$M_{human} = 70.000$\n   - 阈值：$\\tau_b = 0.100$, $\\tau_r = 0.200$\n\n算法要求：\n- 将模型转换到对数空间，并使用 OLS 估计线性参数，然后映射回原始模型以获得 $a$ 和 $b$。\n- 使用完整数据集拟合 $(a_{\\text{all}}, b_{\\text{all}})$，并使用排除 mouse 的数据集拟合 $(a_{\\text{no\\_mouse}}, b_{\\text{no\\_mouse}})$。\n- 使用各自的参数集，在指定的 $M_{human}$ 下预测 $CL_{human}^{\\text{all}}$ 和 $CL_{human}^{\\text{no\\_mouse}}$。\n- 计算 $\\Delta b$ 和 $r$ 并评估敏感性标志。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对于每个测试用例，按顺序输出：\n- $|\\Delta b|$（浮点数，四舍五入到 $6$ 位小数），\n- $r$（浮点数，四舍五入到 $6$ 位小数），\n- $\\text{flag}$（布尔值）。\n按顺序聚合所有测试用例的结果，形成一个扁平列表。例如：$[x_1, y_1, z_1, x_2, y_2, z_2, x_3, y_3, z_3]$。",
            "solution": "该问题要求推导并应用一种将异速生长缩放模型拟合到药代动力学数据的方法，并随后进行敏感性分析。问题的核心在于将非线性的幂律关系转换为一个可以使用普通最小二乘法 (OLS) 求解的线性关系。\n\n药物清除率 ($CL$) 作为体重 ($M$) 函数的异速生长模型由以下幂律方程给出：\n$$\nCL = a \\, M^{b}\n$$\n其中 $CL$ 的单位是 $\\mathrm{L/h}$，$M$ 的单位是 $\\mathrm{kg}$，$a$ 是异速生长系数，$b$ 是异速生长指数。我们的目标是从一组经验数据点 $(M_i, CL_i)$ 中估计 $a$ 和 $b$。\n\n所述模型在其参数 $a$ 和 $b$ 上是非线性的。为了应用像 OLS 这样的线性回归技术，我们必须首先将模型线性化。这可以通过对等式两边取自然对数来实现：\n$$\n\\ln(CL) = \\ln(a \\, M^{b})\n$$\n利用对数的性质，特别是 $\\ln(xy) = \\ln(x) + \\ln(y)$ 和 $\\ln(x^p) = p \\ln(x)$，我们可以展开等式的右边：\n$$\n\\ln(CL) = \\ln(a) + \\ln(M^{b})\n$$\n$$\n\\ln(CL) = \\ln(a) + b \\ln(M)\n$$\n这个方程现在具有直线 $y = c + mx$ 的形式。通过定义新变量 $y = \\ln(CL)$、$x = \\ln(M)$、y轴截距 $c = \\ln(a)$ 和斜率 $m = b$，我们得到以下线性模型：\n$$\ny = b x + c\n$$\n给定一组 $n$ 个数据点 $(M_i, CL_i)$，我们可以将它们转换为一组对数变换后的点 $(x_i, y_i)$，其中 $x_i = \\ln(M_i)$，$y_i = \\ln(CL_i)$。然后，我们可以对这个变换后的数据集应用普通最小二乘法 (OLS) 回归，以找到最佳拟合的斜率 $b$ 和截距 $c$。\n\nOLS 方法旨在找到参数 $b$ 和 $c$，以最小化观测值 $y_i$ 与线性模型预测值 $\\hat{y}_i = b x_i + c$ 之间的平方差（残差）之和。OLS 估计量的标准闭式解为：\n$$\nb = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}\n$$\n$$\nc = \\bar{y} - b \\bar{x}\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是 $x_i$ 和 $y_i$ 值的算术平均值。\n\n一旦线性回归得到斜率和截距的估计值，我们就可以恢复原始异速生长模型的参数：\n- 异速生长指数 $b$ 就是对数-对数线性拟合的估计斜率。\n- 异速生长系数 $a$ 通过对截距 $c$ 取指数来恢复，因为 $c = \\ln(a)$，这意味着 $a = e^c$。\n\n完整的计算过程如下：\n1.  **数据准备**：对于给定的一组物种数据，准备两个数据集：\n    - 完整数据集（所有物种）。\n    - 简化的数据集，不包括名为 \"mouse\" 的物种。\n2.  **对数转换**：对于每个数据集，将体重 $M_i$ 和清除率 $CL_i$ 转换为它们的自然对数，$x_i = \\ln(M_i)$ 和 $y_i = \\ln(CL_i)$。\n3.  **OLS 拟合**：对每个对数转换后的数据集执行线性回归，以获得斜率和截距。对于完整数据集，这会得到 $b_{\\text{all}}$ 和 $c_{\\text{all}} = \\ln(a_{\\text{all}})$。对于简化的数据集，这会得到 $b_{\\text{no\\_mouse}}$ 和 $c_{\\text{no\\_mouse}} = \\ln(a_{\\text{no\\_mouse}})$。\n4.  **参数恢复**：为两种拟合计算原始幂律模型的系数：$a_{\\text{all}} = e^{c_{\\text{all}}}$ 和 $a_{\\text{no\\_mouse}} = e^{c_{\\text{no\\_mouse}}}$。\n5.  **预测**：使用指定的人类体重 $M_{human}$，用两种模型预测人类清除率：\n    $$\n    CL_{human}^{\\text{all}} = a_{\\text{all}} \\, (M_{human})^{b_{\\text{all}}}\n    $$\n    $$\n    CL_{human}^{\\text{no\\_mouse}} = a_{\\text{no\\_mouse}} \\, (M_{human})^{b_{\\text{no\\_mouse}}}\n    $$\n6.  **敏感性分析**：计算敏感性指标：\n    - 指数的绝对变化：$\\Delta b = |b_{\\text{all}} - b_{\\text{no\\_mouse}}|$。\n    - 人类预测的比率：$r = \\frac{CL_{human}^{\\text{no\\_mouse}}}{CL_{human}^{\\text{all}}}$。\n7.  **标志评估**：根据给定的阈值 $\\tau_b$ 和 $\\tau_r$ 确定一个布尔标志：\n    $$\n    \\text{flag} = (|\\Delta b| > \\tau_b) \\lor (|r - 1| > \\tau_r)\n    $$\n最终的浮点输出 $\\Delta b$ 和 $r$ 被四舍五入到 $6$ 位小数。对问题描述中提供的每个测试用例重复此整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the allometric scaling problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"species_data\": [\n                (\"mouse\", 0.025, 0.016),\n                (\"rat\", 0.300, 0.090),\n                (\"rabbit\", 2.500, 0.420),\n                (\"monkey\", 5.000, 0.650),\n                (\"dog\", 12.000, 1.250),\n                (\"minipig\", 35.000, 2.800)\n            ],\n            \"human_mass\": 70.000,\n            \"tau_b\": 0.100,\n            \"tau_r\": 0.200\n        },\n        {\n            \"name\": \"Case B\",\n            \"species_data\": [\n                (\"mouse\", 0.025, 0.060),\n                (\"rat\", 0.300, 0.090),\n                (\"rabbit\", 2.500, 0.420),\n                (\"monkey\", 5.000, 0.650),\n                (\"dog\", 12.000, 1.250),\n                (\"minipig\", 35.000, 2.800)\n            ],\n            \"human_mass\": 70.000,\n            \"tau_b\": 0.100,\n            \"tau_r\": 0.200\n        },\n        {\n            \"name\": \"Case C\",\n            \"species_data\": [\n                (\"mouse\", 0.020, 0.012),\n                (\"rat\", 0.300, 0.085),\n                (\"monkey\", 3.500, 0.580),\n                (\"dog\", 10.000, 1.100)\n            ],\n            \"human_mass\": 70.000,\n            \"tau_b\": 0.100,\n            \"tau_r\": 0.200\n        }\n    ]\n\n    results = []\n\n    def fit_and_predict(species_data, human_mass):\n        \"\"\"\n        Performs OLS fit on log-transformed data and predicts human clearance.\n\n        Args:\n            species_data (list): A list of tuples (name, mass, clearance).\n            human_mass (float): The human body mass for prediction.\n\n        Returns:\n            tuple: (b_exp, a_coeff, cl_human_pred)\n        \"\"\"\n        if not species_data:\n            return np.nan, np.nan, np.nan\n\n        masses = np.array([s[1] for s in species_data])\n        clearances = np.array([s[2] for s in species_data])\n\n        # Logarithmic transformation\n        log_mass = np.log(masses)\n        log_cl = np.log(clearances)\n\n        # OLS using numpy.polyfit for a degree 1 polynomial (linear regression)\n        # It returns [slope, intercept] which correspond to [b, ln(a)]\n        b_exp, log_a = np.polyfit(log_mass, log_cl, 1)\n\n        # Recover the original coefficient 'a'\n        a_coeff = np.exp(log_a)\n\n        # Predict human clearance\n        cl_human_pred = a_coeff * (human_mass ** b_exp)\n\n        return b_exp, a_coeff, cl_human_pred\n\n    for case in test_cases:\n        species_all = case[\"species_data\"]\n        species_no_mouse = [s for s in species_all if s[0] != \"mouse\"]\n        \n        m_human = case[\"human_mass\"]\n        tau_b = case[\"tau_b\"]\n        tau_r = case[\"tau_r\"]\n        \n        # Fit 1: All species\n        b_all, a_all, cl_human_all = fit_and_predict(species_all, m_human)\n        \n        # Fit 2: Excluding mouse\n        b_no_mouse, a_no_mouse, cl_human_no_mouse = fit_and_predict(species_no_mouse, m_human)\n        \n        # Calculate sensitivity metrics\n        delta_b = abs(b_all - b_no_mouse)\n        ratio_r = cl_human_no_mouse / cl_human_all\n        \n        # Evaluate sensitivity flag\n        flag = (delta_b > tau_b) or (abs(ratio_r - 1) > tau_r)\n        \n        # Append rounded results\n        results.append(round(delta_b, 6))\n        results.append(round(ratio_r, 6))\n        results.append(flag)\n\n    # Format the final output string\n    # The map(str, ...) converts all items, including booleans, to their string representations\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}