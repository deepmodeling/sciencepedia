{
    "hands_on_practices": [
        {
            "introduction": "质量调整生命年（QALY）是衡量健康产出的核心指标，它将生命的长度（生存时间）与质量（效用值）相结合。本练习将通过一个直接的计算任务，帮助你掌握计算未贴现和贴现 QALYs 的基本方法，这是所有成本-效用分析的出发点。理解贴现的概念对于正确评估随时间推移的健康收益至关重要。",
            "id": "5051454",
            "problem": "在一项以卫生经济学与成果研究（HEOR）为框架的转化医学成本效益分析中，考虑一种假设的先进疗法，其在最初的5年内产生恒定的健康相关生命质量效用$u_1=0.8$，在随后的3年内产生恒定的健康相关生命质量效用$u_2=0.6$。假设周期长度为一年，采用年末累积方式，且在所有8年中的生存概率均为$1$。使用质量调整生命年（QALY）的基本定义（该定义在生存条件下对健康效用随时间进行汇总），以及采用恒定年贴现率的时间偏好经济学原理，从第一性原理出发，推导出计算在年贴现率为$r=0.03$时总未贴现QALY和总贴现QALY所需的离散时间表达式。然后计算这两个量。将两个值均四舍五入至四位有效数字。将两个值均以质量调整生命年（QALYs）为单位表示。",
            "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   第一阶段的健康效用：$u_1 = 0.8$\n-   第一阶段的持续时间：$T_1 = 5$年\n-   第二阶段的健康效用：$u_2 = 0.6$\n-   第二阶段的持续时间：$T_2 = 3$年\n-   总时间范围：$T = T_1 + T_2 = 8$年\n-   周期长度：$1$年\n-   累积惯例：年末\n-   生存概率, $S(t)$：对于所有年份$t \\in [1, 8]$，$S(t) = 1$\n-   年贴现率：$r = 0.03$\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于卫生经济学与成果研究（HEOR）的既定原则。质量调整生命年（QALYs）、健康效用（取值在$0$和$1$之间）以及未来健康结果的贴现等概念是成本效益分析的基础。指定的$3\\%$贴现率是许多国际卫生技术评估指南中使用的标准值。\n-   **适定性**：该问题是适定的。它提供了所有必要的参数（$u_1, u_2, T_1, T_2, r$）和明确的指令（离散时间、年末累积），以计算未贴现和贴现QALY的唯一值。\n-   **客观性**：该问题以精确、客观的语言陈述，没有主观或模糊的术语。\n-   **结论**：该问题不违反任何指定的无效标准。它是一个科学合理、适定且客观的问题表述。\n\n### 步骤3：结论与行动\n问题有效。详细解答如下。\n\n### 求解推导\n质量调整生命年（QALY）是一种健康结果的度量，它将生命的数量（生存）与其质量（效用）相结合。对于周期长度为$L$的离散时间段$t$，在此期间累积的QALY由效用$u(t)$与该时期内生存时间的乘积给出。在进入时期$t$并存活通过该时期的生存概率为$S(t-1)$的情况下，时期$t$的期望QALY为$u(t) \\times L \\times S(t)$。问题陈述中指出，整个过程中的生存概率为$1$，意味着个体确定能活满全部$8$年。周期长度为$L=1$年。因此，在任何给定年份$t$累积的QALY就等于该年的效用值$u(t)$。\n\n**1. 总未贴现QALYs**\n\n总未贴现QALYs，记作$Q_{\\text{undiscounted}}$，是在整个时间范围内每年所经历的健康效用的简单算术和。该表达式通过对每个时间段的效用值求和得出。\n\n设$u(t)$为第$t$年的效用。总未贴现QALYs为：\n$$Q_{\\text{undiscounted}} = \\sum_{t=1}^{T} u(t)$$\n根据问题的具体情况，当$t=1, \\dots, 5$时，效用为$u_1 = 0.8$；当$t=6, \\dots, 8$时，效用为$u_2 = 0.6$。该表达式可写为：\n$$Q_{\\text{undiscounted}} = \\sum_{t=1}^{5} u_1 + \\sum_{t=6}^{8} u_2$$\n简化为：\n$$Q_{\\text{undiscounted}} = (5 \\times u_1) + (3 \\times u_2)$$\n代入给定值：\n$$Q_{\\text{undiscounted}} = (5 \\times 0.8) + (3 \\times 0.6) = 4.0 + 1.8 = 5.8$$\n按要求四舍五入至四位有效数字，结果为$5.800$ QALYs。\n\n**2. 总贴现QALYs**\n\n在经济评估中应用贴现是为了反映时间偏好，即未来获得的收益比现在获得的相同收益价值更低的原则。在恒定的年贴现率$r$下，第$t$年年底收到的收益的价值会通过一个贴现因子$\\frac{1}{(1+r)^t}$进行折减。问题指定了“年末累积”的惯例，意味着在第$t$年期间获得的效用，其价值被视为在第$t$年年底收到。\n\n总贴现QALYs，记作$Q_{\\text{discounted}}$，通过对每年的贴现效用求和来计算。表达式为：\n$$Q_{\\text{discounted}} = \\sum_{t=1}^{T} \\frac{u(t)}{(1+r)^t}$$\n根据两个效用期将此和式拆分：\n$$Q_{\\text{discounted}} = \\sum_{t=1}^{5} \\frac{u_1}{(1+r)^t} + \\sum_{t=6}^{8} \\frac{u_2}{(1+r)^t}$$\n我们可以将恒定的效用值提取出来：\n$$Q_{\\text{discounted}} = u_1 \\sum_{t=1}^{5} \\frac{1}{(1+r)^t} + u_2 \\sum_{t=6}^{8} \\frac{1}{(1+r)^t}$$\n这就是所需的离散时间表达式。现在我们用$r=0.03$，$u_1=0.8$和$u_2=0.6$来计算其值。\n\n$$Q_{\\text{discounted}} = 0.8 \\left( \\frac{1}{1.03^1} + \\frac{1}{1.03^2} + \\frac{1}{1.03^3} + \\frac{1}{1.03^4} + \\frac{1}{1.03^5} \\right) + 0.6 \\left( \\frac{1}{1.03^6} + \\frac{1}{1.03^7} + \\frac{1}{1.03^8} \\right)$$\n这些和是有限几何级数。和$\\sum_{k=1}^{n} a^k$可以用年金现值公式$\\frac{1-(1+r)^{-n}}{r}$来计算。\n对于第一部分：\n$$ \\sum_{t=1}^{5} \\frac{1}{(1.03)^t} = \\frac{1-(1.03)^{-5}}{0.03} \\approx \\frac{1-0.86260878}{0.03} \\approx \\frac{0.13739122}{0.03} \\approx 4.579707 $$\n对于第二部分：\n$$ \\sum_{t=6}^{8} \\frac{1}{(1.03)^t} = \\sum_{t=1}^{8} \\frac{1}{(1.03)^t} - \\sum_{t=1}^{5} \\frac{1}{(1.03)^t} $$\n$$ \\sum_{t=1}^{8} \\frac{1}{(1.03)^t} = \\frac{1-(1.03)^{-8}}{0.03} \\approx \\frac{1-0.78940923}{0.03} \\approx \\frac{0.21059077}{0.03} \\approx 7.019692 $$\n因此，\n$$ \\sum_{t=6}^{8} \\frac{1}{(1.03)^t} \\approx 7.019692 - 4.579707 \\approx 2.439985 $$\n现在，将这些和代回$Q_{\\text{discounted}}$的表达式中：\n$$Q_{\\text{discounted}} \\approx (0.8 \\times 4.579707) + (0.6 \\times 2.439985)$$\n$$Q_{\\text{discounted}} \\approx 3.6637656 + 1.463991$$\n$$Q_{\\text{discounted}} \\approx 5.1277566$$\n四舍五入至四位有效数字，得到$5.128$ QALYs。\n\n### 结果总结\n-   计算得出总未贴现QALYs为$5.800$。\n-   在$3\\%$的年贴现率下，计算得出总贴现QALYs为$5.128$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.800  5.128\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在卫生技术评估中，决策者常常需要在多种干预措施中做出选择。本练习将指导你完成一个标准的成本效果分析流程，包括如何根据成本和效果数据排除劣势策略（包括严格劣势和扩展劣势），并计算效率前沿上各策略间的增量成本效果比（ICER）。掌握这一系统性方法是进行和解读经济学评估的关键技能。",
            "id": "5051586",
            "problem": "一个医疗系统正在考虑对一项新近验证的转化干预措施采用四种备选实施策略，并要求根据卫生经济学与成果研究（HEOR）的原则进行成本效果分析。效果指标是质量调整生命年（QALYs），分析视角为单一支付方医疗保健系统。对于每种策略，给出了$5$年期限内每位患者的预期成本现值和预期每位患者的QALYs。所有成本和QALYs均已进行风险调整，并以各策略一致的贴现率进行贴现。这些策略是：\n\n- 策略$\\mathcal{A}$（现状）：成本 $C_{\\mathcal{A}} = 35{,}000$ 美元，QALYs $E_{\\mathcal{A}} = 3.20$。\n- 策略$\\mathcal{B}$（基于诊所的方案）：成本 $C_{\\mathcal{B}} = 42{,}000$ 美元，QALYs $E_{\\mathcal{B}} = 3.45$。\n- 策略$\\mathcal{C}$（数字辅助方案）：成本 $C_{\\mathcal{C}} = 46{,}000$ 美元，QALYs $E_{\\mathcal{C}} = 3.40$。\n- 策略$\\mathcal{D}$（组合方案）：成本 $C_{\\mathcal{D}} = 54{,}000$ 美元，QALYs $E_{\\mathcal{D}} = 3.60$。\n\n任务：\n1. 使用$E$将各策略按效果从低到高排序。\n2. 计算此顺序中相邻策略之间的增量成本和增量QALYs。\n3. 识别任何严格劣势或扩展劣势的策略，并将其移除，以构建成本效果前沿。\n4. 沿着非劣势前沿，计算相邻策略之间的增量成本效果比（ICERs）。\n\n仅报告前沿上的ICERs，单位为美元/QALY，四舍五入至四位有效数字，并按效果递增的顺序以单行矩阵形式提供。最终报告的矩阵中不要包含单位；但是，所有ICERs的计算和解释都必须以美元/QALY为单位。",
            "solution": "问题提供了四种备选医疗策略的成本和效果数据，并要求计算有效前沿上的增量成本效果比（ICERs）。分析将按以下步骤进行：首先按效果对策略进行排序，然后识别并排除任何劣势策略（包括严格劣势和扩展劣势），最后为剩余的非劣势策略序列计算ICERs。\n\n所提供的数据如下：\n- 策略$\\mathcal{A}$：成本 $C_{\\mathcal{A}} = \\$35{,}000$，效果 $E_{\\mathcal{A}} = 3.20$ QALYs。\n- 策略$\\mathcal{B}$：成本 $C_{\\mathcal{B}} = \\$42{,}000$，效果 $E_{\\mathcal{B}} = 3.45$ QALYs。\n- 策略$\\mathcal{C}$：成本 $C_{\\mathcal{C}} = \\$46{,}000$，效果 $E_{\\mathcal{C}} = 3.40$ QALYs。\n- 策略$\\mathcal{D}$：成本 $C_{\\mathcal{D}} = \\$54{,}000$，效果 $E_{\\mathcal{D}} = 3.60$ QALYs。\n\n**步骤1：按效果对策略排序**\n成本效果分析的第一步是根据健康产出指标（在本例中为质量调整生命年，QALYs）将备选策略从效果最差到效果最好进行排序。\n\n效果值如下：\n$E_{\\mathcal{A}} = 3.20$\n$E_{\\mathcal{C}} = 3.40$\n$E_{\\mathcal{B}} = 3.45$\n$E_{\\mathcal{D}} = 3.60$\n\n按效果（$E$）递增排序，得到序列：$\\mathcal{A}$、$\\mathcal{C}$、$\\mathcal{B}$、$\\mathcal{D}$。让我们按此顺序列出它们的成本和效果：\n1. 策略$\\mathcal{A}$：$C = \\$35{,}000$, $E = 3.20$\n2. 策略$\\mathcal{C}$：$C = \\$46{,}000$, $E = 3.40$\n3. 策略$\\mathcal{B}$：$C = \\$42{,}000$, $E = 3.45$\n4. 策略$\\mathcal{D}$：$C = \\$54{,}000$, $E = 3.60$\n\n**步骤2：识别并移除劣势策略**\n如果存在一个备选策略或策略组合能以更低的成本提供更好的产出，则该策略为劣势策略。我们首先检查严格劣势，然后检查扩展劣势。\n\n**严格劣势：**如果另一个策略效果更好且成本更低，则该策略为严格劣势策略。\n让我们检查排序后的列表。从策略$\\mathcal{C}$移至策略$\\mathcal{B}$时，我们观察到策略$\\mathcal{B}$比策略$\\mathcal{C}$效果更好（$E_{\\mathcal{B}} = 3.45 > E_{\\mathcal{C}} = 3.40$），并且成本也更低（$C_{\\mathcal{B}} = \\$42{,}000  C_{\\mathcal{C}} = \\$46{,}000$）。因此，策略$\\mathcal{C}$被策略$\\mathcal{B}$严格劣势。任何理性的决策者都会选择$\\mathcal{B}$而非$\\mathcal{C}$，因此将$\\mathcal{C}$从后续考虑中移除。\n\n移除严格劣势的策略$\\mathcal{C}$后，剩余的策略按效果排序如下：\n1. 策略$\\mathcal{A}$：$C = \\$35{,}000$, $E = 3.20$\n2. 策略$\\mathcal{B}$：$C = \\$42{,}000$, $E = 3.45$\n3. 策略$\\mathcal{D}$：$C = \\$54{,}000$, $E = 3.60$\n在这个简化后的集合中，成本和效果都单调递增。\n\n**扩展劣势：**如果从前一个非劣势策略转移到该策略的ICER大于从该策略转移到下一个非劣势策略的ICER，则该策略存在扩展劣势（或称间接劣势）。这意味着该策略位于成本效果平面上连接其相邻策略的线段之上，使其成为一个低效的选择。两个策略$X$和$Y$（其中$Y$的效果更好）之间的ICER定义为：\n$$ \\text{ICER}_{X \\to Y} = \\frac{C_Y - C_X}{E_Y - E_X} $$\n\n我们计算序列$\\mathcal{A} \\to \\mathcal{B} \\to \\mathcal{D}$中每对相邻策略的ICER。\n\n首先，从$\\mathcal{A}$到$\\mathcal{B}$的ICER：\n$$ \\text{ICER}_{\\mathcal{A} \\to \\mathcal{B}} = \\frac{C_{\\mathcal{B}} - C_{\\mathcal{A}}}{E_{\\mathcal{B}} - E_{\\mathcal{A}}} = \\frac{\\$42{,}000 - \\$35{,}000}{3.45 - 3.20} = \\frac{\\$7{,}000}{0.25} = \\$28{,}000 \\text{ /QALY} $$\n\n接着，从$\\mathcal{B}$到$\\mathcal{D}$的ICER：\n$$ \\text{ICER}_{\\mathcal{B} \\to \\mathcal{D}} = \\frac{C_{\\mathcal{D}} - C_{\\mathcal{B}}}{E_{\\mathcal{D}} - E_{\\mathcal{B}}} = \\frac{\\$54{,}000 - \\$42{,}000}{3.60 - 3.45} = \\frac{\\$12{,}000}{0.15} = \\$80{,}000 \\text{ /QALY} $$\n\n为了检查策略$\\mathcal{B}$是否存在扩展劣势，我们比较这两个ICER。如果ICER是递增的，则该策略不存在扩展劣势。\n我们得到$\\text{ICER}_{\\mathcal{A} \\to \\mathcal{B}} = \\$28{,}000$和$\\text{ICER}_{\\mathcal{B} \\to \\mathcal{D}} = \\$80{,}000$。由于$\\$28{,}000  \\$80{,}000$，ICER是递增的。这表明策略$\\mathcal{B}$不存在扩展劣势，并且位于凸成本效果前沿上。\n\n**步骤3：报告成本效果前沿上的ICERs**\n成本效果前沿由非劣势策略集合构成，即$\\mathcal{A}$、$\\mathcal{B}$和$\\mathcal{D}$。沿着该前沿的路径从现状（$\\mathcal{A}$）推进到$\\mathcal{B}$，然后再到$\\mathcal{D}$。前沿上的ICERs是这些相邻非劣势策略之间的增量比率。\n\n这些ICERs就是我们刚刚计算出的值：\n1. 选择策略$\\mathcal{B}$而非策略$\\mathcal{A}$的ICER是$28,000美元/QALY。\n2. 选择策略$\\mathcal{D}$而非策略$\\mathcal{B}$的ICER是$80,000美元/QALY。\n\n问题要求结果四舍五入到四位有效数字。$28{,}000$和$80{,}000$都是根据数据计算出的精确整数。写成$2.800 \\times 10^4$和$8.000 \\times 10^4$时，它们具有四位有效数字。因此，数值为$28000$和$80000$。\n\n最终答案应以单行矩阵的形式提供，其中包含按效果递增顺序排列的这些ICERs。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n28000  80000\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "确定性分析虽然有用，但忽略了现实世界中参数的不确定性。本练习将带你从确定性模型迈向概率敏感性分析（PSA），这是一种更稳健的现代评估方法。你将学习如何通过蒙特卡洛模拟，在给定成本和效果不确定性的情况下，估算一项干预措施在特定支付意愿阈值下具有成本效果的概率，这是构建成本效果可接受曲线（CEAC）的关键一步。",
            "id": "5051490",
            "problem": "一个转化医学团队必须根据卫生经济学和成果研究（HEOR）的原则，在不确定的情况下决定一项新干预措施是否具有成本效益。增量成本和增量效益的不确定性由随机变量表示。决策规则基于单位效益的支付意愿阈值下的净货币效益（NMB）。\n\n基本原理：\n- 不确定性下的决策理论：如果一项决策的预期效用超过其比较对象，则该决策更优。在成本效益分析中，通过货币转换可以使用净效益进行比较。\n- 定义：令 $\\Delta C$ 表示增量成本（新干预措施减去比较对象，以美元计量），$\\Delta E$ 表示增量效益（新干预措施减去比较对象，以质量调整生命年计量）。在每质量调整生命年 $\\lambda$ 美元的阈值下，净货币效益为 $NMB_{\\lambda} = \\lambda \\Delta E - \\Delta C$。\n- 成本效益决策：如果在阈值 $\\lambda$ 下 $NMB_{\\lambda}  0$，则该干预措施具有成本效益。\n- 概率敏感性分析（PSA）：在由 $\\Delta C$ 和 $\\Delta E$ 的概率分布表示的参数不确定性下，成本效益可接受性曲线（CEAC）在阈值 $\\lambda$ 处的值是根据 $(\\Delta C, \\Delta E)$ 的联合分布计算出的概率 $\\mathbb{P}(NMB_{\\lambda}  0)$。\n\n任务：\n- 针对每个测试用例，给定一组 $(\\Delta C, \\Delta E)$ 的参数分布，建模为二元正态分布。对于固定的支付意愿阈值 $\\lambda = \\$100{,}000$ 每质量调整生命年，使用蒙特卡洛模拟（概率敏感性分析）进行 $100{,}000$ 次独立抽样，以估计 $\\mathbb{P}(NMB_{\\lambda}  0)$，这代表了成本效益可接受性曲线（CEAC）上的一个点。\n- 单位和输出：$\\Delta C$ 的单位是美元，$\\Delta E$ 的单位是质量调整生命年，$\\lambda$ 的单位是美元/每质量调整生命年。您的程序必须以小数（而非百分比）形式输出估计的概率。将每个概率四舍五入到六位小数。\n- 随机性：使用固定的随机种子 $12345$ 以确保可复现性。\n\n数学说明：\n- 对于每个测试用例 $i$，$(\\Delta C_i, \\Delta E_i)$ 服从二元正态分布，其均值向量为 $\\boldsymbol{\\mu}_i = (\\mu_{C,i}, \\mu_{E,i})$，协方差矩阵为\n$$\n\\boldsymbol{\\Sigma}_i =\n\\begin{pmatrix}\n\\sigma_{C,i}^2  \\rho_i \\, \\sigma_{C,i} \\sigma_{E,i} \\\\\n\\rho_i \\, \\sigma_{C,i} \\sigma_{E,i}  \\sigma_{E,i}^2\n\\end{pmatrix}.\n$$\n- 对于每次抽样，计算 $NMB_{\\lambda} = \\lambda \\, \\Delta E - \\Delta C$ 并记录 $NMB_{\\lambda}  0$ 是否成立。\n- 通过 $NMB_{\\lambda}  0$ 的抽样在蒙特卡洛模拟中所占的比例来估计 $\\mathbb{P}(NMB_{\\lambda}  0)$。\n\n测试套件：\n提供以下五个测试用例，每个用例由 $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho)$ 指定：\n\n1. 均值增量效益和均值增量成本均为正，中度相关的理想情景：\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (20000, 10000, 0.30, 0.15, 0.30)$。\n2. 平均成本中性，成本和效益不确定，无相关性：\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (0, 15000, 0.10, 0.12, 0.00)$。\n3. 成本节约，效益增益小，轻微负相关：\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (-5000, 7000, 0.05, 0.05, -0.20)$。\n4. 负效益和正成本，呈劣势趋势，弱正相关：\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (15000, 5000, -0.02, 0.05, 0.10)$。\n5. 效益接近于零，中度正成本，零相关（边界行为由成本主导）：\n   - $(\\mu_C, \\sigma_C, \\mu_E, \\sigma_E, \\rho) = (5000, 3000, 0.00, 0.0001, 0.00)$。\n\n计算要求：\n- 对于每个测试用例，从指定的二元正态分布中进行 $100,000$ 次抽样，然后计算在 $\\lambda = \\$100,000$ 每质量调整生命年时的 $\\mathbb{P}(NMB_{\\lambda}  0)$ 的蒙特卡洛估计值。\n- 将最终输出表示为单行，其中包含一个用方括号括起来的浮点数逗号分隔列表，顺序与上述测试套件一致。例如：“[p1,p2,p3,p4,p5]”。\n- 每个浮点数必须四舍五入到六位小数，并且不得打印任何其他文本。\n\n解释要求：\n- 虽然您的程序仅输出在 $\\lambda = \\$100,000$ 每质量调整生命年时的概率，但其底层的计算过程估算的是成本效益可接受性曲线（CEAC）上的点。请将这些概率解释为在所建模的不确定性下，新干预措施在指定阈值下具有成本效益的可能性（在 $[0,1]$ 范围内）。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于卫生经济学评估的原则，问题设定良好，计算任务清晰，表述客观。所有必要的参数和条件都已提供，不存在内部矛盾、事实错误或含糊之处。\n\n核心任务是在给定支付意愿阈值 $\\lambda$ 及其增量成本和效益存在不确定性的情况下，估计一项新医疗干预措施具有成本效益的概率。这个概率对应于成本效益可接受性曲线（CEAC）上的一个点。该问题指定了使用蒙特卡洛模拟方法，在此背景下也称为概率敏感性分析（PSA）。\n\n成本效益的决策标准基于净货币效益（$NMB$），定义为：\n$$NMB_{\\lambda} = \\lambda \\Delta E - \\Delta C$$\n其中 $\\Delta C$ 是增量成本，$\\Delta E$ 是增量效益，$\\lambda$ 是支付意愿阈值。如果 $NMB_{\\lambda}  0$，则认为干预措施具有成本效益。\n\n问题指出，随机变量对 $(\\Delta C, \\Delta E)$ 服从二元正态分布，其特征由一个均值向量 $\\boldsymbol{\\mu} = (\\mu_C, \\mu_E)$ 和一个协方差矩阵 $\\boldsymbol{\\Sigma}$ 决定。对于每个测试用例 $i$，给定了具体的参数 $(\\mu_{C,i}, \\sigma_{C,i}, \\mu_{E,i}, \\sigma_{E,i}, \\rho_i)$，这些参数完全定义了该分布：\n$$\n\\boldsymbol{\\mu}_i = (\\mu_{C,i}, \\mu_{E,i})\n$$\n$$\n\\boldsymbol{\\Sigma}_i =\n\\begin{pmatrix}\n\\sigma_{C,i}^2  \\rho_i \\, \\sigma_{C,i} \\sigma_{E,i} \\\\\n\\rho_i \\, \\sigma_{C,i} \\sigma_{E,i}  \\sigma_{E,i}^2\n\\end{pmatrix}\n$$\n目标是对于固定的阈值 $\\lambda = \\$100,000$ 估计 $\\mathbb{P}(NMB_{\\lambda}  0)$。\n\n蒙特卡洛模拟过程如下：\n1.  **初始化**：使用固定的种子 $12345$ 初始化随机数生成器，以确保结果的可复现性。模拟的抽样次数设置为 $N = 100,000$。\n2.  **抽样**：对于每个测试用例，从指定的二元正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}_i, \\boldsymbol{\\Sigma}_i)$ 中抽取 $N = 100,000$ 个独立样本，记为 $(\\Delta C_j, \\Delta E_j)$，其中 $j = 1, \\dots, N$。\n3.  **计算 NMB**：对于 $N$ 个模拟对中的每一个，使用给定的阈值 $\\lambda = \\$100,000$ 计算 $NMB$：\n    $$NMB_j = \\lambda \\Delta E_j - \\Delta C_j$$\n4.  **概率估计**：概率 $\\mathbb{P}(NMB_{\\lambda}  0)$ 通过 $NMB$ 为正的模拟样本所占的比例来估计。计算公式为：\n    $$\\hat{P} = \\frac{1}{N} \\sum_{j=1}^{N} \\mathbb{I}(NMB_j  0)$$\n    其中 $\\mathbb{I}(\\cdot)$ 是指示函数，当其参数为真时等于 $1$，否则为 $0$。这在计算上等同于计算 $NMB$ 正值的数量，然后除以总抽样次数 $N$。\n5.  **输出格式化**：每个测试用例的最终估计概率四舍五入到六位小数。\n\n该程序将对提供的五个测试用例中的每一个执行。实现将利用向量化来提高效率，方法是一次性生成所有 $100,000$ 个样本并执行数组级计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the probability of cost-effectiveness for a new intervention\n    using Monte Carlo simulation (Probabilistic Sensitivity Analysis).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu_C, sigma_C, mu_E, sigma_E, rho)\n    test_cases = [\n        (20000, 10000, 0.30, 0.15, 0.30),\n        (0, 15000, 0.10, 0.12, 0.00),\n        (-5000, 7000, 0.05, 0.05, -0.20),\n        (15000, 5000, -0.02, 0.05, 0.10),\n        (5000, 3000, 0.00, 0.0001, 0.00),\n    ]\n\n    # Constants from the problem statement\n    lambda_val = 100000  # Willingness-to-pay threshold\n    num_draws = 100000   # Number of Monte Carlo draws\n    seed = 12345         # Fixed random seed for reproducibility\n\n    # Initialize the random number generator\n    rng = np.random.default_rng(seed)\n\n    results = []\n    for case in test_cases:\n        mu_C, sigma_C, mu_E, sigma_E, rho = case\n\n        # Construct the mean vector and covariance matrix\n        mean_vector = np.array([mu_C, mu_E])\n        \n        # Covariance between C and E\n        cov_C_E = rho * sigma_C * sigma_E\n        \n        # Covariance matrix\n        cov_matrix = np.array([\n            [sigma_C**2, cov_C_E],\n            [cov_C_E, sigma_E**2]\n        ])\n\n        # Generate N draws from the bivariate normal distribution\n        samples = rng.multivariate_normal(mean_vector, cov_matrix, size=num_draws)\n        \n        # Extract incremental cost and effectiveness samples\n        delta_C_samples = samples[:, 0]\n        delta_E_samples = samples[:, 1]\n\n        # Calculate Net Monetary Benefit (NMB) for each draw\n        nmb_samples = lambda_val * delta_E_samples - delta_C_samples\n\n        # Calculate the proportion of draws where NMB  0\n        probability = np.mean(nmb_samples  0)\n\n        # Round the result to six decimal places\n        rounded_prob = round(probability, 6)\n        results.append(rounded_prob)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}