{
    "hands_on_practices": [
        {
            "introduction": "The clinical effect of a genetic variant on a drug target often begins at the molecular level with an altered binding affinity. This exercise bridges fundamental biophysical chemistry with pharmacology by asking you to quantify this change. By applying the relationship between the standard Gibbs free energy of binding ($\\Delta G^{\\circ}$) and the equilibrium dissociation constant ($K_D$), you will calculate how a specific mutation in the EGFR protein impacts inhibitor binding, a foundational skill for mechanism-based drug development .",
            "id": "5042183",
            "problem": "A translational pharmacogenomics study investigates how the leucine-to-arginine substitution at position $858$ in Epidermal Growth Factor Receptor (EGFR) (L858R) affects the binding of a clinical small-molecule inhibitor. Under identical buffer conditions at the standard state of $1 \\ \\mathrm{M}$ and at physiological temperature $T = 310 \\ \\mathrm{K}$, isothermal titration calorimetry yields the following standard binding Gibbs free energies for the inhibitor: for wild-type EGFR, $\\Delta G^{\\circ}_{\\mathrm{WT}} = -35.2 \\ \\mathrm{kJ \\ mol^{-1}}$, and for EGFR-L858R, $\\Delta G^{\\circ}_{\\mathrm{L858R}} = -41.3 \\ \\mathrm{kJ \\ mol^{-1}}$. Using the statistical thermodynamic relation between standard Gibbs free energy and the equilibrium association constant, together with the definition of the equilibrium dissociation constant, derive an expression for the fold-change in the equilibrium dissociation constant, $K_{D,\\mathrm{L858R}} / K_{D,\\mathrm{WT}}$, in terms of the difference in standard Gibbs free energy of binding, $\\Delta \\Delta G^{\\circ} = \\Delta G^{\\circ}_{\\mathrm{L858R}} - \\Delta G^{\\circ}_{\\mathrm{WT}}$. Then compute $\\Delta \\Delta G^{\\circ}$ and the fold-change $K_{D,\\mathrm{L858R}} / K_{D,\\mathrm{WT}}$. Use the molar gas constant $R = 8.314 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$. Report $\\Delta \\Delta G^{\\circ}$ in $\\mathrm{kJ \\ mol^{-1}}$ and report the fold-change as a pure decimal factor. Round each to three significant figures.",
            "solution": "The problem is found to be valid as it is scientifically grounded in the principles of chemical thermodynamics, well-posed with all necessary information provided, and objective in its language.\n\nThe first step is to derive the relationship between the fold-change in the equilibrium dissociation constant ($K_D$) and the change in the standard Gibbs free energy of binding ($\\Delta \\Delta G^{\\circ}$).\n\nThe fundamental relationship in statistical thermodynamics connecting the standard Gibbs free energy of a reaction, $\\Delta G^{\\circ}$, and its equilibrium constant, $K_{eq}$, is given by:\n$$\n\\Delta G^{\\circ} = -RT \\ln K_{eq}\n$$\nwhere $R$ is the molar gas constant and $T$ is the absolute temperature.\n\nFor a bimolecular binding event, such as an inhibitor binding to an enzyme, the reaction is:\n$$\n\\text{Enzyme} + \\text{Inhibitor} \\rightleftharpoons \\text{Enzyme-Inhibitor Complex}\n$$\nThe equilibrium constant for this association reaction is the association constant, $K_A$. Thus, the standard Gibbs free energy of binding is related to $K_A$ by:\n$$\n\\Delta G^{\\circ} = -RT \\ln K_A\n$$\nThe equilibrium dissociation constant, $K_D$, is the reciprocal of the association constant, $K_A$:\n$$\nK_D = \\frac{1}{K_A}\n$$\nSubstituting $K_A = 1/K_D$ into the Gibbs free energy equation yields:\n$$\n\\Delta G^{\\circ} = -RT \\ln \\left(\\frac{1}{K_D}\\right) = -RT (-\\ln K_D) = RT \\ln K_D\n$$\nThis equation applies to both the wild-type (WT) EGFR and the mutant (L858R) EGFR. For each case, we can write:\n$$\n\\Delta G^{\\circ}_{\\mathrm{WT}} = RT \\ln K_{D, \\mathrm{WT}}\n$$\n$$\n\\Delta G^{\\circ}_{\\mathrm{L858R}} = RT \\ln K_{D, \\mathrm{L858R}}\n$$\nThe problem defines the difference in the standard Gibbs free energy of binding as $\\Delta \\Delta G^{\\circ} = \\Delta G^{\\circ}_{\\mathrm{L858R}} - \\Delta G^{\\circ}_{\\mathrm{WT}}$. We can substitute the expressions above into this definition:\n$$\n\\Delta \\Delta G^{\\circ} = (RT \\ln K_{D, \\mathrm{L858R}}) - (RT \\ln K_{D, \\mathrm{WT}})\n$$\nFactoring out the term $RT$ and using the logarithmic identity $\\ln a - \\ln b = \\ln(a/b)$, we get:\n$$\n\\Delta \\Delta G^{\\circ} = RT (\\ln K_{D, \\mathrm{L858R}} - \\ln K_{D, \\mathrm{WT}}) = RT \\ln\\left(\\frac{K_{D, \\mathrm{L858R}}}{K_{D, \\mathrm{WT}}}\\right)\n$$\nTo derive the expression for the fold-change in the dissociation constant, $K_{D,\\mathrm{L858R}} / K_{D,\\mathrm{WT}}$, we rearrange the equation:\n$$\n\\frac{\\Delta \\Delta G^{\\circ}}{RT} = \\ln\\left(\\frac{K_{D, \\mathrm{L858R}}}{K_{D, \\mathrm{WT}}}\\right)\n$$\nExponentiating both sides gives the desired expression:\n$$\n\\frac{K_{D, \\mathrm{L858R}}}{K_{D, \\mathrm{WT}}} = \\exp\\left(\\frac{\\Delta \\Delta G^{\\circ}}{RT}\\right)\n$$\nThis completes the derivation.\n\nThe second step is to compute the numerical values for $\\Delta \\Delta G^{\\circ}$ and the fold-change.\nThe given values are:\n$\\Delta G^{\\circ}_{\\mathrm{WT}} = -35.2 \\ \\mathrm{kJ \\ mol^{-1}}$\n$\\Delta G^{\\circ}_{\\mathrm{L858R}} = -41.3 \\ \\mathrm{kJ \\ mol^{-1}}$\n$T = 310 \\ \\mathrm{K}$\n$R = 8.314 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$\n\nFirst, we calculate $\\Delta \\Delta G^{\\circ}$:\n$$\n\\Delta \\Delta G^{\\circ} = \\Delta G^{\\circ}_{\\mathrm{L858R}} - \\Delta G^{\\circ}_{\\mathrm{WT}} = -41.3 \\ \\mathrm{kJ \\ mol^{-1}} - (-35.2 \\ \\mathrm{kJ \\ mol^{-1}})\n$$\n$$\n\\Delta \\Delta G^{\\circ} = -41.3 + 35.2 \\ \\mathrm{kJ \\ mol^{-1}} = -6.1 \\ \\mathrm{kJ \\ mol^{-1}}\n$$\nThe problem requires this value to be reported to three significant figures, so we write:\n$$\n\\Delta \\Delta G^{\\circ} = -6.10 \\ \\mathrm{kJ \\ mol^{-1}}\n$$\nNext, we calculate the fold-change in $K_D$. We must ensure consistent units for energy. We convert $\\Delta \\Delta G^{\\circ}$ from $\\mathrm{kJ \\ mol^{-1}}$ to $\\mathrm{J \\ mol^{-1}}$:\n$$\n\\Delta \\Delta G^{\\circ} = -6.10 \\ \\mathrm{kJ \\ mol^{-1}} = -6.10 \\times 10^3 \\ \\mathrm{J \\ mol^{-1}}\n$$\nNow we can compute the argument of the exponential:\n$$\n\\frac{\\Delta \\Delta G^{\\circ}}{RT} = \\frac{-6.10 \\times 10^3 \\ \\mathrm{J \\ mol^{-1}}}{(8.314 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}) \\times (310 \\ \\mathrm{K})} = \\frac{-6100}{2577.34} \\approx -2.36670\n$$\nThe fold-change is the exponential of this value:\n$$\n\\frac{K_{D, \\mathrm{L858R}}}{K_{D, \\mathrm{WT}}} = \\exp(-2.36670) \\approx 0.09378\n$$\nRounding this result to three significant figures gives:\n$$\n\\frac{K_{D, \\mathrm{L858R}}}{K_{D, \\mathrm{WT}}} \\approx 0.0938\n$$\nThe negative value of $\\Delta \\Delta G^{\\circ}$ indicates that the mutation makes binding more favorable (energetically stabilizing), which is consistent with a decrease in the dissociation constant ($K_{D,\\mathrm{L858R}}  K_{D,\\mathrm{WT}}$), signifying stronger binding. This aligns with the known mechanism of sensitizing EGFR mutations.\n\nThe two computed values, rounded to three significant figures as required, are $\\Delta \\Delta G^{\\circ} = -6.10 \\ \\mathrm{kJ \\ mol^{-1}}$ and the fold-change is $0.0938$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -6.10  0.0938 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from a single molecular interaction to a holistic clinical prediction, this practice immerses you in the application of a pharmacogenomic dosing algorithm. Real-world drug response is multifactorial, and models like the one presented for warfarin integrate genetic information ($VKORC1$, $CYP2C9$) with clinical covariates to achieve dose personalization. In this problem, you will use a validated regression model to synthesize patient-specific data into a precise dose prediction, a core task in translational medicine .",
            "id": "5042200",
            "problem": "In translational medicine, dose individualization of a coumarin anticoagulant that targets Vitamin K epoxide reductase complex subunit 1 (VKORC1) can be guided by pharmacogenomic and clinical covariates. Consider a generalized linear model (GLM) with a normal error on the natural logarithm of weekly dose, where the linear predictor for the natural logarithm of dose in milligrams per week, denoted by $\\ln(D)$, is constructed from patient covariates. The model uses additive allele coding for VKORC1 $-1639$ G$$A and Cytochrome P450 $2$C$9$ (CYP2C9) reduced-function alleles, with an interaction term capturing gene-gene synergy.\n\nLet the linear predictor be given by\n$$\n\\mu \\equiv \\beta_{0} + \\beta_{\\mathrm{BSA}} \\cdot \\mathrm{BSA} + \\beta_{\\mathrm{age}} \\cdot \\mathrm{age} + \\beta_{\\mathrm{VKORC1}} \\cdot n_{A} + \\beta_{\\mathrm{CYP2C9}} \\cdot n_{\\mathrm{var}} + \\beta_{\\mathrm{amio}} \\cdot I_{\\mathrm{amio}} + \\beta_{\\mathrm{smoke}} \\cdot I_{\\mathrm{smoke}} + \\beta_{\\mathrm{int}} \\cdot \\left(n_{A} \\cdot n_{\\mathrm{var}}\\right),\n$$\nwhere $\\mathrm{BSA}$ is body surface area in $\\mathrm{m}^{2}$, $\\mathrm{age}$ is in years, $n_{A}$ is the count of VKORC1 $-1639$ A alleles ($0$, $1$, or $2$), $n_{\\mathrm{var}}$ is the count of CYP2C9 reduced-function alleles (e.g., $*$2 or $*$3; $0$, $1$, or $2$), $I_{\\mathrm{amio}}$ is an indicator for concurrent amiodarone use ($1$ if yes, $0$ if no), and $I_{\\mathrm{smoke}}$ is an indicator for current smoking ($1$ if yes, $0$ if no). The residual on the $\\ln$-scale is homoscedastic and normally distributed with variance $\\sigma^{2}$.\n\nAssume the following regression coefficients and residual variance:\n- $\\beta_{0} = 2.45$\n- $\\beta_{\\mathrm{BSA}} = 0.90$\n- $\\beta_{\\mathrm{age}} = -0.012$\n- $\\beta_{\\mathrm{VKORC1}} = -0.55$\n- $\\beta_{\\mathrm{CYP2C9}} = -0.33$\n- $\\beta_{\\mathrm{amio}} = -0.20$\n- $\\beta_{\\mathrm{smoke}} = 0.10$\n- $\\beta_{\\mathrm{int}} = -0.08$\n- $\\sigma^{2} = 0.20$\n\nA patient presents with the following covariates:\n- $\\mathrm{BSA} = 1.95$ $\\mathrm{m}^{2}$\n- $\\mathrm{age} = 68$ years\n- VKORC1 genotype $-1639$ A/G, so $n_{A} = 1$\n- CYP2C9 genotype $*1/*3$, so $n_{\\mathrm{var}} = 1$\n- Concurrent amiodarone: yes, so $I_{\\mathrm{amio}} = 1$\n- Current smoker: no, so $I_{\\mathrm{smoke}} = 0$\n\nAssuming the log-dose is distributed as $\\ln(D) \\sim \\mathcal{N}(\\mu, \\sigma^{2})$, compute the predicted mean weekly dose $D$ by appropriately back-transforming to the original scale with the log-normal expectation correction. Round your final numerical answer to $4$ significant figures and express it in $\\mathrm{mg/week}$.",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It represents a standard application of a generalized linear model in pharmacogenomics, a core task in translational medicine. The problem is therefore valid.\n\nThe problem states that the natural logarithm of the weekly dose, $\\ln(D)$, follows a normal distribution, which can be written as $\\ln(D) \\sim \\mathcal{N}(\\mu, \\sigma^{2})$. The variable $D$ therefore follows a log-normal distribution. The mean of the log-dose, $\\mu$, is given by a linear predictor model.\n\nThe first step is to calculate the value of the linear predictor, $\\mu$, for the specific patient. The model is given as:\n$$\n\\mu = \\beta_{0} + \\beta_{\\mathrm{BSA}} \\cdot \\mathrm{BSA} + \\beta_{\\mathrm{age}} \\cdot \\mathrm{age} + \\beta_{\\mathrm{VKORC1}} \\cdot n_{A} + \\beta_{\\mathrm{CYP2C9}} \\cdot n_{\\mathrm{var}} + \\beta_{\\mathrm{amio}} \\cdot I_{\\mathrm{amio}} + \\beta_{\\mathrm{smoke}} \\cdot I_{\\mathrm{smoke}} + \\beta_{\\mathrm{int}} \\cdot \\left(n_{A} \\cdot n_{\\mathrm{var}}\\right)\n$$\nWe substitute the given regression coefficients and patient covariates into this equation:\n- $\\beta_{0} = 2.45$\n- $\\beta_{\\mathrm{BSA}} = 0.90$ and $\\mathrm{BSA} = 1.95$\n- $\\beta_{\\mathrm{age}} = -0.012$ and $\\mathrm{age} = 68$\n- $\\beta_{\\mathrm{VKORC1}} = -0.55$ and $n_{A} = 1$\n- $\\beta_{\\mathrm{CYP2C9}} = -0.33$ and $n_{\\mathrm{var}} = 1$\n- $\\beta_{\\mathrm{amio}} = -0.20$ and $I_{\\mathrm{amio}} = 1$\n- $\\beta_{\\mathrm{smoke}} = 0.10$ and $I_{\\mathrm{smoke}} = 0$\n- $\\beta_{\\mathrm{int}} = -0.08$\n\nThe substitution yields:\n$$\n\\mu = 2.45 + (0.90)(1.95) + (-0.012)(68) + (-0.55)(1) + (-0.33)(1) + (-0.20)(1) + (0.10)(0) + (-0.08)(1 \\cdot 1)\n$$\nWe evaluate each term:\n$$\n\\mu = 2.45 + 1.755 - 0.816 - 0.55 - 0.33 - 0.20 + 0 - 0.08\n$$\nSumming these values gives the final value for $\\mu$:\n$$\n\\mu = (2.45 + 1.755) - (0.816 + 0.55 + 0.33 + 0.20 + 0.08)\n$$\n$$\n\\mu = 4.205 - 1.976\n$$\n$$\n\\mu = 2.229\n$$\nThis value, $\\mu = 2.229$, is the expected value of the natural logarithm of the dose. The problem asks for the predicted mean weekly dose, $D$, not $\\ln(D)$. This requires back-transforming from the logarithmic scale to the original scale.\n\nBecause $D$ follows a log-normal distribution, its expected value, $E[D]$, is not simply $\\exp(\\mu)$. The correct formula for the mean of a log-normally distributed variable $D$, where $\\ln(D) \\sim \\mathcal{N}(\\mu, \\sigma^{2})$, is:\n$$\nE[D] = \\exp\\left(\\mu + \\frac{\\sigma^{2}}{2}\\right)\n$$\nThis is the \"log-normal expectation correction\" specified in the problem statement.\n\nWe are given the residual variance on the $\\ln$-scale as $\\sigma^{2} = 0.20$. We can now compute the expected dose:\n$$\nE[D] = \\exp\\left(2.229 + \\frac{0.20}{2}\\right)\n$$\n$$\nE[D] = \\exp(2.229 + 0.10)\n$$\n$$\nE[D] = \\exp(2.329)\n$$\nCalculating the numerical value:\n$$\nE[D] \\approx 10.2674805...\n$$\nThe problem requires the final answer to be rounded to $4$ significant figures. The first four significant figures are $1$, $0$, $2$, and $6$. The fifth digit is $7$, so we round the fourth digit up.\n$$\nE[D] \\approx 10.27\n$$\nThe predicted mean weekly dose is $10.27$ $\\mathrm{mg/week}$.",
            "answer": "$$\\boxed{10.27}$$"
        },
        {
            "introduction": "The parameters that populate pharmacogenomic models, such as the $EC_{50}$ values used to describe drug potency, are derived from rigorous experimental data analysis. This exercise completes our journey from theory to practice by challenging you to perform this critical step. You will fit the classical saturable Emax model to dose-response data to estimate genotype-specific pharmacodynamic parameters, a fundamental data science skill in quantitative pharmacology .",
            "id": "5042251",
            "problem": "You are given paired measurements of heart rate before and after dosing with a beta-adrenergic receptor antagonist (beta-blocker) in subjects stratified by genotype. Assume the effect of the drug on heart rate reduction adheres to receptor-binding driven pharmacodynamics grounded in the Law of Mass Action and receptor occupancy, leading to a saturable relationship between dose and effect. Each genotype is expected to have its own maximum achievable effect and potency, represented by two parameters: the maximum heart rate reduction $E_{\\max}$ (in beats per minute) and the dose achieving half the maximum effect $EC_{50}$ (in milligrams). The effect is defined as the change from baseline heart rate ($\\Delta HR = HR_{\\text{baseline}} - HR_{\\text{post}}$), measured in beats per minute. You must estimate $E_{\\max}$ and $EC_{50}$ for each genotype by fitting a mechanistically derived, saturable dose-effect model to the observed $\\Delta HR$ across doses. The fitting must be done using non-linear least squares with bound constraints that enforce pharmacological plausibility. All dose values must be treated in milligrams, all heart rate values in beats per minute, and angles are not involved in this task. The final program must produce the estimates rounded to two decimal places, with $E_{\\max}$ reported in beats per minute and $EC_{50}$ in milligrams.\n\nUse the following test suite. Each test case consists of two genotypes, labeled Genotype A and Genotype B. For each genotype, you are provided a dose vector (in milligrams), a baseline heart rate vector (in beats per minute), and a post-dose heart rate vector (in beats per minute). Compute $\\Delta HR$ as $HR_{\\text{baseline}} - HR_{\\text{post}}$ at each observation and fit the mechanistically justified saturable dose-effect model to estimate genotype-specific $E_{\\max}$ and $EC_{50}$. The model should be fitted separately for each genotype. Constrain the parameters to $E_{\\max} \\in [0, 100]$ (in beats per minute) and $EC_{50} \\in [10^{-3}, 200]$ (in milligrams).\n\nTest Case $1$ (moderate doses with clear genotype effect separation):\n- Genotype A:\n  - Dose (mg): $[0, 2, 2, 5, 5, 10, 10, 25, 25]$\n  - Baseline HR (bpm): $[80, 82, 78, 81, 79, 83, 77, 84, 80]$\n  - Post-dose HR (bpm): $[80, 73.729, 69.329, 65.8, 64.5, 63.0, 57.4, 58.7, 55.2]$\n- Genotype B:\n  - Dose (mg): $[0, 2, 2, 5, 5, 10, 10, 25, 25]$\n  - Baseline HR (bpm): $[78, 80, 82, 79, 83, 84, 76, 85, 81]$\n  - Post-dose HR (bpm): $[78, 77.747, 79.447, 74.3, 77.9, 76.2, 68.0, 72.1, 69.0]$\n\nTest Case $2$ (high-dose saturation regime with similar $E_{\\max}$ but different $EC_{50}$):\n- Genotype A:\n  - Dose (mg): $[0, 20, 20, 40, 40, 80, 80]$\n  - Baseline HR (bpm): $[88, 90, 86, 87, 89, 90, 85]$\n  - Post-dose HR (bpm): $[88, 59.765, 55.465, 54.742, 55.942, 56.266, 51.366]$\n- Genotype B:\n  - Dose (mg): $[0, 20, 20, 40, 40, 80, 80]$\n  - Baseline HR (bpm): $[92, 91, 90, 88, 89, 90, 87]$\n  - Post-dose HR (bpm): $[92, 65.9, 65.2, 58.633, 59.833, 58.482, 55.082]$\n\nTest Case $3$ (low-dose regime testing identifiability under shallow curvature):\n- Genotype A:\n  - Dose (mg): $[0, 1, 1, 2, 2, 4, 4, 8, 8]$\n  - Baseline HR (bpm): $[80, 82, 78, 81, 79, 83, 77, 84, 80]$\n  - Post-dose HR (bpm): $[80, 81.61, 77.31, 80.038, 78.238, 81.048, 75.148, 80.752, 76.252]$\n- Genotype B:\n  - Dose (mg): $[0, 1, 1, 2, 2, 4, 4, 8, 8]$\n  - Baseline HR (bpm): $[81, 80, 82, 79, 83, 84, 76, 85, 81]$\n  - Post-dose HR (bpm): $[81, 75.733, 77.833, 72.057, 75.657, 72.889, 65.189, 69.215, 65.715]$\n\nAlgorithmic requirements:\n- Derive the saturable dose-effect relationship from a receptor occupancy framework and fit the $\\Delta HR$ data versus dose to recover genotype-specific $E_{\\max}$ and $EC_{50}$ via non-linear least squares.\n- Use bounded optimization: $E_{\\max} \\in [0, 100]$ and $EC_{50} \\in [10^{-3}, 200]$.\n- The fitting must be performed independently for each genotype within each test case.\n- Report the final estimates rounded to two decimal places, with $E_{\\max}$ in beats per minute and $EC_{50}$ in milligrams.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The output must be a list of three sublists, one per test case, each sublist ordered as $[E_{\\max}^{A}, EC_{50}^{A}, E_{\\max}^{B}, EC_{50}^{B}]$ with each value rounded to two decimal places and implicitly in its required unit. For example, the structure must be exactly like $[[x_1, y_1, x_2, y_2],[x_3, y_3, x_4, y_4],[x_5, y_5, x_6, y_6]]$, where all $x_i$ are $E_{\\max}$ values (in beats per minute) and all $y_i$ are $EC_{50}$ values (in milligrams).",
            "solution": "The problem requires the estimation of pharmacodynamic parameters from dose-response data for different genotypes. This is a standard task in quantitative pharmacology and pharmacogenomics. Before proceeding with the solution, the problem statement is validated.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Pharmacodynamic Model**: A saturable dose-effect model derived from receptor-binding and the Law of Mass Action.\n*   **Parameters to Estimate**: $E_{\\max}$ (maximum heart rate reduction, in beats per minute) and $EC_{50}$ (dose for half-maximal effect, in milligrams).\n*   **Effect Definition**: $\\Delta HR = HR_{\\text{baseline}} - HR_{\\text{post}}$ (in beats per minute).\n*   **Fitting Method**: Non-linear least squares.\n*   **Parameter Constraints**: $E_{\\max} \\in [0, 100]$ bpm and $EC_{50} \\in [10^{-3}, 200]$ mg.\n*   **Data Structure**: Three test cases are provided, each with data for two genotypes (A and B). Each genotype dataset includes:\n    *   Dose vector (mg)\n    *   Baseline HR vector (bpm)\n    *   Post-dose HR vector (bpm)\n*   **Test Case 1**:\n    *   Genotype A: Dose: $[0, 2, 2, 5, 5, 10, 10, 25, 25]$, Baseline HR: $[80, 82, 78, 81, 79, 83, 77, 84, 80]$, Post-dose HR: $[80, 73.729, 69.329, 65.8, 64.5, 63.0, 57.4, 58.7, 55.2]$\n    *   Genotype B: Dose: $[0, 2, 2, 5, 5, 10, 10, 25, 25]$, Baseline HR: $[78, 80, 82, 79, 83, 84, 76, 85, 81]$, Post-dose HR: $[78, 77.747, 79.447, 74.3, 77.9, 76.2, 68.0, 72.1, 69.0]$\n*   **Test Case 2**:\n    *   Genotype A: Dose: $[0, 20, 20, 40, 40, 80, 80]$, Baseline HR: $[88, 90, 86, 87, 89, 90, 85]$, Post-dose HR: $[88, 59.765, 55.465, 54.742, 55.942, 56.266, 51.366]$\n    *   Genotype B: Dose: $[0, 20, 20, 40, 40, 80, 80]$, Baseline HR: $[92, 91, 90, 88, 89, 90, 87]$, Post-dose HR: $[92, 65.9, 65.2, 58.633, 59.833, 58.482, 55.082]$\n*   **Test Case 3**:\n    *   Genotype A: Dose: $[0, 1, 1, 2, 2, 4, 4, 8, 8]$, Baseline HR: $[80, 82, 78, 81, 79, 83, 77, 84, 80]$, Post-dose HR: $[80, 81.61, 77.31, 80.038, 78.238, 81.048, 75.148, 80.752, 76.252]$\n    *   Genotype B: Dose: $[0, 1, 1, 2, 2, 4, 4, 8, 8]$, Baseline HR: $[81, 80, 82, 79, 83, 84, 76, 85, 81]$, Post-dose HR: $[81, 75.733, 77.833, 72.057, 75.657, 72.889, 65.189, 69.215, 65.715]$\n*   **Output Format**: A list of three sublists, with each sublist containing $[E_{\\max}^{A}, EC_{50}^{A}, E_{\\max}^{B}, EC_{50}^{B}]$ rounded to two decimal places.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded**: The problem is based on the classical Emax model of pharmacodynamics, which is derived from the Law of Mass Action and receptor occupancy theory. This is a fundamental and well-established principle in pharmacology. All aspects of the problem are scientifically sound.\n*   **Well-Posed**: The problem is to perform a non-linear regression, which is a well-defined mathematical problem. The data, model, and constraints are provided, ensuring that a unique and stable solution can be found.\n*   **Objective**: The problem is described using precise mathematical language and numerical data. The task is objective and free from subjective interpretation.\n*   **Other Flaws**: The problem is self-contained, consistent, and scientifically plausible. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Solution\n\nThe solution involves deriving the appropriate pharmacodynamic model and then using non-linear least squares to fit this model to the provided experimental data for each genotype.\n\n**1. Mechanistic Model Derivation**\n\nThe relationship between drug dose and its pharmacological effect is based on the interaction of the drug with its target receptors. The process can be modeled by the Law of Mass Action. Let $D$ represent the drug, $R$ the free receptor, and $DR$ the drug-receptor complex. The reversible binding is described by the equilibrium:\n\n$$ D + R \\rightleftharpoons DR $$\n\nThe dissociation constant, $K_d$, is defined at equilibrium as:\n\n$$ K_d = \\frac{[D][R]}{[DR]} $$\n\nThe total number of receptors, $R_{tot}$, is the sum of free and bound receptors: $R_{tot} = [R] + [DR]$. The fractional occupancy of the receptors is the ratio of bound receptors to the total number of receptors, $[DR]/R_{tot}$. By substituting $[R] = R_{tot} - [DR]$ into the $K_d$ expression and rearranging, we can express the fractional occupancy as a function of the drug concentration $[D]$:\n\n$$ \\text{Fractional Occupancy} = \\frac{[DR]}{R_{tot}} = \\frac{[D]}{K_d + [D]} $$\n\nA fundamental assumption in this model is that the observed pharmacological effect, $E$, is directly proportional to the fractional receptor occupancy. The maximum possible effect, $E_{\\max}$, occurs when all receptors are occupied (i.e., at saturating drug concentrations). Thus:\n\n$$ E = E_{\\max} \\cdot (\\text{Fractional Occupancy}) $$\n\nSubstituting the expression for fractional occupancy, we arrive at the standard saturable Emax model:\n\n$$ E(D) = \\frac{E_{\\max} \\cdot D}{EC_{50} + D} $$\n\nIn this equation:\n*   $E(D)$ is the effect at a given dose $D$. In this problem, the effect is the change in heart rate, $\\Delta HR = HR_{\\text{baseline}} - HR_{\\text{post}}$.\n*   $D$ is the dose of the drug, in milligrams.\n*   $E_{\\max}$ is the maximum possible effect (maximum $\\Delta HR$), in beats per minute.\n*   $EC_{50}$ is the dose that produces $50\\%$ of the maximum effect. It is a measure of the drug's potency and is mathematically equivalent to the dissociation constant $K_d$ under these assumptions.\n\n**2. Parameter Estimation via Non-Linear Least Squares**\n\nThe parameters $E_{\\max}$ and $EC_{50}$ are unknown and must be estimated from the experimental data. This is achieved by fitting the Emax model to the observed $(\\text{Dose}, \\Delta HR)$ pairs. The method of choice is non-linear least squares (NLLS). NLLS finds the parameter values ($\\hat{E}_{\\max}, \\hat{EC}_{50}$) that minimize the sum of the squared differences (residuals) between the observed effect and the effect predicted by the model:\n\n$$ \\text{min} \\sum_{i=1}^{n} \\left( \\Delta HR_i - \\frac{\\hat{E}_{\\max} \\cdot \\text{Dose}_i}{\\hat{EC}_{50} + \\text{Dose}_i} \\right)^2 $$\n\nwhere the sum is over all $n$ data points for a given genotype. This minimization problem is solved numerically using an iterative optimization algorithm. The `scipy.optimize.curve_fit` function in Python, which typically uses the Levenberg-Marquardt algorithm, is well-suited for this task.\n\n**3. Implementation Strategy**\n\nThe overall algorithm proceeds as follows for each test case:\n1.  For each genotype (A and B), the observed effect data, $\\Delta HR$, are first calculated by subtracting the post-dose heart rate from the baseline heart rate for each observation.\n2.  The Emax model function, $f(D; E_{\\max}, EC_{50})$, is defined.\n3.  The `scipy.optimize.curve_fit` function is called to perform the NLLS fit. The inputs are the model function, the vector of doses (independent variable), and the vector of calculated $\\Delta HR$ values (dependent variable).\n4.  Crucially, the pharmacologically plausible constraints, $E_{\\max} \\in [0, 100]$ bpm and $EC_{50} \\in [10^{-3}, 200]$ mg, are supplied to the optimizer as bounds. This prevents the algorithm from converging to physically meaningless parameter values.\n5.  This procedure is performed independently for Genotype A and Genotype B, yielding a separate set of $(\\hat{E}_{\\max}, \\hat{EC}_{50})$ estimates for each.\n6.  The final estimated parameters are rounded to two decimal places as required. The results for all test cases are then aggregated into the specified final output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits a saturable dose-effect model (Emax model) to pharmacodynamic data\n    to estimate genotype-specific Emax and EC50 parameters.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            \"Genotype A\": {\n                \"Dose\": np.array([0, 2, 2, 5, 5, 10, 10, 25, 25]),\n                \"Baseline HR\": np.array([80, 82, 78, 81, 79, 83, 77, 84, 80]),\n                \"Post-dose HR\": np.array([80, 73.729, 69.329, 65.8, 64.5, 63.0, 57.4, 58.7, 55.2])\n            },\n            \"Genotype B\": {\n                \"Dose\": np.array([0, 2, 2, 5, 5, 10, 10, 25, 25]),\n                \"Baseline HR\": np.array([78, 80, 82, 79, 83, 84, 76, 85, 81]),\n                \"Post-dose HR\": np.array([78, 77.747, 79.447, 74.3, 77.9, 76.2, 68.0, 72.1, 69.0])\n            }\n        },\n        # Test Case 2\n        {\n            \"Genotype A\": {\n                \"Dose\": np.array([0, 20, 20, 40, 40, 80, 80]),\n                \"Baseline HR\": np.array([88, 90, 86, 87, 89, 90, 85]),\n                \"Post-dose HR\": np.array([88, 59.765, 55.465, 54.742, 55.942, 56.266, 51.366])\n            },\n            \"Genotype B\": {\n                \"Dose\": np.array([0, 20, 20, 40, 40, 80, 80]),\n                \"Baseline HR\": np.array([92, 91, 90, 88, 89, 90, 87]),\n                \"Post-dose HR\": np.array([92, 65.9, 65.2, 58.633, 59.833, 58.482, 55.082])\n            }\n        },\n        # Test Case 3\n        {\n            \"Genotype A\": {\n                \"Dose\": np.array([0, 1, 1, 2, 2, 4, 4, 8, 8]),\n                \"Baseline HR\": np.array([80, 82, 78, 81, 79, 83, 77, 84, 80]),\n                \"Post-dose HR\": np.array([80, 81.61, 77.31, 80.038, 78.238, 81.048, 75.148, 80.752, 76.252])\n            },\n            \"Genotype B\": {\n                \"Dose\": np.array([0, 1, 1, 2, 2, 4, 4, 8, 8]),\n                \"Baseline HR\": np.array([81, 80, 82, 79, 83, 84, 76, 85, 81]),\n                \"Post-dose HR\": np.array([81, 75.733, 77.833, 72.057, 75.657, 72.889, 65.189, 69.215, 65.715])\n            }\n        }\n    ]\n\n    def emax_model(dose, Emax, EC50):\n        \"\"\"Saturable Emax model for dose-response relationship.\"\"\"\n        # Add a small epsilon to EC50 + dose to avoid division by zero if dose=-EC50, though not expected here\n        return (Emax * dose) / (EC50 + dose + 1e-9)\n\n    all_results = []\n    \n    # Define parameter bounds as specified\n    bounds = ([0, 1e-3], [100, 200])\n    # Define a robust initial guess\n    p0 = [20, 10]\n\n    for case_data in test_cases:\n        case_results = []\n        genotypes = [\"Genotype A\", \"Genotype B\"]\n        \n        for genotype in genotypes:\n            data = case_data[genotype]\n            dose = data[\"Dose\"]\n            baseline_hr = data[\"Baseline HR\"]\n            post_dose_hr = data[\"Post-dose HR\"]\n            \n            # Calculate the effect (change in heart rate)\n            delta_hr = baseline_hr - post_dose_hr\n            \n            # Perform non-linear least squares fitting\n            try:\n                popt, _ = curve_fit(emax_model, dose, delta_hr, bounds=bounds, p0=p0, maxfev=5000)\n                Emax_fit, EC50_fit = popt\n            except RuntimeError:\n                # Fallback in case of fitting failure, though not expected with this data\n                Emax_fit, EC50_fit = np.nan, np.nan\n\n            # Append rounded results to the list for the current case\n            case_results.append(round(Emax_fit, 2))\n            case_results.append(round(EC50_fit, 2))\n            \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(all_results)\n\nsolve()\n```"
        }
    ]
}