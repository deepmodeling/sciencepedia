{
    "hands_on_practices": [
        {
            "introduction": "任何生物标志物的临床验证都始于对其诊断性能的准确定量。本练习提供了一个基于前瞻性队列研究数据的实践场景，旨在训练您从基本的混淆矩阵数据中计算灵敏度、特异性、阳性预测值 (PPV) 和阴性预测值 (NPV) 。这项核心技能不仅是评估生物标志物的基础，也是理解其在特定临床使用背景 (Context of Use, COU) 下（例如，高风险筛查）价值的关键。",
            "id": "4999473",
            "problem": "一种基于血液的预后生物标志物正在进行临床验证，其筛查使用情境 (COU) 定义为早期识别潜伏性疾病患者，其中漏诊病例将带来高昂的临床代价。在一个包含 $300$ 名参与者的前瞻性队列中，测试后的金标准裁定得出以下计数：真阳性 (TP) $=68$，假阳性 (FP) $=12$，假阴性 (FN) $=22$，真阴性 (TN) $=198$。使用基于频率计数的条件概率和分类性能的基本定义，计算该生物标志物在此验证队列中的以下性能特征：灵敏度、特异度、阳性预测值 (PPV)、阴性预测值 (NPV) 和准确率。然后，确定哪个单一性能指标与所述的筛查COU最一致，在该COU中，假阴性的临床后果在决策中占主导地位。对于输出编码，使用以下数字代码表示与COU一致的指标：$1$ 代表灵敏度，$2$ 代表特异度，$3$ 代表PPV，$4$ 代表NPV，$5$ 代表准确率。以小数（非百分比）形式报告所有五个指标值，并将每个值四舍五入至四位有效数字。按以下顺序将最终输出提供为单行矩阵：灵敏度、特异度、PPV、NPV、准确率，后跟COU指标代码。",
            "solution": "临床验证任务依赖于分类和条件概率的核心定义。设 $D$ 表示存在疾病，$\\overline{D}$ 表示不存在疾病，设 $T^{+}$ 和 $T^{-}$ 分别表示阳性和阴性测试结果。混淆矩阵的计数通过相对频率映射到经验概率。\n\n灵敏度是条件概率 $P(T^{+} \\mid D)$，解释为在存在疾病的情况下测试结果为阳性的概率。根据条件概率的频率主义定义，\n$$\nP(T^{+} \\mid D) = \\frac{\\text{number of diseased with positive test}}{\\text{number of diseased}} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}}。\n$$\n根据给定的计数，$\\text{TP} = 68$ 且 $\\text{FN} = 22$，所以\n$$\n\\text{灵敏度} = \\frac{68}{68 + 22} = \\frac{68}{90}。\n$$\n该值等于 $0.755\\overline{5}$，四舍五入到四位有效数字为 $0.7556$。\n\n特异度是条件概率 $P(T^{-} \\mid \\overline{D})$，即在不存在疾病的情况下测试结果为阴性的概率。根据相同原理，\n$$\nP(T^{-} \\mid \\overline{D}) = \\frac{\\text{number of non-diseased with negative test}}{\\text{number of non-diseased}} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}}。\n$$\n当 $\\text{TN} = 198$ 且 $\\text{FP} = 12$ 时，\n$$\n\\text{特异度} = \\frac{198}{198 + 12} = \\frac{198}{210} = 0.942857\\ldots，\n$$\n四舍五入到四位有效数字为 $0.9429$。\n\n阳性预测值 (PPV) 是条件概率 $P(D \\mid T^{+})$，即在测试结果为阳性的情况下患有疾病的概率。在一个计数固定的队列中，这等于阳性测试中真阳性所占的比例：\n$$\n\\text{PPV} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}}。\n$$\n当 $\\text{TP} = 68$ 且 $\\text{FP} = 12$ 时，\n$$\n\\text{PPV} = \\frac{68}{68 + 12} = \\frac{68}{80} = 0.85。\n$$\n精确到四位有效数字，此值为 $0.8500$。\n\n阴性预测值 (NPV) 是条件概率 $P(\\overline{D} \\mid T^{-})$，即在测试结果为阴性的情况下不患病的概率。类似地，\n$$\n\\text{NPV} = \\frac{\\text{TN}}{\\text{TN} + \\text{FN}}。\n$$\n当 $\\text{TN} = 198$ 且 $\\text{FN} = 22$ 时，\n$$\n\\text{NPV} = \\frac{198}{198 + 22} = \\frac{198}{220} = 0.9，\n$$\n精确到四位有效数字为 $0.9000$。\n\n准确率是在所有被测试个体中正确分类的总比例。设 $N$ 表示个体总数。那么\n$$\n\\text{准确率} = \\frac{\\text{TP} + \\text{TN}}{N}。\n$$\n这里，$N = \\text{TP} + \\text{FP} + \\text{FN} + \\text{TN} = 68 + 12 + 22 + 198 = 300$，且 $\\text{TP} + \\text{TN} = 68 + 198 = 266$，所以\n$$\n\\text{准确率} = \\frac{266}{300} = 0.886666\\ldots，\n$$\n四舍五入到四位有效数字为 $0.8867$。\n\n对于COU决策，在假阴性的临床后果占主导地位的筛查中，目标是优先识别尽可能多的真实病例，这由灵敏度 $P(T^{+} \\mid D)$ 量化。尽管在低患病率环境中，阴性预测值对于安抚阴性结果者也可能很重要，但对最小化假阴性的明确强调将灵敏度定位为与COU一致的主要指标。使用提供的编码，灵敏度对应于代码 $1$。\n\n按顺序（灵敏度、特异度、PPV、NPV、准确率、COU指标代码）组合所要求的输出，并将每个指标值四舍五入到四位有效数字，得到：\n$$\n\\left(0.7556,\\ 0.9429,\\ 0.8500,\\ 0.9000,\\ 0.8867,\\ 1\\right)。\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.7556  0.9429  0.8500  0.9000  0.8867  1\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然灵敏度和特异性是检测方法固有的特性，但生物标志物在实际应用中的预测能力很大程度上取决于其所应用的群体的疾病患病率。本练习将通过贝叶斯定理，从第一性原理推导阳性预测值 (PPV) 和阴性预测值 (NPV) 与患病率之间的数学关系 。通过定量计算患病率变化对 PPV 的影响，您将深刻理解为何在解释生物标志物结果时，必须考虑目标人群的特征。",
            "id": "4999450",
            "problem": "在一项由生物标志物驱动的转化研究中，正在对一种二元诊断检测方法进行临床验证，以对患者进行分层，用于靶向治疗。设疾病状态由 $D \\in \\{1,0\\}$（存在，不存在）表示，检测结果由 $T \\in \\{+, -\\}$ 表示。该检测的灵敏度为 $S_{e} = \\mathbb{P}(T=+ \\mid D=1)$，特异性为 $S_{p} = \\mathbb{P}(T=- \\mid D=0)$。在预期使用人群中，该疾病的患病率为 $p = \\mathbb{P}(D=1)$。阳性预测值（PPV）定义为 $\\mathbb{P}(D=1 \\mid T=+)$，阴性预测值（NPV）定义为 $\\mathbb{P}(D=0 \\mid T=-)$。\n\n仅使用概率公理和 Bayes 定理作为基本原则，推导表达式，说明 $PPV$ 和 $NPV$ 如何依赖于 $p$、$S_{e}$ 和 $S_{p}$。根据推导出的公式，解释为什么当 $S_{e}$ 和 $S_{p}$ 固定时，$PPV$ 和 $NPV$ 必然随 $p$ 的变化而变化。然后，对于一个灵敏度 $S_{e} = 0.90$、特异性 $S_{p} = 0.95$ 的检测，计算当患病率从 $p=0.05$ 增加到 $p=0.20$ 时 $PPV$ 的绝对变化。将最终数值结果表示为精确分数。不要近似计算。",
            "solution": "阳性预测值（$PPV$）和阴性预测值（$NPV$）的推导从它们的定义和 Bayes 定理的应用开始。\n\n首先，对于 $PPV = \\mathbb{P}(D=1 \\mid T=+)$，Bayes 定理指出：\n$$PPV = \\frac{\\mathbb{P}(T=+ \\mid D=1) \\mathbb{P}(D=1)}{\\mathbb{P}(T=+)}$$\n分子中的项是直接给出的：$\\mathbb{P}(T=+ \\mid D=1) = S_e$ 和 $\\mathbb{P}(D=1) = p$。\n分母 $\\mathbb{P}(T=+)$ 是检测结果为阳性的总概率。可以使用全概率定律在两种可能的疾病状态 $D=1$ 和 $D=0$ 上展开：\n$$\\mathbb{P}(T=+) = \\mathbb{P}(T=+ \\mid D=1) \\mathbb{P}(D=1) + \\mathbb{P}(T=+ \\mid D=0) \\mathbb{P}(D=0)$$\n已知 $\\mathbb{P}(D=1)=p$，所以 $\\mathbb{P}(D=0) = 1 - \\mathbb{P}(D=1) = 1-p$。\n项 $\\mathbb{P}(T=+ \\mid D=0)$ 是假阳性率，它与特异性有关。根据定义，$S_p = \\mathbb{P}(T=- \\mid D=0)$。由于只有两种检测结果，$\\mathbb{P}(T=+ \\mid D=0) = 1 - \\mathbb{P}(T=- \\mid D=0) = 1 - S_p$。\n将这些分量代入 $\\mathbb{P}(T=+)$ 的表达式中：\n$$\\mathbb{P}(T=+) = (S_e)(p) + (1-S_p)(1-p)$$\n最后，将此代回 $PPV$ 的公式中：\n$$PPV = \\frac{S_e p}{S_e p + (1-S_p)(1-p)}$$\n\n接下来，对于 $NPV = \\mathbb{P}(D=0 \\mid T=-)$，Bayes 定理指出：\n$$NPV = \\frac{\\mathbb{P}(T=- \\mid D=0) \\mathbb{P}(D=0)}{\\mathbb{P}(T=-)}$$\n分子中的项是已知的或可以直接推导：$\\mathbb{P}(T=- \\mid D=0) = S_p$ 和 $\\mathbb{P}(D=0) = 1-p$。\n分母 $\\mathbb{P}(T=-)$ 使用全概率定律展开：\n$$\\mathbb{P}(T=-) = \\mathbb{P}(T=- \\mid D=0) \\mathbb{P}(D=0) + \\mathbb{P}(T=- \\mid D=1) \\mathbb{P}(D=1)$$\n项 $\\mathbb{P}(T=- \\mid D=1)$ 是假阴性率，与灵敏度有关。根据定义，$S_e = \\mathbb{P}(T=+ \\mid D=1)$。因此，$\\mathbb{P}(T=- \\mid D=1) = 1 - \\mathbb{P}(T=+ \\mid D=1) = 1 - S_e$。\n将这些分量代入 $\\mathbb{P}(T=-)$ 的表达式中：\n$$\\mathbb{P}(T=-) = (S_p)(1-p) + (1-S_e)(p)$$\n最后，将此代回 $NPV$ 的公式中：\n$$NPV = \\frac{S_p(1-p)}{S_p(1-p) + (1-S_e)p}$$\n\n推导出的 $PPV$ 和 $NPV$ 公式明确地显示了它们对患病率 $p$ 的依赖性。对于固定的检测特性（$S_e$ 和 $S_p$），$PPV$ 和 $NPV$ 都是 $p$ 的函数。\n对于 $PPV$，由于 $p$ 同时出现在分子和分母中，$PPV$ 不是 $p$ 的常数函数。具体来说，对于非完美检测（$S_e  < 1$, $S_p < 1$），可以证明 $PPV$ 对 $p$ 的导数为正，这意味着 $PPV$ 随患病率的增加而增加。较高的检测前概率（$p$）与阳性检测结果相结合，会导致较高的检测后概率（$PPV$）。\n同样，对于 $NPV$，$p$ 在分子和分母中的存在表明了其依赖性。$NPV$ 对 $p$ 的导数为负，这意味着 $NPV$ 随患病率的增加而减小。在疾病更常见的群体中，阴性检测结果的保证性较差（即，无病的概率较低）。\n\n现在，我们计算给定值的 $PPV$ 的绝对变化。\n已知：$S_e = 0.90 = \\frac{9}{10}$ 且 $S_p = 0.95 = \\frac{19}{20}$。\n初始患病率为 $p_1 = 0.05 = \\frac{5}{100} = \\frac{1}{20}$。\n最终患病率为 $p_2 = 0.20 = \\frac{20}{100} = \\frac{1}{5}$。\n\n首先，计算 $p_1 = \\frac{1}{20}$ 时的 $PPV_1$：\n我们还需要 $1-S_p = 1 - \\frac{19}{20} = \\frac{1}{20}$ 和 $1-p_1 = 1 - \\frac{1}{20} = \\frac{19}{20}$。\n$$PPV_1 = \\frac{S_e p_1}{S_e p_1 + (1-S_p)(1-p_1)} = \\frac{(\\frac{9}{10})(\\frac{1}{20})}{(\\frac{9}{10})(\\frac{1}{20}) + (\\frac{1}{20})(\\frac{19}{20})}$$\n$$PPV_1 = \\frac{\\frac{9}{200}}{\\frac{9}{200} + \\frac{19}{400}} = \\frac{\\frac{18}{400}}{\\frac{18}{400} + \\frac{19}{400}} = \\frac{\\frac{18}{400}}{\\frac{37}{400}} = \\frac{18}{37}$$\n\n接下来，计算 $p_2 = \\frac{1}{5}$ 时的 $PPV_2$：\n我们需要 $1-p_2 = 1 - \\frac{1}{5} = \\frac{4}{5}$。\n$$PPV_2 = \\frac{S_e p_2}{S_e p_2 + (1-S_p)(1-p_2)} = \\frac{(\\frac{9}{10})(\\frac{1}{5})}{(\\frac{9}{10})(\\frac{1}{5}) + (\\frac{1}{20})(\\frac{4}{5})}$$\n$$PPV_2 = \\frac{\\frac{9}{50}}{\\frac{9}{50} + \\frac{4}{100}} = \\frac{\\frac{18}{100}}{\\frac{18}{100} + \\frac{4}{100}} = \\frac{\\frac{18}{100}}{\\frac{22}{100}} = \\frac{18}{22} = \\frac{9}{11}$$\n\n$PPV$ 的绝对变化是 $|\\Delta PPV| = |PPV_2 - PPV_1|$。\n由于 $PPV$ 随 $p$ 增加而增加，因此这是 $PPV_2 - PPV_1$。\n$$|\\Delta PPV| = \\frac{9}{11} - \\frac{18}{37}$$\n为了进行分数相减，我们找到一个公分母，即 $11 \\times 37 = 407$。\n$$|\\Delta PPV| = \\frac{9 \\times 37}{11 \\times 37} - \\frac{18 \\times 11}{37 \\times 11} = \\frac{333}{407} - \\frac{198}{407} = \\frac{333 - 198}{407} = \\frac{135}{407}$$\n分子是 $135 = 3^3 \\times 5$。分母是 $407 = 11 \\times 37$。没有共同的质因数，所以该分数是最简形式。",
            "answer": "$$\\boxed{\\frac{135}{407}}$$"
        },
        {
            "introduction": "传统的准确性指标（如灵敏度和特异性）并不总能完全反映一项检测在临床决策中的实际效用。决策曲线分析 (Decision Curve Analysis, DCA) 是一种评估临床实用性的先进方法，它超越了单纯的统计性能，转而量化使用生物标志物指导治疗决策所带来的净获益。本练习将引导您从决策理论的基础出发，推导净获益的计算公式，并应用于一个具体案例，从而将评估重点从“测试有多准”转向“使用该测试是否利大于弊” 。",
            "id": "4999460",
            "problem": "一个转化医学团队正在评估一种候选的血液生物标志物是否具有临床实用性，以用于指导对异质性患者群体的侵入性治疗。该团队计划使用决策曲线分析（DCA）来量化不同风险阈值下的临床效用。在此框架中，决策规则对那些预测疾病风险至少达到选定阈值概率的患者进行治疗。假设DCA具有以下基本决策理论基础：对于疾病概率为 $p$ 的个体，进行治疗的期望效用为 $p\\,B - (1-p)\\,H$，其中 $B$ 是对真正患病的患者进行治疗时获得的临床获益，而 $H$ 是对没有疾病的患者进行不必要治疗时产生的临床危害。按照惯例，不采取任何行动的效用为零。阈值概率 $p_t$ 被定义为使得治疗的期望效用等于不治疗的期望效用的最小概率 $p$。群体水平的性能总结基于真阳性和假阳性的计数，其净临床价值以每位患者的获益当量为单位表示。\n\n仅从这些定义出发，推导出一个基于模型的决策规则的净获益表达式，该规则当且仅当 $p \\ge p_t$ 时进行治疗。该表达式应仅用群体大小 $N$、真阳性数 $TP$、假阳性数 $FP$ 和阈值概率 $p_t$ 来表示。然后，在一个大小为 $N = 1000$ 的验证队列中，假设在 $p_t = 0.15$ 的阈值下评估时，该模型产生 $TP = 80$ 和 $FP = 50$。计算该模型在此阈值下的净获益。将最终答案表示为每位患者的净获益（即每位患者的真阳性数），并四舍五入到 $4$ 位有效数字。",
            "solution": "### 净获益表达式的推导\n\n首先，我们建立获益（$B$）、危害（$H$）和阈值概率（$p_t$）之间的关系。阈值概率 $p_t$ 被定义为决策者在治疗和不治疗之间无差异时的概率 $p$。这种情况发生在治疗的期望效用等于不治疗的期望效用时。\n\n使用给定的效用函数：\n$$ U_{treat}(p_t) = U_{not\\_treat} $$\n$$ p_t B - (1 - p_t)H = 0 $$\n\n这个方程可以重新整理，以表示在选定阈值下危害与获益之间的权衡：\n$$ p_t B = (1 - p_t)H $$\n$$ \\frac{H}{B} = \\frac{p_t}{1 - p_t} $$\n这个比率通常被称为“交换率”，它量化了为了避免一个单位的危害而愿意放弃的获益单位数。它完全由阈值概率 $p_t$ 决定。\n\n接下来，我们考虑在应用决策规则时，对于一个大小为 $N$ 的群体的总净效用。规则是如果患者的预测风险大于或等于 $p_t$，就对其进行治疗。将此规则应用于该群体，会导致一定数量的患者接受治疗。\n- 被正确治疗的患病患者数量是真阳性数 $TP$。\n- 被错误治疗的非患病患者数量是假阳性数 $FP$。\n\n整个群体的总净效用是所有获益的总和减去所有危害的总和：\n$$ \\text{总净效用} = (TP \\times B) - (FP \\times H) $$\n\n问题将净临床价值或净获益（$NB$）定义为“以每位患者的获益当量为单位表示”。\n为了以获益（$B$）的单位表示总效用，我们除以 $B$：\n$$ \\text{总净获益（以B为单位）} = \\frac{(TP \\times B) - (FP \\times H)}{B} = TP - FP \\left(\\frac{H}{B}\\right) $$\n\n现在，我们代入之前推导出的比率 $\\frac{H}{B}$ 的表达式：\n$$ \\text{总净获益} = TP - FP \\left(\\frac{p_t}{1 - p_t}\\right) $$\n\n这是整个大小为 $N$ 的群体的总净获益。为了找到*每位患者*的净获益，我们将这个总数除以 $N$：\n$$ NB = \\frac{\\text{总净获益}}{N} = \\frac{1}{N} \\left[ TP - FP \\left(\\frac{p_t}{1 - p_t}\\right) \\right] $$\n这个表达式可以改写为：\n$$ NB = \\frac{TP}{N} - \\frac{FP}{N} \\left(\\frac{p_t}{1 - p_t}\\right) $$\n这就是所求的每位患者净获益的表达式，仅由 $N$、$TP$、$FP$ 和 $p_t$ 表示。它表示每位患者的真阳性净增益，此增益是在考虑了由所选风险阈值加权的假阳性危害之后得到的。\n\n### 净获益的计算\n\n我们有以下验证队列的数据：\n- 群体大小：$N = 1000$\n- 真阳性数：$TP = 80$\n- 假阳性数：$FP = 50$\n- 阈值概率：$p_t = 0.15$\n\n我们将这些值代入推导出的每位患者净获益（$NB$）公式中：\n$$ NB = \\frac{80}{1000} - \\frac{50}{1000} \\left(\\frac{0.15}{1 - 0.15}\\right) $$\n\n首先，简化初始项和括号内的分数：\n$$ NB = 0.08 - 0.05 \\left(\\frac{0.15}{0.85}\\right) $$\n\n这个分数可以简化为：\n$$ \\frac{0.15}{0.85} = \\frac{15}{85} = \\frac{3 \\times 5}{17 \\times 5} = \\frac{3}{17} $$\n\n现在，将这个简化的分数代回方程中：\n$$ NB = 0.08 - 0.05 \\left(\\frac{3}{17}\\right) $$\n$$ NB = 0.08 - \\frac{0.15}{17} $$\n\n现在我们进行除法运算：\n$$ \\frac{0.15}{17} \\approx 0.0088235294... $$\n\n最后，我们计算净获益：\n$$ NB \\approx 0.08 - 0.0088235294... $$\n$$ NB \\approx 0.0711764706... $$\n\n问题要求答案四舍五入到 $4$ 位有效数字。第一位有效数字是 $7$。第四位有效数字是第二个 $1$。它后面的数字是 $7$，大于或等于 $5$，所以我们向上取整。\n$$ NB \\approx 0.07118 $$\n\n该模型在 $p_t = 0.15$ 阈值下的净获益约为 $0.07118$。这个值意味着，使用该模型指导治疗，其效果相当于一种策略，即在每100名患者中额外正确识别出7.118个真阳性病例，而不会带来任何假阳性的危害。",
            "answer": "$$\\boxed{0.07118}$$"
        }
    ]
}