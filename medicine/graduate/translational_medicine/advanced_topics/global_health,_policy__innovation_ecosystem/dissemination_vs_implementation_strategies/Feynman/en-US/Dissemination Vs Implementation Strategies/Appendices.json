{
    "hands_on_practices": [
        {
            "introduction": "Effective implementation science hinges on precise measurement. In this exercise, we distinguish between two critical, yet often conflated, outcomes: provider-level adoption and patient-level penetration. You will tackle a common real-world challenge by using the inclusion–exclusion principle to accurately calculate these system-level metrics from overlapping, multi-site data, a fundamental skill for any program evaluator in a complex health system. ",
            "id": "5010830",
            "problem": "A regional integrated delivery network implemented an evidence-based Transitional Heart Failure Care Bundle across three hospitals during Quarter $2$ of the rollout. The Dissemination and Implementation (D&I) plan explicitly distinguished provider-level adoption from patient-level penetration. For this evaluation, adopt the following fundamental definitions drawn from the implementation outcomes framework: adoption is the proportion of eligible providers who have initiated use of the intervention at least once during the period, and penetration is the proportion of eligible patients who actually received the intervention during the period. Eligibility at the provider level requires completion of training and an active panel of heart failure patients meeting predefined criteria; eligibility at the patient level requires a heart failure discharge to home without contraindications and a risk score above a threshold.\n\nThree hospitals, labeled $A$, $B$, and $C$, contributed counts for Quarter $2$. Because providers can work across multiple hospitals and patients can be transferred, duplicates must be removed using the inclusion–exclusion principle over hospitals. All counts below refer to unique persons in the indicated sets at each hospital.\n\nProvider eligibility counts:\n- Hospital $A$: $|E_{A}| = 40$\n- Hospital $B$: $|E_{B}| = 35$\n- Hospital $C$: $|E_{C}| = 25$\n- Pairwise overlaps: $|E_{A} \\cap E_{B}| = 10$, $|E_{B} \\cap E_{C}| = 5$, $|E_{A} \\cap E_{C}| = 2$\n- Triple overlap: $|E_{A} \\cap E_{B} \\cap E_{C}| = 1$\n\nAmong eligible providers, initiation counts (at least one use at the indicated hospital during Quarter $2$):\n- $|I_{A}| = 22$, $|I_{B}| = 18$, $|I_{C}| = 15$\n- Pairwise intersections of initiators: $|I_{A} \\cap I_{B}| = 8$, $|I_{B} \\cap I_{C}| = 4$, $|I_{A} \\cap I_{C}| = 1$\n- Triple intersection of initiators: $|I_{A} \\cap I_{B} \\cap I_{C}| = 1$\n\nPatient eligibility counts:\n- Hospital $A$: $|P_{A}| = 520$\n- Hospital $B$: $|P_{B}| = 430$\n- Hospital $C$: $|P_{C}| = 280$\n- Pairwise overlaps: $|P_{A} \\cap P_{B}| = 60$, $|P_{B} \\cap P_{C}| = 45$, $|P_{A} \\cap P_{C}| = 25$\n- Triple overlap: $|P_{A} \\cap P_{B} \\cap P_{C}| = 12$\n\nAmong eligible patients, receipt counts (received the bundle at the indicated hospital during Quarter $2$):\n- $|R_{A}| = 310$, $|R_{B}| = 250$, $|R_{C}| = 160$\n- Pairwise intersections of receivers: $|R_{A} \\cap R_{B}| = 40$, $|R_{B} \\cap R_{C}| = 30$, $|R_{A} \\cap R_{C}| = 20$\n- Triple intersection of receivers: $|R_{A} \\cap R_{B} \\cap R_{C}| = 10$\n\nAssume that all initiators were eligible providers and all receivers were eligible patients by Quarter $2$ definitions. Compute the system-level adoption and penetration as decimal proportions using the union over hospitals for the respective numerators and denominators. Use the inclusion–exclusion principle to obtain the unique counts. Express both adoption and penetration as decimal fractions, rounded to four significant figures, with no percentage sign and no physical unit.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the field of implementation science, presents a well-posed mathematical task based on set theory, and provides all necessary data without internal contradictions. All data are consistent; for instance, the cardinality of any intersection of sets is not greater than the cardinality of any of the individual sets involved in that intersection. The definitions of adoption and penetration are provided and are standard within the relevant literature. The task is to calculate two metrics, system-level adoption and penetration, using the provided counts and the principle of inclusion-exclusion.\n\nThe definitions for the system-level metrics are:\nAdoption is the proportion of unique eligible providers across the system who initiated use of the intervention.\n$$ \\text{Adoption} = \\frac{|\\text{Total unique initiators}|}{|\\text{Total unique eligible providers}|} $$\nPenetration is the proportion of unique eligible patients across the system who received the intervention.\n$$ \\text{Penetration} = \\frac{|\\text{Total unique recipients}|}{|\\text{Total unique eligible patients}|} $$\n\nTo find the total number of unique individuals in each category (eligible providers, initiators, eligible patients, recipients), we must calculate the cardinality of the union of the sets corresponding to the three hospitals, denoted $A$, $B$, and $C$. The principle of inclusion-exclusion for three sets $S_A$, $S_B$, and $S_C$ states:\n$$ |S_A \\cup S_B \\cup S_C| = |S_A| + |S_B| + |S_C| - (|S_A \\cap S_B| + |S_B \\cap S_C| + |S_A \\cap S_C|) + |S_A \\cap S_B \\cap S_C| $$\n\nWe will apply this principle to each of the four groups.\n\nFirst, we calculate the total number of unique eligible providers, denoted by $|E_{\\text{total}}|$. The sets are $E_A$, $E_B$, and $E_C$.\nThe given data are:\n$|E_{A}| = 40$\n$|E_{B}| = 35$\n$|E_{C}| = 25$\n$|E_{A} \\cap E_{B}| = 10$\n$|E_{B} \\cap E_{C}| = 5$\n$|E_{A} \\cap E_{C}| = 2$\n$|E_{A} \\cap E_{B} \\cap E_{C}| = 1$\n\nApplying the principle of inclusion-exclusion:\n$$ |E_{\\text{total}}| = |E_A \\cup E_B \\cup E_C| = |E_A| + |E_B| + |E_C| - (|E_A \\cap E_B| + |E_B \\cap E_C| + |E_A \\cap E_C|) + |E_A \\cap E_B \\cap E_C| $$\n$$ |E_{\\text{total}}| = 40 + 35 + 25 - (10 + 5 + 2) + 1 $$\n$$ |E_{\\text{total}}| = 100 - 17 + 1 = 84 $$\nSo, there are $84$ unique eligible providers in the system.\n\nSecond, we calculate the total number of unique providers who initiated the intervention, denoted by $|I_{\\text{total}}|$. The sets are $I_A$, $I_B$, and $I_C$.\nThe given data are:\n$|I_{A}| = 22$\n$|I_{B}| = 18$\n$|I_{C}| = 15$\n$|I_{A} \\cap I_{B}| = 8$\n$|I_{B} \\cap I_{C}| = 4$\n$|I_{A} \\cap I_{C}| = 1$\n$|I_{A} \\cap I_{B} \\cap I_{C}| = 1$\n\nApplying the principle of inclusion-exclusion:\n$$ |I_{\\text{total}}| = |I_A \\cup I_B \\cup I_C| = |I_A| + |I_B| + |I_C| - (|I_A \\cap I_B| + |I_B \\cap I_C| + |I_A \\cap I_C|) + |I_A \\cap I_B \\cap I_C| $$\n$$ |I_{\\text{total}}| = 22 + 18 + 15 - (8 + 4 + 1) + 1 $$\n$$ |I_{\\text{total}}| = 55 - 13 + 1 = 43 $$\nSo, there are $43$ unique providers who initiated the intervention.\n\nThe system-level adoption rate is the ratio of $|I_{\\text{total}}|$ to $|E_{\\text{total}}|$:\n$$ \\text{Adoption} = \\frac{|I_{\\text{total}}|}{|E_{\\text{total}}|} = \\frac{43}{84} \\approx 0.51190476... $$\nRounding to four significant figures, the adoption rate is $0.5119$.\n\nThird, we calculate the total number of unique eligible patients, denoted by $|P_{\\text{total}}|$. The sets are $P_A$, $P_B$, and $P_C$.\nThe given data are:\n$|P_{A}| = 520$\n$|P_{B}| = 430$\n$|P_{C}| = 280$\n$|P_{A} \\cap P_{B}| = 60$\n$|P_{B} \\cap P_{C}| = 45$\n$|P_{A} \\cap P_{C}| = 25$\n$|P_{A} \\cap P_{B} \\cap P_{C}| = 12$\n\nApplying the principle of inclusion-exclusion:\n$$ |P_{\\text{total}}| = |P_A \\cup P_B \\cup P_C| = |P_A| + |P_B| + |P_C| - (|P_A \\cap P_B| + |P_B \\cap P_C| + |P_A \\cap P_C|) + |P_A \\cap P_B \\cap P_C| $$\n$$ |P_{\\text{total}}| = 520 + 430 + 280 - (60 + 45 + 25) + 12 $$\n$$ |P_{\\text{total}}| = 1230 - 130 + 12 = 1112 $$\nSo, there are $1112$ unique eligible patients in the system.\n\nFourth, we calculate the total number of unique patients who received the intervention, denoted by $|R_{\\text{total}}|$. The sets are $R_A$, $R_B$, and $R_C$.\nThe given data are:\n$|R_{A}| = 310$\n$|R_{B}| = 250$\n$|R_{C}| = 160$\n$|R_{A} \\cap R_{B}| = 40$\n$|R_{B} \\cap R_{C}| = 30$\n$|R_{A} \\cap R_{C}| = 20$\n$|R_{A} \\cap R_{B} \\cap R_{C}| = 10$\n\nApplying the principle of inclusion-exclusion:\n$$ |R_{\\text{total}}| = |R_A \\cup R_B \\cup R_C| = |R_A| + |R_B| + |R_C| - (|R_A \\cap R_B| + |R_B \\cap R_C| + |R_A \\cap R_C|) + |R_A \\cap R_B \\cap R_C| $$\n$$ |R_{\\text{total}}| = 310 + 250 + 160 - (40 + 30 + 20) + 10 $$\n$$ |R_{\\text{total}}| = 720 - 90 + 10 = 640 $$\nSo, there are $640$ unique patients who received the intervention.\n\nThe system-level penetration rate is the ratio of $|R_{\\text{total}}|$ to $|P_{\\text{total}}|$:\n$$ \\text{Penetration} = \\frac{|R_{\\text{total}}|}{|P_{\\text{total}}|} = \\frac{640}{1112} \\approx 0.57553956... $$\nRounding to four significant figures, the penetration rate is $0.5755$.\n\nThe final results are an adoption rate of $0.5119$ and a penetration rate of $0.5755$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.5119 & 0.5755 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond measuring whether an intervention is used, we must assess *how well* it is being used. This practice introduces the concept of implementation fidelity—the degree to which an intervention is delivered as intended—and moves beyond a simple raw score. You will construct and apply an adjusted fidelity metric that formalizes the real-world concept of acceptable adaptation, developing a nuanced tool that balances adherence to core components with necessary flexibility. ",
            "id": "5010811",
            "problem": "A multisite pragmatic trial in translational medicine is evaluating whether clinics that have received targeted dissemination strategies and implementation strategies for a clinical decision support tool are delivering the intervention with sufficient fidelity. In Implementation Science (IS), fidelity is operationalized as adherence to theory-defined core components. Consider a single clinic where $A=90$ discrete, theory-defined core steps were required in a given observation window, and $a=72$ were executed as intended. The observed steps are independent and identically distributed realizations of a Bernoulli process with an unknown probability $p$ of correct execution when the implementation strategy is functioning as designed. The raw adherence rate is taken as the maximum likelihood estimator of $p$ under a Bernoulli model.\n\nTo reflect acceptable adaptation, an a priori tolerance band is specified: deviations up to a proportion $\\tau=0.10$ of missed steps are considered acceptable for non-core adaptations and should not reduce the fidelity score. Construct an adjusted fidelity score that meets the following invariance and scaling principles derived from the core definition of fidelity and the tolerance band: it equals $1$ under perfect adherence, equals $0$ under zero adherence, is constant on the interval of adherence rates where deviations are within the tolerance band, and increases continuously and linearly outside the tolerance band in a way that preserves the unit interval scaling for fidelity.\n\nUsing only these principles, compute the adjusted fidelity score for the clinic with $a=72$ and $A=90$ under the tolerance $\\tau=0.10$. Express your final answer as a unitless proportion and round your answer to four significant figures.",
            "solution": "The user has provided a problem that requires the construction and evaluation of an adjusted fidelity score based on a set of principles from Implementation Science.\n\n### Step 1: Problem Validation\n\nFirst, I will validate the problem statement.\n\n**1.1. Extract Givens**\n- Total number of required discrete steps: $A = 90$.\n- Number of steps executed as intended: $a = 72$.\n- The observed steps are independent and identically distributed realizations of a Bernoulli process with probability of correct execution $p$.\n- The raw adherence rate is the maximum likelihood estimator of $p$.\n- Tolerance for the proportion of missed steps: $\\tau = 0.10$.\n- Principles for the adjusted fidelity score, which we denote as $F(R)$ where $R$ is the raw adherence rate:\n    1.  $F(R)=1$ under perfect adherence.\n    2.  $F(R)=0$ under zero adherence.\n    3.  $F(R)$ is constant on the interval of adherence rates where deviations are within the tolerance band.\n    4.  $F(R)$ increases continuously and linearly outside the tolerance band.\n    5.  $F(R)$ is scaled to the unit interval, i.e., $F(R) \\in [0, 1]$.\n\n**1.2. Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the field of Implementation Science, a sub-discipline of translational medicine. The concepts of fidelity, adherence, core components, and the use of a Bernoulli model for trial outcomes are standard and scientifically valid.\n- **Well-Posed**: The problem is well-posed. It provides sufficient data ($a$, $A$, $\\tau$) and a clear set of axiomatic principles to uniquely define the adjusted fidelity score as a function of the raw adherence rate.\n- **Objective**: The problem is stated in precise, objective language. The principles are mathematical constraints, not subjective statements.\n\n**1.3. Verdict and Action**\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or violations of scientific principles. I will proceed with the solution.\n\n### Step 2: Solution Construction\n\n**2.1. Define the Raw Adherence Rate ($R$)**\nThe problem states that the raw adherence rate is the maximum likelihood estimator (MLE) of the parameter $p$ of a Bernoulli process. For $a$ successes in $A$ trials, the likelihood function is $L(p) = \\binom{A}{a} p^a (1-p)^{A-a}$. The log-likelihood is $\\ln L(p) = \\ln\\binom{A}{a} + a\\ln(p) + (A-a)\\ln(1-p)$. To find the MLE, we differentiate with respect to $p$ and set the result to zero:\n$$ \\frac{d}{dp}\\ln L(p) = \\frac{a}{p} - \\frac{A-a}{1-p} = 0 $$\nSolving for $p$ gives the MLE, which we denote as $R$:\n$$ a(1-p) = (A-a)p \\implies a - ap = Ap - ap \\implies a = Ap \\implies p = \\frac{a}{A} $$\nThus, the raw adherence rate is $R = \\frac{a}{A}$.\n\n**2.2. Construct the Adjusted Fidelity Score Function ($F(R)$)**\nWe must construct a function $F(R)$ that maps the raw adherence rate $R \\in [0, 1]$ to an adjusted score in $[0, 1]$, following the given principles.\n\n- **Principle 1 and 2**: $F(1) = 1$ and $F(0) = 0$. These define the boundary conditions of our function.\n\n- **Principle 3 (Tolerance Band)**: Deviations up to a proportion $\\tau$ of missed steps are tolerated. The proportion of missed steps is $1-R$. The condition for being within the tolerance band is $1 - R \\le \\tau$, which is equivalent to $R \\ge 1 - \\tau$. The principle states that $F(R)$ is constant for all $R$ in the interval $[1-\\tau, 1]$. Since this interval includes $R=1$, and we know from Principle 1 that $F(1)=1$, the constant value must be $1$.\nTherefore, for $R \\in [1-\\tau, 1]$, we have $F(R) = 1$.\n\n- **Principle 4 and 5 (Linearity, Continuity, Scaling)**: $F(R)$ increases continuously and linearly *outside* the tolerance band. The region outside the tolerance band is the interval $[0, 1-\\tau)$. On this interval, $F(R)$ must be a linear function, i.e., $F(R) = mR + c$ for some slope $m$ and intercept $c$.\n    - From Principle 2, the function must pass through the origin $(0, 0)$. So, $F(0) = m(0) + c = 0$, which implies $c=0$. The function on this interval is $F(R) = mR$.\n    - The function must be continuous at the point where the two pieces meet, which is $R = 1-\\tau$. This means the value of the linear part must equal the value of the constant part at this point.\n    $$ \\lim_{R \\to (1-\\tau)^-} F(R) = F(1-\\tau) $$\n    $$ m(1-\\tau) = 1 $$\n    - Solving for the slope $m$, we get $m = \\frac{1}{1-\\tau}$.\n\nCombining these findings, the adjusted fidelity score function $F(R)$ is a piecewise function defined as:\n$$ F(R) = \\begin{cases} \\frac{R}{1-\\tau} & \\text{if } 0 \\le R < 1-\\tau \\\\ 1 & \\text{if } 1-\\tau \\le R \\le 1 \\end{cases} $$\nThis function satisfies all the given principles.\n\n**2.3. Calculate the Specific Score**\nNow, we apply this function to the data provided in the problem.\n- Given data: $a=72$, $A=90$, and $\\tau=0.10$.\n\n- First, compute the raw adherence rate $R$:\n$$ R = \\frac{a}{A} = \\frac{72}{90} = \\frac{8 \\times 9}{10 \\times 9} = \\frac{8}{10} = 0.8 $$\n\n- Next, determine the threshold for the tolerance band:\n$$ 1 - \\tau = 1 - 0.10 = 0.9 $$\n\n- Compare the raw adherence rate $R$ to the threshold $1-\\tau$:\n$$ R = 0.8 \\quad \\text{and} \\quad 1-\\tau = 0.9 $$\nSince $0.8 < 0.9$, the raw adherence rate $R$ falls into the lower, linear region of the function, i.e., $R < 1-\\tau$.\n\n- Finally, calculate the adjusted fidelity score $F(R)$ using the linear part of the function:\n$$ F(R) = \\frac{R}{1-\\tau} $$\n$$ F(0.8) = \\frac{0.8}{1 - 0.10} = \\frac{0.8}{0.9} = \\frac{8}{9} $$\n\n- The problem requires the final answer to be rounded to four significant figures.\n$$ \\frac{8}{9} \\approx 0.888888... $$\nRounding to four significant figures gives $0.8889$.\n\nThe adjusted fidelity score for the clinic is $0.8889$.",
            "answer": "$$\\boxed{0.8889}$$"
        },
        {
            "introduction": "Translating evidence into practice is fundamentally a resource allocation problem. This final exercise shifts our focus from measurement to strategic decision-making, framing the selection of implementation strategies as a formal optimization task. By applying the classic 0/1 knapsack framework, you will learn to prioritize a portfolio of strategies to maximize clinical impact within a fixed budget, a critical skill for leadership in translational medicine. ",
            "id": "5010866",
            "problem": "You are designing a portfolio of implementation strategies in translational medicine, where the goal is to integrate evidence-based practices into routine clinical care. For clarity, distinguish between dissemination strategies (which focus on spreading information) and implementation strategies (which focus on changing clinical systems to adopt evidence into practice). The rational resource allocation base is that expected effects across independent, non-overlapping strategies add, and costs add linearly. Let there be $n$ candidate strategies indexed by $i \\in \\{0,1,\\dots,n-1\\}$, each with an estimated effect $e_i$ (unit: persons, interpreted as expected additional patients achieving the target outcome) and cost $c_i$ (unit: United States Dollars (USD)). Each strategy is labeled by a type indicator $d_i \\in \\{0,1\\}$, where $d_i=1$ denotes an implementation strategy and $d_i=0$ denotes a dissemination strategy. You must select only implementation strategies. Define binary decision variables $x_i \\in \\{0,1\\}$ indicating whether strategy $i$ is selected. The budget constraint is $B=\\$500{,}000$.\n\nUnder the base assumptions of additivity and independence, you must choose a subset of implementation strategies that maximizes the expected total effect subject to the budget constraint. Formally, the optimization problem is:\n$$\n\\max_{x_i \\in \\{0,1\\}} \\;\\; \\sum_{i=0}^{n-1} e_i x_i\n$$\nsubject to\n$$\n\\sum_{i=0}^{n-1} c_i x_i \\le B,\\quad x_i \\le d_i \\;\\; \\text{for all } i.\n$$\nTie-breaking rules must be applied to ensure a unique, reproducible solution: among solutions that achieve the same maximum objective value, choose the one with the smallest total cost; if there is still a tie, choose the solution whose sorted list of selected indices is lexicographically smallest.\n\nComputational requirement: treat costs $c_i$ and budget $B$ as integer multiples of $\\$1{,}000$. Internally, scale costs and budget by dividing by $1{,}000$ so that the capacity is measured in units of $\\$1{,}000$. All effects $e_i$ are integers, and the expected total effect must be returned as an integer count of persons.\n\nImplement a program that, for each given test case, returns the unique optimal selection of implementation strategies under the above constraints and tie-breaking rules. Each test case is specified by:\n- The fixed budget $B=\\$500{,}000$.\n- A list of $c_i$ in USD, each a multiple of $\\$1{,}000$.\n- A list of $e_i$ in persons (integers).\n- A list of $d_i \\in \\{0,1\\}$ indicating strategy type (implementation if $1$, dissemination if $0$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a two-element list $[\\text{sorted\\_indices}, \\text{total\\_effect}]$. The first element $\\text{sorted\\_indices}$ is the sorted list of selected strategy indices, and the second element $\\text{total\\_effect}$ is the integer sum $\\sum_i e_i x_i$. For example, a valid single-line output for three cases would look like: $[[[0,1],350],[[2],220],[[1,3,4],780]]$.\n\nUse the following test suite. In all cases, $B=\\$500{,}000$.\n\nTest Case 1 (happy path with mixed types):\n- $c = [\\$120{,}000,\\; \\$80{,}000,\\; \\$60{,}000,\\; \\$200{,}000,\\; \\$150{,}000,\\; \\$90{,}000,\\; \\$110{,}000,\\; \\$140{,}000]$\n- $e = [240,\\; 150,\\; 90,\\; 430,\\; 300,\\; 200,\\; 220,\\; 260]$\n- $d = [1,\\; 1,\\; 0,\\; 1,\\; 0,\\; 1,\\; 1,\\; 1]$\n\nTest Case 2 (boundary where total implementation cost equals budget):\n- $c = [\\$125{,}000,\\; \\$75{,}000,\\; \\$150{,}000,\\; \\$150{,}000]$\n- $e = [200,\\; 120,\\; 190,\\; 230]$\n- $d = [1,\\; 1,\\; 1,\\; 1]$\n\nTest Case 3 (trade-off: one very high-cost high-effect versus several moderate options):\n- $c = [\\$500{,}000,\\; \\$120{,}000,\\; \\$120{,}000,\\; \\$120{,}000,\\; \\$120{,}000,\\; \\$50{,}000]$\n- $e = [900,\\; 260,\\; 255,\\; 250,\\; 200,\\; 80]$\n- $d = [1,\\; 1,\\; 1,\\; 1,\\; 1,\\; 1]$\n\nTest Case 4 (edge case with a zero-cost implementation strategy):\n- $c = [\\$0,\\; \\$100{,}000,\\; \\$200{,}000,\\; \\$180{,}000,\\; \\$50{,}000]$\n- $e = [40,\\; 300,\\; 450,\\; 390,\\; 120]$\n- $d = [1,\\; 1,\\; 1,\\; 1,\\; 1]$\n\nTest Case 5 (tie case to exercise the lexicographic rule):\n- $c = [\\$250{,}000,\\; \\$250{,}000,\\; \\$200{,}000,\\; \\$200{,}000,\\; \\$100{,}000,\\; \\$50{,}000]$\n- $e = [500,\\; 500,\\; 400,\\; 400,\\; 200,\\; 50]$\n- $d = [1,\\; 1,\\; 1,\\; 1,\\; 1,\\; 1]$\n\nYour program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets, with each result formatted as $[\\text{sorted\\_indices}, \\text{total\\_effect}]$, in the same order as specified above. For example, the final output should look like $[[[i\\_case1],E\\_case1],[[i\\_case2],E\\_case2],[[i\\_case3],E\\_case3],[[i\\_case4],E\\_case4],[[i\\_case5],E\\_case5]]$ with actual integers replacing placeholders, and no additional whitespace or text.",
            "solution": "The problem presented is a constrained optimization task, formally equivalent to the 0/1 Knapsack Problem, set within the context of resource allocation in translational medicine. We are asked to select a subset of implementation strategies to maximize the total expected effect (number of patients with a target outcome) under a fixed budget, with specific tie-breaking rules to ensure a unique solution.\n\nFirst, we must validate the problem statement.\n\n**Step 1: Extract Givens**\n- Number of strategies: $n$.\n- Strategy index: $i \\in \\{0, 1, \\dots, n-1\\}$.\n- Strategy effect: $e_i$ (integer, persons).\n- Strategy cost: $c_i$ (USD, multiple of $\\$1{,}000$).\n- Strategy type indicator: $d_i \\in \\{0, 1\\}$, where $d_i=1$ for implementation strategies.\n- Decision variables: $x_i \\in \\{0, 1\\}$, where $x_i=1$ if strategy $i$ is selected.\n- Total budget: $B = \\$500{,}000$.\n- Optimization problem:\n  $$\n  \\max_{x_i \\in \\{0,1\\}} \\;\\; \\sum_{i=0}^{n-1} e_i x_i\n  $$\n  subject to:\n  $$\n  \\sum_{i=0}^{n-1} c_i x_i \\le B\n  $$\n  $$\n  x_i \\le d_i \\;\\; \\forall i \\in \\{0, 1, \\dots, n-1\\}\n  $$\n- Computational scaling: Costs $c_i$ and budget $B$ are to be scaled by dividing by $1{,}000$.\n- Tie-breaking rules for uniqueness:\n  1.  Maximize total effect $\\sum e_i x_i$.\n  2.  Among solutions with maximal effect, minimize total cost $\\sum c_i x_i$.\n  3.  Among solutions that are still tied, choose the one whose sorted list of selected strategy indices is lexicographically smallest.\n- Test cases: Five distinct test cases are provided with lists for $c$, $e$, and $d$.\n- Output format: A single-line, comma-separated list of results, where each result is a two-element list containing the sorted list of selected indices and the total effect: `[[sorted_indices], total_effect]`.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is a well-established integer linear programming model (0/1 Knapsack Problem) applied to a realistic scenario of project portfolio optimization. The assumptions of additive effects and linear costs are standard simplifications in such models. The problem is scientifically and mathematically sound.\n- **Well-Posed**: The problem is clearly defined with an objective function, explicit constraints, and a complete set of data for each test case. The three-tiered tie-breaking rule ensures that a unique solution exists for any given input, making the problem well-posed.\n- **Objective**: The problem is stated in precise, formal mathematical language, free from subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, scientifically grounded optimization task. We may proceed with formulating a solution.\n\n**Principle-Based Solution Design**\n\n**1. Preprocessing**\nFirst, we filter the strategies to consider only implementation strategies, i.e., those with $d_i=1$. We also scale the costs and budget as required. Let the set of available implementation strategies be $S$, where each element is a tuple `(scaled_cost, effect, original_index)`. For our algorithm to correctly handle the lexicographical tie-breaking rule, it is crucial that we process these strategies in the order of their original indices, $i=0, 1, 2, \\dots$. Let there be $m$ such strategies. The scaled budget is $B' = B / 1000 = 500$.\n\n**2. Dynamic Programming Formulation**\nWe will use a 2D DP table, $dp[k][w]$, to find the optimal solution. The state $dp[k][w]$ will represent the best achievable outcome using a subset of strategies from index $k$ to $m-1$ with a maximum budget of $w$. To handle the first two tie-breaking rules (maximize effect, then minimize cost), each cell in our DP table will store a tuple: $(effect, cost)$.\n\nLet the set of implementation strategies be indexed from $k=0$ to $m-1$. The DP table will have dimensions $(m+1) \\times (B' + 1)$. We fill this table backwards, from $k=m$ up to $k=0$.\n\nThe base case is for $k=m$, which corresponds to using no strategies.\n$$dp[m][w] = (0, 0) \\quad \\text{for all } w \\in \\{0, 1, \\dots, B'\\}$$\n\nFor the recursive step, we compute $dp[k][w]$ for $k \\in \\{m-1, \\dots, 0\\}$ and $w \\in \\{0, \\dots, B'\\}$. For each strategy $k$ with properties $(c_k, e_k, i_k)$, we have two choices:\n-  **Do not include strategy $k$**: The solution is the best one achievable with strategies $k+1, \\dots, m-1$ and budget $w$. This is given by $dp[k+1][w]$.\n-  **Include strategy $k$**: This is only possible if its cost $c_k \\le w$. If so, the resulting effect and cost are the sum of strategy $k$'s contribution and the best solution for the remaining strategies with the remaining budget. This is $(e_k + dp[k+1][w-c_k].\\text{effect}, c_k + dp[k+1][w-c_k].\\text{cost})$.\n\nWe compare these two options. Let $S_1 = (e_1, c_1)$ and $S_2 = (e_2, c_2)$. $S_1$ is better than $S_2$ if ($e_1 > e_2$) or ($e_1=e_2$ and $c_1 < c_2$).\n$$\ndp[k][w] = \\text{better_of}(\\text{solution_without_k}, \\text{solution_with_k})\n$$\n\n**3. Finding the Optimal Outcome**\nAfter filling the entire DP table, the optimal solution is not necessarily $dp[0][B']$, as the best portfolio might not use the full budget. We must find the overall best solution by inspecting all possible budget usages in the first row of the table. We search through $dp[0][w]$ for all $w \\in \\{0, \\dots, B'\\}$ to find the globally optimal tuple $(E^*, C^*)$ according to our comparison criteria.\n\n**4. Reconstruction for Lexicographical Tie-breaking**\nThis is the most critical step. Having found the target optimal values $(E^*, C^*)$, we must reconstruct the specific set of strategies that achieves this result and satisfies the lexicographical tie-breaking rule.\n\nWe iterate through the strategies from $k=0$ to $m-1$ (i.e., in increasing order of their original indices). At each step $k$, we decide whether to include strategy $k$ in our final solution.\nLet our current target be $(E_{rem}, C_{rem})$ with a remaining budget of $w_{rem}$. Initially, these are $(E^*, C^*, B')$.\nFor strategy $k$, with properties $(c_k, e_k, i_k)$:\nWe check if including strategy $k$ can lead to our target solution. This is true if including it, combined with the optimal solution for the rest of the items ($k+1, \\dots, m-1$) with the remaining budget ($w_{rem}-c_k$), yields the current optimal solution we are tracking from our table, i.e., $dp[k][w_{rem}]$.\n\nFormally, we check if $w_{rem} \\ge c_k$ and if the solution from taking item $k$, $(e_k + dp[k+1][w_{rem}-c_k].\\text{effect}, c_k + dp[k+1][w_{rem}-c_k].\\text{cost})$, is identical to $dp[k][w_{rem}]$.\n\nIf this condition holds, it means there exists an optimal path that includes strategy $k$. Because we are iterating through strategies in increasing order of their original indices ($i_0 < i_1 < \\dots$), this greedy choice of including the current strategy $k$ guarantees that we are constructing the lexicographically smallest set of indices. Upon deciding to include strategy $k$, we add its original index $i_k$ to our result set, and update our tracking variables:\n- $w_{rem} \\leftarrow w_{rem} - c_k$\n- $E_{rem} \\leftarrow E_{rem} - e_k$\n- $C_{rem} \\leftarrow C_{rem} - c_k$\n\nIf the condition does not hold, we must not have included strategy $k$, so we proceed to the next strategy $k+1$ with unchanged tracking variables. This process is repeated until all strategies are considered, yielding the unique optimal set of indices. The total effect is simply $E^*$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the portfolio optimization problem for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"c\": [120000, 80000, 60000, 200000, 150000, 90000, 110000, 140000],\n            \"e\": [240, 150, 90, 430, 300, 200, 220, 260],\n            \"d\": [1, 1, 0, 1, 0, 1, 1, 1],\n        },\n        {\n            \"c\": [125000, 75000, 150000, 150000],\n            \"e\": [200, 120, 190, 230],\n            \"d\": [1, 1, 1, 1],\n        },\n        {\n            \"c\": [500000, 120000, 120000, 120000, 120000, 50000],\n            \"e\": [900, 260, 255, 250, 200, 80],\n            \"d\": [1, 1, 1, 1, 1, 1],\n        },\n        {\n            \"c\": [0, 100000, 200000, 180000, 50000],\n            \"e\": [40, 300, 450, 390, 120],\n            \"d\": [1, 1, 1, 1, 1],\n        },\n        {\n            \"c\": [250000, 250000, 200000, 200000, 100000, 50000],\n            \"e\": [500, 500, 400, 400, 200, 50],\n            \"d\": [1, 1, 1, 1, 1, 1],\n        }\n    ]\n\n    budget = 500000\n    results = []\n    \n    for case in test_cases:\n        result = _solve_knapsack(budget, case[\"c\"], case[\"e\"], case[\"d\"])\n        results.append(result)\n\n    # The final output is a string representation of the list of results\n    final_output = \"[\" + \",\".join(map(str, results)) + \"]\"\n    # Python's default str() for lists uses spaces, e.g., '[1, 2]'.\n    # The problem example implies no spaces. Let's remove them.\n    final_output = final_output.replace(\" \", \"\")\n    print(final_output)\n\ndef _solve_knapsack(budget, costs, effects, types):\n    \"\"\"\n    Solves the 0/1 knapsack problem with custom tie-breaking rules.\n    \n    This function implements a dynamic programming solution to find the subset\n    of implementation strategies that maximizes effect under a budget,\n    resolving ties by minimizing cost, and then by lexicographically smallest\n    index set.\n\n    Args:\n        budget (int): Total budget in USD.\n        costs (list[int]): Costs of all strategies.\n        effects (list[int]): Effects of all strategies.\n        types (list[int]): Type indicators (1 for implementation).\n\n    Returns:\n        list: A two-element list containing the sorted list of selected indices\n              and the total effect.\n    \"\"\"\n    \n    budget_scaled = budget // 1000\n    \n    # 1. Preprocessing: Filter for implementation strategies and scale costs.\n    # The items are implicitly sorted by their original index.\n    items = []\n    for i in range(len(costs)):\n        if types[i] == 1:\n            items.append({\n                \"cost\": costs[i] // 1000,\n                \"effect\": effects[i],\n                \"index\": i\n            })\n    \n    num_items = len(items)\n    # dp[k][w] stores (effect, cost) for items k...m-1 with budget w\n    dp = np.full((num_items + 1, budget_scaled + 1, 2), -1, dtype=int)\n    \n    # Base case: for k=num_items (no items left), effect and cost are 0.\n    dp[num_items, :, :] = 0\n\n    # 2. DP Table Construction\n    # Iterate backwards from the last item to the first.\n    for k in range(num_items - 1, -1, -1):\n        item_cost = items[k][\"cost\"]\n        item_effect = items[k][\"effect\"]\n        \n        for w in range(budget_scaled + 1):\n            # Option 1: Don't include item k.\n            sol_without = dp[k + 1, w]\n            \n            # Option 2: Include item k (if possible).\n            if w >= item_cost:\n                prev_sol = dp[k + 1, w - item_cost]\n                sol_with_effect = item_effect + prev_sol[0]\n                sol_with_cost = item_cost + prev_sol[1]\n                \n                # Tie-breaking logic: max effect, then min cost.\n                is_better = False\n                if sol_with_effect > sol_without[0]:\n                    is_better = True\n                elif sol_with_effect == sol_without[0] and sol_with_cost < sol_without[1]:\n                    is_better = True\n                \n                if is_better:\n                    dp[k, w] = [sol_with_effect, sol_with_cost]\n                else:\n                    dp[k, w] = sol_without\n            else:\n                # Cannot afford to include item k.\n                dp[k, w] = sol_without\n\n    # 3. Find Optimal Target Outcome\n    # The best solution may not use the full budget. Search across all budgets.\n    best_effect = -1\n    best_cost = -1\n    \n    for w in range(budget_scaled + 1):\n        current_effect, current_cost = dp[0, w]\n        if current_effect > best_effect:\n            best_effect = current_effect\n            best_cost = current_cost\n        elif current_effect == best_effect and current_cost < best_cost:\n            best_cost = current_cost\n    \n    # 4. Reconstruction\n    # Trace back to find the lexicographically smallest index set.\n    selected_indices = []\n    current_budget = budget_scaled\n    \n    for k in range(num_items):\n        item = items[k]\n        \n        # Check if taking the current item is part of an optimal path to the target.\n        # This decision prioritizes smaller indices, satisfying the third tie-breaker.\n        sol_without = dp[k + 1, current_budget]\n        \n        # Determine if taking the item is the choice made in the DP table for dp[k][current_budget]\n        took_item = False\n        if current_budget >= item['cost']:\n            sol_from_rest = dp[k+1, current_budget - item['cost']]\n            potential_effect = item['effect'] + sol_from_rest[0]\n            potential_cost = item['cost'] + sol_from_rest[1]\n            \n            # If the solution by taking the item is the one stored, it means we took it.\n            if dp[k, current_budget][0] == potential_effect and dp[k, current_budget][1] == potential_cost:\n                took_item = True\n        \n        if took_item:\n            selected_indices.append(item['index'])\n            current_budget -= item['cost']\n\n    return [selected_indices, best_effect if best_effect != -1 else 0]\n\nsolve()\n```"
        }
    ]
}