{
    "hands_on_practices": [
        {
            "introduction": "大流行病的有效准备有赖于高效的监测以早期发现威胁。当检测资源有限时，尤其是在疫情爆发初期，合并检测（或称“混合样本检测”）策略提供了一种强大的扩大检测能力的方法。本练习将引导您推导一个最优的合并策略，展示公共卫生后勤中资源优化的核心原则 。",
            "id": "5073896",
            "problem": "一家公共卫生实验室正在设计一种两阶段混合检测方案（Dorfman pooling），以在疫情大流行的早期阶段扩大用于呼吸道病毒监测的逆转录定量聚合酶链式反应（RT-qPCR）的能力。假设有一个大小为 $N$ 的大型筛查队列，其中每个个体具有独立的感染概率 $p$，并且分析验证已证实，对于所考虑的分组大小，混合检测相对于个体检测不会降低灵敏度或特异性。在第一阶段，实验室检测通过将 $N$ 个个体划分为大小相等的 $g \\in \\mathbb{N}$ 组而形成的混合样本；每组进行一次混合检测。在第二阶段，对任何第一阶段呈阳性的组中的每个个体进行单独检测。令 $E[T](g,p)$ 表示在此两阶段方案下每位个体的预期检测次数。\n\n从独立伯努利试验的概率第一性原理和期望的定义出发，推导 $E[T](g,p)$ 的闭式表达式，然后，对于 $p=0.01$，确定使 $E[T](g,p)$ 最小化的最优整数分组大小 $g$。最后，量化最优混合策略相对于个体检测的效率增益，该增益定义为个体检测下的预期检测次数与最优 $g$ 下混合策略的预期检测次数之比。报告最优 $g$ 和效率增益。将效率增益四舍五入到四位有效数字。将效率增益表示为无量纲数（无单位）。",
            "solution": "问题陈述经评估有效。它在科学上基于概率论原理及其在公共卫生后勤（特别是 Dorfman 混合检测）中的应用。问题提法得当、客观，并包含推导出唯一且有意义的解所需的所有信息。\n\n推导过程如下。\n\n首先，我们推导每位个体的预期检测次数 $E[T](g,p)$ 的闭式表达式。\n筛查方案包括两个阶段。我们考虑一个由 $N$ 个个体组成的队列，划分为 $\\frac{N}{g}$ 个大小为 $g$ 的组。每个个体的感染状态是一个独立的伯努利试验，感染概率为 $p$。\n\n随机选择的个体未感染的概率是 $1-p$。\n当且仅当一个大小为 $g$ 的组中的所有 $g$ 个个体均未感染时，该组在第一阶段的检测结果为阴性。由于独立性假设，一组检测结果为阴性的概率是 $(1-p)^g$。\n\n如果至少有一个体被感染，则该组在第一阶段检测结果为阳性。此事件的概率，我们记为 $P_{pos}$，是该组检测为阴性的补集：\n$$P_{pos} = 1 - (1-p)^g$$\n\n检测总次数 $T_{total}$ 是第一阶段和第二阶段检测次数的总和。\n在第一阶段，对 $\\frac{N}{g}$ 个组中的每一个进行一次检测。因此，第一阶段的检测次数确定为 $\\frac{N}{g}$。\n在第二阶段，对第一阶段检测呈阳性的每个组中的所有 $g$ 个成员进行个体检测。令 $K$ 为阳性组数的随机变量。第二阶段的检测次数为 $gK$。\n\n检测总次数为 $T_{total} = \\frac{N}{g} + gK$。\n我们需要总检测次数的期望值 $E[T_{total}]$。根据期望的线性性质：\n$$E[T_{total}] = E\\left[\\frac{N}{g} + gK\\right] = \\frac{N}{g} + gE[K]$$\n阳性组数 $K$ 服从二项分布，$K \\sim \\text{Binomial}\\left(n=\\frac{N}{g}, q=P_{pos}\\right)$，因为 $\\frac{N}{g}$ 个组中的每一个都代表一次独立的试验。二项分布的期望值是 $nq$。因此，阳性组数的期望值为：\n$$E[K] = \\frac{N}{g} \\times P_{pos} = \\frac{N}{g}\\left(1 - (1-p)^g\\right)$$\n将此代入 $E[T_{total}]$ 的表达式中：\n$$E[T_{total}] = \\frac{N}{g} + g\\left[\\frac{N}{g}\\left(1 - (1-p)^g\\right)\\right] = \\frac{N}{g} + N\\left(1 - (1-p)^g\\right)$$\n问题要求的是每个个体的预期检测次数 $E[T](g,p)$，即 $E[T_{total}]$ 除以个体总数 $N$：\n$$E[T](g,p) = \\frac{E[T_{total}]}{N} = \\frac{1}{N}\\left(\\frac{N}{g} + N\\left(1 - (1-p)^g\\right)\\right)$$\n简化此表达式得到所需的闭式形式：\n$$E[T](g,p) = \\frac{1}{g} + 1 - (1-p)^g$$\n\n其次，我们确定在 $p=0.01$ 的情况下，使 $E[T](g,p)$ 最小化的最优整数分组大小 $g$。\n需要最小化的函数是：\n$$f(g) = E[T](g, 0.01) = \\frac{1}{g} + 1 - (0.99)^g$$\n其中 $g$ 是一个整数 $g \\ge 2$。为了找到最小值的近似位置，我们可以将 $g$ 视为一个连续变量，并找到其导数为零的位置。\n$$f'(g) = -\\frac{1}{g^2} - (0.99)^g \\ln(0.99) = 0$$\n这导致方程 $g^2 (0.99)^g = -1/\\ln(0.99)$。对于小的 $p$，一个常见的近似是 $g_{opt} \\approx \\frac{1}{\\sqrt{p}}$。对于 $p=0.01$，这给出 $g_{opt} \\approx \\frac{1}{\\sqrt{0.01}} = \\frac{1}{0.1} = 10$。这表明真正的整数最小值接近 10。我们测试该值附近的整数 $g$。\n对于 $g=10$：\n$$E[T](10, 0.01) = \\frac{1}{10} + 1 - (0.99)^{10} \\approx 0.1 + 1 - 0.904382075 \\approx 0.195617925$$\n对于 $g=11$：\n$$E[T](11, 0.01) = \\frac{1}{11} + 1 - (0.99)^{11} \\approx 0.090909091 + 1 - 0.895338254 \\approx 0.195570837$$\n对于 $g=12$：\n$$E[T](12, 0.01) = \\frac{1}{12} + 1 - (0.99)^{12} \\approx 0.083333333 + 1 - 0.886384871 \\approx 0.196948462$$\n比较这些值，$E[T](g, 0.01)$ 在 $g=11$ 时最小。因此，最优整数分组大小为 $g_{opt} = 11$。\n\n最后，我们量化效率增益。这是个体检测的预期检测次数与最优混合策略的预期检测次数之比。\n个体检测中每个个体的预期检测次数为 $1$。\n最优混合策略中每个个体的预期检测次数为 $E[T](11, 0.01) \\approx 0.195570837$。\n效率增益 $\\eta$ 为：\n$$\\eta = \\frac{1}{E[T](11, 0.01)} = \\frac{1}{\\frac{1}{11} + 1 - (0.99)^{11}} \\approx \\frac{1}{0.195570837} \\approx 5.113238$$\n按要求四舍五入到四位有效数字，效率增益为 5.113。\n\n所要求的两个结果是：最优分组大小 11，以及效率增益 5.113。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 11  5.113 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一旦检测到新的病毒变种，关键的下一步是量化其潜在威胁，特别是其相对于现有毒株的传播优势。通过对基因组监测数据进行实时分析，我们可以通过比较不同变种的指数增长率来估算这种“选择优势”。本练习让您亲手实践一种用于表征新兴变种并为公共卫生对策提供信息的关键方法 。",
            "id": "5073938",
            "problem": "在两种严重急性呼吸综合征冠状病毒2（SARS-CoV-2）变体共同传播的早期阶段，在一个均匀混合、公共卫生措施稳定且代际时间分布相同的人群中，通过哨点聚合酶链式反应（PCR）检测观察到每种变体的发病率均遵循指数增长。设旧变体导致的每日发病率为 $I_{\\text{old}}(t)$，新变体导致的每日发病率为 $I_{\\text{new}}(t)$，其中 $I_{\\text{old}}(t) = I_{\\text{old}}(0)\\,\\exp(r_{\\text{old}} t)$ 且 $I_{\\text{new}}(t) = I_{\\text{new}}(0)\\,\\exp(r_{\\text{new}} t)$，而 $r_{\\text{old}}$ 和 $r_{\\text{new}}$ 是恒定的马尔萨斯日增长率。将新变体在新增病例中的频率定义为 $p(t) = \\dfrac{I_{\\text{new}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)}$。仅使用这些定义以及在所考虑的时间窗口内共同传播不引起密度依赖性的假设，通过分析比值 $\\dfrac{p(t)}{1 - p(t)}$ 的时间演变，推导新变体相对于旧变体的单位时间选择优势 $s$ 的表达式，用 $r_{\\text{new}}$ 和 $r_{\\text{old}}$ 表示。然后，计算当 $r_{\\text{new}} = 0.15$ 和 $r_{\\text{old}} = 0.08$ 时的 $s$ 值。将最终估算值以 day$^{-1}$ 为单位表示，并将您的数值答案四舍五入至三位有效数字。最终方框内的答案必须是不带单位的单个实数。",
            "solution": "在尝试解答之前，对问题陈述的有效性进行评估。\n\n### 步骤1：提取已知条件\n- 两种SARS-CoV-2变体（旧变体和新变体）在均匀混合的人群中共同传播。\n- 公共卫生措施稳定。\n- 两种变体的代际时间分布相同。\n- 每种变体的发病率遵循指数增长。\n- 旧变体的每日发病率：$I_{\\text{old}}(t) = I_{\\text{old}}(0)\\,\\exp(r_{\\text{old}} t)$。\n- 新变体的每日发病率：$I_{\\text{new}}(t) = I_{\\text{new}}(0)\\,\\exp(r_{\\text{new}} t)$。\n- $r_{\\text{old}}$ 和 $r_{\\text{new}}$ 是恒定的马尔萨斯日增长率。\n- 新变体在新增病例中的频率：$p(t) = \\dfrac{I_{\\text{new}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)}$。\n- 假设：在时间窗口内无密度依赖性。\n- 任务1：通过分析比值 $\\dfrac{p(t)}{1 - p(t)}$ 的时间演变，推导单位时间选择优势 $s$ 关于 $r_{\\text{new}}$ 和 $r_{\\text{old}}$ 的表达式。\n- 任务2：计算当 $r_{\\text{new}} = 0.15$ day$^{-1}$ 和 $r_{\\text{old}} = 0.08$ day$^{-1}$ 时的 $s$。\n- 任务3：将最终数值答案四舍五入至三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它采用了传染病流行病学和病毒进化中使用的竞争性病原体增长的标准简化模型。马尔萨斯增长模型 ($I(t) = I_0 \\exp(rt)$) 是在易感人群耗尽或其他密度依赖性因素变得显著之前，对流行病早期的有效近似。变体频率 $p(t)$ 的定义是标准的。对比值 $p(t)/(1-p(t))$ 及其对数（logit变换）的分析是群体遗传学和流行病学中量化选择的经典方法。选择优势 $s$ 作为指数增长率之差的概念是该模型的直接和基本推论。该问题提供了所有必要的定义和数据，没有矛盾，并要求进行标准的推导和计算。给定的增长率值是符合实际的。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 解题推导\n问题要求通过分析新变体频率的比值的时间演变来推导选择优势 $s$。设比值为 $O(t)$。比值定义为新变体频率 $p(t)$ 与旧变体频率 $1-p(t)$ 之比。\n\n$$\nO(t) = \\frac{p(t)}{1 - p(t)}\n$$\n\n首先，我们用两种变体的发病率 $I_{\\text{new}}(t)$ 和 $I_{\\text{old}}(t)$ 来表示比值。使用提供的 $p(t)$ 定义：\n\n$$\np(t) = \\frac{I_{\\text{new}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)}\n$$\n\n因此，旧变体的频率为：\n$$\n1 - p(t) = 1 - \\frac{I_{\\text{new}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)} = \\frac{I_{\\text{new}}(t) + I_{\\text{old}}(t) - I_{\\text{new}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)} = \\frac{I_{\\text{old}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)}\n$$\n\n现在，我们通过求比来计算比值 $O(t)$：\n$$\nO(t) = \\frac{\\frac{I_{\\text{new}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)}}{\\frac{I_{\\text{old}}(t)}{I_{\\text{new}}(t) + I_{\\text{old}}(t)}} = \\frac{I_{\\text{new}}(t)}{I_{\\text{old}}(t)}\n$$\n\n接下来，我们将给定的发病率指数增长模型代入：\n$$\nI_{\\text{new}}(t) = I_{\\text{new}}(0)\\,\\exp(r_{\\text{new}} t)\n$$\n$$\nI_{\\text{old}}(t) = I_{\\text{old}}(0)\\,\\exp(r_{\\text{old}} t)\n$$\n\n将这些代入比值的表达式中得到：\n$$\nO(t) = \\frac{I_{\\text{new}}(0)\\,\\exp(r_{\\text{new}} t)}{I_{\\text{old}}(0)\\,\\exp(r_{\\text{old}} t)}\n$$\n\n通过合并指数项并确定初始比值 $O(0) = \\frac{I_{\\text{new}}(0)}{I_{\\text{old}}(0)}$，可以简化此表达式：\n$$\nO(t) = \\frac{I_{\\text{new}}(0)}{I_{\\text{old}}(0)} \\exp(r_{\\text{new}} t - r_{\\text{old}} t) = O(0) \\exp\\left( (r_{\\text{new}} - r_{\\text{old}}) t \\right)\n$$\n\n为了按要求分析时间演变，我们取比值的自然对数（这是频率 $p(t)$ 的 logit 变换）：\n$$\n\\ln(O(t)) = \\ln\\left( O(0) \\exp\\left( (r_{\\text{new}} - r_{\\text{old}}) t \\right) \\right)\n$$\n$$\n\\ln(O(t)) = \\ln(O(0)) + \\ln\\left( \\exp\\left( (r_{\\text{new}} - r_{\\text{old}}) t \\right) \\right)\n$$\n$$\n\\ln(O(t)) = \\ln(O(0)) + (r_{\\text{new}} - r_{\\text{old}}) t\n$$\n\n该方程表明，比值的自然对数随时间 $t$ 线性增长。选择优势 $s$ 定义为对数比值的增长率。在数学上，这是 $\\ln(O(t))$ 对时间的导数：\n$$\ns = \\frac{d}{dt} \\ln(O(t)) = \\frac{d}{dt} \\left[ \\ln(O(0)) + (r_{\\text{new}} - r_{\\text{old}}) t \\right]\n$$\n由于 $\\ln(O(0))$ 是一个关于时间的常数，其导数为零。\n$$\ns = r_{\\text{new}} - r_{\\text{old}}\n$$\n这就是所求的单位时间选择优势 $s$ 关于两种变体的马尔萨斯增长率的表达式。\n\n### 数值计算\n我们已知增长率的值：\n$r_{\\text{new}} = 0.15$ day$^{-1}$\n$r_{\\text{old}} = 0.08$ day$^{-1}$\n\n将这些值代入推导出的 $s$ 表达式中：\n$$\ns = 0.15 - 0.08 = 0.07\n$$\n$s$ 的单位是 day$^{-1}$。问题要求将数值答案四舍五入到三位有效数字。计算出的值为 $0.07$。为了用三位有效数字表示，我们必须添加后缀零。\n$$\ns = 0.0700 \\, \\text{day}^{-1}\n$$\n\n最终的数值答案是 $0.0700$。",
            "answer": "$$\n\\boxed{0.0700}\n$$"
        },
        {
            "introduction": "大规模疫苗接种运动的最终目标是实现群体免疫，从而阻止疫情的增长。计算所需的疫苗接种覆盖率是公共卫生规划的基石，而这一计算必须同时考虑病毒的内在传播能力（$R_0$）和疫苗的效力。本问题将引导您从第一性原理出发，推导“非全或无”（leaky）疫苗（一种常见且现实的疫苗模型）的群体免疫阈值 。",
            "id": "5073913",
            "problem": "一个国家级应急管理团队正在为一个新出现的呼吸道病原体规划流行前阶段的疫苗分配。现场调查和早期聚集性病例分析估计，在没有干预措施的情况下，基本再生数 ($R_0$) 为 $R_0 = 3$。一项大规模疫苗接种运动将部署一种单剂次产品，该产品被明确定义为一种“渗漏型”疫苗：它以一个恒定的比例降低接种者对感染的易感性，其疫苗效力 (VE) = $0.8$，并且在发生突破性感染时，不会改变其传染性或传染期。假设种群内均匀混合、在病原体引入前瞬时完成疫苗接种、在相关时间范围内免疫力无减退，并且为封闭种群。\n\n仅使用基本再生数 ($R_0$) 的基本定义，即一个典型传染者被引入一个完全易感的种群中所产生的预期二次病例数，以及流行病早期增长的条件是有效再生数 ($R_{\\mathrm{eff}}$) 超过 $1$，请从第一性原理出发，推导在上述渗漏型疫苗假设下，为防止流行病增长（即实现群体免疫）所需的最低疫苗覆盖率 $p^{\\ast}$（占总人口的比例）。然后，计算当 $R_0 = 3$ 和 $\\mathrm{VE} = 0.8$ 时的 $p^{\\ast}$ 值。\n\n将最终的最低疫苗覆盖率表示为单个小数或单个精确分数（不带百分号）。如果选择小数，请将答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个数学流行病学问题。我将首先根据指定标准验证问题陈述。\n\n### 第1步：提取已知条件\n- 基本再生数：$R_0 = 3$。\n- 疫苗类型：单剂次“渗漏型”疫苗。\n- 疫苗效力 (VE)：$\\mathrm{VE} = 0.8$。这被定义为对感染易感性的恒定比例降低。\n- 疫苗特性：在突破性感染后，不改变传染性或传染期。\n- 模型假设：\n    - 封闭种群内均匀混合。\n    - 在病原体引入前瞬时完成接种。\n    - 在相关时间范围内免疫力无减退。\n- 基本定义：\n    - $R_0$ 是一个典型传染者在完全易感人群中产生的预期二次病例数。\n    - 流行病增长的条件是 $R_{\\mathrm{eff}} > 1$，其中 $R_{\\mathrm{eff}}$ 是有效再生数。\n- 目标：推导为防止流行病增长（$R_{\\mathrm{eff}} \\le 1$）所需的最低疫苗覆盖率 $p^{\\ast}$，然后根据给定参数计算其值。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地基于传染病流行病学的基本原理。$R_0$、$R_{\\mathrm{eff}}$、群体免疫和渗漏型疫苗等概念在该领域都是标准概念。\n- **适定性**：该问题是适定的。它提供了所有必要的参数（$R_0$、$\\mathrm{VE}$）和一个明确的目标（推导使 $R_{\\mathrm{eff}} \\le 1$ 的 $p^{\\ast}$）。这些假设虽然是理想化的，但它们构成了一个具有唯一解的可解数学模型。\n- **客观性**：问题以精确、客观和定量的术语陈述。\n- **结论**：该问题有效。这是一个理论流行病学中的标准且定义明确的问题，植根于既定的科学概念。它没有违反任何无效标准。\n\n### 第3步：结论与行动\n该问题有效。我现在将进行推导和求解。\n\n防止流行病增长的核心原则是确保有效再生数 $R_{\\mathrm{eff}}$ 小于或等于 $1$。$R_{\\mathrm{eff}}$ 表示在具有一定预存免疫力的人群中，单个传染者所引起的平均二次感染数。它被定义为基本再生数 $R_0$ 与人群中易感个体比例 $s$ 的乘积。\n$$R_{\\mathrm{eff}} = R_0 \\cdot s$$\n预防流行病的临界阈值为 $R_{\\mathrm{eff}} \\le 1$。最低疫苗覆盖率 $p^{\\ast}$ 将是实现 $R_{\\mathrm{eff}} = 1$ 时的覆盖率。\n\n我们必须在渗漏型疫苗模型下，推导出人群的有效易感比例 $s$ 的表达式。设 $p$ 为已接种疫苗的人群比例。因此，比例为 $(1-p)$ 的人群未接种疫苗。\n\n未接种疫苗的个体对病原体完全易感。他们的相对易感性为 $1$。\n\n接种疫苗的个体受到部分保护。问题指出，疫苗的效力为 $\\mathrm{VE}$，它能将易感性降低一个恒定的比例。因此，接种疫苗个体的剩余易感性为 $(1 - \\mathrm{VE})$。\n\n人群的总有效易感比例 $s$ 是未接种疫苗和已接种疫苗亚群易感性的加权和：\n$$s = (1-p) \\cdot 1 + p \\cdot (1 - \\mathrm{VE})$$\n展开并简化此表达式：\n$$s = 1 - p + p - p \\cdot \\mathrm{VE}$$\n$$s = 1 - p \\cdot \\mathrm{VE}$$\n现在，我们可以将这个 $s$ 的表达式代入群体免疫阈值条件 $R_{\\mathrm{eff}} = 1$ 中，并令 $p = p^{\\ast}$ 来表示临界疫苗覆盖率。\n$$R_0 \\cdot s = 1$$\n$$R_0 (1 - p^{\\ast} \\cdot \\mathrm{VE}) = 1$$\n我们现在解此方程以求得 $p^{\\ast}$，从而按要求从第一性原理推导出通用公式。\n$$1 - p^{\\ast} \\cdot \\mathrm{VE} = \\frac{1}{R_0}$$\n$$p^{\\ast} \\cdot \\mathrm{VE} = 1 - \\frac{1}{R_0}$$\n$$p^{\\ast} = \\frac{1 - \\frac{1}{R_0}}{\\mathrm{VE}}$$\n这个公式给出了使用渗漏型疫苗实现群体免疫所需的最低疫苗覆盖率。\n\n最后一步是使用给定的数值计算该表达式：$R_0 = 3$ 和 $\\mathrm{VE} = 0.8$。\n$$p^{\\ast} = \\frac{1 - \\frac{1}{3}}{0.8}$$\n首先，计算分子：\n$$1 - \\frac{1}{3} = \\frac{2}{3}$$\n接下来，将分母表示为分数：\n$$\\mathrm{VE} = 0.8 = \\frac{8}{10} = \\frac{4}{5}$$\n现在，将这些分数代回 $p^{\\ast}$ 的方程中：\n$$p^{\\ast} = \\frac{\\frac{2}{3}}{\\frac{4}{5}}$$\n除以一个分数，等于乘以它的倒数：\n$$p^{\\ast} = \\frac{2}{3} \\cdot \\frac{5}{4} = \\frac{10}{12}$$\n化简分数得到最终答案：\n$$p^{\\ast} = \\frac{5}{6}$$\n作为一个小数，这个值是 $0.8333...$。问题要求使用一个精确分数或四舍五入到四位有效数字的小数。精确分数 $\\frac{5}{6}$ 是最精确的形式。",
            "answer": "$$\n\\boxed{\\frac{5}{6}}\n$$"
        }
    ]
}