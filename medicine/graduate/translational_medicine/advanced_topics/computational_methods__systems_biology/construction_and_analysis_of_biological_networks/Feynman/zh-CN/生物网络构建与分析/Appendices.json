{
    "hands_on_practices": [
        {
            "introduction": "生物网络通常不是现成的，而是必须从实验数据中推断出来。本练习  演示了一个关键步骤：如何从一系列潜在相互作用及其对应的 $p$ 值出发，利用统计检验和多重假设校正（特别是 Benjamini-Hochberg 伪发现率控制）来构建一个高置信度的网络。理解这一过程至关重要，因为它能帮助我们在高通量研究中避免被大量的假阳性结果所淹没。",
            "id": "5002377",
            "problem": "一项转化肿瘤学研究旨在构建一个无向、无权的信号网络，该网络包含 $6$ 个磷酸化蛋白 $\\{g_{1}, g_{2}, g_{3}, g_{4}, g_{5}, g_{6}\\}$，这些蛋白是在靶向治疗前后的配对肿瘤活检样本中测量的。对于每个满足 $i  j$ 的蛋白对 $(g_{i}, g_{j})$，都通过配对检验计算了一个 $p$ 值来评估其相互作用的显著性。该研究共进行了 $m = \\binom{6}{2} = 15$ 次检验。给定解答部分提供的 $15$ 个 $p$ 值和 $\\alpha = 0.05$ 的目标假发现率 (FDR)，请确定最终网络中保留的边的总数。",
            "solution": "在尝试解答之前，对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知信息\n-   磷酸化蛋白数量：$6$ 个，表示为 $\\{g_{1}, g_{2}, g_{3}, g_{4}, g_{5}, g_{6}\\}$。\n-   网络类型：无向、无权。\n-   候选边和假设的数量：$m = \\binom{6}{2} = 15$。\n-   15 条候选边的 $p$ 值集合：\n    -   $(g_{1}, g_{2}): 0.041$, $(g_{1}, g_{3}): 0.003$, $(g_{1}, g_{4}): 0.073$, $(g_{1}, g_{5}): 0.009$, $(g_{1}, g_{6}): 0.14$,\n    -   $(g_{2}, g_{3}): 0.021$, $(g_{2}, g_{4}): 0.001$, $(g_{2}, g_{5}): 0.061$, $(g_{2}, g_{6}): 0.081$,\n    -   $(g_{3}, g_{4}): 0.052$, $(g_{3}, g_{5}): 0.012$, $(g_{3}, g_{6}): 0.091$,\n    -   $(g_{4}, g_{5}): 0.033$, $(g_{4}, g_{6}): 0.007$,\n    -   $(g_{5}, g_{6}): 0.018$。\n-   统计控制方法：Benjamini–Hochberg (BH) 假发现率 (FDR)。\n-   显著性水平：$\\alpha = 0.05$。\n-   任务 1：使用 BH-FDR 确定保留的边集。\n-   任务 2：构建二元邻接矩阵 $\\mathbf{A}\\in\\{0,1\\}^{6\\times 6}$。\n-   任务 3：从转化医学的角度论证选择 $\\alpha=0.05$ 的合理性。\n-   最终报告量：保留边的总数，即 $\\mathbf{A}$ 的严格上三角元素之和。\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题具有科学依据，提法明确且客观。它描述了转化肿瘤学中一个标准的生物信息学工作流程：基于高通量数据进行网络推断，并进行多重假设检验校正。Benjamini-Hochberg 程序是一种定义明确、行之有效的用于控制假发现率的统计方法。所有必要数据（15 个 $p$ 值的集合、假设数量 $m=15$ 以及控制水平 $\\alpha=0.05$）均已提供且相互一致。问题背景现实，提问具体且可形式化。该问题不违反任何科学原理，内容完整，无矛盾之处，也不包含任何主观性陈述。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将提供解答。\n\n### 解答\n首要任务是应用 Benjamini-Hochberg (BH) 程序，在 $\\alpha = 0.05$ 的水平上控制假发现率 (FDR)。检验的假设总数为 $m=15$。\n\nBH 程序包括以下步骤：\n1.  将 $m$ 个 $p$ 值从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。\n2.  找到满足条件 $p_{(k)} \\le \\frac{k}{m}\\alpha$ 的最大整数 $k$，其中 $p_{(k)}$ 是第 $k$ 个排序后的 $p$ 值。\n3.  宣布与 $p$ 值 $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$ 对应的假设为显著（即拒绝原假设）。\n\n让我们列出 $15$ 个 $p$ 值并按升序排列。第 $i$ 个 p 值的阈值为 $\\frac{i}{15} \\times 0.05 = \\frac{i}{300}$。\n\n-   $p_{(1)} = 0.001$ 对应边 $(g_{2}, g_{4})$。BH 阈值为 $\\frac{1}{15}(0.05) \\approx 0.00333$。因为 $0.001 \\le 0.00333$，所以该边是显著的。\n-   $p_{(2)} = 0.003$ 对应边 $(g_{1}, g_{3})$。BH 阈值为 $\\frac{2}{15}(0.05) \\approx 0.00667$。因为 $0.003 \\le 0.00667$，所以该边是显著的。\n-   $p_{(3)} = 0.007$ 对应边 $(g_{4}, g_{6})$。BH 阈值为 $\\frac{3}{15}(0.05) = 0.01$。因为 $0.007 \\le 0.01$，所以该边是显著的。\n-   $p_{(4)} = 0.009$ 对应边 $(g_{1}, g_{5})$。BH 阈值为 $\\frac{4}{15}(0.05) \\approx 0.01333$。因为 $0.009 \\le 0.01333$，所以该边是显著的。\n-   $p_{(5)} = 0.012$ 对应边 $(g_{3}, g_{5})$。BH 阈值为 $\\frac{5}{15}(0.05) \\approx 0.01667$。因为 $0.012 \\le 0.01667$，所以该边是显著的。\n-   $p_{(6)} = 0.018$ 对应边 $(g_{5}, g_{6})$。BH 阈值为 $\\frac{6}{15}(0.05) = 0.02$。因为 $0.018 \\le 0.02$，所以该边是显著的。\n-   $p_{(7)} = 0.021$ 对应边 $(g_{2}, g_{3})$。BH 阈值为 $\\frac{7}{15}(0.05) \\approx 0.02333$。因为 $0.021 \\le 0.02333$，所以该边是显著的。\n-   $p_{(8)} = 0.033$ 对应边 $(g_{4}, g_{5})$。BH 阈值为 $\\frac{8}{15}(0.05) \\approx 0.02667$。因为 $0.033 > 0.02667$，所以该边不显著，我们在此停止。\n\n满足 $p_{(k)} \\le \\frac{k}{m}\\alpha$ 的最大 $k$ 值为 $7$。因此，我们保留与最小的 $7$ 个 $p$ 值相对应的 $7$ 条边。\n\n保留的边集是：\n$\\{ (g_{1}, g_{3}), (g_{1}, g_{5}), (g_{2}, g_{3}), (g_{2}, g_{4}), (g_{3}, g_{5}), (g_{4}, g_{6}), (g_{5}, g_{6}) \\}$。\n\n保留边的总数为 $7$。\n\n接下来，我们为网络构建二元邻接矩阵 $\\mathbf{A}$，其中蛋白排序为 $[g_{1}, g_{2}, g_{3}, g_{4}, g_{5}, g_{6}]$。如果边 $(g_{i}, g_{j})$ 被保留，则矩阵元素 $A_{ij}$ 和 $A_{ji}$ 为 $1$，否则为 $0$。所有对角线元素 $A_{ii}$ 均为 $0$。\n-   $g_1$ 与 $g_3$ 和 $g_5$ 连接：$A_{13}=A_{31}=1$, $A_{15}=A_{51}=1$。\n-   $g_2$ 与 $g_3$ 和 $g_4$ 连接：$A_{23}=A_{32}=1$, $A_{24}=A_{42}=1$。\n-   $g_3$ 与 $g_1$、$g_2$ 和 $g_5$ 连接：$A_{31}=A_{13}=1$, $A_{32}=A_{23}=1$, $A_{35}=A_{53}=1$。（这些已根据对称性计入）。\n-   $g_4$ 与 $g_2$ 和 $g_6$ 连接：$A_{42}=A_{24}=1$, $A_{46}=A_{64}=1$。\n-   $g_5$ 与 $g_1$、$g_3$ 和 $g_6$ 连接：$A_{51}=A_{15}=1$, $A_{53}=A_{35}=1$, $A_{56}=A_{65}=1$。\n-   $g_6$ 与 $g_4$ 和 $g_5$ 连接：$A_{64}=A_{46}=1$, $A_{65}=A_{56}=1$。\n\n得到的邻接矩阵 $\\mathbf{A}$ 为：\n$$ \\mathbf{A} = \\begin{pmatrix}\n0  0  1  0  1  0 \\\\\n0  0  1  1  0  0 \\\\\n1  1  0  0  1  0 \\\\\n0  1  0  0  0  1 \\\\\n1  0  1  0  0  1 \\\\\n0  0  0  1  1  0\n\\end{pmatrix} $$\n$\\mathbf{A}$ 的严格上三角元素之和为 $A_{13} + A_{15} + A_{23} + A_{24} + A_{35} + A_{46} + A_{56} = 1+1+1+1+1+1+1=7$，这证实了我们计算的保留边数为 $7$。\n\n最后，我们从转化医学相关的基本原理出发，论证选择 $\\alpha=0.05$ 的合理性。\n转化医学的目标是弥合基础研究与临床实践之间的鸿沟。在此背景下，构建信号网络是一个探索性的、产生假设的步骤。“发现”即是保留的边，它们代表了值得进一步研究的推定蛋白质-蛋白质相互作用或功能关联。\n\n1.  **FDR 的定义**：假发现率 (FDR) 是在所有声称的发现中，假阳性的预期比例。在 $\\alpha=0.05$ 的水平上控制 FDR，意味着我们接受在保留的边中，平均不超过 $5\\%$ 是假的。这与控制族错误率 (FWER) 有本质区别。FWER 是指犯下哪怕一个假发现的概率，对于一个有许多假设 ($m=15$) 的探索性研究来说，这种控制方法过于保守。控制 FWER 会严重降低统计功效，导致网络过于稀疏，可能会漏掉许多真实的生物学相互作用。\n\n2.  **平衡发现与资源**：转化研究是一条流水线。一个阶段（网络推断）的输出成为下一个更具针对性且成本更高的阶段（例如，使用免疫沉淀等技术进行实验验证，或在细胞系中进行功能研究）的输入。设置 $\\alpha=0.05$ 代表了一种务实的权衡。一个过高的 $\\alpha$ 会生成一个包含许多假阳性的密集网络，从而在验证死胡同上浪费宝贵的时间和资源。一个过低的 $\\alpha$ 则会产生太少的候选目标，可能导致整个项目因缺乏假设而停滞。$5\\%$ 的 FDR 是一个通常被认为是合理的平衡点，它能产生一个富含真实信号但又不至于大到难以进行后续研究的发现列表。对于发现的 $7$ 条边，我们预期平均有 $7 \\times 0.05 = 0.35$ 个假阳性，这对下游验证工作来说是一个非常有利的结果。\n\n3.  **科学背景**：此阶段的目标并非仅凭这一个数据集就以绝对的确定性证明网络结构，而是生成一个高质量的模型，用以形成关于疗法作用机制的新的、可检验的假设。$5\\%$ 的 FDR 是一个标准，它允许在这种发现和验证的迭代过程中取得有意义的进展，而这正是转化科学的精髓。\n\n最终报告量是保留边的总数。根据计算，这个数字是 $7$。",
            "answer": "$$ \\boxed{7} $$"
        },
        {
            "introduction": "一旦网络构建完成，下一步就是分析其拓扑结构以获得生物学洞见。本练习  专注于计算节点级别的基本度量，如度中心性和局部聚类系数。这些度量有助于我们识别网络中的关键节点（“中枢”）以及通常对应于蛋白质复合物或功能通路的高密度连接子图。",
            "id": "5002394",
            "problem": "通过整合物理结合数据和特定条件的共表达数据，从转化医学的一个队列中构建了一个疾病特异性蛋白质-蛋白质相互作用（PPI）网络。得到的包含 $6$ 个基因产物的无向、无权网络由一个对角线元素为零的对称邻接矩阵 $A \\in \\{0,1\\}^{6 \\times 6}$ 表示：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0  1  1  0  0  0\\\\\n1  0  1  0  0  0\\\\\n1  1  0  1  0  0\\\\\n0  0  1  0  1  1\\\\\n0  0  0  1  0  1\\\\\n0  0  0  1  1  0\n\\end{pmatrix}.\n$$\n节点由 $i \\in \\{1,2,3,4,5,6\\}$ 索引。使用适用于无向简单图的核心图论定义，执行以下操作：\n- 对每个节点 $i$，根据节点 $i$ 的度 $k_{i}$，计算归一化度中心性 $C_{D}(i)$，使用具有 $n=6$ 个节点的图中最大可能度进行归一化。\n- 对每个节点 $i$，计算局部聚类系数 $C_{i}$，其定义为节点 $i$ 的邻居之间已实现的连接数与所有可能连接数之比。采用当 $k_{i}  2$ 时 $C_{i}=0$ 的约定。\n- 根据您的计算，从转化网络生物学的角度解释哪些节点可能位于密集的功能模块中，哪些节点充当模块间连接器。其中，高局部聚类表明节点属于功能复合物或通路，而高自由度节点的低局部聚类可能表明其起桥接作用。\n\n最后，报告局部聚类系数的网络平均值 $\\bar{C} = \\frac{1}{n}\\sum_{i=1}^{n} C_{i}$，结果为保留 $4$ 位有效数字的小数。最终报告值不需要单位。",
            "solution": "该问题已经过验证，被认为是有效的。它在科学上基于图论及其在生物网络分析中的应用，问题阐述清晰，提供了所有必要信息，并以客观、正式的语言表达。因此，我们可以开始求解。\n\n该问题要求对一个由邻接矩阵 $A$ 表示的给定生物网络进行多步分析。该网络有 $n=6$ 个节点。\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0  1  1  0  0  0\\\\\n1  0  1  0  0  0\\\\\n1  1  0  1  0  0\\\\\n0  0  1  0  1  1\\\\\n0  0  0  1  0  1\\\\\n0  0  0  1  1  0\n\\end{pmatrix}\n$$\n分析过程包括计算特定节点的度量指标，解释其生物学意义，并计算一个全局网络属性。\n\n首先，我们计算每个节点 $i$ 的度 $k_i$，即它拥有的连接数。对于由对称邻接矩阵 $A$ 表示的无向图，节点 $i$ 的度是第 $i$ 行（或列）元素的总和。\n$k_i = \\sum_{j=1}^{n} A_{ij}$\n- $k_1 = 1+1 = 2$\n- $k_2 = 1+1 = 2$\n- $k_3 = 1+1+1 = 3$\n- $k_4 = 1+1+1 = 3$\n- $k_5 = 1+1 = 2$\n- $k_6 = 1+1 = 2$\n\n接下来，我们计算每个节点的归一化度中心性 $C_D(i)$。它定义为节点的度 $k_i$ 除以一个包含 $n$ 个节点的简单图中最大可能的度，即 $n-1$。这里，$n=6$，所以最大可能的度是 $n-1 = 5$。\n$C_D(i) = \\frac{k_i}{n-1}$\n- $C_D(1) = \\frac{k_1}{5} = \\frac{2}{5} = 0.4$\n- $C_D(2) = \\frac{k_2}{5} = \\frac{2}{5} = 0.4$\n- $C_D(3) = \\frac{k_3}{5} = \\frac{3}{5} = 0.6$\n- $C_D(4) = \\frac{k_4}{5} = \\frac{3}{5} = 0.6$\n- $C_D(5) = \\frac{k_5}{5} = \\frac{2}{5} = 0.4$\n- $C_D(6) = \\frac{k_6}{5} = \\frac{2}{5} = 0.4$\n\n现在，我们计算每个节点的局部聚类系数 $C_i$。该系数衡量一个节点邻居之间连接的密度。它定义为节点 $i$ 的邻居之间存在的边数（记为 $E_i$）除以它们之间所有可能的边数。对于无向图，其公式为：\n$C_i = \\frac{2 E_i}{k_i (k_i - 1)}$\n问题规定了如果 $k_i  2$，则 $C_i = 0$。由于所有节点的度都至少为 $2$，这个约定在此不适用。\n\n- **节点 1**：$k_1=2$。邻居是 $N(1) = \\{2, 3\\}$。它们之间有 $E_1=1$ 条边（边 $(2,3)$，因为 $A_{23}=1$）。\n$C_1 = \\frac{2 \\times 1}{2 \\times (2 - 1)} = \\frac{2}{2} = 1$\n\n- **节点 2**：$k_2=2$。邻居是 $N(2) = \\{1, 3\\}$。它们之间有 $E_2=1$ 条边（边 $(1,3)$，因为 $A_{13}=1$）。\n$C_2 = \\frac{2 \\times 1}{2 \\times (2 - 1)} = \\frac{2}{2} = 1$\n\n- **节点 3**：$k_3=3$。邻居是 $N(3) = \\{1, 2, 4\\}$。可能的边是 $(1,2)$, $(1,4)$, 和 $(2,4)$。我们检查邻接矩阵：$A_{12}=1$，$A_{14}=0$，$A_{24}=0$。因此，邻居之间只有 $E_3=1$ 条边。\n$C_3 = \\frac{2 \\times 1}{3 \\times (3 - 1)} = \\frac{2}{6} = \\frac{1}{3}$\n\n- **节点 4**：$k_4=3$。邻居是 $N(4) = \\{3, 5, 6\\}$。可能的边是 $(3,5)$, $(3,6)$, 和 $(5,6)$。我们检查邻接矩阵：$A_{35}=0$，$A_{36}=0$，$A_{56}=1$。因此，邻居之间只有 $E_4=1$ 条边。\n$C_4 = \\frac{2 \\times 1}{3 \\times (3 - 1)} = \\frac{2}{6} = \\frac{1}{3}$\n\n- **节点 5**：$k_5=2$。邻居是 $N(5) = \\{4, 6\\}$。它们之间有 $E_5=1$ 条边（边 $(4,6)$，因为 $A_{46}=1$）。\n$C_5 = \\frac{2 \\times 1}{2 \\times (2 - 1)} = \\frac{2}{2} = 1$\n\n- **节点 6**：$k_6=2$。邻居是 $N(6) = \\{4, 5\\}$。它们之间有 $E_6=1$ 条边（边 $(4,5)$，因为 $A_{45}=1$）。\n$C_6 = \\frac{2 \\times 1}{2 \\times (2 - 1)} = \\frac{2}{2} = 1$\n\n基于这些计算，我们可以解释这些节点的作用。\n- **节点 1, 2, 5, 6**：这些节点的局部聚类系数为 $C_i = 1$。这个最大值表明它们的邻居是完全连接的，形成一个团（clique）。这些节点深嵌于密集的功能模块中。具体来说，节点 $\\{1, 2, 3\\}$ 形成一个三角形，节点 $\\{4, 5, 6\\}$ 形成另一个三角形。节点 $1$ 和 $2$ 属于第一个模块，节点 $5$ 和 $6$ 属于第二个模块。\n- **节点 3, 4**：这些节点在网络中具有最高的度中心性（$C_D(3) = C_D(4) = 0.6$）。然而，它们的局部聚类系数相对较低（$C_3 = C_4 = 1/3$）。这种高自由度和低局部聚类的模式是充当“桥梁”或模块间连接器的节点的特征。节点 $3$ 是第一个功能模块的一部分，但也连接到节点 $4$。同样，节点 $4$ 是第二个模块的一部分，并连接到节点 $3$。边 $(3,4)$ 是连接两个密集三角形模块的唯一连接，证实了节点 $3$ 和 $4$ 的桥接作用。\n\n最后，我们计算局部聚类系数的网络平均值 $\\bar{C}$。\n$\\bar{C} = \\frac{1}{n}\\sum_{i=1}^{n} C_{i}$\n$\\bar{C} = \\frac{1}{6} (C_1 + C_2 + C_3 + C_4 + C_5 + C_6)$\n$\\bar{C} = \\frac{1}{6} \\left(1 + 1 + \\frac{1}{3} + \\frac{1}{3} + 1 + 1\\right)$\n$\\bar{C} = \\frac{1}{6} \\left(4 + \\frac{2}{3}\\right)$\n$\\bar{C} = \\frac{1}{6} \\left(\\frac{12}{3} + \\frac{2}{3}\\right) = \\frac{1}{6} \\left(\\frac{14}{3}\\right) = \\frac{14}{18} = \\frac{7}{9}$\n\n将此值报告为保留 $4$ 位有效数字的小数：\n$\\frac{7}{9} \\approx 0.777777...$\n四舍五入到 $4$ 位有效数字得到 $0.7778$。",
            "answer": "$$\\boxed{0.7778}$$"
        },
        {
            "introduction": "生物网络的一个核心应用是预测与特定生物过程（如疾病）相关的新基因或蛋白质。本练习  将实现带重启的随机游走（Random Walk with Restart, RWR）算法。该算法通过模拟一个从已知“种子”基因出发的扩散过程，来量化网络中所有其他基因与这些种子基因的邻近度，从而为筛选后续实验验证的候选基因提供了一种有原则的排序方法。",
            "id": "5002343",
            "problem": "给定小型的蛋白质-蛋白质相互作用 (PPI) 网络和疾病种子基因集。请构建一个有原则、可复现的带重启的随机游走 (RWR) 方法，通过稳态概率来优先排序候选基因。您的程序必须实现以下内容，这些内容源自离散时间马尔可夫链和随机矩阵的基础理论。\n\n定义与理论基础：\n- 一个包含 $n$ 个基因的 PPI 网络由一个对称、非负的邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 表示，其元素满足 $A_{ij} \\ge 0$ 和 $A_{ij} = A_{ji}$。对角线元素可以为零。非零元素代表无向的相互作用强度。\n- 一个列随机矩阵 $W \\in \\mathbb{R}^{n \\times n}$ 满足对于每一列 $j$，$\\sum_{i=1}^{n} W_{ij} = 1$ 且 $W_{ij} \\ge 0$。这样的矩阵定义了一个马尔可夫链转移算子，它通过更新 $p^{(t+1)} = W p^{(t)}$ 作用于概率向量 $p \\in \\mathbb{R}^{n}$，并保持 $\\sum_{i=1}^{n} p^{(t)}_i = 1$ 和 $p^{(t)}_i \\ge 0$。\n- 给定 $A$，通过列归一化来构建 $W$：对于列和 $\\sum_{i=1}^{n} A_{ij}  0$ 的每一列 $j$，设置 $W_{ij} = A_{ij} / \\sum_{k=1}^{n} A_{kj}$。对于任何列和 $\\sum_{i=1}^{n} A_{ij} = 0$ 的列 $j$（一个孤立节点），设置 $W_{jj} = 1$ 且对于 $i \\ne j$ 设置 $W_{ij} = 0$；这增加了一个自环，以在孤立节点上保持概率质量，并确保 $W$ 是列随机的。\n- 设种子集为 $S \\subset \\{0,1,\\dots,n-1\\}$。定义种子分布向量 $s \\in \\mathbb{R}^{n}$ 为：如果 $i \\in S$，则 $s_i = 1/|S|$；否则 $s_i = 0$。因此，$\\sum_{i=1}^{n} s_i = 1$ 且 $s_i \\ge 0$。\n- 考虑网络上的一个马尔可夫过程，其重启参数为 $\\gamma \\in (0,1]$。在每个时间步，游走以概率 $\\gamma$ 根据 $s$ 重启到种子节点，以概率 $(1 - \\gamma)$ 根据 $W$ 进行一次网络转移。根据带传送的马尔可夫链平稳分布的基本定义，唯一的稳态分布 $p^\\star \\in \\mathbb{R}^{n}$ 满足不动点方程 $p^\\star = (1 - \\gamma) \\, W \\, p^\\star + \\gamma \\, s$。当 $\\gamma \\in (0,1]$ 且 $W$ 是列随机的时，由于 $(1 - \\gamma) \\, W$ 的谱半径严格小于 $1$，该唯一解的存在性得到保证。\n\n程序要求：\n- 对于下面的每个测试用例，按规定从 $A$ 构建 $W$，从给定的种子集构建 $s$，并通过求解不动点条件所蕴含的线性系统来精确计算唯一的 $p^\\star$，不要使用迭代启发式方法。将所有非种子节点按 $p^\\star_i$ 降序排序；若分数相同，则按索引 $i$ 升序打破平局。对每个用例，返回排序后的前 $k$ 个非种子节点索引，使用从零开始的索引。\n- 如果所有非种子节点的分数都相同（例如，恰好为 $0$），则使用平局打破规则按升序选择索引。\n- 数值稳定性：如果数值舍入误差在 $p^\\star$ 中产生了微小的负值，通过裁剪将它们视为 $0$，然后重新归一化以确保 $\\sum_{i=1}^{n} p^\\star_i = 1$。\n\n测试套件（请精确使用这些用例）：\n1) 用例 1（理想情况，连通，无权重）：\n   - $n = 6$；邻接矩阵 $A \\in \\mathbb{R}^{6 \\times 6}$ 的元素为\n     $$A = \\begin{bmatrix}\n     0  1  0  0  0  1 \\\\\n     1  0  1  1  0  0 \\\\\n     0  1  0  1  0  0 \\\\\n     0  1  1  0  1  0 \\\\\n     0  0  0  1  0  1 \\\\\n     1  0  0  0  1  0\n     \\end{bmatrix}.$$\n   - 种子集 $S = \\{0, 3\\}$。\n   - 重启参数 $\\gamma = 0.35$。\n   - Top-$k$：$k = 3$。\n\n2) 用例 2（边界情况，孤立种子）：\n   - $n = 5$；邻接矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$ 的元素为\n     $$A = \\begin{bmatrix}\n     0  1  0  0  0 \\\\\n     1  0  1  0  0 \\\\\n     0  1  0  1  0 \\\\\n     0  0  1  0  0 \\\\\n     0  0  0  0  0\n     \\end{bmatrix}.$$\n   - 种子集 $S = \\{4\\}$。\n   - 重启参数 $\\gamma = 0.7$。\n   - Top-$k$：$k = 2$。\n\n3) 用例 3（加权网络，强重启）：\n   - $n = 7$；邻接矩阵 $A \\in \\mathbb{R}^{7 \\times 7}$ 的元素为\n     $$A = \\begin{bmatrix}\n     0  2.0  1.0  0  0  0  0 \\\\\n     2.0  0  0  1.5  0  0  0 \\\\\n     1.0  0  0  0.5  0  0  1.0 \\\\\n     0  1.5  0.5  0  2.0  0  0 \\\\\n     0  0  0  2.0  0  1.0  0 \\\\\n     0  0  0  0  1.0  0  0.5 \\\\\n     0  0  1.0  0  0  0.5  0\n     \\end{bmatrix}.$$\n   - 种子集 $S = \\{1, 4\\}$。\n   - 重启参数 $\\gamma = 0.9$。\n   - Top-$k$：$k = 3$。\n\n4) 用例 4（边界情况，完全重启）：\n   - 使用与用例 1 中相同的 $A$。\n   - 种子集 $S = \\{0, 3\\}$。\n   - 重启参数 $\\gamma = 1.0$。\n   - Top-$k$：$k = 2$。\n\n输出规范：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素是对应测试用例的前 $k$ 个索引的列表。例如：\"[$[i_{1,1},i_{1,2},\\dots]$, $[i_{2,1},\\dots]$, $[i_{3,1},\\dots]$, $[i_{4,1},\\dots]$]\"。最终输出不得包含任何空格。",
            "solution": "该问题要求实现带重启的随机游走 (RWR) 算法，以对蛋白质-蛋白质相互作用 (PPI) 网络中的候选基因进行优先排序。该方法利用离散时间马尔可夫链的数学框架来量化网络节点与一组预定义的、与疾病相关的“种子”基因的邻近度。任务的核心是计算此过程的唯一稳态概率分布，并用它来对非种子基因进行排序。\n\n该模型的基础是代表 PPI 网络的图上的一个马尔可夫过程。一个包含 $n$ 个基因的网络由一个邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 描述，其中 $A_{ij} \\ge 0$ 表示基因 $i$ 和基因 $j$ 之间相互作用的强度。由于相互作用是无向的，所以 $A$ 是对称的，即 $A_{ij} = A_{ji}$。\n\n首先，我们从 $A$ 构建一个列随机转移矩阵 $W \\in \\mathbb{R}^{n \\times n}$。该矩阵 $W$ 定义了网络上随机游走的转移概率。位于节点 $j$ 的游走者将以概率 $W_{ij}$ 移动到节点 $i$。为确保从节点 $j$ 移动到任何其他节点的总概率为 1， $W$ 的每一列之和必须为 1。这通过将 $A$ 的每一列除以其总和来实现：\n$$ W_{ij} = \\frac{A_{ij}}{\\sum_{k=1}^{n} A_{kj}} $$\n此归一化针对每一列和 $\\sum_{k=1}^{n} A_{kj}$ 大于 0 的列 $j$ 进行。如果某列 $j$ 的和为 0，它对应于一个没有出向连接的孤立节点。为了保持概率，这样的节点被建模为带自环的汇点，意味着 $W_{jj} = 1$ 且对于 $i \\neq j$，$W_{ij} = 0$。\n\nRWR 过程通过引入“重启”机制来修改标准随机游走。在每一步，游走者有两个选择：\n1. 以 $1 - \\gamma$ 的概率，它根据矩阵 $W$ 进行一次转移。\n2. 以 $\\gamma$ 的概率，它传送回种子节点之一。\n\n重启概率 $\\gamma \\in (0, 1]$ 是一个关键参数。重启的分布由种子向量 $s \\in \\mathbb{R}^n$ 控制。给定一个种子基因集 $S$，$s$ 被定义为在这些基因上的均匀分布：如果基因 $i \\in S$，则 $s_i = 1/|S|$；否则 $s_i = 0$。\n\n设 $p^{(t)} \\in \\mathbb{R}^n$ 是在步骤 $t$ 时所有 $n$ 个基因上的概率分布向量，其中 $p_i^{(t)}$ 是游走者位于节点 $i$ 的概率。下一步的分布 $p^{(t+1)}$ 由以下递归公式给出：\n$$ p^{(t+1)} = (1 - \\gamma) W p^{(t)} + \\gamma s $$\n该过程最终会收敛到一个唯一的稳态分布 $p^\\star$，此分布在后续步骤中不再改变。这个 $p^\\star$ 满足不动点方程：\n$$ p^\\star = (1 - \\gamma) W p^\\star + \\gamma s $$\n该向量的各分量 $p^\\star_i$ 代表游走者长期停留在节点 $i$ 的概率，并被用作基因优先排序的分数。分数越高，意味着与种子集的功能相关性越强。\n\n为了精确地找到 $p^\\star$，按照问题要求，我们不迭代递归关系。相反，我们将不动点方程重排为一个线性方程组：\n$$ p^\\star - (1 - \\gamma) W p^\\star = \\gamma s $$\n$$ (I - (1 - \\gamma) W) p^\\star = \\gamma s $$\n其中 $I$ 是 $n \\times n$ 单位矩阵。这是一个标准形式为 $M x = b$ 的线性系统，其中矩阵 $M = I - (1 - \\gamma) W$，未知向量是 $x = p^\\star$，常数向量是 $b = \\gamma s$。正如在带传送的马尔可夫链理论中确立的，对于任何 $\\gamma \\in (0,1]$，矩阵 $M$ 保证是可逆的，从而确保了 $p^\\star$ 的唯一解。这个解可以使用标准线性代数求解器高效计算。当 $\\gamma = 1$ 的特殊情况，会导致 $p^\\star = s$，因为游走者总是重启，从不遍历网络。\n\n解决该问题的算法如下：\n1. 对于给定的邻接矩阵 $A$，通过对 $A$ 的列进行归一化来构建转移矩阵 $W$。对于任何和为 0 的列，将 $W$ 中对应的对角元素设为 1。\n2. 对于给定的种子集 $S$，构建在种子节点上具有均匀概率的种子向量 $s$。\n3. 形成矩阵 $M = I - (1 - \\gamma) W$ 和向量 $b = \\gamma s$。对于边界情况 $\\gamma=1$，$p^{\\star}$ 就是 $s$。\n4. 求解线性系统 $M p^\\star = b$ 以找到稳态向量 $p^\\star$。\n5. 为了数值鲁棒性，将计算出的 $p^\\star$ 中因浮点不精确性而产生的任何微小负值裁剪为 0。然后重新归一化该向量，以确保其元素之和为 1。\n6. 识别所有非种子节点。为每个非种子节点 $i$ 创建一个序对列表 $(p^\\star_i, i)$。\n7. 按分数 $p^\\star_i$ 的降序对此列表进行排序。平局通过按节点索引 $i$ 的升序来打破。\n8. 最终结果是排序后列表中的前 $k$ 个索引的列表。\n\n这种有原则的方法为基因优先排序提供了一种可复现且数学上严谨的方法，直接解决了所述问题。它正确处理了诸如孤立节点和重启参数 $\\gamma$ 的边界值等边缘情况。",
            "answer": "[[1,2,5],[0,1],[3,0,2],[1,2]]"
        }
    ]
}