{
    "hands_on_practices": [
        {
            "introduction": "In translational medicine, we rely on assays to measure biomarker levels, but no measurement is perfectly precise. This exercise delves into the statistical consequences of this unavoidable \"measurement error.\" By deriving the relationship between the true association and the observed association, you will uncover the principle of attenuation, which explains why measurement error systematically biases our estimates of a surrogate's validity toward zero. ",
            "id": "5074999",
            "problem": "In a randomized translational study evaluating a biomarker surrogate endpoint, suppose the true surrogate $S$ relates linearly to the true clinical endpoint $T$ via the structural model $T=\\alpha+\\beta S+U$, where $U$ is an error term with $\\mathbb{E}[U]=0$, $\\operatorname{Var}(U)=\\sigma_{U}^{2}$, and $U$ is independent of $S$. The surrogate is measured with classical additive measurement error by an assay, yielding an observed surrogate $S^{\\ast}=S+\\epsilon$, where $\\epsilon \\sim N(0,\\sigma_{\\epsilon}^{2})$ is independent of $S$ and $U$. Denote $\\operatorname{Var}(S)=\\sigma_{S}^{2}$, which is finite and positive. Investigators naively regress $T$ on $S^{\\ast}$ using Ordinary Least Squares (OLS), ignoring measurement error in $S^{\\ast}$.\n\nWorking in the large-sample (population) limit and using only core definitions of covariance and variance together with the stated independence assumptions, derive the attenuation factor, defined as the ratio of the population OLS slope from regressing $T$ on $S^{\\ast}$ to the true slope $\\beta$. Express your final answer as a single closed-form analytic expression in terms of $\\sigma_{S}^{2}$ and $\\sigma_{\\epsilon}^{2}$. No rounding is required, and no units are needed.",
            "solution": "The problem asks for the attenuation in the estimated association between the surrogate and the true endpoint when the surrogate is measured with classical additive error. The large-sample (population) Ordinary Least Squares (OLS) slope for regressing $T$ on $S^{\\ast}$ is defined by the ratio of the covariance of the outcome and the regressor to the variance of the regressor. Specifically, if $\\tilde{\\beta}$ denotes the population OLS slope from regressing $T$ on $S^{\\ast}$, then by definition,\n$$\n\\tilde{\\beta}=\\frac{\\operatorname{Cov}(T,S^{\\ast})}{\\operatorname{Var}(S^{\\ast})}.\n$$\n\nWe use the structural model and the measurement model. The structural model is\n$$\nT=\\alpha+\\beta S+U,\n$$\nwith $\\mathbb{E}[U]=0$ and $U$ independent of $S$. The measurement model is\n$$\nS^{\\ast}=S+\\epsilon,\n$$\nwith $\\epsilon \\sim N(0,\\sigma_{\\epsilon}^{2})$ and $\\epsilon$ independent of both $S$ and $U$. Let $\\operatorname{Var}(S)=\\sigma_{S}^{2}$.\n\nFirst, compute the numerator:\n$$\n\\operatorname{Cov}(T,S^{\\ast})=\\operatorname{Cov}(\\alpha+\\beta S+U,\\,S+\\epsilon).\n$$\nUsing bilinearity and the fact that the covariance of a constant with any random variable is $0$, we have\n$$\n\\operatorname{Cov}(T,S^{\\ast})=\\operatorname{Cov}(\\beta S+U,\\,S)+\\operatorname{Cov}(\\beta S+U,\\,\\epsilon).\n$$\nAgain by bilinearity,\n$$\n\\operatorname{Cov}(T,S^{\\ast})=\\beta\\,\\operatorname{Cov}(S,S)+\\operatorname{Cov}(U,S)+\\beta\\,\\operatorname{Cov}(S,\\epsilon)+\\operatorname{Cov}(U,\\epsilon).\n$$\nBy the stated independence assumptions, $\\operatorname{Cov}(U,S)=0$, $\\operatorname{Cov}(S,\\epsilon)=0$, and $\\operatorname{Cov}(U,\\epsilon)=0$. Also, $\\operatorname{Cov}(S,S)=\\operatorname{Var}(S)=\\sigma_{S}^{2}$. Therefore,\n$$\n\\operatorname{Cov}(T,S^{\\ast})=\\beta\\,\\sigma_{S}^{2}.\n$$\n\nNext, compute the denominator $\\operatorname{Var}(S^{\\ast})$:\n$$\n\\operatorname{Var}(S^{\\ast})=\\operatorname{Var}(S+\\epsilon)=\\operatorname{Var}(S)+\\operatorname{Var}(\\epsilon)+2\\,\\operatorname{Cov}(S,\\epsilon).\n$$\nIndependence of $S$ and $\\epsilon$ implies $\\operatorname{Cov}(S,\\epsilon)=0$, so\n$$\n\\operatorname{Var}(S^{\\ast})=\\sigma_{S}^{2}+\\sigma_{\\epsilon}^{2}.\n$$\n\nTherefore, the population OLS slope of $T$ on $S^{\\ast}$ is\n$$\n\\tilde{\\beta}=\\frac{\\operatorname{Cov}(T,S^{\\ast})}{\\operatorname{Var}(S^{\\ast})}=\\frac{\\beta\\,\\sigma_{S}^{2}}{\\sigma_{S}^{2}+\\sigma_{\\epsilon}^{2}}.\n$$\n\nThe attenuation factor is defined as the ratio of the naive (error-ignored) slope to the true slope $\\beta$, namely\n$$\n\\lambda=\\frac{\\tilde{\\beta}}{\\beta}=\\frac{\\sigma_{S}^{2}}{\\sigma_{S}^{2}+\\sigma_{\\epsilon}^{2}}.\n$$\nThis expression depends only on the variance of the true surrogate and the variance of the measurement error. It lies strictly between $0$ and $1$ for $\\sigma_{S}^{2}>0$ and $\\sigma_{\\epsilon}^{2}>0$, reflecting attenuation toward $0$ due to measurement error. This factor is also known as the reliability ratio, but here it has been derived directly from first principles using covariance and variance definitions.",
            "answer": "$$\\boxed{\\frac{\\sigma_{S}^{2}}{\\sigma_{S}^{2}+\\sigma_{\\epsilon}^{2}}}$$"
        },
        {
            "introduction": "A strong correlation between a surrogate and a true endpoint does not automatically guarantee that a therapy targeting the surrogate will be beneficial. This practice explores the critical distinction between the effect of the surrogate on the outcome and the effect of the treatment on the outcome. Through a causal mediation model, you will dissect the total treatment effect into its on-target (mediated) and off-target (direct) components, illustrating how a drug can be clinically harmful despite strongly improving a surrogate marker. ",
            "id": "5074986",
            "problem": "Consider a translational study evaluating a new therapy $A$ intended to reduce low-density lipoprotein cholesterol (LDL-C), a biomarker proposed as a Surrogate Endpoint (SE) $S$, for the prevention of myocardial infarction. The True Clinical Endpoint (TCE) $T$ is the one-year probability of a Major Adverse Cardiac Event (MACE). Assume a linear probability model for the TCE that is commonly used for mediation intuition in early-phase translational studies, and a simple shift model for the surrogate under treatment:\n$$\n\\Pr(T=1 \\mid A,S) \\;=\\; p_0 \\;+\\; \\beta_{A} A \\;+\\; \\beta_{\\text{tox}} A \\;+\\; \\beta_{S}\\,\\big(S - \\mu_0\\big),\n$$\n$$\nS \\;=\\; \\mu_0 \\;+\\; \\gamma_{A} A \\;+\\; \\varepsilon,\n$$\nwith $\\mathbb{E}[\\varepsilon]=0$ and $A \\in \\{0,1\\}$ indicating control ($A=0$) or therapy ($A=1$). Here, $p_0$ is the baseline risk in the control arm, $\\mu_0$ is the mean LDL-C in the control arm, $\\beta_{S}$ captures the association between LDL-C and MACE risk on the risk-difference scale, $\\beta_{A}$ is any residual on-target effect of $A$ on $T$ not mediated through $S$, and $\\beta_{\\text{tox}}$ captures an off-target toxic effect of $A$ on $T$ that is independent of $S$ (for example, pro-arrhythmic liability).\n\nSuppose the following scientifically plausible parameter values are observed in an advanced-phase biomarker-to-outcome translation:\n- Baseline event risk: $p_0 = 0.15$.\n- Control mean LDL-C: $\\mu_0 = 130$ $\\text{mg}\\cdot\\text{dL}^{-1}$.\n- Treatment shifts LDL-C downward: $\\gamma_{A} = -30$ $\\text{mg}\\cdot\\text{dL}^{-1}$.\n- Risk sensitivity to LDL-C: $\\beta_{S} = 0.003$ per $\\text{mg}\\cdot\\text{dL}^{-1}$ (interpreted additively on the risk scale).\n- Residual on-target effect not through LDL-C: $\\beta_{A} = 0$.\n- Off-target toxicity on MACE risk: $\\beta_{\\text{tox}} = 0.19$.\n\nStarting from these definitions and models, derive the marginal average treatment effect on the True Clinical Endpoint, that is, the risk difference for $T$ between $A=1$ and $A=0$,\n$$\n\\Delta_T \\;=\\; \\mathbb{E}\\big[\\Pr(T=1 \\mid A=1,S)\\big] \\;-\\; \\mathbb{E}\\big[\\Pr(T=1 \\mid A=0,S)\\big],\n$$\nand compute its numerical value. Round your answer to four significant figures and express the risk difference as a decimal fraction. Your derivation should make clear why, despite a strong improvement in the surrogate $S$ and a high proportion of treatment effect explained by $S$, the net clinical effect on $T$ can still be harmful due to the off-target term $\\beta_{\\text{tox}}$.",
            "solution": "The objective is to derive and compute the marginal average treatment effect on the True Clinical Endpoint (TCE), $\\Delta_T$, defined as the difference in the expected MACE probability between the treatment ($A=1$) and control ($A=0$) arms:\n$$\n\\Delta_T = \\mathbb{E}[\\Pr(T=1 \\mid A=1,S)] - \\mathbb{E}[\\Pr(T=1 \\mid A=0,S)]\n$$\nThe expectation $\\mathbb{E}[\\cdot]$ is taken over the distribution of the surrogate $S$ conditional on the treatment $A$.\n\nFirst, we find the expected risk in the treatment arm ($A=1$). The conditional probability model is:\n$$\n\\Pr(T=1 \\mid A,S) = p_0 + \\beta_{A} A + \\beta_{\\text{tox}} A + \\beta_{S}\\,(S - \\mu_0)\n$$\nTaking the expectation conditional on $A=1$:\n$$\n\\mathbb{E}[\\Pr(T=1 \\mid A=1,S)] = \\mathbb{E}[p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\,(S - \\mu_0) \\mid A=1]\n$$\nBy linearity of expectation, this becomes:\n$$\n= p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}(\\mathbb{E}[S \\mid A=1] - \\mu_0)\n$$\nUsing the model for the surrogate, $S = \\mu_0 + \\gamma_{A} A + \\varepsilon$, the expected value of $S$ under treatment is $\\mathbb{E}[S \\mid A=1] = \\mu_0 + \\gamma_{A}(1) + \\mathbb{E}[\\varepsilon] = \\mu_0 + \\gamma_{A}$. Substituting this in:\n$$\n\\mathbb{E}[\\Pr(T=1 \\mid A=1,S)] = p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}((\\mu_0 + \\gamma_{A}) - \\mu_0) = p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\gamma_{A}\n$$\n\nNext, we find the expected risk in the control arm ($A=0$).\n$$\n\\mathbb{E}[\\Pr(T=1 \\mid A=0,S)] = \\mathbb{E}[p_0 + \\beta_{S}\\,(S - \\mu_0) \\mid A=0] = p_0 + \\beta_{S}(\\mathbb{E}[S \\mid A=0] - \\mu_0)\n$$\nThe expected value of $S$ under control is $\\mathbb{E}[S \\mid A=0] = \\mu_0 + \\gamma_{A}(0) + \\mathbb{E}[\\varepsilon] = \\mu_0$. Substituting this in:\n$$\n\\mathbb{E}[\\Pr(T=1 \\mid A=0,S)] = p_0 + \\beta_{S}(\\mu_0 - \\mu_0) = p_0\n$$\n\nFinally, the total average treatment effect $\\Delta_T$ is the difference:\n$$\n\\Delta_T = (p_0 + \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\gamma_{A}) - p_0 = \\beta_{A} + \\beta_{\\text{tox}} + \\beta_{S}\\gamma_{A}\n$$\nThis expression decomposes the total effect into the direct effect not mediated by the surrogate ($\\beta_A + \\beta_{\\text{tox}}$) and the effect mediated through the surrogate ($\\beta_S\\gamma_A$).\n\nNow, we substitute the numerical values: $\\beta_{A} = 0$, $\\beta_{\\text{tox}} = 0.19$, $\\beta_{S} = 0.003$, and $\\gamma_{A} = -30$.\n$$\n\\Delta_T = 0 + 0.19 + (0.003) \\times (-30)\n$$\n$$\n\\Delta_T = 0.19 - 0.09 = 0.10\n$$\nThe positive value indicates the therapy increases MACE risk. The beneficial effect mediated through LDL-C reduction (a risk change of $-0.09$) is overwhelmed by the direct harmful off-target toxicity (a risk change of $+0.19$).\n\nRounding to four significant figures, the result is $0.1000$.",
            "answer": "$$\n\\boxed{0.1000}\n$$"
        },
        {
            "introduction": "After establishing a statistical model for a surrogate, the pivotal question becomes: how large an effect on the surrogate is needed to be confident of a real clinical benefit? This hands-on problem introduces the Surrogate Threshold Effect (STE), a powerful concept for making evidence-based decisions in drug development. You will calculate this threshold by constructing a predictive interval that accounts for all sources of uncertainty, providing a clear benchmark for evaluating new therapies. ",
            "id": "5075034",
            "problem": "A translational study evaluates a continuous biomarker surrogate endpoint $S$ for a patient-centered continuous true endpoint $T$, where larger positive values indicate greater clinical benefit for both $S$ and $T$. At the trial level, the treatment effect on $T$ across randomized trials is modeled as a linear random-effects meta-regression on the treatment effect on $S$:\n$$\n\\Delta_T \\;=\\; \\alpha \\;+\\; \\beta\\,\\Delta_S \\;+\\; \\varepsilon,\n$$\nwith $\\varepsilon \\sim \\mathcal{N}(0,\\tau^{2})$ representing between-trial heterogeneity. The parameters are estimated from $K$ independent trials, yielding $\\hat{\\alpha}$ and $\\hat{\\beta}$ with large-sample joint normality, and the following estimated quantities:\n- $\\hat{\\alpha} = 0.05$,\n- $\\hat{\\beta} = 0.80$,\n- $\\operatorname{Var}(\\hat{\\alpha}) = 0.0025$,\n- $\\operatorname{Var}(\\hat{\\beta}) = 0.04$,\n- $\\operatorname{Cov}(\\hat{\\alpha},\\hat{\\beta}) = -0.005$,\n- $\\hat{\\tau}^{2} = 0.04$.\n\nAssume the Studentâ€™s $t$ distribution with $\\nu = 18$ degrees of freedom approximates the predictive uncertainty for a new trial and use the two-sided $0.95$ critical value $t_{0.975,18} = 2.101$. Define the Surrogate Threshold Effect (STE) as the smallest value $s^{\\star}$ of the surrogate effect $\\Delta_S$ such that the lower bound of the $0.95$ predictive interval for the new-trial true effect $\\Delta_T$ at $\\Delta_S = s^{\\star}$ is strictly greater than $0$.\n\nA new treatment shows an observed surrogate effect $s_{\\text{obs}} = 0.55$ in standard deviation units. Compute the STE $s^{\\star}$ under the model and assumptions above. Express your answer in standard deviation units. Round your answer to four significant figures.",
            "solution": "The objective is to compute the Surrogate Threshold Effect (STE), $s^{\\star}$, defined as the smallest surrogate effect $\\Delta_S$ for which the lower bound of the $0.95$ predictive interval for the true effect $\\Delta_T$ is strictly greater than $0$.\n\nThe predicted true effect for a new trial with a given surrogate effect $\\Delta_S$ is $\\hat{\\Delta}_T(\\Delta_S) = \\hat{\\alpha} + \\hat{\\beta}\\Delta_S$.\nA $0.95$ predictive interval for the true effect, $\\Delta_{T, \\text{new}}$, is given by $\\hat{\\Delta}_T(\\Delta_S) \\pm t_{0.975, \\nu} \\times \\text{SE}(\\text{prediction})$.\nThe squared standard error of the prediction accounts for uncertainty in the regression parameters and the between-trial heterogeneity $\\hat{\\tau}^2$:\n$$\n\\text{SE}(\\text{prediction})^2 = \\text{Var}(\\hat{\\alpha} + \\hat{\\beta}\\Delta_S) + \\hat{\\tau}^2 = \\left(\\operatorname{Var}(\\hat{\\alpha}) + (\\Delta_S)^2 \\operatorname{Var}(\\hat{\\beta}) + 2\\Delta_S \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta})\\right) + \\hat{\\tau}^2\n$$\nThe STE, $s^{\\star}$, is found by setting the lower bound of this interval to $0$:\n$$\n(\\hat{\\alpha} + \\hat{\\beta}s^{\\star}) - t_{0.975, \\nu} \\sqrt{\\operatorname{Var}(\\hat{\\alpha}) + (s^{\\star})^2 \\operatorname{Var}(\\hat{\\beta}) + 2s^{\\star} \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}) + \\hat{\\tau}^2} = 0\n$$\nRearranging and squaring both sides gives:\n$$\n(\\hat{\\alpha} + \\hat{\\beta}s^{\\star})^2 = (t_{0.975, \\nu})^2 \\left( \\operatorname{Var}(\\hat{\\alpha}) + (s^{\\star})^2 \\operatorname{Var}(\\hat{\\beta}) + 2s^{\\star} \\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}) + \\hat{\\tau}^2 \\right)\n$$\nThis is a quadratic equation in $s^{\\star}$ of the form $A(s^{\\star})^2 + B s^{\\star} + C = 0$, with coefficients:\n$$\nA = \\hat{\\beta}^2 - t^2\\operatorname{Var}(\\hat{\\beta})\n$$\n$$\nB = 2(\\hat{\\alpha}\\hat{\\beta} - t^2\\operatorname{Cov}(\\hat{\\alpha}, \\hat{\\beta}))\n$$\n$$\nC = \\hat{\\alpha}^2 - t^2(\\operatorname{Var}(\\hat{\\alpha}) + \\hat{\\tau}^2)\n$$\nSubstitute the given values: $\\hat{\\alpha} = 0.05$, $\\hat{\\beta} = 0.80$, $\\operatorname{Var}(\\hat{\\alpha}) = 0.0025$, $\\operatorname{Var}(\\hat{\\beta}) = 0.04$, $\\operatorname{Cov}(\\hat{\\alpha},\\hat{\\beta}) = -0.005$, $\\hat{\\tau}^{2} = 0.04$, and $t = t_{0.975,18} = 2.101$ (so $t^2 \\approx 4.4142$).\n\nComputing the coefficients:\n$$\nA = (0.80)^2 - (4.4142)(0.04) = 0.64 - 0.176568 = 0.463432\n$$\n$$\nB = 2((0.05)(0.80) - (4.4142)(-0.005)) = 2(0.04 + 0.022071) = 0.124142\n$$\n$$\nC = (0.05)^2 - 4.4142(0.0025 + 0.04) = 0.0025 - 4.4142(0.0425) = 0.0025 - 0.1876035 = -0.1851035\n$$\nWe solve $A(s^{\\star})^2 + Bs^{\\star} + C = 0$ using the quadratic formula, $s^{\\star} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$:\n$$\nB^2 - 4AC = (0.124142)^2 - 4(0.463432)(-0.1851035) \\approx 0.015411 + 0.343133 = 0.358544\n$$\n$$\n\\sqrt{B^2 - 4AC} \\approx \\sqrt{0.358544} \\approx 0.598785\n$$\nThe two roots are:\n$$\ns^{\\star}_{1} = \\frac{-0.124142 + 0.598785}{2(0.463432)} = \\frac{0.474643}{0.926864} \\approx 0.51208\n$$\n$$\ns^{\\star}_{2} = \\frac{-0.124142 - 0.598785}{2(0.463432)} = \\frac{-0.722927}{0.926864} \\approx -0.78000\n$$\nWe choose the root that corresponds to the lower bound being zero, which requires the predicted effect $\\hat{\\alpha} + \\hat{\\beta}s^{\\star}$ to be positive (since the square root term is positive).\nFor $s^{\\star}_{1} \\approx 0.51208$, the predicted effect is $0.05 + 0.80(0.51208) \\approx 0.4597 > 0$. This is the valid root.\nFor $s^{\\star}_{2} \\approx -0.78000$, the predicted effect is $0.05 + 0.80(-0.78000) \\approx -0.574  0$. This root corresponds to the upper bound being zero.\nThus, the STE is $s^{\\star} \\approx 0.51208$.\n\nRounding to four significant figures gives $0.5121$.",
            "answer": "$$\\boxed{0.5121}$$"
        }
    ]
}