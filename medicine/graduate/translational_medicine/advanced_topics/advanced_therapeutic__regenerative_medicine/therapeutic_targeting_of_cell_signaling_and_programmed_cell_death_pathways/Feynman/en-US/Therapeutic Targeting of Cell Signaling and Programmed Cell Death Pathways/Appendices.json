{
    "hands_on_practices": [
        {
            "introduction": "A fundamental task in translational pharmacology is to quantify the potency of a drug. For enzyme inhibitors, this is often expressed as the half-maximal inhibitory concentration ($IC_{50}$). This value, however, is not an intrinsic constant; for competitive inhibitors, it depends critically on the concentration of the enzyme's natural substrate. This exercise guides you through the derivation of the Cheng-Prusoff relationship to model how the apparent potency of an ATP-competitive kinase inhibitor changes with fluctuations in intracellular ATP, a common variable in cells with altered metabolism. ",
            "id": "5072055",
            "problem": "Adenosine Triphosphate (ATP)-competitive inhibition of Rapidly Accelerated Fibrosarcoma (RAF) kinase is a common therapeutic strategy in translational medicine to modulate oncogenic cell signaling and influence programmed cell death pathways. Consider a selective ATP-competitive RAF inhibitor whose apparent half maximal inhibitory concentration ($IC_{50}$) is measured in a cellular context at an intracellular Adenosine Triphosphate (ATP) concentration of $[ATP]_{1} = 1.0\\,\\mathrm{mM}$ to be $IC_{50,1} = 12.0\\,\\mathrm{nM}$. The Michaelis constant for ATP at RAF is $K_{m}^{ATP} = 20\\,\\mu\\mathrm{M}$. In a second physiological state (e.g., altered metabolic flux), the intracellular ATP increases to $[ATP]_{2} = 3.0\\,\\mathrm{mM}$. Assume single-substrate Michaelis-Menten kinetics for ATP with purely competitive inhibition by the drug, a fixed enzyme concentration, and an unchanged maximal velocity. Starting from the fundamental definition of Michaelis-Menten kinetics and competitive inhibition, derive the condition-dependent relationship between the inhibitor concentration that halves the reaction velocity and the substrate concentration. Using your derived relationship, predict the new apparent $IC_{50}$ at $[ATP]_{2}$ based on the measured $IC_{50,1}$ at $[ATP]_{1}$. Express your final answer in $\\mathrm{nM}$ and round your answer to four significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of enzyme kinetics, well-posed with sufficient and consistent data, and objectively phrased.\n\nThe problem requires a derivation of the relationship between the half maximal inhibitory concentration ($IC_{50}$) of a competitive inhibitor and the substrate concentration, and then to use this relationship to predict a new $IC_{50}$ value under altered substrate conditions.\n\nThe velocity ($v$) of an enzymatic reaction, following Michaelis-Menten kinetics, is given by:\n$$ v = \\frac{V_{max} [S]}{K_m + [S]} $$\nwhere $V_{max}$ is the maximal reaction velocity, $[S]$ is the substrate concentration, and $K_m$ is the Michaelis constant. For this specific problem, the substrate is Adenosine Triphosphate (ATP), so we denote its concentration as $[ATP]$ and the Michaelis constant as $K_{m}^{ATP}$.\n$$ v_0 = \\frac{V_{max} [ATP]}{K_{m}^{ATP} + [ATP]} $$\nHere, $v_0$ represents the initial velocity in the absence of an inhibitor.\n\nFor a purely competitive inhibitor, the inhibitor molecule ($I$) binds reversibly to the same active site as the substrate. This type of inhibition does not affect $V_{max}$ but increases the apparent Michaelis constant, $K_{m,app}$. The relationship is given by:\n$$ K_{m,app} = K_{m}^{ATP} \\left(1 + \\frac{[I]}{K_i}\\right) $$\nwhere $[I]$ is the inhibitor concentration and $K_i$ is the inhibition constant, representing the dissociation constant of the enzyme-inhibitor complex.\n\nThe reaction velocity in the presence of a competitive inhibitor, $v_I$, is therefore:\n$$ v_I = \\frac{V_{max} [ATP]}{K_{m,app} + [ATP]} = \\frac{V_{max} [ATP]}{K_{m}^{ATP} \\left(1 + \\frac{[I]}{K_i}\\right) + [ATP]} $$\n\nThe $IC_{50}$ is defined as the inhibitor concentration $[I]$ that reduces the reaction velocity to half of its value in the absence of the inhibitor. That is, $v_I = \\frac{1}{2} v_0$ when $[I] = IC_{50}$.\n$$ \\frac{V_{max} [ATP]}{K_{m}^{ATP} \\left(1 + \\frac{IC_{50}}{K_i}\\right) + [ATP]} = \\frac{1}{2} \\left( \\frac{V_{max} [ATP]}{K_{m}^{ATP} + [ATP]} \\right) $$\nAssuming $V_{max} \\ne 0$ and $[ATP] \\ne 0$, we can cancel the term $V_{max} [ATP]$ from both sides of the equation.\n$$ \\frac{1}{K_{m}^{ATP} \\left(1 + \\frac{IC_{50}}{K_i}\\right) + [ATP]} = \\frac{1}{2(K_{m}^{ATP} + [ATP])} $$\nTaking the reciprocal of both sides gives:\n$$ K_{m}^{ATP} \\left(1 + \\frac{IC_{50}}{K_i}\\right) + [ATP] = 2(K_{m}^{ATP} + [ATP]) $$\nExpanding the terms:\n$$ K_{m}^{ATP} + \\frac{K_{m}^{ATP} \\cdot IC_{50}}{K_i} + [ATP] = 2K_{m}^{ATP} + 2[ATP] $$\nTo solve for $IC_{50}$, we isolate the term containing it:\n$$ \\frac{K_{m}^{ATP} \\cdot IC_{50}}{K_i} = (2K_{m}^{ATP} - K_{m}^{ATP}) + (2[ATP] - [ATP]) $$\n$$ \\frac{K_{m}^{ATP} \\cdot IC_{50}}{K_i} = K_{m}^{ATP} + [ATP] $$\nFinally, solving for $IC_{50}$:\n$$ IC_{50} = K_i \\frac{K_{m}^{ATP} + [ATP]}{K_{m}^{ATP}} $$\nThis can be written as:\n$$ IC_{50} = K_i \\left(1 + \\frac{[ATP]}{K_{m}^{ATP}}\\right) $$\nThis is the Cheng-Prusoff equation for competitive inhibition, which is the condition-dependent relationship requested in the problem. It shows that the apparent $IC_{50}$ is linearly dependent on the substrate concentration $[ATP]$.\n\nThe problem provides two conditions. The inhibition constant $K_i$ is an intrinsic property of the inhibitor and enzyme, and thus is constant under both conditions.\nLet $[ATP]_1$ and $IC_{50,1}$ be the values for the first condition, and $[ATP]_2$ and $IC_{50,2}$ be for the second.\nFrom the first condition:\n$$ IC_{50,1} = K_i \\left(1 + \\frac{[ATP]_1}{K_{m}^{ATP}}\\right) \\implies K_i = \\frac{IC_{50,1}}{1 + \\frac{[ATP]_1}{K_{m}^{ATP}}} $$\nFrom the second condition:\n$$ IC_{50,2} = K_i \\left(1 + \\frac{[ATP]_2}{K_{m}^{ATP}}\\right) $$\nSubstituting the expression for $K_i$ from the first condition into the equation for the second:\n$$ IC_{50,2} = \\left(\\frac{IC_{50,1}}{1 + \\frac{[ATP]_1}{K_{m}^{ATP}}}\\right) \\left(1 + \\frac{[ATP]_2}{K_{m}^{ATP}}\\right) $$\n$$ IC_{50,2} = IC_{50,1} \\frac{1 + \\frac{[ATP]_2}{K_{m}^{ATP}}}{1 + \\frac{[ATP]_1}{K_{m}^{ATP}}} $$\nThis final relationship allows us to calculate $IC_{50,2}$ directly from the given data.\n\nThe provided values are:\n$IC_{50,1} = 12.0\\,\\mathrm{nM}$\n$[ATP]_{1} = 1.0\\,\\mathrm{mM}$\n$[ATP]_{2} = 3.0\\,\\mathrm{mM}$\n$K_{m}^{ATP} = 20\\,\\mu\\mathrm{M}$\n\nTo perform the calculation, it is essential to use consistent units for concentrations. We convert all concentrations to $\\mu\\mathrm{M}$:\n$[ATP]_{1} = 1.0\\,\\mathrm{mM} = 1000\\,\\mu\\mathrm{M}$\n$[ATP]_{2} = 3.0\\,\\mathrm{mM} = 3000\\,\\mu\\mathrm{M}$\n$K_{m}^{ATP} = 20\\,\\mu\\mathrm{M}$\nThe initial $IC_{50,1}$ is given in $\\mathrm{nM}$, and the final answer is requested in $\\mathrm{nM}$, so we can leave $IC_{50,1}$ in these units.\n\nNow we can calculate the dimensionless ratios:\n$\\frac{[ATP]_1}{K_{m}^{ATP}} = \\frac{1000\\,\\mu\\mathrm{M}}{20\\,\\mu\\mathrm{M}} = 50$\n$\\frac{[ATP]_2}{K_{m}^{ATP}} = \\frac{3000\\,\\mu\\mathrm{M}}{20\\,\\mu\\mathrm{M}} = 150$\n\nSubstitute these values into the expression for $IC_{50,2}$:\n$$ IC_{50,2} = IC_{50,1} \\frac{1 + 150}{1 + 50} $$\n$$ IC_{50,2} = 12.0\\,\\mathrm{nM} \\times \\frac{151}{51} $$\n$$ IC_{50,2} = 12.0 \\times 2.9607843... \\,\\mathrm{nM} $$\n$$ IC_{50,2} = 35.52941176... \\,\\mathrm{nM} $$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$ IC_{50,2} \\approx 35.53\\,\\mathrm{nM} $$\nThe increase in substrate (ATP) concentration from $1.0\\,\\mathrm{mM}$ to $3.0\\,\\mathrm{mM}$ requires a higher concentration of the competitive inhibitor to achieve the same $50\\%$ inhibition, which is consistent with the mechanism of competitive inhibition. The calculated $IC_{50}$ increases from $12.0\\,\\mathrm{nM}$ to $35.53\\,\\mathrm{nM}$.",
            "answer": "$$\\boxed{35.53}$$"
        },
        {
            "introduction": "Cellular signaling does not occur in isolated pathways but within a complex, interconnected network. Targeting one node in this network can lead to adaptive responses and unexpected feedback effects, a key mechanism of drug resistance. This problem introduces a system of coupled ordinary differential equations (ODEs) to model the cross-talk between the MAPK and PI3K/AKT pathways. By analyzing the system's steady-state behavior, you will explore the conditions that cause 'paradoxical upregulation'—where inhibiting one pathway boosts the activity of another—and implement a numerical solution to quantify these network effects. ",
            "id": "5072010",
            "problem": "Consider a coarse-grained dynamical model of coupled signaling outputs from Mitogen-Activated Protein Kinase (MAPK) and Phosphoinositide 3-Kinase (PI3K)-Protein Kinase B (AKT) pathways in a single cell under a constant upstream stimulus. Let $E(t)$ denote the dimensionless activity of extracellular signal-regulated kinases (ERK, a canonical MAPK output), and $A(t)$ denote the dimensionless activity of AKT (a canonical PI3K output). Assume constant stimulus $S \\ge 0$, activation proportional to stimulus with effective gains, and linear degradation. Cross-inhibition is represented by relief of negative feedback through reciprocal denominators. The ordinary differential equations are\n$$\n\\frac{dE}{dt} = \\frac{k_E \\, h_E \\, S}{1 + c_{AE} \\, A} - d_E \\, E,\n\\qquad\n\\frac{dA}{dt} = \\frac{k_A \\, h_A \\, S}{1 + c_{EA} \\, E} - d_A \\, A,\n$$\nwhere $k_E, k_A \\ge 0$ are pathway activation gains, $d_E, d_A > 0$ are linear degradation rates, $c_{AE}, c_{EA} \\ge 0$ are nonnegative cross-inhibition strengths from AKT to ERK and from ERK to AKT respectively, and $h_E, h_A \\in [0,1]$ are inhibition factors induced by drugs targeting the MAPK and PI3K arms, respectively. All variables and parameters are dimensionless. Under a constant $S$, steady states $(E^*,A^*)$ satisfy $dE/dt = 0$ and $dA/dt = 0$.\n\nStarting from the above definitions and the law of mass action (activation proportional to stimulus, linear degradation), derive the algebraic steady-state conditions and show the parameter regimes under which inhibiting one pathway (reducing $h_A$ or $h_E$) upregulates the other pathway via relief of negative feedback. Then compute the steady states $(E^*,A^*)$ numerically for the parameter sets in the test suite specified below. In all computations, interpret the physiologically relevant steady state as the nonnegative solution.\n\nYou must:\n- Derive the coupled steady-state equations from first principles and reduce them to a single quadratic equation in one variable to establish existence and uniqueness of a nonnegative steady state under $c_{AE} \\ge 0$, $c_{EA} \\ge 0$, $S \\ge 0$, $k_E, k_A \\ge 0$, and $d_E, d_A > 0$.\n- Prove analytically the condition under which inhibition of one pathway increases the steady-state activity of the other pathway through relief of negative feedback, expressed in terms of the signs of $c_{AE}$ and $c_{EA}$ and the monotonicity of the steady states with respect to $h_A$ and $h_E$.\n- Implement a program that, given parameters $(S,k_E,d_E,k_A,d_A,c_{AE},c_{EA},h_E,h_A)$, computes $(E^*,A^*)$ by solving the derived quadratic in closed form. When multiple real roots exist, choose the nonnegative root enforced by the model structure.\n- Express the outputs $(E^*,A^*)$ as floats rounded to six decimal places.\n\nTest suite:\n1. Baseline cross-inhibition, no drugs: $S=1$, $k_E=2$, $d_E=1$, $k_A=3$, $d_A=1$, $c_{AE}=0.5$, $c_{EA}=0.25$, $h_E=1$, $h_A=1$.\n2. Strong PI3K-AKT inhibition: same as case 1 but $h_A=0.2$.\n3. Strong MAPK inhibition: same as case 1 but $h_E=0.2$.\n4. No cross-talk: $S=1$, $k_E=2$, $d_E=1$, $k_A=3$, $d_A=1$, $c_{AE}=0$, $c_{EA}=0$, $h_E=1$, $h_A=1$.\n5. Extreme PI3K-AKT shutoff: same as case 1 but $h_A=0$.\n6. Asymmetric cross-talk (only ERK inhibits AKT): $S=1$, $k_E=2$, $d_E=1$, $k_A=3$, $d_A=1$, $c_{AE}=0$, $c_{EA}=0.25$, $h_E=1$, $h_A=0.2$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-float list $[E^*,A^*]$ rounded to six decimal places. For example, the output must look like\n$$\n[[E_1^*,A_1^*],[E_2^*,A_2^*],\\ldots,[E_n^*,A_n^*]]\n$$\nwith no spaces inserted by your program.",
            "solution": "#### Derivation of Steady-State Equations\nThe steady states $(E^*, A^*)$ are the solutions to the system when the time derivatives are zero.\nSetting $\\frac{dE}{dt} = 0$ and $\\frac{dA}{dt} = 0$:\n$$\n\\frac{k_E \\, h_E \\, S}{1 + c_{AE} \\, A^*} - d_E \\, E^* = 0 \\quad \\implies \\quad d_E \\, E^* (1 + c_{AE} \\, A^*) = k_E \\, h_E \\, S \\quad (1)\n$$\n$$\n\\frac{k_A \\, h_A \\, S}{1 + c_{EA} \\, E^*} - d_A \\, A^* = 0 \\quad \\implies \\quad d_A \\, A^* (1 + c_{EA} \\, E^*) = k_A \\, h_A \\, S \\quad (2)\n$$\nThese two coupled algebraic equations define the steady-state activities $E^*$ and $A^*$.\n\n#### Reduction to a Quadratic Equation and Proof of Unique Nonnegative Solution\nTo solve this system, we can express one variable in terms of the other and substitute. From equation (2), we can solve for $A^*$:\n$$\nA^* = \\frac{k_A \\, h_A \\, S}{d_A(1 + c_{EA} \\, E^*)} \\quad (3)\n$$\nThis is valid as long as the denominator is non-zero. Since $d_A > 0$ and all other parameters and variables are non-negative, the denominator is always positive.\n\nNow, we substitute this expression for $A^*$ into equation (1):\n$$\nd_E \\, E^* \\left(1 + c_{AE} \\left[ \\frac{k_A \\, h_A \\, S}{d_A(1 + c_{EA} \\, E^*)} \\right] \\right) = k_E \\, h_E \\, S\n$$\nTo eliminate the fraction in the parentheses, we multiply both sides by $d_A(1 + c_{EA} \\, E^*)$:\n$$\nd_E \\, E^* \\left( d_A(1 + c_{EA} \\, E^*) + c_{AE} k_A h_A S \\right) = k_E h_E S \\, d_A (1 + c_{EA} \\, E^*)\n$$\nExpanding both sides gives:\n$$\nd_A d_E E^* (1 + c_{EA} \\, E^*) + d_E E^* c_{AE} k_A h_A S = k_E h_E S d_A + k_E h_E S d_A c_{EA} E^*\n$$\n$$\nd_A d_E E^* + d_A d_E c_{EA} (E^*)^2 + d_E c_{AE} k_A h_A S E^* = k_E h_E S d_A + k_E h_E S d_A c_{EA} E^*\n$$\nRearranging this into the standard quadratic form $p(E^*)^2 + qE^* + r = 0$:\n$$\n(d_A d_E c_{EA}) (E^*)^2 + (d_A d_E + d_E S (c_{AE} k_A h_A) - d_A S (k_E h_E c_{EA})) E^* - k_E h_E S d_A = 0\n$$\nLet's define the coefficients $p, q, r$:\n- $p = d_A d_E c_{EA}$\n- $q = d_A d_E + d_E S (c_{AE} k_A h_A) - d_A S (k_E h_E c_{EA})$\n- $r = -k_E h_E S d_A$\n\n**Existence and Uniqueness of a Nonnegative Solution:**\nWe analyze the signs of the coefficients, given the parameter constraints ($d_E, d_A > 0$; $k_E, k_A, c_{AE}, c_{EA}, S \\ge 0$; $h_E, h_A \\in [0,1]$).\n- $p = d_A d_E c_{EA} \\ge 0$.\n- $r = -k_E h_E S d_A \\le 0$.\n\nCase 1: $c_{EA} > 0$ and a non-trivial stimulus ($k_E>0, h_E>0, S>0$).\nIn this case, $p > 0$ and $r < 0$. The product of the roots of the quadratic equation is $r/p < 0$. This implies that there are two distinct real roots: one positive and one negative. Since activity levels cannot be negative, the single positive root is the unique, physiologically relevant steady state for $E^*$. Once this unique positive $E^*$ is found, a unique non-negative $A^*$ is determined by equation (3).\n\nCase 2: $c_{EA} = 0$.\nIn this case, $p=0$, and the equation becomes linear: $qE^* + r = 0$.\n$q = d_A d_E + d_E c_{AE} k_A h_A S > 0$ (since $d_A, d_E>0$).\n$r = -k_E h_E S d_A \\le 0$.\nThe solution is $E^* = -r/q \\ge 0$. A unique non-negative solution for $E^*$ exists.\n\nCase 3: Trivial stimulus for E ($k_E=0$ or $h_E=0$ or $S=0$).\nIn this case, $r=0$. The equation becomes $p(E^*)^2 + qE^* = 0$, or $E^*(pE^* + q) = 0$.\nThe roots are $E^*=0$ and $E^*=-q/p$.\nIf $c_{EA}>0$ (so $p>0$), we must check the sign of $-q/p$. The sign of $q$ is not guaranteed to be positive. However, if $k_E h_E S = 0$, then $q=d_A d_E + d_E c_{AE} k_A h_A S \\ge 0$. Thus, $-q/p \\le 0$. So the only non-negative root is $E^*=0$.\nIf $c_{EA}=0$ (so $p=0$), the linear equation from Case 2 applies. With $r=0$, we get $qE^*=0$, which implies $E^*=0$ as $q>0$.\n\nIn all physically relevant scenarios, there exists a unique non-negative steady state $(E^*, A^*)$.\n\n#### Analytical Condition for Upregulation via Inhibition\nWe wish to find the condition under which inhibiting one pathway (e.g., decreasing $h_A$) leads to an increase in the steady-state activity of the other pathway (an increase in $E^*$). This means we need to evaluate the sign of $\\frac{\\partial E^*}{\\partial h_A}$.\n\nWe can use implicit differentiation on the steady-state equations (1) and (2). Differentiating with respect to $h_A$:\n$$\n\\frac{\\partial}{\\partial h_A} [d_E E^* (1 + c_{AE} A^*)] = \\frac{\\partial}{\\partial h_A} [k_E h_E S] \\implies d_E \\frac{\\partial E^*}{\\partial h_A}(1 + c_{AE} A^*) + d_E E^* c_{AE} \\frac{\\partial A^*}{\\partial h_A} = 0 \\quad (4)\n$$\n$$\n\\frac{\\partial}{\\partial h_A} [d_A A^* (1 + c_{EA} E^*)] = \\frac{\\partial}{\\partial h_A} [k_A h_A S] \\implies d_A \\frac{\\partial A^*}{\\partial h_A}(1 + c_{EA} E^*) + d_A A^* c_{EA} \\frac{\\partial E^*}{\\partial h_A} = k_A S \\quad (5)\n$$\nFrom (4), assuming $c_{AE}>0$:\n$$\n\\frac{\\partial E^*}{\\partial h_A} = - \\frac{E^* c_{AE}}{1 + c_{AE} A^*} \\frac{\\partial A^*}{\\partial h_A} \\quad (6)\n$$\nThis shows that $\\frac{\\partial E^*}{\\partial h_A}$ and $\\frac{\\partial A^*}{\\partial h_A}$ have opposite signs if $c_{AE} > 0$.\nSubstituting (6) into (5):\n$$\nd_A \\frac{\\partial A^*}{\\partial h_A}(1 + c_{EA} E^*) + d_A A^* c_{EA} \\left(- \\frac{E^* c_{AE}}{1 + c_{AE} A^*} \\frac{\\partial A^*}{\\partial h_A}\\right) = k_A S\n$$\nFactoring out $\\frac{\\partial A^*}{\\partial h_A}$:\n$$\n\\frac{\\partial A^*}{\\partial h_A} \\left[ d_A (1 + c_{EA} E^*) - \\frac{d_A A^* E^* c_{EA} c_{AE}}{1 + c_{AE} A^*} \\right] = k_A S\n$$\nThe term in the square brackets simplifies to:\n$$\n\\frac{d_A [(1 + c_{EA} E^*)(1 + c_{AE} A^*) - A^* E^* c_{EA} c_{AE}]}{1 + c_{AE} A^*} = \\frac{d_A [1 + c_{EA} E^* + c_{AE} A^*]}{1 + c_{AE} A^*}\n$$\nSince all parameters and variables are non-negative and $d_A>0$, this term is positive. As $k_A S \\ge 0$, we find that $\\frac{\\partial A^*}{\\partial h_A} \\ge 0$. This is intuitive: increasing $h_A$ (less inhibition) increases $A^*$.\nFrom equation (6), since $\\frac{\\partial A^*}{\\partial h_A} \\ge 0$ and the fraction multiplying it is non-negative, we conclude $\\frac{\\partial E^*}{\\partial h_A} \\le 0$.\nTherefore, a decrease in $h_A$ (inhibition of the A pathway) leads to an increase in $E^*$. This paradoxical upregulation of $E^*$ occurs if and only if the cross-inhibition term $c_{AE}$ is strictly positive ($c_{AE} > 0$). If $c_{AE}=0$, equation (4) becomes $d_E \\frac{\\partial E^*}{\\partial h_A} = 0$, so $E^*$ is independent of $h_A$, and no upregulation occurs.\n\nBy symmetry, inhibiting the E pathway (decreasing $h_E$) will cause an upregulation in $A^*$ if and only if $c_{EA} > 0$.\n\nThis completes the analytical proof.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state activities (E*, A*) for a coupled signaling\n    pathway model under different parameter conditions.\n    \"\"\"\n    \n    test_cases = [\n        # 1. Baseline cross-inhibition, no drugs\n        (1, 2, 1, 3, 1, 0.5, 0.25, 1, 1),\n        # 2. Strong PI3K-AKT inhibition\n        (1, 2, 1, 3, 1, 0.5, 0.25, 1, 0.2),\n        # 3. Strong MAPK inhibition\n        (1, 2, 1, 3, 1, 0.5, 0.25, 0.2, 1),\n        # 4. No cross-talk\n        (1, 2, 1, 3, 1, 0, 0, 1, 1),\n        # 5. Extreme PI3K-AKT shutoff\n        (1, 2, 1, 3, 1, 0.5, 0.25, 1, 0),\n        # 6. Asymmetric cross-talk (only ERK inhibits AKT)\n        (1, 2, 1, 3, 1, 0, 0.25, 1, 0.2),\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        S, k_E, d_E, k_A, d_A, c_AE, c_EA, h_E, h_A = params\n        \n        # Coefficients of the quadratic equation p*(E**2) + q*E + r = 0 for E_star\n        p = d_A * d_E * c_EA\n        q = d_A * d_E + d_E * S * c_AE * k_A * h_A - d_A * S * k_E * h_E * c_EA\n        r = -k_E * h_E * S * d_A\n        \n        E_star = 0.0\n        \n        # Check for trivial case where the stimulus for E is zero\n        if np.isclose(k_E * h_E * S, 0):\n            E_star = 0.0\n        # Case 1: Linear equation (no feedback from E to A, c_EA=0)\n        elif np.isclose(p, 0):\n            # The equation is q*E_star + r = 0.\n            # q is always > 0 for d_A, d_E > 0, so no division by zero risk.\n            E_star = -r / q\n        # Case 2: Quadratic equation\n        else:\n            # Discriminant: D = q**2 - 4*p*r.\n            # Since p >= 0 and r <= 0, -4*p*r >= 0, so D >= 0 always.\n            discriminant = q**2 - 4 * p * r\n            sqrt_discriminant = np.sqrt(discriminant)\n            \n            # The two roots are (-q +/- sqrt(D)) / (2p).\n            # As shown in the derivation, p>=0 and r<=0 implies one root\n            # is non-negative and one is non-positive. We select the non-negative one.\n            # If p > 0, the non-negative root is (-q + sqrt(D)) / (2p).\n            E_star = (-q + sqrt_discriminant) / (2 * p)\n\n        # Calculate A_star using the steady-state equation for A\n        # A_star = k_A*h_A*S / (d_A * (1 + c_EA * E_star))\n        denominator_A = d_A * (1 + c_EA * E_star)\n        if np.isclose(denominator_A, 0):\n            # This case should not be reached with valid parameters,\n            # but as a safeguard, if stimulus for A is 0, A_star is 0.\n            if np.isclose(k_A * h_A * S, 0):\n                A_star = 0.0\n            else:\n                # Represents an unphysical infinite concentration\n                A_star = np.inf \n        else:\n            A_star = (k_A * h_A * S) / denominator_A\n\n        results.append([E_star, A_star])\n\n    # Format the entire output string as specified: [[E1,A1],[E2,A2],...]\n    # with 6 decimal places and no spaces.\n    formatted_pairs = []\n    for e_val, a_val in results:\n        formatted_pairs.append(f\"[{e_val:.6f},{a_val:.6f}]\")\n    \n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Deterministic models can describe the average behavior of a cell population, but they often miss the cell-to-cell variability that underlies phenomena like drug resistance and fractional killing. This exercise introduces a stochastic framework to model the critical apoptosis initiation switch, which is governed by the balance between pro-apoptotic BH3-only and anti-apoptotic BCL-2 family proteins. You will implement a Monte Carlo simulation to calculate the probability that a cell will undergo apoptosis, providing a powerful, hands-on approach to predicting heterogeneous cell fate decisions based on protein expression variability. ",
            "id": "5071931",
            "problem": "A stochastic threshold model for apoptosis initiation can be framed using biochemical mass action principles for reversible binding between B-cell lymphoma 2 (BCL-2) and BCL-2 homology 3-only proteins (BH3-only). Consider total concentrations $X$ (BH3-only) and $Y$ (BCL-2), each a positive random variable. At equilibrium, BH3-only proteins bind anti-apoptotic BCL-2 in a $1{:}1$ complex with dissociation constant $K_d$ defined by the law of mass action: $$K_d = \\frac{X_{\\mathrm{free}} \\, Y_{\\mathrm{free}}}{C},$$ where $C$ is the concentration of the BH3:BCL-2 complex, $X_{\\mathrm{free}}$ is the free BH3-only concentration, and $Y_{\\mathrm{free}}$ is the free BCL-2 concentration. Conservation relations impose $$X = X_{\\mathrm{free}} + C,\\quad Y = Y_{\\mathrm{free}} + C.$$ Combining the definitions yields $$K_d \\, C = (X - C)(Y - C),$$ which expands to a quadratic in $C$: $$C^2 - (X + Y + K_d) \\, C + X Y = 0.$$ The physically admissible root that satisfies $0 \\le C \\le \\min\\{X, Y\\}$ is $$C = \\frac{(X + Y + K_d) - \\sqrt{(X + Y + K_d)^2 - 4 X Y}}{2},$$ and the free BH3-only level is $$X_{\\mathrm{free}} = X - C.$$ Apoptosis is assumed to initiate if and only if $X_{\\mathrm{free}} \\ge T$, where $T$ is a fixed activation threshold in nanomolar ($\\mathrm{nM}$). The task is to compute the probability of apoptosis initiation $$\\mathbb{P}\\left(X_{\\mathrm{free}} \\ge T\\right)$$ under stochastic variability of $X$ and $Y$.\n\nAssume $X$ and $Y$ are independent and log-normally distributed: $$X \\sim \\mathrm{LogNormal}(\\mu_X, \\sigma_X), \\quad Y \\sim \\mathrm{LogNormal}(\\mu_Y, \\sigma_Y),$$ meaning $\\ln(X) \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$ and $\\ln(Y) \\sim \\mathcal{N}(\\mu_Y, \\sigma_Y^2)$, with natural logarithm. All concentrations and $K_d$ are expressed in $\\mathrm{nM}$, while probabilities are unitless and must be expressed as decimals. The computation must use Monte Carlo sampling with $N$ draws per test case, and the pseudo-random number generator must be initialized with seed $12345$ for reproducibility.\n\nImplement a program that, for each specified test case, estimates $$\\mathbb{P}\\left(X_{\\mathrm{free}} \\ge T\\right)$$ by sampling $X$ and $Y$, computing $C$ via the above quadratic expression, then $X_{\\mathrm{free}}$, and finally the fraction of samples satisfying $X_{\\mathrm{free}} \\ge T$. To ensure physical realism, any computed $C$ must be clamped to $[0, \\min\\{X, Y\\}]$ before computing $X_{\\mathrm{free}}$.\n\nUse the following test suite, with all parameters in $\\mathrm{nM}$ except $(\\mu, \\sigma)$ which parameterize the log-normal distributions in natural logarithm space:\n\n- Test case $1$ (general case, moderate binding):\n  - $\\mu_X = \\ln(100)$, $\\sigma_X = 0.5$\n  - $\\mu_Y = \\ln(150)$, $\\sigma_Y = 0.4$\n  - $K_d = 10$, $T = 50$, $N = 200000$\n\n- Test case $2$ (degenerate variability, deterministic levels):\n  - $\\mu_X = \\ln(80)$, $\\sigma_X = 0$\n  - $\\mu_Y = \\ln(100)$, $\\sigma_Y = 0$\n  - $K_d = 1$, $T = 10$, $N = 100000$\n\n- Test case $3$ (tight binding, anti-apoptotic dominance):\n  - $\\mu_X = \\ln(50)$, $\\sigma_X = 0.7$\n  - $\\mu_Y = \\ln(200)$, $\\sigma_Y = 0.6$\n  - $K_d = 1$, $T = 30$, $N = 200000$\n\n- Test case $4$ (weak binding, symmetric expression):\n  - $\\mu_X = \\ln(120)$, $\\sigma_X = 0.3$\n  - $\\mu_Y = \\ln(120)$, $\\sigma_Y = 0.3$\n  - $K_d = 10000$, $T = 50$, $N = 200000$\n\n- Test case $5$ (boundary threshold, any binding):\n  - $\\mu_X = \\ln(75)$, $\\sigma_X = 0.5$\n  - $\\mu_Y = \\ln(75)$, $\\sigma_Y = 0.5$\n  - $K_d = 5$, $T = 0$, $N = 100000$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each probability rounded to six decimal places (e.g., $$[0.123456,0.000000,0.987654]$$). No units may appear in the output; probabilities must be decimals only.",
            "solution": "The objective is to estimate the probability of apoptosis initiation in a stochastic threshold model where free BH3-only proteins overcome a threshold in the presence of anti-apoptotic BCL-2 binding. The principle-based approach starts from the law of mass action for reversible binding and uses conservation of mass for the binding partners, then applies probabilistic estimation via Monte Carlo sampling under log-normal variability.\n\nFoundational biochemical principle: for a reversible $1{:}1$ binding reaction between BH3-only and BCL-2, the dissociation constant $K_d$ is defined by $$K_d = \\frac{[{\\mathrm{BH3}}]_{\\mathrm{free}} \\cdot [{\\mathrm{BCL2}}]_{\\mathrm{free}}}{[{\\mathrm{complex}}]}.$$ Writing total concentrations as $X$ for BH3-only and $Y$ for BCL-2, with $C$ as the complex concentration, conservation gives $$X = X_{\\mathrm{free}} + C, \\quad Y = Y_{\\mathrm{free}} + C.$$ Substituting these into the definition yields $$K_d \\cdot C = (X - C)(Y - C).$$ Expanding and reorganizing terms leads to a quadratic in $C$: $$C^2 - (X + Y + K_d) C + XY = 0.$$ The discriminant is $$\\Delta = (X + Y + K_d)^2 - 4XY = K_d^2 + 2K_d(X+Y) + (X - Y)^2 \\ge 0,$$ guaranteeing real roots for all nonnegative $X$, $Y$, and $K_d$. The physically admissible solution must obey $0 \\le C \\le \\min\\{X, Y\\}$, which corresponds to selecting the smaller root: $$C = \\frac{(X + Y + K_d) - \\sqrt{(X + Y + K_d)^2 - 4XY}}{2}.$$ The free BH3-only concentration then is $$X_{\\mathrm{free}} = X - C.$$ Apoptosis initiation is modeled as the event $$X_{\\mathrm{free}} \\ge T,$$ for a fixed threshold $T$ expressed in nanomolar. The binding behavior limits to well-understood regimes: when $K_d \\to 0$ (very tight binding), the formula recovers $C \\to \\min\\{X, Y\\}$ so $X_{\\mathrm{free}} \\to \\max\\{0, X - Y\\}$; when $K_d \\to \\infty$ (very weak binding), $C \\to 0$ so $X_{\\mathrm{free}} \\to X$.\n\nStochasticity: assume independent log-normal distributions $$X \\sim \\mathrm{LogNormal}(\\mu_X, \\sigma_X), \\quad Y \\sim \\mathrm{LogNormal}(\\mu_Y, \\sigma_Y),$$ with $\\ln(X) \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$ and $\\ln(Y) \\sim \\mathcal{N}(\\mu_Y, \\sigma_Y^2)$. This choice is well-supported biologically for protein expression variability because multiplicative noise and positive support are realistic, and mathematically it ensures $X > 0$ and $Y > 0$ almost surely. When $\\sigma = 0$, the distribution is degenerate at $\\exp(\\mu)$, which is a meaningful boundary case.\n\nAlgorithmic design for Monte Carlo estimation:\n- Draw $N$ independent samples $Z_X \\sim \\mathcal{N}(0, 1)$ and $Z_Y \\sim \\mathcal{N}(0, 1)$.\n- Transform to concentrations: $$X = \\exp(\\mu_X + \\sigma_X Z_X), \\quad Y = \\exp(\\mu_Y + \\sigma_Y Z_Y).$$ For $\\sigma = 0$, this reduces to deterministic $X = \\exp(\\mu_X)$ and $Y = \\exp(\\mu_Y)$.\n- Compute $$S = X + Y + K_d,$$ $$\\Delta = S^2 - 4XY = K_d^2 + 2K_d(X+Y) + (X-Y)^2,$$ $$C = \\frac{S - \\sqrt{\\Delta}}{2}.$$ To enforce physical constraints and guard against numerical round-off, clamp $$C \\leftarrow \\min\\{\\max\\{C, 0\\}, \\min\\{X, Y\\}\\}.$$\n- Compute $$X_{\\mathrm{free}} = X - C.$$\n- Estimate $$\\widehat{p} = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}\\{X_{\\mathrm{free}, i} \\ge T\\},$$ where $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n- Round $\\widehat{p}$ to six decimal places for output.\n\nReproducibility requires initializing the pseudo-random number generator with a fixed seed, set here to $12345$. The vectorized implementation using numerical arrays ensures computational efficiency. The discriminant formula guarantees numerical stability because it is the sum of nonnegative terms, preventing negative values under the square root due to algebraic identity rather than cancellation-prone forms.\n\nTest suite rationale:\n- Test case $1$ examines a moderate binding regime with asymmetric expression means; a typical translational setting.\n- Test case $2$ probes the deterministic boundary ($\\sigma = 0$), verifying correct handling of conservation and binding.\n- Test case $3$ explores tight binding with anti-apoptotic dominance; probability should be low because $Y$ tends to sequester $X$.\n- Test case $4$ examines weak binding at symmetric means; probability should largely reflect the distribution of $X$ against the threshold.\n- Test case $5$ uses threshold $T = 0$, a mathematical boundary where, given physical constraints $X_{\\mathrm{free}} \\ge 0$, the probability should be exactly $1$.\n\nFinally, the program aggregates the estimated probabilities in the specified single-line output format, with each probability rounded to six decimal places and the list enclosed in square brackets.",
            "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5\nimport numpy as np\n\ndef estimate_probability(mu_x, sigma_x, mu_y, sigma_y, Kd, T, N, rng):\n    \"\"\"\n    Estimate P(X_free >= T) where X_free is computed from mass action binding\n    between BH3-only (X) and BCL-2 (Y) with dissociation constant Kd.\n\n    Parameters:\n        mu_x, sigma_x: log-normal parameters for X (ln-space)\n        mu_y, sigma_y: log-normal parameters for Y (ln-space)\n        Kd: dissociation constant (nM)\n        T: threshold for apoptosis (nM)\n        N: number of Monte Carlo samples\n        rng: numpy random generator\n    Returns:\n        Probability estimate as float\n    \"\"\"\n    # Sample log-normal variables: X = exp(mu_x + sigma_x * Zx), Y similarly.\n    # Handle sigma==0 seamlessly (deterministic samples) via multiplication by zero.\n    Zx = rng.standard_normal(N)\n    Zy = rng.standard_normal(N)\n    X = np.exp(mu_x + sigma_x * Zx)\n    Y = np.exp(mu_y + sigma_y * Zy)\n\n    # Compute complex concentration C via the physically admissible quadratic root:\n    # C = ((X + Y + Kd) - sqrt((X + Y + Kd)^2 - 4*X*Y)) / 2\n    S = X + Y + Kd\n    # Discriminant computed in a numerically stable form:\n    # Delta = Kd^2 + 2*Kd*(X+Y) + (X - Y)^2\n    Delta = Kd * Kd + 2.0 * Kd * (X + Y) + (X - Y) * (X - Y)\n    sqrtDelta = np.sqrt(Delta)\n    C = (S - sqrtDelta) * 0.5\n\n    # Clamp C to [0, min(X, Y)] to enforce physical constraints and numerical safety.\n    min_xy = np.minimum(X, Y)\n    C = np.clip(C, 0.0, min_xy)\n\n    # Free BH3-only concentration\n    X_free = X - C\n\n    # Probability that free BH3 exceeds threshold T\n    prob = float(np.mean(X_free >= T))\n    return prob\n\ndef solve():\n    # Define RNG with fixed seed for reproducibility\n    rng = np.random.default_rng(12345)\n\n    # Define the test cases as per the problem statement.\n    # Each tuple: (mu_x, sigma_x, mu_y, sigma_y, Kd, T, N)\n    test_cases = [\n        (np.log(100.0), 0.5, np.log(150.0), 0.4, 10.0, 50.0, 200000),   # Case 1\n        (np.log(80.0), 0.0, np.log(100.0), 0.0, 1.0, 10.0, 100000),     # Case 2\n        (np.log(50.0), 0.7, np.log(200.0), 0.6, 1.0, 30.0, 200000),     # Case 3\n        (np.log(120.0), 0.3, np.log(120.0), 0.3, 10000.0, 50.0, 200000),# Case 4\n        (np.log(75.0), 0.5, np.log(75.0), 0.5, 5.0, 0.0, 100000),       # Case 5\n    ]\n\n    results = []\n    for mu_x, sigma_x, mu_y, sigma_y, Kd, T, N in test_cases:\n        p = estimate_probability(mu_x, sigma_x, mu_y, sigma_y, Kd, T, N, rng)\n        results.append(f\"{p:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}