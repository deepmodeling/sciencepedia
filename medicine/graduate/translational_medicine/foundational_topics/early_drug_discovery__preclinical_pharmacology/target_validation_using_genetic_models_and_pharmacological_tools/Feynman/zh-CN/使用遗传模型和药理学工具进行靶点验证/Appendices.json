{
    "hands_on_practices": [
        {
            "introduction": "在药理学中，我们通常使用半数抑制浓度（$IC_{50}$）来衡量药物的效力。然而，$IC_{50}$ 并非药物的内在属性，它依赖于实验条件，特别是底物浓度。本练习将演示如何使用程-普索夫（Cheng-Prusoff）方程，将依赖于实验背景的 $IC_{50}$ 值转换为内在的抑制常数 $K_i$。掌握这种转换对于在不同实验间比较抑制剂以及准确评估化合物对其靶点的真实亲和力至关重要。",
            "id": "5067332",
            "problem": "一个转化医学团队正在同时使用遗传模型和药理学工具来验证一个激酶靶点。成簇规律间隔短回文重复序列干扰（CRISPRi）被用于降低靶点表达，并确认药理学读数是靶点介导的。独立地，在严格控制的体外条件下，进行了一项生化测定，以量化一种三磷酸腺苷（ATP）竞争性小分子抑制剂对该激酶活性位点的亲和力。该测定在固定的底物浓度下，测量初始速率作为抑制剂浓度的函数，并报告半数最大抑制浓度（$IC_{50}$）。\n\n从单底物 Michaelis–Menten 模型和稳态条件下纯竞争性抑制的定义出发，推导在固定底物浓度 $[S]$ 下，连接半数最大抑制浓度 $IC_{50}$ 与抑制常数 $K_i$ 之间的关系。明确说明在该整合了遗传模型与药理学工具的靶点验证背景下，为使此推断有效所需满足的机理假设。\n\n然后，使用推导出的关系，根据在相同生化测定缓冲液中获得的以下数据计算 $K_i$：\n- ATP 的米氏常数为 $K_m = 50\\,\\mu\\mathrm{M}$。\n- 抑制实验中使用的固定 ATP 浓度为 $[S] = 100\\,\\mu\\mathrm{M}$。\n- 测得的抑制剂半数最大抑制浓度为 $IC_{50} = 187\\,\\mathrm{nM}$。\n\n以纳摩尔（nM）为单位表示 $K_i$ 的最终值，并将您的答案四舍五入至 $3$ 位有效数字。",
            "solution": "该问题要求推导竞争性抑制剂的半数最大抑制浓度 ($IC_{50}$) 和抑制常数 ($K_i$) 之间的关系，然后根据提供的实验数据计算 $K_i$。\n\n### 步骤1：竞争性抑制的 Cheng-Prusoff 方程推导\n\n我们从酶促反应的单底物 Michaelis-Menten 模型开始。在没有抑制剂的情况下，反应的初始速率 $v_0$ 由以下公式给出：\n$$\nv_0 = \\frac{V_{max} [S]}{K_m + [S]}\n$$\n其中 $V_{max}$ 是最大反应速率，$[S]$ 是底物浓度，$K_m$ 是米氏常数。\n\n接下来，我们引入一个纯竞争性抑制剂 $I$。在此模型中，抑制剂仅可逆地与游离酶 $E$ 结合，形成无活性的酶-抑制剂复合物 $EI$。它不与酶-底物复合物 $ES$ 结合。抑制剂的结合平衡为：\n$$\nE + I \\rightleftharpoons EI\n$$\n该平衡的解离常数即抑制常数 $K_i$：\n$$\nK_i = \\frac{[E][I]}{[EI]}\n$$\n在竞争性抑制下，抑制剂有效降低了可用于结合底物的游离酶浓度。这增加了表观米氏常数 $K_{m,app}$，而不影响最大速率 $V_{max}$。总酶 $[E]_t$ 的稳态质量平衡为：\n$$\n[E]_t = [E] + [ES] + [EI]\n$$\n根据 $K_i$ 的定义，我们可以将 $[EI]$ 表示为 $[EI] = \\frac{[E][I]}{K_i}$。将其代入质量平衡方程：\n$$\n[E]_t = [E] + [ES] + \\frac{[E][I]}{K_i} = [E]\\left(1 + \\frac{[I]}{K_i}\\right) + [ES]\n$$\n根据 Michaelis-Menten 模型的稳态假设，我们还有 $[E] = \\frac{K_m [ES]}{[S]}$。代入这个 $[E]$ 的表达式：\n$$\n[E]_t = \\frac{K_m [ES]}{[S]}\\left(1 + \\frac{[I]}{K_i}\\right) + [ES] = [ES] \\left[\\frac{K_m}{[S]}\\left(1 + \\frac{[I]}{K_i}\\right) + 1\\right]\n$$\n在抑制剂存在下的反应速率 $v_i$ 为 $v_i = k_{cat}[ES]$。最大速率为 $V_{max} = k_{cat}[E]_t$。通过代入这些关系，我们得到：\n$$\n\\frac{V_{max}}{k_{cat}} = \\frac{v_i}{k_{cat}} \\left[\\frac{K_m\\left(1 + \\frac{[I]}{K_i}\\right) + [S]}{[S]}\\right]\n$$\n对 $v_i$ 进行整理，得到竞争性抑制的 Michaelis-Menten 方程：\n$$\nv_i = \\frac{V_{max}[S]}{K_m\\left(1 + \\frac{[I]}{K_i}\\right) + [S]}\n$$\n项 $K_m(1 + \\frac{[I]}{K_i})$ 是表观米氏常数 $K_{m,app}$。\n\n半数最大抑制浓度 $IC_{50}$ 定义为将反应速率降低到无抑制时速率一半的抑制剂浓度 $[I]$。也就是说，当 $[I] = IC_{50}$ 时，速率 $v_i$ 等于 $\\frac{1}{2}v_0$。\n$$\nv_i = \\frac{1}{2} v_0\n$$\n代入 $v_i$（其中 $[I]=IC_{50}$）和 $v_0$ 的表达式：\n$$\n\\frac{V_{max}[S]}{K_m\\left(1 + \\frac{IC_{50}}{K_i}\\right) + [S]} = \\frac{1}{2} \\left( \\frac{V_{max} [S]}{K_m + [S]} \\right)\n$$\n我们可以消去两边的非零项 $V_{max}[S]$：\n$$\n\\frac{1}{K_m\\left(1 + \\frac{IC_{50}}{K_i}\\right) + [S]} = \\frac{1}{2(K_m + [S])}\n$$\n两边取倒数得到：\n$$\nK_m\\left(1 + \\frac{IC_{50}}{K_i}\\right) + [S] = 2(K_m + [S])\n$$\n$$\nK_m + \\frac{K_m IC_{50}}{K_i} + [S] = 2K_m + 2[S]\n$$\n现在，我们求解包含 $K_i$ 的项：\n$$\n\\frac{K_m IC_{50}}{K_i} = (2K_m - K_m) + (2[S] - [S]) = K_m + [S]\n$$\n最后，求解 $K_i$ 得到：\n$$\nK_i = \\frac{K_m IC_{50}}{K_m + [S]}\n$$\n这也可以通过求解 $IC_{50}$ 来表示，这是竞争性抑制的 Cheng-Prusoff 方程更常见的形式：\n$$\nIC_{50} = K_i \\left(1 + \\frac{[S]}{K_m}\\right)\n$$\n\n### 步骤2：机理假设\n\n为使此推导及其在靶点验证中的应用有效，必须满足几个机理假设：\n1.  **纯竞争性抑制：** 抑制剂可逆地结合到酶的活性位点，从而阻止底物结合。底物和抑制剂是相互排斥的。其他抑制机制（非竞争性、反竞争性、混合型）会导致 $K_i$ 和 $IC_{50}$ 之间有不同的关系。\n2.  **稳态动力学：** 该推导基于 Michaelis-Menten 模型，该模型假设在反应的初始阶段，酶-底物复合物的浓度 $([ES])$ 是恒定的。\n3.  **单一、可逆的结合位点：** 该酶有一个用于底物的活性位点，抑制剂可逆地结合到这同一个位点。\n4.  **无抑制剂耗尽：** 总酶浓度必须远低于抑制剂浓度 $([E]_t \\ll [I])$。这个“松散结合”条件确保了游离抑制剂的浓度约等于其总浓度，这在推导中是被假设的。如果不满足此条件（即，对于紧密结合的抑制剂），则需要一个更复杂的模型（例如，Morrison 方程）。\n5.  **简化的底物系统：** 激酶反应通常是双底物反应（例如，ATP 和一种肽/蛋白质）。使用单底物模型假设第二种底物的浓度保持恒定，并且通常处于饱和水平，这样动力学就可以仅针对一种底物（本例中为 ATP）进行分析。\n6.  **与体内环境的相关性：** 为了让生化测定的 $K_i$ 能为细胞实验（CRISPRi）提供信息，假设抑制剂是细胞可渗透的、足够稳定且对目标激酶具有高选择性。Cheng-Prusoff 关系也强调了抑制剂在细胞中的效力（细胞 $IC_{50}$）将直接取决于竞争性底物 ATP 的胞内浓度。\n\n### 步骤3：$K_i$ 的计算\n\n我们使用推导出的关系式，整理后求解 $K_i$：\n$$\nK_i = \\frac{IC_{50}}{1 + \\frac{[S]}{K_m}}\n$$\n给定的数据是：\n- $K_m = 50\\,\\mu\\mathrm{M}$\n- $[S] = 100\\,\\mu\\mathrm{M}$\n- $IC_{50} = 187\\,\\mathrm{nM}$\n\n首先，我们计算无量纲比率 $\\frac{[S]}{K_m}$：\n$$\n\\frac{[S]}{K_m} = \\frac{100\\,\\mu\\mathrm{M}}{50\\,\\mu\\mathrm{M}} = 2\n$$\n现在，我们将这个值和给定的 $IC_{50}$ 代入 $K_i$ 的方程。$K_i$ 的单位将与 $IC_{50}$ 的单位相同，即 $\\mathrm{nM}$。\n$$\nK_i = \\frac{187\\,\\mathrm{nM}}{1 + 2} = \\frac{187\\,\\mathrm{nM}}{3}\n$$\n进行除法运算：\n$$\nK_i = 62.333...\\,\\mathrm{nM}\n$$\n根据要求将结果四舍五入至 $3$ 位有效数字：\n$$\nK_i = 62.3\\,\\mathrm{nM}\n$$",
            "answer": "$$\n\\boxed{62.3}\n$$"
        },
        {
            "introduction": "靶点验证通常涉及分析生物系统如何响应不同浓度的药理学试剂。本练习超越了单点估计，使用S型 $E_{max}$ 模型来对整个剂量-反应关系进行建模。通过将此模型与数据拟合，我们可以提取出关键参数，例如半数效应浓度（$EC_{50}$）和希尔系数（$n$）。这项计算练习提供了量化系统灵敏度和协同性的实践经验，从而能够对不同生物学背景（例如野生型与遗传扰动状态）进行更细致的比较。",
            "id": "5067452",
            "problem": "您的任务是构建一个计算工作流程，以利用药理学制剂在不同浓度范围内的生物标志物响应数据，来估计和解释用于转化医学中靶点验证的药效学参数。该问题的基础是质量作用定律和 Hill–Langmuir 占有框架：受体占有率随浓度 $C$ 单调增加，在 $C=0$ 时为 $0$，当 $C \\to \\infty$ 时接近 $1$，在 $C=EC_{50}$（半数最大效应浓度）时达到其最大值的一半，其陡峭程度由反映协同结合的 Hill 系数 $n$ 控制。生物标志物响应被建模为一个基线信号加上一个与占有率成正比的容量受限组分。任务是根据生物标志物响应数据拟合这样一个模型，并根据推导出的参数来解释靶点敏感性和协同性。\n\n您的程序必须实现以下任务：\n\n1. 使用与 Hill–Langmuir 占有和基线加容量响应一致的参数化药效学模型，从生物标志物响应数据中估计参数 $E_0$（基线效应）、$E_{\\max}$（基线以上的最大附加效应）、$EC_{50}$（半数最大效应浓度）和 $n$（Hill 系数）。采用非线性最小二乘法将模型拟合到数据。\n\n2. 拟合后，使用以下规则解释靶点敏感性和协同性：\n   - 敏感性规则：定义一个以纳摩尔为单位的敏感性阈值 $\\tau$。如果拟合的 $EC_{50} \\leq \\tau$，则认为靶点是敏感的；否则，认为其敏感性较低。对于此问题，使用 $\\tau = 50$ 纳摩尔。\n   - 协同性规则：如果拟合的 $n > 1$，则系统表现出正协同性；如果拟合的 $n$ 约等于 $1$，则为非协同行为；如果拟合的 $n < 1$，则为负协同性。为了得到布尔值输出，如果 $n > 1$，则将协同性分类为真（true），否则为假（false）。\n\n3. 报告拟合的 $EC_{50}$（单位为纳摩尔）和拟合的 $n$（无单位）。将每个浮点输出值四舍五入到小数点后两位。此问题中不使用角度。不得使用百分比；在相关情况下，应以小数形式表示比较。\n\n您将获得一套代表不同转化医学背景的场景测试套件：典型的药理学响应、降低容量的遗传扰动、使效价右移的药理学拮抗作用、正协同性和负协同性。对于每个场景，程序必须通过在提供的纳摩尔浓度列表上评估模型来模拟生物标志物响应数据，然后将模型拟合到模拟数据，最后计算解释性的布尔值。测试套件如下：\n\n- 场景 $\\mathsf{A}$（典型响应）：\n  - 参数：$E_0 = 10$ 任意单位，$E_{\\max} = 90$ 任意单位，$EC_{50} = 30$ 纳摩尔，$n = 1.2$（无单位）。\n  - 浓度 $C$（纳摩尔）：$[0, 1, 3, 10, 30, 100, 300]$。\n\n- 场景 $\\mathsf{B}$（基因敲降，容量降低）：\n  - 参数：$E_0 = 10$ 任意单位，$E_{\\max} = 40$ 任意单位，$EC_{50} = 30$ 纳摩尔，$n = 1.2$（无单位）。\n  - 浓度 $C$（纳摩尔）：$[0, 1, 3, 10, 30, 100, 300]$。\n\n- 场景 $\\mathsf{C}$（药理学拮抗作用，表观效价降低）：\n  - 参数：$E_0 = 10$ 任意单位，$E_{\\max} = 90$ 任意单位，$EC_{50} = 90$ 纳摩尔，$n = 1.2$（无单位）。\n  - 浓度 $C$（纳摩尔）：$[0, 1, 3, 10, 30, 100, 300]$。\n\n- 场景 $\\mathsf{D}$（正协同性）：\n  - 参数：$E_0 = 5$ 任意单位，$E_{\\max} = 95$ 任意单位，$EC_{50} = 10$ 纳摩尔，$n = 2.5$（无单位）。\n  - 浓度 $C$（纳摩尔）：$[0, 0.1, 1, 3, 10, 30, 100]$。\n\n- 场景 $\\mathsf{E}$（负协同性）：\n  - 参数：$E_0 = 0$ 任意单位，$E_{\\max} = 100$ 任意单位，$EC_{50} = 50$ 纳摩尔，$n = 0.7$（无单位）。\n  - 浓度 $C$（纳摩尔）：$[0, 0.5, 5, 50, 500]$。\n\n所有生物标志物响应都应使用提供的参数和浓度列表，根据参数模型进行确定性地模拟。然后，程序必须将同一模型重新拟合到这些模拟响应上。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于从 $\\mathsf{A}$ 到 $\\mathsf{E}$ 的每个场景，按顺序包含一个形式为 $[EC_{50}, n, \\text{sensitive}, \\text{cooperative}]$ 的列表，其中 $EC_{50}$ 是拟合的半数最大效应浓度，单位为纳摩尔，四舍五入到小数点后两位；$n$ 是拟合的 Hill 系数，四舍五入到小数点后两位；$\\text{sensitive}$ 是根据 $EC_{50} \\leq \\tau$（其中 $\\tau=50$ 纳摩尔）计算的布尔值；$\\text{cooperative}$ 是根据 $n > 1$ 计算的布尔值。因此，最终输出格式必须是一行，类似于 $[[EC_{50\\_\\mathsf{A}}, n_\\mathsf{A}, \\text{sensitive}_\\mathsf{A}, \\text{cooperative}_\\mathsf{A}], \\dots, [EC_{50\\_\\mathsf{E}}, n_\\mathsf{E}, \\text{sensitive}_\\mathsf{E}, \\text{cooperative}_\\mathsf{E}]]$。",
            "solution": "该任务基于质量作用定律和 Hill–Langmuir 受体占有框架。根据质量作用，对于与靶点相互作用的配体浓度 $C$，被占据位点的分数随 $C$ 的增加而增加，并在 $C$ 变得很大时达到饱和。协同结合影响占有率从低到高转变的陡峭程度。Hill–Langmuir 模型通过占有函数来捕捉这一点\n$$\nf(C) = \\frac{C^n}{EC_{50}^n + C^n},\n$$\n其中 $EC_{50}$ 是达到半数最大占有率时的浓度，而 $n$ 是 Hill 系数。药效学生物标志物效应是基于基线加容量原则建模的，这是一种经过充分检验的经验性表示：\n$$\nE(C) = E_0 + E_{\\max} \\cdot f(C).\n$$\n该表达式直接源于假设观察到的效应是基线 $E_0$ 和与占有率成正比的可饱和组分 $E_{\\max} \\cdot f(C)$ 的总和。\n\n为了估计参数 $E_0$、$E_{\\max}$、$EC_{50}$ 和 $n$，我们建立一个非线性最小二乘问题。给定在浓度 $\\{C_i\\}$ 下观察到的生物标志物响应 $\\{E_i\\}$，我们最小化残差平方和\n$$\n\\min_{E_0, E_{\\max}, EC_{50}, n} \\sum_{i} \\left[E_i - \\left(E_0 + \\frac{E_{\\max} \\cdot C_i^n}{EC_{50}^n + C_i^n}\\right)\\right]^2.\n$$\n这使用标准的非线性优化程序进行数值求解。适当的参数边界确保了物理合理性：$E_0 \\geq 0$，$E_{\\max} \\geq 0$，$EC_{50} > 0$ 和 $n > 0$。可以从数据中获得稳健的初始猜测值：选择 $E_0$ 为观察到的最小响应， $E_{\\max}$ 为响应的范围（最大值减去最小值），$EC_{50}$ 为特征性的中程浓度（例如正值 $C$ 的中位数），以及 $n$ 为 $1$。\n\n解释源于药理学：\n- 敏感性与效价相关。较低的 $EC_{50}$ 表示较高的敏感性。使用以纳摩尔为单位的阈值 $\\tau$，敏感性由 $EC_{50} \\leq \\tau$ 定义。这里 $\\tau = 50$ 纳摩尔，与药理学中许多高亲和力相互作用一致。\n- 协同性反映了位点间的结合相互作用。Hill 系数 $n > 1$ 表示正协同性（更陡峭的转变），$n \\approx 1$ 表示非协同行为，而 $n < 1$ 表示负协同性（更平缓的转变）。对于布尔分类，如果 $n > 1$，则将协同性定义为真（true），否则为假（false）。\n\n算法设计：\n1. 对于每个场景，使用提供的参数和上述模型，在给定的浓度下评估 $E(C)$，以生成确定性的生物标志物响应。此步骤模拟在受控的遗传或药理学扰动下测量的数据，并与转化医学实践保持一致，其中遗传模型（例如，基因敲降）会降低容量 $E_{\\max}$，而药理学拮抗作用通常会改变表观效价 $EC_{50}$。\n2. 使用带边界的非线性最小二乘法将模型拟合回生成的数据集。使用以下初始猜测值：$E_0 = \\min(E)$，$E_{\\max} = \\max(E) - \\min(E)$，$EC_{50} = \\text{median}(C_{C>0})$，$n = 1$。\n3. 提取拟合的 $EC_{50}$ 和 $n$，四舍五入到小数点后两位，并使用 $\\tau = 50$ 纳摩尔和标准 $n > 1$ 计算敏感性和协同性布尔值。\n4. 将所有场景（从 $\\mathsf{A}$ 到 $\\mathsf{E}$）的结果聚合成一个单一的列表的列表。\n\n科学真实性和边界情况：\n- 在 $C = 0$ 时，占有率 $f(C)=0$ 且 $E(C)=E_0$，确保了可识别的基线。\n- 当 $C \\to \\infty$ 时，$E(C) \\to E_0 + E_{\\max}$，从而可以估计容量。\n- 包含 $n > 1$ 和 $n < 1$ 的场景测试了捕捉协同和负协同行为的能力。\n- $E_{\\max}$ 的遗传性降低而 $EC_{50}$ 不变，将容量变化与敏感性分离开来，而拮抗作用引起的 $EC_{50}$ 增加则分离了效价变化。\n\n最终程序实现了这些原则，拟合每个场景，并打印一行：一个带方括号的逗号分隔列表，其中包含每个场景的 $[EC_{50}, n, \\text{sensitive}, \\text{cooperative}]$ 列表，$EC_{50}$ 单位为纳摩尔，$n$ 无单位，两者均四舍五入到小数点后两位。布尔值以其原生形式打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef emax_model(C, E0, Emax, EC50, n):\n    # Hill-Langmuir-based Emax model: E = E0 + (Emax * C^n) / (EC50^n + C^n)\n    # C, EC50 >= 0; n > 0\n    C = np.asarray(C, dtype=float)\n    return E0 + (Emax * np.power(C, n)) / (np.power(EC50, n) + np.power(C, n))\n\ndef fit_emax(C, E):\n    # Initial guesses based on data characteristics\n    C = np.asarray(C, dtype=float)\n    E = np.asarray(E, dtype=float)\n    E0_guess = float(np.min(E))\n    Emax_guess = float(np.max(E) - np.min(E))\n    # Median of positive concentrations; if none, fallback to 1.0\n    positive_C = C[C > 0]\n    EC50_guess = float(np.median(positive_C)) if positive_C.size > 0 else 1.0\n    n_guess = 1.0\n\n    # Parameter bounds for physical plausibility\n    lower_bounds = [0.0, 0.0, 1e-9, 0.05]\n    upper_bounds = [1e6, 1e6, 1e6, 5.0]\n\n    # Fit using nonlinear least squares\n    popt, _ = curve_fit(\n        emax_model,\n        C,\n        E,\n        p0=[E0_guess, Emax_guess, EC50_guess, n_guess],\n        bounds=(lower_bounds, upper_bounds),\n        maxfev=20000,\n    )\n    return popt  # E0, Emax, EC50, n\n\ndef simulate_response(params, C):\n    E0, Emax, EC50, n = params\n    return emax_model(C, E0, Emax, EC50, n)\n\ndef solve():\n    # Sensitivity threshold tau (nM)\n    tau = 50.0\n\n    # Define the test cases (parameters and concentration arrays)\n    # Each case: (E0, Emax, EC50, n, C_list)\n    test_cases = [\n        # Scenario A: typical response\n        (10.0, 90.0, 30.0, 1.2, [0, 1, 3, 10, 30, 100, 300]),\n        # Scenario B: genetic knockdown reduces capacity\n        (10.0, 40.0, 30.0, 1.2, [0, 1, 3, 10, 30, 100, 300]),\n        # Scenario C: pharmacological antagonism, right-shifted potency\n        (10.0, 90.0, 90.0, 1.2, [0, 1, 3, 10, 30, 100, 300]),\n        # Scenario D: positive cooperativity\n        (5.0, 95.0, 10.0, 2.5, [0, 0.1, 1, 3, 10, 30, 100]),\n        # Scenario E: negative cooperativity\n        (0.0, 100.0, 50.0, 0.7, [0, 0.5, 5, 50, 500]),\n    ]\n\n    results = []\n    for params in test_cases:\n        E0_true, Emax_true, EC50_true, n_true, C_list = params\n        C = np.array(C_list, dtype=float)\n\n        # Simulate deterministic biomarker response data\n        E_sim = simulate_response((E0_true, Emax_true, EC50_true, n_true), C)\n\n        # Fit the Emax model to the simulated data\n        E0_fit, Emax_fit, EC50_fit, n_fit = fit_emax(C, E_sim)\n\n        # Round floats to two decimals\n        EC50_out = round(float(EC50_fit), 2)\n        n_out = round(float(n_fit), 2)\n\n        # Interpret sensitivity and cooperativity\n        sensitive = EC50_fit = tau\n        cooperative = n_fit > 1.0\n\n        results.append([EC50_out, n_out, sensitive, cooperative])\n\n    # The str() function on a list of lists creates the desired format \"[[...], [...]]\"\n    # We just need to convert boolean cases from \"True\"/\"False\" to \"true\"/\"false\".\n    final_output_str = str(results).replace(\"True\", \"true\").replace(\"False\", \"false\")\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "靶点验证的最终目标是建立调节靶点与改变疾病表型之间的因果关系。本练习介绍了因果推断的关键原则，使用有向无环图（DAGs）的框架来区分真实的因果效应与由混杂、中介或对撞偏倚引起的虚假关联。通过分析这些常见的陷阱，您将学会设计更稳健的实验，并批判性地解读来自遗传和药理学研究的数据，这对于在转化研究中做出正确的决策至关重要。",
            "id": "5067366",
            "problem": "在转化医学靶点验证中，研究人员通常旨在估计遗传或药理学扰动对疾病相关表型的因果效应。考虑一个项目，旨在通过使用成簇规律间隔短回文重复序列（CRISPR）扰动 $E_{\\mathrm{CR}}$ 或小分子抑制剂 $E_{\\mathrm{SM}}$ 来验证靶点 $T$ 对疾病结局 $Y$ 的作用。测量下游通路生物标志物 $M$ 作为靶点作用的推定中介物，这与分子生物学的中心法则一致，该法则将基因扰动与信使核糖核酸（mRNA）和蛋白质活性的改变联系起来。研究 $S$ 的入组富集了基线生物标志物水平高的患者，并且临床实施允许患者选择和临床医生判断来影响患者是否接受 $E_{\\mathrm{SM}}$。设 $C$ 表示可能影响干预接受和结局的基线疾病严重程度或遗传背景。设 $Z$ 表示一个调节 $T$ 表达但其本身不受疾病或治疗影响的生殖系变异。假设一个有向无环图（DAG），其箭头为 $C \\to E$、$C \\to Y$、$E \\to M \\to Y$ 和 $E \\to S \\leftarrow Y$。该项目的主要估计量是 $E$ 对 $Y$ 的总因果效应。\n\n使用潜在结局框架，设 $Y_e$ 表示在暴露 $E=e$ 下将观察到的结局。假设 $E$ 的随机化使得 $E \\perp\\!\\!\\!\\perp (C, U)$，其中 $U$ 表示 $Y$ 的未测量原因，并且一个有效的工具变量（IV）$Z$ 影响 $E$ 但对 $Y$ 没有直接影响，且独立于 $(C, U)$。\n\n哪些选项正确地区分了靶点验证数据中的混杂、中介和对撞偏倚，并提出了在避免偏倚的同时保留适当估计量的设计或分析策略？\n\nA. 混杂因素 $C$ 是暴露前 $E$ 和 $Y$ 的共同原因（且 $E \\not\\to C$），产生了一条后门路径 $E \\leftarrow C \\rightarrow Y$，该路径会使 $E$ 对 $Y$ 效应的估计产生偏倚。适当的设计包括在随机对照试验（RCT）中对 $E$ 进行随机化，在孟德尔随机化（MR）中使用有效的工具变量 $Z$，以及在同基因细胞模型中对CRISPR扰动进行随机分配。在估计 $E$ 对 $Y$ 的总效应时，不应对中介变量 $M$ 进行条件化。\n\nB. 当对作为 $E$ 和 $Y$ 共同效应的变量 $S$（即 $E \\to S \\leftarrow Y$）进行条件化或选择时，会产生对撞偏倚，这会打开一条非因果路径并导致 $E \\not\\!\\perp\\!\\!\\!\\perp Y \\mid S$。为避免这种偏倚，招募时不应对 $S$ 进行条件化，基于 $P(S \\mid E, C)$ 使用逆概率加权来建模或消除选择效应且不对 $Y$ 进行条件化，并避免在用于估计总效应的结局模型中对 $S$ 进行调整。\n\nC. 当变量 $M$ 先于 $E$ 并同时导致 $E$ 和 $Y$ 时，发生中介作用；因此，需要对 $M$ 进行调整以获得总效应的无偏估计。此外，基于 $M$ 选择参与者可以减少对撞偏倚。\n\nD. 由于生殖系 $Z$ 在受孕时是随机分配的，孟德尔随机化同时消除了混杂、中介和对撞偏倚；因此，不需要对选择 $S$ 进行限制，任何 $Z \\to E \\to Y$ 的关联都能识别总效应。\n\nE. 为了在保留总效应估计量的同时检验 $M$ 是否中介了 $E$ 对 $Y$ 的效应，可以实施一个序贯、正交的扰动设计：随机化 $E$，然后独立随机化第二个干预 $I_M$，该干预能阻断 $M$ 而不直接影响 $Y$。如果 $E$ 仅通过 $M$ 影响 $Y$，那么在有 $I_M$ 的组中，$E$ 对 $Y$ 的效应将不存在，而在没有 $I_M$ 的组中，总效应是可估计的。机制性的“拯救”实验（例如，在抑制 $T$ 的同时过表达 $M$）可以在用于估计总效应的结局模型中不对 $M$ 进行条件化的情况下，评估 $M$ 的必要性和充分性。",
            "solution": "首先从因果定义和指导原则开始。混杂因素是变量 $C$，它对暴露 $E$ 和结局 $Y$ 都有因果影响，但不受 $E$ 的影响。在有向无环图（DAG）中，这表现为 $C \\to E$ 和 $C \\to Y$，且没有从 $E$ 到 $C$ 的箭头。如果后门路径 $E \\leftarrow C \\rightarrow Y$ 未被阻断，它会在 $E$ 和 $Y$ 之间产生虚假关联。中介变量 $M$ 位于从 $E$ 到 $Y$ 的有向因果路径上，$E \\to M \\to Y$。对撞变量 $S$ 是两个变量（此处为 $E$ 和 $Y$）的共同效应，产生 $E \\to S \\leftarrow Y$。对对撞变量进行条件化（通过调整或选择）会打开一条本应被阻断的路径，从而产生非因果关联。\n\n在潜在结局框架下，总因果效应是期望结局的对比 $E[Y_1 - Y_0]$，其中 $Y_e$ 表示在 $E=e$ 下的结局。随机化满足 $E \\perp\\!\\!\\!\\perp (C, U)$，使得 $E[Y_1 - Y_0]$ 可以从观察到的差异中识别出来，因为根据设计，$P(E \\mid C, U)=P(E)$ 且 $E$ 独立于混杂因素。要使工具变量（IV）$Z$ 有效，它必须满足三个条件：相关性（$Z \\to E$）、独立性（$Z \\perp\\!\\!\\!\\perp (C, U)$）和排他性（$Z \\not\\to Y$，除非可能通过 $E$）。孟德尔随机化在这些假设下使用生殖系 $Z$ 作为工具变量。\n\n来自DAG理论的条件化规则（d-分离）正式地展示了这些现象。对于混杂，如果我们不阻断 $E \\leftarrow C \\rightarrow Y$，那么即使没有因果箭头 $E \\to Y$，$E$ 和 $Y$ 也不是独立的（$E \\not\\!\\perp\\!\\!\\!\\perp Y$）。通过对 $C$ 进行条件化（或随机化 $E$）来阻断后门路径，会得到 $E \\perp\\!\\!\\!\\perp Y \\mid C$。对于中介，对 $M$ 进行条件化会阻断路径 $E \\to M \\to Y$，将估计量从总效应变为受控直接效应；因此，如果目标是总效应 $E[Y_1 - Y_0]$，则不应在主要结局模型中对 $M$ 进行调整。对于对撞偏倚，考虑 $E \\to S \\leftarrow Y$。在不进行条件化的情况下，沿着这条路径 $E$ 和 $Y$ 是独立的（$E \\perp\\!\\!\\!\\perp Y$）。对 $S$ 进行条件化会使 $E$ 和 $Y$ 变得相关：$P(E,Y \\mid S) \\neq P(E \\mid S) P(Y \\mid S)$。因此，通过 $S$ 富集样本或对 $S$ 进行调整会打开一条非因果关联。\n\n将这些原则应用于遗传和药理学靶点验证：\n\n- 混杂 ($C$): 在药理学实施中，临床医生的判断和患者特征 ($C$) 既能影响治疗的接受情况 $E_{\\mathrm{SM}}$，也能影响结局 $Y$。在基因编辑中，转导效率可能因遗传背景 ($C$) 而异，从而可能影响 $E_{\\mathrm{CR}}$ 和 $Y$。打破 $C \\to E$ 关联的设计包括对 $E$ 进行随机化（随机对照试验，RCT）、使用随机分配扰动的同基因模型，以及使用生殖系 $Z$ 的工具变量设计（孟德尔随机化，MR）。在分析上，对已测量的 $C$ 进行调整或使用倾向性评分可以阻断后门路径。重要的是，为了估计总效应，不要对 $M$ 进行条件化。\n\n- 中介 ($M$): 生物标志物 $M$ 位于从 $E$ 到 $Y$ 的因果路径的下游。对 $M$ 进行条件化会移除 $E \\to Y$ 的部分因果效应，并且不能估计总效应。为了在主要分析中保留总效应估计量的同时检验中介作用，可以使用序贯、正交的扰动：随机化 $E$，然后随机化一个专门阻断 $M$ 的干预 $I_M$。如果 $E$ 仅通过 $M$ 影响 $Y$，那么在 $I_M$ 组中 $E$ 对 $Y$ 没有影响，而在没有 $I_M$ 的组中，总效应是可估计的。机制性的拯救实验（例如，在维持 $E$ 的同时重构 $M$）可以在结局模型中不对 $M$ 进行条件化的情况下，检验 $M$ 对于 $E \\to Y$ 效应的必要性和充分性。\n\n- 对撞偏倚 ($S$): 选择 $S$ 同时依赖于 $E$ 和 $Y$（例如，通过受 $E$ 影响且与预后相关的基线生物标志物进行富集），产生 $E \\to S \\leftarrow Y$。通过限制或调整对 $S$ 进行条件化，即使在没有因果联系的情况下也会导致 $E \\not\\!\\perp\\!\\!\\!\\perp Y \\mid S$。避免这种情况的设计包括不依赖于 $S$ 的广泛招募，或通过使用 $P(S \\mid E, C)$ 的逆概率加权进行分析校正，同时避免直接对 $Y$ 进行条件化。值得注意的是，如果选择依赖于通过 $E$ 或 $Y$ 起作用的 $Z$，那么 IV/MR 并不能消除对撞偏倚。\n\n逐项分析：\n\nA. 此选项正确地将混杂因素 $C$ 定义为暴露前 $E$ 和 $Y$ 的共同原因，识别了后门路径 $E \\leftarrow C \\rightarrow Y$，并提出了移除或阻断 $C \\to E$ 的设计：随机化、通过孟德尔随机化使用工具变量 $Z$，以及在细胞模型中进行同基因随机化。它还正确地指出，为估计总效应，不应对中介变量 $M$ 进行条件化。结论：正确。\n\nB. 此选项正确地识别了因对共同效应 $S$（$E \\to S \\leftarrow Y$）进行条件化或选择而产生的对撞偏倚，解释了条件化会打开一条非因果路径，并提出了适当的解决方案：避免对 $S$ 进行条件化，设计独立于 $S$ 的招募，以及使用逆概率加权来校正选择效应而不对 $Y$ 进行条件化。陈述 $E \\not\\!\\perp\\!\\!\\!\\perp Y \\mid S$ 与d-分离一致。结论：正确。\n\nC. 此选项错误地描述了中介作用，称 $M$ 先于 $E$ 且同时导致 $E$ 和 $Y$。这是混杂因素的定义，而不是中介变量。它还声称需要对 $M$ 进行调整以获得总效应的无偏估计，这是不正确的：对 $M$ 进行条件化会阻断因果路径 $E \\to M \\to Y$，并将估计量更改为直接效应。最后，声称基于 $M$ 选择参与者可以减少对撞偏倚是没有根据的，并且可能引入选择引起的扭曲。结论：不正确。\n\nD. 此选项夸大了孟德尔随机化的作用范围。虽然如果工具变量的假设成立，生殖系 $Z$ 可以减少混杂，但孟德尔随机化不能消除中介作用（中介是因果路径的一部分，与估计量有关），也不能自动消除由选择 $S$ 引起的对撞偏倚。此外，如果存在选择或排他性假设的违反，$Z \\to E \\to Y$ 的存在本身并不能识别总效应。结论：不正确。\n\nE. 此选项提出了一种序贯、正交的扰动策略来检验中介作用：随机化 $E$，然后随机化一个能阻断 $M$ 而不直接影响 $Y$ 的干预 $I_M$。这与中介路径的识别相一致，并通过避免对 $M$ 进行条件化来保留主要分析中的总效应估计量。机制性的拯救实验操作化了 $M$ 对 $E \\to Y$ 效应的必要性和充分性。结论：正确。\n\n因此，正确的选项是 A、B 和 E。",
            "answer": "$$\\boxed{ABE}$$"
        }
    ]
}