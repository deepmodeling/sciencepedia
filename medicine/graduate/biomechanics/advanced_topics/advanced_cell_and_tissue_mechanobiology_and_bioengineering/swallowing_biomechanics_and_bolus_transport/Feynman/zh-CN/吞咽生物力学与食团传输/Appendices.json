{
    "hands_on_practices": [
        {
            "introduction": "在分析食团的运送过程前，首要步骤是理解其自身的流变行为——它在快速变形中更接近于理想液体还是弹性固体。Deborah数（$De$）是一个关键的无量纲参数，它通过比较材料的内在松弛时间与流动过程的时间尺度，为我们提供了量化这种行为的工具。本练习 () 提供了一个基础性的计算，旨在运用Deborah数对食团的动态特性进行分类，这是理解粘弹性流体在吞咽等快速生理过程中如何响应的基石。",
            "id": "4207310",
            "problem": "在吞咽的咽部阶段，一个粘弹性食团在肌肉压力的驱动下穿过一个收缩的几何结构。考虑一个食团，其线性粘弹性表征得到的材料松弛时间为 $\\lambda = 0.2\\,\\mathrm{s}$。高速视频荧光检查和测压法推断，在一个特征长度尺度为 $L = 0.02\\,\\mathrm{m}$ 的狭窄处，特征通过速度为 $U = 0.3\\,\\mathrm{m/s}$。使用第一性原理，从运动学出发，确定与通过狭窄处的输运相关的过程时间尺度，以及作为材料时间尺度与过程时间尺度之比的德博拉数（Deborah number (De)）的定义。然后计算该食团的 $De$ 值，并简要解释 $De$ 的量级在食团输运中预期的弹性效应方面的意义，例如弹性应力相对于流动时间尺度的持续性。\n\n将您的数值答案四舍五入到四位有效数字，并表示为一个无量纲量。",
            "solution": "该问题陈述具有科学依据，是良定的，并包含足够的信息以获得唯一解。它要求计算一个正在被输运的粘弹性食团的德博拉数，并对结果进行解释。所有给定的参数对于吞咽过程在物理上都是合理的。因此，我们可以继续求解。\n\n首先，我们确定给定的参数：\n材料松弛时间，这是食团粘弹性特性的一个特征，为 $\\lambda = 0.2\\,\\mathrm{s}$。\n食团的特征通过速度为 $U = 0.3\\,\\mathrm{m/s}$。\n咽部狭窄处的特征长度尺度为 $L = 0.02\\,\\mathrm{m}$。\n\n问题要求我们从运动学第一性原理出发，确定相关的过程时间尺度，记为 $t_p$。所讨论的过程是食团材料穿过狭窄处的输运过程。材料单元以恒定的特征速度 $U$ 行进距离 $L$ 所需的时间由基本运动学关系给出：\n$$\nt_p = \\frac{L}{U}\n$$\n这个时间尺度 $t_p$ 表示材料在通过狭窄处时承受变形的持续时间。\n\n接下来，我们使用德博拉数 $De$ 的定义。德博拉数是流变学中的一个无量纲量，用于表征材料在特定流动条件下表现得“像流体”还是“像固体”。它被定义为材料的内在松弛时间 $\\lambda$ 与观察或过程的特征时间尺度 $t_p$ 之比。\n$$\nDe = \\frac{\\lambda}{t_p}\n$$\n将过程时间尺度 $t_p$ 的表达式代入德博拉数的定义，我们得到用给定参数表示的 $De$ 的公式：\n$$\nDe = \\frac{\\lambda}{\\left(\\frac{L}{U}\\right)} = \\frac{\\lambda U}{L}\n$$\n\n现在，我们可以通过将给定值代入该表达式来计算 $De$ 的数值。\n$$\nDe = \\frac{(0.2\\,\\mathrm{s}) \\times (0.3\\,\\mathrm{m/s})}{0.02\\,\\mathrm{m}}\n$$\n进行计算：\n$$\nDe = \\frac{0.06\\,\\mathrm{m}}{0.02\\,\\mathrm{m}} = 3\n$$\n问题规定答案应四舍五入到四位有效数字。因此，无量纲德博拉数为 $3.000$。\n\n最后，我们解释计算出的德博拉数 $De = 3$ 的量级。德博拉数比较了材料应力松弛的时间尺度（$\\lambda$）与流动引起的变形的时间尺度（$t_p = L/U$）。\n- 如果 $De \\ll 1$，材料松弛远快于过程时间尺度。材料有充足的时间来适应变形，表现为粘性流体。弹性效应可以忽略不计。\n- 如果 $De \\gg 1$，过程远快于材料能够松弛的时间。材料没有时间流动，其响应主要由弹性主导，类似于固体。\n- 如果 $De \\approx 1$，松弛时间与过程时间处于同一数量级。材料表现出显著的粘弹性行为，其中粘性（能量耗散）和弹性（能量储存）效应都很重要。\n\n在本例中，$De = 3$。由于该值大于1，这表明材料松弛时间（$\\lambda = 0.2\\,\\mathrm{s}$）长于食团通过狭窄处的时间尺度（$t_p = 0.02\\,\\mathrm{m} / 0.3\\,\\mathrm{m/s} \\approx 0.067\\,\\mathrm{s}$）。相对于材料松弛内应力的能力，流动过程是迅速的。因此，预计弹性效应将是显著的。食团不会表现为简单的粘性液体；它会将一部分变形能以弹性势能的形式储存起来。这种储存的能量和相关的弹性应力会影响输运所需的压力，并可能导致诸如离开狭窄处时发生弹性回跳等现象。因此，食团输运动力学明确属于粘弹性范畴，纯粘性模型将不足以描述。",
            "answer": "$$\n\\boxed{3.000}\n$$"
        },
        {
            "introduction": "在掌握了食团的流变特性后，下一步便是模拟其在咽部的复杂输运过程。安全的吞咽依赖于食团运动与括约肌（如食管上括约肌，UES）开放和关闭之间的精确协调。本练习 () 运用一个简化的“推流”（plug-flow）模型，指导你如何整合来自临床测量的多源数据（如压力、速度和体积），以计算保证食团安全通过所需的UES最短开放时间，从而将生物力学原理与临床安全性评估直接联系起来。",
            "id": "4207348",
            "problem": "在一名健康成年人中，使用视频荧光吞咽检查和高分辨率测压法同时研究一次十毫升的稀液吞咽过程。为进行建模，采用一维活塞流模型描述下咽部食团柱，并假设管壁处的滑移可忽略不计。食管上括约肌 (UES) 的中心线位于舌根测压传感器远端 $L=6.0\\ \\mathrm{cm}$ 处。视频荧光吞咽检查确定，食团前缘在吞咽指令发出后 $t_{\\mathrm{TB}}=0.10\\ \\mathrm{s}$ 时通过舌根平面，并以近似恒定的速度 $v_{b}=20\\ \\mathrm{cm/s}$ 通过下咽部。高分辨率测压法记录到，食团运送期间的咽部平台压为 $p_{\\mathrm{bolus}}=45\\ \\mathrm{mmHg}$，高于基线压力 $p_{\\mathrm{rest}}=5\\ \\mathrm{mmHg}$。下咽部食团柱的有效横截面积可以通过线性顺应性关系 $A=A_{\\mathrm{rest}}+C\\,(p_{\\mathrm{bolus}}-p_{\\mathrm{rest}})$ 进行准静态近似，其中 $A_{\\mathrm{rest}}=0.80\\ \\mathrm{cm}^{2}$ 且 $C=0.020\\ \\mathrm{cm}^{2}/\\mathrm{mmHg}$。食团体积为 $V_{b}=10\\ \\mathrm{mL}$，您可以取 $1\\ \\mathrm{mL}=1\\ \\mathrm{cm}^{3}$。UES 松弛在吞咽指令发出后 $t_{\\mathrm{rel}}=0.15\\ \\mathrm{s}$ 时开始，从那一刻起 UES 保持完全开放，直到主动关闭。\n\n利用质量守恒和运动学原理，从第一性原理推导出保证食团安全通过所需的最小 UES 开放持续时间。此处，该持续时间定义为从 UES 松弛开始到食团尾部完全离开 UES 平面的时间间隔。假设安全通过要求 UES 从食团前缘到达 UES 的时刻起，直到食团尾部离开为止，持续保持开放，不考虑额外的安全裕度。使用给定数据计算这个最小持续时间。将最终答案四舍五入到三位有效数字，并以秒为单位表示。",
            "solution": "问题陈述已经过评估，并被确定为有效。它在科学上基于流体力学和运动学原理，特别是使用了生物力学分析中常见的简化活塞流模型。该问题是适定的，提供了所有必要的数据，并且目标明确。不存在内部矛盾、事实错误或含糊不清之处。\n\n主要目标是计算最小 UES 开放持续时间 $\\Delta t_{\\mathrm{UES}}$，其定义为从 UES 松弛开始的时刻 $t_{\\mathrm{rel}}$ 到食团尾部完全离开 UES 平面的时刻 $t_{\\mathrm{tail, UES}}$ 的时间间隔。所有时间都相对于 $t=0$ 时的吞咽指令进行测量。因此，所需的持续时间由以下关系式给出：\n$$\n\\Delta t_{\\mathrm{UES}} = t_{\\mathrm{tail, UES}} - t_{\\mathrm{rel}}\n$$\n为了求得 $\\Delta t_{\\mathrm{UES}}$，我们必须首先计算 $t_{\\mathrm{tail, UES}}$。这需要基于食团的质量守恒和运动学进行逐步分析。\n\n首先，我们根据所提供的数据确定食团的物理性质。该模型为一维活塞流，将食团视为一个具有恒定横截面积 $A$ 和长度 $L_b$ 的圆柱状流体柱。\n\n横截面积 $A$ 取决于咽部压力。食团运送期间的压力给定为 $p_{\\mathrm{bolus}}=45\\ \\mathrm{mmHg}$，高于基线压力 $p_{\\mathrm{rest}}=5\\ \\mathrm{mmHg}$。扩张咽部的有效压力是二者之差：\n$$\n\\Delta p = p_{\\mathrm{bolus}} - p_{\\mathrm{rest}} = 45\\ \\mathrm{mmHg} - 5\\ \\mathrm{mmHg} = 40\\ \\mathrm{mmHg}\n$$\n横截面积 $A$ 由线性顺应性关系给出：\n$$\nA = A_{\\mathrm{rest}} + C \\cdot \\Delta p\n$$\n代入给定值 $A_{\\mathrm{rest}}=0.80\\ \\mathrm{cm}^{2}$ 和 $C=0.020\\ \\frac{\\mathrm{cm}^{2}}{\\mathrm{mmHg}}CHA$：\n$$\nA = 0.80\\ \\mathrm{cm}^{2} + (0.020\\ \\frac{\\mathrm{cm}^{2}}{\\mathrm{mmHg}}) \\cdot (40\\ \\mathrm{mmHg}) = 0.80\\ \\mathrm{cm}^{2} + 0.80\\ \\mathrm{cm}^{2} = 1.60\\ \\mathrm{cm}^{2}\n$$\n食团体积给定为 $V_{b}=10\\ \\mathrm{mL}$，等效于 $10\\ \\mathrm{cm}^{3}$。假设食团形成一个横截面积恒为 $A$ 的柱体，其长度 $L_b$ 可以由体积计算得出：\n$$\nV_{b} = A \\cdot L_b \\implies L_b = \\frac{V_{b}}{A}\n$$\n代入数值：\n$$\nL_b = \\frac{10\\ \\mathrm{cm}^{3}}{1.60\\ \\mathrm{cm}^{2}} = 6.25\\ \\mathrm{cm}\n$$\n接下来，我们建立一个运动学时间轴。设舌根传感器位于原点 $x=0$，UES 位于位置 $x=L=6.0\\ \\mathrm{cm}$。食团前缘以恒定速度 $v_{b}=20\\ \\mathrm{cm/s}$ 移动。\n\n食团前缘行进距离 $L$ 到达 UES 所需的时间是：\n$$\n\\Delta t_{\\mathrm{travel}} = \\frac{L}{v_{b}} = \\frac{6.0\\ \\mathrm{cm}}{20\\ \\mathrm{cm/s}} = 0.30\\ \\mathrm{s}\n$$\n食团前缘到达 UES 的绝对时间 $t_{\\mathrm{front, UES}}$ 是：\n$$\nt_{\\mathrm{front, UES}} = t_{\\mathrm{TB}} + \\Delta t_{\\mathrm{travel}} = 0.10\\ \\mathrm{s} + 0.30\\ \\mathrm{s} = 0.40\\ \\mathrm{s}\n$$\n问题陈述指出，安全通过要求食团前缘到达时 UES 必须是开放的。UES 在 $t_{\\mathrm{rel}}=0.15\\ \\mathrm{s}$ 时开放。由于 $t_{\\mathrm{rel}} = 0.15\\ \\mathrm{s}  0.40\\ \\mathrm{s} = t_{\\mathrm{front, UES}}$，当食团到达时 UES 已经开放，因此安全条件得到满足。\n\n食团尾部在时刻 $t_{\\mathrm{tail, UES}}$ 离开 UES 平面。在活塞流模型中，食团尾部跟在前缘之后，相距固定长度 $L_b$。整个食团长度通过一个固定点（如 UES 平面）所需的时间即为通过时间 $\\Delta t_{\\mathrm{passage}}$：\n$$\n\\Delta t_{\\mathrm{passage}} = \\frac{L_b}{v_{b}} = \\frac{6.25\\ \\mathrm{cm}}{20\\ \\mathrm{cm/s}} = 0.3125\\ \\mathrm{s}\n$$\n食团尾部离开 UES 的时刻是前缘到达时刻加上这段通过时间：\n$$\nt_{\\mathrm{tail, UES}} = t_{\\mathrm{front, UES}} + \\Delta t_{\\mathrm{passage}} = 0.40\\ \\mathrm{s} + 0.3125\\ \\mathrm{s} = 0.7125\\ \\mathrm{s}\n$$\n或者，我们可以从第一性原理来表达 $t_{\\mathrm{tail, UES}}$。从舌根开始，直到食团尾部离开 UES，食团前缘行进的总距离为 $L + L_b$。这段行程的总时间为 $(L + L_b)/v_b$。这段行程从 $t_{\\mathrm{TB}}$ 开始。\n$$\nt_{\\mathrm{tail, UES}} = t_{\\mathrm{TB}} + \\frac{L + L_b}{v_b} = 0.10\\ \\mathrm{s} + \\frac{6.0\\ \\mathrm{cm} + 6.25\\ \\mathrm{cm}}{20\\ \\mathrm{cm/s}} = 0.10\\ \\mathrm{s} + \\frac{12.25\\ \\mathrm{cm}}{20\\ \\mathrm{cm/s}} = 0.10\\ \\mathrm{s} + 0.6125\\ \\mathrm{s} = 0.7125\\ \\mathrm{s}\n$$\n两种方法得出的 $t_{\\mathrm{tail, UES}}$ 结果相同。\n\n最后，我们计算最小 UES 开放持续时间 $\\Delta t_{\\mathrm{UES}}$。这是从 UES 松弛开始时刻 $t_{\\mathrm{rel}}=0.15\\ \\mathrm{s}$ 到食团尾部离开 UES 时刻 $t_{\\mathrm{tail, UES}}=0.7125\\ \\mathrm{s}$ 的时间间隔。\n$$\n\\Delta t_{\\mathrm{UES}} = t_{\\mathrm{tail, UES}} - t_{\\mathrm{rel}} = 0.7125\\ \\mathrm{s} - 0.15\\ \\mathrm{s} = 0.5625\\ \\mathrm{s}\n$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$\n\\Delta t_{\\mathrm{UES}} \\approx 0.563\\ \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{0.563}\n$$"
        },
        {
            "introduction": "前述练习中的模型依赖于诸如组织柔顺性 ($C$) 或材料松弛时间 ($\\lambda$) 等关键参数。然而，在实际研究中，我们如何从充满噪声的实验数据中准确地获得这些参数值呢？这就引出了生物力学中的一个核心挑战：“反问题”（inverse problem），即从观测到的系统输出来推断其内部属性。本计算练习 () 将引导你探索如何从压力-面积数据中估计组织柔顺性，并直面参数可辨识性这一根本问题。你将学习使用正则化等数值技术来求解不适定问题以获得稳健的解，这构成了连接理论模型与实验数据的关键桥梁。",
            "id": "4207331",
            "problem": "将食管上括约肌 (UES) 视为一个短的、近似轴对称的节段，其横截面积在吞咽过程中随腔内压力而变化。假设处于准静态平衡状态，其中惯性项相对于组织刚度和粘性效应可以忽略不计。其基本依据是：在小应变下，组织形变通过一个顺应性参数与跨壁压近似呈线性关系。将顺应性定义为 $C = \\dfrac{dA}{dP_{\\mathrm{tm}}}$，其中 $A$ 是横截面积，$P_{\\mathrm{tm}}$ 是跨壁压；在当前设定中，假设腔外压力近似恒定，使用腔内压力 $P$ 作为 $P_{\\mathrm{tm}}$ 的替代指标。对于围绕参考压力 $P_{\\mathrm{ref}}$ 的小范围波动，将面积建模为 $A \\approx A_{0} + C \\left(P - P_{\\mathrm{ref}}\\right)$，其中 $A_{0}$ 是在 $P_{\\mathrm{ref}}$ 时的面积，$C$ 是（近似恒定的）顺应性，单位为 $\\mathrm{mm}^{2}/\\mathrm{kPa}$。\n\n您需要从成对的压力-面积样本中分析 $C$ 的可辨识性，并在逆问题不适定时实施正则化策略。从线性测量中唯一可恢复性意义上的可辨识性，取决于设计矩阵的秩和正规方程组的条件。具体来说，如果设计矩阵 $X$ 对偏移量和压力变化进行了充分采样，则 $\\mathrm{rank}(X)$ 是满秩的，且条件数 $\\kappa\\!\\left(X^{\\top} X\\right)$ 是适中的；否则，该逆问题是不适定的。当问题不适定时，使用 Tikhonov 型正则化来稳定逆过程，方法可以是惩罚参数的大小（岭回归），或在时变顺应性估计中强制平滑。\n\n在单个程序中实现以下任务：\n\n- 任务 $1$ (恒定顺应性模型和可辨识性): 给定成对样本 $\\left(P_{i}, A_{i}\\right)$，其中 $i \\in \\left\\{1,\\dots,N\\right\\}$，将 $P_{\\mathrm{ref}}$ 设置为采样压力的平均值。将线性系统 $A \\approx A_{0} + C \\left(P - P_{\\mathrm{ref}}\\right)$ 构建为一个回归问题，其设计矩阵 $X \\in \\mathbb{R}^{N \\times 2}$ 的第一列为 $1$，第二列为 $P - P_{\\mathrm{ref}}$。当且仅当 $\\mathrm{rank}(X) = 2$ 且 $\\kappa\\!\\left(X^{\\top} X\\right) \\le \\tau$ 时，声明 $C$ 是可辨识的，其中阈值为 $\\tau = 10^{7}$。如果可辨识，则计算最小二乘估计；如果不可辨识，则通过最小化 $\\left\\|X \\,\\theta - A\\right\\|_{2}^{2} + \\lambda_{\\mathrm{ridge}} \\left\\|\\theta\\right\\|_{2}^{2}$ 计算岭正则化估计，其中 $\\lambda_{\\mathrm{ridge}} = 1.0$，$\\theta = \\left[A_{0},\\, C\\right]^{\\top}$。报告估计的 $C$ 值，单位为 $\\mathrm{mm}^{2}/\\mathrm{kPa}$。\n\n- 任务 $2$ (时变顺应性和平滑度正则化): 对于一个样本序列 $\\left(P_{i}, A_{i}\\right)$，$i \\in \\left\\{1,\\dots,N\\right\\}$，假设 $A \\approx A_{0} + C_{i} \\left(P_{i} - P_{\\mathrm{ref}}\\right)$，其中顺应性 $C_{i}$ 可能随时间变化。构建一个线性系统，其未知数为 $\\theta = \\left[A_{0},\\, C_{1},\\, \\dots,\\, C_{N}\\right]^{\\top}$，设计矩阵为 $X \\in \\mathbb{R}^{N \\times (N+1)}$，该矩阵的第一列等于 $1$，第 $(i+1)$ 列是一个向量，其在第 $i$ 行有一个值为 $\\left(P_{i} - P_{\\mathrm{ref}}\\right)$ 的非零项。由于此系统是欠定的，通过最小化 $\\left\\|X \\,\\theta - A\\right\\|_{2}^{2} + \\lambda_{\\mathrm{smooth}} \\left\\|L \\, C\\right\\|_{2}^{2} + \\alpha \\, A_{0}^{2}$ 来计算 Tikhonov 平滑估计，其中 $C = \\left[C_{1},\\dots,C_{N}\\right]^{\\top}$，$L \\in \\mathbb{R}^{(N-1) \\times N}$ 是一阶差分算子，其行实现 $C_{i+1} - C_{i}$，$\\lambda_{\\mathrm{smooth}} = 100.0$，且 $\\alpha = 10^{-6}$。报告估计的向量 $\\hat{C} = \\left[\\hat{C}_{1},\\dots,\\hat{C}_{N}\\right]$，单位为 $\\mathrm{mm}^{2}/\\mathrm{kPa}$。\n\n物理单位：压力必须以 $\\mathrm{kPa}$ 为单位，面积必须以 $\\mathrm{mm}^{2}$ 为单位，顺应性必须以 $\\mathrm{mm}^{2}/\\mathrm{kPa}$ 为单位。不使用角度。所有百分比（如有）必须表示为小数或分数；本问题中不出现百分号。\n\n您的程序要使用的测试套件和数据：\n\n- 测试用例 $1$ (正常路径，可辨识的恒定顺应性): $P = [\\,4,\\,6,\\,8,\\,10,\\,12\\,]$，单位为 $\\mathrm{kPa}$，$A = [\\,8,\\,24,\\,40,\\,56,\\,72\\,]$，单位为 $\\mathrm{mm}^{2}$。\n\n- 测试用例 $2$ (边界情况，压力零变化，无正则化时不可辨识): $P = [\\,8,\\,8,\\,8,\\,8,\\,8\\,]$，单位为 $\\mathrm{kPa}$，$A = [\\,39,\\,40,\\,41,\\,38,\\,40\\,]$，单位为 $\\mathrm{mm}^{2}$。\n\n- 测试用例 $3$ (边缘情况，压力近乎零变化，病态): $P = [\\,8.0,\\,8.0001,\\,7.9999,\\,8.0002,\\,7.9998\\,]$，单位为 $\\mathrm{kPa}$，$A = [\\,40.0,\\,40.0008,\\,39.9992,\\,40.0016,\\,39.9984\\,]$，单位为 $\\mathrm{mm}^{2}$。\n\n- 测试用例 $4$ (需要平滑度正则化的欠定时变顺应性): $P = [\\,3,\\,4,\\,5,\\,6,\\,7,\\,6,\\,5,\\,4,\\,3,\\,2\\,]$，单位为 $\\mathrm{kPa}$，$A = [\\,22.5,\\,27.5,\\,33.0,\\,39.0,\\,47.5,\\,40.5,\\,33.0,\\,27.0,\\,22.5,\\,17.5\\,]$，单位为 $\\mathrm{mm}^{2}$。\n\n您的程序必须：\n\n- 对于测试用例 1–3，计算一个布尔可辨识性标志和一个标量顺应性估计值 $\\hat{C}$，单位为 $\\mathrm{mm}^{2}/\\mathrm{kPa}$。\n\n- 对于测试用例 4，计算一个布尔可辨识性标志（相对于无正则化的系统）和一个正则化顺应性估计值向量 $\\hat{C}_{i}$，单位为 $\\mathrm{mm}^{2}/\\mathrm{kPa}$，其中 $i \\in \\left\\{1,\\dots,10\\right\\}$。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是一个列表。前三个内部列表的形式必须为 $[\\mathrm{flag},\\,\\hat{C}]$，第四个内部列表的形式必须为 $[\\mathrm{flag},\\,[\\hat{C}_{1},\\dots,\\hat{C}_{10}]]$. 例如，符合格式要求的输出结构为 $[[\\mathrm{flag}_{1},\\,c_{1}],[\\mathrm{flag}_{2},\\,c_{2}],[\\mathrm{flag}_{3},\\,c_{3}],[\\mathrm{flag}_{4},\\,[c_{4,1},\\dots,c_{4,10}]]]$。",
            "solution": "问题陈述经评估有效。它以生物力学和系统辨识的原理为科学依据，使用标准的线性近似来模拟组织顺应性。该问题是适定的，提供了两个不同的、数学上形式化的任务，并附有所有必要的数据、参数和可辨识性的客观标准。其语言精确、客观，所提供的数据在物理上一致且合理。该问题通过规定特定的、适当的正则化技术（岭回归和 Tikhonov 平滑）来处理不适定性的概念，这是逆问题中的标准方法。因此，将提供一个合理的解决方案。\n\n解决方案分为两部分，对应于问题中定义的两个任务。\n\n### 任务 1：恒定顺应性模型\n\n底层物理模型假设，对于围绕参考压力 $P_{\\mathrm{ref}}$ 的小偏差，横截面积 $A$ 和腔内压力 $P$ 之间存在线性关系：\n$$\nA \\approx A_{0} + C (P - P_{\\mathrm{ref}})\n$$\n其中 $A_{0}$ 是在 $P_{\\mathrm{ref}}$ 时的基线面积，$C$ 是恒定顺应性。给定 $N$ 对测量值 $(P_i, A_i)$，我们建立一个线性回归问题。设 $P_{\\mathrm{ref}}$ 为平均压力，$P_{\\mathrm{ref}} = \\frac{1}{N} \\sum_{i=1}^{N} P_i$。所有测量的方程组可以用矩阵形式写成：\n$$\n\\mathbf{A} \\approx X \\theta\n$$\n其中：\n- $\\mathbf{A} = [A_1, A_2, \\dots, A_N]^{\\top}$ 是面积测量向量。\n- $\\theta = [A_0, C]^{\\top}$ 是待估计的未知参数向量。\n- $X$ 是一个 $N \\times 2$ 的设计矩阵，第一列全为 1 以解释偏移量 $A_0$，第二列包含压力偏差。\n$$\nX = \\begin{pmatrix} 1  P_1 - P_{\\mathrm{ref}} \\\\ 1  P_2 - P_{\\mathrm{ref}} \\\\ \\vdots  \\vdots \\\\ 1  P_N - P_{\\mathrm{ref}} \\end{pmatrix}\n$$\n\n参数向量 $\\theta$（以及顺应性 $C$）的可辨识性由设计矩阵 $X$ 的属性决定。\n1.  **秩条件**：为了在最小二乘意义上存在唯一解， $X$ 的列必须是线性无关的，这意味着 $\\mathrm{rank}(X)$ 必须等于列数，即 $\\mathrm{rank}(X) = 2$。如果第二列是第一列的倍数，则该条件不成立，这种情况仅在所有 $P_i$ 都相同时发生，从而使得所有 $i$ 的 $P_i - P_{\\mathrm{ref}} = 0$。\n2.  **条件数**：为了使解相对于数据 $\\mathbf{A}$ 的小扰动是稳定的，正规矩阵 $X^{\\top}X$ 必须是良态的。条件数 $\\kappa(X^{\\top}X)$ 衡量了这种稳定性。大的条件数表示一个病态问题，其解对噪声高度敏感。问题为此评估指定了一个阈值 $\\tau = 10^7$。\n\n**求解方法**：\n- **如果可辨识**（$\\mathrm{rank}(X) = 2$ 且 $\\kappa(X^{\\top}X) \\le \\tau$）：通过求解普通最小二乘 (OLS) 问题来找到参数，该问题最小化残差平方和 $\\|X\\theta - \\mathbf{A}\\|_2^2$。解由正规方程组给出：\n$$\n\\hat{\\theta}_{\\mathrm{OLS}} = (X^{\\top}X)^{-1} X^{\\top}\\mathbf{A}\n$$\n- **如果不可辨识**：该问题是不适定的。为了获得稳定的解，采用岭回归（Tikhonov 正则化的一种形式）。该方法最小化一个惩罚平方和：$\\|X\\theta - \\mathbf{A}\\|_2^2 + \\lambda_{\\mathrm{ridge}}\\|\\theta\\|_2^2$。惩罚项 $\\|\\theta\\|_2^2$ 会抑制过大的参数值。当 $\\lambda_{\\mathrm{ridge}} = 1.0$ 时，解为：\n$$\n\\hat{\\theta}_{\\mathrm{ridge}} = (X^{\\top}X + \\lambda_{\\mathrm{ridge}}I)^{-1} X^{\\top}\\mathbf{A}\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n在两种情况下，估计的顺应性都是解向量的第二个元素，$\\hat{C} = \\hat{\\theta}[1]$。\n\n### 任务 2：时变顺应性模型\n\n该任务允许顺应性在每个测量时刻 $C_i$ 发生变化。模型为：\n$$\nA_i \\approx A_0 + C_i (P_i - P_{\\mathrm{ref}})\n$$\n这产生一个包含 $N$ 个线性方程和 $N+1$ 个未知数的系统：常数偏移量 $A_0$ 和 $N$ 个独立的顺应性 $C_1, \\dots, C_N$。参数向量为 $\\theta = [A_0, C_1, \\dots, C_N]^{\\top}$。设计矩阵 $X \\in \\mathbb{R}^{N \\times (N+1)}$ 的构造方式是，使得方程 $X\\theta = \\mathbf{A}$ 的第 $i$ 行对应于第 $i$ 次测量的模型。\n- $X$ 的第一列是全为 1 的向量，对应于单个参数 $A_0$。\n- 对于 $i \\in \\{1,\\dots,N\\}$，$X$ 的第 $(i+1)$ 列对应于参数 $C_i$，并在第 $i$ 行包含一个非零项 $P_i - P_{\\mathrm{ref}}$。\n$$\nX = \\begin{pmatrix}\n1  P_1-P_{\\mathrm{ref}}  0  \\cdots  0 \\\\\n1  0  P_2-P_{\\mathrm{ref}}  \\cdots  0 \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\n1  0  0  \\cdots  P_N-P_{\\mathrm{ref}}\n\\end{pmatrix}\n$$\n这个线性系统是欠定的，因为它的未知数（$N+1$）比独立方程数（$N$）多。因此，无正则化的问题没有唯一解，且 $\\mathrm{rank}(X) \\le N  N+1$。它内在地是不可辨识的。\n\n**求解方法**：\n使用 Tikhonov 正则化从无限解集中选择一个有意义的解。目标是找到一个不仅能拟合数据，而且其顺应性序列 $C_i$ 也表现出平滑性的 $\\theta$。要最小化的成本函数是：\n$$\nJ(\\theta) = \\|X\\theta - \\mathbf{A}\\|_2^2 + \\lambda_{\\mathrm{smooth}}\\|LC\\|_2^2 + \\alpha A_0^2\n$$\n- 第一项是数据保真项。\n- 第二项，其中 $\\lambda_{\\mathrm{smooth}} = 100.0$，是一个平滑度惩罚项。$C = [C_1, \\dots, C_N]^{\\top}$ 是顺应性向量，$L \\in \\mathbb{R}^{(N-1) \\times N}$ 是一阶差分算子矩阵。它惩罚连续顺应性值之间的巨大差异，$C_{i+1} - C_i$。\n$$\nL = \\begin{pmatrix}\n-1  1  0  \\cdots  0 \\\\\n0  -1  1  \\cdots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\vdots \\\\\n0  0  \\cdots  -1  1\n\\end{pmatrix}\n$$\n- 第三项，其中 $\\alpha = 10^{-6}$，是对 $A_0$ 估计值的一个小的岭惩罚，以确保整个问题是适定的。\n\n为了最小化 $J(\\theta)$，我们将其关于 $\\theta$ 的梯度设置为零。这导出了修正的正规方程组：\n$$\n(X^{\\top}X + R)\\hat{\\theta} = X^{\\top}\\mathbf{A}\n$$\n其中 $R$ 是一个由惩罚项构成的 $(N+1) \\times (N+1)$ 正则化矩阵：\n$$\nR = \\begin{pmatrix}\n\\alpha  \\mathbf{0}_{1 \\times N} \\\\\n\\mathbf{0}_{N \\times 1}  \\lambda_{\\mathrm{smooth}} L^{\\top}L\n\\end{pmatrix}\n$$\n通过求解这个线性系统获得解向量：\n$$\n\\hat{\\theta} = (X^{\\top}X + R)^{-1} X^{\\top}\\mathbf{A}\n$$\n最终得到的估计顺应性向量是 $\\hat{C} = [\\hat{\\theta}_1, \\dots, \\hat{\\theta}_N]^{\\top}$，即 $\\hat{\\theta}$ 从第二个到最后一个元素。",
            "answer": "```python\nimport numpy as np\n\ndef task1(P, A, tau=1e7, lambda_ridge=1.0):\n    \"\"\"\n    Solves for constant compliance C, checking for identifiability.\n    \"\"\"\n    N = len(P)\n    P_ref = np.mean(P)\n    \n    X = np.ones((N, 2))\n    X[:, 1] = P - P_ref\n    \n    # Check for singularity before calculating condition number\n    if np.linalg.matrix_rank(X)  2:\n        identifiable = False\n        cond_num = np.inf\n    else:\n        # Calculate condition number of the normal matrix X^T * X\n        XTX = X.T @ X\n        cond_num = np.linalg.cond(XTX)\n        identifiable = (cond_num = tau)\n\n    if identifiable:\n        # OLS solution: (X^T * X)^-1 * X^T * A\n        theta = np.linalg.solve(X.T @ X, X.T @ A)\n    else:\n        # Ridge regression solution: (X^T * X + lambda * I)^-1 * X^T * A\n        I = np.eye(2)\n        theta = np.linalg.solve(X.T @ X + lambda_ridge * I, X.T @ A)\n        \n    C_hat = theta[1]\n    \n    # The flag must be a standard boolean True/False for the final output format.\n    return bool(identifiable), C_hat\n\ndef task2(P, A, lambda_smooth=100.0, alpha=1e-6):\n    \"\"\"\n    Solves for time-varying compliance C using Tikhonov smoothness regularization.\n    \"\"\"\n    N = len(P)\n    P_ref = np.mean(P)\n    \n    # The unregularized system is N x (N+1), so it's underdetermined\n    # and thus non-identifiable. The flag is always False.\n    identifiable = False\n    \n    # Construct the design matrix X\n    X = np.zeros((N, N + 1))\n    X[:, 0] = 1.0\n    pressure_diff = P - P_ref\n    # Add diagonal entries for C_i terms\n    np.fill_diagonal(X[:, 1:], pressure_diff)\n    \n    # Construct the first-order difference operator L\n    L = np.zeros((N - 1, N))\n    np.fill_diagonal(L, -1.0)\n    np.fill_diagonal(L[:, 1:], 1.0)\n    \n    # Construct the regularization matrix R\n    R = np.zeros((N + 1, N + 1))\n    R[0, 0] = alpha\n    R[1:, 1:] = lambda_smooth * (L.T @ L)\n    \n    # Solve the regularized normal equations: (X^T*X + R) * theta = X^T * A\n    M = X.T @ X + R\n    b = X.T @ A\n    theta = np.linalg.solve(M, b)\n    \n    C_hat_vec = theta[1:]\n    \n    return identifiable, C_hat_vec\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Identifiable constant compliance\n        (np.array([4.0, 6.0, 8.0, 10.0, 12.0]), np.array([8.0, 24.0, 40.0, 56.0, 72.0])),\n        # Case 2: Non-identifiable (zero pressure variation)\n        (np.array([8.0, 8.0, 8.0, 8.0, 8.0]), np.array([39.0, 40.0, 41.0, 38.0, 40.0])),\n        # Case 3: Ill-conditioned (near-zero pressure variation)\n        (np.array([8.0, 8.0001, 7.9999, 8.0002, 7.9998]), np.array([40.0, 40.0008, 39.9992, 40.0016, 39.9984])),\n        # Case 4: Time-varying compliance\n        (np.array([3.0, 4.0, 5.0, 6.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0]),\n         np.array([22.5, 27.5, 33.0, 39.0, 47.5, 40.5, 33.0, 27.0, 22.5, 17.5]))\n    ]\n    \n    results = []\n    \n    # Process tasks 1-3\n    for i in range(3):\n        P, A = test_cases[i]\n        flag, C = task1(P, A, tau=1e7, lambda_ridge=1.0)\n        results.append([flag, C])\n        \n    # Process task 4\n    P4, A4 = test_cases[3]\n    flag4, C4_vec = task2(P4, A4, lambda_smooth=100.0, alpha=1e-6)\n    results.append([flag4, C4_vec.tolist()])\n    \n    # Format the final output string as required.\n    output_parts = []\n    # Test case 1\n    # Problem specifies 'True'/'False'\n    flag1_str = 'True' if results[0][0] else 'False'\n    output_parts.append(f'[{flag1_str},{results[0][1]:.8f}]')\n    # Test case 2\n    flag2_str = 'True' if results[1][0] else 'False'\n    output_parts.append(f'[{flag2_str},{results[1][1]:.8f}]')\n    # Test case 3\n    flag3_str = 'True' if results[2][0] else 'False'\n    output_parts.append(f'[{flag3_str},{results[2][1]:.8f}]')\n    # Test case 4\n    flag4_str = 'True' if results[3][0] else 'False'\n    c4_list_str = '[' + ','.join(f'{c:.8f}' for c in results[3][1]) + ']'\n    output_parts.append(f'[{flag4_str},{c4_list_str}]')\n    \n    final_output_str = '[' + ','.join(output_parts) + ']'\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}