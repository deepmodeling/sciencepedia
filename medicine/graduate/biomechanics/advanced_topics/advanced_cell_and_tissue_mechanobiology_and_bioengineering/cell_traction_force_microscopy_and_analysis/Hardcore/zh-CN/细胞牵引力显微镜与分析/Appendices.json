{
    "hands_on_practices": [
        {
            "introduction": "在细胞牵引力显微镜（TFM）的分析中，任何计算得到的牵引力场都必须遵守基本的物理定律。此练习强调了一个核心原则：在准静态条件下，一个孤立的贴壁细胞所施加的总力和总力矩必须为零 ()。通过对一个给定的解析牵引力场进行积分，您将亲手验证这一平衡约束，这对于评估TFM重建结果的物理真实性至关重要。",
            "id": "4164338",
            "problem": "我们通过牵引力显微镜 (Traction Force Microscopy, TFM) 分析一个附着在线性弹性、等效无限平面基底上的贴壁细胞。在以细胞质心为原点的基底平面笛卡尔坐标系 $(x,y)$ 中，细胞施加在基底上的平面内牵引力场（基底单位面积上）被建模为：\n$$\n\\mathbf{t}(x,y) = t_{0}\\,\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{a^{2}}\\right)\\,\\hat{\\mathbf{x}},\n$$\n其中 $t_{0}>0$ 是一个单位为帕斯卡的常数，$a>0$ 是一个单位为米的特征长度。假设为准静态条件（惯性和体力可忽略），因此孤立的细胞-基底系统必须满足平面内标准的合力及合力矩平衡约束。\n\n仅从牛顿定律以及平面上连续分布的表面牵引力产生的合力与力矩的基本定义出发，计算与 $\\mathbf{t}(x,y)$ 相关的平面内净力矢量和绕原点的平面外净力矩。然后确定该牵引力场是否满足孤立细胞的平衡约束（净力为零且净力矩为零）。\n\n将最终结果表示为单行矩阵 $(F_{x}, F_{y}, \\tau_{z}, s)$，其中 $F_{x}$ 和 $F_{y}$ 是净力的笛卡尔分量，单位为牛顿；$\\tau_{z}$ 是绕原点的平面外力矩，单位为牛顿-米；$s$ 是一个指示符，如果两个平衡约束都满足则等于 $1$，否则等于 $0$。您的答案应为用 $t_{0}$ 和 $a$ 表示的精确符号表达式。最终的方框答案中不要包含单位。无需四舍五入。",
            "solution": "用户提供了一个生物力学领域的问题，具体涉及细胞牵引力显微镜（TFM）。任务是验证问题陈述的有效性，如果有效，则解决该问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   细胞施加在基底上的平面内牵引力场由以下矢量函数给出：$\\mathbf{t}(x,y) = t_{0}\\,\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{a^{2}}\\right)\\,\\hat{\\mathbf{x}}$。\n-   坐标系为笛卡尔坐标系 $(x,y)$，原点位于细胞质心。\n-   常数 $t_{0}$ 和 $a$ 均为正数，$t_{0} > 0$ 且 $a > 0$。\n-   基底是线性弹性的、等效无限的平面。\n-   系统处于准静态条件下（惯性和体力可忽略）。\n-   孤立细胞-基底系统的平衡约束是净合力与净合力矩均为零。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题很好地基于连续介质力学和生物力学的原理。牵引力显微镜是一种标准的实验技术。使用类高斯函数来模拟牵引力场是一种常见且科学合理的简化。平衡条件 $(\\sum \\mathbf{F} = \\mathbf{0}, \\sum \\mathbf{M} = \\mathbf{0})$ 是牛顿运动定律的直接推论，而牛顿定律是基础性的。\n-   **适定性**：该问题是适定的。牵引力场是一个有数学定义的函数，待计算的量（净力与净力矩）由明确定义的积分运算确定。积分域隐含为整个平面 $(-\\infty, \\infty) \\times (-\\infty, \\infty)$，与“等效无限”基底一致。存在唯一解。\n-   **客观性与完整性**：问题以精确、客观的语言陈述。所有必要信息，包括牵引力场的函数形式和参数，均已提供。任务目标明确定义。\n-   **一致性与可行性**：该问题内部一致。单位是隐含一致的（牵引力为帕斯卡，长度为米，从而导出力的单位为牛顿，力矩的单位为牛顿-米）。该数学模型是一种理想化，但对于本分析目的而言，并非物理上不可能或不合理。\n\n**步骤3：结论与行动**\n该问题有效。这是一个应用于相关生物学背景的标准力学问题。必要的计算基于基本原理和积分学。我将继续进行求解。\n\n### 求解\n\n该问题要求计算由分布的牵引力场 $\\mathbf{t}(x,y)$ 产生的净力矢量 $\\mathbf{F}$ 和绕原点的净力矩 $\\tau_z$。\n\n**1. 净力计算**\n\n净力 $\\mathbf{F}$ 是牵引力场 $\\mathbf{t}(x,y)$ 在基底整个面积 $A$ 上的积分。由于基底是“等效无限”的，积分区域是整个 $xy$ 平面。\n$$\n\\mathbf{F} = \\iint_{A} \\mathbf{t}(x,y) \\,dA = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\mathbf{t}(x,y) \\,dx\\,dy\n$$\n力矢量 $\\mathbf{F}$ 具有分量 $F_x$ 和 $F_y$。给定的牵引力场为 $\\mathbf{t}(x,y) = t_x(x,y)\\,\\hat{\\mathbf{x}} + t_y(x,y)\\,\\hat{\\mathbf{y}}$，其中：\n$$\nt_x(x,y) = t_0 \\exp\\left(-\\frac{x^2+y^2}{a^2}\\right)\n$$\n$$\nt_y(x,y) = 0\n$$\n净力的 $y$ 分量 $F_y$ 是：\n$$\nF_y = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} t_y(x,y) \\,dx\\,dy = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} 0 \\,dx\\,dy = 0\n$$\n净力的 $x$ 分量 $F_x$ 是：\n$$\nF_x = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} t_x(x,y) \\,dx\\,dy = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} t_0 \\exp\\left(-\\frac{x^2+y^2}{a^2}\\right) \\,dx\\,dy\n$$\n我们可以分离指数项和积分：\n$$\nF_x = t_0 \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{a^2}\\right) \\,dx \\right) \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{y^2}{a^2}\\right) \\,dy \\right)\n$$\n这涉及到标准高斯积分 $\\int_{-\\infty}^{\\infty} \\exp(-cu^2) \\,du = \\sqrt{\\pi/c}$。在本例中，常数 $c = 1/a^2$。\n因此，每个积分的计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{a^2}\\right) \\,dx = \\sqrt{\\frac{\\pi}{1/a^2}} = \\sqrt{\\pi a^2} = a\\sqrt{\\pi}\n$$\n关于 $y$ 的积分是相同的。将此结果代回 $F_x$ 的表达式中：\n$$\nF_x = t_0 (a\\sqrt{\\pi}) (a\\sqrt{\\pi}) = t_0 a^2 \\pi\n$$\n因此，净力矢量为 $\\mathbf{F} = (t_0 a^2 \\pi) \\hat{\\mathbf{x}}$。\n\n**2. 净力矩计算**\n\n绕原点的平面外净力矩 $\\tau_z$ 是力矩矢量 $\\boldsymbol{\\tau} = \\iint_A \\mathbf{r} \\times \\mathbf{t}(x,y) \\,dA$ 的 $z$ 分量，其中 $\\mathbf{r} = x\\hat{\\mathbf{x}} + y\\hat{\\mathbf{y}}$ 是位置矢量。\n$$\n\\mathbf{r} \\times \\mathbf{t} = (x\\hat{\\mathbf{x}} + y\\hat{\\mathbf{y}}) \\times (t_x \\hat{\\mathbf{x}} + t_y \\hat{\\mathbf{y}}) = (x t_y - y t_x)\\hat{\\mathbf{z}}\n$$\n因此，$\\tau_z$ 由下式给出：\n$$\n\\tau_z = \\iint_A (x t_y(x,y) - y t_x(x,y)) \\,dA = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} (x t_y(x,y) - y t_x(x,y)) \\,dx\\,dy\n$$\n代入 $t_x$ 和 $t_y=0$：\n$$\n\\tau_z = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} -y \\, t_x(x,y) \\,dx\\,dy = -t_0 \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} y \\exp\\left(-\\frac{x^2+y^2}{a^2}\\right) \\,dx\\,dy\n$$\n我们可以分离积分：\n$$\n\\tau_z = -t_0 \\left( \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{a^2}\\right) \\,dx \\right) \\left( \\int_{-\\infty}^{\\infty} y \\exp\\left(-\\frac{y^2}{a^2}\\right) \\,dy \\right)\n$$\n第一个积分是 $a\\sqrt{\\pi}$，如前所算。我们来考察第二个积分：\n$$\nI_y = \\int_{-\\infty}^{\\infty} y \\exp\\left(-\\frac{y^2}{a^2}\\right) \\,dy\n$$\n被积函数 $f(y) = y \\exp(-y^2/a^2)$ 是一个奇函数，因为 $f(-y) = (-y) \\exp(-(-y)^2/a^2) = -y \\exp(-y^2/a^2) = -f(y)$。奇函数在对称区间 $(-\\infty, \\infty)$ 上的积分为零。\n因此，$I_y = 0$。\n将此结果代回 $\\tau_z$ 的表达式中：\n$$\n\\tau_z = -t_0 (a\\sqrt{\\pi}) (0) = 0\n$$\n所以，净力矩为 $\\tau_z = 0$。\n\n**3. 平衡约束检查**\n\n为了使孤立的细胞-基底系统处于静态平衡，净力与净力矩都必须为零。\n-   净力：$\\mathbf{F} = (t_0 a^2 \\pi) \\hat{\\mathbf{x}}$。由于 $t_0 > 0$ 且 $a > 0$，我们有 $F_x = t_0 a^2 \\pi \\neq 0$。净力不为零。\n-   净力矩：$\\tau_z = 0$。净力矩为零。\n\n因为净力不为零，所以不满足平衡条件。物理上，这意味着要使该牵引力场存在，必须对细胞施加一个大小为 $-t_0 a^2 \\pi$ 且方向为 $\\hat{\\mathbf{x}}$ 的外力，以将其保持在原位。\n\n指示符 $s$ 的定义是：如果两个平衡约束都满足，则 $s=1$，否则 $s=0$。由于净力不为零，所以 $s=0$。\n\n**4. 最终结果构建**\n\n要求的输出是一个行矩阵 $(F_{x}, F_{y}, \\tau_{z}, s)$。根据我们的计算：\n-   $F_x = t_0 a^2 \\pi$\n-   $F_y = 0$\n-   $\\tau_z = 0$\n-   $s = 0$\n\n最终的矩阵是 $(t_0 a^2 \\pi, 0, 0, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nt_{0}a^{2}\\pi  0  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从测量的位移场反演计算牵引力场是TFM技术的核心，但这本质上是一个不适定（ill-posed）的逆问题。此练习将引导您探索解决这一挑战的标准方法——吉洪诺夫正则化（Tikhonov regularization），并量化其关键的偏倚-方差权衡（bias-variance trade-off）()。通过推导最佳正则化参数 $\\lambda_{\\mathrm{opt}}$，您将深刻理解如何在抑制噪声影响（低方差）和忠实于真实解（低偏倚）之间取得平衡，这是从充满噪声的实验数据中获得可靠牵引力场的关键。",
            "id": "4164376",
            "problem": "考虑牵引力显微镜（TFM），其中细胞在各向同性的线性弹性半空间基底上施加一个面内牵引力场 $t(\\mathbf{x})$。在小变形和线性弹性的假设下，位移场 $u(\\mathbf{x})$ 和牵引力场 $t(\\mathbf{x})$ 在二维空间傅里叶域中通过 $u(\\mathbf{k}) = G(k)\\,t(\\mathbf{k})$ 相关联，其中 $G(k)$ 是基底的标量柔度，$k = |\\mathbf{k}|$ 是波数的模。假设一个简化的各向同性半空间模型，其中 $G(k) = A/k$，$A>0$ 为常数（单位为 $1/\\mathrm{Pa}$），该模型捕捉了弹性格林函数振幅随波数呈 $1/k$ 衰减这一经过充分检验的特性。\n\n设测量位移为 $u_{\\mathrm{meas}}(\\mathbf{k}) = u_{\\mathrm{true}}(\\mathbf{k}) + \\eta(\\mathbf{k})$，其中 $\\eta(\\mathbf{k})$ 是零均值高斯白噪声，每个傅里叶模式的方差为 $\\sigma_u^2$，且在不同 $\\mathbf{k}$ 之间独立。牵引力谱 $t(\\mathbf{k})$ 的一个标准估计器通过逐个模式求解 Tikhonov 正则化最小二乘问题来最小化 $\\|G(k)\\,t(\\mathbf{k}) - u_{\\mathrm{meas}}(\\mathbf{k})\\|^2 + \\lambda\\,\\|t(\\mathbf{k})\\|^2$，其中 $\\lambda>0$ 是正则化参数。\n\n专注于一个简单的解析谱，其中真实位移由波数为 $k_0>0$、振幅为 $U_0>0$ 的单个单色傅里叶模式组成，即，在有限的周期性视场中，唯一非零的模式在 $k=k_0$ 处，且 $|u_{\\mathrm{true}}(k_0)| = U_0$。从所述的物理模型和估计器出发，推导在 $k_0$ 处的预期均方误差，并将其分解为偏差和方差的贡献（作为 $\\lambda$ 的函数），然后确定使该 $k_0$ 处的均方误差最小化的 $\\lambda$ 值。\n\n以 $A$、$\\sigma_u^2$、$U_0$ 和 $k_0$ 的形式，给出最优正则化参数 $\\lambda_{\\mathrm{opt}}$ 的闭式解析表达式。将 $\\lambda_{\\mathrm{opt}}$ 的单位表示为 $\\mathrm{m}^2/\\mathrm{Pa}^2$。无需四舍五入。",
            "solution": "该问题是有效的，因为它在科学上基于线性弹性和反问题理论的原理，在数学上是适定的，并且所有必要的参数都得到了一致的定义。\n\n我们的任务是找到最优的 Tikhonov 正则化参数 $\\lambda$，以最小化估计单个单色牵引力傅里叶模式的均方误差（MSE）。\n\n对于波数为 $\\mathbf{k}$ 的单个傅里叶模式，估计问题是找到使成本函数最小化的牵引力分量 $t(\\mathbf{k})$：\n$$J(t(\\mathbf{k})) = \\|G(k)\\,t(\\mathbf{k}) - u_{\\mathrm{meas}}(\\mathbf{k})\\|^2 + \\lambda\\,\\|t(\\mathbf{k})\\|^2$$\n其中 $k = |\\mathbf{k}|$。由于问题是逐个模式求解的，我们可以专注于波数为 $k_0$ 的特定模式。量 $t(k_0)$、$u_{\\mathrm{meas}}(k_0)$ 和 $u_{\\mathrm{true}}(k_0)$ 都是复数。为简化符号，我们分别用 $t$、$u_m$ 和 $u_t$ 表示它们。该模式下的格林函数为 $G(k_0)$。成本函数变为：\n$$J(t) = |G(k_0) t - u_m|^2 + \\lambda |t|^2$$\n我们展开平方幅值，注意到 $|z|^2 = z z^*$：\n$$J(t) = (G(k_0) t - u_m)(G(k_0)^* t^* - u_m^*) + \\lambda t t^*$$\n鉴于 $G(k) = A/k$，它是一个实值函数，因此 $G(k_0)^* = G(k_0)$。\n$$J(t) = G(k_0)^2 t t^* - G(k_0) t u_m^* - G(k_0) t^* u_m + u_m u_m^* + \\lambda t t^*$$\n$$J(t) = (G(k_0)^2 + \\lambda)|t|^2 - G(k_0)(t u_m^* + t^* u_m) + |u_m|^2$$\n为了找到最小值，我们对 $t^*$ 求复导数并将其设为零：\n$$\\frac{\\partial J}{\\partial t^*} = (G(k_0)^2 + \\lambda)t - G(k_0)u_m = 0$$\n求解 $t$ 得到牵引力的 Tikhonov 正则化估计器，我们将其表示为 $\\hat{t}(k_0)$：\n$$\\hat{t}(k_0) = \\frac{G(k_0) u_{\\mathrm{meas}}(k_0)}{G(k_0)^2 + \\lambda}$$\n\n问题要求分析均方误差（MSE），其定义为 $E[|\\hat{t}(k_0) - t_{\\mathrm{true}}(k_0)|^2]$。MSE 可以分解为估计器的偏差平方和方差之和。\n$$\\mathrm{MSE} = |\\mathrm{Bias}|^2 + \\mathrm{Variance}$$\n其中 $\\mathrm{Bias} = E[\\hat{t}(k_0)] - t_{\\mathrm{true}}(k_0)$ 且 $\\mathrm{Variance} = E[|\\hat{t}(k_0) - E[\\hat{t}(k_0)]|^2]$。\n\n首先，我们求估计器的期望值 $E[\\hat{t}(k_0)]$。我们将 $u_{\\mathrm{meas}}(k_0) = u_{\\mathrm{true}}(k_0) + \\eta(k_0)$ 代入 $\\hat{t}(k_0)$ 的表达式中。\n$$E[\\hat{t}(k_0)] = E\\left[ \\frac{G(k_0) (u_{\\mathrm{true}}(k_0) + \\eta(k_0))}{G(k_0)^2 + \\lambda} \\right]$$\n鉴于噪声 $\\eta(k_0)$ 是零均值的，所以 $E[\\eta(k_0)] = 0$。\n$$E[\\hat{t}(k_0)] = \\frac{G(k_0) u_{\\mathrm{true}}(k_0)}{G(k_0)^2 + \\lambda}$$\n真实牵引力 $t_{\\mathrm{true}}(k_0)$ 与真实位移 $u_{\\mathrm{true}}(k_0)$ 的关系为 $u_{\\mathrm{true}}(k_0) = G(k_0) t_{\\mathrm{true}}(k_0)$，因此 $t_{\\mathrm{true}}(k_0) = u_{\\mathrm{true}}(k_0)/G(k_0)$。\n\n现在我们计算偏差的平方：\n$$|\\mathrm{Bias}|^2 = |E[\\hat{t}(k_0)] - t_{\\mathrm{true}}(k_0)|^2 = \\left| \\frac{G(k_0) u_{\\mathrm{true}}(k_0)}{G(k_0)^2 + \\lambda} - \\frac{u_{\\mathrm{true}}(k_0)}{G(k_0)} \\right|^2$$\n$$|\\mathrm{Bias}|^2 = \\left| \\frac{u_{\\mathrm{true}}(k_0)}{G(k_0)} \\left( \\frac{G(k_0)^2}{G(k_0)^2 + \\lambda} - 1 \\right) \\right|^2 = |t_{\\mathrm{true}}(k_0)|^2 \\left| \\frac{G(k_0)^2 - (G(k_0)^2 + \\lambda)}{G(k_0)^2 + \\lambda} \\right|^2$$\n$$|\\mathrm{Bias}|^2 = |t_{\\mathrm{true}}(k_0)|^2 \\left( \\frac{-\\lambda}{G(k_0)^2 + \\lambda} \\right)^2 = \\frac{\\lambda^2 |t_{\\mathrm{true}}(k_0)|^2}{(G(k_0)^2 + \\lambda)^2}$$\n\n接下来，我们计算方差：\n$$\\mathrm{Variance} = E[|\\hat{t}(k_0) - E[\\hat{t}(k_0)]|^2]$$\n项 $\\hat{t}(k_0) - E[\\hat{t}(k_0)]$ 为：\n$$\\hat{t}(k_0) - E[\\hat{t}(k_0)] = \\frac{G(k_0) (u_{\\mathrm{true}}(k_0) + \\eta(k_0))}{G(k_0)^2 + \\lambda} - \\frac{G(k_0) u_{\\mathrm{true}}(k_0)}{G(k_0)^2 + \\lambda} = \\frac{G(k_0) \\eta(k_0)}{G(k_0)^2 + \\lambda}$$\n方差是该项的平方幅值的期望：\n$$\\mathrm{Variance} = E\\left[ \\left| \\frac{G(k_0) \\eta(k_0)}{G(k_0)^2 + \\lambda} \\right|^2 \\right] = \\frac{G(k_0)^2}{(G(k_0)^2 + \\lambda)^2} E[|\\eta(k_0)|^2]$$\n问题陈述每个傅里叶模式的噪声方差为 $\\sigma_u^2$，因此 $E[|\\eta(k_0)|^2] = \\sigma_u^2$。\n$$\\mathrm{Variance} = \\frac{G(k_0)^2 \\sigma_u^2}{(G(k_0)^2 + \\lambda)^2}$$\n\n总 MSE 是偏差平方和方差之和：\n$$\\mathrm{MSE}(\\lambda) = \\frac{\\lambda^2 |t_{\\mathrm{true}}(k_0)|^2}{(G(k_0)^2 + \\lambda)^2} + \\frac{G(k_0)^2 \\sigma_u^2}{(G(k_0)^2 + \\lambda)^2} = \\frac{\\lambda^2 |t_{\\mathrm{true}}(k_0)|^2 + G(k_0)^2 \\sigma_u^2}{(G(k_0)^2 + \\lambda)^2}$$\n为了找到最小化 MSE 的最优正则化参数 $\\lambda_{\\mathrm{opt}}$，我们将 $\\mathrm{MSE}(\\lambda)$ 对 $\\lambda$ 求导并令其结果为零。\n$$\\frac{d}{d\\lambda}\\mathrm{MSE}(\\lambda) = \\frac{d}{d\\lambda}\\left[ \\frac{\\lambda^2 |t_{\\mathrm{true}}|^2 + G_0^2 \\sigma_u^2}{(G_0^2 + \\lambda)^2} \\right] = 0$$\n这里我们使用了简写 $G_0 = G(k_0)$ 和 $t_{\\mathrm{true}} = t_{\\mathrm{true}}(k_0)$。使用商法则：\n$$\\frac{(2\\lambda|t_{\\mathrm{true}}|^2)(G_0^2 + \\lambda)^2 - (\\lambda^2|t_{\\mathrm{true}}|^2 + G_0^2 \\sigma_u^2)(2(G_0^2 + \\lambda))}{(G_0^2 + \\lambda)^4} = 0$$\n由于 $\\lambda > 0$，我们可以将分子除以 $2(G_0^2 + \\lambda)$：\n$$\\lambda|t_{\\mathrm{true}}|^2(G_0^2 + \\lambda) - (\\lambda^2|t_{\\mathrm{true}}|^2 + G_0^2 \\sigma_u^2) = 0$$\n$$\\lambda G_0^2 |t_{\\mathrm{true}}|^2 + \\lambda^2 |t_{\\mathrm{true}}|^2 - \\lambda^2 |t_{\\mathrm{true}}|^2 - G_0^2 \\sigma_u^2 = 0$$\n$$\\lambda G_0^2 |t_{\\mathrm{true}}|^2 - G_0^2 \\sigma_u^2 = 0$$\n由于 $G_0 = A/k_0 \\neq 0$，我们可以除以 $G_0^2$：\n$$\\lambda |t_{\\mathrm{true}}|^2 - \\sigma_u^2 = 0$$\n这给出了最优正则化参数：\n$$\\lambda_{\\mathrm{opt}} = \\frac{\\sigma_u^2}{|t_{\\mathrm{true}}(k_0)|^2}$$\n这是一个经典结果，即最优正则化参数是噪声方差与信号功率（在牵引力场中）之比。\n\n最后一步是用给定的参数 $A$、$\\sigma_u^2$、$U_0$ 和 $k_0$ 来表示这个结果。我们有 $|u_{\\mathrm{true}}(k_0)| = U_0$ 和 $G(k_0) = A/k_0$。\n真实牵引力的平方幅值为：\n$$|t_{\\mathrm{true}}(k_0)|^2 = \\left|\\frac{u_{\\mathrm{true}}(k_0)}{G(k_0)}\\right|^2 = \\frac{|u_{\\mathrm{true}}(k_0)|^2}{G(k_0)^2} = \\frac{U_0^2}{(A/k_0)^2} = \\frac{U_0^2 k_0^2}{A^2}$$\n将此代入 $\\lambda_{\\mathrm{opt}}$ 的表达式中：\n$$\\lambda_{\\mathrm{opt}} = \\frac{\\sigma_u^2}{U_0^2 k_0^2 / A^2} = \\frac{A^2 \\sigma_u^2}{U_0^2 k_0^2}$$\n这是最优正则化参数的最终表达式。单位为 $(1/\\mathrm{Pa})^2 \\cdot (\\mathrm{m}^3)^2 / ( (\\mathrm{m}^3)^2 \\cdot (1/\\mathrm{m})^2 ) = (\\mathrm{m}^2/\\mathrm{Pa}^2)$，这与问题的要求一致。",
            "answer": "$$\n\\boxed{\\frac{A^2 \\sigma_u^2}{U_0^2 k_0^2}}\n$$"
        },
        {
            "introduction": "前面的练习分别探讨了物理平衡约束和正则化方法，而这个综合性实践将二者融为一体，构建一个更强大的牵引力反演求解器。此任务要求您将全局力和力矩平衡作为等式约束，并结合吉洪诺夫正则化，推导并实现一个求解相应卡罗需-库恩-塔克（KKT）系统的完整程序 ()。通过这个编码挑战，您将从头构建一个能够生成物理上自洽的牵引力场的计算工具，确保分析结果在数学上稳定且符合力学基本原理。",
            "id": "4164358",
            "problem": "给定一个均匀、各向同性、线性弹性基底中的二维细胞牵引力显微镜（TFM）小应变逆问题。假设存在一个离散化的正向算子，在准静态平衡和线性叠加的标准假设下，该算子将离散的平面牵引力矢量映射到离散的平面位移。设未知牵引力场在 $n$ 个表面节点上离散化，每个节点有两个平面内分量；并设位移在相同的 $n$ 个节点上测量，同样具有两个平面内分量。将未知的牵引力分量按 $[t_{1x}, t_{1y}, t_{2x}, t_{2y}, \\dots, t_{nx}, t_{ny}]^{\\top}$ 的顺序堆叠成一个矢量 $t \\in \\mathbb{R}^{2n}$。同样，将测量的位移按相同的节点顺序堆叠成矢量 $u \\in \\mathbb{R}^{2n}$。\n\n使用的基本原理：\n- 对于准静态系统，线性动量平衡（牛顿第二和第三定律）意味着，当包含整个支撑区域时，牵引力场施加在基底上的合力必须为零。其离散形式产生两个标量约束（每个平面内方向一个）。\n- 关于原点的角动量平衡意味着，平面内牵引力场的净平面外力矩也必须为零。其离散形式产生一个标量约束。\n- 线性弹性和叠加原理意味着，位移矢量 $u$ 与牵引力矢量 $t$ 通过一个矩阵 $K \\in \\mathbb{R}^{2n \\times 2n}$ 线性相关，即在无噪声情况下有 $u = K t$。\n\n为了对这个不适定的反演问题进行正则化，使用罚参数为 $\\alpha > 0$ 且罚算子为单位算子的零阶吉洪诺夫正则化。通过等式约束来强制执行全局平衡约束。\n\n任务：\n1. 从上述基本原理出发，推导出形如 $A t = 0$ 的离散全局平衡约束，其中 $A \\in \\mathbb{R}^{3 \\times 2n}$。前两行分别编码 $x$ 和 $y$ 方向上的净力平衡。第三行编码关于原点的净平面外力矩平衡，使用基于节点位置的离散力矩公式。\n2. 建立一个约束正则化最小二乘问题，通过在等式约束下最小化数据失配项与吉洪诺夫罚项之和，来从测量的 $u$ 估计 $t$，并以分块矩阵形式明确写出相关的 Karush–Kuhn–Tucker (KKT) 线性系统。\n3. 实现一个求解器，用于组装和求解 KKT 系统以恢复 $t$。假设一个无量纲设置（无物理单位），因此所有量都是无单位的标量和矢量。按如下方式构建用于测试的正向算子 $K$。设第 $i$ 个测量节点位于位置 $(x_i, y_i)$，第 $j$ 个牵引力节点位于 $(x_j, y_j)$。定义 $\\Delta x_{ij} = x_i - x_j$，$\\Delta y_{ij} = y_i - y_j$，$r_{ij}^2 = \\Delta x_{ij}^2 + \\Delta y_{ij}^2$，以及一个衰减影响函数 $k(r_{ij}) = \\exp(-r_{ij}^2 / \\ell^2)$，其中给定长度尺度 $\\ell > 0$。对于耦合参数 $\\gamma \\in [0, 1)$ 和一个小的 $\\varepsilon > 0$，定义将节点 $j$ 处的牵引力映射到节点 $i$ 处位移的 $2 \\times 2$ 分块矩阵为\n$$\nB_{ij} =\nk(r_{ij})\n\\begin{bmatrix}\n(1 - \\gamma) + \\gamma \\dfrac{\\Delta x_{ij}^2}{r_{ij}^2 + \\varepsilon} \n\\gamma \\dfrac{\\Delta x_{ij} \\Delta y_{ij}}{r_{ij}^2 + \\varepsilon} \\\\\n\\gamma \\dfrac{\\Delta x_{ij} \\Delta y_{ij}}{r_{ij}^2 + \\varepsilon} \n(1 - \\gamma) + \\gamma \\dfrac{\\Delta y_{ij}^2}{r_{ij}^2 + \\varepsilon}\n\\end{bmatrix}.\n$$\n通过将 $B_{ij}$ 放置在块行 $i$ 和块列 $j$ 的位置来组装 $K$。\n\n4. 使用以下测试套件，其中 $n = 4$ 个节点按顺序放置在坐标 $(x, y) \\in \\{(-1,-1), (1,-1), (-1,1), (1,1)\\}$。对于每个测试，构建一个真实牵引力 $t^\\star \\in \\mathbb{R}^{8}$（按规定方式堆叠），合成 $u = K t^\\star + \\eta$（其中独立高斯噪声 $\\eta \\sim \\mathcal{N}(0, \\sigma^2 I)$ 如指定），求解约束逆问题以获得 $\\hat{t}$，并报告欧几里得范数误差 $\\| \\hat{t} - t^\\star \\|_2$（作为一个浮点数）。所有计算均在无量纲单位下进行。设置 $\\varepsilon = 10^{-12}$ 并使用固定的随机种子以使噪声结果可复现。\n\n测试用例：\n- 用例 1（理想情况，精确平衡，无噪声）：\n  - $\\ell = 1.5$，$\\gamma = 0.3$，$\\alpha = 10^{-6}$，$\\sigma = 0$，\n  - $t^\\star = [1,\\, 0.5,\\; -1,\\, 0.5,\\; 1,\\, -0.5,\\; -1,\\, -0.5]^{\\top}$。\n- 用例 2（含噪声数据，小正则化）：\n  - $\\ell = 0.7$，$\\gamma = 0.45$，$\\alpha = 10^{-8}$，$\\sigma = 10^{-3}$，\n  - $t^\\star = [0.8,\\, -0.6,\\; -0.8,\\, -0.6,\\; 0.8,\\, 0.6,\\; -0.8,\\, 0.6]^{\\top}$。\n- 用例 3（违反约束的真实值；测试约束的投影效果）：\n  - $\\ell = 1.0$，$\\gamma = 0.35$，$\\alpha = 10^{-6}$，$\\sigma = 5 \\times 10^{-4}$，\n  - $t^\\star = [1.2,\\, 0.4,\\; -0.9,\\, 0.6,\\; 1.1,\\, -0.3,\\; -0.7,\\, -0.2]^{\\top}$。\n\n你的程序必须实现：\n- 根据给定的 $(x_i, y_i)$、$\\ell$ 和 $\\gamma$ 构建 $K$，\n- 构建编码任务1中推导出的三个约束的矩阵 $A$，\n- 组装并求解任务2中推导出的 KKT 系统，\n- 对每个用例，使用指定的噪声水平和固定种子计算误差 $\\| \\hat{t} - t^\\star \\|_2$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3]\"）。每个结果必须是代表相应测试用例的 $\\| \\hat{t} - t^\\star \\|_2$ 的浮点数。变量是无量纲的；输出中不要包含任何单位。",
            "solution": "用户提供了一个关于细胞牵引力显微镜（TFM）的问题，需要求解一个带约束的正则化逆问题。\n\n### 第1步：提取给定信息\n\n给定信息如下：\n- 一个在 $n$ 个表面节点上的离散牵引力场，表示为矢量 $t \\in \\mathbb{R}^{2n}$，其分量堆叠为 $[t_{1x}, t_{1y}, t_{2x}, t_{2y}, \\dots, t_{nx}, t_{ny}]^{\\top}$。\n- 在相同 $n$ 个节点上的离散位移场，表示为矢量 $u \\in \\mathbb{R}^{2n}$，具有相同的分量排序。\n- 底层物理原理：准静态平衡（意味着净力和力矩平衡）和线性弹性。\n- 关联位移 $u$ 和牵引力 $t$ 的正向模型是线性的：$u = K t$。\n- 反演问题使用零阶吉洪诺夫正则化进行正则化，标量罚参数为 $\\alpha > 0$。\n- 全局平衡约束作为硬等式约束 $A t = 0$ 强制执行。\n- 矩阵 $A \\in \\mathbb{R}^{3 \\times 2n}$ 必须编码净力平衡（前两行）和关于原点的净力矩平衡（第三行）。\n- 正向算子 $K \\in \\mathbb{R}^{2n \\times 2n}$ 由 $2 \\times 2$ 的分块矩阵 $B_{ij}$ 组装而成，该分块矩阵将节点 $j$ 处的牵引力映射到节点 $i$ 处的位移。\n- 分块矩阵 $B_{ij}$ 的公式为：\n$$\nB_{ij} =\nk(r_{ij})\n\\begin{bmatrix}\n(1 - \\gamma) + \\gamma \\dfrac{\\Delta x_{ij}^2}{r_{ij}^2 + \\varepsilon} \n\\gamma \\dfrac{\\Delta x_{ij} \\Delta y_{ij}}{r_{ij}^2 + \\varepsilon} \\\\\n\\gamma \\dfrac{\\Delta x_{ij} \\Delta y_{ij}}{r_{ij}^2 + \\varepsilon} \n(1 - \\gamma) + \\gamma \\dfrac{\\Delta y_{ij}^2}{r_{ij}^2 + \\varepsilon}\n\\end{bmatrix}\n$$\n其中 $\\Delta x_{ij} = x_i - x_j$, $\\Delta y_{ij} = y_i - y_j$, $r_{ij}^2 = \\Delta x_{ij}^2 + \\Delta y_{ij}^2$，影响函数为 $k(r_{ij}) = \\exp(-r_{ij}^2 / \\ell^2)$。\n- 正向算子的参数包括长度尺度 $\\ell > 0$，耦合参数 $\\gamma \\in [0, 1)$，以及一个小的常数 $\\varepsilon > 0$。\n- 测试环境：$n = 4$ 个节点，其坐标 $(x, y)$ 按顺序为 $\\{(-1,-1), (1,-1), (-1,1), (1,1)\\}$。问题是无量纲的。\n- 噪声模型：测量位移为 $u = K t^\\star + \\eta$，其中 $\\eta$ 是一个噪声矢量，其分量从独立高斯分布 $\\mathcal{N}(0, \\sigma^2)$ 中抽取。必须使用固定的随机种子。\n- 常数：$\\varepsilon = 10^{-12}$。\n- 测试用例 1：$\\ell = 1.5$，$\\gamma = 0.3$，$\\alpha = 10^{-6}$，$\\sigma = 0$，$t^\\star = [1, 0.5, -1, 0.5, 1, -0.5, -1, -0.5]^{\\top}$。\n- 测试用例 2：$\\ell = 0.7$，$\\gamma = 0.45$，$\\alpha = 10^{-8}$，$\\sigma = 10^{-3}$，$t^\\star = [0.8, -0.6, -0.8, -0.6, 0.8, 0.6, -0.8, 0.6]^{\\top}$。\n- 测试用例 3：$\\ell = 1.0$，$\\gamma = 0.35$，$\\alpha = 10^{-6}$，$\\sigma = 5 \\times 10^{-4}$，$t^\\star = [1.2, 0.4, -0.9, 0.6, 1.1, -0.3, -0.7, -0.2]^{\\top}$。\n- 要求输出：每个测试用例的欧几里得范数误差 $\\| \\hat{t} - t^\\star \\|_2$。\n\n### 第2步：使用提取的给定信息进行验证\n\n- **科学基础**：该问题基于连续介质力学（线性弹性、静态平衡）的基本原理和逆问题的标准数值方法（吉洪诺夫正则化、KKT 条件）。TFM 是生物力学中一种成熟的技术，此问题代表了其核心计算任务的一个简化但有效的表述。该问题是合理的。\n- **适定性**：使用 $\\alpha > 0$ 的吉洪诺夫正则化专门用于解决逆问题的不适定性。该表述导出一个可解的 Karush-Kuhn-Tucker (KKT) 线性系统，只要 KKT 矩阵非奇异，通常存在唯一解。该问题是适定的。\n- **客观性**：所有术语都经过数学上的精确定义。任务是具体和定量的。该问题是客观的。\n- **完整性和一致性**：该问题为每个测试用例提供了所有必要的数据和参数。没有矛盾之处。\n- **现实性**：虽然正向算子 $K$ 是一个简化的模型，但它作为一个计算问题的有效数学构造是成立的。参数在合理的无量纲范围内。\n- **结构性和形式化**：该问题结构清晰，形式化，可以直接转化为计算算法。\n\n该问题是有效的，因为它具有科学基础、适定性、客观性、完整性，并且在算法上是可处理的。\n\n### 第3步：推导与求解\n\n将按照指定的任务来解决问题。\n\n#### 任务1：约束矩阵 $A$ 的推导\n\n牵引力矢量为 $t \\in \\mathbb{R}^{2n}$，其分量排序为 $t = [t_{1x}, t_{1y}, t_{2x}, t_{2y}, \\dots, t_{nx}, t_{ny}]^{\\top}$。第 $j$ 个节点的位置是 $(x_j, y_j)$。\n\n1.  **x方向的合力**：所有牵引力 $x$ 分量的总和必须为零。\n    $$ \\sum_{j=1}^{n} t_{jx} = 0 $$\n    这对应于约束系统 $A t = 0$ 的第一行。$A$ 的第一行向量，我们称之为 $a_1^\\top$，必须在对应于 $t_{jx}$ 的位置（即索引 $1, 3, 5, \\dots, 2n-1$）为 $1$，在其他位置为 $0$。对于矢量 $t$ 的零基索引，这些是索引 $0, 2, 4, \\dots, 2n-2$。\n\n2.  **y方向的合力**：所有牵引力 $y$ 分量的总和必须为零。\n    $$ \\sum_{j=1}^{n} t_{jy} = 0 $$\n    这对应于约束系统的第二行。$A$ 的第二行向量 $a_2^\\top$ 必须在对应于 $t_{jy}$ 的位置（即索引 $2, 4, 6, \\dots, 2n$）为 $1$，在其他位置为 $0$。对于零基索引，这些是索引 $1, 3, 5, \\dots, 2n-1$。\n\n3.  **关于原点的合力矩**：在位置 $(x_j, y_j)$ 处的牵引力 $(t_{jx}, t_{jy})$ 产生的力矩是叉积 $r_j \\times F_j$ 的平面外分量，即 $\\tau_j = x_j t_{jy} - y_j t_{jx}$。合力矩必须为零。\n    $$ \\sum_{j=1}^{n} (x_j t_{jy} - y_j t_{jx}) = 0 $$\n    这是第三个约束。$A$ 的第三行向量 $a_3^\\top$ 的分量是 $t$ 矢量分量的系数。$t_{jx}$ 的系数是 $-y_j$，$t_{jy}$ 的系数是 $x_j$。\n\n将这三个行向量堆叠起来，得到约束矩阵 $A \\in \\mathbb{R}^{3 \\times 2n}$：\n$$\nA = \\begin{bmatrix}\n1  0  1  0  \\dots  1  0 \\\\\n0  1  0  1  \\dots  0  1 \\\\\n-y_1  x_1  -y_2  x_2  \\dots  -y_n  x_n\n\\end{bmatrix}\n$$\n\n#### 任务2：KKT 系统的构建\n\n问题是找到牵引力矢量 $\\hat{t}$，它在满足线性等式约束的条件下，最小化吉洪诺夫正则化目标函数：\n$$\n\\min_{t \\in \\mathbb{R}^{2n}} \\frac{1}{2} \\| K t - u \\|_2^2 + \\frac{\\alpha}{2} \\| t \\|_2^2 \\quad \\text{subject to} \\quad A t = 0\n$$\n因子 $\\frac{1}{2}$ 是为了数学上的方便而包含的，不影响最小化器。这是一个带等式约束的凸二次规划问题，可以使用拉格朗日乘子法求解。拉格朗日函数 $\\mathcal{L}$ 是：\n$$\n\\mathcal{L}(t, \\lambda) = \\frac{1}{2} (K t - u)^{\\top}(K t - u) + \\frac{\\alpha}{2} t^{\\top}t + \\lambda^{\\top} (A t)\n$$\n其中 $\\lambda \\in \\mathbb{R}^3$ 是拉格朗日乘子矢量。通过将 $\\mathcal{L}$ 对 $t$ 和 $\\lambda$ 的偏导数设为零，可以找到 Karush-Kuhn-Tucker (KKT) 条件。\n\n1.  对 $t$ 的导数：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial t} = K^{\\top}(K t - u) + \\alpha I t + A^{\\top} \\lambda = 0\n    $$\n    整理各项，我们得到：\n    $$\n    (K^{\\top}K + \\alpha I) t + A^{\\top} \\lambda = K^{\\top} u\n    $$\n    这里，$I$ 是 $2n \\times 2n$ 的单位矩阵。\n\n2.  对 $\\lambda$ 的导数：\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = A t = 0\n    $$\n    这恢复了原始的等式约束。\n\n这两个方程构成了一个关于未知牵引力矢量 $t$ 和拉格朗日乘子矢量 $\\lambda$ 的线性方程组。该系统可以写成分块矩阵形式：\n$$\n\\begin{bmatrix}\nK^{\\top}K + \\alpha I  & A^{\\top} \\\\\nA  & 0\n\\end{bmatrix}\n\\begin{bmatrix}\nt \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nK^{\\top} u \\\\\n0\n\\end{bmatrix}\n$$\n其中矩阵右下角的 $0$ 是一个 $3 \\times 3$ 的零矩阵，右侧的 $0$ 是一个 $3 \\times 1$ 的零矢量。这就是所需的 KKT 系统。求解这个 $(2n+3) \\times (2n+3)$ 的系统，可以得到最优牵引力估计 $\\hat{t}$ 和相应的拉格朗日乘子 $\\lambda$。\n\n#### 任务 3 和 4：实现与测试\n\n对于每个测试用例，实现过程包括以下步骤：\n1.  定义节点位置和问题参数（$\\ell, \\gamma, \\alpha, \\sigma, t^\\star, \\varepsilon$）。\n2.  使用提供的 $B_{ij}$ 分块矩阵公式构建 $2n \\times 2n$ 的正向算子矩阵 $K$。对于 $n=4$，$K$ 是一个 $8 \\times 8$ 的矩阵。\n3.  根据推导的公式和节点位置构建 $3 \\times 2n$ 的约束矩阵 $A$。对于 $n=4$，$A$ 是一个 $3 \\times 8$ 的矩阵。\n4.  合成测量矢量 $u$。首先，计算无噪声位移 $u_{true} = K t^\\star$。然后，添加高斯噪声：$u = u_{true} + \\eta$，其中 $\\eta \\sim \\mathcal{N}(0, \\sigma^2 I_{2n})$。固定的随机种子确保了可复现性。\n5.  组装 $(2n+3) \\times (2n+3)$ 的 KKT 矩阵和 $(2n+3) \\times 1$ 的右侧矢量。对于 $n=4$，这是一个 $11 \\times 11$ 的系统。\n6.  求解 KKT 线性系统以找到解矢量，其中包含 $\\hat{t}$ 和 $\\lambda$。\n7.  提取估计的牵引力矢量 $\\hat{t}$（解矢量的前 $2n$ 个分量）。\n8.  计算最终误差，即估计牵引力矢量与真实牵引力矢量之差的欧几里得范数：$\\| \\hat{t} - t^\\star \\|_2$。\n9.  收集每个测试用例的误差，并将输出格式化为逗号分隔的列表。\n\n以下是实现求解器的 Python 代码：\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained TFM inverse problem for three test cases\n    and prints the Euclidean norm error for each case.\n    \"\"\"\n\n    # Test suite parameters\n    test_cases = [\n        {\n            \"l\": 1.5, \"gamma\": 0.3, \"alpha\": 1e-6, \"sigma\": 0.0,\n            \"t_star\": np.array([1.0, 0.5, -1.0, 0.5, 1.0, -0.5, -1.0, -0.5])\n        },\n        {\n            \"l\": 0.7, \"gamma\": 0.45, \"alpha\": 1e-8, \"sigma\": 1e-3,\n            \"t_star\": np.array([0.8, -0.6, -0.8, -0.6, 0.8, 0.6, -0.8, 0.6])\n        },\n        {\n            \"l\": 1.0, \"gamma\": 0.35, \"alpha\": 1e-6, \"sigma\": 5e-4,\n            \"t_star\": np.array([1.2, 0.4, -0.9, 0.6, 1.1, -0.3, -0.7, -0.2])\n        }\n    ]\n\n    # Shared parameters\n    n = 4\n    node_positions = np.array([[-1.0, -1.0], [1.0, -1.0], [-1.0, 1.0], [1.0, 1.0]])\n    epsilon = 1e-12\n    # Fixed seed for reproducible noise generation\n    rng = np.random.default_rng(seed=42)\n\n    results = []\n\n    for case in test_cases:\n        l = case[\"l\"]\n        gamma = case[\"gamma\"]\n        alpha = case[\"alpha\"]\n        sigma = case[\"sigma\"]\n        t_star = case[\"t_star\"]\n        dim_t = 2 * n\n\n        # 1. Construct the forward operator K\n        K = np.zeros((dim_t, dim_t))\n        for i in range(n):\n            for j in range(n):\n                pos_i = node_positions[i]\n                pos_j = node_positions[j]\n                delta_x = pos_i[0] - pos_j[0]\n                delta_y = pos_i[1] - pos_j[1]\n                r_sq = delta_x**2 + delta_y**2\n                \n                k_r = np.exp(-r_sq / l**2)\n                denom = r_sq + epsilon\n\n                B_ij = np.zeros((2, 2))\n                B_ij[0, 0] = k_r * ((1 - gamma) + gamma * delta_x**2 / denom)\n                B_ij[0, 1] = k_r * (gamma * delta_x * delta_y / denom)\n                B_ij[1, 0] = B_ij[0, 1]\n                B_ij[1, 1] = k_r * ((1 - gamma) + gamma * delta_y**2 / denom)\n                \n                K[2*i:2*i+2, 2*j:2*j+2] = B_ij\n\n        # 2. Construct the constraint matrix A\n        dim_lambda = 3\n        A = np.zeros((dim_lambda, dim_t))\n        # Net force in x\n        A[0, 0::2] = 1.0\n        # Net force in y\n        A[1, 1::2] = 1.0\n        # Net torque about origin\n        A[2, 0::2] = -node_positions[:, 1]  # -y_j for t_jx\n        A[2, 1::2] = node_positions[:, 0]   #  x_j for t_jy\n\n        # 3. Synthesize the measured displacement u\n        u_noise_free = K @ t_star\n        noise = rng.normal(loc=0.0, scale=sigma, size=dim_t)\n        u = u_noise_free + noise\n\n        # 4. Assemble and solve the KKT system\n        dim_kkt = dim_t + dim_lambda\n        KKT_matrix = np.zeros((dim_kkt, dim_kkt))\n        rhs_vector = np.zeros(dim_kkt)\n\n        # Top-left block: (K^T * K + alpha * I)\n        H = K.T @ K + alpha * np.identity(dim_t)\n        KKT_matrix[0:dim_t, 0:dim_t] = H\n        # Top-right block: A^T\n        KKT_matrix[0:dim_t, dim_t:] = A.T\n        # Bottom-left block: A\n        KKT_matrix[dim_t:, 0:dim_t] = A\n        # Bottom-right block is already zero\n\n        # Right-hand side vector\n        # Top part: K^T * u\n        rhs_vector[0:dim_t] = K.T @ u\n        # Bottom part is already zero\n        \n        # Solve the system\n        try:\n            solution = np.linalg.solve(KKT_matrix, rhs_vector)\n            t_hat = solution[0:dim_t]\n        except np.linalg.LinAlgError:\n            # Fallback to a more stable pseudo-inverse solver if standard solve fails\n            # This is good practice for potentially ill-conditioned systems.\n            solution = np.linalg.pinv(KKT_matrix) @ rhs_vector\n            t_hat = solution[0:dim_t]\n\n        # 5. Calculate the Euclidean norm error\n        error = np.linalg.norm(t_hat - t_star)\n        results.append(error)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# The function call is commented out because it's not needed for the final output,\n# but can be used for local testing.\n# solve()\n```",
            "answer": "[1.3440781708170868e-06,0.0163351336423986,0.2038743128151449]"
        }
    ]
}