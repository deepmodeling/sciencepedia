{
    "hands_on_practices": [
        {
            "introduction": "Wall shear stress ($\\tau_w$) is the primary mechanical signal regulating vascular health, yet its origins lie in fundamental fluid mechanics. This foundational exercise  guides you through a first-principles derivation of $\\tau_w$ for idealized arterial flow, starting from the Navier-Stokes equations. Completing this derivation builds a crucial intuition for how macroscopic parameters like flow rate ($Q$) and vessel radius ($R$) dictate the forces sensed by endothelial cells.",
            "id": "4189115",
            "problem": "Consider a straight, rigid, cylindrical artery of radius $R$ and length $L$, filled with an incompressible Newtonian fluid of density $\\rho$ and dynamic viscosity $\\mu$. The flow is steady, laminar, axisymmetric, and fully developed along the axial coordinate $z$; gravitational and other body forces are negligible. Let $u(r)$ denote the axial velocity as a function of the radial coordinate $r$, with no-slip at the wall and symmetry at the centerline. The volumetric flow rate is $Q$, and the pressure gradient $\\partial p / \\partial z$ is uniform along the vessel.\n\nStarting from the axisymmetric form of the Navier–Stokes equations in cylindrical coordinates and the conservation of mass, derive the axial velocity profile $u(r)$ for this flow. Then, using the definition of wall shear stress (WSS), $\\tau_w$, as the magnitude of the viscous shear stress acting on the arterial wall at $r=R$, express $\\tau_w$ in terms of $Q$, $R$, and $\\mu$ only. Assume that $Q$ is positive in the direction of decreasing pressure. Use the fully developed, axisymmetric solution consistent with the stated assumptions. Express your final answer in Pascals, assuming International System of Units (SI) with $\\mu$ in $\\mathrm{Pa \\cdot s}$, $Q$ in $\\mathrm{m^3 \\, s^{-1}}$, and $R$ in $\\mathrm{m}$. Provide the final answer as a single closed-form analytic expression for $\\tau_w$; do not include any units in the final boxed expression.",
            "solution": "The problem statement constitutes a classic, well-posed problem in fluid mechanics, commonly known as Hagen-Poiseuille flow. All conditions provided are self-consistent, scientifically grounded, and sufficient for the derivation of a unique solution. We proceed with the derivation.\n\nThe motion of an incompressible Newtonian fluid is governed by the conservation of mass (continuity equation) and the Navier–Stokes equations (conservation of momentum). In cylindrical coordinates $(r, \\theta, z)$ with corresponding velocity components $(v_r, v_{\\theta}, u)$, these are:\n\nContinuity Equation:\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_{\\theta}}{\\partial \\theta} + \\frac{\\partial u}{\\partial z} = 0 $$\n\nNavier-Stokes Equations (momentum):\n$r$-component:\n$$ \\rho \\left( \\frac{\\partial v_r}{\\partial t} + v_r \\frac{\\partial v_r}{\\partial r} + \\frac{v_{\\theta}}{r}\\frac{\\partial v_r}{\\partial \\theta} - \\frac{v_{\\theta}^2}{r} + u \\frac{\\partial v_r}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial r} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial v_r}{\\partial r}\\right) - \\frac{v_r}{r^2} + \\frac{1}{r^2}\\frac{\\partial^2 v_r}{\\partial \\theta^2} - \\frac{2}{r^2}\\frac{\\partial v_{\\theta}}{\\partial \\theta} + \\frac{\\partial^2 v_r}{\\partial z^2} \\right] $$\n$\\theta$-component:\n$$ \\rho \\left( \\frac{\\partial v_{\\theta}}{\\partial t} + v_r \\frac{\\partial v_{\\theta}}{\\partial r} + \\frac{v_{\\theta}}{r}\\frac{\\partial v_{\\theta}}{\\partial \\theta} + \\frac{v_r v_{\\theta}}{r} + u \\frac{\\partial v_{\\theta}}{\\partial z} \\right) = -\\frac{1}{r}\\frac{\\partial p}{\\partial \\theta} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial v_{\\theta}}{\\partial r}\\right) - \\frac{v_{\\theta}}{r^2} + \\frac{1}{r^2}\\frac{\\partial^2 v_{\\theta}}{\\partial \\theta^2} + \\frac{2}{r^2}\\frac{\\partial v_r}{\\partial \\theta} + \\frac{\\partial^2 v_{\\theta}}{\\partial z^2} \\right] $$\n$z$-component:\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + v_r \\frac{\\partial u}{\\partial r} + \\frac{v_{\\theta}}{r}\\frac{\\partial u}{\\partial \\theta} + u \\frac{\\partial u}{\\partial z} \\right) = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 u}{\\partial \\theta^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right] $$\n\nWe apply the simplifying assumptions given in the problem statement:\n1.  Steady flow: $\\frac{\\partial}{\\partial t} = 0$ for all quantities.\n2.  Axisymmetric flow: $\\frac{\\partial}{\\partial \\theta} = 0$ for all quantities. By symmetry, the tangential velocity $v_{\\theta}$ must be zero, $v_{\\theta} = 0$.\n3.  Fully developed flow along $z$: $\\frac{\\partial u}{\\partial z} = 0$. This implies that the velocity profile $u(r)$ does not change along the axial direction.\n\nApplying these assumptions to the continuity equation:\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + 0 + 0 = 0 \\implies \\frac{d(r v_r)}{dr} = 0 $$\nIntegrating this yields $r v_r = \\text{constant}$. At the centerline ($r=0$), the radial velocity $v_r$ must be finite. For the product $r v_r$ to be constant and finite as $r \\to 0$, the constant must be zero. Therefore, $v_r = 0$ everywhere in the flow.\n\nNow we simplify the momentum equations:\n$r$-component: With $v_r=0$ and $v_{\\theta}=0$, all terms on the left-hand side and all viscous terms on the right-hand side become zero. The equation reduces to:\n$$ 0 = -\\frac{\\partial p}{\\partial r} \\implies \\frac{\\partial p}{\\partial r} = 0 $$\nThis shows that pressure $p$ does not vary with the radial coordinate $r$.\n\n$\\theta$-component: With $v_r = 0$, $v_{\\theta}=0$, and axisymmetry ($\\partial p/\\partial \\theta = 0$), the equation becomes $0 = 0$, which is trivially satisfied.\n\n$z$-component: All terms on the left-hand side (inertial terms) are zero because $\\partial u/\\partial t=0$, $v_r=0$, and $\\partial u/\\partial z=0$. The viscous terms simplify due to axisymmetry ($\\partial^2 u/\\partial \\theta^2 = 0$) and fully developed flow ($\\partial^2 u/\\partial z^2 = 0$). The equation simplifies to:\n$$ 0 = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u}{\\partial r}\\right) \\right] $$\nSince $\\partial p/\\partial r = 0$ and $\\partial p/\\partial \\theta=0$, pressure $p$ can only be a function of $z$, so we can write $\\frac{\\partial p}{\\partial z}$ as the total derivative $\\frac{dp}{dz}$. The problem states this gradient is uniform, so it is a constant. Rearranging the equation:\n$$ \\frac{1}{\\mu} \\frac{dp}{dz} = \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{du}{dr}\\right) $$\nAs $u$ is only a function of $r$, we use total derivatives. Let the constant pressure gradient be $G = \\frac{dp}{dz}$.\n$$ \\frac{d}{dr}\\left(r \\frac{du}{dr}\\right) = \\frac{G}{\\mu} r $$\nIntegrating once with respect to $r$:\n$$ r \\frac{du}{dr} = \\frac{G}{2\\mu} r^2 + C_1 $$\n$$\\frac{du}{dr} = \\frac{G}{2\\mu} r + \\frac{C_1}{r} $$\nThe symmetry boundary condition at the centerline ($r=0$) requires the velocity gradient $\\frac{du}{dr}$ to be finite. For this to hold, the constant of integration $C_1$ must be zero.\n$$ \\frac{du}{dr} = \\frac{G}{2\\mu} r $$\nIntegrating a second time:\n$$ u(r) = \\frac{G}{4\\mu} r^2 + C_2 $$\nWe use the no-slip boundary condition at the wall, $u(R) = 0$, to find $C_2$:\n$$ 0 = \\frac{G}{4\\mu} R^2 + C_2 \\implies C_2 = -\\frac{G}{4\\mu} R^2 $$\nSubstituting $C_2$ back into the expression for $u(r)$, we obtain the axial velocity profile:\n$$ u(r) = \\frac{G}{4\\mu} r^2 - \\frac{G}{4\\mu} R^2 = \\frac{G}{4\\mu} (r^2 - R^2) = -\\frac{G}{4\\mu}(R^2 - r^2) $$\nSince flow occurs in the direction of decreasing pressure, $\\frac{dp}{dz} = G  0$, which ensures that $u(r)$ is positive for $r  R$, resulting in the characteristic parabolic profile.\n\nNext, we relate the volumetric flow rate $Q$ to the pressure gradient $G$. $Q$ is the integral of the velocity profile over the cross-sectional area $A$:\n$$ Q = \\int_A u(r) dA $$\nThe differential area element is $dA = 2\\pi r dr$.\n$$ Q = \\int_{0}^{R} \\frac{G}{4\\mu}(r^2 - R^2) (2\\pi r) dr = \\frac{2\\pi G}{4\\mu} \\int_{0}^{R} (r^3 - R^2 r) dr $$\n$$ Q = \\frac{\\pi G}{2\\mu} \\left[ \\frac{r^4}{4} - \\frac{R^2 r^2}{2} \\right]_0^R = \\frac{\\pi G}{2\\mu} \\left( \\frac{R^4}{4} - \\frac{R^4}{2} \\right) = \\frac{\\pi G}{2\\mu} \\left( -\\frac{R^4}{4} \\right) = -\\frac{\\pi G R^4}{8\\mu} $$\nThis is the Hagen-Poiseuille law. We can invert this to express the pressure gradient $G$ in terms of the flow rate $Q$:\n$$ G = -\\frac{8 \\mu Q}{\\pi R^4} $$\n\nFinally, we calculate the wall shear stress, $\\tau_w$. The shear stress component $\\tau_{rz}$ for a Newtonian fluid in cylindrical coordinates is $\\tau_{rz} = \\mu \\left( \\frac{\\partial u}{\\partial r} + \\frac{\\partial v_r}{\\partial z} \\right)$. Since $v_r = 0$, this simplifies to $\\tau_{rz} = \\mu \\frac{du}{dr}$.\nWall shear stress $\\tau_w$ is the magnitude of this stress evaluated at the wall, $r=R$.\n$$ \\tau_w = |\\tau_{rz}|_{r=R} = \\left| \\mu \\frac{du}{dr} \\right|_{r=R} $$\nWe previously found the velocity gradient:\n$$ \\frac{du}{dr} = \\frac{G}{2\\mu} r $$\nEvaluating at $r=R$:\n$$ \\left. \\frac{du}{dr} \\right|_{r=R} = \\frac{G R}{2\\mu} $$\nSubstituting this into the expression for $\\tau_w$:\n$$ \\tau_w = \\left| \\mu \\left( \\frac{G R}{2\\mu} \\right) \\right| = \\left| \\frac{G R}{2} \\right| $$\nSince $G  0$ and $R > 0$, the quantity inside the absolute value is negative. Thus, we take its negative:\n$$ \\tau_w = -\\frac{G R}{2} $$\nNow, we substitute the expression for $G$ in terms of $Q$, $R$, and $\\mu$:\n$$ \\tau_w = -\\left( -\\frac{8 \\mu Q}{\\pi R^4} \\right) \\frac{R}{2} = \\frac{8 \\mu Q R}{2 \\pi R^4} $$\nSimplifying this expression yields the final result for the wall shear stress:\n$$ \\tau_w = \\frac{4 \\mu Q}{\\pi R^3} $$\nThis expression relates the wall shear stress directly to the measurable macroscopic quantities of flow rate $Q$, vessel radius $R$, and fluid viscosity $\\mu$.",
            "answer": "$$\\boxed{\\frac{4 \\mu Q}{\\pi R^3}}$$"
        },
        {
            "introduction": "With a physical understanding of shear stress, we now examine how it is sensed at the molecular level by mechanosensitive ion channels like Piezo1. These channels act as transducers, converting mechanical stimuli into the biochemical signals that drive cellular responses. This biophysical modeling exercise  explores how the channel's gating probability responds differently to steady versus oscillatory shear, revealing a key mechanism by which cells distinguish between healthy and disease-promoting flow patterns.",
            "id": "4189041",
            "problem": "Endothelial mechanosensitive cation channel Piezo1 is implicated in the initiation and progression of atherosclerosis through its transduction of hemodynamic shear stress into intracellular calcium signals that drive inflammatory gene expression and vascular remodeling. Consider a single-channel two-state model (open and closed) for Piezo1 in which the open probability at any instant is governed by equilibrium statistical mechanics. Let the free energy difference between closed and open states be given by $\\Delta G(t) = \\Delta G_{0} - \\gamma\\,\\sigma(t)$, where $\\Delta G_{0}  0$ is the zero-tension free energy bias favoring the closed state, $\\gamma  0$ is an effective gating tension sensitivity with units of energy per unit tension, and $\\sigma(t)$ is the membrane tension experienced by the channel. Assume that the endothelial membrane tension responds linearly to the wall shear stress $\\tau_{w}(t)$ as $\\sigma(t) = \\sigma_{b} + \\alpha\\,\\tau_{w}(t)$, where $\\sigma_{b}$ is the baseline tension in the absence of flow and $\\alpha  0$ is a shear-to-tension coupling coefficient. The open probability under quasi-static equilibrium follows from the Boltzmann distribution as $P_{o}(t) = \\left[1 + \\exp\\!\\left(\\frac{\\Delta G(t)}{k_{B} T}\\right)\\right]^{-1}$, where $k_{B}$ is the Boltzmann constant and $T$ is absolute temperature.\n\nConsider two shear environments that are relevant to vascular physiology:\n- A steady shear environment with constant wall shear stress $\\tau_{w}(t) = \\tau_{s}$.\n- An oscillatory shear environment with $\\tau_{w}(t) = \\tau_{s} + \\tau_{a}\\,\\sin(\\omega t)$, where $\\tau_{a}$ is the oscillation amplitude, $\\omega$ is the angular frequency, and the quasi-static approximation holds because channel gating is fast compared to the period $2\\pi/\\omega$.\n\nDefine the dimensionless quantities $x_{s} \\equiv \\dfrac{\\Delta G_{0} - \\gamma\\,(\\sigma_{b} + \\alpha\\,\\tau_{s})}{k_{B} T}$ and $\\eta \\equiv \\dfrac{\\gamma\\,\\alpha\\,\\tau_{a}}{k_{B} T}$. Assume the small-amplitude limit $|\\eta| \\ll 1$ such that a second-order expansion in $\\eta$ is accurate. Starting from the equilibrium expression for $P_{o}(t)$ and the definitions above, derive $P_{o}(t)$ up to second order in $\\eta$ for the oscillatory shear case, and then compute the cycle-averaged open probability $\\overline{P_{o}}$ over one oscillation period $T_{\\mathrm{osc}} = 2\\pi/\\omega$.\n\nYour final answer must be a single closed-form analytic expression for the cycle-averaged open probability $\\overline{P_{o}}$ in terms of $x_{s}$ and $\\eta$ (you may also express it in terms of the steady-shear open probability $P_{s} \\equiv [1 + \\exp(x_{s})]^{-1}$). No numerical evaluation is required and no units are to be reported in the final answer box.",
            "solution": "The problem requires the calculation of the cycle-averaged open probability $\\overline{P_{o}}$ for a Piezo1 channel model under oscillatory shear stress, using a second-order expansion in the small parameter $\\eta$.\n\nFirst, we express the argument of the exponential in the open probability function, $\\frac{\\Delta G(t)}{k_{B} T}$, in terms of the given dimensionless parameters. The free energy difference for oscillatory shear is:\n$$ \\Delta G(t) = \\Delta G_{0} - \\gamma \\left( \\sigma_{b} + \\alpha \\left( \\tau_{s} + \\tau_{a}\\,\\sin(\\omega t) \\right) \\right) = \\left( \\Delta G_{0} - \\gamma\\,\\sigma_{b} - \\gamma\\,\\alpha\\,\\tau_{s} \\right) - \\gamma\\,\\alpha\\,\\tau_{a}\\,\\sin(\\omega t) $$\n\nDividing by $k_{B} T$ and using the provided definitions for the dimensionless quantities $x_{s}$ and $\\eta$, we can write this compactly as:\n$$ \\frac{\\Delta G(t)}{k_{B} T} = x_{s} - \\eta\\,\\sin(\\omega t) $$\n\nThe instantaneous open probability $P_{o}(t)$ is therefore:\n$$ P_{o}(t) = \\left[1 + \\exp\\left(x_{s} - \\eta\\,\\sin(\\omega t)\\right)\\right]^{-1} $$\n\nWe are asked to find an approximation for small $\\eta$ ($|\\eta| \\ll 1$). This suggests a Taylor series expansion of $P_{o}(t)$ with respect to the small variable, which is $\\eta\\,\\sin(\\omega t)$. Let us define a function $f(z) = [1 + \\exp(x_s - z)]^{-1}$, such that $P_o(t) = f(\\eta \\sin(\\omega t))$. We expand $f(z)$ around $z=0$ up to the second order:\n$$ f(z) \\approx f(0) + f'(0)z + \\frac{1}{2}f''(0)z^2 $$\n\nWe compute the function and its derivatives at $z=0$:\nThe zeroth-order term is the function evaluated at $z=0$, which is the steady-shear open probability $P_s$:\n$$ f(0) = [1 + \\exp(x_s)]^{-1} = P_s $$\n\nThe first derivative is conveniently expressed as $f'(z) = f(z)(1-f(z))$. At $z=0$:\n$$ f'(0) = f(0)(1-f(0)) = P_s(1-P_s) $$\n\nThe second derivative is $f''(z) = f'(z)(1 - 2f(z))$. At $z=0$:\n$$ f''(0) = f'(0)(1 - 2f(0)) = P_s(1-P_s)(1 - 2P_s) $$\n\nNow, we substitute these into the Taylor expansion with $z = \\eta\\,\\sin(\\omega t)$:\n$$ P_{o}(t) \\approx P_s + \\left(P_s(1-P_s)\\right)\\eta\\,\\sin(\\omega t) + \\frac{1}{2}\\left(P_s(1-P_s)(1-2P_s)\\right)\\eta^2\\,\\sin^2(\\omega t) $$\n\nThe final step is to compute the cycle-averaged open probability, $\\overline{P_{o}}$, by integrating over one oscillation period $T_{\\mathrm{osc}} = 2\\pi/\\omega$:\n$$ \\overline{P_{o}} = \\frac{1}{T_{\\mathrm{osc}}} \\int_{0}^{T_{\\mathrm{osc}}} P_{o}(t)\\,dt $$\nWe integrate the expansion of $P_o(t)$ term by term, using the standard time-averages of trigonometric functions over one period:\n$$ \\frac{1}{T_{\\mathrm{osc}}} \\int_{0}^{T_{\\mathrm{osc}}} \\sin(\\omega t)\\,dt = 0 $$\n$$ \\frac{1}{T_{\\mathrm{osc}}} \\int_{0}^{T_{\\mathrm{osc}}} \\sin^2(\\omega t)\\,dt = \\frac{1}{T_{\\mathrm{osc}}} \\int_{0}^{T_{\\mathrm{osc}}} \\frac{1-\\cos(2\\omega t)}{2}\\,dt = \\frac{1}{2} $$\n\nApplying these averages to the expansion of $P_{o}(t)$:\n$$ \\overline{P_{o}} \\approx P_s \\cdot 1 + \\left(P_s(1-P_s)\\eta\\right) \\cdot 0 + \\frac{1}{2}\\left(P_s(1-P_s)(1-2P_s)\\eta^2\\right) \\cdot \\frac{1}{2} $$\n\nThis simplifies to the final expression for the cycle-averaged open probability, accurate to second order in $\\eta$:\n$$ \\overline{P_{o}} \\approx P_s + \\frac{1}{4}P_s(1-P_s)(1-2P_s)\\eta^2 $$",
            "answer": "$$ \\boxed{P_s + \\frac{1}{4}P_s(1-P_s)(1-2P_s)\\eta^2} $$"
        },
        {
            "introduction": "The principles of hemodynamics and mechanotransduction have powerful predictive value in clinical settings. This computational exercise  applies these concepts to the critical problem of predicting in-stent restenosis, a common failure mode of vascular interventions. You will implement standard hemodynamic metrics, Time-Averaged Wall Shear Stress (TAWSS) and the Oscillatory Shear Index (OSI), to analyze how stenting alters the local flow environment and identify regions susceptible to pathological remodeling.",
            "id": "4189036",
            "problem": "You are given a simplified, patient-specific arterial segment represented by a one-dimensional set of axial wall locations, each with a local radius. The goal is to compute changes in Time-Averaged Wall Shear Stress (TAWSS) and Oscillatory Shear Index (OSI) before and after stent deployment, under assumptions that reflect the mechanobiology of atherosclerosis and vascular remodeling. Then, predict the post-stent regions at risk for restenosis using a combined shear criterion. Build a complete, runnable program that performs these computations on the provided test suite and produces the results in the exact output format specified at the end.\n\nAssumptions and fundamental base:\n- Blood is treated as an incompressible Newtonian fluid with dynamic viscosity $\\mu$ and constant density; flow is laminar, axisymmetric, and fully developed in a straight, short segment, with the no-slip boundary condition.\n- The governing laws are the conservation of mass and the incompressible Navier–Stokes equations. Under the stated assumptions along a circular tube of radius $R$, the axial velocity is a function of the radial coordinate only and the axial pressure gradient is uniform over the cross section. The wall shear stress is related to the near-wall velocity gradient by $\\tau_{w} = \\mu \\left.\\dfrac{\\partial u}{\\partial r}\\right|_{r=R}$, and the volumetric flow rate is $Q(t) = \\int_{A} u \\, dA$.\n- Over the cardiac cycle, the flow waveform $Q(t)$ may oscillate and may include brief flow reversal. The cycle is discretized into $N$ equally spaced time points $t_{k}$ with uniform timestep $\\Delta t$, so that time averages are simple arithmetic means.\n\nTarget quantities:\n- Time-Averaged Wall Shear Stress (TAWSS): the cycle-average of the magnitude of the instantaneous wall shear stress, expressed in pascals (Pa).\n- Oscillatory Shear Index (OSI): a dimensionless index that quantifies directional oscillation of wall shear stress over the cycle, bounded between $0$ and $0.5$. Use the standard definition based on the signed instantaneous wall shear stress and its magnitude over time.\n- For each axial location, compute pre-stent and post-stent values of TAWSS and OSI from first principles and then compute changes $\\Delta \\mathrm{TAWSS}$ and $\\Delta \\mathrm{OSI}$ as post minus pre.\n- Predict regions at risk for restenosis according to the combined criterion “low TAWSS and high OSI” applied post-stent, specifically: flag an axial location if $\\mathrm{TAWSS}_{\\text{post}}  \\tau_{\\text{low}}$ and $\\mathrm{OSI}_{\\text{post}}  \\mathrm{OSI}_{\\text{high}}$.\n\nRequired units and outputs:\n- Express $\\mathrm{TAWSS}$ in pascals (Pa). Express $\\mathrm{OSI}$ in a dimensionless number. Round all reported floating-point outputs to $6$ decimal places.\n- Indices of flagged axial locations must use zero-based indexing.\n- For each test case, produce a list of three items: the segment-average $\\Delta \\mathrm{TAWSS}$, the segment-average $\\Delta \\mathrm{OSI}$, and the sorted list of zero-based indices of axial locations flagged as at risk post-stent. Aggregate the three test case results into a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces, where each test case result is itself enclosed in square brackets. For example: `[[0.123456,0.0,[1,4]],[\\dots],[\\dots]]` but with no spaces anywhere in the output string.\n\nParameters, data, and test suite:\n- Dynamic viscosity: $\\mu = 3.5\\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$.\n- Restenosis risk thresholds: $\\tau_{\\text{low}} = 0.4\\ \\mathrm{Pa}$ and $\\mathrm{OSI}_{\\text{high}} = 0.2$.\n- Cardiac cycle discretization: $N = 6$ equally spaced samples, $\\Delta t = T/N$ with total cycle duration $T = 1.0\\ \\mathrm{s}$; all time averages are arithmetic means over these samples.\n- Geometry is specified by arrays of local radii at $M = 9$ axial locations. Radii are given in meters.\n\nTest case $1$ (“happy path” with focal stenosis, improved post-stent):\n- Pre-stent radii $R_{\\text{pre}}$: $[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.3\\times 10^{-3},\\,1.2\\times 10^{-3},\\,1.3\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$.\n- Post-stent radii $R_{\\text{post}}$: $[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.45\\times 10^{-3},\\,1.4\\times 10^{-3},\\,1.45\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$.\n- Flow waveform $Q(t_{k})$ in $\\mathrm{m^{3}/s}$: $[1.1\\times 10^{-6},\\,1.4\\times 10^{-6},\\,1.6\\times 10^{-6},\\,1.2\\times 10^{-6},\\,8.0\\times 10^{-7},\\,-1.0\\times 10^{-7}]$.\n\nTest case $2$ (“boundary” with no stenosis and no reversal):\n- Pre-stent radii $R_{\\text{pre}}$: $[1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.6\\times 10^{-3}]$.\n- Post-stent radii $R_{\\text{post}}$: same as pre-stent.\n- Flow waveform $Q(t_{k})$ in $\\mathrm{m^{3}/s}$: $[1.0\\times 10^{-6},\\,1.1\\times 10^{-6},\\,1.0\\times 10^{-6},\\,9.0\\times 10^{-7},\\,8.0\\times 10^{-7},\\,7.0\\times 10^{-7}]$.\n\nTest case $3$ (“edge” with severe pre-stent stenosis and local post-stent oversizing, with reversal):\n- Pre-stent radii $R_{\\textpre}}$: $[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.1\\times 10^{-3},\\,1.1\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$.\n- Post-stent radii $R_{\\textpost}}$: $[1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.9\\times 10^{-3},\\,1.9\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.5\\times 10^{-3}]$.\n- Flow waveform $Q(t_{k})$ in $\\mathrm{m^{3}/s}$: $[1.5\\times 10^{-6},\\,1.2\\times 10^{-6},\\,9.0\\times 10^{-7},\\,5.0\\times 10^{-7},\\,-3.0\\times 10^{-7},\\,-1.0\\times 10^{-7}]$.\n\nComputational requirements:\n- Derive the instantaneous wall shear stress at each axial location from the stated fundamental laws under the given assumptions, express it in terms of $\\mu$, $Q(t_{k})$, and the local radius $R$, clearly indicating direction (sign) consistent with the sign of $Q(t_{k})$.\n- Use the standard definitions of $\\mathrm{TAWSS}$ and $\\mathrm{OSI}$ based on time averaging over the discrete cycle samples.\n- For each test case, compute the segment-average $\\Delta \\mathrm{TAWSS}$ in $\\mathrm{Pa}$ and the segment-average $\\Delta \\mathrm{OSI}$ (dimensionless), each rounded to $6$ decimal places, and the sorted list of zero-based axial indices flagged by the combined risk criterion post-stent.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. Each test case result must be a list formatted as `[avg_dTAWSS,avg_dOSI,[idx_1,...]]`. For example: `[[0.123456,0.0,[1,4]],[\\dots],[\\dots]]` but with no spaces anywhere in the output string.",
            "solution": "The solution proceeds by first deriving the necessary physical quantities from the fundamental principles laid out in the problem statement.\n\nFirst, we derive the formula for the instantaneous wall shear stress, $\\tau_w$. The problem assumes laminar, axisymmetric, fully developed flow in a straight circular tube of radius $R$. This is the classic Hagen-Poiseuille flow scenario. The velocity profile $u(r)$ is parabolic, where $r$ is the radial coordinate.\nFor an incompressible Newtonian fluid, the volumetric flow rate $Q$ is related to the velocity profile $u(r)$ by:\n$$Q = \\int_{0}^{R} u(r) 2\\pi r \\, dr$$\nThe velocity profile for Poiseuille flow is given by $u(r) = u_{max} \\left(1 - \\frac{r^2}{R^2}\\right)$. Integrating this profile to find its relationship with $Q$ yields $Q = \\frac{1}{2} \\pi R^2 u_{max}$, which allows us to express the velocity profile in terms of the measurable flow rate $Q$:\n$$u(r, t) = \\frac{2Q(t)}{\\pi R^2} \\left(1 - \\frac{r^2}{R^2}\\right)$$\nHere, we adopt a quasi-steady assumption, where the profile at any instant $t$ is determined by the instantaneous flow rate $Q(t)$.\n\nThe wall shear stress, $\\tau_w$, is the frictional force per unit area exerted by the fluid on the tube wall. It is related to the dynamic viscosity $\\mu$ and the gradient of the axial velocity at the wall ($r=R$). Adopting the convention that $\\tau_w$ is positive for positive flow, which implies $\\tau_w$ is proportional to $-\\mu \\frac{\\partial u}{\\partial r}$:\n$$\\frac{\\partial u}{\\partial r} = \\frac{2Q(t)}{\\pi R^2} \\left(-\\frac{2r}{R^2}\\right) = -\\frac{4Q(t)r}{\\pi R^4}$$\nEvaluating at the wall, $r=R$:\n$$\\left.\\frac{\\partial u}{\\partial r}\\right|_{r=R} = -\\frac{4Q(t)}{\\pi R^3}$$\nThus, the instantaneous wall shear stress vector (which is purely axial in this 1D model) is:\n$$\\tau_w(t) = \\frac{4\\mu Q(t)}{\\pi R^3}$$\nThe sign of $\\tau_w(t)$ is directly coupled to the sign of the flow rate $Q(t)$, consistent with the problem requirements.\n\nNext, we define the target quantities, Time-Averaged Wall Shear Stress (TAWSS) and Oscillatory Shear Index (OSI), for a cardiac cycle discretized into $N$ time points $t_k$.\n\nThe TAWSS is the time-average of the magnitude of the wall shear stress. In discrete form:\n$$\\mathrm{TAWSS} = \\frac{1}{N} \\sum_{k=1}^{N} |\\tau_w(t_k)| = \\frac{1}{N} \\sum_{k=1}^{N} \\left| \\frac{4\\mu Q(t_k)}{\\pi R^3} \\right| = \\frac{4\\mu}{\\pi N R^3} \\sum_{k=1}^{N} |Q(t_k)|$$\n\nThe OSI is a dimensionless measure of the oscillation in the shear stress vector. The standard discrete definition is:\n$$\\mathrm{OSI} = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\sum_{k=1}^{N} \\tau_w(t_k) \\right|}{\\sum_{k=1}^{N} |\\tau_w(t_k)|} \\right)$$\nSubstituting the expression for $\\tau_w(t_k)$:\n$$\\mathrm{OSI} = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\sum_{k=1}^{N} \\frac{4\\mu Q(t_k)}{\\pi R^3} \\right|}{\\sum_{k=1}^{N} \\left| \\frac{4\\mu Q(t_k)}{\\pi R^3} \\right|} \\right) = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\frac{4\\mu}{\\pi R^3} \\sum_{k=1}^{N} Q(t_k) \\right|}{\\frac{4\\mu}{\\pi R^3} \\sum_{k=1}^{N} |Q(t_k)|} \\right)$$\nThe constant term $\\frac{4\\mu}{\\pi R^3}$ cancels, revealing that OSI is independent of the local radius $R$ and viscosity $\\mu$, and depends only on the flow waveform $Q(t_k)$:\n$$\\mathrm{OSI} = \\frac{1}{2} \\left( 1 - \\frac{\\left| \\sum_{k=1}^{N} Q(t_k) \\right|}{\\sum_{k=1}^{N} |Q(t_k)|} \\right)$$\nA critical consequence of this is that for a given test case, where the flow waveform $Q(t_k)$ is the same for pre-stent and post-stent scenarios, the OSI will be identical for all axial locations and identical for pre- and post-stent states. Therefore, the change $\\Delta \\mathrm{OSI} = \\mathrm{OSI}_{\\text{post}} - \\mathrm{OSI}_{\\text{pre}}$ is zero for all locations, and the segment-average $\\Delta \\mathrm{OSI}$ is also zero.\n\nThe computational algorithm for each test case is as follows:\n1.  Given the arrays of pre-stent radii $R_{\\text{pre}}$, post-stent radii $R_{\\text{post}}$, and the flow waveform $Q(t_k)$, and constants $\\mu$, $N$, $\\tau_{\\text{low}}$, $\\mathrm{OSI}_{\\text{high}}$. The number of axial locations is $M=9$.\n2.  Calculate the single OSI value for the test case using the derived formula based on $Q(t_k)$. This will serve as both $\\mathrm{OSI}_{\\text{pre}}$ and $\\mathrm{OSI}_{\\text{post}}$ for all locations. The segment-average $\\Delta \\mathrm{OSI}$ is $0.0$.\n3.  For each axial location $i$ from $0$ to $M-1$:\n    a. Calculate $\\mathrm{TAWSS}_{\\text{pre}, i}$ using its formula with radius $R_{\\text{pre}, i}$.\n    b. Calculate $\\mathrm{TAWSS}_{\\text{post}, i}$ using its formula with radius $R_{\\text{post}, i}$.\n    c. Compute the change $\\Delta \\mathrm{TAWSS}_i = \\mathrm{TAWSS}_{\\text{post}, i} - \\mathrm{TAWSS}_{\\text{pre}, i}$.\n4.  Compute the segment-average $\\Delta \\mathrm{TAWSS}$ by averaging the $\\Delta \\mathrm{TAWSS}_i$ values over all $M$ locations.\n5.  Identify at-risk locations. For each axial location $i$, check if the post-stent values satisfy the combined criterion: $\\mathrm{TAWSS}_{\\text{post}, i}  \\tau_{\\text{low}}$ AND $\\mathrm{OSI}_{\\text{post}}  \\mathrm{OSI}_{\\text{high}}$.\n6.  Collect the zero-based indices $i$ of all locations that meet the criterion. Sort these indices in ascending order.\n7.  Assemble the final result for the test case: a list containing the rounded segment-average $\\Delta \\mathrm{TAWSS}$, the rounded segment-average $\\Delta \\mathrm{OSI}$ ($0.0$), and the sorted list of at-risk indices.\n\nThis procedure will be applied to each of the three test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes changes in TAWSS and OSI before and after stent deployment\n    and predicts regions at risk for restenosis.\n    \"\"\"\n    # Define constants and thresholds\n    mu = 3.5e-3  # Dynamic viscosity in Pa.s\n    tau_low = 0.4  # Low TAWSS threshold in Pa\n    osi_high = 0.2  # High OSI threshold (dimensionless)\n    N = 6  # Number of cardiac cycle samples\n\n    # Test suite data\n    test_cases = [\n        {\n            \"R_pre\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.3e-3, 1.2e-3, 1.3e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"R_post\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.45e-3, 1.4e-3, 1.45e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"Q\": np.array([1.1e-6, 1.4e-6, 1.6e-6, 1.2e-6, 8.0e-7, -1.0e-7]),\n        },\n        {\n            \"R_pre\": np.array([1.6e-3] * 9),\n            \"R_post\": np.array([1.6e-3] * 9),\n            \"Q\": np.array([1.0e-6, 1.1e-6, 1.0e-6, 9.0e-7, 8.0e-7, 7.0e-7]),\n        },\n        {\n            \"R_pre\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.1e-3, 1.1e-3, 1.5e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"R_post\": np.array([1.5e-3, 1.5e-3, 1.5e-3, 1.9e-3, 1.9e-3, 1.5e-3, 1.5e-3, 1.5e-3, 1.5e-3]),\n            \"Q\": np.array([1.5e-6, 1.2e-6, 9.0e-7, 5.0e-7, -3.0e-7, -1.0e-7]),\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        R_pre = case[\"R_pre\"]\n        R_post = case[\"R_post\"]\n        Q = case[\"Q\"]\n\n        # Calculate OSI\n        # OSI = 0.5 * (1 - |sum(Q_k)| / sum(|Q_k|))\n        # OSI is independent of radius, so it's the same for pre/post and all locations.\n        sum_Q = np.sum(Q)\n        sum_abs_Q = np.sum(np.abs(Q))\n        # Avoid division by zero if all Q values are zero\n        if sum_abs_Q == 0:\n            osi = 0.0\n        else:\n            osi = 0.5 * (1 - np.abs(sum_Q) / sum_abs_Q)\n        \n        # Since OSI_pre = OSI_post, delta_OSI is 0 for all locations.\n        avg_dOSI = 0.0\n\n        # Calculate TAWSS\n        # TAWSS = (4 * mu / (pi * N * R^3)) * sum(|Q_k|)\n        tawss_constant_factor = (4 * mu / (np.pi * N)) * sum_abs_Q\n        \n        tawss_pre = tawss_constant_factor / (R_pre**3)\n        tawss_post = tawss_constant_factor / (R_post**3)\n\n        # Calculate delta TAWSS and its segment average\n        delta_tawss = tawss_post - tawss_pre\n        avg_dTAWSS = np.mean(delta_tawss)\n\n        # Predict regions at risk for restenosis\n        # Criterion: TAWSS_post  tau_low AND OSI_post  osi_high\n        at_risk_indices = []\n        if osi > osi_high:\n            for i in range(len(tawss_post)):\n                if tawss_post[i]  tau_low:\n                    at_risk_indices.append(i)\n        \n        # Format results for the current test case\n        # Round floats to 6 decimal places\n        case_result = [\n            round(avg_dTAWSS, 6),\n            round(avg_dOSI, 6),\n            at_risk_indices\n        ]\n        all_results.append(case_result)\n\n    # Format the final output string to exactly match the requirements.\n    # Convert the list of lists to string and remove all spaces.\n    final_output_str = str(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}