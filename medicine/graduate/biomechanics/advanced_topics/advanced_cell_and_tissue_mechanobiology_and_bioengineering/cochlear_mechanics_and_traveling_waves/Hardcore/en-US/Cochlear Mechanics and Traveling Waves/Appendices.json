{
    "hands_on_practices": [
        {
            "introduction": "To understand how sound energy propagates as a wave through the cochlea, we must first characterize the mechanical properties of the structure guiding it: the basilar membrane (BM). This exercise guides you through a foundational derivation, translating a physical, structural model of the BM—represented as an elastic plate with mass, stiffness, and damping—into its equivalent mechanical impedance, $Z_{\\mathrm{BM}}$. By applying the Wentzel–Kramers–Brillouin (WKB) approximation, a standard tool for wave propagation in slowly varying media, you will see how these physical parameters dictate the local opposition to motion at a given frequency, a crucial first step in modeling the traveling wave.",
            "id": "4164654",
            "problem": "In cochlear mechanics, the Basilar Membrane (BM) is often modeled as a thin elastic structure supporting longitudinally varying traveling waves. Consider the BM modeled as an inhomogeneous one-dimensional plate (equivalently, an Euler–Bernoulli beam with negligible width variation) with longitudinal bending rigidity, distributed inertia, and viscous resistance. Let the transverse displacement be $w(x,t)$, the across-membrane pressure (force per unit area) be $p(x,t)$, and assume linear, small-amplitude motion. The governing structural balance is the standard flexural plate relation along the longitudinal coordinate $x$,\n$$\np(x,t) \\;=\\; D(x)\\,\\frac{\\partial^{4} w}{\\partial x^{4}}(x,t) \\;+\\; R(x)\\,\\frac{\\partial w}{\\partial t}(x,t) \\;+\\; m(x)\\,\\frac{\\partial^{2} w}{\\partial t^{2}}(x,t),\n$$\nwhere $D(x)$ is the bending rigidity per unit width, $R(x)$ is the viscous resistance per unit area, and $m(x)$ is the distributed mass per unit area. Assume a monochromatic, slowly varying traveling wave of the form\n$$\nw(x,t) \\;=\\; \\Re\\!\\left\\{ W(x)\\,\\exp\\!\\Big(i\\omega t - i\\!\\int^{x} k(\\xi)\\,d\\xi\\Big)\\right\\},\n$$\nwith angular frequency $\\omega$, local wavenumber $k(x)$, and amplitude $W(x)$ that varies slowly compared to the wavelength. Under the leading-order Wentzel–Kramers–Brillouin (WKB) approximation, the spatial derivatives satisfy $\\frac{\\partial^{4} w}{\\partial x^{4}} \\approx k(x)^{4} w$. Define the effective longitudinal stiffness gradient per unit area\n$$\nK(x) \\;\\equiv\\; D(x)\\,k(x)^{4}.\n$$\nLet the Basilar Membrane mechanical impedance $Z_{\\mathrm{BM}}(x,\\omega)$ be defined as the complex ratio of the local across-membrane pressure amplitude to the local transverse velocity amplitude,\n$$\nZ_{\\mathrm{BM}}(x,\\omega) \\;\\equiv\\; \\frac{\\hat{p}(x)}{\\hat{v}(x)},\n$$\nwith $\\hat{p}(x)$ and $\\hat{v}(x)$ denoting the complex amplitudes of $p(x,t)$ and $v(x,t)=\\frac{\\partial w}{\\partial t}(x,t)$, respectively. Starting only from these definitions and the stated structural balance, derive an explicit expression for $Z_{\\mathrm{BM}}(x,\\omega)$ in terms of $K(x)$, $m(x)$, $R(x)$, and $\\omega$ under the leading-order WKB assumption. Your final answer must be a single closed-form analytic expression. No numerical approximation is required, and no rounding instruction applies. If you introduce any auxiliary quantities, eliminate them so that the final expression is exclusively in terms of $K(x)$, $m(x)$, $R(x)$, and $\\omega$.",
            "solution": "The user wants to derive the mechanical impedance of the Basilar Membrane (BM), denoted as $Z_{\\mathrm{BM}}(x,\\omega)$, based on a one-dimensional structural model.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n*   **Governing Equation:** The structural balance relating across-membrane pressure $p(x,t)$ to transverse displacement $w(x,t)$ is\n    $$p(x,t) \\;=\\; D(x)\\,\\frac{\\partial^{4} w}{\\partial x^{4}}(x,t) \\;+\\; R(x)\\,\\frac{\\partial w}{\\partial t}(x,t) \\;+\\; m(x)\\,\\frac{\\partial^{2} w}{\\partial t^{2}}(x,t)$$\n    where $D(x)$ is bending rigidity, $R(x)$ is viscous resistance, and $m(x)$ is mass per unit area.\n*   **Wave Form:** The displacement is a monochromatic, slowly varying traveling wave:\n    $$w(x,t) \\;=\\; \\Re\\!\\left\\{ W(x)\\,\\exp\\!\\Big(i\\omega t - i\\!\\int^{x} k(\\xi)\\,d\\xi\\Big)\\right\\}$$\n    with angular frequency $\\omega$, local wavenumber $k(x)$, and slow-varying amplitude $W(x)$.\n*   **WKB Approximation:** For the fourth spatial derivative, the leading-order WKB approximation is given as:\n    $$\\frac{\\partial^{4} w}{\\partial x^{4}} \\approx k(x)^{4} w$$\n*   **Effective Stiffness:** The effective longitudinal stiffness gradient per unit area is defined as:\n    $$K(x) \\;\\equiv\\; D(x)\\,k(x)^{4}$$\n*   **Impedance Definition:** The Basilar Membrane mechanical impedance is the ratio of complex pressure amplitude to complex velocity amplitude:\n    $$Z_{\\mathrm{BM}}(x,\\omega) \\;\\equiv\\; \\frac{\\hat{p}(x)}{\\hat{v}(x)}$$\n    where $p(x,t) = \\Re\\{\\hat{p}(x)\\exp(i\\omega t)\\}$ and the velocity is $v(x,t) = \\frac{\\partial w}{\\partial t}(x,t) = \\Re\\{\\hat{v}(x)\\exp(i\\omega t)\\}$.\n\n**1.2. Validate Using Extracted Givens**\n\n*   **Scientific Grounding:** The model is a standard and well-established simplification (Euler-Bernoulli beam) used in cochlear biomechanics. The concepts of mechanical impedance, mass, resistance, and stiffness are fundamental principles of mechanics. The Wentzel–Kramers–Brillouin (WKB) approximation is a standard and appropriate mathematical technique for analyzing wave propagation in slowly varying media. The problem is scientifically sound.\n*   **Well-Posedness:** The problem asks for the derivation of a specific physical quantity ($Z_{\\mathrm{BM}}$) from a given set of definitions and a physical model under a specified approximation. The inputs are sufficient and consistent, leading to a unique, well-defined solution.\n*   **Objectivity:** The problem is stated in precise, formal, and unbiased scientific language.\n\n**1.3. Verdict and Action**\n\nThe problem is scientifically grounded, well-posed, objective, and contains no identifiable flaws. It is **valid**. We proceed to the solution.\n\n### Step 2: Solution Derivation\n\nThe goal is to derive an expression for the mechanical impedance $Z_{\\mathrm{BM}}(x,\\omega) = \\frac{\\hat{p}(x)}{\\hat{v}(x)}$. To do this, we will work with complex amplitudes for all time-harmonic quantities. All operators in the governing equation are linear, so we can replace the real-valued equation with its complex counterpart.\n\nLet the complex displacement be represented as:\n$$w_c(x,t) = \\hat{w}(x)\\exp(i\\omega t)$$\nwhere the complex amplitude is $\\hat{w}(x) = W(x)\\exp(-i\\int^x k(\\xi)d\\xi)$. The physical displacement is $w(x,t) = \\Re\\{w_c(x,t)\\}$.\n\nFirst, we find the complex amplitude of the transverse velocity, $\\hat{v}(x)$. The velocity is the time derivative of the displacement: $v(x,t) = \\frac{\\partial w}{\\partial t}$. The complex velocity is:\n$$v_c(x,t) = \\frac{\\partial w_c}{\\partial t} = \\frac{\\partial}{\\partial t}\\left(\\hat{w}(x)\\exp(i\\omega t)\\right) = i\\omega \\hat{w}(x)\\exp(i\\omega t)$$\nBy definition, $v_c(x,t) = \\hat{v}(x)\\exp(i\\omega t)$. Comparing these two expressions gives the complex velocity amplitude:\n$$\\hat{v}(x) = i\\omega \\hat{w}(x)$$\n\nNext, we express the complex pressure amplitude, $\\hat{p}(x)$, in terms of the complex displacement amplitude, $\\hat{w}(x)$, using the governing equation. Let the complex pressure be $p_c(x,t) = \\hat{p}(x)\\exp(i\\omega t)$. The complex form of the governing equation is:\n$$p_c(x,t) = D(x)\\frac{\\partial^{4} w_c}{\\partial x^{4}} + R(x)\\frac{\\partial w_c}{\\partial t} + m(x)\\frac{\\partial^{2} w_c}{\\partial t^{2}}$$\nWe evaluate each term on the right-hand side.\nThe time derivatives are:\n$$\\frac{\\partial w_c}{\\partial t} = i\\omega w_c(x,t)$$\n$$\\frac{\\partial^{2} w_c}{\\partial t^{2}} = (i\\omega)^2 w_c(x,t) = -\\omega^2 w_c(x,t)$$\nThe spatial derivative is handled by the WKB approximation. As given, $\\frac{\\partial^{4} w}{\\partial x^{4}} \\approx k(x)^{4} w$. Since this approximation arises from the dominance of the rapidly varying phase term, which is present in both $w(x,t)$ and $w_c(x,t)$, it applies to the complex form as well:\n$$\\frac{\\partial^{4} w_c}{\\partial x^{4}} \\approx k(x)^{4} w_c(x,t)$$\nSubstituting these into the complex governing equation:\n$$\\hat{p}(x)\\exp(i\\omega t) = D(x)\\left(k(x)^{4} w_c\\right) + R(x)\\left(i\\omega w_c\\right) + m(x)\\left(-\\omega^2 w_c\\right)$$\nSubstitute $w_c(x,t) = \\hat{w}(x)\\exp(i\\omega t)$:\n$$\\hat{p}(x)\\exp(i\\omega t) = \\left[D(x)k(x)^{4} + i\\omega R(x) - \\omega^2 m(x)\\right]\\hat{w}(x)\\exp(i\\omega t)$$\nDividing both sides by $\\exp(i\\omega t)$ yields the relationship between the complex amplitudes:\n$$\\hat{p}(x) = \\left[D(x)k(x)^{4} - m(x)\\omega^2 + i\\omega R(x)\\right]\\hat{w}(x)$$\nNow, we use the definition of the effective stiffness, $K(x) = D(x)k(x)^{4}$:\n$$\\hat{p}(x) = \\left[K(x) - m(x)\\omega^2 + i\\omega R(x)\\right]\\hat{w}(x)$$\nWe now have expressions for both $\\hat{p}(x)$ and $\\hat{v}(x)$ in terms of $\\hat{w}(x)$. We can compute the impedance $Z_{\\mathrm{BM}}(x,\\omega)$ by taking their ratio:\n$$Z_{\\mathrm{BM}}(x,\\omega) = \\frac{\\hat{p}(x)}{\\hat{v}(x)} = \\frac{\\left[K(x) - m(x)\\omega^2 + i\\omega R(x)\\right]\\hat{w}(x)}{i\\omega \\hat{w}(x)}$$\nThe complex displacement amplitude $\\hat{w}(x)$ cancels out:\n$$Z_{\\mathrm{BM}}(x,\\omega) = \\frac{K(x) - m(x)\\omega^2 + i\\omega R(x)}{i\\omega}$$\nTo simplify this expression, we separate the terms:\n$$Z_{\\mathrm{BM}}(x,\\omega) = \\frac{i\\omega R(x)}{i\\omega} + \\frac{K(x) - m(x)\\omega^2}{i\\omega}$$\n$$Z_{\\mathrm{BM}}(x,\\omega) = R(x) + \\frac{1}{i}\\left(\\frac{K(x)}{\\omega} - m(x)\\omega\\right)$$\nUsing the identity $\\frac{1}{i} = -i$:\n$$Z_{\\mathrm{BM}}(x,\\omega) = R(x) - i\\left(\\frac{K(x)}{\\omega} - m(x)\\omega\\right)$$\nFinally, rearranging the terms inside the parentheses to present the impedance in the standard form (Real Part + $i \\times$ Imaginary Part):\n$$Z_{\\mathrm{BM}}(x,\\omega) = R(x) + i\\left(m(x)\\omega - \\frac{K(x)}{\\omega}\\right)$$\nThis expression represents the mechanical impedance of the Basilar Membrane model, with a resistive part $R(x)$ and a reactive part composed of a mass-like term $m(x)\\omega$ and a stiffness-like term $-K(x)/\\omega$. The expression is in terms of the required variables $K(x)$, $m(x)$, $R(x)$, and $\\omega$.",
            "answer": "$$\n\\boxed{R(x) + i\\left(m(x)\\omega - \\frac{K(x)}{\\omega}\\right)}\n$$"
        },
        {
            "introduction": "The standard WKB approximation, while powerful for describing the traveling wave along much of the cochlea, breaks down at the most critical location: the characteristic place, or \"turning point,\" where the wave's energy is absorbed. This exercise delves into the sophisticated mathematics required to accurately describe the wave's behavior in this region. By employing matched asymptotics and the Airy function to bridge the oscillatory and evanescent regions, you will derive the famous $\\pi/4$ phase shift, a fundamental result that explains the phase characteristics of the cochlear response near its peak.",
            "id": "4164741",
            "problem": "Consider a canonical long-wave one-dimensional model of cochlear traveling waves along the basilar membrane, in which the complex displacement amplitude $y(x)$ along the longitudinal coordinate $x$ satisfies a second-order ordinary differential equation of the form\n$$\n\\frac{d^{2}y}{dx^{2}} + k^{2}(x)\\,y = 0,\n$$\nwhere $k(x)$ is the local wavenumber determined by the fluid-structure interaction and the longitudinal variation of mechanical impedance. Assume that the medium varies slowly compared to the local wavelength except near a characteristic place $x=x_{t}$ where the tuning condition $k(x_{t})=0$ is met. In a small neighborhood of $x_{t}$, suppose the squared wavenumber is well approximated by a linear profile,\n$$\nk^{2}(x) = \\alpha\\,(x_{t}-x),\n$$\nwith constant $\\alpha>0$. The wave approaches from the basal side ($x<x_{t}$) where $k^{2}(x)>0$ (oscillatory region) and must decay apically ($x>x_{t}$) where $k^{2}(x)<0$ (evanescent region).\n\nStarting from fundamental balance laws (linear momentum and mass conservation) in the long-wave regime to justify the above reduced description, analyze the breakdown of the Wentzel–Kramers–Brillouin (WKB) approximation as $k(x)\\to 0$ near $x_{t}$, and construct a uniformly valid matched asymptotic solution by rescaling the equation to the Airy form within the critical-layer region. Impose the physically realistic condition that the solution decays for $x>x_{t}$ and match this Airy-region solution to the basal-side oscillatory WKB solution for $x<x_{t}$.\n\nDetermine the additive phase offset that must be included in the oscillatory WKB solution on the basal side in order to match smoothly to the decaying apical solution across the turning point. Express your final phase offset exactly in radians. No rounding is required, but the angle unit must be radians.",
            "solution": "The user-provided problem is rigorously self-contained and scientifically grounded in the field of biomechanics, specifically the mathematical modeling of cochlear mechanics. It presents a classic turning-point problem for a second-order ordinary differential equation, which is a standard topic in mathematical physics and asymptotic analysis. The given parameters, conditions, and objectives are precise, consistent, and well-posed, allowing for a unique and meaningful solution. The problem is therefore deemed valid.\n\nThe problem asks for the phase offset in the Wentzel–Kramers–Brillouin (WKB) solution for a cochlear traveling wave model, which is determined by matching it across a turning point to a decaying solution.\n\nThe governing equation for the complex displacement amplitude $y(x)$ is given as:\n$$\n\\frac{d^{2}y}{dx^{2}} + k^{2}(x)y = 0\n$$\nThis is a Helmholtz-type equation. In the context of cochlear mechanics, it arises from combining the linearized, incompressible, and inviscid fluid-dynamic equations (in the long-wave limit) with the equation of motion for the basilar membrane, which is treated as a locally-reacting structure with varying impedance. The term $k(x)$ is the local wavenumber, which depends on the driving frequency $\\omega$ and the mechanical properties of the basilar membrane (mass, stiffness, and damping) that vary along its length $x$. The characteristic place $x_t$ where $k(x_t)=0$ is the location where the membrane is tuned to the specific frequency $\\omega$.\n\nFor $x < x_t$ (basal side), the problem states $k^2(x) > 0$, leading to oscillatory solutions. For $x > x_t$ (apical side), $k^2(x) < 0$, leading to evanescent (decaying) solutions. The WKB approximation provides an approximate solution in regions where $k(x)$ varies slowly. The general WKB solution form is:\n$$\ny_{WKB}(x) \\approx \\frac{C_{\\pm}}{\\sqrt{k(x)}} \\exp\\left(\\pm i \\int^x k(x') dx'\\right)\n$$\nThis approximation is valid when $|k'(x)| \\ll |k^2(x)|$. Near the turning point $x_t$, we are given the linear approximation $k^2(x) = \\alpha(x_t - x)$ with $\\alpha > 0$. For $x < x_t$, $k(x) = \\sqrt{\\alpha(x_t - x)}$. The derivative is $k'(x) = -\\frac{\\sqrt{\\alpha}}{2\\sqrt{x_t - x}}$. The validity condition becomes:\n$$\n\\left| -\\frac{\\sqrt{\\alpha}}{2\\sqrt{x_t - x}} \\right| \\ll |\\alpha(x_t - x)| \\implies \\frac{1}{2\\alpha} \\ll |x_t - x|^{3/2}\n$$\nAs $x \\to x_t$, the right-hand side approaches $0$, and the inequality is violated. The WKB approximation thus breaks down in the vicinity of the turning point.\n\nTo find a solution valid across the turning point, we analyze the region around $x_t$ (the \"inner region\") where the linearized form of $k^2(x)$ holds. The governing equation becomes:\n$$\n\\frac{d^{2}y}{dx^{2}} + \\alpha(x_t - x)y = 0\n$$\nWe rescale the independent variable to transform this into a standard form. Let's define a new variable $z$. The standard Airy equation is $f''(z) - zf(z) = 0$. We set $z = c(x-x_t)$. The derivatives transform as $\\frac{d}{dx} = c\\frac{d}{dz}$ and $\\frac{d^2}{dx^2} = c^2\\frac{d^2}{dz^2}$. Substituting into the equation:\n$$\nc^2 \\frac{d^2y}{dz^2} + \\alpha(x_t - (z/c + x_t))y = 0\n$$\n$$\nc^2 \\frac{d^2y}{dz^2} - \\frac{\\alpha}{c} z y = 0\n$$\n$$\n\\frac{d^2y}{dz^2} - \\frac{\\alpha}{c^3} z y = 0\n$$\nTo match the Airy equation, we set $\\frac{\\alpha}{c^3} = 1$, which gives $c = \\alpha^{1/3}$. The appropriate scaling is $z = \\alpha^{1/3}(x-x_t)$. The equation in the inner region is the Airy equation:\n$$\n\\frac{d^2y}{dz^2} - z y = 0\n$$\nThe general solution is a linear combination of the Airy functions of the first and second kind, $\\text{Ai}(z)$ and $\\text{Bi}(z)$:\n$$\ny_{inner}(z) = C_1 \\text{Ai}(z) + C_2 \\text{Bi}(z)\n$$\nThe problem specifies that the solution must decay for $x > x_t$. This corresponds to the region where $z > 0$. The asymptotic behaviors for $z \\to \\infty$ are:\n$$\n\\text{Ai}(z) \\sim \\frac{1}{2\\sqrt{\\pi}z^{1/4}} \\exp\\left(-\\frac{2}{3}z^{3/2}\\right) \\quad (\\text{decaying})\n$$\n$$\n\\text{Bi}(z) \\sim \\frac{1}{\\sqrt{\\pi}z^{1/4}} \\exp\\left(+\\frac{2}{3}z^{3/2}\\right) \\quad (\\text{growing})\n$$\nTo satisfy the physical condition of a decaying wave on the apical side, we must set $C_2 = 0$. The physically relevant inner solution is therefore:\n$$\ny_{inner}(x) = C_1 \\text{Ai}\\left(\\alpha^{1/3}(x-x_t)\\right)\n$$\nTo find the phase shift, we match this inner solution to the outer WKB solution in the oscillatory region $x < x_t$. This requires finding the asymptotic form of $y_{inner}$ for $x < x_t$, which corresponds to $z \\to -\\infty$. The asymptotic behavior of $\\text{Ai}(z)$ for $z < 0$ is:\n$$\n\\text{Ai}(z) \\sim \\frac{1}{\\sqrt{\\pi}(-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right)\n$$\nLet's substitute back our scaled variable $z = \\alpha^{1/3}(x-x_t)$. For $x < x_t$, we have $-z = \\alpha^{1/3}(x_t-x)$.\nThe term in the amplitude is:\n$$\n(-z)^{1/4} = \\left(\\alpha^{1/3}(x_t-x)\\right)^{1/4} = \\alpha^{1/12}(x_t-x)^{1/4}\n$$\nThe argument of the sine function contains the term:\n$$\n\\frac{2}{3}(-z)^{3/2} = \\frac{2}{3}\\left(\\alpha^{1/3}(x_t-x)\\right)^{3/2} = \\frac{2}{3}\\alpha^{1/2}(x_t-x)^{3/2}\n$$\nThis term is precisely the WKB phase integral from $x$ to the turning point $x_t$:\n$$\n\\int_x^{x_t} k(x') dx' = \\int_x^{x_t} \\sqrt{\\alpha(x_t-x')} dx' = \\left[-\\frac{2}{3}\\alpha^{1/2}(x_t-x')^{3/2}\\right]_x^{x_t} = \\frac{2}{3}\\alpha^{1/2}(x_t-x)^{3/2}\n$$\nSo, the asymptotic form of the inner solution for $x < x_t$ is:\n$$\ny_{inner}(x) \\sim \\frac{C_1}{\\sqrt{\\pi}\\alpha^{1/12}(x_t-x)^{1/4}} \\sin\\left(\\int_x^{x_t} k(x') dx' + \\frac{\\pi}{4}\\right)\n$$\nThe oscillatory WKB solution (the \"outer\" solution for $x<x_t$) is a standing wave, which can be written in the general form:\n$$\ny_{outer}(x) = \\frac{D}{\\sqrt{k(x)}} \\sin\\left(\\int_x^{x_t} k(x') dx' + \\phi_0\\right)\n$$\nwhere $D$ is an amplitude constant and $\\phi_0$ is the unknown phase offset. Note that $\\sqrt{k(x)} = (\\alpha(x_t-x))^{1/4} = \\alpha^{1/4}(x_t-x)^{1/4}$.\nBy matching the asymptotic form of the inner solution with the outer WKB solution, we compare the two expressions. The dependence on $x$ in the amplitude prefactors, $(x_t-x)^{-1/4}$, matches. For the entire expressions to be identical in the overlapping region of validity, their phase arguments must also be identical.\nComparing the arguments of the sine functions:\n$$\n\\int_x^{x_t} k(x') dx' + \\phi_0 = \\int_x^{x_t} k(x') dx' + \\frac{\\pi}{4}\n$$\nThis directly yields the value of the phase offset:\n$$\n\\phi_0 = \\frac{\\pi}{4}\n$$\nThis is the celebrated phase loss of $\\pi/4$ for a standing wave constructed from a reference point at the turning point. This represents the phase shift introduced into the oscillatory solution due to the reflection at a linear turning point, required to connect to a purely decaying wave beyond it. The total phase loss upon reflection (comparing incident and reflected traveling waves) is $\\pi/2$. The phase offset in the standing wave representation is half of that, $\\pi/4$.\nThe question asks for the additive phase offset in the oscillatory WKB solution, which, based on the matching procedure, is $\\frac{\\pi}{4}$ radians.",
            "answer": "$$\\boxed{\\frac{\\pi}{4}}$$"
        },
        {
            "introduction": "This practice transitions from analytical theory to a computational laboratory, allowing you to build and probe a dynamic model of the cochlea. You will implement a discrete one-dimensional model to simulate the basilar membrane's response and observe the formation of a traveling wave peak. The primary goal is to perform a sensitivity analysis—a cornerstone of modern modeling—to quantify how the wave's key features, such as its peak amplitude and location, are affected by changes in stiffness, damping, and the active gain provided by outer hair cells (). This hands-on simulation provides direct insight into how the cochlea achieves its remarkable frequency selectivity and sensitivity.",
            "id": "4164711",
            "problem": "Consider a one-dimensional, linearized, frequency-domain model of basilar membrane mechanics with longitudinal coupling that captures traveling-wave behavior along the cochlear partition. The goal is to perform a local sensitivity analysis of spatial stiffness $K(x)$, spatial damping $R(x)$, and Outer Hair Cell (OHC) gain, and to quantify how these parameters affect observable outputs related to the traveling wave. The analysis must be conducted in purely mathematical terms, using reproducible computations that a program can implement without external data.\n\nUse the following context-appropriate fundamental base and modeling assumptions:\n\n- The basilar membrane (BM) is represented as a chain of $N$ lumped segments indexed by $i=0,1,\\dots,N-1$ with spatial coordinate $x_i \\in [0,L]$, where $x_0=0$ denotes the base and $x_{N-1}=L$ the apex. Each segment obeys Newton’s Second Law: the sum of forces equals mass times acceleration.\n- Under time-harmonic stimulation at angular frequency $\\omega$, assume displacement $u_i(t) = \\Re\\{U_i e^{i\\omega t}\\}$, where $U_i$ is complex. The equation of motion for segment $i$ is derived from the balance of forces: local stiffness, local damping, inertial force, and longitudinal coupling to nearest neighbors. In the frequency domain, this yields a linear system of the form\n$$\n\\left(-m_i \\omega^2 + i\\omega r_i + k_i\\right)U_i - c\\left(U_{i+1}-2U_i+U_{i-1}\\right) = F_i,\n$$\nwith appropriate modifications at boundaries.\n- The longitudinal coupling is modeled by a discrete Laplacian with coupling coefficient $c$, resulting in a tridiagonal system. At the base ($i=0$) and apex ($i=N-1$) boundaries, use one-sided coupling consistent with the discrete Laplacian.\n\nDefine the spatial parameter fields and active gain:\n\n- Let the cochlear length be $L=0.035\\,\\mathrm{m}$ and the number of segments be $N=200$. Let the segment masses be $m_i = m_0$ with $m_0 = 2.0\\times 10^{-6}\\,\\mathrm{kg}$.\n- Model stiffness as $k(x) = s_K K_0 e^{-\\alpha x}$, where $K_0 = 2.0\\times 10^{3}\\,\\mathrm{N/m}$ and $\\alpha = 150\\,\\mathrm{m}^{-1}$. The scalar $s_K$ is a stiffness scaling factor for sensitivity analysis.\n- Model damping as $r(x) = s_R R_0 e^{\\beta x}$, where $R_0 = 0.15\\,\\mathrm{N\\cdot s/m}$ and $\\beta = 40\\,\\mathrm{m}^{-1}$. The scalar $s_R$ is a damping scaling factor for sensitivity analysis.\n- Model OHC active gain by reducing effective damping uniformly: $r_{\\mathrm{eff}}(x) = r(x)\\left(1 - G\\right)$, where $G \\in [0,1)$ is a dimensionless gain factor. Higher $G$ reduces effective damping (i.e., implements negative damping), but $G$ must remain strictly less than $1$ for stability.\n- Use longitudinal coupling $c = 1.0\\times 10^{3}\\,\\mathrm{N/m}$.\n- The driving force is applied at the base ($i=0$) with $F_0 = 1.0\\,\\mathrm{N}$, and $F_i=0$ for $i>0$.\n\nFor each test case, compute the steady-state complex displacement vector $\\mathbf{U} \\in \\mathbb{C}^N$ by solving the resulting tridiagonal linear system. From $\\mathbf{U}$, define the following observable outputs:\n\n1. The peak amplitude along the partition:\n$$\nA_{\\max} = \\max_{i} |U_i|, \\quad \\text{with units in } \\mathrm{m}.\n$$\n\n2. The spatial location of peak amplitude:\n$$\nx_{\\max} = x_{i^\\ast}, \\quad i^\\ast = \\underset{i}{\\arg\\max}\\,|U_i|, \\quad \\text{with units in } \\mathrm{m}.\n$$\n\n3. The local phase slope (spatial derivative of phase) at the peak location:\n$$\nS_\\phi = \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=x_{\\max}}, \\quad \\phi(x_i) = \\mathrm{unwrap}\\left(\\arg(U_i)\\right), \\quad \\text{with units in } \\mathrm{rad/m}.\n$$\nUse a central finite difference for $S_\\phi$ when $i^\\ast \\in \\{1,2,\\dots,N-2\\}$ and one-sided differences at boundaries.\n\nPerform a local (infinitesimal) sensitivity analysis of these observables with respect to the scalars $s_K$, $s_R$, and $G$ using a symmetric fractional perturbation of magnitude $\\varepsilon$ applied multiplicatively to each scalar parameter, holding all other parameters fixed. For an observable $O \\in \\{A_{\\max}, x_{\\max}, S_\\phi\\}$ and parameter $p \\in \\{s_K, s_R, G\\}$, estimate the dimensionless log-sensitivity:\n$$\nS_{p}(O) \\approx \\frac{O\\left(p(1+\\varepsilon)\\right) - O\\left(p(1-\\varepsilon)\\right)}{2\\,\\varepsilon\\,O(p)},\n$$\nwhere $O(p)$ denotes the baseline observable evaluated at the unperturbed parameter $p$. If $O(p)=0$, define $S_{p}(O)=0$ to avoid division by zero. Use $\\varepsilon = 0.05$.\n\nScientific realism requirements:\n\n- All quantities must be treated with consistent physical units. In particular, $A_{\\max}$ must be computed and internally represented in $\\mathrm{m}$, $x_{\\max}$ in $\\mathrm{m}$, and $S_\\phi$ in $\\mathrm{rad/m}$. The final reported sensitivity indices $S_{p}(O)$ are dimensionless (unitless).\n- Angles must be computed in radians.\n\nTest suite:\n\nEvaluate the sensitivity indices for the following three test cases, which probe different aspects of the system:\n\n- Case $1$: Frequency $f=2000\\,\\mathrm{Hz}$, baseline stiffness scaling $s_K=1.0$, baseline damping scaling $s_R=1.0$, OHC gain $G=0.3$.\n- Case $2$: Frequency $f=1000\\,\\mathrm{Hz}$, baseline stiffness scaling $s_K=1.0$, increased damping scaling $s_R=1.2$, OHC gain $G=0.0$ (passive cochlea).\n- Case $3$: Frequency $f=4000\\,\\mathrm{Hz}$, reduced stiffness scaling $s_K=0.8$, baseline damping scaling $s_R=1.0$, high OHC gain $G=0.9$ (near-active edge, but stable since $G<1$).\n\nYour program must:\n\n- Construct and solve the linear system for each test case.\n- Compute $A_{\\max}$, $x_{\\max}$, and $S_\\phi$ at baseline and at the $\\pm \\varepsilon$ perturbations for each of the three parameters $s_K$, $s_R$, and $G$.\n- Return the nine sensitivity indices for each case in the fixed order:\n$$\n\\left[S_{s_K}(A_{\\max}),\\,S_{s_R}(A_{\\max}),\\,S_{G}(A_{\\max}),\\,S_{s_K}(x_{\\max}),\\,S_{s_R}(x_{\\max}),\\,S_{G}(x_{\\max}),\\,S_{s_K}(S_\\phi),\\,S_{s_R}(S_\\phi),\\,S_{G}(S_\\phi)\\right].\n$$\n\nFinal output format:\n\nYour program should produce a single line of output containing the results for all three cases as a comma-separated list of lists, enclosed in square brackets. For example:\n$[\\,[\\text{case1\\_s1},\\dots,\\text{case1\\_s9}],\\,[\\text{case2\\_s1},\\dots,\\text{case2\\_s9}],\\,[\\text{case3\\_s1},\\dots,\\text{case3\\_s9}]\\,]$.\nAll printed values must be plain numbers (booleans, integers, floats, or lists of these) without units or additional text.",
            "solution": "The problem requires a local sensitivity analysis of a one-dimensional, linearized model of basilar membrane (BM) mechanics. The analysis is founded upon a discrete representation of the cochlea as a chain of coupled harmonic oscillators. We first validate the problem statement and then proceed to a detailed solution.\n\n### Problem Validation\n\n**Step 1: Extracted Givens**\n- **Model:** 1D, linearized, frequency-domain model of BM mechanics.\n- **Discretization:** $N=200$ lumped segments indexed by $i=0, 1, \\dots, N-1$.\n- **Spatial Domain:** $x_i \\in [0, L]$ with length $L=0.035\\,\\mathrm{m}$.\n- **Equation of Motion (Frequency Domain):** For segment $i$, the complex displacement amplitude $U_i$ satisfies:\n$$\n\\left(-m_i \\omega^2 + i\\omega r_i + k_i\\right)U_i - c\\left(U_{i+1}-2U_i+U_{i-1}\\right) = F_i\n$$\n- **Boundary Conditions:** One-sided coupling at $i=0$ and $i=N-1$.\n- **Model Parameters:**\n    - Mass: $m_i = m_0 = 2.0\\times 10^{-6}\\,\\mathrm{kg}$.\n    - Stiffness: $k(x) = s_K K_0 e^{-\\alpha x}$, with $K_0 = 2.0\\times 10^{3}\\,\\mathrm{N/m}$ and $\\alpha = 150\\,\\mathrm{m}^{-1}$.\n    - Damping: $r(x) = s_R R_0 e^{\\beta x}$, with $R_0 = 0.15\\,\\mathrm{N\\cdot s/m}$ and $\\beta = 40\\,\\mathrm{m}^{-1}$.\n    - Active Gain: Effective damping is $r_{\\mathrm{eff}}(x) = r(x)\\left(1 - G\\right)$, where $G \\in [0,1)$ is the gain factor.\n    - Coupling: $c = 1.0\\times 10^{3}\\,\\mathrm{N/m}$.\n    - Force: $F_0 = 1.0\\,\\mathrm{N}$; $F_i=0$ for $i > 0$.\n- **Observables:**\n    1. $A_{\\max} = \\max_{i} |U_i|$ (peak amplitude).\n    2. $x_{\\max} = x_{i^\\ast}$ where $i^\\ast = \\underset{i}{\\arg\\max}\\,|U_i|$ (peak location).\n    3. $S_\\phi = \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=x_{\\max}}$ with $\\phi(x_i) = \\mathrm{unwrap}\\left(\\arg(U_i)\\right)$ (phase slope at peak).\n- **Sensitivity Analysis:**\n    - Dimensionless log-sensitivity: $S_{p}(O) \\approx \\frac{O\\left(p(1+\\varepsilon)\\right) - O\\left(p(1-\\varepsilon)\\right)}{2\\,\\varepsilon\\,O(p)}$.\n    - Perturbation: $\\varepsilon = 0.05$.\n    - Parameters: $p \\in \\{s_K, s_R, G\\}$.\n    - Zero-observable case: If $O(p)=0$, then $S_{p}(O)=0$.\n- **Test Cases:**\n    1. $f=2000\\,\\mathrm{Hz}$, $s_K=1.0$, $s_R=1.0$, $G=0.3$.\n    2. $f=1000\\,\\mathrm{Hz}$, $s_K=1.0$, $s_R=1.2$, $G=0.0$.\n    3. $f=4000\\,\\mathrm{Hz}$, $s_K=0.8$, $s_R=1.0$, $G=0.9$.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding:** The model is a well-established simplified representation of cochlear mechanics. The governing equation is a direct application of Newton's second law for coupled oscillators. The exponential parameter gradients are standard biophysical approximations of the cochlea's tonotopic organization. The active process modeled as negative damping is a common and accepted phenomenological approach. All parameter values are physically realistic. The problem is scientifically grounded.\n- **Well-Posedness:** The problem translates to solving a system of linear equations $\\mathbf{A} \\mathbf{U} = \\mathbf{F}$, where $\\mathbf{A}$ is a tridiagonal matrix. The prescribed boundary conditions (\"one-sided coupling\") lead to a well-defined modification of the matrix at the boundaries. The resulting complex matrix is non-singular and diagonally dominant for the given parameter ranges (since $r_{\\mathrm{eff}} \\geq 0$), guaranteeing a unique solution for $\\mathbf{U}$. The observables and the sensitivity metric are mathematically well-defined. The problem is well-posed.\n- **Objectivity:** The problem is stated in precise, quantitative terms, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem statement is **valid**. It is self-contained, scientifically sound, and computationally tractable. A complete solution will now be developed.\n\n### Solution Derivation\n\nThe analysis proceeds in four main steps: 1) formalizing the linear system of equations, 2) solving for the complex displacement vector $\\mathbf{U}$, 3) calculating the specified observables from $\\mathbf{U}$, and 4) computing the sensitivities using numerical perturbation.\n\n**1. Linear System Formulation**\n\nThe cochlear partition is discretized into $N=200$ segments. The spatial coordinate for the $i$-th segment is $x_i = i \\cdot \\Delta x$, where $i \\in \\{0, 1, \\dots, N-1\\}$ and the segment spacing is $\\Delta x = L/(N-1)$. The stimulation frequency is $f$, so the angular frequency is $\\omega = 2\\pi f$.\n\nThe governing equation for an interior segment ($0 < i < N-1$) is:\n$$ \\left(-m_i \\omega^2 + i\\omega r_{\\mathrm{eff},i} + k_i\\right)U_i - c\\left(U_{i+1}-2U_i+U_{i-1}\\right) = F_i $$\nwhere $k_i = k(x_i)$, $r_{\\mathrm{eff},i} = r_{\\mathrm{eff}}(x_i)$, and $m_i = m_0$. Rearranging this equation collects terms for $U_{i-1}$, $U_i$, and $U_{i+1}$:\n$$ -c U_{i-1} + \\left(k_i - m_0 \\omega^2 + 2c + i\\omega r_{\\mathrm{eff},i}\\right)U_i - c U_{i+1} = F_i $$\nThis structure defines a tridiagonal linear system $\\mathbf{A}\\mathbf{U}=\\mathbf{F}$. The matrix $\\mathbf{A}$ has a main diagonal, an upper diagonal, and a lower diagonal.\n\nAt the boundaries, we apply one-sided coupling:\n- For the base ($i=0$): The coupling is only to segment $i=1$. The term $c(U_{i+1}-2U_i+U_{i-1})$ becomes $c(U_1 - U_0)$.\n$$ \\left(-m_0 \\omega^2 + i\\omega r_{\\mathrm{eff},0} + k_0\\right)U_0 - c\\left(U_1-U_0\\right) = F_0 $$\n$$ \\implies \\left(k_0 - m_0 \\omega^2 + c + i\\omega r_{\\mathrm{eff},0}\\right)U_0 - c U_1 = F_0 $$\n- For the apex ($i=N-1$): The coupling is only to segment $i=N-2$. The term $c(U_{i+1}-2U_i+U_{i-1})$ becomes $c(U_{N-2} - U_{N-1})$.\n$$ \\left(-m_{N-1} \\omega^2 + i\\omega r_{\\mathrm{eff},N-1} + k_{N-1}\\right)U_{N-1} - c\\left(U_{N-2}-U_{N-1}\\right) = F_{N-1} $$\n$$ \\implies -c U_{N-2} + \\left(k_{N-1} - m_0 \\omega^2 + c + i\\omega r_{\\mathrm{eff},N-1}\\right)U_{N-1} = 0 $$\nsince $F_{N-1}=0$.\n\nThe diagonals of the tridiagonal matrix $\\mathbf{A}$ are therefore:\n- Main diagonal ($d_i$):\n  - $d_0 = k_0 - m_0 \\omega^2 + c + i\\omega r_{\\mathrm{eff},0}$\n  - $d_i = k_i - m_0 \\omega^2 + 2c + i\\omega r_{\\mathrm{eff},i}$ for $i=1, \\dots, N-2$\n  - $d_{N-1} = k_{N-1} - m_0 \\omega^2 + c + i\\omega r_{\\mathrm{eff},N-1}$\n- Lower diagonal ($l_i$): $l_i = -c$ for $i=1, \\dots, N-1$.\n- Upper diagonal ($u_i$): $u_i = -c$ for $i=0, \\dots, N-2$.\n\nThe force vector $\\mathbf{F}$ is $[F_0, 0, \\dots, 0]^T$ with $F_0=1.0\\,\\mathrm{N}$.\n\n**2. Solving the System**\n\nThis $N \\times N$ complex-valued tridiagonal system is solved for the vector of complex displacements $\\mathbf{U} = [U_0, U_1, \\dots, U_{N-1}]^T$. Efficient algorithms, such as the Thomas algorithm (or a banded matrix solver from a scientific library like SciPy), can be used.\n\n**3. Computing Observables**\n\nOnce $\\mathbf{U}$ is obtained, the observables are calculated as follows:\n- **Peak Amplitude ($A_{\\max}$):** The maximum of the magnitudes of the complex displacements.\n$$ A_{\\max} = \\max_{i \\in \\{0, \\dots, N-1\\}} |U_i| $$\n- **Peak Location ($x_{\\max}$):** The spatial position corresponding to the peak amplitude.\n$$ i^\\ast = \\underset{i \\in \\{0, \\dots, N-1\\}}{\\arg\\max}\\, |U_i| \\quad \\implies \\quad x_{\\max} = x_{i^\\ast} = i^\\ast \\frac{L}{N-1} $$\n- **Phase Slope at Peak ($S_\\phi$):** First, the phase angle $\\arg(U_i)$ is computed for all $i$. The resulting phase vector is \"unwrapped\" to remove $2\\pi$ discontinuities, yielding a continuous phase profile $\\phi(x_i)$. The spatial derivative (slope) is then estimated at the peak location $x_{i^\\ast}$ using finite differences:\n  - If $0 < i^\\ast < N-1$ (central difference):\n    $$ S_\\phi = \\frac{\\phi(x_{i^\\ast+1}) - \\phi(x_{i^\\ast-1})}{2\\Delta x} $$\n  - If $i^\\ast = 0$ (forward difference):\n    $$ S_\\phi = \\frac{\\phi(x_1) - \\phi(x_0)}{\\Delta x} $$\n  - If $i^\\ast = N-1$ (backward difference):\n    $$ S_\\phi = \\frac{\\phi(x_{N-1}) - \\phi(x_{N-2})}{\\Delta x} $$\n\n**4. Sensitivity Analysis**\n\nFor each observable $O \\in \\{A_{\\max}, x_{\\max}, S_\\phi\\}$ and each parameter $p \\in \\{s_K, s_R, G\\}$, we compute the dimensionless log-sensitivity $S_p(O)$. This is done by calculating the observables for a baseline parameter set and for multiplicatively perturbed parameter sets. Let $O(p)$ be the observable at the baseline value of parameter $p$. Let $O(p(1+\\varepsilon))$ and $O(p(1-\\varepsilon))$ be the observables when $p$ is perturbed. The sensitivity is approximated by:\n$$ S_{p}(O) \\approx \\frac{O(p(1+\\varepsilon)) - O(p(1-\\varepsilon))}{2\\,\\varepsilon\\,O(p)} $$\nThe perturbation is $\\varepsilon = 0.05$. If the baseline observable $O(p)=0$, the sensitivity is defined as $S_p(O)=0$.\nA special case arises when a baseline parameter is zero, such as $G=0$ in Case 2. The multiplicative perturbation $p(1 \\pm \\varepsilon)$ becomes $0(1 \\pm \\varepsilon) = 0$. Consequently, the perturbed observables are identical to the baseline, the numerator of the sensitivity formula is zero, and the sensitivity $S_G(O)$ is correctly evaluated as $0$.\n\nThis procedure is repeated for each of the three parameters in each of the three test cases, yielding a total of $3 \\times 3 = 9$ sensitivity indices per case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the cochlear mechanics sensitivity analysis problem.\n    \"\"\"\n\n    # Define physical constants and model parameters\n    L = 0.035  # m, length of cochlea\n    N = 200  # number of segments\n    m0 = 2.0e-6  # kg, mass per segment\n    K0 = 2.0e3  # N/m, stiffness constant\n    alpha = 150.0  # 1/m, stiffness decay constant\n    R0 = 0.15  # N.s/m, damping constant\n    beta = 40.0  # 1/m, damping increase constant\n    c_coupling = 1.0e3  # N/m, longitudinal coupling\n    F0 = 1.0  # N, driving force at the base\n    epsilon = 0.05  # perturbation for sensitivity analysis\n\n    # Spatial grid\n    x_grid = np.linspace(0, L, N)\n    dx = L / (N - 1)\n\n    test_cases = [\n        # (f, sK, sR, G)\n        (2000.0, 1.0, 1.0, 0.3),  # Case 1\n        (1000.0, 1.0, 1.2, 0.0),  # Case 2\n        (4000.0, 0.8, 1.0, 0.9),  # Case 3\n    ]\n\n    def compute_observables(f, sK, sR, G):\n        \"\"\"\n        Computes observables for a given set of parameters.\n        \"\"\"\n        omega = 2.0 * np.pi * f\n\n        # Calculate position-dependent parameters\n        k = sK * K0 * np.exp(-alpha * x_grid)\n        r = sR * R0 * np.exp(beta * x_grid)\n        r_eff = r * (1.0 - G)\n\n        # Construct the tridiagonal matrix A in banded format for scipy\n        # A_banded has shape (3, N) for 1 upper and 1 lower diagonal\n        # Row 0: upper diagonal (shifted right by 1)\n        # Row 1: main diagonal\n        # Row 2: lower diagonal\n        A_banded = np.zeros((3, N), dtype=np.complex128)\n        \n        # Upper and lower diagonals\n        A_banded[0, 1:] = -c_coupling\n        A_banded[2, :-1] = -c_coupling\n\n        # Main diagonal\n        main_diag_real = k - m0 * omega**2\n        main_diag_imag = omega * r_eff\n        \n        # Interior points\n        d_interior = main_diag_real + 2 * c_coupling + 1j * main_diag_imag\n        A_banded[1, :] = d_interior\n        \n        # Boundary points\n        A_banded[1, 0] = main_diag_real[0] + c_coupling + 1j * main_diag_imag[0]\n        A_banded[1, -1] = main_diag_real[-1] + c_coupling + 1j * main_diag_imag[-1]\n\n        # Construct the force vector F\n        F = np.zeros(N, dtype=np.complex128)\n        F[0] = F0\n\n        # Solve the linear system A*U = F\n        U = solve_banded((1, 1), A_banded, F)\n\n        # Calculate observables\n        abs_U = np.abs(U)\n        \n        # 1. Peak amplitude\n        A_max = np.max(abs_U)\n\n        # 2. Location of peak amplitude\n        i_star = np.argmax(abs_U)\n        x_max = x_grid[i_star]\n\n        # 3. Phase slope at peak\n        phase = np.unwrap(np.angle(U))\n        if i_star == 0:\n            S_phi = (phase[1] - phase[0]) / dx\n        elif i_star == N - 1:\n            S_phi = (phase[N - 1] - phase[N - 2]) / dx\n        else:\n            S_phi = (phase[i_star + 1] - phase[i_star - 1]) / (2 * dx)\n            \n        return A_max, x_max, S_phi\n\n    all_results = []\n    for f_base, sK_base, sR_base, G_base in test_cases:\n        case_sensitivities = []\n        \n        # Baseline observable values\n        O_base = compute_observables(f_base, sK_base, sR_base, G_base)\n        A_max_base, x_max_base, S_phi_base = O_base\n\n        # Parameters for sensitivity analysis\n        params = [\n            {'name': 'sK', 'base': sK_base, 'pert': (f_base, sR_base, G_base)},\n            {'name': 'sR', 'base': sR_base, 'pert': (f_base, sK_base, G_base)},\n            {'name': 'G', 'base': G_base, 'pert': (f_base, sK_base, sR_base)},\n        ]\n        \n        sensitivities_for_observables = {\n            'A_max': [], 'x_max': [], 'S_phi': []\n        }\n\n        for p_info in params:\n            p_name = p_info['name']\n            p_base = p_info['base']\n\n            if p_base == 0:\n                # Multiplicative perturbation of 0 is still 0, so change is 0.\n                O_plus = O_base\n                O_minus = O_base\n            else:\n                p_plus = p_base * (1 + epsilon)\n                p_minus = p_base * (1 - epsilon)\n\n                if p_name == 'sK':\n                    O_plus = compute_observables(p_info['pert'][0], p_plus, p_info['pert'][1], p_info['pert'][2])\n                    O_minus = compute_observables(p_info['pert'][0], p_minus, p_info['pert'][1], p_info['pert'][2])\n                elif p_name == 'sR':\n                    O_plus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_plus, p_info['pert'][2])\n                    O_minus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_minus, p_info['pert'][2])\n                elif p_name == 'G':\n                    O_plus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_info['pert'][2], p_plus)\n                    O_minus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_info['pert'][2], p_minus)\n\n            A_max_plus, x_max_plus, S_phi_plus = O_plus\n            A_max_minus, x_max_minus, S_phi_minus = O_minus\n\n            # Calculate sensitivities for each observable\n            # S_p(O) = (O(p+) - O(p-)) / (2 * epsilon * O(p_base))\n            \n            # Sensitivity of A_max\n            if A_max_base == 0:\n                S_p_A_max = 0.0\n            else:\n                S_p_A_max = (A_max_plus - A_max_minus) / (2 * epsilon * A_max_base)\n            sensitivities_for_observables['A_max'].append(S_p_A_max)\n\n            # Sensitivity of x_max\n            if x_max_base == 0:\n                S_p_x_max = 0.0\n            else:\n                S_p_x_max = (x_max_plus - x_max_minus) / (2 * epsilon * x_max_base)\n            sensitivities_for_observables['x_max'].append(S_p_x_max)\n\n            # Sensitivity of S_phi\n            if S_phi_base == 0:\n                S_p_S_phi = 0.0\n            else:\n                S_p_S_phi = (S_phi_plus - S_phi_minus) / (2 * epsilon * S_phi_base)\n            sensitivities_for_observables['S_phi'].append(S_p_S_phi)\n        \n        # Assemble results in the specified order\n        case_sensitivities.extend(sensitivities_for_observables['A_max'])\n        case_sensitivities.extend(sensitivities_for_observables['x_max'])\n        case_sensitivities.extend(sensitivities_for_observables['S_phi'])\n\n        all_results.append(case_sensitivities)\n\n    # Format the final output string\n    def format_list(data):\n        return f\"[{','.join(f'{x:.8f}' for x in data)}]\"\n    \n    output_str = f\"[{','.join(format_list(case) for case in all_results)}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}