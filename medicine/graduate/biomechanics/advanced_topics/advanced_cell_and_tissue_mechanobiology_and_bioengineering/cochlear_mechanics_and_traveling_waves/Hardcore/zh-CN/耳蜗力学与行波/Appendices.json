{
    "hands_on_practices": [
        {
            "introduction": "理解耳蜗力学的第一步是为基底膜（BM）本身建立模型。本练习将基底膜视为一个连续结构，并推导其机械阻抗——这是决定其对声音响应方式的关键属性。通过这项练习，我们将质量、刚度和阻尼等物理参数与作为波动理论基石的阻抗概念联系起来。",
            "id": "4164654",
            "problem": "在耳蜗力学中，基底膜（Basilar Membrane, BM）通常被建模为一个薄弹性结构，该结构支持纵向变化的行波。考虑将BM建模为一个具有纵向弯曲刚度、分布惯性和粘性阻力的非均匀一维板（等效于宽度变化可忽略的欧拉-伯努利梁）。设横向位移为 $w(x,t)$，跨膜压力（单位面积上的力）为 $p(x,t)$，并假设运动是线性的、小振幅的。控制结构平衡的是沿纵向坐标 $x$ 的标准板弯曲关系，\n$$\np(x,t) \\;=\\; D(x)\\,\\frac{\\partial^{4} w}{\\partial x^{4}}(x,t) \\;+\\; R(x)\\,\\frac{\\partial w}{\\partial t}(x,t) \\;+\\; m(x)\\,\\frac{\\partial^{2} w}{\\partial t^{2}}(x,t),\n$$\n其中 $D(x)$ 是单位宽度的弯曲刚度，$R(x)$ 是单位面积的粘性阻力，$m(x)$ 是单位面积的分布质量。假设存在一个形式如下的单频缓变行波\n$$\nw(x,t) \\;=\\; \\Re\\!\\left\\{ W(x)\\,\\exp\\!\\Big(i\\omega t - i\\!\\int^{x} k(\\xi)\\,d\\xi\\Big)\\right\\},\n$$\n其角频率为 $\\omega$，局域波数为 $k(x)$，振幅 $W(x)$ 相对于波长变化缓慢。在领头阶WKB（Wentzel–Kramers–Brillouin）近似下，空间导数满足 $\\frac{\\partial^{4} w}{\\partial x^{4}} \\approx k(x)^{4} w$。定义单位面积的有效纵向刚度\n$$\nK(x) \\;\\equiv\\; D(x)\\,k(x)^{4}.\n$$\n设基底膜机械阻抗 $Z_{\\mathrm{BM}}(x,\\omega)$ 定义为局部跨膜压力振幅与局部横向速度振幅的复数比，\n$$\nZ_{\\mathrm{BM}}(x,\\omega) \\;\\equiv\\; \\frac{\\hat{p}(x)}{\\hat{v}(x)},\n$$\n其中 $\\hat{p}(x)$ 和 $\\hat{v}(x)$ 分别表示 $p(x,t)$ 和 $v(x,t)=\\frac{\\partial w}{\\partial t}(x,t)$ 的复振幅。仅从这些定义和给定的结构平衡方程出发，在领头阶WKB近似下，推导 $Z_{\\mathrm{BM}}(x,\\omega)$ 关于 $K(x)$、$m(x)$、$R(x)$ 和 $\\omega$ 的显式表达式。你的最终答案必须是单一的闭式解析表达式。不需要进行数值近似，也没有舍入要求。如果引入了任何辅助量，必须将其消去，以使最终表达式仅包含 $K(x)$、$m(x)$、$R(x)$ 和 $\\omega$。",
            "solution": "用户希望基于一个一维结构模型，推导基底膜（BM）的机械阻抗，记为 $Z_{\\mathrm{BM}}(x,\\omega)$。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **控制方程：** 关联跨膜压力 $p(x,t)$ 与横向位移 $w(x,t)$ 的结构平衡方程为\n    $$p(x,t) \\;=\\; D(x)\\,\\frac{\\partial^{4} w}{\\partial x^{4}}(x,t) \\;+\\; R(x)\\,\\frac{\\partial w}{\\partial t}(x,t) \\;+\\; m(x)\\,\\frac{\\partial^{2} w}{\\partial t^{2}}(x,t)$$\n    其中 $D(x)$ 是弯曲刚度，$R(x)$ 是粘性阻力，$m(x)$ 是单位面积质量。\n*   **波形：** 位移是一个单频缓变行波：\n    $$w(x,t) \\;=\\; \\Re\\!\\left\\{ W(x)\\,\\exp\\!\\Big(i\\omega t - i\\!\\int^{x} k(\\xi)\\,d\\xi\\Big)\\right\\}$$\n    其角频率为 $\\omega$，局域波数为 $k(x)$，振幅 $W(x)$ 变化缓慢。\n*   **WKB近似：** 对于四阶空间导数，给出的领头阶WKB近似为：\n    $$\\frac{\\partial^{4} w}{\\partial x^{4}} \\approx k(x)^{4} w$$\n*   **有效刚度：** 单位面积的有效纵向刚度定义为：\n    $$K(x) \\;\\equiv\\; D(x)\\,k(x)^{4}$$\n*   **阻抗定义：** 基底膜机械阻抗是复压力振幅与复速度振幅之比：\n    $$Z_{\\mathrm{BM}}(x,\\omega) \\;\\equiv\\; \\frac{\\hat{p}(x)}{\\hat{v}(x)}$$\n    其中 $p(x,t) = \\Re\\{\\hat{p}(x)\\exp(i\\omega t)\\}$，速度为 $v(x,t) = \\frac{\\partial w}{\\partial t}(x,t) = \\Re\\{\\hat{v}(x)\\exp(i\\omega t)\\}$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n*   **科学依据：** 该模型是耳蜗生物力学中使用的标准且成熟的简化模型（欧拉-伯努利梁）。机械阻抗、质量、阻力和刚度的概念是力学的基本原理。WKB（Wentzel–Kramers–Brillouin）近似是分析缓变介质中波传播的标准且恰当的数学方法。该问题在科学上是合理的。\n*   **适定性：** 该问题要求在指定的近似下，从一组给定的定义和一个物理模型中推导一个特定的物理量（$Z_{\\mathrm{BM}}$）。输入信息充分且一致，可以导出一个唯一的、适定的解。\n*   **客观性：** 问题以精确、正式且无偏见的科学语言陈述。\n\n**1.3. 结论与行动**\n\n该问题有科学依据、适定、客观，且没有可识别的缺陷。它是**有效**的。我们继续进行求解。\n\n### 步骤2：求解推导\n\n目标是推导机械阻抗 $Z_{\\mathrm{BM}}(x,\\omega) = \\frac{\\hat{p}(x)}{\\hat{v}(x)}$ 的表达式。为此，我们将对所有时间谐波量使用复振幅进行计算。控制方程中的所有算子都是线性的，因此我们可以用其复数形式的对应方程替代实值方程。\n\n设复位移表示为：\n$$w_c(x,t) = \\hat{w}(x)\\exp(i\\omega t)$$\n其中复振幅为 $\\hat{w}(x) = W(x)\\exp(-i\\int^x k(\\xi)d\\xi)$。物理位移是 $w(x,t) = \\Re\\{w_c(x,t)\\}$。\n\n首先，我们求出横向速度的复振幅 $\\hat{v}(x)$。速度是位移的时间导数：$v(x,t) = \\frac{\\partial w}{\\partial t}$。复速度为：\n$$v_c(x,t) = \\frac{\\partial w_c}{\\partial t} = \\frac{\\partial}{\\partial t}\\left(\\hat{w}(x)\\exp(i\\omega t)\\right) = i\\omega \\hat{w}(x)\\exp(i\\omega t)$$\n根据定义，$v_c(x,t) = \\hat{v}(x)\\exp(i\\omega t)$。比较这两个表达式，得到复速度振幅：\n$$\\hat{v}(x) = i\\omega \\hat{w}(x)$$\n\n接下来，我们使用控制方程，将复压力振幅 $\\hat{p}(x)$ 用复位移振幅 $\\hat{w}(x)$ 来表示。设复压力为 $p_c(x,t) = \\hat{p}(x)\\exp(i\\omega t)$。控制方程的复数形式为：\n$$p_c(x,t) = D(x)\\frac{\\partial^{4} w_c}{\\partial x^{4}} + R(x)\\frac{\\partial w_c}{\\partial t} + m(x)\\frac{\\partial^{2} w_c}{\\partial t^{2}}$$\n我们计算右侧的每一项。\n时间导数为：\n$$\\frac{\\partial w_c}{\\partial t} = i\\omega w_c(x,t)$$\n$$\\frac{\\partial^{2} w_c}{\\partial t^{2}} = (i\\omega)^2 w_c(x,t) = -\\omega^2 w_c(x,t)$$\n空间导数由WKB近似处理。如题目所给，$\\frac{\\partial^{4} w}{\\partial x^{4}} \\approx k(x)^{4} w$。由于此近似源于快速变化的相位项的主导作用，而该相位项在 $w(x,t)$ 和 $w_c(x,t)$ 中都存在，因此该近似也适用于复数形式：\n$$\\frac{\\partial^{4} w_c}{\\partial x^{4}} \\approx k(x)^{4} w_c(x,t)$$\n将这些代入复数形式的控制方程：\n$$\\hat{p}(x)\\exp(i\\omega t) = D(x)\\left(k(x)^{4} w_c\\right) + R(x)\\left(i\\omega w_c\\right) + m(x)\\left(-\\omega^2 w_c\\right)$$\n代入 $w_c(x,t) = \\hat{w}(x)\\exp(i\\omega t)$：\n$$\\hat{p}(x)\\exp(i\\omega t) = \\left[D(x)k(x)^{4} + i\\omega R(x) - \\omega^2 m(x)\\right]\\hat{w}(x)\\exp(i\\omega t)$$\n两边同除以 $\\exp(i\\omega t)$，得到复振幅之间的关系：\n$$\\hat{p}(x) = \\left[D(x)k(x)^{4} - m(x)\\omega^2 + i\\omega R(x)\\right]\\hat{w}(x)$$\n现在，我们使用有效刚度的定义 $K(x) = D(x)k(x)^{4}$：\n$$\\hat{p}(x) = \\left[K(x) - m(x)\\omega^2 + i\\omega R(x)\\right]\\hat{w}(x)$$\n我们现在有了用 $\\hat{w}(x)$ 表示的 $\\hat{p}(x)$ 和 $\\hat{v}(x)$ 的表达式。我们可以通过求它们的比值来计算阻抗 $Z_{\\mathrm{BM}}(x,\\omega)$：\n$$Z_{\\mathrm{BM}}(x,\\omega) = \\frac{\\hat{p}(x)}{\\hat{v}(x)} = \\frac{\\left[K(x) - m(x)\\omega^2 + i\\omega R(x)\\right]\\hat{w}(x)}{i\\omega \\hat{w}(x)}$$\n复位移振幅 $\\hat{w}(x)$ 被消掉了：\n$$Z_{\\mathrm{BM}}(x,\\omega) = \\frac{K(x) - m(x)\\omega^2 + i\\omega R(x)}{i\\omega}$$\n为简化此表达式，我们分开各项：\n$$Z_{\\mathrm{BM}}(x,\\omega) = \\frac{i\\omega R(x)}{i\\omega} + \\frac{K(x) - m(x)\\omega^2}{i\\omega}$$\n$$Z_{\\mathrm{BM}}(x,\\omega) = R(x) + \\frac{1}{i}\\left(\\frac{K(x)}{\\omega} - m(x)\\omega\\right)$$\n使用恒等式 $\\frac{1}{i} = -i$：\n$$Z_{\\mathrm{BM}}(x,\\omega) = R(x) - i\\left(\\frac{K(x)}{\\omega} - m(x)\\omega\\right)$$\n最后，重新排列括号内的项，以标准形式（实部 + $i \\times$ 虚部）呈现阻抗：\n$$Z_{\\mathrm{BM}}(x,\\omega) = R(x) + i\\left(m(x)\\omega - \\frac{K(x)}{\\omega}\\right)$$\n该表达式代表了基底膜模型的机械阻抗，其包含一个阻性部分 $R(x)$ 和一个由类质量项 $m(x)\\omega$ 与类刚度项 $-K(x)/\\omega$ 组成的抗性部分。该表达式是用所要求的变量 $K(x)$、$m(x)$、$R(x)$ 和 $\\omega$ 表示的。",
            "answer": "$$\n\\boxed{R(x) + i\\left(m(x)\\omega - \\frac{K(x)}{\\omega}\\right)}\n$$"
        },
        {
            "introduction": "在建立了基底膜的基本模型之后，我们转向另一个关键结构：蜗孔。本练习将蜗孔模拟为一个充满液体的通道，并探究其在前庭阶和鼓阶之间作为低频“分流”的功能。通过运用流体動力学和声路类比的原理，我们可以计算出定义蜗孔影响范围的截止频率，从而展示特定解剖结构如何塑造耳蜗的整体响应。",
            "id": "4164724",
            "problem": "通过蜗孔实现的前庭阶（SV）和鼓阶（ST）之间的顶端耦合影响了低频耳蜗力学。在一个简化的顶端集总元件模型中，将蜗孔孔径视为一个连接两个充满外淋巴的大管道的狭窄矩形裂缝，其长度为$L$，宽度为$w$，高度为$h$。假设外淋巴是动力粘度为$\\mu$的不可压缩牛顿流体，并且在所关注的频率下，通过裂缝的流动保持为层流，其对流惯性可以忽略不计。包含基底膜（BM）及相关结构的蜗管隔在前庭阶和鼓阶之间提供了一个微分顺应性$C_{p}$，因此，隔板上的压力差会产生一个体积变化，这个过程可以在线性声学中建模。\n\n仅从(i)平行板间层流剪切流的Navier–Stokes方程的不可压缩稳态Stokes极限和(ii)声顺（单位压力引起的体积变化）的定义出发，推导蜗孔裂缝的低频声阻，然后确定截止频率$f_{c}$。低于此频率时，前庭阶和鼓阶实际上表现为单个管道（意味着蜗孔分流了压差，使得隔板受到的驱动最小）。使用以下标准：当通过蜗孔的分流阻抗的模等于隔板的顺抗的模时，发生此过渡。\n\n使用以下生理学上合理的顶端参数计算$f_{c}$：\n- 动力粘度：$\\mu = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s}$。\n- 裂缝长度：$L = 1.5 \\times 10^{-3} \\,\\mathrm{m}$。\n- 裂缝宽度：$w = 6.0 \\times 10^{-4} \\,\\mathrm{m}$。\n- 裂缝高度：$h = 2.0 \\times 10^{-4} \\,\\mathrm{m}$。\n- 微分隔板顺应性：$C_{p} = 5.0 \\times 10^{-12} \\,\\mathrm{m^{3}/Pa}$。\n\n将最终频率以$\\mathrm{Hz}$为单位表示，并将答案四舍五入至三位有效数字。在推导过程中，明确说明您使用的任何假设，并根据与给定尺寸相关的数量级来证明层流、准稳态近似的合理性。",
            "solution": "该问题被评估为有效，因为它基于流体动力学和生物力学的既定原理，具有科学依据；问题陈述清晰，目标明确，信息充分；并使用了客观、正式的语言。所提供的参数对于耳蜗顶端是生理学上合理的。\n\n解答过程分为三部分：第一，从第一性原理出发推导蜗孔裂缝的声阻；第二，基于声路类比推导截止频率；第三，对该频率进行数值计算并证明基本假设的合理性。\n\n**第一部分：蜗孔声阻（$R_h$）的推导**\n\n我们将蜗孔建模为一个长度为$L$、宽度为$w$、高度为$h$的狭窄矩形裂缝。已知不可压缩牛顿流体（外淋巴）的流动是层流，并由前庭阶（SV）和鼓阶（ST）之间的压力差$\\Delta p$驱动。在所关注的低频下，我们可以使用Navier-Stokes方程的稳态Stokes极限。\n\n我们假设裂缝的宽度远大于其高度（$w \\gg h$），这使我们能够将流动建模为在间距为$h$的两个无限大平行板之间的压力驱动剪切流（平面Poiseuille流）。设$x$轴沿裂缝长度$L$方向，$y$轴垂直于板面，且$y=0$位于通道中心。两个板面位于$y = \\pm h/2$。对于稳态、充分发展的流动，速度$u$仅在$x$方向上，并且仅是$y$的函数，即$u(y)$。\n\nStokes方程简化为：\n$$ \\mu \\frac{d^2u}{dy^2} = \\frac{dp}{dx} $$\n其中$\\mu$是动力粘度，$\\frac{dp}{dx}$是驱动流动的压力梯度。对于沿裂缝长度$L$的恒定压力梯度，我们有$\\frac{dp}{dx} = -\\frac{\\Delta p}{L}$，其中$\\Delta p$是裂缝入口到出口的压降。\n\n对该方程关于$y$积分两次：\n$$ \\frac{du}{dy} = \\frac{1}{\\mu} \\left(\\frac{dp}{dx}\\right) y + C_1 $$\n$$ u(y) = \\frac{1}{2\\mu} \\left(\\frac{dp}{dx}\\right) y^2 + C_1 y + C_2 $$\n边界条件是壁面上的无滑移条件：$u(y = h/2) = 0$ 和 $u(y = -h/2) = 0$。\n应用第一个边界条件：\n$$ 0 = \\frac{1}{2\\mu} \\left(\\frac{dp}{dx}\\right) \\left(\\frac{h}{2}\\right)^2 + C_1 \\frac{h}{2} + C_2 $$\n应用第二个边界条件：\n$$ 0 = \\frac{1}{2\\mu} \\left(\\frac{dp}{dx}\\right) \\left(-\\frac{h}{2}\\right)^2 - C_1 \\frac{h}{2} + C_2 $$\n第一个方程减去第二个方程得出$C_1 h = 0$，所以$C_1 = 0$。从速度剖面的对称性也可以预料到这一点。\n将$C_1 = 0$代回任一个边界条件方程，可得：\n$$ C_2 = -\\frac{1}{2\\mu} \\left(\\frac{dp}{dx}\\right) \\frac{h^2}{4} = -\\frac{h^2}{8\\mu} \\frac{dp}{dx} $$\n因此，速度剖面为：\n$$ u(y) = \\frac{1}{2\\mu} \\frac{dp}{dx} \\left(y^2 - \\frac{h^2}{4}\\right) = \\frac{-\\Delta p}{2\\mu L} \\left(y^2 - \\frac{h^2}{4}\\right) $$\n为了求得体积流量$U$，我们将速度剖面对裂缝的横截面积 $A = w \\times h$ 进行积分：\n$$ U = \\int_{A} u(y) \\,dA = \\int_{-h/2}^{h/2} u(y) w \\,dy = w \\int_{-h/2}^{h/2} \\frac{\\Delta p}{2\\mu L} \\left(\\frac{h^2}{4} - y^2\\right) dy $$\n$$ U = \\frac{w \\Delta p}{2\\mu L} \\left[ \\frac{h^2}{4}y - \\frac{y^3}{3} \\right]_{-h/2}^{h/2} = \\frac{w \\Delta p}{2\\mu L} \\left( 2 \\left( \\frac{h^3}{8} - \\frac{h^3}{24} \\right) \\right) = \\frac{w \\Delta p}{2\\mu L} \\left( 2 \\frac{2h^3}{24} \\right) = \\frac{w h^3 \\Delta p}{12 \\mu L} $$\n声阻$R_a$定义为压力差与体积流量之比，即$R_a = \\Delta p / U$。对于蜗孔，该阻力$R_h$为：\n$$ R_h = \\frac{\\Delta p}{U} = \\frac{12 \\mu L}{w h^3} $$\n\n**第二部分：截止频率（$f_c$）的推导**\n\n问题描述了一个低频交流声路。蜗管隔上的压差$\\Delta p$驱动两个并联通路：一个穿过隔板本身，另一个穿过蜗孔分路。\n蜗管隔的阻抗被建模为纯顺性$C_p$。在声学术语中，这类似于一个电容器，其阻抗$Z_p$由下式给出：\n$$ Z_p = \\frac{1}{j \\omega C_p} $$\n其中$\\omega = 2\\pi f$是角频率，$j$是虚数单位。\n\n蜗孔分路的阻抗$Z_h$在低频时主要是阻性的，如上所推导。一个更完整的模型会包含一个惯性（质量）项，$L_h = \\rho L / (wh)$，使得$Z_h = R_h + j\\omega L_h$。然而，题目要求从稳态Stokes极限出发进行推导，这意味着重点在于在低频下占主导地位的阻性分量。因此，我们近似为$Z_h \\approx R_h$。\n\n截止频率$f_c$定义为这两个阻抗的模相等的频率。低于$f_c$时，隔板的顺抗（$|Z_p| = 1/(\\omega C_p)$）相对于分流电阻$R_h$较大，因此大部分体积速度通过蜗孔分流。高于$f_c$时，隔板阻抗较小，从而被更有效地驱动。\n标准是$|Z_h| = |Z_p|$。在截止频率$\\omega_c = 2\\pi f_c$处：\n$$ |R_h| = \\left| \\frac{1}{j \\omega_c C_p} \\right| $$\n$$ R_h = \\frac{1}{\\omega_c C_p} = \\frac{1}{2\\pi f_c C_p} $$\n代入我们推导的$R_h$表达式：\n$$ \\frac{12 \\mu L}{w h^3} = \\frac{1}{2\\pi f_c C_p} $$\n求解截止频率$f_c$：\n$$ f_c = \\frac{w h^3}{2\\pi C_p (12 \\mu L)} = \\frac{w h^3}{24 \\pi \\mu L C_p} $$\n\n**第三部分：合理性证明与数值计算**\n\n在计算$f_c$之前，我们先证明关键假设的合理性。外淋巴的密度近似于水的密度，即$\\rho \\approx 1000 \\, \\mathrm{kg/m^3}$。\n1.  **层流**：我们检验雷诺数$Re = \\rho \\bar{V} D_h / \\mu$，其中$\\bar{V}$是平均流体速度，$D_h$是水力直径。对于一个宽度$w=6 \\times 10^{-4}\\,\\mathrm{m}$、高度$h=2 \\times 10^{-4}\\,\\mathrm{m}$的矩形通道，水力直径为$D_h = 2wh/(w+h) = 2(6 \\times 10^{-4})(2 \\times 10^{-4})/(8 \\times 10^{-4}) = 3 \\times 10^{-4}\\,\\mathrm{m}$。在所考虑的低频下，流体速度非常小（在$\\mu\\mathrm{m/s}$到$\\mathrm{mm/s}$的数量级），导致雷诺数$Re \\ll 1$。因此，流动远在层流区内。\n2.  **准稳态流**：当频率足够低，使得粘性边界层有时间在一个振荡周期内在整个通道内充分发展时，稳态Poiseuille剖面是有效的。这在Womersley数$\\alpha = (h/2)\\sqrt{\\omega \\rho / \\mu}$很小（$\\alpha \\ll 1$）时成立。我们将在计算出$f_c$后验证此条件。\n\n现在，我们使用给定的参数计算$f_c$：\n- $\\mu = 1.0 \\times 10^{-3} \\,\\mathrm{Pa \\cdot s}$\n- $L = 1.5 \\times 10^{-3} \\,\\mathrm{m}$\n- $w = 6.0 \\times 10^{-4} \\,\\mathrm{m}$\n- $h = 2.0 \\times 10^{-4} \\,\\mathrm{m}$\n- $C_{p} = 5.0 \\times 10^{-12} \\,\\mathrm{m^{3}/Pa}$\n\n将这些值代入$f_c$的表达式中：\n$$ f_c = \\frac{(6.0 \\times 10^{-4}) (2.0 \\times 10^{-4})^3}{24 \\pi (1.0 \\times 10^{-3}) (1.5 \\times 10^{-3}) (5.0 \\times 10^{-12})} $$\n$$ f_c = \\frac{(6.0 \\times 10^{-4}) (8.0 \\times 10^{-12})}{24 \\pi (1.0 \\times 10^{-3}) (7.5 \\times 10^{-15})} $$\n$$ f_c = \\frac{48.0 \\times 10^{-16}}{180 \\pi \\times 10^{-18}} = \\frac{48.0 \\times 10^2}{180 \\pi} = \\frac{4800}{180 \\pi} = \\frac{80}{3\\pi} $$\n$$ f_c \\approx \\frac{80}{3 \\times 3.14159} \\approx 8.4885 \\, \\mathrm{Hz} $$\n四舍五入到三位有效数字，我们得到$f_c = 8.49 \\, \\mathrm{Hz}$。\n\n在此频率下，Womersley数为$\\alpha = (1.0 \\times 10^{-4})\\sqrt{2\\pi(8.49)(1000)/(1.0 \\times 10^{-3})} \\approx 0.73$。由于$\\alpha$并非远小于1，准稳态假设仅是勉强成立，流体惯性开始变得显著。然而，此计算与题目要求使用稳态Stokes极限的指令是一致的，从而得到了这个特定低频模型下的截止频率。",
            "answer": "$$\n\\boxed{8.49}\n$$"
        },
        {
            "introduction": "现在，我们从解析模型过渡到完整的计算模拟。本练习涉及构建整个耳蜗的离散数值模型，以生成行波。通过系统地改变刚度、阻尼和外毛细胞主动增益等关键参数，我们可以进行灵敏度分析。这项强大的技术揭示了每个组件如何共同作用，塑造行波的振幅、峰值位置和锐度，为深入理解耳蜗的功能与功能障碍提供了重要途径。",
            "id": "4164711",
            "problem": "考虑一个一维线性化频域基底膜力学模型，该模型能够捕捉沿耳蜗隔的行波行为。目标是执行空间刚度$K(x)$、空间阻尼$R(x)$和外毛细胞（OHC）增益的局部灵敏度分析，并量化这些参数如何影响与行波相关的可观测输出。此分析必须以纯数学术语进行，使用程序无需外部数据即可实现的可复现计算。\n\n使用以下符合上下文的基本建模假设：\n\n- 基底膜（BM）表示为由$N$个集总段组成的链，索引为$i=0,1,\\dots,N-1$，其空间坐标为$x_i \\in [0,L]$，其中$x_0=0$表示基底，$x_{N-1}=L$表示顶。每个段都遵循Newton第二定律：合力等于质量乘以加速度。\n- 在角频率为$\\omega$的时谐激励下，假设位移为$u_i(t) = \\Re\\{U_i e^{\\mathrm{i}\\omega t}\\}$，其中$U_i$是复数。段$i$的运动方程源于力的平衡：局部刚度、局部阻尼、惯性力以及与最近邻的纵向耦合。在频域中，这会产生一个形式如下的线性系统\n$$\n\\left(-m_i \\omega^2 + \\mathrm{i}\\omega r_i + k_i\\right)U_i - c\\left(U_{i+1}-2U_i+U_{i-1}\\right) = F_i,\n$$\n在边界处有适当的修正。\n- 纵向耦合通过一个耦合系数为$c$的离散拉普拉斯算子进行建模，从而形成一个三对角系统。在基底（$i=0$）和顶（$i=N-1$）的边界处，使用与离散拉普拉斯算子一致的单边耦合。\n\n定义空间参数场和主动增益：\n\n- 设耳蜗长度为$L=0.035\\,\\mathrm{m}$，段数为$N=200$。设各段质量为$m_i = m_0$，其中$m_0 = 2.0\\times 10^{-6}\\,\\mathrm{kg}$。\n- 将刚度建模为$k(x) = s_K K_0 e^{-\\alpha x}$，其中$K_0 = 2.0\\times 10^{3}\\,\\mathrm{N/m}$，$\\alpha = 150\\,\\mathrm{m}^{-1}$。标量$s_K$是用于灵敏度分析的刚度缩放因子。\n- 将阻尼建模为$r(x) = s_R R_0 e^{\\beta x}$，其中$R_0 = 0.15\\,\\mathrm{N\\cdot s/m}$，$\\beta = 40\\,\\mathrm{m}^{-1}$。标量$s_R$是用于灵敏度分析的阻尼缩放因子。\n- 通过统一减小有效阻尼来模拟OHC主动增益：$r_{\\mathrm{eff}}(x) = r(x)\\left(1 - G\\right)$，其中$G \\in [0,1)$是一个无量纲增益因子。较高的$G$会减小有效阻尼（即实现负阻尼），但为保持稳定性，G必须严格小于1。\n- 使用纵向耦合$c = 1.0\\times 10^{3}\\,\\mathrm{N/m}$。\n- 驱动力施加在基底（$i=0$），大小为$F_0 = 1.0\\,\\mathrm{N}$，对于$i>0$，$F_i=0$。\n\n对于每个测试案例，通过求解所得到的三对角线性系统来计算稳态复位移向量$\\mathbf{U} \\in \\mathbb{C}^N$。根据$\\mathbf{U}$，定义以下可观测输出：\n\n1.  沿耳蜗隔的峰值振幅：\n$$\nA_{\\max} = \\max_{i} |U_i|, \\quad \\text{单位为 } \\mathrm{m}。\n$$\n\n2.  峰值振幅的空间位置：\n$$\nx_{\\max} = x_{i^\\ast}, \\quad i^\\ast = \\underset{i}{\\arg\\max}\\,|U_i|, \\quad \\text{单位为 } \\mathrm{m}。\n$$\n\n3.  峰值位置处的局域相位斜率（相位的空间导数）：\n$$\nS_\\phi = \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=x_{\\max}}, \\quad \\phi(x_i) = \\mathrm{unwrap}\\left(\\arg(U_i)\\right), \\quad \\text{单位为 } \\mathrm{rad/m}。\n$$\n当$i^\\ast \\in \\{1,2,\\dots,N-2\\}$时，使用中心有限差分计算$S_\\phi$，在边界处使用单边差分。\n\n对标量$s_K$、$s_R$和$G$进行局部（无穷小）灵敏度分析，方法是对每个标量参数乘法地施加一个大小为$\\varepsilon$的对称分数扰动，同时保持所有其他参数固定。对于一个可观测量$O \\in \\{A_{\\max}, x_{\\max}, S_\\phi\\}$和一个参数$p \\in \\{s_K, s_R, G\\}$，估计无量纲对数灵敏度：\n$$\nS_{p}(O) \\approx \\frac{O\\left(p(1+\\varepsilon)\\right) - O\\left(p(1-\\varepsilon)\\right)}{2\\,\\varepsilon\\,O(p)},\n$$\n其中$O(p)$表示在未扰动参数$p$下评估的基线可观测量。如果$O(p)=0$，为避免除以零，定义$S_{p}(O)=0$。使用$\\varepsilon = 0.05$。\n\n科学真实性要求：\n\n- 所有量都必须使用一致的物理单位进行处理。特别地，$A_{\\max}$必须以$\\mathrm{m}$为单位计算和内部表示，$x_{\\max}$以$\\mathrm{m}$为单位，$S_\\phi$以$\\mathrm{rad/m}$为单位。最终报告的灵敏度指数$S_{p}(O)$是无量纲的（无单位）。\n- 角度必须以弧度计算。\n\n测试套件：\n\n评估以下三个测试用例的灵敏度指数，这些用例旨在探测系统的不同方面：\n\n- 案例1：频率$f=2000\\,\\mathrm{Hz}$，基线刚度缩放$s_K=1.0$，基线阻尼缩放$s_R=1.0$，OHC增益$G=0.3$。\n- 案例2：频率$f=1000\\,\\mathrm{Hz}$，基线刚度缩放$s_K=1.0$，增加的阻尼缩放$s_R=1.2$，OHC增益$G=0.0$（被动耳蜗）。\n- 案例3：频率$f=4000\\,\\mathrm{Hz}$，减小的刚度缩放$s_K=0.8$，基线阻尼缩放$s_R=1.0$，高OHC增益$G=0.9$（接近主动边缘，但因 G < 1 而稳定）。\n\n您的程序必须：\n\n- 为每个测试案例构建并求解线性系统。\n- 计算基线状态下以及对三个参数$s_K$、$s_R$和$G$中每一个进行$\\pm \\varepsilon$扰动后的$A_{\\max}$、$x_{\\max}$和$S_\\phi$。\n- 按固定顺序返回每个案例的九个灵敏度指数：\n$$\n\\left[S_{s_K}(A_{\\max}),\\,S_{s_R}(A_{\\max}),\\,S_{G}(A_{\\max}),\\,S_{s_K}(x_{\\max}),\\,S_{s_R}(x_{\\max}),\\,S_{G}(x_{\\max}),\\,S_{s_K}(S_\\phi),\\,S_{s_R}(S_\\phi),\\,S_{G}(S_\\phi)\\right].\n$$\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含所有三个案例的结果，格式为方括号括起来的逗号分隔的列表的列表。例如：\n$[\\,[\\text{case1\\_s1},\\dots,\\text{case1\\_s9}],\\,[\\text{case2\\_s1},\\dots,\\text{case2\\_s9}],\\,[\\text{case3\\_s1},\\dots,\\text{case3\\_s9}]\\,]$。\n所有打印的值必须是纯数字（布尔值、整数、浮点数或这些的列表），不带单位或其他文本。",
            "solution": "该问题要求对一维线性化基底膜（BM）力学模型进行局部灵敏度分析。该分析基于将耳蜗离散表示为耦合谐振子链。我们首先验证问题陈述，然后进行详细求解。\n\n### 问题验证\n\n**步骤1：提取的已知条件**\n- **模型：** 一维、线性化、频域的BM力学模型。\n- **离散化：** $N=200$个集总段，索引为$i=0, 1, \\dots, N-1$。\n- **空间域：** $x_i \\in [0, L]$，长度$L=0.035\\,\\mathrm{m}$。\n- **运动方程（频域）：** 对于段$i$，复位移振幅$U_i$满足：\n$$\n\\left(-m_i \\omega^2 + \\mathrm{i}\\omega r_i + k_i\\right)U_i - c\\left(U_{i+1}-2U_i+U_{i-1}\\right) = F_i\n$$\n- **边界条件：** 在$i=0$和$i=N-1$处为单边耦合。\n- **模型参数：**\n    - 质量：$m_i = m_0 = 2.0\\times 10^{-6}\\,\\mathrm{kg}$。\n    - 刚度：$k(x) = s_K K_0 e^{-\\alpha x}$，其中$K_0 = 2.0\\times 10^{3}\\,\\mathrm{N/m}$，$\\alpha = 150\\,\\mathrm{m}^{-1}$。\n    - 阻尼：$r(x) = s_R R_0 e^{\\beta x}$，其中$R_0 = 0.15\\,\\mathrm{N\\cdot s/m}$，$\\beta = 40\\,\\mathrm{m}^{-1}$。\n    - 主动增益：有效阻尼为$r_{\\mathrm{eff}}(x) = r(x)\\left(1 - G\\right)$，其中$G \\in [0,1)$是增益因子。\n    - 耦合：$c = 1.0\\times 10^{3}\\,\\mathrm{N/m}$。\n    - 力：$F_0 = 1.0\\,\\mathrm{N}$；对于$i > 0$，$F_i=0$。\n- **可观测量：**\n    1. $A_{\\max} = \\max_{i} |U_i|$（峰值振幅）。\n    2. $x_{\\max} = x_{i^\\ast}$，其中$i^\\ast = \\underset{i}{\\arg\\max}\\,|U_i|$（峰值位置）。\n    3. $S_\\phi = \\left.\\frac{\\partial \\phi}{\\partial x}\\right|_{x=x_{\\max}}$，其中$\\phi(x_i) = \\mathrm{unwrap}\\left(\\arg(U_i)\\right)$（峰值处的相位斜率）。\n- **灵敏度分析：**\n    - 无量纲对数灵敏度：$S_{p}(O) \\approx \\frac{O\\left(p(1+\\varepsilon)\\right) - O\\left(p(1-\\varepsilon)\\right)}{2\\,\\varepsilon\\,O(p)}$。\n    - 扰动：$\\varepsilon = 0.05$。\n    - 参数：$p \\in \\{s_K, s_R, G\\}$。\n    - 可观测量为零的情况：如果$O(p)=0$，则$S_{p}(O)=0$。\n- **测试案例：**\n    1. $f=2000\\,\\mathrm{Hz}$, $s_K=1.0$, $s_R=1.0$, $G=0.3$。\n    2. $f=1000\\,\\mathrm{Hz}$, $s_K=1.0$, $s_R=1.2$, $G=0.0$。\n    3. $f=4000\\,\\mathrm{Hz}$, $s_K=0.8$, $s_R=1.0$, $G=0.9$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该模型是耳蜗力学的一个公认的简化表示。控制方程是Newton第二定律对耦合振子的直接应用。指数参数梯度是耳蜗频率拓扑组织的標準生物物理近似。将主动过程建模为负阻尼是一种常见且被接受的唯象方法。所有参数值在物理上都是现实的。该问题具有科学依据。\n- **适定性：** 问题转化为求解一个线性方程组$\\mathbf{A} \\mathbf{U} = \\mathbf{F}$，其中$\\mathbf{A}$是一个三对角矩阵。规定的边界条件（“单边耦合”）导致了对矩阵边界处明确的修正。对于给定的参数范围（因为$r_{\\mathrm{eff}} \\geq 0$），所得到的复矩阵是非奇异且对角占优的，这保证了$\\mathbf{U}$有唯一解。可观测量和灵敏度度量在数学上都是明确定义的。该问题是适定的。\n- **客观性：** 问题以精确、定量的术语陈述，没有歧义或主观声明。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。它是自洽的、科学上合理的，并且计算上是可行的。现在将展开完整的解决方案。\n\n### 求解推导\n\n分析过程分为四个主要步骤：1) 形式化线性方程组，2) 求解复位移向量$\\mathbf{U}$，3) 从$\\mathbf{U}$计算指定的可观测量，以及 4) 使用数值扰动计算灵敏度。\n\n**1. 线性系统形式化**\n\n耳蜗隔被离散化为$N=200$个段。第$i$段的空间坐标是$x_i = i \\cdot \\Delta x$，其中$i \\in \\{0, 1, \\dots, N-1\\}$，段间距为$\\Delta x = L/(N-1)$。激励频率为$f$，因此角频率为$\\omega = 2\\pi f$。\n\n对于内部段（$0  i  N-1$），控制方程为：\n$$ \\left(-m_i \\omega^2 + \\mathrm{i}\\omega r_{\\mathrm{eff},i} + k_i\\right)U_i - c\\left(U_{i+1}-2U_i+U_{i-1}\\right) = F_i $$\n其中$k_i = k(x_i)$，$r_{\\mathrm{eff},i} = r_{\\mathrm{eff}}(x_i)$，$m_i = m_0$。重新整理此方程，收集$U_{i-1}$、$U_i$和$U_{i+1}$的项：\n$$ -c U_{i-1} + \\left(k_i - m_0 \\omega^2 + 2c + \\mathrm{i}\\omega r_{\\mathrm{eff},i}\\right)U_i - c U_{i+1} = F_i $$\n这种结构定义了一个三对角线性系统$\\mathbf{A}\\mathbf{U}=\\mathbf{F}$。矩阵$\\mathbf{A}$有一个主对角线、一个上对角线和一个下对角线。\n\n在边界处，我们应用单边耦合：\n- 对于基底（$i=0$）：耦合仅与段$i=1$相关。项$c(U_{i+1}-2U_i+U_{i-1})$变为$c(U_1 - U_0)$。\n$$ \\left(-m_0 \\omega^2 + \\mathrm{i}\\omega r_{\\mathrm{eff},0} + k_0\\right)U_0 - c\\left(U_1-U_0\\right) = F_0 $$\n$$ \\implies \\left(k_0 - m_0 \\omega^2 + c + \\mathrm{i}\\omega r_{\\mathrm{eff},0}\\right)U_0 - c U_1 = F_0 $$\n- 对于顶（$i=N-1$）：耦合仅与段$i=N-2$相关。项$c(U_{i+1}-2U_i+U_{i-1})$变为$c(U_{N-2} - U_{N-1})$。\n$$ \\left(-m_{N-1} \\omega^2 + \\mathrm{i}\\omega r_{\\mathrm{eff},N-1} + k_{N-1}\\right)U_{N-1} - c\\left(U_{N-2}-U_{N-1}\\right) = F_{N-1} $$\n$$ \\implies -c U_{N-2} + \\left(k_{N-1} - m_0 \\omega^2 + c + \\mathrm{i}\\omega r_{\\mathrm{eff},N-1}\\right)U_{N-1} = 0 $$\n因为$F_{N-1}=0$。\n\n因此，三对角矩阵$\\mathbf{A}$的对角线元素为：\n- 主对角线（$d_i$）：\n  - $d_0 = k_0 - m_0 \\omega^2 + c + \\mathrm{i}\\omega r_{\\mathrm{eff},0}$\n  - $d_i = k_i - m_0 \\omega^2 + 2c + \\mathrm{i}\\omega r_{\\mathrm{eff},i}$ for $i=1, \\dots, N-2$\n  - $d_{N-1} = k_{N-1} - m_0 \\omega^2 + c + \\mathrm{i}\\omega r_{\\mathrm{eff},N-1}$\n- 下对角线（$l_i$）：$l_i = -c$ for $i=1, \\dots, N-1$。\n- 上对角线（$u_i$）：$u_i = -c$ for $i=0, \\dots, N-2$。\n\n力向量$\\mathbf{F}$是$[F_0, 0, \\dots, 0]^T$，其中$F_0=1.0\\,\\mathrm{N}$。\n\n**2. 求解系统**\n\n求解这个$N \\times N$的复值三对角系统，以获得复位移向量$\\mathbf{U} = [U_0, U_1, \\dots, U_{N-1}]^T$。可以使用高效的算法，例如Thomas算法（或来自像SciPy这样的科学计算库的带状矩阵求解器）。\n\n**3. 计算可观测量**\n\n一旦获得$\\mathbf{U}$，可观测量按如下方式计算：\n- **峰值振幅（$A_{\\max}$）：** 复位移的模的最大值。\n$$ A_{\\max} = \\max_{i \\in \\{0, \\dots, N-1\\}} |U_i| $$\n- **峰值位置（$x_{\\max}$）：** 对应于峰值振幅的空间位置。\n$$ i^\\ast = \\underset{i \\in \\{0, \\dots, N-1\\}}{\\arg\\max}\\, |U_i| \\quad \\implies \\quad x_{\\max} = x_{i^\\ast} \\frac{L}{N-1} $$\n- **峰值处的相位斜率（$S_\\phi$）：** 首先，计算所有$i$的相角$\\arg(U_i)$。对得到的相位向量进行“展开”以消除$2\\pi$的不连续性，从而产生连续的相位剖面$\\phi(x_i)$。然后使用有限差分在峰值位置$x_{i^\\ast}$处估计空间导数（斜率）：\n  - 如果$0  i^\\ast  N-1$（中心差分）：\n    $$ S_\\phi = \\frac{\\phi(x_{i^\\ast+1}) - \\phi(x_{i^\\ast-1})}{2\\Delta x} $$\n  - 如果$i^\\ast = 0$（向前差分）：\n    $$ S_\\phi = \\frac{\\phi(x_1) - \\phi(x_0)}{\\Delta x} $$\n  - 如果$i^\\ast = N-1$（向后差分）：\n    $$ S_\\phi = \\frac{\\phi(x_{N-1}) - \\phi(x_{N-2})}{\\Delta x} $$\n\n**4. 灵敏度分析**\n\n对于每个可观测量$O \\in \\{A_{\\max}, x_{\\max}, S_\\phi\\}$和每个参数$p \\in \\{s_K, s_R, G\\}$，我们计算无量纲对数灵敏度$S_p(O)$。这是通过计算基线参数集和乘法扰动参数集下的可观测量来完成的。设$O(p)$是在基线参数值$p$下的可观测量。设$O(p(1+\\varepsilon))$和$O(p(1-\\varepsilon))$是当$p$被扰动时的可观测量。灵敏度近似为：\n$$ S_{p}(O) \\approx \\frac{O(p(1+\\varepsilon)) - O(p(1-\\varepsilon))}{2\\,\\varepsilon\\,O(p)} $$\n扰动为$\\varepsilon = 0.05$。如果基线可观测量$O(p)=0$，则定义灵敏度为$S_p(O)=0$。\n当基线参数为零时，会出现一个特殊情况，例如案例2中的$G=0$。乘法扰动$p(1 \\pm \\varepsilon)$变为$0(1 \\pm \\varepsilon) = 0$。因此，扰动后的可观测量与基线值相同，灵敏度公式的分子为零，灵敏度$S_G(O)$被正确地评估为$0$。\n\n对三个测试用例中的每一个参数重复此过程，每个案例产生总共$3 \\times 3 = 9$个灵敏度指数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the cochlear mechanics sensitivity analysis problem.\n    \"\"\"\n\n    # Define physical constants and model parameters\n    L = 0.035  # m, length of cochlea\n    N = 200  # number of segments\n    m0 = 2.0e-6  # kg, mass per segment\n    K0 = 2.0e3  # N/m, stiffness constant\n    alpha = 150.0  # 1/m, stiffness decay constant\n    R0 = 0.15  # N.s/m, damping constant\n    beta = 40.0  # 1/m, damping increase constant\n    c_coupling = 1.0e3  # N/m, longitudinal coupling\n    F0 = 1.0  # N, driving force at the base\n    epsilon = 0.05  # perturbation for sensitivity analysis\n\n    # Spatial grid\n    x_grid = np.linspace(0, L, N)\n    dx = L / (N - 1)\n\n    test_cases = [\n        # (f, sK, sR, G)\n        (2000.0, 1.0, 1.0, 0.3),  # Case 1\n        (1000.0, 1.0, 1.2, 0.0),  # Case 2\n        (4000.0, 0.8, 1.0, 0.9),  # Case 3\n    ]\n\n    def compute_observables(f, sK, sR, G):\n        \"\"\"\n        Computes observables for a given set of parameters.\n        \"\"\"\n        omega = 2.0 * np.pi * f\n\n        # Calculate position-dependent parameters\n        k = sK * K0 * np.exp(-alpha * x_grid)\n        r = sR * R0 * np.exp(beta * x_grid)\n        r_eff = r * (1.0 - G)\n\n        # Construct the tridiagonal matrix A in banded format for scipy\n        # A_banded has shape (3, N) for 1 upper and 1 lower diagonal\n        # Row 0: upper diagonal (shifted right by 1)\n        # Row 1: main diagonal\n        # Row 2: lower diagonal\n        A_banded = np.zeros((3, N), dtype=np.complex128)\n        \n        # Upper and lower diagonals\n        A_banded[0, 1:] = -c_coupling\n        A_banded[2, :-1] = -c_coupling\n\n        # Main diagonal\n        main_diag_real = k - m0 * omega**2\n        main_diag_imag = omega * r_eff\n        \n        # Interior points\n        d_interior = main_diag_real + 2 * c_coupling + 1j * main_diag_imag\n        A_banded[1, :] = d_interior\n        \n        # Boundary points\n        A_banded[1, 0] = main_diag_real[0] + c_coupling + 1j * main_diag_imag[0]\n        A_banded[1, -1] = main_diag_real[-1] + c_coupling + 1j * main_diag_imag[-1]\n\n        # Construct the force vector F\n        F = np.zeros(N, dtype=np.complex128)\n        F[0] = F0\n\n        # Solve the linear system A*U = F\n        U = solve_banded((1, 1), A_banded, F)\n\n        # Calculate observables\n        abs_U = np.abs(U)\n        \n        # 1. Peak amplitude\n        A_max = np.max(abs_U)\n\n        # 2. Location of peak amplitude\n        i_star = np.argmax(abs_U)\n        x_max = x_grid[i_star]\n\n        # 3. Phase slope at peak\n        phase = np.unwrap(np.angle(U))\n        if i_star == 0:\n            S_phi = (phase[1] - phase[0]) / dx\n        elif i_star == N - 1:\n            S_phi = (phase[N - 1] - phase[N - 2]) / dx\n        else:\n            S_phi = (phase[i_star + 1] - phase[i_star - 1]) / (2 * dx)\n            \n        return A_max, x_max, S_phi\n\n    all_results = []\n    for f_base, sK_base, sR_base, G_base in test_cases:\n        case_sensitivities = []\n        \n        # Baseline observable values\n        O_base = compute_observables(f_base, sK_base, sR_base, G_base)\n        A_max_base, x_max_base, S_phi_base = O_base\n\n        # Parameters for sensitivity analysis\n        params = [\n            {'name': 'sK', 'base': sK_base, 'pert': (f_base, sR_base, G_base)},\n            {'name': 'sR', 'base': sR_base, 'pert': (f_base, sK_base, G_base)},\n            {'name': 'G', 'base': G_base, 'pert': (f_base, sK_base, sR_base)},\n        ]\n        \n        sensitivities_for_observables = {\n            'A_max': [], 'x_max': [], 'S_phi': []\n        }\n\n        for p_info in params:\n            p_name = p_info['name']\n            p_base = p_info['base']\n\n            if p_base == 0:\n                # Multiplicative perturbation of 0 is still 0, so change is 0.\n                O_plus = O_base\n                O_minus = O_base\n            else:\n                p_plus = p_base * (1 + epsilon)\n                p_minus = p_base * (1 - epsilon)\n\n                if p_name == 'sK':\n                    O_plus = compute_observables(p_info['pert'][0], p_plus, p_info['pert'][1], p_info['pert'][2])\n                    O_minus = compute_observables(p_info['pert'][0], p_minus, p_info['pert'][1], p_info['pert'][2])\n                elif p_name == 'sR':\n                    O_plus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_plus, p_info['pert'][2])\n                    O_minus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_minus, p_info['pert'][2])\n                elif p_name == 'G':\n                    O_plus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_info['pert'][2], p_plus)\n                    O_minus = compute_observables(p_info['pert'][0], p_info['pert'][1], p_info['pert'][2], p_minus)\n\n            A_max_plus, x_max_plus, S_phi_plus = O_plus\n            A_max_minus, x_max_minus, S_phi_minus = O_minus\n\n            # Calculate sensitivities for each observable\n            # S_p(O) = (O(p+) - O(p-)) / (2 * epsilon * O(p_base))\n            \n            # Sensitivity of A_max\n            if A_max_base == 0:\n                S_p_A_max = 0.0\n            else:\n                S_p_A_max = (A_max_plus - A_max_minus) / (2 * epsilon * A_max_base)\n            sensitivities_for_observables['A_max'].append(S_p_A_max)\n\n            # Sensitivity of x_max\n            if x_max_base == 0:\n                S_p_x_max = 0.0\n            else:\n                S_p_x_max = (x_max_plus - x_max_minus) / (2 * epsilon * x_max_base)\n            sensitivities_for_observables['x_max'].append(S_p_x_max)\n\n            # Sensitivity of S_phi\n            if S_phi_base == 0:\n                S_p_S_phi = 0.0\n            else:\n                S_p_S_phi = (S_phi_plus - S_phi_minus) / (2 * epsilon * S_phi_base)\n            sensitivities_for_observables['S_phi'].append(S_p_S_phi)\n        \n        # Assemble results in the specified order\n        case_sensitivities.extend(sensitivities_for_observables['A_max'])\n        case_sensitivities.extend(sensitivities_for_observables['x_max'])\n        case_sensitivities.extend(sensitivities_for_observables['S_phi'])\n\n        all_results.append(case_sensitivities)\n\n    # Format the final output string\n    def format_list(data):\n        return f\"[{','.join(f'{x:.8f}' for x in data)}]\"\n    \n    output_str = f\"[{','.join(format_list(case) for case in all_results)}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}