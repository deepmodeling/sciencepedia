{
    "hands_on_practices": [
        {
            "introduction": "硬化蛋白（Sclerostin）是骨重塑过程中的一个关键负调控因子，而针对它的抗体疗法是治疗骨质疏松症的前沿策略。本练习旨在通过一个简化的数学模型，帮助我们理解这种疗法的效用如何依赖于患者初始的硬化蛋白水平。通过推导成骨细胞活化水平的相对变化，我们可以量化评估治疗效果，并将复杂的生物化学过程转化为一个清晰的解析关系 。",
            "id": "4196997",
            "problem": "在骨质疏松的骨骼中，骨细胞产生的硬化蛋白增加会抑制Wingless/Integrated (Wnt)信号通路，从而减少成骨细胞的活化并损害骨形成。考虑一个力学生物学模型，其中Wnt通路的活化受到硬化蛋白水平的抑制，其活化由饱和抑制关系式给出：$$W = \\frac{W_{\\mathrm{max}}}{1 + s/s_0},$$ 其中，$W$是Wnt活化水平，$W_{\\mathrm{max}}$是在没有硬化蛋白时的最大活化水平，$s$是有效硬化蛋白水平，$s_0$是活化水平相对于最大值减半时的参考硬化蛋白水平。假设成骨细胞活化$A$与Wnt活化成线性比例关系，$$A = \\alpha W,$$ 其中$\\alpha$是一个反映下游转导效率的正常数比例常数。一种针对硬化蛋白的单克隆抗体疗法将有效硬化蛋白水平降低至其一半，即$s \\mapsto s' = \\frac{1}{2}s$。\n\n从相对变化的基本定义出发，计算成骨细胞活化的分数相对变化，$$\\frac{\\Delta A}{A} = \\frac{A(s') - A(s)}{A(s)},$$ 并将您的最终结果表示为基线归一化硬化蛋白水平$$x = \\frac{s}{s_0}$$的闭合形式函数。请以无量纲分数形式提供答案。无需四舍五入。",
            "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- Wnt通路活化作为硬化蛋白水平$s$的函数： $$W(s) = \\frac{W_{\\mathrm{max}}}{1 + s/s_0}$$\n- $W_{\\mathrm{max}}$：最大Wnt活化水平。\n- $s_0$：参考硬化蛋白水平。\n- 成骨细胞活化$A$作为Wnt活化$W$的函数： $$A = \\alpha W$$\n- $\\alpha$：正常数比例常数。\n- 治疗引起的硬化蛋白水平变化： $$s' = \\frac{1}{2}s$$\n- 待计算量：成骨细胞活化的分数相对变化，$$\\frac{\\Delta A}{A} = \\frac{A(s') - A(s)}{A(s)}$$\n- 最终结果的自变量：归一化硬化蛋白水平，$$x = \\frac{s}{s_0}$$\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了一个简化但机理上有效的骨重塑调节模型。硬化蛋白对Wnt活化的抑制关系是生物化学动力学中使用的标准形式（类似于竞争性抑制）。硬化蛋白、Wnt信号通路和成骨细胞在骨质疏松症中的作用是骨生物学中一个公认的领域，也是现有疗法（例如Romosozumab）的目标。该模型具有科学依据。\n- **适定性：** 该问题提供了推导所需量的所有必要数学定义和关系。初始和最终状态定义明确，目标变量无歧义。存在唯一的稳定解。\n- **客观性：** 该问题使用精确、客观的数学语言陈述。所有术语均已定义。\n- **缺陷分析：**\n  - 该问题在科学上是合理的，可以形式化，并且与生物力学和骨质疏松症建模直接相关。\n  - 它是完整的、自洽的，并且没有矛盾。在相对变化计算中，参数$\\alpha$和$W_{\\mathrm{max}}$预计会相互抵消，因此不需要它们的具体值。\n  - 在数学模型的背景下，这些条件在生物学上是合理的。\n  - 问题结构清晰，可以导出一个唯一解。\n\n**第3步：结论与行动**\n该问题有效。将推导解答。\n\n成骨细胞活化$A$是硬化蛋白水平$s$的函数。我们首先明确表示$A(s)$。将Wnt活化$W$的表达式代入成骨细胞活化$A$的方程中，我们得到：\n$$A(s) = \\alpha W(s) = \\alpha \\left( \\frac{W_{\\mathrm{max}}}{1 + s/s_0} \\right) = \\frac{\\alpha W_{\\mathrm{max}}}{1 + s/s_0}$$\n该疗法将有效硬化蛋白水平降低至$s' = \\frac{1}{2}s$。新的成骨细胞活化水平$A(s')$，可以通过将$s'$代入$A(s)$的表达式中求得：\n$$A(s') = \\frac{\\alpha W_{\\mathrm{max}}}{1 + s'/s_0} = \\frac{\\alpha W_{\\mathrm{max}}}{1 + (\\frac{1}{2}s)/s_0} = \\frac{\\alpha W_{\\mathrm{max}}}{1 + \\frac{s}{2s_0}}$$\n我们需要计算成骨细胞活化的分数相对变化，定义为：\n$$\\frac{\\Delta A}{A} = \\frac{A(s') - A(s)}{A(s)}$$\n该表达式可以重写为：\n$$\\frac{\\Delta A}{A} = \\frac{A(s')}{A(s)} - 1$$\n我们首先计算比率$\\frac{A(s')}{A(s)}$：\n$$\\frac{A(s')}{A(s)} = \\frac{\\frac{\\alpha W_{\\mathrm{max}}}{1 + s/(2s_0)}}{\\frac{\\alpha W_{\\mathrm{max}}}{1 + s/s_0}}$$\n项$\\alpha W_{\\mathrm{max}}$从分子和分母中消去，得到：\n$$\\frac{A(s')}{A(s)} = \\frac{1 + s/s_0}{1 + s/(2s_0)}$$\n问题要求最终答案用基线归一化硬化蛋白水平$x = s/s_0$来表示。将$x$代入该比率，得到：\n$$\\frac{A(s')}{A(s)} = \\frac{1 + x}{1 + x/2}$$\n现在，我们可以计算分数相对变化$\\frac{\\Delta A}{A}$：\n$$\\frac{\\Delta A}{A} = \\frac{1 + x}{1 + x/2} - 1$$\n为了简化此表达式，我们使用公分母$1 + x/2$：\n$$\\frac{\\Delta A}{A} = \\frac{1 + x}{1 + x/2} - \\frac{1 + x/2}{1 + x/2} = \\frac{(1 + x) - (1 + x/2)}{1 + x/2}$$\n简化分子：\n$$\\frac{\\Delta A}{A} = \\frac{1 + x - 1 - x/2}{1 + x/2} = \\frac{x - x/2}{1 + x/2} = \\frac{x/2}{1 + x/2}$$\n为了消除复合分数，我们将分子和分母同乘以$2$：\n$$\\frac{\\Delta A}{A} = \\frac{2 \\cdot (x/2)}{2 \\cdot (1 + x/2)} = \\frac{x}{2(1) + 2(x/2)} = \\frac{x}{2 + x}$$\n这就是成骨细胞活化分数相对变化作为归一化基线硬化蛋白水平$x$的函数的最终闭合形式表达式。",
            "answer": "$$\\boxed{\\frac{x}{2 + x}}$$"
        },
        {
            "introduction": "骨骼的“力学稳态”（mechanostat）理论是骨生物力学的核心概念，它解释了骨组织如何通过调整其密度来适应日常的机械负荷。本练习将这一理论形式化，要求您结合骨弹性模量与密度的幂律关系以及应力控制加载的假设，推导出一个预测平衡骨密度的方程。这个实践不仅能加深对骨功能适应基本原理的理解，还能揭示细胞对机械刺激的敏感性（即“设定点”）的改变如何导致年龄相关性骨丢失 。",
            "id": "4197054",
            "problem": "为一个理想化的单轴加载骨小梁隔室，建立了一个由骨细胞调控的力学稳态器模型。在该模型中，表观骨密度（记为 $\\rho$）通过重塑过程演变，以平衡力学刺激与生物学设定点。力学刺激定义为 $S(\\rho) = \\beta\\,E(\\rho)\\,\\epsilon(\\rho)^{2}$，其中 $E(\\rho)$ 是表观弹性模量，$\\epsilon(\\rho)$ 是日常活动中的习惯性载荷引起的宏观应变幅值。表观模量遵循幂律关系 $E(\\rho) = \\alpha\\,\\rho^{n}$，其中 $\\alpha  0$ 且 $n  0$。假设在所关心的时间尺度上，习惯性载荷近似为应力控制的，具有恒定的宏观应力幅值 $\\sigma  0$，因此根据单轴应力下的线性弹性理论，$\\epsilon(\\rho) = \\sigma / E(\\rho)$。\n\n设健康状态下，生物力学稳态器的设定点为 $S_{0}  0$。由于年龄增长引起的脱敏，该设定点增加了 $\\Delta S_{0} \\ge 0$，因此新的设定点为 $S_{0}^{\\text{new}} = S_{0} + \\Delta S_{0}$。当力学刺激等于设定点时，净重塑为零，此时定义为平衡状态。在这些假设下，请确定新的平衡密度 $\\rho^{*}$，并用 $\\alpha$、$\\beta$、$n$、$\\sigma$、$S_{0}$ 和 $\\Delta S_{0}$ 表示为一个闭式表达式。请提供一个单一的解析表达式；不需要进行数值计算，最终表达式中也不需要单位。",
            "solution": "该问题被验证为具有科学依据、适定、客观且完整。它描述了骨重塑的标准力学稳态器模型，这是生物力学中的一个核心概念。所有变量和条件都定义清晰，从而导出一个具有唯一且有意义解的可解问题。所用术语专业且与该领域一致。\n\n该问题要求找到新的平衡骨密度 $\\rho^{*}$，当力学刺激 $S(\\rho^{*})$ 等于新的生物学设定点 $S_{0}^{\\text{new}}$ 时达到该密度。因此，平衡条件为：\n$$S(\\rho^{*}) = S_{0}^{\\text{new}}$$\n新的设定点由 $S_{0}^{\\text{new}} = S_{0} + \\Delta S_{0}$ 给出。力学刺激定义为 $S(\\rho) = \\beta\\,E(\\rho)\\,\\epsilon(\\rho)^{2}$。为了求解 $\\rho^{*}$，我们必须首先将刺激 $S$ 表示为密度 $\\rho$ 和给定参数的函数。\n\n问题陈述，习惯性载荷是应力控制的，具有恒定的宏观应力幅值 $\\sigma$。在此条件下，应变 $\\epsilon(\\rho)$ 由线性弹性理论给出：\n$$\\epsilon(\\rho) = \\frac{\\sigma}{E(\\rho)}$$\n我们将此应变表达式代入力学刺激的定义中：\n$$S(\\rho) = \\beta\\,E(\\rho)\\,\\left(\\frac{\\sigma}{E(\\rho)}\\right)^{2} = \\beta\\,E(\\rho)\\,\\frac{\\sigma^{2}}{E(\\rho)^{2}} = \\frac{\\beta\\,\\sigma^{2}}{E(\\rho)}$$\n这个中间结果表明，对于一个应力控制的系统，力学刺激与表观弹性模量成反比。\n\n接下来，我们将给定的弹性模量幂律关系 $E(\\rho) = \\alpha\\,\\rho^{n}$ 代入刺激的表达式中：\n$$S(\\rho) = \\frac{\\beta\\,\\sigma^{2}}{\\alpha\\,\\rho^{n}}$$\n现在，我们得到了仅用密度 $\\rho$ 以及参数 $\\alpha$、$\\beta$、$n$ 和 $\\sigma$ 表示的力学刺激 $S$。\n\n现在我们可以在新的平衡密度 $\\rho^{*}$ 处应用平衡条件：\n$$S(\\rho^{*}) = \\frac{\\beta\\,\\sigma^{2}}{\\alpha\\,(\\rho^{*})^{n}} = S_{0}^{\\text{new}}$$\n代入 $S_{0}^{\\text{new}} = S_{0} + \\Delta S_{0}$，我们得到：\n$$\\frac{\\beta\\,\\sigma^{2}}{\\alpha\\,(\\rho^{*})^{n}} = S_{0} + \\Delta S_{0}$$\n我们的目标是解此方程以求得 $\\rho^{*}$。我们进行代数重排。首先，我们分离出含有 $\\rho^{*}$ 的项：\n$$(\\rho^{*})^{n} = \\frac{\\beta\\,\\sigma^{2}}{\\alpha\\,(S_{0} + \\Delta S_{0})}$$\n为了求解 $\\rho^{*}$，我们对等式两边取 $n$ 次方根，这等价于将两边都提升到 $\\frac{1}{n}$ 次幂：\n$$\\rho^{*} = \\left( \\frac{\\beta\\,\\sigma^{2}}{\\alpha\\,(S_{0} + \\Delta S_{0})} \\right)^{\\frac{1}{n}}$$\n这就是用给定参数表示的新的平衡密度 $\\rho^{*}$ 的最终闭式表达式。该表达式具有物理意义，因为所有参数 $\\alpha$、$\\sigma$、$S_0$ 均为严格正值，$n$ 为正值，$\\Delta S_0$ 为非负值，这确保了根号内的参数是一个正实数。",
            "answer": "$$\\boxed{\\left( \\frac{\\beta\\,\\sigma^{2}}{\\alpha\\,(S_{0} + \\Delta S_{0})} \\right)^{\\frac{1}{n}}}$$"
        },
        {
            "introduction": "骨骼对力学环境变化的响应并非瞬时完成，其中涉及复杂的细胞信号传导和招募过程，这些过程在骨质疏松症中常常表现出延迟和效率降低。本计算实践旨在通过构建一个包含时间延迟的动力学模型，来探索这些生理延迟的后果。您将通过数值模拟发现，延迟响应会导致骨密度在适应新负荷时出现“过冲”和振荡现象，这为了解骨质疏松状态下骨适应缺陷的动态特性提供了重要视角 。",
            "id": "4197032",
            "problem": "考虑一个用于皮质骨量适应外部载荷突变的最小力学生物学模型，该模型包含延迟的成骨细胞响应，用以表示在骨质疏松症中观察到的骨细胞信号传导和募集缺陷。请使用以下基础和经验关系作为您的起点，并从中推导出一个可运行的数值模拟，以量化骨密度的超调和振荡。\n\n基本基础和核心定义：\n- 对于均匀弹性连续体，Hooke定律断言轴向应变与弹性模量成反比，因此对于固定的轴向载荷，应变大小与弹性模量的倒数成比例。\n- 骨的弹性模量通过幂律关系随密度变化，即 $$E(\\rho) = E_0 \\left(\\frac{\\rho}{\\rho_0}\\right)^\\alpha,$$ 其中 $$\\rho$$ 是骨密度，$$\\rho_0$$ 是基线密度，$$\\alpha > 0$$ 是一个有经验支持的指数，$$E_0$$ 是基线模量。\n- 在力学感受器范式中，成骨细胞的激活由与应变或应变能成比例（至多相差一个比例常数）的骨细胞刺激驱动。对于固定的外部载荷比 $$L/L_0$$，假设无量纲的力学感受刺激是 $$s(t) = \\frac{L(t)/L_0}{\\left(\\rho(t)/\\rho_0\\right)^\\alpha},$$ 这与Hooke定律和模量-密度尺度关系一致。\n- 成骨细胞的响应不是瞬时的；将成骨细胞活性代理 $$b(t)$$ 建模为对具有纯延迟 $$\\tau_d$$ 的刺激的一阶松弛过程，因此其变化率遵循对延迟刺激的线性松弛。\n- 骨密度的变化由骨形成减去骨吸收决定。将骨形成建模为与成骨细胞活性代理 $$b(t)$$ 成正比，将骨吸收建模为与当前密度 $$\\rho(t)$$ 成正比。\n\n您必须根据上述原理构建以下耦合延迟动力学系统，表示为带延迟的常微分方程（ODE）系统：\n1. 一个关于 $$b(t)$$ 对力学感受刺激 $$s(t - \\tau_d)$$ 的延迟一阶松弛，松弛时间为 $$\\tau_b$$。\n2. 一个关于 $$\\rho(t)$$ 的一阶质量平衡，结合了与 $$b(t)$$ 成正比（系数为 $$k_b$$）的形成和与 $$\\rho(t)$$ 成正比（系数为 $$k_r$$）的吸收。\n\n使用固定的均匀时间步长，在一个鲁棒的ODE步进方案（例如，四阶Runge–Kutta）下，对此延迟系统在时间区间 $$t \\in [0,T]$$ 上实现数值模拟，同时将延迟输入 $$s(t - \\tau_d)$$ 在每个步长内视为分段常数，并从存储的历史记录中获取。对于延迟所需的早于 $$t=0$$ 的时间，假设系统处于基线稳态。\n\n加载协议：\n- 外部载荷比 $$L(t)/L_0$$ 在 $$t  t_{\\mathrm{change}}$$ 时为 $$1$$，在 $$t \\geq t_{\\mathrm{change}}$$ 时突变为常数 $$L_1/L_0$$。\n\n单位和输出：\n- 骨密度 $$\\rho$$ 的单位必须是 $$\\mathrm{g}/\\mathrm{cm}^3$$。\n- 时间 $$t$$ 的单位必须是天。\n- 将超调幅度报告为相对于阶跃变化后新稳态密度的十进制分数。即，计算 $$\\max\\{0, \\max_{t \\geq t_{\\mathrm{change}}} \\rho(t) - \\rho_{\\mathrm{ss}}\\}/\\rho_{\\mathrm{ss}}$$，其中 $$\\rho_{\\mathrm{ss}}$$ 是加载阶跃后的稳态密度。\n- 通过计算 $$t \\geq t_{\\mathrm{change}}$$ 时 $$\\rho(t) - \\rho_{\\mathrm{ss}}$$ 的符号变化次数来检测振荡；如果在模拟区间内该差值至少有两次符号变化，则定义系统为振荡的。\n\n稳态表征：\n- 从模型和您的基础关系所蕴含的平衡条件中推导出 $$\\rho_{\\mathrm{ss}}$$；在超调和振荡计算中使用得到的 $$\\rho_{\\mathrm{ss}}$$。\n\n数值要求：\n- 使用固定的时间步长，并进行足够长时间的模拟，以使瞬态响应可信地衰减。\n- 确保参数在科学上是合理的，并与皮质骨重塑的时间尺度（数十到数百天）和密度（约 $$1.0$$–$$2.0$$ $$\\mathrm{g}/\\mathrm{cm}^3$$）一致。\n\n测试套件：\n模拟以下四个参数集，每个参数集指定为 $$[\\rho_0, \\alpha, k_r, \\tau_b, \\tau_d, L_1/L_0, t_{\\mathrm{change}}, T, \\Delta t]$$，其中 $$k_b$$ 的选择必须使基线稳态为 $$\\rho_0$$（即 $$k_b = k_r \\rho_0$$），并且所有时间单位均为天。对于每种情况，请精确使用给定的参数。\n\n- 情况A（正常路径，轻度延迟）：$$[1.50,\\, 2.00,\\, 0.010,\\, 30.0,\\, 10.0,\\, 1.50,\\, 200.0,\\, 1200.0,\\, 0.25]$$\n- 情况B（骨质疏松缺陷：更长延迟和更慢形成）：$$[1.20,\\, 2.00,\\, 0.012,\\, 80.0,\\, 60.0,\\, 1.50,\\, 200.0,\\, 1200.0,\\, 0.25]$$\n- 情况C（边缘情况：非常长的延迟，更大的阶跃）：$$[1.50,\\, 1.80,\\, 0.010,\\, 50.0,\\, 120.0,\\, 2.00,\\, 200.0,\\, 1200.0,\\, 0.25]$$\n- 情况D（边界条件：无延迟）：$$[1.50,\\, 2.00,\\, 0.010,\\, 20.0,\\, 0.0,\\, 1.50,\\, 200.0,\\, 1200.0,\\, 0.25]$$\n\n答案规范和最终输出格式：\n- 对于每种情况，输出一个包含两个元素的列表 $$[\\text{overshoot},\\, \\text{oscillatory}]$$，其中 $$\\text{overshoot}$$ 是一个四舍五入到六位小数的浮点数，$$\\text{oscillatory}$$ 是一个布尔值。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $$[[o_A,\\, \\mathrm{True}],\\,[o_B,\\, \\mathrm{False}],\\,[o_C,\\, \\mathrm{True}],\\,[o_D,\\, \\mathrm{False}]]$$，其中 $$o_A, o_B, o_C, o_D$$ 分别是对应情况的超调值，每个值都四舍五入到六位小数。",
            "solution": "用户提供了一个关于计算生物力学的明确问题，内容涉及骨量适应。任务是基于第一性原理和经验关系，推导并模拟一个简化的力学生物学模型，然后分析系统对机械载荷突变的响应。\n\n### 1. 数学模型构建\n\n问题明确了构建一个包含两个耦合延迟微分方程（DDE）系统的基础，该系统描述了骨矿物质密度 $$\\rho(t)$$ 和成骨细胞活性代理 $$b(t)$$ 的时间演化。\n\n首先，骨密度的变化率被建模为骨形成和骨吸收之间的质量平衡。骨形成由成骨细胞活性驱动，与 $$b(t)$$ 成正比，速率常数为 $$k_b$$。骨吸收被假定为一阶衰减过程，与当前密度 $$\\rho(t)$$ 成正比，速率常数为 $$k_r$$。这引出了第一个方程：\n$$\n\\frac{d\\rho(t)}{dt} = k_b b(t) - k_r \\rho(t)\n$$\n\n其次，成骨细胞活性代理 $$b(t)$$ 被建模为一阶松弛过程。其值向目标刺激 $$s$$ 松弛，特征松弛时间为 $$\\tau_b$$。一个关键特征是包含了纯时间延迟 $$\\tau_d$$，它代表了细胞信号传导和募集中的生理滞后。因此，时间 $$t$$ 的活性 $$b(t)$$ 响应的是时间 $$t - \\tau_d$$ 发生的刺激。其控制方程为：\n$$\n\\frac{db(t)}{dt} = \\frac{1}{\\tau_b} \\left( s(t - \\tau_d) - b(t) \\right)\n$$\n\n力学感受刺激 $$s(t)$$ 源自骨骼所承受的应变。根据所给原理，应变与弹性模量 $$E$$ 成反比。而模量又通过幂律关系随密度变化：$$E(\\rho) = E_0 (\\rho/\\rho_0)^\\alpha$$。对于给定的外部载荷比 $$L(t)/L_0$$，刺激因此与 $$E$$ 成反比，得到表达式：\n$$\ns(t) = \\frac{L(t)/L_0}{\\left(\\rho(t)/\\rho_0\\right)^\\alpha}\n$$\n\n将刺激的表达式代入 $$b(t)$$ 的方程，得到第二个DDE的最终形式：\n$$\n\\frac{db(t)}{dt} = \\frac{1}{\\tau_b} \\left( \\frac{L(t - \\tau_d)/L_0}{\\left(\\rho(t - \\tau_d)/\\rho_0\\right)^\\alpha} - b(t) \\right)\n$$\n\n完整的DDE系统是：\n$$\n\\begin{cases}\n\\frac{d\\rho}{dt} = k_b b(t) - k_r \\rho(t) \\\\\n\\frac{db}{dt} = \\frac{1}{\\tau_b} \\left( \\frac{L(t - \\tau_d)/L_0}{\\left(\\rho(t - \\tau_d)/\\rho_0\\right)^\\alpha} - b(t) \\right)\n\\end{cases}\n$$\n\n### 2. 稳态分析\n\n为了分析该系统，我们首先确定其所有时间导数均为零的稳态。\n\n**基线稳态：** 对于 $$t  t_{\\mathrm{change}}$$，载荷比为 $$L/L_0 = 1$$。问题指出系统处于密度为 $$\\rho_0$$ 的基线稳态。我们来验证一下条件。设导数为零，并取 $$\\rho = \\rho_0$$ 和 $$L/L_0=1$$：\n从 $$b(t)$$ 方程，稳态活性 $$b_{ss,0}$$ 为 $$b_{ss,0} = s(\\rho_0) = \\frac{1}{(\\rho_0/\\rho_0)^\\alpha} = 1$$。\n从 $$\\rho(t)$$ 方程，必须有 $$0 = k_b b_{ss,0} - k_r \\rho_0$$。代入 $$b_{ss,0}=1$$，我们得到 $$k_b = k_r \\rho_0$$。这证实了速率常数之间所需的关系，确保了模型的一致性。因此，模拟的初始状态为 $$\\rho(t\\le0) = \\rho_0$$ 和 $$b(t\\le0)=1$$。\n\n**新稳态：** 在 $$t = t_{\\mathrm{change}}$$ 发生载荷变化后，载荷比变为一个新的常数 $$L_1/L_0$$。当 $$t \\to \\infty$$ 时，系统趋近于一个新的稳态 $$\\rho_{\\mathrm{ss}}$$ 和 $$b_{\\mathrm{ss}}$$。在此平衡点：\n$$\n0 = k_b b_{\\mathrm{ss}} - k_r \\rho_{\\mathrm{ss}} \\implies b_{\\mathrm{ss}} = \\frac{k_r \\rho_{\\mathrm{ss}}}{k_b} = \\frac{k_r \\rho_{\\mathrm{ss}}}{k_r \\rho_0} = \\frac{\\rho_{\\mathrm{ss}}}{\\rho_0}\n$$\n并且\n$$\nb_{\\mathrm{ss}} = \\frac{L_1/L_0}{(\\rho_{\\mathrm{ss}}/\\rho_0)^\\alpha}\n$$\n将两个关于 $$b_{\\mathrm{ss}}$$ 的表达式相等：\n$$\n\\frac{\\rho_{\\mathrm{ss}}}{\\rho_0} = \\frac{L_1/L_0}{(\\rho_{\\mathrm{ss}}/\\rho_0)^\\alpha}\n$$\n这得到 $$\\left(\\frac{\\rho_{\\mathrm{ss}}}{\\rho_0}\\right)^{\\alpha+1} = \\frac{L_1}{L_0}$$。解出 $$\\rho_{\\mathrm{ss}}$$，我们找到了目标稳态密度：\n$$\n\\rho_{\\mathrm{ss}} = \\rho_0 \\left( \\frac{L_1}{L_0} \\right)^{\\frac{1}{\\alpha+1}}\n$$\n根据问题要求，该值对于计算超调和检测振荡至关重要。\n\n### 3. 数值模拟方案\n\nDDE系统采用步进法，结合四阶Runge-Kutta（RK4）积分器和固定时间步长 $$\\Delta t$$ 进行数值求解。系统状态由向量 $$\\mathbf{y}(t) = [\\rho(t), b(t)]^T$$ 表示。\n\n对于从 $$t_i$$ 到 $$t_{i+1} = t_i + \\Delta t$$ 的每个积分步，延迟项 $$s(t - \\tau_d)$$ 被视为分段常数，固定为步长开始时的值：$$s(t_i - \\tau_d)$$。这有效地将DDE在该步长期间转换为标准的常微分方程（ODE）。\n\nRK4算法的步骤如下：\n1.  在时间 $$t_i$$，确定延迟状态。延迟时间为 $$t_{d} = t_i - \\tau_d$$。延迟密度 $$\\rho(t_d)$$ 从模拟的存储历史中检索。如果 $$t_d  0$$，则使用基线值 $$\\rho_0$$。延迟载荷 $$L(t_d)/L_0$$ 也根据 $$t_d$$ 是否小于 $$t_{\\mathrm{change}}$$ 来确定。\n2.  计算该步长的恒定延迟刺激：$$s_{delayed} = \\frac{L(t_d)/L_0}{(\\rho(t_d)/\\rho_0)^\\alpha}$$。\n3.  定义该步长的ODE右端函数：$$\\mathbf{f}(\\mathbf{y}) = [k_b b - k_r \\rho, (s_{delayed} - b)/\\tau_b]^T$$。\n4.  使用RK4更新规则计算下一个状态 $$\\mathbf{y}_{i+1}$$：\n    $$\n    \\begin{align*}\n    \\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_i) \\\\\n    \\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_i + \\mathbf{k}_1/2) \\\\\n    \\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_i + \\mathbf{k}_2/2) \\\\\n    \\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_i + \\mathbf{k}_3) \\\\\n    \\mathbf{y}_{i+1} = \\mathbf{y}_i + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n    \\end{align*}\n    $$\n5.  将 $$\\mathbf{y}_{i+1}=[\\rho_{i+1}, b_{i+1}]^T$$ 存储在历史数组中，然后进行下一步。\n\n模拟完成后，分析 $$t \\ge t_{\\mathrm{change}}$$ 时得到的 $$\\rho(t)$$ 轨迹。超调计算为 $$\\max\\{0, \\max(\\rho) - \\rho_{\\mathrm{ss}}\\}/\\rho_{\\mathrm{ss}}$$。通过计算 $$\\rho(t) - \\rho_{\\mathrm{ss}}$$ 的符号变化的次数来检测振荡。如果存在至少两次这样的变化，则认为系统是振荡的。最终的实现封装了这整个过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    test_cases = [\n        # Case A\n        [1.50, 2.00, 0.010, 30.0, 10.0, 1.50, 200.0, 1200.0, 0.25],\n        # Case B\n        [1.20, 2.00, 0.012, 80.0, 60.0, 1.50, 200.0, 1200.0, 0.25],\n        # Case C\n        [1.50, 1.80, 0.010, 50.0, 120.0, 2.00, 200.0, 1200.0, 0.25],\n        # Case D\n        [1.50, 2.00, 0.010, 20.0, 0.0, 1.50, 200.0, 1200.0, 0.25],\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        rho0, alpha, kr, taub, taud, L1_L0, t_change, T, dt = params\n        kb = kr * rho0\n        rho_ss = rho0 * (L1_L0)**(1.0 / (alpha + 1.0))\n        time_points = np.arange(0, T + dt, dt)\n        num_steps = len(time_points)\n        rho_history = np.zeros(num_steps)\n        b_history = np.zeros(num_steps)\n        rho_history[0] = rho0\n        b_history[0] = 1.0\n        delay_steps = int(round(taud / dt))\n\n        for i in range(num_steps - 1):\n            t_current = time_points[i]\n            y_current = np.array([rho_history[i], b_history[i]])\n\n            t_delayed = t_current - taud\n            if t_delayed  t_change:\n                L_delayed_ratio = 1.0\n            else:\n                L_delayed_ratio = L1_L0\n\n            delayed_idx = i - delay_steps\n            if delayed_idx  0:\n                rho_delayed = rho0\n            else:\n                rho_delayed = rho_history[delayed_idx]\n\n            s_delayed = L_delayed_ratio / ((rho_delayed / rho0)**alpha)\n\n            def f(y, s_d):\n                rho, b = y\n                d_rho_dt = kb * b - kr * rho\n                d_b_dt = (s_d - b) / taub\n                return np.array([d_rho_dt, d_b_dt])\n\n            k1 = dt * f(y_current, s_delayed)\n            k2 = dt * f(y_current + 0.5 * k1, s_delayed)\n            k3 = dt * f(y_current + 0.5 * k2, s_delayed)\n            k4 = dt * f(y_current + k3, s_delayed)\n            \n            y_next = y_current + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n            rho_history[i+1], b_history[i+1] = y_next\n\n        change_idx = int(round(t_change / dt))\n        rho_post_change = rho_history[change_idx:]\n        \n        max_rho = np.max(rho_post_change)\n        overshoot = max(0.0, max_rho - rho_ss) / rho_ss\n        \n        diff_from_ss = rho_post_change - rho_ss\n        signs = np.sign(diff_from_ss[np.abs(diff_from_ss) > 1e-9])\n        sign_changes = np.sum(np.diff(signs) != 0)\n        oscillatory = bool(sign_changes >= 2)\n        \n        all_results.append(f\"[{overshoot:.6f},{str(oscillatory).lower()}]\")\n\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}