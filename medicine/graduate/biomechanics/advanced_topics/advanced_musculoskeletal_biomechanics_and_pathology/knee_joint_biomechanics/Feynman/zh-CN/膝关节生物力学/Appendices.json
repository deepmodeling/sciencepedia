{
    "hands_on_practices": [
        {
            "introduction": "本实践旨在介绍一项基本技能：将临床评估——后抽屉试验——转化为一个简化的力学模型。我们将应用静力平衡和线性弹性原理来量化韧带功能，展示生物力学如何为理解关节稳定性提供定量基础。本练习重点将后交叉韧带 (PCL) 建模为线性弹簧，以理解其在抵抗胫骨后移中的作用 。",
            "id": "4185069",
            "problem": "在一个健康成年人膝关节屈曲约 $90^{\\circ}$ 的情况下进行后抽屉试验。胫骨被约束相对于股骨进行纯粹的向后平移，旋转可忽略不计。假设后交叉韧带 (PCL) 是抵抗胫骨后向平移的唯一结构，并且在所考虑的小位移期间，其作用线大致保持笔直，并与胫骨前后轴成 $\\theta$ 角。该试验是准静态进行的，因此惯性效应可以忽略不计。在小应变范围内，PCL 束被建模为一个线性弹性元件，其沿纤维方向具有恒定的小应变刚度 $k_{\\text{PCL}}$。一个大小为 $F_{\\text{post}}$ 的后向力施加于胫骨上。试验期间，PCL 相对于胫骨轴的几何方向可视为固定在 $\\theta=30^{\\circ}$。利用静力平衡和小应变线性弹性的基本原理，根据给定条件确定施加载荷下胫骨的后向平移 $\\delta_{\\text{post}}$：\n- $F_{\\text{post}} = 125$，\n- $k_{\\text{PCL}} = 180$ 每毫米伸长（沿纤维方向），\n- $\\theta = 30^{\\circ}$。\n\n忽略关节囊、半月板、软骨整合性和肌肉协同收缩的贡献。以毫米为单位表示胫骨后向平移 $\\delta_{\\text{post}}$。将答案四舍五入至四位有效数字。以毫米为单位陈述您的最终结果。",
            "solution": "在尝试求解之前，将首先对问题陈述进行严格的验证。\n\n### 步骤 1：提取已知条件\n问题陈述中提供的数据、变量和条件如下：\n- 在约 $90^{\\circ}$ 膝关节屈曲下进行后抽屉试验。\n- 胫骨相对于股骨进行纯粹的向后平移。\n- 旋转运动可忽略不计。\n- 后交叉韧带 (PCL) 是抵抗胫骨后向平移的唯一结构。\n- PCL 的作用线是笔直的，并与胫骨前后轴成 $\\theta$ 角。\n- 位移很小，方向角 $\\theta$ 可视为固定不变。\n- 试验是准静态进行的（惯性效应可忽略不计）。\n- PCL 在小应变范围内被建模为线性弹性元件。\n- PCL 沿其纤维方向具有恒定的小应变刚度 $k_{\\text{PCL}}$。\n- 一个大小为 $F_{\\text{post}}$ 的外部后向力施加于胫骨上。\n- 给定角度值：$\\theta = 30^{\\circ}$。\n- 给定施加力的大小：$F_{\\text{post}} = 125$。单位没有明确说明，但从刚度单位的上下文中推断为牛顿 (N)。\n- 给定 PCL 刚度值：$k_{\\text{PCL}} = 180$ 每毫米伸长。这对应于 N/mm 单位。\n- 胫骨后向平移 $\\delta_{\\text{post}}$ 的最终结果应以毫米 (mm) 为单位，并四舍五入到四位有效数字。\n- 其他特定解剖结构的贡献将被忽略。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据：** 该问题坚实地基于静力学和线性弹性原理，这些是入门生物力学分析的标准工具。PCL 确实是抵抗胫骨后向平移的主要约束结构，将其建模为小位移下的线性弹簧是一种常见且有效的简化。所提供的力（$125$ N）、刚度（$180$ N/mm）和角度（$30^{\\circ}$）的数值在此情景下是生理学上合理的。\n- **适定性：** 该问题是适定的。它提供了一个明确的目标（计算 $\\delta_{\\text{post}}$）和足够的信息来获得一个唯一、稳定的解。这些假设（例如，PCL 是唯一的抵抗结构、纯平移、准静态条件）适当地简化了系统，使其变得可确定。\n- **客观性：** 问题以精确、客观的语言陈述，没有主观或基于意见的主张。\n- **完整性与一致性：** 问题设定是自洽的。给定的参数足以进行计算。隐含的单位（力的单位 N，刚度的单位 N/mm）与期望的输出单位（位移的单位 mm）一致。没有矛盾之处。\n- **现实性与可行性：** 虽然这是对复杂的体内真实情况的简化，但该模型是用于教育和研究目的的标准且科学合理的理想化模型。它不违反物理定律，也不需要不可行的条件。\n\n### 步骤 3：结论与行动\n该问题被认为是 **有效的**，因为它具有科学依据、适定且内部一致。现在将从基本原理推导出解答。\n\n该问题要求确定在后向力 $F_{\\text{post}}$ 作用下胫骨的后向平移 $\\delta_{\\text{post}}$。系统处于准静态平衡状态，意味着作用在胫骨上的合力为零。施加的后向力被 PCL 产生的恢复力所平衡。\n\n让我们定义一个坐标系，其中沿胫骨轴的后向为 x 轴正方向。施加的力是一个矢量 $\\mathbf{F}_{\\text{post}} = F_{\\text{post}} \\mathbf{\\hat{i}}$。PCL 相对于此轴的方向角为 $\\theta$。PCL 施加在胫骨上的力 $\\mathbf{F}_{\\text{PCL}}$ 是一个沿着韧带纤维方向的拉力，抵抗拉伸。因此，它有一个分量作用于前向（x 轴负方向）。\n\n在前后方向上的静力平衡方程为：\n$$ \\sum F_x = 0 $$\n$$ F_{\\text{post}} - F_{\\text{PCL,x}} = 0 $$\n其中 $F_{\\text{PCL,x}}$ 是 PCL 力沿后向轴的分量。PCL 总力的大小为 $F_{\\text{PCL}}$。其抵抗后抽屉的分量为 $F_{\\text{PCL,x}} = F_{\\text{PCL}} \\cos(\\theta)$。将此代入平衡方程，得到：\n$$ F_{\\text{post}} = F_{\\text{PCL}} \\cos(\\theta) \\quad (1) $$\n\nPCL 被建模为刚度为 $k_{\\text{PCL}}$ 的线性弹性元件（一个弹簧）。PCL 中的力的大小由其本构定律决定，这类似于 Hooke's Law：\n$$ F_{\\text{PCL}} = k_{\\text{PCL}} \\cdot \\delta_{\\text{PCL}} \\quad (2) $$\n其中 $\\delta_{\\text{PCL}}$ 是 PCL 沿其纤维方向的伸长量。\n\n接下来，我们必须建立胫骨后向平移 $\\delta_{\\text{post}}$ 和 PCL 伸长量 $\\delta_{\\text{PCL}}$ 之间的运动学关系。问题陈述，胫骨的运动是大小为 $\\delta_{\\text{post}}$ 的纯粹后向平移。对于小位移，PCL 的伸长量是胫骨平移矢量在 PCL 作用线上的投影。\n平移矢量为 $\\mathbf{\\delta} = \\delta_{\\text{post}} \\mathbf{\\hat{i}}$。沿 PCL 方向的单位矢量为 $\\mathbf{u}_{\\text{PCL}}$，它与 x 轴成 $\\theta$ 角。伸长量是标量投影：\n$$ \\delta_{\\text{PCL}} = \\mathbf{\\delta} \\cdot \\mathbf{u}_{\\text{PCL}} = |\\mathbf{\\delta}| |\\mathbf{u}_{\\text{PCL}}| \\cos(\\theta) $$\n由于 $|\\mathbf{\\delta}| = \\delta_{\\text{post}}$ 且 $|\\mathbf{u}_{\\text{PCL}}| = 1$，上式可简化为：\n$$ \\delta_{\\text{PCL}} = \\delta_{\\text{post}} \\cos(\\theta) \\quad (3) $$\n\n我们现在有一个包含三个方程的方程组。我们可以通过代入法求解 $\\delta_{\\text{post}}$。\n将方程 (3) 代入方程 (2)：\n$$ F_{\\text{PCL}} = k_{\\text{PCL}} (\\delta_{\\text{post}} \\cos(\\theta)) $$\n现在，将这个 $F_{\\text{PCL}}$ 的表达式代入方程 (1)：\n$$ F_{\\text{post}} = (k_{\\text{PCL}} \\delta_{\\text{post}} \\cos(\\theta)) \\cos(\\theta) $$\n$$ F_{\\text{post}} = k_{\\text{PCL}} \\delta_{\\text{post}} \\cos^2(\\theta) $$\n\n我们现在可以分离出 $\\delta_{\\text{post}}$，得到最终的符号表达式：\n$$ \\delta_{\\text{post}} = \\frac{F_{\\text{post}}}{k_{\\text{PCL}} \\cos^2(\\theta)} $$\n\n现在，我们代入给定的数值：\n- $F_{\\text{post}} = 125$\n- $k_{\\text{PCL}} = 180$\n- $\\theta = 30^{\\circ}$\n\n$\\cos(30^{\\circ})$ 的值为 $\\frac{\\sqrt{3}}{2}$。因此，$\\cos^2(30^{\\circ}) = \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = \\frac{3}{4} = 0.75$。\n\n将这些值代入 $\\delta_{\\text{post}}$ 的表达式中：\n$$ \\delta_{\\text{post}} = \\frac{125}{180 \\cdot \\left(\\frac{3}{4}\\right)} = \\frac{125}{180 \\cdot 0.75} = \\frac{125}{135} $$\n为了简化分数：\n$$ \\delta_{\\text{post}} = \\frac{5 \\cdot 25}{5 \\cdot 27} = \\frac{25}{27} \\text{ mm} $$\n\n计算数值：\n$$ \\delta_{\\text{post}} \\approx 0.9259259... \\text{ mm} $$\n\n问题要求答案四舍五入到四位有效数字。\n$$ \\delta_{\\text{post}} \\approx 0.9259 \\text{ mm} $$\n这就是在指定条件下计算出的胫骨后向平移量。",
            "answer": "$$\n\\boxed{0.9259}\n$$"
        },
        {
            "introduction": "从单个部件的功能分析，我们现在转向关节在运动中的整体功能。本练习探讨行走过程中的外部膝关节内收力矩 ($M_{\\text{add}}$) 的概念。通过分析额状面力线（膝内翻畸形）如何改变地面反作用力的力臂，我们可以量化一个与膝骨关节炎进展相关的关键力学因素 。本实践将刚体力学原理应用于步态分析中一个常见的临床和研究场景。",
            "id": "4185016",
            "problem": "一名受试者在站立中期行走，其地面反作用力（GRF）主要为垂直方向。考虑在膝内翻（varus alignment）情况下，膝关节和胫骨在额状面（frontal-plane）的几何结构。采用右手坐标系，其中内-外侧轴为 $x$ 轴，外侧为正，内侧为负。假设地面反作用力（GRF）通过足底的压力中心（COP）垂直作用。在中立对线（neutral alignment）时，膝关节中心位于踝关节中心的正上方（$x_{\\text{knee},0} = 0$），压力中心（COP）位于踝关节中心外侧 $x_{\\text{COP},0} = 15\\,\\text{mm}$ 处。在膝内翻对线时，胫骨机械轴相对于垂直方向形成一个 $\\alpha = 6^\\circ$（度）的角度，由于胫骨的几何形状，膝关节中心向内侧移动。从踝关节中心到膝关节中心的胫骨段长度为 $L = 0.44\\,\\text{m}$。压力中心（COP）随着膝内翻而向外侧移动，其关系遵循 $k = 1.5\\,\\text{mm}/\\text{deg}$，因此 $x_{\\text{COP}}(\\alpha) = x_{\\text{COP},0} + k\\,\\alpha$。\n\n设受试者的体重为 $m = 78\\,\\text{kg}$。在站立中期，垂直地面反作用力的大小近似为 $F_{y} = 1.1\\,m\\,g$，其中 $g = 9.81\\,\\text{m}/\\text{s}^2$。将地面反作用力视为垂直力，并忽略其水平分量。定义外部膝内收力矩（external knee adduction moment）的大小 $M_{\\text{add}}$ 为垂直地面反作用力的大小与膝关节中心和地面反作用力作用线（通过压力中心）之间的额状面垂直距离的乘积。计算从“中立对线”到“膝内翻对线”状态下 $M_{\\text{add}}$ 的变化量，$\\Delta M_{\\text{add}} = M_{\\text{add}}(\\alpha) - M_{\\text{add}}(0)$。\n\n以牛顿·米（N·m）为单位表示最终答案，并四舍五入至三位有效数字。按规定使用度作为角度单位。",
            "solution": "对用户提供的问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 坐标系：右手系，$x$ 轴为内-外侧轴，外侧为正。\n- 地面反作用力（GRF）是垂直的，通过压力中心（COP）作用。\n- 中立对线条件（$\\alpha = 0$）：膝关节中心位于 $x_{\\text{knee},0} = 0$。\n- 中立压力中心位置：$x_{\\text{COP},0} = 15\\,\\text{mm}$。\n- 膝内翻角度：$\\alpha = 6^\\circ$。\n- 胫骨段长度：$L = 0.44\\,\\text{m}$。\n- 压力中心随膝内翻呈线性移动：$x_{\\text{COP}}(\\alpha) = x_{\\text{COP},0} + k\\,\\alpha$。\n- 压力中心移动系数：$k = 1.5\\,\\text{mm}/\\text{deg}$。\n- 受试者体重：$m = 78\\,\\text{kg}$。\n- 垂直地面反作用力大小：$F_{y} = 1.1\\,m\\,g$。\n- 重力加速度：$g = 9.81\\,\\text{m}/\\text{s}^2$。\n- 外部膝内收力矩的定义：$M_{\\text{add}} = (\\text{垂直地面反作用力大小}) \\times (\\text{膝关节中心与地面反作用力作用线之间的额状面垂直距离})$。\n- 目标：计算膝内收力矩的变化量，$\\Delta M_{\\text{add}} = M_{\\text{add}}(\\alpha) - M_{\\text{add}}(0)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于生物力学和刚体力学的原理。所有概念，如地面反作用力、压力中心、膝内翻和膝内收力矩，都是步态分析（gait analysis）中的标准概念。给定的质量、胫骨长度、地面反作用力大小和膝内翻角度在生理上是现实的。该问题提法得当（well-posed），提供了得出唯一解所需的所有定义、常数和关系。语言客观而精确。问题设定是自洽的，没有矛盾。\n\n### 步骤 3：结论与行动\n该问题被认定为有效。将推导解答。\n\n外部膝内收力矩 $M_{\\text{add}}$ 定义为垂直地面反作用力 $F_y$ 与其绕膝关节中心的垂直力臂 $d$ 的乘积。\n$$M_{\\text{add}} = F_y \\cdot d$$\n力臂 $d$ 是压力中心（$x_{\\text{COP}}$）的内-外侧位置与膝关节中心（$x_{\\text{knee}}$）的内-外侧位置之差的绝对值。\n$$d = |x_{\\text{COP}} - x_{\\text{knee}}|$$\n我们需要计算该力矩从中立对线到膝内翻对线的变化量：$\\Delta M_{\\text{add}} = M_{\\text{add}}(\\alpha) - M_{\\text{add}}(0)$。\n\n首先，我们分析中立对线条件，此时膝内翻角度为 $\\alpha = 0^\\circ$。\n膝关节中心位于其中立位置，$x_{\\text{knee}}(0) = x_{\\text{knee},0} = 0$。\n压力中心位于其中立位置，$x_{\\text{COP}}(0) = x_{\\text{COP},0} = 15\\,\\text{mm} = 0.015\\,\\text{m}$。\n在中立条件下的力臂为：\n$$d(0) = |x_{\\text{COP}}(0) - x_{\\text{knee}}(0)| = |x_{\\text{COP},0} - 0| = x_{\\text{COP},0}$$\n在中立条件下的膝内收力矩为：\n$$M_{\\text{add}}(0) = F_y \\cdot d(0) = F_y \\cdot x_{\\text{COP},0}$$\n\n接下来，我们分析膝内翻对线条件，此时角度为 $\\alpha = 6^\\circ$。\n膝关节中心的位置 $x_{\\text{knee}}(\\alpha)$ 因胫骨的角度而改变。假设踝关节是位于 $x=0$ 处的枢轴点，长度为 $L$ 的胫骨段末端的膝关节中心向内侧（负 $x$ 方向）移动。利用三角学，该位移为：\n$$x_{\\text{knee}}(\\alpha) = -L \\sin(\\alpha)$$\n压力中心的位置 $x_{\\text{COP}}(\\alpha)$ 根据给定的线性关系向外侧移动：\n$$x_{\\text{COP}}(\\alpha) = x_{\\text{COP},0} + k\\,\\alpha$$\n在膝内翻条件下的力臂为：\n$$d(\\alpha) = |x_{\\text{COP}}(\\alpha) - x_{\\text{knee}}(\\alpha)| = |(x_{\\text{COP},0} + k\\alpha) - (-L\\sin(\\alpha))|$$\n$$d(\\alpha) = |x_{\\text{COP},0} + k\\alpha + L\\sin(\\alpha)|$$\n由于所有给定参数（$x_{\\text{COP},0}$、$k$、$\\alpha$、$L$）均为正，绝对值内的表达式为正。\n$$d(\\alpha) = x_{\\text{COP},0} + k\\alpha + L\\sin(\\alpha)$$\n在膝内翻条件下的膝内收力矩为：\n$$M_{\\text{add}}(\\alpha) = F_y \\cdot d(\\alpha) = F_y (x_{\\text{COP},0} + k\\alpha + L\\sin(\\alpha))$$\n\n现在我们可以计算变化量 $\\Delta M_{\\text{add}}$：\n$$\\Delta M_{\\text{add}} = M_{\\text{add}}(\\alpha) - M_{\\text{add}}(0)$$\n$$\\Delta M_{\\text{add}} = F_y (x_{\\text{COP},0} + k\\alpha + L\\sin(\\alpha)) - F_y (x_{\\text{COP},0})$$\n$$\\Delta M_{\\text{add}} = F_y (k\\alpha + L\\sin(\\alpha))$$\n\n我们进行数值计算。首先，我们计算垂直地面反作用力的大小 $F_y$：\n$$F_y = 1.1 \\cdot m \\cdot g$$\n给定 $m = 78\\,\\text{kg}$ 和 $g = 9.81\\,\\text{m}/\\text{s}^2$：\n$$F_y = 1.1 \\cdot 78\\,\\text{kg} \\cdot 9.81\\,\\text{m}/\\text{s}^2 = 841.038\\,\\text{N}$$\n\n接下来，我们计算力臂的变化量 $\\Delta d = k\\alpha + L\\sin(\\alpha)$。我们必须注意单位的统一。\n参数 $k$ 的值为 $1.5\\,\\text{mm}/\\text{deg}$，我们将其转换为米/度：$k = 0.0015\\,\\text{m}/\\text{deg}$。角度 $\\alpha$ 的值为 $6^\\circ$。\n第一项是：\n$$k\\alpha = (0.0015\\,\\text{m}/\\text{deg}) \\cdot (6\\,\\text{deg}) = 0.009\\,\\text{m}$$\n对于第二项 $L\\sin(\\alpha)$，三角函数 $\\sin(\\alpha)$ 要求角度以弧度为单位。胫骨长度为 $L = 0.44\\,\\text{m}$。\n$$\\alpha_{\\text{rad}} = 6^\\circ \\cdot \\frac{\\pi}{180^\\circ} \\text{ rad}$$\n第二项是：\n$$L\\sin(\\alpha) = 0.44\\,\\text{m} \\cdot \\sin\\left(6^\\circ\\right) \\approx 0.44\\,\\text{m} \\cdot 0.10452846 = 0.04599252\\,\\text{m}$$\n力臂的总变化量为：\n$$\\Delta d = 0.009\\,\\text{m} + 0.04599252\\,\\text{m} = 0.05499252\\,\\text{m}$$\n\n最后，我们计算内收力矩的变化量：\n$$\\Delta M_{\\text{add}} = F_y \\cdot \\Delta d = 841.038\\,\\text{N} \\cdot 0.05499252\\,\\text{m} \\approx 46.2505\\,\\text{N}\\cdot\\text{m}$$\n按要求将结果四舍五入至三位有效数字，得到 $46.3\\,\\text{N}\\cdot\\text{m}$。",
            "answer": "$$\\boxed{46.3}$$"
        },
        {
            "introduction": "这项高级实践将解析理论与计算方法相结合，以模拟股骨胫骨接触面的复杂环境。我们将使用赫兹接触理论来预测压力分布，然后建立半月板环向应力模型，这是其承重功能的关键机制。本练习的高潮在于根据假设的实验数据验证模型，这是现代生物力学研究和医疗设备设计的核心技能 。",
            "id": "4185047",
            "problem": "考虑一个静力、轴对称的胫骨-股骨接触问题，该问题代表单个股骨髁在半月板的支撑下，被压缩到胫骨平台软骨上。其目标是计算在载荷作用下，胫骨表面上物理上合理的接触压力分布，以及由于载荷分担，半月板环内的环向（环状）应力分布。您必须使用均方根误差 (RMSE) 和皮尔逊相关系数，根据所提供的实验压力传感器读数来验证预测的接触压力分布。您的推导和算法必须从力学的第一性原理出发：即针对球面在弹性半空间上的小应变、各向同性、无摩擦接触的静力平衡、运动学和线性弹性理论。将半月板视为一个厚度呈线性变化的、薄的、弯曲的、环向纤维增强的环状体。\n\n假设与建模要求：\n- 股骨髁被建模为半径为 $R$ 的球体，与代表胫骨软骨的名义上平坦的弹性半空间进行无摩擦、轴对称的法向接触。总施加压缩载荷为 $W$。接触对的有效弹性模量为 $E^\\ast$（对于两个各向同性弹性体，其定义为 $1/E^\\ast = (1 - \\nu_1^2)/E_1 + (1 - \\nu_2^2)/E_2$，其中 $E_i$ 和 $\\nu_i$ 分别是杨氏模量和泊松比）。\n- 接触是小应变、线性和无摩擦的。静力平衡约束要求接触压力在接触区域上的积分等于施加的载荷 $W$。\n- 半月板的载荷分担被建模为一个占据半径 $r \\in [r_\\mathrm{in}, r_\\mathrm{out}]$ 的环形区域，其中 $r_\\mathrm{in} = \\beta a$ 且 $r_\\mathrm{out} = a$，$a$ 是接触半径，$0  \\beta  1$。在此环形区域内，局部接触压力的一部分（比例为 $\\alpha$）由半月板承担（剩余部分由软骨直接承担）。在该环形区域之外，半月板不承担任何载荷。半月板的厚度从 $r_\\mathrm{in}$ 处的 $t_\\mathrm{in}$ 线性变化到 $r_\\mathrm{out}$ 处的 $t_\\mathrm{out}$。\n- 半月板被视为一个在局部径向压缩下处于膜平衡状态的薄环，因此环向应力取决于局部压力、半径和厚度。\n- 通过将给定实验传感器半径处的预测接触压力与提供的传感器读数进行比较来进行验证。计算预测压力和实验压力之间的 RMSE 和皮尔逊相关系数。\n\n计算要求：\n- 从上述第一性原理出发，推导出轴对称接触半径 $a$ 和相应的径向相关压力分布 $p(r)$，并确保静力平衡。推导环形区域内半月板环向应力 $\\sigma_\\theta(r)$ 的一个物理上一致的表达式，该表达式用局部半月板压力 $p_m(r)$、$r$ 和 $t(r)$ 表示。\n- 实现一个算法，该算法：\n  1. 根据给定的 $W$、$R$ 和 $E^\\ast$ 计算 $a$ 和 $p(r)$。\n  2. 在指定的传感器半径处评估 $p(r)$，并根据提供的实验压力计算 RMSE 和皮尔逊相关性。\n  3. 通过将环形区域用至少 $N = 100$ 个均匀间隔的径向样本进行离散化，并利用线性厚度变化，来计算最大半月板环向应力 $\\max_{r \\in [r_\\mathrm{in}, r_\\mathrm{out}]} \\sigma_\\theta(r)$。\n- 所有用于报告的压力和应力必须以兆帕 (MPa) 为单位表示。传感器角度不使用；半径以米 (m) 为单位。计算相关系数时，应将其报告为无量纲小数。RMSE 必须以 MPa 为单位报告，并由编程语言的默认浮点表示法进行四舍五入。\n- 您的程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身必须是一个由方括号括起来的、包含三个浮点数的逗号分隔列表，其顺序为 $[\\text{RMSE in MPa}, \\text{Correlation (decimal)}, \\text{Maximum meniscal hoop stress in MPa}]$（[RMSE（MPa），相关性（小数），最大半月板环状应力（MPa）]）。例如，最终输出格式应类似于 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$，不含任何附加文本。\n\n测试套件（三个独立的案例，涵盖典型、中等和高刚度/高载荷场景）：\n\n案例1（典型载荷和刚度）：\n- 施加载荷 $W = 1200$ N，股骨半径 $R = 0.025$ m，有效模量 $E^\\ast = 15{,}000{,}000$ Pa。\n- 半月板环带分数 $\\beta = 0.7$，因此 $r_\\mathrm{in} = 0.7 a$, $r_\\mathrm{out} = a$，半月板载荷分数 $\\alpha = 0.6$，厚度 $t_\\mathrm{in} = 0.004$ m, $t_\\mathrm{out} = 0.006$ m。\n- 实验传感器半径 (m)：$[0.0, 0.003, 0.006, 0.0095, 0.0105]$。\n- 实验传感器压力 (MPa)：$[4.30, 4.28, 3.61, 2.51, 1.71]$。\n\n案例2（中等载荷与不同几何形状）：\n- 施加载荷 $W = 600$ N，股骨半径 $R = 0.030$ m，有效模量 $E^\\ast = 12{,}000{,}000$ Pa。\n- 半月板环带分数 $\\beta = 0.7$，因此 $r_\\mathrm{in} = 0.7 a$, $r_\\mathrm{out} = a$，半月板载荷分数 $\\alpha = 0.5$，厚度 $t_\\mathrm{in} = 0.0035$ m, $t_\\mathrm{out} = 0.0055$ m。\n- 实验传感器半径 (m)：$[0.0, 0.0025, 0.005, 0.008, 0.0095]$。\n- 实验传感器压力 (MPa)：$[2.68, 2.67, 2.32, 1.77, 1.00]$。\n\n案例3（高刚度软骨和高载荷，边界情况）：\n- 施加载荷 $W = 1800$ N，股骨半径 $R = 0.020$ m，有效模量 $E^\\ast = 40{,}000{,}000$ Pa。\n- 半月板环带分数 $\\beta = 0.7$，因此 $r_\\mathrm{in} = 0.7 a$, $r_\\mathrm{out} = a$，半月板载荷分数 $\\alpha = 0.7$，厚度 $t_\\mathrm{in} = 0.005$ m, $t_\\mathrm{out} = 0.007$ m。\n- 实验传感器半径 (m)：$[0.0, 0.002, 0.004, 0.0075, 0.0086]$。\n- 实验传感器压力 (MPa)：$[11.20, 10.70, 10.08, 5.72, 2.38]$。\n\n您的程序必须实现上述推导和计算，使用提供的测试套件，并严格按照 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$ 的格式生成单行输出，其中 $x_i$ 是测试案例 $i$ 的 RMSE（MPa），$y_i$ 是皮尔逊相关系数（小数），$z_i$ 是最大半月板环状应力（MPa）。",
            "solution": "该问题要求推导并实现一个用于胫骨-股骨接触的生物力学模型，其中包括半月板的载荷分担。该模型对接触压力的预测需要根据实验数据进行验证，并且必须计算出最大半月板环状应力。解决方案分三个阶段进行：首先，基于接触力学和平衡原理推导控制方程；其次，制定验证指标；第三，详述一个计算算法，用于求解给定测试案例中的所需物理量。\n\n### 1. 用于压力分布的赫兹接触模型\n\n该问题将股骨髁建模为半径为 $R$ 的球体，压在被理想化为平坦弹性半空间的胫骨平台上。对于在法向载荷 $W$ 下的无摩擦、非粘附和静态接触，所产生的接触压力分布由赫兹理论描述。该理论建立在小应变线性弹性原理之上。\n\n接触区域是一个半径为 $a$ 的圆形。该圆形上的压力分布 $p(r)$（其中 $r$ 是距接触中心的径向距离）呈半椭球形：\n$$\np(r) = p_0 \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2} \\quad \\text{for } r \\le a\n$$\n对于 $r  a$，$p(r) = 0$。这里，$p_0$ 是接触中心（$r=0$）处的峰值压力。\n\n为满足静力平衡，接触压力在整个接触区域上的积分必须等于总施加压缩载荷 $W$。\n$$\nW = \\int_{A} p(r) \\, dA = \\int_0^{2\\pi} \\int_0^a p_0 \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2} \\, r \\, dr \\, d\\theta\n$$\n计算该积分可得出载荷 $W$、峰值压力 $p_0$ 和接触半径 $a$ 之间的关系：\n$$\nW = 2\\pi p_0 \\int_0^a r \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2} \\, dr = 2\\pi p_0 \\left[-\\frac{a^2}{3} \\left(1 - \\frac{r^2}{a^2}\\right)^{3/2}\\right]_0^a = \\frac{2}{3}\\pi p_0 a^2\n$$\n由此，峰值压力可表示为 $p_0 = \\frac{3W}{2\\pi a^2}$。\n\n赫兹接触理论提供了一个根据材料属性和几何形状直接计算接触半径 $a$ 的公式：\n$$\na = \\left( \\frac{3WR}{4E^*} \\right)^{1/3}\n$$\n其中 $E^*$ 是接触对的有效弹性模量。由此，整个压力分布得以确定。该分布代表总压力，随后将在软骨和半月板之间进行分配。\n\n### 2. 半月板环状应力计算\n\n半月板被建模为一个占据径向域 $r \\in [r_\\mathrm{in}, r_\\mathrm{out}]$ 的环形区域，其中 $r_\\mathrm{in} = \\beta a$ 且 $r_\\mathrm{out} = a$。在此环形区域内，假定总局部接触压力 $p(r)$ 的一部分（比例为 $\\alpha$）传递给半月板。此半月板压力记为 $p_m(r)$：\n$$\np_m(r) = \\alpha \\cdot p(r) \\quad \\text{for } r \\in [\\beta a, a]\n$$\n问题陈述，半月板是在“局部径向压缩”下处于膜平衡状态的薄环。这是生物力学中常见的建模简化，其中假设作用在锥形半月板上的垂直压力会产生一个径向力，该力随后由环向（环状）张力平衡。对于半径为 $r$、厚度为 $t$、在有效径向压力 $P_{rad}$ 作用下的受压薄壁环，其环状应力 $\\sigma_\\theta$ 的标准公式为：\n$$\n\\sigma_\\theta(r) = \\frac{P_{rad}(r) \\cdot r}{t(r)}\n$$\n根据问题的意图，我们将有效径向压力建模为等于作用在半月板上的局部垂直压力，即 $P_{rad}(r) = p_m(r)$。因此，环状应力为：\n$$\n\\sigma_\\theta(r) = \\frac{p_m(r) \\cdot r}{t(r)} = \\frac{\\alpha \\cdot p(r) \\cdot r}{t(r)}\n$$\n半月板的厚度 $t(r)$ 从 $r_\\mathrm{in}$ 处的 $t_\\mathrm{in}$ 线性变化到 $r_\\mathrm{out}$ 处的 $t_\\mathrm{out}$。这种线性变化的方程为：\n$$\nt(r) = t_\\mathrm{in} + (t_\\mathrm{out} - t_\\mathrm{in}) \\frac{r - r_\\mathrm{in}}{r_\\mathrm{out} - r_\\mathrm{in}} = t_\\mathrm{in} + \\frac{t_\\mathrm{out} - t_\\mathrm{in}}{a(1-\\beta)}(r - \\beta a)\n$$\n为了找到最大环状应力 $\\max(\\sigma_\\theta(r))$，我们必须在环形区域 $r \\in [\\beta a, a]$ 上计算该表达式的值，并找到其最大值。由于该表达式的复杂性，在径向域的精细离散化上进行数值搜索是最稳健的方法。\n\n### 3. 验证指标\n\n预测的接触压力分布 $p(r)$ 将根据一组实验测量值 $(r_{\\text{exp},i}, p_{\\text{exp},i})$ 进行验证。需要两个指标：均方根误差 (RMSE) 和皮尔逊相关系数。\n\n首先计算每个实验传感器半径处的预测压力 $p_{\\text{pred},i} = p(r_{\\text{exp},i})$。\n\nRMSE 用于衡量误差的平均大小，其计算公式为：\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{N_{\\text{exp}}} \\sum_{i=1}^{N_{\\text{exp}}} (p_{\\text{pred},i} - p_{\\text{exp},i})^2}\n$$\n其中 $N_{\\text{exp}}$ 是实验数据点的数量。\n\n皮尔逊相关系数 $r_p$ 用于衡量预测值和实验值之间的线性相关性。其定义为：\n$$\nr_p = \\frac{\\sum_{i=1}^{N_{\\text{exp}}} (p_{\\text{pred},i} - \\bar{p}_{\\text{pred}})(p_{\\text{exp},i} - \\bar{p}_{\\text{exp}})}{\\sqrt{\\sum_{i=1}^{N_{\\text{exp}}} (p_{\\text{pred},i} - \\bar{p}_{\\text{pred}})^2 \\sum_{i=1}^{N_{\\text{exp}}} (p_{\\text{exp},i} - \\bar{p}_{\\text{exp}})^2}}\n$$\n其中 $\\bar{p}_{\\text{pred}}$ 和 $\\bar{p}_{\\text{exp}}$ 分别是预测压力和实验压力的平均值。\n\n### 4. 计算算法\n\n对于每个测试案例，执行以下步骤：\n1.  根据输入 $W$、$R$ 和 $E^*$，计算赫兹接触半径 $a = (3WR / (4E^*))^{1/3}$。\n2.  计算峰值接触压力 $p_0 = 3W / (2\\pi a^2)$。\n3.  定义压力函数 $p(r) = p_0 \\sqrt{1 - (r/a)^2}$（对于 $r \\le a$）和 $p(r)=0$（对于 $r  a$）。\n4.  对于给定的实验传感器半径向量 $r_{\\text{exp}}$，使用函数 $p(r)$ 计算相应的预测压力向量 $p_{\\text{pred}}$。通过除以 $10^6$ 将这些压力从帕斯卡 (Pa) 转换为兆帕 (MPa)。\n5.  计算预测压力 $p_{\\text{pred}}$ 和给定实验压力 $p_{\\text{exp}}$ 之间的 RMSE（单位为 MPa）。\n6.  计算 $p_{\\text{pred}}$ 和 $p_{\\text{exp}}$ 之间的皮尔逊相关系数 $r_p$。\n7.  定义半月板环形区域半径：$r_\\mathrm{in} = \\beta a$ 和 $r_\\mathrm{out} = a$。\n8.  创建一个至少包含 $N=100$ 个径向点 $r_j$ 的离散网格，该网格跨越区间 $[r_\\mathrm{in}, r_\\mathrm{out}]$。\n9.  对于此网格上的每个点 $r_j$：\n    a. 使用线性插值公式计算局部半月板厚度 $t(r_j)$。\n    b. 计算局部环状应力 $\\sigma_\\theta(r_j) = (\\alpha \\cdot p(r_j) \\cdot r_j) / t(r_j)$。\n10. 在所有计算出的 $\\sigma_\\theta(r_j)$ 值中找到最大值。将此最大应力从 Pa 转换为 MPa。\n11. 为当前测试案例整理三个结果（RMSE、相关性、最大环状应力）。\n12. 对所有测试案例重复此过程，并按规定格式化最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import pearsonr\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final result.\n    \"\"\"\n    # Test suite from the problem statement.\n    test_cases = [\n        {\n            \"W\": 1200, \"R\": 0.025, \"E_star\": 15000000,\n            \"beta\": 0.7, \"alpha\": 0.6, \"t_in\": 0.004, \"t_out\": 0.006,\n            \"sensor_radii\": np.array([0.0, 0.003, 0.006, 0.0095, 0.0105]),\n            \"sensor_pressures\": np.array([4.30, 4.28, 3.61, 2.51, 1.71])\n        },\n        {\n            \"W\": 600, \"R\": 0.030, \"E_star\": 12000000,\n            \"beta\": 0.7, \"alpha\": 0.5, \"t_in\": 0.0035, \"t_out\": 0.0055,\n            \"sensor_radii\": np.array([0.0, 0.0025, 0.005, 0.008, 0.0095]),\n            \"sensor_pressures\": np.array([2.68, 2.67, 2.32, 1.77, 1.00])\n        },\n        {\n            \"W\": 1800, \"R\": 0.020, \"E_star\": 40000000,\n            \"beta\": 0.7, \"alpha\": 0.7, \"t_in\": 0.005, \"t_out\": 0.007,\n            \"sensor_radii\": np.array([0.0, 0.002, 0.004, 0.0075, 0.0086]),\n            \"sensor_pressures\": np.array([11.20, 10.70, 10.08, 5.72, 2.38])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(case)\n        results.append(result)\n\n    # Format the final output string exactly as required.\n    formatted_results = []\n    for res in results:\n        formatted_results.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _solve_case(case_data):\n    \"\"\"\n    Solves a single instance of the tibiofemoral contact problem.\n    \"\"\"\n    # Extract parameters from case data\n    W = case_data[\"W\"]\n    R = case_data[\"R\"]\n    E_star = case_data[\"E_star\"]\n    beta = case_data[\"beta\"]\n    alpha = case_data[\"alpha\"]\n    t_in = case_data[\"t_in\"]\n    t_out = case_data[\"t_out\"]\n    sensor_radii = case_data[\"sensor_radii\"]\n    sensor_pressures_mpa = case_data[\"sensor_pressures\"]\n\n    # 1. Hertzian Contact Calculation (all in SI units: m, N, Pa)\n    a = ((3 * W * R) / (4 * E_star))**(1/3)\n    p0 = (3 * W) / (2 * np.pi * a**2)\n\n    def p_hertz(r, p0_val, a_val):\n        \"\"\"Calculates Hertzian pressure at given radii.\"\"\"\n        # Use np.where for vectorized computation\n        pressure = np.where(r = a_val, p0_val * np.sqrt(1 - (r / a_val)**2), 0.0)\n        return pressure\n\n    # 2. Validation Against Experimental Data\n    predicted_pressures_pa = p_hertz(sensor_radii, p0, a)\n    predicted_pressures_mpa = predicted_pressures_pa / 1e6\n    \n    # Compute RMSE\n    rmse = np.sqrt(np.mean((predicted_pressures_mpa - sensor_pressures_mpa)**2))\n    \n    # Compute Pearson Correlation Coefficient\n    # pearsonr returns (coefficient, p-value)\n    correlation, _ = pearsonr(predicted_pressures_mpa, sensor_pressures_mpa)\n\n    # 3. Meniscal Hoop Stress Calculation\n    r_in = beta * a\n    r_out = a\n    \n    # Discretize the meniscus annulus with N samples\n    N = 200\n    r_meniscus = np.linspace(r_in, r_out, N)\n    \n    # Meniscus thickness function t(r)\n    # Avoid division by zero if r_in == r_out, although beta  1 prevents this.\n    if np.isclose(r_out, r_in):\n        t_meniscus = np.full_like(r_meniscus, t_in)\n    else:\n        m = (t_out - t_in) / (r_out - r_in)\n        t_meniscus = t_in + m * (r_meniscus - r_in)\n\n    # Pressure on the meniscus (Pa)\n    p_on_meniscus_pa = alpha * p_hertz(r_meniscus, p0, a)\n    \n    # Circumferential (hoop) stress sigma_theta(r)\n    # Avoid division by zero if t_meniscus is zero for some reason\n    sigma_theta_pa = np.divide(p_on_meniscus_pa * r_meniscus, t_meniscus, \n                               out=np.zeros_like(t_meniscus), where=t_meniscus!=0)\n\n    # Maximum hoop stress in MPa\n    max_sigma_theta_mpa = np.max(sigma_theta_pa) / 1e6\n\n    return [rmse, correlation, max_sigma_theta_mpa]\n\nsolve()\n```"
        }
    ]
}