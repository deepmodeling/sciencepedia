{
    "hands_on_practices": [
        {
            "introduction": "量化跑步经济性是分析跑者表现的关键。运输成本（Cost of Transport, CoT）是衡量跑步经济性的一个核心指标，它表示每单位体重移动每单位距离所消耗的代谢能量。通过从基础测量数据，如代谢率 $\\dot{E}_{met}$、体重 $m$ 和速度 $v$，推导并计算 CoT，我们可以将生理能耗与运动力学联系起来，这是生物力学分析中的一项基本技能。这个练习  将指导你完成这一过程，从而加深对跑步效率的理解。",
            "id": "4158747",
            "problem": "一名训练有素的跑步者在水平地面上以 $v=3\\,\\mathrm{m/s}$ 的速度稳定奔跑，测得其全身代谢率为 $\\dot{E}_{met}=900\\,\\mathrm{W}$。该跑步者的体重为 $m=70\\,\\mathrm{kg}$。在跑步生物力学中，毛单位质量运输成本（CoT）在概念上定义为每单位体重、每单位行进距离所消耗的代谢能量。从功率是单位时间的能量、速度是单位时间的距离这些基本定义出发，推导出稳定、水平跑步时的毛单位质量运输成本（CoT）的表达式，并为这位跑步者计算其值。以 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$ 为单位报告 CoT，并将答案四舍五入到四位有效数字。此外，在您的推理过程中，请评论计算出的值是否与训练有素的跑步者在此大致速度下的典型值一致（使用 $3.6$ 至 $4.5\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$ 作为参考范围），但不要将此评论包含在最终的数值答案中。",
            "solution": "题目要求推导毛单位质量运输成本（CoT）的表达式，并计算其对于特定跑步者的数值。验证过程确认了该问题具有科学依据，提法恰当，并且所有提供的数据都是一致且符合实际的。\n\n毛单位质量运输成本（$\\mathrm{CoT}$）的概念性定义是每单位体重（$m$）、每单位行进距离（$d$）所消耗的代谢能量（$E_{met}$）。我们可以将此定义形式化为一个数学表达式：\n$$\n\\mathrm{CoT} = \\frac{E_{met}}{m \\cdot d}\n$$\n在国际单位制（SI）中，这些量的单位分别是：能量为焦耳（$J$），质量为千克（$kg$），距离为米（$m$）。因此，$\\mathrm{CoT}$ 的单位是 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$，与题目要求一致。\n\n题目提供了跑步者的代谢率（功率）$\\dot{E}_{met}$ 和他们的稳定速度 $v$。我们必须将这些量与 $\\mathrm{CoT}$ 定义中的各项联系起来。\n\n代谢率，即功率，定义为能量消耗随时间 $t$ 的变化率。\n$$\n\\dot{E}_{met} = \\frac{dE_{met}}{dt}\n$$\n对于一个持续时间为 $t$ 的稳定过程，其中速率是恒定的，这可以简化为：\n$$\n\\dot{E}_{met} = \\frac{E_{met}}{t}\n$$\n由此，我们可以将总代谢能量消耗表示为代谢率与持续时间的乘积：\n$$\nE_{met} = \\dot{E}_{met} \\cdot t\n$$\n速度 $v$ 定义为位置的变化率，或单位时间内行进的距离。对于稳定速度，即为：\n$$\nv = \\frac{d}{t}\n$$\n由此，我们可以将总行进距离表示为速度与持续时间的乘积：\n$$\nd = v \\cdot t\n$$\n现在，我们将 $E_{met}$ 和 $d$ 的表达式代入我们对 $\\mathrm{CoT}$ 的形式化定义中：\n$$\n\\mathrm{CoT} = \\frac{E_{met}}{m \\cdot d} = \\frac{\\dot{E}_{met} \\cdot t}{m \\cdot (v \\cdot t)}\n$$\n时间 $t$ 同时出现在分子和分母中，这表明对于稳态跑步，$\\mathrm{CoT}$ 与跑步的持续时间无关。通过消去 $t$ 来简化表达式，得到 $\\mathrm{CoT}$ 的推导公式：\n$$\n\\mathrm{CoT} = \\frac{\\dot{E}_{met}}{m \\cdot v}\n$$\n这个表达式将运输成本与跑步者的代谢率、质量和速度联系起来。\n\n现在我们可以为给定的跑步者计算数值。所提供的数据是：\n- 代谢率：$\\dot{E}_{met} = 900\\,\\mathrm{W} = 900\\,\\mathrm{J/s}$\n- 体重：$m = 70\\,\\mathrm{kg}$\n- 速度：$v = 3\\,\\mathrm{m/s}$\n\n将这些值代入我们推导出的方程中：\n$$\n\\mathrm{CoT} = \\frac{900\\,\\mathrm{J/s}}{(70\\,\\mathrm{kg}) \\cdot (3\\,\\mathrm{m/s})}\n$$\n$$\n\\mathrm{CoT} = \\frac{900}{210} \\,\\frac{\\mathrm{J/s}}{\\mathrm{kg \\cdot m/s}}\n$$\n$$\n\\mathrm{CoT} = \\frac{90}{21} \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n$$\n\\mathrm{CoT} = \\frac{30}{7} \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n为了得到最终的数值答案，我们按照要求将分数转换为小数，并四舍五入到四位有效数字。\n$$\n\\mathrm{CoT} \\approx 4.285714... \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n四舍五入到四位有效数字，得到：\n$$\n\\mathrm{CoT} \\approx 4.286 \\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}\n$$\n作为最后的检查，题目要求评论该值是否与训练有素的跑步者的典型范围（给定为 $3.6$ 至 $4.5\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$）一致。我们计算出的值 $4.286\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}^{-1}$ 很好地落在了这个参考范围内，这表明初始数据是合理的，且计算结果与生物力学中的既有研究发现相符。",
            "answer": "$$ \\boxed{4.286} $$"
        },
        {
            "introduction": "为了从力学上理解跑步经济性，我们常常使用简化的模型。弹簧-质量模型是一个强大的概念工具，它将整个下肢在支撑相的行为抽象为一个顺应性的弹簧。这个练习  深入探讨了该模型，要求你区分“腿部刚度” ($k_{\\text{leg}}$) 和“垂直刚度” ($k_{\\text{vert}}$) 这两个关键参数，它们共同描述了身体在跑步过程中的弹性行为。理解这两个概念的区别对于准确应用弹簧-质量模型至关重要。",
            "id": "4158804",
            "problem": "一个体重未知的跑步者，在单次支撑期内被建模为一个具有柔性支撑的质点，这与跑步的弹簧-质量模型表示一致。设地面反作用力 (GRF) 的垂直分量表示为 $F_{v}(t)$，并假设在支撑期内 $F_{v}(t)$ 达到峰值的瞬间附近，质心 (CoM) 的垂直运动和腿轴压缩的力-位移关系是局部线性的。在这种小振幅线性化下，力遵循 $F \\approx k \\, \\Delta$ 的关系，其中 $k$ 是相关刚度，$\\Delta$ 是从初始接触时未压缩构型测量的相应位移。\n\n定义了两种刚度度量如下：垂直刚度 $k_{\\text{vert}}$ 将峰值垂直地面反作用力 $F_{\\max}$ 与支撑期内达到的质心最大垂直位移 $\\Delta y$ 联系起来，而腿部刚度 $k_{\\text{leg}}$ 将同一峰值力 $F_{\\max}$ 与支撑期内腿轴的最大压缩量 $\\Delta L$ 联系起来。在线性弹簧近似下，这些度量被广泛用于量化跑步生物力学中的弹性响应。\n\n从牛顿第二定律和每个自由度的线性弹簧特性 $F \\approx k \\, \\Delta$ 出发，推导 $k_{\\text{vert}}$ 和 $k_{\\text{leg}}$ 关于 $F_{\\max}$ 及相应位移的表达式。然后，对于一个支撑期，测得的峰值垂直地面反作用力为 $F_{\\max} = 2000\\,\\mathrm{N}$，质心垂直位移为 $\\Delta y = 0.05\\,\\mathrm{m}$，腿轴压缩量为 $\\Delta L = 0.03\\,\\mathrm{m}$，计算 $k_{\\text{vert}}$ 和 $k_{\\text{leg}}$ 的值，单位为 $\\mathrm{kN/m}$。最后，通过报告比值 $k_{\\text{leg}}/k_{\\text{vert}}$ 来量化两种刚度之间的比较，并以此作为你的最终答案。将最终比值表示为一个无单位的纯数；如果它可以精确地写成一个有理数，请给出简化的精确分数。最终答案无需四舍五入。",
            "solution": "该问题基于跑步生物力学中使用的标准弹簧-质量模型，问题陈述清晰且科学上合理。我们将按要求进行推导和计算。\n\n基本前提是线性的力-位移关系，该关系将跑步者支撑腿结构的行为近似为一个简单的线性弹簧。此关系表示为 $F \\approx k \\, \\Delta$，其中 $F$ 是施加的力，$k$ 是刚度，$\\Delta$ 是从未压缩状态开始的位移。问题基于此原理定义了两种不同的刚度度量：垂直刚度 ($k_{\\text{vert}}$) 和腿部刚度 ($k_{\\text{leg}}$)。\n\n首先，我们推导垂直刚度 $k_{\\text{vert}}$ 的表达式。问题指出，$k_{\\text{vert}}$ 将峰值垂直地面反作用力 (GRF) $F_{\\max}$ 与质心 (CoM) 的最大垂直位移 $\\Delta y$ 联系起来。应用通用的线性弹簧模型，我们代入相关的力和位移：\n$$F_{\\max} \\approx k_{\\text{vert}} \\cdot \\Delta y$$\n求解 $k_{\\text{vert}}$，我们得到表达式：\n$$k_{\\text{vert}} = \\frac{F_{\\max}}{\\Delta y}$$\n该方程将垂直刚度定义为质心在支撑期内所承受的峰值垂直力与其最大垂直位移之比。\n\n其次，我们推导腿部刚度 $k_{\\text{leg}}$ 的表达式。该刚度将同一峰值力 $F_{\\max}$ 与腿轴的最大压缩量 $\\Delta L$ 联系起来。再次使用线性弹簧模型：\n$$F_{\\max} \\approx k_{\\text{leg}} \\cdot \\Delta L$$\n求解 $k_{\\text{leg}}$ 得到：\n$$k_{\\text{leg}} = \\frac{F_{\\max}}{\\Delta L}$$\n该表达式将腿部刚度定义为沿腿轴传递的峰值力与腿长最大变化量之比。腿部刚度表征了腿部结构本身的内在弹性特性，这在概念上与代表整个系统在垂直方向上刚度的垂直刚度是不同的。\n\n接下来，我们使用所提供的数据计算这些刚度的数值：$F_{\\max} = 2000\\,\\mathrm{N}$，$\\Delta y = 0.05\\,\\mathrm{m}$，以及 $\\Delta L = 0.03\\,\\mathrm{m}$。\n\n对于垂直刚度：\n$$k_{\\text{vert}} = \\frac{2000\\,\\mathrm{N}}{0.05\\,\\mathrm{m}} = 40000\\,\\mathrm{N/m}$$\n问题要求答案以千牛顿每米 ($\\mathrm{kN/m}$) 为单位。由于 $1\\,\\mathrm{kN} = 1000\\,\\mathrm{N}$，我们进行单位换算：\n$$k_{\\text{vert}} = 40000\\,\\mathrm{N/m} \\times \\frac{1\\,\\mathrm{kN}}{1000\\,\\mathrm{N}} = 40\\,\\mathrm{kN/m}$$\n\n对于腿部刚度：\n$$k_{\\text{leg}} = \\frac{2000\\,\\mathrm{N}}{0.03\\,\\mathrm{m}} = \\frac{200000}{3}\\,\\mathrm{N/m}$$\n换算为 $\\mathrm{kN/m}$：\n$$k_{\\text{leg}} = \\frac{200000}{3}\\,\\mathrm{N/m} \\times \\frac{1\\,\\mathrm{kN}}{1000\\,\\mathrm{N}} = \\frac{200}{3}\\,\\mathrm{kN/m}$$\n这大约是 $66.67\\,\\mathrm{kN/m}$。\n\n最后，我们计算比值 $k_{\\text{leg}}/k_{\\text{vert}}$ 以量化两种刚度之间的比较。使用推导出的符号表达式：\n$$\\frac{k_{\\text{leg}}}{k_{\\text{vert}}} = \\frac{\\left(\\frac{F_{\\max}}{\\Delta L}\\right)}{\\left(\\frac{F_{\\max}}{\\Delta y}\\right)}$$\n$F_{\\max}$ 项被消去，得到一个简单的几何比值：\n$$\\frac{k_{\\text{leg}}}{k_{\\text{vert}}} = \\frac{\\Delta y}{\\Delta L}$$\n代入给定的位移数值：\n$$\\frac{k_{\\text{leg}}}{k_{\\text{vert}}} = \\frac{0.05\\,\\mathrm{m}}{0.03\\,\\mathrm{m}} = \\frac{0.05}{0.03}$$\n为了将其表示为简化的精确分数，我们可以将小数写成分数形式：\n$$\\frac{0.05}{0.03} = \\frac{5/100}{3/100} = \\frac{5}{3}$$\n这个结果证实了物理上的预期：对于跑步者来说，腿部刚度 ($k_{\\text{leg}}$) 大于垂直刚度 ($k_{\\text{vert}}$)，因为在给定力的情况下，质心的垂直位移在几何上大于腿部的轴向压缩。比值 $\\frac{5}{3}$ 是所要求的精确数值比较。",
            "answer": "$$ \\boxed{\\frac{5}{3}} $$"
        },
        {
            "introduction": "一个科学模型的价值在于其预测能力是否能通过实验数据得到检验。在弹簧-质量模型的基础上，本练习  提出了一个挑战：首先，从简谐运动的假设出发，推导出刚度与步频之间的理论关系；然后，运用计算方法，将这些理论预测与给定的（模拟）实验数据进行拟合与验证。这项实践活动旨在连接理论推导与数据驱动的模型验证，这是现代生物力学研究人员必须掌握的核心技能。",
            "id": "4158766",
            "problem": "考虑人体跑步过程中质心的垂直运动，该运动在支撑相被建模为一个质弹系统，并假设支撑相可以近似为一个振荡的半周期。设跑步者的质量为 $m$ (单位：千克)，步频为 $f$ (单位：赫兹)，触地时间为 $t_c$ (单位：秒)。测得的垂直地面反作用力峰值为 $F_{\\max}$ (单位：牛顿)，测得的支撑相期间质心最大垂直向下位移为 $\\Delta y$ (单位：米)。定义测量的垂直刚度为 $k_{\\text{meas}} = F_{\\max} / \\Delta y$ (单位：牛顿/米)。\n\n仅使用牛顿定律的基本关系和简谐运动的定义，推导垂直刚度 $k_{\\text{vert}}$ 与步频平方 $f^2$ 之间的线性关系，以及 $k_{\\text{vert}}$ 与触地时间倒数的平方 $(1/t_c)^2$ 之间的第二个线性关系。从这些推导中，得出这两个线性关系的理论预测斜率（作为 $m$ 和基本常数的函数）。使用提供的数据，检验测量的刚度值是否遵循这些线性关系。\n\n对于每个测试用例：\n- 对每次试验 $i$，计算测量的刚度值 $k_{\\text{meas},i} = F_{\\max,i} / \\Delta y_i$。\n- 拟合两个带截距的普通最小二乘线性模型：一个是 $k_{\\text{meas}}$ 相对于 $f^2$ 的模型，另一个是 $k_{\\text{meas}}$ 相对于 $(1/t_c)^2$ 的模型。即拟合 $k_{\\text{meas}} = a_f \\, f^2 + b_f$ 和 $k_{\\text{meas}} = a_{t_c} \\, (1/t_c)^2 + b_{t_c}$，估算斜率 $a_f$ 和 $a_{t_c}$ 以及截距 $b_f$ 和 $b_{t_c}$。\n- 计算两种拟合的决定系数 $R^2$ 和均方根误差（单位：牛顿/米）。\n- 使用您推导的理论斜率，评估每次拟合是否与简谐运动的预测一致。如果斜率的相对误差（定义为 $\\left|a - a_{\\text{theory}}\\right|/a_{\\text{theory}}$）小于 $0.15$ 且决定系数 $R^2$ 至少为 $0.95$，则认为拟合是一致的。\n- 一个测试用例要通过，基于 $f^2$ 的拟合和基于 $(1/t_c)^2$ 的拟合都必须满足上述标准。\n\n所有试验必须使用以下单位：力（牛顿，N）、距离（米，m）、时间（秒，s）和频率（赫兹，Hz）。不使用角度。程序必须为以下测试套件生成结果，该套件包括三个旨在探究典型、低频和高频跑步条件的用例。对于每个用例，$m$ 的值（单位：千克）已给出，其后是每次试验的 $f$ (单位：赫兹)、$t_c$ (单位：秒)、$F_{\\max}$ (单位：牛顿) 和 $\\Delta y$ (单位：米) 的数组：\n\n- 用例1（典型跑步）：\n    - $m = 70$\n    - $f = [2.7, 2.9, 3.1, 3.3]$\n    - $t_c = [0.185, 0.172, 0.161, 0.152]$\n    - $F_{\\max} = [1184.796, 1364.126, 1472.504, 1657.258]$\n    - $\\Delta y = [0.060, 0.058, 0.056, 0.054]$\n\n- 用例2（较低频率，较长触地时间）：\n    - $m = 60$\n    - $f = [2.0, 2.1, 2.2, 2.3]$\n    - $t_c = [0.250, 0.238, 0.227, 0.217]$\n    - $F_{\\max} = [623.031, 660.911, 739.369, 769.699]$\n    - $\\Delta y = [0.065, 0.064, 0.063, 0.062]$\n\n- 用例3（较高频率，较短触地时间，带系统性测量偏差）：\n    - $m = 80$\n    - $f = [3.5, 3.6, 3.7, 3.8]$\n    - $t_c = [0.143, 0.139, 0.135, 0.132]$\n    - $F_{\\max} = [1934.440, 2245.933, 2573.484, 2916.657]$\n    - $\\Delta y = [0.050, 0.049, 0.048, 0.047]$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序列出结果，其中每个元素是一个布尔值，指示该用例是否通过上述一致性测试（例如，[True, False, True]）。",
            "solution": "该问题被认为是有效的，因为它科学地基于简谐运动和牛顿力学的原理，构成了生物力学中一个标准的简化模型。问题阐述清晰，提供了所有必要的数据、明确的定义和获得唯一解的客观标准。语言精确且无偏见。\n\n问题的核心是为跑步者的垂直刚度 $k_{\\text{vert}}$ 推导两个理论线性关系，然后检验测量数据是否符合这些理论预测。跑步者质心在支撑相期间被建模为一个进行简谐运动（SHM）半个周期的质弹系统。\n\n首先，我们推导垂直刚度、步频和地面触地时间之间关系的斜率的理论表达式。\n\n**1. $k_{\\text{vert}}$ 与触地时间 $t_c$ 之间关系的推导**\n该模型假设持续时间为 $t_c$ 的支撑相对应于简谐运动的半个周期。对于质量为 $m$、刚度为 $k_{\\text{vert}}$ 的质弹系统，一个完整振荡的周期由下式给出：\n$$T = 2\\pi\\sqrt{\\frac{m}{k_{\\text{vert}}}}$$\n触地时间 $t_c$ 是半个周期的持续时间：\n$$t_c = \\frac{T}{2} = \\frac{2\\pi}{2}\\sqrt{\\frac{m}{k_{\\text{vert}}}} = \\pi\\sqrt{\\frac{m}{k_{\\text{vert}}}}$$\n为了找到与 $k_{\\text{vert}}$ 的关系，我们求解 $k_{\\text{vert}}$：\n$$t_c^2 = \\pi^2 \\frac{m}{k_{\\text{vert}}}$$\n$$k_{\\text{vert}} = \\frac{m\\pi^2}{t_c^2} = (m\\pi^2) \\left(\\frac{1}{t_c}\\right)^2$$\n该方程是线性关系 $y = a x + b$ 的形式，其中 $y=k_{\\text{vert}}$，$x=(1/t_c)^2$，斜率为 $a_{t_c} = m\\pi^2$，y轴截距为 $b_{t_c} = 0$。因此，$k_{\\text{vert}}$ 相对于 $(1/t_c)^2$ 拟合的理论预测斜率为：\n$$a_{t_c, \\text{theory}} = m\\pi^2$$\n\n**2. $k_{\\text{vert}}$ 与步频 $f$ 之间关系的推导**\n对于此推导，我们在简化的跑步模型中做一个常见的建模假设：步频 $f$ 被视为质弹系统的固有振动频率 $f_{\\text{osc}}$。固有角频率 $\\omega$ 为 $\\omega = \\sqrt{k_{\\text{vert}}/m}$，固有频率 $f_{\\text{osc}}$ 为：\n$$f_{\\text{osc}} = \\frac{\\omega}{2\\pi} = \\frac{1}{2\\pi}\\sqrt{\\frac{k_{\\text{vert}}}{m}}$$\n假设 $f \\approx f_{\\text{osc}}$，我们可以写出：\n$$f = \\frac{1}{2\\pi}\\sqrt{\\frac{k_{\\text{vert}}}{m}}$$\n求解 $k_{\\text{vert}}$：\n$$(2\\pi f)^2 = \\frac{k_{\\text{vert}}}{m}$$\n$$k_{\\text{vert}} = m(2\\pi f)^2 = (4m\\pi^2)f^2$$\n该方程是线性关系 $y = a x + b$ 的形式，其中 $y=k_{\\text{vert}}$，$x=f^2$，斜率为 $a_f = 4m\\pi^2$，y轴截距为 $b_f = 0$。因此，$k_{\\text{vert}}$ 相对于 $f^2$ 拟合的理论预测斜率为：\n$$a_{f, \\text{theory}} = 4m\\pi^2$$\n值得注意的是，如果 $f = 1/(2t_c)$，这两个推导是一致的，所提供的数据紧密满足这个条件，表明在数据生成中假设了 $50\\%$ 的占空比（支撑相时间等于腾空相时间）。\n\n**3. 分析步骤**\n对每个提供的测试用例，执行以下步骤：\n- 使用给定定义计算每次试验 $i$ 的测量垂直刚度：$k_{\\text{meas},i} = F_{\\max,i} / \\Delta y_i$。\n- 计算线性拟合的自变量：$f_i^2$ 和 $(1/t_{c,i})^2$。\n- 进行两次带截距的独立普通最小二乘（OLS）线性回归：一次是 $k_{\\text{meas}}$ 相对于 $f^2$ 的回归，以找到实验斜率 $a_f$ 和截距 $b_f$；另一次是 $k_{\\text{meas}}$ 相对于 $(1/t_c)^2$ 的回归，以找到 $a_{t_c}$ 和 $b_{t_c}$。\n- 对每次拟合，计算决定系数 $R^2$。\n- 使用特定用例的质量 $m$ 计算理论斜率 $a_{f, \\text{theory}} = 4m\\pi^2$ 和 $a_{t_c, \\text{theory}} = m\\pi^2$。\n- 如果拟合满足两个标准，则被认为是“一致的”：实验斜率与理论斜率之间的相对误差 $|\\text{slope}_{\\text{exp}} - \\text{slope}_{\\text{theory}}| / \\text{slope}_{\\text{theory}}$ 小于 $0.15$，并且 $R^2$ 值至少为 $0.95$。\n- 只有当两种拟合（$f^2$ 和 $(1/t_c)^2$）都一致时，测试用例才算通过。最终输出是每个用例的布尔值。",
            "answer": "```python\nimport numpy as np\n\ndef analyze_case(m, f_data, tc_data, Fmax_data, dy_data):\n    \"\"\"\n    Analyzes a single test case for consistency with the spring-mass model.\n\n    Args:\n        m (float): Mass of the runner in kg.\n        f_data (np.ndarray): Array of step frequencies in Hz.\n        tc_data (np.ndarray): Array of contact times in s.\n        Fmax_data (np.ndarray): Array of peak ground reaction forces in N.\n        dy_data (np.ndarray): Array of COM vertical displacements in m.\n\n    Returns:\n        bool: True if the case passes the consistency checks, False otherwise.\n    \"\"\"\n    # Calculate measured stiffness\n    k_meas = Fmax_data / dy_data\n\n    # --- Fit 1: k_meas vs f^2 ---\n    x_f = f_data**2\n    y = k_meas\n\n    # Perform OLS linear regression\n    a_f, b_f = np.polyfit(x_f, y, 1)\n\n    # Calculate R^2 for the f^2 fit\n    y_pred_f = a_f * x_f + b_f\n    ss_res_f = np.sum((y - y_pred_f)**2)\n    ss_tot_f = np.sum((y - np.mean(y))**2)\n    r2_f = 1 - (ss_res_f / ss_tot_f) if ss_tot_f > 0 else 0\n\n    # Calculate theoretical slope for f^2 fit\n    a_f_theory = 4 * m * np.pi**2\n\n    # Check consistency for f^2 fit\n    rel_err_f = np.abs(a_f - a_f_theory) / a_f_theory\n    is_consistent_f = (rel_err_f  0.15) and (r2_f >= 0.95)\n\n    # --- Fit 2: k_meas vs (1/tc)^2 ---\n    x_tc = (1 / tc_data)**2\n    \n    # Perform OLS linear regression\n    a_tc, b_tc = np.polyfit(x_tc, y, 1)\n\n    # Calculate R^2 for the (1/tc)^2 fit\n    y_pred_tc = a_tc * x_tc + b_tc\n    ss_res_tc = np.sum((y - y_pred_tc)**2)\n    ss_tot_tc = np.sum((y - np.mean(y))**2)\n    r2_tc = 1 - (ss_res_tc / ss_tot_tc) if ss_tot_tc > 0 else 0\n\n    # Calculate theoretical slope for (1/tc)^2 fit\n    a_tc_theory = m * np.pi**2\n\n    # Check consistency for (1/tc)^2 fit\n    rel_err_tc = np.abs(a_tc - a_tc_theory) / a_tc_theory\n    is_consistent_tc = (rel_err_tc  0.15) and (r2_tc >= 0.95)\n\n    # A case passes if both fits are consistent\n    return is_consistent_f and is_consistent_tc\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"m\": 70,\n            \"f\": np.array([2.7, 2.9, 3.1, 3.3]),\n            \"tc\": np.array([0.185, 0.172, 0.161, 0.152]),\n            \"Fmax\": np.array([1184.796, 1364.126, 1472.504, 1657.258]),\n            \"dy\": np.array([0.060, 0.058, 0.056, 0.054]),\n        },\n        {\n            \"m\": 60,\n            \"f\": np.array([2.0, 2.1, 2.2, 2.3]),\n            \"tc\": np.array([0.250, 0.238, 0.227, 0.217]),\n            \"Fmax\": np.array([623.031, 660.911, 739.369, 769.699]),\n            \"dy\": np.array([0.065, 0.064, 0.063, 0.062]),\n        },\n        {\n            \"m\": 80,\n            \"f\": np.array([3.5, 3.6, 3.7, 3.8]),\n            \"tc\": np.array([0.143, 0.139, 0.135, 0.132]),\n            \"Fmax\": np.array([1934.440, 2245.933, 2573.484, 2916.657]),\n            \"dy\": np.array([0.050, 0.049, 0.048, 0.047]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_case(\n            case[\"m\"], case[\"f\"], case[\"tc\"], case[\"Fmax\"], case[\"dy\"]\n        )\n        results.append(result)\n\n    # Format the final output as a string list of booleans\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}