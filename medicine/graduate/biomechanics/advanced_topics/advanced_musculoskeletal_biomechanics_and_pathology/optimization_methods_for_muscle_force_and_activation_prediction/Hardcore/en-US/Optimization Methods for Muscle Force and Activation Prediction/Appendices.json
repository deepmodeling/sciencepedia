{
    "hands_on_practices": [
        {
            "introduction": "Before we can optimize muscle activations, we must first mathematically describe the physical system. This foundational exercise  has you derive the core equality constraint for static optimization problems. By combining the principles of rotational equilibrium with a simplified muscle force model, you will construct the essential matrix equation that links muscle activations to the net joint torques required for a given task.",
            "id": "4195981",
            "problem": "Consider a musculoskeletal system modeled with $m$ muscles spanning $n$ rotational degrees of freedom (joints). Let the vector of muscle forces be $\\mathbf{F} \\in \\mathbb{R}^{m}$, the vector of muscle activations be $\\mathbf{a} \\in \\mathbb{R}^{m}$, and the vector of net joint torques required to satisfy inverse dynamics at a static posture be $\\boldsymbol{\\tau} \\in \\mathbb{R}^{n}$. The moment arm matrix $R \\in \\mathbb{R}^{n \\times m}$ has entries $r_{j i}$ giving the signed moment arm of muscle $i$ about joint $j$; the net torque contribution of the muscles is the linear map of muscle forces through $R$.\n\nAssume a Hill-type muscle model in which force depends multiplicatively on activation, a length-dependent factor, and a velocity-dependent factor. In the isometric case ($\\dot{\\theta}_{j} = 0$ for all joints $j$ so joint angular velocities are zero), the velocity-dependent factor is fixed. Suppose the posture is fixed so that the length-dependent factor for each muscle is also fixed. Under these conditions, it is standard to form a linearization in which each muscle’s force is proportional to its activation with a constant coefficient determined by maximum isometric force and the fixed length-dependent factor.\n\nStarting from rotational equilibrium for each joint and the above modeling assumptions, derive the equality constraints that Static Optimization (SO) must satisfy to match the required joint torques. Express the constraints compactly as a single matrix equation in terms of $R$, the vector of maximum isometric forces $\\mathbf{F}_{\\max} = \\left(F_{1,\\max}, \\dots, F_{m,\\max}\\right)^{\\top}$, the vector of fixed length factors $\\mathbf{f}_{L} = \\left(f_{L,1}, \\dots, f_{L,m}\\right)^{\\top}$, and the activation vector $\\mathbf{a}$. Your final answer must be a single closed-form analytic expression. Do not include any units in your final expression.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. All necessary information is provided, and the terminology is standard within the field of biomechanics. The derivation of the equality constraints for static optimization is a standard procedure based on principles of rigid body mechanics and muscle modeling. The problem is therefore deemed valid.\n\nThe objective is to derive the set of equality constraints that the muscle activation vector $\\mathbf{a}$ must satisfy to produce a required net joint torque vector $\\boldsymbol{\\tau}$. These constraints arise from two physical principles: rotational equilibrium at the joints and the force production characteristics of the muscles.\n\nFirst, we establish the condition for rotational equilibrium. The system consists of $n$ rotational degrees of freedom (joints). For the musculoskeletal system to be in static equilibrium (or to produce the net torques required for a specific dynamic state, as calculated from inverse dynamics), the sum of torques generated by the muscles about each joint must equal the required net torque for that joint.\n\nThe problem provides the net joint torque vector required by the dynamics as $\\boldsymbol{\\tau} \\in \\mathbb{R}^{n}$. The contribution of the muscles to this torque is given by the linear transformation of the muscle force vector $\\mathbf{F} \\in \\mathbb{R}^{m}$ by the moment arm matrix $R \\in \\mathbb{R}^{n \\times m}$. The entry $r_{ji}$ of $R$ represents the moment arm of muscle $i$ about joint $j$. Therefore, the total torque vector generated by all $m$ muscles is the matrix-vector product $R\\mathbf{F}$.\n\nThe equilibrium equation is thus:\n$$R \\mathbf{F} = \\boldsymbol{\\tau}$$\nThis equation represents a system of $n$ linear equations, one for each joint.\n\nNext, we must model the muscle force vector $\\mathbf{F}$. The problem specifies a simplified Hill-type muscle model under isometric conditions at a fixed posture. In this case, the force-producing capability of a muscle depends only on its activation level $a_i$, its maximum isometric force $F_{i,\\max}$, and a factor $f_{L,i}$ that accounts for the muscle's length. The problem states that muscle force is proportional to activation. The force $F_i$ of the $i$-th muscle is given by:\n$$F_i = a_i F_{i,\\max} f_{L,i}$$\nHere, $a_i$ is the activation of muscle $i$, typically bounded such that $0 \\le a_i \\le 1$. $F_{i,\\max}$ is the maximum possible force the muscle can generate under optimal conditions. $f_{L,i}$ is the fixed, length-dependent scaling factor for the given posture.\n\nWe need to express this relationship for all muscles in a single vector equation. We have the vector of activations $\\mathbf{a} = (a_1, \\dots, a_m)^{\\top}$, the vector of maximum isometric forces $\\mathbf{F}_{\\max} = (F_{1,\\max}, \\dots, F_{m,\\max})^{\\top}$, and the vector of fixed length factors $\\mathbf{f}_{L} = (f_{L,1}, \\dots, f_{L,m})^{\\top}$.\n\nThe force $F_i$ is the product of three scalars. To express the vector $\\mathbf{F}$ in terms of the vector $\\mathbf{a}$, we note that the force generation is an element-wise operation. We can define a vector of potential forces at the given posture, $\\mathbf{F}_{\\text{pot}}$, where each element is $F_{i,\\max} f_{L,i}$. This can be written using the Hadamard (element-wise) product, denoted by $\\odot$:\n$$\\mathbf{F}_{\\text{pot}} = \\mathbf{F}_{\\max} \\odot \\mathbf{f}_{L}$$\nThen, the muscle force vector $\\mathbf{F}$ is the element-wise product of the activation vector $\\mathbf{a}$ and this potential force vector $\\mathbf{F}_{\\text{pot}}$:\n$$\\mathbf{F} = \\mathbf{a} \\odot \\mathbf{F}_{\\text{pot}} = \\mathbf{a} \\odot (\\mathbf{F}_{\\max} \\odot \\mathbf{f}_{L})$$\n\nTo substitute this into the matrix equation for equilibrium, $R \\mathbf{F} = \\boldsymbol{\\tau}$, it is most convenient to express the element-wise multiplication by a matrix-vector product. We can construct a diagonal matrix, which we denote as $D \\in \\mathbb{R}^{m \\times m}$, whose diagonal entries are the potential forces for each muscle. Let $D = \\text{diag}(\\mathbf{F}_{\\max} \\odot \\mathbf{f}_{L})$. The diagonal entries are $D_{ii} = F_{i,\\max} f_{L,i}$, and all off-diagonal entries are $0$.\nUsing this matrix, the muscle force vector $\\mathbf{F}$ can be written as:\n$$\\mathbf{F} = D \\mathbf{a}$$\nThis is equivalent to the element-wise product, as $(D\\mathbf{a})_i = D_{ii}a_i = (F_{i,\\max} f_{L,i}) a_i = F_i$.\n\nFinally, we substitute this expression for $\\mathbf{F}$ back into the rotational equilibrium equation:\n$$R (D \\mathbf{a}) = \\boldsymbol{\\tau}$$\nExpanding the definition of the matrix $D$, we obtain the final expression for the equality constraints that Static Optimization (SO) must satisfy:\n$$R \\, \\text{diag}(\\mathbf{F}_{\\max} \\odot \\mathbf{f}_{L}) \\, \\mathbf{a} = \\boldsymbol{\\tau}$$\nThis is a single, compact matrix equation representing the $n$ linear equality constraints on the $m$ unknown muscle activations in the vector $\\mathbf{a}$. The matrix product on the left, $R \\, \\text{diag}(\\mathbf{F}_{\\max} \\odot \\mathbf{f}_{L})$, forms a constant coefficient matrix of size $n \\times m$ that relates the activations to the required joint torques.",
            "answer": "$$\\boxed{R \\, \\text{diag}(\\mathbf{F}_{\\max} \\odot \\mathbf{f}_{L}) \\, \\mathbf{a} = \\boldsymbol{\\tau}}$$"
        },
        {
            "introduction": "With the problem constraints established, we can now seek an optimal solution from the feasible set of muscle activation patterns. This practice  delves into the heart of solving such problems by applying the Karush-Kuhn-Tucker (KKT) conditions to a standard quadratic programming formulation. Beyond just finding a numerical answer, you will gain a deeper, graduate-level insight by interpreting the Lagrange multipliers as \"shadow prices,\" which reveal the marginal cost of enforcing torque demands and physiological activation limits.",
            "id": "4196012",
            "problem": "Consider a static optimization formulation for predicting muscle activations in an isometric task at a single joint. Let the vector of muscle activations be $\\mathbf{a} \\in \\mathbb{R}^{n}$ with components $a_{i}$ representing the fraction of maximal activation of muscle $i$, bounded by $0 \\leq a_{i} \\leq 1$. Let the joint torque equilibrium be represented by $\\boldsymbol{\\tau} = M \\mathbf{a}$, where $\\boldsymbol{\\tau} \\in \\mathbb{R}^{m}$ is the prescribed joint torque vector and $M \\in \\mathbb{R}^{m \\times n}$ maps activations to net joint torques, capturing moment arms and normalized muscle capacity under isometric conditions. Let the effort cost be $J(\\mathbf{a}) = \\frac{1}{2} \\mathbf{a}^{\\top} Q \\mathbf{a}$ with $Q \\in \\mathbb{R}^{n \\times n}$ symmetric positive definite, representing a convex quadratic penalty on activation.\n\nStarting from the fundamental static torque balance $\\boldsymbol{\\tau} = M \\mathbf{a}$ and the bounds $0 \\leq a_{i} \\leq 1$, and using the standard inequality constraint representation $-a_{i} \\leq 0$ and $a_{i} - 1 \\leq 0$, do the following:\n\n1. Construct the Lagrangian for the constrained optimization problem of minimizing $J(\\mathbf{a})$ subject to the torque equilibrium and activation bounds, and derive the full set of Karush–Kuhn–Tucker (KKT) conditions (stationarity, primal feasibility, dual feasibility, and complementary slackness). As part of your derivation, clearly identify the Lagrange multipliers associated with the equality constraints and the inequality bounds.\n2. Provide a principled interpretation of the Lagrange multipliers as shadow prices: describe how the multipliers associated with the torque equilibrium reflect the sensitivity of the optimal cost to changes in prescribed torque, and how the multipliers associated with the activation bounds reflect the marginal cost of tightening or relaxing those bounds.\n3. Evaluate the multipliers for a specific two-muscle, single-degree-of-freedom case with $n = 2$ and $m = 1$. Use\n   $$\n   Q = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}, \\quad M = \\begin{pmatrix} 0.5  1.0 \\end{pmatrix}, \\quad \\boldsymbol{\\tau} = \\begin{pmatrix} 0.6 \\end{pmatrix}.\n   $$\n   Compute the Lagrange multiplier associated with the torque equilibrium (the scalar multiplier for the single equality constraint) at the optimum. Assume the optimal solution lies strictly within the activation bounds if consistent with the KKT conditions you derive. Round your final numerical answer to four significant figures and express the value in units of reciprocal torque, specifically in $\\text{(N·m)}^{-1}$.",
            "solution": "The problem asks for the formulation and solution of a static optimization problem to predict muscle activations. This is a classic biomechanics problem, typically formulated as a convex Quadratic Program (QP). We will first construct the general Karush–Kuhn–Tucker (KKT) conditions, then interpret the resulting Lagrange multipliers, and finally solve for the specific numerical case provided.\n\nThe optimization problem is defined as:\nMinimize the effort cost $J(\\mathbf{a}) = \\frac{1}{2} \\mathbf{a}^{\\top} Q \\mathbf{a}$\nwith respect to the activation vector $\\mathbf{a} \\in \\mathbb{R}^{n}$.\nThe minimization is subject to three types of constraints:\n1.  Torque equilibrium (equality constraint): $\\boldsymbol{\\tau} - M \\mathbf{a} = \\mathbf{0}$\n2.  Lower activation bounds (inequality constraints): $-a_{i} \\leq 0$ for $i = 1, \\dots, n$\n3.  Upper activation bounds (inequality constraints): $a_{i} - 1 \\leq 0$ for $i = 1, \\dots, n$\n\nHere, $\\mathbf{a}$ is the vector of muscle activations, $Q$ is a symmetric positive definite matrix defining the quadratic cost, $\\boldsymbol{\\tau}$ is the vector of prescribed joint torques, and $M$ is the matrix mapping activations to torques. Since $Q$ is positive definite, the objective function $J(\\mathbf{a})$ is strictly convex. The constraints are linear, defining a convex feasible set. Therefore, this QP has a unique global minimum.\n\n### 1. Lagrangian and KKT Conditions\n\nTo solve this constrained optimization problem, we form the Lagrangian function, $\\mathcal{L}$, by augmenting the objective function with the constraints, weighted by their respective Lagrange multipliers. Let $\\boldsymbol{\\lambda} \\in \\mathbb{R}^{m}$ be the vector of multipliers for the equality constraints, $\\boldsymbol{\\mu} \\in \\mathbb{R}^{n}$ for the lower-bound inequality constraints, and $\\boldsymbol{\\nu} \\in \\mathbb{R}^{n}$ for the upper-bound inequality constraints.\n\nThe Lagrangian is:\n$$\n\\mathcal{L}(\\mathbf{a}, \\boldsymbol{\\lambda}, \\boldsymbol{\\mu}, \\boldsymbol{\\nu}) = J(\\mathbf{a}) + \\boldsymbol{\\lambda}^{\\top}(\\boldsymbol{\\tau} - M \\mathbf{a}) + \\boldsymbol{\\mu}^{\\top}(-\\mathbf{a}) + \\boldsymbol{\\nu}^{\\top}(\\mathbf{a} - \\mathbf{1})\n$$\nSubstituting the expression for $J(\\mathbf{a})$ and distributing the terms, we get:\n$$\n\\mathcal{L}(\\mathbf{a}, \\boldsymbol{\\lambda}, \\boldsymbol{\\mu}, \\boldsymbol{\\nu}) = \\frac{1}{2} \\mathbf{a}^{\\top} Q \\mathbf{a} - \\boldsymbol{\\lambda}^{\\top}M \\mathbf{a} - \\boldsymbol{\\mu}^{\\top}\\mathbf{a} + \\boldsymbol{\\nu}^{\\top}\\mathbf{a} + \\boldsymbol{\\lambda}^{\\top}\\boldsymbol{\\tau} - \\boldsymbol{\\nu}^{\\top}\\mathbf{1}\n$$\nThe Karush–Kuhn–Tucker (KKT) conditions provide the necessary and sufficient conditions for optimality for this convex problem. They are:\n\n1.  **Stationarity**: The gradient of the Lagrangian with respect to the primal variables $\\mathbf{a}$ must be zero at the optimum $(\\mathbf{a}^*, \\boldsymbol{\\lambda}^*, \\boldsymbol{\\mu}^*, \\boldsymbol{\\nu}^*)$.\n    $$\n    \\nabla_{\\mathbf{a}} \\mathcal{L} = Q \\mathbf{a}^* - M^{\\top}\\boldsymbol{\\lambda}^* - \\boldsymbol{\\mu}^* + \\boldsymbol{\\nu}^* = \\mathbf{0}\n    $$\n2.  **Primal Feasibility**: The solution $\\mathbf{a}^*$ must satisfy all original constraints.\n    $$\n    M \\mathbf{a}^* = \\boldsymbol{\\tau}\n    $$\n    $$\n    0 \\leq a_{i}^* \\leq 1 \\quad \\text{for } i = 1, \\dots, n\n    $$\n3.  **Dual Feasibility**: The Lagrange multipliers for the inequality constraints must be non-negative.\n    $$\n    \\mu_{i}^* \\geq 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n    $$\n    \\nu_{i}^* \\geq 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n4.  **Complementary Slackness**: The product of each inequality constraint multiplier and its corresponding slack value must be zero. This means a multiplier can only be non-zero if the corresponding constraint is active (i.e., holds with equality).\n    $$\n    \\mu_{i}^* a_{i}^* = 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n    $$\n    \\nu_{i}^* (a_{i}^* - 1) = 0 \\quad \\text{for } i = 1, \\dots, n\n    $$\n\n### 2. Interpretation of Lagrange Multipliers as Shadow Prices\n\nLagrange multipliers have a direct economic interpretation as shadow prices, representing the sensitivity of the optimal objective value, $J^* = J(\\mathbf{a}^*)$, to infinitesimal relaxation of the constraints.\n\n*   **Torque Equilibrium Multiplier ($\\boldsymbol{\\lambda}$)**: The multiplier $\\boldsymbol{\\lambda}^*$ quantifies the marginal change in the optimal cost $J^*$ with respect to a change in the prescribed torque $\\boldsymbol{\\tau}$. Specifically, $\\lambda_{j}^* = \\frac{\\partial J^*}{\\partial \\tau_j}$. Thus, $\\lambda_{j}^*$ represents the marginal cost of producing an additional unit of torque at joint $j$. A positive value indicates that increasing the required torque will increase the physiological effort cost.\n\n*   **Activation Bound Multipliers ($\\boldsymbol{\\mu}, \\boldsymbol{\\nu}$)**: The multipliers $\\boldsymbol{\\mu}^*$ and $\\boldsymbol{\\nu}^*$ quantify the marginal cost associated with the activation bounds.\n    *   The multiplier $\\mu_{i}^*$ corresponds to the lower bound $a_i \\ge 0$. If the optimal activation $a_{i}^*  0$, the constraint is inactive, and complementary slackness dictates that $\\mu_{i}^* = 0$. If $a_{i}^* = 0$, the constraint is active, and $\\mu_{i}^*$ can be positive. It represents the rate at which the optimal cost $J^*$ would decrease if the lower bound were relaxed (e.g., if muscle $i$ were allowed to have negative activation).\n    *   The multiplier $\\nu_{i}^*$ corresponds to the upper bound $a_i \\le 1$. If $a_{i}^*  1$, the constraint is inactive, and $\\nu_{i}^* = 0$. If $a_{i}^* = 1$ (the muscle is saturated), the constraint is active, and $\\nu_{i}^*$ can be positive. It represents the rate at which the optimal cost $J^*$ would decrease if the upper bound were relaxed (i.e., if the muscle's maximal activation capacity could be increased beyond $1$).\n\n### 3. Numerical Evaluation for a Specific Case\n\nWe are given a system with $n=2$ muscles and $m=1$ degree of freedom. The parameters are:\n$$\nQ = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}, \\quad M = \\begin{pmatrix} 0.5  1.0 \\end{pmatrix}, \\quad \\boldsymbol{\\tau} = \\tau = 0.6\n$$\nSince $m=1$, the torque $\\boldsymbol{\\tau}$ and its multiplier $\\boldsymbol{\\lambda}$ are scalars, denoted $\\tau$ and $\\lambda$. The problem directs us to assume that the optimal solution lies strictly within the activation bounds, i.e., $0  a_{i}^*  1$ for $i=1, 2$.\n\nUnder this assumption, the lower and upper bound constraints are inactive. By the complementary slackness conditions:\n*   $a_i^*  0 \\implies \\mu_i^* = 0$\n*   $a_i^*  1 \\implies a_i^* - 1 \\neq 0 \\implies \\nu_i^* = 0$\n\nThus, $\\boldsymbol{\\mu}^* = \\mathbf{0}$ and $\\boldsymbol{\\nu}^* = \\mathbf{0}$. The KKT conditions simplify to a system of linear equations:\n1.  Stationarity: $Q \\mathbf{a}^* - M^{\\top} \\lambda^* = \\mathbf{0}$\n2.  Primal Feasibility: $M \\mathbf{a}^* = \\tau$\n\nFrom the stationarity equation, we can express $\\mathbf{a}^*$ in terms of $\\lambda^*$:\n$$\n\\mathbf{a}^* = Q^{-1} M^{\\top} \\lambda^*\n$$\nSubstituting this into the primal feasibility equation gives:\n$$\nM (Q^{-1} M^{\\top} \\lambda^*) = \\tau \\implies (M Q^{-1} M^{\\top}) \\lambda^* = \\tau\n$$\nSolving for $\\lambda^*$, we get:\n$$\n\\lambda^* = (M Q^{-1} M^{\\top})^{-1} \\tau\n$$\nWe now compute the terms in this expression. The inverse of $Q$ is:\n$$\nQ^{-1} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}^{-1} = \\begin{pmatrix} 1/2  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.5  0 \\\\ 0  1.0 \\end{pmatrix}\n$$\nThe transpose of $M$ is:\n$$\nM^{\\top} = \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix}\n$$\nNow we compute the scalar term $M Q^{-1} M^{\\top}$:\n$$\nM Q^{-1} M^{\\top} = \\begin{pmatrix} 0.5  1.0 \\end{pmatrix} \\begin{pmatrix} 0.5  0 \\\\ 0  1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.5 \\times 0.5 + 1.0 \\times 0  0.5 \\times 0 + 1.0 \\times 1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0.25  1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix} = (0.25 \\times 0.5) + (1.0 \\times 1.0) = 0.125 + 1.0 = 1.125\n$$\nNow we can compute $\\lambda^*$:\n$$\n\\lambda^* = (1.125)^{-1} \\times 0.6 = \\frac{0.6}{1.125} = \\frac{8}{15}\n$$\nAs a decimal, $\\lambda^* \\approx 0.53333...$. Rounding to four significant figures, we get $\\lambda^*=0.5333$. As per the interpretation, the units of $\\lambda^*$ are the units of cost (dimensionless) divided by the units of torque (e.g., $\\text{N·m}$), resulting in $(\\text{N·m})^{-1}$.\n\nTo complete the solution, we must verify that our initial assumption ($0  a_{i}^*  1$) is consistent. We calculate the optimal activation vector $\\mathbf{a}^*$:\n$$\n\\mathbf{a}^* = Q^{-1} M^{\\top} \\lambda^* = \\begin{pmatrix} 0.5  0 \\\\ 0  1.0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ 1.0 \\end{pmatrix} \\left(\\frac{8}{15}\\right) = \\begin{pmatrix} 0.25 \\\\ 1.0 \\end{pmatrix} \\frac{8}{15} = \\begin{pmatrix} 2/15 \\\\ 8/15 \\end{pmatrix}\n$$\nThe individual activations are:\n$$\na_1^* = \\frac{2}{15} \\approx 0.1333\n$$\n$$\na_2^* = \\frac{8}{15} \\approx 0.5333\n$$\nSince $0  2/15  1$ and $0  8/15  1$, our assumption that the solution is in the interior of the activation bounds is validated. Thus, the calculated value for $\\lambda^*$ is correct.",
            "answer": "$$\\boxed{0.5333}$$"
        },
        {
            "introduction": "Real-world biological movement is rarely about a single objective; it often involves balancing competing goals like minimizing energy expenditure while ensuring stability and preventing injury. This hands-on coding practice  advances from single-objective to multi-objective optimization (MOO), a powerful framework for exploring such trade-offs. By implementing a solution that weighs metabolic effort against joint shear force mitigation, you will investigate the concept of a Pareto front and see how co-contraction can arise as a sophisticated, optimal motor strategy.",
            "id": "4195942",
            "problem": "Consider a planar knee joint held quasi-statically in extension, so that rotational acceleration is negligible and the net torque equals the required extension torque by Newton's second law for rotation. The fundament is the rotational equilibrium condition, which in this quasi-static case requires that the sum of muscle torques equals the externally required joint torque. Two muscles act at the knee: a lumped quadriceps group (knee extensor) and a lumped hamstrings group (knee flexor). Let the quadriceps muscle force be $F_q$ and the hamstrings muscle force be $F_h$, with corresponding knee moment arms $r_q$ and $r_h$, where $r_q  0$ and $r_h  0$ when extension torque is defined positive. The quasi-static torque balance is\n$$\nr_q F_q + r_h F_h = T_{\\mathrm{req}},\n$$\nwhere $T_{\\mathrm{req}}$ is the required net extension torque at the knee. Muscle forces are modeled as $F_i = a_i F_{i,\\max}$ for $i \\in \\{q,h\\}$, where $a_i \\in [0,1]$ is the muscle activation and $F_{i,\\max}  0$ is the maximum force capacity.\n\nWe consider Multi-Objective Optimization (MOO) of muscle activations that balances effort and anterior shear mitigation. The first objective $J_1$ represents metabolic effort, modeled as the sum of squared activations,\n$$\nJ_1(a_q,a_h) = w_q a_q^2 + w_h a_h^2,\n$$\nwith positive weights $w_q,w_h$. The second objective $J_2$ represents a surrogate for anterior tibial shear risk, modeled as the squared difference of shear contributions from the two muscles,\n$$\nJ_2(a_q,a_h) = \\left(c_q F_q - c_h F_h\\right)^2 = \\left(c_q F_{q,\\max} a_q - c_h F_{h,\\max} a_h\\right)^2,\n$$\nwhere $c_q0$ and $c_h0$ are geometry-dependent coefficients mapping muscle force to anterior shear contribution. The feasible set is defined by the equality torque constraint and the bound constraints $0 \\le a_q \\le 1$, $0 \\le a_h \\le 1$.\n\nA Pareto family of solutions is generated via the weighted-sum method: for a trade-off parameter $\\alpha \\in [0,1]$, minimize\n$$\nJ_\\alpha(a_q,a_h) = \\alpha J_1(a_q,a_h) + (1-\\alpha) J_2(a_q,a_h),\n$$\nsubject to the equality torque constraint and activation bounds. The trade-off parameter $\\alpha$ shifts the solution from prioritizing shear mitigation at $\\alpha = 0$ to prioritizing effort at $\\alpha = 1$.\n\nFrom first principles, reduce the problem to a single decision variable by substituting the torque balance. Define $A = r_q F_{q,\\max}  0$ and $B = r_h F_{h,\\max}  0$, and write\n$$\na_q = \\frac{T_{\\mathrm{req}} - B a_h}{A}.\n$$\nThe feasible interval for $a_h$ is the set of values that keep $a_q$ in $[0,1]$ and $a_h$ in $[0,1]$. For the knee extension cases specified below where $T_{\\mathrm{req}} \\ge 0$ and $A \\ge T_{\\mathrm{req}}$, this interval is\n$$\na_h \\in \\left[0, \\min\\left(1, \\frac{A - T_{\\mathrm{req}}}{-B}\\right)\\right],\n$$\nsince $-B0$ and $A - T_{\\mathrm{req}} \\ge 0$. Within this interval, the one-dimensional objective $J_\\alpha(a_h)$ is quadratic in $a_h$, and the optimal $a_h^\\star$ is either the unique stationary point in the interval (if the curvature is positive) or an endpoint.\n\nDefine the co-contraction index for each solution as a unitless measure,\n$$\n\\mathrm{CCI} = \\begin{cases}\n\\dfrac{2 \\min(F_q,F_h)}{F_q + F_h},  F_q + F_h > 0 \\\\[6pt]\n0,  F_q + F_h = 0\n\\end{cases}\n$$\nThis index is $0$ when only one muscle is active and approaches $1$ when both muscles contribute nearly equally.\n\nImplement a program that, for each test case listed in the test suite below, computes the optimal activations $(a_q,a_h)$ that minimize $J_\\alpha$ for $\\alpha \\in \\{0.0, 0.5, 1.0\\}$, and then outputs the corresponding $\\mathrm{CCI}$ values in a nested list. No angles are required; there are no angle units to specify. All physical quantities use the International System of Units (SI): torque in newton-meters (N·m), force in newtons (N), and moment arms in meters (m). Activations and the co-contraction index are unitless.\n\nTest suite:\n- Case $1$ (happy path, moderate torque, shear moderation relevant): $T_{\\mathrm{req}} = 40$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.25$, $c_h = 0.20$.\n- Case $2$ (boundary feasibility, quadriceps near capacity): $T_{\\mathrm{req}} = 80$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.25$, $c_h = 0.20$.\n- Case $3$ (low torque, stronger shear weighting, encourages co-contraction): $T_{\\mathrm{req}} = 10$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.60$, $c_h = 0.40$.\n- Case $4$ (zero torque, trivial equilibrium): $T_{\\mathrm{req}} = 0$ N·m, $r_q = 0.04$ m, $r_h = -0.03$ m, $F_{q,\\max} = 2000$ N, $F_{h,\\max} = 1500$ N, $w_q = 1$, $w_h = 1$, $c_q = 0.25$, $c_h = 0.20$.\n\nYour program should produce a single line of output containing the results as a comma-separated nested list of the co-contraction index values for $\\alpha \\in \\{0.0, 0.5, 1.0\\}$ across the four test cases, in the order given above. The format must be exactly:\n$$\n[[\\mathrm{CCI}_{\\alpha=0.0}^{(1)}, \\mathrm{CCI}_{\\alpha=0.5}^{(1)}, \\mathrm{CCI}_{\\alpha=1.0}^{(1)}], [\\mathrm{CCI}_{\\alpha=0.0}^{(2)}, \\mathrm{CCI}_{\\alpha=0.5}^{(2)}, \\mathrm{CCI}_{\\alpha=1.0}^{(2)}], [\\mathrm{CCI}_{\\alpha=0.0}^{(3)}, \\mathrm{CCI}_{\\alpha=0.5}^{(3)}, \\mathrm{CCI}_{\\alpha=1.0}^{(3)}], [\\mathrm{CCI}_{\\alpha=0.0}^{(4)}, \\mathrm{CCI}_{\\alpha=0.5}^{(4)}, \\mathrm{CCI}_{\\alpha=1.0}^{(4)}]]\n$$\nwhere superscripts indicate the test case index and subscripts indicate the $\\alpha$ value. The printed output must be a valid Python list literal with numeric entries (floats).",
            "solution": "The problem is valid. It presents a scientifically grounded, well-posed optimization problem in biomechanics, with all necessary data and constraints provided. The variables, objectives, and constraints are clearly defined, allowing for a formal and unique solution.\n\nThe core of the problem is to find the muscle activations, $a_q$ and $a_h$, that minimize a weighted-sum objective function $J_\\alpha(a_q, a_h)$ for different trade-off parameters $\\alpha$. The optimization is subject to a linear equality constraint representing torque equilibrium and box constraints on the activations.\n\nThe solution proceeds in several steps:\n\n1.  **Dimensionality Reduction**: The problem is initially formulated with two decision variables, $a_q$ and $a_h$. The torque balance equation, $r_q F_q + r_h F_h = T_{\\mathrm{req}}$, provides a linear equality constraint. By defining constants $A = r_q F_{q,\\max}$ and $B = r_h F_{h,\\max}$, this constraint is expressed as $A a_q + B a_h = T_{\\mathrm{req}}$. We can solve this for $a_q$ (since $A \\ne 0$) and substitute it into the objective function, reducing the problem to a single decision variable, $a_h$.\n    $$\n    a_q = \\frac{T_{\\mathrm{req}} - B a_h}{A}\n    $$\n\n2.  **Objective Function Derivation**: The combined objective function is $J_\\alpha(a_q,a_h) = \\alpha J_1 + (1-\\alpha) J_2$, where $J_1 = w_q a_q^2 + w_h a_h^2$ and $J_2 = (c_q F_{q,\\max} a_q - c_h F_{h,\\max} a_h)^2$. Substituting the expression for $a_q$ into $J_\\alpha$ yields a one-dimensional objective function $J_\\alpha(a_h)$.\n    \n    Let's define additional constants for clarity: $C_q = c_q F_{q,\\max}$ and $C_h = c_h F_{h,\\max}$.\n    \n    The objective function becomes:\n    $$\n    J_\\alpha(a_h) = \\alpha \\left[ w_q \\left(\\frac{T_{\\mathrm{req}} - B a_h}{A}\\right)^2 + w_h a_h^2 \\right] + (1-\\alpha) \\left[ C_q \\left(\\frac{T_{\\mathrm{req}} - B a_h}{A}\\right) - C_h a_h \\right]^2\n    $$\n    Expanding this expression reveals that $J_\\alpha(a_h)$ is a quadratic function of $a_h$, which can be written in the standard form $J_\\alpha(a_h) = P a_h^2 + Q a_h + R$. The coefficients $P$ and $Q$ are:\n    $$\n    P = \\alpha \\left[ w_q \\left(\\frac{B}{A}\\right)^2 + w_h \\right] + (1-\\alpha) \\left[ \\frac{C_q B}{A} + C_h \\right]^2\n    $$\n    $$\n    Q = -2 \\left[ \\alpha w_q \\frac{T_{\\mathrm{req}} B}{A^2} + (1-\\alpha) \\frac{C_q T_{\\mathrm{req}}}{A} \\left( \\frac{C_q B}{A} + C_h \\right) \\right]\n    $$\n    The constant term $R$ does not affect the location of the minimum and is not required for the optimization. Since all weights ($w_i$), maximum forces ($F_{i,max}$), and coefficients ($c_i$) are positive, and from the definitions of $A$ and $B$, it can be shown that $P  0$ for $\\alpha \\in [0,1)$ and for $\\alpha=1$. If $\\alpha=0$, $P$ can be zero only under a specific geometric condition which is not met in the test cases. Thus, the objective function is a convex parabola, guaranteeing a unique global minimum.\n\n3.  **Feasibility Analysis**: The variable $a_h$ is bounded by $0 \\le a_h \\le 1$. The substituted variable $a_q$ must also be within its bounds, $0 \\le a_q \\le 1$. This imposes further constraints on $a_h$:\n    $$\n    0 \\le \\frac{T_{\\mathrm{req}} - B a_h}{A} \\le 1\n    $$\n    Given that $A  0$ and $-B  0$, and for the specified cases where $T_{\\mathrm{req}} \\ge 0$ and $A \\ge T_{\\mathrm{req}}$, this simplifies to a feasible interval for $a_h$:\n    $$\n    a_h \\in [a_{h,\\min}, a_{h,\\max}] = \\left[0, \\min\\left(1, \\frac{A - T_{\\mathrm{req}}}{-B}\\right)\\right]\n    $$\n\n4.  **Optimization**: The unconstrained minimum of the quadratic function $J_\\alpha(a_h)$ occurs at its vertex, where the derivative is zero: $2 P a_h + Q = 0$. The stationary point is therefore:\n    $$\n    a_h^{\\mathrm{unc}} = -\\frac{Q}{2P}\n    $$\n    The optimal solution $a_h^\\star$ within the feasible interval is found by clamping this unconstrained minimum to the interval $[a_{h,\\min}, a_{h,\\max}]$.\n    $$\n    a_h^\\star = \\max(a_{h,\\min}, \\min(a_h^{\\mathrm{unc}}, a_{h,\\max}))\n    $$\n    A special case where $P=0$ (linear objective) is handled by choosing the endpoint of the interval that minimizes the function, determined by the sign of $Q$.\n\n5.  **Solution Recovery and Final Calculation**: Once the optimal hamstring activation $a_h^\\star$ is found, the optimal quadriceps activation $a_q^\\star$ is calculated using the torque balance equation.\n    $$\n    a_q^\\star = \\frac{T_{\\mathrm{req}} - B a_h^\\star}{A}\n    $$\n    With the optimal activations $(a_q^\\star, a_h^\\star)$, the muscle forces are calculated as $F_q = a_q^\\star F_{q,\\max}$ and $F_h = a_h^\\star F_{h,\\max}$. Finally, the Co-Contraction Index (CCI) is computed using its definition:\n    $$\n    \\mathrm{CCI} = \\begin{cases}\n    \\dfrac{2 \\min(F_q,F_h)}{F_q + F_h},  F_q + F_h > 0, \\\\[6pt]\n    0,  F_q + F_h = 0.\n    \\end{cases}\n    $$\nThis procedure is applied for each specified test case and for each value of $\\alpha \\in \\{0.0, 0.5, 1.0\\}$ to generate the final results.",
            "answer": "[[0.5853658536585366, 0.2222222222222222, 0.0], [0.0, 0.0, 0.0], [0.8571428571428571, 0.3333333333333333, 0.0], [0.8571428571428571, 0.8571428571428571, 0.0]]"
        }
    ]
}