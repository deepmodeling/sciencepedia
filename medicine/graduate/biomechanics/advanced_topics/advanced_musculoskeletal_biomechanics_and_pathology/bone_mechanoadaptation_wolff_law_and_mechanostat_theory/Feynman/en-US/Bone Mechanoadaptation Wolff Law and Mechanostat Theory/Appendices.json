{
    "hands_on_practices": [
        {
            "introduction": "This exercise will ground the abstract concept of a mechanical stimulus in the concrete language of continuum mechanics. You will calculate the strain energy density, a common proxy for the remodeling stimulus, directly from stress and strain tensors for a small volume of bone. This practice is crucial for understanding how macroscopic loads translate into a localized signal that individual bone cells can sense, forming the basis of mechanotransduction .",
            "id": "4161422",
            "problem": "Consider a small volume element of cortical bone undergoing infinitesimal deformations. Let the symmetric Cauchy stress tensor be denoted by $\\boldsymbol{\\sigma}$ and the symmetric small-strain tensor by $\\boldsymbol{\\varepsilon}$. In the framework of small-strain, linear elasticity, the internal power density is given by the work-conjugate pairing of stress and strain rate, and the strain energy density $U$ stored in the material is obtained by integrating the internal power density over a reversible loading path from the reference state to the current state. This energy density serves as a physically grounded mechanosensory signal in bone mechanoadaptation, consistent with Wolff’s law and mechanostat theory, where an energy-like stimulus normalized by mass density is often used to compare across tissue regions.\n\nStarting from the fundamental definition of internal power density per unit volume as $p_{\\text{int}}=\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}$ and the assumption of linear elasticity with a constant fourth-order stiffness tensor, derive the expression for the stored strain energy density $U$ at the current state $(\\boldsymbol{\\sigma},\\boldsymbol{\\varepsilon})$. Then, using the numerical tensors below, compute $U$ and the mass-normalized remodeling signal $S=U/\\rho$.\n\nThe stress and strain tensors at the current state are\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n60  12  0 \\\\\n12  45  5 \\\\\n0  5  30\n\\end{pmatrix}\\ \\text{MPa},\\qquad\n\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\n900  300  0 \\\\\n300  600  150 \\\\\n0  150  400\n\\end{pmatrix}\\ \\mu\\text{strain},\n$$\nwhere the entries of $\\boldsymbol{\\varepsilon}$ are the true components of the small-strain tensor (dimensionless) expressed in microstrain ($1\\ \\mu\\text{strain}=10^{-6}$), not engineering shear strains. Take the mass density to be\n$$\n\\rho=1900\\ \\text{kg}\\,\\text{m}^{-3}.\n$$\nUse the standard double contraction $\\,\\boldsymbol{A}:\\boldsymbol{B}=\\sum_{i=1}^{3}\\sum_{j=1}^{3}A_{ij}B_{ij}\\,$ and carefully handle unit conversions. Report the final normalized stimulus $S$ in joules per kilogram (J kg$^{-1}$). Round your final value of $S$ to four significant figures.",
            "solution": "The first part of the task is to derive the expression for the stored strain energy density, $U$, for a linear elastic material. The strain energy density is the work done per unit volume to deform the material from a stress-free and strain-free reference state to a final state of strain $\\boldsymbol{\\varepsilon}$ and stress $\\boldsymbol{\\sigma}$. The incremental work per unit volume, $dU$, done by the stress tensor $\\boldsymbol{\\sigma}'$ over an infinitesimal strain increment $d\\boldsymbol{\\varepsilon}'$ is given by $dU = \\boldsymbol{\\sigma}':d\\boldsymbol{\\varepsilon}'$. Integrating this from the reference state $(\\boldsymbol{\\sigma}'=\\mathbf{0}, \\boldsymbol{\\varepsilon}'=\\mathbf{0})$ to the final state $(\\boldsymbol{\\sigma}, \\boldsymbol{\\varepsilon})$ yields the total strain energy density:\n$$\nU = \\int_{\\mathbf{0}}^{\\boldsymbol{\\varepsilon}} \\boldsymbol{\\sigma}':d\\boldsymbol{\\varepsilon}'\n$$\nFor a linear elastic material, the stress is linearly proportional to the strain, described by the relation $\\boldsymbol{\\sigma} = \\boldsymbol{C}:\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{C}$ is the constant fourth-order stiffness tensor. For such materials, the strain energy density is a state function that depends only on the final strain state, not on the loading path taken. We can therefore choose a simple, proportional loading path to evaluate the integral. Let the path be parameterized by a scalar $\\lambda$ that varies from $0$ to $1$.\n$$\n\\boldsymbol{\\varepsilon}'(\\lambda) = \\lambda\\boldsymbol{\\varepsilon} \\quad \\text{for } \\lambda \\in [0, 1]\n$$\nThe corresponding stress along this path, due to linear elasticity, is:\n$$\n\\boldsymbol{\\sigma}'(\\lambda) = \\boldsymbol{C}:\\boldsymbol{\\varepsilon}'(\\lambda) = \\boldsymbol{C}:(\\lambda\\boldsymbol{\\varepsilon}) = \\lambda(\\boldsymbol{C}:\\boldsymbol{\\varepsilon}) = \\lambda\\boldsymbol{\\sigma}\n$$\nwhere $\\boldsymbol{\\sigma}$ is the stress at the final state. The differential of strain along this path is $d\\boldsymbol{\\varepsilon}'(\\lambda) = \\boldsymbol{\\varepsilon}\\,d\\lambda$. Substituting these expressions into the integral for $U$:\n$$\nU = \\int_{0}^{1} \\boldsymbol{\\sigma}'(\\lambda):d\\boldsymbol{\\varepsilon}'(\\lambda) = \\int_{0}^{1} (\\lambda\\boldsymbol{\\sigma}):(\\boldsymbol{\\varepsilon}\\,d\\lambda)\n$$\nSince the double contraction is a linear operation and $\\boldsymbol{\\sigma}$ and $\\boldsymbol{\\varepsilon}$ are constant with respect to the integration variable $\\lambda$, we can write:\n$$\nU = (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) \\int_{0}^{1} \\lambda\\,d\\lambda\n$$\nEvaluating the simple integral gives:\n$$\nU = (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) \\left[ \\frac{\\lambda^2}{2} \\right]_{0}^{1} = (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\n$$\nThis is the derived expression for the strain energy density in a linear elastic material.\n\nThe second part of the task is to compute $U$ and the normalized remodeling signal $S = U/\\rho$ using the provided numerical data. The formula for $U$ is $U = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\sigma_{ij}\\varepsilon_{ij}$.\nThe stress tensor is given in megapascals (MPa) and the strain tensor in microstrain ($\\mu$strain). We must ensure consistent units for the calculation.\n$1\\ \\text{MPa} = 10^{6}\\ \\text{Pa} = 10^{6}\\ \\text{N}\\,\\text{m}^{-2}$.\n$1\\ \\mu\\text{strain} = 10^{-6}$. Strain is a dimensionless quantity.\nThe product of stress and strain, $\\sigma_{ij}\\varepsilon_{ij}$, will have units of Pascals ($\\text{N}\\,\\text{m}^{-2}$), which is equivalent to Joules per cubic meter ($\\text{J}\\,\\text{m}^{-3}$), the correct unit for energy density. The factors of $10^{6}$ and $10^{-6}$ cancel, so we can directly multiply the numerical components as given, and the result for $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ will be in $\\text{J}\\,\\text{m}^{-3}$.\n\nThe given tensors are:\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n60  12  0 \\\\\n12  45  5 \\\\\n0  5  30\n\\end{pmatrix}\\ \\text{MPa},\\qquad\n\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\n900  300  0 \\\\\n300  600  150 \\\\\n0  150  400\n\\end{pmatrix}\\ \\mu\\text{strain}\n$$\nThe double contraction is computed as:\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{3}\\sum_{j=1}^{3}\\sigma_{ij}\\varepsilon_{ij}\n$$\nSubstituting the numerical values:\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = (60)(900) + (12)(300) + (0)(0) + (12)(300) + (45)(600) + (5)(150) + (0)(0) + (5)(150) + (30)(400)\n$$\n$$\n\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = 54000 + 3600 + 0 + 3600 + 27000 + 750 + 0 + 750 + 12000 = 101700\\ \\text{J}\\,\\text{m}^{-3}\n$$\nNow we can compute the strain energy density $U$:\n$$\nU = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\frac{1}{2} (101700\\ \\text{J}\\,\\text{m}^{-3}) = 50850\\ \\text{J}\\,\\text{m}^{-3}\n$$\nFinally, we compute the mass-normalized remodeling signal $S = U/\\rho$. The mass density is given as $\\rho=1900\\ \\text{kg}\\,\\text{m}^{-3}$.\n$$\nS = \\frac{U}{\\rho} = \\frac{50850\\ \\text{J}\\,\\text{m}^{-3}}{1900\\ \\text{kg}\\,\\text{m}^{-3}} = 26.763157...\\ \\text{J}\\,\\text{kg}^{-1}\n$$\nThe problem requires the final answer to be rounded to four significant figures.\n$$\nS \\approx 26.76\\ \\text{J}\\,\\text{kg}^{-1}\n$$",
            "answer": "$$\n\\boxed{26.76}\n$$"
        },
        {
            "introduction": "Moving from an instantaneous stimulus to a long-term biological response, this problem challenges you to apply the core tenets of Harold Frost's mechanostat theory. You will model a full day's loading history by translating different strain levels from various activities into a net remodeling signal, accounting for the \"lazy zone,\" disuse, and overload thresholds. This exercise demonstrates how daily routines can collectively steer bone towards net formation, resorption, or homeostasis .",
            "id": "4161488",
            "problem": "A bone’s load-bearing environment over a day can be described by a time-varying strain magnitude function $ \\varepsilon(t) $, measured in microstrain ($\\mu\\varepsilon$). In accordance with Wolff’s law and mechanostat theory, osteocytic signaling drives net remodeling toward restoring the strain to a homeostatic “lazy zone,” with disuse provoking net resorption and overuse provoking net formation. To formalize this, consider a scalar activation function $ a(\\varepsilon) $ that encodes the net remodeling drive based on the following mechanobiological constraints derived from the mechanostat:\n1. Within the lazy zone, $ \\varepsilon \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] $, the net drive is zero: bone targets maintenance with $ a(\\varepsilon) = 0 $.\n2. For hypostrain (below $ \\varepsilon_{\\mathrm{lazy}}^{-} $), the drive is negative, increasing in magnitude as $ \\varepsilon $ decreases, and reaches a negative plateau at the disuse threshold $ \\varepsilon_{\\mathrm{dis}} $. Assume $ a(\\varepsilon) = -1 $ for $ \\varepsilon \\le \\varepsilon_{\\mathrm{dis}} $, and that $ a(\\varepsilon) $ varies linearly on the interval $ (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}) $ with continuity at the endpoints.\n3. For hyperstrain (above $ \\varepsilon_{\\mathrm{lazy}}^{+} $), the drive is positive, increasing linearly up to the overload threshold $ \\varepsilon_{\\mathrm{over}} $, beyond which it reaches a positive plateau. Assume $ a(\\varepsilon) = +1 $ for $ \\varepsilon \\ge \\varepsilon_{\\mathrm{over}} $, and that $ a(\\varepsilon) $ varies linearly on $ (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $ with continuity at the endpoints.\n\nYou are given thresholds\n$ \\varepsilon_{\\mathrm{dis}} = 500\\,\\mu\\varepsilon $, $ \\varepsilon_{\\mathrm{lazy}}^{-} = 800\\,\\mu\\varepsilon $, $ \\varepsilon_{\\mathrm{lazy}}^{+} = 1500\\,\\mu\\varepsilon $, and $ \\varepsilon_{\\mathrm{over}} = 4000\\,\\mu\\varepsilon $.\n\nThe daily strain schedule is piecewise-constant over $ T = 24\\,\\mathrm{h} $:\n- Sleep: $ t \\in [0, 8]\\,\\mathrm{h} $, $ \\varepsilon(t) = 300\\,\\mu\\varepsilon $.\n- Sedentary work: $ t \\in [8, 18]\\,\\mathrm{h} $, $ \\varepsilon(t) = 1000\\,\\mu\\varepsilon $.\n- Vigorous exercise: $ t \\in [18, 20]\\,\\mathrm{h} $, $ \\varepsilon(t) = 4500\\,\\mu\\varepsilon $.\n- Evening walking: $ t \\in [20, 24]\\,\\mathrm{h} $, $ \\varepsilon(t) = 2000\\,\\mu\\varepsilon $.\n\nDefine the net daily remodeling signal as the time-average of the activation over the day,\n$$\n\\bar{a} = \\frac{1}{T}\\int_{0}^{T} a(\\varepsilon(t))\\,dt,\n$$\nwhich is dimensionless. Using the constraints above, construct a piecewise-linear $ a(\\varepsilon) $ that is continuous at all thresholds and compute $ \\bar{a} $ for the given schedule. Round your final numerical answer to four significant figures. Express the final quantity as a dimensionless number.",
            "solution": "The mechanostat constraints specify a “lazy zone” with zero activation, linear ramps outside that zone, and plateaus at the disuse and overload thresholds. We construct $ a(\\varepsilon) $ piecewise to satisfy continuity and the prescribed plateaus.\n\nFor hypostrain, we impose\n$$\na(\\varepsilon) = -1 \\quad \\text{for} \\quad \\varepsilon \\le \\varepsilon_{\\mathrm{dis}}.\n$$\nOn the interval $ (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}) $, we require $ a(\\varepsilon) $ to be linear and continuous, with $ a(\\varepsilon_{\\mathrm{dis}}) = -1 $ and $ a(\\varepsilon_{\\mathrm{lazy}}^{-}) = 0 $. A suitable form is\n$$\na(\\varepsilon) = -\\alpha\\left(\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon\\right), \\quad \\varepsilon \\in (\\varepsilon_{\\mathrm{dis}}, \\varepsilon_{\\mathrm{lazy}}^{-}),\n$$\nwith continuity at $ \\varepsilon_{\\mathrm{dis}} $ implying\n$$\n- \\alpha\\left(\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}\\right) = -1 \\quad \\Rightarrow \\quad \\alpha = \\frac{1}{\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}}.\n$$\n\nFor the lazy zone,\n$$\na(\\varepsilon) = 0 \\quad \\text{for} \\quad \\varepsilon \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}].\n$$\n\nFor hyperstrain, we impose\n$$\na(\\varepsilon) = +1 \\quad \\text{for} \\quad \\varepsilon \\ge \\varepsilon_{\\mathrm{over}}.\n$$\nOn the interval $ (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $, we require $ a(\\varepsilon) $ to be linear and continuous, with $ a(\\varepsilon_{\\mathrm{lazy}}^{+}) = 0 $ and $ a(\\varepsilon_{\\mathrm{over}}) = +1 $. A suitable form is\n$$\na(\\varepsilon) = \\beta\\left(\\varepsilon - \\varepsilon_{\\mathrm{lazy}}^{+}\\right), \\quad \\varepsilon \\in (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}),\n$$\nwith continuity at $ \\varepsilon_{\\mathrm{over}} $ implying\n$$\n\\beta\\left(\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}\\right) = 1 \\quad \\Rightarrow \\quad \\beta = \\frac{1}{\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}}.\n$$\n\nThus, the activation function is fully determined and continuous at all thresholds, with\n$$\n\\alpha = \\frac{1}{\\varepsilon_{\\mathrm{lazy}}^{-} - \\varepsilon_{\\mathrm{dis}}} = \\frac{1}{800 - 500} = \\frac{1}{300}, \\qquad\n\\beta = \\frac{1}{\\varepsilon_{\\mathrm{over}} - \\varepsilon_{\\mathrm{lazy}}^{+}} = \\frac{1}{4000 - 1500} = \\frac{1}{2500}.\n$$\n\nWe now evaluate $ a(\\varepsilon(t)) $ for each daily segment:\n\n1. Sleep, $ t \\in [0, 8]\\,\\mathrm{h} $, $ \\varepsilon(t) = 300\\,\\mu\\varepsilon $. Since $ \\varepsilon(t) \\le \\varepsilon_{\\mathrm{dis}} $, we have\n$$\na(\\varepsilon(t)) = -1.\n$$\n\n2. Sedentary work, $ t \\in [8, 18]\\,\\mathrm{h} $, $ \\varepsilon(t) = 1000\\,\\mu\\varepsilon $. Since $ \\varepsilon(t) \\in [\\varepsilon_{\\mathrm{lazy}}^{-}, \\varepsilon_{\\mathrm{lazy}}^{+}] $, we have\n$$\na(\\varepsilon(t)) = 0.\n$$\n\n3. Vigorous exercise, $ t \\in [18, 20]\\,\\mathrm{h} $, $ \\varepsilon(t) = 4500\\,\\mu\\varepsilon $. Since $ \\varepsilon(t) \\ge \\varepsilon_{\\mathrm{over}} $, we have\n$$\na(\\varepsilon(t)) = +1.\n$$\n\n4. Evening walking, $ t \\in [20, 24]\\,\\mathrm{h} $, $ \\varepsilon(t) = 2000\\,\\mu\\varepsilon $. Since $ \\varepsilon(t) \\in (\\varepsilon_{\\mathrm{lazy}}^{+}, \\varepsilon_{\\mathrm{over}}) $, we have\n$$\na(\\varepsilon(t)) = \\beta\\left(\\varepsilon(t) - \\varepsilon_{\\mathrm{lazy}}^{+}\\right) = \\frac{1}{2500}\\left(2000 - 1500\\right) = \\frac{500}{2500} = 0.2.\n$$\n\nThe net daily remodeling signal is the time-average\n$$\n\\bar{a} = \\frac{1}{T}\\int_{0}^{T} a(\\varepsilon(t))\\,dt,\n$$\nwhich, for a piecewise-constant $ a(\\varepsilon(t)) $, reduces to a duration-weighted average:\n$$\n\\bar{a} = \\frac{1}{24}\\Big[(-1)\\cdot 8 + 0 \\cdot 10 + (+1)\\cdot 2 + (0.2)\\cdot 4\\Big].\n$$\nCompute the sum inside the brackets:\n$$\n(-1)\\cdot 8 = -8, \\quad 0 \\cdot 10 = 0, \\quad (+1)\\cdot 2 = 2, \\quad (0.2)\\cdot 4 = 0.8,\n$$\nso\n$$\n\\bar{a} = \\frac{-8 + 0 + 2 + 0.8}{24} = \\frac{-5.2}{24} = -0.216\\overline{6}.\n$$\n\nRounding to four significant figures yields\n$$\n\\bar{a} \\approx -0.2167.\n$$\n\nThe quantity $ \\bar{a} $ is dimensionless, as defined.",
            "answer": "$$\\boxed{-0.2167}$$"
        },
        {
            "introduction": "The final step in modeling mechanoadaptation is to simulate the actual change in bone tissue over time. This computational exercise puts the theory into practice by having you implement a single time-step of a bone density update algorithm based on the stimulus calculated from mechanostat principles. This practice is fundamental to the field of computational biomechanics and highlights practical challenges, such as ensuring that simulated biological quantities like density remain within physically realistic bounds .",
            "id": "4161426",
            "problem": "Consider a mechanobiological update of bone apparent density based on a linearized mechanostat formulation. Let the apparent density be denoted by $\\rho$ with units $\\mathrm{kg/m^3}$. Assume a scalar mechanical stimulus $S$ that is a dimensionless strain measure, and a target setpoint $S_0$ (dimensionless) such that remodeling aims to reduce the deviation $S - S_0$. Let the adaptation rate constant be $\\kappa$ with units $\\mathrm{kg/(m^3 \\cdot s)}$, and let $\\Delta t$ be the time-step size in seconds. The physical bounds for apparent density are specified as $\\rho_{\\min}$ and $\\rho_{\\max}$, both in $\\mathrm{kg/m^3}$, and represent realistic lower and upper bounds for bone apparent density.\n\nStarting from widely accepted mechanostat theory that bone remodeling rate is proportional to the deviation of mechanical stimulus from a homeostatic setpoint (Wolff's law as captured by a linear mechanostat), one commonly models the temporal evolution of apparent density by an ordinary differential equation (ODE): $\\dfrac{d \\rho}{dt} \\propto S - S_0$. A forward Euler single-step explicit time discretization leads to a density update of the form\n$$\n\\rho^{n+1} = \\rho^n + \\Delta t \\, \\kappa \\, (S^n - S_0).\n$$\nIn this formulation, $\\rho^n$ and $S^n$ denote the apparent density and stimulus at time step $n$, respectively, and $\\rho^{n+1}$ denotes the updated density at the next step.\n\nYour task is to write a program that, for a given set of parameters $(\\rho^n, \\Delta t, \\kappa, S^n, S_0, \\rho_{\\min}, \\rho_{\\max})$, computes the single-step update $\\rho^{n+1}$ using the above equation and assesses whether the updated density violates the physical bounds, i.e., whether $\\rho^{n+1}  \\rho_{\\min}$ or $\\rho^{n+1}  \\rho_{\\max}$. Treat the bounds as inclusive; therefore, no violation occurs if $\\rho^{n+1}$ equals exactly $\\rho_{\\min}$ or $\\rho_{\\max}$. The program should not clamp or otherwise alter $\\rho^{n+1}$; it should only compute the update and report whether the bounds are violated.\n\nExpress all densities in $\\mathrm{kg/m^3}$ and the time-step in seconds. The mechanical stimulus $S$ and setpoint $S_0$ are dimensionless strains. The final updated density value for each test case must be reported as a float rounded to three decimal places, and the violation assessment as a boolean.\n\nImplement your program to process the following test suite, chosen to cover typical behavior, boundary interactions, zero-step behavior, and edge conditions:\n- Case 1 (general stable increase within bounds): $\\rho^n = 1000.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.02\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0020$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n- Case 2 (increase pushing above upper bound): $\\rho^n = 1199.9\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.05\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0022$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n- Case 3 (decrease pushing below lower bound): $\\rho^n = 300.5\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.03\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0012$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n- Case 4 (zero time step): $\\rho^n = 800.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 0\\,\\mathrm{s}$, $\\kappa = 0.02\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0030$, $S_0 = 0.0020$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n- Case 5 (exact setpoint, no change): $\\rho^n = 500.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.10\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0020$, $S_0 = 0.0020$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n- Case 6 (moderate decrease near lower bound but within limits): $\\rho^n = 305.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.01\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0010$, $S_0 = 0.0018$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n- Case 7 (upper bound exact value with increasing trend): $\\rho^n = 1200.0\\,\\mathrm{kg/m^3}$, $\\Delta t = 86400\\,\\mathrm{s}$, $\\kappa = 0.01\\,\\mathrm{kg/(m^3 \\cdot s)}$, $S^n = 0.0025$, $S_0 = 0.0020$, $\\rho_{\\min} = 300.0\\,\\mathrm{kg/m^3}$, $\\rho_{\\max} = 1200.0\\,\\mathrm{kg/m^3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of two elements: the updated density $\\rho^{n+1}$ in $\\mathrm{kg/m^3}$ rounded to three decimal places, and a boolean indicating whether the bounds were violated. For example, the final output format should look like\n$$\n[\\,[\\rho^{n+1}_{\\text{case 1}}, \\text{violation}_{\\text{case 1}}], [\\rho^{n+1}_{\\text{case 2}}, \\text{violation}_{\\text{case 2}}], \\dots ].\n$$",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in the principles of bone mechanobiology, specifically mechanostat theory, and is well-posed with all necessary information provided.\n\nThe task is to compute the change in bone apparent density, $\\rho$, over a single time step, $\\Delta t$, based on a simplified linear mechanostat model. This model formalizes the core concept of Wolff's Law, which posits that bone adapts its structure in response to the mechanical loads it experiences.\n\nThe governing principle is that the rate of change of bone density, $\\dfrac{d \\rho}{dt}$, is proportional to the difference between the current mechanical stimulus, $S$, and a homeostatic equilibrium stimulus, $S_0$. A positive deviation, $S  S_0$, signals an overloaded state, prompting bone formation (an increase in $\\rho$). Conversely, a negative deviation, $S  S_0$, indicates underloading, leading to bone resorption (a decrease in $\\rho$). This relationship is expressed as a simple ordinary differential equation (ODE):\n$$\n\\frac{d \\rho}{dt} = \\kappa (S - S_0)\n$$\nwhere $\\kappa$ is the adaptation rate constant, dictating the speed of the remodeling response. The units of $\\kappa$ are $\\mathrm{kg/(m^3 \\cdot s)}$, ensuring dimensional consistency, as the right-hand side becomes $(\\mathrm{kg/(m^3 \\cdot s)}) \\cdot (\\text{dimensionless}) = \\mathrm{kg/(m^3 \\cdot s)}$, which matches the units of $\\dfrac{d \\rho}{dt}$.\n\nTo solve this ODE numerically, we employ the forward Euler method, a single-step explicit time integration scheme. Given the density $\\rho^n$ and stimulus $S^n$ at time step $n$, the density at the next time step, $\\rho^{n+1}$, is approximated by:\n$$\n\\rho^{n+1} \\approx \\rho^n + \\Delta t \\left. \\frac{d \\rho}{dt} \\right|_{t=t^n}\n$$\nSubstituting the model's ODE gives the update equation provided in the problem statement:\n$$\n\\rho^{n+1} = \\rho^n + \\Delta t \\, \\kappa \\, (S^n - S_0)\n$$\n\nThe core of the assigned task involves two parts for each given parameter set:\n1.  **Computation**: Calculate the updated density $\\rho^{n+1}$ using the formula above. The result for the density is to be rounded to three decimal places.\n2.  **Validation**: Assess whether the computed $\\rho^{n+1}$ falls outside the specified physiological bounds $[\\rho_{\\min}, \\rho_{\\max}]$. A violation occurs if and only if $\\rho^{n+1}  \\rho_{\\min}$ or $\\rho^{n+1}  \\rho_{\\max}$. The bounds themselves are inclusive.\n\nWe will process each test case by applying this two-step procedure.\n\n**Case 1**: $(\\rho^n = 1000.0, \\Delta t = 86400, \\kappa = 0.02, S^n = 0.0020, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1000.0 + 86400 \\cdot 0.02 \\cdot (0.0020 - 0.0018) = 1000.0 + 0.3456 = 1000.3456$.\n-   Rounded $\\rho^{n+1} = 1000.346$.\n-   Violation check: $300.0 \\le 1000.3456 \\le 1200.0$. This is true. No violation.\n\n**Case 2**: $(\\rho^n = 1199.9, \\Delta t = 86400, \\kappa = 0.05, S^n = 0.0022, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1199.9 + 86400 \\cdot 0.05 \\cdot (0.0022 - 0.0018) = 1199.9 + 1.728 = 1201.628$.\n-   Rounded $\\rho^{n+1} = 1201.628$.\n-   Violation check: $1201.628  1200.0$. A violation occurs.\n\n**Case 3**: $(\\rho^n = 300.5, \\Delta t = 86400, \\kappa = 0.03, S^n = 0.0012, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 300.5 + 86400 \\cdot 0.03 \\cdot (0.0012 - 0.0018) = 300.5 - 1.5552 = 298.9448$.\n-   Rounded $\\rho^{n+1} = 298.945$.\n-   Violation check: $298.9448  300.0$. A violation occurs.\n\n**Case 4**: $(\\rho^n = 800.0, \\Delta t = 0, \\kappa = 0.02, S^n = 0.0030, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 800.0 + 0 \\cdot 0.02 \\cdot (0.0030 - 0.0020) = 800.0$.\n-   Rounded $\\rho^{n+1} = 800.000$.\n-   Violation check: $300.0 \\le 800.0 \\le 1200.0$. This is true. No violation.\n\n**Case 5**: $(\\rho^n = 500.0, \\Delta t = 86400, \\kappa = 0.10, S^n = 0.0020, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 500.0 + 86400 \\cdot 0.10 \\cdot (0.0020 - 0.0020) = 500.0$.\n-   Rounded $\\rho^{n+1} = 500.000$.\n-   Violation check: $300.0 \\le 500.0 \\le 1200.0$. This is true. No violation.\n\n**Case 6**: $(\\rho^n = 305.0, \\Delta t = 86400, \\kappa = 0.01, S^n = 0.0010, S_0 = 0.0018, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 305.0 + 86400 \\cdot 0.01 \\cdot (0.0010 - 0.0018) = 305.0 - 0.6912 = 304.3088$.\n-   Rounded $\\rho^{n+1} = 304.309$.\n-   Violation check: $300.0 \\le 304.3088 \\le 1200.0$. This is true. No violation.\n\n**Case 7**: $(\\rho^n = 1200.0, \\Delta t = 86400, \\kappa = 0.01, S^n = 0.0025, S_0 = 0.0020, \\rho_{\\min} = 300.0, \\rho_{\\max} = 1200.0)$\n-   $\\rho^{n+1} = 1200.0 + 86400 \\cdot 0.01 \\cdot (0.0025 - 0.0020) = 1200.0 + 0.432 = 1200.432$.\n-   Rounded $\\rho^{n+1} = 1200.432$.\n-   Violation check: $1200.432  1200.0$. A violation occurs.\n\nThese calculations will be implemented in the provided Python environment to produce the final output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes single-step updates of bone apparent density using a linearized\n    mechanostat model and checks for physical bound violations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho_n, dt, kappa, S_n, S_0, rho_min, rho_max)\n    test_cases = [\n        (1000.0, 86400.0, 0.02, 0.0020, 0.0018, 300.0, 1200.0), # Case 1\n        (1199.9, 86400.0, 0.05, 0.0022, 0.0018, 300.0, 1200.0), # Case 2\n        (300.5, 86400.0, 0.03, 0.0012, 0.0018, 300.0, 1200.0), # Case 3\n        (800.0, 0.0, 0.02, 0.0030, 0.0020, 300.0, 1200.0),     # Case 4\n        (500.0, 86400.0, 0.10, 0.0020, 0.0020, 300.0, 1200.0), # Case 5\n        (305.0, 86400.0, 0.01, 0.0010, 0.0018, 300.0, 1200.0), # Case 6\n        (1200.0, 86400.0, 0.01, 0.0025, 0.0020, 300.0, 1200.0)  # Case 7\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        rho_n, dt, kappa, S_n, S_0, rho_min, rho_max = case\n\n        # Compute the updated density using the forward Euler update rule\n        # rho_{n+1} = rho_n + dt * kappa * (S_n - S_0)\n        rho_np1_raw = rho_n + dt * kappa * (S_n - S_0)\n\n        # Check for violation of physical bounds.\n        # Violation occurs if rho_{n+1} is strictly outside the [rho_min, rho_max] range.\n        violation = (rho_np1_raw  rho_min) or (rho_np1_raw > rho_max)\n\n        # Round the resulting density to three decimal places, as specified.\n        rho_np1_rounded = round(rho_np1_raw, 3)\n        \n        # Store the result pair (rounded density, violation status)\n        result = [rho_np1_rounded, violation]\n        results.append(result)\n\n    # The final print statement must follow the exact specified format.\n    # The template produces a string representation of a list of lists.\n    # str() on a list in Python includes spaces, which is acceptable.\n    # e.g., \"[[val1, bool1], [val2, bool2]]\"\n    # Using repr() would be more explicit but str() is fine.\n    print(str(results).replace(\"'\", \"\"))\n\n# Execute the function to generate the output\n# solve() -> [[1000.346, False], [1201.628, True], [298.945, True], [800.0, False], [500.0, False], [304.309, False], [1200.432, True]]\n# The output format requested is slightly different from what the original code produced.\n# \"[[val1, bool1],[val2, bool2]]\" vs \"[ [val1, bool1], [val2, bool2] ]\"\n# Let's adjust the print statement to be more compliant with the example.\n# It wants a comma-separated list of items.\nprint(f\"[{','.join(map(str, results))}]\".replace(\"'\", \"\").replace(\" \", \"\"))\n```"
        }
    ]
}