{
    "hands_on_practices": [
        {
            "introduction": "The Hill-type muscle model is a cornerstone of biomechanical simulation, providing a phenomenological framework to predict muscle force. This practice moves beyond the simple notion of force being proportional to activation, incorporating the fundamental dependencies on muscle fascicle length and velocity. By applying the standard nonlinear force-length and force-velocity relationships , you will calculate the instantaneous force produced by the biceps brachii, gaining hands-on experience with the components that define a muscle's dynamic contractile behavior.",
            "id": "4202525",
            "problem": "A subject performs steady elbow flexion against a moderate external resistance. At a particular instant, ultrasound imaging and motion capture report a biceps brachii fascicle length of $l = 0.110 \\ \\mathrm{m}$ and a fiber shortening velocity of $v = 0.420 \\ \\mathrm{m/s}$ (positive for shortening). Surface electromyography-derived activation is estimated as $a = 0.600$. Assume angles used in computation are in radians; the initial pennation angle at optimal fiber length is provided in degrees and must be converted to radians before use. The biceps brachii is modeled as a Hill-type muscle with parameters calibrated for elbow flexors:\n\n- Maximum isometric fiber force at optimal fascicle length: $F_{\\max} = 850 \\ \\mathrm{N}$.\n- Optimal fascicle length: $l_0 = 0.105 \\ \\mathrm{m}$.\n- Maximum shortening velocity: $V_{\\max} = 12 \\, l_0 / \\mathrm{s}$.\n- Pennation angle at $l_0$: $\\phi_0 = 5^{\\circ}$.\n- Active force–length width factor: $w = 0.25$.\n- Passive force–length constants: $k_{pe} = 4.0$ and $k_p = 0.02$ (dimensionless scaling).\n- Hill hyperbola force–velocity ratio parameter: $c = \\frac{a_H}{F_{\\max}} = 0.25$, where $a_H$ is the classical Hill constant (with units of force).\n\nAssume a standard Hill-type composition: an active contractile element in parallel with passive elastic tissues, with tendon-aligned force obtained by projecting fiber force through the pennation angle. Use a Gaussian active force–length relation centered at $l_0$ with width factor $w$, the classical Hill hyperbolic force–velocity relation parameterized by $c$ and $V_{\\max}$, an exponential passive force–length relation parameterized by $k_{pe}$ and $k_p$, and constant-thickness pennation kinematics. Compute the instantaneous biceps muscle force aligned with the tendon under these conditions. Express your final answer in $\\mathrm{N}$. Round your answer to four significant figures.",
            "solution": "### Solution Derivation\nThe total force generated by the muscle and transmitted to the tendon, $F_{tendon}$, is the sum of the active force ($F_{active}$) and passive force ($F_{passive}$) generated along the muscle fibers, projected onto the line of action of the tendon via the cosine of the pennation angle, $\\phi$.\n$$F_{tendon} = (F_{active} + F_{passive}) \\cos(\\phi)$$\nThe solution proceeds by calculating each component of this equation.\n\n**1. Normalized Fiber Length ($\\tilde{l}$)**\nThe fiber length is normalized by the optimal fiber length $l_0$.\n$$\\tilde{l} = \\frac{l}{l_0} = \\frac{0.110 \\ \\mathrm{m}}{0.105 \\ \\mathrm{m}} = \\frac{22}{21} \\approx 1.04762$$\n\n**2. Active Force Component ($F_{active}$)**\nThe active force is a product of the maximum isometric force, activation level, and dimensionless factors for force-length ($f_{AL}$) and force-velocity ($f_V$) relationships.\n$$F_{active} = F_{\\max} \\cdot a \\cdot f_{AL}(\\tilde{l}) \\cdot f_V(v)$$\n\n**2a. Active Force-Length Factor ($f_{AL}$)**\nThe Gaussian relationship for the active force-length factor is:\n$$f_{AL}(\\tilde{l}) = \\exp\\left( -\\frac{(\\tilde{l}-1)^2}{w^2} \\right)$$\nSubstituting the values:\n$$f_{AL} = \\exp\\left( -\\frac{(22/21 - 1)^2}{0.25^2} \\right) = \\exp\\left( -\\frac{(1/21)^2}{(1/4)^2} \\right) = \\exp\\left( -\\frac{1/441}{1/16} \\right) = \\exp\\left(-\\frac{16}{441}\\right)$$\n$$f_{AL} \\approx 0.964370$$\n\n**2b. Force-Velocity Factor ($f_V$)**\nFirst, we calculate the maximum shortening velocity, $V_{\\max}$:\n$$V_{\\max} = 12 \\cdot l_0 = 12 \\cdot 0.105 \\ \\mathrm{m/s} = 1.26 \\ \\mathrm{m/s}$$\nThe force-velocity factor for a concentric contraction ($v>0$) based on the classical Hill equation, parameterized by $c$, is:\n$$f_V(v) = \\frac{(1+c)(c V_{\\max})}{v + c V_{\\max}} - c$$\nSubstituting the values:\n$$c V_{\\max} = 0.25 \\cdot 1.26 \\ \\mathrm{m/s} = 0.315 \\ \\mathrm{m/s}$$\n$$f_V = \\frac{(1+0.25)(0.315)}{0.420 + 0.315} - 0.25 = \\frac{1.25 \\cdot 0.315}{0.735} - 0.25 = \\frac{0.39375}{0.735} - 0.25$$\nThis simplifies to:\n$$f_V = \\frac{15}{28} - \\frac{7}{28} = \\frac{8}{28} = \\frac{2}{7} \\approx 0.285714$$\n\n**2c. Calculation of $F_{active}$**\nNow we combine the factors to find the active force:\n$$F_{active} = 850 \\ \\mathrm{N} \\cdot 0.600 \\cdot \\exp\\left(-\\frac{16}{441}\\right) \\cdot \\frac{2}{7}$$\n$$F_{active} \\approx 510 \\ \\mathrm{N} \\cdot 0.964370 \\cdot 0.285714 \\approx 140.5225 \\ \\mathrm{N}$$\n\n**3. Passive Force Component ($F_{passive}$)**\nThe passive force is calculated using the provided exponential relationship. Since $\\tilde{l} > 1$, the muscle is stretched beyond its slack length (assumed to be $l_0$), and passive force is generated.\n$$F_{passive} = F_{\\max} \\cdot k_p \\left( \\exp \\left( k_{pe}(\\tilde{l}-1) \\right) - 1 \\right)$$\nSubstituting the values:\n$$F_{passive} = 850 \\ \\mathrm{N} \\cdot 0.02 \\left( \\exp \\left( 4.0\\left(\\frac{22}{21}-1\\right) \\right) - 1 \\right) = 17 \\ \\mathrm{N} \\cdot \\left( \\exp\\left(\\frac{4}{21}\\right) - 1 \\right)$$\n$$F_{passive} \\approx 17 \\ \\mathrm{N} \\cdot (1.209822 - 1) \\approx 3.56698 \\ \\mathrm{N}$$\n\n**4. Pennation Angle ($\\phi$)**\nThe constant-thickness pennation model is described by $l \\sin(\\phi) = l_0 \\sin(\\phi_0)$. First, we convert the initial pennation angle $\\phi_0$ to radians.\n$$\\phi_0 = 5^{\\circ} = 5 \\cdot \\frac{\\pi}{180} \\ \\mathrm{rad}$$\nThe instantaneous pennation angle $\\phi$ is found by:\n$$\\sin(\\phi) = \\frac{l_0}{l} \\sin(\\phi_0) = \\frac{0.105}{0.110} \\sin\\left(5^{\\circ}\\right) = \\frac{21}{22} \\sin\\left(5^{\\circ}\\right)$$\n$$\\sin(\\phi) \\approx \\frac{21}{22} \\cdot 0.087156 \\approx 0.083204$$\nWe need $\\cos(\\phi)$ for the force projection:\n$$\\cos(\\phi) = \\sqrt{1 - \\sin^2(\\phi)} = \\sqrt{1 - \\left(\\frac{21}{22} \\sin(5^{\\circ})\\right)^2}$$\n$$\\cos(\\phi) \\approx \\sqrt{1 - (0.083204)^2} \\approx \\sqrt{0.993077} \\approx 0.996532$$\n\n**5. Total Tendon Force ($F_{tendon}$)**\nFinally, we assemble the components to calculate the total force along the tendon.\nFirst, the total force along the fibers:\n$$F_{fiber} = F_{active} + F_{passive} \\approx 140.5225 \\ \\mathrm{N} + 3.56698 \\ \\mathrm{N} = 144.0895 \\ \\mathrm{N}$$\nThen, project this force onto the tendon axis:\n$$F_{tendon} = F_{fiber} \\cdot \\cos(\\phi) \\approx 144.0895 \\ \\mathrm{N} \\cdot 0.996532 \\approx 143.5855 \\ \\mathrm{N}$$\n\nRounding the final answer to four significant figures as requested gives $143.6 \\ \\mathrm{N}$.",
            "answer": "$$\\boxed{143.6}$$"
        },
        {
            "introduction": "A muscle's ability to generate joint torque is not determined by its force alone, but by the effective lever it acts upon—its moment arm. This exercise delves into the subtle but critical distinction between a muscle's purely geometric moment arm and its *dynamic* or *effective* moment arm. Through a focused analysis of the supraspinatus , you will see how joint reaction forces, an integral part of joint mechanics, can alter a muscle's mechanical advantage, demonstrating that a muscle's function is inseparable from the mechanics of the joint it crosses.",
            "id": "4202486",
            "problem": "A two-dimensional scapular-plane model of the Glenohumeral (GH) joint is considered to study the abduction torque contribution of the supraspinatus muscle. The GH joint center is located at the origin, with the lateral axis along $x$ and the superior axis along $y$. The abduction axis is orthogonal to the plane (out of page), and positive abduction torque is defined by the right-hand rule.\n\nThe supraspinatus line-of-action is assumed straight in the scapular plane, oriented at an angle $\\theta$ above the positive $x$-axis, and exerts a tensile force of magnitude $F$ along the unit vector $\\mathbf{u}_{m} = (\\cos\\theta,\\, \\sin\\theta)$. The muscle’s line-of-action passes through the insertion point located at $\\mathbf{p} = (a,\\, b)$ relative to the GH joint center. The geometric moment arm for abduction is the perpendicular distance from the GH center to the supraspinatus line-of-action.\n\nThe GH contact reaction force is modeled under two different joint reaction force conditions:\n1. Central contact: the reaction acts at the joint center, $\\mathbf{r}_{c} = (0,\\, 0)$.\n2. Superior-offset contact: the reaction acts at $\\mathbf{r}_{c} = (0,\\, d)$ with $d > 0$ (superior to center), and the reaction direction is colinear and opposite to the supraspinatus line-of-action, $\\mathbf{u}_{r} = -\\mathbf{u}_{m}$.\n\nAssume quasi-static equilibrium with no other external forces and no acceleration, so the net force is zero and the reaction magnitude adjusts to satisfy force balance. Under these assumptions, the total abduction torque about the GH center is the sum of the supraspinatus torque and the reaction torque about the origin. The dynamic (effective) moment arm is defined as $r_{\\text{eff}} = \\partial \\tau / \\partial F$, where $\\tau$ is the net abduction torque.\n\nGiven the parameters $a = 0.025\\,\\text{m}$, $b = 0.005\\,\\text{m}$, $\\theta = 30^{\\circ}$, and $d = 0.004\\,\\text{m}$, compute the dynamic effective moment arm $r_{\\text{eff}}$ for the two conditions described above. Express both values in meters, and present them in a single row matrix in the order $\\big[$central contact, superior-offset contact$\\big]$. Round your answers to four significant figures. Use degrees for any angles if needed.",
            "solution": "The goal is to derive the effective moment arm $r_{\\text{eff}} = \\partial \\tau / \\partial F$ from first principles, starting with Newton’s laws and the definition of torque.\n\nDefine the supraspinatus unit direction as $\\mathbf{u}_{m} = (\\cos\\theta,\\, \\sin\\theta)$ and its force vector as $\\mathbf{F}_{m} = F\\,\\mathbf{u}_{m}$. The reaction force vector is $\\mathbf{F}_{r} = R\\,\\mathbf{u}_{r}$, where the unit direction $\\mathbf{u}_{r}$ is opposite to the supraspinatus direction by the two-force equilibrium assumption (no other external forces), so $\\mathbf{u}_{r} = -\\mathbf{u}_{m}$.\n\nBy quasi-static force equilibrium,\n$$\n\\mathbf{F}_{m} + \\mathbf{F}_{r} = \\mathbf{0} \\quad \\Rightarrow \\quad F\\,\\mathbf{u}_{m} + R\\,(-\\mathbf{u}_{m}) = \\mathbf{0} \\quad \\Rightarrow \\quad R = F.\n$$\nThus, the reaction magnitude $R$ equals the supraspinatus force magnitude $F$ and varies one-to-one with $F$.\n\nThe net abduction torque $\\tau$ about the GH center is the sum of torques due to the supraspinatus and the reaction, each computed as a two-dimensional cross product of position and force. For two-dimensional vectors $\\mathbf{r} = (x,\\, y)$ and $\\mathbf{F} = (F_{x},\\, F_{y})$, the scalar out-of-plane torque is\n$$\n\\tau_{z} = x\\,F_{y} - y\\,F_{x}.\n$$\n\nSupraspinatus torque about the origin: the force acts along its line-of-action passing through $\\mathbf{p} = (a,\\, b)$. In planar statics, the magnitude of the torque is the force times the perpendicular distance from the origin to the line-of-action, and the signed scalar torque is equivalently the cross product of any point on the line-of-action with the force direction:\n$$\n\\tau_{m} = F\\,(a\\,\\sin\\theta - b\\,\\cos\\theta).\n$$\nTherefore, the geometric moment arm (signed for abduction) is\n$$\nr_{\\text{geo}} = a\\,\\sin\\theta - b\\,\\cos\\theta.\n$$\n\nReaction torque about the origin depends on the application point $\\mathbf{r}_{c}$. Its torque is\n$$\n\\tau_{r} = x_{c}\\,(R\\,u_{r,y}) - y_{c}\\,(R\\,u_{r,x}).\n$$\nSince $\\mathbf{u}_{r} = -\\mathbf{u}_{m}$, $u_{r,x} = -\\cos\\theta$ and $u_{r,y} = -\\sin\\theta$. For the superior-offset contact with $\\mathbf{r}_{c} = (0,\\, d)$,\n$$\n\\tau_{r} = 0 \\cdot (R\\,(-\\sin\\theta)) - d \\cdot (R\\,(-\\cos\\theta)) = d\\,R\\,\\cos\\theta.\n$$\nFor the central contact, $\\mathbf{r}_{c} = (0,\\, 0)$, yielding $\\tau_{r} = 0$.\n\nCombining these, the net torque is\n$$\n\\tau = \\tau_{m} + \\tau_{r} = F\\,(a\\,\\sin\\theta - b\\,\\cos\\theta) + R\\,\\big(x_{c}\\,u_{r,y} - y_{c}\\,u_{r,x}\\big).\n$$\nWith $R = F$, and for the superior-offset case $x_{c} = 0$ and $y_{c} = d$, the reaction’s signed torque-per-unit-force is\n$$\ns_{r} \\equiv x_{c}\\,u_{r,y} - y_{c}\\,u_{r,x} = 0 \\cdot (-\\sin\\theta) - d \\cdot (-\\cos\\theta) = d\\,\\cos\\theta.\n$$\nThus, the net torque becomes\n$$\n\\tau = F\\,r_{\\text{geo}} + F\\,s_{r}.\n$$\nThe effective moment arm is the sensitivity of net torque to the supraspinatus force:\n$$\nr_{\\text{eff}} = \\frac{\\partial \\tau}{\\partial F} = r_{\\text{geo}} + s_{r}.\n$$\n\nEvaluate $r_{\\text{eff}}$ under the two reaction conditions:\n\n1. Central contact: $\\mathbf{r}_{c} = (0,\\, 0)$ implies $s_{r} = 0$, hence\n$$\nr_{\\text{eff,\\,central}} = r_{\\text{geo}} = a\\,\\sin\\theta - b\\,\\cos\\theta.\n$$\n\n2. Superior-offset contact: $\\mathbf{r}_{c} = (0,\\, d)$ implies $s_{r} = d\\,\\cos\\theta$, hence\n$$\nr_{\\text{eff,\\,superior}} = r_{\\text{geo}} + d\\,\\cos\\theta = a\\,\\sin\\theta - b\\,\\cos\\theta + d\\,\\cos\\theta.\n$$\n\nSubstitute the given numerical values $a = 0.025\\,\\text{m}$, $b = 0.005\\,\\text{m}$, $d = 0.004\\,\\text{m}$, and $\\theta = 30^{\\circ}$ with $\\sin 30^{\\circ} = \\frac{1}{2}$ and $\\cos 30^{\\circ} = \\frac{\\sqrt{3}}{2}$:\n\nGeometric moment arm:\n$$\nr_{\\text{geo}} = 0.025\\cdot\\frac{1}{2} - 0.005\\cdot\\frac{\\sqrt{3}}{2} = 0.0125 - 0.004330127\\ldots = 0.008169873\\ldots\\,\\text{m}.\n$$\n\nSuperior-offset reaction contribution:\n$$\nd\\,\\cos\\theta = 0.004 \\cdot \\frac{\\sqrt{3}}{2} = 0.003464102\\ldots\\,\\text{m}.\n$$\n\nEffective moment arms:\n$$\nr_{\\text{eff,\\,central}} = 0.008169873\\ldots\\,\\text{m},\n$$\n$$\nr_{\\text{eff,\\,superior}} = 0.008169873\\ldots + 0.003464102\\ldots = 0.011633975\\ldots\\,\\text{m}.\n$$\n\nRounding each to four significant figures and expressing in meters:\n$$\nr_{\\text{eff,\\,central}} \\approx 0.008170\\,\\text{m}, \\quad r_{\\text{eff,\\,superior}} \\approx 0.01163\\,\\text{m}.\n$$\n\nThese results show that when the joint reaction force acts at a superior offset, the effective moment arm increases relative to the geometric moment arm because the reaction contributes a co-directional abduction torque per unit supraspinatus force due to its noncentral application point.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.008170 & 0.01163\\end{pmatrix}}$$"
        },
        {
            "introduction": "Musculoskeletal systems are often redundant, meaning multiple muscles can contribute to a single task, and the body must choose a specific strategy to distribute the load among them. This practice explores this fundamental problem of muscle force-sharing within the rotator cuff using optimization theory, a primary tool for resolving such redundancy. You will implement a model  to predict how individual rotator cuff muscles are recruited to satisfy both moment and joint stability requirements, revealing how different physiological objectives can shape neuromuscular control strategies.",
            "id": "4202482",
            "problem": "A static shoulder abduction task is modeled to analyze rotator cuff load sharing under two optimization criteria: minimum activation and minimum stress. The rotator cuff muscles considered are supraspinatus, infraspinatus, subscapularis, and teres minor. The following assumptions are used to ground the formulation in fundamental biomechanics and to maintain scientific realism:\n\n- Static equilibrium in the abduction pose is considered, neglecting dynamics. Force balance and moment balance are applied in the glenohumeral joint.\n- Each muscle force $F_i$ is nonnegative and acts along a line whose compressive projection onto the glenoid is described by a scalar $p_i \\in [0,1]$ such that the compressive component equals $p_i F_i$.\n- A specified compressive requirement $C_{\\text{req}}$ must be met by the sum of compressive components of the rotator cuff: $\\sum_i p_i F_i = C_{\\text{req}}$.\n- The supraspinatus provides a specified portion of the abduction moment, while, for the selected pose, the abduction moment arms of infraspinatus, subscapularis, and teres minor are negligible relative to supraspinatus and are treated as zero. Thus, with supraspinatus abduction moment arm $r_{\\text{SS}}$, the cuff abduction moment requirement is $M_{\\text{cuff}}$ and satisfies $r_{\\text{SS}} F_{\\text{SS}} = M_{\\text{cuff}}$. All angles are constant in the pose, so no angle unit specification is needed.\n- The maximal isometric force $F_i^{\\max}$ for each muscle is proportional to its Physiological Cross-Sectional Area (PCSA) $A_i$ via a specific tension $\\sigma_0$, i.e., $F_i^{\\max} = \\sigma_0 A_i$. Units are maintained consistently with $A_i$ in $\\text{cm}^2$, $\\sigma_0$ in $\\text{N}/\\text{cm}^2$, and forces in $\\text{N}$.\n\nTwo convex optimization criteria are compared:\n\n1. Minimum activation criterion: minimize $\\sum_i a_i^2$ where $a_i = F_i / F_i^{\\max}$, subject to the linear equality constraints above.\n2. Minimum stress criterion: minimize $\\sum_i \\sigma_i^2$ where $\\sigma_i = F_i / A_i$, subject to the same constraints.\n\nBoth criteria can be written in quadratic form $\\min \\tfrac{1}{2} F^\\top Q F$ with equality constraints $A F = b$, where $F = [F_{\\text{SS}}, F_{\\text{IS}}, F_{\\text{SC}}, F_{\\text{TM}}]^\\top$, $A$ is a $2 \\times 4$ matrix whose first row is $[p_{\\text{SS}}, p_{\\text{IS}}, p_{\\text{SC}}, p_{\\text{TM}}]$ and whose second row is $[r_{\\text{SS}}, 0, 0, 0]$, and $b = [C_{\\text{req}}, M_{\\text{cuff}}]^\\top$. For the minimum activation criterion, $Q = \\operatorname{diag}(1/(F_i^{\\max})^2)$; for the minimum stress criterion, $Q = \\operatorname{diag}(1/A_i^2)$. The equality-constrained minimizer is given by a closed-form expression derived from Lagrange multipliers.\n\nYour program must implement both optimization criteria for the specified test suite and compute the tendon stress distribution $\\sigma_i = F_i / A_i$ for each case. For each test case, return the maximum tendon stress across the four rotator cuff muscles under each criterion. Express stresses in $\\text{N}/\\text{cm}^2$, rounded to three decimal places.\n\nFundamental constants and definitions to be used:\n- Specific tension $\\sigma_0 = 30$ $\\text{N}/\\text{cm}^2$.\n- PCSA values $A_i$ as specified per test case in $\\text{cm}^2$.\n- Compressive projection fractions $p_{\\text{SS}} = 0.95$, $p_{\\text{IS}} = 0.85$, $p_{\\text{SC}} = 0.90$, $p_{\\text{TM}} = 0.80$ (dimensionless).\n- Supraspinatus abduction moment arm $r_{\\text{SS}} = 0.02$ $\\text{m}$; all other cuff abduction moment arms are $0$ $\\text{m}$ for this pose.\n- Cuff abduction moment requirement $M_{\\text{cuff}}$ as specified per test case in $\\text{N}\\cdot\\text{m}$.\n- Compressive requirement $C_{\\text{req}}$ as specified per test case in $\\text{N}$.\n\nThe optimization is equality-constrained. In all test cases provided, the parameter values are chosen such that the equality-constrained solutions are nonnegative and physically plausible.\n\nTest suite to implement:\n- Case $1$ (baseline): $A_{\\text{SS}} = 6$ $\\text{cm}^2$, $A_{\\text{IS}} = 8$ $\\text{cm}^2$, $A_{\\text{SC}} = 15$ $\\text{cm}^2$, $A_{\\text{TM}} = 3$ $\\text{cm}^2$; $C_{\\text{req}} = 400$ $\\text{N}$; $M_{\\text{cuff}} = 3$ $\\text{N}\\cdot\\text{m}$.\n- Case $2$ (supraspinatus weakened): $A_{\\text{SS}} = 3$ $\\text{cm}^2$, $A_{\\text{IS}} = 8$ $\\text{cm}^2$, $A_{\\text{SC}} = 15$ $\\text{cm}^2$, $A_{\\text{TM}} = 3$ $\\text{cm}^2$; $C_{\\text{req}} = 400$ $\\text{N}$; $M_{\\text{cuff}} = 1.5$ $\\text{N}\\cdot\\text{m}$.\n- Case $3$ (high compression requirement): $A_{\\text{SS}} = 6$ $\\text{cm}^2$, $A_{\\text{IS}} = 8$ $\\text{cm}^2$, $A_{\\text{SC}} = 15$ $\\text{cm}^2$, $A_{\\text{TM}} = 3$ $\\text{cm}^2$; $C_{\\text{req}} = 800$ $\\text{N}$; $M_{\\text{cuff}} = 3$ $\\text{N}\\cdot\\text{m}$.\n- Case $4$ (subscapularis hypertrophy): $A_{\\text{SS}} = 6$ $\\text{cm}^2$, $A_{\\text{IS}} = 8$ $\\text{cm}^2$, $A_{\\text{SC}} = 20$ $\\text{cm}^2$, $A_{\\text{TM}} = 3$ $\\text{cm}^2$; $C_{\\text{req}} = 400$ $\\text{N}$; $M_{\\text{cuff}} = 3$ $\\text{N}\\cdot\\text{m}$.\n\nAlgorithmic requirements:\n- Use the equality-constrained quadratic minimizer $F^\\star = Q^{-1} A^\\top (A Q^{-1} A^\\top)^{-1} b$ for each criterion.\n- Compute tendon stresses $\\sigma_i = F_i^\\star / A_i$.\n- For each case, report the maximum $\\sigma_i$ across $i \\in \\{\\text{SS}, \\text{IS}, \\text{SC}, \\text{TM}\\}$ for the minimum activation solution and for the minimum stress solution.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, for Cases $1$ through $4$, the maximum tendon stress under the minimum activation criterion followed by the maximum tendon stress under the minimum stress criterion, all in $\\text{N}/\\text{cm}^2$ rounded to three decimal places. For example, the output format is $\\big[$result$_{1,\\text{min-activation}}$, result$_{1,\\text{min-stress}}$, result$_{2,\\text{min-activation}}$, result$_{2,\\text{min-stress}}$, $\\dots\\big]$.",
            "solution": "### Principle-Based Solution\n\nThe problem requires solving an equality-constrained quadratic program (QP) of the form:\n$$ \\min_{F} \\frac{1}{2} F^\\top Q F \\quad \\text{subject to} \\quad A F = b $$\nwhere $F = [F_{\\text{SS}}, F_{\\text{IS}}, F_{\\text{SC}}, F_{\\text{TM}}]^\\top$ is the vector of muscle forces.\n\nThe constraint matrix $A$ and vector $b$ are derived from the problem's equilibrium equations:\n$$\nA = \\begin{pmatrix} p_{\\text{SS}} & p_{\\text{IS}} & p_{\\text{SC}} & p_{\\text{TM}} \\\\ r_{\\text{SS}} & 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0.95 & 0.85 & 0.90 & 0.80 \\\\ 0.02 & 0 & 0 & 0 \\end{pmatrix}\n$$\n$$\nb = \\begin{pmatrix} C_{\\text{req}} \\\\ M_{\\text{cuff}} \\end{pmatrix}\n$$\n\n**Analysis of the Optimization Criteria**\n\nThe problem presents two criteria. We must examine their corresponding objective functions and weighting matrices $Q$.\n\n1.  **Minimum Activation:** The objective is to minimize $J_{\\text{act}} = \\sum_i a_i^2 = \\sum_i (F_i / F_i^{\\max})^2$. With the definition $F_i^{\\max} = \\sigma_0 A_i$, this becomes:\n    $$ J_{\\text{act}} = \\sum_i \\left( \\frac{F_i}{\\sigma_0 A_i} \\right)^2 = \\frac{1}{\\sigma_0^2} \\sum_i \\left( \\frac{F_i}{A_i} \\right)^2 $$\n    The corresponding weighting matrix for the $\\frac{1}{2}F^\\top Q F$ form is $Q_{\\text{act}} = \\operatorname{diag}\\left(2/(\\sigma_0 A_i)^2\\right)$.\n\n2.  **Minimum Stress:** The objective is to minimize $J_{\\text{stress}} = \\sum_i \\sigma_i^2 = \\sum_i (F_i / A_i)^2$.\n    The corresponding weighting matrix is $Q_{\\text{stress}} = \\operatorname{diag}\\left(2/A_i^2\\right)$.\n\nA crucial observation is the relationship between the two objectives:\n$$ J_{\\text{act}} = \\frac{1}{\\sigma_0^2} J_{\\text{stress}} $$\nSince $\\sigma_0$ is a positive constant ($\\sigma_0 = 30$), minimizing $J_{\\text{act}}$ is mathematically equivalent to minimizing $J_{\\text{stress}}$. Both optimization problems, under the same linear constraints $AF=b$, will yield the exact same optimal force vector $F^\\star$. Consequently, the resulting stress distribution $\\sigma_i^\\star = F_i^\\star / A_i$ will also be identical for both criteria. We therefore only need to solve the problem once per test case. We will use the \"minimum stress\" formulation due to its simpler algebraic form.\n\n**Simplified Solution Strategy**\n\nThe constraint matrix $A$ has a special structure. The second row, corresponding to the moment balance, gives a direct equation for $F_{\\text{SS}}$:\n$$ r_{\\text{SS}} F_{\\text{SS}} = M_{\\text{cuff}} \\implies F_{\\text{SS}} = \\frac{M_{\\text{cuff}}}{r_{\\text{SS}}} $$\nThis determines the supraspinatus force completely. We can substitute this known value into the first constraint equation (compressive force):\n$$ p_{\\text{SS}} F_{\\text{SS}} + p_{\\text{IS}} F_{\\text{IS}} + p_{\\text{SC}} F_{\\text{SC}} + p_{\\text{TM}} F_{\\text{TM}} = C_{\\text{req}} $$\nThis can be rearranged into a single constraint for the remaining three muscles (let's denote their set as $\\mathcal{M}' = \\{\\text{IS, SC, TM}\\}$):\n$$ \\sum_{j \\in \\mathcal{M}'} p_j F_j = C_{\\text{req}} - p_{\\text{SS}} F_{\\text{SS}} $$\nLet $b' = C_{\\text{req}} - p_{\\text{SS}} F_{\\text{SS}}$.\n\nThe optimization problem is reduced to finding the forces $F_j$ for $j \\in \\mathcal{M}'$ that minimize $\\sum_{j \\in \\mathcal{M}'} (F_j/A_j)^2$ subject to $\\sum_{j \\in \\mathcal{M}'} p_j F_j = b'$.\n\nWe solve this reduced problem using Lagrange multipliers. The Lagrangian is:\n$$ \\mathcal{L}(F_{\\text{IS}}, F_{\\text{SC}}, F_{\\text{TM}}, \\lambda) = \\sum_{j \\in \\mathcal{M}'} \\frac{1}{2} \\left(\\frac{F_j}{A_j}\\right)^2 + \\lambda \\left(b' - \\sum_{j \\in \\mathcal{M}'} p_j F_j\\right) $$\nNote: The factor of $1/2$ is added for convenience and does not change the minimizer.\nTaking the partial derivative with respect to each force $F_j$ and setting it to zero:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial F_j} = \\frac{F_j}{A_j^2} - \\lambda p_j = 0 \\implies F_j = \\lambda p_j A_j^2 $$\nSubstitute this back into the single constraint equation to find the Lagrange multiplier $\\lambda$:\n$$ \\sum_{j \\in \\mathcal{M}'} p_j (\\lambda p_j A_j^2) = b' \\implies \\lambda \\sum_{j \\in \\mathcal{M}'} p_j^2 A_j^2 = b' $$\n$$ \\lambda = \\frac{b'}{\\sum_{j \\in \\mathcal{M}'} p_j^2 A_j^2} $$\nOnce $\\lambda$ is known, we can find each force $F_j$. However, our goal is to find the stresses $\\sigma_j = F_j / A_j$. From the KKT condition $F_j = \\lambda p_j A_j^2$, we can directly derive the expression for stress:\n$$ \\sigma_j = \\frac{F_j}{A_j} = \\frac{\\lambda p_j A_j^2}{A_j} = \\lambda p_j A_j $$\n\n**Algorithm for Each Test Case:**\n1.  Calculate the supraspinatus force: $F_{\\text{SS}} = M_{\\text{cuff}} / r_{\\text{SS}}$.\n2.  Calculate the supraspinatus stress: $\\sigma_{\\text{SS}} = F_{\\text{SS}} / A_{\\text{SS}}$.\n3.  Calculate the remaining compressive force requirement: $b' = C_{\\text{req}} - p_{\\text{SS}} F_{\\text{SS}}$.\n4.  Calculate the denominator for the Lagrange multiplier: $S = \\sum_{j \\in \\mathcal{M}'} p_j^2 A_j^2$.\n5.  Calculate the Lagrange multiplier: $\\lambda = b'/S$.\n6.  Calculate the stresses for the other three muscles: $\\sigma_j = \\lambda p_j A_j$ for $j \\in \\{\\text{IS, SC, TM}\\}$.\n7.  The final stress vector is $\\sigma^\\star = [\\sigma_{\\text{SS}}, \\sigma_{\\text{IS}}, \\sigma_{\\text{SC}}, \\sigma_{\\text{TM}}]^\\top$.\n8.  The result for the test case is the maximum value in this vector, $\\max(\\sigma^\\star)$. This value is the same for both the minimum activation and minimum stress criteria.",
            "answer": "[25.000,25.000,25.000,25.000,37.892,37.892,25.000,25.000]"
        }
    ]
}