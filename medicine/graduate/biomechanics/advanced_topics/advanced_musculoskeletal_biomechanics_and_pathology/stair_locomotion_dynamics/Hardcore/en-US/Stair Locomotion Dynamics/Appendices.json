{
    "hands_on_practices": [
        {
            "introduction": "In experimental biomechanics, data is often captured in the local coordinate system of a measurement device, such as a force plate embedded in a stair. To synthesize this information and understand movement within the laboratory environment, we must first perform a rigorous coordinate transformation. This practice hones the fundamental skill of deriving and applying rotation matrices to express local force measurements in a global reference frame, a critical first step for any kinetic analysis. ",
            "id": "4205409",
            "problem": "Consider stair ascent where a rigid force plate is embedded flush with the tread surface of a single stair. Let the Global Laboratory Frame (GLF) be denoted by orthonormal basis vectors $\\hat{\\mathbf{X}}, \\hat{\\mathbf{Y}}, \\hat{\\mathbf{Z}}$, with $\\hat{\\mathbf{Z}}$ vertical and pointing upward. Let the Force Plate coordinate Frame (FPF) be denoted by $\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}$, with $\\hat{\\mathbf{z}}$ the surface normal of the tread, $\\hat{\\mathbf{x}}$ along the stair run (anterior-posterior), and $\\hat{\\mathbf{y}}$ lateral. The FPF is mounted at a pitch angle $\\alpha$ relative to the GLF by a right-handed rotation about $\\hat{\\mathbf{Y}}$, and at a yaw angle $\\psi$ by a right-handed rotation about $\\hat{\\mathbf{Z}}$. Angles $\\alpha$ and $\\psi$ are given in radians.\n\nThe force plate outputs a force vector $\\mathbf{F}_{L}$ and a free moment vector $\\mathbf{M}_{L}$, both expressed in the FPF and referenced to the plate’s origin. Using Newton’s laws and rigid body kinematics (including the definition of an orthonormal basis and the direction cosine relationships), perform the following:\n\n1. Derive the $3 \\times 3$ rotation matrix $C(\\alpha,\\psi)$ that maps any vector expressed in the FPF to the GLF, i.e., $\\mathbf{v}_{G} = C(\\alpha,\\psi)\\,\\mathbf{v}_{L}$. Your derivation must make explicit the composition of the yaw about $\\hat{\\mathbf{Z}}$ and the pitch about $\\hat{\\mathbf{Y}}$ as applied to the FPF relative to the GLF.\n\n2. Using the derived $C(\\alpha,\\psi)$, state the transformation of forces and free moments from the FPF to the GLF. Assume the moment reference points coincide (no translation between origins), and express the global free moment as a function of $\\mathbf{M}_{L}$, $\\mathbf{F}_{L}$, and $C(\\alpha,\\psi)$.\n\n3. Validation with a known static load case: A subject of mass $m = 83.4$ stands quietly with the vertical Ground Reaction Force (GRF) equal in magnitude to weight $W = m\\,g$ with $g = 9.81$. The GRF acts through the plate center so that there is no net moment due to force translation at the origin. Using your $C(\\alpha,\\psi)$, predict the local force $\\mathbf{F}_{L}$ that would be measured for a global vertical GRF $$\\mathbf{F}_{G} = \\begin{pmatrix}0 \\\\ 0 \\\\ W\\end{pmatrix}$$, and then transform back to the GLF to recover the vertical component. Report the recovered global vertical force component as a single scalar. Round your answer to four significant figures. Express the final force in newtons (N). Angles are in radians; the numerical value of $\\alpha$ and $\\psi$ is not required for the validation step.\n\nThe final answer must be a single real-valued number.",
            "solution": "The user-provided problem is critically evaluated against the established criteria before a solution is attempted.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n-   **Global Laboratory Frame (GLF)**: Orthonormal basis vectors $\\hat{\\mathbf{X}}, \\hat{\\mathbf{Y}}, \\hat{\\mathbf{Z}}$, with $\\hat{\\mathbf{Z}}$ vertical and pointing upward.\n-   **Force Plate coordinate Frame (FPF)**: Orthonormal basis vectors $\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}$, with $\\hat{\\mathbf{z}}$ as the surface normal of the tread, $\\hat{\\mathbf{x}}$ along the stair run, and $\\hat{\\mathbf{y}}$ lateral.\n-   **Orientation**: FPF is mounted at a pitch angle $\\alpha$ (right-handed rotation about $\\hat{\\mathbf{Y}}$) and a yaw angle $\\psi$ (right-handed rotation about $\\hat{\\mathbf{Z}}$) relative to the GLF. Angles are in radians.\n-   **Plate Outputs**: Force vector $\\mathbf{F}_{L}$ and free moment vector $\\mathbf{M}_{L}$ expressed in the FPF.\n-   **Task 1**: Derive the $3 \\times 3$ rotation matrix $C(\\alpha,\\psi)$ mapping vectors from FPF to GLF: $\\mathbf{v}_{G} = C(\\alpha,\\psi)\\,\\mathbf{v}_{L}$. The derivation must use the specified composition of yaw and pitch.\n-   **Task 2**: State the transformation rules for forces and free moments from FPF to GLF, assuming coincident origins.\n-   **Task 3**: Validate with a static case:\n    -   Mass $m = 83.4$.\n    -   Gravitational acceleration $g = 9.81$.\n    -   Global Ground Reaction Force (GRF) $\\mathbf{F}_{G} = \\begin{pmatrix}0 \\\\ 0 \\\\ W\\end{pmatrix}$, where $W = m\\,g$.\n    -   The task is to use the derived $C(\\alpha,\\psi)$ to predict the local force $\\mathbf{F}_{L}$, then transform $\\mathbf{F}_{L}$ back to the GLF, and report the recovered global vertical force component, rounded to four significant figures.\n\n#### Step 2: Validate Using Extracted Givens\nThe problem is assessed based on the validation criteria:\n-   **Scientifically Grounded**: The problem is rooted in classical mechanics, specifically rigid body kinematics and dynamics (Euler angles, coordinate transformations). The application is in biomechanics, a legitimate scientific discipline. The principles invoked are fundamental and well-established. The problem is scientifically sound.\n-   **Well-Posed**: The problem's tasks are clearly defined.\n    1.  The derivation of the rotation matrix is based on a specified sequence of rotations (\"composition of the yaw... and the pitch\"). The use of GLF axes ($\\hat{\\mathbf{Y}}$, $\\hat{\\mathbf{Z}}$) for the rotations specifies an extrinsic rotation sequence, which is unambiguous.\n    2.  The transformation of forces and moments is a standard application of the derived rotation matrix. The simplifying condition of coincident origins is explicitly stated.\n    3.  The validation calculation is a concrete and solvable exercise with all necessary data provided ($m$, $g$, and the target precision). The fact that the angles $\\alpha$ and $\\psi$ are symbolic is a feature, not a flaw, designed to test the algebraic consistency of the transformations.\n-   **Objective**: The language is technical and precise. No subjective or opinion-based statements are present.\n-   **No other flaws detected**: The problem is complete, consistent, realistic for a lab setting, and not trivial, as it requires correct derivation and application of matrix algebra.\n\n#### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\n\n#### 1. Derivation of the Rotation Matrix $C(\\alpha,\\psi)$\n\nThe rotation matrix $C(\\alpha,\\psi)$ transforms the coordinates of a vector from the Force Plate Frame (FPF, or local frame $L$) to the Global Laboratory Frame (GLF, or global frame $G$), i.e., $\\mathbf{v}_{G} = C(\\alpha,\\psi)\\,\\mathbf{v}_{L}$.\n\nThe orientation of the FPF is obtained by a sequence of rotations applied to the GLF. The problem specifies a yaw by $\\psi$ about the GLF axis $\\hat{\\mathbf{Z}}$ and a pitch by $\\alpha$ about the GLF axis $\\hat{\\mathbf{Y}}$. Since the rotation axes belong to the fixed global frame, this describes a sequence of extrinsic (space-fixed) rotations. The problem states \"composition of the yaw... and the pitch\", implying the yaw rotation is performed first, followed by the pitch rotation.\n\nThe rotation matrix for a right-handed rotation by an angle $\\theta$ about the Z-axis is:\n$$C_Z(\\theta) = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta  0 \\\\ \\sin\\theta  \\cos\\theta  0 \\\\ 0  0  1 \\end{pmatrix}$$\nThe rotation matrix for a right-handed rotation by an angle $\\phi$ about the Y-axis is:\n$$C_Y(\\phi) = \\begin{pmatrix} \\cos\\phi  0  \\sin\\phi \\\\ 0  1  0 \\\\ -\\sin\\phi  0  \\cos\\phi \\end{pmatrix}$$\n\nFor an extrinsic rotation sequence, the composite rotation matrix is formed by pre-multiplying the rotation matrices in the order of application. Here, the sequence is yaw($\\psi$) then pitch($\\alpha$). The resulting transformation matrix $C$ is:\n$$C(\\alpha,\\psi) = C_Y(\\alpha) C_Z(\\psi)$$\n\nPerforming the matrix multiplication:\n$$C(\\alpha,\\psi) = \\begin{pmatrix} \\cos\\alpha  0  \\sin\\alpha \\\\ 0  1  0 \\\\ -\\sin\\alpha  0  \\cos\\alpha \\end{pmatrix} \\begin{pmatrix} \\cos\\psi  -\\sin\\psi  0 \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix}$$\n$$C(\\alpha,\\psi) = \\begin{pmatrix}\n(\\cos\\alpha)(\\cos\\psi) + (0)(\\sin\\psi) + (\\sin\\alpha)(0)  (\\cos\\alpha)(-\\sin\\psi) + (0)(\\cos\\psi) + (\\sin\\alpha)(0)  (\\cos\\alpha)(0) + (0)(0) + (\\sin\\alpha)(1) \\\\\n(0)(\\cos\\psi) + (1)(\\sin\\psi) + (0)(0)  (0)(-\\sin\\psi) + (1)(\\cos\\psi) + (0)(0)  (0)(0) + (1)(0) + (0)(1) \\\\\n(-\\sin\\alpha)(\\cos\\psi) + (0)(\\sin\\psi) + (\\cos\\alpha)(0)  (-\\sin\\alpha)(-\\sin\\psi) + (0)(\\cos\\psi) + (\\cos\\alpha)(0)  (-\\sin\\alpha)(0) + (0)(0) + (\\cos\\alpha)(1)\n\\end{pmatrix}$$\n$$C(\\alpha,\\psi) = \\begin{pmatrix}\n\\cos\\alpha\\cos\\psi  -\\cos\\alpha\\sin\\psi  \\sin\\alpha \\\\\n\\sin\\psi  \\cos\\psi  0 \\\\\n-\\sin\\alpha\\cos\\psi  \\sin\\alpha\\sin\\psi  \\cos\\alpha\n\\end{pmatrix}$$\nThis is the required $3 \\times 3$ rotation matrix.\n\n#### 2. Transformation of Forces and Free Moments\n\nForce is a vector quantity. Therefore, the force vector $\\mathbf{F}_{L}$ measured in the FPF is transformed to the force vector $\\mathbf{F}_{G}$ in the GLF using the rotation matrix $C(\\alpha, \\psi)$:\n$$\\mathbf{F}_{G} = C(\\alpha,\\psi)\\,\\mathbf{F}_{L}$$\n\nThe problem specifies a \"free moment vector\" $\\mathbf{M}_{L}$. A free moment transforms as a true vector under rotation, provided the moment is calculated about a common reference point. The problem explicitly states that \"the moment reference points coincide\". Under this condition, the moment vector $\\mathbf{M}_{L}$ in the FPF transforms to the moment vector $\\mathbf{M}_{G}$ in the GLF according to the same rotation rule:\n$$\\mathbf{M}_{G} = C(\\alpha,\\psi)\\,\\mathbf{M}_{L}$$\nSince the origins coincide, there is no additional term from the moment of the force (i.e., $\\mathbf{r} \\times \\mathbf{F}$ where $\\mathbf{r} = \\mathbf{0}$). Thus, the global free moment $\\mathbf{M}_{G}$ depends only on $\\mathbf{M}_{L}$ and $C(\\alpha,\\psi)$, and has no dependence on $\\mathbf{F}_{L}$.\n\n#### 3. Validation with a Static Load Case\n\nThe subject has a mass of $m = 83.4$ kg and is subject to gravity $g = 9.81 \\, \\text{m}/\\text{s}^2$. The weight is $W = m g$.\n$$W = 83.4 \\times 9.81 = 818.154 \\, \\text{N}$$\nThe global ground reaction force is purely vertical:\n$$\\mathbf{F}_{G} = \\begin{pmatrix} 0 \\\\ 0 \\\\ W \\end{pmatrix}$$\n\nFirst, we predict the local force $\\mathbf{F}_{L}$ that would be measured by the force plate. The transformation is $\\mathbf{F}_{G} = C \\mathbf{F}_{L}$, so the inverse transformation is $\\mathbf{F}_{L} = C^{-1} \\mathbf{F}_{G}$. Since $C$ is a rotation matrix, it is orthogonal, meaning $C^{-1} = C^T$.\n$$C^T(\\alpha,\\psi) = \\begin{pmatrix}\n\\cos\\alpha\\cos\\psi  \\sin\\psi  -\\sin\\alpha\\cos\\psi \\\\\n-\\cos\\alpha\\sin\\psi  \\cos\\psi  \\sin\\alpha\\sin\\psi \\\\\n\\sin\\alpha  0  \\cos\\alpha\n\\end{pmatrix}$$\nNow we compute $\\mathbf{F}_{L}$:\n$$\\mathbf{F}_{L} = C^T \\mathbf{F}_{G} = \\begin{pmatrix}\n\\cos\\alpha\\cos\\psi  \\sin\\psi  -\\sin\\alpha\\cos\\psi \\\\\n-\\cos\\alpha\\sin\\psi  \\cos\\psi  \\sin\\alpha\\sin\\psi \\\\\n\\sin\\alpha  0  \\cos\\alpha\n\\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ W \\end{pmatrix} = W \\begin{pmatrix} -\\sin\\alpha\\cos\\psi \\\\ \\sin\\alpha\\sin\\psi \\\\ \\cos\\alpha \\end{pmatrix}$$\nThis is the force vector that would be measured in the FPF.\n\nNext, we transform this local force $\\mathbf{F}_{L}$ back to the GLF to recover the global force, let's call it $\\mathbf{F}_{G,\\text{rec}}$.\n$$\\mathbf{F}_{G,\\text{rec}} = C \\mathbf{F}_{L}$$\nBy construction, $\\mathbf{F}_{G,\\text{rec}} = C (C^T \\mathbf{F}_{G}) = (C C^T) \\mathbf{F}_{G} = I \\mathbf{F}_{G} = \\mathbf{F}_{G}$, where $I$ is the $3 \\times 3$ identity matrix.\nThis confirms that the round-trip transformation recovers the original global force vector, independent of the angles $\\alpha$ and $\\psi$.\n$$\\mathbf{F}_{G,\\text{rec}} = \\mathbf{F}_{G} = \\begin{pmatrix} 0 \\\\ 0 \\\\ W \\end{pmatrix}$$\nThe problem asks for the recovered global vertical force component, which is the Z-component of $\\mathbf{F}_{G,\\text{rec}}$.\n$$(F_{G,\\text{rec}})_Z = W = 818.154 \\, \\text{N}$$\nThe problem requests the answer to be rounded to four significant figures.\n$$818.154 \\to 818.2$$\nThe recovered global vertical force component is $818.2$ N.",
            "answer": "$$\\boxed{818.2}$$"
        },
        {
            "introduction": "With kinematic and kinetic data expressed in a common global frame, we can move from simply describing motion to analyzing its underlying causes. This exercise applies the principles of inverse dynamics, a cornerstone of biomechanical analysis, to determine the net internal moment at the knee joint required to produce an observed movement. By creating a free-body diagram and applying Newton-Euler equations, you will calculate the muscular effort responsible for powering the body during the demanding pull-up phase of stair ascent. ",
            "id": "4205379",
            "problem": "During stair ascent in the pull-up phase, model the combined shank-foot as a single rigid body moving in the sagittal plane. Use a right-handed laboratory coordinate system with the $x$-axis pointing anteriorly (forward), the $y$-axis pointing superiorly (upward), and the $z$-axis pointing laterally out of the sagittal plane. Let the knee joint center be the proximal reference point at position $\\mathbf{r}_k = (0,0)$, and define counterclockwise moments about the $z$-axis as positive.\n\nAt a specific instant, the following quantities are measured or estimated:\n- The Ground Reaction Force (GRF) vector at the shoe-ground Center of Pressure (COP) is $\\mathbf{R} = (80, 850)$ in newtons. The COP location relative to the knee is $\\mathbf{r}_{\\mathrm{cop}/k} = (0.07, -0.46)$ in meters. The GRF acts at the COP.\n- The combined shank-foot segment mass is $m = 4.5$ in kilograms, and its center of mass (COM) location relative to the knee is $\\mathbf{r}_{g/k} = (0.10, -0.32)$ in meters. The segment’s COM linear acceleration is $\\mathbf{a}_g = (0.40, 1.00)$ in meters per second squared. The segment’s mass moment of inertia about its COM is $I_g = 0.12$ in kilogram meter squared, and its angular acceleration about the $z$-axis is $\\alpha_z = 2.5$ in radians per second squared.\n- Gravitational acceleration is $g = 9.81$ in meters per second squared, acting in the negative $y$-direction.\n\nAssume the only external loads acting on the combined shank-foot segment are the GRF at the COP, the weight of the segment applied at its COM, and the net knee joint resultant (a force at the knee and a net internal knee moment $M_k$). Using a Newton–Euler free-body diagram of the combined shank-foot segment and fundamental laws, compute the net internal knee joint moment $M_k$ about the $z$-axis at this instant. Express your final result in newton meters. Round your answer to three significant figures. State your answer with the specified sign convention (counterclockwise positive).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of rigid body dynamics, is well-posed with sufficient and consistent data, and is expressed objectively. A unique solution can be determined.\n\nThe solution requires the application of the Newton-Euler equations for a rigid body undergoing planar motion. We aim to compute the net internal knee joint moment, $M_k$, acting on the combined shank-foot segment. The most direct method is to sum the moments about the knee joint center, $K$, which is a fixed point in the specified laboratory coordinate system ($\\mathbf{r}_k = (0,0)$).\n\nEuler's second law for a rigid body in planar motion, with moments summed about a fixed point $O$, states that the sum of external moments about $O$ equals the time rate of change of the angular momentum about $O$. This can be expressed as:\n$$ \\sum \\mathbf{M}_O = \\mathbf{r}_{g/O} \\times (m\\mathbf{a}_g) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\nwhere $\\mathbf{r}_{g/O}$ is the position vector of the center of mass ($G$) relative to point $O$, $m$ is the mass of the body, $\\mathbf{a}_g$ is the linear acceleration of the center of mass, $I_g$ is the mass moment of inertia about the center of mass, $\\alpha_z$ is the angular acceleration about the $z$-axis, and $\\hat{\\mathbf{k}}$ is the unit vector in the $z$-direction.\n\nIn this problem, we sum moments about the knee joint center $K$, which is the origin of our coordinate system. So, point $O$ is $K$. The equation becomes:\n$$ \\sum \\mathbf{M}_K = \\mathbf{r}_{g/K} \\times (m\\mathbf{a}_g) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\nThe external loads on the shank-foot segment are the Ground Reaction Force ($\\mathbf{R}$) at the Center of Pressure (COP), the weight of the segment ($\\mathbf{W}$) at its center of mass ($G$), and the net joint resultant at the knee. The knee joint resultant consists of a force $\\mathbf{F}_k$ acting at the knee joint center $K$ and a pure moment (couple) $M_k$.\n\nThe sum of the external moments about the knee joint, $\\sum \\mathbf{M}_K$, is therefore:\n$$ \\sum \\mathbf{M}_K = (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R}) + (\\mathbf{r}_{g/K} \\times \\mathbf{W}) + (\\mathbf{r}_{k/K} \\times \\mathbf{F}_k) + M_k \\hat{\\mathbf{k}} $$\nSince the knee force $\\mathbf{F}_k$ is applied at the point $K$, its position vector relative to $K$ is $\\mathbf{r}_{k/K} = \\mathbf{0}$. Thus, the moment produced by $\\mathbf{F}_k$ about $K$ is zero. The equation for the sum of external moments simplifies to:\n$$ \\sum \\mathbf{M}_K = (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R}) + (\\mathbf{r}_{g/K} \\times \\mathbf{W}) + M_k \\hat{\\mathbf{k}} $$\nEquating the two expressions for $\\sum \\mathbf{M}_K$:\n$$ (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R}) + (\\mathbf{r}_{g/K} \\times \\mathbf{W}) + M_k \\hat{\\mathbf{k}} = \\mathbf{r}_{g/K} \\times (m\\mathbf{a}_g) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\nWe can rearrange this equation to solve for the unknown knee moment, $M_k$:\n$$ M_k \\hat{\\mathbf{k}} = \\left( \\mathbf{r}_{g/K} \\times m\\mathbf{a}_g \\right) - \\left( \\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R} \\right) - \\left( \\mathbf{r}_{g/K} \\times \\mathbf{W} \\right) + I_g \\alpha_z \\hat{\\mathbf{k}} $$\nSince all vectors lie in the $xy$-plane, the cross products result in vectors along the $z$-axis. We can write a scalar equation for the $z$-components. For any two vectors in the plane $\\mathbf{u} = (u_x, u_y)$ and $\\mathbf{v} = (v_x, v_y)$, the $z$-component of their cross product is $(\\mathbf{u} \\times \\mathbf{v})_z = u_x v_y - u_y v_x$.\nThe scalar equation for $M_k$ is:\n$$ M_k = (\\mathbf{r}_{g/K} \\times m\\mathbf{a}_g)_z - (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R})_z - (\\mathbf{r}_{g/K} \\times \\mathbf{W})_z + I_g \\alpha_z $$\nNow, we substitute the given values:\n- Mass: $m = 4.5$ kg\n- Position vectors relative to the knee ($K$):\n  - $\\mathbf{r}_{g/K} = (0.10, -0.32)$ m\n  - $\\mathbf{r}_{\\mathrm{cop}/K} = (0.07, -0.46)$ m\n- Force and acceleration vectors:\n  - $\\mathbf{R} = (80, 850)$ N\n  - $\\mathbf{a}_g = (0.40, 1.00)$ m/s$^2$\n  - The weight vector is $\\mathbf{W} = m\\mathbf{g} = (4.5 \\text{ kg}) \\times (0, -9.81 \\text{ m/s}^2) = (0, -44.145)$ N.\n- Inertial properties:\n  - $I_g = 0.12$ kg⋅m$^2$\n  - $\\alpha_z = 2.5$ rad/s$^2$\n\nWe calculate each term in the equation for $M_k$:\n$1$. The term related to the segment's linear acceleration:\n$$ (\\mathbf{r}_{g/K} \\times m\\mathbf{a}_g)_z = m(x_{g/k} a_{gy} - y_{g/k} a_{gx}) $$\n$$ = (4.5) \\times ((0.10)(1.00) - (-0.32)(0.40)) = (4.5) \\times (0.10 + 0.128) = (4.5)(0.228) = 1.026 \\text{ N}\\cdot\\text{m} $$\n$2$. The moment produced by the GRF:\n$$ (\\mathbf{r}_{\\mathrm{cop}/K} \\times \\mathbf{R})_z = x_{\\mathrm{cop}/k} R_y - y_{\\mathrm{cop}/k} R_x $$\n$$ = (0.07)(850) - (-0.46)(80) = 59.5 - (-36.8) = 59.5 + 36.8 = 96.3 \\text{ N}\\cdot\\text{m} $$\n$3$. The moment produced by the segment's weight:\n$$ (\\mathbf{r}_{g/K} \\times \\mathbf{W})_z = x_{g/k} W_y - y_{g/k} W_x $$\n$$ = (0.10)(-44.145) - (-0.32)(0) = -4.4145 \\text{ N}\\cdot\\text{m} $$\n$4$. The term related to the segment's angular acceleration:\n$$ I_g \\alpha_z = (0.12)(2.5) = 0.3 \\text{ N}\\cdot\\text{m} $$\n\nFinally, we substitute these values back into the equation for $M_k$:\n$$ M_k = (1.026) - (96.3) - (-4.4145) + (0.3) $$\n$$ M_k = 1.026 - 96.3 + 4.4145 + 0.3 $$\n$$ M_k = 5.7405 - 96.3 = -90.5595 \\text{ N}\\cdot\\text{m} $$\nThe problem asks for the answer to be rounded to three significant figures.\n$$ M_k \\approx -90.6 \\text{ N}\\cdot\\text{m} $$\nThe negative sign indicates that the net internal knee joint moment is clockwise, according to the specified sign convention (counterclockwise positive). This is a flexor moment.",
            "answer": "$$\\boxed{-90.6}$$"
        },
        {
            "introduction": "Human locomotion, with its alternating phases of flight and contact, is a classic example of a hybrid dynamical system. To model this behavior for simulation or robotic control, we must formalize the logic that governs transitions between discrete states like swing and stance. This advanced practice guides you in developing a hybrid automaton, where you will derive the \"guard conditions\" based on the physical principles of contact mechanics, providing a robust, event-driven description of the gait cycle. ",
            "id": "4205415",
            "problem": "You are to derive and implement a hybrid automaton for single-limb stair ascent focusing on discrete contact modes and guard conditions grounded in first principles of contact mechanics and dynamics. The setup models a single foot negotiating a stair riser during ascent. Use Newton’s second law and unilateral contact complementarity as the fundamental base. Define the continuous variables as follows: foot height relative to the next landing surface $h$ in meters, vertical foot velocity $\\dot z_f$ in meters per second, normal ground reaction force $N$ in newtons, and its time derivative $\\dot N$ in newtons per second. The hybrid automaton has discrete modes (encoded as integers) representing contact phases: swing ($0$), heel-strike ($1$), stance ($2$), and toe-off ($3$). Assume a small nonnegative contact clearance tolerance $\\epsilon$ in meters and a small positive normal force threshold $N_{\\min}$ in newtons for robust detection of contact onset and loss.\n\nTask 1 (derivation): Starting from Newton’s second law and unilateral contact complementarity, derive discrete guard conditions for the transitions between modes using only the variables $h$, $\\dot{z}_f$, $N$, and $\\dot{N}$ and the thresholds $\\epsilon$ and $N_{\\min}$. The guard conditions must be expressible solely in inequalities among these quantities. The stance and swing phases must respect the complementarity principle between the nonpenetration gap and normal contact force. Your derivation must ensure that heel-strike is triggered before stance, and toe-off is triggered before swing, using only measurable variables listed above.\n\nTask 2 (implementation): Implement the derived guard conditions as a deterministic state transition function that maps a current mode and measured variables to a next mode. You must resolve boundary ambiguities at equalities consistently and robustly, choosing sensible inequalities for transitions.\n\nTest suite: Evaluate your state transition function on the following set of test cases. Each test case is a list $[M, h, \\dot{z}_f, N, \\dot{N}, \\epsilon, N_{\\min}]$ where $M$ is the current mode encoded as $0$ for swing, $1$ for heel-strike, $2$ for stance, or $3$ for toe-off. Use the provided values and units exactly as specified.\n\n- Case A: $[0, 0.005, -0.3, 0.0, 0.0, 0.01, 50.0]$\n- Case B: $[1, 0.000, -0.1, 350.0, 1000.0, 0.01, 50.0]$\n- Case C: $[2, 0.000, 0.0, 20.0, -200.0, 0.01, 50.0]$\n- Case D: $[3, 0.030, 0.2, 0.0, 0.0, 0.01, 50.0]$\n- Case E: $[0, 0.012, -0.5, 0.0, 0.0, 0.01, 50.0]$\n- Case F: $[2, 0.000, 0.0, 50.0, 10.0, 0.01, 50.0]$\n- Case G: $[0, 0.000, 0.1, 0.0, 0.0, 0.01, 50.0]$\n- Case H: $[1, 0.020, 0.1, 0.0, 0.0, 0.01, 50.0]$\n- Case I: $[0, 0.010, -0.01, 0.0, 0.0, 0.01, 50.0]$\n- Case J: $[2, 0.000, 0.0, 49.999, -0.001, 0.01, 50.0]$\n\nAll heights $h$ and tolerances $\\epsilon$ must be interpreted in meters, velocities $\\dot z_f$ in meters per second, forces $N$ and thresholds $N_{\\min}$ in newtons, and force rates $\\dot N$ in newtons per second. You must use radians for any angles if they appear, although angles are not required in this task. The final output for each test case must be the integer next mode returned by your transition function.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_{10}]$), where each $r_i$ is the integer next mode for the corresponding test case in the order listed above.",
            "solution": "The problem requires the derivation and implementation of a deterministic state transition function for a hybrid automaton simulating single-limb stair ascent. The derivation must be grounded in the principles of Newton's second law and unilateral contact complementarity.\n\n### 1. Foundational Principles and State Definitions\n\nThe dynamics of foot-stair interaction are governed by unilateral contact. This imposes two fundamental constraints:\n1.  **Non-penetration:** The foot cannot pass through the stair surface. If $h$ is the height of the foot relative to the surface, then $h \\ge 0$.\n2.  **Unilateral Force:** The contact force $N$ can only be repulsive (pushing), not adhesive (pulling). Thus, $N \\ge 0$.\n\nThese two constraints are linked by the **complementarity principle**, which states that a contact force can only exist when there is no gap, and a gap can only exist if there is no contact force. Mathematically, this is expressed as $h \\cdot N = 0$.\n\nIn a practical implementation, sensor noise and model simplifications necessitate the use of thresholds: a small, non-negative clearance tolerance $\\epsilon$ for height and a small, positive normal force threshold $N_{\\min}$ for force. The hybrid automaton's primary modes, Swing and Stance, are defined by relaxing the complementarity conditions with these thresholds:\n\n*   **Mode 0: Swing:** The foot is in the air, not in contact with the stair. This corresponds to the state where there is a discernible gap and no significant contact force.\n    -   Conditions: $h > \\epsilon$ and $N  N_{\\min}$.\n\n*   **Mode 2: Stance:** The foot is in firm, stable contact with the stair, supporting weight. This corresponds to the state where there is no discernible gap and a significant contact force is present.\n    -   Conditions: $h \\le \\epsilon$ and $N \\ge N_{\\min}$.\n\nThe problem introduces two additional modes, Heel-strike and Toe-off, as transient phases that bridge the transitions between Swing and Stance.\n\n*   **Mode 1: Heel-strike:** A transient phase representing the initiation of contact. It begins upon impact and concludes when stable contact (Stance) is achieved.\n\n*   **Mode 3: Toe-off:** A transient phase representing the termination of contact. It begins as the foot unloads and concludes when separation (Swing) is achieved.\n\nThe variable $\\dot{z}_f$ represents the vertical velocity of the foot, where $\\dot{z}_f  0$ indicates downward motion (approaching the surface) and $\\dot{z}_f > 0$ indicates upward motion (moving away from the surface). The force rate $\\dot{N}$ indicates whether the contact force is increasing ($\\dot{N} > 0$) or decreasing ($\\dot{N}  0$). Although $\\dot{N}$ is available, the introduction of explicit transient modes for contact initiation and termination makes the system state directly observable through $h$ and $N$, rendering $\\dot{N}$ non-essential for a robust state machine, thus it will not be used in the final logic.\n\n### 2. Derivation of Guard Conditions\n\nA guard condition is a logical expression that, when true, triggers a transition from one discrete mode to another. The state transition function must be deterministic, meaning that for any given state, the next mode is uniquely determined. We now derive the guards for each possible transition in the locomotion cycle.\n\n**From Mode 0 (Swing) to Mode 1 (Heel-strike):**\nA transition from Swing to Heel-strike signifies the moment of impact. This event is characterized by two conditions occurring simultaneously:\n1.  The foot's height $h$ has decreased to a value at or below the clearance tolerance $\\epsilon$, i.e., $h \\le \\epsilon$.\n2.  The foot has a downward velocity, indicating it is moving into the surface, not away from it, i.e., $\\dot{z}_f  0$.\n\nThus, the guard condition for the $0 \\to 1$ transition is:\n$$ (h \\le \\epsilon) \\land (\\dot{z}_f  0) $$\nIf this condition is not met, the system remains in Swing mode.\n\n**From Mode 1 (Heel-strike) to Mode 2 (Stance):**\nHeel-strike is the transient loading phase. The transition to Stance occurs once contact is firmly established, which is signified by the normal force $N$ rising above the minimum force threshold $N_{\\min}$.\n\nThe guard condition for the $1 \\to 2$ transition is:\n$$ N \\ge N_{\\min} $$\n\n**From Mode 2 (Stance) to Mode 3 (Toe-off):**\nA transition from Stance to Toe-off signifies the beginning of the unloading phase in preparation for liftoff. This is detected when the normal force $N$, which was previously above $N_{\\min}$, drops below this threshold.\n\nThe guard condition for the $2 \\to 3$ transition is:\n$$ N  N_{\\min} $$\nIf this condition is false (i.e., $N \\ge N_{\\min}$), the foot remains in Stance.\n\n**From Mode 3 (Toe-off) to Mode 0 (Swing):**\nToe-off is the transient unloading phase. The transition to Swing is complete when the foot physically separates from the surface. This is detected when the foot's height $h$ once again exceeds the clearance tolerance $\\epsilon$.\n\nThe guard condition for the $3 \\to 0$ transition is:\n$$ h > \\epsilon $$\n\n### 3. Handling Off-Nominal Transitions for Robustness\n\nA robust automaton must also account for plausible events that deviate from the standard cycle.\n\n**From Mode 1 (Heel-strike) to Mode 0 (Swing):**\nThis transition represents an aborted landing or a bounce. If the foot enters the Heel-strike phase but a stable contact force fails to develop, and the foot subsequently moves away from the surface, it should return to Swing mode. This condition is met if the height $h$ becomes greater than $\\epsilon$ while still in Mode $1$.\n\nThe guard condition for the $1 \\to 0$ transition is:\n$$ h > \\epsilon $$\n\n**From Mode 3 (Toe-off) to Mode 2 (Stance):**\nThis transition represents a \"stutter\" or re-loading of the foot after unloading has begun. If the foot enters the Toe-off phase but then force is re-applied before liftoff is achieved, it should return to Stance. This is detected if the normal force $N$ increases back to or above $N_{\\min}$ while still in Mode $3$.\n\nThe guard condition for the $3 \\to 2$ transition is:\n$$ N \\ge N_{\\min} $$\n\n### 4. Final State Transition Logic\n\nThe logic is implemented as a deterministic function that evaluates guard conditions in a specific order. For a given mode $M$, if no transition guard is satisfied, the mode remains unchanged. The order of evaluation for modes with multiple exit paths ($1$ and $3$) is important for determinism.\n\nLet $M$ be the current mode and $M'$ be the next mode.\n\n-   If $M = 0$ (Swing):\n    -   If $(h \\le \\epsilon) \\land (\\dot{z}_f  0)$, then $M' = 1$.\n    -   Else, $M' = 0$.\n\n-   If $M = 1$ (Heel-strike):\n    -   If $N \\ge N_{\\min}$, then $M' = 2$.\n    -   Else if $h > \\epsilon$, then $M' = 0$.\n    -   Else, $M' = 1$.\n\n-   If $M = 2$ (Stance):\n    -   If $N  N_{\\min}$, then $M' = 3$.\n    -   Else, $M' = 2$.\n\n-   If $M = 3$ (Toe-off):\n    -   If $h > \\epsilon$, then $M' = 0$.\n    -   Else if $N \\ge N_{\\min}$, then $M' = 2$.\n    -   Else, $M' = 3$.\n\nThis completes the derivation of a complete and robust set of guard conditions for the specified hybrid automaton.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_next_mode(M, h, dot_z_f, N, dot_N, epsilon, N_min):\n    \"\"\"\n    Calculates the next mode of a hybrid automaton for stair ascent.\n\n    The automaton models four discrete modes of a single foot:\n    0: Swing - Foot is in the air.\n    1: Heel-strike - Transient phase, contact is initiated.\n    2: Stance - Foot is in firm contact with the ground.\n    3: Toe-off - Transient phase, contact is terminated.\n\n    Args:\n        M (int): The current mode (0, 1, 2, or 3).\n        h (float): Foot height relative to the landing surface [meters].\n        dot_z_f (float): Vertical foot velocity [m/s].\n        N (float): Normal ground reaction force [Newtons].\n        dot_N (float): Time derivative of normal force [N/s].\n        epsilon (float): Small non-negative contact clearance tolerance [meters].\n        N_min (float): Small positive normal force threshold [Newtons].\n\n    Returns:\n        int: The next mode of the automaton.\n    \"\"\"\n    \n    # Mode 0: Swing\n    # The foot is in the air. Transition to Heel-strike upon impact.\n    if M == 0:\n        # Guard (0 - 1): Impact condition met if height is within tolerance\n        # and velocity is negative (approaching).\n        if h = epsilon and dot_z_f  0:\n            return 1  # Transition to Heel-strike\n        else:\n            return 0  # Remain in Swing\n\n    # Mode 1: Heel-strike\n    # Transient phase for contact establishment. Can lead to Stance or back to Swing.\n    elif M == 1:\n        # Guard (1 - 2): Transition to Stance when force threshold is met.\n        if N = N_min:\n            return 2  # Transition to Stance\n        # Guard (1 - 0): Represents a bounce or aborted landing.\n        elif h  epsilon:\n            return 0  # Transition back to Swing\n        else:\n            return 1  # Remain in Heel-strike\n\n    # Mode 2: Stance\n    # The foot is firmly on the ground. Transition to Toe-off upon unloading.\n    elif M == 2:\n        # Guard (2 - 3): Transition to Toe-off when force drops below threshold.\n        if N  N_min:\n            return 3  # Transition to Toe-off\n        else:\n            return 2  # Remain in Stance\n\n    # Mode 3: Toe-off\n    # Transient phase for contact termination. Can lead to Swing or back to Stance.\n    elif M == 3:\n        # Guard (3 - 0): Transition to Swing when separation is confirmed.\n        if h  epsilon:\n            return 0  # Transition to Swing\n        # Guard (3 - 2): Represents a \"stutter\" or re-loading.\n        elif N = N_min:\n            return 2  # Transition back to Stance\n        else:\n            return 3  # Remain in Toe-off\n            \n    # Should not be reached with valid inputs\n    return M\n\ndef solve():\n    \"\"\"\n    Defines and evaluates the test suite for the state transition function.\n    \"\"\"\n    # Test cases: [M, h, dot_z_f, N, dot_N, epsilon, N_min]\n    test_cases = [\n        # Case A: Swing, foot near ground and moving down - Heel-strike\n        [0, 0.005, -0.3, 0.0, 0.0, 0.01, 50.0],\n        # Case B: Heel-strike, force is established - Stance\n        [1, 0.000, -0.1, 350.0, 1000.0, 0.01, 50.0],\n        # Case C: Stance, force drops below threshold - Toe-off\n        [2, 0.000, 0.0, 20.0, -200.0, 0.01, 50.0],\n        # Case D: Toe-off, foot has separated from ground - Swing\n        [3, 0.030, 0.2, 0.0, 0.0, 0.01, 50.0],\n        # Case E: Swing, but still above tolerance height - Swing\n        [0, 0.012, -0.5, 0.0, 0.0, 0.01, 50.0],\n        # Case F: Stance, force is exactly at threshold - Stance\n        [2, 0.000, 0.0, 50.0, 10.0, 0.01, 50.0],\n        # Case G: Swing, foot at ground but moving up (no impact) - Swing\n        [0, 0.000, 0.1, 0.0, 0.0, 0.01, 50.0],\n        # Case H: Heel-strike, but separation occurs (bounce) - Swing\n        [1, 0.020, 0.1, 0.0, 0.0, 0.01, 50.0],\n        # Case I: Swing, foot at tolerance boundary and moving down - Heel-strike\n        [0, 0.010, -0.01, 0.0, 0.0, 0.01, 50.0],\n        # Case J: Stance, force just below threshold - Toe-off\n        [2, 0.000, 0.0, 49.999, -0.001, 0.01, 50.0],\n    ]\n\n    results = []\n    for case in test_cases:\n        M, h, dot_z_f, N, dot_N, epsilon, N_min = case\n        next_m = get_next_mode(M, h, dot_z_f, N, dot_N, epsilon, N_min)\n        results.append(next_m)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}