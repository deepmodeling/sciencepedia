{
    "hands_on_practices": [
        {
            "introduction": "在生物力学中，精确表征软组织的材料特性是理解其功能和损伤机制的第一步。然而，标准的力学测试（如压缩实验）往往受到边界条件的显著影响，例如摩擦和侧向约束，这会使得测得的表观刚度与材料的真实杨氏模量产生偏差。本练习  旨在通过一个模拟的压缩测试场景，引导您掌握如何从实验数据中剥离这些影响，并基于线弹性理论和平面应变假设，修正计算出近乎不可压缩材料的真实弹性模量。",
            "id": "4204720",
            "problem": "一个离体脊髓实质的圆柱形样本在两个刚性、抛光的玻璃压板之间经受小应变轴向压缩，以表征其与脊髓损伤生物力学相关的压缩刚度。该样本的初始直径为 $d = 10\\,\\mathrm{mm}$，初始高度为 $h_{0} = 4\\,\\mathrm{mm}$。在轴向应变高达 $12.5\\%$（位移 $\\delta$ 高达 $0.5\\,\\mathrm{mm}$）的应变范围内，测得的力-位移响应是线性的，其斜率为 $k = \\mathrm{d}F/\\mathrm{d}\\delta = 0.52\\,\\mathrm{N/mm}$。测得的组织与玻璃之间的静摩擦系数很高，为 $\\mu_{s} \\approx 0.9$，且纵横比 $h_{0}/d = 0.4$ 足够小，以至于横向膨胀受到界面剪切的强烈约束，在加载的小应变阶段，在样本主体中产生接近平面应变的状态。假设在该范围内，组织是均匀、各向同性且线弹性，泊松比为 $ \\nu = 0.49$。\n\n仅使用线性各向同性弹性的基本连续介质力学以及工程应力和应变的定义，根据所描述的横向约束和摩擦条件下的测量力-位移斜率，确定组织的修正有效杨氏模量 $E$。您的推理应明确说明相对于单轴应力，由约束引起的轴向应力-应变关系的变化。将最终的 $E$ 值四舍五入至三位有效数字，并以 $\\mathrm{kPa}$ 为单位表示答案。",
            "solution": "用户要求根据在特定边界条件下进行的压缩试验，确定脊髓组织样本的杨氏模量 $E$。\n\n首先，我们必须验证问题陈述。\n\n### 步骤1：提取已知条件\n-   样本几何形状：圆柱形，初始直径 $d = 10\\,\\mathrm{mm}$，初始高度 $h_{0} = 4\\,\\mathrm{mm}$。\n-   加载条件：小应变轴向压缩。\n-   力-位移响应：线性，斜率为 $k = \\mathrm{d}F/\\mathrm{d}\\delta = 0.52\\,\\mathrm{N/mm}$。\n-   界面条件：刚性、抛光的玻璃压板，静摩擦系数高，$\\mu_{s} \\approx 0.9$。\n-   几何约束：纵横比 $h_{0}/d = 0.4$ 很小。\n-   运动学假设：横向膨胀受到强烈约束，在主体中产生“接近平面应变的状态”。\n-   材料假设：均匀、各向同性、线弹性。\n-   材料属性：泊松比 $\\nu = 0.49$。\n-   目标：确定杨氏模量 $E$，单位为 $\\mathrm{kPa}$，四舍五入至三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：**该问题描述了一种针对软组织的标准的生物力学测试（约束压缩）。给定的尺寸、刚度和泊松比（$\\nu \\approx 0.5$ 表示接近不可压缩）对于像脊髓实质这样的生物软组织是符合实际的。高摩擦和低纵横比导致类似平面应变状态的假设是材料力学中一个公认的概念。该问题基于线弹性力学的基本原理。\n-   **适定性：**问题提供了所有必要的数据和一个明确的目标。可以从给定信息中推导出杨氏模量 $E$ 的唯一解。\n-   **客观性：**问题以精确、定量和客观的术语陈述。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、适定的和客观的。因此被判定为**有效**。我们继续进行求解。\n\n目标是求出组织的杨氏模量 $E$。由于组织与压板界面存在摩擦约束，该实验装置不是一个简单的单轴压缩试验。问题陈述中指出，这种约束导致了“接近平面应变的状态”。对于在轴向压缩（沿 $z$ 轴）下的轴对称圆柱形样本，此条件意味着径向应变 $\\epsilon_r$ 在材料主体中近似为零。\n\n让我们定义工程轴向应力 $\\sigma_z$ 和轴向应变 $\\epsilon_z$。对于施加的力 $F$ 和产生的轴向位移 $\\delta$，它们由以下公式给出：\n$$ \\sigma_z = \\frac{F}{A_0} $$\n$$ \\epsilon_z = \\frac{\\delta}{h_0} $$\n其中 $A_0$ 是样本的初始横截面积，$h_0$ 是样本的初始高度。面积为 $A_0 = \\pi (d/2)^2 = \\pi d^2 / 4$。\n\n问题提供了测量的刚度 $k = \\mathrm{d}F/\\mathrm{d}\\delta$。由于响应是线性的，我们可以写成 $k = F/\\delta$。我们可以用这个测量的刚度来表示应力与应变之比：\n$$ \\frac{\\sigma_z}{\\epsilon_z} = \\frac{F/A_0}{\\delta/h_0} = \\frac{F}{\\delta} \\frac{h_0}{A_0} = k \\frac{h_0}{A_0} $$\n这个比值 $\\sigma_z/\\epsilon_z$ 代表了材料在特定实验约束下的表观模量。我们称之为约束压缩模量 $M_{app}$。\n$$ M_{app} = k \\frac{h_0}{A_0} $$\n\n为了求出真实的杨氏模量 $E$，我们必须使用线弹性本构方程和给定的运动学约束，将其与 $M_{app}$ 联系起来。对于均匀、各向同性的线弹性材料，在柱坐标系 $(r, \\theta, z)$ 中的广义胡克定律为：\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - \\nu(\\sigma_r + \\sigma_\\theta) \\right] $$\n$$ \\epsilon_r = \\frac{1}{E} \\left[ \\sigma_r - \\nu(\\sigma_\\theta + \\sigma_z) \\right] $$\n$$ \\epsilon_\\theta = \\frac{1}{E} \\left[ \\sigma_\\theta - \\nu(\\sigma_r + \\sigma_z) \\right] $$\n由于加载和几何形状的轴对称性，径向和环向的应力和应变分量相等：$\\sigma_r = \\sigma_\\theta$ 和 $\\epsilon_r = \\epsilon_\\theta$。平面应变假设意味着 $\\epsilon_r = 0$。\n\n将 $\\epsilon_r = 0$ 和 $\\sigma_r = \\sigma_\\theta$ 代入径向应变方程：\n$$ 0 = \\frac{1}{E} \\left[ \\sigma_r - \\nu(\\sigma_r + \\sigma_z) \\right] $$\n$$ \\sigma_r(1-\\nu) = \\nu\\sigma_z $$\n这给出了由约束引起的径向应力：\n$$ \\sigma_r = \\frac{\\nu}{1-\\nu}\\sigma_z $$\n现在我们将这个 $\\sigma_r$（以及 $\\sigma_\\theta$）的表达式代入轴向应变 $\\epsilon_z$ 的方程中：\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - \\nu(\\sigma_r + \\sigma_r) \\right] = \\frac{1}{E} (\\sigma_z - 2\\nu\\sigma_r) $$\n$$ \\epsilon_z = \\frac{1}{E} \\left[ \\sigma_z - 2\\nu \\left( \\frac{\\nu}{1-\\nu}\\sigma_z \\right) \\right] $$\n$$ \\epsilon_z = \\frac{\\sigma_z}{E} \\left[ 1 - \\frac{2\\nu^2}{1-\\nu} \\right] = \\frac{\\sigma_z}{E} \\left[ \\frac{1-\\nu - 2\\nu^2}{1-\\nu} \\right] $$\n分子中的项可以因式分解为 $1-\\nu-2\\nu^2 = (1+\\nu)(1-2\\nu)$。\n$$ \\epsilon_z = \\frac{\\sigma_z}{E} \\frac{(1+\\nu)(1-2\\nu)}{1-\\nu} $$\n约束压缩模量 $M_{app}$ 是从此方程导出的比值 $\\sigma_z/\\epsilon_z$：\n$$ M_{app} = \\frac{\\sigma_z}{\\epsilon_z} = E \\frac{1-\\nu}{(1+\\nu)(1-2\\nu)} $$\n我们现在有两个关于 $M_{app}$ 的表达式。将它们相等，我们就可以求解 $E$：\n$$ k \\frac{h_0}{A_0} = E \\frac{1-\\nu}{(1+\\nu)(1-2\\nu)} $$\n$$ E = \\left( k \\frac{h_0}{A_0} \\right) \\frac{(1+\\nu)(1-2\\nu)}{1-\\nu} $$\n现在我们代入给定的数值。\n初始面积为 $A_0 = \\frac{\\pi d^2}{4} = \\frac{\\pi (10\\,\\mathrm{mm})^2}{4} = 25\\pi\\,\\mathrm{mm}^2$。\n给定的参数是：\n- $k = 0.52\\,\\mathrm{N/mm}$\n- $h_0 = 4\\,\\mathrm{mm}$\n- $A_0 = 25\\pi\\,\\mathrm{mm}^2$\n- $\\nu = 0.49$\n\n我们计算 $E$：\n$$ E = \\left( (0.52\\,\\mathrm{N/mm}) \\frac{4\\,\\mathrm{mm}}{25\\pi\\,\\mathrm{mm}^2} \\right) \\frac{(1+0.49)(1-2 \\times 0.49)}{1-0.49} $$\n$$ E = \\left( \\frac{2.08}{25\\pi}\\,\\mathrm{N/mm^2} \\right) \\frac{(1.49)(1-0.98)}{0.51} $$\n$$ E = \\left( \\frac{2.08}{25\\pi}\\,\\mathrm{N/mm^2} \\right) \\frac{(1.49)(0.02)}{0.51} $$\n$$ E = \\left( \\frac{2.08}{25\\pi} \\right) \\frac{0.0298}{0.51}\\,\\mathrm{N/mm^2} $$\n单位 $\\mathrm{N/mm^2}$ 等于兆帕（$\\mathrm{MPa}$）。\n$$ E \\approx (0.0264845\\,\\mathrm{MPa}) \\times (0.0584314) $$\n$$ E \\approx 0.0015476\\,\\mathrm{MPa} $$\n问题要求答案以千帕（$\\mathrm{kPa}$）为单位。因为 $1\\,\\mathrm{MPa} = 1000\\,\\mathrm{kPa}$：\n$$ E \\approx 0.0015476 \\times 1000\\,\\mathrm{kPa} = 1.5476\\,\\mathrm{kPa} $$\n四舍五入到三位有效数字，我们得到：\n$$ E \\approx 1.55\\,\\mathrm{kPa} $$\n这一结果表明，真实的杨氏模量远低于在约束压缩试验中测得的表观刚度，这是近不可压缩材料的一个典型特征。",
            "answer": "$$ \\boxed{1.55} $$"
        },
        {
            "introduction": "虽然线弹性模型在小应变下提供了有用的近似，但脊髓等软组织在生理和损伤条件下通常会经历大变形，其力学行为呈现显著的非线性。为了更准确地描述这种行为，研究人员通常使用超弹性本构模型。本练习  将带您进入非线性连续介质力学的核心，要求您从基本原理出发，推导两项 Mooney-Rivlin 超弹性模型的应力-应变关系，并应用最小二乘法将该模型与模拟的实验数据进行拟合，这是表征软组织力学特性的关键高级技能。",
            "id": "4204756",
            "problem": "假设一个脊髓白质样本，在沿头尾轴的准静态单轴拉伸作用下，表现为一种不可压缩、各向同性的超弹性材料。其应变能密度函数由双参数Mooney–Rivlin形式建模，表达式为 $W = C_1 (I_1 - 3) + C_2 (I_2 - 3)$，其中 $W$ 的单位是千帕（kilopascals），$C_1$ 和 $C_2$ 是材料参数，单位也是千帕，$I_1$ 和 $I_2$ 是左柯西-格林（Cauchy–Green）形变张量的第一和第二不变量。假设侧面无曳引力，且组织是不可压缩的，因此主拉伸率的乘积等于 $1$。请从基本的连续介质力学关系出发，推导轴向柯西（Cauchy）应力 $\\sigma$ 作为轴向拉伸率 $\\lambda$、$C_1$ 和 $C_2$ 的函数表达式，推导过程不使用任何简化公式。然后，根据单轴拉伸的应力-拉伸率数据，构建一个线性最小二乘问题来估计 $C_1$ 和 $C_2$。推导过程必须从不可压缩、各向同性超弹性材料的不变量定义和基于应变能函数的应力表达式开始，并且必须展示在给定的 $\\lambda$ 值下，如何获得一个关于 $C_1$ 和 $C_2$ 的线性系统。\n\n使用您推导出的线性最小二乘公式，根据以下几组轴向拉伸率 $\\lambda$（无量纲）和对应的轴向柯西应力 $\\sigma$（单位为千帕）的测试数据，计算 $C_1$ 和 $C_2$。轴向拉伸率值以 $\\lambda$ 表示，轴向柯西应力值以 $\\sigma$ 表示。\n\n情况 A（典型的死后健康白质，中等拉伸范围）：拉伸率 $\\lambda \\in \\{\\,$ $1.00$, $1.10$, $1.20$, $1.30$, $1.40$ $\\,\\}$，对应的应力 $\\sigma \\in \\{\\,$ $0.000000$, $3.2779338$, $6.4700000$, $9.4110056$, $12.7551022$ $\\,\\}$。\n\n情况 B（接近生理状态的小应变边界区域，可能为病态条件）：拉伸率 $\\lambda \\in \\{\\,$ $1.00$, $1.02$, $1.04$, $1.06$, $1.08$ $\\,\\}$，对应的应力 $\\sigma \\in \\{\\,$ $0.000000$, $0.4288792$, $0.8558160$, $1.2212280$, $1.6655050$ $\\,\\}$。\n\n情况 C（由已知模型生成的合成精确数据）：拉伸率 $\\lambda \\in \\{\\,$ $1.00$, $1.15$, $1.30$, $1.50$ $\\,\\}$，对应的应力 $\\sigma \\in \\{\\,$ $0.000000$, $3.8401000$, $7.4369820$, $12.1388889$ $\\,\\}$。\n\n情况 D（伤后水肿样软化，更宽的拉伸范围，含噪声）：拉伸率 $\\lambda \\in \\{\\,$ $1.00$, $1.10$, $1.25$, $1.40$, $1.60$ $\\,\\}$，对应的应力 $\\sigma \\in \\{\\,$ $0.000000$, $0.8663140$, $2.2260000$, $3.4735920$, $5.4096250$ $\\,\\}$。\n\n您的程序必须：\n\n- 实现用于估算 $C_1$ 和 $C_2$ 的线性最小二乘估计器，该估计器仅使用Mooney-Rivlin应变能函数的定义、不可压缩性约束，以及不可压缩、各向同性超弹性材料在单轴拉伸下的柯西应力关系。\n- 对于每种情况，计算 $C_1$ 和 $C_2$（单位为千帕），并将每个参数四舍五入到 $6$ 位小数。\n- 将最终输出表示为单行，该行包含一个由方括号括起来的、以逗号分隔的列表，其中每个元素是对应测试案例的一个双元素列表 $[C_1,C_2]$，顺序为 A、B、C、D。例如，输出应类似于 $[\\,[C_{1A},C_{2A}],[C_{1B},C_{2B}],[C_{1C},C_{2C}],[C_{1D},C_{2D}]\\,]$，使用数值。不要在打印输出中包含单位；所有数值都默认为千帕。\n\n答案以千帕为单位，并将每个参数四舍五入到 $6$ 位小数。本问题不使用角度。不需要百分比。",
            "solution": "该问题是有效的，因为它在科学上基于连续介质力学，是良定的，并为推导本构模型和执行参数估计提供了一个完整且一致的框架。\n\n解决方案分为两部分。首先，我们推导Mooney-Rivlin材料在单轴拉伸下轴向应力与轴向拉伸率之间的理论关系。其次，我们构建一个线性最小二乘问题，以根据实验数据估计材料参数 $C_1$ 和 $C_2$。\n\n**第1部分：应力-拉伸率关系的推导**\n\n分析从不可压缩、各向同性、超弹性材料的连续介质力学基本原理开始。\n\n1.  **单轴拉伸的运动学**\n\n    对于沿主轴 $x_1$（头尾方向）的单轴拉伸试验，轴向拉伸率记为 $\\lambda_1 = \\lambda$。由于材料的各向同性以及侧面无曳引力的条件，横向的拉伸率相等：$\\lambda_2 = \\lambda_3$。\n\n    不可压缩性约束要求体积保持恒定，这意味着形变梯度 $F$ 的行列式 $J = \\det(F)$ 必须等于 $1$。\n    $$ J = \\lambda_1 \\lambda_2 \\lambda_3 = 1 $$\n    代入各拉伸率可得：\n    $$ \\lambda \\lambda_2^2 = 1 \\implies \\lambda_2 = \\lambda_3 = \\frac{1}{\\sqrt{\\lambda}} = \\lambda^{-1/2} $$\n    因此，主拉伸率为 $(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})$。\n\n    在主坐标系中，形变梯度张量 $F$ 是一个对角矩阵：\n    $$ [F] = \\begin{pmatrix} \\lambda & 0 & 0 \\\\ 0 & \\lambda^{-1/2} & 0 \\\\ 0 & 0 & \\lambda^{-1/2} \\end{pmatrix} $$\n    左柯西-格林（Cauchy-Green）形变张量 $B$ 定义为 $B = FF^T$。由于 $F$ 是对角的，因此 $B = F^2$：\n    $$ [B] = \\begin{pmatrix} \\lambda^2 & 0 & 0 \\\\ 0 & \\lambda^{-1} & 0 \\\\ 0 & 0 & \\lambda^{-1} \\end{pmatrix} $$\n\n2.  **应变不变量**\n\n    张量 $B$ 的主不变量是主拉伸率的函数。\n    第一不变量 $I_1$ 是 $B$ 的迹：\n    $$ I_1 = \\mathrm{tr}(B) = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2 = \\lambda^2 + (\\lambda^{-1/2})^2 + (\\lambda^{-1/2})^2 = \\lambda^2 + 2\\lambda^{-1} $$\n    第二不变量 $I_2$ 可计算如下：\n    $$ I_2 = \\lambda_1^2 \\lambda_2^2 + \\lambda_2^2 \\lambda_3^2 + \\lambda_3^2 \\lambda_1^2 = (\\lambda^2)(\\lambda^{-1}) + (\\lambda^{-1})(\\lambda^{-1}) + (\\lambda^{-1})(\\lambda^2) = 2\\lambda + \\lambda^{-2} $$\n    第三不变量 $I_3$ 是 $B$ 的行列式：\n    $$ I_3 = \\det(B) = (\\det(F))^2 = J^2 = 1^2 = 1 $$\n    这与不可压缩性约束是一致的。\n\n3.  **Mooney-Rivlin 材料的柯西（Cauchy）应力**\n\n    不可压缩、各向同性、超弹性材料中柯西（Cauchy）应力张量 $\\sigma$ 的一般本构方程由下式给出：\n    $$ \\sigma = -pI + 2\\frac{\\partial W}{\\partial I_1}B - 2\\frac{\\partial W}{\\partial I_2}B^{-1} $$\n    其中 $p$ 是由不可压缩性约束产生的任意静水压力，$I$ 是单位张量，$W = W(I_1, I_2)$ 是应变能密度函数。\n\n    问题指定了一个双参数Mooney-Rivlin模型：\n    $$ W = C_1(I_1 - 3) + C_2(I_2 - 3) $$\n    $W$ 对不变量的偏导数为：\n    $$ \\frac{\\partial W}{\\partial I_1} = C_1 \\quad \\text{和} \\quad \\frac{\\partial W}{\\partial I_2} = C_2 $$\n    将这些代入应力方程可得：\n    $$ \\sigma = -pI + 2C_1B - 2C_2B^{-1} $$\n    左柯西-格林（Cauchy-Green）张量 $B$ 的逆矩阵 $B^{-1}$ 为：\n    $$ [B^{-1}] = \\begin{pmatrix} \\lambda^{-2} & 0 & 0 \\\\ 0 & \\lambda & 0 \\\\ 0 & 0 & \\lambda \\end{pmatrix} $$\n    在主坐标系中，应力张量的分量为：\n    $$ \\sigma_{11} = -p + 2C_1\\lambda^2 - 2C_2\\lambda^{-2} $$\n    $$ \\sigma_{22} = -p + 2C_1\\lambda^{-1} - 2C_2\\lambda $$\n    $$ \\sigma_{33} = -p + 2C_1\\lambda^{-1} - 2C_2\\lambda $$\n    对于单轴拉伸，侧面无曳引力，意味着垂直于这些面的应力分量为零：$\\sigma_{22} = \\sigma_{33} = 0$。利用这个边界条件，我们可以求解压力 $p$：\n    $$ 0 = -p + 2C_1\\lambda^{-1} - 2C_2\\lambda \\implies p = 2C_1\\lambda^{-1} - 2C_2\\lambda $$\n    轴向应力 $\\sigma = \\sigma_{11}$ 是唯一非零的主应力。将 $p$ 的表达式代入 $\\sigma_{11}$ 的方程中：\n    $$ \\sigma = -(2C_1\\lambda^{-1} - 2C_2\\lambda) + 2C_1\\lambda^2 - 2C_2\\lambda^{-2} $$\n    重新整理各项，将 $C_1$ 和 $C_2$ 分组：\n    $$ \\sigma = (2C_1\\lambda^2 - 2C_1\\lambda^{-1}) + (2C_2\\lambda - 2C_2\\lambda^{-2}) $$\n    $$ \\sigma = 2(\\lambda^2 - \\lambda^{-1})C_1 + 2(\\lambda - \\lambda^{-2})C_2 $$\n    这就是关联轴向柯西应力 $\\sigma$、轴向拉伸率 $\\lambda$ 以及材料参数 $C_1$ 和 $C_2$ 的最终表达式。\n\n**第2部分：线性最小二乘参数估计**\n\n推导出的应力-拉伸率关系对于参数 $C_1$ 和 $C_2$ 是线性的。给定一组 $n$ 个实验数据点 $(\\lambda_i, \\sigma_i)$，我们可以构建一个线性系统来估计 $C_1$ 和 $C_2$。\n\n对于每个数据点 $i=1, \\dots, n$，我们有：\n$$ \\sigma_i = 2(\\lambda_i^2 - \\lambda_i^{-1})C_1 + 2(\\lambda_i - \\lambda_i^{-2})C_2 $$\n这可以写成矩阵形式 $y = Ax$，其中：\n- $y$ 是观测应力向量：$y = [\\sigma_1, \\sigma_2, \\dots, \\sigma_n]^T$。\n- $x$ 是未知参数向量：$x = [C_1, C_2]^T$。\n- $A$ 是设计矩阵，其中第 $i$ 行由对应的拉伸率 $\\lambda_i$ 构建：\n$$ A = \\begin{pmatrix}\n2(\\lambda_1^2 - \\lambda_1^{-1}) & 2(\\lambda_1 - \\lambda_1^{-2}) \\\\\n2(\\lambda_2^2 - \\lambda_2^{-1}) & 2(\\lambda_2 - \\lambda_2^{-2}) \\\\\n\\vdots & \\vdots \\\\\n2(\\lambda_n^2 - \\lambda_n^{-1}) & 2(\\lambda_n - \\lambda_n^{-2})\n\\end{pmatrix} $$\n请注意，对于未形变状态（$\\lambda = 1$），$2(\\lambda^2 - \\lambda^{-1})$ 和 $2(\\lambda - \\lambda^{-2})$ 两项均为零，导致平凡方程 $\\sigma = 0 = 0 \\cdot C_1 + 0 \\cdot C_2$。该数据点不为参数估计提供任何信息，因此从方程组中排除。\n\n该系统通常是超定的（$n > 2$），因此我们寻求一个能使误差平方和 $\\|y - Ax\\|^2$ 最小化的解。这个线性最小二乘问题的解由正规方程给出：\n$$ A^T A x = A^T y $$\n求解 $x$ 可得估计的参数：\n$$ x = (A^T A)^{-1} A^T y $$\n将对每个提供的测试案例进行数值计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Mooney-Rivlin parameters C1 and C2 for four test cases\n    using a linear least squares formulation.\n    \"\"\"\n    test_cases = {\n        \"A\": {\n            \"lambda\": [1.00, 1.10, 1.20, 1.30, 1.40],\n            \"sigma\": [0.000000, 3.2779338, 6.4700000, 9.4110056, 12.7551022]\n        },\n        \"B\": {\n            \"lambda\": [1.00, 1.02, 1.04, 1.06, 1.08],\n            \"sigma\": [0.000000, 0.4288792, 0.8558160, 1.2212280, 1.6655050]\n        },\n        \"C\": {\n            \"lambda\": [1.00, 1.15, 1.30, 1.50],\n            \"sigma\": [0.000000, 3.8401000, 7.4369820, 12.1388889]\n        },\n        \"D\": {\n            \"lambda\": [1.00, 1.10, 1.25, 1.40, 1.60],\n            \"sigma\": [0.000000, 0.8663140, 2.2260000, 3.4735920, 5.4096250]\n        }\n    }\n\n    results = []\n    \n    # Process cases in the order A, B, C, D\n    for case_id in sorted(test_cases.keys()):\n        case_data = test_cases[case_id]\n        \n        # Convert data to numpy arrays\n        lambdas = np.array(case_data[\"lambda\"])\n        sigmas = np.array(case_data[\"sigma\"])\n\n        # Filter out the data point for lambda = 1.0, as it provides no information (0 = 0*C1 + 0*C2)\n        valid_indices = np.where(lambdas > 1.0)\n        l_fit = lambdas[valid_indices]\n        s_fit = sigmas[valid_indices]\n        \n        # Construct the design matrix A\n        # The equation is: sigma = 2*(lambda^2 - 1/lambda)*C1 + 2*(lambda - 1/lambda^2)*C2\n        # First column of A corresponds to the C1 coefficient\n        col1 = 2 * (l_fit**2 - 1/l_fit)\n        # Second column of A corresponds to the C2 coefficient\n        col2 = 2 * (l_fit - 1/l_fit**2)\n        \n        A = np.vstack([col1, col2]).T\n        \n        # The vector y is the vector of measured stresses\n        y = s_fit\n        \n        # Solve the linear least squares problem Ax = y for x = [C1, C2]\n        # Using rcond=None to adopt the new default behavior of np.linalg.lstsq\n        # The solution vector contains C1 and C2\n        C_vec, _, _, _ = np.linalg.lstsq(A, y, rcond=None)\n        \n        c1 = C_vec[0]\n        c2 = C_vec[1]\n        \n        # Round the parameters to 6 decimal places as required\n        c1_rounded = round(c1, 6)\n        c2_rounded = round(c2, 6)\n        \n        # Append the result pair for this case\n        results.append([c1_rounded, c2_rounded])\n        \n    # Format the final output string as a list of lists without spaces\n    # Example: [[c1a,c2a],[c1b,c2b],...]\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了如何表征材料本构关系之后，下一步便是将这些知识应用于预测复杂情境下的力学响应，例如脊髓受压迫时的内部应力分布。有限元方法 (FEM) 是实现这一目标的最强大工具之一。本练习  提供了一个全面的实践机会，指导您从零开始构建一个简化的脊髓受压有限元模型，包括组装刚度矩阵、施加边界条件以及处理接触和摩擦。通过这个计算实践，您将能深刻理解如何将连续介质力学理论转化为强大的数值模拟工具，以分析损伤生物力学问题。",
            "id": "4204689",
            "problem": "一个位于椎管内的脊髓三维力学模型，将被理想化为单个八节点三线性六面体单元，占据一个矩形域，其背腹侧厚度为 $H$（沿 $x$ 轴），内外侧宽度为 $W$（沿 $y$ 轴），纵向长度为 $L$（沿 $z$ 轴）。脊髓被建模为各向同性的线性弹性固体，其杨氏模量为 $E$，泊松比为 $\\nu$。腹侧椎管壁被理想化为一个与 $x=0$ 重合的刚性平面，该平面沿 $+x$ 方向发生大小为 $\\delta$ 的指定后向平移，代表腹侧受压。腹侧脊髓表面与刚性壁之间的法向接触通过每个节点的罚刚度 $k_n$ 来施加，切向摩擦通过每个节点的切向罚刚度 $k_t$ 与 Coulomb 摩擦系数 $\\mu$ 以及到摩擦锥上的投影相结合来进行正则化。位于 $x=H$ 的背侧表面是固定的（零位移边界条件），代表一个受约束的后向边界。椎管壁在切向方向上没有平移。接触惩罚通过与腹侧面面积成比例缩放来分布到四个腹侧节点上，使得 $k_{n,\\text{node}}=\\alpha_n \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$ 和 $k_{t,\\text{node}}=\\alpha_t \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$，其中 $A_{\\text{ventral}}=W L$，$\\alpha_n, \\alpha_t$ 是无量纲的罚比例参数。\n\n从在无体力和小应变运动学条件下的线性动量平衡出发，使用虚功原理和各向同性线性弹性本构关系，来获得具有节点位移向量 $\\mathbf{u}\\in\\mathbb{R}^{24}$ 的单个单元的离散平衡方程。本构关系为 $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon}=\\mathbf{B}\\mathbf{u}$ 是应变向量，$\\mathbf{D}$ 是由 Lamé 参数 $\\lambda$ 和 $\\mu_s$ 构建的弹性矩阵，其表达式为 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu_s=\\frac{E}{2(1+\\nu)}$。弱形式导出单元刚度矩阵 $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV$，该矩阵将使用在每个参数方向上的两点 Gaussian 求积进行计算。通过法向的罚方法和切向的正则化 Coulomb 摩擦定律来实现接触条件：对于每个腹侧节点，通过将 $k_{n,\\text{node}}$ 加到全局刚度矩阵中对应法向自由度的对角线元素上，并将 $k_{n,\\text{node}}\\delta$ 加到右端项向量的对应条目上，来施加到平面 $x=\\delta$ 的法向约束。对于每个腹侧节点的切向方向，将 $k_{t,\\text{node}}$ 加到对应切向自由度的对角线元素上。在求解 $\\mathbf{u}$ 之后，计算每个腹侧节点的接触反力作为残差向量 $\\mathbf{r}_i = \\big(k_{n,\\text{node}}(u_{x,i}-\\delta), \\, k_{t,\\text{node}} u_{y,i}, \\, k_{t,\\text{node}} u_{z,i}\\big)$，然后通过将切向分量投影到摩擦锥上来应用 Coulomb 摩擦：如果 $\\|\\mathbf{r}_{t,i}\\| > \\mu |r_{n,i}|$，则设置 $\\mathbf{r}_{t,i} \\leftarrow \\mathbf{r}_{t,i} \\frac{\\mu |r_{n,i}|}{\\|\\mathbf{r}_{t,i}\\|}$，否则保持 $\\mathbf{r}_{t,i}$ 不变。将腹侧平面上的总反力组装为节点反力向量之和，并报告其大小。计算每个 Gaussian 求积点处的 Cauchy 应力 $\\boldsymbol{\\sigma}$，并报告由下式定义的最大 von Mises 应力：\n$$\n\\sigma_\\text{vm} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_{xx}-\\sigma_{yy})^2 + (\\sigma_{yy}-\\sigma_{zz})^2 + (\\sigma_{zz}-\\sigma_{xx})^2\\right] + 3\\left(\\tau_{xy}^2 + \\tau_{yz}^2 + \\tau_{zx}^2\\right)}.\n$$\n\n您的程序必须：\n- 通过在父空间上对每个方向执行两点 Gaussian 求积，并通过矩形块的常数 Jacobian 矩阵映射到物理单元，来构建单元刚度矩阵 $\\mathbf{K}_e$。\n- 为单个单元组装全局系统，在背侧节点上施加指定的边界条件（所有三个方向的位移均为零），并整合罚接触的贡献。\n- 求解 $\\mathbf{u}$，计算带有摩擦投影的接触反力，计算 Gaussian 求积点处的应力，并为每个测试用例返回两个量：总腹侧反力的大小（单位：牛顿）和最大 von Mises 应力（单位：帕斯卡）。\n- 所有答案均以国际单位制（SI）表示。反力必须以牛顿为单位，von Mises 应力必须以帕斯卡为单位。以浮点数形式提供数值输出。\n\n使用以下测试套件参数集 $(E,\\nu,H,W,L,\\delta,\\mu,\\alpha_n,\\alpha_t)$：\n1. $(6.0\\times 10^5, \\, 0.45, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.001, \\, 0.30, \\, 20, \\, 5)$\n2. $(6.0\\times 10^5, \\, 0.45, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.001, \\, 0.00, \\, 20, \\, 5)$\n3. $(1.0\\times 10^6, \\, 0.40, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.0001, \\, 0.30, \\, 20, \\, 5)$\n4. $(6.0\\times 10^5, \\, 0.45, \\, 0.01, \\, 0.012, \\, 0.02, \\, 0.001, \\, 1.00, \\, 20, \\, 50)$\n\n最终输出格式：\n您的程序应生成一行输出，其中包含结果，形式为以逗号分隔的数对列表，每个测试用例一个数对，每个数对按 $[\\text{reaction\\_magnitude\\_N}, \\, \\text{max\\_von\\_Mises\\_Pa}]$ 的顺序列出，并用方括号括起来。例如，输出应如下所示：\n$[[r_1,s_1],[r_2,s_2],[r_3,s_3],[r_4,s_4]]$，\n其中每个 $r_i$ 和 $s_i$ 是 SI 单位制下的浮点数。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **模型：** 一个代表一段脊髓的八节点三线性六面体单元。\n- **域：** 一个尺寸为 $H$ (x-轴)、$W$ (y-轴) 和 $L$ (z-轴) 的矩形域。\n- **材料属性：** 各向同性、线性弹性固体，杨氏模量为 $E$，泊松比为 $\\nu$。\n- **本构定律：** $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$，Lamé 参数为 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu_s=\\frac{E}{2(1+\\nu)}$。\n- **运动学：** 小应变，$\\boldsymbol{\\varepsilon}=\\mathbf{B}\\mathbf{u}$。\n- **边界条件：**\n    - 背侧表面 ($x=H$)：固定（零位移）。\n    - 腹侧表面 ($x=0$)：与一个移动到 $x=\\delta$ 的刚性平面接触。\n- **接触模型（罚方法）：**\n    - 每个节点的法向罚刚度：$k_{n,\\text{node}}=\\alpha_n \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$，其中 $A_{\\text{ventral}}=W L$。\n    - 每个节点的切向罚刚度：$k_{t,\\text{node}}=\\alpha_t \\, E \\, \\frac{A_{\\text{ventral}}/4}{H}$。\n    - Coulomb 摩擦系数：$\\mu$。\n- **数值积分：** 单元刚度矩阵 $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV$ 使用在每个参数方向上的两点 Gaussian 求积进行计算。\n- **系统组装与求解：**\n    - 全局刚度矩阵通过在每个腹侧节点的法向 ($x$) 自由度对应的对角线元素上加上 $k_{n,\\text{node}}$，以及在切向 ($y, z$) 自由度对应的对角线元素上加上 $k_{t,\\text{node}}$ 来进行修改。\n    - 全局力向量通过在每个腹侧节点的法向 ($x$) 自由度对应的条目上加上 $k_{n,\\text{node}}\\delta$ 来进行修改。\n- **后处理：**\n    - 求解节点位移向量 $\\mathbf{u}$。\n    - 计算每个腹侧节点 $i$ 的反力向量：$\\mathbf{r}_i = \\big(k_{n,\\text{node}}(u_{x,i}-\\delta), \\, k_{t,\\text{node}} u_{y,i}, \\, k_{t,\\text{node}} u_{z,i}\\big)$。\n    - 应用 Coulomb 摩擦投影：如果 $\\|\\mathbf{r}_{t,i}\\| > \\mu |r_{n,i}|$，则设置 $\\mathbf{r}_{t,i} \\leftarrow \\mathbf{r}_{t,i} \\frac{\\mu |r_{n,i}|}{\\|\\mathbf{r}_{t,i}\\|}$。\n    - 计算总腹侧反力，作为节点反力向量之和的模。\n    - 计算每个 Gaussian 求积点处的 Cauchy 应力 $\\boldsymbol{\\sigma}$。\n    - 计算最大 von Mises 应力 $\\sigma_\\text{vm} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_{xx}-\\sigma_{yy})^2 + (\\sigma_{yy}-\\sigma_{zz})^2 + (\\sigma_{zz}-\\sigma_{xx})^2\\right] + 3\\left(\\tau_{xy}^2 + \\tau_{yz}^2 + \\tau_{zx}^2\\right)}$。\n- **测试用例：** 提供了四组参数 $(E,\\nu,H,W,L,\\delta,\\mu,\\alpha_n,\\alpha_t)$。\n- **要求输出：** 对每个测试用例，输出总腹侧反力的大小（单位：牛顿）和最大 von Mises 应力（单位：帕斯卡）。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于连续介质力学和有限元方法（FEM）的原理。使用三线性六面体单元、线性弹性、Gaussian 求积和用于接触的罚方法是计算固体力学中标准且成熟的技术。\n- **适定性：** 该问题是适定的。边界条件（一个面固定，另一个面通过罚方法施加指定位移）足以防止刚体运动并确保存在唯一解。处理摩擦的程序是一个非迭代的、显式的投影，这是对更复杂摩擦模型的简化，但在算法上是清晰的，并能导出一个唯一的、明确定义的结果。\n- **客观性：** 问题以精确、客观的数学和工程术语陈述，没有任何主观性或模糊性。\n- **完整性与一致性：** 问题提供了所有必要的信息，包括几何形状、材料属性、边界条件、数值方法（求积、罚参数）和后处理步骤。设置中没有矛盾之处。\n- **真实性与可行性：** 所选模型（单元理想化）虽然是一种简化，但在初步分析或教育背景下是常用方法。参数值对于生物力学应用是物理上合理的。\n- **结构与清晰度：** 问题结构清晰，引导用户完成有限元方法的各个步骤：公式化、组装、求解和后处理。术语定义明确。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。这是一个标准但全面的计算力学问题，可以按照描述的算法来解决。求解将通过实现指定的有限元公式来进行。\n\n### 求解过程\n\n该问题需要对一个八节点六面体单元在特定边界和接触条件下进行有限元分析。求解过程通过系统地构建有限元系统的各个组成部分、求解节点位移，然后对结果进行后处理以找到所需的反力和应力来进行。\n\n**1. 单元定义与坐标系**\n\n该单元是一个8节点三线性六面体。我们定义一个从参数坐标 $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$ 中的父单元到坐标为 $(x, y, z)$ 的物理单元的映射。物理域是由 $[0, H] \\times [0, W] \\times [0, L]$ 定义的矩形棱柱。我们将参数轴和物理轴对齐，使得 $\\xi$ 映射到 $x$，$\\eta$ 映射到 $y$，$\\zeta$ 映射到 $z$。等参映射为：\n$$\nx(\\xi) = \\frac{H}{2}(1+\\xi), \\quad y(\\eta) = \\frac{W}{2}(1+\\eta), \\quad z(\\zeta) = \\frac{L}{2}(1+\\zeta)\n$$\n父单元的标准节点排序 $(\\xi_i, \\eta_i, \\zeta_i)$ 是：\n1: $(-1,-1,-1)$, 2: $(1,-1,-1)$, 3: $(1,1,-1)$, 4: $(-1,1,-1)$\n5: $(-1,-1,1)$, 6: $(1,-1,1)$, 7: $(1,1,1)$, 8: $(-1,1,1)$\n\n通过此映射，$\\xi=-1$ 处的面对应物理平面 $x=0$（腹侧表面），$\\xi=1$ 处的面对应 $x=H$（背侧表面）。\n- 腹侧节点 (在 $x=0$ 上)：节点 1, 4, 8, 5。注意非顺序排列。我们使用标准编号：节点 1(-1,-1,-1), 节点 4(-1,1,-1), 节点 5(-1,-1,1), 节点 8(-1,1,1)。\n- 背侧节点 (在 $x=H$ 上)：节点 2, 3, 7, 6。使用标准编号：节点 2(1,-1,-1), 节点 3(1,1,-1), 节点 6(1,-1,1), 节点 7(1,1,1)。\n\n**2. 形函数与应变-位移矩阵 ($\\mathbf{B}$)**\n\n位移场通过三线性形函数 $N_i(\\xi, \\eta, \\zeta)$ 从节点位移 $\\mathbf{u}_i$ 插值得到：\n$N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)$\n应变向量由 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\mathbf{u}$ 给出，其中 $\\mathbf{u}$ 是所有节点位移的 $24 \\times 1$ 向量。矩阵 $\\mathbf{B}$ 分块为 $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\ldots, \\mathbf{B}_8]$，其中每个 $\\mathbf{B}_i$ 是一个 $6 \\times 3$ 的矩阵：\n$$\n\\mathbf{B}_i =\n\\begin{bmatrix}\n\\partial N_i / \\partial x  0  0 \\\\\n0  \\partial N_i / \\partial y  0 \\\\\n0  0  \\partial N_i / \\partial z \\\\\n\\partial N_i / \\partial y  \\partial N_i / \\partial x  0 \\\\\n0  \\partial N_i / \\partial z  \\partial N_i / \\partial y \\\\\n\\partial N_i / \\partial z  0  \\partial N_i / \\partial x\n\\end{bmatrix}\n$$\n对物理坐标的导数通过链式法则获得，这需要坐标变换的 Jacobian 矩阵 $\\mathbf{J}$。对于我们的矩形单元，$\\mathbf{J}$ 是对角的且是常数：\n$$\n\\mathbf{J} = \\begin{bmatrix} \\partial x/\\partial\\xi  0  0 \\\\ 0  \\partial y/\\partial\\eta  0 \\\\ 0  0  \\partial z/\\partial\\zeta \\end{bmatrix} = \\text{diag}\\left(\\frac{H}{2}, \\frac{W}{2}, \\frac{L}{2}\\right)\n$$\n其逆矩阵为 $\\mathbf{J}^{-1} = \\text{diag}\\left(\\frac{2}{H}, \\frac{2}{W}, \\frac{2}{L}\\right)$。形函数的空间导数为：\n$\\frac{\\partial N_i}{\\partial x} = \\frac{2}{H}\\frac{\\partial N_i}{\\partial \\xi}$, $\\frac{\\partial N_i}{\\partial y} = \\frac{2}{W}\\frac{\\partial N_i}{\\partial \\eta}$, $\\frac{\\partial N_i}{\\partial z} = \\frac{2}{L}\\frac{\\partial N_i}{\\partial \\zeta}$。\n\n**3. 本构矩阵 ($\\mathbf{D}$)**\n\n对于线性各向同性材料，本构矩阵 $\\mathbf{D}$ 将应力向量 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{zz}, \\tau_{xy}, \\tau_{yz}, \\tau_{zx}]^\\top$ 与工程应变向量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^\\top$ 联系起来。使用 Lamé 参数 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu_s = G = \\frac{E}{2(1+\\nu)}$，该矩阵为：\n$$\n\\mathbf{D} = \\begin{bmatrix}\n\\lambda+2\\mu_s  \\lambda  \\lambda  0  0  0 \\\\\n\\lambda  \\lambda+2\\mu_s  \\lambda  0  0  0 \\\\\n\\lambda  \\lambda  \\lambda+2\\mu_s  0  0  0 \\\\\n0  0  0  \\mu_s  0  0 \\\\\n0  0  0  0  \\mu_s  0 \\\\\n0  0  0  0  0  \\mu_s\n\\end{bmatrix}\n$$\n\n**4. 单元刚度矩阵 ($\\mathbf{K}_e$)**\n\n单元刚度矩阵通过在单元体积上积分来计算：\n$$\n\\mathbf{K}_e = \\int_{V_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\mathbf{B}^\\top(\\xi,\\eta,\\zeta) \\mathbf{D} \\mathbf{B}(\\xi,\\eta,\\zeta) \\det(\\mathbf{J}) \\,d\\xi d\\eta d\\zeta\n$$\n其中 $\\det(\\mathbf{J}) = \\frac{HWL}{8}$。我们在每个方向上使用两点 Gaussian 求积。求积点位于 $\\pm 1/\\sqrt{3}$，所有权重均为 $1$。积分通过将在 $2 \\times 2 \\times 2 = 8$ 个 Gauss 点上计算的被积函数值相加，再乘以权重（均为 $1$）和 $\\det(\\mathbf{J})$ 来近似。\n$$\n\\mathbf{K}_e \\approx \\sum_{p=1}^2\\sum_{q=1}^2\\sum_{r=1}^2 \\mathbf{B}^\\top(\\xi_p,\\eta_q,\\zeta_r) \\mathbf{D} \\mathbf{B}(\\xi_p,\\eta_q,\\zeta_r) \\det(\\mathbf{J})\n$$\n\n**5. 组装与边界条件**\n\n对于单个单元，全局刚度矩阵就是 $\\mathbf{K}_e$。系统方程为 $\\mathbf{K}_e \\mathbf{u} = \\mathbf{f}$。\n- **固定边界条件：** 背侧节点 (2, 3, 6, 7) 是固定的，意味着它们的每个 3 个自由度均为零。这总共涉及 12 个自由度。我们将系统划分为活动（未知）自由度和固定（已知）自由度。活动自由度是对应于腹侧节点 (1, 4, 5, 8) 的 12 个自由度。我们求解一个简化的 $12 \\times 12$ 系统。\n- **接触边界条件：** 罚方法应用于活动自由度。令 $\\mathbf{K}_{red}$ 为 $\\mathbf{K}_e$ 中对应活动自由度的 $12 \\times 12$ 子矩阵，$\\mathbf{f}_{red}$ 为相应的力向量（初始为零）。\n    - 罚刚度值为 $k_{n,\\text{node}} = \\alpha_n E \\frac{WL/4}{H}$ 和 $k_{t,\\text{node}} = \\alpha_t E \\frac{WL/4}{H}$。\n    - 对于四个腹侧节点中的每一个：\n        1. 将 $k_{n,\\text{node}}$ 加到 $\\mathbf{K}_{red}$ 中对应其 $x$-位移的对角线元素上。\n        2. 将 $k_{t,\\text{node}}$ 加到 $\\mathbf{K}_{red}$ 中对应其 $y$-和 $z$-位移的对角线元素上。\n        3. 将力项 $k_{n,\\text{node}}\\delta$ 加到 $\\mathbf{f}_{red}$ 中对应其 $x$-位移的元素上。\n然后求解修改后的简化系统 $\\mathbf{K}'_{red}\\mathbf{u}_{red} = \\mathbf{f}'_{red}$ 以获得未知位移 $\\mathbf{u}_{red}$。\n\n**6. 后处理**\n\n- **位移：** 将求解得到的 $\\mathbf{u}_{red}$ 与固定节点的零位移结合，形成完整的 $24 \\times 1$ 位移向量 $\\mathbf{u}$。\n- **接触反力：** 对于每个腹侧节点 $i$，首先根据求解出的位移 $u_{x,i}, u_{y,i}, u_{z,i}$ 计算反力 $\\mathbf{r}_i$：\n    $r_{n,i} = k_{n,\\text{node}}(u_{x,i} - \\delta)$\n    $\\mathbf{r}_{t,i} = (k_{t,\\text{node}}u_{y,i}, k_{t,\\text{node}}u_{z,i})$\n    然后应用 Coulomb 摩擦条件。如果切向反力的大小 $\\|\\mathbf{r}_{t,i}\\|$ 超过摩擦极限 $\\mu |r_{n,i}|$，则将切向反力向量投影回摩擦锥：\n    $\\mathbf{r}_{t,i} \\leftarrow \\mathbf{r}_{t,i} \\frac{\\mu |r_{n,i}|}{\\|\\mathbf{r}_{t,i}\\|}$\n    腹侧平面上的总反力是这些最终节点反力的向量和，$\\mathbf{R} = \\sum_i \\mathbf{r}_i$。要求的输出是其大小 $\\|\\mathbf{R}\\|$。\n- **应力：** 在 8 个 Gaussian 求积点中的每一个点，使用 $\\boldsymbol{\\sigma} = \\mathbf{D} \\mathbf{B} \\mathbf{u}$ 计算应力张量。然后使用提供的公式计算每个点的 von Mises 等效应力 $\\sigma_{\\text{vm}}$。报告 8 个点中的最大值。\n\n这个详细的过程构成了计算实现的基础。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a single-element finite element problem for spinal cord compression.\n    \"\"\"\n\n    test_cases = [\n        # (E, nu, H, W, L, delta, mu, alpha_n, alpha_t)\n        (6.0e5, 0.45, 0.01, 0.012, 0.02, 0.001, 0.30, 20, 5),\n        (6.0e5, 0.45, 0.01, 0.012, 0.02, 0.001, 0.00, 20, 5),\n        (1.0e6, 0.40, 0.01, 0.012, 0.02, 0.0001, 0.30, 20, 5),\n        (6.0e5, 0.45, 0.01, 0.012, 0.02, 0.001, 1.00, 20, 50),\n    ]\n\n    results = []\n    for params in test_cases:\n        E, nu, H, W, L, delta, mu_friction, alpha_n, alpha_t = params\n        \n        # 1. Constitutive Matrix (D-matrix)\n        lmbda = E * nu / ((1 + nu) * (1 - 2 * nu))\n        mu_s = E / (2 * (1 + nu)) # Shear modulus, often G\n        \n        D = np.zeros((6, 6))\n        D[0,0] = D[1,1] = D[2,2] = lmbda + 2 * mu_s\n        D[0,1] = D[1,0] = D[0,2] = D[2,0] = D[1,2] = D[2,1] = lmbda\n        D[3,3] = D[4,4] = D[5,5] = mu_s\n\n        # 2. Element Geometry and Numerical Integration Setup\n        # Node coordinates in parent element space [-1, 1]^3\n        node_coords_parent = np.array([\n            [-1, -1, -1], [ 1, -1, -1], [ 1,  1, -1], [-1,  1, -1],\n            [-1, -1,  1], [ 1, -1,  1], [ 1,  1,  1], [-1,  1,  1]\n        ])\n        \n        # Gaussian quadrature points and weights (2-point)\n        gp_loc = 1.0 / np.sqrt(3.0)\n        gauss_points = [-gp_loc, gp_loc]\n        gauss_weights = [1.0, 1.0]\n\n        detJ = (H / 2.0) * (W / 2.0) * (L / 2.0)\n        \n        Ke = np.zeros((24, 24))\n\n        # 3. Assemble Element Stiffness Matrix (Ke)\n        for w_xi, xi in zip(gauss_weights, gauss_points):\n            for w_eta, eta in zip(gauss_weights, gauss_points):\n                for w_zeta, zeta in zip(gauss_weights, gauss_points):\n                    \n                    B = np.zeros((6, 24))\n                    \n                    for i in range(8):\n                        xi_i, eta_i, zeta_i = node_coords_parent[i]\n                        \n                        # Derivatives of shape functions w.r.t. parent coords\n                        dNi_dxi = 0.125 * xi_i * (1 + eta_i * eta) * (1 + zeta_i * zeta)\n                        dNi_deta = 0.125 * eta_i * (1 + xi_i * xi) * (1 + zeta_i * zeta)\n                        dNi_dzeta = 0.125 * zeta_i * (1 + xi_i * xi) * (1 + eta_i * eta)\n\n                        # Derivatives w.r.t. physical coords using Jacobian\n                        dNi_dx = dNi_dxi * 2.0 / H\n                        dNi_dy = dNi_deta * 2.0 / W\n                        dNi_dz = dNi_dzeta * 2.0 / L\n\n                        # Assemble B_i into global B\n                        B[0, 3 * i]     = dNi_dx\n                        B[1, 3 * i + 1] = dNi_dy\n                        B[2, 3 * i + 2] = dNi_dz\n                        B[3, 3 * i]     = dNi_dy\n                        B[3, 3 * i + 1] = dNi_dx\n                        B[4, 3 * i + 1] = dNi_dz\n                        B[4, 3 * i + 2] = dNi_dy\n                        B[5, 3 * i]     = dNi_dz\n                        B[5, 3 * i + 2] = dNi_dx\n                        \n                    Ke += B.T @ D @ B * (w_xi * w_eta * w_zeta) * detJ\n\n        # 4. Apply Boundary Conditions\n        # Ventral nodes (x=0, xi=-1): 1, 4, 5, 8\n        ventral_node_indices = [0, 3, 4, 7]\n        # Dorsal nodes (x=H, xi=1): 2, 3, 6, 7\n        dorsal_node_indices = [1, 2, 5, 6]\n\n        active_dofs = []\n        for i in ventral_node_indices:\n            active_dofs.extend([3 * i, 3 * i + 1, 3 * i + 2])\n        \n        K_red = Ke[np.ix_(active_dofs, active_dofs)]\n        f_red = np.zeros(len(active_dofs))\n\n        # 5. Apply Penalty Contact\n        A_ventral = W * L\n        k_n_node = alpha_n * E * (A_ventral / 4.0) / H\n        k_t_node = alpha_t * E * (A_ventral / 4.0) / H\n        \n        for i in range(len(ventral_node_indices)):\n            # Indices in the reduced 12x12 system\n            idx_x = 3 * i\n            idx_y = 3 * i + 1\n            idx_z = 3 * i + 2\n            \n            K_red[idx_x, idx_x] += k_n_node\n            K_red[idx_y, idx_y] += k_t_node\n            K_red[idx_z, idx_z] += k_t_node\n            \n            f_red[idx_x] += k_n_node * delta\n            \n        # 6. Solve for Displacements\n        u_red = np.linalg.solve(K_red, f_red)\n        \n        u = np.zeros(24)\n        u[active_dofs] = u_red\n\n        # 7. Post-Processing: Reaction Force\n        total_reaction = np.zeros(3)\n        for i_node, node_idx in enumerate(ventral_node_indices):\n            u_node = u_red[3*i_node : 3*i_node+3]\n            u_x, u_y, u_z = u_node\n\n            r_n = k_n_node * (u_x - delta)\n            r_ty = k_t_node * u_y\n            r_tz = k_t_node * u_z\n\n            r_t_mag = np.sqrt(r_ty**2 + r_tz**2)\n            f_lim = mu_friction * abs(r_n)\n            \n            if r_t_mag > f_lim and r_t_mag > 1e-12: # Avoid division by zero\n                scale = f_lim / r_t_mag\n                r_ty *= scale\n                r_tz *= scale\n\n            total_reaction += [r_n, r_ty, r_tz]\n        \n        reaction_magnitude = np.linalg.norm(total_reaction)\n\n        # 8. Post-Processing: Stress\n        max_vm_stress = 0.0\n        for xi in gauss_points:\n            for eta in gauss_points:\n                for zeta in gauss_points:\n                    \n                    B = np.zeros((6, 24))\n                    for i in range(8):\n                        xi_i, eta_i, zeta_i = node_coords_parent[i]\n                        dNi_dxi = 0.125 * xi_i * (1 + eta_i * eta) * (1 + zeta_i * zeta)\n                        dNi_deta = 0.125 * eta_i * (1 + xi_i * xi) * (1 + zeta_i * zeta)\n                        dNi_dzeta = 0.125 * zeta_i * (1 + xi_i * xi) * (1 + eta_i * eta)\n                        dNi_dx = dNi_dxi * 2.0 / H\n                        dNi_dy = dNi_deta * 2.0 / W\n                        dNi_dz = dNi_dzeta * 2.0 / L\n                        B[0, 3 * i] = dNi_dx; B[1, 3 * i + 1] = dNi_dy; B[2, 3 * i + 2] = dNi_dz\n                        B[3, 3 * i] = dNi_dy; B[3, 3 * i + 1] = dNi_dx\n                        B[4, 3 * i + 1] = dNi_dz; B[4, 3 * i + 2] = dNi_dy\n                        B[5, 3 * i] = dNi_dz; B[5, 3 * i + 2] = dNi_dx\n                        \n                    strain = B @ u\n                    stress = D @ strain\n                    \n                    s_xx, s_yy, s_zz = stress[0], stress[1], stress[2]\n                    t_xy, t_yz, t_zx = stress[3], stress[4], stress[5] # tau in Voigt\n                    \n                    vm_stress = np.sqrt(\n                        0.5 * ((s_xx - s_yy)**2 + (s_yy - s_zz)**2 + (s_zz - s_xx)**2) +\n                        3.0 * (t_xy**2 + t_yz**2 + t_zx**2)\n                    )\n                    if vm_stress > max_vm_stress:\n                        max_vm_stress = vm_stress\n\n        results.append([reaction_magnitude, max_vm_stress])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'[{r},{s}]' for r, s in results)}]\")\n\nsolve()\n```"
        }
    ]
}