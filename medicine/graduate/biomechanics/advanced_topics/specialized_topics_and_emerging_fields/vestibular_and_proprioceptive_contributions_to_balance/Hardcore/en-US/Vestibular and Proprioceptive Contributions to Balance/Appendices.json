{
    "hands_on_practices": [
        {
            "introduction": "Before we can model the complexities of neural control, we must first master the fundamentals of how balance is measured. This practice grounds our study in the experimental reality of biomechanics by focusing on the force plate, a cornerstone tool for assessing postural stability. You will derive the mathematical relationship between the raw forces and moments measured by the plate and the Center of Pressure (COP), a critical variable that represents the application point of the ground reaction force and serves as a proxy for postural sway .",
            "id": "4211017",
            "problem": "A healthy adult subject performs quiet bipedal stance on a six-component rigid force plate for balance assessment aimed at quantifying the integration of vestibular and proprioceptive inputs. The Center of Pressure (COP) is defined as the point on the top surface of the plate where the resultant ground reaction force would act to produce the same external wrench on the body as the actual distributed contact. The inertial frame is right-handed with axes: $x$ anterior, $y$ right-lateral, and $z$ superior. Positive forces follow axis directions and positive moments follow the right-hand rule. The instrumented origin $O$ of the plate’s measurement frame is located a fixed distance $h$ below the top surface, along $-z$. Assume a rigid plate and rigid foot-contact patch, and that any foot-floor free moment exists only about the $z$-axis within the contact (i.e., no net free moments about $x$ or $y$).\n\nStarting from first principles of rigid-body mechanics, specifically: (i) the definition of moment about a point, $\\boldsymbol{M}_{O}=\\boldsymbol{r}_{OP}\\times \\boldsymbol{F}+\\boldsymbol{M}_{\\text{free}}$, where $\\boldsymbol{r}_{OP}$ is the position vector from $O$ to the COP point $P$ on the top surface, $\\boldsymbol{F}$ is the ground reaction force vector, and $\\boldsymbol{M}_{\\text{free}}$ is any free moment at the contact; and (ii) the sign conventions described above, derive closed-form expressions for the COP coordinates on the top surface, $COP_{x}$ and $COP_{y}$, in terms of measured $\\boldsymbol{F}=(F_{x},F_{y},F_{z})$, measured $\\boldsymbol{M}_{O}=(M_{x},M_{y},M_{z})$, and the offset $h$. Clearly state the sign conventions required for these expressions to be valid and enumerate the calibration requirements that must be met to ensure accurate COP-based balance metrics in this context.\n\nThen, for a particular instant during quiet stance, the calibrated measurements at the origin $O$ are:\n- $F_{x}=22~\\text{N}$, $F_{y}=-15~\\text{N}$, $F_{z}=690~\\text{N}$,\n- $M_{x}=11.5~\\text{N}\\cdot\\text{m}$, $M_{y}=-8.1~\\text{N}\\cdot\\text{m}$,\nand the origin offset is $h=0.040~\\text{m}$ (origin $4.0~\\text{cm}$ below the top surface).\n\nUsing your derived expressions, compute $COP_{x}$ and $COP_{y}$ at the top surface. Express both coordinates in meters and round your answers to four significant figures. Provide the final numerical answer as a two-entry row in the order $COP_{x}$, $COP_{y}$.",
            "solution": "The goal is to locate the Center of Pressure (COP) on the top surface of the force plate. We adopt a right-handed inertial frame with axes $x$ anterior, $y$ right-lateral, and $z$ superior. Ground reaction forces are measured at the plate’s origin $O$, located a distance $h$ below the top surface along $-z$. The COP point $P$ lies on the top surface, so its position vector in the global frame can be denoted $(COP_{x},COP_{y},0)$, and the vector from $O$ to $P$ is $\\boldsymbol{r}_{OP}=(COP_{x},~COP_{y},~h)$ because $O$ is at $z=-h$ and $P$ is at $z=0$.\n\nWe start from the rigid-body moment definition about the origin $O$:\n$$\n\\boldsymbol{M}_{O}=\\boldsymbol{r}_{OP}\\times \\boldsymbol{F}+\\boldsymbol{M}_{\\text{free}},\n$$\nwhere $\\boldsymbol{F}=(F_{x},F_{y},F_{z})$ is the resultant ground reaction force, and $\\boldsymbol{M}_{\\text{free}}$ is any free (distributed) moment that cannot be represented by a single resultant force acting at a point. Under the stated assumption that the free moment exists only about the $z$-axis, we have $\\boldsymbol{M}_{\\text{free}}=(0,0,M_{\\text{free},z})$, implying the $x$ and $y$ components of $\\boldsymbol{M}_{O}$ arise solely from $\\boldsymbol{r}_{OP}\\times \\boldsymbol{F}$.\n\nCompute the cross product component-wise:\n$$\n\\boldsymbol{r}_{OP}\\times \\boldsymbol{F}=\n\\begin{pmatrix}\nCOP_{y}\\,F_{z}-h\\,F_{y} \\\\\nh\\,F_{x}-COP_{x}\\,F_{z} \\\\\nCOP_{x}\\,F_{y}-COP_{y}\\,F_{x}\n\\end{pmatrix}.\n$$\nEquating the $x$ and $y$ components to the measured $M_{x}$ and $M_{y}$ (since $M_{\\text{free}}$ contributes only to the $z$-component):\n$$\nM_{x}=COP_{y}\\,F_{z}-h\\,F_{y}, \\qquad M_{y}=h\\,F_{x}-COP_{x}\\,F_{z}.\n$$\nSolve these for $COP_{x}$ and $COP_{y}$:\n$$\nCOP_{x}=\\frac{h\\,F_{x}-M_{y}}{F_{z}}, \\qquad COP_{y}=\\frac{M_{x}+h\\,F_{y}}{F_{z}}.\n$$\nThese expressions reduce to the familiar forms $COP_{x}=-M_{y}/F_{z}$ and $COP_{y}=M_{x}/F_{z}$ when $h=0$ (origin on the contact plane) and when shear forces $F_{x}$ and $F_{y}$ do not introduce offset-dependent contributions.\n\nSign conventions required for validity:\n- The coordinate system is right-handed with $x$ anterior (forward), $y$ right-lateral, $z$ superior (upward).\n- Forces $F_{x},F_{y},F_{z}$ are positive along $+x,+y,+z$ respectively; $F_{z}>0$ when the plate pushes up on the subject.\n- Moments $M_{x},M_{y},M_{z}$ about the origin follow the right-hand rule about their respective axes.\n- The origin $O$ is located at $z=-h$ relative to the top surface, so $\\boldsymbol{r}_{OP}=(COP_{x},COP_{y},h)$.\n\nCalibration requirements for accurate COP-based balance metrics:\n- Channel zeroing: offsets must be removed so that $\\boldsymbol{F}$ and $\\boldsymbol{M}_{O}$ are referenced to the unloaded state (e.g., subtract baseline drifts).\n- Sensitivity scaling: apply the validated calibration gains (and, if applicable, cross-talk compensation) to convert raw outputs (voltage or counts) into physical units (newtons and newton-meters).\n- Coordinate alignment: ensure the plate’s local axes are aligned to the global biomechanical frame; otherwise, rotate the measured wrench into the defined right-handed frame before computing COP.\n- Geometric reference: use the correct $h$ (distance from the origin to the top surface contact plane). Misestimation of $h$ biases $COP_{x}$ and $COP_{y}$ through the shear-force terms.\n- Range and linearity: verify $F_{z}$ remains sufficiently above zero so that division by $F_{z}$ is well-conditioned; COP is undefined when $F_{z}\\approx 0$.\n- Consistent sign convention documentation: record the polarity of moment channels; incorrect sign will reflect COP across axes.\n\nNow compute the numerical COP for the given instant using $h=0.040~\\text{m}$, $F_{x}=22~\\text{N}$, $F_{y}=-15~\\text{N}$, $F_{z}=690~\\text{N}$, $M_{x}=11.5~\\text{N}\\cdot\\text{m}$, and $M_{y}=-8.1~\\text{N}\\cdot\\text{m}$:\n$$\nCOP_{x}=\\frac{h\\,F_{x}-M_{y}}{F_{z}}=\\frac{(0.040)(22)-(-8.1)}{690}=\\frac{0.88+8.10}{690}=\\frac{8.98}{690}\\approx 0.01301449275~\\text{m},\n$$\n$$\nCOP_{y}=\\frac{M_{x}+h\\,F_{y}}{F_{z}}=\\frac{11.5+(0.040)(-15)}{690}=\\frac{11.5-0.60}{690}=\\frac{10.90}{690}\\approx 0.01579710145~\\text{m}.\n$$\nRounded to four significant figures and expressed in meters:\n$$\nCOP_{x}\\approx 0.01301~\\text{m}, \\qquad COP_{y}\\approx 0.01580~\\text{m}.\n$$\nThese COP coordinates represent the instantaneous location of the resultant ground reaction’s point of application on the plate’s top surface, providing a quantitative metric that reflects neuromuscular control integrating proprioceptive and vestibular inputs during quiet stance.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.01301 & 0.01580\\end{pmatrix}}$$"
        },
        {
            "introduction": "With a method to quantify balance, we now turn to the brain's remarkable ability to create a stable perception of self-motion from imperfect sensory data. The vestibular and proprioceptive systems both provide information about body orientation, but each is corrupted by noise. This exercise challenges you to model this process using Bayesian probability theory, demonstrating how the central nervous system can optimally combine these noisy inputs to produce a single, more reliable estimate of body tilt . This principle of precision-weighted sensory integration is a cornerstone of modern computational neuroscience and essential for understanding postural control.",
            "id": "4211028",
            "problem": "In human standing balance, the central nervous system (CNS) estimates the instantaneous body tilt angle $\\theta$ (in radians) by combining noisy measurements from the vestibular and proprioceptive systems. Assume a linear sensory encoding model in which the vestibular measurement $z_{v}$ and the proprioceptive measurement $z_{p}$ are conditionally independent given $\\theta$ and are corrupted by zero-mean Gaussian noise with variances $\\sigma_{v}^{2}$ and $\\sigma_{p}^{2}$, respectively. Formally, $z_{v} = \\theta + \\varepsilon_{v}$ with $\\varepsilon_{v} \\sim \\mathcal{N}(0,\\sigma_{v}^{2})$, and $z_{p} = \\theta + \\varepsilon_{p}$ with $\\varepsilon_{p} \\sim \\mathcal{N}(0,\\sigma_{p}^{2})$, where $\\varepsilon_{v}$ and $\\varepsilon_{p}$ are independent. The CNS encodes a prior belief about tilt as a Gaussian distribution $\\theta \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$, reflecting biomechanically constrained expectations (e.g., upright stance).\n\nStarting from Bayes’ rule and the definitions of the Gaussian probability density function and conditional independence, construct the multisensory likelihood $p(z_{v},z_{p}\\,|\\,\\theta)$ and derive the posterior distribution $p(\\theta\\,|\\,z_{v},z_{p})$. Specify the analytical expressions for the posterior mean and the posterior variance as functions of $\\mu_{0}$, $\\sigma_{0}^{2}$, $\\sigma_{v}^{2}$, $\\sigma_{p}^{2}$, $z_{v}$, and $z_{p}$.\n\nProvide your final answer as a single closed-form analytic expression for the posterior mean and variance together, formatted as a row matrix. No numerical rounding is required.",
            "solution": "The objective is to find the posterior probability distribution $p(\\theta\\,|\\,z_{v}, z_{p})$, which quantifies the belief about the tilt angle $\\theta$ after observing the measurements $z_{v}$ and $z_{p}$. We will use Bayes' rule:\n$$p(\\theta\\,|\\,z_{v}, z_{p}) = \\frac{p(z_{v}, z_{p}\\,|\\,\\theta) p(\\theta)}{p(z_{v}, z_{p})}$$\nSince the denominator $p(z_{v}, z_{p})$ is a normalization constant that does not depend on $\\theta$, we can work with proportionality:\n$$p(\\theta\\,|\\,z_{v}, z_{p}) \\propto p(z_{v}, z_{p}\\,|\\,\\theta) p(\\theta)$$\n\nFirst, we define the probability density functions (PDFs) for the prior and the likelihoods.\nThe prior distribution of $\\theta$ is given as Gaussian:\n$$p(\\theta) = \\mathcal{N}(\\theta; \\mu_{0}, \\sigma_{0}^{2}) = \\frac{1}{\\sqrt{2\\pi\\sigma_{0}^{2}}} \\exp\\left(-\\frac{(\\theta - \\mu_{0})^2}{2\\sigma_{0}^{2}}\\right)$$\nThe measurement models define the likelihood of observing $z_v$ and $z_p$ for a given $\\theta$.\nFrom $z_{v} = \\theta + \\varepsilon_{v}$ with $\\varepsilon_{v} \\sim \\mathcal{N}(0, \\sigma_{v}^{2})$, it follows that the distribution of $z_v$ conditioned on $\\theta$ is $p(z_{v}\\,|\\,\\theta) = \\mathcal{N}(z_{v}; \\theta, \\sigma_{v}^{2})$:\n$$p(z_{v}\\,|\\,\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma_{v}^{2}}} \\exp\\left(-\\frac{(z_{v} - \\theta)^2}{2\\sigma_{v}^{2}}\\right)$$\nSimilarly, from $z_{p} = \\theta + \\varepsilon_{p}$ with $\\varepsilon_{p} \\sim \\mathcal{N}(0, \\sigma_{p}^{2})$, we have $p(z_{p}\\,|\\,\\theta) = \\mathcal{N}(z_{p}; \\theta, \\sigma_{p}^{2})$:\n$$p(z_{p}\\,|\\,\\theta) = \\frac{1}{\\sqrt{2\\pi\\sigma_{p}^{2}}} \\exp\\left(-\\frac{(z_{p} - \\theta)^2}{2\\sigma_{p}^{2}}\\right)$$\n\nThe problem states that $z_v$ and $z_p$ are conditionally independent given $\\theta$. This allows us to construct the multisensory likelihood $p(z_{v}, z_{p}\\,|\\,\\theta)$ by multiplying the individual likelihoods:\n$$p(z_{v}, z_{p}\\,|\\,\\theta) = p(z_{v}\\,|\\,\\theta) p(z_{p}\\,|\\,\\theta)$$\n$$p(z_{v}, z_{p}\\,|\\,\\theta) = \\frac{1}{2\\pi\\sigma_{v}\\sigma_{p}} \\exp\\left(-\\frac{(z_{v} - \\theta)^2}{2\\sigma_{v}^{2}} - \\frac{(z_{p} - \\theta)^2}{2\\sigma_{p}^{2}}\\right)$$\n\nNow, we compute the posterior distribution using Bayes' rule. The product of Gaussian PDFs is proportional to another Gaussian PDF. To find its parameters, it is most convenient to work with the logarithm of the posterior and ignore constant terms (those not dependent on $\\theta$):\n$$\\ln p(\\theta\\,|\\,z_{v}, z_{p}) = \\ln p(\\theta) + \\ln p(z_{v}\\,|\\,\\theta) + \\ln p(z_{p}\\,|\\,\\theta) + C$$\nwhere $C$ is a constant.\n$$\\ln p(\\theta\\,|\\,z_{v}, z_{p}) = -\\frac{(\\theta - \\mu_{0})^2}{2\\sigma_{0}^{2}} - \\frac{(z_{v} - \\theta)^2}{2\\sigma_{v}^{2}} - \\frac{(z_{p} - \\theta)^2}{2\\sigma_{p}^{2}} + C'$$\nThe posterior distribution will be a Gaussian, let's call it $p(\\theta\\,|\\,z_{v}, z_{p}) = \\mathcal{N}(\\theta; \\mu_{post}, \\sigma_{post}^{2})$. Its logarithm has the form:\n$$\\ln \\mathcal{N}(\\theta; \\mu_{post}, \\sigma_{post}^{2}) = -\\frac{(\\theta - \\mu_{post})^2}{2\\sigma_{post}^{2}} + C'' = -\\frac{1}{2\\sigma_{post}^{2}}\\theta^2 + \\frac{\\mu_{post}}{\\sigma_{post}^{2}}\\theta - \\frac{\\mu_{post}^2}{2\\sigma_{post}^{2}} + C''$$\nWe expand the expression for $\\ln p(\\theta\\,|\\,z_{v}, z_{p})$ and collect terms in powers of $\\theta$:\n$$-\\frac{1}{2}\\left( \\frac{\\theta^2 - 2\\mu_{0}\\theta + \\mu_{0}^2}{\\sigma_{0}^{2}} + \\frac{\\theta^2 - 2z_{v}\\theta + z_{v}^2}{\\sigma_{v}^{2}} + \\frac{\\theta^2 - 2z_{p}\\theta + z_{p}^2}{\\sigma_{p}^{2}} \\right)$$\nThe term proportional to $\\theta^2$ is:\n$$-\\frac{1}{2}\\theta^2 \\left( \\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}} \\right)$$\nBy comparing this with the $\\theta^2$ coefficient in the general Gaussian log-PDF, $-\\frac{1}{2\\sigma_{post}^{2}}\\theta^2$, we identify the inverse of the posterior variance:\n$$\\frac{1}{\\sigma_{post}^{2}} = \\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}$$\nThis demonstrates that the precision (inverse variance) of the posterior is the sum of the precisions of the prior and the likelihoods. The posterior variance is therefore:\n$$\\sigma_{post}^{2} = \\left(\\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}\\right)^{-1}$$\n\nNext, we extract the term proportional to $\\theta$:\n$$\\frac{\\mu_{0}\\theta}{\\sigma_{0}^{2}} + \\frac{z_{v}\\theta}{\\sigma_{v}^{2}} + \\frac{z_{p}\\theta}{\\sigma_{p}^{2}} = \\theta \\left( \\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\frac{z_{v}}{\\sigma_{v}^{2}} + \\frac{z_{p}}{\\sigma_{p}^{2}} \\right)$$\nBy comparing this with the $\\theta$ coefficient in the general Gaussian log-PDF, $\\frac{\\mu_{post}}{\\sigma_{post}^{2}}\\theta$, we find:\n$$\\frac{\\mu_{post}}{\\sigma_{post}^{2}} = \\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\frac{z_{v}}{\\sigma_{v}^{2}} + \\frac{z_{p}}{\\sigma_{p}^{2}}$$\nSolving for the posterior mean, $\\mu_{post}$:\n$$\\mu_{post} = \\sigma_{post}^{2} \\left( \\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\frac{z_{v}}{\\sigma_{v}^{2}} + \\frac{z_{p}}{\\sigma_{p}^{2}} \\right)$$\nSubstituting the expression for $\\sigma_{post}^{2}$:\n$$\\mu_{post} = \\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\frac{z_{v}}{\\sigma_{v}^{2}} + \\frac{z_{p}}{\\sigma_{p}^{2}}}{\\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}}$$\nThe posterior mean is a weighted average of the prior mean and the sensory measurements, where each is weighted by its respective precision.\n\nThe posterior distribution $p(\\theta\\,|\\,z_{v}, z_{p})$ is a Gaussian with the derived mean $\\mu_{post}$ and variance $\\sigma_{post}^{2}$.\nThe final analytical expressions are:\nPosterior Mean:\n$$\\mu_{post} = \\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\frac{z_{v}}{\\sigma_{v}^{2}} + \\frac{z_{p}}{\\sigma_{p}^{2}}}{\\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}}$$\nPosterior Variance:\n$$\\sigma_{post}^{2} = \\left(\\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}\\right)^{-1}$$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\frac{\\mu_{0}}{\\sigma_{0}^{2}} + \\frac{z_{v}}{\\sigma_{v}^{2}} + \\frac{z_{p}}{\\sigma_{p}^{2}}}{\\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}} & \\left(\\frac{1}{\\sigma_{0}^{2}} + \\frac{1}{\\sigma_{v}^{2}} + \\frac{1}{\\sigma_{p}^{2}}\\right)^{-1} \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice integrates the concepts of biomechanics, sensory processing, and feedback control into a comprehensive computational model. You will simulate a classic experiment where a person's balance is challenged by incongruent sensory information—a tilting platform and a moving visual scene. By implementing a model that includes sensory weighting, delays, and feedback control, you will predict how the body sways in response to these complex stimuli . This exercise showcases how theoretical models can be used to generate testable hypotheses about sensory reweighting and the adaptive nature of the human balance system.",
            "id": "4211078",
            "problem": "Consider upright human stance modeled as a linearized inverted pendulum pivoting at the ankles, with the center of mass approximated at a height $h$ above the pivot. Let $m$ be the body mass, $I$ be the moment of inertia about the ankle, and $g$ be the gravitational acceleration. The dynamical equation for small sway angles $\\theta(t)$ is given by the linearization of Newton's second law for rotation, namely $I \\ddot{\\theta}(t) = m g h \\theta(t) + T_c(t)$, where $T_c(t)$ is the control torque generated by the Central Nervous System (CNS).\n\nAssume that the CNS implements a proportional-derivative torque control law based on an internal estimate of body-in-space angle $\\hat{\\theta}(t)$, such that $T_c(t) = -K_p \\hat{\\theta}(t) - K_d \\dot{\\hat{\\theta}}(t)$, where $K_p$ is the proportional gain and $K_d$ is the derivative gain. The estimate $\\hat{\\theta}(t)$ is formed by weighted sensory fusion of proprioceptive, vestibular, and visual channels, with a visual processing delay. Specifically, let the platform tilt be $\\phi(t)$ (support surface relative to gravitational vertical), and the visual scene tilt be $\\psi(t)$ (visual vertical relative to gravitational vertical). The estimate is defined by $\\hat{\\theta}(t) = w_{\\text{ves}} \\theta(t) + w_{\\text{prop}} (\\theta(t) - \\phi(t)) + w_{\\text{vis}} (\\theta(t - \\tau_v) - \\psi(t - \\tau_v))$, where $w_{\\text{ves}}$, $w_{\\text{prop}}$, and $w_{\\text{vis}}$ are nonnegative sensory weights that sum to $1$, and $\\tau_v$ is the visual delay. All angles are measured in radians.\n\nSuppose the platform and visual scene tilt are harmonic at angular frequency $\\omega$, with amplitudes $A_p$ and $A_v$ and a phase offset $\\delta_v$ for the visual scene relative to the platform:\n- $\\phi(t) = A_p \\sin(\\omega t)$,\n- $\\psi(t) = A_v \\sin(\\omega t + \\delta_v)$.\n\nAssume steady-state periodic response and adopt the Linear Time-Invariant (LTI) perspective so that the sway response $\\theta(t)$ can be represented by a complex phasor $\\Theta$ at frequency $\\omega$ given sinusoidal inputs $\\Phi$ and $\\Psi$. Your task is to compute the steady-state sway amplitude $A_\\theta$ and the steady-state phase shift of sway relative to platform tilt, $\\Delta\\varphi_\\theta$ (defined as the phase of $\\Theta$ minus the phase of $\\Phi$), both expressed in radians.\n\nStarting from the above physical law and definitions, derive the frequency-domain closed-loop relationship between $\\Theta$, $\\Phi$, and $\\Psi$ accounting for visual delay, and compute $A_\\theta$ and $\\Delta\\varphi_\\theta$ for each of the parameter sets in the test suite below. Treat all parameters as constants and assume $I = m h^2$. Use $\\omega = 2 \\pi f$ for frequency $f$ in hertz.\n\nYou must:\n- Use angles in radians, and express $A_\\theta$ and $\\Delta\\varphi_\\theta$ in radians.\n- Provide outputs rounded to six decimal places.\n- Produce results for all test cases in a single line, as a comma-separated list enclosed in square brackets, ordered as $[A_{\\theta,1}, \\Delta\\varphi_{\\theta,1}, A_{\\theta,2}, \\Delta\\varphi_{\\theta,2}, \\dots]$.\n\nUse the following parameter values, which are scientifically plausible for quiet stance control:\n\nGlobal physical constants (use these in all test cases):\n- $m = 75$ $\\mathrm{kg}$,\n- $h = 1.0$ $\\mathrm{m}$,\n- $I = m h^2$,\n- $g = 9.81$ $\\mathrm{m/s^2}$,\n- $K_p = 1200$ $\\mathrm{N \\cdot m/rad}$,\n- $K_d = 150$ $\\mathrm{N \\cdot m \\cdot s/rad}$,\n- $f = 0.5$ $\\mathrm{Hz}$,\n- $A_p = 2 \\times \\pi/180$ $\\mathrm{rad}$.\n\nTest suite (each case lists $(w_{\\text{ves}}, w_{\\text{prop}}, w_{\\text{vis}}, \\tau_v, A_v, \\delta_v)$):\n1. Baseline incongruent visual phase lead: $(0.3, 0.5, 0.2, 0.15, 2 \\times \\pi/180, \\pi/2)$.\n2. No visual weighting (boundary): $(0.5, 0.5, 0.0, 0.15, 2 \\times \\pi/180, \\pi/2)$.\n3. High visual weighting with short delay and opposite-phase visual scene: $(0.3, 0.2, 0.5, 0.05, 3 \\times \\pi/180, \\pi)$.\n4. Moderate visual weighting with long delay and negative phase offset: $(0.4, 0.3, 0.3, 0.30, 1 \\times \\pi/180, -\\pi/3)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$ but with the appropriate number of entries for all test cases). The entries must be floats rounded to six decimal places. No other text should be printed.",
            "solution": "The problem requires the calculation of the steady-state sway amplitude $A_\\theta$ and phase shift $\\Delta\\varphi_\\theta$ of a human subject modeled as an inverted pendulum. The solution involves deriving the closed-loop transfer function of the system in the frequency domain and evaluating it at the specified disturbance frequency.\n\nThe analysis begins with the equation of motion for the linearized inverted pendulum, representing the dynamics of the body's center of mass (COM) relative to the ankle pivot point.\nThe equation is given as:\n$$I \\ddot{\\theta}(t) = m g h \\theta(t) + T_c(t)$$\nwhere $\\theta(t)$ is the small sway angle from the vertical, $I$ is the moment of inertia about the ankle, $m$ is the body mass, $g$ is gravitational acceleration, $h$ is the height of the COM, and $T_c(t)$ is the corrective torque from the central nervous system (CNS). This equation can be rewritten as:\n$$I \\ddot{\\theta}(t) - m g h \\theta(t) = T_c(t)$$\nThe term $m g h \\theta(t)$ represents the destabilizing torque due to gravity on the displaced COM.\n\nThe CNS generates the control torque $T_c(t)$ based on a Proportional-Derivative (PD) control law acting on an internal estimate of the body angle, $\\hat{\\theta}(t)$:\n$$T_c(t) = -K_p \\hat{\\theta}(t) - K_d \\dot{\\hat{\\theta}}(t)$$\nwhere $K_p$ and $K_d$ are the proportional and derivative gains, respectively. The negative signs indicate that the control torque is restorative, acting to oppose the perceived sway.\n\nThe estimated angle $\\hat{\\theta}(t)$ is a weighted fusion of sensory inputs: vestibular (body orientation in space), proprioceptive (body orientation relative to the support surface), and visual (body orientation relative to the visual scene). The model for this sensory fusion is:\n$$\\hat{\\theta}(t) = w_{\\text{ves}} \\theta(t) + w_{\\text{prop}} (\\theta(t) - \\phi(t)) + w_{\\text{vis}} (\\theta(t - \\tau_v) - \\psi(t - \\tau_v))$$\nHere, $\\phi(t)$ is the tilt angle of the support platform, $\\psi(t)$ is the tilt angle of the visual scene, and $\\tau_v$ is the time delay associated with visual processing. The terms $w_{\\text{ves}}$, $w_{\\text{prop}}$, and $w_{\\text{vis}}$ are the respective sensory weights, which are non-negative and sum to $1$.\n\nTo analyze the steady-state response to sinusoidal inputs, we transform the system equations into the frequency domain. We adopt the Linear Time-Invariant (LTI) system perspective, where time-domain signals $x(t)$ are represented by complex phasors $X(j\\omega)$. The differentiation operator $d/dt$ corresponds to multiplication by $j\\omega$, and a time delay of $\\tau$ corresponds to multiplication by $e^{-j\\omega\\tau}$.\n\nApplying the frequency-domain transformation (with $s = j\\omega$) to the equation of motion gives:\n$$(s^2 I - mgh) \\Theta(s) = T_c(s)$$\nThe plant transfer function $P(s)$ from control torque $T_c$ to sway angle $\\Theta$ is therefore:\n$$P(s) = \\frac{\\Theta(s)}{T_c(s)} = \\frac{1}{s^2 I - mgh}$$\nThe control law in the frequency domain is:\n$$T_c(s) = -(K_p + s K_d) \\hat{\\Theta}(s) = -C(s) \\hat{\\Theta}(s)$$\nwhere $C(s) = K_p + sK_d$ is the controller transfer function.\n\nThe sensory fusion equation becomes:\n$$\\hat{\\Theta}(s) = w_{\\text{ves}} \\Theta(s) + w_{\\text{prop}} (\\Theta(s) - \\Phi(s)) + w_{\\text{vis}} (e^{-s\\tau_v}\\Theta(s) - e^{-s\\tau_v}\\Psi(s))$$\nGrouping terms, we can express $\\hat{\\Theta}(s)$ in terms of the body sway $\\Theta(s)$ and the external disturbances $\\Phi(s)$ and $\\Psi(s)$:\n$$\\hat{\\Theta}(s) = (w_{\\text{ves}} + w_{\\text{prop}} + w_{\\text{vis}}e^{-s\\tau_v})\\Theta(s) - w_{\\text{prop}}\\Phi(s) - w_{\\text{vis}}e^{-s\\tau_v}\\Psi(s)$$\nLet's define the feedback transfer functions:\n$H_\\theta(s) = w_{\\text{ves}} + w_{\\text{prop}} + w_{\\text{vis}}e^{-s\\tau_v}$\n$H_\\phi(s) = w_{\\text{prop}}$\n$H_\\psi(s) = w_{\\text{vis}}e^{-s\\tau_v}$\nSo, $\\hat{\\Theta}(s) = H_\\theta(s)\\Theta(s) - H_\\phi(s)\\Phi(s) - H_\\psi(s)\\Psi(s)$.\n\nThe system can be represented by a standard feedback control block diagram. The closed-loop equation is found by substituting the expressions for $T_c(s)$ and $\\hat{\\Theta}(s)$ into the plant equation:\n$$\\Theta(s) = P(s) T_c(s) = -P(s)C(s)\\hat{\\Theta}(s)$$\n$$\\Theta(s) = -P(s)C(s) [H_\\theta(s)\\Theta(s) - H_\\phi(s)\\Phi(s) - H_\\psi(s)\\Psi(s)]$$\nSolving for $\\Theta(s)$:\n$$\\Theta(s)(1 + P(s)C(s)H_\\theta(s)) = P(s)C(s)(H_\\phi(s)\\Phi(s) + H_\\psi(s)\\Psi(s))$$\n$$\\Theta(s) = \\frac{P(s)C(s)(H_\\phi(s)\\Phi(s) + H_\\psi(s)\\Psi(s))}{1 + P(s)C(s)H_\\theta(s)}$$\nSubstituting $P(s) = 1/(s^2 I - mgh)$ simplifies this to:\n$$\\Theta(s) = \\frac{C(s)(H_\\phi(s)\\Phi(s) + H_\\psi(s)\\Psi(s))}{(s^2 I - mgh) + C(s)H_\\theta(s)}$$\nThis is the final expression for the sway angle phasor $\\Theta$ in terms of the input phasors $\\Phi$ and $\\Psi$.\n\nThe input signals are given as:\n$\\phi(t) = A_p \\sin(\\omega t) = A_p \\cos(\\omega t - \\pi/2)$\n$\\psi(t) = A_v \\sin(\\omega t + \\delta_v) = A_v \\cos(\\omega t + \\delta_v - \\pi/2)$\nTheir corresponding phasors at angular frequency $\\omega$ are:\n$\\Phi = A_p e^{-j\\pi/2} = -jA_p$\n$\\Psi = A_v e^{j(\\delta_v - \\pi/2)}$\n\nFor each test case, we substitute the specified parameter values, with $s=j\\omega = j2\\pi f$, into the equation for $\\Theta(s)$. This yields a complex number $\\Theta_{val} = X + jY$.\nThe sway amplitude is the magnitude of this complex number:\n$$A_\\theta = |\\Theta_{val}| = \\sqrt{X^2 + Y^2}$$\nThe phase of the sway is $\\varphi_\\theta = \\text{atan2}(Y, X)$. The phase of the platform tilt is $\\varphi_\\phi = \\text{angle}(\\Phi) = \\text{angle}(-jA_p) = -\\pi/2$ radians.\nThe required phase shift of sway relative to platform tilt is:\n$$\\Delta\\varphi_\\theta = \\varphi_\\theta - \\varphi_\\phi = \\varphi_\\theta + \\pi/2$$\nThe resulting phase difference is normalized to the interval $(-\\pi, \\pi]$.\nThe problem specifies $I = m h^2$. All calculations will be performed using complex number arithmetic.",
            "answer": "[0.024929,1.725946,0.020131,1.802146,0.038573,-2.333100,0.016335,1.265747]"
        }
    ]
}