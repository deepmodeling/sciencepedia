{
    "hands_on_practices": [
        {
            "introduction": "要掌握心室-动脉耦合的精髓，第一步是学会如何确定其稳态工作点。这个工作点代表了在给定的心肌收缩性和动脉负载下，心脏泵血达到的平衡状态。本练习  将指导你建立并求解描述这种平衡的核心方程组，从而计算出关键的血流动力学变量，如每搏输出量和收缩末期压力。",
            "id": "4210222",
            "problem": "一项心血管生物力学研究在稳态条件下，使用收缩末期的时变弹性概念对人体左心室进行建模。在此框架下，收缩末期压力-容积关系(ESPVR)被近似为线性关系，其斜率称为收缩末期弹性$E_{es}$，容积轴截距为$V_0$，因此收缩末期压力$P_{es}$取决于收缩末期容积$ESV$相对于$V_0$的大小。动脉负荷由动脉弹性$E_a$概括，在稳态下定义为收缩末期压力与每搏输出量$SV$的比值。每搏输出量是一次心跳中射出的血量，是舒张末期容积$EDV$与收缩末期容积$ESV$之差。假设心室与动脉系统之间存在单次心跳的耦合平衡，请使用这些核心定义来推导耦合的收缩末期工作点并计算未知量。\n\n给定$E_{es} = 2.0\\,\\mathrm{mmHg}/\\mathrm{ml}$，$V_0 = 10\\,\\mathrm{ml}$，$EDV = 140\\,\\mathrm{ml}$，以及$E_a = 1.2\\,\\mathrm{mmHg}/\\mathrm{ml}$，请确定满足上述定义所隐含的心室-动脉耦合约束的收缩末期容积$ESV$、每搏输出量$SV$和收缩末期压力$P_{es}$。将$ESV$和$SV$以毫升($\\mathrm{ml}$)表示，$P_{es}$以毫米汞柱($\\mathrm{mmHg}$)表示。提供精确值，无需四舍五入。",
            "solution": "问题要求确定一个由时变弹性模型描述的耦合心室-动脉系统的稳态工作点。解决方案涉及求解一个由所给定义推导出的代数方程组。\n\n首先，我们必须将给定的定义形式化为数学方程。\n\n1.  收缩末期压力-容积关系(ESPVR)被表述为一个线性函数。收缩末期压力$P_{es}$由收缩末期弹性$E_{es}$以及收缩末期容积$ESV$与容积轴截距$V_0$之间的差值决定。该关系表示为：\n    $$P_{es} = E_{es} (ESV - V_0)$$\n\n2.  动脉负荷由动脉弹性$E_a$来表征，它被定义为收缩末期压力与每搏输出量$SV$的比值。\n    $$E_a = \\frac{P_{es}}{SV}$$\n    这可以被重新整理以动脉属性来表示$P_{es}$：\n    $$P_{es} = E_a \\cdot SV$$\n\n3.  每搏输出量$SV$被定义为在一次心动周期中射出的血液量，即舒张末期容积$EDV$与收缩末期容积$ESV$之差。\n    $$SV = EDV - ESV$$\n\n稳态下的心室-动脉耦合原理意味着由心室产生的收缩末期压力必须等于动脉系统所承受的收缩末期压力。因此，我们可以令$P_{es}$的两个表达式相等：\n$$E_{es} (ESV - V_0) = E_a \\cdot SV$$\n\n现在我们有一个包含三个未知数($P_{es}$, $ESV$, $SV$)的两个方程的方程组。但是，我们可以将第三个定义中$SV$的表达式代入我们的耦合方程，从而得到一个只含单个未知数$ESV$的方程。\n$$E_{es} (ESV - V_0) = E_a (EDV - ESV)$$\n\n下一步是求解这个关于$ESV$的线性方程。我们展开方程的两边：\n$$E_{es} \\cdot ESV - E_{es} \\cdot V_0 = E_a \\cdot EDV - E_a \\cdot ESV$$\n\n现在，我们将所有包含$ESV$的项移到方程的一边，所有其他项移到另一边：\n$$E_{es} \\cdot ESV + E_a \\cdot ESV = E_a \\cdot EDV + E_{es} \\cdot V_0$$\n\n在左边提取公因数$ESV$得到：\n$$ESV (E_{es} + E_a) = E_a \\cdot EDV + E_{es} \\cdot V_0$$\n\n最后，我们通过除以$(E_{es} + E_a)$项来分离出$ESV$：\n$$ESV = \\frac{E_a \\cdot EDV + E_{es} \\cdot V_0}{E_{es} + E_a}$$\n\n现在我们可以代入给定的数值：$E_{es} = 2.0\\,\\mathrm{mmHg}/\\mathrm{ml}$，$V_0 = 10\\,\\mathrm{ml}$，$EDV = 140\\,\\mathrm{ml}$，以及$E_a = 1.2\\,\\mathrm{mmHg}/\\mathrm{ml}$。\n$$ESV = \\frac{(1.2)(140) + (2.0)(10)}{2.0 + 1.2}$$\n$$ESV = \\frac{168 + 20}{3.2}$$\n$$ESV = \\frac{188}{3.2}$$\n$$ESV = 58.75\\,\\mathrm{ml}$$\n\n在确定了$ESV$的值之后，我们现在可以根据其定义计算每搏输出量$SV$：\n$$SV = EDV - ESV$$\n$$SV = 140 - 58.75$$\n$$SV = 81.25\\,\\mathrm{ml}$$\n\n最后，我们可以计算收缩末期压力$P_{es}$。我们可以使用$P_{es}$的两个表达式中的任意一个来验证我们的计算。使用动脉负荷的定义：\n$$P_{es} = E_a \\cdot SV$$\n$$P_{es} = 1.2 \\cdot 81.25$$\n$$P_{es} = 97.5\\,\\mathrm{mmHg}$$\n\n作为验证，我们可以使用心室ESPVR的定义来计算$P_{es}$：\n$$P_{es} = E_{es} (ESV - V_0)$$\n$$P_{es} = 2.0 (58.75 - 10)$$\n$$P_{es} = 2.0 (48.75)$$\n$$P_{es} = 97.5\\,\\mathrm{mmHg}$$\n两次计算得到的一致结果证实了我们推导出的$ESV$、$SV$和$P_{es}$值的准确性。",
            "answer": "$$\\boxed{\\begin{pmatrix} 58.75  81.25  97.5 \\end{pmatrix}}$$"
        },
        {
            "introduction": "建立模型不仅是为了描述静态，更是为了预测动态变化。Frank-Starling机制是心脏生理学的一个基石，它描述了心室在舒张末期被拉伸得越长（即前负荷越大），其后续的收缩就越有力的现象。通过本练习 ，你将应用心室-动脉耦合模型来量化这一过程，计算前负荷增加时每搏输出量的相应变化，从而加深对心脏自身调节能力的理解。",
            "id": "4210254",
            "problem": "一个左心室采用时变弹性框架进行建模。收缩末期压力-容积关系 (ESPVR) 假设为线性关系 $P_{es} = E_{es}\\,(V_{es} - V_{0})$，其中 $P_{es}$ 是收缩末期压力，$E_{es}$ 是收缩末期弹性，$V_{es}$ 是收缩末期容积，$V_{0}$ 是容积轴截距。有效动脉负荷由动脉弹性 (Ea) 表征，定义为 $E_{a} = P_{es}/SV$，其中 $SV$ 是每搏输出量。舒张末期压力-容积关系 (EDPVR) 是固定的指数形式，由 $P_{ed}(V) = \\alpha\\left(\\exp\\left(\\beta\\,(V - V_{0,ed})\\right) - 1\\right)$ 给出，其中 $P_{ed}$ 是舒张末期压力，$\\alpha$、$\\beta$ 和 $V_{0,ed}$ 是常数。\n\n考虑一个受试者，其参数在各次心跳中保持恒定：$E_{es} = 2.2\\,\\mathrm{mmHg/ml}$，$V_{0} = 10\\,\\mathrm{ml}$，$E_{a} = 1.6\\,\\mathrm{mmHg/ml}$，以及EDPVR参数 $\\alpha = 0.15\\,\\mathrm{mmHg}$，$\\beta = 0.03\\,\\mathrm{ml}^{-1}$，$V_{0,ed} = 0\\,\\mathrm{ml}$。由于静脉回流增加，舒张末期容积 (EDV) 从 $EDV_{1} = 120\\,\\mathrm{ml}$ 变为 $EDV_{2} = 140\\,\\mathrm{ml}$，而 $E_{es}$、$E_{a}$ 和 EDPVR 参数保持不变。\n\n从上述基本定义出发，不使用任何预先推导的简化公式，通过在收缩末期强制一致性，推导出一个用 $EDV$、$E_{es}$、$E_{a}$ 和 $V_{0}$ 表示 $SV$ 的表达式，并用它来计算每搏输出量的变化 $\\Delta SV = SV(EDV_{2}) - SV(EDV_{1})$。将最终答案四舍五入至四位有效数字。以 ml 为单位表示每搏输出量的变化。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、提法得当且客观。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 收缩末期压力-容积关系 (ESPVR): $P_{es} = E_{es}\\,(V_{es} - V_{0})$\n- 动脉弹性 ($E_a$): $E_{a} = P_{es}/SV$\n- 每搏输出量定义: $SV = EDV - V_{es}$，其中 $EDV$ 是舒张末期容积，$V_{es}$ 是收缩末期容积。\n- 舒张末期压力-容积关系 (EDPVR): 一个固定的指数函数 $P_{ed}(V) = \\alpha\\left(\\exp\\left(\\beta\\,(V - V_{0,ed})\\right) - 1\\right)$。\n- 恒定参数:\n    - $E_{es} = 2.2\\,\\mathrm{mmHg/ml}$\n    - $V_{0} = 10\\,\\mathrm{ml}$\n    - $E_{a} = 1.6\\,\\mathrm{mmHg/ml}$\n    - $\\alpha = 0.15\\,\\mathrm{mmHg}$\n    - $\\beta = 0.03\\,\\mathrm{ml}^{-1}$\n    - $V_{0,ed} = 0\\,\\mathrm{ml}$\n- 初始舒张末期容积: $EDV_{1} = 120\\,\\mathrm{ml}$\n- 最终舒张末期容积: $EDV_{2} = 140\\,\\mathrm{ml}$\n- 问题要求推导 $SV$ 的表达式并计算变化量 $\\Delta SV = SV(EDV_{2}) - SV(EDV_{1})$。\n\n**步骤2：已知条件的验证**\n该问题具有科学依据，采用了心室-动脉耦合的标准时变弹性模型，这是心血管生物力学中的一个基本概念。使用线性ESPVR和有效动脉弹性是已被广泛接受和使用的近似方法。所提供的弹性、容积和压力的数值在生理上是合理的。该问题提法得当，提供了足够的方程和数据来推导出唯一解。语言客观、精确。关于EDPVR的信息，虽然在所要求的计算中没有直接使用，但为确定舒张末期容积的舒张期充盈过程提供了背景，并且没有引入矛盾。因此，该问题是有效的。\n\n**推导与求解**\n\n目标是通过将心室模型与动脉负荷模型耦合，来找到每搏输出量 $SV$ 的表达式。这可以通过在心动周期的收缩末期点强制一致性来实现，在这一点上，心室的压力必须等于动脉系统中的压力。\n\n收缩末期压力 $P_{es}$ 可从两个角度来描述：\n1.  从心室特性出发，通过收缩末期压力-容积关系 (ESPVR)：\n    $$P_{es} = E_{es}\\,(V_{es} - V_{0})$$\n2.  从动脉负荷特性出发，通过有效动脉弹性的定义 $E_a$：\n    $$P_{es} = E_{a} \\cdot SV$$\n\n通过令这两个 $P_{es}$ 的表达式相等，我们将心室与其负荷联系起来：\n$$E_{a} \\cdot SV = E_{es}\\,(V_{es} - V_{0})$$\n\n该方程将 $SV$ 和 $V_{es}$ 联系起来。为了得到用初始充盈状态，即舒张末期容积 ($EDV$) 表示的 $SV$ 表达式，我们使用每搏输出量的基本定义：\n$$SV = EDV - V_{es}$$\n\n我们可以重新整理这个定义，用 $EDV$ 和 $SV$ 来表示 $V_{es}$：\n$$V_{es} = EDV - SV$$\n\n现在，我们将这个 $V_{es}$ 的表达式代入耦合压力方程：\n$$E_{a} \\cdot SV = E_{es}\\,((EDV - SV) - V_{0})$$\n\n现在的任务是解这个关于 $SV$ 的方程。我们展开方程的右侧：\n$$E_{a} \\cdot SV = E_{es} \\cdot EDV - E_{es} \\cdot SV - E_{es} \\cdot V_{0}$$\n\n接下来，我们将所有包含 $SV$ 的项移到方程的一边：\n$$E_{a} \\cdot SV + E_{es} \\cdot SV = E_{es} \\cdot EDV - E_{es} \\cdot V_{0}$$\n\n在方程左侧提取公因式 $SV$，在右侧提取公因式 $E_{es}$，得到：\n$$SV\\,(E_{a} + E_{es}) = E_{es}\\,(EDV - V_{0})$$\n\n最后，除以 $(E_{a} + E_{es})$ 项，我们得到每搏输出量作为 $EDV$、$E_{es}$、$E_a$ 和 $V_0$ 函数的推导表达式：\n$$SV(EDV) = \\frac{E_{es}}{E_{es} + E_{a}}(EDV - V_{0})$$\n\n问题要求计算当舒张末期容积从 $EDV_1$ 变为 $EDV_2$ 时，每搏输出量的变化 $\\Delta SV$。\n$$\\Delta SV = SV(EDV_{2}) - SV(EDV_{1})$$\n\n使用推导出的 $SV(EDV)$ 表达式：\n$$\\Delta SV = \\frac{E_{es}}{E_{es} + E_{a}}(EDV_{2} - V_{0}) - \\frac{E_{es}}{E_{es} + E_{a}}(EDV_{1} - V_{0})$$\n\n我们可以提取公因式 $\\frac{E_{es}}{E_{es} + E_{a}}$：\n$$\\Delta SV = \\frac{E_{es}}{E_{es} + E_{a}} \\left[ (EDV_{2} - V_{0}) - (EDV_{1} - V_{0}) \\right]$$\n$$\\Delta SV = \\frac{E_{es}}{E_{es} + E_{a}} (EDV_{2} - V_{0} - EDV_{1} + V_{0})$$\n$$\\Delta SV = \\frac{E_{es}}{E_{es} + E_{a}} (EDV_{2} - EDV_{1})$$\n\n现在，我们将所给的数值代入这个 $\\Delta SV$ 的表达式中。\n已知：\n- $E_{es} = 2.2\\,\\mathrm{mmHg/ml}$\n- $E_{a} = 1.6\\,\\mathrm{mmHg/ml}$\n- $EDV_{1} = 120\\,\\mathrm{ml}$\n- $EDV_{2} = 140\\,\\mathrm{ml}$\n\n舒张末期容积的变化量为 $\\Delta EDV = EDV_2 - EDV_1 = 140\\,\\mathrm{ml} - 120\\,\\mathrm{ml} = 20\\,\\mathrm{ml}$。\n\n将这些值代入 $\\Delta SV$ 的方程中：\n$$\\Delta SV = \\frac{2.2}{2.2 + 1.6} (140 - 120)$$\n$$\\Delta SV = \\frac{2.2}{3.8} (20)$$\n$$\\Delta SV \\approx 0.578947368... \\times 20$$\n$$\\Delta SV \\approx 11.578947... \\,\\mathrm{ml}$$\n\n问题要求将答案四舍五入到四位有效数字。\n$$\\Delta SV \\approx 11.58\\,\\mathrm{ml}$$\n这个结果证明了弗兰克-斯大林机制：在前负荷（舒张末期容积）增加的情况下，如果心室收缩力 ($E_{es}$) 和后负荷 ($E_a$) 保持不变，每搏输出量就会增加。",
            "answer": "$$\\boxed{11.58}$$"
        },
        {
            "introduction": "在理论计算中，我们通常假设模型参数（如 $E_{es}$ 和 $V_0$）是已知的。然而在实际研究中，这些参数必须通过实验数据来估计。本练习  将带你从理论走向实践，学习如何使用经典的最小二乘法，从一组瞬时前负荷减少实验中获得的压力-容积数据点来拟合心室收缩末期压力-容积关系，并估算关键的心肌收缩性参数及其不确定性。这是心血管生物力学研究中的一项核心技能。",
            "id": "4210225",
            "problem": "对于每个测试用例，给定三个通过瞬时前负荷降低获得的收缩末期压力-容积点。收缩末期压力-容积关系(ESPVR)被建模为收缩末期的一个线性弹性关系：收缩末期压力 $P_{es}$ 通过收缩末期弹性 $E_{es}$ 和容积轴截距 $V_0$ 与收缩末期容积 $V_{es}$ 相关联，其关系为 $P_{es}$ 与 $V_{es}$ 和 $V_0$ 之差成正比。任务是，在压力测量存在独立同分布高斯噪声的假设下，通过最小化观测压力与模型预测值之间的残差平方和来估计 $E_{es}$ 和 $V_0$。然后，报告在高斯噪声模型下，通过估计量协方差的线性近似所导出的参数不确定性。\n\n使用以下基本原理：\n- 弹性定义：收缩末期弹性 $E_{es}$ 是收缩末期压力-容积关系的斜率。\n- 收缩末期关系的线性近似：在收缩末期附近，压力随容积近似线性变化，斜率为 $E_{es}$，截距由 $V_0$ 决定。\n- 独立高斯噪声下的经典最小二乘估计：通过最小化残差平方和，为线性模型提供一个基于正规方程的估计量。在此模型下，线性参数估计的协方差与设计矩阵的正规矩阵的逆成比例，并由残差方差进行缩放。变换后参数的不确定性通过使用变换的雅可比矩阵进行一阶误差传播获得。\n\n实现一个程序，对每个测试用例执行以下操作：\n1. 通过最小化测量的 $P_{es}$ 与模型预测的 $P_{es}$ 之间的平方差之和，将与弹性模型一致的线性 ESPVR 参数拟合到给定的三对 $(V_{es}, P_{es})$ 数据。\n2. 使用自由度 $n - p$ 从拟合结果中计算残差方差，其中 $n$ 是数据点数量，$p$ 是拟合的线性参数数量。\n3. 计算拟合的线性参数的协方差矩阵，然后使用一阶误差传播来获得 $E_{es}$ 和 $V_0$ 的标准误差（方差的平方根）。\n4. 以 $\\mathrm{mmHg/mL}$ 为单位表示 $E_{es}$，以 $\\mathrm{mL}$ 为单位表示 $V_0$，并以其相应单位表示标准误差。所有输出均报告为四舍五入到三位小数的浮点数。\n\n角度单位不适用。所有物理量必须使用其给定单位进行处理。\n\n测试套件：\n- 用例1（常规，生理学典型分布）：容积 $[60, 50, 40]$ $\\mathrm{mL}$，压力 $[109.4, 87.9, 64.7]$ $\\mathrm{mmHg}$。\n- 用例2（边界，接近共线的窄容积范围）：容积 $[70, 68, 66]$ $\\mathrm{mL}$，压力 $[195.3, 188.5, 183.2]$ $\\mathrm{mmHg}$。\n- 用例3（边缘，较高的 $V_0$）：容积 $[50, 60, 70]$ $\\mathrm{mL}$，压力 $[53.4, 72.2, 90.4]$ $\\mathrm{mmHg}$。\n\n对于每个测试用例，程序必须输出列表 $[E_{es}, V_0, \\text{SE}(E_{es}), \\text{SE}(V_0)]$，其中 $\\text{SE}(\\cdot)$ 表示标准误差。您的程序应生成单行输出，其中包含结果，格式为一个逗号分隔的列表，并用方括号括起来，每个测试用例对应一个子列表（例如，`[[e_1,v_1,se_e1,se_v1],[e_2,v_2,se_e2,se_v2],[e_3,v_3,se_e3,se_v3]]`），其中所有条目都是四舍五入到三位小数的浮点数。",
            "solution": "用户提供的问题在科学上是合理的、良定的且客观的。它基于心脏生物力学和统计参数估计的既定原理。所有必需的数据和方法都已明确指定，问题没有矛盾或含糊之处。因此，该问题被视为有效，并将提供解决方案。\n\n### 基于原理的解决方案\n\n该问题要求从一组测量的收缩末期压力和容积点来估计收缩末期压力-容积关系(ESPVR)的参数，即收缩末期弹性 $E_{es}$ 和容积轴截距 $V_0$。ESPVR的标准线性模型由下式给出：\n$$\nP_{es} = E_{es}(V_{es} - V_0)\n$$\n其中 $P_{es}$ 是收缩末期压力，$V_{es}$ 是收缩末期容积。\n\n为了便于进行线性回归分析，该方程被重新整理成直线形式 $y = m x + c$：\n$$\nP_{es} = E_{es}V_{es} - E_{es}V_0\n$$\n我们可以定义一个带有参数 $\\beta_1$（斜率）和 $\\beta_0$（截距）的线性模型如下：\n$$\nP_{es} = \\beta_1 V_{es} + \\beta_0\n$$\n通过比较这两种形式，我们可以将线性回归参数与生理学参数关联起来：\n$$\n\\beta_1 = E_{es} \\quad \\text{和} \\quad \\beta_0 = -E_{es}V_0\n$$\n根据这些关系，我们可以从估计的回归系数 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$ 中推导出我们目标参数的估计值：\n$$\n\\hat{E}_{es} = \\hat{\\beta}_1\n$$\n$$\n\\hat{V}_0 = -\\frac{\\hat{\\beta}_0}{\\hat{\\beta}_1}\n$$\n\n$\\beta_0$ 和 $\\beta_1$ 的估计是使用普通最小二乘法(OLS)进行的。对于一组 $n$ 个数据点 $(V_{es,i}, P_{es,i})$，我们可以建立一个矩阵方程：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n$$\n其中 $\\mathbf{y}$ 是观测压力向量，$\\mathbf{X}$ 是设计矩阵，$\\boldsymbol{\\beta}$ 是参数向量，$\\boldsymbol{\\epsilon}$ 是随机误差向量。\n$$\n\\mathbf{y} = \\begin{pmatrix} P_{es,1} \\\\ \\vdots \\\\ P_{es,n} \\end{pmatrix}, \\quad\n\\mathbf{X} = \\begin{pmatrix} 1  V_{es,1} \\\\ \\vdots  \\vdots \\\\ 1  V_{es,n} \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}\n$$\n最小化残差平方和的 $\\boldsymbol{\\beta}$ 的OLS估计量由正规方程给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}\n$$\n\n为了评估我们估计值的不确定性，我们首先计算误差方差 $\\sigma^2$ 的无偏估计量，即残差方差 $\\hat{\\sigma}^2$：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n-p} \\sum_{i=1}^{n} (P_{es,i} - \\hat{P}_{es,i})^2 = \\frac{SSR}{n-p}\n$$\n其中 $\\hat{P}_{es,i} = \\hat{\\beta}_0 + \\hat{\\beta}_1 V_{es,i}$ 是拟合的压力值，$SSR$ 是残差平方和，$n=3$ 是数据点数量，$p=2$ 是估计的线性参数（$\\beta_0, \\beta_1$）数量。\n\n估计的线性参数 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵由下式给出：\n$$\n\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\hat{\\sigma}^2 (\\mathbf{X}^T\\mathbf{X})^{-1} = \\begin{pmatrix} \\text{Var}(\\hat{\\beta}_0)  \\text{Cov}(\\hat{\\beta}_0, \\hat{\\beta}_1) \\\\ \\text{Cov}(\\hat{\\beta}_0, \\hat{\\beta}_1)  \\text{Var}(\\hat{\\beta}_1) \\end{pmatrix}\n$$\n\n然后确定我们感兴趣的参数（$E_{es}, V_0$）的不确定性，即标准误差(SE)。\n$E_{es}$ 的估计值就是 $\\hat{\\beta}_1$，因此它的方差和标准误差可以直接从协方差矩阵中获得：\n$$\n\\text{Var}(\\hat{E}_{es}) = \\text{Var}(\\hat{\\beta}_1)\n$$\n$$\n\\text{SE}(\\hat{E}_{es}) = \\sqrt{\\text{Var}(\\hat{\\beta}_1)}\n$$\n$V_0$ 的估计值是 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$ 的一个非线性函数。我们使用一阶泰勒展开（delta方法）进行误差传播来近似其方差。函数 $f(\\hat{\\boldsymbol{\\beta}})$ 的方差可以近似为 $\\text{Var}(f) \\approx \\mathbf{J} \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) \\mathbf{J}^T$，其中 $\\mathbf{J}$ 是变换的雅可比矩阵。对于 $V_0 = f(\\beta_0, \\beta_1) = -\\beta_0/\\beta_1$，其偏导数为：\n$$\n\\frac{\\partial V_0}{\\partial \\beta_0} = -\\frac{1}{\\beta_1} \\quad \\text{和} \\quad \\frac{\\partial V_0}{\\partial \\beta_1} = \\frac{\\beta_0}{\\beta_1^2}\n$$\n于是 $\\hat{V}_0$ 的方差可近似为：\n$$\n\\text{Var}(\\hat{V}_0) \\approx \\left(-\\frac{1}{\\hat{\\beta}_1}\\right)^2 \\text{Var}(\\hat{\\beta}_0) + \\left(\\frac{\\hat{\\beta}_0}{\\hat{\\beta}_1^2}\\right)^2 \\text{Var}(\\hat{\\beta}_1) + 2\\left(-\\frac{1}{\\hat{\\beta}_1}\\right)\\left(\\frac{\\hat{\\beta}_0}{\\hat{\\beta}_1^2}\\right)\\text{Cov}(\\hat{\\beta}_0, \\hat{\\beta}_1)\n$$\n$\\hat{V}_0$ 的标准误差是该方差的平方根：\n$$\n\\text{SE}(\\hat{V}_0) = \\sqrt{\\text{Var}(\\hat{V}_0)}\n$$\n\n对于每个测试用例，算法按以下步骤进行：\n1.  根据给定的容积和压力，构建设计矩阵 $\\mathbf{X}$ 和观测向量 $\\mathbf{y}$。\n2.  使用 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}$ 计算OLS估计值 $\\hat{\\boldsymbol{\\beta}} = (\\hat{\\beta}_0, \\hat{\\beta}_1)^T$。\n3.  计算生理学参数的估计值：$\\hat{E}_{es} = \\hat{\\beta}_1$ 和 $\\hat{V}_0 = -\\hat{\\beta}_0/\\hat{\\beta}_1$。\n4.  计算预测压力 $\\hat{\\mathbf{y}} = \\mathbf{X}\\hat{\\boldsymbol{\\beta}}$ 和残差平方和 $SSR = ||\\mathbf{y} - \\hat{\\mathbf{y}}||_2^2$。\n5.  计算残差方差 $\\hat{\\sigma}^2 = SSR / (3-2)$。\n6.  计算 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵：$\\mathbf{C}_{\\beta} = \\hat{\\sigma}^2(\\mathbf{X}^T\\mathbf{X})^{-1}$。\n7.  从 $\\mathbf{C}_{\\beta}$ 中提取 $\\text{Var}(\\hat{\\beta}_1)$ 并计算 $\\text{SE}(\\hat{E}_{es}) = \\sqrt{\\text{Var}(\\hat{\\beta}_1)}$。\n8.  使用 $\\mathbf{C}_{\\beta}$ 的元素和估计值 $\\hat{\\beta}_0, \\hat{\\beta}_1$ 通过误差传播公式计算 $\\text{Var}(\\hat{V}_0)$。\n9.  计算 $\\text{SE}(\\hat{V}_0) = \\sqrt{\\text{Var}(\\hat{V}_0)}$。\n10. 报告四个值 $\\hat{E}_{es}, \\hat{V}_0, \\text{SE}(\\hat{E}_{es}), \\text{SE}(\\hat{V}_0)$，四舍五入到三位小数。\n\n此过程将使用`numpy`库在Python中实现，以进行数值和矩阵运算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for ESPVR parameters and their uncertainties for multiple test cases.\n    \"\"\"\n    test_cases = [\n        {'volumes': [60, 50, 40], 'pressures': [109.4, 87.9, 64.7]},\n        {'volumes': [70, 68, 66], 'pressures': [195.3, 188.5, 183.2]},\n        {'volumes': [50, 60, 70], 'pressures': [53.4, 72.2, 90.4]},\n    ]\n\n    results = []\n    for case in test_cases:\n        V_es = np.array(case['volumes'])\n        P_es = np.array(case['pressures'])\n\n        n = len(V_es)  # Number of data points\n        p = 2          # Number of linear model parameters (intercept, slope)\n\n        # 1. Setup linear regression model y = X*beta\n        # Model: Pes = beta1 * Ves + beta0\n        X = np.vstack([np.ones(n), V_es]).T\n        y = P_es\n\n        # 2. Solve for beta using Ordinary Least Squares (OLS)\n        # beta_hat = (X.T @ X)^-1 @ X.T @ y\n        XTX = X.T @ X\n        XTX_inv = np.linalg.inv(XTX)\n        XTy = X.T @ y\n        beta_hat = XTX_inv @ XTy\n\n        beta0_hat = beta_hat[0]  # Intercept\n        beta1_hat = beta_hat[1]  # Slope\n\n        # 3. Calculate physiological parameters from regression parameters\n        # E_es = beta1\n        # V0 = -beta0 / beta1\n        E_es_hat = beta1_hat\n        V0_hat = -beta0_hat / beta1_hat\n\n        # 4. Calculate residual variance\n        P_es_pred = X @ beta_hat\n        residuals = P_es - P_es_pred\n        SSR = np.sum(residuals**2)  # Sum of Squared Residuals\n        dof = n - p  # Degrees of freedom\n        sigma2_hat = SSR / dof\n\n        # 5. Compute covariance matrix of beta_hat\n        # Cov(beta_hat) = sigma^2 * (X.T @ X)^-1\n        Cov_beta_hat = sigma2_hat * XTX_inv\n        \n        var_beta0 = Cov_beta_hat[0, 0]\n        var_beta1 = Cov_beta_hat[1, 1]\n        cov_beta0_beta1 = Cov_beta_hat[0, 1]\n\n        # 6. Propagate error to find standard errors of E_es and V0\n        \n        # SE for E_es (since E_es = beta1)\n        var_E_es = var_beta1\n        se_E_es = np.sqrt(var_E_es)\n\n        # SE for V0 (using first-order Taylor expansion / delta method)\n        # V0 = -beta0 / beta1\n        # Var(V0) ~ (dV0/dbeta0)^2*Var(beta0) + (dV0/dbeta1)^2*Var(beta1) + 2*(...)*Cov(beta0,beta1)\n        # dV0/dbeta0 = -1 / beta1\n        # dV0/dbeta1 = beta0 / beta1^2\n        \n        # Vector g represents the gradient of V0 with respect to beta\n        g = np.array([-1 / beta1_hat, beta0_hat / (beta1_hat**2)])\n        \n        # Var(V0) approx g.T @ Cov(beta_hat) @ g\n        var_V0 = g.T @ Cov_beta_hat @ g\n        se_V0 = np.sqrt(var_V0)\n\n        # 7. Collect results, rounded to three decimal places\n        case_result = [\n            round(E_es_hat, 3),\n            round(V0_hat, 3),\n            round(se_E_es, 3),\n            round(se_V0, 3)\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}