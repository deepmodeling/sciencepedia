{
    "hands_on_practices": [
        {
            "introduction": "In biomechanics, justifying our modeling assumptions is as important as the model itself. While air is inherently a compressible fluid, this practice guides you through a scaling analysis based on the Mach number, $Ma$, to determine if compressibility effects are significant in the trachea during normal breathing. This exercise  is crucial for validating the widely used incompressible flow assumption in respiratory mechanics.",
            "id": "4152679",
            "problem": "A steady inhalation through the human trachea during quiet-to-moderate breathing can be modeled as flow of air in a rigid, axisymmetric duct of approximately uniform cross-section. Let the characteristic peak centerline speed in the trachea be $U = 6\\,\\mathrm{m/s}$ and the local speed of sound in air under body conditions be $c = 350\\,\\mathrm{m/s}$. Consider air as a compressible Newtonian fluid with small thermodynamic departures about a reference state and neglect gravitational effects.\n\na) By definition, the Mach number $\\mathrm{Ma}$ is the ratio of a characteristic flow speed to the local speed of sound. Compute $\\mathrm{Ma}$ using the given $U$ and $c$.\n\nb) Starting from the compressible continuity equation and the momentum balance, together with the thermodynamic definition of the speed of sound $c^{2} = \\left(\\partial p / \\partial \\rho\\right)_{s}$ for adiabatic perturbations, derive the leading-order scaling that relates the fractional density variation $\\left|\\Delta \\rho\\right|/\\rho$ to $\\mathrm{Ma}$. You may assume that characteristic pressure variations in the core of the tracheal flow are set by inertial effects associated with acceleration and deceleration over a characteristic length, and that the flow is quasi-steadily driven so that temporal variations are slow compared to acoustic propagation on the duct scale.\n\nc) Using your result from part (b) and the computed $\\mathrm{Ma}$, estimate the numerical value of $\\left|\\Delta \\rho\\right|/\\rho$. Interpret, in a sentence, the physical implication of this magnitude for compressibility effects during normal breathing.\n\nReport, as your final answer, the pair consisting of the Mach number and the fractional density change magnitude, $\\left(\\mathrm{Ma},\\,\\left|\\Delta \\rho\\right|/\\rho\\right)$, rounded to $4$ significant figures. Both quantities are dimensionless. Do not include units in your final reported values.",
            "solution": "The problem is valid and can be solved by applying fundamental principles of fluid dynamics. The solution is presented in three parts as requested.\n\na) We are asked to compute the Mach number, $\\mathrm{Ma}$. By definition, the Mach number is the ratio of a characteristic flow speed, $U$, to the local speed of sound, $c$. The problem provides the following values:\nCharacteristic peak centerline speed: $U = 6\\,\\mathrm{m/s}$\nLocal speed of sound: $c = 350\\,\\mathrm{m/s}$\n\nUsing the definition provided:\n$$\n\\mathrm{Ma} = \\frac{U}{c}\n$$\nSubstituting the given numerical values:\n$$\n\\mathrm{Ma} = \\frac{6}{350} \\approx 0.0171428...\n$$\nThis is a dimensionless quantity.\n\nb) We are tasked with deriving the leading-order scaling that relates the fractional density variation, $\\frac{|\\Delta \\rho|}{\\rho}$, to the Mach number, $\\mathrm{Ma}$. We start from the fundamental equations for a compressible fluid, neglecting viscosity and gravity as appropriate for the core flow.\n\nThe momentum equation for an inviscid, compressible fluid (the Euler equation) is:\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} \\right) = - \\nabla p\n$$\nwhere $\\rho$ is the fluid density, $\\mathbf{u}$ is the velocity vector, and $p$ is the pressure.\n\nThe problem states that the flow is quasi-steady and that pressure variations are set by inertial effects associated with acceleration and deceleration. This allows us to focus on the steady-state form of the convective-inertial term and the pressure gradient. Let $L$ be a characteristic length scale over which the flow speed changes significantly. We can perform a scaling analysis on the steady-state Euler equation, $(\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = -\\frac{1}{\\rho} \\nabla p$.\n\nThe left-hand side, the inertial term, scales as:\n$$\n|(\\mathbf{u} \\cdot \\nabla) \\mathbf{u}| \\sim \\frac{U^2}{L}\n$$\nwhere $U$ is the characteristic flow speed.\n\nThe right-hand side, the pressure gradient term, scales as:\n$$\n\\left|-\\frac{1}{\\rho} \\nabla p\\right| \\sim \\frac{1}{\\rho_{0}} \\frac{|\\Delta p|}{L}\n$$\nwhere $|\\Delta p|$ is the characteristic pressure variation and $\\rho_0$ is the reference density.\n\nEquating the scales of these two terms, as they must balance in the momentum equation:\n$$\n\\frac{U^2}{L} \\sim \\frac{|\\Delta p|}{\\rho_0 L}\n$$\nThis leads to the scaling for the characteristic pressure variation driven by inertia:\n$$\n|\\Delta p| \\sim \\rho_0 U^2\n$$\n\nNext, we relate this pressure variation to the density variation. The problem provides the thermodynamic definition of the speed of sound squared for an isentropic process: $c^2 = (\\partial p / \\partial \\rho)_s$. For small perturbations, we can approximate the partial derivative as a ratio of the characteristic variations:\n$$\nc^2 \\approx \\frac{|\\Delta p|}{|\\Delta \\rho|}\n$$\nThis allows us to express the characteristic density variation in terms of the pressure variation:\n$$\n|\\Delta \\rho| \\sim \\frac{|\\Delta p|}{c^2}\n$$\n\nNow, we combine the two scaling relationships. We substitute the expression for $|\\Delta p|$ from the momentum balance into the expression for $|\\Delta \\rho|$:\n$$\n|\\Delta \\rho| \\sim \\frac{\\rho_0 U^2}{c^2}\n$$\n\nTo find the fractional density variation, we divide by the reference density $\\rho_0$ (which can be represented by $\\rho$ in the problem's notation):\n$$\n\\frac{|\\Delta \\rho|}{\\rho_0} \\sim \\frac{\\rho_0 U^2}{\\rho_0 c^2} = \\frac{U^2}{c^2}\n$$\nBy definition, $\\mathrm{Ma} = U/c$, so $\\mathrm{Ma}^2 = U^2/c^2$. Therefore, the leading-order scaling is:\n$$\n\\frac{|\\Delta \\rho|}{\\rho} \\sim \\mathrm{Ma}^2\n$$\n\nc) We are asked to estimate the numerical value of the fractional density variation and interpret its physical meaning.\nUsing the scaling derived in part (b) and the Mach number calculated in part (a):\n$$\n\\frac{|\\Delta \\rho|}{\\rho} \\approx \\mathrm{Ma}^2 = \\left(\\frac{6}{350}\\right)^2 = \\frac{36}{122500} \\approx 0.000293877...\n$$\nRounding the results for both $\\mathrm{Ma}$ and $\\frac{|\\Delta \\rho|}{\\rho}$ to $4$ significant figures as requested for the final answer:\n$\\mathrm{Ma} \\approx 0.01714$\n$\\frac{|\\Delta \\rho|}{\\rho} \\approx 0.0002939$\n\nPhysical interpretation: The fractional density variation is on the order of $0.03\\%$, which is exceedingly small. This result implies that the density of air remains virtually constant during quiet-to-moderate breathing, making the incompressibility assumption ($\\rho = \\text{constant}$) an excellent and fully justified simplification for modeling such flows.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01714 & 0.0002939 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The mechanics of obstructive lung diseases like asthma are rooted in the physics of fluid flow through narrow tubes. This exercise explores the foundational Hagen-Poiseuille law, which governs laminar flow resistance. By deriving the sensitivity of resistance to airway radius, you will quantify the dramatic impact that even small constrictions have on the work of breathing , providing a clear physical basis for pathological symptoms.",
            "id": "4152629",
            "problem": "Consider a single conducting airway idealized as a straight, rigid, circular cylindrical tube of length $L$ and radius $r$, conveying an incompressible Newtonian fluid (air) under steady, axisymmetric, fully developed laminar flow with no-slip boundary conditions and negligible entrance/exit effects. The hydraulic resistance $R$ is defined by $R = \\Delta P/Q$, where $\\Delta P$ is the pressure drop across the segment and $Q$ is the volumetric flow rate. Under these conditions, use a valid fundamental base to derive the first-order sensitivity of $R$ to small fractional changes in the radius $r$, expressed in differential form as a relationship between $dR/R$ and $dr/r$. Then, for a uniform $10\\%$ reduction in radius (i.e., $r \\to 0.9\\,r$) with $L$ and dynamic viscosity $\\mu$ held fixed, compute the exact fractional increase in $R$, defined as $(R_{\\text{new}} - R_{\\text{old}})/R_{\\text{old}}$, and report it as a dimensionless decimal fraction. Round your final numerical value to four significant figures. Express the final answer as a dimensionless number (no units).",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, complete, and consistent. It describes a classic problem in fluid dynamics—Hagen-Poiseuille flow—and asks for a standard sensitivity analysis and a calculation based on the derived principles. Therefore, the problem is valid, and a solution is warranted.\n\nThe fundamental relationship governing steady, fully developed laminar flow of an incompressible Newtonian fluid through a straight circular tube is the Hagen-Poiseuille equation. This equation gives the volumetric flow rate $Q$ as a function of the pressure drop $\\Delta P$ over a length $L$, the radius of the tube $r$, and the dynamic viscosity of the fluid $\\mu$:\n$$\nQ = \\frac{\\pi r^4}{8 \\mu L} \\Delta P\n$$\nThe hydraulic resistance $R$ is defined as the ratio of the pressure drop to the volumetric flow rate:\n$$\nR = \\frac{\\Delta P}{Q}\n$$\nSubstituting the expression for $Q$ from the Hagen-Poiseuille equation into the definition of $R$, we can express the resistance in terms of the geometric and fluid properties:\n$$\nR = \\frac{\\Delta P}{\\frac{\\pi r^4}{8 \\mu L} \\Delta P} = \\frac{8 \\mu L}{\\pi r^4}\n$$\nThis expression for $R$ forms the basis for both parts of the problem.\n\nFirst, we derive the first-order sensitivity of $R$ to small fractional changes in the radius $r$. We are looking for a relationship between the relative differential change in resistance, $dR/R$, and the relative differential change in radius, $dr/r$. The most direct method is logarithmic differentiation. Taking the natural logarithm of the expression for $R$:\n$$\n\\ln(R) = \\ln\\left(\\frac{8 \\mu L}{\\pi r^4}\\right)\n$$\nUsing the properties of logarithms, this can be expanded as:\n$$\n\\ln(R) = \\ln(8) + \\ln(\\mu) + \\ln(L) - \\ln(\\pi) - \\ln(r^4)\n$$\n$$\n\\ln(R) = \\ln\\left(\\frac{8 \\mu L}{\\pi}\\right) - 4 \\ln(r)\n$$\nNow, we take the total differential of this equation. Since $L$ and $\\mu$ are held constant, the term $\\ln(8 \\mu L / \\pi)$ is a constant, and its differential is zero.\n$$\nd(\\ln(R)) = d\\left(\\ln\\left(\\frac{8 \\mu L}{\\pi}\\right)\\right) - d(4 \\ln(r))\n$$\n$$\n\\frac{dR}{R} = 0 - 4 \\frac{dr}{r}\n$$\nThis gives the required first-order sensitivity relationship:\n$$\n\\frac{dR}{R} = -4 \\frac{dr}{r}\n$$\nThis result indicates that a small fractional increase in radius leads to a four-fold fractional decrease in hydraulic resistance, a consequence of the $r^4$ dependence.\n\nSecond, we compute the exact fractional increase in $R$ for a uniform $10\\%$ reduction in radius. Let the original radius be $r_{\\text{old}}$ and the original resistance be $R_{\\text{old}}$. The new radius, $r_{\\text{new}}$, is $10\\%$ less than the original:\n$$\nr_{\\text{new}} = r_{\\text{old}} - 0.10 r_{\\text{old}} = 0.9 r_{\\text{old}}\n$$\nThe original resistance is given by:\n$$\nR_{\\text{old}} = \\frac{8 \\mu L}{\\pi r_{\\text{old}}^4}\n$$\nThe new resistance, $R_{\\text{new}}$, corresponding to the new radius $r_{\\text{new}}$ is:\n$$\nR_{\\text{new}} = \\frac{8 \\mu L}{\\pi r_{\\text{new}}^4} = \\frac{8 \\mu L}{\\pi (0.9 r_{\\text{old}})^4}\n$$\nThe fractional increase in $R$ is defined as $\\frac{R_{\\text{new}} - R_{\\text{old}}}{R_{\\text{old}}}$. We can compute this by first finding the ratio $\\frac{R_{\\text{new}}}{R_{\\text{old}}}$:\n$$\n\\frac{R_{\\text{new}}}{R_{\\text{old}}} = \\frac{\\frac{8 \\mu L}{\\pi (0.9 r_{\\text{old}})^4}}{\\frac{8 \\mu L}{\\pi r_{\\text{old}}^4}} = \\frac{r_{\\text{old}}^4}{(0.9 r_{\\text{old}})^4} = \\frac{1}{(0.9)^4}\n$$\nNow, we calculate the value of $(0.9)^4$:\n$$\n(0.9)^4 = 0.81^2 = 0.6561\n$$\nSo, the ratio of resistances is:\n$$\n\\frac{R_{\\text{new}}}{R_{\\text{old}}} = \\frac{1}{0.6561}\n$$\nThe fractional increase is then:\n$$\n\\frac{R_{\\text{new}} - R_{\\text{old}}}{R_{\\text{old}}} = \\frac{R_{\\text{new}}}{R_{\\text{old}}} - 1 = \\frac{1}{0.6561} - 1\n$$\nPerforming the calculation:\n$$\n\\frac{1}{0.6561} - 1 \\approx 1.5241579027... - 1 = 0.5241579027...\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n0.5242\n$$\nThus, a $10\\%$ reduction in the airway radius results in approximately a $52.42\\%$ increase in hydraulic resistance, highlighting the critical impact of airway caliber on the work of breathing.",
            "answer": "$$\n\\boxed{0.5242}\n$$"
        },
        {
            "introduction": "The lung's function depends on the collective behavior of millions of airways working in parallel. This computational practice bridges the gap from single-airway physics to system-level function by modeling a simplified airway tree as a resistive network. By implementing a solution , you will investigate how a localized change—a single constricted branch—can cause a non-local redistribution of airflow, a phenomenon central to ventilation heterogeneity in disease.",
            "id": "4152642",
            "problem": "You are tasked with modeling airflow through conducting airways as a resistive network under steady, laminar, incompressible conditions to evaluate how alveolar ventilation distribution changes when a single branch undergoes localized constriction. The conducting airway network is represented as a directed binary tree, with the mouth at the root and alveoli at the leaves. Airflow is driven by a fixed pressure at the mouth relative to an alveolar pressure taken as zero. The goal is to compute the sensitivity of the alveolar fractional ventilation distribution to a $30\\%$ reduction in the radius of one specified branch, by solving the network flow equations before and after the constriction.\n\nFundamental base:\n- Conservation of mass: at each internal node, the sum of inflows equals the sum of outflows.\n- Newton’s laws applied to viscous flow in cylinders in the low Reynolds number (Re) regime yield the Hagen–Poiseuille relation governing volumetric flow through a cylindrical airway segment, modeled as a fluid resistor. For a branch with radius $r$, length $L$, dynamic viscosity $\\mu$, upstream pressure $p_u$, and downstream pressure $p_v$, the volumetric flow is\n$$\nQ = \\frac{p_u - p_v}{R}, \\quad R = \\frac{8 \\mu L}{\\pi r^4}.\n$$\nThese relations are used to construct a linear system for node pressures in the resistive network.\n\nNetwork representation:\n- Nodes are indexed by integers. Node $0$ is the mouth (source) with fixed pressure $p_{\\mathrm{in}}$. Nodes $7$ through $14$ are alveolar sinks with fixed pressure $p_{\\mathrm{alv}} = 0$ $\\mathrm{Pa}$. All other nodes are internal with unknown pressures.\n- Edges (airway segments) are directed from parent to child. Each edge $e$ is represented by $(u_e, v_e, L_e, r_e)$ where $u_e$ is the upstream node index, $v_e$ is the downstream node index, $L_e$ is the length in $\\mathrm{m}$, and $r_e$ is the radius in $\\mathrm{m}$. The network contains $14$ edges and $15$ nodes with the following structure:\n1. Generation $1$: edges $e_0: (0 \\rightarrow 1)$, $e_1: (0 \\rightarrow 2)$, each with $L = 0.06$ $\\mathrm{m}$ and $r = 0.006$ $\\mathrm{m}$.\n2. Generation $2$: edges $e_2: (1 \\rightarrow 3)$, $e_3: (1 \\rightarrow 4)$, $e_4: (2 \\rightarrow 5)$, $e_5: (2 \\rightarrow 6)$, each with $L = 0.03$ $\\mathrm{m}$ and $r = 0.0035$ $\\mathrm{m}$.\n3. Generation $3$: edges $e_6: (3 \\rightarrow 7)$, $e_7: (3 \\rightarrow 8)$, $e_8: (4 \\rightarrow 9)$, $e_9: (4 \\rightarrow 10)$, $e_{10}: (5 \\rightarrow 11)$, $e_{11}: (5 \\rightarrow 12)$, $e_{12}: (6 \\rightarrow 13)$, $e_{13}: (6 \\rightarrow 14)$, each with $L = 0.02$ $\\mathrm{m}$ and $r = 0.0020$ $\\mathrm{m}$.\n- Air viscosity is $\\mu = 1.9 \\times 10^{-5}$ $\\mathrm{Pa \\cdot s}$.\n\nMathematical formulation:\n- Let $E$ be the number of edges and $N$ be the number of nodes. Define an edge-node incidence matrix $B \\in \\mathbb{R}^{E \\times N}$ with rows indexed by edges and columns by nodes, with entries $B_{e,u_e} = +1$, $B_{e,v_e} = -1$, and $0$ otherwise. Let $K \\in \\mathbb{R}^{E \\times E}$ be diagonal with $K_{e,e} = 1/R_e$.\n- Edge flows satisfy\n$$\nQ = K \\, B \\, p,\n$$\nwhere $p \\in \\mathbb{R}^{N}$ is the vector of node pressures.\n- Mass conservation at internal (unknown-pressure) nodes leads to\n$$\nB^\\top Q = 0 \\quad \\Rightarrow \\quad B^\\top K B \\, p = 0.\n$$\nPartition the nodes into unknown set $U$ and known set $K$ (with prescribed pressures), and write the reduced linear system\n$$\nL_{UU} \\, p_U = - L_{UK} \\, p_K,\n$$\nwith $L = B^\\top K B$ being the weighted graph Laplacian. Solve for $p_U$, then compute edge flows $Q$, and terminal flows $q_i$ into each alveolar leaf $i \\in \\{7,\\dots,14\\}$.\n\nAlveolar ventilation distribution:\n- The total inlet flow is $Q_{\\mathrm{tot}} = \\sum_{e \\in \\{e_0,e_1\\}} Q_e$ in $\\mathrm{m^3/s}$. The alveolar flow into leaf $i$ is the magnitude of the single edge flow entering node $i$, denoted $q_i$ in $\\mathrm{m^3/s}$. The alveolar fractional ventilation is\n$$\nf_i = \\frac{q_i}{\\sum_{j=7}^{14} q_j},\n$$\nwhich is dimensionless.\n\nSensitivity to localized constriction:\n- Choose one edge $j$ and reduce its radius by $30\\%$, i.e., $r_j' = 0.7 \\, r_j$. Recompute flows to obtain $f_i'$. Define the sensitivity metric for the test case as the maximum absolute change in fractional ventilation across alveoli:\n$$\nS = \\max_{i \\in \\{7,\\dots,14\\}} \\left| f_i' - f_i \\right|.\n$$\nReport $S$ as a dimensionless float.\n\nUnits and numerical output:\n- Use $\\mathrm{Pa}$ for pressures, $\\mathrm{m}$ for lengths, and $\\mathrm{m^3/s}$ for volumetric flows.\n- The program’s final output must be a single line containing a list of floats $[S_1,S_2,S_3,S_4]$ with each $S$ rounded to $6$ decimal places.\n\nTest suite:\n- All cases use the network structure and viscosity specified above. Each case sets $p_{\\mathrm{in}}$ and designates the edge index to constrict by $30\\%$. Some cases modify baseline radii to introduce heterogeneity. Known alveolar pressures are fixed to $0$ $\\mathrm{Pa}$ for all leaves.\n1. Case $1$ (symmetric tree, mid-generation constriction): $p_{\\mathrm{in}} = 200$ $\\mathrm{Pa}$, constricted edge $e_3$.\n2. Case $2$ (symmetric tree, proximal constriction): $p_{\\mathrm{in}} = 200$ $\\mathrm{Pa}$, constricted edge $e_0$.\n3. Case $3$ (heterogeneous right subtree, distal constriction): $p_{\\mathrm{in}} = 200$ $\\mathrm{Pa}$. Modify radii in the right subtree (edges $e_4$, $e_5$, $e_{10}$, $e_{11}$, $e_{12}$, $e_{13}$) to $0.85$ times their baseline radii; then constrict edge $e_{11}$.\n4. Case $4$ (lower driving pressure, distal constriction): $p_{\\mathrm{in}} = 50$ $\\mathrm{Pa}$, constricted edge $e_{12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[0.123456,0.234567,0.345678,0.456789]$). Each entry must be the sensitivity $S$ for the corresponding case, rounded to $6$ decimal places.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of fluid dynamics (Hagen-Poiseuille flow), mathematically well-posed as a linear system derived from conservation laws, and provides a complete, unambiguous set of parameters and objectives. The model, while a simplification of the complex human respiratory system, is a standard and appropriate representation for analyzing the fundamental mechanics of airflow distribution in a resistive network.\n\nThe solution proceeds by first constructing a mathematical model of the airway network and then implementing an algorithm to solve for the airflow distribution and its sensitivity to local constrictions.\n\n**1. Governing Principles and Mathematical Formulation**\n\nThe model is founded on two core principles:\n\n- **Hagen-Poiseuille Law**: For steady, laminar, incompressible flow through a cylindrical tube, the volumetric flow rate $Q$ is proportional to the pressure drop $\\Delta p = p_u - p_v$ across the tube. This relationship is analogous to Ohm's law, with the fluidic resistance $R$ defined as:\n$$\nQ = \\frac{\\Delta p}{R} \\quad \\text{where} \\quad R = \\frac{8 \\mu L}{\\pi r^4}\n$$\nHere, $\\mu$ is the dynamic viscosity of the air, while $L$ and $r$ are the length and radius of the airway segment, respectively. The conductance of the segment is $G = 1/R$.\n\n- **Conservation of Mass**: At any internal junction (node) in the airway network, the total mass flow rate entering the junction must equal the total mass flow rate leaving it. For an incompressible fluid, this simplifies to the conservation of volumetric flow:\n$$\n\\sum Q_{\\text{in}} = \\sum Q_{\\text{out}}\n$$\n\n**2. Network Model as a System of Linear Equations**\n\nThe airway tree is represented as a directed graph with $N=15$ nodes and $E=14$ edges. The state of the system is defined by the hydrostatic pressure $p_j$ at each node $j$.\n\n- **Incidence Matrix ($B$)**: The network topology is encoded in an edge-node incidence matrix $B \\in \\mathbb{R}^{E \\times N}$. For each edge $e$ directed from node $u_e$ to node $v_e$, the matrix entries are $B_{e, u_e} = +1$, $B_{e, v_e} = -1$, and zero otherwise. This formulation allows the pressure drop across all edges to be written compactly as the vector $\\Delta p = B p$, where $p \\in \\mathbb{R}^N$ is the vector of all node pressures.\n\n- **Conductance Matrix ($K$)**: The geometric properties of the airways are captured in a diagonal conductance matrix $K \\in \\mathbb{R}^{E \\times E}$, where each diagonal element $K_{e,e} = 1/R_e$ is the conductance of edge $e$.\n\n- **Flow Vector ($Q$)**: Using these matrices, the vector of flows $Q \\in \\mathbb{R}^E$ through all edges is given by the matrix form of the Hagen-Poiseuille law:\n$$\nQ = K (B p)\n$$\n\n- **System Assembly**: The conservation of mass at each node is expressed as $B^\\top Q = 0$ for internal nodes (where no flow is externally supplied or removed). Substituting the expression for $Q$ yields:\n$$\nB^\\top K B p = L p = 0\n$$\nThe matrix $L = B^\\top K B$ is the weighted graph Laplacian, which describes the connectivity and conductance of the entire network.\n\n**3. Solving for Nodal Pressures**\n\nThe set of all nodes is partitioned into a set $U$ of nodes with unknown pressures (internal nodes $1$ through $6$) and a set $K$ of nodes with known, prescribed pressures (the mouth, node $0$, and the alveolar leaves, nodes $7$ through $14$). The pressure vector $p$ and Laplacian $L$ are partitioned accordingly:\n$$\np = \\begin{pmatrix} p_U \\\\ p_K \\end{pmatrix}, \\quad L = \\begin{pmatrix} L_{UU} & L_{UK} \\\\ L_{KU} & L_{KK} \\end{pmatrix}\n$$\nThe conservation law applies to the internal nodes $U$, so we consider the top block of the partitioned matrix equation $Lp=J$, where $J$ is the vector of external flows. For internal nodes, the external flow is zero ($J_U = 0$). This yields:\n$$\nL_{UU} p_U + L_{UK} p_K = 0\n$$\nSince the pressures $p_K$ are known boundary conditions ($p_0 = p_{\\mathrm{in}}$ and $p_{7..14} = 0$), we can solve for the unknown internal pressures $p_U$:\n$$\nL_{UU} p_U = -L_{UK} p_K\n$$\nThe matrix $L_{UU}$ is a symmetric positive-definite matrix and thus invertible, guaranteeing a unique solution for $p_U$. This linear system is solved numerically.\n\n**4. Calculation of Ventilation Distribution and Sensitivity**\n\nOnce the unknown pressures $p_U$ are computed, the full pressure vector $p$ is known. The algorithm proceeds as follows:\n\n1.  **Compute Edge Flows**: The flow $Q_e$ in each edge is calculated using $Q = K(Bp)$.\n2.  **Determine Alveolar Flows**: The flows into the alveolar leaf nodes $i \\in \\{7, \\dots, 14\\}$ are the flows in the terminal edges ($e_6$ through $e_{13}$), denoted by $q_i$.\n3.  **Calculate Fractional Ventilation**: The total flow into the system, $Q_{\\mathrm{tot}}$, is the sum of all alveolar flows, $Q_{\\mathrm{tot}} = \\sum_{i=7}^{14} q_i$. By linearity, this sum is also equal to the total inflow at the mouth. The fractional ventilation for each alveolar unit is the fraction of the total flow it receives:\n    $$\n    f_i = \\frac{q_i}{Q_{\\mathrm{tot}}}\n    $$\n    Notably, since all flows are linearly proportional to the driving pressure $p_{\\mathrm{in}}$, the fractional ventilations $f_i$ are independent of $p_{\\mathrm{in}}$.\n4.  **Perform Sensitivity Analysis**: The entire calculation is performed twice: once for a baseline configuration and once for a constricted configuration where the radius of a specified edge $j$ is reduced to $r_j' = 0.7 r_j$. This change only affects the $j$-th diagonal element of the conductance matrix $K$. Let the baseline and constricted fractional ventilations be $f_i$ and $f_i'$, respectively.\n5.  **Compute Sensitivity Metric ($S$)**: The sensitivity to the constriction is quantified as the maximum absolute change observed across all alveolar fractional ventilations:\n    $$\n    S = \\max_{i \\in \\{7, \\dots, 14\\}} |f_i' - f_i|\n    $$\n\nThis procedure is systematically applied to each test case defined in the problem statement. The implementation will use `numpy` for efficient matrix and vector operations, with `numpy.linalg.solve` for the core linear system solution. Each case is solved independently to obtain the list of sensitivity values $[S_1, S_2, S_3, S_4]$.",
            "answer": "$$\n\\boxed{\\texttt{[0.033621,0.062500,0.021074,0.016335]}}\n$$"
        }
    ]
}