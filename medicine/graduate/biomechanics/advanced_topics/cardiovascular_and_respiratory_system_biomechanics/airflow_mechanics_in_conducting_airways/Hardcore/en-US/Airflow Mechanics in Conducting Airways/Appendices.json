{
    "hands_on_practices": [
        {
            "introduction": "The relationship between airway geometry and airflow resistance is a cornerstone of respiratory biomechanics. This exercise explores the profound sensitivity of hydraulic resistance to changes in airway radius, governed by the Hagen-Poiseuille equation. By deriving the relationship between fractional changes in resistance and radius, you will quantify why even small amounts of bronchoconstriction, as seen in asthma or chronic obstructive pulmonary disease (COPD), can lead to a dramatic increase in the work of breathing .",
            "id": "4152629",
            "problem": "Consider a single conducting airway idealized as a straight, rigid, circular cylindrical tube of length $L$ and radius $r$, conveying an incompressible Newtonian fluid (air) under steady, axisymmetric, fully developed laminar flow with no-slip boundary conditions and negligible entrance/exit effects. The hydraulic resistance $R$ is defined by $R = \\Delta P/Q$, where $\\Delta P$ is the pressure drop across the segment and $Q$ is the volumetric flow rate. Under these conditions, use a valid fundamental base to derive the first-order sensitivity of $R$ to small fractional changes in the radius $r$, expressed in differential form as a relationship between $dR/R$ and $dr/r$. Then, for a uniform $10\\%$ reduction in radius (i.e., $r \\to 0.9\\,r$) with $L$ and dynamic viscosity $\\mu$ held fixed, compute the exact fractional increase in $R$, defined as $(R_{\\text{new}} - R_{\\text{old}})/R_{\\text{old}}$, and report it as a dimensionless decimal fraction. Round your final numerical value to four significant figures. Express the final answer as a dimensionless number (no units).",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, complete, and consistent. It describes a classic problem in fluid dynamics—Hagen-Poiseuille flow—and asks for a standard sensitivity analysis and a calculation based on the derived principles. Therefore, the problem is valid, and a solution is warranted.\n\nThe fundamental relationship governing steady, fully developed laminar flow of an incompressible Newtonian fluid through a straight circular tube is the Hagen-Poiseuille equation. This equation gives the volumetric flow rate $Q$ as a function of the pressure drop $\\Delta P$ over a length $L$, the radius of the tube $r$, and the dynamic viscosity of the fluid $\\mu$:\n$$\nQ = \\frac{\\pi r^4}{8 \\mu L} \\Delta P\n$$\nThe hydraulic resistance $R$ is defined as the ratio of the pressure drop to the volumetric flow rate:\n$$\nR = \\frac{\\Delta P}{Q}\n$$\nSubstituting the expression for $Q$ from the Hagen-Poiseuille equation into the definition of $R$, we can express the resistance in terms of the geometric and fluid properties:\n$$\nR = \\frac{\\Delta P}{\\frac{\\pi r^4}{8 \\mu L} \\Delta P} = \\frac{8 \\mu L}{\\pi r^4}\n$$\nThis expression for $R$ forms the basis for both parts of the problem.\n\nFirst, we derive the first-order sensitivity of $R$ to small fractional changes in the radius $r$. We are looking for a relationship between the relative differential change in resistance, $dR/R$, and the relative differential change in radius, $dr/r$. The most direct method is logarithmic differentiation. Taking the natural logarithm of the expression for $R$:\n$$\n\\ln(R) = \\ln\\left(\\frac{8 \\mu L}{\\pi r^4}\\right)\n$$\nUsing the properties of logarithms, this can be expanded as:\n$$\n\\ln(R) = \\ln(8) + \\ln(\\mu) + \\ln(L) - \\ln(\\pi) - \\ln(r^4)\n$$\n$$\n\\ln(R) = \\ln\\left(\\frac{8 \\mu L}{\\pi}\\right) - 4 \\ln(r)\n$$\nNow, we take the total differential of this equation. Since $L$ and $\\mu$ are held constant, the term $\\ln(8 \\mu L / \\pi)$ is a constant, and its differential is zero.\n$$\nd(\\ln(R)) = d\\left(\\ln\\left(\\frac{8 \\mu L}{\\pi}\\right)\\right) - d(4 \\ln(r))\n$$\n$$\n\\frac{dR}{R} = 0 - 4 \\frac{dr}{r}\n$$\nThis gives the required first-order sensitivity relationship:\n$$\n\\frac{dR}{R} = -4 \\frac{dr}{r}\n$$\nThis result indicates that a small fractional increase in radius leads to a four-fold fractional decrease in hydraulic resistance, a consequence of the $r^4$ dependence.\n\nSecond, we compute the exact fractional increase in $R$ for a uniform $10\\%$ reduction in radius. Let the original radius be $r_{\\text{old}}$ and the original resistance be $R_{\\text{old}}$. The new radius, $r_{\\text{new}}$, is $10\\%$ less than the original:\n$$\nr_{\\text{new}} = r_{\\text{old}} - 0.10 r_{\\text{old}} = 0.9 r_{\\text{old}}\n$$\nThe original resistance is given by:\n$$\nR_{\\text{old}} = \\frac{8 \\mu L}{\\pi r_{\\text{old}}^4}\n$$\nThe new resistance, $R_{\\text{new}}$, corresponding to the new radius $r_{\\text{new}}$ is:\n$$\nR_{\\text{new}} = \\frac{8 \\mu L}{\\pi r_{\\text{new}}^4} = \\frac{8 \\mu L}{\\pi (0.9 r_{\\text{old}})^4}\n$$\nThe fractional increase in $R$ is defined as $\\frac{R_{\\text{new}} - R_{\\text{old}}}{R_{\\text{old}}}$. We can compute this by first finding the ratio $\\frac{R_{\\text{new}}}{R_{\\text{old}}}$:\n$$\n\\frac{R_{\\text{new}}}{R_{\\text{old}}} = \\frac{\\frac{8 \\mu L}{\\pi (0.9 r_{\\text{old}})^4}}{\\frac{8 \\mu L}{\\pi r_{\\text{old}}^4}} = \\frac{r_{\\text{old}}^4}{(0.9 r_{\\text{old}})^4} = \\frac{1}{(0.9)^4}\n$$\nNow, we calculate the value of $(0.9)^4$:\n$$\n(0.9)^4 = 0.81^2 = 0.6561\n$$\nSo, the ratio of resistances is:\n$$\n\\frac{R_{\\text{new}}}{R_{\\text{old}}} = \\frac{1}{0.6561}\n$$\nThe fractional increase is then:\n$$\n\\frac{R_{\\text{new}} - R_{\\text{old}}}{R_{\\text{old}}} = \\frac{R_{\\text{new}}}{R_{\\text{old}}} - 1 = \\frac{1}{0.6561} - 1\n$$\nPerforming the calculation:\n$$\n\\frac{1}{0.6561} - 1 \\approx 1.5241579027... - 1 = 0.5241579027...\n$$\nThe problem requires the result to be rounded to four significant figures.\n$$\n0.5242\n$$\nThus, a $10\\%$ reduction in the airway radius results in approximately a $52.42\\%$ increase in hydraulic resistance, highlighting the critical impact of airway caliber on the work of breathing.",
            "answer": "$$\n\\boxed{0.5242}\n$$"
        },
        {
            "introduction": "While the Hagen-Poiseuille model is powerful, it assumes a \"fully developed\" velocity profile that is often not present in the shorter, branching segments of the lung's conducting zone. This practice moves beyond that idealization by examining the fluid dynamics within the airway \"entrance length,\" where the velocity profile is still evolving. You will apply the mechanical energy balance, including the kinetic energy correction coefficient, to quantify the additional pressure drop associated with flow development, thus refining our understanding of pressure losses in the respiratory tree .",
            "id": "4152689",
            "problem": "Consider steady, incompressible, axisymmetric laminar airflow entering a straight, rigid, circular bronchus segment of diameter $D$ and length equal to the entrance length $L_{e}$. The fluid is air at body conditions with dynamic viscosity $\\mu$ and mass density $\\rho$. The mean axial velocity is $V_{m}$ and the inlet velocity profile has kinetic energy correction coefficient (Coriolis coefficient) $\\alpha_{\\text{in}}$, while the fully developed laminar profile has $\\alpha_{\\text{fd}}$. Starting from the mechanical energy balance for internal flows that includes the kinetic energy correction coefficient and from the definition of the laminar pressure gradient in a circular duct, derive an expression for the correction to the fully developed friction factor over the domain $x \\in [0,L_{e}]$ caused by flow development, expressed in terms of $\\alpha_{\\text{in}}$, $\\alpha_{\\text{fd}}$, $D$, $L_{e}$, and the Reynolds number $Re$. Then, for the parameter values $D=0.004\\,\\text{m}$, $\\mu=1.9\\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho=1.2\\,\\text{kg}\\cdot\\text{m}^{-3}$, $V_{m}=0.5\\,\\text{m}\\cdot\\text{s}^{-1}$, $\\alpha_{\\text{in}}=1.0$ and $\\alpha_{\\text{fd}}=2.0$, take the laminar entrance length as $L_{e}=0.05\\,Re\\,D$, where $Re=\\rho V_{m}D/\\mu$, and estimate the percent increase in the pressure drop over $L_{e}$ relative to the prediction obtained by assuming fully developed (Poiseuille) flow over $L_{e}$ alone. Express the percent increase as a decimal fraction and round your final answer to three significant figures. Use Pascals for intermediate pressure-drop calculations if needed, but the final decimal fraction must be unitless.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It contains all necessary information to derive the requested expressions and compute the final numerical answer. We may therefore proceed with the solution.\n\nThe problem is divided into two parts. First, we must derive an expression for the correction to the fully developed friction factor due to flow development in the entrance region. Second, we must use this framework to estimate the percent increase in pressure drop over the entrance length for a specific set of parameters.\n\nFirst, let's verify that the flow regime is consistent with the problem's assumption of laminar flow. The Reynolds number, $Re$, is defined as:\n$$ Re = \\frac{\\rho V_{m} D}{\\mu} $$\nUsing the provided numerical values:\n$$ Re = \\frac{(1.2\\,\\text{kg}\\cdot\\text{m}^{-3}) (0.5\\,\\text{m}\\cdot\\text{s}^{-1}) (0.004\\,\\text{m})}{1.9 \\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}} = \\frac{0.0024}{1.9 \\times 10^{-5}} \\approx 126.3 $$\nSince $Re \\approx 126.3$ is well below the critical value for transition to turbulence in a circular pipe (typically $Re_{crit} \\approx 2300$), the flow is indeed laminar.\n\n**Part 1: Derivation of the Friction Factor Correction**\n\nWe begin with the mechanical energy balance for a steady, incompressible flow in a horizontal pipe of constant diameter between two points, inlet ($1$) and outlet ($2$). The equation includes the kinetic energy correction coefficient, $\\alpha$, to account for non-uniform velocity profiles.\n$$ \\frac{p_1}{\\rho} + \\alpha_1 \\frac{V_{m1}^2}{2} + gz_1 = \\frac{p_2}{\\rho} + \\alpha_2 \\frac{V_{m2}^2}{2} + gz_2 + h_L $$\nFor a horizontal pipe ($z_1 = z_2$) of constant diameter ($V_{m1} = V_{m2} = V_m$), the equation simplifies to:\n$$ \\frac{p_1 - p_2}{\\rho} = (\\alpha_2 - \\alpha_1) \\frac{V_m^2}{2} + h_L $$\nHere, $p_1 - p_2 = \\Delta p$ is the pressure drop, and $h_L$ is the head loss due to frictional effects. The problem considers the flow from the entrance at $x=0$ to the end of the entrance region at $x=L_e$. At the inlet ($1$), we have a uniform velocity profile, so $\\alpha_1 = \\alpha_{\\text{in}}$. At the outlet ($2$), the flow is fully developed, so $\\alpha_2 = \\alpha_{\\text{fd}}$. The total pressure drop over the length $L_e$, denoted $\\Delta p_{L_e}$, is:\n$$ \\Delta p_{L_e} = \\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) + \\rho h_L $$\nThe term $\\rho h_L$ represents the pressure drop due to viscous friction at the pipe wall, $\\Delta p_{f}$. The first term on the right-hand side represents the pressure drop required to change the momentum flux of the flow as the velocity profile develops from the inlet shape to the fully developed parabolic shape. Let's call this term $\\Delta p_{\\text{mom}}$:\n$$ \\Delta p_{\\text{mom}} = \\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\nSo, the total pressure drop is $\\Delta p_{L_e} = \\Delta p_{\\text{mom}} + \\Delta p_{f}$.\n\nThe problem implies a simplified model where the frictional pressure drop, $\\Delta p_f$, over the entrance length is approximated by the pressure drop that would occur if the flow were fully developed over that same length. This pressure drop, $\\Delta p_{\\text{fd}}$, is given by the Hagen-Poiseuille equation, or equivalently, using the fully developed Darcy friction factor, $f_{\\text{fd}}$. For laminar flow, $f_{\\text{fd}} = 64/Re$.\n$$ \\Delta p_f \\approx \\Delta p_{\\text{fd}} = f_{\\text{fd}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} $$\nUnder this approximation, the total pressure drop over the entrance length is:\n$$ \\Delta p_{L_e} \\approx \\left( f_{\\text{fd}} \\frac{L_e}{D} \\right) \\frac{\\rho V_m^2}{2} + (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) \\frac{\\rho V_m^2}{2} $$\nTo find a \"correction to the friction factor,\" we define an apparent friction factor, $f_{\\text{app}}$, that accounts for the total pressure drop over the length $L_e$:\n$$ \\Delta p_{L_e} = f_{\\text{app}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} $$\nEquating the two expressions for $\\Delta p_{L_e}$:\n$$ f_{\\text{app}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} = \\left( f_{\\text{fd}} \\frac{L_e}{D} \\right) \\frac{\\rho V_m^2}{2} + (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) \\frac{\\rho V_m^2}{2} $$\nDividing all terms by $\\frac{\\rho V_m^2}{2}$:\n$$ f_{\\text{app}} \\frac{L_e}{D} = f_{\\text{fd}} \\frac{L_e}{D} + (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\nSolving for $f_{\\text{app}}$:\n$$ f_{\\text{app}} = f_{\\text{fd}} + \\frac{D}{L_e} (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\nThe correction to the fully developed friction factor, which we can denote as $\\Delta f$, is the additional term caused by flow development:\n$$ \\Delta f = \\frac{D}{L_e} (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\nThis expression depends on $\\alpha_{\\text{in}}$, $\\alpha_{\\text{fd}}$, $D$, $L_e$, and implicitly on $Re$ through the definition of $L_e$.\n\n**Part 2: Percent Increase in Pressure Drop**\n\nThe percent increase in pressure drop is calculated relative to the prediction that assumes fully developed flow over the entire length $L_e$.\nThe \"actual\" pressure drop (within our model) is $\\Delta p_{L_e}$.\n$$ \\Delta p_{L_e} = \\Delta p_{\\text{fd}} + \\Delta p_{\\text{mom}} $$\nThe \"naive\" prediction assuming fully developed flow is simply $\\Delta p_{\\text{fd}}$.\nThe fractional increase is given by:\n$$ \\text{Fractional Increase} = \\frac{\\Delta p_{L_e} - \\Delta p_{\\text{fd}}}{\\Delta p_{\\text{fd}}} = \\frac{(\\Delta p_{\\text{fd}} + \\Delta p_{\\text{mom}}) - \\Delta p_{\\text{fd}}}{\\Delta p_{\\text{fd}}} = \\frac{\\Delta p_{\\text{mom}}}{\\Delta p_{\\text{fd}}} $$\nNow, we substitute the expressions for $\\Delta p_{\\text{mom}}$ and $\\Delta p_{\\text{fd}}$:\n$$ \\Delta p_{\\text{mom}} = \\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}) $$\n$$ \\Delta p_{\\text{fd}} = f_{\\text{fd}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2} $$\nThe ratio becomes:\n$$ \\text{Fractional Increase} = \\frac{\\frac{1}{2}\\rho V_m^2 (\\alpha_{\\text{fd}} - \\alpha_{\\text{in}})}{f_{\\text{fd}} \\frac{L_e}{D} \\frac{\\rho V_m^2}{2}} = \\frac{\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}}{f_{\\text{fd}} \\frac{L_e}{D}} $$\nThe problem provides the specific relations:\n$f_{\\text{fd}} = \\frac{64}{Re}$\n$L_e = 0.05 \\, Re \\, D$\nSubstituting these into the expression for the fractional increase:\n$$ \\text{Fractional Increase} = \\frac{\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}}{\\left(\\frac{64}{Re}\\right) \\frac{(0.05 \\, Re \\, D)}{D}} $$\nThe terms $Re$ and $D$ cancel out, leading to a remarkably simple result that is independent of the specific flow conditions, provided the flow is laminar.\n$$ \\text{Fractional Increase} = \\frac{\\alpha_{\\text{fd}} - \\alpha_{\\text{in}}}{64 \\times 0.05} $$\nNow we substitute the given numerical values for the kinetic energy correction coefficients: $\\alpha_{\\text{in}} = 1.0$ (for the specified uniform inlet profile) and $\\alpha_{\\text{fd}} = 2.0$ (for a fully developed laminar profile).\n$$ \\text{Fractional Increase} = \\frac{2.0 - 1.0}{64 \\times 0.05} = \\frac{1.0}{3.2} = 0.3125 $$\nThe problem asks for the answer to be rounded to three significant figures.\n$$ \\text{Fractional Increase} \\approx 0.313 $$\nThis means that for the given model and parameters, the pressure drop in the entrance region is approximately $31.3\\%$ higher than what would be predicted by assuming fully developed Poiseuille flow over the same length. This increase is solely due to the pressure change needed to accelerate the fluid into the parabolic velocity profile.",
            "answer": "$$\\boxed{0.313}$$"
        },
        {
            "introduction": "To understand lung function and disease, we must scale up from single-airway physics to the behavior of the entire airway network. This computational exercise challenges you to model a simplified airway tree as an electrical circuit analogue, where airflow is governed by a system of resistive elements. By building and solving this network model, you will gain hands-on experience in predicting how a localized constriction in one airway branch redistributes ventilation across the entire system, a key mechanism underlying ventilation-perfusion mismatch in lung disease .",
            "id": "4152642",
            "problem": "You are tasked with modeling airflow through conducting airways as a resistive network under steady, laminar, incompressible conditions to evaluate how alveolar ventilation distribution changes when a single branch undergoes localized constriction. The conducting airway network is represented as a directed binary tree, with the mouth at the root and alveoli at the leaves. Airflow is driven by a fixed pressure at the mouth relative to an alveolar pressure taken as zero. The goal is to compute the sensitivity of the alveolar fractional ventilation distribution to a $30\\%$ reduction in the radius of one specified branch, by solving the network flow equations before and after the constriction.\n\nFundamental base:\n- Conservation of mass: at each internal node, the sum of inflows equals the sum of outflows.\n- Newton’s laws applied to viscous flow in cylinders in the low Reynolds number (Reynolds number (Re)) regime yield the Hagen–Poiseuille relation governing volumetric flow through a cylindrical airway segment, modeled as a fluid resistor. For a branch with radius $r$, length $L$, dynamic viscosity $\\mu$, upstream pressure $p_u$, and downstream pressure $p_v$, the volumetric flow is\n$$\nQ = \\frac{p_u - p_v}{R}, \\quad R = \\frac{8 \\mu L}{\\pi r^4}.\n$$\nThese relations are used to construct a linear system for node pressures in the resistive network.\n\nNetwork representation:\n- Nodes are indexed by integers. Node $0$ is the mouth (source) with fixed pressure $p_{\\mathrm{in}}$. Nodes $7$ through $14$ are alveolar sinks with fixed pressure $p_{\\mathrm{alv}} = 0$ $\\mathrm{Pa}$. All other nodes are internal with unknown pressures.\n- Edges (airway segments) are directed from parent to child. Each edge $e$ is represented by $(u_e, v_e, L_e, r_e)$ where $u_e$ is the upstream node index, $v_e$ is the downstream node index, $L_e$ is the length in $\\mathrm{m}$, and $r_e$ is the radius in $\\mathrm{m}$. The network contains $14$ edges and $15$ nodes with the following structure:\n1. Generation $1$: edges $e_0: (0 \\rightarrow 1)$, $e_1: (0 \\rightarrow 2)$, each with $L = 0.06$ $\\mathrm{m}$ and $r = 0.006$ $\\mathrm{m}$.\n2. Generation $2$: edges $e_2: (1 \\rightarrow 3)$, $e_3: (1 \\rightarrow 4)$, $e_4: (2 \\rightarrow 5)$, $e_5: (2 \\rightarrow 6)$, each with $L = 0.03$ $\\mathrm{m}$ and $r = 0.0035$ $\\mathrm{m}$.\n3. Generation $3$: edges $e_6: (3 \\rightarrow 7)$, $e_7: (3 \\rightarrow 8)$, $e_8: (4 \\rightarrow 9)$, $e_9: (4 \\rightarrow 10)$, $e_{10}: (5 \\rightarrow 11)$, $e_{11}: (5 \\rightarrow 12)$, $e_{12}: (6 \\rightarrow 13)$, $e_{13}: (6 \\rightarrow 14)$, each with $L = 0.02$ $\\mathrm{m}$ and $r = 0.0020$ $\\mathrm{m}$.\n- Air viscosity is $\\mu = 1.9 \\times 10^{-5}$ $\\mathrm{Pa \\cdot s}$.\n\nMathematical formulation:\n- Let $E$ be the number of edges and $N$ be the number of nodes. Define an edge-node incidence matrix $B \\in \\mathbb{R}^{E \\times N}$ with rows indexed by edges and columns by nodes, with entries $B_{e,u_e} = +1$, $B_{e,v_e} = -1$, and $0$ otherwise. Let $K \\in \\mathbb{R}^{E \\times E}$ be diagonal with $K_{e,e} = 1/R_e$.\n- Edge flows satisfy\n$$\nQ = K \\, B \\, p,\n$$\nwhere $p \\in \\mathbb{R}^{N}$ is the vector of node pressures.\n- Mass conservation at internal (unknown-pressure) nodes leads to\n$$\nB^\\top Q = 0 \\quad \\Rightarrow \\quad B^\\top K B \\, p = 0.\n$$\nPartition the nodes into unknown set $U$ and known set $K$ (with prescribed pressures), and write the reduced linear system\n$$\nL_{UU} \\, p_U = - L_{UK} \\, p_K,\n$$\nwith $L = B^\\top K B$ being the weighted graph Laplacian. Solve for $p_U$, then compute edge flows $Q$, and terminal flows $q_i$ into each alveolar leaf $i \\in \\{7,\\dots,14\\}$.\n\nAlveolar ventilation distribution:\n- The total inlet flow is $Q_{\\mathrm{tot}} = \\sum_{e \\in \\{e_0,e_1\\}} Q_e$ in $\\mathrm{m^3/s}$. The alveolar flow into leaf $i$ is the magnitude of the single edge flow entering node $i$, denoted $q_i$ in $\\mathrm{m^3/s}$. The alveolar fractional ventilation is\n$$\nf_i = \\frac{q_i}{\\sum_{j=7}^{14} q_j},\n$$\nwhich is dimensionless.\n\nSensitivity to localized constriction:\n- Choose one edge $j$ and reduce its radius by $30\\%$, i.e., $r_j' = 0.7 \\, r_j$. Recompute flows to obtain $f_i'$. Define the sensitivity metric for the test case as the maximum absolute change in fractional ventilation across alveoli:\n$$\nS = \\max_{i \\in \\{7,\\dots,14\\}} \\left| f_i' - f_i \\right|.\n$$\nReport $S$ as a dimensionless float.\n\nUnits and numerical output:\n- Use $\\mathrm{Pa}$ for pressures, $\\mathrm{m}$ for lengths, and $\\mathrm{m^3/s}$ for volumetric flows.\n- The program’s final output must be a single line containing a list of floats $[S_1,S_2,S_3,S_4]$ with each $S$ rounded to $6$ decimal places.\n\nTest suite:\n- All cases use the network structure and viscosity specified above. Each case sets $p_{\\mathrm{in}}$ and designates the edge index to constrict by $30\\%$. Some cases modify baseline radii to introduce heterogeneity. Known alveolar pressures are fixed to $0$ $\\mathrm{Pa}$ for all leaves.\n1. Case $1$ (symmetric tree, mid-generation constriction): $p_{\\mathrm{in}} = 200$ $\\mathrm{Pa}$, constricted edge $e_3$.\n2. Case $2$ (symmetric tree, proximal constriction): $p_{\\mathrm{in}} = 200$ $\\mathrm{Pa}$, constricted edge $e_0$.\n3. Case $3$ (heterogeneous right subtree, distal constriction): $p_{\\mathrm{in}} = 200$ $\\mathrm{Pa}$. Modify radii in the right subtree (edges $e_4$, $e_5$, $e_{10}$, $e_{11}$, $e_{12}$, $e_{13}$) to $0.85$ times their baseline radii; then constrict edge $e_{11}$.\n4. Case $4$ (lower driving pressure, distal constriction): $p_{\\mathrm{in}} = 50$ $\\mathrm{Pa}$, constricted edge $e_{12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[0.123456,0.234567,0.345678,0.456789]$). Each entry must be the sensitivity $S$ for the corresponding case, rounded to $6$ decimal places.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of fluid dynamics (Hagen-Poiseuille flow), mathematically well-posed as a linear system derived from conservation laws, and provides a complete, unambiguous set of parameters and objectives. The model, while a simplification of the complex human respiratory system, is a standard and appropriate representation for analyzing the fundamental mechanics of airflow distribution in a resistive network.\n\nThe solution proceeds by first constructing a mathematical model of the airway network and then implementing an algorithm to solve for the airflow distribution and its sensitivity to local constrictions.\n\n**1. Governing Principles and Mathematical Formulation**\n\nThe model is founded on two core principles:\n\n- **Hagen-Poiseuille Law**: For steady, laminar, incompressible flow through a cylindrical tube, the volumetric flow rate $Q$ is proportional to the pressure drop $\\Delta p = p_u - p_v$ across the tube. This relationship is analogous to Ohm's law, with the fluidic resistance $R$ defined as:\n$$\nQ = \\frac{\\Delta p}{R} \\quad \\text{where} \\quad R = \\frac{8 \\mu L}{\\pi r^4}\n$$\nHere, $\\mu$ is the dynamic viscosity of the air, while $L$ and $r$ are the length and radius of the airway segment, respectively. The conductance of the segment is $G = 1/R$.\n\n- **Conservation of Mass**: At any internal junction (node) in the airway network, the total mass flow rate entering the junction must equal the total mass flow rate leaving it. For an incompressible fluid, this simplifies to the conservation of volumetric flow:\n$$\n\\sum Q_{\\text{in}} = \\sum Q_{\\text{out}}\n$$\n\n**2. Network Model as a System of Linear Equations**\n\nThe airway tree is represented as a directed graph with $N=15$ nodes and $E=14$ edges. The state of the system is defined by the hydrostatic pressure $p_j$ at each node $j$.\n\n- **Incidence Matrix ($B$)**: The network topology is encoded in an edge-node incidence matrix $B \\in \\mathbb{R}^{E \\times N}$. For each edge $e$ directed from node $u_e$ to node $v_e$, the matrix entries are $B_{e, u_e} = +1$, $B_{e, v_e} = -1$, and zero otherwise. This formulation allows the pressure drop across all edges to be written compactly as the vector $\\Delta p = B p$, where $p \\in \\mathbb{R}^N$ is the vector of all node pressures.\n\n- **Conductance Matrix ($K$)**: The geometric properties of the airways are captured in a diagonal conductance matrix $K \\in \\mathbb{R}^{E \\times E}$, where each diagonal element $K_{e,e} = 1/R_e$ is the conductance of edge $e$.\n\n- **Flow Vector ($Q$)**: Using these matrices, the vector of flows $Q \\in \\mathbb{R}^E$ through all edges is given by the matrix form of the Hagen-Poiseuille law:\n$$\nQ = K (B p)\n$$\n\n- **System Assembly**: The conservation of mass at each node is expressed as $B^\\top Q = 0$ for internal nodes (where no flow is externally supplied or removed). Substituting the expression for $Q$ yields:\n$$\nB^\\top K B p = L p = 0\n$$\nThe matrix $L = B^\\top K B$ is the weighted graph Laplacian, which describes the connectivity and conductance of the entire network.\n\n**3. Solving for Nodal Pressures**\n\nThe set of all nodes is partitioned into a set $U$ of nodes with unknown pressures (internal nodes $1$ through $6$) and a set $K$ of nodes with known, prescribed pressures (the mouth, node $0$, and the alveolar leaves, nodes $7$ through $14$). The pressure vector $p$ and Laplacian $L$ are partitioned accordingly:\n$$\np = \\begin{pmatrix} p_U \\\\ p_K \\end{pmatrix}, \\quad L = \\begin{pmatrix} L_{UU}  L_{UK} \\\\ L_{KU}  L_{KK} \\end{pmatrix}\n$$\nThe conservation law applies to the internal nodes $U$, so we consider the top block of the partitioned matrix equation $Lp=J$, where $J$ is the vector of external flows. For internal nodes, the external flow is zero ($J_U = 0$). This yields:\n$$\nL_{UU} p_U + L_{UK} p_K = 0\n$$\nSince the pressures $p_K$ are known boundary conditions ($p_0 = p_{\\mathrm{in}}$ and $p_{7..14} = 0$), we can solve for the unknown internal pressures $p_U$:\n$$\nL_{UU} p_U = -L_{UK} p_K\n$$\nThe matrix $L_{UU}$ is a symmetric positive-definite matrix and thus invertible, guaranteeing a unique solution for $p_U$. This linear system is solved numerically.\n\n**4. Calculation of Ventilation Distribution and Sensitivity**\n\nOnce the unknown pressures $p_U$ are computed, the full pressure vector $p$ is known. The algorithm proceeds as follows:\n\n1.  **Compute Edge Flows**: The flow $Q_e$ in each edge is calculated using $Q = K(Bp)$.\n2.  **Determine Alveolar Flows**: The flows into the alveolar leaf nodes $i \\in \\{7, \\dots, 14\\}$ are the flows in the terminal edges ($e_6$ through $e_{13}$), denoted by $q_i$.\n3.  **Calculate Fractional Ventilation**: The total flow into the system, $Q_{\\mathrm{tot}}$, is the sum of all alveolar flows, $Q_{\\mathrm{tot}} = \\sum_{i=7}^{14} q_i$. By linearity, this sum is also equal to the total inflow at the mouth. The fractional ventilation for each alveolar unit is the fraction of the total flow it receives:\n    $$\n    f_i = \\frac{q_i}{Q_{\\mathrm{tot}}}\n    $$\n    Notably, since all flows are linearly proportional to the driving pressure $p_{\\mathrm{in}}$, the fractional ventilations $f_i$ are independent of $p_{\\mathrm{in}}$.\n4.  **Perform Sensitivity Analysis**: The entire calculation is performed twice: once for a baseline configuration and once for a constricted configuration where the radius of a specified edge $j$ is reduced to $r_j' = 0.7 r_j$. This change only affects the $j$-th diagonal element of the conductance matrix $K$. Let the baseline and constricted fractional ventilations be $f_i$ and $f_i'$, respectively.\n5.  **Compute Sensitivity Metric ($S$)**: The sensitivity to the constriction is quantified as the maximum absolute change observed across all alveolar fractional ventilations:\n    $$\n    S = \\max_{i \\in \\{7, \\dots, 14\\}} |f_i' - f_i|\n    $$\n\nThis procedure is systematically applied to each test case defined in the problem statement. The implementation will use `numpy` for efficient matrix and vector operations, with `numpy.linalg.solve` for the core linear system solution. Each case is solved independently to obtain the list of sensitivity values $[S_1, S_2, S_3, S_4]$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of alveolar ventilation distribution to localized\n    airway constrictions in a resistive network model of the lungs.\n    \"\"\"\n\n    # --- Define constants and base network structure ---\n    MU = 1.9e-5  # Dynamic viscosity of air in Pa.s\n    NUM_NODES = 15\n    NUM_EDGES = 14\n\n    # Edges are defined by (upstream_node, downstream_node)\n    edges = np.array([\n        [0, 1], [0, 2],  # Generation 1\n        [1, 3], [1, 4], [2, 5], [2, 6],  # Generation 2\n        [3, 7], [3, 8], [4, 9], [4, 10],  # Generation 3 (left subtree)\n        [5, 11], [5, 12], [6, 13], [6, 14]  # Generation 3 (right subtree)\n    ])\n\n    # Baseline geometric properties of the edges (airways)\n    L_base = np.array(\n        [0.06] * 2 +    # Gen 1 lengths\n        [0.03] * 4 +    # Gen 2 lengths\n        [0.02] * 8      # Gen 3 lengths\n    )\n    r_base = np.array(\n        [0.006] * 2 +   # Gen 1 radii\n        [0.0035] * 4 +  # Gen 2 radii\n        [0.0020] * 8    # Gen 3 radii\n    )\n\n    # Node partitioning\n    unknown_nodes = list(range(1, 7))\n    known_nodes = [0] + list(range(7, 15))\n\n    # --- Helper function to compute fractional ventilation ---\n    def calculate_fractional_ventilation(p_in, radii):\n        \"\"\"\n        Solves the network for given parameters and returns fractional ventilations.\n        \"\"\"\n        # 1. Calculate resistances and conductances\n        resistances = (8 * MU * L_base) / (np.pi * radii**4)\n        K_diag = 1.0 / resistances\n        \n        # 2. Construct incidence matrix B\n        B = np.zeros((NUM_EDGES, NUM_NODES))\n        for i, (u, v) in enumerate(edges):\n            B[i, u] = 1\n            B[i, v] = -1\n\n        # 3. Construct the weighted graph Laplacian L = B^T * K * B\n        K = np.diag(K_diag)\n        L = B.T @ K @ B\n\n        # 4. Partition matrices for the linear system L_UU * p_U = -L_UK * p_K\n        L_UU = L[np.ix_(unknown_nodes, unknown_nodes)]\n        L_UK = L[np.ix_(unknown_nodes, known_nodes)]\n        \n        p_K = np.zeros(len(known_nodes))\n        # The first element of known_nodes is node 0 (mouth)\n        p_K[0] = p_in\n\n        # 5. Solve for unknown node pressures p_U\n        rhs = -L_UK @ p_K\n        p_U = np.linalg.solve(L_UU, rhs)\n\n        # 6. Reconstruct full pressure vector and calculate flows\n        p = np.zeros(NUM_NODES)\n        p[unknown_nodes] = p_U\n        p[known_nodes] = p_K\n        \n        # Edge flows Q = K * (B * p)\n        Q = K_diag * (B @ p)\n\n        # 7. Calculate fractional ventilation\n        terminal_flow_indices = range(6, 14) # Edges e6 to e13\n        alveolar_flows = Q[terminal_flow_indices]\n        \n        total_flow = np.sum(alveolar_flows)\n        # Avoid division by zero if there's no flow, though not expected here\n        if total_flow == 0:\n            return np.zeros_like(alveolar_flows)\n\n        fractional_ventilation = alveolar_flows / total_flow\n        return fractional_ventilation\n\n    # --- Define and process test cases ---\n    test_cases = [\n        # Case 1: p_in=200 Pa, symmetric, constrict e3\n        {'p_in': 200.0, 'constricted_idx': 3, 'radius_mods': {}},\n        # Case 2: p_in=200 Pa, symmetric, constrict e0\n        {'p_in': 200.0, 'constricted_idx': 0, 'radius_mods': {}},\n        # Case 3: p_in=200 Pa, heterogeneous, constrict e11\n        {'p_in': 200.0, 'constricted_idx': 11, 'radius_mods': \n            {idx: 0.85 for idx in [4, 5, 10, 11, 12, 13]}},\n        # Case 4: p_in=50 Pa, symmetric, constrict e12\n        {'p_in': 50.0, 'constricted_idx': 12, 'radius_mods': {}},\n    ]\n\n    results = []\n    for case in test_cases:\n        p_in = case['p_in']\n        constricted_idx = case['constricted_idx']\n        \n        # --- Baseline Calculation ---\n        r_baseline_case = r_base.copy()\n        if case['radius_mods']:\n            for idx, factor in case['radius_mods'].items():\n                r_baseline_case[idx] *= factor\n        \n        f_baseline = calculate_fractional_ventilation(p_in, r_baseline_case)\n\n        # --- Constricted Calculation ---\n        r_constricted = r_baseline_case.copy()\n        r_constricted[constricted_idx] *= 0.7\n        \n        f_constricted = calculate_fractional_ventilation(p_in, r_constricted)\n        \n        # --- Sensitivity Calculation ---\n        sensitivity = np.max(np.abs(f_constricted - f_baseline))\n        results.append(sensitivity)\n\n    # Final print statement in the exact required format\n    formatted_results = [f\"{round(s, 6):.6f}\" for s in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}