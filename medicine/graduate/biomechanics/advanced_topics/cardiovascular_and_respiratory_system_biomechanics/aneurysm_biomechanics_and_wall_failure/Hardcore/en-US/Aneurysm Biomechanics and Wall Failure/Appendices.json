{
    "hands_on_practices": [
        {
            "introduction": "The analysis of aneurysm mechanics begins with kinematics—the study of motion and deformation, irrespective of the forces that cause it. Arterial tissue is nearly incompressible, a fundamental property meaning its volume remains constant even under large deformation. This practice  challenges you to apply the incompressibility constraint to a deforming aneurysm segment, providing a foundational skill for relating the stretches in different directions and calculating changes in wall thickness.",
            "id": "4153428",
            "problem": "A short cylindrical arterial wall segment, representing a localized fusiform aneurysm, is modeled as a thin, homogeneous membrane undergoing axisymmetric inflation and axial extension in vivo. The unloaded (stress-free) configuration has circumferential mid-surface radius $R_{0}$ and uniform wall thickness $t_{0}$. In the loaded configuration, the mid-surface experiences a uniform circumferential stretch $\\lambda_{\\theta}$ and a uniform axial stretch $\\lambda_{z}$ relative to the unloaded state. Assume:\n- The material is incompressible.\n- Principal directions remain orthogonal with negligible shear and no torsion.\n- The wall behaves as a membrane with uniform through-thickness stretch and negligible radial gradients of the in-plane stretches.\n\nUsing only kinematics and material incompressibility, determine the current thickness $t$ in the loaded configuration in terms of $t_{0}$, $\\lambda_{\\theta}$, and $\\lambda_{z}$. Express your final answer as a single closed-form analytic expression in terms of the given symbols. Treat thickness in meters if $t_{0}$ is in meters. Do not substitute numerical values.",
            "solution": "The problem statement will first be subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   **Model**: A short cylindrical arterial wall segment representing a localized fusiform aneurysm.\n-   **Geometric Properties (Unloaded)**: Circumferential mid-surface radius $R_{0}$, uniform wall thickness $t_{0}$.\n-   **Deformation (Loaded)**: Uniform circumferential stretch $\\lambda_{\\theta}$, uniform axial stretch $\\lambda_{z}$.\n-   **Material Assumption 1**: The material is incompressible.\n-   **Kinematic Assumption 1**: Principal directions remain orthogonal with negligible shear and no torsion. This implies the deformation is described by principal stretches aligned with the cylindrical coordinate system directions: radial ($r$), circumferential ($\\theta$), and axial ($z$).\n-   **Kinematic Assumption 2**: The wall is modeled as a membrane, implying a uniform through-thickness stretch and negligible radial gradients of the in-plane stretches ($\\lambda_{\\theta}$ and $\\lambda_{z}$).\n-   **Objective**: Determine the current thickness $t$ in the loaded configuration as a function of $t_{0}$, $\\lambda_{\\theta}$, and $\\lambda_{z}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria.\n\n-   **Scientific Grounding**: The problem is firmly grounded in the principles of continuum mechanics, specifically finite deformation kinematics. The concepts of principal stretches, the incompressibility constraint, and the membrane assumption are standard, well-established tools in the biomechanical analysis of soft tissues like arterial walls.\n-   **Well-Posedness**: The problem is well-posed. It provides sufficient information (two principal stretches and the incompressibility constraint) to uniquely determine the third principal stretch, and consequently, the final thickness.\n-   **Objectivity**: The language is technical, precise, and devoid of subjective or opinion-based content.\n\nBased on this assessment, the problem is free of scientific unsoundness, ambiguity, and internal contradictions. It presents a standard, formalizable problem in biomechanics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A reasoned solution will now be derived.\n\nThe core principle for solving this problem is the material incompressibility constraint. In continuum mechanics, this constraint dictates that the volume of a material element remains constant throughout the deformation. Mathematically, this is expressed by stating that the determinant of the deformation gradient tensor, $F$, must be equal to $1$. The determinant, denoted as $J$, is the ratio of the current volume to the reference volume of a differential element.\n\n$$J = \\det(F) = 1$$\n\nThe problem is described in a cylindrical coordinate system ($r, \\theta, z$) which, based on the stated assumptions of axisymmetric inflation and axial extension with no shear, coincide with the principal directions of stretch. Therefore, the deformation gradient tensor $F$ is a diagonal matrix whose components are the principal stretches:\n\n$$F = \\begin{pmatrix} \\lambda_{r} & 0 & 0 \\\\ 0 & \\lambda_{\\theta} & 0 \\\\ 0 & 0 & \\lambda_{z} \\end{pmatrix}$$\n\nwhere $\\lambda_r$ is the principal stretch in the radial (through-thickness) direction, $\\lambda_{\\theta}$ is the principal stretch in the circumferential direction, and $\\lambda_{z}$ is the principal stretch in the axial direction.\n\nThe determinant of this diagonal tensor is the product of its diagonal elements:\n\n$$J = \\det(F) = \\lambda_{r} \\lambda_{\\theta} \\lambda_{z}$$\n\nApplying the incompressibility constraint, $J=1$, we obtain the fundamental relationship between the three principal stretches:\n\n$$\\lambda_{r} \\lambda_{\\theta} \\lambda_{z} = 1$$\n\nThe problem asks for the current thickness, $t$. A stretch is defined as the ratio of the current length to the original (unloaded) length in a specific direction. For the radial direction, the principal stretch $\\lambda_{r}$ relates the current thickness $t$ to the original thickness $t_{0}$. The membrane assumption ensures that this stretch is uniform through the thickness.\n\n$$\\lambda_{r} = \\frac{\\text{current thickness}}{\\text{original thickness}} = \\frac{t}{t_{0}}$$\n\nNow, we substitute this expression for $\\lambda_{r}$ into the incompressibility equation:\n\n$$\\left(\\frac{t}{t_{0}}\\right) \\lambda_{\\theta} \\lambda_{z} = 1$$\n\nTo find the current thickness $t$, we simply rearrange the equation to solve for $t$:\n\n$$\\frac{t}{t_{0}} = \\frac{1}{\\lambda_{\\theta} \\lambda_{z}}$$\n\nMultiplying both sides by $t_{0}$ gives the final expression for the loaded thickness $t$ in terms of the initial thickness $t_{0}$ and the in-plane stretches $\\lambda_{\\theta}$ and $\\lambda_{z}$:\n\n$$t = \\frac{t_{0}}{\\lambda_{\\theta} \\lambda_{z}}$$\n\nThis result is physically intuitive: as the arterial wall is stretched in the circumferential and axial directions (i.e., $\\lambda_{\\theta} > 1$ and $\\lambda_{z} > 1$), its thickness must decrease ($t < t_{0}$) to conserve volume.",
            "answer": "$$\n\\boxed{\\frac{t_{0}}{\\lambda_{\\theta} \\lambda_{z}}}\n$$"
        },
        {
            "introduction": "While complex constitutive models are powerful, simplified analytical laws often provide profound insight into the key drivers of mechanical failure. The Law of Laplace is a classic example, offering a direct estimate of wall stress from pressure and geometry. This practice  uses this law to explore the critical relationship between wall thickness and stress, and then takes a crucial step further by introducing sensitivity analysis to quantify how unavoidable measurement errors in clinical imaging can impact our stress-based risk assessment.",
            "id": "4153495",
            "problem": "An abdominal aortic aneurysm segment is idealized as a thin-walled cylindrical membrane of radius $r$, wall thickness $t$, and subject to an internal blood pressure $p$. Assume a quasi-static state, negligible axial gradients, and that the wall behaves as a membrane (no bending resistance), with the thin-wall condition $t \\ll r$ satisfied. Starting from force equilibrium on an appropriate free-body diagram of the pressurized cylinder, derive the expression for the circumferential (hoop) Cauchy stress $\\sigma_{\\theta}$ in terms of $p$, $r$, and $t$. Differentiate your result with respect to $t$ to obtain the sensitivity $\\partial \\sigma_{\\theta}/\\partial t$ and explain the physical meaning of its sign in the context of aneurysm wall mechanics.\n\nNow consider a clinical measurement scenario in which the internal pressure is $p = 16.0 \\ \\mathrm{kPa}$, the mean aneurysmal radius is $r = 12.0 \\ \\mathrm{mm}$, and the mean wall thickness is $t = 1.20 \\ \\mathrm{mm}$. Suppose the wall thickness measurement has an unbiased, independent one-standard-deviation uncertainty of $\\sigma_{t} = 0.10 \\ \\mathrm{mm}$ (arising, for example, from ultrasound measurement variability). Using a first-order Taylor expansion (linear uncertainty propagation) about the mean $t$, compute the one-standard-deviation uncertainty in the hoop stress, $\\sigma_{\\sigma_{\\theta}} \\approx \\left| \\frac{\\partial \\sigma_{\\theta}}{\\partial t} \\right| \\sigma_{t}$, attributable to thickness uncertainty alone.\n\nExpress the final numerical value of $\\sigma_{\\sigma_{\\theta}}$ in kilopascals $\\left(\\mathrm{kPa}\\right)$ and round your answer to $4$ significant figures. Provide only this final numerical value. Do not include units in your final reported value.",
            "solution": "The problem statement is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n- **Model**: Thin-walled cylindrical membrane.\n- **Geometric Variables**: radius $r$, wall thickness $t$.\n- **Loading**: Internal blood pressure $p$.\n- **Assumptions**: Quasi-static state, negligible axial gradients, membrane behavior (no bending resistance), thin-wall condition ($t \\ll r$).\n- **Task 1**: Derive the circumferential (hoop) Cauchy stress $\\sigma_{\\theta}$ in terms of $p$, $r$, and $t$.\n- **Task 2**: Derive the sensitivity $\\frac{\\partial \\sigma_{\\theta}}{\\partial t}$ and explain the physical meaning of its sign.\n- **Clinical Data**:\n  - Pressure: $p = 16.0 \\ \\mathrm{kPa}$\n  - Radius: $r = 12.0 \\ \\mathrm{mm}$\n  - Thickness: $t = 1.20 \\ \\mathrm{mm}$\n- **Uncertainty Data**:\n  - One-standard-deviation uncertainty in thickness: $\\sigma_{t} = 0.10 \\ \\mathrm{mm}$.\n- **Task 3**: Compute the one-standard-deviation uncertainty in hoop stress, $\\sigma_{\\sigma_{\\theta}}$, using the first-order approximation $\\sigma_{\\sigma_{\\theta}} \\approx \\left| \\frac{\\partial \\sigma_{\\theta}}{\\partial t} \\right| \\sigma_{t}$.\n- **Final Answer Format**: The numerical value of $\\sigma_{\\sigma_{\\theta}}$ in kilopascals ($\\mathrm{kPa}$), rounded to $4$ significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on fundamental principles of solid mechanics, specifically the force equilibrium analysis of a thin-walled pressure vessel. This model (Laplace's Law for a cylinder) is a standard and widely accepted idealization in biomechanics for analyzing stresses in blood vessels and aneurysms. The provided numerical values for pressure ($16.0 \\ \\mathrm{kPa} \\approx 120 \\ \\mathrm{mmHg}$) and aneurysm dimensions are physiologically realistic. The use of linear uncertainty propagation is a standard method in engineering and experimental science. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly stated and provides all necessary information to perform the derivation and subsequent calculation. The tasks are sequential and lead to a unique, well-defined numerical answer.\n- **Objective**: The language is precise, technical, and free of any subjective or ambiguous terminology.\n- **Completeness and Consistency**: The problem is self-contained. The thin-wall assumption ($t \\ll r$) is consistent with the provided data ($1.20 \\ \\mathrm{mm} \\ll 12.0 \\ \\mathrm{mm}$). The units are consistent, and the requested output unit is specified. No contradictory information is present.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Part 1: Derivation of Hoop Stress $\\sigma_{\\theta}$**\nTo derive the expression for the circumferential or hoop stress, $\\sigma_{\\theta}$, we perform a force equilibrium analysis on a free-body diagram. Consider a segment of the cylinder of length $L$. We imagine cutting this segment in half along a plane that contains the cylinder's central axis.\n\nThe force $F_p$ exerted by the internal pressure $p$ that tends to separate the two halves is equal to the pressure acting on the projected area of the cut plane. The projected area is a rectangle with dimensions $2r \\times L$.\n$$F_p = p \\cdot (2rL)$$\nThis \"bursting\" force must be balanced by the resisting force $F_{wall}$ from the stress within the cylinder wall. The hoop stress $\\sigma_{\\theta}$ acts over the area of the two cut wall sections. Each section has an area of $t \\times L$. Since there are two such sections, the total resisting area is $2tL$.\n$$F_{wall} = \\sigma_{\\theta} \\cdot (2tL)$$\nFor quasi-static equilibrium, these forces must be equal:\n$$F_p = F_{wall}$$\n$$p(2rL) = \\sigma_{\\theta}(2tL)$$\nThe term $2L$ cancels from both sides, yielding the expression for the hoop stress, commonly known as Barlow's formula:\n$$\\sigma_{\\theta} = \\frac{pr}{t}$$\n\n**Part 2: Sensitivity Analysis**\nTo find the sensitivity of the hoop stress with respect to the wall thickness, we differentiate the expression for $\\sigma_{\\theta}$ with respect to $t$, treating $p$ and $r$ as constants.\n$$\\frac{\\partial \\sigma_{\\theta}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\frac{pr}{t}\\right) = pr \\frac{\\partial}{\\partial t} \\left(t^{-1}\\right)$$\nUsing the power rule for differentiation:\n$$\\frac{\\partial \\sigma_{\\theta}}{\\partial t} = pr (-1 \\cdot t^{-2}) = -\\frac{pr}{t^2}$$\nThe sign of this sensitivity is negative. This has a critical physical meaning in the context of aneurysm biomechanics. A negative sign indicates that hoop stress is inversely related to wall thickness. As the aneurysm wall thins (i.e., $t$ decreases), the stress on the wall $\\sigma_{\\theta}$ increases, assuming constant pressure and radius. This creates a dangerous positive feedback loop: wall thinning, perhaps due to enzymatic degradation, leads to higher wall stress, which can accelerate tissue damage and further thinning, progressively increasing the risk of rupture.\n\n**Part 3: Uncertainty Calculation**\nThe problem asks for the one-standard-deviation uncertainty in the hoop stress, $\\sigma_{\\sigma_{\\theta}}$, due to the uncertainty in the wall thickness measurement, $\\sigma_t$. Using the provided first-order Taylor expansion formula:\n$$\\sigma_{\\sigma_{\\theta}} \\approx \\left| \\frac{\\partial \\sigma_{\\theta}}{\\partial t} \\right| \\sigma_{t}$$\nSubstituting the expression for the sensitivity derived in Part 2:\n$$\\sigma_{\\sigma_{\\theta}} = \\left| -\\frac{pr}{t^2} \\right| \\sigma_{t} = \\frac{pr}{t^2} \\sigma_{t}$$\nNow, we substitute the given numerical values:\n- $p = 16.0 \\ \\mathrm{kPa}$\n- $r = 12.0 \\ \\mathrm{mm}$\n- $t = 1.20 \\ \\mathrm{mm}$\n- $\\sigma_t = 0.10 \\ \\mathrm{mm}$\n\nThe units are consistent, as $p$ is in $\\mathrm{kPa}$ and all length dimensions are in $\\mathrm{mm}$. The resulting unit for $\\sigma_{\\sigma_{\\theta}}$ will be:\n$$\\frac{(\\mathrm{kPa}) \\cdot (\\mathrm{mm})}{(\\mathrm{mm})^2} \\cdot (\\mathrm{mm}) = \\mathrm{kPa}$$\nThis matches the requested unit for the final answer, so no unit conversions are necessary.\n\nPerforming the calculation:\n$$\\sigma_{\\sigma_{\\theta}} = \\frac{(16.0) \\cdot (12.0)}{(1.20)^2} \\cdot (0.10)$$\n$$\\sigma_{\\sigma_{\\theta}} = \\frac{192.0}{1.44} \\cdot (0.10)$$\nFirst, evaluate the fraction:\n$$\\frac{192.0}{1.44} = 133.333...$$\nNow, multiply by the uncertainty in thickness:\n$$\\sigma_{\\sigma_{\\theta}} = 133.333... \\cdot (0.10) = 13.333... \\ \\mathrm{kPa}$$\nThe problem requires the final answer to be rounded to $4$ significant figures.\n$$\\sigma_{\\sigma_{\\theta}} \\approx 13.33 \\ \\mathrm{kPa}$$\nThis value represents the estimated standard deviation of the hoop stress that arises solely from the uncertainty in measuring the wall thickness.",
            "answer": "$$\\boxed{13.33}$$"
        },
        {
            "introduction": "Patient-specific computational modeling represents the frontier of aneurysm risk assessment, but its predictions are only reliable if the underlying numerical methods are properly verified. The Finite Element Method (FEM) approximates a continuous problem with a discrete mesh, introducing discretization error. This practice  provides a hands-on guide to a critical validation technique—mesh convergence analysis—allowing you to estimate the true, mesh-independent stress value and quantify the uncertainty in your numerical prediction.",
            "id": "4153466",
            "problem": "Consider the quasi-static wall mechanics of an Abdominal Aortic Aneurysm (AAA), where the Cauchy stress field is governed by continuum equilibrium under internal pressure. For a scalar quantity of interest representing the peak circumferential wall stress at a fixed hotspot, denote this quantity by $S(h)$ as computed by the Finite Element Method (FEM) on a globally quasi-uniform mesh with characteristic size $h$. Assume that for sufficiently small $h$ and a smooth exact solution, the discretization error in $S(h)$ behaves asymptotically as a power law in $h$, consistent with standard a priori convergence theory for elliptic problems. You are provided, for each case, with three successively refined meshes that share a constant refinement ratio $r = h_1/h_2 = h_2/h_3$ and the corresponding computed peak wall stress values. All stresses are in kilopascals and all lengths are in millimeters.\n\nFrom first principles of discretization error analysis, design an algorithm that, for each triplet of $(h_1,h_2,h_3)$ and $(S(h_1),S(h_2),S(h_3))$, estimates:\n- the observed order of convergence $\\hat{p}$,\n- the Richardson-extrapolated stress $S^\\star$ as $h \\to 0$ in $\\text{kPa}$,\n- the error reduction ratios $R_{12}$ and $R_{23}$ defined as $R_{12} = \\lvert S(h_1) - S^\\star \\rvert / \\lvert S(h_2) - S^\\star \\rvert$ and $R_{23} = \\lvert S(h_2) - S^\\star \\rvert / \\lvert S(h_3) - S^\\star \\rvert$ (dimensionless),\n- and the fine-grid Grid Convergence Index (GCI) for the finest two grids (medium and fine) as a decimal (dimensionless) using a safety factor of $1.25$.\n\nYour derivation must start from the continuum equilibrium premise and the asymptotic error model stated above and must not invoke any unsubstantiated formulas as starting points. The program must implement your derived estimator for $\\hat{p}$, $S^\\star$, $R_{12}$, $R_{23}$, and the fine-grid GCI using only the provided data for each case.\n\nExpress the final stress $S^\\star$ in $\\text{kPa}$ and the fine-grid GCI as a decimal (not a percentage). Angles are not used. All outputs must be numeric and dimensionless where appropriate. The program must report outputs for all test cases in a single line as a comma-separated list enclosed in square brackets, where each test case result is a list of five floats in the order $[\\hat{p}, S^\\star, R_{12}, R_{23}, \\text{GCI}_{\\text{fine}}]$. Round each float to exactly $6$ decimal places. For example, the overall output format must be like $[[x_1,x_2,x_3,x_4,x_5],[y_1,y_2,y_3,y_4,y_5],\\dots]$ with each $x_i$ and $y_i$ shown to $6$ decimal places.\n\nTest Suite (use these values exactly as provided):\n- Case A (nominal smooth behavior with superlinear convergence):\n  - Mesh sizes: $[h_1,h_2,h_3] = [1.6, 0.8, 0.4]$ $\\text{mm}$\n  - Computed stresses: $[S(h_1),S(h_2),S(h_3)] = [359.819980, 260.144920, 231.549880]$ $\\text{kPa}$\n- Case B (approximately first-order behavior with monotone increase toward the limit):\n  - Mesh sizes: $[h_1,h_2,h_3] = [1.2, 0.6, 0.3]$ $\\text{mm}$\n  - Computed stresses: $[S(h_1),S(h_2),S(h_3)] = [214.000000, 232.000000, 241.000000]$ $\\text{kPa}$\n- Case C (higher-order behavior with strong refinement effects):\n  - Mesh sizes: $[h_1,h_2,h_3] = [2.0, 1.0, 0.5]$ $\\text{mm}$\n  - Computed stresses: $[S(h_1),S(h_2),S(h_3)] = [865.685425, 400.000000, 317.677670]$ $\\text{kPa}$\n- Case D (near-asymptotic with small data noise):\n  - Mesh sizes: $[h_1,h_2,h_3] = [1.0, 0.5, 0.25]$ $\\text{mm}$\n  - Computed stresses: $[S(h_1),S(h_2),S(h_3)] = [330.300000, 297.277670, 286.450000]$ $\\text{kPa}$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list $[\\hat{p},S^\\star,R_{12},R_{23},\\text{GCI}_{\\text{fine}}]$, with each number rounded to $6$ decimal places.",
            "solution": "The task is to design an algorithm for convergence analysis based on the principles of discretization error in numerical solutions to continuum mechanics problems. The specific context is the Finite Element Method (FEM) applied to Abdominal Aortic Aneurysm (AAA) wall mechanics, but the methodology is general to any numerical method exhibiting asymptotic power-law convergence. We will derive the estimators for the observed order of convergence ($\\hat{p}$), the extrapolated exact solution ($S^\\star$), error reduction ratios ($R_{12}$, $R_{23}$), and the Grid Convergence Index (GCI) from first principles.\n\nThe fundamental premise, as stated in the problem, is that for a scalar quantity of interest $S$ computed on a mesh with characteristic size $h$, the numerical solution $S(h)$ relates to the exact continuum solution, which we denote $S^\\star$, through an asymptotic error expansion. For sufficiently small $h$, this is dominated by the leading term:\n$$ S(h) \\approx S^\\star + C h^p $$\nHere, $C$ is a constant independent of $h$ but dependent on the solution's properties, and $p$ is the theoretical order of convergence of the numerical scheme. We are provided with three solutions from successively refined meshes: a coarse mesh ($h_1, S_1=S(h_1)$), a medium mesh ($h_2, S_2=S(h_2)$), and a fine mesh ($h_3, S_3=S(h_3)$). The meshes share a constant refinement ratio $r = h_1/h_2 = h_2/h_3 > 1$.\n\nApplying the error model to our three data points, we can write a system of three equations with three unknowns ($S^\\star$, $C$, and $p$):\n$$ S_1 = S^\\star + C h_1^p \\quad (1) $$\n$$ S_2 = S^\\star + C h_2^p \\quad (2) $$\n$$ S_3 = S^\\star + C h_3^p \\quad (3) $$\n\nTo estimate the order of convergence, we first eliminate $S^\\star$ by taking the difference between consecutive equations:\n$$ S_1 - S_2 = C (h_1^p - h_2^p) $$\n$$ S_2 - S_3 = C (h_2^p - h_3^p) $$\nUsing the constant refinement ratio, $h_1 = r h_2$ and $h_2 = r h_3$, the equations become:\n$$ S_1 - S_2 = C ((r h_2)^p - h_2^p) = C h_2^p (r^p - 1) \\quad (4) $$\n$$ S_2 - S_3 = C ((r h_3)^p - h_3^p) = C h_3^p (r^p - 1) \\quad (5) $$\nNow, we eliminate the constant $C$ by taking the ratio of equation ($4$) to equation ($5$):\n$$ \\frac{S_1 - S_2}{S_2 - S_3} = \\frac{C h_2^p (r^p - 1)}{C h_3^p (r^p - 1)} = \\frac{h_2^p}{h_3^p} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p $$\nThis provides a direct method to find an estimate for $p$, which we denote as the observed order of convergence, $\\hat{p}$:\n$$ \\hat{p} = \\frac{\\ln\\left(\\frac{S_1 - S_2}{S_2 - S_3}\\right)}{\\ln(r)} $$\nThis estimator requires monotonic convergence, i.e., the term $(S_1 - S_2)/(S_2 - S_3)$ must be positive.\n\nNext, we derive the estimator for the extrapolated exact solution, $S^\\star$, using Richardson Extrapolation. From equation ($5$), we can express $C h_3^p = (S_2 - S_3) / (r^p - 1)$. Substituting this into equation ($3$), where $S_3 = S^\\star + C h_3^p$, we get:\n$$ S_3 = S^\\star + \\frac{S_2 - S_3}{r^p - 1} $$\nSolving for $S^\\star$ and using our estimate $\\hat{p}$ for $p$:\n$$ S^\\star = S_3 - \\frac{S_2 - S_3}{r^{\\hat{p}} - 1} = \\frac{S_3(r^{\\hat{p}} - 1) - (S_2 - S_3)}{r^{\\hat{p}} - 1} = \\frac{r^{\\hat{p}} S_3 - S_2}{r^{\\hat{p}} - 1} $$\nThis formula provides the extrapolated value based on the two finest grid solutions and the observed order of convergence.\n\nThe error reduction ratios are defined as $R_{12} = \\lvert S_1 - S^\\star \\rvert / \\lvert S_2 - S^\\star \\rvert$ and $R_{23} = \\lvert S_2 - S^\\star \\rvert / \\lvert S_3 - S^\\star \\rvert$. Based on our asymptotic model, the error on grid $i$ is $E_i = S_i - S^\\star \\approx C h_i^p$. Therefore, the theoretical value for these ratios is:\n$$ R_{12} = \\frac{\\lvert C h_1^p \\rvert}{\\lvert C h_2^p \\rvert} = \\left(\\frac{h_1}{h_2}\\right)^p = r^p $$\n$$ R_{23} = \\frac{\\lvert C h_2^p \\rvert}{\\lvert C h_3^p \\rvert} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p $$\nWe will compute these ratios using our estimated $S^\\star$ and the given solution values. Their proximity to $r^{\\hat{p}}$ serves as a consistency check for the analysis.\n\nFinally, we derive the formula for the fine-grid Grid Convergence Index, $\\text{GCI}_{\\text{fine}}$. The GCI provides a conservative estimate of the numerical uncertainty in the fine-grid solution ($S_3$). It is defined as a factor of safety, $F_s$, multiplied by the magnitude of the estimated relative error on the fine grid. The estimated absolute error in $S_3$ is $E_3 = S^\\star - S_3$. From our derivation for $S^\\star$, we have $S^\\star - S_3 = (S_3 - S_2) / (r^{\\hat{p}} - 1)$. The GCI is typically expressed relative to the solution magnitude. The problem requests the fine-grid GCI for the grids $h_2$ and $h_3$.\n$$ \\text{GCI}_{\\text{fine}} = F_s \\frac{\\lvert E_3 \\rvert}{\\lvert S_3 \\rvert} = F_s \\frac{\\lvert S^\\star - S_3 \\rvert}{\\lvert S_3 \\rvert} $$\nSubstituting the expression for the error:\n$$ \\text{GCI}_{\\text{fine}} = F_s \\left| \\frac{(S_3 - S_2) / (r^{\\hat{p}} - 1)}{S_3} \\right| = F_s \\left| \\frac{S_3 - S_2}{S_3 (r^{\\hat{p}} - 1)} \\right| $$\nWith the given safety factor $F_s = 1.25$, the final formula is:\n$$ \\text{GCI}_{\\text{fine}} = 1.25 \\left| \\frac{S_3 - S_2}{S_3 (r^{\\hat{p}} - 1)} \\right| $$\n\nThe algorithm to be implemented is as follows:\nFor each test case with inputs $(h_1, h_2, h_3)$ and $(S_1, S_2, S_3)$:\n1.  Calculate the refinement ratio $r = h_1 / h_2$.\n2.  Calculate the observed order of convergence $\\hat{p} = \\ln((S_1 - S_2) / (S_2 - S_3)) / \\ln(r)$.\n3.  Calculate the extrapolated stress $S^\\star = (r^{\\hat{p}} S_3 - S_2) / (r^{\\hat{p}} - 1)$.\n4.  Calculate the error reduction ratios $R_{12} = \\lvert S_1 - S^\\star \\rvert / \\lvert S_2 - S^\\star \\rvert$ and $R_{23} = \\lvert S_2 - S^\\star \\rvert / \\lvert S_3 - S^\\star \\rvert$.\n5.  Calculate the fine-grid GCI $\\text{GCI}_{\\text{fine}} = 1.25 \\times \\lvert (S_3 - S_2) / (S_3 \\times (r^{\\hat{p}} - 1)) \\rvert$.\n6.  Collect the five values $[\\hat{p}, S^\\star, R_{12}, R_{23}, \\text{GCI}_{\\text{fine}}]$ and format as required.\nThis procedure will be applied to each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grid convergence analysis problem for a suite of test cases.\n    The derivation of the formulas is based on the asymptotic error expansion\n    S(h) = S_exact + C*h^p.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        ([1.6, 0.8, 0.4], [359.819980, 260.144920, 231.549880]),\n        # Case B\n        ([1.2, 0.6, 0.3], [214.000000, 232.000000, 241.000000]),\n        # Case C\n        ([2.0, 1.0, 0.5], [865.685425, 400.000000, 317.677670]),\n        # Case D\n        ([1.0, 0.5, 0.25], [330.300000, 297.277670, 286.450000]),\n    ]\n    \n    Fs = 1.25 # Safety factor for GCI\n    results = []\n\n    for case in test_cases:\n        h_vals, s_vals = case\n        h1, h2, h3 = h_vals\n        s1, s2, s3 = s_vals\n\n        # Step 1: Calculate the refinement ratio\n        # The problem states r is constant: r = h1/h2 = h2/h3\n        r = h1 / h2\n\n        # Step 2: Calculate the observed order of convergence, p_hat\n        # p_hat = ln((s1-s2)/(s2-s3)) / ln(r)\n        # Check for division by zero or log of non-positive, although not expected for given data\n        diff_s1_s2 = s1 - s2\n        diff_s2_s3 = s2 - s3\n        \n        # This check is for robustness, though not strictly needed for the given test cases.\n        if diff_s2_s3 == 0:\n            # Handle cases where solution appears converged or is oscillating around a value\n            # For this problem, we assume monotonic convergence and non-zero differences\n            # If s2 == s3, p_hat is undefined. We'd have to use a different method.\n            # A practical choice might be to stop or report an issue. Here we proceed assuming valid inputs.\n            p_hat = np.nan # Or some other indicator of failure\n        else:\n            ratio = diff_s1_s2 / diff_s2_s3\n            if ratio <= 0:\n                # Oscillatory convergence or not in asymptotic range. p_hat is complex or undefined.\n                p_hat = np.nan\n            else:\n                p_hat = np.log(ratio) / np.log(r)\n        \n        # Step 3: Calculate the Richardson-extrapolated stress, s_star\n        # s_star = (r^p_hat * s3 - s2) / (r^p_hat - 1)\n        # also expressed as s_star = s3 + (s3 - s2) / (r^p_hat - 1)\n        r_p = r**p_hat\n        # Check for division by zero, r_p should not be 1 (i.e. p_hat != 0)\n        if (r_p - 1) == 0:\n            s_star = np.nan\n        else:\n            s_star = (r_p * s3 - s2) / (r_p - 1)\n\n        # Step 4: Calculate the error reduction ratios, R12 and R23\n        # R12 = |s1 - s_star| / |s2 - s_star|\n        # R23 = |s2 - s_star| / |s3 - s_star|\n        err1 = s1 - s_star\n        err2 = s2 - s_star\n        err3 = s3 - s_star\n        \n        r12 = np.abs(err1 / err2) if err2 != 0 else np.inf\n        r23 = np.abs(err2 / err3) if err3 != 0 else np.inf\n\n        # Step 5: Calculate the fine-grid Grid Convergence Index (GCI_fine)\n        # GCI_fine = Fs * | (s3 - s2) / (s3 * (r^p_hat - 1)) |\n        if s3 == 0 or (r_p -1) == 0:\n            gci_fine = np.nan\n        else:\n            # Note: s3-s2 = -diff_s2_s3\n            gci_fine = Fs * np.abs( (s3 - s2) / (s3 * (r_p - 1)) )\n\n        current_results = [p_hat, s_star, r12, r23, gci_fine]\n        results.append(current_results)\n\n    # Format output to exactly 6 decimal places per problem requirement\n    all_formatted_results = []\n    for res_list in results:\n        formatted_list_str = f\"[{','.join([f'{val:.6f}' for val in res_list])}]\"\n        all_formatted_results.append(formatted_list_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}