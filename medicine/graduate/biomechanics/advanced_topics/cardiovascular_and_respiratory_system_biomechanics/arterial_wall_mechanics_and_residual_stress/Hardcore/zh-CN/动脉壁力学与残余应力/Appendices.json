{
    "hands_on_practices": [
        {
            "introduction": "动脉壁中残余应力的概念源于一个经典的实验观察：当一个环状的动脉节段被径向切开时，它会自发地弹开成一个扇形。这个练习旨在从运动学的角度，将这个可测量的“开放角”与定义残余应力的基础——残余应变——联系起来。通过从第一性原理推导它们之间的关系，你将掌握量化动脉中固有应力状态的基本方法。",
            "id": "4155794",
            "problem": "一个由 $N$ 个完美粘合的同心层组成的完整动脉环被径向切开，并在无外部载荷和约束的情况下松弛。它打开成一个无应力平面扇形，其张角为 $\\theta_o$，因此该无应力扇形覆盖的极角范围为 $\\theta \\in [0,\\,2\\pi - \\theta_o]$，半径 $r$ 贯穿整个壁厚。在这个无应力扇形中，每一层 $i \\in \\{1,\\dots,N\\}$ 占据一个径向区间 $[a_i,\\,b_i]$。考虑在无摩擦接触、无扭转和轴向平面应变的条件下，将此无应力扇形闭合回完整环（极角范围为 $[0,\\,2\\pi]$）的运动学过程。假设扇形闭合通过一个平滑变形进行，该变形通过重新参数化周向坐标同时保持径向坐标不变（即一个经典的扇形到环的闭合），将无应力扇形映射到闭合环，并假设打开的扇形是所有层的有效无应力参考构型。\n\n从极坐标系下有限变形运动学的第一性原理以及 Hencky（对数）应变的定义出发，为任意层 $i$ 推导一个封闭形式的表达式，该表达式将张角 $\\theta_o$（以弧度为单位）与周向残余 Hencky 应变 $e_{\\theta}^{\\mathrm{res}}$ 联系起来。你的推导必须首先确定周向伸长率，然后计算相应的 Hencky（对数）应变。将你的最终答案表示为一个只含 $\\theta_o$（以弧度为单位）的单一解析表达式。不需要进行数值近似或四舍五入。",
            "solution": "该问题要求为动脉环推导周向残余 Hencky 应变 $e_{\\theta}^{\\mathrm{res}}$ 作为张角 $\\theta_o$ 函数的封闭形式表达式。推导将基于有限变形运动学的原理。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 对象是一个由 $N$ 个完美粘合的同心层组成的完整动脉环。\n- 当径向切开时，它松弛成一个无应力平面扇形。\n- 无应力扇形的张角为 $\\theta_o$（以弧度为单位）。\n- 无应力扇形在极坐标 $(r, \\theta)$ 中描述，其中角度范围为 $\\theta \\in [0, 2\\pi - \\theta_o]$。\n- 在无应力构型中，每一层 $i$ 占据一个径向区间 $[a_i, b_i]$。\n- 所考虑的变形是将无应力扇形闭合回完整环的过程。\n- 完整环的极角范围为 $[0, 2\\pi]$。\n- 闭合运动学的假设：无摩擦接触、无扭转、轴向平面应变。\n- 变形是“经典的扇形到环的闭合”，定义为一个平滑映射，它通过重新参数化周向坐标同时保持径向坐标不变。\n- 打开的扇形是一个有效的无应力参考构型。\n- 使用的应变度量是 Hencky（对数）应变，$e = \\ln(\\lambda)$，其中 $\\lambda$ 是伸长率。\n- $e_{\\theta}^{\\mathrm{res}}$ 的最终表达式必须只用 $\\theta_o$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于动脉力学中公认的“张角”实验，该实验用于量化残余应力。使用有限变形运动学和 Hencky 应变是生物力学中的标准做法。该模型是一个简化，但基于有效的物理和数学原理。\n- **问题适定性：** 问题陈述清晰地定义了初始（参考）构型、最终（当前）构型以及它们之间的运动学映射。这足以唯一地确定变形和由此产生的应变。\n- **客观性：** 问题使用精确、客观和形式化的数学及生物力学术语进行陈述。\n- **缺陷分析：**\n    - 该问题没有科学或事实上的不健全之处。\n    - 这是一个可形式化的问题，是动脉力学主题的核心。\n    - 信息是完整和一致的。提及 $N$ 层和径向区间 $[a_i, b_i]$ 可能看起来是额外信息，但其与最终结果的无关性（由于指定的运动学）是所考察的概念理解的关键部分。问题并非欠定。\n    - “经典闭合”是一个物理上理想化但并非不可能的运动学假设，它使问题变得可解。\n    - 问题结构良好，在给定假设下可以导出一个唯一且有意义的应变解。\n    - 这个问题并非微不足道，因为它需要正确应用有限应变、伸长率和坐标变换的概念。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整的推导过程。\n\n### 求解推导\n\n周向残余应变 $e_{\\theta}^{\\mathrm{res}}$ 产生于将无应力参考构型（打开的扇形）映射到有残余应力的当前构型（闭合的环）的变形过程。我们必须首先确定与此变形相关的周向伸长率 $\\lambda_{\\theta}$。\n\n1.  **确定构型和运动学：**\n    - **参考构型：** 这是无应力扇形。在此构型中，位于给定半径 $r$ 处的一个质点，其周向路径长度为 $L_0(r)$。该扇形跨越的角度为 $2\\pi - \\theta_o$。该周向路径的弧长由微元弧长 $r \\, d\\theta$ 在扇形整个角跨度上的积分给出。\n    $$L_0(r) = \\int_{0}^{2\\pi - \\theta_o} r \\, d\\theta = r(2\\pi - \\theta_o)$$\n\n    - **当前构型：** 这是闭合的完整环。问题指出闭合过程涉及重新参数化周向坐标同时保持径向坐标不变。这意味着扇形中半径为 $r$ 的质点在环中仍然位于半径 $r$ 处。闭合环跨越 $2\\pi$ 的全角。环中半径 $r$ 处的周向路径长度 $L(r)$ 为：\n    $$L(r) = \\int_{0}^{2\\pi} r \\, d\\phi = r(2\\pi)$$\n    其中 $\\phi$ 是闭合环中的角坐标。\n\n2.  **计算周向伸长率 ($\\lambda_{\\theta}$):**\n    周向伸长率 $\\lambda_{\\theta}$ 定义为材料纤维变形后的长度与参考长度之比。由于变形沿周向是均匀的（这是“经典闭合”假设的结果），我们可以使用总周向长度之比。\n    $$\\lambda_{\\theta} = \\frac{L(r)}{L_0(r)} = \\frac{r(2\\pi)}{r(2\\pi - \\theta_o)}$$\n    半径 $r$ 被消去，这是一个关键结果。\n    $$\\lambda_{\\theta} = \\frac{2\\pi}{2\\pi - \\theta_o}$$\n    这表明在指定的运动学映射下，周向伸长率在整个壁厚上是均匀的。它与径向位置 $r$ 无关。因此，对于所有层 $i \\in \\{1, \\dots, N\\}$，所产生的残余应变都是相同的。\n\n3.  **计算 Hencky（对数）应变 ($e_{\\theta}^{\\mathrm{res}}$):**\n    Hencky 应变，也称为对数应变或真实应变，定义为伸长率的自然对数。因此，周向残余 Hencky 应变为：\n    $$e_{\\theta}^{\\mathrm{res}} = \\ln(\\lambda_{\\theta})$$\n    代入 $\\lambda_{\\theta}$ 的表达式：\n    $$e_{\\theta}^{\\mathrm{res}} = \\ln\\left(\\frac{2\\pi}{2\\pi - \\theta_o}\\right)$$\n    利用对数的性质，该表达式可以等价地写为：\n    $$e_{\\theta}^{\\mathrm{res}} = \\ln(2\\pi) - \\ln(2\\pi - \\theta_o) = -\\ln\\left(\\frac{2\\pi - \\theta_o}{2\\pi}\\right) = -\\ln\\left(1 - \\frac{\\theta_o}{2\\pi}\\right)$$\n    这个最终表达式按照问题陈述的要求，将周向残余 Hencky 应变与张角 $\\theta_o$ 直接联系起来。该表达式与任何其他参数（如具体层或径向位置）无关。这是预设运动学的直接结果。\n\n作为一致性检验，如果张角 $\\theta_o = 0$，则意味着没有残余应力。该公式给出 $e_{\\theta}^{\\mathrm{res}} = \\ln(1) = 0$，这是正确的。如果 $\\theta_o > 0$，对数的参数大于 $1$，所以 $e_{\\theta}^{\\mathrm{res}} > 0$。这表明相对于其无应力长度，闭合环中的周向纤维处于拉伸状态，这与拉伸纤维以闭合间隙的物理情况相符。",
            "answer": "$$\n\\boxed{\n\\ln\\left(\\frac{2\\pi}{2\\pi - \\theta_o}\\right)\n}\n$$"
        },
        {
            "introduction": "在分析动脉力学时，一个常见的起点是将其简化为一个薄壁受压圆筒。这个模型由拉普拉斯定律描述，它将压力与壁内的周向应力联系起来。本练习要求你从静态平衡的基本原理出发，推导该定律，并批判性地分析其在应用于真实动脉时的局限性，从而深刻理解为何需要更复杂的模型来考虑残余应力、有限壁厚和材料各向异性等因素。",
            "id": "4155842",
            "problem": "考虑一段理想化为薄膜的长圆形圆柱动脉段，其内半径为 $r$、壁厚为 $t$、长度为 $L$，承受均匀内压 $p$。设环向 Cauchy 应力分量为 $\\sigma_{\\theta\\theta}$，并假设轴对称。从当前构型下的静力平衡原理（Cauchy 动量平衡）和切割表面上的面力定义出发，不引用任何预先推导的薄壁公式，推导一个用 $p$、$r$ 和 $t$ 表示的薄壁圆柱体壁厚平均环向 Cauchy 应力 $\\sigma_{\\theta\\theta}$ 的解析表达式。在推导过程中：\n\n- 清楚地陈述得出所谓圆柱拉普拉斯定律 (Laplace law) 的最小假设，包括将三维问题简化为薄膜力平衡所需的几何、运动学、载荷和材料的理想化假设。\n- 指出并解释这些假设对于真实动脉的局限性，特别关注残余应力（例如，以张开角 $\\theta_o$ 为特征的“开环法”）、有限壁厚、各层（内膜、中膜、外膜）的各向异性和非均质性、轴向预拉伸以及动态效应。\n- 使用自由体受力分析，将内表面上的压力积分，并使其与适当切割表面上的薄膜力平衡，明确展示合力是如何从第一性原理计算的。\n\n如果进行数值计算，最终应力用帕斯卡（Pascals）表示；但请提供仅包含 $p$、$r$ 和 $t$ 的闭式解析表达式作为最终答案。不需要进行数值代入，也不需要四舍五入。您的最终答案必须是单个解析表达式。",
            "solution": "该问题陈述被评估为有效。它以连续介质力学原理为科学基础，问题提法适定，提供了足够的信息来推导所要求的表达式，并且其表述是客观的。它要求从第一性原理进行基本推导，分析简化假设，并讨论这些假设在动脉生物力学背景下的局限性，这些都是该领域问题的标准和严谨组成部分。\n\n目标是推导一个薄壁圆柱膜在均匀内压 $p$ 作用下的壁厚平均环向 Cauchy 应力（此处记为 $\\langle \\sigma_{\\theta\\theta} \\rangle$）的解析表达式，其内半径为 $r$，壁厚为 $t$。推导将基于静力平衡原理。\n\n我们首先考虑一段长度为 $L$ 的圆柱体的自由体图。我们想象沿纵向切开圆柱体，将其分成两半。我们分析其中一半的平衡状态。让我们建立一个笛卡尔坐标系 $(x, y, z)$，使得 $z$ 轴与圆柱体的中心轴重合。纵向切口位于 $x-z$ 平面，对应于圆柱坐标系 $(R, \\theta, z)$ 中的环向角 $\\theta=0$ 和 $\\theta=\\pi$。作用在这个半圆柱体上的力在 $y$ 方向上必须平衡以满足静力平衡。需要考虑两种力：内压作用在内表面上的力，以及环向应力作用在切口处管壁上的力。\n\n1.  **由内压产生的力 ($F_p$)**:\n    内压 $p$ 垂直作用于圆柱体的内表面。由压力产生的面力矢量为 $\\vec{T}^{(p)} = p \\vec{e}_R$，其中 $\\vec{e}_R$ 是向外的径向单位矢量。该力是此面力在内半圆柱表面积 $S_{inner}$ 上的积分。\n    $$ \\vec{F}_p = \\int_{S_{inner}} \\vec{T}^{(p)} dS $$\n    在圆柱坐标系中，面元为 $dS = r \\, d\\theta \\, dz$。径向单位矢量可以用笛卡尔坐标表示为 $\\vec{e}_R = \\cos\\theta \\, \\vec{e}_x + \\sin\\theta \\, \\vec{e}_y$。我们关心的是 $y$ 方向上的力分量，它必须与管壁中的应力相平衡。\n    $$ F_{p,y} = \\int_{0}^{L} \\int_{0}^{\\pi} (p \\vec{e}_R \\cdot \\vec{e}_y) \\, r \\, d\\theta \\, dz $$\n    由于 $\\vec{e}_R \\cdot \\vec{e}_y = \\sin\\theta$，积分变为：\n    $$ F_{p,y} = \\int_{0}^{L} \\int_{0}^{\\pi} p r \\sin\\theta \\, d\\theta \\, dz $$\n    首先对 $\\theta$ 积分：\n    $$ \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = [-\\cos\\theta]_{0}^{\\pi} = -(-1) - (-1) = 2 $$\n    现在对 $z$ 积分：\n    $$ F_{p,y} = \\int_{0}^{L} p r (2) \\, dz = 2prL $$\n    这个结果等效于压力 $p$ 作用在内表面在切割平面上的投影面积上，该投影面积是一个尺寸为 $2r \\times L$ 的矩形。\n\n2.  **由管壁应力产生的力 ($F_\\sigma$)**:\n    环向应力 $\\sigma_{\\theta\\theta}$ 作用在管壁的两个切面上。每个切面的面积是 $A_{wall} = t \\times L$。应力作用的总面积是 $2tL$。一般来说，应力 $\\sigma_{\\theta\\theta}$ 是径向位置的函数，即 $\\sigma_{\\theta\\theta}(R)$。问题要求的是壁厚平均应力 $\\langle \\sigma_{\\theta\\theta} \\rangle$。\n    由该应力产生、作用在 $y$ 方向上并与压力相抗衡的力是：\n    $$ F_\\sigma = \\langle \\sigma_{\\theta\\theta} \\rangle \\times (\\text{总切面面积}) = \\langle \\sigma_{\\theta\\theta} \\rangle (2tL) $$\n\n3.  **静力平衡**:\n    为使物体处于静力平衡状态，$y$ 方向上的力之和必须为零。\n    $$ \\sum F_y = F_{p,y} - F_\\sigma = 0 $$\n    $$ 2prL - \\langle \\sigma_{\\theta\\theta} \\rangle (2tL) = 0 $$\n    求解平均环向应力 $\\langle \\sigma_{\\theta\\theta} \\rangle$：\n    $$ \\langle \\sigma_{\\theta\\theta} \\rangle (2tL) = 2prL $$\n    $$ \\langle \\sigma_{\\theta\\theta} \\rangle = \\frac{2prL}{2tL} = \\frac{pr}{t} $$\n    对于薄壁结构，通常假设应力在整个厚度上是均匀的，因此我们可以简单地将其表示为 $\\sigma_{\\theta\\theta}$。该表达式通常被称为薄壁圆柱体的拉普拉斯定律 (Law of Laplace)。\n\n此推导所需的最小假设是：\n-   **几何假设：** 管壁很薄（$t \\ll r$）。这是最关键的假设，因为它使得将应力视为厚度上均匀分布，并使用内半径 $r$ 计算压力而不会引入与使用平均半径相比的显著误差是合理的。结构是理想的长圆柱体，从而可以忽略端部效应。\n-   **载荷假设：** 内压 $p$ 是静态且空间均匀的。体力可以忽略不计。\n-   **材料/对称性假设：** 问题是轴对称的，意味着应力不随环向位置 $\\theta$ 变化。对于具有均匀材料属性和均匀压力的理想圆柱几何体，这一点可以得到保证。推导本身基于平衡，不需要特定的材料本构定律（例如，弹性），但对单一应力值 $\\sigma_{\\theta\\theta}$ 的解释意味着材料的均质性。\n\n该模型对于真实动脉的局限性是显著的：\n-   **残余应力：** 动脉表现出残余应力。当一个环形节段被径向切开时，它会弹开成一个圆弧，其特征是一个“张开角”$\\theta_o$。这表明，在无载荷状态下，动脉壁的内层处于受压状态，而外层处于受拉状态。这种预先存在的应力状态具有在负载下使整个壁厚的应力分布均匀化的关键生理功能。从无应力初始状态推导出的拉普拉斯公式忽略了这一点，因此高估了穿过壁厚的应力梯度。\n-   **有限壁厚：** 动脉中壁厚与半径之比（$t/r$）通常在 0.1 到 0.2 的范围内，这在工程意义上并不算“薄”。因此，薄壁假设是一个显著的简化。厚壁分析（例如，使用 Lamé 方程）表明，应力并非均匀分布，而是在内壁（内膜）处达到峰值，并向外壁（外膜）递减。\n-   **各向异性和非均质性：** 动脉组织是一种生物复合材料，而不是各向同性、均质的材料。它由三个不同的层组成：内膜、中膜和外膜，每一层都具有独特的力学性能。此外，中膜和外膜包含以特定（通常是螺旋状）模式取向的弹性蛋白和胶原纤维。这种结构使得管壁具有强烈的各向异性，意味着其在环向、轴向和径向上的刚度和强度都不同。简单的拉普拉斯公式无法解释这种复杂性。\n-   **轴向预拉伸：** 在体内，动脉承受着显著的轴向拉伸（预拉伸）。这会产生轴向应力 $\\sigma_{zz}$，并通过几何和材料耦合影响环向应力 $\\sigma_{\\theta\\theta}$。这里提出的一维力平衡忽略了这种多轴应力状态。\n-   **动态效应：** 血压不是静态的，而是脉动性的。这种动态载荷会引入惯性力（通常很小），更重要的是，会涉及到动脉壁的粘弹性特性。粘弹性意味着材料的响应是速率依赖的，表现出诸如蠕变和应力松弛等现象，这些都无法通过静力平衡分析来捕捉。\n\n推导出的平均环向应力的最终表达式是：\n$\\sigma_{\\theta\\theta} = \\frac{pr}{t}$",
            "answer": "$$\n\\boxed{\\frac{pr}{t}}\n$$"
        },
        {
            "introduction": "我们已经知道残余应力的存在，并且认识到简单的力学模型因忽略它而存在不足。那么，残余应力在生理上究竟有何作用？这个计算练习将通过一个厚壁圆筒模型，直观地揭示残余应力的关键功能。通过叠加一个自平衡的残余应力场，你将能够量化比较有无残余应力时，动脉壁内应力梯度的变化，从而亲身体验残余应力是如何使跨壁应力分布更均匀，保护血管内壁免受过度负荷的。",
            "id": "4155827",
            "problem": "考虑一个模拟为厚壁、轴对称圆柱体的动脉，该动脉处于静态平衡状态，受到内压作用，并可能存在自平衡的残余应力场。假设为小应变、线弹性，并且沿轴向为平面应变。忽略体力。设内半径为 $a$，外半径为 $b$，其中 $0 < a < b$。设内压为 $P$（作用于 $r=a$），外压为 $0$（作用于 $r=b$）。令 $\\sigma_{rr}(r)$ 表示径向应力，$\\sigma_{\\theta\\theta}(r)$ 表示环向（周向）应力。在径向坐标 $r$ 中的轴对称平衡方程为\n$$\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0.$$\n加载构型的边界条件为 $\\sigma_{rr}(a) = -P$ 和 $\\sigma_{rr}(b) = 0$。\n\n定义残余径向应力场（在无外部载荷的情况下）为以下族函数\n$$\\sigma_{rr}^{\\mathrm{res}}(r) = A + B \\ln r + D (\\ln r)^2,$$\n其中 $D$ 的单位是压力，参数 $A$ 和 $B$ 必须被确定，以使残余场是自平衡的，且边界无面力，即 $\\sigma_{rr}^{\\mathrm{res}}(a) = 0$ 和 $\\sigma_{rr}^{\\mathrm{res}}(b) = 0$。使用平衡方程确定相应的残余环向应力 $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$。\n\n从平衡定律和给定的边界条件出发，推导在以下两种构型下壁内的环向应力 $\\sigma_{\\theta\\theta}(r)$：\n- 无残余应力：仅存在内压 $P$。\n- 有残余应力：总应力是加载应力场和自平衡残余应力场的叠加。\n\n然后，对于每种构型，计算环向应力在 $r \\in [a,b]$ 上的最大径向梯度绝对值，即\n$$G = \\max_{r\\in[a,b]} \\left| \\frac{d\\sigma_{\\theta\\theta}}{dr}(r) \\right|,$$\n单位为帕斯卡每米（$\\mathrm{Pa/m}$）。您必须将 $r$ 视为区间 $[a,b]$ 上的连续变量；您的算法可以通过离散化 $r$ 来近似最大值。\n\n您的程序必须：\n- 实现上述推导并计算两种构型下的 $\\sigma_{\\theta\\theta}(r)$。\n- 计算每种情况下的最大绝对梯度值 $G_{\\mathrm{nores}}$ 和 $G_{\\mathrm{withres}}$，单位为 $\\mathrm{Pa/m}$。\n- 生成单行输出，包含结果，格式为一个逗号分隔的双元素列表的列表，每个内部列表为 $[G_{\\mathrm{nores}},G_{\\mathrm{withres}}]$，两个值都四舍五入到六位小数。\n\n使用以下参数集测试套件，其中半径单位为米，压力单位为帕斯卡：\n1. $a = 4\\times 10^{-3}\\,\\mathrm{m}$, $b = 8\\times 10^{-3}\\,\\mathrm{m}$, $P = 13332\\,\\mathrm{Pa}$, $D = 1000\\,\\mathrm{Pa}$。\n2. $a = 9\\times 10^{-3}\\,\\mathrm{m}$, $b = 10\\times 10^{-3}\\,\\mathrm{m}$, $P = 13332\\,\\mathrm{Pa}$, $D = 500\\,\\mathrm{Pa}$。\n3. $a = 3\\times 10^{-3}\\,\\mathrm{m}$, $b = 12\\times 10^{-3}\\,\\mathrm{m}$, $P = 13332\\,\\mathrm{Pa}$, $D = -1500\\,\\mathrm{Pa}$。\n4. $a = 5\\times 10^{-3}\\,\\mathrm{m}$, $b = 9\\times 10^{-3}\\,\\mathrm{m}$, $P = 16000\\,\\mathrm{Pa}$, $D = 0\\,\\mathrm{Pa}$。\n5. $a = 3\\times 10^{-3}\\,\\mathrm{m}$, $b = 6\\times 10^{-3}\\,\\mathrm{m}$, $P = 20000\\,\\mathrm{Pa}$, $D = 800\\,\\mathrm{Pa}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表，每个元素是对应一个测试用例的两个梯度值列表（单位为 $\\mathrm{Pa/m}$），并四舍五入到六位小数。例如，输出格式必须类似于 $[[x_1,y_1],[x_2,y_2],\\dots]$，逗号后没有空格。",
            "solution": "该问题要求在厚壁动脉模型中，推导并计算环向应力的最大径向梯度绝对值 $G = \\max_{r \\in [a,b]} \\left| d\\sigma_{\\theta\\theta}/dr \\right|$。我们将分析两种情况：一种无残余应力，另一种有指定的残余应力场。该分析基于线弹性原理，适用于平面应变条件下的轴对称圆柱体。\n\n忽略体力时，径向静态平衡的控制方程如下：\n$$ \\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0 $$\n该方程可以重新排列，用径向应力 $\\sigma_{rr}$ 来表示环向应力 $\\sigma_{\\theta\\theta}$：\n$$ \\sigma_{\\theta\\theta}(r) = \\sigma_{rr}(r) + r \\frac{d\\sigma_{rr}}{dr} $$\n\n### 第1部分：无残余应力分析（Lamé 问题）\n\n首先，我们考虑仅受内压 $P$ 作用的动脉。这种情况下的应力场用上标 'L' 表示。该问题构成了一个经典的厚壁圆柱体 Lamé 问题。应力分量的通解为：\n$$ \\sigma_{rr}^{\\mathrm{L}}(r) = C_1 - \\frac{C_2}{r^2} $$\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{L}}(r) = C_1 + \\frac{C_2}{r^2} $$\n其中 $C_1$ 和 $C_2$ 是待定常数，由边界条件确定。\n\n加载构型的边界条件为内半径 $r=a$ 处有内压 $P$，外半径 $r=b$ 处外压为零：\n$$ \\sigma_{rr}^{\\mathrm{L}}(a) = -P $$\n$$ \\sigma_{rr}^{\\mathrm{L}}(b) = 0 $$\n应用这些条件，得到一个关于 $C_1$ 和 $C_2$ 的二元线性方程组：\n\\begin{align*} C_1 - \\frac{C_2}{a^2} = -P \\\\ C_1 - \\frac{C_2}{b^2} = 0 \\end{align*}\n从第二个方程，我们得到 $C_1 = C_2/b^2$。将其代入第一个方程：\n$$ \\frac{C_2}{b^2} - \\frac{C_2}{a^2} = -P \\implies C_2 \\left( \\frac{a^2 - b^2}{a^2 b^2} \\right) = -P $$\n求解 $C_2$ 得：\n$$ C_2 = \\frac{P a^2 b^2}{b^2 - a^2} $$\n对于 $C_1$：\n$$ C_1 = \\frac{C_2}{b^2} = \\frac{P a^2}{b^2 - a^2} $$\n将这些常数代回，我们得到压力引起的应力表达式：\n$$ \\sigma_{rr}^{\\mathrm{L}}(r) = \\frac{P a^2}{b^2 - a^2} \\left( 1 - \\frac{b^2}{r^2} \\right) $$\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{L}}(r) = \\frac{P a^2}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) $$\n为求环向应力的梯度，我们对 $\\sigma_{\\theta\\theta}^{\\mathrm{L}}(r)$ 关于 $r$ 求导：\n$$ \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{L}}}{dr} = \\frac{d}{dr} \\left[ \\frac{P a^2}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\right] = \\frac{P a^2 b^2}{b^2 - a^2} \\left( - \\frac{2}{r^3} \\right) = -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} $$\n我们需要在区间 $r \\in [a, b]$ 上找到该梯度的最大绝对值 $G_{\\mathrm{nores}}$。\n$$ G_{\\mathrm{nores}} = \\max_{r \\in [a,b]} \\left| -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} \\right| = \\frac{2 P a^2 b^2}{b^2 - a^2} \\max_{r \\in [a,b]} \\left( \\frac{1}{r^3} \\right) $$\n由于 $r > 0$，函数 $1/r^3$ 是严格递减的。它在区间 $[a, b]$ 上的最大值出现在左端点 $r=a$ 处。因此：\n$$ G_{\\mathrm{nores}} = \\frac{2 P a^2 b^2}{(b^2 - a^2) a^3} = \\frac{2 P b^2}{a(b^2 - a^2)} $$\n这为无残余应力情况下的最大梯度提供了一个解析公式。\n\n### 第2部分：有残余应力分析\n\n总应力场被假定为压力诱导场（第1部分）和自平衡残余应力场（用上标 'res' 表示）的线性叠加。\n$$ \\sigma_{ij} = \\sigma_{ij}^{\\mathrm{L}} + \\sigma_{ij}^{\\mathrm{res}} $$\n残余径向应力由 $\\sigma_{rr}^{\\mathrm{res}}(r) = A + B \\ln r + D (\\ln r)^2$ 给出。该应力场必须是自平衡的，意味着它在边界上不产生净力。这通过无面力边界条件来强制实现：\n$$ \\sigma_{rr}^{\\mathrm{res}}(a) = 0 $$\n$$ \\sigma_{rr}^{\\mathrm{res}}(b) = 0 $$\n这导出了一个关于系数 $A$ 和 $B$ 的方程组（其中 $D$ 是一个给定参数）：\n\\begin{align*} A + B \\ln a + D (\\ln a)^2 = 0 \\\\ A + B \\ln b + D (\\ln b)^2 = 0 \\end{align*}\n解此方程组得：\n$$ B = -D (\\ln a + \\ln b) = -D \\ln(ab) $$\n$$ A = D \\ln a \\ln b $$\n因此，残余径向应力被完全确定：\n$$ \\sigma_{rr}^{\\mathrm{res}}(r) = D \\left[ (\\ln r)^2 - (\\ln a + \\ln b) \\ln r + \\ln a \\ln b \\right] = D (\\ln r - \\ln a)(\\ln r - \\ln b) $$\n相应的残余环向应力 $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$ 可由平衡方程求得：\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{res}}(r) = \\sigma_{rr}^{\\mathrm{res}}(r) + r \\frac{d\\sigma_{rr}^{\\mathrm{res}}}{dr} $$\n首先，我们计算 $\\sigma_{rr}^{\\mathrm{res}}(r)$ 的导数：\n$$ \\frac{d\\sigma_{rr}^{\\mathrm{res}}}{dr} = \\frac{d}{dr} \\left[ A + B \\ln r + D (\\ln r)^2 \\right] = \\frac{B}{r} + \\frac{2D \\ln r}{r} $$\n将此代入 $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$ 的表达式：\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{res}}(r) = \\left( A + B \\ln r + D (\\ln r)^2 \\right) + r \\left( \\frac{B}{r} + \\frac{2D \\ln r}{r} \\right) = (A+B) + (B+2D) \\ln r + D (\\ln r)^2 $$\n总环向应力为 $\\sigma_{\\theta\\theta}(r) = \\sigma_{\\theta\\theta}^{\\mathrm{L}}(r) + \\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$。其梯度为：\n$$ \\frac{d\\sigma_{\\theta\\theta}}{dr} = \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{L}}}{dr} + \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{res}}}{dr} $$\n我们必须求出 $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$ 的导数：\n$$ \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{res}}}{dr} = \\frac{d}{dr} \\left[ (A+B) + (B+2D) \\ln r + D (\\ln r)^2 \\right] = \\frac{B+2D}{r} + \\frac{2D \\ln r}{r} = \\frac{1}{r} \\left( B + 2D + 2D \\ln r \\right) $$\n代入 $B = -D(\\ln a + \\ln b)$：\n$$ \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{res}}}{dr} = \\frac{D}{r} \\left( -(\\ln a + \\ln b) + 2 + 2 \\ln r \\right) = \\frac{2D}{r} \\left( 1 + \\ln r - \\frac{\\ln a + \\ln b}{2} \\right) = \\frac{2D}{r} \\left( 1 + \\ln\\left(\\frac{r}{\\sqrt{ab}}\\right) \\right) $$\n总环向应力梯度是载荷诱导梯度和残余梯度之和：\n$$ \\frac{d\\sigma_{\\theta\\theta}}{dr}(r) = -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} + \\frac{2D}{r} \\left( 1 + \\ln\\left(\\frac{r}{\\sqrt{ab}}\\right) \\right) $$\n为了找到 $G_{\\mathrm{withres}} = \\max_{r \\in [a,b]} \\left| \\frac{d\\sigma_{\\theta\\theta}}{dr}(r) \\right|$，我们必须找到这个函数绝对值的最大值。与无残余应力的情况不同，最大值的位置不是显而易见的，解析地求解需要解一个超越方程。根据问题陈述的许可，我们将使用数值方法。我们将把区间 $[a, b]$ 离散成一个密集的点网格，在每个点上计算梯度的绝对值，并找出最大值。\n\n### 第3部分：计算策略\n\n该算法将为给定的参数集 $\\{a, b, P, D\\}$ 实现所推导的公式。\n1.  使用解析公式计算 $G_{\\mathrm{nores}}$：\n    $$ G_{\\mathrm{nores}} = \\frac{2 P b^2}{a(b^2 - a^2)} $$\n2.  数值计算 $G_{\\mathrm{withres}}$：\n    a. 在区间 $[a, b]$ 中创建一个密集的 $r$ 值网格。\n    b. 对于网格中的每个 $r$，计算总环向应力梯度：\n       $$ f(r) = -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} + \\frac{2D}{r} \\left( 1 + \\ln\\left(\\frac{r}{\\sqrt{ab}}\\right) \\right) $$\n    c. 在网格上找到 $|f(r)|$ 的最大值。这作为 $G_{\\mathrm{withres}}$ 的近似值。\n当 $D=0$ 时会出现一个特殊情况。在这种情况下，残余应力场恒为零（$\\sigma_{ij}^{\\mathrm{res}} = 0$），总梯度简化为 Lamé 梯度。因此，我们必须得到 $G_{\\mathrm{withres}} = G_{\\mathrm{nores}}$。这为实现提供了一个合适的检验。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the arterial mechanics problem for a given set of test cases.\n\n    The function calculates the maximum absolute radial gradient of the hoop stress\n    for an artery model under two conditions:\n    1. Without residual stress (G_nores), based on the Lamé solution.\n    2. With a superimposed self-equilibrated residual stress field (G_withres).\n\n    The results are formatted and printed as a single-line list of lists.\n    \"\"\"\n    # Test suite from the problem statement: (a, b, P, D)\n    # a: inner radius (m), b: outer radius (m), P: internal pressure (Pa), D: residual stress parameter (Pa)\n    test_cases = [\n        (4e-3, 8e-3, 13332, 1000),\n        (9e-3, 10e-3, 13332, 500),\n        (3e-3, 12e-3, 13332, -1500),\n        (5e-3, 9e-3, 16000, 0),\n        (3e-3, 6e-3, 20000, 800)\n    ]\n\n    all_results = []\n\n    for a, b, P, D in test_cases:\n        # Case 1: No residual stress\n        # G_nores = max |d(sigma_theta_theta^L)/dr|\n        # From the analytical derivation, the maximum occurs at r=a:\n        # G_nores = 2 * P * b**2 / (a * (b**2 - a**2))\n        G_nores = (2 * P * b**2) / (a * (b**2 - a**2))\n\n        # Case 2: With residual stress\n        # The maximum absolute gradient is found numerically by discretizing the domain.\n        num_points = 100001\n        r = np.linspace(a, b, num_points)\n\n        # Gradient of hoop stress from pressure loading (Lamé solution derivative)\n        # d(sigma_theta_theta^L)/dr = -2 * (P * a**2 * b**2) / ((b**2 - a**2) * r**3)\n        b2_minus_a2 = b**2 - a**2\n        grad_lame = - (2 * P * a**2 * b**2) / (b2_minus_a2 * r**3)\n\n        # Gradient of hoop stress from the residual stress field\n        # d(sigma_theta_theta^res)/dr = (2*D/r) * (1 + log(r / sqrt(a*b)))\n        # Handle the D=0 case separately to avoid unnecessary computation.\n        if D != 0:\n            # np.log is the natural logarithm (ln)\n            sqrt_ab = np.sqrt(a * b)\n            grad_res = (2 * D / r) * (1 + np.log(r / sqrt_ab))\n        else:\n            # If D=0, the residual stress field and its gradient are zero.\n            grad_res = 0.0\n\n        # The total gradient is the superposition of the two components.\n        grad_total = grad_lame + grad_res\n\n        # Find the maximum absolute value of the total gradient on the discretized domain.\n        G_withres = np.max(np.abs(grad_total))\n        \n        all_results.append([G_nores, G_withres])\n\n    # Format the output string as per the specified requirements:\n    # A comma-separated list of [G_nores, G_withres] pairs, with values\n    # rounded to six decimal places, enclosed in brackets.\n    # e.g., [[x1,y1],[x2,y2],...]\n    formatted_results = []\n    for res_pair in all_results:\n        formatted_results.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}