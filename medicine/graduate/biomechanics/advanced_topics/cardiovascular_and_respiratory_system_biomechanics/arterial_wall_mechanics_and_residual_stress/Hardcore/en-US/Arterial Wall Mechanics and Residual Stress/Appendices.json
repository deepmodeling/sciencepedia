{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration with the most fundamental model for stress in a pressurized vessel. This exercise challenges you to derive the classic Law of Laplace from the first principles of static equilibrium. More importantly, it prompts a critical evaluation of the model's underlying assumptions, revealing why such a simplified approach is insufficient for the complex biomechanical environment of real arteries and setting the stage for the necessity of concepts like residual stress .",
            "id": "4155842",
            "problem": "Consider a long, circular cylindrical arterial segment idealized as a membrane with inner radius $r$, wall thickness $t$, and length $L$, subjected to a uniform internal pressure $p$. Let the circumferential Cauchy stress component be denoted by $\\sigma_{\\theta\\theta}$ and assume axisymmetry. Starting from the principles of static equilibrium in the current configuration (Cauchy momentum balance) and the definition of traction on a cut surface, and without invoking any pre-derived thin-wall formulas, derive an analytical expression for the thickness-averaged circumferential Cauchy stress $\\sigma_{\\theta\\theta}$ in terms of $p$, $r$, and $t$ for a thin-walled cylinder. In doing so:\n\n- State clearly the minimal assumptions that lead to the so-called Laplace law for a cylinder, including geometric, kinematic, loading, and material idealizations required to reduce the three-dimensional problem to a membrane force balance.\n- Identify and explain the limitations of these assumptions for real arteries, with specific attention to residual stress (e.g., the opening-angle method characterized by an opening angle $\\alpha$), finite wall thickness, anisotropy and heterogeneity across layers (intima, media, adventitia), axial pre-stretch, and dynamic effects.\n- Use a free-body argument that integrates pressure traction over the inner surface and balances it with membrane traction on an appropriate cut surface, explicitly showing how the resultant forces are computed from first principles.\n\nExpress the final stress in Pascals if a numerical evaluation were to be performed; however, provide the final answer as a closed-form analytical expression involving only $p$, $r$, and $t$. No numerical substitution is required and no rounding is needed. Your final answer must be a single analytical expression.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of continuum mechanics, is well-posed with sufficient information to derive the requested expression, and is objective in its formulation. It requests a fundamental derivation from first principles, an analysis of the simplifying assumptions, and a discussion of their limitations in the context of arterial biomechanics, which are all standard and rigorous components of a problem in this field.\n\nThe objective is to derive an analytical expression for the thickness-averaged circumferential Cauchy stress, denoted here as $\\langle \\sigma_{\\theta\\theta} \\rangle$, in a thin-walled cylindrical membrane of inner radius $r$ and thickness $t$, subjected to a uniform internal pressure $p$. The derivation will be based on the principle of static equilibrium.\n\nWe begin by considering a free-body diagram of a segment of the cylinder of length $L$. We imagine making a longitudinal cut through the cylinder, splitting it into two halves. We analyze the equilibrium of one of these halves. Let us establish a Cartesian coordinate system $(x, y, z)$ such that the $z$-axis coincides with the cylinder's central axis. The longitudinal cut is made in the $x-z$ plane, corresponding to circumferential angles $\\theta=0$ and $\\theta=\\pi$ in a cylindrical coordinate system $(R, \\theta, z)$. The forces acting on this semi-cylindrical body must balance in the $y$-direction for static equilibrium. There are two forces to consider: the force exerted by the internal pressure on the inner surface, and the force exerted by the circumferential stress within the wall at the cut surfaces.\n\n1.  **Force due to Internal Pressure ($F_p$)**:\n    The internal pressure $p$ acts normal to the inner surface of the cylinder. The traction vector due to pressure is $\\vec{T}^{(p)} = p \\vec{e}_R$, where $\\vec{e}_R$ is the outward-pointing radial unit vector. The force is the integral of this traction over the inner semicircular surface area $S_{inner}$.\n    $$ \\vec{F}_p = \\int_{S_{inner}} \\vec{T}^{(p)} dS $$\n    The differential surface element in cylindrical coordinates is $dS = r \\, d\\theta \\, dz$. The radial unit vector can be expressed in Cartesian coordinates as $\\vec{e}_R = \\cos\\theta \\, \\vec{e}_x + \\sin\\theta \\, \\vec{e}_y$. We are interested in the component of the force in the $y$-direction, which must balance the stress in the wall.\n    $$ F_{p,y} = \\int_{0}^{L} \\int_{0}^{\\pi} (p \\vec{e}_R \\cdot \\vec{e}_y) \\, r \\, d\\theta \\, dz $$\n    Since $\\vec{e}_R \\cdot \\vec{e}_y = \\sin\\theta$, the integral becomes:\n    $$ F_{p,y} = \\int_{0}^{L} \\int_{0}^{\\pi} p r \\sin\\theta \\, d\\theta \\, dz $$\n    Integrating with respect to $\\theta$ first:\n    $$ \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = [-\\cos\\theta]_{0}^{\\pi} = -(-1) - (-1) = 2 $$\n    Now, integrating with respect to $z$:\n    $$ F_{p,y} = \\int_{0}^{L} p r (2) \\, dz = 2prL $$\n    This result is equivalent to the pressure $p$ acting on the projected area of the inner surface onto the cutting plane, which is a rectangle of dimensions $2r \\times L$.\n\n2.  **Force due to Wall Stress ($F_\\sigma$)**:\n    The circumferential stress $\\sigma_{\\theta\\theta}$ acts on the two cut surfaces of the wall. The area of each cut surface is $A_{wall} = t \\times L$. The total area over which the stress acts is $2tL$. The stress $\\sigma_{\\theta\\theta}$ is, in general, a function of the radial position, $\\sigma_{\\theta\\theta}(R)$. The problem asks for the thickness-averaged stress, $\\langle \\sigma_{\\theta\\theta} \\rangle$.\n    The force resulting from this stress, acting in the $y$-direction and opposing the pressure force, is:\n    $$ F_\\sigma = \\langle \\sigma_{\\theta\\theta} \\rangle \\times (\\text{Total Cut Area}) = \\langle \\sigma_{\\theta\\theta} \\rangle (2tL) $$\n\n3.  **Static Equilibrium**:\n    For the body to be in static equilibrium, the sum of forces in the $y$-direction must be zero.\n    $$ \\sum F_y = F_{p,y} - F_\\sigma = 0 $$\n    $$ 2prL - \\langle \\sigma_{\\theta\\theta} \\rangle (2tL) = 0 $$\n    Solving for the average circumferential stress, $\\langle \\sigma_{\\theta\\theta} \\rangle$:\n    $$ \\langle \\sigma_{\\theta\\theta} \\rangle (2tL) = 2prL $$\n    $$ \\langle \\sigma_{\\theta\\theta} \\rangle = \\frac{2prL}{2tL} = \\frac{pr}{t} $$\n    For a thin-walled structure, the stress is often assumed to be uniform across the thickness, so we can denote it simply as $\\sigma_{\\theta\\theta}$. This expression is commonly known as the Law of Laplace for a thin-walled cylinder.\n\nThe minimal assumptions required for this derivation are:\n-   **Geometric:** The wall is thin ($t \\ll r$). This is the most critical assumption, as it justifies treating the stress as uniform across the thickness and using the inner radius $r$ for the pressure force calculation without significant error compared to using a mean radius. The structure is a perfect, long cylinder, allowing neglect of end effects.\n-   **Loading:** The internal pressure $p$ is static and spatially uniform. Body forces are negligible.\n-   **Material/Symmetry:** The problem is axisymmetric, meaning the stress does not vary with the circumferential position $\\theta$. This is guaranteed for a perfectly cylindrical geometry with uniform material properties and uniform pressure. The derivation itself is based on equilibrium and does not require a specific material constitutive law (e.g., elasticity), but the interpretation of a single stress value $\\sigma_{\\theta\\theta}$ implies material homogeneity.\n\nThe limitations of this model for real arteries are significant:\n-   **Residual Stress:** Arteries exhibit residual stress. When a ring-shaped segment is cut radially, it springs open into an arc, characterized by an \"opening angle\" $\\alpha$. This reveals that in the no-load state, the inner layers of the arterial wall are in compression and the outer layers are in tension. This pre-existing stress state has the critical physiological function of homogenizing the stress distribution through the wall thickness under load. The Laplace formula, derived from a stress-free initial state, neglects this and thus overestimates the stress gradient across the wall.\n-   **Finite Wall Thickness:** The ratio of wall thickness to radius ($t/r$) in arteries is typically in the range of $0.1$ to $0.2$, which is not \"thin\" in an engineering sense. The thin-wall assumption is therefore a significant simplification. A thick-walled analysis (e.g., using Lamé's equations) shows that stress is not uniform, but peaks at the inner wall (intima) and decreases towards the outer wall (adventitia).\n-   **Anisotropy and Heterogeneity:** Arterial tissue is a biological composite, not an isotropic, homogeneous material. It consists of three distinct layers: intima, media, and adventitia, each with unique mechanical properties. Furthermore, the media and adventitia contain elastin and collagen fibers oriented in specific, often helical, patterns. This structure makes the wall strongly anisotropic, meaning its stiffness and strength are different in the circumferential, axial, and radial directions. The simple Laplace formula cannot account for this complexity.\n-   **Axial Pre-stretch:** In the body, arteries are subjected to a significant axial stretch (pre-stretch). This creates an axial stress $\\sigma_{zz}$ and affects the circumferential stress $\\sigma_{\\theta\\theta}$ through geometric and material coupling. The one-dimensional force balance presented here ignores this multi-axial stress state.\n-   **Dynamic Effects:** Blood pressure is not static but pulsatile. This dynamic loading introduces inertial forces (which are generally small) and, more importantly, engages the viscoelastic properties of the arterial wall. Viscoelasticity means the material response is rate-dependent, exhibiting phenomena like creep and stress relaxation, which are not captured by a static equilibrium analysis.\n\nThe final derived expression for the average circumferential stress is:\n$\\sigma_{\\theta\\theta} = \\frac{pr}{t}$",
            "answer": "$$\n\\boxed{\\frac{pr}{t}}\n$$"
        },
        {
            "introduction": "Having established the limitations of simple models, we now turn to the direct quantification of residual stress. This practice focuses on the classic \"opening angle\" experiment, a cornerstone of vascular mechanics research. You will derive the kinematic relationship between the observable, geometric opening angle, $\\Phi$, and the intrinsic residual strain within the vessel wall, providing a crucial link between experimental observation and the continuum mechanics framework .",
            "id": "4155794",
            "problem": "An intact arterial ring composed of $N$ perfectly bonded concentric layers is cut radially and allowed to relax in the absence of external loads and constraints. It opens into a stress-free planar sector with opening angle $\\Phi$, so the stress-free sector spans polar angles $\\theta \\in [0,\\,2\\pi - \\Phi]$ and radii $r$ across the wall thickness. Each layer $i \\in \\{1,\\dots,N\\}$ occupies a radial interval $[a_i,\\,b_i]$ in this stress-free sector. Consider the kinematics of closing this stress-free sector back into the intact ring (with polar angle span $[0,\\,2\\pi]$) under frictionless contact, no torsion, and plane strain in the axial direction. Assume the sector closure proceeds by a smooth deformation that maps the stress-free sector to the closed ring by reparameterizing the circumferential coordinate while preserving the radial coordinate (i.e., a canonical sector-to-ring closure), and that the opened sector is a valid stress-free reference configuration for all layers.\n\nStarting from first principles of finite deformation kinematics in polar coordinates and the definition of Hencky (logarithmic) strain, derive a closed-form expression that relates the opening angle $\\Phi$ (in radians) to the circumferential residual Hencky strain $e_{\\theta}^{\\mathrm{res}}$ for any layer $i$. Your derivation must identify the circumferential stretch and then compute the corresponding Hencky (logarithmic) strain. Express your final answer as a single analytic expression in terms of $\\Phi$ only (in radians). No numerical approximation or rounding is required.",
            "solution": "The problem requires the derivation of a closed-form expression for the circumferential residual Hencky strain, $e_{\\theta}^{\\mathrm{res}}$, as a function of the opening angle $\\Phi$ for an arterial ring. The derivation will be based on the principles of finite deformation kinematics.\n\nFirst, we must validate the problem statement.\n\n### Step 1: Extract Givens\n- The object is an intact arterial ring composed of $N$ perfectly bonded concentric layers.\n- When cut radially, it relaxes to a stress-free planar sector.\n- The opening angle of the stress-free sector is $\\Phi$ (in radians).\n- The stress-free sector is described in polar coordinates $(r, \\theta)$ where the angle spans $\\theta \\in [0, 2\\pi - \\Phi]$.\n- Each layer $i$ occupies a radial interval $[a_i, b_i]$ in the stress-free configuration.\n- The deformation under consideration is the closure of the stress-free sector back into the intact ring.\n- The intact ring spans polar angles in $[0, 2\\pi]$.\n- Assumptions for the closure kinematics: frictionless contact, no torsion, plane strain in the axial direction.\n- The deformation is a \"canonical sector-to-ring closure\", defined as a smooth mapping that reparameterizes the circumferential coordinate while preserving the radial coordinate.\n- The opened sector is a valid stress-free reference configuration.\n- The strain measure to be used is the Hencky (logarithmic) strain, $e = \\ln(\\lambda)$, where $\\lambda$ is the stretch.\n- The final expression for $e_{\\theta}^{\\mathrm{res}}$ must be in terms of $\\Phi$ only.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the well-established \"opening angle\" experiment in arterial mechanics, used to quantify residual stresses. The use of finite deformation kinematics and Hencky strain is standard practice in biomechanics. The model is a simplification but is grounded in valid physical and mathematical principles.\n- **Well-Posed:** The problem statement clearly defines the initial (reference) configuration, the final (current) configuration, and the kinematic mapping between them. This is sufficient to uniquely determine the deformation and the resulting strain.\n- **Objective:** The problem is stated using precise, objective, and formal mathematical and biomechanical terminology.\n- **Flaw Analysis:**\n    - The problem is free of scientific or factual unsoundness.\n    - It is a formalizable problem central to the topic of arterial mechanics.\n    - The information is complete and consistent. The mention of $N$ layers and radial intervals $[a_i, b_i]$ might appear to be extra information, but its irrelevance to the final result (due to the specified kinematics) is a key part of the conceptual understanding being tested. The problem is not underspecified.\n    - The \"canonical closure\" is a physically idealized, but not impossible, kinematic assumption that makes the problem solvable.\n    - The problem is well-structured and leads to a unique, meaningful solution for the strain under the given assumptions.\n    - It is not trivial, as it requires correct application of the concepts of finite strain, stretch, and coordinate transformation.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full derivation will be provided.\n\n### Solution Derivation\n\nThe circumferential residual strain, $e_{\\theta}^{\\mathrm{res}}$, arises from the deformation that maps the stress-free reference configuration (the opened sector) to the residually stressed current configuration (the closed ring). We must first determine the circumferential stretch, $\\lambda_{\\theta}$, associated with this deformation.\n\n1.  **Identify Configurations and Kinematics:**\n    - **Reference Configuration:** This is the stress-free sector. A material point at a given radius $r$ in this configuration has a circumferential path length $L_0(r)$. The sector spans an angle of $2\\pi - \\Phi$. The arc length of this circumferential path is given by the integral of the infinitesimal arc length $r \\, d\\theta$ over the full angular span of the sector.\n    $$L_0(r) = \\int_{0}^{2\\pi - \\Phi} r \\, d\\theta = r(2\\pi - \\Phi)$$\n\n    - **Current Configuration:** This is the closed, intact ring. The problem states that the closure involves reparameterizing the circumferential coordinate while preserving the radial coordinate. This means a material point at radius $r$ in the sector remains at radius $r$ in the ring. The closed ring spans a full angle of $2\\pi$. The circumferential path length, $L(r)$, at radius $r$ in the ring is:\n    $$L(r) = \\int_{0}^{2\\pi} r \\, d\\phi = r(2\\pi)$$\n    where $\\phi$ is the angular coordinate in the closed ring.\n\n2.  **Calculate Circumferential Stretch ($\\lambda_{\\theta}$):**\n    The circumferential stretch $\\lambda_{\\theta}$ is defined as the ratio of the deformed length to the reference length of a material fiber. Since the deformation is uniform along the circumference (a consequence of the \"canonical closure\" assumption), we can use the ratio of the total circumferential lengths.\n    $$\\lambda_{\\theta} = \\frac{L(r)}{L_0(r)} = \\frac{r(2\\pi)}{r(2\\pi - \\Phi)}$$\n    The radius $r$ cancels out, which is a critical result.\n    $$\\lambda_{\\theta} = \\frac{2\\pi}{2\\pi - \\Phi}$$\n    This shows that under the specified kinematic mapping, the circumferential stretch is uniform across the wall thickness. It is independent of the radial position $r$. Therefore, the resulting residual strain will be the same for all layers $i \\in \\{1, \\dots, N\\}$.\n\n3.  **Calculate Hencky (Logarithmic) Strain ($e_{\\theta}^{\\mathrm{res}}$):**\n    The Hencky strain, also known as the logarithmic or true strain, is defined as the natural logarithm of the stretch. The circumferential residual Hencky strain is therefore:\n    $$e_{\\theta}^{\\mathrm{res}} = \\ln(\\lambda_{\\theta})$$\n    Substituting the expression for $\\lambda_{\\theta}$:\n    $$e_{\\theta}^{\\mathrm{res}} = \\ln\\left(\\frac{2\\pi}{2\\pi - \\Phi}\\right)$$\n    This expression can be equivalently written using properties of logarithms:\n    $$e_{\\theta}^{\\mathrm{res}} = \\ln(2\\pi) - \\ln(2\\pi - \\Phi) = -\\ln\\left(\\frac{2\\pi - \\Phi}{2\\pi}\\right) = -\\ln\\left(1 - \\frac{\\Phi}{2\\pi}\\right)$$\n    This final expression relates the circumferential residual Hencky strain directly to the opening angle $\\Phi$, as required by the problem statement. The expression is independent of any other parameters, such as the specific layer or radial position. This is a direct consequence of the prescribed kinematics.\n\nAs a consistency check, if the opening angle $\\Phi = 0$, it implies there is no residual stress. The formula gives $e_{\\theta}^{\\mathrm{res}} = \\ln(1) = 0$, which is correct. If $\\Phi > 0$, the argument of the logarithm is greater than $1$, so $e_{\\theta}^{\\mathrm{res}} > 0$. This indicates that the circumferential fibers are in a state of tension in the closed ring relative to their stress-free length, which is physically consistent with stretching the fibers to close the gap.",
            "answer": "$$\n\\boxed{\n\\ln\\left(\\frac{2\\pi}{2\\pi - \\Phi}\\right)\n}\n$$"
        },
        {
            "introduction": "The final practice brings together the concepts of pressure-induced stress and residual stress to reveal the latter's primary physiological function. Using a more realistic thick-walled model, you will superimpose a self-equilibrated residual stress field onto the stress distribution caused by blood pressure. Through a blend of analytical work and computation, you will demonstrate how residual stresses act to homogenize the stress field across the arterial wall, thereby reducing potentially damaging stress concentrations and ensuring the mechanical integrity of the tissue .",
            "id": "4155827",
            "problem": "Consider an artery modelled as a thick-walled, axisymmetric cylinder in static equilibrium, subjected to an internal pressure and possibly possessing a self-equilibrated residual stress field. Assume small strains, linear elasticity, and plane strain along the axial direction. Neglect body forces. Let the inner radius be $a$ and the outer radius be $b$ with $0 < a < b$. Let the internal pressure be $P$ (applied at $r=a$) and the external pressure be $0$ (at $r=b$). Let $\\sigma_{rr}(r)$ denote the radial stress and $\\sigma_{\\theta\\theta}(r)$ denote the hoop (circumferential) stress. The axisymmetric equilibrium equation in the radial coordinate $r$ is\n$$\\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0.$$\nBoundary conditions for the loaded configuration are $\\sigma_{rr}(a) = -P$ and $\\sigma_{rr}(b) = 0$.\n\nDefine the residual radial stress field (in the absence of external loads) by the family\n$$\\sigma_{rr}^{\\mathrm{res}}(r) = A + B \\ln r + D (\\ln r)^2,$$\nwhere $D$ has units of pressure and the parameters $A$ and $B$ must be determined so that the residual field is self-equilibrated with traction-free boundaries, that is $\\sigma_{rr}^{\\mathrm{res}}(a) = 0$ and $\\sigma_{rr}^{\\mathrm{res}}(b) = 0$. Use the equilibrium equation to determine the corresponding residual hoop stress $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$.\n\nStarting from the equilibrium law and the stated boundary conditions, derive the hoop stress $\\sigma_{\\theta\\theta}(r)$ across the wall for the following two configurations:\n- Without residual stress: only the internal pressure $P$ is present.\n- With residual stress: the total stress is the superposition of the loaded stress field and the self-equilibrated residual stress field.\n\nThen, for each configuration, compute the maximum absolute radial gradient magnitude of the hoop stress over $r \\in [a,b]$, namely\n$$G = \\max_{r\\in[a,b]} \\left| \\frac{d\\sigma_{\\theta\\theta}}{dr}(r) \\right|,$$\nexpressed in Pascal per meter ($\\mathrm{Pa/m}$). You must treat $r$ as a continuous variable on the interval $[a,b]$; your algorithm can discretize $r$ to approximate the maximum.\n\nYour program must:\n- Implement the above derivations and compute $\\sigma_{\\theta\\theta}(r)$ for both configurations.\n- Compute the maximum absolute gradient magnitudes $G_{\\mathrm{nores}}$ and $G_{\\mathrm{withres}}$ for each case, in $\\mathrm{Pa/m}$.\n- Produce a single line of output containing the results as a comma-separated list of two-element lists, each inner list being $[G_{\\mathrm{nores}},G_{\\mathrm{withres}}]$ with both values rounded to six decimal places.\n\nUse the following test suite of parameter sets, with radii in meters and pressures in Pascals:\n1. $a = 4\\times 10^{-3}\\,\\mathrm{m}$, $b = 8\\times 10^{-3}\\,\\mathrm{m}$, $P = 13332\\,\\mathrm{Pa}$, $D = 1000\\,\\mathrm{Pa}$.\n2. $a = 9\\times 10^{-3}\\,\\mathrm{m}$, $b = 10\\times 10^{-3}\\,\\mathrm{m}$, $P = 13332\\,\\mathrm{Pa}$, $D = 500\\,\\mathrm{Pa}$.\n3. $a = 3\\times 10^{-3}\\,\\mathrm{m}$, $b = 12\\times 10^{-3}\\,\\mathrm{m}$, $P = 13332\\,\\mathrm{Pa}$, $D = -1500\\,\\mathrm{Pa}$.\n4. $a = 5\\times 10^{-3}\\,\\mathrm{m}$, $b = 9\\times 10^{-3}\\,\\mathrm{m}$, $P = 16000\\,\\mathrm{Pa}$, $D = 0\\,\\mathrm{Pa}$.\n5. $a = 3\\times 10^{-3}\\,\\mathrm{m}$, $b = 6\\times 10^{-3}\\,\\mathrm{m}$, $P = 20000\\,\\mathrm{Pa}$, $D = 800\\,\\mathrm{Pa}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the two-gradient list in $\\mathrm{Pa/m}$ for one test case, rounded to six decimal places. For example, the output format must be like $[[x_1,y_1],[x_2,y_2],\\dots]$ with no spaces after commas.",
            "solution": "The problem requires the derivation and calculation of the maximum absolute radial gradient of the hoop stress, $G = \\max_{r \\in [a,b]} \\left| d\\sigma_{\\theta\\theta}/dr \\right|$, in a thick-walled arterial model. We will analyze two scenarios: one without residual stress and one with a specified residual stress field. The analysis is based on the principles of linear elasticity for an axisymmetric cylinder under plane strain conditions.\n\nThe governing equation for static equilibrium in the radial direction, neglecting body forces, is given as:\n$$ \\frac{d\\sigma_{rr}}{dr} + \\frac{\\sigma_{rr} - \\sigma_{\\theta\\theta}}{r} = 0 $$\nThis equation can be rearranged to express the hoop stress $\\sigma_{\\theta\\theta}$ in terms of the radial stress $\\sigma_{rr}$:\n$$ \\sigma_{\\theta\\theta}(r) = \\sigma_{rr}(r) + r \\frac{d\\sigma_{rr}}{dr} $$\n\n### Part 1: Analysis without Residual Stress (Lamé Problem)\n\nFirst, we consider the artery subjected only to internal pressure $P$. The stress field in this case is denoted by a superscript 'L'. The problem constitutes a classic Lamé problem for a thick-walled cylinder. The general solution for the stress components is:\n$$ \\sigma_{rr}^{\\mathrm{L}}(r) = C_1 - \\frac{C_2}{r^2} $$\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{L}}(r) = C_1 + \\frac{C_2}{r^2} $$\nwhere $C_1$ and $C_2$ are constants to be determined from the boundary conditions.\n\nThe boundary conditions for the loaded configuration are an internal pressure $P$ at the inner radius $r=a$ and zero external pressure at the outer radius $r=b$:\n$$ \\sigma_{rr}^{\\mathrm{L}}(a) = -P $$\n$$ \\sigma_{rr}^{\\mathrm{L}}(b) = 0 $$\nApplying these conditions yields a system of two linear equations for $C_1$ and $C_2$:\n$$ C_1 - \\frac{C_2}{a^2} = -P $$\n$$ C_1 - \\frac{C_2}{b^2} = 0 $$\nFrom the second equation, we find $C_1 = C_2/b^2$. Substituting this into the first equation:\n$$ \\frac{C_2}{b^2} - \\frac{C_2}{a^2} = -P \\implies C_2 \\left( \\frac{a^2 - b^2}{a^2 b^2} \\right) = -P $$\nSolving for $C_2$ gives:\n$$ C_2 = \\frac{P a^2 b^2}{b^2 - a^2} $$\nAnd for $C_1$:\n$$ C_1 = \\frac{C_2}{b^2} = \\frac{P a^2}{b^2 - a^2} $$\nSubstituting these constants back, we obtain the expressions for the pressure-induced stresses:\n$$ \\sigma_{rr}^{\\mathrm{L}}(r) = \\frac{P a^2}{b^2 - a^2} \\left( 1 - \\frac{b^2}{r^2} \\right) $$\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{L}}(r) = \\frac{P a^2}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) $$\nTo find the gradient of the hoop stress, we differentiate $\\sigma_{\\theta\\theta}^{\\mathrm{L}}(r)$ with respect to $r$:\n$$ \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{L}}}{dr} = \\frac{d}{dr} \\left[ \\frac{P a^2}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\right] = \\frac{P a^2 b^2}{b^2 - a^2} \\left( - \\frac{2}{r^3} \\right) = -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} $$\nWe need to find the maximum absolute value of this gradient, $G_{\\mathrm{nores}}$, over the interval $r \\in [a, b]$.\n$$ G_{\\mathrm{nores}} = \\max_{r \\in [a,b]} \\left| -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} \\right| = \\frac{2 P a^2 b^2}{b^2 - a^2} \\max_{r \\in [a,b]} \\left( \\frac{1}{r^3} \\right) $$\nSince $r > 0$, the function $1/r^3$ is strictly decreasing. Its maximum on the interval $[a, b]$ occurs at the left endpoint, $r=a$. Therefore:\n$$ G_{\\mathrm{nores}} = \\frac{2 P a^2 b^2}{(b^2 - a^2) a^3} = \\frac{2 P b^2}{a(b^2 - a^2)} $$\nThis provides an analytical formula for the maximum gradient in the absence of residual stress.\n\n### Part 2: Analysis with Residual Stress\n\nThe total stress field is assumed to be a linear superposition of the pressure-induced field (Part 1) and a self-equilibrated residual stress field, denoted by a superscript 'res'.\n$$ \\sigma_{ij} = \\sigma_{ij}^{\\mathrm{L}} + \\sigma_{ij}^{\\mathrm{res}} $$\nThe residual radial stress is given as $\\sigma_{rr}^{\\mathrm{res}}(r) = A + B \\ln r + D (\\ln r)^2$. This field must be self-equilibrated, meaning it produces no net force on the boundaries. This is enforced by traction-free boundary conditions:\n$$ \\sigma_{rr}^{\\mathrm{res}}(a) = 0 $$\n$$ \\sigma_{rr}^{\\mathrm{res}}(b) = 0 $$\nThis leads to a system of equations for the coefficients $A$ and $B$ (with $D$ being a given parameter):\n$$ A + B \\ln a + D (\\ln a)^2 = 0 $$\n$$ A + B \\ln b + D (\\ln b)^2 = 0 $$\nSolving this system yields:\n$$ B = -D (\\ln a + \\ln b) = -D \\ln(ab) $$\n$$ A = D \\ln a \\ln b $$\nThe residual radial stress is thus fully determined:\n$$ \\sigma_{rr}^{\\mathrm{res}}(r) = D \\left[ (\\ln r)^2 - (\\ln a + \\ln b) \\ln r + \\ln a \\ln b \\right] = D (\\ln r - \\ln a)(\\ln r - \\ln b) $$\nThe corresponding residual hoop stress $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$ is found from the equilibrium equation:\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{res}}(r) = \\sigma_{rr}^{\\mathrm{res}}(r) + r \\frac{d\\sigma_{rr}^{\\mathrm{res}}}{dr} $$\nFirst, we compute the derivative of $\\sigma_{rr}^{\\mathrm{res}}(r)$:\n$$ \\frac{d\\sigma_{rr}^{\\mathrm{res}}}{dr} = \\frac{d}{dr} \\left[ A + B \\ln r + D (\\ln r)^2 \\right] = \\frac{B}{r} + \\frac{2D \\ln r}{r} $$\nSubstituting this into the expression for $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$:\n$$ \\sigma_{\\theta\\theta}^{\\mathrm{res}}(r) = \\left( A + B \\ln r + D (\\ln r)^2 \\right) + r \\left( \\frac{B}{r} + \\frac{2D \\ln r}{r} \\right) = (A+B) + (B+2D) \\ln r + D (\\ln r)^2 $$\nThe total hoop stress is $\\sigma_{\\theta\\theta}(r) = \\sigma_{\\theta\\theta}^{\\mathrm{L}}(r) + \\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$. Its gradient is:\n$$ \\frac{d\\sigma_{\\theta\\theta}}{dr} = \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{L}}}{dr} + \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{res}}}{dr} $$\nWe must find the derivative of $\\sigma_{\\theta\\theta}^{\\mathrm{res}}(r)$:\n$$ \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{res}}}{dr} = \\frac{d}{dr} \\left[ (A+B) + (B+2D) \\ln r + D (\\ln r)^2 \\right] = \\frac{B+2D}{r} + \\frac{2D \\ln r}{r} = \\frac{1}{r} \\left( B + 2D + 2D \\ln r \\right) $$\nSubstituting $B = -D(\\ln a + \\ln b)$:\n$$ \\frac{d\\sigma_{\\theta\\theta}^{\\mathrm{res}}}{dr} = \\frac{D}{r} \\left( -(\\ln a + \\ln b) + 2 + 2 \\ln r \\right) = \\frac{2D}{r} \\left( 1 + \\ln r - \\frac{\\ln a + \\ln b}{2} \\right) = \\frac{2D}{r} \\left( 1 + \\ln\\left(\\frac{r}{\\sqrt{ab}}\\right) \\right) $$\nThe total hoop stress gradient is the sum of the loading-induced and residual gradients:\n$$ \\frac{d\\sigma_{\\theta\\theta}}{dr}(r) = -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} + \\frac{2D}{r} \\left( 1 + \\ln\\left(\\frac{r}{\\sqrt{ab}}\\right) \\right) $$\nTo find $G_{\\mathrm{withres}} = \\max_{r \\in [a,b]} \\left| \\frac{d\\sigma_{\\theta\\theta}}{dr}(r) \\right|$, we must find the maximum of the absolute value of this function. Unlike the case without residual stress, the location of the maximum is not immediately obvious and finding it analytically would require solving a transcendental equation. As permitted by the problem statement, we will use a numerical approach. We will discretize the interval $[a, b]$ into a fine grid of points, evaluate the absolute value of the gradient at each point, and identify the maximum value.\n\n### Part 3: Computational Strategy\n\nThe algorithm will implement the derived formulas for a given set of parameters $\\{a, b, P, D\\}$.\n1.  Compute $G_{\\mathrm{nores}}$ using the analytical formula:\n    $$ G_{\\mathrm{nores}} = \\frac{2 P b^2}{a(b^2 - a^2)} $$\n2.  Compute $G_{\\mathrm{withres}}$ numerically:\n    a. Create a dense grid of $r$ values in the interval $[a, b]$.\n    b. For each $r$ in the grid, calculate the total hoop stress gradient:\n       $$ f(r) = -2 \\frac{P a^2 b^2}{(b^2 - a^2) r^3} + \\frac{2D}{r} \\left( 1 + \\ln\\left(\\frac{r}{\\sqrt{ab}}\\right) \\right) $$\n    c. Find the maximum value of $|f(r)|$ over the grid. This serves as the approximation for $G_{\\mathrm{withres}}$.\nA special case occurs when $D=0$. In this scenario, the residual stress field is identically zero ($\\sigma_{ij}^{\\mathrm{res}} = 0$), and the total gradient reduces to the Lamé gradient. Consequently, we must find $G_{\\mathrm{withres}} = G_{\\mathrm{nores}}$. This provides a suitable check for the implementation.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the arterial mechanics problem for a given set of test cases.\n\n    The function calculates the maximum absolute radial gradient of the hoop stress\n    for an artery model under two conditions:\n    1. Without residual stress (G_nores), based on the Lamé solution.\n    2. With a superimposed self-equilibrated residual stress field (G_withres).\n\n    The results are formatted and printed as a single-line list of lists.\n    \"\"\"\n    # Test suite from the problem statement: (a, b, P, D)\n    # a: inner radius (m), b: outer radius (m), P: internal pressure (Pa), D: residual stress parameter (Pa)\n    test_cases = [\n        (4e-3, 8e-3, 13332, 1000),\n        (9e-3, 10e-3, 13332, 500),\n        (3e-3, 12e-3, 13332, -1500),\n        (5e-3, 9e-3, 16000, 0),\n        (3e-3, 6e-3, 20000, 800)\n    ]\n\n    all_results = []\n\n    for a, b, P, D in test_cases:\n        # Case 1: No residual stress\n        # G_nores = max |d(sigma_theta_theta^L)/dr|\n        # From the analytical derivation, the maximum occurs at r=a:\n        # G_nores = 2 * P * b**2 / (a * (b**2 - a**2))\n        G_nores = (2 * P * b**2) / (a * (b**2 - a**2))\n\n        # Case 2: With residual stress\n        # The maximum absolute gradient is found numerically by discretizing the domain.\n        num_points = 100001\n        r = np.linspace(a, b, num_points)\n\n        # Gradient of hoop stress from pressure loading (Lamé solution derivative)\n        # d(sigma_theta_theta^L)/dr = -2 * (P * a**2 * b**2) / ((b**2 - a**2) * r**3)\n        b2_minus_a2 = b**2 - a**2\n        grad_lame = - (2 * P * a**2 * b**2) / (b2_minus_a2 * r**3)\n\n        # Gradient of hoop stress from the residual stress field\n        # d(sigma_theta_theta^res)/dr = (2*D/r) * (1 + log(r / sqrt(a*b)))\n        # Handle the D=0 case separately to avoid unnecessary computation.\n        if D != 0:\n            # np.log is the natural logarithm (ln)\n            sqrt_ab = np.sqrt(a * b)\n            grad_res = (2 * D / r) * (1 + np.log(r / sqrt_ab))\n        else:\n            # If D=0, the residual stress field and its gradient are zero.\n            grad_res = 0.0\n\n        # The total gradient is the superposition of the two components.\n        grad_total = grad_lame + grad_res\n\n        # Find the maximum absolute value of the total gradient on the discretized domain.\n        G_withres = np.max(np.abs(grad_total))\n        \n        all_results.append([G_nores, G_withres])\n\n    # Format the output string as per the specified requirements:\n    # A comma-separated list of [G_nores, G_withres] pairs, with values\n    # rounded to six decimal places, enclosed in brackets.\n    # e.g., [[x1,y1],[x2,y2],...]\n    formatted_results = []\n    for res_pair in all_results:\n        formatted_results.append(f\"[{res_pair[0]:.6f},{res_pair[1]:.6f}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}