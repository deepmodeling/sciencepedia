{
    "hands_on_practices": [
        {
            "introduction": "心脏肌肉产生力量的根本在于肌小节内细肌丝与粗肌丝的相互作用。这个练习将引导我们从最基本的几何原理出发，推导肌丝重叠部分与肌小节长度之间的关系 。通过这种方式，我们可以量化滑动肌丝理论的核心思想，并理解肌节长度-张力关系背后的结构基础。",
            "id": "4162667",
            "problem": "横纹肌滑动肌丝模型的一个基本定量特征是，主动张力仅由细肌丝（肌动蛋白）与粗肌丝（肌球蛋白）的头部区域重叠处的横桥产生。在肌小节中，粗肌丝中央有一个没有肌球蛋白头的裸区。考虑沿一维坐标从肌小节中心（M线）到Z线的对称半肌小节的描述。长度为 $L_a$ 的细肌丝从Z线向内延伸，总长度为 $L_m$ 的粗肌丝从M线向外延伸；在粗肌丝内部，长度为 $z_b$ 的中央裸区不含头部。假设肌球蛋白头在头部承载区沿线呈均匀密度分布，且肌动蛋白结合位点在细肌丝上呈均匀分布。在这些假设下，潜在横桥的数量与肌动蛋白和肌球蛋白头部区域之间的几何重叠长度成线性关系。\n\n从这个几何图像和上述定义出发，从第一性原理推导肌动蛋白与肌球蛋白头部承载区之间的重叠比例 $f(\\ell_s)$ 作为肌小节长度 $\\ell_s$ 的函数的解析表达式。将比例 $f(\\ell_s)$ 定义为整个肌小节中重叠的头部区域总长度除以整个肌小节中可用的头部区域总长度。然后，使用你推导出的表达式，在以下生理上合理的参数下，计算 $f(\\ell_s)$ 的数值和相应的主动张力 $\\sigma_{\\mathrm{act}}$：\n- 细肌丝长度 $L_a = 1.05\\,\\mu\\mathrm{m}$，\n- 粗肌丝长度 $L_m = 1.60\\,\\mu\\mathrm{m}$，\n- 裸区长度 $z_b = 0.20\\,\\mu\\mathrm{m}$，\n- 肌小节长度 $\\ell_s = 2.50\\,\\mu\\mathrm{m}$，\n- 最大主动应力（完全重叠时的应力） $\\sigma_{\\max} = 120\\,\\mathrm{kPa}$。\n\n假设主动张力与重叠比例成线性正比关系，即 $\\sigma_{\\mathrm{act}} = \\sigma_{\\max}\\, f(\\ell_s)$。将 $f(\\ell_s)$ 和 $\\sigma_{\\mathrm{act}}$ 的值均四舍五入至四位有效数字。主动张力以千帕（kPa）为单位表示。你的最终答案必须按以下顺序报告两个量：首先是 $f(\\ell_s)$（无量纲），然后是 $\\sigma_{\\mathrm{act}}$（单位为 kPa）。",
            "solution": "问题要求推导肌小节中重叠比例 $f(\\ell_s)$ 的解析表达式，并随后计算其数值以及相应的主动张力 $\\sigma_{\\mathrm{act}}$。该推导必须基于滑动肌丝模型的几何原理。\n\n首先，我们建立一个坐标系来形式化几何结构。我们考虑一个对称的半肌小节，M线位于原点 $x=0$。那么Z线就位于 $x = \\frac{\\ell_s}{2}$，其中 $\\ell_s$ 是肌小节的总长度。\n\n粗（肌球蛋白）肌丝的总长度为 $L_m$，以M线为中心。在我们的半肌小节模型中，它从 $x=0$ 延伸到 $x=\\frac{L_m}{2}$。粗肌丝有一个总长度为 $z_b$ 的中央裸区，该区域没有肌球蛋白头。在半肌小节中，这个裸区占据区间 $[0, \\frac{z_b}{2}]$。因此，这个半肌小节中肌球蛋白丝的头部承载区跨越区间 $[\\frac{z_b}{2}, \\frac{L_m}{2}]$。在一个半肌小节中，这个头部承载区的长度是 $L_{h, \\text{half}} = \\frac{L_m}{2} - \\frac{z_b}{2} = \\frac{L_m - z_b}{2}$。\n\n细（肌动蛋白）肌丝的长度为 $L_a$，从Z线向内延伸。因此，它在半肌小节中的位置是区间 $[\\frac{\\ell_s}{2} - L_a, \\frac{\\ell_s}{2}]$。\n\n主动力的产生与肌动蛋白丝和肌球蛋白头部承载区重叠区域的长度成正比。设这个在半肌小节中的重叠长度为 $L_{ov, \\text{half}}$。这个长度是两个区间交集的度量：肌球蛋白头部承载区 $[\\frac{z_b}{2}, \\frac{L_m}{2}]$ 和肌动蛋白丝区域 $[\\frac{\\ell_s}{2} - L_a, \\frac{\\ell_s}{2}]$。\n\n两个闭区间 $[a, b]$ 和 $[c, d]$ 的交集长度由通用公式 $\\max(0, \\min(b, d) - \\max(a, c))$ 给出。将此公式应用于我们的区间：\n$L_{ov, \\text{half}} = \\max\\left(0, \\min\\left(\\frac{L_m}{2}, \\frac{\\ell_s}{2}\\right) - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s}{2} - L_a\\right)\\right)$\n\n对于生理学相关的肌小节长度，肌小节比粗肌丝长，即 $\\ell_s > L_m$。给定的参数 $\\ell_s = 2.50\\,\\mu\\mathrm{m}$ 和 $L_m = 1.60\\,\\mu\\mathrm{m}$ 满足这个条件。因此，$\\frac{\\ell_s}{2} > \\frac{L_m}{2}$，这将 $\\min$ 项简化为 $\\min(\\frac{L_m}{2}, \\frac{\\ell_s}{2}) = \\frac{L_m}{2}$。重叠长度的表达式变为：\n$L_{ov, \\text{half}} = \\max\\left(0, \\frac{L_m}{2} - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s}{2} - L_a\\right)\\right)$\n\n问题将重叠比例 $f(\\ell_s)$ 定义为整个肌小节中重叠的头部区域总长度除以整个肌小节中可用的头部区域总长度。\n由于对称性，总重叠长度为 $2 \\times L_{ov, \\text{half}}$。\n总可用头部区域长度是总肌球蛋白长度减去裸区长度，即 $L_m - z_b$。这也等于 $2 \\times L_{h, \\text{half}}$。\n所以，比例 $f(\\ell_s)$ 是：\n$$f(\\ell_s) = \\frac{2 \\cdot L_{ov, \\text{half}}}{L_m - z_b} = \\frac{2 \\cdot \\max\\left(0, \\frac{L_m}{2} - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s - 2L_a}{2}\\right)\\right)}{L_m - z_b}$$\n简化此表达式，我们得到：\n$$f(\\ell_s) = \\frac{\\max\\left(0, L_m - 2\\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s - 2L_a}{2}\\right)\\right)}{L_m - z_b} = \\frac{\\max\\left(0, L_m - \\max(z_b, \\ell_s - 2L_a)\\right)}{L_m - z_b}$$\n这是重叠比例的通用解析表达式，在 $\\ell_s > L_m$ 时有效。\n\n现在，我们将使用提供的参数计算 $f(\\ell_s)$ 的数值：\n$L_a = 1.05\\,\\mu\\mathrm{m}$\n$L_m = 1.60\\,\\mu\\mathrm{m}$\n$z_b = 0.20\\,\\mu\\mathrm{m}$\n$\\ell_s = 2.50\\,\\mu\\mathrm{m}$\n$\\sigma_{\\max} = 120\\,\\mathrm{kPa}$\n\n我们需要计算 $\\max(z_b, \\ell_s - 2L_a)$ 这一项。\n$\\ell_s - 2L_a = 2.50 - 2(1.05) = 2.50 - 2.10 = 0.40\\,\\mu\\mathrm{m}$。\n$z_b$ 的值为 $0.20\\,\\mu\\mathrm{m}$。\n由于 $0.40 > 0.20$，我们有 $\\ell_s - 2L_a > z_b$。这种物理情况对应于长度-张力曲线的“下降支”，此时细肌丝已被拉过裸区，减少了可用横桥的数量。\n在这种情况下，$\\max(z_b, \\ell_s - 2L_a) = \\ell_s - 2L_a$。\n$f(\\ell_s)$ 的表达式简化为：\n$$f(\\ell_s) = \\frac{L_m - (\\ell_s - 2L_a)}{L_m - z_b} = \\frac{L_m + 2L_a - \\ell_s}{L_m - z_b}$$\n此外，我们必须确保重叠为正，这要求 $L_m + 2L_a - \\ell_s > 0$。\n$1.60 + 2(1.05) - 2.50 = 1.60 + 2.10 - 2.50 = 3.70 - 2.50 = 1.20 > 0$。重叠确实为正。\n\n将数值代入 $f(\\ell_s)$ 的公式中：\n$$f(2.50) = \\frac{1.60 + 2(1.05) - 2.50}{1.60 - 0.20} = \\frac{1.20}{1.40} = \\frac{12}{14} = \\frac{6}{7}$$\n作为小数，$f(2.50) \\approx 0.8571428...$。四舍五入到四位有效数字得到 $f(2.50) = 0.8571$。\n\n接下来，我们使用线性正比关系 $\\sigma_{\\mathrm{act}} = \\sigma_{\\max}\\, f(\\ell_s)$ 计算主动张力 $\\sigma_{\\mathrm{act}}$。\n$$\\sigma_{\\mathrm{act}} = 120\\,\\mathrm{kPa} \\times \\frac{6}{7} = \\frac{720}{7}\\,\\mathrm{kPa} \\approx 102.85714...\\,\\mathrm{kPa}$$\n四舍五入到四位有效数字，我们得到 $\\sigma_{\\mathrm{act}} = 102.9\\,\\mathrm{kPa}$。\n所要求的两个量是无量纲比例 $f(\\ell_s)$ 和以千帕为单位的主动张力 $\\sigma_{\\mathrm{act}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8571  102.9\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "肌肉收缩是一个动态过程，由钙离子瞬变触发。这个实践将指导我们建立一个动力学模型，通过数值方法模拟一次完整的心肌细胞抽搐过程 。通过该练习，我们将学习如何将生物化学信号（钙浓度）与力学输出（主动应力）随时间的变化联系起来，从而深入理解兴奋-收缩耦联的内在机制。",
            "id": "4162691",
            "problem": "您的任务是通过对由细胞内钙瞬变驱动的、随时间变化的横桥附着速率进行积分，来计算心肌的等长抽搐主动应力时间进程。该计算必须从生物力学的第一性原理出发，并且必须在预设的时间网格上使用前向欧拉数值时间积分方案。该系统是等长的，因此肌小节长度是固定的，力的变化完全由附着和脱离动力学引起。\n\n基本原理和定义：\n1. 令 $[Ca^{2+}](t)$ 表示胞浆游离钙离子浓度（单位：微摩尔），其由一个生理上真实的、带有有限静息基线的双指数差函数瞬变过程定义：\n$$\n[Ca^{2+}](t) = [Ca^{2+}]_{\\text{rest}} + C_{\\text{amp}} \\left(e^{-\\frac{(t - t_0)}{\\tau_d}} - e^{-\\frac{(t - t_0)}{\\tau_r}}\\right) H(t - t_0),\n$$\n其中 $[Ca^{2+}]_{\\text{rest}}$ 是静息钙浓度（单位 $\\mu\\mathrm{M}$），$C_{\\text{amp}}$ 是振幅（单位 $\\mu\\mathrm{M}$），$\\tau_r$ 是上升时间常数（单位 $\\mathrm{s}$），$\\tau_d$ 是衰减时间常数（单位 $\\mathrm{s}$），$t_0$ 是激活起始时间（单位 $\\mathrm{s}$），以及 $H(\\cdot)$ 是 Heaviside 阶跃函数，当 $x<0$ 时 $H(x)=0$，当 $x \\ge 0$ 时 $H(x)=1$。\n\n2. 生化横桥附着速率 $f(t)$ 通过 Hill 关系式依赖于钙离子浓度：\n$$\nf(t) = k \\cdot \\frac{([Ca^{2+}](t))^{n}}{([Ca^{2+}](t))^{n} + \\rho^{n}},\n$$\n其中 $k$ 是最大附着速率（单位 $\\mathrm{s}^{-1}$），$\\rho$ 是半激活钙浓度（单位 $\\mu\\mathrm{M}$），$n$ 是 Hill 系数（无量纲）。使用 $n=3$。\n\n3. 脱离速率 $g$ 是一个常数，单位为 $\\mathrm{s}^{-1}$。\n\n4. 已附着横桥的比例 $A(t)$ 遵循质量作用动力学：\n$$\n\\frac{dA}{dt} = f(t)\\big(1 - A(t)\\big) - g\\,A(t),\n$$\n在 $t=0$ 时的物理一致性初始条件取为在 $[Ca^{2+}]_{\\text{rest}}$ 下的静息稳态：\n$$\nA(0) = \\frac{f(0)}{f(0) + g}, \\quad \\text{其中 } f(0) = k \\cdot \\frac{([Ca^{2+}]_{\\text{rest}})^{n}}{([Ca^{2+}]_{\\text{rest}})^{n} + \\rho^{n}}.\n$$\n\n5. 等长主动应力 $\\sigma(t)$（单位 $\\mathrm{kPa}$）与已附着比例成正比：\n$$\n\\sigma(t) = \\sigma_0 \\, A(t),\n$$\n其中 $\\sigma_0$ 是在饱和钙条件下当 $A(t) \\to 1$ 时达到的最大主动应力（单位 $\\mathrm{kPa}$）。\n\n数值积分要求：\n- 使用具有固定时间步长 $\\Delta t$ 的前向欧拉方案对 $\\frac{dA}{dt}$ 进行积分，按以下方式更新 $A$：\n$$\nA_{i+1} = A_i + \\Delta t \\cdot \\left( f(t_i)\\big(1 - A_i\\big) - g\\,A_i \\right),\n$$\n其中 $t_i = i \\cdot \\Delta t$ 且 $A_i \\approx A(t_i)$。\n- 在每一步通过裁剪到区间 $[0,1]$ 来强制执行物理约束 $0 \\le A(t) \\le 1$。\n- 在每个时间点计算主动应力 $\\sigma_i = \\sigma_0 A_i$。\n\n每个测试用例需要计算的输出：\n- 峰值主动应力 $\\sigma_{\\text{peak}}$（单位 $\\mathrm{kPa}$）。\n- 达峰时间 $t_{\\text{peak}}$（单位 $\\mathrm{ms}$），定义为 $\\sigma(t)$ 达到其最大值的最早仿真时间。\n- 应力-时间积分 $I = \\int_{0}^{T} \\sigma(t) \\, dt$（单位 $\\mathrm{kPa}\\cdot\\mathrm{s}$），在仿真时长内使用梯形法则计算。\n\n答案单位规范：\n- 以 $\\mathrm{kPa}$ 表示 $\\sigma_{\\text{peak}}$。\n- 以 $\\mathrm{ms}$ 表示 $t_{\\text{peak}}$。\n- 以 $\\mathrm{kPa}\\cdot\\mathrm{s}$ 表示 $I$。\n\n时间离散化与积分窗口：\n- 使用每个测试用例中指定的总仿真时间 $T$ 和时间步长 $\\Delta t$；所有时间单位均为 $\\mathrm{s}$，时间步长单位也为 $\\mathrm{s}$。\n\n测试套件：\n为以下四个参数集提供结果。所有钙浓度单位为 $\\mu\\mathrm{M}$，速率单位为 $\\mathrm{s}^{-1}$，时间单位为 $\\mathrm{s}$，应力单位为 $\\mathrm{kPa}$。\n\n- 测试用例 1（基线，类似人类的抽搐）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[Ca^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.9$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- 测试用例 2（钙可用性降低）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[Ca^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.3$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- 测试用例 3（更快的脱离）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 120$\n  - $n = 3$\n  - $[Ca^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.9$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- 测试用例 4（边界情况，无抽搐）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[Ca^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例贡献一个格式为 $[\\sigma_{\\text{peak}},t_{\\text{peak}},I]$ 的三元组，因此总输出是一个三元组列表，例如：\n$$\n[[\\sigma_{\\text{peak},1}, t_{\\text{peak},1}, I_1],[\\sigma_{\\text{peak},2}, t_{\\text{peak},2}, I_2],[\\sigma_{\\text{peak},3}, t_{\\text{peak},3}, I_3],[\\sigma_{\\text{peak},4}, t_{\\text{peak},4}, I_4]]\n$$\n所有数值必须是浮点数。",
            "solution": "用户提供了一个科学上合理、定义明确且客观的问题。它描述了一个标准的、尽管简化了的心肌兴奋-收缩耦合模型，并要求进行数值求解。所有参数、方程、初始条件和数值方法都已明确定义。所要求的输出是明确的。因此，该问题被视为**有效**。\n\n该问题要求通过数值求解一个模拟潜在生物力学和生物化学过程的方程组，来计算心肌中的等长主动应力时间进程 $\\sigma(t)$。解决方案涉及几个步骤，这些步骤基于成熟的肌肉生理学和数值分析原理。\n\n### 1. 建模生理级联反应\n\n该模型建立了一条从细胞电生理学（由钙瞬变代表）到宏观力学（主动应力产生）的因果链。\n\n**a. 细胞内钙瞬变, $[Ca^{2+}](t)$：**\n肌肉收缩的触发因素是细胞内游离钙浓度 $[Ca^{2+}](t)$ 的瞬时升高。该问题使用一个唯象模型来定义这一过程，即一个叠加在静息基线浓度 $[Ca^{2+}]_{\\text{rest}}$ 上的双指数差函数。这是一种常见且生理上真实的表示方法。方程为：\n$$\n[Ca^{2+}](t) = [Ca^{2+}]_{\\text{rest}} + C_{\\text{amp}} \\left(e^{-\\frac{(t - t_0)}{\\tau_d}} - e^{-\\frac{(t - t_0)}{\\tau_r}}\\right) H(t - t_0)\n$$\n在此， $t$ 是时间（单位：秒 $\\mathrm{s}$），$C_{\\text{amp}}$ 是瞬变振幅（单位：微摩尔 $\\mu\\mathrm{M}$），$\\tau_r$ 和 $\\tau_d$ 分别是上升和衰减时间常数（单位：$\\mathrm{s}$），$t_0$ 是刺激的起始时间（单位：$\\mathrm{s}$），$H(\\cdot)$ 是 Heaviside 阶跃函数，确保瞬变从 $t=t_0$ 开始。\n\n**b. 钙依赖性横桥附着速率, $f(t)$：**\n钙离子与调节蛋白（心肌中为肌钙蛋白 C）结合，从而允许在肌动蛋白和肌球蛋白丝之间形成产生力的横桥。这个协同结合过程使用 Hill 方程进行建模，该方程将钙浓度与横桥附着速率 $f(t)$ 联系起来：\n$$\nf(t) = k \\cdot \\frac{([Ca^{2+}](t))^{n}}{([Ca^{2+}](t))^{n} + \\rho^{n}}\n$$\n其中 $k$ 是饱和钙水平下的最大附着速率（单位 $\\mathrm{s}^{-1}$），$\\rho$ 是半最大激活时的钙浓度（单位 $\\mu\\mathrm{M}$），$n$ 是 Hill 系数，描述了响应的陡峭程度（协同性）。问题指定 $n=3$。\n\n**c. 横桥动力学与已附着横桥的比例, $A(t)$：**\n横桥群体的动力学由一级质量作用动力学描述。已附着横桥比例 $A(t)$ 的变化率，取决于作用于可用（未附着）横桥群体 $(1-A(t))$ 的附着速率 $f(t)$，以及作用于已附着横桥群体 $A(t)$ 的恒定脱离速率 $g$（单位 $\\mathrm{s}^{-1}$）。这导出了以下常微分方程 (ODE)：\n$$\n\\frac{dA}{dt} = f(t)\\big(1 - A(t)\\big) - g\\,A(t)\n$$\n假设系统在时间 $t=0$ 时处于静息稳态，该稳态由静息钙浓度 $[Ca^{2+}]_{\\text{rest}}$ 决定。通过将 $\\frac{dA}{dt}$ 设为 0 并使用静息附着速率 $f(0)$，可以找到初始条件 $A(0)$：\n$$\nf(0)\\big(1 - A(0)\\big) - g\\,A(0) = 0 \\implies A(0) = \\frac{f(0)}{f(0) + g}\n$$\n其中 $f(0)$ 是使用 Hill 方程中的 $[Ca^{2+}]_{\\text{rest}}$ 计算得出的。\n\n**d. 等长主动应力, $\\sigma(t)$：**\n由肌肉产生的宏观主动应力 $\\sigma(t)$，被假定为与已附着并产生力的横桥比例 $A(t)$ 成正比。比例常数 $\\sigma_0$（单位：千帕斯卡 $\\mathrm{kPa}$），表示如果所有可能的横桥都已附着 ($A(t)=1$) 时将产生的最大应力。\n$$\n\\sigma(t) = \\sigma_0 \\, A(t)\n$$\n\n### 2. 数值实现\n\n当由时变的 $f(t)$ 驱动时，关于 $A(t)$ 的常微分方程没有简单的解析解，因此需要采用数值方法。\n\n**a. 时间离散化：**\n从 $t=0$ 到 $t=T$ 的仿真时间窗口被离散化为一系列点 $t_i = i \\cdot \\Delta t$，其中 $\\Delta t$ 是固定的时间步长， $i$ 是从 0 到 $N = T/\\Delta t$ 的整数索引。\n\n**b. 前向欧拉积分：**\n问题指定使用前向欧拉方法来对 $A(t)$ 的常微分方程进行积分。在时间 $t_i$ 的导数 $\\frac{dA}{dt}$ 被近似为 $\\frac{A_{i+1} - A_i}{\\Delta t}$。将此代入常微分方程，得到从已知状态 $A_i \\approx A(t_i)$ 求取状态 $A_{i+1} \\approx A(t_{i+1})$ 的更新规则：\n$$\n\\frac{A_{i+1} - A_i}{\\Delta t} = f(t_i)\\big(1 - A_i\\big) - g\\,A_i\n$$\n$$\nA_{i+1} = A_i + \\Delta t \\cdot \\left( f(t_i)\\big(1 - A_i\\big) - g\\,A_i \\right)\n$$\n此计算从 $i=0$ 到 $N-1$ 对每个时间步迭代执行。为确保物理真实性，每一步都将 $A_{i+1}$ 的值约束在区间 $[0,1]$ 内。这种裁剪操作可以防止数值解违反 $A(t)$ 作为比例的定义。\n\n**c. 计算输出：**\n一旦计算出已附着比例的时间序列 $A_i$，就可以获得应力时间序列 $\\sigma_i = \\sigma_0 A_i$。从该序列中，计算所需的输出指标：\n- **峰值主动应力 ($\\sigma_{\\text{peak}}$)：** 计算得到的应力数组中的最大值，$\\sigma_{\\text{peak}} = \\max_i(\\sigma_i)$。\n- **达峰时间 ($t_{\\text{peak}}$)：** 应力达到其峰值的最早时间 $t_j$。通过识别应力数组中最大值首次出现的索引 $j$，然后找到相应的时间 $t_j = j \\cdot \\Delta t$ 来确定。结果转换为毫秒 ($\\mathrm{ms}$)。\n- **应力-时间积分 ($I$)：** 通过对应力曲线进行积分来计算仿真期间的总机械冲量。问题指定使用梯形法则进行此数值积分：\n$$\nI = \\int_{0}^{T} \\sigma(t) \\, dt \\approx \\sum_{i=0}^{N-1} \\frac{\\sigma_i + \\sigma_{i+1}}{2} \\Delta t\n$$\n这可以使用标准的数值库函数高效地计算。\n\n整个算法包括：建立时间网格，计算初始条件 $A(0)$，为所有时间点预先计算随时间变化的钙浓度 $[Ca^{2+}](t_i)$ 和附着速率 $f(t_i)$，迭代前向欧拉步骤以求得 $A(t_i)$，计算 $\\sigma(t_i)$，最后从得到的应力曲线中提取三个指定的指标。对四个测试用例中的每一个重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the cardiac muscle biomechanics problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases as a list of dictionaries.\n    test_cases = [\n        # Test case 1 (baseline human-like twitch)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.9, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 2 (reduced calcium availability)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.3, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 3 (faster detachment)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 120.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.9, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 4 (boundary case, no twitch)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.0, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result_triplet = compute_twitch_dynamics(params)\n        results.append(result_triplet)\n\n    # Format the final output string as a list of lists.\n    # The map(str, results) correctly converts each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef compute_twitch_dynamics(params):\n    \"\"\"\n    Computes the isometric twitch dynamics for a single set of parameters.\n\n    Args:\n        params (dict): A dictionary containing all model and simulation parameters.\n\n    Returns:\n        list: A list containing [sigma_peak, t_peak_ms, integral_I].\n    \"\"\"\n    # Unpack parameters\n    k, rho, g, n, Ca_rest = params[\"k\"], params[\"rho\"], params[\"g\"], params[\"n\"], params[\"Ca_rest\"]\n    C_amp, tau_r, tau_d, t0 = params[\"C_amp\"], params[\"tau_r\"], params[\"tau_d\"], params[\"t0\"]\n    sigma0, T, dt = params[\"sigma0\"], params[\"T\"], params[\"dt\"]\n\n    # 1. Time Discretization\n    # Add a small epsilon to T to ensure the last point is included by linspace/arange\n    num_steps = int(round(T / dt)) \n    t = np.linspace(0.0, T, num_steps + 1)\n    \n    # 2. Calcium Transient Calculation\n    # Heaviside function is implicitly handled by the time mask\n    time_mask = t >= t0\n    transient_term = np.zeros_like(t)\n    t_active = t[time_mask]\n    \n    # Avoid division by zero if tau_r equals tau_d (not in test cases, but good practice)\n    if tau_r != tau_d:\n        transient_term[time_mask] = C_amp * (np.exp(-(t_active - t0) / tau_d) - np.exp(-(t_active - t0) / tau_r))\n    \n    Ca_t = Ca_rest + transient_term\n    \n    # 3. Attachment Rate Calculation\n    f_t = k * (Ca_t**n) / (Ca_t**n + rho**n)\n\n    # 4. Initial Condition for Attached Fraction A(t)\n    A = np.zeros_like(t)\n    f0 = f_t[0] \n    A[0] = f0 / (f0 + g)\n\n    # 5. Forward Euler Integration\n    for i in range(num_steps):\n        A_i = A[i]\n        f_i = f_t[i]\n        \n        # ODE: dA/dt = f(t)(1-A) - gA\n        dA_dt = f_i * (1 - A_i) - g * A_i\n        \n        # Update step\n        A_next = A_i + dt * dA_dt\n        \n        # Clip to maintain physical bounds 0 = A = 1\n        A[i+1] = max(0.0, min(1.0, A_next))\n        \n    # 6. Active Stress Calculation\n    sigma_t = sigma0 * A\n\n    # 7. Compute Output Metrics\n    # Peak active stress (kPa)\n    sigma_peak = np.max(sigma_t)\n    \n    # Time to peak (ms)\n    # np.argmax() returns the index of the first occurrence of the maximum value\n    peak_index = np.argmax(sigma_t)\n    t_peak_ms = t[peak_index] * 1000.0\n    \n    # Stress-time integral (kPa*s) using the trapezoidal rule\n    integral_I = np.trapz(sigma_t, t)\n    \n    return [sigma_peak, t_peak_ms, integral_I]\n\nsolve()\n```"
        },
        {
            "introduction": "肌细胞产生的力最终汇聚成整个心脏的宏观力学行为。本练习将我们的视角从细胞层面提升到器官层面，将左心室简化为一个受压的厚壁球体来分析其壁应力 。通过比较薄壁（拉普拉斯定律）和厚壁模型的计算结果，我们将探讨不同力学假设的适用范围及其对生物力学分析准确性的影响。",
            "id": "4162666",
            "problem": "将一个加压的左心室（LV）近似为一个厚壁球壳，对其建模以评估收缩末期条件下心内膜（内）表面的周向（环向）柯西应力。假设静态平衡、无彻体力以及不可压缩的血液负载。内半径为 $a = 0.020$ 米，外半径为 $b = 0.035$ 米，内腔压力为 $p = 16$ 千帕。壁厚为 $h = b - a$，中壁半径为 $r_{m} = (a + b)/2$。\n\n任务：\n- 使用源自半径为 $r_{m}$ 的半球自由体上的力平衡推导出的薄壁近似法，计算薄壁假设下内壁的环向应力。从应用于薄膜的静态平衡的牛顿第二定律开始，不要引用任何预先给定的公式。\n- 使用源自静态平衡中的球对称柯西动量方程以及在 $r = a$ 和 $r = b$ 处的适当边界条件推导出的厚壁模型，计算内壁的环向应力，不要使用预先给定的公式。\n\n然后，将相对差异定义为\n$$\\delta = \\frac{|\\sigma_{\\text{Laplace}} - \\sigma_{\\text{thick}}|}{\\sigma_{\\text{thick}}},$$\n并仅报告 $\\delta$ 作为您的最终答案，以小数形式表示（例如，$12\\%$ 表示为 $0.12$）。\n\n将任何中间应力以千帕（kPa）表示。将您的最终答案 $\\delta$ 四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于连续介质力学应用于生物力学的原理，提供了一套适定的条件和参数，并以客观、正式的语言表述。所有必要信息均已提供，所要求的推导和计算是固体力学中的标准程序。\n\n解题过程分为三部分：首先，使用薄壁近似法计算环向应力；其次，使用厚壁模型计算环向应力；第三，计算两个结果之间的相对差异。\n\n**第一部分：薄壁近似法（拉普拉斯定律）**\n\n球形压力容器的薄壁近似法，也称为拉普拉斯定律，是通过对结构半球部分的力平衡推导出来的。问题指定使用中壁半径 $r_m = (a+b)/2$ 和壁厚 $h = b-a$。\n\n根据静态平衡的牛顿第二定律，合力必须为零。我们考虑一个半球自由体图。由内部压力 $p$ 作用在面积为 $\\pi r_m^2$ 的圆形横截面上的力 $F_p$，必须与由环向应力 $\\sigma_{\\text{Laplace}}$ 作用在壁的切割表面（其面积约为 $2\\pi r_m h$）上所产生的拉力 $F_\\sigma$ 相平衡。\n\n来自压力的力是：\n$$F_p = p \\cdot (\\pi r_m^2)$$\n\n来自壁应力的抵抗力是：\n$$F_\\sigma = \\sigma_{\\text{Laplace}} \\cdot (2\\pi r_m h)$$\n\n对于静态平衡，$F_p = F_\\sigma$：\n$$p \\pi r_m^2 = \\sigma_{\\text{Laplace}} (2\\pi r_m h)$$\n\n求解环向应力 $\\sigma_{\\text{Laplace}}$：\n$$\\sigma_{\\text{Laplace}} = \\frac{p \\pi r_m^2}{2\\pi r_m h} = \\frac{p r_m}{2h}$$\n\n给定值为：\n- 内半径：$a = 0.020\\,\\text{m}$\n- 外半径：$b = 0.035\\,\\text{m}$\n- 内部压力：$p = 16\\,\\text{kPa}$\n\n首先，我们计算 $h$ 和 $r_m$：\n$$h = b - a = 0.035\\,\\text{m} - 0.020\\,\\text{m} = 0.015\\,\\text{m}$$\n$$r_m = \\frac{a+b}{2} = \\frac{0.020\\,\\text{m} + 0.035\\,\\text{m}}{2} = \\frac{0.055\\,\\text{m}}{2} = 0.0275\\,\\text{m}$$\n\n现在，我们计算 $\\sigma_{\\text{Laplace}}$：\n$$\\sigma_{\\text{Laplace}} = \\frac{(16\\,\\text{kPa})(0.0275\\,\\text{m})}{2(0.015\\,\\text{m})} = \\frac{0.44}{0.03}\\,\\text{kPa} = \\frac{44}{3}\\,\\text{kPa}$$\n因此，$\\sigma_{\\text{Laplace}} \\approx 14.67\\,\\text{kPa}$。\n\n**第二部分：厚壁模型（Lamé 解）**\n\n对于受内压的厚壁球体，我们从球坐标系中静态平衡的柯西动量方程开始，假设球对称且无彻体力。径向方程为：\n$$\\frac{d\\sigma_{rr}}{dr} + \\frac{2}{r}(\\sigma_{rr} - \\sigma_{\\theta\\theta}) = 0$$\n其中 $\\sigma_{rr}$ 是径向应力，$\\sigma_{\\theta\\theta} = \\sigma_{\\phi\\phi}$ 是周向（环向）应力。\n\n对于线性弹性、各向同性材料，同时满足平衡方程和协调方程的应力通解形式为：\n$$\\sigma_{rr}(r) = A - \\frac{2B}{r^3}$$\n$$\\sigma_{\\theta\\theta}(r) = A + \\frac{B}{r^3}$$\n其中 $A$ 和 $B$ 是由边界条件决定的常数。\n\n边界条件是：\n1.  在内表面（$r=a$），径向应力等于所施加压力的负值：$\\sigma_{rr}(a) = -p$。\n2.  在外表面（$r=b$），假设不受外部压力作用，径向应力为零：$\\sigma_{rr}(b) = 0$。\n\n使用第二个边界条件：\n$$\\sigma_{rr}(b) = A - \\frac{2B}{b^3} = 0 \\implies A = \\frac{2B}{b^3}$$\n\n使用第一个边界条件：\n$$\\sigma_{rr}(a) = A - \\frac{2B}{a^3} = -p$$\n\n将 $A$ 的表达式代入第二个方程：\n$$\\frac{2B}{b^3} - \\frac{2B}{a^3} = -p$$\n$$2B \\left( \\frac{1}{b^3} - \\frac{1}{a^3} \\right) = -p$$\n$$2B \\left( \\frac{a^3 - b^3}{a^3 b^3} \\right) = -p$$\n$$B = \\frac{-p a^3 b^3}{2(a^3 - b^3)} = \\frac{p a^3 b^3}{2(b^3 - a^3)}$$\n\n现在，求解 $A$：\n$$A = \\frac{2}{b^3} \\cdot B = \\frac{2}{b^3} \\left( \\frac{p a^3 b^3}{2(b^3 - a^3)} \\right) = \\frac{p a^3}{b^3 - a^3}$$\n\n环向应力 $\\sigma_{\\theta\\theta}(r)$ 由 $A + B/r^3$ 给出。我们需要求内壁（$r=a$）处的环向应力，我们将其表示为 $\\sigma_{\\text{thick}}$：\n$$\\sigma_{\\text{thick}} = \\sigma_{\\theta\\theta}(a) = A + \\frac{B}{a^3}$$\n$$\\sigma_{\\text{thick}} = \\left( \\frac{p a^3}{b^3 - a^3} \\right) + \\frac{1}{a^3} \\left( \\frac{p a^3 b^3}{2(b^3 - a^3)} \\right)$$\n$$\\sigma_{\\text{thick}} = \\frac{p a^3}{b^3 - a^3} + \\frac{p b^3}{2(b^3 - a^3)}$$\n$$\\sigma_{\\text{thick}} = \\frac{p}{b^3 - a^3} \\left( a^3 + \\frac{b^3}{2} \\right) = \\frac{p(2a^3 + b^3)}{2(b^3 - a^3)}$$\n\n现在，我们代入数值：\n$$a^3 = (0.020\\,\\text{m})^3 = 8 \\times 10^{-6}\\,\\text{m}^3$$\n$$b^3 = (0.035\\,\\text{m})^3 = 42.875 \\times 10^{-6}\\,\\text{m}^3$$\n\n$$\\sigma_{\\text{thick}} = \\frac{16\\,\\text{kPa} \\cdot (2(8 \\times 10^{-6}) + 42.875 \\times 10^{-6})\\,\\text{m}^3}{2 \\cdot (42.875 \\times 10^{-6} - 8 \\times 10^{-6})\\,\\text{m}^3}$$\n$$\\sigma_{\\text{thick}} = \\frac{16 \\cdot (16 + 42.875)}{2 \\cdot (34.875)}\\,\\text{kPa} = \\frac{8 \\cdot (58.875)}{34.875}\\,\\text{kPa}$$\n$$\\sigma_{\\text{thick}} = \\frac{471}{34.875}\\,\\text{kPa} = \\frac{1256}{93}\\,\\text{kPa}$$\n因此，$\\sigma_{\\text{thick}} \\approx 13.51\\,\\text{kPa}$。\n\n**第三部分：相对差异 ($\\delta$)**\n\n相对差异 $\\delta$ 定义为：\n$$\\delta = \\frac{|\\sigma_{\\text{Laplace}} - \\sigma_{\\text{thick}}|}{\\sigma_{\\text{thick}}}$$\n\n使用应力的精确分数值：\n$$\\sigma_{\\text{Laplace}} = \\frac{44}{3}\\,\\text{kPa} = \\frac{44 \\times 31}{3 \\times 31}\\,\\text{kPa} = \\frac{1364}{93}\\,\\text{kPa}$$\n$$\\sigma_{\\text{thick}} = \\frac{1256}{93}\\,\\text{kPa}$$\n\n$$\\delta = \\frac{\\left| \\frac{1364}{93} - \\frac{1256}{93} \\right|}{\\frac{1256}{93}} = \\frac{\\frac{1364 - 1256}{93}}{\\frac{1256}{93}} = \\frac{108}{1256}$$\n\n为简化分数，我们可以将分子和分母除以它们的最大公约数 $4$：\n$$\\delta = \\frac{108 \\div 4}{1256 \\div 4} = \\frac{27}{314}$$\n\n最后，我们计算小数值并按要求四舍五入到四位有效数字：\n$$\\delta = \\frac{27}{314} \\approx 0.08598726...$$\n四舍五入到四位有效数字得到：\n$$\\delta \\approx 0.08599$$",
            "answer": "$$\\boxed{0.08599}$$"
        }
    ]
}