{
    "hands_on_practices": [
        {
            "introduction": "肌丝滑行理论是肌肉力学的基石，它将力的产生与微观结构联系起来。这个练习将指导您基于肌小节的几何结构，从第一性原理推导经典的张力-长度关系，这是理解肌肉主动力产生机制的一项基本技能。通过这个练习，您将把肌动蛋白和肌球蛋白丝的物理尺寸直接与可产生的张力联系起来。",
            "id": "4162667",
            "problem": "横纹肌滑动肌丝模型的一个基本定量特征是，主动力仅在细肌丝（肌动蛋白）与粗肌丝（肌球蛋白）的头部承载部分重叠的区域由横桥产生。在肌节中，粗肌丝中央有一个没有肌球蛋白头部的裸区。考虑一个沿一维坐标从肌节中心（M线）到Z线的对称半肌节描述。长度为 $L_a$ 的细肌丝从Z线向内延伸，总长度为 $L_m$ 的粗肌丝从M线向外延伸；在粗肌丝内部，长度为 $z_b$ 的中央裸区不含任何头部。假设肌球蛋白头部沿其承载区域均匀分布，肌动蛋白结合位点沿细肌丝均匀分布。在这些假设下，潜在横桥的数量与肌动蛋白和肌球蛋白头部区域之间的几何重叠长度成线性比例。\n\n从这个几何图像和上述定义出发，根据第一性原理推导出一个解析表达式，用于描述肌动蛋白与肌球蛋白头部承载区域之间的重叠分数 $f(\\ell_s)$ 作为肌节长度 $\\ell_s$ 的函数。将分数 $f(\\ell_s)$ 定义为整个肌节中重叠的头部区域总长度除以整个肌节中可用的头部区域总长度。然后，使用您推导的表达式，在以下符合生理学实际的参数下，计算 $f(\\ell_s)$ 的数值和相应的主动张力 $\\sigma_{\\mathrm{act}}$：\n- 细肌丝长度 $L_a = 1.05\\,\\mu\\mathrm{m}$，\n- 粗肌丝长度 $L_m = 1.60\\,\\mu\\mathrm{m}$，\n- 裸区长度 $z_b = 0.20\\,\\mu\\mathrm{m}$，\n- 肌节长度 $\\ell_s = 2.50\\,\\mu\\mathrm{m}$，\n- 最大主动应力（完全重叠时的应力） $\\sigma_{\\max} = 120\\,\\mathrm{kPa}$。\n\n假设主动张力与重叠分数成线性正比，即 $\\sigma_{\\mathrm{act}} = \\sigma_{\\max}\\, f(\\ell_s)$。将 $f(\\ell_s)$ 和 $\\sigma_{\\mathrm{act}}$ 的值均四舍五入至四位有效数字。以千帕（kPa）为单位表示主动张力。您的最终答案必须按以下顺序报告两个量：首先是 $f(\\ell_s)$（无量纲），然后是 $\\sigma_{\\mathrm{act}}$（单位为 $\\mathrm{kPa}$）。",
            "solution": "该问题要求推导肌节中重叠分数 $f(\\ell_s)$ 的解析表达式，并随后进行数值计算，同时计算相应的主动张力 $\\sigma_{\\mathrm{act}}$。推导必须基于滑动肌丝模型的几何原理。\n\n首先，我们建立一个坐标系来形式化几何结构。我们考虑一个对称的半肌节，M线位于原点 $x=0$。那么Z线就位于 $x = \\frac{\\ell_s}{2}$，其中 $\\ell_s$ 是总肌节长度。\n\n粗（肌球蛋白）肌丝的总长度为 $L_m$，并以M线为中心。在我们的半肌节模型中，它从 $x=0$ 延伸到 $x=\\frac{L_m}{2}$。粗肌丝有一个总长度为 $z_b$ 的中央裸区，该区域没有肌球蛋白头部。在半肌节中，这个裸区占据区间 $[0, \\frac{z_b}{2}]$。因此，在这个半肌节中，肌球蛋白丝的头部承载区域跨越区间 $[\\frac{z_b}{2}, \\frac{L_m}{2}]$。在一个半肌节中，这个头部承载区域的长度是 $L_{h, \\text{half}} = \\frac{L_m}{2} - \\frac{z_b}{2} = \\frac{L_m - z_b}{2}$。\n\n细（肌动蛋白）肌丝的长度为 $L_a$，并从Z线向内延伸。因此，它在半肌节中的位置是区间 $[\\frac{\\ell_s}{2} - L_a, \\frac{\\ell_s}{2}]$。\n\n主动力的产生与细肌丝和肌球蛋白头部承载区域重叠的区域长度成正比。设半肌节中的这个重叠长度为 $L_{ov, \\text{half}}$。这个长度是两个区间交集的度量：肌球蛋白头部承载区 $[\\frac{z_b}{2}, \\frac{L_m}{2}]$ 和细肌丝区域 $[\\frac{\\ell_s}{2} - L_a, \\frac{\\ell_s}{2}]$。\n\n两个闭区间 $[a, b]$ 和 $[c, d]$ 交集的长度由通用公式 $\\max(0, \\min(b, d) - \\max(a, c))$ 给出。将此公式应用于我们的区间：\n$L_{ov, \\text{half}} = \\max\\left(0, \\min\\left(\\frac{L_m}{2}, \\frac{\\ell_s}{2}\\right) - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s}{2} - L_a\\right)\\right)$\n\n对于生理学相关的肌节长度，肌节比粗肌丝长，即 $\\ell_s > L_m$。给定的参数 $\\ell_s = 2.50\\,\\mu\\mathrm{m}$ 和 $L_m = 1.60\\,\\mu\\mathrm{m}$ 满足此条件。因此，$\\frac{\\ell_s}{2} > \\frac{L_m}{2}$，这将 $\\min$ 项简化为 $\\min(\\frac{L_m}{2}, \\frac{\\ell_s}{2}) = \\frac{L_m}{2}$。重叠长度的表达式变为：\n$L_{ov, \\text{half}} = \\max\\left(0, \\frac{L_m}{2} - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s}{2} - L_a\\right)\\right)$\n\n问题将重叠分数 $f(\\ell_s)$ 定义为整个肌节中重叠的头部区域总长度除以整个肌节中可用的头部区域总长度。\n由于对称性，总重叠长度为 $2 \\times L_{ov, \\text{half}}$。\n可用的头部区域总长度是总肌球蛋白长度减去裸区长度，即 $L_m - z_b$。这也等于 $2 \\times L_{h, \\text{half}}$。\n所以，分数 $f(\\ell_s)$ 为：\n$$f(\\ell_s) = \\frac{2 \\cdot L_{ov, \\text{half}}}{L_m - z_b} = \\frac{2 \\cdot \\max\\left(0, \\frac{L_m}{2} - \\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s - 2L_a}{2}\\right)\\right)}{L_m - z_b}$$\n简化这个表达式，我们得到：\n$$f(\\ell_s) = \\frac{\\max\\left(0, L_m - 2\\max\\left(\\frac{z_b}{2}, \\frac{\\ell_s - 2L_a}{2}\\right)\\right)}{L_m - z_b} = \\frac{\\max\\left(0, L_m - \\max(z_b, \\ell_s - 2L_a)\\right)}{L_m - z_b}$$\n这是重叠分数的通用解析表达式，在 $\\ell_s > L_m$ 时有效。\n\n现在，我们使用提供的参数计算 $f(\\ell_s)$ 的数值：\n$L_a = 1.05\\,\\mu\\mathrm{m}$\n$L_m = 1.60\\,\\mu\\mathrm{m}$\n$z_b = 0.20\\,\\mu\\mathrm{m}$\n$\\ell_s = 2.50\\,\\mu\\mathrm{m}$\n$\\sigma_{\\max} = 120\\,\\mathrm{kPa}$\n\n我们需要计算 $\\max(z_b, \\ell_s - 2L_a)$ 这一项。\n$\\ell_s - 2L_a = 2.50 - 2(1.05) = 2.50 - 2.10 = 0.40\\,\\mu\\mathrm{m}$。\n$z_b$ 的值为 $0.20\\,\\mu\\mathrm{m}$。\n因为 $0.40 > 0.20$，所以我们有 $\\ell_s - 2L_a > z_b$。这种情况在物理上对应于长度-张力曲线的“下降支”，此时细肌丝已被拉过裸区，减少了可用横桥的数量。\n在这种情况下，$\\max(z_b, \\ell_s - 2L_a) = \\ell_s - 2L_a$。\n$f(\\ell_s)$ 的表达式简化为：\n$$f(\\ell_s) = \\frac{L_m - (\\ell_s - 2L_a)}{L_m - z_b} = \\frac{L_m + 2L_a - \\ell_s}{L_m - z_b}$$\n此外，我们必须确保重叠为正，这要求 $L_m + 2L_a - \\ell_s > 0$。\n$1.60 + 2(1.05) - 2.50 = 1.60 + 2.10 - 2.50 = 3.70 - 2.50 = 1.20 > 0$。重叠确实为正。\n\n将数值代入 $f(\\ell_s)$ 的公式中：\n$$f(2.50) = \\frac{1.60 + 2(1.05) - 2.50}{1.60 - 0.20} = \\frac{1.20}{1.40} = \\frac{12}{14} = \\frac{6}{7}$$\n作为小数， $f(2.50) \\approx 0.8571428...$。四舍五入到四位有效数字，得到 $f(2.50) = 0.8571$。\n\n接下来，我们使用线性正比关系 $\\sigma_{\\mathrm{act}} = \\sigma_{\\max}\\, f(\\ell_s)$ 来计算主动张力 $\\sigma_{\\mathrm{act}}$。\n$$\\sigma_{\\mathrm{act}} = 120\\,\\mathrm{kPa} \\times \\frac{6}{7} = \\frac{720}{7}\\,\\mathrm{kPa} \\approx 102.85714...\\,\\mathrm{kPa}$$\n四舍五入到四位有效数字，我们得到 $\\sigma_{\\mathrm{act}} = 102.9\\,\\mathrm{kPa}$。\n所要求的两个量是无量纲分数 $f(\\ell_s)$ 和以千帕为单位的主动张力 $\\sigma_{\\mathrm{act}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8571  & 102.9\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在心脏病学和心脏外科领域，理解心壁内的机械应力至关重要，因为它直接关系到心肌的耗氧量、重塑和病理。我们可以使用连续介质力学模型来估算这种应力，但模型的选择——从简化的拉普拉斯定律到更精确的厚壁模型——取决于心室的几何特征。本练习将对比这两种方法，让您亲手计算这一关键的心脏负荷指标，并理解不同模型假设的适用范围和局限性。",
            "id": "4162666",
            "problem": "一个加压左心室 (LV) 被近似为一个厚壁球壳进行建模，以评估其在收缩末期条件下心内膜 (内) 表面的周向 (环向) 柯西应力。假设系统处于静力平衡状态，不考虑体力，且血液载荷为不可压缩的。内半径为 $a = 0.020$ m，外半径为 $b = 0.035$ m，内腔压力为 $p = 16$ kPa。壁厚为 $h = b - a$，中壁半径为 $r_{m} = (a + b)/2$。\n\n任务：\n- 使用基于中壁半径 $r_m$ 处半球自由体力平衡推导出的薄壁近似法，计算薄壁假设下内壁的环向应力。从应用于薄膜的静力平衡牛顿第二定律开始，不要引用任何预先给定的公式。\n- 使用基于球对称静力平衡柯西动量方程以及在 $r = a$ 和 $r = b$ 处的适当边界条件推导出的厚壁模型，计算内壁的环向应力，不要使用预先给定的公式。\n\n然后，将相对差异定义为\n$$\\delta = \\frac{|\\sigma_{\\text{Laplace}} - \\sigma_{\\text{thick}}|}{\\sigma_{\\text{thick}}},$$\n并仅报告 $\\delta$ 作为您的最终答案，以小数形式表示 (例如，$12\\%$ 表示为 $0.12$)。\n\n以千帕 (kPa) 为单位表示任何中间应力。将您的最终答案 $\\delta$ 四舍五入至四位有效数字。",
            "solution": "经评估，该问题陈述有效。其科学依据是应用于生物力学的连续介质力学原理，提供了一套适定的条件和参数，并以客观、正式的语言表述。所有必要信息均已提供，所要求的推导和计算是固体力学中的标准程序。\n\n解题过程分为三个部分：首先，使用薄壁近似计算环向应力；其次，使用厚壁模型计算环向应力；第三，计算两个结果之间的相对差异。\n\n**第 1 部分：薄壁近似 (拉普拉斯定律)**\n\n球形压力容器的薄壁近似，也称为拉普拉斯定律，是通过对结构半球部分的力平衡推导出来的。问题指定使用中壁半径 `$r_m = (a+b)/2$` 和壁厚 `$h = b-a$`。\n\n根据静力平衡的牛顿第二定律，力的总和必须为零。我们考虑一个半球自由体图。由内压 `$p$` 施加在面积为 `$\\pi r_m^2$` 的圆形横截面上的力 `$F_p$`，必须与由环向应力 `$\\sigma_{\\text{Laplace}}$` 作用在壁的切割表面（其面积约为 `$2\\pi r_m h$`）上的拉伸力 `$F_\\sigma$` 相平衡。\n\n来自压力的力是：\n$$F_p = p \\cdot (\\pi r_m^2)$$\n\n来自壁应力的抵抗力是：\n$$F_\\sigma = \\sigma_{\\text{Laplace}} \\cdot (2\\pi r_m h)$$\n\n对于静力平衡，`$F_p = F_\\sigma$`：\n$$p \\pi r_m^2 = \\sigma_{\\text{Laplace}} (2\\pi r_m h)$$\n\n求解环向应力 `$\\sigma_{\\text{Laplace}}$`：\n$$\\sigma_{\\text{Laplace}} = \\frac{p \\pi r_m^2}{2\\pi r_m h} = \\frac{p r_m}{2h}$$\n\n给定值为：\n- 内半径：`$a = 0.020\\,\\text{m}$`\n- 外半径：`$b = 0.035\\,\\text{m}$`\n- 内压：`$p = 16\\,\\text{kPa}$`\n\n首先，我们计算 `$h$` 和 `$r_m$`：\n$$h = b - a = 0.035\\,\\text{m} - 0.020\\,\\text{m} = 0.015\\,\\text{m}$$\n$$r_m = \\frac{a+b}{2} = \\frac{0.020\\,\\text{m} + 0.035\\,\\text{m}}{2} = \\frac{0.055\\,\\text{m}}{2} = 0.0275\\,\\text{m}$$\n\n现在，我们计算 `$\\sigma_{\\text{Laplace}}$`：\n$$\\sigma_{\\text{Laplace}} = \\frac{(16\\,\\text{kPa})(0.0275\\,\\text{m})}{2(0.015\\,\\text{m})} = \\frac{0.44}{0.03}\\,\\text{kPa} = \\frac{44}{3}\\,\\text{kPa}$$\n因此，`$\\sigma_{\\text{Laplace}} \\approx 14.67\\,\\text{kPa}$`。\n\n**第 2 部分：厚壁模型 (拉梅解)**\n\n对于承受内压的厚壁球体，我们从球坐标系中的静力平衡柯西动量方程开始，假设球对称且无体力。径向方程为：\n$$\\frac{d\\sigma_{rr}}{dr} + \\frac{2}{r}(\\sigma_{rr} - \\sigma_{\\theta\\theta}) = 0$$\n其中 `$\\sigma_{rr}$` 是径向应力，`$\\sigma_{\\theta\\theta} = \\sigma_{\\phi\\phi}$` 是周向 (环向) 应力。\n\n对于线性弹性、各向同性的材料，同时满足平衡方程和相容性方程的应力通解形式为：\n$$\\sigma_{rr}(r) = A - \\frac{2B}{r^3}$$\n$$\\sigma_{\\theta\\theta}(r) = A + \\frac{B}{r^3}$$\n其中 `$A$` 和 `$B$` 是由边界条件决定的常数。\n\n边界条件是：\n1.  在内表面 (`$r=a$`)，径向应力等于施加压力的负值：`$\\sigma_{rr}(a) = -p$`。\n2.  在外表面 (`$r=b$`)，假设不受外部压力，径向应力为零：`$\\sigma_{rr}(b) = 0$`。\n\n使用第二个边界条件：\n$$\\sigma_{rr}(b) = A - \\frac{2B}{b^3} = 0 \\implies A = \\frac{2B}{b^3}$$\n\n使用第一个边界条件：\n$$\\sigma_{rr}(a) = A - \\frac{2B}{a^3} = -p$$\n\n将 `$A$` 的表达式代入第二个方程：\n$$\\frac{2B}{b^3} - \\frac{2B}{a^3} = -p$$\n$$2B \\left( \\frac{1}{b^3} - \\frac{1}{a^3} \\right) = -p$$\n$$2B \\left( \\frac{a^3 - b^3}{a^3 b^3} \\right) = -p$$\n$$B = \\frac{-p a^3 b^3}{2(a^3 - b^3)} = \\frac{p a^3 b^3}{2(b^3 - a^3)}$$\n\n现在，求解 `$A$`：\n$$A = \\frac{2}{b^3} \\cdot B = \\frac{2}{b^3} \\left( \\frac{p a^3 b^3}{2(b^3 - a^3)} \\right) = \\frac{p a^3}{b^3 - a^3}$$\n\n环向应力 `$\\sigma_{\\theta\\theta}(r)$` 由 `$A + B/r^3$` 给出。我们需要求内壁 (`$r=a$`) 处的环向应力，我们将其表示为 `$\\sigma_{\\text{thick}}$`：\n$$\\sigma_{\\text{thick}} = \\sigma_{\\theta\\theta}(a) = A + \\frac{B}{a^3}$$\n$$\\sigma_{\\text{thick}} = \\left( \\frac{p a^3}{b^3 - a^3} \\right) + \\frac{1}{a^3} \\left( \\frac{p a^3 b^3}{2(b^3 - a^3)} \\right)$$\n$$\\sigma_{\\text{thick}} = \\frac{p a^3}{b^3 - a^3} + \\frac{p b^3}{2(b^3 - a^3)}$$\n$$\\sigma_{\\text{thick}} = \\frac{p}{b^3 - a^3} \\left( a^3 + \\frac{b^3}{2} \\right) = \\frac{p(2a^3 + b^3)}{2(b^3 - a^3)}$$\n\n现在，我们代入数值：\n$$a^3 = (0.020\\,\\text{m})^3 = 8 \\times 10^{-6}\\,\\text{m}^3$$\n$$b^3 = (0.035\\,\\text{m})^3 = 42.875 \\times 10^{-6}\\,\\text{m}^3$$\n\n$$\\sigma_{\\text{thick}} = \\frac{16\\,\\text{kPa} \\cdot (2(8 \\times 10^{-6}) + 42.875 \\times 10^{-6})\\,\\text{m}^3}{2 \\cdot (42.875 \\times 10^{-6} - 8 \\times 10^{-6})\\,\\text{m}^3}$$\n$$\\sigma_{\\text{thick}} = \\frac{16 \\cdot (16 + 42.875)}{2 \\cdot (34.875)}\\,\\text{kPa} = \\frac{8 \\cdot (58.875)}{34.875}\\,\\text{kPa}$$\n$$\\sigma_{\\text{thick}} = \\frac{471}{34.875}\\,\\text{kPa} = \\frac{1256}{93}\\,\\text{kPa}$$\n因此，`$\\sigma_{\\text{thick}} \\approx 13.51\\,\\text{kPa}$`。\n\n**第 3 部分：相对差异 (`$\\delta$`*)**\n\n相对差异 `$\\delta$` 定义为：\n$$\\delta = \\frac{|\\sigma_{\\text{Laplace}} - \\sigma_{\\text{thick}}|}{\\sigma_{\\text{thick}}}$$\n\n使用应力的精确分数值：\n$$\\sigma_{\\text{Laplace}} = \\frac{44}{3}\\,\\text{kPa} = \\frac{44 \\times 31}{3 \\times 31}\\,\\text{kPa} = \\frac{1364}{93}\\,\\text{kPa}$$\n$$\\sigma_{\\text{thick}} = \\frac{1256}{93}\\,\\text{kPa}$$\n\n$$\\delta = \\frac{\\left| \\frac{1364}{93} - \\frac{1256}{93} \\right|}{\\frac{1256}{93}} = \\frac{\\frac{1364 - 1256}{93}}{\\frac{1256}{93}} = \\frac{108}{1256}$$\n\n为了简化分数，我们可以将分子和分母除以它们的最大公约数 `$4$`：\n$$\\delta = \\frac{108 \\div 4}{1256 \\div 4} = \\frac{27}{314}$$\n\n最后，我们计算小数值并按要求四舍五入到四位有效数字：\n$$\\delta = \\frac{27}{314} \\approx 0.08598726...$$\n四舍五入到四位有效数字得到：\n$$\\delta \\approx 0.08599$$",
            "answer": "$$\\boxed{0.08599}$$"
        },
        {
            "introduction": "虽然静态模型为了解心肌功能提供了基础，但心脏的本质是动态的。通过模拟由细胞内钙瞬变驱动的横桥循环动力学，我们可以重现肌肉力的时间历程，即“抽搐”过程。这项计算实践将向您介绍动力学建模和数值积分方法，这些强大的工具可用于探索细胞参数（如钙处理或蛋白质动力学）的变化如何影响整体肌肉功能。",
            "id": "4162691",
            "problem": "您的任务是通过对一个由细胞内钙瞬变驱动的时变横桥附着率进行积分，来计算心肌的等长抽搐主动应力时间进程。计算必须从生物力学的第一性原理出发，并在预定的时间网格上使用前向欧拉数值时间积分方案。该系统是等长的，因此肌小节长度是固定的，力的变化完全由附着和脱离动力学引起。\n\n基本原理和定义：\n1. 令 $[\\mathrm{Ca}^{2+}](t)$ 表示游离胞质钙浓度，单位为微摩尔（micromolar），其由一个具有有限静息基线的生理学上真实的双指数瞬变定义：\n$$\n[\\mathrm{Ca}^{2+}](t) = [\\mathrm{Ca}^{2+}]_{\\text{rest}} + C_{\\text{amp}} \\left(e^{-\\frac{(t - t_0)}{\\tau_d}} - e^{-\\frac{(t - t_0)}{\\tau_r}}\\right) H(t - t_0),\n$$\n其中 $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ 是静息钙浓度，单位为 $\\mu\\mathrm{M}$；$C_{\\text{amp}}$ 是振幅，单位为 $\\mu\\mathrm{M}$；$\\tau_r$ 是上升时间常数，单位为 $\\mathrm{s}$；$\\tau_d$ 是衰减时间常数，单位为 $\\mathrm{s}$；$t_0$ 是激活起始时间，单位为 $\\mathrm{s}$；$H(\\cdot)$ 是亥维赛阶跃函数，当 $x<0$ 时 $H(x)=0$，当 $x \\ge 0$ 时 $H(x)=1$。\n\n2. 生物化学横桥附着率 $f(t)$ 通过希尔关系依赖于钙：\n$$\nf(t) = k \\cdot \\frac{([\\mathrm{Ca}^{2+}](t))^{n}}{([\\mathrm{Ca}^{2+}](t))^{n} + \\rho^{n}},\n$$\n其中 $k$ 是最大附着率，单位为 $\\mathrm{s}^{-1}$；$\\rho$ 是半激活钙浓度，单位为 $\\mu\\mathrm{M}$；$n$ 是希尔系数（无量纲）。使用 $n=3$。\n\n3. 脱离率 $g$ 是一个常数，单位为 $\\mathrm{s}^{-1}$。\n\n4. 已附着横桥的比例 $A(t)$ 遵循质量作用动力学：\n$$\n\\frac{dA}{dt} = f(t)\\big(1 - A(t)\\big) - g\\,A(t),\n$$\n在 $t=0$ 时的物理一致初始条件取为 $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ 下的静息稳态：\n$$\nA(0) = \\frac{f(0)}{f(0) + g}, \\quad \\text{其中 } f(0) = k \\cdot \\frac{([\\mathrm{Ca}^{2+}]_{\\text{rest}})^{n}}{([\\mathrm{Ca}^{2+}]_{\\text{rest}})^{n} + \\rho^{n}}.\n$$\n\n5. 等长主动应力 $\\sigma(t)$（单位为 $\\mathrm{kPa}$）与已附着比例成正比：\n$$\n\\sigma(t) = \\sigma_0 \\, A(t),\n$$\n其中 $\\sigma_0$ 是在饱和钙浓度下，当 $A(t) \\to 1$ 时实现的最大主动应力，单位为 $\\mathrm{kPa}$。\n\n数值积分要求：\n- 使用固定时间步长 $\\Delta t$ 的前向欧拉方案对 $\\frac{dA}{dt}$ 进行积分，按如下方式更新 $A$：\n$$\nA_{i+1} = A_i + \\Delta t \\cdot \\left( f(t_i)\\big(1 - A_i\\big) - g\\,A_i \\right),\n$$\n其中 $t_i = i \\cdot \\Delta t$ 且 $A_i \\approx A(t_i)$。\n- 在每一步通过裁剪到区间 $[0,1]$ 来强制执行物理约束 $0 \\le A(t) \\le 1$。\n- 在每个时间点计算主动应力 $\\sigma_i = \\sigma_0 A_i$。\n\n每个测试用例需要计算的输出：\n- 主动应力峰值 $\\sigma_{\\text{peak}}$，单位为 $\\mathrm{kPa}$。\n- 达峰时间 $t_{\\text{peak}}$，单位为 $\\mathrm{ms}$，定义为 $\\sigma(t)$ 达到其最大值的最早模拟时间。\n- 应力-时间积分 $I = \\int_{0}^{T} \\sigma(t) \\, dt$，单位为 $\\mathrm{kPa}\\cdot\\mathrm{s}$，在模拟持续时间内使用梯形法则计算。\n\n答案单位规范：\n- 以 $\\mathrm{kPa}$ 表示 $\\sigma_{\\text{peak}}$。\n- 以 $\\mathrm{ms}$ 表示 $t_{\\text{peak}}$。\n- 以 $\\mathrm{kPa}\\cdot\\mathrm{s}$ 表示 $I$。\n\n时间离散化与积分窗口：\n- 使用每个测试用例中指定的总模拟时间 $T$ 和时间步长 $\\Delta t$；所有时间单位为 $\\mathrm{s}$，时间步长单位为 $\\mathrm{s}$。\n\n测试套件：\n为以下四个参数集提供结果。所有钙浓度单位为 $\\mu\\mathrm{M}$，速率单位为 $\\mathrm{s}^{-1}$，时间单位为 $\\mathrm{s}$，应力单位为 $\\mathrm{kPa}$。\n\n- 测试用例 1（基线类人抽搐）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.9$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- 测试用例 2（钙可用性降低）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.3$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- 测试用例 3（更快的脱离）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 120$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0.9$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n- 测试用例 4（边界情况，无抽搐）：\n  - $k = 200$\n  - $\\rho = 0.5$\n  - $g = 50$\n  - $n = 3$\n  - $[\\mathrm{Ca}^{2+}]_{\\text{rest}} = 0.05$\n  - $C_{\\text{amp}} = 0$\n  - $\\tau_r = 0.03$\n  - $\\tau_d = 0.2$\n  - $t_0 = 0$\n  - $\\sigma_0 = 80$\n  - $T = 0.8$\n  - $\\Delta t = 1\\times 10^{-4}$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例贡献一个格式为 $[\\sigma_{\\text{peak}},t_{\\text{peak}},I]$ 的三元组，因此总体输出是一个三元组列表，例如：\n$$\n[[\\sigma_{\\text{peak},1}, t_{\\text{peak},1}, I_1],[\\sigma_{\\text{peak},2}, t_{\\text{peak},2}, I_2],[\\sigma_{\\text{peak},3}, t_{\\text{peak},3}, I_3],[\\sigma_{\\text{peak},4}, t_{\\text{peak},4}, I_4]]\n$$\n所有数值必须为浮点数。",
            "solution": "用户提供的问题具有科学依据、提法明确且客观。它描述了一个标准但简化的心肌兴奋-收缩耦合模型，并要求提供数值解。所有参数、方程、初始条件和数值方法都已明确定义。所要求的输出是明确无误的。因此，该问题被认为是**有效的**。\n\n该问题要求通过数值求解一个模拟潜在生物力学和生物化学过程的方程组，来计算心肌中的等长主动应力时间进程 $\\sigma(t)$。该解决方案涉及多个步骤，这些步骤基于已建立的肌肉生理学和数值分析原理。\n\n### 1. 模拟生理级联反应\n\n该模型建立了从细胞电生理学（由钙瞬变代表）到宏观力学（主动应力产生）的因果链。\n\n**a. 细胞内钙瞬变, $[\\mathrm{Ca}^{2+}](t)$:**\n肌肉收缩的触发因素是细胞内游离钙浓度 $[\\mathrm{Ca}^{2+}](t)$ 的瞬时升高。问题使用一个唯象模型来定义它，即一个叠加在静息基线浓度 $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ 上的双指数函数。这是一个常见且生理上真实的表示方法。方程为：\n$$\n[\\mathrm{Ca}^{2+}](t) = [\\mathrm{Ca}^{2+}]_{\\text{rest}} + C_{\\text{amp}} \\left(e^{-\\frac{(t - t_0)}{\\tau_d}} - e^{-\\frac{(t - t_0)}{\\tau_r}}\\right) H(t - t_0)\n$$\n这里，$t$ 是时间，单位为秒（$\\mathrm{s}$）；$C_{\\text{amp}}$ 是瞬变振幅，单位为微摩尔（$\\mu\\mathrm{M}$）；$\\tau_r$ 和 $\\tau_d$ 分别是上升和衰减时间常数，单位为 $\\mathrm{s}$；$t_0$ 是刺激的起始时间，单位为 $\\mathrm{s}$；$H(\\cdot)$ 是亥维赛阶跃函数，确保瞬变从 $t=t_0$ 开始。\n\n**b. 钙依赖性横桥附着率, $f(t)$:**\n钙离子与调节蛋白（心肌中的肌钙蛋白 C）结合，从而允许肌动蛋白和肌球蛋白丝之间形成产生力的横桥。这个协同结合过程使用希尔方程建模，该方程将钙浓度与横桥附着率 $f(t)$ 联系起来：\n$$\nf(t) = k \\cdot \\frac{([\\mathrm{Ca}^{2+}](t))^{n}}{([\\mathrm{Ca}^{2+}](t))^{n} + \\rho^{n}}\n$$\n其中 $k$ 是饱和钙水平下的最大附着率，单位为 $\\mathrm{s}^{-1}$；$\\rho$ 是半最大激活时的钙浓度，单位为 $\\mu\\mathrm{M}$；$n$ 是希尔系数，描述了响应的陡峭度（协同性）。问题指定 $n=3$。\n\n**c. 横桥动力学与附着横桥的比例, $A(t)$:**\n横桥群体的动力学由一级质量作用动力学描述。已附着横桥比例 $A(t)$ 的变化率取决于作用于可用（未附着）横桥群体 $(1-A(t))$ 的附着率 $f(t)$，以及作用于已附着横桥群体 $A(t)$ 的恒定脱离率 $g$（单位为 $\\mathrm{s}^{-1}$）。这导出了常微分方程 (ODE)：\n$$\n\\frac{dA}{dt} = f(t)\\big(1 - A(t)\\big) - g\\,A(t)\n$$\n假设系统在时间 $t=0$ 时处于静息稳态，该状态由静息钙浓度 $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ 决定。通过在静息附着率 $f(0)$ 下设置 $\\frac{dA}{dt} = 0$ 来找到初始条件 $A(0)$：\n$$\nf(0)\\big(1 - A(0)\\big) - g\\,A(0) = 0 \\implies A(0) = \\frac{f(0)}{f(0) + g}\n$$\n其中 $f(0)$ 是使用希尔方程中的 $[\\mathrm{Ca}^{2+}]_{\\text{rest}}$ 计算得出的。\n\n**d. 等长主动应力, $\\sigma(t)$:**\n由肌肉产生的宏观主动应力 $\\sigma(t)$ 被假定为与已附着、产生力的横桥比例 $A(t)$ 成正比。比例常数 $\\sigma_0$（单位为千帕, $\\mathrm{kPa}$）表示如果所有可能的横桥都附着 ($A(t)=1$) 时将产生的最大应力。\n$$\n\\sigma(t) = \\sigma_0 \\, A(t)\n$$\n\n### 2. 数值实现\n\n$A(t)$ 的常微分方程在时变 $f(t)$ 的驱动下没有简单的解析解，因此需要采用数值方法。\n\n**a. 时间离散化:**\n从 $t=0$ 到 $t=T$ 的模拟时间窗口被离散化为一系列点 $t_i = i \\cdot \\Delta t$，其中 $\\Delta t$ 是固定的时间步长，$i$ 是从 $0$ 到 $N = T/\\Delta t$ 的整数索引。\n\n**b. 前向欧拉积分:**\n问题指定使用前向欧拉法来对 $A(t)$ 的常微分方程进行积分。在时间 $t_i$ 的导数 $\\frac{dA}{dt}$ 近似为 $\\frac{A_{i+1} - A_i}{\\Delta t}$。将此代入常微分方程，得到从已知状态 $A_i \\approx A(t_i)$ 求解状态 $A_{i+1} \\approx A(t_{i+1})$ 的更新规则：\n$$\n\\frac{A_{i+1} - A_i}{\\Delta t} = f(t_i)\\big(1 - A_i\\big) - g\\,A_i\n$$\n$$\nA_{i+1} = A_i + \\Delta t \\cdot \\left( f(t_i)\\big(1 - A_i\\big) - g\\,A_i \\right)\n$$\n此计算从 $i=0$ 到 $N-1$ 对每个时间步迭代执行。为确保物理真实性，每一步都将 $A_{i+1}$ 的值约束在区间 $[0,1]$ 内。这种裁剪可防止数值解违反 $A(t)$ 作为比例的定义。\n\n**c. 输出计算:**\n一旦计算出附着比例的时间序列 $A_i$，就可以得到应力时间序列 $\\sigma_i = \\sigma_0 A_i$。从该序列中，计算所需的输出指标：\n- **主动应力峰值 ($\\sigma_{\\text{peak}}$):** 计算出的应力数组中的最大值，$\\sigma_{\\text{peak}} = \\max_i(\\sigma_i)$。\n- **达峰时间 ($t_{\\text{peak}}$):** 应力达到其峰值的最早时间 $t_j$。这通过确定应力数组中最大值首次出现的索引 $j$，然后找到相应的时间 $t_j = j \\cdot \\Delta t$ 来实现。结果转换为毫秒 ($\\mathrm{ms}$)。\n- **应力-时间积分 ($I$):** 通过对应力曲线进行积分来计算模拟期间的总机械冲量。问题指定使用梯形法则进行此数值积分：\n$$\nI = \\int_{0}^{T} \\sigma(t) \\, dt \\approx \\sum_{i=0}^{N-1} \\frac{\\sigma_i + \\sigma_{i+1}}{2} \\Delta t\n$$\n这可以使用标准数值库函数高效计算。\n\n总体算法包括：设置时间网格，计算初始条件 $A(0)$，为所有时间点预计算时变钙浓度 $[\\mathrm{Ca}^{2+}](t_i)$ 和附着率 $f(t_i)$，迭代前向欧拉步骤以找到 $A(t_i)$，计算 $\\sigma(t_i)$，最后从得到的应力曲线中提取三个指定的指标。对四个测试用例中的每一个重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the cardiac muscle biomechanics problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases as a list of dictionaries.\n    test_cases = [\n        # Test case 1 (baseline human-like twitch)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.9, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 2 (reduced calcium availability)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.3, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 3 (faster detachment)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 120.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.9, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        },\n        # Test case 4 (boundary case, no twitch)\n        {\n            \"k\": 200.0, \"rho\": 0.5, \"g\": 50.0, \"n\": 3.0, \"Ca_rest\": 0.05,\n            \"C_amp\": 0.0, \"tau_r\": 0.03, \"tau_d\": 0.2, \"t0\": 0.0,\n            \"sigma0\": 80.0, \"T\": 0.8, \"dt\": 1e-4\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result_triplet = compute_twitch_dynamics(params)\n        results.append(result_triplet)\n\n    # Format the final output string as a list of lists.\n    # The map(str, results) correctly converts each inner list to its string representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef compute_twitch_dynamics(params):\n    \"\"\"\n    Computes the isometric twitch dynamics for a single set of parameters.\n\n    Args:\n        params (dict): A dictionary containing all model and simulation parameters.\n\n    Returns:\n        list: A list containing [sigma_peak, t_peak_ms, integral_I].\n    \"\"\"\n    # Unpack parameters\n    k, rho, g, n, Ca_rest = params[\"k\"], params[\"rho\"], params[\"g\"], params[\"n\"], params[\"Ca_rest\"]\n    C_amp, tau_r, tau_d, t0 = params[\"C_amp\"], params[\"tau_r\"], params[\"tau_d\"], params[\"t0\"]\n    sigma0, T, dt = params[\"sigma0\"], params[\"T\"], params[\"dt\"]\n\n    # 1. Time Discretization\n    # Add a small epsilon to T to ensure the last point is included by linspace/arange\n    num_steps = int(round(T / dt)) \n    t = np.linspace(0.0, T, num_steps + 1)\n    \n    # 2. Calcium Transient Calculation\n    # Heaviside function is implicitly handled by the time mask\n    time_mask = t >= t0\n    transient_term = np.zeros_like(t)\n    t_active = t[time_mask]\n    \n    # Avoid division by zero if tau_r equals tau_d (not in test cases, but good practice)\n    if tau_r != tau_d:\n        transient_term[time_mask] = C_amp * (np.exp(-(t_active - t0) / tau_d) - np.exp(-(t_active - t0) / tau_r))\n    \n    Ca_t = Ca_rest + transient_term\n    \n    # 3. Attachment Rate Calculation\n    f_t = k * (Ca_t**n) / (Ca_t**n + rho**n)\n\n    # 4. Initial Condition for Attached Fraction A(t)\n    A = np.zeros_like(t)\n    f0 = f_t[0] \n    A[0] = f0 / (f0 + g)\n\n    # 5. Forward Euler Integration\n    for i in range(num_steps):\n        A_i = A[i]\n        f_i = f_t[i]\n        \n        # ODE: dA/dt = f(t)(1-A) - gA\n        dA_dt = f_i * (1 - A_i) - g * A_i\n        \n        # Update step\n        A_next = A_i + dt * dA_dt\n        \n        # Clip to maintain physical bounds 0 = A = 1\n        A[i+1] = max(0.0, min(1.0, A_next))\n        \n    # 6. Active Stress Calculation\n    sigma_t = sigma0 * A\n\n    # 7. Compute Output Metrics\n    # Peak active stress (kPa)\n    sigma_peak = np.max(sigma_t)\n    \n    # Time to peak (ms)\n    # np.argmax() returns the index of the first occurrence of the maximum value\n    peak_index = np.argmax(sigma_t)\n    t_peak_ms = t[peak_index] * 1000.0\n    \n    # Stress-time integral (kPa*s) using the trapezoidal rule\n    integral_I = np.trapz(sigma_t, t)\n    \n    return [sigma_peak, t_peak_ms, integral_I]\n\nsolve()\n```"
        }
    ]
}