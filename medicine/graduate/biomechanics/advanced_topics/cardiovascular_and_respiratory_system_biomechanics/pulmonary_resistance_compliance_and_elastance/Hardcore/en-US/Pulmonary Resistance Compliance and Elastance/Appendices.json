{
    "hands_on_practices": [
        {
            "introduction": "The foundation of clinical respiratory mechanics lies in translating raw data from mechanical ventilators into meaningful physiological parameters. This practice connects the theoretical single-compartment model, governed by the equation of motion $P_{aw}(t) = P_0 + R \\, Q(t) + E \\, V(t)$, to readily available clinical measurements. By analyzing the peak inspiratory pressure ($P_{peak}$) and plateau pressure ($P_{plat}$) during a specific maneuver, you will learn to calculate the fundamental properties of airway resistance ($R$) and respiratory system elastance ($E$), providing a first quantitative look into a patient's lung function.",
            "id": "4200637",
            "problem": "Consider the single-compartment lung model that relates measured airway pressure to flow and volume during mechanical ventilation. The model is defined by the constitutive relationship $P_{aw}(t) = P_0 + R \\, Q(t) + E \\, V(t)$, where $P_{aw}(t)$ is the airway pressure in $\\text{cmH}_2\\text{O}$, $P_0$ is the baseline pressure due to Positive End-Expiratory Pressure (PEEP) in $\\text{cmH}_2\\text{O}$, $R$ is pulmonary resistance in $\\text{cmH}_2\\text{O}\\cdot\\text{s/L}$, $Q(t)$ is inspiratory flow in $\\text{L/s}$, $E$ is elastance in $\\text{cmH}_2\\text{O/L}$, and $V(t)$ is lung volume above end-expiratory level in $\\text{L}$. Compliance $C$ is the reciprocal of elastance, so $C = 1/E$ in $\\text{L/cmH}_2\\text{O}$. Under volume-controlled ventilation with constant inspiratory flow $Q(t) = F$ during inspiration and an end-inspiratory hold, the inspiratory volume satisfies $V(t) = \\int_0^t Q(\\tau) \\, d\\tau = F \\, t$ for $t \\in [0, T_{insp}]$, where the inspiratory time is $T_{insp} = V_T / F$ and $V_T$ is tidal volume. Just before the end-inspiratory hold, the peak airway pressure $P_{peak}$ occurs while $Q(t) = F$, and during the plateau, the flow is zero so the plateau pressure $P_{plat}$ reflects only the elastic component. Derive expressions for $R$ and $E$ using measured $P_{peak}$, $P_{plat}$, $V_T$, $F$, and $P_0$, then assess the model fit by computing residuals between measured airway pressure samples and the model-predicted airway pressure at the corresponding times. The residual at time $t_i$ is $r_i = P_{meas}(t_i) - P_{model}(t_i)$, where $P_{model}(t)$ is given by the single-compartment model using the derived $R$ and $E$, with $Q(t) = F$ and $V(t) = F t$ for $t \\le T_{insp}$, and $Q(t) = 0$, $V(t) = V_T$ for $t  T_{insp}$. For each test case, compute the following outputs: $R$ in $\\text{cmH}_2\\text{O}\\cdot\\text{s/L}$, $E$ in $\\text{cmH}_2\\text{O/L}$, root-mean-square error $\\sqrt{\\frac{1}{N}\\sum_{i=1}^N r_i^2}$ in $\\text{cmH}_2\\text{O}$, mean residual $\\frac{1}{N}\\sum_{i=1}^N r_i$ in $\\text{cmH}_2\\text{O}$, and maximum absolute residual $\\max_i |r_i|$ in $\\text{cmH}_2\\text{O}$. Express all numerical outputs as floating-point numbers rounded to three decimal places. The angle unit is not applicable. The program must output a single line containing a comma-separated list of per-case results, each result being a list in the order $[R, E, \\mathrm{RMSE}, \\mathrm{mean\\_residual}, \\mathrm{max\\_abs\\_residual}]$, enclosed overall in square brackets.\n\nUse the following test suite of parameter values and measured samples. Each test case provides constant inspiratory flow $F$ in $\\text{L/s}$, tidal volume $V_T$ in $\\text{L}$, PEEP $P_0$ in $\\text{cmH}_2\\text{O}$, peak pressure $P_{peak}$ in $\\text{cmH}_2\\text{O}$, plateau pressure $P_{plat}$ in $\\text{cmH}_2\\text{O}$, a time vector $t$ in $\\text{s}$, and measured airway pressure samples $P_{meas}$ in $\\text{cmH}_2\\text{O}$. The inspiratory time is $T_{insp} = V_T / F$. For $t_i \\le T_{insp}$, measured samples correspond to inspiration under constant flow; for $t_i  T_{insp}$, measured samples correspond to the plateau (end-inspiratory hold).\n\nTest case $1$ (typical mechanics):\n- $F = 0.5$, $V_T = 0.5$, $P_0 = 5.0$, $P_{peak} = 20.0$, $P_{plat} = 15.0$\n- $t = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]$\n- $P_{meas} = [10.1, 11.9, 14.2, 16.0, 18.1, 20.0, 15.2, 14.8]$\n\nTest case $2$ (elevated resistance):\n- $F = 0.6$, $V_T = 0.48$, $P_0 = 8.0$, $P_{peak} = 29.0$, $P_{plat} = 14.0$\n- $t = [0.0, 0.16, 0.32, 0.48, 0.64, 0.80, 0.96, 1.12]$\n- $P_{meas} = [23.0, 24.3, 25.5, 26.5, 27.9, 29.1, 14.2, 13.9]$\n\nTest case $3$ (low compliance, high elastance):\n- $F = 0.5$, $V_T = 0.35$, $P_0 = 12.0$, $P_{peak} = 35.5$, $P_{plat} = 29.5$\n- $t = [0.0, 0.14, 0.28, 0.42, 0.56, 0.70, 0.84, 0.98]$\n- $P_{meas} = [18.1, 21.6, 25.1, 28.6, 31.9, 35.6, 29.4, 29.6]$\n\nTest case $4$ (low flow, small volume):\n- $F = 0.2$, $V_T = 0.3$, $P_0 = 10.0$, $P_{peak} = 20.6$, $P_{plat} = 19.0$\n- $t = [0.0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1]$\n- $P_{meas} = [11.5, 13.5, 15.2, 17.1, 18.7, 20.7, 19.1, 18.8]$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the per-test-case list $[R, E, \\mathrm{RMSE}, \\mathrm{mean\\_residual}, \\mathrm{max\\_abs\\_residual}]$. For example, the format should be $[[r_1,e_1,\\mathrm{rmse}_1,\\mu_1,m_1],[r_2,e_2,\\mathrm{rmse}_2,\\mu_2,m_2],\\dots]$ with all values rounded to three decimal places and expressed in the units specified above.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of respiratory mechanics, mathematically well-posed, and provides a complete and consistent set of data for analysis. We will proceed with the derivation of the required parameters and the statistical analysis of the model fit.\n\nThe single-compartment model of the respiratory system relates airway pressure, $P_{aw}(t)$, to flow, $Q(t)$, and volume, $V(t)$, via the linear ordinary differential equation known as the equation of motion:\n$$P_{aw}(t) = P_0 + R \\, Q(t) + E \\, V(t)$$\nwhere $P_0$ is the Positive End-Expiratory Pressure (PEEP), $R$ is the airway resistance, and $E$ is the elastance of the respiratory system.\n\nThe problem specifies a volume-controlled ventilation mode with a constant inspiratory flow, $F$. During the inspiratory phase, which lasts for an inspiratory time $T_{insp}$, the flow is $Q(t) = F$ and the volume increases linearly with time: $V(t) = \\int_0^t Q(\\tau) \\, d\\tau = F \\cdot t$. Inspiration ends when the delivered volume equals the tidal volume, $V_T$. Thus, $T_{insp} = V_T / F$.\n\nThe problem requires deriving expressions for resistance $R$ and elastance $E$ from specific pressure measurements taken during the respiratory cycle.\n\n**Step 1: Derivation of Elastance ($E$)**\n\nThe plateau pressure, $P_{plat}$, is measured during an end-inspiratory hold. During this maneuver, the flow into the lungs is zero, $Q(t) = 0$, and the lung volume is held constant at the tidal volume, $V(t) = V_T$. Substituting these conditions into the equation of motion:\n$$P_{plat} = P_0 + R \\cdot (0) + E \\cdot V_T$$\n$$P_{plat} = P_0 + E V_T$$\nThis equation isolates the elastic component of pressure. We can rearrange it to solve for elastance, $E$:\n$$E = \\frac{P_{plat} - P_0}{V_T}$$\nThis expression is valid provided $V_T \\neq 0$, a condition inherent to ventilation.\n\n**Step 2: Derivation of Resistance ($R$)**\n\nThe peak inspiratory pressure, $P_{peak}$, is the maximum pressure reached during inspiration. It occurs just at the end of the inspiratory phase, at time $t = T_{insp}$. At this instant, the flow is still at its constant value, $Q(T_{insp}) = F$, and the volume has reached the full tidal volume, $V(T_{insp}) = V_T$. Substituting these conditions into the equation of motion:\n$$P_{peak} = P_0 + R \\cdot F + E \\cdot V_T$$\nWe can see that the term $P_0 + E V_T$ is equal to $P_{plat}$ from our previous derivation. Substituting this into the equation for $P_{peak}$:\n$$P_{peak} = R \\cdot F + P_{plat}$$\nThis equation shows that the difference between peak and plateau pressure is due to the resistive pressure drop across the airways. We can now rearrange this to solve for resistance, $R$:\n$$R = \\frac{P_{peak} - P_{plat}}{F}$$\nThis expression is valid provided $F \\neq 0$, a condition of constant flow ventilation.\n\n**Step 3: Model Prediction and Residual Analysis**\n\nWith the derived parameters $R$ and $E$, we can formulate the model-predicted airway pressure, $P_{model}(t)$, for any time $t$ during the specified ventilatory cycle.\n\nFor the inspiratory phase ($t_i \\le T_{insp}$):\n- $Q(t_i) = F$\n- $V(t_i) = F \\cdot t_i$\n- $P_{model}(t_i) = P_0 + R F + E F t_i$\n\nFor the end-inspiratory hold phase ($t_i  T_{insp}$):\n- $Q(t_i) = 0$\n- $V(t_i) = V_T$\n- $P_{model}(t_i) = P_0 + E V_T = P_{plat}$\n\nThe residual at each time point $t_i$ is the difference between the measured pressure $P_{meas}(t_i)$ and the model-predicted pressure $P_{model}(t_i)$:\n$$r_i = P_{meas}(t_i) - P_{model}(t_i)$$\nFrom the set of $N$ residuals, we compute the following statistics:\n1.  **Root-Mean-Square Error (RMSE)**: A measure of the magnitude of the errors.\n    $$\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^N r_i^2}$$\n2.  **Mean Residual**: A measure of the average bias of the model.\n    $$\\text{mean\\_residual} = \\frac{1}{N}\\sum_{i=1}^N r_i$$\n3.  **Maximum Absolute Residual**: The largest deviation at any single point.\n    $$\\text{max\\_abs\\_residual} = \\max_{i} |r_i|$$\n\nThe computational procedure for each test case involves:\n1.  Calculate $T_{insp} = V_T / F$.\n2.  Calculate $E$ and $R$ using the derived formulas.\n3.  For each pair of $(t_i, P_{meas}(t_i))$:\n    a. Determine if $t_i \\le T_{insp}$ or $t_i  T_{insp}$.\n    b. Calculate $P_{model}(t_i)$ using the appropriate formula.\n    c. Compute and store the residual $r_i$.\n4.  Calculate the RMSE, mean residual, and maximum absolute residual from the stored residuals.\n5.  Collect and format the five output values: $R$, $E$, RMSE, mean residual, and maximum absolute residual, each rounded to three decimal places.\n\nThis procedure will be implemented for all provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pulmonary mechanics problem for a suite of test cases.\n    It calculates resistance (R), elastance (E), and a set of error metrics\n    by comparing a single-compartment lung model to measured data.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"F\": 0.5, \"VT\": 0.5, \"P0\": 5.0, \"Ppeak\": 20.0, \"Pplat\": 15.0,\n            \"t\": np.array([0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]),\n            \"Pmeas\": np.array([10.1, 11.9, 14.2, 16.0, 18.1, 20.0, 15.2, 14.8])\n        },\n        {\n            \"F\": 0.6, \"VT\": 0.48, \"P0\": 8.0, \"Ppeak\": 29.0, \"Pplat\": 14.0,\n            \"t\": np.array([0.0, 0.16, 0.32, 0.48, 0.64, 0.80, 0.96, 1.12]),\n            \"Pmeas\": np.array([23.0, 24.3, 25.5, 26.5, 27.9, 29.1, 14.2, 13.9])\n        },\n        {\n            \"F\": 0.5, \"VT\": 0.35, \"P0\": 12.0, \"Ppeak\": 35.5, \"Pplat\": 29.5,\n            \"t\": np.array([0.0, 0.14, 0.28, 0.42, 0.56, 0.70, 0.84, 0.98]),\n            \"Pmeas\": np.array([18.1, 21.6, 25.1, 28.6, 31.9, 35.6, 29.4, 29.6])\n        },\n        {\n            \"F\": 0.2, \"VT\": 0.3, \"P0\": 10.0, \"Ppeak\": 20.6, \"Pplat\": 19.0,\n            \"t\": np.array([0.0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1]),\n            \"Pmeas\": np.array([11.5, 13.5, 15.2, 17.1, 18.7, 20.7, 19.1, 18.8])\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        F = case[\"F\"]\n        VT = case[\"VT\"]\n        P0 = case[\"P0\"]\n        Ppeak = case[\"Ppeak\"]\n        Pplat = case[\"Pplat\"]\n        time_samples = case[\"t\"]\n        Pmeas_samples = case[\"Pmeas\"]\n        \n        # Calculate inspiratory time\n        Tinsp = VT / F\n        \n        # Step 1: Derive Elastance (E)\n        E = (Pplat - P0) / VT\n        \n        # Step 2: Derive Resistance (R)\n        R = (Ppeak - Pplat) / F\n        \n        # Step 3: Model Prediction and Residual Analysis\n        Pmodel_samples = np.zeros_like(time_samples)\n        \n        for i, t in enumerate(time_samples):\n            if t = Tinsp:\n                # Inspiration phase: P_aw(t) = P0 + R*Q(t) + E*V(t)\n                # with Q(t) = F and V(t) = F*t\n                Pmodel_samples[i] = P0 + R * F + E * F * t\n            else:\n                # End-inspiratory hold phase: P_aw(t) = P0 + E*VT\n                # with Q(t) = 0 and V(t) = VT\n                Pmodel_samples[i] = P0 + E * VT\n                \n        # Calculate residuals\n        residuals = Pmeas_samples - Pmodel_samples\n        \n        # Calculate statistics\n        rmse = np.sqrt(np.mean(np.square(residuals)))\n        mean_residual = np.mean(residuals)\n        max_abs_residual = np.max(np.abs(residuals))\n        \n        # Collect and round results\n        case_result = [\n            round(R, 3),\n            round(E, 3),\n            round(rmse, 3),\n            round(mean_residual, 3),\n            round(max_abs_residual, 3)\n        ]\n        all_results.append(case_result)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While the single-compartment model is a powerful starting point, the real lung is profoundly heterogeneous. This exercise moves beyond the assumption of a uniform lung by modeling it as two parallel compartments, each with its own resistance ($R_i$) and compliance ($C_i$). You will explore the crucial concept of the time constant, $\\tau_i = R_i C_i$, and discover how differences in this value lead to the time-dependent, uneven distribution of gas during inspiration, a hallmark of many respiratory diseases.",
            "id": "4200633",
            "problem": "A two-compartment lung model is constructed to represent parallel, independent regions of the lung attached to a common airway with negligible upstream resistance. Each compartment $i \\in \\{1,2\\}$ is modeled as a linear resistance–compliance element characterized by airway resistance $R_i$ and static compliance $C_i$. The airway pressure is raised from a baseline to a constant driving pressure $\\Delta P$ at time $t=0$ and held for a finite inspiratory duration $T_I$. Pleural pressure is constant and taken as the reference (zero), and the incremental compartment volumes at $t=0$ are zero. The following parameters are specified: $R_1 = 3 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$, $C_1 = 0.05 \\text{ L/cmH}_2\\text{O}$, $R_2 = 12 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$, $C_2 = 0.02 \\text{ L/cmH}_2\\text{O}$, $\\Delta P = 10 \\text{ cmH}_2\\text{O}$, and $T_I = 0.60 \\text{ s}$. Using first principles for linear resistive flow and elastic recoil, derive the compartmental filling dynamics and compute the fraction of the tidal volume entering compartment $1$ by the end of inspiration at $t = T_I$. Tidal volume here refers to the total change in lung volume during the inspiratory interval $\\left[0, T_I\\right]$. Express your final answer as a decimal between $0$ and $1$, rounded to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Resistance of compartment 1: $R_1 = 3 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$\n- Compliance of compartment 1: $C_1 = 0.05 \\text{ L/cmH}_2\\text{O}$\n- Resistance of compartment 2: $R_2 = 12 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$\n- Compliance of compartment 2: $C_2 = 0.02 \\text{ L/cmH}_2\\text{O}$\n- Constant driving pressure: $\\Delta P = 10 \\text{ cmH}_2\\text{O}$\n- Inspiratory duration: $T_I = 0.60 \\text{ s}$\n- Initial conditions: Incremental compartment volumes at $t=0$ are zero, i.e., $V_1(0)=0$ and $V_2(0)=0$.\n- Model: Two parallel, independent resistance-compliance compartments.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The model is a standard first-order linear representation of pulmonary mechanics based on the principles of fluid dynamics (Ohm's law analogy for flow) and elasticity (Hooke's law). The parameter values are physiologically plausible. The problem is valid.\n- **Well-Posed:** The problem is a well-defined initial value problem for a system of ordinary differential equations. All necessary parameters and initial conditions are provided to find a unique solution. The problem is valid.\n- **Objective:** The problem is stated with precise, quantitative language and free of subjective elements. The problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid and can be solved.\n\nThe dynamic behavior of each compartment is governed by the pressure balance equation. The driving pressure, $\\Delta P$, is equal to the sum of the resistive pressure drop and the elastic recoil pressure within the compartment. For a given compartment $i$, this relationship is expressed as a first-order linear ordinary differential equation:\n$$\n\\Delta P = R_i \\frac{dV_i(t)}{dt} + P_{el,i}(t)\n$$\nwhere $V_i(t)$ is the volume in compartment $i$ at time $t$, $\\frac{dV_i(t)}{dt}$ is the instantaneous flow rate into the compartment, and $P_{el,i}(t)$ is the elastic recoil pressure. The elastic pressure is related to volume and compliance $C_i$ (or elastance $E_i = 1/C_i$) by $P_{el,i}(t) = \\frac{1}{C_i} V_i(t)$.\n\nSubstituting this into the pressure balance equation gives:\n$$\n\\Delta P = R_i \\frac{dV_i(t)}{dt} + \\frac{1}{C_i} V_i(t)\n$$\nThis equation can be rearranged into the standard form for a first-order linear ODE:\n$$\n\\frac{dV_i}{dt} + \\frac{1}{R_i C_i} V_i = \\frac{\\Delta P}{R_i}\n$$\nWe define the time constant for each compartment as $\\tau_i = R_i C_i$. The equation becomes:\n$$\n\\frac{dV_i}{dt} + \\frac{1}{\\tau_i} V_i = \\frac{\\Delta P}{R_i}\n$$\nThe general solution to this non-homogeneous differential equation is the sum of the homogeneous solution ($V_{h,i}(t)$) and a particular solution ($V_{p,i}(t)$).\nThe homogeneous equation is $\\frac{dV_{h,i}}{dt} + \\frac{1}{\\tau_i} V_{h,i} = 0$, which has the solution $V_{h,i}(t) = A \\exp(-t/\\tau_i)$, where $A$ is a constant of integration.\nFor a constant driving pressure $\\Delta P$, the particular solution is a constant steady-state volume, $V_{p,i}(t) = V_{ss,i}$. Substituting this into the ODE gives $0 + \\frac{1}{\\tau_i}V_{ss,i} = \\frac{\\Delta P}{R_i}$, which yields $V_{ss,i} = \\frac{\\tau_i \\Delta P}{R_i} = \\frac{(R_i C_i) \\Delta P}{R_i} = C_i \\Delta P$. This is the maximum volume the compartment would hold if inspiration were infinitely long.\n\nThe general solution is therefore:\n$$\nV_i(t) = A \\exp\\left(-\\frac{t}{\\tau_i}\\right) + C_i \\Delta P\n$$\nWe apply the initial condition $V_i(0)=0$:\n$$\nV_i(0) = 0 = A \\exp(0) + C_i \\Delta P \\implies A = -C_i \\Delta P\n$$\nSubstituting the constant $A$ back into the general solution gives the specific solution for the filling dynamics of compartment $i$:\n$$\nV_i(t) = C_i \\Delta P \\left(1 - \\exp\\left(-\\frac{t}{R_i C_i}\\right)\\right)\n$$\nNow, we calculate the parameters and volumes for each compartment.\n\nFor compartment 1:\n- Time constant: $\\tau_1 = R_1 C_1 = (3 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}) \\times (0.05 \\text{ L/cmH}_2\\text{O}) = 0.15 \\text{ s}$.\n- Volume at the end of inspiration, $t = T_I = 0.60 \\text{ s}$:\n$$\nV_1(T_I) = C_1 \\Delta P \\left(1 - \\exp\\left(-\\frac{T_I}{\\tau_1}\\right)\\right) = (0.05)(10) \\left(1 - \\exp\\left(-\\frac{0.60}{0.15}\\right)\\right)\n$$\n$$\nV_1(T_I) = 0.5 \\left(1 - \\exp(-4)\\right) \\text{ L}\n$$\n\nFor compartment 2:\n- Time constant: $\\tau_2 = R_2 C_2 = (12 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}) \\times (0.02 \\text{ L/cmH}_2\\text{O}) = 0.24 \\text{ s}$.\n- Volume at the end of inspiration, $t = T_I = 0.60 \\text{ s}$:\n$$\nV_2(T_I) = C_2 \\Delta P \\left(1 - \\exp\\left(-\\frac{T_I}{\\tau_2}\\right)\\right) = (0.02)(10) \\left(1 - \\exp\\left(-\\frac{0.60}{0.24}\\right)\\right)\n$$\n$$\nV_2(T_I) = 0.2 \\left(1 - \\exp(-2.5)\\right) \\text{ L}\n$$\n\nThe tidal volume, $V_T$, is the total volume that has entered the lung by $t=T_I$. Since the initial volumes are zero, this is simply the sum of the volumes in the two compartments at $t=T_I$:\n$$\nV_T = V_1(T_I) + V_2(T_I) = 0.5 \\left(1 - \\exp(-4)\\right) + 0.2 \\left(1 - \\exp(-2.5)\\right)\n$$\nThe fraction of the tidal volume that enters compartment 1, denoted $f_1$, is the ratio of the volume in compartment 1 to the total tidal volume:\n$$\nf_1 = \\frac{V_1(T_I)}{V_T} = \\frac{V_1(T_I)}{V_1(T_I) + V_2(T_I)}\n$$\n$$\nf_1 = \\frac{0.5 \\left(1 - \\exp(-4)\\right)}{0.5 \\left(1 - \\exp(-4)\\right) + 0.2 \\left(1 - \\exp(-2.5)\\right)}\n$$\nNow, we compute the numerical values:\n$\\exp(-4) \\approx 0.0183156$\n$\\exp(-2.5) \\approx 0.0820850$\n\n$V_1(T_I) \\approx 0.5 \\times (1 - 0.0183156) = 0.5 \\times 0.9816844 = 0.4908422 \\text{ L}$\n$V_2(T_I) \\approx 0.2 \\times (1 - 0.0820850) = 0.2 \\times 0.9179150 = 0.1835830 \\text{ L}$\n\n$V_T = V_1(T_I) + V_2(T_I) \\approx 0.4908422 + 0.1835830 = 0.6744252 \\text{ L}$\n\n$f_1 = \\frac{0.4908422}{0.6744252} \\approx 0.727806$\n\nRounding the result to four significant figures as requested:\n$f_1 \\approx 0.7278$",
            "answer": "$$\n\\boxed{0.7278}\n$$"
        },
        {
            "introduction": "The asynchronous filling of lung regions with different time constants, as explored in the previous practice , has direct, observable consequences. This exercise focuses on a fascinating phenomenon known as pendelluft: the movement of gas between lung compartments after the airway opening is occluded. By calculating the pressure difference that develops between asynchronously filling compartments at the end of inspiration, you will quantify the instantaneous inter-compartmental flow that results, making the abstract concept of regional heterogeneity tangible and measurable.",
            "id": "4200594",
            "problem": "Consider a lung modeled as two parallel compartments, labeled A and B, that share a rigid, negligible-volume common proximal airway node. Each compartment is represented by a linear airway resistance and a linear alveolar compliance. Let the airway resistances be $R_A$ and $R_B$ (in $\\text{cmH}_2\\text{O}\\cdot\\text{s/L}$) and the compliances be $C_A$ and $C_B$ (in $\\text{L/cmH}_2\\text{O}$). The pleural pressure $P_{pl}$ is constant and equal to $0 \\text{ cmH}_2\\text{O}$. Prior to $t=0$, the system is at rest with $P_{alv,A}(0)=P_{alv,B}(0)=P_{pl}$. For $0 \\leq t  T$, an inspiratory square pressure $P_{ao}(t)=P_I$ (in $\\text{cmH}_2\\text{O}$) is applied at the airway opening. At $t=T$, the inspiratory valve closes, and the proximal airway node remains occluded for a brief interval while the expiratory valve is still closed; thus, there is zero net flow to the mouth during this occluded transition. The compartments remain connected only through the common node.\n\nAssume isothermal gas, negligible inertance, and that each compartment obeys a linear resistive relation between branch flow and pressure drop, and a linear compliance relation between alveolar volume and transmural pressure. Because compartments A and B have different resistance–compliance products, they fill asynchronously during $0 \\leq t  T$, creating a pressure difference across the common node at the instant of occlusion that drives intrapulmonary gas redistribution (pendelluft).\n\nGiven:\n- $R_A = 4 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$, $C_A = 0.08 \\text{ L/cmH}_2\\text{O}$,\n- $R_B = 1 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$, $C_B = 0.02 \\text{ L/cmH}_2\\text{O}$,\n- $P_I = 10 \\text{ cmH}_2\\text{O}$, $T = 0.1$ s.\n\nUsing only first principles and the stated linear relations, compute the magnitude of the instantaneous inter-compartmental gas flow at the onset of occlusion, that is, the absolute value of the branch flow through compartment A into the common node at $t=T^{+}$. Express the final result in $\\text{L/s}$ and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Model:** Two parallel compartments, A and B.\n- **Compartment A parameters:** Resistance $R_A = 4 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$, Compliance $C_A = 0.08 \\text{ L/cmH}_2\\text{O}$.\n- **Compartment B parameters:** Resistance $R_B = 1 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$, Compliance $C_B = 0.02 \\text{ L/cmH}_2\\text{O}$.\n- **Pressures and Times:**\n    - Pleural pressure $P_{pl} = 0 \\text{ cmH}_2\\text{O}$.\n    - Initial alveolar pressures $P_{alv,A}(0)=P_{alv,B}(0)=P_{pl}=0 \\text{ cmH}_2\\text{O}$.\n    - Inspiratory pressure at airway opening $P_{ao}(t) = P_I = 10 \\text{ cmH}_2\\text{O}$ for $0 \\leq t  T$.\n    - Inspiration duration $T = 0.1$ s.\n- **Occlusion Condition at $t=T$**: Total flow to the mouth is zero. Compartments A and B are connected through a common node.\n- **Assumptions:** Isothermal gas, negligible inertance, linear resistance, and linear compliance.\n- **Objective:** Compute the magnitude of the instantaneous branch flow through compartment A into the common node at $t=T^{+}$, which is $|-\\dot{V}_A(T^+)|$, where $\\dot{V}_A$ is defined as flow into compartment A.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a classic two-compartment model of the lung, a standard and fundamental construct in respiratory biomechanics. The governing physical principles are conservation of mass and the linear constitutive relations for resistance and compliance, which are appropriate for this level of modeling. All necessary parameters and initial conditions are provided. The values are physiologically plausible. The question is unambiguous and seeks a specific, calculable quantity. The phenomenon of pendelluft (inter-compartmental gas redistribution) is a direct and well-established consequence of regional-heterogeneity in time constants. The problem is scientifically grounded, well-posed, objective, and complete.\n\n### Verdict\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\nThe solution is developed in two phases: the inspiratory phase ($0 \\leq t  T$) to determine the state of the system at $t=T$, and the occluded phase ($t=T^{+}$) to determine the instantaneous inter-compartmental flow.\n\n**Phase 1: Inspiration ($0 \\leq t  T$)**\n\nFor each compartment $i \\in \\{A, B\\}$, the equation of motion is derived from the balance of pressures. The pressure drop across the airway resistance equals the resistive pressure, and the alveolar pressure is related to volume by compliance.\nLet $\\dot{V}_i(t)$ be the flow into compartment $i$, and $P_{alv,i}(t)$ be the alveolar pressure in compartment $i$. The driving pressure is $P_{ao}(t) - P_{alv,i}(t)$.\nThe resistive law is:\n$$P_{ao}(t) - P_{alv,i}(t) = R_i \\dot{V}_i(t)$$\nThe compliance law relates the change in volume $V_i(t)$ to the transmural pressure $P_{alv,i}(t) - P_{pl}$. Since $P_{pl}=0$, we have $V_i(t) = C_i P_{alv,i}(t)$. Differentiating with respect to time gives the flow:\n$$\\dot{V}_i(t) = \\frac{dV_i}{dt} = C_i \\frac{d P_{alv,i}(t)}{dt}$$\nSubstituting this into the resistive law, and noting that $P_{ao}(t) = P_I$ for $0 \\leq t  T$:\n$$P_I - P_{alv,i}(t) = R_i C_i \\frac{d P_{alv,i}(t)}{dt}$$\nThis is a first-order linear ordinary differential equation for $P_{alv,i}(t)$. Let the time constant for each compartment be $\\tau_i = R_i C_i$. The equation becomes:\n$$\\tau_i \\frac{d P_{alv,i}(t)}{dt} + P_{alv,i}(t) = P_I$$\nWith the initial condition $P_{alv,i}(0) = 0$, the solution is a standard step response:\n$$P_{alv,i}(t) = P_I (1 - \\exp(-t/\\tau_i))$$\nThis expression allows us to calculate the alveolar pressure in each compartment at the end of inspiration, $t=T$.\n\n**Phase 2: Occlusion ($t=T^{+}$)**\n\nAt $t=T^{+}$, the airway opening is occluded, so the total flow into the system is zero. The two compartments are connected only to each other via the common node. Let the pressure at this common node be $P_{node}$. The occlusion condition implies:\n$$\\dot{V}_A(T^{+}) + \\dot{V}_B(T^{+}) = 0$$\nThe flow into each compartment is now driven by the pressure difference between the common node and the alveolus. The state variables (alveolar pressures) cannot change instantaneously, so $P_{alv,i}(T^{+}) = P_{alv,i}(T)$.\nThe flow equations at $t=T^{+}$ are:\n1.  $P_{node}(T^{+}) - P_{alv,A}(T) = R_A \\dot{V}_A(T^{+})$\n2.  $P_{node}(T^{+}) - P_{alv,B}(T) = R_B \\dot{V}_B(T^{+})$\n\nUsing the occlusion condition $\\dot{V}_B(T^{+}) = -\\dot{V}_A(T^{+})$, we substitute this into the second equation:\n$$P_{node}(T^{+}) - P_{alv,B}(T) = -R_B \\dotV_A(T^{+})$$\nWe now have a system of two linear equations for the two unknowns, $P_{node}(T^{+})$ and $\\dot{V}_A(T^{+})$. We can solve for $\\dot{V}_A(T^{+})$ by eliminating $P_{node}(T^{+})$. From the first equation, $P_{node}(T^{+}) = P_{alv,A}(T) + R_A \\dot{V}_A(T^{+})$. Substituting this into the modified second equation:\n$$(P_{alv,A}(T) + R_A \\dot{V}_A(T^{+})) - P_{alv,B}(T) = -R_B \\dot{V}_A(T^{+})$$\nRearranging to solve for $\\dot{V}_A(T^{+})$:\n$$P_{alv,A}(T) - P_{alv,B}(T) = -R_A \\dot{V}_A(T^{+}) - R_B \\dot{V}_A(T^{+})$$\n$$P_{alv,A}(T) - P_{alv,B}(T) = -(R_A + R_B) \\dot{V}_A(T^{+})$$\n$$\\dot{V}_A(T^{+}) = \\frac{P_{alv,B}(T) - P_{alv,A}(T)}{R_A + R_B}$$\nThe flow from compartment A into the common node is $-\\dot{V}_A(T^{+})$. The problem asks for the magnitude of this flow, which is $|-\\dot{V}_A(T^{+})| = |\\dot{V}_A(T^{+})|$.\n$$|\\text{Flow}_{A \\to node}| = \\left| \\frac{P_{alv,B}(T) - P_{alv,A}(T)}{R_A + R_B} \\right| = \\frac{|P_{alv,B}(T) - P_{alv,A}(T)|}{R_A + R_B}$$\n\n### Numerical Calculation\n\n1.  **Calculate Time Constants:**\n    - $\\tau_A = R_A C_A = (4 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}) \\times (0.08 \\text{ L/cmH}_2\\text{O}) = 0.32$ s.\n    - $\\tau_B = R_B C_B = (1 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}) \\times (0.02 \\text{ L/cmH}_2\\text{O}) = 0.02$ s.\n\n2.  **Calculate Alveolar Pressures at $t=T=0.1$ s:**\n    - $P_{alv,A}(T) = P_I (1 - \\exp(-T/\\tau_A)) = 10 (1 - \\exp(-0.1/0.32)) = 10 (1 - \\exp(-0.3125))$\n      $P_{alv,A}(T) \\approx 10 (1 - 0.7316109) = 10(0.2683891) = 2.683891 \\text{ cmH}_2\\text{O}$.\n    - $P_{alv,B}(T) = P_I (1 - \\exp(-T/\\tau_B)) = 10 (1 - \\exp(-0.1/0.02)) = 10 (1 - \\exp(-5))$\n      $P_{alv,B}(T) \\approx 10 (1 - 0.0067379) = 10(0.9932621) = 9.932621 \\text{ cmH}_2\\text{O}$.\n\n3.  **Calculate the Magnitude of the Inter-compartmental Flow:**\n    - The pressure difference is $|P_{alv,B}(T) - P_{alv,A}(T)| \\approx |9.932621 - 2.683891| = 7.24873 \\text{ cmH}_2\\text{O}$.\n    - The total series resistance is $R_A + R_B = 4 + 1 = 5 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}$.\n    - The magnitude of the flow is:\n      $$|\\text{Flow}_{A \\to node}| = \\frac{7.24873 \\text{ cmH}_2\\text{O}}{5 \\text{ cmH}_2\\text{O}\\cdot\\text{s/L}} \\approx 1.449746 \\text{ L/s}$$\n\n4.  **Final Answer:**\n    Rounding the result to four significant figures gives $1.450$ L/s.",
            "answer": "$$\\boxed{1.450}$$"
        }
    ]
}