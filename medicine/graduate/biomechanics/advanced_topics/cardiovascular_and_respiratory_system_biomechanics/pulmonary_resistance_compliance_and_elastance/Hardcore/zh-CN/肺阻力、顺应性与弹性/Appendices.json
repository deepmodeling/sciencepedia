{
    "hands_on_practices": [
        {
            "introduction": "呼吸系统力学的分析始于一个核心概念：单室模型。这个简化的模型虽然抽象，但它为我们理解气道压力、流量和容积之间的关系提供了一个强大的数学框架。本练习将指导您应用这一基本模型，从机械通气过程中常见的压力波形（如峰值吸气压和平台压）中提取关键的生理参数——呼吸阻力 ($R$) 和弹性 ($E$) 。通过将模型预测与实测数据进行比较，您还将学习如何评估模型的拟合优度，这是连接理论模型与临床现实的重要一步。",
            "id": "4200637",
            "problem": "考虑单室肺模型，该模型关联了机械通气期间测量的气道压力、流量和容积。该模型由本构关系 $P_{aw}(t) = P_0 + R \\, Q(t) + E \\, V(t)$ 定义，其中 $P_{aw}(t)$ 是单位为 $\\mathrm{cmH_2O}$ 的气道压力，$P_0$ 是因呼气末正压（PEEP）产生的基线压力，单位为 $\\mathrm{cmH_2O}$，$R$ 是肺阻力，单位为 $\\mathrm{cmH_2O \\cdot s \\cdot L^{-1}}$，$Q(t)$ 是吸气流量，单位为 $\\mathrm{L/s}$，$E$ 是弹性，单位为 $\\mathrm{cmH_2O \\cdot L^{-1}}$，$V(t)$ 是高于呼气末水平的肺容积，单位为 $\\mathrm{L}$。顺应性 $C$ 是弹性的倒数，因此 $C = 1/E$，单位为 $\\mathrm{L \\cdot cmH_2O^{-1}}$。在容量控制通气模式下，吸气期间具有恒定吸气流量 $Q(t) = F$ 并伴有吸气末屏气，吸气容积满足 $V(t) = \\int_0^t Q(\\tau) \\, d\\tau = F \\, t$（对于 $t \\in [0, T_{insp}]$），其中吸气时间为 $T_{insp} = V_T / F$，$V_T$ 是潮气量。在吸气末屏气之前，当 $Q(t) = F$ 时，出现峰值气道压力 $P_{peak}$；而在平台期，流量为零，因此平台压 $P_{plat}$ 仅反映弹性部分。使用测量的 $P_{peak}$、$P_{plat}$、$V_T$、$F$ 和 $P_0$ 推导 $R$ 和 $E$ 的表达式，然后通过计算测量气道压力样本与模型在相应时间点预测的气道压力之间的残差来评估模型拟合度。在时间 $t_i$ 的残差为 $r_i = P_{meas}(t_i) - P_{model}(t_i)$，其中 $P_{model}(t)$ 由单室模型给出，使用推导出的 $R$ 和 $E$。对于 $t \\le T_{insp}$，$Q(t) = F$ 且 $V(t) = F t$；对于 $t  T_{insp}$，$Q(t) = 0$ 且 $V(t) = V_T$。对于每个测试用例，计算以下输出：$R$（单位 $\\mathrm{cmH_2O \\cdot s \\cdot L^{-1}}$）、$E$（单位 $\\mathrm{cmH_2O \\cdot L^{-1}}$）、均方根误差 $\\sqrt{\\frac{1}{N}\\sum_{i=1}^N r_i^2}$（单位 $\\mathrm{cmH_2O}$）、平均残差 $\\frac{1}{N}\\sum_{i=1}^N r_i$（单位 $\\mathrm{cmH_2O}$）和最大绝对残差 $\\max_i |r_i|$（单位 $\\mathrm{cmH_2O}$）。将所有数值输出表示为四舍五入到三位小数的浮点数。角度单位不适用。程序必须输出单行，其中包含一个逗号分隔的各用例结果列表，整个列表用方括号括起来，每个结果都是一个 $[R, E, \\mathrm{RMSE}, \\mathrm{mean\\_residual}, \\mathrm{max\\_abs\\_residual}]$ 顺序的列表。\n\n使用以下参数值和测量样本的测试套件。每个测试用例提供恒定吸气流量 $F$（单位 $\\mathrm{L/s}$）、潮气量 $V_T$（单位 $\\mathrm{L}$）、PEEP $P_0$（单位 $\\mathrm{cmH_2O}$）、峰值压力 $P_{peak}$（单位 $\\mathrm{cmH_2O}$）、平台压 $P_{plat}$（单位 $\\mathrm{cmH_2O}$）、时间向量 $t$（单位 $\\mathrm{s}$）和测量的气道压力样本 $P_{meas}$（单位 $\\mathrm{cmH_2O}$）。吸气时间为 $T_{insp} = V_T / F$。对于 $t_i \\le T_{insp}$，测量样本对应于恒定流量下的吸气；对于 $t_i  T_{insp}$，测量样本对应于平台期（吸气末屏气）。\n\n测试用例 1 (典型力学特性):\n- $F = 0.5$, $V_T = 0.5$, $P_0 = 5.0$, $P_{peak} = 20.0$, $P_{plat} = 15.0$\n- $t = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]$\n- $P_{meas} = [10.1, 11.9, 14.2, 16.0, 18.1, 20.0, 15.2, 14.8]$\n\n测试用例 2 (阻力升高):\n- $F = 0.6$, $V_T = 0.48$, $P_0 = 8.0$, $P_{peak} = 29.0$, $P_{plat} = 14.0$\n- $t = [0.0, 0.16, 0.32, 0.48, 0.64, 0.80, 0.96, 1.12]$\n- $P_{meas} = [23.0, 24.3, 25.5, 26.5, 27.9, 29.1, 14.2, 13.9]$\n\n测试用例 3 (顺应性低，弹性高):\n- $F = 0.5$, $V_T = 0.35$, $P_0 = 12.0$, $P_{peak} = 35.5$, $P_{plat} = 29.5$\n- $t = [0.0, 0.14, 0.28, 0.42, 0.56, 0.70, 0.84, 0.98]$\n- $P_{meas} = [18.1, 21.6, 25.1, 28.6, 31.9, 35.6, 29.4, 29.6]$\n\n测试用例 4 (低流量，小容积):\n- $F = 0.2$, $V_T = 0.3$, $P_0 = 10.0$, $P_{peak} = 20.6$, $P_{plat} = 19.0$\n- $t = [0.0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1]$\n- $P_{meas} = [11.5, 13.5, 15.2, 17.1, 18.7, 20.7, 19.1, 18.8]$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是每个测试用例的列表 $[R, E, \\mathrm{RMSE}, \\mathrm{mean\\_residual}, \\mathrm{max\\_abs\\_residual}]$。例如，格式应为 $[[r_1,e_1,\\mathrm{rmse}_1,\\mu_1,m_1],[r_2,e_2,\\mathrm{rmse}_2,\\mu_2,m_2],\\dots]$，所有值都四舍五入到三位小数，并使用上述指定单位。",
            "solution": "该问题是有效的，因为它在科学上基于呼吸力学原理，在数学上是适定的，并为分析提供了一套完整且一致的数据。我们将继续推导所需的参数并对模型拟合度进行统计分析。\n\n呼吸系统的单室模型通过称为运动方程的线性常微分方程将气道压力 $P_{aw}(t)$ 与流量 $Q(t)$ 和容积 $V(t)$ 关联起来：\n$$P_{aw}(t) = P_0 + R \\, Q(t) + E \\, V(t)$$\n其中 $P_0$ 是呼气末正压（PEEP），$R$ 是气道阻力，$E$ 是呼吸系统的弹性。\n\n该问题指定了容量控制通气模式，具有恒定的吸气流量 $F$。在持续时间为 $T_{insp}$ 的吸气阶段，流量为 $Q(t) = F$，容积随时间线性增加：$V(t) = \\int_0^t Q(\\tau) \\, d\\tau = F \\cdot t$。当输送的容积等于潮气量 $V_T$ 时，吸气结束。因此，$T_{insp} = V_T / F$。\n\n该问题要求从呼吸周期中特定的压力测量值推导阻力 $R$ 和弹性 $E$ 的表达式。\n\n**第1步：弹性 ($E$) 的推导**\n\n平台压 $P_{plat}$ 是在吸气末屏气期间测量的。在此操作中，进入肺部的流量为零，$Q(t) = 0$，肺容积保持在潮气量 $V(t) = V_T$ 不变。将这些条件代入运动方程：\n$$P_{plat} = P_0 + R \\cdot (0) + E \\cdot V_T$$\n$$P_{plat} = P_0 + E V_T$$\n该方程分离出了压力的弹性部分。我们可以重新整理它以求解弹性 $E$：\n$$E = \\frac{P_{plat} - P_0}{V_T}$$\n该表达式在 $V_T \\neq 0$ 的条件下有效，这是通气所固有的条件。\n\n**第2步：阻力 ($R$) 的推导**\n\n峰值吸气压力 $P_{peak}$ 是在吸气期间达到的最大压力。它恰好出现在吸气阶段的末尾，即时间 $t = T_{insp}$。在这一瞬间，流量仍为其恒定值 $Q(T_{insp}) = F$，容积已达到完整的潮气量 $V(T_{insp}) = V_T$。将这些条件代入运动方程：\n$$P_{peak} = P_0 + R \\cdot F + E \\cdot V_T$$\n我们可以看到，根据我们之前的推导，$P_0 + E V_T$ 这一项等于 $P_{plat}$。将此代入 $P_{peak}$ 的方程中：\n$$P_{peak} = R \\cdot F + P_{plat}$$\n该方程表明，峰值压力和平台压之间的差异是由气道上的阻力压降引起的。我们现在可以重新整理它以求解阻力 $R$：\n$$R = \\frac{P_{peak} - P_{plat}}{F}$$\n该表达式在 $F \\neq 0$ 的条件下有效，这是恒流速通气的条件。\n\n**第3步：模型预测与残差分析**\n\n利用推导出的参数 $R$ 和 $E$，我们可以为指定通气周期内的任何时间 $t$ 构建模型预测的气道压力 $P_{model}(t)$。\n\n对于吸气阶段 ($t_i \\le T_{insp}$):\n- $Q(t_i) = F$\n- $V(t_i) = F \\cdot t_i$\n- $P_{model}(t_i) = P_0 + R F + E F t_i$\n\n对于吸气末屏气阶段 ($t_i  T_{insp}$):\n- $Q(t_i) = 0$\n- $V(t_i) = V_T$\n- $P_{model}(t_i) = P_0 + E V_T = P_{plat}$\n\n在每个时间点 $t_i$ 的残差是测量压力 $P_{meas}(t_i)$ 与模型预测压力 $P_{model}(t_i)$ 之间的差值：\n$$r_i = P_{meas}(t_i) - P_{model}(t_i)$$\n从 $N$ 个残差的集合中，我们计算以下统计数据：\n1.  **均方根误差 (RMSE)**：衡量误差大小的指标。\n    $$\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^N r_i^2}$$\n2.  **平均残差**: 衡量模型平均偏差的指标。\n    $$\\text{mean\\_residual} = \\frac{1}{N}\\sum_{i=1}^N r_i$$\n3.  **最大绝对残差**: 任何单一点的最大偏差。\n    $$\\text{max\\_abs\\_residual} = \\max_{i} |r_i|$$\n\n每个测试用例的计算过程包括：\n1.  计算 $T_{insp} = V_T / F$。\n2.  使用推导出的公式计算 $E$ 和 $R$。\n3.  对于每对 $(t_i, P_{meas}(t_i))$：\n    a. 判断是 $t_i \\le T_{insp}$ 还是 $t_i  T_{insp}$。\n    b. 使用相应的公式计算 $P_{model}(t_i)$。\n    c. 计算并存储残差 $r_i$。\n4.  根据存储的残差计算 RMSE、平均残差和最大绝对残差。\n5.  收集并格式化五个输出值：$R$、$E$、RMSE、平均残差和最大绝对残差，每个值都四舍五入到三位小数。\n\n此过程将对所有提供的测试用例实施。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pulmonary mechanics problem for a suite of test cases.\n    It calculates resistance (R), elastance (E), and a set of error metrics\n    by comparing a single-compartment lung model to measured data.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"F\": 0.5, \"VT\": 0.5, \"P0\": 5.0, \"Ppeak\": 20.0, \"Pplat\": 15.0,\n            \"t\": np.array([0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4]),\n            \"Pmeas\": np.array([10.1, 11.9, 14.2, 16.0, 18.1, 20.0, 15.2, 14.8])\n        },\n        {\n            \"F\": 0.6, \"VT\": 0.48, \"P0\": 8.0, \"Ppeak\": 29.0, \"Pplat\": 14.0,\n            \"t\": np.array([0.0, 0.16, 0.32, 0.48, 0.64, 0.80, 0.96, 1.12]),\n            \"Pmeas\": np.array([23.0, 24.3, 25.5, 26.5, 27.9, 29.1, 14.2, 13.9])\n        },\n        {\n            \"F\": 0.5, \"VT\": 0.35, \"P0\": 12.0, \"Ppeak\": 35.5, \"Pplat\": 29.5,\n            \"t\": np.array([0.0, 0.14, 0.28, 0.42, 0.56, 0.70, 0.84, 0.98]),\n            \"Pmeas\": np.array([18.1, 21.6, 25.1, 28.6, 31.9, 35.6, 29.4, 29.6])\n        },\n        {\n            \"F\": 0.2, \"VT\": 0.3, \"P0\": 10.0, \"Ppeak\": 20.6, \"Pplat\": 19.0,\n            \"t\": np.array([0.0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1]),\n            \"Pmeas\": np.array([11.5, 13.5, 15.2, 17.1, 18.7, 20.7, 19.1, 18.8])\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        F = case[\"F\"]\n        VT = case[\"VT\"]\n        P0 = case[\"P0\"]\n        Ppeak = case[\"Ppeak\"]\n        Pplat = case[\"Pplat\"]\n        time_samples = case[\"t\"]\n        Pmeas_samples = case[\"Pmeas\"]\n        \n        # Calculate inspiratory time\n        Tinsp = VT / F\n        \n        # Step 1: Derive Elastance (E)\n        E = (Pplat - P0) / VT\n        \n        # Step 2: Derive Resistance (R)\n        R = (Ppeak - Pplat) / F\n        \n        # Step 3: Model Prediction and Residual Analysis\n        Pmodel_samples = np.zeros_like(time_samples)\n        \n        for i, t in enumerate(time_samples):\n            if t = Tinsp:\n                # Inspiration phase: P_aw(t) = P0 + R*Q(t) + E*V(t)\n                # with Q(t) = F and V(t) = F*t\n                Pmodel_samples[i] = P0 + R * F + E * F * t\n            else:\n                # End-inspiratory hold phase: P_aw(t) = P0 + E*VT\n                # with Q(t) = 0 and V(t) = VT\n                Pmodel_samples[i] = P0 + E * VT\n                \n        # Calculate residuals\n        residuals = Pmeas_samples - Pmodel_samples\n        \n        # Calculate statistics\n        rmse = np.sqrt(np.mean(np.square(residuals)))\n        mean_residual = np.mean(residuals)\n        max_abs_residual = np.max(np.abs(residuals))\n        \n        # Collect and round results\n        case_result = [\n            round(R, 3),\n            round(E, 3),\n            round(rmse, 3),\n            round(mean_residual, 3),\n            round(max_abs_residual, 3)\n        ]\n        all_results.append(case_result)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了如何确定呼吸系统的基本力学特性后，我们可以进一步探讨一个核心的生理学问题：呼吸的能量消耗是多少？本练习将引导您从第一性原理出发，计算每次吸气所需的机械功 。您需要将总功分解为克服肺部弹性回缩的弹性功和克服气道流动阻力的阻力功，并应用更符合生理现实的非线性阻力模型。这项实践将加深您对压力-容积关系如何转化为呼吸系统实际能量负荷的理解。",
            "id": "4200603",
            "problem": "一个呼吸系统的单室模型被用来解释在肺力学正常的机械通气成人中测得的环路。每次呼吸的吸气机械功将从第一性原理出发，作为弹性和阻力贡献的总和来获得。使用的基本依据是：在吸气路径上定义的机械功 $W = \\int P \\, dV$，顺应性的定义 $C = dV/dP$，弹性阻力 $E = 1/C$，以及由气道阻力产生的依赖于流量的阻力压 $P_{\\mathrm{res}}(\\dot{V})$。不考虑惯性效应。测量结果如下：\n\n- 在潮气范围内，压力-容积环有一个准线性段，静态呼吸系统顺应性为 $C_{\\mathrm{rs}} = 0.07 \\, \\mathrm{L}/\\mathrm{cmH_{2}O}$。\n- 吸气潮气量为 $\\Delta V = 0.60 \\, \\mathrm{L}$，以功能残气量 (FRC) 为参考。\n- 吸气流速波形（来自环路所基于的流量-时间轨迹）可以很好地用半正弦波描述：$\\dot{V}(t) = \\dot{V}_{\\max} \\sin\\!\\left(\\pi t/T_{\\mathrm{insp}}\\right)$，其中 $0 \\le t \\le T_{\\mathrm{insp}}$，$T_{\\mathrm{insp}} = 1.20 \\, \\mathrm{s}$，并且 $\\dot{V}_{\\max}$ 的选择使得 $\\int_{0}^{T_{\\mathrm{insp}}} \\dot{V}(t)\\, dt = \\Delta V$。\n- 吸气压力-流量环（在相同的潮气区间内）由一个层流-湍流复合阻力压拟合：$P_{\\mathrm{res}}(\\dot{V}) = R_{1}\\,\\dot{V} + R_{2}\\,|\\dot{V}|\\,\\dot{V}$，其中 $R_{1} = 3.0 \\, \\mathrm{cmH_{2}O}\\cdot\\mathrm{s}/\\mathrm{L}$ 且 $R_{2} = 0.90 \\, \\mathrm{cmH_{2}O}\\cdot\\mathrm{s}^{2}/\\mathrm{L}^{2}$。\n\n仅从上述基本定义出发，推导每次呼吸的吸气机械功 $W_{\\mathrm{insp}}$ 作为弹性和阻力分量之和的闭式表达式，并根据这些测量的环路特征对其进行数值计算。使用以下单位换算：$1 \\, \\mathrm{cmH_{2}O} = 98.0665 \\, \\mathrm{Pa}$ 和 $1 \\, \\mathrm{L} = 10^{-3} \\, \\mathrm{m}^{3}$。以 $\\mathrm{J}$ (焦耳) 为单位表示最终能量，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求针对呼吸系统的单室模型，推导并计算每次呼吸的吸气机械功 $W_{\\mathrm{insp}}$。功定义为在吸气周期内压力 $P$ 对容积 $V$ 的积分：\n$$W = \\int P \\, dV$$\n施加于呼吸系统的总压力 $P$ 是克服弹性回缩所需压力 $P_{\\mathrm{el}}$ 和克服流动阻力所需压力 $P_{\\mathrm{res}}$ 之和。惯性效应被忽略。\n$$P(t) = P_{\\mathrm{el}}(t) + P_{\\mathrm{res}}(t)$$\n因此，总吸气功是弹性功 $W_{\\mathrm{el}}$ 和阻力功 $W_{\\mathrm{res}}$ 之和：\n$$W_{\\mathrm{insp}} = \\int_{V_{\\mathrm{FRC}}}^{V_{\\mathrm{FRC}} + \\Delta V} P \\, dV = \\int P_{\\mathrm{el}} \\, dV + \\int P_{\\mathrm{res}} \\, dV = W_{\\mathrm{el}} + W_{\\mathrm{res}}$$\n我们将分别计算每个分量。\n\n首先，我们计算弹性功 $W_{\\mathrm{el}}$。呼吸系统的静态顺应性 $C_{\\mathrm{rs}}$ 定义为每单位静态弹性压力变化所引起的容积变化。对于一个线性系统，维持一个高于功能残气量 (FRC) 的容积 $v$ 所需的弹性压力 $P_{\\mathrm{el}}$ 由 $P_{\\mathrm{el}}(v) = v/C_{\\mathrm{rs}}$ 给出。弹性功是该压力在潮气量 $\\Delta V$ 上的积分：\n$$W_{\\mathrm{el}} = \\int_{v=0}^{\\Delta V} P_{\\mathrm{el}}(v) \\, dv = \\int_{0}^{\\Delta V} \\frac{v}{C_{\\mathrm{rs}}} \\, dv$$\n$$W_{\\mathrm{el}} = \\frac{1}{C_{\\mathrm{rs}}} \\left[ \\frac{v^2}{2} \\right]_{0}^{\\Delta V} = \\frac{(\\Delta V)^2}{2 C_{\\mathrm{rs}}}$$\n\n接下来，我们计算阻力功 $W_{\\mathrm{res}}$。阻力压是吸气流速 $\\dot{V}(t)$ 的函数：\n$$P_{\\mathrm{res}}(\\dot{V}) = R_{1}\\,\\dot{V} + R_{2}\\,|\\dot{V}|\\,\\dot{V}$$\n在吸气期间，流速为正，所以 $\\dot{V}  0$ 且 $|\\dot{V}| = \\dot{V}$。表达式简化为：\n$$P_{\\mathrm{res}}(\\dot{V}) = R_{1}\\,\\dot{V} + R_{2}\\,\\dot{V}^2$$\n阻力功为 $W_{\\mathrm{res}} = \\int P_{\\mathrm{res}} \\, dV$。为了计算这个积分，我们使用关系式 $dV = \\dot{V}(t) \\, dt$ 将积分变量从容积 $V$ 更改为时间 $t$。积分在吸气持续时间内进行，从 $t=0$ 到 $t=T_{\\mathrm{insp}}$。\n$$W_{\\mathrm{res}} = \\int_{t=0}^{T_{\\mathrm{insp}}} P_{\\mathrm{res}}(\\dot{V}(t)) \\, \\dot{V}(t) \\, dt = \\int_{0}^{T_{\\mathrm{insp}}} (R_{1}\\,\\dot{V}(t) + R_{2}\\,\\dot{V}(t)^2) \\, \\dot{V}(t) \\, dt$$\n$$W_{\\mathrm{res}} = \\int_{0}^{T_{\\mathrm{insp}}} \\left( R_{1}\\,\\dot{V}(t)^2 + R_{2}\\,\\dot{V}(t)^3 \\right) dt$$\n吸气流速波形由 $\\dot{V}(t) = \\dot{V}_{\\max} \\sin(\\pi t/T_{\\mathrm{insp}})$ 给出。峰值流速 $\\dot{V}_{\\max}$ 由输送的总容积为潮气量 $\\Delta V$ 这一条件确定：\n$$\\Delta V = \\int_{0}^{T_{\\mathrm{insp}}} \\dot{V}(t) \\, dt = \\int_{0}^{T_{\\mathrm{insp}}} \\dot{V}_{\\max} \\sin\\left(\\frac{\\pi t}{T_{\\mathrm{insp}}}\\right) dt$$\n$$\\Delta V = \\dot{V}_{\\max} \\left[ -\\frac{T_{\\mathrm{insp}}}{\\pi} \\cos\\left(\\frac{\\pi t}{T_{\\mathrm{insp}}}\\right) \\right]_{0}^{T_{\\mathrm{insp}}} = \\dot{V}_{\\max} \\left( -\\frac{T_{\\mathrm{insp}}}{\\pi} \\cos(\\pi) + \\frac{T_{\\mathrm{insp}}}{\\pi} \\cos(0) \\right)$$\n$$\\Delta V = \\dot{V}_{\\max} \\left( \\frac{T_{\\mathrm{insp}}}{\\pi} + \\frac{T_{\\mathrm{insp}}}{\\pi} \\right) = \\dot{V}_{\\max} \\frac{2 T_{\\mathrm{insp}}}{\\pi}$$\n求解 $\\dot{V}_{\\max}$：\n$$\\dot{V}_{\\max} = \\frac{\\pi \\, \\Delta V}{2 T_{\\mathrm{insp}}}$$\n现在我们将 $\\dot{V}(t)$ 的表达式代入 $W_{\\mathrm{res}}$ 的积分中。\n$$W_{\\mathrm{res}} = R_{1} \\dot{V}_{\\max}^2 \\int_{0}^{T_{\\mathrm{insp}}} \\sin^2\\left(\\frac{\\pi t}{T_{\\mathrm{insp}}}\\right) dt + R_{2} \\dot{V}_{\\max}^3 \\int_{0}^{T_{\\mathrm{insp}}} \\sin^3\\left(\\frac{\\pi t}{T_{\\mathrm{insp}}}\\right) dt$$\n我们计算这两个积分：\n$$\\int_{0}^{T_{\\mathrm{insp}}} \\sin^2\\left(\\frac{\\pi t}{T_{\\mathrm{insp}}}\\right) dt = \\int_{0}^{T_{\\mathrm{insp}}} \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi t}{T_{\\mathrm{insp}}}\\right)\\right) dt = \\frac{1}{2} \\left[ t - \\frac{T_{\\mathrm{insp}}}{2\\pi} \\sin\\left(\\frac{2\\pi t}{T_{\\mathrm{insp}}}\\right) \\right]_{0}^{T_{\\mathrm{insp}}} = \\frac{T_{\\mathrm{insp}}}{2}$$\n$$\\int_{0}^{T_{\\mathrm{insp}}} \\sin^3\\left(\\frac{\\pi t}{T_{\\mathrm{insp}}}\\right) dt = \\frac{T_{\\mathrm{insp}}}{\\pi} \\int_{0}^{\\pi} \\sin^3(\\theta) d\\theta = \\frac{T_{\\mathrm{insp}}}{\\pi} \\int_{0}^{\\pi} (1-\\cos^2\\theta)\\sin\\theta \\,d\\theta = \\frac{T_{\\mathrm{insp}}}{\\pi} \\left[ -\\cos\\theta + \\frac{\\cos^3\\theta}{3} \\right]_{0}^{\\pi} = \\frac{T_{\\mathrm{insp}}}{\\pi} \\left( (1-\\frac{1}{3}) - (-1+\\frac{1}{3}) \\right) = \\frac{4 T_{\\mathrm{insp}}}{3 \\pi}$$\n将这些结果代回 $W_{\\mathrm{res}}$ 的表达式中：\n$$W_{\\mathrm{res}} = R_{1} \\dot{V}_{\\max}^2 \\left(\\frac{T_{\\mathrm{insp}}}{2}\\right) + R_{2} \\dot{V}_{\\max}^3 \\left(\\frac{4 T_{\\mathrm{insp}}}{3 \\pi}\\right)$$\n现在，代入 $\\dot{V}_{\\max} = \\frac{\\pi \\, \\Delta V}{2 T_{\\mathrm{insp}}}$：\n$$W_{\\mathrm{res}} = R_{1} \\left(\\frac{\\pi \\Delta V}{2 T_{\\mathrm{insp}}}\\right)^2 \\frac{T_{\\mathrm{insp}}}{2} + R_{2} \\left(\\frac{\\pi \\Delta V}{2 T_{\\mathrm{insp}}}\\right)^3 \\frac{4 T_{\\mathrm{insp}}}{3 \\pi}$$\n$$W_{\\mathrm{res}} = R_{1} \\frac{\\pi^2 (\\Delta V)^2}{4 T_{\\mathrm{insp}}^2} \\frac{T_{\\mathrm{insp}}}{2} + R_{2} \\frac{\\pi^3 (\\Delta V)^3}{8 T_{\\mathrm{insp}}^3} \\frac{4 T_{\\mathrm{insp}}}{3 \\pi} = \\frac{\\pi^2 R_1 (\\Delta V)^2}{8 T_{\\mathrm{insp}}} + \\frac{\\pi^2 R_2 (\\Delta V)^3}{6 T_{\\mathrm{insp}}^2}$$\n总吸气功是弹性和阻力分量之和：\n$$W_{\\mathrm{insp}} = W_{\\mathrm{el}} + W_{\\mathrm{res}} = \\frac{(\\Delta V)^2}{2 C_{\\mathrm{rs}}} + \\frac{\\pi^2 R_1 (\\Delta V)^2}{8 T_{\\mathrm{insp}}} + \\frac{\\pi^2 R_2 (\\Delta V)^3}{6 T_{\\mathrm{insp}}^2}$$\n这就是所要求的闭式表达式。现在我们对其进行数值计算。为了使结果以焦耳（$1 \\, \\mathrm{J} = 1 \\, \\mathrm{Pa} \\cdot \\mathrm{m}^3$）为单位，必须将单位转换为国际单位制基本单位。通常更方便的是用 $\\mathrm{L} \\cdot \\mathrm{cmH_{2}O}$ 的混合单位计算功，并在最后进行转换。\n转换因子为 $1 \\, \\mathrm{L} \\cdot \\mathrm{cmH_{2}O} = (10^{-3} \\, \\mathrm{m}^3) \\times (98.0665 \\, \\mathrm{Pa}) = 0.0980665 \\, \\mathrm{J}$。\n\n给定值为：\n$\\Delta V = 0.60 \\, \\mathrm{L}$\n$C_{\\mathrm{rs}} = 0.07 \\, \\mathrm{L}/\\mathrm{cmH_{2}O}$\n$T_{\\mathrm{insp}} = 1.20 \\, \\mathrm{s}$\n$R_{1} = 3.0 \\, \\mathrm{cmH_{2}O}\\cdot\\mathrm{s}/\\mathrm{L}$\n$R_{2} = 0.90 \\, \\mathrm{cmH_{2}O}\\cdot\\mathrm{s}^{2}/\\mathrm{L}^{2}$\n\n以 $\\mathrm{L} \\cdot \\mathrm{cmH_{2}O}$ 为单位计算每个功分量：\n$W_{\\mathrm{el}} = \\frac{(0.60 \\, \\mathrm{L})^2}{2 \\times (0.07 \\, \\mathrm{L}/\\mathrm{cmH_{2}O})} = \\frac{0.36}{0.14} \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} = \\frac{18}{7} \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} \\approx 2.57143 \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O}$\n\n$W_{\\mathrm{res},1} = \\frac{\\pi^2 (3.0 \\, \\mathrm{cmH_{2}O}\\cdot\\mathrm{s}/\\mathrm{L}) (0.60 \\, \\mathrm{L})^2}{8 (1.20 \\, \\mathrm{s})} = \\frac{\\pi^2 \\times 3.0 \\times 0.36}{9.6} \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} = 0.1125 \\pi^2 \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} \\approx 1.11033 \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O}$\n\n$W_{\\mathrm{res},2} = \\frac{\\pi^2 (0.90 \\, \\mathrm{cmH_{2}O}\\cdot\\mathrm{s}^{2}/\\mathrm{L}^{2}) (0.60 \\, \\mathrm{L})^3}{6 (1.20 \\, \\mathrm{s})^2} = \\frac{\\pi^2 \\times 0.90 \\times 0.216}{6 \\times 1.44} \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} = \\frac{0.1944 \\pi^2}{8.64} \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} = 0.0225 \\pi^2 \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} \\approx 0.22207 \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O}$\n\n以混合单位表示的总功：\n$W_{\\mathrm{insp}} \\approx (2.57143 + 1.11033 + 0.22207) \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O} = 3.90383 \\, \\mathrm{L}\\cdot\\mathrm{cmH_{2}O}$\n\n最后，转换为焦耳：\n$W_{\\mathrm{insp}} = 3.90383 \\times 0.0980665 \\, \\mathrm{J} \\approx 0.382834 \\, \\mathrm{J}$\n\n四舍五入到四位有效数字，最终结果为 $0.3828 \\, \\mathrm{J}$。",
            "answer": "$$\\boxed{0.3828}$$"
        },
        {
            "introduction": "虽然单室模型是理解呼吸力学的基础，但它假设肺是均匀的，这在许多病理情况下并不成立。本练习引入了一个更高级的双室模型，以探究肺部区域性力学特性差异（即异质性）所带来的影响 。您将分析具有不同时间常数 ($\\tau = RC$) 的两个肺室如何在有限的吸气时间内不均匀地分配吸入的气体。这项实践对于理解通气分布的动态行为至关重要，并为解释为何肺部疾病中会出现通气/灌注不匹配提供了力学基础。",
            "id": "4200633",
            "problem": "构建一个双室肺模型来表示连接到一个共同气道（上游阻力可忽略不计）的两个平行、独立的肺区域。每个室 $i \\in \\{1,2\\}$ 被建模为一个线性阻力-顺应性元件，其特征在于气道阻力 $R_i$ 和静态顺应性 $C_i$。在时间 $t=0$ 时，气道压力从基线值升高到一个恒定的驱动压力 $\\Delta P$，并保持有限的吸气持续时间 $T_I$。胸膜压力是恒定的，并被视为参考（零）压力，且在 $t=0$ 时，各室的增量容积为零。给定以下参数：$R_1 = 3$ $\\text{cmH}_2\\text{O}\\cdot \\text{s}/\\text{L}$，$C_1 = 0.05$ $\\text{L}/\\text{cmH}_2\\text{O}$，$R_2 = 12$ $\\text{cmH}_2\\text{O}\\cdot \\text{s}/\\text{L}$，$C_2 = 0.02$ $\\text{L}/\\text{cmH}_2\\text{O}$，$\\Delta P = 10$ $\\text{cmH}_2\\text{O}$，以及 $T_I = 0.60$ $\\text{s}$。使用线性阻力流和弹性回缩的第一性原理，推导肺室的充盈动力学，并计算在吸气结束时（$t = T_I$）进入第1室的潮气量分数。此处的潮气量指的是在吸气区间 $\\left[0, T_I\\right]$ 内肺部总容积的变化量。将你的最终答案表示为0到1之间的小数，并四舍五入至四位有效数字。",
            "solution": "首先验证该问题，以确保其具有科学依据、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n- 第1室的阻力：$R_1 = 3$ $\\text{cmH}_2\\text{O}\\cdot \\text{s}/\\text{L}$\n- 第1室的顺应性：$C_1 = 0.05$ $\\text{L}/\\text{cmH}_2\\text{O}$\n- 第2室的阻力：$R_2 = 12$ $\\text{cmH}_2\\text{O}\\cdot \\text{s}/\\text{L}$\n- 第2室的顺应性：$C_2 = 0.02$ $\\text{L}/\\text{cmH}_2\\text{O}$\n- 恒定驱动压力：$\\Delta P = 10$ $\\text{cmH}_2\\text{O}$\n- 吸气持续时间：$T_I = 0.60 \\text{ s}$\n- 初始条件：在 $t=0$ 时，各室增量容积为零，即 $V_1(0)=0$ 且 $V_2(0)=0$。\n- 模型：两个平行、独立的阻力-顺应性肺室。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该模型是基于流体动力学（流动的欧姆定律类比）和弹性力学（胡克定律）原理的肺力学标准一阶线性表示。参数值在生理上是合理的。该问题有效。\n- **提法恰当：** 该问题是一个定义明确的常微分方程组的初值问题。所有必要的参数和初始条件都已提供，可以找到唯一解。该问题有效。\n- **客观性：** 该问题以精确、定量的语言陈述，不含主观因素。该问题有效。\n\n### 步骤 3：结论与行动\n该问题有效，可以求解。\n\n每个肺室的动态行为由压力平衡方程决定。驱动压力 $\\Delta P$ 等于室内阻力压降和弹性回缩压力之和。对于给定的肺室 $i$，这种关系表示为一个一阶线性常微分方程：\n$$\n\\Delta P = R_i \\frac{dV_i(t)}{dt} + P_{el,i}(t)\n$$\n其中 $V_i(t)$ 是在时间 $t$ 时肺室 $i$ 的容积，$\\frac{dV_i(t)}{dt}$ 是流入该室的瞬时流速，而 $P_{el,i}(t)$ 是弹性回缩压力。弹性压力通过 $P_{el,i}(t) = \\frac{1}{C_i} V_i(t)$ 与容积和顺应性 $C_i$（或弹性 $E_i = 1/C_i$）相关。\n\n将此代入压力平衡方程，得到：\n$$\n\\Delta P = R_i \\frac{dV_i(t)}{dt} + \\frac{1}{C_i} V_i(t)\n$$\n这个方程可以重排为一阶线性常微分方程的标准形式：\n$$\n\\frac{dV_i}{dt} + \\frac{1}{R_i C_i} V_i = \\frac{\\Delta P}{R_i}\n$$\n我们将每个肺室的时间常数定义为 $\\tau_i = R_i C_i$。方程变为：\n$$\n\\frac{dV_i}{dt} + \\frac{1}{\\tau_i} V_i = \\frac{\\Delta P}{R_i}\n$$\n这个非齐次微分方程的通解是齐次解（$V_{h,i}(t)$）和特解（$V_{p,i}(t)$）的和。\n齐次方程为 $\\frac{dV_{h,i}}{dt} + \\frac{1}{\\tau_i} V_{h,i} = 0$，其解为 $V_{h,i}(t) = A \\exp(-t/\\tau_i)$，其中 $A$ 是一个积分常数。\n对于一个恒定的驱动压力 $\\Delta P$，特解是一个恒定的稳态容积，$V_{p,i}(t) = V_{ss,i}$。将此代入常微分方程得到 $0 + \\frac{1}{\\tau_i}V_{ss,i} = \\frac{\\Delta P}{R_i}$，从而得出 $V_{ss,i} = \\frac{\\tau_i \\Delta P}{R_i} = \\frac{(R_i C_i) \\Delta P}{R_i} = C_i \\Delta P$。这是如果吸气时间无限长，肺室所能容纳的最大容积。\n\n因此，通解为：\n$$\nV_i(t) = A \\exp\\left(-\\frac{t}{\\tau_i}\\right) + C_i \\Delta P\n$$\n我们应用初始条件 $V_i(0)=0$：\n$$\nV_i(0) = 0 = A \\exp(0) + C_i \\Delta P \\implies A = -C_i \\Delta P\n$$\n将常数 $A$ 代回通解，得到肺室 $i$ 充盈动力学的特解：\n$$\nV_i(t) = C_i \\Delta P \\left(1 - \\exp\\left(-\\frac{t}{R_i C_i}\\right)\\right)\n$$\n现在，我们计算每个肺室的参数和容积。\n\n对于第1室：\n- 时间常数：$\\tau_1 = R_1 C_1 = (3 \\text{ cmH}_2\\text{O}\\cdot \\text{s}/\\text{L}) \\times (0.05 \\text{ L}/\\text{cmH}_2\\text{O}) = 0.15 \\text{ s}$。\n- 吸气结束时的容积，$t = T_I = 0.60 \\text{ s}$：\n$$\nV_1(T_I) = C_1 \\Delta P \\left(1 - \\exp\\left(-\\frac{T_I}{\\tau_1}\\right)\\right) = (0.05)(10) \\left(1 - \\exp\\left(-\\frac{0.60}{0.15}\\right)\\right)\n$$\n$$\nV_1(T_I) = 0.5 \\left(1 - \\exp(-4)\\right) \\text{ L}\n$$\n\n对于第2室：\n- 时间常数：$\\tau_2 = R_2 C_2 = (12 \\text{ cmH}_2\\text{O}\\cdot \\text{s}/\\text{L}) \\times (0.02 \\text{ L}/\\text{cmH}_2\\text{O}) = 0.24 \\text{ s}$。\n- 吸气结束时的容积，$t = T_I = 0.60 \\text{ s}$：\n$$\nV_2(T_I) = C_2 \\Delta P \\left(1 - \\exp\\left(-\\frac{T_I}{\\tau_2}\\right)\\right) = (0.02)(10) \\left(1 - \\exp\\left(-\\frac{0.60}{0.24}\\right)\\right)\n$$\n$$\nV_2(T_I) = 0.2 \\left(1 - \\exp(-2.5)\\right) \\text{ L}\n$$\n\n潮气量 $V_T$ 是在 $t=T_I$ 时进入肺部的总容积。由于初始容积为零，这简单地是两个肺室在 $t=T_I$ 时的容积之和：\n$$\nV_T = V_1(T_I) + V_2(T_I) = 0.5 \\left(1 - \\exp(-4)\\right) + 0.2 \\left(1 - \\exp(-2.5)\\right)\n$$\n进入第1室的潮气量分数，记为 $f_1$，是第1室的容积与总潮气量的比值：\n$$\nf_1 = \\frac{V_1(T_I)}{V_T} = \\frac{V_1(T_I)}{V_1(T_I) + V_2(T_I)}\n$$\n$$\nf_1 = \\frac{0.5 \\left(1 - \\exp(-4)\\right)}{0.5 \\left(1 - \\exp(-4)\\right) + 0.2 \\left(1 - \\exp(-2.5)\\right)}\n$$\n现在，我们计算数值：\n$\\exp(-4) \\approx 0.0183156$\n$\\exp(-2.5) \\approx 0.0820850$\n\n$V_1(T_I) \\approx 0.5 \\times (1 - 0.0183156) = 0.5 \\times 0.9816844 = 0.4908422 \\text{ L}$\n$V_2(T_I) \\approx 0.2 \\times (1 - 0.0820850) = 0.2 \\times 0.9179150 = 0.1835830 \\text{ L}$\n\n$V_T = V_1(T_I) + V_2(T_I) \\approx 0.4908422 + 0.1835830 = 0.6744252 \\text{ L}$\n\n$f_1 = \\frac{0.4908422}{0.6744252} \\approx 0.727806$\n\n按照要求将结果四舍五入至四位有效数字：\n$f_1 \\approx 0.7278$",
            "answer": "$$\n\\boxed{0.7278}\n$$"
        }
    ]
}