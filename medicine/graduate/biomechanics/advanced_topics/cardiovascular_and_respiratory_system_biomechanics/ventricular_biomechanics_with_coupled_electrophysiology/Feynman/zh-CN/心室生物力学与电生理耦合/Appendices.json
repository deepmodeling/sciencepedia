{
    "hands_on_practices": [
        {
            "introduction": "心室建模的基石是能够根据组织的变形和激活状态预测其应力。本练习旨在实践如何应用超弹性本构定律与主动应力模型，这是描述心脏力学行为的基本组成部分。通过这个练习，你将学会如何结合被动材料特性和主动收缩力来确定整体应力状态，这是所有心肌力学分析的基础 。",
            "id": "4209991",
            "problem": "考虑一个简化的心室心肌机电模型，该模型被视为一种具有单一主导纤维族的不可压缩、横向各向同性的超弹性材料。单位参考体积的应变能密度函数假定为\n$$\n\\Psi(I_{1},I_{4f}) \\;=\\; \\frac{a}{2b}\\left(\\exp\\!\\big(b\\,(I_{1}-3)\\big)-1\\right) \\;+\\; \\frac{a_{f}}{2b_{f}}\\left(\\exp\\!\\big(b_{f}\\,(I_{4f}-1)^{2}\\big)-1\\right),\n$$\n其中 $I_{1}=\\operatorname{tr}(\\mathbf{C})$ 是右 Cauchy–Green 张量 $\\mathbf{C}$ 的第一不变量，$I_{4f}=\\mathbf{f}_{0}\\cdot\\mathbf{C}\\,\\mathbf{f}_{0}$ 是与参考纤维方向 $\\mathbf{f}_{0}$ 相关的纤维不变量。假设在参考构型中，纤维与 $x_{1}$ 方向对齐，即 $\\mathbf{f}_{0}=\\mathbf{e}_{1}$。\n\n电生理激活通过在当前纤维方向 $\\mathbf{f}$ 上附加一个形式如下的主动 Cauchy 应力来引入：\n$$\n\\boldsymbol{\\sigma}^{\\text{act}} \\;=\\; T_{a}(V)\\,\\mathbf{f}\\otimes\\mathbf{f},\\quad T_{a}(V) \\;=\\; T_{\\max}\\,A(V),\\quad A(V)\\;=\\;\\frac{1}{1+\\exp\\!\\left(-\\frac{V - V_{0}}{k_{V}}\\right)},\n$$\n其中 $V$ 是跨膜电位，$T_{\\max}$ 是峰值主动应力，$V_{0}$ 是激活中点，$k_{V}$ 是斜率参数。当前纤维方向 $\\mathbf{f}$ 是 $\\mathbf{f}_{0}$ 的前推，并且在所考虑的载荷下与 $x_{1}$ 轴对齐。\n\n样本在纤维方向上受到不可压缩的单轴拉伸，纤维拉伸比为 $\\lambda_{f}=\\lambda>1$，侧向表面无牵引力，且无体力作用。在此状态下，不可压缩性意味着侧向拉伸比满足 $\\lambda_{2}=\\lambda_{3}=\\lambda^{-1/2}$，且不变量简化为 $I_{1}=\\lambda^{2}+2\\lambda^{-1}$ 和 $I_{4f}=\\lambda^{2}$。\n\n使用不可压缩超弹性材料的标准连续介质力学和上述激活模型，计算由被动基质、被动纤维和主动纤维贡献之和产生的纤维方向 Cauchy 应力分量 $\\sigma_{11}$。取以下参数值：\n$$\na=0.5\\ \\text{kPa},\\quad b=8,\\quad a_{f}=5.0\\ \\text{kPa},\\quad b_{f}=15,\\quad \\lambda=1.1,\n$$\n激活参数为：\n$$\nT_{\\max}=60\\ \\text{kPa},\\quad V=0\\ \\text{mV},\\quad V_{0}=-30\\ \\text{mV},\\quad k_{V}=10\\ \\text{mV}.\n$$\n假设侧向 Cauchy 应力为零，并据此确定 Lagrange 乘子。以千帕 (kPa) 为单位表示 $\\sigma_{11}$ 的最终答案。将结果四舍五入至四位有效数字。简要解释模型的指数项如何在给定的拉伸和激活条件下体现纤维响应中的力学非线性。",
            "solution": "该问题要求在一个简化的心室心肌机电模型中，计算纤维方向的 Cauchy 应力分量 $\\sigma_{11}$。总 Cauchy 应力 $\\boldsymbol{\\sigma}$ 是由应变能函数导出的被动应力 $\\boldsymbol{\\sigma}^{\\text{pas}}$ 和给定的主动应力 $\\boldsymbol{\\sigma}^{\\text{act}}$ 之和。\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{pas}} + \\boldsymbol{\\sigma}^{\\text{act}}\n$$\n该材料被建模为不可压缩和超弹性的。对于不可压缩材料，其被动 Cauchy 应力由下式给出：\n$$\n\\boldsymbol{\\sigma}^{\\text{pas}} = -p\\mathbf{I} + 2\\mathbf{F} \\frac{\\partial \\Psi}{\\partial \\mathbf{C}} \\mathbf{F}^T\n$$\n其中 $p$ 是静水压力（一个强制实施不可压缩约束 $\\det(\\mathbf{F})=1$ 的 Lagrange 乘子），$\\mathbf{I}$ 是二阶单位张量，$\\mathbf{F}$ 是变形梯度，$\\mathbf{C}=\\mathbf{F}^T\\mathbf{F}$ 是右 Cauchy-Green 张量。应变能函数 $\\Psi$ 给出为：\n$$\n\\Psi(I_{1},I_{4f}) = \\Psi_{\\text{iso}}(I_1) + \\Psi_{\\text{aniso}}(I_{4f})\n$$\n其中各向同性（基质）部分为 $\\Psi_{\\text{iso}}(I_1) = \\frac{a}{2b}(\\exp(b(I_{1}-3))-1)$，各向异性（纤维）部分为 $\\Psi_{\\text{aniso}}(I_{4f}) = \\frac{a_{f}}{2b_{f}}(\\exp(b_{f}(I_{4f}-1)^{2})-1)$。\n\n首先，我们使用链式法则计算 $\\Psi$ 对 $\\mathbf{C}$ 的导数：\n$$\n\\frac{\\partial \\Psi}{\\partial \\mathbf{C}} = \\frac{\\partial \\Psi}{\\partial I_1} \\frac{\\partial I_1}{\\partial \\mathbf{C}} + \\frac{\\partial \\Psi}{\\partial I_{4f}} \\frac{\\partial I_{4f}}{\\partial \\mathbf{C}}\n$$\n不变量的导数为 $\\frac{\\partial I_1}{\\partial \\mathbf{C}} = \\mathbf{I}$ 和 $\\frac{\\partial I_{4f}}{\\partial \\mathbf{C}} = \\mathbf{f}_0 \\otimes \\mathbf{f}_0$。应变能函数对不变量的导数为：\n$$\n\\frac{\\partial \\Psi}{\\partial I_1} = \\frac{\\partial \\Psi_{\\text{iso}}}{\\partial I_1} = \\frac{a}{2b} \\cdot b \\exp(b(I_1-3)) = \\frac{a}{2} \\exp(b(I_1-3))\n$$\n$$\n\\frac{\\partial \\Psi}{\\partial I_{4f}} = \\frac{\\partial \\Psi_{\\text{aniso}}}{\\partial I_{4f}} = \\frac{a_f}{2b_f} \\cdot b_f \\cdot 2(I_{4f}-1) \\exp(b_f(I_{4f}-1)^2) = a_f (I_{4f}-1) \\exp(b_f(I_{4f}-1)^2)\n$$\n将这些代入应力方程，并使用关系式 $\\mathbf{F}\\mathbf{I}\\mathbf{F}^T = \\mathbf{B}$（左 Cauchy-Green 张量）和 $\\mathbf{F}(\\mathbf{f}_0 \\otimes \\mathbf{f}_0)\\mathbf{F}^T = (\\mathbf{F}\\mathbf{f}_0) \\otimes (\\mathbf{F}\\mathbf{f}_0)$，我们得到：\n$$\n\\boldsymbol{\\sigma}^{\\text{pas}} = -p\\mathbf{I} + 2 \\frac{\\partial \\Psi}{\\partial I_1} \\mathbf{B} + 2 \\frac{\\partial \\Psi}{\\partial I_{4f}} (\\mathbf{F}\\mathbf{f}_0 \\otimes \\mathbf{F}\\mathbf{f}_0)\n$$\n矢量 $\\mathbf{F}\\mathbf{f}_0$ 是变形后构型中的纤维矢量。其长度的平方是 $I_{4f}$。当前纤维方向的单位矢量是 $\\mathbf{f} = (\\mathbf{F}\\mathbf{f}_0)/\\sqrt{I_{4f}}$。因此，$(\\mathbf{F}\\mathbf{f}_0 \\otimes \\mathbf{F}\\mathbf{f}_0) = I_{4f} (\\mathbf{f} \\otimes \\mathbf{f})$。\n$$\n\\boldsymbol{\\sigma}^{\\text{pas}} = -p\\mathbf{I} + 2 \\frac{\\partial \\Psi}{\\partial I_1} \\mathbf{B} + 2 I_{4f} \\frac{\\partial \\Psi}{\\partial I_{4f}} (\\mathbf{f} \\otimes \\mathbf{f})\n$$\n问题指定了沿纤维方向 $\\mathbf{f}_0 = \\mathbf{e}_1$ 的不可压缩单轴拉伸。变形梯度张量 $\\mathbf{F}$ 和左 Cauchy-Green 张量 $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^T$ 是对角阵：\n$$\n\\mathbf{F} = \\text{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2}) \\quad \\implies \\quad \\mathbf{B} = \\text{diag}(\\lambda^2, \\lambda^{-1}, \\lambda^{-1})\n$$\n当前纤维方向为 $\\mathbf{f}=\\mathbf{e}_1$，所以 $\\mathbf{f}\\otimes\\mathbf{f} = \\text{diag}(1, 0, 0)$。不变量为 $I_1 = \\lambda^2 + 2\\lambda^{-1}$ 和 $I_{4f} = \\lambda^2$。\n\n被动 Cauchy 应力的分量为：\n$$\n\\sigma^{\\text{pas}}_{11} = -p + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_1} + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_{4f}}\n$$\n$$\n\\sigma^{\\text{pas}}_{22} = \\sigma^{\\text{pas}}_{33} = -p + 2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1}\n$$\n总应力包含来自主动应力 $\\boldsymbol{\\sigma}^{\\text{act}} = T_a (\\mathbf{f} \\otimes \\mathbf{f}) = T_a \\text{diag}(1,0,0)$ 的贡献。\n$$\n\\sigma_{11} = \\sigma^{\\text{pas}}_{11} + T_a \\quad \\text{和} \\quad \\sigma_{22} = \\sigma^{\\text{pas}}_{22}, \\quad \\sigma_{33} = \\sigma^{\\text{pas}}_{33}\n$$\n问题陈述了侧向应力为零，即 $\\sigma_{22} = \\sigma_{33} = 0$。利用此条件，我们确定 Lagrange 乘子 $p$：\n$$\n0 = -p + 2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1} \\quad \\implies \\quad p = 2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1}\n$$\n注意，$\\frac{\\partial\\Psi}{\\partial I_{4f}}$ 没有出现在这里，因为纤维仅在 $x_1$ 方向上排列。将 $p$ 代入 $\\sigma_{11}$ 的表达式中：\n$$\n\\sigma_{11} = \\left(-2\\lambda^{-1} \\frac{\\partial \\Psi}{\\partial I_1}\\right) + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_1} + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_{4f}} + T_a\n$$\n$$\n\\sigma_{11} = 2(\\lambda^2 - \\lambda^{-1}) \\frac{\\partial \\Psi}{\\partial I_1} + 2\\lambda^2 \\frac{\\partial \\Psi}{\\partial I_{4f}} + T_a\n$$\n该表达式将总的纤维方向应力分为三个分量：被动基质、被动纤维和主动纤维的贡献。\n$$\n\\sigma_{11} = \\underbrace{a(\\lambda^2 - \\lambda^{-1}) \\exp(b(I_1 - 3))}_{\\sigma^{\\text{pas, matrix}}_{11}} + \\underbrace{2\\lambda^2 a_f (I_{4f}-1) \\exp(b_f(I_{4f}-1)^2)}_{\\sigma^{\\text{pas, fiber}}_{11}} + \\underbrace{T_{\\max} A(V)}_{\\sigma^{\\text{act}}_{11}}\n$$\n现在，我们代入给定的参数值：\n$a=0.5\\ \\text{kPa}, b=8, a_{f}=5.0\\ \\text{kPa}, b_{f}=15, \\lambda=1.1$.\n$T_{\\max}=60\\ \\text{kPa}, V=0\\ \\text{mV}, V_{0}=-30\\ \\text{mV}, k_{V}=10\\ \\text{mV}$.\n\n首先，计算不变量：\n$I_1 = \\lambda^2 + 2\\lambda^{-1} = (1.1)^2 + 2(1.1)^{-1} = 1.21 + \\frac{2}{1.1} \\approx 1.21 + 1.81818 = 3.02818$\n$I_{4f} = \\lambda^2 = (1.1)^2 = 1.21$\n\n接下来，计算三个应力分量：\n1.  被动基质贡献：\n    $$\n    \\sigma^{\\text{pas, matrix}}_{11} = 0.5 \\left( (1.1)^2 - \\frac{1}{1.1} \\right) \\exp\\left(8 \\left( (1.1)^2 + \\frac{2}{1.1} - 3 \\right)\\right)\n    $$\n    $$\n    \\sigma^{\\text{pas, matrix}}_{11} \\approx 0.5 (1.21 - 0.90909) \\exp(8(3.02818 - 3)) = 0.5(0.30091) \\exp(8(0.02818))\n    $$\n    $$\n    \\sigma^{\\text{pas, matrix}}_{11} \\approx 0.150455 \\exp(0.22544) \\approx 0.150455(1.25287) \\approx 0.18851\\ \\text{kPa}\n    $$\n2.  被动纤维贡献：\n    $$\n    \\sigma^{\\text{pas, fiber}}_{11} = 2(1.1)^2 (5.0) ((1.1)^2-1) \\exp\\left(15((1.1)^2-1)^2\\right)\n    $$\n    $$\n    \\sigma^{\\text{pas, fiber}}_{11} = 2(1.21)(5.0)(1.21-1) \\exp(15(1.21-1)^2) = 12.1(0.21) \\exp(15(0.21)^2)\n    $$\n    $$\n    \\sigma^{\\text{pas, fiber}}_{11} = 2.541 \\exp(15(0.0441)) = 2.541 \\exp(0.6615) \\approx 2.541(1.93774) \\approx 4.92370\\ \\text{kPa}\n    $$\n3.  主动纤维贡献：\n    激活水平 $A(V)$ 为：\n    $$\n    A(V) = \\frac{1}{1+\\exp\\left(-\\frac{V - V_{0}}{k_{V}}\\right)} = \\frac{1}{1+\\exp\\left(-\\frac{0 - (-30)}{10}\\right)} = \\frac{1}{1+\\exp(-3)}\n    $$\n    $$\n    A(V) \\approx \\frac{1}{1+0.049787} \\approx 0.952574\n    $$\n    主动应力为：\n    $$\n    \\sigma^{\\text{act}}_{11} = T_a = T_{\\max} A(V) \\approx 60 \\times 0.952574 \\approx 57.15444\\ \\text{kPa}\n    $$\n最后，将三个分量相加得到总应力 $\\sigma_{11}$：\n$$\n\\sigma_{11} = \\sigma^{\\text{pas, matrix}}_{11} + \\sigma^{\\text{pas, fiber}}_{11} + \\sigma^{\\text{act}}_{11}\n$$\n$$\n\\sigma_{11} \\approx 0.18851 + 4.92370 + 57.15444 \\approx 62.26665\\ \\text{kPa}\n$$\n四舍五入到四位有效数字，结果为 $62.27\\ \\text{kPa}$。\n\n非线性解释：\n本构模型中的指数项是捕捉组织非线性力学行为的基础。\n基质响应中的项 $\\exp(b(I_{1}-3))$ 以及更显著的纤维响应中的项 $\\exp(b_{f}(I_{4f}-1)^{2})$ 引起了“硬化”效应。在小应变时（即当 $I_1 \\approx 3$ 和 $I_{4f} \\approx 1$ 时），指数项接近于1，其自变量接近于0，应力随应变缓慢增加。随着拉伸比 $\\lambda$ 的增加，不变量 $I_1$ 特别是 $I_{4f}$ 增大，导致纤维项的指数自变量呈二次方增长。这导致了被动应力的快速、非线性增长。这种行为模拟了胶原纤维的解卷曲和随后的拉伸过程，这些纤维在松弛时提供极小的阻力，但一旦拉紧就会变得非常刚硬。\n激活函数 $A(V)$ 中的项 $\\exp(-\\frac{V - V_{0}}{k_{V}})$ 在跨膜电位 $V$ 和主动应力之间建立了一种 S 形关系。这代表了一种高度非线性的、开关式的激活机制。当 $V \\ll V_0$ 时，主动应力可以忽略不计；在 $V=V_0$ 附近急剧转变；当 $V \\gg V_0$ 时，饱和于最大值 $T_{\\max}$。这捕捉了驱动肌肉收缩的细胞钙释放和肌丝激活的全或无特性。",
            "answer": "$$\\boxed{62.27}$$"
        },
        {
            "introduction": "心肌的力学收缩是由电信号波的传播触发的。为了模拟这一过程，我们需要对控制跨膜电位 $V$ 演化的偏微分方程进行求解。本练习聚焦于电生理学建模的核心部分：使用单畴方程和有限元方法（FEM）来模拟电信号的传播 。它具体阐述了如何将心肌组织的关键特征——各向异性电导率——整合到数值模型中，从而在连续的偏微分方程与其在模拟中使用的离散形式之间架起一座桥梁。",
            "id": "4210032",
            "problem": "我们使用跨膜电位 $V$ 的单域偏微分方程 (PDE) 对一个二维心室切片进行建模。该方程以空间（当前）构型写出，并且为了专注于扩散算子，忽略了电容项和反应项。电荷守恒与各向异性传导的广义欧姆定律相结合，得出扩散项 $-\\nabla \\cdot (\\mathbf{D} \\nabla V)$，其中电导率张量 $\\mathbf{D}$ 与局部心肌纤维方向 $\\mathbf{f}$（假设为单位向量）对齐。心肌是机电耦合的，但在所关注的瞬间，形变可以忽略不计，因此纤维方向在整个单元上保持不变且为常数。假设各向异性电导率张量具有标准的横向各向同性形式\n$$\n\\mathbf{D} = g_{t} \\mathbf{I} + \\bigl(g_{l} - g_{t}\\bigr) \\, \\mathbf{f} \\mathbf{f}^{\\mathsf{T}},\n$$\n其中 $g_{l}$ 和 $g_{t}$ 分别是纵向和横向电导率，$\\mathbf{I}$ 是单位张量。\n\n在单个三节点三角形单元 $\\Omega_{e}$ 上，使用带有线性形函数的 Galerkin 有限元法 (FEM)，从第一性原理推导与扩散算子相关的对称单元刚度矩阵 $\\mathbf{K}_{e}$。然后，对于节点坐标为 $\\bigl(x_{1},y_{1}\\bigr) = (0,0)$、$\\bigl(x_{2},y_{2}\\bigr) = (1,0)$ 和 $\\bigl(x_{3},y_{3}\\bigr) = (0,1)$（所有坐标单位为 $\\text{mm}$）的特定单元，取电导率参数 $g_{l} = 0.6\\,\\text{S}/\\text{m}$ 和 $g_{t} = 0.06\\,\\text{S}/\\text{m}$，以及一个恒定的平面内纤维方向 $\\mathbf{f} = \\bigl(\\cos \\theta, \\sin \\theta\\bigr)$，其中 $\\theta = 30$ 度。假设 $\\mathbf{D}$ 在 $\\Omega_{e}$ 上是常数。\n\n计算该单元的单元刚度矩阵 $\\mathbf{K}_{e}$ 的第 $(1,1)$ 个元素，记为 $K_{11}$。将最终数值答案以 $\\text{S}/\\text{mm}$ 为单位表示，并四舍五入到六位有效数字。陈述从控制扩散算子获得 $\\mathbf{K}_{e}$ 的所有步骤，包括从 $\\mathbf{f}$ 构建 $\\mathbf{D}$ 以及在 $\\Omega_{e}$ 上形函数的梯度。角度必须按给定的度数处理。",
            "solution": "所述问题具有科学依据，是适定的且客观的。它提出了一个使用有限元法 (FEM) 进行心脏电生理学计算建模的标准问题。所有必要的数据和条件都已提供，不存在内部矛盾或违反物理原理的情况。因此，该问题是有效的，可以构建一个解。\n\n推导单元刚度矩阵的起点是控制扩散方程的弱形式。在单元域 $\\Omega_e$ 上的稳态扩散问题的强形式由算子 $-\\nabla \\cdot (\\mathbf{D} \\nabla V) = 0$ 给出。为了推导弱形式，我们乘以一个任意检验函数 $w$ 并在 $\\Omega_e$ 上积分：\n$$\n-\\int_{\\Omega_e} w \\, \\nabla \\cdot (\\mathbf{D} \\nabla V) \\, d\\Omega = 0\n$$\n应用散度定理（或格林第一恒等式）可以将空间导数从主变量 $V$ 移到检验函数 $w$ 上：\n$$\n\\int_{\\Omega_e} (\\nabla w)^{\\mathsf{T}} \\mathbf{D} (\\nabla V) \\, d\\Omega - \\int_{\\partial\\Omega_e} w (\\mathbf{D} \\nabla V) \\cdot \\mathbf{n} \\, d\\Gamma = 0\n$$\n这里，$\\partial\\Omega_e$ 是单元的边界，$\\mathbf{n}$ 是外向单位法向量。刚度矩阵来自域积分。在 Galerkin 有限元法框架内，单元内的电位场 $V$ 被近似为节点值 $V_j$ 和基函数（称为形函数 $N_j(x,y)$）的线性组合：\n$$\nV(x,y) \\approx V_h(x,y) = \\sum_{j=1}^{3} N_j(x,y) V_j\n$$\n检验函数 $w$ 从与基函数相同的函数集中选取，即对于 $i=1, 2, 3$，$w = N_i$。将 $V$ 的近似代入并将 $w = N_i$ 设入弱形式的域积分部分，得到一个线性代数方程组：\n$$\n\\sum_{j=1}^{3} \\left( \\int_{\\Omega_e} (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j) \\, d\\Omega \\right) V_j = \\text{边界项}\n$$\n单元刚度矩阵 $\\mathbf{K}_e$ 由其分量 $K_{ij}$ 定义：\n$$\nK_{ij} = \\int_{\\Omega_e} (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j) \\, d\\Omega\n$$\n对于线性三角形单元，形函数 $N_j$ 是空间坐标的线性函数，这意味着它们的梯度 $\\nabla N_j$ 在单元上是常数。问题陈述中说明电导率张量 $\\mathbf{D}$ 在单元上也是常数。因此，被积函数是常数，可以移到积分外：\n$$\nK_{ij} = (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j) \\int_{\\Omega_e} d\\Omega = A_e (\\nabla N_i)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_j)\n$$\n其中 $A_e$ 是单元的面积。这可以写成矩阵形式 $\\mathbf{K}_e = A_e \\mathbf{B}^{\\mathsf{T}} \\mathbf{D} \\mathbf{B}$，其中矩阵 $\\mathbf{B}$ 以形函数的梯度为其列向量：$\\mathbf{B} = \\begin{pmatrix} \\nabla N_1  \\nabla N_2  \\nabla N_3 \\end{pmatrix}$。\n\n我们现在计算给定单元的具体量。\n首先，我们处理单位问题。节点坐标的单位是 $\\text{mm}$，而电导率的单位是 $\\text{S}/\\text{m}$。为了保持一致性，我们将电导率转换为 $\\text{S}/\\text{mm}$：\n$$\ng_l = 0.6 \\, \\frac{\\text{S}}{\\text{m}} = 0.6 \\, \\frac{\\text{S}}{1000 \\, \\text{mm}} = 0.0006 \\, \\frac{\\text{S}}{\\text{mm}}\n$$\n$$\ng_t = 0.06 \\, \\frac{\\text{S}}{\\text{m}} = 0.06 \\, \\frac{\\text{S}}{1000 \\, \\text{mm}} = 0.00006 \\, \\frac{\\text{S}}{\\text{mm}}\n$$\n单元节点为 $(x_1, y_1) = (0, 0)$、$(x_2, y_2) = (1, 0)$ 和 $(x_3, y_3) = (0, 1)$。这是一个底为 $1 \\, \\text{mm}$、高为 $1 \\, \\text{mm}$ 的直角三角形。面积 $A_e$ 是：\n$$\nA_e = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} (1 \\, \\text{mm})(1 \\, \\text{mm}) = 0.5 \\, \\text{mm}^2\n$$\n对于线性三角形单元，形函数 $N_i$ 的梯度由 $\\nabla N_i = \\frac{1}{2A_e} \\begin{pmatrix} y_{j}-y_{k} \\\\ x_{k}-x_{j} \\end{pmatrix}$ 给出，其中 $(i,j,k)$ 是 $(1,2,3)$ 的循环置换。我们需要 $\\nabla N_1$：\n$$\n\\nabla N_1 = \\frac{1}{2 A_e} \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix} = \\frac{1}{2(0.5)} \\begin{pmatrix} 0 - 1 \\\\ 0 - 1 \\end{pmatrix} = \\frac{1}{1} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} \\, \\text{mm}^{-1}\n$$\n接下来，我们构建电导率张量 $\\mathbf{D}$。当 $\\theta = 30^\\circ$ 时，纤维方向向量 $\\mathbf{f}$ 为：\n$$\n\\mathbf{f} = \\begin{pmatrix} \\cos(30^\\circ) \\\\ \\sin(30^\\circ) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}\n$$\n并矢积 $\\mathbf{f} \\mathbf{f}^{\\mathsf{T}}$ 为：\n$$\n\\mathbf{f} \\mathbf{f}^{\\mathsf{T}} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} \\\\ \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{4}  \\frac{\\sqrt{3}}{4} \\\\ \\frac{\\sqrt{3}}{4}  \\frac{1}{4} \\end{pmatrix}\n$$\n电导率张量为 $\\mathbf{D} = g_{t} \\mathbf{I} + \\bigl(g_{l} - g_{t}\\bigr) \\, \\mathbf{f} \\mathbf{f}^{\\mathsf{T}}$。电导率之差为 $g_{l} - g_{t} = 0.0006 - 0.00006 = 0.00054 \\, \\text{S}/\\text{mm}$。\n$$\n\\mathbf{D} = 0.00006 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + 0.00054 \\begin{pmatrix} \\frac{3}{4}  \\frac{\\sqrt{3}}{4} \\\\ \\frac{\\sqrt{3}}{4}  \\frac{1}{4} \\end{pmatrix}\n$$\n$$\n\\mathbf{D} = \\begin{pmatrix} 0.00006  0 \\\\ 0  0.00006 \\end{pmatrix} + \\begin{pmatrix} 0.000405  0.000135\\sqrt{3} \\\\ 0.000135\\sqrt{3}  0.000135 \\end{pmatrix}\n$$\n$$\n\\mathbf{D} = \\begin{pmatrix} 0.000465  0.000135\\sqrt{3} \\\\ 0.000135\\sqrt{3}  0.000195 \\end{pmatrix} \\, \\frac{\\text{S}}{\\text{mm}}\n$$\n我们现在可以计算刚度矩阵的 $(1,1)$ 元素，$K_{11}$：\n$$\nK_{11} = A_e (\\nabla N_1)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_1)\n$$\n$$\nK_{11} = 0.5 \\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} 0.000465  0.000135\\sqrt{3} \\\\ 0.000135\\sqrt{3}  0.000195 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}\n$$\n二次型 $(\\nabla N_1)^{\\mathsf{T}} \\mathbf{D} (\\nabla N_1)$ 展开为 $D_{11} + D_{22} + 2D_{12}$：\n$$\nK_{11} = 0.5 \\left( 0.000465 + 0.000195 + 2(0.000135\\sqrt{3}) \\right)\n$$\n$$\nK_{11} = 0.5 \\left( 0.00066 + 0.00027\\sqrt{3} \\right)\n$$\n$$\nK_{11} = 0.00033 + 0.000135\\sqrt{3}\n$$\n我们计算其数值：\n$$\nK_{11} \\approx 0.00033 + 0.000135 \\times 1.7320508075...\n$$\n$$\nK_{11} \\approx 0.00033 + 0.000233826859...\n$$\n$$\nK_{11} \\approx 0.000563826859... \\, \\frac{\\text{S}}{\\text{mm}}\n$$\n将此结果四舍五入到六位有效数字，得到 $0.000563827$。",
            "answer": "$$\n\\boxed{0.000563827}\n$$"
        },
        {
            "introduction": "真实的计算机模型必须能捕捉电生理与力学之间随时间变化的相互作用，从而揭示复杂的生理机制。这个编程练习将前述概念融会贯通，要求你实现一个虽简化但完整的电力学耦合系统 。通过这个练习，你将能亲手探索生理上的异质性（例如离子通道表达的跨壁梯度）如何转化为收缩时序和应变的功​​能性差异，从而体会计算建模在研究复杂生理学问题中的强大威力。",
            "id": "4210008",
            "problem": "考虑一个心室组织的最小双层穿壁模型，该模型由一个心外膜层和一个心内膜层组成，每一层都由一个心肌细胞尺度单元与一个一维线性弹性元件耦合表示。电生理学和力学通过唯象方式耦合，以评估瞬时外向钾电流（表示为 $I_{\\text{to}}$）的穿壁梯度如何调节激活-收缩时序和区域应变。您的任务是实现一个程序，对于一组指定的参数值，计算两层之间主动张力峰值时间的差异，以及两层之间收缩中期应变的差异，这些差异是 $I_{\\text{to}}$ 的心外膜到心内膜梯度的函数。\n\n基本基础和建模假设：\n- 电荷守恒规定，膜电压动力学反映了内向和外向电流以及任何外部刺激之间的平衡。我们使用一个唯象的、在 $[0,1]$ 区间内的归一化膜电压 $v(t)$，通过一个刺激脉冲来触发去极化，并设有一个复极化时间常数，该常数单调依赖于瞬时外向电导 $g_{\\text{to}}$，以反映 $I_{\\text{to}}$ 在缩短心外膜动作电位中的经验作用。\n- 兴奋-收缩耦合由一个一阶钙激活变量 $c(t)$ 表示，该变量由 $v(t)$ 驱动，其敏感性因子随 $g_{\\text{to}}$ 的增加而减小，以捕捉 $I_{\\text{to}}$ 增强时钙内流的减少。\n- 力学由一个与主动收缩元件并联的一维线性弹性元件表示。通过对被动元件的线性应力-应变关系加上主动张力，总应力在预设的外部载荷下达到平衡，从而产生纤维应变 $\\varepsilon(t)$。\n\n电生理学：\n- 设 $v(t)$ 为无量纲归一化膜电压，静息时 $v(t)=0$，兴奋态时 $v(t)\\approx 1$。一个矩形刺激 $S(t)$ 驱动去极化：\n  - 当 $t\\in [1\\,\\mathrm{ms}, 3\\,\\mathrm{ms}]$ 时，$S(t)=1$，否则 $S(t)=0$。\n- $v(t)$ 的动力学为\n$$\n\\frac{dv}{dt} =\nS(t)\\,\\frac{1 - v}{\\tau_{\\text{dep}}}\n+\n\\bigl(1 - S(t)\\bigr)\\times\n\\begin{cases}\n-\\dfrac{v}{\\tau_{\\text{rep}}(g_{\\text{to}})},  \\text{若 } v > v_{\\text{th}},\\\\\n-\\dfrac{v}{\\tau_{\\text{rest}}},  \\text{若 } v \\le v_{\\text{th}},\n\\end{cases}\n$$\n其中 $v_{\\text{th}} = 0.2$，$\\tau_{\\text{dep}} = 1\\,\\mathrm{ms}$，$\\tau_{\\text{rest}} = 20\\,\\mathrm{ms}$，以及一个随 $g_{\\text{to}}$ 增加而缩短的复极化时间常数：\n$$\n\\tau_{\\text{rep}}(g_{\\text{to}}) = \\frac{\\tau_{\\text{rep},0}}{1 + a\\,g_{\\text{to}}},\\quad \\tau_{\\text{rep},0} = 120\\,\\mathrm{ms},\\ a=5.\n$$\n\n兴奋-收缩耦合：\n- 细胞内钙激活变量 $c(t)$ 遵循\n$$\n\\frac{dc}{dt} = k_{\\text{on},0}\\,s(g_{\\text{to}})\\,v(t) - \\frac{c}{\\tau_{\\text{Ca}}},\n$$\n其中 $k_{\\text{on},0} = 0.06\\,\\mathrm{ms}^{-1}$，$\\tau_{\\text{Ca}} = 60\\,\\mathrm{ms}$，以及一个随 $g_{\\text{to}}$ 增加而减小的敏感性 $s(g_{\\text{to}})$：\n$$\ns(g_{\\text{to}}) = \\frac{1}{1 + b\\,g_{\\text{to}}},\\quad b=2.\n$$\n- 主动张力（单位为 $\\mathrm{kPa}$）为 $T_{\\text{act}}(t) = T_{\\max}\\,c(t)$，其中 $T_{\\max} = 20\\,\\mathrm{kPa}$。\n\n力学：\n- 纤维总应力与施加的外部应力 $\\sigma_{\\text{ext}}(t)$ 平衡，通过与主动张力并联的线性弹性关系产生被动弹性应变 $\\varepsilon(t)$：\n$$\n\\sigma_{\\text{ext}}(t) = E_{\\text{pass}}\\,\\varepsilon(t) + T_{\\text{act}}(t),\n$$\n其中 $E_{\\text{pass}} = 80\\,\\mathrm{kPa}$，且外部应力为常数 $\\sigma_{\\text{ext}}(t) \\equiv \\sigma_{\\text{ext}} = 12\\,\\mathrm{kPa}$。因此，\n$$\n\\varepsilon(t) = \\frac{\\sigma_{\\text{ext}} - T_{\\text{act}}(t)}{E_{\\text{pass}}}.\n$$\n\n计算任务：\n- 对于每一层 $\\ell \\in \\{\\text{epi}, \\text{endo}\\}$，在初始条件 $v_{\\ell}(0)=0$ 和 $c_{\\ell}(0)=0$ 下，将 $v_{\\ell}(t)$ 和 $c_{\\ell}(t)$ 的耦合常微分方程从 $t=0\\,\\mathrm{ms}$ 积分到 $t=300\\,\\mathrm{ms}$。\n- 使用上述关系计算 $T_{\\text{act},\\ell}(t)$ 和 $\\varepsilon_{\\ell}(t)$。\n- 定义 $t_{\\text{peak},\\ell}$ 为 $T_{\\text{act},\\ell}(t)$ 在模拟窗口内达到其最大值的时间。定义 $\\Delta t_{\\text{peak}} = t_{\\text{peak},\\text{endo}} - t_{\\text{peak},\\text{epi}}$，单位为 $\\mathrm{ms}$。\n- 定义一个收缩中期评估时间 $t_{\\text{eval}} = 120\\,\\mathrm{ms}$。计算 $\\Delta \\varepsilon = \\varepsilon_{\\text{endo}}(t_{\\text{eval}}) - \\varepsilon_{\\text{epi}}(t_{\\text{eval}})$（无量纲）。\n\n数值说明：\n- 在 $[0\\,\\mathrm{ms}, 300\\,\\mathrm{ms}]$ 上使用步长为 $\\Delta t = 0.1\\,\\mathrm{ms}$ 的均匀评估网格，并使用一个标准的常微分方程求解器，绝对容差为 $10^{-9}$，相对容差为 $10^{-6}$。\n- 将 $\\Delta t_{\\text{peak}}$ 以 $\\mathrm{ms}$ 表示，$\\Delta \\varepsilon$ 为无量纲数。在最终输出中将两者都四舍五入到 $3$ 位小数。\n\n测试套件：\n- 对于每个测试用例，参数为心外膜和心内膜的瞬时外向电导 $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}})$，单位为上述公式中使用的一致的任意电导单位。\n  1. 用例 A（中等生理梯度）：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.3, 0.1)$。\n  2. 用例 B（无梯度）：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.1, 0.1)$。\n  3. 用例 C（反向梯度）：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.05, 0.3)$。\n  4. 用例 D（均匀高 $I_{\\text{to}}$）：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.5, 0.5)$。\n  5. 用例 E（极端生理梯度）：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.6, 0.05)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个结果列表，每个测试用例一个结果，其中每个结果是一个双元素列表 $[\\Delta t_{\\text{peak}}, \\Delta \\varepsilon]$，两个值都四舍五入到 $3$ 位小数。整体输出必须是单行，格式完全如下\n$$\n\\bigl[[\\Delta t_{\\text{peak}}^{(A)}, \\Delta \\varepsilon^{(A)}],[\\Delta t_{\\text{peak}}^{(B)}, \\Delta \\varepsilon^{(B)}],\\dots,[\\Delta t_{\\text{peak}}^{(E)}, \\Delta \\varepsilon^{(E)}]\\bigr].\n$$\n不应打印任何额外的文本。",
            "solution": "该问题已根据指定标准进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **模型**：一个心室组织的双层穿壁模型（心外膜层和心内膜层），每一层表示为一个单元。\n- **电生理学**：\n    - 状态变量：归一化膜电压 $v(t)$，$v \\in [0, 1]$。\n    - 刺激：当 $t \\in [1\\,\\mathrm{ms}, 3\\,\\mathrm{ms}]$ 时，$S(t)=1$；否则 $S(t)=0$。\n    - $v(t)$ 的控制常微分方程：\n      $$\n      \\frac{dv}{dt} = S(t)\\,\\frac{1 - v}{\\tau_{\\text{dep}}} + \\bigl(1 - S(t)\\bigr)\\times\n      \\begin{cases}\n      -\\dfrac{v}{\\tau_{\\text{rep}}(g_{\\text{to}})},  \\text{若 } v > v_{\\text{th}},\\\\\n      -\\dfrac{v}{\\tau_{\\text{rest}}},  \\text{若 } v \\le v_{\\text{th}},\n      \\end{cases}\n      $$\n    - 参数：$v_{\\text{th}} = 0.2$，$\\tau_{\\text{dep}} = 1\\,\\mathrm{ms}$，$\\tau_{\\text{rest}} = 20\\,\\mathrm{ms}$。\n    - 复极化时间常数：$\\tau_{\\text{rep}}(g_{\\text{to}}) = \\frac{\\tau_{\\text{rep},0}}{1 + a\\,g_{\\text{to}}}$，其中 $\\tau_{\\text{rep},0} = 120\\,\\mathrm{ms}$，$a=5$。\n- **兴奋-收缩耦合**：\n    - 状态变量：钙激活 $c(t)$。\n    - $c(t)$ 的控制常微分方程：$\\frac{dc}{dt} = k_{\\text{on},0}\\,s(g_{\\text{to}})\\,v(t) - \\frac{c}{\\tau_{\\text{Ca}}}$。\n    - 参数：$k_{\\text{on},0} = 0.06\\,\\mathrm{ms}^{-1}$，$\\tau_{\\text{Ca}} = 60\\,\\mathrm{ms}$。\n    - 敏感性：$s(g_{\\text{to}}) = \\frac{1}{1 + b\\,g_{\\text{to}}}$，其中 $b=2$。\n    - 主动张力：$T_{\\text{act}}(t) = T_{\\max}\\,c(t)$，其中 $T_{\\max} = 20\\,\\mathrm{kPa}$。\n- **力学**：\n    - 应力平衡：$\\sigma_{\\text{ext}}(t) = E_{\\text{pass}}\\,\\varepsilon(t) + T_{\\text{act}}(t)$。\n    - 参数：$E_{\\text{pass}} = 80\\,\\mathrm{kPa}$，$\\sigma_{\\text{ext}}(t) \\equiv \\sigma_{\\text{ext}} = 12\\,\\mathrm{kPa}$。\n    - 应变计算：$\\varepsilon(t) = \\frac{\\sigma_{\\text{ext}} - T_{\\text{act}}(t)}{E_{\\text{pass}}}$。\n- **计算任务**：\n    - 对每一层 $\\ell \\in \\{\\text{epi}, \\text{endo}\\}$，将 $v_{\\ell}(t)$ 和 $c_{\\ell}(t)$ 的常微分方程从 $t=0\\,\\mathrm{ms}$ 积分到 $t=300\\,\\mathrm{ms}$。\n    - 初始条件：$v_{\\ell}(0)=0$，$c_{\\ell}(0)=0$。\n    - 张力峰值时间：$t_{\\text{peak},\\ell}$ 是 $T_{\\text{act},\\ell}(t)$ 达到最大值的时间。\n    - 输出 1：$\\Delta t_{\\text{peak}} = t_{\\text{peak},\\text{endo}} - t_{\\text{peak},\\text{epi}}$。\n    - 收缩中期评估时间：$t_{\\text{eval}} = 120\\,\\mathrm{ms}$。\n    - 输出 2：$\\Delta \\varepsilon = \\varepsilon_{\\text{endo}}(t_{\\text{eval}}) - \\varepsilon_{\\text{epi}}(t_{\\text{eval}})$。\n- **数值说明**：\n    - 时间网格：$[0\\,\\mathrm{ms}, 300\\,\\mathrm{ms}]$，步长 $\\Delta t = 0.1\\,\\mathrm{ms}$。\n    - 常微分方程求解器容差：`atol` = $10^{-9}$，`rtol` = $10^{-6}$。\n    - 输出四舍五入：3位小数。\n- **测试套件**：\n    - 用例 A：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.3, 0.1)$。\n    - 用例 B：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.1, 0.1)$。\n    - 用例 C：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.05, 0.3)$。\n    - 用例 D：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.5, 0.5)$。\n    - 用例 E：$(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}}) = (0.6, 0.05)$。\n- **输出格式**：一个表示双元素列表的列表的单行字符串，例如 $\\bigl[[\\Delta t_{\\text{peak}}^{(A)}, \\Delta \\varepsilon^{(A)}], \\dots \\bigr]$。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行评估：\n- **科学依据**：该问题提出了一个心脏电-力学唯象模型。虽然简化，但模型的组成部分基于已建立的生理学原理：瞬时外向钾电流（$I_{\\text{to}}$）在动作电位复极化中的作用、电激活导致钙释放和机械收缩的序列，以及心肌力学的基本表示。该模型是计算心脏病学中使用的一个有效（尽管是最小的）表示。它牢固地定位于*耦合电生理学的心室生物力学*这一主题内。\n- **适定性**：该问题被表述为一个常微分方程（ODE）组的初值问题。ODE的右侧是分段的，但在每个分段内对于状态变量是利普希茨连续的，这确保了给定初始条件下解的存在性和唯一性。所有必要的参数和初始条件都已提供。\n- **客观性**：该问题使用精确、量化和明确的语言陈述。\n- **缺陷检查**：该问题没有违反任何列出的无效标准。它在科学上是合理的、可形式化的、完整的和内部一致的。参数在这样一个模型的合理（尽管是简化的）范围内。该问题结构良好且不平凡。\n\n**步骤 3：结论与行动**\n\n此问题是**有效的**。将提供一个解决方案。\n\n### 求解推导\n\n解决方案需要为心外膜和心内膜细胞模拟耦合的电-力学模型，每个细胞由瞬时外向电导 $g_{\\text{to}}$ 的特定值定义。对于五个测试用例中的每一个，都对两层进行此模拟，并计算指定的输出 $\\Delta t_{\\text{peak}}$ 和 $\\Delta \\varepsilon$。\n\n**1. 常微分方程（ODE）组**\n对于每一层，我们必须为状态向量 $\\mathbf{y}(t) = [v(t), c(t)]^T$ 求解一个由两个耦合的一阶ODE组成的系统：\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y}, g_{\\text{to}})\n$$\n其中函数 $\\mathbf{f}$ 由问题陈述定义：\n$$\n\\frac{dv}{dt} = S(t)\\,\\frac{1 - v}{\\tau_{\\text{dep}}} + \\bigl(1 - S(t)\\bigr)\\times\n\\begin{cases}\n-\\dfrac{v}{\\tau_{\\text{rep}}(g_{\\text{to}})},  \\text{若 } v > v_{\\text{th}},\\\\\n-\\dfrac{v}{\\tau_{\\text{rest}}},  \\text{若 } v \\le v_{\\text{th}},\n\\end{cases}\n$$\n$$\n\\frac{dc}{dt} = k_{\\text{on},0}\\,s(g_{\\text{to}})\\,v(t) - \\frac{c}{\\tau_{\\text{Ca}}}\n$$\n项 $\\tau_{\\text{rep}}(g_{\\text{to}})$ 和 $s(g_{\\text{to}})$ 根据特定层的输入参数 $g_{\\text{to}}$ 计算。初始条件为 $\\mathbf{y}(0) = [v(0), c(0)]^T = [0, 0]^T$。\n\n**2. 数值积分**\n该ODE系统将进行数值求解。`scipy.integrate.solve_ivp` 函数是完成此任务的合适工具。它实现了鲁棒的自适应步长算法（例如默认的 `RK45`），能够处理指定的精度容差（$rtol=10^{-6}, atol=10^{-9}$）以及在阈值 $v_{\\text{th}}$ 处 $v(t)$ 导数的轻微非光滑性。我们将在时间区间 $t \\in [0, 300]\\,\\mathrm{ms}$ 上进行积分，并要求在步长为 $\\Delta t = 0.1\\,\\mathrm{ms}$ 的均匀网格上评估解。\n\n**3. 算法流程**\n对于每个测试用例 $(g_{\\text{to},\\text{epi}}, g_{\\text{to},\\text{endo}})$：\n\na. **定义ODE系统函数**：将实现一个Python函数，该函数接收时间 $t$、状态向量 $\\mathbf{y}=[v, c]$ 和参数 $g_{\\text{to}}$ 作为输入，并根据模型方程返回导数 $[dv/dt, dc/dt]$。\n\nb. **模拟心外膜层**：\n   - 使用初始条件 $[0, 0]$、时间区间 $[0, 300]$、评估时间点、指定的容差以及参数 $g_{\\text{to}} = g_{\\text{to},\\text{epi}}$ 调用 `solve_ivp`。\n   - 求解器返回 $v_{\\text{epi}}(t)$ 和 $c_{\\text{epi}}(t)$ 的时间序列。\n\nc. **模拟心内膜层**：\n   - 使用 $g_{\\text{to}} = g_{\\text{to},\\text{endo}}$ 重复此过程，调用 `solve_ivp`。\n   - 这将得到 $v_{\\text{endo}}(t)$ 和 $c_{\\text{endo}}(t)$ 的时间序列。\n\nd. **后处理与输出计算**：\n   - 对于每一层 $\\ell \\in \\{\\text{epi}, \\text{endo}\\}$，计算主动张力时间序列：\n     $T_{\\text{act},\\ell}(t) = T_{\\max} \\cdot c_{\\ell}(t)$。\n   - 通过找到 $T_{\\text{act},\\ell}(t)$ 数组中最大值对应的时间来找到张力峰值时间 $t_{\\text{peak},\\ell}$。这可以通过 `numpy.argmax` 完成。\n   - 计算峰值时间的差异：$\\Delta t_{\\text{peak}} = t_{\\text{peak},\\text{endo}} - t_{\\text{peak},\\text{epi}}$。\n   - 在收缩中期评估时间 $t_{\\text{eval}} = 120\\,\\mathrm{ms}$ 处找到每一层的主动张力值。这对应于输出数组中的特定索引。\n   - 计算此时刻每层的应变：\n     $\\varepsilon_{\\ell}(t_{\\text{eval}}) = (\\sigma_{\\text{ext}} - T_{\\text{act},\\ell}(t_{\\text{eval}})) / E_{\\text{pass}}$。\n   - 计算应变差异：$\\Delta \\varepsilon = \\varepsilon_{\\text{endo}}(t_{\\text{eval}}) - \\varepsilon_{\\text{epi}}(t_{\\text{eval}})$。\n   - 将 $\\Delta t_{\\text{peak}}$ 和 $\\Delta \\varepsilon$ 都四舍五入到3位小数。\n\ne. **存储结果**：存储当前测试用例计算出的配对 $[\\Delta t_{\\text{peak}}, \\Delta \\varepsilon]$。\n\n**4. 最终输出生成**\n在遍历所有五个测试用例后，将收集到的结果配对列表格式化为指定的单行字符串格式：$\\bigl[[\\dots],[\\dots],\\dots\\bigr]$。这是通过将每个内部列表转换为其字符串表示形式，用逗号连接它们，然后将整个序列括在方括号中来实现的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the difference in time-to-peak active tension and mid-systolic strain\n    between epicardial and endocardial layers for several test cases of I_to gradient.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.3, 0.1),   # Case A: moderate physiological gradient\n        (0.1, 0.1),   # Case B: no gradient\n        (0.05, 0.3),  # Case C: reversed gradient\n        (0.5, 0.5),   # Case D: uniformly high I_to\n        (0.6, 0.05)   # Case E: extreme physiological gradient\n    ]\n    \n    # Model parameters\n    # Electrophysiology\n    v_th = 0.2\n    tau_dep = 1.0  # ms\n    tau_rest = 20.0  # ms\n    tau_rep_0 = 120.0  # ms\n    a = 5.0\n    \n    # Excitation-contraction coupling\n    k_on_0 = 0.06  # ms^-1\n    tau_Ca = 60.0  # ms\n    b = 2.0\n    T_max = 20.0  # kPa\n    \n    # Mechanics\n    E_pass = 80.0  # kPa\n    sigma_ext = 12.0  # kPa\n    \n    # Simulation parameters\n    t_start = 0.0\n    t_end = 300.0\n    dt = 0.1\n    t_eval_points = np.arange(t_start, t_end + dt, dt)\n    t_eval_mid_systole = 120.0 # ms\n\n    # ODE system definition\n    def odes(t, y, g_to):\n        \"\"\"\n        Defines the system of ODEs for voltage v and calcium c.\n        y = [v, c]\n        \"\"\"\n        v, c = y\n        \n        # Stimulus S(t)\n        S = 1.0 if 1.0 <= t <= 3.0 else 0.0\n        \n        # Repolarization time constant\n        tau_rep = tau_rep_0 / (1.0 + a * g_to)\n        \n        # dv/dt\n        if S > 0:\n            dv_dt = S * (1.0 - v) / tau_dep\n        else:\n            if v > v_th:\n                dv_dt = -v / tau_rep\n            else:\n                dv_dt = -v / tau_rest\n        \n        # Calcium sensitivity\n        s_g_to = 1.0 / (1.0 + b * g_to)\n        \n        # dc/dt\n        dc_dt = k_on_0 * s_g_to * v - c / tau_Ca\n        \n        return [dv_dt, dc_dt]\n\n    results = []\n    \n    # Find the index for mid-systolic evaluation\n    t_eval_index = np.where(np.isclose(t_eval_points, t_eval_mid_systole))[0][0]\n\n    for g_to_epi, g_to_endo in test_cases:\n        # --- Simulate Epicardial Layer ---\n        sol_epi = solve_ivp(\n            odes, \n            [t_start, t_end], \n            [0, 0], \n            args=(g_to_epi,),\n            t_eval=t_eval_points, \n            rtol=1e-6, \n            atol=1e-9,\n            method='RK45'\n        )\n        c_epi = sol_epi.y[1]\n        \n        # --- Simulate Endocardial Layer ---\n        sol_endo = solve_ivp(\n            odes, \n            [t_start, t_end], \n            [0, 0], \n            args=(g_to_endo,),\n            t_eval=t_eval_points, \n            rtol=1e-6, \n            atol=1e-9,\n            method='RK45'\n        )\n        c_endo = sol_endo.y[1]\n        \n        # --- Post-processing ---\n        \n        # Active tension\n        T_act_epi = T_max * c_epi\n        T_act_endo = T_max * c_endo\n        \n        # Time to peak tension\n        t_peak_epi = t_eval_points[np.argmax(T_act_epi)]\n        t_peak_endo = t_eval_points[np.argmax(T_act_endo)]\n        delta_t_peak = t_peak_endo - t_peak_epi\n        \n        # Strain at mid-systole\n        T_act_epi_eval = T_act_epi[t_eval_index]\n        T_act_endo_eval = T_act_endo[t_eval_index]\n        \n        eps_epi_eval = (sigma_ext - T_act_epi_eval) / E_pass\n        eps_endo_eval = (sigma_ext - T_act_endo_eval) / E_pass\n        delta_eps = eps_endo_eval - eps_epi_eval\n        \n        # Store rounded results\n        case_result = [round(delta_t_peak, 3), round(delta_eps, 3)]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}