{
    "hands_on_practices": [
        {
            "introduction": "Before tackling the complexities of fluid-structure interaction, it is essential to first characterize the behavior of the fluid itself. The Reynolds number, $Re$, is a foundational dimensionless parameter in fluid mechanics that quantifies the ratio of inertial forces to viscous forces. This practice demonstrates how to derive $Re$ through the nondimensionalization of the Navier-Stokes equations and use its value to predict the flow regime, a critical first step in determining the appropriate modeling approach for any hemodynamic simulation .",
            "id": "4165067",
            "problem": "Consider an incompressible Newtonian model of blood flowing steadily through a long, straight, rigid circular vessel of diameter $D$. Let the characteristic velocity scale be the mean axial speed $U$, and adopt the characteristic length scale $D$ and time scale $D/U$. Starting from the incompressible Navier–Stokes equations,\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p + \\mu \\nabla^{2}\\boldsymbol{u}, \\quad \\nabla\\cdot\\boldsymbol{u} = 0,\n$$\nperform a nondimensionalization to identify the dimensionless group that quantifies the ratio of convective inertia to viscous diffusion in this geometry. Using this result, evaluate that dimensionless group for blood with density $\\rho=1060\\,\\mathrm{kg/m^{3}}$, dynamic viscosity $\\mu=3.5\\,\\mathrm{cP}$, vessel diameter $D=4\\,\\mathrm{mm}$, and mean speed $U=0.4\\,\\mathrm{m/s}$.\n\nThen, based on first principles of hydrodynamic stability for internal flows and considerations relevant to Computational Fluid Dynamics (CFD) and Fluid-Structure Interaction (FSI) in large arteries, briefly reason whether the flow regime is expected to be laminar or transitional under the stated conditions, acknowledging that pulsatility and compliance can modify transition thresholds.\n\nExpress your final computed value as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem requires a two-part analysis: first, to derive the dimensionless group governing the ratio of inertia to viscosity from the incompressible Navier–Stokes equations, and second, to calculate this group for the given parameters and interpret the resulting flow regime.\n\n**Part 1: Nondimensionalization and Identification of the Dimensionless Group**\n\nThe governing equations for an incompressible Newtonian fluid are the Navier–Stokes equations:\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) = -\\nabla p + \\mu \\nabla^{2}\\boldsymbol{u} \\quad \\text{(Momentum Equation)}\n$$\n$$\n\\nabla\\cdot\\boldsymbol{u} = 0 \\quad \\text{(Continuity Equation)}\n$$\nHere, $\\boldsymbol{u}$ is the velocity vector, $p$ is the pressure, $\\rho$ is the fluid density, and $\\mu$ is the dynamic viscosity.\n\nWe are given the characteristic scales for velocity, length, and time:\n- Characteristic velocity: $U$ (mean axial speed)\n- Characteristic length: $D$ (vessel diameter)\n- Characteristic time: $D/U$\n\nWe introduce the following dimensionless variables, denoted by a superscript asterisk ($*$) :\n- Dimensionless velocity: $\\boldsymbol{u}^* = \\frac{\\boldsymbol{u}}{U}$\n- Dimensionless position vector: $\\boldsymbol{x}^* = \\frac{\\boldsymbol{x}}{D}$, which implies the dimensionless gradient operator is $\\nabla^* = D\\nabla$\n- Dimensionless time: $t^* = \\frac{t}{D/U} = \\frac{tU}{D}$\n- Dimensionless pressure: $p^* = \\frac{p - p_0}{P_0}$, where $p_0$ is a reference pressure and $P_0$ is a characteristic pressure scale to be determined.\n\nWe now express the terms of the momentum equation in terms of these dimensionless variables.\nThe partial derivatives become:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial}{\\partial t^*} \\frac{\\partial t^*}{\\partial t} = \\frac{U}{D} \\frac{\\partial}{\\partial t^*}\n$$\n$$\n\\nabla = \\frac{1}{D} \\nabla^*\n$$\nSubstituting these into the momentum equation:\n$$\n\\rho\\left(\\frac{U}{D} \\frac{\\partial (U\\boldsymbol{u}^*)}{\\partial t^*} + (U\\boldsymbol{u}^*)\\cdot\\left(\\frac{1}{D}\\nabla^*\\right) (U\\boldsymbol{u}^*)\\right) = -\\left(\\frac{1}{D}\\nabla^*\\right) (P_0 p^* + p_0) + \\mu \\left(\\frac{1}{D}\\nabla^*\\right)^2 (U\\boldsymbol{u}^*)\n$$\nFactoring out the constant scales:\n$$\n\\rho\\left(\\frac{U^2}{D} \\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + \\frac{U^2}{D} (\\boldsymbol{u}^*\\cdot\\nabla^*) \\boldsymbol{u}^*\\right) = -\\frac{P_0}{D} \\nabla^* p^* + \\frac{\\mu U}{D^2} (\\nabla^*)^2 \\boldsymbol{u}^*\n$$\nThe left-hand side terms represent the local (unsteady) inertia and the convective inertia, respectively. Both have a characteristic magnitude of $\\rho U^2/D$. The right-hand side terms are the pressure gradient and the viscous diffusion. The viscous term has a magnitude of $\\mu U/D^2$.\n\nTo make the equation dimensionless, we divide all terms by a characteristic force per unit volume. We choose the magnitude of the convective inertia term, $\\rho U^2/D$:\n$$\n\\frac{\\rho U^2/D}{\\rho U^2/D} \\left(\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + (\\boldsymbol{u}^*\\cdot\\nabla^*) \\boldsymbol{u}^*\\right) = -\\frac{P_0/D}{\\rho U^2/D} \\nabla^* p^* + \\frac{\\mu U/D^2}{\\rho U^2/D} (\\nabla^*)^2 \\boldsymbol{u}^*\n$$\nSimplifying the coefficients gives:\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + (\\boldsymbol{u}^*\\cdot\\nabla^*) \\boldsymbol{u}^* = -\\left(\\frac{P_0}{\\rho U^2}\\right) \\nabla^* p^* + \\left(\\frac{\\mu U/D^2}{\\rho U^2/D}\\right) (\\nabla^*)^2 \\boldsymbol{u}^*\n$$\nTo make the pressure term of order one, we select the characteristic pressure scale $P_0 = \\rho U^2$. The equation becomes:\n$$\n\\frac{\\partial \\boldsymbol{u}^*}{\\partial t^*} + (\\boldsymbol{u}^*\\cdot\\nabla^*) \\boldsymbol{u}^* = -\\nabla^* p^* + \\left(\\frac{\\mu}{\\rho U D}\\right) (\\nabla^*)^2 \\boldsymbol{u}^*\n$$\nThe dimensionless group that quantifies the ratio of convective inertia to viscous diffusion is the coefficient of the viscous term, or its inverse. The ratio is explicitly:\n$$\n\\frac{\\text{Convective Inertia}}{\\text{Viscous Diffusion}} \\sim \\frac{|\\rho(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}|}{|\\mu\\nabla^2\\boldsymbol{u}|} \\sim \\frac{\\rho U^2/D}{\\mu U/D^2} = \\frac{\\rho U D}{\\mu}\n$$\nThis dimensionless group is the Reynolds number, based on the vessel diameter $D$.\n$$\nRe_D = \\frac{\\rho U D}{\\mu}\n$$\n\n**Part 2: Evaluation and Interpretation**\n\nWe are given the following values:\n- Density: $\\rho=1060\\,\\mathrm{kg/m^{3}}$\n- Dynamic viscosity: $\\mu=3.5\\,\\mathrm{cP}$\n- Vessel diameter: $D=4\\,\\mathrm{mm}$\n- Mean speed: $U=0.4\\,\\mathrm{m/s}$\n\nBefore calculation, we must convert all values to a consistent set of SI units (kg, m, s).\n- Viscosity: $1\\,\\mathrm{cP} = 10^{-3}\\,\\mathrm{Pa \\cdot s} = 10^{-3}\\,\\mathrm{kg \\cdot m^{-1} \\cdot s^{-1}}$. Therefore, $\\mu = 3.5 \\times 10^{-3}\\,\\mathrm{kg \\cdot m^{-1} \\cdot s^{-1}}$.\n- Diameter: $1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$. Therefore, $D = 4 \\times 10^{-3}\\,\\mathrm{m}$.\n\nNow we can compute the Reynolds number:\n$$\nRe_D = \\frac{\\rho U D}{\\mu} = \\frac{(1060\\,\\mathrm{kg/m^{3}}) \\times (0.4\\,\\mathrm{m/s}) \\times (4 \\times 10^{-3}\\,\\mathrm{m})}{3.5 \\times 10^{-3}\\,\\mathrm{kg \\cdot m^{-1} \\cdot s^{-1}}}\n$$\n$$\nRe_D = \\frac{1060 \\times 0.4 \\times 4}{3.5} = \\frac{1696}{3.5} \\approx 484.5714\n$$\nRounding to four significant figures, the value is $484.6$.\n\n**Interpretation of the Flow Regime:**\nThe calculated Reynolds number is $Re_D \\approx 484.6$. For steady flow in a smooth, straight, circular pipe, the transition from a laminar to a turbulent flow regime is generally observed to begin at a critical Reynolds number, $Re_{crit}$, which is typically cited as $Re_{crit} \\approx 2300$.\n\nThe calculated value of $Re_D \\approx 484.6$ is substantially below this critical threshold. Based on this idealized model (steady flow, rigid pipe), the flow regime is expected to be unequivocally laminar.\n\nThe problem asks to consider the effects of pulsatility and compliance, which are characteristic of physiological blood flow in large arteries and are central to FSI analysis.\n1.  **Pulsatility**: The unsteadiness of the cardiac cycle introduces time-dependent accelerations and decelerations. Strong acceleration can stabilize the flow, while deceleration can promote instabilities and transition at Reynolds numbers lower than the steady-flow critical value.\n2.  **Compliance**: The elasticity of the vessel wall allows it to deform under pressure pulses, which is a key aspect of FSI. This wall motion can also influence hydrodynamic stability.\n\nDespite these potentially destabilizing factors, a Reynolds number on the order of $500$ is still considered low for large artery hemodynamics. While peak Reynolds numbers in the ascending aorta can exceed $4000$, leading to \"disturbed\" or transitional flow, the value of $Re_D \\approx 484.6$ is characteristic of more distal arteries or of flow during the diastolic phase. In such conditions, viscous forces remain dominant enough to damp out most disturbances. Therefore, even with pulsatility and compliance, the flow is not expected to enter a transitional state. It would remain firmly in the laminar regime. From a CFD perspective, a direct numerical simulation (DNS) or a standard laminar flow solver would be appropriate, and turbulence modeling would be unnecessary.",
            "answer": "$$\\boxed{484.6}$$"
        },
        {
            "introduction": "A core concept in fluid-structure interaction is the \"added-mass\" effect, where a structure moving through a fluid must displace that fluid, which in turn exerts an inertial force back on the structure. This exercise explores a crucial consequence of this phenomenon in hemodynamics: the added mass of blood can be comparable to the mass of the vessel wall, creating a numerical stability challenge for many computational schemes. By analyzing a simplified model of an arterial segment, you will gain insight into the famous \"added-mass instability\" by deriving the maximum stable time step for a partitioned FSI algorithm .",
            "id": "4165045",
            "problem": "An arterial segment is modeled as a thin-walled, axisymmetric, linearly elastic cylindrical membrane of inner radius $R$ and wall thickness $h$, containing an inviscid, incompressible fluid of density $\\rho_{f}$. The wall density is $\\rho_{s}$ and the wall Young’s modulus is $E$. Assume small, spatially uniform radial displacements $\\eta(t)$ along the axial direction (long-wavelength limit), negligible axial stress, and no viscous effects. Consider a loosely coupled, staggered partitioned Fluid-Structure Interaction (FSI) scheme in which the fluid and structure are advanced explicitly and the interface traction is lagged by one time level.\n\nStarting from Newton’s second law for the wall and the definition of added mass via the fluid kinetic energy, show that the effective fluid added mass per unit inner wall area is determined by the plug-flow approximation of the radial fluid velocity during breathing motion. Use the thin-wall linear membrane relation between pressure and radial displacement for a cylinder under small hoop strain to obtain the effective linear stiffness per unit inner wall area. Define the nondimensional added-mass ratio as the ratio of fluid added mass per unit area to structural mass per unit area, and estimate the maximum stable time step for the staggered explicit scheme by requiring stability of the undamped discrete structural oscillator with effective mass.\n\nGiven the following parameters:\n- Inner radius $R = 2.5 \\times 10^{-3}$ m\n- Wall thickness $h = 8.0 \\times 10^{-4}$ m\n- Wall density $\\rho_{s} = 1.20 \\times 10^{3}$ kg/m$^{3}$\n- Fluid density $\\rho_{f} = 1.06 \\times 10^{3}$ kg/m$^{3}$\n- Young’s modulus $E = 6.0 \\times 10^{5}$ Pa\n\nCompute:\n1. The nondimensional added-mass ratio $\\mathcal{A}$.\n2. The estimated maximum stable time step $\\Delta t_{\\max}$ for the staggered explicit scheme, expressed in seconds.\n\nRound both quantities to four significant figures. Express the time step in seconds, and provide the final answers as two numbers.",
            "solution": "The problem asks for the derivation of parameters for a simplified fluid-structure interaction (FSI) model of an artery and the subsequent calculation of a stability limit for a numerical scheme. We will address each part systematically.\n\nFirst, we define the mass properties of the system per unit of inner wall area. The wall is a cylindrical shell of inner radius $R$, thickness $h$, and density $\\rho_s$. The structural mass per unit inner wall area, $m_s$, is the mass of the wall divided by the inner surface area. Assuming $h \\ll R$, the volume of a segment of length $L$ is approximately the inner surface area $2\\pi R L$ times the thickness $h$.\n$$m_s = \\frac{\\text{mass}}{\\text{area}} = \\frac{\\rho_s (\\text{Volume})}{2\\pi R L} = \\frac{\\rho_s (2\\pi R L h)}{2\\pi R L} = \\rho_s h$$\n\nNext, we derive the effective fluid added mass per unit inner wall area, $m_a$. The problem specifies using the definition of added mass via the fluid kinetic energy, $T_f$. The radial displacement of the wall is $\\eta(t)$, so its velocity is $\\dot{\\eta}(t)$. The problem instructs us to use a \"plug-flow approximation of the radial fluid velocity\", which implies that the radial velocity of the fluid, $u_r$, is uniform across the entire fluid cross-section and equal to the wall velocity: $u_r(r,t) = \\dot{\\eta}(t)$ for $0 \\le r \\le R$.\n\nThe kinetic energy of the fluid in a segment of length $L$ is found by integrating over the fluid volume:\n$$T_f = \\frac{1}{2} \\int_{V} \\rho_f u_r^2 dV = \\frac{1}{2} \\int_0^L \\int_0^R \\rho_f (\\dot{\\eta}(t))^2 (2\\pi r) dr dz$$\n$$T_f = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 (2\\pi L) \\int_0^R r dr = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 (2\\pi L) \\left[\\frac{r^2}{2}\\right]_0^R = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 \\pi R^2 L$$\nThe kinetic energy can also be expressed in terms of the total added mass, $M_a$, as $T_f = \\frac{1}{2} M_a (\\dot{\\eta}(t))^2$. Comparing the two expressions gives the total added mass:\n$$M_a = \\rho_f \\pi R^2 L$$\nThe added mass per unit inner wall area, $m_a$, is this total mass divided by the inner wall area $A_{wall} = 2\\pi R L$:\n$$m_a = \\frac{M_a}{A_{wall}} = \\frac{\\rho_f \\pi R^2 L}{2\\pi R L} = \\frac{\\rho_f R}{2}$$\n\nThe nondimensional added-mass ratio, $\\mathcal{A}$, is defined as the ratio of the fluid added mass per unit area to the structural mass per unit area:\n$$\\mathcal{A} = \\frac{m_a}{m_s} = \\frac{\\rho_f R / 2}{\\rho_s h} = \\frac{\\rho_f R}{2 \\rho_s h}$$\n\nNext, we find the effective linear stiffness per unit inner wall area, $k_{eff}$. The problem directs us to use the thin-wall linear membrane relation. For a thin-walled cylinder, the hoop stress $\\sigma_{\\theta}$ due to an internal pressure $p$ is given by Laplace's law:\n$$\\sigma_{\\theta} = \\frac{pR}{h}$$\nThe hoop strain $\\epsilon_{\\theta}$ is the change in circumference divided by the original circumference, which for a small radial displacement $\\eta$ is:\n$$\\epsilon_{\\theta} = \\frac{2\\pi(R+\\eta) - 2\\pi R}{2\\pi R} = \\frac{\\eta}{R}$$\nFor a linearly elastic material with Young's modulus $E$ and negligible axial stress, the stress-strain relationship is $\\sigma_{\\theta} = E \\epsilon_{\\theta}$. Combining these three equations:\n$$\\frac{pR}{h} = E \\frac{\\eta}{R} \\implies p = \\frac{Eh}{R^2} \\eta$$\nThe stiffness per unit area, $k_{eff}$, is the pressure (force per area) required per unit displacement. Thus,\n$$k_{eff} = \\frac{p}{\\eta} = \\frac{Eh}{R^2}$$\n\nThe problem requires estimating the maximum stable time step, $\\Delta t_{\\max}$, by considering the stability of an \"undamped discrete structural oscillator with effective mass\". This instruction implies we should model the system as a simple harmonic oscillator where the total inertia is the sum of the structural mass and the fluid added mass. The effective mass per unit area is:\n$$m_{eff} = m_s + m_a = \\rho_s h + \\frac{\\rho_f R}{2}$$\nThe equation of motion for this effective oscillator is $m_{eff} \\ddot{\\eta} + k_{eff} \\eta = 0$. The natural angular frequency, $\\omega_0$, of this system is:\n$$\\omega_0 = \\sqrt{\\frac{k_{eff}}{m_{eff}}} = \\sqrt{\\frac{Eh/R^2}{\\rho_s h + \\rho_f R/2}}$$\nFor an explicit time integration scheme, such as the central difference method, the numerical solution of this second-order ordinary differential equation is stable if the time step $\\Delta t$ satisfies the condition $\\Delta t \\le 2/\\omega_0$. This is a standard result for explicit schemes and provides the required estimate.\n$$\\Delta t_{\\max} = \\frac{2}{\\omega_0} = 2 \\sqrt{\\frac{m_{eff}}{k_{eff}}} = 2 \\sqrt{\\frac{\\rho_s h + \\rho_f R/2}{Eh/R^2}}$$\n\nNow we substitute the given numerical values:\n$R = 2.5 \\times 10^{-3}$ m\n$h = 8.0 \\times 10^{-4}$ m\n$\\rho_s = 1.20 \\times 10^{3}$ kg/m$^3$\n$\\rho_f = 1.06 \\times 10^{3}$ kg/m$^3$\n$E = 6.0 \\times 10^{5}$ Pa\n\nFirst, we compute the masses per unit area:\n$m_s = \\rho_s h = (1.20 \\times 10^3 \\, \\text{kg/m}^3) \\times (8.0 \\times 10^{-4} \\, \\text{m}) = 0.96 \\, \\text{kg/m}^2$\n$m_a = \\frac{\\rho_f R}{2} = \\frac{(1.06 \\times 10^3 \\, \\text{kg/m}^3) \\times (2.5 \\times 10^{-3} \\, \\text{m})}{2} = 1.325 \\, \\text{kg/m}^2$\n\n1.  Compute the nondimensional added-mass ratio $\\mathcal{A}$:\n$$\\mathcal{A} = \\frac{m_a}{m_s} = \\frac{1.325}{0.96} = 1.380208...$$\nRounding to four significant figures, $\\mathcal{A} = 1.380$.\n\n2.  Compute the maximum stable time step $\\Delta t_{\\max}$:\nFirst, calculate the effective mass and stiffness:\n$m_{eff} = m_s + m_a = 0.96 + 1.325 = 2.285 \\, \\text{kg/m}^2$\n$k_{eff} = \\frac{Eh}{R^2} = \\frac{(6.0 \\times 10^5 \\, \\text{Pa}) \\times (8.0 \\times 10^{-4} \\, \\text{m})}{(2.5 \\times 10^{-3} \\, \\text{m})^2} = \\frac{480}{6.25 \\times 10^{-6}} = 7.68 \\times 10^7 \\, \\text{Pa/m}$\nNow, compute the time step:\n$$\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_{eff}}{k_{eff}}} = 2 \\sqrt{\\frac{2.285}{7.68 \\times 10^7}} \\approx 2 \\sqrt{2.97526 \\times 10^{-8}} \\approx 2 \\times (1.72495 \\times 10^{-4})$$\n$$\\Delta t_{\\max} \\approx 3.4499 \\times 10^{-4} \\, \\text{s}$$\nRounding to four significant figures, $\\Delta t_{\\max} = 3.450 \\times 10^{-4}$ s.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.380 & 3.450 \\times 10^{-4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "Accurate simulation of flow within deforming domains like a pulsating artery requires the computational mesh to move in concert with the boundaries. This introduces a subtle but critical numerical challenge: the mesh motion itself must not artificially create or destroy mass. This advanced practice addresses the Geometric Conservation Law (GCL), a fundamental constraint ensuring that the rate of change of a cell's volume is precisely accounted for by the velocity of its boundaries. By implementing a mesh motion solver and verifying the GCL, you will tackle a core requirement for building a robust Arbitrary Lagrangian-Eulerian (ALE) solver, which is a cornerstone of modern FSI computation .",
            "id": "4165066",
            "problem": "Consider a two-dimensional computational domain for a straight arterial segment modeled as a rectangle $\\Omega = [0,L]\\times[0,H]$ with a structured grid of $N_x$ nodes in the $x$-direction and $N_y$ nodes in the $y$-direction. The wall exhibits a prescribed normal displacement at the top boundary, and the interior mesh motion is determined by the harmonic mesh motion partial differential equation (PDE) $\\nabla^2 \\mathbf{w} = 0$ with Dirichlet boundary conditions at the fluid-structure interface. Assume the wall motion is purely normal to the wall (vertical) so that the mesh displacement is $\\mathbf{d}(x,y,t) = (0,d_y(x,y,t))$, and the mesh velocity is $\\mathbf{w}(x,y,t) = \\partial \\mathbf{d}/\\partial t = (0,\\partial d_y/\\partial t)$. The interior displacement satisfies the Laplace equation $\\nabla^2 d_y = 0$ in $\\Omega$ with Dirichlet boundary conditions $d_y(x,H,t) = \\delta(x,t)$, $d_y(x,0,t) = 0$, $d_y(0,y,t) = 0$, and $d_y(L,y,t) = 0$. The prescribed top boundary displacement is $\\delta(x,t) = A\\sin\\left(\\pi x/L\\right)\\sin\\left(\\omega t\\right)$, where the angle is in radians. All lengths must be expressed in meters and all times in seconds.\n\nYour tasks are:\n- Starting from the Laplace equation $\\nabla^2 d_y = 0$ and Dirichlet boundary conditions, derive a finite difference discretization for the interior nodes using a five-point stencil consistent with the fundamental conservation laws and smoothness constraints of harmonic functions.\n- For two times $t^n$ and $t^{n+1} = t^n + \\Delta t$, compute the displacement fields $d_y(x,y,t^n)$ and $d_y(x,y,t^{n+1})$, and the mesh velocity field $\\mathbf{w}(x,y,t^n) \\approx \\left(\\mathbf{d}(t^{n+1}) - \\mathbf{d}(t^n)\\right)/\\Delta t$.\n- For each quadrilateral cell formed by four neighboring grid nodes, compute its area $A_c(t)$ at time $t$ using the exact polygon area formula with the current node positions $\\mathbf{r}(x,y,t) = (x, y + d_y(x,y,t))$.\n- Verify the discrete Geometric Conservation Law (GCL) for steady flow (zero fluid velocity) at the mesh level. The continuous Geometric Conservation Law (GCL) states $\\frac{d}{dt}\\int_{\\Omega_c} 1\\,d\\Omega = \\oint_{\\partial\\Omega_c} \\mathbf{w}\\cdot\\mathbf{n}\\,ds = \\int_{\\Omega_c} \\nabla\\cdot\\mathbf{w}\\,d\\Omega$, where $\\Omega_c$ is a control volume (cell). Discretely, for each cell $c$, approximate the boundary flux at time $t^n$ by summing over the four edges $e$ of $c$:\n$$\n\\mathcal{F}_c(t^n) \\approx \\sum_{e\\in\\partial c} \\frac{1}{2}\\left(\\mathbf{w}_{k} + \\mathbf{w}_{k+1}\\right)\\cdot \\mathbf{n}_e\\,\\ell_e,\n$$\nwhere $\\ell_e$ is the edge length at time $t^n$, $\\mathbf{n}_e$ is the outward unit normal at time $t^n$, and $\\mathbf{w}_k$, $\\mathbf{w}_{k+1}$ are the nodal velocities at the endpoints of edge $e$. For straight edges with endpoints $\\mathbf{r}_k$ and $\\mathbf{r}_{k+1}$, an equivalent computationally convenient formula is\n$$\n\\mathcal{F}_c(t^n) \\approx \\frac{1}{2}\\sum_{e\\in\\partial c} \\left(\\mathbf{w}_{k} + \\mathbf{w}_{k+1}\\right)\\cdot \\mathbf{R}_{90}\\left(\\mathbf{r}_{k+1}-\\mathbf{r}_{k}\\right),\n$$\nwhere $\\mathbf{R}_{90}(a_x,a_y) = (-a_y,a_x)$ denotes a $90^\\circ$ rotation operator. The discrete GCL requires\n$$\nA_c(t^{n+1}) - A_c(t^n) \\approx \\Delta t\\,\\mathcal{F}_c(t^n).\n$$\nCompute, for each test case, the maximum absolute normalized residual across all cells,\n$$\nE_{\\max} = \\max_{c}\\left|\\frac{A_c(t^{n+1}) - A_c(t^n) - \\Delta t\\,\\mathcal{F}_c(t^n)}{A_c(t^n)}\\right|,\n$$\nwhich is dimensionless. This quantifies the discrete GCL error at steady flow due solely to mesh motion.\n\nUse the following test suite of parameter sets, designed to probe different regimes. For each test case, use the specified parameters and compute $E_{\\max}$:\n- Case $1$ (baseline smooth motion): $L = 0.02\\,\\text{m}$, $H = 0.004\\,\\text{m}$, $N_x = 41$, $N_y = 21$, $A = 0.0002\\,\\text{m}$, $\\omega = 2\\pi\\cdot 2\\,\\text{rad/s}$, $\\Delta t = 0.001\\,\\text{s}$, $t^n = 0.1\\,\\text{s}$.\n- Case $2$ (no motion edge case): $L = 0.02\\,\\text{m}$, $H = 0.004\\,\\text{m}$, $N_x = 41$, $N_y = 21$, $A = 0\\,\\text{m}$, $\\omega = 2\\pi\\cdot 2\\,\\text{rad/s}$, $\\Delta t = 0.001\\,\\text{s}$, $t^n = 0.1\\,\\text{s}$.\n- Case $3$ (coarse grid higher-frequency): $L = 0.02\\,\\text{m}$, $H = 0.004\\,\\text{m}$, $N_x = 6$, $N_y = 4$, $A = 0.0004\\,\\text{m}$, $\\omega = 2\\pi\\cdot 10\\,\\text{rad/s}$, $\\Delta t = 0.0002\\,\\text{s}$, $t^n = 0.0329\\,\\text{s}$.\n\nYour program must:\n- Assemble and solve the linear system for $\\nabla^2 d_y = 0$ with Dirichlet boundary conditions at $t^n$ and $t^{n+1}$.\n- Compute $\\mathbf{w}(x,y,t^n)$ by finite difference in time.\n- Compute $A_c(t^n)$, $A_c(t^{n+1})$, and $\\mathcal{F}_c(t^n)$ for all cells, and then $E_{\\max}$ for each case.\n- Produce a single line of output containing the three results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$). Each result must be a floating-point number (dimensionless).\n\nAngles must be in radians. Express all distances in meters and time in seconds. The final outputs are dimensionless floating-point values.",
            "solution": "The problem requires the validation of the discrete Geometric Conservation Law (GCL) for a two-dimensional moving mesh. The mesh motion is governed by the harmonic equation for the vertical displacement component, and the GCL error is quantified for several test cases. The solution proceeds in a sequence of logical steps: discretization of the governing partial differential equation (PDE), formulation and solution of the resulting linear algebraic system, computation of mesh velocities, and finally, evaluation of the discrete GCL residual for each computational cell.\n\nFirst, we address the mesh displacement calculation. The vertical displacement of the mesh, $d_y(x,y,t)$, is governed by the two-dimensional Laplace equation, $\\nabla^2 d_y = 0$, within the domain $\\Omega = [0,L]\\times[0,H]$. The equation is subject to Dirichlet boundary conditions:\n$$\nd_y(x,0,t) = 0\n$$\n$$\nd_y(0,y,t) = 0\n$$\n$$\nd_y(L,y,t) = 0\n$$\n$$\nd_y(x,H,t) = \\delta(x,t) = A\\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\omega t\\right)\n$$\nThe domain is discretized by a structured grid with $N_x$ nodes in the $x$-direction and $N_y$ nodes in the $y$-direction. The grid spacing is uniform, with $\\Delta x = L/(N_x-1)$ and $\\Delta y = H/(N_y-1)$. A node is identified by indices $(i,j)$, where $i \\in \\{0, 1, \\dots, N_x-1\\}$ and $j \\in \\{0, 1, \\dots, N_y-1\\}$. The displacement at a node $(x_i, y_j)$ is denoted $d_{i,j}$.\n\nTo solve for the interior displacements, the Laplace equation $\\frac{\\partial^2 d_y}{\\partial x^2} + \\frac{\\partial^2 d_y}{\\partial y^2} = 0$ is discretized using a second-order accurate central finite difference scheme, forming a five-point stencil. For an interior node $(i,j)$:\n$$\n\\frac{d_{i+1,j} - 2d_{i,j} + d_{i-1,j}}{(\\Delta x)^2} + \\frac{d_{i,j+1} - 2d_{i,j} + d_{i,j-1}}{(\\Delta y)^2} = 0\n$$\nThis equation is rearranged to create a linear equation for the unknown displacement $d_{i,j}$ in terms of its neighbors:\n$$\n-2\\left(1 + \\left(\\frac{\\Delta y}{\\Delta x}\\right)^2\\right)d_{i,j} + \\left(\\frac{\\Delta y}{\\Delta x}\\right)^2(d_{i+1,j} + d_{i-1,j}) + (d_{i,j+1} + d_{i,j-1}) = 0\n$$\nThese equations, one for each of the $(N_x-2) \\times (N_y-2)$ interior nodes, form a system of linear equations, $M\\mathbf{d}_{int} = \\mathbf{b}$. Here, $\\mathbf{d}_{int}$ is a vector containing all unknown interior displacements. The matrix $M$ contains the coefficients of the unknown displacements, and the vector $\\mathbf{b}$ contains terms arising from the known boundary conditions. For instance, for an interior node $(i, N_y-2)$ adjacent to the top boundary, the term $d_{i,N_y-1}$ is known ($d_{i,N_y-1} = \\delta(x_i, t)$), and is therefore moved to the right-hand side of the equation, contributing to the vector $\\mathbf{b}$. This linear system is solved twice: once to find the displacement field $d_y(t^n)$ at time $t^n$, and once for $d_y(t^{n+1})$ at time $t^{n+1} = t^n + \\Delta t$.\n\nNext, the mesh velocity field $\\mathbf{w}(x,y,t^n)$ is computed. Since the displacement is purely vertical, $\\mathbf{d} = (0, d_y)$, the velocity is also purely vertical, $\\mathbf{w} = (0, w_y)$. The velocity at each node at time $t^n$ is approximated using a first-order backward finite difference in time:\n$$\n\\mathbf{w}_{i,j}(t^n) = \\frac{\\mathbf{d}_{i,j}(t^{n+1}) - \\mathbf{d}_{i,j}(t^n)}{\\Delta t} \\implies w_{y,i,j}(t^n) = \\frac{d_{i,j}(t^{n+1}) - d_{i,j}(t^n)}{\\Delta t}\n$$\n\nWith the displacements and velocities computed, we proceed to verify the GCL. The domain is composed of $(N_x-1) \\times (N_y-1)$ quadrilateral cells. For each cell $c$, defined by the four corner nodes $(i,j)$, $(i+1,j)$, $(i+1,j+1)$, and $(i,j+1)$, we must compute its area change and the net flux across its boundaries.\n\nThe position of a node $(i,j)$ at time $t$ is $\\mathbf{r}_{i,j}(t) = (x_i, y_j + d_{i,j}(t))$. The area of a cell $c$ at time $t$, denoted $A_c(t)$, is calculated using the shoelace formula for polygon area. For a quadrilateral with vertices $\\mathbf{r}_1, \\mathbf{r}_2, \\mathbf{r}_3, \\mathbf{r}_4$ in counter-clockwise order, where $\\mathbf{r}_k = (r_{x,k}, r_{y,k})$:\n$$\nA_c = \\frac{1}{2} |r_{x,1}r_{y,2} - r_{y,1}r_{x,2} + r_{x,2}r_{y,3} - r_{y,2}r_{x,3} + r_{x,3}r_{y,4} - r_{y,3}r_{x,4} + r_{x,4}r_{y,1} - r_{y,4}r_{x,1}|\n$$\nThis formula is applied to compute $A_c(t^n)$ and $A_c(t^{n+1})$ using the nodal positions at the respective times.\n\nThe boundary flux for a cell $c$ at time $t^n$ is given by the discrete formula:\n$$\n\\mathcal{F}_c(t^n) \\approx \\frac{1}{2}\\sum_{k=1}^{4} \\left(\\mathbf{w}_{k} + \\mathbf{w}_{k+1}\\right)\\cdot \\mathbf{R}_{90}\\left(\\mathbf{r}_{k+1}(t^n)-\\mathbf{r}_{k}(t^n)\\right)\n$$\nwhere the sum is over the four edges of the cell, with vertices indexed cyclically ($\\mathbf{r}_5 = \\mathbf{r}_1$, $\\mathbf{w}_5=\\mathbf{w}_1$). The operator $\\mathbf{R}_{90}(a_x, a_y) = (-a_y, a_x)$ performs a $90^\\circ$ rotation. For this specific problem, where nodal $x$-coordinates are fixed ($r_{x,k}(t) = x_k$) and velocities are purely vertical ($\\mathbf{w}_k = (0, w_{y,k})$), this general formula simplifies considerably. An analysis of the four edge contributions shows that the terms for vertical edges vanish, leading to:\n$$\n\\mathcal{F}_c(t^n) = \\frac{\\Delta x}{2} \\left[ (w_{y,i,j}^n + w_{y,i+1,j}^n) - (w_{y,i+1,j+1}^n + w_{y,i,j+1}^n) \\right]\n$$\nThis simplified expression is computationally efficient and is used in the implementation.\n\nFinally, the discrete GCL demands that the change in cell area is balanced by the time-integrated boundary flux:\n$$\nA_c(t^{n+1}) - A_c(t^n) \\approx \\Delta t\\,\\mathcal{F}_c(t^n)\n$$\nThe error in this conservation law is quantified by the maximum absolute normalized residual over all cells:\n$$\nE_{\\max} = \\max_{c}\\left|\\frac{A_c(t^{n+1}) - A_c(t^n) - \\Delta t\\,\\mathcal{F}_c(t^n)}{A_c(t^n)}\\right|\n$$\nThis dimensionless quantity measures the worst-case violation of the GCL due to the numerical scheme for mesh motion. For the case of no motion ($A=0$), the displacements, velocities, area change, and flux are all identically zero, leading to an expected $E_{\\max}$ of exactly $0$. For the other cases, the residual is expected to be small, typically scaling with a power of $\\Delta t$. The algorithm described is implemented for each test case to compute the corresponding $E_{\\max}$.",
            "answer": "[2.518606822459e-08, 0.0, 1.383115160012e-06]"
        }
    ]
}