{
    "hands_on_practices": [
        {
            "introduction": "The pulsatile nature of blood flow is a defining feature of hemodynamics, distinguishing it from many steady-state engineering flows. The first step toward mastering computational hemodynamics is to understand the fundamental physics governing this pulsatility. This practice guides you through a scaling analysis of the Navier-Stokes equations to derive the Womersley number, $\\alpha$, the key dimensionless parameter that dictates the shape of the velocity profile in arteries and its deviation from a simple parabolic form . A firm grasp of this concept provides the analytical foundation needed to interpret and validate more complex computational fluid dynamics simulations.",
            "id": "4165056",
            "problem": "Consider an axisymmetric pulsatile flow of blood in a straight, circular arterial segment with radius $R$, where blood is modeled as an incompressible Newtonian fluid with density $\\rho$ and dynamic viscosity $\\mu$. Assume the wall motion is negligible on the timescale of the imposed pulsation, so that fluid-structure interaction (FSI) effects are limited to small wall deformations that do not alter the leading-order hydrodynamics in the lumen. The flow is driven by a small-amplitude harmonic pressure gradient of angular frequency $\\omega = 2\\pi f$, where $f$ is the heart rate in hertz. Starting from the incompressible Navier–Stokes equations (Cauchy momentum equation) and continuity,\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^{2} \\mathbf{u}, \\quad \\nabla\\cdot \\mathbf{u} = 0,\n$$\nperform a scaling analysis for laminar, axisymmetric, oscillatory tube flow to identify the dimensionless ratio comparing unsteady inertia to viscous diffusion, defined to be the square of a parameter $\\alpha$. From this analysis, derive an expression for $\\alpha$ in terms of $R$, $\\rho$, $\\mu$, and $\\omega$, and then evaluate $\\alpha$ for the following physiologically realistic values: $R = 2\\,\\mathrm{mm}$, $\\rho = 1060\\,\\mathrm{kg/m^3}$, $\\mu = 3.5\\,\\mathrm{cP}$, and $f = 1.2\\,\\mathrm{Hz}$. In your computation, convert $\\mu$ to $\\mathrm{Pa\\cdot s}$ before use. Finally, based on the magnitude of $\\alpha$, justify whether the instantaneous axial velocity profile over a cycle is closer to a plug-like profile or to a quasi-steady parabolic profile. Express the final numerical value of $\\alpha$ as a dimensionless number rounded to four significant figures.",
            "solution": "The user-provided problem statement is subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Governing Equations**: Incompressible Navier–Stokes equations: $\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^{2} \\mathbf{u}$ and the continuity equation: $\\nabla\\cdot \\mathbf{u} = 0$.\n- **Flow Description**: Axisymmetric, laminar, pulsatile flow of blood in a straight, circular arterial segment.\n- **Fluid Properties**: Blood is modeled as an incompressible Newtonian fluid with density $\\rho$ and dynamic viscosity $\\mu$.\n- **Boundary Conditions**: The arterial wall has a radius $R$. Wall motion is negligible and does not alter leading-order hydrodynamics.\n- **Driving Force**: A small-amplitude harmonic pressure gradient with angular frequency $\\omega = 2\\pi f$, where $f$ is the heart rate.\n- **Task 1**: Perform a scaling analysis to identify the dimensionless ratio comparing unsteady inertia to viscous diffusion.\n- **Task 2**: Define this ratio as $\\alpha^2$ and derive an expression for $\\alpha$ in terms of $R$, $\\rho$, $\\mu$, and $\\omega$.\n- **Task 3**: Evaluate $\\alpha$ for the given physiological values: $R = 2\\,\\mathrm{mm}$, $\\rho = 1060\\,\\mathrm{kg/m^3}$, $\\mu = 3.5\\,\\mathrm{cP}$, and $f = 1.2\\,\\mathrm{Hz}$.\n- **Task 4**: Interpret the magnitude of $\\alpha$ to justify the nature of the instantaneous axial velocity profile (plug-like vs. quasi-steady parabolic).\n- **Output Requirement**: Express the final numerical value of $\\alpha$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is fundamentally sound. It is a canonical problem in physiological fluid mechanics, addressing pulsatile flow in an artery, which is the basis for the Womersley solution. The use of the Navier-Stokes equations and the specified simplifying assumptions (Newtonian fluid, rigid wall, axisymmetric flow) are standard for an introductory analytical treatment of this topic.\n- **Well-Posedness**: The problem is well-posed. It clearly specifies the theoretical framework, the assumptions, the desired derivations, and a numerical calculation with all necessary parameters provided. The objective is to derive and calculate the Womersley number, a well-defined and unique quantity.\n- **Objectivity**: The problem is stated in precise, objective, and quantitative terms, free from ambiguity or subjective content.\n- **Consistency and Completeness**: The provided data and conditions are internally consistent and sufficient to complete all parts of the task. The values for density, viscosity, radius, and heart rate are physiologically realistic for a human artery. There are no contradictions or missing pieces of information.\n\n### Step 3: Verdict and Action\nThe problem is **valid** as it is a well-posed, scientifically grounded, and standard exercise in biofluid mechanics. A full solution will be provided.\n\n***\n\nThe problem requires a scaling analysis of the Navier-Stokes equations to derive the Womersley number, $\\alpha$, followed by its calculation and physical interpretation.\n\nWe begin with the incompressible Navier-Stokes equations. For an axisymmetric flow in a straight circular tube, it is most convenient to use cylindrical coordinates $(r, \\theta, z)$, where $z$ is the axial direction and $r$ is the radial direction. The velocity vector is $\\mathbf{u} = (u_r, u_\\theta, u_z)$.\nFor axisymmetric flow, all derivatives with respect to $\\theta$ are zero, and the azimuthal velocity component $u_\\theta = 0$.\nThe problem describes a flow in a long, straight tube driven by a pressure gradient that is a function of time. We assume the flow is fully developed, which means the velocity profile does not change in the axial direction, i.e., $\\frac{\\partial u_z}{\\partial z} = 0$. From the continuity equation, $\\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} + \\frac{\\partial u_z}{\\partial z} = 0$, this implies $\\frac{\\partial(r u_r)}{\\partial r} = 0$, which, given the no-slip condition at the wall and boundedness at the centerline, requires the radial velocity $u_r$ to be zero.\n\nWith $u_r = 0$ and $\\frac{\\partial u_z}{\\partial z} = 0$, the nonlinear convective acceleration term $\\mathbf{u}\\cdot\\nabla \\mathbf{u}$ vanishes. The axial component of the Navier-Stokes momentum equation simplifies to:\n$$\n\\rho \\frac{\\partial u_z}{\\partial t} = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_z}{\\partial r}\\right) \\right]\n$$\nThis equation describes the balance among local (unsteady) fluid inertia, the driving pressure gradient, and viscous diffusion in the radial direction. The pressure gradient, $-\\frac{\\partial p}{\\partial z}$, is the driving force and is assumed to be a harmonic function of time, but its form is not needed for the scaling analysis.\n\nWe now perform a scaling analysis on the terms involving the velocity $u_z$. The goal is to compare the magnitude of the unsteady inertia term to the viscous diffusion term.\nLet us introduce characteristic scales for the variables:\n-   Characteristic radial length scale: $r \\sim R$ (the radius of the artery).\n-   Characteristic time scale: $t \\sim T = \\frac{1}{\\omega}$, where $\\omega$ is the angular frequency of the pulsation.\n-   Characteristic axial velocity scale: $u_z \\sim U$.\n\nThe magnitude of the unsteady inertia term is estimated as:\n$$\n\\left| \\rho \\frac{\\partial u_z}{\\partial t} \\right| \\sim \\rho \\frac{U}{T} = \\rho U \\omega\n$$\nThe magnitude of the viscous diffusion term is estimated as:\n$$\n\\left| \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_z}{\\partial r}\\right) \\right] \\right| \\sim \\mu \\frac{U}{R^2}\n$$\nThe problem defines the square of a parameter $\\alpha$ as the dimensionless ratio of unsteady inertia to viscous diffusion.\n$$\n\\alpha^2 = \\frac{\\text{Magnitude of Unsteady Inertia}}{\\text{Magnitude of Viscous Diffusion}} \\sim \\frac{\\rho U \\omega}{\\mu U/R^2}\n$$\nThe characteristic velocity scale $U$ cancels out, yielding the expression for $\\alpha^2$:\n$$\n\\alpha^2 = \\frac{\\rho \\omega R^2}{\\mu}\n$$\nFrom this, we derive the expression for $\\alpha$, known as the Womersley number:\n$$\n\\alpha = R \\sqrt{\\frac{\\rho \\omega}{\\mu}}\n$$\nNext, we evaluate $\\alpha$ using the provided physiological values.\nFirst, convert all units to SI base units.\n-   Radius: $R = 2\\,\\mathrm{mm} = 2 \\times 10^{-3}\\,\\mathrm{m}$.\n-   Density: $\\rho = 1060\\,\\mathrm{kg/m^3}$.\n-   Heart rate: $f = 1.2\\,\\mathrm{Hz}$.\n-   Dynamic viscosity: $\\mu = 3.5\\,\\mathrm{cP}$. Using the conversion $1\\,\\mathrm{cP} = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, we have $\\mu = 3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$.\n\nThe angular frequency $\\omega$ is calculated from the heart rate $f$:\n$$\n\\omega = 2\\pi f = 2\\pi (1.2\\,\\mathrm{Hz}) = 2.4\\pi\\,\\mathrm{rad/s}\n$$\nNow, substitute these values into the expression for $\\alpha^2$:\n$$\n\\alpha^2 = \\frac{\\rho \\omega R^2}{\\mu} = \\frac{(1060\\,\\mathrm{kg/m^3}) (2.4\\pi\\,\\mathrm{s}^{-1}) (2 \\times 10^{-3}\\,\\mathrm{m})^2}{3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}}\n$$\n$$\n\\alpha^2 = \\frac{1060 \\times 2.4\\pi \\times (4 \\times 10^{-6})}{3.5 \\times 10^{-3}} = \\frac{10176\\pi \\times 10^{-6}}{3.5 \\times 10^{-3}} = \\frac{10176\\pi}{3.5} \\times 10^{-3}\n$$\n$$\n\\alpha^2 \\approx 9134.04 \\times 10^{-3} \\approx 9.13404\n$$\nTaking the square root to find $\\alpha$:\n$$\n\\alpha = \\sqrt{9.13404} \\approx 3.022258\n$$\nRounding to four significant figures, we get:\n$$\n\\alpha \\approx 3.022\n$$\nFinally, we must justify the shape of the velocity profile based on this value. The Womersley number $\\alpha$ physically represents the ratio of the artery radius $R$ to the viscous penetration depth $\\delta_v = \\sqrt{\\mu / (\\rho\\omega)}$, which is the characteristic distance over which viscous effects diffuse into the fluid during one oscillatory period.\n-   If $\\alpha \\ll 1$, the viscous forces dominate. The flow is slow enough that viscous effects diffuse across the entire tube radius within a cycle. The velocity profile has time to adjust to the changing pressure gradient, resulting in a shape that is parabolic at every instant, much like steady Poiseuille flow. This regime is called **quasi-steady**.\n-   If $\\alpha \\gg 1$, unsteady inertia dominates. Viscous effects are confined to a thin boundary layer near the wall (of thickness $\\sim \\delta_v$). The core fluid, being far from the walls, behaves nearly inviscidly and accelerates and decelerates as a block, or a \"plug\". This results in a flat, **plug-like** velocity profile in the central region of the artery, with steep velocity gradients near the wall.\n\nFor the calculated value $\\alpha \\approx 3.022$, we have $\\alpha > 1$. This indicates that unsteady inertial forces are more significant than viscous forces in the bulk of the flow. The viscous penetration depth is $\\delta_v = R/\\alpha \\approx (2\\,\\mathrm{mm})/3.022 \\approx 0.66\\,\\mathrm{mm}$, which is substantially smaller than the radius of $2\\,\\mathrm{mm}$. Although the flow is not in the extreme $\\alpha \\gg 1$ limit, the profile is significantly blunted from a parabolic shape. Therefore, the instantaneous axial velocity profile is closer to a plug-like profile than to a quasi-steady parabolic profile.",
            "answer": "$$\n\\boxed{3.022}\n$$"
        },
        {
            "introduction": "Moving from pure fluid dynamics to coupled fluid-structure interaction (FSI) introduces new and complex challenges, particularly in numerical stability. When a light structure like an arterial wall interacts with a dense fluid like blood, partitioned or \"staggered\" simulation schemes can suffer from a numerical instability driven by the fluid's inertial loading. This exercise uses a simplified FSI model to demystify this \"added-mass effect,\" allowing you to derive the conditions that limit the maximum stable time step in an explicit simulation . Understanding this principle is of paramount practical importance for successfully setting up and running robust FSI computations.",
            "id": "4165045",
            "problem": "An arterial segment is modeled as a thin-walled, axisymmetric, linearly elastic cylindrical membrane of inner radius $R$ and wall thickness $h$, containing an inviscid, incompressible fluid of density $\\rho_{f}$. The wall density is $\\rho_{s}$ and the wall Young’s modulus is $E$. Assume small, spatially uniform radial displacements $\\eta(t)$ along the axial direction (long-wavelength limit), negligible axial stress, and no viscous effects. Consider a loosely coupled, staggered partitioned Fluid-Structure Interaction (FSI) scheme in which the fluid and structure are advanced explicitly and the interface traction is lagged by one time level.\n\nStarting from Newton’s second law for the wall and the definition of added mass via the fluid kinetic energy, show that the effective fluid added mass per unit inner wall area is determined by the plug-flow approximation of the radial fluid velocity during breathing motion. Use the thin-wall linear membrane relation between pressure and radial displacement for a cylinder under small hoop strain to obtain the effective linear stiffness per unit inner wall area. Define the nondimensional added-mass ratio as the ratio of fluid added mass per unit area to structural mass per unit area, and estimate the maximum stable time step for the staggered explicit scheme by requiring stability of the undamped discrete structural oscillator with effective mass.\n\nGiven the following parameters:\n- Inner radius $R = 2.5 \\times 10^{-3}$ m\n- Wall thickness $h = 8.0 \\times 10^{-4}$ m\n- Wall density $\\rho_{s} = 1.20 \\times 10^{3}$ kg/m$^3$\n- Fluid density $\\rho_{f} = 1.06 \\times 10^{3}$ kg/m$^3$\n- Young’s modulus $E = 6.0 \\times 10^{5}$ Pa\n\nCompute:\n1. The nondimensional added-mass ratio $\\mathcal{A}$.\n2. The estimated maximum stable time step $\\Delta t_{\\max}$ for the staggered explicit scheme, expressed in seconds.\n\nRound both quantities to four significant figures. Express the time step in seconds, and provide the final answers as two numbers.",
            "solution": "The problem asks for the derivation of parameters for a simplified fluid-structure interaction (FSI) model of an artery and the subsequent calculation of a stability limit for a numerical scheme. We will address each part systematically.\n\nFirst, we define the mass properties of the system per unit of inner wall area. The wall is a cylindrical shell of inner radius $R$, thickness $h$, and density $\\rho_s$. The structural mass per unit inner wall area, $m_s$, is the mass of the wall divided by the inner surface area. Assuming $h \\ll R$, the volume of a segment of length $L$ is approximately the inner surface area $2\\pi R L$ times the thickness $h$.\n$$m_s = \\frac{\\text{mass}}{\\text{area}} = \\frac{\\rho_s (\\text{Volume})}{2\\pi R L} = \\frac{\\rho_s (2\\pi R L h)}{2\\pi R L} = \\rho_s h$$\n\nNext, we derive the effective fluid added mass per unit inner wall area, $m_a$. The problem specifies using the definition of added mass via the fluid kinetic energy, $T_f$. The radial displacement of the wall is $\\eta(t)$, so its velocity is $\\dot{\\eta}(t)$. The problem instructs us to use a \"plug-flow approximation of the radial fluid velocity\", which implies that the radial velocity of the fluid, $u_r$, is uniform across the entire fluid cross-section and equal to the wall velocity: $u_r(r,t) = \\dot{\\eta}(t)$ for $0 \\le r \\le R$.\n\nThe kinetic energy of the fluid in a segment of length $L$ is found by integrating over the fluid volume:\n$$T_f = \\frac{1}{2} \\int_{V} \\rho_f u_r^2 dV = \\frac{1}{2} \\int_0^L \\int_0^R \\rho_f (\\dot{\\eta}(t))^2 (2\\pi r) dr dz$$\n$$T_f = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 (2\\pi L) \\int_0^R r dr = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 (2\\pi L) \\left[\\frac{r^2}{2}\\right]_0^R = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 \\pi R^2 L$$\nThe kinetic energy can also be expressed in terms of the total added mass, $M_a$, as $T_f = \\frac{1}{2} M_a (\\dot{\\eta}(t))^2$. Comparing the two expressions gives the total added mass:\n$$M_a = \\rho_f \\pi R^2 L$$\nThe added mass per unit inner wall area, $m_a$, is this total mass divided by the inner wall area $A_{wall} = 2\\pi R L$:\n$$m_a = \\frac{M_a}{A_{wall}} = \\frac{\\rho_f \\pi R^2 L}{2\\pi R L} = \\frac{\\rho_f R}{2}$$\n\nThe nondimensional added-mass ratio, $\\mathcal{A}$, is defined as the ratio of the fluid added mass per unit area to the structural mass per unit area:\n$$\\mathcal{A} = \\frac{m_a}{m_s} = \\frac{\\rho_f R / 2}{\\rho_s h} = \\frac{\\rho_f R}{2 \\rho_s h}$$\n\nNext, we find the effective linear stiffness per unit inner wall area, $k_{eff}$. The problem directs us to use the thin-wall linear membrane relation. For a thin-walled cylinder, the hoop stress $\\sigma_{\\theta}$ due to an internal pressure $p$ is given by Laplace's law:\n$$\\sigma_{\\theta} = \\frac{pR}{h}$$\nThe hoop strain $\\epsilon_{\\theta}$ is the change in circumference divided by the original circumference, which for a small radial displacement $\\eta$ is:\n$$\\epsilon_{\\theta} = \\frac{2\\pi(R+\\eta) - 2\\pi R}{2\\pi R} = \\frac{\\eta}{R}$$\nFor a linearly elastic material with Young's modulus $E$ and negligible axial stress, the stress-strain relationship is $\\sigma_{\\theta} = E \\epsilon_{\\theta}$. Combining these three equations:\n$$\\frac{pR}{h} = E \\frac{\\eta}{R} \\implies p = \\frac{Eh}{R^2} \\eta$$\nThe stiffness per unit area, $k_{eff}$, is the pressure (force per area) required per unit displacement. Thus,\n$$k_{eff} = \\frac{p}{\\eta} = \\frac{Eh}{R^2}$$\n\nThe problem requires estimating the maximum stable time step, $\\Delta t_{\\max}$, by considering the stability of an \"undamped discrete structural oscillator with effective mass\". This instruction implies we should model the system as a simple harmonic oscillator where the total inertia is the sum of the structural mass and the fluid added mass. The effective mass per unit area is:\n$$m_{eff} = m_s + m_a = \\rho_s h + \\frac{\\rho_f R}{2}$$\nThe equation of motion for this effective oscillator is $m_{eff} \\ddot{\\eta} + k_{eff} \\eta = 0$. The natural angular frequency, $\\omega_0$, of this system is:\n$$\\omega_0 = \\sqrt{\\frac{k_{eff}}{m_{eff}}} = \\sqrt{\\frac{Eh/R^2}{\\rho_s h + \\rho_f R/2}}$$\nFor an explicit time integration scheme, such as the central difference method, the numerical solution of this second-order ordinary differential equation is stable if the time step $\\Delta t$ satisfies the condition $\\Delta t \\le 2/\\omega_0$. This is a standard result for explicit schemes and provides the required estimate.\n$$\\Delta t_{\\max} = \\frac{2}{\\omega_0} = 2 \\sqrt{\\frac{m_{eff}}{k_{eff}}} = 2 \\sqrt{\\frac{\\rho_s h + \\rho_f R/2}{Eh/R^2}}$$\n\nNow we substitute the given numerical values:\n$R = 2.5 \\times 10^{-3}$ m\n$h = 8.0 \\times 10^{-4}$ m\n$\\rho_s = 1.20 \\times 10^{3}$ kg/m$^3$\n$\\rho_f = 1.06 \\times 10^{3}$ kg/m$^3$\n$E = 6.0 \\times 10^{5}$ Pa\n\nFirst, we compute the masses per unit area:\n$m_s = \\rho_s h = (1.20 \\times 10^3 \\, \\text{kg/m}^3) \\times (8.0 \\times 10^{-4} \\, \\text{m}) = 0.96 \\, \\text{kg/m}^2$\n$m_a = \\frac{\\rho_f R}{2} = \\frac{(1.06 \\times 10^3 \\, \\text{kg/m}^3) \\times (2.5 \\times 10^{-3} \\, \\text{m})}{2} = 1.325 \\, \\text{kg/m}^2$\n\n1.  Compute the nondimensional added-mass ratio $\\mathcal{A}$:\n$$\\mathcal{A} = \\frac{m_a}{m_s} = \\frac{1.325}{0.96} = 1.380208...$$\nRounding to four significant figures, $\\mathcal{A} = 1.380$.\n\n2.  Compute the maximum stable time step $\\Delta t_{\\max}$:\nFirst, calculate the effective mass and stiffness:\n$m_{eff} = m_s + m_a = 0.96 + 1.325 = 2.285 \\, \\text{kg/m}^2$\n$k_{eff} = \\frac{Eh}{R^2} = \\frac{(6.0 \\times 10^5 \\, \\text{Pa}) \\times (8.0 \\times 10^{-4} \\, \\text{m})}{(2.5 \\times 10^{-3} \\, \\text{m})^2} = \\frac{480}{6.25 \\times 10^{-6}} = 7.68 \\times 10^7 \\, \\text{Pa/m}$\nNow, compute the time step:\n$$\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_{eff}}{k_{eff}}} = 2 \\sqrt{\\frac{2.285}{7.68 \\times 10^7}} \\approx 2 \\sqrt{2.97526 \\times 10^{-8}} \\approx 2 \\times (1.72495 \\times 10^{-4})$$\n$$\\Delta t_{\\max} \\approx 3.4499 \\times 10^{-4} \\, \\text{s}$$\nRounding to four significant figures, $\\Delta t_{\\max} = 3.450 \\times 10^{-4}$ s.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.380 & 3.450 \\times 10^{-4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "The ultimate goal of many biomechanical simulations is not just to compute flow fields, but to extract actionable biological or clinical insights. This requires translating raw simulation data into metrics that correlate with physiological processes. This final practice places you in the role of a researcher, tasking you with post-processing a time-series of wall shear stress to calculate key hemodynamic descriptors: the Time-Averaged Wall Shear Stress ($\\mathrm{TAWSS}$), the Oscillatory Shear Index ($\\mathrm{OSI}$), and the Relative Residence Time ($\\mathrm{RRT}$) . Mastering this type of analysis is essential for connecting the outputs of your computational models to the complex biological world of endothelial cell function and vascular disease.",
            "id": "4165050",
            "problem": "You are given a simulated signed scalar time series of tangential wall shear stress at an aneurysm dome, denoted by $ \\tau_{w}(t) $ with physical units of Pascal ($ \\mathrm{Pa} $), representing the projection of the wall shear stress vector onto a fixed tangent direction. The purpose is to quantify hemodynamic descriptors relevant to endothelial function by computing the time-averaged wall shear stress, the oscillatory shear index, and the relative residence time over a finite observation window of duration $ T $.\n\nStarting from the fundamental definitions of time averages as integrals over a finite interval and using the notion that $ \\tau_{w}(t) $ can change sign to represent directional reversal of the wall traction, derive expressions for:\n- the time-averaged wall shear stress magnitude over $ [0,T] $,\n- a dimensionless oscillation index that compares the magnitude of the time-averaged signed shear to the time-average of the magnitude, and\n- a relative residence time defined as the reciprocal of the product of the time-averaged wall shear stress and a directional stability factor.\n\nThen, implement a numerical method that approximates all required time integrals using the trapezoidal rule on discrete samples $ \\{ t_{k}, \\tau_{w}(t_{k}) \\}_{k=0}^{N} $ at uniform temporal spacing. Treat $ \\tau_{w}(t) $ as a signed scalar throughout. If the directional stability factor becomes numerically nonpositive due to oscillations (that is, if the factor $ 1 - 2\\,\\mathrm{OSI} $ is within a tolerance of $ 10^{-12} $ of $ 0 $ or negative), then return the relative residence time as mathematical infinity.\n\nYour program must construct each test time series from a parameterized form\n$$\n\\tau_{w}(t) = b + a \\sin(2\\pi f t),\n$$\nsampled uniformly as $ t_{k} = k\\,\\Delta t $ for $ k = 0, 1, \\dots, N $ with $ \\Delta t = 1/f_{s} $ and $ N = \\lfloor T_{\\mathrm{end}} f_{s} \\rfloor $. For each test case, compute:\n- the time-averaged wall shear stress $ \\mathrm{TAWSS} $ in $ \\mathrm{Pa} $,\n- the oscillatory shear index $ \\mathrm{OSI} $ as a unitless decimal fraction,\n- the relative residence time $ \\mathrm{RRT} $ in $ \\mathrm{Pa}^{-1} $.\n\nExpress $ \\mathrm{TAWSS} $ in $ \\mathrm{Pa} $, $ \\mathrm{OSI} $ as a decimal fraction (no percentage sign), and $ \\mathrm{RRT} $ in $ \\mathrm{Pa}^{-1} $. For numerical reporting, round each scalar metric to $ 6 $ decimal places.\n\nTest Suite:\nUse the following four parameter sets to generate the time series:\n- Case $ \\mathrm{A} $ (predominantly unidirectional pulsatile shear; happy path): $ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $, $ f_{s} = 1000\\,\\mathrm{Hz} $, $ f = 1.0\\,\\mathrm{Hz} $, $ b = 1.0\\,\\mathrm{Pa} $, $ a = 0.8\\,\\mathrm{Pa} $.\n- Case $ \\mathrm{B} $ (mean-biased oscillation with reversals): $ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $, $ f_{s} = 1000\\,\\mathrm{Hz} $, $ f = 1.0\\,\\mathrm{Hz} $, $ b = 0.2\\,\\mathrm{Pa} $, $ a = 0.5\\,\\mathrm{Pa} $.\n- Case $ \\mathrm{C} $ (near-symmetric oscillation with slight bias and non-integer cycles; explores near-singular denominator): $ T_{\\mathrm{end}} = 1.1\\,\\mathrm{s} $, $ f_{s} = 1000\\,\\mathrm{Hz} $, $ f = 1.0\\,\\mathrm{Hz} $, $ b = 0.01\\,\\mathrm{Pa} $, $ a = 0.5\\,\\mathrm{Pa} $.\n- Case $ \\mathrm{D} $ (very small stresses with strong oscillation and non-integer cycles; edge case for large relative residence time): $ T_{\\mathrm{end}} = 1.3\\,\\mathrm{s} $, $ f_{s} = 2000\\,\\mathrm{Hz} $, $ f = 1.7\\,\\mathrm{Hz} $, $ b = 0.001\\,\\mathrm{Pa} $, $ a = 0.0015\\,\\mathrm{Pa} $.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a list $ [\\mathrm{TAWSS}, \\mathrm{OSI}, \\mathrm{RRT}] $ in that order, each value rounded to $ 6 $ decimal places. The overall output must therefore be a list of lists in the order $ \\mathrm{A}, \\mathrm{B}, \\mathrm{C}, \\mathrm{D} $. For example, the printed output must have the exact list-of-lists structure like $ [[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],[x_{3},y_{3},z_{3}],[x_{4},y_{4},z_{4}]] $ with no additional text.",
            "solution": "We begin from first principles defining the wall shear stress as the tangential traction at the fluid–wall interface. Let $ \\boldsymbol{\\tau}_{w}(t) $ be the wall shear stress vector. In the present one-dimensional projection, we consider the signed scalar projection $ \\tau_{w}(t) $ onto a fixed tangent unit vector, so that reversal of near-wall flow corresponds to a change in the sign of $ \\tau_{w}(t) $. Let the observation interval be $ [0,T] $.\n\nTime-averaged magnitude of wall shear stress: By definition of a time average of a function $ g(t) $ on $ [0,T] $,\n$$\n\\langle g \\rangle = \\frac{1}{T}\\int_{0}^{T} g(t)\\, dt.\n$$\nTo quantify the average mechanical stimulus experienced by endothelial cells, we use the magnitude of the shear stress, so the time-averaged wall shear stress is\n$$\n\\mathrm{TAWSS} = \\frac{1}{T} \\int_{0}^{T} \\left| \\tau_{w}(t) \\right| \\, dt,\n$$\nwith units of $ \\mathrm{Pa} $.\n\nOscillatory Shear Index: Directional oscillation is captured by comparing the magnitude of the time-averaged signed traction to the time average of its magnitude. Denote the time integral of the signed shear by\n$$\nI_{s} = \\int_{0}^{T} \\tau_{w}(t)\\, dt,\n$$\nand the time integral of the magnitude by\n$$\nI_{m} = \\int_{0}^{T} \\left| \\tau_{w}(t) \\right| \\, dt.\n$$\nA commonly used nondimensional descriptor that maps from unidirectional flow to $ 0 $ and to maximally oscillatory (perfect reversal) flow to $ \\tfrac{1}{2} $ is\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left( 1 - \\frac{ \\left| I_{s} \\right| }{ I_{m} } \\right),\n$$\nwhere $ \\left| \\cdot \\right| $ denotes the absolute value. For purely unidirectional shear with $ \\tau_{w}(t) \\ge 0 $ for all $ t $, one has $ I_{s} = I_{m} $ and $ \\mathrm{OSI} = 0 $. For a perfectly symmetric oscillation with zero mean over an integer number of cycles, $ I_{s} = 0 $ and $ \\mathrm{OSI} = \\tfrac{1}{2} $.\n\nRelative Residence Time: Hemodynamic residence increases when $ \\mathrm{TAWSS} $ is small and when oscillations are strong. A commonly adopted descriptor is the reciprocal of the product of $ \\mathrm{TAWSS} $ and the directional stability factor $ 1 - 2\\,\\mathrm{OSI} $, namely\n$$\n\\mathrm{RRT} = \\frac{1}{ \\mathrm{TAWSS} \\left( 1 - 2\\,\\mathrm{OSI} \\right) }.\n$$\nThe units are $ \\mathrm{Pa}^{-1} $ since $ \\mathrm{OSI} $ is dimensionless. If $ \\mathrm{OSI} \\to \\tfrac{1}{2} $ and $ \\mathrm{TAWSS} $ is finite, then $ \\mathrm{RRT} \\to \\infty $.\n\nNumerical approximation: The inputs are discrete samples $ \\{ t_{k}, \\tau_{w}(t_{k}) \\}_{k=0}^{N} $ at uniform spacing $ \\Delta t = t_{k+1} - t_{k} $, with $ t_{0} = 0 $, $ t_{N} = T $. Approximating integrals using the trapezoidal rule,\n$$\n\\int_{0}^{T} \\phi(t)\\, dt \\approx \\sum_{k=0}^{N-1} \\frac{ \\phi(t_{k}) + \\phi(t_{k+1}) }{2}\\, \\Delta t = \\mathrm{trapz}\\left( \\phi(t_{k}), t_{k} \\right),\n$$\nwe compute\n$$\nI_{m} \\approx \\mathrm{trapz}\\left( \\left| \\tau_{w}(t_{k}) \\right|, t_{k} \\right), \\quad I_{s} \\approx \\mathrm{trapz}\\left( \\tau_{w}(t_{k}), t_{k} \\right),\n$$\n$$\n\\mathrm{TAWSS} \\approx \\frac{ I_{m} }{ T }, \\quad \\mathrm{OSI} \\approx \\frac{1}{2}\\left( 1 - \\frac{ \\left| I_{s} \\right| }{ I_{m} } \\right),\n$$\nand then\n$$\n\\mathrm{RRT} \\approx \\frac{1}{ \\mathrm{TAWSS}\\, \\left( 1 - 2\\,\\mathrm{OSI} \\right) }.\n$$\nTo maintain numerical robustness, if $ 1 - 2\\,\\mathrm{OSI} \\le 10^{-12} $ we return $ \\mathrm{RRT} = \\infty $.\n\nConstruction of test series: Each test series is defined by\n$$\n\\tau_{w}(t) = b + a \\sin( 2\\pi f t ), \\quad t = 0, \\Delta t, 2\\Delta t, \\dots, T_{\\mathrm{end}},\n$$\nwith $ \\Delta t = 1/f_{s} $ and $ f_{s} $ the sampling frequency. The four cases are:\n- Case $ \\mathrm{A} $: $ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $, $ f_{s} = 1000\\,\\mathrm{Hz} $, $ f = 1.0\\,\\mathrm{Hz} $, $ b = 1.0\\,\\mathrm{Pa} $, $ a = 0.8\\,\\mathrm{Pa} $. Here $ \\tau_{w}(t) \\ge 0 $, so we expect $ \\mathrm{OSI} \\approx 0 $ and $ \\mathrm{TAWSS} \\approx b = 1.0\\,\\mathrm{Pa} $, giving $ \\mathrm{RRT} \\approx 1.0\\,\\mathrm{Pa}^{-1} $.\n- Case $ \\mathrm{B} $: $ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $, $ f_{s} = 1000\\,\\mathrm{Hz} $, $ f = 1.0\\,\\mathrm{Hz} $, $ b = 0.2\\,\\mathrm{Pa} $, $ a = 0.5\\,\\mathrm{Pa} $. There are reversals; $ \\mathrm{OSI} $ is intermediate, $ \\mathrm{TAWSS} $ is reduced compared to the mean magnitude, and $ \\mathrm{RRT} $ is elevated.\n- Case $ \\mathrm{C} $: $ T_{\\mathrm{end}} = 1.1\\,\\mathrm{s} $, $ f_{s} = 1000\\,\\mathrm{Hz} $, $ f = 1.0\\,\\mathrm{Hz} $, $ b = 0.01\\,\\mathrm{Pa} $, $ a = 0.5\\,\\mathrm{Pa} $. The near-symmetric oscillation over a non-integer number of cycles yields $ \\mathrm{OSI} $ close to $ 0.5 $ but not exactly, producing large but finite $ \\mathrm{RRT} $.\n- Case $ \\mathrm{D} $: $ T_{\\mathrm{end}} = 1.3\\,\\mathrm{s} $, $ f_{s} = 2000\\,\\mathrm{Hz} $, $ f = 1.7\\,\\mathrm{Hz} $, $ b = 0.001\\,\\mathrm{Pa} $, $ a = 0.0015\\,\\mathrm{Pa} $. Very small magnitudes with strong oscillation yield small $ \\mathrm{TAWSS} $ and large $ \\mathrm{RRT} $.\n\nAlgorithmic steps:\n- For each case, generate the uniform time grid $ t_{k} $ and the series $ \\tau_{w}(t_{k}) $.\n- Compute $ T = t_{N} - t_{0} $.\n- Use the trapezoidal rule to compute $ I_{m} $ and $ I_{s} $, then compute $ \\mathrm{TAWSS} $, $ \\mathrm{OSI} $, and $ \\mathrm{RRT} $ with the robustness rule for near-zero $ 1 - 2\\,\\mathrm{OSI} $.\n- Round each value to $ 6 $ decimal places and produce the list-of-lists in the prescribed order.\n\nInterpretation with respect to endothelial dysfunction: Low $ \\mathrm{TAWSS} $ and high $ \\mathrm{OSI} $ have been associated with endothelial dysfunction in aneurysms due to impaired nitric oxide signaling, pro-inflammatory states, and thrombogenic potential. The $ \\mathrm{RRT} $ aggregates these effects; high $ \\mathrm{RRT} $ indicates prolonged particle residence near the wall. Thus:\n- Case $ \\mathrm{A} $ (high $ \\mathrm{TAWSS} $, low $ \\mathrm{OSI} $) suggests a comparatively protective regime with low $ \\mathrm{RRT} $.\n- Cases $ \\mathrm{B} $ and $ \\mathrm{C} $ show increasing oscillation and reduced effective shear, raising $ \\mathrm{RRT} $ and indicating greater propensity for endothelial dysfunction.\n- Case $ \\mathrm{D} $ has very small $ \\mathrm{TAWSS} $ with strong oscillation, yielding very large $ \\mathrm{RRT} $, indicative of a highly adverse hemodynamic environment.\n\nThe final program implements these steps and prints a single line in the required format $[[\\mathrm{TAWSS}_{A},\\mathrm{OSI}_{A},\\mathrm{RRT}_{A}],\\dots,[\\mathrm{TAWSS}_{D},\\mathrm{OSI}_{D},\\mathrm{RRT}_{D}]]$, with each scalar rounded to $ 6 $ decimal places and units as specified.",
            "answer": "[[1.000000,0.000000,1.000000],[0.334549,0.165919,4.492187],[0.319086,0.485121,31.571440],[0.001099,0.354676,3121.284793]]"
        }
    ]
}