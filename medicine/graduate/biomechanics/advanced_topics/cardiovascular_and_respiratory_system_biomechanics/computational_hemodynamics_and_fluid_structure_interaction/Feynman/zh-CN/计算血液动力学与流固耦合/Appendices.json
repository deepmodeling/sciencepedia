{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的模拟之前，理解控制血流的基本物理原理至关重要。本练习聚焦于血液动力学的标志性特征——脉动流。通过对纳维-斯托克斯方程进行量纲分析，您将推导并计算沃默斯利数（Womersley number），这是一个关键的无量纲参数，它决定了动脉中速度分布的形态。",
            "id": "4165056",
            "problem": "考虑在半径为 $R$ 的直圆形动脉段中，血液的轴对称脉动流。其中，血液被建模为密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体。假设在施加的脉动的时间尺度上，管壁运动可以忽略不计，因此流固耦合（FSI）效应仅限于不会改变管腔内主导阶流体动力学的微小管壁变形。该流动由角频率为 $\\omega = 2\\pi f$ 的小振幅简谐压力梯度驱动，其中 $f$ 是以赫兹为单位的心率。从不可压缩 Navier–Stokes 方程（Cauchy 动量方程）和连续性方程出发，\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^{2} \\mathbf{u}, \\quad \\nabla\\cdot \\mathbf{u} = 0,\n$$\n对层流、轴对称、振荡管流进行标度分析，以确定比较非定常惯性与粘性扩散的无量纲比，该比值定义为参数 $\\alpha$ 的平方。根据此分析，推导出用 $R$、$\\rho$、$\\mu$ 和 $\\omega$ 表示的 $\\alpha$ 的表达式，然后使用以下生理学上的实际值计算 $\\alpha$：$R = 2\\,\\mathrm{mm}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 3.5\\,\\mathrm{cP}$，以及 $f = 1.2\\,\\mathrm{Hz}$。在计算中，请先将 $\\mu$ 转换为 $\\mathrm{Pa\\cdot s}$。最后，根据 $\\alpha$ 的大小，论证一个周期内的瞬时轴向速度剖面更接近于栓塞状剖面还是准稳态抛物线剖面。将 $\\alpha$ 的最终数值表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "用户提供的问题陈述经过了严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **控制方程**: 不可压缩 Navier–Stokes 方程：$\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^{2} \\mathbf{u}$ 和连续性方程：$\\nabla\\cdot \\mathbf{u} = 0$。\n- **流动描述**: 直圆形动脉段中血液的轴对称、层流、脉动流。\n- **流体属性**: 血液被建模为密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体。\n- **边界条件**: 动脉壁半径为 $R$。管壁运动可忽略不计，且不改变主导阶流体动力学。\n- **驱动力**: 角频率为 $\\omega = 2\\pi f$ 的小振幅简谐压力梯度，其中 $f$ 是心率。\n- **任务 1**: 进行标度分析，以确定比较非定常惯性与粘性扩散的无量纲比。\n- **任务 2**: 将此比值定义为 $\\alpha^2$，并推导出用 $R$、$\\rho$、$\\mu$ 和 $\\omega$ 表示的 $\\alpha$ 的表达式。\n- **任务 3**: 使用给定的生理学值计算 $\\alpha$：$R = 2\\,\\mathrm{mm}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 3.5\\,\\mathrm{cP}$，以及 $f = 1.2\\,\\mathrm{Hz}$。\n- **任务 4**: 解释 $\\alpha$ 的大小，以论证瞬时轴向速度剖面的性质（栓塞状 vs. 准稳态抛物线状）。\n- **输出要求**: 将 $\\alpha$ 的最终数值表示为一个无量纲数，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**: 这个问题在基础上是合理的。它是生理流体力学中的一个经典问题，涉及动脉中的脉动流，这是 Womersley 解的基础。使用 Navier-Stokes 方程和指定的简化假设（牛顿流体、刚性壁、轴对称流）是该主题入门分析处理的标准方法。\n- **适定性**: 这个问题是适定的。它清楚地指明了理论框架、假设、所需的推导以及提供了所有必要参数的数值计算。目标是推导和计算 Womersley 数，这是一个定义明确且唯一的量。\n- **客观性**: 问题的陈述精确、客观、定量，没有歧义或主观内容。\n- **一致性和完整性**: 所提供的数据和条件内部一致，足以完成任务的所有部分。密度、粘度、半径和心率的值对于人体动脉是生理学上现实的。没有矛盾或信息缺失。\n\n### 步骤 3：结论与行动\n这个问题是**有效的**，因为它是一个适定的、有科学依据的、生物流体力学中的标准练习。将提供完整的解答。\n\n***\n\n该问题要求对 Navier-Stokes 方程进行标度分析，以推导出 Womersley 数 $\\alpha$，然后对其进行计算和物理解释。\n\n我们从不可压缩 Navier-Stokes 方程开始。对于直圆管中的轴对称流，最方便的是使用柱坐标系 $(r, \\theta, z)$，其中 $z$ 是轴向，$r$ 是径向。速度矢量为 $\\mathbf{u} = (u_r, u_\\theta, u_z)$。\n对于轴对称流，所有关于 $\\theta$ 的导数都为零，并且方位角速度分量 $u_\\theta = 0$。\n该问题描述了在一个长直管中由一个随时间变化的压力梯度驱动的流动。我们假设流动是充分发展的，这意味着速度剖面在轴向上不发生变化，即 $\\frac{\\partial u_z}{\\partial z} = 0$。根据连续性方程 $\\frac{1}{r}\\frac{\\partial(r u_r)}{\\partial r} + \\frac{\\partial u_z}{\\partial z} = 0$，这意味着 $\\frac{\\partial(r u_r)}{\\partial r} = 0$，考虑到壁面上的无滑移条件和中心线上的有界性，这要求径向速度 $u_r$ 为零。\n\n在 $u_r = 0$ 和 $\\frac{\\partial u_z}{\\partial z} = 0$ 的条件下，非线性对流加速度项 $\\mathbf{u}\\cdot\\nabla \\mathbf{u}$ 消失。Navier-Stokes 动量方程的轴向分量简化为：\n$$\n\\rho \\frac{\\partial u_z}{\\partial t} = -\\frac{\\partial p}{\\partial z} + \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_z}{\\partial r}\\right) \\right]\n$$\n这个方程描述了局部（非定常）流体惯性、驱动压力梯度和径向粘性扩散之间的平衡。压力梯度 $-\\frac{\\partial p}{\\partial z}$ 是驱动力，并假定为时间的谐波函数，但其具体形式对于标度分析不是必需的。\n\n我们现在对涉及速度 $u_z$ 的项进行标度分析。目标是比较非定常惯性项与粘性扩散项的大小。\n让我们为变量引入特征尺度：\n-   特征径向长度尺度：$r \\sim R$（动脉半径）。\n-   特征时间尺度：$t \\sim T = \\frac{1}{\\omega}$，其中 $\\omega$ 是脉动的角频率。\n-   特征轴向速度尺度：$u_z \\sim U$。\n\n非定常惯性项的大小估计为：\n$$\n\\left| \\rho \\frac{\\partial u_z}{\\partial t} \\right| \\sim \\rho \\frac{U}{T} = \\rho U \\omega\n$$\n粘性扩散项的大小估计为：\n$$\n\\left| \\mu \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_z}{\\partial r}\\right) \\right] \\right| \\sim \\mu \\frac{U}{R^2}\n$$\n该问题将参数 $\\alpha$ 的平方定义为非定常惯性与粘性扩散的无量纲比。\n$$\n\\alpha^2 = \\frac{\\text{非定常惯性大小}}{\\text{粘性扩散大小}} \\sim \\frac{\\rho U \\omega}{\\mu U/R^2}\n$$\n特征速度尺度 $U$ 被约去，得到 $\\alpha^2$ 的表达式：\n$$\n\\alpha^2 = \\frac{\\rho \\omega R^2}{\\mu}\n$$\n由此，我们推导出 $\\alpha$ 的表达式，即 Womersley 数：\n$$\n\\alpha = R \\sqrt{\\frac{\\rho \\omega}{\\mu}}\n$$\n接下来，我们使用给定的生理学值计算 $\\alpha$。\n首先，将所有单位转换为国际单位制（SI）基本单位。\n-   半径：$R = 2\\,\\mathrm{mm} = 2 \\times 10^{-3}\\,\\mathrm{m}$。\n-   密度：$\\rho = 1060\\,\\mathrm{kg/m^3}$。\n-   心率：$f = 1.2\\,\\mathrm{Hz}$。\n-   动力粘度：$\\mu = 3.5\\,\\mathrm{cP}$。使用换算关系 $1\\,\\mathrm{cP} = 10^{-3}\\,\\mathrm{Pa\\cdot s}$，我们得到 $\\mu = 3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$。\n\n角频率 $\\omega$ 由心率 $f$ 计算得出：\n$$\n\\omega = 2\\pi f = 2\\pi (1.2\\,\\mathrm{Hz}) = 2.4\\pi\\,\\mathrm{rad/s}\n$$\n现在，将这些值代入 $\\alpha^2$ 的表达式中：\n$$\n\\alpha^2 = \\frac{\\rho \\omega R^2}{\\mu} = \\frac{(1060\\,\\mathrm{kg/m^3}) (2.4\\pi\\,\\mathrm{s}^{-1}) (2 \\times 10^{-3}\\,\\mathrm{m})^2}{3.5 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}}\n$$\n$$\n\\alpha^2 = \\frac{1060 \\times 2.4\\pi \\times (4 \\times 10^{-6})}{3.5 \\times 10^{-3}} = \\frac{10176\\pi \\times 10^{-6}}{3.5 \\times 10^{-3}} = \\frac{10176\\pi}{3.5} \\times 10^{-3}\n$$\n$$\n\\alpha^2 \\approx 9134.04 \\times 10^{-3} \\approx 9.13404\n$$\n取平方根求得 $\\alpha$：\n$$\n\\alpha = \\sqrt{9.13404} \\approx 3.022258\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\alpha \\approx 3.022\n$$\n最后，我们必须根据这个值来论证速度剖面的形状。Womersley 数 $\\alpha$ 在物理上表示动脉半径 $R$ 与粘性穿透深度 $\\delta_v = \\sqrt{\\mu / (\\rho\\omega)}$ 的比值，后者是粘性效应在一个振荡周期内扩散到流体中的特征距离。\n-   如果 $\\alpha \\ll 1$，则粘性力占主导地位。流动足够慢，以至于在一个周期内粘性效应可以扩散到整个管半径。速度剖面有时间适应变化的压力梯度，从而在每个瞬间都呈现出抛物线形状，很像稳态 Poiseuille 流。这种状态称为**准稳态**。\n-   如果 $\\alpha \\gg 1$，则非定常惯性占主导地位。粘性效应被限制在靠近管壁的薄边界层内（厚度约为 $\\sim \\delta_v$）。远离管壁的核心流体表现得几乎无粘性，并像一个整体或“栓塞”一样加速和减速。这导致动脉中心区域出现平坦的、**栓塞状**的速度剖面，而在靠近管壁处则有陡峭的速度梯度。\n\n对于计算出的值 $\\alpha \\approx 3.022$，我们有 $\\alpha > 1$。这表明在大部分流动中，非定常惯性力比粘性力更显著。粘性穿透深度为 $\\delta_v = R/\\alpha \\approx (2\\,\\mathrm{mm})/3.022 \\approx 0.66\\,\\mathrm{mm}$，这远小于 2 mm 的半径。虽然流动不处于 $\\alpha \\gg 1$ 的极端情况，但剖面已明显地从抛物线形状变得平钝。因此，瞬时轴向速度剖面更接近于栓塞状剖面，而不是准稳态抛物线剖面。",
            "answer": "$$\n\\boxed{3.022}\n$$"
        },
        {
            "introduction": "当流体与柔性结构（如血液与动脉壁）相互作用时，会产生新的挑战，尤其是在数值模拟中。本实践将探讨“附加质量”效应，即加速的流体有效地为结构增加了惯性。您将分析一个简化模型，以理解这种物理现象如何在常见的流固耦合（FSI）模拟方案中导致数值不稳定性，并学习如何估算最大稳定时间步长。",
            "id": "4165045",
            "problem": "一个动脉段被建模为一个薄壁、轴对称、线性弹性的圆柱形膜，其内半径为 $R$，壁厚为 $h$，内部含有密度为 $\\rho_{f}$ 的无粘、不可压缩流体。壁的密度为 $\\rho_{s}$，壁的杨氏模量为 $E$。假设沿轴向存在小的、空间均匀的径向位移 $\\eta(t)$（长波极限），轴向应力可忽略不计，且无粘性效应。考虑一个松耦合、交错分区的流固耦合（FSI）方案，其中流体和结构被显式推进，且界面牵引力滞后一个时间层级。\n\n从壁的牛顿第二定律和通过流体动能定义的附加质量出发，证明单位内壁面积的有效流体附加质量由呼吸运动期间径向流体速度的柱塞流近似确定。使用薄壁线性膜理论中，小环向应变下圆柱体的压力与径向位移之间的关系，来获得单位内壁面积的有效线性刚度。将无量纲附加质量比定义为单位面积的流体附加质量与单位面积的结构质量之比，并通过要求具有有效质量的无阻尼离散结构振子的稳定性，来估计交错显式方案的最大稳定时间步长。\n\n给定以下参数：\n- 内半径 $R = 2.5 \\times 10^{-3}$ m\n- 壁厚 $h = 8.0 \\times 10^{-4}$ m\n- 壁密度 $\\rho_{s} = 1.20 \\times 10^{3}$ kg/m$^{3}$\n- 流体密度 $\\rho_{f} = 1.06 \\times 10^{3}$ kg/m$^{3}$\n- 杨氏模量 $E = 6.0 \\times 10^{5}$ Pa\n\n计算：\n1. 无量纲附加质量比 $\\mathcal{A}$。\n2. 交错显式方案的估计最大稳定时间步长 $\\Delta t_{\\max}$，以秒为单位表示。\n\n将两个量均四舍五入至四位有效数字。时间步长以秒表示，并以两个数字的形式提供最终答案。",
            "solution": "该问题要求推导一个简化的动脉流固耦合（FSI）模型的参数，并随后计算一个数值方案的稳定性极限。我们将系统地处理每个部分。\n\n首先，我们定义单位内壁面积的系统质量属性。壁是一个内半径为 $R$、厚度为 $h$、密度为 $\\rho_s$ 的圆柱壳。单位内壁面积的结构质量 $m_s$ 是壁的质量除以内表面积。假设 $h \\ll R$，长度为 $L$ 的一段的体积约等于内表面积 $2\\pi R L$ 乘以厚度 $h$。\n$$m_s = \\frac{\\text{质量}}{\\text{面积}} = \\frac{\\rho_s (\\text{体积})}{2\\pi R L} = \\frac{\\rho_s (2\\pi R L h)}{2\\pi R L} = \\rho_s h$$\n\n接着，我们推导单位内壁面积的有效流体附加质量 $m_a$。问题指定使用通过流体动能 $T_f$ 定义的附加质量。壁的径向位移是 $\\eta(t)$，所以其速度是 $\\dot{\\eta}(t)$。问题指示我们使用“径向流体速度的柱塞流近似”，这意味着流体的径向速度 $u_r$ 在整个流体横截面上是均匀的，并且等于壁速：$u_r(r,t) = \\dot{\\eta}(t)$ 对于 $0 \\le r \\le R$。\n\n长度为 $L$ 的一段中流体的动能通过对流体体积进行积分得到：\n$$T_f = \\frac{1}{2} \\int_{V} \\rho_f u_r^2 dV = \\frac{1}{2} \\int_0^L \\int_0^R \\rho_f (\\dot{\\eta}(t))^2 (2\\pi r) dr dz$$\n$$T_f = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 (2\\pi L) \\int_0^R r dr = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 (2\\pi L) \\left[\\frac{r^2}{2}\\right]_0^R = \\frac{1}{2} \\rho_f (\\dot{\\eta}(t))^2 \\pi R^2 L$$\n动能也可以用总附加质量 $M_a$ 来表示为 $T_f = \\frac{1}{2} M_a (\\dot{\\eta}(t))^2$。比较这两个表达式可得出总附加质量：\n$$M_a = \\rho_f \\pi R^2 L$$\n单位内壁面积的附加质量 $m_a$ 是这个总质量除以内壁面积 $A_{wall} = 2\\pi R L$：\n$$m_a = \\frac{M_a}{A_{wall}} = \\frac{\\rho_f \\pi R^2 L}{2\\pi R L} = \\frac{\\rho_f R}{2}$$\n\n无量纲附加质量比 $\\mathcal{A}$ 定义为单位面积的流体附加质量与单位面积的结构质量之比：\n$$\\mathcal{A} = \\frac{m_a}{m_s} = \\frac{\\rho_f R / 2}{\\rho_s h} = \\frac{\\rho_f R}{2 \\rho_s h}$$\n\n接下来，我们求单位内壁面积的有效线性刚度 $k_{eff}$。问题指示我们使用薄壁线性膜关系。对于薄壁圆柱体，由内压 $p$ 引起的环向应力 $\\sigma_{\\theta}$ 由拉普拉斯定律（Laplace's law）给出：\n$$\\sigma_{\\theta} = \\frac{pR}{h}$$\n环向应变 $\\epsilon_{\\theta}$ 是周长的变化量除以原始周长，对于一个小的径向位移 $\\eta$ 来说，即为：\n$$\\epsilon_{\\theta} = \\frac{2\\pi(R+\\eta) - 2\\pi R}{2\\pi R} = \\frac{\\eta}{R}$$\n对于杨氏模量为 $E$ 且轴向应力可忽略的线性弹性材料，应力-应变关系为 $\\sigma_{\\theta} = E \\epsilon_{\\theta}$。结合这三个方程：\n$$\\frac{pR}{h} = E \\frac{\\eta}{R} \\implies p = \\frac{Eh}{R^2} \\eta$$\n单位面积的刚度 $k_{eff}$ 是单位位移所需的压力（单位面积的力）。因此，\n$$k_{eff} = \\frac{p}{\\eta} = \\frac{Eh}{R^2}$$\n\n问题要求通过考虑“具有有效质量的无阻尼离散结构振子”的稳定性来估计最大稳定时间步长 $\\Delta t_{\\max}$。该指令意味着我们应该将系统建模为一个简谐振子，其中总惯性是结构质量和流体附加质量之和。单位面积的有效质量为：\n$$m_{eff} = m_s + m_a = \\rho_s h + \\frac{\\rho_f R}{2}$$\n这个有效振子的运动方程为 $m_{eff} \\ddot{\\eta} + k_{eff} \\eta = 0$。该系统的固有角频率 $\\omega_0$ 为：\n$$\\omega_0 = \\sqrt{\\frac{k_{eff}}{m_{eff}}} = \\sqrt{\\frac{Eh/R^2}{\\rho_s h + \\rho_f R/2}}$$\n对于一个显式时间积分方案，例如中心差分法，这个二阶常微分方程的数值解是稳定的，如果时间步长 $\\Delta t$ 满足条件 $\\Delta t \\le 2/\\omega_0$。这是显式方案的一个标准结果，并提供了所需的估计。\n$$\\Delta t_{\\max} = \\frac{2}{\\omega_0} = 2 \\sqrt{\\frac{m_{eff}}{k_{eff}}} = 2 \\sqrt{\\frac{\\rho_s h + \\rho_f R/2}{Eh/R^2}}$$\n\n现在我们代入给定的数值：\n$R = 2.5 \\times 10^{-3}$ m\n$h = 8.0 \\times 10^{-4}$ m\n$\\rho_s = 1.20 \\times 10^{3}$ kg/m$^3$\n$\\rho_f = 1.06 \\times 10^{3}$ kg/m$^3$\n$E = 6.0 \\times 10^{5}$ Pa\n\n首先，我们计算单位面积的质量：\n$m_s = \\rho_s h = (1.20 \\times 10^3 \\, \\text{kg/m}^3) \\times (8.0 \\times 10^{-4} \\, \\text{m}) = 0.96 \\, \\text{kg/m}^2$\n$m_a = \\frac{\\rho_f R}{2} = \\frac{(1.06 \\times 10^3 \\, \\text{kg/m}^3) \\times (2.5 \\times 10^{-3} \\, \\text{m})}{2} = 1.325 \\, \\text{kg/m}^2$\n\n1.  计算无量纲附加质量比 $\\mathcal{A}$：\n$$\\mathcal{A} = \\frac{m_a}{m_s} = \\frac{1.325}{0.96} = 1.380208...$$\n四舍五入到四位有效数字，$\\mathcal{A} = 1.380$。\n\n2.  计算最大稳定时间步长 $\\Delta t_{\\max}$：\n首先，计算有效质量和刚度：\n$m_{eff} = m_s + m_a = 0.96 + 1.325 = 2.285 \\, \\text{kg/m}^2$\n$k_{eff} = \\frac{Eh}{R^2} = \\frac{(6.0 \\times 10^5 \\, \\text{Pa}) \\times (8.0 \\times 10^{-4} \\, \\text{m})}{(2.5 \\times 10^{-3} \\, \\text{m})^2} = \\frac{480}{6.25 \\times 10^{-6}} = 7.68 \\times 10^7 \\, \\text{Pa/m}$\n现在，计算时间步长：\n$$\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_{eff}}{k_{eff}}} = 2 \\sqrt{\\frac{2.285}{7.68 \\times 10^7}} \\approx 2 \\sqrt{2.97526 \\times 10^{-8}} \\approx 2 \\times (1.72495 \\times 10^{-4})$$\n$$\\Delta t_{\\max} \\approx 3.4499 \\times 10^{-4} \\, \\text{s}$$\n四舍五入到四位有效数字，$\\Delta t_{\\max} = 3.450 \\times 10^{-4}$ s。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.380 & 3.450 \\times 10^{-4} \\end{pmatrix}}$$"
        },
        {
            "introduction": "许多血液动力学模拟的最终目标是评估血管疾病的风险。这需要将原始的流体动力学数据（如壁面切应力）转化为具有生物学意义的指标。本练习将指导您完成对模拟的壁面切应力信号进行后处理的过程，以计算如时间平均壁面切应力（TAWSS）、振荡剪切指数（OSI）和相对停留时间（RRT）等关键指标，这些指标与内皮细胞功能和疾病进展直接相关。",
            "id": "4165050",
            "problem": "给定一个在动脉瘤顶部的模拟带符号标量时间序列，表示切向壁面剪切应力，记为 $ \\tau_{w}(t) $，其物理单位为帕斯卡（$ \\mathrm{Pa} $）。该时间序列代表了壁面剪切应力矢量在一个固定切线方向上的投影。本任务的目的是通过计算在持续时间为 $ T $ 的有限观测窗口内的时间平均壁面剪切应力、振荡剪切指数和相对停留时间，来量化与内皮功能相关的血液动力学描述符。\n\n从时间平均作为有限区间上积分的基本定义出发，并利用 $ \\tau_{w}(t) $ 的符号变化可以表示壁面牵引力方向反转这一概念，推导以下各项的表达式：\n- 在 $ [0,T] $ 上的时间平均壁面剪切应力大小，\n- 一个无量纲的振荡指数，用于比较时间平均的有符号剪切应力的大小与剪切应力大小的时间平均值，以及\n- 一个相对停留时间，其定义为时间平均壁面剪切应力与方向稳定性因子的乘积的倒数。\n\n然后，实现一个数值方法，该方法在均匀时间间隔的离散样本 $ \\{ t_{k}, \\tau_{w}(t_{k}) \\}_{k=0}^{N} $ 上使用梯形法则来近似计算所有所需的时间积分。在整个计算过程中，将 $ \\tau_{w}(t) $ 视为带符号的标量。如果方向稳定性因子由于振荡而在数值上变为非正值（即，如果因子 $ 1 - 2\\,\\mathrm{OSI} $ 与 $ 0 $ 的差在 $ 10^{-12} $ 的容差范围内或为负值），则将相对停留时间返回为数学上的无穷大。\n\n您的程序必须从以下参数化形式构建每个测试时间序列：\n$$\n\\tau_{w}(t) = b + a \\sin(2\\pi f t),\n$$\n并以 $ t_{k} = k\\,\\Delta t $ 的形式进行均匀采样，其中 $ k = 0, 1, \\dots, N $，$ \\Delta t = 1/f_{s} $ 且 $ N = \\lfloor T_{\\mathrm{end}} f_{s} \\rfloor $。对于每个测试用例，计算：\n- 时间平均壁面剪切应力 $ \\mathrm{TAWSS} $，单位为 $ \\mathrm{Pa} $，\n- 振荡剪切指数 $ \\mathrm{OSI} $，为无单位的十进制小数，\n- 相对停留时间 $ \\mathrm{RRT} $，单位为 $ \\mathrm{Pa}^{-1} $。\n\n用 $ \\mathrm{Pa} $ 表示 $ \\mathrm{TAWSS} $，用十进制小数（不带百分号）表示 $ \\mathrm{OSI} $，用 $ \\mathrm{Pa}^{-1} $ 表示 $ \\mathrm{RRT} $。在数值报告中，将每个标量指标四舍五入到 $ 6 $ 位小数。\n\n测试套件：\n使用以下四个参数集生成时间序列：\n- A案例（主要为单向脉动剪切；理想路径）：$ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $，$ f_{s} = 1000\\,\\mathrm{Hz} $，$ f = 1.0\\,\\mathrm{Hz} $，$ b = 1.0\\,\\mathrm{Pa} $，$ a = 0.8\\,\\mathrm{Pa} $。\n- B案例（有偏置的振荡并伴随方向反转）：$ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $，$ f_{s} = 1000\\,\\mathrm{Hz} $，$ f = 1.0\\,\\mathrm{Hz} $，$ b = 0.2\\,\\mathrm{Pa} $，$ a = 0.5\\,\\mathrm{Pa} $。\n- C案例（具有轻微偏置和非整数周期的近对称振荡；探讨近奇异分母情况）：$ T_{\\mathrm{end}} = 1.1\\,\\mathrm{s} $，$ f_{s} = 1000\\,\\mathrm{Hz} $，$ f = 1.0\\,\\mathrm{Hz} $，$ b = 0.01\\,\\mathrm{Pa} $，$ a = 0.5\\,\\mathrm{Pa} $。\n- D案例（应力极小但振荡强烈且周期非整数；大相对停留时间的边缘案例）：$ T_{\\mathrm{end}} = 1.3\\,\\mathrm{s} $，$ f_{s} = 2000\\,\\mathrm{Hz} $，$ f = 1.7\\,\\mathrm{Hz} $，$ b = 0.001\\,\\mathrm{Pa} $，$ a = 0.0015\\,\\mathrm{Pa} $。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例按顺序提供一个列表 $ [\\mathrm{TAWSS}, \\mathrm{OSI}, \\mathrm{RRT}] $，其中每个值都四舍五入到 $ 6 $ 位小数。因此，总输出必须是按 $ \\mathrm{A} $, $ \\mathrm{B} $, $ \\mathrm{C} $, $ \\mathrm{D} $ 顺序排列的列表的列表。例如，打印的输出必须具有精确的列表的列表结构，如 $ [[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],[x_{3},y_{3},z_{3}],[x_{4},y_{4},z_{4}]] $，且不含任何附加文本。",
            "solution": "我们从第一性原理出发，将壁面剪切应力定义为流固界面处的切向牵引力。设 $ \\boldsymbol{\\tau}_{w}(t) $ 为壁面剪切应力矢量。在当前的一维投影中，我们考虑其在固定单位切向量上的带符号标量投影 $ \\tau_{w}(t) $，因此近壁流动的反转对应于 $ \\tau_{w}(t) $ 符号的改变。设观测区间为 $ [0,T] $。\n\n时间平均壁面剪切应力大小：根据函数 $ g(t) $ 在 $ [0,T] $ 上的时间平均定义，\n$$\n\\langle g \\rangle = \\frac{1}{T}\\int_{0}^{T} g(t)\\, dt.\n$$\n为量化内皮细胞所承受的平均力学刺激，我们使用剪切应力的大小，因此时间平均壁面剪切应力为\n$$\n\\mathrm{TAWSS} = \\frac{1}{T} \\int_{0}^{T} \\left| \\tau_{w}(t) \\right| \\, dt,\n$$\n单位为 $ \\mathrm{Pa} $。\n\n振荡剪切指数：方向性振荡是通过比较时间平均的有符号牵引力的大小与其大小的时间平均值来捕捉的。我们将有符号剪切应力的时间积分记为\n$$\nI_{s} = \\int_{0}^{T} \\tau_{w}(t)\\, dt,\n$$\n并将其大小的时间积分记为\n$$\nI_{m} = \\int_{0}^{T} \\left| \\tau_{w}(t) \\right| \\, dt.\n$$\n一个常用的无量纲描述符，它将单向流映射到 $ 0 $，将最大振荡（完全反转）流映射到 $ \\tfrac{1}{2} $，其定义为\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left( 1 - \\frac{ \\left| I_{s} \\right| }{ I_{m} } \\right),\n$$\n其中 $ \\left| \\cdot \\right| $ 表示绝对值。对于纯单向剪切，即所有 $ t $ 都有 $ \\tau_{w}(t) \\ge 0 $，此时 $ I_{s} = I_{m} $ 且 $ \\mathrm{OSI} = 0 $。对于在整数个周期内均值为零的完全对称振荡，此时 $ I_{s} = 0 $ 且 $ \\mathrm{OSI} = \\tfrac{1}{2} $。\n\n相对停留时间：当 $ \\mathrm{TAWSS} $ 较小且振荡较强时，血液动力学停留时间增加。一个常用的描述符是 $ \\mathrm{TAWSS} $ 与方向稳定性因子 $ 1 - 2\\,\\mathrm{OSI} $ 乘积的倒数，即\n$$\n\\mathrm{RRT} = \\frac{1}{ \\mathrm{TAWSS} \\left( 1 - 2\\,\\mathrm{OSI} \\right) }.\n$$\n由于 $ \\mathrm{OSI} $ 是无量纲的，其单位为 $ \\mathrm{Pa}^{-1} $。如果 $ \\mathrm{OSI} \\to \\tfrac{1}{2} $ 且 $ \\mathrm{TAWSS} $ 是有限的，则 $ \\mathrm{RRT} \\to \\infty $。\n\n数值近似：输入是均匀间隔 $ \\Delta t = t_{k+1} - t_{k} $ 的离散样本 $ \\{ t_{k}, \\tau_{w}(t_{k}) \\}_{k=0}^{N} $，其中 $ t_{0} = 0 $，$ t_{N} = T $。使用梯形法则近似积分，\n$$\n\\int_{0}^{T} \\phi(t)\\, dt \\approx \\sum_{k=0}^{N-1} \\frac{ \\phi(t_{k}) + \\phi(t_{k+1}) }{2}\\, \\Delta t = \\mathrm{trapz}\\left( \\phi(t_{k}), t_{k} \\right),\n$$\n我们计算\n$$\nI_{m} \\approx \\mathrm{trapz}\\left( \\left| \\tau_{w}(t_{k}) \\right|, t_{k} \\right), \\quad I_{s} \\approx \\mathrm{trapz}\\left( \\tau_{w}(t_{k}), t_{k} \\right),\n$$\n$$\n\\mathrm{TAWSS} \\approx \\frac{ I_{m} }{ T }, \\quad \\mathrm{OSI} \\approx \\frac{1}{2}\\left( 1 - \\frac{ \\left| I_{s} \\right| }{ I_{m} } \\right),\n$$\n然后\n$$\n\\mathrm{RRT} \\approx \\frac{1}{ \\mathrm{TAWSS}\\, \\left( 1 - 2\\,\\mathrm{OSI} \\right) }.\n$$\n为保持数值稳健性，如果 $ 1 - 2\\,\\mathrm{OSI} \\le 10^{-12} $，我们返回 $ \\mathrm{RRT} = \\infty $。\n\n测试序列的构建：每个测试序列由以下公式定义\n$$\n\\tau_{w}(t) = b + a \\sin( 2\\pi f t ), \\quad t = 0, \\Delta t, 2\\Delta t, \\dots, T_{\\mathrm{end}},\n$$\n其中 $ \\Delta t = 1/f_{s} $，$ f_{s} $ 是采样频率。四个案例如下：\n- A案例：$ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $，$ f_{s} = 1000\\,\\mathrm{Hz} $，$ f = 1.0\\,\\mathrm{Hz} $，$ b = 1.0\\,\\mathrm{Pa} $，$ a = 0.8\\,\\mathrm{Pa} $。此处 $ \\tau_{w}(t) \\ge 0 $，因此我们预期 $ \\mathrm{OSI} \\approx 0 $ 且 $ \\mathrm{TAWSS} \\approx b = 1.0\\,\\mathrm{Pa} $，从而得到 $ \\mathrm{RRT} \\approx 1.0\\,\\mathrm{Pa}^{-1} $。\n- B案例：$ T_{\\mathrm{end}} = 1.0\\,\\mathrm{s} $，$ f_{s} = 1000\\,\\mathrm{Hz} $，$ f = 1.0\\,\\mathrm{Hz} $，$ b = 0.2\\,\\mathrm{Pa} $，$ a = 0.5\\,\\mathrm{Pa} $。存在流动反转；$ \\mathrm{OSI} $ 处于中间值，与平均大小相比 $ \\mathrm{TAWSS} $ 减小，而 $ \\mathrm{RRT} $ 升高。\n- C案例：$ T_{\\mathrm{end}} = 1.1\\,\\mathrm{s} $，$ f_{s} = 1000\\,\\mathrm{Hz} $，$ f = 1.0\\,\\mathrm{Hz} $，$ b = 0.01\\,\\mathrm{Pa} $，$ a = 0.5\\,\\mathrm{Pa} $。在非整数个周期内的近对称振荡会产生接近但不完全等于 $ 0.5 $ 的 $ \\mathrm{OSI} $，从而导致大但有限的 $ \\mathrm{RRT} $。\n- D案例：$ T_{\\mathrm{end}} = 1.3\\,\\mathrm{s} $，$ f_{s} = 2000\\,\\mathrm{Hz} $，$ f = 1.7\\,\\mathrm{Hz} $，$ b = 0.001\\,\\mathrm{Pa} $，$ a = 0.0015\\,\\mathrm{Pa} $。极小的幅值和强烈的振荡导致了小的 $ \\mathrm{TAWSS} $ 和大的 $ \\mathrm{RRT} $。\n\n算法步骤：\n- 对每个案例，生成均匀时间网格 $ t_{k} $ 和序列 $ \\tau_{w}(t_{k}) $。\n- 计算 $ T = t_{N} - t_{0} $。\n- 使用梯形法则计算 $ I_{m} $ 和 $ I_{s} $，然后根据针对接近零的 $ 1 - 2\\,\\mathrm{OSI} $ 的稳健性规则计算 $ \\mathrm{TAWSS} $、$ \\mathrm{OSI} $ 和 $ \\mathrm{RRT} $。\n- 将每个值四舍五入到 $ 6 $ 位小数，并按规定顺序生成列表的列表。\n\n关于内皮功能障碍的解释：低 $ \\mathrm{TAWSS} $ 和高 $ \\mathrm{OSI} $ 已被认为与动脉瘤中的内皮功能障碍有关，原因是受损的一氧化氮信号传导、促炎状态和血栓形成潜力。$ \\mathrm{RRT} $ 综合了这些效应；高 $ \\mathrm{RRT} $ 表明颗粒在壁面附近的停留时间延长。因此：\n- A案例（高 $ \\mathrm{TAWSS} $，低 $ \\mathrm{OSI} $）表明一个相对具有保护性的状态，其 $ \\mathrm{RRT} $ 较低。\n- B和C案例显示振荡增加且有效剪切减少，导致 $ \\mathrm{RRT} $ 升高，表明内皮功能障碍的倾向性更大。\n- D案例的 $ \\mathrm{TAWSS} $ 极小但振荡强烈，导致极大的 $ \\mathrm{RRT} $，表明这是一个非常不利的血液动力学环境。\n\n最终的程序实现了这些步骤，并以所需的格式 $ [[\\mathrm{TAWSS}_{A},\\mathrm{OSI}_{A},\\mathrm{RRT}_{A}],\\dots,[\\mathrm{TAWSS}_{D},\\mathrm{OSI}_{D},\\mathrm{RRT}_{D}]] $ 打印单行输出，其中每个标量都四舍五入到 $ 6 $ 位小数，并使用指定的单位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_metrics(time, tau):\n    \"\"\"\n    Compute TAWSS, OSI, and RRT from a signed wall shear stress time series.\n    - time: 1D numpy array of times [s]\n    - tau: 1D numpy array of signed wall shear stress [Pa]\n    Returns: (TAWSS [Pa], OSI [-], RRT [Pa^-1])\n    \"\"\"\n    # Ensure inputs are numpy arrays and sorted by time\n    t = np.asarray(time, dtype=float)\n    wss = np.asarray(tau, dtype=float)\n    # Duration\n    T = t[-1] - t[0]\n    # Integrals via trapezoidal rule\n    Im = np.trapz(np.abs(wss), t)  # integral of magnitude\n    Is = np.trapz(wss, t)          # integral of signed\n    # TAWSS\n    tawss = Im / T if T > 0 else np.nan\n    # OSI\n    # Guard against Im == 0\n    if Im == 0:\n        osi = 0.5  # if no shear magnitude, define as maximally oscillatory\n    else:\n        osi = 0.5 * (1.0 - np.abs(Is) / Im)\n    # RRT\n    denom = tawss * (1.0 - 2.0 * osi)\n    # Numerical robustness: treat near-zero or negative as infinity\n    if denom = 1e-12:\n        rrt = float('inf')\n    else:\n        rrt = 1.0 / denom\n    return tawss, osi, rrt\n\ndef generate_time_series(T_end, fs, f, b, a):\n    \"\"\"\n    Generate time array and tau_w(t) = b + a*sin(2*pi*f*t)\n    - T_end [s], fs [Hz], f [Hz], b [Pa], a [Pa]\n    Returns: time array, tau array\n    \"\"\"\n    # Number of intervals Nint = T_end * fs; number of samples N = Nint + 1\n    Nint = int(round(T_end * fs))\n    N = Nint + 1\n    t = np.linspace(0.0, T_end, N, endpoint=True)\n    tau = b + a * np.sin(2.0 * np.pi * f * t)\n    return t, tau\n\ndef rounded_list(values, ndp=6):\n    \"\"\"Round a tuple of floats to ndp decimals; handle inf appropriately.\"\"\"\n    out = []\n    for v in values:\n        if np.isinf(v):\n            out.append('inf')\n        else:\n            out.append(f\"{v:.{ndp}f}\")\n    return out\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (T_end [s], fs [Hz], f [Hz], b [Pa], a [Pa])\n    test_cases = [\n        (1.0, 1000.0, 1.0, 1.0, 0.8),       # Case A\n        (1.0, 1000.0, 1.0, 0.2, 0.5),       # Case B\n        (1.1, 1000.0, 1.0, 0.01, 0.5),      # Case C\n        (1.3, 2000.0, 1.7, 0.001, 0.0015),  # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        T_end, fs, f, b, a = case\n        t, tau = generate_time_series(T_end, fs, f, b, a)\n        tawss, osi, rrt = compute_metrics(t, tau)\n        # Round to 6 decimals as strings; maintain required format\n        r_tawss, r_osi, r_rrt = rounded_list((tawss, osi, rrt), ndp=6)\n        results.append([r_tawss, r_osi, r_rrt])\n\n    # Final print statement in the exact required format: list-of-lists with numbers as strings.\n    # Convert nested list to the prescribed single-line format.\n    # Since we represented numbers as strings (to control formatting), we must join appropriately.\n    # Compose manually to avoid quotes.\n    formatted_cases = []\n    for case in results:\n        formatted_case = \"[\" + \",\".join(case) + \"]\"\n        formatted_cases.append(formatted_case)\n    print(f\"[{','.join(formatted_cases)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}