{
    "hands_on_practices": [
        {
            "introduction": "这项练习为建立微观结构启发的模型奠定了理论基础。我们将探索如何将微观纤维结构的描述——由取向分布函数（orientation distribution function, ODF）表示——转化为宏观力学属性，即有效刚度张量 $\\mathbb{C}$。通过在线性弹性的框架下完成此推导，您将掌握使用取向平均进行均匀化的基本过程，这是开发和理解更复杂本构模型的关键技能。",
            "id": "4191270",
            "problem": "考虑一个嵌入线性各向同性基质中的具有正交各向异性纤维结构的纤维软组织，该组织在仿射纤维运动学的小应变运动学假设下进行建模。设各向同性基质由 Lamé 模量 $\\lambda$ 和 $\\mu$ 表征，因此基质的应变能密度为 $W_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon}$ 是小应变张量。假设纤维是线弹性的，仅沿其局部方向承载拉伸刚度，其纵向模量为 $E_{\\mathrm{f}}$，总体纤维体积分数为 $\\varphi$。在稀疏/仿射假设下，纤维对应变能密度的贡献是取向平均值\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}\\right)^{2}\\right\\rangle,\n$$\n其中 $k_{\\mathrm{f}} = \\varphi E_{\\mathrm{f}}$，$\\mathbf{n}$ 是单位球面上的单位向量，$\\langle\\cdot\\rangle$ 表示关于单位球面上的取向分布函数 (ODF) $\\rho(\\mathbf{n})$ 的平均，且 $\\int_{S^{2}}\\rho(\\mathbf{n})\\,\\mathrm{d}\\Omega = 1$。假设 ODF 是正交各向异性的，由与标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 对齐的六个对称离散方向组成：\n$$\n\\rho(\\mathbf{n}) \\;=\\; \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big],\n$$\n其中非负权重 $w_{p}\\ge 0$ 满足 $\\sum_{p=1}^{3} w_{p} = 1$，$\\delta(\\cdot)$ 是单位球面上的 Dirac delta 分布。\n\n从二阶和四阶取向张量（矩）的定义出发，\n$$\n\\mathbf{A} \\;=\\; \\left\\langle \\mathbf{n}\\otimes\\mathbf{n}\\right\\rangle, \\qquad \\mathbb{A}^{(4)} \\;=\\; \\left\\langle \\mathbf{n}\\otimes\\mathbf{n}\\otimes\\mathbf{n}\\otimes\\mathbf{n}\\right\\rangle,\n$$\n通过叠加基质和纤维的能量，推导有效的联系 Cauchy 应力 $\\boldsymbol{\\sigma}$ 和应变 $\\boldsymbol{\\varepsilon}$ 的小应变正交各向异性刚度张量 $\\mathbb{C}$，其关系为 $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}$。用 Kronecker delta $\\delta_{ij}$、基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$、权重 $w_{1},w_{2},w_{3}$以及模量 $\\lambda$、$\\mu$ 和 $k_{\\mathrm{f}}$，以分量形式 $\\mathbb{C}_{ijkl}$ 显式地表示 $\\mathbb{C}$。您的推导必须从给定的能量定义和 ODF 矩出发。\n\n以索引表示法，将您的最终答案表示为 $\\mathbb{C}_{ijkl}$ 的单个闭式解析表达式。不需要进行数值计算。最终答案中不要包含物理单位。",
            "solution": "该问题具有科学依据，提法恰当，客观，并包含了获得唯一解所需的所有信息。所提出的模型是纤维增强软组织微观力学中的一个标准公式。因此，该问题是有效的，我们可以继续进行推导。\n\n复合材料的总应变能密度 $W$ 由各向同性基质的应变能 $W_{\\mathrm{m}}$ 和嵌入纤维的应变能 $W_{\\mathrm{f}}$ 叠加而成。\n$$\nW = W_{\\mathrm{m}} + W_{\\mathrm{f}}\n$$\n问题给出了这些能量贡献的表达式。基质能量为：\n$$\nW_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}\n$$\n在索引表示法中，其中 $\\boldsymbol{\\varepsilon}$ 是分量为 $\\varepsilon_{ij}$ 的小应变张量，这可以写为：\n$$\nW_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\varepsilon_{kk}\\right)^{2} + \\mu\\,\\varepsilon_{ij}\\varepsilon_{ij}\n$$\n纤维能量的贡献由取向平均值给出：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}\\right)^{2}\\right\\rangle\n$$\n在索引表示法中，平均值内的项是 $(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}) = n_i \\varepsilon_{ij} n_j$。因此，纤维能量为：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(n_i \\varepsilon_{ij} n_j\\right)\\left(n_k \\varepsilon_{kl} n_l\\right) \\right\\rangle\n$$\n由于应变张量 $\\boldsymbol{\\varepsilon}$ 不依赖于取向向量 $\\mathbf{n}$，其分量可以移到平均算子之外：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle n_i n_j n_k n_l \\right\\rangle \\varepsilon_{ij} \\varepsilon_{kl}\n$$\n根据定义，项 $\\left\\langle n_i n_j n_k n_l \\right\\rangle$ 是四阶取向张量 $\\mathbb{A}^{(4)}_{ijkl}$ 的分量形式。\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\left\\langle n_i n_j n_k n_l \\right\\rangle = \\int_{S^{2}} n_i n_j n_k n_l \\rho(\\mathbf{n}) \\,\\mathrm{d}\\Omega\n$$\n因此，纤维能量可以紧凑地表示为：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\, \\mathbb{A}^{(4)}_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\n总应变能密度是其和：\n$$\nW(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\left(\\varepsilon_{kk}\\right)^{2} + \\mu\\,\\varepsilon_{ij}\\varepsilon_{ij} + \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\, \\mathbb{A}^{(4)}_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\n对于小应变下的超弹性材料，Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 是应变能密度对应变张量的一阶导数，$\\boldsymbol{\\sigma} = \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}}$。四阶刚度张量 $\\mathbb{C}$ 是二阶导数，$\\mathbb{C} = \\frac{\\partial^2 W}{\\partial \\boldsymbol{\\varepsilon} \\partial \\boldsymbol{\\varepsilon}}$，它通过 $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}$ 将应力和应变线性关联起来。在分量形式中，$\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$ 且 $\\mathbb{C}_{ijkl} = \\frac{\\partial^2 W}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}}$。对于形式为 $W = \\frac{1}{2} \\varepsilon_{ij} \\mathbb{C}_{ijkl} \\varepsilon_{kl}$ 的二次应变能函数（假设 $\\mathbb{C}$ 具有主、次对称性），可以直接确定刚度张量分量 $\\mathbb{C}_{ijkl}$。\n\n基质能量对应于标准的线性各向同性刚度张量 $\\mathbb{C}_{\\mathrm{m}}$。其分量由下式给出：\n$$\n\\mathbb{C}_{\\mathrm{m}, ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n纤维能量贡献了一个附加的刚度张量 $\\mathbb{C}_{\\mathrm{f}}$。通过检查 $W_{\\mathrm{f}}$ 的表达式并考虑 $\\varepsilon_{ij}$ 和 $\\varepsilon_{kl}$ 的对称性，纤维刚度的贡献是：\n$$\n\\mathbb{C}_{\\mathrm{f}, ijkl} = k_{\\mathrm{f}} \\mathbb{A}^{(4)}_{ijkl}\n$$\n总有效刚度张量是其和 $\\mathbb{C} = \\mathbb{C}_{\\mathrm{m}} + \\mathbb{C}_{\\mathrm{f}}$。\n$$\n\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\mathbb{A}^{(4)}_{ijkl}\n$$\n我们剩下的任务是为给定的取向分布函数 (ODF) $\\rho(\\mathbf{n})$ 计算分量 $\\mathbb{A}^{(4)}_{ijkl}$。\nODF 以 Dirac delta 分布之和的形式给出：\n$$\n\\rho(\\mathbf{n}) \\;=\\; \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big]\n$$\n我们将其代入 $\\mathbb{A}^{(4)}_{ijkl}$ 的定义中：\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\int_{S^{2}} n_i n_j n_k n_l \\left( \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big] \\right) \\,\\mathrm{d}\\Omega\n$$\n利用积分的线性和 Dirac delta 的筛选性质 $\\int f(\\mathbf{x})\\delta(\\mathbf{x}-\\mathbf{x}_0)\\mathrm{d}V = f(\\mathbf{x}_0)$：\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p} \\left[ (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l + (-e_{p})_i (-e_{p})_j (-e_{p})_k (-e_{p})_l \\right]\n$$\n其中 $(e_{p})_i$ 表示基向量 $\\mathbf{e}_p$ 的第 $i$ 个分量。由于 $(-1)^4=1$，括号中的两项是相同的。\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p} \\left[ 2\\, (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l \\right] = \\sum_{p=1}^{3} w_{p} (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l\n$$\n我们采用符号 $e_{pi}$ 来表示向量 $\\mathbf{e}_p$ 的第 $i$ 个分量。那么四阶取向张量是：\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl}\n$$\n最后，我们将此结果代入总刚度张量 $\\mathbb{C}_{ijkl}$ 的表达式中。这得出了根据给定参数的正交各向异性刚度张量的显式分量形式。\n$$\n\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\left( \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl} \\right)\n$$\n该表达式提供了材料线弹性响应的完整描述，它结合了各向同性背景基质与由离散 ODF 定义的正交各向异性纤维增强。",
            "answer": "$$\n\\boxed{\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl}}\n$$"
        },
        {
            "introduction": "从线性理论过渡到更通用的有限应变框架，我们遇到了一个核心挑战：定义材料属性的取向积分通常难以解析求解。本练习直面这一问题。首先，您将为一个特殊的各向同性纤维分布情况推导应力张量的精确封闭形式表达式。然后，您将使用此解析解作为“黄金标准”，编写程序来评估一种常用数值求积方法的准确性，从而获得量化误差的实践经验，这是任何计算建模者必备的基本技能。",
            "id": "4191275",
            "problem": "考虑一种纤维增强超弹性材料，其纤维在单位球面上呈各向同性取向分布。设纤维方向由单位向量 $\\mathbf{a} \\in \\mathbb{R}^3$ 表示，满足 $\\|\\mathbf{a}\\|=1$；右柯西-格林变形张量为 $\\mathbf{C} \\in \\mathbb{R}^{3 \\times 3}$；纤维拉伸定义为 $\\lambda_f^2 = \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}$。单根纤维的应变能密度由下式给出\n$$\nw(\\lambda_f) = \\frac{k}{2}\\left(\\lambda_f^2 - 1\\right)^2 = \\frac{k}{2}\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2,\n$$\n其中 $k$ 是一个正的材料参数。总应变能密度通过取向平均得到\n$$\nW(\\mathbf{C}) = \\int_{\\mathbb{S}^2} \\rho(\\mathbf{a})\\, w(\\lambda_f(\\mathbf{a}))\\, \\mathrm{d}\\Omega, \\quad \\rho(\\mathbf{a}) = \\frac{1}{4\\pi},\n$$\n其中 $\\mathbb{S}^2$ 表示单位球面，$\\mathrm{d}\\Omega$ 是曲面测度。第二皮奥拉-基尔霍夫应力（SPK）根据超弹性理论可由下式获得\n$$\n\\mathbf{S}(\\mathbf{C}) = 2\\,\\frac{\\partial W}{\\partial \\mathbf{C}}.\n$$\n\n任务 A（推导）：从上述定义出发，利用张量微积分和各向同性球面平均，推导 $\\mathbf{S}(\\mathbf{C})$ 的一个闭式表达式，该表达式应以 $\\mathbf{C}$、其迹 $\\mathrm{tr}(\\mathbf{C})$、单位张量 $\\mathbf{I}$ 以及参数 $k$ 来表示。\n\n任务 B（数值积分与误差量化）：为近似取向积分，使用一个在 $\\mathbb{S}^2$ 上包含 $N$ 个点的 Lebedev 网格，其关联的正常数权重为 $\\{(\\mathbf{a}_i, w_i)\\}_{i=1}^N$，该网格能精确积分直至某一阶次的球面多项式。对于给定的 $\\mathbf{C}$ 和 $k$，应力可近似为\n$$\n\\mathbf{S}_N(\\mathbf{C}) = 2\\,\\frac{1}{4\\pi}\\sum_{i=1}^N w_i\\,\\frac{\\partial}{\\partial \\mathbf{C}}\\left[\\frac{k}{2}\\left(\\mathbf{a}_i^\\top \\mathbf{C}\\,\\mathbf{a}_i - 1\\right)^2\\right].\n$$\n使用弗罗贝尼乌斯范数定义相对积分误差为\n$$\ne_N = \\frac{\\|\\mathbf{S}_N(\\mathbf{C}) - \\mathbf{S}(\\mathbf{C})\\|_F}{\\|\\mathbf{S}(\\mathbf{C})\\|_F}.\n$$\n若 $\\|\\mathbf{S}(\\mathbf{C})\\|_F  10^{-12}$ 且 $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F  10^{-12}$，则设 $e_N = 0$。若 $\\|\\mathbf{S}(\\mathbf{C})\\|_F  10^{-12}$ 但 $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F \\ge 10^{-12}$，则设 $e_N = +\\infty$。\n\n您必须实现一个程序，对下面指定的每个测试用例，计算一组 Lebedev 网格（尺寸 $N \\in \\{6, 14\\}$）的 $e_N$，并确定使 $e_N  0.01$（即相对误差低于 $1\\%$）的最小 $N$。如果两个网格均未达到目标，则对该测试用例返回整数 $-1$。\n\n本问题中所有量均为无量纲量，必须按此处理；不涉及物理单位。角度不属于输入的一部分。您的数值实现必须使用如下定义的 Lebedev 网格：\n- $N = 6$：八面体点集，点位于 $\\mathbf{a} = (\\pm 1, 0, 0)$、$(0, \\pm 1, 0)$、$(0, 0, \\pm 1)$，权重相等，为 $w_i = \\frac{4\\pi}{6}$。\n- $N = 14$：由上述 6 个坐标轴点（每个点的权重为 $w_a = \\frac{4\\pi}{15}$）和 8 个立方体角点 $\\mathbf{a} = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$（权重为 $w_c = \\frac{3\\pi}{10}$）组成的并集。\n\n对于测试套件，使用三个具有对角变形梯度和相应右柯西-格林张量的用例：\n- 用例 1（一般各向异性，正常路径）：$k = 2.0$，$\\mathbf{F} = \\mathrm{diag}(1.2, 0.9, \\lambda_3)$，其中 $\\lambda_3 = \\frac{1}{1.2 \\cdot 0.9}$；设 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$。\n- 用例 2（近单位变形，类边界情况）：$k = 5.0$，$\\mathbf{F} = \\mathrm{diag}(1.01, 0.99, \\lambda_3)$，其中 $\\lambda_3 = \\frac{1}{1.01 \\cdot 0.99}$；设 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$。\n- 用例 3（强各向异性，边缘趋势）：$k = 1.0$，$\\mathbf{F} = \\mathrm{diag}(1.6, 0.85, \\lambda_3)$，其中 $\\lambda_3 = \\frac{1}{1.6 \\cdot 0.85}$；设 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$。\n\n您的程序必须：\n- 推导并使用 $\\mathbf{S}(\\mathbf{C})$ 的闭式解作为精确参考。\n- 按规定构造 $N=6$ 和 $N=14$ 的 Lebedev 网格。\n- 为每个 $N$ 和每个测试用例计算 $e_N$。\n- 为每个测试用例确定满足 $e_N  0.01$ 的最小 $N$，如果无法达到则返回 -1。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个测试用例的最小网格尺寸，形式为方括号括起来的逗号分隔列表，例如 $[6,14,-1]$。每个条目必须是整数。不应打印任何额外文本。",
            "solution": "该问题被评估为有效，因为它在连续介质力学方面有科学依据，问题设定良好，并且为解析推导和数值实现提供了所有必要信息。\n\n根据要求，解答分为两部分。A 部分详细介绍了第二皮奥拉-基尔霍夫应力张量的解析推导。B 部分描述了基于 Lebedev 积分的数值方案和误差量化程序。\n\n### A 部分：第二皮奥拉-基尔霍夫应力的解析推导\n\n总应变能密度 $W(\\mathbf{C})$ 是通过对单位球面 $\\mathbb{S}^2$ 上所有可能的纤维取向 $\\mathbf{a}$ 的纤维应变能 $w(\\lambda_f)$ 进行平均得到的。在均匀取向密度 $\\rho(\\mathbf{a}) = 1/(4\\pi)$ 的情况下，表达式为：\n$$\nW(\\mathbf{C}) = \\frac{1}{4\\pi} \\int_{\\mathbb{S}^2} w(\\lambda_f(\\mathbf{a}))\\, \\mathrm{d}\\Omega\n$$\n特定的纤维应变能函数由下式给出：\n$$\nw(\\lambda_f) = \\frac{k}{2}\\left(\\lambda_f^2 - 1\\right)^2 = \\frac{k}{2}\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2\n$$\n将其代入 $W(\\mathbf{C})$ 的积分式中，得到：\n$$\nW(\\mathbf{C}) = \\frac{k}{8\\pi} \\int_{\\mathbb{S}^2} \\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2\\, \\mathrm{d}\\Omega\n$$\n为推导闭式表达式，我们首先展开被积函数，并将取向平均（表示为 $\\langle \\cdot \\rangle = \\frac{1}{4\\pi} \\int_{\\mathbb{S}^2} (\\cdot) \\, \\mathrm{d}\\Omega$）用张量 $\\mathbf{C}$ 的不变量表示。\n$$\nW(\\mathbf{C}) = \\frac{k}{2} \\left\\langle \\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}\\right)^2 - 2\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}\\right) + 1 \\right\\rangle = \\frac{k}{2} \\left( \\left\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\right\\rangle - 2\\left\\langle \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} \\right\\rangle + 1 \\right)\n$$\n我们使用以下关于单位向量 $\\mathbf{a}$ 函数的各向同性平均的标准结果：\n$$\n\\langle \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\frac{1}{3}\\mathbf{I}\n$$\n$$\n\\langle \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\rangle_{ijkl} = \\frac{1}{15}(\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n利用这些结果，我们可以计算出平均值：\n$$\n\\langle \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} \\rangle = \\langle \\mathbf{C} : (\\mathbf{a} \\otimes \\mathbf{a}) \\rangle = \\mathbf{C} : \\langle \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\mathbf{C} : \\left(\\frac{1}{3}\\mathbf{I}\\right) = \\frac{1}{3}\\mathrm{tr}(\\mathbf{C})\n$$\n$$\n\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\rangle = \\langle (\\mathbf{C} : (\\mathbf{a} \\otimes \\mathbf{a}))^2 \\rangle = \\mathbf{C} \\otimes \\mathbf{C} : \\langle \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\frac{1}{15}\\left( (\\mathrm{tr}\\mathbf{C})^2 + 2\\mathrm{tr}(\\mathbf{C}^2) \\right)\n$$\n将这些平均值代入应变能表达式：\n$$\nW(\\mathbf{C}) = \\frac{k}{2} \\left( \\frac{1}{15}\\left( (\\mathrm{tr}\\mathbf{C})^2 + 2\\mathrm{tr}(\\mathbf{C}^2) \\right) - \\frac{2}{3}\\mathrm{tr}(\\mathbf{C}) + 1 \\right)\n$$\n第二皮奥拉-基尔霍夫应力张量由 $\\mathbf{S} = 2 \\frac{\\partial W}{\\partial \\mathbf{C}}$ 给出。利用张量微分恒等式 $\\frac{\\partial \\mathrm{tr}(\\mathbf{C})}{\\partial \\mathbf{C}} = \\mathbf{I}$ 和 $\\frac{\\partial \\mathrm{tr}(\\mathbf{C}^2)}{\\partial \\mathbf{C}} = 2\\mathbf{C}$，我们得到：\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\frac{k}{2} \\left( \\frac{1}{15}\\left( 2\\mathrm{tr}(\\mathbf{C})\\mathbf{I} + 4\\mathbf{C} \\right) - \\frac{2}{3}\\mathbf{I} \\right)\n$$\n因此，应力张量为：\n$$\n\\mathbf{S}(\\mathbf{C}) = 2 \\frac{\\partial W}{\\partial \\mathbf{C}} = k \\left( \\frac{2}{15}\\mathrm{tr}(\\mathbf{C})\\mathbf{I} + \\frac{4}{15}\\mathbf{C} - \\frac{2}{3}\\mathbf{I} \\right) = \\frac{2k}{15} \\left( 2\\mathbf{C} + (\\mathrm{tr}(\\mathbf{C}) - 5)\\mathbf{I} \\right)\n$$\n这个闭式解将作为数值积分方案的精确参考。\n\n### B 部分：数值积分与误差量化\n\nB 部分的程序将实现上述解析解 $\\mathbf{S}(\\mathbf{C})$ 和使用给定 Lebedev 网格的数值解 $\\mathbf{S}_N(\\mathbf{C})$。然后，它将计算两者之间的相对误差，并确定满足精度要求的最小网格尺寸。实现细节在问题描述和提供的 Python 代码中给出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding the minimal Lebedev grid size for a given error tolerance\n    in a fiber-reinforced hyperelastic material model.\n    \"\"\"\n\n    # Define Lebedev grid points and weights as specified in the problem.\n    s_sqrt3 = 1.0 / np.sqrt(3)\n    grids = {\n        6: {\n            \"points\": np.array([\n                [1., 0., 0.], [-1., 0., 0.],\n                [0., 1., 0.], [0., -1., 0.],\n                [0., 0., 1.], [0., 0., -1.]\n            ]),\n            \"weights\": np.full(6, 4 * np.pi / 6)\n        },\n        14: {\n            \"points\": np.vstack([\n                np.array([\n                    [1., 0., 0.], [-1., 0., 0.], [0., 1., 0.],\n                    [0., -1., 0.], [0., 0., 1.], [0., 0., -1.]\n                ]),\n                np.array([\n                    [s_sqrt3, s_sqrt3, s_sqrt3], [s_sqrt3, s_sqrt3, -s_sqrt3],\n                    [s_sqrt3, -s_sqrt3, s_sqrt3], [s_sqrt3, -s_sqrt3, -s_sqrt3],\n                    [-s_sqrt3, s_sqrt3, s_sqrt3], [-s_sqrt3, s_sqrt3, -s_sqrt3],\n                    [-s_sqrt3, -s_sqrt3, s_sqrt3], [-s_sqrt3, -s_sqrt3, -s_sqrt3]\n                ])\n            ]),\n            \"weights\": np.hstack([\n                np.full(6, 4 * np.pi / 15),\n                np.full(8, 3 * np.pi / 10)\n            ])\n        }\n    }\n\n    def calculate_S_exact(k, C):\n        \"\"\"Calculates the exact Second Piola-Kirchhoff stress tensor.\"\"\"\n        tr_C = np.trace(C)\n        I = np.identity(3)\n        S = (2 * k / 15) * (2 * C + (tr_C - 5) * I)\n        return S\n\n    def calculate_S_N(k, C, N):\n        \"\"\"Calculates the approximate SPK stress tensor using a Lebedev grid.\"\"\"\n        grid = grids[N]\n        points = grid[\"points\"]\n        weights = grid[\"weights\"]\n        \n        S_N = np.zeros((3, 3))\n        # Vectorized calculation for efficiency\n        # lambda_f^2 = a^T C a for all points 'a'\n        lambda_f_sq_vec = np.einsum('ia,ab,ib-i', points, C, points)\n        \n        # a (outer) a for all points 'a'\n        a_outer_a_tensor = np.einsum('ia,ib-iab', points, points)\n        \n        # Weighted sum\n        S_N = np.einsum('i,i,iab-ab', weights, lambda_f_sq_vec - 1, a_outer_a_tensor)\n        \n        S_N *= (k / (2 * np.pi))\n        return S_N\n\n    def calculate_error(S_N, S_exact):\n        \"\"\"Calculates the relative quadrature error e_N.\"\"\"\n        norm_S_exact = np.linalg.norm(S_exact, 'fro')\n        \n        if norm_S_exact  1e-12:\n            norm_S_N = np.linalg.norm(S_N, 'fro')\n            if norm_S_N  1e-12:\n                return 0.0\n            else:\n                return np.inf\n        \n        norm_diff = np.linalg.norm(S_N - S_exact, 'fro')\n        return norm_diff / norm_S_exact\n\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {'k': 2.0, 'F_diag': (1.2, 0.9, 1.0 / (1.2 * 0.9))},\n        {'k': 5.0, 'F_diag': (1.01, 0.99, 1.0 / (1.01 * 0.99))},\n        {'k': 1.0, 'F_diag': (1.6, 0.85, 1.0 / (1.6 * 0.85))}\n    ]\n    grid_sizes_to_test = [6, 14]\n    results = []\n    error_tolerance = 0.01\n\n    for case in test_cases:\n        k = case['k']\n        # F is diagonal, so F_diag are the principal stretches\n        stretches = np.array(case['F_diag'])\n        # C = F^T F = F^2 for diagonal F\n        C = np.diag(stretches**2)\n        \n        S_exact = calculate_S_exact(k, C)\n        \n        min_N = -1\n        for N in grid_sizes_to_test:\n            S_N = calculate_S_N(k, C, N)\n            error = calculate_error(S_N, S_exact)\n            \n            if error  error_tolerance:\n                min_N = N\n                break\n        \n        results.append(min_N)\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "许多本构模型的最终目标是预测材料行为，这需要根据实验数据对其进行校准。本练习将使用广受认可的 Gasser-Ogden-Holzapfel (GOH) 模型，聚焦于这一关键步骤。您将构建一个非线性最小二乘问题，以将模型参数与模拟生物力学测试的数据进行拟合。核心任务是推导残差向量的雅可比矩阵（Jacobian matrix），它是高效优化算法的关键组成部分，从而将连续介质力学理论与数据驱动科学联系起来。",
            "id": "4191225",
            "problem": "考虑一个薄的、不可压缩的、超弹性的软组织，其包含一个分散的胶原纤维族，该组织由 Gasser–Ogden–Holzapfel (GOH) 公式建模。在参考构型中，单位纤维方向为 $ \\mathbf{a}_0 = (\\cos \\theta_0, \\sin \\theta_0, 0) $，其中 $\\theta_0$ 以弧度为单位。假设应变能密度函数分为各向同性基质部分和各向异性纤维部分，\n$$\n\\psi = \\psi_{\\text{iso}} + \\psi_{\\text{aniso}},\n$$\n其中\n$$\n\\psi_{\\text{iso}} = \\frac{\\mu}{2} \\left(I_1 - 3\\right), \\qquad \\psi_{\\text{aniso}} = \\frac{k_1}{2 k_2} \\left[\\exp\\!\\left(k_2\\,E^2\\right) - 1\\right],\n$$\n其中第一不变量 $I_1 = \\text{tr}(\\mathbf{C})$ 和纤维不变量 $I_4 = \\mathbf{a}_0 \\cdot \\mathbf{C}\\,\\mathbf{a}_0$ 是根据右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$ 定义的，而 GOH 弥散耦合为\n$$\nE = \\kappa \\left(I_1 - 3\\right) + \\left(1 - 3 \\kappa\\right)\\left(I_4 - 1\\right),\n$$\n其中 $0 \\le \\kappa \\le \\frac{1}{3}$。参数 $(k_1, k_2, \\kappa)$ 表征纤维的贡献，$\\mu$ 是一个独立获得的已知剪切模量。\n\n在不可压缩（$J = 1$）条件下进行两种平面测试：\n- 沿方向 1 的单轴拉伸，主拉伸状态为 $ \\lambda_1 = \\lambda_u $, $ \\lambda_2 = \\lambda_3 = \\lambda_u^{-1/2} $，横向无牵引条件（$\\sigma_{22} = \\sigma_{33} = 0$）。\n- 在 $1$–$2$ 平面内的等双轴拉伸，主拉伸状态为 $ \\lambda_1 = \\lambda_2 = \\lambda_b $, $ \\lambda_3 = \\lambda_b^{-2} $，且 $\\sigma_{33} = 0$。\n\n在每次测试中，测量轴向柯西应力：设 $s_u^{\\text{meas}}$ 为单轴拉伸中测得的轴向柯西应力，$s_b^{\\text{meas}}$ 为等双轴拉伸中测得的轴向柯西应力。对于不可压缩超弹性材料，主柯西应力差满足\n$$\n\\sigma_i - \\sigma_j = \\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i} - \\lambda_j \\frac{\\partial \\psi}{\\partial \\lambda_j}.\n$$\n在横向无牵引条件下，轴向应力等于相应的应力差。将每次测试中模型预测的轴向应力定义为\n$$\ns_u(\\lambda_u; k_1, k_2, \\kappa) = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2} \\quad \\text{在 } (\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\lambda_u, \\lambda_u^{-1/2}, \\lambda_u^{-1/2}\\right) \\text{ 时},\n$$\n$$\ns_b(\\lambda_b; k_1, k_2, \\kappa) = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3} \\quad \\text{在 } (\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\lambda_b, \\lambda_b, \\lambda_b^{-2}\\right) \\text{ 时}.\n$$\n\n通过最小化残差平方和\n$$\nr_u = s_u(\\lambda_u; k_1, k_2, \\kappa) - s_u^{\\text{meas}}, \\qquad r_b = s_b(\\lambda_b; k_1, k_2, \\kappa) - s_b^{\\text{meas}}.\n$$\n构建非线性最小二乘问题，以从这两个测试中估计 $(k_1, k_2, \\kappa)$。\n推导残差向量 $\\mathbf{r} = \\begin{pmatrix} r_u \\\\ r_b \\end{pmatrix}$ 相对于参数 $(k_1, k_2, \\kappa)$ 的解析雅可比矩阵，该矩阵在指定的拉伸状态下进行评估，并用 $\\lambda_u$、$\\lambda_b$、$\\theta_0$、$\\mu$、$k_1$、$k_2$ 和 $\\kappa$ 表示最终结果。角度必须以弧度处理。拉伸是无量纲的，应力单位为帕斯卡（国际单位制）。最终答案必须是雅可比矩阵的单个封闭形式符号表达式。",
            "solution": "用户希望求解一个生物力学中的非线性最小二乘问题的雅可比矩阵。我已阅读问题陈述，以下是我生成解决方案的思考过程。\n\n**1. 问题验证**\n首先，我将对问题陈述进行强制性验证。\n\n*   **步骤 1：提取已知条件**\n    *   **模型：** 不可压缩、超弹性的软组织，包含一个分散的胶原纤维族（GOH 模型）。\n    *   **应变能密度函数：** $\\psi = \\psi_{\\text{iso}} + \\psi_{\\text{aniso}}$。\n    *   **各向同性部分：** $\\psi_{\\text{iso}} = \\frac{\\mu}{2} (I_1 - 3)$。\n    *   **各向异性部分：** $\\psi_{\\text{aniso}} = \\frac{k_1}{2 k_2} [\\exp(k_2 E^2) - 1]$。\n    *   **弥散耦合：** $E = \\kappa (I_1 - 3) + (1 - 3 \\kappa)(I_4 - 1)$。\n    *   **不变量：** $I_1 = \\text{tr}(\\mathbf{C})$，$I_4 = \\mathbf{a}_0 \\cdot \\mathbf{C}\\,\\mathbf{a}_0$，其中 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$ 且 $\\mathbf{a}_0 = (\\cos \\theta_0, \\sin \\theta_0, 0)$。\n    *   **参数：** 待估计参数 $(k_1, k_2, \\kappa)$，其中 $0 \\le \\kappa \\le \\frac{1}{3}$。$\\mu$ 为已知。\n    *   **单轴测试：** 拉伸状态 $(\\lambda_u, \\lambda_u^{-1/2}, \\lambda_u^{-1/2})$。测量应力 $s_u^{\\text{meas}}$。模型应力 $s_u = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2}$。\n    *   **等双轴测试：** 拉伸状态 $(\\lambda_b, \\lambda_b, \\lambda_b^{-2})$。测量应力 $s_b^{\\text{meas}}$。模型应力 $s_b = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3}$。\n    *   **残差：** $r_u = s_u - s_u^{\\text{meas}}$，$r_b = s_b - s_b^{\\text{meas}}$。\n    *   **任务：** 推导雅可比矩阵 $\\mathbf{J} = \\frac{\\partial \\mathbf{r}}{\\partial(k_1, k_2, \\kappa)}$，其中 $\\mathbf{r} = (r_u, r_b)^\\top$。\n\n*   **步骤 2：使用提取的已知条件进行验证**\n    *   **科学依据：** 该问题基于 Gasser–Ogden–Holzapfel (GOH) 模型，这是软组织生物力学中一个广受认可且成熟的本构律。所使用的所有概念（超弹性、应变不变量、柯西应力）都是连续介质力学的基本原理。该问题具有科学合理性。\n    *   **适定性：** 任务是推导残差向量的雅可比矩阵，这是优化和参数估计中一个标准且定义明确的数学过程。所有必要的函数和变量都已提供。该问题是适定的。\n    *   **客观性：** 问题以精确、形式化的数学语言陈述，没有任何主观性或歧义。\n\n*   **步骤 3：结论与行动**\n    *   该问题有效。它具有科学依据、适定性和客观性。没有矛盾、缺失信息或不成立的前提。我现在将开始推导解决方案。\n\n**2. 求解推导**\n\n目标是计算残差向量 $\\mathbf{r} = \\begin{pmatrix} r_u \\\\ r_b \\end{pmatrix}$ 相对于参数 $\\mathbf{p} = (k_1, k_2, \\kappa)$ 的雅可比矩阵 $\\mathbf{J}$。雅可比矩阵的分量由 $J_{ij} = \\frac{\\partial r_i}{\\partial p_j}$ 给出。由于测量应力 $s_u^{\\text{meas}}$ 和 $s_b^{\\text{meas}}$ 是常数，雅可比矩阵为 $\\mathbf{J} = \\frac{\\partial(s_u, s_b)}{\\partial(k_1, k_2, \\kappa)}$。\n\n首先，我们用主拉伸 $\\lambda_1, \\lambda_2, \\lambda_3$ 来表示应变能密度函数 $\\psi$ 和应力。右柯西-格林张量 $\\mathbf{C}$ 在主基底下是对角阵，$\\mathbf{C} = \\text{diag}(\\lambda_1^2, \\lambda_2^2, \\lambda_3^2)$。不变量为：\n$I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$\n$I_4 = \\mathbf{a}_0 \\cdot \\mathbf{C}\\,\\mathbf{a}_0 = \\lambda_1^2 \\cos^2\\theta_0 + \\lambda_2^2 \\sin^2\\theta_0$\n\n柯西应力差为 $\\sigma_i - \\sigma_j = \\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i} - \\lambda_j \\frac{\\partial \\psi}{\\partial \\lambda_j}$。我们需要求出 $\\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i}$ 项。\n对于各向同性部分：$\\lambda_i \\frac{\\partial \\psi_{\\text{iso}}}{\\partial \\lambda_i} = \\lambda_i \\frac{\\mu}{2} \\frac{\\partial I_1}{\\partial \\lambda_i} = \\lambda_i \\frac{\\mu}{2} (2\\lambda_i) = \\mu \\lambda_i^2$。\n对于各向异性部分，我们使用链式法则：\n$\\frac{\\partial \\psi_{\\text{aniso}}}{\\partial \\lambda_i} = \\frac{\\partial \\psi_{\\text{aniso}}}{\\partial E} \\frac{\\partial E}{\\partial \\lambda_i}$\n$\\frac{\\partial \\psi_{\\text{aniso}}}{\\partial E} = \\frac{k_1}{2k_2} \\exp(k_2 E^2) (2k_2 E) = k_1 E \\exp(k_2 E^2)$\n$\\frac{\\partial E}{\\partial \\lambda_i} = \\kappa \\frac{\\partial I_1}{\\partial \\lambda_i} + (1-3\\kappa) \\frac{\\partial I_4}{\\partial \\lambda_i} = 2\\lambda_i \\kappa + (1-3\\kappa) \\frac{\\partial I_4}{\\partial \\lambda_i}$\n\n各向异性应力贡献为：\n$\\lambda_i \\frac{\\partial \\psi_{\\text{aniso}}}{\\partial \\lambda_i} = k_1 E \\exp(k_2 E^2) \\lambda_i \\left[ 2\\lambda_i \\kappa + (1-3\\kappa) \\frac{\\partial I_4}{\\partial \\lambda_i} \\right]$\n$= 2 k_1 E \\exp(k_2 E^2) \\left[\\kappa \\lambda_i^2 + \\frac{1-3\\kappa}{2} \\lambda_i \\frac{\\partial I_4}{\\partial \\lambda_i} \\right]$\n\n我们定义一个因子 $S_{\\text{aniso}} = k_1 E \\exp(k_2 E^2)$。主应力贡献为：\n$\\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} = \\mu \\lambda_1^2 + 2 S_{\\text{aniso}} [\\kappa\\lambda_1^2 + (1-3\\kappa)\\lambda_1^2\\cos^2\\theta_0] = \\mu \\lambda_1^2 + 2\\lambda_1^2 S_{\\text{aniso}}[\\kappa + (1-3\\kappa)\\cos^2\\theta_0]$\n$\\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2} = \\mu \\lambda_2^2 + 2 S_{\\text{aniso}} [\\kappa\\lambda_2^2 + (1-3\\kappa)\\lambda_2^2\\sin^2\\theta_0] = \\mu \\lambda_2^2 + 2\\lambda_2^2 S_{\\text{aniso}}[\\kappa + (1-3\\kappa)\\sin^2\\theta_0]$\n$\\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3} = \\mu \\lambda_3^2 + 2 S_{\\text{aniso}} [\\kappa\\lambda_3^2] = \\mu \\lambda_3^2 + 2\\kappa\\lambda_3^2 S_{\\text{aniso}}$\n\n模型预测的应力 $s_u$ 和 $s_b$ 形式为 $s = s_{\\text{iso}} + s_{\\text{aniso}}$。各向同性部分 $s_{\\text{iso}}$ 与 $(k_1, k_2, \\kappa)$ 无关，因此其导数为零。我们只需要对各向异性部分求导。令 $s_{\\text{aniso}} = 2 A \\cdot S_{\\text{aniso}} = 2 A k_1 E \\exp(k_2 E^2)$，其中 $A$ 和 $E$ 是特定于每次测试的几何量。\n\n**关于参数的导数：**\n1.  $\\frac{\\partial s_{\\text{aniso}}}{\\partial k_1} = 2 A E \\exp(k_2 E^2)$。\n2.  $\\frac{\\partial s_{\\text{aniso}}}{\\partial k_2} = 2 A k_1 E \\frac{\\partial}{\\partial k_2}(\\exp(k_2 E^2)) = 2 A k_1 E \\exp(k_2 E^2) E^2 = 2 k_1 A E^3 \\exp(k_2 E^2)$。\n3.  $\\frac{\\partial s_{\\text{aniso}}}{\\partial \\kappa} = \\frac{\\partial}{\\partial \\kappa} [2 k_1 A(\\kappa) E(\\kappa) \\exp(k_2 E(\\kappa)^2)]$。由于 $A$ 和 $E$ 依赖于 $\\kappa$，我们使用乘积法则和链式法则：\n    $\\frac{\\partial s_{\\text{aniso}}}{\\partial \\kappa} = 2 k_1 \\left[ \\frac{\\partial A}{\\partial \\kappa} E \\exp(k_2 E^2) + A \\frac{\\partial}{\\partial \\kappa} (E \\exp(k_2 E^2)) \\right]$\n    $= 2 k_1 \\left[ \\frac{\\partial A}{\\partial \\kappa} E \\exp(k_2 E^2) + A \\left( \\frac{\\partial E}{\\partial \\kappa}\\exp(k_2 E^2) + E \\exp(k_2 E^2)(2 k_2 E \\frac{\\partial E}{\\partial \\kappa}) \\right) \\right]$\n    $= 2 k_1 \\exp(k_2 E^2) \\left[ \\frac{\\partial A}{\\partial \\kappa} E + A \\frac{\\partial E}{\\partial \\kappa} (1 + 2 k_2 E^2) \\right]$。\n\n现在，我们将这些通用公式应用于单轴和等双轴情况。\n\n**单轴情况（下标 $u$）：**\n-   拉伸：$(\\lambda_u, \\lambda_u^{-1/2}, \\lambda_u^{-1/2})$。\n-   不变量：$I_{1,u} = \\lambda_u^2 + 2\\lambda_u^{-1}$，$I_{4,u} = \\lambda_u^2 \\cos^2\\theta_0 + \\lambda_u^{-1} \\sin^2\\theta_0$。\n-   $E_u = \\kappa(I_{1,u}-3) + (1-3\\kappa)(I_{4,u}-1)$。\n-   应力为 $s_u = (\\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1})_u - (\\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2})_u$。\n-   各向异性应力部分对应于系数 $A_u$：\n    $A_u = \\lambda_u^2[\\kappa + (1-3\\kappa)\\cos^2\\theta_0] - \\lambda_u^{-1}[\\kappa + (1-3\\kappa)\\sin^2\\theta_0]$。\n-   关于 $\\kappa$ 的导数：\n    $\\frac{\\partial E_u}{\\partial \\kappa} = (I_{1,u}-3) - 3(I_{4,u}-1) = I_{1,u} - 3I_{4,u} = (\\lambda_u^2 + 2\\lambda_u^{-1}) - 3(\\lambda_u^2\\cos^2\\theta_0 + \\lambda_u^{-1}\\sin^2\\theta_0)$。\n    $\\frac{\\partial A_u}{\\partial \\kappa} = \\lambda_u^2(1 - 3\\cos^2\\theta_0) - \\lambda_u^{-1}(1 - 3\\sin^2\\theta_0)$。\n\n**等双轴情况（下标 $b$）：**\n-   拉伸：$(\\lambda_b, \\lambda_b, \\lambda_b^{-2})$。\n-   不变量：$I_{1,b} = 2\\lambda_b^2 + \\lambda_b^{-4}$，$I_{4,b} = \\lambda_b^2 \\cos^2\\theta_0 + \\lambda_b^2 \\sin^2\\theta_0 = \\lambda_b^2$。\n-   $E_b = \\kappa(I_{1,b}-3) + (1-3\\kappa)(I_{4,b}-1)$。\n-   应力为 $s_b = (\\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1})_b - (\\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3})_b$。\n-   各向异性应力部分对应于系数 $A_b$：\n    $A_b = \\lambda_b^2[\\kappa + (1-3\\kappa)\\cos^2\\theta_0] - \\lambda_b^{-4}[\\kappa]$。\n-   关于 $\\kappa$ 的导数：\n    $\\frac{\\partial E_b}{\\partial \\kappa} = (I_{1,b}-3) - 3(I_{4,b}-1) = I_{1,b} - 3I_{4,b} = (2\\lambda_b^2 + \\lambda_b^{-4}) - 3\\lambda_b^2 = \\lambda_b^{-4} - \\lambda_b^2$。\n    $\\frac{\\partial A_b}{\\partial \\kappa} = \\lambda_b^2(1 - 3\\cos^2\\theta_0) - \\lambda_b^{-4}$。\n\n**雅可比矩阵组装：**\n雅可比矩阵 $\\mathbf{J}$ 是一个 $2 \\times 3$ 矩阵，其中 $J_{1j} = \\frac{\\partial s_u}{\\partial p_j}$ 且 $J_{2j} = \\frac{\\partial s_b}{\\partial p_j}$。注意，参数 $\\mu$ 不会出现在关于 $(k_1, k_2, \\kappa)$ 的导数中。\n\n各分量为：\n$J_{11} = \\frac{\\partial s_u}{\\partial k_1} = 2 A_u E_u \\exp(k_2 E_u^2)$\n$J_{12} = \\frac{\\partial s_u}{\\partial k_2} = 2 k_1 A_u E_u^3 \\exp(k_2 E_u^2)$\n$J_{13} = \\frac{\\partial s_u}{\\partial \\kappa} = 2 k_1 \\exp(k_2 E_u^2) \\left[ \\frac{\\partial A_u}{\\partial \\kappa} E_u + A_u \\frac{\\partial E_u}{\\partial \\kappa} (1 + 2 k_2 E_u^2) \\right]$\n\n$J_{21} = \\frac{\\partial s_b}{\\partial k_1} = 2 A_b E_b \\exp(k_2 E_b^2)$\n$J_{22} = \\frac{\\partial s_b}{\\partial k_2} = 2 k_1 A_b E_b^3 \\exp(k_2 E_b^2)$\n$J_{23} = \\frac{\\partial s_b}{\\partial \\kappa} = 2 k_1 \\exp(k_2 E_b^2) \\left[ \\frac{\\partial A_b}{\\partial \\kappa} E_b + A_b \\frac{\\partial E_b}{\\partial \\kappa} (1 + 2 k_2 E_b^2) \\right]$\n\n为了呈现最终答案，我们定义以下中间量：\n- 对于单轴测试：\n  $I_{1,u} = \\lambda_u^2 + 2\\lambda_u^{-1}$\n  $I_{4,u} = \\lambda_u^2 \\cos^2\\theta_0 + \\lambda_u^{-1} \\sin^2\\theta_0$\n  $E_u = \\kappa(I_{1,u}-3) + (1-3\\kappa)(I_{4,u}-1)$\n  $A_u = \\lambda_u^2(\\kappa + (1-3\\kappa)\\cos^2\\theta_0) - \\lambda_u^{-1}(\\kappa + (1-3\\kappa)\\sin^2\\theta_0)$\n  $E'_{u,\\kappa} = \\frac{\\partial E_u}{\\partial \\kappa} = I_{1,u} - 3I_{4,u}$\n  $A'_{u,\\kappa} = \\frac{\\partial A_u}{\\partial \\kappa} = \\lambda_u^2(1 - 3\\cos^2\\theta_0) - \\lambda_u^{-1}(1 - 3\\sin^2\\theta_0)$\n\n- 对于等双轴测试：\n  $I_{1,b} = 2\\lambda_b^2 + \\lambda_b^{-4}$\n  $I_{4,b} = \\lambda_b^2$\n  $E_b = \\kappa(I_{1,b}-3) + (1-3\\kappa)(I_{4,b}-1)$\n  $A_b = \\lambda_b^2(\\kappa + (1-3\\kappa)\\cos^2\\theta_0) - \\kappa\\lambda_b^{-4}$\n  $E'_{b,\\kappa} = \\frac{\\partial E_b}{\\partial \\kappa} = I_{1,b} - 3I_{4,b} = \\lambda_b^{-4} - \\lambda_b^2$\n  $A'_{b,\\kappa} = \\frac{\\partial A_b}{\\partial \\kappa} = \\lambda_b^2(1 - 3\\cos^2\\theta_0) - \\lambda_b^{-4}$\n\n使用这些定义，雅可比矩阵在最终答案中给出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 A_u E_u \\exp(k_2 E_u^2)  2 k_1 A_u E_u^3 \\exp(k_2 E_u^2)  2 k_1 \\exp(k_2 E_u^2) [A'_{u,\\kappa} E_u + A_u E'_{u,\\kappa} (1 + 2 k_2 E_u^2)] \\\\\n2 A_b E_b \\exp(k_2 E_b^2)  2 k_1 A_b E_b^3 \\exp(k_2 E_b^2)  2 k_1 \\exp(k_2 E_b^2) [A'_{b,\\kappa} E_b + A_b E'_{b,\\kappa} (1 + 2 k_2 E_b^2)]\n\\end{pmatrix}\n}\n$$"
        }
    ]
}