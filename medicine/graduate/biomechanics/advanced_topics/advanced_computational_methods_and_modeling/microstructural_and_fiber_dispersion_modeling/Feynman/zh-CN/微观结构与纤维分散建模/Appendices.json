{
    "hands_on_practices": [
        {
            "introduction": "第一个实践旨在建立微观纤维结构（由取向分布函数 ODF 描述）与材料宏观弹性属性之间的基本联系。通过为一个具有简化正交各向异性纤维排布的组织推导其有效刚度张量，您将具体理解均质化原理是如何在生物力学中连接微观与宏观尺度的。",
            "id": "4191270",
            "problem": "考虑一个纤维软组织，其具有正交各向异性的纤维结构，嵌入在线性各向同性基质中，并在小应变运动学假设和仿射纤维运动学下进行建模。设各向同性基质由 Lamé 模量 $\\lambda$ 和 $\\mu$ 表征，因此基质的应变能密度为 $W_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon}$ 是小应变张量。假设纤维是线弹性的，仅在其局部方向上提供拉伸刚度，其纵向模量为 $E_{\\mathrm{f}}$，总体纤维体积分数为 $\\varphi$。在稀疏/仿射假设下，纤维对应变能密度的贡献是方向平均值\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}\\right)^{2}\\right\\rangle,\n$$\n其中 $k_{\\mathrm{f}} = \\varphi E_{\\mathrm{f}}$，$\\mathbf{n}$ 是单位球面上的单位向量，$\\langle\\cdot\\rangle$ 表示关于单位球面上的方向分布函数 (ODF) $\\rho(\\mathbf{n})$ 的平均，且 $\\int_{S^{2}}\\rho(\\mathbf{n})\\,\\mathrm{d}\\Omega = 1$。假设 ODF 是正交各向异性的，由与标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 对齐的六个对称离散方向组成：\n$$\n\\rho(\\mathbf{n}) \\;=\\; \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big],\n$$\n其中非负权重 $w_{p}\\ge 0$ 满足 $\\sum_{p=1}^{3} w_{p} = 1$，$\\delta(\\cdot)$ 是单位球面上的 Dirac delta 分布。\n\n从二阶和四阶方向张量（矩）的定义出发，\n$$\n\\mathbf{A} \\;=\\; \\left\\langle \\mathbf{n}\\otimes\\mathbf{n}\\right\\rangle, \\qquad \\mathbb{A}^{(4)} \\;=\\; \\left\\langle \\mathbf{n}\\otimes\\mathbf{n}\\otimes\\mathbf{n}\\otimes\\mathbf{n}\\right\\rangle,\n$$\n通过叠加基质和纤维的能量，推导有效的线性正交各向异性刚度张量 $\\mathbb{C}$，该张量通过 $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}$ 关联 Cauchy 应力 $\\boldsymbol{\\sigma}$ 和应变 $\\boldsymbol{\\varepsilon}$。用 Kronecker delta $\\delta_{ij}$、基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$、权重 $w_{1},w_{2},w_{3}$ 以及模量 $\\lambda$、$\\mu$ 和 $k_{\\mathrm{f}}$，以分量形式 $\\mathbb{C}_{ijkl}$ 显式地表达 $\\mathbb{C}$。您的推导必须从给定的能量定义和 ODF 矩出发。\n\n以指标记法为 $\\mathbb{C}_{ijkl}$ 提供一个单一的闭式解析表达式作为最终答案。不需要进行数值计算。最终答案中不要包含物理单位。",
            "solution": "该问题具有科学依据，提法恰当，客观，并包含了获得唯一解所需的所有信息。所提出的模型是纤维增强软组织微观力学中的一个标准公式。因此，该问题是有效的，我们可以继续进行推导。\n\n复合材料的总应变能密度 $W$ 由各向同性基质的应变能 $W_{\\mathrm{m}}$ 和嵌入纤维的应变能 $W_{\\mathrm{f}}$ 叠加而成。\n$$\nW = W_{\\mathrm{m}} + W_{\\mathrm{f}}\n$$\n问题给出了这些能量贡献的表达式。基质能量为：\n$$\nW_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}\n$$\n在指标记法中，其中 $\\boldsymbol{\\varepsilon}$ 是分量为 $\\varepsilon_{ij}$ 的小应变张量，这被写为：\n$$\nW_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\varepsilon_{kk}\\right)^{2} + \\mu\\,\\varepsilon_{ij}\\varepsilon_{ij}\n$$\n纤维能量的贡献由方向平均值给出：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}\\right)^{2}\\right\\rangle\n$$\n在指标记法中，平均内的项是 $(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}) = n_i \\varepsilon_{ij} n_j$。因此，纤维能量是：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(n_i \\varepsilon_{ij} n_j\\right)\\left(n_k \\varepsilon_{kl} n_l\\right) \\right\\rangle\n$$\n由于应变张量 $\\boldsymbol{\\varepsilon}$ 不依赖于方向向量 $\\mathbf{n}$，其分量可以移到平均算子之外：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle n_i n_j n_k n_l \\right\\rangle \\varepsilon_{ij} \\varepsilon_{kl}\n$$\n根据定义，项 $\\left\\langle n_i n_j n_k n_l \\right\\rangle$ 是四阶方向张量 $\\mathbb{A}^{(4)}_{ijkl}$ 的分量形式。\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\left\\langle n_i n_j n_k n_l \\right\\rangle = \\int_{S^{2}} n_i n_j n_k n_l \\rho(\\mathbf{n}) \\,\\mathrm{d}\\Omega\n$$\n因此，纤维能量可以紧凑地表示为：\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\, \\mathbb{A}^{(4)}_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\n总应变能密度是其和：\n$$\nW(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\left(\\varepsilon_{kk}\\right)^{2} + \\mu\\,\\varepsilon_{ij}\\varepsilon_{ij} + \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\, \\mathbb{A}^{(4)}_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\n对于小应变下的超弹性材料，Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 是应变能密度对应变张量的一阶导数，$\\boldsymbol{\\sigma} = \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}}$。四阶刚度张量 $\\mathbb{C}$ 是二阶导数，$\\mathbb{C} = \\frac{\\partial^2 W}{\\partial \\boldsymbol{\\varepsilon} \\partial \\boldsymbol{\\varepsilon}}$，它通过 $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}$ 线性地关联应力和应变。在分量形式中，$\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$ 且 $\\mathbb{C}_{ijkl} = \\frac{\\partial^2 W}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}}$。对于形式为 $W = \\frac{1}{2} \\varepsilon_{ij} \\mathbb{C}_{ijkl} \\varepsilon_{kl}$ 的二次应变能函数（假设 $\\mathbb{C}$ 具有主、次对称性），刚度张量分量 $\\mathbb{C}_{ijkl}$ 可以被直接识别。\n\n基质能量对应于标准的线性各向同性刚度张量 $\\mathbb{C}_{\\mathrm{m}}$。其分量由下式给出：\n$$\n\\mathbb{C}_{\\mathrm{m}, ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n纤维能量贡献了一个附加的刚度张量 $\\mathbb{C}_{\\mathrm{f}}$。通过检视 $W_{\\mathrm{f}}$ 的表达式并考虑 $\\varepsilon_{ij}$ 和 $\\varepsilon_{kl}$ 的对称性，纤维刚度贡献为：\n$$\n\\mathbb{C}_{\\mathrm{f}, ijkl} = k_{\\mathrm{f}} \\mathbb{A}^{(4)}_{ijkl}\n$$\n总有效刚度张量是其和 $\\mathbb{C} = \\mathbb{C}_{\\mathrm{m}} + \\mathbb{C}_{\\mathrm{f}}$。\n$$\n\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\mathbb{A}^{(4)}_{ijkl}\n$$\n我们剩下的任务是计算给定方向分布函数 (ODF) $\\rho(\\mathbf{n})$ 的分量 $\\mathbb{A}^{(4)}_{ijkl}$。\nODF 以 Dirac delta 分布的和的形式给出：\n$$\n\\rho(\\mathbf{n}) \\;=\\; \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big]\n$$\n我们将其代入 $\\mathbb{A}^{(4)}_{ijkl}$ 的定义中：\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\int_{S^{2}} n_i n_j n_k n_l \\left( \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big] \\right) \\,\\mathrm{d}\\Omega\n$$\n利用积分的线性和 Dirac delta 的筛选性质 $\\int f(\\mathbf{x})\\delta(\\mathbf{x}-\\mathbf{x}_0)\\mathrm{d}V = f(\\mathbf{x}_0)$：\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p} \\left[ (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l + (-e_{p})_i (-e_{p})_j (-e_{p})_k (-e_{p})_l \\right]\n$$\n其中 $(e_{p})_i$ 表示基向量 $\\mathbf{e}_p$ 的第 $i$ 个分量。由于 $(-1)^4=1$，括号中的两项是相同的。\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p} \\left[ 2\\, (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l \\right] = \\sum_{p=1}^{3} w_{p} (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l\n$$\n让我们采用记号 $e_{pi}$ 表示向量 $\\mathbf{e}_p$ 的第 $i$ 个分量。那么四阶方向张量是：\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl}\n$$\n最后，我们将此结果代入总刚度张量 $\\mathbb{C}_{ijkl}$ 的表达式中。这就得到了用给定参数表示的正交各向异性刚度张量的显式分量形式。\n$$\n\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\left( \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl} \\right)\n$$\n该表达式提供了材料线弹性响应的完整描述，它结合了各向同性背景基质与由离散 ODF 定义的正交各向异性纤维增强。",
            "answer": "$$\n\\boxed{\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl}}\n$$"
        },
        {
            "introduction": "虽然解析解能提供深刻的洞察，但大多数真实的纤维弥散模型依赖于数值积分来求解。本实践将深入微结构建模的计算核心，要求您为一个简化情况推导解析解，并实现一个数值求积方案来近似它。通过将数值结果与精确解进行比较，您将获得量化求积误差的直接经验，这是验证和应用稳健计算模型的关键技能。",
            "id": "4191275",
            "problem": "考虑一种纤维增强超弹性材料，其纤维在单位球面上呈各向同性取向分布。设纤维方向由单位向量 $\\mathbf{a} \\in \\mathbb{R}^3$（$\\|\\mathbf{a}\\|=1$）表示，右柯西-格林变形张量为 $\\mathbf{C} \\in \\mathbb{R}^{3 \\times 3}$，纤维拉伸定义为 $\\lambda_f^2 = \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}$。每根纤维的应变能密度由下式给出\n$$\nw(\\lambda_f) = \\frac{k}{2}\\left(\\lambda_f^2 - 1\\right)^2 = \\frac{k}{2}\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2,\n$$\n其中 $k$ 是一个正的材料参数。总应变能密度由取向平均给出\n$$\nW(\\mathbf{C}) = \\int_{\\mathbb{S}^2} \\rho(\\mathbf{a})\\, w(\\lambda_f(\\mathbf{a}))\\, \\mathrm{d}\\Omega, \\quad \\rho(\\mathbf{a}) = \\frac{1}{4\\pi},\n$$\n其中 $\\mathbb{S}^2$ 表示单位球面，$\\mathrm{d}\\Omega$ 是面积测度。第二类皮奥拉-基尔霍夫应力 (SPK) 从超弹性理论中导出如下\n$$\n\\mathbf{S}(\\mathbf{C}) = 2\\,\\frac{\\partial W}{\\partial \\mathbf{C}}.\n$$\n\n任务A (推导)：从上述定义出发，利用张量微积分和各向同性球面平均，推导 $\\mathbf{S}(\\mathbf{C})$ 的闭式表达式，该表达式应使用 $\\mathbf{C}$、其迹 $\\mathrm{tr}(\\mathbf{C})$、单位张量 $\\mathbf{I}$ 以及参数 $k$ 来表示。\n\n任务B (数值积分与误差量化)：为近似计算取向积分，使用一个在 $\\mathbb{S}^2$ 上包含 $N$ 个点的 Lebedev 网格，其关联的正权重为 $\\{(\\mathbf{a}_i, w_i)\\}_{i=1}^N$。该网格可以精确积分直至某一阶的球面多项式。对于给定的 $\\mathbf{C}$ 和 $k$，应力可近似为\n$$\n\\mathbf{S}_N(\\mathbf{C}) = 2\\,\\frac{1}{4\\pi}\\sum_{i=1}^N w_i\\,\\frac{\\partial}{\\partial \\mathbf{C}}\\left[\\frac{k}{2}\\left(\\mathbf{a}_i^\\top \\mathbf{C}\\,\\mathbf{a}_i - 1\\right)^2\\right].\n$$\n使用弗罗贝尼乌斯范数定义相对积分误差为\n$$\ne_N = \\frac{\\|\\mathbf{S}_N(\\mathbf{C}) - \\mathbf{S}(\\mathbf{C})\\|_F}{\\|\\mathbf{S}(\\mathbf{C})\\|_F}.\n$$\n如果 $\\|\\mathbf{S}(\\mathbf{C})\\|_F  10^{-12}$ 且 $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F  10^{-12}$，则设 $e_N = 0$。如果 $\\|\\mathbf{S}(\\mathbf{C})\\|_F  10^{-12}$ 但 $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F \\ge 10^{-12}$，则设 $e_N = +\\infty$。\n\n您必须实现一个程序，对于下面指定的每个测试用例，该程序需要计算一组 Lebedev 网格（尺寸 $N \\in \\{6, 14\\}$）的 $e_N$，并确定使 $e_N  0.01$（即相对误差低于 $1\\%$）的最小 $N$。如果两个网格都未达到目标，则该测试用例返回整数 $-1$。\n\n此问题中的所有量均为无量纲量，必须按此处理；不涉及物理单位。角度不是输入的一部分。您的数值实现必须使用如下定义的 Lebedev 网格：\n- $N = 6$：八面体点集，点位于 $\\mathbf{a} = (\\pm 1, 0, 0)$、$(0, \\pm 1, 0)$、$(0, 0, \\pm 1)$，权重相等，为 $w_i = \\frac{4\\pi}{6}$。\n- $N = 14$：以上6个坐标轴点（每个点的权重为 $w_a = \\frac{4\\pi}{15}$）与8个立方体角点 $\\mathbf{a} = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$（权重为 $w_c = \\frac{3\\pi}{10}$）的并集。\n\n对于测试套件，使用三个具有对角变形梯度和相应右柯西-格林张量的用例：\n- 用例1 (一般各向异性，理想路径)：$k = 2.0$, $\\mathbf{F} = \\mathrm{diag}(1.2, 0.9, \\lambda_3)$ 其中 $\\lambda_3 = \\frac{1}{1.2 \\cdot 0.9}$；设 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$。\n- 用例2 (近单位，类边界情况)：$k = 5.0$, $\\mathbf{F} = \\mathrm{diag}(1.01, 0.99, \\lambda_3)$ 其中 $\\lambda_3 = \\frac{1}{1.01 \\cdot 0.99}$；设 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$。\n- 用例3 (强各向异性，边缘趋势)：$k = 1.0$, $\\mathbf{F} = \\mathrm{diag}(1.6, 0.85, \\lambda_3)$ 其中 $\\lambda_3 = \\frac{1}{1.6 \\cdot 0.85}$；设 $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$。\n\n您的程序必须：\n- 推导并使用闭式 $\\mathbf{S}(\\mathbf{C})$ 作为精确参考。\n- 按规定构造 $N=6$ 和 $N=14$ 的 Lebedev 网格。\n- 为每个 $N$ 和每个测试用例计算 $e_N$。\n- 对每个测试用例，确定满足 $e_N  0.01$ 的最小 $N$，如果无法达到，则返回 $-1$。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个测试用例的最小网格尺寸，形式为方括号括起来的逗号分隔列表，例如 $[6,14,-1]$。每个条目必须是整数。不应打印任何额外文本。",
            "solution": "该问题被评估为有效，因为它在科学上基于连续介质力学，是适定的，并且为解析推导和数值实现提供了所有必要信息。\n\n根据要求，解答分为两部分。A部分详细介绍了第二类皮奥拉-基尔霍夫应力张量的解析推导。B部分描述了基于 Lebedev 积分的数值方案和误差量化过程。\n\n### A部分：第二类皮奥拉-基尔霍夫应力的解析推导\n\n总应变能密度 $W(\\mathbf{C})$ 是通过对单位球面 $\\mathbb{S}^2$ 上所有可能的纤维取向 $\\mathbf{a}$ 的纤维应变能 $w(\\lambda_f)$ 进行平均而得到的。在均匀取向密度 $\\rho(\\mathbf{a}) = 1/(4\\pi)$ 的情况下，表达式为：\n$$\nW(\\mathbf{C}) = \\frac{1}{4\\pi} \\int_{\\mathbb{S}^2} w(\\lambda_f(\\mathbf{a}))\\, \\mathrm{d}\\Omega\n$$\n特定的纤维应变能函数由下式给出：\n$$\nw(\\lambda_f) = \\frac{k}{2}\\left(\\lambda_f^2 - 1\\right)^2 = \\frac{k}{2}\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2\n$$\n将其代入 $W(\\mathbf{C})$ 的积分中，得到：\n$$\nW(\\mathbf{C}) = \\frac{k}{8\\pi} \\int_{\\mathbb{S}^2} \\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2\\, \\mathrm{d}\\Omega\n$$\n为了推导闭式表达式，我们首先展开被积函数，并用张量 $\\mathbf{C}$ 的不变量来表示取向平均（记为 $\\langle \\cdot \\rangle = \\frac{1}{4\\pi} \\int_{\\mathbb{S}^2} (\\cdot) \\, \\mathrm{d}\\Omega$）。\n$$\nW(\\mathbf{C}) = \\frac{k}{2} \\left\\langle \\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}\\right)^2 - 2\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}\\right) + 1 \\right\\rangle = \\frac{k}{2} \\left( \\left\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\right\\rangle - 2\\left\\langle \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} \\right\\rangle + 1 \\right)\n$$\n我们使用以下关于单位向量 $\\mathbf{a}$ 函数的各向同性平均的标准结果：\n\\begin{enumerate}\n    \\item $\\langle \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\frac{1}{3}\\mathbf{I}$\n    \\item $\\langle \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\frac{1}{15}(\\mathbf{I} \\overline{\\otimes} \\mathbf{I} + \\mathbb{T})$，其中，用索引表示法，$(\\mathbf{I} \\overline{\\otimes} \\mathbf{I})_{ijkl} = \\delta_{ij}\\delta_{kl}$ 且 $\\mathbb{T}_{ijkl} = \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}$。\n\\end{enumerate}\n第一个平均项是：\n$$\n\\langle \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} \\rangle = \\langle C_{ij} a_i a_j \\rangle = C_{ij} \\langle a_i a_j \\rangle = C_{ij} \\frac{1}{3}\\delta_{ij} = \\frac{1}{3}C_{ii} = \\frac{1}{3}\\mathrm{tr}(\\mathbf{C})\n$$\n第二个平均项是：\n$$\n\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\rangle = \\langle (C_{ij} a_i a_j)(C_{kl} a_k a_l) \\rangle = C_{ij} C_{kl} \\langle a_i a_j a_k a_l \\rangle\n$$\n使用四阶平均结果：\n$$\n\\langle a_i a_j a_k a_l \\rangle = \\frac{1}{15}(\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\n该项变为：\n$$\nC_{ij} C_{kl} \\frac{1}{15}(\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) = \\frac{1}{15} \\left( (C_{ij}\\delta_{ij})(C_{kl}\\delta_{kl}) + C_{ij}C_{kl}\\delta_{ik}\\delta_{jl} + C_{ij}C_{kl}\\delta_{il}\\delta_{jk} \\right)\n$$\n注意到 $C_{ij}\\delta_{ij} = \\mathrm{tr}(\\mathbf{C})$，并且由于 $\\mathbf{C}$ 是对称的，$C_{ij}C_{kl}\\delta_{ik}\\delta_{jl} = C_{kj}C_{kl} = \\mathrm{tr}(\\mathbf{C}^\\top\\mathbf{C}) = \\mathrm{tr}(\\mathbf{C}^2)$，类似地 $C_{ij}C_{kl}\\delta_{il}\\delta_{jk} = C_{lj}C_{jk} = \\mathrm{tr}(\\mathbf{C}^2)$，我们得到：\n$$\n\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\rangle = \\frac{1}{15} \\left( (\\mathrm{tr}(\\mathbf{C}))^2 + 2\\,\\mathrm{tr}(\\mathbf{C}^2) \\right)\n$$\n将这些结果代回 $W(\\mathbf{C})$ 的表达式中：\n$$\nW(\\mathbf{C}) = \\frac{k}{2} \\left[ \\frac{1}{15}\\left( (\\mathrm{tr}(\\mathbf{C}))^2 + 2\\,\\mathrm{tr}(\\mathbf{C}^2) \\right) - \\frac{2}{3}\\mathrm{tr}(\\mathbf{C}) + 1 \\right]\n$$\n第二类皮奥拉-基尔霍夫 (SPK) 应力 $\\mathbf{S}$ 由 $W$ 导出，即 $\\mathbf{S} = 2\\,\\frac{\\partial W}{\\partial \\mathbf{C}}$。我们需要以下张量不变量相对于对称张量 $\\mathbf{C}$ 的导数：\n$$\n\\frac{\\partial \\mathrm{tr}(\\mathbf{C})}{\\partial \\mathbf{C}} = \\mathbf{I}, \\quad \\frac{\\partial (\\mathrm{tr}(\\mathbf{C}))^2}{\\partial \\mathbf{C}} = 2\\,\\mathrm{tr}(\\mathbf{C})\\,\\mathbf{I}, \\quad \\frac{\\partial \\mathrm{tr}(\\mathbf{C}^2)}{\\partial \\mathbf{C}} = 2\\mathbf{C}\n$$\n将这些应用于 $W(\\mathbf{C})$：\n$$\n\\mathbf{S}(\\mathbf{C}) = 2 \\cdot \\frac{k}{2} \\frac{\\partial}{\\partial \\mathbf{C}} \\left[ \\frac{1}{15}\\left( (\\mathrm{tr}(\\mathbf{C}))^2 + 2\\,\\mathrm{tr}(\\mathbf{C}^2) \\right) - \\frac{2}{3}\\mathrm{tr}(\\mathbf{C}) + 1 \\right]\n$$\n$$\n\\mathbf{S}(\\mathbf{C}) = k \\left[ \\frac{1}{15}\\left( 2\\,\\mathrm{tr}(\\mathbf{C})\\,\\mathbf{I} + 2(2\\mathbf{C}) \\right) - \\frac{2}{3}\\mathbf{I} \\right]\n$$\n$$\n\\mathbf{S}(\\mathbf{C}) = k \\left[ \\frac{2}{15}\\mathrm{tr}(\\mathbf{C})\\,\\mathbf{I} + \\frac{4}{15}\\mathbf{C} - \\frac{10}{15}\\mathbf{I} \\right]\n$$\n提取公因子，得到 SPK 应力张量的最终闭式表达式：\n$$\n\\mathbf{S}(\\mathbf{C}) = \\frac{2k}{15} \\left[ 2\\mathbf{C} + (\\mathrm{tr}(\\mathbf{C}) - 5)\\mathbf{I} \\right]\n$$\n\n### B部分：数值积分与误差量化\n\n解析积分通过使用球面上的数值积分法则进行近似。一个尺寸为 $N$ 的 Lebedev 网格由 $N$ 个点 $\\mathbf{a}_i$ 和相关的权重 $w_i$ 组成。应力张量的积分通过加权和来近似。从定义 $\\mathbf{S} = 2\\,\\partial W / \\partial \\mathbf{C}$ 出发，在积分前进行微分：\n$$\n\\mathbf{S}(\\mathbf{C}) = 2\\,\\frac{\\partial}{\\partial \\mathbf{C}} \\left[ \\frac{k}{8\\pi} \\int_{\\mathbb{S}^2} (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1)^2 \\, \\mathrm{d}\\Omega \\right] = \\frac{k}{2\\pi} \\int_{\\mathbb{S}^2} (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1)(\\mathbf{a} \\otimes \\mathbf{a}) \\, \\mathrm{d}\\Omega\n$$\n数值近似 $\\mathbf{S}_N(\\mathbf{C})$ 将积分替换为对 $N$ 个积分点的求和：\n$$\n\\mathbf{S}_N(\\mathbf{C}) = \\frac{k}{2\\pi} \\sum_{i=1}^N w_i (\\mathbf{a}_i^\\top \\mathbf{C}\\,\\mathbf{a}_i - 1) (\\mathbf{a}_i \\otimes \\mathbf{a}_i)\n$$\n问题指定了两种 Lebedev 网格：一种是 $N=6$ 个点（八面体的顶点），权重相等，为 $w_i = 4\\pi/6$；另一种是 $N=14$ 个点（立方八面体的顶点），有两组权重。\n\n数值近似的相对误差 $e_N$ 使用弗罗贝尼乌斯范数 $\\|\\cdot\\|_F$ 来量化：\n$$\ne_N = \\frac{\\|\\mathbf{S}_N(\\mathbf{C}) - \\mathbf{S}(\\mathbf{C})\\|_F}{\\|\\mathbf{S}(\\mathbf{C})\\|_F}\n$$\n为近零应力状态定义了特殊条件：如果 $\\|\\mathbf{S}(\\mathbf{C})\\|_F  10^{-12}$，则当 $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F  10^{-12}$ 时 $e_N$ 为 $0$，否则为 $\\infty$。\n\n对于每个测试用例，实现将按以下步骤进行：\n\\begin{enumerate}\n    \\item 给定对角变形梯度 $\\mathbf{F} = \\mathrm{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$，计算右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^\\top\\mathbf{F} = \\mathrm{diag}(\\lambda_1^2, \\lambda_2^2, \\lambda_3^2)$。\n    \\item 使用推导出的解析公式计算精确应力张量 $\\mathbf{S}(\\mathbf{C})$。\n    \\item 遍历指定的网格尺寸 $N \\in \\{6, 14\\}$。对于每个 $N$：\n    \\begin{enumerate}\n        \\item 使用数值积分公式计算近似应力张量 $\\mathbf{S}_N(\\mathbf{C})$。\n        \\item 根据指定的公式和条件计算相对误差 $e_N$。\n        \\item 如果 $e_N  0.01$，则找到了所需的最小网格尺寸。记录此 $N$ 并停止。\n    \\end{enumerate}\n    \\item 如果循环完成而误差条件未满足，则为该测试用例记录 $-1$。\n\\end{enumerate}\n最终输出将是每个测试用例所需最小网格尺寸的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding the minimal Lebedev grid size for a given error tolerance\n    in a fiber-reinforced hyperelastic material model.\n    \"\"\"\n\n    # Define Lebedev grid points and weights as specified in the problem.\n    s_sqrt3 = 1.0 / np.sqrt(3)\n    grids = {\n        6: {\n            \"points\": np.array([\n                [1., 0., 0.], [-1., 0., 0.],\n                [0., 1., 0.], [0., -1., 0.],\n                [0., 0., 1.], [0., 0., -1.]\n            ]),\n            \"weights\": np.full(6, 4 * np.pi / 6)\n        },\n        14: {\n            \"points\": np.vstack([\n                np.array([\n                    [1., 0., 0.], [-1., 0., 0.], [0., 1., 0.],\n                    [0., -1., 0.], [0., 0., 1.], [0., 0., -1.]\n                ]),\n                np.array([\n                    [s_sqrt3, s_sqrt3, s_sqrt3], [s_sqrt3, s_sqrt3, -s_sqrt3],\n                    [s_sqrt3, -s_sqrt3, s_sqrt3], [s_sqrt3, -s_sqrt3, -s_sqrt3],\n                    [-s_sqrt3, s_sqrt3, s_sqrt3], [-s_sqrt3, s_sqrt3, -s_sqrt3],\n                    [-s_sqrt3, -s_sqrt3, s_sqrt3], [-s_sqrt3, -s_sqrt3, -s_sqrt3]\n                ])\n            ]),\n            \"weights\": np.hstack([\n                np.full(6, 4 * np.pi / 15),\n                np.full(8, 3 * np.pi / 10)\n            ])\n        }\n    }\n\n    def calculate_S_exact(k, C):\n        \"\"\"Calculates the exact Second Piola-Kirchhoff stress tensor.\"\"\"\n        tr_C = np.trace(C)\n        I = np.identity(3)\n        S = (2 * k / 15) * (2 * C + (tr_C - 5) * I)\n        return S\n\n    def calculate_S_N(k, C, N):\n        \"\"\"Calculates the approximate SPK stress tensor using a Lebedev grid.\"\"\"\n        grid = grids[N]\n        points = grid[\"points\"]\n        weights = grid[\"weights\"]\n        \n        S_N = np.zeros((3, 3))\n        # Vectorized calculation for efficiency\n        # lambda_f^2 = a^T C a for all points 'a'\n        lambda_f_sq_vec = np.einsum('ia,ab,ib-i', points, C, points)\n        \n        # a (outer) a for all points 'a'\n        a_outer_a_tensor = np.einsum('ia,ib-iab', points, points)\n        \n        # Weighted sum\n        S_N = np.einsum('i,i,iab-ab', weights, lambda_f_sq_vec - 1, a_outer_a_tensor)\n        \n        S_N *= (k / (2 * np.pi))\n        return S_N\n\n    def calculate_error(S_N, S_exact):\n        \"\"\"Calculates the relative quadrature error e_N.\"\"\"\n        norm_S_exact = np.linalg.norm(S_exact, 'fro')\n        \n        if norm_S_exact  1e-12:\n            norm_S_N = np.linalg.norm(S_N, 'fro')\n            if norm_S_N  1e-12:\n                return 0.0\n            else:\n                return np.inf\n        \n        norm_diff = np.linalg.norm(S_N - S_exact, 'fro')\n        return norm_diff / norm_S_exact\n\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {'k': 2.0, 'F_diag': (1.2, 0.9, 1.0 / (1.2 * 0.9))},\n        {'k': 5.0, 'F_diag': (1.01, 0.99, 1.0 / (1.01 * 0.99))},\n        {'k': 1.0, 'F_diag': (1.6, 0.85, 1.0 / (1.6 * 0.85))}\n    ]\n    grid_sizes_to_test = [6, 14]\n    results = []\n    error_tolerance = 0.01\n\n    for case in test_cases:\n        k = case['k']\n        # F is diagonal, so F_diag are the principal stretches\n        stretches = np.array(case['F_diag'])\n        # C = F^T F = F^2 for diagonal F\n        C = np.diag(stretches**2)\n        \n        S_exact = calculate_S_exact(k, C)\n        \n        min_N = -1\n        for N in grid_sizes_to_test:\n            S_N = calculate_S_N(k, C, N)\n            error = calculate_error(S_N, S_exact)\n            \n            if error  error_tolerance:\n                min_N = N\n                break\n        \n        results.append(min_N)\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在构观模型原理的基础上，这最后一个实践将探索一个高级应用：预测材料不稳定性。您将实现一个完整的非线性双纤维族模型，用以研究大剪切变形下强椭圆性丧失的现象。此练习展示了微结构模型不仅用于预测应力-应变响应，还可用于识别材料可能失效或发生剧烈行为变化的关键条件。",
            "id": "4191260",
            "problem": "考虑一个可压缩超弹性实体，用于模拟具有两个对称胶原纤维族（带弥散）的软组织。其本构响应由基质贡献和各向异性纤维贡献构成，后者基于一个广义结构张量，该张量以 Gasser–Ogden–Holzapfel (GOH) 方法的方式捕捉纤维弥散。变形梯度表示为 $F \\in \\mathbb{R}^{3 \\times 3}$，右 Cauchy–Green 张量为 $C = F^{\\top} F$，雅可比行列式为 $J = \\det F$。等容部分使用修正的右 Cauchy–Green 张量 $\\,\\bar{C} = J^{-2/3} C\\,$。参考构型中的两个纤维方向是单位向量 $a_1$ 和 $a_2$，它们关于 $x$ 轴对称并位于 $x$–$y$ 平面内，与 $x$ 轴的夹角为 $\\theta$：$a_1 = [\\cos \\theta,\\ \\sin \\theta,\\ 0]^{\\top}$ 和 $a_2 = [\\cos \\theta,\\ -\\sin \\theta,\\ 0]^{\\top}$。\n\n每个纤维族的弥散由广义结构张量 $H_i = \\kappa_d I + (1 - 3 \\kappa_d) a_i \\otimes a_i$ 表示，其中 $I$ 是单位张量，$\\kappa_d \\in [0, 1/3]$ 是弥散参数（$\\kappa_d = 1/3$ 对应于各向同性弥散，$\\kappa_d = 0$ 对应于完全对齐的纤维）。与纤维族 $i$ 相关联的各向异性不变量为 $I_{f,i} = \\mathrm{tr}(H_i \\bar{C})$。纤维仅在受拉时承载，这通过 Macaulay 括号 $\\langle x \\rangle_+ = \\max(x, 0)$ 来建模。\n\n应变能密度是总和 $W = W_m + W_f$，其中基质是可压缩 Neo–Hookean 模型，$W_m = \\frac{\\mu}{2} (I_1 - 3) - \\mu \\ln J + \\frac{\\kappa_b}{2} (\\ln J)^2$，其中 $I_1 = \\mathrm{tr}(C)$，而纤维族的贡献为\n$$\nW_f = \\sum_{i=1}^{2} \\frac{k_1}{2 k_2} \\left( \\exp\\left(k_2 \\left\\langle I_{f,i} - 1 \\right\\rangle_+^2\\right) - 1 \\right),\n$$\n其中刚度参数 $k_1  0$ 和 $k_2  0$。\n\n为了分析在有限简单剪切下的强椭圆性和潜在的失稳，考虑 $F$ 由下式给出\n$$\nF(\\gamma) = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix},\n$$\n其中剪切量 $\\gamma$ 是无量纲的。在材料（参考）描述中的瞬时弹性模量由四阶张量 $A_0$ 定义，其分量为 $A_{0\\,iJkL} = \\frac{\\partial P_{iJ}}{\\partial F_{kL}}$，其中 $P = \\frac{\\partial W}{\\partial F}$ 是第一 Piola–Kirchhoff 应力。参考构型中单位传播方向 $n$ 的声学张量为\n$$\nQ(n)_{ik} = A_{0\\,iJkL} \\, n_J \\, n_L,\n$$\n强椭圆性条件要求对于所有单位向量 $n$，声学张量都是正定的。强椭圆性丧失的一个实用指标是，对于至少一个方向 $n$，$Q(n)$ 的行列式为负。\n\n您的任务是实现一个程序，对于给定的材料参数和剪切水平，通过对 $P$ 关于 $F$ 的中心差分来数值计算瞬时弹性模量 $A_0$，为一组平面内方向 $n = [\\cos \\varphi,\\ \\sin \\varphi,\\ 0]^{\\top}$（角度以弧度表示）构建声学张量 $Q(n)$，并确定对于这些方向中的任何一个，$\\det(Q(n))$ 是否为负。对所有导数使用中心有限差分。角度必须以弧度指定和使用。\n\n为每个测试案例实现以下步骤：\n- 使用给定的 $\\gamma$ 构建 $F(\\gamma)$。\n- 根据上述定义，使用所提供的材料参数 $(\\mu, \\kappa_b, k_1, k_2, \\kappa_d)$ 和纤维角度 $\\theta$ 计算 $W(F)$。\n- 通过对 $W$ 关于 $F$ 逐分量使用对称中心差分进行数值微分，计算 $P(F)$。\n- 通过对 $P$ 关于 $F$ 逐分量使用对称中心差分进行数值微分，计算 $A_0(F)$。\n- 对于集合 $\\{\\;0,\\ \\pi/6,\\ \\pi/3,\\ \\pi/2,\\ 2\\pi/3,\\ 5\\pi/6\\;\\}$ 中的每个角度 $\\varphi$，形成 $n = [\\cos \\varphi,\\ \\sin \\varphi,\\ 0]^{\\top}$，构建 $Q(n)$，并计算其行列式。在计算行列式之前，使用对称部分 $\\frac{1}{2}(Q + Q^{\\top})$ 以减少数值不对称性。\n- 如果角度集上的最小行列式严格为负（即小于 $0$），则返回一个布尔值表示不稳定，否则表示稳定。\n\n物理单位：材料参数 $\\mu$、$\\kappa_b$、$k_1$ 和 $k_2$ 的单位是帕斯卡 (Pa)，但由于输出类型是布尔值，最终结果无需单位转换。\n\n角度单位：使用弧度。\n\n测试套件：\n- 案例 1：$(\\mu, \\kappa_b, k_1, k_2, \\kappa_d, \\theta, \\gamma) = (10,\\ 100,\\ 50,\\ 50,\\ 0.05,\\ \\pi/6,\\ 0.5)$。\n- 案例 2：$(\\mu, \\kappa_b, k_1, k_2, \\kappa_d, \\theta, \\gamma) = (5,\\ 20,\\ 200,\\ 200,\\ 0.01,\\ \\pi/4,\\ 1.2)$。\n- 案例 3（无剪切的边界情况）：$(\\mu, \\kappa_b, k_1, k_2, \\kappa_d, \\theta, \\gamma) = (10,\\ 100,\\ 100,\\ 100,\\ 0.2,\\ \\pi/6,\\ 0.0)$。\n- 案例 4（极端剪切和高度对齐的纤维）：$(\\mu, \\kappa_b, k_1, k_2, \\kappa_d, \\theta, \\gamma) = (5,\\ 50,\\ 400,\\ 100,\\ 0.0,\\ \\pi/3,\\ 2.0)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_i$ 是一个布尔值，对应于上述定义的第 $i$ 个测试案例的不稳定标志。",
            "solution": "所提出的问题要求对特定可压缩超弹性本构模型在有限简单剪切下的强椭圆性丧失进行数值研究。该方法包括通过数值微分计算瞬时弹性模量，然后分析一组传播方向的声学张量。通过实现一系列与所涉及力学量的层次化定义相对应的函数来执行求解。\n\n模型的基础是应变能密度函数 $W$，它是变形梯度 $F \\in \\mathbb{R}^{3 \\times 3}$ 的标量函数。它被加性分解为基质贡献 $W_m$ 和纤维贡献 $W_f$：\n$$\nW(F) = W_m(F) + W_f(F)\n$$\n$W$ 的计算依赖于从 $F$ 导出的几个运动学量：右 Cauchy–Green 张量 $C = F^{\\top} F$、其第一不变量 $I_1 = \\mathrm{tr}(C)$、雅可比行列式 $J = \\det F$ 以及等容修正的右 Cauchy–Green 张量 $\\bar{C} = J^{-2/3} C$。\n\n基质贡献 $W_m$ 由可压缩 Neo–Hookean 形式描述：\n$$\nW_m = \\frac{\\mu}{2} (I_1 - 3) - \\mu \\ln J + \\frac{\\kappa_b}{2} (\\ln J)^2\n$$\n其中 $\\mu$ 和 $\\kappa_b$ 分别是代表剪切模量和体积模量的材料参数。\n\n纤维贡献 $W_f$ 考虑了两个对称取向的胶原纤维族。这些纤维族在参考构型中的取向由单位向量 $a_1 = [\\cos \\theta, \\sin \\theta, 0]^{\\top}$ 和 $a_2 = [\\cos \\theta, -\\sin \\theta, 0]^{\\top}$ 给出。纤维弥散是通过每个纤维族 $i \\in \\{1, 2\\}$ 的广义结构张量来引入的：\n$$\nH_i = \\kappa_d I + (1 - 3 \\kappa_d) a_i \\otimes a_i\n$$\n这里，$I$ 是 $3 \\times 3$ 单位张量，$\\kappa_d \\in [0, 1/3]$ 是弥散参数，而 $a_i \\otimes a_i$ 表示外积。每个纤维族中的应变通过各向异性不变量 $I_{f,i} = \\mathrm{tr}(H_i \\bar{C})$ 来度量。假设纤维仅在受拉时承载，这通过 Macaulay 括号 $\\langle x \\rangle_+ = \\max(x, 0)$ 来建模。两个纤维族的应变能由下式给出：\n$$\nW_f = \\sum_{i=1}^{2} \\frac{k_1}{2 k_2} \\left( \\exp\\left(k_2 \\left\\langle I_{f,i} - 1 \\right\\rangle_+^2\\right) - 1 \\right)\n$$\n其中 $k_1  0$ 和 $k_2  0$ 是纤维刚度参数。总应变能 $W(F)$ 通过将 $W_m$ 和 $W_f$ 相加计算得出。整个计算被封装在一个函数中，该函数以 $F$ 和材料参数作为输入。\n\n下一步是计算第一 Piola–Kirchhoff 应力张量 $P$，它被定义为应变能相对于变形梯度的导数，$P = \\frac{\\partial W}{\\partial F}$。由于解析推导很繁琐，因此规定使用数值方法。我们使用对称中心差分格式和一个小步长 $h$ 来计算每个分量 $P_{iJ}$：\n$$\nP_{iJ} = \\frac{\\partial W}{\\partial F_{iJ}} \\approx \\frac{W(F + h E_{iJ}) - W(F - h E_{iJ})}{2h}\n$$\n其中 $E_{iJ}$ 是一个在 $(i, J)$ 位置为 $1$、其余位置为零的矩阵。每次计算完整的张量 $P$ 都需要对函数 $W(F)$ 进行 $2 \\times 3 \\times 3 = 18$ 次求值。\n\n随后，计算瞬时弹性模量，由四阶张量 $A_0$ 表示。该张量的分量定义为 $A_{0\\,iJkL} = \\frac{\\partial P_{iJ}}{\\partial F_{kL}}$。我们再次采用中心差分格式，这次应用于应力张量 $P$ 的分量：\n$$\nA_{0\\,iJkL} = \\frac{\\partial P_{iJ}}{\\partial F_{kL}} \\approx \\frac{P_{iJ}(F + h E_{kL}) - P_{iJ}(F - h E_{kL})}{2h}\n$$\n这是一个嵌套的数值微分，因为在扰动变形梯度 $F \\pm h E_{kL}$ 处对 $P$ 的每次求值都需要对 $W$ 函数进行一系列调用。计算完整的 $3 \\times 3 \\times 3 \\times 3$ 张量 $A_0$ 的计算量很大。\n\n最后阶段是稳定性分析。强椭圆性要求声学张量 $Q(n)$ 对于参考构型中的任何单位传播向量 $n$ 都是正定的。声学张量由缩并 $Q_{ik}(n) = A_{0\\,iJkL} n_J n_L$ 定义。如果 $Q(n)$ 不是正定的，则检测到强椭圆性丧失，这表明潜在的材料不稳定性。这种情况通常通过寻找一个负的行列式来检查，即 $\\det(Q(n))  0$。\n\n该分析针对简单剪切的特定加载情况 $F(\\gamma) = \\begin{bmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}$，以及一组预设的平面内传播方向 $n = [\\cos \\varphi, \\sin \\varphi, 0]^{\\top}$ 进行，其中 $\\varphi$ 在集合 $\\{0, \\pi/6, \\pi/3, \\pi/2, 2\\pi/3, 5\\pi/6\\}$ 中取值。对于每个测试案例，算法按以下步骤进行：\n1. 给定材料参数和剪切量 $\\gamma$，构建变形梯度 $F(\\gamma)$。\n2. 在此 $F$ 处数值计算弹性张量 $A_0$。\n3. 对于指定集合中的每个角度 $\\varphi$，构建向量 $n(\\varphi)$。\n4. 通过缩并 $A_{0\\,iJkL} n_J n_L$ 计算声学张量 $Q(n)$。\n5. 为了减轻可能影响 $Q$ 对称性的浮点运算带来的数值误差，我们使用显式对称化形式 $\\frac{1}{2}(Q + Q^{\\top})$ 来计算其行列式。\n6. 找到在所有测试方向 $\\varphi$ 上的最小行列式值。如果此最小值严格小于 $0$，则认为材料已丧失强椭圆性，结果为 `True`（不稳定）；否则，结果为 `False`（稳定）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It encapsulates all helper functions to be self-contained.\n    \"\"\"\n    \n    H_STEP = 1e-8\n\n    def macaulay(x):\n        \"\"\"Computes the Macaulay bracket max(x, 0).\"\"\"\n        return np.maximum(x, 0)\n\n    def compute_W(F, mu, kappa_b, k1, k2, kappa_d, a1, a2):\n        \"\"\"Computes the strain-energy density W for a given deformation gradient F.\"\"\"\n        J = np.linalg.det(F)\n        if J = 0:\n            return np.inf  # Unphysical deformation\n\n        C = F.T @ F\n        C_bar = J**(-2.0/3.0) * C\n        I1 = np.trace(C)\n\n        # Matrix contribution (compressible Neo-Hookean)\n        W_m = (mu / 2.0) * (I1 - 3.0) - mu * np.log(J) + (kappa_b / 2.0) * (np.log(J))**2\n\n        # Fiber contribution (GOH-type)\n        I_mat = np.identity(3)\n        H1 = kappa_d * I_mat + (1.0 - 3.0 * kappa_d) * np.outer(a1, a1)\n        H2 = kappa_d * I_mat + (1.0 - 3.0 * kappa_d) * np.outer(a2, a2)\n\n        I_f1 = np.trace(H1 @ C_bar)\n        I_f2 = np.trace(H2 @ C_bar)\n\n        term1 = macaulay(I_f1 - 1.0)**2\n        term2 = macaulay(I_f2 - 1.0)**2\n        \n        W_f1 = (k1 / (2.0 * k2)) * (np.exp(k2 * term1) - 1.0)\n        W_f2 = (k1 / (2.0 * k2)) * (np.exp(k2 * term2) - 1.0)\n        \n        W_f = W_f1 + W_f2\n\n        return W_m + W_f\n\n    def compute_P(F, mu, kappa_b, k1, k2, kappa_d, a1, a2):\n        \"\"\"Computes the first Piola-Kirchhoff stress tensor P by numerical differentiation of W.\"\"\"\n        P = np.zeros((3, 3))\n        params = (mu, kappa_b, k1, k2, kappa_d, a1, a2)\n        for i in range(3):\n            for j in range(3):\n                E_ij = np.zeros((3, 3))\n                E_ij[i, j] = 1.0\n                F_plus = F + H_STEP * E_ij\n                F_minus = F - H_STEP * E_ij\n                W_plus = compute_W(F_plus, *params)\n                W_minus = compute_W(F_minus, *params)\n                P[i, j] = (W_plus - W_minus) / (2.0 * H_STEP)\n        return P\n\n    def compute_A0(F, mu, kappa_b, k1, k2, kappa_d, a1, a2):\n        \"\"\"Computes the elasticity tensor A0 by numerical differentiation of P.\"\"\"\n        A0 = np.zeros((3, 3, 3, 3))\n        params = (mu, kappa_b, k1, k2, kappa_d, a1, a2)\n        for k in range(3):\n            for l in range(3):\n                E_kl = np.zeros((3, 3))\n                E_kl[k, l] = 1.0\n                F_plus = F + H_STEP * E_kl\n                F_minus = F - H_STEP * E_kl\n                P_plus = compute_P(F_plus, *params)\n                P_minus = compute_P(F_minus, *params)\n                A0[:, :, k, l] = (P_plus - P_minus) / (2.0 * H_STEP)\n        return A0\n\n    def check_instability(mu, kappa_b, k1, k2, kappa_d, theta, gamma):\n        \"\"\"Orchestrates the stability check for a given set of parameters.\"\"\"\n        params = (mu, kappa_b, k1, k2, kappa_d)\n        \n        a1 = np.array([np.cos(theta), np.sin(theta), 0.0])\n        a2 = np.array([np.cos(theta), -np.sin(theta), 0.0])\n        \n        F = np.array([[1.0, gamma, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])\n        \n        A0 = compute_A0(F, *params, a1, a2)\n        \n        phis = np.array([0.0, np.pi/6.0, np.pi/3.0, np.pi/2.0, 2.0*np.pi/3.0, 5.0*np.pi/6.0])\n        min_det = np.inf\n        \n        for phi in phis:\n            n = np.array([np.cos(phi), np.sin(phi), 0.0])\n            Q = np.einsum('iJkL,J,L-ik', A0, n, n)\n            Q_sym = 0.5 * (Q + Q.T)\n            det_Q = np.linalg.det(Q_sym)\n            min_det = min(min_det, det_Q)\n            \n        return min_det  0\n\n    test_cases = [\n        (10, 100, 50, 50, 0.05, np.pi/6, 0.5),\n        (5, 20, 200, 200, 0.01, np.pi/4, 1.2),\n        (10, 100, 100, 100, 0.2, np.pi/6, 0.0),\n        (5, 50, 400, 100, 0.0, np.pi/3, 2.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        mu, kappa_b, k1, k2, kappa_d, theta, gamma = case\n        result = check_instability(mu, kappa_b, k1, k2, kappa_d, theta, gamma)\n        results.append(result)\n\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n```"
        }
    ]
}