{
    "hands_on_practices": [
        {
            "introduction": "A foundational concept in microstructural modeling is the homogenization of microscopic features into a macroscopic constitutive law. This practice guides you through the analytical derivation of a material's effective stiffness tensor from a given fiber orientation distribution function (ODF) . By calculating the second and fourth orientation tensors, you will build a direct bridge between the statistical description of the microstructure and the macroscopic linear elastic response.",
            "id": "4191270",
            "problem": "Consider a fibrous soft tissue with an orthotropic fiber architecture embedded in a linear isotropic matrix, modeled under the small-strain kinematic assumption with affine fiber kinematics. Let the isotropic matrix be characterized by Lamé moduli $\\lambda$ and $\\mu$, so that the matrix strain energy density is $W_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{\\varepsilon}$ is the small strain tensor. Fibers are assumed to be linearly elastic, carrying only extensional stiffness along their local directions with a longitudinal modulus $E_{\\mathrm{f}}$ and overall fiber volume fraction $\\varphi$. Under the dilute/affine assumption, the fiber contribution to the strain energy density is the orientation average\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}\\right)^{2}\\right\\rangle,\n$$\nwhere $k_{\\mathrm{f}} = \\varphi E_{\\mathrm{f}}$, $\\mathbf{n}$ is a unit vector on the unit sphere, $\\langle\\cdot\\rangle$ denotes averaging with respect to an orientation distribution function (ODF) $\\rho(\\mathbf{n})$ on the unit sphere, and $\\int_{S^{2}}\\rho(\\mathbf{n})\\,\\mathrm{d}\\Omega = 1$. Assume the ODF is orthotropic and consists of six symmetric discrete directions aligned with an orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$:\n$$\n\\rho(\\mathbf{n}) \\;=\\; \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big],\n$$\nwith nonnegative weights $w_{p}\\ge 0$ satisfying $\\sum_{p=1}^{3} w_{p} = 1$, and where $\\delta(\\cdot)$ is the Dirac delta distribution on the unit sphere.\n\nStarting from the definitions of the second and fourth orientation tensors (moments),\n$$\n\\mathbf{A} \\;=\\; \\left\\langle \\mathbf{n}\\otimes\\mathbf{n}\\right\\rangle, \\qquad \\mathbb{A}^{(4)} \\;=\\; \\left\\langle \\mathbf{n}\\otimes\\mathbf{n}\\otimes\\mathbf{n}\\otimes\\mathbf{n}\\right\\rangle,\n$$\nderive the effective small-strain orthotropic stiffness tensor $\\mathbb{C}$ that relates the Cauchy stress $\\boldsymbol{\\sigma}$ and strain $\\boldsymbol{\\varepsilon}$ by $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}$, by superposing the matrix and fiber energies. Express $\\mathbb{C}$ explicitly in component form $\\mathbb{C}_{ijkl}$ in terms of the Kronecker delta $\\delta_{ij}$, the basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$, the weights $w_{1},w_{2},w_{3}$, and the moduli $\\lambda$, $\\mu$, and $k_{\\mathrm{f}}$. Your derivation must proceed from the given energy definitions and the ODF moments.\n\nProvide your final answer as a single closed-form analytic expression for $\\mathbb{C}_{ijkl}$ in index notation. No numerical evaluation is required. Do not include physical units in the final answer.",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The model presented is a standard formulation in the micromechanics of fiber-reinforced soft tissues. Therefore, the problem is valid, and we may proceed with the derivation.\n\nThe total strain energy density $W$ of the composite material is given by the superposition of the strain energy of the isotropic matrix, $W_{\\mathrm{m}}$, and the strain energy of the embedded fibers, $W_{\\mathrm{f}}$.\n$$\nW = W_{\\mathrm{m}} + W_{\\mathrm{f}}\n$$\nThe problem provides the expressions for these energy contributions. The matrix energy is:\n$$\nW_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}\n$$\nIn index notation, where $\\boldsymbol{\\varepsilon}$ is the small strain tensor with components $\\varepsilon_{ij}$, this is written as:\n$$\nW_{\\mathrm{m}} = \\tfrac{1}{2}\\lambda\\left(\\varepsilon_{kk}\\right)^{2} + \\mu\\,\\varepsilon_{ij}\\varepsilon_{ij}\n$$\nThe fiber energy contribution is given by the orientation average:\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}\\right)^{2}\\right\\rangle\n$$\nIn index notation, the term inside the average is $(\\mathbf{n}\\cdot\\boldsymbol{\\varepsilon}\\cdot\\mathbf{n}) = n_i \\varepsilon_{ij} n_j$. Therefore, the fiber energy is:\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle \\left(n_i \\varepsilon_{ij} n_j\\right)\\left(n_k \\varepsilon_{kl} n_l\\right) \\right\\rangle\n$$\nSince the strain tensor $\\boldsymbol{\\varepsilon}$ does not depend on the orientation vector $\\mathbf{n}$, its components can be moved outside the averaging operator:\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\,\\left\\langle n_i n_j n_k n_l \\right\\rangle \\varepsilon_{ij} \\varepsilon_{kl}\n$$\nThe term $\\left\\langle n_i n_j n_k n_l \\right\\rangle$ is, by definition, the component form of the fourth-order orientation tensor, $\\mathbb{A}^{(4)}_{ijkl}$.\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\left\\langle n_i n_j n_k n_l \\right\\rangle = \\int_{S^{2}} n_i n_j n_k n_l \\rho(\\mathbf{n}) \\,\\mathrm{d}\\Omega\n$$\nThus, the fiber energy can be expressed compactly as:\n$$\nW_{\\mathrm{f}} = \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\, \\mathbb{A}^{(4)}_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\nThe total strain energy density is the sum:\n$$\nW(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\left(\\varepsilon_{kk}\\right)^{2} + \\mu\\,\\varepsilon_{ij}\\varepsilon_{ij} + \\tfrac{1}{2}\\,k_{\\mathrm{f}}\\, \\mathbb{A}^{(4)}_{ijkl} \\varepsilon_{ij} \\varepsilon_{kl}\n$$\nFor a hyperelastic material under small strains, the Cauchy stress tensor $\\boldsymbol{\\sigma}$ is the first derivative of the strain energy density with respect to the strain tensor, $\\boldsymbol{\\sigma} = \\frac{\\partial W}{\\partial \\boldsymbol{\\varepsilon}}$. The fourth-order stiffness tensor $\\mathbb{C}$ is the second derivative, $\\mathbb{C} = \\frac{\\partial^2 W}{\\partial \\boldsymbol{\\varepsilon} \\partial \\boldsymbol{\\varepsilon}}$, which relates stress and strain linearly via $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}$. In component form, $\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$ and $\\mathbb{C}_{ijkl} = \\frac{\\partial^2 W}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}}$. For a quadratic strain energy function of the form $W = \\frac{1}{2} \\varepsilon_{ij} \\mathbb{C}_{ijkl} \\varepsilon_{kl}$ (assuming major and minor symmetries of $\\mathbb{C}$), the stiffness tensor components $\\mathbb{C}_{ijkl}$ can be directly identified.\n\nThe matrix energy corresponds to the standard linear isotropic stiffness tensor $\\mathbb{C}_{\\mathrm{m}}$. Its components are given by:\n$$\n\\mathbb{C}_{\\mathrm{m}, ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\nThe fiber energy contributes an additional stiffness tensor $\\mathbb{C}_{\\mathrm{f}}$. By inspection of the expression for $W_{\\mathrm{f}}$ and accounting for the symmetry of $\\varepsilon_{ij}$ and $\\varepsilon_{kl}$, the fiber stiffness contribution is:\n$$\n\\mathbb{C}_{\\mathrm{f}, ijkl} = k_{\\mathrm{f}} \\mathbb{A}^{(4)}_{ijkl}\n$$\nThe total effective stiffness tensor is the sum $\\mathbb{C} = \\mathbb{C}_{\\mathrm{m}} + \\mathbb{C}_{\\mathrm{f}}$.\n$$\n\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\mathbb{A}^{(4)}_{ijkl}\n$$\nOur remaining task is to compute the components $\\mathbb{A}^{(4)}_{ijkl}$ for the given orientation distribution function (ODF), $\\rho(\\mathbf{n})$.\nThe ODF is given as a sum of Dirac delta distributions:\n$$\n\\rho(\\mathbf{n}) \\;=\\; \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big]\n$$\nWe substitute this into the definition of $\\mathbb{A}^{(4)}_{ijkl}$:\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\int_{S^{2}} n_i n_j n_k n_l \\left( \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p}\\,\\Big[\\delta\\!\\left(\\mathbf{n}-\\mathbf{e}_{p}\\right) + \\delta\\!\\left(\\mathbf{n}+\\mathbf{e}_{p}\\right)\\Big] \\right) \\,\\mathrm{d}\\Omega\n$$\nUsing the linearity of the integral and the sifting property of the Dirac delta, $\\int f(\\mathbf{x})\\delta(\\mathbf{x}-\\mathbf{x}_0)\\mathrm{d}V = f(\\mathbf{x}_0)$:\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p} \\left[ (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l + (-e_{p})_i (-e_{p})_j (-e_{p})_k (-e_{p})_l \\right]\n$$\nwhere $(e_{p})_i$ denotes the $i$-th component of the basis vector $\\mathbf{e}_p$. Since $(-1)^4=1$, the two terms in the bracket are identical.\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\tfrac{1}{2}\\sum_{p=1}^{3} w_{p} \\left[ 2\\, (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l \\right] = \\sum_{p=1}^{3} w_{p} (e_{p})_i (e_{p})_j (e_{p})_k (e_{p})_l\n$$\nLet us adopt the notation $e_{pi}$ for the $i$-th component of the vector $\\mathbf{e}_p$. Then the fourth orientation tensor is:\n$$\n\\mathbb{A}^{(4)}_{ijkl} = \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl}\n$$\nFinally, we substitute this result into the expression for the total stiffness tensor $\\mathbb{C}_{ijkl}$. This yields the explicit component form of the orthotropic stiffness tensor in terms of the given parameters.\n$$\n\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\left( \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl} \\right)\n$$\nThis expression provides the complete description of the material's linear elastic response, combining the isotropic background matrix with the orthotropic fiber reinforcement defined by the discrete ODF.",
            "answer": "$$\n\\boxed{\\mathbb{C}_{ijkl} = \\lambda \\delta_{ij}\\delta_{kl} + \\mu(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) + k_{\\mathrm{f}} \\sum_{p=1}^{3} w_{p} e_{pi} e_{pj} e_{pk} e_{pl}}\n$$"
        },
        {
            "introduction": "While defining a model's mathematical form is the first step, a constitutive model is only useful once its parameters are calibrated against experimental data. This exercise tackles this crucial inverse problem by asking you to formulate a nonlinear least-squares fit for a Gasser-Ogden-Holzapfel (GOH) model . You will derive the analytical Jacobian of the stress residuals, a key ingredient for the efficient numerical algorithms used to identify material parameters from mechanical tests.",
            "id": "4191225",
            "problem": "Consider a thin, incompressible, hyperelastic soft tissue with one dispersed collagen fiber family modeled by the Gasser–Ogden–Holzapfel (GOH) formulation. The unit fiber direction in the reference configuration is $ \\mathbf{a}_0 = (\\cos \\theta_0, \\sin \\theta_0, 0) $ with $\\theta_0$ measured in radians. Assume the strain-energy density function is split into an isotropic matrix part and an anisotropic fiber part,\n$$\n\\psi = \\psi_{\\text{iso}} + \\psi_{\\text{aniso}},\n$$\nwith\n$$\n\\psi_{\\text{iso}} = \\frac{\\mu}{2} \\left(I_1 - 3\\right), \\qquad \\psi_{\\text{aniso}} = \\frac{k_1}{2 k_2} \\left[\\exp\\!\\left(k_2\\,E^2\\right) - 1\\right],\n$$\nwhere the first invariant $I_1 = \\text{tr}(\\mathbf{C})$ and the fiber invariant $I_4 = \\mathbf{a}_0 \\cdot \\mathbf{C}\\,\\mathbf{a}_0$ are defined in terms of the right Cauchy–Green tensor $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$, and the GOH dispersion coupling is\n$$\nE = \\kappa \\left(I_1 - 3\\right) + \\left(1 - 3 \\kappa\\right)\\left(I_4 - 1\\right),\n$$\nwith $0 \\le \\kappa \\le \\frac{1}{3}$. The parameters $(k_1, k_2, \\kappa)$ characterize the fiber contribution, and $\\mu$ is a known shear modulus obtained independently.\n\nTwo planar tests are performed under incompressibility ($J = 1$):\n- Uniaxial tension along direction $1$ at principal stretch state $ \\lambda_1 = \\lambda_u $, $ \\lambda_2 = \\lambda_3 = \\lambda_u^{-1/2} $ with lateral traction-free conditions ($\\sigma_{22} = \\sigma_{33} = 0$).\n- Equibiaxial tension in the $1$–$2$ plane at principal stretch state $ \\lambda_1 = \\lambda_2 = \\lambda_b $, $ \\lambda_3 = \\lambda_b^{-2} $ with $\\sigma_{33} = 0$.\n\nIn each test, the axial Cauchy stress is measured: let $s_u^{\\text{meas}}$ be the measured axial Cauchy stress in uniaxial tension and $s_b^{\\text{meas}}$ be the measured axial Cauchy stress in equibiaxial tension. For incompressible hyperelastic materials, principal Cauchy stress differences satisfy\n$$\n\\sigma_i - \\sigma_j = \\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i} - \\lambda_j \\frac{\\partial \\psi}{\\partial \\lambda_j}.\n$$\nWith lateral traction-free conditions, the axial stress equals the appropriate difference. Define the model-predicted axial stress in each test as\n$$\ns_u(\\lambda_u; k_1, k_2, \\kappa) = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2} \\quad \\text{at } (\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\lambda_u, \\lambda_u^{-1/2}, \\lambda_u^{-1/2}\\right),\n$$\n$$\ns_b(\\lambda_b; k_1, k_2, \\kappa) = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3} \\quad \\text{at } (\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\lambda_b, \\lambda_b, \\lambda_b^{-2}\\right).\n$$\n\nFormulate the nonlinear least squares problem to estimate $(k_1, k_2, \\kappa)$ from these two tests by minimizing the sum of squared residuals\n$$\nr_u = s_u(\\lambda_u; k_1, k_2, \\kappa) - s_u^{\\text{meas}}, \\qquad r_b = s_b(\\lambda_b; k_1, k_2, \\kappa) - s_b^{\\text{meas}}.\n$$\nDerive the analytical Jacobian matrix of the residual vector $\\mathbf{r} = \\begin{pmatrix} r_u \\\\ r_b \\end{pmatrix}$ with respect to the parameters $(k_1, k_2, \\kappa)$, evaluated at the specified stretch states, expressing your final result in terms of $\\lambda_u$, $\\lambda_b$, $\\theta_0$, $\\mu$, $k_1$, $k_2$, and $\\kappa$. Angles must be treated in radians. Stretches are dimensionless and stresses are in Pascals (SI units). The final answer must be a single closed-form symbolic expression for the Jacobian matrix.",
            "solution": "The user wants to find the Jacobian matrix for a nonlinear least squares problem in biomechanics. I have read the problem statement and this is my thought process for generating the solution.\n\n**1. Problem Validation**\nFirst, I will perform the mandatory validation of the problem statement.\n\n*   **Step 1: Extract Givens**\n    *   **Model:** Incompressible hyperelastic soft tissue with one dispersed collagen fiber family (GOH model).\n    *   **Strain-energy density function:** $\\psi = \\psi_{\\text{iso}} + \\psi_{\\text{aniso}}$.\n    *   **Isotropic part:** $\\psi_{\\text{iso}} = \\frac{\\mu}{2} (I_1 - 3)$.\n    *   **Anisotropic part:** $\\psi_{\\text{aniso}} = \\frac{k_1}{2 k_2} [\\exp(k_2 E^2) - 1]$.\n    *   **Dispersion coupling:** $E = \\kappa (I_1 - 3) + (1 - 3 \\kappa)(I_4 - 1)$.\n    *   **Invariants:** $I_1 = \\text{tr}(\\mathbf{C})$, $I_4 = \\mathbf{a}_0 \\cdot \\mathbf{C}\\,\\mathbf{a}_0$, with $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$ and $\\mathbf{a}_0 = (\\cos \\theta_0, \\sin \\theta_0, 0)$.\n    *   **Parameters:** To be estimated $(k_1, k_2, \\kappa)$, with $0 \\le \\kappa \\le \\frac{1}{3}$. $\\mu$ is known.\n    *   **Uniaxial test:** Stretches $(\\lambda_u, \\lambda_u^{-1/2}, \\lambda_u^{-1/2})$. Measured stress $s_u^{\\text{meas}}$. Model stress $s_u = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2}$.\n    *   **Equibiaxial test:** Stretches $(\\lambda_b, \\lambda_b, \\lambda_b^{-2})$. Measured stress $s_b^{\\text{meas}}$. Model stress $s_b = \\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} - \\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3}$.\n    *   **Residuals:** $r_u = s_u - s_u^{\\text{meas}}$, $r_b = s_b - s_b^{\\text{meas}}$.\n    *   **Task:** Derive the Jacobian matrix $\\mathbf{J} = \\frac{\\partial \\mathbf{r}}{\\partial(k_1, k_2, \\kappa)}$ where $\\mathbf{r} = (r_u, r_b)^\\top$.\n\n*   **Step 2: Validate Using Extracted Givens**\n    *   **Scientific Grounding:** The problem is based on the Gasser–Ogden–Holzapfel (GOH) model, a widely recognized and well-established constitutive law in the biomechanics of soft tissues. All concepts used (hyperelasticity, strain invariants, Cauchy stress) are fundamental principles of continuum mechanics. The problem is scientifically sound.\n    *   **Well-Posedness:** The task is to derive the Jacobian of a residual vector, which is a standard and well-defined mathematical procedure in optimization and parameter estimation. All necessary functions and variables are provided. The problem is well-posed.\n    *   **Objectivity:** The problem is stated in precise, formal mathematical language, free from any subjectivity or ambiguity.\n\n*   **Step 3: Verdict and Action**\n    *   The problem is valid. It is scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or unsound premises. I will now proceed to derive the solution.\n\n**2. Solution Derivation**\n\nThe objective is to compute the Jacobian matrix $\\mathbf{J}$ of the residual vector $\\mathbf{r} = \\begin{pmatrix} r_u \\\\ r_b \\end{pmatrix}$ with respect to the parameters $\\mathbf{p} = (k_1, k_2, \\kappa)$. The components of the Jacobian are given by $J_{ij} = \\frac{\\partial r_i}{\\partial p_j}$. Since the measured stresses $s_u^{\\text{meas}}$ and $s_b^{\\text{meas}}$ are constants, the Jacobian is $\\mathbf{J} = \\frac{\\partial(s_u, s_b)}{\\partial(k_1, k_2, \\kappa)}$.\n\nFirst, we express the strain energy density function $\\psi$ and the stresses in terms of principal stretches $\\lambda_1, \\lambda_2, \\lambda_3$. The right Cauchy-Green tensor $\\mathbf{C}$ is diagonal in the principal basis, $\\mathbf{C} = \\text{diag}(\\lambda_1^2, \\lambda_2^2, \\lambda_3^2)$. The invariants are:\n$I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$\n$I_4 = \\mathbf{a}_0 \\cdot \\mathbf{C}\\,\\mathbf{a}_0 = \\lambda_1^2 \\cos^2\\theta_0 + \\lambda_2^2 \\sin^2\\theta_0$\n\nThe Cauchy stress difference is $\\sigma_i - \\sigma_j = \\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i} - \\lambda_j \\frac{\\partial \\psi}{\\partial \\lambda_j}$. We need the terms $\\lambda_i \\frac{\\partial \\psi}{\\partial \\lambda_i}$.\nFor the isotropic part: $\\lambda_i \\frac{\\partial \\psi_{\\text{iso}}}{\\partial \\lambda_i} = \\lambda_i \\frac{\\mu}{2} \\frac{\\partial I_1}{\\partial \\lambda_i} = \\lambda_i \\frac{\\mu}{2} (2\\lambda_i) = \\mu \\lambda_i^2$.\nFor the anisotropic part, we use the chain rule:\n$\\frac{\\partial \\psi_{\\text{aniso}}}{\\partial \\lambda_i} = \\frac{\\partial \\psi_{\\text{aniso}}}{\\partial E} \\frac{\\partial E}{\\partial \\lambda_i}$\n$\\frac{\\partial \\psi_{\\text{aniso}}}{\\partial E} = \\frac{k_1}{2k_2} \\exp(k_2 E^2) (2k_2 E) = k_1 E \\exp(k_2 E^2)$\n$\\frac{\\partial E}{\\partial \\lambda_i} = \\kappa \\frac{\\partial I_1}{\\partial \\lambda_i} + (1-3\\kappa) \\frac{\\partial I_4}{\\partial \\lambda_i} = 2\\lambda_i \\kappa + (1-3\\kappa) \\frac{\\partial I_4}{\\partial \\lambda_i}$\n\nThe anisotropic stress contribution is:\n$\\lambda_i \\frac{\\partial \\psi_{\\text{aniso}}}{\\partial \\lambda_i} = k_1 E \\exp(k_2 E^2) \\lambda_i \\left[ 2\\lambda_i \\kappa + (1-3\\kappa) \\frac{\\partial I_4}{\\partial \\lambda_i} \\right]$\n$= 2 k_1 E \\exp(k_2 E^2) \\left[\\kappa \\lambda_i^2 + \\frac{1-3\\kappa}{2} \\lambda_i \\frac{\\partial I_4}{\\partial \\lambda_i} \\right]$\n\nLet's define a factor $S_{\\text{aniso}} = k_1 E \\exp(k_2 E^2)$. The principal stress contributions are:\n$\\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1} = \\mu \\lambda_1^2 + 2 S_{\\text{aniso}} [\\kappa\\lambda_1^2 + (1-3\\kappa)\\lambda_1^2\\cos^2\\theta_0] = \\mu \\lambda_1^2 + 2\\lambda_1^2 S_{\\text{aniso}}[\\kappa + (1-3\\kappa)\\cos^2\\theta_0]$\n$\\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2} = \\mu \\lambda_2^2 + 2 S_{\\text{aniso}} [\\kappa\\lambda_2^2 + (1-3\\kappa)\\lambda_2^2\\sin^2\\theta_0] = \\mu \\lambda_2^2 + 2\\lambda_2^2 S_{\\text{aniso}}[\\kappa + (1-3\\kappa)\\sin^2\\theta_0]$\n$\\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3} = \\mu \\lambda_3^2 + 2 S_{\\text{aniso}} [\\kappa\\lambda_3^2] = \\mu \\lambda_3^2 + 2\\kappa\\lambda_3^2 S_{\\text{aniso}}$\n\nThe model-predicted stresses $s_u$ and $s_b$ are of the form $s = s_{\\text{iso}} + s_{\\text{aniso}}$. The isotropic part $s_{\\text{iso}}$ is independent of $(k_1, k_2, \\kappa)$, so its derivatives are zero. We only need to differentiate the anisotropic part.\nLet $s_{\\text{aniso}} = 2 A \\cdot S_{\\text{aniso}} = 2 A k_1 E \\exp(k_2 E^2)$, where $A$ and $E$ are geometric quantities specific to each test.\n\n**Derivatives with respect to parameters:**\n1.  $\\frac{\\partial s_{\\text{aniso}}}{\\partial k_1} = 2 A E \\exp(k_2 E^2)$.\n2.  $\\frac{\\partial s_{\\text{aniso}}}{\\partial k_2} = 2 A k_1 E \\frac{\\partial}{\\partial k_2}(\\exp(k_2 E^2)) = 2 A k_1 E \\exp(k_2 E^2) E^2 = 2 k_1 A E^3 \\exp(k_2 E^2)$.\n3.  $\\frac{\\partial s_{\\text{aniso}}}{\\partial \\kappa} = \\frac{\\partial}{\\partial \\kappa} [2 k_1 A(\\kappa) E(\\kappa) \\exp(k_2 E(\\kappa)^2)]$. Since $A$ and $E$ depend on $\\kappa$, we use the product and chain rules:\n    $\\frac{\\partial s_{\\text{aniso}}}{\\partial \\kappa} = 2 k_1 \\left[ \\frac{\\partial A}{\\partial \\kappa} E \\exp(k_2 E^2) + A \\frac{\\partial}{\\partial \\kappa} (E \\exp(k_2 E^2)) \\right]$\n    $= 2 k_1 \\left[ \\frac{\\partial A}{\\partial \\kappa} E \\exp(k_2 E^2) + A \\left( \\frac{\\partial E}{\\partial \\kappa}\\exp(k_2 E^2) + E \\exp(k_2 E^2)(2 k_2 E \\frac{\\partial E}{\\partial \\kappa}) \\right) \\right]$\n    $= 2 k_1 \\exp(k_2 E^2) \\left[ \\frac{\\partial A}{\\partial \\kappa} E + A \\frac{\\partial E}{\\partial \\kappa} (1 + 2 k_2 E^2) \\right]$.\n\nNow, we instantiate these general formulas for the uniaxial and equibiaxial cases.\n\n**Uniaxial Case (subscript $u$):**\n-   Stretches: $(\\lambda_u, \\lambda_u^{-1/2}, \\lambda_u^{-1/2})$.\n-   Invariants: $I_{1,u} = \\lambda_u^2 + 2\\lambda_u^{-1}$, $I_{4,u} = \\lambda_u^2 \\cos^2\\theta_0 + \\lambda_u^{-1} \\sin^2\\theta_0$.\n-   $E_u = \\kappa(I_{1,u}-3) + (1-3\\kappa)(I_{4,u}-1)$.\n-   The stress is $s_u = (\\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1})_u - (\\lambda_2 \\frac{\\partial \\psi}{\\partial \\lambda_2})_u$.\n-   The anisotropic stress part corresponds to a coefficient $A_u$:\n    $A_u = \\lambda_u^2(\\kappa + (1-3\\kappa)\\cos^2\\theta_0) - \\lambda_u^{-1}(\\kappa + (1-3\\kappa)\\sin^2\\theta_0)$.\n-   Derivatives with respect to $\\kappa$:\n    $\\frac{\\partial E_u}{\\partial \\kappa} = (I_{1,u}-3) - 3(I_{4,u}-1) = I_{1,u} - 3I_{4,u} = (\\lambda_u^2 + 2\\lambda_u^{-1}) - 3(\\lambda_u^2\\cos^2\\theta_0 + \\lambda_u^{-1}\\sin^2\\theta_0)$.\n    $\\frac{\\partial A_u}{\\partial \\kappa} = \\lambda_u^2(1 - 3\\cos^2\\theta_0) - \\lambda_u^{-1}(1 - 3\\sin^2\\theta_0)$.\n\n**Equibiaxial Case (subscript $b$):**\n-   Stretches: $(\\lambda_b, \\lambda_b, \\lambda_b^{-2})$.\n-   Invariants: $I_{1,b} = 2\\lambda_b^2 + \\lambda_b^{-4}$, $I_{4,b} = \\lambda_b^2 \\cos^2\\theta_0 + \\lambda_b^2 \\sin^2\\theta_0 = \\lambda_b^2$.\n-   $E_b = \\kappa(I_{1,b}-3) + (1-3\\kappa)(I_{4,b}-1)$.\n-   The stress is $s_b = (\\lambda_1 \\frac{\\partial \\psi}{\\partial \\lambda_1})_b - (\\lambda_3 \\frac{\\partial \\psi}{\\partial \\lambda_3})_b$.\n-   The anisotropic stress part corresponds to a coefficient $A_b$:\n    $A_b = \\lambda_b^2(\\kappa + (1-3\\kappa)\\cos^2\\theta_0) - \\kappa\\lambda_b^{-4}$.\n-   Derivatives with respect to $\\kappa$:\n    $\\frac{\\partial E_b}{\\partial \\kappa} = (I_{1,b}-3) - 3(I_{4,b}-1) = I_{1,b} - 3I_{4,b} = (2\\lambda_b^2 + \\lambda_b^{-4}) - 3\\lambda_b^2 = \\lambda_b^{-4} - \\lambda_b^2$.\n    $\\frac{\\partial A_b}{\\partial \\kappa} = \\lambda_b^2(1 - 3\\cos^2\\theta_0) - \\lambda_b^{-4}$.\n\n**Jacobian Matrix Assembly:**\nThe Jacobian matrix $\\mathbf{J}$ is a $2 \\times 3$ matrix where $J_{1j} = \\frac{\\partial s_u}{\\partial p_j}$ and $J_{2j} = \\frac{\\partial s_b}{\\partial p_j}$. Note that the parameter $\\mu$ does not appear in the derivatives with respect to $(k_1, k_2, \\kappa)$.\n\nThe components are:\n$J_{11} = \\frac{\\partial s_u}{\\partial k_1} = 2 A_u E_u \\exp(k_2 E_u^2)$\n$J_{12} = \\frac{\\partial s_u}{\\partial k_2} = 2 k_1 A_u E_u^3 \\exp(k_2 E_u^2)$\n$J_{13} = \\frac{\\partial s_u}{\\partial \\kappa} = 2 k_1 \\exp(k_2 E_u^2) \\left[ \\frac{\\partial A_u}{\\partial \\kappa} E_u + A_u \\frac{\\partial E_u}{\\partial \\kappa} (1 + 2 k_2 E_u^2) \\right]$\n\n$J_{21} = \\frac{\\partial s_b}{\\partial k_1} = 2 A_b E_b \\exp(k_2 E_b^2)$\n$J_{22} = \\frac{\\partial s_b}{\\partial k_2} = 2 k_1 A_b E_b^3 \\exp(k_2 E_b^2)$\n$J_{23} = \\frac{\\partial s_b}{\\partial \\kappa} = 2 k_1 \\exp(k_2 E_b^2) \\left[ \\frac{\\partial A_b}{\\partial \\kappa} E_b + A_b \\frac{\\partial E_b}{\\partial \\kappa} (1 + 2 k_2 E_b^2) \\right]$\n\nTo present the final answer, we define the following intermediate quantities:\n- For the uniaxial test:\n  $I_{1,u} = \\lambda_u^2 + 2\\lambda_u^{-1}$\n  $I_{4,u} = \\lambda_u^2 \\cos^2\\theta_0 + \\lambda_u^{-1} \\sin^2\\theta_0$\n  $E_u = \\kappa(I_{1,u}-3) + (1-3\\kappa)(I_{4,u}-1)$\n  $A_u = \\lambda_u^2(\\kappa + (1-3\\kappa)\\cos^2\\theta_0) - \\lambda_u^{-1}(\\kappa + (1-3\\kappa)\\sin^2\\theta_0)$\n  $E'_{u,\\kappa} = \\frac{\\partial E_u}{\\partial \\kappa} = I_{1,u} - 3I_{4,u}$\n  $A'_{u,\\kappa} = \\frac{\\partial A_u}{\\partial \\kappa} = \\lambda_u^2(1 - 3\\cos^2\\theta_0) - \\lambda_u^{-1}(1 - 3\\sin^2\\theta_0)$\n\n- For the equibiaxial test:\n  $I_{1,b} = 2\\lambda_b^2 + \\lambda_b^{-4}$\n  $I_{4,b} = \\lambda_b^2$\n  $E_b = \\kappa(I_{1,b}-3) + (1-3\\kappa)(I_{4,b}-1)$\n  $A_b = \\lambda_b^2(\\kappa + (1-3\\kappa)\\cos^2\\theta_0) - \\kappa\\lambda_b^{-4}$\n  $E'_{b,\\kappa} = \\frac{\\partial E_b}{\\partial \\kappa} = I_{1,b} - 3I_{4,b} = \\lambda_b^{-4} - \\lambda_b^2$\n  $A'_{b,\\kappa} = \\frac{\\partial A_b}{\\partial \\kappa} = \\lambda_b^2(1 - 3\\cos^2\\theta_0) - \\lambda_b^{-4}$\n\nUsing these definitions, the Jacobian matrix is provided in the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 A_u E_u \\exp(k_2 E_u^2) & 2 k_1 A_u E_u^3 \\exp(k_2 E_u^2) & 2 k_1 \\exp(k_2 E_u^2) [A'_{u,\\kappa} E_u + A_u E'_{u,\\kappa} (1 + 2 k_2 E_u^2)] \\\\\n2 A_b E_b \\exp(k_2 E_b^2) & 2 k_1 A_b E_b^3 \\exp(k_2 E_b^2) & 2 k_1 \\exp(k_2 E_b^2) [A'_{b,\\kappa} E_b + A_b E'_{b,\\kappa} (1 + 2 k_2 E_b^2)]\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Most orientation integrals in fiber dispersion models are too complex to be solved analytically, necessitating the use of numerical quadrature schemes. This practice provides a valuable opportunity to both derive an exact analytical solution for a special case and implement a numerical approximation using a Lebedev grid . By comparing the numerical result to the exact one, you will directly quantify the quadrature error and understand the trade-offs involved in choosing the number of integration points.",
            "id": "4191275",
            "problem": "Consider a fiber-reinforced hyperelastic material with an isotropic orientation distribution of fibers on the unit sphere. Let the fiber direction be denoted by the unit vector $\\mathbf{a} \\in \\mathbb{R}^3$ with $\\|\\mathbf{a}\\|=1$, the right Cauchy–Green deformation tensor be $\\mathbf{C} \\in \\mathbb{R}^{3 \\times 3}$, and let the fiber stretch be defined by $\\lambda_f^2 = \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}$. The strain-energy density per fiber is prescribed by\n$$\nw(\\lambda_f) = \\frac{k}{2}\\left(\\lambda_f^2 - 1\\right)^2 = \\frac{k}{2}\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2,\n$$\nwhere $k$ is a positive material parameter. The total strain-energy density is given by the orientation average\n$$\nW(\\mathbf{C}) = \\int_{\\mathbb{S}^2} \\rho(\\mathbf{a})\\, w(\\lambda_f(\\mathbf{a}))\\, \\mathrm{d}\\Omega, \\quad \\rho(\\mathbf{a}) = \\frac{1}{4\\pi},\n$$\nwhere $\\mathbb{S}^2$ denotes the unit sphere and $\\mathrm{d}\\Omega$ is the surface measure. The Second Piola–Kirchhoff stress (SPK) is obtained from hyperelasticity as\n$$\n\\mathbf{S}(\\mathbf{C}) = 2\\,\\frac{\\partial W}{\\partial \\mathbf{C}}.\n$$\n\nTask A (derivation): Starting from the above definitions and using tensor calculus and isotropic spherical averages, derive a closed-form expression for $\\mathbf{S}(\\mathbf{C})$ expressed in terms of $\\mathbf{C}$, its trace $\\mathrm{tr}(\\mathbf{C})$, the identity tensor $\\mathbf{I}$, and the parameter $k$.\n\nTask B (numerical quadrature and error quantification): To approximate the orientation integral, use a Lebedev grid of size $N$ points on $\\mathbb{S}^2$ with associated positive weights $\\{(\\mathbf{a}_i, w_i)\\}_{i=1}^N$ that exactly integrate spherical polynomials up to a certain degree. For a given $\\mathbf{C}$ and $k$, approximate the stress by\n$$\n\\mathbf{S}_N(\\mathbf{C}) = 2\\,\\frac{1}{4\\pi}\\sum_{i=1}^N w_i\\,\\frac{\\partial}{\\partial \\mathbf{C}}\\left[\\frac{k}{2}\\left(\\mathbf{a}_i^\\top \\mathbf{C}\\,\\mathbf{a}_i - 1\\right)^2\\right].\n$$\nDefine the relative quadrature error using the Frobenius norm by\n$$\ne_N = \\frac{\\|\\mathbf{S}_N(\\mathbf{C}) - \\mathbf{S}(\\mathbf{C})\\|_F}{\\|\\mathbf{S}(\\mathbf{C})\\|_F}.\n$$\nIf $\\|\\mathbf{S}(\\mathbf{C})\\|_F < 10^{-12}$ and $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F < 10^{-12}$, set $e_N = 0$. If $\\|\\mathbf{S}(\\mathbf{C})\\|_F < 10^{-12}$ but $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F \\ge 10^{-12}$, set $e_N = +\\infty$.\n\nYou must implement a program that, for each test case specified below, computes $e_N$ for a set of Lebedev grids of sizes $N \\in \\{6, 14\\}$ and determines the minimal $N$ such that $e_N < 0.01$ (i.e., a relative error below $1\\%$). If neither grid achieves the target, return the integer $-1$ for that test case.\n\nAll quantities in this problem are dimensionless and must be treated as such; no physical units are involved. Angles are not part of the input. Your numerical implementation must use the Lebedev grids defined by:\n- $N = 6$: the octahedral set with points at $\\mathbf{a} = (\\pm 1, 0, 0)$, $(0, \\pm 1, 0)$, $(0, 0, \\pm 1)$ and equal weights $w_i = \\frac{4\\pi}{6}$.\n- $N = 14$: the union of the $6$ axis points above, each with weight $w_a = \\frac{4\\pi}{15}$, and the $8$ cube-corner points $\\mathbf{a} = \\left(\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}}\\right)$ with weight $w_c = \\frac{3\\pi}{10}$.\n\nFor the test suite, use three cases with diagonal deformation gradients and corresponding right Cauchy–Green tensors:\n- Case 1 (general anisotropic, happy path): $k = 2.0$, $\\mathbf{F} = \\mathrm{diag}(1.2, 0.9, \\lambda_3)$ with $\\lambda_3 = \\frac{1}{1.2 \\cdot 0.9}$; set $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$.\n- Case 2 (near-identity, boundary-like): $k = 5.0$, $\\mathbf{F} = \\mathrm{diag}(1.01, 0.99, \\lambda_3)$ with $\\lambda_3 = \\frac{1}{1.01 \\cdot 0.99}$; set $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$.\n- Case 3 (strong anisotropy, edge tendency): $k = 1.0$, $\\mathbf{F} = \\mathrm{diag}(1.6, 0.85, \\lambda_3)$ with $\\lambda_3 = \\frac{1}{1.6 \\cdot 0.85}$; set $\\mathbf{C} = \\mathbf{F}^\\top \\mathbf{F}$.\n\nYour program must:\n- Derive and use the closed-form $\\mathbf{S}(\\mathbf{C})$ for the exact reference.\n- Construct the Lebedev grids as specified for $N = 6$ and $N = 14$.\n- Compute $e_N$ for each $N$ and each test case.\n- Determine the minimal $N$ that satisfies $e_N < 0.01$ for each test case, or return $-1$ if not achieved.\n\nFinal output format: Your program should produce a single line of output containing the minimal grid sizes for the three test cases as a comma-separated list enclosed in square brackets, for example, $[6,14,-1]$. Each entry must be an integer. No extra text should be printed.",
            "solution": "The problem is evaluated as valid, as it is scientifically grounded in continuum mechanics, well-posed, and all necessary information for both analytical derivation and numerical implementation is provided.\n\nThe solution is presented in two parts as requested. Part A details the analytical derivation of the Second Piola-Kirchhoff stress tensor. Part B describes the numerical scheme based on Lebedev quadrature and the procedure for error quantification.\n\n### Part A: Analytical Derivation of the Second Piola-Kirchhoff Stress\n\nThe total strain-energy density $W(\\mathbf{C})$ is obtained by averaging the fiber strain energy $w(\\lambda_f)$ over all possible fiber orientations $\\mathbf{a}$ on the unit sphere $\\mathbb{S}^2$. With a uniform orientation density $\\rho(\\mathbf{a}) = 1/(4\\pi)$, this is:\n$$\nW(\\mathbf{C}) = \\frac{1}{4\\pi} \\int_{\\mathbb{S}^2} w(\\lambda_f(\\mathbf{a}))\\, \\mathrm{d}\\Omega\n$$\nThe specific fiber strain-energy function is given by:\n$$\nw(\\lambda_f) = \\frac{k}{2}\\left(\\lambda_f^2 - 1\\right)^2 = \\frac{k}{2}\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2\n$$\nSubstituting this into the integral for $W(\\mathbf{C})$ yields:\n$$\nW(\\mathbf{C}) = \\frac{k}{8\\pi} \\int_{\\mathbb{S}^2} \\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1\\right)^2\\, \\mathrm{d}\\Omega\n$$\nTo derive a closed-form expression, we first expand the integrand and express the orientation average, denoted by $\\langle \\cdot \\rangle = \\frac{1}{4\\pi} \\int_{\\mathbb{S}^2} (\\cdot) \\, \\mathrm{d}\\Omega$, in terms of the invariants of the tensor $\\mathbf{C}$.\n$$\nW(\\mathbf{C}) = \\frac{k}{2} \\left\\langle \\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}\\right)^2 - 2\\left(\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a}\\right) + 1 \\right\\rangle = \\frac{k}{2} \\left( \\left\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\right\\rangle - 2\\left\\langle \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} \\right\\rangle + 1 \\right)\n$$\nWe use the following standard results for isotropic averages of functions of a unit vector $\\mathbf{a}$:\n\\begin{enumerate}\n    \\item $\\langle \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\frac{1}{3}\\mathbf{I}$\n    \\item $\\langle \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\otimes \\mathbf{a} \\rangle = \\frac{1}{15}(\\mathbf{I} \\overline{\\otimes} \\mathbf{I} + \\mathbb{T})$ where, in index notation, $(\\mathbf{I} \\overline{\\otimes} \\mathbf{I})_{ijkl} = \\delta_{ij}\\delta_{kl}$ and $\\mathbb{T}_{ijkl} = \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}$.\n\\end{enumerate}\nThe first average term is:\n$$\n\\langle \\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} \\rangle = \\langle C_{ij} a_i a_j \\rangle = C_{ij} \\langle a_i a_j \\rangle = C_{ij} \\frac{1}{3}\\delta_{ij} = \\frac{1}{3}C_{ii} = \\frac{1}{3}\\mathrm{tr}(\\mathbf{C})\n$$\nThe second average term is:\n$$\n\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\rangle = \\langle (C_{ij} a_i a_j)(C_{kl} a_k a_l) \\rangle = C_{ij} C_{kl} \\langle a_i a_j a_k a_l \\rangle\n$$\nUsing the fourth-order average result:\n$$\n\\langle a_i a_j a_k a_l \\rangle = \\frac{1}{15}(\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\nThe term becomes:\n$$\nC_{ij} C_{kl} \\frac{1}{15}(\\delta_{ij}\\delta_{kl} + \\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) = \\frac{1}{15} \\left( (C_{ij}\\delta_{ij})(C_{kl}\\delta_{kl}) + C_{ij}C_{kl}\\delta_{ik}\\delta_{jl} + C_{ij}C_{kl}\\delta_{il}\\delta_{jk} \\right)\n$$\nRecognizing that $C_{ij}\\delta_{ij} = \\mathrm{tr}(\\mathbf{C})$, $C_{ij}C_{kl}\\delta_{ik}\\delta_{jl} = C_{kj}C_{kl} = \\mathrm{tr}(\\mathbf{C}^\\top\\mathbf{C}) = \\mathrm{tr}(\\mathbf{C}^2)$ since $\\mathbf{C}$ is symmetric, and similarly $C_{ij}C_{kl}\\delta_{il}\\delta_{jk} = C_{lj}C_{jk} = \\mathrm{tr}(\\mathbf{C}^2)$, we get:\n$$\n\\langle (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a})^2 \\rangle = \\frac{1}{15} \\left( (\\mathrm{tr}(\\mathbf{C}))^2 + 2\\,\\mathrm{tr}(\\mathbf{C}^2) \\right)\n$$\nSubstituting these back into the expression for $W(\\mathbf{C})$:\n$$\nW(\\mathbf{C}) = \\frac{k}{2} \\left[ \\frac{1}{15}\\left( (\\mathrm{tr}(\\mathbf{C}))^2 + 2\\,\\mathrm{tr}(\\mathbf{C}^2) \\right) - \\frac{2}{3}\\mathrm{tr}(\\mathbf{C}) + 1 \\right]\n$$\nThe Second Piola-Kirchhoff (SPK) stress $\\mathbf{S}$ is derived from $W$ as $\\mathbf{S} = 2\\,\\frac{\\partial W}{\\partial \\mathbf{C}}$. We need the following derivatives of tensor invariants with respect to a symmetric tensor $\\mathbf{C}$:\n$$\n\\frac{\\partial \\mathrm{tr}(\\mathbf{C})}{\\partial \\mathbf{C}} = \\mathbf{I}, \\quad \\frac{\\partial (\\mathrm{tr}(\\mathbf{C}))^2}{\\partial \\mathbf{C}} = 2\\,\\mathrm{tr}(\\mathbf{C})\\,\\mathbf{I}, \\quad \\frac{\\partial \\mathrm{tr}(\\mathbf{C}^2)}{\\partial \\mathbf{C}} = 2\\mathbf{C}\n$$\nApplying these to $W(\\mathbf{C})$:\n$$\n\\mathbf{S}(\\mathbf{C}) = 2 \\cdot \\frac{k}{2} \\frac{\\partial}{\\partial \\mathbf{C}} \\left[ \\frac{1}{15}\\left( (\\mathrm{tr}(\\mathbf{C}))^2 + 2\\,\\mathrm{tr}(\\mathbf{C}^2) \\right) - \\frac{2}{3}\\mathrm{tr}(\\mathbf{C}) + 1 \\right]\n$$\n$$\n\\mathbf{S}(\\mathbf{C}) = k \\left[ \\frac{1}{15}\\left( 2\\,\\mathrm{tr}(\\mathbf{C})\\,\\mathbf{I} + 2(2\\mathbf{C}) \\right) - \\frac{2}{3}\\mathbf{I} \\right]\n$$\n$$\n\\mathbf{S}(\\mathbf{C}) = k \\left[ \\frac{2}{15}\\mathrm{tr}(\\mathbf{C})\\,\\mathbf{I} + \\frac{4}{15}\\mathbf{C} - \\frac{10}{15}\\mathbf{I} \\right]\n$$\nFactoring out the common terms gives the final closed-form expression for the SPK stress tensor:\n$$\n\\mathbf{S}(\\mathbf{C}) = \\frac{2k}{15} \\left[ 2\\mathbf{C} + (\\mathrm{tr}(\\mathbf{C}) - 5)\\mathbf{I} \\right]\n$$\n\n### Part B: Numerical Quadrature and Error Quantification\n\nThe analytical integration is approximated using a numerical quadrature rule on the sphere. A Lebedev grid of size $N$ consists of $N$ points $\\mathbf{a}_i$ and associated weights $w_i$. The integral for the stress tensor is approximated by a weighted sum. Starting from the definition $\\mathbf{S} = 2\\,\\partial W / \\partial \\mathbf{C}$ and differentiating before integrating:\n$$\n\\mathbf{S}(\\mathbf{C}) = 2\\,\\frac{\\partial}{\\partial \\mathbf{C}} \\left[ \\frac{k}{8\\pi} \\int_{\\mathbb{S}^2} (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1)^2 \\, \\mathrm{d}\\Omega \\right] = \\frac{k}{2\\pi} \\int_{\\mathbb{S}^2} (\\mathbf{a}^\\top \\mathbf{C}\\,\\mathbf{a} - 1)(\\mathbf{a} \\otimes \\mathbf{a}) \\, \\mathrm{d}\\Omega\n$$\nThe numerical approximation $\\mathbf{S}_N(\\mathbf{C})$ replaces the integral with a sum over the $N$ quadrature points:\n$$\n\\mathbf{S}_N(\\mathbf{C}) = \\frac{k}{2\\pi} \\sum_{i=1}^N w_i (\\mathbf{a}_i^\\top \\mathbf{C}\\,\\mathbf{a}_i - 1) (\\mathbf{a}_i \\otimes \\mathbf{a}_i)\n$$\nThe problem specifies two Lebedev grids: one with $N=6$ points (vertices of an octahedron) and equal weights $w_i = 4\\pi/6$, and another with $N=14$ points (vertices of a cuboctahedron) with two sets of weights.\n\nThe relative error $e_N$ of the numerical approximation is quantified using the Frobenius norm $\\|\\cdot\\|_F$:\n$$\ne_N = \\frac{\\|\\mathbf{S}_N(\\mathbf{C}) - \\mathbf{S}(\\mathbf{C})\\|_F}{\\|\\mathbf{S}(\\mathbf{C})\\|_F}\n$$\nSpecial conditions are defined for near-zero stress states: if $\\|\\mathbf{S}(\\mathbf{C})\\|_F < 10^{-12}$, then $e_N$ is $0$ if $\\|\\mathbf{S}_N(\\mathbf{C})\\|_F < 10^{-12}$, and $\\infty$ otherwise.\n\nThe implementation will proceed as follows for each test case:\n\\begin{enumerate}\n    \\item Given the diagonal deformation gradient $\\mathbf{F} = \\mathrm{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$, compute the right Cauchy-Green tensor $\\mathbf{C} = \\mathbf{F}^\\top\\mathbf{F} = \\mathrm{diag}(\\lambda_1^2, \\lambda_2^2, \\lambda_3^2)$.\n    \\item Compute the exact stress tensor $\\mathbf{S}(\\mathbf{C})$ using the derived analytical formula.\n    \\item Iterate through the specified grid sizes $N \\in \\{6, 14\\}$. For each $N$:\n    \\begin{enumerate}\n        \\item Compute the approximate stress tensor $\\mathbf{S}_N(\\mathbf{C})$ using the numerical quadrature formula.\n        \\item Calculate the relative error $e_N$ according to the specified formula and conditions.\n        \\item If $e_N < 0.01$, the minimal required grid size is found. Record this $N$ and stop.\n    \\end{enumerate}\n    \\item If the loop completes without the error condition being met, record $-1$ for the test case.\n\\end{enumerate}\nThe final output will be a list of the minimal required grid sizes for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding the minimal Lebedev grid size for a given error tolerance\n    in a fiber-reinforced hyperelastic material model.\n    \"\"\"\n\n    # Define Lebedev grid points and weights as specified in the problem.\n    s_sqrt3 = 1.0 / np.sqrt(3)\n    grids = {\n        6: {\n            \"points\": np.array([\n                [1., 0., 0.], [-1., 0., 0.],\n                [0., 1., 0.], [0., -1., 0.],\n                [0., 0., 1.], [0., 0., -1.]\n            ]),\n            \"weights\": np.full(6, 4 * np.pi / 6)\n        },\n        14: {\n            \"points\": np.vstack([\n                np.array([\n                    [1., 0., 0.], [-1., 0., 0.], [0., 1., 0.],\n                    [0., -1., 0.], [0., 0., 1.], [0., 0., -1.]\n                ]),\n                np.array([\n                    [s_sqrt3, s_sqrt3, s_sqrt3], [s_sqrt3, s_sqrt3, -s_sqrt3],\n                    [s_sqrt3, -s_sqrt3, s_sqrt3], [s_sqrt3, -s_sqrt3, -s_sqrt3],\n                    [-s_sqrt3, s_sqrt3, s_sqrt3], [-s_sqrt3, s_sqrt3, -s_sqrt3],\n                    [-s_sqrt3, -s_sqrt3, s_sqrt3], [-s_sqrt3, -s_sqrt3, -s_sqrt3]\n                ])\n            ]),\n            \"weights\": np.hstack([\n                np.full(6, 4 * np.pi / 15),\n                np.full(8, 3 * np.pi / 10)\n            ])\n        }\n    }\n\n    def calculate_S_exact(k, C):\n        \"\"\"Calculates the exact Second Piola-Kirchhoff stress tensor.\"\"\"\n        tr_C = np.trace(C)\n        I = np.identity(3)\n        S = (2 * k / 15) * (2 * C + (tr_C - 5) * I)\n        return S\n\n    def calculate_S_N(k, C, N):\n        \"\"\"Calculates the approximate SPK stress tensor using a Lebedev grid.\"\"\"\n        grid = grids[N]\n        points = grid[\"points\"]\n        weights = grid[\"weights\"]\n        \n        S_N = np.zeros((3, 3))\n        # Vectorized calculation for efficiency\n        # lambda_f^2 = a^T C a for all points 'a'\n        lambda_f_sq_vec = np.einsum('ia,ab,ib->i', points, C, points)\n        \n        # a (outer) a for all points 'a'\n        a_outer_a_tensor = np.einsum('ia,ib->iab', points, points)\n        \n        # Weighted sum\n        S_N = np.einsum('i,i,iab->ab', weights, lambda_f_sq_vec - 1, a_outer_a_tensor)\n        \n        S_N *= (k / (2 * np.pi))\n        return S_N\n\n    def calculate_error(S_N, S_exact):\n        \"\"\"Calculates the relative quadrature error e_N.\"\"\"\n        norm_S_exact = np.linalg.norm(S_exact, 'fro')\n        \n        if norm_S_exact < 1e-12:\n            norm_S_N = np.linalg.norm(S_N, 'fro')\n            if norm_S_N < 1e-12:\n                return 0.0\n            else:\n                return np.inf\n        \n        norm_diff = np.linalg.norm(S_N - S_exact, 'fro')\n        return norm_diff / norm_S_exact\n\n    # Test cases defined in the problem statement.\n    test_cases = [\n        {'k': 2.0, 'F_diag': (1.2, 0.9, 1.0 / (1.2 * 0.9))},\n        {'k': 5.0, 'F_diag': (1.01, 0.99, 1.0 / (1.01 * 0.99))},\n        {'k': 1.0, 'F_diag': (1.6, 0.85, 1.0 / (1.6 * 0.85))}\n    ]\n    grid_sizes_to_test = [6, 14]\n    results = []\n    error_tolerance = 0.01\n\n    for case in test_cases:\n        k = case['k']\n        # F is diagonal, so F_diag are the principal stretches\n        stretches = np.array(case['F_diag'])\n        # C = F^T F = F^2 for diagonal F\n        C = np.diag(stretches**2)\n        \n        S_exact = calculate_S_exact(k, C)\n        \n        min_N = -1\n        for N in grid_sizes_to_test:\n            S_N = calculate_S_N(k, C, N)\n            error = calculate_error(S_N, S_exact)\n            \n            if error < error_tolerance:\n                min_N = N\n                break\n        \n        results.append(min_N)\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}