{
    "hands_on_practices": [
        {
            "introduction": "创建个体化模型的第一步，通常是将一个通用模板模型与医学影像中捕捉到的患者特定解剖结构对齐。本练习探讨刚体配准，这是一项旨在寻找最佳旋转和变换以对齐相应解剖标志点的基本任务。通过亲手实现经典的基于奇异值分解（SVD）的普氏分析（Procrustes analysis），您将深入理解图像配准的数学基础，并掌握其在面对噪声和几何边缘情况时的鲁棒性。",
            "id": "4207164",
            "problem": "特定于受试者的模型到图像初始化需要通过刚性变换，将一组从医学成像中提取的三维解剖标志点与模板模型对齐。刚性变换将每个点 $x \\in \\mathbb{R}^3$ 映射到 $R x + t$，其中 $R \\in \\mathbb{R}^{3 \\times 3}$ 是一个满足 $R^\\top R = I$ 和 $\\det(R) = 1$ 的旋转矩阵（特殊正交群中的一个真旋转），$t \\in \\mathbb{R}^3$ 是一个平移向量。给定 $\\mathbb{R}^3$ 中的两个对应点集 $A = \\{a_i\\}_{i=1}^N$ 和 $B = \\{b_i\\}_{i=1}^N$，它们分别代表模型空间和图像空间中相同的解剖位置，最优的刚性变换会最小化变换后的点与其对应点之间距离的平方和。目标是从第一性原理和经过充分检验的线性代数事实出发，推导出基于奇异值分解 (SVD) 的解来估计 $R$ 和 $t$，然后量化残余配准误差。\n\n您的程序必须：\n- 使用一种基于刚性变换定义、正交矩阵性质和奇异值分解 (SVD) 的原则性方法，推导出最优刚性变换 $(R, t)$。\n- 计算残余配准误差，即 $R a_i + t$ 与 $b_i$ 之间欧几里得距离的均方根 (RMS)，以米为单位表示。\n- 确保角度以弧度为单位，所有物理距离以米为单位。\n\n推导的基本依据：\n- 刚体运动保持距离不变；$R$ 必须满足 $R^\\top R = I$ 和 $\\det(R) = 1$。\n- 最小二乘目标是 $\\sum_{i=1}^N \\|R a_i + t - b_i\\|^2$。\n- 使用质心、协方差和奇异值分解 (SVD) 的性质来构建最优解，不借助任何捷径公式。\n\n测试套件规范（使用种子为 $42$ 的伪随机数生成器以保证可复现性）：\n- 情况 1（通用理想路径）：\n  - 点数 $N = 20$。\n  - 源点从一个盒子中均匀采样，每个坐标在 $[-0.05, 0.05]$ 米范围内。\n  - 旋转由轴 $u = \\frac{1}{\\sqrt{3}}[1, 1, 1]^\\top$ 和角度 $\\theta = 0.5$ 弧度定义。\n  - 平移 $t = [0.02, -0.01, 0.03]^\\top$ 米。\n  - 对变换后的点添加标准差为 $\\sigma = 0.002$ 米的独立高斯噪声。\n- 情况 2（反射边缘情况）：\n  - 重用情况 1 的源点。\n  - 应用相同的旋转和平移。\n  - 然后将变换后的点沿 yz 平面反射（将 x 坐标乘以 -1）。\n  - 添加标准差为 $\\sigma = 0.001$ 米的独立高斯噪声。\n- 情况 3（退化的共线配置）：\n  - 点数 $N = 10$，共线放置为 $a_i = \\lambda_i d$，其中 $\\lambda_i$ 在 $[-0.05, 0.05]$ 内均匀间隔，且 $d = \\frac{1}{\\sqrt{5}}[1, 2, 0]^\\top$。\n  - 绕 z 轴旋转角度 $\\theta = 0.3$ 弧度。\n  - 平移 $t = [0.0, 0.0, 0.0]^\\top$ 米。\n  - 无噪声，即 $\\sigma = 0.0$ 米。\n- 情况 4（仅平移的边界情况）：\n  - 点数 $N = 15$，从一个盒子中均匀采样，每个坐标在 $[-0.05, 0.05]$ 米范围内。\n  - 单位旋转（角度 $\\theta = 0.0$ 弧度）。\n  - 平移 $t = [0.1, -0.05, 0.0]^\\top$ 米。\n  - 无噪声，即 $\\sigma = 0.0$ 米。\n- 情况 5（带噪声的最小非共线集合）：\n  - 三个点形成一个小三角形：$A = \\{[0.0, 0.0, 0.0]^\\top, [0.05, 0.0, 0.0]^\\top, [0.0, 0.03, 0.0]^\\top\\}$ 米。\n  - 绕 y 轴旋转角度 $\\theta = \\pi/4$ 弧度。\n  - 平移 $t = [0.0, 0.0, 0.0]^\\top$ 米。\n  - 添加标准差为 $\\sigma = 0.005$ 米的独立高斯噪声。\n\n实现要求：\n- 精确地按照规范构建合成点集。\n- 使用基于 SVD 的正交 Procrustes 方法，在 $\\det(R) = 1$ 的约束下计算 $R$ 和 $t$。\n- 对每种情况，将残余配准误差量化为以米为单位的 RMS 值。\n- 角度必须以弧度为单位；距离必须以米为单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的 RMS 配准误差，形式为一个用方括号括起来的逗号分隔列表，每个值四舍五入到六位小数，单位为米，例如 $[0.001234,0.005678,0.000000,0.000123,0.002345]$。",
            "solution": "该问题要求推导并实现一种算法，以找到最优的刚性变换 $(R, t)$，该变换用于对齐两个对应的三维点集 $A = \\{a_i\\}_{i=1}^N$ 和 $B = \\{b_i\\}_{i=1}^N$。该变换定义为 $x \\mapsto R x + t$，其中 $R$ 是一个真旋转矩阵（$R^\\top R = I$, $\\det(R) = 1$），$t$ 是一个平移向量。最优性在最小二乘意义上定义，即最小化目标函数 $E(R, t) = \\sum_{i=1}^N \\|R a_i + t - b_i\\|^2$。解必须从第一性原理出发，利用线性代数和奇异值分解 (SVD) 的性质推导得出。\n\n### 从第一性原理推导\n\n**1. 关于平移 $t$ 的优化**\n\n目标函数 $E(R, t)$ 是平移向量 $t$ 的一个二次函数。通过将其关于 $t$ 的梯度设为零，可以找到最小值。\n$$ \\nabla_t E(R, t) = \\nabla_t \\left( \\sum_{i=1}^N (R a_i + t - b_i)^\\top (R a_i + t - b_i) \\right) = 0 $$\n在求和内部求导：\n$$ \\sum_{i=1}^N 2 (R a_i + t - b_i) = 0 $$\n除以 $2$ 并分配求和：\n$$ \\sum_{i=1}^N R a_i + \\sum_{i=1}^N t - \\sum_{i=1}^N b_i = 0 $$\n$$ R \\left(\\sum_{i=1}^N a_i\\right) + N t - \\sum_{i=1}^N b_i = 0 $$\n设点集的质心定义为 $\\bar{a} = \\frac{1}{N} \\sum_{i=1}^N a_i$ 和 $\\bar{b} = \\frac{1}{N} \\sum_{i=1}^N b_i$。方程变为：\n$$ R (N \\bar{a}) + N t - N \\bar{b} = 0 $$\n求解 $t$ 可得作为旋转 $R$ 函数的最优平移向量：\n$$ t = \\bar{b} - R \\bar{a} $$\n这个结果表明，最优平移将变换后的源点质心与目标点的质心对齐。\n\n**2. 解耦旋转问题**\n\n我们将最优 $t$ 的表达式代回目标函数，以获得一个仅关于 $R$ 的问题：\n$$ E(R) = \\sum_{i=1}^N \\|R a_i + (\\bar{b} - R \\bar{a}) - b_i\\|^2 $$\n通过重新排列各项，我们可以用中心化坐标 $a'_i = a_i - \\bar{a}$ 和 $b'_i = b_i - \\bar{b}$ 来表示该问题：\n$$ E(R) = \\sum_{i=1}^N \\| (R a_i - R \\bar{a}) - (b_i - \\bar{b}) \\|^2 = \\sum_{i=1}^N \\| R (a_i - \\bar{a}) - (b_i - \\bar{b}) \\|^2 $$\n$$ E(R) = \\sum_{i=1}^N \\| R a'_i - b'_i \\|^2 $$\n现在，任务是找到最优旋转 $R$，以最小化中心化点集之间的距离平方和。\n\n**3. 关于旋转 $R$ 的优化**\n\n我们在目标函数中展开平方范数：\n$$ E(R) = \\sum_{i=1}^N (R a'_i - b'_i)^\\top (R a'_i - b'_i) = \\sum_{i=1}^N \\left( (a'_i)^\\top R^\\top R a'_i - 2(a'_i)^\\top R^\\top b'_i + (b'_i)^\\top b'_i \\right) $$\n由于 $R$ 是一个旋转矩阵，因此 $R^\\top R = I$。该表达式简化为：\n$$ E(R) = \\sum_{i=1}^N \\left( \\|a'_i\\|^2 - 2(b'_i)^\\top R a'_i + \\|b'_i\\|^2 \\right) $$\n项 $\\sum \\|a'_i\\|^2$ 和 $\\sum \\|b'_i\\|^2$ 相对于 $R$ 是常数。因此，最小化 $E(R)$ 等价于最大化项 $\\sum_{i=1}^N (b'_i)^\\top R a'_i$。\n\n利用矩阵迹的性质（具体而言，一个标量是其自身的迹，且迹算子具有循环性，$\\text{tr}(XY) = \\text{tr}(YX)$），我们可以重写待最大化的量：\n$$ \\sum_{i=1}^N (b'_i)^\\top R a'_i = \\sum_{i=1}^N \\text{tr}((b'_i)^\\top R a'_i) = \\sum_{i=1}^N \\text{tr}(R a'_i (b'_i)^\\top) $$\n$$ = \\text{tr}\\left(R \\sum_{i=1}^N a'_i (b'_i)^\\top\\right) $$\n让我们将 $3 \\times 3$ 的互协方差矩阵 $H$ 定义为：\n$$ H = \\sum_{i=1}^N a'_i (b'_i)^\\top $$\n优化问题现在简化为：\n$$ \\underset{R}{\\text{maximize}} \\quad \\text{tr}(RH) \\quad \\text{subject to} \\quad R^\\top R = I, \\det(R) = 1 $$\n\n**4. 基于 SVD 的解**\n\n设 $H$ 的奇异值分解 (SVD) 为 $H = U \\Sigma V^\\top$，其中 $U, V \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$\\Sigma = \\text{diag}(\\sigma_1, \\sigma_2, \\sigma_3)$ 是一个非负奇异值的对角矩阵，其值按 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$ 排序。\n\n将 $H$ 的 SVD 代入迹表达式中：\n$$ \\text{tr}(RH) = \\text{tr}(R U \\Sigma V^\\top) = \\text{tr}(\\Sigma V^\\top R U) $$\n设 $M = V^\\top R U$。由于 $V$、$R$ 和 $U$ 都是正交矩阵，因此 $M$ 也是一个正交矩阵。表达式变为 $\\text{tr}(\\Sigma M) = \\sum_{i=1}^3 \\sigma_i M_{ii}$。由于 $M$ 是正交的，其对角元素满足 $|M_{ii}| \\le 1$。为了最大化这个和，我们应选择 $M$，使其对角元素尽可能大。如果没有行列式约束，当 $M=I$ 时将达到最大值，这会得到 $V^\\top R U = I$，从而导出 $R = V U^\\top$。\n\n然而，我们必须满足真旋转约束 $\\det(R)=1$。\n$$ \\det(R) = \\det(V U^\\top) = \\det(V) \\det(U^\\top) = \\det(V)\\det(U) $$\n正交矩阵 $U$ 和 $V$ 的行列式可以是 $+1$ 或 $-1$。\n\n情况 1：$\\det(V)\\det(U) = 1$。在这种情况下，$\\det(R)=1$，解 $R = V U^\\top$ 是一个真旋转。这是最优解。\n\n情况 2：$\\det(V)\\det(U) = -1$。在这种情况下，$R = V U^\\top$ 是一个非真旋转（一个反射），其 $\\det(R)=-1$。我们的问题要求找到一个真旋转 $R$ 来最大化 $\\text{tr}(RH)$，这等价于在 $M$ 是一个行列式为 $\\det(M) = \\det(V^\\top R U) = \\det(V^\\top)\\det(R)\\det(U) = (\\det(V)\\det(U))^{-1} \\det(R) = (-1)^{-1}(1) = -1$ 的正交矩阵的约束下，最大化 $\\text{tr}(\\Sigma M)$。\n我们需要在 $\\det(M) = -1$ 的约束下最大化 $\\sum \\sigma_i M_{ii}$。给定 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$，通过设置 $M_{11}=1$、$M_{22}=1$ 和 $M_{33}=-1$ 可以达到最大值。这种选择使得最小的奇异值做出负贡献，从而最小化了与可能的最大和 $\\sigma_1+\\sigma_2+\\sigma_3$ 之间的损失。\n $M$ 的最优选择是 $S = \\text{diag}(1, 1, -1)$。\n设 $M=S$ 得到 $V^\\top R U = S$，从而得出校正后的旋转：\n$$ R = V S U^\\top = V \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  -1 \\end{pmatrix} U^\\top $$\n\n**算法总结**\n1.  计算两个点集的质心：$\\bar{a} = \\frac{1}{N}\\sum a_i$ 和 $\\bar{b} = \\frac{1}{N}\\sum b_i$。\n2.  计算中心化点集：$A' = \\{a_i - \\bar{a}\\}$ 和 $B' = \\{b_i - \\bar{b}\\}$。\n3.  计算互协方差矩阵 $H = (A')^\\top B'$。\n4.  计算 $H$ 的 SVD：$H = U \\Sigma V^\\top$。\n5.  计算旋转矩阵 $R = V U^\\top$。\n6.  如果 $\\det(R)  0$，为反射进行校正：$R = V \\text{diag}(1, 1, -1) U^\\top$。\n7.  计算平移向量 $t = \\bar{b} - R \\bar{a}$。\n8.  估算出的变换为 $(R,t)$。残余配准误差计算为 RMS 误差：$E_{RMS} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^N \\|(R a_i + t) - b_i\\|^2}$。\n\n这个基于第一性原理的推导提供了一个鲁棒的刚性点集配准算法，现在将予以实现。",
            "answer": "```python\nimport numpy as np\n\ndef rodrigues_rotation_matrix(axis, angle):\n    \"\"\"Generates a 3x3 rotation matrix from an axis and an angle using Rodrigues' formula.\"\"\"\n    axis = np.asarray(axis)\n    axis = axis / np.linalg.norm(axis)\n    # Skew-symmetric matrix\n    K = np.array([[0, -axis[2], axis[1]],\n                      [axis[2], 0, -axis[0]],\n                      [-axis[1], axis[0], 0]])\n    R = np.identity(3) + np.sin(angle) * K + (1 - np.cos(angle)) * (K @ K)\n    return R\n\ndef rigid_align(A, B):\n    \"\"\"\n    Computes the optimal rigid transformation (R, t) to align point set A to B.\n    \n    Args:\n        A (np.ndarray): Source point set, shape (N, 3).\n        B (np.ndarray): Target point set, shape (N, 3).\n\n    Returns:\n        tuple: A tuple (R, t, rms_error) containing the rotation matrix,\n               translation vector, and the root-mean-square error.\n    \"\"\"\n    N = A.shape[0]\n    \n    # 1. Compute centroids\n    centroid_A = np.mean(A, axis=0)\n    centroid_B = np.mean(B, axis=0)\n\n    # 2. Compute centered point sets\n    A_centered = A - centroid_A\n    B_centered = B - centroid_B\n    \n    # 3. Compute cross-covariance matrix H\n    H = A_centered.T @ B_centered\n    \n    # 4. Compute SVD of H\n    U, s, Vh = np.linalg.svd(H)\n    V = Vh.T\n\n    # 5. Compute rotation matrix R\n    R = V @ U.T\n    \n    # 6. Check for reflection and correct if necessary\n    if np.linalg.det(R)  0:\n        # Correct R to be a proper rotation\n        V_corrected = V.copy()\n        V_corrected[:, -1] *= -1\n        R = V_corrected @ U.T\n\n    # 7. Compute translation vector t\n    t = centroid_B - R @ centroid_A\n    \n    # 8. Compute RMS error\n    A_transformed = (R @ A.T).T + t\n    diff = A_transformed - B\n    rms_error = np.sqrt(np.mean(np.sum(diff**2, axis=1)))\n    \n    return R, t, rms_error\n\n\ndef solve():\n    \"\"\"\n    Generates test cases, computes rigid alignment, and prints RMS errors.\n    \"\"\"\n    rng = np.random.default_rng(42)\n    results = []\n\n    # Case 1: General happy path\n    N1 = 20\n    sigma1 = 0.002\n    A1 = rng.uniform(-0.05, 0.05, (N1, 3))\n    R_true1 = rodrigues_rotation_matrix([1, 1, 1], 0.5)\n    t_true1 = np.array([0.02, -0.01, 0.03])\n    B1 = (R_true1 @ A1.T).T + t_true1 + rng.normal(0, sigma1, (N1, 3))\n    _, _, rms_error1 = rigid_align(A1, B1)\n    results.append(rms_error1)\n\n    # Case 2: Reflection edge case\n    # Reuse A1 and true transform from Case 1\n    N2 = N1\n    sigma2 = 0.001\n    B2_no_noise = (R_true1 @ A1.T).T + t_true1\n    # Reflect across the yz-plane (x -> -x)\n    reflection_matrix = np.diag([-1, 1, 1])\n    B2_reflected = B2_no_noise @ reflection_matrix.T\n    B2 = B2_reflected + rng.normal(0, sigma2, (N2, 3))\n    _, _, rms_error2 = rigid_align(A1, B2)\n    results.append(rms_error2)\n    \n    # Case 3: Degenerate collinear configuration\n    N3 = 10\n    d3 = np.array([1, 2, 0]) / np.sqrt(5)\n    lambdas = np.linspace(-0.05, 0.05, N3)\n    A3 = np.outer(lambdas, d3)\n    R_true3 = rodrigues_rotation_matrix([0, 0, 1], 0.3)\n    t_true3 = np.array([0.0, 0.0, 0.0])\n    B3 = (R_true3 @ A3.T).T + t_true3\n    _, _, rms_error3 = rigid_align(A3, B3)\n    results.append(rms_error3)\n\n    # Case 4: Translation-only boundary\n    N4 = 15\n    A4 = rng.uniform(-0.05, 0.05, (N4, 3))\n    R_true4 = np.identity(3) # angle = 0.0\n    t_true4 = np.array([0.1, -0.05, 0.0])\n    B4 = (R_true4 @ A4.T).T + t_true4\n    _, _, rms_error4 = rigid_align(A4, B4)\n    results.append(rms_error4)\n\n    # Case 5: Minimal non-collinear set with noise\n    N5 = 3\n    sigma5 = 0.005\n    A5 = np.array([[0.0, 0.0, 0.0], [0.05, 0.0, 0.0], [0.0, 0.03, 0.0]])\n    R_true5 = rodrigues_rotation_matrix([0, 1, 0], np.pi/4)\n    t_true5 = np.array([0.0, 0.0, 0.0])\n    B5 = (R_true5 @ A5.T).T + t_true5 + rng.normal(0, sigma5, (N5, 3))\n    _, _, rms_error5 = rigid_align(A5, B5)\n    results.append(rms_error5)\n\n    # Format output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在确定模型几何形状后，接下来的挑战是利用成像数据来个性化其生物力学参数，这是一个典型的逆问题。本练习通过分析灵敏度矩阵来深入探讨参数的可辨识性问题，该矩阵建立了参数变化与模型预测输出变化之间的联系。利用奇异值分解（SVD），您将学习如何量化数据对参数的确定程度，理解病态条件的概念，并观察其对参数不确定性的直接影响。",
            "id": "4207168",
            "problem": "您正在根据基于影像的测量数据，为一个特定受试者的、双参数线性化的生物力学个性化问题进行建模。该影像模态提供位移测量值，这些测量值被建模为两个材料参数（弹性模量和泊松比）的可微函数。在参考参数向量附近进行线性化后，测量值可以通过一个带有加性噪声的线性模型来近似。您的目标是使用灵敏度矩阵的奇异值分解（SVD）来量化参数的可识别性，并在弱高斯先验下计算由此产生的参数方差。\n\n假设设置如下：\n- 令参数向量为 $\\boldsymbol{\\theta} = [\\theta_1,\\theta_2]^\\top$，其中 $\\theta_1$ 是以千帕斯卡（kPa）为单位的弹性模量，$\\theta_2$ 是泊松比（无量纲）。\n- 令灵敏度矩阵为 $\\mathbf{J} \\in \\mathbb{R}^{m \\times 2}$，其中 $m$ 是来自影像的独立位移测量次数。$\\mathbf{J}$ 的每个元素代表预测位移（以毫米为单位）关于每个参数的偏导数。\n- 令测量噪声为加性的、零均值的高斯噪声，其独立分量的标准差为 $\\sigma$（以毫米为单位），因此测量模型为 $\\mathbf{y} \\approx \\mathbf{y}_{\\text{ref}} + \\mathbf{J}\\,\\Delta\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I})$。\n- 假设参数上存在一个弱的、独立的高斯先验，其标准差收集在一个对角矩阵 $\\mathbf{S}_p = \\mathrm{diag}(s_{\\theta_1}, s_{\\theta_2})$ 中，其中 $s_{\\theta_1}$ 的单位是千帕斯卡（kPa），$s_{\\theta_2}$ 无量纲。此先验在确保数值稳定性的同时，相对于数据而言仍然是弱的。\n\n基本依据：\n- 使用线性化观测模型 $\\mathbf{y} \\approx \\mathbf{y}_{\\text{ref}} + \\mathbf{J}\\,\\Delta\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$、加性独立高斯噪声 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I})$，以及奇异值分解（SVD）的定义 $\\mathbf{J} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\top$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是标准正交的，$\\boldsymbol{\\Sigma}$ 包含非负奇异值。\n- 通过 $\\boldsymbol{\\Sigma}$ 的谱来量化可识别性，并使用从带弱高斯先验的高斯线性模型推导出的后验协方差来计算参数方差。您必须在推理和计算中明确使用 SVD 结构。不要依赖于这些基础之外的快捷公式或恒等式。\n\n任务：\n1. 对于下面的每个测试用例，通过 SVD 计算 $\\mathbf{J}$ 的奇异值，按降序对其进行排序，并计算条件数 $\\kappa$，其定义为最大奇异值与最小非零奇异值的比率。如果最小奇异值在数值上为零（将小于 $10^{-12}$ 的值视为零），则将 $\\kappa$ 设置为 $+\\infty$。\n2. 使用弱高斯先验，计算 $\\Delta\\boldsymbol{\\theta}$ 的后验协方差矩阵并提取参数标准差。您必须以千帕斯卡（kPa）表示弹性模量的标准差，并以无量纲形式表示泊松比的标准差。将每个标准差四舍五入到恰好 $6$ 位小数。\n3. 通过比较不同情况下的条件数和得出的标准差，解释小奇异值对参数方差的影响。此解释应反映在您的计算输出中；您无需打印超出指定输出格式的文本。\n\n测试套件：\n为以下三种情况提供结果。所有数值实体必须严格按照规定处理。在每种情况下，$\\mathbf{J}$ 都作为一个实数矩阵给出，其条目单位为每参数单位毫米。\n\n- 案例 A（良态）：\n  - 灵敏度矩阵 $\\mathbf{J}_A = \\begin{bmatrix} 0.8  0.1 \\\\ 0.0  1.0 \\\\ 1.2  -0.1 \\\\ 0.5  0.2 \\end{bmatrix}$。\n  - 噪声标准差 $\\sigma_A = 0.05$（毫米）。\n  - 弱先验标准差 $\\mathbf{S}_{p,A} = \\mathrm{diag}(100.0, 0.2)$，其中 $100.0$ 的单位是千帕斯卡（kPa），$0.2$ 无量纲。\n\n- 案例 B（高度相关的参数，病态）：\n  - 灵敏度矩阵 $\\mathbf{J}_B = \\begin{bmatrix} 1.0  0.99 \\\\ 0.9  0.89 \\\\ 1.1  1.09 \\\\ 1.05  1.04 \\end{bmatrix}$。\n  - 噪声标准差 $\\sigma_B = 0.10$（毫米）。\n  - 弱先验标准差 $\\mathbf{S}_{p,B} = \\mathrm{diag}(100.0, 0.2)$，其中 $100.0$ 的单位是千帕斯卡（kPa），$0.2$ 无量纲。\n\n- 案例 C（接近秩亏）：\n  - 灵敏度矩阵 $\\mathbf{J}_C = \\begin{bmatrix} 10^{-4}  1.0 \\\\ -10^{-4}  1.0 \\\\ 2\\times 10^{-4}  1.0 \\\\ -2\\times 10^{-4}  1.0 \\end{bmatrix}$。\n  - 噪声标准差 $\\sigma_C = 0.01$（毫米）。\n  - 弱先验标准差 $\\mathbf{S}_{p,C} = \\mathrm{diag}(100.0, 0.2)$，其中 $100.0$ 的单位是千帕斯卡（kPa），$0.2$ 无量纲。\n\n计算要求：\n- 对于每个案例，计算 $\\kappa$ 和后验参数标准差 $s_{\\theta_1}$（单位：千帕斯卡）和 $s_{\\theta_2}$（无量纲）。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个案例，其本身是一个形式为 $[\\kappa, s_{\\theta_1}, s_{\\theta_2}]$ 的列表。例如，输出格式必须是 $[[\\kappa_A, s_{\\theta_1,A}, s_{\\theta_2,A}],[\\kappa_B, s_{\\theta_1,B}, s_{\\theta_2,B}],[\\kappa_C, s_{\\theta_1,C}, s_{\\theta_2,C}]]$，所有数值均以标准十进制表示法打印（无科学符号），每个标准差四舍五入到恰好 $6$ 位小数。条件数应作为标准浮点数打印，不带单位。",
            "solution": "该问题被验证为具有科学依据、适定且客观。所有需要的数据和定义均已提供，不存在内部矛盾或违反基本原则的情况。该问题是贝叶斯线性模型框架内参数可识别性和不确定性量化的标准练习，这是生物力学建模中的一项常见任务。\n\n对于每个案例研究，解决方案分两个主要阶段进行：首先，使用灵敏度矩阵 $\\mathbf{J}$ 的奇异值分解（SVD）分析参数的可识别性；其次，通过后验协方差矩阵计算参数的不确定性。\n\n令参数向量为 $\\boldsymbol{\\theta} = [\\theta_1, \\theta_2]^\\top$。线性化的测量模型由 $\\mathbf{y} \\approx \\mathbf{y}_{\\text{ref}} + \\mathbf{J}\\,\\Delta\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$ 给出，其中 $\\Delta\\boldsymbol{\\theta}$ 是与参考参数向量的偏差，$\\mathbf{J}$ 是灵敏度矩阵，$\\boldsymbol{\\varepsilon}$ 是零均值高斯噪声，其协方差为 $\\mathbf{C}_{\\varepsilon} = \\sigma^2 \\mathbf{I}$。\n\n在给定参数偏差 $\\Delta\\boldsymbol{\\theta}$ 的情况下观测到数据的似然与一个高斯函数成正比：\n$$ p(\\mathbf{y} | \\Delta\\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} (\\mathbf{J}\\Delta\\boldsymbol{\\theta} - \\Delta\\mathbf{y})^\\top \\mathbf{C}_{\\varepsilon}^{-1} (\\mathbf{J}\\Delta\\boldsymbol{\\theta} - \\Delta\\mathbf{y}) \\right) $$\n其中 $\\Delta\\mathbf{y} = \\mathbf{y} - \\mathbf{y}_{\\text{ref}}$。\n参数具有以零偏差为中心的弱高斯先验分布，$p(\\Delta\\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} \\Delta\\boldsymbol{\\theta}^\\top \\mathbf{C}_{p}^{-1} \\Delta\\boldsymbol{\\theta} \\right)$，其中先验协方差为 $\\mathbf{C}_p = \\mathbf{S}_p^2 = \\mathrm{diag}(s_{\\theta_1}^2, s_{\\theta_2}^2)$。\n\n根据 Bayes 定理，后验分布 $p(\\Delta\\boldsymbol{\\theta} | \\mathbf{y})$ 与似然和先验的乘积成正比。由于两者都是高斯分布，后验分布也是高斯分布。后验协方差矩阵的逆 $\\mathbf{C}_{\\text{post}}^{-1}$ 是来自似然二次项和先验二次项的逆协方差矩阵之和：\n$$ \\mathbf{C}_{\\text{post}}^{-1} = \\mathbf{J}^\\top \\mathbf{C}_{\\varepsilon}^{-1} \\mathbf{J} + \\mathbf{C}_{p}^{-1} $$\n代入 $\\mathbf{C}_{\\varepsilon}^{-1} = \\frac{1}{\\sigma^2}\\mathbf{I}$，我们得到：\n$$ \\mathbf{C}_{\\text{post}} = \\left( \\frac{1}{\\sigma^2} \\mathbf{J}^\\top \\mathbf{J} + \\mathbf{C}_{p}^{-1} \\right)^{-1} $$\n\n后验参数方差是 $\\mathbf{C}_{\\text{post}}$ 的对角元素，标准差是它们的平方根。\n\n可识别性分析将使用灵敏度矩阵的 SVD 进行，即 $\\mathbf{J} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\top$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是标准正交矩阵，$\\boldsymbol{\\Sigma}$ 是一个包含非负奇异值 $s_1 \\ge s_2 \\ge \\dots \\ge 0$ 的矩形对角矩阵。$\\mathbf{J}^\\top\\mathbf{J}$ 项可以使用 SVD 分量表示为 $\\mathbf{J}^\\top\\mathbf{J} = \\mathbf{V}\\boldsymbol{\\Sigma}^\\top\\boldsymbol{\\Sigma}\\mathbf{V}^\\top$。对于一个双参数问题，$\\boldsymbol{\\Sigma}^\\top\\boldsymbol{\\Sigma} = \\mathrm{diag}(s_1^2, s_2^2)$。\n\n奇异值表示测量值对参数沿 $\\mathbf{V}$ 的列（右奇异向量）所定义方向变化的敏感度。一个非常小的奇异值表明测量值对相应方向上的参数变化不敏感，导致可识别性差。条件数 $\\kappa = s_1/s_2$（对于 $s_2 > 0$）量化了这种差异。大的 $\\kappa$ 表示病态条件，即至少有一个参数组合很难由数据确定。\n\n我们现在将此框架应用于每个案例。\n\n**案例 A：良态**\n- $\\mathbf{J}_A = \\begin{bmatrix} 0.8  0.1 \\\\ 0.0  1.0 \\\\ 1.2  -0.1 \\\\ 0.5  0.2 \\end{bmatrix}$，$\\sigma_A = 0.05$，$\\mathbf{S}_{p,A} = \\mathrm{diag}(100.0, 0.2)$。\n1.  **SVD 和条件数**：\n    $\\mathbf{J}_A$ 的 SVD 分解产生奇异值 $s_1 \\approx 1.5307$ 和 $s_2 \\approx 1.0450$。这些值数量级相近。\n    条件数为 $\\kappa_A = s_1/s_2 \\approx 1.5307 / 1.0450 \\approx 1.4647$。这个低值表明这是一个良态问题。\n2.  **后验协方差**：\n    先验协方差矩阵是 $\\mathbf{C}_{p,A} = \\mathrm{diag}(100^2, 0.2^2) = \\mathrm{diag}(10000, 0.04)$，所以 $\\mathbf{C}_{p,A}^{-1} = \\mathrm{diag}(0.0001, 25)$。\n    我们计算 $\\mathbf{J}_A^\\top \\mathbf{J}_A = \\begin{bmatrix} 2.33  0.11 \\\\ 0.11  1.06 \\end{bmatrix}$。\n    后验协方差的逆是 $\\mathbf{C}_{\\text{post},A}^{-1} = \\frac{1}{0.05^2} \\mathbf{J}_A^\\top \\mathbf{J}_A + \\mathbf{C}_{p,A}^{-1} = 400 \\begin{bmatrix} 2.33  0.11 \\\\ 0.11  1.06 \\end{bmatrix} + \\begin{bmatrix} 0.0001  0 \\\\ 0  25 \\end{bmatrix} = \\begin{bmatrix} 932.0001  44 \\\\ 44  449 \\end{bmatrix}$。\n    对其求逆得到后验协方差 $\\mathbf{C}_{\\text{post},A} \\approx \\begin{bmatrix} 0.001075  -0.000105 \\\\ -0.000105  0.002231 \\end{bmatrix}$。\n    后验方差是对角元素：$\\mathrm{var}(\\Delta\\theta_1) \\approx 0.001075$ 和 $\\mathrm{var}(\\Delta\\theta_2) \\approx 0.002231$。\n    标准差是 $s_{\\theta_1,A} = \\sqrt{0.001075} \\approx 0.032784$ kPa 和 $s_{\\theta_2,A} = \\sqrt{0.002231} \\approx 0.047236$。\n\n**案例 B：高度相关的参数，病态**\n- $\\mathbf{J}_B = \\begin{bmatrix} 1.0  0.99 \\\\ 0.9  0.89 \\\\ 1.1  1.09 \\\\ 1.05  1.04 \\end{bmatrix}$，$\\sigma_B = 0.10$，$\\mathbf{S}_{p,B} = \\mathrm{diag}(100.0, 0.2)$。\n1.  **SVD 和条件数**：\n    $\\mathbf{J}_B$ 的列几乎是线性相关的。SVD 产生奇异值 $s_1 \\approx 2.8466$ 和 $s_2 \\approx 0.0200$。\n    条件数为 $\\kappa_B = s_1/s_2 \\approx 2.8466 / 0.0200 \\approx 142.37$。这个高值表明这是一个病态问题，其中测量对一种参数组合敏感，但对另一种不敏感。\n2.  **后验协方差**：\n    先验与案例 A 相同。\n    我们计算 $\\mathbf{J}_B^\\top \\mathbf{J}_B = \\begin{bmatrix} 4.1225  4.081 \\\\ 4.081  4.04 \\end{bmatrix}$。\n    后验协方差的逆是 $\\mathbf{C}_{\\text{post},B}^{-1} = \\frac{1}{0.10^2} \\mathbf{J}_B^\\top \\mathbf{J}_B + \\mathbf{C}_{p,B}^{-1} = 100 \\begin{bmatrix} 4.1225  4.081 \\\\ 4.081  4.04 \\end{bmatrix} + \\begin{bmatrix} 0.0001  0 \\\\ 0  25 \\end{bmatrix} = \\begin{bmatrix} 412.2501  408.1 \\\\ 408.1  429 \\end{bmatrix}$。\n    求逆得到 $\\mathbf{C}_{\\text{post},B} \\approx \\begin{bmatrix} 0.040188  -0.038228 \\\\ -0.038228  0.038618 \\end{bmatrix}$。\n    后验方差是 $\\mathrm{var}(\\Delta\\theta_1) \\approx 0.040188$ 和 $\\mathrm{var}(\\Delta\\theta_2) \\approx 0.038618$。\n    标准差是 $s_{\\theta_1,B} = \\sqrt{0.040188} \\approx 0.200469$ kPa 和 $s_{\\theta_2,B} = \\sqrt{0.038618} \\approx 0.196515$。与良态情况相比，即使噪声水平也有所增加，高条件数也正确地对应于更大的后验不确定性。\n\n**案例 C：接近秩亏**\n- $\\mathbf{J}_C = \\begin{bmatrix} 10^{-4}  1.0 \\\\ -10^{-4}  1.0 \\\\ 2\\times 10^{-4}  1.0 \\\\ -2\\times 10^{-4}  1.0 \\end{bmatrix}$，$\\sigma_C = 0.01$，$\\mathbf{S}_{p,C} = \\mathrm{diag}(100.0, 0.2)$。\n1.  **SVD 和条件数**：\n    与第二列相比，$\\mathbf{J}_C$ 的第一列中的元素数量级非常小，表明对 $\\theta_1$ 的敏感度非常低。\n    SVD 产生奇异值 $s_1 \\approx 2.0000$ 和 $s_2 \\approx 0.000316$。\n    条件数为 $\\kappa_C = s_1/s_2 \\approx 2.0000 / 0.000316 \\approx 6324.56$。这个极高的值表示严重的病态。\n2.  **后验协方差**：\n    先验与案例 A 和 B 相同。\n    我们计算 $\\mathbf{J}_C^\\top \\mathbf{J}_C = \\begin{bmatrix} 10^{-7}  0 \\\\ 0  4 \\end{bmatrix}$。\n    后验协方差的逆是 $\\mathbf{C}_{\\text{post},C}^{-1} = \\frac{1}{0.01^2} \\mathbf{J}_C^\\top \\mathbf{J}_C + \\mathbf{C}_{p,C}^{-1} = 10000 \\begin{bmatrix} 10^{-7}  0 \\\\ 0  4 \\end{bmatrix} + \\begin{bmatrix} 0.0001  0 \\\\ 0  25 \\end{bmatrix} = \\begin{bmatrix} 0.0011  0 \\\\ 0  40025 \\end{bmatrix}$。\n    由于这个矩阵是对角的，求逆很简单：$\\mathbf{C}_{\\text{post},C} = \\begin{bmatrix} 1/0.0011  0 \\\\ 0  1/40025 \\end{bmatrix} \\approx \\begin{bmatrix} 909.09   0 \\\\ 0  0.00002498 \\end{bmatrix}$。\n    后验方差是 $\\mathrm{var}(\\Delta\\theta_1) \\approx 909.09$ 和 $\\mathrm{var}(\\Delta\\theta_2) \\approx 0.00002498$。\n    标准差是 $s_{\\theta_1,C} = \\sqrt{909.09} \\approx 30.151134$ kPa 和 $s_{\\theta_2,C} = \\sqrt{0.00002498} \\approx 0.004998$。\n    $\\theta_1$ 的巨大不确定性是低敏感度（小奇异值）的直接后果。其后验不确定性小于先验（$30.15  100$），但仍然非常大。相比之下，由于高敏感度（大奇异值）和低测量噪声，$\\theta_2$ 被高精度地识别出来。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes parameter identifiability metrics (condition number) and posterior\n    parameter standard deviations for three biomechanical personalization cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"J\": np.array([\n                [0.8, 0.1],\n                [0.0, 1.0],\n                [1.2, -0.1],\n                [0.5, 0.2]\n            ]),\n            \"sigma\": 0.05,\n            \"s_p_diag\": np.array([100.0, 0.2])\n        },\n        {\n            \"name\": \"Case B\",\n            \"J\": np.array([\n                [1.0, 0.99],\n                [0.9, 0.89],\n                [1.1, 1.09],\n                [1.05, 1.04]\n            ]),\n            \"sigma\": 0.10,\n            \"s_p_diag\": np.array([100.0, 0.2])\n        },\n        {\n            \"name\": \"Case C\",\n            \"J\": np.array([\n                [1e-4, 1.0],\n                [-1e-4, 1.0],\n                [2e-4, 1.0],\n                [-2e-4, 1.0]\n            ]),\n            \"sigma\": 0.01,\n            \"s_p_diag\": np.array([100.0, 0.2])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        J = case[\"J\"]\n        sigma = case[\"sigma\"]\n        s_p_diag = case[\"s_p_diag\"]\n\n        # Task 1: SVD and Condition Number\n        # U, s, Vt are computed, but only s is needed here.\n        # numpy's svd function returns singular values sorted in descending order.\n        singular_values = np.linalg.svd(J, compute_uv=False)\n        \n        s_max = singular_values[0]\n        s_min = singular_values[-1] # Smallest singular value\n\n        # Per problem spec, treat values  1e-12 as zero.\n        if s_min  1e-12:\n            kappa = np.inf\n        else:\n            kappa = s_max / s_min\n\n        # Task 2: Posterior Covariance and Standard Deviations\n        # Prior covariance matrix C_p = diag(s_p^2)\n        # Its inverse C_p_inv = diag(1/s_p^2)\n        C_p_inv = np.diag(1.0 / (s_p_diag**2))\n\n        # Fisher Information from data: (1/sigma^2) * J^T * J\n        JtJ = J.T @ J\n        \n        # Inverse of posterior covariance: C_post_inv = (1/sigma^2)J^T*J + C_p_inv\n        C_post_inv = (1.0 / sigma**2) * JtJ + C_p_inv\n\n        # Posterior covariance\n        C_post = np.linalg.inv(C_post_inv)\n\n        # Variances are the diagonal elements of the posterior covariance matrix.\n        variances = np.diag(C_post)\n        \n        # Standard deviations are the square root of variances.\n        posterior_stdevs = np.sqrt(variances)\n        s_theta1 = posterior_stdevs[0]\n        s_theta2 = posterior_stdevs[1]\n        \n        results.append(f\"[{kappa},{s_theta1:.6f},{s_theta2:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "建模工作流程的最后一个关键阶段，是通过将个性化模型的预测结果与实验测量值进行比较来验证模型。本练习介绍Bland-Altman分析法，这是一种评估两种定量测量方法之间一致性的标准统计方法。通过将此分析应用于比较模型预测的心脏应变与磁共振成像（MRI）测量的应变，您将学会从偏差和一致性界限的角度来定量评估模型的准确性。",
            "id": "4207157",
            "problem": "根据影像数据构建了一个受试者特异性的左心室有限元模型，该模型结合了电影磁共振成像和采用受激回波位移编码 (DENSE) 的磁共振成像。DENSE 磁共振成像提供了一个体素位移场，通过基于变形梯度 $F$ 的标准连续介质力学定义，即 Green-Lagrange 应变 $E = \\frac{1}{2}\\left(F^{\\top}F - I\\right)$，可以从中获得收缩末期的拉格朗日环向应变 $E_{cc}$，并按美国心脏协会 (American Heart Association) 分段进行汇总。该模型使用一套根据同一受试者影像数据拟合的个性化本构参数集来预测 $E_{cc}$。\n\n对于 $i = 1, \\dots, 12$ 个心肌分段，测量的和预测的收缩末期拉格朗日环向应变如下所示，其中 $E^{\\mathrm{DENSE}}_{cc,i}$ 表示 DENSE 磁共振成像的测量值，$E^{\\mathrm{model}}_{cc,i}$ 表示模型的预测值：\n$(E^{\\mathrm{DENSE}}_{cc,1}, E^{\\mathrm{model}}_{cc,1}) = (-0.18, -0.17)$，$(E^{\\mathrm{DENSE}}_{cc,2}, E^{\\mathrm{model}}_{cc,2}) = (-0.22, -0.23)$，$(E^{\\mathrm{DENSE}}_{cc,3}, E^{\\mathrm{model}}_{cc,3}) = (-0.16, -0.15)$，$(E^{\\mathrm{DENSE}}_{cc,4}, E^{\\mathrm{model}}_{cc,4}) = (-0.20, -0.19)$，$(E^{\\mathrm{DENSE}}_{cc,5}, E^{\\mathrm{model}}_{cc,5}) = (-0.25, -0.27)$，$(E^{\\mathrm{DENSE}}_{cc,6}, E^{\\mathrm{model}}_{cc,6}) = (-0.12, -0.11)$，$(E^{\\mathrm{DENSE}}_{cc,7}, E^{\\mathrm{model}}_{cc,7}) = (-0.19, -0.20)$，$(E^{\\mathrm{DENSE}}_{cc,8}, E^{\\mathrm{model}}_{cc,8}) = (-0.21, -0.22)$，$(E^{\\mathrm{DENSE}}_{cc,9}, E^{\\mathrm{model}}_{cc,9}) = (-0.15, -0.14)$，$(E^{\\mathrm{DENSE}}_{cc,10}, E^{\\mathrm{model}}_{cc,10}) = (-0.23, -0.24)$，$(E^{\\mathrm{DENSE}}_{cc,11}, E^{\\mathrm{model}}_{cc,11}) = (-0.17, -0.16)$，$(E^{\\mathrm{DENSE}}_{cc,12}, E^{\\mathrm{model}}_{cc,12}) = (-0.24, -0.26)$。\n\n通过计算偏倚（平均差值）和 95% 一致性界限，对模型预测值与 DENSE 磁共振成像测量值进行 Bland–Altman 分析。差值定义为 $\\Delta_i = E^{\\mathrm{model}}_{cc,i} - E^{\\mathrm{DENSE}}_{cc,i}$。假设差值近似服从正态分布，并使用常规的 1.96 乘数来构建 95% 一致性界限。将偏倚以及一致性界限的下限和上限报告为三个无量纲十进制数。将您的结果四舍五入至四位有效数字。所有量均以无量纲十进制数表示。",
            "solution": "该问题陈述是关于计算模型预测与实验测量值进行统计比较的一个有效练习，这是生物力学领域，特别是受试者特异性建模中的一项常见任务。该问题提供了所有必要的数据和方法学约束，以得出一个唯一的、可验证的解。\n\n目标是进行 Bland-Altman 分析，以比较模型预测的拉格朗日环向应变 $E^{\\mathrm{model}}_{cc}$ 与 DENSE MRI 测量的应变 $E^{\\mathrm{DENSE}}_{cc}$。该分析需要计算偏倚（平均差值）和 95% 一致性界限。\n\n对于 $N=12$ 个心肌分段中的每一个，其差值定义为：\n$$\n\\Delta_i = E^{\\mathrm{model}}_{cc,i} - E^{\\mathrm{DENSE}}_{cc,i} \\quad \\text{for } i = 1, \\dots, 12\n$$\n\n首先，我们为所提供的 12 对数据中的每一对计算其各自的差值 $\\Delta_i$：\n1.  $\\Delta_1 = -0.17 - (-0.18) = +0.01$\n2.  $\\Delta_2 = -0.23 - (-0.22) = -0.01$\n3.  $\\Delta_3 = -0.15 - (-0.16) = +0.01$\n4.  $\\Delta_4 = -0.19 - (-0.20) = +0.01$\n5.  $\\Delta_5 = -0.27 - (-0.25) = -0.02$\n6.  $\\Delta_6 = -0.11 - (-0.12) = +0.01$\n7.  $\\Delta_7 = -0.20 - (-0.19) = -0.01$\n8.  $\\Delta_8 = -0.22 - (-0.21) = -0.01$\n9.  $\\Delta_9 = -0.14 - (-0.15) = +0.01$\n10. $\\Delta_{10} = -0.24 - (-0.23) = -0.01$\n11. $\\Delta_{11} = -0.16 - (-0.17) = +0.01$\n12. $\\Delta_{12} = -0.26 - (-0.24) = -0.02$\n\n差值集合为 $\\{0.01, -0.01, 0.01, 0.01, -0.02, 0.01, -0.01, -0.01, 0.01, -0.01, 0.01, -0.02\\}$。\n\n偏倚是这些差值的平均值，记为 $\\bar{\\Delta}$：\n$$\n\\bar{\\Delta} = \\frac{1}{N} \\sum_{i=1}^{N} \\Delta_i\n$$\n差值之和为：\n$$\n\\sum_{i=1}^{12} \\Delta_i = 6(0.01) + 4(-0.01) + 2(-0.02) = 0.06 - 0.04 - 0.04 = -0.02\n$$\n因此，偏倚为：\n$$\n\\bar{\\Delta} = \\frac{-0.02}{12} = -\\frac{1}{600} \\approx -0.001666\\dots\n$$\n\n接下来，我们计算差值的样本标准差 $s_{\\Delta}$。样本方差 $s_{\\Delta}^2$ 由下式给出：\n$$\ns_{\\Delta}^2 = \\frac{1}{N-1} \\sum_{i=1}^{N} (\\Delta_i - \\bar{\\Delta})^2\n$$\n为计算此值，我们首先求出差值的平方和 $\\sum_{i=1}^{N} \\Delta_i^2$：\n$$\n\\sum_{i=1}^{12} \\Delta_i^2 = 6(0.01)^2 + 4(-0.01)^2 + 2(-0.02)^2 = 6(0.0001) + 4(0.0001) + 2(0.0004) = 0.0006 + 0.0004 + 0.0008 = 0.0018\n$$\n使用离差平方和的计算公式：\n$$\n\\sum_{i=1}^{N} (\\Delta_i - \\bar{\\Delta})^2 = \\sum_{i=1}^{N} \\Delta_i^2 - \\frac{\\left(\\sum_{i=1}^{N} \\Delta_i\\right)^2}{N} = 0.0018 - \\frac{(-0.02)^2}{12} = 0.0018 - \\frac{0.0004}{12} = 0.0018 - 0.0000333\\dots = 0.0017666\\dots\n$$\n样本方差为：\n$$\ns_{\\Delta}^2 = \\frac{0.0017666\\dots}{12-1} = \\frac{0.0017666\\dots}{11} \\approx 0.000160606\\dots\n$$\n样本标准差是方差的平方根：\n$$\ns_{\\Delta} = \\sqrt{0.000160606\\dots} \\approx 0.01267304\n$$\n\n95% 一致性界限定义为 $\\bar{\\Delta} \\pm 1.96 s_{\\Delta}$。问题指定使用乘数 1.96。\n首先，计算一致性余量：\n$$\n1.96 \\times s_{\\Delta} = 1.96 \\times 0.01267304 \\approx 0.02483916\n$$\n一致性界限的下限 $L_{lower}$ 为：\n$$\nL_{lower} = \\bar{\\Delta} - 1.96 s_{\\Delta} \\approx -0.00166667 - 0.02483916 = -0.02650583\n$$\n一致性界限的上限 $L_{upper}$ 为：\n$$\nL_{upper} = \\bar{\\Delta} + 1.96 s_{\\Delta} \\approx -0.00166667 + 0.02483916 = 0.02317249\n$$\n\n最后，我们将所需量——偏倚、下限和上限——四舍五入至四位有效数字。\n偏倚：$\\bar{\\Delta} \\approx -0.00166667 \\rightarrow -0.001667$\n下限：$L_{lower} \\approx -0.02650583 \\rightarrow -0.02651$\n上限：$L_{upper} \\approx 0.02317249 \\rightarrow 0.02317$\n\nBland-Altman 分析的结果是偏倚为 $-0.001667$，95% 一致性界限为 $-0.02651$ 到 $0.02317$。较小的偏倚表明，与 DENSE 测量值相比，该模型具有较低的系统误差。一致性界限定义了模型与测量值之间 95% 的差异预计会落入的范围。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.001667  -0.02651  0.02317 \\end{pmatrix}}\n$$"
        }
    ]
}