{
    "hands_on_practices": [
        {
            "introduction": "个体化建模的核心任务之一是根据临床图像赋予模型真实的力学属性。本练习将引导您完成一个基本工作流程，将CT扫描中的X射线衰减数据转换为组织弹性模量的估计值。通过应用比尔-朗伯定律和已建立的经验关系，您将亲身体验基于图像的材料属性分配背后的物理原理和假设。",
            "id": "4207180",
            "problem": "一束能量为 $E = 80\\,\\text{keV}$ 的单色X射线穿过厚度为 $L = 5.0\\,\\text{cm}$ 的均匀人体组织板。测量出射强度 $I$ 相对于入射强度 $I_0$ 的比值，在此能量下得到的强度比为 $I/I_0 = 0.138$。已知水在该能量下的线性衰减系数为 $\\mu_{\\text{w}} = 22.0\\,\\text{m}^{-1}$。对同一体素的计算机断层扫描（CT）重建报告了一个亨斯菲尔德单位（HU）值为 $\\text{HU} = 800$。使用组织等效模型和独立的成分测量，建立了一条扫描仪特定的电子密度校准曲线，该曲线通过多项式将电子密度 $\\rho_{\\text{e}}$ 与衰减对比度关联起来\n$$\n\\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} \\;=\\; 1 \\;+\\; \\lambda_1\\,\\delta \\;+\\; \\lambda_2\\,\\delta^{2},\n$$\n其中 $\\rho_{\\text{e,w}}$ 是水的电子密度，$\\delta = \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}}$，$\\mu$ 是组织在能量 $E$ 下的线性衰减系数，校准常数为 $\\lambda_1 = 0.70$ 和 $\\lambda_2 = 0.05$。CT亨斯菲尔德单位定义为\n$$\n\\text{HU} \\;=\\; 1000 \\left( \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}} \\right).\n$$\n对于特定于受试者的力学建模，一个基于回归的个性化方法通过以下公式将电子密度映射到弹性模量\n$$\nE_{\\text{tissue}} \\;=\\; E_0 \\left( \\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} \\right)^{\\alpha},\n$$\n其中 $E_0 = 4.00\\,\\text{GPa}$ 和 $\\alpha = 3.5$ 是通过匹配的成像和力学测试方案对矿化组织测得的经验常数。\n\n任务：\n- 从微分光子平衡和单位长度衰减率与局部强度成正比的假设出发，推导比尔-朗伯定律，并用它根据测量的 $I/I_0$ 和 $L$ 计算 $\\mu$。\n- 使用CT亨斯菲尔德单位的定义，将 $\\text{HU}$ 与 $\\delta$ 关联起来，并说明如何将其代入电子密度校准公式以获得 $\\rho_{\\text{e}}/\\rho_{\\text{e,w}}$。\n- 综合这些结果，计算特定于受试者的弹性模量 $E_{\\text{tissue}}$。\n\n以吉帕斯卡（GPa）为单位表示最终的弹性模量。将最终数值答案四舍五入至三位有效数字。",
            "solution": "根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 入射X射线能量: $E = 80\\,\\text{keV}$\n- 组织厚度: $L = 5.0\\,\\text{cm}$\n- 强度比: $I/I_0 = 0.138$\n- 水在能量 $E$ 下的线性衰减系数: $\\mu_{\\text{w}} = 22.0\\,\\text{m}^{-1}$\n- 亨斯菲尔德单位值: $\\text{HU} = 800$\n- 电子密度校准曲线: $\\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} = 1 + \\lambda_1\\,\\delta + \\lambda_2\\,\\delta^{2}$\n- 衰减对比度 $\\delta$ 的定义: $\\delta = \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}}$\n- 校准常数: $\\lambda_1 = 0.70$\n- 校准常数: $\\lambda_2 = 0.05$\n- 亨斯菲尔德单位定义: $\\text{HU} = 1000 \\left( \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}} \\right)$\n- 弹性模量回归关系: $E_{\\text{tissue}} = E_0 \\left( \\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} \\right)^{\\alpha}$\n- 回归常数: $E_0 = 4.00\\,\\text{GPa}$\n- 回归指数: $\\alpha = 3.5$\n- 任务：(i) 推导比尔-朗伯定律并计算 $\\mu$。(ii) 将 $\\text{HU}$ 与 $\\delta$ 关联并计算 $\\rho_{\\text{e}}/\\rho_{\\text{e,w}}$。(iii) 计算特定于受试者的弹性模量 $E_{\\text{tissue}}$。\n- 最终答案要求：以吉帕斯卡（GPa）表示结果，并四舍五入至三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于医学物理学（比尔-朗伯定律，CT亨斯菲尔德单位）和生物力学（密度-模量关系）的既定原理。所有概念和定义都是该领域的标准。\n- **适定性**：该问题提供了所有必要的参数和方程，可以按逻辑顺序执行所要求的计算。它是自洽的。\n- **客观性**：该问题使用精确、正式和无偏见的语言陈述。\n- **一致性检查**：该问题提供了两种可能的途径来确定组织的线性衰减系数 $\\mu$。一种是通过透射实验（$I/I_0, L$），另一种是通过亨斯菲尔德单位值（$\\text{HU}, \\mu_{\\text{w}}$）。我们来检查一致性。\n    - 根据透射数据：$\\mu = -\\frac{1}{L}\\ln(I/I_0)$。当 $L = 5.0\\,\\text{cm} = 0.050\\,\\text{m}$ 时，我们得到 $\\mu = -\\frac{1}{0.050\\,\\text{m}}\\ln(0.138) \\approx -20 \\times (-1.9805) \\approx 39.61\\,\\text{m}^{-1}$。\n    - 根据亨斯菲尔德单位定义：$\\text{HU} = 1000 \\left( \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}} \\right)$。当 $\\text{HU}=800$ 且 $\\mu_{\\text{w}} = 22.0\\,\\text{m}^{-1}$ 时，我们有 $800 = 1000 \\left( \\frac{\\mu - 22.0}{22.0} \\right)$，简化为 $0.8 = \\frac{\\mu - 22.0}{22.0}$。这给出 $\\mu = 22.0 \\times (1 + 0.8) = 22.0 \\times 1.8 = 39.6\\,\\text{m}^{-1}$。\n- 从两组提供的信息计算出的 $\\mu$ 值是一致的（$39.61\\,\\text{m}^{-1}$ 对比 $39.6\\,\\text{m}^{-1}$）。这证实了问题没有矛盾，而是结构良好，透射数据作为物理基础与报告的CT值相符。任务指导用户恰当地使用这两条信息。该问题不违反任何无效标准。\n\n**步骤3：结论与行动**\n- 问题是 **有效的**。将继续求解过程。\n\n### 解答\n\n解答过程遵循问题陈述中列出的三个任务。\n\n**任务1：推导比尔-朗伯定律并计算 $\\mu$**\n\n问题陈述，单位长度的衰减率与局部强度成正比。设 $I(x)$ 为X射线束在组织内深度 $x$ 处的强度。在无穷小厚度 $dx$ 内的强度变化 $dI$ 是一个减少量，该减少量与该点的强度 $I(x)$ 和厚度 $dx$ 均成正比。比例常数是线性衰减系数 $\\mu$。该关系表示为微分方程：\n$$\ndI = -\\mu I(x) dx\n$$\n为了求出穿过有限厚度 $L$ 的板后的强度 $I$，我们必须对该方程进行积分。我们重新整理方程以分离变量：\n$$\n\\frac{dI}{I} = -\\mu dx\n$$\n我们对两边进行积分。强度从 $x=0$ 处的入射值 $I_0$ 减小到 $x=L$ 处的透射值 $I$。组织是均匀的，因此 $\\mu$ 在整个路径长度上是恒定的。\n$$\n\\int_{I_0}^{I} \\frac{dI'}{I'} = \\int_{0}^{L} (-\\mu) dx'\n$$\n进行积分得到：\n$$\n[\\ln(I')]_{I_0}^{I} = -\\mu [x']_{0}^{L}\n$$\n$$\n\\ln(I) - \\ln(I_0) = -\\mu (L - 0)\n$$\n$$\n\\ln\\left(\\frac{I}{I_0}\\right) = -\\mu L\n$$\n对两边取指数，得到比尔-朗伯定律：\n$$\nI = I_0 \\exp(-\\mu L)\n$$\n现在，我们计算给定组织的线性衰减系数 $\\mu$。我们使用该定律的对数形式，并代入所给值 $L = 5.0\\,\\text{cm} = 0.050\\,\\text{m}$ 和 $I/I_0 = 0.138$：\n$$\n\\mu = -\\frac{1}{L} \\ln\\left(\\frac{I}{I_0}\\right) = -\\frac{1}{0.050\\,\\text{m}} \\ln(0.138)\n$$\n$$\n\\mu \\approx -\\frac{1}{0.050\\,\\text{m}} \\times (-1.98050) \\approx 39.610\\,\\text{m}^{-1}\n$$\n\n**任务2：将HU与 $\\delta$ 关联并计算 $\\rho_{\\text{e}}/\\rho_{\\text{e,w}}$**\n\n亨斯菲尔德单位（$\\text{HU}$）和衰减对比度 $\\delta$ 的定义如下：\n$$\n\\text{HU} = 1000 \\left( \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}} \\right)\n$$\n$$\n\\delta = \\frac{\\mu - \\mu_{\\text{w}}}{\\mu_{\\text{w}}}\n$$\n通过直接比较，$\\text{HU}$ 和 $\\delta$ 之间的关系是：\n$$\n\\text{HU} = 1000\\,\\delta \\quad \\implies \\quad \\delta = \\frac{\\text{HU}}{1000}\n$$\n使用给定的CT重建值 $\\text{HU} = 800$，我们计算 $\\delta$：\n$$\n\\delta = \\frac{800}{1000} = 0.8\n$$\n现在，我们将此 $\\delta$ 值用于扫描仪特定的电子密度校准曲线，以求得归一化电子密度 $\\rho_{\\text{e}}/\\rho_{\\text{e,w}}$：\n$$\n\\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} = 1 + \\lambda_1\\,\\delta + \\lambda_2\\,\\delta^{2}\n$$\n代入值 $\\delta=0.8$, $\\lambda_1 = 0.70$ 和 $\\lambda_2 = 0.05$：\n$$\n\\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} = 1 + (0.70)(0.8) + (0.05)(0.8)^2\n$$\n$$\n\\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} = 1 + 0.56 + (0.05)(0.64)\n$$\n$$\n\\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} = 1 + 0.56 + 0.032 = 1.592\n$$\n\n**任务3：计算特定于受试者的弹性模量 $E_{\\text{tissue}}$**\n\n最后一步是使用提供的基于回归的个性化公式计算组织的弹性模量 $E_{\\text{tissue}}$。该公式将归一化电子密度与力学性质关联起来：\n$$\nE_{\\text{tissue}} = E_0 \\left( \\frac{\\rho_{\\text{e}}}{\\rho_{\\text{e,w}}} \\right)^{\\alpha}\n$$\n我们代入已知值：任务2的结果 $\\rho_{\\text{e}}/\\rho_{\\text{e,w}} = 1.592$，以及经验常数 $E_0 = 4.00\\,\\text{GPa}$ 和 $\\alpha = 3.5$。\n$$\nE_{\\text{tissue}} = (4.00\\,\\text{GPa}) \\times (1.592)^{3.5}\n$$\n首先，计算 $(1.592)^{3.5}$ 的值：\n$$\n(1.592)^{3.5} \\approx 5.08785\n$$\n现在，乘以 $E_0$：\n$$\nE_{\\text{tissue}} = 4.00\\,\\text{GPa} \\times 5.08785 \\approx 20.3514\\,\\text{GPa}\n$$\n问题要求将最终答案四舍五入至三位有效数字。\n$$\nE_{\\text{tissue}} \\approx 20.4\\,\\text{GPa}\n$$",
            "answer": "$$\n\\boxed{20.4}\n$$"
        },
        {
            "introduction": "通过将模型参数与实验数据进行拟合来实现模型个体化，这通常是一个不适定的反问题。本练习探讨了参数可辨识性这一关键概念，使用灵敏度矩阵的奇异值分解（SVD）来判断数据在多大程度上可以确定参数的估计值。通过分析测量灵敏度如何影响后验参数的不确定性，您将学会量化您对个体化模型参数的置信度。",
            "id": "4207168",
            "problem": "您正在根据基于成像的测量结果，为一个特定受试者的双参数线性化生物力学个性化问题进行建模。该成像方式提供位移测量值，这些测量值被建模为两个材料参数（弹性模量和泊松比）的可微函数。在参考参数矢量周围进行线性化后，测量值可以通过一个带有加性噪声的线性模型来近似。您的目标是使用灵敏度矩阵的奇异值分解（SVD）来量化参数的可识别性，并在弱高斯先验下计算由此产生的参数方差。\n\n假设设置如下：\n- 设参数矢量为 $\\boldsymbol{\\theta} = [\\theta_1,\\theta_2]^\\top$，其中 $\\theta_1$ 是以千帕（kPa）为单位的弹性模量，$\\theta_2$ 是无量纲的泊松比。\n- 设灵敏度矩阵为 $\\mathbf{J} \\in \\mathbb{R}^{m \\times 2}$，其中 $m$ 是来自成像的独立位移测量次数。$\\mathbf{J}$ 的每个条目代表预测位移（以毫米为单位）关于每个参数的偏导数。\n- 设测量噪声为加性、零均值的高斯噪声，其独立分量的标准差为 $\\sigma$ 毫米，因此测量模型为 $\\mathbf{y} \\approx \\mathbf{y}_{\\text{ref}} + \\mathbf{J}\\,\\Delta\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$，其中 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I})$。\n- 假设参数上存在一个弱的、独立的高斯先验，其标准差收集在一个对角矩阵 $\\mathbf{S}_p = \\mathrm{diag}(s_{\\theta_1}, s_{\\theta_2})$ 中，其中 $s_{\\theta_1}$ 的单位是千帕（kPa），$s_{\\theta_2}$ 是无量纲的。该先验在确保数值稳定性的同时，与数据相比仍然是弱的。\n\n基本基础：\n- 使用线性化观测模型 $\\mathbf{y} \\approx \\mathbf{y}_{\\text{ref}} + \\mathbf{J}\\,\\Delta\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$、加性独立高斯噪声 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I})$ 以及奇异值分解（SVD）的定义 $\\mathbf{J} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\top$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是正交的，$\\boldsymbol{\\Sigma}$ 包含非负奇异值。\n- 通过 $\\boldsymbol{\\Sigma}$ 的谱来量化可识别性，并使用从带有弱高斯先验的高斯线性模型推导出的后验协方差来计算参数方差。您必须在推理和计算中明确使用 SVD 结构。除这些基础之外，不要依赖任何快捷公式或恒等式。\n\n任务：\n1. 对于下面的每个测试案例，通过 SVD 计算 $\\mathbf{J}$ 的奇异值，将它们按降序排序，并计算条件数 $\\kappa$，其定义为最大奇异值与最小非零奇异值的比率。如果最小奇异值在数值上为零（将小于 $10^{-12}$ 的值视为零），则将 $\\kappa$ 设置为 $+\\infty$。\n2. 使用弱高斯先验，计算 $\\Delta\\boldsymbol{\\theta}$ 的后验协方差矩阵，并提取参数标准差。您必须以千帕（kPa）表示弹性模量标准差，以无量纲形式表示泊松比标准差。将每个标准差四舍五入到恰好 $6$ 位小数。\n3. 通过比较不同案例的条件数和由此产生的标准差，解释小奇异值对参数方差的影响。这种解释应反映在您的计算输出中；您无需打印超出指定输出格式的文本。\n\n测试套件：\n为以下三个案例提供结果。所有数值实体必须严格按照规定处理。在每个案例中，$\\mathbf{J}$ 是一个实数矩阵，其条目单位为毫米/参数单位。\n\n- 案例 A（良态）：\n  - 灵敏度矩阵 $\\mathbf{J}_A = \\begin{bmatrix} 0.8  0.1 \\\\ 0.0  1.0 \\\\ 1.2  -0.1 \\\\ 0.5  0.2 \\end{bmatrix}$。\n  - 噪声标准差 $\\sigma_A = 0.05$（毫米）。\n  - 弱先验标准差 $\\mathbf{S}_{p,A} = \\mathrm{diag}(100.0, 0.2)$，其中 $100.0$ 的单位是千帕（kPa），$0.2$ 是无量纲的。\n\n- 案例 B（高度相关参数，病态）：\n  - 灵敏度矩阵 $\\mathbf{J}_B = \\begin{bmatrix} 1.0  0.99 \\\\ 0.9  0.89 \\\\ 1.1  1.09 \\\\ 1.05  1.04 \\end{bmatrix}$。\n  - 噪声标准差 $\\sigma_B = 0.10$（毫米）。\n  - 弱先验标准差 $\\mathbf{S}_{p,B} = \\mathrm{diag}(100.0, 0.2)$，其中 $100.0$ 的单位是千帕（kPa），$0.2$ 是无量纲的。\n\n- 案例 C（近秩亏）：\n  - 灵敏度矩阵 $\\mathbf{J}_C = \\begin{bmatrix} 10^{-4}  1.0 \\\\ -10^{-4}  1.0 \\\\ 2\\times 10^{-4}  1.0 \\\\ -2\\times 10^{-4}  1.0 \\end{bmatrix}$。\n  - 噪声标准差 $\\sigma_C = 0.01$（毫米）。\n  - 弱先验标准差 $\\mathbf{S}_{p,C} = \\mathrm{diag}(100.0, 0.2)$，其中 $100.0$ 的单位是千帕（kPa），$0.2$ 是无量纲的。\n\n计算要求：\n- 对于每个案例，计算 $\\kappa$ 以及后验参数标准差 $s_{\\theta_1}$（单位为千帕）和 $s_{\\theta_2}$（无量纲）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个案例，其本身是一个形式为 $[\\kappa, s_{\\theta_1}, s_{\\theta_2}]$ 的列表。例如，输出格式必须为 $[[\\kappa_A, s_{\\theta_1,A}, s_{\\theta_2,A}],[\\kappa_B, s_{\\theta_1,B}, s_{\\theta_2,B}],[\\kappa_C, s_{\\theta_1,C}, s_{\\theta_2,C}]]$，所有数值都以标准十进制表示法（无科学符号）打印，并且每个标准差都四舍五入到恰好 $6$ 位小数。条件数应作为标准浮点数打印，不带单位。",
            "solution": "该问题被验证为具有科学依据、适定且客观。所有必需的数据和定义均已提供，不存在内部矛盾或违反基本原则的情况。该问题是在 Bayes 线性模型框架内进行参数可识别性和不确定性量化的标准练习，这是生物力学建模中的一项常见任务。\n\n对于每个案例研究，解决方案分两个主要阶段进行：首先，使用灵敏度矩阵 $\\mathbf{J}$ 的奇异值分解（SVD）分析参数的可识别性；其次，通过后验协方差矩阵计算参数的不确定性。\n\n设参数矢量为 $\\boldsymbol{\\theta} = [\\theta_1, \\theta_2]^\\top$。线性化测量模型由 $\\mathbf{y} \\approx \\mathbf{y}_{\\text{ref}} + \\mathbf{J}\\,\\Delta\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$ 给出，其中 $\\Delta\\boldsymbol{\\theta}$ 是与参考参数矢量的偏差，$\\mathbf{J}$ 是灵敏度矩阵，$\\boldsymbol{\\varepsilon}$ 是零均值高斯噪声，其协方差为 $\\mathbf{C}_{\\varepsilon} = \\sigma^2 \\mathbf{I}$。\n\n在给定参数偏差 $\\Delta\\boldsymbol{\\theta}$ 的情况下，观测到数据的似然与一个高斯函数成正比：\n$$ p(\\mathbf{y} | \\Delta\\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} (\\mathbf{J}\\Delta\\boldsymbol{\\theta} - \\Delta\\mathbf{y})^\\top \\mathbf{C}_{\\varepsilon}^{-1} (\\mathbf{J}\\Delta\\boldsymbol{\\theta} - \\Delta\\mathbf{y}) \\right) $$\n其中 $\\Delta\\mathbf{y} = \\mathbf{y} - \\mathbf{y}_{\\text{ref}}$。\n参数具有以零偏差为中心的弱高斯先验分布，$p(\\Delta\\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} \\Delta\\boldsymbol{\\theta}^\\top \\mathbf{C}_{p}^{-1} \\Delta\\boldsymbol{\\theta} \\right)$，其中先验协方差为 $\\mathbf{C}_p = \\mathbf{S}_p^2 = \\mathrm{diag}(s_{\\theta_1}^2, s_{\\theta_2}^2)$。\n\n根据 Bayes 定理，后验分布 $p(\\Delta\\boldsymbol{\\theta} | \\mathbf{y})$ 与似然和先验的乘积成正比。由于两者都是高斯分布，后验分布也是高斯分布。后验协方差矩阵的逆 $\\mathbf{C}_{\\text{post}}^{-1}$ 是来自似然二次项和先验二次项的逆协方差矩阵之和：\n$$ \\mathbf{C}_{\\text{post}}^{-1} = \\mathbf{J}^\\top \\mathbf{C}_{\\varepsilon}^{-1} \\mathbf{J} + \\mathbf{C}_{p}^{-1} $$\n代入 $\\mathbf{C}_{\\varepsilon}^{-1} = \\frac{1}{\\sigma^2}\\mathbf{I}$，我们得到：\n$$ \\mathbf{C}_{\\text{post}} = \\left( \\frac{1}{\\sigma^2} \\mathbf{J}^\\top \\mathbf{J} + \\mathbf{C}_{p}^{-1} \\right)^{-1} $$\n\n后验参数方差是 $\\mathbf{C}_{\\text{post}}$ 的对角元素，标准差是它们的平方根。\n\n可识别性分析将使用灵敏度矩阵的 SVD 进行，即 $\\mathbf{J} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{V}^\\top$，其中 $\\mathbf{U}$ 和 $\\mathbf{V}$ 是正交矩阵，$\\boldsymbol{\\Sigma}$ 是一个包含非负奇异值 $s_1 \\ge s_2 \\ge \\dots \\ge 0$ 的矩形对角矩阵。$\\mathbf{J}^\\top\\mathbf{J}$ 项可以使用 SVD 分量表示为 $\\mathbf{J}^\\top\\mathbf{J} = \\mathbf{V}\\boldsymbol{\\Sigma}^\\top\\boldsymbol{\\Sigma}\\mathbf{V}^\\top$。对于一个双参数问题，$\\boldsymbol{\\Sigma}^\\top\\boldsymbol{\\Sigma} = \\mathrm{diag}(s_1^2, s_2^2)$。\n\n奇异值表示测量值对参数沿 $\\mathbf{V}$ 的列（右奇异向量）所定义方向变化的灵敏度。一个非常小的奇异值表明测量值对相应方向上的参数变化不敏感，导致可识别性差。条件数 $\\kappa = s_1/s_2$（对于 $s_2 > 0$）量化了这种差异。大的 $\\kappa$ 表示病态，即至少有一个参数组合很难由数据确定。\n\n我们现在将此框架应用于每个案例。\n\n**案例 A：良态**\n- $\\mathbf{J}_A = \\begin{bmatrix} 0.8  0.1 \\\\ 0.0  1.0 \\\\ 1.2  -0.1 \\\\ 0.5  0.2 \\end{bmatrix}$, $\\sigma_A = 0.05$, $\\mathbf{S}_{p,A} = \\mathrm{diag}(100.0, 0.2)$。\n1.  **SVD 和条件数**：\n    $\\mathbf{J}_A$ 的 SVD 产生奇异值 $s_1 \\approx 1.5307$ 和 $s_2 \\approx 1.0450$。这些值的大小相似。\n    条件数为 $\\kappa_A = s_1/s_2 \\approx 1.5307 / 1.0450 \\approx 1.4647$。这个低值表明问题是良态的。\n2.  **后验协方差**：\n    先验协方差矩阵为 $\\mathbf{C}_{p,A} = \\mathrm{diag}(100^2, 0.2^2) = \\mathrm{diag}(10000, 0.04)$，因此 $\\mathbf{C}_{p,A}^{-1} = \\mathrm{diag}(0.0001, 25)$。\n    我们计算 $\\mathbf{J}_A^\\top \\mathbf{J}_A = \\begin{bmatrix} 2.33  0.11 \\\\ 0.11  1.06 \\end{bmatrix}$。\n    后验协方差的逆为 $\\mathbf{C}_{\\text{post},A}^{-1} = \\frac{1}{0.05^2} \\mathbf{J}_A^\\top \\mathbf{J}_A + \\mathbf{C}_{p,A}^{-1} = 400 \\begin{bmatrix} 2.33  0.11 \\\\ 0.11  1.06 \\end{bmatrix} + \\begin{bmatrix} 0.0001  0 \\\\ 0  25 \\end{bmatrix} = \\begin{bmatrix} 932.0001  44 \\\\ 44  449 \\end{bmatrix}$。\n    对其求逆得到后验协方差 $\\mathbf{C}_{\\text{post},A} \\approx \\begin{bmatrix} 0.001075  -0.000105 \\\\ -0.000105  0.002231 \\end{bmatrix}$。\n    后验方差是对角元素：$\\mathrm{var}(\\Delta\\theta_1) \\approx 0.001075$ 和 $\\mathrm{var}(\\Delta\\theta_2) \\approx 0.002231$。\n    标准差为 $s_{\\theta_1,A} = \\sqrt{0.001075} \\approx 0.032784$ kPa 和 $s_{\\theta_2,A} = \\sqrt{0.002231} \\approx 0.047236$。\n\n**案例 B：高度相关参数，病态**\n- $\\mathbf{J}_B = \\begin{bmatrix} 1.0  0.99 \\\\ 0.9  0.89 \\\\ 1.1  1.09 \\\\ 1.05  1.04 \\end{bmatrix}$, $\\sigma_B = 0.10$, $\\mathbf{S}_{p,B} = \\mathrm{diag}(100.0, 0.2)$。\n1.  **SVD 和条件数**：\n    $\\mathbf{J}_B$ 的列几乎是线性相关的。SVD 产生奇异值 $s_1 \\approx 2.8466$ 和 $s_2 \\approx 0.0200$。\n    条件数为 $\\kappa_B = s_1/s_2 \\approx 2.8466 / 0.0200 \\approx 142.37$。这个高值表明问题是病态的，即测量对一种参数组合敏感，但对另一种不敏感。\n2.  **后验协方差**：\n    先验与案例 A 相同。\n    我们计算 $\\mathbf{J}_B^\\top \\mathbf{J}_B = \\begin{bmatrix} 4.1225  4.081 \\\\ 4.081  4.04 \\end{bmatrix}$。\n    后验协方差的逆为 $\\mathbf{C}_{\\text{post},B}^{-1} = \\frac{1}{0.10^2} \\mathbf{J}_B^\\top \\mathbf{J}_B + \\mathbf{C}_{p,B}^{-1} = 100 \\begin{bmatrix} 4.1225  4.081 \\\\ 4.081  4.04 \\end{bmatrix} + \\begin{bmatrix} 0.0001  0 \\\\ 0  25 \\end{bmatrix} = \\begin{bmatrix} 412.2501  408.1 \\\\ 408.1  429 \\end{bmatrix}$。\n    求逆得到 $\\mathbf{C}_{\\text{post},B} \\approx \\begin{bmatrix} 0.040188  -0.038228 \\\\ -0.038228  0.038618 \\end{bmatrix}$。\n    后验方差为 $\\mathrm{var}(\\Delta\\theta_1) \\approx 0.040188$ 和 $\\mathrm{var}(\\Delta\\theta_2) \\approx 0.038618$。\n    标准差为 $s_{\\theta_1,B} = \\sqrt{0.040188} \\approx 0.200469$ kPa 和 $s_{\\theta_2,B} = \\sqrt{0.038618} \\approx 0.196515$。与良态案例相比，高条件数正确地对应了更大的后验不确定性，尽管噪声水平也有所增加。\n\n**案例 C：近秩亏**\n- $\\mathbf{J}_C = \\begin{bmatrix} 10^{-4}  1.0 \\\\ -10^{-4}  1.0 \\\\ 2\\times 10^{-4}  1.0 \\\\ -2\\times 10^{-4}  1.0 \\end{bmatrix}$, $\\sigma_C = 0.01$, $\\mathbf{S}_{p,C} = \\mathrm{diag}(100.0, 0.2)$。\n1.  **SVD 和条件数**：\n    $\\mathbf{J}_C$ 的第一列条目与第二列相比数量级非常小，表明对 $\\theta_1$ 的灵敏度非常低。\n    SVD 产生奇异值 $s_1 \\approx 2.0000$ 和 $s_2 \\approx 0.000316$。\n    条件数为 $\\kappa_C = s_1/s_2 \\approx 2.0000 / 0.000316 \\approx 6324.56$。这个极高的值表示严重病态。\n2.  **后验协方差**：\n    先验与案例 A 和 B 相同。$\\mathbf{J}_C$ 的列是正交的。\n    我们计算 $\\mathbf{J}_C^\\top \\mathbf{J}_C = \\begin{bmatrix} 10^{-7}  0 \\\\ 0  4 \\end{bmatrix}$。\n    后验协方差的逆为 $\\mathbf{C}_{\\text{post},C}^{-1} = \\frac{1}{0.01^2} \\mathbf{J}_C^\\top \\mathbf{J}_C + \\mathbf{C}_{p,C}^{-1} = 10000 \\begin{bmatrix} 10^{-7}  0 \\\\ 0  4 \\end{bmatrix} + \\begin{bmatrix} 0.0001  0 \\\\ 0  25 \\end{bmatrix} = \\begin{bmatrix} 0.0011  0 \\\\ 0  40025 \\end{bmatrix}$。\n    由于该矩阵是对角矩阵，求逆是微不足道的，得到 $\\mathbf{C}_{\\text{post},C} \\approx \\begin{bmatrix} 909.09  0 \\\\ 0  0.00002498 \\end{bmatrix}$。\n    后验方差为 $\\mathrm{var}(\\Delta\\theta_1) \\approx 909.09$ 和 $\\mathrm{var}(\\Delta\\theta_2) \\approx 0.00002498$。\n    标准差为 $s_{\\theta_1,C} = \\sqrt{909.09} \\approx 30.151134$ kPa 和 $s_{\\theta_2,C} = \\sqrt{0.00002498} \\approx 0.004998$。\n    $\\theta_1$ 中的巨大不确定性是低灵敏度（小奇异值）的直接结果。其后验不确定性小于先验（$30.15  100$），但仍然非常大。相比之下，由于高灵敏度（大奇异值）和低测量噪声，$\\theta_2$ 被高精度地识别出来。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes parameter identifiability metrics (condition number) and posterior\n    parameter standard deviations for three biomechanical personalization cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"J\": np.array([\n                [0.8, 0.1],\n                [0.0, 1.0],\n                [1.2, -0.1],\n                [0.5, 0.2]\n            ]),\n            \"sigma\": 0.05,\n            \"s_p_diag\": np.array([100.0, 0.2])\n        },\n        {\n            \"name\": \"Case B\",\n            \"J\": np.array([\n                [1.0, 0.99],\n                [0.9, 0.89],\n                [1.1, 1.09],\n                [1.05, 1.04]\n            ]),\n            \"sigma\": 0.10,\n            \"s_p_diag\": np.array([100.0, 0.2])\n        },\n        {\n            \"name\": \"Case C\",\n            \"J\": np.array([\n                [1e-4, 1.0],\n                [-1e-4, 1.0],\n                [2e-4, 1.0],\n                [-2e-4, 1.0]\n            ]),\n            \"sigma\": 0.01,\n            \"s_p_diag\": np.array([100.0, 0.2])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        J = case[\"J\"]\n        sigma = case[\"sigma\"]\n        s_p_diag = case[\"s_p_diag\"]\n\n        # Task 1: SVD and Condition Number\n        # U, s, Vt are computed, but only s is needed here.\n        # numpy's svd function returns singular values sorted in descending order.\n        singular_values = np.linalg.svd(J, compute_uv=False)\n        \n        s_max = singular_values[0]\n        s_min = singular_values[-1] # Smallest singular value\n\n        # Per problem spec, treat values  1e-12 as zero.\n        if s_min  1e-12:\n            kappa = np.inf\n        else:\n            kappa = s_max / s_min\n\n        # Task 2: Posterior Covariance and Standard Deviations\n        # Prior covariance matrix C_p = diag(s_p^2)\n        # Its inverse C_p_inv = diag(1/s_p^2)\n        C_p_inv = np.diag(1.0 / (s_p_diag**2))\n\n        # Fisher Information from data: (1/sigma^2) * J^T * J\n        JtJ = J.T @ J\n        \n        # Inverse of posterior covariance: C_post_inv = (1/sigma^2)J^T*J + C_p_inv\n        C_post_inv = (1.0 / sigma**2) * JtJ + C_p_inv\n\n        # Posterior covariance\n        C_post = np.linalg.inv(C_post_inv)\n\n        # Variances are the diagonal elements of the posterior covariance matrix.\n        variances = np.diag(C_post)\n        \n        # Standard deviations are the square root of variances.\n        posterior_stdevs = np.sqrt(variances)\n        s_theta1 = posterior_stdevs[0]\n        s_theta2 = posterior_stdevs[1]\n        \n        results.append(f\"[{kappa},{s_theta1:.6f},{s_theta2:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "只有当个体化模型的预测与实际情况相符时，它才是有用的。这最后一个练习聚焦于模型验证，这是确认模型预测能力的关键步骤。您将执行Bland-Altman分析，以定量地比较模型预测的心脏应变与来自DENSE MRI的体内测量值，从而学会如何解读偏倚和一致性界限，并以此作为模型适切性的衡量标准。",
            "id": "4207157",
            "problem": "结合电影磁共振成像和激励回波位移编码 (DENSE) 磁共振成像，根据影像构建了一个特定于受试者的左心室有限元模型。DENSE 磁共振成像提供了一个体素位移场，通过基于变形梯度 $F$ 的标准连续介质力学定义，即 Green-Lagrange 应变 $E = \\frac{1}{2}\\left(F^{\\top}F - I\\right)$，可以从中获得收缩末期的拉格朗日环向应变 $E_{cc}$，并按美国心脏协会 (American Heart Association) 分段进行汇总。该模型使用根据同一受试者影像数据拟合的个性化本构参数集来预测 $E_{cc}$。\n\n对于 $i = 1, \\dots, 12$ 个心肌段，收缩末期测得和预测的拉格朗日环向应变如下所示，其中 $E^{\\mathrm{DENSE}}_{cc,i}$ 表示 DENSE 磁共振成像测量值，$E^{\\mathrm{model}}_{cc,i}$ 表示模型预测值：\n$(E^{\\mathrm{DENSE}}_{cc,1}, E^{\\mathrm{model}}_{cc,1}) = (-0.18, -0.17)$，$(E^{\\mathrm{DENSE}}_{cc,2}, E^{\\mathrm{model}}_{cc,2}) = (-0.22, -0.23)$，$(E^{\\mathrm{DENSE}}_{cc,3}, E^{\\mathrm{model}}_{cc,3}) = (-0.16, -0.15)$，$(E^{\\mathrm{DENSE}}_{cc,4}, E^{\\mathrm{model}}_{cc,4}) = (-0.20, -0.19)$，$(E^{\\mathrm{DENSE}}_{cc,5}, E^{\\mathrm{model}}_{cc,5}) = (-0.25, -0.27)$，$(E^{\\mathrm{DENSE}}_{cc,6}, E^{\\mathrm{model}}_{cc,6}) = (-0.12, -0.11)$，$(E^{\\mathrm{DENSE}}_{cc,7}, E^{\\mathrm{model}}_{cc,7}) = (-0.19, -0.20)$，$(E^{\\mathrm{DENSE}}_{cc,8}, E^{\\mathrm{model}}_{cc,8}) = (-0.21, -0.22)$，$(E^{\\mathrm{DENSE}}_{cc,9}, E^{\\mathrm{model}}_{cc,9}) = (-0.15, -0.14)$，$(E^{\\mathrm{DENSE}}_{cc,10}, E^{\\mathrm{model}}_{cc,10}) = (-0.23, -0.24)$，$(E^{\\mathrm{DENSE}}_{cc,11}, E^{\\mathrm{model}}_{cc,11}) = (-0.17, -0.16)$，$(E^{\\mathrm{DENSE}}_{cc,12}, E^{\\mathrm{model}}_{cc,12}) = (-0.24, -0.26)$。\n\n请执行 Bland–Altman 分析，通过计算偏倚（平均差值）和 95% 一致性界限来比较模型预测值与 DENSE 磁共振成像测量值。差值定义为 $\\Delta_i = E^{\\mathrm{model}}_{cc,i} - E^{\\mathrm{DENSE}}_{cc,i}$。假设差值近似呈正态分布，并使用常规的 1.96 乘数来构建 95% 一致性界限。将偏倚、一致性界限的下限和上限报告为三个无量纲十进制数。将结果四舍五入至四位有效数字。将所有量表示为无量纲十进制数。",
            "solution": "该问题陈述是关于计算模型预测与实验测量值进行统计比较的一个有效练习，这是生物力学领域，特别是受试者特异性建模中的一项常见任务。该问题提供了所有必要的数据和方法学约束，以得出一个唯一的、可验证的解。\n\n目标是执行 Bland-Altman 分析，以比较模型预测的拉格朗日环向应变 $E^{\\mathrm{model}}_{cc}$ 与 DENSE MRI 测量的应变 $E^{\\mathrm{DENSE}}_{cc}$。该分析需要计算偏倚（平均差值）和 95% 一致性界限。\n\n对于 $N=12$ 个心肌段，每个段的差值定义为：\n$$\n\\Delta_i = E^{\\mathrm{model}}_{cc,i} - E^{\\mathrm{DENSE}}_{cc,i} \\quad \\text{for } i = 1, \\dots, 12\n$$\n\n首先，我们计算所提供的 12 对数据中每一对的单个差值 $\\Delta_i$：\n1.  $\\Delta_1 = -0.17 - (-0.18) = +0.01$\n2.  $\\Delta_2 = -0.23 - (-0.22) = -0.01$\n3.  $\\Delta_3 = -0.15 - (-0.16) = +0.01$\n4.  $\\Delta_4 = -0.19 - (-0.20) = +0.01$\n5.  $\\Delta_5 = -0.27 - (-0.25) = -0.02$\n6.  $\\Delta_6 = -0.11 - (-0.12) = +0.01$\n7.  $\\Delta_7 = -0.20 - (-0.19) = -0.01$\n8.  $\\Delta_8 = -0.22 - (-0.21) = -0.01$\n9.  $\\Delta_9 = -0.14 - (-0.15) = +0.01$\n10. $\\Delta_{10} = -0.24 - (-0.23) = -0.01$\n11. $\\Delta_{11} = -0.16 - (-0.17) = +0.01$\n12. $\\Delta_{12} = -0.26 - (-0.24) = -0.02$\n\n差值集合为 $\\{0.01, -0.01, 0.01, 0.01, -0.02, 0.01, -0.01, -0.01, 0.01, -0.01, 0.01, -0.02\\}$。\n\n偏倚是这些差值的平均值，记作 $\\bar{\\Delta}$：\n$$\n\\bar{\\Delta} = \\frac{1}{N} \\sum_{i=1}^{N} \\Delta_i\n$$\n差值之和为：\n$$\n\\sum_{i=1}^{12} \\Delta_i = 6(0.01) + 4(-0.01) + 2(-0.02) = 0.06 - 0.04 - 0.04 = -0.02\n$$\n因此，偏倚为：\n$$\n\\bar{\\Delta} = \\frac{-0.02}{12} = -\\frac{1}{600} \\approx -0.001666\\dots\n$$\n\n接下来，我们计算差值的样本标准差 $s_{\\Delta}$。样本方差 $s_{\\Delta}^2$ 由下式给出：\n$$\ns_{\\Delta}^2 = \\frac{1}{N-1} \\sum_{i=1}^{N} (\\Delta_i - \\bar{\\Delta})^2\n$$\n为计算此值，我们首先求出差值的平方和 $\\sum_{i=1}^{N} \\Delta_i^2$：\n$$\n\\sum_{i=1}^{12} \\Delta_i^2 = 6(0.01)^2 + 4(-0.01)^2 + 2(-0.02)^2 = 6(0.0001) + 4(0.0001) + 2(0.0004) = 0.0006 + 0.0004 + 0.0008 = 0.0018\n$$\n使用离差平方和的计算公式：\n$$\n\\sum_{i=1}^{N} (\\Delta_i - \\bar{\\Delta})^2 = \\sum_{i=1}^{N} \\Delta_i^2 - \\frac{\\left(\\sum_{i=1}^{N} \\Delta_i\\right)^2}{N} = 0.0018 - \\frac{(-0.02)^2}{12} = 0.0018 - \\frac{0.0004}{12} = 0.0018 - 0.0000333\\dots = 0.0017666\\dots\n$$\n样本方差为：\n$$\ns_{\\Delta}^2 = \\frac{0.0017666\\dots}{12-1} = \\frac{0.0017666\\dots}{11} \\approx 0.000160606\\dots\n$$\n样本标准差是方差的平方根：\n$$\ns_{\\Delta} = \\sqrt{0.000160606\\dots} \\approx 0.01267304\n$$\n\n95% 一致性界限定义为 $\\bar{\\Delta} \\pm 1.96 s_{\\Delta}$。问题指定使用乘数 1.96。\n首先，计算一致性边际：\n$$\n1.96 \\times s_{\\Delta} = 1.96 \\times 0.01267304 \\approx 0.02483916\n$$\n一致性下限 $L_{lower}$ 为：\n$$\nL_{lower} = \\bar{\\Delta} - 1.96 s_{\\Delta} \\approx -0.00166667 - 0.02483916 = -0.02650583\n$$\n一致性上限 $L_{upper}$ 为：\n$$\nL_{upper} = \\bar{\\Delta} + 1.96 s_{\\Delta} \\approx -0.00166667 + 0.02483916 = 0.02317249\n$$\n\n最后，我们将所需量——偏倚、下限和上限——四舍五入至四位有效数字。\n偏倚： $\\bar{\\Delta} \\approx -0.00166667 \\rightarrow -0.001667$\n下限： $L_{lower} \\approx -0.02650583 \\rightarrow -0.02651$\n上限： $L_{upper} \\approx 0.02317249 \\rightarrow 0.02317$\n\nBland-Altman 分析的结果是偏倚为 $-0.001667$，95% 一致性界限为 $-0.02651$ 至 $0.02317$。较小的偏倚表明，与 DENSE 测量值相比，该模型具有较低的系统误差。一致性界限定义了模型与测量值之间 95% 的差值预计会落入的范围。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.001667  -0.02651  0.02317 \\end{pmatrix}}\n$$"
        }
    ]
}