{
    "hands_on_practices": [
        {
            "introduction": "A core challenge in virtual surgery is achieving both physical realism and real-time haptic feedback, typically at rates of $1$ kHz or higher. While the finite element method (FEM) can provide high-fidelity models of soft tissue deformation, its computational cost can be prohibitive. This exercise explores mass lumping, a critical technique used in explicit time integration schemes to increase the maximum stable time step, thereby enabling real-time performance. By working through this problem, you will analyze the fundamental trade-off between computational stability and the accuracy of the system's dynamic response, a central consideration in designing any haptic-enabled biomechanical simulation .",
            "id": "4211308",
            "problem": "A virtual surgery simulator for soft tissue employs the finite element method (FEM) with linear tetrahedral elements to achieve real-time haptic feedback. Consider a single linear tetrahedral element with volume $V$, uniform mass density $\\rho$, and nodal shape functions $\\{N_i\\}_{i=1}^4$ that are the barycentric coordinates of the tetrahedron and satisfy $\\sum_{i=1}^4 N_i = 1$ and $N_i \\ge 0$ in the element. The semi-discrete equations of motion for small elastic oscillations take the form $M \\ddot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$, where $M$ is the mass matrix, $K$ is the stiffness matrix, and $\\mathbf{u}$ is the nodal displacement vector. In explicit time integration with the central difference scheme, the stability limit is governed by the highest natural frequency $\\omega_{\\max}$ through a bound of the form $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$.\n\nStarting from the definitions $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$ and $m_i^{\\text{lump}} = \\sum_{j=1}^4 M_{ij}$ for an element $\\Omega_e$, and assembling over the mesh in the standard FEM manner, address the following:\n\n- Compute the lumped mass assigned to each node of a single linear tetrahedral element (per translational degree of freedom), expressed in terms of $V$ and $\\rho$.\n- Use first-principle arguments (without invoking any shortcut formulas specific to stability thresholds) to compare how mass lumping versus a consistent mass matrix affects the maximum stable time step of explicit central-difference integration and the accuracy of modal frequencies, particularly for high-frequency modes relevant to contact and cutting events in haptic biomechanics.\n\nChoose the single best statement:\n\nA. The lumped mass for a linear tetrahedral element assigns equal nodal masses $m_i = \\rho V / 4$ per translational degree of freedom; compared to the consistent mass, mass lumping increases the maximum stable time step in explicit central-difference integration and induces larger eigenfrequency errors primarily in high-frequency modes.\n\nB. The lumped mass assigns nodal masses $m_i = \\rho V / 10$; mass lumping decreases the maximum stable time step compared to the consistent mass and improves high-frequency accuracy.\n\nC. The consistent mass matrix for a linear tetrahedral element is diagonal with entries $m_i = \\rho V / 4$, making explicit integration stability and accuracy identical to the lumped mass case.\n\nD. The lumped mass assigns equal nodal masses $m_i = \\rho V / 4$, but it reduces the maximum stable time step and improves modal accuracy across the spectrum relative to the consistent mass.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n**Step 1: Extract Givens**\n-   Finite Element Method (FEM) with linear tetrahedral elements is used for soft tissue simulation.\n-   Element volume: $V$.\n-   Element mass density: $\\rho$ (uniform).\n-   Nodal shape functions for a single element: $\\{N_i\\}_{i=1}^4$.\n-   Shape functions are barycentric coordinates.\n-   Properties of shape functions: $\\sum_{i=1}^4 N_i = 1$ and $N_i \\ge 0$ within the element $\\Omega_e$.\n-   Semi-discrete equations of motion: $M \\ddot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$.\n-   Time integration: Explicit central difference scheme.\n-   Stability limit: $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$, where $\\omega_{\\max}$ is the highest natural frequency.\n-   Consistent mass matrix element definition: $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$.\n-   Lumped mass element definition: $m_i^{\\text{lump}} = \\sum_{j=1}^4 M_{ij}$.\n-   The first task is to compute the lumped mass per node per translational degree of freedom.\n-   The second task is to compare mass lumping versus a consistent mass matrix regarding the maximum stable time step and the accuracy of modal frequencies, especially for high-frequency modes.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of the Finite Element Method in solid mechanics and structural dynamics. The definitions provided for the consistent and lumped mass matrices are standard. The stability criterion for the central difference method is correctly stated. The application context (virtual surgery, haptics) is a well-established field where these methods are employed. The problem provides all necessary information to perform the requested calculation and comparison. The terminology is precise and unambiguous. There are no contradictions, unrealistic conditions, or logical flaws.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A solution will be derived.\n\n**Derivation**\n\nThe problem has two parts: calculating the lumped mass and comparing its effects to the consistent mass matrix.\n\n**Part 1: Computation of the Lumped Mass**\n\nThe lumped mass for node $i$ of an element, $m_i^{\\text{lump}}$, is defined by summing the entries in the $i$-th row of the element's consistent mass matrix, $M$.\n$$m_i^{\\text{lump}} = \\sum_{j=1}^{4} M_{ij}$$\nSubstituting the definition of the consistent mass matrix entries, $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$:\n$$m_i^{\\text{lump}} = \\sum_{j=1}^{4} \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$$\nSince the density $\\rho$ is uniform, it can be factored out. The sum and integral can be interchanged:\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} \\sum_{j=1}^{4} (N_i N_j) \\, dV$$\nFactoring out $N_i$:\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} N_i \\left( \\sum_{j=1}^{4} N_j \\right) \\, dV$$\nThe problem states that the shape functions satisfy the property $\\sum_{j=1}^{4} N_j = 1$ everywhere within the element. Substituting this into the expression:\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} N_i (1) \\, dV = \\rho \\int_{\\Omega_e} N_i \\, dV$$\nThe integral of a single barycentric coordinate $N_i$ over the volume $V$ of a tetrahedron is a standard result. It can be found using the formula for integrals of products of barycentric coordinates over a $d$-dimensional simplex:\n$$\\int_V \\prod_{k=1}^{d+1} L_k^{a_k} \\, dV = \\frac{(\\prod_{k=1}^{d+1} a_k!) \\, d!}{(\\sum_{k=1}^{d+1} a_k + d)!} V$$\nFor our case, we are integrating $N_i$ over a tetrahedron, so $d=3$. This corresponds to setting $a_i=1$ and all other $a_k=0$ for $k \\neq i$.\n$$\\int_{\\Omega_e} N_i \\, dV = \\frac{1! \\cdot (0!)^3 \\cdot 3!}{(1+0+0+0+3)!} V = \\frac{1 \\cdot 1 \\cdot 6}{4!} V = \\frac{6}{24} V = \\frac{V}{4}$$\nTherefore, the lumped mass at node $i$ is:\n$$m_i^{\\text{lump}} = \\rho \\left( \\frac{V}{4} \\right) = \\frac{\\rho V}{4}$$\nThis mass value applies to each translational degree of freedom associated with the node. This result shows that the total mass of the element, $\\rho V$, is distributed equally among its four nodes.\n\n**Part 2: Comparison of Mass Lumping vs. Consistent Mass**\n\n**Effect on Maximum Stable Time Step:**\nThe stability of the explicit central difference scheme is limited by the highest natural frequency of the discrete system, $\\omega_{\\max}$, via $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$. To maximize the stable time step $\\Delta t$, one requires the lowest possible $\\omega_{\\max}$. The natural frequencies $\\omega$ are the solutions to the generalized eigenvalue problem $K \\phi = \\omega^2 M \\phi$.\n\nLet $M^c$ be the consistent mass matrix and $M^l$ be the lumped mass matrix. $M^l$ is diagonal, while $M^c$ is fully populated. For a linear tetrahedron, the consistent mass matrix (scaled by $\\rho V$ for a single DOF) is:\n$$M^c = \\frac{\\rho V}{20} \\begin{pmatrix} 2 & 1 & 1 & 1 \\\\ 1 & 2 & 1 & 1 \\\\ 1 & 1 & 2 & 1 \\\\ 1 & 1 & 1 & 2 \\end{pmatrix}$$\nAnd the lumped mass matrix is:\n$$M^l = \\frac{\\rho V}{4} \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$$\nThe eigenvalues $\\omega^2$ can be estimated by the Rayleigh quotient, $R(\\phi) = \\frac{\\phi^T K \\phi}{\\phi^T M \\phi}$. We are interested in how the denominator, $\\phi^T M \\phi$, changes between $M^c$ and $M^l$ for the eigenvector $\\phi_{\\max}$ corresponding to $\\omega_{\\max}$. High-frequency modes typically involve adjacent nodes moving out of phase. Let's analyze a representative high-frequency mode vector, for instance, $\\phi = [1, -1, 1, -1]^T$.\nFor the lumped mass matrix:\n$$\\phi^T M^l \\phi = \\frac{\\rho V}{4} [1, -1, 1, -1] \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\frac{\\rho V}{4} (1^2 + (-1)^2 + 1^2 + (-1)^2) = \\frac{\\rho V}{4} (4) = \\rho V$$\nFor the consistent mass matrix:\n$$\\phi^T M^c \\phi = \\frac{\\rho V}{20} [1, -1, 1, -1] \\begin{pmatrix} 2 & 1 & 1 & 1 \\\\ 1 & 2 & 1 & 1 \\\\ 1 & 1 & 2 & 1 \\\\ 1 & 1 & 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\frac{\\rho V}{20} [1, -1, 1, -1] \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\frac{\\rho V}{20} (4) = \\frac{\\rho V}{5}$$\nFor this highly oscillatory mode, $\\phi^T M^l \\phi = 5 (\\phi^T M^c \\phi)$. Because the Rayleigh quotient has the mass term in the denominator, this implies that for this mode, $\\omega_l^2 < \\omega_c^2$. Generalizing this, mass lumping for linear tetrahedral elements tends to reduce the highest natural frequency of the system, i.e., $\\omega_{\\max, l} < \\omega_{\\max, c}$.\nSince $\\Delta t_{max} \\propto 1/\\omega_{\\max}$, it follows that $\\Delta t_{max, l} > \\Delta t_{max, c}$. Thus, mass lumping *increases* the maximum stable time step.\n\n**Effect on Modal Accuracy:**\nThe consistent mass matrix is derived from the Galerkin weak form using the same shape functions as the stiffness matrix, $K$. It provides a mathematically consistent representation of the system's inertia. It is known to yield more accurate approximations of the lower, structurally significant, natural frequencies of the underlying continuum.\nMass lumping is an approximation that simplifies the mass matrix to be diagonal. This simplification comes at the cost of accuracy. While the effect on low-frequency modes might be modest, the error becomes significant for high-frequency modes. These modes, which involve deformations at the scale of a single element, are poorly represented by the mesh to begin with. Mass lumping further distorts their frequencies, typically under-predicting them substantially (as seen in the Rayleigh quotient analysis). Therefore, mass lumping *decreases* modal accuracy, and this effect is most pronounced for high-frequency modes.\n\n**Option-by-Option Analysis**\n\n**A. The lumped mass for a linear tetrahedral element assigns equal nodal masses $m_i = \\rho V / 4$ per translational degree of freedom; compared to the consistent mass, mass lumping increases the maximum stable time step in explicit central-difference integration and induces larger eigenfrequency errors primarily in high-frequency modes.**\n-   Nodal mass calculation $m_i = \\rho V / 4$: Correct, as derived.\n-   Effect on time step (increases): Correct, as derived. Mass lumping lowers $\\omega_{\\max}$, which increases $\\Delta t_{\\max}$.\n-   Effect on accuracy (induces larger errors in high-frequency modes): Correct. Lumping is an approximation that most severely impacts the poorly-resolved high-frequency modes.\n-   **Verdict: Correct.**\n\n**B. The lumped mass assigns nodal masses $m_i = \\rho V / 10$; mass lumping decreases the maximum stable time step compared to the consistent mass and improves high-frequency accuracy.**\n-   Nodal mass calculation $m_i = \\rho V / 10$: Incorrect. This is the value of the diagonal entry of the *consistent* mass matrix, $M_{ii}$. The lumped mass is $\\rho V/4$.\n-   Effect on time step (decreases): Incorrect. It increases the time step for this element type.\n-   Effect on accuracy (improves): Incorrect. It degrades accuracy.\n-   **Verdict: Incorrect.**\n\n**C. The consistent mass matrix for a linear tetrahedral element is diagonal with entries $m_i = \\rho V / 4$, making explicit integration stability and accuracy identical to the lumped mass case.**\n-   Consistent mass matrix is diagonal: Incorrect. The off-diagonal entries are $M_{ij} = \\rho V / 20$ for $i \\neq j$.\n-   Entries are $m_i = \\rho V / 4$: Incorrect. The diagonal entries are $M_{ii} = \\rho V / 10$.\n-   Conclusion (identical stability and accuracy): Incorrect, as the matrices are not identical.\n-   **Verdict: Incorrect.**\n\n**D. The lumped mass assigns equal nodal masses $m_i = \\rho V / 4$, but it reduces the maximum stable time step and improves modal accuracy across the spectrum relative to the consistent mass.**\n-   Nodal mass calculation $m_i = \\rho V / 4$: Correct.\n-   Effect on time step (reduces): Incorrect. It increases the time step.\n-   Effect on accuracy (improves): Incorrect. It degrades accuracy.\n-   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a deformable tissue model is in place, simulating the physical interaction with a surgical instrument becomes paramount for believable haptic feedback. This involves sophisticated contact mechanics, where forces like adhesion and friction are modeled. This practice focuses on implementing a computationally stable stick-slip Coulomb friction model, which is essential for rendering sensations like dragging a tool across a tissue surface. You will derive the logic for transitioning between sticking and slipping, a non-trivial aspect of contact simulation, and apply it to calculate the tangential force felt by the user .",
            "id": "4211239",
            "problem": "A virtual surgery simulation couples a Haptic Device (HD) to a soft-tissue contact model to provide force feedback. Consider a single instrument tip constrained to a planar tissue surface with a known normal contact reaction. The tangential interaction is modeled by a compliant interfacial element in parallel with dry friction. At the instant of interest, the tissue tool-tip normal reaction is measured as $\\lambda_{n} = 3.8$ Newtons, and the coefficient of Coulomb friction is $\\mu = 0.35$. The tangential interfacial compliance is described by a Kelvin–Voigt element with stiffness $k_{t} = 600$ Newtons per meter and damping $c_{t} = 0.4$ Newton seconds per meter. The current tangential interfacial displacement is $u_{t} = 0.004$ meters and the relative tangential sliding velocity is $v_{t} = +0.12$ meters per second along the positive tangent direction.\n\nStarting from fundamental laws and core definitions, derive a mathematically consistent stick–slip Coulomb friction law based on the normal reaction bound and energy dissipation. Use the inequality $|\\lambda_{t}| \\le \\mu \\lambda_{n}$ as the admissibility condition for sticking, and determine the physically consistent transition criterion between stick and slip. Then, for the given instantaneous state, compute the signed tangential contact force $\\lambda_{t}$ delivered to the HD.\n\nRound your final numerical value to three significant figures. Express the tangential contact force in Newtons.",
            "solution": "The problem is scientifically well-posed and objective. All necessary parameters are provided, and the task is clear. The problem is valid.\n\n**Derivation of Stick-Slip Law and Force Calculation**\n\nThe problem requires us to first derive a consistent stick-slip friction law and then apply it to compute the tangential force. The total tangential force, $\\lambda_t$, is determined by the interplay between a compliant interfacial element (a Kelvin-Voigt model) and a dry Coulomb friction limit. This is often implemented as a predictor-corrector or projection method.\n\n1.  **Trial Force Calculation:** The force generated by the compliant Kelvin-Voigt element represents the \"trial\" tangential force, $\\lambda_{t, \\text{trial}}$. This is the force the interface would exert if it could sustain any amount of shear. The force opposes the displacement $u_t$ and the velocity $v_t$.\n    $$\\lambda_{t, \\text{trial}} = -(k_t u_t + c_t v_t)$$\n\n2.  **Friction Limit:** The maximum static friction force that the interface can sustain is defined by the Coulomb friction law:\n    $$F_{f, \\text{max}} = \\mu \\lambda_n$$\n\n3.  **Stick-Slip Transition Criterion:** The transition between sticking and slipping is governed by comparing the magnitude of the trial force to the friction limit.\n    -   **Stick Condition:** If $|\\lambda_{t, \\text{trial}}| \\le F_{f, \\text{max}}$, the interface is in a state of stick. The static friction is sufficient to resist the compliant force. The actual tangential force is equal to the trial force:\n        $$\\lambda_t = \\lambda_{t, \\text{trial}}$$\n    -   **Slip Condition:** If $|\\lambda_{t, \\text{trial}}| > F_{f, \\text{max}}$, the interface cannot sustain the trial force and begins to slip. The tangential force saturates at the kinetic friction limit (which is equal to the static limit in this model). The direction of the friction force must oppose the direction of relative motion, $v_t$.\n        $$\\lambda_t = -F_{f, \\text{max}} \\cdot \\text{sgn}(v_t)$$\n\nThis framework ensures that energy is dissipated correctly during slip. The power dissipated by friction is $P = \\lambda_t v_t = (-F_{f, \\text{max}} \\cdot \\text{sgn}(v_t)) v_t = -F_{f, \\text{max}} |v_t|$, which is always non-positive, as required.\n\n**Numerical Computation**\n\nWe are given the following parameters:\n-   Normal reaction: $\\lambda_n = 3.8\\,\\mathrm{N}$\n-   Friction coefficient: $\\mu = 0.35$\n-   Tangential stiffness: $k_t = 600\\,\\mathrm{N/m}$\n-   Tangential damping: $c_t = 0.4\\,\\mathrm{N \\cdot s/m}$\n-   Tangential displacement: $u_t = 0.004\\,\\mathrm{m}$\n-   Tangential velocity: $v_t = +0.12\\,\\mathrm{m/s}$\n\n**Step 1: Calculate the trial force, $\\lambda_{t, \\text{trial}}$.**\n$$\\lambda_{t, \\text{trial}} = -( (600\\,\\mathrm{N/m} \\times 0.004\\,\\mathrm{m}) + (0.4\\,\\mathrm{N \\cdot s/m} \\times 0.12\\,\\mathrm{m/s}) )$$\n$$\\lambda_{t, \\text{trial}} = -(2.4\\,\\mathrm{N} + 0.048\\,\\mathrm{N})$$\n$$\\lambda_{t, \\text{trial}} = -2.448\\,\\mathrm{N}$$\n\n**Step 2: Calculate the friction limit, $F_{f, \\text{max}}$.**\n$$F_{f, \\text{max}} = \\mu \\lambda_n = 0.35 \\times 3.8\\,\\mathrm{N} = 1.33\\,\\mathrm{N}$$\n\n**Step 3: Compare the trial force to the friction limit to determine the state.**\n$$|\\lambda_{t, \\text{trial}}| = |-2.448\\,\\mathrm{N}| = 2.448\\,\\mathrm{N}$$\nSince $2.448\\,\\mathrm{N} > 1.33\\,\\mathrm{N}$, the condition $|\\lambda_{t, \\text{trial}}| > F_{f, \\text{max}}$ is met. The contact is in a state of **slip**.\n\n**Step 4: Calculate the final tangential force, $\\lambda_t$.**\nSince the contact is slipping, the tangential force is equal to the friction limit and opposes the direction of motion. The velocity is positive ($v_t = +0.12\\,\\mathrm{m/s}$), so the force must be negative.\n$$\\lambda_t = -F_{f, \\text{max}} = -1.33\\,\\mathrm{N}$$\n\nThe final tangential force delivered to the HD is $-1.33\\,\\mathrm{N}$. This value is already at three significant figures as requested.",
            "answer": "$$\n\\boxed{-1.33}\n$$"
        },
        {
            "introduction": "The forces calculated within a virtual environment are ultimately just numbers; a haptic device is required to translate them into physical sensations. The fidelity of this translation is limited by the electromechanical properties of the device itself, including the resolution of its sensors. This final practice delves into the practical consequences of digital control, specifically how position sensor quantization affects the smoothness and resolution of the rendered force. By analyzing how discrete sensor readings propagate through a control loop, you will determine the smallest change in force the device can render, a crucial metric for evaluating the quality and transparency of any haptic interface .",
            "id": "4211268",
            "problem": "A one-degree-of-freedom haptic interface used in a virtual surgery simulator renders contact forces from a virtual tissue model through a direct-drive actuator coupled to a cable spool of radius $r$. The end-effector position is measured by a linear optical encoder whose quantized output is used by a controller to compute the actuator current. The controller implements a Proportional-Derivative (PD) current command based on the measured position and its discrete-time velocity estimate. The motor produces torque proportional to current via its torque constant. Assume the following:\n\n- The measured position $x_{m}$ is quantized with a resolution (one least significant bit step) $\\Delta x$ and exhibits uniform quantization error.\n- The discrete-time velocity estimate is computed as a backward difference $v_{m}[k] = \\dfrac{x_{m}[k] - x_{m}[k-1]}{T_{s}}$, where $T_{s}$ is the sampling period.\n- The commanded current is $i_{\\mathrm{cmd}} = g_{p}\\,x_{m} + g_{d}\\,v_{m}$, where $g_{p}$ is the proportional gain (in $\\mathrm{A}/\\mathrm{m}$) and $g_{d}$ is the derivative gain (in $\\mathrm{A}/(\\mathrm{m}/\\mathrm{s})$).\n- The motor torque is $\\tau = K_{t}\\,i_{\\mathrm{cmd}}$, where $K_{t}$ is the torque constant (in $\\mathrm{N}\\,\\mathrm{m}/\\mathrm{A}$), and the end-effector force is $F = \\dfrac{\\tau}{r}$.\n- The motor current loop bandwidth is sufficiently high that the commanded currents are tracked without attenuation in the frequency range of interest, and there is no current quantization.\n- The user moves quasi-statically so that the smallest detectable force change is governed by the minimal nonzero increment in the encoder reading and the corresponding minimal nonzero increment in the discrete velocity estimate.\n\nStarting from fundamental kinematics and dynamics, derive an expression for the smallest detectable change in the rendered force at the end effector due to a one-count change in the encoder reading, and then evaluate it numerically for the following parameters:\n\n- Spool radius $r = 0.015\\,\\mathrm{m}$,\n- Encoder position resolution $\\Delta x = 1.0 \\times 10^{-6}\\,\\mathrm{m}$,\n- Sampling period $T_{s} = 1.0 \\times 10^{-3}\\,\\mathrm{s}$,\n- Proportional gain $g_{p} = 300\\,\\mathrm{A}/\\mathrm{m}$,\n- Derivative gain $g_{d} = 0.10\\,\\mathrm{A}/(\\mathrm{m}/\\mathrm{s})$,\n- Torque constant $K_{t} = 0.18\\,\\mathrm{N}\\,\\mathrm{m}/\\mathrm{A}$.\n\nExpress your final numerical answer in newtons and round to four significant figures. Your reasoning must begin from canonical definitions (e.g., torque-current proportionality, force-torque-radius relation, and the definition of discrete velocity) and must not assume any pre-derived formulas for quantization propagation.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. All parameters are dimensionally consistent. The problem is therefore deemed valid and a solution can be formulated.\n\nThe task is to derive an expression for the smallest detectable change in the rendered force, $\\Delta F_{\\mathrm{min}}$, at the end-effector of a haptic device. This change is a consequence of the quantization of the position sensor. We begin by establishing the relationship between the rendered force and the system's state variables.\n\nThe problem provides the following canonical definitions:\n1.  The commanded actuator current, $i_{\\mathrm{cmd}}$, is determined by a Proportional-Derivative (PD) control law based on the measured position, $x_m$, and the estimated velocity, $v_m$:\n    $$i_{\\mathrm{cmd}} = g_{p}\\,x_{m} + g_{d}\\,v_{m}$$\n    where $g_p$ is the proportional gain and $g_d$ is the derivative gain.\n\n2.  The discrete-time velocity estimate, $v_m[k]$, is calculated using a backward difference:\n    $$v_{m}[k] = \\frac{x_{m}[k] - x_{m}[k-1]}{T_{s}}$$\n    where $x_m[k]$ is the measured position at the current time step $k$, $x_m[k-1]$ is the measured position at the previous time step, and $T_s$ is the sampling period.\n\n3.  The motor generates a torque, $\\tau$, proportional to the commanded current:\n    $$\\tau = K_{t}\\,i_{\\mathrm{cmd}}$$\n    where $K_t$ is the motor's torque constant.\n\n4.  The torque is transmitted to the end-effector as a force, $F$, via a cable spool of radius $r$:\n    $$F = \\frac{\\tau}{r}$$\n\nCombining these relationships, we can express the rendered force $F$ at time step $k$ as a function of the measured position history:\n$$F[k] = \\frac{\\tau[k]}{r} = \\frac{K_{t}\\,i_{\\mathrm{cmd}}[k]}{r} = \\frac{K_t}{r} \\left( g_{p}\\,x_{m}[k] + g_{d}\\,v_{m}[k] \\right)$$\nSubstituting the expression for $v_m[k]$ yields the force in terms of the discrete position measurements:\n$$F[k] = \\frac{K_t}{r} \\left( g_{p}\\,x_{m}[k] + g_{d}\\,\\frac{x_{m}[k] - x_{m}[k-1]}{T_{s}} \\right)$$\nThis can be rewritten by grouping terms related to $x_m[k]$ and $x_m[k-1]$:\n$$F[k] = \\frac{K_t}{r} \\left[ \\left(g_p + \\frac{g_d}{T_s}\\right) x_m[k] - \\left(\\frac{g_d}{T_s}\\right) x_m[k-1] \\right]$$\n\nThe position measurement $x_m$ is quantized with a resolution $\\Delta x$. This means $x_m$ can only take on values that are integer multiples of $\\Delta x$.\n\nThe problem asks for the \"smallest detectable change in the rendered force... due to a one-count change in the encoder reading.\" This is further clarified as being \"governed by the minimal nonzero increment in the encoder reading and the corresponding minimal nonzero increment in the discrete velocity estimate.\"\n\nLet us analyze this condition. The minimal nonzero increment in the encoder reading is a change in measured position, $\\Delta x_m$, equal to the resolution $\\Delta x$. The minimal nonzero increment in the discrete velocity estimate occurs when the position changes by one count, $\\Delta x$, over one sampling period, $T_s$. This corresponds to a velocity of $\\Delta x / T_s$.\n\nThe most direct interpretation of these combined conditions is the change in force experienced when the system transitions from a state of rest (zero velocity) to a state of minimal motion (velocity $\\Delta x/T_s$). This corresponds to a change in the position input by $\\Delta x_m = \\Delta x$ and a simultaneous change in the velocity input from $0$ to $\\Delta x / T_s$, meaning $\\Delta v_m = \\Delta x / T_s$.\n\nThe total rendered force $F$ is a linear function of $x_m$ and $v_m$:\n$$F(x_m, v_m) = \\frac{K_t g_p}{r} x_m + \\frac{K_t g_d}{r} v_m$$\nThe change in force, $\\Delta F$, due to small changes $\\Delta x_m$ and $\\Delta v_m$ can be found using the principle of superposition, as the system is linear:\n$$\\Delta F = \\frac{\\partial F}{\\partial x_m} \\Delta x_m + \\frac{\\partial F}{\\partial v_m} \\Delta v_m$$\nThe partial derivatives are:\n$$\\frac{\\partial F}{\\partial x_m} = \\frac{K_t g_p}{r}$$\n$$\\frac{\\partial F}{\\partial v_m} = \\frac{K_t g_d}{r}$$\nSubstituting these into the expression for $\\Delta F$:\n$$\\Delta F = \\left(\\frac{K_t g_p}{r}\\right) \\Delta x_m + \\left(\\frac{K_t g_d}{r}\\right) \\Delta v_m$$\nNow, we substitute the minimal increments as identified: $\\Delta x_m = \\Delta x$ and $\\Delta v_m = \\Delta x / T_s$. This gives the smallest detectable force change, $\\Delta F_{\\mathrm{min}}$:\n$$\\Delta F_{\\mathrm{min}} = \\frac{K_t g_p}{r} \\Delta x + \\frac{K_t g_d}{r} \\frac{\\Delta x}{T_s}$$\nFactoring out common terms yields the final symbolic expression:\n$$\\Delta F_{\\mathrm{min}} = \\frac{K_t \\Delta x}{r} \\left( g_p + \\frac{g_d}{T_s} \\right)$$\nNow, we substitute the given numerical values into this expression:\n- $r = 0.015\\,\\mathrm{m}$\n- $\\Delta x = 1.0 \\times 10^{-6}\\,\\mathrm{m}$\n- $T_{s} = 1.0 \\times 10^{-3}\\,\\mathrm{s}$\n- $g_{p} = 300\\,\\mathrm{A}/\\mathrm{m}$\n- $g_{d} = 0.10\\,\\mathrm{A}/(\\mathrm{m}/\\mathrm{s})$\n- $K_{t} = 0.18\\,\\mathrm{N}\\,\\mathrm{m}/\\mathrm{A}$\n\nFirst, we evaluate the term in parenthesis:\n$$g_p + \\frac{g_d}{T_s} = 300\\,\\frac{\\mathrm{A}}{\\mathrm{m}} + \\frac{0.10\\,\\frac{\\mathrm{A}}{\\mathrm{m}/\\mathrm{s}}}{1.0 \\times 10^{-3}\\,\\mathrm{s}} = 300\\,\\frac{\\mathrm{A}}{\\mathrm{m}} + 100\\,\\frac{\\mathrm{A}}{\\mathrm{m}} = 400\\,\\frac{\\mathrm{A}}{\\mathrm{m}}$$\nNext, we evaluate the pre-factor:\n$$\\frac{K_t \\Delta x}{r} = \\frac{(0.18\\,\\mathrm{N}\\,\\mathrm{m}/\\mathrm{A}) (1.0 \\times 10^{-6}\\,\\mathrm{m})}{0.015\\,\\mathrm{m}} = \\frac{1.8 \\times 10^{-7}\\,\\mathrm{N}\\,\\mathrm{m}^2/\\mathrm{A}}{0.015\\,\\mathrm{m}} = 1.2 \\times 10^{-5}\\,\\mathrm{N}\\,\\mathrm{m}/\\mathrm{A}$$\nFinally, we compute $\\Delta F_{\\mathrm{min}}$:\n$$\\Delta F_{\\mathrm{min}} = (1.2 \\times 10^{-5}\\,\\mathrm{N}\\,\\mathrm{m}/\\mathrm{A}) \\left( 400\\,\\frac{\\mathrm{A}}{\\mathrm{m}} \\right) = 4800 \\times 10^{-6}\\,\\mathrm{N} = 0.0048\\,\\mathrm{N}$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, the final numerical answer is $0.004800\\,\\mathrm{N}$.",
            "answer": "$$\\boxed{0.004800}$$"
        }
    ]
}