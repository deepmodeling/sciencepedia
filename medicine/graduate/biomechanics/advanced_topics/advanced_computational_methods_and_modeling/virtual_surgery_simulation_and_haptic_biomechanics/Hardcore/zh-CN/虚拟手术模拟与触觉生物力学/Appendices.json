{
    "hands_on_practices": [
        {
            "introduction": "虚拟手术仿真的第一步是根据患者的医学影像（如CT或MRI）重建其解剖结构的三维模型。此实践练习探讨了从图像数据生成网格时一个关键的权衡问题：如何在图像分辨率的限制下，通过调整网格密度来控制几何误差。通过从第一性原理出发，您将推导出确保网格忠实于原始解剖结构所需的最大网格尺寸，这对于后续力反馈的稳定性和准确性至关重要 ()。",
            "id": "4211279",
            "problem": "一个针对特定患者的虚拟手术模拟依赖于从体积医学图像重建的表面网格来驱动实时触觉交互。考虑一个直血管段，其横截面被近似为一个半径为 $r$（单位为 $\\mathrm{mm}$）的圆形。图像采集提供了一个各向同性的体素网格，其边长为 $\\Delta$（单位为 $\\mathrm{mm}$）。一个分割流程提取血管边界，一个网格划分算法通过用边长为 $h$（单位为 $\\mathrm{mm}$）的直线段连接边界点来近似每个横截面中的圆形边界。为确保触觉回路中稳定和准确的力反馈，必须控制真实圆形边界与分段线性近似之间的几何误差。\n\n假设以下基本条件：\n- 几何误差度量是在局部表面法线方向上测量的，精确圆形与近似它的弦段上任意点之间的最大欧几里得距离（即，最坏情况下的偏差发生在每条弦的中点）。\n- 图像分辨率因体素网格上的量化而引入了一个基线法向不确定性，其上界为 $e_{\\mathrm{res}} = \\Delta/2$（单位为 $\\mathrm{mm}$）。\n- 网格的总几何误差是量化误差和弦近似误差之和，且不得超过触觉控制器所要求的指定容差 $\\varepsilon$（单位为 $\\mathrm{mm}$）。\n- 假设 $\\varepsilon > \\Delta/2$，以便通过非平凡的网格细化可以减少弦近似误差的贡献来满足容差要求。\n\n从平面圆形几何的第一性原理和上述量化界限出发，推导最大允许边界边长 $h^{\\star}(r,\\Delta,\\varepsilon)$（单位为 $\\mathrm{mm}$）的闭式表达式，使得总几何误差不超过 $\\varepsilon$。最终答案以 $\\mathrm{mm}$ 为单位表示。无需四舍五入。只需提供 $h^{\\star}(r,\\Delta,\\varepsilon)$ 的单个表达式作为最终答案。",
            "solution": "目标是限定用长度为 $h$ 的直线段近似半径为 $r$ 的圆形所产生的几何误差，同时要考虑由图像分辨率引起的量化误差 $e_{\\mathrm{res}} = \\Delta/2$。总误差建模为\n$$\ne_{\\mathrm{tot}} = e_{\\mathrm{res}} + e_{\\mathrm{chord}},\n$$\n要求是 $e_{\\mathrm{tot}} \\le \\varepsilon$。在 $\\varepsilon > \\Delta/2$ 的假设下，我们有一个正的剩余预算\n$$\n\\varepsilon' = \\varepsilon - e_{\\mathrm{res}} = \\varepsilon - \\frac{\\Delta}{2} > 0,\n$$\n它必须用于容纳弦近似误差 $e_{\\mathrm{chord}}$。\n\n我们现在从圆形几何学推导 $e_{\\mathrm{chord}}$。考虑圆上定义了网格边界一条边的两点。这两点之间的直线是圆的一条长度为 $h$ 的弦。圆弧与弦之间的最大法向偏差发生在弦的中点，即为矢高 $s$，我们将其作为弦近似误差：\n$$\ne_{\\mathrm{chord}} = s.\n$$\n令 $c = h/2$ 表示半弦长。构建由圆心、弦的中点和一个弦端点组成的直角三角形。根据勾股定理，\n$$\nc^{2} + (r - s)^{2} = r^{2}.\n$$\n解出 $s$ 得\n$$\ns = r - \\sqrt{r^{2} - c^{2}} = r - \\sqrt{r^{2} - \\left(\\frac{h}{2}\\right)^{2}}.\n$$\n施加误差预算 $e_{\\mathrm{chord}} \\le \\varepsilon'$ 得出\n$$\nr - \\sqrt{r^{2} - \\left(\\frac{h}{2}\\right)^{2}} \\le \\varepsilon'.\n$$\n重新排列以分离平方根：\n$$\n\\sqrt{r^{2} - \\left(\\frac{h}{2}\\right)^{2}} \\ge r - \\varepsilon'.\n$$\n两边平方（注意，因为在 $\\varepsilon' > 0$ 和 $r > 0$ 的条件下，$r - \\varepsilon' \\ge 0$，所以两边都是非负的）：\n$$\nr^{2} - \\left(\\frac{h}{2}\\right)^{2} \\ge (r - \\varepsilon')^{2}.\n$$\n解出 $h$：\n$$\n\\left(\\frac{h}{2}\\right)^{2} \\le r^{2} - (r - \\varepsilon')^{2} = r^{2} - \\left(r^{2} - 2 r \\varepsilon' + \\varepsilon'^{2}\\right) = 2 r \\varepsilon' - \\varepsilon'^{2}.\n$$\n因此，\n$$\nh \\le 2 \\sqrt{\\,2 r \\varepsilon' - \\varepsilon'^{2}\\,}.\n$$\n满足容差 $\\varepsilon$ 的最大允许边长是其上界，\n$$\nh^{\\star}(r,\\Delta,\\varepsilon) = 2 \\sqrt{\\,2 r \\left(\\varepsilon - \\frac{\\Delta}{2}\\right) - \\left(\\varepsilon - \\frac{\\Delta}{2}\\right)^{2}\\,}.\n$$\n\n这个表达式显示了图像分辨率如何影响网格保真度：随着 $\\Delta$ 的增加，量化误差 $e_{\\mathrm{res}} = \\Delta/2$ 会消耗更多的总误差预算 $\\varepsilon$，从而减少 $\\varepsilon' = \\varepsilon - \\Delta/2$，并因此降低了允许的 $h^{\\star}$。如果 $\\varepsilon \\le \\Delta/2$，则 $\\varepsilon' \\le 0$，任何网格细化（有限的 $h$）都无法满足容差，这反映了成像分辨率在触觉生物力学应用中对几何保真度的根本限制。\n\n因为问题指定了 $\\varepsilon > \\Delta/2$，所以上述闭式表达式是有效的，并提供了以 $\\mathrm{mm}$ 为单位的最大允许边界边长。",
            "answer": "$$\\boxed{2 \\sqrt{\\,2 r \\left(\\varepsilon - \\frac{\\Delta}{2}\\right) - \\left(\\varepsilon - \\frac{\\Delta}{2}\\right)^{2}\\,}}$$"
        },
        {
            "introduction": "拥有几何网格后，下一步是利用有限元方法（FEM）实时模拟软组织的物理行为。此练习聚焦于显式时间积分方案中一个核心的数值决策：质量矩阵的选择 ()。通过分析和计算，您将对比“一致质量矩阵”和“集总质量矩阵”对仿真稳定性和精度的影响，特别是理解为何在触觉应用中常常采用集总质量以提高计算效率，以及这种选择所带来的精度代价。",
            "id": "4211308",
            "problem": "一款用于软组织的虚拟手术模拟器采用带有线性四面体单元的有限元方法（FEM），以实现实时的力触觉反馈。考虑一个体积为 $V$、质量密度均匀为 $\\rho$ 的单个线性四面体单元，其节点形函数 $\\{N_i\\}_{i=1}^4$ 是该四面体的重心坐标，并在单元内满足 $\\sum_{i=1}^4 N_i = 1$ 和 $N_i \\ge 0$。小弹性振动的半离散运动方程形式为 $M \\ddot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$，其中 $M$ 是质量矩阵，$K$ 是刚度矩阵，$\\mathbf{u}$ 是节点位移向量。在使用中心差分格式的显式时间积分中，稳定性极限由最高固有频率 $\\omega_{\\max}$ 通过形式为 $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$ 的界限定。\n\n从单元 $\\Omega_e$ 的定义 $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$ 和 $m_i^{\\text{lump}} = \\sum_{j=1}^4 M_{ij}$ 出发，并以标准的有限元方法方式在网格上进行组装，解决以下问题：\n\n- 计算分配给单个线性四面体单元每个节点的集中质量（每个平移自由度），用 $V$ 和 $\\rho$ 表示。\n- 使用第一性原理（不使用任何特定于稳定性阈值的简化公式）进行论证，比较集中质量与一致质量矩阵如何影响显式中心差分积分的最大稳定时间步长以及模态频率的准确性，特别是对于与力触觉生物力学中的接触和切割事件相关的高频模态。\n\n选择唯一最佳的陈述：\n\nA. 线性四面体单元的集中质量为每个平移自由度分配相等的节点质量 $m_i = \\rho V / 4$；与一致质量相比，质量集中法在显式中心差分积分中增加了最大稳定时间步长，并主要在高频模态中引入较大的特征频率误差。\n\nB. 集中质量分配的节点质量为 $m_i = \\rho V / 10$；与一致质量相比，质量集中法减小了最大稳定时间步长，并提高了高频精度。\n\nC. 线性四面体单元的一致质量矩阵是对角的，其元素为 $m_i = \\rho V / 4$，这使得显式积分的稳定性和准确性与集中质量情况相同。\n\nD. 集中质量分配了相等的节点质量 $m_i = \\rho V / 4$，但相对于一致质量，它减小了最大稳定时间步长，并提高了整个频谱的模态准确性。",
            "solution": "**推导**\n\n问题分为两部分：计算集中质量并将其影响与一致质量矩阵进行比较。\n\n**第1部分：集中质量的计算**\n\n单元节点 $i$ 的集中质量 $m_i^{\\text{lump}}$ 定义为该单元一致质量矩阵 $M$ 第 $i$ 行所有元素的总和。\n$$m_i^{\\text{lump}} = \\sum_{j=1}^{4} M_{ij}$$\n代入一致质量矩阵元素的定义 $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$：\n$$m_i^{\\text{lump}} = \\sum_{j=1}^{4} \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$$\n由于密度 $\\rho$ 是均匀的，可以将其提出。求和与积分可以互换：\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} \\sum_{j=1}^{4} (N_i N_j) \\, dV$$\n提出 $N_i$：\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} N_i \\left( \\sum_{j=1}^{4} N_j \\right) \\, dV$$\n问题陈述指出，形函数在单元内处处满足性质 $\\sum_{j=1}^{4} N_j = 1$。将此代入表达式中：\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} N_i (1) \\, dV = \\rho \\int_{\\Omega_e} N_i \\, dV$$\n单个重心坐标 $N_i$ 在四面体体积 $V$ 上的积分是一个标准结果。可以使用 $d$ 维单形上重心坐标乘积的积分公式找到它：\n$$\\int_V \\prod_{k=1}^{d+1} L_k^{a_k} \\, dV = \\frac{(\\prod_{k=1}^{d+1} a_k!) \\, d!}{(\\sum_{k=1}^{d+1} a_k + d)!} V$$\n在我们的情况下，我们是在一个四面体上对 $N_i$ 进行积分，所以 $d=3$。这对应于设置 $a_i=1$ 且对于 $k \\neq i$ 的所有其他 $a_k=0$。\n$$\\int_{\\Omega_e} N_i \\, dV = \\frac{1! \\cdot (0!)^3 \\cdot 3!}{(1+0+0+0+3)!} V = \\frac{1 \\cdot 1 \\cdot 6}{4!} V = \\frac{6}{24} V = \\frac{V}{4}$$\n因此，节点 $i$ 处的集中质量为：\n$$m_i^{\\text{lump}} = \\rho \\left( \\frac{V}{4} \\right) = \\frac{\\rho V}{4}$$\n这个质量值适用于与该节点相关的每个平移自由度。这个结果表明，单元的总质量 $\\rho V$ 被均匀地分配到其四个节点上。\n\n**第2部分：质量集中法与一致质量法的比较**\n\n**对最大稳定时间步长的影响：**\n显式中心差分格式的稳定性受离散系统最高固有频率 $\\omega_{\\max}$ 的限制，即 $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$。为了最大化稳定时间步长 $\\Delta t$，需要尽可能低的 $\\omega_{\\max}$。固有频率 $\\omega$ 是广义特征值问题 $K \\phi = \\omega^2 M \\phi$ 的解。\n\n设 $M^c$ 为一致质量矩阵，$M^l$ 为集中质量矩阵。$M^l$ 是对角矩阵，而 $M^c$ 是满阵。对于线性四面体，一致质量矩阵（对单个自由度按 $\\rho V$ 缩放）为：\n$$M^c = \\frac{\\rho V}{20} \\begin{pmatrix} 2 & 1 & 1 & 1 \\\\ 1 & 2 & 1 & 1 \\\\ 1 & 1 & 2 & 1 \\\\ 1 & 1 & 1 & 2 \\end{pmatrix}$$\n而集中质量矩阵为：\n$$M^l = \\frac{\\rho V}{4} \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$$\n特征值 $\\omega^2$ 可以通过瑞利商 $R(\\phi) = \\frac{\\phi^T K \\phi}{\\phi^T M \\phi}$ 来估计。我们关心的是，对于对应于 $\\omega_{\\max}$ 的特征向量 $\\phi_{\\max}$，分母 $\\phi^T M \\phi$ 在 $M^c$ 和 $M^l$ 之间如何变化。高频模态通常涉及相邻节点反相运动。对于线性单元，质量集中法倾向于降低系统的最高固有频率，即 $\\omega_{\\max, l}  \\omega_{\\max, c}$。\n由于 $\\Delta t_{\\max} \\propto 1/\\omega_{\\max}$，因此 $\\Delta t_{\\max, l} > \\Delta t_{\\max, c}$。所以，质量集中法*增加*了最大稳定时间步长。\n\n**对模态准确性的影响：**\n一致质量矩阵是使用与刚度矩阵 $K$ 相同的形函数从伽辽金弱形式推导出来的。它提供了系统惯性的数学一致性表示。众所周知，它可以对基础连续体的较低的、结构上显著的固有频率产生更准确的近似。\n质量集中是一种将质量矩阵简化为对角矩阵的近似方法。这种简化是以牺牲准确性为代价的。虽然对低频模态的影响可能不大，但对于高频模态，误差变得显著。这些涉及单个单元尺度的变形的模态，本身就很难被网格很好地表示。质量集中进一步扭曲了它们的频率，通常会大幅低估它们。因此，质量集中法*降低*了模态准确性，并且这种影响在高频模态中最为显著。\n\n**逐项分析**\n\n**A. 线性四面体单元的集中质量为每个平移自由度分配相等的节点质量 $m_i = \\rho V / 4$；与一致质量相比，质量集中法在显式中心差分积分中增加了最大稳定时间步长，并主要在高频模态中引入较大的特征频率误差。**\n-   节点质量计算 $m_i = \\rho V / 4$：正确，如推导所示。\n-   对时间步长的影响（增加）：正确，如推导所示。质量集中降低了 $\\omega_{\\max}$，从而增加了 $\\Delta t_{\\max}$。\n-   对准确性的影响（在高频模态中引入较大误差）：正确。集中法是一种近似，对分辨率差的高频模态影响最为严重。\n-   **结论：正确。**\n\n**B. 集中质量分配的节点质量为 $m_i = \\rho V / 10$；与一致质量相比，质量集中法减小了最大稳定时间步长，并提高了高频精度。**\n-   节点质量计算 $m_i = \\rho V / 10$：不正确。这是一致质量矩阵对角线元素 $M_{ii}$ 的值。集中质量是 $\\rho V/4$。\n-   对时间步长的影响（减小）：不正确。对于这种单元类型，它会增加时间步长。\n-   对准确性的影响（提高）：不正确。它降低了准确性。\n-   **结论：不正确。**\n\n**C. 线性四面体单元的一致质量矩阵是对角的，其元素为 $m_i = \\rho V / 4$，这使得显式积分的稳定性和准确性与集中质量情况相同。**\n-   一致质量矩阵是对角的：不正确。非对角线元素为 $M_{ij} = \\rho V / 20$（当 $i \\neq j$ 时）。\n-   元素为 $m_i = \\rho V / 4$：不正确。对角线元素是 $M_{ii} = \\rho V / 10$。\n-   结论（稳定性和准确性相同）：不正确，因为两个矩阵不相同。\n-   **结论：不正确。**\n\n**D. 集中质量分配了相等的节点质量 $m_i = \\rho V / 4$，但相对于一致质量，它减小了最大稳定时间步长，并提高了整个频谱的模态准确性。**\n-   节点质量计算 $m_i = \\rho V / 4$：正确。\n-   对时间步长的影响（减小）：不正确。它增加了时间步长。\n-   对准确性的影响（提高）：不正确。它降低了准确性。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "逼真的触觉反馈是虚拟手术训练成功的关键，而精确的接触力建模，尤其是摩擦力，是实现这一目标的核心。本练习要求您从基本物理定律出发，推导出一个在计算力学中广泛应用的粘滑（stick-slip）库仑摩擦模型 ()。通过将该模型应用于一个具体的虚拟工具与软组织的交互场景，您将亲手计算出传递给用户的切向力，深刻理解仿真模型如何将复杂的物理现象转化为可感知的力。",
            "id": "4211239",
            "problem": "一个虚拟手术仿真将一个触觉设备 (HD) 与一个软组织接触模型耦合，以提供力反馈。考虑一个被约束在平面组织表面上的单一器械尖端，其法向接触反力已知。其切向相互作用通过一个与干摩擦并联的柔性界面元件来建模。在我们关注的瞬间，测得组织与工具尖端之间的法向反力为 $\\lambda_{n} = 3.8$ 牛顿，库仑摩擦系数为 $\\mu = 0.35$。切向界面柔度由一个开尔文-沃伊特 (Kelvin–Voigt) 元件描述，其刚度为 $k_{t} = 600$ 牛顿/米，阻尼为 $c_{t} = 0.4$ 牛顿·秒/米。当前的切向界面位移为 $u_{t} = 0.004$ 米，相对切向滑动速度为 $v_{t} = +0.12$ 米/秒，方向沿切向正方向。\n\n从基本定律和核心定义出发，基于法向反力边界和能量耗散，推导一个数学上一致的粘滑库仑摩擦定律。使用不等式 $|\\lambda_{t}| \\le \\mu \\lambda_{n}$ 作为粘滞的可接受条件，并确定粘滞和滑动之间物理上一致的转换准则。然后，对于给定的瞬时状态，计算传递给触觉设备 (HD) 的带符号的切向接触力 $\\lambda_{t}$。\n\n将您的最终数值四舍五入到三位有效数字。以牛顿为单位表示切向接触力。",
            "solution": "本题旨在基于一个结合了弹性、粘性和库仑摩擦的混合模型，计算施加在触觉设备上的切向力。该模型在计算接触力学中常通过一个“试探-校正”框架来实现。\n\n**第1步：定义物理模型和摩擦定律**\n切向相互作用由一个代表界面柔度的开尔文-沃伊特元件和一个干摩擦元件并联组成。总切向力 $\\lambda_t$ 是柔性元件产生的恢复力，但其大小受到库仑摩擦定律的限制。\n粘滑库仑摩擦定律可以表述如下：\n1.  计算一个“试探”切向力 $\\lambda_{t,\\text{trial}}$，它代表了如果没有摩擦限制时，柔性界面（开尔文-沃伊特元件）所产生的力。该力与切向位移 $u_t$ 和相对切向速度 $v_t$ 的方向相反。\n    $$ \\lambda_{t,\\text{trial}} = -(k_t u_t + c_t v_t) $$\n2.  计算最大允许的静摩擦力极限 $F_{\\text{fric, max}}$。\n    $$ F_{\\text{fric, max}} = \\mu \\lambda_n $$\n3.  比较试探力的大小与摩擦力极限：\n    *   **粘滞 (Stick) 条件**：如果 $|\\lambda_{t,\\text{trial}}| \\le F_{\\text{fric, max}}$，则界面处于粘滞状态。界面可以承受该力，因此实际的切向力等于试探力：$\\lambda_t = \\lambda_{t,\\text{trial}}$。\n    *   **滑动 (Slip) 条件**：如果 $|\\lambda_{t,\\text{trial}}| > F_{\\text{fric, max}}$，则界面发生滑动。实际的切向力达到摩擦力极限，其方向与相对滑动速度 $v_t$ 相反：$\\lambda_t = -F_{\\text{fric, max}} \\cdot \\text{sgn}(v_t)$。\n\n**第2步：应用给定值进行计算**\n给定的瞬时状态参数如下：\n- 法向力: $\\lambda_n = 3.8 \\, \\text{N}$\n- 摩擦系数: $\\mu = 0.35$\n- 切向刚度: $k_t = 600 \\, \\text{N/m}$\n- 切向阻尼: $c_t = 0.4 \\, \\text{N·s/m}$\n- 切向位移: $u_t = 0.004 \\, \\text{m}$\n- 切向速度: $v_t = +0.12 \\, \\text{m/s}$\n\n首先，计算试探切向力 $\\lambda_{t,\\text{trial}}$：\n$$\n\\lambda_{t,\\text{trial}} = -( (600 \\, \\text{N/m}) \\cdot (0.004 \\, \\text{m}) + (0.4 \\, \\text{N·s/m}) \\cdot (0.12 \\, \\text{m/s}) )\n$$\n$$\n\\lambda_{t,\\text{trial}} = -(2.4 \\, \\text{N} + 0.048 \\, \\text{N}) = -2.448 \\, \\text{N}\n$$\n接下来，计算最大摩擦力极限 $F_{\\text{fric, max}}$：\n$$\nF_{\\text{fric, max}} = \\mu \\lambda_n = 0.35 \\cdot 3.8 \\, \\text{N} = 1.33 \\, \\text{N}\n$$\n现在，比较试探力的大小与摩擦力极限：\n$$\n|\\lambda_{t,\\text{trial}}| = |-2.448 \\, \\text{N}| = 2.448 \\, \\text{N}\n$$\n因为 $2.448 \\, \\text{N} > 1.33 \\, \\text{N}$，所以系统处于**滑动状态**。\n\n**第3步：确定最终的切向力**\n在滑动状态下，切向力的大小等于摩擦力极限，方向与相对速度 $v_t$ 相反。由于 $v_t$ 是正值（$+0.12 \\, \\text{m/s}$），切向力 $\\lambda_t$ 必须是负值。\n$$\n\\lambda_t = -F_{\\text{fric, max}} = -1.33 \\, \\text{N}\n$$\n将结果四舍五入到三位有效数字，最终的切向接触力为 -1.33 N。",
            "answer": "$$\n\\boxed{-1.33}\n$$"
        }
    ]
}