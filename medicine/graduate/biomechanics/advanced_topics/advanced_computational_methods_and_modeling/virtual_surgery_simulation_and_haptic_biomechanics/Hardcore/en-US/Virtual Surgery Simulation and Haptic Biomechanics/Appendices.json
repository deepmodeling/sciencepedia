{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any patient-specific virtual surgery is an accurate geometric model derived from medical imaging. This exercise explores the critical relationship between the resolution of the source image data and the fidelity of the resulting surface mesh . By deriving the maximum allowable mesh edge length $h^{\\star}$ for a given error tolerance $\\varepsilon$, you will develop a first-principles understanding of how to engineer a mesh that is geometrically faithful enough for haptic interaction, balancing imaging artifacts with discretization error.",
            "id": "4211279",
            "problem": "A patient-specific virtual surgery simulation relies on a surface mesh reconstructed from volumetric medical images to drive real-time haptic interaction. Consider a straight vessel segment whose cross-section is approximated as a circle of radius $r$ (in $\\mathrm{mm}$). The image acquisition provides an isotropic voxel grid with edge length $\\Delta$ (in $\\mathrm{mm}$). A segmentation pipeline extracts the vessel boundary and a meshing algorithm approximates the circular boundary in each cross-section by connecting boundary points with straight line segments of edge length $h$ (in $\\mathrm{mm}$). To ensure stable and accurate force feedback in the haptic loop, the geometric error between the true circular boundary and the piecewise-linear approximation must be controlled.\n\nAssume the following foundations:\n- The geometric error metric is the maximum Euclidean distance, measured in the local surface-normal direction, between the exact circle and any point on a chord segment that approximates it (i.e., the worst-case deviation occurs at the midpoint of each chord).\n- The image resolution imposes a baseline normal-direction uncertainty due to quantization on the voxel grid, which is bounded above by $e_{\\mathrm{res}} = \\Delta/2$ in $\\mathrm{mm}$.\n- The total geometric error for the mesh is the sum of the quantization error and the chord-approximation error, and must not exceed a specified tolerance $\\varepsilon$ (in $\\mathrm{mm}$) required by the haptic controller.\n- Assume $\\varepsilon  \\Delta/2$ so that a nontrivial mesh refinement can reduce the chord-approximation contribution to meet the tolerance.\n\nStarting from first principles of planar circle geometry and the above quantization bound, derive the closed-form expression for the largest admissible boundary edge length $h^{\\star}(r,\\Delta,\\varepsilon)$ (in $\\mathrm{mm}$) such that the total geometric error does not exceed $\\varepsilon$. Express your final answer in $\\mathrm{mm}$. No rounding is required. Provide only the single expression for $h^{\\star}(r,\\Delta,\\varepsilon)$ as your final answer.",
            "solution": "The goal is to bound the geometric error of approximating a circle of radius $r$ by straight line segments of length $h$, while accounting for image resolution–induced quantization error of $e_{\\mathrm{res}} = \\Delta/2$. The total error is modeled as\n$$\ne_{\\mathrm{tot}} = e_{\\mathrm{res}} + e_{\\mathrm{chord}},\n$$\nand the requirement is $e_{\\mathrm{tot}} \\le \\varepsilon$. Under the assumption $\\varepsilon  \\Delta/2$, we have a positive residual budget\n$$\n\\varepsilon' = \\varepsilon - e_{\\mathrm{res}} = \\varepsilon - \\frac{\\Delta}{2}  0,\n$$\nwhich must accommodate the chord-approximation error $e_{\\mathrm{chord}}$.\n\nWe now derive $e_{\\mathrm{chord}}$ from circle geometry. Consider two points on the circle that define an edge of the mesh boundary. The straight line between these points is a chord of the circle of length $h$. The maximum normal deviation between the circular arc and the chord occurs at the midpoint of the chord and is the sagitta $s$, which we take as the chord-approximation error:\n$$\ne_{\\mathrm{chord}} = s.\n$$\nLet $c = h/2$ denote the half-chord length. Construct the right triangle formed by the circle center, the midpoint of the chord, and one chord endpoint. By the Pythagorean theorem,\n$$\nc^{2} + (r - s)^{2} = r^{2}.\n$$\nSolving for $s$ gives\n$$\ns = r - \\sqrt{r^{2} - c^{2}} = r - \\sqrt{r^{2} - \\left(\\frac{h}{2}\\right)^{2}}.\n$$\nImposing the error budget $e_{\\mathrm{chord}} \\le \\varepsilon'$ yields\n$$\nr - \\sqrt{r^{2} - \\left(\\frac{h}{2}\\right)^{2}} \\le \\varepsilon'.\n$$\nRearrange to isolate the square root:\n$$\n\\sqrt{r^{2} - \\left(\\frac{h}{2}\\right)^{2}} \\ge r - \\varepsilon'.\n$$\nSquare both sides (noting both sides are nonnegative because $r - \\varepsilon' \\ge 0$ given $\\varepsilon'  0$ and $r  0$):\n$$\nr^{2} - \\left(\\frac{h}{2}\\right)^{2} \\ge (r - \\varepsilon')^{2}.\n$$\nSolve for $h$:\n$$\n\\left(\\frac{h}{2}\\right)^{2} \\le r^{2} - (r - \\varepsilon')^{2} = r^{2} - \\left(r^{2} - 2 r \\varepsilon' + \\varepsilon'^{2}\\right) = 2 r \\varepsilon' - \\varepsilon'^{2}.\n$$\nThus,\n$$\nh \\le 2 \\sqrt{\\,2 r \\varepsilon' - \\varepsilon'^{2}\\,}.\n$$\nThe largest admissible edge length that satisfies the tolerance $\\varepsilon$ is the upper bound,\n$$\nh^{\\star}(r,\\Delta,\\varepsilon) = 2 \\sqrt{\\,2 r \\left(\\varepsilon - \\frac{\\Delta}{2}\\right) - \\left(\\varepsilon - \\frac{\\Delta}{2}\\right)^{2}\\,}.\n$$\n\nThis expression shows how image resolution affects mesh fidelity: as $\\Delta$ increases, the quantization error $e_{\\mathrm{res}} = \\Delta/2$ consumes more of the total error budget $\\varepsilon$, reducing $\\varepsilon' = \\varepsilon - \\Delta/2$ and thereby decreasing the admissible $h^{\\star}$. If $\\varepsilon \\le \\Delta/2$, then $\\varepsilon' \\le 0$ and no mesh refinement (finite $h$) can satisfy the tolerance, reflecting the fundamental limitation of the imaging resolution for geometric fidelity in haptic biomechanics applications.\n\nBecause the problem specifies $\\varepsilon  \\Delta/2$, the closed-form expression above is valid and provides the largest admissible boundary edge length in $\\mathrm{mm}$.",
            "answer": "$$\\boxed{2 \\sqrt{\\,2 r \\left(\\varepsilon - \\frac{\\Delta}{2}\\right) - \\left(\\varepsilon - \\frac{\\Delta}{2}\\right)^{2}\\,}}$$"
        },
        {
            "introduction": "To achieve the high update rates required for haptic feedback, simulators often rely on explicit time integration and simplified physical models. This practice delves into one of the most common and effective simplifications: mass lumping in the Finite Element Method . You will analyze how this technique alters the system's dynamic properties, leading to a larger stable time step $\\Delta t$ at the expense of modal accuracy, a fundamental trade-off in haptic biomechanics.",
            "id": "4211308",
            "problem": "A virtual surgery simulator for soft tissue employs the finite element method (FEM) with linear tetrahedral elements to achieve real-time haptic feedback. Consider a single linear tetrahedral element with volume $V$, uniform mass density $\\rho$, and nodal shape functions $\\{N_i\\}_{i=1}^4$ that are the barycentric coordinates of the tetrahedron and satisfy $\\sum_{i=1}^4 N_i = 1$ and $N_i \\ge 0$ in the element. The semi-discrete equations of motion for small elastic oscillations take the form $M \\ddot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$, where $M$ is the mass matrix, $K$ is the stiffness matrix, and $\\mathbf{u}$ is the nodal displacement vector. In explicit time integration with the central difference scheme, the stability limit is governed by the highest natural frequency $\\omega_{\\max}$ through a bound of the form $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$.\n\nStarting from the definitions $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$ and $m_i^{\\text{lump}} = \\sum_{j=1}^4 M_{ij}$ for an element $\\Omega_e$, and assembling over the mesh in the standard FEM manner, address the following:\n\n- Compute the lumped mass assigned to each node of a single linear tetrahedral element (per translational degree of freedom), expressed in terms of $V$ and $\\rho$.\n- Use first-principle arguments (without invoking any shortcut formulas specific to stability thresholds) to compare how mass lumping versus a consistent mass matrix affects the maximum stable time step of explicit central-difference integration and the accuracy of modal frequencies, particularly for high-frequency modes relevant to contact and cutting events in haptic biomechanics.\n\nChoose the single best statement:\n\nA. The lumped mass for a linear tetrahedral element assigns equal nodal masses $m_i = \\rho V / 4$ per translational degree of freedom; compared to the consistent mass, mass lumping increases the maximum stable time step in explicit central-difference integration and induces larger eigenfrequency errors primarily in high-frequency modes.\n\nB. The lumped mass assigns nodal masses $m_i = \\rho V / 10$; mass lumping decreases the maximum stable time step compared to the consistent mass and improves high-frequency accuracy.\n\nC. The consistent mass matrix for a linear tetrahedral element is diagonal with entries $m_i = \\rho V / 4$, making explicit integration stability and accuracy identical to the lumped mass case.\n\nD. The lumped mass assigns equal nodal masses $m_i = \\rho V / 4$, but it reduces the maximum stable time step and improves modal accuracy across the spectrum relative to the consistent mass.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n**Step 1: Extract Givens**\n-   Finite Element Method (FEM) with linear tetrahedral elements is used for soft tissue simulation.\n-   Element volume: $V$.\n-   Element mass density: $\\rho$ (uniform).\n-   Nodal shape functions for a single element: $\\{N_i\\}_{i=1}^4$.\n-   Shape functions are barycentric coordinates.\n-   Properties of shape functions: $\\sum_{i=1}^4 N_i = 1$ and $N_i \\ge 0$ within the element $\\Omega_e$.\n-   Semi-discrete equations of motion: $M \\ddot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$.\n-   Time integration: Explicit central difference scheme.\n-   Stability limit: $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$, where $\\omega_{\\max}$ is the highest natural frequency.\n-   Consistent mass matrix element definition: $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$.\n-   Lumped mass element definition: $m_i^{\\text{lump}} = \\sum_{j=1}^4 M_{ij}$.\n-   The first task is to compute the lumped mass per node per translational degree of freedom.\n-   The second task is to compare mass lumping versus a consistent mass matrix regarding the maximum stable time step and the accuracy of modal frequencies, especially for high-frequency modes.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental principles of the Finite Element Method in solid mechanics and structural dynamics. The definitions provided for the consistent and lumped mass matrices are standard. The stability criterion for the central difference method is correctly stated. The application context (virtual surgery, haptics) is a well-established field where these methods are employed. The problem provides all necessary information to perform the requested calculation and comparison. The terminology is precise and unambiguous. There are no contradictions, unrealistic conditions, or logical flaws.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. A solution will be derived.\n\n**Derivation**\n\nThe problem has two parts: calculating the lumped mass and comparing its effects to the consistent mass matrix.\n\n**Part 1: Computation of the Lumped Mass**\n\nThe lumped mass for node $i$ of an element, $m_i^{\\text{lump}}$, is defined by summing the entries in the $i$-th row of the element's consistent mass matrix, $M$.\n$$m_i^{\\text{lump}} = \\sum_{j=1}^{4} M_{ij}$$\nSubstituting the definition of the consistent mass matrix entries, $M_{ij} = \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$:\n$$m_i^{\\text{lump}} = \\sum_{j=1}^{4} \\int_{\\Omega_e} \\rho \\, N_i N_j \\, dV$$\nSince the density $\\rho$ is uniform, it can be factored out. The sum and integral can be interchanged:\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} \\sum_{j=1}^{4} (N_i N_j) \\, dV$$\nFactoring out $N_i$:\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} N_i \\left( \\sum_{j=1}^{4} N_j \\right) \\, dV$$\nThe problem states that the shape functions satisfy the property $\\sum_{j=1}^{4} N_j = 1$ everywhere within the element. Substituting this into the expression:\n$$m_i^{\\text{lump}} = \\rho \\int_{\\Omega_e} N_i (1) \\, dV = \\rho \\int_{\\Omega_e} N_i \\, dV$$\nThe integral of a single barycentric coordinate $N_i$ over the volume $V$ of a tetrahedron is a standard result. It can be found using the formula for integrals of products of barycentric coordinates over a $d$-dimensional simplex:\n$$\\int_V \\prod_{k=1}^{d+1} L_k^{a_k} \\, dV = \\frac{(\\prod_{k=1}^{d+1} a_k!) \\, d!}{(\\sum_{k=1}^{d+1} a_k + d)!} V$$\nFor our case, we are integrating $N_i$ over a tetrahedron, so $d=3$. This corresponds to setting $a_i=1$ and all other $a_k=0$ for $k \\neq i$.\n$$\\int_{\\Omega_e} N_i \\, dV = \\frac{1! \\cdot (0!)^3 \\cdot 3!}{(1+0+0+0+3)!} V = \\frac{1 \\cdot 1 \\cdot 6}{4!} V = \\frac{6}{24} V = \\frac{V}{4}$$\nTherefore, the lumped mass at node $i$ is:\n$$m_i^{\\text{lump}} = \\rho \\left( \\frac{V}{4} \\right) = \\frac{\\rho V}{4}$$\nThis mass value applies to each translational degree of freedom associated with the node. This result shows that the total mass of the element, $\\rho V$, is distributed equally among its four nodes.\n\n**Part 2: Comparison of Mass Lumping vs. Consistent Mass**\n\n**Effect on Maximum Stable Time Step:**\nThe stability of the explicit central difference scheme is limited by the highest natural frequency of the discrete system, $\\omega_{\\max}$, via $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$. To maximize the stable time step $\\Delta t$, one requires the lowest possible $\\omega_{\\max}$. The natural frequencies $\\omega$ are the solutions to the generalized eigenvalue problem $K \\phi = \\omega^2 M \\phi$.\n\nLet $M^c$ be the consistent mass matrix and $M^l$ be the lumped mass matrix. $M^l$ is diagonal, while $M^c$ is fully populated. It is a known result in finite element analysis that for most common element types, including linear tetrahedra, mass lumping reduces the spectral radius of the matrix $M^{-1}K$, which means it under-predicts the higher natural frequencies. Therefore, $\\omega_{\\max, l}  \\omega_{\\max, c}$.\nSince $\\Delta t_{max} \\propto 1/\\omega_{\\max}$, it follows that $\\Delta t_{max, l} > \\Delta t_{max, c}$. Thus, mass lumping *increases* the maximum stable time step, which is a primary reason for its use in explicit dynamics.\n\n**Effect on Modal Accuracy:**\nThe consistent mass matrix is derived from the Galerkin weak form using the same shape functions as the stiffness matrix, $K$. It provides a mathematically consistent representation of the system's inertia and is known to yield more accurate approximations of the system's natural frequencies, particularly the lower, structurally significant modes.\nMass lumping is an approximation that simplifies the mass matrix to be diagonal. This simplification comes at the cost of accuracy. While the effect on low-frequency modes might be modest, the error becomes significant for high-frequency modes. These modes, which involve deformations at the scale of a single element, are poorly represented by the mesh to begin with. Mass lumping further distorts their frequencies, typically under-predicting them substantially. Therefore, mass lumping *decreases* modal accuracy, and this effect is most pronounced for high-frequency modes.\n\n**Option-by-Option Analysis**\n\n**A. The lumped mass for a linear tetrahedral element assigns equal nodal masses $m_i = \\rho V / 4$ per translational degree of freedom; compared to the consistent mass, mass lumping increases the maximum stable time step in explicit central-difference integration and induces larger eigenfrequency errors primarily in high-frequency modes.**\n-   Nodal mass calculation $m_i = \\rho V / 4$: Correct, as derived.\n-   Effect on time step (increases): Correct, as derived. Mass lumping lowers $\\omega_{\\max}$, which increases $\\Delta t_{\\max}$.\n-   Effect on accuracy (induces larger errors in high-frequency modes): Correct. Lumping is an approximation that most severely impacts the poorly-resolved high-frequency modes.\n-   **Verdict: Correct.**\n\n**B. The lumped mass assigns nodal masses $m_i = \\rho V / 10$; mass lumping decreases the maximum stable time step compared to the consistent mass and improves high-frequency accuracy.**\n-   Nodal mass calculation $m_i = \\rho V / 10$: Incorrect. This is the value of the diagonal entry of the *consistent* mass matrix, $M_{ii}$. The lumped mass is $\\rho V/4$.\n-   Effect on time step (decreases): Incorrect. It increases the time step for this element type.\n-   Effect on accuracy (improves): Incorrect. It degrades accuracy.\n-   **Verdict: Incorrect.**\n\n**C. The consistent mass matrix for a linear tetrahedral element is diagonal with entries $m_i = \\rho V / 4$, making explicit integration stability and accuracy identical to the lumped mass case.**\n-   Consistent mass matrix is diagonal: Incorrect. The off-diagonal entries are non-zero.\n-   Entries are $m_i = \\rho V / 4$: Incorrect. The diagonal entries are $M_{ii} = \\rho V / 10$.\n-   Conclusion (identical stability and accuracy): Incorrect, as the matrices are not identical.\n-   **Verdict: Incorrect.**\n\n**D. The lumped mass assigns equal nodal masses $m_i = \\rho V / 4$, but it reduces the maximum stable time step and improves modal accuracy across the spectrum relative to the consistent mass.**\n-   Nodal mass calculation $m_i = \\rho V / 4$: Correct.\n-   Effect on time step (reduces): Incorrect. It increases the time step.\n-   Effect on accuracy (improves): Incorrect. It degrades accuracy.\n-   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The feeling of a surgical tool interacting with tissue is dominated by complex contact forces, especially friction. This practice challenges you to derive and apply a physically consistent stick-slip friction model, a cornerstone of high-fidelity haptic rendering . By combining a compliant interface model with a Coulomb friction limit $|\\lambda_{t}| \\le \\mu \\lambda_{n}$, you will learn to implement the non-linear logic that computationally distinguishes between the states of sticking and sliding.",
            "id": "4211239",
            "problem": "A virtual surgery simulation couples a Haptic Device (HD) to a soft-tissue contact model to provide force feedback. Consider a single instrument tip constrained to a planar tissue surface with a known normal contact reaction. The tangential interaction is modeled by a compliant interfacial element in parallel with dry friction. At the instant of interest, the tissue tool-tip normal reaction is measured as $\\lambda_{n} = 3.8$ Newtons, and the coefficient of Coulomb friction is $\\mu = 0.35$. The tangential interfacial compliance is described by a Kelvin–Voigt element with stiffness $k_{t} = 600$ Newtons per meter and damping $c_{t} = 0.4$ Newton seconds per meter. The current tangential interfacial displacement is $u_{t} = 0.004$ meters and the relative tangential sliding velocity is $v_{t} = +0.12$ meters per second along the positive tangent direction.\n\nStarting from fundamental laws and core definitions, derive a mathematically consistent stick–slip Coulomb friction law based on the normal reaction bound and energy dissipation. Use the inequality $|\\lambda_{t}| \\le \\mu \\lambda_{n}$ as the admissibility condition for sticking, and determine the physically consistent transition criterion between stick and slip. Then, for the given instantaneous state, compute the signed tangential contact force $\\lambda_{t}$ delivered to the HD.\n\nRound your final numerical value to three significant figures. Express the tangential contact force in Newtons.",
            "solution": "The problem asks for the tangential contact force $\\lambda_t$ based on a stick-slip friction model. The model combines a compliant interfacial element (Kelvin-Voigt) with a Coulomb friction limit. The total tangential force is determined by comparing a \"trial\" force from the compliant element to the maximum possible static friction force.\n\n**1. Define the Physical Model and Stick-Slip Law**\n\nThe tangential interaction is modeled by a Kelvin-Voigt element in parallel with a Coulomb friction element. This is a common approach in computational contact mechanics. The force from the Kelvin-Voigt element, which we call the \"trial\" force ($\\lambda_{t, \\text{trial}}$), represents the restoring force of the tissue interface if it were able to stick. This force opposes the tangential displacement $u_t$ and velocity $v_t$.\n$$\n\\lambda_{t, \\text{trial}} = -(k_t u_t + c_t v_t)\n$$\nThe Coulomb friction model imposes a limit on the magnitude of this tangential force. The contact will \"stick\" if the trial force is within this limit and \"slip\" if it exceeds it. The maximum sustainable static friction force is given by the product of the coefficient of friction $\\mu$ and the normal force $\\lambda_n$:\n$$\nF_{\\text{friction, max}} = \\mu \\lambda_n\n$$\nThe stick-slip logic is as follows:\n- **Stick Condition:** If $|\\lambda_{t, \\text{trial}}| \\le F_{\\text{friction, max}}$, the interface does not slip. The actual tangential force is equal to the trial force: $\\lambda_t = \\lambda_{t, \\text{trial}}$.\n- **Slip Condition:** If $|\\lambda_{t, \\text{trial}}|  F_{\\text{friction, max}}$, the interface slips. The tangential force saturates at the kinetic friction limit (assumed equal to the static limit here), and its direction opposes the relative motion to ensure energy dissipation.\n$$\n\\lambda_t = -F_{\\text{friction, max}} \\cdot \\text{sgn}(v_t)\n$$\n\n**2. Compute Numerical Values for the Given State**\n\nWe are given the following instantaneous values:\n- Normal reaction: $\\lambda_n = 3.8\\ \\text{N}$\n- Coefficient of friction: $\\mu = 0.35$\n- Tangential stiffness: $k_t = 600\\ \\text{N/m}$\n- Tangential damping: $c_t = 0.4\\ \\text{Ns/m}$\n- Tangential displacement: $u_t = 0.004\\ \\text{m}$\n- Tangential velocity: $v_t = +0.12\\ \\text{m/s}$\n\nFirst, calculate the trial force from the compliant Kelvin-Voigt element:\n$$\n\\lambda_{t, \\text{trial}} = -(k_t u_t + c_t v_t) = -((600\\ \\text{N/m})(0.004\\ \\text{m}) + (0.4\\ \\text{Ns/m})(0.12\\ \\text{m/s}))\n$$\n$$\n\\lambda_{t, \\text{trial}} = -(2.4\\ \\text{N} + 0.048\\ \\text{N}) = -2.448\\ \\text{N}\n$$\nNext, calculate the maximum static friction force:\n$$\nF_{\\text{friction, max}} = \\mu \\lambda_n = (0.35)(3.8\\ \\text{N}) = 1.33\\ \\text{N}\n$$\nNow, compare the magnitude of the trial force to the friction limit:\n$$\n|\\lambda_{t, \\text{trial}}| = |-2.448\\ \\text{N}| = 2.448\\ \\text{N}\n$$\nSince $2.448\\ \\text{N} > 1.33\\ \\text{N}$, the condition for slipping is met.\n\n**3. Calculate the Final Tangential Force**\n\nThe contact is slipping. The tangential force will have a magnitude equal to the friction limit and will oppose the direction of velocity. Since the velocity $v_t = +0.12\\ \\text{m/s}$ is positive, the force must be negative.\n$$\n\\lambda_t = -F_{\\text{friction, max}} = -1.33\\ \\text{N}\n$$\nThe question asks to round the final answer to three significant figures. The calculated value $-1.33$ already has three significant figures.\n\nThe final tangential contact force delivered to the HD is $-1.33\\ \\text{N}$.",
            "answer": "$$\n\\boxed{-1.33}\n$$"
        }
    ]
}