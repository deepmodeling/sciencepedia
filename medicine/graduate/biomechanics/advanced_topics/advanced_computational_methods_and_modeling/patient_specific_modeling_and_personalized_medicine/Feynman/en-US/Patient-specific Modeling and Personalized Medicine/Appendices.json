{
    "hands_on_practices": [
        {
            "introduction": "The heart of any patient-specific solid mechanics model is the constitutive law, which mathematically describes how a tissue deforms under load. This practice provides essential training in deriving the stress-strain relationship from a given strain energy function, a fundamental skill for implementing and customizing material models. By working through the derivation for a transversely isotropic material, you will connect the abstract concept of strain energy, $W$, to the tangible Cauchy stress tensor, $\\boldsymbol{\\sigma}$, used in finite element simulations .",
            "id": "4198117",
            "problem": "Consider a patient-specific hyperelastic model for a transversely isotropic soft tissue with a single fiber family, where the fiber direction in the reference configuration $\\boldsymbol{a}_0$ is obtained from imaging (for example, diffusion tensor magnetic resonance imaging) and serves as a personalized input. Let the deformation gradient be $\\boldsymbol{F}$, the right Cauchy–Green tensor be $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$, the left Cauchy–Green tensor be $\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\top}$, and the current fiber direction be $\\boldsymbol{m} = \\boldsymbol{F}\\boldsymbol{a}_0$. Assume the tissue is incompressible so that $J = \\det(\\boldsymbol{F}) = 1$, and the isochoric fiber invariant equals the structural invariant $\\,\\bar{I}_4 = I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0 = \\boldsymbol{m} \\cdot \\boldsymbol{m}\\,$. Let the strain energy density be\n$$\nW = C_{10}\\,(I_1 - 3) + \\frac{k_1}{2k_2}\\left(\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right] - 1\\right),\n$$\nwhere $I_1 = \\operatorname{tr}(\\boldsymbol{C})$, $C_{10} > 0$ characterizes the isotropic matrix response, and $k_1 > 0$, $k_2 > 0$ characterize the fiber reinforcement, all to be calibrated patient-specifically.\n\nStarting from first principles of hyperelasticity and incompressibility, derive the Cauchy stress tensor $\\boldsymbol{\\sigma}$ as a closed-form expression in terms of the invariants and the fiber direction. Your derivation must begin from the fundamental definitions and the energy function $W$ and must not assume any pre-derived stress formula. Express the final result using only the symbols $C_{10}$, $k_1$, $k_2$, $\\bar{I}_4$, $\\boldsymbol{B}$, $\\boldsymbol{m}$, $\\boldsymbol{I}$, and the Lagrange multiplier $p$ enforcing incompressibility. The final answer must be a single analytical expression. No numerical evaluation is required.",
            "solution": "The appropriate starting point is the principle of hyperelasticity, which states that stress arises from the variation of the strain energy density with respect to the strain measure. For incompressible hyperelastic materials, the second Cauchy–Green tensor $\\boldsymbol{C}$ is a suitable strain measure, and the second Piola–Kirchhoff stress $\\boldsymbol{S}$ follows from the constrained energy functional using a Lagrange multiplier $p$ to enforce incompressibility. Specifically, the constitutive relation is\n$$\n\\boldsymbol{S} = -p\\,\\boldsymbol{C}^{-1} + 2\\,\\frac{\\partial W}{\\partial \\boldsymbol{C}}.\n$$\nThe Cauchy stress $\\boldsymbol{\\sigma}$ is then obtained by pushing forward $\\boldsymbol{S}$:\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{J}\\,\\boldsymbol{F}\\,\\boldsymbol{S}\\,\\boldsymbol{F}^{\\top}.\n$$\nUnder the incompressibility assumption $J=1$, this reduces to\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{F}\\,\\boldsymbol{S}\\,\\boldsymbol{F}^{\\top}.\n$$\n\nWe next evaluate $\\partial W/\\partial \\boldsymbol{C}$ via the chain rule in terms of the invariants that $W$ depends on. The given energy density is\n$$\nW(I_1,\\bar{I}_4) = C_{10}\\,(I_1 - 3) + \\frac{k_1}{2k_2}\\left(\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right] - 1\\right),\n$$\nwith $I_1 = \\operatorname{tr}(\\boldsymbol{C})$ and, under incompressibility, $\\bar{I}_4 = I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0$. The differential of $W$ with respect to $\\boldsymbol{C}$ is\n$$\n\\frac{\\partial W}{\\partial \\boldsymbol{C}} = \\frac{\\partial W}{\\partial I_1}\\,\\frac{\\partial I_1}{\\partial \\boldsymbol{C}} + \\frac{\\partial W}{\\partial \\bar{I}_4}\\,\\frac{\\partial \\bar{I}_4}{\\partial \\boldsymbol{C}}.\n$$\nWe compute each factor:\n\n1. For the first invariant,\n$$\n\\frac{\\partial I_1}{\\partial \\boldsymbol{C}} = \\boldsymbol{I},\n$$\nwhere $\\boldsymbol{I}$ is the identity tensor, and\n$$\n\\frac{\\partial W}{\\partial I_1} = C_{10}.\n$$\n\n2. For the fiber invariant under incompressibility,\n$$\n\\bar{I}_4 = I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0,\n$$\nand its tensor derivative is\n$$\n\\frac{\\partial \\bar{I}_4}{\\partial \\boldsymbol{C}} = \\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0.\n$$\nThe scalar derivative of $W$ with respect to $\\bar{I}_4$ is\n$$\n\\frac{\\partial W}{\\partial \\bar{I}_4} = \\frac{k_1}{2k_2}\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right] \\cdot \\frac{d}{d\\bar{I}_4}\\left(k_2(\\bar{I}_4 - 1)^2\\right) = k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right].\n$$\n\nPutting these together,\n$$\n\\frac{\\partial W}{\\partial \\boldsymbol{C}} = C_{10}\\,\\boldsymbol{I} + k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0).\n$$\nTherefore, the second Piola–Kirchhoff stress is\n$$\n\\boldsymbol{S} = -p\\,\\boldsymbol{C}^{-1} + 2\\,C_{10}\\,\\boldsymbol{I} + 2\\,k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0).\n$$\n\nWe now push forward $\\boldsymbol{S}$ to obtain the Cauchy stress. Using $\\boldsymbol{\\sigma} = \\boldsymbol{F}\\,\\boldsymbol{S}\\,\\boldsymbol{F}^{\\top}$ and recalling the identities $\\boldsymbol{F}\\,\\boldsymbol{C}^{-1}\\,\\boldsymbol{F}^{\\top} = \\boldsymbol{I}$ (since $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$), $\\boldsymbol{F}\\,\\boldsymbol{I}\\,\\boldsymbol{F}^{\\top} = \\boldsymbol{B}$, and $\\boldsymbol{F}\\,(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\\,\\boldsymbol{F}^{\\top} = (\\boldsymbol{F}\\boldsymbol{a}_0)\\otimes(\\boldsymbol{F}\\boldsymbol{a}_0) = \\boldsymbol{m} \\otimes \\boldsymbol{m}$, we obtain\n$$\n\\boldsymbol{\\sigma} = -p\\,\\boldsymbol{I} + 2\\,C_{10}\\,\\boldsymbol{B} + 2\\,k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{m} \\otimes \\boldsymbol{m}).\n$$\n\nThis expression presents the Cauchy stress in terms of the invariants $I_1$ and $\\bar{I}_4$ through their appearance in the coefficients and the structural tensors $\\boldsymbol{B}$ and $\\boldsymbol{m}\\otimes\\boldsymbol{m}$, with $p$ enforcing incompressibility. It is directly applicable to patient-specific modeling because the fiber direction $\\boldsymbol{a}_0$ (and hence $\\boldsymbol{m}$ and $\\bar{I}_4$) and the material parameters $C_{10}$, $k_1$, $k_2$ are calibrated using patient-specific data.",
            "answer": "$$\\boxed{-p\\,\\boldsymbol{I} + 2\\,C_{10}\\,\\boldsymbol{B} + 2\\,k_1\\,(\\bar{I}_4 - 1)\\,\\exp\\!\\left[k_2(\\bar{I}_4 - 1)^2\\right]\\,(\\boldsymbol{m} \\otimes \\boldsymbol{m})}$$"
        },
        {
            "introduction": "Patient-specific models are built upon data derived from medical imaging, which is susceptible to errors like segmentation bias; a model is only as good as its inputs. This exercise demonstrates the profound impact that seemingly small geometric inaccuracies can have on simulation outcomes, a crucial concept often summarized as \"garbage in, garbage out\" . By applying the principles of fluid dynamics, you will quantify how a minor overestimation of a vessel's radius leads to a dramatic, non-linear error in the predicted blood flow rate.",
            "id": "4198129",
            "problem": "A patient-specific computational pipeline for vascular biomechanics is used to plan therapy for an individual with peripheral artery disease. The true lumen radius of a straight, rigid arterial segment measured by intravascular ultrasound is $r_{\\mathrm{true}}=4.0~\\mathrm{mm}$. However, due to a systematic imaging segmentation bias, the reconstructed lumen boundary in the model is uniformly offset radially outward by $b=1.0~\\mathrm{mm}$ across the entire cross-section, so the model uses $r_{\\mathrm{seg}}=r_{\\mathrm{true}}+b$. Blood is modeled as an incompressible Newtonian fluid with dynamic viscosity $\\mu=3.5\\times 10^{-3}~\\mathrm{Pa}\\cdot\\mathrm{s}$, flowing steadily and axisymmetrically through the cylindrical segment of length $L=0.20~\\mathrm{m}$ under a fixed pressure drop $\\Delta P$ imposed between its ends.\n\nStarting from the governing balance laws for viscous flow in a straight circular pipe and the geometric definition of cross-sectional area, derive how the hydraulic resistance depends on the radius and quantify the multiplicative change in cross-sectional area and hydraulic resistance when the uniform radial offset $b$ is applied. Then, using the derived relationships, compute the resulting percentage change in volumetric flow rate at fixed $\\Delta P$ caused by using $r_{\\mathrm{seg}}$ instead of $r_{\\mathrm{true}}$.\n\nExpress the percentage change as a decimal (for example, $0.05$ for five percent), and round your final answer to four significant figures. Do not include any units in your final answer.",
            "solution": "The problem is scientifically well-posed and contains sufficient information for a unique solution. The analysis of flow in the arterial segment is based on the principles of fluid dynamics for steady, axisymmetric, fully developed laminar flow of an incompressible Newtonian fluid in a rigid circular pipe. This is described by the Hagen-Poiseuille equation.\n\nFirst, we establish the relationship between volumetric flow rate $Q$, pressure drop $\\Delta P$, and the geometry of the pipe. The velocity profile for such a flow is parabolic, given by $u(r) = \\frac{\\Delta P}{4\\mu L}(R^{2} - r^{2})$, where $R$ is the pipe's inner radius, $L$ is its length, $\\mu$ is the dynamic viscosity of the fluid, and $r$ is the radial coordinate. The volumetric flow rate $Q$ is found by integrating this velocity profile over the cross-sectional area $A$:\n$$Q = \\int_{A} u(r) dA = \\int_{0}^{R} \\frac{\\Delta P}{4\\mu L}(R^{2} - r^{2}) (2\\pi r) dr$$\n$$Q = \\frac{2\\pi \\Delta P}{4\\mu L} \\int_{0}^{R} (R^{2}r - r^{3}) dr = \\frac{\\pi \\Delta P}{2\\mu L} \\left[ \\frac{R^{2}r^{2}}{2} - \\frac{r^{4}}{4} \\right]_{0}^{R}$$\nThis yields the Hagen-Poiseuille equation:\n$$Q = \\frac{\\pi R^{4} \\Delta P}{8\\mu L}$$\nHydraulic resistance, $R_h$, is defined by the analogy to Ohm's law, $\\Delta P = Q R_h$. From the Hagen-Poiseuille equation, we can derive the expression for $R_h$:\n$$R_h = \\frac{\\Delta P}{Q} = \\frac{8\\mu L}{\\pi R^{4}}$$\nThis derivation shows that hydraulic resistance is inversely proportional to the fourth power of the radius, $R_h \\propto R^{-4}$.\n\nThe problem describes a scenario where the true radius, $r_{\\mathrm{true}} = 4.0~\\mathrm{mm}$, is incorrectly measured due to a systematic outward bias $b = 1.0~\\mathrm{mm}$, resulting in a segmented radius $r_{\\mathrm{seg}} = r_{\\mathrm{true}} + b$. We are asked to quantify the effect of this error.\n\nLet's first determine the multiplicative change in cross-sectional area. The area $A$ is given by $A = \\pi r^{2}$.\nThe true area is $A_{\\mathrm{true}} = \\pi r_{\\mathrm{true}}^{2}$.\nThe segmented area is $A_{\\mathrm{seg}} = \\pi r_{\\mathrm{seg}}^{2} = \\pi (r_{\\mathrm{true}} + b)^{2}$.\nThe multiplicative change in area is the ratio $\\frac{A_{\\mathrm{seg}}}{A_{\\mathrm{true}}}$:\n$$\\frac{A_{\\mathrm{seg}}}{A_{\\mathrm{true}}} = \\frac{\\pi (r_{\\mathrm{true}} + b)^{2}}{\\pi r_{\\mathrm{true}}^{2}} = \\left(\\frac{r_{\\mathrm{true}} + b}{r_{\\mathrm{true}}}\\right)^{2} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{2}$$\n\nNext, we determine the multiplicative change in hydraulic resistance. From the derived formula, $R_h \\propto r^{-4}$.\nThe true resistance is $R_{h, \\mathrm{true}} = \\frac{8\\mu L}{\\pi r_{\\mathrm{true}}^{4}}$.\nThe resistance calculated from the segmented model is $R_{h, \\mathrm{seg}} = \\frac{8\\mu L}{\\pi r_{\\mathrm{seg}}^{4}} = \\frac{8\\mu L}{\\pi (r_{\\mathrm{true}} + b)^{4}}$.\nThe multiplicative change in resistance is the ratio $\\frac{R_{h, \\mathrm{seg}}}{R_{h, \\mathrm{true}}}$:\n$$\\frac{R_{h, \\mathrm{seg}}}{R_{h, \\mathrm{true}}} = \\frac{8\\mu L / (\\pi (r_{\\mathrm{true}} + b)^{4})}{8\\mu L / (\\pi r_{\\mathrm{true}}^{4})} = \\frac{r_{\\mathrm{true}}^{4}}{(r_{\\mathrm{true}} + b)^{4}} = \\left(\\frac{r_{\\mathrm{true}}}{r_{\\mathrm{true}} + b}\\right)^{4} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{-4}$$\n\nFinally, we compute the resulting percentage change in volumetric flow rate, $Q$, at a fixed pressure drop $\\Delta P$. The flow rate based on the true radius is $Q_{\\mathrm{true}} = \\frac{\\Delta P}{R_{h, \\mathrm{true}}}$, while the flow rate predicted by the model using the segmented radius is $Q_{\\mathrm{seg}} = \\frac{\\Delta P}{R_{h, \\mathrm{seg}}}$. The percentage change is defined as $\\frac{Q_{\\mathrm{seg}} - Q_{\\mathrm{true}}}{Q_{\\mathrm{true}}}$.\nThis can be expressed as:\n$$\\frac{Q_{\\mathrm{seg}} - Q_{\\mathrm{true}}}{Q_{\\mathrm{true}}} = \\frac{Q_{\\mathrm{seg}}}{Q_{\\mathrm{true}}} - 1$$\nSince $Q = \\Delta P / R_h$ and $\\Delta P$ is constant, the ratio of flow rates is the inverse of the ratio of resistances:\n$$\\frac{Q_{\\mathrm{seg}}}{Q_{\\mathrm{true}}} = \\frac{\\Delta P / R_{h, \\mathrm{seg}}}{\\Delta P / R_{h, \\mathrm{true}}} = \\frac{R_{h, \\mathrm{true}}}{R_{h, \\mathrm{seg}}} = \\frac{1}{(1 + \\frac{b}{r_{\\mathrm{true}}})^{-4}} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{4}$$\nTherefore, the percentage change in flow rate is:\n$$\\text{Percentage Change} = \\left(1 + \\frac{b}{r_{\\mathrm{true}}}\\right)^{4} - 1$$\nNow, we substitute the given numerical values: $r_{\\mathrm{true}} = 4.0~\\mathrm{mm}$ and $b = 1.0~\\mathrm{mm}$. The units cancel in the ratio.\n$$\\text{Percentage Change} = \\left(1 + \\frac{1.0}{4.0}\\right)^{4} - 1 = (1 + 0.25)^{4} - 1 = (1.25)^{4} - 1$$\nCalculating the value:\n$$(1.25)^{2} = 1.5625$$\n$$(1.25)^{4} = (1.5625)^{2} = 2.44140625$$\n$$\\text{Percentage Change} = 2.44140625 - 1 = 1.44140625$$\nThe problem requires the answer to be expressed as a decimal rounded to four significant figures.\n$$\\text{Percentage Change} \\approx 1.441$$\nThis indicates that the systematic overestimation of the radius by $1.0~\\mathrm{mm}$ leads to an overestimation of the volumetric flow rate by approximately $144.1\\%$.",
            "answer": "$$\\boxed{1.441}$$"
        },
        {
            "introduction": "Calibrating a model with patient data is a cornerstone of personalized medicine, but this process raises a critical question: how trustworthy are the resulting parameter values? This exercise introduces the powerful statistical method of profile likelihood to move beyond simple best-fit estimates and rigorously quantify the uncertainty in model parameters . You will implement this technique to determine the practical identifiability of stiffness parameters in an arterial wall model, a vital step in assessing the reliability of any model-based clinical prediction.",
            "id": "4198157",
            "problem": "You are tasked with building a patient-specific arterial wall model for personalized medicine using pressure–diameter measurements with additive noise. From biomechanical first principles, you must derive the mapping from diameter to pressure using a thin-wall equilibrium and an exponential constitutive law, then implement a profile likelihood analysis to assess practical identifiability of two stiffness parameters. Your final program must simulate data for three test cases, fit the model, compute profile likelihoods for each parameter, and report confidence interval widths that quantify identifiability.\n\nBegin from the following fundamental base:\n\n- Thin-wall circumferential equilibrium (Laplace law): the circumferential Cauchy stress is related to blood pressure by $$\\sigma_{\\theta} = \\frac{P R}{h},$$ where $P$ is blood pressure, $R$ is the deformed vessel radius, and $h$ is the wall thickness. This equilibrium is appropriate for arteries whose wall thickness is small relative to the radius.\n\n- Green-Lagrange circumferential strain definition: $$E_{\\theta} = \\frac{1}{2}(\\lambda_{\\theta}^2 - 1), \\quad \\lambda_{\\theta} = \\frac{D}{D_0},$$ where $D$ is the deformed diameter and $D_0$ is the reference diameter.\n\n- Exponential stress–strain law (Fung-type) with two unknown stiffness parameters: $$\\sigma_{\\theta}(E_{\\theta}; a,b) = a \\, \\exp(b \\, E_{\\theta}),$$ where $a$ has units of stress and $b$ is dimensionless.\n\nAssume the observed pressures are generated by the forward model with additive independent and identically distributed Gaussian noise of unknown variance. Given measurements $\\{(D_i, P_i^{\\text{obs}})\\}_{i=1}^{n}$, the observation model is $$P_i^{\\text{obs}} = P(D_i; a,b) + \\varepsilon_i, \\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),$$ where $\\sigma^2$ is the (unknown) noise variance and $P(D_i; a,b)$ is the model-implied pressure at diameter $D_i$ from the derived equilibrium.\n\nYou must:\n1. Derive, from the given fundamental base without shortcuts, the expression for $P(D;a,b)$ as a function of $D$, $a$, $b$, $D_0$, and $h$.\n2. Use the Gaussian likelihood with variance concentrated out to define the profile likelihood for each parameter. Let the sum of squared residuals be $$\\mathrm{SSE}(a,b) = \\sum_{i=1}^{n} \\left(P_i^{\\text{obs}} - P(D_i; a,b)\\right)^2.$$ The maximum likelihood estimates (maximum likelihood estimate, MLE) $(\\hat{a},\\hat{b})$ minimize $\\mathrm{SSE}(a,b)$. For a fixed value of $a$ (respectively, $b$), define the profiled sum of squares $$\\mathrm{SSE}_a(a) = \\min_{b>0} \\mathrm{SSE}(a,b), \\quad \\mathrm{SSE}_b(b) = \\min_{a>0} \\mathrm{SSE}(a,b).$$ Using the concentrated Gaussian likelihood, the likelihood ratio statistic for a single profiled parameter is $$\\Delta_a(a) = n \\, \\ln\\!\\left(\\frac{\\mathrm{SSE}_a(a)}{\\mathrm{SSE}(\\hat{a},\\hat{b})}\\right), \\quad \\Delta_b(b) = n \\, \\ln\\!\\left(\\frac{\\mathrm{SSE}_b(b)}{\\mathrm{SSE}(\\hat{a},\\hat{b})}\\right).$$ Under regularity, $\\Delta_a$ and $\\Delta_b$ are approximately distributed as a chi-square random variable with one degree of freedom. Define the confidence interval for each parameter as the set of values whose profile statistic does not exceed the chi-square quantile at level $0.95$ with one degree of freedom.\n3. Implement a program to compute the profile likelihoods and the corresponding confidence intervals over specified grids and report the confidence interval width for each parameter. Treat $D_0$ and $h$ as known patient-specific constants for each test case and enforce positivity constraints $a>0$ and $b>0$ during optimization.\n\nPhysical and numerical units:\n- Pressure $P$ must be in kilopascals (kPa).\n- Diameter $D$ and thickness $h$ must be in millimeters (mm).\n- Report the confidence interval width for $a$ in kilopascals (kPa) and for $b$ as a dimensionless number, each rounded to six decimal places.\n\nTest suite specification:\n- Test Case $1$ (well-informed, lower noise):\n  - Reference diameter $D_0 = 10$ mm, wall thickness $h = 1$ mm.\n  - True parameters $a_{\\text{true}} = 120$ kPa, $b_{\\text{true}} = 6$.\n  - Diameters $D_i$ uniformly spaced from $8$ mm to $12$ mm with $n = 30$ points.\n  - Noise standard deviation $\\sigma = 2$ kPa.\n  - Random seed $123$ for reproducibility.\n- Test Case $2$ (narrow diameter range, higher noise):\n  - Reference diameter $D_0 = 10$ mm, wall thickness $h = 1$ mm.\n  - True parameters $a_{\\text{true}} = 120$ kPa, $b_{\\text{true}} = 6$.\n  - Diameters $D_i$ uniformly spaced from $9.8$ mm to $10.5$ mm with $n = 20$ points.\n  - Noise standard deviation $\\sigma = 8$ kPa.\n  - Random seed $456$ for reproducibility.\n- Test Case $3$ (near-linear response, moderate noise):\n  - Reference diameter $D_0 = 10$ mm, wall thickness $h = 1$ mm.\n  - True parameters $a_{\\text{true}} = 120$ kPa, $b_{\\text{true}} = 1$.\n  - Diameters $D_i$ uniformly spaced from $8.5$ mm to $11.5$ mm with $n = 30$ points.\n  - Noise standard deviation $\\sigma = 3$ kPa.\n  - Random seed $789$ for reproducibility.\n\nProfile grids and confidence construction:\n- For $a$, evaluate the profile over a grid of $201$ points from $20$ kPa to $300$ kPa.\n- For $b$, evaluate the profile over a grid of $201$ points from $0.5$ to $12$.\n- Use the chi-square quantile at level $0.95$ with one degree of freedom to determine each parameter’s confidence interval. If the entire grid satisfies the inequality or if no grid point satisfies the inequality, report the full grid width as the confidence interval width to indicate practical non-identifiability within the probed range.\n\nFinal output format:\nYour program should produce a single line of output containing the confidence interval widths for $a$ and $b$ for the three test cases, in order, as a comma-separated list enclosed in square brackets. The six values must be in the order $[w_a^{(1)}, w_b^{(1)}, w_a^{(2)}, w_b^{(2)}, w_a^{(3)}, w_b^{(3)}]$, where $w_a^{(j)}$ is the confidence interval width for $a$ in test case $j$ (in kPa) and $w_b^{(j)}$ is the confidence interval width for $b$ in test case $j$ (dimensionless), each rounded to six decimal places. For example, the output must have the form $$[w_a^{(1)},w_b^{(1)},w_a^{(2)},w_b^{(2)},w_a^{(3)},w_b^{(3)}].$$",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in established principles of biomechanics and statistics, is well-posed, objective, and contains all necessary information to proceed with a solution.\n\nThe task requires the derivation of a patient-specific arterial wall model, followed by the implementation of a profile likelihood analysis to assess parameter identifiability from simulated noisy data.\n\n**1. Derivation of the Pressure-Diameter Relationship**\n\nThe goal is to derive an expression for the internal pressure $P$ as a function of the vessel diameter $D$ and a set of model parameters. This is achieved by combining the provided equations for mechanical equilibrium, strain kinematics, and constitutive behavior.\n\nFirst, the circumferential Green-Lagrange strain, $E_{\\theta}$, is defined in terms of the circumferential stretch, $\\lambda_{\\theta}$:\n$$E_{\\theta} = \\frac{1}{2}(\\lambda_{\\theta}^2 - 1)$$\nThe stretch $\\lambda_{\\theta}$ is the ratio of the deformed diameter $D$ to the reference (zero-stress) diameter $D_0$:\n$$\\lambda_{\\theta} = \\frac{D}{D_0}$$\nSubstituting the expression for $\\lambda_{\\theta}$ into the strain definition gives $E_{\\theta}$ as a function of $D$:\n$$E_{\\theta} = \\frac{1}{2}\\left(\\left(\\frac{D}{D_0}\\right)^2 - 1\\right)$$\n\nNext, the Fung-type exponential constitutive law relates the circumferential Cauchy stress, $\\sigma_{\\theta}$, to the strain $E_{\\theta}$ via two material parameters, $a$ and $b$:\n$$\\sigma_{\\theta} = a \\exp(b E_{\\theta})$$\nSubstituting the derived expression for $E_{\\theta}$ into this law gives the stress as a function of diameter:\n$$\\sigma_{\\theta} = a \\exp\\left(b \\left[\\frac{1}{2}\\left(\\frac{D}{D_0}\\right)^2 - \\frac{1}{2}\\right]\\right) = a \\exp\\left(\\frac{b}{2}\\left[\\left(\\frac{D}{D_0}\\right)^2 - 1\\right]\\right)$$\n\nFinally, the thin-wall equilibrium equation (Law of Laplace) relates the stress $\\sigma_{\\theta}$ to the internal pressure $P$, the deformed radius $R$, and the wall thickness $h$:\n$$\\sigma_{\\theta} = \\frac{P R}{h}$$\nSince the radius is half the diameter, $R = D/2$, the equilibrium equation becomes:\n$$\\sigma_{\\theta} = \\frac{P (D/2)}{h} = \\frac{P D}{2h}$$\n\nTo find the pressure-diameter relationship, we equate the constitutive expression for stress with the equilibrium expression for stress:\n$$\\frac{P D}{2h} = a \\exp\\left(\\frac{b}{2}\\left[\\left(\\frac{D}{D_0}\\right)^2 - 1\\right]\\right)$$\nSolving for $P$ yields the final forward model, which we denote as $P(D; a, b)$:\n$$P(D; a,b) = \\frac{2ha}{D} \\exp\\left(\\frac{b}{2}\\left[\\left(\\frac{D}{D_0}\\right)^2 - 1\\right]\\right)$$\nThis equation describes the pressure required to maintain a vessel at diameter $D$, given its material properties ($a$, $b$) and patient-specific geometry ($D_0$, $h$).\n\n**2. Statistical Framework and Numerical Implementation**\n\nThe problem of estimating parameters $a$ and $b$ from noisy measurements $\\{(D_i, P_i^{\\text{obs}})\\}$ is framed as a non-linear least squares problem. Under the assumption of additive, independent, and identically distributed Gaussian noise, minimizing the sum of squared residuals (SSE) is equivalent to maximizing the likelihood.\n\nThe SSE is given by:\n$$\\mathrm{SSE}(a,b) = \\sum_{i=1}^{n} \\left(P_i^{\\text{obs}} - P(D_i; a,b)\\right)^2$$\nThe maximum likelihood estimates (MLEs), $(\\hat{a}, \\hat{b})$, are the values of $a$ and $b$ that minimize this function, subject to the physical constraints $a>0$ and $b>0$.\n$$(\\hat{a}, \\hat{b}) = \\arg\\min_{a>0, b>0} \\mathrm{SSE}(a,b)$$\nThe minimized value of the SSE is denoted $\\mathrm{SSE}_{\\text{min}} = \\mathrm{SSE}(\\hat{a}, \\hat{b})$. This is a $2\\mathrm{D}$ numerical optimization problem.\n\nProfile likelihood analysis is used to assess the identifiability of each parameter individually. For a parameter of interest (e.g., $a$), the nuisance parameter (e.g., $b$) is optimized out for each fixed value of the parameter of interest.\n\nThe profile for $a$ is constructed by calculating the profiled sum of squares, $\\mathrm{SSE}_a(a)$, for each value of $a$ on a predefined grid:\n$$\\mathrm{SSE}_a(a^*) = \\min_{b>0} \\mathrm{SSE}(a^*, b)$$\nThis requires solving a $1\\mathrm{D}$ optimization problem for $b$ for each fixed $a^*$.\n\nSimilarly, the profile for $b$ is:\n$$\\mathrm{SSE}_b(b^*) = \\min_{a>0} \\mathrm{SSE}(a, b^*)$$\n\nThe likelihood ratio statistic, $\\Delta(p)$, for a generic parameter $p$ is then calculated. For parameter $a$, it is:\n$$\\Delta_a(a) = n \\cdot \\ln\\left(\\frac{\\mathrm{SSE}_a(a)}{\\mathrm{SSE}_{\\text{min}}}\\right)$$\nAnd for parameter $b$:\n$$\\Delta_b(b) = n \\cdot \\ln\\left(\\frac{\\mathrm{SSE}_b(b)}{\\mathrm{SSE}_{\\text{min}}}\\right)$$\n\nA pointwise $95\\%$ confidence interval for each parameter is defined as the set of parameter values for which the likelihood ratio statistic does not exceed a critical threshold. This threshold is the quantile of the chi-square distribution with one degree of freedom at a confidence level of $1-\\alpha = 0.95$.\n$$\\text{CI}_{95\\%} = \\{ p \\mid \\Delta(p) \\le \\chi^2_{1, 0.95} \\}$$\nNumerically, for each profile (e.g., for $a$), we find all values on the grid, $a_{\\text{grid}}$, that satisfy $\\Delta_a(a) \\le \\chi^2_{1, 0.95} \\approx 3.841$. The confidence interval width is the difference between the maximum and minimum values in this set.\n\nThe implementation will proceed as follows for each test case:\n1.  Generate synthetic pressure data $P_i^{\\text{obs}}$ by adding Gaussian noise to the true model output, using the specified random seed for reproducibility.\n2.  Perform a $2\\mathrm{D}$ optimization using `scipy.optimize.minimize` to find the MLEs $(\\hat{a}, \\hat{b})$ and the minimum SSE, $\\mathrm{SSE}_{\\text{min}}$. Positivity constraints will be enforced using bounds.\n3.  For each parameter ($a$ and $b$), iterate over its predefined grid. At each grid point, perform a $1\\mathrm{D}$ optimization of the nuisance parameter to find the profiled SSE.\n4.  Calculate the likelihood ratio statistic vectors, $\\Delta_a$ and $\\Delta_b$.\n5.  Determine the set of parameter values within the $95\\%$ confidence interval by comparing the statistic to the $\\chi^2$ critical value.\n6.  Compute and store the width of this interval. The problem specifies that if the interval covers the entire grid or is empty, the full grid width should be reported, signaling practical non-identifiability.\n7.  Finally, all computed widths are collected and formatted into a single output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Solves the biomechanics profile likelihood problem for three test cases.\n    \"\"\"\n\n    # Test case definitions\n    test_cases = [\n        # Case 1: Well-informed, lower noise\n        {\n            \"D0\": 10.0, \"h\": 1.0, \"a_true\": 120.0, \"b_true\": 6.0,\n            \"D_range\": (8.0, 12.0), \"n\": 30, \"sigma\": 2.0, \"seed\": 123\n        },\n        # Case 2: Narrow diameter range, higher noise\n        {\n            \"D0\": 10.0, \"h\": 1.0, \"a_true\": 120.0, \"b_true\": 6.0,\n            \"D_range\": (9.8, 10.5), \"n\": 20, \"sigma\": 8.0, \"seed\": 456\n        },\n        # Case 3: Near-linear response, moderate noise\n        {\n            \"D0\": 10.0, \"h\": 1.0, \"a_true\": 120.0, \"b_true\": 1.0,\n            \"D_range\": (8.5, 11.5), \"n\": 30, \"sigma\": 3.0, \"seed\": 789\n        }\n    ]\n\n    # Profile grid definitions\n    a_grid = np.linspace(20.0, 300.0, 201)\n    b_grid = np.linspace(0.5, 12.0, 201)\n    \n    # Chi-square critical value for 95% CI, 1 degree of freedom\n    chi2_crit = chi2.ppf(0.95, df=1)\n\n    # Positivity constraints for optimization\n    bounds = [(1e-9, None), (1e-9, None)]\n\n    # Main function for the pressure model\n    def pressure_model(D, a, b, D0, h):\n        term_in_exp = (b / 2.0) * ((D / D0)**2 - 1.0)\n        return (2.0 * h * a / D) * np.exp(term_in_exp)\n\n    results = []\n    for case in test_cases:\n        # 1. Generate synthetic data\n        rng = np.random.default_rng(case[\"seed\"])\n        D_obs = np.linspace(case[\"D_range\"][0], case[\"D_range\"][1], case[\"n\"])\n        P_true = pressure_model(D_obs, case[\"a_true\"], case[\"b_true\"], case[\"D0\"], case[\"h\"])\n        P_obs = P_true + rng.normal(0, case[\"sigma\"], size=case[\"n\"])\n\n        # 2. Find MLEs and minimum SSE\n        def sse_global(params):\n            a, b = params\n            P_model = pressure_model(D_obs, a, b, case[\"D0\"], case[\"h\"])\n            return np.sum((P_obs - P_model)**2)\n\n        # A reasonable initial guess\n        initial_guess = [100.0, 5.0]\n        mle_result = minimize(sse_global, initial_guess, bounds=bounds, method='L-BFGS-B')\n        a_hat, b_hat = mle_result.x\n        sse_min = mle_result.fun\n\n        # 3. Calculate Profile Likelihood for parameter 'a'\n        sse_profile_a = np.zeros_like(a_grid)\n        for i, a_val in enumerate(a_grid):\n            def sse_profile_a_obj(b_param):\n                # Ensure b_param is a scalar\n                b = b_param[0]\n                P_model = pressure_model(D_obs, a_val, b, case[\"D0\"], case[\"h\"])\n                return np.sum((P_obs - P_model)**2)\n\n            res_prof_a = minimize(sse_profile_a_obj, [b_hat], bounds=[bounds[1]], method='L-BFGS-B')\n            sse_profile_a[i] = res_prof_a.fun\n        \n        delta_a = case[\"n\"] * np.log(sse_profile_a / sse_min)\n\n        # 4. Calculate Profile Likelihood for parameter 'b'\n        sse_profile_b = np.zeros_like(b_grid)\n        for i, b_val in enumerate(b_grid):\n            def sse_profile_b_obj(a_param):\n                # Ensure a_param is a scalar\n                a = a_param[0]\n                P_model = pressure_model(D_obs, a, b_val, case[\"D0\"], case[\"h\"])\n                return np.sum((P_obs - P_model)**2)\n\n            res_prof_b = minimize(sse_profile_b_obj, [a_hat], bounds=[bounds[0]], method='L-BFGS-B')\n            sse_profile_b[i] = res_prof_b.fun\n\n        delta_b = case[\"n\"] * np.log(sse_profile_b / sse_min)\n\n        # 5. Compute Confidence Interval Widths\n        # For 'a'\n        valid_points_a = a_grid[delta_a <= chi2_crit]\n        if valid_points_a.size == 0 or valid_points_a.size == a_grid.size:\n            width_a = a_grid[-1] - a_grid[0]\n        else:\n            width_a = valid_points_a.max() - valid_points_a.min()\n        \n        # For 'b'\n        valid_points_b = b_grid[delta_b <= chi2_crit]\n        if valid_points_b.size == 0 or valid_points_b.size == b_grid.size:\n            width_b = b_grid[-1] - b_grid[0]\n        else:\n            width_b = valid_points_b.max() - valid_points_b.min()\n            \n        results.append(f\"{width_a:.6f}\")\n        results.append(f\"{width_b:.6f}\")\n\n    # Final print statement\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}