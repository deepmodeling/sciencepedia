{
    "hands_on_practices": [
        {
            "introduction": "无网格方法的核心思想是直接从一组节点（或称为粒子）构建近似函数，而无需预先定义的网格。再生核粒子法（RKPM）利用加权最小二乘法来构造形函数，使其能够精确地再生特定阶数的多项式场。这一被称为“一致性”的特性，对于保证方法的准确性至关重要。\n\n这项编程实践将指导您从零开始实现一个简单的一维RKPM近似。通过数值验证您所实现的程序能够完美再生线性位移场，您将对一阶一致性的理论原理及其在确保无网格模拟可靠性方面的重要性有具体而深入的理解 。",
            "id": "4190935",
            "problem": "考虑一个软组织纤维的一维杆模型，该模型在域 $x \\in [0, L]$（其中 $L = 1$）上进行了理想化，并承受小应变单轴拉伸。在小应变线性弹性理论中，一个具有恒定轴向模量并承受均匀轴向牵引力的棱柱杆的平衡状态，其精确位移场是空间线性的。在诸如再生核质点法（RKPM）等先进的无网格方法中，如果近似强制执行一阶一致性，则应能精确地再生线性场。您的任务是从基本原理出发，实现一维的一阶一致性 RKPM 近似，然后通过计算域上的位移误差范数来数值验证线性场是否被再生。\n\n从以下基础和事实出发：\n- 对于一维杆，小应变运动学和线性动量平衡意味着，在均匀轴向载荷和适当的边界条件下，精确位移场是关于 $x$ 的线性函数。\n- 在再生核质点法（RKPM）中，构造形函数以满足所选多项式基的再生条件。对于一维的一阶一致性，多项式基为 $p(x) = [1, x]^T$。为实现此目的，可以对邻近节点构建一个加权最小二乘拟合，使用一个正权重（核函数）$w(r; h)$，其中 $r$ 是距离，$h$ 是一个支撑参数。\n- 高斯核函数对所有 $r$ 均为正，其定义为 $w(r; h) = \\exp\\!\\left(-\\left(\\frac{r}{h}\\right)^2\\right)$。\n\n使用多项式基 $p(x) = [1, x]^T$ 和高斯核函数 $w(r; h) = \\exp\\!\\left(-\\left(\\frac{r}{h}\\right)^2\\right)$，推导在任意评估坐标 $x \\in [0, L]$ 处获得一阶一致性 RKPM 形函数所需的离散方程。利用这些形函数，根据在一组选定节点 $\\{x_i\\}_{i=1}^N$ 上的节点样本 $u_i = u(x_i)$，构造一个给定的精确位移场 $u(x) = a x + b$ 的 RKPM 近似 $u_h(x)$。\n\n实现以下数值实验：\n- 域和单位：使用 $L = 1$，不为 $x$ 或 $u(x)$ 指定物理单位；计算一个无量纲的误差范数。任何三角函数都必须使用弧度制角度。\n- 节点：对于每个测试用例，构造一组 $N$ 个节点 $\\{x_i\\}_{i=1}^N \\subset [0, L]$。对于均匀网格，在 $[0, L]$ 上均匀分布 $x_i$。对于抖动网格，从均匀网格开始，并如下文所述添加一个平滑的确定性扰动；确保 $x_1 = 0$ 和 $x_N = L$，并保持节点升序排列。\n- 核函数：在所有测试用例中均使用高斯核函数 $w(r; h) = \\exp\\!\\left(-\\left(\\frac{r}{h}\\right)^2\\right)$，支撑参数为 $h = \\alpha \\Delta x$，其中 $\\Delta x$ 是平均节点间距，$\\alpha$ 由每个测试用例指定。\n- 场：为每个测试用例指定一个线性的精确位移场 $u(x) = a x + b$。\n- 近似：在任何评估点 $x$ 处，使用一阶再生条件构建一阶一致性 RKPM 近似 $u_h(x)$。在一组 $M = 1001$ 个均匀分布在 $[0, L]$ 上的采样点上评估该近似。\n- 误差范数：通过复合中点或梯形法则计算在 $[0, L]$ 上的位移误差的离散 $L^2$ 范数。具体来说，对于均匀样本，您可以近似为\n$$\n\\|e\\|_{L^2} \\approx \\left(\\sum_{j=1}^{M} \\left(u_h(x_j) - u(x_j)\\right)^2 \\, \\Delta x_s \\right)^{1/2},\n$$\n其中 $\\Delta x_s = \\frac{L}{M-1}$，$\\{x_j\\}_{j=1}^{M}$ 是均匀采样点。将此范数报告为一个无量纲的浮点数。\n\n测试套件（四个用例）：\n- 用例 1（理想路径，均匀网格，中等支撑）：$N = 41$，$\\alpha = 2.5$，$(a, b) = (1.5, -0.3)$，节点在 $[0, L]$ 上均匀分布。\n- 用例 2（通过确定性抖动产生非均匀网格，中等支撑）：$N = 41$，$\\alpha = 2.0$，$(a, b) = (-2.2, 0.4)$，通过 $x_i \\leftarrow x_i + \\gamma \\Delta x \\sin\\!\\left(2 \\pi \\frac{i-1}{N-1}\\right)$（其中 $\\gamma = 0.2$）抖动均匀网格，然后裁剪到 $[0, L]$ 范围内，设置 $x_1 = 0$，$x_N = L$，并升序排序。\n- 用例 3（近乎最小的支撑，均匀网格）：$N = 41$，$\\alpha = 0.8$，$(a, b) = (0.75, 0.1)$，均匀节点。\n- 用例 4（更精细的抖动网格，小支撑）：$N = 81$，$\\alpha = 1.2$，$(a, b) = (1.0, 0.0)$，抖动方式与用例 2 相同，$\\gamma = 0.2$。\n\n要求的程序输出：\n- 您的程序必须生成单行输出，其中包含四个用例的四个误差范数，格式为方括号内的逗号分隔列表，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_k$ 是按上述顺序列出的用例 $k$ 的浮点误差范数。输出必须只有一行，且不包含任何额外文本。\n\n您的实现必须是一个完整、可运行的程序，该程序能够构造节点，使用高斯核函数计算一阶一致性 RKPM 形函数，根据给定的线性场的节点值形成 $u_h(x)$，按规定评估离散 $L^2$ 误差范数，并以所需格式打印这四个误差范数的列表。",
            "solution": "该问题要求推导并实现用于一维杆的一阶一致性再生核质点法（RKPM）近似。目标是数值验证该近似能够精确再生线性位移场，这一特性被称为一阶一致性。验证将通过计算 RKPM 近似与已知线性场在几个测试用例中的离散 $L^2$ 误差范数来进行。\n\n构造满足特定一致性（或再生）条件的 RKPM 形函数的理论基础是移动最小二乘法（MLS）。我们首先推导一维场 $u(x)$ 的 MLS 近似。\n\n在任意评估点 $x \\in [0, L]$，我们寻求一个局部多项式近似，记为 $u_h(y; x)$，用于逼近真实场 $u(y)$ 在 $x$ 附近的点 $y$ 处的值。为实现一阶一致性，该近似由一个线性基构造。问题中指定的全局坐标系下的基为 $p(y) = [1, y]^T$。因此，局部近似可写为：\n$$\nu_h(y; x) = p^T(y) \\mathbf{a}(x) = a_1(x) + y a_2(x)\n$$\n其中 $\\mathbf{a}(x) = [a_1(x), a_2(x)]^T$ 是一个依赖于评估点 $x$ 的系数向量。这些系数通过对已知节点数据 $\\{ (x_i, u_i) \\}_{i=1}^N$ 进行加权最小二乘拟合来确定。需要最小化的泛函是：\n$$\nJ(\\mathbf{a}) = \\sum_{i=1}^{N} \\left[ u_h(x_i; x) - u_i \\right]^2 w(x - x_i; h) = \\sum_{i=1}^{N} \\left[ p^T(x_i) \\mathbf{a}(x) - u_i \\right]^2 w(x - x_i; h)\n$$\n这里，$w(r; h)$ 是一个具有特征支撑尺寸 $h$ 的正权重函数或核函数。问题指定了高斯核函数 $w(r; h) = \\exp\\left(-(r/h)^2\\right)$。权重函数以评估点 $x$ 为中心，从而使最小二乘拟合局部化。\n\n为了找到最小化 $J(\\mathbf{a})$ 的系数 $\\mathbf{a}(x)$，我们将 $J$ 对 $\\mathbf{a}$ 求导并令其为零：\n$$\n\\frac{\\partial J}{\\partial \\mathbf{a}} = \\sum_{i=1}^{N} 2 \\left[ p^T(x_i) \\mathbf{a}(x) - u_i \\right] p(x_i) w(x - x_i; h) = \\mathbf{0}\n$$\n重新整理该表达式可得到法方程，这是一个关于 $\\mathbf{a}(x)$ 的线性方程组：\n$$\n\\left[ \\sum_{i=1}^{N} p(x_i) p^T(x_i) w(x - x_i; h) \\right] \\mathbf{a}(x) = \\sum_{i=1}^{N} p(x_i) u_i w(x - x_i; h)\n$$\n该系统可以写成矩阵形式：\n$$\n\\mathbf{M}(x) \\mathbf{a}(x) = \\mathbf{V}(x)\n$$\n其中 $\\mathbf{M}(x)$ 是 $2 \\times 2$ 的矩量矩阵：\n$$\n\\mathbf{M}(x) = \\sum_{i=1}^{N} p(x_i) p^T(x_i) w(x-x_i; h) = \\sum_{i=1}^{N} \\begin{pmatrix} 1  x_i \\\\ x_i  x_i^2 \\end{pmatrix} w(x-x_i; h)\n$$\n并且 $\\mathbf{V}(x)$ 是一个 $2 \\times 1$ 的向量：\n$$\n\\mathbf{V}(x) = \\sum_{i=1}^{N} p(x_i) u_i w(x-x_i; h) = \\sum_{i=1}^{N} \\begin{pmatrix} 1 \\\\ x_i \\end{pmatrix} u_i w(x-x_i; h)\n$$\n假设矩量矩阵 $\\mathbf{M}(x)$ 可逆，则系数向量为 $\\mathbf{a}(x) = \\mathbf{M}(x)^{-1} \\mathbf{V}(x)$。\n\n场*在*点 $x$ 处的 RKPM 近似是通过在 $y=x$ 处评估局部近似 $u_h(y; x)$ 得到的：\n$$\nu_h(x) = u_h(x; x) = p^T(x) \\mathbf{a}(x) = p^T(x) \\mathbf{M}(x)^{-1} \\mathbf{V}(x)\n$$\n代入 $\\mathbf{V}(x)$ 的表达式：\n$$\nu_h(x) = p^T(x) \\mathbf{M}(x)^{-1} \\left[ \\sum_{i=1}^{N} p(x_i) u_i w(x-x_i; h) \\right]\n$$\n这可以表示为离散近似的标准形式 $u_h(x) = \\sum_{i=1}^N \\Psi_i(x) u_i$，其中 $\\Psi_i(x)$ 是 RKPM 形函数。通过观察，节点 $i$ 在点 $x$ 处评估的形函数为：\n$$\n\\Psi_i(x) = p^T(x) \\mathbf{M}(x)^{-1} p(x_i) w(x-x_i; h)\n$$\n我们现在用代数方法验证这种构造能精确再生任何线性场。设节点值从线性场 $u(x) = ax + b$ 中采样，因此 $u_i = u(x_i) = a x_i + b$。我们可以用基 $p(x_i)$ 来表示它：\n$$\nu_i = \\begin{pmatrix} b  a \\end{pmatrix} \\begin{pmatrix} 1 \\\\ x_i \\end{pmatrix} = \\mathbf{c}^T p(x_i), \\quad \\text{with} \\quad \\mathbf{c} = \\begin{pmatrix} b \\\\ a \\end{pmatrix}\n$$\n将此代入 $u_h(x)$ 的表达式：\n$$\nu_h(x) = p^T(x) \\mathbf{M}(x)^{-1} \\left[ \\sum_{i=1}^{N} p(x_i) (\\mathbf{c}^T p(x_i)) w(x-x_i; h) \\right]\n$$\n由于 $\\mathbf{c}^T p(x_i)$ 是一个标量，我们可以写成 $p(x_i) (\\mathbf{c}^T p(x_i)) = p(x_i) p^T(x_i) \\mathbf{c}$。这使我们能够将常数向量 $\\mathbf{c}$ 提取出来：\n$$\nu_h(x) = p^T(x) \\mathbf{M}(x)^{-1} \\left[ \\sum_{i=1}^{N} p(x_i) p^T(x_i) w(x-x_i; h) \\right] \\mathbf{c}\n$$\n方括号中的项正是矩量矩阵 $\\mathbf{M}(x)$ 的定义。因此：\n$$\nu_h(x) = p^T(x) \\mathbf{M}(x)^{-1} \\mathbf{M}(x) \\mathbf{c} = p^T(x) \\mathbf{I} \\mathbf{c} = p^T(x) \\mathbf{c}\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。最后，代入 $p^T(x)$ 和 $\\mathbf{c}$ 的定义：\n$$\nu_h(x) = \\begin{pmatrix} 1  x \\end{pmatrix} \\begin{pmatrix} b \\\\ a \\end{pmatrix} = 1 \\cdot b + x \\cdot a = ax + b\n$$\n这证明了对于任何线性场，$u_h(x) = u(x)$，前提是 $\\mathbf{M}(x)$ 可逆。只要至少有两个不同的节点 $\\{x_i\\}$ 具有非零权重 $w(x-x_i; h)$，$\\mathbf{M}(x)$ 的可逆性就能得到保证，对于高斯核和任何 $N \\ge 2$ 的网格，这一点都是成立的。\n\n对于数值实验，我们将实现以下步骤。\n1. 对于每个测试用例，我们在域 $[0, 1]$ 上生成一组 $N$ 个节点 $\\{x_i\\}_{i=1}^N$，节点可以是均匀分布的，也可以是带有指定的确定性抖动的。\n2. 核函数支撑参数设置为 $h = \\alpha \\Delta x$，其中 $\\Delta x = 1/(N-1)$ 是初始均匀网格的间距。\n3. 使用用例特定的参数 $(a, b)$ 计算节点值 $u_i = u(x_i) = ax_i + b$。\n4. 在 $[0,1]$ 上创建一组 $M = 1001$ 个均匀的评估点 $\\{x_j\\}_{j=1}^M$。\n5. 对于每个评估点 $x_j$，我们计算近似值 $u_h(x_j)$。这包括：\n   a. 通过对所有 $N$ 个节点的贡献求和，组装 $2 \\times 2$ 的矩量矩阵 $\\mathbf{M}(x_j)$ 和 $2 \\times 1$ 的向量 $\\mathbf{V}(x_j)$。\n   b. 求解线性系统 $\\mathbf{M}(x_j) \\mathbf{a}(x_j) = \\mathbf{V}(x_j)$ 以得到系数 $\\mathbf{a}(x_j)$。\n   c. 计算近似值 $u_h(x_j) = p^T(x_j) \\mathbf{a}(x_j)$。\n6. 在计算完所有 $u_h(x_j)$ 后，离散 $L^2$ 误差范数按如下方式计算：\n$$\n\\|e\\|_{L^2} \\approx \\left(\\sum_{j=1}^{M} \\left(u_h(x_j) - u(x_j)\\right)^2 \\Delta x_s \\right)^{1/2}\n$$\n其中 $u(x_j)$ 是在评估点处的精确值，且 $\\Delta x_s = L/(M-1) = 1/(1000)$。\n鉴于代数证明，计算出的误差范数预计在机器浮点精度数量级（对于双精度，约为 $10^{-15}$ 到 $10^{-16}$）。任何显著的偏差都将表明存在数值病态问题，例如，如果支撑参数 $h$ 过小或过大，尽管所选参数应该是表现良好的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a first-order consistent RKPM approximation in 1D\n    to verify that linear fields are reproduced exactly.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 41, 'alpha': 2.5, 'a': 1.5, 'b': -0.3, 'jitter': False},\n        {'N': 41, 'alpha': 2.0, 'a': -2.2, 'b': 0.4, 'jitter': True, 'gamma': 0.2},\n        {'N': 41, 'alpha': 0.8, 'a': 0.75, 'b': 0.1, 'jitter': False},\n        {'N': 81, 'alpha': 1.2, 'a': 1.0, 'b': 0.0, 'jitter': True, 'gamma': 0.2},\n    ]\n\n    L = 1.0\n    M = 1001  # Number of evaluation points for error norm calculation\n\n    # Uniform evaluation points for error calculation\n    eval_points = np.linspace(0.0, L, M)\n\n    results = []\n\n    for case in test_cases:\n        N = case['N']\n        alpha = case['alpha']\n        a_coeff = case['a']\n        b_coeff = case['b']\n\n        # 1. Generate nodes {x_i}\n        # The problem implies delta_x is based on the uniform grid for all cases\n        delta_x_uniform = L / (N - 1)\n        nodes = np.linspace(0.0, L, N)\n\n        if case['jitter']:\n            gamma = case['gamma']\n            # i=1,...,N corresponds to array indices 0,...,N-1\n            indices = np.arange(N)\n            perturbation = gamma * delta_x_uniform * np.sin(2 * np.pi * indices / (N - 1))\n            \n            nodes = nodes + perturbation\n            \n            # Clip, fix boundaries, and sort\n            nodes = np.clip(nodes, 0.0, L)\n            nodes[0] = 0.0\n            nodes[-1] = L\n            nodes.sort()\n\n        # 2. Define kernel, field, and get nodal values\n        h = alpha * delta_x_uniform\n\n        def kernel(r, h_val):\n            return np.exp(-(r / h_val)**2)\n\n        def u_exact(x):\n            return a_coeff * x + b_coeff\n\n        nodal_displacements = u_exact(nodes)\n\n        # 3. Evaluate RKPM approximation u_h(x) at each evaluation point\n        u_h_values = np.zeros(M)\n\n        for j, x_eval in enumerate(eval_points):\n            # Assemble moment matrix M(x) and vector V(x)\n            moment_matrix = np.zeros((2, 2))\n            rhs_vector = np.zeros(2)\n\n            for i in range(N):\n                xi = nodes[i]\n                ui = nodal_displacements[i]\n                w = kernel(x_eval - xi, h)\n                \n                p_i = np.array([1.0, xi])\n                \n                # M = sum(p_i * p_i^T * w_i)\n                moment_matrix += w * np.outer(p_i, p_i)\n                # V = sum(p_i * u_i * w_i)\n                rhs_vector += w * p_i * ui\n            \n            # Solve M(x) * a(x) = V(x) for coefficients a(x)\n            try:\n                coeffs = np.linalg.solve(moment_matrix, rhs_vector)\n            except np.linalg.LinAlgError:\n                # This should not occur with the given problem parameters\n                coeffs = np.array([np.nan, np.nan])\n\n            # Evaluate approximation u_h(x) = p^T(x) * a(x)\n            p_eval = np.array([1.0, x_eval])\n            u_h_values[j] = p_eval @ coeffs\n\n        # 4. Compute discrete L2 error norm\n        exact_values_at_eval = u_exact(eval_points)\n        errors = u_h_values - exact_values_at_eval\n\n        # Guard against NaN from failed linear solve\n        if np.any(np.isnan(errors)):\n            l2_error_norm = np.nan\n        else:\n            delta_xs = L / (M - 1)\n            l2_error_norm = np.sqrt(np.sum(errors**2) * delta_xs)\n        \n        results.append(l2_error_norm)\n\n    # Final print statement in the exact required format.\n    # The output should show values very close to zero, so scientific notation is appropriate.\n    print(f\"[{','.join([f'{norm:.16e}' for norm in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在等几何分析（IGA）中，我们通过对基函数导数的乘积进行积分来计算刚度矩阵。高斯求积法常被用来数值计算这些积分，而求积点数量的选择至关重要：过少的求积点会导致结果不准确，而过多的求积点则会浪费计算资源。所需的求积点数量取决于被积函数的最高多项式次数。\n\n本练习要求您确定在多项式B样条和有理NURBS基函数两种情况下，精确积分所需的最小求积阶数。通过分析被积函数的结构，您将掌握一项在高效、准确地实现IGA时至关重要的实用技能，并体会到有理基函数所带来的额外复杂性 。",
            "id": "4190899",
            "problem": "考虑一个用非均匀有理B样条（NURBS）进行等几何分析（IGA）建模的小应变、平面应力软组织片块。其本构行为是线性的，在单元内部具有恒定的材料刚度张量。在单个参数单元上，其坐标为 $\\xi \\in [-1,1]$ 和 $\\eta \\in [-1,1]$，几何映射被假定为仿射映射，因此雅可比行列式在整个单元上是恒定的。基函数是张量积形式，其多项式次数为 $p_{\\xi} = 3$ 和 $p_{\\eta} = 2$。单元刚度矩阵的项是参数域上的积分，其被积函数为基函数导数的乘积、恒定的材料张量和恒定的雅可比行列式。\n\n出现两种情况：\n\n- 情况P（多项式情况）：所有控制点权重相等，因此NURBS基与多项式B样条基重合，被积函数在$\\xi$和$\\eta$两个方向上都是多项式。\n- 情况R（有理函数情况）：控制点权重不均匀。NURBS基函数是有理函数。在单个参数单元内，权重函数 $W(\\xi,\\eta)$ 是一个在$\\xi$方向上次数为$p_{\\xi}$、在$\\eta$方向上次数为$p_{\\eta}$的多项式，并且NURBS基函数的导数包含有理表达式，其分母含有$W(\\xi,\\eta)$的幂。\n\n仅利用关于刚度被积函数结构的基本原理和高斯求积的精确性，确定每种情况下合适的张量积高斯-勒让德求积阶数 $(n_{\\xi}, n_{\\eta})$。对于情况P，确定能够精确积分刚度矩阵项的最小阶数。对于情况R，确定由有理被积函数分子中出现的最高多项式次数所支持的最小整数阶数（在仿射几何假设下），以使求积能够精确积分达到该次数的任何多项式分子，从而为有理分母提供稳健性。\n\n将您的最终答案以行矩阵的形式表示，顺序为 $\\left(n_{\\xi}^{\\text{poly}},\\, n_{\\eta}^{\\text{poly}},\\, n_{\\xi}^{\\text{rat}},\\, n_{\\eta}^{\\text{rat}}\\right)$。无需四舍五入。",
            "solution": "该问题已经过验证，被认为是科学上合理的、适定的和客观的。这是等几何分析领域的一个标准问题。所有提供的信息都是自洽且一致的。\n\n对于一个二维弹性问题，单元刚度矩阵的项 $k_{ab}$ 由单元参数域 $(\\xi, \\eta)$ 上的积分给出：\n$$\nk_{ab} = \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\boldsymbol{B}_a \\right)^T \\boldsymbol{C} \\boldsymbol{B}_b \\det(\\boldsymbol{J}) \\, d\\xi d\\eta\n$$\n在这里，$\\boldsymbol{B}_a$ 是对应于基函数 $a$ 的应变-位移矩阵，$\\boldsymbol{C}$ 是平面应力的本构张量，$\\boldsymbol{J}$ 是几何映射的雅可比矩阵。问题陈述，材料是线弹性，具有恒定的刚度张量 $\\boldsymbol{C}$，且几何映射是仿射的，这意味着雅可比矩阵 $\\boldsymbol{J}$ 及其行列式 $\\det(\\boldsymbol{J})$ 在整个单元上是恒定的。因此，被积函数的多项式次数完全由构成 $\\boldsymbol{B}_a$ 和 $\\boldsymbol{B}_b$ 项的基函数导数乘积决定。\n\n应变-位移矩阵 $\\boldsymbol{B}_a$ 将应变与控制点位移联系起来，并包含基函数 $N_a$ 相对于物理坐标 $(x, y)$ 的导数。这些导数使用链式法则计算：\n$$\n\\begin{pmatrix} \\frac{\\partial N_a}{\\partial x} \\\\ \\frac{\\partial N_a}{\\partial y} \\end{pmatrix} = \\boldsymbol{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_a}{\\partial \\xi} \\\\ \\frac{\\partial N_a}{\\partial \\eta} \\end{pmatrix}\n$$\n由于 $\\boldsymbol{J}^{-1}$ 是一个常数矩阵，被积函数是形如 $(\\frac{\\partial N_a}{\\partial \\xi}\\frac{\\partial N_b}{\\partial \\xi})$、$(\\frac{\\partial N_a}{\\partial \\eta}\\frac{\\partial N_b}{\\partial \\eta})$ 和 $(\\frac{\\partial N_a}{\\partial \\xi}\\frac{\\partial N_b}{\\partial \\eta})$ 的乘积的线性组合。任务是找出这些乘积在每个参数方向上的最大多项式次数。\n\n一个在 $\\xi$ 方向上有 $n_\\xi$ 个点、在 $\\eta$ 方向上有 $n_\\eta$ 个点的张量积高斯求积法则，将精确积分一个在 $\\xi$ 方向上次数最高为 $2n_\\xi-1$、在 $\\eta$ 方向上次数最高为 $2n_\\eta-1$ 的多项式。为了精确积分一个特定次数 $d$ 的多项式，所需的最小求积点数 $n$ 必须满足 $2n-1 \\ge d$，这意味着 $n \\ge \\frac{d+1}{2}$。最小整数值为 $n = \\lceil \\frac{d+1}{2} \\rceil$。\n\n设基函数的多项式次数为 $p_\\xi = 3$ 和 $p_\\eta = 2$。\n\n**情况P：多项式B样条**\n\n在这种情况下，NURBS基函数简化为多项式B样条基函数，我们将其表示为 $N_a(\\xi, \\eta)$。对于张量积基，每个基函数都是一维B样条的乘积：$N_a(\\xi, \\eta) = \\hat{N}_{i, p_\\xi}(\\xi) \\hat{N}_{j, p_\\eta}(\\eta)$，其中 $\\hat{N}_{i, p_\\xi}(\\xi)$ 是一个在 $\\xi$ 方向上次数为 $p_\\xi = 3$ 的多项式，而 $\\hat{N}_{j, p_\\eta}(\\eta)$ 是一个在 $\\eta$ 方向上次数为 $p_\\eta = 2$ 的多项式。\n\n其导数为：\n- $\\frac{\\partial N_a}{\\partial \\xi} = \\frac{d \\hat{N}_{i, p_\\xi}}{d\\xi} \\hat{N}_{j, p_\\eta}(\\eta)$。其在 $\\xi$ 方向上的多项式次数为 $(p_\\xi - 1)$，在 $\\eta$ 方向上为 $p_\\eta$。\n- $\\frac{\\partial N_a}{\\partial \\eta} = \\hat{N}_{i, p_\\xi}(\\xi) \\frac{d \\hat{N}_{j, p_\\eta}}{d\\eta}$。其在 $\\xi$ 方向上的多项式次数为 $p_\\xi$，在 $\\eta$ 方向上为 $(p_\\eta-1)$。\n\n我们分析被积函数中各项乘积的多项式次数：\n1.  乘积 $\\frac{\\partial N_a}{\\partial \\xi} \\frac{\\partial N_b}{\\partial \\xi}$：\n    - 在 $\\xi$ 方向的次数：$(p_\\xi - 1) + (p_\\xi - 1) = 2p_\\xi - 2 = 2(3) - 2 = 4$。\n    - 在 $\\eta$ 方向的次数：$p_\\eta + p_\\eta = 2p_\\eta = 2(2) = 4$。\n2.  乘积 $\\frac{\\partial N_a}{\\partial \\eta} \\frac{\\partial N_b}{\\partial \\eta}$：\n    - 在 $\\xi$ 方向的次数：$p_\\xi + p_\\xi = 2p_\\xi = 2(3) = 6$。\n    - 在 $\\eta$ 方向的次数：$(p_\\eta - 1) + (p_\\eta - 1) = 2p_\\eta - 2 = 2(2) - 2 = 2$。\n3.  乘积 $\\frac{\\partial N_a}{\\partial \\xi} \\frac{\\partial N_b}{\\partial \\eta}$：\n    - 在 $\\xi$ 方向的次数：$(p_\\xi - 1) + p_\\xi = 2p_\\xi - 1 = 2(3) - 1 = 5$。\n    - 在 $\\eta$ 方向的次数：$p_\\eta + (p_\\eta - 1) = 2p_\\eta - 1 = 2(2) - 1 = 3$。\n\n被积函数在每个方向上的最高多项式次数是：\n- $d_\\xi^{\\text{poly}} = \\max(4, 6, 5) = 6 = 2p_\\xi$。\n- $d_\\eta^{\\text{poly}} = \\max(4, 2, 3) = 4 = 2p_\\eta$。\n\n为实现精确积分所需的最小求积点数：\n- $n_\\xi^{\\text{poly}} = \\lceil \\frac{d_\\xi^{\\text{poly}}+1}{2} \\rceil = \\lceil \\frac{2p_\\xi+1}{2} \\rceil = \\lceil p_\\xi + 0.5 \\rceil = p_\\xi + 1 = 3 + 1 = 4$。\n- $n_\\eta^{\\text{poly}} = \\lceil \\frac{d_\\eta^{\\text{poly}}+1}{2} \\rceil = \\lceil \\frac{2p_\\eta+1}{2} \\rceil = \\lceil p_\\eta + 0.5 \\rceil = p_\\eta + 1 = 2 + 1 = 3$。\n\n**情况R：有理NURBS**\n\nNURBS基函数 $R_a$ 是一个有理函数：\n$$\nR_a(\\xi, \\eta) = \\frac{N_a(\\xi, \\eta) w_a}{W(\\xi, \\eta)}\n$$\n其中 $N_a$ 是B样条基，$w_a$ 是常数权重，$W(\\xi, \\eta) = \\sum_i N_i(\\xi, \\eta) w_i$ 是权重函数。由于 $W$ 是B样条基函数的线性组合，其在一个单元内的多项式次数在 $\\xi$ 方向上为 $p_\\xi$，在 $\\eta$ 方向上为 $p_\\eta$。$R_a$ 相对于 $\\xi$ 的导数使用商法则求得：\n$$\n\\frac{\\partial R_a}{\\partial \\xi} = \\frac{\\frac{\\partial (N_a w_a)}{\\partial \\xi} W - (N_a w_a) \\frac{\\partial W}{\\partial \\xi}}{W^2}\n$$\n该表达式的分子是一个多项式。其次数由最高次项决定。\n- $\\frac{\\partial(N_a w_a)}{\\partial \\xi} W$ 的次数在 $\\xi$ 方向上是 $(p_\\xi-1)+p_\\xi=2p_\\xi-1$，在 $\\eta$ 方向上是 $p_\\eta+p_\\eta=2p_\\eta$。\n- $(N_a w_a)\\frac{\\partial W}{\\partial \\xi}$ 的次数在 $\\xi$ 方向上是 $p_\\xi+(p_\\xi-1)=2p_\\xi-1$，在 $\\eta$ 方向上是 $p_\\eta+p_\\eta=2p_\\eta$。\n所以 $\\frac{\\partial R_a}{\\partial \\xi}$ 的分子（我们称之为 $P_a^\\xi$）在 $\\xi$ 方向上的次数为 $2p_\\xi-1$，在 $\\eta$ 方向上的次数为 $2p_\\eta$。\n\n类似地，$\\frac{\\partial R_a}{\\partial \\eta}$ 的分子（我们称之为 $P_a^\\eta$）在 $\\xi$ 方向上的次数为 $2p_\\xi$，在 $\\eta$ 方向上的次数为 $2p_\\eta-1$。\n\n刚度被积函数包含这些有理导数的乘积，例如 $\\frac{\\partial R_a}{\\partial \\xi}\\frac{\\partial R_b}{\\partial \\xi} = \\frac{P_a^\\xi P_b^\\xi}{W^4}$。问题要求找到能够精确积分有理被积函数分子的求积阶数。我们找出被积函数分子的最大多项式次数。\n1.  $\\frac{\\partial R_a}{\\partial \\xi}\\frac{\\partial R_b}{\\partial \\xi}$ 的分子是 $P_a^\\xi P_b^\\xi$：\n    - 在 $\\xi$ 方向的次数：$(2p_\\xi-1) + (2p_\\xi-1) = 4p_\\xi - 2 = 4(3) - 2 = 10$。\n    - 在 $\\eta$ 方向的次数：$2p_\\eta + 2p_\\eta = 4p_\\eta = 4(2) = 8$。\n2.  $\\frac{\\partial R_a}{\\partial \\eta}\\frac{\\partial R_b}{\\partial \\eta}$ 的分子是 $P_a^\\eta P_b^\\eta$：\n    - 在 $\\xi$ 方向的次数：$2p_\\xi + 2p_\\xi = 4p_\\xi = 4(3) = 12$。\n    - 在 $\\eta$ 方向的次数：$(2p_\\eta-1) + (2p_\\eta-1) = 4p_\\eta - 2 = 4(2) - 2 = 6$。\n3.  $\\frac{\\partial R_a}{\\partial \\xi}\\frac{\\partial R_b}{\\partial \\eta}$ 的分子是 $P_a^\\xi P_b^\\eta$：\n    - 在 $\\xi$ 方向的次数：$(2p_\\xi-1) + 2p_\\xi = 4p_\\xi - 1 = 4(3) - 1 = 11$。\n    - 在 $\\eta$ 方向的次数：$2p_\\eta + (2p_\\eta-1) = 4p_\\eta - 1 = 4(2) - 1 = 7$。\n\n被积函数分子在每个方向上的最高多项式次数是：\n- $d_\\xi^{\\text{num}} = \\max(10, 12, 11) = 12 = 4p_\\xi$。\n- $d_\\eta^{\\text{num}} = \\max(8, 6, 7) = 8 = 4p_\\eta$。\n\n为精确积分这些分子所需的求积点数：\n- $n_\\xi^{\\text{rat}} = \\lceil \\frac{d_\\xi^{\\text{num}}+1}{2} \\rceil = \\lceil \\frac{4p_\\xi+1}{2} \\rceil = \\lceil 2p_\\xi + 0.5 \\rceil = 2p_\\xi + 1 = 2(3) + 1 = 7$。\n- $n_\\eta^{\\text{rat}} = \\lceil \\frac{d_\\eta^{\\text{num}}+1}{2} \\rceil = \\lceil \\frac{4p_\\eta+1}{2} \\rceil = \\lceil 2p_\\eta + 0.5 \\rceil = 2p_\\eta + 1 = 2(2) + 1 = 5$。\n\n结果如下：\n- $n_\\xi^{\\text{poly}} = 4$\n- $n_\\eta^{\\text{poly}} = 3$\n- $n_\\xi^{\\text{rat}} = 7$\n- $n_\\eta^{\\text{rat}} = 5$\n\n最终答案要求以行矩阵的形式表示 $\\left(n_{\\xi}^{\\text{poly}},\\, n_{\\eta}^{\\text{poly}},\\, n_{\\xi}^{\\text{rat}},\\, n_{\\eta}^{\\text{rat}}\\right)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  3  7  5\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "等几何分析（IGA）的一个关键优势在于其对几何和边界条件的优雅处理。在B样条或NURBS基函数中使用开放节点矢量，可以在参数域的边界处产生插值特性。这意味着第一个和最后一个控制变量直接对应于场在边界上的值。\n\n在本次实践中，您将利用这一特性来求解一个一维杆件问题。您将亲身体验到，本质边界条件可以简单地通过设置相应控制变量的值来施加，这与传统的有限元方法相比，极大地简化了代码实现。这个练习将NURBS基函数的理论特性与解决生物力学问题时的实际优势紧密联系起来 。",
            "id": "4190908",
            "problem": "一段笔直的、可轴向变形的软组织肌腱段被建模为一个一维杆，占据物理域 $x \\in [0,L]$，其横截面积 $A$ 和杨氏模量 $E$ 为常数。该肌腱沿 $+x$ 方向承受一个均布轴向载荷 $q$（单位长度上的力）。运动学假设为小应变，轴向应变定义为 $\\varepsilon(x) = \\frac{du}{dx}$，其中 $u(x)$ 是轴向位移场。本构关系为线性弹性，$\\sigma(x) = E\\,\\varepsilon(x)$，其弱形式源于虚功原理。\n\n您将使用等几何分析 (Isogeometric Analysis, IGA) 来离散化此问题，采用二次开放非均匀有理B样条 (Non-Uniform Rational B-Splines, NURBS) 基，并特化为非有理B样条。设参数域为 $\\xi \\in [0,1]$，节点矢量为开放式 $\\mathcal{U} = [0,0,0,1,1,1]$，三个几何控制点位于 $X_1 = 0$、$X_2 = \\frac{L}{2}$ 和 $X_3 = L$。位移场 $u(x)$ 使用与几何映射相同的二次开放B样条基。假设在 $x=L$ 处无边界力。\n\n任务：\n- 从承受分布轴向载荷和小应变的一维线性弹性杆的弱形式出发，构建在 $\\mathcal{U}$ 上的二次开放B样条基，证明开放节点矢量在边界处恢复了插值控制，并解释为何本质边界条件可以直接施加在端点控制变量上。然后，通过直接设置相应的位移控制变量来施加本质边界条件 $u(0) = 0$ 和 $u(L) = 0$。\n- 在施加这些边界条件后，通过组合来自内虚功的刚度贡献和来自外虚功的载荷贡献，推导剩余位移控制变量的单一标量方程，同时考虑由几何控制点引起的等参映射。\n- 使用以下物理参数：$L = 0.1\\,\\text{m}$、$A = 1.0 \\times 10^{-4}\\,\\text{m}^2$、$E = 1.5 \\times 10^{6}\\,\\text{Pa}$ 和 $q = 10\\,\\text{N}\\,\\text{m}^{-1}$，计算剩余位移控制变量的值。\n\n以米为单位表示剩余位移控制变量的最终答案，并将答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "基本模型是可轴向变形杆在小应变和线性本构行为下的一维线性弹性模型。轴向应变为 $\\varepsilon(x) = \\frac{du}{dx}$，应力为 $\\sigma(x) = E\\,\\varepsilon(x)$，内虚功为 $\\delta W_{\\text{int}} = \\int_{0}^{L} E A \\frac{du}{dx} \\frac{d \\delta u}{dx}\\, dx$。由均布轴向载荷 $q$ 引起的外虚功为 $\\delta W_{\\text{ext}} = \\int_{0}^{L} q\\, \\delta u\\, dx$，我们假设在 $x=L$ 处端点边界力为零。弱形式为：在满足本质边界条件的适当空间中找到 $u$，使得\n$$\n\\int_{0}^{L} E A \\frac{du}{dx} \\frac{d \\delta u}{dx}\\, dx = \\int_{0}^{L} q\\, \\delta u\\, dx \\quad \\text{对所有容许的 } \\delta u.\n$$\n\n在等几何分析 (Isogeometric Analysis, IGA) 中，用于几何的基函数同样用于位移场。我们在参数域 $\\xi \\in [0,1]$ 上采用一个二次开放B样条基，其开放节点矢量为 $\\mathcal{U} = [0,0,0,1,1,1]$。这产生了 $p+1=3$ 个基函数，对于这个单一单元，它们与二次 Bernstein 多项式重合：\n$$\nN_1(\\xi) = (1 - \\xi)^{2}, \\quad N_2(\\xi) = 2 \\xi (1 - \\xi), \\quad N_3(\\xi) = \\xi^{2}.\n$$\n开放节点矢量确保了端点基函数在边界处是插值的：\n$$\nN_1(0) = 1, \\quad N_2(0) = 0, \\quad N_3(0) = 0; \\qquad N_1(1) = 0, \\quad N_2(1) = 0, \\quad N_3(1) = 1.\n$$\n因此，当几何映射将物理端点置于 $\\xi=0$ 和 $\\xi=1$ 时，与第一个和最后一个基函数相对应的位移控制变量直接等于物理端点处的位移。\n\n我们使用相同的基函数和控制点 $X_i$ 来构建几何映射 $x(\\xi)$：\n$$\nx(\\xi) = N_1(\\xi) X_1 + N_2(\\xi) X_2 + N_3(\\xi) X_3.\n$$\n当 $X_1 = 0$, $X_2 = \\frac{L}{2}$ 和 $X_3 = L$ 时，我们得到\n$$\nx(\\xi) = (1 - \\xi)^{2} \\cdot 0 + 2 \\xi (1 - \\xi) \\cdot \\frac{L}{2} + \\xi^{2} \\cdot L = L \\left[\\xi (1 - \\xi) + \\xi^{2} \\right] = L \\xi,\n$$\n这是一个线性等参映射，因此 $\\frac{d\\xi}{dx} = \\frac{1}{L}$ 且 $dx = L\\, d\\xi$。\n\n我们将位移场近似为\n$$\nu(x(\\xi)) = \\sum_{i=1}^{3} N_i(\\xi) d_i,\n$$\n其中 $d_i$ 是位移控制变量。由于边界上的插值特性，以及几何映射将 $x=0$ 置于 $\\xi=0$、将 $x=L$ 置于 $\\xi=1$，本质边界条件 $u(0) = 0$ 和 $u(L) = 0$ 直接施加为\n$$\nd_1 = 0, \\qquad d_3 = 0.\n$$\n因此，只有 $d_2$ 是未知的。\n\n我们从弱形式推导 $d_2$ 的离散方程。内虚功贡献产生了刚度项\n$$\nK_{22} = \\int_{0}^{L} E A \\left( \\frac{dN_2}{dx} \\right) \\left( \\frac{dN_2}{dx} \\right) dx.\n$$\n使用等参映射，$\\frac{dN_2}{dx} = \\frac{dN_2}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{L} \\frac{dN_2}{d\\xi}$，且 $dx = L\\, d\\xi$，我们得到\n$$\nK_{22} = \\int_{0}^{1} E A \\left( \\frac{1}{L} \\frac{dN_2}{d\\xi} \\right)^{2} L\\, d\\xi = \\frac{E A}{L} \\int_{0}^{1} \\left( \\frac{dN_2}{d\\xi} \\right)^{2} d\\xi.\n$$\n对于 $N_2(\\xi) = 2 \\xi (1 - \\xi)$，我们计算\n$$\n\\frac{dN_2}{d\\xi} = 2(1 - 2\\xi),\n$$\n所以\n$$\nK_{22} = \\frac{E A}{L} \\int_{0}^{1} 4 (1 - 2\\xi)^{2} d\\xi = \\frac{E A}{L} \\cdot 4 \\int_{0}^{1} \\left( 1 - 4\\xi + 4\\xi^{2} \\right) d\\xi = \\frac{E A}{L} \\cdot 4 \\left( 1 - 2 + \\frac{4}{3} \\right) = \\frac{4 E A}{3 L}.\n$$\n\n外虚功贡献给出了载荷向量项\n$$\nF_{2} = \\int_{0}^{L} q\\, N_2\\, dx = \\int_{0}^{1} q\\, N_2(\\xi)\\, L\\, d\\xi = q L \\int_{0}^{1} 2 \\xi (1 - \\xi)\\, d\\xi.\n$$\n我们计算\n$$\n\\int_{0}^{1} 2 \\xi (1 - \\xi)\\, d\\xi = \\int_{0}^{1} \\left( 2\\xi - 2\\xi^{2} \\right) d\\xi = \\left[ \\xi^{2} - \\frac{2}{3}\\xi^{3} \\right]_{0}^{1} = 1 - \\frac{2}{3} = \\frac{1}{3},\n$$\n因此\n$$\nF_{2} = \\frac{q L}{3}.\n$$\n\n在施加 $d_1 = 0$ 和 $d_3 = 0$ 后，针对单一未知量的简化离散方程变为\n$$\nK_{22}\\, d_2 = F_2,\n$$\n所以\n$$\nd_2 = \\frac{F_2}{K_{22}} = \\frac{\\frac{q L}{3}}{\\frac{4 E A}{3 L}} = \\frac{q L^{2}}{4 E A}.\n$$\n\n我们现在代入给定的物理参数，在最后一步之前保持符号推导。当 $L = 0.1\\,\\text{m}$、$A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$、$E = 1.5 \\times 10^{6}\\,\\text{Pa}$ 和 $q = 10\\,\\text{N}\\,\\text{m}^{-1}$ 时，我们发现\n$$\nE A = \\left(1.5 \\times 10^{6}\\right) \\left(1.0 \\times 10^{-4}\\right) = 1.5 \\times 10^{2} = 150,\n$$\n$$\nL^{2} = \\left( 0.1 \\right)^{2} = 1.0 \\times 10^{-2} = 0.01,\n$$\n因此\n$$\nd_2 = \\frac{q L^{2}}{4 E A} = \\frac{10 \\times 0.01}{4 \\times 150} = \\frac{0.1}{600} = \\frac{1}{6000} = 1.666\\ldots \\times 10^{-4}.\n$$\n四舍五入到四位有效数字，位移控制变量为\n$$\nd_2 \\approx 0.0001667 \\quad \\text{米}.\n$$\n\n这个构造过程表明，开放节点矢量在边界处恢复了插值控制，允许通过 $d_1$ 和 $d_3$ 直接施加本质边界条件，并得出了单一标量未知数 $d_2$，其值通过弱形式从第一性原理计算得出。",
            "answer": "$$\\boxed{0.0001667}$$"
        }
    ]
}