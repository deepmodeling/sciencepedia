{
    "hands_on_practices": [
        {
            "introduction": "哈根-泊肃叶 (Hagen-Poiseuille) 方程是血管流动分析的基石。本练习将引导您从纳维-斯托克斯 (Navier-Stokes) 方程出发，推导出这一基本定律。通过将其应用于模拟动脉狭窄的场景，本练习凸显了血管半径的微小变化对血流量的巨大影响——这是理解动脉粥样硬化等疾病病理生理学的关键概念。",
            "id": "4208145",
            "problem": "一段直的动脉段被建模为一个刚性的圆形圆柱管，输送着被视为不可压缩牛顿流体的血液，其动态粘度为 $\\mu$。考虑两个长度均为 $L$ 的均匀子段：一个半径为 $r_{h}$ 的健康子段和一个半径为 $r_s  r_h$ 的狭窄子段。在承受相同压力降时，计算流经这两个子段的体积流量之比 $Q_s/Q_h$。",
            "solution": "目标是在适用于 Hagen–Poiseuille 流的假设下，从第一性原理出发，求得每个均匀圆柱子段的体积流量。从牛顿流体的不可压缩 Navier–Stokes 方程开始，\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^{2}\\mathbf{u},\n$$\n其中 $\\nabla \\cdot \\mathbf{u} = 0$。在直的、刚性的圆管中，对于稳态、轴对称、充分发展的流动，轴向速度 $u(r)$ 仅取决于径向坐标 $r$，径向和周向速度分量为零，且轴向压力梯度 $\\partial p/\\partial z$ 为常数。对于充分发展的流动，对流项 $(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}$ 为零，轴向分量在圆柱坐标系下简化为\n$$\n\\mu \\left( \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{du}{dr}\\right) \\right) = \\frac{dp}{dz}.\n$$\n施加壁面处的无滑移条件 $u(r=R)=0$ 和中心线处有限的速度梯度，其中 $R$ 是管的半径。对 $r$ 积分两次，得到经典的抛物线速度分布，\n$$\nu(r) = -\\frac{1}{4\\mu}\\frac{dp}{dz}\\left(R^{2} - r^{2}\\right).\n$$\n对于长度 $L$ 上为正的压降 $\\Delta P$，轴向压力梯度为 $\\frac{dp}{dz} = -\\frac{\\Delta P}{L}$，得到\n$$\nu(r) = \\frac{\\Delta P}{4\\mu L}\\left(R^{2} - r^{2}\\right).\n$$\n体积流量 $Q$ 是速度的横截面积分：\n$$\nQ = \\int_{0}^{R} 2\\pi r\\, u(r)\\, dr = \\int_{0}^{R} 2\\pi r \\left( \\frac{\\Delta P}{4\\mu L} (R^{2} - r^{2}) \\right) dr.\n$$\n计算该积分：\n$$\nQ = \\frac{\\Delta P}{4\\mu L} 2\\pi \\left[ \\int_{0}^{R} r R^{2}\\, dr - \\int_{0}^{R} r^{3}\\, dr \\right]\n= \\frac{\\Delta P}{4\\mu L} 2\\pi \\left[ R^{2}\\frac{R^{2}}{2} - \\frac{R^{4}}{4} \\right]\n= \\frac{\\Delta P}{4\\mu L} 2\\pi \\left[ \\frac{R^{4}}{2} - \\frac{R^{4}}{4} \\right]\n= \\frac{\\Delta P}{4\\mu L} 2\\pi \\left( \\frac{R^{4}}{4} \\right)\n= \\frac{\\pi \\Delta P R^{4}}{8 \\mu L}.\n$$\n因此，对于任何半径为 $R$、长度为 $L$、粘度为 $\\mu$、压降为 $\\Delta P$ 的均匀圆柱段，其稳态体积流量为\n$$\nQ(R) = \\frac{\\pi \\Delta P R^{4}}{8 \\mu L}.\n$$\n稳态（零频）血管阻抗定义为 $Z = \\Delta P/Q$，则为\n$$\nZ(R) = \\frac{\\Delta P}{Q(R)} = \\frac{8\\mu L}{\\pi R^{4}}.\n$$\n将此应用于半径分别为 $r_{h}$ 和 $r_{s}$ 的健康子段和狭窄子段。对于相同的 $\\Delta P$、$\\mu$ 和 $L$，体积流量之比为\n$$\n\\frac{Q_{s}}{Q_{h}} = \\frac{Q(r_{s})}{Q(r_{h})} = \\frac{\\pi \\Delta P r_{s}^{4} / (8 \\mu L)}{\\pi \\Delta P r_{h}^{4} / (8 \\mu L)} = \\left( \\frac{r_{s}}{r_{h}} \\right)^{4}.\n$$\n代入给定的半径：\n$$\n\\frac{r_{s}}{r_{h}} = \\frac{3.0 \\times 10^{-4}}{5.0 \\times 10^{-4}} = 0.6,\n$$\n所以\n$$\n\\frac{Q_{s}}{Q_{h}} = (0.6)^{4} = 0.1296.\n$$\n为完整起见，计算各自的流量并验证层流假设。健康子段：\n$$\nQ_{h} = \\frac{\\pi (1.3 \\times 10^{3}) (5.0 \\times 10^{-4})^{4}}{8 (3.5 \\times 10^{-3}) (3.0 \\times 10^{-2})}.\n$$\n计算 $r_{h}^{4}$：\n$$\nr_{h}^{4} = (5.0 \\times 10^{-4})^{4} = 6.25 \\times 10^{-14}.\n$$\n因此，\n$$\nQ_{h} = \\frac{\\pi (1.3 \\times 10^{3}) (6.25 \\times 10^{-14})}{8 (3.5 \\times 10^{-3}) (3.0 \\times 10^{-2})}\n= \\frac{\\pi (8.125 \\times 10^{-11})}{8.4 \\times 10^{-4}} \\approx \\frac{2.553 \\times 10^{-10}}{8.4 \\times 10^{-4}} \\approx 3.04 \\times 10^{-7}\\ \\mathrm{m^{3}/s}.\n$$\n狭窄子段：\n$$\nQ_{s} = \\frac{\\pi (1.3 \\times 10^{3}) (3.0 \\times 10^{-4})^{4}}{8 (3.5 \\times 10^{-3}) (3.0 \\times 10^{-2})},\n\\quad r_{s}^{4} = (3.0 \\times 10^{-4})^{4} = 8.1 \\times 10^{-15},\n$$\n所以\n$$\nQ_{s} = \\frac{\\pi (1.3 \\times 10^{3}) (8.1 \\times 10^{-15})}{8.4 \\times 10^{-4}}\n= \\frac{\\pi (1.053 \\times 10^{-11})}{8.4 \\times 10^{-4}} \\approx \\frac{3.308 \\times 10^{-11}}{8.4 \\times 10^{-4}} \\approx 3.94 \\times 10^{-8}\\ \\mathrm{m^{3}/s}.\n$$\n从这些计算值得到的比率 $Q_{s}/Q_{h}$ 是\n$$\n\\frac{3.94 \\times 10^{-8}}{3.04 \\times 10^{-7}} \\approx 0.1296,\n$$\n这与直接通过半径比的四次方计算得到的结果一致。使用精确的解析比率 $(r_{s}/r_{h})^{4}$ 是首选且正确的。\n\n可选地，通过雷诺数验证层流假设。平均轴向速度 $v_{\\text{avg}}$ 是 $Q/(\\pi R^{2}) = \\Delta P R^{2} / (8 \\mu L)$，所以\n$$\n\\mathrm{Re} = \\frac{\\rho v_{\\text{avg}} (2R)}{\\mu} = \\frac{\\rho \\Delta P R^{3}}{4 \\mu^{2} L}.\n$$\n对于健康子段，$R = r_{h}$，\n$$\n\\mathrm{Re}_{h} = \\frac{(1.06 \\times 10^{3})(1.3 \\times 10^{3})(5.0 \\times 10^{-4})^{3}}{4 (3.5 \\times 10^{-3})^{2} (3.0 \\times 10^{-2})}\n\\approx \\frac{(1.378 \\times 10^{6})(1.25 \\times 10^{-10})}{4 (1.225 \\times 10^{-5})(3.0 \\times 10^{-2})}\n\\approx \\frac{1.72 \\times 10^{-4}}{1.47 \\times 10^{-6}} \\approx 117,\n$$\n这远在管流的层流范围内。狭窄子段的雷诺数会因为半径更小（流量也更低）而更低，因此层流假设仍然是一致的。\n\n因此，在相同压降、粘度和长度下，体积流量之比完全由半径之比的四次方决定，最终值为 $0.1296$。按照要求，最终答案是无量纲比率 $Q_{s}/Q_{h}$，四舍五入到四位有效数字。",
            "answer": "$$\\boxed{0.1296}$$"
        },
        {
            "introduction": "真实的血液流动是脉动性的，而非恒定不变。本练习引入了一种简化的时变流动模型——准稳态近似，在此模型中，任何瞬间的流动都表现得像稳态的泊肃叶流。该练习不仅要求您计算瞬时壁面剪切应力，还引入了振荡剪切指数 (OSI)，这是一个将流体动力学与血管细胞生物学及疾病发展联系起来的关键指标。",
            "id": "4194081",
            "problem": "考虑在半径为 $R$ 的笔直、刚性、圆形血管中，存在一种不可压缩的牛顿流体血液流动，其轴线沿 $x$ 方向。假设流动是轴对称、充分发展和层流。设血液密度为 $\\rho$，动力粘度为 $\\mu$。血管由周期为 $T$ 的时变周期性轴向压力梯度 $\\partial p/\\partial x$ 驱动。流动频率和几何尺度使得 Womersley 数 $\\alpha = R \\sqrt{\\omega \\rho/\\mu}$（其中 $\\omega = 2\\pi/T$）足够小，以至于在一个周期内的动量平衡中可以忽略非定常惯性项，同时保留粘性效应。\n\n从不可压缩的 Navier-Stokes 方程和牛顿本构关系出发，推导瞬时壁面剪切应力 $\\tau_{w}(t)$ 关于瞬时轴向压力梯度 $\\partial p/\\partial x(t)$ 和血管半径 $R$ 的表达式。然后，对于以下在一个周期 $T$ 内生理上合理的压力梯度波形：\n- 对于 $0 \\le t  0.5\\,T$：$\\partial p/\\partial x(t) = -800\\ \\mathrm{Pa/m}$，\n- 对于 $0.5\\,T \\le t  0.7\\,T$：$\\partial p/\\partial x(t) = 0\\ \\mathrm{Pa/m}$，\n- 对于 $0.7\\,T \\le t \\le T$：$\\partial p/\\partial x(t) = +400\\ \\mathrm{Pa/m}$，\n\n计算振荡剪切指数（OSI），其在一个周期内的定义为\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\tau_{w}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\tau_{w}(t)\\right|\\,dt}\\right).\n$$\n取 $R = 0.3\\times 10^{-3}\\ \\mathrm{m}$，$\\mu = 3.5\\times 10^{-3}\\ \\mathrm{Pa\\cdot s}$，$\\rho = 1060\\ \\mathrm{kg/m^{3}}$，以及 $T = 1.0\\ \\mathrm{s}$，并采用惯例，即负的轴向压力梯度（压力在正 $x$ 方向上减小）驱动正 $x$ 方向的流动。将 OSI 报告为一个无量纲小数，并四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、自洽且提法明确。忽略非定常惯性项的核心假设由所提供的参数证明是合理的，这些参数导致了一个小的 Womersley 数，这是准稳态流的特征。\n\n我们从柱坐标系 $(r, \\theta, x)$ 下的不可压缩 Navier-Stokes 方程开始。对于一个轴对称（$v_\\theta = 0$，$\\partial/\\partial\\theta=0$）且充分发展（$\\partial u/\\partial x = 0$，其中 $u$ 是轴向速度分量）的流动，连续性方程（$\\nabla \\cdot \\mathbf{v}=0$）意味着径向速度 $v_r$ 处处为零。在这些条件下，轴向动量方程简化为：\n$$\n\\rho \\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x}(t) + \\mu \\left( \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) \\right)\n$$\n问题指出 Womersley 数 $\\alpha = R \\sqrt{\\omega \\rho/\\mu}$ 很小，这使得我们可以忽略非定常惯性项 $\\rho \\frac{\\partial u}{\\partial t}$。这一简化是准稳态流近似的基石。因此，控制方程在每个时刻都简化为压力梯度和粘性力之间的平衡：\n$$\n0 = -\\frac{\\partial p}{\\partial x}(t) + \\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right)\n$$\n对于任意给定的时间 $t$，该方程可以被视为关于 $r$ 的常微分方程。重新整理，我们得到：\n$$\n\\frac{d}{d r} \\left( r \\frac{d u}{d r} \\right) = \\frac{r}{\\mu} \\frac{\\partial p}{\\partial x}(t)\n$$\n对 $r$ 积分得到：\n$$\nr \\frac{d u}{d r} = \\frac{r^2}{2\\mu} \\frac{\\partial p}{\\partial x}(t) + C_1\n$$\n为了使速度梯度 $du/dr$ 在血管中心线（$r=0$）处为有限值，积分常数 $C_1$ 必须为零。因此：\n$$\n\\frac{d u}{d r} = \\frac{r}{2\\mu} \\frac{\\partial p}{\\partial x}(t)\n$$\n再次对 $r$ 积分，得到速度剖面：\n$$\nu(r, t) = \\frac{r^2}{4\\mu} \\frac{\\partial p}{\\partial x}(t) + C_2\n$$\n我们在血管壁处应用无滑移边界条件，$u(R,t) = 0$：\n$$\n0 = \\frac{R^2}{4\\mu} \\frac{\\partial p}{\\partial x}(t) + C_2 \\quad \\implies \\quad C_2 = -\\frac{R^2}{4\\mu} \\frac{\\partial p}{\\partial x}(t)\n$$\n将 $C_2$ 代回速度表达式，得到瞬时抛物线形速度剖面，这是 Poiseuille 流的特征：\n$$\nu(r, t) = \\frac{1}{4\\mu} \\frac{\\partial p}{\\partial x}(t) (r^2 - R^2)\n$$\n在这种流动构型下，牛顿流体的剪切应力由 $\\tau_{rx} = \\mu (du/dr)$ 给出。壁面剪切应力 $\\tau_w(t)$ 是在壁面 $r=R$ 处计算的该应力。\n$$\n\\tau_w(t) = \\mu \\left. \\frac{du}{dr} \\right|_{r=R}\n$$\n使用我们关于 $du/dr$ 的表达式：\n$$\n\\tau_w(t) = \\mu \\left( \\frac{R}{2\\mu} \\frac{\\partial p}{\\partial x}(t) \\right) = \\frac{R}{2} \\frac{\\partial p}{\\partial x}(t)\n$$\n这就是将瞬时壁面剪切应力与瞬时压力梯度联系起来所要求的表达式。\n\n接下来，我们计算振荡剪切指数（OSI），其定义为：\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\tau_{w}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\tau_{w}(t)\\right|\\,dt}\\right)\n$$\n代入我们关于 $\\tau_w(t)$ 的表达式：\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\frac{R}{2} \\frac{\\partial p}{\\partial x}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\frac{R}{2} \\frac{\\partial p}{\\partial x}(t)\\right|\\,dt}\\right)\n$$\n由于 $R$ 是一个正常数，项 $R/2$ 可以从分子和分母中提出并约去：\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\frac{R}{2}\\left|\\int_{0}^{T} \\frac{\\partial p}{\\partial x}(t)\\,dt\\right|}{\\frac{R}{2}\\int_{0}^{T} \\left|\\frac{\\partial p}{\\partial x}(t)\\right|\\,dt}\\right) = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\frac{\\partial p}{\\partial x}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\frac{\\partial p}{\\partial x}(t)\\right|\\,dt}\\right)\n$$\n这表明，对于这种流动状态，OSI 仅取决于压力梯度的时间波形，而不取决于 $R$、$\\mu$ 或 $\\rho$ 的具体值。周期给定为 $T=1.0$ s。压力梯度 $\\partial p/\\partial x(t)$ 是一个分段常数函数。我们将其记为 $G(t)$。\n\n我们首先计算压力梯度在一个周期内的积分：\n$$\n\\int_{0}^{T} G(t)\\,dt = \\int_{0}^{0.5T} (-800)\\,dt + \\int_{0.5T}^{0.7T} (0)\\,dt + \\int_{0.7T}^{T} (400)\\,dt\n$$\n当 $T=1.0$ s 时：\n$$\n\\int_{0}^{1.0} G(t)\\,dt = (-800) \\times (0.5 - 0) + (0) \\times (0.7 - 0.5) + (400) \\times (1.0 - 0.7)\n$$\n$$\n= (-800)(0.5) + (0)(0.2) + (400)(0.3) = -400 + 0 + 120 = -280\n$$\n该积分的绝对值为 $|\\int_{0}^{T} G(t)\\,dt| = |-280| = 280$。\n\n接下来，我们计算压力梯度绝对值的积分：\n$$\n\\int_{0}^{T} |G(t)|\\,dt = \\int_{0}^{0.5T} |-800|\\,dt + \\int_{0.5T}^{0.7T} |0|\\,dt + \\int_{0.7T}^{T} |400|\\,dt\n$$\n当 $T=1.0$ s 时：\n$$\n\\int_{0}^{1.0} |G(t)|\\,dt = (800) \\times (0.5 - 0) + (0) \\times (0.7 - 0.5) + (400) \\times (1.0 - 0.7)\n$$\n$$\n= (800)(0.5) + (0)(0.2) + (400)(0.3) = 400 + 0 + 120 = 520\n$$\n现在，将这些值代回 OSI 公式：\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{280}{520}\\right)\n$$\n化简分数：\n$$\n\\frac{280}{520} = \\frac{28}{52} = \\frac{7}{13}\n$$\n所以，OSI 为：\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{7}{13}\\right) = \\frac{1}{2}\\left(\\frac{13 - 7}{13}\\right) = \\frac{1}{2}\\left(\\frac{6}{13}\\right) = \\frac{3}{13}\n$$\n为了以四舍五入到四位有效数字的小数形式提供答案，我们计算其值：\n$$\n\\mathrm{OSI} = \\frac{3}{13} \\approx 0.23076923...\n$$\n四舍五入到四位有效数字得到 $0.2308$。",
            "answer": "$$\n\\boxed{0.2308}\n$$"
        },
        {
            "introduction": "循环系统是一个复杂的网络，而非单一的管道。本练习将挑战您将对单个血管的理解扩展到整个网络系统，其中借鉴了电路分析的类比方法。您将基于质量守恒定律为血管网络推导控制方程，并实现一种数值算法来求解节点压力和流量，这项技能是现代计算生物力学的核心。",
            "id": "3919897",
            "problem": "您的任务是设计并实现一个数值求解算法，用于计算血管网络中的稳态层流，假设血管为圆柱形且流体不可压缩。从第一性原理出发，推导出一个由相互连接的圆柱形血管组成的网络中，关于体积流量和节点压力的控制方程。这些假设必须符合物理现实：轴向、充分发展、稳态、层流；不可压缩流体；血管壁处无滑移；动力粘度恒定。基于这些假设和不可压缩形式的控制方程，推导出表达式，以计算流经每个血管段的体积流量，并在每个内部节点强制执行质量守恒，从而得到一个关于未知节点压力的可解线性系统。您的程序必须实现此算法，以计算所提供的测试套件中每个网络的总入口体积流量。\n\n网络被定义为具有节点和边的无向图。每条边连接两个节点，并由其圆柱形长度和半径参数化，流体具有给定的动力粘度。一些节点具有指定的压力（狄利克雷边界条件），包括指定的入口节点和出口节点。内部节点的压力未知，需要通过强制质量守恒来求解。每条边上的体积流量必须根据上述假设推导出的物理定律进行一致性计算，并且入口节点的净流量必须计算为离开入口节点进入网络的流量之和。\n\n您必须确保科学真实性和数值稳定性，并且不得假设任何绕过从所述基本定律推导的“捷径”公式。推导必须从不可压缩、稳态、层流形式的控制方程开始，通过在每个节点强制质量守恒，得出一组关于节点压力的线性方程。然后，您的实现必须解这些线性方程并计算边上的流量。所有物理量必须以一致的单位表示：长度单位为$\\mathrm{m}$，半径单位为$\\mathrm{m}$，压力单位为$\\mathrm{Pa}$，动力粘度单位为$\\mathrm{Pa\\cdot s}$，体积流量单位为$\\mathrm{m^3/s}$。您最终的数值答案必须以$\\mathrm{m^3/s}$表示。\n\n测试套件：\n- 案例$1$（边界条件与单血管检查，理想情况）：节点$\\{0,1\\}$，节点$0$和节点$1$之间有一根血管，长度$L = 0.02\\,\\mathrm{m}$，半径$r = 0.001\\,\\mathrm{m}$；动力粘度$\\mu = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$；边界压力：节点$0$（入口）的压力为$p_0 = 12000\\,\\mathrm{Pa}$，节点$1$（出口）的压力为$p_1 = 10000\\,\\mathrm{Pa}$。计算离开节点$0$进入网络的总入口流量，单位为$\\mathrm{m^3/s}$。\n- 案例$2$（对称分叉，内部节点压力）：节点$\\{0,1,2,3\\}$，血管：$(0,1)$，其$L = 0.02\\,\\mathrm{m}$，$r = 0.001\\,\\mathrm{m}$；$(1,2)$，其$L = 0.03\\,\\mathrm{m}$，$r = 0.0008\\,\\mathrm{m}$；$(1,3)$，其$L = 0.03\\,\\mathrm{m}$，$r = 0.0008\\,\\mathrm{m}$；$\\mu = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$；边界压力：节点$0$（入口）的压力为$p_0 = 12000\\,\\mathrm{Pa}$，节点$2$和$3$（出口）的压力为$p_2 = 10000\\,\\mathrm{Pa}$和$p_3 = 10000\\,\\mathrm{Pa}$；节点$1$是内部节点，压力未知。计算离开节点$0$进入网络的总入口流量，单位为$\\mathrm{m^3/s}$。\n- 案例$3$（具有一个长而窄分支的非对称分叉，边缘情况）：节点$\\{0,1,2,3\\}$，血管：$(0,1)$，其$L = 0.02\\,\\mathrm{m}$，$r = 0.0007\\,\\mathrm{m}$；$(1,2)$，其$L = 0.20\\,\\mathrm{m}$，$r = 0.0002\\,\\mathrm{m}$；$(1,3)$，其$L = 0.02\\,\\mathrm{m}$，$r = 0.0010\\,\\mathrm{m}$；$\\mu = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$；边界压力：节点$0$（入口）的压力为$p_0 = 12000\\,\\mathrm{Pa}$，节点$2$和$3$（出口）的压力为$p_2 = 10000\\,\\mathrm{Pa}$和$p_3 = 10000\\,\\mathrm{Pa}$；节点$1$是内部节点。计算离开节点$0$进入网络的总入口流量，单位为$\\mathrm{m^3/s}$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个案例的总入口体积流量四舍五入到$8$位有效数字（例如，$[q_1,q_2,q_3]$）。所有体积流量必须以$\\mathrm{m^3/s}$为单位，四舍五入到$8$位有效数字。",
            "solution": "该问题要求设计一个数值算法，用于求解由相互连接的圆柱形血管构成的血管网络中的稳态层流。解决方案必须从第一性原理推导，然后实施以计算一系列测试案例的总入口体积流量。\n\n对问题陈述的验证证实了其科学性、适定性和客观性。它基于流体力学的既定原理，特别是适用于小血管中血流的简化假设下的Navier-Stokes方程。该问题提供了一套完整的物理参数、网络定义和边界条件，从而可以得到一个唯一且稳定的解。语言精确，没有歧义。因此，该问题是有效的，我们可以进行完整的推导和求解。\n\n解决方案分三个阶段展开：首先，从流体运动的基本方程推导单个血管中的流体控制方程；其次，通过强制质量守恒，为网络中内部节点的压力建立一个线性方程组；第三，实现一个数值算法来求解该系统并计算所需的流率。\n\n我们从不可压缩牛顿流体在稳态下（忽略体积力）的Navier-Stokes方程开始：\n$$ \\rho (\\vec{v} \\cdot \\nabla) \\vec{v} = -\\nabla p + \\mu \\nabla^2 \\vec{v} $$\n其中$\\rho$是流体密度，$\\vec{v}$是速度场，$p$是压力，$\\mu$是动力粘度。对于圆柱形血管中的流动，很自然地使用柱坐标系$(r, \\theta, z)$，其中$z$轴与血管中心轴对齐。\n\n问题陈述要求假设流动为稳态、轴向、充分发展、层流。这些假设转化为对速度矢量$\\vec{v} = (v_r, v_\\theta, v_z)$的以下条件：\n1.  稳态流：$\\frac{\\partial}{\\partial t} = 0$。\n2.  轴向流：速度只有沿圆柱轴向的分量，因此$v_r = 0$和$v_\\theta = 0$。\n3.  充分发展流：速度剖面沿血管长度方向不发生变化，这意味着$\\frac{\\partial v_z}{\\partial z} = 0$。因此，$v_z$只能是$r$和$\\theta$的函数。\n4.  轴对称流：由于血管和流动的圆柱对称性，速度不依赖于角坐标，因此$\\frac{\\partial}{\\partial \\theta} = 0$。这意味着$v_z = v_z(r)$。\n\n不可压缩条件由连续性方程$\\nabla \\cdot \\vec{v} = 0$表示。在柱坐标中，即为：\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0 $$\n根据我们的假设，该方程简化为$0+0+0=0$，自动满足。\n\n接下来，我们考察动量方程。$r$-动量和$\\theta$-动量方程表明$\\frac{\\partial p}{\\partial r} = 0$和$\\frac{\\partial p}{\\partial \\theta} = 0$，意味着压力$p$仅是$z$的函数，即$p=p(z)$。在我们的假设下，$z$-动量方程显著简化为：\n$$ 0 = -\\frac{dp}{dz} + \\mu \\left( \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dv_z}{dr}\\right) \\right) $$\n由于$v_z$仅依赖于$r$，$p$仅依赖于$z$，为了使该等式成立，两边都必须等于一个常数。这意味着压力梯度$\\frac{dp}{dz}$沿血管必须是恒定的。我们可以将方程重排为：\n$$ \\frac{d}{dr}\\left(r \\frac{dv_z}{dr}\\right) = \\frac{r}{\\mu} \\frac{dp}{dz} $$\n对$r$积分一次得到：\n$$ r \\frac{dv_z}{dr} = \\frac{r^2}{2\\mu} \\frac{dp}{dz} + C_1 $$\n两边除以$r$并再次积分，得到速度剖面：\n$$ v_z(r) = \\frac{r^2}{4\\mu} \\frac{dp}{dz} + C_1 \\ln(r) + C_2 $$\n为了确定积分常数$C_1$和$C_2$，我们应用物理边界条件：\n1.  在血管中心线（$r=0$）处，速度必须是有限的。由于当$r \\to 0$时$\\ln(r) \\to -\\infty$，我们必须有$C_1 = 0$。\n2.  在血管壁（$r=R$，其中$R$是血管半径）处的无滑移条件要求流体速度为零：$v_z(R) = 0$。\n应用无滑移条件：\n$$ 0 = \\frac{R^2}{4\\mu} \\frac{dp}{dz} + C_2 \\implies C_2 = -\\frac{R^2}{4\\mu} \\frac{dp}{dz} $$\n将常数代回，我们得到Poiseuille流的抛物线速度剖面：\n$$ v_z(r) = \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2) $$\n恒定的压力梯度可以用血管入口（$z=0$）处的压力$p_{in}$和出口（$z=L$）处的压力$p_{out}$表示，对于长度为$L$的血管：$\\frac{dp}{dz} = \\frac{p_{out} - p_{in}}{L} = -\\frac{\\Delta p}{L}$，其中$\\Delta p = p_{in} - p_{out}$是压降。因此，速度剖面为：\n$$ v_z(r) = \\frac{\\Delta p}{4\\mu L} (R^2 - r^2) $$\n体积流率$Q$通过对速度剖面在血管横截面积上积分得到：\n$$ Q = \\int_{0}^{R} v_z(r) \\, 2\\pi r \\, dr = \\frac{2\\pi \\Delta p}{4\\mu L} \\int_{0}^{R} (R^2 - r^2)r \\, dr $$\n$$ Q = \\frac{\\pi \\Delta p}{2\\mu L} \\left[ \\frac{R^2r^2}{2} - \\frac{r^4}{4} \\right]_0^R = \\frac{\\pi \\Delta p}{2\\mu L} \\left(\\frac{R^4}{2} - \\frac{R^4}{4}\\right) = \\frac{\\pi R^4}{8\\mu L} \\Delta p $$\n这就是Hagen-Poiseuille方程。它可以写成$Q = K \\cdot \\Delta p$，其中$K = \\frac{\\pi R^4}{8\\mu L}$是血管的水力传导率。这种关系类似于电路中的欧姆定律。\n\n对于血管网络，我们将其建模为一个图，其中节点代表连接点和边界点，边代表血管。节点分为内部节点$N_I$（压力未知）和边界节点$N_B$（压力指定，即狄利克雷边界条件）。对于连接节点$i$和$j$的每根血管，从$i$到$j$的流量为$Q_{ij} = K_{ij}(p_i - p_j)$，其中$p_i$和$p_j$是节点压力，$K_{ij}$是血管的传导率。\n\n在每个内部节点$k \\in N_I$处，对于不可压缩流体，质量守恒要求流入该节点的体积流量总和等于流出该节点的流量总和。等价地，流出该节点的净流量为零：\n$$ \\sum_{j \\in \\text{adj}(k)} Q_{kj} = 0 $$\n其中$\\text{adj}(k)$是与节点$k$相邻的节点集合。代入Hagen-Poiseuille关系：\n$$ \\sum_{j \\in \\text{adj}(k)} K_{kj} (p_k - p_j) = 0 $$\n该方程可以重新整理成一个关于未知压力的线性方程：\n$$ \\left( \\sum_{j \\in \\text{adj}(k)} K_{kj} \\right) p_k - \\sum_{j \\in \\text{adj}(k), j \\in N_I} K_{kj} p_j = \\sum_{j \\in \\text{adj}(k), j \\in N_B} K_{kj} p_j $$\n我们为每个内部节点建立一个这样的方程。这构成了一个线性方程组$A\\mathbf{p}_I = \\mathbf{b}$，其中$\\mathbf{p}_I$是内部节点未知压力的向量。系统矩阵$A$和右侧向量$\\mathbf{b}$的构造如下：\n-   对于每个内部节点$k$（对应于矩阵的第$i$行）：\n    -   对角元素是$A_{ii} = \\sum_{j \\in \\text{adj}(k)} K_{kj}$。\n    -   非对角元素$A_{ij}$（其中内部节点$l$对应于第$j$列）是$A_{ij} = -K_{kl}$，如果节点$k$和$l$相连；否则，$A_{ij} = 0$。\n    -   向量$\\mathbf{b}$的相应元素是$b_i = \\sum_{j \\in \\text{adj}(k), j \\in N_B} K_{kj}p_j$，这表示固定压力边界节点的影响。\n\n数值算法如下：\n1.  解析网络拓扑、血管参数（$L, R$）、流体粘度$\\mu$和边界压力。\n2.  将节点分类为内部节点或边界节点。设内部节点数为$n_{int}$。\n3.  对每根血管，计算其传导率$K$。\n4.  根据上述规则构造$n_{int} \\times n_{int}$矩阵$A$和$n_{int} \\times 1$向量$\\mathbf{b}$。\n5.  求解线性系统$A\\mathbf{p}_I = \\mathbf{b}$，得到内部压力向量$\\mathbf{p}_I$。\n6.  确定所有节点压力后，计算总入口流量。对于每个指定的入口节点$s$，将其连接血管的流量相加：$Q_s = \\sum_{j \\in \\text{adj}(s)} K_{sj}(p_s - p_j)$。\n7.  网络的总入口流量是所有入口节点流量的总和。\n该算法为问题提供了完整的解决方案，它基于基本原理，并最终形成一个适定的数值任务。",
            "answer": "```python\nimport numpy as np\n\ndef format_result(value: float) - str:\n    \"\"\"Formats a float to a string with 8 significant digits.\"\"\"\n    return \"{:.8g}\".format(value)\n\ndef solve_network(\n    nodes: list[int],\n    vessels: list[tuple[int, int, float, float]],\n    boundary_pressures: dict[int, float],\n    viscosity: float,\n    inlet_nodes: list[int]\n) - float:\n    \"\"\"\n    Solves for pressures and flows in a vascular network.\n\n    Args:\n        nodes: A list of all node IDs.\n        vessels: A list of tuples, each representing a vessel: (node1, node2, length, radius).\n        boundary_pressures: A dictionary mapping boundary node IDs to their pressure values.\n        viscosity: The dynamic viscosity of the fluid.\n        inlet_nodes: A list of node IDs designated as inlets.\n\n    Returns:\n        The total volumetric flow rate from all inlet nodes.\n    \"\"\"\n    internal_nodes = sorted([n for n in nodes if n not in boundary_pressures])\n    num_internal = len(internal_nodes)\n\n    # Build adjacency list and calculate conductance for each vessel\n    adj = {n: [] for n in nodes}\n    conductances = {}\n    for n1, n2, length, radius in vessels:\n        if length == 0 or radius == 0:\n            raise ValueError(\"Vessel length and radius must be positive.\")\n        # Hydraulic conductance from Hagen-Poiseuille equation: K = pi*R^4 / (8*mu*L)\n        K = (np.pi * radius**4) / (8 * viscosity * length)\n        adj[n1].append(n2)\n        adj[n2].append(n1)\n        conductances[(n1, n2)] = K\n        conductances[(n2, n1)] = K\n\n    # Initialize the full pressure dictionary with boundary values\n    pressures = boundary_pressures.copy()\n\n    # If there are internal nodes, set up and solve the linear system for their pressures\n    if num_internal  0:\n        # Map internal node IDs to matrix indices (0 to num_internal-1)\n        internal_node_map = {node_id: i for i, node_id in enumerate(internal_nodes)}\n        \n        A = np.zeros((num_internal, num_internal))\n        b = np.zeros(num_internal)\n\n        for i, node_k in enumerate(internal_nodes):\n            # For each internal node k, construct the i-th row of the system A*p=b\n            # based on conservation of mass: sum(Q_kj) = 0 for all neighbors j.\n            for neighbor_j in adj[node_k]:\n                K_kj = conductances.get((node_k, neighbor_j))\n                \n                # Diagonal element: A[i,i] is the sum of conductances of all vessels connected to node_k\n                A[i, i] += K_kj\n                \n                # Off-diagonal elements\n                if neighbor_j in internal_nodes:\n                    # Neighbor is another internal node, contributes to the matrix A\n                    j = internal_node_map[neighbor_j]\n                    A[i, j] -= K_kj\n                else:\n                    # Neighbor is a boundary node, contributes to the vector b\n                    b[i] += K_kj * boundary_pressures[neighbor_j]\n        \n        # Solve the linear system A * p_internal = b\n        try:\n            internal_p_solution = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            raise RuntimeError(\"The linear system for nodal pressures is singular.\")\n\n        # Add the solved internal pressures to the main pressure dictionary\n        for i, node_id in enumerate(internal_nodes):\n            pressures[node_id] = internal_p_solution[i]\n\n    # Calculate the total volumetric flow leaving the inlet nodes\n    total_inlet_flow = 0.0\n    for inlet_node in inlet_nodes:\n        if inlet_node not in pressures:\n            continue\n        for neighbor in adj[inlet_node]:\n            # Flow from inlet_node to neighbor: Q = K * (P_inlet - P_neighbor)\n            total_inlet_flow += conductances[(inlet_node, neighbor)] * \\\n                                (pressures[inlet_node] - pressures[neighbor])\n            \n    return total_inlet_flow\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the vascular network solver.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": [0, 1],\n            \"vessels\": [(0, 1, 0.02, 0.001)],\n            \"boundary_pressures\": {0: 12000.0, 1: 10000.0},\n            \"viscosity\": 3.5e-3,\n            \"inlet_nodes\": [0]\n        },\n        {\n            \"nodes\": [0, 1, 2, 3],\n            \"vessels\": [\n                (0, 1, 0.02, 0.001), \n                (1, 2, 0.03, 0.0008), \n                (1, 3, 0.03, 0.0008)\n            ],\n            \"boundary_pressures\": {0: 12000.0, 2: 10000.0, 3: 10000.0},\n            \"viscosity\": 3.5e-3,\n            \"inlet_nodes\": [0]\n        },\n        {\n            \"nodes\": [0, 1, 2, 3],\n            \"vessels\": [\n                (0, 1, 0.02, 0.0007),\n                (1, 2, 0.20, 0.0002),\n                (1, 3, 0.02, 0.0010)\n            ],\n            \"boundary_pressures\": {0: 12000.0, 2: 10000.0, 3: 10000.0},\n            \"viscosity\": 3.5e-3,\n            \"inlet_nodes\": [0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        flow = solve_network(**case)\n        results.append(format_result(flow))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}