{
    "hands_on_practices": [
        {
            "introduction": "This first practice establishes the fundamental relationship between pressure, geometry, and flow in a simplified, steady-state model of blood flow. By deriving the celebrated Hagen-Poiseuille equation from the Navier-Stokes equations, you will quantify the profound impact of a vessel's radius on its hydraulic impedance, a critical concept for understanding diseases like atherosclerosis . This exercise solidifies the foundational principles that govern vascular resistance.",
            "id": "4208145",
            "problem": "A straight arterial segment is modeled as a rigid, circular cylindrical tube conveying blood treated as an incompressible Newtonian fluid with dynamic viscosity $\\mu$. Consider two uniform subsegments of equal length $L$: a healthy subsegment with radius $r_{h}$ and a stenosed subsegment downstream with radius $r_{s}r_{h}$. Assume steady, axisymmetric, fully developed laminar flow with no-slip at the wall, negligible entrance effects, and negligible pulsatility (zero-frequency limit), so that the flow is quasi-static and dominated by viscous resistance. The same pressure drop $\\Delta P$ is imposed across each subsegment. Starting from the conservation of linear momentum for an incompressible fluid and the appropriate boundary conditions for a rigid circular tube, derive the axial velocity profile and the volumetric flow rate for each subsegment. Then compute the volumetric flow rates $Q_{h}$ and $Q_{s}$ for the healthy and stenosed subsegments, respectively, and the corresponding steady (zero-frequency) vascular impedance $Z=\\Delta P/Q$ for each. Finally, report the ratio of volumetric flow rates $Q_{s}/Q_{h}$.\n\nUse the following parameter values:\n- Dynamic viscosity: $\\mu = 3.5 \\times 10^{-3}\\ \\mathrm{Pa \\cdot s}$,\n- Fluid density: $\\rho = 1.06 \\times 10^{3}\\ \\mathrm{kg/m^{3}}$ (for checking laminarity),\n- Subsegment length: $L = 3.0 \\times 10^{-2}\\ \\mathrm{m}$,\n- Healthy radius: $r_{h} = 5.0 \\times 10^{-4}\\ \\mathrm{m}$,\n- Stenosed radius: $r_{s} = 3.0 \\times 10^{-4}\\ \\mathrm{m}$,\n- Pressure drop across each subsegment: $\\Delta P = 1.3 \\times 10^{3}\\ \\mathrm{Pa}$.\n\nExpress any computed volumetric flow rate in $\\mathrm{m^{3}/s}$. As your final answer, provide the single number $Q_{s}/Q_{h}$, rounded to four significant figures, expressed as a pure number (dimensionless).",
            "solution": "The goal is to obtain the volumetric flow rates in each uniform cylindrical subsegment from first principles, under assumptions appropriate for Hagen–Poiseuille flow. Begin with the incompressible Navier–Stokes equations for a Newtonian fluid,\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^{2}\\mathbf{u},\n$$\nwith $\\nabla \\cdot \\mathbf{u} = 0$. Under steady, axisymmetric, fully developed flow in a straight, rigid, circular tube, the axial velocity $u(r)$ depends only on the radial coordinate $r$, the radial and circumferential velocity components vanish, and the axial pressure gradient $\\partial p/\\partial z$ is constant. The convective term $(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}$ vanishes for fully developed flow, and the axial component reduces in cylindrical coordinates to\n$$\n\\mu \\left( \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{du}{dr}\\right) \\right) = \\frac{dp}{dz}.\n$$\nImpose no-slip at the wall $u(r=R)=0$ and finite velocity gradient at the centerline, with $R$ the tube radius. Integrating twice with respect to $r$ yields the classical parabolic profile,\n$$\nu(r) = -\\frac{1}{4\\mu}\\frac{dp}{dz}\\left(R^{2} - r^{2}\\right).\n$$\nFor a positive pressure drop $\\Delta P$ over length $L$, the axial pressure gradient is $\\frac{dp}{dz} = -\\frac{\\Delta P}{L}$, giving\n$$\nu(r) = \\frac{\\Delta P}{4\\mu L}\\left(R^{2} - r^{2}\\right).\n$$\nThe volumetric flow rate $Q$ is the cross-sectional integral of velocity:\n$$\nQ = \\int_{0}^{R} 2\\pi r\\, u(r)\\, dr = \\int_{0}^{R} 2\\pi r \\left( \\frac{\\Delta P}{4\\mu L} (R^{2} - r^{2}) \\right) dr.\n$$\nCompute the integral:\n$$\nQ = \\frac{\\Delta P}{4\\mu L} 2\\pi \\left[ \\int_{0}^{R} r R^{2}\\, dr - \\int_{0}^{R} r^{3}\\, dr \\right]\n= \\frac{\\Delta P}{4\\mu L} 2\\pi \\left[ R^{2}\\frac{R^{2}}{2} - \\frac{R^{4}}{4} \\right]\n= \\frac{\\Delta P}{4\\mu L} 2\\pi \\left[ \\frac{R^{4}}{2} - \\frac{R^{4}}{4} \\right]\n= \\frac{\\Delta P}{4\\mu L} 2\\pi \\left( \\frac{R^{4}}{4} \\right)\n= \\frac{\\pi \\Delta P R^{4}}{8 \\mu L}.\n$$\nThus, for any uniform cylindrical segment of radius $R$, length $L$, viscosity $\\mu$, and pressure drop $\\Delta P$, the steady volumetric flow rate is\n$$\nQ(R) = \\frac{\\pi \\Delta P R^{4}}{8 \\mu L}.\n$$\nThe steady (zero-frequency) vascular impedance, defined as $Z = \\Delta P/Q$, is then\n$$\nZ(R) = \\frac{\\Delta P}{Q(R)} = \\frac{8\\mu L}{\\pi R^{4}}.\n$$\nApply this to the healthy and stenosed subsegments with radii $r_{h}$ and $r_{s}$, respectively. The ratio of volumetric flow rates for the same $\\Delta P$, $\\mu$, and $L$ is\n$$\n\\frac{Q_{s}}{Q_{h}} = \\frac{Q(r_{s})}{Q(r_{h})} = \\frac{\\pi \\Delta P r_{s}^{4} / (8 \\mu L)}{\\pi \\Delta P r_{h}^{4} / (8 \\mu L)} = \\left( \\frac{r_{s}}{r_{h}} \\right)^{4}.\n$$\nSubstitute the given radii:\n$$\n\\frac{r_{s}}{r_{h}} = \\frac{3.0 \\times 10^{-4}}{5.0 \\times 10^{-4}} = 0.6,\n$$\nso\n$$\n\\frac{Q_{s}}{Q_{h}} = (0.6)^{4} = 0.1296.\n$$\nFor completeness, compute the individual flow rates and verify laminarity. Healthy subsegment:\n$$\nQ_{h} = \\frac{\\pi (1.3 \\times 10^{3}) (5.0 \\times 10^{-4})^{4}}{8 (3.5 \\times 10^{-3}) (3.0 \\times 10^{-2})}.\n$$\nCompute $r_{h}^{4}$:\n$$\nr_{h}^{4} = (5.0 \\times 10^{-4})^{4} = 6.25 \\times 10^{-14}.\n$$\nThus,\n$$\nQ_{h} = \\frac{\\pi (1.3 \\times 10^{3}) (6.25 \\times 10^{-14})}{8 (3.5 \\times 10^{-3}) (3.0 \\times 10^{-2})}\n= \\frac{\\pi (8.125 \\times 10^{-11})}{8.4 \\times 10^{-4}} \\approx \\frac{2.553 \\times 10^{-10}}{8.4 \\times 10^{-4}} \\approx 3.04 \\times 10^{-7}\\ \\mathrm{m^{3}/s}.\n$$\nStenosed subsegment:\n$$\nQ_{s} = \\frac{\\pi (1.3 \\times 10^{3}) (3.0 \\times 10^{-4})^{4}}{8 (3.5 \\times 10^{-3}) (3.0 \\times 10^{-2})},\n\\quad r_{s}^{4} = (3.0 \\times 10^{-4})^{4} = 8.1 \\times 10^{-15},\n$$\nso\n$$\nQ_{s} = \\frac{\\pi (1.3 \\times 10^{3}) (8.1 \\times 10^{-15})}{8.4 \\times 10^{-4}}\n= \\frac{\\pi (1.053 \\times 10^{-11})}{8.4 \\times 10^{-4}} \\approx \\frac{3.308 \\times 10^{-11}}{8.4 \\times 10^{-4}} \\approx 3.94 \\times 10^{-8}\\ \\mathrm{m^{3}/s}.\n$$\nThe ratio $Q_{s}/Q_{h}$ from these computed values is\n$$\n\\frac{3.94 \\times 10^{-8}}{3.04 \\times 10^{-7}} \\approx 0.1296,\n$$\nwhich confirms the analytical ratio.\n\nOptionally, verify laminarity via the Reynolds number. The average axial velocity $v_{\\text{avg}}$ is $Q/(\\pi R^{2}) = \\Delta P R^{2} / (8 \\mu L)$, so\n$$\n\\mathrm{Re} = \\frac{\\rho v_{\\text{avg}} (2R)}{\\mu} = \\frac{\\rho \\Delta P R^{3}}{4 \\mu^{2} L}.\n$$\nFor the healthy subsegment with $R = r_{h}$,\n$$\n\\mathrm{Re}_{h} = \\frac{(1.06 \\times 10^{3})(1.3 \\times 10^{3})(5.0 \\times 10^{-4})^{3}}{4 (3.5 \\times 10^{-3})^{2} (3.0 \\times 10^{-2})}\n\\approx \\frac{(1.378 \\times 10^{6})(1.25 \\times 10^{-10})}{4 (1.225 \\times 10^{-5})(3.0 \\times 10^{-2})}\n\\approx \\frac{1.72 \\times 10^{-4}}{1.47 \\times 10^{-6}} \\approx 117,\n$$\nwhich is well within the laminar regime for a tube. The stenosed subsegment Reynolds number will be lower due to the smaller radius (and lower flow), so the laminar assumption remains consistent.\n\nThus, the ratio of volumetric flow rates for the same pressure drop, viscosity, and length is determined purely by the fourth power of the radius ratio, giving the final value $0.1296$. As requested, the final answer is the dimensionless ratio $Q_{s}/Q_{h}$ rounded to four significant figures.",
            "answer": "$$\\boxed{0.1296}$$"
        },
        {
            "introduction": "Building upon the steady-state model, this exercise introduces the concept of time-varying hemodynamics, which is characteristic of arterial blood flow. You will apply a quasi-steady approximation to analyze flow driven by a pulsatile pressure gradient and calculate the Oscillatory Shear Index (OSI), a crucial metric in mechanobiology linked to endothelial dysfunction . This practice demonstrates how to extract physiologically meaningful information from complex flow waveforms.",
            "id": "4194081",
            "problem": "Consider an incompressible, Newtonian blood flow in a straight, rigid, circular vessel of radius $R$ with axis aligned along the $x$-direction. Assume the flow is axisymmetric, fully developed, and laminar. Let the blood density be $\\rho$ and dynamic viscosity be $\\mu$. The vessel is driven by a time-periodic axial pressure gradient $\\partial p/\\partial x$ of period $T$. The flow frequency and geometrical scales are such that the Womersley number $\\alpha = R \\sqrt{\\omega \\rho/\\mu}$, where $\\omega = 2\\pi/T$, is small enough that unsteady inertia may be neglected in the momentum balance over one period while retaining viscous effects.\n\nStarting from the incompressible Navier–Stokes equations and the Newtonian constitutive relation, derive an expression for the instantaneous wall shear stress $\\tau_{w}(t)$ in terms of the instantaneous axial pressure gradient $\\partial p/\\partial x(t)$ and the vessel radius $R$. Then, for the following physiologically plausible pressure gradient waveform over one period $T$:\n- For $0 \\le t  0.5\\,T$: $\\partial p/\\partial x(t) = -800\\ \\mathrm{Pa/m}$,\n- For $0.5\\,T \\le t  0.7\\,T$: $\\partial p/\\partial x(t) = 0\\ \\mathrm{Pa/m}$,\n- For $0.7\\,T \\le t \\le T$: $\\partial p/\\partial x(t) = +400\\ \\mathrm{Pa/m}$,\n\ncompute the oscillatory shear index (OSI), defined over one period by\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\tau_{w}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\tau_{w}(t)\\right|\\,dt}\\right).\n$$\nTake $R = 0.3\\times 10^{-3}\\ \\mathrm{m}$, $\\mu = 3.5\\times 10^{-3}\\ \\mathrm{Pa \\cdot s}$, $\\rho = 1060\\ \\mathrm{kg/m^{3}}$, and $T = 1.0\\ \\mathrm{s}$, and adopt the convention that a negative axial pressure gradient (pressure decreasing in the positive $x$-direction) drives flow in the positive $x$-direction. Report the OSI as a dimensionless decimal rounded to four significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded, self-contained, and well-posed. The core assumption of neglecting unsteady inertia is justified by the provided parameters, which yield a small Womersley number, characteristic of quasi-steady flow.\n\nWe begin with the incompressible Navier-Stokes equations in cylindrical coordinates $(r, \\theta, x)$. For an axisymmetric flow ($v_\\theta = 0$, $\\partial/\\partial\\theta=0$) that is fully developed ($\\partial u/\\partial x = 0$, where $u$ is the axial velocity component), the continuity equation ($\\nabla \\cdot \\mathbf{v}=0$) implies that the radial velocity $v_r$ is zero everywhere. Under these conditions, the axial momentum equation simplifies to:\n$$\n\\rho \\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x}(t) + \\mu \\left( \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) \\right)\n$$\nThe problem states that the Womersley number $\\alpha = R \\sqrt{\\omega \\rho/\\mu}$ is small, which allows us to neglect the unsteady inertia term, $\\rho \\frac{\\partial u}{\\partial t}$. This simplification is the cornerstone of the quasi-steady flow approximation. The governing equation thus reduces to a balance between the pressure gradient and viscous forces at every instant in time:\n$$\n0 = -\\frac{\\partial p}{\\partial x}(t) + \\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right)\n$$\nThis equation can be treated as an ordinary differential equation in $r$ for any given time $t$. Rearranging, we get:\n$$\n\\frac{d}{d r} \\left( r \\frac{d u}{d r} \\right) = \\frac{r}{\\mu} \\frac{\\partial p}{\\partial x}(t)\n$$\nIntegrating with respect to $r$ yields:\n$$\nr \\frac{d u}{d r} = \\frac{r^2}{2\\mu} \\frac{\\partial p}{\\partial x}(t) + C_1\n$$\nFor the velocity gradient $du/dr$ to be finite at the vessel centerline ($r=0$), the constant of integration $C_1$ must be zero. Therefore:\n$$\n\\frac{d u}{d r} = \\frac{r}{2\\mu} \\frac{\\partial p}{\\partial x}(t)\n$$\nIntegrating a second time with respect to $r$ gives the velocity profile:\n$$\nu(r, t) = \\frac{r^2}{4\\mu} \\frac{\\partial p}{\\partial x}(t) + C_2\n$$\nWe apply the no-slip boundary condition at the vessel wall, $u(R,t) = 0$:\n$$\n0 = \\frac{R^2}{4\\mu} \\frac{\\partial p}{\\partial x}(t) + C_2 \\quad \\implies \\quad C_2 = -\\frac{R^2}{4\\mu} \\frac{\\partial p}{\\partial x}(t)\n$$\nSubstituting $C_2$ back into the velocity expression gives the instantaneous parabolic velocity profile, characteristic of Poiseuille flow:\n$$\nu(r, t) = \\frac{1}{4\\mu} \\frac{\\partial p}{\\partial x}(t) (r^2 - R^2)\n$$\nThe shear stress for a Newtonian fluid in this flow configuration is given by $\\tau_{rx} = \\mu (du/dr)$. The wall shear stress, $\\tau_w(t)$, is this stress evaluated at the wall, $r=R$.\n$$\n\\tau_w(t) = \\mu \\left. \\frac{du}{dr} \\right|_{r=R}\n$$\nUsing our expression for $du/dr$:\n$$\n\\tau_w(t) = \\mu \\left( \\frac{R}{2\\mu} \\frac{\\partial p}{\\partial x}(t) \\right) = \\frac{R}{2} \\frac{\\partial p}{\\partial x}(t)\n$$\nThis is the required expression relating instantaneous wall shear stress to the instantaneous pressure gradient.\n\nNext, we compute the Oscillatory Shear Index (OSI), defined as:\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\tau_{w}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\tau_{w}(t)\\right|\\,dt}\\right)\n$$\nSubstituting our expression for $\\tau_w(t)$:\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\frac{R}{2} \\frac{\\partial p}{\\partial x}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\frac{R}{2} \\frac{\\partial p}{\\partial x}(t)\\right|\\,dt}\\right)\n$$\nSince $R$ is a positive constant, the term $R/2$ can be factored out and cancelled from the numerator and denominator:\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{\\frac{R}{2}\\left|\\int_{0}^{T} \\frac{\\partial p}{\\partial x}(t)\\,dt\\right|}{\\frac{R}{2}\\int_{0}^{T} \\left|\\frac{\\partial p}{\\partial x}(t)\\right|\\,dt}\\right) = \\frac{1}{2}\\left(1 - \\frac{\\left|\\int_{0}^{T} \\frac{\\partial p}{\\partial x}(t)\\,dt\\right|}{\\int_{0}^{T} \\left|\\frac{\\partial p}{\\partial x}(t)\\right|\\,dt}\\right)\n$$\nThis demonstrates that the OSI, for this flow regime, depends only on the temporal waveform of the pressure gradient, not on the specific values of $R$, $\\mu$, or $\\rho$. The period is given as $T=1.0$ s. The pressure gradient $\\partial p/\\partial x(t)$ is a piecewise constant function. Let's denote it by $G(t)$.\n\nWe first compute the integral of the pressure gradient over one period:\n$$\n\\int_{0}^{T} G(t)\\,dt = \\int_{0}^{0.5T} (-800)\\,dt + \\int_{0.5T}^{0.7T} (0)\\,dt + \\int_{0.7T}^{T} (400)\\,dt\n$$\nWith $T=1.0$ s:\n$$\n\\int_{0}^{1.0} G(t)\\,dt = (-800) \\times (0.5 - 0) + (0) \\times (0.7 - 0.5) + (400) \\times (1.0 - 0.7)\n$$\n$$\n= (-800)(0.5) + (0)(0.2) + (400)(0.3) = -400 + 0 + 120 = -280\n$$\nThe absolute value of this integral is $|\\int_{0}^{T} G(t)\\,dt| = |-280| = 280$.\n\nNext, we compute the integral of the absolute value of the pressure gradient:\n$$\n\\int_{0}^{T} |G(t)|\\,dt = \\int_{0}^{0.5T} |-800|\\,dt + \\int_{0.5T}^{0.7T} |0|\\,dt + \\int_{0.7T}^{T} |400|\\,dt\n$$\nWith $T=1.0$ s:\n$$\n\\int_{0}^{1.0} |G(t)|\\,dt = (800) \\times (0.5 - 0) + (0) \\times (0.7 - 0.5) + (400) \\times (1.0 - 0.7)\n$$\n$$\n= (800)(0.5) + (0)(0.2) + (400)(0.3) = 400 + 0 + 120 = 520\n$$\nNow, substitute these values back into the OSI formula:\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{280}{520}\\right)\n$$\nSimplifying the fraction:\n$$\n\\frac{280}{520} = \\frac{28}{52} = \\frac{7}{13}\n$$\nSo, the OSI is:\n$$\n\\mathrm{OSI} = \\frac{1}{2}\\left(1 - \\frac{7}{13}\\right) = \\frac{1}{2}\\left(\\frac{13 - 7}{13}\\right) = \\frac{1}{2}\\left(\\frac{6}{13}\\right) = \\frac{3}{13}\n$$\nTo provide the answer as a decimal rounded to four significant figures, we compute the value:\n$$\n\\mathrm{OSI} = \\frac{3}{13} \\approx 0.23076923...\n$$\nRounding to four significant figures gives $0.2308$.",
            "answer": "$$\n\\boxed{0.2308}\n$$"
        },
        {
            "introduction": "Our final practice scales up from a single vessel to an interconnected vascular network, mirroring the complexity of the circulatory system. You will formulate a computational method to solve for pressures and flows throughout a network by combining the single-vessel resistance model with the principle of mass conservation at each junction . This exercise provides a hands-on introduction to the systems-level analysis and numerical algorithms that are central to modern cardiovascular modeling.",
            "id": "3919897",
            "problem": "You are asked to design and implement a numerical solution algorithm for steady laminar flow in vascular networks under the assumption of cylindrical vessels and incompressible fluid. Starting from first principles, derive the governing equations for volumetric flow and nodal pressure in a network of interconnected vessels modeled as cylinders. The assumptions must be physically realistic: axial, fully developed, steady, laminar flow; incompressible fluid; no-slip at the vessel wall; and constant dynamic viscosity. From these assumptions and the incompressible form of the governing equations, derive expressions that allow you to compute the volumetric flow through each vessel segment and enforce conservation of mass at each internal node, leading to a solvable linear system for the unknown nodal pressures. Your program must implement this algorithm to compute the total inlet volumetric flow for each network in the provided test suite.\n\nThe networks are defined as undirected graphs with nodes and edges. Each edge connects two nodes and is parameterized by its cylindrical length and radius, and the fluid has a given dynamic viscosity. Some nodes have specified pressures (Dirichlet boundary conditions), including designated inlet nodes and outlet nodes. Internal nodes have unknown pressures to be solved by enforcing mass conservation. Volumetric flow on each edge must be computed consistently with physical laws derived from the assumptions above, and net flow at the inlet node(s) must be computed as the sum of flows leaving the inlet nodes into the network.\n\nYou must ensure scientific realism and numerical stability, and you must not assume any \"shortcut\" formulas that bypass the derivation from the foundational laws indicated. The derivation must start from the incompressible, steady, laminar form of the governing equations and lead to a set of linear equations for nodal pressures by enforcing conservation of mass at each node. Your implementation must then solve these linear equations and compute flows on edges. All physical quantities must be expressed in consistent units: length in $\\mathrm{m}$, radius in $\\mathrm{m}$, pressure in $\\mathrm{Pa}$, dynamic viscosity in $\\mathrm{Pa\\cdot s}$, and volumetric flow in $\\mathrm{m^3/s}$. Your final numerical answers must be expressed in $\\mathrm{m^3/s}$.\n\nTest suite:\n- Case $1$ (boundary condition and single-vessel check, happy path): nodes $\\{0,1\\}$, one vessel between node $0$ and node $1$ with length $L = 0.02\\,\\mathrm{m}$ and radius $r = 0.001\\,\\mathrm{m}$; dynamic viscosity $\\mu = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$; boundary pressures: node $0$ (inlet) has $p_0 = 12000\\,\\mathrm{Pa}$, node $1$ (outlet) has $p_1 = 10000\\,\\mathrm{Pa}$. Compute the total inlet flow leaving node $0$ into the network in $\\mathrm{m^3/s}$.\n- Case $2$ (symmetric bifurcation, internal node pressure): nodes $\\{0,1,2,3\\}$, vessels: $(0,1)$ with $L = 0.02\\,\\mathrm{m}$, $r = 0.001\\,\\mathrm{m}$; $(1,2)$ with $L = 0.03\\,\\mathrm{m}$, $r = 0.0008\\,\\mathrm{m}$; $(1,3)$ with $L = 0.03\\,\\mathrm{m}$, $r = 0.0008\\,\\mathrm{m}$; $\\mu = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$; boundary pressures: node $0$ (inlet) has $p_0 = 12000\\,\\mathrm{Pa}$, nodes $2$ and $3$ (outlets) have $p_2 = 10000\\,\\mathrm{Pa}$ and $p_3 = 10000\\,\\mathrm{Pa}$; node $1$ is internal with unknown pressure. Compute the total inlet flow leaving node $0$ into the network in $\\mathrm{m^3/s}$.\n- Case $3$ (asymmetric bifurcation with one long narrow branch, edge case): nodes $\\{0,1,2,3\\}$, vessels: $(0,1)$ with $L = 0.02\\,\\mathrm{m}$, $r = 0.0007\\,\\mathrm{m}$; $(1,2)$ with $L = 0.20\\,\\mathrm{m}$, $r = 0.0002\\,\\mathrm{m}$; $(1,3)$ with $L = 0.02\\,\\mathrm{m}$, $r = 0.0010\\,\\mathrm{m}$; $\\mu = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$; boundary pressures: node $0$ (inlet) has $p_0 = 12000\\,\\mathrm{Pa}$, nodes $2$ and $3$ (outlets) have $p_2 = 10000\\,\\mathrm{Pa}$ and $p_3 = 10000\\,\\mathrm{Pa}$; node $1$ is internal. Compute the total inlet flow leaving node $0$ into the network in $\\mathrm{m^3/s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case’s total inlet volumetric flow rounded to $8$ significant digits (for example, $[q_1,q_2,q_3]$). All volumetric flows must be in $\\mathrm{m^3/s}$, rounded to $8$ significant digits.",
            "solution": "The problem requires the design of a numerical algorithm to solve for steady, laminar flow in vascular networks modeled as interconnected cylindrical vessels. The solution must be derived from first principles and then implemented to compute the total inlet volumetric flow for a series of test cases.\n\nThe validation of the problem statement confirms that it is scientifically grounded, well-posed, and objective. It is based on the established principles of fluid mechanics, specifically the Navier-Stokes equations under simplifying assumptions appropriate for blood flow in small vessels. The problem provides a complete set of physical parameters, network definitions, and boundary conditions, allowing for a unique and stable solution. The language is precise and without ambiguity. Therefore, the problem is valid and we may proceed with a full derivation and solution.\n\nThe solution is developed in three stages: first, the derivation of the governing equation for flow in a single vessel from the fundamental equations of fluid motion; second, the formulation of a linear system of equations for the pressures at internal nodes in a network by enforcing mass conservation; and third, the implementation of a numerical algorithm to solve this system and compute the required flow rates.\n\nWe begin with the Navier-Stokes equations for an incompressible, Newtonian fluid in a steady state, neglecting body forces:\n$$ \\rho (\\vec{v} \\cdot \\nabla) \\vec{v} = -\\nabla p + \\mu \\nabla^2 \\vec{v} $$\nwhere $\\rho$ is the fluid density, $\\vec{v}$ is the velocity field, $p$ is the pressure, and $\\mu$ is the dynamic viscosity. For flow in a cylindrical vessel, it is natural to use cylindrical coordinates $(r, \\theta, z)$, with the $z$-axis aligned with the vessel's central axis.\n\nThe problem states to assume steady, axial, fully developed, laminar flow. These assumptions translate to the following conditions on the velocity vector $\\vec{v} = (v_r, v_\\theta, v_z)$:\n1.  Steady flow: $\\frac{\\partial}{\\partial t} = 0$.\n2.  Axial flow: The velocity has only a component along the axis of the cylinder, so $v_r = 0$ and $v_\\theta = 0$.\n3.  Fully developed flow: The velocity profile does not change along the length of the vessel, which implies $\\frac{\\partial v_z}{\\partial z} = 0$. Therefore, $v_z$ can only be a function of $r$ and $\\theta$.\n4.  Axisymmetric flow: Due to the cylindrical symmetry of the vessel and the flow, there is no dependence on the angular coordinate, so $\\frac{\\partial}{\\partial \\theta} = 0$. This means $v_z = v_z(r)$.\n\nThe incompressibility condition is expressed by the continuity equation, $\\nabla \\cdot \\vec{v} = 0$. In cylindrical coordinates, this is:\n$$ \\frac{1}{r}\\frac{\\partial(r v_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial v_\\theta}{\\partial \\theta} + \\frac{\\partial v_z}{\\partial z} = 0 $$\nWith our assumptions, this equation simplifies to $0+0+0=0$, which is automatically satisfied.\n\nNext, we examine the momentum equations. The $r$-momentum and $\\theta$-momentum equations show that $\\frac{\\partial p}{\\partial r} = 0$ and $\\frac{\\partial p}{\\partial \\theta} = 0$, meaning the pressure $p$ is a function of $z$ only, i.e., $p=p(z)$. The $z$-momentum equation under our assumptions simplifies significantly:\n$$ 0 = -\\frac{dp}{dz} + \\mu \\left( \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{dv_z}{dr}\\right) \\right) $$\nSince $v_z$ depends only on $r$ and $p$ depends only on $z$, for this equality to hold, both sides must be equal to a constant. This implies that the pressure gradient $\\frac{dp}{dz}$ must be constant along the vessel. We can rearrange the equation as:\n$$ \\frac{d}{dr}\\left(r \\frac{dv_z}{dr}\\right) = \\frac{r}{\\mu} \\frac{dp}{dz} $$\nIntegrating once with respect to $r$ yields:\n$$ r \\frac{dv_z}{dr} = \\frac{r^2}{2\\mu} \\frac{dp}{dz} + C_1 $$\nDividing by $r$ and integrating again gives the velocity profile:\n$$ v_z(r) = \\frac{r^2}{4\\mu} \\frac{dp}{dz} + C_1 \\ln(r) + C_2 $$\nTo determine the integration constants $C_1$ and $C_2$, we apply the physical boundary conditions:\n1.  The velocity must be finite at the centerline of the vessel ($r=0$). Since $\\ln(r) \\to -\\infty$ as $r \\to 0$, we must have $C_1 = 0$.\n2.  The no-slip condition at the vessel wall ($r=R$, where $R$ is the vessel radius) requires the fluid velocity to be zero: $v_z(R) = 0$.\nApplying the no-slip condition:\n$$ 0 = \\frac{R^2}{4\\mu} \\frac{dp}{dz} + C_2 \\implies C_2 = -\\frac{R^2}{4\\mu} \\frac{dp}{dz} $$\nSubstituting the constants back, we obtain the parabolic velocity profile for Poiseuille flow:\n$$ v_z(r) = \\frac{1}{4\\mu} \\frac{dp}{dz} (r^2 - R^2) $$\nThe constant pressure gradient can be expressed in terms of the pressures $p_{in}$ at the inlet ($z=0$) and $p_{out}$ at the outlet ($z=L$) of a vessel of length $L$: $\\frac{dp}{dz} = \\frac{p_{out} - p_{in}}{L} = -\\frac{\\Delta p}{L}$, where $\\Delta p = p_{in} - p_{out}$ is the pressure drop. The velocity profile is thus:\n$$ v_z(r) = \\frac{\\Delta p}{4\\mu L} (R^2 - r^2) $$\nThe volumetric flow rate, $Q$, is obtained by integrating the velocity profile over the vessel's cross-sectional area:\n$$ Q = \\int_{0}^{R} v_z(r) \\, 2\\pi r \\, dr = \\frac{2\\pi \\Delta p}{4\\mu L} \\int_{0}^{R} (R^2 - r^2)r \\, dr $$\n$$ Q = \\frac{\\pi \\Delta p}{2\\mu L} \\left[ \\frac{R^2r^2}{2} - \\frac{r^4}{4} \\right]_0^R = \\frac{\\pi \\Delta p}{2\\mu L} \\left(\\frac{R^4}{2} - \\frac{R^4}{4}\\right) = \\frac{\\pi R^4}{8\\mu L} \\Delta p $$\nThis is the Hagen-Poiseuille equation. It can be written as $Q = K \\cdot \\Delta p$, where $K = \\frac{\\pi R^4}{8\\mu L}$ is the hydraulic conductance of the vessel. This relationship is analogous to Ohm's law in electrical circuits.\n\nFor a network of vessels, we model the system as a graph where nodes represent junctions and boundary points, and edges represent vessels. The nodes are partitioned into internal nodes $N_I$, where the pressure is unknown, and boundary nodes $N_B$, where the pressure is specified (Dirichlet boundary conditions). For each vessel connecting nodes $i$ and $j$, the flow from $i$ to $j$ is $Q_{ij} = K_{ij}(p_i - p_j)$, where $p_i$ and $p_j$ are the nodal pressures and $K_{ij}$ is the conductance of the vessel.\n\nAt each internal node $k \\in N_I$, conservation of mass for an incompressible fluid requires that the sum of volumetric flows into the node equals the sum of flows out of it. Equivalently, the net flow out of the node is zero:\n$$ \\sum_{j \\in \\text{adj}(k)} Q_{kj} = 0 $$\nwhere $\\text{adj}(k)$ is the set of nodes adjacent to node $k$. Substituting the Hagen-Poiseuille relation:\n$$ \\sum_{j \\in \\text{adj}(k)} K_{kj} (p_k - p_j) = 0 $$\nThis equation can be rearranged to form a linear equation in terms of the unknown pressures:\n$$ \\left( \\sum_{j \\in \\text{adj}(k)} K_{kj} \\right) p_k - \\sum_{j \\in \\text{adj}(k), j \\in N_I} K_{kj} p_j = \\sum_{j \\in \\text{adj}(k), j \\in N_B} K_{kj} p_j $$\nWe have one such equation for each internal node. This forms a system of linear equations, $A\\mathbf{p}_I = \\mathbf{b}$, where $\\mathbf{p}_I$ is the vector of unknown pressures at the internal nodes. The system matrix $A$ and the right-hand side vector $\\mathbf{b}$ are constructed as follows:\n-   For each internal node $k$ (corresponding to row $i$ in the matrix):\n    -   The diagonal element is $A_{ii} = \\sum_{j \\in \\text{adj}(k)} K_{kj}$.\n    -   The off-diagonal element $A_{ij}$ (where internal node $l$ corresponds to column $j$) is $A_{ij} = -K_{kl}$ if nodes $k$ and $l$ are connected; otherwise, $A_{ij} = 0$.\n    -   The corresponding element of the vector $\\mathbf{b}$ is $b_i = \\sum_{j \\in \\text{adj}(k), j \\in N_B} K_{kj}p_j$, which represents the influence of the fixed-pressure boundary nodes.\n\nThe numerical algorithm is as follows:\n1.  Parse the network topology, vessel parameters ($L, R$), fluid viscosity $\\mu$, and boundary pressures.\n2.  Categorize nodes as internal or boundary. Let the number of internal nodes be $n_{int}$.\n3.  For each vessel, compute its conductance $K$.\n4.  Construct the $n_{int} \\times n_{int}$ matrix $A$ and the $n_{int} \\times 1$ vector $\\mathbf{b}$ according to the rules derived above.\n5.  Solve the linear system $A\\mathbf{p}_I = \\mathbf{b}$ for the vector of internal pressures $\\mathbf{p}_I$.\n6.  Having determined all nodal pressures, calculate the total inlet flow. For each designated inlet node $s$, sum the flows in the vessels connected to it: $Q_s = \\sum_{j \\in \\text{adj}(s)} K_{sj}(p_s - p_j)$.\n7.  The total inlet flow for the network is the sum of flows from all inlet nodes.\nThis algorithm provides a complete solution to the problem, grounded in fundamental principles and resulting in a well-posed numerical task.",
            "answer": "```python\nimport numpy as np\n\ndef format_result(value: float) - str:\n    \"\"\"Formats a float to a string with 8 significant digits.\"\"\"\n    return \"{:.8g}\".format(value)\n\ndef solve_network(\n    nodes: list[int],\n    vessels: list[tuple[int, int, float, float]],\n    boundary_pressures: dict[int, float],\n    viscosity: float,\n    inlet_nodes: list[int]\n) - float:\n    \"\"\"\n    Solves for pressures and flows in a vascular network.\n\n    Args:\n        nodes: A list of all node IDs.\n        vessels: A list of tuples, each representing a vessel: (node1, node2, length, radius).\n        boundary_pressures: A dictionary mapping boundary node IDs to their pressure values.\n        viscosity: The dynamic viscosity of the fluid.\n        inlet_nodes: A list of node IDs designated as inlets.\n\n    Returns:\n        The total volumetric flow rate from all inlet nodes.\n    \"\"\"\n    internal_nodes = sorted([n for n in nodes if n not in boundary_pressures])\n    num_internal = len(internal_nodes)\n\n    # Build adjacency list and calculate conductance for each vessel\n    adj = {n: [] for n in nodes}\n    conductances = {}\n    for n1, n2, length, radius in vessels:\n        if length = 0 or radius = 0:\n            raise ValueError(\"Vessel length and radius must be positive.\")\n        # Hydraulic conductance from Hagen-Poiseuille equation: K = pi*R^4 / (8*mu*L)\n        K = (np.pi * radius**4) / (8 * viscosity * length)\n        adj[n1].append(n2)\n        adj[n2].append(n1)\n        conductances[(n1, n2)] = K\n        conductances[(n2, n1)] = K\n\n    # Initialize the full pressure dictionary with boundary values\n    pressures = boundary_pressures.copy()\n\n    # If there are internal nodes, set up and solve the linear system for their pressures\n    if num_internal  0:\n        # Map internal node IDs to matrix indices (0 to num_internal-1)\n        internal_node_map = {node_id: i for i, node_id in enumerate(internal_nodes)}\n        \n        A = np.zeros((num_internal, num_internal))\n        b = np.zeros(num_internal)\n\n        for i, node_k in enumerate(internal_nodes):\n            # For each internal node k, construct the i-th row of the system A*p=b\n            # based on conservation of mass: sum(Q_kj) = 0 for all neighbors j.\n            for neighbor_j in adj[node_k]:\n                K_kj = conductances.get((node_k, neighbor_j))\n                \n                # Diagonal element: A[i,i] is the sum of conductances of all vessels connected to node_k\n                A[i, i] += K_kj\n                \n                # Off-diagonal elements\n                if neighbor_j in internal_nodes:\n                    # Neighbor is another internal node, contributes to the matrix A\n                    j = internal_node_map[neighbor_j]\n                    A[i, j] -= K_kj\n                else:\n                    # Neighbor is a boundary node, contributes to the vector b\n                    b[i] += K_kj * boundary_pressures[neighbor_j]\n        \n        # Solve the linear system A * p_internal = b\n        try:\n            internal_p_solution = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            raise RuntimeError(\"The linear system for nodal pressures is singular.\")\n\n        # Add the solved internal pressures to the main pressure dictionary\n        for i, node_id in enumerate(internal_nodes):\n            pressures[node_id] = internal_p_solution[i]\n\n    # Calculate the total volumetric flow leaving the inlet nodes\n    total_inlet_flow = 0.0\n    for inlet_node in inlet_nodes:\n        if inlet_node not in pressures:\n            continue\n        for neighbor in adj[inlet_node]:\n            # Flow from inlet_node to neighbor: Q = K * (P_inlet - P_neighbor)\n            total_inlet_flow += conductances[(inlet_node, neighbor)] * \\\n                                (pressures[inlet_node] - pressures[neighbor])\n            \n    return total_inlet_flow\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the vascular network solver.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": [0, 1],\n            \"vessels\": [(0, 1, 0.02, 0.001)],\n            \"boundary_pressures\": {0: 12000.0, 1: 10000.0},\n            \"viscosity\": 3.5e-3,\n            \"inlet_nodes\": [0]\n        },\n        {\n            \"nodes\": [0, 1, 2, 3],\n            \"vessels\": [\n                (0, 1, 0.02, 0.001), \n                (1, 2, 0.03, 0.0008), \n                (1, 3, 0.03, 0.0008)\n            ],\n            \"boundary_pressures\": {0: 12000.0, 2: 10000.0, 3: 10000.0},\n            \"viscosity\": 3.5e-3,\n            \"inlet_nodes\": [0]\n        },\n        {\n            \"nodes\": [0, 1, 2, 3],\n            \"vessels\": [\n                (0, 1, 0.02, 0.0007),\n                (1, 2, 0.20, 0.0002),\n                (1, 3, 0.02, 0.0010)\n            ],\n            \"boundary_pressures\": {0: 12000.0, 2: 10000.0, 3: 10000.0},\n            \"viscosity\": 3.5e-3,\n            \"inlet_nodes\": [0]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        flow = solve_network(**case)\n        results.append(format_result(flow))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}