{
    "hands_on_practices": [
        {
            "introduction": "经典的Womersley解是研究脉动流的一个理想化模型。理解其基本假设，例如“充分发展流”，对于正确应用该模型至关重要。本练习通过量级分析，探讨了在何种条件下可以忽略空间入口效应，这是证明该模型合理性的关键一步，有助于您建立坚实的概念基础 。",
            "id": "4200865",
            "problem": "一根半径为 $R$、长度为 $L$ 的直的、刚性的、轴对称的恒定截面管道，在角频率为 $\\omega$ 的时谐轴向压力梯度作用下，输送着密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体。运动粘度为 $\\nu = \\mu/\\rho$。Womersley 数 $\\alpha$ 定义为 $\\alpha = R\\sqrt{\\omega/\\nu}$，基于峰值振荡中心线速度 $U$ 的雷诺数 $Re$ 为 $Re = UR/\\nu$。考虑经典的 Womersley 设定，其中在充分发展区，轴向速度场 $u(r,t)$ 被假定为轴向不变的（即与轴向坐标 $z$ 无关），并且径向速度 $v_r$ 被假定为零。\n\n从不可压缩流体的连续性方程和柱坐标系下的 Navier-Stokes 动量方程出发，并以一根具有不可渗透壁面的长直刚性管道中的轴对称、层流、周期性稳态流动为基本假设，按如下方式论证轴向不变性以及忽略入口和出口损失的合理性：\n\n- 使用连续性方程，确定在具有不可渗透壁面的充分发展的轴对称流中，$\\partial u/\\partial z = 0$ 对 $v_r$ 的影响。\n- 使用轴向动量方程，确定当轴向不变性成立时哪些项仍然存在，并解释在这些假设下对流惯性的作用。\n- 在两端局部次要损失（通过损失系数 $K$ 建模，压力幅值标度为 $\\Delta p_{\\text{minor}} \\sim K\\,\\rho U^2$）与轴向动量方程中主导平衡所隐含的沿长度 $L$ 的分布式压降之间进行量级比较。展示这种比较如何导出在两个渐近区域中忽略入口/出口损失的准则：$\\alpha \\ll 1$（粘性主导）和 $\\alpha \\gg 1$（非定常惯性主导）。用 $L/R$、$Re$、$\\alpha$ 和 $K$ 表示这些准则。\n\n哪个选项最准确地陈述了在推导经典 Womersley 解时忽略入口和出口损失的理由，并指出了实现轴向不变性所需的最小假设？\n\nA. 只要分析限于一根长直刚性恒定半径管道中远离两端的位置，就可以忽略入口和出口损失，该管道中存在轴对称、层流、不可压缩的牛顿流，并受到在 $z$ 方向上均匀的时谐压力梯度的作用。轴向不变性要求 $\\partial u/\\partial z = 0$ 和不可渗透的壁面，根据连续性方程可推得 $v_r = 0$，从而从轴向动量平衡中消除了对流惯性，剩下非定常惯性、压力梯度和径向粘性扩散。当次要损失标度为 $\\Delta p_{\\text{minor}} \\sim K\\,\\rho U^2$ 时，次要损失与分布式损失之比为 $\\mathcal{M} \\equiv \\Delta p_{\\text{minor}}/(|\\partial p/\\partial z|L)$。在粘性主导区域 $\\alpha \\ll 1$ 中，$|\\partial p/\\partial z| \\sim \\mu U/R^2$，因此 $\\mathcal{M} \\sim K\\,Re\\,(R/L)$，当 $L/R \\gg K\\,Re$ 时，入口/出口损失可以忽略。在非定常惯性主导区域 $\\alpha \\gg 1$ 中，$|\\partial p/\\partial z| \\sim \\rho\\,\\omega\\,U$，因此 $\\mathcal{M} \\sim K\\,Re/\\big(\\alpha^2\\,(L/R)\\big)$，当 $L/R \\gg K\\,Re/\\alpha^2$ 时，损失可以忽略。\n\nB. 只有当 Womersley 数满足 $\\alpha = 0$ 以使流动为准稳态时，才能忽略入口和出口损失，并且通过将轴向压力梯度设为零（$\\partial p/\\partial z = 0$），以及湍流使速度剖面均匀化来实现轴向不变性；在这些条件下，对流惯性占主导，且两端不形成边界层。\n\nC. 如果流体是轻度可压缩的，且管道壁是柔性的，以使压力的轴向变化被壁面运动所抵消，则可以忽略入口和出口损失；此时轴向不变性由锥形几何结构实现，该结构沿 $z$ 重新分布动量，并且当 $L/R$ 为一阶量级时次要损失最小，因为短管排除了入口区的形成。\n\nD. 对于任何管道长度和雷诺数，仅凭一个大的 Womersley 数就能保证入口和出口损失消失，因为振荡边界层很薄；轴向不变性要求在壁面处有滑移边界条件，以抑制粘性扩散并保持一个与 $z$ 无关的均匀核心速度。\n\nE. 如果选择轴向压力梯度在空间上变化以精确平衡末端损失，则可以忽略入口和出口损失；轴向不变性的产生是因为沿轴向的粘性扩散使 $u(z,t)$ 均匀化，并且对流项因对称性而抵消，而无需 $v_r = 0$ 或壁面不可渗透。",
            "solution": "该问题要求通过一个三部分的推理过程来证明 Womersley 流动假设的合理性，然后从选项中选出最佳描述。\n\n**1. 轴向不变性对径向速度的影响**\n\n对于不可压缩流体，在柱坐标系 $(r, \\theta, z)$ 中的质量守恒由连续性方程表示。对于轴对称流（其中所有量都与方位角 $\\theta$ 无关，因此 $\\partial/\\partial\\theta = 0$），该方程简化为：\n$$ \\frac{1}{r} \\frac{\\partial (r v_r)}{\\partial r} + \\frac{\\partial u}{\\partial z} = 0 $$\n其中 $v_r$ 是径向速度，$u$ 是轴向速度。\n\n问题陈述假设在充分发展的流动中，轴向速度是轴向不变的，这意味着轴向速度不随轴向坐标 $z$ 变化：\n$$ \\frac{\\partial u}{\\partial z} = 0 $$\n将此代入连续性方程，得到：\n$$ \\frac{1}{r} \\frac{\\partial (r v_r)}{\\partial r} = 0 $$\n这意味着 $\\frac{\\partial (r v_r)}{\\partial r} = 0$。对该表达式关于 $r$ 积分，得到：\n$$ r v_r(r, t) = C(t) $$\n其中 $C(t)$ 是一个只与时间有关的任意函数。因此，径向速度为：\n$$ v_r(r, t) = \\frac{C(t)}{r} $$\n为了使速度场在物理上是真实的，中心线（$r=0$）处的速度必须是有限的。表达式 $C(t)/r$ 在 $r=0$ 处是奇异的，除非对于所有时间 $t$ 都有 $C(t) = 0$。因此，物理有界性要求 $C(t) = 0$。这导出的结论是：\n$$ v_r(r,t) = 0 $$\n这一结果与不可渗透壁面的边界条件 $v_r(R,t) = 0$ 是一致的。因此，轴向不变的轴向速度剖面假设，结合连续性方程和中心线速度有限的物理要求，必然意味着径向速度处处为零。\n\n**2. 轴向动量方程与对流惯性**\n\n在轴对称（$\\partial/\\partial\\theta = 0$）假设下，不可压缩牛顿流体在柱坐标系中的 Navier-Stokes 动量方程的轴向分量是：\n$$ \\rho \\left( \\underbrace{\\frac{\\partial u}{\\partial t}}_{\\text{非定常惯性}} + \\underbrace{v_r \\frac{\\partial u}{\\partial r} + u \\frac{\\partial u}{\\partial z}}_{\\text{对流惯性}} \\right) = - \\underbrace{\\frac{\\partial p}{\\partial z}}_{\\text{压力梯度}} + \\mu \\left( \\underbrace{\\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right)}_{\\text{径向粘性扩散}} + \\underbrace{\\frac{\\partial^2 u}{\\partial z^2}}_{\\text{轴向粘性扩散}} \\right) $$\n我们应用经典 Womersley 流的条件：\n- 轴向不变性：$\\partial u/\\partial z = 0$。这也意味着 $\\partial^2 u/\\partial z^2 = 0$。\n- 零径向速度（如上所述）：$v_r = 0$。\n\n将这些条件代入动量方程：\n- 对流惯性项 $v_r \\frac{\\partial u}{\\partial r}$ 变为 $0 \\cdot \\frac{\\partial u}{\\partial r} = 0$。\n- 对流惯性项 $u \\frac{\\partial u}{\\partial z}$ 变为 $u \\cdot 0 = 0$。\n- 轴向粘性扩散项 $\\frac{\\partial^2 u}{\\partial z^2}$ 也为 $0$。\n\n因此，非线性的对流惯性项被完全消除。轴向动量方程简化为一个线性偏微分方程：\n$$ \\rho \\frac{\\partial u}{\\partial t} = - \\frac{\\partial p}{\\partial z} + \\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial u}{\\partial r} \\right) $$\n该方程描述了三项之间的平衡：非定常（局部）惯性、轴向压力梯度和径向粘性扩散。\n\n**3. 忽略入口/出口损失的量级分析**\n\nWomersley 解适用于充分发展区，这要求管道足够长，以便入口和出口效应在其大部分长度上可以忽略不计。我们比较两端局部次要损失的压降 $\\Delta p_{\\text{minor}}$ 与管道长度 $L$ 上的分布式压降 $\\Delta p_{\\text{distrib}}$ 的量级。\n\n- 次要损失建模为 $\\Delta p_{\\text{minor}} \\sim K\\,\\rho U^2$，其中 $K$ 是一个损失系数。\n- 分布式压降为 $\\Delta p_{\\text{distrib}} = |\\frac{\\partial p}{\\partial z}| L$。\n\n我们需要使用简化的动量方程来估计 $|\\frac{\\partial p}{\\partial z}|$。特征尺度为：时间 $\\sim 1/\\omega$，速度 $\\sim U$，径向长度 $\\sim R$。\n惯性项和粘性项的量级为：\n- 非定常惯性：$\\rho \\frac{\\partial u}{\\partial t} \\sim \\rho \\frac{U}{1/\\omega} = \\rho \\omega U$。\n- 粘性扩散：$\\mu \\frac{1}{r} \\frac{\\partial}{\\partial r} (r \\frac{\\partial u}{\\partial r}) \\sim \\frac{\\mu U}{R^2}$。\n\n非定常惯性与粘性效应之比是 Womersley 数的平方：\n$$ \\frac{\\text{惯性}}{\\text{粘性}} \\sim \\frac{\\rho \\omega U}{\\mu U / R^2} = \\frac{\\rho \\omega R^2}{\\mu} = \\frac{\\omega R^2}{\\nu} = \\alpha^2 $$\n\n我们考虑两个渐近区域：\n\n**情况1：粘性主导（准稳态）区域，$\\alpha \\ll 1$ (或 $\\alpha^2 \\ll 1$)**\n在此极限下，粘性项主导非定常惯性项。动量方程中的主导平衡是压力梯度和粘性力之间的平衡：\n$$ |\\frac{\\partial p}{\\partial z}| \\sim \\frac{\\mu U}{R^2} $$\n次要损失与分布式损失之比 $\\mathcal{M}$ 为：\n$$ \\mathcal{M} = \\frac{\\Delta p_{\\text{minor}}}{\\Delta p_{\\text{distrib}}} \\sim \\frac{K \\rho U^2}{(\\mu U / R^2) L} = \\frac{K \\rho U R^2}{\\mu L} = K \\left( \\frac{U R}{\\nu} \\right) \\frac{R}{L} = K \\cdot Re \\cdot \\frac{R}{L} $$\n为了使入口/出口损失可以忽略，我们要求 $\\mathcal{M} \\ll 1$，这导出条件：\n$$ L/R \\gg K \\cdot Re $$\n\n**情况2：非定常惯性主导区域，$\\alpha \\gg 1$ (或 $\\alpha^2 \\gg 1$)**\n在此极限下，非定常惯性项主导粘性项。主导平衡是压力梯度和非定常惯性之间的平衡：\n$$ |\\frac{\\partial p}{\\partial z}| \\sim \\rho \\omega U $$\n次要损失与分布式损失之比为：\n$$ \\mathcal{M} = \\frac{\\Delta p_{\\text{minor}}}{\\Delta p_{\\text{distrib}}} \\sim \\frac{K \\rho U^2}{(\\rho \\omega U) L} = \\frac{K U}{\\omega L} $$\n为了用给定的无量纲数表示，我们使用 $Re = UR/\\nu$ 和 $\\alpha^2 = \\omega R^2/\\nu$：\n$$ \\mathcal{M} \\sim \\frac{K}{\\omega L} \\frac{U R \\nu}{R \\nu} = \\frac{K}{L} \\frac{Re \\cdot \\nu}{R} \\frac{1}{\\omega} = \\frac{K \\cdot Re}{L/R} \\frac{\\nu}{\\omega R^2} = \\frac{K \\cdot Re}{(L/R) \\alpha^2} $$\n为了使入口/出口损失可以忽略，我们要求 $\\mathcal{M} \\ll 1$，这导出条件：\n$$ L/R \\gg \\frac{K \\cdot Re}{\\alpha^2} $$\n\n### 选项评估\n\n**A. 只要分析限于一根长直刚性恒定半径管道中远离两端的位置... 轴向不变性要求 $\\partial u/\\partial z = 0$ 和不可渗透的壁面，根据连续性方程可推得 $v_r = 0$，从而从轴向动量平衡中消除了对流惯性，剩下非定常惯性、压力梯度和径向粘性扩散。当次要损失标度为 $\\Delta p_{\\text{minor}} \\sim K\\,\\rho U^2$ 时... 在粘性主导区域 $\\alpha \\ll 1$ 中，$|\\partial p/\\partial z| \\sim \\mu U/R^2$，因此 $\\mathcal{M} \\sim K\\,Re\\,(R/L)$，当 $L/R \\gg K\\,Re$ 时，入口/出口损失可以忽略。在非定常惯性主导区域 $\\alpha \\gg 1$ 中，$|\\partial p/\\partial z| \\sim \\rho\\,\\omega\\,U$，因此 $\\mathcal{M} \\sim K\\,Re/\\big(\\alpha^2\\,(L/R)\\big)$，当 $L/R \\gg K\\,Re/\\alpha^2$ 时，损失可以忽略。**\n- **结论：** 正确。该选项正确地陈述了轴向不变性的条件（由 $\\partial u/\\partial z=0$ 和连续性方程推出 $v_r=0$）、动量方程的相应简化（对流惯性消失），并准确地再现了整个量级分析以及在低 $\\alpha$ 和高 $\\alpha$ 区域忽略入口/出口损失的准则，与我们的推导完全吻合。\n\n**B. 只有当 Womersley 数满足 $\\alpha = 0$ 以使流动为准稳态时，才能忽略入口和出口损失，并且通过将轴向压力梯度设为零（$\\partial p/\\partial z = 0$），以及湍流使速度剖面均匀化来实现轴向不变性；在这些条件下，对流惯性占主导，且两端不形成边界层。**\n- **结论：** 错误。该选项在多个基本点上都是错误的。Womersley 解是针对振荡流（$\\alpha > 0$）的。零压力梯度意味着没有流动。流动被假定为层流，而非湍流。对流惯性是可忽略的，而非主导的。\n\n**C. 如果流体是轻度可压缩的，且管道壁是柔性的，以使压力的轴向变化被壁面运动所抵消，则可以忽略入口和出口损失；此时轴向不变性由锥形几何结构实现，该结构沿 $z$ 重新分布动量，并且当 $L/R$ 为一阶量级时次要损失最小，因为短管排除了入口区的形成。**\n- **结论：** 错误。该选项与问题的基本前提（不可压缩流体、刚性管道、恒定半径）相矛盾。锥形几何结构将违反轴向不变性。短管（$L/R \\sim 1$）受入口效应主导，而非不受其影响。\n\n**D. 对于任何管道长度和雷诺数，仅凭一个大的 Womersley 数就能保证入口和出口损失消失，因为振荡边界层很薄；轴向不变性要求在壁面处有滑移边界条件，以抑制粘性扩散并保持一个与 $z$ 无关的均匀核心速度。**\n- **结论：** 错误。一个大的 $\\alpha$ 并不能保证在*任何*管道长度下入口效应都可忽略；管道仍需足够长（$L/R \\gg K \\cdot Re / \\alpha^2$）。Womersley 解使用无滑移边界条件，而不是滑移边界条件。\n\n**E. 如果选择轴向压力梯度在空间上变化以精确平衡末端损失，则可以忽略入口和出口损失；轴向不变性的产生是因为沿轴向的粘性扩散使 $u(z,t)$ 均匀化，并且对流项因对称性而抵消，而无需 $v_r = 0$ 或壁面不可渗透。**\n- **结论：** 错误。经典的 Womersley 模型假定压力梯度在空间上是均匀的（$\\partial p/\\partial z$ 仅是时间的函数）。轴向粘性扩散由于 $\\partial u/\\partial z = 0$ 的假设而被忽略，而非被依赖。对流项是因为 $v_r=0$ 和 $\\partial u/\\partial z=0$ 而消失，这需要壁面不可渗透和轴向不变性。\n\n基于详细的推导，选项 A 是唯一一个准确而全面地描述了经典 Womersley 流动模型假设的物理推理和数学证明的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在已证明合理的充分发展流模型基础上，本练习将深入探讨Womersley速度剖面的详细结构。您的任务是推导时间平均动能密度，这将揭示能量在血管半径上的分布规律。这项解析练习不仅能提升您的数学推导能力，还能让您更深刻地理解Womersley数（$\\alpha$）对流体物理特性的影响 。",
            "id": "4200830",
            "problem": "考虑一个半径为 $R$ 的刚性、直的、轴对称的圆形容器，其中包含密度为 $\\rho$、动力粘度为 $\\mu$ 的不可压缩牛顿流体。轴向流动是层流且充分发展的（在所关注的轴向位置，入口效应可以忽略不计）。驱动轴向压强梯度随时间谐波变化，$-\\partial p/\\partial z = \\Re\\{\\hat{G}\\,\\exp(i\\omega t)\\}$，其中 $\\hat{G}$ 是一个复振幅，$\\omega$ 是角频率。Womersley 数定义为 $\\alpha = R\\sqrt{\\omega \\rho/\\mu}$。从柱坐标系下的不可压缩 Navier–Stokes 方程出发，在所述假设下，推导轴向速度分布的复振幅，然后计算在一个振荡周期内平均的时间平均动能密度，作为径向坐标 $r$ 的函数。将您的最终结果表示为时间平均动能密度径向分布的单个闭式解析表达式，该表达式应使用 $\\rho$、$\\omega$、$R$、$r$、$\\alpha$、$\\hat{G}$ 以及零阶第一类 Bessel 函数 $J_0(\\cdot)$ 来表示。如果要对该表达式进行数值计算，请将动能密度以焦耳每立方米（Joules per cubic meter）为单位表示。在您的推导中，解释当 $\\alpha \\to 0$ 和 $\\alpha \\to \\infty$ 时径向分布的极限行为，并简要评论在这些极限情况下，忽略入口效应的假设是如何成立或被违反的。最终答案必须是单个闭式解析表达式（不得包含不等式或待解方程）。",
            "solution": "我们从柱坐标 $(r, \\theta, z)$ 下的不可压缩牛顿流体的 Navier-Stokes 方程开始。给定轴对称（$\\frac{\\partial}{\\partial \\theta} = 0$, $v_\\theta=0$）和充分发展流（$\\frac{\\partial v_z}{\\partial z} = 0$）的假设，连续性方程 $\\nabla \\cdot \\mathbf{v} = 0$ 意味着 $v_r = 0$。速度场是纯轴向的，并且仅是半径和时间的函数，$\\mathbf{v} = v_z(r, t) \\mathbf{e}_z$。在这些条件下，动量方程的轴向分量简化为：\n$$ \\rho \\frac{\\partial v_z}{\\partial t} = -\\frac{\\partial p}{\\partial z} + \\mu \\left( \\frac{\\partial^2 v_z}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial v_z}{\\partial r} \\right) $$\n压强梯度给定为 $-\\frac{\\partial p}{\\partial z} = \\Re\\{\\hat{G}\\,\\exp(i\\omega t)\\}$。我们寻求形式为 $v_z(r, t) = \\Re\\{\\hat{v}_z(r)\\,\\exp(i\\omega t)\\}$ 的解，其中 $\\hat{v}_z(r)$ 是速度的复振幅。将这些形式代入动量方程，得到关于 $\\hat{v}_z(r)$ 的常微分方程：\n$$ \\rho (i\\omega \\hat{v}_z) = \\hat{G} + \\mu \\left( \\frac{d^2 \\hat{v}_z}{d r^2} + \\frac{1}{r} \\frac{d \\hat{v}_z}{d r} \\right) $$\n重新整理得到一个零阶非齐次修正 Bessel 方程：\n$$ \\frac{d^2 \\hat{v}_z}{d r^2} + \\frac{1}{r} \\frac{d \\hat{v}_z}{d r} - \\frac{i\\omega\\rho}{\\mu} \\hat{v}_z = -\\frac{\\hat{G}}{\\mu} $$\n我们定义一个复波数 $k = \\sqrt{i\\omega\\rho/\\mu}$。方程为 $\\frac{d^2 \\hat{v}_z}{d r^2} + \\frac{1}{r} \\frac{d \\hat{v}_z}{d r} - k^2 \\hat{v}_z = -\\frac{\\hat{G}}{\\mu}$。\n通解是一个特解 $\\hat{v}_{z,p} = \\frac{\\hat{G}}{k^2\\mu} = \\frac{\\hat{G}}{i\\omega\\rho}$ 与齐次解 $\\hat{v}_{z,h}(r) = C_1 I_0(kr) + C_2 K_0(kr)$ 的和，其中 $I_0$ 和 $K_0$ 分别是零阶第一类和第二类修正 Bessel 函数。\n\n解必须满足两个边界条件：\n1. 在中心线 $r=0$ 处，速度必须是有限的。由于当 $r \\to 0$ 时 $K_0(kr) \\to \\infty$，我们必须设 $C_2=0$。\n2. 在容器壁处的无滑移条件，$v_z(R, t) = 0$，意味着复振幅 $\\hat{v}_z(R) = 0$。\n\n将无滑移条件应用于通解 $\\hat{v}_z(r) = C_1 I_0(kr) + \\frac{\\hat{G}}{i\\omega\\rho}$：\n$$ C_1 I_0(kR) + \\frac{\\hat{G}}{i\\omega\\rho} = 0 \\implies C_1 = -\\frac{\\hat{G}}{i\\omega\\rho I_0(kR)} $$\n因此，速度分布的复振幅为：\n$$ \\hat{v}_z(r) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{I_0(kr)}{I_0(kR)} \\right) $$\n为了用 Womersley 数 $\\alpha = R\\sqrt{\\omega\\rho/\\mu}$ 和 Bessel 函数 $J_0$ 来表示，我们使用关系式 $k = \\sqrt{i}\\frac{\\alpha}{R}$ 和 $I_0(z) = J_0(i^{-1}z)$。更标准的做法是，使用 $I_0(z) = J_0(iz)$ 和 $k=\\sqrt{-i\\omega\\rho/\\mu}$ 的定义，或直接使用 $I_0(z) = J_0(-iz)$。令 $\\gamma = i^{3/2}\\alpha = i\\sqrt{i}\\alpha$。我们可以使用 $J_0(i^{3/2}z)=J_0(-i \\cdot i^{1/2}z) = I_0(i^{1/2}z)$。速度振幅可以表示为：\n$$ \\hat{v}_z(r) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right) $$\n\n接下来，我们计算时间平均动能密度 $\\langle E_k(r) \\rangle$。瞬时动能密度为 $E_k(r, t) = \\frac{1}{2}\\rho v_z(r, t)^2$。一个谐波量 $f(t) = \\Re\\{\\hat{f}\\exp(i\\omega t)\\}$ 的平方在一个周期 $T = 2\\pi/\\omega$ 内的时间平均值为 $\\langle f(t)^2 \\rangle = \\frac{1}{2}|\\hat{f}|^2$。\n因此，时间平均动能密度为：\n$$ \\langle E_k(r) \\rangle = \\frac{1}{2}\\rho \\langle v_z(r, t)^2 \\rangle = \\frac{1}{2}\\rho \\left(\\frac{1}{2}|\\hat{v}_z(r)|^2\\right) = \\frac{1}{4}\\rho |\\hat{v}_z(r)|^2 $$\n代入 $\\hat{v}_z(r)$ 的表达式：\n$$ \\langle E_k(r) \\rangle = \\frac{1}{4}\\rho \\left| \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right) \\right|^2 $$\n$$ = \\frac{1}{4}\\rho \\frac{|\\hat{G}|^2}{|i\\omega\\rho|^2} \\left| 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right|^2 = \\frac{\\rho |\\hat{G}|^2}{4(\\omega\\rho)^2} \\left| 1 - \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\right|^2 $$\n简化前置因子并代入 $\\gamma=i^{3/2}\\alpha$ 得到最终表达式：\n$$ \\langle E_k(r) \\rangle = \\frac{|\\hat{G}|^2}{4\\omega^2\\rho} \\left| 1 - \\frac{J_0(i^{3/2} \\alpha \\frac{r}{R})}{J_0(i^{3/2} \\alpha)} \\right|^2 $$\n该表达式的单位是 $(\\text{Pa}/\\text{m})^2 / ((\\text{rad}/\\text{s})^2 \\cdot \\text{kg}/\\text{m}^3)$，简化为 $\\text{kg}/(\\text{m}\\cdot\\text{s}^2)$，等价于 $(\\text{kg}\\cdot\\text{m}/\\text{s}^2)/\\text{m}^3 = \\text{N}\\cdot\\text{m}/\\text{m}^3 = \\text{J}/\\text{m}^3$，符合要求。\n\n### **极限行为分析**\n\n**情况1：低 Womersley 数 ($\\alpha \\to 0$)**\n此极限对应于低频或高粘度（准稳态流动）。对于小自变量 $z$，$J_0(z) \\approx 1 - z^2/4$。令 $\\gamma = i^{3/2}\\alpha$。\n$$ \\frac{J_0(\\gamma r/R)}{J_0(\\gamma)} \\approx \\frac{1 - (\\gamma r/R)^2/4}{1 - \\gamma^2/4} = \\frac{1 + i(\\alpha r/R)^2/4}{1 + i\\alpha^2/4} \\approx \\left(1 + \\frac{i\\alpha^2 r^2}{4R^2}\\right)\\left(1 - \\frac{i\\alpha^2}{4}\\right) \\approx 1 + \\frac{i\\alpha^2}{4}\\left(\\frac{r^2}{R^2} - 1\\right) $$\n将此代入 $\\hat{v}_z(r)$ 的表达式中：\n$$ \\hat{v}_z(r) \\approx \\frac{\\hat{G}}{i\\omega\\rho} \\left( 1 - \\left[1 + \\frac{i\\alpha^2}{4}\\left(\\frac{r^2}{R^2} - 1\\right)\\right] \\right) = \\frac{\\hat{G}}{i\\omega\\rho} \\left( -\\frac{i\\alpha^2}{4}\\left(\\frac{r^2}{R^2} - 1\\right) \\right) = \\frac{\\hat{G}\\alpha^2}{4\\omega\\rho}\\left(1 - \\frac{r^2}{R^2}\\right) $$\n使用 $\\alpha^2 = R^2\\omega\\rho/\\mu$，我们发现：\n$$ \\hat{v}_z(r) \\approx \\frac{\\hat{G}}{4\\omega\\rho} \\left( \\frac{R^2\\omega\\rho}{\\mu} \\right) \\left(1 - \\frac{r^2}{R^2}\\right) = \\frac{\\hat{G}R^2}{4\\mu}\\left(1 - \\frac{r^2}{R^2}\\right) $$\n这是稳态 Hagen-Poiseuille 流中熟悉的抛物线速度分布，表明流动瞬时地适应压强梯度。时间平均动能密度变为：\n$$ \\langle E_k(r) \\rangle \\approx \\frac{1}{4}\\rho \\left| \\frac{\\hat{G}R^2}{4\\mu}\\left(1 - \\frac{r^2}{R^2}\\right) \\right|^2 = \\frac{\\rho |\\hat{G}|^2 R^4}{64\\mu^2}\\left(1 - \\frac{r^2}{R^2}\\right)^2 $$\n\n**情况2：高 Womersley 数 ($\\alpha \\to \\infty$)**\n此极限对应于高频或低粘度，此时惯性占主导地位。对于大的 $|z|$，$J_0(z)$ 的渐近行为是 $J_0(z) \\sim \\sqrt{2/(\\pi z)} \\cos(z - \\pi/4)$，而 $I_0(z) = J_0(-iz) \\sim \\exp(z)/\\sqrt{2\\pi z}$。\n对于 $r",
            "answer": "$$\\boxed{\\frac{|\\hat{G}|^2}{4\\omega^2\\rho} \\left| 1 - \\frac{J_0\\left(i^{3/2} \\alpha \\frac{r}{R}\\right)}{J_0\\left(i^{3/2} \\alpha\\right)} \\right|^2}$$"
        },
        {
            "introduction": "解析解虽然强大，但通常仅限于稳态周期流等简化情况。本练习将引导您转向数值方法，以探索更复杂的脉动流“启动”阶段的瞬态动力学。通过实现一个有限差分求解器，您将计算壁面剪切应力的演变过程并量化瞬态超调等重要现象，从而展示计算方法在生物力学中的强大应用价值 。",
            "id": "4200886",
            "problem": "考虑将轴对称、不可压缩的牛顿流体血液建模为密度为常数 $\\rho$、动力粘度为 $\\mu$ 的流体，在半径为 $R$ 的长直刚性圆形血管中流动。假设轴向加速度可忽略不计，且无轴向变化，因此轴向速度场 $u(r,t)$ 满足在层流、充分发展、轴对称流动的假设下，于圆柱坐标系中从 Navier–Stokes 方程导出的一维轴向动量平衡方程：\n$$\\rho \\,\\frac{\\partial u}{\\partial t}(r,t) \\;=\\; -\\,G(t) \\;+\\; \\mu \\left( \\frac{\\partial^2 u}{\\partial r^2}(r,t) \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r}(r,t) \\right),$$\n对于 $0 \\le r \\le R$ 和 $t \\ge 0$，其中 $G(t)$ 是施加的轴向压力梯度（单位为 $\\mathrm{Pa/m}$）。在壁面施加无滑移边界条件，并在中心线施加正则性条件：\n$$u(R,t) \\;=\\; 0,\\qquad \\frac{\\partial u}{\\partial r}(0,t) \\;=\\; 0,$$\n初始条件为从静止启动：\n$$u(r,0) \\;=\\; 0.$$\n\n定义 Womersley 数 $\\alpha$ 为\n$$\\alpha \\;=\\; R\\,\\sqrt{\\frac{\\omega}{\\nu}},\\qquad \\nu \\;=\\; \\frac{\\mu}{\\rho},$$\n其中 $\\omega$ 是脉动角频率，$\\nu$ 是运动粘度。\n\n设壁面剪切应力由下式给出\n$$\\tau_w(t) \\;=\\; \\mu\\,\\left.\\frac{\\partial u}{\\partial r}(r,t)\\right|_{r=R}.$$\n\n当从静止状态在振荡驱动下瞬态演化时，如果壁面剪切应力大小 $\\lvert \\tau_w(t) \\rvert$ 暂时超过了瞬态衰减后达到的稳态周期振幅，则观察到启动超调现象。将此超调相对于稳态周期振幅量化为无量纲比率\n$$\\mathcal{O} \\;=\\; \\frac{\\displaystyle \\max_{t \\in [0,T_{\\mathrm{end}}]} \\lvert \\tau_w(t) \\rvert}{A_\\infty},$$\n其中 $A_\\infty$ 是 $\\tau_w(t)$ 在长时间周期性状态下的基波振幅。通过将最后一个周期内的 $\\tau_w(t)$ 拟合到正弦模型 $a\\cos(\\omega t)+b\\sin(\\omega t)+c$ 来估计 $A_\\infty$，并取 $A_\\infty = \\sqrt{a^2+b^2}$。拟合必须在一个周期内通过最小二乘法进行数值计算。\n\n对数值方法的要求：\n- 将径向坐标 $r$ 在均匀网格上离散化，分为 $N_r$ 个区间，间距为 $\\Delta r = R/N_r$。\n- 在时间上使用后向欧拉法，时间步长为 $\\Delta t$。\n- 以守恒轴对称形式离散化径向算子，其等效于 $\\left( \\partial^2/\\partial r^2 + (1/r) \\partial/\\partial r \\right)$，要求内部具有二阶精度，并在 $r=0$ 处使用与正则性一致的近似。在边界处直接施加 $u(R,t)=0$，以从未知数中消除壁面节点。\n- 在每个时间步，精确求解（非迭代地）所得到的三对角线性系统。\n- 使用壁面处的单边导数计算 $\\tau_w(t)$，即 $\\tau_w(t) \\approx \\mu\\,\\left( \\frac{u(R,t)-u(R-\\Delta r,t)}{\\Delta r} \\right)$，并利用 $u(R,t)=0$。\n\n驱动力：\n- 对于阶跃启动（施加于 $t \\ge 0$），使用 $G(t) = G_0 \\cos(\\omega t)$。\n- 对于指数斜坡启动（施加于 $t \\ge 0$），使用 $G(t) = G_0 \\cos(\\omega t)\\,\\left(1 - e^{-t/\\tau_{\\mathrm{ramp}}}\\right)$。\n\n科学单位：\n- $R$ 的单位为 $\\mathrm{m}$，$\\rho$ 的单位为 $\\mathrm{kg/m^3}$，$\\mu$ 的单位为 $\\mathrm{Pa \\cdot s}$，$\\omega$ 的单位为 $\\mathrm{rad/s}$，$G_0$ 的单位为 $\\mathrm{Pa/m}$，$\\tau_{\\mathrm{ramp}}$ 的单位为 $\\mathrm{s}$，时间的单位为 $\\mathrm{s}$，壁面剪切应力的单位为 $\\mathrm{Pa}$。超调比率 $\\mathcal{O}$ 是无量纲的。\n\n测试套件：\n为下列各参数集计算 $\\mathcal{O}$，积分进行 $N_{\\mathrm{cycles}}$ 个完整周期，时间步长 $\\Delta t$ 精确取为周期的 $N_{\\mathrm{per}}^{-1}$，因此每个周期有 $N_{\\mathrm{per}}$ 步。在所有情况下，均使用 $N_{\\mathrm{per}} = 1000$，$N_{\\mathrm{cycles}} = 6$ 和 $N_r = 128$。\n\n- 情况 1（中等 Womersley 数，阶跃启动）：\n  - $R = 0.004\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，启动类型：阶跃。\n- 情况 2（小 Womersley 数，阶跃启动）：\n  - $R = 0.0015\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，启动类型：阶跃。\n- 情况 3（大 Womersley 数，阶跃启动）：\n  - $R = 0.010\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，启动类型：阶跃。\n- 情况 4（大 Womersley 数，指数斜坡启动）：\n  - $R = 0.010\\,\\mathrm{m}$，$\\rho = 1060\\,\\mathrm{kg/m^3}$，$\\mu = 0.0035\\,\\mathrm{Pa \\cdot s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$，$G_0 = 800\\,\\mathrm{Pa/m}$，$\\tau_{\\mathrm{ramp}} = 0.2\\,\\mathrm{s}$，启动类型：指数斜坡。\n\n您的程序必须计算所有四种情况下的超调比率 $\\mathcal{O}$，并将它们在单行中以方括号括起的逗号分隔列表形式输出，使用十进制形式且不带任何百分号。例如，一个包含四个结果的输出必须看起来像 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个代表第 $i$ 种情况下超调比率的浮点数。",
            "solution": "该问题要求对刚性圆形血管中轴对称、不可压缩的牛顿流体的轴向动量方程进行数值求解：\n$$\n\\rho \\,\\frac{\\partial u}{\\partial t} \\;=\\; -\\,G(t) \\;+\\; \\mu \\left( \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right)\n$$\n此处，$u(r,t)$ 是轴向速度，$\\rho$ 是流体密度，$\\mu$ 是动力粘度，$G(t)$ 是施加的轴向压力梯度。空间域为 $r \\in [0, R]$，时间域为 $t \\ge 0$。初始条件为 $u(r,0) = 0$（流动从静止开始），边界条件为壁面无滑移 $u(R,t) = 0$ 和中心线对称 $\\frac{\\partial u}{\\partial r}(0,t) = 0$。\n\n我们将按照规定使用有限差分法求解此方程。\n\n首先，我们用运动粘度 $\\nu = \\mu/\\rho$ 改写控制方程：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\frac{G(t)}{\\rho} \\;+\\; \\nu \\left( \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right)\n$$\n\n求解过程分为以下几个步骤：\n1.  离散化空间域和时间域。\n2.  应用后向欧拉法进行时间积分，在每个时间步得到一个线性方程组。\n3.  使用二阶有限差分法离散化空间导数，并特别注意中心线的奇点。\n4.  组装并求解所得的三对角线性系统。\n5.  进行时间迭代，以求解速度剖面 $u(r,t)$ 的演化。\n6.  根据速度剖面计算壁面剪切应力 $\\tau_w(t)$。\n7.  进行后处理以计算超调比率 $\\mathcal{O}$。\n\n**1. 离散化**\n径向坐标 $r$ 在一个具有 $N_r$ 个区间的均匀网格上离散化，使得 $\\Delta r = R/N_r$。网格点为 $r_i = i \\Delta r$，其中 $i = 0, 1, \\dots, N_r$。这些点上的速度记为 $u_i(t) = u(r_i, t)$。\n壁面处的边界条件意味着 $u_{N_r}(t) = 0$。未知数是内部节点和中心线节点上的速度，即 $\\{u_0, u_1, \\dots, u_{N_r-1}\\}$。\n\n时间以恒定的步长 $\\Delta t$ 离散化，即 $t_n = n \\Delta t$。在离散的时间和空间点上的速度为 $u_i^n = u(r_i, t_n)$。\n\n**2. 时间积分：后向欧拉法**\n将后向欧拉格式应用于控制方程，我们在未来的时间步 $n+1$ 处计算空间导数：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} \\;=\\; -\\frac{G(t_{n+1})}{\\rho} \\;+\\; \\nu \\left[ \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right]_{r=r_i}^{t=t_{n+1}}\n$$\n重新整理后，我们得到一个关于时间 $n+1$ 处速度的方程：\n$$\nu_i^{n+1} - \\nu \\Delta t \\left[ \\frac{\\partial^2 u}{\\partial r^2} \\;+\\; \\frac{1}{r}\\,\\frac{\\partial u}{\\partial r} \\right]_{i}^{n+1} \\;=\\; u_i^n - \\frac{\\Delta t}{\\rho} G(t_{n+1})\n$$\n\n**3. 空间离散化**\n我们对内部节点 $i \\in \\{1, 2, \\dots, N_r-1\\}$ 处的空间导数使用二阶中心差分：\n$$\n\\left.\\frac{\\partial^2 u}{\\partial r^2}\\right|_i \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta r^2}\n$$\n$$\n\\left.\\frac{\\partial u}{\\partial r}\\right|_i \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta r}\n$$\n内部节点 $i$ 处的完整空间算子变为：\n$$\n\\left( \\frac{\\partial^2 u}{\\partial r^2} + \\frac{1}{r_i}\\frac{\\partial u}{\\partial r} \\right) \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta r^2} + \\frac{1}{i\\Delta r} \\frac{u_{i+1} - u_{i-1}}{2\\Delta r} = \\frac{1}{\\Delta r^2} \\left[ \\left(1+\\frac{1}{2i}\\right)u_{i+1} - 2u_i + \\left(1-\\frac{1}{2i}\\right)u_{i-1} \\right]\n$$\n在中心线（$i=0$）处，$1/r$ 项是奇异的。使用对称条件 $\\frac{\\partial u}{\\partial r}(0,t)=0$ 和 L'Hôpital 法则，算子简化为 $2\\frac{\\partial^2 u}{\\partial r^2}$。通过考虑在 $r=0$ 附近的泰勒展开并结合对称性 $u(\\Delta r)=u(-\\Delta r)$，我们得到二阶导数的二阶近似：\n$$\n\\left.\\frac{\\partial^2 u}{\\partial r^2}\\right|_{i=0} \\approx \\frac{2(u_1 - u_0)}{\\Delta r^2}\n$$\n因此，中心线处的空间算子近似为：\n$$\n\\left.2\\frac{\\partial^2 u}{\\partial r^2}\\right|_{i=0} \\approx \\frac{4(u_1 - u_0)}{\\Delta r^2}\n$$\n\n**4. 组装和求解线性系统**\n将离散化的空间导数代入后向欧拉方程，得到一个关于未知速度 $\\mathbf{u}^{n+1} = [u_0^{n+1}, \\dots, u_{N_r-1}^{n+1}]^T$ 的线性代数方程组。令 $C = \\nu \\Delta t / \\Delta r^2$。\n\n对于中心线节点 ($i=0$):\n$$\n(1+4C)u_0^{n+1} - 4C u_1^{n+1} = u_0^n - \\frac{\\Delta t}{\\rho}G(t_{n+1})\n$$\n对于内部节点 ($i=1, \\dots, N_r-2$):\n$$\n-C\\left(1-\\frac{1}{2i}\\right)u_{i-1}^{n+1} + (1+2C)u_i^{n+1} - C\\left(1+\\frac{1}{2i}\\right)u_{i+1}^{n+1} = u_i^n - \\frac{\\Delta t}{\\rho}G(t_{n+1})\n$$\n对于邻近壁面的节点 ($i=N_r-1$)，我们使用内部节点的公式并结合边界条件 $u_{N_r}^{n+1}=0$：\n$$\n-C\\left(1-\\frac{1}{2(N_r-1)}\\right)u_{N_r-2}^{n+1} + (1+2C)u_{N_r-1}^{n+1} = u_{N_r-1}^n - \\frac{\\Delta t}{\\rho}G(t_{n+1})\n$$\n这构成了一个三对角系统 $\\mathbf{A} \\mathbf{u}^{n+1} = \\mathbf{d}^n$，该系统在每个时间步求解。矩阵 $\\mathbf{A}$ 在整个模拟过程中是恒定的，因此可以只构建和分解一次。\n\n**5. 壁面剪切应力计算**\n壁面剪切应力 $\\tau_w(t)$ 使用指定的单边有限差分公式计算：\n$$\n\\tau_w(t) \\approx \\mu\\,\\left( \\frac{u(R,t)-u(R-\\Delta r,t)}{\\Delta r} \\right) = \\mu\\,\\left( \\frac{0 - u_{N_r-1}(t)}{\\Delta r} \\right) = - \\frac{\\mu}{\\Delta r} u_{N_r-1}(t)\n$$\n\n**6. 超调比率计算**\n超调比率 $\\mathcal{O}$ 定义为瞬态壁面剪切应力峰值大小与稳态周期振幅之比：\n$$\n\\mathcal{O} = \\frac{\\displaystyle \\max_{t \\in [0,T_{\\mathrm{end}}]} \\lvert \\tau_w(t) \\rvert}{A_\\infty}\n$$\n$T_{\\mathrm{end}}$ 是覆盖 $N_{\\mathrm{cycles}}$ 个周期的总模拟时间。通过取整个模拟过程中计算出的 $\\tau_w(t)$ 的最大绝对值来找到瞬态壁面剪切应力峰值。\n\n稳态周期振幅 $A_\\infty$ 的估算方法是：将模拟最后一个周期的 $\\tau_w(t)$ 数据对模型 $f(t) = a\\cos(\\omega t) + b\\sin(\\omega t) + c$ 进行线性最小二乘拟合。用于最小二乘问题 $\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{y}$ 的设计矩阵 $\\mathbf{X}$ 和观测向量 $\\mathbf{y}$ 使用最后一个周期的时间点和壁面剪切应力值构建。系数向量为 $\\boldsymbol{\\beta}=[a, b, c]^T$。一旦求得系数 $a$ 和 $b$，振幅就计算为 $A_\\infty = \\sqrt{a^2+b^2}$。\n\n对所提供的四个测试案例中的每一个，实现都将遵循此流程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve_womersley_transient(params):\n    \"\"\"\n    Solves the transient Womersley flow problem for a given set of parameters.\n\n    Args:\n        params (dict): A dictionary containing all physical and numerical parameters.\n\n    Returns:\n        float: The calculated overshoot ratio O.\n    \"\"\"\n    # Unpack parameters\n    R = params['R']\n    rho = params['rho']\n    mu = params['mu']\n    omega = params['omega']\n    G0 = params['G0']\n    startup_type = params['startup_type']\n    tau_ramp = params.get('tau_ramp', 0.0) # Defaults to 0 for step startup\n    Nr = params['Nr']\n    N_cycles = params['N_cycles']\n    N_per = params['N_per']\n\n    # Derived parameters\n    nu = mu / rho\n    period = 2 * np.pi / omega\n    dt = period / N_per\n    dr = R / Nr\n    T_end = N_cycles * period\n    N_steps = N_cycles * N_per\n\n    # Time and radial grids\n    r_grid = np.linspace(0, R, Nr + 1)\n    \n    # --- Assemble the tridiagonal matrix A ---\n    # The system is A * u_new = d\n    # A is (Nr x Nr) for unknowns u_0, ..., u_{Nr-1}\n    # We use scipy.linalg.solve_banded which requires a special format (ab)\n    ab = np.zeros((3, Nr)) # 1 upper, 1 main, 1 lower diagonal\n    C = nu * dt / (dr**2)\n    \n    # Main diagonal (ab[1, :])\n    ab[1, 0] = 1.0 + 4.0 * C\n    for i in range(1, Nr):\n      ab[1, i] = 1.0 + 2.0 * C\n\n    # Upper diagonal (ab[0, 1:])\n    ab[0, 1] = -4.0 * C\n    for i in range(1, Nr - 1):\n        ab[0, i + 1] = -C * (1.0 + 1.0 / (2.0 * i))\n\n    # Lower diagonal (ab[2, :-1])\n    for i in range(1, Nr):\n        ab[2, i - 1] = -C * (1.0 - 1.0 / (2.0 * i))\n\n    # --- Time-stepping loop ---\n    u = np.zeros(Nr)  # Velocity profile u_0, ..., u_{Nr-1}\n    tau_w_history = np.zeros(N_steps)\n    time_points = np.zeros(N_steps)\n\n    for n in range(N_steps):\n        t = (n + 1) * dt\n        time_points[n] = t\n\n        # Calculate pressure gradient G(t)\n        G_t_cos = G0 * np.cos(omega * t)\n        if startup_type == 'step':\n            G_t = G_t_cos\n        elif startup_type == 'exponential_ramp':\n            G_t = G_t_cos * (1.0 - np.exp(-t / tau_ramp))\n\n        # Construct the right-hand side vector d\n        d = u - (dt / rho) * G_t\n\n        # Solve the linear system\n        u = solve_banded((1, 1), ab, d)\n\n        # Calculate and store wall shear stress\n        # tau_w = mu * (u(R) - u(R-dr)) / dr = mu * (0 - u_{Nr-1}) / dr\n        tau_w_history[n] = -mu * u[-1] / dr\n\n    # --- Post-processing ---\n    # 1. Find the maximum transient WSS magnitude\n    max_transient_tau_w = np.max(np.abs(tau_w_history))\n\n    # 2. Estimate steady periodic amplitude A_inf by fitting the last cycle\n    last_cycle_start_idx = (N_cycles - 1) * N_per\n    t_fit = time_points[last_cycle_start_idx:]\n    tau_w_fit = tau_w_history[last_cycle_start_idx:]\n\n    # Design matrix for least-squares fit: a*cos(wt) + b*sin(wt) + c\n    X = np.vstack([np.cos(omega * t_fit), \n                   np.sin(omega * t_fit), \n                   np.ones(len(t_fit))]).T\n    \n    # Solve for coefficients [a, b, c]\n    coeffs, _, _, _ = np.linalg.lstsq(X, tau_w_fit, rcond=None)\n    a, b = coeffs[0], coeffs[1]\n    \n    A_inf = np.sqrt(a**2 + b**2)\n\n    # 3. Calculate the overshoot ratio\n    overshoot_ratio = max_transient_tau_w / A_inf\n\n    return overshoot_ratio\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    common_params = {\n        'rho': 1060.0,\n        'mu': 0.0035,\n        'omega': 2.0 * np.pi,\n        'G0': 800.0,\n        'Nr': 128,\n        'N_cycles': 6,\n        'N_per': 1000\n    }\n\n    test_cases = [\n        # Case 1: moderate Womersley, step start-up\n        {'R': 0.004, 'startup_type': 'step'},\n        # Case 2: small Womersley, step start-up\n        {'R': 0.0015, 'startup_type': 'step'},\n        # Case 3: large Womersley, step start-up\n        {'R': 0.010, 'startup_type': 'step'},\n        # Case 4: large Womersley, ramp start-up\n        {'R': 0.010, 'startup_type': 'exponential_ramp', 'tau_ramp': 0.2},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        params = common_params.copy()\n        params.update(case_params)\n        result = solve_womersley_transient(params)\n        results.append(result)\n\n    # Format the output string\n    output_str = '[' + ','.join(f\"{res:.6f}\" for res in results) + ']'\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}