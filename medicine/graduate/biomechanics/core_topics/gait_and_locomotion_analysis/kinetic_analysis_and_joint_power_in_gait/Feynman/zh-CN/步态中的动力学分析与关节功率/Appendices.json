{
    "hands_on_practices": [
        {
            "introduction": "逆动力学是步态动力学分析的基石，它使我们能够计算由肌肉产生但无法直接测量的内生关节力矩。本练习将通过一个具体的实例，指导你应用牛顿-欧拉方程来分析足部这一刚体段，并计算在支撑后期踝关节处的净力矩。这个基础计算是理解肢体如何被驱动和控制的关键第一步 。",
            "id": "4184617",
            "problem": "本题要求在站立后期对足部节段进行平面逆动力学分析，使用 Newton–Euler 方程求得踝关节净跖屈力矩。假设以下物理上一致的设置。\n\n一个右手惯性坐标系的原点固定在踝关节中心。$x$ 轴指向前方，$y$ 轴指向上方，$z$ 轴指向矢状面外。根据右手定则，$z$ 分量为正的力矩对应于逆时针旋转（背屈）。定义所报告的踝关节力矩以跖屈为正，即标量跖屈力矩为 $M_{\\mathrm{pf}}=-M_{z}$，其中 $M_{z}$ 是施加于足部的踝关节净力矩的 $z$ 分量。\n\n在站立后期的某一特定瞬间，测量或估计得到以下数据：\n- 足部质量: $m=1.05\\,\\text{kg}$。\n- 足部质心（COM）相对于踝关节的位置: $\\mathbf{r}_{G/A}=\\begin{bmatrix}0.070 \\\\ -0.030 \\\\ 0\\end{bmatrix}\\,\\text{m}$。\n- 足部绕其质心关于 $z$ 轴的平面转动惯量: $I_{G}=0.0065\\,\\text{kg}\\cdot\\text{m}^{2}$。\n- 压力中心（COP）处的地面反作用力（GRF）: $\\mathbf{F}_{\\mathrm{GRF}}=\\begin{bmatrix}120 \\\\ 900 \\\\ 0\\end{bmatrix}\\,\\text{N}$。\n- COP 相对于踝关节的位置: $\\mathbf{r}_{\\mathrm{COP}/A}=\\begin{bmatrix}0.140 \\\\ -0.020 \\\\ 0\\end{bmatrix}\\,\\text{m}$。\n- 足部质心的绝对线加速度: $\\mathbf{a}_{G}=\\begin{bmatrix}0.80 \\\\ -2.50 \\\\ 0\\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n- 足部绕 $z$ 轴的角加速度（逆时针为正）: $\\alpha_{z}=-22.0\\,\\text{rad}\\cdot\\text{s}^{-2}$。\n- 重力加速度: $\\mathbf{g}=\\begin{bmatrix}0 \\\\ -9.81 \\\\ 0\\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n\n将足部视为一个刚性平面体，并忽略除指定外的任何其他外力或外力矩。使用 Newton–Euler 方程，通过对踝关节中心的力矩平衡，计算该瞬间的踝关节净跖屈力矩 $M_{\\mathrm{pf}}$。答案以 $\\text{N}\\cdot\\text{m}$ 为单位，并四舍五入到四位有效数字。将最终结果表示为单个数字。",
            "solution": "用户希望我解决一个生物力学问题。\n\n### 第一步：提取已知条件\n-   坐标系：右手惯性坐标系，原点位于踝关节中心 ($A$) 。$x$ 轴指向前方，$y$ 轴指向上方，$z$ 轴指向矢状面外。正 $z$ 力矩为逆时针方向（背屈）。\n-   踝关节力矩的定义：跖屈力矩 $M_{\\mathrm{pf}} = -M_{z}$，其中 $M_{z}$ 是施加于足部的踝关节净力矩的 $z$ 分量。\n-   足部质量: $m = 1.05\\,\\text{kg}$。\n-   足部质心相对于踝关节的位置: $\\mathbf{r}_{G/A} = \\begin{bmatrix} 0.070 \\\\ -0.030 \\\\ 0 \\end{bmatrix}\\,\\text{m}$。\n-   绕质心的转动惯量: $I_{G} = 0.0065\\,\\text{kg}\\cdot\\text{m}^{2}$ (绕 $z$ 轴)。\n-   地面反作用力: $\\mathbf{F}_{\\mathrm{GRF}} = \\begin{bmatrix} 120 \\\\ 900 \\\\ 0 \\end{bmatrix}\\,\\text{N}$。\n-   压力中心相对于踝关节的位置: $\\mathbf{r}_{\\mathrm{COP}/A} = \\begin{bmatrix} 0.140 \\\\ -0.020 \\\\ 0 \\end{bmatrix}\\,\\text{m}$。\n-   足部质心的绝对线加速度: $\\mathbf{a}_{G} = \\begin{bmatrix} 0.80 \\\\ -2.50 \\\\ 0 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n-   足部角加速度: $\\alpha_{z} = -22.0\\,\\text{rad}\\cdot\\text{s}^{-2}$ (绕 $z$ 轴)。\n-   重力加速度: $\\mathbf{g} = \\begin{bmatrix} 0 \\\\ -9.81 \\\\ 0 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n-   假设：足部是刚性平面体。其他外力/外力矩可忽略不计。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于刚体动力学的 Newton-Euler 方程，这是经典力学的基本原理。其应用是生物力学中的逆动力学，这是一个标准且成熟的领域。所有提供的值在物理上对人类步态分析都是合理的。\n-   **定义明确**：该问题提供了所有必要的数据和一个明确的目标：计算单个标量值 $M_{\\mathrm{pf}}$。所用的方法（绕踝关节的力矩平衡）也已指定，这会导出一个唯一解。\n-   **客观性**：该问题使用精确的技术语言陈述，对坐标系和力矩约定有清晰的定义。\n\n问题是自洽的、一致的且科学上合理的。未发现任何缺陷。\n\n### 第三步：结论与行动\n问题有效。将提供解答。\n\n该问题要求使用基于 Newton-Euler 方程的平面逆动力学分析来计算踝关节净跖屈力矩。我们将对踝关节中心（记为点 $A$）进行力矩求和。对于平面运动中的刚体，绕任意点 $A$ 的外力矩总和与质心 ($G$) 的加速度和物体的角加速度 ($\\boldsymbol{\\alpha}$) 之间的关系由以下方程给出：\n$$ \\sum \\mathbf{M}_A = I_G \\boldsymbol{\\alpha} + \\mathbf{r}_{G/A} \\times (m \\mathbf{a}_G) $$\n其中 $I_G$ 是绕质心的转动惯量，$\\mathbf{r}_{G/A}$ 是从 $A$ 到 $G$ 的位置向量，$m$ 是质量，$\\mathbf{a}_G$ 是质心的绝对加速度。\n\n作用在足部上，绕踝关节中心 $A$ 的外力矩有：\n1.  由小腿施加于足部的净踝关节力矩，我们记为 $\\mathbf{M}_A$。这是要求解的量。\n2.  由施加在压力中心 (COP) 的地面反作用力 $\\mathbf{F}_{\\mathrm{GRF}}$ 产生的力矩，由 $\\mathbf{M}_{\\mathrm{GRF}} = \\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}$ 给出。\n3.  由作用在足部质心 $G$ 的重力（重量）产生的力矩，由 $\\mathbf{M}_{\\text{gravity}} = \\mathbf{r}_{G/A} \\times (m \\mathbf{g})$ 给出。\n\n这些外力矩的总和是：\n$$ \\sum \\mathbf{M}_A = \\mathbf{M}_A + (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}) + (\\mathbf{r}_{G/A} \\times (m \\mathbf{g})) $$\n\n令 $\\sum \\mathbf{M}_A$ 的两个表达式相等，我们得到：\n$$ \\mathbf{M}_A + (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}) + (\\mathbf{r}_{G/A} \\times (m \\mathbf{g})) = I_G \\boldsymbol{\\alpha} + \\mathbf{r}_{G/A} \\times (m \\mathbf{a}_G) $$\n\n我们可以解出踝关节力矩 $\\mathbf{M}_A$：\n$$ \\mathbf{M}_A = I_G \\boldsymbol{\\alpha} + \\mathbf{r}_{G/A} \\times (m \\mathbf{a}_G) - (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}) - (\\mathbf{r}_{G/A} \\times (m \\mathbf{g})) $$\n\n由于运动是平面的，我们只关心这个矢量方程的 $z$ 分量。设 $M_z$ 为 $\\mathbf{M}_A$ 的 $z$ 分量。对于任意两个向量 $\\mathbf{u} = \\begin{bmatrix}u_x \\\\ u_y \\\\ 0\\end{bmatrix}$ 和 $\\mathbf{v} = \\begin{bmatrix}v_x \\\\ v_y \\\\ 0\\end{bmatrix}$，其叉积的 $z$ 分量为 $(\\mathbf{u} \\times \\mathbf{v})_z = u_x v_y - u_y v_x$。$I_G \\boldsymbol{\\alpha}$ 的 $z$ 分量是 $I_G \\alpha_z$。\n\n$M_z$ 的方程变为：\n$$ M_z = I_G \\alpha_z + (r_{G/A,x} (m a_{G,y}) - r_{G/A,y} (m a_{G,x})) - (r_{\\mathrm{COP}/A,x} F_{\\mathrm{GRF},y} - r_{\\mathrm{COP}/A,y} F_{\\mathrm{GRF},x}) - (r_{G/A,x} (m g_y) - r_{G/A,y} (m g_x)) $$\n\n现在我们代入给定值。首先，我们计算右侧各项的 $z$ 分量。\n\n1.  惯性力矩项：$I_G \\alpha_z$\n    $$ I_G \\alpha_z = (0.0065\\,\\text{kg}\\cdot\\text{m}^{2}) \\times (-22.0\\,\\text{rad}\\cdot\\text{s}^{-2}) = -0.143\\,\\text{N}\\cdot\\text{m} $$\n\n2.  “惯性力”力矩项：$(\\mathbf{r}_{G/A} \\times m \\mathbf{a}_G)_z$\n    线动量的变化率是 $m \\mathbf{a}_G = 1.05\\,\\text{kg} \\times \\begin{bmatrix} 0.80 \\\\ -2.50 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2} = \\begin{bmatrix} 0.84 \\\\ -2.625 \\end{bmatrix}\\,\\text{N}$。\n    $$ (\\mathbf{r}_{G/A} \\times m \\mathbf{a}_G)_z = (0.070\\,\\text{m})(-2.625\\,\\text{N}) - (-0.030\\,\\text{m})(0.84\\,\\text{N}) $$\n    $$ = -0.18375\\,\\text{N}\\cdot\\text{m} + 0.0252\\,\\text{N}\\cdot\\text{m} = -0.15855\\,\\text{N}\\cdot\\text{m} $$\n\n3.  地面反作用力力矩项：$(\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}})_z$\n    $$ (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}})_z = (0.140\\,\\text{m})(900\\,\\text{N}) - (-0.020\\,\\text{m})(120\\,\\text{N}) $$\n    $$ = 126\\,\\text{N}\\cdot\\text{m} - (-2.4\\,\\text{N}\\cdot\\text{m}) = 128.4\\,\\text{N}\\cdot\\text{m} $$\n\n4.  重力力矩项：$(\\mathbf{r}_{G/A} \\times m \\mathbf{g})_z$\n    重力是 $m \\mathbf{g} = 1.05\\,\\text{kg} \\times \\begin{bmatrix} 0 \\\\ -9.81 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2} = \\begin{bmatrix} 0 \\\\ -10.3005 \\end{bmatrix}\\,\\text{N}$。\n    $$ (\\mathbf{r}_{G/A} \\times m \\mathbf{g})_z = (0.070\\,\\text{m})(-10.3005\\,\\text{N}) - (-0.030\\,\\text{m})(0\\,\\text{N}) $$\n    $$ = -0.721035\\,\\text{N}\\cdot\\text{m} $$\n\n现在，将这些分量代回 $M_z$ 的方程中：\n$$ M_z = (-0.143) + (-0.15855) - (128.4) - (-0.721035) $$\n$$ M_z = -0.143 - 0.15855 - 128.4 + 0.721035 $$\n$$ M_z = -127.980515\\,\\text{N}\\cdot\\text{m} $$\n题目定义了以跖屈为正的力矩 $M_{\\mathrm{pf}}$ 为 $M_{\\mathrm{pf}} = -M_z$。\n$$ M_{\\mathrm{pf}} = -(-127.980515\\,\\text{N}\\cdot\\text{m}) = 127.980515\\,\\text{N}\\cdot\\text{m} $$\n题目要求答案四舍五入到四位有效数字。第五位有效数字是 $8$，所以我们将第四位数字向上取整。\n$$ M_{\\mathrm{pf}} \\approx 128.0\\,\\text{N}\\cdot\\text{m} $$\n正值表示一个净跖屈力矩，这在步态的蹬离阶段是符合预期的。",
            "answer": "$$\\boxed{128.0}$$"
        },
        {
            "introduction": "在掌握了逆动力学的基础计算之后，批判性地审视其假设变得至关重要。本练习将引导你探讨一个常见的简化——准静态分析——的有效性，即在分析中忽略段的惯性力。通过量化惯性力与地面反作用力的大小关系，你将学会评估动态项在模型中的重要性，即使在低速运动中也是如此 。",
            "id": "4184615",
            "problem": "考虑在低速行走站立相期间，对远端下肢节段组合体（小腿和足部被视为一个单一刚体）进行的平面矢状面逆动力学分析。设总身体质量为 $M$，节段组合体质量为 $m_{\\mathrm{sf}} = f M$，其中 $f = 0.061$ 是一个常用的小腿加足部质量的人体测量分数。站立相持续时间为 $T$。作用于压力中心的地面反作用力 (GRF) 具有分量 $F_{x}(t)$（前后方向）和 $F_{y}(t)$（垂直方向），节段组合体质心的线性加速度分量为 $a_{x}(t)$ 和 $a_{y}(t)$。假设在 $t \\in [0, T]$ 范围内有以下低速行走特征：\n- $M = 75$ kg 且 $g = 9.81$ m s$^{-2}$，\n- $T = 0.70$ s，\n- $F_{x}(t) = c_{x} M g \\sin\\left(\\frac{\\pi t}{T}\\right)$，其中 $c_{x} = 0.20$，\n- $F_{y}(t) = M g \\left(0.85 + 0.25 \\sin\\left(\\frac{\\pi t}{T}\\right)\\right)$，\n- $a_{x}(t) = A_{x} \\sin\\left(\\frac{\\pi t}{T}\\right)$，其中 $A_{x} = 2.5$ m s$^{-2}$，\n- $a_{y}(t) = A_{y} \\sin\\left(\\frac{\\pi t}{T}\\right)$，其中 $A_{y} = 1.5$ m s$^{-2}$，\n且 $m_{\\mathrm{sf}} = f M$。\n\n从牛顿第二平动和转动定律出发，解释为什么在逆动力学中省略节段线性加速度项 $m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}(t)$ 会在估算的膝关节力矩中引入偏差。然后，作为此低速行走站立相期间该潜在偏差的定量指标，计算无量纲比率在 $t \\in [0, T]$ 上的峰值\n$$\nR(t) \\equiv \\frac{\\left\\| \\mathbf{F}_{\\mathrm{inertial}}(t) \\right\\|}{\\left\\| \\mathbf{F}_{\\mathrm{GRF}}(t) \\right\\|} \\;=\\; \\frac{\\left\\| m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}(t) \\right\\|}{\\sqrt{F_{x}(t)^{2} + F_{y}(t)^{2}}}\\,,\n$$\n其中 $\\mathbf{a}_{\\mathrm{COM}}(t) = \\big(a_{x}(t), a_{y}(t)\\big)$ 且 $\\mathbf{F}_{\\mathrm{GRF}}(t) = \\big(F_{x}(t), F_{y}(t)\\big)$。将您的最终答案（峰值 $\\max_{t \\in [0,T]} R(t)$）表示为一个无单位的十进制数，并四舍五入到四位有效数字。",
            "solution": "该问题提出了一个包含两部分的任务：首先，定性解释逆动力学中的偏差；其次，定量计算一个代表这种潜在偏差的比率。\n\n**第1部分：膝关节力矩估算中偏差的解释**\n\n逆动力学是一种基于测量的运动学（例如，节段位置、速度、加速度）和外力（例如，地面反作用力）来计算节段间关节处未知力和力矩的方法。其支配原理是刚体的牛顿运动定律。\n\n对于在二维平面模型中被视为单一刚体的小腿-足部节段，其运动方程为：\n1.  牛顿第二平动定律：\n    $$ \\sum \\mathbf{F} = m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}} $$\n2.  牛顿第二转动定律，力矩以节段质心 (COM) 为参考点计算：\n    $$ \\sum M_{\\mathrm{COM}} = I_{\\mathrm{COM}} \\alpha $$\n\n作用在小腿-足部节段上的力有：\n-   地面反作用力 $\\mathbf{F}_{\\mathrm{GRF}}$，作用于压力中心 (COP)。\n-   重力 $m_{\\mathrm{sf}} \\mathbf{g}$，作用于节段的质心 (COM)。\n-   来自股骨的反作用力 $\\mathbf{F}_{\\mathrm{knee}}$，作用于膝关节中心 (KJC)。\n\n关于质心 (COM) 的力矩有：\n-   股骨在膝关节中心 (KJC) 施加的净力矩 $M_{\\mathrm{knee}}$。\n-   由膝关节反作用力产生的力矩 $\\mathbf{r}_{\\mathrm{KJC}/\\mathrm{COM}} \\times \\mathbf{F}_{\\mathrm{knee}}$。\n-   由地面反作用力产生的力矩 $\\mathbf{r}_{\\mathrm{COP}/\\mathrm{COM}} \\times \\mathbf{F}_{\\mathrm{GRF}}$。\n\n平动运动方程为：\n$$ \\mathbf{F}_{\\mathrm{knee}} + \\mathbf{F}_{\\mathrm{GRF}} + m_{\\mathrm{sf}} \\mathbf{g} = m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}} $$\n在逆动力学计算中，$\\mathbf{F}_{\\mathrm{GRF}}$ 和 $m_{\\mathrm{sf}} \\mathbf{g}$ 是已知量（通过测量或人体测量学得到），而 $\\mathbf{a}_{\\mathrm{COM}}$ 通过运动捕捉数据得到。未知的膝关节力 $\\mathbf{F}_{\\mathrm{knee}}$ 通过重新整理方程求解：\n$$ \\mathbf{F}_{\\mathrm{knee}} = m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}} - \\mathbf{F}_{\\mathrm{GRF}} - m_{\\mathrm{sf}} \\mathbf{g} $$\n项 $m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}$ 是惯性力项。如果省略此项，则相当于进行准静态分析，即假设节段的加速度为零（$\\mathbf{a}_{\\mathrm{COM}} = \\mathbf{0}$）。这将导致对膝关节力的错误估算：\n$$ \\mathbf{F}_{\\mathrm{knee, static}} = - \\mathbf{F}_{\\mathrm{GRF}} - m_{\\mathrm{sf}} \\mathbf{g} $$\n\n关于质心 (COM) 的转动运动方程为：\n$$ M_{\\mathrm{knee}} + (\\mathbf{r}_{\\mathrm{KJC}/\\mathrm{COM}} \\times \\mathbf{F}_{\\mathrm{knee}}) + (\\mathbf{r}_{\\mathrm{COP}/\\mathrm{COM}} \\times \\mathbf{F}_{\\mathrm{GRF}}) = I_{\\mathrm{COM}} \\alpha $$\n未知的膝关节力矩 $M_{\\mathrm{knee}}$ 求解如下：\n$$ M_{\\mathrm{knee}} = I_{\\mathrm{COM}} \\alpha - (\\mathbf{r}_{\\mathrm{KJC}/\\mathrm{COM}} \\times \\mathbf{F}_{\\mathrm{knee}}) - (\\mathbf{r}_{\\mathrm{COP}/\\mathrm{COM}} \\times \\mathbf{F}_{\\mathrm{GRF}}) $$\n请注意，$M_{\\mathrm{knee}}$ 的计算需要 $\\mathbf{F}_{\\mathrm{knee}}$ 的值。如果在计算 $\\mathbf{F}_{\\mathrm{knee}}$ 时省略了惯性项 $m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}$，则会使用不正确的值 $\\mathbf{F}_{\\mathrm{knee, static}}$。这会引入一个直接传播到 $M_{\\mathrm{knee}}$ 计算中的误差。得到的力矩估算值 $M_{\\mathrm{knee, static}}$ 将存在偏差，因为它忽略了线性加速节段质量所需的关节反作用力部分所产生的力矩。这种偏差具体来说是在完整的力矩方程中省略了 $-\\left(\\mathbf{r}_{\\mathrm{KJC}/\\mathrm{COM}} \\times (m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}})\\right)$ 这一项。由于在运动过程中 $\\mathbf{a}_{\\mathrm{COM}}$ 通常不为零，省略此项会引入系统性误差，即偏差。\n\n**第2部分：潜在偏差的定量分析**\n\n问题要求计算比率 $R(t)$ 的峰值，该比率比较了惯性力的大小与地面反作用力的大小。\n$$ R(t) = \\frac{\\left\\| \\mathbf{F}_{\\mathrm{inertial}}(t) \\right\\|}{\\left\\| \\mathbf{F}_{\\mathrm{GRF}}(t) \\right\\|} = \\frac{\\left\\| m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}(t) \\right\\|}{\\sqrt{F_{x}(t)^{2} + F_{y}(t)^{2}}} $$\n首先，我们表示分子，即惯性力的大小：\n$$ \\left\\| m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}(t) \\right\\| = m_{\\mathrm{sf}} \\left\\| \\mathbf{a}_{\\mathrm{COM}}(t) \\right\\| = m_{\\mathrm{sf}} \\sqrt{a_x(t)^2 + a_y(t)^2} $$\n给定 $a_{x}(t) = A_{x} \\sin(\\frac{\\pi t}{T})$ 和 $a_{y}(t) = A_{y} \\sin(\\frac{\\pi t}{T})$，我们有：\n$$ \\sqrt{a_x(t)^2 + a_y(t)^2} = \\sqrt{\\left(A_{x} \\sin\\left(\\frac{\\pi t}{T}\\right)\\right)^2 + \\left(A_{y} \\sin\\left(\\frac{\\pi t}{T}\\right)\\right)^2} = \\sqrt{(A_x^2 + A_y^2) \\sin^2\\left(\\frac{\\pi t}{T}\\right)} $$\n对于 $t \\in [0, T]$，项 $\\frac{\\pi t}{T}$ 在 $[0, \\pi]$ 区间内，因此 $\\sin(\\frac{\\pi t}{T}) \\ge 0$。我们可以简化平方根：\n$$ \\left\\| \\mathbf{a}_{\\mathrm{COM}}(t) \\right\\| = \\sqrt{A_x^2 + A_y^2} \\sin\\left(\\frac{\\pi t}{T}\\right) $$\n因此，分子为：\n$$ \\left\\| m_{\\mathrm{sf}} \\mathbf{a}_{\\mathrm{COM}}(t) \\right\\| = m_{\\mathrm{sf}} \\sqrt{A_x^2 + A_y^2} \\sin\\left(\\frac{\\pi t}{T}\\right) $$\n\n接下来，我们表示分母，即地面反作用力的大小：\n$$ \\left\\| \\mathbf{F}_{\\mathrm{GRF}}(t) \\right\\| = \\sqrt{F_x(t)^2 + F_y(t)^2} = \\sqrt{\\left(c_x M g \\sin\\left(\\frac{\\pi t}{T}\\right)\\right)^2 + \\left(M g \\left(0.85 + 0.25 \\sin\\left(\\frac{\\pi t}{T}\\right)\\right)\\right)^2} $$\n\n为简化分析，令 $u = \\sin(\\frac{\\pi t}{T})$。当 $t$ 在区间 $[0, T]$ 内变化时，$u$ 在区间 $[0, 1]$ 内变化。比率 $R(t)$ 可以写成关于 $u$ 的函数 $R(u)$：\n$$ R(u) = \\frac{m_{\\mathrm{sf}} \\sqrt{A_x^2 + A_y^2} u}{\\sqrt{(c_x M g u)^2 + (M g (0.85 + 0.25 u))^2}} $$\n代入 $m_{\\mathrm{sf}} = f M$ 并从分母中提出 $M g$：\n$$ R(u) = \\frac{f M \\sqrt{A_x^2 + A_y^2} u}{M g \\sqrt{c_x^2 u^2 + (0.85 + 0.25 u)^2}} = \\frac{f \\sqrt{A_x^2 + A_y^2}}{g} \\frac{u}{\\sqrt{c_x^2 u^2 + (0.85 + 0.25 u)^2}} $$\n为了求 $R(u)$ 在 $u \\in [0, 1]$ 上的最大值，我们可以分析函数 $h(u) = \\frac{u}{\\sqrt{c_x^2 u^2 + (0.85 + 0.25 u)^2}}$。分析其平方 $G(u) = h(u)^2$ 更为容易：\n$$ G(u) = \\frac{u^2}{c_x^2 u^2 + (0.85 + 0.25 u)^2} = \\frac{u^2}{c_x^2 u^2 + 0.85^2 + 2(0.85)(0.25)u + 0.25^2 u^2} $$\n$$ G(u) = \\frac{u^2}{(c_x^2 + 0.25^2)u^2 + (0.425)u + 0.7225} $$\n为了求最大值，我们计算导数 $G'(u)$ 并令其为零。使用商法则，导数的分子为：\n$$ \\frac{d}{du}(\\text{Numerator}) = (2u)((c_x^2 + 0.25^2)u^2 + 0.425u + 0.7225) - (u^2)(2(c_x^2 + 0.25^2)u + 0.425) $$\n$$ = 2u(c_x^2 + 0.25^2)u^2 + 0.85u^2 + 1.445u - 2u(c_x^2 + 0.25^2)u^2 - 0.425u^2 $$\n$$ = 0.425u^2 + 1.445u = u(0.425u + 1.445) $$\n令分子为零，得到 $u=0$ 或 $0.425u + 1.445 = 0$，解得 $u = -1.445/0.425 \\approx -3.4$。非零极值点不在我们的关注域 $u \\in [0, 1]$ 内。导数的分子 $u(0.425u + 1.445)$ 对于所有 $u \\in (0, 1]$ 都是严格为正的。因此，$G(u)$ 在区间 $[0, 1]$ 上是一个单调递增函数。$R(u)$ 的最大值必然出现在 $u$ 的最大可能值处，即 $u=1$。\n\n我们现在通过令 $u=1$ 来计算这个最大值：\n$$ \\max R(t) = R(u=1) = \\frac{f \\sqrt{A_x^2 + A_y^2}}{g} \\frac{1}{\\sqrt{c_x^2 + (0.85 + 0.25)^2}} $$\n代入给定的数值：$f = 0.061$，$g = 9.81 \\, \\text{m s}^{-2}$，$A_x = 2.5 \\, \\text{m s}^{-2}$，$A_y = 1.5 \\, \\text{m s}^{-2}$，以及 $c_x = 0.20$。\n$$ \\max R(t) = \\frac{0.061 \\sqrt{2.5^2 + 1.5^2}}{9.81} \\frac{1}{\\sqrt{0.20^2 + (1.10)^2}} $$\n$$ \\max R(t) = \\frac{0.061 \\sqrt{6.25 + 2.25}}{9.81} \\frac{1}{\\sqrt{0.04 + 1.21}} $$\n$$ \\max R(t) = \\frac{0.061 \\sqrt{8.5}}{9.81 \\sqrt{1.25}} $$\n$$ \\max R(t) = \\frac{0.061 \\times 2.9154759...}{9.81 \\times 1.118034...} = \\frac{0.177844...}{10.9679...} $$\n$$ \\max R(t) \\approx 0.0162147 $$\n四舍五入到四位有效数字，该比率的峰值为 $0.01621$。这表明，对于这个特定的低速行走模型，在峰值时，小腿-足部节段的惯性力大小约是地面反作用力大小的 $1.62\\%$。",
            "answer": "$$\\boxed{0.01621}$$"
        },
        {
            "introduction": "现代生物力学研究在很大程度上依赖于计算建模和仿真来探索“如果……会怎样？”的场景。这个实践将理论与计算应用相结合，指导你建立一个简化的踝关节肌腱单位模型。你将利用这个模型进行一次灵敏度分析 ，研究系统的输出（峰值功率）如何依赖于其内部参数（肌腱刚度），这是一种理解生物系统功能的重要研究方法。",
            "id": "4184612",
            "problem": "要求您基于力学第一性原理和一致的建模假设，对简化步态站立期中跟腱刚度对峰值踝关节功率的灵敏度进行分析。考虑一个矢状面内的踝关节，其跟腱被建模为一个线性弹性元件（胡克弹簧）。该肌腱的刚度为 $k$（单位：牛顿/米），力臂为 $r$（单位：米），且仅在脚踝背屈超过一个小的松弛阈值角 $\\theta_{\\text{slack}}$ 时才起作用。假设在站立期间，肌腱无阻尼，且肌纤维长度变化可忽略不计，因此当肌腱起作用时，所有肌腱复合体的长度变化都由肌腱承担。\n\n基本定义和假设：\n- 踝关节角度 $\\theta(t)$ 定义为背屈为正，跖屈为负（角度单位：弧度）。在持续时间为 $T$ 的站立期内，踝关节角度由一个平滑函数描述，该函数捕捉了先背屈后跖屈的运动过程：\n  $$ \\theta(t) = A_1 \\sin\\left(\\frac{\\pi t}{T}\\right) + A_2 \\sin\\left(\\frac{2\\pi t}{T} + \\phi\\right), \\quad t \\in [0, T]. $$\n- 踝关节角速度为 $\\omega(t) = d\\theta/dt$（单位：弧度/秒）。\n- 由踝关节旋转引起的肌腱复合体长度变化等于力臂乘以角度变化（小角度、刚性力臂近似）：角度变化 $\\Delta \\theta$ 产生肌腱长度变化 $r \\,\\Delta \\theta$。\n- 肌腱仅在背屈角度超过松弛阈值 $\\theta_{\\text{slack}}$ 时才起作用，即仅当 $\\theta(t)  \\theta_{\\text{slack}}$ 时。当起作用时，肌腱力与其伸长量成线性关系：\n  $$ F_{\\text{tendon}}(t) = k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+, $$\n  其中 $[x]_+ = \\max(0,x)$ 表示正部函数。当肌腱不起作用时，$F_{\\text{tendon}}(t) = 0$。\n- 跟腱产生一个绕踝关节的跖屈力矩。根据上述符号约定，由肌腱产生的踝关节力矩为\n  $$ M_{\\text{ankle}}(t) = -\\, r \\, F_{\\text{tendon}}(t), $$\n  单位为牛顿-米。负号表示肌腱作用于跖屈方向（相对于背屈为正的约定，跖屈为负）。\n- 踝关节功率由机械功率关系定义\n  $$ P_{\\text{ankle}}(t) = M_{\\text{ankle}}(t)\\,\\omega(t), $$\n  单位为瓦特。\n\n您的任务是，对于一组给定的肌腱剛度值 $k$，计算在站立期间隔 $t \\in [0, T]$ 内的峰值正踝关节功率，即 $P_{\\text{ankle}}(t)$ 在 $P_{\\text{ankle}}(t) \\ge 0$ 时的最大值。如果 $P_{\\text{ankle}}(t)$ 在任何时候都非正，则该情况下报告 $0$。\n\n使用以下参数值，这些值对于人类步态在生理学上是合理的：\n- 站立期持续时间：$T = 0.6$ 秒。\n- 力臂：$r = 0.05$ 米。\n- 松弛阈值角：$\\theta_{\\text{slack}} = 0.04$ 弧度。\n- 角度合成系数：$A_1 = 0.22$ 弧度, $A_2 = -0.18$ 弧度, 以及相位 $\\phi = 0.5$ 弧度。\n\n角度必须以弧度为单位，时间以秒为单位，刚度 $k$ 以牛顿/米为单位，功率以瓦特为单位报告。通过对给定的 $\\theta(t)$ 对时间求导来精确计算 $\\omega(t)$。\n\n测试组（待评估的刚度值）：\n- 情况 1：$k = 0.0$ $\\text{N/m}$（边界情况，无肌腱刚度）。\n- 情况 2：$k = 100000.0$ $\\text{N/m}$。\n- 情况 3：$k = 250000.0$ $\\text{N/m}$。\n- 情况 4：$k = 500000.0$ $\\text{N/m}$。\n- 情况 5：$k = 1000000.0$ $\\text{N/m}$。\n- 情况 6：$k = 2000000.0$ $\\text{N/m}$（边缘情况，刚度非常高）。\n\n程序要求：\n- 为每个指定的 $k$ 值实现上述模型，并计算在 $t \\in [0, T]$ 上的 $P_{\\text{ankle}}(t)$。\n- 对于每种情况，返回以瓦特为单位的峰值正功率值，四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按照测试组刚度值顺序（从情况 1 到情况 6）排列的结果。例如：\n  $$ [p_1,p_2,p_3,p_4,p_5,p_6]. $$",
            "solution": "用户要求基于所提供的步态站立期踝关节生物力学模型，对跟腱刚度对峰值踝关节功率进行灵敏度分析。\n\n**问题验证**\n\n首先，我将验证问题陈述。\n\n**步骤 1：提取给定信息**\n\n*   **模型组成部分**：跟腱作为线性弹性弹簧。\n*   **踝关节角度运动学**：$\\theta(t) = A_1 \\sin(\\frac{\\pi t}{T}) + A_2 \\sin(\\frac{2\\pi t}{T} + \\phi)$ 对于 $t \\in [0, T]$。背屈为正。\n*   **角速度**：$\\omega(t) = d\\theta/dt$。\n*   **肌腱作用条件**：仅当 $\\theta(t)  \\theta_{\\text{slack}}$ 时起作用。\n*   **肌腱力**：$F_{\\text{tendon}}(t) = k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+$, 其中 $[x]_+ = \\max(0,x)$。\n*   **踝关节力矩**：$M_{\\text{ankle}}(t) = -\\, r \\, F_{\\text{tendon}}(t)$。\n*   **踝关节功率**：$P_{\\text{ankle}}(t) = M_{\\text{ankle}}(t)\\,\\omega(t)$。\n*   **目标**：计算 $\\max\\{P_{\\text{ankle}}(t) \\mid P_{\\text{ankle}}(t) \\ge 0, t \\in [0, T]\\}$。如果没有正功率，则报告 $0$。\n*   **常量**：\n    *   站立期持续时间：$T = 0.6$ 秒。\n    *   力臂：$r = 0.05$ 米。\n    *   松弛阈值角：$\\theta_{\\text{slack}} = 0.04$ 弧度。\n    *   角度系数：$A_1 = 0.22$ 弧度, $A_2 = -0.18$ 弧度。\n    *   相位：$\\phi = 0.5$ 弧度。\n*   **刚度 $k$ (N/m) 的测试案例**：$0.0$, $100000.0$, $250000.0$, $500000.0$, $1000000.0$, $2000000.0$。\n\n**步骤 2：使用提取的给定信息进行验证**\n\n*   **科学依据**：该问题很好地基于刚体力学和生物力学的原理。该模型虽然经过简化（例如，线性肌腱刚度、恒定力臂），但在步态分析中是标准且可接受的一阶近似。力矩和功率的方程是基础性的。\n*   **适定性**：所有必要的参数、函数和边界条件都已明确定义。在一个闭区间上寻找一个连续函数的最大值，这是一个适定的数学问题。\n*   **目标**：问题以精确的数学语言陈述，没有主观性或模糊性。\n\n该问题没有表现出任何缺陷，如科学上不健全、不完整、矛盾或不可行。该模型是与特定主题相关的物理系统的一个有效、可形式化的表示。\n\n**步骤 3：结论与行动**\n\n此问题是**有效的**。将提供一个解决方案。\n\n**求解推导**\n\n目标是针对几个肌腱刚度 $k$ 值，确定峰值正踝关节功率 $P_{\\text{ankle}}(t)$。求解过程首先推导 $P_{\\text{ankle}}(t)$ 的完整解析表达式，然后定义一个数值程序来找到其最大值。\n\n**1. 控制方程**\n踝关节角度 $\\theta(t)$ 由以下公式给出：\n$$ \\theta(t) = A_1 \\sin\\left(\\frac{\\pi t}{T}\\right) + A_2 \\sin\\left(\\frac{2\\pi t}{T} + \\phi\\right) $$\n瞬时踝关节功率 $P_{\\text{ankle}}(t)$ 是关节力矩 $M_{\\text{ankle}}(t)$ 和关节角速度 $\\omega(t)$ 的乘积：\n$$ P_{\\text{ankle}}(t) = M_{\\text{ankle}}(t)\\,\\omega(t) $$\n\n**2. 角速度 $\\omega(t)$**\n角速度 $\\omega(t)$ 是角度 $\\theta(t)$ 对时间的一阶导数。应用链式法则进行微分：\n$$ \\omega(t) = \\frac{d\\theta}{dt} = \\frac{d}{dt}\\left[A_1 \\sin\\left(\\frac{\\pi t}{T}\\right) + A_2 \\sin\\left(\\frac{2\\pi t}{T} + \\phi\\right)\\right] $$\n$$ \\omega(t) = A_1 \\cos\\left(\\frac{\\pi t}{T}\\right) \\cdot \\frac{\\pi}{T} + A_2 \\cos\\left(\\frac{2\\pi t}{T} + \\phi\\right) \\cdot \\frac{2\\pi}{T} $$\n$$ \\omega(t) = \\frac{\\pi A_1}{T} \\cos\\left(\\frac{\\pi t}{T}\\right) + \\frac{2\\pi A_2}{T} \\cos\\left(\\frac{2\\pi t}{T} + \\phi\\right) $$\n\n**3. 踝关节功率 $P_{\\text{ankle}}(t)$**\n现在我们构建功率的完整表达式。踝关节力矩为 $M_{\\text{ankle}}(t) = -r F_{\\text{tendon}}(t)$。只有当踝关节背屈超过松弛角时，肌腱力才起作用，$F_{\\text{tendon}}(t) = k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+$。将这些代入功率方程：\n$$ P_{\\text{ankle}}(t) = \\left( -r F_{\\text{tendon}}(t) \\right) \\omega(t) $$\n$$ P_{\\text{ankle}}(t) = -r \\left( k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+ \\right) \\omega(t) $$\n项 $r\\,(\\theta(t) - \\theta_{\\text{slack}})$ 表示肌腱超过其松弛长度的伸长量。正部算子 $[x]_+ = \\max(0,x)$ 确保肌腱仅在被拉伸时产生张力。由于 $r  0$，我们可以将其从正部函数中提取出来：\n$$ P_{\\text{ankle}}(t) = -r \\left( k r \\,[\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\right) \\omega(t) $$\n$$ P_{\\text{ankle}}(t) = -k r^2 [\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\omega(t) $$\n这是瞬时踝关节功率的最终表达式。\n\n**4. 正功率的条件**\n我们感兴趣的是峰值*正*功率，它代表了肌腱-肌肉单元产生的能量。为了使 $P_{\\text{ankle}}(t)$ 为正，鉴于 $k  0$ 和 $r^2  0$：\n$$ -k r^2 [\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\omega(t)  0 $$\n这个不等式成立当且仅当乘积 $[\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\omega(t)$ 为负。根据定义，正部函数是非负的。要使整个项不为零，我们必须首先有 $[\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+  0$，这要求 $\\theta(t)  \\theta_{\\text{slack}}$。\n在此条件下，不等式简化为要求 $\\omega(t)  0$。\n\n因此，只有当两个条件同时满足时，才会产生正功率：\n1.  踝关节背屈超过松弛阈值：$\\theta(t)  \\theta_{\\text{slack}}$。\n2.  踝关节正朝跖屈方向运动：$\\omega(t)  0$。\n\n在物理上，这对应于步态中称为“蹬离”的阶段，此时被拉伸的跟腱回缩，释放储存的弹性势能，为足部对抗地面的跖屈提供动力。\n\n**5. 计算策略**\n$P_{\\text{ankle}}(t)$ 的表达式很复杂，涉及到超越函数和不可微的正部函数。通过解析方法找到最大值是难以处理的。因此，数值方法是一种可靠且合适的方法。\n\n对于每个给定的刚度值 $k$，程序如下：\n1.  将时间区间 $t \\in [0, T]$ 离散化为一个精细的时间点网格。足够多的点（例如，10001个）可确保高精度。\n2.  对于时间网格中的每个点，使用上面推导的方程计算相应的踝关节角度 $\\theta(t)$ 和角速度 $\\omega(t)$。\n3.  使用这些运动学值计算给定 $k$ 值的瞬时踝关节功率 $P_{\\text{ankle}}(t)$。\n4.  从得到的功率值数组中，选择所有非负值 ($P_{\\text{ankle}}(t) \\ge 0$)。\n5.  峰值正功率是这个非负值子集中的最大值。如果此子集为空，则峰值正功率为 $0$。\n6.  特殊情况 $k=0$ 导致对所有 $t$ 都有 $P_{\\text{ankle}}(t) = 0$，因此峰值正功率自然为 $0$。\n7.  按要求将每个 $k$ 的最终结果四舍五入到三位小数。\n\n此程序将对测试组中的每个刚度值实施。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not required for this implementation\n\ndef solve():\n    \"\"\"\n    Calculates the peak positive ankle joint power for a range of Achilles\n    tendon stiffness values based on a simplified biomechanical model of gait.\n    \"\"\"\n\n    # Define the constants and parameters from the problem statement.\n    T = 0.6  # Stance duration in seconds\n    r = 0.05  # Moment arm in meters\n    theta_slack = 0.04  # Slack threshold angle in radians\n    A1 = 0.22  # Angle synthesis coefficient in radians\n    A2 = -0.18  # Angle synthesis coefficient in radians\n    phi = 0.5  # Phase shift in radians\n\n    # Test suite of tendon stiffness values (k) in N/m.\n    test_cases = [\n        0.0,\n        100000.0,\n        250000.0,\n        500000.0,\n        1000000.0,\n        2000000.0,\n    ]\n\n    results = []\n\n    # A sufficiently large number of points for accurate numerical approximation.\n    num_points = 10001\n    # Create a discretized time vector over the stance interval [0, T].\n    t = np.linspace(0, T, num_points)\n\n    # Calculate the kinematic variables (angle and angular velocity) over time.\n    # These are independent of stiffness k and can be pre-calculated.\n    \n    # Ankle angle theta(t)\n    theta_t = A1 * np.sin(np.pi * t / T) + A2 * np.sin(2 * np.pi * t / T + phi)\n    \n    # Ankle angular velocity omega(t) = d(theta)/dt\n    omega_t = (np.pi * A1 / T) * np.cos(np.pi * t / T) + \\\n              (2 * np.pi * A2 / T) * np.cos(2 * np.pi * t / T + phi)\n\n    # Iterate through each stiffness value to perform the sensitivity analysis.\n    for k in test_cases:\n        # Trivial case: if stiffness is zero, no force is generated, so power is zero.\n        if k == 0.0:\n            results.append(0.0)\n            continue\n\n        # Calculate instantaneous ankle power using the derived formula:\n        # P_ankle(t) = -k * r^2 * [theta(t) - theta_slack]_+ * omega(t)\n        \n        # Calculate the angle relative to the slack threshold.\n        theta_above_slack = theta_t - theta_slack\n        \n        # Apply the positive-part function, [x]_+ = max(0, x).\n        # This ensures the tendon only produces force when stretched beyond slack.\n        theta_above_slack_positive = np.maximum(0, theta_above_slack)\n        \n        # Calculate the power array for all time points.\n        power_t = -k * r**2 * theta_above_slack_positive * omega_t\n        \n        # Filter for non-negative power values as per the problem statement.\n        positive_power_values = power_t[power_t = 0]\n        \n        # Determine the peak positive power.\n        if positive_power_values.size  0:\n            peak_positive_power = np.max(positive_power_values)\n        else:\n            # If there are no positive power values, the result is 0.\n            peak_positive_power = 0.0\n            \n        # Round the result to three decimal places and append to the list.\n        results.append(round(peak_positive_power, 3))\n\n    # Format the final output as a comma-separated list in brackets.\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}