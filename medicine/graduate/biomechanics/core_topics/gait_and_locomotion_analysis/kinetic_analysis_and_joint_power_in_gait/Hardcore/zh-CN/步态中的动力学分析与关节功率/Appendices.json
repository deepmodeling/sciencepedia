{
    "hands_on_practices": [
        {
            "introduction": "逆动力学是步态动力学分析的基石。本练习将牛顿-欧拉方程应用于一个刚体模型（足部），旨在将外部测量的力（地面反作用力）和运动（加速度）转化为内部的关节动力学量（踝关节力矩）。通过这个实践 ，您将掌握核心的计算技能，并加深对动态活动中关节如何平衡外力与惯性力的理解。",
            "id": "4184617",
            "problem": "需要对支撑后期的足部节段进行平面逆动力学分析，使用牛顿-欧拉方程来求得踝关节的净跖屈力矩。假设以下物理上一致的设置。\n\n一个右手惯性坐标系的原点固定在踝关节中心。$x$轴指向前方，$y$轴指向上方，$z$轴指向矢状面外。根据右手定则，$z$分量为正的力矩对应于逆时针旋转（背屈）。定义所报告的踝关节力矩以跖屈为正，即标量跖屈力矩为 $M_{\\mathrm{pf}}=-M_{z}$，其中 $M_{z}$ 是作用于足部的踝关节净力矩的 $z$ 分量。\n\n在支撑后期的某一特定时刻，测量或估计得到以下数据：\n- 足部质量：$m=1.05\\,\\text{kg}$。\n- 足部质心 (COM) 相对于踝关节的位置：$\\mathbf{r}_{G/A}=\\begin{bmatrix}0.070 \\\\ -0.030 \\\\ 0\\end{bmatrix}\\,\\text{m}$。\n- 足部绕其质心 (COM) 的 $z$ 轴的平面质量惯性矩：$I_{G}=0.0065\\,\\text{kg}\\cdot\\text{m}^{2}$。\n- 作用于压力中心 (COP) 的地面反作用力 (GRF)：$\\mathbf{F}_{\\mathrm{GRF}}=\\begin{bmatrix}120 \\\\ 900 \\\\ 0\\end{bmatrix}\\,\\text{N}$。\n- 压力中心 (COP) 相对于踝关节的位置：$\\mathbf{r}_{\\mathrm{COP}/A}=\\begin{bmatrix}0.140 \\\\ -0.020 \\\\ 0\\end{bmatrix}\\,\\text{m}$。\n- 足部质心 (COM) 的绝对线加速度：$\\mathbf{a}_{G}=\\begin{bmatrix}0.80 \\\\ -2.50 \\\\ 0\\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n- 足部绕 $z$ 轴的角加速度（逆时针为正）：$\\alpha_{z}=-22.0\\,\\text{rad}\\cdot\\text{s}^{-2}$。\n- 重力加速度：$\\mathbf{g}=\\begin{bmatrix}0 \\\\ -9.81 \\\\ 0\\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n\n将足部视为一个刚性平面体，并忽略除指定外的任何其他外力或力矩。使用牛顿-欧拉方程，通过对踝关节中心进行力矩平衡，计算该时刻的踝关节净跖屈力矩 $M_{\\mathrm{pf}}$。答案以 $\\text{N}\\cdot\\text{m}$ 为单位，并四舍五入至四位有效数字。将最终结果表示为单个数字。",
            "solution": "用户要求我解决一个生物力学问题。\n\n### 步骤1：提取已知条件\n-   坐标系：右手惯性坐标系，原点位于踝关节中心 ($A$)。$x$轴指向前方，$y$轴指向上方，$z$轴指向矢状面外。正的 $z$ 向力矩为逆时针（背屈）。\n-   踝关节力矩的定义：跖屈力矩 $M_{\\mathrm{pf}} = -M_{z}$，其中 $M_{z}$ 是作用于足部的踝关节净力矩的 $z$ 分量。\n-   足部质量: $m = 1.05\\,\\text{kg}$。\n-   足部质心相对于踝关节的位置: $\\mathbf{r}_{G/A} = \\begin{bmatrix} 0.070 \\\\ -0.030 \\\\ 0 \\end{bmatrix}\\,\\text{m}$。\n-   绕质心的质量惯性矩: $I_{G} = 0.0065\\,\\text{kg}\\cdot\\text{m}^{2}$ (绕 $z$ 轴)。\n-   地面反作用力: $\\mathbf{F}_{\\mathrm{GRF}} = \\begin{bmatrix} 120 \\\\ 900 \\\\ 0 \\end{bmatrix}\\,\\text{N}$。\n-   压力中心相对于踝关节的位置: $\\mathbf{r}_{\\mathrm{COP}/A} = \\begin{bmatrix} 0.140 \\\\ -0.020 \\\\ 0 \\end{bmatrix}\\,\\text{m}$。\n-   足部质心的绝对线加速度: $\\mathbf{a}_{G} = \\begin{bmatrix} 0.80 \\\\ -2.50 \\\\ 0 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n-   足部角加速度: $\\alpha_{z} = -22.0\\,\\text{rad}\\cdot\\text{s}^{-2}$ (绕 $z$ 轴)。\n-   重力加速度: $\\mathbf{g} = \\begin{bmatrix} 0 \\\\ -9.81 \\\\ 0 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2}$。\n-   假设：足部为刚性平面体。其他外力/力矩可忽略不计。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于刚体动力学的牛顿-欧拉方程，这是经典力学的基本原理。其应用是生物力学中的逆动力学，这是一个标准且成熟的领域。所有提供的值对于人体步态分析都是物理上合理的。\n-   **适定性**：问题提供了所有必要的数据和一个明确的目标：计算单个标量值 $M_{\\mathrm{pf}}$。计算方法（绕踝关节的力矩平衡）已指定，从而可以得到唯一解。\n-   **客观性**：问题使用精确的技术语言陈述，对坐标系和力矩约定有明确的定义。\n\n该问题是自洽的、一致的且科学上合理的。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n该问题要求使用基于牛顿-欧拉方程的平面逆动力学分析来计算踝关节的净跖屈力矩。我们将对绕踝关节中心（我们记为点 $A$）的力矩求和。对于平面运动中的刚体，绕任意点 $A$ 的外力矩之和与质心 ($G$) 的加速度和物体的角加速度 ($\\boldsymbol{\\alpha}$) 之间的关系由以下方程给出：\n$$ \\sum \\mathbf{M}_A = I_G \\boldsymbol{\\alpha} + \\mathbf{r}_{G/A} \\times (m \\mathbf{a}_G) $$\n其中 $I_G$ 是绕质心的惯性矩，$\\mathbf{r}_{G/A}$ 是从 $A$ 到 $G$ 的位置矢量，$m$ 是质量，$\\mathbf{a}_G$ 是质心的绝对加速度。\n\n作用于足部、绕踝关节中心 $A$ 的外力矩有：\n1.  由小腿施加于足部的净踝关节力矩，我们记为 $\\mathbf{M}_A$。这是待求的量。\n2.  由作用于压力中心 (COP) 的地面反作用力 $\\mathbf{F}_{\\mathrm{GRF}}$ 产生的力矩，由 $\\mathbf{M}_{\\mathrm{GRF}} = \\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}$ 给出。\n3.  由作用于足部质心 $G$ 的重力（重量）产生的力矩，由 $\\mathbf{M}_{\\text{gravity}} = \\mathbf{r}_{G/A} \\times (m \\mathbf{g})$ 给出。\n\n这些外力矩的总和是：\n$$ \\sum \\mathbf{M}_A = \\mathbf{M}_A + (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}) + (\\mathbf{r}_{G/A} \\times (m \\mathbf{g})) $$\n\n令 $\\sum \\mathbf{M}_A$ 的两个表达式相等，我们得到：\n$$ \\mathbf{M}_A + (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}) + (\\mathbf{r}_{G/A} \\times (m \\mathbf{g})) = I_G \\boldsymbol{\\alpha} + \\mathbf{r}_{G/A} \\times (m \\mathbf{a}_G) $$\n\n我们可以解出踝关节力矩 $\\mathbf{M}_A$：\n$$ \\mathbf{M}_A = I_G \\boldsymbol{\\alpha} + \\mathbf{r}_{G/A} \\times (m \\mathbf{a}_G) - (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}}) - (\\mathbf{r}_{G/A} \\times (m \\mathbf{g})) $$\n\n由于运动是平面的，我们只关心这个矢量方程的 $z$ 分量。设 $M_z$ 是 $\\mathbf{M}_A$ 的 $z$ 分量。对于任意两个矢量 $\\mathbf{u} = \\begin{bmatrix}u_x \\\\ u_y \\\\ 0\\end{bmatrix}$ 和 $\\mathbf{v} = \\begin{bmatrix}v_x \\\\ v_y \\\\ 0\\end{bmatrix}$，它们叉乘的 $z$ 分量是 $(\\mathbf{u} \\times \\mathbf{v})_z = u_x v_y - u_y v_x$。$I_G \\boldsymbol{\\alpha}$ 的 $z$ 分量是 $I_G \\alpha_z$。\n\n$M_z$ 的方程变为：\n$$ M_z = I_G \\alpha_z + (r_{G/A,x} (m a_{G,y}) - r_{G/A,y} (m a_{G,x})) - (r_{\\mathrm{COP}/A,x} F_{\\mathrm{GRF},y} - r_{\\mathrm{COP}/A,y} F_{\\mathrm{GRF},x}) - (r_{G/A,x} (m g_y) - r_{G/A,y} (m g_x)) $$\n\n现在我们代入给定的值。首先，我们计算右侧每一项的 $z$ 分量。\n\n1.  惯性力矩项：$I_G \\alpha_z$\n    $$ I_G \\alpha_z = (0.0065\\,\\text{kg}\\cdot\\text{m}^{2}) \\times (-22.0\\,\\text{rad}\\cdot\\text{s}^{-2}) = -0.143\\,\\text{N}\\cdot\\text{m} $$\n\n2.  “惯性力”力矩项：$(\\mathbf{r}_{G/A} \\times m \\mathbf{a}_G)_z$\n    线动量的变化率是 $m \\mathbf{a}_G = 1.05\\,\\text{kg} \\times \\begin{bmatrix} 0.80 \\\\ -2.50 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2} = \\begin{bmatrix} 0.84 \\\\ -2.625 \\end{bmatrix}\\,\\text{N}$。\n    $$ (\\mathbf{r}_{G/A} \\times m \\mathbf{a}_G)_z = (0.070\\,\\text{m})(-2.625\\,\\text{N}) - (-0.030\\,\\text{m})(0.84\\,\\text{N}) $$\n    $$ = -0.18375\\,\\text{N}\\cdot\\text{m} + 0.0252\\,\\text{N}\\cdot\\text{m} = -0.15855\\,\\text{N}\\cdot\\text{m} $$\n\n3.  地面反作用力力矩项：$(\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}})_z$\n    $$ (\\mathbf{r}_{\\mathrm{COP}/A} \\times \\mathbf{F}_{\\mathrm{GRF}})_z = (0.140\\,\\text{m})(900\\,\\text{N}) - (-0.020\\,\\text{m})(120\\,\\text{N}) $$\n    $$ = 126\\,\\text{N}\\cdot\\text{m} - (-2.4\\,\\text{N}\\cdot\\text{m}) = 128.4\\,\\text{N}\\cdot\\text{m} $$\n\n4.  重力力矩项：$(\\mathbf{r}_{G/A} \\times m \\mathbf{g})_z$\n    重力是 $m \\mathbf{g} = 1.05\\,\\text{kg} \\times \\begin{bmatrix} 0 \\\\ -9.81 \\end{bmatrix}\\,\\text{m}\\cdot\\text{s}^{-2} = \\begin{bmatrix} 0 \\\\ -10.3005 \\end{bmatrix}\\,\\text{N}$。\n    $$ (\\mathbf{r}_{G/A} \\times m \\mathbf{g})_z = (0.070\\,\\text{m})(-10.3005\\,\\text{N}) - (-0.030\\,\\text{m})(0\\,\\text{N}) $$\n    $$ = -0.721035\\,\\text{N}\\cdot\\text{m} $$\n\n现在，将这些分量代回 $M_z$ 的方程中：\n$$ M_z = (-0.143) + (-0.15855) - (128.4) - (-0.721035) $$\n$$ M_z = -0.143 - 0.15855 - 128.4 + 0.721035 $$\n$$ M_z = -127.980515\\,\\text{N}\\cdot\\text{m} $$\n问题定义以跖屈为正的力矩 $M_{\\mathrm{pf}}$ 为 $M_{\\mathrm{pf}} = -M_z$。\n$$ M_{\\mathrm{pf}} = -(-127.980515\\,\\text{N}\\cdot\\text{m}) = 127.980515\\,\\text{N}\\cdot\\text{m} $$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是 $8$，所以我们将第四位数字向上取整。\n$$ M_{\\mathrm{pf}} \\approx 128.0\\,\\text{N}\\cdot\\text{m} $$\n正值表示净跖屈力矩，这在步态的蹬离阶段是符合预期的。",
            "answer": "$$\\boxed{128.0}$$"
        },
        {
            "introduction": "在计算出关节力矩后，下一步是理解其能量学后果。本练习关注机械功率（力矩与角速度的乘积）与功（功率对时间的积分）之间的关系，特别是负功，即能量吸收。这项实践  对于理解步态过程中肌肉和关节如何管理能量至关重要，例如在着地缓冲阶段减速身体，同时它也阐明了一个关键概念：关节反作用力虽然很大，但在理想关节模型中并不做功。",
            "id": "4184567",
            "problem": "一个健康的成年人以舒适的速度行走时，其承重反应期持续时间为 $T = 0.11$ 秒。在此期间，仪器化逆动力学报告了一个平滑的膝关节功率曲线，该曲线可由以下函数近似：\n$$\nP_{\\text{knee}}(t) = -P_{0}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right),\n$$\n在 $0 \\leq t \\leq T$ 的区间内，其中 $P_{0} = 180$ 瓦特（$\\mathrm{W}$）。同时，胫骨股骨关节压缩反作用力（JRF）的大小近似为：\n$$\nF_{\\text{knee}}(t) = F_{b} + F_{a}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right),\n$$\n在 $0 \\leq t \\leq T$ 的区间内，其中 $F_{b} = 1500$ 牛顿（$\\mathrm{N}$）且 $F_{a} = 1000$ 牛顿（$\\mathrm{N}$）。假设膝关节为一个理想的刚性铰链，且膝关节功率定义为膝关节净力矩与膝关节角速度的乘积。\n\n仅使用机械功率和功的基本定义，通过在 $P_{\\text{knee}}(t) < 0$ 的区间上对 $P_{\\text{knee}}(t)$ 进行积分，计算在承重反应期内的带符号膝关节负功。此外，从第一性原理出发，阐述关节反作用力（JRF）是否能在一个理想刚性关节上做机械功，从而将结果与JRF联系起来，并计算在同一区间内的压缩冲量：\n$$\nJ_{c} = \\int_{0}^{T} F_{\\text{knee}}(t)\\, dt.\n$$\n将带符号的膝关节负功作为最终答案。答案取四位有效数字，并以焦耳（$\\mathrm{J}$）为单位表示。",
            "solution": "问题要求计算步态承重反应期内的带符号膝关节负功，分析关节反作用力（JRF）对机械功的贡献，并计算压缩冲量。\n\n首先，我们处理计算带符号膝关节负功（记为 $W_{\\text{knee}}$）的主要任务。机械功 $W$ 定义为机械功率 $P(t)$ 的时间积分。\n$$\nW = \\int P(t) \\, dt\n$$\n问题给出了膝关节功率作为时间 $t$ 的函数：\n$$\nP_{\\text{knee}}(t) = -P_{0}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right)\n$$\n其中 $P_{0} = 180 \\, \\mathrm{W}$，承重反应期的持续时间为 $T = 0.11 \\, \\mathrm{s}$。我们关注的区间是 $0 \\leq t \\leq T$。题目要求我们在 $P_{\\text{knee}}(t) < 0$ 的区间上进行积分。\n\n让我们考察在区间 $0 \\leq t \\leq T$ 上 $P_{\\text{knee}}(t)$ 的符号。当 $t$ 从 $0$ 变化到 $T$ 时，正弦函数的自变量 $\\frac{\\pi t}{T}$ 的范围是从 $0$ 到 $\\pi$。在区间 $[0, \\pi]$ 内，正弦函数是非负的，即对于 $x \\in [0, \\pi]$ 有 $\\sin(x) \\geq 0$。由于 $P_{0}$ 是一个正常数（$180 \\, \\mathrm{W}$），函数 $P_{\\text{knee}}(t) = -P_{0}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right)$ 在整个 $0 \\leq t \\leq T$ 期间是非正的（$P_{\\text{knee}}(t) \\leq 0$）。在 $0 < t < T$ 时，功率是严格为负的。因此，整个积分区间是从 $t=0$ 到 $t=T$。\n\n膝关节所做的带符号的功为：\n$$\nW_{\\text{knee}} = \\int_{0}^{T} P_{\\text{knee}}(t) \\, dt = \\int_{0}^{T} -P_{0}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right) \\, dt\n$$\n我们可以将常数 $-P_{0}$ 提出来：\n$$\nW_{\\text{knee}} = -P_{0} \\int_{0}^{T} \\sin\\!\\left(\\frac{\\pi t}{T}\\right) \\, dt\n$$\n为了计算这个积分，我们使用标准形式 $\\int \\sin(at) \\, dt = -\\frac{1}{a} \\cos(at)$。此处，常数 $a$ 为 $\\frac{\\pi}{T}$。\n$$\nW_{\\text{knee}} = -P_{0} \\left[ -\\frac{T}{\\pi} \\cos\\!\\left(\\frac{\\pi t}{T}\\right) \\right]_{0}^{T}\n$$\n现在，我们在积分上下限 $t=T$ 和 $t=0$ 处计算表达式的值：\n$$\nW_{\\text{knee}} = -P_{0} \\left( \\left(-\\frac{T}{\\pi} \\cos\\!\\left(\\frac{\\pi T}{T}\\right)\\right) - \\left(-\\frac{T}{\\pi} \\cos\\!\\left(\\frac{\\pi \\cdot 0}{T}\\right)\\right) \\right)\n$$\n$$\nW_{\\text{knee}} = -P_{0} \\left( -\\frac{T}{\\pi} \\cos(\\pi) + \\frac{T}{\\pi} \\cos(0) \\right)\n$$\n使用 $\\cos(\\pi) = -1$ 和 $\\cos(0) = 1$：\n$$\nW_{\\text{knee}} = -P_{0} \\left( -\\frac{T}{\\pi}(-1) + \\frac{T}{\\pi}(1) \\right) = -P_{0} \\left( \\frac{T}{\\pi} + \\frac{T}{\\pi} \\right) = -P_{0} \\left( \\frac{2T}{\\pi} \\right)\n$$\n这就得到了功的符号表达式：\n$$\nW_{\\text{knee}} = -\\frac{2 P_{0} T}{\\pi}\n$$\n负号表示外界对关节做功，即关节在吸收能量。这是离心肌肉收缩的特征，该收缩在承重反应期间使肢体减速。\n\n代入给定的数值 $P_{0} = 180 \\, \\mathrm{W}$ 和 $T = 0.11 \\, \\mathrm{s}$：\n$$\nW_{\\text{knee}} = -\\frac{2 \\times 180 \\times 0.11}{\\pi} = -\\frac{39.6}{\\pi} \\, \\mathrm{J}\n$$\n计算数值：\n$$\nW_{\\text{knee}} \\approx -12.6050714 \\, \\mathrm{J}\n$$\n四舍五入到四位有效数字，我们得到 $W_{\\text{knee}} = -12.61 \\, \\mathrm{J}$。\n\n接下来，我们讨论JRF是否能在一个理想刚性关节上做机械功。由力 $\\vec{F}$ 所做的机械功 $dW$ 的基本定义是该力与其作用点的无穷小位移 $d\\vec{r}$ 的点积：$dW = \\vec{F} \\cdot d\\vec{r}$。如题所述，关节功率为 $P = \\vec{M} \\cdot \\vec{\\omega}$，其中 $\\vec{M}$ 是净关节力矩，$\\vec{\\omega}$ 是关节角速度。这代表了旋转功的做功速率。“理想刚性铰链”模型意味着该关节是一个完美的销接，其旋转相对于关节连接段围绕一个固定的单一轴线发生。关节反作用力 $\\vec{F}_{\\text{JRF}}$ 是一个作用于此理想铰链旋转中心的约束力。根据定义，旋转中心是相对于接触表面速度为零的点。也就是说，在施加JRF的点上没有相对位移（$d\\vec{r}_{\\text{relative}} = 0$）。因此，JRF不能在关节界面上做功（$dW_{\\text{JRF}} = \\vec{F}_{\\text{JRF}} \\cdot d\\vec{r}_{\\text{relative}} = 0$）。与两个节段相对运动相关的所有机械功都由净关节力矩完成，从而产生关节功率 $P_{\\text{knee}}(t)$。因此，从第一性原理出发，JRF对从关节功率计算出的关节功没有贡献。\n\n最后，为了完整性，我们计算压缩冲量 $J_{c}$。冲量是力的时间积分。\n$$\nJ_{c} = \\int_{0}^{T} F_{\\text{knee}}(t)\\, dt = \\int_{0}^{T} \\left( F_{b} + F_{a}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right) \\right) \\, dt\n$$\n其中 $F_{b} = 1500 \\, \\mathrm{N}$ 且 $F_{a} = 1000 \\, \\mathrm{N}$。我们将积分拆分：\n$$\nJ_{c} = \\int_{0}^{T} F_{b} \\, dt + \\int_{0}^{T} F_{a}\\,\\sin\\!\\left(\\frac{\\pi t}{T}\\right) \\, dt = F_{b} [t]_{0}^{T} + F_{a} \\int_{0}^{T} \\sin\\!\\left(\\frac{\\pi t}{T}\\right) \\, dt\n$$\n第二个积分与之前计算的相同，其值为 $\\frac{2T}{\\pi}$。\n$$\nJ_{c} = F_{b} T + F_{a} \\left(\\frac{2T}{\\pi}\\right) = T \\left( F_{b} + \\frac{2F_{a}}{\\pi} \\right)\n$$\n代入数值：\n$$\nJ_{c} = 0.11 \\left( 1500 + \\frac{2 \\times 1000}{\\pi} \\right) = 0.11 \\left( 1500 + \\frac{2000}{\\pi} \\right) \\approx 0.11 (1500 + 636.62) \\approx 235.03 \\, \\mathrm{N \\cdot s}\n$$\n该冲量表示在承重反应期间施加于胫骨股骨关节上的总时间积分压缩载荷。\n\n题目要求的最终答案是带符号的膝关节负功，我们已计算出其值为 $W_{\\text{knee}} = -\\frac{39.6}{\\pi} \\, \\mathrm{J}$，约等于 $-12.61 \\, \\mathrm{J}$。",
            "answer": "$$\n\\boxed{-12.61}\n$$"
        },
        {
            "introduction": "从分析实测数据到构建预测模型是生物力学研究的进阶。本练习采用一个简化的弹簧模型来模拟跟腱，并探究其在踝关节功率输出中的作用。通过编写代码并执行敏感性分析 ，您将学习如何运用生物力学原理构建模型以探索“假设”性问题，这是科研和临床应用中的一项核心技能。改变肌腱刚度，您将直接观察到它对踝关节功率输出能力的影响，从而体会到组织特性对人体运动的重要性。",
            "id": "4184612",
            "problem": "本题要求您运用力学第一性原理和一致的建模假设，对简化步态站立相中跟腱刚度对峰值踝关节功率的影响进行灵敏度分析。考虑一个矢状面内的踝关节，其跟腱被建模为一个线性弹性元件（胡克弹簧）。该肌腱的刚度为 $k$（单位：牛顿/米），力臂为 $r$（单位：米），且仅当踝关节背屈超过一个小的松弛阈值角 $\\theta_{\\text{slack}}$ 时才开始受力。假设在站立相期间，肌腱无阻尼，且肌纤维长度变化可忽略不计，因此当肌腱受力时，所有的肌腱复合体长度变化都由肌腱承担。\n\n基本定义和假设：\n- 踝关节角度 $\\theta(t)$ 定义为背屈为正，跖屈为负（角度单位：弧度）。在站立相持续时间 $T$ 内，踝关节角度由一个平滑函数规定，该函数描述了先背屈后跖屈的过程：\n  $$ \\theta(t) = A_1 \\sin\\!\\left(\\frac{\\pi t}{T}\\right) + A_2 \\sin\\!\\left(\\frac{2\\pi t}{T} + \\phi\\right), \\quad t \\in [0, T]. $$\n- 踝关节角速度为 $\\omega(t) = d\\theta/dt$（单位：弧度/秒）。\n- 由踝关节旋转引起的肌腱复合体长度变化等于力臂乘以角度变化（小角度、刚性力臂近似）：角度变化 $\\Delta \\theta$ 产生肌腱长度变化 $r \\,\\Delta \\theta$。\n- 肌腱仅在背屈角度超过松弛阈值 $\\theta_{\\text{slack}}$ 时才受力，即仅当 $\\theta(t) > \\theta_{\\text{slack}}$ 时。当受力时，肌腱力与其伸长量成线性关系：\n  $$ F_{\\text{tendon}}(t) = k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+, $$\n  其中 $[x]_+ = \\max(0,x)$ 表示正部函数。当不受力时，$F_{\\text{tendon}}(t) = 0$。\n- 跟腱产生一个使踝关节跖屈的力矩。根据上述符号约定，由肌腱产生的踝关节力矩为\n  $$ M_{\\text{ankle}}(t) = -\\, r \\, F_{\\text{tendon}}(t), $$\n  单位为牛顿-米。负号表示肌腱作用方向为跖屈方向（相对于背屈为正的约定，跖屈为负）。\n- 踝关节功率由机械功率关系定义\n  $$ P_{\\text{ankle}}(t) = M_{\\text{ankle}}(t)\\,\\omega(t), $$\n  单位为瓦特。\n\n您的任务是，对于一组给定的肌腱刚度值 $k$，计算在站立相区间 $t \\in [0, T]$ 内的峰值正踝关节功率，即 $P_{\\text{ankle}}(t)$ 在 $P_{\\text{ankle}}(t) \\ge 0$ 时的最大值。如果 $P_{\\text{ankle}}(t)$ 在任何时候都不为正，则报告该情况下的值为 $0$。\n\n请使用以下参数值，这些值在生理学上对于人类步态是合理的：\n- 站立相持续时间：$T = 0.6$ 秒。\n- 力臂：$r = 0.05$ 米。\n- 松弛阈值角：$\\theta_{\\text{slack}} = 0.04$ 弧度。\n- 角度合成系数：$A_1 = 0.22$ 弧度，$A_2 = -0.18$ 弧度，以及相位 $\\phi = 0.5$ 弧度。\n\n角度必须以弧度为单位，时间以秒为单位，刚度 $k$ 以牛顿/米为单位，功率以瓦特为单位报告。通过对给定的 $\\theta(t)$ 对时间求导，精确计算 $\\omega(t)$。\n\n测试集（待评估的刚度值）：\n- 情况1：$k = 0.0$ $\\text{N/m}$（边界情况，无肌腱刚度）。\n- 情况2：$k = 100000.0$ $\\text{N/m}$。\n- 情况3：$k = 250000.0$ $\\text{N/m}$。\n- 情况4：$k = 500000.0$ $\\text{N/m}$。\n- 情况5：$k = 1000000.0$ $\\text{N/m}$。\n- 情况6：$k = 2000000.0$ $\\text{N/m}$（边缘情况，刚度非常高）。\n\n程序要求：\n- 实现上述模型，并为每个指定的 $k$ 计算在 $t \\in [0, T]$ 上的 $P_{\\text{ankle}}(t)$。\n- 对于每种情况，返回峰值正功率值（单位：瓦特），并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按照测试集刚度值顺序（从情况1到情况6）计算出的结果。例如：\n  $$ [p_1,p_2,p_3,p_4,p_5,p_6]. $$",
            "solution": "用户要求基于一个给定的步态站立相踝关节生物力学模型，对跟腱刚度对峰值踝关节功率的影响进行灵敏度分析。\n\n**问题验证**\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n\n*   **模型组成部分**：跟腱作为线性弹性弹簧。\n*   **踝关节运动学**：$\\theta(t) = A_1 \\sin(\\frac{\\pi t}{T}) + A_2 \\sin(\\frac{2\\pi t}{T} + \\phi)$，对于 $t \\in [0, T]$。背屈为正。\n*   **角速度**：$\\omega(t) = d\\theta/dt$。\n*   **肌腱受力条件**：仅当 $\\theta(t) > \\theta_{\\text{slack}}$ 时受力。\n*   **肌腱力**：$F_{\\text{tendon}}(t) = k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+$, 其中 $[x]_+ = \\max(0,x)$。\n*   **踝关节力矩**：$M_{\\text{ankle}}(t) = -\\, r \\, F_{\\text{tendon}}(t)$。\n*   **踝关节功率**：$P_{\\text{ankle}}(t) = M_{\\text{ankle}}(t)\\,\\omega(t)$。\n*   **目标**：计算 $\\max\\{P_{\\text{ankle}}(t) \\mid P_{\\text{ankle}}(t) \\ge 0, t \\in [0, T]\\}$。若无正功率，则报告 $0$。\n*   **常数**：\n    *   站立相持续时间：$T = 0.6$ s。\n    *   力臂：$r = 0.05$ m。\n    *   松弛阈值角：$\\theta_{\\text{slack}} = 0.04$ rad。\n    *   角度系数：$A_1 = 0.22$ rad, $A_2 = -0.18$ rad。\n    *   相位：$\\phi = 0.5$ rad。\n*   **刚度 $k$ (N/m) 的测试用例**：$0.0$, $100000.0$, $250000.0$, $500000.0$, $1000000.0$, $2000000.0$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题在刚体力学和生物力学原理方面有充分的依据。该模型虽然是简化的（例如，线性肌腱刚度、恒定力臂），但在步态分析中是一种标准且可接受的一阶近似。力矩和功率的方程是基础性的。\n*   **适定性**：所有必要的参数、函数和边界条件都已明确定义。在一个闭区间上寻找一个连续函数的最大值的目标，是一个数学上的适定问题。\n*   **客观性**：问题以精确的数学语言陈述，没有主观性或歧义。\n\n该问题不存在科学上不健全、不完整、矛盾或不可行等缺陷。该模型是对特定主题相关的物理系统的一个有效、可形式化的表示。\n\n**步骤3：结论与行动**\n\n问题是有效的。将提供一个解决方案。\n\n**求解推导**\n\n目标是针对几个肌腱刚度 $k$ 值，确定峰值正踝关节功率 $P_{\\text{ankle}}(t)$。求解过程首先推导出 $P_{\\text{ankle}}(t)$ 的完整解析表达式，然后定义一个数值方法来找到其最大值。\n\n**1. 控制方程**\n踝关节角度 $\\theta(t)$ 由下式给出：\n$$ \\theta(t) = A_1 \\sin\\!\\left(\\frac{\\pi t}{T}\\right) + A_2 \\sin\\!\\left(\\frac{2\\pi t}{T} + \\phi\\right) $$\n瞬时踝关节功率 $P_{\\text{ankle}}(t)$ 是关节力矩 $M_{\\text{ankle}}(t)$ 和关节角速度 $\\omega(t)$ 的乘积：\n$$ P_{\\text{ankle}}(t) = M_{\\text{ankle}}(t)\\,\\omega(t) $$\n\n**2. 角速度 $\\omega(t)$**\n角速度 $\\omega(t)$ 是角度 $\\theta(t)$ 对时间的一阶导数。应用链式法则求导：\n$$ \\omega(t) = \\frac{d\\theta}{dt} = \\frac{d}{dt}\\left[A_1 \\sin\\!\\left(\\frac{\\pi t}{T}\\right) + A_2 \\sin\\!\\left(\\frac{2\\pi t}{T} + \\phi\\right)\\right] $$\n$$ \\omega(t) = A_1 \\cos\\!\\left(\\frac{\\pi t}{T}\\right) \\cdot \\frac{\\pi}{T} + A_2 \\cos\\!\\left(\\frac{2\\pi t}{T} + \\phi\\right) \\cdot \\frac{2\\pi}{T} $$\n$$ \\omega(t) = \\frac{\\pi A_1}{T} \\cos\\!\\left(\\frac{\\pi t}{T}\\right) + \\frac{2\\pi A_2}{T} \\cos\\!\\left(\\frac{2\\pi t}{T} + \\phi\\right) $$\n\n**3. 踝关节功率 $P_{\\text{ankle}}(t)$**\n现在我们构建功率的完整表达式。踝关节力矩为 $M_{\\text{ankle}}(t) = -r F_{\\text{tendon}}(t)$。肌腱力仅在踝关节背屈超过松弛角时才起作用，$F_{\\text{tendon}}(t) = k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+。将这些代入功率方程：\n$$ P_{\\text{ankle}}(t) = \\left( -r F_{\\text{tendon}}(t) \\right) \\omega(t) $$\n$$ P_{\\text{ankle}}(t) = -r \\left( k \\,[\\, r\\,(\\theta(t) - \\theta_{\\text{slack}}) \\,]_+ \\right) \\omega(t) $$\n项 $r\\,(\\theta(t) - \\theta_{\\text{slack}})$ 表示肌腱超过其松弛长度的伸长量。正部算子 $[x]_+ = \\max(0,x)$ 确保肌腱只在被拉伸时产生拉力。由于 $r > 0$，我们可以将其从正部函数中提取出来：\n$$ P_{\\text{ankle}}(t) = -r \\left( k r \\,[\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\right) \\omega(t) $$\n$$ P_{\\text{ankle}}(t) = -k r^2 [\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\omega(t) $$\n这是瞬时踝关节功率的最终表达式。\n\n**4. 正功率的条件**\n我们关心的是峰值*正*功率，它代表了肌肉-肌腱单元产生的能量。要使 $P_{\\text{ankle}}(t)$ 为正，鉴于 $k > 0$ 和 $r^2 > 0$：\n$$ -k r^2 [\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\omega(t) > 0 $$\n这个不等式成立的充要条件是乘积 $[\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ \\omega(t)$ 为负。根据定义，正部函数是非负的。为了使整个项不为零，我们首先必须有 $[\\, \\theta(t) - \\theta_{\\text{slack}} \\,]_+ > 0$，这要求 $\\theta(t) > \\theta_{\\text{slack}}$。\n在此条件下，不等式简化为要求 $\\omega(t) < 0$。\n\n因此，只有当两个条件同时满足时，才会产生正功率：\n1.  踝关节背屈超过松弛阈值：$\\theta(t) > \\theta_{\\text{slack}}$。\n2.  踝关节正在向跖屈方向运动：$\\omega(t) < 0$。\n\n在物理上，这对应于步态中称为“蹬伸”的阶段，此时被拉伸的跟腱回弹，释放储存的弹性势能，为足部对抗地面的跖屈提供动力。\n\n**5. 计算策略**\n$P_{\\text{ankle}}(t)$ 的表达式很复杂，涉及超越函数和一个不可微的正部函数。解析地找到最大值是不可行的。因此，数值方法是一种可靠且恰当的方法。\n\n对于每个给定的刚度值 $k$，其计算步骤如下：\n1.  将时间区间 $t \\in [0, T]$ 离散化为一个精细的时间点网格。足够多的点数（例如 10001 个）可以确保高精度。\n2.  对于时间网格中的每个点，使用上面推导的方程计算相应的踝关节角度 $\\theta(t)$ 和角速度 $\\omega(t)$。\n3.  使用这些运动学值计算给定 $k$ 值下的瞬时踝关节功率 $P_{\\text{ankle}}(t)$。\n4.  从得到的功率值数组中，选择所有非负值 ($P_{\\text{ankle}}(t) \\ge 0$)。\n5.  峰值正功率是这个非负值子集中的最大值。如果该子集为空，则峰值正功率为 $0$。\n6.  特殊情况 $k=0$ 导致对所有 $t$ 都有 $P_{\\text{ankle}}(t) = 0$，因此峰值正功率显然为 $0$。\n7.  按要求将每个 $k$ 的最终结果四舍五入到三位小数。\n\n该过程将对测试集中的每个刚度值实施。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not required for this implementation\n\ndef solve():\n    \"\"\"\n    Calculates the peak positive ankle joint power for a range of Achilles\n    tendon stiffness values based on a simplified biomechanical model of gait.\n    \"\"\"\n\n    # Define the constants and parameters from the problem statement.\n    T = 0.6  # Stance duration in seconds\n    r = 0.05  # Moment arm in meters\n    theta_slack = 0.04  # Slack threshold angle in radians\n    A1 = 0.22  # Angle synthesis coefficient in radians\n    A2 = -0.18  # Angle synthesis coefficient in radians\n    phi = 0.5  # Phase shift in radians\n\n    # Test suite of tendon stiffness values (k) in N/m.\n    test_cases = [\n        0.0,\n        100000.0,\n        250000.0,\n        500000.0,\n        1000000.0,\n        2000000.0,\n    ]\n\n    results = []\n\n    # A sufficiently large number of points for accurate numerical approximation.\n    num_points = 10001\n    # Create a discretized time vector over the stance interval [0, T].\n    t = np.linspace(0, T, num_points)\n\n    # Calculate the kinematic variables (angle and angular velocity) over time.\n    # These are independent of stiffness k and can be pre-calculated.\n    \n    # Ankle angle theta(t)\n    theta_t = A1 * np.sin(np.pi * t / T) + A2 * np.sin(2 * np.pi * t / T + phi)\n    \n    # Ankle angular velocity omega(t) = d(theta)/dt\n    omega_t = (np.pi * A1 / T) * np.cos(np.pi * t / T) + \\\n              (2 * np.pi * A2 / T) * np.cos(2 * np.pi * t / T + phi)\n\n    # Iterate through each stiffness value to perform the sensitivity analysis.\n    for k in test_cases:\n        # Trivial case: if stiffness is zero, no force is generated, so power is zero.\n        if k == 0.0:\n            results.append(0.0)\n            continue\n\n        # Calculate instantaneous ankle power using the derived formula:\n        # P_ankle(t) = -k * r^2 * [theta(t) - theta_slack]_+ * omega(t)\n        \n        # Calculate the angle relative to the slack threshold.\n        theta_above_slack = theta_t - theta_slack\n        \n        # Apply the positive-part function, [x]_+ = max(0, x).\n        # This ensures the tendon only produces force when stretched beyond slack.\n        theta_above_slack_positive = np.maximum(0, theta_above_slack)\n        \n        # Calculate the power array for all time points.\n        power_t = -k * r**2 * theta_above_slack_positive * omega_t\n        \n        # Filter for non-negative power values as per the problem statement.\n        positive_power_values = power_t[power_t >= 0]\n        \n        # Determine the peak positive power.\n        if positive_power_values.size > 0:\n            peak_positive_power = np.max(positive_power_values)\n        else:\n            # If there are no positive power values, the result is 0.\n            peak_positive_power = 0.0\n            \n        # Round the result to three decimal places and append to the list.\n        results.append(round(peak_positive_power, 3))\n\n    # Format the final output as a comma-separated list in brackets.\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}