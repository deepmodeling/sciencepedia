{
    "hands_on_practices": [
        {
            "introduction": "Gait analysis often begins with the fundamental task of identifying discrete events within the walking cycle, such as heel-strike and toe-off. This exercise guides you through the essential process of using these simple time-stamped events to compute core temporal parameters like stance and swing duration . By calculating the duty factor—the fraction of the cycle spent in stance—you will gain a quantitative insight into the stability of a gait pattern, bridging the gap between raw data and biomechanical interpretation.",
            "id": "4184045",
            "problem": "A researcher is analyzing a slow, symmetric bipedal gait using standard event definitions: the stance phase is the interval of ground contact for a given limb, the swing phase is the interval of no ground contact for that limb, and the gait cycle (stride) for a given limb is the interval from one ipsilateral heel-strike to the next ipsilateral heel-strike. Time-stamped gait events for the left limb were recorded as follows: left heel-strike at $t = 0.00 \\text{ s}$, $t = 1.32 \\text{ s}$, $t = 2.64 \\text{ s}$, and $t = 3.96 \\text{ s}$; left toe-off at $t = 0.88 \\text{ s}$, $t = 2.21 \\text{ s}$, and $t = 3.53 \\text{ s}$. Using only the fundamental kinematic definitions $T_{\\text{stance}}$ as the time difference between ipsilateral heel-strike and ipsilateral toe-off within a stride, $T_{\\text{swing}}$ as the time difference between ipsilateral toe-off and the next ipsilateral heel-strike, and $T_{\\text{stride}}$ as the time difference between successive ipsilateral heel-strikes, compute for each of the first $3$ strides the stance and swing durations for the left limb and the corresponding duty factor (defined as the fraction of the gait cycle spent in ground contact for that limb). Then, compute the mean duty factor across these $3$ strides. Finally, explain from first principles how duty factor relates to static stability margins in slow bipedal gait by referencing the projection of the Center of Mass (COM) relative to the Base of Support (BoS) and the temporal fraction of double support.\n\nExpress all durations in seconds, express duty factor as a dimensionless decimal fraction, and report only the mean duty factor as your final numeric answer. Round the mean duty factor to $4$ significant figures.",
            "solution": "The problem statement is parsed and validated. All givens, definitions, and conditions are scientifically sound, consistent, and well-posed. The problem is a standard kinematic analysis in biomechanics. The data provided are sufficient and realistic for the calculations requested. The problem is therefore deemed valid.\n\nThe solution proceeds in two parts: first, the calculation of kinematic parameters for the first $3$ strides of the left limb, and second, an explanation of the relationship between duty factor and static stability.\n\n**Part 1: Kinematic Calculations**\n\nThe problem provides time-stamped events for the left limb:\nLeft heel-strike (LHS) times: $t_{LHS,1}=0.00 \\text{ s}$, $t_{LHS,2}=1.32 \\text{ s}$, $t_{LHS,3}=2.64 \\text{ s}$, $t_{LHS,4}=3.96 \\text{ s}$.\nLeft toe-off (LTO) times: $t_{LTO,1}=0.88 \\text{ s}$, $t_{LTO,2}=2.21 \\text{ s}$, $t_{LTO,3}=3.53 \\text{ s}$.\n\nA stride is defined as the interval from one ipsilateral heel-strike to the next. We analyze the first $3$ strides.\n\n**Stride 1:**\nThis stride begins at $t_{LHS,1} = 0.00 \\text{ s}$ and ends at $t_{LHS,2} = 1.32 \\text{ s}$.\nThe stride duration, $T_{\\text{stride},1}$, is:\n$$T_{\\text{stride},1} = t_{LHS,2} - t_{LHS,1} = 1.32 \\text{ s} - 0.00 \\text{ s} = 1.32 \\text{ s}$$\nThe toe-off event corresponding to this stride is $t_{LTO,1} = 0.88 \\text{ s}$.\nThe stance duration, $T_{\\text{stance},1}$, is the time from heel-strike to toe-off:\n$$T_{\\text{stance},1} = t_{LTO,1} - t_{LHS,1} = 0.88 \\text{ s} - 0.00 \\text{ s} = 0.88 \\text{ s}$$\nThe swing duration, $T_{\\text{swing},1}$, is the time from toe-off to the next heel-strike:\n$$T_{\\text{swing},1} = t_{LHS,2} - t_{LTO,1} = 1.32 \\text{ s} - 0.88 \\text{ s} = 0.44 \\text{ s}$$\nAs a check, $T_{\\text{stride},1} = T_{\\text{stance},1} + T_{\\text{swing},1} = 0.88 \\text{ s} + 0.44 \\text{ s} = 1.32 \\text{ s}$, which is consistent.\nThe duty factor for this stride, $DF_1$, is the fraction of the stride spent in stance:\n$$DF_1 = \\frac{T_{\\text{stance},1}}{T_{\\text{stride},1}} = \\frac{0.88}{1.32} = \\frac{2}{3}$$\n\n**Stride 2:**\nThis stride begins at $t_{LHS,2} = 1.32 \\text{ s}$ and ends at $t_{LHS,3} = 2.64 \\text{ s}$.\nThe stride duration, $T_{\\text{stride},2}$, is:\n$$T_{\\text{stride},2} = t_{LHS,3} - t_{LHS,2} = 2.64 \\text{ s} - 1.32 \\text{ s} = 1.32 \\text{ s}$$\nThe toe-off event corresponding to this stride is $t_{LTO,2} = 2.21 \\text{ s}$.\nThe stance duration, $T_{\\text{stance},2}$, is:\n$$T_{\\text{stance},2} = t_{LTO,2} - t_{LHS,2} = 2.21 \\text{ s} - 1.32 \\text{ s} = 0.89 \\text{ s}$$\nThe swing duration, $T_{\\text{swing},2}$, is:\n$$T_{\\text{swing},2} = t_{LHS,3} - t_{LTO,2} = 2.64 \\text{ s} - 2.21 \\text{ s} = 0.43 \\text{ s}$$\nAs a check, $T_{\\text{stride},2} = T_{\\text{stance},2} + T_{\\text{swing},2} = 0.89 \\text{ s} + 0.43 \\text{ s} = 1.32 \\text{ s}$, which is consistent.\nThe duty factor for this stride, $DF_2$, is:\n$$DF_2 = \\frac{T_{\\text{stance},2}}{T_{\\text{stride},2}} = \\frac{0.89}{1.32}$$\n\n**Stride 3:**\nThis stride begins at $t_{LHS,3} = 2.64 \\text{ s}$ and ends at $t_{LHS,4} = 3.96 \\text{ s}$.\nThe stride duration, $T_{\\text{stride},3}$, is:\n$$T_{\\text{stride},3} = t_{LHS,4} - t_{LHS,3} = 3.96 \\text{ s} - 2.64 \\text{ s} = 1.32 \\text{ s}$$\nThe toe-off event corresponding to this stride is $t_{LTO,3} = 3.53 \\text{ s}$.\nThe stance duration, $T_{\\text{stance},3}$, is:\n$$T_{\\text{stance},3} = t_{LTO,3} - t_{LHS,3} = 3.53 \\text{ s} - 2.64 \\text{ s} = 0.89 \\text{ s}$$\nThe swing duration, $T_{\\text{swing},3}$, is:\n$$T_{\\text{swing},3} = t_{LHS,4} - t_{LTO,3} = 3.96 \\text{ s} - 3.53 \\text{ s} = 0.43 \\text{ s}$$\nAs a check, $T_{\\text{stride},3} = T_{\\text{stance},3} + T_{\\text{swing},3} = 0.89 \\text{ s} + 0.43 \\text{ s} = 1.32 \\text{ s}$, which is consistent.\nThe duty factor for this stride, $DF_3$, is:\n$$DF_3 = \\frac{T_{\\text{stance},3}}{T_{\\text{stride},3}} = \\frac{0.89}{1.32}$$\n\n**Mean Duty Factor:**\nThe mean duty factor, $\\overline{DF}$, across the $3$ strides is the arithmetic average of the individual duty factors:\n$$\\overline{DF} = \\frac{DF_1 + DF_2 + DF_3}{3} = \\frac{1}{3} \\left( \\frac{0.88}{1.32} + \\frac{0.89}{1.32} + \\frac{0.89}{1.32} \\right)$$\n$$\\overline{DF} = \\frac{0.88 + 0.89 + 0.89}{3 \\times 1.32} = \\frac{2.66}{3.96}$$\n$$\\overline{DF} \\approx 0.671717...$$\nRounding to $4$ significant figures, the mean duty factor is $0.6717$.\n\n**Part 2: Duty Factor and Static Stability**\n\nStatic stability of a body requires its center of mass (COM) to be vertically projected within its base of support (BoS). For bipedal gait, the nature of the BoS changes throughout the gait cycle.\nThe primary phases of support are single support (one foot on the ground) and double support (both feet on the ground). During single support, the BoS is limited to the area of the single supporting foot, which is very small. To maintain stability, the COM must be precisely controlled to remain over this small area, which typically requires active, dynamic control rather than relying on passive, static stability. During double support, the BoS is the convex hull of the area covered by both feet, which is significantly larger. A large BoS allows for a greater margin of error in the COM position, thus providing a high degree of static stability.\n\nThe duty factor, $DF = T_{\\text{stance}}/T_{\\text{stride}}$, is fundamentally linked to the existence and duration of the double support phase. For a symmetric gait, the heel-strike of the contralateral (e.g., right) limb occurs at $50\\%$ of the ipsilateral (e.g., left) limb's stride cycle. A double support phase occurs if the ipsilateral limb is still in its stance phase when the contralateral limb begins its stance phase.\n\nLet's normalize the stride duration of the left limb to $1$ unit of time, so $T_{\\text{stride}}=1$. The left limb is in stance for a duration of $T_{\\text{stance}} = DF$. The right limb strikes at time $t=0.5$ and begins its stance phase. The left limb's stance phase ends at time $t=DF$.\nA period of double support exists if the left limb is still on the ground when the right limb makes contact. This condition is met if $DF > 0.5$. The duration of this double support period is $T_{\\text{DS}_1} = DF - 0.5$. A second double support period occurs at the end of the left swing phase, adding to the total double support time. The total fraction of the gait cycle spent in double support is $2 \\times (DF - 0.5) = 2DF - 1$.\n\nThis relationship establishes a clear hierarchy for gait stability:\n1.  If $DF > 0.5$, then $2DF-1 > 0$, meaning there is a non-zero period of double support. This is characteristic of walking. The gait is said to have a positive static stability margin, as there are phases where the COM can be positioned within a large BoS without dynamic control. A larger $DF$ corresponds to a longer double support time, hence a greater static stability margin. The calculated $\\overline{DF} \\approx 0.67$ indicates a slow walk with significant double support time.\n2.  If $DF = 0.5$, then $2DF-1 = 0$, meaning there is no double support phase. The instant one foot makes contact, the other lifts off. This is the theoretical transition from walking to running. The gait has zero static stability margin and relies entirely on dynamic stability.\n3.  If $DF < 0.5$, the equation $2DF-1$ yields a negative value, which signifies no double support. Instead, it indicates the presence of a flight phase, where neither foot is on the ground. This is characteristic of running. Static stability is impossible, as the BoS is non-existent during the flight phase.\n\nIn conclusion, from first principles, the duty factor directly quantifies the temporal fraction of the gait cycle spent in stance. For symmetric bipedal gaits, a duty factor greater than $0.5$ is a necessary and sufficient condition for the existence of a double support phase, which in turn provides a large Base of Support and enables periods of static stability. Therefore, a higher duty factor leads to a greater static stability margin in slow bipedal gait.",
            "answer": "$$\\boxed{0.6717}$$"
        },
        {
            "introduction": "While manual event-marking is foundational, modern biomechanics relies on automated methods to analyze the large streams of continuous data produced by motion capture systems. This practice challenges you to design and implement a rule-based algorithm that automatically identifies key gait sub-phases from continuous kinematic signals . This hands-on coding exercise will strengthen your computational skills and deepen your understanding of how specific kinematic signatures, like foot pitch angle $\\theta_f(t)$ and shank angular velocity $\\omega_s(t)$, define functional periods within stance.",
            "id": "4184123",
            "problem": "Design and implement a deterministic, rule-based kinematic classifier that uses only the foot pitch angle $\\theta_f(t)$ and the shank angular velocity $\\omega_s(t)$ to identify two sub-phases within stance: foot-flat and midstance. The classifier must operate on discrete, uniformly sampled time series $\\{\\theta_f[k]\\}_{k=0}^{K-1}$ and $\\{\\omega_s[k]\\}_{k=0}^{K-1}$ with a constant sampling period $\\Delta t$. Angles must be expressed in radians, angular velocities in radians per second, and time in seconds. The model must be justified by first principles of biomechanics and kinematics, but the implementation must rely purely on the provided kinematic signals and the explicit rules below, without invoking any external context.\n\nYou must implement the following detection rules, grounded in kinematic definitions, to locate the earliest start times (within a stance interval) of foot-flat and midstance:\n\n- Foot-flat start: the earliest time index $k_{\\text{FF}}$ such that, over a contiguous dwell of at least $N_{\\text{flat}}$ samples, both conditions hold simultaneously:\n  1. $|\\theta_f[k]| \\le \\theta_{\\text{tol}}$, and\n  2. $|\\omega_s[k]| \\le \\omega_{\\text{flat}}$.\n  \n- Midstance start: the earliest time index $k_{\\text{MS}} > k_{\\text{FF}}$ such that, over a contiguous dwell of at least $N_{\\text{mid}}$ samples, both conditions hold simultaneously:\n  1. $|\\theta_f[k]| \\le \\theta_{\\text{tol}}$, and\n  2. $\\omega_s[k] \\ge \\omega_{\\text{mid}}$.\n\nIf no such index exists for a requested phase, return $-1$ for that phase. Convert the detected indices to times $t_{\\text{FF}} = k_{\\text{FF}} \\Delta t$ and $t_{\\text{MS}} = k_{\\text{MS}} \\Delta t$. The dwell sample counts must be computed from the specified dwell durations and the sampling period by $N_{\\text{flat}} = \\lceil \\Delta t_{\\text{flat}} / \\Delta t \\rceil$ and $N_{\\text{mid}} = \\lceil \\Delta t_{\\text{mid}} / \\Delta t \\rceil$.\n\nUse the following constants across all tests:\n- Angle tolerance: $\\theta_{\\text{tol}} = 0.087266$ radians.\n- Flat dwell duration: $\\Delta t_{\\text{flat}} = 0.04$ seconds.\n- Midstance dwell duration: $\\Delta t_{\\text{mid}} = 0.06$ seconds.\n- Shank low-velocity bound for flat: $\\omega_{\\text{flat}} = 0.2$ radians per second.\n- Shank advancement bound for midstance: $\\omega_{\\text{mid}} = 0.5$ radians per second.\n\nImplement your program to evaluate the following test suite. In all tests, use sampling frequency $f_s = 100$ Hertz, sampling period $\\Delta t = 1/f_s = 0.01$ seconds, total duration $T = 1.0$ seconds, and discrete time stamps $t_k = k \\Delta t$ for $k \\in \\{0,1,\\dots,99\\}$:\n\n- Test $1$ (general progression with ramping shank velocity):\n  - $\\theta_f(t) = 0.12 \\exp(-t/0.1) - 0.005$ for $t \\in [0,T)$.\n  - $\\omega_s(t) = \\begin{cases}\n    0.0, & t &lt; 0.20 \\\\\n    0.1 + \\dfrac{0.7}{0.15}(t - 0.20), & 0.20 \\le t &lt; 0.35 \\\\\n    0.8, & t \\ge 0.35\n  \\end{cases}$\n\n- Test $2$ (boundary dwell at midstance threshold; early flat):\n  - $\\theta_f(t) = 0.05$ for all $t$.\n  - $\\omega_s(t) = \\begin{cases}\n    0.0, & t &lt; 0.30 \\\\\n    0.5, & 0.30 \\le t &lt; 0.36 \\\\\n    0.49, & t \\ge 0.36\n  \\end{cases}$\n\n- Test $3$ (no midstance; flat detectable):\n  - $\\theta_f(t) = 0.02$ for all $t$.\n  - $\\omega_s(t) = 0.15$ for all $t$.\n\n- Test $4$ (no flat; no midstance because foot not flat):\n  - $\\theta_f(t) = 0.15$ for all $t$.\n  - $\\omega_s(t) = 0.6$ for all $t$.\n\n- Test $5$ (late flat followed by clear midstance):\n  - $\\theta_f(t) = 0.2 \\exp(-t/0.5)$ for $t \\in [0,T)$.\n  - $\\omega_s(t) = \\begin{cases}\n    0.1, & t &lt; 0.60 \\\\\n    0.7, & t \\ge 0.60\n  \\end{cases}$\n\nFor each test, compute $(t_{\\text{FF}}, t_{\\text{MS}})$ in seconds. Report each time as a floating-point number rounded to three decimals. If a phase is not detected, report $-1$ for that entry.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list for one test in the order given above, for example: `[[t_FF,1,t_MS,1],[t_FF,2,t_MS,2],...]`. The final numeric values must be in seconds and rounded to three decimals.",
            "solution": "The problem of designing a kinematic classifier for gait sub-phases is valid. It is scientifically grounded in biomechanics, mathematically well-posed, and all parameters and rules are specified unambiguously. The provided test cases are physically plausible within the context of a simplified gait model. We can therefore proceed with the solution.\n\n### 1. Principle-Based Design\n\nThe task is to identify the start of two key sub-phases of the stance period in human gait, foot-flat and midstance, using only the foot pitch angle $\\theta_f(t)$ and shank angular velocity $\\omega_s(t)$.\n\n- **Foot-Flat (FF):** This phase is biomechanically characterized by the foot being approximately horizontal and stationary relative to the ground. The shank, which has been rotating backward (negative angular velocity) during the loading response, slows its rotation to near zero. The classification rules formalize this:\n    1.  The foot pitch angle is close to zero: $|\\theta_f(t)| \\le \\theta_{\\text{tol}}$. This captures the \"flat\" orientation of the foot.\n    2.  The shank angular velocity is low: $|\\omega_s(t)| \\le \\omega_{\\text{flat}}$. This reflects the moment of minimal shank rotation as the body's center of mass passes over the ankle.\n- **Midstance (MS):** This phase follows foot-flat and is characterized by the shank advancing forward over the stationary foot. The body's center of mass is moving from a position behind the ankle to a position in front of it. The classification rules capture this kinematic event:\n    1.  The foot remains flat on the ground: $|\\theta_f(t)| \\le \\theta_{\\text{tol}}$.\n    2.  The shank exhibits a clear forward angular velocity: $\\omega_s(t) \\ge \\omega_{\\text{mid}}$. This signifies the progression of the tibia (shank) over the talus (ankle).\n\nThe rules also stipulate that these conditions must hold for a minimum continuous duration, or \"dwell,\" to ensure the detected event is a stable phase and not a transient artifact. This is a standard practice in biomechanical event detection to improve robustness against signal noise. The problem requires finding the *earliest* occurrence of each phase, with midstance logically constrained to occur after foot-flat ($k_{\\text{MS}} > k_{\\text{FF}}$).\n\n### 2. Algorithmic Implementation\n\nA deterministic algorithm is developed to implement these rules on discrete time series data. The overall process for each test case involves data generation, parameter calculation, and sequential event detection.\n\n#### 2.1. System Parameters and Signal Generation\n\nFirst, we establish the constants and simulation parameters. The sampling period is $\\Delta t = 1/f_s = 1/100 = 0.01$ seconds. The dwell durations in samples, $N_{\\text{flat}}$ and $N_{\\text{mid}}$, are calculated from the required time durations $\\Delta t_{\\text{flat}} = 0.04$ s and $\\Delta t_{\\text{mid}} = 0.06$ s:\n$$\nN_{\\text{flat}} = \\lceil \\frac{\\Delta t_{\\text{flat}}}{\\Delta t} \\rceil = \\lceil \\frac{0.04}{0.01} \\rceil = \\lceil 4 \\rceil = 4 \\text{ samples}\n$$\n$$\nN_{\\text{mid}} = \\lceil \\frac{\\Delta t_{\\text{mid}}}{\\Delta t} \\rceil = \\lceil \\frac{0.06}{0.01} \\rceil = \\lceil 6 \\rceil = 6 \\text{ samples}\n$$\nFor each test case, we generate the a time vector $t[k] = k \\Delta t$ for $k=0, 1, \\dots, 99$. Then, the time series for foot pitch angle, $\\{\\theta_f[k]\\}_{k=0}^{K-1}$, and shank angular velocity, $\\{\\omega_s[k]\\}_{k=0}^{K-1}$, are computed by evaluating the given functions at each time step $t[k]$.\n\n#### 2.2. Event Detection Algorithm\n\nThe core of the classifier is a search algorithm that finds the indices $k_{\\text{FF}}$ and $k_{\\text{MS}}$.\n\n**Step A: Find Foot-Flat Start ($k_{\\text{FF}}$)**\n\n1.  **Identify Candidate Samples:** For each sample index $k$ from $0$ to $K-1$, we check if the instantaneous foot-flat conditions are met. This produces a boolean array, `is_ff_candidate`, where `is_ff_candidate[k]` is true if and only if:\n    $$\n    |\\theta_f[k]| \\le \\theta_{\\text{tol}} \\quad \\text{and} \\quad |\\omega_s[k]| \\le \\omega_{\\text{flat}}\n    $$\n    Here, $\\theta_{\\text{tol}} = 0.087266$ rad and $\\omega_{\\text{flat}} = 0.2$ rad/s.\n\n2.  **Search for Dwell Window:** We iterate through the time series from index $k=0$ to $K - N_{\\text{flat}}$. For each $k$, we check if it marks the beginning of a contiguous block of at least $N_{\\text{flat}}$ candidate samples. This is equivalent to checking if all values in the slice `is_ff_candidate[k : k + N_flat]` are true.\n\n3.  **Determine $k_{\\text{FF}}$:** The first index $k$ that satisfies the dwell condition is assigned as $k_{\\text{FF}}$. If the loop completes without finding such an index, no foot-flat phase is detected, and we set $k_{\\text{FF}} = -1$.\n\n**Step B: Find Midstance Start ($k_{\\text{MS}}$)**\n\nThis step is performed only if foot-flat was successfully detected ($k_{\\text{FF}} \\neq -1$).\n\n1.  **Identify Candidate Samples:** Similar to the foot-flat step, we create a boolean array, `is_ms_candidate`, where `is_ms_candidate[k]` is true if and only if the instantaneous midstance conditions are met:\n    $$\n    |\\theta_f[k]| \\le \\theta_{\\text{tol}} \\quad \\text{and} \\quad \\omega_s[k] \\ge \\omega_{\\text{mid}}\n    $$\n    Here, $\\omega_{\\text{mid}} = 0.5$ rad/s.\n\n2.  **Search for Dwell Window:** We iterate through the time series starting from the index immediately following the start of foot-flat, i.e., from $k = k_{\\text{FF}} + 1$ up to $K - N_{\\text{mid}}$. For each $k$, we check if it marks the beginning of a contiguous block of at least $N_{\\text{mid}}$ midstance candidate samples by testing the slice `is_ms_candidate[k : k + N_mid]`.\n\n3.  **Determine $k_{\\text{MS}}$:** The first index $k$ that satisfies this condition is assigned as $k_{\\text{MS}}$. If no such index is found, or if foot-flat was not detected, we set $k_{\\text{MS}} = -1$.\n\n#### 2.3. Final Output Generation\n\nThe detected indices are converted to time in seconds using $t = k \\Delta t$. The final results for each test case, $(t_{\\text{FF}}, t_{\\text{MS}})$, are rounded to three decimal places. An index of $-1$ is reported as the integer $-1$ for the corresponding time. The collection of results from all test cases is formatted into a single string representing a list of lists, with no spaces, as specified.",
            "answer": "[[0.03,0.29],[0.0,0.3],[0.0,-1],[-1,-1],[0.42,0.6]]"
        },
        {
            "introduction": "As we move into three-dimensional motion analysis, ensuring data accuracy becomes a paramount concern, as even subtle errors in setup can corrupt results. This exercise confronts a common practical challenge: systematic bias introduced by a simple misalignment between the lab's coordinate system and a measurement device . By deriving the precise mathematical relationship between this physical error and the resulting angular measurement bias, you will solidify your command of 3D rotational kinematics and appreciate the critical importance of meticulous experimental calibration.",
            "id": "4184070",
            "problem": "A biomechanics laboratory uses a walkway whose local coordinate frame $W$ is intended to align with the laboratory global frame $L$ such that the forward progression axis is the $X$-axis, the mediolateral axis is the $Y$-axis, and the vertical axis is the $Z$-axis. In practice, the walkway frame $W$ is misaligned in the transverse plane: its axes are obtained by rotating the global frame $L$ about the $Z$-axis through a constant angle $\\alpha$ (right-hand rule about $+Z$). A rigid body segment (for example, the pelvis) has orientation in $L$ given by the time-varying rotation matrix $R_{L}(t) \\in \\mathrm{SO}(3)$. The laboratory reports transverse plane angles using a $ZXY$ Cardan sequence, where the transverse plane angle $\\psi(t)$ is defined as the first rotation about $Z$ in the decomposition of $R_{L}(t)$, and its measured counterpart $\\tilde{\\psi}(t)$ is defined analogously as the first rotation about $Z$ in the decomposition of the same physical segment orientation expressed relative to the misaligned walkway frame $W$.\n\nAssume $-\\pi < \\psi(t) < \\pi$ for all $t$ during the gait cycle, that the $ZXY$ decomposition is unique and free of singularities over the time window of interest, and that the only difference between $L$ and $W$ is the transverse plane misalignment angle $\\alpha$ about $Z$ (that is, $Z$ is identical in both frames). Using first-principles kinematics (rotation matrices, coordinate frame transformations, and Cardan angle definitions), derive the systematic bias $b(\\alpha)$ defined by $b(\\alpha) = \\tilde{\\psi}(t) - \\psi(t)$, as a function of the walkway misalignment angle $\\alpha$. Express your final analytic expression in radians. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the systematic bias in the measurement of the transverse plane angle of a rigid body segment due to a misalignment of the measurement coordinate frame. We will use first-principles kinematics involving rotation matrices and Cardan angle decompositions.\n\nFirst, let us establish the relationship between the global laboratory frame, denoted by $L$, and the misaligned walkway frame, denoted by $W$. The problem states that the frame $W$ is obtained by rotating the frame $L$ about their common $Z$-axis through a constant angle $\\alpha$. This describes the transformation of the basis vectors. Let the basis vectors of frame $L$ be $\\{\\mathbf{e}_{L,x}, \\mathbf{e}_{L,y}, \\mathbf{e}_{L,z}\\}$ and those of frame $W$ be $\\{\\mathbf{e}_{W,x}, \\mathbf{e}_{W,y}, \\mathbf{e}_{W,z}\\}$. The rotation of the frame by an angle $\\alpha$ about the $Z$-axis implies that the new basis vectors, when expressed in the old frame's coordinates, are given by:\n$$ \\mathbf{e}_{W,x} = \\cos(\\alpha)\\mathbf{e}_{L,x} + \\sin(\\alpha)\\mathbf{e}_{L,y} $$\n$$ \\mathbf{e}_{W,y} = -\\sin(\\alpha)\\mathbf{e}_{L,x} + \\cos(\\alpha)\\mathbf{e}_{L,y} $$\n$$ \\mathbf{e}_{W,z} = \\mathbf{e}_{L,z} $$\nThe rotation matrix that transforms the coordinates of a vector from frame $W$ to frame $L$, which we can denote $R_{L \\leftarrow W}$, has as its columns the basis vectors of $W$ expressed in frame $L$.\n$$ R_{L \\leftarrow W} = \\begin{pmatrix} \\cos(\\alpha) & -\\sin(\\alpha) & 0 \\\\ \\sin(\\alpha) & \\cos(\\alpha) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = R_Z(\\alpha) $$\nHere, $R_Z(\\alpha)$ represents a rotation about the $Z$-axis by an angle $\\alpha$.\n\nConversely, the rotation matrix that transforms coordinates from frame $L$ to frame $W$, denoted $R_{W \\leftarrow L}$, is the inverse of $R_{L \\leftarrow W}$.\n$$ R_{W \\leftarrow L} = (R_{L \\leftarrow W})^{-1} = (R_Z(\\alpha))^{-1} = R_Z(-\\alpha) = \\begin{pmatrix} \\cos(\\alpha) & \\sin(\\alpha) & 0 \\\\ -\\sin(\\alpha) & \\cos(\\alpha) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n\nThe orientation of the rigid body segment is given by a time-varying rotation matrix. Let's denote the body-fixed frame of the segment as $B$. The orientation of the segment in the global frame $L$ is given by the matrix $R_L(t)$, which transforms coordinates from frame $B$ to frame $L$, i.e., $R_{L \\leftarrow B}(t)$. Similarly, the orientation of the segment in the walkway frame $W$ is given by $R_W(t) = R_{W \\leftarrow B}(t)$.\n\nThe relationship between these orientation matrices can be found by composing the transformations. A vector $\\mathbf{v}_B$ in the body frame is transformed to the lab frame as $\\mathbf{v}_L = R_L(t) \\mathbf{v}_B$. The coordinates of this same vector in the walkway frame are $\\mathbf{v}_W = R_{W \\leftarrow L} \\mathbf{v}_L$. Substituting the expression for $\\mathbf{v}_L$, we get:\n$$ \\mathbf{v}_W = R_{W \\leftarrow L} (R_L(t) \\mathbf{v}_B) = (R_{W \\leftarrow L} R_L(t)) \\mathbf{v}_B $$\nBy definition, we also have $\\mathbf{v}_W = R_W(t) \\mathbf{v}_B$. Since this must hold for any vector $\\mathbf{v}_B$, we deduce the relationship between the orientation matrices:\n$$ R_W(t) = R_{W \\leftarrow L} R_L(t) $$\nSubstituting the expression for $R_{W \\leftarrow L}$:\n$$ R_W(t) = R_Z(-\\alpha) R_L(t) $$\n\nThe problem states that the transverse plane angles $\\psi(t)$ and $\\tilde{\\psi}(t)$ are obtained from a $ZXY$ Cardan sequence decomposition.\nFor the orientation in the global frame $L$, the decomposition is:\n$$ R_L(t) = R_Z(\\psi(t)) R_X(\\theta(t)) R_Y(\\phi(t)) $$\nwhere $\\psi(t)$ is the angle of interest.\n\nFor the orientation in the walkway frame $W$, the decomposition is:\n$$ R_W(t) = R_Z(\\tilde{\\psi}(t)) R_X(\\tilde{\\theta}(t)) R_Y(\\tilde{\\phi}(t)) $$\nwhere $\\tilde{\\psi}(t)$ is the measured angle.\n\nNow, we substitute these decompositions into the matrix relationship $R_W(t) = R_Z(-\\alpha) R_L(t)$:\n$$ R_Z(\\tilde{\\psi}(t)) R_X(\\tilde{\\theta}(t)) R_Y(\\tilde{\\phi}(t)) = R_Z(-\\alpha) \\left[ R_Z(\\psi(t)) R_X(\\theta(t)) R_Y(\\phi(t)) \\right] $$\nRotations about the same axis are commutative and their angles add. Therefore, $R_Z(-\\alpha) R_Z(\\psi(t)) = R_Z(\\psi(t) - \\alpha)$. The equation becomes:\n$$ R_Z(\\tilde{\\psi}(t)) R_X(\\tilde{\\theta}(t)) R_Y(\\tilde{\\phi}(t)) = R_Z(\\psi(t) - \\alpha) R_X(\\theta(t)) R_Y(\\phi(t)) $$\nThis equation shows two different $ZXY$ Cardan parametrizations for the same orientation matrix. The problem explicitly states that \"the $ZXY$ decomposition is unique and free of singularities over the time window of interest\". This uniqueness allows us to directly equate the corresponding angles in the sequence. By comparing the left and right sides, we find:\n$$ \\tilde{\\psi}(t) = \\psi(t) - \\alpha $$\n$$ \\tilde{\\theta}(t) = \\theta(t) $$\n$$ \\tilde{\\phi}(t) = \\phi(t) $$\nThe systematic bias is defined as $b(\\alpha) = \\tilde{\\psi}(t) - \\psi(t)$. Using the first of the derived equalities:\n$$ b(\\alpha) = (\\psi(t) - \\alpha) - \\psi(t) $$\n$$ b(\\alpha) = -\\alpha $$\nThe bias is a constant value equal to the negative of the walkway misalignment angle. This result is independent of time $t$ and the other orientation angles $\\theta(t)$ and $\\phi(t)$, confirming it is a systematic bias. The expression is given in terms of the angle $\\alpha$, which is assumed to be in radians as per standard scientific convention and the problem's instruction.",
            "answer": "$$ \\boxed{-\\alpha} $$"
        }
    ]
}