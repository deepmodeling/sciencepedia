## 引言
人体行走，或称步态，是一项看似简单却蕴含着复杂生物力学与神经控制机制的基础活动。对步态进行精确的量化分析，对于理解正常运动模式、诊断病理状态、评估康复效果以及设计先进的辅助设备都至关重要。步态的[运动学分析](@entry_id:1126917)正是实现这一目标的基石，它提供了一套严谨的框架，用于描述人体在行走过程中各节段和关节在空间与时间上的运动，而不涉及产生这些运动的力。

本文旨在系统性地介绍[步态周期](@entry_id:1125450)[运动学分析](@entry_id:1126917)的核心知识体系。我们面临的挑战是如何将连续、流畅的[人体运动](@entry_id:903325)转化为离散、可解释的生物力学参数。为此，本文将带领读者从基本定义出发，逐步深入到高级分析方法及其在多学科交叉领域的应用。

在接下来的章节中，我们将首先在“**原理与机制**”中奠定理论基础，详细解析[步态周期](@entry_id:1125450)的[时空结构](@entry_id:158931)、描述运动所需的坐标系、以及从原始运动捕捉数据中提取关节角度等关键信息的计算过程。随后，我们将在“**应用与跨学科联系**”中展示这些原理的强大实践价值，探讨[运动学分析](@entry_id:1126917)如何在临床诊断、康复工程、机器人学等领域解决实际问题。最后，通过“**动手实践**”部分，读者将有机会运用所学知识，设计算法来解决具体的[步态分析](@entry_id:911921)任务，从而巩固理论并提升实践能力。

## 原理与机制

步态的[运动学分析](@entry_id:1126917)是将人体行走这一复杂的生物力学现象，分解为可通过几何与数学语言精确描述的运动。本章旨在系统性地阐述支撑步态[运动学分析](@entry_id:1126917)的核心原理与机制。我们将从[步态周期](@entry_id:1125450)的基本定义出发，逐步深入到描述和量化人[体节](@entry_id:187163)段与关节运动的坐标系、运动学变量，并最终探讨在实际应用中，如何从原始运动捕捉数据中提取有意义的生物力学信息。

### 步态的[时空结构](@entry_id:158931)：定义步态周期

对步态的任何运动学描述都始于其基本时间单元——**[步态周期](@entry_id:1125450) (gait cycle)** 的定义。在生物力学中，一个步态周期被严谨地定义为单侧肢体上某一事件连续两次发生之间的时间间隔。最常用于标记周期开始与结束的事件是**足跟触地 (heel strike)**。因此，一个右腿的[步态周期](@entry_id:1125450)始于右足跟触地，止于下一次右足跟触地 。

在这一框架下，另外两个核心术语得以澄清：**步幅 (stride)** 和**步 (step)**。一个步幅在定义上等同于一个完整的步态周期，其空间度量为**步幅长 (stride length)**，即同一只脚连续两次触地点之间的距离。而一个步是从一侧脚触地到对侧脚触地之间的过程。因此，一个完整的步幅（或步态周期）包含两个步：例如，一个右步（从右足跟着地到左足跟着地）和一个左步（从左足跟着地到下一次右足跟着地）。在对称步态中，一步的时间和长度约等于一个步幅的一半。

每个[步态周期](@entry_id:1125450)都被划分为两个主要时相：

1.  **支撑相 (stance phase)**：脚与地面接触的时期。
2.  **摆动相 (swing phase)**：脚在空中，不与地面接触的时期。

这两个时相的相对持续时间是区分不同运动模式的关键。我们引入**支撑系数 (duty factor)**，符号为 $\phi$，定义为单侧肢体在地面上的时间（$T_{\text{stance}}$）占整个周期时间（$T_{\text{cycle}}$）的比例：$\phi = T_{\text{stance}} / T_{\text{cycle}}$。

**行走 (walking)** 的一个决定性特征是其支撑系数 $\phi > 0.5$，这意味着支撑相长于摆动相。这一不等式必然导致存在双脚同时触地的时期，称为**双足支撑期 (double support phase)**。在舒适速度下，正常成人行走的支撑相约占[步态周期](@entry_id:1125450)的 $60\%$，摆动相约占 $40\%$。对应的支撑系数 $\phi \approx 0.6$。在这种情况下，通过计算可以得出，在一个[步态周期](@entry_id:1125450)中，两个短暂的双足支撑期总共约占周期的 $20\%$。相比之下，**跑步 (running)** 的支撑系数 $\phi  0.5$，支撑相短于摆动相，这导致了双脚均不触地的**腾空期 (flight phase)** 的存在。

为了进行更精细的分析，支撑相和摆动相可被进一步划分为多个子时相。一个具有代表性的划分如下 ：
*   **支撑相 ($0\%-60\%$)**
    *   **初始触地与承重反应期 ($0\%-10\%$)**: 从足跟触地开始，身体重量迅速转移到支撑腿上。这是第一个双足支撑期。
    *   **支撑中期 ($10\%-30\%$)**: 对侧足离地，身体重心越过单侧支撑的足部。
    *   **支撑末期 ($30\%-50\%$)**: 支撑腿的足跟抬起，身体继续前移。
    *   **摆动[前期](@entry_id:170157) ($50\%-60\%$)**: 从对侧足触地开始，到同侧足趾离地结束。这是第二个双足支撑期。
*   **摆动相 ($60\%-100\%$)**
    *   **摆动初期 ($60\%-73\%$)**: 足部离地，肢体开始向前加速摆动。
    *   **摆动中期 ($73\%-87\%$)**: 摆动腿越过支撑腿。
    *   **摆动末期 ($87\%-100\%$)**: 摆动腿减速，为下一次足跟触地做准备。

### 量化运动：速度、步频与步长

步态的基本[时空参数](@entry_id:1132062)共同决定了个体的移动速度。这些参数包括**步长 (step length)**、**步幅长 (stride length)** 和**步频 (cadence)**。如前所述，步长是指对侧足连续两次初始触地点之间的前行距离。步频则定义为单位时间内迈出的步数，通常以“步/分钟”为单位。

这些量之间存在一个简单而根本的关系，它将行走的宏观速度与基于事件的步态描述符联系起来。平均前行速度 $v$ 的基本定义是总位移除以总时间 ($\bar{v} = \Delta x / \Delta t$)。假设在一个时间段 $\Delta t$ 内，受试者以恒定的步长 $L_{\text{step}}$ 迈出了 $N_{\text{steps}}$ 步。那么总位移为 $\Delta x = N_{\text{steps}} \times L_{\text{step}}$。根据步频 $C$ 的定义，$C = N_{\text{steps}} / \Delta t$，我们可以得到总时间为 $\Delta t = N_{\text{steps}} / C$。将这两个表达式代入速度定义中，我们得到 ：

$$ \bar{v} = \frac{N_{\text{steps}} \times L_{\text{step}}}{N_{\text{steps}} / C} = L_{\text{step}} \times C $$

这个公式表明，**行走速度等于步长乘以步频**。例如，如果一个人的平均步长为 $0.680 \text{ m}$，平均步频为 $110 \text{ 步/分钟}$，我们可以计算其行走速度。首先，需要将步频的单位从“步/分钟”转换为“步/秒”（或 $\text{s}^{-1}$），即 $110 / 60 \text{ s}^{-1}$。然后应用公式：

$$ \bar{v} = (0.680 \text{ m}) \times \left(\frac{110}{60} \text{ s}^{-1}\right) \approx 1.247 \text{ m/s} $$

这个关系式是[步态分析](@entry_id:911921)的基础，它清晰地揭示了人类如何通过调节迈步的幅度和频率来控制行走速度。

### 几何基础：步态分析的坐标系

为了从定性描述走向定量分析，我们必须建立一个严谨的坐标系框架。在步态分析中，通常需要定义两种类型的坐标系：一个固定的[全局坐标系](@entry_id:171029)和一个附着于身体各节段的[局部坐标系](@entry_id:751394)。

#### 观察者框架：[全局坐标系](@entry_id:171029)

**全局实验室坐标系 (global laboratory coordinate system)** 是一个固定的[惯性参考系](@entry_id:276742)，所有运动都相对于它进行描述。一个标准的右利手全局坐标系可以这样定义：$X$ 轴指向前方（行走方向），$Y$ 轴垂直向上，而 $Z$ 轴根据**[右手定则](@entry_id:156766)** ($\hat{\mathbf{Z}} = \hat{\mathbf{X}} \times \hat{\mathbf{Y}}$) 指向受试者的左侧 。这个坐标系是测量所有节段位置和方向的基准。

#### 身体框架：节段固定的解剖坐标系

为了描述人体节段（如大腿、小腿）自身的运动和它们之间的[相对运动](@entry_id:169798)，我们需要为每个节段定义一个**局部解剖坐标系 (segment-fixed anatomical coordinate system)**。这个坐标系牢固地“附着”在节段上，并随之运动。根据国际生物力学学会 (ISB) 的建议，这些坐标系的轴应与解剖学上具有明确意义的方向对齐。

这些坐标系通常是通过放置在骨性标志点上的标记物来构建的。例如，对于大腿节段，其解剖坐标系可以如下建立 ：
1.  确定髋关节中心 ($\mathbf{H}$) 和膝关节中心 ($\mathbf{K}$)。
2.  定义一条轴，例如纵轴 $\hat{\mathbf{z}}_t$，沿着从膝关节指向髋关节的方向（近端方向）。
3.  利用膝关节的内外上髁（$\mathrm{MFE}$, $\mathrm{LFE}$）定义另一条轴，例如内外侧轴 $\hat{\mathbf{y}}_t$，从外侧上髁指向内侧上髁。
4.  第三条轴，即[前后轴](@entry_id:185361) $\hat{\mathbf{x}}_t$，通过前两条轴的[叉积](@entry_id:156672)来确定，以确保构成一个右利手坐标系，例如 $\hat{\mathbf{x}}_t = \hat{\mathbf{y}}_t \times \hat{\mathbf{z}}_t$。这条轴将指向前方。

通过这种方法，我们可以为骨盆、大腿、小腿和足等关键节段建立起与解剖结构紧密相关的、随体运动的坐标系。

#### [解剖平面](@entry_id:914919)与运动学分量

一旦定义了坐标系，我们就可以将传统的[解剖平面](@entry_id:914919)与之对应。对于先前定义的全局坐标系（$X$ 轴向前，$Y$ 轴向上，$Z$ 轴向左）：
*   **[矢状面](@entry_id:899093) (sagittal plane)**：将身体分为左右两半的平面，由[前后轴](@entry_id:185361) ($X$) 和上下轴 ($Y$) 构成。[矢状面](@entry_id:899093)内的运动主要是**屈伸 (flexion-extension)**。
*   **[冠状面](@entry_id:921931) (frontal plane)**：将身体分为前后两半的平面，由上下轴 ($Y$) 和内外轴 ($Z$) 构成。[冠状面](@entry_id:921931)内的运动主要是**内外展 (abduction-adduction)**。
*   **水平面 (transverse plane)**：将身体分为上下两半的平面，由[前后轴](@entry_id:185361) ($X$) 和内外轴 ($Z$) 构成。水平面内的运动主要是**内外旋 (internal-external rotation)**。

理解这些平面与坐标系的关系，对于解读运动捕捉数据至关重要。例如，一个仅从侧面拍摄的二维 (2D) [矢状面](@entry_id:899093)分析，只能捕捉到投影到该平面内的运动。它能很好地解析膝关节和髋关节的屈伸，但无法量化发生在[冠状面](@entry_id:921931)（如骨盆倾斜、膝内外翻）或水平面（如骨盆旋转、足外摆角）的运动。要完整地捕捉所有三个维度的平移和旋转运动，必须使用多摄像头的**三维 (3D) 运动分析系统** 。

### 从标记点到运动意义：运动学测量的过程

拥有了理论上的坐标系定义后，下一个挑战是如何在实际测量中应用它们。这涉及到解剖标定和步态事件识别两个关键步骤。

#### 实践应用：解剖标定

在现代三维运动捕捉中，我们通常会在每个节段上粘贴一组（例如三个或更多）标记物，形成一个**技术标记簇 (technical cluster)**。这个标记簇定义了一个**技术坐标系 ($\{T\}$)**，其优点是在动态试验中易于被摄像头稳定追踪。然而，这个技术坐标系的方向通常与节段的解剖轴没有直接关系。

为了解决这个问题，我们需要进行一次**解剖标定 (anatomical calibration)**。这通常在一次**静态试验 (static trial)** 中完成。在静态试验中，受试者保持静止，此时我们不仅要捕捉技术标记簇的位置，还要同时捕捉放置在关键解剖标志点（如内外上髁）上的标记物位置。

解剖标定的目标是，利用静态试验的数据计算出从技术坐标系 $\{T\}$ 到我们真正关心的解剖坐标系 $\{A\}$ 的**[刚体变换](@entry_id:150396)关系**。这个变换关系包含一个旋转矩阵 $\mathbf{R}_{AT}$ 和一个平移向量 $\mathbf{p}_{AT}$。其数学形式可以从[刚体运动学](@entry_id:203362)基本原理推导得出 ：

$$ \mathbf{R}_{AT} = \mathbf{R}_A^\top \mathbf{R}_T $$
$$ \mathbf{p}_{AT} = \mathbf{R}_A^\top (\mathbf{p}_T - \mathbf{p}_A) $$

其中 $(\mathbf{R}_A, \mathbf{p}_A)$ 和 $(\mathbf{R}_T, \mathbf{p}_T)$ 分别是静态试验中解剖坐标系和技术坐标系在[全局坐标系](@entry_id:171029)下的姿态（旋转矩阵和平移向量）。这个变换关系一旦确定，就被假定为恒定的。在随后的**动态试验 (dynamic trials)** 中，我们只需追踪技术标记簇的运动，就可以利用这个恒定的变换关系，在每一时刻计算出解剖坐标系的姿态。这样，我们就能够以具有临床意义的方式来报告关节角度等信息。

#### 从运动学数据中识别步态事件

[步态周期](@entry_id:1125450)的划分依赖于对关键**步态事件 (gait events)**，如足跟触地和足趾离地的精确识别。在基于标记点的运动捕捉中，这些事件通常是通过分析足跟和足尖标记点的垂直位置轨迹 $z(t)$ 来操作性地定义的。

一个鲁棒且物理意义明确的方法，需要同时考虑标记点的位置和速度信息 。**足跟触地 ($t_{\text{HS}}$)** 是摆动相到支撑相的转换，其运动学特征是足跟标记点的垂直速度从负值（向下运动）变为零。这对应于其垂直位置轨迹 $z_h(t)$ 上的一个局部最小值。同样，**足趾离地 ($t_{\text{TO}}$)** 是支撑相到摆动相的转换，其特征是足尖标记点开始获得向上的速度，这也对应于其垂直位置轨迹 $z_t(t)$ 上的一个局部最小值。

然而，由于软组织形变、鞋的压缩以及[测量噪声](@entry_id:275238)和标定偏差，我们不能简单地寻找 $z(t) = 0$ 的点。一个更稳健的算法会这样定义事件：
1.  事件必须发生在地面附近，即标记点的垂直位置 $z(t)$ 必须小于一个小的正阈值 $\epsilon$ ($z(t) \le \epsilon$)。
2.  在该位置附近，标记点的垂直速度 $\dot{z}(t)$ 穿过零，从负（或非正）变为正。

阈值 $\epsilon$ 的选择至关重要。它必须足够大，以容纳最大的潜在标定偏差 $\delta$ 和高概率的[测量噪声](@entry_id:275238)（例如，3倍标准差 $3\sigma_z$）。因此，一个有原则的选择是 $\epsilon \ge \delta + 3\sigma_z$ 。

### 描述关节运动：从相对姿态到临床角度

描述一个关节的运动，本质上是描述一个远端节段相对于一个近端节段的相对姿态变化。虽然一个[旋转矩阵](@entry_id:140302)可以完全描述这种相对姿态，但它包含9个参数且不直观。为了便于临床解释，我们需要将这种[三维旋转](@entry_id:148533)分解为三个围绕特定解剖轴的、更易于理解的角度，即屈伸、内外展和内外旋。

**[关节坐标系](@entry_id:1126835) (Joint Coordinate System, JCS)**，由 Grood 和 Suntay 提出，是实现这一目标的黄金标准 。与传统的[欧拉角](@entry_id:171794)或卡丹角序列（它们通常是围绕单个坐标系的轴进行旋转）不同，JCS 的巧妙之处在于它使用了一个来自近端节段的轴、一个来自远端节段的轴，以及一个根据这两个轴动态确定的“浮动轴”。

以膝关节为例，JCS 的标准定义如下：
1.  **屈伸 (Flexion-Extension)**：定义为绕股骨（近端节段）固定的内外侧轴 $\hat{\mathbf{y}}_{F}$ 的旋转。
2.  **内外旋 (Internal-External Rotation)**：定义为绕胫骨（远端节段）固定的长轴 $\hat{\mathbf{z}}_{T}$ 的旋转。
3.  **内外展 (Abduction-Adduction)**：定义为绕一个“浮动”轴 $\hat{\mathbf{s}}$ 的旋转。该轴在数学上定义为与股骨内外侧轴 $\hat{\mathbf{y}}_{F}$ 和胫骨长轴 $\hat{\mathbf{z}}_{T}$ 都垂直的轴（即它们的[叉积](@entry_id:156672)方向）。

这种定义方式使得三个角度在解剖学上更具独立性和可解释性，显著减少了因坐标系非正交而产生的“串扰”伪影。[串扰](@entry_id:136295)是指当关节只绕一个解剖轴做纯粹运动时，计算出的多个角度分量都发生变化的现象。JCS 的设计最大限度地减少了这种耦合，使其成为临床步态分析的首选方法。

### 综合与比较：标准化与整体运动学

在获得了单个[步态周期](@entry_id:1125450)的详细运动学数据后，我们面临着两个最终的挑战：如何跨个体或跨速度进行有意义的比较，以及如何从节段运动中综合出整体运动的信息。

#### 同类比较：时间标准化

不同个体或同一体在不同速度下行走时，其[步态周期](@entry_id:1125450)时长 $T_i$ 会有差异。直接比较两条时长不同的关节角度曲线 $q_i(t)$ 是困难的。为了解决这个问题，我们采用**时间标准化 (time normalization)** 的方法 。

这个过程将每个步态周期的真实时间轴 $t \in [0, T_i]$ 线性地映射到一个标准的、无量纲的**相位 (phase)** 变量 $\theta$ 上，其定义为 $\theta(t) = t / T_i$。该变量范围从 $0$ 变化到 $1$，并常以百分比形式（$0\%-100\%$）表示。通过这个变换，所有的[步态周期](@entry_id:1125450)都被“拉伸”或“压缩”到相同的[标准化](@entry_id:637219)时间轴上。这使得我们可以直接比较在步态周期中相同相对时间点（例如 $50\%$ 时刻）的关节角度值，从而比较运动模式的“形状”和内部事件的相对时序。

需要特别注意的是，时间[标准化](@entry_id:637219)会影响对导数（即[角速度](@entry_id:192539)）的解读。根据[链式法则](@entry_id:190743)，真实的[角速度](@entry_id:192539) $dq_i/dt$ 与标准化[曲线的斜率](@entry_id:178976) $dq_i/d\theta$ 之间的关系是 ：

$$ \frac{dq_i}{dt} = \frac{dq_i}{d\theta} \frac{d\theta}{dt} = \frac{1}{T_i} \frac{dq_i}{d\theta} $$

这意味着，在比较不同周期时长 ($T_1 \neq T_2$) 的运动时，[标准化](@entry_id:637219)曲线上相同的斜率并不代表相同的物理[角速度](@entry_id:192539)。要比较真实的角速度，必须将[标准化](@entry_id:637219)曲线的斜率乘以各自周期时长的倒数 $1/T_i$。

#### 整体大于部分之和：全身[质心](@entry_id:138352)

[步态分析](@entry_id:911921)的最终目标之一是理解身体作为一个整体是如何移动的。**全身[质心](@entry_id:138352) (whole-body center of mass, COM)** 是描述这一点的最重要变量。在多节段[刚体模型](@entry_id:1131036)中，全身[质心](@entry_id:138352)的位置 $\mathbf{r}_{\mathrm{COM}}(t)$ 被定义为所有单个节段[质心](@entry_id:138352)位置 $\mathbf{r}_i(t)$ 的质量[加权平均值](@entry_id:894528) 。

如果节段 $i$ 的质量分数为 $f_i$（即其质量占全身质量 $M$ 的比例），那么全身[质心](@entry_id:138352)的位置和速度可以按如下方式计算：

$$ \mathbf{r}_{\mathrm{COM}}(t) = \sum_{i=1}^{N} f_i \, \mathbf{r}_i(t) $$
$$ \mathbf{v}_{\mathrm{COM}}(t) = \sum_{i=1}^{N} f_i \, \mathbf{v}_i(t) $$

其中，每个节段的[质心](@entry_id:138352)在[全局坐标系](@entry_id:171029)中的位置 $\mathbf{r}_i(t)$，又是通过其[局部坐标系](@entry_id:751394)的姿态 $(\mathbf{R}_i(t), \mathbf{p}_i(t))$ 和该节段[质心](@entry_id:138352)在其[局部坐标系](@entry_id:751394)内的固定位置向量 $\mathbf{c}_i$ 计算得出的：

$$ \mathbf{r}_i(t) = \mathbf{p}_i(t) + \mathbf{R}_i(t)\,\mathbf{c}_i $$

通过这一系列计算，我们可以从分散的节段运动数据中，综合出描述身体整体[平移运动](@entry_id:911899)的关键动力学变量——全身[质心](@entry_id:138352)的轨迹。这条轨迹的形态和变化，揭示了行走过程中身体[平衡控制](@entry_id:1121320)和[能量转换](@entry_id:165656)的基本策略。