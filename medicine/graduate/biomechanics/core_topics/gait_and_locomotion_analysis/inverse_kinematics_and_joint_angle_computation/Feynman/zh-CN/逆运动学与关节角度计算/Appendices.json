{
    "hands_on_practices": [
        {
            "introduction": "在求解逆运动学问题之前，必须先掌握正运动学，即根据给定的关节角度计算末端执行器的位置和姿态。本练习将通过一个上肢模型，引导您实践如何通过复合关节旋转来计算末端执行器（手部）的姿态 。这个过程不仅是构建运动链的基础，还通过将模型计算结果与假设的测量数据进行比较，让您体验生物力学分析中模型验证的关键步骤。",
            "id": "4181878",
            "problem": "人的上肢被建模为一个由刚性节段和理想关节组成的串联链。躯干（近端）参考坐标系根据国际生物力学学会（ISB）的约定定义：$x$轴指向前方，$y$轴指向受试者的左侧（侧向），$z$轴指向上方。肩部被建模为一个三自由度的球窝关节，通过内旋偏航–俯仰–滚转（绕当前关节的$z$轴，然后是$y$轴，然后是$x$轴的旋转）进行参数化。肘部提供屈/伸功能，建模为绕前臂局部$y$轴的单轴旋转，并且在所考虑的瞬间，腕部处于中立位置。\n\n在某个特定时刻，测得的关节角度如下（使用弧度）：\n- 肩部偏航角 $\\psi_{s} = \\pi/4$，肩部俯仰角 $\\theta_{s} = \\pi/4$，肩部滚转角 $\\phi_{s} = 0$。\n- 肘部屈曲角 $\\theta_{e} = \\pi/2$，绕前臂的局部$y$轴。\n- 腕部的旋前–旋后和屈–伸角均为$0$。\n\n假设每个关节旋转作用于子节段的局部坐标系，并且手部节段与前臂对齐。\n\n1. 使用从躯干坐标系经过肩部和肘部到手部的刚体旋转复合，计算手部末端执行器相对于躯干坐标系的方向矩阵 $R_{\\text{model}} \\in \\mathbb{R}^{3 \\times 3}$。\n\n2. 一个运动捕捉系统报告的手部方向（相对于同一躯干坐标系）为矩阵\n$$\nR_{\\text{measured}} =\n\\begin{bmatrix}\n-0.5  -0.609540151  \\phantom{-}0.615191681 \\\\\n-0.5  \\phantom{-}0.783188329  \\phantom{-}0.369616073 \\\\\n-0.707106781  -0.122787804  -0.696364240\n\\end{bmatrix}.\n$$\n\n使用弗罗贝尼乌斯范数一致性度量\n$$\n\\left\\| R_{\\text{model}}^{\\top} R_{\\text{measured}} - I \\right\\|_{F},\n$$\n其中 $I$ 是 $3 \\times 3$ 的单位矩阵，计算该度量的数值。将最终结果四舍五入到四位有效数字。将最终值表示为无量纲量（无单位）。答案必须是单个实数。",
            "solution": "该问题需要两部分的计算。首先，我们基于上肢的运动学模型计算手的理论方向矩阵 $R_{\\text{model}}$。其次，我们使用指定的弗罗贝尼乌斯范数度量来量化该模型与给定的测量方向 $R_{\\text{measured}}$ 之间的差异。\n\n第1部分：$R_{\\text{model}}$ 的计算\n\n手相对于躯干的方向是通过复合肩关节和肘关节的旋转得到的。问题为肩部指定了内旋偏航–俯仰–滚转（$z$-$y'$-$x''$）约定，并为肘部指定了简单的铰链旋转。\n\n绕主轴的标准旋转矩阵为：\n$R_x(\\alpha) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{pmatrix}$, $R_y(\\beta) = \\begin{pmatrix} \\cos\\beta  0  \\sin\\beta \\\\ 0  1  0 \\\\ -\\sin\\beta  0  \\cos\\beta \\end{pmatrix}$, $R_z(\\gamma) = \\begin{pmatrix} \\cos\\gamma  -\\sin\\gamma  0 \\\\ \\sin\\gamma  \\cos\\gamma  0 \\\\ 0  0  1 \\end{pmatrix}$。\n\n肩部旋转是关于$z$轴的偏航（$\\psi_{s}$）、关于新$y$轴的俯仰（$\\theta_{s}$）以及关于最新$x$轴的滚转（$\\phi_{s}$）的内旋序列。这对应于矩阵乘积 $R_{\\text{shoulder}} = R_z(\\psi_{s}) R_y(\\theta_{s}) R_x(\\phi_{s})$。\n给定的肩关节角度为 $\\psi_{s} = \\pi/4$、$\\theta_{s} = \\pi/4$ 和 $\\phi_{s} = 0$。由于 $\\phi_{s}=0$，滚转的旋转矩阵是单位矩阵，即 $R_x(0) = I$。\n\n因此，从上臂坐标系转换到躯干坐标系的肩部旋转矩阵为：\n$R_{\\text{shoulder}} = R_z(\\pi/4) R_y(\\pi/4)$。\n我们有 $\\cos(\\pi/4) = \\sin(\\pi/4) = \\frac{1}{\\sqrt{2}}$。\n$$\nR_{\\text{shoulder}} = \\begin{pmatrix} \\cos(\\pi/4)  -\\sin(\\pi/4)  0 \\\\ \\sin(\\pi/4)  \\cos(\\pi/4)  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\pi/4)  0  \\sin(\\pi/4) \\\\ 0  1  0 \\\\ -\\sin(\\pi/4)  0  \\cos(\\pi/4) \\end{pmatrix}\n$$\n$$\nR_{\\text{shoulder}} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\\\ 0  1  0 \\\\ -\\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n肘关节提供绕局部$y$轴的屈曲 $\\theta_{e} = \\pi/2$。此旋转将从前臂/手部坐标系转换到上臂坐标系。腕部处于中立位置，因此手部坐标系与前臂坐标系对齐。\n$$\nR_{\\text{elbow}} = R_y(\\theta_e) = R_y(\\pi/2) = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ -1  0  0 \\end{pmatrix}\n$$\n手相对于躯干的总方向 $R_{\\text{model}}$ 是这些矩阵的乘积：\n$R_{\\text{model}} = R_{\\text{shoulder}} R_{\\text{elbow}}$。\n$$\nR_{\\text{model}} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ -1  0  0 \\end{pmatrix}\n$$\n$$\nR_{\\text{model}} = \\begin{pmatrix} -\\frac{1}{2}  -\\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}}  0  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n\n第2部分：一致性度量的计算\n\n一致性度量定义为 $C = \\left\\| R_{\\text{model}}^{\\top} R_{\\text{measured}} - I \\right\\|_{F}$。我们首先计算矩阵乘积 $M = R_{\\text{model}}^{\\top} R_{\\text{measured}}$。\n$$\nR_{\\text{model}}^{\\top} = \\begin{pmatrix} -\\frac{1}{2}  -\\frac{1}{2}  -\\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n提供的测量矩阵是：\n$$\nR_{\\text{measured}} =\n\\begin{pmatrix}\n-0.5  -0.609540151  0.615191681 \\\\\n-0.5  0.783188329  0.369616073 \\\\\n-0.707106781  -0.122787804  -0.696364240\n\\end{pmatrix}\n$$\n我们注意到 $-0.707106781 = -1/\\sqrt{2}$。将此代入 $R_{\\text{measured}}$：\n$$\nR_{\\text{measured}} =\n\\begin{pmatrix}\n-0.5  -0.609540151  0.615191681 \\\\\n-0.5  0.783188329  0.369616073 \\\\\n-1/\\sqrt{2}  -0.122787804  -0.696364240\n\\end{pmatrix}\n$$\n现在我们计算 $M = R_{\\text{model}}^{\\top} R_{\\text{measured}}$。\n$$\nM_{11} = (-\\frac{1}{2})(-0.5) + (-\\frac{1}{2})(-0.5) + (-\\frac{1}{\\sqrt{2}})(-\\frac{1}{\\sqrt{2}}) = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{2} = 1\n$$\n根据正交性，由于 $R_{\\text{model}}$ 和 $R_{\\text{measured}}$ 的第一列相同，因此 $M$ 的第一行和第一列的非对角线项将为零。我们来验证一下 $M_{12}$：\n$$\nM_{12} = (-\\frac{1}{2})(-0.609...) + (-\\frac{1}{2})(0.783...) + (-\\frac{1}{\\sqrt{2}})(-0.122...) \\approx 0.30477 - 0.39159 + 0.08682 \\approx 0\n$$\n确实，对于 $i,j \\neq 1$ 的所有 $M_{1j}$ 和 $M_{i1}$ 均为零。我们来计算剩余的 $2 \\times 2$ 子矩阵。\n$$\nM_{22} = (-\\frac{1}{\\sqrt{2}})(-0.609...) + (\\frac{1}{\\sqrt{2}})(0.783...) + (0) = \\frac{1}{\\sqrt{2}}(0.609540151 + 0.783188329) = \\frac{1.39272848}{\\sqrt{2}} \\approx 0.98480775\n$$\n$$\nM_{23} = (-\\frac{1}{\\sqrt{2}})(0.615...) + (\\frac{1}{\\sqrt{2}})(0.369...) + (0) = \\frac{1}{\\sqrt{2}}(-0.615191681 + 0.369616073) = \\frac{-0.245575608}{\\sqrt{2}} \\approx -0.17364818\n$$\n$$\nM_{32} = (\\frac{1}{2})(-0.609...) + (\\frac{1}{2})(0.783...) + (-\\frac{1}{\\sqrt{2}})(-0.122...) = \\frac{1}{2}(0.173648178) + 0.086824089 \\approx 0.17364818\n$$\n$$\nM_{33} = (\\frac{1}{2})(0.615...) + (\\frac{1}{2})(0.369...) + (-\\frac{1}{\\sqrt{2}})(-0.696...) = \\frac{1}{2}(0.984807754) + 0.492403877 \\approx 0.98480775\n$$\n这些值表明 $M$ 是一个形式为 $R_x(\\delta)$ 的旋转矩阵，其中 $\\cos\\delta \\approx 0.98480775$ 且 $\\sin\\delta \\approx 0.17364818$。这些是 $\\delta = 10^{\\circ} = \\pi/18 \\text{ rad}$ 的余弦和正弦值。\n所以，$M = R_x(\\pi/18)$。\n\n误差矩阵为 $E = M - I = R_x(\\pi/18) - I$。\n$$\nE = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos(\\pi/18)  -\\sin(\\pi/18) \\\\ 0  \\sin(\\pi/18)  \\cos(\\pi/18) \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\cos(\\pi/18)-1  -\\sin(\\pi/18) \\\\ 0  \\sin(\\pi/18)  \\cos(\\pi/18)-1 \\end{pmatrix}\n$$\n弗罗贝尼乌斯范数为 $\\|E\\|_F = \\sqrt{\\sum_{i,j} |E_{ij}|^2}$。\n$$\n\\|E\\|_F^2 = 0 + (\\cos(\\pi/18)-1)^2 + (-\\sin(\\pi/18))^2 + (\\sin(\\pi/18))^2 + (\\cos(\\pi/18)-1)^2\n$$\n$$\n\\|E\\|_F^2 = 2\\left[ (\\cos(\\pi/18)-1)^2 + \\sin^2(\\pi/18) \\right]\n$$\n$$\n\\|E\\|_F^2 = 2\\left[ \\cos^2(\\pi/18) - 2\\cos(\\pi/18) + 1 + \\sin^2(\\pi/18) \\right]\n$$\n使用恒等式 $\\cos^2\\alpha + \\sin^2\\alpha = 1$：\n$$\n\\|E\\|_F^2 = 2\\left[ 1 - 2\\cos(\\pi/18) + 1 \\right] = 4(1 - \\cos(\\pi/18))\n$$\n该度量为 $C = \\|E\\|_F = \\sqrt{4(1 - \\cos(\\pi/18))} = 2\\sqrt{1 - \\cos(\\pi/18)}$。\n现在，我们代入数值 $\\cos(\\pi/18) \\approx 0.984807753$。\n$$\nC = 2\\sqrt{1 - 0.984807753} = 2\\sqrt{0.015192247} \\approx 2(0.123256878) \\approx 0.246513756\n$$\n四舍五入到四位有效数字，结果为 $0.2465$。",
            "answer": "$$\\boxed{0.2465}$$"
        },
        {
            "introduction": "基于雅可比矩阵的数值逆运动学求解器在接近奇异位形时常常会失效，可能导致关节速度的剧烈变化。本练习将通过一个简化的平面二自由度臂模型，探讨运动学奇点问题，并引入阻尼最小二乘法（Damped Least Squares, DLS）作为一种稳健的解决方案 。通过比较无阻尼伪逆解与DLS解，您将深入理解如何稳定逆运动学算法，以避免产生不符合生理实际的关节运动。",
            "id": "4181916",
            "problem": "一个平面二自由度人体上肢模型，其肩关节位于原点，还有一个肘关节，连杆长度分别为 $L_{1} = 0.3\\,\\text{m}$ 和 $L_{2} = 0.3\\,\\text{m}$。末端执行器（手腕）的笛卡尔坐标位置由平面内的标准正向运动学描述，其中肩关节角度为 $\\theta_{1}$，肘关节角度为 $\\theta_{2}$：\n$$x(\\theta_{1},\\theta_{2}) = L_{1}\\cos\\theta_{1} + L_{2}\\cos(\\theta_{1}+\\theta_{2}), \\quad y(\\theta_{1},\\theta_{2}) = L_{1}\\sin\\theta_{1} + L_{2}\\sin(\\theta_{1}+\\theta_{2}).$$\n用于小量更新的逆运动学（IK）采用一阶线性化\n$$\\Delta \\mathbf{p} \\approx J(\\theta_{1},\\theta_{2})\\,\\Delta \\mathbf{q},$$ \n其中 $J(\\theta_{1},\\theta_{2})$ 是 $(x,y)$ 相对于 $\\mathbf{q} = [\\theta_{1},\\,\\theta_{2}]^{\\top}$ 的 $2\\times 2$ 雅可比矩阵，$\\Delta \\mathbf{p}$ 是笛卡尔任务空间误差。考虑近奇异伸展位形 $\\theta_{1} = 0$ 和 $\\theta_{2} = 0$，以及一个小的期望末端执行器校正量\n$$\\mathbf{e} = \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix}\\,\\text{m}.$$\n通过构建线性化一致性条件的最小范数解来构造无阻尼IK更新，并使用Moore–Penrose伪逆推导其相应的表达式。接下来，通过构建一个任务空间阻尼因子为 $\\lambda = 0.3\\,\\text{m}$ 的Tikhonov正则化目标来构造阻尼最小二乘（DLS）IK更新，并推导其阻尼伪逆的相应表达式。使用在给定构型下评估的这些派生更新，计算无阻尼关节更新与阻尼关节更新的欧几里得范数之比 $r$，\n$$r \\;=\\; \\frac{\\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2}}{\\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2}},$$\n并报告 $r$ 的最终值。将您的答案四舍五入到四位有效数字。最终答案是无单位的，应表示为单个实数。",
            "solution": "首先，我们需要计算雅可比矩阵 $J = \\frac{\\partial \\mathbf{p}}{\\partial \\mathbf{q}}$，其中 $\\mathbf{p} = [x, y]^T$ 且 $\\mathbf{q} = [\\theta_1, \\theta_2]^T$。\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\theta_1} & \\frac{\\partial x}{\\partial \\theta_2} \\\\ \\frac{\\partial y}{\\partial \\theta_1} & \\frac{\\partial y}{\\partial \\theta_2} \\end{pmatrix} = \\begin{pmatrix} -L_1 \\sin\\theta_1 - L_2 \\sin(\\theta_1+\\theta_2) & -L_2 \\sin(\\theta_1+\\theta_2) \\\\ L_1 \\cos\\theta_1 + L_2 \\cos(\\theta_1+\\theta_2) & L_2 \\cos(\\theta_1+\\theta_2) \\end{pmatrix} $$\n在给定的近奇异位形 $\\theta_1 = 0, \\theta_2 = 0$，以及连杆长度 $L_1 = 0.3\\,\\text{m}, L_2 = 0.3\\,\\text{m}$ 条件下，雅可比矩阵为：\n$$ J = \\begin{pmatrix} 0 & 0 \\\\ L_1 + L_2 & L_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0.6 & 0.3 \\end{pmatrix}\\,\\text{m} $$\n该矩阵是奇异的，因为其行列式为零，这与机械臂完全伸展的构型相符。\n\n接下来，我们计算无阻尼的最小范数解 $\\Delta \\mathbf{q}_{\\text{undamped}} = J^\\dagger \\mathbf{e}$，其中 $J^\\dagger$ 是 $J$ 的 Moore-Penrose 伪逆。对于上述奇异矩阵 $J$，其伪逆为：\n$$ J^\\dagger = \\begin{pmatrix} 0 & 4/3 \\\\ 0 & 2/3 \\end{pmatrix} $$\n因此，无阻尼的关节更新量为：\n$$ \\Delta \\mathbf{q}_{\\text{undamped}} = \\begin{pmatrix} 0 & 4/3 \\\\ 0 & 2/3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} (4/3) \\times 0.01 \\\\ (2/3) \\times 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.04/3 \\\\ 0.02/3 \\end{pmatrix}\\,\\text{rad} $$\n其欧几里得范数为：\n$$ \\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2} = \\sqrt{\\left(\\frac{0.04}{3}\\right)^2 + \\left(\\frac{0.02}{3}\\right)^2} = \\sqrt{\\frac{0.0016+0.0004}{9}} = \\frac{\\sqrt{0.002}}{3} $$\n\n然后，我们计算阻尼最小二乘（DLS）解。该解由下式给出，我们使用计算上更稳定的形式：\n$$ \\Delta \\mathbf{q}_{\\text{damped}} = J^T (J J^T + \\lambda^2 I)^{-1} \\mathbf{e} $$\n其中阻尼因子 $\\lambda = 0.3\\,\\text{m}$，所以 $\\lambda^2 = 0.09\\,\\text{m}^2$。\n我们计算 $J J^T$：\n$$ J J^T = \\begin{pmatrix} 0 & 0 \\\\ 0.6 & 0.3 \\end{pmatrix} \\begin{pmatrix} 0 & 0.6 \\\\ 0 & 0.3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.6^2 + 0.3^2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.45 \\end{pmatrix} $$\n加上阻尼项：\n$$ J J^T + \\lambda^2 I = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0.45 \\end{pmatrix} + \\begin{pmatrix} 0.09 & 0 \\\\ 0 & 0.09 \\end{pmatrix} = \\begin{pmatrix} 0.09 & 0 \\\\ 0 & 0.54 \\end{pmatrix} $$\n求逆后得到：\n$$ (J J^T + \\lambda^2 I)^{-1} = \\begin{pmatrix} 1/0.09 & 0 \\\\ 0 & 1/0.54 \\end{pmatrix} $$\n将各部分组合得到阻尼关节更新量：\n$$ \\Delta \\mathbf{q}_{\\text{damped}} = \\begin{pmatrix} 0 & 0.6 \\\\ 0 & 0.3 \\end{pmatrix} \\begin{pmatrix} 1/0.09 & 0 \\\\ 0 & 1/0.54 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} $$\n$$ \\Delta \\mathbf{q}_{\\text{damped}} = \\begin{pmatrix} 0 & 0.6/0.54 \\\\ 0 & 0.3/0.54 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} (10/9) \\times 0.01 \\\\ (5/9) \\times 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.1/9 \\\\ 0.05/9 \\end{pmatrix}\\,\\text{rad} $$\n其欧几里得范数为：\n$$ \\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2} = \\sqrt{\\left(\\frac{0.1}{9}\\right)^2 + \\left(\\frac{0.05}{9}\\right)^2} = \\sqrt{\\frac{0.01+0.0025}{81}} = \\frac{\\sqrt{0.0125}}{9} $$\n\n最后，我们计算两个范数的比率 $r$：\n$$ r = \\frac{\\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2}}{\\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2}} = \\frac{\\sqrt{0.002}/3}{\\sqrt{0.0125}/9} = 3 \\sqrt{\\frac{0.002}{0.0125}} $$\n简化根号内的分数：\n$$ \\frac{0.002}{0.0125} = \\frac{2}{12.5} = \\frac{4}{25} = 0.16 $$\n因此，比率为：\n$$ r = 3 \\sqrt{0.16} = 3 \\times 0.4 = 1.2 $$\n四舍五入到四位有效数字，结果是 $1.200$。",
            "answer": "$$\n\\boxed{1.200}\n$$"
        },
        {
            "introduction": "除了与肢体物理姿态相关的运动学奇点外，姿态的数学表示本身也可能引入问题，例如“万向节死锁”（gimbal lock）。本练习将使用一个三维肩关节模型，深入研究欧拉角表示法中的表达奇点问题 。通过分析旋转轴的对齐情况，您将学会识别导致万向节死锁的特定关节位形，并理解为何选择轴角或四元数等替代参数化方法能够规避此类问题，从而深化您对三维运动分析中数学工具的理解。",
            "id": "4181929",
            "problem": "考虑一个简化的肩部胸肱模型，其中盂肱关节表示为一个三自由度（DOF）的球窝关节，胸肱朝向由一个内蕴欧拉角序列 $Z$-$Y$-$X$ 参数化，角度 $(\\psi, \\theta, \\phi)$ 分别对应航向（水平外展/内收）$\\psi$（绕胸廓的上下轴），抬升 $\\theta$（在航向旋转后绕侧方轴），以及轴向旋转 $\\phi$（在抬升旋转后绕肱骨长轴）。设胸廓坐标系的轴为 $\\hat{\\boldsymbol{x}}$ (向前)，$\\hat{\\boldsymbol{y}}$ (朝受试者左侧)，以及 $\\hat{\\boldsymbol{z}}$ (向上)。肱骨相对于胸廓的朝向为\n$$\n\\boldsymbol{R}(\\psi,\\theta,\\phi) = \\boldsymbol{R}_{z}(\\psi)\\,\\boldsymbol{R}_{y}(\\theta)\\,\\boldsymbol{R}_{x}(\\phi),\n$$\n其中 $\\boldsymbol{R}_{z}$、$\\boldsymbol{R}_{y}$ 和 $\\boldsymbol{R}_{x}$ 是绕指定轴的标准右手旋转矩阵。假设生理上合理的解剖约束为\n$$\n\\theta \\in [0, 2\\pi/3], \\quad \\psi \\in [-\\pi/3, \\pi/3], \\quad \\phi \\in [-\\pi/2, \\pi/2].\n$$\n当从欧拉角速率 $[\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi}]^{\\top}$ 到角速度 $\\boldsymbol{\\omega}$ 的瞬时映射失去秩时，姿态是奇异的（万向节死锁）。从刚体运动学的第一性原理出发，使用瞬时角速度 $\\boldsymbol{\\omega}$ 的定义 $\\dot{\\boldsymbol{R}} = \\boldsymbol{\\omega}^{\\wedge}\\boldsymbol{R}$ 以及连续旋转的几何意义，确定航向旋转轴和轴向旋转轴变为共线的条件。然后，在上述解剖范围内，计算产生此奇异姿态的抬升角 $\\theta$ 的值（以弧度为单位）。\n\n此外，肩关节链还包括一个肩胛胸廓关节，可以建模为一个附加的、较慢的旋转 $\\boldsymbol{S}$，它前乘 $\\boldsymbol{R}$，即完整的链朝向为 $\\boldsymbol{S}\\boldsymbol{R}(\\psi,\\theta,\\phi)$。解释这个前乘是否影响为 $\\theta$ 推导出的奇异性条件。\n\n最后，找出一个在你发现的奇异姿态邻域内局部非奇异的重新参数化方法，并根据所选参数的定义及其相对于 $\\boldsymbol{\\omega}$ 的局部雅可比矩阵，论证为何它能规避该邻域内的万向节死锁。你的论证可以是定性的，但必须直接关联到与 $\\boldsymbol{\\omega}$ 映射的局部可逆性。\n\n计算所要求的抬升角，并以弧度表示你的最终数值答案，四舍五入到四位有效数字。",
            "solution": "该问题要求分析一个简化的3自由度肩关节模型的运动学奇异性，该模型由一个 $Z$-$Y$-$X$ 内蕴欧拉角序列 $(\\psi, \\theta, \\phi)$ 参数化。\n\n首先，我们必须确定奇异性的条件。当从构型参数的速率到瞬时角速度的映射失去秩时，就会发生运动学奇异性或万向节死锁。这意味着该变换的雅可比矩阵变为奇异矩阵。\n\n肱骨相对于胸廓的朝向由旋转矩阵 $\\boldsymbol{R} = \\boldsymbol{R}_{z}(\\psi)\\,\\boldsymbol{R}_{y}(\\theta)\\,\\boldsymbol{R}_{x}(\\phi)$ 给出。在胸廓（空间）坐标系中表示的角速度矢量 $\\boldsymbol{\\omega}$ 与欧拉角速率 $(\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi})$ 之间的关系，是通过将每次旋转贡献的角速度（在公共空间坐标系中表示）相加得出的。\n角速度由以下公式给出：\n$$\n\\boldsymbol{\\omega} = \\dot{\\psi}\\hat{\\boldsymbol{z}}_S + \\dot{\\theta}\\hat{\\boldsymbol{u}}_y' + \\dot{\\phi}\\hat{\\boldsymbol{u}}_x''\n$$\n其中 $\\hat{\\boldsymbol{z}}_S$ 是第一次旋转的轴（绕 $z$ 轴），$\\hat{\\boldsymbol{u}}_y' = \\boldsymbol{R}_z(\\psi)\\hat{\\boldsymbol{y}}_S$ 是第二次旋转的轴（绕新的 $y$ 轴），而 $\\hat{\\boldsymbol{u}}_x'' = \\boldsymbol{R}_z(\\psi)\\boldsymbol{R}_y(\\theta)\\hat{\\boldsymbol{x}}_S$ 是第三次旋转的轴（绕最终的 $x$ 轴）。\n\n让我们将这些轴写成空间坐标系中的列向量：\n$\\hat{\\boldsymbol{u}}_{\\psi} = \\hat{\\boldsymbol{z}}_S = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n$\\hat{\\boldsymbol{u}}_{\\theta} = \\boldsymbol{R}_z(\\psi)\\hat{\\boldsymbol{y}}_S = \\begin{pmatrix} \\cos\\psi  -\\sin\\psi  0 \\\\ \\sin\\psi  \\cos\\psi  0 \\\\ 0  0  1 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -\\sin\\psi \\\\ \\cos\\psi \\\\ 0 \\end{pmatrix}$\n$\\hat{\\boldsymbol{u}}_{\\phi} = \\boldsymbol{R}_z(\\psi)\\boldsymbol{R}_y(\\theta)\\hat{\\boldsymbol{x}}_S = \\boldsymbol{R}_z(\\psi)\\begin{pmatrix} \\cos\\theta \\\\ 0 \\\\ -\\sin\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\psi\\cos\\theta \\\\ \\sin\\psi\\cos\\theta \\\\ -\\sin\\theta \\end{pmatrix}$\n\n总角速度为 $\\boldsymbol{\\omega} = \\dot{\\psi}\\hat{\\boldsymbol{u}}_{\\psi} + \\dot{\\theta}\\hat{\\boldsymbol{u}}_{\\theta} + \\dot{\\phi}\\hat{\\boldsymbol{u}}_{\\phi}$。以矩阵形式表示为 $\\boldsymbol{\\omega} = \\boldsymbol{J}\\begin{pmatrix} \\dot{\\psi} \\\\ \\dot{\\theta} \\\\ \\dot{\\phi} \\end{pmatrix}$，其中 $\\boldsymbol{J}$ 是雅可比矩阵，其列是旋转轴：\n$$\n\\boldsymbol{J} = \\begin{pmatrix} 0  -\\sin\\psi  \\cos\\psi\\cos\\theta \\\\ 0  \\cos\\psi  \\sin\\psi\\cos\\theta \\\\ 1  0  -\\sin\\theta \\end{pmatrix}\n$$\n当 $\\boldsymbol{J}$ 不可逆时，即其行列式为零时，发生奇异性。让我们沿着第一列展开来计算行列式：\n$$\n\\det(\\boldsymbol{J}) = 1 \\cdot \\det\\begin{pmatrix} -\\sin\\psi  \\cos\\psi\\cos\\theta \\\\ \\cos\\psi  \\sin\\psi\\cos\\theta \\end{pmatrix} = (-\\sin\\psi)(\\sin\\psi\\cos\\theta) - (\\cos\\psi)(\\cos\\psi\\cos\\theta)\n$$\n$$\n\\det(\\boldsymbol{J}) = -\\sin^2\\psi\\cos\\theta - \\cos^2\\psi\\cos\\theta = -(\\sin^2\\psi + \\cos^2\\psi)\\cos\\theta = -\\cos\\theta\n$$\n奇异性条件是 $\\det(\\boldsymbol{J}) = 0$，简化为 $\\cos\\theta = 0$。\n问题明确要求航向（$\\psi$）和轴向旋转（$\\phi$）轴变为共线的条件。航向轴是 $\\hat{\\boldsymbol{u}}_{\\psi} = (0, 0, 1)^{\\top}$。轴向旋转轴是 $\\hat{\\boldsymbol{u}}_{\\phi} = (\\cos\\psi\\cos\\theta, \\sin\\psi\\cos\\theta, -\\sin\\theta)^{\\top}$。要使这两个向量共线，$\\hat{\\boldsymbol{u}}_{\\phi}$ 的前两个分量必须为零。这要求 $\\cos\\psi\\cos\\theta = 0$ 和 $\\sin\\psi\\cos\\theta = 0$。由于 $\\cos\\psi$ 和 $\\sin\\psi$ 不能同时为零，我们必须有 $\\cos\\theta = 0$。这证实了从雅可比行列式得到的结果。\n\n如果 $\\cos\\theta = 0$，那么在指定的解剖范围 $\\theta \\in [0, 2\\pi/3]$ 内，唯一的解是 $\\theta = \\pi/2$。\n我们来验证这个值。如果 $\\theta = \\pi/2$，那么 $\\sin\\theta = 1$。轴向旋转轴变为 $\\hat{\\boldsymbol{u}}_{\\phi} = (0, 0, -1)^{\\top}$，这确实与航向轴 $\\hat{\\boldsymbol{u}}_{\\psi} = (0, 0, 1)^{\\top}$ 共线（具体来说是反向平行）。在这种姿态下，绕空间 $z$ 轴的旋转 $\\dot{\\psi}$ 和绕物体 $x$ 轴（此时与空间 $z$ 轴对齐）的旋转 $\\dot{\\phi}$ 都会产生绕同一世界轴的力矩，导致失去一个自由度。这就是万向节死锁的定义。\n产生这种奇异性的抬升角 $\\theta$ 的值是 $\\pi/2$ 弧度。\n数值上，$\\theta = \\pi/2 \\approx 1.570796...$ 弧度。四舍五入到四位有效数字，结果是 $1.571$。\n\n其次，我们考虑前乘旋转 $\\boldsymbol{S}$（代表肩胛胸廓运动）的影响。完整的朝向是 $\\boldsymbol{R}_{full} = \\boldsymbol{S}\\boldsymbol{R}(\\psi, \\theta, \\phi)$。我们发现的奇异性是所选 $Z$-$Y$-$X$ 欧拉角参数化方法用于旋转 $\\boldsymbol{R}$ 的一个内蕴属性。这是一种*表示奇异性*。它发生在从参数速率 $(\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi})$ 到*相对*角速度 $\\boldsymbol{\\omega}_{rel}$（肱骨相对于肩胛骨）的映射的雅可比矩阵失去秩时。前乘 $\\boldsymbol{S}$ 意味着肱骨现在是相对于由 $\\boldsymbol{S}$ 定义的坐标系（肩胛骨）旋转，而不是胸廓。$(\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi})$ 和相对角速度之间的运动学关系仍然是 $\\boldsymbol{\\omega}_{rel} = \\boldsymbol{J}(\\psi, \\theta)\\begin{pmatrix}\\dot{\\psi}, \\dot{\\theta}, \\dot{\\phi}\\end{pmatrix}^{\\top}$。奇异性条件 $\\det(\\boldsymbol{J})=0$ 仅取决于 $\\boldsymbol{R}$ 的内部参数，在这里是 $\\theta$。因此，前乘 $\\boldsymbol{S}$ 不影响 $\\theta$ 的奇异性条件。无论肩胛骨的朝向如何，盂肱关节的万向节死锁姿态仍然在 $\\theta = \\pi/2$ 时发生。\n\n最后，我们必须确定一个局部非奇异的重新参数化方法。欧拉角是一个3参数系统，从拓扑学上讲，它必然存在奇异构型。为了避免这种情况，我们可以使用超过3个参数的表示法，或者其奇异点位于工作空间之外的表示法。\n一个合适的重新参数化是轴-角表示法，也称为旋转向量 $\\boldsymbol{r} \\in \\mathbb{R}^3$。一个朝向由向量 $\\boldsymbol{r} = \\alpha \\hat{\\boldsymbol{n}}$ 描述，其中 $\\hat{\\boldsymbol{n}}$ 是表示旋转轴的单位向量，$\\alpha = \\|\\boldsymbol{r}\\|$ 是旋转角度。角速度 $\\boldsymbol{\\omega}$ 和旋转向量变化率 $\\dot{\\boldsymbol{r}}$ 之间的关系由 $\\boldsymbol{\\omega} = \\boldsymbol{J}_r(\\boldsymbol{r})\\dot{\\boldsymbol{r}}$ 给出。雅可比矩阵 $\\boldsymbol{J}_r$ 在任何地方都是可逆的，除了当旋转角 $\\alpha$ 是 $\\pi$ 的整数倍时（即，$\\alpha = k\\pi$，其中 $k \\in \\mathbb{Z}$）。\n我们发现的奇异姿态对应于绕某个轴旋转 $\\theta = \\pi/2$。例如，如果 $\\psi=0$ 和 $\\phi=0$，总旋转是绕 $y$ 轴旋转 $\\pi/2$。相应的旋转向量是 $\\boldsymbol{r} = (0, \\pi/2, 0)^{\\top}$，其模长为 $\\|\\boldsymbol{r}\\| = \\pi/2$。由于这个模长不是 $\\pi$ 的整数倍，雅可比矩阵 $\\boldsymbol{J}_r$ 在这个姿态及其附近是可逆的。这意味着任何期望的角速度 $\\boldsymbol{\\omega}$ 都可以由一个相应的速率 $\\dot{\\boldsymbol{r}}$ 唯一地产生。这种映射的局部可逆性规避了使用 $Z$-$Y$-$X$ 欧拉角序列时遇到的万向节死锁问题。另一个常见且全局非奇异的选择是单位四元数表示法。",
            "answer": "$$\n\\boxed{1.571}\n$$"
        }
    ]
}