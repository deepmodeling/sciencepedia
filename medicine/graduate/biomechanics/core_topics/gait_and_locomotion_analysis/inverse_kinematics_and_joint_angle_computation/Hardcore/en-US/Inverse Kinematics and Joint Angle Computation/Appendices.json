{
    "hands_on_practices": [
        {
            "introduction": "Before we can solve the inverse problem of finding joint angles from a desired pose, we must master the forward problem. This practice solidifies the fundamental skill of computing an end-effector's orientation by composing successive joint rotations along a kinematic chain. By comparing the orientation derived from our model with hypothetical measurement data, we also engage in a crucial step of biomechanical analysis: model validation and consistency checking. ",
            "id": "4181878",
            "problem": "A human upper-limb is modeled as a serial chain of rigid segments with ideal joints. The trunk (proximal) reference frame is defined according to the International Society of Biomechanics (ISB) convention: the $x$-axis points anteriorly, the $y$-axis points to the subject's left (laterally), and the $z$-axis points superiorly. The shoulder is modeled as a three-degree-of-freedom ball-and-socket joint parameterized by intrinsic yaw–pitch–roll (rotations about the current joint’s $z$-, then $y$-, then $x$-axes). The elbow provides flexion/extension modeled as a single-axis rotation about the forearm's local $y$-axis, and the wrist is neutral for the instant considered.\n\nAt a specific time instant, the joint angles are measured as follows (use radians):\n- Shoulder yaw $\\psi_{s} = \\pi/4$, shoulder pitch $\\theta_{s} = \\pi/4$, shoulder roll $\\phi_{s} = 0$.\n- Elbow flexion $\\theta_{e} = \\pi/2$ about the forearm’s local $y$-axis.\n- Wrist pronation–supination and flexion–extension are both $0$.\n\nAssume each joint rotation acts on the child segment's local frame and that the hand segment is aligned with the forearm.\n\n1. Using rigid-body rotation composition from the trunk frame through shoulder and elbow to the hand, compute the hand end-effector orientation matrix $R_{\\text{model}} \\in \\mathbb{R}^{3 \\times 3}$ with respect to the trunk frame.\n\n2. A motion-capture system reports the hand orientation (with respect to the same trunk frame) as the matrix\n$$\nR_{\\text{measured}} =\n\\begin{bmatrix}\n-0.5  -0.609540151  \\phantom{-}0.615191681 \\\\\n-0.5  \\phantom{-}0.783188329  \\phantom{-}0.369616073 \\\\\n-0.707106781  -0.122787804  -0.696364240\n\\end{bmatrix}.\n$$\n\nUsing the Frobenius norm consistency metric\n$$\n\\left\\| R_{\\text{model}}^{\\top} R_{\\text{measured}} - I \\right\\|_{F},\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix, compute the numerical value of this metric. Round your final result to four significant figures. Express the final value as a dimensionless quantity (no units). The answer must be a single real number.",
            "solution": "The problem requires a two-part calculation. First, we compute the theoretical orientation matrix of the hand, $R_{\\text{model}}$, based on a kinematic model of the upper limb. Second, we quantify the discrepancy between this model and a given measured orientation, $R_{\\text{measured}}$, using the specified Frobenius norm metric.\n\nPart 1: Computation of $R_{\\text{model}}$\n\nThe orientation of the hand relative to the trunk is found by composing the rotations of the shoulder and elbow joints. The problem specifies an intrinsic yaw–pitch–roll ($z$-$y'$-$x''$) convention for the shoulder and a simple hinge rotation for the elbow.\n\nThe standard rotation matrices about the main axes are:\n$R_x(\\alpha) = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{pmatrix}$, $R_y(\\beta) = \\begin{pmatrix} \\cos\\beta  0  \\sin\\beta \\\\ 0  1  0 \\\\ -\\sin\\beta  0  \\cos\\beta \\end{pmatrix}$, $R_z(\\gamma) = \\begin{pmatrix} \\cos\\gamma  -\\sin\\gamma  0 \\\\ \\sin\\gamma  \\cos\\gamma  0 \\\\ 0  0  1 \\end{pmatrix}$.\n\nThe shoulder rotation is an intrinsic sequence of yaw ($\\psi_{s}$) about the $z$-axis, pitch ($\\theta_{s}$) about the new $y$-axis, and roll ($\\phi_{s}$) about the newest $x$-axis. This corresponds to the matrix product $R_{\\text{shoulder}} = R_z(\\psi_{s}) R_y(\\theta_{s}) R_x(\\phi_{s})$.\nThe given joint angles for the shoulder are $\\psi_{s} = \\pi/4$, $\\theta_{s} = \\pi/4$, and $\\phi_{s} = 0$. Since $\\phi_{s}=0$, the rotation matrix for roll is the identity matrix, $R_x(0) = I$.\n\nThus, the shoulder rotation matrix, which transforms from the upper-arm frame to the trunk frame, is:\n$R_{\\text{shoulder}} = R_z(\\pi/4) R_y(\\pi/4)$.\nWe have $\\cos(\\pi/4) = \\sin(\\pi/4) = \\frac{1}{\\sqrt{2}}$.\n$$\nR_{\\text{shoulder}} = \\begin{pmatrix} \\cos(\\pi/4)  -\\sin(\\pi/4)  0 \\\\ \\sin(\\pi/4)  \\cos(\\pi/4)  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\pi/4)  0  \\sin(\\pi/4) \\\\ 0  1  0 \\\\ -\\sin(\\pi/4)  0  \\cos(\\pi/4) \\end{pmatrix}\n$$\n$$\nR_{\\text{shoulder}} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\\\ 0  1  0 \\\\ -\\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\nThe elbow joint provides flexion of $\\theta_{e} = \\pi/2$ about the local $y$-axis. This rotation transforms from the forearm/hand frame to the upper-arm frame. The wrist is neutral, so the hand frame is aligned with the forearm frame.\n$$\nR_{\\text{elbow}} = R_y(\\theta_e) = R_y(\\pi/2) = \\begin{pmatrix} \\cos(\\pi/2)  0  \\sin(\\pi/2) \\\\ 0  1  0 \\\\ -\\sin(\\pi/2)  0  \\cos(\\pi/2) \\end{pmatrix} = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ -1  0  0 \\end{pmatrix}\n$$\nThe total orientation of the hand with respect to the trunk, $R_{\\text{model}}$, is the product of these matrices:\n$R_{\\text{model}} = R_{\\text{shoulder}} R_{\\text{elbow}}$.\n$$\nR_{\\text{model}} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}}  0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ -1  0  0 \\end{pmatrix}\n$$\n$$\nR_{\\text{model}} = \\begin{pmatrix} -\\frac{1}{2}  -\\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\ -\\frac{1}{\\sqrt{2}}  0  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\n\nPart 2: Computation of the Consistency Metric\n\nThe consistency metric is defined as $C = \\left\\| R_{\\text{model}}^{\\top} R_{\\text{measured}} - I \\right\\|_{F}$. Let us first compute the matrix product $M = R_{\\text{model}}^{\\top} R_{\\text{measured}}$.\n$$\nR_{\\text{model}}^{\\top} = \\begin{pmatrix} -\\frac{1}{2}  -\\frac{1}{2}  -\\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n$$\nThe provided measured matrix is:\n$$\nR_{\\text{measured}} =\n\\begin{pmatrix}\n-0.5  -0.609540151  0.615191681 \\\\\n-0.5  0.783188329  0.369616073 \\\\\n-0.707106781  -0.122787804  -0.696364240\n\\end{pmatrix}\n$$\nWe note that $-0.707106781 = -1/\\sqrt{2}$. Substituting this into $R_{\\text{measured}}$:\n$$\nR_{\\text{measured}} =\n\\begin{pmatrix}\n-0.5  -0.609540151  0.615191681 \\\\\n-0.5  0.783188329  0.369616073 \\\\\n-1/\\sqrt{2}  -0.122787804  -0.696364240\n\\end{pmatrix}\n$$\nNow we compute $M = R_{\\text{model}}^{\\top} R_{\\text{measured}}$.\n$$\nM_{11} = (-\\frac{1}{2})(-0.5) + (-\\frac{1}{2})(-0.5) + (-\\frac{1}{\\sqrt{2}})(-\\frac{1}{\\sqrt{2}}) = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{2} = 1\n$$\nBy orthogonality, since the first columns of $R_{\\text{model}}$ and $R_{\\text{measured}}$ are identical, the off-diagonal terms in the first row and first column of $M$ will be zero. Let's verify $M_{12}$:\n$$\nM_{12} = (-\\frac{1}{2})(-0.609...) + (-\\frac{1}{2})(0.783...) + (-\\frac{1}{\\sqrt{2}})(-0.122...) \\approx 0.30477 - 0.39159 + 0.08682 \\approx 0\n$$\nIndeed, all $M_{1j}$ and $M_{i1}$ for $i,j \\neq 1$ are zero. Let's compute the remaining $2 \\times 2$ submatrix.\n$$\nM_{22} = (-\\frac{1}{\\sqrt{2}})(-0.609...) + (\\frac{1}{\\sqrt{2}})(0.783...) + (0) = \\frac{1}{\\sqrt{2}}(0.609540151 + 0.783188329) = \\frac{1.39272848}{\\sqrt{2}} \\approx 0.98480775\n$$\n$$\nM_{23} = (-\\frac{1}{\\sqrt{2}})(0.615...) + (\\frac{1}{\\sqrt{2}})(0.369...) + (0) = \\frac{1}{\\sqrt{2}}(-0.615191681 + 0.369616073) = \\frac{-0.245575608}{\\sqrt{2}} \\approx -0.17364818\n$$\n$$\nM_{32} = (\\frac{1}{2})(-0.609...) + (\\frac{1}{2})(0.783...) + (-\\frac{1}{\\sqrt{2}})(-0.122...) = \\frac{1}{2}(0.173648178) + 0.086824089 \\approx 0.17364818\n$$\n$$\nM_{33} = (\\frac{1}{2})(0.615...) + (\\frac{1}{2})(0.369...) + (-\\frac{1}{\\sqrt{2}})(-0.696...) = \\frac{1}{2}(0.984807754) + 0.492403877 \\approx 0.98480775\n$$\nThe values suggest that $M$ is a rotation matrix of the form $R_x(\\delta)$, where $\\cos\\delta \\approx 0.98480775$ and $\\sin\\delta \\approx 0.17364818$. These are the cosine and sine of $\\delta = 10^{\\circ} = \\pi/18 \\text{ rad}$.\nSo, $M = R_x(\\pi/18)$.\n\nThe error matrix is $E = M - I = R_x(\\pi/18) - I$.\n$$\nE = \\begin{pmatrix} 1  0  0 \\\\ 0  \\cos(\\pi/18)  -\\sin(\\pi/18) \\\\ 0  \\sin(\\pi/18)  \\cos(\\pi/18) \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\cos(\\pi/18)-1  -\\sin(\\pi/18) \\\\ 0  \\sin(\\pi/18)  \\cos(\\pi/18)-1 \\end{pmatrix}\n$$\nThe Frobenius norm is $\\|E\\|_F = \\sqrt{\\sum_{i,j} |E_{ij}|^2}$.\n$$\n\\|E\\|_F^2 = 0 + (\\cos(\\pi/18)-1)^2 + (-\\sin(\\pi/18))^2 + (\\sin(\\pi/18))^2 + (\\cos(\\pi/18)-1)^2\n$$\n$$\n\\|E\\|_F^2 = 2\\left[ (\\cos(\\pi/18)-1)^2 + \\sin^2(\\pi/18) \\right]\n$$\n$$\n\\|E\\|_F^2 = 2\\left[ \\cos^2(\\pi/18) - 2\\cos(\\pi/18) + 1 + \\sin^2(\\pi/18) \\right]\n$$\nUsing the identity $\\cos^2\\alpha + \\sin^2\\alpha = 1$:\n$$\n\\|E\\|_F^2 = 2\\left[ 1 - 2\\cos(\\pi/18) + 1 \\right] = 4(1 - \\cos(\\pi/18))\n$$\nThe metric is $C = \\|E\\|_F = \\sqrt{4(1 - \\cos(\\pi/18))} = 2\\sqrt{1 - \\cos(\\pi/18)}$.\nNow, we substitute the numerical value $\\cos(\\pi/18) \\approx 0.984807753$.\n$$\nC = 2\\sqrt{1 - 0.984807753} = 2\\sqrt{0.015192247} \\approx 2(0.123256878) \\approx 0.246513756\n$$\nRounding to four significant figures, the result is $0.2465$.",
            "answer": "$$\\boxed{0.2465}$$"
        },
        {
            "introduction": "A central challenge in implementing inverse kinematics solvers is handling kinematic singularities, configurations where the manipulator loses degrees of freedom and standard solutions can demand infinite joint velocities. This exercise provides a clear, quantitative demonstration of this instability for a simple planar arm and introduces Damped Least Squares (DLS) as a powerful remedy. By calculating and comparing both the undamped and damped solutions, you will gain direct insight into how regularization provides numerical stability and generates feasible motion. ",
            "id": "4181916",
            "problem": "A planar two-degree-of-freedom human upper limb model has a shoulder joint at the origin and an elbow joint, with segment lengths $L_{1} = 0.3\\,\\text{m}$ and $L_{2} = 0.3\\,\\text{m}$. The end-effector (wrist) Cartesian position is described by standard forward kinematics in the plane with shoulder angle $\\theta_{1}$ and elbow angle $\\theta_{2}$: \n$$x(\\theta_{1},\\theta_{2}) = L_{1}\\cos\\theta_{1} + L_{2}\\cos(\\theta_{1}+\\theta_{2}), \\quad y(\\theta_{1},\\theta_{2}) = L_{1}\\sin\\theta_{1} + L_{2}\\sin(\\theta_{1}+\\theta_{2}).$$\nInverse Kinematics (IK) for small updates uses the first-order linearization \n$$\\Delta \\mathbf{p} \\approx J(\\theta_{1},\\theta_{2})\\,\\Delta \\mathbf{q},$$ \nwhere $J(\\theta_{1},\\theta_{2})$ is the $2\\times 2$ Jacobian of $(x,y)$ with respect to $\\mathbf{q} = [\\theta_{1},\\,\\theta_{2}]^{\\top}$ and $\\Delta \\mathbf{p}$ is the Cartesian task-space error. Consider the near-singular extended configuration $\\theta_{1} = 0$ and $\\theta_{2} = 0$, and a small desired end-effector correction \n$$\\mathbf{e} = \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix}\\,\\text{m}.$$\nConstruct the undamped IK update by posing the least-norm solution to the linearized consistency condition and derive the corresponding expression using the Moore–Penrose pseudoinverse. Next, construct a Damped Least Squares (DLS) IK update by posing a Tikhonov-regularized objective with a task-space damping factor $\\lambda = 0.3\\,\\text{m}$, and derive the corresponding expression for the damped pseudoinverse. Using these derived updates evaluated at the given configuration, compute the ratio $r$ of the Euclidean norms of the undamped joint update to the damped joint update,\n$$r \\;=\\; \\frac{\\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2}}{\\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2}},$$\nand report the final value of $r$. Round your answer to four significant figures. The final answer is unitless and should be expressed as a single real number.",
            "solution": "The Jacobian matrix $J$ relates joint velocities to end-effector velocities, $J = \\frac{\\partial \\mathbf{p}}{\\partial \\mathbf{q}}$. For $\\mathbf{p} = [x, y]^T$ and $\\mathbf{q} = [\\theta_1, \\theta_2]^T$, the Jacobian is:\n$$ J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\theta_1}  \\frac{\\partial x}{\\partial \\theta_2} \\\\ \\frac{\\partial y}{\\partial \\theta_1}  \\frac{\\partial y}{\\partial \\theta_2} \\end{pmatrix} = \\begin{pmatrix} -L_1 \\sin\\theta_1 - L_2 \\sin(\\theta_1+\\theta_2)  -L_2 \\sin(\\theta_1+\\theta_2) \\\\ L_1 \\cos\\theta_1 + L_2 \\cos(\\theta_1+\\theta_2)  L_2 \\cos(\\theta_1+\\theta_2) \\end{pmatrix} $$\nWe evaluate the Jacobian at the given configuration $\\theta_1 = 0$ and $\\theta_2 = 0$, with $L_1 = 0.3\\,\\text{m}$ and $L_2 = 0.3\\,\\text{m}$.\n$$ J = \\begin{pmatrix} -L_1 \\sin(0) - L_2 \\sin(0)  -L_2 \\sin(0) \\\\ L_1 \\cos(0) + L_2 \\cos(0)  L_2 \\cos(0) \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ L_1 + L_2  L_2 \\end{pmatrix} $$\nSubstituting the values of $L_1$ and $L_2$:\n$$ J = \\begin{pmatrix} 0  0 \\\\ 0.3+0.3  0.3 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0.6  0.3 \\end{pmatrix}\\,\\text{m} $$\nThis matrix is singular since its determinant is $0$, as expected for a fully extended arm configuration.\n\nThe undamped least-norm solution to the linear system $J \\Delta\\mathbf{q} = \\mathbf{e}$ is given by $\\Delta \\mathbf{q}_{\\text{undamped}} = J^\\dagger \\mathbf{e}$, where $J^\\dagger$ is the Moore-Penrose pseudoinverse of $J$. For the given singular matrix $J$, $J^\\dagger = \\begin{pmatrix} 0  4/3 \\\\ 0  2/3 \\end{pmatrix}$. The joint update is:\n$$ \\Delta \\mathbf{q}_{\\text{undamped}} = \\begin{pmatrix} 0  4/3 \\\\ 0  2/3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} (4/3) \\times 0.01 \\\\ (2/3) \\times 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.04/3 \\\\ 0.02/3 \\end{pmatrix} $$\nThe Euclidean norm of this update is:\n$$ \\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2} = \\sqrt{\\left(\\frac{0.04}{3}\\right)^2 + \\left(\\frac{0.02}{3}\\right)^2} = \\sqrt{\\frac{0.0016}{9} + \\frac{0.0004}{9}} = \\frac{\\sqrt{0.002}}{3} $$\n\nThe Damped Least Squares (DLS) update is the solution to the Tikhonov-regularized problem $\\min_{\\Delta \\mathbf{q}} (\\|J \\Delta \\mathbf{q} - \\mathbf{e}\\|^2 + \\lambda^2 \\|\\Delta \\mathbf{q}\\|^2)$, which can be expressed as $\\Delta \\mathbf{q}_{\\text{damped}} = J^T (J J^T + \\lambda^2 I)^{-1} \\mathbf{e}$. With $\\lambda = 0.3$, we have $\\lambda^2 = 0.09$.\nFirst, we compute the necessary matrices:\n$$ J^T = \\begin{pmatrix} 0  0.6 \\\\ 0  0.3 \\end{pmatrix} $$\n$$ J J^T = \\begin{pmatrix} 0  0 \\\\ 0.6  0.3 \\end{pmatrix} \\begin{pmatrix} 0  0.6 \\\\ 0  0.3 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0.6^2 + 0.3^2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0.45 \\end{pmatrix} $$\n$$ J J^T + \\lambda^2 I = \\begin{pmatrix} 0  0 \\\\ 0  0.45 \\end{pmatrix} + \\begin{pmatrix} 0.09  0 \\\\ 0  0.09 \\end{pmatrix} = \\begin{pmatrix} 0.09  0 \\\\ 0  0.54 \\end{pmatrix} $$\nThe inverse is $(J J^T + \\lambda^2 I)^{-1} = \\begin{pmatrix} 1/0.09  0 \\\\ 0  1/0.54 \\end{pmatrix}$.\nThe damped joint update is:\n$$ \\Delta \\mathbf{q}_{\\text{damped}} = J^T (J J^T + \\lambda^2 I)^{-1} \\mathbf{e} = \\begin{pmatrix} 0  0.6 \\\\ 0  0.3 \\end{pmatrix} \\begin{pmatrix} 1/0.09  0 \\\\ 0  1/0.54 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} $$\n$$ \\Delta \\mathbf{q}_{\\text{damped}} = \\begin{pmatrix} 0  0.6/0.54 \\\\ 0  0.3/0.54 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} 0  10/9 \\\\ 0  5/9 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.1/9 \\\\ 0.05/9 \\end{pmatrix} $$\nThe Euclidean norm of the damped update is:\n$$ \\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2} = \\sqrt{\\left(\\frac{0.1}{9}\\right)^2 + \\left(\\frac{0.05}{9}\\right)^2} = \\sqrt{\\frac{0.01}{81} + \\frac{0.0025}{81}} = \\frac{\\sqrt{0.0125}}{9} $$\n\nFinally, we compute the ratio $r$ of the norms:\n$$ r = \\frac{\\|\\Delta \\mathbf{q}_{\\text{undamped}}\\|_{2}}{\\|\\Delta \\mathbf{q}_{\\text{damped}}\\|_{2}} = \\frac{\\sqrt{0.002}/3}{\\sqrt{0.0125}/9} = \\frac{\\sqrt{0.002}}{3} \\times \\frac{9}{\\sqrt{0.0125}} = 3 \\sqrt{\\frac{0.002}{0.0125}} $$\nSimplifying the fraction:\n$$ \\frac{0.002}{0.0125} = \\frac{2}{12.5} = \\frac{4}{25} = 0.16 $$\nSubstituting this back into the expression for $r$:\n$$ r = 3 \\sqrt{0.16} = 3 \\times 0.4 = 1.2 $$\nRounding to four significant figures, the result is $1.200$.",
            "answer": "$$\n\\boxed{1.200}\n$$"
        },
        {
            "introduction": "The choice of how to represent 3D rotations is not arbitrary; it has critical consequences for the numerical stability and performance of an IK solver. This practice moves beyond specific algorithms to analyze the underlying mathematical tools themselves, quantitatively comparing Euler angles and unit quaternions near a non-singular configuration. By linearizing the rotation mappings and calculating a noise amplification factor for each, you will discover a fundamental reason why quaternions are often favored for their well-behaved properties, a key piece of practical knowledge for developing robust biomechanical models. ",
            "id": "4181931",
            "problem": "A motion capture laboratory is analyzing three-dimensional joint orientations for a human elbow during slow flexion and pronation, and is determining the numerical stability of the orientation parameterization used inside the segment-level Inverse Kinematics (IK) pipeline. The joint orientation is represented by a rotation matrix $R \\in \\mathrm{SO}(3)$. Two parameterizations are considered: (i) yaw–pitch–roll Euler angles with the $Z$–$Y$–$X$ convention, and (ii) unit quaternions.\n\nAssume the true joint orientation is the identity rotation. Let the Euler angles be $\\boldsymbol{\\theta} = (\\alpha,\\beta,\\gamma)$ so that $R(\\boldsymbol{\\theta}) = R_{z}(\\alpha) R_{y}(\\beta) R_{x}(\\gamma)$, where $R_{x}(\\gamma)$, $R_{y}(\\beta)$, and $R_{z}(\\alpha)$ are standard axis rotations about the $x$, $y$, and $z$ axes, respectively. Let the unit quaternion be $q = (w, x, y, z)$ with $w^{2} + x^{2} + y^{2} + z^{2} = 1$, and $R(q)$ be its corresponding rotation matrix defined by the standard quaternion-to-rotation mapping.\n\nIn the presence of small-angle noise, linearize the mapping from parameters to rotation matrices around the identity. Model parameter noise as independent, zero-mean, isotropic Gaussian perturbations in each coordinate with the same variance per component across parameterizations. Specifically, let $\\delta \\boldsymbol{\\theta}$ have independent entries with variance $\\sigma^{2}$ (in radians), and let the quaternion perturbation be tangent to the unit sphere at $q_{0} = (1, 0, 0, 0)$ so that $\\delta q = (\\delta w, \\delta x, \\delta y, \\delta z)$ satisfies the first-order normalization constraint, with $(\\delta x, \\delta y, \\delta z)$ independent with variance $\\sigma^{2}$ and $\\delta w$ determined by normalization.\n\nDefine the local noise amplification factor for a parameterization as the operator norm of the Jacobian that maps parameter perturbations to rotation-matrix perturbations, measured from the Euclidean norm in parameter space to the Frobenius norm in matrix space. That is, for Euler angles,\n$$\n\\kappa_{\\boldsymbol{\\theta}} \\equiv \\sup_{\\|\\delta \\boldsymbol{\\theta}\\|_{2} = 1} \\| \\delta R(\\boldsymbol{\\theta}) \\|_{F},\n$$\nand for the quaternion,\n$$\n\\kappa_{q} \\equiv \\sup_{\\|(\\delta x, \\delta y, \\delta z)\\|_{2} = 1} \\| \\delta R(q) \\|_{F}.\n$$\n\nUsing only fundamental definitions of $R_{x}(\\gamma)$, $R_{y}(\\beta)$, $R_{z}(\\alpha)$, the quaternion-to-rotation mapping, the unit-quaternion normalization constraint, and first-order linearization, derive $\\kappa_{\\boldsymbol{\\theta}}$ and $\\kappa_{q}$ at the identity orientation. Then, compute the ratio\n$$\n\\rho \\equiv \\frac{\\kappa_{q}}{\\kappa_{\\boldsymbol{\\theta}}}.\n$$\n\nExpress your final result as a dimensionless number. No rounding is necessary; provide the exact value.",
            "solution": "The rotation matrix for the $Z$-$Y$-$X$ Euler angle sequence $\\boldsymbol{\\theta} = (\\alpha, \\beta, \\gamma)$ is $R(\\boldsymbol{\\theta}) = R_{z}(\\alpha) R_{y}(\\beta) R_{x}(\\gamma)$. We analyze behavior around the identity rotation, corresponding to $\\boldsymbol{\\theta} = (0, 0, 0)$. For a small perturbation $\\delta\\boldsymbol{\\theta} = (\\delta\\alpha, \\delta\\beta, \\delta\\gamma)$, we can linearize the rotation matrices: $R_x(\\delta\\gamma) \\approx I + \\delta\\gamma K_x$, $R_y(\\delta\\beta) \\approx I + \\delta\\beta K_y$, and $R_z(\\delta\\alpha) \\approx I + \\delta\\alpha K_z$, where $K_x, K_y, K_z$ are the skew-symmetric generators of rotation.\n\nTo first order, the total rotation is $R(\\delta\\boldsymbol{\\theta}) \\approx (I + \\delta\\alpha K_z)(I + \\delta\\beta K_y)(I + \\delta\\gamma K_x) \\approx I + \\delta\\alpha K_z + \\delta\\beta K_y + \\delta\\gamma K_x$. The matrix perturbation $\\delta R = R(\\delta\\boldsymbol{\\theta}) - I$ is therefore:\n$$\\delta R \\approx \\begin{pmatrix} 0  -\\delta\\alpha  \\delta\\beta \\\\ \\delta\\alpha  0  -\\delta\\gamma \\\\ -\\delta\\beta  \\delta\\gamma  0 \\end{pmatrix}$$\nThe squared Frobenius norm of this perturbation is:\n$$\\|\\delta R\\|_F^2 = (-\\delta\\alpha)^2 + (\\delta\\beta)^2 + (\\delta\\alpha)^2 + (-\\delta\\gamma)^2 + (-\\delta\\beta)^2 + (\\delta\\gamma)^2 = 2(\\delta\\alpha^2 + \\delta\\beta^2 + \\delta\\gamma^2) = 2\\|\\delta\\boldsymbol{\\theta}\\|_2^2$$\nThe local noise amplification factor $\\kappa_{\\boldsymbol{\\theta}}$ is defined as:\n$$\\kappa_{\\boldsymbol{\\theta}} \\equiv \\sup_{\\|\\delta \\boldsymbol{\\theta}\\|_{2} = 1} \\| \\delta R(\\boldsymbol{\\theta}) \\|_{F} = \\sup_{\\|\\delta \\boldsymbol{\\theta}\\|_{2} = 1} \\sqrt{2\\|\\delta\\boldsymbol{\\theta}\\|_2^2} = \\sqrt{2}$$\n\nFor the unit quaternion $q = (w, x, y, z)$, the identity rotation is $q_0 = (1, 0, 0, 0)$. A small perturbation around $q_0$ is $q = (1+\\delta w, \\delta x, \\delta y, \\delta z)$. The first-order unit norm constraint $(1+\\delta w)^2 + \\delta x^2 + \\delta y^2 + \\delta z^2 = 1$ implies $\\delta w = 0$. So the perturbed quaternion is $q = (1, \\delta x, \\delta y, \\delta z)$. The rotation matrix corresponding to a quaternion $q=(w,x,y,z)$ is:\n$$R(q) = \\begin{pmatrix}\n1 - 2(y^2 + z^2)  2(xy - wz)  2(xz + wy) \\\\\n2(xy + wz)  1 - 2(x^2 + z^2)  2(yz - wx) \\\\\n2(xz - wy)  2(yz + wx)  1 - 2(x^2 + y^2)\n\\end{pmatrix}$$\nSubstituting $w=1, x=\\delta x, y=\\delta y, z=\\delta z$ and keeping only first-order terms:\n$$R(1, \\delta x, \\delta y, \\delta z) \\approx \\begin{pmatrix}\n1  -2\\delta z  2\\delta y \\\\\n2\\delta z  1  -2\\delta x \\\\\n-2\\delta y  2\\delta x  1\n\\end{pmatrix}$$\nThe matrix perturbation $\\delta R = R(q) - I$ is:\n$$\\delta R \\approx \\begin{pmatrix}\n0  -2\\delta z  2\\delta y \\\\\n2\\delta z  0  -2\\delta x \\\\\n-2\\delta y  2\\delta x  0\n\\end{pmatrix}$$\nThe squared Frobenius norm of this perturbation, with $\\delta\\boldsymbol{v} = (\\delta x, \\delta y, \\delta z)$, is:\n$$\\|\\delta R\\|_F^2 = 8(\\delta x^2 + \\delta y^2 + \\delta z^2) = 8\\|\\delta\\boldsymbol{v}\\|_2^2$$\nThe local noise amplification factor $\\kappa_q$ is defined as:\n$$\\kappa_{q} \\equiv \\sup_{\\|(\\delta x, \\delta y, \\delta z)\\|_{2} = 1} \\| \\delta R(q) \\|_{F} = \\sup_{\\|\\delta\\boldsymbol{v}\\|_{2} = 1} \\sqrt{8\\|\\delta\\boldsymbol{v}\\|_2^2} = \\sqrt{8} = 2\\sqrt{2}$$\n\nFinally, the ratio of the amplification factors is:\n$$\\rho \\equiv \\frac{\\kappa_{q}}{\\kappa_{\\boldsymbol{\\theta}}} = \\frac{2\\sqrt{2}}{\\sqrt{2}} = 2$$",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}