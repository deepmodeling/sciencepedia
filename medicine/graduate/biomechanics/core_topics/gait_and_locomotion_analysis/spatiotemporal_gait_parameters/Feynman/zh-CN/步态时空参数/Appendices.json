{
    "hands_on_practices": [
        {
            "introduction": "这个首个练习旨在巩固时空参数的基本定义 。你将从步速和步频等基本量出发，计算步长和步幅等关键参数，从而加深对核心运动学关系的理解。接着，该练习将引导你转向一个关键的实际问题：分析离散的传感器网格如何引入量化误差，为理解实验生物力学中的测量不确定性奠定基础。",
            "id": "4204350",
            "problem": "一名受试者在水平表面上以恒定的前进速度 $v$ 和固定的步频 $C$ 稳定行走，其中 $v = 1.25\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ 且 $C = 120\\,\\text{步}\\,\\mathrm{min}^{-1}$。令 $x(t)$ 表示受试者质心的前进位置，令 $\\{t_n\\}$ 表示连续足部接触的时间，每步一次接触。将步长 $L_{\\mathrm{step}}$ 定义为每步前进的距离，$L_{\\mathrm{step}} = x(t_{n+1}) - x(t_n)$，将步幅 $L_{\\mathrm{stride}}$ 定义为包含连续两步的一个完整步态周期内前进的距离。假设行走是稳定的直线运动，滑动可忽略不计，且具有双侧对称性，因此连续的左、右步具有相等的平均长度。\n\n从 $v = \\mathrm{d}x/\\mathrm{d}t$ 的基本定义和步频作为单位时间步数的定义出发，从第一性原理推导关联 $v$、$C$、$L_{\\mathrm{step}}$ 和 $L_{\\mathrm{stride}}$ 的表达式，并根据给定的 $v$ 和 $C$ 计算 $L_{\\mathrm{step}}$ 和 $L_{\\mathrm{stride}}$ 的数值。两种长度均以米为单位表示，并将您的答案四舍五入至四位有效数字。\n\n此外，考虑在压力感应走道上测量落足质心，该走道在一个间距为 $g = 0.02\\,\\mathrm{m}$ 的方形网格上报告位置，方法是将每个质心位置舍入到最近的网格节点。运用第一性原理，讨论这种离散舍入如何在 $L_{\\mathrm{step}}$ 的测量中引入量化。在落足质心与网格节点之间随机相位对齐以及连续落足舍入误差相互独立的假设下，描述该误差的期望均值和均方根（RMS）。不要修改您最终计算的 $L_{\\mathrm{step}}$ 和 $L_{\\mathrm{stride}}$ 的数值；此讨论与所要求的计算无关。",
            "solution": "该问题陈述经评估为有效，因为它在科学上基于运动学和生物力学原理，问题设定适定，信息充分且一致，并以客观、明确的语言表达。\n\n按照要求，解答分为两部分。首先，我们推导步行速度 $v$、步频 $C$、步长 $L_{\\mathrm{step}}$ 和步幅 $L_{\\mathrm{stride}}$ 之间的关系，然后计算后两者的数值。其次，我们分析测量步长时的量化误差。\n\n第一部分：步态参数的推导与计算\n\n给定恒定的前进速度 $v = 1.25\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ 和步频 $C = 120\\,\\text{步}\\,\\mathrm{min}^{-1}$。步频定义为单位时间内所走的步数。为使用国际单位制，我们将步频从步/分钟转换为步/秒。\n$$\nC = 120\\,\\frac{\\text{步}}{\\text{min}} \\times \\frac{1\\,\\text{min}}{60\\,\\mathrm{s}} = 2\\,\\frac{\\text{步}}{\\mathrm{s}}\n$$\n该值代表步频率。单步的持续时间 $\\Delta t_{\\mathrm{step}}$ 是步频（以步/秒表示时）的倒数。\n$$\n\\Delta t_{\\mathrm{step}} = \\frac{1}{C} = \\frac{1}{2\\,\\mathrm{s}^{-1}} = 0.5\\,\\mathrm{s}\n$$\n问题将步长 $L_{\\mathrm{step}}$ 定义为每步前进的距离，可以写成 $L_{\\mathrm{step}} = x(t_{n+1}) - x(t_n)$，其中 $t_{n+1} - t_n = \\Delta t_{\\mathrm{step}}$。由于受试者以恒定速度 $v = \\mathrm{d}x/\\mathrm{d}t$ 行走，在时间间隔 $\\Delta t$ 内行进的距离由 $\\Delta x = v \\Delta t$ 给出。对于单步而言，距离是步长，时间间隔是步长持续时间。\n$$\nL_{\\mathrm{step}} = v \\cdot \\Delta t_{\\mathrm{step}} = \\frac{v}{C}\n$$\n代入给定的数值：\n$$\nL_{\\mathrm{step}} = \\frac{1.25\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{2\\,\\mathrm{s}^{-1}} = 0.625\\,\\mathrm{m}\n$$\n一个步幅定义为一个完整的步态周期，包含连续两步（例如，一个左步后跟一个右步）。步幅 $L_{\\mathrm{stride}}$ 是在这两步中前进的距离。基于双侧对称性（左、右步平均长度相等）的假设，步幅恰好是步长的两倍。\n$$\nL_{\\mathrm{stride}} = 2 L_{\\mathrm{step}}\n$$\n或者，一个步幅的持续时间是 $2\\Delta t_{\\mathrm{step}}$，所以行进的距离是：\n$$\nL_{\\mathrm{stride}} = v \\cdot (2 \\Delta t_{\\mathrm{step}}) = \\frac{2v}{C}\n$$\n代入数值：\n$$\nL_{\\mathrm{stride}} = 2 \\times 0.625\\,\\mathrm{m} = 1.25\\,\\mathrm{m}\n$$\n题目要求将答案四舍五入至四位有效数字。\n$$\nL_{\\mathrm{step}} = 0.6250\\,\\mathrm{m}\n$$\n$$\nL_{\\mathrm{stride}} = 1.250\\,\\mathrm{m}\n$$\n\n第二部分：量化误差分析\n\n我们现在考虑使用一个间距为 $g = 0.02\\,\\mathrm{m}$ 的方形网格的压力感应走道来测量落足位置。设第 $n$ 个落足质心的真实连续前进位置为 $p_n$。该走道通过将 $p_n$ 舍入到最近的网格节点来报告一个测量位置 $\\hat{p}_n$。网格节点的位置可以写成 $k \\cdot g$，其中 $k$ 为某个整数。\n\n单个位置测量的舍入误差为 $\\epsilon_n = \\hat{p}_n - p_n$。“随机相位对齐”的假设意味着落足质心在相对于网格节点的任何位置都是等可能的。这意味着单次测量的误差 $\\epsilon_n$ 是一个随机变量，服从区间 $[ -g/2, g/2 ]$ 上的连续均匀分布。\n\n真实步长为 $L_{\\mathrm{step}} = p_{n+1} - p_n$。\n测量步长为 $\\hat{L}_{\\mathrm{step}} = \\hat{p}_{n+1} - \\hat{p}_n$。\n\n步长测量的误差 $\\Delta L$ 是测量值与真实值之差：\n$$\n\\Delta L = \\hat{L}_{\\mathrm{step}} - L_{\\mathrm{step}} = (\\hat{p}_{n+1} - \\hat{p}_n) - (p_{n+1} - p_n)\n$$\n重新整理各项，我们用单个位置误差来表示步长误差：\n$$\n\\Delta L = (\\hat{p}_{n+1} - p_{n+1}) - (\\hat{p}_n - p_n) = \\epsilon_{n+1} - \\epsilon_n\n$$\n题目要求假设连续的舍入误差是独立的。因此，$\\epsilon_n$ 和 $\\epsilon_{n+1}$ 是来自均匀分布 $U(-g/2, g/2)$ 的独立同分布（i.i.d.）随机变量。\n\n首先，我们描述此误差的期望均值。根据期望的线性性质：\n$$\nE[\\Delta L] = E[\\epsilon_{n+1} - \\epsilon_n] = E[\\epsilon_{n+1}] - E[\\epsilon_n]\n$$\n均匀分布 $U(a,b)$ 的期望值（均值）是 $(a+b)/2$。对于我们的误差分布 $U(-g/2, g/2)$，其均值为：\n$$\nE[\\epsilon_n] = E[\\epsilon_{n+1}] = \\frac{(-g/2) + (g/2)}{2} = 0\n$$\n因此，步长测量误差的期望均值为：\n$$\nE[\\Delta L] = 0 - 0 = 0\n$$\n这个结果表明测量过程是无偏的；平均而言，它不会系统性地高估或低估步长。\n\n接下来，我们描述误差的均方根（RMS）。RMS误差定义为 $\\sqrt{E[(\\Delta L)^2]}$。由于平均误差 $E[\\Delta L]$ 为 $0$，RMS误差等于 $\\Delta L$ 的标准差 $\\sigma_{\\Delta L} = \\sqrt{\\mathrm{Var}(\\Delta L)}$。\n\n$\\Delta L$ 的方差为：\n$$\n\\mathrm{Var}(\\Delta L) = \\mathrm{Var}(\\epsilon_{n+1} - \\epsilon_n)\n$$\n因为 $\\epsilon_n$ 和 $\\epsilon_{n+1}$ 是独立的，它们差的方差是它们方差的和：\n$$\n\\mathrm{Var}(\\Delta L) = \\mathrm{Var}(\\epsilon_{n+1}) + \\mathrm{Var}(\\epsilon_n)\n$$\n均匀分布 $U(a,b)$ 的方差是 $(b-a)^2/12$。对于我们的误差分布 $U(-g/2, g/2)$，其方差为：\n$$\n\\mathrm{Var}(\\epsilon_n) = \\mathrm{Var}(\\epsilon_{n+1}) = \\frac{(g/2 - (-g/2))^2}{12} = \\frac{g^2}{12}\n$$\n因此，步长误差的方差为：\n$$\n\\mathrm{Var}(\\Delta L) = \\frac{g^2}{12} + \\frac{g^2}{12} = \\frac{2g^2}{12} = \\frac{g^2}{6}\n$$\nRMS误差是此方差的平方根：\n$$\n\\text{RMS}(\\Delta L) = \\sqrt{\\mathrm{Var}(\\Delta L)} = \\sqrt{\\frac{g^2}{6}} = \\frac{g}{\\sqrt{6}}\n$$\n总之，步长测量的量化误差期望均值为 $0$，RMS值为 $g/\\sqrt{6}$，其中 $g$ 是测量系统的网格间距。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6250  1.250\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "本练习延续测量误差的主题，重点关注步态稳定性的一个关键指标：步长-步长变异性 。通过计算变异系数（CV）并应用方差可加性原理，你将学习如何从概念上区分真实的生理变异与叠加的测量噪声。这项技能对于准确解读步态分析数据、避免对个体的运动控制能力做出错误评估至关重要。",
            "id": "4204361",
            "problem": "一名健康的成年人在水平的仪器化跑步机上以自选的稳态速度行走。一个具有足够计时精度以进行人类步态分析的高速光学足开关系统记录了连续五次的右脚步长时间（即连续两次右脚跟触地之间的时间）。观测到的步长时间（单位：秒）为：$1.04$, $1.06$, $1.02$, $1.05$, $1.03$。该测量系统具有近似高斯分布的计时抖动，其已知标准差为每次事件 $0.002$ 秒，且各次事件之间独立。\n\n仅使用样本均值、样本标准差和变异系数（CV）的基本定义，将五个观测到的步长时间视为一个独立同分布的样本，并计算：\n- 样本平均步长时间 $\\,\\mu\\,$（单位：秒），\n- 样本标准差 $\\,\\sigma\\,$（单位：秒），\n- 变异系数（CV），定义为 $\\,\\sigma / \\mu\\,$，作为一个无量纲量。\n\n然后，从基本原理出发，论述已知的测量抖动相对于潜在的生理变异性，会如何影响观测到的变异性，并在适当时明确引用独立条件下的方差可加性原理。你可以假设步长时间的生理波动与测量抖动之间是相互独立的。\n\n仅报告变异系数作为你的最终数值答案，以小数形式表示（不带百分号），并四舍五入到四位有效数字。",
            "solution": "该问题陈述被认为是有效的，因为它在生物力学和统计学方面有科学依据，问题提出得当、客观、自洽且内部一致。\n\n五个观测到的步长时间（单位：秒）作为样本 $x$ 给出：$x_1 = 1.04$, $x_2 = 1.06$, $x_3 = 1.02$, $x_4 = 1.05$, $x_5 = 1.03$。样本大小为 $n=5$。问题要求将这些数据视为一个独立同分布（i.i.d.）的样本。\n\n首先，我们计算样本平均步长时间，根据问题的记法表示为 $\\mu$。样本均值的基本定义是观测值的算术平均值：\n$$\n\\mu = \\frac{1}{n} \\sum_{i=1}^{n} x_i\n$$\n代入给定值：\n$$\n\\mu = \\frac{1}{5} (1.04 + 1.06 + 1.02 + 1.05 + 1.03) = \\frac{5.20}{5} = 1.04 \\, \\text{s}\n$$\n\n接下来，我们计算样本标准差，表示为 $\\sigma$。（无偏）样本标准差的基本定义是样本方差的平方根。样本方差 $\\sigma^2$ 是与样本均值的离差平方和除以 $n-1$：\n$$\n\\sigma^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\mu)^2\n$$\n与均值（$\\mu = 1.04$）的偏差为：\n$x_1 - \\mu = 1.04 - 1.04 = 0.00$\n$x_2 - \\mu = 1.06 - 1.04 = 0.02$\n$x_3 - \\mu = 1.02 - 1.04 = -0.02$\n$x_4 - \\mu = 1.05 - 1.04 = 0.01$\n$x_5 - \\mu = 1.03 - 1.04 = -0.01$\n\n离差平方和为：\n$$\n\\sum_{i=1}^{5} (x_i - \\mu)^2 = (0.00)^2 + (0.02)^2 + (-0.02)^2 + (0.01)^2 + (-0.01)^2\n$$\n$$\n\\sum_{i=1}^{5} (x_i - \\mu)^2 = 0.0000 + 0.0004 + 0.0004 + 0.0001 + 0.0001 = 0.0010\n$$\n样本方差为：\n$$\n\\sigma^2 = \\frac{0.0010}{5-1} = \\frac{0.0010}{4} = 0.00025 \\, \\text{s}^2\n$$\n样本标准差是方差的平方根：\n$$\n\\sigma = \\sqrt{0.00025} \\, \\text{s} \\approx 0.015811388 \\, \\text{s}\n$$\n\n最后，我们计算变异系数（CV），其定义为样本标准差与样本均值的比值，即 $\\sigma / \\mu$：\n$$\n\\text{CV} = \\frac{\\sigma}{\\mu} = \\frac{\\sqrt{0.00025}}{1.04} \\approx \\frac{0.015811388}{1.04} \\approx 0.015203258\n$$\n按要求四舍五入到四位有效数字，我们得到 $\\text{CV} \\approx 0.01520$。\n\n现在，我们从基本原理出发，论述测量抖动的影响。设观测到的步长时间 $T_{obs}$ 可建模为真实的潜在生理步长时间 $T_{phys}$ 与代表抖动的随机测量误差 $E_{meas}$ 之和。\n$$\nT_{obs} = T_{phys} + E_{meas}\n$$\n问题陈述中要求假设生理波动与测量抖动之间是相互独立的。概率论的一个基本原理是，对于两个独立的随机变量，它们的和的方差等于它们各自方差的和。引用这个方差可加性原理：\n$$\n\\text{Var}(T_{obs}) = \\text{Var}(T_{phys}) + \\text{Var}(E_{meas})\n$$\n这个关系通常用 sigma 符号表示方差，即 $\\sigma^2$：\n$$\n\\sigma^2_{obs} = \\sigma^2_{phys} + \\sigma^2_{meas}\n$$\n我们计算出的样本方差($\\sigma^2 = 0.00025 \\, \\text{s}^2$)是总观测方差 $\\sigma^2_{obs}$ 的一个经验估计。问题给出了测量抖动的标准差($\\sigma_{meas} = 0.002 \\, \\text{s}$)，由此可得测量方差为($\\sigma^2_{meas} = (0.002)^2 = 0.000004 \\, \\text{s}^2$)。\n\n从方差可加性方程可以清楚地看出，观测方差 $\\sigma^2_{obs}$ 是真实生理方差与测量系统引入的方差之和。因此，只要存在任何测量抖动（$\\sigma^2_{meas} > 0$），观测方差就必然大于真实生理方差（$\\sigma^2_{obs} > \\sigma^2_{phys}$）。因此，观测标准差 $\\sigma_{obs} = \\sqrt{\\sigma^2_{phys} + \\sigma^2_{meas}}$ 是对真实生理标准差 $\\sigma_{phys}$ 的高估。测量过程人为地夸大了测得的变异性，使得步与步之间的时间看起来比生理上的实际情况更不一致。为了获得对真实生物变异性更准确的估计，需要在计算标准差之前，从观测方差中减去已知的测量方差。\n$$\n\\sigma^2_{phys} = \\sigma^2_{obs} - \\sigma^2_{meas}\n$$\n这一校正表明，测量抖动对观测变异性有贡献，如果不考虑它，将导致对人类步态模式中固有的生理变异性的系统性高估。计算出的 CV 基于观测标准差，因此同样是对真实生理变异系数的高估。",
            "answer": "$$\\boxed{0.01520}$$"
        },
        {
            "introduction": "这项综合性练习将挑战你超越描述性统计，进入随机建模的领域 。你将为一个步态时间扰动建立一个正式的数学模型，并用它来推导如阿伦方差（Allan variance）等对噪声时间结构敏感的高级度量。该练习综合了理论推导与计算技能，真实反映了当代生物力学研究中用于理解运动控制变异性本质的高级定量分析方法。",
            "id": "4204307",
            "problem": "考虑一个足跟触地事件时间序列，其模型为 $t_n = n T + \\epsilon_n$，其中 $n$ 是一个整数索引，$T$ 是以秒为单位的名义步幅时间，$\\epsilon_n$ 是一个有界的随机扰动，代表时间噪声。假设 $\\epsilon_n$ 是通过变换 $\\epsilon_n = B (2 U_n - 1)$ 从对称Beta分布族中得到的独立同分布（i.i.d.）样本，其中 $U_n \\sim \\mathrm{Beta}(\\alpha, \\alpha)$ 分布在 $[0,1]$ 区间上。参数 $B$ 是一个以秒为单位的界限，使得 $\\epsilon_n \\in [-B, B]$，而 $\\alpha > 0$ 是一个控制分布在界限内的形状参数。\n\n从时间序列、期望和方差的基本定义出发，并仅使用第一性原理（例如期望的线性性质、独立同分布变量的独立性以及基于微积分的近似），推导以下关于事件间期的时空步态变异性指标的闭式表达式（用 $T$、$B$ 和 $\\alpha$ 表示）：\n- 以秒为单位表示的事件间期序列 $\\Delta t_n = t_{n+1} - t_n$ 的标准差。\n- 以小数（无单位）表示的 $\\Delta t_n$ 的变异系数（CV），定义为 $\\Delta t_n$ 的标准差与其均值的比率。\n- 以 $\\mathrm{s}^2$ 为单位表示的 $\\Delta t_n$ 的滞后一阶Allan方差，定义为 $\\sigma_A^2 = \\frac{1}{2} \\mathbb{E}\\left[\\left(\\Delta t_{n+1} - \\Delta t_n\\right)^2\\right]$。\n- 以 $(\\mathrm{s}^{-1})^2$ 为单位表示的步频序列 $c_n = \\frac{1}{\\Delta t_n}$ 方差的小噪声近似，使用当 $\\Delta t_n$ 的方差相对于 $T^2$ 较小时有效的主阶展开。\n\n您必须明确说明推导过程中所作的任何假设，包括如何使用 $\\epsilon_n$ 的独立性，以及任何近似（例如，泰勒近似或delta方法近似）在何种条件下有效。所有推导出的公式必须仅用 $T$、$B$ 和 $\\alpha$ 表示，不得依赖模拟。\n\n实现一个程序，给定若干测试用例的 $(T, B, \\alpha)$，使用您推导的公式计算这四个指标。所有基于时间的量都明确以秒表示，步频变异性以 $(\\mathrm{s}^{-1})^2$ 表示。不涉及角度或百分比；CV必须以小数形式输出。\n\n使用以下参数集 $(T, B, \\alpha)$ 的测试套件：\n- 案例1（一般理想情况）：$T = 1.0\\,\\mathrm{s}$，$B = 0.02\\,\\mathrm{s}$，$\\alpha = 1.0$。\n- 案例2（无噪声的边界条件）：$T = 0.8\\,\\mathrm{s}$，$B = 0.0\\,\\mathrm{s}$，$\\alpha = 2.0$。\n- 案例3（质量更集中于边界的边缘情况）：$T = 0.6\\,\\mathrm{s}$，$B = 0.03\\,\\mathrm{s}$，$\\alpha = 0.5$。\n- 案例4（具有高峰值有界噪声的边缘情况）：$T = 1.2\\,\\mathrm{s}$，$B = 0.05\\,\\mathrm{s}$，$\\alpha = 10.0$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含四个浮点数的子列表，顺序为 $[\\text{std}(\\Delta t), \\text{CV}(\\Delta t), \\text{AllanVar}(\\Delta t), \\text{Var}(c)]$。例如，输出格式必须类似于 $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3],[a_4,b_4,c_4,d_4]]$，不含任何额外文本。",
            "solution": "所述问题是有效的。它在统计信号处理和生物力学领域具有科学依据，使用了一个标准的噪声周期过程模型。所有术语都有明确定义，问题是自洽、客观且数学上适定的，存在唯一解。所提供的参数在物理上是合理的。因此，我们可以进行推导。\n\n目标是基于所提供的足跟触地事件时间模型 $t_n = n T + \\epsilon_n$，为四个时空步态变异性指标推导闭式表达式。推导将从第一性原理进行。\n\n首先，我们必须描述噪声项 $\\epsilon_n$ 的统计特性。\n噪声项定义为 $\\epsilon_n = B (2 U_n - 1)$，其中 $U_n$ 是一个服从对称Beta分布的随机变量，$U_n \\sim \\mathrm{Beta}(\\alpha, \\alpha)$。随机变量 $\\epsilon_n$ 是独立同分布（i.i.d.）的。我们需要求出均值 $\\mathbb{E}[\\epsilon_n]$ 和方差 $\\text{Var}(\\epsilon_n)$。\n\n服从 $\\mathrm{Beta}(a, b)$ 分布的随机变量 $X$ 的均值和方差由下式给出：\n$$\n\\mathbb{E}[X] = \\frac{a}{a+b}\n$$\n$$\n\\text{Var}(X) = \\frac{ab}{(a+b)^2(a+b+1)}\n$$\n在我们的情况中，$U_n \\sim \\mathrm{Beta}(\\alpha, \\alpha)$，所以 $a=b=\\alpha$。$U_n$ 的均值是：\n$$\n\\mathbb{E}[U_n] = \\frac{\\alpha}{\\alpha + \\alpha} = \\frac{\\alpha}{2\\alpha} = \\frac{1}{2}\n$$\n$U_n$ 的方差是：\n$$\n\\text{Var}(U_n) = \\frac{\\alpha \\cdot \\alpha}{(\\alpha + \\alpha)^2(\\alpha + \\alpha + 1)} = \\frac{\\alpha^2}{(2\\alpha)^2(2\\alpha + 1)} = \\frac{\\alpha^2}{4\\alpha^2(2\\alpha + 1)} = \\frac{1}{4(2\\alpha + 1)}\n$$\n利用这些性质，我们可以求出 $\\epsilon_n$ 的均值和方差。通过应用期望的线性性质求得均值：\n$$\n\\mathbb{E}[\\epsilon_n] = \\mathbb{E}[B (2 U_n - 1)] = B (2 \\mathbb{E}[U_n] - 1) = B \\left(2 \\cdot \\frac{1}{2} - 1\\right) = B(1-1) = 0\n$$\n利用性质 $\\text{Var}(kX+c) = k^2\\text{Var}(X)$ 求得方差：\n$$\n\\text{Var}(\\epsilon_n) = \\text{Var}(B (2 U_n - 1)) = \\text{Var}(2BU_n - B) = (2B)^2 \\text{Var}(U_n) = 4B^2 \\left(\\frac{1}{4(2\\alpha + 1)}\\right) = \\frac{B^2}{2\\alpha + 1}\n$$\n为方便起见，我们将噪声项的方差表示为 $\\sigma_\\epsilon^2 = \\text{Var}(\\epsilon_n) = \\frac{B^2}{2\\alpha + 1}$。由于 $\\epsilon_n$ 是独立同分布的，任意两个不同噪声项之间的协方差为零，即当 $n \\neq m$ 时，$\\text{Cov}(\\epsilon_n, \\epsilon_m) = 0$。\n\n接下来，我们分析事件间期序列 $\\Delta t_n$。\n事件间期定义为 $\\Delta t_n = t_{n+1} - t_n$。代入 $t_n$ 的模型：\n$$\n\\Delta t_n = ((n+1)T + \\epsilon_{n+1}) - (nT + \\epsilon_n) = (n+1-n)T + \\epsilon_{n+1} - \\epsilon_n = T + \\epsilon_{n+1} - \\epsilon_n\n$$\n事件间期的均值是：\n$$\n\\mathbb{E}[\\Delta t_n] = \\mathbb{E}[T + \\epsilon_{n+1} - \\epsilon_n] = T + \\mathbb{E}[\\epsilon_{n+1}] - \\mathbb{E}[\\epsilon_n] = T + 0 - 0 = T\n$$\n事件间期的方差计算如下。由于 $T$ 是一个常数，它对方差没有贡献。项 $\\epsilon_{n+1}$ 和 $\\epsilon_n$ 是独立的。\n$$\n\\text{Var}(\\Delta t_n) = \\text{Var}(T + \\epsilon_{n+1} - \\epsilon_n) = \\text{Var}(\\epsilon_{n+1} - \\epsilon_n)\n$$\n对于独立的随机变量 $X$ 和 $Y$，$\\text{Var}(X-Y) = \\text{Var}(X) + \\text{Var}(Y)$。因此：\n$$\n\\text{Var}(\\Delta t_n) = \\text{Var}(\\epsilon_{n+1}) + \\text{Var}(\\epsilon_n) = \\sigma_\\epsilon^2 + \\sigma_\\epsilon^2 = 2\\sigma_\\epsilon^2 = \\frac{2B^2}{2\\alpha + 1}\n$$\n现在我们可以推导所要求的四个指标。\n\n1. 事件间期的标准差，$\\sigma_{\\Delta t}$。\n标准差是方差的平方根。\n$$\n\\sigma_{\\Delta t} = \\sqrt{\\text{Var}(\\Delta t_n)} = \\sqrt{\\frac{2B^2}{2\\alpha + 1}} = B \\sqrt{\\frac{2}{2\\alpha + 1}}\n$$\n\n2. $\\Delta t_n$ 的变异系数（CV）。\nCV定义为标准差与均值的比率。\n$$\nCV_{\\Delta t} = \\frac{\\sigma_{\\Delta t}}{\\mathbb{E}[\\Delta t_n]} = \\frac{B \\sqrt{\\frac{2}{2\\alpha + 1}}}{T} = \\frac{B}{T} \\sqrt{\\frac{2}{2\\alpha + 1}}\n$$\n\n3. $\\Delta t_n$ 的滞后一阶Allan方差，$\\sigma_A^2$。\nAllan方差定义为 $\\sigma_A^2 = \\frac{1}{2} \\mathbb{E}\\left[\\left(\\Delta t_{n+1} - \\Delta t_n\\right)^2\\right]$。我们首先分析期望内的项，$\\Delta t_{n+1} - \\Delta t_n$。\n$$\n\\Delta t_{n+1} - \\Delta t_n = (T + \\epsilon_{n+2} - \\epsilon_{n+1}) - (T + \\epsilon_{n+1} - \\epsilon_n) = \\epsilon_{n+2} - 2\\epsilon_{n+1} + \\epsilon_n\n$$\n该项的均值为零：\n$$\n\\mathbb{E}[\\epsilon_{n+2} - 2\\epsilon_{n+1} + \\epsilon_n] = \\mathbb{E}[\\epsilon_{n+2}] - 2\\mathbb{E}[\\epsilon_{n+1}] + \\mathbb{E}[\\epsilon_n] = 0 - 2(0) + 0 = 0\n$$\n对于任何均值 $\\mathbb{E}[X]=0$ 的随机变量 $X$，我们有 $\\mathbb{E}[X^2] = \\text{Var}(X)$。因此：\n$$\n\\mathbb{E}\\left[\\left(\\Delta t_{n+1} - \\Delta t_n\\right)^2\\right] = \\text{Var}(\\epsilon_{n+2} - 2\\epsilon_{n+1} + \\epsilon_n)\n$$\n由于 $\\epsilon_n$、$\\epsilon_{n+1}$ 和 $\\epsilon_{n+2}$ 是独立的，它们线性组合的方差是各项方差之和。\n$$\n\\text{Var}(\\epsilon_{n+2} - 2\\epsilon_{n+1} + \\epsilon_n) = \\text{Var}(\\epsilon_{n+2}) + \\text{Var}(-2\\epsilon_{n+1}) + \\text{Var}(\\epsilon_n)\n$$\n$$\n= \\text{Var}(\\epsilon_{n+2}) + (-2)^2\\text{Var}(\\epsilon_{n+1}) + \\text{Var}(\\epsilon_n) = \\sigma_\\epsilon^2 + 4\\sigma_\\epsilon^2 + \\sigma_\\epsilon^2 = 6\\sigma_\\epsilon^2\n$$\n代入 $\\sigma_\\epsilon^2$ 的表达式：\n$$\n\\mathbb{E}\\left[\\left(\\Delta t_{n+1} - \\Delta t_n\\right)^2\\right] = \\frac{6B^2}{2\\alpha + 1}\n$$\n最后，我们得到Allan方差：\n$$\n\\sigma_A^2 = \\frac{1}{2} \\mathbb{E}\\left[\\left(\\Delta t_{n+1} - \\Delta t_n\\right)^2\\right] = \\frac{1}{2} \\left(\\frac{6B^2}{2\\alpha + 1}\\right) = \\frac{3B^2}{2\\alpha + 1}\n$$\n\n4. 步频序列方差的小噪声近似，$\\text{Var}(c_n)$。\n步频为 $c_n = 1/\\Delta t_n$。我们需要一个对 $\\text{Var}(c_n)$ 在小噪声下有效的近似。这可以通过将函数 $g(x) = 1/x$ 在其参数的均值 $\\mu = \\mathbb{E}[\\Delta t_n] = T$ 附近进行一阶泰勒级数展开来推导。这也称为Delta方法。该近似表明，对于均值为 $\\mu$、方差为 $\\sigma^2$ 的随机变量 $X$：\n$$\n\\text{Var}(g(X)) \\approx (g'(\\mu))^2 \\sigma^2\n$$\n在这里，我们的随机变量是 $X = \\Delta t_n$，其均值为 $\\mu = T$，其方差为 $\\sigma^2 = \\text{Var}(\\Delta t_n) = \\frac{2B^2}{2\\alpha + 1}$。函数是 $g(x) = 1/x$，其导数是 $g'(x) = -1/x^2$。\n在均值 $T$ 处计算导数：\n$$\ng'(T) = -\\frac{1}{T^2}\n$$\n应用近似公式：\n$$\n\\text{Var}(c_n) = \\text{Var}(g(\\Delta t_n)) \\approx (g'(T))^2 \\text{Var}(\\Delta t_n) = \\left(-\\frac{1}{T^2}\\right)^2 \\left(\\frac{2B^2}{2\\alpha + 1}\\right)\n$$\n$$\n\\text{Var}(c_n) \\approx \\frac{1}{T^4} \\left(\\frac{2B^2}{2\\alpha + 1}\\right) = \\frac{2B^2}{T^4(2\\alpha + 1)}\n$$\n该近似在“小噪声”条件下有效，这意味着 $\\Delta t_n$ 在其均值 $T$ 周围的波动很小。在数学上，这要求 $\\Delta t_n$ 的标准差远小于其均值，即 $\\sigma_{\\Delta t} \\ll T$，或者等价地，$\\text{Var}(\\Delta t_n) \\ll T^2$。\n\n推导公式总结：\n- $\\sigma_{\\Delta t} = B \\sqrt{\\frac{2}{2\\alpha + 1}}$\n- $CV_{\\Delta t} = \\frac{B}{T} \\sqrt{\\frac{2}{2\\alpha + 1}}$\n- $\\sigma_A^2 = \\frac{3B^2}{2\\alpha + 1}$\n- $\\text{Var}(c_n) \\approx \\frac{2B^2}{T^4(2\\alpha + 1)}$\n这些公式将用于计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed.\n\ndef solve():\n    \"\"\"\n    Computes spatiotemporal gait variability metrics for a set of test cases\n    based on derived closed-form expressions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T, B, alpha).\n    test_cases = [\n        # Case 1 (general happy path)\n        (1.0, 0.02, 1.0),\n        # Case 2 (boundary condition with no noise)\n        (0.8, 0.0, 2.0),\n        # Case 3 (edge case with more mass near bounds)\n        (0.6, 0.03, 0.5),\n        # Case 4 (edge case with highly peaked bounded noise)\n        (1.2, 0.05, 10.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, B, alpha = case\n\n        # The term (2*alpha + 1) appears in the denominator of all variance-related metrics.\n        # It stems from the variance of the underlying Beta distribution.\n        # Since alpha > 0, the denominator is always positive.\n        denominator = 2.0 * alpha + 1.0\n\n        # Term that commonly appears in the numerators\n        B_squared = B**2\n\n        # 1. Standard deviation of the inter-event interval (seconds)\n        # Formula: std(Δt) = B * sqrt(2 / (2*alpha + 1))\n        # Handle B=0 case to avoid unnecessary computation, though formula works fine.\n        if B == 0.0:\n            std_dt = 0.0\n        else:\n            std_dt = B * np.sqrt(2.0 / denominator)\n\n        # 2. Coefficient of Variation of Δt (unitless)\n        # Formula: CV(Δt) = std(Δt) / T\n        # Handle T=0 case for robustness, though T > 0 in all valid physical scenarios.\n        if T == 0.0:\n            # Undefined, but for this problem T represents stride time and is > 0.\n            # Using np.inf or np.nan could be options, but problem constraints ensure T > 0.\n            cv_dt = np.nan if B > 0.0 else 0.0\n        else:\n            cv_dt = std_dt / T\n\n        # 3. Lag-one Allan variance of Δt (s^2)\n        # Formula: AllanVar(Δt) = 3 * B^2 / (2*alpha + 1)\n        allan_var = (3.0 * B_squared) / denominator\n\n        # 4. Small-noise approximation for the variance of cadence (s^-1)^2\n        # Formula: Var(c) ≈ 2 * B^2 / (T^4 * (2*alpha + 1))\n        if T == 0.0:\n            var_c = np.nan if B > 0.0 else 0.0\n        else:\n            var_c = (2.0 * B_squared) / ((T**4) * denominator)\n\n        # Append the four computed metrics for the current case.\n        results.append([std_dt, cv_dt, allan_var, var_c])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists,\n    # with no spaces within each sublist. e.g., [[a1,b1,c1],[a2,b2,c2]]\n    case_strings = []\n    for sublist in results:\n        # Convert each float in the sublist to a string\n        sublist_str = [str(val) for val in sublist]\n        # Join them with commas and enclose in brackets\n        case_strings.append(f\"[{','.join(sublist_str)}]\")\n    \n    # Join all case strings with commas and enclose in brackets\n    final_output_str = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}