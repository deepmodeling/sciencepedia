{
    "hands_on_practices": [
        {
            "introduction": "要理解运动的能量学，我们必须首先量化关节处的能量传递速率。本练习将功率这一抽象概念与关节力矩和角速度的具体力学联系起来，通过从第一性原理出发推导旋转功率的表达式 。这奠定了至关重要的联系：能量流动的方向（正功率或负功率）与肌肉活动类型（向心或离心收缩）直接相关，是后续更复杂分析的基础。",
            "id": "4187216",
            "problem": "一名受试者围绕固定的膝关节轴进行等速膝关节伸展运动。由伸肌产生的膝关节净内力矩在时间上是恒定的，其大小为 $M=50\\ \\text{N}\\cdot\\text{m}$。膝关节以恒定的角速度旋转，其大小为 $\\omega=2\\ \\text{rad/s}$。采用膝关节伸展为正的符号约定，因此净伸肌力矩 $M>0$，伸展角速度 $\\omega>0$。\n\n仅从机械功 $W$ 是力沿位移的线积分和瞬时功率 $P$ 是做功的时间变化率 $P=\\mathrm{d}W/\\mathrm{d}t$ 这两个基本定义出发，推导用净关节力矩 $M$ 和关节角速度 $\\omega$ 表示的在膝关节处传递的瞬时机械功率的表达式。然后，使用给定的数值计算该功率，并根据所述的符号约定，解释向心性和离心性膝关节伸肌活动时功率的符号。\n\n以瓦特为单位表示最终的功率数值。无需四舍五入。向心性与离心性活动时功率的符号应在你的推导和解释中得到证明，但你的最终答案必须只是与给定数据相对应的单个数值。",
            "solution": "该问题是有效的，因为它科学地基于旋转力学原理，问题提出得很好，数据充分且一致，陈述客观。我们可以开始求解。\n\n该问题要求从平移背景下功和功率的基本定义出发，推导旋转系统中瞬时机械功率的表达式。\n\n首先，我们从力 $\\vec{F}$ 在无穷小位移 $\\mathrm{d}\\vec{s}$ 上所做的微分机械功 $\\mathrm{d}W$ 的定义开始：\n$$\n\\mathrm{d}W = \\vec{F} \\cdot \\mathrm{d}\\vec{s}\n$$\n瞬时功率 $P$ 定义为做功的时间变化率：\n$$\nP = \\frac{\\mathrm{d}W}{\\mathrm{d}t}\n$$\n将 $\\mathrm{d}W$ 的表达式代入 $P$ 的定义，我们得到：\n$$\nP = \\frac{\\vec{F} \\cdot \\mathrm{d}\\vec{s}}{\\mathrm{d}t} = \\vec{F} \\cdot \\frac{\\mathrm{d}\\vec{s}}{\\mathrm{d}t}\n$$\n认识到位移的时间导数是瞬时速度 $\\vec{v} = \\mathrm{d}\\vec{s}/\\mathrm{d}t$，用线性运动变量表示的功率表达式为：\n$$\nP = \\vec{F} \\cdot \\vec{v}\n$$\n下一步是为绕固定轴进行纯旋转的系统（如膝关节所述）重新表述此表达式。设 $\\vec{r}$ 是从旋转轴上一点到力 $\\vec{F}$ 作用点的位矢。对于通过无穷小角度 $\\mathrm{d}\\vec{\\theta}$ 的纯旋转，相应的无穷小线性位移 $\\mathrm{d}\\vec{s}$ 由叉积给出：\n$$\n\\mathrm{d}\\vec{s} = \\mathrm{d}\\vec{\\theta} \\times \\vec{r}\n$$\n将此代入微分功的表达式中：\n$$\n\\mathrm{d}W = \\vec{F} \\cdot (\\mathrm{d}\\vec{\\theta} \\times \\vec{r})\n$$\n我们可以应用标量三重积恒等式 $\\vec{A} \\cdot (\\vec{B} \\times \\vec{C}) = (\\vec{A} \\times \\vec{B}) \\cdot \\vec{C}$。然而，在此背景下，一个更有用的置换是 $\\vec{A} \\cdot (\\vec{B} \\times \\vec{C}) = \\vec{B} \\cdot (\\vec{C} \\times \\vec{A})$。令 $\\vec{A} = \\vec{F}$，$\\vec{B} = \\mathrm{d}\\vec{\\theta}$，$\\vec{C} = \\vec{r}$。应用此恒等式可得：\n$$\n\\mathrm{d}W = \\mathrm{d}\\vec{\\theta} \\cdot (\\vec{r} \\times \\vec{F})\n$$\n项 $\\vec{r} \\times \\vec{F}$ 是力 $\\vec{F}$ 绕旋转轴产生的力矩（或扭矩）$\\vec{M}$ 的定义。\n$$\n\\vec{M} = \\vec{r} \\times \\vec{F}\n$$\n因此，旋转过程中所做的微分功为：\n$$\n\\mathrm{d}W = \\vec{M} \\cdot \\mathrm{d}\\vec{\\theta}\n$$\n现在，我们可以通过求时间导数来找到瞬时旋转功率：\n$$\nP = \\frac{\\mathrm{d}W}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} (\\vec{M} \\cdot \\mathrm{d}\\vec{\\theta})\n$$\n由于在此问题中力矩 $\\vec{M}$ 是恒定的，我们可以写成：\n$$\nP = \\vec{M} \\cdot \\frac{\\mathrm{d}\\vec{\\theta}}{\\mathrm{d}t}\n$$\n角位移的时间变化率是角速度 $\\vec{\\omega} = \\mathrm{d}\\vec{\\theta}/\\mathrm{d}t$。这给出了旋转系统中瞬时机械功率的最终推导表达式：\n$$\nP = \\vec{M} \\cdot \\vec{\\omega}\n$$\n对于绕单一固定轴旋转的特定情况，矢量 $\\vec{M}$ 和 $\\vec{\\omega}$ 是共线的。它们的点积简化为其标量大小 $M$ 和 $\\omega$ 的代数乘积：\n$$\nP = M \\omega\n$$\n问题指定了一个符号约定，其中膝关节伸展为正。我们已知：\n- 净伸肌力矩，根据约定为正：$M = +50\\ \\text{N}\\cdot\\text{m}$。\n- 膝关节伸展角速度，根据约定也为正：$\\omega = +2\\ \\text{rad/s}$。\n\n我们现在可以计算功率：\n$$\nP = (50\\ \\text{N}\\cdot\\text{m}) \\times (2\\ \\text{rad/s}) = 100\\ \\text{N}\\cdot\\text{m/s}\n$$\n单位 $\\text{N}\\cdot\\text{m/s}$ 等同于焦耳每秒 ($\\text{J/s}$)，定义为瓦特 ($\\text{W}$)。\n$$\nP = 100\\ \\text{W}\n$$\n功率的符号很重要，它表示能量传递的方向。\n- **向心活动**：当产生力矩的肌群引起的旋转方向与其产生的力矩方向相同时，就会发生这种情况。肌肉实际上“战胜”了负荷并缩短。在这种情况下，$M$ 和 $\\omega$ 的符号相同（$M>0$ 且 $\\omega>0$，或 $M<0$ 且 $\\omega<0$）。由此产生的功率 $P = M \\omega$ 为正（$P>0$）。正功率表示肌肉骨骼系统正在对环境做功（即产生机械能）。给定的问题中，伸肌力矩（$M>0$）和伸展角速度（$\\omega>0$）描述了膝伸肌的向心收缩。\n\n- **离心活动**：当产生力矩的肌群作用以对抗由外部负荷引起的旋转时，就会发生这种情况。肌肉实际上“不敌”负荷并在张力下伸长，起到制动作用。在这种情况下，$M$ 和 $\\omega$ 的符号相反（$M>0$ 且 $\\omega<0$，或 $M<0$ 且 $\\omega>0$）。由此产生的功率 $P = M \\omega$ 为负（$P<0$）。负功率表示环境正在对肌肉骨骼系统做功，而肌肉骨骼系统吸收了这种机械能。一个例子是膝伸肌在放下一个重物时产生伸肌力矩（$M>0$）以控制膝关节屈曲的速率（$\\omega<0$）。\n\n问题中描述的情景是向心性膝关节伸展，其计算出的功率必须为正，这与我们得到的结果 $100\\ \\text{W}$ 一致。",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "本章的最终实践旨在连接机械能学与生物能学，探讨身体为运动付出的最终生物学代价。通过分析模拟的实验数据，您将确定最节省代谢能量的行走速度——即最小化单位距离的能量消耗（运输成本，COT）的速度 。这项练习不仅展示了能量学原理在优化人类表现和理解运动偏好方面的实际应用，也引入了在生物力学研究中至关重要的数据驱动分析方法。",
            "id": "4187152",
            "problem": "一个体重为 $m = 70\\ \\text{kg}$ 的受试者在水平地面上以速度 $v$ 行走。设总代谢功率为 $P_{\\mathrm{gross}}(v)$，定义为行走过程中测得的总代谢功率，包括静息部分。运输成本（Cost of Transport, COT）在此定义为单位体重每单位距离的总代谢能量，由下式给出\n$$\n\\mathrm{COT}(v) = \\frac{P_{\\mathrm{gross}}(v)}{m\\,v},\n$$\n当 $P_{\\mathrm{gross}}(v)$ 的单位为 $\\text{W}$，$v$ 的单位为 $\\text{m}/\\text{s}$ 时，$\\mathrm{COT}(v)$ 的单位为 $\\text{J}/\\text{kg}/\\text{m}$。假设在水平地面上稳定行走，且速度域严格大于零。\n\n您的任务是，对于一组给定的离散测量值 $(v_i, P_{\\mathrm{gross},i})$，在 $v \\in [\\min_i v_i,\\ \\max_i v_i]$ 上对 $P_{\\mathrm{gross}}(v)$ 进行连续可微插值，计算出在 $\\{v_i\\}$ 的凸包内使 $\\mathrm{COT}(v)$ 最小化的速度 $v^\\star$。然后，您必须将 $v^\\star$ 与给定的偏好行走速度 $v_{\\mathrm{pref}}$进行比较，报告绝对差 $\\Delta v = |v^\\star - v_{\\mathrm{pref}}|$ 以及该差值是否在容差 $\\delta = 0.1\\ \\text{m}/\\text{s}$ 之内。\n\n需使用的基本原理：\n- 运动学速度定义：$v = \\frac{dx}{dt}$。\n- 功率定义：$P = \\frac{dE}{dt}$。\n- 总运输成本定义：$\\mathrm{COT}(v) = \\frac{P_{\\mathrm{gross}}(v)}{m\\,v}$。\n- 在测量的速度域内对连续可微插值函数进行优化。\n\n数值和算法要求：\n- 在测量的 $v$ 域上构建一个二次连续可微的插值函数 $P_{\\mathrm{gross}}(v)$（使用自然三次样条），并在闭区间 $[\\min_i v_i,\\ \\max_i v_i]$ 上最小化 $\\mathrm{COT}(v)$。\n- 如果无约束最小化器位于区间之外，则有约束最小化器将位于边界上。您的数值方法必须返回有约束最小化器。\n- 将 $v^\\star$ 以 $\\text{m}/\\text{s}$ 表示，$\\mathrm{COT}(v^\\star)$ 以 $\\text{J}/\\text{kg}/\\text{m}$ 表示，$\\Delta v$ 以 $\\text{m}/\\text{s}$ 表示。\n- 将所有报告的浮点值四舍五入到三位小数。\n\n测试套件（所有功率单位为 $\\text{W}$，速度单位为 $\\text{m}/\\text{s}$）：\n- 情况 A（内部最优点，典型行走）：\n  - $v$ 值：$\\{0.8,\\ 1.0,\\ 1.2,\\ 1.4,\\ 1.6,\\ 1.8\\}$\n  - $P_{\\mathrm{gross}}(v)$ 值：由 $P_{\\mathrm{gross}}(v) = 90 + 80\\,v + 50\\,v^2$ 计算得出：\n    - $\\{186.0,\\ 220.0,\\ 258.0,\\ 300.0,\\ 346.0,\\ 396.0\\}$\n  - $v_{\\mathrm{pref}} = 1.30$\n- 情况 B（最优点超出测量范围；边界约束）：\n  - $v$ 值：$\\{0.5,\\ 0.7,\\ 0.9,\\ 1.1,\\ 1.3,\\ 1.5,\\ 1.8\\}$\n  - $P_{\\mathrm{gross}}(v)$ 值：由 $P_{\\mathrm{gross}}(v) = 120 + 70\\,v + 30\\,v^2$ 计算得出：\n    - $\\{162.5,\\ 183.7,\\ 207.3,\\ 233.3,\\ 261.7,\\ 293.0,\\ 343.2\\}$\n  - $v_{\\mathrm{pref}} = 1.60$\n- 情况 C（内部最优点接近低速）：\n  - $v$ 值：$\\{0.6,\\ 0.7,\\ 0.8,\\ 0.9,\\ 1.1,\\ 1.3,\\ 1.6,\\ 1.9\\}$\n  - $P_{\\mathrm{gross}}(v)$ 值：由 $P_{\\mathrm{gross}}(v) = 90 + 30\\,v + 120\\,v^2$ 计算得出：\n    - $\\{151.2,\\ 169.8,\\ 190.8,\\ 214.2,\\ 268.2,\\ 331.8,\\ 445.2,\\ 580.2\\}$\n  - $v_{\\mathrm{pref}} = 0.80$\n\n要求的最终输出：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$$\n[\\ v^\\star_{\\mathrm{A}},\\ \\mathrm{COT}^\\star_{\\mathrm{A}},\\ \\Delta v_{\\mathrm{A}},\\ \\text{is\\_close}_{\\mathrm{A}},\\ v^\\star_{\\mathrm{B}},\\ \\mathrm{COT}^\\star_{\\mathrm{B}},\\ \\Delta v_{\\mathrm{B}},\\ \\text{is\\_close}_{\\mathrm{B}},\\ v^\\star_{\\mathrm{C}},\\ \\mathrm{COT}^\\star_{\\mathrm{C}},\\ \\Delta v_{\\mathrm{C}},\\ \\text{is\\_close}_{\\mathrm{C}}\\ ]\n$$\n其中每个 $v^\\star$、$\\mathrm{COT}^\\star$ 和 $\\Delta v$ 都四舍五入到三位小数，每个 $\\text{is\\_close}$ 是一个布尔值，指示 $\\Delta v \\le \\delta$ 是否成立。",
            "solution": "该问题被评估为有效，因为它科学地基于生物力学原理，问题定义明确，目标客观，并包含一套完整且一致的数据和约束，可用于得出有意义的解。\n\n目标是确定能使体重为 $m = 70\\ \\text{kg}$ 的受试者的总运输成本（COT）最小化的行走速度 $v^\\star$。COT 定义为单位体重每单位行进距离所消耗的总代谢能量：\n$$\n\\mathrm{COT}(v) = \\frac{P_{\\mathrm{gross}}(v)}{m\\,v}\n$$\n其中 $P_{\\mathrm{gross}}(v)$ 是速度为 $v$ 时的总代谢功率。最小化将在一个闭区间 $[v_{\\min}, v_{\\max}]$ 上进行，该区间由给定离散测量值中的最小和最大速度定义。\n\n为了找到函数 $\\mathrm{COT}(v)$ 的最小值，我们通过对其求关于 $v$ 的导数并令其为零来分析其临界点。假设 $P_{\\mathrm{gross}}(v)$ 是关于 $v$ 的可微函数，并且由于 $m$ 是常数且我们关心的是 $v > 0$ 的情况，我们可以最小化简化函数 $f(v) = \\frac{P_{\\mathrm{gross}}(v)}{v}$。使用除法定则求导：\n$$\n\\frac{d}{dv} \\left( \\frac{P_{\\mathrm{gross}}(v)}{v} \\right) = \\frac{v \\cdot \\frac{d P_{\\mathrm{gross}}(v)}{dv} - P_{\\mathrm{gross}}(v) \\cdot 1}{v^2} = 0\n$$\n为使该表达式在 $v > 0$ 时为零，分子必须为零：\n$$\nv \\cdot P'_{\\mathrm{gross}}(v) - P_{\\mathrm{gross}}(v) = 0\n$$\n其中 $P'_{\\mathrm{gross}}(v)$ 是 $P_{\\mathrm{gross}}(v)$ 关于 $v$ 的导数。这导出了最佳速度 $v^\\star$ 的基本条件：\n$$\nP'_{\\mathrm{gross}}(v^{\\star}) = \\frac{P_{\\mathrm{gross}}(v^{\\star})}{v^{\\star}}\n$$\n从几何上看，这个条件意味着 $P_{\\mathrm{gross}}(v)$ 曲线在最佳速度 $v^\\star$ 处的切线必须穿过原点 $(0, 0)$。\n\n问题提供了离散数据点 $(v_i, P_{\\mathrm{gross},i})$。为了应用微积分，我们必须首先构建一个穿过这些点的连续可微函数 $P_{\\mathrm{gross}}(v)$。问题指定使用自然三次样条插值。三次样条是由三次多项式组成的分段函数，它是二次连续可微的（$C^2$）。这一选择确保了功率曲线的平滑表示，适合进行微分和优化。设此样条函数为 $S(v)$。\n\n因此，优化任务是在约束区间 $[v_{\\min}, v_{\\max}]$ 内找到使 $\\mathrm{COT}(v) = \\frac{S(v)}{mv}$ 最小化的值 $v^{\\star}$，其中 $v_{\\min} = \\min_i v_i$ 且 $v_{\\max} = \\max_i v_i$。根据极值定理，一个在闭有界区间上的连续函数保证能达到最小值。该最小值将出现在导数为零的内部点，或在边界点 $v_{\\min}$ 或 $v_{\\max}$ 之一处。\n\n解决每个测试用例的算法步骤如下：\n1.  对于一组给定的速度测量值 $\\{v_i\\}$ 和一个生成相应功率值 $\\{P_{\\mathrm{gross},i}\\}$ 的函数，建立离散数据点 $(v_i, P_{\\mathrm{gross},i})$。\n2.  使用 `scipy.interpolate.CubicSpline` 构建自然三次样条 $S(v)$ 来插值这些数据点。此函数作为我们的 $P_{\\mathrm{gross}}(v)$ 模型。\n3.  定义目标函数 $\\mathrm{COT}(v) = \\frac{S(v)}{mv}$。对于此问题，$m = 70 \\text{ kg}$。\n4.  使用数值优化程序 `scipy.optimize.minimize_scalar` 及其 `bounded` 方法，在区间 $[v_{\\min}, v_{\\max}]$ 上找到最小化 $\\mathrm{COT}(v)$ 的速度 $v^\\star$。无论最小值位于区间内部还是边界，此方法都能正确识别。\n5.  一旦找到 $v^\\star$，计算最小运输成本为 $\\mathrm{COT}^\\star = \\mathrm{COT}(v^\\star)$。\n6.  计算最佳速度与偏好速度之间的绝对差 $\\Delta v = |v^\\star - v_{\\mathrm{pref}}|$。\n7.  将此差值与给定的容差 $\\delta = 0.1\\ \\text{m}/\\text{s}$ 进行比较，以确定布尔值 `is_close`（$\\Delta v \\le \\delta$）。\n8.  按要求将所有得到的浮点值（$v^\\star$、$\\mathrm{COT}^\\star$、$\\Delta v$）四舍五入到三位小数。\n9.  将所有测试用例的结果汇总到一个列表中，并格式化以供输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import CubicSpline\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Validates and solves the biomechanics problem of finding the optimal walking speed.\n    \"\"\"\n    \n    # Define problem constants\n    m = 70.0  # kg, body mass\n    delta = 0.1 # m/s, tolerance for speed comparison\n\n    # Define the power generation functions for each test case\n    def get_P_A(v):\n        return 90.0 + 80.0 * v + 50.0 * v**2\n\n    def get_P_B(v):\n        return 120.0 + 70.0 * v + 30.0 * v**2\n\n    def get_P_C(v):\n        return 90.0 + 30.0 * v + 120.0 * v**2\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary containing the speed data, the function to generate power,\n    # and the preferred walking speed.\n    test_cases = [\n        {\n            \"v_data\": np.array([0.8, 1.0, 1.2, 1.4, 1.6, 1.8]),\n            \"p_func\": get_P_A,\n            \"v_pref\": 1.30,\n        },\n        {\n            \"v_data\": np.array([0.5, 0.7, 0.9, 1.1, 1.3, 1.5, 1.8]),\n            \"p_func\": get_P_B,\n            \"v_pref\": 1.60,\n        },\n        {\n            \"v_data\": np.array([0.6, 0.7, 0.8, 0.9, 1.1, 1.3, 1.6, 1.9]),\n            \"p_func\": get_P_C,\n            \"v_pref\": 0.80,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        v_i = case[\"v_data\"]\n        p_func = case[\"p_func\"]\n        v_pref = case[\"v_pref\"]\n\n        # 1. Generate the discrete power data from the given formula\n        p_i = p_func(v_i)\n        \n        # 2. Define the optimization interval\n        v_min, v_max = v_i.min(), v_i.max()\n        \n        # 3. Construct the natural cubic spline for P_gross(v)\n        p_spline = CubicSpline(v_i, p_i, bc_type='natural')\n        \n        # 4. Define the objective function, COT(v)\n        cot_func = lambda v: p_spline(v) / (m * v)\n        \n        # 5. Find the speed v_star that minimizes COT(v) in the bounded interval\n        opt_result = minimize_scalar(\n            cot_func, \n            bounds=(v_min, v_max), \n            method='bounded'\n        )\n        \n        v_star = opt_result.x\n        cot_star = opt_result.fun\n        \n        # 6. Calculate the difference from preferred speed and check tolerance\n        delta_v = abs(v_star - v_pref)\n        is_close = delta_v = delta\n        \n        # 7. Append rounded results to the list\n        results.extend([\n            round(v_star, 3),\n            round(cot_star, 3),\n            round(delta_v, 3),\n            is_close\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}