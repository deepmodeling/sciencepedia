{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze the complex energy flows in whole-body movement, we must master the fundamental principles at the level of a single joint. This exercise takes you back to first principles, asking you to derive the expression for rotational mechanical power from the linear definition of work. By performing this derivation and applying it to a knee extension task , you will solidify your understanding of how joint moments and velocities determine the rate of energy generation or absorption, and the critical distinction between concentric ($P \\gt 0$) and eccentric ($P \\lt 0$) muscle actions.",
            "id": "4187216",
            "problem": "A subject performs an isokinetic knee extension about a fixed knee joint axis. The net internal knee moment generated by the extensor muscles is constant in time with magnitude $M=50\\ \\text{N}\\cdot\\text{m}$. The knee rotates at a constant angular velocity with magnitude $\\omega=2\\ \\text{rad/s}$. Adopt the sign convention that knee extension is positive, so that a net extensor moment is $M>0$ and extension angular velocity is $\\omega>0$. \n\nStarting only from fundamental definitions of mechanical work $W$ as the line integral of force over displacement and instantaneous power $P$ as the time rate of doing work $P=\\mathrm{d}W/\\mathrm{d}t$, derive the expression for the instantaneous mechanical power transferred at the knee in terms of the net joint moment $M$ and the joint angular velocity $\\omega$. Then evaluate this power for the given values, and explain the sign of the power for concentric versus eccentric knee extensor action under the stated sign convention. \n\nExpress the final numerical value of the power in watts. No rounding is required. The sign of the power for concentric versus eccentric action should be justified in your derivation and explanation, but your final answer must be only the single numerical value of the power corresponding to the given data.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of rotational mechanics, well-posed with sufficient and consistent data, and objectively stated. We may proceed with the solution.\n\nThe problem requires a derivation of the expression for instantaneous mechanical power in a rotational system starting from the fundamental definitions of work and power in a translational context.\n\nFirst, we begin with the definition of the differential mechanical work, $\\mathrm{d}W$, done by a force, $\\vec{F}$, over an infinitesimal displacement, $\\mathrm{d}\\vec{s}$:\n$$\n\\mathrm{d}W = \\vec{F} \\cdot \\mathrm{d}\\vec{s}\n$$\nInstantaneous power, $P$, is defined as the time rate of doing work:\n$$\nP = \\frac{\\mathrm{d}W}{\\mathrm{d}t}\n$$\nSubstituting the expression for $\\mathrm{d}W$ into the definition of $P$, we get:\n$$\nP = \\frac{\\vec{F} \\cdot \\mathrm{d}\\vec{s}}{\\mathrm{d}t} = \\vec{F} \\cdot \\frac{\\mathrm{d}\\vec{s}}{\\mathrm{d}t}\n$$\nRecognizing that the time derivative of displacement is the instantaneous velocity, $\\vec{v} = \\mathrm{d}\\vec{s}/\\mathrm{d}t$, the expression for power in terms of linear motion variables is:\n$$\nP = \\vec{F} \\cdot \\vec{v}\n$$\nThe next step is to reformulate this expression for a system undergoing pure rotation about a fixed axis, as described for the knee joint. Let $\\vec{r}$ be the position vector from a point on the axis of rotation to the point of application of the force $\\vec{F}$. For a pure rotation through an infinitesimal angle $\\mathrm{d}\\vec{\\theta}$, the corresponding infinitesimal linear displacement $\\mathrm{d}\\vec{s}$ is given by the cross product:\n$$\n\\mathrm{d}\\vec{s} = \\mathrm{d}\\vec{\\theta} \\times \\vec{r}\n$$\nSubstituting this into the expression for differential work:\n$$\n\\mathrm{d}W = \\vec{F} \\cdot (\\mathrm{d}\\vec{\\theta} \\times \\vec{r})\n$$\nWe can apply the scalar triple product identity $\\vec{A} \\cdot (\\vec{B} \\times \\vec{C}) = (\\vec{A} \\times \\vec{B}) \\cdot \\vec{C}$. However, a more useful permutation for this context is $\\vec{A} \\cdot (\\vec{B} \\times \\vec{C}) = \\vec{B} \\cdot (\\vec{C} \\times \\vec{A})$. Let $\\vec{A} = \\vec{F}$, $\\vec{B} = \\mathrm{d}\\vec{\\theta}$, and $\\vec{C} = \\vec{r}$. Applying this identity yields:\n$$\n\\mathrm{d}W = \\mathrm{d}\\vec{\\theta} \\cdot (\\vec{r} \\times \\vec{F})\n$$\nThe term $\\vec{r} \\times \\vec{F}$ is the definition of the moment (or torque), $\\vec{M}$, generated by the force $\\vec{F}$ about the axis of rotation.\n$$\n\\vec{M} = \\vec{r} \\times \\vec{F}\n$$\nTherefore, the differential work done during a rotation is:\n$$\n\\mathrm{d}W = \\vec{M} \\cdot \\mathrm{d}\\vec{\\theta}\n$$\nNow, we can find the instantaneous rotational power by taking the time derivative:\n$$\nP = \\frac{\\mathrm{d}W}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} (\\vec{M} \\cdot \\mathrm{d}\\vec{\\theta})\n$$\nSince the moment $\\vec{M}$ is constant in this problem, we can write:\n$$\nP = \\vec{M} \\cdot \\frac{\\mathrm{d}\\vec{\\theta}}{\\mathrm{d}t}\n$$\nThe time rate of change of angular displacement is the angular velocity, $\\vec{\\omega} = \\mathrm{d}\\vec{\\theta}/\\mathrm{d}t$. This gives the final derived expression for instantaneous mechanical power in a rotational system:\n$$\nP = \\vec{M} \\cdot \\vec{\\omega}\n$$\nFor the specific case of rotation about a single fixed axis, the vectors $\\vec{M}$ and $\\vec{\\omega}$ are collinear. Their dot product simplifies to the algebraic product of their scalar magnitudes, $M$ and $\\omega$:\n$$\nP = M \\omega\n$$\nThe problem specifies a sign convention where knee extension is positive. We are given:\n- A net extensor moment, which according to the convention is positive: $M = +50\\ \\text{N}\\cdot\\text{m}$.\n- A knee extension angular velocity, which according to the convention is also positive: $\\omega = +2\\ \\text{rad/s}$.\n\nWe can now evaluate the power:\n$$\nP = (50\\ \\text{N}\\cdot\\text{m}) \\times (2\\ \\text{rad/s}) = 100\\ \\text{N}\\cdot\\text{m/s}\n$$\nThe unit $\\text{N}\\cdot\\text{m/s}$ is equivalent to Joules per second ($\\text{J/s}$), which is defined as the Watt ($\\text{W}$).\n$$\nP = 100\\ \\text{W}\n$$\nThe sign of the power is significant, indicating the direction of energy transfer.\n- **Concentric action**: This occurs when the muscle group creating the moment causes a rotation in the same direction as the moment it generates. The muscle effectively \"wins\" against the load and shortens. In this case, the signs of $M$ and $\\omega$ are the same ($M>0$ and $\\omega>0$, or $M<0$ and $\\omega<0$). The resulting power, $P = M \\omega$, is positive ($P>0$). Positive power signifies that the musculoskeletal system is performing work on the environment (i.e., generating mechanical energy). The given problem, with an extensor moment ($M>0$) and an extension velocity ($\\omega>0$), describes a concentric contraction of the knee extensor muscles.\n\n- **Eccentric action**: This occurs when the muscle group creating the moment acts to oppose a rotation caused by an external load. The muscle effectively \"loses\" against the load and lengthens while under tension, acting as a brake. In this case, the signs of $M$ and $\\omega$ are opposite ($M>0$ and $\\omega<0$, or $M<0$ and $\\omega>0$). The resulting power, $P = M \\omega$, is negative ($P<0$). Negative power signifies that the environment is performing work on the musculoskeletal system, which absorbs this mechanical energy. An example would be the knee extensors producing an extensor moment ($M>0$) to control the rate of knee flexion ($\\omega<0$) while lowering a heavy object.\n\nThe scenario described in the problem is a concentric knee extension, for which the calculated power must be positive, consistent with our result of $100\\ \\text{W}$.",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "With the fundamentals of joint power established, we can now apply energetic principles to simplified models of whole-body locomotion to understand its primary costs. The inverted pendulum model of walking provides profound insights into why walking requires metabolic energy, even in the absence of changes in net mechanical energy. This practice challenges you to model the step-to-step transition as an inelastic collision and derive the mechanical work lost as the body's center of mass is redirected , a key mechanical cost that muscles must overcome to maintain a steady speed.",
            "id": "4187173",
            "problem": "A human walker’s whole-body Center of Mass (COM) is modeled as a point mass moving on a circular arc about the stance foot during single support, with massless legs and instantaneous transitions. At the step-to-step transition, the stance leg is replaced by the swing leg, and the COM velocity direction must instantaneously change from tangential to the old arc to tangential to the new arc. Assume the legs are symmetric about the vertical: just before the transition the old stance leg is at angle $-\\theta$ from vertical, and just after, the new stance leg is at $+\\theta$ from vertical. With these assumptions, the tangential directions before and after the transition differ by an angle $2\\theta$. The ground reaction at heel-strike imposes the new tangential direction without slip or rebound, and the impulsive constraint removes the component of COM velocity orthogonal to the new tangential direction. Use Newtonian mechanics and the definition of kinetic energy and work to:\n\n- Derive, from first principles, the collision work per unit mass (negative mechanical work per unit mass performed on the COM by the ground at the instant of heel-strike) as a function of speed $v$ and leg angle $\\theta$.\n- Compute its value for a walker with leg angle $\\theta=0.15\\ \\text{rad}$ and forward COM speed $v=1.4\\ \\text{m/s}$.\n- Under the assumption of steady walking speed in the absence of other losses or sources, estimate the minimum positive push-off work per unit mass that must be performed by the trailing leg just prior to heel-strike to exactly compensate the collision loss without altering step geometry.\n\nRound your final numerical answer to four significant figures and express it in $\\text{J/kg}$. Provide only a single numerical value corresponding to the minimum positive push-off work per unit mass needed to maintain steady speed at the specified $\\theta$ and $v$.",
            "solution": "The problem asks for the derivation of collision work per unit mass, and then for the calculation of the push-off work per unit mass required to maintain a steady walking speed under a specific biomechanical model.\n\nFirst, let's validate the problem.\nGivens:\n1.  Model: Walker's Center of Mass (COM) is a point mass, legs are massless.\n2.  Gait phase: Single support motion is on a circular arc about the stance foot.\n3.  Transition: Heel-strike transitions are instantaneous.\n4.  Geometry: Just before transition, the old stance leg is at angle $-\\theta$ from vertical. Just after, the new stance leg is at angle $+\\theta$.\n5.  Velocity change: The tangential direction of the COM velocity vector changes by an angle of $2\\theta$ at the transition.\n6.  Collision mechanics: The component of COM velocity orthogonal to the new tangential direction is removed by an impulsive ground reaction force. There is no slip or rebound.\n7.  Given values: leg angle $\\theta=0.15\\ \\text{rad}$, forward COM speed $v=1.4\\ \\text{m/s}$ just before collision.\n8.  Objective: Derive collision work per unit mass; compute the positive push-off work per unit mass needed to compensate for this loss.\n\nValidation:\nThe problem describes the \"inverted pendulum\" model of walking, a standard and scientifically grounded simplification in biomechanics. The concepts of impulsive collisions, work, and kinetic energy are from fundamental Newtonian mechanics. The problem is well-posed, with all necessary information provided to derive a unique solution. The language is objective and the parameters given are physically realistic for human locomotion. Therefore, the problem is deemed valid.\n\nPart 1: Derivation of Collision Work per Unit Mass\n\nLet $m$ be the mass of the walker's COM. Let $\\vec{v}^{-}$ be the velocity of the COM just before the heel-strike collision, and $\\vec{v}^{+}$ be the velocity just after the collision. The problem states that the speed just before the collision is $v$, so $|\\vec{v}^{-}| = v$.\n\nThe direction of $\\vec{v}^{-}$ is tangential to the circular arc defined by the trailing leg, which is at an angle $-\\theta$ to the vertical. The direction of $\\vec{v}^{+}$ is tangential to the arc of the new leading leg, which is at an angle $+\\theta$ to the vertical. The problem states that the angle between the vectors $\\vec{v}^{-}$ and $\\vec{v}^{+}$ is $2\\theta$.\n\nLet $\\hat{u}^{-}$ and $\\hat{u}^{+}$ be the unit vectors in the direction of $\\vec{v}^{-}$ and $\\vec{v}^{+}$, respectively. We have $\\vec{v}^{-} = v \\hat{u}^{-}$. The angle between $\\hat{u}^{-}$ and $\\hat{u}^{+}$ is $2\\theta$.\n\nThe problem states that the impulsive ground reaction force \"removes the component of COM velocity orthogonal to the new tangential direction.\" This is a key statement defining the collision. It means that the post-collision velocity $\\vec{v}^{+}$ is the vector projection of the pre-collision velocity $\\vec{v}^{-}$ onto the new direction of motion $\\hat{u}^{+}$.\n\nThe projection is given by:\n$$\n\\vec{v}^{+} = (\\vec{v}^{-} \\cdot \\hat{u}^{+}) \\hat{u}^{+}\n$$\nTo find the speed after the collision, $v^{+} = |\\vec{v}^{+}|$, we take the magnitude of this expression:\n$$\nv^{+} = |(\\vec{v}^{-} \\cdot \\hat{u}^{+}) \\hat{u}^{+}| = |\\vec{v}^{-} \\cdot \\hat{u}^{+}| |\\hat{u}^{+}|\n$$\nSince $\\hat{u}^{+}$ is a unit vector, $|\\hat{u}^{+}|=1$. Substituting $\\vec{v}^{-} = v \\hat{u}^{-}$:\n$$\nv^{+} = |v \\hat{u}^{-} \\cdot \\hat{u}^{+}| = v |\\hat{u}^{-} \\cdot \\hat{u}^{+}|\n$$\nThe dot product of two unit vectors is the cosine of the angle between them. The angle is $2\\theta$.\n$$\nv^{+} = v |\\cos(2\\theta)|\n$$\nFor typical walking, the half-angle of the legs $\\theta$ is acute, such that $2\\theta < \\frac{\\pi}{2}$, which means $\\cos(2\\theta)$ is positive. Thus, we can remove the absolute value:\n$$\nv^{+} = v \\cos(2\\theta)\n$$\nThe work done on the COM by the impulsive collision force, $W_{coll}$, is equal to the change in the COM's kinetic energy, according to the work-energy theorem.\n$$\nW_{coll} = \\Delta K = K_{final} - K_{initial} = \\frac{1}{2}m(v^{+})^2 - \\frac{1}{2}m(v^{-})^2\n$$\nSubstituting the expressions for the speeds:\n$$\nW_{coll} = \\frac{1}{2}m(v \\cos(2\\theta))^2 - \\frac{1}{2}m v^2 = \\frac{1}{2}m v^2 \\cos^2(2\\theta) - \\frac{1}{2}m v^2\n$$\nFactoring out $\\frac{1}{2}m v^2$:\n$$\nW_{coll} = \\frac{1}{2}m v^2 (\\cos^2(2\\theta) - 1)\n$$\nUsing the trigonometric identity $\\sin^2(x) + \\cos^2(x) = 1$, which implies $\\cos^2(x) - 1 = -\\sin^2(x)$:\n$$\nW_{coll} = -\\frac{1}{2}m v^2 \\sin^2(2\\theta)\n$$\nThe collision work per unit mass is therefore:\n$$\n\\frac{W_{coll}}{m} = -\\frac{1}{2} v^2 \\sin^2(2\\theta)\n$$\nThis work is negative, indicating a loss of mechanical energy from the system due to the inelastic collision with the ground.\n\nPart 2: Calculation of Push-off Work per Unit Mass\n\nThe problem asks for the minimum positive push-off work per unit mass, $W_{po}/m$, required to maintain a steady walking speed. \"Steady speed\" implies that the state of the walker is periodic. Specifically, the speed just before each collision, $v$, must be the same from step to step.\n\nIn each step, an amount of energy equal to $|W_{coll}|$ is lost due to the collision. To maintain a steady state, this energy must be replenished. The problem attributes this energy input to the \"push-off work... performed by the trailing leg just prior to heel-strike.\"\n\nFor the net energy change over one full step cycle to be zero, the work done by the push-off, $W_{po}$, must exactly counteract the work done by the collision, $W_{coll}$.\n$$\nW_{po} + W_{coll} = 0\n$$\n$$\nW_{po} = -W_{coll}\n$$\nSubstituting the derived expression for $W_{coll}$:\n$$\nW_{po} = - \\left(-\\frac{1}{2}m v^2 \\sin^2(2\\theta)\\right) = \\frac{1}{2}m v^2 \\sin^2(2\\theta)\n$$\nThe push-off work per unit mass is:\n$$\n\\frac{W_{po}}{m} = \\frac{1}{2} v^2 \\sin^2(2\\theta)\n$$\nWe are asked to compute this value for $v=1.4\\ \\text{m/s}$ and $\\theta=0.15\\ \\text{rad}$.\nThe angle for the sine function is $2\\theta = 2 \\times 0.15\\ \\text{rad} = 0.3\\ \\text{rad}$.\n$$\n\\frac{W_{po}}{m} = \\frac{1}{2} (1.4\\ \\text{m/s})^2 \\sin^2(0.3\\ \\text{rad})\n$$\n$$\n\\frac{W_{po}}{m} = \\frac{1}{2} (1.96\\ \\text{m}^2/\\text{s}^2) \\sin^2(0.3)\n$$\n$$\n\\frac{W_{po}}{m} = 0.98 \\times (\\sin(0.3))^2\\ \\text{J/kg}\n$$\nNow we compute the numerical value:\n$\\sin(0.3) \\approx 0.2955202$\n$(\\sin(0.3))^2 \\approx 0.08733218$\n$$\n\\frac{W_{po}}{m} \\approx 0.98 \\times 0.08733218 \\approx 0.08558554\\ \\text{J/kg}\n$$\nRounding to four significant figures as requested:\n$$\n\\frac{W_{po}}{m} \\approx 0.08559\\ \\text{J/kg}\n$$\nThis single numerical value corresponds to the minimum positive push-off work per unit mass needed to maintain a steady speed.",
            "answer": "$$\n\\boxed{0.08559}\n$$"
        },
        {
            "introduction": "Moving from theoretical models to data-driven analysis, this final practice simulates a common task in a modern biomechanics laboratory. Given synthetic but realistic joint power profiles from inverse dynamics, you will analyze the energetic contributions of the hip, knee, and ankle during the stance phase of gait . By numerically integrating these power curves, you will quantify the positive (generative) and negative (absorptive) work done by each joint, revealing their distinct functional roles during critical events like initial ground contact and terminal push-off.",
            "id": "4187203",
            "problem": "You are provided with time-series joint power profiles during the stance phase of a gait cycle for the hip, knee, and ankle joints derived from inverse dynamics. The stance interval is represented by uniform samples over a fixed duration. Your task is to compute the time-integrated positive and negative joint work for each joint over the entire stance and to identify which joint dominates the late stance push-off phase and the early stance collision phase. All results must be expressed in Joules (J) and follow the specified output format.\n\nFundamental base and definitions:\n- From Newton’s laws and rigid-body dynamics, the net joint power at a joint equals the product of the net joint moment and the joint angular velocity; denoting joint moment by $M(t)$ in newton-meters and angular velocity by $\\omega(t)$ in radians per second, the mechanical power is $P(t) = M(t)\\,\\omega(t)$ in watts.\n- Mechanical work over a time interval is the time integral of power: $W = \\int P(t)\\,dt$.\n- The positive and negative components of power are $P^{+}(t) = \\max(P(t), 0)$ and $P^{-}(t) = \\min(P(t), 0)$ respectively. The positive joint work is $W^{+} = \\int P^{+}(t)\\,dt$ and the negative joint work magnitude is $W^{-} = -\\int P^{-}(t)\\,dt$, both in joules.\n- Interpret the collision phase as the early stance fraction of the interval and the push-off phase as the late stance fraction of the interval. For this problem, define the collision window as the first $20\\%$ of stance (i.e., normalized time $n \\in [0, 0.2]$) and the push-off window as the last $20\\%$ of stance (i.e., normalized time $n \\in [0.8, 1.0]$). Angles (if applicable) are in radians.\n\nInput generation for the test suite:\nYou will not receive external input; instead, your program must internally generate three synthetic test cases that represent plausible inverse dynamics power profiles using the following parametric forms. For each case, define a stance duration $T$ in seconds, an integer number of samples $N$, a time array $t$ with $N$ uniform samples over $[0,T]$, and normalized time $n = t/T$. The joint power profiles are defined as the sum of an early-stance negative Gaussian “collision” lobe and a late-stance positive Gaussian “push-off” lobe:\n\nFor the hip:\n$$\nP_{\\mathrm{hip}}(t) = -A_h \\exp\\left(-\\frac{(n - \\mu_{h1})^2}{\\sigma_{h1}^2}\\right) + B_h \\exp\\left(-\\frac{(n - \\mu_{h2})^2}{\\sigma_{h2}^2}\\right)\n$$\n\nFor the knee:\n$$\nP_{\\mathrm{knee}}(t) = -A_k \\exp\\left(-\\frac{(n - \\mu_{k1})^2}{\\sigma_{k1}^2}\\right) + B_k \\exp\\left(-\\frac{(n - \\mu_{k2})^2}{\\sigma_{k2}^2}\\right)\n$$\n\nFor the ankle:\n$$\nP_{\\mathrm{ankle}}(t) = -A_{a\\_neg} \\exp\\left(-\\frac{(n - \\mu_{a1})^2}{\\sigma_{a1}^2}\\right) + B_a \\exp\\left(-\\frac{(n - \\mu_{a2})^2}{\\sigma_{a2}^2}\\right)\n$$\n\nAll amplitudes $A_h$, $A_k$, $A_{a\\_neg}$, and $B_h$, $B_k$, $B_a$ are in watts; parameters $\\mu$ and $\\sigma$ are dimensionless in normalized time $n$.\n\nTest suite specifications:\nDefine the following three cases with scientifically plausible parameter values.\n\n- Case $1$ (walking-like):\n  - $T = 0.7\\,\\mathrm{s}$, $N = 101$\n  - Hip: $A_h = 200$, $B_h = 150$, $\\mu_{h1} = 0.12$, $\\sigma_{h1} = 0.08$, $\\mu_{h2} = 0.82$, $\\sigma_{h2} = 0.10$\n  - Knee: $A_k = 250$, $B_k = 120$, $\\mu_{k1} = 0.15$, $\\sigma_{k1} = 0.10$, $\\mu_{k2} = 0.65$, $\\sigma_{k2} = 0.12$\n  - Ankle: $A_{a\\_neg} = 80$, $B_a = 250$, $\\mu_{a1} = 0.10$, $\\sigma_{a1} = 0.08$, $\\mu_{a2} = 0.88$, $\\sigma_{a2} = 0.08$\n\n- Case $2$ (running-like, larger push-off and collision magnitudes):\n  - $T = 0.4\\,\\mathrm{s}$, $N = 161$\n  - Hip: $A_h = 220$, $B_h = 180$, $\\mu_{h1} = 0.10$, $\\sigma_{h1} = 0.07$, $\\mu_{h2} = 0.78$, $\\sigma_{h2} = 0.09$\n  - Knee: $A_k = 380$, $B_k = 150$, $\\mu_{k1} = 0.12$, $\\sigma_{k1} = 0.09$, $\\mu_{k2} = 0.60$, $\\sigma_{k2} = 0.12$\n  - Ankle: $A_{a\\_neg} = 90$, $B_a = 500$, $\\mu_{a1} = 0.10$, $\\sigma_{a1} = 0.06$, $\\mu_{a2} = 0.87$, $\\sigma_{a2} = 0.07$\n\n- Case $3$ (edge case: weak push-off at ankle, pronounced knee absorption):\n  - $T = 0.6\\,\\mathrm{s}$, $N = 101$\n  - Hip: $A_h = 50$, $B_h = 40$, $\\mu_{h1} = 0.12$, $\\sigma_{h1} = 0.09$, $\\mu_{h2} = 0.80$, $\\sigma_{h2} = 0.11$\n  - Knee: $A_k = 220$, $B_k = 60$, $\\mu_{k1} = 0.14$, $\\sigma_{k1} = 0.10$, $\\mu_{k2} = 0.62$, $\\sigma_{k2} = 0.13$\n  - Ankle: $A_{a\\_neg} = 30$, $B_a = 20$, $\\mu_{a1} = 0.10$, $\\sigma_{a1} = 0.08$, $\\mu_{a2} = 0.88$, $\\sigma_{a2} = 0.08$\n\nComputational requirements:\n- For each case, compute $W^{+}$ and $W^{-}$ for each joint over the entire stance. Report $W^{+}$ and $W^{-}$ for hip, knee, and ankle as positive magnitudes in joules.\n- Compute the push-off positive work for each joint over the window $n \\in [0.8, 1.0]$ and identify the joint index with the largest push-off positive work. Compute the collision negative work magnitude for each joint over $n \\in [0.0, 0.2]$ and identify the joint index with the largest collision negative work magnitude.\n- Joint index encoding must be: hip $\\rightarrow 0$, knee $\\rightarrow 1$, ankle $\\rightarrow 2$.\n\nNumerical method and units:\n- Use the trapezoidal rule to approximate all time integrals.\n- Express all work values in joules (J), rounded to three decimal places.\n- Angles are in radians; time in seconds; power in watts; work in joules.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result itself is a list of eight floats followed by two integers: $[W^{+}_{\\mathrm{hip}}, W^{-}_{\\mathrm{hip}}, W^{+}_{\\mathrm{knee}}, W^{-}_{\\mathrm{knee}}, W^{+}_{\\mathrm{ankle}}, W^{-}_{\\mathrm{ankle}}, i_{\\mathrm{push}}, i_{\\mathrm{coll}}]$. Aggregate the three test cases into a single top-level list. For example: $[[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The posed problem is scientifically sound, well-posed, and objective. It is grounded in the fundamental principles of rigid-body dynamics and biomechanical energetics. The problem provides all necessary parameters, definitions, and computational requirements to arrive at a unique, verifiable solution. Therefore, the problem is deemed valid and a full solution is presented below.\n\nThe objective is to analyze synthetic joint power profiles for the hip, knee, and ankle during the stance phase of gait. This involves computing the total positive and negative work for each joint and identifying which joint is primarily responsible for energy generation during late stance (push-off) and energy absorption during early stance (collision).\n\nThe analysis proceeds in three main stages for each of the three test cases provided.\n\n**1. Generation of Joint Power Profiles**\nFor each case, we are given a stance duration $T$ and a number of samples $N$. We first establish a discrete time domain for the stance phase. The time vector $t$ consists of $N$ uniformly spaced points over the interval $[0, T]$.\n$$\nt_i = i \\cdot \\Delta t, \\quad \\text{for } i = 0, 1, \\dots, N-1 \\quad \\text{where } \\Delta t = \\frac{T}{N-1}\n$$\nA normalized time vector $n$ is then defined as $n = t/T$, which maps the stance phase to the unit interval $[0, 1]$.\n\nThe power profiles for the hip ($P_{\\mathrm{hip}}$), knee ($P_{\\mathrm{knee}}$), and ankle ($P_{\\mathrm{ankle}}$) are synthesized using the provided parametric equations, which model a negative (absorptive) power lobe in early stance and a positive (generative) power lobe in late stance. For instance, the hip power $P_{\\mathrm{hip}}(t)$ is a function of normalized time $n$:\n$$\nP_{\\mathrm{hip}}(t) = -A_h \\exp\\left(-\\frac{(n - \\mu_{h1})^2}{\\sigma_{h1}^2}\\right) + B_h \\exp\\left(-\\frac{(n - \\mu_{h2})^2}{\\sigma_{h2}^2}\\right)\n$$\nAnalogous equations are used for the knee and ankle, with their respective parameter sets $(A_k, B_k, \\dots)$ and $(A_{a\\_neg}, B_a, \\dots)$.\n\n**2. Calculation of Mechanical Work**\nMechanical work $W$ is the time integral of mechanical power $P(t)$.\n$$\nW = \\int P(t) \\, dt\n$$\nThe problem requires the calculation of positive work $W^{+}$ (energy generation) and the magnitude of negative work $W^{-}$ (energy absorption). These are defined by integrating the positive and negative parts of the power curve, respectively.\n- Positive power: $P^{+}(t) = \\max(P(t), 0)$\n- Negative power: $P^{-}(t) = \\min(P(t), 0)$\n\nThe positive work is the integral of the positive power:\n$$\nW^{+} = \\int_{0}^{T} P^{+}(t) \\, dt\n$$\nThe negative work magnitude is defined as the integral of the absolute value of the negative power, or equivalently:\n$$\nW^{-} = - \\int_{0}^{T} P^{-}(t) \\, dt\n$$\nThese definite integrals are approximated numerically using the trapezoidal rule, as specified. For a function $f(t)$ sampled at discrete points $(t_i, f_i)$, the integral is approximated as:\n$$\n\\int_{t_0}^{t_{N-1}} f(t) \\, dt \\approx \\sum_{i=1}^{N-1} \\frac{f_{i-1} + f_i}{2} (t_i - t_{i-1})\n$$\nSince the time steps are uniform, $\\Delta t = t_i - t_{i-1}$, this simplifies. This computation is performed for each of the three joints to find $(W^{+}_{\\mathrm{hip}}, W^{-}_{\\mathrm{hip}})$, $(W^{+}_{\\mathrm{knee}}, W^{-}_{\\mathrm{knee}})$, and $(W^{+}_{\\mathrm{ankle}}, W^{-}_{\\mathrm{ankle}})$.\n\n**3. Analysis of Collision and Push-off Phases**\nThe problem defines specific sub-intervals for analysis:\n- The collision phase: the initial $20\\%$ of stance, corresponding to normalized time $n \\in [0, 0.2]$.\n- The push-off phase: the final $20\\%$ of stance, corresponding to normalized time $n \\in [0.8, 1.0]$.\n\nTo quantify the dominant joint in each phase, we calculate the relevant work done by each joint within these specific time windows.\n\nFor the collision phase, we are interested in the largest energy absorption. We compute the negative work magnitude for each joint over the interval $[0, 0.2T]$. Let $t_{\\mathrm{coll\\_end}} = 0.2T$. The collision work for a given joint is:\n$$\nW^{-}_{\\mathrm{coll}} = - \\int_{0}^{t_{\\mathrm{coll\\_end}}} P^{-}(t) \\, dt\n$$\nThe joint with the maximum $W^{-}_{\\mathrm{coll}}$ is identified as the dominant absorber. Its index is denoted $i_{\\mathrm{coll}}$ (hip: $0$, knee: $1$, ankle: $2$).\n\nFor the push-off phase, we are interested in the largest energy generation. We compute the positive work for each joint over the interval $[0.8T, T]$. Let $t_{\\mathrm{push\\_start}} = 0.8T$. The push-off work is:\n$$\nW^{+}_{\\mathrm{push}} = \\int_{t_{\\mathrm{push\\_start}}}^{T} P^{+}(t) \\, dt\n$$\nThe joint with the maximum $W^{+}_{\\mathrm{push}}$ is identified as the dominant generator. Its index is denoted $i_{\\mathrm{push}}$.\n\nThese calculations are performed for each of the three test cases, and the results are aggregated and formatted according to the specification. All work values are reported in Joules (J).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the biomechanics problem for three test cases.\n    Generates joint power profiles, computes positive and negative work,\n    and identifies dominant joints for collision and push-off phases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (walking-like)\n        {\n            \"T\": 0.7, \"N\": 101,\n            \"hip\":   {\"A\": 200, \"B\": 150, \"mu1\": 0.12, \"sigma1\": 0.08, \"mu2\": 0.82, \"sigma2\": 0.10},\n            \"knee\":  {\"A\": 250, \"B\": 120, \"mu1\": 0.15, \"sigma1\": 0.10, \"mu2\": 0.65, \"sigma2\": 0.12},\n            \"ankle\": {\"A\": 80,  \"B\": 250, \"mu1\": 0.10, \"sigma1\": 0.08, \"mu2\": 0.88, \"sigma2\": 0.08}\n        },\n        # Case 2 (running-like)\n        {\n            \"T\": 0.4, \"N\": 161,\n            \"hip\":   {\"A\": 220, \"B\": 180, \"mu1\": 0.10, \"sigma1\": 0.07, \"mu2\": 0.78, \"sigma2\": 0.09},\n            \"knee\":  {\"A\": 380, \"B\": 150, \"mu1\": 0.12, \"sigma1\": 0.09, \"mu2\": 0.60, \"sigma2\": 0.12},\n            \"ankle\": {\"A\": 90,  \"B\": 500, \"mu1\": 0.10, \"sigma1\": 0.06, \"mu2\": 0.87, \"sigma2\": 0.07}\n        },\n        # Case 3 (edge case)\n        {\n            \"T\": 0.6, \"N\": 101,\n            \"hip\":   {\"A\": 50,  \"B\": 40,  \"mu1\": 0.12, \"sigma1\": 0.09, \"mu2\": 0.80, \"sigma2\": 0.11},\n            \"knee\":  {\"A\": 220, \"B\": 60,  \"mu1\": 0.14, \"sigma1\": 0.10, \"mu2\": 0.62, \"sigma2\": 0.13},\n            \"ankle\": {\"A\": 30,  \"B\": 20,  \"mu1\": 0.10, \"sigma1\": 0.08, \"mu2\": 0.88, \"sigma2\": 0.08}\n        }\n    ]\n    \n    # Joint index encoding: hip -> 0, knee -> 1, ankle -> 2\n    joint_names = [\"hip\", \"knee\", \"ankle\"]\n    \n    all_results = []\n\n    for case in test_cases:\n        T, N = case[\"T\"], case[\"N\"]\n        t = np.linspace(0, T, N)\n        n = t / T\n\n        case_results = []\n        \n        # Store work done in specific phases for later comparison\n        push_off_works = []\n        collision_works = []\n\n        for joint_name in joint_names:\n            params = case[joint_name]\n            A, B = params[\"A\"], params[\"B\"]\n            mu1, sigma1 = params[\"mu1\"], params[\"sigma1\"]\n            mu2, sigma2 = params[\"mu2\"], params[\"sigma2\"]\n\n            # Generate power profile\n            P = -A * np.exp(-((n - mu1)**2) / sigma1**2) + B * np.exp(-((n - mu2)**2) / sigma2**2)\n            \n            # Separate into positive and negative components\n            P_pos = np.maximum(0, P)\n            P_neg = np.minimum(0, P)\n\n            # Compute total positive and negative work over the entire stance\n            W_pos_total = np.trapz(P_pos, x=t)\n            W_neg_total = -np.trapz(P_neg, x=t)\n            \n            case_results.extend([round(W_pos_total, 3), round(W_neg_total, 3)])\n            \n            # --- Analysis of collision and push-off phases ---\n            \n            # Collision window: n in [0.0, 0.2]\n            coll_indices = np.where(n <= 0.2)[0]\n            t_coll = t[coll_indices]\n            P_neg_coll = P_neg[coll_indices]\n            W_neg_coll = -np.trapz(P_neg_coll, x=t_coll)\n            collision_works.append(W_neg_coll)\n\n            # Push-off window: n in [0.8, 1.0]\n            push_indices = np.where(n >= 0.8)[0]\n            t_push = t[push_indices]\n            P_pos_push = P_pos[push_indices]\n            W_pos_push = np.trapz(P_pos_push, x=t_push)\n            push_off_works.append(W_pos_push)\n\n        # Identify dominant joints by index\n        i_push = int(np.argmax(push_off_works))\n        i_coll = int(np.argmax(collision_works))\n        \n        case_results.extend([i_push, i_coll])\n        all_results.append(case_results)\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for res_list in all_results:\n        # Separate floats and ints for formatting\n        floats = res_list[:-2]\n        ints = res_list[-2:]\n        # Format floats to 3 decimal places, ints as they are\n        float_strs = [f\"{f:.3f}\" for f in floats]\n        int_strs = [str(i) for i in ints]\n        formatted_list_str = f\"[{','.join(float_strs + int_strs)}]\"\n        formatted_results.append(formatted_list_str)\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```"
        }
    ]
}