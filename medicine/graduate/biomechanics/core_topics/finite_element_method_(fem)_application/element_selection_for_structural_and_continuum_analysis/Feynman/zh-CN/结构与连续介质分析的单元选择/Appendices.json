{
    "hands_on_practices": [
        {
            "introduction": "要精通有限元分析，必须深刻理解其基本构件——单元刚度矩阵的推导过程。本练习将引导你从第一性原理出发，推导经典欧拉-伯努利梁单元的刚度矩阵，这是结构分析中最基本的单元之一。通过这个过程，你不仅能掌握其数学构造，还能认识到该理论在模拟较厚生物结构（如骨板）时存在的固有局限性。",
            "id": "4170882",
            "problem": "一块骨科固定板的直棱柱节段被模拟为一个一维梁单元，在平面弯曲作用下，使用欧拉-伯努利假设（平面横截面在变形后保持为平面且垂直于中性轴，并且横向剪切应变为零）。考虑局部坐标 $x \\in [0,L]$，其中 $L$ 是单元长度，并假设材料呈线性弹性行为，其杨氏模量为 $E$，绕平面外轴线的截面二次矩为 $I$。使用有限元法 (FEM)，取一个双节点梁单元，其节点自由度为 $\\{w_{1},\\theta_{1},w_{2},\\theta_{2}\\}$，其中 $w$ 是横向位移，$\\theta$ 是横截面绕中性轴的转角。从虚功原理和弯曲应变能出发，通过以下步骤推导该欧拉-伯努利单元的 $4 \\times 4$ 局部弯曲刚度矩阵：\n- 为 $w(x)$ 构建三次 Hermite 插值，该插值是 $C^{1}$ 连续的，并能精确插值 $\\{w_{1},\\theta_{1},w_{2},\\theta_{2}\\}$。\n- 根据欧拉-伯努利运动学，从 $w(x)$ 计算曲率 $\\kappa(x)$。\n- 通过在单元上对弯曲能量密度进行积分，形成单元刚度矩阵。\n\n然后，根据您推导出的刚度矩阵，确定其行列式。请以精确形式提供行列式作为最终答案，无需四舍五入。\n\n最后，讨论在模拟骨科器械中的厚梁或短梁（例如髓内钉或具有相当大厚度的板段）时，欧拉-伯努利单元的局限性，并简要论证在生物力学中，何时以及为何优先选用可剪切变形的 Timoshenko 梁单元以进行精确的结构与连续介质分析。您的讨论不会计入最终的数值答案，但应包含在您的解答中。",
            "solution": "该问题经评估为有效。这是一个在计算生物力学和结构力学领域内提法得当且有科学依据的问题，基于有限元法和欧拉-伯努利梁理论的既定原理。所有必要信息均已提供，所要求的推导和分析是该学科中的标准流程。\n\n单元刚度矩阵的推导将按照问题陈述中概述的步骤进行。\n\n首先，单元内的横向位移场 $w(x)$（从 $x=0$ 到 $x=L$）使用一个具有四个系数的三次多项式进行插值。这一选择是必要的，以匹配四个节点自由度（两个位移和两个转角）。\n位移由下式给出：\n$$w(x) = a_0 + a_1x + a_2x^2 + a_3x^3$$\n横截面的转角 $\\theta(x)$ 是位移场的一阶导数：\n$$\\theta(x) = \\frac{dw}{dx} = a_1 + 2a_2x + 3a_3x^2$$\n\n节点自由度在单元的节点处定义。\n在节点 1 处（$x=0$）：\n$w(0) = w_1$\n$\\theta(0) = \\theta_1$\n将这些条件应用于多项式表达式：\n$w_1 = a_0$\n$\\theta_1 = a_1$\n\n在节点 2 处（$x=L$）：\n$w(L) = w_2$\n$\\theta(L) = \\theta_2$\n应用这些条件：\n$w_2 = a_0 + a_1L + a_2L^2 + a_3L^3$\n$\\theta_2 = a_1 + 2a_2L + 3a_3L^2$\n\n将已知系数 $a_0 = w_1$ 和 $a_1 = \\theta_1$ 代入节点 2 的方程，得到一个关于剩余系数 $a_2$ 和 $a_3$ 的二元线性方程组：\n$$w_2 = w_1 + \\theta_1L + a_2L^2 + a_3L^3$$\n$$\\theta_2 = \\theta_1 + 2a_2L + 3a_3L^2$$\n整理可得：\n$$L^2 a_2 + L^3 a_3 = w_2 - w_1 - \\theta_1L$$\n$$2L a_2 + 3L^2 a_3 = \\theta_2 - \\theta_1$$\n求解该方程组，用节点自由度 $\\{w_1, \\theta_1, w_2, \\theta_2\\}$ 表示 $a_2$ 和 $a_3$，可得：\n$$a_2 = \\frac{3}{L^2}(w_2 - w_1) - \\frac{1}{L}(2\\theta_1 + \\theta_2)$$\n$$a_3 = \\frac{2}{L^3}(w_1 - w_2) + \\frac{1}{L^2}(\\theta_1 + \\theta_2)$$\n\n通过将所有四个系数代回 $w(x)$ 的表达式，我们可以将位移场表示为节点自由度的线性组合，其中系数是 Hermite 形函数 $N_i(x)$：\n$$w(x) = N_1(x)w_1 + N_2(x)\\theta_1 + N_3(x)w_2 + N_4(x)\\theta_2$$\n这可以写成矩阵形式 $w(x) = [N]\\{d\\}$，其中 $[N]$ 是形函数的行向量，$\\{d\\} = \\{w_1, \\theta_1, w_2, \\theta_2\\}^T$ 是节点位移向量。形函数为：\n$$N_1(x) = 1 - 3\\left(\\frac{x}{L}\\right)^2 + 2\\left(\\frac{x}{L}\\right)^3$$\n$$N_2(x) = x\\left(1 - \\frac{x}{L}\\right)^2 = x - \\frac{2x^2}{L} + \\frac{x^3}{L^2}$$\n$$N_3(x) = 3\\left(\\frac{x}{L}\\right)^2 - 2\\left(\\frac{x}{L}\\right)^3$$\n$$N_4(x) = x^2\\left(\\frac{x}{L} - 1\\right) = \\frac{x^3}{L^2} - x^2$$\n这些函数是 $C^1$ 连续的，并满足插值特性，例如，$N_1(0)=1$，$N_1(L)=0$，$\\frac{dN_1}{dx}(0)=0$ 等。\n\n接下来，我们计算曲率 $\\kappa(x)$。在小挠度欧拉-伯努利假设下，曲率由横向位移的二阶导数近似：\n$$\\kappa(x) \\approx \\frac{d^2w}{dx^2}$$\n我们可以使用矩阵 $[B]$ 将曲率表示为节点自由度的函数，该矩阵包含形函数的二阶导数：\n$$\\kappa(x) = \\frac{d^2}{dx^2}\\left([N]\\{d\\}\\right) = \\left[\\frac{d^2N_1}{dx^2} \\quad \\frac{d^2N_2}{dx^2} \\quad \\frac{d^2N_3}{dx^2} \\quad \\frac{d^2N_4}{dx^2}\\right]\\{d\\} = [B]\\{d\\}$$\n$[B]$ 矩阵的分量是：\n$$B_1(x) = \\frac{d^2N_1}{dx^2} = -\\frac{6}{L^2} + \\frac{12x}{L^3}$$\n$$B_2(x) = \\frac{d^2N_2}{dx^2} = -\\frac{4}{L} + \\frac{6x}{L^2}$$\n$$B_3(x) = \\frac{d^2N_3}{dx^2} = \\frac{6}{L^2} - \\frac{12x}{L^3}$$\n$$B_4(x) = \\frac{d^2N_4}{dx^2} = -\\frac{2}{L} + \\frac{6x}{L^2}$$\n\n梁因弯曲而储存的应变能 $U$ 由下式给出：\n$$U = \\frac{1}{2}\\int_V \\sigma \\epsilon \\,dV = \\frac{1}{2}\\int_0^L EI(\\kappa(x))^2 \\,dx$$\n其中 $E$ 是杨氏模量，$I$ 是截面二次矩。代入曲率的有限元近似：\n$$U = \\frac{1}{2}\\int_0^L EI ( [B]\\{d\\} )^T ( [B]\\{d\\} ) \\,dx = \\frac{1}{2}\\{d\\}^T \\left( EI \\int_0^L [B]^T [B] \\,dx \\right) \\{d\\}$$\n括号中的表达式是单元刚度矩阵 $[k]$：\n$$[k] = \\int_0^L EI [B]^T [B] \\,dx$$\n刚度矩阵的分量 $k_{ij}$ 通过 $k_{ij} = EI \\int_0^L B_i(x)B_j(x) \\,dx$ 计算。对所有 $i,j \\in \\{1,2,3,4\\}$ 执行这些积分，得到对称的 $4 \\times 4$ 局部弯曲刚度矩阵：\n$$[k] = \\frac{EI}{L^3} \\begin{pmatrix}\n12 & 6L & -12 & 6L \\\\\n6L & 4L^2 & -6L & 2L^2 \\\\\n-12 & -6L & 12 & -6L \\\\\n6L & 2L^2 & -6L & 4L^2\n\\end{pmatrix}$$\n\n最后的任务是确定该矩阵的行列式。一个无约束结构单元的刚度矩阵的一个基本性质是它必须是奇异的。这种奇异性源于刚体模态的存在，这些运动不产生变形，因此不产生应变能。对于平面内的梁单元，存在两种这样的模态：\n1.  纯平移：一个均一位移 $w_0$，其中 $w(x) = w_0$。相应的节点位移向量是 $\\{d_{trans}\\} = \\{w_0, 0, w_0, 0\\}^T$。\n2.  纯转动：绕某点的微小转动 $\\alpha$，导致线性位移场 $w(x) = \\alpha(x-x_0)$。如果我们绕 $x=0$ 转动，则 $w(x) = \\alpha x$。相应的节点位移向量是 $\\{d_{rot}\\} = \\{0, \\alpha, \\alpha L, \\alpha\\}^T$。\n\n对于任何刚体位移向量 $\\{d_{rbm}\\}$，产生的节点力必须为零，即 $[k]\\{d_{rbm}\\} = \\{0\\}$。这意味着刚体模态是 $[k]$ 的零空间中的非零向量。一个矩阵若要拥有非平凡的零空间，它必须是奇异的。奇异矩阵的行列式为零。\n\n我们可以通过数学方法验证此性质。让我们对矩阵 $[k]$ 进行一次行变换。设 $R_i$ 为第 $i$ 行。如果我们执行操作 $R_3 \\rightarrow R_3 + R_1$，新的第三行变为：\n$R'_3 = [-12, -6L, 12, -6L] + [12, 6L, -12, 6L] = [0, 0, 0, 0]$\n由于矩阵的一行可以通过初等行变换变为零向量，所以各行是线性相关的。具有线性相关行（或列）的矩阵的行列式为零。因此，欧拉-伯努利梁单元刚度矩阵的行列式精确为零。\n$$\\det([k]) = 0$$\n\n问题的最后一部分要求讨论该模型的局限性。欧拉-伯努利梁单元是基于平面横截面保持平面且垂直于变形后中性轴的假设建立的。这种表述内在地忽略了横向剪切应变。这一假设对于细长梁是有效且高度准确的，其中梁的长度 $L$ 远大于其厚度 $h$（即，具有高纵横比 $L/h$）。在这种情况下，弯曲变形占主导地位，而剪切变形可以忽略不计。\n\n然而，在许多生物力学应用中，结构部件并非细长。例如，骨科接骨板或髓内钉的节段可能相对短而粗，具有低纵横比。对于这些“厚”或“短”的梁，横向剪切变形可能对结构的总位移和应变有显著贡献。欧拉-伯努利模型通过忽略这种效应，会高估结构的刚度，导致位移的低估和可能不准确的应力预测。\n\n在这种情况下，为了进行更精确的结构与连续介质分析，优先选用可剪切变形的 Timoshenko 梁单元。Timoshenko 梁理论放宽了欧拉-伯努利理论的刚性正交约束。它允许横截面保持平面，但不一定垂直于中性轴。这是通过将横截面的转角视为一个独立的运动学变量来实现的，该变量与中性轴的斜率 $\\frac{dw}{dx}$ 不同。这两个量之间的差异即为平均横向剪切应变。通过考虑剪切变形，Timoshenko 模型为厚梁的力学行为提供了更符合物理实际的表示。因此，在模拟那些剪切效应不能被合理地忽略的粗短生物力学部件时，Timoshenko 梁单元对于获得准确可靠的结果至关重要。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "为克服欧拉-伯努利理论的局限性，季莫申科梁理论引入了剪切变形，更适用于厚梁模型。然而，不恰当的单元列式会导致一种称为“剪切锁定”的严重数值问题，使得单元在薄梁极限下表现得过于刚硬。本练习通过分析推导，揭示了低阶季莫申科梁单元产生寄生剪切能并导致锁定的机理，这对于在生物力学模拟中正确选择和使用单元至关重要。",
            "id": "4170873",
            "problem": "在生物力学中，一个具有矩形截面的细长皮质骨骨板段将被建模为单个双节点Timoshenko梁有限元，以进行结构分析。该骨板段的长度为$L$，宽度为$b$，厚度（沿弯曲方向）为$h$，杨氏模量为$E$，剪切模量为$G$，剪切修正因子为$\\kappa$。横截面积为$A$，绕弯曲轴的截面二次矩为$I$。该单元采用低阶插值：对横向位移$w(x)$和横截面转角$\\beta(x)$使用线性形函数。\n\n考虑沿跨度方向作用有恒定弯矩$M$的加载状态，此时精确的Euler–Bernoulli解具有零剪切应变、恒定弯曲曲率和二次横向位移场。仅从基本的梁运动学和能量原理出发，完成以下任务：\n\n- 使用Timoshenko梁的剪切应变运动学关系$\\gamma(x) = w'(x) - \\beta(x)$，并对$w(x)$和$\\beta(x)$进行线性插值，当节点值从$x=0$和$x=L$处的精确Euler–Bernoulli解中采样时，求出由该低阶单元预测的剪切应变场$\\gamma_{h}(x)$。\n- 在给定的恒定弯矩$M$作用下，推导由于此$\\gamma_{h}(x)$而在单元上累积的寄生剪切应变能$U_{\\text{shear}}(h)$。\n- 在相同载荷下，推导单元上的精确弯曲应变能$U_{\\text{bend}}$。\n- 构造比值$R(h) = U_{\\text{shear}}(h)/U_{\\text{bend}}$，并将其简化为一个闭式表达式，该表达式明确地显示了它如何随厚度$h$变化。\n\n假设为矩形截面，因此$A = b h$和$I = b h^{3}/12$。用给定的参数提供$R(h)$的最终表达式。最终表达式是无量纲的；不要四舍五入，也不要在最终表达式中包含单位。",
            "solution": "该问题要求分析在恒定弯矩作用下，一个双节点Timoshenko梁单元中的寄生剪切应变，即所谓的剪切自锁现象。推导过程将首先建立指定载荷下的精确解，然后确定由低阶有限元近似的场，计算由此产生的伪剪切应变能，并将其与正确的弯曲应变能进行比较。\n\n步骤1：确定纯弯曲的精确解。\n在恒定弯矩$M$作用下，Euler-Bernoulli梁的控制方程为：\n$$\nE I \\frac{d^2w}{dx^2} = M\n$$\n在Euler-Bernoulli理论中，横截面的转角$\\beta(x)$是挠度曲线的斜率，即$\\beta(x) = w'(x)$。将控制方程对$x$积分一次，得到转角：\n$$\nE I \\frac{dw}{dx} = E I \\beta(x) = M x + C_1\n$$\n其中$C_1$是一个积分常数。再次积分，得到横向位移$w(x)$：\n$$\nE I w(x) = \\frac{1}{2} M x^2 + C_1 x + C_2\n$$\n其中$C_2$是第二个积分常数。这些常数$C_1$和$C_2$取决于未指定的边界条件。然而，如下所示，它们将在最终结果中被消去。根据定义，Euler-Bernoulli解的剪切应变为零，即$\\gamma(x) = w'(x) - \\beta(x) = 0$。\n\n步骤2：定义有限元近似。\n该双节点单元的跨度从$x=0$到$x=L$。横向位移$w(x)$和转角$\\beta(x)$使用线性形函数$N_1(x) = 1 - x/L$和$N_2(x) = x/L$进行近似。近似场$w_h(x)$和$\\beta_h(x)$为：\n$$\nw_h(x) = N_1(x) w_1 + N_2(x) w_2 = \\left(1 - \\frac{x}{L}\\right) w_1 + \\frac{x}{L} w_2\n$$\n$$\n\\beta_h(x) = N_1(x) \\beta_1 + N_2(x) \\beta_2 = \\left(1 - \\frac{x}{L}\\right) \\beta_1 + \\frac{x}{L} \\beta_2\n$$\n其中$w_1, w_2, \\beta_1, \\beta_2$分别是$x=0$和$x=L$处的位移和转角的节点值。\n\n步骤3：确定寄生剪切应变场$\\gamma_h(x)$。\nTimoshenko梁单元中的剪切应变由$\\gamma_h(x) = w_h'(x) - \\beta_h(x)$给出。近似位移的导数为：\n$$\nw_h'(x) = \\frac{d}{dx} \\left[ \\left(1 - \\frac{x}{L}\\right) w_1 + \\frac{x}{L} w_2 \\right] = \\frac{w_2 - w_1}{L}\n$$\n注意，插值斜率$w_h'(x)$在整个单元上是恒定的。则剪切应变为：\n$$\n\\gamma_h(x) = \\frac{w_2 - w_1}{L} - \\left[ \\left(1 - \\frac{x}{L}\\right) \\beta_1 + \\frac{x}{L} \\beta_2 \\right]\n$$\n为了在给定载荷下计算此值，我们从$x=0$和$x=L$处的精确Euler-Bernoulli解中采样节点值：\n$$\nw_1 = w(0) = \\frac{C_2}{EI}\n$$\n$$\nw_2 = w(L) = \\frac{1}{EI} \\left( \\frac{1}{2} M L^2 + C_1 L + C_2 \\right)\n$$\n$$\n\\beta_1 = \\beta(0) = \\frac{C_1}{EI}\n$$\n$$\n\\beta_2 = \\beta(L) = \\frac{1}{EI} (M L + C_1)\n$$\n现在将这些节点值代入$\\gamma_h(x)$的表达式中。首先，对于常数项：\n$$\n\\frac{w_2 - w_1}{L} = \\frac{1}{L} \\left[ \\frac{1}{EI} \\left( \\frac{1}{2} M L^2 + C_1 L + C_2 \\right) - \\frac{C_2}{EI} \\right] = \\frac{1}{LEI} \\left( \\frac{1}{2} M L^2 + C_1 L \\right) = \\frac{ML}{2EI} + \\frac{C_1}{EI}\n$$\n接下来，对于插值转角项$\\beta_h(x)$：\n$$\n\\beta_h(x) = \\left(1 - \\frac{x}{L}\\right) \\frac{C_1}{EI} + \\frac{x}{L} \\frac{ML+C_1}{EI} = \\frac{1}{EI} \\left[ C_1 - \\frac{C_1x}{L} + \\frac{MLx}{L} + \\frac{C_1x}{L} \\right] = \\frac{C_1 + Mx}{EI}\n$$\n将这些组合起来求剪切应变：\n$$\n\\gamma_h(x) = \\left(\\frac{ML}{2EI} + \\frac{C_1}{EI}\\right) - \\left(\\frac{C_1 + Mx}{EI}\\right) = \\frac{ML}{2EI} - \\frac{Mx}{EI}\n$$\n这可以简化为寄生剪切应变场：\n$$\n\\gamma_h(x) = \\frac{M}{EI} \\left( \\frac{L}{2} - x \\right)\n$$\n尽管精确解的剪切应变为零，但此应变非零。这是低阶插值无法在不引入剪切的情况下表示纯弯曲状态的直接后果。\n\n步骤4：推导寄生剪切应变能$U_{\\text{shear}}(h)$。\n由剪切储存的应变能由剪切应力与剪切应变乘积的一半在体积上的积分给出。对于梁，这表示为：\n$$\nU_{\\text{shear}}(h) = \\int_0^L \\frac{1}{2} (\\kappa G A) [\\gamma_h(x)]^2 dx\n$$\n其中$\\kappa$是剪切修正因子，$G$是剪切模量，$A$是横截面积。代入$\\gamma_h(x)$的表达式：\n$$\nU_{\\text{shear}}(h) = \\frac{\\kappa G A}{2} \\int_0^L \\left[ \\frac{M}{EI} \\left( \\frac{L}{2} - x \\right) \\right]^2 dx = \\frac{\\kappa G A M^2}{2(EI)^2} \\int_0^L \\left( \\frac{L}{2} - x \\right)^2 dx\n$$\n该积分计算结果为：\n$$\n\\int_0^L \\left( \\frac{L}{2} - x \\right)^2 dx = \\left[ -\\frac{1}{3} \\left( \\frac{L}{2} - x \\right)^3 \\right]_0^L = -\\frac{1}{3} \\left[ \\left( -\\frac{L}{2} \\right)^3 - \\left( \\frac{L}{2} \\right)^3 \\right] = -\\frac{1}{3} \\left( -\\frac{L^3}{8} - \\frac{L^3}{8} \\right) = \\frac{L^3}{12}\n$$\n因此，寄生剪切应变能为：\n$$\nU_{\\text{shear}}(h) = \\frac{\\kappa G A M^2}{2(EI)^2} \\frac{L^3}{12} = \\frac{\\kappa G A M^2 L^3}{24(EI)^2}\n$$\n\n步骤5：推导精确弯曲应变能$U_{\\text{bend}}$。\n由纯弯曲引起的应变能由下式给出：\n$$\nU_{\\text{bend}} = \\int_0^L \\frac{M^2}{2EI} dx\n$$\n由于$M$、$E$和$I$沿单元长度是恒定的：\n$$\nU_{\\text{bend}} = \\frac{M^2}{2EI} \\int_0^L dx = \\frac{M^2 L}{2EI}\n$$\n\n步骤6：构造比值$R(h)$并进行简化。\n寄生剪切能与精确弯曲能之比为：\n$$\nR(h) = \\frac{U_{\\text{shear}}(h)}{U_{\\text{bend}}} = \\frac{\\frac{\\kappa G A M^2 L^3}{24(EI)^2}}{\\frac{M^2 L}{2EI}} = \\frac{\\kappa G A L^2}{12 EI}\n$$\n现在，代入矩形截面的表达式：$A = bh$和$I = bh^3/12$。\n$$\nR(h) = \\frac{\\kappa G (bh) L^2}{12 E (bh^3/12)}\n$$\n通过消去项来简化此表达式：\n$$\nR(h) = \\frac{\\kappa G b h L^2}{E b h^3} = \\frac{\\kappa G L^2}{E h^2}\n$$\n此表达式可以写成明确显示其对梁的跨厚比$(L/h)$的依赖关系：\n$$\nR(h) = \\frac{\\kappa G}{E} \\left( \\frac{L}{h} \\right)^2\n$$\n最终结果表明，伪剪切能与正确弯曲能之比与梁的跨厚比的平方成正比。对于$L/h \\gg 1$的细长梁，该比值变得非常大，表明单元的响应由非物理的剪切能主导。这种刚化效应被称为剪切自锁。该表达式随厚度的变化规律为$h^{-2}$。",
            "answer": "$$\\boxed{\\frac{\\kappa G}{E} \\left(\\frac{L}{h}\\right)^2}$$"
        },
        {
            "introduction": "在理论探讨之后，最终的决策往往需要量化分析。本练习将理论付诸实践，要求你编写程序来直接比较欧拉-伯努利梁和季莫申科梁在模拟骨板时的性能差异。通过计算不同厚度下的挠度并量化模型误差，你将获得关于何时可以安全地使用简化模型，以及何时必须采用更复杂模型的直观且数据驱动的见解。",
            "id": "4170860",
            "problem": "您的任务是设计并实现一个程序，以定量比较 Euler–Bernoulli 梁单元与 Timoshenko 梁单元在模拟承受中心点载荷的细长皮质骨板时的适用性，并评估建模误差如何随板厚增加而变化。该板被建模为一根等截面直梁，其横截面为矩形，长度为 $L$，宽度为 $b$，厚度为 $h$，由各向同性线弹性材料制成，其杨氏模量为 $E$，泊松比为 $\\nu$。大小为 $P$ 的中心点载荷在小应变和小转角的假设下产生小变形。矩形横截面的剪切修正因子为 $\\kappa$。\n\n从生物力学和结构分析的基本原理出发，推导计算简支梁在中心点载荷作用下，根据 Euler–Bernoulli 梁理论和 Timoshenko 梁理论预测的跨中挠度所需的控制关系。您的推导必须从以下几点开始：\n- 小应变线弹性的本构关系，包括 $G = \\dfrac{E}{2(1+\\nu)}$。\n- 梁的运动学，包括细长梁的弯矩与曲率之间的关系，以及厚梁的横向剪切变形的作用。\n- 矩形横截面的面积 $A$ 和截面二次矩 $I$ 的定义（$A = b h$ 和 $I = \\dfrac{b h^3}{12}$）。\n- 简支梁在中心点载荷 $P$ 作用下的静力平衡。\n\n您不能假设或引用任何挠度的简化公式；而是需要构建计算分析师在有限元分析环境中用于单元选择的表达式。最终目标是获得两种梁理论下中心点载荷作用的跨中挠度表达式，然后计算一个相对建模误差，以量化当厚度增加时其差异。\n\n使用以下科学合理的参数值，以国际单位制表示：\n- 梁（板）长度：$L = 0.10$ 米。\n- 梁（板）宽度：$b = 0.012$ 米。\n- 测试的厚度值：$h \\in \\{0.001, 0.003, 0.006, 0.010, 0.015\\}$ 米。\n- 杨氏模量：$E = 18 \\times 10^9$ 帕斯卡。\n- 泊松比：$\\nu = 0.30$。\n- 剪切修正因子：$\\kappa = \\dfrac{5}{6}$。\n- 中心点载荷：$P = 1.0$ 牛顿。\n\n对于每个测试厚度 $h$，计算：\n1. Euler–Bernoulli 梁理论预测的跨中挠度（单位：米）。\n2. Timoshenko 梁理论预测的跨中挠度（单位：米）。\n3. 相对建模误差，定义为十进制值 $\\dfrac{\\delta_{\\mathrm{EB}} - \\delta_{\\mathrm{T}}}{\\delta_{\\mathrm{T}}}$。\n4. 用于单元选择的布尔建议，如果 Euler–Bernoulli 单元可接受（相对误差的绝对值小于阈值 $\\tau$），则程序返回 $True$，否则返回 $False$。使用 $\\tau = 0.05$。\n\n所有挠度必须以米为单位表示。相对误差必须以十进制表示，而不是百分比。布尔建议必须严格为 $True$ 或 $False$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，该列表汇总了所有结果，每个测试案例贡献一个形式为 $[\\delta_{\\mathrm{EB}}, \\delta_{\\mathrm{T}}, \\text{error}, \\text{recommendation}]$ 的四项列表。例如：\n“您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$[[\\delta_{\\mathrm{EB}_1},\\delta_{\\mathrm{T}_1},\\text{error}_1,\\text{recommendation}_1],[\\delta_{\\mathrm{EB}_2},\\delta_{\\mathrm{T}_2},\\text{error}_2,\\text{recommendation}_2],\\dots]$）。”",
            "solution": "对问题陈述进行了严格验证，并被认为是有效的。它在科学上基于固体力学原理，特别是梁理论，并且问题提法得当，提供了所有必要的参数和明确的目标。所提供的数值在皮质骨分析的生物力学背景下是物理上现实的。该问题是客观的，没有歧义。\n\n任务是推导简支梁在中心点载荷作用下，根据 Euler-Bernoulli 和 Timoshenko 梁理论的跨中挠度表达式，然后实现一个程序来计算这些挠度以及在一系列梁厚度下的相对建模误差。\n\n**1. 基本原理和给定参数**\n\n分析基于线弹性和静力平衡。给定参数如下：\n- 梁长度：$L = 0.10$ m\n- 梁宽度：$b = 0.012$ m\n- 梁厚度：$h \\in \\{0.001, 0.003, 0.006, 0.010, 0.015\\}$ m\n- 杨氏模量：$E = 18 \\times 10^9$ Pa\n- 泊松比：$\\nu = 0.30$\n- 剪切修正因子：$\\kappa = \\frac{5}{6}$\n- 中心点载荷：$P = 1.0$ N\n- 误差阈值：$\\tau = 0.05$\n\n根据材料属性，可以推导出剪切模量 $G$：\n$$G = \\frac{E}{2(1+\\nu)}$$\n对于宽度为 $b$、厚度为 $h$ 的矩形截面，其横截面属性为：\n- 面积：$A = bh$\n- 截面二次矩（绕弯曲轴）：$I = \\frac{bh^3}{12}$\n\n**2. 静力平衡分析**\n\n考虑一根长度为 $L$ 的简支梁，支座位于 $x=0$ 和 $x=L$。在跨中 $x=L/2$ 处施加一个点载荷 $P$。根据静力平衡，由于对称性，支座处的竖向反力相等：\n$$R_A = R_B = \\frac{P}{2}$$\n对于梁的左半部分（$0 \\le x \\le L/2$），我们可以在距左支座 $x$ 处做一个虚拟切口，以确定内剪力 $V(x)$ 和内弯矩 $M(x)$。\n- 剪力是恒定的，等于反力：\n$$V(x) = R_A = \\frac{P}{2}$$\n- 弯矩从支座开始线性增加：\n$$M(x) = R_A \\cdot x = \\frac{P}{2}x$$\n\n**3. Euler–Bernoulli 梁理论 (EB)**\n\n该理论假设平面横截面在变形后保持平面，并且关键的是，保持与中性轴垂直。这意味着横向剪切应变可以忽略不计。\n\n其控制关系是弯矩-曲率方程：\n$$EI \\frac{d^2v}{dx^2} = M(x)$$\n其中 $v(x)$ 是梁的横向挠度。\n\n代入区域 $0 \\le x \\le L/2$ 的 $M(x)$ 表达式：\n$$EI \\frac{d^2v}{dx^2} = \\frac{P}{2}x$$\n对 $x$ 积分得到转角 $\\frac{dv}{dx}$：\n$$EI \\frac{dv}{dx} = \\frac{P}{4}x^2 + C_1$$\n再次积分得到挠度 $v(x)$：\n$$EI v(x) = \\frac{P}{12}x^3 + C_1x + C_2$$\n积分常数 $C_1$ 和 $C_2$ 通过边界条件和对称性条件求得。\n- **边界条件：** 位于 $x=0$ 处的简支座挠度为零，因此 $v(0)=0$。\n$$EI v(0) = \\frac{P}{12}(0)^3 + C_1(0) + C_2 = 0 \\implies C_2 = 0$$\n- **对称性条件：** 由于对称的载荷和支座，梁在跨中（$x=L/2$）的转角必须为零，因此 $\\frac{dv}{dx}(L/2)=0$。\n$$EI \\frac{dv}{dx}\\bigg|_{x=L/2} = \\frac{P}{4}\\left(\\frac{L}{2}\\right)^2 + C_1 = 0 \\implies \\frac{PL^2}{16} + C_1 = 0 \\implies C_1 = -\\frac{PL^2}{16}$$\n将常数代回挠度方程得到：\n$$EI v(x) = \\frac{P}{12}x^3 - \\frac{PL^2}{16}x$$\n最大挠度 $\\delta_{\\mathrm{EB}}$ 出现在跨中（$x=L/2$）。其大小为：\n$$\\delta_{\\mathrm{EB}} = |v(L/2)| = \\left| \\frac{1}{EI} \\left( \\frac{P}{12}\\left(\\frac{L}{2}\\right)^3 - \\frac{PL^2}{16}\\left(\\frac{L}{2}\\right) \\right) \\right|$$\n$$\\delta_{\\mathrm{EB}} = \\left| \\frac{1}{EI} \\left( \\frac{PL^3}{96} - \\frac{PL^3}{32} \\right) \\right| = \\left| \\frac{1}{EI} \\left( \\frac{PL^3 - 3PL^3}{96} \\right) \\right| = \\frac{PL^3}{48EI}$$\n\n**4. Timoshenko 梁理论 (T)**\n\n该理论更具普适性，它考虑了横向剪切变形。它假设平面截面保持平面，但不一定保持与变形后的中性轴垂直。中性轴的总转角 $\\frac{dv}{dx}$ 由两部分组成：横截面的转角 $\\psi(x)$ 和平均剪切应变 $\\gamma_{\\text{avg}}$。\n$$\\frac{dv}{dx} = \\psi(x) + \\gamma_{\\text{avg}}$$\n控制方程为：\n1.  弯矩-曲率关系：$M(x) = EI \\frac{d\\psi}{dx}$\n2.  剪力-应变关系：$V(x) = \\kappa G A \\gamma_{\\text{avg}}$\n\n将这些结合起来，我们得到总转角的方程：\n$$\\frac{dv}{dx} = \\psi(x) + \\frac{V(x)}{\\kappa G A}$$\n对于区域 $0 \\le x \\le L/2$，我们有 $V(x) = P/2$ 和 $M(x) = Px/2$。\n首先，积分弯矩-曲率关系以求得横截面转角 $\\psi(x)$：\n$$EI \\frac{d\\psi}{dx} = \\frac{P}{2}x \\implies EI \\psi(x) = \\frac{P}{4}x^2 + C_3$$\n根据对称性，跨中横截面的转角必须为零，即 $\\psi(L/2)=0$：\n$$EI \\psi(L/2) = \\frac{P}{4}\\left(\\frac{L}{2}\\right)^2 + C_3 = 0 \\implies C_3 = -\\frac{PL^2}{16}$$\n所以，转角为 $\\psi(x) = \\frac{1}{EI}\\left(\\frac{P}{4}x^2 - \\frac{PL^2}{16}\\right)$。\n现在，将此式和 $V(x)$ 代入总转角方程：\n$$\\frac{dv}{dx} = \\frac{1}{EI}\\left(\\frac{P}{4}x^2 - \\frac{PL^2}{16}\\right) + \\frac{P}{2\\kappa G A}$$\n对 $x$ 积分以求得挠度 $v(x)$：\n$$v(x) = \\frac{1}{EI}\\left(\\frac{P}{12}x^3 - \\frac{PL^2}{16}x\\right) + \\frac{P}{2\\kappa G A}x + C_4$$\n使用边界条件 $v(0)=0$：\n$$v(0) = 0 + 0 + C_4 = 0 \\implies C_4 = 0$$\n最大挠度 $\\delta_{\\mathrm{T}}$ 出现在跨中（$x=L/2$）。其大小为：\n$$\\delta_{\\mathrm{T}} = |v(L/2)| = \\left| \\frac{1}{EI}\\left(\\frac{P}{12}\\left(\\frac{L}{2}\\right)^3 - \\frac{PL^2}{16}\\left(\\frac{L}{2}\\right)\\right) + \\frac{P}{2\\kappa G A}\\left(\\frac{L}{2}\\right) \\right|$$\n$$\\delta_{\\mathrm{T}} = \\left| -\\frac{PL^3}{48EI} + \\frac{PL}{4\\kappa G A} \\right|$$\n由于弯曲挠度和剪切挠度方向相同，我们将它们的量值相加：\n$$\\delta_{\\mathrm{T}} = \\underbrace{\\frac{PL^3}{48EI}}_{\\delta_{\\mathrm{EB}}} + \\underbrace{\\frac{PL}{4\\kappa G A}}_{\\delta_{\\text{shear}}}$$\nTimoshenko 理论下的总挠度是 Euler-Bernoulli 弯曲挠度与一个代表剪切变形引起的附加项之和。\n\n**5. 误差分析与计算策略**\n\n使用较简单的 Euler–Bernoulli 理论相对于更全面的 Timoshenko 理论的相对建模误差定义为：\n$$\\text{error} = \\frac{\\delta_{\\mathrm{EB}} - \\delta_{\\mathrm{T}}}{\\delta_{\\mathrm{T}}} = \\frac{\\delta_{\\mathrm{EB}} - (\\delta_{\\mathrm{EB}} + \\delta_{\\text{shear}})}{\\delta_{\\mathrm{T}}} = -\\frac{\\delta_{\\text{shear}}}{\\delta_{\\mathrm{T}}}$$\n如果此误差的绝对值低于阈值 $\\tau = 0.05$，则建议使用 Euler–Bernoulli 梁单元：\n$$\\text{recommendation} = (|\\text{error}| < \\tau)$$\n程序的计算步骤如下：\n1.  定义所有常量参数（$L, b, E, \\nu, \\kappa, P, \\tau$）。\n2.  计算剪切模量 $G$。\n3.  遍历厚度列表 $h$。\n4.  对于每个 $h$，计算面积 $A$ 和截面二次矩 $I$。\n5.  使用其推导出的公式计算 Euler-Bernoulli 挠度 $\\delta_{\\mathrm{EB}}$。\n6.  计算附加的剪切挠度 $\\delta_{\\text{shear}}$。\n7.  计算 Timoshenko 挠度 $\\delta_{\\mathrm{T}} = \\delta_{\\mathrm{EB}} + \\delta_{\\text{shear}}$。\n8.  计算相对误差。\n9.  确定布尔建议。\n10. 存储每个厚度计算出的四个值，并按规定格式化最终输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Compares Euler-Bernoulli and Timoshenko beam theories for a cortical bone plate.\n\n    This function calculates the midspan deflection for a simply supported beam under a \n    central point load using both theories. It then computes the relative modeling error \n    to assess the validity of the Euler-Bernoulli assumption for different beam thicknesses.\n    \"\"\"\n    # Define problem parameters in SI units\n    L = 0.10             # Beam length (m)\n    b = 0.012            # Beam width (m)\n    E = 18e9             # Young's modulus (Pa)\n    nu = 0.30            # Poisson's ratio\n    kappa = 5.0 / 6.0    # Shear correction factor for rectangular cross-section\n    P = 1.0              # Central point load (N)\n    tau = 0.05           # Relative error threshold\n\n    # Thickness values to test (m)\n    h_values = [0.001, 0.003, 0.006, 0.010, 0.015]\n\n    # Calculate derived material property: Shear Modulus (G)\n    G = E / (2 * (1 + nu))\n\n    results = []\n    \n    for h in h_values:\n        # Cross-sectional properties for the current thickness\n        # Area (A)\n        A = b * h\n        # Second moment of area (I)\n        I = (b * h**3) / 12.0\n\n        # 1. Calculate Euler-Bernoulli (EB) deflection\n        # This deflection is due to bending only.\n        delta_eb = (P * L**3) / (48.0 * E * I)\n\n        # 2. Calculate Timoshenko (T) deflection\n        # This includes both bending and shear deformation.\n        # The bending component is the same as the EB deflection.\n        delta_bending = delta_eb\n        # The shear component is calculated separately.\n        delta_shear = (P * L) / (4.0 * kappa * G * A)\n        # The total Timoshenko deflection is the sum of both components.\n        delta_t = delta_bending + delta_shear\n\n        # 3. Calculate relative modeling error\n        # Error = (approx_value - true_value) / true_value\n        # Here, EB is the approximation and T is the more accurate model.\n        if delta_t == 0:\n            error = 0.0\n        else:\n            error = (delta_eb - delta_t) / delta_t\n\n        # 4. Determine recommendation for element selection\n        # True if Euler-Bernoulli elements are acceptable (error  threshold)\n        recommendation = abs(error)  tau\n\n        # Store the results for this thickness\n        case_result = [delta_eb, delta_t, error, recommendation]\n        results.append(case_result)\n\n    # Format the output string as a list of lists, without extra spaces inside sublists.\n    # e.g., [[val1,val2,val3,True],[...]]\n    result_strings = []\n    for res in results:\n        # Manually format each sub-list to match the desired output style\n        # This avoids spaces from default str(list) and handles boolean case\n        formatted_res = f\"[{res[0]},{res[1]},{res[2]},{str(res[3])}]\"\n        result_strings.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}