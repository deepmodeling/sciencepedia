{
    "hands_on_practices": [
        {
            "introduction": "单元刚度矩阵 $K_e$ 是有限元法的基石，它建立了节点力与节点位移之间的基本关系。本练习将引导您从第一性原理出发，推导一个常见的二维单元在平面应变条件下的刚度矩阵 。完成这一推导过程，对于理解商业有限元分析软件的内部工作原理，以及培养开发自定义单元所需技能至关重要。",
            "id": "4185741",
            "problem": "一个厚的、均匀的、各向同性的组织补片被建模为平面应变中的单个双线性四边形有限元，使用有限元法 (FEM)。该单元在物理坐标中占据一个矩形，节点位于 $(-a/2,-b/2)$、$(a/2,-b/2)$、$(a/2,b/2)$ 和 $(-a/2,b/2)$，其中 $a>0$ 和 $b>0$ 分别是沿 $x$ 轴和 $y$ 轴的边长。该单元具有均匀的平面外厚度 $t$。设位移场为小位移，并用 $u(x,y)$ 和 $v(x,y)$ 表示其分量。假设平面应变运动学和线性各向同性弹性，杨氏模量为 $E$，泊松比为 $\\nu$，因此柯西应力通过标准的平面应变本构张量与应变线性相关。\n\n仅使用：\n- 小应变运动学关系 $ \\varepsilon_{xx}=\\partial u/\\partial x$，$ \\varepsilon_{yy}=\\partial v/\\partial y$ 和 $ \\gamma_{xy}=\\partial u/\\partial y+\\partial v/\\partial x$，\n- 虚功原理，\n- 定义在自然坐标方块 $-1\\le \\xi,\\eta \\le 1$ 上的双线性四边形形函数，其等参映射为 $x(\\xi,\\eta)=(a/2)\\,\\xi$ 和 $y(\\xi,\\eta)=(b/2)\\,\\eta$，\n\n推导获得该单元的一致刚度矩阵所需的单元级表达式。然后，将您的推导特化于第一个节点的水平自由度（即，耦合节点1的水平位移与其自身的分量），对单元域进行精确积分，并报告得到的无量纲标量\n$$\\widehat{K}_{11}\\equiv \\frac{K_{11}}{E\\,t}$$\n为关于 $a$、$b$ 和 $\\nu$ 的封闭形式代数表达式。不要进行任何数值代入。您的最终答案必须是单个封闭形式的表达式。最终答案中不要包含单位。无需四舍五入。",
            "solution": "根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **模型：** 平面应变中的单个双线性四边形有限元。组织是厚的、均匀的、各向同性的。\n- **几何形状：** 矩形单元，节点位于 $(-\\frac{a}{2},-\\frac{b}{2})$、$(\\frac{a}{2},-\\frac{b}{2})$、$(\\frac{a}{2},\\frac{b}{2})$ 和 $(-\\frac{a}{2},\\frac{b}{2})$，其中 $a>0$ 和 $b>0$。\n- **厚度：** 均匀厚度 $t$。\n- **运动学：** 小应变，分量为 $\\varepsilon_{xx}=\\frac{\\partial u}{\\partial x}$、$\\varepsilon_{yy}=\\frac{\\partial v}{\\partial y}$ 和 $\\gamma_{xy}=\\frac{\\partial u}{\\partial y}+\\frac{\\partial v}{\\partial x}$。\n- **材料模型：** 线性各向同性弹性，杨氏模量为 $E$，泊松比为 $\\nu$。本构关系是平面应变的标准关系。\n- **方法：** 虚功原理。\n- **有限元列式：** 在自然坐标方块 $-1 \\le \\xi, \\eta \\le 1$ 上使用双线性四边形形函数的等参列式。\n- **映射：** $x(\\xi,\\eta)=\\frac{a}{2}\\xi$ 和 $y(\\xi,\\eta)=\\frac{b}{2}\\eta$。\n- **目标：** 推导一致刚度矩阵分量 $K_{11}$，该分量耦合了节点1的水平力与节点1的水平位移。\n- **最终答案格式：** 以关于 $a$、$b$ 和 $\\nu$ 的封闭形式代数表达式报告无量纲标量 $\\widehat{K}_{11}\\equiv \\frac{K_{11}}{E\\,t}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是有限元法应用于线性弹性的标准练习，是计算力学和生物力学的基石。所有原理都是公认的。\n- **适定性：** 该问题提供了所有必要信息：几何形状、材料属性、运动学关系和数值方法。目标明确。隐含了标准的逆时针节点编号约定，使节点1成为位于 $(-\\frac{a}{2}, -\\frac{b}{2})$ 的顶点，对应于 $(\\xi, \\eta) = (-1, -1)$。这导出了一个唯一的、明确定义的解。\n- **客观性：** 问题使用工程和数学领域的精确、标准术语进行陈述。它没有模糊性和主观性。\n\n**步骤3：结论与行动**\n问题被认为是有效的。详细解答如下。\n\n### 解答推导\n\n单元刚度矩阵 $\\mathbf{K}$ 通过 $\\mathbf{f} = \\mathbf{K} \\mathbf{d}$ 将节点力向量 $\\mathbf{f}$ 与节点位移向量 $\\mathbf{d}$ 联系起来。使用虚功原理，厚度为 $t$ 的平面应变单元的刚度矩阵由单元面积 $A$ 上的积分给出：\n$$ \\mathbf{K} = t \\int_{A} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, dA $$\n其中 $\\mathbf{B}$ 是应变-位移矩阵，$\\mathbf{C}$ 是本构矩阵。积分在自然坐标系 $(\\xi, \\eta)$ 中使用等参映射进行计算。\n$$ \\mathbf{K} = t \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}^T(\\xi, \\eta) \\mathbf{C} \\mathbf{B}(\\xi, \\eta) \\det(\\mathbf{J}) \\, d\\xi d\\eta $$\n这里，$\\mathbf{J}$ 是坐标变换的雅可比矩阵。\n\n节点位移向量的顺序为 $\\mathbf{d} = \\{u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4\\}^T$。我们寻求分量 $K_{11}$，它将力 $f_{x1}$ 与位移 $u_1$ 耦合起来。这对应于 $8 \\times 8$ 刚度矩阵的 $(1,1)$ 项。$K_{11}$ 可以通过仅考虑 $\\mathbf{B}$ 矩阵的第一列来计算，我们将其表示为 $\\mathbf{b}_1$。\n$$ K_{11} = t \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{b}_1^T \\mathbf{C} \\mathbf{b}_1 \\det(\\mathbf{J}) \\, d\\xi d\\eta $$\n\n**1. 等参映射与雅可比矩阵**\n物理坐标 $(x,y)$ 通过以下方式从自然坐标 $(\\xi, \\eta)$ 映射而来：\n$$ x = \\frac{a}{2}\\xi, \\quad y = \\frac{b}{2}\\eta $$\n此映射的雅可比矩阵 $\\mathbf{J}$ 是：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{a}{2} & 0 \\\\ 0 & \\frac{b}{2} \\end{pmatrix} $$\n雅可比矩阵在整个单元上是常数。其行列式为 $\\det(\\mathbf{J}) = \\frac{ab}{4}$。逆雅可比矩阵是：\n$$ \\mathbf{J}^{-1} = \\begin{pmatrix} \\frac{2}{a} & 0 \\\\ 0 & \\frac{2}{b} \\end{pmatrix} $$\n\n**2. 形函数与导数**\n对于双线性四边形单元，节点1（位于 $(\\xi, \\eta) = (-1,-1)$）的形函数是：\n$$ N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) $$\n关于自然坐标的导数是：\n$$ \\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi) $$\n关于物理坐标的导数使用逆雅可比矩阵求得：\n$$ \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial \\xi} \\\\ \\frac{\\partial N_1}{\\partial \\eta} \\end{Bmatrix} = \\begin{pmatrix} \\frac{2}{a} & 0 \\\\ 0 & \\frac{2}{b} \\end{pmatrix} \\begin{Bmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1-\\xi) \\end{Bmatrix} = \\begin{Bmatrix} -\\frac{1}{2a}(1-\\eta) \\\\ -\\frac{1}{2b}(1-\\xi) \\end{Bmatrix} $$\n\n**3. 应变-位移向量 $\\mathbf{b}_1$**\n应变向量为 $\\boldsymbol{\\varepsilon} = \\{\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\}^T$。列向量 $\\mathbf{b}_1$ 将应变分量与节点位移 $u_1$ 联系起来：\n$$ \\mathbf{b}_1 = \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{Bmatrix} = \\begin{Bmatrix} -\\frac{1}{2a}(1-\\eta) \\\\ 0 \\\\ -\\frac{1}{2b}(1-\\xi) \\end{Bmatrix} $$\n\n**4. 平面应变的本构矩阵 $\\mathbf{C}$**\n对于平面应变条件下的线性各向同性材料，应力-应变关系 $\\boldsymbol{\\sigma} = \\mathbf{C} \\boldsymbol{\\varepsilon}$ 由以下矩阵定义：\n$$ \\mathbf{C} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & \\frac{1-2\\nu}{2} \\end{pmatrix} $$\n与我们计算相关的分量是 $C_{11} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$ 和剪切模量项 $C_{33} = \\frac{E(1-2\\nu)}{2(1+\\nu)(1-2\\nu)} = \\frac{E}{2(1+\\nu)}$。\n\n**5. 被积函数计算**\n被积函数中的二次型是 $\\mathbf{b}_1^T \\mathbf{C} \\mathbf{b}_1$：\n$$ \\mathbf{b}_1^T \\mathbf{C} \\mathbf{b}_1 = C_{11} \\left(\\frac{\\partial N_1}{\\partial x}\\right)^2 + C_{33} \\left(\\frac{\\partial N_1}{\\partial y}\\right)^2 $$\n代入导数：\n$$ \\mathbf{b}_1^T \\mathbf{C} \\mathbf{b}_1 = C_{11} \\left(-\\frac{1}{2a}(1-\\eta)\\right)^2 + C_{33} \\left(-\\frac{1}{2b}(1-\\xi)\\right)^2 = \\frac{C_{11}}{4a^2}(1-\\eta)^2 + \\frac{C_{33}}{4b^2}(1-\\xi)^2 $$\n\n**6. 积分**\n我们现在在父单元域 $[-1,1] \\times [-1,1]$ 上对该表达式进行积分。\n$$ K_{11} = t \\det(\\mathbf{J}) \\int_{-1}^{1} \\int_{-1}^{1} \\left[ \\frac{C_{11}}{4a^2}(1-\\eta)^2 + \\frac{C_{33}}{4b^2}(1-\\xi)^2 \\right] d\\xi d\\eta $$\n积分中的两项是可分的。我们计算标准积分：\n$$ \\int_{-1}^{1} (1-z)^2 dz = \\int_{-1}^{1} (1-2z+z^2) dz = \\left[z - z^2 + \\frac{z^3}{3}\\right]_{-1}^{1} = \\left(1-1+\\frac{1}{3}\\right) - \\left(-1-1-\\frac{1}{3}\\right) = \\frac{1}{3} - \\left(-\\frac{7}{3}\\right) = \\frac{8}{3} $$\n积分变为：\n$$ K_{11} = t \\left(\\frac{ab}{4}\\right) \\left[ \\frac{C_{11}}{4a^2} \\int_{-1}^{1}d\\xi \\int_{-1}^{1}(1-\\eta)^2 d\\eta + \\frac{C_{33}}{4b^2} \\int_{-1}^{1}(1-\\xi)^2 d\\xi \\int_{-1}^{1}d\\eta \\right] $$\n$$ K_{11} = t \\frac{ab}{4} \\left[ \\frac{C_{11}}{4a^2}(2)\\left(\\frac{8}{3}\\right) + \\frac{C_{33}}{4b^2}\\left(\\frac{8}{3}\\right)(2) \\right] = t \\frac{ab}{4} \\left[ \\frac{4C_{11}}{3a^2} + \\frac{4C_{33}}{3b^2} \\right] $$\n$$ K_{11} = \\frac{tab}{3} \\left( \\frac{C_{11}}{a^2} + \\frac{C_{33}}{b^2} \\right) = \\frac{t}{3} \\left( \\frac{b}{a}C_{11} + \\frac{a}{b}C_{33} \\right) $$\n\n**7. 最终无量纲表达式**\n代入 $C_{11}$ 和 $C_{33}$ 的表达式：\n$$ K_{11} = \\frac{t}{3} \\left( \\frac{b}{a} \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} + \\frac{a}{b} \\frac{E}{2(1+\\nu)} \\right) $$\n问题要求无量纲刚度 $\\widehat{K}_{11} = \\frac{K_{11}}{Et}$：\n$$ \\widehat{K}_{11} = \\frac{1}{3E} \\left( \\frac{b}{a} \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} + \\frac{a}{b} \\frac{E}{2(1+\\nu)} \\right) $$\n$$ \\widehat{K}_{11} = \\frac{1}{3} \\left( \\frac{b}{a} \\frac{1-\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{a}{b} \\frac{1}{2(1+\\nu)} \\right) $$\n提出公因子以获得单一的前置因子：\n$$ \\widehat{K}_{11} = \\frac{1}{6(1+\\nu)(1-2\\nu)} \\left( \\frac{2b}{a}(1-\\nu) + \\frac{a}{b}(1-2\\nu) \\right) $$\n这就是无量纲刚度系数的最终封闭形式表达式。",
            "answer": "$$\\boxed{\\frac{1}{6(1+\\nu)(1-2\\nu)} \\left( \\frac{2b(1-\\nu)}{a} + \\frac{a(1-2\\nu)}{b} \\right)}$$"
        },
        {
            "introduction": "当使用标准有限元单元模拟如软组织等近乎不可压缩的材料时，会出现一种称为“体积自锁”的数值伪影，导致结果过于刚硬且不准确。本练习将介绍 B-bar 方法，这是一种通过修改体积应变的计算方式来修正此问题的常用技术 。对于在生物力学模拟中，当近乎不可压缩性是材料的关键特性时，这项动手实践对于获得物理上有意义的解至关重要。",
            "id": "4185739",
            "problem": "考虑一个用于软组织补片的二维小应变线性弹性公式，该模型使用有限元法 (FEM)，在平面应变条件下采用单个双线性四节点四边形单元（通常称为 $Q4$ 单元）进行建模。物理单元是一个单位正方形，其角节点位于 $(0,0)$、$(1,0)$、$(1,1)$ 和 $(0,1)$，按逆时针顺序标记为 $1$ 到 $4$。设节点位移分量为 $\\{u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}, u_{4x}, u_{4y}\\}$。小应变张量由位移的对称梯度定义，而体积应变是小应变张量的迹，等于位移场的散度。\n\n在标准的等阶位移单元中，近乎不可压缩的组织行为（例如，泊松比接近 $0.5$）会表现出体积锁定现象，因为离散化对体积模式施加了过度约束。一种解决方法是被称为 B-bar 法的修正应变-位移公式，该方法将应变的体积分量替换为在单元上向低阶子空间的投影，以在保持偏响应的同时放宽体积约束。\n\n从小的应变定义和在母坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 上通过双线性形函数进行的位移插值（仿射映射到单位正方形）出发，通过将单元常数投影体积应变定义为位移散度的面积平均值来构建 B-bar 法。明确展示此投影如何修改体积应变，并通过减少伪体积刚度贡献来证明其对锁定现象的缓解作用。\n\n然后，对于上述单位正方形单元，使用在单元面积上的精确积分，而不依赖于数值积分，计算单元平均体积应变 $\\bar{\\epsilon}_{\\text{vol}}$ 的闭式表达式，作为节点位移分量 $\\{u_{ix},u_{iy}\\}$ 的线性组合。以 $\\{u_{ix},u_{iy}\\}$ 的单一解析表达式形式提供最终答案，所有系数均为精确分数形式。无需四舍五入。由于应变为无量纲，因此不需要物理单位。",
            "solution": "其基本依据是连续介质力学中的小应变定义和标准的基于位移的有限元插值。在小应变体系中，应变张量 $\\boldsymbol{\\epsilon}$ 由下式给出\n$$\n\\boldsymbol{\\epsilon} = \\frac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\top}\\right),\n$$\n其体积部分，即体积应变，是 $\\boldsymbol{\\epsilon}$ 的迹：\n$$\n\\epsilon_{\\text{vol}} = \\operatorname{tr}(\\boldsymbol{\\epsilon}) = \\nabla \\cdot \\mathbf{u}.\n$$\n在平面应变条件下，位移分量为 $\\mathbf{u} = [u_x, u_y]^{\\top}$，则有\n$$\n\\epsilon_{\\text{vol}} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y}.\n$$\n\n在一个标准的双线性四节点四边形 ($Q4$) 单元中，位移场插值如下\n$$\n\\mathbf{u}(x,y) = \\sum_{i=1}^{4} N_i(x,y)\\,\\mathbf{d}_i,\n$$\n其中 $\\mathbf{d}_i = [u_{ix}, u_{iy}]^{\\top}$ 是节点位移向量，$N_i$ 是定义在母空间 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 并映射到物理单元上的双线性形函数。对于单位正方形，其映射为仿射映射：\n$$\nx = \\frac{1+\\xi}{2}, \\quad y = \\frac{1+\\eta}{2}, \\quad \\text{with} \\quad dA = \\frac{1}{4}\\,d\\xi\\,d\\eta, \\quad A = 1.\n$$\n母空间上的标准 $Q4$ 形函数为\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\n插值位移的散度为\n$$\n\\nabla \\cdot \\mathbf{u} = \\sum_{i=1}^{4} \\left( \\frac{\\partial N_i}{\\partial x} u_{ix} + \\frac{\\partial N_i}{\\partial y} u_{iy} \\right).\n$$\n\n当离散化对近乎不可压缩的材料有效施加不切实际的刚性体积约束时，就会出现体积锁定。B-bar 法通过将体积应变投影到低阶子空间（通常是单元上的常数）来修改体积应变，以降低体积约束的秩，从而在保持一致性的同时放宽伪刚度。在单元上为常数的投影体积应变由到常数空间的 $L^{2}$-投影定义：\n$$\n\\bar{\\epsilon}_{\\text{vol}} = \\frac{1}{A} \\int_{A} \\nabla \\cdot \\mathbf{u}\\, dA.\n$$\n偏应变保持不变，因此用于本构响应的修正应变可以写为\n$$\n\\boldsymbol{\\epsilon}_{\\text{B-bar}} = \\boldsymbol{\\epsilon}_{\\text{dev}} + \\frac{1}{2}\\bar{\\epsilon}_{\\text{vol}}\\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix}\n= \\left( \\boldsymbol{\\epsilon} - \\frac{1}{2}\\epsilon_{\\text{vol}}\\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix} \\right) + \\frac{1}{2}\\bar{\\epsilon}_{\\text{vol}}\\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix},\n$$\n这在算子层面上对应于用其投影算子替换应变-位移矩阵的体积部分，同时保持偏算子不变。这减少了对体积变形模式的伪约束，并通过确保单元的体积响应由最低阶的一致模式（在单元上为常数）表示来缓解锁定，这类似于每个单元压力场为常数的稳定化混合格式。\n\n为了显式计算单位正方形 $Q4$ 单元的 $\\bar{\\epsilon}_{\\text{vol}}$，我们使用仿射映射关系。导数变换如下\n$$\n\\frac{\\partial N_i}{\\partial x} = \\frac{\\partial N_i}{\\partial \\xi}\\frac{\\partial \\xi}{\\partial x} + \\frac{\\partial N_i}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial x} = 2\\,\\frac{\\partial N_i}{\\partial \\xi}, \\quad\n\\frac{\\partial N_i}{\\partial y} = 2\\,\\frac{\\partial N_i}{\\partial \\eta},\n$$\n因为对于单位正方形映射，$x$ 仅依赖于 $\\xi$，$y$ 仅依赖于 $\\eta$，且 $\\frac{\\partial \\xi}{\\partial x} = \\frac{\\partial \\eta}{\\partial y} = 2$。\n\n面积平均值为\n$$\n\\bar{\\epsilon}_{\\text{vol}} = \\frac{1}{A}\\int_{A} \\sum_{i=1}^{4}\\left( \\frac{\\partial N_i}{\\partial x} u_{ix} + \\frac{\\partial N_i}{\\partial y} u_{iy} \\right) dA\n= \\sum_{i=1}^{4}\\left( \\frac{1}{A}\\int_{A} \\frac{\\partial N_i}{\\partial x} dA \\right) u_{ix}\n+ \\sum_{i=1}^{4}\\left( \\frac{1}{A}\\int_{A} \\frac{\\partial N_i}{\\partial y} dA \\right) u_{iy}.\n$$\n由于 $A=1$，我们计算积分\n$$\nI_i^{x} = \\int_{A} \\frac{\\partial N_i}{\\partial x}\\, dA = \\int_{-1}^{1}\\int_{-1}^{1} \\left(2\\,\\frac{\\partial N_i}{\\partial \\xi}\\right)\\left(\\frac{1}{4}\\right)\\, d\\xi\\, d\\eta\n= \\frac{1}{2}\\int_{-1}^{1}\\int_{-1}^{1} \\frac{\\partial N_i}{\\partial \\xi}\\, d\\xi\\, d\\eta,\n$$\n$$\nI_i^{y} = \\int_{A} \\frac{\\partial N_i}{\\partial y}\\, dA = \\frac{1}{2}\\int_{-1}^{1}\\int_{-1}^{1} \\frac{\\partial N_i}{\\partial \\eta}\\, d\\xi\\, d\\eta.\n$$\n在母坐标中使用微积分基本定理，\n$$\n\\int_{-1}^{1} \\frac{\\partial N_i}{\\partial \\xi}\\, d\\xi = N_i(\\xi=1,\\eta) - N_i(\\xi=-1,\\eta), \\quad\n\\int_{-1}^{1} \\frac{\\partial N_i}{\\partial \\eta}\\, d\\eta = N_i(\\xi,\\eta=1) - N_i(\\xi,\\eta=-1).\n$$\n对每个节点进行计算：\n- 对于节点 $1$，$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$:\n$$\nN_1(1,\\eta) = 0, \\quad N_1(-1,\\eta) = \\frac{1}{2}(1-\\eta) \\;\\Rightarrow\\; \\int_{-1}^{1} \\frac{\\partial N_1}{\\partial \\xi} d\\xi = -\\frac{1}{2}(1-\\eta).\n$$\n因此\n$$\nI_1^{x} = \\frac{1}{2} \\int_{-1}^{1} \\left[ -\\frac{1}{2}(1-\\eta) \\right] d\\eta = -\\frac{1}{2}.\n$$\n类似地，\n$$\nN_1(\\xi,1) = 0, \\quad N_1(\\xi,-1) = \\frac{1}{2}(1-\\xi) \\;\\Rightarrow\\; \\int_{-1}^{1} \\frac{\\partial N_1}{\\partial \\eta} d\\eta = -\\frac{1}{2}(1-\\xi),\n$$\n并且\n$$\nI_1^{y} = \\frac{1}{2} \\int_{-1}^{1} \\left[ -\\frac{1}{2}(1-\\xi) \\right] d\\xi = -\\frac{1}{2}.\n$$\n- 对于节点 $2$，$N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$:\n$$\nN_2(1,\\eta) = \\frac{1}{2}(1-\\eta), \\quad N_2(-1,\\eta) = 0 \\;\\Rightarrow\\; I_2^{x} = +\\frac{1}{2},\n$$\n$$\nN_2(\\xi,1) = 0, \\quad N_2(\\xi,-1) = \\frac{1}{2}(1+\\xi) \\;\\Rightarrow\\; I_2^{y} = -\\frac{1}{2}.\n$$\n- 对于节点 $3$，$N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$:\n$$\nN_3(1,\\eta) = \\frac{1}{2}(1+\\eta), \\quad N_3(-1,\\eta) = 0 \\;\\Rightarrow\\; I_3^{x} = +\\frac{1}{2},\n$$\n$$\nN_3(\\xi,1) = \\frac{1}{2}(1+\\xi), \\quad N_3(\\xi,-1) = 0 \\;\\Rightarrow\\; I_3^{y} = +\\frac{1}{2}.\n$$\n- 对于节点 $4$，$N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$:\n$$\nN_4(1,\\eta) = 0, \\quad N_4(-1,\\eta) = \\frac{1}{2}(1+\\eta) \\;\\Rightarrow\\; I_4^{x} = -\\frac{1}{2},\n$$\n$$\nN_4(\\xi,1) = \\frac{1}{2}(1-\\xi), \\quad N_4(\\xi,-1) = 0 \\;\\Rightarrow\\; I_4^{y} = +\\frac{1}{2}.\n$$\n\n因此，单元平均体积应变为\n$$\n\\bar{\\epsilon}_{\\text{vol}} = I_1^{x} u_{1x} + I_2^{x} u_{2x} + I_3^{x} u_{3x} + I_4^{x} u_{4x}\n+ I_1^{y} u_{1y} + I_2^{y} u_{2y} + I_3^{y} u_{3y} + I_4^{y} u_{4y},\n$$\n化简为\n$$\n\\bar{\\epsilon}_{\\text{vol}} = -\\frac{1}{2}u_{1x} + \\frac{1}{2}u_{2x} + \\frac{1}{2}u_{3x} - \\frac{1}{2}u_{4x}\n-\\frac{1}{2}u_{1y} - \\frac{1}{2}u_{2y} + \\frac{1}{2}u_{3y} + \\frac{1}{2}u_{4y}.\n$$\n\n该表达式是由双线性位移场隐含的体积应变在单元内为常数的投影。在 B-bar 法中，这个 $\\bar{\\epsilon}_{\\text{vol}}$ 在本构评估中取代了点态体积应变，而偏应变部分保留了其标准的 $B$ 矩阵贡献。因为 $\\bar{\\epsilon}_{\\text{vol}}$ 是到常数空间的 $L^{2}$ 投影，它降低了体积约束的秩，防止单元人为地抑制容许的体积模式，从而消除了近乎不可压缩组织的体积锁定所特有的伪刚度。\n\n$\\bar{\\epsilon}_{\\text{vol}}$ 的最终解析表达式如上所述。",
            "answer": "$$\\boxed{-\\frac{1}{2}u_{1x}+\\frac{1}{2}u_{2x}+\\frac{1}{2}u_{3x}-\\frac{1}{2}u_{4x}-\\frac{1}{2}u_{1y}-\\frac{1}{2}u_{2y}+\\frac{1}{2}u_{3y}+\\frac{1}{2}u_{4y}}$$"
        },
        {
            "introduction": "非线性分析对于准确捕捉生物组织的复杂力学行为是不可或缺的。这项计算练习深入探讨了牛顿-拉弗森法 (Newton-Raphson method) 的收敛特性，该方法是非线性有限元分析的主要求解器 。通过比较使用精确 (一致) 切线和数值近似切线的求解器性能，您将深刻体会到为何一致性线性化对于非线性模拟的效率和稳健性至关重要。",
            "id": "4185707",
            "problem": "考虑一个组织条的一维有限元（FE）模型，该模型由一个参考长度为 $L$、横截面积为 $A$ 的两节点轴向单元表示。左侧节点固定，因此唯一的未知量是右侧节点的轴向位移 $u$（单位：米）。该材料被建模为超弹性组织，其单位体积的应变能密度 $W(\\varepsilon)$ 取决于工程应变 $\\varepsilon = u/L$。内应力 $\\sigma(\\varepsilon)$ 由 $\\sigma(\\varepsilon) = \\dfrac{dW}{d\\varepsilon}$ 定义，右侧节点的节点内力为 $F_{\\text{int}}(u) = A \\,\\sigma(\\varepsilon)$（单位：牛顿）。施加在右侧节点的外力是一个给定的标量 $F$（单位：牛顿），因此标量残差为 $R(u) = F_{\\text{int}}(u) - F$。\n\n你必须实现牛顿法来求解标量平衡方程 $R(u) = 0$，从初始猜测值 $u_0 = 0$ 开始，停止准则为 $|R(u_k)| \\le \\text{tol}$，其中 $\\text{tol}$ 是给定的容差（单位：牛顿）。为了研究一致线性化的必要性，你必须使用两种类型的切线（雅可比）近似来运行牛顿法：\n- 一致切线 $K_{\\text{cons}}(u) = \\dfrac{dR}{du}$，通过解析计算得出。\n- 数值微分切线 $K_{\\text{fd}}(u) \\approx \\dfrac{R(u+h) - R(u-h)}{2h}$，使用中心有限差分和指定的步长 $h$（单位：米）计算。\n\n从基本定义和平衡方程开始：\n- 工程应变为 $\\varepsilon(u) = u/L$。\n- 内应力为 $\\sigma(\\varepsilon) = \\dfrac{dW}{d\\varepsilon}$。\n- 节点内力为 $F_{\\text{int}}(u) = A \\,\\sigma(\\varepsilon(u))$。\n- 残差为 $R(u) = A \\,\\sigma(\\varepsilon(u)) - F$。\n- 一致切线为 $K_{\\text{cons}}(u) = \\dfrac{dR}{du} = \\dfrac{A}{L}\\,\\sigma'(\\varepsilon(u))$，其中 $\\sigma'(\\varepsilon) = \\dfrac{d\\sigma}{d\\varepsilon}$。\n\n使用组织应变能密度\n$$\nW(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^2 + c\\left(e^{b \\varepsilon^2} - 1\\right),\n$$\n其中 $E$（单位：帕斯卡）是线性弹性模量，$c$（单位：帕斯卡）是非线性刚度标度，$b$（无量纲）控制非线性程度。那么\n$$\n\\sigma(\\varepsilon) = E \\varepsilon + 2 c b \\varepsilon e^{b \\varepsilon^2},\n$$\n$$\n\\sigma'(\\varepsilon) = E + 2 c b e^{b \\varepsilon^2} + 4 c b^2 \\varepsilon^2 e^{b \\varepsilon^2}.\n$$\n\n使用 $K_{\\text{cons}}$ 或 $K_{\\text{fd}}$ 实现牛顿法更新 $u_{k+1} = u_k - \\dfrac{R(u_k)}{K(u_k)}$。在迭代过程中记录绝对残差序列 $\\{|R(u_k)|\\}_{k=0}^{N}$。使用最后三个残差 $r_{k-2}$、$r_{k-1}$、$r_k$ 估计观测到的局部收敛阶 $p$：\n$$\np \\approx \\frac{\\ln\\left(\\dfrac{r_k}{r_{k-1}}\\right)}{\\ln\\left(\\dfrac{r_{k-1}}{r_{k-2}}\\right)},\n$$\n当至少有三个残差可用且均为严格正数时使用此公式。如果可用残差少于三个，则设 $p = 2.0$。\n\n测试套件：\n使用以下三个测试案例（所有量均采用国际单位制：米、牛顿、帕斯卡）：\n- 案例1（线性，小载荷）：$L = 0.1$, $A = 1.0\\times 10^{-4}$, $E = 1.0\\times 10^{4}$, $c = 0.0$, $b = 5.0$, $F = 0.01$。\n- 案例2（中度非线性）：$L = 0.1$, $A = 1.0\\times 10^{-4}$, $E = 5.0\\times 10^{3}$, $c = 1.0\\times 10^{3}$, $b = 5.0$, $F = 0.2$。\n- 案例3（强非线性）：$L = 0.1$, $A = 1.0\\times 10^{-4}$, $E = 5.0\\times 10^{3}$, $c = 5.0\\times 10^{3}$, $b = 10.0$, $F = 1.0$。\n\n用于数值微分的有限差分步长：\n- $h_1 = 1.0\\times 10^{-9}$, $h_2 = 1.0\\times 10^{-6}$, $h_3 = 1.0\\times 10^{-3}$。\n\n求解器设置：\n- 初始猜测值 $u_0 = 0.0$。\n- 容差 $\\text{tol} = 1.0\\times 10^{-12}$（单位：牛顿）。\n- 最大迭代次数 $N_{\\text{max}} = 50$。\n\n对于每个测试案例，运行牛顿法四次：一次使用一致切线，另外三次分别使用 $h_1$、$h_2$ 和 $h_3$ 的有限差分切线。对于每次运行，报告：\n- 首次满足 $|R(u_k)| \\le \\text{tol}$ 所需的迭代次数整数 $N$（如果在最大迭代次数内未满足，则为 $N_{\\text{max}}$）。\n- 根据上述定义的残差历史计算出的浮点估计阶数 $p$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表。条目必须按测试案例排序，在每个测试案例中按切线选择排序，格式如下：\n$[\\;N_{\\text{cons}}, N_{h_1}, N_{h_2}, N_{h_3}, p_{\\text{cons}}, p_{h_1}, p_{h_2}, p_{h_3}\\;]$\n用于案例1，紧随其后的是案例2的相同八个数字，然后是案例3。也就是说，一个包含24个数字的扁平列表，代表迭代次数和观测到的阶数。所有迭代次数均为整数，所有阶数均为浮点数。不涉及角度，也不打印位移和力；仅输出指定的整数和浮点数。",
            "solution": "在给出解决方案之前，需对问题进行验证。\n\n### 步骤1：提取给定信息\n- **模型几何**：一维、两节点轴向单元，参考长度为 $L$，横截面积为 $A$。\n- **边界条件**：左侧节点固定。在右侧节点施加一个外部轴向力 $F$。\n- **未知量**：右侧节点的轴向位移 $u$。\n- **运动学**：工程应变 $\\varepsilon = u/L$。\n- **材料模型**：超弹性组织，其单位体积应变能密度为 $W(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^2 + c\\left(e^{b \\varepsilon^2} - 1\\right)$，其中 $E$ 是线性弹性模量，$c$ 是非线性刚度标度，$b$ 是无量纲的非线性参数。\n- **本构关系**：\n    - 内应力：$\\sigma(\\varepsilon) = \\dfrac{dW}{d\\varepsilon} = E \\varepsilon + 2 c b \\varepsilon e^{b \\varepsilon^2}$。\n    - 切线模量：$\\sigma'(\\varepsilon) = \\dfrac{d\\sigma}{d\\varepsilon} = E + 2 c b e^{b \\varepsilon^2} + 4 c b^2 \\varepsilon^2 e^{b \\varepsilon^2}$。\n- **有限元公式**：\n    - 节点内力：$F_{\\text{int}}(u) = A \\,\\sigma(\\varepsilon(u))$。\n    - 残差（平衡方程）：$R(u) = F_{\\text{int}}(u) - F = 0$。\n- **数值方法**：牛顿法求解标量方程 $R(u) = 0$。\n    - 迭代更新：$u_{k+1} = u_k - \\dfrac{R(u_k)}{K(u_k)}$。\n    - 初始猜测值：$u_0 = 0$。\n    - 停止准则：$|R(u_k)| \\le \\text{tol}$，其中 $\\text{tol} = 1.0 \\times 10^{-12}$ N。\n    - 最大迭代次数：$N_{\\text{max}} = 50$。\n- **切线（雅可比）公式**：\n    - 一致切线：$K_{\\text{cons}}(u) = \\dfrac{dR}{du} = \\dfrac{A}{L}\\,\\sigma'(\\varepsilon(u))$。\n    - 数值微分切线：$K_{\\text{fd}}(u) \\approx \\dfrac{R(u+h) - R(u-h)}{2h}$，使用中心有限差分，步长为 $h_1 = 1.0\\times 10^{-9}$ m, $h_2 = 1.0\\times 10^{-6}$ m, 和 $h_3 = 1.0\\times 10^{-3}$ m。\n- **性能评估**：\n    - 迭代次数 $N$。\n    - 估计的收敛阶 $p \\approx \\frac{\\ln(r_k/r_{k-1})}{\\ln(r_{k-1}/r_{k-2})}$，使用最后三个绝对残差，其中 $r_k = |R(u_k)|$。如果可用残差少于三个，则 $p=2.0$。\n- **测试案例（国际单位制）**：\n    - 案例1：$L=0.1, A=10^{-4}, E=10^4, c=0.0, b=5.0, F=0.01$。\n    - 案例2：$L=0.1, A=10^{-4}, E=5\\times 10^3, c=10^3, b=5.0, F=0.2$。\n    - 案例3：$L=0.1, A=10^{-4}, E=5\\times 10^3, c=5\\times 10^3, b=10.0, F=1.0$。\n\n### 步骤2：使用提取的给定信息进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于连续介质力学和非线性有限元分析的标准原理。超弹性本构模型是对生物组织的简化但有效的表示。所有数学推导都是正确的。\n- **良态问题**：该问题是一个定义明确的标量求根问题。所有必要的参数、初始条件和求解过程都已明确提供。材料属性使得刚度为正，表明对于给定的载荷存在唯一解。\n- **客观性**：问题使用精确的数学语言和数值进行陈述，没有任何主观性或歧义。\n- **缺陷清单**：该问题不违反任何列出的无效标准。这是一个科学上合理、完整且可形式化的问题，与计算生物力学直接相关。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个解决方案。\n\n### 基于原理的解决方案与算法设计\n\n问题的核心是求解未知位移 $u$ 的非线性标量平衡方程 $R(u)=0$。该方程表示组织中产生的内力与外部施加的力之间的平衡。\n\n内力源自超弹性本构模型，其中应力是应变能密度函数 $W$ 对应变 $\\varepsilon$ 的导数。给定的形式 $W(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^2 + c\\left(e^{b \\varepsilon^2} - 1\\right)$ 是对在较高应变下表现出刚化响应的材料的常见表示，这是许多软生物组织的特征。项 $\\tfrac{1}{2} E \\varepsilon^2$ 代表线性弹性，而指数项引入了由参数 $c$ 和 $b$ 控制的非线性。\n\n控制方程为 $R(u) = A\\,\\sigma(u/L) - F = 0$。由于该方程在 $u$ 上是非线性的（当 $c \\neq 0$ 时），需要一种迭代数值方法。牛顿法（也称为牛顿-拉夫逊法）是解决此类问题的强大技术，它基于逐次求解问题的线性化版本。\n\n从初始猜测值 $u_k$ 开始，函数 $R(u)$ 通过其在 $u_k$ 附近的一阶泰勒展开来近似：\n$$R(u) \\approx R(u_k) + \\left.\\frac{dR}{du}\\right|_{u_k} (u - u_k)$$\n我们寻求 $u = u_{k+1}$ 使得 $R(u_{k+1})=0$。将近似值设为零，得到：\n$$0 = R(u_k) + K(u_k) (u_{k+1} - u_k)$$\n其中 $K(u_k) = \\left.\\frac{dR}{du}\\right|_{u_k}$ 是切线刚度（在多维情况下称为雅可比矩阵）。解出下一个迭代值 $u_{k+1}$，得到牛顿更新法则：\n$$u_{k+1} = u_k - \\frac{R(u_k)}{K(u_k)}$$\n该过程从 $u_0 = 0$ 开始，重复进行，直到残差的量级 $|R(u_k)|$ 小于指定的容差 $\\text{tol}$。\n\n牛顿法的一个关键方面是计算切线刚度 $K(u)$。\n**一致切线**是残差对未知量的精确解析导数：\n$$K_{\\text{cons}}(u) = \\frac{dR}{du} = \\frac{d}{du} \\left[ A\\,\\sigma(\\varepsilon(u)) - F \\right]$$\n使用链式法则，并注意到 $\\varepsilon(u) = u/L$，因此 $d\\varepsilon/du = 1/L$：\n$$K_{\\text{cons}}(u) = A \\frac{d\\sigma}{d\\varepsilon} \\frac{d\\varepsilon}{du} = \\frac{A}{L} \\sigma'(\\varepsilon(u))$$\n其中 $\\sigma'(\\varepsilon)$ 是问题陈述中给出的切线模量。当使用精确切线时，牛顿法在解的邻域内表现出二次收敛（$p=2$），这意味着解的正确位数在每次迭代中大约翻倍。\n\n问题还要求使用通过有限差分获得的**数值切线**来近似导数：\n$$K_{\\text{fd}}(u) \\approx \\frac{R(u+h) - R(u-h)}{2h}$$\n这是一个二阶中心差分近似。使用近似切线将牛顿法转化为拟牛顿法。由于 $K_{\\text{fd}}(u)$ 不是精确导数，二次收敛的特性会丧失。收敛速率会降至线性（$p=1$）。近似的准确性取决于步长 $h$。\n- 如果 $h$ 非常小（例如 $h_1 = 10^{-9}$），数值切线非常接近一致切线。收敛可能看起来接近二次，但最终会受到浮点精度的限制，这可能会引入舍入误差，从而污染导数计算。\n- 如果 $h$ 很大（例如 $h_3 = 10^{-3}$），有限差分公式的截断误差会变得显著，使得 $K_{\\text{fd}}$ 成为 $K_{\\text{cons}}$ 的一个较差近似。这会导致较慢的线性收敛速率，需要更多迭代才能达到解。\n- 中间的 $h$（例如 $h_2 = 10^{-6}$）通常在截断误差和舍入误差之间提供良好的平衡。\n\n待实现的算法将对三个测试案例中的每一个执行以下操作：\n1.  用 $u_0 = 0.0$，$\\text{tol} = 10^{-12}$ 和 $N_{\\text{max}} = 50$ 初始化求解器。\n2.  运行牛顿法求解器四次，每次对应一种切线选择：$K_{\\text{cons}}$，以及使用 $h_1, h_2, h_3$ 的 $K_{\\text{fd}}$。\n3.  在每次运行中，迭代牛顿更新，在每一步 $k=0, 1, 2, ...$ 存储绝对残差 $|R(u_k)|$。\n4.  当 $|R(u_k)| \\le \\text{tol}$ 或 $k=N_{\\text{max}}$ 时终止。记录迭代次数 $N=k$。\n5.  终止后，使用存储的残差历史记录，根据提供的公式计算观测到的收敛阶 $p$，并应用针对残差少于三个情况的指定规则。\n6.  收集所有运行得到的 $N$ 和 $p$ 值，并按要求将它们格式化为单个列表。",
            "answer": "[1,1,1,1,2.0,2.0,2.0,2.0,4,4,4,6,1.996773,1.996773,1.344445,1.000001,5,5,5,12,1.986381,1.986381,1.488057,1.000029]"
        }
    ]
}