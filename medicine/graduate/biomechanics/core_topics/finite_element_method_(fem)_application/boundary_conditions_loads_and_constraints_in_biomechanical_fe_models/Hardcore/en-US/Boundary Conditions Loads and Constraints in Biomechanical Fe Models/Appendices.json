{
    "hands_on_practices": [
        {
            "introduction": "In finite element analysis, continuous physical loads like pressure must be converted into discrete nodal forces. This exercise demonstrates the principle of consistent load vector integration, a fundamental technique to accurately translate a uniform surface pressure into an equivalent set of forces at the element's nodes . Mastering this conversion is essential for correctly modeling physiological loading conditions, such as synovial fluid pressure on cartilage or contact forces in joints.",
            "id": "4162011",
            "problem": "A three-dimensional biomechanical Finite Element (FE) model of an acetabular cartilage patch includes a triangular boundary surface where a uniform compressive pressure is applied to represent synovial fluid loading. The triangular surface element is linear (three-node) and lies on the boundary of the solid, with global node coordinates given in meters as follows: node $1$ at $(0, 0, 0)$, node $2$ at $(0.04, 0, 0)$, and node $3$ at $(0, 0.03, 0.02)$. The outward unit normal to the surface is defined by the right-hand rule consistent with the node ordering $(1 \\rightarrow 2 \\rightarrow 3)$, i.e., proportional to the cross product of the edge vectors from node $1$ to node $2$ and from node $1$ to node $3$, and then normalized.\n\nA uniform compressive pressure of magnitude $p = 60\\,\\text{kPa}$ acts inward on the surface (i.e., the traction vector is opposite to the outward unit normal). Using the principle of virtual work and consistent load vector integration for surface tractions in the Finite Element Method (FEM), compute the equivalent global nodal force vector for this triangular surface element by integrating the traction weighted by the linear triangular shape functions over the element area.\n\nAssume standard linear triangular shape functions on the surface, and express the final stacked nodal force vector as $(f_{1x}, f_{1y}, f_{1z}, f_{2x}, f_{2y}, f_{2z}, f_{3x}, f_{3y}, f_{3z})$ in Newtons. If your result requires approximation, round components to four significant figures. Otherwise, present exact values. The final answer must be given as a single row matrix.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided.\n\n**Step 1: Extract Givens**\n- Element Type: $3$-node linear triangular surface element.\n- Global Node Coordinates (meters):\n  - Node $1$: $P_1 = (0, 0, 0)$\n  - Node $2$: $P_2 = (0.04, 0, 0)$\n  - Node $3$: $P_3 = (0, 0.03, 0.02)$\n- Outward Unit Normal: Defined by the cross product of edge vectors from node $1$ to $2$ and node $1$ to $3$, consistent with the right-hand rule for the sequence $(1 \\rightarrow 2 \\rightarrow 3)$.\n- Loading: Uniform compressive pressure $p = 60\\,\\text{kPa}$.\n- Traction: The traction vector $\\vec{t}$ acts inward, hence $\\vec{t} = -p\\vec{n}$, where $\\vec{n}$ is the outward unit normal.\n- Method: Calculation of the consistent nodal force vector via integration of surface tractions weighted by shape functions.\n- Output: A $9 \\times 1$ stacked vector of nodal forces $(f_{1x}, f_{1y}, f_{1z}, f_{2x}, f_{2y}, f_{2z}, f_{3x}, f_{3y}, f_{3z})$ in Newtons.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, based on standard principles of the Finite Element Method (FEM) applied to biomechanics. The given data (node coordinates, pressure) are physically plausible and mathematically consistent. The problem is well-posed, with sufficient information to determine a unique solution. The language is objective and precise. Therefore, the problem is deemed valid.\n\n**Step 3: Solution Procedure**\n\nThe equivalent nodal force vector, $\\vec{f}$, for a surface element subjected to a traction field $\\vec{t}$ is given by the principle of virtual work as:\n$$\n\\vec{f} = \\int_A \\mathbf{N}^T \\vec{t} \\, dA\n$$\nwhere $A$ is the area of the element and $\\mathbf{N}$ is the matrix of shape functions. For a $3$-node element in three-dimensional space, the shape function matrix is:\n$$\n\\mathbf{N} = \\begin{bmatrix} N_1 & 0 & 0 & N_2 & 0 & 0 & N_3 & 0 & 0 \\\\ 0 & N_1 & 0 & 0 & N_2 & 0 & 0 & N_3 & 0 \\\\ 0 & 0 & N_1 & 0 & 0 & N_2 & 0 & 0 & N_3 \\end{bmatrix}\n$$\n$N_1$, $N_2$, and $N_3$ are the scalar linear shape functions for nodes $1$, $2$, and $3$. The traction vector $\\vec{t}$ is given as uniform (constant) over the surface. Therefore, it can be taken out of the integral:\n$$\n\\vec{f} = \\left( \\int_A \\mathbf{N}^T \\, dA \\right) \\vec{t}\n$$\nThe integral of the transposed shape function matrix evaluates to:\n$$\n\\int_A \\mathbf{N}^T \\, dA = \\int_A \\begin{bmatrix} N_1 \\mathbf{I} \\\\ N_2 \\mathbf{I} \\\\ N_3 \\mathbf{I} \\end{bmatrix} dA = \\begin{bmatrix} (\\int_A N_1 dA) \\mathbf{I} \\\\ (\\int_A N_2 dA) \\mathbf{I} \\\\ (\\int_A N_3 dA) \\mathbf{I} \\end{bmatrix}\n$$\nwhere $\\mathbf{I}$ is the $3 \\times 3$ identity matrix. A fundamental property of linear triangular shape functions is that the integral of any shape function $N_i$ over the element's area $A$ is $\\frac{A}{3}$.\n$$\n\\int_A N_i \\, dA = \\frac{A}{3} \\quad \\text{for } i=1, 2, 3\n$$\nThis means the total applied force on the element, $\\vec{F}_{\\text{total}} = \\vec{t}A$, is distributed equally among the three nodes. The force vector at each node $i$ is:\n$$\n\\vec{f}_i = \\frac{A}{3}\\vec{t} = \\frac{1}{3} \\vec{F}_{\\text{total}}\n$$\nTo find the nodal forces, we must first compute the total force vector $\\vec{F}_{\\text{total}}$. This requires calculating the element's area $A$ and the traction vector $\\vec{t}$.\n\n**A. Calculate Geometric Properties (Area and Normal Vector)**\n\nFirst, define the edge vectors originating from node $1$:\n$$\n\\vec{v}_{12} = P_2 - P_1 = (0.04-0, 0-0, 0-0) = (0.04, 0, 0) \\, \\text{m}\n$$\n$$\n\\vec{v}_{13} = P_3 - P_1 = (0-0, 0.03-0, 0.02-0) = (0, 0.03, 0.02) \\, \\text{m}\n$$\nThe normal vector to the surface, consistent with the right-hand rule for the sequence $(1 \\rightarrow 2 \\rightarrow 3)$, is proportional to the cross product $\\vec{v}_{12} \\times \\vec{v}_{13}$:\n$$\n\\vec{N}_{\\text{un-norm}} = \\vec{v}_{12} \\times \\vec{v}_{13} = \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\ 0.04 & 0 & 0 \\\\ 0 & 0.03 & 0.02 \\end{vmatrix}\n$$\n$$\n\\vec{N}_{\\text{un-norm}} = \\mathbf{i}(0 \\cdot 0.02 - 0 \\cdot 0.03) - \\mathbf{j}(0.04 \\cdot 0.02 - 0 \\cdot 0) + \\mathbf{k}(0.04 \\cdot 0.03 - 0 \\cdot 0)\n$$\n$$\n\\vec{N}_{\\text{un-norm}} = (0, -0.0008, 0.0012) \\, \\text{m}^2\n$$\nThe area of the triangle, $A$, is half the magnitude of this cross product vector:\n$$\nA = \\frac{1}{2} |\\vec{N}_{\\text{un-norm}}| = \\frac{1}{2} \\sqrt{0^2 + (-0.0008)^2 + (0.0012)^2}\n$$\n$$\nA = \\frac{1}{2} \\sqrt{6.4 \\times 10^{-7} + 1.44 \\times 10^{-6}} = \\frac{1}{2} \\sqrt{2.08 \\times 10^{-6}} = \\frac{\\sqrt{208 \\times 10^{-8}}}{2} = \\frac{10^{-4}\\sqrt{16 \\times 13}}{2} = \\frac{4\\sqrt{13} \\times 10^{-4}}{2}\n$$\n$$\nA = 2\\sqrt{13} \\times 10^{-4} \\, \\text{m}^2\n$$\nThe outward unit normal vector $\\vec{n}$ is found by normalizing $\\vec{N}_{\\text{un-norm}}$:\n$$\n\\vec{n} = \\frac{\\vec{N}_{\\text{un-norm}}}{|\\vec{N}_{\\text{un-norm}}|} = \\frac{(0, -0.0008, 0.0012)}{2A} = \\frac{(0, -0.0008, 0.0012)}{4\\sqrt{13} \\times 10^{-4}} = \\frac{10^{-4}(0, -8, 12)}{4\\sqrt{13} \\times 10^{-4}} = \\frac{1}{\\sqrt{13}}(0, -2, 3)\n$$\n\n**B. Calculate Total Force**\n\nThe applied pressure is $p = 60\\,\\text{kPa} = 60 \\times 10^3 \\, \\text{N/m}^2$. The pressure is compressive, so the traction vector $\\vec{t}$ acts inward, opposite to the outward unit normal $\\vec{n}$:\n$$\n\\vec{t} = -p\\vec{n} = -(60 \\times 10^3) \\frac{1}{\\sqrt{13}}(0, -2, 3) = \\frac{60 \\times 10^3}{\\sqrt{13}}(0, 2, -3) \\, \\text{N/m}^2\n$$\nThe total force vector on the element is $\\vec{F}_{\\text{total}} = A \\times \\vec{t}$:\n$$\n\\vec{F}_{\\text{total}} = (2\\sqrt{13} \\times 10^{-4}) \\times \\left( \\frac{60 \\times 10^3}{\\sqrt{13}}(0, 2, -3) \\right) \\, \\text{N}\n$$\nThe $\\sqrt{13}$ terms cancel out:\n$$\n\\vec{F}_{\\text{total}} = (2 \\times 10^{-4}) \\times (60 \\times 10^3) \\times (0, 2, -3) \\, \\text{N}\n$$\n$$\n\\vec{F}_{\\text{total}} = (120 \\times 10^{-1}) \\times (0, 2, -3) \\, \\text{N} = 12 \\times (0, 2, -3) \\, \\text{N}\n$$\n$$\n\\vec{F}_{\\text{total}} = (0, 24, -36) \\, \\text{N}\n$$\n\n**C. Distribute Force to Nodes**\n\nThe total force is distributed equally among the three nodes:\n$$\n\\vec{f}_1 = \\vec{f}_2 = \\vec{f}_3 = \\frac{1}{3} \\vec{F}_{\\text{total}} = \\frac{1}{3}(0, 24, -36) \\, \\text{N} = (0, 8, -12) \\, \\text{N}\n$$\nEach nodal force vector has components $(f_{ix}, f_{iy}, f_{iz})$:\n- Force at node $1$: $(f_{1x}, f_{1y}, f_{1z}) = (0, 8, -12) \\, \\text{N}$\n- Force at node $2$: $(f_{2x}, f_{2y}, f_{2z}) = (0, 8, -12) \\, \\text{N}$\n- Force at node $3$: $(f_{3x}, f_{3y}, f_{3z}) = (0, 8, -12) \\, \\text{N}$\n\nThe final assembled global nodal force vector is the concatenation of these three vectors. The components are exact integers, so no rounding is necessary.\n$$\n\\vec{f} = (0, 8, -12, 0, 8, -12, 0, 8, -12)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 8 & -12 & 0 & 8 & -12 & 0 & 8 & -12 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A finite element model that is not sufficiently constrained possesses non-physical rigid body motions, rendering its stiffness matrix singular and the system unsolvable. This practice guides you through the crucial process of identifying these rigid body modes and applying a minimal set of constraints to eliminate them, ensuring a unique and stable solution . This is a core competency for building robust and reliable biomechanical models from scratch.",
            "id": "4161989",
            "problem": "Consider small-strain linear elasticity for soft biological tissue modeled by Finite Element (FE) analysis. The global stiffness matrix arises from the Principle of Virtual Work, which for linear materials states that the weak form leads to a discrete system $K u = f$, where $K$ is the global stiffness matrix assembled from element contributions, $u$ is the global displacement vector, and $f$ is the global load vector. In the absence of Dirichlet constraints (essential boundary conditions), the system is underconstrained and $K$ is singular due to rigid body motions.\n\nYou must construct the stiffness matrix by assembling element stiffnesses based on standard linear elasticity. Use the following foundational relations:\n\n- For two-dimensional (2D) plane stress with isotropic material, the constitutive matrix is\n$$\nD = \\frac{E}{1-\\nu^2} \\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\nwhere $E$ is Young's modulus in Pascals and $\\nu$ is Poisson's ratio. For a constant-strain triangle with nodes at coordinates $(x_i,y_i)$ for $i=1,2,3$, the strain-displacement matrix $B$ is constant and given by\n$$\nB = \\frac{1}{2A}\n\\begin{bmatrix}\ny_2 - y_3 & 0 & y_3 - y_1 & 0 & y_1 - y_2 & 0 \\\\\n0 & x_3 - x_2 & 0 & x_1 - x_3 & 0 & x_2 - x_1 \\\\\nx_3 - x_2 & y_2 - y_3 & x_1 - x_3 & y_3 - y_1 & x_2 - x_1 & y_1 - y_2\n\\end{bmatrix},\n$$\nwith triangle area\n$$\nA = \\frac{1}{2} \\left| \\det \\begin{bmatrix} 1 & x_1 & y_1 \\\\ 1 & x_2 & y_2 \\\\ 1 & x_3 & y_3 \\end{bmatrix} \\right|.\n$$\nFor thickness $t$ in meters, the element stiffness is\n$$\nk_e = t \\, A \\, B^\\top D B.\n$$\n\n- For three-dimensional (3D) isotropic linear elasticity, define the Lamé parameters\n$$\n\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}, \\quad G = \\frac{E}{2(1+\\nu)},\n$$\nand the constitutive matrix\n$$\nC =\n\\begin{bmatrix}\n\\lambda+2G & \\lambda & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda+2G & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda & \\lambda+2G & 0 & 0 & 0 \\\\\n0 & 0 & 0 & G & 0 & 0 \\\\\n0 & 0 & 0 & 0 & G & 0 \\\\\n0 & 0 & 0 & 0 & 0 & G\n\\end{bmatrix}.\n$$\nFor a linear tetrahedral element with nodes at $(x_i,y_i,z_i)$ for $i=1,2,3,4$, define the matrix\n$$\nM = \\begin{bmatrix}\n1 & x_1 & y_1 & z_1 \\\\\n1 & x_2 & y_2 & z_2 \\\\\n1 & x_3 & y_3 & z_3 \\\\\n1 & x_4 & y_4 & z_4\n\\end{bmatrix}, \\quad C_M = M^{-1}.\n$$\nThe shape function for node $j$ is $N_j(x,y,z) = C_{M,0j} + C_{M,1j} x + C_{M,2j} y + C_{M,3j} z$, and its gradient is $\\nabla N_j = \\begin{bmatrix} C_{M,1j} & C_{M,2j} & C_{M,3j} \\end{bmatrix}^\\top$. The strain-displacement matrix $B$ is constant and assembled from $\\nabla N_j$ in Voigt order $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx})$ as\n$$\nB = \\begin{bmatrix}\n\\partial_x N_1 & 0 & 0 & \\partial_x N_2 & 0 & 0 & \\partial_x N_3 & 0 & 0 & \\partial_x N_4 & 0 & 0 \\\\\n0 & \\partial_y N_1 & 0 & 0 & \\partial_y N_2 & 0 & 0 & \\partial_y N_3 & 0 & 0 & \\partial_y N_4 & 0 \\\\\n0 & 0 & \\partial_z N_1 & 0 & 0 & \\partial_z N_2 & 0 & 0 & \\partial_z N_3 & 0 & 0 & \\partial_z N_4 \\\\\n\\partial_y N_1 & \\partial_x N_1 & 0 & \\partial_y N_2 & \\partial_x N_2 & 0 & \\partial_y N_3 & \\partial_x N_3 & 0 & \\partial_y N_4 & \\partial_x N_4 & 0 \\\\\n0 & \\partial_z N_1 & \\partial_y N_1 & 0 & \\partial_z N_2 & \\partial_y N_2 & 0 & \\partial_z N_3 & \\partial_y N_3 & 0 & \\partial_z N_4 & \\partial_y N_4 \\\\\n\\partial_z N_1 & 0 & \\partial_x N_1 & \\partial_z N_2 & 0 & \\partial_x N_2 & \\partial_z N_3 & 0 & \\partial_x N_3 & \\partial_z N_4 & 0 & \\partial_x N_4\n\\end{bmatrix}.\n$$\nLet the element volume be\n$$\nV = \\frac{1}{6} \\left| \\det \\begin{bmatrix}\nx_2-x_1 & x_3-x_1 & x_4-x_1 \\\\\ny_2-y_1 & y_3-y_1 & y_4-y_1 \\\\\nz_2-z_1 & z_3-z_1 & z_4-z_1\n\\end{bmatrix} \\right|.\n$$\nThen the element stiffness is\n$$\nk_e = V \\, B^\\top C B.\n$$\n\nThe global stiffness matrix $K$ is assembled by summing the element contributions into the appropriate global degrees of freedom.\n\nRigid body motions form the null space of $K$ in the absence of essential boundary conditions. For a mesh with node coordinates $\\{r_i\\}$, construct a basis for rigid body displacements $R$ as follows:\n\n- In $2\\text{D}$ (two dimensions), use three columns:\n$$\nt_x = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ \\cdots \\end{bmatrix}, \\quad\nt_y = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ \\cdots \\end{bmatrix}, \\quad\nr_z = \\begin{bmatrix} -y_1 \\\\ x_1 \\\\ -y_2 \\\\ x_2 \\\\ \\cdots \\end{bmatrix}.\n$$\n\n- In $3\\text{D}$ (three dimensions), use six columns:\n$$\nt_x, \\ t_y, \\ t_z \\text{ where } t_x = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ \\cdots \\end{bmatrix}, \\ t_y = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ \\cdots \\end{bmatrix}, \\ t_z = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ \\cdots \\end{bmatrix},\n$$\nand rotations about the axes obtained by $v_i = \\omega \\times r_i$ for unit vectors $\\omega$ aligned with the Cartesian axes, that is,\n$$\nr_x: v_i = \\begin{bmatrix} 0 \\\\ -z_i \\\\ y_i \\end{bmatrix}, \\quad\nr_y: v_i = \\begin{bmatrix} z_i \\\\ 0 \\\\ -x_i \\end{bmatrix}, \\quad\nr_z: v_i = \\begin{bmatrix} -y_i \\\\ x_i \\\\ 0 \\end{bmatrix}.\n$$\n\nYour tasks are:\n1. Assemble the global stiffness matrix $K$ for each provided test mesh from the element stiffnesses $k_e$.\n2. Compute the null space dimension of $K$ using Singular Value Decomposition (SVD). Use a numerical tolerance defined as $\\tau = \\alpha \\, \\sigma_{\\max} \\, n$, where $\\sigma_{\\max}$ is the largest singular value of $K$, $n$ is $\\max(n_{\\text{rows}}, n_{\\text{cols}})$, and $\\alpha = 10^{-9}$.\n3. Construct the rigid body motion matrix $R$ per the definitions above.\n4. Choose a minimal set of Dirichlet constraints by selecting $n_{\\text{rbm}}$ global degrees of freedom (rows of $R$) such that the submatrix of $R$ restricted to these rows has full column rank $n_{\\text{rbm}}$. Implement this selection by column-pivoted $QR$ decomposition of $R^\\top$ to pick the first $n_{\\text{rbm}}$ pivot indices as constrained degrees of freedom.\n5. Apply the constraints by eliminating the constrained degrees of freedom from $K$ (i.e., form the reduced matrix $K_{ff}$ corresponding to the unconstrained degrees of freedom with homogeneous essential boundary conditions).\n6. Compute the null space dimension of $K_{ff}$ using the same SVD-based tolerance.\n\nNote carefully:\n- All physical quantities must be in the International System of Units (SI). Young’s modulus $E$ must be in Pascals, coordinates in meters, and thickness $t$ in meters.\n- There are no angle computations requiring units; rigid rotations are parameterized by unit axial vectors and do not use explicit angle values.\n\nTest Suite:\nProvide the following test cases to your program:\n\n- Case 1 (2D single triangle, plane stress): $E = 5.0 \\times 10^4$ Pa, $\\nu = 0.45$, $t = 2.0 \\times 10^{-3}$ m, nodes $\\{(0.0, 0.0), (1.0, 0.0), (0.0, 1.0)\\}$, one element with connectivity $(0,1,2)$.\n\n- Case 2 (2D square split into two triangles, plane stress): $E = 1.0 \\times 10^5$ Pa, $\\nu = 0.45$, $t = 2.0 \\times 10^{-3}$ m, nodes $\\{(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)\\}$, elements $(0,1,2)$ and $(0,2,3)$.\n\n- Case 3 (3D single tetrahedron): $E = 1.0 \\times 10^5$ Pa, $\\nu = 0.45$, nodes $\\{(0.0, 0.0, 0.0), (1.0, 0.0, 0.0), (0.0, 1.0, 0.0), (0.0, 0.0, 1.0)\\}$, one element with connectivity $(0,1,2,3)$.\n\nAnswer Specification:\nFor each test case, output a list containing:\n- The integer null space dimension of $K$ before applying constraints.\n- The integer null space dimension of the reduced matrix $K_{ff}$ after applying the selected minimal constraints.\n- The list of constrained global degree-of-freedom indices (integers) actually chosen by the algorithm, in ascending order.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case is represented as $[d_{\\text{before}}, d_{\\text{after}}, [i_1, i_2, \\dots]]$. For example: $[[3,0,[0,1,3]], [3,0,[0,1,4]], [6,0,[0,1,2,3,4,5]]]$. The numerical outputs are unitless integers and index lists.",
            "solution": "The user's request is to validate and solve a problem from the field of computational biomechanics, specifically involving the Finite Element (FE) analysis of linearly elastic materials. This requires assembling a global stiffness matrix, analyzing its properties, and applying constraints to ensure a unique solution exists. The problem is deemed valid as it is scientifically grounded in the principles of continuum mechanics and the Finite Element Method, is well-posed with a clear and complete set of instructions, and uses standard, verifiable mathematical formulations.\n\nThe solution proceeds by implementing the specified tasks in a step-by-step manner, grounded in the following principles.\n\n1.  **Finite Element Formulation and Element Stiffness**\n\nThe foundation of the FE method for linear static analysis is the Principle of Virtual Work, which, when discretized, leads to the linear system $K u = f$. In this system, $K$ represents the global stiffness matrix, $u$ is the vector of unknown nodal displacements, and $f$ is the vector of applied nodal forces. The global stiffness matrix $K$ is constructed by assembling individual element stiffness matrices, $k_e$.\n\nFor an element occupying a volume $V_e$, the stiffness matrix is given by the integral:\n$$\nk_e = \\int_{V_e} B^\\top D B \\, dV\n$$\nwhere $B$ is the strain-displacement matrix and $D$ is the material constitutive matrix (also denoted as $C$ in $3\\text{D}$).\n\nFor the simple element types specified—the constant-strain triangle (CST) in $2\\text{D}$ and the linear tetrahedron in $3\\text{D}$—the matrix $B$ is constant within each element. This simplifies the integral to a multiplication: $k_e = (A \\cdot t) B^\\top D B$ for a $2\\text{D}$ element of area $A$ and thickness $t$, and $k_e = V B^\\top C B$ for a $3\\text{D}$ element of volume $V$.\n\n**For $2\\text{D}$ Plane Stress:** The problem provides the standard constitutive matrix $D$ for an isotropic material under plane stress conditions:\n$$\nD = \\frac{E}{1-\\nu^2} \\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\nwhere $E$ is the Young's modulus and $\\nu$ is the Poisson's ratio. The strain-displacement matrix $B$ for a CST element is also given, derived from the linear shape functions that interpolate displacement within the triangle. It relates the three engineering strains $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})$ to the six nodal displacements $(u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y})$.\n\n**For $3\\text{D}$ Elasticity:** The constitutive matrix $C$ for an isotropic material is given in terms of the Lamé parameters $\\lambda$ and $G$:\n$$\n\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}, \\quad G = \\frac{E}{2(1+\\nu)}\n$$\nThe strain-displacement matrix $B$ for a linear tetrahedral element is derived from the gradients of its four linear shape functions, $N_j(x,y,z)$. Each shape function $N_j$ is a linear polynomial whose coefficients are determined by the condition that $N_j$ is equal to $1$ at node $j$ and $0$ at all other nodes. As defined in the problem, these coefficients for all four shape functions can be found by inverting a matrix $M$ constructed from the nodal coordinates. The matrix $B$ relates the six engineering strains in Voigt notation to the $12$ nodal displacements of the tetrahedron.\n\n2.  **Assembly of the Global Stiffness Matrix**\n\nThe global stiffness matrix $K$ for the entire mesh is formed by summing the contributions from all element stiffness matrices $k_e$. This process, often called assembly, involves mapping the local degrees of freedom (DOFs) of each element to their corresponding global DOFs. For a system with $N_{nodes}$ nodes and $d$ DOFs per node (where $d=2$ in $2\\text{D}$ and $d=3$ in $3\\text{D}$), the size of $K$ is $(N_{nodes} \\cdot d) \\times (N_{nodes} \\cdot d)$. An entry $K_{ij}$ of the global matrix represents the force at global DOF $i$ due to a unit displacement at global DOF $j$.\n\n3.  **Rigid Body Modes and Singularity of $K$**\n\nIn the absence of any prescribed displacement constraints (Dirichlet boundary conditions), the structure is free to translate and rotate as a rigid body. These motions, known as rigid body modes (RBMs), induce no deformation, and therefore no strain or stress. Mathematically, if $u_{rbm}$ is a displacement vector corresponding to a rigid body motion, then the resulting strain is zero: $\\varepsilon = B u_{rbm} = 0$. Consequently, the strain energy is also zero, and the product $K u_{rbm}$ is a zero vector. This means that any $u_{rbm}$ is a vector in the null space of $K$. A matrix with a non-trivial null space is singular (i.e., its determinant is zero, and it is not invertible).\n\nIn $2\\text{D}$, there are $n_{rbm}=3$ rigid body modes: two translations ($t_x, t_y$) and one rotation ($r_z$). In $3\\text{D}$, there are $n_{rbm}=6$: three translations ($t_x, t_y, t_z$) and three rotations ($r_x, r_y, r_z$). The problem provides the explicit construction of a basis for the null space, forming the columns of a matrix $R$. The dimension of the null space of $K$ for an unconstrained, connected body is equal to $n_{rbm}$. This is verified by computing the numerical rank of $K$ using Singular Value Decomposition (SVD). The number of singular values close to zero (relative to a defined tolerance) gives the dimension of the null space.\n\n4.  **Imposing Constraints to Remove Singularity**\n\nTo obtain a unique solution for the displacement vector $u$, the singularity of $K$ must be removed. This is physically equivalent to anchoring the body to prevent rigid motion. A minimal set of constraints involves fixing just enough DOFs to suppress all RBMs. The number of constraints required is $n_{rbm}$.\n\nThe selection of these DOFs is critical: they must collectively constrain all RBMs. An effective method to choose these DOFs is to analyze the RBM matrix $R$. The rows of $R$ correspond to the global DOFs. To ensure all RBMs (columns of $R$) are constrained, we must select a set of $n_{rbm}$ rows from $R$ that are linearly independent. A numerically robust way to identify such a set of rows is to perform a column-pivoted QR decomposition on the transpose of $R$, denoted $R^\\top$. The algorithm greedily selects columns of $R^\\top$ (which are rows of $R$) that are maximally independent of the previously selected ones. The indices of the first $n_{rbm}$ pivot columns chosen by the algorithm correspond to a suitable set of DOFs to constrain.\n\n5.  **Formation of the Reduced System**\n\nOnce the constraint DOFs are chosen, we apply homogeneous Dirichlet boundary conditions by setting their displacements to zero. This corresponds to partitioning the global system $K u = f$ based on free ($f$) and constrained ($c$) DOFs:\n$$\n\\begin{bmatrix} K_{ff} & K_{fc} \\\\ K_{cf} & K_{cc} \\end{bmatrix}\n\\begin{bmatrix} u_f \\\\ u_c \\end{bmatrix}\n=\n\\begin{bmatrix} f_f \\\\ f_c \\end{bmatrix}\n$$\nWith $u_c = 0$, the system for the free DOFs becomes:\n$$\nK_{ff} u_f = f_f\n$$\nThe matrix $K_{ff}$ is the reduced stiffness matrix. If the constraints have successfully eliminated all RBMs, $K_{ff}$ will be non-singular (invertible), and the system will have a unique solution for $u_f$. This is verified by again computing the SVD of $K_{ff}$ and checking that its null space dimension is zero.",
            "answer": "[[3,0,[0,1,3]],[3,0,[0,1,4]],[6,0,[0,1,2,3,4,5]]]"
        },
        {
            "introduction": "Biomechanical loads, such as ground reaction forces during walking, are inherently variable and subject to measurement uncertainty. This advanced exercise introduces the principles of uncertainty propagation, showing how to translate the statistical properties of an uncertain input load into a probabilistic prediction of the model's output displacement . By computing confidence intervals for displacements, you will learn to create more realistic and clinically relevant model predictions that account for real-world variability.",
            "id": "4161973",
            "problem": "Consider a static, linear Finite Element Method (FEM) model of the human foot. After imposing essential (Dirichlet) boundary conditions that fix the calcaneus and relevant hindfoot degrees of freedom, the reduced stiffness matrix $K \\in \\mathbb{R}^{n \\times n}$ relates the nodal displacement vector $u \\in \\mathbb{R}^{n}$ in millimeters (mm) to the applied ground reaction force (GRF) vector $f \\in \\mathbb{R}^{n}$ in Newtons (N) under quasi-static equilibrium through the linear system $K u = f$. The GRF is uncertain due to gait variability, contact condition variability, and measurement noise, and is modeled as a multivariate normal random vector $f \\sim \\mathcal{N}(\\mu_f, \\Sigma_f)$, where $\\mu_f$ is the mean force vector and $\\Sigma_f$ is the force covariance matrix that encodes cross-correlations across boundary nodes and directions.\n\nYour task is to propagate boundary load uncertainty from $f$ through the reduced FEM system to the displacement $u$, and then compute a two-sided $95$ confidence interval for a specified displacement component $u_j$ in millimeters (mm). Use a derivation that starts from fundamental principles: static equilibrium, linear elasticity, and the properties of linear transformations of random variables. Do not introduce any external empirical shortcuts or pre-derived propagation formulas that are not justified from these principles.\n\nPhysical units must be respected as follows: $K$ is in N/mm, $f$ is in N, and $u$ is in mm. Express all final confidence interval bounds in millimeters (mm), rounded to three decimal places. Angles, if any, are not involved in this problem. Do not use percentage signs; the confidence level $95$ should be treated as a decimal confidence specification deriving from the standard normal quantile.\n\nImplement a program that, for each test case provided below, computes the lower and upper bounds of the two-sided $95$ confidence interval for the specified displacement component $u_j$ in mm. The test suite covers typical conditions, a deterministic load scenario, and a case with singular (but positive semidefinite) load covariance to test robustness under constrained uncertainty.\n\nTest Suite:\n1. Case A (happy path, three degrees of freedom):\n   - Reduced stiffness matrix $K_1$ (N/mm):\n     $$K_1 = \\begin{bmatrix}\n     8000 & -1200 & 0 \\\\\n     -1200 & 9000 & -1500 \\\\\n     0 & -1500 & 7000\n     \\end{bmatrix}$$\n   - Mean GRF vector $\\mu_{f1}$ (N):\n     $$\\mu_{f1} = \\begin{bmatrix} 120 \\\\ 100 \\\\ 80 \\end{bmatrix}$$\n   - GRF covariance $\\Sigma_{f1}$ ($\\text{N}^2$):\n     $$\\Sigma_{f1} = \\begin{bmatrix}\n     400 & 100 & 0 \\\\\n     100 & 300 & 50 \\\\\n     0 & 50 & 200\n     \\end{bmatrix}$$\n   - Displacement component index $j_1 = 1$ (zero-based indexing).\n2. Case B (deterministic load, two degrees of freedom):\n   - Reduced stiffness matrix $K_2$ (N/mm):\n     $$K_2 = \\begin{bmatrix}\n     10000 & -2000 \\\\\n     -2000 & 8000\n     \\end{bmatrix}$$\n   - Mean GRF vector $\\mu_{f2}$ (N):\n     $$\\mu_{f2} = \\begin{bmatrix} 200 \\\\ 200 \\end{bmatrix}$$\n   - GRF covariance $\\Sigma_{f2}$ ($\\text{N}^2$):\n     $$\\Sigma_{f2} = \\begin{bmatrix}\n     0 & 0 \\\\\n     0 & 0\n     \\end{bmatrix}$$\n   - Displacement component index $j_2 = 0$ (zero-based indexing).\n3. Case C (singular covariance, four degrees of freedom):\n   - Reduced stiffness matrix $K_3$ (N/mm):\n     $$K_3 = \\begin{bmatrix}\n     15000 & -3000 & 0 & 0 \\\\\n     -3000 & 12000 & -2500 & 0 \\\\\n     0 & -2500 & 11000 & -2000 \\\\\n     0 & 0 & -2000 & 9000\n     \\end{bmatrix}$$\n   - Mean GRF vector $\\mu_{f3}$ (N):\n     $$\\mu_{f3} = \\begin{bmatrix} 150 \\\\ 0 \\\\ 200 \\\\ 50 \\end{bmatrix}$$\n   - GRF covariance $\\Sigma_{f3}$ ($\\text{N}^2$):\n     $$\\Sigma_{f3} = \\begin{bmatrix}\n     0 & 0 & 0 & 0 \\\\\n     0 & 500 & 200 & 0 \\\\\n     0 & 200 & 600 & 0 \\\\\n     0 & 0 & 0 & 0\n     \\end{bmatrix}$$\n   - Displacement component index $j_3 = 2$ (zero-based indexing).\n\nOutput specification:\n- For each case, compute the two-sided $95$ confidence interval bounds for $u_j$ using the standard normal quantile $z$ corresponding to the central coverage $0.95$. Express the two bounds in millimeters (mm), rounded to three decimals.\n- Your program should produce a single line of output containing the three case results as a comma-separated list of sublists, each sublist holding the lower and upper bounds. The format must be exactly:\n  $$[[\\ell_1,u_1],[\\ell_2,u_2],[\\ell_3,u_3]]$$\nwhere $\\ell_k$ and $u_k$ are the lower and upper bounds for case $k$, formatted without spaces and with three decimal places in mm.",
            "solution": "We begin from static equilibrium in quasi-static biomechanics: the net internal forces balance the applied external forces at the nodes. Discretizing a linear elastic continuum with the Finite Element Method (FEM) under small strains, homogeneous linear elastic constitutive behavior, and appropriate kinematic constraints yields the algebraic relation $K u = f$, where $K \\in \\mathbb{R}^{n \\times n}$ is the reduced stiffness matrix after imposing essential (Dirichlet) boundary conditions, $u \\in \\mathbb{R}^{n}$ is the displacement vector, and $f \\in \\mathbb{R}^{n}$ is the external nodal force vector. Units are consistent with $[K] = \\text{N/mm}$, $[f] = \\text{N}$, and $[u] = \\text{mm}$.\n\nThe ground reaction force (GRF) $f$ is uncertain due to gait variability and contact condition variability. We model $f$ as a multivariate normal random vector:\n$$\nf \\sim \\mathcal{N}(\\mu_f, \\Sigma_f),\n$$\nwith mean $\\mu_f$ and covariance $\\Sigma_f$. Solving the deterministic linear system gives $u = K^{-1} f$. Because $u$ is a linear transformation of a Gaussian random vector $f$, $u$ is also Gaussian. Specifically, if $f$ is Gaussian and $A$ is a deterministic matrix, then $A f$ is Gaussian with mean $A \\mu_f$ and covariance $A \\Sigma_f A^\\top$. Using $A = K^{-1}$, we obtain:\n$$\nu \\sim \\mathcal{N}(\\mu_u, \\Sigma_u), \\quad \\mu_u = K^{-1} \\mu_f, \\quad \\Sigma_u = K^{-1} \\Sigma_f K^{-\\top}.\n$$\n\nFor a specified displacement component index $j$, the scalar $u_j$ is a univariate normal random variable with mean and variance given by the corresponding entries of $\\mu_u$ and $\\Sigma_u$:\n$$\nu_j \\sim \\mathcal{N}\\big(\\mu_u^{(j)}, \\sigma_u^{2 (j)}\\big), \\quad \\text{where } \\mu_u^{(j)} = (\\mu_u)_j, \\; \\sigma_u^{2 (j)} = (\\Sigma_u)_{jj}.\n$$\nA two-sided $95$ confidence interval for $u_j$ is constructed using the standard normal quantile $z$ satisfying $P(|Z| \\le z) = 0.95$, i.e., $z \\approx 1.959964$. The interval is:\n$$\n\\left[\\mu_u^{(j)} - z \\, \\sigma_u^{(j)}, \\; \\mu_u^{(j)} + z \\, \\sigma_u^{(j)}\\right],\n$$\nwhere $\\sigma_u^{(j)} = \\sqrt{(\\Sigma_u)_{jj}}$. In the deterministic case, $\\Sigma_f = 0$, so $\\Sigma_u = 0$, yielding a degenerate interval with both bounds equal to $\\mu_u^{(j)}$.\n\nAlgorithmic steps for each test case:\n1. Read $K$, $\\mu_f$, $\\Sigma_f$, and $j$.\n2. Compute the mean displacement by solving the linear system\n   $$\n   K \\, \\mu_u = \\mu_f \\quad \\Rightarrow \\quad \\mu_u = K^{-1} \\mu_f,\n   $$\n   using a linear solver to avoid explicit matrix inversion.\n3. Compute the displacement covariance without forming $K^{-1}$ explicitly. Use the identity\n   $$\n   \\Sigma_u = K^{-1} \\Sigma_f K^{-\\top}.\n   $$\n   This can be computed with two solves: first solve $K^\\top Y = \\Sigma_f^\\top$ for $Y$, which gives $Y^\\top = \\Sigma_f K^{-\\top}$, then solve $K S = Y^\\top$ to obtain $S = K^{-1} \\Sigma_f K^{-\\top} = \\Sigma_u$.\n4. Extract the scalar variance $(\\Sigma_u)_{jj}$, take its square root to obtain $\\sigma_u^{(j)}$, and compute the interval bounds with $z \\approx 1.959964$.\n5. Round the two bounds to three decimal places and report them in millimeters (mm).\n\nApplying this procedure to the provided test suite yields three pairs of bounds. The program must print a single line containing the three sublists of bounds, formatted without spaces and with three decimals, as:\n$$\n[[\\ell_1,u_1],[\\ell_2,u_2],[\\ell_3,u_3]].\n$$\nThis approach adheres to first principles: static equilibrium ($K u = f$), linear elasticity leading to linear stiffness, and the properties of linear transformations of Gaussian random variables. Constraints are incorporated through the reduced $K$ that reflects Dirichlet boundary conditions at the fixed parts of the foot model.",
            "answer": "[[-0.007,0.065],[0.026,0.026],[0.008,0.043]]"
        }
    ]
}