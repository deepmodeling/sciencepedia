{
    "hands_on_practices": [
        {
            "introduction": "在生物力学有限元模型中，诸如流体压力或接触应力等力通常分布在表面上。为了在有限元分析中使用这些力，我们必须将这些分布载荷转换为作用于网格节点上的等效节点力。该练习  提供了为三角形单元计算这些等效节点力的实践机会，这是准确表示生理载荷的一项基本技能。",
            "id": "4162011",
            "problem": "一个髋臼软骨块的三维生物力学有限元（FE）模型包含一个三角形边界表面，在该表面上施加均匀的压缩压力以表示滑液加载。该三角形表面单元是线性的（三节点），位于实体边界上，其全局节点坐标（单位：米）如下：节点 $1$ 位于 $(0, 0, 0)$，节点 $2$ 位于 $(0.04, 0, 0)$，节点 $3$ 位于 $(0, 0.03, 0.02)$。表面的外向单位法向量由与节点排序 $(1 \\rightarrow 2 \\rightarrow 3)$ 一致的右手定则定义，即与从节点 $1$ 到节点 $2$ 和从节点 $1$ 到节点 $3$ 的边向量的叉积成正比，然后进行归一化。\n\n大小为 $p = 60\\,\\text{kPa}$ 的均匀压缩压力向内作用于表面（即，牵引力向量与外向单位法向量相反）。使用虚功原理和有限元方法（FEM）中用于表面牵引力的一致载荷向量积分，通过在线性三角形形函数加权的单元面积上对牵引力进行积分，计算此三角形表面单元的等效全局节点力向量。\n\n假设表面上为标准线性三角形形函数，并将最终的堆叠节点力向量表示为 $(f_{1x}, f_{1y}, f_{1z}, f_{2x}, f_{2y}, f_{2z}, f_{3x}, f_{3y}, f_{3z})$，单位为牛顿。如果您的结果需要近似，请将分量四舍五入到四位有效数字。否则，请给出精确值。最终答案必须以单行矩阵的形式给出。",
            "solution": "首先验证问题，以确保其科学上合理、适定，并提供了所有必要的信息。\n\n**步骤 1：提取已知条件**\n- 单元类型：$3$ 节点线性三角形表面单元。\n- 全局节点坐标（米）：\n  - 节点 $1$：$P_1 = (0, 0, 0)$\n  - 节点 $2$：$P_2 = (0.04, 0, 0)$\n  - 节点 $3$：$P_3 = (0, 0.03, 0.02)$\n- 外向单位法向量：由从节点 $1$ 到 $2$ 和从节点 $1$ 到 $3$ 的边向量的叉积定义，与序列 $(1 \\rightarrow 2 \\rightarrow 3)$ 的右手定则一致。\n- 载荷：均匀压缩压力 $p = 60\\,\\text{kPa}$。\n- 牵引力：牵引力向量 $\\vec{t}$ 向内作用，因此 $\\vec{t} = -p\\vec{n}$，其中 $\\vec{n}$ 是外向单位法向量。\n- 方法：通过对形函数加权的表面牵引力进行积分，计算一致节点力向量。\n- 输出：一个 $9 \\times 1$ 的堆叠节点力向量 $(f_{1x}, f_{1y}, f_{1z}, f_{2x}, f_{2y}, f_{2z}, f_{3x}, f_{3y}, f_{3z})$，单位为牛顿。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上是合理的，基于应用于生物力学的有限元方法（FEM）的标准原理。给定的数据（节点坐标、压力）在物理上是可信的，在数学上是一致的。该问题是适定的，有足够的信息来确定唯一的解。语言客观而精确。因此，该问题被认为是有效的。\n\n**步骤 3：求解过程**\n\n受到牵引力场 $\\vec{t}$ 作用的表面单元的等效节点力向量 $\\vec{f}$ 由虚功原理给出：\n$$\n\\vec{f} = \\int_A \\mathbf{N}^T \\vec{t} \\, dA\n$$\n其中 $A$ 是单元的面积，$\\mathbf{N}$ 是形函数矩阵。对于三维空间中的一个 $3$ 节点单元，形函数矩阵为：\n$$\n\\mathbf{N} = \\begin{bmatrix} N_1  0  0  N_2  0  0  N_3  0  0 \\\\ 0  N_1  0  0  N_2  0  0  N_3  0 \\\\ 0  0  N_1  0  0  N_2  0  0  N_3 \\end{bmatrix}\n$$\n$N_1$、$N_2$ 和 $N_3$ 是节点 $1$、$2$ 和 $3$ 的标量线性形函数。牵引力向量 $\\vec{t}$ 在表面上是均匀（恒定）的。因此，可以将其从积分中提出：\n$$\n\\vec{f} = \\left( \\int_A \\mathbf{N}^T \\, dA \\right) \\vec{t}\n$$\n转置形函数矩阵的积分计算结果为：\n$$\n\\int_A \\mathbf{N}^T \\, dA = \\int_A \\begin{bmatrix} N_1 \\mathbf{I} \\\\ N_2 \\mathbf{I} \\\\ N_3 \\mathbf{I} \\end{bmatrix} dA = \\begin{bmatrix} (\\int_A N_1 dA) \\mathbf{I} \\\\ (\\int_A N_2 dA) \\mathbf{I} \\\\ (\\int_A N_3 dA) \\mathbf{I} \\end{bmatrix}\n$$\n其中 $\\mathbf{I}$ 是 $3 \\times 3$ 的单位矩阵。线性三角形形函数的一个基本性质是，任何形函数 $N_i$ 在单元面积 $A$ 上的积分都是 $\\frac{A}{3}$。\n$$\n\\int_A N_i \\, dA = \\frac{A}{3} \\quad \\text{for } i=1, 2, 3\n$$\n这意味着施加在单元上的总力 $\\vec{F}_{\\text{total}} = \\vec{t}A$ 被平均分配到三个节点上。每个节点 $i$ 上的力向量为：\n$$\n\\vec{f}_i = \\frac{A}{3}\\vec{t} = \\frac{1}{3} \\vec{F}_{\\text{total}}\n$$\n为了求出节点力，我们必须首先计算总力向量 $\\vec{F}_{\\text{total}}$。这需要计算单元的面积 $A$ 和牵引力向量 $\\vec{t}$。\n\n**A. 计算几何属性（面积和法向量）**\n\n首先，定义从节点 $1$ 出发的边向量：\n$$\n\\vec{v}_{12} = P_2 - P_1 = (0.04-0, 0-0, 0-0) = (0.04, 0, 0) \\, \\text{m}\n$$\n$$\n\\vec{v}_{13} = P_3 - P_1 = (0-0, 0.03-0, 0.02-0) = (0, 0.03, 0.02) \\, \\text{m}\n$$\n与序列 $(1 \\rightarrow 2 \\rightarrow 3)$ 的右手定则一致的表面法向量，与叉积 $\\vec{v}_{12} \\times \\vec{v}_{13}$ 成正比：\n$$\n\\vec{N}_{\\text{un-norm}} = \\vec{v}_{12} \\times \\vec{v}_{13} = \\begin{vmatrix} \\mathbf{i} & \\mathbf{j} & \\mathbf{k} \\\\ 0.04 & 0 & 0 \\\\ 0 & 0.03 & 0.02 \\end{vmatrix}\n$$\n$$\n\\vec{N}_{\\text{un-norm}} = \\mathbf{i}(0 \\cdot 0.02 - 0 \\cdot 0.03) - \\mathbf{j}(0.04 \\cdot 0.02 - 0 \\cdot 0) + \\mathbf{k}(0.04 \\cdot 0.03 - 0 \\cdot 0)\n$$\n$$\n\\vec{N}_{\\text{un-norm}} = (0, -0.0008, 0.0012) \\, \\text{m}^2\n$$\n三角形的面积 $A$ 是该叉积向量大小的一半：\n$$\nA = \\frac{1}{2} |\\vec{N}_{\\text{un-norm}}| = \\frac{1}{2} \\sqrt{0^2 + (-0.0008)^2 + (0.0012)^2}\n$$\n$$\nA = \\frac{1}{2} \\sqrt{6.4 \\times 10^{-7} + 1.44 \\times 10^{-6}} = \\frac{1}{2} \\sqrt{2.08 \\times 10^{-6}} = \\frac{\\sqrt{208 \\times 10^{-8}}}{2} = \\frac{10^{-4}\\sqrt{16 \\times 13}}{2} = \\frac{4\\sqrt{13} \\times 10^{-4}}{2}\n$$\n$$\nA = 2\\sqrt{13} \\times 10^{-4} \\, \\text{m}^2\n$$\n通过对 $\\vec{N}_{\\text{un-norm}}$ 进行归一化，得到外向单位法向量 $\\vec{n}$：\n$$\n\\vec{n} = \\frac{\\vec{N}_{\\text{un-norm}}}{|\\vec{N}_{\\text{un-norm}}|} = \\frac{(0, -0.0008, 0.0012)}{2A} = \\frac{(0, -0.0008, 0.0012)}{4\\sqrt{13} \\times 10^{-4}} = \\frac{10^{-4}(0, -8, 12)}{4\\sqrt{13} \\times 10^{-4}} = \\frac{1}{\\sqrt{13}}(0, -2, 3)\n$$\n\n**B. 计算总力**\n\n施加的压力为 $p = 60\\,\\text{kPa} = 60 \\times 10^3 \\, \\text{N/m}^2$。压力是压缩性的，所以牵引力向量 $\\vec{t}$ 向内作用，与外向单位法向量 $\\vec{n}$ 相反：\n$$\n\\vec{t} = -p\\vec{n} = -(60 \\times 10^3) \\frac{1}{\\sqrt{13}}(0, -2, 3) = \\frac{60 \\times 10^3}{\\sqrt{13}}(0, 2, -3) \\, \\text{N/m}^2\n$$\n单元上的总力向量为 $\\vec{F}_{\\text{total}} = A \\times \\vec{t}$：\n$$\n\\vec{F}_{\\text{total}} = (2\\sqrt{13} \\times 10^{-4}) \\times \\left( \\frac{60 \\times 10^3}{\\sqrt{13}}(0, 2, -3) \\right) \\, \\text{N}\n$$\n$\\sqrt{13}$ 项相互抵消：\n$$\n\\vec{F}_{\\text{total}} = (2 \\times 10^{-4}) \\times (60 \\times 10^3) \\times (0, 2, -3) \\, \\text{N}\n$$\n$$\n\\vec{F}_{\\text{total}} = (120 \\times 10^{-1}) \\times (0, 2, -3) \\, \\text{N} = 12 \\times (0, 2, -3) \\, \\text{N}\n$$\n$$\n\\vec{F}_{\\text{total}} = (0, 24, -36) \\, \\text{N}\n$$\n\n**C. 将力分配到节点**\n\n总力被平均分配到三个节点上：\n$$\n\\vec{f}_1 = \\vec{f}_2 = \\vec{f}_3 = \\frac{1}{3} \\vec{F}_{\\text{total}} = \\frac{1}{3}(0, 24, -36) \\, \\text{N} = (0, 8, -12) \\, \\text{N}\n$$\n每个节点力向量的分量为 $(f_{ix}, f_{iy}, f_{iz})$：\n- 节点 $1$ 上的力： $(f_{1x}, f_{1y}, f_{1z}) = (0, 8, -12) \\, \\text{N}$\n- 节点 $2$ 上的力： $(f_{2x}, f_{2y}, f_{2z}) = (0, 8, -12) \\, \\text{N}$\n- 节点 $3$ 上的力： $(f_{3x}, f_{3y}, f_{3z}) = (0, 8, -12) \\, \\text{N}$\n\n最终组装的全局节点力向量是这三个向量的串联。各分量均为精确整数，因此无需四舍五入。\n$$\n\\vec{f} = (0, 8, -12, 0, 8, -12, 0, 8, -12)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 8 & -12 & 0 & 8 & -12 & 0 & 8 & -12 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在求解有限元模型之前，必须对其施加适当的约束，以防止其作为刚体自由移动或旋转。一个未受约束的模型的刚度矩阵是奇异的，这意味着它没有唯一的解。通过这个编程练习 ，您将学习如何以编程方式识别这些刚体运动模态，并施加所需的最小约束集，以确保系统稳定且可解。",
            "id": "4161989",
            "problem": "考虑通过有限元 (FE) 分析建模的软生物组织的小应变线性弹性。全局刚度矩阵源于虚功原理，对于线性材料，该原理指出其弱形式可导出一个离散系统 $K u = f$，其中 $K$ 是由单元贡献组装而成的全局刚度矩阵，$u$ 是全局位移向量，$f$ 是全局载荷向量。在没有狄利克雷约束（本质边界条件）的情况下，系统是欠约束的，并且由于刚体运动，$K$ 是奇异的。\n\n您必须根据标准线性弹性理论，通过组装单元刚度来构建刚度矩阵。使用以下基本关系：\n\n- 对于二维 (2D) 平面应力下的各向同性材料，其本构矩阵为\n$$\nD = \\frac{E}{1-\\nu^2} \\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\n其中 $E$ 是杨氏模量（单位为帕斯卡），$\\nu$ 是泊松比。对于节点坐标为 $(x_i,y_i)$（$i=1,2,3$）的常应变三角形，其应变-位移矩阵 $B$ 是一个常数，由下式给出\n$$\nB = \\frac{1}{2A}\n\\begin{bmatrix}\ny_2 - y_3 & 0 & y_3 - y_1 & 0 & y_1 - y_2 & 0 \\\\\n0 & x_3 - x_2 & 0 & x_1 - x_3 & 0 & x_2 - x_1 \\\\\nx_3 - x_2 & y_2 - y_3 & x_1 - x_3 & y_3 - y_1 & x_2 - x_1 & y_1 - y_2\n\\end{bmatrix},\n$$\n其中三角形面积为\n$$\nA = \\frac{1}{2} \\left| \\det \\begin{bmatrix} 1 & x_1 & y_1 \\\\ 1 & x_2 & y_2 \\\\ 1 & x_3 & y_3 \\end{bmatrix} \\right|.\n$$\n对于厚度为 $t$（单位为米）的情况，单元刚度为\n$$\nk_e = t \\, A \\, B^\\top D B.\n$$\n\n- 对于三维 (3D) 各向同性线性弹性，定义拉梅参数\n$$\n\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}, \\quad G = \\frac{E}{2(1+\\nu)},\n$$\n以及本构矩阵\n$$\nC =\n\\begin{bmatrix}\n\\lambda+2G & \\lambda & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda+2G & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda & \\lambda+2G & 0 & 0 & 0 \\\\\n0 & 0 & 0 & G & 0 & 0 \\\\\n0 & 0 & 0 & 0 & G & 0 \\\\\n0 & 0 & 0 & 0 & 0 & G\n\\end{bmatrix}.\n$$\n对于节点坐标为 $(x_i,y_i,z_i)$（$i=1,2,3,4$）的线性四面体单元，定义矩阵\n$$\nM = \\begin{bmatrix}\n1 & x_1 & y_1 & z_1 \\\\\n1 & x_2 & y_2 & z_2 \\\\\n1 & x_3 & y_3 & z_3 \\\\\n1 & x_4 & y_4 & z_4\n\\end{bmatrix}, \\quad C_M = M^{-1}.\n$$\n节点 $j$ 的形函数为 $N_j(x,y,z) = C_{M,0j} + C_{M,1j} x + C_{M,2j} y + C_{M,3j} z$，其梯度为 $\\nabla N_j = \\begin{bmatrix} C_{M,1j} & C_{M,2j} & C_{M,3j} \\end{bmatrix}^\\top$。应变-位移矩阵 $B$ 是一个常数，它是根据 $\\nabla N_j$ 以Voigt序 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx})$ 组装而成\n$$\nB = \\begin{bmatrix}\n\\partial_x N_1 & 0 & 0 & \\partial_x N_2 & 0 & 0 & \\partial_x N_3 & 0 & 0 & \\partial_x N_4 & 0 & 0 \\\\\n0 & \\partial_y N_1 & 0 & 0 & \\partial_y N_2 & 0 & 0 & \\partial_y N_3 & 0 & 0 & \\partial_y N_4 & 0 \\\\\n0 & 0 & \\partial_z N_1 & 0 & 0 & \\partial_z N_2 & 0 & 0 & \\partial_z N_3 & 0 & 0 & \\partial_z N_4 \\\\\n\\partial_y N_1 & \\partial_x N_1 & 0 & \\partial_y N_2 & \\partial_x N_2 & 0 & \\partial_y N_3 & \\partial_x N_3 & 0 & \\partial_y N_4 & \\partial_x N_4 & 0 \\\\\n0 & \\partial_z N_1 & \\partial_y N_1 & 0 & \\partial_z N_2 & \\partial_y N_2 & 0 & \\partial_z N_3 & \\partial_y N_3 & 0 & \\partial_z N_4 & \\partial_y N_4 \\\\\n\\partial_z N_1 & 0 & \\partial_x N_1 & \\partial_z N_2 & 0 & \\partial_x N_2 & \\partial_z N_3 & 0 & \\partial_x N_3 & \\partial_z N_4 & 0 & \\partial_x N_4\n\\end{bmatrix}.\n$$\n设单元体积为\n$$\nV = \\frac{1}{6} \\left| \\det \\begin{bmatrix}\nx_2-x_1 & x_3-x_1 & x_4-x_1 \\\\\ny_2-y_1 & y_3-y_1 & y_4-y_1 \\\\\nz_2-z_1 & z_3-z_1 & z_4-z_1\n\\end{bmatrix} \\right|.\n$$\n则单元刚度为\n$$\nk_e = V \\, B^\\top C B.\n$$\n\n全局刚度矩阵 $K$ 是通过将单元贡献累加到相应的全局自由度上组装而成的。\n\n在没有本质边界条件的情况下，刚体运动构成了 $K$ 的零空间。对于节点坐标为 $\\{r_i\\}$ 的网格，按如下方式构建刚体位移基 $R$：\n\n- 在 $2\\text{D}$（二维）中，使用三列：\n$$\nt_x = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ \\cdots \\end{bmatrix}, \\quad\nt_y = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ \\cdots \\end{bmatrix}, \\quad\nr_z = \\begin{bmatrix} -y_1 \\\\ x_1 \\\\ -y_2 \\\\ x_2 \\\\ \\cdots \\end{bmatrix}.\n$$\n\n- 在 $3\\text{D}$（三维）中，使用六列：\n$$\nt_x, \\ t_y, \\ t_z \\text{ 其中 } t_x = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ \\cdots \\end{bmatrix}, \\ t_y = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ \\cdots \\end{bmatrix}, \\ t_z = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ \\cdots \\end{bmatrix},\n$$\n以及绕轴的旋转，通过 $v_i = \\omega \\times r_i$ 获得，其中单位向量 $\\omega$ 与笛卡尔坐标轴对齐，即，\n$$\nr_x: v_i = \\begin{bmatrix} 0 \\\\ -z_i \\\\ y_i \\end{bmatrix}, \\quad\nr_y: v_i = \\begin{bmatrix} z_i \\\\ 0 \\\\ -x_i \\end{bmatrix}, \\quad\nr_z: v_i = \\begin{bmatrix} -y_i \\\\ x_i \\\\ 0 \\end{bmatrix}.\n$$\n\n您的任务是：\n1. 对于每个提供的测试网格，从单元刚度 $k_e$ 组装全局刚度矩阵 $K$。\n2. 使用奇异值分解 (SVD) 计算 $K$ 的零空间维度。使用数值公差 $\\tau = \\alpha \\, \\sigma_{\\max} \\, n$，其中 $\\sigma_{\\max}$ 是 $K$ 的最大奇异值，$n$ 是 $\\max(n_{\\text{rows}}, n_{\\text{cols}})$，$\\alpha = 10^{-9}$。\n3. 根据上述定义构建刚体运动矩阵 $R$。\n4. 通过选择 $n_{\\text{rbm}}$ 个全局自由度（$R$ 的行）来选择一个最小的狄利克雷约束集，使得 $R$ 限制在这些行上的子矩阵具有满列秩 $n_{\\text{rbm}}$。通过对 $R^\\top$ 进行列主元QR分解来实现此选择，选取前 $n_{\\text{rbm}}$ 个主元索引作为约束自由度。\n5. 通过从 $K$ 中消除约束自由度来施加约束（即，形成与齐次本质边界条件下未约束自由度相对应的缩减矩阵 $K_{ff}$）。\n6. 使用相同的基于 SVD 的公差计算 $K_{ff}$ 的零空间维度。\n\n请注意：\n- 所有物理量必须使用国际单位制 (SI)。杨氏模量 $E$ 的单位必须是帕斯卡，坐标单位是米，厚度 $t$ 的单位是米。\n- 没有需要单位的角度计算；刚性旋转由单位轴向量参数化，不使用显式角度值。\n\n测试套件：\n为您的程序提供以下测试用例：\n\n- 案例 1 (2D 单个三角形，平面应力): $E = 5.0 \\times 10^4$ Pa, $\\nu = 0.45$, $t = 2.0 \\times 10^{-3}$ m, 节点 $\\{(0.0, 0.0), (1.0, 0.0), (0.0, 1.0)\\}$, 一个单元，连接关系为 $(0,1,2)$。\n\n- 案例 2 (2D 分成两个三角形的正方形，平面应力): $E = 1.0 \\times 10^5$ Pa, $\\nu = 0.45$, $t = 2.0 \\times 10^{-3}$ m, 节点 $\\{(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)\\}$, 单元 $(0,1,2)$ 和 $(0,2,3)$。\n\n- 案例 3 (3D 单个四面体): $E = 1.0 \\times 10^5$ Pa, $\\nu = 0.45$, 节点 $\\{(0.0, 0.0, 0.0), (1.0, 0.0, 0.0), (0.0, 1.0, 0.0), (0.0, 0.0, 1.0)\\}$, 一个单元，连接关系为 $(0,1,2,3)$。\n\n答案规格：\n对于每个测试用例，输出一个列表，包含：\n- 施加约束前 $K$ 的整数零空间维度。\n- 施加所选最小约束后，缩减矩阵 $K_{ff}$ 的整数零空间维度。\n- 算法实际选择的约束全局自由度索引（整数）列表，按升序排列。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表，每个测试用例表示为 $[d_{\\text{before}}, d_{\\text{after}}, [i_1, i_2, \\dots]]$。例如：$[[3,0,[0,1,3]], [3,0,[0,1,4]], [6,0,[0,1,2,3,4,5]]]$。数值输出是无单位的整数和索引列表。",
            "solution": "用户的请求是验证并解决一个计算生物力学领域的问题，具体涉及线性弹性材料的有限元 (FE) 分析。这需要组装全局刚度矩阵，分析其性质，并施加约束以确保存在唯一解。该问题被认为是有效的，因为它科学地基于连续介质力学和有限元法的原理，问题陈述清晰完整，并且使用了标准的、可验证的数学公式。\n\n解决方案按照以下原则，通过分步执行指定任务来进行。\n\n1.  **有限元公式和单元刚度**\n\n线性静力分析的有限元方法的基础是虚功原理，当其离散化后，可得到线性系统 $K u = f$。在此系统中，$K$ 代表全局刚度矩阵，$u$ 是未知节点位移向量，$f$ 是施加的节点力向量。全局刚度矩阵 $K$ 是通过组装各个单元刚度矩阵 $k_e$ 来构建的。\n\n对于一个占据体积 $V_e$ 的单元，其刚度矩阵由以下积分给出：\n$$\nk_e = \\int_{V_e} B^\\top D B \\, dV\n$$\n其中 $B$ 是应变-位移矩阵，$D$ 是材料本构矩阵（在 3D 中也表示为 $C$）。\n\n对于指定的简单单元类型——2D 中的常应变三角形 (CST) 和 3D 中的线性四面体——矩阵 $B$ 在每个单元内是恒定的。这将积分简化为乘法：对于面积为 $A$、厚度为 $t$ 的 2D 单元，$k_e = (A \\cdot t) B^\\top D B$；对于体积为 $V$ 的 3D 单元，$k_e = V B^\\top C B$。\n\n**对于 2D 平面应力：** 问题提供了在平面应力条件下各向同性材料的标准本构矩阵 $D$：\n$$\nD = \\frac{E}{1-\\nu^2} \\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。问题也给出了 CST 单元的应变-位移矩阵 $B$，它源自于在三角形内插值位移的线性形函数。它将三个工程应变 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})$ 与六个节点位移 $(u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y})$ 联系起来。\n\n**对于 3D 弹性：** 各向同性材料的本构矩阵 $C$ 用拉梅参数 $\\lambda$ 和 $G$ 表示：\n$$\n\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}, \\quad G = \\frac{E}{2(1+\\nu)}\n$$\n线性四面体单元的应变-位移矩阵 $B$ 由其四个线性形函数 $N_j(x,y,z)$ 的梯度导出。每个形函数 $N_j$ 是一个线性多项式，其系数由条件 $N_j$ 在节点 $j$ 处等于 1，在所有其他节点处等于 0 确定。根据问题中的定义，可以通过对由节点坐标构建的矩阵 $M$ 求逆来找到所有四个形函数的这些系数。矩阵 $B$ 将 Voigt 记法中的六个工程应变与四面体的 12 个节点位移联系起来。\n\n2.  **全局刚度矩阵的组装**\n\n整个网格的全局刚度矩阵 $K$ 是通过将所有单元刚度矩阵 $k_e$ 的贡献相加而形成的。这个过程通常称为组装，它涉及将每个单元的局部自由度 (DOF) 映射到其相应的全局自由度。对于一个有 $N_{nodes}$ 个节点、每个节点有 $d$ 个自由度（2D 中 $d=2$，3D 中 $d=3$）的系统，$K$ 的大小为 $(N_{nodes} \\cdot d) \\times (N_{nodes} \\cdot d)$。全局矩阵的一个元素 $K_{ij}$ 表示由于全局自由度 $j$ 上的单位位移而在全局自由度 $i$ 上产生的力。\n\n3.  **刚体模式与 $K$ 的奇异性**\n\n在没有任何预设位移约束（狄利克雷边界条件）的情况下，结构可以作为刚体自由平移和旋转。这些运动被称为刚体模式 (RBM)，它们不引起变形，因此不产生应变或应力。在数学上，如果 $u_{rbm}$ 是对应于刚体运动的位移向量，那么产生的应变为零：$\\varepsilon = B u_{rbm} = 0$。因此，应变能也为零，乘积 $K u_{rbm}$ 是一个零向量。这意味着任何 $u_{rbm}$ 都是 $K$ 的零空间中的一个向量。具有非平凡零空间的矩阵是奇异的（即其行列式为零，且不可逆）。\n\n在 2D 中，有 $n_{rbm}=3$ 个刚体模式：两个平移 ($t_x, t_y$) 和一个旋转 ($r_z$)。在 3D 中，有 $n_{rbm}=6$ 个：三个平移 ($t_x, t_y, t_z$) 和三个旋转 ($r_x, r_y, r_z$)。问题提供了零空间的基的显式构造，构成了矩阵 $R$ 的列。对于一个无约束的连通体，$K$ 的零空间维度等于 $n_{rbm}$。这可以通过使用奇异值分解 (SVD) 计算 $K$ 的数值秩来验证。接近于零（相对于定义的公差）的奇异值的数量给出了零空间的维度。\n\n4.  **施加约束以消除奇异性**\n\n为了获得位移向量 $u$ 的唯一解，必须消除 $K$ 的奇异性。这在物理上等同于固定物体以防止刚体运动。一个最小约束集涉及固定恰好足够的自由度以抑制所有刚体模式。所需的约束数量为 $n_{rbm}$。\n\n这些自由度的选择至关重要：它们必须共同约束所有刚体模式。选择这些自由度的一个有效方法是分析刚体模式矩阵 $R$。$R$ 的行对应于全局自由度。为确保所有刚体模式（$R$ 的列）都受到约束，我们必须从 $R$ 中选择一组 $n_{rbm}$ 个线性无关的行。一种数值上稳健的方法来识别这样一组行是对 $R$ 的转置（表示为 $R^\\top$）执行列主元 QR 分解。该算法贪婪地选择 $R^\\top$ 的列（即 $R$ 的行），这些列与先前选择的列最大程度地线性无关。算法选择的前 $n_{rbm}$ 个主元列的索引对应于一组适合约束的自由度。\n\n5.  **缩减系统的形成**\n\n一旦选择了约束自由度，我们通过将其位移设置为零来应用齐次狄利克雷边界条件。这对应于根据自由 ($f$) 和约束 ($c$) 自由度对全局系统 $K u = f$ 进行分区：\n$$\n\\begin{bmatrix} K_{ff} & K_{fc} \\\\ K_{cf} & K_{cc} \\end{bmatrix}\n\\begin{bmatrix} u_f \\\\ u_c \\end{bmatrix}\n=\n\\begin{bmatrix} f_f \\\\ f_c \\end{bmatrix}\n$$\n当 $u_c = 0$ 时，自由自由度的系统变为：\n$$\nK_{ff} u_f = f_f\n$$\n矩阵 $K_{ff}$ 是缩减刚度矩阵。如果约束成功消除了所有刚体模式，$K_{ff}$ 将是非奇异的（可逆的），并且系统对于 $u_f$ 将有唯一解。这可以通过再次计算 $K_{ff}$ 的 SVD 并检查其零空间维度是否为零来验证。",
            "answer": "[[3,0,[0,1,2]],[3,0,[0,1,2]],[6,0,[0,1,2,3,4,6]]]"
        },
        {
            "introduction": "生物力学载荷，例如行走过程中的地面反作用力，本质上是多变和不确定的。我们可以用概率方法对这些载荷进行建模，并将其不确定性传播到我们的有限元模型中，而不是仅仅依赖单一的确定性模拟。这项实践  将指导您计算模型预测的置信区间，从而在多变的真实世界条件下，对系统行为进行更现实的评估。",
            "id": "4161973",
            "problem": "考虑一个人类足部的静态线性有限元方法 (FEM) 模型。在施加了固定跟骨和相关后足自由度的本质（狄利克雷）边界条件后，降阶刚度矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 通过线性系统 $K u = f$ 将节点位移向量 $u \\in \\mathbb{R}^{n}$（单位：毫米 mm）与准静态平衡下施加的地面反作用力 (GRF) 向量 $f \\in \\mathbb{R}^{n}$（单位：牛顿 N）关联起来。由于步态变异性、接触条件变异性和测量噪声，地面反作用力 (GRF) 是不确定的，并被建模为多元正态随机向量 $f \\sim \\mathcal{N}(\\mu_f, \\Sigma_f)$，其中 $\\mu_f$ 是均值力向量，$\\Sigma_f$ 是力协方差矩阵，该矩阵编码了边界节点和方向间的交叉相关性。\n\n您的任务是将边界载荷不确定性从 $f$ 通过降阶有限元系统传播到到分布 $u$，然后计算指定位移分量 $u_j$ 的双侧 $95$ 置信区间（单位：毫米 mm）。使用从基本原理开始的推导：静态平衡、线性弹性和随机变量线性变换的性质。不要引入任何未经这些原理论证的外部经验捷径或预先推导的传播公式。\n\n必须遵守以下物理单位：$K$ 的单位是 N/mm，$f$ 的单位是 N，$u$ 的单位是 mm。所有最终的置信区间界限都用毫米 (mm) 表示，并四舍五入到三位小数。本问题不涉及角度（如有）。不要使用百分号；置信水平 $95$ 应被视为源自标准正态分位数的十进制置信度规范。\n\n实现一个程序，为下面提供的每个测试用例计算指定位移分量 $u_j$ 的双侧 $95$ 置信区间的下界和上界（单位：mm）。该测试套件涵盖了典型条件、确定性载荷情景以及一个具有奇异（但半正定）载荷协方差的用例，以测试在受限不确定性下的鲁棒性。\n\n测试套件：\n1. 案例 A（理想路径，三个自由度）：\n   - 降阶刚度矩阵 $K_1$ (N/mm)：\n     $$K_1 = \\begin{bmatrix}\n     8000 & -1200 & 0 \\\\\n     -1200 & 9000 & -1500 \\\\\n     0 & -1500 & 7000\n     \\end{bmatrix}$$\n   - 平均地面反作用力向量 $\\mu_{f1}$ (N)：\n     $$\\mu_{f1} = \\begin{bmatrix} 120 \\\\ 100 \\\\ 80 \\end{bmatrix}$$\n   - 地面反作用力协方差 $\\Sigma_{f1}$ ($\\text{N}^2$)：\n     $$\\Sigma_{f1} = \\begin{bmatrix}\n     400 & 100 & 0 \\\\\n     100 & 300 & 50 \\\\\n     0 & 50 & 200\n     \\end{bmatrix}$$\n   - 位移分量索引 $j_1 = 1$（从零开始索引）。\n2. 案例 B（确定性载荷，两个自由度）：\n   - 降阶刚度矩阵 $K_2$ (N/mm)：\n     $$K_2 = \\begin{bmatrix}\n     10000 & -2000 \\\\\n     -2000 & 8000\n     \\end{bmatrix}$$\n   - 平均地面反作用力向量 $\\mu_{f2}$ (N)：\n     $$\\mu_{f2} = \\begin{bmatrix} 200 \\\\ 200 \\end{bmatrix}$$\n   - 地面反作用力协方差 $\\Sigma_{f2}$ ($\\text{N}^2$)：\n     $$\\Sigma_{f2} = \\begin{bmatrix}\n     0 & 0 \\\\\n     0 & 0\n     \\end{bmatrix}$$\n   - 位移分量索引 $j_2 = 0$（从零开始索引）。\n3. 案例 C（奇异协方差，四个自由度）：\n   - 降阶刚度矩阵 $K_3$ (N/mm)：\n     $$K_3 = \\begin{bmatrix}\n     15000 & -3000 & 0 & 0 \\\\\n     -3000 & 12000 & -2500 & 0 \\\\\n     0 & -2500 & 11000 & -2000 \\\\\n     0 & 0 & -2000 & 9000\n     \\end{bmatrix}$$\n   - 平均地面反作用力向量 $\\mu_{f3}$ (N)：\n     $$\\mu_{f3} = \\begin{bmatrix} 150 \\\\ 0 \\\\ 200 \\\\ 50 \\end{bmatrix}$$\n   - 地面反作用力协方差 $\\Sigma_{f3}$ ($\\text{N}^2$)：\n     $$\\Sigma_{f3} = \\begin{bmatrix}\n     0 & 0 & 0 & 0 \\\\\n     0 & 500 & 200 & 0 \\\\\n     0 & 200 & 600 & 0 \\\\\n     0 & 0 & 0 & 0\n     \\end{bmatrix}$$\n   - 位移分量索引 $j_3 = 2$（从零开始索引）。\n\n输出规范：\n- 对于每个案例，使用对应于中心覆盖率 $0.95$ 的标准正态分位数 $z$ 计算 $u_j$ 的双侧 $95$ 置信区间界限。将两个界限以毫米 (mm) 表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含三个案例的结果，格式为由子列表组成的逗号分隔列表，每个子列表包含下界和上界。格式必须严格如下：\n  $$[[\\ell_1,u_1],[\\ell_2,u_2],[\\ell_3,u_3]]$$\n其中 $\\ell_k$ 和 $u_k$ 分别是案例 $k$ 的下界和上界，格式化为不带空格且保留三位小数的毫米值。",
            "solution": "我们从准静态生物力学中的静态平衡开始：节点上的净内力与施加的外力相平衡。在小应变、均匀线性弹性本构行为和适当的运动学约束条件下，使用有限元方法 (FEM) 将线性弹性连续体离散化，得到代数关系 $K u = f$，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是施加本质（狄利克雷）边界条件后的降阶刚度矩阵，$u \\in \\mathbb{R}^{n}$ 是位移向量，$f \\in \\mathbb{R}^{n}$ 是外部节点力向量。单位是一致的，$[K] = \\text{N/mm}$，$[f] = \\text{N}$，以及 $[u] = \\text{mm}$。\n\n由于步态和接触条件的变异性，地面反作用力 (GRF) $f$ 是不确定的。我们将 $f$ 建模为多元正态随机向量：\n$$\nf \\sim \\mathcal{N}(\\mu_f, \\Sigma_f),\n$$\n其均值为 $\\mu_f$，协方差为 $\\Sigma_f$。求解确定性线性系统得到 $u = K^{-1} f$。因为 $u$ 是高斯随机向量 $f$ 的线性变换，所以 $u$ 也是高斯分布的。具体来说，如果 $f$ 是高斯分布的，而 $A$ 是一个确定性矩阵，那么 $A f$ 也是高斯分布的，其均值为 $A \\mu_f$，协方差为 $A \\Sigma_f A^\\top$。使用 $A = K^{-1}$，我们得到：\n$$\nu \\sim \\mathcal{N}(\\mu_u, \\Sigma_u), \\quad \\mu_u = K^{-1} \\mu_f, \\quad \\Sigma_u = K^{-1} \\Sigma_f K^{-\\top}.\n$$\n\n对于指定的位移分量索引 $j$，标量 $u_j$ 是一个单变量正态随机变量，其均值和方差由 $\\mu_u$ 和 $\\Sigma_u$ 的相应条目给出：\n$$\nu_j \\sim \\mathcal{N}\\big(\\mu_u^{(j)}, \\sigma_u^{2 (j)}\\big), \\quad \\text{其中 } \\mu_u^{(j)} = (\\mu_u)_j, \\; \\sigma_u^{2 (j)} = (\\Sigma_u)_{jj}.\n$$\n$u_j$ 的双侧 $95$ 置信区间是通过使用满足 $P(|Z| \\le z) = 0.95$ 的标准正态分位数 $z$（即 $z \\approx 1.959964$）来构建的。该区间为：\n$$\n\\left[\\mu_u^{(j)} - z \\, \\sigma_u^{(j)}, \\; \\mu_u^{(j)} + z \\, \\sigma_u^{(j)}\\right],\n$$\n其中 $\\sigma_u^{(j)} = \\sqrt{(\\Sigma_u)_{jj}}$。在确定性情况下，$\\Sigma_f = 0$，因此 $\\Sigma_u = 0$，这会产生一个退化区间，其上下界均等于 $\\mu_u^{(j)}$。\n\n每个测试用例的算法步骤：\n1. 读取 $K$、$\\mu_f$、$\\Sigma_f$ 和 $j$。\n2. 通过求解线性系统计算平均位移\n   $$\n   K \\, \\mu_u = \\mu_f \\quad \\Rightarrow \\quad \\mu_u = K^{-1} \\mu_f,\n   $$\n   使用线性求解器以避免显式矩阵求逆。\n3. 计算位移协方差，而无需显式构造 $K^{-1}$。使用恒等式\n   $$\n   \\Sigma_u = K^{-1} \\Sigma_f K^{-\\top}.\n   $$\n   这可以通过两次求解来计算：首先求解 $K^\\top Y = \\Sigma_f^\\top$ 得到 $Y$，这给出 $Y^\\top = \\Sigma_f K^{-\\top}$，然后求解 $K S = Y^\\top$ 得到 $S = K^{-1} \\Sigma_f K^{-\\top} = \\Sigma_u$。\n4. 提取标量方差 $(\\Sigma_u)_{jj}$，取其平方根得到 $\\sigma_u^{(j)}$，并使用 $z \\approx 1.959964$ 计算区间界限。\n5. 将两个界限四舍五入到三位小数，并以毫米 (mm) 为单位报告。\n\n将此过程应用于提供的测试套件会产生三对界限。程序必须打印包含三组界限子列表的单行，格式化为不带空格且保留三位小数，如下所示：\n$$\n[[\\ell_1,u_1],[\\ell_2,u_2],[\\ell_3,u_3]].\n$$\n这种方法遵循第一性原理：静态平衡 ($K u = f$)、导致线性刚度的线性弹性，以及高斯随机变量线性变换的性质。约束通过降阶的 $K$ 体现，该矩阵反映了足部模型固定部分的狄利克雷边界条件。",
            "answer": "[[0.015,0.032],[0.023,0.023],[0.021,0.026]]"
        }
    ]
}