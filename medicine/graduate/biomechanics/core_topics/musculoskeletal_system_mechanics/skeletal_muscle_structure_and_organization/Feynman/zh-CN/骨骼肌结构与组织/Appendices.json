{
    "hands_on_practices": [
        {
            "introduction": "理解肌肉功能始于认识其层级结构。肌纤维的力学行为并非随意的，而是其基本单位——肌节——组织方式的直接结果。本练习将探讨这种组织方式的基本原理，将肌纤维视作一个由串联和并联元件构成的系统，以揭示结构如何决定功能——具体来说，串联肌节数量如何增加最大缩短速度，却不影响等长收缩力。",
            "id": "4203410",
            "problem": "单根骨骼肌纤维可以建模为一组相同的肌小节，这些肌小节沿每条肌原纤维串联排列，而多条肌原纤维则在横截面上并联排列。考虑一根肌纤维，在其力-长度关系的平台期，测得其端到端长度为 $40$ mm，沿其长度的平均肌小节长度为 $2.6$ µm。假设沿肌纤维的肌小节长度均匀，且串联顺应性可忽略不计。\n\n(a) 仅使用总肌纤维长度等于串联肌小节长度之和的定义，估算每条肌原纤维中串联的肌小节总数，记为 $N$。将您的答案四舍五入到 $4$ 位有效数字。将 $N$ 报告为无量纲的计数。\n\n(b) 从机械元件串并联排列的第一性原理以及长度变化的运动学可加性出发，推导无负载最大肌纤维缩短速度 $V_{\\max,\\mathrm{fiber}}$ 作为肌小节无负载最大缩短速度 $v_{\\max,\\mathrm{sarc}}$ 和串联数量 $N$ 的函数的解析表达式。在同一框架下，解释为什么当横截面积保持固定而 $N$ 变化时，肌纤维最大等长力 $F_{0,\\mathrm{fiber}}$ 与 $N$ 无关。以符号形式表示 $V_{\\max,\\mathrm{fiber}}$；不要计算速度的数值。\n\n您最终提交的答案应为 (a) 部分中 $N$ 的数值，四舍五入到 $4$ 位有效数字，且不带单位。",
            "solution": "该问题具有科学依据，提法明确，并包含足够的信息以获得唯一解。我们首先解决 (a) 部分，然后进行 (b) 部分要求的推导。\n\n部分 (a)：估算串联肌小节的数量。\n问题指出，肌纤维可以建模为肌原纤维的集合，每条肌原纤维是一条由相同肌小节串联排列而成的链。因此，肌纤维的总长度 $L_{\\mathrm{fiber}}$ 由端到端排列的肌小节的长度之和决定。已知每条肌原纤维中串联的肌小节数量为 $N$，并假设每个肌小节的长度均匀为 $l_{\\mathrm{sarc}}$，则总肌纤维长度是肌小节数量与单个肌小节长度的乘积。\n\n该关系由下式给出：\n$$L_{\\mathrm{fiber}} = N \\cdot l_{\\mathrm{sarc}}$$\n我们已知在力-长度关系的平台期，肌纤维长度为 $L_{\\mathrm{fiber}} = 40$ mm，相应的平均肌小节长度为 $l_{\\mathrm{sarc}} = 2.6$ µm。为了计算无量纲计数 $N$，我们必须首先确保长度单位一致。我们将肌纤维长度从毫米 (mm) 转换为微米 (µm)：\n$$L_{\\mathrm{fiber}} = 40 \\text{ mm} = 40 \\times 10^3 \\text{ µm} = 40000 \\text{ µm}$$\n现在，我们可以求解 $N$：\n$$N = \\frac{L_{\\mathrm{fiber}}}{l_{\\mathrm{sarc}}} = \\frac{40000 \\text{ µm}}{2.6 \\text{ µm}}$$\n$$N \\approx 15384.615...$$\n问题要求将此答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $1$、$5$、$3$ 和 $8$。第五位数字是 $4$，小于 $5$，因此我们向下取整，这意味着第四位数字 ($8$) 保持不变。结果值为 $15380$。\n\n部分 (b)：速度和力关系的推导。\n我们从机械元件串并联排列的第一性原理出发。\n\n最大缩短速度 ($V_{\\max,\\mathrm{fiber}}$) 的推导：\n串联元件的运动学关系是它们的长度是可加的。在任何时间 $t$，一条肌原纤维的总长度 $L_{\\mathrm{fiber}}(t)$ 是 $N$ 个串联肌小节长度 $l_{\\mathrm{sarc}}(t)$ 的总和。\n$$L_{\\mathrm{fiber}}(t) = \\sum_{i=1}^{N} l_{\\mathrm{sarc}, i}(t)$$\n根据肌小节长度和行为均匀的假设，$l_{\\mathrm{sarc}, i}(t) = l_{\\mathrm{sarc}}(t)$ 对所有 $i$ 成立。方程简化为：\n$$L_{\\mathrm{fiber}}(t) = N \\cdot l_{\\mathrm{sarc}}(t)$$\n肌纤维的缩短速度 $V_{\\mathrm{fiber}}$ 是其长度对时间的导数。将上述表达式对时间 $t$ 求导（注意 $N$ 是一个常数计数），得到速度之间的关系：\n$$V_{\\mathrm{fiber}}(t) = \\frac{dL_{\\mathrm{fiber}}}{dt} = \\frac{d}{dt} \\left( N \\cdot l_{\\mathrm{sarc}}(t) \\right) = N \\cdot \\frac{dl_{\\mathrm{sarc}}}{dt}$$\n项 $\\frac{dl_{\\mathrm{sarc}}}{dt}$ 是单个肌小节的缩短速度 $v_{\\mathrm{sarc}}(t)$。因此，一个普遍的关系是：\n$$V_{\\mathrm{fiber}}(t) = N \\cdot v_{\\mathrm{sarc}}(t)$$\n该关系在所有条件下都成立，包括最大无负载缩短的特定情况。因此，肌纤维的最大无负载缩短速度 $V_{\\max,\\mathrm{fiber}}$ 与单个肌小节的最大无负载缩短速度 $v_{\\max,\\mathrmsarc}$ 成正比，比例系数为串联肌小节的数量 $N$。\n$$V_{\\max,\\mathrm{fiber}} = N \\cdot v_{\\max,\\mathrm{sarc}}$$\n这个结果是串联元件速度可加性的直接推论。\n\n最大等长力 ($F_{0,\\mathrm{fiber}}$) 的解释：\n对于串联的机械元件，通过每个元件传递的力是相同的。因此，对于由 $N$ 个串联肌小节组成的单条肌原纤维，肌原纤维产生的力 $F_{\\mathrm{myo}}$ 等于该链中任何单个肌小节产生的力 $F_{\\mathrm{sarc}}$。\n$$F_{\\mathrm{myo}} = F_{\\mathrm{sarc}}$$\n串联肌小节的数量 $N$ 影响肌原纤维的长度和缩短速度，但不影响其在等长条件下产生的力。\n\n肌纤维模型由许多（假设为 $M$ 条）并联的肌原纤维组成。对于并联的机械元件，它们的各自的力相加得到总力，而它们都经历相同的长度变化。肌纤维产生的总力 $F_{\\mathrm{fiber}}$ 是每条并联肌原纤维产生的力之和。\n$$F_{\\mathrm{fiber}} = \\sum_{j=1}^{M} F_{\\mathrm{myo}, j}$$\n假设所有肌原纤维都相同，则对所有 $j$ 都有 $F_{\\mathrm{myo},j} = F_{\\mathrm{myo}}$。表达式简化为：\n$$F_{\\mathrm{fiber}} = M \\cdot F_{\\mathrm{myo}}$$\n将此与前面的关系结合，我们得到：\n$$F_{\\mathrm{fiber}} = M \\cdot F_{\\mathrm{sarc}}$$\n该关系对任何激活水平都成立，包括最大等长收缩。因此，肌纤维的最大等长力 $F_{0,\\mathrm{fiber}}$ 为：\n$$F_{0,\\mathrm{fiber}} = M \\cdot F_{0,\\mathrm{sarc}}$$\n其中 $F_{0,\\mathrm{sarc}}$ 是单个肌小节的最大等长力。\n\n肌纤维的横截面积 $A_{\\mathrm{fiber}}$ 与并联肌原纤维的数量 $M$ 成正比。如果横截面积保持不变，则意味着 $M$ 是恒定的。从 $F_{0,\\mathrm{fiber}}$ 的最终表达式中，我们可以看到力取决于 $M$（并联力产生器的数量）和 $F_{0,\\mathrm{sarc}}$（每个产生器的内在力容量），但与 $N$（串联产生器的数量）无关。因此，在保持横截面积固定的情况下改变 $N$ 会改变肌纤维的长度和最大速度，但不会改变其最大等长力。",
            "answer": "$$\\boxed{15380}$$"
        },
        {
            "introduction": "肌节产生的力关键性地取决于其长度，这一关系由其内部肌丝的重叠程度决定。本练习将超越简单的几何模型，构建一个更精细的肌节主动力-长度关系模型。您不仅要考虑滑动细丝机制，还将引入肌丝晶格间距的影响，这是一个关键因素，它解释了为什么主动力会在一个特定的最佳肌节长度上达到最大值。",
            "id": "4203393",
            "problem": "考虑一个由两个相对的半肌节组成的单个肌节模型，其边界为两个Z盘，并在M线处相遇。其纵向几何结构由以下广泛观察到的脊椎动物骨骼肌超微结构参数定义：粗肌丝长度 $L_{\\text{thick}} = 1.6\\,\\text{µm}$，细肌丝长度 $L_{\\text{thin}} = 1.2\\,\\text{µm}$，以及中心肌球蛋白裸区长度 $L_{\\text{bare}} = 0.2\\,\\text{µm}$（因此肌球蛋白头部占据裸区外的横桥区）。设半肌节长度为 $h = L_{s}/2$，其中 $L_{s}$ 是肌节长度，并采用从M线 $x=0$ 处指向Z盘 $x=h$ 处的一维坐标系。\n\n使用以下基本依据：(i) 滑动肌丝的重叠决定了潜在的肌动蛋白-肌球蛋白横桥的数量；具体来说，在每个半肌节中，含有肌球蛋白头部的区间为 $I = [L_{\\text{bare}}/2,\\; L_{\\text{thick}}/2]$，细肌丝横跨的区间为 $T = [\\max(0,\\; h - L_{\\text{thin}}),\\; h]$，因此可用于形成横桥的纵向重叠长度是交集 $|I \\cap T|$ 的长度；以及 (ii) 在肌纤维体积固定的情况下，肌丝径向晶格间距 $d$ 与肌节长度的平方根成反比，即 $d \\propto L_{s}^{-1/2}$，且横桥附着概率 $p(d)$ 随 $d$ 的增加而单调递减。\n\n假设主动张力 $F_{\\text{act}}(L_{s})$ 与横桥区的可用重叠长度和径向附着概率的乘积成正比，因此最大化 $F_{\\text{act}}$ 需要同时最大化横桥区的纵向覆盖，并考虑到 $p(d)$ 会通过 $d \\propto L_{s}^{-1/2}$ 的关系随 $L_{s}$ 的增加而增加。在这些假设下，确定能最大化重叠并因此最大化主动张力的最优肌节长度 $L_{\\text{opt}}$。使用给定的 $L_{\\text{thin}}$、$L_{\\text{thick}}$ 和 $L_{\\text{bare}}$ 计算数值，并解释为什么在典型的晶格间距下，$L_{\\text{opt}}$ 出现在完全重叠平台期的上端。以微米为单位表示最终答案，并四舍五入到两位有效数字。",
            "solution": "我们从滑动肌丝框架开始。在每个半肌节中，设坐标 $x$ 从M线 $x=0$ 处延伸到Z盘 $x=h$ 处，其中 $h = L_{s}/2$。粗肌丝从 $x=0$ 延伸到 $x=L_{\\text{thick}}/2$，其中心裸区从 $x=0$ 到 $x=L_{\\text{bare}}/2$ 没有肌球蛋白头部。因此，一个半肌节中含有横桥的区域是\n$$\nI = \\left[L_{\\text{bare}}/2,\\; L_{\\text{thick}}/2\\right].\n$$\n细肌丝从Z盘开始，向M线延伸 $L_{\\text{thin}}$ 的长度，因此它占据的区间是\n$$\nT = \\left[\\max(0,\\; h - L_{\\text{thin}}),\\; h\\right].\n$$\n在一个半肌节中，可用于横桥形成的纵向重叠是交集 $|I \\cap T|$ 的长度，整个肌节的总几何重叠与两个半肌节中的这个度量成比例。\n\n我们首先描述在每个半肌节中，横桥区被细肌丝完全覆盖的条件。$T$ 对 $I$ 的完全覆盖需要两个不等式：\n1. 细肌丝必须至少到达横桥区的近端边界，即\n$$\nh - L_{\\text{thin}} \\leq L_{\\text{bare}}/2.\n$$\n2. 半肌节必须足够长，使得横桥区的远端边界 $x = L_{\\text{thick}}/2$ 位于细肌丝的跨度内，即\n$$\nh \\geq L_{\\text{thick}}/2.\n$$\n\n此外，为避免在M线处发生肌动蛋白-肌动蛋白干扰，细肌丝的尖端不应越过 $x=0$，这要求\n$$\nh - L_{\\text{thin}} \\geq 0 \\quad \\Longleftrightarrow \\quad h \\geq L_{\\text{thin}}.\n$$\n\n将这些条件结合起来，我们得到一个肌节长度的平台期，在此区间内，整个横桥区域被覆盖，但细肌丝不会在M线处重叠。用 $h$ 表示，\n$$\nL_{\\text{thin}} \\leq h \\leq L_{\\text{thin}} + \\frac{L_{\\text{bare}}}{2},\n$$\n同时需要满足 $h \\geq L_{\\text{thick}}/2$。给定典型值 $L_{\\text{thick}}/2 = 0.8\\,\\text{µm}$ 和 $L_{\\text{thin}} = 1.2\\,\\text{µm}$，条件 $h \\geq L_{\\text{thick}}/2$ 在平台期内是自动满足的。换算成肌节长度 $L_{s} = 2h$，完全重叠且无肌动蛋白干扰的平台期为\n$$\n2 L_{\\text{thin}} \\leq L_{s} \\leq 2 L_{\\text{thin}} + L_{\\text{bare}}.\n$$\n\n在这个平台期内，纵向重叠 $|I \\cap T|$ 等于每个半肌节中完整的横桥区长度，即\n$$\n|I| = \\left(L_{\\text{thick}}/2\\right) - \\left(L_{\\text{bare}}/2\\right) = \\frac{L_{\\text{thick}} - L_{\\text{bare}}}{2},\n$$\n因此，横桥的几何可用性在整个平台期内是最大化的，并且相对于 $L_{s}$ 是恒定的。因此，仅从纵向几何结构来看，预测的最大主动张力在此区间内是一个平台。\n\n接下来，我们考虑径向晶格间距。对于一个近似为恒定体积的肌纤维，其横截面积 $A$ 与 $L_{s}$ 成反比，而肌丝晶格间距 $d$ 与 $A$ 的平方根成正比，因此\n$$\nd \\propto \\sqrt{A} \\propto L_{s}^{-1/2}.\n$$\n根据经验和机理，横桥附着概率 $p(d)$ 是 $d$ 的递减函数，所以更大的 $L_{s}$（更小的 $d$）会产生更大的 $p(d)$，即\n$$\n\\frac{\\mathrm{d}p}{\\mathrm{d}d}  0, \\quad \\frac{\\mathrm{d}d}{\\mathrm{d}L_{s}}  0 \\quad \\Longrightarrow \\quad \\frac{\\mathrm{d}p}{\\mathrm{d}L_{s}} > 0.\n$$\n因此，在纵向重叠已经最大且恒定的完全重叠平台期内，增加 $L_{s}$ 会增加 $p(d)$，从而增加 $F_{\\text{act}}(L_{s})$。因此，最优肌节长度 $L_{\\text{opt}}$ 在完全重叠平台期的上端达到：\n$$\nL_{\\text{opt}} = 2 L_{\\text{thin}} + L_{\\text{bare}}.\n$$\n\n使用给定的脊椎动物数值 $L_{\\text{thin}} = 1.2\\,\\text{µm}$ 和 $L_{\\text{bare}} = 0.2\\,\\text{µm}$，\n$$\nL_{\\text{opt}} = 2 \\times 1.2\\,\\text{µm} + 0.2\\,\\text{µm} = 2.6\\,\\text{µm}.\n$$\n\n这个结果解释了为什么 $L_{\\text{opt}} \\approx 2.6\\,\\text{µm}$：从几何上看，$L_{s} = 2.6\\,\\text{µm}$ 将两侧细肌丝的尖端置于 $x = L_{\\text{bare}}/2$ 处，完全覆盖了整个含有肌球蛋白头部的区域，而没有肌动蛋白-肌动蛋白干扰。同时，在平台期的较长端，较小的径向间距在典型的晶格间距下增强了横桥的附着概率。按照要求，将答案四舍五入到两位有效数字并以微米表示，计算值仍为 $2.6\\,\\text{µm}$。",
            "answer": "$$\\boxed{2.6}$$"
        },
        {
            "introduction": "理解肌肉生物力学的最后一步，是从肌纤维层面扩展到最终驱动运动的整个肌肉-肌腱单元。这项计算练习要求您综合多个概念：肌纤维应力、生理横截面积、羽状结构和肌腱顺应性。通过建立一个平衡模型，您将预测传递到骨骼的净力，并分析其对关键结构参数的敏感性，从而在细胞力学和宏观解剖功能之间架起一座桥梁。",
            "id": "4203413",
            "problem": "你需要实现一个程序，从基本定义和几何学出发，计算一个具有顺应性肌腱的羽状骨骼肌所传递的外部肌腱力，然后评估该外部力对选定结构参数的局部敏感性。你必须使用的基础理论包括：应力定义为单位面积上的力，准静态条件下沿肌腱轴的内部肌纤维传递力等于肌腱张力的平衡要求，羽状肌纤维几何结构的恒定体积近似，以及线性弹性肌腱模型。不允许使用任何捷径；必须从这些基础出发推导出所需的关系。计算必须针对多个具有科学合理参数的测试用例进行，并且结果必须以单行聚合输出的形式返回。\n\n使用的科学和建模定义：\n- 设生理横截面积（PCSA）用 $A$ 表示，肌纤维应力用 $\\sigma_f$ 表示。根据应力的定义，在横截面上应力均匀的假设下，总的肌纤维力大小为 $F_f = \\sigma_f \\, A$。\n- 羽状结构通过羽状角的余弦将肌纤维力映射到肌腱轴上。在梭形肌腹的恒定体积近似下，肌纤维羽状角 $\\alpha$ 与肌纤维长度 $L_f$ 的关系为 $L_f \\sin(\\alpha) = h$，其中 $h$ 是恒定的腱膜间距（肌腹厚度）。轴向投影因子为 $\\cos(\\alpha)$。\n- 肌肉-肌腱单元（MTU）的长度为 $L_{MTU}$。肌腱长度为 $L_t$，肌纤维的轴向投影对 MTU 长度的贡献为 $L_f \\cos(\\alpha)$，因此 $L_t = L_{MTU} - L_f \\cos(\\alpha)$。\n- 肌腱被建模为线性弹性的，其刚度为 $k_t$，松弛长度为 $L_{t0}$。肌腱张力为 $T = k_t \\, \\max(0, L_t - L_{t0})$。\n- 沿肌腱轴的准静态平衡要求肌腱张力等于肌纤维力的轴向投影：$T = F_f \\cos(\\alpha)$，前提是肌腱是绷紧的。如果肌腱是松弛的（即 $L_t \\le L_{t0}$），则外部肌腱力为零。\n\n任务：\n1. 对每个测试用例，确定在肌腱绷紧时满足平衡条件的肌纤维长度 $L_f$。你必须严格处理肌腱松弛的情况：如果对于所有允许的 $L_f$，肌腱都是松弛的，则外部肌腱力为零。当肌腱绷紧时，求解关于 $L_f$ 的非线性平衡问题，并满足几何约束 $L_f \\ge h$，以确保 $\\cos(\\alpha)$ 有定义。\n2. 计算外部肌腱力 $F_{ext}$，单位为牛顿（$\\mathrm{N}$）。将 $F_{ext}$ 以浮点数形式报告。\n3. 使用围绕基线参数值的对称有限差分近似，评估 $F_{ext}$ 对 $A$、$h$ 和 $k_t$ 的局部敏感性。将参数 $x$ 的局部相对敏感性定义为 $S_x = \\dfrac{x}{F_{ext}} \\dfrac{\\partial F_{ext}}{\\partial x}$，并进行数值评估。对每个参数使用一个小的分数扰动 $\\varepsilon = 10^{-4}$。如果由于肌腱松弛导致 $F_{ext} = 0$，则将敏感性 $S_A$、$S_h$ 和 $S_{k_t}$ 报告为 $0.0$。\n4. 所有角度均以弧度表示。所有长度以米（$\\mathrm{m}$）表示，刚度以牛顿/米（$\\mathrm{N/m}$）表示，应力以帕斯卡（$\\mathrm{Pa}$）表示，面积以平方米（$\\mathrm{m^2}$）表示，力以牛顿（$\\mathrm{N}$）表示。\n5. 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，格式如下：对于每个测试用例，生成一个包含四个浮点数的列表 $[F_{ext}, S_A, S_h, S_{k_t}]$，并将所有测试用例聚合到一个顶层列表中，例如 $[[f_1,s_{A1},s_{h1},s_{k1}],[f_2,s_{A2},s_{h2},s_{k2}],\\dots]$，不含空格。\n\n算法约束和允许域：\n- 强制 $L_f \\ge h$，以使 $\\sin(\\alpha) = h/L_f \\in [0,1]$ 且 $\\cos(\\alpha) = \\sqrt{1 - (h/L_f)^2}$ 为实数。\n- 当肌腱绷紧时，使用稳健的求根方法求解非线性平衡问题。你可以在一个有效的区间上采用任何适用于连续函数的标准数值方法（例如，二分法或 Brent 方法）。\n- 如果对于所有 $L_f \\ge h$（即在允许域内 $L_t \\le L_{t0}$），肌腱都是松弛的，则将 $F_{ext}$ 设为 $0$，敏感性设为 $0.0$。\n\n测试套件（每个元组为 $(\\sigma_f, A, h, L_{MTU}, L_{t0}, k_t)$）：\n- 案例1（一般情况，肌腱绷紧）：$(\\sigma_f = 3.2 \\times 10^5 \\, \\mathrm{Pa}, \\; A = 2.2 \\times 10^{-2} \\, \\mathrm{m^2}, \\; h = 2.0 \\times 10^{-2} \\, \\mathrm{m}, \\; L_{MTU} = 3.6 \\times 10^{-1} \\, \\mathrm{m}, \\; L_{t0} = 2.4 \\times 10^{-1} \\, \\mathrm{m}, \\; k_t = 1.5 \\times 10^5 \\, \\mathrm{N/m})$。\n- 案例2（边界情况，预期肌腱松弛）：$(\\sigma_f = 3.0 \\times 10^5 \\, \\mathrm{Pa}, \\; A = 1.9 \\times 10^{-2} \\, \\mathrm{m^2}, \\; h = 2.5 \\times 10^{-2} \\, \\mathrm{m}, \\; L_{MTU} = 2.8 \\times 10^{-1} \\, \\mathrm{m}, \\; L_{t0} = 2.9 \\times 10^{-1} \\, \\mathrm{m}, \\; k_t = 1.0 \\times 10^5 \\, \\mathrm{N/m})$。\n- 案例3（边缘情况，高羽状角）：$(\\sigma_f = 2.8 \\times 10^5 \\, \\mathrm{Pa}, \\; A = 3.0 \\times 10^{-2} \\, \\mathrm{m^2}, \\; h = 6.0 \\times 10^{-2} \\, \\mathrm{m}, \\; L_{MTU} = 4.5 \\times 10^{-1} \\, \\mathrm{m}, \\; L_{t0} = 2.7 \\times 10^{-1} \\, \\mathrm{m}, \\; k_t = 2.0 \\times 10^5 \\, \\mathrm{N/m})$。\n- 案例4（边缘情况，肌腱非常硬）：$(\\sigma_f = 3.0 \\times 10^5 \\, \\mathrm{Pa}, \\; A = 2.0 \\times 10^{-2} \\, \\mathrm{m^2}, \\; h = 3.0 \\times 10^{-2} \\, \\mathrm{m}, \\; L_{MTU} = 4.0 \\times 10^{-1} \\, \\mathrm{m}, \\; L_{t0} = 2.6 \\times 10^{-1} \\, \\mathrm{m}, \\; k_t = 1.0 \\times 10^6 \\, \\mathrm{N/m})$。\n\n你的程序必须以精确的格式输出单行：一个顶级列表，其中包含每个测试用例的一个子列表，每个子列表为 $[F_{ext},S_A,S_h,S_{k_t}]$，包含浮点数且无空格，例如：$[[f_1,s_{A1},s_{h1},s_{k1}],[f_2,s_{A2},s_{h2},s_{k2}],[f_3,s_{A3},s_{h3},s_{k3}],[f_4,s_{A4},s_{h4},s_{k4}]]$。",
            "solution": "该问题要求计算一个羽状骨骼肌产生的准静态外部力，以及该力对关键结构参数的局部敏感性。解决方案必须按照问题陈述中指定的第一性原理推导得出。\n\n### 1. 平衡的数学公式\n\n肌肉-肌腱单元（MTU）的模型基于一组定义和一个平衡条件。我们首先建立控制方程。\n\n肌纤维产生的总力 $F_f$ 由主动肌纤维应力 $\\sigma_f$ 和生理横截面积（PCSA）$A$ 的乘积给出：\n$$F_f = \\sigma_f A$$\n\n肌纤维以相对于肌腱作用线的羽状角 $\\alpha$ 排列。在恒定体积假设下，羽状肌的几何结构将肌纤维长度 $L_f$、羽状角 $\\alpha$ 和恒定的肌腹厚度（腱膜间距）$h$ 联系起来，其关系为：\n$$L_f \\sin(\\alpha) = h$$\n这意味着 $\\sin(\\alpha) = h/L_f$。为使此关系具有物理意义，肌纤维长度必须至少等于肌肉厚度，即 $L_f \\ge h$。因此，决定肌纤维力在肌腱轴上投影的羽状角余弦为：\n$$\\cos(\\alpha) = \\sqrt{1 - \\sin^2(\\alpha)} = \\sqrt{1 - \\left(\\frac{h}{L_f}\\right)^2} = \\frac{\\sqrt{L_f^2 - h^2}}{L_f}$$\n肌纤维力的轴向分量是 $F_f \\cos(\\alpha)$。\n\nMTU的总长度 $L_{MTU}$ 是肌腱长度 $L_t$ 和肌纤维轴向投影之和。投射到肌腱轴上的肌纤维束长度为 $L_{f,proj} = L_f \\cos(\\alpha) = \\sqrt{L_f^2 - h^2}$。因此，肌腱长度为：\n$$L_t = L_{MTU} - L_{f,proj} = L_{MTU} - \\sqrt{L_f^2 - h^2}$$\n肌腱被建模为刚度为 $k_t$、松弛长度为 $L_{t0}$ 的线性弹簧。只有当肌腱被拉伸超过其松弛长度时，其张力 $T$ 才不为零：\n$$T = k_t \\max(0, L_t - L_{t0})$$\n在准静态平衡中，肌腱中的张力必须平衡肌纤维力的轴向分量。\n$$T = F_f \\cos(\\alpha)$$\n只有当肌腱绷紧时，即 $T > 0$，此平衡才成立。如果对于所有可能的肌纤维长度，肌腱都保持松弛（$L_t \\le L_{t0}$），则没有力向外传递，因此外力 $F_{ext}$ 为零。外力等于肌腱张力，即 $F_{ext} = T$。\n\n我们来分析肌腱绷紧的条件。条件是 $L_t > L_{t0}$，这可以转化为 $L_{MTU} - \\sqrt{L_f^2 - h^2} > L_{t0}$，或者 $L_{MTU} - L_{t0} > \\sqrt{L_f^2 - h^2}$。由于对于所有允许的 $L_f \\ge h$，都有 $\\sqrt{L_f^2 - h^2} \\ge 0$，因此在任何肌纤维长度下肌腱绷紧的一个必要条件是 $L_{MTU} - L_{t0} > 0$。如果 $L_{MTU} \\le L_{t0}$，那么对于所有 $L_f \\ge h$，都有 $L_{MTU} - L_{t0} \\le 0 \\le \\sqrt{L_f^2 - h^2}$。这意味着对于所有允许的 $L_f$，$L_t = L_{MTU} - \\sqrt{L_f^2 - h^2} \\le L_{t0}$。在这种情况下，肌腱总是松弛的，因此 $F_{ext} = T = 0$。\n\n如果 $L_{MTU} > L_{t0}$，则可能存在肌腱绷紧的平衡状态。我们可以将 $T$ 和 $F_f \\cos(\\alpha)$ 的表达式代入平衡方程中：\n$$k_t (L_t - L_{t0}) = (\\sigma_f A) \\frac{\\sqrt{L_f^2 - h^2}}{L_f}$$\n代入 $L_t$ 的表达式：\n$$k_t \\left( (L_{MTU} - \\sqrt{L_f^2 - h^2}) - L_{t0} \\right) = (\\sigma_f A) \\frac{\\sqrt{L_f^2 - h^2}}{L_f}$$\n这是一个关于单一未知变量 $L_f$ 的非线性方程。为了求解 $L_f$，我们可以定义一个残差函数 $g(L_f)$，并找到它的根：\n$$g(L_f) = k_t (L_{MTU} - L_{t0}) - k_t \\sqrt{L_f^2 - h^2} - (\\sigma_f A) \\frac{\\sqrt{L_f^2 - h^2}}{L_f}$$\n$$g(L_f) = k_t (L_{MTU} - L_{t0}) - \\left(k_t + \\frac{\\sigma_f A}{L_f}\\right) \\sqrt{L_f^2 - h^2} = 0$$\n解必须在域 $L_f \\in (h, \\infty)$ 中寻找。函数 $g(L_f)$ 在 $L_f > h$ 时是单调递减的，这确保了如果根存在，它就是唯一的。如果 $g(L_f)$ 在此域内变号，则根存在。在下界 $L_f \\to h^+$ 时，$g(h) = k_t(L_{MTU} - L_{t0})$。当 $L_f \\to \\infty$ 时，$g(L_f) \\to -\\infty$。因此，当且仅当 $g(h) > 0$ 时，存在唯一的 $L_f$ 的根，这简化为 $L_{MTU} > L_{t0}$。\n\n### 2. 数值算法\n\n#### 2.1. 外力 $F_{ext}$ 的计算\n\n对于给定的参数集 $(\\sigma_f, A, h, L_{MTU}, L_{t0}, k_t)$，计算 $F_{ext}$ 的总过程如下：\n\n1.  **检查松弛条件：** 首先，评估是否 $L_{MTU} \\le L_{t0}$。如果满足此条件，则肌腱始终处于松弛状态。设置 $F_{ext} = 0$ 并终止。\n\n2.  **求解平衡肌纤维长度：** 如果 $L_{MTU} > L_{t0}$，则求解非线性方程 $g(L_f)=0$ 以获得平衡肌纤维长度 $L_f^*$。这需要一个数值求根方法。\n    *   **方法：** 像 Brent 方法这样稳健的方法是合适的。\n    *   **区间：** 需要一个有效的搜索区间 $[a, b]$，使得 $g(a)g(b)  0$。\n        *   下界为 $a > h$。我们可以选择 $a = h + \\delta$（其中 $\\delta$ 是一个小的正数）以避免边界处的数值问题。此时，$g(a) \\approx g(h) > 0$。\n        *   可以通过考虑肌纤维投影长度的物理极限来找到上界 $b$。投影长度 $\\sqrt{L_f^2 - h^2}$ 不能超过最大可能的肌腱拉伸量 $L_{MTU} - L_{t0}$。这给出了 $L_f$ 的一个上限：$b = \\sqrt{(L_{MTU}-L_{t0})^2 + h^2}$。在此值处，$g(b) = -(\\sigma_f A/b)(L_{MTU}-L_{t0})  0$。\n        *   因此，根 $L_f^*$ 保证位于 $(a, b)$ 内。\n\n3.  **计算力：** 一旦确定了平衡肌纤维长度 $L_f^*$，就计算外力 $F_{ext}$。使用平衡关系的肌腱侧进行计算在数值上是稳健的：\n    $$F_{ext} = T = k_t (L_t^* - L_{t0}) = k_t (L_{MTU} - \\sqrt{(L_f^*)^2 - h^2} - L_{t0})$$\n\n#### 2.2. 敏感性分析\n\n对于参数 $x$，$F_{ext}$ 的局部相对敏感性定义为 $S_x = \\frac{x}{F_{ext}} \\frac{\\partial F_{ext}}{\\partial x}$。偏导数使用分数扰动 $\\varepsilon = 10^{-4}$ 的对称有限差分格式来近似。\n\n对于参数 $x$ 的偏导数为：\n$$\\frac{\\partial F_{ext}}{\\partial x} \\approx \\frac{F_{ext}(x + \\Delta x) - F_{ext}(x - \\Delta x)}{2 \\Delta x}$$\n其中 $\\Delta x = \\varepsilon x$。将此代入敏感性定义中得到：\n$$S_x \\approx \\frac{x}{F_{ext}} \\frac{F_{ext}(x(1+\\varepsilon)) - F_{ext}(x(1-\\varepsilon))}{2 \\varepsilon x} = \\frac{F_{ext}(x(1+\\varepsilon)) - F_{ext}(x(1-\\varepsilon))}{2 \\varepsilon F_{ext}}$$\n该公式通过分别扰动 $A$、$h$ 和 $k_t$ 来计算 $S_A$、$S_h$ 和 $S_{k_t}$。每次用扰动后的参数评估 $F_{ext}$ 都需要重新运行 2.1 节中描述的整个力计算过程。\n\n如果基线力 $F_{ext}$ 为零，问题规定所有敏感性（$S_A, S_h, S_{k_t}$）都应报告为 $0.0$。这通过在敏感性计算前进行显式检查来处理。\n\n这个从第一性原理推导出来的全面、分步的程序确保了解决方案的正确性和稳健性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the final output.\n    \"\"\"\n    \n    # Test suite (sigma_f, A, h, L_MTU, L_t0, k_t)\n    # Units: Pa, m^2, m, m, m, N/m\n    test_cases = [\n        (3.2e5, 2.2e-2, 2.0e-2, 3.6e-1, 2.4e-1, 1.5e5),\n        (3.0e5, 1.9e-2, 2.5e-2, 2.8e-1, 2.9e-1, 1.0e5),\n        (2.8e5, 3.0e-2, 6.0e-2, 4.5e-1, 2.7e-1, 2.0e5),\n        (3.0e5, 2.0e-2, 3.0e-2, 4.0e-1, 2.6e-1, 1.0e6),\n    ]\n\n    results = []\n    for params in test_cases:\n        result_case = process_case(params)\n        results.append(result_case)\n\n    # Format the final output string as per requirements.\n    # e.g., [[f1,sA1,sh1,sk1],[f2,sA2,sh2,sk2],...] with no spaces.\n    output_str = '[' + ','.join([f'[{\",\".join(map(str, sublist))}]' for sublist in results]) + ']'\n    print(output_str)\n\ndef process_case(params):\n    \"\"\"\n    Calculates the external force and sensitivities for a single test case.\n    \"\"\"\n    # Unpack parameters\n    sigma_f, A, h, L_MTU, L_t0, k_t = params\n    \n    # 1. Calculate the baseline external force\n    F_ext_base = compute_F_ext(sigma_f, A, h, L_MTU, L_t0, k_t)\n\n    # If force is zero, sensitivities are zero as per problem statement.\n    if F_ext_base == 0.0:\n        return [0.0, 0.0, 0.0, 0.0]\n\n    # 2. Calculate sensitivities using finite differences\n    epsilon = 1e-4\n\n    # Sensitivity to A (PCSA)\n    dA = A * epsilon\n    F_A_plus = compute_F_ext(sigma_f, A + dA, h, L_MTU, L_t0, k_t)\n    F_A_minus = compute_F_ext(sigma_f, A - dA, h, L_MTU, L_t0, k_t)\n    S_A = (F_A_plus - F_A_minus) / (2 * epsilon * F_ext_base)\n    \n    # Sensitivity to h (aponeurosis separation)\n    dh = h * epsilon\n    F_h_plus = compute_F_ext(sigma_f, A, h + dh, L_MTU, L_t0, k_t)\n    F_h_minus = compute_F_ext(sigma_f, A, h - dh, L_MTU, L_t0, k_t)\n    S_h = (F_h_plus - F_h_minus) / (2 * epsilon * F_ext_base)\n    \n    # Sensitivity to k_t (tendon stiffness)\n    dkt = k_t * epsilon\n    # Handle the case where k_t - dkt becomes zero or negative\n    kt_minus = k_t - dkt if k_t - dkt > 0 else 1e-9 * k_t\n    F_kt_plus = compute_F_ext(sigma_f, A, h, L_MTU, L_t0, k_t + dkt)\n    F_kt_minus = compute_F_ext(sigma_f, A, h, L_MTU, L_t0, kt_minus)\n    S_kt = (F_kt_plus - F_kt_minus) / (2 * epsilon * F_ext_base)\n    \n    return [round(val, 8) for val in [F_ext_base, S_A, S_h, S_kt]]\n\ndef compute_F_ext(sigma_f, A, h, L_MTU, L_t0, k_t):\n    \"\"\"\n    Computes external tendon force based on muscle-tendon parameters.\n    \"\"\"\n    # Step 1: Handle guaranteed slack tendon case\n    if L_MTU = L_t0:\n        return 0.0\n\n    # Step 2: Define parameters for the solver\n    f_f = sigma_f * A\n    l_delta = L_MTU - L_t0  # Available length for tendon stretch\n\n    # Step 3: Define the residual function g(L_f) for the root finder\n    # g(L_f) = k_t*(L_MTU - L_t0) - (k_t + (sigma_f*A)/L_f) * sqrt(L_f^2 - h^2)\n    def g(L_f):\n        # This function assumes L_f > h, which is guaranteed by the solver's bracket\n        sqrt_term = np.sqrt(L_f**2 - h**2)\n        return k_t * l_delta - (k_t + f_f / L_f) * sqrt_term\n\n    # Step 4: Define the search bracket [a, b] for the root finder\n    # Lower bound 'a' must be strictly greater than h to avoid division by zero\n    a = h + 1e-9\n    \n    # Upper bound 'b' corresponds to the fiber length where its projected length\n    # equals the max possible tendon stretch: sqrt(b^2 - h^2) = l_delta\n    b = np.sqrt(l_delta**2 + h**2)\n\n    # Step 5: Check bracket validity and boundary conditions\n    if b = a:\n        # This implies l_delta is near zero, so tendon stretch and force are negligible.\n        return 0.0\n\n    try:\n        val_a = g(a)\n        val_b = g(b)\n    except (ValueError, ZeroDivisionError):\n        # Should not occur with the guarded bracket, but as a safe fallback\n        return 0.0\n\n    # If g(a) and g(b) have the same sign, root finding will fail.\n    # Based on analysis, g(a) > 0 and g(b)  0. If not, implies no valid solution.\n    if val_a * val_b >= 0:\n        return 0.0\n\n    # Step 6: Solve for the equilibrium fiber length L_f^*\n    try:\n        Lf_star = brentq(g, a, b, xtol=1e-12, rtol=1e-12)\n    except ValueError:\n        # This occurs if brentq fails, which shouldn't happen with a valid bracket.\n        return 0.0\n\n    # Step 7: Calculate the external force F_ext\n    # F_ext = T = k_t * (L_MTU - L_f_proj - L_t0) = k_t * (l_delta - L_f_proj)\n    # L_f_proj = sqrt(Lf_star^2 - h^2)\n    tendon_stretch_val = l_delta - np.sqrt(Lf_star**2 - h**2)\n    \n    # Numerical precision might make stretch slightly negative; physically it's zero.\n    if tendon_stretch_val  0:\n        return 0.0\n        \n    F_ext = k_t * tendon_stretch_val\n    return F_ext\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}