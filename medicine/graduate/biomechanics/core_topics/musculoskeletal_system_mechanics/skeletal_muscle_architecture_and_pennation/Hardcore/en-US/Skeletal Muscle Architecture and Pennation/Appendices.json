{
    "hands_on_practices": [
        {
            "introduction": "Understanding a muscle's force-generating potential begins with its architecture. This first practice guides you through deriving two of the most critical parameters from first principles: the Physiological Cross-Sectional Area ($PCSA$), which represents the muscle's total force-generating capacity, and the maximal tendon force, which is the functional output. By working through this problem , you will solidify your understanding of how muscle volume, fiber length, and pennation angle synergistically determine a muscle's strength.",
            "id": "4203055",
            "problem": "A pennate skeletal muscle is modeled as a bundle of uniformly oriented fascicles at a constant pennation angle relative to the tendon axis. Assume that the muscle is in a quasi-static configuration with constant volume and uniform fascicle length. Let the muscle volume be $V$, the fascicle length be $L_{f}$ (measured along the fascicle axis), the maximum muscle stress (specific tension) be $\\sigma_{\\max}$ (uniformly distributed across all fiber cross-sections), and the pennation angle be $\\theta$ (the angle between fascicles and the tendon axis). The Physiological Cross-Sectional Area (PCSA) is defined as the sum of cross-sectional areas of all fibers, taken perpendicular to the fiber axes.\n\nUsing only the fundamental definitions of stress ($\\sigma = F/A$), volume decomposition along the fiber axis, and geometric projection of force, derive expressions to compute the PCSA and the maximal force transmitted to the tendon under maximal activation. Then, for the numerical evaluation, use $V = 250\\,\\text{cm}^{3}$, $L_{f} = 6\\,\\text{cm}$, $\\sigma_{\\max} = 0.3\\,\\text{MPa}$, and $\\theta = 20^{\\circ}$.\n\nExpress the physiological cross-sectional area in square meters and the maximal tendon force in Newtons. Take the angle in degrees. Round each final numerical value to four significant figures.",
            "solution": "The problem statement is rigorously evaluated and found to be valid. It is scientifically grounded in the principles of biomechanics, well-posed with a complete and consistent set of givens, and expressed in objective, formal language. There are no violations of fundamental principles, missing data, or ambiguities.\n\nThe problem asks for the derivation and calculation of two quantities: the Physiological Cross-Sectional Area (PCSA) and the maximal force transmitted to the tendon ($F_{t}$). We will proceed by first deriving the symbolic expressions for these quantities based on the provided definitions and principles, and then substitute the given numerical values to find the final answers.\n\n**1. Derivation of the Physiological Cross-Sectional Area (PCSA)**\n\nThe total volume of the muscle, $V$, can be conceptualized as the sum of the volumes of all its constituent fascicles. The problem states that all fascicles have a uniform length, $L_{f}$. If we let $A_{i}$ be the cross-sectional area of the $i$-th fascicle (perpendicular to its long axis), its volume $V_i$ is given by:\n$$ V_i = A_i L_{f} $$\nThe total muscle volume $V$ is the sum of the volumes of all fascicles:\n$$ V = \\sum_{i} V_i = \\sum_{i} (A_i L_{f}) $$\nSince $L_{f}$ is a constant for all fascicles, it can be factored out of the summation:\n$$ V = L_{f} \\sum_{i} A_i $$\nThe problem defines the Physiological Cross-Sectional Area (PCSA) as the sum of the cross-sectional areas of all fibers, taken perpendicular to the fiber axes. Therefore:\n$$ \\text{PCSA} = \\sum_{i} A_i $$\nSubstituting this definition into the volume equation yields:\n$$ V = L_{f} \\cdot \\text{PCSA} $$\nSolving for PCSA, we obtain the expression:\n$$ \\text{PCSA} = \\frac{V}{L_{f}} $$\n\n**2. Derivation of the Maximal Tendon Force ($F_{t}$)**\n\nStress, $\\sigma$, is defined as force per unit area, $\\sigma = F/A$. The maximum muscle stress, $\\sigma_{\\max}$, is uniformly distributed across all fiber cross-sections. The total force generated by the muscle fibers, $F_{f}$, acts parallel to the fascicles and is the product of this maximum stress and the total area over which it is applied. This total area is the PCSA.\n$$ F_{f} = \\sigma_{\\max} \\cdot \\text{PCSA} $$\nThis force, $F_{f}$, is directed along the fascicles, which are oriented at a pennation angle $\\theta$ relative to the tendon axis. The force transmitted to the tendon, $F_{t}$, is the component of the total fiber force $F_{f}$ that is projected onto the tendon's line of action. Using basic trigonometry, this component is found by:\n$$ F_{t} = F_{f} \\cos(\\theta) $$\nSubstituting the expression for $F_{f}$ into this equation gives:\n$$ F_{t} = (\\sigma_{\\max} \\cdot \\text{PCSA}) \\cos(\\theta) $$\nFinally, we can substitute the expression for PCSA derived in the previous section to obtain the maximal tendon force purely in terms of the given initial parameters:\n$$ F_{t} = \\sigma_{\\max} \\left( \\frac{V}{L_{f}} \\right) \\cos(\\theta) $$\n\n**3. Numerical Calculation**\n\nBefore computing the numerical values, we must convert the given quantities into a consistent system of SI units (meters, kilograms, seconds, Newtons, Pascals).\nThe given values are:\n$V = 250\\,\\text{cm}^{3}$\n$L_{f} = 6\\,\\text{cm}$\n$\\sigma_{\\max} = 0.3\\,\\text{MPa}$\n$\\theta = 20^{\\circ}$\n\nThe conversions are as follows:\nVolume: $1\\,\\text{m} = 100\\,\\text{cm}$, so $1\\,\\text{m}^3 = (100\\,\\text{cm})^3 = 10^6\\,\\text{cm}^3$.\n$$ V = 250\\,\\text{cm}^3 \\times \\frac{1\\,\\text{m}^3}{10^6\\,\\text{cm}^3} = 250 \\times 10^{-6}\\,\\text{m}^3 = 2.5 \\times 10^{-4}\\,\\text{m}^3 $$\nLength:\n$$ L_{f} = 6\\,\\text{cm} \\times \\frac{1\\,\\text{m}}{100\\,\\text{cm}} = 0.06\\,\\text{m} = 6 \\times 10^{-2}\\,\\text{m} $$\nStress: $1\\,\\text{MPa} = 10^6\\,\\text{Pa} = 10^6\\,\\text{N/m}^2$.\n$$ \\sigma_{\\max} = 0.3\\,\\text{MPa} \\times \\frac{10^6\\,\\text{Pa}}{1\\,\\text{MPa}} = 0.3 \\times 10^6\\,\\text{Pa} = 3 \\times 10^5\\,\\text{N/m}^2 $$\nThe angle $\\theta = 20^{\\circ}$ is used as given.\n\nNow we can compute the numerical values.\n\n**PCSA Calculation**:\n$$ \\text{PCSA} = \\frac{V}{L_{f}} = \\frac{2.5 \\times 10^{-4}\\,\\text{m}^3}{6 \\times 10^{-2}\\,\\text{m}} $$\n$$ \\text{PCSA} = \\frac{2.5}{6} \\times 10^{-2}\\,\\text{m}^2 \\approx 0.41666... \\times 10^{-2}\\,\\text{m}^2 = 4.1666... \\times 10^{-3}\\,\\text{m}^2 $$\nRounding to four significant figures, we get:\n$$ \\text{PCSA} \\approx 4.167 \\times 10^{-3}\\,\\text{m}^2 $$\n\n**Maximal Tendon Force Calculation**:\n$$ F_{t} = \\sigma_{\\max} \\cdot \\text{PCSA} \\cdot \\cos(\\theta) $$\nUsing the unrounded value of PCSA for accuracy:\n$$ F_{t} = (3 \\times 10^5\\,\\text{N/m}^2) \\times (4.1666... \\times 10^{-3}\\,\\text{m}^2) \\times \\cos(20^{\\circ}) $$\n$$ F_{t} = (3 \\times 4.1666...) \\times 10^{5-3} \\times \\cos(20^{\\circ})\\,\\text{N} $$\n$$ F_{t} = 12.5 \\times 10^2 \\times \\cos(20^{\\circ})\\,\\text{N} = 1250 \\times \\cos(20^{\\circ})\\,\\text{N} $$\nUsing the value $\\cos(20^{\\circ}) \\approx 0.93969262$:\n$$ F_{t} \\approx 1250 \\times 0.93969262\\,\\text{N} \\approx 1174.6157...\\,\\text{N} $$\nRounding to four significant figures, we get:\n$$ F_{t} \\approx 1175\\,\\text{N} $$\nThe final results are a physiological cross-sectional area of approximately $4.167 \\times 10^{-3}\\,\\text{m}^2$ and a maximal tendon force of approximately $1175\\,\\text{N}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 4.167 \\times 10^{-3}  1175 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Real muscles exhibit significant architectural heterogeneity, a feature our simplest models often ignore. This exercise  challenges you to advance beyond the single-angle assumption and consider a more realistic scenario where pennation angles vary across the muscle. You will learn to calculate the total tendon force by integrating the contributions of fibers with a distributed range of orientations, a key skill for modeling complex biological structures.",
            "id": "4203003",
            "problem": "A pennate skeletal muscle has fibers oriented at a pennation angle $\\theta$ relative to the tendon axis. Assume the muscle is activated to maximal fiber stress (specific tension) that is spatially uniform across all fibers. The Physiological Cross-Sectional Area (PCSA) is defined as the sum of all fiber cross-sectional areas measured normal to each fiber’s axis. Let the total PCSA be $A_{\\mathrm{PCSA}} = 0.0024\\,\\mathrm{m}^2$. The maximal specific tension is $\\sigma_0 = 3.1 \\times 10^{5}\\,\\mathrm{N/m}^2$. Across the muscle, the pennation angle varies such that $\\theta$ is uniformly distributed over the interval $[10^{\\circ}, 30^{\\circ}]$.\n\nStarting from the definitions of stress, force, and vector projection, and the interpretation of PCSA as an area integral over fibers, derive the expression for the maximal tendon-directed force $F_{\\max}$ in terms of an area-weighted average over the fiber orientations. Then, compute the numerical value of $F_{\\max}$ using the given data. In your calculation, treat angles in degrees but convert appropriately to radians for any trigonometric integration. Express the final force in Newtons and round your answer to four significant figures.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of biomechanics, is well-posed with all necessary information provided, and is expressed in objective, formal language. We may therefore proceed with a solution.\n\nThe task is to first derive an expression for the maximal tendon-directed force, $F_{\\max}$, and then compute its numerical value.\n\nThe force generated by a muscle fiber is proportional to its cross-sectional area and the stress (specific tension) it develops. Let us consider an infinitesimal bundle of muscle fibers having a collective physiological cross-sectional area (PCSA) of $dA$. The problem states a uniform maximal specific tension $\\sigma_0$, so the force generated by this bundle along its own axis is given by the definition of stress:\n$$\ndF_{\\mathrm{fiber}} = \\sigma_0 \\, dA\n$$\nThis force is directed along the fiber axis. The pennation angle, $\\theta$, is the angle between the fiber axis and the tendon axis. To find the contribution of this infinitesimal force to the force along the tendon, we must project $dF_{\\mathrm{fiber}}$ onto the tendon axis. This is achieved by multiplying by the cosine of the pennation angle:\n$$\ndF_{\\mathrm{tendon}} = dF_{\\mathrm{fiber}} \\cos(\\theta) = \\sigma_0 \\cos(\\theta) \\, dA\n$$\nThe total maximal force exerted on the tendon, $F_{\\max}$, is the sum of all such infinitesimal contributions from across the entire PCSA of the muscle. This summation is represented by an integral over the total PCSA, $A_{\\mathrm{PCSA}}$:\n$$\nF_{\\max} = \\int_{A_{\\mathrm{PCSA}}} dF_{\\mathrm{tendon}} = \\int_{A_{\\mathrm{PCSA}}} \\sigma_0 \\cos(\\theta) \\, dA\n$$\nSince the maximal specific tension $\\sigma_0$ is assumed to be uniform across all fibers, it is a constant and can be taken out of the integral:\n$$\nF_{\\max} = \\sigma_0 \\int_{A_{\\mathrm{PCSA}}} \\cos(\\theta) \\, dA\n$$\nThe problem asks for an expression in terms of an area-weighted average. The area-weighted average of a quantity $g(\\theta)$ over the PCSA is defined as:\n$$\n\\langle g(\\theta) \\rangle_A = \\frac{1}{A_{\\mathrm{PCSA}}} \\int_{A_{\\mathrm{PCSA}}} g(\\theta) \\, dA\n$$\nApplying this definition to our expression for $F_{\\max}$ with $g(\\theta) = \\cos(\\theta)$, we can rewrite the integral as:\n$$\n\\int_{A_{\\mathrm{PCSA}}} \\cos(\\theta) \\, dA = A_{\\mathrm{PCSA}} \\langle \\cos(\\theta) \\rangle_A\n$$\nSubstituting this back into the equation for $F_{\\max}$ yields the desired expression:\n$$\nF_{\\max} = \\sigma_0 A_{\\mathrm{PCSA}} \\langle \\cos(\\theta) \\rangle_A\n$$\nHere, $\\langle \\cos(\\theta) \\rangle_A$ represents the area-weighted average of the cosine of the pennation angle.\n\nNext, we must compute the numerical value of $F_{\\max}$. The problem states that the pennation angle $\\theta$ is uniformly distributed over the interval $[10^{\\circ}, 30^{\\circ}]$. This implies that the probability density function, $p(\\theta)$, of the angle $\\theta$ (with respect to its contribution to PCSA) is constant over this interval and zero elsewhere. The average value of $\\cos(\\theta)$ can thus be calculated as:\n$$\n\\langle \\cos(\\theta) \\rangle_A = \\int_{-\\infty}^{\\infty} \\cos(\\theta) p(\\theta) \\, d\\theta\n$$\nFor a uniform distribution over an interval $[\\theta_{\\min}, \\theta_{\\max}]$, the probability density function is $p(\\theta) = \\frac{1}{\\theta_{\\max} - \\theta_{\\min}}$ for $\\theta \\in [\\theta_{\\min}, \\theta_{\\max}]$ and $p(\\theta) = 0$ otherwise.\n\nFor integration, angles must be in radians. The given interval is $[10^{\\circ}, 30^{\\circ}]$.\nThe minimum angle is $\\theta_{\\min} = 10^{\\circ} = 10 \\times \\frac{\\pi}{180} = \\frac{\\pi}{18}$ radians.\nThe maximum angle is $\\theta_{\\max} = 30^{\\circ} = 30 \\times \\frac{\\pi}{180} = \\frac{\\pi}{6}$ radians.\nThe width of the interval in radians is $\\Delta\\theta = \\theta_{\\max} - \\theta_{\\min} = \\frac{\\pi}{6} - \\frac{\\pi}{18} = \\frac{3\\pi - \\pi}{18} = \\frac{2\\pi}{18} = \\frac{\\pi}{9}$.\n\nThe probability density function is $p(\\theta) = \\frac{1}{\\Delta\\theta} = \\frac{1}{\\pi/9} = \\frac{9}{\\pi}$ for $\\theta \\in [\\frac{\\pi}{18}, \\frac{\\pi}{6}]$.\nNow we compute the average value of $\\cos(\\theta)$:\n$$\n\\langle \\cos(\\theta) \\rangle_A = \\int_{\\pi/18}^{\\pi/6} \\cos(\\theta) \\left(\\frac{9}{\\pi}\\right) d\\theta = \\frac{9}{\\pi} \\int_{\\pi/18}^{\\pi/6} \\cos(\\theta) \\, d\\theta\n$$\nThe integral of $\\cos(\\theta)$ is $\\sin(\\theta)$. Evaluating the definite integral:\n$$\n\\langle \\cos(\\theta) \\rangle_A = \\frac{9}{\\pi} [\\sin(\\theta)]_{\\pi/18}^{\\pi/6} = \\frac{9}{\\pi} \\left( \\sin\\left(\\frac{\\pi}{6}\\right) - \\sin\\left(\\frac{\\pi}{18}\\right) \\right)\n$$\nWe know that $\\sin(\\pi/6) = \\sin(30^{\\circ}) = 0.5$. The term $\\sin(\\pi/18) = \\sin(10^{\\circ})$ must be calculated numerically.\n$$\n\\langle \\cos(\\theta) \\rangle_A = \\frac{9}{\\pi} \\left( 0.5 - \\sin\\left(\\frac{\\pi}{18}\\right) \\right)\n$$\nUsing a calculator, $\\sin(\\pi/18) \\approx 0.173648$.\n$$\n\\langle \\cos(\\theta) \\rangle_A \\approx \\frac{9}{\\pi} (0.5 - 0.173648) = \\frac{9}{\\pi} (0.326352) \\approx 0.935105\n$$\nNow, we can compute $F_{\\max}$ using the given values:\n$\\sigma_0 = 3.1 \\times 10^{5}\\,\\mathrm{N/m}^2$\n$A_{\\mathrm{PCSA}} = 0.0024\\,\\mathrm{m}^2$\n\n$$\nF_{\\max} = \\sigma_0 A_{\\mathrm{PCSA}} \\langle \\cos(\\theta) \\rangle_A = (3.1 \\times 10^{5}\\,\\mathrm{N/m}^2) \\times (0.0024\\,\\mathrm{m}^2) \\times \\langle \\cos(\\theta) \\rangle_A\n$$\nFirst, calculate the product of $\\sigma_0$ and $A_{\\mathrm{PCSA}}$:\n$$\n\\sigma_0 A_{\\mathrm{PCSA}} = (3.1 \\times 10^5) \\times (2.4 \\times 10^{-3}) = 7.44 \\times 10^2 = 744\\,\\mathrm{N}\n$$\nThis quantity represents the theoretical maximum force if all fibers were parallel to the tendon ($\\theta=0$). Now, multiply by the average cosine factor:\n$$\nF_{\\max} = 744\\,\\mathrm{N} \\times 0.935105 \\approx 695.71813\\,\\mathrm{N}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nF_{\\max} \\approx 695.7\\,\\mathrm{N}\n$$",
            "answer": "$$\\boxed{695.7}$$"
        },
        {
            "introduction": "Biomechanical models are powerful tools, but their utility depends on the validity of their underlying assumptions. This advanced computational practice  moves from static calculations to a dynamic context, asking you to test the ubiquitous constant-volume model against simulated, noisy data from a contracting muscle-tendon unit. By reconstructing architectural parameters from force and angle measurements and quantifying the model's error, you will gain direct experience in the critical process of model validation, a fundamental skill in modern biomechanics research.",
            "id": "4203008",
            "problem": "Consider a pennate skeletal muscle modeled as incompressible and attached between two inextensible, parallel aponeuroses. Let the muscle fiber length be denoted by $L_f(t)$, the pennation angle by $\\theta(t)$, the aponeurosis separation (muscle thickness) by $h(t)$, the musculotendon length by $L_{mt}(t)$, the tendon length by $L_t(t)$, and the tendon force by $F_t(t)$. Assume angles are measured in radians. For a two-dimensional architectural idealization with fibers inserting on parallel aponeuroses, use the following fundamental geometric and mechanical relations:\n- Kinematic projection along the tendon axis: $L_{mt}(t) = L_t(t) + L_f(t)\\cos\\theta(t)$.\n- Geometric relation between thickness and fiber geometry: $h(t) = L_f(t)\\sin\\theta(t)$.\n- Linear elastic tendon with slack length: $F_t(t) = k_t \\max\\{0, L_t(t) - L_{ts}\\}$, where $k_t$ is stiffness and $L_{ts}$ is slack length.\n\nThe constant-volume thickness model posits that $h(t)$ is approximately constant during contraction under incompressibility and negligible aponeurosis separation change, i.e., $h(t) \\approx h^\\star$.\n\nTask: Given time-series data of $\\theta(t)$ and $F_t(t)$ during dynamic contractions, with known $L_{mt}(t)$, $k_t$, and $L_{ts}$, reconstruct $h(t)$ from measurements and test whether the constant-volume thickness model explains the data by fitting a constant $h^\\star$ in a least-squares sense. Quantify the fit using the normalized root-mean-square error (NRMSE) defined by\n$$\n\\mathrm{NRMSE} = \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^N\\big(h_i - h^\\star\\big)^2}}{h^\\star},\n$$\nwhere $h^\\star = \\frac{1}{N}\\sum_{i=1}^N h_i$ is the best constant fit and $N$ is the number of time samples.\n\nReconstruction procedure (to be implemented in code):\n1. Compute $L_t(t)$ from the measured tendon force using $L_t(t) = L_{ts} + \\frac{F_t(t)}{k_t}$, with $F_t(t)$ clipped to be nonnegative (i.e., if noise makes it negative, set it to zero).\n2. Compute the fiber-axis projection $L_f(t)\\cos\\theta(t) = L_{mt}(t) - L_t(t)$.\n3. Recover $L_f(t)$ using $L_f(t) = \\frac{L_{mt}(t) - L_t(t)}{\\cos\\theta(t)}$.\n4. Compute the reconstructed thickness time series $h(t) = L_f(t)\\sin\\theta(t)$.\n5. Fit $h^\\star$ as the mean of $h(t)$ over all samples and evaluate $\\mathrm{NRMSE}$.\n\nYou must implement the above procedure and apply it to the following test suite of three synthetic cases. In all cases, generate a time vector $t$ with $N = 201$ uniformly spaced points over $[0,1]$ seconds. All angles must be computed and used in radians, all forces in newtons, and all lengths in meters. Noise is additive, independent, zero-mean Gaussian, with a specified standard deviation and a specified random seed. For each case, first generate the ground-truth signals and then add noise to obtain the measured $\\theta(t)$ and $F_t(t)$.\n\nFor each case, the tendon force is generated from geometry and tendon mechanics as follows:\n- Given a ground-truth thickness $h_{\\text{true}}(t)$ and ground-truth pennation $\\theta_{\\text{true}}(t)$, compute the ground-truth tendon length $L_t^{\\text{true}}(t) = L_{mt} - h_{\\text{true}}(t)\\cot\\theta_{\\text{true}}(t)$, where $\\cot\\theta = \\frac{\\cos\\theta}{\\sin\\theta}$.\n- Compute $F_t^{\\text{true}}(t) = k_t \\max\\{0, L_t^{\\text{true}}(t) - L_{ts}\\}$.\n- Add noise to obtain measured $\\theta(t)$ and $F_t(t)$:\n  - $\\theta(t) = \\theta_{\\text{true}}(t) + \\eta_\\theta(t)$, where $\\eta_\\theta(t) \\sim \\mathcal{N}(0, \\sigma_\\theta^2)$.\n  - $F_t(t) = \\max\\{0, F_t^{\\text{true}}(t) + \\eta_F(t)\\}$, where $\\eta_F(t) \\sim \\mathcal{N}(0, \\sigma_F^2)$.\n- Use the specified random number generator seed for each case to ensure reproducibility.\n\nTest Suite:\n- Case A (model-consistent dynamic pennation, moderate angles):\n  - Parameters: $L_{mt} = 0.35$ m, $L_{ts} = 0.18$ m, $k_t = 50000$ N/m, $h_0 = 0.03$ m.\n  - Ground-truth pennation: $\\theta_{\\text{true}}(t) = \\theta_0 + \\Delta\\theta \\sin(2\\pi f t)$ with $\\theta_0 = 20$ degrees, $\\Delta\\theta = 10$ degrees, $f = 1$ Hz. Convert degrees to radians via multiplication by $\\pi/180$.\n  - Ground-truth thickness: $h_{\\text{true}}(t) \\equiv h_0$.\n  - Measurement noise: $\\sigma_\\theta = 0.25$ degrees (converted to radians), $\\sigma_F = 25$ N, random seed $= 7$.\n- Case B (violating constant-thickness via time-varying thickness):\n  - Parameters: $L_{mt} = 0.35$ m, $L_{ts} = 0.18$ m, $k_t = 50000$ N/m, $h_0 = 0.03$ m.\n  - Ground-truth pennation: same as Case A.\n  - Ground-truth thickness: $h_{\\text{true}}(t) = h_0\\left(1 + 0.1\\sin(2\\pi f t)\\right)$ with $f = 1$ Hz.\n  - Measurement noise: $\\sigma_\\theta = 0.25$ degrees (converted to radians), $\\sigma_F = 25$ N, random seed $= 11$.\n- Case C (model-consistent, low pennation angles as a boundary-like condition):\n  - Parameters: $L_{mt} = 0.25$ m, $L_{ts} = 0.05$ m, $k_t = 80000$ N/m, $h_0 = 0.01$ m.\n  - Ground-truth pennation: $\\theta_{\\text{true}}(t) = \\theta_0 + \\Delta\\theta \\sin(2\\pi f t)$ with $\\theta_0 = 5.5$ degrees, $\\Delta\\theta = 2.5$ degrees, $f = 1$ Hz. Convert degrees to radians via multiplication by $\\pi/180$.\n  - Ground-truth thickness: $h_{\\text{true}}(t) \\equiv h_0$.\n  - Measurement noise: $\\sigma_\\theta = 0.10$ degrees (converted to radians), $\\sigma_F = 15$ N, random seed $= 13$.\n\nImplementation requirements:\n- For each case, generate $t$, $\\theta_{\\text{true}}(t)$, $h_{\\text{true}}(t)$ as specified, compute $F_t^{\\text{true}}(t)$ from geometry and tendon stiffness, then add noise to obtain measured $\\theta(t)$ and $F_t(t)$ using the specified standard deviations and random seed.\n- Using only the measured $\\theta(t)$ and $F_t(t)$ together with the known $L_{mt}$, $k_t$, and $L_{ts}$ for that case, reconstruct $h(t)$ and compute the $\\mathrm{NRMSE}$ for the best constant $h^\\star$.\n- Angles must be in radians at all computational steps. Forces in newtons, lengths in meters.\n- Your program should produce a single line of output containing the three $\\mathrm{NRMSE}$ values for Cases A, B, and C, respectively, rounded to six decimal places, as a comma-separated list enclosed in square brackets (e.g., \"[0.012345,0.067890,0.001234]\").",
            "solution": "The user-provided problem statement has been critically examined and is determined to be **valid**. It is scientifically grounded in the principles of biomechanics, well-posed with a complete and consistent set of definitions and parameters, and computationally feasible. The task is to implement a reconstruction algorithm to test the \"constant-volume thickness\" hypothesis for a pennate muscle model and quantify its validity using the Normalized Root-Mean-Square Error (NRMSE) on three synthetic test cases.\n\nThe solution is structured as follows:\n1.  **Overview of the Musculoskeletal Model**: First, we articulate the foundational principles governing the idealized pennate muscle.\n2.  **Data Generation Methodology**: We describe the process of creating synthetic, ground-truth data and subsequently corrupting it with noise to simulate experimental measurements.\n3.  **Reconstruction Algorithm**: We detail the step-by-step procedure to reconstruct the muscle thickness, $h(t)$, from the noisy measurements.\n4.  **Error Quantification**: We explain the rationale behind using the NRMSE to evaluate the constant-thickness model.\n\n**1. Overview of the Musculoskeletal Model**\n\nThe problem models a pennate muscle as a set of fibers of length $L_f(t)$ oriented at a pennation angle $\\theta(t)$ relative to the muscle's line of action. These fibers are attached to two parallel aponeuroses, whose separation defines the muscle thickness $h(t)$. The entire muscle-tendon unit, with length $L_{mt}(t)$, includes an elastic tendon of length $L_t(t)$. The geometry dictates two fundamental relationships:\n\n- The muscle thickness is the projection of the fiber length perpendicular to the line of action:\n  $$h(t) = L_f(t)\\sin\\theta(t)$$\n- The total musculotendon length is the sum of the tendon length and the projection of the fiber length along the line of action:\n  $$L_{mt}(t) = L_t(t) + L_f(t)\\cos\\theta(t)$$\n\nCombining these two equations allows for expressing one variable in terms of others. For instance, solving for $L_f(t)$ from the first equation and substituting into the second yields:\n$$L_{mt}(t) = L_t(t) + \\frac{h(t)}{\\sin\\theta(t)}\\cos\\theta(t) = L_t(t) + h(t)\\cot\\theta(t)$$\n\nThe tendon is modeled as a linear spring with stiffness $k_t$ and a slack length $L_{ts}$. It only bears tensile force, so the force-length relationship is:\n$$F_t(t) = k_t \\max\\{0, L_t(t) - L_{ts}\\}$$\n\nThe core hypothesis to be tested is the constant-volume (isovolumetric) assumption, which under conditions of negligible aponeurosis strain, simplifies to the muscle thickness being approximately constant, i.e., $h(t) \\approx h^\\star$.\n\n**2. Data Generation Methodology**\n\nTo test the reconstruction algorithm, we first generate synthetic data for which the ground truth is known. The procedure is as follows for each test case:\n\n- A time vector $t$ is created with $N=201$ points from $t=0$ to $t=1$ seconds.\n- Ground-truth time series for pennation angle, $\\theta_{\\text{true}}(t)$, and muscle thickness, $h_{\\text{true}}(t)$, are generated according to the specifications for each case. All angles given in degrees are converted to radians.\n- Using the geometric relation $L_{mt}(t) = L_t(t) + h(t)\\cot\\theta(t)$, we compute the ground-truth tendon length required to satisfy the geometry:\n  $$L_t^{\\text{true}}(t) = L_{mt} - h_{\\text{true}}(t)\\cot\\theta_{\\text{true}}(t)$$\n  Here, $L_{mt}$ is given as a constant for each case.\n- The ground-truth tendon force, $F_t^{\\text{true}}(t)$, is then calculated from the tendon's mechanical properties:\n  $$F_t^{\\text{true}}(t) = k_t \\max\\{0, L_t^{\\text{true}}(t) - L_{ts}\\}$$\n- To simulate realistic measurement conditions, we add zero-mean Gaussian noise to the ground-truth signals. A specified random seed ensures reproducibility.\n  $$\\theta(t) = \\theta_{\\text{true}}(t) + \\eta_\\theta(t), \\quad \\text{where } \\eta_\\theta \\sim \\mathcal{N}(0, \\sigma_\\theta^2)$$\n  $$F_t(t) = \\max\\{0, F_t^{\\text{true}}(t) + \\eta_F(t)\\}, \\quad \\text{where } \\eta_F \\sim \\mathcal{N}(0, \\sigma_F^2)$$\n  The resulting $\\theta(t)$ and $F_t(t)$ serve as the \"measured\" inputs for our reconstruction algorithm.\n\n**3. Reconstruction Algorithm**\n\nThe objective is to work backward from the measured quantities—tendon force $F_t(t)$ and pennation angle $\\theta(t)$—to estimate the muscle thickness $h(t)$. The known parameters are $L_{mt}$, $L_{ts}$, and $k_t$.\n\n- **Step 1: Estimate Tendon Length.** We invert the tendon force-length relationship to find the tendon length $L_t(t)$. The measured force $F_t(t)$ is first ensured to be non-negative.\n  $$L_t(t) = L_{ts} + \\frac{F_t(t)}{k_t}$$\n\n- **Step 2: Determine Fiber Length Projection.** From the overall kinematic constraint, $L_{mt}(t) = L_t(t) + L_f(t)\\cos\\theta(t)$, we can isolate the contribution of the muscle fiber projected along the tendon axis:\n  $$L_f(t)\\cos\\theta(t) = L_{mt} - L_t(t)$$\n\n- **Step 3  4: Reconstruct Thickness.** The two fundamental geometric equations can be combined to relate thickness $h(t)$ directly to the fiber's projected length and the pennation angle.\n  $$h(t) = L_f(t)\\sin\\theta(t) = \\left(\\frac{L_f(t)\\cos\\theta(t)}{\\cos\\theta(t)}\\right)\\sin\\theta(t) = \\big(L_f(t)\\cos\\theta(t)\\big) \\tan\\theta(t)$$\n  Substituting the result from Step 2 gives the final reconstruction formula for the time series $h(t)$:\n  $$h(t) = \\left(L_{mt} - L_t(t)\\right) \\tan\\theta(t)$$\n  This combined form is computationally efficient.\n\n**4. Error Quantification**\n\nAfter reconstructing the time series $h(t)$, we assess how well it conforms to the constant-thickness model $h(t) \\approx h^\\star$. The best constant fit in a least-squares sense is simply the mean of the reconstructed data:\n$$h^\\star = \\frac{1}{N}\\sum_{i=1}^N h_i$$\nThe deviation of the reconstructed thickness from this constant value is quantified by the Normalized Root-Mean-Square Error (NRMSE). This metric is the standard deviation of the signal divided by its mean, also known as the coefficient of variation.\n$$\\mathrm{NRMSE} = \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^N\\big(h_i - h^\\star\\big)^2}}{h^\\star} = \\frac{\\sigma_h}{h^\\star}$$\nA small NRMSE indicates that the reconstructed thickness $h(t)$ has low variability and is well-approximated by a constant, supporting the constant-volume thickness model for the given data. A large NRMSE suggests that the model is a poor fit, either because the underlying physiology violates the assumption (as in Case B) or because noise and numerical sensitivity degrade the reconstruction accuracy (a potential issue in Case C). By comparing the NRMSE across the three test cases, we can evaluate the robustness of both the model and the reconstruction method.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the three test cases and print the results.\n    \"\"\"\n    \n    test_cases = [\n        # Case A\n        {\n            \"name\": \"A\",\n            \"L_mt\": 0.35, \"L_ts\": 0.18, \"k_t\": 50000, \"h_0\": 0.03,\n            \"theta_0_deg\": 20, \"delta_theta_deg\": 10, \"f\": 1.0,\n            \"h_true_func\": lambda h0, t, f: np.full_like(t, h0),\n            \"sigma_theta_deg\": 0.25, \"sigma_F\": 25, \"seed\": 7\n        },\n        # Case B\n        {\n            \"name\": \"B\",\n            \"L_mt\": 0.35, \"L_ts\": 0.18, \"k_t\": 50000, \"h_0\": 0.03,\n            \"theta_0_deg\": 20, \"delta_theta_deg\": 10, \"f\": 1.0,\n            \"h_true_func\": lambda h0, t, f: h0 * (1 + 0.1 * np.sin(2 * np.pi * f * t)),\n            \"sigma_theta_deg\": 0.25, \"sigma_F\": 25, \"seed\": 11\n        },\n        # Case C\n        {\n            \"name\": \"C\",\n            \"L_mt\": 0.25, \"L_ts\": 0.05, \"k_t\": 80000, \"h_0\": 0.01,\n            \"theta_0_deg\": 5.5, \"delta_theta_deg\": 2.5, \"f\": 1.0,\n            \"h_true_func\": lambda h0, t, f: np.full_like(t, h0),\n            \"sigma_theta_deg\": 0.10, \"sigma_F\": 15, \"seed\": 13\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        nrmse = calculate_nrmse_for_case(params)\n        results.append(nrmse)\n\n    # Format output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef calculate_nrmse_for_case(params):\n    \"\"\"\n    Performs the full simulation and reconstruction for a single test case.\n\n    Args:\n        params (dict): A dictionary containing all parameters for the case.\n\n    Returns:\n        float: The calculated NRMSE value.\n    \"\"\"\n    # Unpack parameters\n    L_mt = params[\"L_mt\"]\n    L_ts = params[\"L_ts\"]\n    k_t = params[\"k_t\"]\n    h_0 = params[\"h_0\"]\n    f = params[\"f\"]\n    seed = params[\"seed\"]\n    sigma_F = params[\"sigma_F\"]\n\n    # Constants and time vector\n    N = 201\n    t = np.linspace(0, 1, N)\n    \n    # Convert angles from degrees to radians\n    deg_to_rad = np.pi / 180.0\n    theta_0_rad = params[\"theta_0_deg\"] * deg_to_rad\n    delta_theta_rad = params[\"delta_theta_deg\"] * deg_to_rad\n    sigma_theta_rad = params[\"sigma_theta_deg\"] * deg_to_rad\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(seed=seed)\n\n    # --- 1. Generate Ground-Truth Data ---\n    # Ground-truth pennation angle\n    theta_true = theta_0_rad + delta_theta_rad * np.sin(2 * np.pi * f * t)\n    \n    # Ground-truth muscle thickness\n    h_true = params[\"h_true_func\"](h_0, t, f)\n\n    # Ground-truth tendon length from geometry: L_t = L_mt - h * cot(theta)\n    # Using 1/tan(theta) is numerically equivalent and common.\n    Lt_true = L_mt - h_true / np.tan(theta_true)\n\n    # Ground-truth tendon force from linear spring model\n    Ft_true = k_t * np.maximum(0, Lt_true - L_ts)\n\n    # --- 2. Generate Noisy Measurements ---\n    # Generate and add noise to theta\n    eta_theta = rng.normal(0, sigma_theta_rad, N)\n    theta_measured = theta_true + eta_theta\n\n    # Generate and add noise to force, ensuring it is non-negative\n    eta_F = rng.normal(0, sigma_F, N)\n    Ft_measured = np.maximum(0, Ft_true + eta_F)\n\n    # --- 3. Reconstruct Thickness from \"Measured\" Data ---\n    # Step 1: Compute tendon length from measured force\n    Lt_recon = L_ts + Ft_measured / k_t\n\n    # Step 2-4: Reconstruct thickness h(t) = (L_mt - L_t) * tan(theta)\n    # This combines the steps:\n    # Lf_cos = L_mt - Lt_recon\n    # Lf = Lf_cos / np.cos(theta_measured)\n    # h_recon = Lf * np.sin(theta_measured)\n    h_recon = (L_mt - Lt_recon) * np.tan(theta_measured)\n\n    # --- 4. Quantify Fit with NRMSE ---\n    # Best constant fit h_star is the mean of the reconstructed thickness\n    h_star = np.mean(h_recon)\n    \n    # Check for h_star being zero or close to zero to avoid division by zero\n    if np.isclose(h_star, 0):\n        # This case is not expected with the given parameters, but it's robust practice\n        return np.inf\n\n    # Calculate RMSE: sqrt(mean((h_i - h_star)^2)) which is the standard deviation\n    rmse = np.std(h_recon)\n    \n    # Calculate Normalized RMSE\n    nrmse = rmse / h_star\n    \n    return nrmse\n\n# Execute the simulation and print the final answer\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}