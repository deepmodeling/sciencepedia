{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个练习旨在将瞬时旋转中心 (Instantaneous Center of Rotation, ICR) 这一抽象概念与一个具体的计算问题相结合。通过使用刚体上两个点的实测速度，你将确定 ICR 的位置，并探讨当 ICR 位于解剖分段之外时其重要的物理意义，这在包含平移和旋转的复合运动中是一种常见情况 。这个练习是理解和解读复杂平面运动的基础。",
            "id": "4183357",
            "problem": "在一次水平伸展任务中，考虑前臂的平面刚体描述，该任务伴有轻微的肘部屈曲和肩部前伸，因此运动保持在单一解剖平面内。设肘部的近端点为 $E$，其在以米为单位的平面坐标为 $r_E = (0,\\,0)$，设腕部的远端点为 $W$，其在以米为单位的平面坐标为 $r_W = (0.30,\\,0)$（前臂长度为 $0.30\\,\\text{m}$）。在某一瞬间，这些点在实验室坐标系中测得的平面速度为\n$v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$ 和 $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$。假设在该瞬间，前臂在平面内表现为刚体，并且组合的关节运动实现了具有三个自由度（两个平移和一个旋转）的平面刚体运动。\n\n仅使用平面刚体运动学的核心定义和瞬时旋转中心（ICR）的定义——ICR是平面内瞬时速度为零的点，且刚体平面速度场垂直于从ICR出发的半径，并与角速度成正比——来确定ICR的位置，并解释当ICR位于解剖节段之外时的物理意义。\n\n哪个选项正确地指出了ICR的位置，并对该任务中其物理意义给出了最准确的解释？\n\nA. ICR位于 $(0,\\,3.00)\\,\\text{m}$；这表示围绕一个远处中心的瞬时旋转。大的距离意味着相对于平移速度而言，瞬时角速度较小，因此节段运动接近于由肩部引起的平移主导，并伴有轻微的肘部旋转，这与平面刚体运动和可用的自由度完全一致。\n\nB. ICR位于 $(0,\\,-3.00)\\,\\text{m}$；遥远的ICR位置意味着前臂正在变形而不是刚性运动，因此平面刚体假设无效。\n\nC. ICR位于 $(0.30,\\,0)\\,\\text{m}$（腕部）；这表示纯粹围绕腕部的旋转，肘部的平移运动可以忽略不计。\n\nD. ICR位于 $(0,\\,0)\\,\\text{m}$（肘部）；因为肘部屈曲是主动的，所以运动由单一旋转自由度主导，当肘部是主要驱动因素时，前臂的ICR不能在节段之外。\n\nE. ICR在无穷远处；由于 $E$ 和 $W$ 的速度几乎相等，运动实际上是纯平移，任何有限的ICR估计都是测量噪声的产物。",
            "solution": "用户要求对问题陈述进行严格验证，然后提供详细的解答和对所有选项的评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **系统**：前臂的平面刚体描述。\n- **点和坐标**：\n    - 近端点（肘部），$E$：$r_E = (0,\\,0)\\,\\text{m}$。\n    - 远端点（腕部），$W$：$r_W = (0.30,\\,0)\\,\\text{m}$。\n- **前臂长度**：$E$ 和 $W$ 之间的距离是 $L = 0.30\\,\\text{m}$。\n- **瞬时速度**：\n    - $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$。\n    - $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$。\n- **假设**：\n    1. 在所考虑的瞬间，前臂是平面内的刚体。\n    2. 该运动是具有三个自由度（2个平移，1个旋转）的平面刚体运动。\n- **定义**：\n    - 瞬时旋转中心（ICR）是平面内瞬时速度为零的点。\n    - 刚体上点的速度矢量垂直于从ICR出发的半径，并与角速度成正比。\n\n**步骤2：使用提取的已知条件进行验证**\n必须评估问题陈述的科学合理性、一致性和适定性。\n\n1.  **科学依据**：该问题基于平面刚体运动学原理，这是经典力学和生物力学中的一个基本主题。瞬时旋转中心（ICR）的概念是分析此类运动的标准工具。给出的前臂长度和速度值对于人类的伸展任务在生理上是现实的。该问题在科学上是合理的。\n\n2.  **刚体假设的一致性**：对于刚体，任意两点之间的距离必须保持不变。这意味着两点的相对速度矢量必须垂直于连接它们的位置矢量。我们来验证点 $E$ 和 $W$ 的情况。\n    - 从 $E$到 $W$ 的位置矢量是 $r_{W/E} = r_W - r_E = (0.30,\\,0)\\,\\text{m} - (0,\\,0)\\,\\text{m} = (0.30,\\,0)\\,\\text{m}$。\n    - $W$ 相对于 $E$ 的相对速度是 $v_{W/E} = v_W - v_E = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1} - (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1} = (0,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$。\n    - 为检查垂直性，它们的点积必须为零：\n        $$r_{W/E} \\cdot v_{W/E} = (0.30, 0) \\cdot (0, 0.04) = (0.30)(0) + (0)(0.04) = 0$$\n    条件满足。给定的速度数据与刚体假设完全一致。\n\n3.  **适定性**：问题提供了平面刚体上两个不同点的速度。只要运动不是纯平移，这些信息就足以唯一确定角速度 $\\omega$ 和ICR的位置。由于 $v_E \\neq v_W$，运动不是纯平移，因此必须存在一个唯一的、有限的ICR。该问题是适定的。\n\n4.  **客观性与清晰度**：问题使用精确、定量的语言，避免了模糊或主观的陈述。\n\n**步骤3：结论与行动**\n问题陈述在科学上合理、内部一致且适定。这是一个有效的问题。可以继续进行求解过程。\n\n### 解答推导\n\n瞬时旋转中心（ICR）是一个点 $r_{ICR} = (x_{ICR},\\,y_{ICR})$，其瞬时速度为零。刚体上任意点 $P$ 的速度 $v_P$ 由关系式 $v_P = \\vec{\\omega} \\times (r_P - r_{ICR})$ 给出，其中 $\\vec{\\omega} = \\omega \\hat{k}$ 是 $xy$ 平面内平面运动的角速度矢量。\n\n用分量形式表示，这个关系是：\n$v_{P,x} = -\\omega (y_P - y_{ICR})$\n$v_{P,y} = \\omega (x_P - x_{ICR})$\n\n设ICR位于 $(x, y)$。我们将此关系应用于给定的点 $E$ 和 $W$。\n\n对于点 $E$ 在 $r_E = (0,\\,0)$，速度为 $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$：\n$v_{E,x} = 0.40 = -\\omega (0 - y) \\implies 0.40 = \\omega y \\quad (1)$\n$v_{E,y} = 0.00 = \\omega (0 - x) \\implies 0 = -\\omega x \\quad (2)$\n\n对于点 $W$ 在 $r_W = (0.30,\\,0)$，速度为 $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$：\n$v_{W,x} = 0.40 = -\\omega (0 - y) \\implies 0.40 = \\omega y \\quad (3)$\n$v_{W,y} = 0.04 = \\omega (0.30 - x) \\quad (4)$\n\n从方程 $(2)$，因为我们知道 $\\omega \\neq 0$（因为 $v_E \\neq v_W$），所以必有 $x=0$。ICR位于 $y$ 轴上。\n\n将 $x=0$ 代入方程 $(4)$：\n$0.04 = \\omega(0.30 - 0) = 0.30 \\omega$\n现在我们可以解出角速度 $\\omega$：\n$$\\omega = \\frac{0.04}{0.30} = \\frac{4}{30} = \\frac{2}{15}\\,\\text{rad}\\,\\text{s}^{-1}$$\n正号表示逆时针旋转。\n\n现在，我们使用方程 $(1)$ 来找到ICR的 $y$ 坐标：\n$0.40 = \\omega y \\implies y = \\frac{0.40}{\\omega} = \\frac{0.40}{2/15} = \\frac{4/10}{2/15} = \\frac{2}{5} \\times \\frac{15}{2} = 3$\n\n因此，ICR的位置是 $r_{ICR} = (0,\\,3.00)\\,\\text{m}$。\n\n**解释**\nICR位于 $(0,\\,3.00)\\,\\text{m}$，这远离了从 $(0,\\,0)$ 到 $(0.30,\\,0)$ 的前臂解剖节段。对于一般的平面运动（平移和旋转的组合），ICR位于身体节段之外是一个常见且预期的结果。\n\n该运动可以分解为整个节段的平移和围绕节段上某一点的旋转。例如，我们可以将运动视为速度为 $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$ 的平移，加上围绕肘部 $E$ 的旋转。在腕部 $W$ 处，由该旋转引起的速度分量是 $v_{W/E} = v_W - v_E = (0,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$。\n\n平移速度的大小为 $|v_E| = 0.40\\,\\text{m}\\,\\text{s}^{-1}$，而由于旋转引起的节段两端速度差的大小为 $|v_{W/E}| = 0.04\\,\\text{m}\\,\\text{s}^{-1}$。平移分量大得多，表明运动以平移为主。遥远的ICR是平移主导运动的一个运动学特征，因为需要一个大的旋转半径（$d=3.00\\,\\text{m}$）和一个小的角速度（$\\omega = 2/15 \\approx 0.133\\,\\text{rad}\\,\\text{s}^{-1}$）才能产生一个显著的平移速度（$v=0.40\\,\\text{m}\\,\\text{s}^{-1}$）。这种运动学图像与涉及肩部前伸（引起肘部平移）和仅轻微肘部屈曲（引起小幅旋转）的伸展任务的生物力学描述是一致的。\n\n### 逐项分析\n\n**A. ICR位于 $(0,\\,3.00)\\,\\text{m}$；这表示围绕一个远处中心的瞬时旋转。大的距离意味着相对于平移速度而言，瞬时角速度较小，因此节段运动接近于由肩部引起的平移主导，并伴有轻微的肘部旋转，这与平面刚体运动和可用的自由度完全一致。**\n- **ICR位置**：$(0,\\,3.00)\\,\\text{m}$。这与我们的计算相符。\n- **解释**：这个解释与我们的分析完全一致。遥远的ICR正确地表明了运动主要是平移的，带有一个小的旋转分量。所提供的生物力学描述是对此类运动学的合理解释。该陈述正确地肯定了其与刚体模型的一致性。\n- **结论**：**正确**。\n\n**B. ICR位于 $(0,\\,-3.00)\\,\\text{m}$；遥远的ICR位置意味着前臂正在变形而不是刚性运动，因此平面刚体假设无效。**\n- **ICR位置**：$(0,\\,-3.00)\\,\\text{m}$。这个位置不正确；$y$ 坐标的符号错误。\n- **解释**：核心论断“遥远的ICR意味着非刚性变形”是根本错误的。遥远的ICR是接近纯平移的刚体运动的一个特征。我们的验证步骤明确证实了数据与刚体假设是一致的。\n- **结论**：**不正确**。\n\n**C. ICR位于 $(0.30,\\,0)\\,\\text{m}$（腕部）；这表示纯粹围绕腕部的旋转，肘部的平移运动可以忽略不计。**\n- **ICR位置**：$(0.30,\\,0)\\,\\text{m}$。这是腕部 $W$ 的位置。这是不正确的。\n- **解释**：如果ICR在腕部，那么腕部的速度 $v_W$ 将为零。问题陈述 $v_W = (0.40,\\,0.04)\\,\\text{m}\\,\\text{s}^{-1}$，这是非零的。前提是错误的。\n- **结论**：**不正确**。\n\n**D. ICR位于 $(0,\\,0)\\,\\text{m}$（肘部）；因为肘部屈曲是主动的，所以运动由单一旋转自由度主导，当肘部是主要驱动因素时，前臂的ICR不能在节段之外。**\n- **ICR位置**：$(0,\\,0)\\,\\text{m}$。这是肘部 $E$ 的位置。这是不正确的。\n- **解释**：如果ICR在肘部，那么肘部的速度 $v_E$ 将为零。问题陈述 $v_E = (0.40,\\,0.00)\\,\\text{m}\\,\\text{s}^{-1}$，这是非零的。这对应于围绕固定肘关节的纯旋转，与数据相矛盾。声称ICR不能在节段之外对于一般平面运动也是错误的。\n- **结论**：**不正确**。\n\n**E. ICR在无穷远处；由于 $E$ 和 $W$ 的速度几乎相等，运动实际上是纯平移，任何有限的ICR估计都是测量噪声的产物。**\n- **ICR位置**：无穷远。这意味着纯平移，即 $\\omega=0$ 和 $v_E = v_W$。\n- **解释**：给定的数据明确指出 $v_E \\neq v_W$。对于一个正式的力学问题，给定的值必须被视为精确值。因此，运动不是纯平移，ICR是有限的。虽然运动*接近*纯平移，但此选项错误地将旋转分量视为伪影而不去分析其后果，而分析其后果正是问题的重点。\n- **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在单刚体运动学的基础上，本练习将分析提升至多连杆系统，例如人的手臂。你将使用雅可比矩阵 ($J$) 这一工具来关联关节角速度与末端执行器（手部）的速度，并研究运动学奇点——即那些在此姿态下肢体活动性会瞬时受限的特殊构型 。这种分析对于理解生物运动的局限性以及机器人操纵臂的设计原则至关重要。",
            "id": "4183346",
            "problem": "矢状面内的一个平面二段式生物肢体被建模为两个长度为 $l_10$ 和 $l_20$ 的刚性连杆，通过位于原点（模拟肩部）且角度为 $\\theta_1$ 的近端关节和角度为 $\\theta_2$ 的远端关节（模拟肘部）连接。远端终点（模拟手部）的笛卡尔坐标 $p(\\theta_1,\\theta_2) = [x(\\theta_1,\\theta_2),\\, y(\\theta_1,\\theta_2)]^\\top$ 由刚体运动学给出。末端执行器速度 $v = \\dot{p}$ 和关节速度 $\\,\\dot{q} = [\\dot{\\theta}_1,\\,\\dot{\\theta}_2]^\\top$ 通过雅可比矩阵 $J(\\theta_1,\\theta_2)$ 关联，即 $v = J(\\theta_1,\\theta_2)\\,\\dot{q}$，其中 $J$ 定义为 $p$ 关于关节坐标的偏导数矩阵。$J$ 的秩决定了任务平面中可达末端执行器速度空间的瞬时维度，即瞬时任务空间自由度 (DoF)。关节空间自由度的数量固定为 $2$。\n\n考虑完全伸展的姿态 $\\theta_2 = 0$（两段共线），并使用平面刚体运动学的第一性原理和雅可比矩阵的定义来分析肢体的瞬时移动性。远端连杆的瞬时转动中心 (ICR) 定义为在该瞬间远端连杆围绕其进行纯瞬时转动的平面上的点；如果该连杆进行纯平移，则 ICR 位于无穷远处，其方向垂直于平移方向。\n\n在 $\\theta_2 = 0$ 这种姿态下，下列哪个陈述是正确的？\n\nA. 手部速度的瞬时集合是一维的，并且位于垂直于共线连杆公共轴线的方向上；等价地，$\\mathrm{rank}\\,J(\\theta_1,0) = 1$。\n\nB. 对于任何非零关节速度 $\\dot{q} \\neq 0$，在 $\\theta_2=0$ 时手部速度 $v$ 非零，因此任务空间自由度没有瞬时减少。\n\nC. 远端连杆的 ICR 位于与两连杆共线的直线上；如果 $\\dot{\\theta}_1 + \\dot{\\theta}_2 = 0$，则远端连杆的运动是纯平移，ICR 位于无穷远处。\n\nD. 在 $\\theta_2=0$ 时 $J$ 的秩下降意味着一个关节自由度被机械锁定并且不能移动。\n\nE. 姿态 $\\theta_2 = \\pi$（反向平行共线）不是奇异的；手部可以在该处以两个独立的平面速度分量进行瞬时移动。\n\nF. 在 $\\theta_2=0$ 的姿态下，如果 $\\dot{\\theta}_2 = 0$，则远端连杆瞬时绕近端关节旋转，因此其 ICR 与肩部重合。",
            "solution": "用户需要对一个关于二连杆机械臂在奇异构型下的平面运动学问题进行严格验证并提供详细解答。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   平面二段式生物肢体被建模为两个长度为 $l_10$ 和 $l_20$ 的刚性连杆。\n-   近端关节位于原点，角度为 $\\theta_1$。\n-   远端关节有一个相对角度 $\\theta_2$。\n-   远端终点（手部）的位置是 $p(\\theta_1,\\theta_2) = [x(\\theta_1,\\theta_2),\\, y(\\theta_1,\\theta_2)]^\\top$。\n-   末端执行器速度 $v = \\dot{p}$ 和关节速度 $\\dot{q} = [\\dot{\\theta}_1,\\,\\dot{\\theta}_2]^\\top$ 通过 $v = J(\\theta_1,\\theta_2)\\,\\dot{q}$ 关联。\n-   雅可比矩阵 $J$ 是 $p$ 关于关节坐标的偏导数矩阵。\n-   $J$ 的秩决定了瞬时任务空间自由度 (DoF)。\n-   关节空间自由度为 $2$。\n-   需要分析的特定姿态是完全伸展姿态 $\\theta_2 = 0$。\n-   远端连杆的瞬时转动中心 (ICR) 是纯瞬时转动的点；对于纯平移，它位于无穷远处。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题陈述是机构和机器人运动学中一个经典问题的标准表述。\n-   **科学依据（关键）：** 该模型是一个基本的二连杆平面机械臂。正向运动学、雅可比矩阵、运动学奇点、自由度和瞬时转动中心等概念都是力学和机器人学中已被广泛认可的核心原理。该问题在科学上是合理的。\n-   **适定性：** 问题定义清晰。运动学方程可以唯一确定，雅可比矩阵可以计算，其在指定构型（$\\theta_2=0$）下的属性可以被分析。选项中提出的问题是形式化的并且是可回答的。\n-   **客观性（关键）：** 语言精确、专业，没有任何主观或模糊的术语。\n\n问题陈述没有科学或事实上的不合理之处，是可形式化的、完整的、物理上现实的、并且结构良好。这是一个有效的问题。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。我将继续推导解答。\n\n### 推导与选项分析\n\n**1. 正向运动学与雅可比矩阵**\n\n设近端关节（肩部）位于原点 $(0,0)$。设 $\\theta_1$ 为第一根连杆与 $x$ 轴正方向的夹角，$\\theta_2$ 为第二根连杆相对于第一根连杆的角度。远端终点（手部）的位置 $p$ 由下式给出：\n$$\np(\\theta_1, \\theta_2) = \\begin{bmatrix} x(\\theta_1, \\theta_2) \\\\ y(\\theta_1, \\theta_2) \\end{bmatrix} = \\begin{bmatrix} l_1 \\cos\\theta_1 + l_2 \\cos(\\theta_1 + \\theta_2) \\\\ l_1 \\sin\\theta_1 + l_2 \\sin(\\theta_1 + \\theta_2) \\end{bmatrix}\n$$\n雅可比矩阵 $J$ 通过 $v = J\\dot{q}$ 将关节速度 $\\dot{q} = [\\dot{\\theta}_1, \\dot{\\theta}_2]^\\top$ 与末端执行器速度 $v = \\dot{p}$ 关联起来。$J$ 是 $p$ 的偏导数矩阵：\n$$\nJ = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\theta_1}  \\frac{\\partial x}{\\partial \\theta_2} \\\\ \\frac{\\partial y}{\\partial \\theta_1}  \\frac{\\partial y}{\\partial \\theta_2} \\end{bmatrix}\n$$\n计算偏导数：\n$$\n\\frac{\\partial x}{\\partial \\theta_1} = -l_1 \\sin\\theta_1 - l_2 \\sin(\\theta_1 + \\theta_2) \\quad , \\quad \\frac{\\partial x}{\\partial \\theta_2} = -l_2 \\sin(\\theta_1 + \\theta_2)\n$$\n$$\n\\frac{\\partial y}{\\partial \\theta_1} = l_1 \\cos\\theta_1 + l_2 \\cos(\\theta_1 + \\theta_2) \\quad , \\quad \\frac{\\partial y}{\\partial \\theta_2} = l_2 \\cos(\\theta_1 + \\theta_2)\n$$\n所以雅可比矩阵是：\n$$\nJ(\\theta_1, \\theta_2) = \\begin{bmatrix} -l_1 \\sin\\theta_1 - l_2 \\sin(\\theta_1 + \\theta_2)  -l_2 \\sin(\\theta_1 + \\theta_2) \\\\ l_1 \\cos\\theta_1 + l_2 \\cos(\\theta_1 + \\theta_2)  l_2 \\cos(\\theta_1 + \\theta_2) \\end{bmatrix}\n$$\n\n**2. 在奇异姿态 $\\theta_2 = 0$ 处的分析**\n\n我们计算在 $\\theta_2 = 0$ 时的雅可比矩阵：\n$$\nJ(\\theta_1, 0) = \\begin{bmatrix} -l_1 \\sin\\theta_1 - l_2 \\sin\\theta_1  -l_2 \\sin\\theta_1 \\\\ l_1 \\cos\\theta_1 + l_2 \\cos\\theta_1  l_2 \\cos\\theta_1 \\end{bmatrix} = \\begin{bmatrix} -(l_1 + l_2) \\sin\\theta_1  -l_2 \\sin\\theta_1 \\\\ (l_1 + l_2) \\cos\\theta_1  l_2 \\cos\\theta_1 \\end{bmatrix}\n$$\n为了求 $J$ 的秩，我们可以检查其行列式：\n$$\n\\det(J(\\theta_1, 0)) = (-(l_1 + l_2) \\sin\\theta_1)(l_2 \\cos\\theta_1) - (-l_2 \\sin\\theta_1)((l_1 + l_2) \\cos\\theta_1)\n$$\n$$\n\\det(J(\\theta_1, 0)) = -l_2(l_1 + l_2)\\sin\\theta_1\\cos\\theta_1 + l_2(l_1 + l_2)\\sin\\theta_1\\cos\\theta_1 = 0\n$$\n由于行列式为零，雅可比矩阵的列是线性相关的。具体来说，第一列是第二列的 $(l_1+l_2)/l_2$ 倍。因为 $l_1, l_2  0$，所以列向量非零（除非 $\\sin\\theta_1=\\cos\\theta_1=0$，这是不可能的）。因此，雅可比矩阵的秩为 $1$。这种构型是一个运动学奇点。\n\n**3. 远端连杆 ICR 分析**\n\n远端连杆（连杆 2）的绝对角速度是 $\\omega_2 = \\dot{\\theta}_1 + \\dot{\\theta}_2$。\n远端连杆上距离远端关节（肘部）为 $d \\in [0, l_2]$ 的点 $P$ 的速度可以被计算出来。在 $\\theta_2=0$ 时，$P$ 的位置是 $p_P = (l_1+d)[\\cos\\theta_1, \\sin\\theta_1]^\\top$。其速度是：\n$$\nv_P = \\frac{d}{dt} \\left( l_1 \\begin{bmatrix} \\cos\\theta_1 \\\\ \\sin\\theta_1 \\end{bmatrix} + d \\begin{bmatrix} \\cos(\\theta_1+\\theta_2) \\\\ \\sin(\\theta_1+\\theta_2) \\end{bmatrix} \\right) \\Biggr|_{\\theta_2=0}\n$$\n$$\nv_P = l_1\\dot{\\theta}_1 \\begin{bmatrix} -\\sin\\theta_1 \\\\ \\cos\\theta_1 \\end{bmatrix} + d(\\dot{\\theta}_1+\\dot{\\theta}_2) \\begin{bmatrix} -\\sin(\\theta_1+0) \\\\ \\cos(\\theta_1+0) \\end{bmatrix} = (l_1\\dot{\\theta}_1 + d(\\dot{\\theta}_1+\\dot{\\theta}_2)) \\begin{bmatrix} -\\sin\\theta_1 \\\\ \\cos\\theta_1 \\end{bmatrix}\n$$\nICR 是速度为零的点。设 ICR 在连杆 2 的轴线上，距离肘部为 $d_{icr}$。如果标量因子为零，则其速度为零：\n$$\nl_1\\dot{\\theta}_1 + d_{icr}(\\dot{\\theta}_1+\\dot{\\theta}_2) = 0 \\implies d_{icr} = -\\frac{l_1\\dot{\\theta}_1}{\\dot{\\theta}_1+\\dot{\\theta}_2}\n$$\nICR 的位置 $p_{ICR}$ 是相对于原点的。它位于距离原点 $l_1+d_{icr}$ 处，沿着臂的轴线。\n$$\np_{ICR} = (l_1+d_{icr}) \\begin{bmatrix} \\cos\\theta_1 \\\\ \\sin\\theta_1 \\end{bmatrix} = \\left(l_1 - \\frac{l_1\\dot{\\theta}_1}{\\dot{\\theta}_1+\\dot{\\theta}_2}\\right) \\begin{bmatrix} \\cos\\theta_1 \\\\ \\sin\\theta_1 \\end{bmatrix} = \\left(\\frac{l_1(\\dot{\\theta}_1+\\dot{\\theta}_2) - l_1\\dot{\\theta}_1}{\\dot{\\theta}_1+\\dot{\\theta}_2}\\right) \\begin{bmatrix} \\cos\\theta_1 \\\\ \\sin\\theta_1 \\end{bmatrix}\n$$\n$$\np_{ICR} = \\left(\\frac{l_1\\dot{\\theta}_2}{\\dot{\\theta}_1+\\dot{\\theta}_2}\\right) \\begin{bmatrix} \\cos\\theta_1 \\\\ \\sin\\theta_1 \\end{bmatrix}\n$$\n此公式在 $\\omega_2 = \\dot{\\theta}_1+\\dot{\\theta}_2 \\neq 0$ 时有效。如果 $\\omega_2 = 0$，则 ICR 位于无穷远处。\n\n---\n**逐项分析**\n\n**A. 手部速度的瞬时集合是一维的，并且位于垂直于共线连杆公共轴线的方向上；等价地，$\\mathrm{rank}\\,J(\\theta_1,0) = 1$。**\n如上所示，$\\det(J(\\theta_1, 0)) = 0$，所以 $\\mathrm{rank}(J(\\theta_1, 0)) = 1$。这意味着可达速度空间的维度是 $1$。手部速度为 $v = J(\\theta_1,0)\\dot{q} = \\begin{bmatrix} -((l_1+l_2)\\dot{\\theta}_1 + l_2\\dot{\\theta}_2) \\sin\\theta_1 \\\\ ((l_1+l_2)\\dot{\\theta}_1 + l_2\\dot{\\theta}_2) \\cos\\theta_1 \\end{bmatrix}$。该速度向量始终与 $[-\\sin\\theta_1, \\cos\\theta_1]^\\top$ 成比例。连杆的公共轴线方向为 $[\\cos\\theta_1, \\sin\\theta_1]^\\top$。这两个向量的点积为 $(-\\sin\\theta_1)(\\cos\\theta_1) + (\\cos\\theta_1)(\\sin\\theta_1) = 0$，证实它们是垂直的。该陈述与推导完全一致。\n结论：**正确**。\n\n**B. 对于任何非零关节速度 $\\dot{q} \\neq 0$，在 $\\theta_2=0$ 时手部速度 $v$ 非零，因此任务空间自由度没有瞬时减少。**\n结论“因此任务空间自由度没有瞬时减少”是错误的，因为我们已经确定了 $\\mathrm{rank}(J)=1$，这是从最大值 $2$ 的减少。其前提也是错误的。如果手部速度 $v$ 的大小为零，则其为零。从 A 中的速度表达式可知，当 $(l_1+l_2)\\dot{\\theta}_1 + l_2\\dot{\\theta}_2 = 0$ 时会发生这种情况。我们可以找到一个满足此条件的非零关节速度向量 $\\dot{q}=[\\dot{\\theta}_1, \\dot{\\theta}_2]^\\top \\neq 0$，例如 $\\dot{\\theta}_1=l_2$ 和 $\\dot{\\theta}_2=-(l_1+l_2)$。这种非零的关节运动导致了零手部速度。\n结论：**不正确**。\n\n**C. 远端连杆的 ICR 位于与两连杆共线的直线上；如果 $\\dot{\\theta}_1 + \\dot{\\theta}_2 = 0$，则远端连杆的运动是纯平移，ICR 位于无穷远处。**\n我们推导出的 ICR 位置公式为 $p_{ICR} = (\\frac{l_1\\dot{\\theta}_2}{\\dot{\\theta}_1+\\dot{\\theta}_2}) [\\cos\\theta_1, \\sin\\theta_1]^\\top$。这个位置向量是臂的方向向量 $[\\cos\\theta_1, \\sin\\theta_1]^\\top$ 的标量倍数。因此，ICR 位于穿过原点且与连杆共线的直线上。这证实了第一部分。对于第二部分，远端连杆的绝对角速度是 $\\omega_2 = \\dot{\\theta}_1 + \\dot{\\theta}_2$。如果这个和为零，则该连杆的角速度为零，这是纯平移的定义。在这种情况下，我们的 $p_{ICR}$ 公式的分母为零，ICR 位于无穷远处，这与纯平移的 ICR 定义一致。\n结论：**正确**。\n\n**D. 在 $\\theta_2=0$ 时 $J$ 的秩下降意味着一个关节自由度被机械锁定并且不能移动。**\n这是对运动学奇点的误解。关节空间自由度为 $2$，意味着两个关节都可以用任意速度 $\\dot{\\theta}_1$ 和 $\\dot{\\theta}_2$ 驱动。奇点意味着从关节速度到任务空间（手部）速度的映射是退化的；一些关节运动不产生手部运动，而一些手部运动是无法实现的。它并不意味着任何关节存在机械锁定。\n结论：**不正确**。\n\n**E. 姿态 $\\theta_2 = \\pi$（反向平行共线）不是奇异的；手部可以在该处以两个独立的平面速度分量进行瞬时移动。**\n我们在 $\\theta_2 = \\pi$ 处计算雅可比矩阵。使用 $\\sin(\\theta_1+\\pi)=-\\sin\\theta_1$ 和 $\\cos(\\theta_1+\\pi)=-\\cos\\theta_1$：\n$$\nJ(\\theta_1, \\pi) = \\begin{bmatrix} -l_1 \\sin\\theta_1 - l_2 (-\\sin\\theta_1)  -l_2 (-\\sin\\theta_1) \\\\ l_1 \\cos\\theta_1 + l_2 (-\\cos\\theta_1)  l_2 (-\\cos\\theta_1) \\end{bmatrix} = \\begin{bmatrix} -(l_1-l_2)\\sin\\theta_1  l_2\\sin\\theta_1 \\\\ (l_1-l_2)\\cos\\theta_1  -l_2\\cos\\theta_1 \\end{bmatrix}\n$$\n行列式为 $\\det(J(\\theta_1, \\pi)) = (-(l_1-l_2)\\sin\\theta_1)(-l_2\\cos\\theta_1) - (l_2\\sin\\theta_1)((l_1-l_2)\\cos\\theta_1) = (l_1-l_2)l_2\\sin\\theta_1\\cos\\theta_1 - (l_1-l_2)l_2\\sin\\theta_1\\cos\\theta_1 = 0$。由于行列式为零，雅可比矩阵是奇异的，其秩小于 $2$。手部不能以两个独立的平面速度分量移动。这种姿态被称为“肘部奇点”或“内边界奇点”。\n结论：**不正确**。\n\n**F. 在 $\\theta_2=0$ 的姿态下，如果 $\\dot{\\theta}_2 = 0$，则远端连杆瞬时绕近端关节旋转，因此其 ICR 与肩部重合。**\n在 $\\theta_2=0$ 的姿态下，如果 $\\dot{\\theta}_2 = 0$，则远端（肘部）关节没有相对运动。两个连杆作为一个总长度为 $l_1+l_2$ 的单一刚体运动。这个复合体铰接在位于原点的近端关节（肩部）。该物体的运动是绕肩部的纯转动。根据定义，这个转动的中心就是 ICR。因此，远端连杆（作为该物体的一部分）的 ICR 就是肩部。这可以用我们的 ICR 公式来验证：对于 $\\dot{\\theta}_2=0$ 和 $\\dot{\\theta}_1 \\neq 0$，$p_{ICR} = \\frac{l_1(0)}{\\dot{\\theta}_1+0} [\\cos\\theta_1, \\sin\\theta_1]^\\top = [0,0]^\\top$，这正是肩部的位置。\n结论：**正确**。",
            "answer": "$$\\boxed{ACF}$$"
        },
        {
            "introduction": "最后的这项综合性练习将理论与实践相结合，从二维平面分析过渡到三维空间的计算问题。你将编写一个程序，分析合成的运动捕捉数据，并计算步态过程中膝关节的瞬时螺旋轴 (Instantaneous Helical Axis, IHA)，即三维空间中 ICR 的对应概念 。这项动手编程任务模拟了一个真实的生物力学研究场景，让你深入了解如何运用运动学分析来评估关节功能以及诸如前交叉韧带 (ACL) 手术等临床干预措施的效果。",
            "id": "4183349",
            "problem": "您需要实现一个程序，使用合成运动捕捉数据计算小腿节段相对于大腿节段的特定于步态相位的瞬时螺旋轴（IHA），并评估前交叉韧带（ACL）重建手术前后的变化，以推断关节约束的恢复情况。其基本的生物力学背景是膝关节的刚体运动学，重点关注关节自由度（DOF）和瞬时旋转中心。程序必须从刚体运动的核心定义出发，并避免使用本提示中直接提供的任何捷径公式。\n\n基本假设和定义：\n- 小腿和大腿在三维空间中被建模为刚体。小腿相对于大腿进行广义空间运动。\n- 在健康步态中，膝关节主要将运动约束在围绕一个近似固定轴的屈伸运动，从而减少平面外旋转。\n- 瞬时螺旋轴（IHA）由刚体的瞬时空间速度（螺旋）定义，该速度包括瞬时角速度和一个参考点的线速度。\n- 瞬时角速度矢量由相对旋转矩阵的时间导数计算得出，而线速度由相对位置矢量的时间导数计算得出。\n- 步态相位根据步幅分数进行定义，并被独立评估。\n\n您的任务：\n1. 生成一个完整步幅中，小腿相对于大腿的合成运动捕捉数据。大腿坐标系是固定的，并与实验室坐标系对齐，其屈伸轴定义为大腿沿 $y$ 轴的单位矢量。小腿相对于大腿具有随时间变化的方向和位置。小腿的方向是通过复合绕 $y$ 轴（屈伸）、$x$ 轴（外展-内收）和 $z$ 轴（内-外旋）的旋转来构建的。小腿的相对位置随时间变化，伴有代表胫骨位移的微小平移。\n2. 通过关系式 $\\boldsymbol{\\Omega}(t) = \\dot{\\mathbf{R}}(t)\\mathbf{R}(t)^{\\top}$，从旋转矩阵的导数 $\\dot{\\mathbf{R}}(t)$ 计算瞬时角速度 $\\boldsymbol{\\omega}(t)$，其中 $\\boldsymbol{\\Omega}(t)$ 是一个斜对称矩阵，其关联矢量为 $\\boldsymbol{\\omega}(t)$。将线速度 $\\mathbf{v}(t)$ 计算为小腿原点相对于大腿位置的时间导数。\n3. 对于 $\\|\\boldsymbol{\\omega}(t)\\|$ 超过一个很小阈值的每个瞬间，将 IHA 方向定义为单位矢量 $\\mathbf{n}(t) = \\boldsymbol{\\omega}(t)/\\|\\boldsymbol{\\omega}(t)\\|$。IHA 的位置是轴上离大腿原点最近的点；然而，在本问题中，为了评估约束的恢复情况，您将只评估 $\\mathbf{n}(t)$ 相对于大腿屈伸轴的方向对齐度。\n4. 使用步幅分数 $\\phi \\in [0,1]$ 将步幅划分为多个相位：负重响应期 $[0,0.15]$、站立中期 $[0.15,0.5]$、站立末期 $[0.5,0.7]$ 和摆动期 $[0.7,1.0]$。对于每个相位，计算 $\\mathbf{n}(t)$ 与屈伸轴 $\\mathbf{e}_y$（大腿 $y$ 轴）之间的均方根 (RMS) 角偏差。使用定义为 $\\delta(t) = \\arccos(|\\mathbf{n}(t) \\cdot \\mathbf{e}_y|)$ 的角偏差，以度为单位进行测量。\n5. 对于每个测试用例，计算聚合评估指标，该指标定义为重建前后 RMS 偏差之差在各个相位上的平均值：$\\Delta = \\text{mean}_{\\text{phases}} \\left( \\text{RMS}_{\\text{pre}} - \\text{RMS}_{\\text{post}} \\right)$，单位为度。正值表示对齐度有所改善，并可推断关节约束已恢复。\n\n单位和数值细节：\n- 计算中的角度必须使用弧度。报告偏差和最终输出时使用度。\n- 位置单位必须是米，时间单位必须是秒。采样频率和持续时间将被指定。\n- 必须使用 $10^{-3}$ 弧度/秒的瞬时角速度幅值阈值来过滤病态样本。\n\n测试套件规范：\n对于每个测试用例，在步幅持续时间 $T$ 秒内生成 $N$ 个样本的时间序列，步幅分数为 $\\phi = t/T$，$t \\in [0,T]$。用以下参数定义小腿运动：\n- 屈伸角 $\\theta(\\phi)$（度）：代表步态的平滑周期函数。\n- 外展-内收角 $\\alpha(\\phi)$（度）：具有指定振幅的正弦函数。\n- 内-外旋角 $\\beta(\\phi)$（度）：具有指定振幅的正弦函数。\n- 平移 $\\mathbf{p}(\\phi)$（米）：微小的正弦分量。\n\n您必须实现三个测试用例：\n- 案例 1 (正常路径)：$N = 501$，$T = 1.0$，$\\theta(\\phi) = 30 \\sin(2\\pi \\phi) + 20$，外展-内收振幅，术前 $A_{\\text{pre}} = 5$ 度，术后 $A_{\\text{post}} = 2$ 度，内-外旋振幅 $B = 3$ 度，平移振幅 $p_x(\\phi) = 0.005 \\sin(2\\pi \\phi)$，$p_y(\\phi) = 0$，$p_z(\\phi) = 0.010 \\cos(2\\pi \\phi)$。\n- 案例 2 (站立中期边界低角速率)：$N = 501$，$T = 1.0$，$\\theta(\\phi) = 10 \\sin(2\\pi \\phi)$，外展-内收振幅，术前 $A_{\\text{pre}} = 4$ 度，术后 $A_{\\text{post}} = 1$ 度，内-外旋振幅 $B = 2$ 度，平移振幅 $p_x(\\phi) = 0.003 \\sin(4\\pi \\phi)$，$p_y(\\phi) = 0$，$p_z(\\phi) = 0.008 \\cos(2\\pi \\phi)$。\n- 案例 3 (无改善)：$N = 501$，$T = 1.0$，$\\theta(\\phi) = 25 \\sin(2\\pi \\phi) + 10$，外展-内收振幅，术前 $A_{\\text{pre}} = 5$ 度，术后 $A_{\\text{post}} = 5$ 度，内-外旋振幅 $B = 3$ 度，平移振幅 $p_x(\\phi) = 0.004 \\sin(2\\pi \\phi)$，$p_y(\\phi) = 0$，$p_z(\\phi) = 0.009 \\cos(2\\pi \\phi)$。\n\n计算要求：\n- 使用中心差分法在内部样本点近似计算 $\\dot{\\mathbf{R}}(t)$ 和 $\\dot{\\mathbf{p}}(t)$。舍弃端点以及任何未通过角速度阈值测试的样本。\n- 将小腿旋转构建为 $\\mathbf{R}(t) = \\mathbf{R}_y(\\theta(t))\\mathbf{R}_x(\\alpha(t))\\mathbf{R}_z(\\beta(t))$，其中每次旋转都是围绕相应轴进行的，旋转角度为指定的弧度值。\n\n输出规范：\n- 程序必须产生单行输出，其中包含一个逗号分隔的列表，内容是每个测试用例的聚合评估指标 $\\Delta$（单位为度），并用方括号括起来，例如，“[result1,result2,result3]”。\n- 每个结果必须是浮点数。您可以四舍五入到三位小数以确保报告简洁。\n\n不允许外部输入。所有数据和参数都必须在程序内部生成。",
            "solution": "该问题已被验证，并被认为是具有科学依据、良定且客观的。它基于刚体运动学的既定原则，提出了一个计算生物力学领域的明确任务。所有必要的数据、函数和约束都已提供，以推导出一个唯一的、可验证的解决方案。\n\n目标是量化模拟的前交叉韧带（ACL）重建手术后膝关节稳定性的变化。这通过分析步态周期中小腿相对于大腿的瞬时螺旋轴（IHA）的方向来实现。一个健康或成功重建的膝关节，其运动应主要约束在屈伸范围内，从而导致其 IHA 与关节的屈伸轴紧密对齐。\n\n解决方案是按照以下主要步骤以算法方式开发的：\n\n1.  **刚体运动建模：** 小腿（刚体 $B$）相对于大腿（刚体 $A$，其坐标系被认为是固定的）的运动由一个随时间变化的旋转矩阵 $\\mathbf{R}(t)$ 和小腿原点的相对位置矢量 $\\mathbf{p}(t)$ 来描述。该旋转由三个连续的旋转组成：绕 $y$ 轴的屈伸运动 ($\\theta$)、绕 $x$ 轴的外展-内收运动 ($\\alpha$) 和绕 $z$ 轴的内-外旋运动 ($\\beta$)。因此，旋转矩阵由乘积 $\\mathbf{R}(t) = \\mathbf{R}_y(\\theta(t))\\mathbf{R}_x(\\alpha(t))\\mathbf{R}_z(\\beta(t))$ 给出。角度 $\\theta$、$\\alpha$ 和 $\\beta$ 作为步幅分数 $\\phi = t/T$ 的函数提供，其中 $T$ 是步幅持续时间。正弦形式的外展-内收和内-外旋的函数形式在问题描述中没有明确定义。对于与步态同步的周期性过程，一个标准且物理上一致的选择是采用与步幅具有相同基频的正弦波。我们采用 $\\alpha(\\phi) = A \\sin(2\\pi\\phi)$ 和 $\\beta(\\phi) = B \\sin(2\\pi\\phi)$，其中 $A$ 和 $B$ 分别是各自的振幅。所有以度定义的角度在计算时都将转换为弧度。\n\n2.  **计算瞬时角速度：** IHA与瞬时角速度矢量 $\\boldsymbol{\\omega}(t)$ 内在地联系在一起。该矢量从斜对称矩阵 $\\boldsymbol{\\Omega}(t)$ 中提取，该矩阵由基本运动学关系 $\\boldsymbol{\\Omega}(t) = \\dot{\\mathbf{R}}(t)\\mathbf{R}(t)^{\\top}$ 定义。旋转矩阵的时间导数 $\\dot{\\mathbf{R}}(t)$ 在离散时间样本上使用二阶中心差分公式进行数值近似：$\\dot{\\mathbf{R}}(t_i) \\approx \\frac{\\mathbf{R}(t_{i+1}) - \\mathbf{R}(t_{i-1})}{2\\Delta t}$，其中 $\\Delta t$ 是采样间隔。一旦在每个时间步 $t_i$ 计算出 $\\boldsymbol{\\Omega}(t)$，角速度矢量 $\\boldsymbol{\\omega}(t_i) = [\\omega_x, \\omega_y, \\omega_z]^{\\top}$ 的分量就可以使用关系式 $\\omega_x = \\Omega_{21}$、$\\omega_y = \\Omega_{02}$ 和 $\\omega_z = \\Omega_{10}$ 来提取，其中 $\\Omega_{ij}$ 是 $\\boldsymbol{\\Omega}$ 的元素。\n\n3.  **确定 IHA 方向和偏差：** IHA 的方向由单位矢量 $\\mathbf{n}(t) = \\boldsymbol{\\omega}(t) / \\|\\boldsymbol{\\omega}(t)\\|$ 给出。此计算仅在角速度大小 $\\|\\boldsymbol{\\omega}(t)\\|$ 不可忽略时有效。应用 $10^{-3} \\, \\text{rad/s}$ 的阈值来过滤掉轴定义不良的情况。大腿的屈伸轴被指定为其局部 $y$ 轴，由单位矢量 $\\mathbf{e}_y = [0, 1, 0]^{\\top}$ 表示。用于量化 IHA 与此主旋转轴未对准程度的角偏差 $\\delta(t)$ 计算为 $\\delta(t) = \\arccos(|\\mathbf{n}(t) \\cdot \\mathbf{e}_y|)$。使用点积的绝对值来测量两个轴之间的较小夹角，而不考虑其指向。结果从弧度转换为度以进行评估。\n\n4.  **基于相位的聚合：** 人类步态是周期性但非均匀的，由不同的功能相位组成。步幅被划分为四个相位：负重响应期（$\\phi \\in [0, 0.15]$）、站立中期（$\\phi \\in (0.15, 0.5]$）、站立末期（$\\phi \\in (0.5, 0.7]$）和摆动期（$\\phi \\in (0.7, 1.0]$）。对于每个相位，计算所得到偏差的均方根（RMS），即 $\\text{RMS} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M} \\delta_i^2}$。这为该相位的 IHA 对齐稳定性提供了一个单一的度量。整个过程对重建前（具有较大的平面外旋转）和重建后（具有较小的平面外旋转）的数据集都执行一次。\n\n5.  **计算最终评估指标：** 最终指标 $\\Delta$ 提供了一个改善程度的聚合度量。它是重建前后各相位 RMS 偏差之差的平均值：\n$$\n\\Delta = \\frac{1}{4} \\sum_{\\text{phases}} \\left( \\text{RMS}_{\\text{pre, phase}} - \\text{RMS}_{\\text{post, phase}} \\right)\n$$\n$\\Delta$ 的正值表示，平均而言，重建后的 IHA 与屈伸轴的对齐情况更好，这表明外科手术干预已成功恢复膝关节的运动学约束。最终的实现将根据这些步骤处理每个测试用例，以计算相应的 $\\Delta$ 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and assesses gait phase-specific Instantaneous Helical Axis (IHA)\n    of the shank relative to the thigh for pre- and post-ACL reconstruction scenarios.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement.\n    test_cases = [\n        {\n            \"N\": 501, \"T\": 1.0, \n            \"theta_expr\": \"30 * np.sin(2 * np.pi * phi) + 20\",\n            \"A_pre\": 5.0, \"A_post\": 2.0, \"B\": 3.0,\n            \"p_exprs\": [\n                \"0.005 * np.sin(2 * np.pi * phi)\",\n                \"0.0\",\n                \"0.010 * np.cos(2 * np.pi * phi)\"\n            ]\n        },\n        {\n            \"N\": 501, \"T\": 1.0, \n            \"theta_expr\": \"10 * np.sin(2 * np.pi * phi)\",\n            \"A_pre\": 4.0, \"A_post\": 1.0, \"B\": 2.0,\n            \"p_exprs\": [\n                \"0.003 * np.sin(4 * np.pi * phi)\",\n                \"0.0\",\n                \"0.008 * np.cos(2 * np.pi * phi)\"\n            ]\n        },\n        {\n            \"N\": 501, \"T\": 1.0, \n            \"theta_expr\": \"25 * np.sin(2 * np.pi * phi) + 10\",\n            \"A_pre\": 5.0, \"A_post\": 5.0, \"B\": 3.0,\n            \"p_exprs\": [\n                \"0.004 * np.sin(2 * np.pi * phi)\",\n                \"0.0\",\n                \"0.009 * np.cos(2 * np.pi * phi)\"\n            ]\n        }\n    ]\n\n    results = []\n\n    def calculate_phase_rms_deviations(N, T, theta_expr, A_deg, B_deg, p_exprs):\n        \"\"\"\n        Calculates the RMS deviation for each gait phase for a single motion scenario.\n        \"\"\"\n        # 1. Generate Synthetic Data\n        t = np.linspace(0, T, N, endpoint=True)\n        dt = t[1] - t[0]\n        phi = t / T\n        \n        # Define angle time series in radians\n        theta = np.radians(eval(theta_expr, {\"np\": np, \"phi\": phi}))\n        alpha = np.radians(A_deg * np.sin(2 * np.pi * phi))\n        beta = np.radians(B_deg * np.sin(2 * np.pi * phi))\n\n        # 2. Compute Rotation Matrices\n        ct, st = np.cos(theta), np.sin(theta)\n        ca, sa = np.cos(alpha), np.sin(alpha)\n        cb, sb = np.cos(beta), np.sin(beta)\n        \n        R = np.zeros((N, 3, 3))\n        # R = Ry(theta) @ Rx(alpha) @ Rz(beta)\n        R[:, 0, 0] = ct * cb + st * sa * sb\n        R[:, 0, 1] = -ct * sb + st * sa * cb\n        R[:, 0, 2] = st * ca\n        R[:, 1, 0] = ca * sb\n        R[:, 1, 1] = ca * cb\n        R[:, 1, 2] = -sa\n        R[:, 2, 0] = -st * cb + ct * sa * sb\n        R[:, 2, 1] = st * sb + ct * sa * cb\n        R[:, 2, 2] = ct * ca\n        \n        # 3. Compute Angular Velocity and Deviations\n        # Use central differences, which is valid for indices 1 to N-2\n        R_dot = (R[2:] - R[:-2]) / (2 * dt)\n        R_center = R[1:-1]\n        phi_center = phi[1:-1]\n        \n        deviations = []\n        deviation_phis = []\n        omega_threshold = 1e-3\n        e_y = np.array([0., 1., 0.])\n\n        for i in range(len(R_dot)):\n            Omega = R_dot[i] @ R_center[i].T\n            omega = np.array([Omega[2, 1], Omega[0, 2], Omega[1, 0]])\n            omega_mag = np.linalg.norm(omega)\n\n            if omega_mag > omega_threshold:\n                n = omega / omega_mag\n                dot_product = np.abs(np.dot(n, e_y))\n                # Clip for numerical stability of arccos\n                deviation_rad = np.arccos(np.clip(dot_product, -1.0, 1.0))\n                deviations.append(np.rad2deg(deviation_rad))\n                deviation_phis.append(phi_center[i])\n        \n        deviations = np.array(deviations)\n        deviation_phis = np.array(deviation_phis)\n\n        # 4. Phase-based RMS calculation\n        phase_masks = [\n            (deviation_phis >= 0)  (deviation_phis = 0.15),\n            (deviation_phis > 0.15)  (deviation_phis = 0.5),\n            (deviation_phis > 0.5)  (deviation_phis = 0.7),\n            (deviation_phis > 0.7)  (deviation_phis = 1.0)\n        ]\n        \n        phase_rms_list = []\n        for mask in phase_masks:\n            devs_in_phase = deviations[mask]\n            if len(devs_in_phase) > 0:\n                rms = np.sqrt(np.mean(devs_in_phase**2))\n                phase_rms_list.append(rms)\n            else:\n                phase_rms_list.append(0.0)\n        \n        return phase_rms_list\n\n    for case in test_cases:\n        # Unpack case parameters\n        N, T = case[\"N\"], case[\"T\"]\n        theta_expr = case[\"theta_expr\"]\n        A_pre, A_post = case[\"A_pre\"], case[\"A_post\"]\n        B = case[\"B\"]\n        p_exprs = case[\"p_exprs\"]\n\n        # Calculate RMS deviations for pre-reconstruction\n        rms_pre = calculate_phase_rms_deviations(N, T, theta_expr, A_pre, B, p_exprs)\n        \n        # Calculate RMS deviations for post-reconstruction\n        rms_post = calculate_phase_rms_deviations(N, T, theta_expr, A_post, B, p_exprs)\n        \n        # Compute the final aggregated metric Delta\n        rms_diffs = np.array(rms_pre) - np.array(rms_post)\n        delta = np.mean(rms_diffs)\n        \n        results.append(round(delta, 3))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}