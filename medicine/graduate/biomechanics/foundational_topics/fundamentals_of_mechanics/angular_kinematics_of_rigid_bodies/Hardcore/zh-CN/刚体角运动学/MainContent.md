## 引言
在生物力学中，精确描述人[体节](@entry_id:187163)段的三维运动是进行任何有意义的分析的前提。与直观的平动不同，[刚体](@entry_id:1131033)的旋转运动本质上更加复杂，其[非交换性](@entry_id:153545)与多种数学表示法（如[欧拉角](@entry_id:171794)、[旋转矩阵](@entry_id:140302)、[四元数](@entry_id:1130460)）并存，每种方法都伴随着独特的优势与陷阱。许多研究人员和工程师在处理旋转数据时常会遇到诸如“[万向节死锁](@entry_id:171734)”之类的难题，这会导致数据分析错误或算法失效。本文旨在为研究生和从业者提供一份关于[刚体](@entry_id:1131033)[角运动学](@entry_id:1121009)的全面而深入的指南，系统性地扫清这些理论和实践中的障碍。

在接下来的内容中，我们将分三个部分展开。首先，在“原理与机制”一章中，我们将从第一性原理出发，建立描述[刚体](@entry_id:1131033)朝向和[角速度](@entry_id:192539)的数学框架，并深入比较不同表示法的特性。接着，在“应用与跨学科联系”一章中，我们将展示这些理论如何在[惯性传感](@entry_id:202259)器数据分析、关节运动建模、[损伤生物力学](@entry_id:893396)以及[计算模型](@entry_id:637456)等前沿领域中发挥关键作用。最后，通过“动手实践”部分，您将有机会通过解决具体问题来巩固所学知识，将理论真正内化为解决实际问题的能力。

## 原理与机制

本章深入探讨了描述[刚体](@entry_id:1131033)[角运动学](@entry_id:1121009)的基本原理和数学机制。我们将从刚体运动的基本定义出发，系统地介绍如何表示和量化三维空间中的朝向，并推导出描述朝向如何随时间变化的运动学[微分](@entry_id:158422)方程。此外，我们还将讨论[相对运动](@entry_id:169798)的分析方法，并阐明在生物力学分析中选择不同数学表示的实际考量。

### 刚体运动的基本描述

在运动学中，**[刚体](@entry_id:1131033)**被理想化为一个点集，其中任意两点之间的距离在运动过程中保持不变。[刚体](@entry_id:1131033)的一般运动可以分解为平动和转动。描述这种运动的基本方程关联了[刚体](@entry_id:1131033)上任意两点的速度。

考虑一个[刚体](@entry_id:1131033)，例如人体的前臂。我们可以在[肘关节](@entry_id:900087)选择一个参考点 $O$，并在手上选择另一个点 $P$。在任意时刻，点 $P$ 的[瞬时速度](@entry_id:167797) $\mathbf{v}_P$ 与点 $O$ 的[瞬时速度](@entry_id:167797) $\mathbf{v}_O$ 之间的关系可以通过[刚体](@entry_id:1131033)的**角速度矢量** $\boldsymbol{\omega}$ 来描述。该关系式为：

$$
\mathbf{v}_P = \mathbf{v}_O + \boldsymbol{\omega} \times \mathbf{r}_{OP}
$$

其中 $\mathbf{r}_{OP}$ 是从点 $O$ 指向点 $P$ 的位置矢量，$\times$ 表示矢量叉乘。这个公式是[刚体运动学](@entry_id:203362)的核心，它表明点 $P$ 的速度是点 $O$ 的[平动](@entry_id:187700)速度与由[刚体](@entry_id:1131033)绕瞬时转轴旋转产生的速度分量的矢量和。

这个关系式引出了两种特殊的运动形式：
- **纯[平动](@entry_id:187700)**：当[刚体](@entry_id:1131033)没有旋转时，其角速度为零，即 $\boldsymbol{\omega} = \mathbf{0}$。此时，方程简化为 $\mathbf{v}_P = \mathbf{v}_O$。这意味着[刚体](@entry_id:1131033)上所有点的[瞬时速度](@entry_id:167797)都相同。
- **纯转动**：当[刚体](@entry_id:1131033)绕某固定点（或固定轴）转动时，我们可以选择该固定点为参考点 $O$，使其速度 $\mathbf{v}_O = \mathbf{0}$。此时，任意点 $P$ 的速度为 $\mathbf{v}_P = \boldsymbol{\omega} \times \mathbf{r}_{OP}$。

一个有趣的问题是：在什么条件下，[刚体](@entry_id:1131033)上两个不同的点 $P$ 和 $Q$ 会具有相同的[瞬时速度](@entry_id:167797)？即 $\mathbf{v}_P = \mathbf{v}_Q$。根据速度关系式，我们有 $\mathbf{v}_P = \mathbf{v}_Q + \boldsymbol{\omega} \times \mathbf{r}_{QP}$。因此，$\mathbf{v}_P = \mathbf{v}_Q$ 的条件是 $\boldsymbol{\omega} \times \mathbf{r}_{QP} = \mathbf{0}$。这个条件意味着角速度矢量 $\boldsymbol{\omega}$ 与连接两点的位置矢量 $\mathbf{r}_{QP}$ 平行。在一般的**三维运动**中，这并不一定意味着 $\boldsymbol{\omega} = \mathbf{0}$。例如，当物体绕着穿过 $P$ 和 $Q$ 的轴线旋转时，这两点的速度可以相同（如果它们还有沿着该轴的相同平移速度）。然而，在**平面运动**中，角[速度矢量](@entry_id:269648) $\boldsymbol{\omega}$ 垂直于运动平面，而 $\mathbf{r}_{QP}$ 位于运动平面内。在这种情况下，$\boldsymbol{\omega} \times \mathbf{r}_{QP} = \mathbf{0}$ 只有在 $\boldsymbol{\omega} = \mathbf{0}$ 时才成立。因此，对于平面运动，如果两个不同点具有相同的[瞬时速度](@entry_id:167797)，那么该运动在该时刻必定是纯[平动](@entry_id:187700)。

对于最一般的[刚体](@entry_id:1131033)位移，法国数学家 Michel Chasles 证明了一个优美的定理。**[沙勒定理](@entry_id:178784) (Chasles’ Theorem)** 指出，任何三维[刚体](@entry_id:1131033)的位移都可以等效地描述为绕某一独特轴线的一次旋转和沿同一轴线的一次平移的组合。这种组合运动被称为**螺旋运动**（screw motion）。这个唯一的轴线称为**[螺旋轴](@entry_id:268289)**。从更现代的几何观点来看，[刚体](@entry_id:1131033)的位移是**[特殊欧几里得群](@entry_id:139383)** $SE(3)$ 中的一个元素。[沙勒定理](@entry_id:178784)表明，$SE(3)$ 中的任何元素都可以通过其李代数 $\mathfrak{se}(3)$ 中一个元素的**[指数映射](@entry_id:137184)**来生成。这个李代数元素被称为**扭转**（twist），它精确地编码了螺旋运动的轴、旋转角和沿轴平移的距离（节距）。纯[平动](@entry_id:187700)可以视为节距无限大的螺旋运动。

### 朝向的数学表示

为了量化[刚体](@entry_id:1131033)的角运动，我们必须首先能够精确地描述其在空间中的**朝向**。朝向定义了嵌入在[刚体](@entry_id:1131033)内部的**体坐标系**与一个固定的**实验室坐标系**（或称[惯性系](@entry_id:266190)）之间的相对关系。生物力学研究中使用了多种数学工具来表示朝向，每种工具都有其独特的优缺点。

#### [旋转矩阵](@entry_id:140302)

表示朝向最基本的方法是使用**[旋转矩阵](@entry_id:140302)** $R$。这是一个 $3 \times 3$ 的矩阵，它将一个矢量在体坐标系中的坐标分量转换到[实验室坐标系](@entry_id:166991)中。[旋转矩阵](@entry_id:140302)属于**[三维特殊正交群](@entry_id:138200)**，记作 $SO(3)$。该群中的所有矩阵 $R$ 都必须满足两个条件：
1.  **正交性**: $R^{\top}R = I$，其中 $I$ 是 $3 \times 3$ 的[单位矩阵](@entry_id:156724)。这个条件保证了变换前后矢量的长度和矢量间的夹角不变。
2.  **特殊性**: $\det(R) = +1$。这个条件保证了变换保持了坐标系的“手性”（例如，[右手坐标系](@entry_id:166669)仍然是[右手坐标系](@entry_id:166669)），从而排除了[反射变换](@entry_id:175518)。

一个旋转矩阵有 9 个元素，但[正交性条件](@entry_id:168905) $R^{\top}R = I$ 实际上施加了 6 个独立的约束（因为 $R^{\top}R$ 是[对称矩阵](@entry_id:143130)）。因此，一个[三维旋转](@entry_id:148533)的独立自由度是 $9 - 6 = 3$，这与我们的直觉相符。

[旋转矩阵](@entry_id:140302)的主要优点是它**全局无奇异性**，可以表示任何朝向而不会出现数学上的崩溃。此外，它对矢量的变换是线性的（即 $x_{lab} = R x_{body}$）。然而，它的缺点是**冗余**——用 9 个数来描述一个 3 自由度的量。在数值计算中，由于噪声和累积误差，矩阵 $R$ 可能会逐渐偏离 $SO(3)$ 的严格约束。因此，通常需要周期性地进行**[再正交化](@entry_id:754248)**，以确保其保持正交性和单位行列式属性。

#### 有限[旋转的非交换性](@entry_id:167347)

理解[角运动学](@entry_id:1121009)的一个核心概念是**有限[旋转的非交换性](@entry_id:167347)**。与可以任意顺序相加的平移矢量不同，有限旋转的最终结果取决于其执行的顺序。

我们可以通过一个具体的例子来证明这一点。考虑一个上臂节段，我们定义两个 $90^{\circ}$ 的旋转：$R_1$ 是绕 $x$ 轴的旋转（外展），$R_2$ 是绕 $y$ 轴的旋转（前屈）。它们的[旋转矩阵](@entry_id:140302)分别为：

$$
R_1 = R_x(90^{\circ}) = \begin{pmatrix} 1  0  0 \\ 0  0  -1 \\ 0  1  0 \end{pmatrix}, \quad R_2 = R_y(90^{\circ}) = \begin{pmatrix} 0  0  1 \\ 0  1  0 \\ -1  0  0 \end{pmatrix}
$$

如果我们先执行 $R_1$ 再执行 $R_2$，复合旋转为 $R_{2}R_{1}$：

$$
R_{2}R_{1} = \begin{pmatrix} 0  1  0 \\ 0  0  -1 \\ -1  0  0 \end{pmatrix}
$$

如果我们颠倒顺序，先执行 $R_2$ 再执行 $R_1$，复合旋转为 $R_{1}R_{2}$：

$$
R_{1}R_{2} = \begin{pmatrix} 0  0  1 \\ 1  0  0 \\ 0  1  0 \end{pmatrix}
$$

显然，$R_{1}R_{2} \neq R_{2}R_{1}$。这表明旋转的顺序至关重要。这个数学事实对生物力学具有深远的实际意义。当我们使用如[欧拉角](@entry_id:171794)或卡丹角这样的旋转序列来描述关节运动时，必须明确并一致地使用预定义的旋转顺序（例如，屈伸-外展-内外旋）。否则，不同研究或临床评估得到的运动学数据将不具有可比性。这正是国际生物力学学会（ISB）等组织推荐[标准化](@entry_id:637219)[关节坐标系](@entry_id:1126835)和旋转顺序的原因。

#### 最小[参数化](@entry_id:265163)方法

为了避免[旋转矩阵](@entry_id:140302)的冗余性，研究人员常常使用**最小[参数化](@entry_id:265163)**方法，即用三个参数来描述一个旋转。

**[欧拉角](@entry_id:171794)/卡丹角**

这是最直观的最小[参数化](@entry_id:265163)方法之一。它将一个复杂的旋转分解为绕三个预定坐标轴的一系列连续的**基本旋转**。当三个旋转轴都不同时（例如 X-Y-Z），这组角被称为**卡丹角**；当第一个和第三个[旋转轴](@entry_id:187094)相同时（例如 Z-X-Z），它们被称为**欧拉角**。

[欧拉角](@entry_id:171794)的主要优点在于其**可解释性**。通过仔细选择与关节解剖结构相匹配的旋转顺序，三个角度可以直观地对应于临床上熟悉的运动，如屈伸、外展/内收和内/外旋。

然而，所有三[参数表示](@entry_id:173803)法都存在一个致命的缺陷：**运动学奇异性**，通常称为**[万向节死锁](@entry_id:171734) (Gimbal Lock)**。

##### [万向节死锁](@entry_id:171734)

万向节死锁是一种几何状态，在此状态下，旋转序列中的两个旋转轴变得共线，导致系统失去一个旋转自由度。对于一个给定的三角度[参数化](@entry_id:265163)，这对应于一个奇异点，在该点，角速度与角度变化率之间的关系变得不可逆。

让我们以两种常见的旋转序列为例进行分析 ：
1.  **内旋卡丹序列 Z-Y'-X''**: 这是航空航天和生物力学中常用的序列（[偏航-俯仰-滚转](@entry_id:199824)）。第一次绕 $Z$ 轴旋转，第二次绕新的 $Y'$ 轴旋转，第三次绕最新的 $X''$ 轴旋转。当第二次旋转的角度（俯仰角 $\theta$）为 $\pm 90^{\circ}$ 时，第一次旋转的 $Z$ 轴与第三次旋转的 $X''$ 轴会发生重合。此时，绕 $Z$ 轴的旋转（偏航）与绕 $X''$ 轴的旋转（滚转）产生了相同的效果，无法唯一确定这两个角度的变化率。
2.  **内旋欧拉序列 Z-X'-Z''**: 这种序列常用于描述陀螺和天体的运动。当第二次旋转的角度 $\beta$ 为 $0$ 或 $\pi$ 时，第一次旋转的 $Z$ 轴与第三次旋转的 $Z''$ 轴会发生重合。同样，这导致了两个旋转自由度的纠缠。

万向节死锁不是一个可以轻易避免的数值问题，而是三[参数表示](@entry_id:173803)法固有的[拓扑缺陷](@entry_id:138787)。尽管在某些应用中（如描述生理活动范围有限的人体关节），可以选择旋转序列将[奇异点](@entry_id:199525)置于几乎不可能达到的姿态，但这并不能完全消除奇异性。因此，欧拉角非常不适合用于需要处理任意大范围旋转的[数值积分](@entry_id:136578)或[优化算法](@entry_id:147840)中。 

**[轴角表示](@entry_id:186186)法**

另一种最小[参数化](@entry_id:265163)方法是**[轴角表示](@entry_id:186186)法**。它用一个单位矢量 $\mathbf{u}$（表示旋转轴）和一个标量角 $\theta$（表示绕该轴的旋转角度）来描述旋转。这种表示法可以紧凑地写成一个三维的**旋转矢量** $\phi = \theta \mathbf{u}$。

这种表示法与[沙勒定理](@entry_id:178784)中的[有限螺旋轴](@entry_id:1124990)直接相关，因此在解释有限位移时非常自然。然而，它也存在奇异性：
- 当旋转角 $\theta = 0$ 时，旋转是单位变换，此时旋转轴 $\mathbf{u}$ 未定义。
- 当旋转角 $\theta = \pi$ 时，绕轴 $\mathbf{u}$ 旋转与绕轴 $-\mathbf{u}$ 旋转是等效的，存在符号模糊。

#### 过[参数化](@entry_id:265163)方法

为了克服最小[参数化](@entry_id:265163)方法的奇异性问题，我们可以使用参数数量超过自由度的**过[参数化](@entry_id:265163)**方法。

**[单位四元数](@entry_id:204470)**

**[单位四元数](@entry_id:204470)**是目前在[机器人学](@entry_id:150623)、航空航天和生物力学中用于[三维旋转](@entry_id:148533)计算的最流行和最稳健的方法。一个[四元数](@entry_id:1130460)是一个四维数 $q = (q_w, q_x, q_y, q_z)$，可以看作是一个标量部分 $q_w$ 和一个矢量部分 $\mathbf{q}_v = (q_x, q_y, q_z)$ 的组合。用于表示旋转的四元数必须是**[单位四元数](@entry_id:204470)**，即其范数必须为 1：

$$
\|q\|^2 = q_w^2 + q_x^2 + q_y^2 + q_z^2 = 1
$$

这意味着所有表示旋转的四元数都位于 $\mathbb{R}^4$ 中的一个三维[单位球](@entry_id:142558)面上 ($S^3$)。

四元数的主要优点是它们**全局无奇异性**——不存在[万向节死锁](@entry_id:171734)问题。从角速度到四元数的时间导数的[运动学方程](@entry_id:173032)是线性的，这使得[数值积分](@entry_id:136578)非常稳定和高效。

[四元数表示](@entry_id:146458)法的代价是：
- **冗余性**：使用 4 个参数描述 3 个自由度。
- **约束**：必须在计算过程中始终强制执行单位范数约束。幸运的是，这个单一的二次约束可以通过简单的归一化步骤 ($q \leftarrow q / \|q\|$) 来高效地处理。
- **双重覆盖**：[四元数](@entry_id:1130460) $q$ 和它的负数 $-q$ 表示完全相同的物理旋转。这在大多数应用中不成问题，但在某些优化和插值任务中需要特别处理。

在实践中，一种常见的工作流程是：使用四元数进行所有内部的动力学计算和姿态积分，因为它们数值性能优越；然后在需要向用户报告或进行临床解释时，再将最终的四元数朝向转换为更直观的[欧拉角](@entry_id:171794)序列。 

### 运动学[微分](@entry_id:158422)方程

[角运动学](@entry_id:1121009)不仅要描述静态的朝向，更重要的是要描述朝向如何随时间变化。这由连接朝向表示的时间导数与角速度矢量的**运动学[微分](@entry_id:158422)方程**给出。

#### [惯性系](@entry_id:266190)与旋转系中的导数：[输运定理](@entry_id:176504)

在推导[运动学方程](@entry_id:173032)之前，我们必须理解在一个[旋转坐标系](@entry_id:170324)中观察一个矢量与在[惯性系](@entry_id:266190)中观察有何不同。考虑一个任意矢量 $\mathbf{a}(t)$，它可能因为软组织滑动等原因，即使在身体坐标系 $\mathrm{B}$ 中也是时变的。它在[惯性系](@entry_id:266190) $\mathrm{I}$ 中的时间导数 $\left(\frac{d\mathbf{a}}{dt}\right)_{\mathrm{I}}$ 与它在身体坐标系 $\mathrm{B}$ 中的时间导数 $\left(\frac{d\mathbf{a}}{dt}\right)_{\mathrm{B}}$ 之间的关系由**[输运定理](@entry_id:176504)**（Transport Theorem）给出：

$$
\left(\frac{d\mathbf{a}}{dt}\right)_{\mathrm{I}} = \left(\frac{d\mathbf{a}}{dt}\right)_{\mathrm{B}} + \boldsymbol{\omega}^{\mathrm{IB}} \times \mathbf{a}
$$

其中 $\boldsymbol{\omega}^{\mathrm{IB}}$ 是坐标系 $\mathrm{B}$ 相对于坐标系 $\mathrm{I}$ 的角速度。这个公式表明，惯性导数等于相对导数（矢量在旋转系中的变化）加上一个由坐标系自身旋转引起的附加项。这个附加项 $\boldsymbol{\omega}^{\mathrm{IB}} \times \mathbf{a}$ 解释了即使矢量 $\mathbf{a}$ 在身体坐标系中是固定的（即 $\left(\frac{d\mathbf{a}}{dt}\right)_{\mathrm{B}} = \mathbf{0}$），它在[惯性系](@entry_id:266190)中看起来仍然在变化（因为整个坐标系在旋转）。

#### 空间角速度与[物体角速度](@entry_id:1121729)

角速度矢量 $\boldsymbol{\omega}$ 是一个物理量，独立于任何坐标系。然而，当我们要用数字表示它时，必须选择一个坐标系。这导致了两种常用的[角速度](@entry_id:192539)表示：
- **空间角速度** $\boldsymbol{\omega}_s$：角[速度矢量](@entry_id:269648)在**[实验室坐标系](@entry_id:166991)**中的分量。
- **[物体角速度](@entry_id:1121729)** $\boldsymbol{\omega}_b$：角[速度矢量](@entry_id:269648)在**体坐标系**中的分量。

这两组分量描述的是同一个物理矢量，因此它们可以通过[旋转矩阵](@entry_id:140302) $R$（将体坐标系映射到[实验室坐标系](@entry_id:166991)）相互转换：

$$
\boldsymbol{\omega}_s = R \boldsymbol{\omega}_b
$$

在生物力学中，这是一个至关重要的区别。例如，一个牢固绑在肢体节段上的陀螺仪或[惯性测量单元](@entry_id:1126479)（IMU）测量的是**[物体角速度](@entry_id:1121729)** $\boldsymbol{\omega}_b$，因为它是在传感器自身的坐标系中进行测量的。 

#### 朝向的演化

现在我们可以推导[旋转矩阵](@entry_id:140302) $R$ 的时间[演化方程](@entry_id:268137)。考虑一个固定在[刚体](@entry_id:1131033)上的矢量 $\mathbf{x}_b$（因此其在体坐标系中的时间导数为零）。它在[实验室坐标系](@entry_id:166991)中的表示为 $\mathbf{x}_s(t) = R(t) \mathbf{x}_b$。对时间求导，我们得到其在实验室坐标系中的速度：

$$
\mathbf{v}_s = \dot{R} \mathbf{x}_b
$$

根据纯转动的速度公式，我们也有 $\mathbf{v}_s = \boldsymbol{\omega}_s \times \mathbf{x}_s = [\boldsymbol{\omega}_s]_\times \mathbf{x}_s$，其中 $[\cdot]_\times$ 是将叉乘运算转换为[矩阵乘法](@entry_id:156035)的[斜对称矩阵](@entry_id:155998)算子。将 $\mathbf{x}_s = R \mathbf{x}_b$ 代入，得到 $\mathbf{v}_s = [\boldsymbol{\omega}_s]_\times R \mathbf{x}_b$。

比较两种速度表达式，我们得到第一个运动学[微分](@entry_id:158422)方程：

$$
\dot{R} = [\boldsymbol{\omega}_s]_\times R
$$

这个方程使用**空间[角速度](@entry_id:192539)**来描述朝向的变化。

我们也可以从[物体角速度](@entry_id:1121729)出发。利用 $\boldsymbol{\omega}_s = R \boldsymbol{\omega}_b$ 和一个矩阵恒等式 $[R\mathbf{v}]_\times = R[\mathbf{v}]_\times R^\top$，我们可以证明 $\dot{R} = R [\boldsymbol{\omega}_b]_\times$。这个方程使用**[物体角速度](@entry_id:1121729)**来描述朝向的变化。

从这两个方程，我们可以反解出角速度张量：
- 空间角速度张量：$[\boldsymbol{\omega}_s]_\times = \dot{R} R^\top$
- [物体角速度](@entry_id:1121729)张量：$[\boldsymbol{\omega}_b]_\times = R^\top \dot{R}$

这两个乘积 $R^\top \dot{R}$ 和 $\dot{R} R^\top$ 都是**[斜对称矩阵](@entry_id:155998)**，这保证了它们可以被唯一地映射回一个三维的角[速度矢量](@entry_id:269648)。

对于[四元数](@entry_id:1130460)，其[运动学方程](@entry_id:173032)为 $\dot{q} = \frac{1}{2} q \otimes \omega_q$，其中 $\omega_q$ 是由[物体角速度](@entry_id:1121729) $\boldsymbol{\omega}_b$ 构成的纯[四元数](@entry_id:1130460) $[0, \boldsymbol{\omega}_b^\top]^\top$。这个方程对于 $q$ 是线性的，这是其在数值积分中表现出色的一个关键原因。

### 相对[角运动学](@entry_id:1121009)

在生物力学中，我们通常更关心一个节段相对于另一个节段的运动（例如，胫骨相对于股骨的运动），而不是它们各自相对于实验室的绝对运动。

假设我们有两个节段 $A$ 和 $B$，其相对于实验室的朝向分别为 $R_A$ 和 $R_B$。节段 $B$ 相对于节段 $A$ 的**相对朝向** $R_{AB}$ 定义为将矢量从 $B$ [坐标系转换](@entry_id:263003)到 $A$ 坐标系的[旋转矩阵](@entry_id:140302)。这个矩阵可以由绝对朝向矩阵复合而成：

$$
R_{AB} = R_A^\top R_B
$$

通过对这个定义式求时间导数，并应用绝对朝向的[运动学方程](@entry_id:173032)，我们可以推导出相对朝向的[运动学方程](@entry_id:173032) ：

$$
\dot{R}_{AB} = [\boldsymbol{\omega}_{AB}^A]_\times R_{AB}
$$

其中，$\boldsymbol{\omega}_{AB}^A$ 是 $B$ 相对于 $A$ 的**相对[角速度](@entry_id:192539)**，且其分量是在 $A$ 坐标系中表示的。它与绝对[角速度](@entry_id:192539)的关系是：

$$
\boldsymbol{\omega}_{AB}^A = R_A^\top (\boldsymbol{\omega}_B^s - \boldsymbol{\omega}_A^s)
$$

这里 $\boldsymbol{\omega}_A^s$ 和 $\boldsymbol{\omega}_B^s$ 是在实验室坐标系中表示的绝对[角速度](@entry_id:192539)。这个结果强调了在处理[相对运动](@entry_id:169798)时，正确地进行[坐标变换](@entry_id:172727)至关重要。

另一个相关的、非常重要的结果是**[角速度](@entry_id:192539)的合成法则**。如果我们将所有角速度都在各自的体坐标系中表示，例如，$\boldsymbol{\omega}_A$ 是 $A$ 的[角速度](@entry_id:192539)在 $A$ 坐标系中的分量，$\boldsymbol{\omega}_B$ 是 $B$ 的[角速度](@entry_id:192539)在 $B$ 坐标系中的分量，那么 $B$ 相对于 $A$ 的角速度（在 $B$ 坐标系中表示）为 ：

$$
\boldsymbol{\omega}_{AB} = \boldsymbol{\omega}_B - R_{BA} \boldsymbol{\omega}_A
$$

其中 $R_{BA} = R_B^\top R_A$ 是将矢量从 $A$ [坐标系转换](@entry_id:263003)到 $B$ 坐标系的[旋转矩阵](@entry_id:140302)。这个公式构成了[多体动力学](@entry_id:1128293)和多节段人体建模的基础。

### 在[运动学分析](@entry_id:1126917)中的应用

本章讨论的原理在生物力学运动分析中有着广泛的应用，尤其是在基于优化的**运动学拟合**中。这类问题旨在从运动捕捉系统测量的标记点数据中，为每个身体节段找到最佳的朝向轨迹。

具体来说，任务是最小化一个代价函数，该函数量化了模型上的标记点（在体坐标系中位置已知）经过[旋转和平移](@entry_id:175994)后与实验室中测量的标记点位置之间的差异。选择合适的朝向[参数化](@entry_id:265163)方法对于[优化算法](@entry_id:147840)的成功至关重要。

如前所述，[欧拉角](@entry_id:171794)由于其[万向节死锁](@entry_id:171734)问题，在处理大幅度运动时会导致[优化算法](@entry_id:147840)不稳定或失败。相比之下，[单位四元数](@entry_id:204470)因其全局无奇异性而成为更优越的选择。尽管它们是过[参数化](@entry_id:265163)的，但其单一的单位范数约束易于处理。

更先进的方法是**基于流形的优化**。这种方法直接在旋转群 $SO(3)$ 这个弯曲的流形上进行操作。它将朝向状态（例如，用一个旋转矩阵或[四元数表示](@entry_id:146458)）保留在流形上，而优化更新步长则是在当前状态点的**切空间**（即[李代数](@entry_id:137954) $\mathfrak{so}(3)$）中计算。这个[切空间](@entry_id:199137)是一个简单的[欧几里得空间](@entry_id:138052)（同构于 $\mathbb{R}^3$），可以用旋转矢量来[参数化](@entry_id:265163)。通过[指数映射](@entry_id:137184)将这个小的旋转增量应用回流形上，可以保证优化过程中的每一步都严格保持在 $SO(3)$ 的约束内。这种方法从根本上避免了对全局[坐标图](@entry_id:156506)的需求，因此完全绕开了万向节死锁等奇异性问题，是现代[运动学分析](@entry_id:1126917)中最为稳健和精确的技术。