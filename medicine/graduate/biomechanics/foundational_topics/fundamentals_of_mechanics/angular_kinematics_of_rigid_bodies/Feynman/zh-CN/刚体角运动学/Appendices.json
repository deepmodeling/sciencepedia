{
    "hands_on_practices": [
        {
            "introduction": "在分析复杂的关节运动之前，我们必须掌握矢量运算的基础。本练习强调了运动学中的一个关键原则：矢量运算，例如在计算相对角速度时，要求所有矢量都在同一坐标系中表示 。通过一个常见的生物力学场景，您将学会如何正确地转换角速度矢量，并避免运动分析中一个常见的错误来源。",
            "id": "4153655",
            "problem": "一个人类膝关节被建模为一个连接近端大腿节段和远端小腿节段的转动关节。实验室坐标系 (LAB) 具有固定在空间中的标准正交基向量。大腿节段带有一个局部标准正交标架，记为 $T$；小腿节段带有一个局部标准正交标架，记为 $S$。在一次动态试验的某一瞬间，这些节段标架相对于 LAB 的方位是绕 LAB $z$ 轴的纯旋转：\n- 大腿标架 $T$ 绕 LAB $z$ 轴旋转了 $30^{\\circ}$。\n- 小腿标架 $S$ 绕 LAB $z$ 轴旋转了 $75^{\\circ}$。\n\n刚体的角速度是一个与参考系无关的矢量，但其坐标表示取决于基的选择。在所考虑的瞬间，运动捕捉估计提供了节段的以下角速度矢量，每个矢量都在其自身的局部标架坐标中表示：\n- 在 $T$ 中表示的大腿角速度：$\\boldsymbol{\\omega}_{T}^{T} = \\begin{pmatrix} 0.10 \\\\ 1.20 \\\\ 0.05 \\end{pmatrix}$，单位为 $\\mathrm{rad/s}$。\n- 在 $S$ 中表示的小腿角速度：$\\boldsymbol{\\omega}_{S}^{S} = \\begin{pmatrix} 0.20 \\\\ 1.80 \\\\ 0.04 \\end{pmatrix}$，单位为 $\\mathrm{rad/s}$。\n\n膝关节屈伸轴与大腿标架 $T$ 的 $y$ 轴对齐，因此标量膝关节屈伸速率是小腿相对于大腿的相对角速度在 $T$ 标架 $y$ 轴上的投影。\n\n一个常见但错误的做法是直接减去 $\\boldsymbol{\\omega}_{S}^{S}$ 和 $\\boldsymbol{\\omega}_{T}^{T}$ 的 $y$ 分量，尽管这些分量是在不同的标架中表示的。这种混合标架的做法会得出一个不正确的关节速率估计值。\n\n利用刚体运动学的基本原理，在相减之前将所有角速度矢量表示在同一个一致的标架中，确定此时修正后的标量膝关节屈伸角速度。将最终结果四舍五入到四位有效数字，并以 $\\mathrm{rad/s}$ 为单位表示。",
            "solution": "该问题是有效的，因为它科学地基于刚体运动学原理，数据充分且一致，表述客观，是一个适定的问题。因此我们可以进行求解。\n\n问题的核心是计算小腿与大腿之间的相对角速度，然后找出其沿膝关节屈伸轴的分量。小腿节段 ($S$) 相对于大腿节段 ($T$) 的相对角速度的基本方程为：\n$$\n\\boldsymbol{\\omega}_{S/T} = \\boldsymbol{\\omega}_{S} - \\boldsymbol{\\omega}_{T}\n$$\n此处，$\\boldsymbol{\\omega}_{S}$ 和 $\\boldsymbol{\\omega}_{T}$ 分别是小腿和大腿的绝对角速度。矢量代数的一个关键原则是，只有当矢量的分量在同一坐标系中表示时，才能进行矢量减法。\n\n问题指出，膝关节屈伸轴与大腿标架 $T$ 的 $y$ 轴对齐。设此轴由单位向量 $\\hat{y}_T$ 表示。我们记为 $\\omega_{flex/ext}$ 的标量膝关节屈伸角速度，是相对角速度矢量 $\\boldsymbol{\\omega}_{S/T}$ 在此轴上的投影。这通过点积计算：\n$$\n\\omega_{flex/ext} = \\boldsymbol{\\omega}_{S/T} \\cdot \\hat{y}_T\n$$\n为计算此点积，最方便的方法是将两个矢量都在大腿标架 $T$ 的坐标中表示。在此标架中，单位向量 $\\hat{y}_T$ 有一个简单的表示：\n$$\n(\\hat{y}_T)^T = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n在标架 $T$ 中表示的相对角速度为 $\\boldsymbol{\\omega}_{S/T}^T = \\boldsymbol{\\omega}_{S}^T - \\boldsymbol{\\omega}_{T}^T$。因此，点积变为相对角速度矢量在 $T$ 标架中的第二个分量（$y$ 分量）：\n$$\n\\omega_{flex/ext} = (\\boldsymbol{\\omega}_{S}^T - \\boldsymbol{\\omega}_{T}^T) \\cdot (\\hat{y}_T)^T = (\\boldsymbol{\\omega}_{S}^T)_y - (\\boldsymbol{\\omega}_{T}^T)_y\n$$\n我们已知在大腿自身的标架 $T$ 中表示的角速度：\n$$\n\\boldsymbol{\\omega}_{T}^{T} = \\begin{pmatrix} 0.10 \\\\ 1.20 \\\\ 0.05 \\end{pmatrix} \\, \\mathrm{rad/s}\n$$\n由此，我们直接得到 $(\\boldsymbol{\\omega}_{T}^T)_y = 1.20 \\, \\mathrm{rad/s}$。\n\n主要任务是确定 $(\\boldsymbol{\\omega}_{S}^T)_y$。我们已知在小腿自身的标架 $S$ 中表示的角速度：\n$$\n\\boldsymbol{\\omega}_{S}^{S} = \\begin{pmatrix} 0.20 \\\\ 1.80 \\\\ 0.04 \\end{pmatrix} \\, \\mathrm{rad/s}\n$$\n为了在标架 $T$ 中找到该矢量的分量，我们必须使用一个旋转矩阵 $R_{S \\to T}$ 进行坐标变换，该矩阵将坐标从标架 $S$ 映射到标架 $T$。\n$$\n\\boldsymbol{\\omega}_{S}^{T} = R_{S \\to T} \\boldsymbol{\\omega}_{S}^{S}\n$$\n旋转矩阵 $R_{S \\to T}$ 可以通过复合经过实验室 (LAB) 标架的旋转来确定。从 $S$ 到 $T$ 的变换等效于从 $S$ 变换到 LAB，然后再从 LAB 变换到 $T$：\n$$\nR_{S \\to T} = R_{L \\to T} R_{S \\to L}\n$$\n问题指出，节段标架是通过绕 LAB $z$ 轴的纯旋转来定向的。一个标架绕父标架的 $z$ 轴旋转角度 $\\theta$ 对应于一个从旋转后的标架到父标架的坐标变换矩阵 $R_z(\\theta)$。\n$$\nR_z(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta & 0 \\\\ \\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n大腿标架 $T$ 相对于 LAB 旋转了 $\\theta_T = 30^{\\circ}$，因此从 $T$ 到 LAB 的变换是 $R_{T \\to L} = R_z(\\theta_T)$。其逆变换，即从 LAB 到 $T$，是该矩阵的转置：$R_{L \\to T} = (R_{T \\to L})^T = R_z(-\\theta_T)$。\n\n小腿标架 $S$ 相对于 LAB 旋转了 $\\theta_S = 75^{\\circ}$，因此从 $S$ 到 LAB 的变换是 $R_{S \\to L} = R_z(\\theta_S)$。\n\n将这些代入 $R_{S \\to T}$ 的表达式中：\n$$\nR_{S \\to T} = R_z(-\\theta_T) R_z(\\theta_S)\n$$\n由于绕同一轴的旋转是可加的，这可以简化为：\n$$\nR_{S \\to T} = R_z(\\theta_S - \\theta_T)\n$$\n我们来计算相对角度 $\\Delta\\theta = \\theta_S - \\theta_T = 75^{\\circ} - 30^{\\circ} = 45^{\\circ}$。因此，所需的旋转矩阵是：\n$$\nR_{S \\to T} = R_z(45^{\\circ}) = \\begin{pmatrix} \\cos(45^{\\circ}) & -\\sin(45^{\\circ}) & 0 \\\\ \\sin(45^{\\circ}) & \\cos(45^{\\circ}) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{2}}{2} & -\\frac{\\sqrt{2}}{2} & 0 \\\\ \\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n现在我们可以计算矢量 $\\boldsymbol{\\omega}_{S}^T$：\n$$\n\\boldsymbol{\\omega}_{S}^{T} = \\begin{pmatrix} \\frac{\\sqrt{2}}{2} & -\\frac{\\sqrt{2}}{2} & 0 \\\\ \\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0.20 \\\\ 1.80 \\\\ 0.04 \\end{pmatrix}\n$$\n我们只需要 $y$ 分量，即 $(\\boldsymbol{\\omega}_{S}^T)_y$，它由矩阵向量乘积的第二行得出：\n$$\n(\\boldsymbol{\\omega}_{S}^T)_y = \\left(\\frac{\\sqrt{2}}{2}\\right)(0.20) + \\left(\\frac{\\sqrt{2}}{2}\\right)(1.80) = \\frac{\\sqrt{2}}{2} (0.20 + 1.80) = \\frac{\\sqrt{2}}{2} (2.00) = \\sqrt{2} \\, \\mathrm{rad/s}\n$$\n最后，我们可以计算标量膝关节屈伸角速度：\n$$\n\\omega_{flex/ext} = (\\boldsymbol{\\omega}_{S}^T)_y - (\\boldsymbol{\\omega}_{T}^T)_y = \\sqrt{2} - 1.20 \\, \\mathrm{rad/s}\n$$\n现在我们代入 $\\sqrt{2}$ 的数值 $\\approx 1.41421356...$：\n$$\n\\omega_{flex/ext} \\approx 1.41421356 - 1.20 = 0.21421356 \\, \\mathrm{rad/s}\n$$\n按要求将结果四舍五入到四位有效数字，得到：\n$$\n\\omega_{flex/ext} \\approx 0.2142 \\, \\mathrm{rad/s}\n$$\n这个修正后的值考虑了大腿和小腿标架的相对方位，与直接从不同坐标系中减去分量的错误方法形成对比，后者会得出 $1.80 - 1.20 = 0.60 \\, \\mathrm{rad/s}$ 的结果。",
            "answer": "$$\n\\boxed{0.2142}\n$$"
        },
        {
            "introduction": "瞬时角速度是如何在一段时间内导致有限的方向变化的？本练习使用矩阵指数来处理恒定角速度的情况，从而弥合了运动微分方程 $\\dot{R} = R[\\boldsymbol{\\omega}]_{\\times}$ 与最终旋转矩阵之间的鸿沟 。您将使用罗德里格斯公式 (Rodrigues' formula) 推导出精确的旋转，并将其与一阶线性近似进行比较，从而对线性化误差有一个具体的理解。",
            "id": "4153697",
            "problem": "一个刚性肱骨段被建模为一个刚体，其在实验室坐标系中的姿态由一个旋转矩阵 $R(t) \\in \\mathrm{SO}(3)$ 描述，其中 $\\mathrm{SO}(3)$ 表示三维特殊正交群。在一次高速投掷运动的短暂 $4$ 毫秒时间间隔内，肱骨在其解剖坐标系中经历一个恒定的角速度，由向量 $\\boldsymbol{\\omega} = (12, 16, 15)$ 给出，单位为弧度/秒。假设在该时间间隔开始时的初始姿态为 $R(0) = I$，其中 $I$ 是单位矩阵。\n\n从刚体角运动学的基本原理出发，特别是根据瞬时角速度 $\\boldsymbol{\\omega}(t)$ 通过刚体旋转的线性微分方程 $dR/dt = R \\,\\Omega(t)$ 生成旋转的定义，其中 $\\Omega(t)$ 是唯一的反对称矩阵，满足对于任意向量 $\\mathbf{v}$ 都有 $\\Omega(t)\\,\\mathbf{v} = \\boldsymbol{\\omega}(t) \\times \\mathbf{v}$，执行以下操作：\n\n- 对于恒定的 $\\boldsymbol{\\omega}$，在 $\\Delta t = 0.004$ 秒的时间间隔内，使用旋转运动学的矩阵指数解所蕴含的轴-角表示法，推导闭式有限旋转算子 $R(\\Delta t)$。\n- 通过将指数展开截断至线性项，构建相同旋转的一阶小角度线性化 $R_{\\text{lin}}(\\Delta t)$。\n- 使用线性算子的弗罗贝尼乌斯范数，计算偏差 $E = \\|R(\\Delta t) - R_{\\text{lin}}(\\Delta t)\\|_{F}$ 的大小，结果为一个标量。您必须推导 $E$ 关于在 $\\Delta t$ 时间内累积的旋转角的表达式。\n\n所有角度均以弧度为单位。将最终误差大小 $E$ 表示为一个无量纲实数。将您的最终答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- **刚体模型**：一个肱骨段被建模为一个刚体。\n- **姿态描述**：姿态由一个旋转矩阵 $R(t) \\in \\mathrm{SO}(3)$ 给出。\n- **时间间隔**：运动发生在 $\\Delta t = 4$ 毫秒的时间间隔内，即 $\\Delta t = 0.004$ 秒。\n- **角速度**：体坐标系角速度是恒定的，由向量 $\\boldsymbol{\\omega} = (12, 16, 15)$ 给出，单位为弧度/秒。\n- **初始条件**：初始姿态为 $R(0) = I$，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n- **控制方程**：运动学由微分方程 $\\frac{dR}{dt} = R(t) \\Omega(t)$ 描述。\n- **反对称矩阵**：$\\Omega(t)$ 是与角速度向量 $\\boldsymbol{\\omega}(t)$ 相关联的反对称矩阵，使得对于任意向量 $\\mathbf{v}$ 都有 $\\Omega(t)\\mathbf{v} = \\boldsymbol{\\omega}(t) \\times \\mathbf{v}$。\n- **任务 1**：推导闭式旋转矩阵 $R(\\Delta t)$。\n- **任务 2**：构建一阶线性化 $R_{\\text{lin}}(\\Delta t)$。\n- **任务 3**：使用弗罗贝尼乌斯范数计算偏差误差 $E = \\|R(\\Delta t) - R_{\\text{lin}}(\\Delta t)\\|_{F}$。\n- **任务 4**：推导 $E$ 作为总旋转角函数的表达式。\n- **最终答案格式**：$E$ 的最终值必须是四舍五入到四位有效数字的单个实数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题植根于刚体运动学的标准原理。控制方程 $\\frac{dR}{dt} = R \\Omega$ 正确描述了在给定体固角速度 $\\boldsymbol{\\omega}$（由其反对称矩阵形式 $\\Omega$ 表示）下，姿态矩阵 $R$ 的演化。角速度的数值很高，但对于像投掷这样的高速运动来说，在生物力学上是合理的。\n- **适定性**：该问题是适定的。它提供了一个具有常系数和指定初始条件的线性常微分方程，这保证了唯一解的存在。所有计算所需量所需的数据（$\\boldsymbol{\\omega}$, $\\Delta t$, $R(0)$）均已提供。\n- **客观性**：问题陈述使用了精确、客观的数学和物理术语。没有主观或模棱两可的陈述。\n- **结论**：该问题不违反任何无效标准。它是科学上合理的、适定的、客观的且可形式化的。\n\n### 步骤 3：判定与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n刚体的姿态由针对体固角速度的矩阵微分方程控制：\n$$\n\\frac{dR(t)}{dt} = R(t) \\Omega(t)\n$$\n角速度 $\\boldsymbol{\\omega} = (12, 16, 15)$ rad/s 是恒定的。因此，其对应的反对称矩阵 $\\Omega$ 也是恒定的：\n$$\n\\Omega = \\begin{pmatrix} 0 & -15 & 16 \\\\ 15 & 0 & -12 \\\\ -16 & 12 & 0 \\end{pmatrix}\n$$\n对于恒定的 $\\Omega$，该微分方程是一个具有常系数的线性系统。在初始条件 $R(0) = I$ 下，时刻 $t$ 的解由矩阵指数给出：\n$$\nR(t) = R(0) \\exp(\\Omega t) = I \\exp(\\Omega t) = \\exp(\\Omega t)\n$$\n因此，在时间间隔 $\\Delta t$ 内的旋转矩阵为 $R(\\Delta t) = \\exp(\\Omega \\Delta t)$。\n\n为计算矩阵指数，我们使用轴-角表示法。指数的参数是矩阵 $\\Omega \\Delta t$。我们定义总旋转角 $\\theta$ 和单位旋转轴向量 $\\mathbf{k}$：\n$$\n\\theta = \\|\\boldsymbol{\\omega}\\| \\Delta t\n$$\n$$\n\\mathbf{k} = \\frac{\\boldsymbol{\\omega}}{\\|\\boldsymbol{\\omega}\\|}\n$$\n对应于单位向量 $\\mathbf{k}$ 的反对称矩阵是 $K = \\frac{\\Omega}{\\|\\boldsymbol{\\omega}\\|}$。因此，$\\Omega \\Delta t = \\theta K$。\n$\\theta K$ 的矩阵指数的闭式表达式由罗德里格旋转公式给出：\n$$\nR(\\Delta t) = \\exp(\\theta K) = I + (\\sin\\theta) K + (1 - \\cos\\theta) K^2\n$$\n这就是闭式有限旋转算子。\n\n接下来，我们构建一阶小角度线性化 $R_{\\text{lin}}(\\Delta t)$。这是通过将矩阵指数的泰勒级数展开截断到线性项得到的：\n$$\nR(\\Delta t) = \\exp(\\Omega \\Delta t) = I + \\Omega \\Delta t + \\frac{1}{2!}(\\Omega \\Delta t)^2 + \\dots\n$$\n$$\nR_{\\text{lin}}(\\Delta t) = I + \\Omega \\Delta t = I + \\theta K\n$$\n精确旋转与其线性化之间的偏差是矩阵 $\\Delta R$：\n$$\n\\Delta R = R(\\Delta t) - R_{\\text{lin}}(\\Delta t) = \\left(I + (\\sin\\theta) K + (1 - \\cos\\theta) K^2\\right) - (I + \\theta K)\n$$\n$$\n\\Delta R = (\\sin\\theta - \\theta) K + (1 - \\cos\\theta) K^2\n$$\n我们现在必须计算该矩阵的弗罗贝尼乌斯范数，$E = \\|\\Delta R\\|_F$。弗罗贝尼乌斯范数的平方是矩阵元素平方和，可以计算为 $\\Delta R^T \\Delta R$ 的迹：\n$$\nE^2 = \\|\\Delta R\\|_F^2 = \\mathrm{Tr}(\\Delta R^T \\Delta R)\n$$\n$\\Delta R$ 的转置是：\n$$\n\\Delta R^T = ((\\sin\\theta - \\theta) K + (1 - \\cos\\theta) K^2)^T = (\\sin\\theta - \\theta) K^T + (1 - \\cos\\theta) (K^2)^T\n$$\n由于 $K$ 是反对称的（$K^T = -K$）且 $K^2$ 是对称的（$(K^2)^T=K^2$），我们有：\n$$\n\\Delta R^T = -(\\sin\\theta - \\theta) K + (1 - \\cos\\theta) K^2\n$$\n我们定义标量 $a = \\sin\\theta - \\theta$ 和 $b = 1 - \\cos\\theta$。那么 $\\Delta R = aK + bK^2$ 且 $\\Delta R^T = -aK + bK^2$。\n我们计算乘积 $\\Delta R^T \\Delta R$：\n$$\n\\Delta R^T \\Delta R = (-aK + bK^2)(aK + bK^2) = -a^2 K^2 - a b K^3 + b a K^3 + b^2 K^4\n$$\n对于一个对应于单位向量的 $3 \\times 3$ 反对称矩阵 $K$，我们有恒等式 $K^3 = -K$ 和 $K^4 = -K^2$。\n$$\n\\Delta R^T \\Delta R = -a^2 K^2 - ab(-K) + ab(-K) + b^2(-K^2) = -a^2 K^2 - b^2 K^2 = -(a^2+b^2)K^2\n$$\n现在我们取迹：\n$$\nE^2 = \\mathrm{Tr}(-(a^2+b^2)K^2) = -(a^2+b^2)\\mathrm{Tr}(K^2)\n$$\n$K^2$ 的迹是一个已知属性。对于单位向量 $\\mathbf{k}=(k_x, k_y, k_z)$，\n$$\nK^2 = \\mathbf{k}\\mathbf{k}^T - I = \\begin{pmatrix} k_x^2-1 & k_x k_y & k_x k_z \\\\ k_y k_x & k_y^2-1 & k_y k_z \\\\ k_z k_x & k_z k_y & k_z^2-1 \\end{pmatrix}\n$$\n$$\n\\mathrm{Tr}(K^2) = (k_x^2-1) + (k_y^2-1) + (k_z^2-1) = (k_x^2+k_y^2+k_z^2) - 3 = \\|\\mathbf{k}\\|^2 - 3 = 1-3 = -2\n$$\n将此代回 $E^2$ 的表达式中：\n$$\nE^2 = -(a^2+b^2)(-2) = 2(a^2+b^2)\n$$\n代入 $a$ 和 $b$ 的表达式：\n$$\nE^2 = 2 \\left( (\\sin\\theta - \\theta)^2 + (1 - \\cos\\theta)^2 \\right)\n$$\n这给出了误差 $E$ 关于旋转角 $\\theta$ 的表达式：\n$$\nE(\\theta) = \\sqrt{2 \\left( (\\sin\\theta - \\theta)^2 + (1 - \\cos\\theta)^2 \\right)}\n$$\n现在，我们必须计算数值。首先，我们求出 $\\theta$：\n$$\n\\|\\boldsymbol{\\omega}\\| = \\sqrt{12^2 + 16^2 + 15^2} = \\sqrt{144 + 256 + 225} = \\sqrt{625} = 25 \\, \\text{rad/s}\n$$\n$$\n\\theta = \\|\\boldsymbol{\\omega}\\| \\Delta t = (25 \\, \\text{rad/s}) \\times (0.004 \\, \\text{s}) = 0.1 \\, \\text{rad}\n$$\n现在将 $\\theta = 0.1$ 代入 $E$ 的表达式中：\n$$\nE = \\sqrt{2 \\left( (\\sin(0.1) - 0.1)^2 + (1 - \\cos(0.1))^2 \\right)}\n$$\n使用计算器计算数值：\n$\\sin(0.1) \\approx 0.0998334166$\n$\\cos(0.1) \\approx 0.9950041653$\n$$\n\\sin(0.1) - 0.1 \\approx -0.0001665834\n$$\n$$\n1 - \\cos(0.1) \\approx 0.0049958347\n$$\n$$\nE^2 \\approx 2 \\left( (-0.0001665834)^2 + (0.0049958347)^2 \\right)\n$$\n$$\nE^2 \\approx 2 \\left( 2.775 \\times 10^{-8} + 2.495836 \\times 10^{-5} \\right)\n$$\n$$\nE^2 \\approx 2 \\left( 2.498611 \\times 10^{-5} \\right) \\approx 4.997222 \\times 10^{-5}\n$$\n$$\nE = \\sqrt{4.997222 \\times 10^{-5}} \\approx 0.007069103\n$$\n四舍五入到四位有效数字，结果是 $0.007069$。",
            "answer": "$$\n\\boxed{0.007069}\n$$"
        },
        {
            "introduction": "虽然矩阵指数为恒定角速度提供了精确解，但大多数真实世界的运动都涉及变化的角速度，这需要进行数值积分。本练习将演示为什么像前向欧拉法 (forward Euler method) 这样的朴素积分方法会失败，导致旋转矩阵失去其基本的几何特性 。您将实现并比较这种有缺陷的方法与几何上一致的方法，后者能确保方向始终保持在 $SO(3)$ 流形上，这是稳健的生物力学仿真的基石。",
            "id": "4153654",
            "problem": "在生物力学中，一个刚体节段在三维空间中旋转。其方向由一个旋转矩阵 $R(t)\\in \\mathbb{R}^{3\\times 3}$ 表示，其中 $R(t)\\in \\text{Special Orthogonal Group (SO(3))}$（特殊正交群），意味着 $R(t)^{\\top}R(t)=I$ 且 $\\det(R(t))=1$。角速度是一个向量 $\\omega(t)\\in\\mathbb{R}^3$，单位为弧度/秒。刚体方向的基本运动学关系表明，旋转矩阵的时间导数满足 $ \\dot{R}(t) = R(t)[\\omega(t)]_{\\times}$，其中 $[\\omega]_{\\times}$ 是斜对称叉乘矩阵，对于任意 $v\\in\\mathbb{R}^3$ 满足 $[\\omega]_{\\times}v = \\omega\\times v$。\n\n您将分析对该运动学方程进行朴素前向积分的后果，并设计能够保持 $R\\in \\text{SO(3)}$ 的数值方案。\n\n任务：\n\n1. 严格从基本运动学关系 $ \\dot{R} = R[\\omega]_{\\times}$ 出发，考虑一个大小为 $\\Delta t>0$ 的离散时间步和前向欧拉更新 $ R_{k+1} \\approx R_k + R_k[\\omega_k]_{\\times}\\Delta t$。证明即使在 $R_k^{\\top}R_k=I$ 和 $[\\omega_k]_{\\times}^{\\top} = -[\\omega_k]_{\\times}$ 的条件下，此更新通常也会破坏正交性。明确地证明，在 $\\Delta t$ 的主非平凡阶上，$R_{k+1}^{\\top}R_{k+1} \\neq I$ 且偏差与 $\\Delta t^2$ 成比例。\n\n2. 构建一个在数学上合理的到 $\\text{SO(3)}$ 上的回缩（retraction），该回缩可在前向欧拉步之后应用。您的回缩必须由一个良置且单位一致的操作定义，该操作将一个通用的 $3\\times 3$ 矩阵 $M$ 映射到弗罗贝尼乌斯范数（Frobenius norm）下最接近的 $R\\in \\text{SO(3)}$。您可以引用一个产生正交因子的规范分解，然后强制 $\\det(R)=1$。请使用标准的线性代数运算明确指定该映射，确保最终的 $R$ 满足 $R^{\\top}R=I$ 和 $\\det(R)=1$。\n\n3. 从 $ \\dot{R} = R[\\omega]_{\\times}$ 推导出一个保证 $R_{k+1}\\in \\text{SO(3)}$ 的积分更新（对于任意 $\\Delta t$），方法是使用斜对称生成元的矩阵指数。通过引用矩阵指数应用于斜对称矩阵的性质，证明为什么此更新对于所有步长都能保持正交性和单位行列式。\n\n4. 实现一个程序，对于一组恒定角速度的测试用例，使用三种方法从 $ R_0 = I$ 开始积分方向：\n   - 方法 A：无任何校正的朴素欧拉积分，\n   - 方法 B：欧拉积分后每步进行到 $\\text{SO(3)}$ 上的回缩，\n   - 方法 C：从连续时间运动学推导出的指数映射更新。\n\n对于每个测试用例，在 $N$ 步之后，为每种方法计算两个标量诊断指标：\n   - 正交性偏差 $ \\| R^{\\top}R - I\\|_F$，其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数，\n   - 绝对行列式偏差 $ |\\det(R) - 1|$。\n\n角速度以弧度/秒表示，时间步以秒表示。角度必须以弧度为单位。输出为无单位的浮点数。为了报告的数值稳定性，请将每个诊断指标四舍五入到 $10$ 位小数。\n\n测试套件：\n\n- 情况 1（正常路径）：$\\omega = [0.5,\\,0.1,\\,-0.2]$ rad/s，$\\Delta t = 0.01$ s，$N = 100$。\n- 情况 2（边界：零运动）：$\\omega = [0,\\,0,\\,0]$ rad/s，$\\Delta t = 0.05$ s，$N = 10$。\n- 情况 3（边缘：每步大旋转）：$\\omega = [30.0,\\,0.0,\\,0.0]$ rad/s，$\\Delta t = 0.1$ s，$N = 5$。\n- 情况 4（边缘：小步长，高转速）：$\\omega = [10.0,\\,10.0,\\,10.0]$ rad/s，$\\Delta t = 0.001$ s，$N = 1000$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，并用方括号括起来。对于每个测试用例，输出一个包含六个浮点数的列表，顺序为\n$[\\text{A\\_orth},\\,\\text{A\\_det},\\,\\text{B\\_orth},\\,\\text{B\\_det},\\,\\text{C\\_orth},\\,\\text{C\\_det}]$，\n其中 $\\text{A\\_orth}$ 是方法A的正交性偏差，$\\text{A\\_det}$ 是方法A的行列式偏差，方法B和C依此类推。\n\n所需最终输出形状示例（此处的值为占位符）：\n$[[a_1,a_2,b_1,b_2,c_1,c_2],[a_1',a_2',b_1',b_2',c_1',c_2'],[...]]$。\n\n您的实现必须是一个完整的、可运行的程序，仅使用指定的运行时环境和库。",
            "solution": "该问题探讨了刚体方向的数值积分，这是从机器人学、航空航天工程到生物力学等领域的一项基本任务。方向由一个属于特殊正交群 $\\text{SO(3)}$ 的旋转矩阵 $R(t)$ 表示。这个群是一个可微流形（differentiable manifold），而不是一个向量空间，这意味着像前向欧拉法这样为欧几里得空间设计的标准数值积分方案，若不加修改通常不适用。这种朴素的方法无法保持 $\\text{SO(3)}$ 的定义属性，即正交性（$R^{\\top}R=I$）和单位行列式（$\\det(R)=1$），从而导致物理上无意义的误差累积。本分析验证并比较了三种数值方法：朴素前向欧拉法、使用到 $\\text{SO(3)}$ 上的投影（回缩）的修正欧拉法，以及使用矩阵指数的几何内蕴方法。\n\n### 任务 1：前向欧拉法分析\n\n基本运动学方程由 $\\dot{R}(t) = R(t)[\\omega(t)]_{\\times}$ 给出，其中 $R(t) \\in \\text{SO(3)}$，$\\omega(t) \\in \\mathbb{R}^3$ 是角速度，$[\\omega]_{\\times}$ 是叉乘算子的斜对称矩阵表示。\n\n从时间 $t_k$到 $t_{k+1} = t_k + \\Delta t$ 的离散时间前向欧拉更新公式为：\n$$\nR_{k+1} = R_k + \\dot{R}_k \\Delta t = R_k + R_k[\\omega_k]_{\\times}\\Delta t\n$$\n提出 $R_k$ 因子可得：\n$$\nR_{k+1} = R_k(I + [\\omega_k]_{\\times}\\Delta t)\n$$\n其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n\n为了研究此更新是否保持正交性，我们分析乘积 $R_{k+1}^{\\top}R_{k+1}$。我们假设在步长开始时的矩阵 $R_k$ 是完全正交的，即 $R_k \\in \\text{SO(3)}$，因此 $R_k^{\\top}R_k = I$。\n\n$$\nR_{k+1}^{\\top}R_{k+1} = \\left[R_k(I + [\\omega_k]_{\\times}\\Delta t)\\right]^{\\top} \\left[R_k(I + [\\omega_k]_{\\times}\\Delta t)\\right]\n$$\n使用属性 $(AB)^{\\top} = B^{\\top}A^{\\top}$：\n$$\nR_{k+1}^{\\top}R_{k+1} = (I + [\\omega_k]_{\\times}\\Delta t)^{\\top} R_k^{\\top}R_k (I + [\\omega_k]_{\\times}\\Delta t)\n$$\n代入 $R_k^{\\top}R_k = I$ 并使用斜对称属性 $[\\omega_k]_{\\times}^{\\top} = -[\\omega_k]_{\\times}$：\n$$\nR_{k+1}^{\\top}R_{k+1} = (I^{\\top} + ([\\omega_k]_{\\times}\\Delta t)^{\\top}) (I + [\\omega_k]_{\\times}\\Delta t) = (I - [\\omega_k]_{\\times}\\Delta t) (I + [\\omega_k]_{\\times}\\Delta t)\n$$\n展开乘积：\n$$\nR_{k+1}^{\\top}R_{k+1} = I^2 + I[\\omega_k]_{\\times}\\Delta t - [\\omega_k]_{\\times}\\Delta t I - ([\\omega_k]_{\\times}\\Delta t)([\\omega_k]_{\\times}\\Delta t)\n$$\n$$\nR_{k+1}^{\\top}R_{k+1} = I - [\\omega_k]_{\\times}^2 \\Delta t^2\n$$\n结果矩阵 $R_{k+1}$ 是正交的当且仅当 $R_{k+1}^{\\top}R_{k+1} = I$。这要求 $[\\omega_k]_{\\times}^2 \\Delta t^2 = 0$。由于 $\\Delta t > 0$，这只在 $[\\omega_k]_{\\times}=0$ 时成立，这对应于零角速度 $\\omega_k=0$。对于任何非零旋转，$[\\omega_k]_{\\times} \\neq 0$，因此 $[\\omega_k]_{\\times}^2 \\neq 0$。所以，前向欧拉更新通常会破坏正交性条件。\n\n与正交性的偏差是矩阵 $R_{k+1}^{\\top}R_{k+1} - I = -[\\omega_k]_{\\times}^2 \\Delta t^2$。这个偏差是 $\\mathcal{O}(\\Delta t^2)$ 阶的，表明满足正交性约束的误差与步长的平方成正比。证明完毕。\n\n### 任务 2：到 SO(3) 上的回缩\n\n在执行前向欧拉步 $R_{k+1}^{\\text{Euler}} = R_k(I + [\\omega_k]_{\\times}\\Delta t)$ 后，结果是一个通常不在 $\\text{SO(3)}$ 中的矩阵 $M = R_{k+1}^{\\text{Euler}}$。回缩是一个将 $M$ 投影回 $\\text{SO(3)}$ 流形上的映射。我们寻求在弗罗贝尼乌斯范数下最接近 $M$ 的矩阵 $R \\in \\text{SO(3)}$，即最小化 $\\|R - M\\|_F$。\n\n这是一个经典的正交 Procrustes 问题。其解通过对 $M$ 进行奇异值分解（SVD）获得。设 $M$ 的 SVD 为：\n$$\nM = U\\Sigma V^{\\top}\n$$\n其中 $U, V \\in \\mathbb{R}^{3\\times3}$ 是正交矩阵（$U^{\\top}U = I$, $V^{\\top}V = I$），$\\Sigma$ 是包含 $M$ 的奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$ 的对角矩阵。\n\n与 $M$ 最接近的正交矩阵是 $R_{ortho} = UV^{\\top}$。然而，这个矩阵的行列式可能为 $-1$，这将使其属于正交群 $\\text{O(3)}$ 但不属于特殊正交群 $\\text{SO(3)}$。我们必须强制 $\\det(R)=1$。\n\n在 $R \\in \\text{SO(3)}$ 的约束下，最大化 $\\text{tr}(R^{\\top}M)$ 的解由下式给出：\n$$\nR = U S V^{\\top}\n$$\n其中 $S$ 是一个对角矩阵，定义为 $S = \\text{diag}(1, 1, \\det(UV^{\\top}))$。\n\n让我们验证所得矩阵 $R$ 的性质：\n1.  **正交性**：我们必须检查是否 $R^{\\top}R = I$。\n    矩阵 $S$ 是对角矩阵，其对角元素为 $1$ 或 $-1$（因为 $\\det(U), \\det(V) \\in \\{-1, 1\\}$，所以 $\\det(UV^{\\top}) \\in \\{-1, 1\\}$）。因此，$S^{\\top}S = S^2 = \\text{diag}(1^2, 1^2, (\\det(UV^{\\top}))^2) = I$。\n    $$\n    R^{\\top}R = (USV^{\\top})^{\\top}(USV^{\\top}) = V S^{\\top} U^{\\top} U S V^{\\top} = V S^{\\top} I S V^{\\top} = V S^2 V^{\\top} = V I V^{\\top} = I\n    $$\n    正交性成功恢复。\n\n2.  **单位行列式**：我们必须检查是否 $\\det(R) = 1$。\n    使用属性 $\\det(ABC) = \\det(A)\\det(B)\\det(C)$:\n    $$\n    \\det(R) = \\det(U) \\det(S) \\det(V^{\\top}) = \\det(U) \\det(\\text{diag}(1, 1, \\det(UV^{\\top}))) \\det(V)\n    $$\n    $$\n    \\det(R) = \\det(U) (\\det(UV^{\\top})) \\det(V) = (\\det(U)\\det(V)) \\det(UV^{\\top}) = \\det(UV^{\\top}) \\det(UV^{\\top}) = (\\det(UV^{\\top}))^2 = 1\n    $$\n    行列式保证为 $1$。\n\n此过程定义了一个从通用 $3 \\times 3$ 矩阵到 $\\text{SO(3)}$ 的有效回缩映射。步骤如下：\n1. 计算 $M = R_k + R_k[\\omega_k]_{\\times}\\Delta t$。\n2. 计算 $M = U\\Sigma V^{\\top}$ 的 SVD。\n3. 构建 $R = U \\text{diag}(1, 1, \\det(UV^{\\top})) V^{\\top}$。\n\n### 任务 3：指数映射更新\n\n一种更符合原理的方法是直接求解微分方程 $\\dot{R} = R[\\omega]_{\\times}$。如果我们假设角速度 $\\omega$ 在时间步 $\\Delta t$ 内是恒定的，即对于 $t \\in [t_k, t_{k+1}]$ 有 $\\omega(t) = \\omega_k$，则该方程变成一个具有常系数矩阵的线性常微分方程。其解由矩阵指数给出：\n$$\nR(t) = R(t_k) \\exp([\\omega_k]_{\\times}(t-t_k))\n$$\n设 $t = t_{k+1} = t_k + \\Delta t$，我们得到更新规则：\n$$\nR_{k+1} = R_k \\exp([\\omega_k]_{\\times}\\Delta t)\n$$\n此更新保证了 $\\text{SO(3)}$ 结构的保持。令 $A = [\\omega_k]_{\\times}\\Delta t$。由于 $[\\omega_k]_{\\times}$ 是斜对称的，矩阵 $A$ 也是斜对称的。我们需要证明如果 $R_k \\in \\text{SO(3)}$，则 $R_{k+1} \\in \\text{SO(3)}$。这需要证明更新矩阵 $\\Delta R_k = \\exp(A)$ 属于 $\\text{SO(3)}$。\n\n1.  **正交性**：矩阵指数的一个关键性质是，如果矩阵 $A$ 是斜对称的（$A^{\\top} = -A$），那么它的指数 $\\exp(A)$ 是一个正交矩阵。\n    **证明**：$(\\exp(A))^{\\top} = \\exp(A^{\\top}) = \\exp(-A)$。由于 $A$ 和 $-A$ 可交换，$\\exp(A)\\exp(-A) = \\exp(A-A) = \\exp(0) = I$。因此，$(\\exp(A))^{\\top}\\exp(A) = I$。矩阵 $\\exp(A)$ 是正交的。\n    所以，$R_{k+1}^{\\top}R_{k+1} = (R_k \\exp(A))^{\\top}(R_k \\exp(A)) = (\\exp(A))^{\\top}R_k^{\\top}R_k\\exp(A) = (\\exp(A))^{\\top}I\\exp(A) = I$。对于任何 $\\Delta t$，正交性都得以保持。\n\n2.  **单位行列式**：另一个称为雅可比公式（Jacobi's formula）的性质指出 $\\det(\\exp(A)) = \\exp(\\text{tr}(A))$，其中 $\\text{tr}(A)$ 是矩阵 $A$ 的迹。\n    对于任何斜对称矩阵，其所有对角元素必须为零。因此，$\\text{tr}(A) = \\text{tr}([\\omega_k]_{\\times}\\Delta t) = 0$。\n    所以，$\\det(\\exp(A)) = \\exp(0) = 1$。\n    更新后矩阵的行列式为 $\\det(R_{k+1}) = \\det(R_k \\exp(A)) = \\det(R_k)\\det(\\exp(A))$。假设 $\\det(R_k) = 1$，我们得到 $\\det(R_{k+1}) = 1 \\cdot 1 = 1$。\n\n指数映射更新内在地尊重 $\\text{SO(3)}$ 的几何结构，并为积分步内角速度恒定的情况提供了精确解。\n\n### 任务 4：实现策略\n三种方法将按如下方式实现：\n- **方法 A（朴素欧拉法）**：更新 $R_{k+1} = R_k(I + [\\omega_k]_{\\times}\\Delta t)$ 共 $N$ 步。\n- **方法 B（带回缩的欧拉法）**：对于每一步，计算朴素欧拉更新 $M = R_k(I + [\\omega_k]_{\\times}\\Delta t)$，然后使用任务2中推导的基于SVD的回缩将 $M$ 投影回 $\\text{SO(3)}$ 以得到 $R_{k+1}$。\n- **方法 C（指数映射）**：更新 $R_{k+1} = R_k \\exp([\\omega_k]_{\\times}\\Delta t)$ 共 $N$ 步，使用库函数计算矩阵指数。\n\n对于每种方法，最终的矩阵 $R_N$ 将被诊断其正交性偏差 $\\|R_N^{\\top}R_N - I\\|_F$ 和行列式偏差 $|\\det(R_N) - 1|$。这些诊断指标量化了每种方法在保持 $\\text{SO(3)}$ 群属性方面的失败或成功程度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the rigid body kinematics problem by comparing three numerical\n    integration methods for a set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path\n        {'omega': np.array([0.5, 0.1, -0.2]), 'dt': 0.01, 'N': 100},\n        # Case 2: boundary: zero motion\n        {'omega': np.array([0.0, 0.0, 0.0]), 'dt': 0.05, 'N': 10},\n        # Case 3: edge: large rotation per step\n        {'omega': np.array([30.0, 0.0, 0.0]), 'dt': 0.1, 'N': 5},\n        # Case 4: edge: small step, high rate\n        {'omega': np.array([10.0, 10.0, 10.0]), 'dt': 0.001, 'N': 1000},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        omega = case['omega']\n        dt = case['dt']\n        N = case['N']\n        \n        case_results = []\n\n        # --- Method A: Naive Euler ---\n        R_A = np.identity(3)\n        omega_skew = np.array([\n            [0, -omega[2], omega[1]],\n            [omega[2], 0, -omega[0]],\n            [-omega[1], omega[0], 0]\n        ])\n        for _ in range(N):\n            R_A = R_A @ (np.identity(3) + omega_skew * dt)\n        \n        ortho_dev_A = np.linalg.norm(R_A.T @ R_A - np.identity(3), 'fro')\n        det_dev_A = abs(np.linalg.det(R_A) - 1.0)\n        case_results.extend([round(ortho_dev_A, 10), round(det_dev_A, 10)])\n        \n        # --- Method B: Euler with Retraction ---\n        R_B = np.identity(3)\n        # omega_skew is the same as in Method A\n        for _ in range(N):\n            # Naive Euler step\n            M = R_B @ (np.identity(3) + omega_skew * dt)\n            \n            # Retraction using SVD\n            U, _, Vt = np.linalg.svd(M)\n            # Ensure proper rotation by fixing determinant\n            det_UVt = np.linalg.det(U @ Vt)\n            S = np.diag([1, 1, det_UVt])\n            R_B = U @ S @ Vt\n\n        ortho_dev_B = np.linalg.norm(R_B.T @ R_B - np.identity(3), 'fro')\n        det_dev_B = abs(np.linalg.det(R_B) - 1.0)\n        case_results.extend([round(ortho_dev_B, 10), round(det_dev_B, 10)])\n\n        # --- Method C: Exponential Map ---\n        R_C = np.identity(3)\n        # omega_skew is the same as in Method A\n        Delta_R = expm(omega_skew * dt)\n        for _ in range(N):\n            R_C = R_C @ Delta_R\n            \n        ortho_dev_C = np.linalg.norm(R_C.T @ R_C - np.identity(3), 'fro')\n        det_dev_C = abs(np.linalg.det(R_C) - 1.0)\n        case_results.extend([round(ortho_dev_C, 10), round(det_dev_C, 10)])\n\n        all_results.append(case_results)\n\n    # Format output as a list of lists string representation\n    # e.g., [[1, 2], [3, 4]] -> \"[[1, 2],[3, 4]]\"\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}