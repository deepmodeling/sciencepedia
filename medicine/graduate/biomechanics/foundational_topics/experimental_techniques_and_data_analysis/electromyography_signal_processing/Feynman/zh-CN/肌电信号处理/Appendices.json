{
    "hands_on_practices": [
        {
            "introduction": "肌电图（EMG）包络线的提取是生物力学分析中的一个基本步骤，但滤波器的选择不应是随意的。本练习旨在将信号处理决策与生理学模型联系起来，通过将肌肉激活过程建模为一阶动态系统，来推导出一个合理的截止频率选择标准 。掌握这一原理有助于确保处理后的EMG信号能够真实地反映肌肉的激活-收缩动态特性，而不仅仅是原始信号的平滑版本。",
            "id": "4170082",
            "problem": "一个实验室正在处理表面肌电（EMG）信号，以估计用于逆动力学分析的肌腱激活度。该 EMG 通道经过带通滤波以去除运动伪影，然后进行全波整流以获得非负信号，最后再进行低通滤波以生成旨在近似肌腱激活度的包络。研究人员将肌腱激活动力学建模为一个线性时不变一阶系统，其中激活度 $a(t)$ 由有效神经输入 $u(t)$ 驱动，遵循以下常微分方程\n\n$$\n\\tau \\,\\frac{da(t)}{dt} + a(t) = u(t),\n$$\n\n其中时间常数 $\\tau > 0$。目标是选择包络低通滤波器的截止频率 $f_c$，使得该包络滤波器能够再现从 $u(t)$ 到 $a(t)$ 的主导动力学特性，从而最小化动态失配（包括对阶跃信号的瞬态响应和稳态正弦信号的跟踪），同时避免不必要地衰减具有物理意义的低频内容。在此建模假设下，选择 $f_c$ 的哪个标准最为合适？\n\nA. 选择 $f_c$ 使得 $2\\pi f_c \\tau = 1$，以匹配一阶激活动力学的 $-3\\,\\mathrm{dB}$ 角点频率。\n\nB. 选择 $f_c = 1/\\tau$，因为在时间 $\\tau$ 时，激活度达到其稳态值的 $63\\%$。\n\nC. 选择 $f_c = \\tau$，使得截止频率等于生理时间常数。\n\nD. 选择一个较高的 $f_c$（例如 $f_c \\approx 20\\text{–}50\\,\\mathrm{Hz}$），以捕捉运动单元放电率，并避免平滑掉整流后的 EMG 峰值。\n\nE. 选择 $f_c$ 使得 $2\\pi f_c \\tau = 1/\\sqrt{2}$，将截止频率对准 $-3\\,\\mathrm{dB}$ 的幅值水平。",
            "solution": "问题要求为一个用于创建 EMG 包络的低通滤波器选择一个截止频率 $f_c$。这个包络旨在近似肌腱激活度 $a(t)$。该过程基于一个模型，其中激活动力学由一个一阶线性时不变 (LTI) 系统控制，该系统将激活度 $a(t)$ 与有效神经输入 $u(t)$ 联系起来。目标是让信号处理链——特别是最后的低通滤波阶段——模仿该生理模型的动力学特性。\n\n肌腱激活的生理模型由以下常微分方程 (ODE) 给出：\n$$\n\\tau \\,\\frac{da(t)}{dt} + a(t) = u(t)\n$$\n其中 $\\tau > 0$ 是激活时间常数。为了在频域中分析该系统的动态特性，我们推导其传递函数 $H_{phys}(s)$，该函数将输出的拉普拉斯变换 $A(s) = \\mathcal{L}\\{a(t)\\}$ 与输入的拉普拉斯变换 $U(s) = \\mathcal{L}\\{u(t)\\}$ 联系起来。\n\n对该 ODE 进行拉普拉斯变换，并假设初始条件为零 ($a(0)=0$)，我们得到：\n$$\n\\tau \\, sA(s) + A(s) = U(s)\n$$\n$$\nA(s) (\\tau s + 1) = U(s)\n$$\n因此，该生理系统的传递函数为：\n$$\nH_{phys}(s) = \\frac{A(s)}{U(s)} = \\frac{1}{\\tau s + 1}\n$$\n这是一个一阶低通滤波器的传递函数。\n\n问题陈述，经过处理（带通滤波和整流）的 EMG 信号被低通滤波以创建一个近似 $a(t)$ 的包络。整流后的 EMG 信号可作为神经输入 $u(t)$ 的代理。为了使生成的包络成为 $a(t)$ 的忠实表示，信号处理流程中使用的低通滤波器（我们称其传递函数为 $H_{filter}(s)$）理想情况下应与生理系统的传递函数 $H_{phys}(s)$ 相同。\n\n低通滤波器的主要动态特性是其截止频率。截止频率的标准定义，也称为角点频率或 $-3\\,\\mathrm{dB}$ 频率，是指滤波器幅度响应降至其直流增益 $1/\\sqrt{2}$ 倍时的频率。\n\n让我们来求生理模型的截止频率。通过代入 $s = j\\omega$ 得到频率响应，其中 $\\omega = 2\\pi f$ 是角频率：\n$$\nH_{phys}(j\\omega) = \\frac{1}{j\\omega\\tau + 1}\n$$\n频率响应的幅度为：\n$$\n|H_{phys}(j\\omega)| = \\left| \\frac{1}{1 + j\\omega\\tau} \\right| = \\frac{1}{|1 + j\\omega\\tau|} = \\frac{1}{\\sqrt{1^2 + (\\omega\\tau)^2}} = \\frac{1}{\\sqrt{1 + (\\omega\\tau)^2}}\n$$\n直流增益（在 $\\omega=0$ 时）为 $|H_{phys}(j0)| = 1$。我们要求解截止角频率 $\\omega_c$，在该频率下，幅度减小到 $1/\\sqrt{2}$ 倍：\n$$\n|H_{phys}(j\\omega_c)| = \\frac{1}{\\sqrt{2}}\n$$\n$$\n\\frac{1}{\\sqrt{1 + (\\omega_c\\tau)^2}} = \\frac{1}{\\sqrt{2}}\n$$\n两边平方，得到：\n$$\n\\frac{1}{1 + (\\omega_c\\tau)^2} = \\frac{1}{2}\n$$\n$$\n1 + (\\omega_c\\tau)^2 = 2\n$$\n$$\n(\\omega_c\\tau)^2 = 1\n$$\n由于 $\\omega_c$ 和 $\\tau$ 均为正值，我们取正根：\n$$\n\\omega_c\\tau = 1 \\implies \\omega_c = \\frac{1}{\\tau}\n$$\n截止频率 $f_c$ 与截止角频率 $\\omega_c$ 的关系为 $\\omega_c = 2\\pi f_c$。因此，包络滤波器的截止频率应选择为：\n$$\n2\\pi f_c = \\frac{1}{\\tau} \\implies f_c = \\frac{1}{2\\pi\\tau}\n$$\n这个关系可以重写为 $2\\pi f_c \\tau = 1$。这个标准确保了包络滤波器与建模的生理激活动力学具有相同的带宽，从而实现了所需的动态匹配。\n\n现在，我们来评估每个选项：\n\n**A. 选择 $f_c$ 使得 $2\\pi f_c \\tau = 1$，以匹配一阶激活动力学的 $-3\\,\\mathrm{dB}$ 角点频率。**\n这个陈述与我们的推导完全一致。条件 $2\\pi f_c \\tau = 1$ 正是将处理滤波器的截止频率 $f_c$ 与时间常数为 $\\tau$ 的一阶生理模型的 $-3\\,\\mathrm{dB}$ 角点频率等同起来的条件。这个选择确保了滤波器能最佳地再现激活模型的主导动力学特性。\n**结论：正确。**\n\n**B. 选择 $f_c = 1/\\tau$，因为在时间 $\\tau$ 时，激活度达到其稳态值的 $63\\%$。**\n关于阶跃响应的陈述是正确的。对于阶跃输入，解为 $a(t) \\propto (1 - e^{-t/\\tau})$。在 $t=\\tau$ 时，响应为 $(1-e^{-1}) \\approx 0.632$，即最终值的 $63.2\\%$。然而，提议的标准是 $f_c = 1/\\tau$。这意味着截止角频率为 $\\omega_c = 2\\pi f_c = 2\\pi/\\tau$。这是不正确的。正确的截止角频率是 $\\omega_c = 1/\\tau$。这个选项混淆了以赫兹为单位的截止频率 ($f_c$) 和以弧度/秒为单位的截止角频率 ($\\omega_c = 1/\\tau$)。\n**结论：不正确。**\n\n**C. 选择 $f_c = \\tau$，使得截止频率等于生理时间常数。**\n这个选项将单位为逆时间（$\\mathrm{s}^{-1}$ 或 $\\mathrm{Hz}$）的频率 $f_c$ 与单位为时间（$\\mathrm{s}$）的时间常数 $\\tau$ 等同起来。这在量纲上是不一致的，因此是根本错误的。\n**结论：不正确。**\n\n**D. 选择一个较高的 $f_c$（例如 $f_c \\approx 20\\text{–}50\\,\\mathrm{Hz}$），以捕捉运动单元放电率，并避免平滑掉整流后的 EMG 峰值。**\n目标是估计激活度 $a(t)$，而不是神经输入 $u(t)$。该模型明确地将从 $u(t)$ 到 $a(t)$ 的过程定义为一个低通滤波作用，这在生理上代表了肌肉收缩中的电化学和机械延迟。整流后 EMG 的高频内容（代表作为 $u(t)$ 一部分的运动单元动作电位序列）理应被平滑掉，以估计慢得多的激活-收缩动力学。选择一个高的截止频率将在很大程度上绕过这个关键的滤波步骤，导致估计值比真实的生理激活 $a(t)$ 快得多且噪声更大，从而无法达到核心目标。对于一个典型的肌肉激活时间常数，例如 $\\tau=60\\,\\mathrm{ms} = 0.06\\,\\mathrm{s}$，合适的截止频率应为 $f_c = 1/(2\\pi \\cdot 0.06) \\approx 2.65\\,\\mathrm{Hz}$，这远低于 $20\\text{–}50\\,\\mathrm{Hz}$ 的范围。\n**结论：不正确。**\n\n**E. 选择 $f_c$ 使得 $2\\pi f_c \\tau = 1/\\sqrt{2}$，将截止频率对准 $-3\\,\\mathrm{dB}$ 的幅值水平。**\n这个选项正确地将 $-3\\,\\mathrm{dB}$ 点与 $1/\\sqrt{2}$（约 $0.707$）的幅值比联系起来。然而，它为这一点给出了一个不正确的数学条件。如前所推导，传递函数的幅度为 $|H(j\\omega)| = 1/\\sqrt{1 + (\\omega\\tau)^2}$。让我们测试给定的条件：$\\omega\\tau = 2\\pi f_c \\tau = 1/\\sqrt{2}$。在此频率下的幅度将是 $|H| = 1/\\sqrt{1 + (1/\\sqrt{2})^2} = 1/\\sqrt{1+1/2} = 1/\\sqrt{3/2} = \\sqrt{2/3} \\approx 0.816$。这个幅值比对应的电平为 $20\\log_{10}(\\sqrt{2/3}) \\approx -1.76\\,\\mathrm{dB}$，而不是 $-3\\,\\mathrm{dB}$。$-3\\,\\mathrm{dB}$ 点的正确条件是 $\\omega\\tau = 1$。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "滤波在提取EMG包络线时不可避免，但它也可能引入不希望的相位延迟，导致肌肉起止时间等关键事件的判断失准。本练习探讨了不同类型的数字滤波器（IIR与FIR）及其相位特性，并阐明了为何前向-后向滤波（零相位滤波）是避免时域失真的标准做法 。通过这个练习，你将深入理解相位响应对生物力学分析中时间精度（temporal fidelity）的决定性影响。",
            "id": "4170148",
            "problem": "一个生物力学实验室研究肌电图（EMG）信号，并通过全波整流后进行低通滤波来计算EMG包络，以抑制载波波动并保留运动单元募集动态。考虑对以采样率 $f_s$ 采样的整流后EMG进行离散时间线性时不变（LTI）滤波以形成包络，并通过在滤波后的包络上进行阈值交叉来检测起点。实践中使用了两类滤波器：无限脉冲响应（IIR）低通设计（例如，Butterworth）和具有对称系数的有限脉冲响应（FIR）低通设计。该实验室正在考虑四种用于包络阶段的实现方案：(i) 单程因果 IIR，(ii) 单程因果线性相位 FIR，(iii) IIR 的前向-后向应用，以及 (iv) FIR 的前向-后向应用。在前向-后向滤波中，信号先按时间正向滤波，然后由同一滤波器按时间反向滤波，产生一种通常称为零相位滤波的非因果操作。\n\n仅使用 LTI 系统的基本定义——即离散时间频率响应 $H(e^{j\\omega})$、其相位 $\\phi(\\omega) = \\arg H(e^{j\\omega})$、群延迟 $\\tau_g(\\omega) = -\\frac{d\\phi(\\omega)}{d\\omega}$，以及线性相位 FIR 滤波器的脉冲响应对称条件——来推断相位响应和起点时间偏差。选择所有正确的陈述。\n\nA. 具有实系数的因果 IIR 低通滤波器通常具有非线性相位，因此 $\\tau_g(\\omega)$ 依赖于 $\\omega$；前向-后向应用会抵消相位，因为净频率响应为 $H(e^{j\\omega})H(e^{-j\\omega})$，其净相位为零，幅度等于 $\\lvert H(e^{j\\omega}) \\rvert^2$，从而消除了由相位延迟引起的起点时间偏差。\n\nB. 对称 FIR 低通滤波器对所有 $\\omega$ 的群延迟均为零，因此单程因果应用不会改变 EMG 的起点时间。\n\nC. 对线性相位 FIR 应用前向-后向滤波会产生一个非因果的零相位滤波器，其幅频响应等于原始幅频响应，而不是其平方。\n\nD. 对于任何稳定的因果低通滤波器，群延迟是恒定的，且等于滤波器阶数的一半，因此起点时间偏差与频率内容无关。\n\nE. 在使用长度为 $N$ 个样本、采样率为 $f_s$ 的单程因果线性相位 FIR 进行基于阈值的起点检测时，相对于应用于相同滤波的非因果零相位版本的相同检测，检测到的起点时间会偏移一个恒定量 $\\Delta t = \\frac{N-1}{2 f_s}$，这与包络的波形形状无关，因为线性相位意味着除了幅度整形之外，还有一个纯粹的恒定延迟。\n\n选择所有适用的选项。",
            "solution": "该问题陈述已被验证，并被认为是科学上合理的、提法得当且客观的。它为生物力学中用于EMG信号分析的数字信号处理技术提供了正确和标准的描述。我们可以开始评估给定的陈述。\n\n分析将基于离散时间线性时不变（LTI）系统的基本原理。设一个 LTI 滤波器由其脉冲响应 $h[n]$ 和其离散时间傅里叶变换（DTFT），即频率响应 $H(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h[n]e^{-j\\omega n}$ 来表征。频率响应可以写成极坐标形式 $H(e^{j\\omega}) = \\lvert H(e^{j\\omega}) \\rvert e^{j\\phi(\\omega)}$，其中 $\\lvert H(e^{j\\omega}) \\rvert$ 是幅频响应，$\\phi(\\omega) = \\arg H(e^{j\\omega})$ 是相频响应。群延迟定义为 $\\tau_g(\\omega) = -\\frac{d\\phi(\\omega)}{d\\omega}$，表示以 $\\omega$ 为中心的窄频带所经历的延迟。\n\n对于任何具有实值脉冲响应 $h[n]$ 的滤波器，其频率响应表现出共轭对称性：$H(e^{j\\omega}) = H^*(e^{-j\\omega})$。这意味着幅频响应是偶函数，$\\lvert H(e^{j\\omega}) \\rvert = \\lvert H(e^{-j\\omega}) \\rvert$，相频响应是奇函数，$\\phi(\\omega) = -\\phi(-\\omega)$。\n\n前向-后向滤波包括一个前向过程，然后是使用同一滤波器 $h[n]$ 的时间反转的后向过程。如果输入是 $x[n]$，前向过程的输出是 $y_f[n] = x[n]*h[n]$。在频域中，$Y_f(e^{j\\omega}) = X(e^{j\\omega})H(e^{j\\omega})$。后向过程对时间反转的信号 $y_f[-n]$进行滤波。最终输出 $y_{fb}[n]$ 的频域表示为 $Y_{fb}(e^{j\\omega}) = X(e^{j\\omega}) H_{fb}(e^{j\\omega})$，其中等效频率响应为 $H_{fb}(e^{j\\omega}) = H(e^{j\\omega})H(e^{-j\\omega})$。对于具有实数 $h[n]$ 的滤波器，这变为 $H_{fb}(e^{j\\omega}) = H(e^{j\\omega})H^*(e^{j\\omega}) = \\lvert H(e^{j\\omega}) \\rvert^2$。此响应是纯实数且非负的，意味着它在所有频率上的相位均为零（$\\phi_{fb}(\\omega) = 0$）。\n\n现在，我们来评估每个陈述。\n\n**A. 具有实系数的因果 IIR 低通滤波器通常具有非线性相位，因此 $\\tau_g(\\omega)$ 依赖于 $\\omega$；前向-后向应用会抵消相位，因为净频率响应为 $H(e^{j\\omega})H(e^{-j\\omega})$，其净相位为零，幅度等于 $\\lvert H(e^{j\\omega}) \\rvert^2$，从而消除了由相位延迟引起的起点时间偏差。**\n\n- 稳定的因果 IIR 滤波器（具有实系数）不能具有精确的线性相位。其有理传递函数结构中，极点不在原点或无穷远处，这导致了非线性相频响应 $\\phi(\\omega)$。因此，群延迟 $\\tau_g(\\omega) = -\\frac{d\\phi(\\omega)}{d\\omega}$ 是频率 $\\omega$ 的函数。这会导致相位失真或色散，即信号的不同频率分量被延迟了不同的量。\n- 如上所述，前向-后向滤波产生的等效频率响应为 $H_{fb}(e^{j\\omega}) = H(e^{j\\omega})H(e^{-j\\omega})$。对于一个实数 IIR 滤波器，这简化为 $H_{fb}(e^{j\\omega}) = \\lvert H(e^{j\\omega}) \\rvert^2$。这个新的传递函数是纯实数，意味着它在所有 $\\omega$ 上的相位均为零。\n- 零相位滤波器在所有频率上的群延迟均为零。它不会引入任何时间延迟或相位失真。因此，它完全消除了由原始 IIR 滤波器引入的时间偏差（相位引起的延迟），包括与频率相关的部分。该陈述准确地描述了 IIR 滤波器的属性以及前向-后向滤波技术的结果。\n- 结论：**正确**。\n\n**B. 对称 FIR 低通滤波器对所有 $\\omega$ 的群延迟均为零，因此单程因果应用不会改变 EMG 的起点时间。**\n\n- 该陈述指的是具有对称系数的因果线性相位 FIR 滤波器（实现方案 (ii)）。设滤波器长度为 $N$，脉冲响应对称，$h[n] = h[N-1-n]$，其中 $n=0, 1, ..., N-1$。这样的滤波器具有广义线性相位响应，形式为 $\\phi(\\omega) = -\\alpha \\omega$，其中 $\\alpha = \\frac{N-1}{2}$ 是一个常数。\n- 群延迟为 $\\tau_g(\\omega) = -\\frac{d}{d\\omega}(-\\alpha \\omega) = \\alpha = \\frac{N-1}{2}$ 个样本。此延迟对所有频率都是常数，而不是零（除非 $N=1$，这是一个平凡滤波器）。\n- 因为群延迟是一个非零常数，该滤波器会对信号引入一个 $\\frac{N-1}{2}$ 个样本的纯粹时间偏移。这个偏移会影响检测到的起点时间。陈述中说群延迟为零是错误的。\n- 结论：**错误**。\n\n**C. 对线性相位 FIR 应用前向-后向滤波会产生一个非因果的零相位滤波器，其幅频响应等于原始幅频响应，而不是其平方。**\n\n- 前向-后向滤波过程本质上是非因果的，因为后向过程需要访问前向滤波后信号的未来值。如一般推导所示，得到的等效滤波器具有零相位。\n- 等效幅频响应为 $\\lvert H_{fb}(e^{j\\omega}) \\rvert = \\lvert \\lvert H(e^{j\\omega}) \\rvert^2 \\rvert = \\lvert H(e^{j\\omega}) \\rvert^2$。这是原始滤波器幅频响应的平方。该陈述声称幅频响应等于原始值，而不是其平方。这是不正确的。最终的通带会更平坦，阻带会有更大的衰减（例如，如果原始衰减为 $-40$ dB，新的衰减将是 $-80$ dB），但幅频响应函数本身是平方的。\n- 结论：**错误**。\n\n**D. 对于任何稳定的因果低通滤波器，群延迟是恒定的，且等于滤波器阶数的一半，因此起点时间偏差与频率内容无关。**\n\n- 该陈述做出了错误的概括。恒定群延迟的特性是线性相位滤波器的特征，而线性相位滤波器通常实现为 FIR 滤波器。正如选项 A 的分析所确立的，稳定的因果 IIR 滤波器通常不具有线性相位，因此其群延迟随频率变化。\n- 该陈述声称此属性对“任何稳定的因果低通滤波器”都成立，这是错误的。例如，Butterworth IIR 滤波器是一个稳定的因果低通滤波器，但其群延迟不是恒定的。因此，前提无效，并且起点时间偏差与频率内容无关的结论并非对所有此类滤波器都成立。\n- 结论：**错误**。\n\n**E. 在使用长度为 $N$ 个样本、采样率为 $f_s$ 的单程因果线性相位 FIR 进行基于阈值的起点检测时，相对于应用于相同滤波的非因果零相位版本的相同检测，检测到的起点时间会偏移一个恒定量 $\\Delta t = \\frac{N-1}{2 f_s}$，这与包络的波形形状无关，因为线性相位意味着除了幅度整形之外，还有一个纯粹的恒定延迟。**\n\n- 长度为 $N$ 的单程因果线性相位 FIR 滤波器具有 $\\tau_g = \\frac{N-1}{2}$ 个样本的恒定群延迟。\n- 恒定的群延迟意味着信号的所有频率分量都被延迟相同的时间量。这导致整个波形的完美时间偏移，而没有任何形状失真（相位色散）。幅频响应仍然对信号的频谱进行整形，但这与时间偏移是解耦的。\n- 以秒为单位的总时间延迟是群延迟（以样本为单位）除以采样率 $f_s$，即 $\\Delta t = \\frac{\\tau_g}{f_s} = \\frac{(N-1)/2}{f_s} = \\frac{N-1}{2f_s}$。\n- 滤波的“非因果零相位版本”意味着一个群延迟为零的操作。因此，因果线性相位输出与零相位输出之间的相对偏移恰好是这个恒定延迟 $\\Delta t$。\n- 因为延迟对所有频率都是均匀的，EMG 包络的形状得以保留，只是在时间上发生了偏移。因此，与零相位滤波信号相比，滤波后信号上的阈值交叉将发生在一个延迟了 $\\Delta t$ 的时间点，无论包络的具体形状如何。\n- 结论：**正确**。",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "超越传统的包络线分析，现代EMG处理技术致力于将信号分解为其神经来源——即单个运动单元的活动。本练习介绍了一种强大的基于模型的分解方法：卷积稀疏编码 。你将从贝叶斯最大后验估计（MAP）的第一性原理出发，推导出一个目标函数，并理解稀疏性先验如何帮助我们从叠加的、充满噪声的信号中分离出各个运动单元的发放序列。",
            "id": "4170100",
            "problem": "从单个差分电极在肌肉上记录的肌电图 (EMG) 时间序列 $x[n]$ 被建模为运动单元动作电位 (MUAP) 模板响应与潜在的、单元特异性的脉冲序列进行卷积的线性叠加，并受到加性噪声的干扰。设 $\\{h_i[n]\\}_{i=1}^{K}$ 表示与 $K$ 个不同运动单元相关的固定 MUAP 模板（有限长度的脉冲响应），并设 $\\{s_i[n]\\}_{i=1}^{K}$ 表示它们对应的非负潜在脉冲序列。假设在离散时间下有以下生成模型：\n$$\nx[n] = \\sum_{i=1}^{K} (h_i * s_i)[n] + w[n],\n$$\n其中 $*$ 表示线性卷积，$w[n]$ 是加性噪声。假设 $w[n]$ 是一个零均值、独立同分布的高斯过程的实现，其方差为 $\\sigma^{2}$，即在各个 $n$ 上独立地有 $w[n] \\sim \\mathcal{N}(0,\\sigma^{2})$。进一步假设脉冲序列 $\\{s_i[n]\\}$ 在索引 $i$ 上是独立的，并且具有促进稀疏性的拉普拉斯（双指数）先验，即\n$$\np(s_i) \\propto \\exp\\!\\big(-\\alpha \\lVert s_i \\rVert_{1}\\big),\n$$\n其中 $\\alpha>0$ 是一个固定的超参数，且 $\\lVert s_i \\rVert_{1} \\triangleq \\sum_{n} |s_i[n]|$。\n\n仅从这些建模假设以及线性卷积、高斯似然、拉普拉斯先验和最大后验 (MAP) 估计的核心定义出发，完成以下任务：\n\n- 利用独立性假设，写出后验概率 $p(\\{s_i\\}\\,|\\,x)$，可相差一个比例常数，然后取负对数以获得关于 $x$、模板 $\\{h_i\\}$ 和脉冲序列 $\\{s_i\\}$ 的 MAP 目标函数。消除不依赖于 $\\{s_i\\}$ 的加法和乘法常数，并将目标函数表示为一个数据保真项和一个稀疏性诱导正则化项的和。引入一个单一的正则化参数 $\\lambda>0$，将对 $\\sigma^{2}$ 和 $\\alpha$ 的依赖关系整合到一个标量权重中。\n- 根据稀疏表示理论的基本原理和 $\\ell_{1}$ 范数的性质，解释当模板 $\\{h_i\\}$ 不相同且表现出有限的互相关性时，$\\{s_i\\}$ 中的稀疏性如何促进时间上重叠的 MUAP 的分离。你的解释应引用 $\\ell_{1}$ 的三角不等式的作用、稀疏解的支撑集减小，以及互相关性对可辨识性的定性影响，而不依赖于未经证明的捷径结果。\n\n作为最终答案，提供以 $\\{s_i\\}$、$x$、$\\{h_i\\}$ 和 $\\lambda$ 为函数的最简形式的卷积稀疏编码 MAP 目标函数的解析表达式。无需进行数值计算，最终答案中也不报告单位。",
            "solution": "首先对问题进行验证，以确保其科学上可靠、适定且客观。\n\n### 第1步：提取给定条件\n- EMG 时间序列：$x[n]$\n- 生成模型：$x[n] = \\sum_{i=1}^{K} (h_i * s_i)[n] + w[n]$\n- MUAP 模板：$\\{h_i[n]\\}_{i=1}^{K}$，固定的、有限长度的脉冲响应\n- 潜在脉冲序列：$\\{s_i[n]\\}_{i=1}^{K}$，非负\n- 卷积算子：$*$\n- 加性噪声：$w[n] \\sim \\mathcal{N}(0,\\sigma^{2})$，零均值、独立同分布的高斯噪声，方差为 $\\sigma^2$\n- 脉冲序列的独立性：$\\{s_i[n]\\}$ 在索引 $i$ 上是独立的\n- 脉冲序列的先验：$p(s_i) \\propto \\exp(-\\alpha \\lVert s_i \\rVert_{1})$，超参数为 $\\alpha > 0$\n- $\\ell_1$ 范数的定义：$\\lVert s_i \\rVert_{1} \\triangleq \\sum_{n} |s_i[n]|$\n\n### 第2步：使用提取的给定条件进行验证\n该问题是生物医学信号处理领域中的一个标准问题，特别是在 EMG 分解领域。所描述的生成模型是一个成熟的卷积稀疏编码 (CSC) 框架。其假设在物理和数学上都是合理的：\n- **科学可靠性**：将 EMG 信号建模为卷积脉冲序列的叠加是 EMG 分析的基石。使用高斯模型处理噪声和拉普拉斯先验（导致 $\\ell_1$ 正则化）来促进底层神经驱动的稀疏性，是现代统计信号处理和机器学习中的一种标准且强大的技术。\n- **适定性**：任务是推导一个目标函数并提供一个概念性解释。所提供的前提（似然和先验分布）对于推导最大后验 (MAP) 目标是充分且一致的。\n- **客观性**：问题使用精确的数学和技术语言陈述，没有主观或模糊的术语。\n\n所有验证标准均已满足。该问题被判定为有效。\n\n### 第3步：结论与行动\n该问题有效。将提供一个完整、合理的解答。\n\n### MAP 目标函数的推导\n\n目标是找到在给定观测到的 EMG 信号 $x$ 的情况下，潜在脉冲序列 $\\{s_i\\}_{i=1}^{K}$ 的最大后验 (MAP) 估计。MAP 估计，记为 $\\{\\hat{s}_i\\}$，最大化后验概率 $p(\\{s_i\\} | x)$。根据贝叶斯定理，后验概率与似然和先验的乘积成正比：\n$$\np(\\{s_i\\}_{i=1}^{K} \\,|\\, x) \\propto p(x \\,|\\, \\{s_i\\}_{i=1}^{K}) \\, p(\\{s_i\\}_{i=1}^{K})\n$$\n\n首先，我们定义似然项 $p(x \\,|\\, \\{s_i\\})$。生成模型为 $x[n] = \\sum_{i=1}^{K} (h_i * s_i)[n] + w[n]$。这可以重写为关于噪声的表达式 $w[n] = x[n] - \\sum_{i=1}^{K} (h_i * s_i)[n]$。问题陈述 $w[n]$ 是一个独立同分布 (i.i.d.) 的高斯过程的实现，其均值为零，方差为 $\\sigma^2$，即 $w[n] \\sim \\mathcal{N}(0, \\sigma^2)$。单个噪声样本的概率密度函数为 $p(w[n]) = (2\\pi\\sigma^2)^{-1/2} \\exp\\left(-\\frac{w[n]^2}{2\\sigma^2}\\right)$。由于噪声样本在时间 $n$ 上是独立的，整个噪声序列 $w = \\{w[n]\\}$ 的联合概率是各个概率的乘积。这给出了在给定脉冲序列 $\\{s_i\\}$ 的情况下观测到数据 $x$ 的似然：\n$$\np(x \\,|\\, \\{s_i\\}) = \\prod_{n} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{\\left(x[n] - \\sum_{i=1}^{K} (h_i * s_i)[n]\\right)^2}{2\\sigma^2} \\right)\n$$\n这个表达式可以写得更紧凑。指数的乘积等同于其参数的求和：\n$$\np(x \\,|\\, \\{s_i\\}) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{n} \\left(x[n] - \\sum_{i=1}^{K} (h_i * s_i)[n]\\right)^2 \\right)\n$$\n该和是残差向量的欧几里得 ($\\ell_2$) 范数的平方。让完整的信号表示为向量 $x$ 和 $s_i$。表达式为：\n$$\np(x \\,|\\, \\{s_i\\}) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2} \\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2} \\right)\n$$\n接下来，我们定义先验项 $p(\\{s_i\\})$。问题陈述脉冲序列 $\\{s_i\\}$ 在运动单元 $i$ 上是独立的，并且每个都遵循拉普拉斯先验 $p(s_i) \\propto \\exp(-\\alpha \\lVert s_i \\rVert_1)$。联合先验是各个先验的乘积：\n$$\np(\\{s_i\\}_{i=1}^{K}) = \\prod_{i=1}^{K} p(s_i) \\propto \\prod_{i=1}^{K} \\exp(-\\alpha \\lVert s_i \\rVert_1) = \\exp\\left(-\\alpha \\sum_{i=1}^{K} \\lVert s_i \\rVert_1\\right)\n$$\n结合似然和先验，后验概率为：\n$$\np(\\{s_i\\} \\,|\\, x) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2} \\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2} \\right) \\exp\\left(-\\alpha \\sum_{i=1}^{K} \\lVert s_i \\rVert_1\\right)\n$$\n$$\np(\\{s_i\\} \\,|\\, x) \\propto \\exp\\left( -\\frac{1}{2\\sigma^2} \\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2} - \\alpha \\sum_{i=1}^{K} \\lVert s_i \\rVert_1 \\right)\n$$\n最大化后验概率等价于最小化其负对数。设 $J(\\{s_i\\})$ 为此负对数后验目标函数：\n$$\nJ(\\{s_i\\}) = -\\ln(p(\\{s_i\\} \\,|\\, x)) = C + \\frac{1}{2\\sigma^2} \\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2} + \\alpha \\sum_{i=1}^{K} \\lVert s_i \\rVert_1\n$$\n其中 $C$ 是一个不依赖于 $\\{s_i\\}$ 的常数。为了找到 MAP 估计 $\\{\\hat{s}_i\\}$，我们相对于 $\\{s_i\\}$ 最小化这个目标函数。我们可以舍弃常数 $C$ 并将整个目标函数乘以一个正常数 $2\\sigma^2$，这不会改变最小值的位置。这得到了 MAP 优化问题的最终形式：\n$$\n\\{\\hat{s}_i\\} = \\arg\\min_{\\{s_i\\}, s_i \\ge 0} \\left\\{ \\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2} + 2\\sigma^2\\alpha \\sum_{i=1}^{K} \\lVert s_i \\rVert_1 \\right\\}\n$$\n问题还要求引入一个单一的正则化参数 $\\lambda = 2\\sigma^2\\alpha$。由于 $\\sigma^2 > 0$ 和 $\\alpha > 0$，我们有 $\\lambda > 0$。最终的目标函数是两项之和：一个数据保真项和一个稀疏性诱导正则化项。保真项 $\\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2}$ 惩罚模型与观测数据的偏差，源于高斯噪声假设。正则化项 $\\lambda \\sum_{i=1}^{K} \\lVert s_i \\rVert_1$ 惩罚非稀疏解，源于拉普拉斯先验假设。同时，根据给定条件，还施加了非负性约束 $s_i[n] \\ge 0$。\n\n### 稀疏性对 MUAP 分离作用的解释\n\n上述推导出的 MAP 目标是卷积稀疏编码的一种形式。该框架在分离时间上重叠的 MUAP 方面的有效性，依赖于 $\\ell_1$ 范数正则化项的性质与 MUAP 模板字典 $\\{h_i\\}$ 特性之间的相互作用。\n\n1.  **稀疏性与支撑集减小**：$\\ell_1$ 范数 $\\lVert s_i \\rVert_1 = \\sum_n |s_i[n]|$ 是一个促进稀疏性的凸函数。这意味着最小化一个包含 $\\ell_1$ 惩罚项的目标函数会鼓励 $\\{s_i\\}$ 的解中许多系数 $s_i[n]$ 恰好为零。在 EMG 的背景下，一个事件 $s_i[n] > 0$ 表示运动单元 $i$ 在时间 $n$ 的一次放电。一个稀疏解意味着模型用尽可能少的运动单元放电来解释观测到的信号 $x[n]$，这与神经控制的底层生理学是一致的。信号中非零条目的集合是其“支撑集”。$\\ell_1$ 惩罚项寻求具有更小支撑集的解。\n\n2.  **互相关性的作用**：区分不同 MUAP 的能力取决于它们的模板 $\\{h_i\\}$ 有多“不同”。这通过模板字典的互相关性概念来形式化。低互相关性意味着任何一个模板 $h_i$ 都不能很好地表示为其他模板 $\\{h_j\\}_{j\\neq i}$ 的线性组合。当来自不同单元（例如 $i$ 和 $j$）的两个或多个 MUAP 几乎同时放电时，观测到的信号是它们模板的叠加，例如 $s_i[n_1]h_i[n-n_1] + s_j[n_2]h_j[n-n_2]$。如果模板 $h_i$ 和 $h_j$ 与所有其他模板 $h_k$ 的互相关性都很低，那么就不可能用单个缩放的模板 $s_k[n_k]h_k[n-n_k]$ 来精确表示这种叠加，而不会在数据保真项 $\\lVert \\cdot \\rVert_2^2$ 中产生大的误差。因此，优化过程被迫同时激活 $s_i$ 和 $s_j$ 以实现良好的拟合。\n\n3.  **通过 $\\ell_1$ 最小化和三角不等式实现可辨识性**：一旦优化器被迫使用模板的组合来解释一个重叠事件，$\\ell_1$ 惩罚项就会引导选择朝向最稀疏的组合。考虑一个重叠片段 $x_{seg}$ 的真实解释需要两个脉冲，由脉冲序列 $s_i$ 和 $s_j$ 表示。对正则化项的贡献是 $\\lambda (\\lVert s_i \\rVert_1 + \\lVert s_j \\rVert_1)$。一个不正确的、非稀疏的解释可能涉及来自许多不同运动单元 $\\{s'_k\\}_{k=1}^K$ 的小贡献来重建相同的片段 $x_{seg}$。与 $\\ell_1$ 范数和三角不等式相关的一个基本性质是，用少数“正确”的原子元素来表示一个信号通常更有效（即，系数的 $\\ell_1$ 范数更小），而不是用许多元素的密集组合来表示。$\\ell_1$ 范数的最小化器优先选择稀疏向量。稀疏表示理论保证，如果真实的底层解足够稀疏，并且模板字典具有足够低的互相关性，那么求解 $\\ell_1$ 正则化最小化问题可以保证恢复正确的稀疏解。\n\n总之，当 MUAP 重叠时，低的模板互相关性会使任何过于简单（例如，单脉冲）的解释产生大的重建误差。因此，优化器必须使用多个模板的叠加。然后，$\\ell_1$ 正则化项确保这种叠加是尽可能稀疏的，从而偏好真实的、具有生理意义的不同运动单元放电集合，而不是一个密集的、不可解释的替代方案。这使得算法能够将叠加的信号“解混”为其组成的脉冲序列。",
            "answer": "$$\n\\boxed{\\left\\lVert x - \\sum_{i=1}^{K} h_i * s_i \\right\\rVert_{2}^{2} + \\lambda \\sum_{i=1}^{K} \\left\\lVert s_i \\right\\rVert_{1}}\n$$"
        }
    ]
}