{
    "hands_on_practices": [
        {
            "introduction": "在惯性传感器运动分析中，获得准确的航向信息至关重要，而这严重依赖于磁力计的精度。然而，原始磁力计数据常受周围铁磁材料（硬铁效应）和传感器自身内部电路（软铁效应）的干扰而失真。本练习将指导你从第一性原理出发，推导并应用标准的椭球拟合算法，这是从失真数据中恢复精确地磁场方向的关键技术。",
            "id": "4180076",
            "problem": "一个嵌入在可穿戴惯性测量单元（IMU）中的三轴磁力计，用于在磁场均匀的室内环境中缓慢旋转时测量局部地磁场。设理想的、无量纲的、归一化的地磁场矢量表示为 $m \\in \\mathbb{R}^{3}$，且 $\\|m\\| = 1$。设备坐标系中的磁力计测量模型为\n$$\nm_{m} = A\\,m + b_{m} + \\varepsilon,\n$$\n其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个未知的满秩矩阵，用于捕捉软铁畸变和轴尺度/失准，$b_{m} \\in \\mathbb{R}^{3}$ 是一个未知的硬铁偏置，$\\varepsilon$ 是零均值测量噪声。假设旋转充分激励了所有方向，使得 $m$ 遍历了单位球面。\n\n1) 从上述模型和定义 $\\|m\\|=1$ 出发，证明在无噪声的情况下，测量值集合 $m_{m}$ 位于一个椭球面上，该椭球面满足\n$$\n\\left(m_{m} - b_{m}\\right)^{\\top} W \\left(m_{m} - b_{m}\\right) = 1,\n$$\n其中 $W \\in \\mathbb{R}^{3 \\times 3}$ 是某个对称正定矩阵。请用 $A$ 表示 $W$。\n\n2) 将椭球方程写成展开的二次型形式\n$$\nm_{m}^{\\top} Q\\, m_{m} + 2\\, q^{\\top} m_{m} + q_{0} = 0,\n$$\n其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是对称矩阵，$q \\in \\mathbb{R}^{3}$，$q_{0} \\in \\mathbb{R}$。为样本 $m_{m}^{(i)}$ 定义代数残差，并建立最小二乘问题，该问题旨在最小化 $N$ 个样本的代数残差平方和，并受一个归一化约束以避免平凡全零解。明确地构建一个合适的线性设计矩阵以及相应的广义特征值问题，该问题的解可以在相差一个非零尺度因子的情况下得出 $\\left(Q, q, q_{0}\\right)$。\n\n3) 给定一个拟合得到的三元组 $\\left(Q, q, q_{0}\\right)$，其中 $Q$ 是对称正定矩阵，推导表达式以恢复硬铁偏置 $b_{m}$ 和形状矩阵 $W$，使其符合中心化椭球形式 $\\left(m_{m} - b_{m}\\right)^{\\top} W \\left(m_{m} - b_{m}\\right) = 1$。你的推导必须通过代数拟合的显式缩放来确保右侧为单位1。然后，推导如何获得一个校准矩阵 $A$，使得校准后的测量值\n$$\nm_{c} \\triangleq A^{-1}\\left(m_{m} - b_{m}\\right)\n$$\n满足 $\\|m_{c}\\| = 1$，仅使用 $W$ 是对称正定矩阵这一要求。基于 $W$ 的矩阵分解，给出一个对 $A$ 的唯一选择。\n\n4) 现在考虑以下六个无噪声测量值（单位任意），这些值是在保持设备姿态，使真实磁场 $m$ 与设备坐标轴的六个基本方向对齐时获得的。测得的矢量为：\n$$\n\\begin{aligned}\n\\text{沿 } +x:  m_{m}^{(1)} = \\begin{pmatrix} 1.25 \\\\ -0.02 \\\\ 0.03 \\end{pmatrix}, \\quad\n\\text{沿 } -x:  m_{m}^{(2)} = \\begin{pmatrix} -1.15 \\\\ -0.02 \\\\ 0.03 \\end{pmatrix},\\\\\n\\text{沿 } +y:  m_{m}^{(3)} = \\begin{pmatrix} 0.05 \\\\ 0.78 \\\\ 0.03 \\end{pmatrix}, \\quad\n\\text{沿 } -y:  m_{m}^{(4)} = \\begin{pmatrix} 0.05 \\\\ -0.82 \\\\ 0.03 \\end{pmatrix},\\\\\n\\text{沿 } +z:  m_{m}^{(5)} = \\begin{pmatrix} 0.05 \\\\ -0.02 \\\\ 1.03 \\end{pmatrix}, \\quad\n\\text{沿 } -z:  m_{m}^{(6)} = \\begin{pmatrix} 0.05 \\\\ -0.02 \\\\ -0.97 \\end{pmatrix}.\n\\end{aligned}\n$$\n使用第 1-3 部分的推导，计算校准矩阵 $A$ 的行列式，其中 $A$ 选择为 $W$ 的 Cholesky 因子的逆。将最终答案表示为一个无量纲值，并四舍五入到四位有效数字。",
            "solution": "我们从仿射测量模型和二次型的基本原理出发。\n\n1) 测量模型为 $m_{m} = A m + b_{m} + \\varepsilon$。在无噪声情况（$\\varepsilon = 0$）下，我们有 $m_{m} - b_{m} = A m$。两边左乘 $A^{-1}$ 得到 $A^{-1}\\left(m_{m} - b_{m}\\right) = m$。因为 $\\|m\\| = 1$，我们得到\n$$\n\\left\\|A^{-1}\\left(m_{m} - b_{m}\\right)\\right\\|^{2} = 1.\n$$\n等价地，\n$$\n\\left(m_{m} - b_{m}\\right)^{\\top} \\left(A^{-T} A^{-1}\\right) \\left(m_{m} - b_{m}\\right) = 1.\n$$\n因此，测量值集合 $m_{m}$ 位于一个椭球面上，其形状矩阵为\n$$\nW = A^{-T} A^{-1},\n$$\n该矩阵是对称正定的，因为 $A$ 是满秩的。\n\n2) 任何中心化椭球方程都可以写成展开的二次型形式\n$$\nm_{m}^{\\top} Q\\, m_{m} + 2\\, q^{\\top} m_{m} + q_{0} = 0,\n$$\n其中 $Q = Q^{\\top}$，$q \\in \\mathbb{R}^{3}$，$q_{0} \\in \\mathbb{R}$。对于给定的样本 $m_{m}^{(i)} \\in \\mathbb{R}^{3}$，其代数残差为\n$$\nr_{i} \\triangleq \\left(m_{m}^{(i)}\\right)^{\\top} Q\\, m_{m}^{(i)} + 2\\, q^{\\top} m_{m}^{(i)} + q_{0}.\n$$\n对于 $N$ 个样本，我们将参数堆叠成一个向量 $\\theta \\in \\mathbb{R}^{10}$，代表 $Q$、$q$ 和 $q_{0}$ 的独立分量。一种方便的参数化方法是\n$$\n\\theta \\triangleq \\begin{pmatrix} q_{xx}  q_{yy}  q_{zz}  q_{yz}  q_{xz}  q_{xy}  q_{x}  q_{y}  q_{z}  q_{0} \\end{pmatrix}^{\\top},\n$$\n其中 $Q = \\begin{pmatrix} q_{xx}  q_{xy}  q_{xz} \\\\ q_{xy}  q_{yy}  q_{yz} \\\\ q_{xz}  q_{yz}  q_{zz} \\end{pmatrix}$ 且 $q = \\begin{pmatrix} q_{x} \\\\ q_{y} \\\\ q_{z} \\end{pmatrix}$。对于每个样本 $m_{m}^{(i)} = \\begin{pmatrix} x_{i} \\\\ y_{i} \\\\ z_{i} \\end{pmatrix}$，残差可以写成关于 $\\theta$ 的线性形式\n$$\nr_{i} = d_{i}^{\\top} \\theta,\n$$\n其中 $10 \\times 1$ 的数据向量为\n$$\nd_{i} \\triangleq \\begin{pmatrix} x_{i}^{2} \\\\ y_{i}^{2} \\\\ z_{i}^{2} \\\\ 2 y_{i} z_{i} \\\\ 2 x_{i} z_{i} \\\\ 2 x_{i} y_{i} \\\\ 2 x_{i} \\\\ 2 y_{i} \\\\ 2 z_{i} \\\\ 1 \\end{pmatrix}.\n$$\n将 $d_{i}^{\\top}$ 作为行堆叠起来，得到设计矩阵 $D \\in \\mathbb{R}^{N \\times 10}$。最小化代数残差平方和的最小二乘问题是\n$$\n\\min_{\\theta \\neq 0} \\; \\| D \\theta \\|_{2}^{2} \\quad \\text{受一个关于 } \\theta \\text{ 的归一化约束},\n$$\n以避免平凡解 $\\theta = 0$。一个常用的归一化方法是约束块 $Q$ 中与正定性相关的二次型；一个实际的选择是强制\n$$\n\\operatorname{trace}(Q) = 1,\n$$\n这可以写成一个线性约束 $c^{\\top} \\theta = 1$，其中 $c = \\begin{pmatrix} 1  1  1  0  0  0  0  0  0  0 \\end{pmatrix}^{\\top}$。使用拉格朗日乘子 $\\lambda$，约束最小化解满足 Karush–Kuhn–Tucker 条件\n$$\nD^{\\top} D \\, \\theta = \\lambda \\, c, \\quad c^{\\top} \\theta = 1.\n$$\n等价地，可以通过建立一个广义特征值问题来消除显式线性约束。定义一个对称约束矩阵 $C \\in \\mathbb{R}^{10 \\times 10}$，它对对应于 $Q$ 的左上角 $3 \\times 3$ 块中的缩放进行惩罚，例如\n$$\nC \\triangleq \\operatorname{diag}(1, 1, 1, 0, 0, 0, 0, 0, 0, 0).\n$$\n然后求解\n$$\n\\left(D^{\\top} D\\right) \\theta = \\lambda \\, C \\, \\theta,\n$$\n并选择与最小正广义特征值 $\\lambda$ 相关联的广义特征向量 $\\theta$，条件是恢复出的 $Q$ 是正定的。这样可以得到 $\\left(Q, q, q_{0}\\right)$，相差一个非零标量因子，该因子将在下一步中确定。\n\n3) 将中心化椭球形式\n$$\n\\left(m_{m} - b_{m}\\right)^{\\top} W \\left(m_{m} - b_{m}\\right) = 1\n$$\n与展开的二次型进行匹配，可得\n$$\nQ = W, \\quad q = -W b_{m}, \\quad q_{0} = b_{m}^{\\top} W b_{m} - 1.\n$$\n对于代数拟合返回的、其中 $Q$ 为对称正定矩阵的任意非零缩放的 $\\left(Q, q, q_{0}\\right)$，我们首先将二次曲面的中心恢复为偏置\n$$\nb_{m} = - Q^{-1} q.\n$$\n将其代入二次型得到\n$$\nm_{m}^{\\top} Q\\, m_{m} + 2\\, q^{\\top} m_{m} + q_{0} = \\left(m_{m} - b_{m}\\right)^{\\top} Q \\left(m_{m} - b_{m}\\right) - \\left(b_{m}^{\\top} Q b_{m} - q_{0}\\right).\n$$\n定义标量\n$$\n\\alpha \\triangleq b_{m}^{\\top} Q b_{m} - q_{0}.\n$$\n为了强制使右侧为1，令\n$$\nW = \\frac{Q}{\\alpha}.\n$$\n那么，根据构造，\n$$\n\\left(m_{m} - b_{m}\\right)^{\\top} W \\left(m_{m} - b_{m}\\right) = 1.\n$$\n因为 $W$ 是对称正定矩阵，我们可以对其进行 Cholesky 分解\n$$\nW = L^{\\top} L,\n$$\n其中 $L$ 是上三角可逆矩阵。一个唯一且数值稳定的校准矩阵选择是\n$$\nA = L^{-1},\n$$\n这能确保校准后的测量值满足\n$$\n\\|m_{c}\\|^{2} = \\left\\|A^{-1}\\left(m_{m} - b_{m}\\right)\\right\\|^{2} = \\left(m_{m} - b_{m}\\right)^{\\top} A^{-T} A^{-1} \\left(m_{m} - b_{m}\\right) = \\left(m_{m} - b_{m}\\right)^{\\top} W \\left(m_{m} - b_{m}\\right) = 1.\n$$\n\n4) 对于给定的六个测量值，我们可以利用基本方向的对称性。设 $m_{m}^{(+x)}$ 和 $m_{m}^{(-x)}$ 表示沿 $+x$ 和 $-x$ 方向的测量值，对于 $y$ 和 $z$ 也类似。椭球中心满足\n$$\nb_{m} = \\frac{1}{2}\\left(m_{m}^{(+x)} + m_{m}^{(-x)}\\right) = \\frac{1}{2}\\left(m_{m}^{(+y)} + m_{m}^{(-y)}\\right) = \\frac{1}{2}\\left(m_{m}^{(+z)} + m_{m}^{(-z)}\\right),\n$$\n分量地得到，\n$$\n\\begin{aligned}\nb_{x} = \\frac{1}{2}\\left(1.25 + \\left(-1.15\\right)\\right) = \\frac{1}{2}\\left(0.10\\right) = 0.05,\\\\\nb_{y} = \\frac{1}{2}\\left(-0.02 + \\left(-0.02\\right)\\right) = -0.02,\\\\\nb_{z} = \\frac{1}{2}\\left(1.03 + \\left(-0.97\\right)\\right) = 0.03.\n\\end{aligned}\n$$\n因此，\n$$\nb_{m} = \\begin{pmatrix} 0.05 \\\\ -0.02 \\\\ 0.03 \\end{pmatrix}.\n$$\n沿每个主轴距中心的偏移量给出了测量空间中椭球的半轴长度，当 $A$ 为对角矩阵时，这等于 $A$ 的对角线元素。具体来说，\n$$\n\\begin{aligned}\n\\Delta x = \\left(1.25 - 0.05\\right) = 1.20, \\quad \\text{及 } \\left(-1.15 - 0.05\\right) = -1.20,\\\\\n\\Delta y = \\left(0.78 - \\left(-0.02\\right)\\right) = 0.80, \\quad \\text{及 } \\left(-0.82 - \\left(-0.02\\right)\\right) = -0.80,\\\\\n\\Delta z = \\left(1.03 - 0.03\\right) = 1.00, \\quad \\text{及 } \\left(-0.97 - 0.03\\right) = -1.00.\n\\end{aligned}\n$$\n因此，中心化椭球的主半轴长度为 $s_{x} = 1.20$，$s_{y} = 0.80$ 和 $s_{z} = 1.00$，且与设备坐标轴对齐。在这种轴对齐的情况下，形状矩阵和校准矩阵都是对角矩阵：\n$$\nW = \\operatorname{diag}\\!\\left(\\frac{1}{s_{x}^{2}}, \\frac{1}{s_{y}^{2}}, \\frac{1}{s_{z}^{2}}\\right) = \\operatorname{diag}\\!\\left(\\frac{1}{1.20^{2}}, \\frac{1}{0.80^{2}}, \\frac{1}{1.00^{2}}\\right),\n$$\n其 Cholesky 因子为 $L = \\operatorname{diag}\\!\\left(\\frac{1}{1.20}, \\frac{1}{0.80}, \\frac{1}{1.00}\\right)$。因此所选的校准矩阵为\n$$\nA = L^{-1} = \\operatorname{diag}\\!\\left(1.20, 0.80, 1.00\\right).\n$$\n所求的行列式为\n$$\n\\det(A) = 1.20 \\times 0.80 \\times 1.00 = 0.96.\n$$\n四舍五入到四位有效数字，无量纲行列式为 $0.9600$。",
            "answer": "$$\\boxed{0.9600}$$"
        },
        {
            "introduction": "陀螺仪是姿态跟踪的核心，但其固有的零偏（bias）是导致方向估计随时间漂移的主要误差源。为了抑制这种漂移，在线估计并补偿零偏至关重要。本练习介绍了一种利用静止间隔（zero-velocity updates）来估计陀螺仪零偏的基本而强大的方法，你将学习如何构建一个统计最优的估计器，并从理论上分析其精度。",
            "id": "4180126",
            "problem": "在生物力学实验室中，一个三轴惯性测量单元（IMU）陀螺仪被安装在人体小腿上，用于测量静立状态。在离散采样点 $k$ 处，陀螺仪的输出由以下加性测量模型表示\n$$\n\\boldsymbol{\\omega}_{m}(k) = \\boldsymbol{\\omega}(k) + \\boldsymbol{b}_{\\omega} + \\boldsymbol{n}(k),\n$$\n其中 $\\boldsymbol{\\omega}_{m}(k) \\in \\mathbb{R}^{3}$ 是测量得到的角速度，$\\boldsymbol{\\omega}(k) \\in \\mathbb{R}^{3}$ 是真实的角速度，$\\boldsymbol{b}_{\\omega} \\in \\mathbb{R}^{3}$ 是在整个实验过程中恒定的偏置向量，$\\boldsymbol{n}(k) \\in \\mathbb{R}^{3}$ 是零均值、独立同分布的高斯噪声，其协方差矩阵为 $\\boldsymbol{\\Sigma}_{\\omega} = \\mathrm{diag}(\\sigma_{x}^{2}, \\sigma_{y}^{2}, \\sigma_{z}^{2})$。通过对移动窗口内测量角速度的欧几里得范数进行阈值处理，可以实时检测到短暂的静态区间：如果窗口内 $\\|\\boldsymbol{\\omega}_{m}\\|$ 的平均值小于阈值 $\\gamma$，则该窗口被标记为静态。在检测到的静态区间内，生物力学假设为该肢体段没有旋转，即对于该区间内的所有样本 $k$，都有 $\\boldsymbol{\\omega}(k) = \\boldsymbol{0}$。\n\n要求您利用从检测到的静态区间中获得的数据，为陀螺仪偏置 $\\boldsymbol{b}_{\\omega}$ 开发并分析一个具有统计学原理的估计器。请利用从所有检测到的静态区间收集的样本来构建一个估计器，并从第一性原理出发，根据所有静态区间聚合的总样本数和噪声协方差参数，推导出该估计器的方差。然后，根据以下特定的实验配置，计算其均方误差（定义为估计器协方差的迹）：\n\n- 采样频率 $f_{s} = 100\\,\\mathrm{Hz}$。\n- 各轴的噪声标准差为 $\\sigma_{x} = 0.005\\,\\mathrm{rad/s}$，$\\sigma_{y} = 0.006\\,\\mathrm{rad/s}$，以及 $\\sigma_{z} = 0.004\\,\\mathrm{rad/s}$。\n- 检测到五个静态区间，其持续时间分别为 $T_{1} = 0.30\\,\\mathrm{s}$，$T_{2} = 0.25\\,\\mathrm{s}$，$T_{3} = 0.20\\,\\mathrm{s}$，$T_{4} = 0.15\\,\\mathrm{s}$ 和 $T_{5} = 0.40\\,\\mathrm{s}$。\n\n假设各样本和各轴之间的噪声是独立的，并且检测步骤能够正确识别区间，不会对每个区间内的样本进行进一步截断。请用 $(\\mathrm{rad/s})^{2}$ 作为单位表示最终的均方误差，并将您的答案四舍五入到四位有效数字。最终答案必须是一个实数。",
            "solution": "题目要求利用从检测到的静态区间中获得的数据，为陀螺仪偏置向量 $\\boldsymbol{b}_{\\omega}$ 构建并分析一个估计器。最终目标是针对给定的实验配置，计算该估计器的均方误差（MSE）。\n\n首先，我们建立静态区间内的测量模型。题目指出，对于一个静态区间，真实的角速度为零，即对于该区间内的任何样本点 $k$，都有 $\\boldsymbol{\\omega}(k) = \\boldsymbol{0}$。通用的测量模型如下：\n$$\n\\boldsymbol{\\omega}_{m}(k) = \\boldsymbol{\\omega}(k) + \\boldsymbol{b}_{\\omega} + \\boldsymbol{n}(k)\n$$\n代入静态条件 $\\boldsymbol{\\omega}(k) = \\boldsymbol{0}$，模型简化为：\n$$\n\\boldsymbol{\\omega}_{m}(k) = \\boldsymbol{b}_{\\omega} + \\boldsymbol{n}(k)\n$$\n在这里，我们的任务是从一系列带噪测量值 $\\boldsymbol{\\omega}_{m}(k)$ 中估计常数向量 $\\boldsymbol{b}_{\\omega}$。已知噪声 $\\boldsymbol{n}(k)$ 是零均值、独立同分布（i.i.d.）的高斯噪声，其协方差为 $\\boldsymbol{\\Sigma}_{\\omega}$。\n\n对于一个被加性零均值噪声污染的常数向量，一个符合统计学原理的估计器是测量值的样本均值。该估计器是高斯噪声中常数均值的最大似然估计器（MLE），同时也是最佳线性无偏估计器（BLUE）。我们汇总所有检测到的静态区间中的所有样本。设总样本数为 $N$。我们可以将这些收集到的测量值序列表示为 $\\{\\boldsymbol{\\omega}_{m}(j)\\}_{j=1}^{N}$。$\\boldsymbol{b}_{\\omega}$ 的估计器，记为 $\\hat{\\boldsymbol{b}}_{\\omega}$，是：\n$$\n\\hat{\\boldsymbol{b}}_{\\omega} = \\frac{1}{N} \\sum_{j=1}^{N} \\boldsymbol{\\omega}_{m}(j)\n$$\n接下来，我们推导其方差，对于一个向量估计器，其方差即为其协方差矩阵 $\\mathrm{Cov}(\\hat{\\boldsymbol{b}}_{\\omega})$。首先，我们求估计器的期望值以检查其偏倚性。\n$$\nE[\\hat{\\boldsymbol{b}}_{\\omega}] = E\\left[\\frac{1}{N} \\sum_{j=1}^{N} \\boldsymbol{\\omega}_{m}(j)\\right] = \\frac{1}{N} \\sum_{j=1}^{N} E[\\boldsymbol{\\omega}_{m}(j)]\n$$\n对于每次测量 $j$，$E[\\boldsymbol{\\omega}_{m}(j)] = E[\\boldsymbol{b}_{\\omega} + \\boldsymbol{n}(j)] = E[\\boldsymbol{b}_{\\omega}] + E[\\boldsymbol{n}(j)]$。由于 $\\boldsymbol{b}_{\\omega}$ 是一个常数向量，因此 $E[\\boldsymbol{b}_{\\omega}] = \\boldsymbol{b}_{\\omega}$。噪声是零均值的，所以 $E[\\boldsymbol{n}(j)] = \\boldsymbol{0}$。因此，$E[\\boldsymbol{\\omega}_{m}(j)] = \\boldsymbol{b}_{\\omega}$。\n将此结果代回 $E[\\hat{\\boldsymbol{b}}_{\\omega}]$ 的表达式中：\n$$\nE[\\hat{\\boldsymbol{b}}_{\\omega}] = \\frac{1}{N} \\sum_{j=1}^{N} \\boldsymbol{b}_{\\omega} = \\frac{1}{N} (N \\boldsymbol{b}_{\\omega}) = \\boldsymbol{b}_{\\omega}\n$$\n该估计器是无偏的。\n\n现在我们计算该估计器的协方差矩阵。\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{b}}_{\\omega}) = \\mathrm{Var}(\\hat{\\boldsymbol{b}}_{\\omega}) = \\mathrm{Var}\\left(\\frac{1}{N} \\sum_{j=1}^{N} \\boldsymbol{\\omega}_{m}(j)\\right)\n$$\n因为噪声样本 $\\boldsymbol{n}(j)$ 在样本索引 $j$ 上是独立的，所以测量值 $\\boldsymbol{\\omega}_{m}(j)$ 也是独立的。独立随机向量之和的方差等于它们各自方差之和。\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{b}}_{\\omega}) = \\frac{1}{N^2} \\sum_{j=1}^{N} \\mathrm{Var}(\\boldsymbol{\\omega}_{m}(j))\n$$\n单次测量的方差为 $\\mathrm{Var}(\\boldsymbol{\\omega}_{m}(j)) = \\mathrm{Var}(\\boldsymbol{b}_{\\omega} + \\boldsymbol{n}(j))$。由于 $\\boldsymbol{b}_{\\omega}$ 是常数，它不影响方差。因此，$\\mathrm{Var}(\\boldsymbol{\\omega}_{m}(j)) = \\mathrm{Var}(\\boldsymbol{n}(j)) = \\boldsymbol{\\Sigma}_{\\omega}$。\n将此结果代入估计器的协方差表达式中：\n$$\n\\mathrm{Cov}(\\hat{\\boldsymbol{b}}_{\\omega}) = \\frac{1}{N^2} \\sum_{j=1}^{N} \\boldsymbol{\\Sigma}_{\\omega} = \\frac{1}{N^2} (N \\boldsymbol{\\Sigma}_{\\omega}) = \\frac{1}{N} \\boldsymbol{\\Sigma}_{\\omega}\n$$\n题目将均方误差（MSE）定义为估计器协方差矩阵的迹。\n$$\n\\mathrm{MSE} = \\mathrm{Tr}(\\mathrm{Cov}(\\hat{\\boldsymbol{b}}_{\\omega})) = \\mathrm{Tr}\\left(\\frac{1}{N} \\boldsymbol{\\Sigma}_{\\omega}\\right) = \\frac{1}{N} \\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\omega})\n$$\n噪声协方差矩阵为 $\\boldsymbol{\\Sigma}_{\\omega} = \\mathrm{diag}(\\sigma_{x}^{2}, \\sigma_{y}^{2}, \\sigma_{z}^{2})$。\n该矩阵的迹是其对角元素之和：\n$$\n\\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\omega}) = \\sigma_{x}^{2} + \\sigma_{y}^{2} + \\sigma_{z}^{2}\n$$\n所以，MSE 的最终表达式为：\n$$\n\\mathrm{MSE} = \\frac{\\sigma_{x}^{2} + \\sigma_{y}^{2} + \\sigma_{z}^{2}}{N}\n$$\n现在我们根据给定的配置计算数值。首先，我们计算总样本数 $N$。在一个持续时间为 $T_i$、采样频率为 $f_s$ 的区间内，样本数 $N_i$ 为 $N_i = T_i \\times f_s$。\n五个静态区间的持续时间分别为 $T_1 = 0.30\\,\\mathrm{s}$，$T_2 = 0.25\\,\\mathrm{s}$，$T_3 = 0.20\\,\\mathrm{s}$，$T_4 = 0.15\\,\\mathrm{s}$ 和 $T_5 = 0.40\\,\\mathrm{s}$。采样频率为 $f_s = 100\\,\\mathrm{Hz}$。\n每个区间的样本数为：\n$N_1 = 0.30 \\times 100 = 30$\n$N_2 = 0.25 \\times 100 = 25$\n$N_3 = 0.20 \\times 100 = 20$\n$N_4 = 0.15 \\times 100 = 15$\n$N_5 = 0.40 \\times 100 = 40$\n总样本数是这些样本数之和：\n$N = N_1 + N_2 + N_3 + N_4 + N_5 = 30 + 25 + 20 + 15 + 40 = 130$。\n\n接下来，我们计算噪声协方差矩阵的迹 $\\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\omega})$。给定的噪声标准差为 $\\sigma_{x} = 0.005\\,\\mathrm{rad/s}$，$\\sigma_{y} = 0.006\\,\\mathrm{rad/s}$，以及 $\\sigma_{z} = 0.004\\,\\mathrm{rad/s}$。\n方差为：\n$\\sigma_{x}^{2} = (0.005)^{2} = 0.000025 = 2.5 \\times 10^{-5}\\,(\\mathrm{rad/s})^{2}$\n$\\sigma_{y}^{2} = (0.006)^{2} = 0.000036 = 3.6 \\times 10^{-5}\\,(\\mathrm{rad/s})^{2}$\n$\\sigma_{z}^{2} = (0.004)^{2} = 0.000016 = 1.6 \\times 10^{-5}\\,(\\mathrm{rad/s})^{2}$\n迹是这些方差之和：\n$$\n\\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\omega}) = (2.5 + 3.6 + 1.6) \\times 10^{-5} = 7.7 \\times 10^{-5}\\,(\\mathrm{rad/s})^{2}\n$$\n最后，我们计算 MSE：\n$$\n\\mathrm{MSE} = \\frac{\\mathrm{Tr}(\\boldsymbol{\\Sigma}_{\\omega})}{N} = \\frac{7.7 \\times 10^{-5}}{130} \\approx 5.9230769... \\times 10^{-7}\\,(\\mathrm{rad/s})^{2}\n$$\n按要求将结果四舍五入到四位有效数字，得到 $5.923 \\times 10^{-7}$。",
            "answer": "$$\n\\boxed{5.923 \\times 10^{-7}}\n$$"
        },
        {
            "introduction": "拥有经过校准的传感器后，下一步是智能地融合它们的数据以获得鲁棒的姿态估计。然而，真实世界（尤其是室内环境）充满了可能污染磁力计测量的电磁干扰。本项高级练习探讨了鲁棒扩展卡尔曼滤波器（EKF）如何利用统计检验（具体为马氏距离门控）来自动检测和拒绝这些异常测量值，这是在复杂挑战性环境中保持航向估计精度的核心策略。",
            "id": "4180109",
            "problem": "将一个包含三轴加速度计、陀螺仪和磁力计的可穿戴惯性测量单元（IMU）安装在胸部，用于在室内行走时估计航向（偏航角）。该IMU运行一个姿态扩展卡尔曼滤波器（EKF），该滤波器融合陀螺仪、加速度计和磁力计的测量值，以抑制偏航漂移。只有当一个统计门限指示局部磁场环境未受干扰时，EKF才会使用磁力计进行更新。\n\n假设以下物理上真实的模型。设导航坐标系为北-东-下（North-East-Down）坐标系，设导航坐标系中地球磁场的真实单位方向为已知向量 $\\mathbf{b}^{n} \\in \\mathbb{R}^{3}$，且 $\\|\\mathbf{b}^{n}\\| = 1$。EKF有一个当前的姿态估计 $\\widehat{\\mathbf{R}}_{n}^{b} \\in \\mathrm{SO}(3)$，它将向量从导航坐标系旋转到机体坐标系；以及一个小的姿态估计误差，该误差由机体坐标系下的小角度向量 $\\delta \\boldsymbol{\\theta} \\in \\mathbb{R}^{3}$ 参数化，其中 $\\delta \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{P}_{\\theta})$。预测的机体坐标系下的单位磁场方向为 $\\mathbf{h} = \\widehat{\\mathbf{R}}_{n}^{b} \\mathbf{b}^{n}$，其中 $\\|\\mathbf{h}\\| = 1$。\n\n磁力计提供机体坐标系下磁场的测量值，该测量值被归一化为单位长度，得到 $\\mathbf{m}^{b} \\in \\mathbb{R}^{3}$，且 $\\|\\mathbf{m}^{b}\\| \\approx 1$。在没有局部干扰的情况下，将（经过归一化和偏差补偿后的）测量值建模为\n$$\n\\mathbf{m}^{b} \\approx \\mathbf{h} - [\\mathbf{h}]_{\\times} \\, \\delta \\boldsymbol{\\theta} + \\mathbf{v},\n$$\n其中 $[\\mathbf{h}]_{\\times} \\in \\mathbb{R}^{3 \\times 3}$ 是斜对称矩阵，满足对任意 $\\mathbf{x} \\in \\mathbb{R}^{3}$ 都有 $[\\mathbf{h}]_{\\times} \\mathbf{x} = \\mathbf{h} \\times \\mathbf{x}$，而 $\\mathbf{v} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R}_{m})$ 是零均值测量噪声。局部磁场干扰会在方程右侧增加一个未知的扰动 $\\mathbf{d}$，该扰动可能非高斯且时变。为避免在受干扰时进行不当更新，EKF使用一个残差来对磁力计更新进行门限控制，该残差被构造成对幅值变化不敏感，而仅对方向不一致敏感。\n\n将在单位球面上点 $\\mathbf{h}$ 处的切平面上的正交投影算子定义为 $\\mathbf{P}(\\mathbf{h}) = \\mathbf{I}_{3} - \\mathbf{h} \\mathbf{h}^{\\top}$。考虑残差\n$$\n\\mathbf{r} = \\mathbf{P}(\\mathbf{h}) \\left( \\mathbf{m}^{b} - \\mathbf{h} \\right),\n$$\n并假设在未受干扰的条件下（$\\mathbf{d} = \\mathbf{0}$），该残差可以线性化为\n$$\n\\mathbf{r} \\approx \\mathbf{H} \\, \\delta \\boldsymbol{\\theta} + \\mathbf{w}, \\quad \\text{with} \\quad \\mathbf{H} = - \\mathbf{P}(\\mathbf{h}) [\\mathbf{h}]_{\\times}, \\quad \\mathbf{w} = \\mathbf{P}(\\mathbf{h}) \\mathbf{v}.\n$$\n设未受干扰时的残差协方差为 $\\mathbf{S} = \\mathbf{H} \\mathbf{P}_{\\theta} \\mathbf{H}^{\\top} + \\mathbf{P}(\\mathbf{h}) \\mathbf{R}_{m} \\mathbf{P}(\\mathbf{h})$。由于 $\\mathbf{r}$ 位于二维切平面内，有效残差具有两个自由度。\n\n从基本运动学线性化和高斯残差建模出发，推导一个基于 $\\mathbf{r}$ 的马氏范数（Mahalanobis norm）且符合统计学原理的门限准则。该准则在未受干扰的条件下，应维持 $\\alpha = 0.01$ 的虚警概率（即错误地宣告存在干扰）。你的推导必须证明残差的分布以及门限中所用自由度的数量的合理性。然后，计算马氏统计量（Mahalanobis statistic）对应的门限阈值的数值。将最终答案四舍五入到四位有效数字。以无量纲数的形式表示最终答案。",
            "solution": "问题要求为扩展卡尔曼滤波器（EKF）中的磁力计测量推导一个符合统计学原理的门限准则。目标是计算一个马氏检验统计量（Mahalanobis test statistic）的数值阈值，以确保虚警概率为 $\\alpha = 0.01$。\n\n门限判断过程是一个假设检验。零假设 $H_0$ 是局部磁场环境未受干扰（$\\mathbf{d}=\\mathbf{0}$）。备择假设 $H_1$ 是存在干扰（$\\mathbf{d} \\neq \\mathbf{0}$）。当我们拒绝了为真的 $H_0$ 时，就会发生虚警。此事件的概率用 $\\alpha$ 表示。\n\n在零假设下，测量残差 $\\mathbf{r}$ 被建模为零均值高斯随机向量的线性变换。姿态估计误差为 $\\delta \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{P}_{\\theta})$，磁力计测量噪声为 $\\mathbf{v} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R}_{m})$。线性化的残差为 $\\mathbf{r} \\approx \\mathbf{H} \\, \\delta \\boldsymbol{\\theta} + \\mathbf{w}$，其中 $\\mathbf{H} = - \\mathbf{P}(\\mathbf{h}) [\\mathbf{h}]_{\\times}$ 且 $\\mathbf{w} = \\mathbf{P}(\\mathbf{h}) \\mathbf{v}$。由于高斯随机向量的线性变换结果仍为高斯随机向量，因此在 $H_0$ 下的残差 $\\mathbf{r}$ 是一个零均值高斯随机向量，$\\mathbf{r} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{S})$。协方差矩阵 $\\mathbf{S}$ 由 $\\mathbf{S} = \\mathbf{H} \\mathbf{P}_{\\theta} \\mathbf{H}^{\\top} + \\mathbf{P}(\\mathbf{h}) \\mathbf{R}_{m} \\mathbf{P}(\\mathbf{h})$ 给出。\n\n门限准则基于残差的马氏平方距离（Mahalanobis squared distance），定义为检验统计量 $\\gamma$：\n$$\n\\gamma = \\mathbf{r}^{\\top} \\mathbf{S}^{\\dagger} \\mathbf{r}\n$$\n其中 $\\mathbf{S}^{\\dagger}$ 是协方差矩阵 $\\mathbf{S}$ 的摩尔-彭若斯伪逆（Moore-Penrose pseudoinverse）。\n\n统计学中的一个基本定理指出，如果一个随机向量 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 服从多元正态分布 $\\mathcal{N}(\\mathbf{0}, \\mathbf{\\Sigma})$，其中协方差矩阵 $\\mathbf{\\Sigma}$ 的秩为 $k \\leq n$，那么二次型 $\\mathbf{x}^{\\top} \\mathbf{\\Sigma}^{\\dagger} \\mathbf{x}$ 服从自由度为 $k$ 的卡方分布（chi-squared distribution），记作 $\\chi^{2}(k)$。\n\n为了应用该定理，我们必须确定协方差矩阵 $\\mathbf{S}$ 的秩。残差向量定义为 $\\mathbf{r} = \\mathbf{P}(\\mathbf{h}) (\\mathbf{m}^{b} - \\mathbf{h})$。矩阵 $\\mathbf{P}(\\mathbf{h}) = \\mathbf{I}_{3} - \\mathbf{h} \\mathbf{h}^{\\top}$ 是一个正交投影算子。它的作用是将一个向量投影到与单位向量 $\\mathbf{h}$ 正交的平面上。该平面的维数为 $2$。因此，$\\mathbf{P}(\\mathbf{h})$ 的像空间中的任何向量 $\\mathbf{r}$ 都必须位于这个二维子空间内。这样一个随机向量的协方差矩阵 $\\mathbf{S}$ 将是秩亏的，其秩最多为 $2$。假设来自 $\\mathbf{P}_{\\theta}$ 和 $\\mathbf{R}_{m}$ 的不确定性相对于此平面是非退化的，则 $\\mathbf{S}$ 的秩将恰好为 $2$。问题陈述通过“有效残差具有两个自由度”这句话证实了这一点。因此，检验统计量 $\\gamma$ 服从自由度为 $k=2$ 的卡方分布：\n$$\n\\gamma \\sim \\chi^{2}(2)\n$$\n门限规则是，如果观测到的统计量 $\\gamma$ 超过某个阈值 $\\tau$，则拒绝该测量更新。我们寻求找到 $\\tau$ 的值，使得虚警概率为 $\\alpha = 0.01$。这表示为：\n$$\nP(\\gamma > \\tau | H_0) = \\alpha\n$$\n这等价于找到使 $\\chi^{2}(2)$ 分布的累积分布函数（CDF）等于 $1-\\alpha$ 的 $\\tau$ 值。设 $F_{\\chi^{2}(k)}(x)$ 是自由度为 $k$ 的卡方分布的累积分布函数。我们必须求解方程中的 $\\tau$：\n$$\nF_{\\chi^{2}(2)}(\\tau) = 1 - \\alpha\n$$\n$\\chi^{2}(k)$ 分布的概率密度函数（PDF）为 $f(x;k) = \\frac{1}{2^{k/2} \\Gamma(k/2)} x^{k/2-1} \\exp(-x/2)$。对于 $k=2$，伽马函数项为 $\\Gamma(2/2)=\\Gamma(1)=1$。PDF简化为：\n$$\nf(x;2) = \\frac{1}{2^{1} \\cdot 1} x^{1-1} \\exp(-x/2) = \\frac{1}{2}\\exp(-x/2)\n$$\n这是速率参数 $\\lambda = 1/2$ 的指数分布的PDF。对于 $x \\geq 0$，通过积分求得CDF：\n$$\nF_{\\chi^{2}(2)}(x) = \\int_{0}^{x} \\frac{1}{2}\\exp(-t/2) \\, dt = \\left[ -\\exp(-t/2) \\right]_{0}^{x} = 1 - \\exp(-x/2)\n$$\n现在我们可以求解阈值 $\\tau$：\n$$\n1 - \\exp(-\\tau/2) = 1 - \\alpha\n$$\n$$\n\\exp(-\\tau/2) = \\alpha\n$$\n对两边取自然对数：\n$$\n-\\frac{\\tau}{2} = \\ln(\\alpha)\n$$\n$$\n\\tau = -2 \\ln(\\alpha)\n$$\n代入给定的虚警概率 $\\alpha = 0.01$：\n$$\n\\tau = -2 \\ln(0.01)\n$$\n这可以计算为：\n$$\n\\tau = -2 \\ln(10^{-2}) = -2 (-2 \\ln(10)) = 4 \\ln(10)\n$$\n使用值 $\\ln(10) \\approx 2.30258509...$：\n$$\n\\tau \\approx 4 \\times 2.30258509... \\approx 9.21034037...\n$$\n问题要求将最终答案四舍五入到四位有效数字。得到的门限阈值的无量纲值为 $9.210$。\n因此，门限准则为：如果 $\\mathbf{r}^{\\top} \\mathbf{S}^{\\dagger} \\mathbf{r} > 9.210$，则判断存在干扰并拒绝该磁力计测量。",
            "answer": "$$\n\\boxed{9.210}\n$$"
        }
    ]
}