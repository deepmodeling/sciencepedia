{
    "hands_on_practices": [
        {
            "introduction": "任何测量结果若无其不确定性的定量陈述，则是不完整的。本练习将指导您遵循国际公认的《测量不确定度表示指南》（GUM）框架，处理一个实际的生物力学问题。您将学习如何区分和量化由重复测量产生的A类不确定度分量和通过其他信息评估的B类不确定度分量，并将它们合成为一个扩展不确定度，从而为一个测量值提供一个可靠的置信区间。",
            "id": "4186904",
            "problem": "一个生物力学实验室使用逆动力学方法估算站立中期矢状面内的踝关节跖屈力矩。报告的测量值为样本踝关节力矩均值，记为 $M$，是重复试验的汇总结果。该实验室按如下方式量化不确定度分量，根据标准计量学实践，所有分量均假定为独立且服从正态分布。\n\nA类分量（来自重复取样）：\n- 试验间的踝关节力矩重复性：由 $n_{r} = 12$ 次试验计算得出的样本标准差为 $s_{r} = 5.0$ $\\mathrm{N\\cdot m}$。该分量对样本均值产生不确定度。\n- 会话间的有效踝关节力臂力矩变异性（反映了在力矩输出端汇总的压力中心迁移和建模变异性）：由 $n_{\\ell} = 8$ 次独立会话计算得出的样本标准差为 $s_{\\ell} = 2.4$ $\\mathrm{N\\cdot m}$。该分量对跨会话的样本均值产生不确定度。\n\nB类分量（来自非统计信息，被视为具有有效无限自由度的标准不确定度）：\n- 力矩传感器校准标准不确定度 $u_{\\mathrm{cal}} = 1.2$ $\\mathrm{N\\cdot m}$。\n- 汇总到力矩输出端的模型参数灵敏度贡献 $u_{\\mathrm{mod}} = 0.9$ $\\mathrm{N\\cdot m}$。\n\n假设每个不确定度分量都直接以输出量（踝关节力矩）的单位表示，并且它们的影响是可加的，灵敏度系数为1。在国际标准化组织《测量不确定度表示指南》（ISO GUM）框架下，并假设正态性和独立性，定义包含因子 $k$，通过将合成标准不确定度乘以 $k$，可获得关于 $M$ 的扩展不确定度区间，其包含概率为 $0.95$。\n\n使用基本原理和上述数据：\n1. 解释在此背景下包含因子 $k$ 的作用和定义。\n2. 计算测量踝关节力矩的 $0.95$ 扩展不确定度。将最终数值结果四舍五入至四位有效数字，并以牛顿·米（$\\mathrm{N\\cdot m}$）表示。",
            "solution": "该问题陈述经评估在科学上是合理的、提法得当且无矛盾。应用国际标准化组织《测量不确定度表示指南》（GUM）框架所需的所有数据和条件均已提供。该问题有效。\n\n解题过程按提示要求分为两部分。\n\n**第1部分：包含因子 $k$ 的作用与定义**\n\n在测量科学中，若无对其不确定度的定量陈述，最终结果是不完整的。目标是提供一个以测量结果 $y$ 为中心的包含区间 $[y - U, y + U]$，该区间应能包含可合理赋予被测量量的值的分布的很大一部分。这一部分即为包含概率，本题中指定为 $0.95$。\n\n扩展不确定度 $U$ 是通过将合成标准不确定度 $u_c(y)$ 乘以包含因子 $k$ 得到的：\n$$\nU = k \\cdot u_c(y)\n$$\n合成标准不确定度 $u_c(y)$ 代表输出量 $y$ 的估计标准差。它是根据不确定度传播律，通过合并所有输入量的各个标准不确定度来确定的。\n\n包含因子 $k$ 的作用是将合成标准不确定度放大到一个与期望包含概率相对应的水平。$k$ 的值取决于输出量的概率分布以及与 $u_c(y)$ 估计值相关的有效自由度。\n\n如果所有不确定度分量都完全已知（即具有无限自由度，如对B类不确定度或具有大量测量次数的A类不确定度的假设），根据中心极限定理，输出量的分布可以假定为正态（高斯）分布。在这种情况下， $0.95$ （或 $95\\%$）的包含概率将对应于约 $k \\approx 1.96$ 的包含因子，这是标准正态分布下覆盖 $95\\%$ 面积的z分数。\n\n然而，在本问题中，一些不确定度分量（A类）是根据有限数量的统计观测值（$n_r = 12$ 和 $n_{\\ell} = 8$）估计的。这意味着标准不确定度本身，$u_r$ 和 $u_{\\ell}$，是具有自身不确定度的估计值。因此，合成标准不确定度 $u_c(y)$ 也是一个估计值。标准化被测量量 $(M - \\mu_M) / u_c(M)$（其中 $\\mu_M$ 是真值）的分布，用学生t分布比用正态分布能更好地近似。\n\n合适的t分布由其有效自由度 $\\nu_{\\mathrm{eff}}$ 来表征，该自由度使用Welch-Satterthwaite公式计算。此公式通过每个不确定度分量对总方差贡献的大小，来对该分量的自由度进行加权。\n\n因此，在此背景下，包含因子 $k$ 定义为：对于 $\\nu_{\\mathrm{eff}}$ 的有效自由度，在学生t分布中对应于包含概率 $p=0.95$ 的值。它被记为 $t_{p}(\\nu_{\\mathrm{eff}})$，具体为 $t_{0.95}(\\nu_{\\mathrm{eff}})$。对于双尾区间，该值是通过累积概率为 $1 - (1-p)/2 = 0.975$ 的分位数找到的。使用t分布（因此 $k$ 值大于 1.96）考虑了A类分量有限取样所引入的额外不确定度，从而提供了一个更可靠和保守的包含区间。\n\n**第2部分：扩展不确定度的计算**\n\n计算过程分为四个步骤：\n1.  计算每个分量的标准不确定度 $u_i$ 及其对应的自由度 $\\nu_i$。\n2.  通过对各方差求和来计算合成标准不确定度 $u_c$。\n3.  使用Welch-Satterthwaite公式计算有效自由度 $\\nu_{\\mathrm{eff}}$。\n4.  根据 $0.95$ 的包含概率和 $\\nu_{\\mathrm{eff}}$，从t分布中确定包含因子 $k$，然后计算扩展不确定度 $U = k \\cdot u_c$。\n\n**步骤1：标准不确定度与自由度**\n\n对于A类分量，均值的标准不确定度由 $u = s / \\sqrt{n}$ 给出，其自由度为 $\\nu = n-1$。\n\n- 试验间的重复性：\n  - 标准不确定度： $u_r = \\frac{s_r}{\\sqrt{n_r}} = \\frac{5.0}{\\sqrt{12}} \\, \\mathrm{N\\cdot m}$\n  - 自由度： $\\nu_r = n_r - 1 = 12 - 1 = 11$\n- 会话间的变异性：\n  - 标准不确定度： $u_{\\ell} = \\frac{s_{\\ell}}{\\sqrt{n_{\\ell}}} = \\frac{2.4}{\\sqrt{8}} \\, \\mathrm{N\\cdot m}$\n  - 自由度： $\\nu_{\\ell} = n_{\\ell} - 1 = 8 - 1 = 7$\n\n对于B类分量，标准不确定度是直接给出的，其自由度被视为无限大。\n\n- 力矩传感器校准：\n  - 标准不确定度： $u_{\\mathrm{cal}} = 1.2 \\, \\mathrm{N\\cdot m}$\n  - 自由度： $\\nu_{\\mathrm{cal}} = \\infty$\n- 模型参数灵敏度：\n  - 标准不确定度： $u_{\\mathrm{mod}} = 0.9 \\, \\mathrm{N\\cdot m}$\n  - 自由度： $\\nu_{\\mathrm{mod}} = \\infty$\n\n**步骤2：合成标准不确定度**\n\n由于各分量是独立的，合成方差 $u_c^2$ 是各独立方差之和。\n$$\nu_c^2 = u_r^2 + u_{\\ell}^2 + u_{\\mathrm{cal}}^2 + u_{\\mathrm{mod}}^2\n$$\n$$\nu_c^2 = \\left(\\frac{5.0}{\\sqrt{12}}\\right)^2 + \\left(\\frac{2.4}{\\sqrt{8}}\\right)^2 + (1.2)^2 + (0.9)^2\n$$\n$$\nu_c^2 = \\frac{25.0}{12} + \\frac{5.76}{8} + 1.44 + 0.81\n$$\n$$\nu_c^2 = 2.08333... + 0.72 + 1.44 + 0.81 = 5.05333... \\, (\\mathrm{N\\cdot m})^2\n$$\n合成标准不确定度是该值的平方根：\n$$\nu_c = \\sqrt{5.05333...} \\approx 2.24796 \\, \\mathrm{N\\cdot m}\n$$\n\n**步骤3：有效自由度**\n\nWelch-Satterthwaite公式为：\n$$\n\\nu_{\\mathrm{eff}} = \\frac{u_c^4}{\\sum_{i=1}^{N} \\frac{u_i^4}{\\nu_i}} = \\frac{u_c^4}{\\frac{u_r^4}{\\nu_r} + \\frac{u_{\\ell}^4}{\\nu_{\\ell}} + \\frac{u_{\\mathrm{cal}}^4}{\\nu_{\\mathrm{cal}}} + \\frac{u_{\\mathrm{mod}}^4}{\\nu_{\\mathrm{mod}}}}\n$$\nB类分量的项具有 $\\nu_i = \\infty$，因此它们对分母的贡献为零。\n$$\n\\nu_{\\mathrm{eff}} = \\frac{u_c^4}{\\frac{u_r^4}{\\nu_r} + \\frac{u_{\\ell}^4}{\\nu_{\\ell}}}\n$$\n我们需要不确定度的四次方：\n- $u_c^4 = (5.05333...)^2 \\approx 25.53617 \\, (\\mathrm{N\\cdot m})^4$\n- $u_r^4 = (u_r^2)^2 = (2.08333...)^2 \\approx 4.340278 \\, (\\mathrm{N\\cdot m})^4$\n- $u_{\\ell}^4 = (u_{\\ell}^2)^2 = (0.72)^2 = 0.5184 \\, (\\mathrm{N\\cdot m})^4$\n\n现在，将这些值代入公式中：\n$$\n\\nu_{\\mathrm{eff}} = \\frac{25.53617}{\\frac{4.340278}{11} + \\frac{0.5184}{7}} = \\frac{25.53617}{0.3945707... + 0.0740571...} = \\frac{25.53617}{0.4686278...} \\approx 54.49\n$$\n根据GUM，将 $\\nu_{\\mathrm{eff}}$ 截断为整数是谨慎的做法，因此我们使用 $\\nu_{\\mathrm{eff}} = 54$。\n\n**步骤4：包含因子和扩展不确定度**\n\n我们需要找到双尾区间的包含因子 $k = t_{0.95}(54)$，它对应于自由度为 $54$ 的t分布的 $0.975$ 分位数。使用标准统计表或软件，该值为：\n$$\nk = t_{0.975, 54} \\approx 2.00488\n$$\n最后，计算扩展不确定度 $U$：\n$$\nU = k \\cdot u_c \\approx 2.00488 \\times 2.24796 \\, \\mathrm{N\\cdot m} \\approx 4.50682 \\, \\mathrm{N\\cdot m}\n$$\n按要求将最终结果四舍五入至四位有效数字：\n$$\nU \\approx 4.507 \\, \\mathrm{N\\cdot m}\n$$\n这就是所测量的踝关节力矩的 $0.95$ 扩展不确定度。",
            "answer": "$$\n\\boxed{4.507}\n$$"
        },
        {
            "introduction": "在生物力学中，许多关键变量并非直接测量，而是通过其他测量值计算得出，这可能导致误差的放大。本练习聚焦于一个典型挑战：当垂直地面反作用力 $F_z$ 接近于零时，压力中心（COP）的计算会变得极不稳定。通过此练习，您将定量分析这种不稳定性，并批判性地评估各种计算策略的优劣，以确保在低负载阶段也能获得鲁棒且具有物理意义的结果。",
            "id": "4186900",
            "problem": "一块刚性平板测力台在人体行走过程中测量地面反作用力 (GRF) 矢量 $\\mathbf{F}=(F_x,F_y,F_z)$ 和绕其原点的合力矩矢量 $\\mathbf{M}=(M_x,M_y,M_z)$。压力中心 (COP) 定义为 GRF 的作用线与测力台平面相交的点。假设 GRF 作用于测力台上的一点 $\\mathbf{r}=(p_x,p_y,0)$，测力台平面为 $z=0$，且测力台报告的 $\\mathbf{M}$ 和 $\\mathbf{F}$ 的每个分量都带有附加的、零均值、独立的 高斯噪声。给定以下真实的测量特性和任务背景：\n- 在站立中期，平均垂直力为 $\\mu_{F_z}\\approx 700\\,\\mathrm{N}$，标准差为 $\\sigma_{F_z}\\approx 5\\,\\mathrm{N}$。典型的水平力矩为 $\\mu_{M_x}\\approx 25\\,\\mathrm{N\\cdot m}$，$\\mu_{M_y}\\approx 25\\,\\mathrm{N\\cdot m}$，标准差为 $\\sigma_{M_x}\\approx 2\\,\\mathrm{N\\cdot m}$，$\\sigma_{M_y}\\approx 2\\,\\mathrm{N\\cdot m}$。\n- 在站立后期接近足尖离地时，平均垂直力下降至 $\\mu_{F_z}\\approx 10\\,\\mathrm{N}$，而力矩噪声的量级保持不变。\n- 通过校准可知，足部在测力台上的接触多边形为一个近似矩形，在测力台坐标系中的长度为 $0.24\\,\\mathrm{m}$，宽度为 $0.09\\,\\mathrm{m}$。\n\n从牛顿定律和力矩定义 $\\mathbf{M}=\\mathbf{r}\\times \\mathbf{F}$ 出发，定性和定量地推导为何当 $|F_z|\\to 0$ 时，COP 的估计对 $F_z$ 极其敏感。在独立性假设下，使用关于 $(\\mu_{M_y},\\mu_{F_z})$ 的一阶不确定性传播，获得 $\\mathrm{Var}(p_x)$ 的近似值，并评估其在上述站立中期和足尖离地阶段的量级。解释当分母 $F_z$ 接近或低于噪声水平时，对偏差、方差和异常值风险的影响。然后，从以下策略中选择所有理论上合理的方法，以便在 $|F_z|$ 很小或存在间歇性接触丢失的阶段，产生物理上可信且鲁棒的 COP 估计。\n\n在低负载阶段，以下哪些策略是适用且鲁棒的？选择所有适用项。\n\nA. 对 $|F_z|$ 使用自适应阈值 $\\epsilon=3\\sigma_{F_z}$；当 $|F_z|\\epsilon$ 时，从直接比率计算切换到约束估计器，该估计器通过最小化 $\\|\\mathbf{M}-\\mathbf{r}\\times \\mathbf{F}\\|^2+\\lambda\\|\\mathbf{r}\\|^2$ 来求解 $\\mathbf{r}$，其中使用 Tikhonov 正则化，并约束 $(p_x,p_y)$ 位于已知的足部接触多边形内。根据测量的噪声水平选择 $\\lambda$，使得当 $|F_z|$ 减小时，正则化项占主导地位。\n\nB. 无论 $|F_z|$ 大小，始终通过力矩比率计算 COP，然后对 COP 时间序列应用强低通滤波器以消除低负载期间的尖峰；即使当 COP 跳出足部多边形时也保留估计值，因为滤波器会抑制这些偏移。\n\nC. 在 COP 比率计算中，用总力的大小 $\\|\\mathbf{F}\\|$ 替换垂直力 $F_z$，以避免除以接近零的值，从而保持数值稳定性。\n\nD. 建立一个状态空间模型，其中 COP 在足部表面上根据足部运动学信息演化并带有过程噪声，并使用卡尔曼滤波器 (KF)；该滤波器随着 $|F_z|$ 的减小而增大 COP 观测值的测量协方差，从而在垂直载荷较小时降低测力台比率的权重，并强制执行接触约束。\n\nE. 当 $|F_z|$ 很小时，将 COP 设置为等于身体总质心的地面投影，以近似零力矩点 (ZMP)，无论足部是否接触地面，以确保估计的稳定性。\n\nF. 使用与 $(|F_z|/\\sigma_{F_z})^2$ 成正比的贝叶斯加权，将测力台估计值与带有仪器的鞋垫压力推导出的 COP 进行融合，并将融合后的 COP 硬裁剪到校准的足部接触多边形内；当 $|F_z|3\\sigma_{F_z}$ 时，主要依赖鞋垫和运动学约束，而非测力台比率。\n\nG. 如果 $|F_z|$ 低于阈值，则将 COP 设置为测力台坐标系的原点，直到负载再次增加，以避免除以小数。\n\n通过选择所有正确选项来回答。",
            "solution": "首先验证问题陈述，以确保其在科学上是合理的、良态的且客观的。\n\n**第 1 步：提取已知条件**\n- 地面反作用力矢量为 $\\mathbf{F}=(F_x,F_y,F_z)$，绕测力台原点的合力矩矢量为 $\\mathbf{M}=(M_x,M_y,M_z)$。\n- 压力中心 (COP) $\\mathbf{r}=(p_x,p_y,0)$ 是 $\\mathbf{F}$ 的作用线与测力台平面 $z=0$ 的交点。\n- 控制方程为 $\\mathbf{M}=\\mathbf{r}\\times \\mathbf{F}$。\n- $\\mathbf{F}$ 和 $\\mathbf{M}$ 各分量的测量噪声是附加的、零均值、独立的高斯噪声。\n- 站立中期特性：$\\mu_{F_z}\\approx 700\\,\\mathrm{N}$，$\\sigma_{F_z}\\approx 5\\,\\mathrm{N}$，$\\mu_{M_x}\\approx 25\\,\\mathrm{N\\cdot m}$，$\\sigma_{M_x}\\approx 2\\,\\mathrm{N\\cdot m}$，$\\mu_{M_y}\\approx 25\\,\\mathrm{N\\cdot m}$，$\\sigma_{M_y}\\approx 2\\,\\mathrm{N\\cdot m}$。\n- 足尖离地特性：$\\mu_{F_z}\\approx 10\\,\\mathrm{N}$，力矩噪声量级（$\\sigma_{M_x}$，$\\sigma_{M_y}$）保持不变。\n- 足部接触多边形是一个近似矩形，尺寸为 $0.24\\,\\mathrm{m} \\times 0.09\\,\\mathrm{m}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：问题基于牛顿刚体动力学定律（$\\mathbf{M}=\\mathbf{r}\\times \\mathbf{F}$）和生物力学中的标准定义（COP、GRF）。数值对于人体步态分析是现实的。噪声模型是信号处理中的标准假设。\n- **良态性**：问题提供了明确的目标和足够的信息来推导 COP 方程并分析其不确定性。核心任务是分析当垂直力很小时 COP 计算的病态性质，这是生物力学中一个有效且重要的话题。\n- **客观性**：问题以精确的技术语言陈述，没有主观性。\n\n**第 3 步：结论与行动**\n问题是有效的。将继续进行求解过程。\n\n**压力中心 (COP) 方程的推导**\n绕原点的力矩 $\\mathbf{M}$ 定义为力作用点的位置矢量 $\\mathbf{r}$ 与力矢量 $\\mathbf{F}$ 的叉积。给定 $\\mathbf{r}=(p_x,p_y,0)$ 和 $\\mathbf{F}=(F_x,F_y,F_z)$，叉积为：\n$$ \\mathbf{M} = \\mathbf{r} \\times \\mathbf{F} = \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ p_x  p_y  0 \\\\ F_x  F_y  F_z \\end{vmatrix} = (p_y F_z)\\mathbf{i} - (p_x F_z)\\mathbf{j} + (p_x F_y - p_y F_x)\\mathbf{k} $$\n通过令矢量方程 $\\mathbf{M}=(M_x,M_y,M_z)$ 的各分量相等，我们得到：\n$M_x = p_y F_z$\n$M_y = -p_x F_z$\n$M_z = p_x F_y - p_y F_x$\n\n求解前两个方程得到 COP 坐标 $p_x$ 和 $p_y$：\n$$ p_x = -\\frac{M_y}{F_z} $$\n$$ p_y = \\frac{M_x}{F_z} $$\n\n**定性和定量敏感性分析**\n这些方程表明，COP 坐标与垂直力分量 $F_z$ 成反比。定性地看，当 $|F_z| \\to 0$ 时，任何非零力矩（$M_x, M_y$）或测量中的任何噪声都会导致计算出的 COP 坐标发散到无穷大。估计变得不稳定，并且对测量噪声极其敏感。\n\n定量地，我们使用一阶不确定性传播来近似 $p_x$ 的方差。函数为 $p_x(M_y, F_z) = -M_y/F_z$。假设 $M_y$ 和 $F_z$ 的测量是独立的，则 $p_x$ 的方差近似为：\n$$ \\mathrm{Var}(p_x) \\approx \\left( \\frac{\\partial p_x}{\\partial M_y} \\right)^2_{\\mu} \\mathrm{Var}(M_y) + \\left( \\frac{\\partial p_x}{\\partial F_z} \\right)^2_{\\mu} \\mathrm{Var}(F_z) $$\n在均值 $(\\mu_{M_y}, \\mu_{F_z})$ 处求得的偏导数为：\n$$ \\frac{\\partial p_x}{\\partial M_y} = -\\frac{1}{F_z} \\implies \\left(\\frac{\\partial p_x}{\\partial M_y}\\right)_{\\mu} = -\\frac{1}{\\mu_{F_z}} $$\n$$ \\frac{\\partial p_x}{\\partial F_z} = \\frac{M_y}{F_z^2} \\implies \\left(\\frac{\\partial p_x}{\\partial F_z}\\right)_{\\mu} = \\frac{\\mu_{M_y}}{\\mu_{F_z}^2} $$\n将这些代入方差公式，其中 $\\mathrm{Var}(M_y) = \\sigma_{M_y}^2$ 和 $\\mathrm{Var}(F_z) = \\sigma_{F_z}^2$：\n$$ \\mathrm{Var}(p_x) \\approx \\frac{\\sigma_{M_y}^2}{\\mu_{F_z}^2} + \\frac{\\mu_{M_y}^2 \\sigma_{F_z}^2}{\\mu_{F_z}^4} = \\frac{1}{\\mu_{F_z}^2} \\left( \\sigma_{M_y}^2 + \\frac{\\mu_{M_y}^2}{\\mu_{F_z}^2} \\sigma_{F_z}^2 \\right) $$\n\n**在站立中期和足尖离地阶段的评估**\n\n1.  **站立中期：**\n    给定 $\\mu_{F_z} = 700\\,\\mathrm{N}$，$\\sigma_{F_z} = 5\\,\\mathrm{N}$，$\\mu_{M_y} = 25\\,\\mathrm{N\\cdot m}$，以及 $\\sigma_{M_y} = 2\\,\\mathrm{N\\cdot m}$。\n    $$ \\mathrm{Var}(p_x) \\approx \\frac{1}{(700)^2} \\left( (2)^2 + \\frac{(25)^2}{(700)^2} (5)^2 \\right) = \\frac{1}{490000} \\left( 4 + \\frac{625 \\cdot 25}{490000} \\right) \\approx \\frac{4.032}{490000} \\approx 8.23 \\times 10^{-6}\\,\\mathrm{m}^2 $$\n    标准差为 $\\sigma_{p_x} = \\sqrt{\\mathrm{Var}(p_x)} \\approx 2.87\\,\\mathrm{mm}$。这代表一个非常精确的估计。\n\n2.  **足尖离地：**\n    给定 $\\mu_{F_z} = 10\\,\\mathrm{N}$，$\\sigma_{F_z} = 5\\,\\mathrm{N}$，$\\sigma_{M_y} = 2\\,\\mathrm{N\\cdot m}$。平均力矩 $\\mu_{M_y}$ 也会很小。一个合理的 COP 位置 $p_x = -0.1\\,\\mathrm{m}$ 将意味着 $\\mu_{M_y} = -\\mu_{p_x} \\mu_{F_z} = -(-0.1\\,\\mathrm{m})(10\\,\\mathrm{N}) = 1\\,\\mathrm{N\\cdot m}$。我们使用这个物理上一致的值。\n    $$ \\mathrm{Var}(p_x) \\approx \\frac{1}{(10)^2} \\left( (2)^2 + \\frac{(1)^2}{(10)^2} (5)^2 \\right) = \\frac{1}{100} \\left( 4 + \\frac{25}{100} \\right) = \\frac{4.25}{100} = 0.0425\\,\\mathrm{m}^2 $$\n    标准差为 $\\sigma_{p_x} = \\sqrt{\\mathrm{Var}(p_x)} \\approx 0.206\\,\\mathrm{m}$ 或 $20.6\\,\\mathrm{cm}$。这个不确定性是巨大的，几乎等于足部接触多边形的全长（$0.24\\,\\mathrm{m}$）。\n\n**对偏差、方差和异常值风险的影响**\n- **方差：** 如上所示，方差随着 $\\mu_{F_z}$ 的减小而急剧增长，其尺度在 $1/\\mu_{F_z}^2$ 和 $1/\\mu_{F_z}^4$ 之间。\n- **偏差：** 比率估计器 $p_x = -M_y/F_z$ 是内在有偏的。偏差可以通过二阶展开来近似，并且也以 $1/\\mu_{F_z}^2$ 的比例增长，当 $F_z$ 很小时变得显著。\n- **异常值风险：** 由于 $F_z$ 是一个均值为 $\\mu_{F_z}=10\\,\\mathrm{N}$、标准差为 $\\sigma_{F_z}=5\\,\\mathrm{N}$ 的高斯随机变量，因此观察到 $F_z  \\mu_{F_z} - 2\\sigma_{F_z} = 0\\,\\mathrm{N}$ 的概率不可忽略（约 $2.3\\%$）。任何接近零的 $F_z$ 样本都会在 COP 计算中产生灾难性的异常值。因此，直接比率计算是病态的，在低负载阶段不可用。\n\n**对所提策略的评估**\n\n**A. 对 $|F_z|$ 使用自适应阈值 $\\epsilon=3\\sigma_{F_z}$；当 $|F_z|\\epsilon$ 时，从直接比率计算切换到约束估计器，该估计器通过最小化 $\\|\\mathbf{M}-\\mathbf{r}\\times \\mathbf{F}\\|^2+\\lambda\\|\\mathbf{r}\\|^2$ 来求解 $\\mathbf{r}$，其中使用 Tikhonov 正则化，并约束 $(p_x,p_y)$ 位于已知的足部接触多边形内。根据测量的噪声水平选择 $\\lambda$，使得当 $|F_z|$ 减小时，正则化项占主导地位。**\n此策略理论上是合理的。它正确地使用基于信噪比的阈值识别了病态区域。然后切换到一种有原则的方法来解决病态反问题。最小二乘项 $\\|\\mathbf{M}-\\mathbf{r}\\times \\mathbf{F}\\|^2$ 寻求与物理一致的解。Tikhonov 正则化项 $\\lambda\\|\\mathbf{r}\\|^2$ 通过惩罚大的、非物理的 COP 值来稳定解。对 COP 位置的物理约束进一步确保了可信的结果。选择 $\\lambda$ 以便在 $|F_z|$ 减小时增加正则化效应是正确的方法。**正确**。\n\n**B. 无论 $|F_z|$ 大小，始终通过力矩比率计算 COP，然后对 COP 时间序列应用强低通滤波器以消除低负载期间的尖峰；即使当 COP 跳出足部多边形时也保留估计值，因为滤波器会抑制这些偏移。**\n此策略根本上是错误的。它首先计算一个充满极端异常值的垃圾信号，然后试图用低通滤波器来清理它。线性滤波器对这类异常值无效；它们倾向于涂抹误差，从而破坏相邻的有效数据点。保留物理上不可能的估计是不好的做法。问题必须在估计的源头解决，而不是事后用滤波器处理。**错误**。\n\n**C. 在 COP 比率计算中，用总力的大小 $\\|\\mathbf{F}\\|$ 替换垂直力 $F_z$，以避免除以接近零的值，从而保持数值稳定性。**\n此策略以牺牲物理准确性为代价来实现数值稳定性。方程 $p_x = -M_y/F_z$ 和 $p_y = M_x/F_z$ 是定义 $\\mathbf{M}=\\mathbf{r}\\times\\mathbf{F}$ 的直接结果。用 $\\|\\mathbf{F}\\| = \\sqrt{F_x^2+F_y^2+F_z^2}$ 替换 $F_z$ 是一种没有物理依据的临时修改。它产生的结果不是真正的压力中心，除非水平力 $F_x$ 和 $F_y$ 都为零，而这并非普遍情况。因此，它在理论上是不合理的。**错误**。\n\n**D. 建立一个状态空间模型，其中 COP 在足部表面上根据足部运动学信息演化并带有过程噪声，并使用卡尔曼滤波器 (KF)；该滤波器随着 $|F_z|$ 的减小而增大 COP 观测值的测量协方差，从而在垂直载荷较小时降低测力台比率的权重，并强制执行接触约束。**\n此策略代表了一种复杂且理论上鲁棒的方法。卡尔曼滤波器是融合动态模型（过程模型）与带噪声测量值的最佳工具。通过正确地对测量不确定性建模（当 $|F_z|$ 小时增大协方差），KF 将自动且最优地忽略不可靠的基于比率的 COP 估计，而更多地依赖其自身根据过程模型的预测。过程模型本身包含了关于 COP 如何移动的物理知识。这是一种标准且高效的技术。**正确**。\n\n**E. 当 $|F_z|$ 很小时，将 COP 设置为等于身体总质心的地面投影，以近似零力矩点 (ZMP)，无论足部是否接触地面，以确保估计的稳定性。**\n此策略理论上不合理，因为它混淆了不同的物理概念。压力中心 (COP)、零力矩点 (ZMP) 和投影的质心 (CoM) 并不相同，尤其是在动态运动中。虽然在特定条件下（平坦地面，无扭转），ZMP 和 COP 相等，但 ZMP 通常不等于投影的 CoM。使用投影的 CoM 作为 COP 的替代品会引入一种基于模型的偏差，可能无法反映接触的实际力学。例如，在足尖离地时，COP 位于足部前端，而 CoM 则向前移动越过足部。**错误**。\n\n**F. 使用与 $(|F_z|/\\sigma_{F_z})^2$ 成正比的贝叶斯加权，将测力台估计值与带有仪器的鞋垫压力推导出的 COP 进行融合，并将融合后的 COP 硬裁剪到校准的足部接触多边形内；当 $|F_z|3\\sigma_{F_z}$ 时，主要依赖鞋垫和运动学约束，而非测力台比率。**\n此策略是合理的传感器融合的一个极好例子。它将测力台数据与来自带有仪器的鞋垫的独立测量相结合。贝叶斯加权方案是有原则的：它根据每个来源的精度（方差的倒数）对其进行加权。正如我们所推导的，$\\mathrm{Var}(COP) \\propto 1/F_z^2$，因此精度与 $F_z^2$ 成正比。所提出的与 $(|F_z|/\\sigma_{F_z})^2 \\propto F_z^2$ 成正比的加权正确地反映了这一点，使得估计器在负载高时信任测力台，在负载低时信任鞋垫。裁剪到足部多边形强制执行了物理约束。**正确**。\n\n**G. 如果 $|F_z|$ 低于阈值，则将 COP 设置为测力台坐标系的原点，直到负载再次增加，以避免除以小数。**\n此策略是幼稚的，并引入了显著的偏差。虽然它避免了除以零，但它用一个任意常数（测力台原点）替换了真实的 COP 值。在低负载阶段，真实的 COP 并不在测力台原点；在足尖离地时，它位于足部的前端。此方法将数值便利性置于物理意义之上，并产生系统性错误的结果。**错误**。",
            "answer": "$$\\boxed{ADF}$$"
        },
        {
            "introduction": "除了数据驱动的不稳定性，误差也可能源于我们用来描述物理世界的数学模型本身的特性。本练习探讨了使用惯性测量单元（IMU）和欧拉角进行方向估计的挑战，特别是万向节死锁（gimbal lock）现象。您将从第一性原理出发，推导陀螺仪的噪声如何传播到姿态角误差中，并揭示在特定姿态（奇点）下，数学表示的失效如何导致误差被无限放大。",
            "id": "4186897",
            "problem": "一个人的小腿节段上安装有一个惯性测量单元 (IMU)，其三轴陀螺仪报告体坐标系下的角速度分量 $\\,\\omega_{x}(t), \\omega_{y}(t), \\omega_{z}(t)\\,$。该节段相对于一个固定的实验室坐标系的方向由 $Z\\!Y\\!X$ 欧拉角 $(\\psi(t), \\theta(t), \\phi(t))$ 参数化，其中 $\\,\\psi\\,$ 是偏航角，$\\,\\theta\\,$ 是俯仰角，$\\,\\phi\\,$ 是滚转角，旋转的合成为 $\\,R(\\psi,\\theta,\\phi) = R_{z}(\\psi)\\,R_{y}(\\theta)\\,R_{x}(\\phi)\\,$。在步态的一个准静态阶段，假设在一个持续时间 $\\,T  0\\,$ 内，$\\,\\phi(t) \\equiv \\phi_{0}\\,$ 和 $\\,\\theta(t) \\equiv \\theta_{0}\\,$ 是常数，而 $\\,\\psi(t)\\,$ 可能会变化。陀螺仪的测量值受到独立的、零均值的白高斯噪声 $\\,\\eta(t) = [\\eta_{x}(t), \\eta_{y}(t), \\eta_{z}(t)]^{\\top}\\,$ 的干扰，其单边功率谱密度为 $\\,S_{x}, S_{y}, S_{z}\\,$（单位 $\\mathrm{rad}^{2}\\!/\\mathrm{s}$），因此 $\\,\\mathbb{E}[\\eta(t)] = 0\\,$ 且 $\\,\\mathbb{E}[\\eta(t)\\,\\eta(t')^{\\top}] = \\mathrm{diag}(S_{x}, S_{y}, S_{z})\\,\\delta(t-t')\\,$。初始偏航角 $\\,\\psi(0)\\,$ 是精确已知的。\n\n从刚体运动学基本原理和 $Z\\!Y\\!X$ 欧拉角的定义出发，推导体坐标系角速度与欧拉角速率之间的局部映射关系，并利用该关系，在所述假设下对偏航角 $\\,\\psi(t)\\,$进行一阶不确定性传播。然后，将 $\\,\\phi_{0}\\,$ 和 $\\,\\theta_{0}\\,$ 视为常数，并使用连续时间白噪声积分，得到仅由陀螺仪噪声引起的方差 $\\,\\mathrm{Var}[\\psi(T)]\\,$ 的闭式表达式。您的推导必须明确显示出对与万向节死锁相关的奇异构型的敏感性。最终方差以 $\\mathrm{rad}^{2}$ 为单位表示。不需要数值；请提供一个关于 $\\,S_{y}, S_{z}, \\phi_{0}, \\theta_{0}, T\\,$ 的 $\\,\\mathrm{Var}[\\psi(T)]\\,$ 的单一闭式解析表达式。除了基本定义和经过充分验证的运动学恒等式外，不要使用任何快捷公式，并且不要假设 $\\,S_{y} = S_{z}\\,$。最终答案必须是单一的解析表达式。",
            "solution": "该问题要求推导偏航角的方差 $\\mathrm{Var}[\\psi(T)]$，该刚体的方向由 $Z\\!Y\\!X$ 欧拉角描述，其角速度由带噪声的陀螺仪测量。推导将从刚体运动学和连续时间随机过程理论的第一性原理出发。\n\n首先，我们建立体坐标系角速度矢量 $\\boldsymbol{\\omega}(t) = [\\omega_x(t), \\omega_y(t), \\omega_z(t)]^{\\top}$ 与欧拉角时间导数 $\\dot{\\boldsymbol{\\alpha}}(t) = [\\dot{\\phi}(t), \\dot{\\theta}(t), \\dot{\\psi}(t)]^{\\top}$ 之间的运动学关系。方向由旋转矩阵 $R(\\psi,\\theta,\\phi) = R_{z}(\\psi)\\,R_{y}(\\theta)\\,R_{x}(\\phi)$ 给出，对应于一个内旋的 $Z\\!Y\\!X$ 旋转序列。体坐标系中的总角速度矢量是每个欧拉角速率贡献的总和，这些贡献在最终的体坐标系中表示。\n1.  滚转速率 $\\dot{\\phi}$ 是围绕体坐标系的 $x$ 轴。它对 $\\boldsymbol{\\omega}$ 的贡献是 $[\\dot{\\phi}, 0, 0]^{\\top}$。\n2.  俯仰速率 $\\dot{\\theta}$ 是围绕中间的 $y'$ 轴。该轴通过最终旋转的逆，$R_x(\\phi)^{-1}$，与体坐标系相关联。它对 $\\boldsymbol{\\omega}$ 的贡献是 $\\dot{\\theta} R_x(-\\phi) [0, 1, 0]^{\\top} = \\dot{\\theta} [0, \\cos\\phi, -\\sin\\phi]^{\\top}$。\n3.  偏航速率 $\\dot{\\psi}$ 是围绕初始的 $z$ 轴。该轴通过总旋转的逆，$(R_y(\\theta)R_x(\\phi))^{-1} = R_x(-\\phi)R_y(-\\theta)$，与体坐标系相关联。它对 $\\boldsymbol{\\omega}$ 的贡献是 $\\dot{\\psi} R_x(-\\phi)R_y(-\\theta) [0, 0, 1]^{\\top} = \\dot{\\psi} [-\\sin\\theta, \\cos\\theta\\sin\\phi, \\cos\\theta\\cos\\phi]^{\\top}$。\n\n将这些贡献相加，得到完整的运动学微分方程：\n$$\n\\begin{pmatrix} \\omega_x \\\\ \\omega_y \\\\ \\omega_z \\end{pmatrix} = \n\\begin{pmatrix} 1  0  -\\sin\\theta \\\\ 0  \\cos\\phi  \\cos\\theta\\sin\\phi \\\\ 0  -\\sin\\phi  \\cos\\theta\\cos\\phi \\end{pmatrix} \n\\begin{pmatrix} \\dot{\\phi} \\\\ \\dot{\\theta} \\\\ \\dot{\\psi} \\end{pmatrix}\n$$\n该方程的形式为 $\\boldsymbol{\\omega} = \\mathbf{W}(\\phi, \\theta) \\dot{\\boldsymbol{\\alpha}}$。为了从角速度测量中求出欧拉角速率，我们必须对矩阵 $\\mathbf{W}(\\phi, \\theta)$ 求逆。矩阵 $\\mathbf{W}$ 的行列式是 $\\det(\\mathbf{W}) = \\cos\\theta$。当 $\\cos\\theta = 0$，即 $\\theta = \\pm \\pi/2$ 时，该矩阵变为奇异矩阵。这种情况被称为万向节死锁，此时偏航和滚转的旋转轴变得对齐，导致方向表示中损失一个自由度。正如题目所要求，这个奇点是问题的一个关键方面。\n\n逆矩阵 $\\mathbf{W}^{-1}$ 是：\n$$\n\\mathbf{W}^{-1}(\\phi, \\theta) = \\frac{1}{\\cos\\theta} \n\\begin{pmatrix} \\cos\\theta  \\sin\\theta\\sin\\phi  \\sin\\theta\\cos\\phi \\\\ 0  \\cos\\theta\\cos\\phi  -\\cos\\theta\\sin\\phi \\\\ 0  \\sin\\phi  \\cos\\phi \\end{pmatrix}\n=\n\\begin{pmatrix} 1  \\tan\\theta\\sin\\phi  \\tan\\theta\\cos\\phi \\\\ 0  \\cos\\phi  -\\sin\\phi \\\\ 0  \\sec\\theta\\sin\\phi  \\sec\\theta\\cos\\phi \\end{pmatrix}\n$$\n因此，欧拉角速率的关系是 $\\dot{\\boldsymbol{\\alpha}} = \\mathbf{W}^{-1} \\boldsymbol{\\omega}$。陀螺仪测量的是带噪声的角速度 $\\boldsymbol{\\omega}_{\\text{meas}}(t) = \\boldsymbol{\\omega}_{\\text{true}}(t) + \\boldsymbol{\\eta}(t)$，其中 $\\boldsymbol{\\eta}(t)$ 是零均值白高斯噪声。\n\n问题陈述，在区间 $[0, T]$ 内，该节段处于准静态阶段，其中 $\\phi(t) = \\phi_0$ 和 $\\theta(t) = \\theta_0$ 是常数。这意味着真实的欧拉角速率是 $\\dot{\\phi}_{\\text{true}} = 0$ 和 $\\dot{\\theta}_{\\text{true}} = 0$。测量的欧拉角速率 $\\dot{\\boldsymbol{\\alpha}}_{\\text{meas}}$ 是使用带噪声的测量值计算的：\n$$\n\\dot{\\boldsymbol{\\alpha}}_{\\text{meas}} = \\mathbf{W}^{-1}(\\phi_0, \\theta_0) (\\boldsymbol{\\omega}_{\\text{true}} + \\boldsymbol{\\eta}(t)) = \\mathbf{W}^{-1}(\\phi_0, \\theta_0) \\boldsymbol{\\omega}_{\\text{true}} + \\mathbf{W}^{-1}(\\phi_0, \\theta_0) \\boldsymbol{\\eta}(t)\n$$\n由于 $\\dot{\\boldsymbol{\\alpha}}_{\\text{true}} = [0, 0, \\dot{\\psi}_{\\text{true}}]^{\\top}$，项 $\\mathbf{W}^{-1}\\boldsymbol{\\omega}_{\\text{true}}$ 可解析为 $\\dot{\\boldsymbol{\\alpha}}_{\\text{true}}$。因此，计算出的欧拉角速率的误差纯粹是噪声的函数：\n$$\n\\dot{\\boldsymbol{\\alpha}}_{\\text{err}}(t) = \\dot{\\boldsymbol{\\alpha}}_{\\text{meas}}(t) - \\dot{\\boldsymbol{\\alpha}}_{\\text{true}}(t) = \\mathbf{W}^{-1}(\\phi_0, \\theta_0) \\boldsymbol{\\eta}(t)\n$$\n我们关心的是偏航角 $\\psi(T)$ 的方差。偏航速率的误差 $\\dot{\\psi}_{\\text{err}}(t)$ 由矩阵-向量乘积 $\\mathbf{W}^{-1}\\boldsymbol{\\eta}(t)$ 的第三行给出：\n$$\n\\dot{\\psi}_{\\text{err}}(t) = \\left( \\sec\\theta_0 \\sin\\phi_0 \\right) \\eta_y(t) + \\left( \\sec\\theta_0 \\cos\\phi_0 \\right) \\eta_z(t)\n$$\n请注意，偏航速率误差与噪声分量 $\\eta_x(t)$ 无关。在时间 $T$ 时的偏航角总误差，记为 $\\psi_{\\text{err}}(T)$，是偏航速率误差的时间积分。由于初始偏航角 $\\psi(0)$ 是精确已知的，所以 $\\psi_{\\text{err}}(0)=0$。\n$$\n\\psi_{\\text{err}}(T) = \\int_{0}^{T} \\dot{\\psi}_{\\text{err}}(\\tau) d\\tau = \\int_{0}^{T} \\left[ (\\sec\\theta_0 \\sin\\phi_0) \\eta_y(\\tau) + (\\sec\\theta_0 \\cos\\phi_0) \\eta_z(\\tau) \\right] d\\tau\n$$\n$\\psi(T)$ 的方差等于 $\\psi_{\\text{err}}(T)$ 的方差，因为真值是确定性的。方差定义为 $\\mathrm{Var}[\\psi(T)] = \\mathbb{E}[(\\psi_{\\text{err}}(T))^2] - (\\mathbb{E}[\\psi_{\\text{err}}(T)])^2$。首先，我们计算误差的期望值。鉴于 $\\mathbb{E}[\\boldsymbol{\\eta}(t)] = 0$，我们有 $\\mathbb{E}[\\eta_y(t)]=0$ 和 $\\mathbb{E}[\\eta_z(t)]=0$。\n$$\n\\mathbb{E}[\\psi_{\\text{err}}(T)] = \\int_{0}^{T} \\mathbb{E}\\left[ (\\sec\\theta_0 \\sin\\phi_0) \\eta_y(\\tau) + (\\sec\\theta_0 \\cos\\phi_0) \\eta_z(\\tau) \\right] d\\tau = 0\n$$\n因此，方差就是二阶矩：$\\mathrm{Var}[\\psi(T)] = \\mathbb{E}[(\\psi_{\\text{err}}(T))^2]$。\n$$\n\\mathrm{Var}[\\psi(T)] = \\mathbb{E}\\left[ \\left(\\int_{0}^{T} \\left[ c_y \\eta_y(\\tau) + c_z \\eta_z(\\tau) \\right] d\\tau\\right) \\left(\\int_{0}^{T} \\left[ c_y \\eta_y(t') + c_z \\eta_z(t') \\right] dt'\\right) \\right]\n$$\n其中 $c_y = \\sec\\theta_0 \\sin\\phi_0$ 和 $c_z = \\sec\\theta_0 \\cos\\phi_0$ 是常数。重新排列为二重积分并将期望算子移入内部：\n$$\n\\mathrm{Var}[\\psi(T)] = \\int_{0}^{T}\\int_{0}^{T} \\mathbb{E}[ (c_y \\eta_y(\\tau) + c_z \\eta_z(\\tau))(c_y \\eta_y(t') + c_z \\eta_z(t')) ] d\\tau dt'\n$$\n展开期望内的项：\n$$\n\\mathbb{E}[c_y^2 \\eta_y(\\tau)\\eta_y(t') + c_z^2 \\eta_z(\\tau)\\eta_z(t') + c_y c_z \\eta_y(\\tau)\\eta_z(t') + c_y c_z \\eta_z(\\tau)\\eta_y(t')]\n$$\n噪声分量是独立的，所以像 $\\mathbb{E}[\\eta_y(\\tau)\\eta_z(t')]$ 这样的互相关项为零。问题提供了自相关属性 $\\mathbb{E}[\\eta(t)\\eta(t')^{\\top}] = \\mathrm{diag}(S_{x}, S_{y}, S_{z})\\delta(t-t')$，这意味着 $\\mathbb{E}[\\eta_y(\\tau)\\eta_y(t')] = S_y\\delta(\\tau-t')$ 和 $\\mathbb{E}[\\eta_z(\\tau)\\eta_z(t')] = S_z\\delta(\\tau-t')$。方差的表达式变为：\n$$\n\\mathrm{Var}[\\psi(T)] = \\int_{0}^{T}\\int_{0}^{T} [c_y^2 S_y \\delta(\\tau-t') + c_z^2 S_z \\delta(\\tau-t')] d\\tau dt'\n$$\n对 $\\tau$ 积分并应用狄拉克 $\\delta$ 函数 $\\delta(\\cdot)$ 的筛选性质：\n$$\n\\mathrm{Var}[\\psi(T)] = \\int_{0}^{T} (c_y^2 S_y + c_z^2 S_z) dt'\n$$\n被积函数相对于 $t'$ 是常数，因此最终的积分很简单：\n$$\n\\mathrm{Var}[\\psi(T)] = (c_y^2 S_y + c_z^2 S_z) T\n$$\n将 $c_y$ 和 $c_z$ 的表达式代回：\n$$\n\\mathrm{Var}[\\psi(T)] = ((\\sec\\theta_0 \\sin\\phi_0)^2 S_y + (\\sec\\theta_0 \\cos\\phi_0)^2 S_z) T\n$$\n提出 $\\sec^2\\theta_0$ 项，得到最终表达式：\n$$\n\\mathrm{Var}[\\psi(T)] = \\sec^2\\theta_0 (S_y \\sin^2\\phi_0 + S_z \\cos^2\\phi_0) T = \\frac{T}{\\cos^2\\theta_0} (S_y \\sin^2\\phi_0 + S_z \\cos^2\\phi_0)\n$$\n这个结果明确地显示了对万向节死锁奇点的极端敏感性：当 $\\theta_0 \\to \\pm \\pi/2$ 时，$\\cos^2\\theta_0 \\to 0$，偏航角的方差无界增长，表明方向估计发生了灾难性的失败。",
            "answer": "$$\n\\boxed{\\frac{T (S_y \\sin^{2}(\\phi_0) + S_z \\cos^{2}(\\phi_0))}{\\cos^{2}(\\theta_0)}}\n$$"
        }
    ]
}