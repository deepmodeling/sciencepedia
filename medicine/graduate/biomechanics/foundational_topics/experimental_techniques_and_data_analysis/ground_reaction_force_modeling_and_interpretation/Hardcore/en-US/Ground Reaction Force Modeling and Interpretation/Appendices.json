{
    "hands_on_practices": [
        {
            "introduction": "Ground reaction forces are not just abstract vectors; they represent a physical interaction with tangible consequences, one of the most critical being the prevention of slip. This exercise applies the fundamental Coulomb friction model to biomechanical data from an elite sprinter. By calculating the minimum required coefficient of friction to prevent the foot from slipping, you will bridge the gap between measured forces and the practical engineering requirements of athletic surfaces and footwear .",
            "id": "4176636",
            "problem": "A high-speed force platform measures the three-dimensional ground reaction force under the right foot of an elite sprinter during the stance phase of maximal sprinting on a level synthetic track. Adopt a Coulomb friction model at the shoe–surface interface: the tangential ground reaction force vector $\\mathbf{F}_{t}(t)$ lies within a friction cone defined by $|\\mathbf{F}_{t}(t)| \\leq \\mu F_{n}(t)$, where $F_{n}(t)$ is the normal component of the ground reaction force and $\\mu$ is the coefficient of static friction. Assume the no-slip condition requires that the inequality holds for all stance times $t$ in $[0, T]$, with stance duration $T$.\n\nThe laboratory reports that, within the measurement resolution, the instant of maximal tangential resultant force magnitude coincides with the instant of maximal normal force during this stance. At that instant, the measured force components in laboratory coordinates are:\n- Anterior–posterior (braking) component $F_{x} = -\\,1800~\\text{N}$,\n- Mediolateral component $F_{y} = 450~\\text{N}$,\n- Vertical (normal) component $F_{z} = 2200~\\text{N}$,\n\nwith the vertical axis aligned with the surface normal, so $F_{n} = F_{z}$ and the tangential vector $\\mathbf{F}_{t}$ lies in the plane spanned by the $x$- and $y$-axes.\n\nStarting from Newton’s laws and the Coulomb friction cone definition, derive the condition for no slip and use it to compute the minimum required coefficient of static friction $\\mu_{\\text{req}}$ to prevent slip throughout stance in this trial. Express your final result as a single dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- A Coulomb friction model is adopted: $|\\mathbf{F}_{t}(t)| \\leq \\mu F_{n}(t)$.\n- $\\mathbf{F}_{t}(t)$ is the tangential ground reaction force vector.\n- $F_{n}(t)$ is the normal component of the ground reaction force.\n- $\\mu$ is the coefficient of static friction.\n- The no-slip condition requires the inequality to hold for all times $t$ in the stance duration $[0, T]$.\n- The instant of maximal tangential resultant force magnitude, $\\max|\\mathbf{F}_{t}(t)|$, coincides with the instant of maximal normal force, $\\max F_{n}(t)$.\n- At this specific instant, the measured force components are:\n    - Anterior–posterior component: $F_{x} = -1800 \\, \\text{N}$.\n    - Mediolateral component: $F_{y} = 450 \\, \\text{N}$.\n    - Vertical (normal) component: $F_{z} = 2200 \\, \\text{N}$.\n- The vertical axis is aligned with the surface normal, so $F_{n} = F_{z}$.\n- The tangential force vector $\\mathbf{F}_{t}$ lies in the plane spanned by the $x$- and $y$-axes.\n- The task is to compute the minimum required coefficient of static friction, $\\mu_{\\text{req}}$.\n- The final result must be a dimensionless number rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on fundamental principles of Newtonian mechanics (forces, friction) as applied to the established field of biomechanics. The Coulomb friction model is a standard, first-order approximation for such interactions. The force values, while large, are within the physically realistic range for elite athletes during maximal exertion.\n- **Well-Posed:** The problem provides sufficient information to calculate a unique value for the minimum required coefficient of friction. It clearly defines the model, the relevant variables, and the data at the critical instant to be analyzed. While it simplifies the real-world problem by assuming the maximum of the ratio $\\frac{|\\mathbf{F}_{t}(t)|}{F_{n}(t)}$ occurs at the given instant, this is a standard and necessary simplification for a well-posed problem of this type, and the problem text guides this interpretation.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased technical language.\n\nThe problem is found to be valid as it is scientifically grounded, well-posed, and objective. It contains no logical contradictions, physical impossibilities, or ambiguous terms. We may proceed with the solution.\n\n### Solution Derivation\n\nThe analysis begins with the principles of friction as defined in the problem. According to Newton's Third Law, the ground reaction force $\\mathbf{F}$ is the force exerted by the ground on the sprinter's foot. This force can be decomposed into a component normal to the surface, $F_{n}$, and a component tangential to the surface, $\\mathbf{F}_{t}$.\n\nThe Coulomb model for static friction states that slip is prevented as long as the magnitude of the tangential force does not exceed the maximum possible static friction force. This is expressed by the inequality:\n$$|\\mathbf{F}_{t}(t)| \\leq \\mu F_{n}(t)$$\nwhere $\\mu$ is the coefficient of static friction between the shoe and the track surface.\n\nFor the no-slip condition to be maintained throughout the entire stance phase, from time $t=0$ to $t=T$, this inequality must hold for all $t \\in [0, T]$. This can be expressed by rearranging the inequality to solve for $\\mu$:\n$$\\mu \\geq \\frac{|\\mathbf{F}_{t}(t)|}{F_{n}(t)}$$\nTo ensure this condition holds for the entire duration, the coefficient of friction $\\mu$ must be greater than or equal to the maximum value that the ratio $\\frac{|\\mathbf{F}_{t}(t)|}{F_{n}(t)}$ achieves during the stance phase. This maximum value is defined as the minimum required coefficient of static friction, $\\mu_{\\text{req}}$.\n$$\\mu_{\\text{req}} = \\max_{t \\in [0, T]} \\left( \\frac{|\\mathbf{F}_{t}(t)|}{F_{n}(t)} \\right)$$\n\nThe problem provides the components of the ground reaction force at a specific instant, which is stated to be when both the tangential force magnitude $|\\mathbf{F}_{t}|$ and the normal force $F_{n}$ are at their maximum values. We are instructed to use these data to compute $\\mu_{\\text{req}}$, which implies that we are to assume this instant corresponds to the maximum of the ratio $\\frac{|\\mathbf{F}_{t}|}{F_{n}}$.\n\nThe ground reaction force vector $\\mathbf{F}$ has components $(F_{x}, F_{y}, F_{z})$.\nAccording to the problem statement:\n- The normal force component is the vertical component: $F_{n} = F_{z}$.\n- The tangential force vector $\\mathbf{F}_{t}$ is composed of the anterior-posterior and mediolateral components: $\\mathbf{F}_{t} = F_{x} \\mathbf{i} + F_{y} \\mathbf{j}$.\n\nThe magnitude of the tangential force vector is calculated using the Pythagorean theorem in two dimensions:\n$$|\\mathbf{F}_{t}| = \\sqrt{F_{x}^{2} + F_{y}^{2}}$$\nUsing the provided data at the critical instant:\n$F_{x} = -1800 \\, \\text{N}$\n$F_{y} = 450 \\, \\text{N}$\n$F_{z} = 2200 \\, \\text{N}$\n\nThe magnitude of the tangential force is:\n$$|\\mathbf{F}_{t}| = \\sqrt{(-1800)^{2} + (450)^{2}} \\, \\text{N}$$\n$$|\\mathbf{F}_{t}| = \\sqrt{3240000 + 202500} \\, \\text{N}$$\n$$|\\mathbf{F}_{t}| = \\sqrt{3442500} \\, \\text{N}$$\n\nThe normal force is given by:\n$$F_{n} = F_{z} = 2200 \\, \\text{N}$$\n\nNow we can compute the minimum required coefficient of friction, $\\mu_{\\text{req}}$, by taking the ratio at this instant:\n$$\\mu_{\\text{req}} = \\frac{|\\mathbf{F}_{t}|}{F_{n}} = \\frac{\\sqrt{3442500}}{2200}$$\n\nTo simplify the calculation, we can factor the terms:\n$$|\\mathbf{F}_{t}| = \\sqrt{(4 \\times 450)^{2} + (450)^{2}} = \\sqrt{16 \\times 450^{2} + 1 \\times 450^{2}} = \\sqrt{17 \\times 450^{2}} = 450\\sqrt{17}$$\nSo, the expression for $\\mu_{\\text{req}}$ becomes:\n$$\\mu_{\\text{req}} = \\frac{450\\sqrt{17}}{2200} = \\frac{45\\sqrt{17}}{220} = \\frac{9\\sqrt{17}}{44}$$\n\nNow, we compute the numerical value and round it to four significant figures as requested.\nUsing the value $\\sqrt{17} \\approx 4.1231056256$:\n$$\\mu_{\\text{req}} = \\frac{9 \\times 4.1231056256}{44} \\approx \\frac{37.1079506305}{44} \\approx 0.84336251433$$\n\nRounding to four significant figures, we get:\n$$\\mu_{\\text{req}} \\approx 0.8434$$\nThis is a dimensionless quantity, as it is a ratio of two forces.",
            "answer": "$$\\boxed{0.8434}$$"
        },
        {
            "introduction": "Biomechanical models can sometimes yield results that defy physical intuition, such as an ankle absorbing energy during a powerful propulsive push-off. This scenario challenges you to act as a scientific detective, using first principles of mechanics and an understanding of the experimental process to diagnose the source of such a non-physical result. This practice is invaluable for developing the critical thinking and troubleshooting skills essential for any experimental scientist working with complex models like inverse dynamics .",
            "id": "4176615",
            "problem": "An investigator performs inverse dynamics (ID) on the ankle joint during late stance of running to estimate mechanical power at the joint. The foot is modeled as a rigid body with an ankle joint center at position $\\mathbf{x}_a = (x_a, y_a, z_a)$ in a laboratory-fixed right-handed coordinate system where $x$ is anterior, $y$ is superior, and $z$ is lateral. Plantarflexion/dorsiflexion occurs about the $z$-axis. Ground Reaction Force (GRF) and Center of Pressure (COP) are measured from a force plate and mapped into the laboratory frame. The following facts and measurements are available at a specific time $t^*$ near push-off:\n\n- The ankle joint center is at height $h$, so $y_a = h$ with $h = 0.04 \\ \\text{m}$, and $x_a = 0$, $z_a \\approx 0$.\n- The measured COP in the laboratory frame at $t^*$ is at $\\mathbf{x}_c = (x_c, y_c, z_c)$ with $x_c = -0.02 \\ \\text{m}$ (posterior to the ankle in the anterior-posterior direction), $y_c = 0$, and $z_c \\approx 0$. Therefore, the position vector from the ankle to COP is $\\mathbf{r} = \\mathbf{x}_c - \\mathbf{x}_a$, so $r_x = x_c - x_a = -0.02 \\ \\text{m}$ and $r_y = y_c - y_a = -0.04 \\ \\text{m}$, with $r_z \\approx 0$.\n- The GRF at $t^*$ is $\\mathbf{F} = (F_x, F_y, F_z)$ with $F_x = -120 \\ \\text{N}$ (posterior shear), $F_y = 400 \\ \\text{N}$ (vertical), and $F_z \\approx 0$.\n- The foot segment angular velocity about the $z$-axis at $t^*$, computed from kinematics, is $\\omega_z = +8 \\ \\text{rad/s}$, where the sign convention is positive for plantarflexion. The plantarflexion angle $\\theta_z(t)$ is increasing immediately before $t^*$, consistent with $\\omega_z  0$.\n\nAssume rigid-body Newton–Euler equations and the definition of mechanical power at a joint. The external moment about the ankle due to GRF at time $t^*$ is the $z$-component of $\\mathbf{M} = \\mathbf{r} \\times \\mathbf{F}$, namely $M_z = r_x F_y - r_y F_x$. Joint power in the sagittal plane is $P = M_z \\, \\omega_z$ at $t^*$. The investigator finds that the ID solution yields $P(t^*) \\approx -100 \\ \\text{W}$ and that this negative power persists for approximately $40 \\ \\text{ms}$ prior to toe-off, which conflicts with the expected positive ankle power near push-off in running.\n\nAs a diagnostic check, the investigator remaps the COP using an instrumented shoe insole, yielding an anterior COP at $t^*$ of $x_c^{\\text{shoe}} = +0.08 \\ \\text{m}$, with $y_c^{\\text{shoe}} = 0$, $z_c^{\\text{shoe}} \\approx 0$, while the GRF and kinematics remain otherwise unchanged. With this remapped COP, the recomputed $M_z$ and $P$ at $t^*$ are found to be positive.\n\nAdditionally, the GRF system is verified against a calibration load at rest, showing vertical force offsets below $10 \\ \\text{N}$, and the kinematics and GRF were synchronized using the same hardware trigger. Kinematics were low-pass filtered at $6 \\ \\text{Hz}$, and GRF were low-pass filtered at $50 \\ \\text{Hz}$ and high-pass filtered at $10 \\ \\text{Hz}$ to remove drift.\n\nUsing only first principles and the given data, select all correct statements:\n\nA. A posterior mislocation of the COP (negative $r_x$) at $t^*$ can flip the sign of the external moment $M_z$ and, given $\\omega_z  0$, produce non-physical negative ankle power; the shoe-insole remapping to anterior $x_c^{\\text{shoe}}$ is consistent with correcting this error.\n\nB. A vertical GRF baseline drift alone of magnitude $-300 \\ \\text{N}$ could plausibly invert the sign of $M_z$ at $t^*$ without COP mislocation, explaining the negative power.\n\nC. A sign error in the sagittal angular velocity (recording plantarflexion $\\omega_z$ as negative) is the most likely cause of the negative joint power observed, even if the external moment $M_z$ is negative at $t^*$.\n\nD. The filtering mismatch between GRF and kinematics can introduce phase lags that cause brief intervals of negative instant power, but given the observed negative $M_z$ and a posterior COP, filtering alone cannot explain sustained negative power across push-off; the data suggest a spatial COP mapping issue rather than temporal phase error.",
            "solution": "The user has provided a biomechanics problem concerning the calculation of ankle joint power during running. The task is to validate the problem statement and then, based on a valid statement, derive the correct answer by evaluating the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System:** Inverse dynamics (ID) on the ankle joint during late stance of running.\n- **Coordinate System:** Laboratory-fixed, right-handed ($x$: anterior, $y$: superior, $z$: lateral).\n- **Joint and Motion:** Ankle joint, with plantarflexion/dorsiflexion about the $z$-axis. Positive $\\omega_z$ is plantarflexion.\n- **Ankle Joint Center Position at time $t^*$:** $\\mathbf{x}_a = (x_a, y_a, z_a)$ with $x_a = 0$, $y_a = h = 0.04 \\ \\text{m}$, and $z_a \\approx 0$.\n- **Initial Force Plate Data at $t^*$:**\n    - Center of Pressure (COP): $\\mathbf{x}_c = (x_c, y_c, z_c)$ with $x_c = -0.02 \\ \\text{m}$, $y_c = 0$, and $z_c \\approx 0$.\n    - Ground Reaction Force (GRF): $\\mathbf{F} = (F_x, F_y, F_z)$ with $F_x = -120 \\ \\text{N}$, $F_y = 400 \\ \\text{N}$, and $F_z \\approx 0$.\n- **Position Vector from Ankle to COP:** $\\mathbf{r} = \\mathbf{x}_c - \\mathbf{x}_a$, giving $r_x = -0.02 \\ \\text{m}$, $r_y = -0.04 \\ \\text{m}$, and $r_z \\approx 0$.\n- **Kinematics at $t^*$:**\n    - Angular velocity: $\\omega_z = +8 \\ \\text{rad/s}$.\n    - Also stated: \"The plantarflexion angle $\\theta_z(t)$ is increasing immediately before $t^*$, consistent with $\\omega_z  0$.\"\n- **Governing Equations:**\n    - External moment about ankle: $\\mathbf{M} = \\mathbf{r} \\times \\mathbf{F}$.\n    - $z$-component of moment: $M_z = r_x F_y - r_y F_x$.\n    - Sagittal plane joint power: $P = M_z \\, \\omega_z$.\n- **Initial Observation:** Calculated power $P(t^*) \\approx -100 \\ \\text{W}$, which persists for $\\approx 40 \\ \\text{ms}$ and conflicts with expected positive power at push-off.\n- **Diagnostic Data:**\n    - A shoe insole provides a remapped COP: $x_c^{\\text{shoe}} = +0.08 \\ \\text{m}$, $y_c^{\\text{shoe}} = 0$, $z_c^{\\text{shoe}} \\approx 0$.\n    - With this new COP, the recomputed $M_z$ and $P$ are positive.\n- **Additional Details:**\n    - GRF calibration: vertical force offsets $ 10 \\ \\text{N}$.\n    - Synchronization: Common hardware trigger for kinematics and GRF.\n    - Filtering: Kinematics low-pass at $6 \\ \\text{Hz}$; GRF low-pass at $50 \\ \\text{Hz}$ and high-pass at $10 \\ \\text{Hz}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on fundamental principles of rigid-body dynamics (Newton-Euler equations) and biomechanics (inverse dynamics, joint power calculation). The scenario is a standard and realistic experimental problem in biomechanics.\n- **Well-Posed:** All necessary data and equations are provided to perform the required calculations and evaluate the hypotheses presented in the options. The problem is structured as a diagnostic case study, which is a coherent format.\n- **Objective:** The language is technical and precise. The data are presented quantitatively.\n- **Consistency and Feasibility:** The given values are physically plausible for running, even if some are at the lower or higher end of typical ranges (e.g., $F_y$ is low, $\\omega_z$ is high, but these are instantaneous values near toe-off). The central conflict (negative power) is the premise of the problem, not a flaw in its construction. The filtering parameters, while aggressive (especially the $10 \\ \\text{Hz}$ high-pass on GRF), represent a possible, though perhaps suboptimal, processing choice in a real experiment. They do not invalidate the problem's logical structure.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a well-posed, scientifically grounded problem that asks for an analysis of potential experimental errors, a common task in scientific research. I will proceed with the solution.\n\n### Derivation and Option Analysis\n\nFirst, we verify the initial calculation of moment and power using the force plate data.\nThe position vector from the ankle joint center $\\mathbf{x}_a = (0, 0.04, 0) \\ \\text{m}$ to the center of pressure $\\mathbf{x}_c = (-0.02, 0, 0) \\ \\text{m}$ is:\n$$ \\mathbf{r} = \\mathbf{x}_c - \\mathbf{x}_a = (-0.02, -0.04, 0) \\ \\text{m} $$\nThe Ground Reaction Force is $\\mathbf{F} = (-120, 400, 0) \\ \\text{N}$.\n\nThe external moment about the ankle joint is $\\mathbf{M} = \\mathbf{r} \\times \\mathbf{F}$. We are interested in the $z$-component, $M_z$, which contributes to plantar/dorsiflexion.\n$$ M_z = r_x F_y - r_y F_x $$\n$$ M_z = (-0.02 \\ \\text{m})(400 \\ \\text{N}) - (-0.04 \\ \\text{m})(-120 \\ \\text{N}) $$\n$$ M_z = -8.0 \\ \\text{N}\\cdot\\text{m} - 4.8 \\ \\text{N}\\cdot\\text{m} = -12.8 \\ \\text{N}\\cdot\\text{m} $$\nThis is a dorsiflexor external moment (it would cause dorsiflexion if unopposed). To counteract this and produce plantarflexion, the internal joint moment from the muscles must be plantarflexor (positive).\n\nThe mechanical power at the joint is given by $P = M_z \\, \\omega_z$. With a plantarflexion angular velocity $\\omega_z = +8 \\ \\text{rad/s}$:\n$$ P = (-12.8 \\ \\text{N}\\cdot\\text{m})(+8 \\ \\text{rad/s}) = -102.4 \\ \\text{W} $$\nThis calculation confirms the problem's statement of observing approximately $-100 \\ \\text{W}$. This negative power indicates energy absorption, which is contrary to the expected energy generation (positive power) during the propulsive push-off phase of running.\n\nNext, we analyze the diagnostic check using the shoe insole data. The new COP is $x_c^{\\text{shoe}} = +0.08 \\ \\text{m}$.\nThe new position vector from the ankle to the COP is:\n$$ \\mathbf{r}^{\\text{shoe}} = (x_c^{\\text{shoe}} - x_a, y_c^{\\text{shoe}} - y_a, z_c^{\\text{shoe}} - z_a) = (0.08 - 0, 0 - 0.04, 0 - 0) = (0.08, -0.04, 0) \\ \\text{m} $$\nWe recompute the moment $M_z$ with this new COP:\n$$ M_z^{\\text{shoe}} = r_x^{\\text{shoe}} F_y - r_y^{\\text{shoe}} F_x $$\n$$ M_z^{\\text{shoe}} = (0.08 \\ \\text{m})(400 \\ \\text{N}) - (-0.04 \\ \\text{m})(-120 \\ \\text{N}) $$\n$$ M_z^{\\text{shoe}} = 32.0 \\ \\text{N}\\cdot\\text{m} - 4.8 \\ \\text{N}\\cdot\\text{m} = +27.2 \\ \\text{N}\\cdot\\text{m} $$\nThis is a plantarflexor external moment.\nThe recomputed power is:\n$$ P^{\\text{shoe}} = M_z^{\\text{shoe}} \\, \\omega_z = (+27.2 \\ \\text{N}\\cdot\\text{m})(+8 \\ \\text{rad/s}) = +217.6 \\ \\text{W} $$\nThis recomputation yields a large positive power, which is consistent with ankle push-off. This strongly suggests the initial COP data from the force plate was erroneous.\n\nNow we evaluate each option.\n\n**A. A posterior mislocation of the COP (negative $r_x$) at $t^*$ can flip the sign of the external moment $M_z$ and, given $\\omega_z  0$, produce non-physical negative ankle power; the shoe-insole remapping to anterior $x_c^{\\text{shoe}}$ is consistent with correcting this error.**\nOur analysis shows that the initial posterior COP ($r_x = -0.02 \\ \\text{m}$) resulted in a negative moment $M_z = -12.8 \\ \\text{N}\\cdot\\text{m}$. With a positive angular velocity $\\omega_z  0$, this mathematically necessitates a negative power $P  0$. This is considered non-physical for push-off. The diagnostic remapping to an anterior COP ($x_c^{\\text{shoe}} = +0.08 \\ \\text{m}$, so $r_x^{\\text{shoe}} = +0.08 \\ \\text{m}$) resulted in a positive moment $M_z^{\\text{shoe}} = +27.2 \\ \\text{N}\\cdot\\text{m}$ and a positive power $P^{\\text{shoe}} = +217.6 \\ \\text{W}$, which resolves the physical contradiction. The statement accurately describes the situation and the effect of the correction.\n_Verdict: Correct._\n\n**B. A vertical GRF baseline drift alone of magnitude $-300 \\ \\text{N}$ could plausibly invert the sign of $M_z$ at $t^*$ without COP mislocation, explaining the negative power.**\nLet's test this. Assume the initial COP ($r_x = -0.02 \\ \\text{m}$) is correct. We want to see if an error in $F_y$ could make $M_z  0$. The equation for the moment is $M_z = r_x F_y - r_y F_x = (-0.02) F_y - 4.8$. For $M_z$ to be positive:\n$$ (-0.02) F_y - 4.8  0 \\implies (-0.02) F_y  4.8 \\implies F_y  \\frac{4.8}{-0.02} \\implies F_y  -240 \\ \\text{N} $$\nThis would require the vertical ground reaction force to be negative (i.e., pulling the subject down), which is physically impossible. Therefore, no error in $F_y$ alone can make the moment positive. Furthermore, the problem states that GRF calibration showed vertical force offsets \"below $10 \\ \\text{N}$\", which makes a drift of $-300 \\ \\text{N}$ implausible and contradictory to the provided information.\n_Verdict: Incorrect._\n\n**C. A sign error in the sagittal angular velocity (recording plantarflexion $\\omega_z$ as negative) is the most likely cause of the negative joint power observed, even if the external moment $M_z$ is negative at $t^*$.**\nIf there were a sign error and the true angular velocity was $\\omega_z = -8 \\ \\text{rad/s}$, the power would be $P = M_z \\omega_z = (-12.8 \\ \\text{N}\\cdot\\text{m})(-8 \\ \\text{rad/s}) = +102.4 \\ \\text{W}$. While this mathematically yields positive power, a negative angular velocity ($\\omega_z  0$) corresponds to dorsiflexion, according to the stated sign convention. Rapid dorsiflexion is the opposite of the explosive plantarflexion that characterizes ankle push-off. This explanation would resolve the sign of the power at the cost of making the underlying kinematics physically inconsistent with the described movement phase. The problem also states that the measurement of $\\omega_z  0$ is consistent with the observed increasing plantarflexion angle, making a sign error less likely. Given the plausible alternative of a COP error proven by the insole data, a sign error in kinematics is not the \"most likely cause.\"\n_Verdict: Incorrect._\n\n**D. The filtering mismatch between GRF and kinematics can introduce phase lags that cause brief intervals of negative instant power, but given the observed negative $M_z$ and a posterior COP, filtering alone cannot explain sustained negative power across push-off; the data suggest a spatial COP mapping issue rather than temporal phase error.**\nThis statement makes two points. First, that filtering mismatch (kinematics at $6 \\ \\text{Hz}$, GRF at $50 \\ \\text{Hz}$) can cause phase lags leading to transient negative power. This is a known artifact in biomechanics. Second, it argues that this is not the primary cause here. Our calculation showed that based on the given spatial configuration ($r_x  0$), the moment $M_z$ is structurally negative at time $t^*$. A temporal phase shift would alter the timing of the signals, but it wouldn't change the fact that the combination of a posterior COP and an upward/backward GRF results in a negative (dorsiflexor) external moment. The problem is not just a brief timing mismatch around a zero-crossing; it's a \"sustained\" issue ($40 \\ \\text{ms}$) rooted in a spatially incorrect calculation. The resolution of the problem by spatially remapping the COP with the insole strongly supports the conclusion that the issue is a spatial mapping error, not primarily a temporal one. The statement provides an accurate and nuanced assessment of the situation.\n_Verdict: Correct._",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "Inverse dynamics is a cornerstone of biomechanics, providing a powerful method to estimate the internal net joint moments that drive human movement. This exercise guides you in building this model from first principles, translating the Newton-Euler equations of motion into a working computational algorithm. By implementing a complete inverse dynamics solution for a two-segment leg, you will gain a mastery of the mechanics and see precisely how ground reaction force data serves as a crucial input for revealing the body's internal kinetics .",
            "id": "4176614",
            "problem": "Design and implement a complete planar inverse dynamics computation for a two-segment leg (distal segment: shank-foot, proximal segment: thigh) using a measured Ground Reaction Force (GRF) to obtain the net hip joint moment at a single instant. The leg moves in a sagittal plane with a global frame in which the horizontal axis is anterior-posterior ($x$) and the vertical axis is superior-inferior ($y$). Positive rotations are counterclockwise. Use Newton’s Second Law for translation and rotation, rigid-body kinematics for planar acceleration propagation, and Newton’s Third Law to relate internal joint interaction forces and moments. The goal is to derive from first principles and implement the algorithm that maps specified kinematics and external forces to the net hip flexion moment.\n\nFundamental principles to use:\n- Newton’s Second Law for translation: $\\sum \\mathbf{F} = m \\mathbf{a}_{\\mathrm{COM}}$.\n- Newton’s Second Law for rotation about the center of mass: $\\sum \\tau_{\\mathrm{ext,COM}} = I_{\\mathrm{COM}} \\alpha$.\n- Rigid-body kinematics for a point $\\mathbf{r}$ on a rotating body: $\\mathbf{a}(\\mathbf{r}) = \\mathbf{a}(\\mathbf{r}_0) + \\alpha \\times \\mathbf{r}_{0 \\rightarrow r} - \\omega^2 \\mathbf{r}_{0 \\rightarrow r}$ for planar motion (out-of-plane angular quantities).\n- Newton’s Third Law at the knee: equal and opposite interaction forces and moments act on the distal and proximal segments.\n\nSegment definitions and sign conventions:\n- Segment $1$ (distal): shank-foot, proximal joint at knee ($K$), distal bony landmark at ankle ($A$), length $L_1$, mass $m_1$, center-of-mass (COM) at a fraction $c_1$ along the vector from $K$ to $A$, planar moment of inertia about its COM $I_1$, orientation $\\theta_1$ (from the vector $K \\rightarrow A$), angular velocity $\\omega_1$, angular acceleration $\\alpha_1$.\n- Segment $2$ (proximal): thigh, proximal joint at hip ($H$), distal joint at knee ($K$), length $L_2$, mass $m_2$, center-of-mass at a fraction $c_2$ along the vector from $H$ to $K$, planar moment of inertia about its COM $I_2$, orientation $\\theta_2$ (from the vector $H \\rightarrow K$), angular velocity $\\omega_2$, angular acceleration $\\alpha_2$.\n- Hip position $\\mathbf{H} = (x_H, y_H)$ and hip linear acceleration $\\mathbf{a}_H = (a_{Hx}, a_{Hy})$ are given.\n- Ground Reaction Force $\\mathbf{F}_{\\mathrm{GRF}} = (F_x, F_y)$ acts at the center of pressure point $P$, given relative to the ankle by $\\mathbf{r}_{A \\rightarrow P}$.\n- Gravity acts downward with magnitude $g$, so the weight on each segment is $\\mathbf{W}_i = (0, -m_i g)$ applied at its COM.\n- Unknowns: knee reaction force $\\mathbf{R}_K$ on the distal segment, knee moment $M_K$ on the distal segment (positive counterclockwise), hip reaction force $\\mathbf{R}_H$ on the proximal segment, and the desired hip moment $M_H$ (positive counterclockwise flexion).\n\nAlgorithmic requirements:\n1. Compute joint and COM positions using segment lengths and orientations:\n   - Knee position $\\mathbf{K} = \\mathbf{H} + L_2[\\cos(\\theta_2), \\sin(\\theta_2)]$.\n   - Ankle position $\\mathbf{A} = \\mathbf{K} + L_1[\\cos(\\theta_1), \\sin(\\theta_1)]$.\n   - Distal COM position $\\mathbf{C}_1 = \\mathbf{K} + c_1 L_1[\\cos(\\theta_1), \\sin(\\theta_1)]$.\n   - Proximal COM position $\\mathbf{C}_2 = \\mathbf{H} + c_2 L_2[\\cos(\\theta_2), \\sin(\\theta_2)]$.\n   - Center of pressure position $\\mathbf{P} = \\mathbf{A} + \\mathbf{r}_{A \\rightarrow P}$.\n2. Compute accelerations using planar rigid-body relations with out-of-plane angular quantities:\n   - Knee acceleration $\\mathbf{a}_K = \\mathbf{a}_H + \\alpha_2 \\times \\mathbf{r}_{H \\rightarrow K} - \\omega_2^2 \\mathbf{r}_{H \\rightarrow K}$.\n   - Distal COM acceleration $\\mathbf{a}_{C1} = \\mathbf{a}_K + \\alpha_1 \\times \\mathbf{r}_{K \\rightarrow C1} - \\omega_1^2 \\mathbf{r}_{K \\rightarrow C1}$.\n   - Proximal COM acceleration $\\mathbf{a}_{C2} = \\mathbf{a}_H + \\alpha_2 \\times \\mathbf{r}_{H \\rightarrow C2} - \\omega_2^2 \\mathbf{r}_{H \\rightarrow C2}$.\n   In planar coordinates, for any vector $\\mathbf{r} = (r_x, r_y)$ and scalar $\\alpha$, take $\\alpha \\times \\mathbf{r} = \\alpha(-r_y, r_x)$, and $-\\omega^2 \\mathbf{r} = -\\omega^2 (r_x, r_y)$.\n3. Perform inverse dynamics on the distal segment:\n   - Force balance: $\\mathbf{R}_K + \\mathbf{F}_{\\mathrm{GRF}} + \\mathbf{W}_1 = m_1 \\mathbf{a}_{C1}$, solve for $\\mathbf{R}_K$.\n   - Moment balance about $\\mathbf{C}_1$: $I_1 \\alpha_1 = \\tau(\\mathbf{r}_{C1 \\rightarrow K}, \\mathbf{R}_K) + \\tau(\\mathbf{r}_{C1 \\rightarrow P}, \\mathbf{F}_{\\mathrm{GRF}}) + M_K$, solve for $M_K$.\n     Use the scalar planar cross product $\\tau(\\mathbf{r}, \\mathbf{f}) = r_x f_y - r_y f_x$.\n4. Perform inverse dynamics on the proximal segment:\n   - Force balance: $\\mathbf{R}_H + \\mathbf{W}_2 - \\mathbf{R}_K = m_2 \\mathbf{a}_{C2}$, solve for $\\mathbf{R}_H$.\n   - Moment balance about $\\mathbf{C}_2$: $I_2 \\alpha_2 = \\tau(\\mathbf{r}_{C2 \\rightarrow H}, \\mathbf{R}_H) + \\tau(\\mathbf{r}_{C2 \\rightarrow K}, -\\mathbf{R}_K) + (-M_K) + M_H$, solve for $M_H$.\n5. Report the hip moment $M_H$.\n\nAngle unit requirement: all angles must be in radians. Gravitational acceleration must be in $\\mathrm{m/s^2}$. Express the final hip moment answers in Newton-meter ($\\mathrm{N \\cdot m}$), rounded to three decimal places.\n\nTest suite:\nUse gravitational acceleration $g = 9.81$ $\\mathrm{m/s^2}$. For each test, all lengths are in meters, masses in kilograms, moments of inertia in $\\mathrm{kg \\cdot m^2}$, angular velocities in $\\mathrm{rad/s}$, and angular accelerations in $\\mathrm{rad/s^2}$. The GRF is in Newtons and the center of pressure offset $\\mathbf{r}_{A \\rightarrow P}$ is in meters.\n\n- Test case A (dynamic stance):\n  - $L_1 = 0.45$, $m_1 = 5.0$, $c_1 = 0.433$, $I_1 = 0.0844$.\n  - $L_2 = 0.40$, $m_2 = 8.0$, $c_2 = 0.433$, $I_2 = 0.1067$.\n  - $\\mathbf{H} = (0.0, 0.95)$, $\\mathbf{a}_H = (0.6, -0.3)$.\n  - $\\theta_1 = -1.45$, $\\omega_1 = 0.7$, $\\alpha_1 = -1.5$.\n  - $\\theta_2 = -1.50$, $\\omega_2 = 0.5$, $\\alpha_2 = -2.0$.\n  - $\\mathbf{F}_{\\mathrm{GRF}} = (120.0, 900.0)$, $\\mathbf{r}_{A \\rightarrow P} = (0.06, -0.04)$.\n- Test case B (quasi-static aligned posture):\n  - $L_1 = 0.45$, $m_1 = 5.0$, $c_1 = 0.433$, $I_1 = 0.0844$.\n  - $L_2 = 0.40$, $m_2 = 8.0$, $c_2 = 0.433$, $I_2 = 0.1067$.\n  - $\\mathbf{H} = (0.0, 0.95)$, $\\mathbf{a}_H = (0.0, 0.0)$.\n  - $\\theta_1 = -1.5708$, $\\omega_1 = 0.0$, $\\alpha_1 = 0.0$.\n  - $\\theta_2 = -1.5708$, $\\omega_2 = 0.0$, $\\alpha_2 = 0.0$.\n  - $\\mathbf{F}_{\\mathrm{GRF}} = (0.0, 127.53)$, $\\mathbf{r}_{A \\rightarrow P} = (0.0, -0.05)$.\n- Test case C (swing phase, no GRF):\n  - $L_1 = 0.45$, $m_1 = 5.0$, $c_1 = 0.433$, $I_1 = 0.0844$.\n  - $L_2 = 0.40$, $m_2 = 8.0$, $c_2 = 0.433$, $I_2 = 0.1067$.\n  - $\\mathbf{H} = (0.0, 1.0)$, $\\mathbf{a}_H = (0.2, 0.4)$.\n  - $\\theta_1 = -0.7$, $\\omega_1 = -1.0$, $\\alpha_1 = -2.5$.\n  - $\\theta_2 = -1.2$, $\\omega_2 = 1.5$, $\\alpha_2 = 3.0$.\n  - $\\mathbf{F}_{\\mathrm{GRF}} = (0.0, 0.0)$, $\\mathbf{r}_{A \\rightarrow P} = (0.0, 0.0)$.\n\nProgram requirements:\n- Implement the above algorithm exactly with the given sign conventions.\n- Use the provided test suite to compute the hip flexion moment $M_H$ for each test case.\n- Output specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[mA,mB,mC]\". Each entry must be the hip flexion moment in $\\mathrm{N \\cdot m}$ for the corresponding test, rounded to three decimal places, with no spaces anywhere in the line.",
            "solution": "The problem presents a classical inverse dynamics analysis of a two-segment, planar leg model. The analysis is scientifically sound, well-posed, and provides all necessary information to compute a unique solution. The procedure relies on the Newton-Euler equations of motion, which form the foundation of rigid-body dynamics. We will systematically follow the provided algorithmic structure to derive the hip joint moment, $M_H$, from first principles.\n\nThe solution proceeds sequentially, starting with the distal segment (shank-foot) where an external force (Ground Reaction Force) is known, and progressing proximally to the thigh segment to determine the unknown hip joint kinetics. All mathematical entities, including symbols, variables, and numbers, are rendered in LaTeX as required.\n\n**Step 1: Kinematic Analysis - Position and Orientation Vectors**\n\nThe first step is to define the positions of all relevant points—joints and segment centers of mass (COM)—in the global coordinate system $(x, y)$. The kinematic chain originates from the hip joint, whose position $\\mathbf{H} = (x_H, y_H)$ is given.\n\nThe orientation of the thigh (segment $2$) is given by the angle $\\theta_2$, which defines the vector from the hip ($H$) to the knee ($K$). The position vector is:\n$$ \\mathbf{r}_{H \\rightarrow K} = (L_2 \\cos \\theta_2, L_2 \\sin \\theta_2) $$\nThe absolute position of the knee is therefore:\n$$ \\mathbf{K} = \\mathbf{H} + \\mathbf{r}_{H \\rightarrow K} $$\nSimilarly, the orientation of the shank-foot (segment $1$) is given by $\\theta_1$, defining the vector from the knee ($K$) to the ankle ($A$):\n$$ \\mathbf{r}_{K \\rightarrow A} = (L_1 \\cos \\theta_1, L_1 \\sin \\theta_1) $$\nThe absolute position of the ankle is:\n$$ \\mathbf{A} = \\mathbf{K} + \\mathbf{r}_{K \\rightarrow A} $$\nThe center of mass for each segment is located at a fractional distance along its longitudinal axis, specified by $c_1$ and $c_2$.\nThe position vector from the knee to the distal COM is $\\mathbf{r}_{K \\rightarrow C1} = c_1 \\mathbf{r}_{K \\rightarrow A}$. The absolute position of the distal COM is:\n$$ \\mathbf{C}_1 = \\mathbf{K} + c_1 \\mathbf{r}_{K \\rightarrow A} $$\nThe position vector from the hip to the proximal COM is $\\mathbf{r}_{H \\rightarrow C2} = c_2 \\mathbf{r}_{H \\rightarrow K}$. The absolute position of the proximal COM is:\n$$ \\mathbf{C}_2 = \\mathbf{H} + c_2 \\mathbf{r}_{H \\rightarrow K} $$\nFinally, the point of application of the Ground Reaction Force, the Center of Pressure ($P$), is located relative to the ankle:\n$$ \\mathbf{P} = \\mathbf{A} + \\mathbf{r}_{A \\rightarrow P} $$\n\n**Step 2: Kinematic Analysis - Linear Accelerations**\n\nThe linear accelerations of the segment COMs are determined using the planar rigid-body acceleration equation, $\\mathbf{a}(\\mathbf{r}) = \\mathbf{a}(\\mathbf{r}_0) + \\mathbf{\\alpha} \\times \\mathbf{r}_{0 \\rightarrow r} - \\omega^2 \\mathbf{r}_{0 \\rightarrow r}$. Here, $\\mathbf{\\alpha}$ is the angular acceleration vector $(0, 0, \\alpha)$ and $\\omega$ is the scalar angular velocity. The planar cross product is $\\alpha \\times \\mathbf{r} = \\alpha(-r_y, r_x)$ for a vector $\\mathbf{r} = (r_x, r_y)$.\n\nThe acceleration of the knee is found relative to the hip, whose acceleration $\\mathbf{a}_H$ is known:\n$$ \\mathbf{a}_K = \\mathbf{a}_H + \\alpha_2 \\times \\mathbf{r}_{H \\rightarrow K} - \\omega_2^2 \\mathbf{r}_{H \\rightarrow K} $$\nThe acceleration of the distal segment's COM is found relative to the knee:\n$$ \\mathbf{a}_{C1} = \\mathbf{a}_K + \\alpha_1 \\times \\mathbf{r}_{K \\rightarrow C1} - \\omega_1^2 \\mathbf{r}_{K \\rightarrow C1} $$\nThe acceleration of the proximal segment's COM is found relative to the hip:\n$$ \\mathbf{a}_{C2} = \\mathbf{a}_H + \\alpha_2 \\times \\mathbf{r}_{H \\rightarrow C2} - \\omega_2^2 \\mathbf{r}_{H \\rightarrow C2} $$\n\n**Step 3: Inverse Dynamics of the Distal Segment (Shank-Foot)**\n\nWe apply Newton's Second Law to the distal segment to solve for the unknown reaction force $\\mathbf{R}_K$ and moment $M_K$ at the knee.\n\nThe translational equation of motion is $\\sum \\mathbf{F} = m_1 \\mathbf{a}_{C1}$. The external forces are the knee reaction force $\\mathbf{R}_K$, the ground reaction force $\\mathbf{F}_{\\mathrm{GRF}}$, and the weight of the segment $\\mathbf{W}_1 = (0, -m_1 g)$.\n$$ \\mathbf{R}_K + \\mathbf{F}_{\\mathrm{GRF}} + \\mathbf{W}_1 = m_1 \\mathbf{a}_{C1} $$\nSolving for the knee reaction force yields:\n$$ \\mathbf{R}_K = m_1 \\mathbf{a}_{C1} - \\mathbf{F}_{\\mathrm{GRF}} - \\mathbf{W}_1 $$\n\nThe rotational equation of motion about the COM is $\\sum \\tau_{\\mathrm{ext, C1}} = I_1 \\alpha_1$. The sum of moments includes torques from forces not acting at the COM and any pure moments. These are the torque from $\\mathbf{R}_K$ acting at point $K$, the torque from $\\mathbf{F}_{\\mathrm{GRF}}$ acting at point $P$, and the knee joint moment $M_K$.\n$$ \\tau(\\mathbf{r}_{C1 \\rightarrow K}, \\mathbf{R}_K) + \\tau(\\mathbf{r}_{C1 \\rightarrow P}, \\mathbf{F}_{\\mathrm{GRF}}) + M_K = I_1 \\alpha_1 $$\nwhere the scalar torque is $\\tau(\\mathbf{r}, \\mathbf{F}) = r_x F_y - r_y F_x$. The moment arm vectors are $\\mathbf{r}_{C1 \\rightarrow K} = \\mathbf{K} - \\mathbf{C}_1$ and $\\mathbf{r}_{C1 \\rightarrow P} = \\mathbf{P} - \\mathbf{C}_1$. Solving for the unknown knee moment gives:\n$$ M_K = I_1 \\alpha_1 - \\tau(\\mathbf{r}_{C1 \\rightarrow K}, \\mathbf{R}_K) - \\tau(\\mathbf{r}_{C1 \\rightarrow P}, \\mathbf{F}_{\\mathrm{GRF}}) $$\n\n**Step 4: Inverse Dynamics of the Proximal Segment (Thigh)**\n\nUsing the now-known knee kinetics, we analyze the proximal segment to find the hip reaction force $\\mathbf{R}_H$ and the hip moment $M_H$.\n\nThe translational equation is $\\sum \\mathbf{F} = m_2 \\mathbf{a}_{C2}$. The forces are the hip reaction force $\\mathbf{R}_H$, the segment's weight $\\mathbf{W}_2 = (0, -m_2 g)$, and the force from the distal segment. By Newton's Third Law, this force is equal and opposite to the force on the distal segment, so it is $-\\mathbf{R}_K$.\n$$ \\mathbf{R}_H - \\mathbf{R}_K + \\mathbf{W}_2 = m_2 \\mathbf{a}_{C2} $$\nSolving for the hip reaction force:\n$$ \\mathbf{R}_H = m_2 \\mathbf{a}_{C2} + \\mathbf{R}_K - \\mathbf{W}_2 $$\n\nThe rotational equation about the proximal COM is $\\sum \\tau_{\\mathrm{ext, C2}} = I_2 \\alpha_2$. The moments are from the force $\\mathbf{R}_H$ at the hip, the force $-\\mathbf{R}_K$ at the knee, the reaction moment from the knee joint $(-M_K)$, and the unknown hip moment $M_H$.\n$$ \\tau(\\mathbf{r}_{C2 \\rightarrow H}, \\mathbf{R}_H) + \\tau(\\mathbf{r}_{C2 \\rightarrow K}, -\\mathbf{R}_K) - M_K + M_H = I_2 \\alpha_2 $$\nThe moment arms are $\\mathbf{r}_{C2 \\rightarrow H} = \\mathbf{H} - \\mathbf{C}_2$ and $\\mathbf{r}_{C2 \\rightarrow K} = \\mathbf{K} - \\mathbf{C}_2$. Solving for the target variable, the hip moment $M_H$, yields our final expression:\n$$ M_H = I_2 \\alpha_2 - \\tau(\\mathbf{r}_{C2 \\rightarrow H}, \\mathbf{R}_H) - \\tau(\\mathbf{r}_{C2 \\rightarrow K}, -\\mathbf{R}_K) + M_K $$\nThis systematic, segment-by-segment application of Newton-Euler laws allows for the determination of all internal joint kinetics, culminating in the desired hip moment.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the inverse dynamics calculation for all test cases.\n    \"\"\"\n    g = 9.81  # Gravitational acceleration in m/s^2\n\n    # Define test cases as a list of dictionaries.\n    test_cases = [\n        # Test case A (dynamic stance)\n        {\n            \"L1\": 0.45, \"m1\": 5.0, \"c1\": 0.433, \"I1\": 0.0844,\n            \"L2\": 0.40, \"m2\": 8.0, \"c2\": 0.433, \"I2\": 0.1067,\n            \"H\": np.array([0.0, 0.95]), \"a_H\": np.array([0.6, -0.3]),\n            \"theta1\": -1.45, \"omega1\": 0.7, \"alpha1\": -1.5,\n            \"theta2\": -1.50, \"omega2\": 0.5, \"alpha2\": -2.0,\n            \"F_GRF\": np.array([120.0, 900.0]), \"r_A_to_P\": np.array([0.06, -0.04]),\n        },\n        # Test case B (quasi-static aligned posture)\n        {\n            \"L1\": 0.45, \"m1\": 5.0, \"c1\": 0.433, \"I1\": 0.0844,\n            \"L2\": 0.40, \"m2\": 8.0, \"c2\": 0.433, \"I2\": 0.1067,\n            \"H\": np.array([0.0, 0.95]), \"a_H\": np.array([0.0, 0.0]),\n            \"theta1\": -1.5708, \"omega1\": 0.0, \"alpha1\": 0.0,\n            \"theta2\": -1.5708, \"omega2\": 0.0, \"alpha2\": 0.0,\n            \"F_GRF\": np.array([0.0, 127.53]), \"r_A_to_P\": np.array([0.0, -0.05]),\n        },\n        # Test case C (swing phase, no GRF)\n        {\n            \"L1\": 0.45, \"m1\": 5.0, \"c1\": 0.433, \"I1\": 0.0844,\n            \"L2\": 0.40, \"m2\": 8.0, \"c2\": 0.433, \"I2\": 0.1067,\n            \"H\": np.array([0.0, 1.0]), \"a_H\": np.array([0.2, 0.4]),\n            \"theta1\": -0.7, \"omega1\": -1.0, \"alpha1\": -2.5,\n            \"theta2\": -1.2, \"omega2\": 1.5, \"alpha2\": 3.0,\n            \"F_GRF\": np.array([0.0, 0.0]), \"r_A_to_P\": np.array([0.0, 0.0]),\n        }\n    ]\n\n    def calculate_hip_moment(params, g_accel):\n        \"\"\"\n        Calculates the hip moment for a single set of parameters.\n        \"\"\"\n        # Unpack parameters for clarity\n        L1, m1, c1, I1 = params[\"L1\"], params[\"m1\"], params[\"c1\"], params[\"I1\"]\n        L2, m2, c2, I2 = params[\"L2\"], params[\"m2\"], params[\"c2\"], params[\"I2\"]\n        H, a_H = params[\"H\"], params[\"a_H\"]\n        theta1, omega1, alpha1 = params[\"theta1\"], params[\"omega1\"], params[\"alpha1\"]\n        theta2, omega2, alpha2 = params[\"theta2\"], params[\"omega2\"], params[\"alpha2\"]\n        F_GRF, r_A_to_P = params[\"F_GRF\"], params[\"r_A_to_P\"]\n\n        # Helper functions for 2D vector operations\n        def cross_2d(scalar, vector):\n            return scalar * np.array([-vector[1], vector[0]])\n\n        def torque_2d(r, f):\n            return r[0] * f[1] - r[1] * f[0]\n\n        # Step 1: Compute joint and COM positions\n        r_H_to_K = L2 * np.array([np.cos(theta2), np.sin(theta2)])\n        K = H + r_H_to_K\n\n        r_K_to_A = L1 * np.array([np.cos(theta1), np.sin(theta1)])\n        A = K + r_K_to_A\n        \n        r_K_to_C1 = c1 * r_K_to_A\n        C1 = K + r_K_to_C1\n        \n        r_H_to_C2 = c2 * r_H_to_K\n        C2 = H + r_H_to_C2\n        \n        P = A + r_A_to_P\n\n        # Step 2: Compute accelerations\n        a_K = a_H + cross_2d(alpha2, r_H_to_K) - (omega2**2) * r_H_to_K\n        a_C1 = a_K + cross_2d(alpha1, r_K_to_C1) - (omega1**2) * r_K_to_C1\n        a_C2 = a_H + cross_2d(alpha2, r_H_to_C2) - (omega2**2) * r_H_to_C2\n\n        # Step 3: Perform inverse dynamics on the distal segment\n        W1 = np.array([0.0, -m1 * g_accel])\n        R_K = m1 * a_C1 - F_GRF - W1\n        \n        r_C1_to_K = K - C1\n        r_C1_to_P = P - C1\n        \n        M_K = I1 * alpha1 - torque_2d(r_C1_to_K, R_K) - torque_2d(r_C1_to_P, F_GRF)\n\n        # Step 4: Perform inverse dynamics on the proximal segment\n        W2 = np.array([0.0, -m2 * g_accel])\n        R_H = m2 * a_C2 + R_K - W2\n\n        r_C2_to_H = H - C2\n        r_C2_to_K = K - C2\n\n        M_H = I2 * alpha2 - torque_2d(r_C2_to_H, R_H) - torque_2d(r_C2_to_K, -R_K) + M_K\n        \n        return M_H\n\n    results = []\n    for case in test_cases:\n        m_h = calculate_hip_moment(case, g)\n        results.append(f\"{m_h:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}