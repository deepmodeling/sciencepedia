{
    "hands_on_practices": [
        {
            "introduction": "评估生物制剂疗效的第一步始于对个体患者临床反应的精确量化。在伴鼻息肉的慢性鼻窦炎（CRSwNP）的临床实践与研究中，鼻息肉评分（NPS）是一项核心的客观终点指标。本练习将指导您计算治疗后NPS的绝对与相对变化，并引入“最小临床重要差异”（Minimally Clinically Important Difference, MCID）这一关键概念，帮助您判断观测到的数值变化是否对患者具有实际意义。通过这项实践，您将掌握连接原始数据与以患者为中心的临床结局之间桥梁的核心技能。",
            "id": "5010473",
            "problem": "一名患有慢性鼻-鼻窦炎伴鼻息肉 (CRSwNP) 的患者正在接受针对2型炎症的生物疗法治疗。内窥镜评估使用鼻息肉评分 (NPS)，其定义为双侧鼻腔息肉大小等级的总和，每侧鼻腔的息肉大小按从 $0$（无息肉）到 $4$（完全阻塞）的整数等级进行评分，得出的总分范围为 $0$ 到 $8$。假设在第 $24$ 周进行定量评估时，使用以下数据和定义：\n\n- 基线总NPS为 $x_{\\text{baseline}} = 6$。\n- 治疗后第 $24$ 周的总NPS为 $x_{\\text{post}} = 3$。\n- 定义原始绝对变化（带符号）为 $\\Delta = x_{\\text{post}} - x_{\\text{baseline}}$。\n- 定义相对变化（带符号）为 $r = \\dfrac{x_{\\text{post}} - x_{\\text{baseline}}}{x_{\\text{baseline}}}$。\n- 为了临床可解释性，采用NPS的最小临床重要差异 (MCID) 阈值为 $\\Delta_{\\text{MCID}} = 1.0$（分）（在第 $24$ 周），并定义临床意义指标为 $I = \\mathbb{I}\\!\\left(|\\Delta| \\ge \\Delta_{\\text{MCID}}\\right)$，其中 $\\mathbb{I}(\\cdot)$ 是指示函数，当条件为真时其值为 $1$，否则为 $0$。\n\n仅使用这些定义和所提供的数据，计算 $\\Delta$、$r$ 和 $I$。将你的最终答案以行矩阵 $\\begin{pmatrix}\\Delta  r  I\\end{pmatrix}$ 的形式报告。将相对变化 $r$ 表示为小数或精确分数。最终值无需四舍五入，也无需单位。",
            "solution": "该问题被认为是有效的，因为它在科学上基于耳鼻喉科学的临床评估实践，定义和数据齐全，提法得当，并且表述客观。我们可以根据所提供的定义直接进行计算。\n\n给定的数据是：\n- 基线总鼻息肉评分 (NPS)：$x_{\\text{baseline}} = 6$\n- 治疗后第 $24$ 周总NPS：$x_{\\text{post}} = 3$\n- 最小临床重要差异 (MCID) 阈值：$\\Delta_{\\text{MCID}} = 1.0$\n\n需要计算的量是 $\\Delta$、$r$ 和 $I$，定义如下：\n- 原始绝对变化（带符号）：$\\Delta = x_{\\text{post}} - x_{\\text{baseline}}$\n- 相对变化（带符号）：$r = \\dfrac{x_{\\text{post}} - x_{\\text{baseline}}}{x_{\\text{baseline}}}$\n- 临床意义指标：$I = \\mathbb{I}\\!\\left(|\\Delta| \\ge \\Delta_{\\text{MCID}}\\right)$\n\n首先，我们通过将给定的 $x_{\\text{post}}$ 和 $x_{\\text{baseline}}$ 的值代入其定义来计算原始绝对变化 $\\Delta$：\n$$\n\\Delta = x_{\\text{post}} - x_{\\text{baseline}} = 3 - 6 = -3\n$$\n$\\Delta$ 的值为 $-3$。负号表示鼻息肉评分的降低，这对应于临床改善。\n\n接下来，我们计算相对变化 $r$。我们可以使用前面计算出的 $\\Delta$ 值：\n$$\nr = \\dfrac{\\Delta}{x_{\\text{baseline}}} = \\dfrac{-3}{6}\n$$\n化简分数得到：\n$$\nr = -\\dfrac{1}{2}\n$$\n以小数表示，即 $r = -0.5$。这表示相对于基线评分，NPS降低了 $50\\%$。\n\n最后，我们计算临床意义指标 $I$。其定义为 $I = \\mathbb{I}\\!\\left(|\\Delta| \\ge \\Delta_{\\text{MCID}}\\right)$。我们必须首先评估指示函数内部的条件，即 $|\\Delta| \\ge \\Delta_{\\text{MCID}}$。\n\n我们需要 $\\Delta$ 的绝对值：\n$$\n|\\Delta| = |-3| = 3\n$$\n现在我们将其与MCID阈值 $\\Delta_{\\text{MCID}} = 1.0$ 进行比较：\n$$\n3 \\ge 1.0\n$$\n这个不等式成立。由于条件为真，指示函数 $\\mathbb{I}(\\cdot)$ 的值为 $1$：\n$$\nI = 1\n$$\n这表明观察到的NPS变化具有临床意义。\n\n题目要求我们将最终答案以行矩阵 $\\begin{pmatrix}\\Delta  r  I\\end{pmatrix}$ 的形式报告。代入计算出的值：\n$$\n\\begin{pmatrix}-3  -0.5  1\\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix}-3  -0.5  1\\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然个体评估至关重要，但最高级别的医学证据来源于大规模的随机对照试验。为了恰当解读这些试验结果，我们需要超越相对风险降低等传统指标，采用更直观的衡量标准。本练习将重点介绍绝对风险降低（Absolute Risk Reduction, ARR）和需治疗人数（Number Needed to Treat, NNT）这两个循证医学中的基石概念。您将通过计算这些指标，深入理解生物制剂在减少全身性皮质类固醇使用这一CRSwNP关键治疗目标上的实际群体效应和临床价值。",
            "id": "5010470",
            "problem": "一项针对慢性鼻-鼻窦炎伴鼻息肉（CRSwNP）的随机双盲临床试验，比较了一种靶向白细胞介素-4受体α的生物制剂（例如，一种抑制白细胞介素-4/白细胞介素-13信号传导的单克隆抗体）与安慰剂在$24$周内的疗效。所有参与者均接受标准的鼻内皮质类固醇治疗。全身性皮质类固醇爆发治疗定义为在随访期间因鼻窦症状恶化而开始的任何口服皮质类固醇疗程。假设对于“随访期间至少有一次全身性类固醇爆发治疗”这一二元结局，意向性治疗分析的计数如下：\n\n- 安慰剂组：$150$名参与者，其中$45$名在第$24$周时经历了至少一次全身性类固醇爆发治疗。\n- 生物制剂组：$160$名参与者，其中$32$名在第$24$周时经历了至少一次全身性类固醇爆发治疗。\n\n使用基于固定时间范围内发生事件的参与者比例的第一性原理定义，计算在$24$周内避免全身性类固醇爆发治疗的绝对风险降低值，以及为在$24$周内预防一次全身性类固醇爆发治疗所需的相应治疗人数。将绝对风险降低值表示为小数，并四舍五入至三位有效数字。当倒数为整数时，所需治疗人数应报告为精确整数。提供这两个不带单位的数值，并且不要使用百分号。如果报告两个量，请按绝对风险降低值、所需治疗人数的顺序呈现。",
            "solution": "首先根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n- 研究设计：随机双盲临床试验。\n- 患者人群：慢性鼻-鼻窦炎伴鼻息肉（CRSwNP）。\n- 干预组：靶向白细胞介素-4受体α的生物制剂。\n- 对照组：安慰剂。\n- 随访期：$24$周。\n- 伴随用药：所有参与者均接受标准的鼻内皮质类固醇治疗。\n- 结局：在$24$周随访期间至少有一次全身性皮质类固醇爆发治疗。\n- 对照组数据：$N_c = 150$名参与者，其中$E_c = 45$名经历了该结局。下标$c$表示对照（安慰剂）组。\n- 干预组数据：$N_t = 160$名参与者，其中$E_t = 32$名经历了该结局。下标$t$表示治疗（生物制剂）组。\n- 需要的计算：绝对风险降低值（ARR）和所需治疗人数（NNT）。\n- 格式要求：ARR表示为小数并四舍五入至三位有效数字；当倒数为整数时，NNT为精确整数。最终答案应按ARR、NNT的顺序呈现。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：问题描述了一种在真实医疗背景（CRSwNP）下进行的标准、公认的临床试验方法（随机、双盲、安慰剂对照）。干预措施（靶向IL-4/IL-13通路的生物制剂）和结局（减少对全身性类固醇的需求）是现代CRSwNP管理和研究的核心部分。所提供的数据在此类研究中数值上是合理的。该问题具有科学依据。\n- **适定性**：问题提供了所有必要的数据以及待计算量的清晰、标准定义。可以推导出唯一、稳定且有意义的解。\n- **客观性**：问题陈述以客观、定量的语言表达，没有偏见、主观性或意见。\n\n### 步骤3：结论与行动\n该问题有效，因为它科学合理、适定且客观。将提供解答。\n\n核心任务是根据临床试验的二元结局，计算两个基本的治疗效果衡量指标：绝对风险降低值（ARR）和所需治疗人数（NNT）。\n\n首先，我们定义每个组中事件的风险。在此背景下，风险是指在固定时间范围内，一组参与者中经历特定结局的比例。\n\n设 $R_c$ 为对照（安慰剂）组中经历至少一次全身性类固醇爆发治疗的风险。这也被称为对照组事件率（CER）。它的计算方法是用对照组的事件数 $E_c$ 除以该组的总参与者数 $N_c$。\n$$R_c = \\frac{E_c}{N_c}$$\n代入给定值：\n$$R_c = \\frac{45}{150}$$\n该分数可简化为：\n$$R_c = \\frac{3 \\times 15}{10 \\times 15} = \\frac{3}{10} = 0.3$$\n\n接下来，设 $R_t$ 为治疗（生物制剂）组中事件的风险。这也被称为试验组事件率（EER）。它的计算方法是用治疗组的事件数 $E_t$ 除以该组的总参与者数 $N_t$。\n$$R_t = \\frac{E_t}{N_t}$$\n代入给定值：\n$$R_t = \\frac{32}{160}$$\n该分数可简化为：\n$$R_t = \\frac{2 \\times 16}{10 \\times 16} = \\frac{2}{10} = 0.2$$\n\n绝对风险降低值（ARR）是对照组风险与治疗组风险之间的绝对差值。它量化了因干预措施而导致的不良结局风险的绝对降低程度。\n$$\\text{ARR} = R_c - R_t$$\n使用计算出的风险值：\n$$\\text{ARR} = 0.3 - 0.2 = 0.1$$\n问题要求将此值表示为小数，并四舍五入至三位有效数字。数字 $0.1$ 可以写成 $0.100$ 来明确显示三位有效数字。\n\n所需治疗人数（NNT）是ARR的倒数。它表示在指定时期内（此处为$24$周），为预防一次额外的不良结局（此处为一次全身性类固醇爆发治疗）而必须接受干预治疗的平均患者人数。\n$$\\text{NNT} = \\frac{1}{\\text{ARR}}$$\n使用计算出的ARR：\n$$\\text{NNT} = \\frac{1}{0.1} = 10$$\n问题规定，如果倒数是整数，NNT应为精确整数。在本例中，结果恰好是$10$，是一个整数。因此，无需四舍五入。\n\n最终值为ARR $0.100$ 和 NNT $10$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.100  10\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "对于像CRSwNP这样的慢性疾病，尤其是在采用昂贵的生物制剂进行长期管理时，仅凭短期临床试验的疗效数据不足以全面评估其价值。卫生经济学评价，特别是模型模拟，为决策者提供了评估长期成本与效益的关键工具。这项高级实践将引导您构建一个马尔可夫模型，以模拟疾病的长期进程、相关成本以及生活质量的动态变化。通过模拟不同的治疗策略并计算净货币获益（Net Monetary Benefit, NMB）等指标，您将能从卫生技术评估的视角，对生物制剂的长期价值进行综合判断，这是理解和参与制定未来临床指南所必备的技能。",
            "id": "5010450",
            "problem": "构建一个离散时间马尔可夫链，以评估慢性鼻-鼻窦炎伴鼻息肉（CRSwNP）的长期生物制剂策略。慢性鼻-鼻窦炎伴鼻息肉（CRSwNP）是一种以鼻息肉和鼻窦症状为特征的慢性炎性疾病。对于标准治疗无法控制病情的患者，可考虑采用生物制剂疗法。该马尔可夫模型每个周期必须使用以下互斥状态：受控（C）、未受控（U）、手术（S）、口服皮质类固醇冲击治疗（B）、不良事件（A）。口服皮质类固醇（OCS）定义为用于治疗疾病急性发作的短期、全身性皮质类固醇疗程。不良事件（AE）代表具有临床意义的治疗副作用。标准治疗（SOC）指非生物制剂的常规管理方法。该马尔可夫链以月为周期长度进行参数化。\n\n使用的基本原理：\n- 马尔可夫属性：未来状态仅取决于当前状态，而非过去状态。如果 $p_t$ 是周期 $t$ 时的状态概率行向量，$P$ 是 $5 \\times 5$ 的转移矩阵，那么 $p_{t+1} = p_t P$ 且对于所有 $t$，都有 $\\sum_{i=1}^{5} p_t(i) = 1$。\n- 成本和效用的期望值线性：一个周期内的期望成本是状态分布与状态成本向量的点积，效用同理。\n- 通过指数贴现体现时间偏好：对于年贴现率 $r$，在第 $t$ 个月的回报通过 $(1+r)^{-t/12}$ 进行贴现。\n\n模型规格：\n- 状态顺序固定为 $[C,U,S,B,A]$。\n- 周期长度为 $1$ 个月，时间跨度为 $T$ 个月（每个测试用例中指定）。\n- 定义了两个转移矩阵：一个用于标准治疗（$P_{\\text{SOC}}$），一个用于生物制剂策略（$P_{\\text{BIO}}$）。这些是月度转移概率，行随机且具有科学合理性。\n\n标准治疗的转移矩阵为：\n$$\nP_{\\text{SOC}} =\n\\begin{bmatrix}\n0.75  0.15  0.03  0.05  0.02 \\\\\n0.30  0.45  0.10  0.10  0.05 \\\\\n0.55  0.25  0.05  0.10  0.05 \\\\\n0.40  0.40  0.05  0.10  0.05 \\\\\n0.35  0.45  0.04  0.06  0.10 \\\\\n\\end{bmatrix}.\n$$\n\n生物制剂的转移矩阵为：\n$$\nP_{\\text{BIO}} =\n\\begin{bmatrix}\n0.85  0.10  0.01  0.02  0.02 \\\\.50  0.35  0.05  0.06  0.04 \\\\\n0.65  0.25  0.02  0.05  0.03 \\\\\n0.55  0.35  0.03  0.04  0.03 \\\\\n0.40  0.45  0.03  0.04  0.08 \\\\\n\\end{bmatrix}.\n$$\n\n标准治疗下每个周期的状态成本（单位：美元(USD)）：\n- $c_C = 150$,\n- $c_U = 300$,\n- $c_S = 5000$,\n- $c_B = 200$,\n- $c_A = 400$（在测试用例中可修改）。\n\n当周期内使用生物制剂时，增加的生物制剂月度采购成本（单位：美元）：\n- $c_{\\text{bio}} = 2000$。\n\n每个周期的健康状态效用（无单位的质量权重）：\n- $u_C = 0.90$,\n- $u_U = 0.65$,\n- $u_S = 0.50$,\n- $u_B = 0.60$,\n- $u_A = 0.55$。\n\n基线时的初始状态分布为：\n$$\np_0 = [0,1,0,0,0],\n$$\n意味着所有患者从未受控状态开始。\n\n在第 $t$ 个月，每个周期的期望成本，使用策略指示符 $\\delta_t \\in \\{0,1\\}$（其中若周期 $t$ 内使用生物制剂，则 $\\delta_t=1$，否则 $\\delta_t=0$）计算如下：\n$$\n\\text{Cost}_t = \\left(p_t \\cdot c\\right) + \\delta_t \\cdot c_{\\text{bio}},\n$$\n其中 $c = [c_C, c_U, c_S, c_B, c_A]$，并且 $c_{\\text{bio}}$ 每个患者每个周期增加一次（即，应用于整个队列的期望值）。贴现后的期望成本为：\n$$\n\\text{DCost}_t = \\text{Cost}_t \\cdot (1+r_c)^{-t/12},\n$$\n其中 $r_c$ 是成本的年贴现率。\n\n每个周期的期望质量调整生命年（QALYs）计算如下：\n$$\n\\text{QALY}_t = \\left(p_t \\cdot u\\right) \\cdot \\Delta,\n$$\n其中 $u = [u_C, u_U, u_S, u_B, u_A]$，$\\Delta = \\frac{1}{12}$ 年（每个月度周期）。贴现后的期望QALYs为：\n$$\n\\text{DQALY}_t = \\text{QALY}_t \\cdot (1+r_q)^{-t/12},\n$$\n其中 $r_q$ 是QALYs的年贴现率。\n\n在 $T$ 个月内的总贴现成本和QALYs为：\n$$\n\\text{TotalCost} = \\sum_{t=1}^{T} \\text{DCost}_t, \\quad\n\\text{TotalQALY} = \\sum_{t=1}^{T} \\text{DQALY}_t.\n$$\n\n定义在支付意愿阈值 $\\lambda$（美元/QALY）下的净货币获益（NMB）为：\n$$\n\\text{NMB} = \\lambda \\cdot \\text{TotalQALY} - \\text{TotalCost}.\n$$\n\n待评估的策略：\n- 策略 $\\mathcal{S}_1$（持续生物制剂）：对于所有 $t \\in \\{1,\\dots,T\\}$，$\\delta_t = 1$，每个周期使用 $P_{\\text{BIO}}$。\n- 策略 $\\mathcal{S}_2$（标准治疗）：对于所有 $t \\in \\{1,\\dots,T\\}$，$\\delta_t = 0$，每个周期使用 $P_{\\text{SOC}}$。\n- 策略 $\\mathcal{S}_3$（适应性停药）：对于 $t \\in \\{1,\\dots,12\\}$，$\\delta_t = 1$；对于 $t \\ge 13$，计算 $p_{12}$，如果 $p_{12}(C) \\ge \\theta$，则在所有剩余周期中设置 $\\delta_t = 0$；否则，继续使用 $\\delta_t = 1$。矩阵选择在每个周期遵循 $\\delta_t$。\n\n测试套件（每个测试用例定义 $T$、$r_c$、$r_q$、策略、阈值 $\\theta$（如果适用）和 $c_A$ 的覆盖值）：\n- 测试用例 1：$T=60$，$r_c=0.03$，$r_q=0.03$，策略 $\\mathcal{S}_1$，不使用 $\\theta$，$c_A=400$。\n- 测试用例 2：$T=60$，$r_c=0.03$，$r_q=0.03$，策略 $\\mathcal{S}_2$，不使用 $\\theta$，$c_A=400$。\n- 测试用例 3：$T=60$，$r_c=0.03$，$r_q=0.03$，策略 $\\mathcal{S}_3$，$\\theta=0.60$，$c_A=400$。\n- 测试用例 4：$T=60$，$r_c=0.00$，$r_q=0.00$，策略 $\\mathcal{S}_1$，不使用 $\\theta$，$c_A=800$。\n\n所有测试通用的附加常数：\n- 支付意愿阈值 $\\lambda = 100000$ 美元/QALY。\n\n您的任务：\n- 实现上述马尔可夫链模型。\n- 对每个测试用例，计算三元组 $[\\text{TotalCost}, \\text{TotalQALY}, \\text{NMB}]$。\n- 将 $\\text{TotalCost}$ 表示为美元，四舍五入到两位小数；将 $\\text{TotalQALY}$ 表示为年，四舍五入到四位小数；将 $\\text{NMB}$ 表示为美元，四舍五入到两位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号包围，每个元素是对应测试用例的三元素列表，顺序与上述指定相同（例如，$[[c_1,q_1,n_1],[c_2,q_2,n_2],\\dots]$）。",
            "solution": "所提出的问题是一个定义明确的离散时间马尔可夫链在卫生经济学评估中的应用，这是医疗决策和卫生技术评估中的一种标准方法。它具有科学依据，数学上一致，并且提供了获得唯一解所需的所有参数。因此，该问题被认为是有效的。\n\n解决方案的核心是在指定的时间跨度内，模拟一个患有慢性鼻-鼻窦炎伴鼻息肉（CRSwNP）的患者队列，追踪他们在不同治疗策略下疾病状态的演变以及相关的成本和健康产出。该模型以离散的时间步（即周期）运行，每个周期代表1个月。\n\n该模型由5个互斥的健康状态定义：受控（C）、未受控（U）、手术（S）、口服皮质类固醇冲击治疗（B）和不良事件（A）。在任何时间点 $t$，队列的状态由一个概率向量 $p_t = [p_t(C), p_t(U), p_t(S), p_t(B), p_t(A)]$ 描述，其中每个分量代表队列中处于相应状态的比例，且 $\\sum_{i} p_t(i) = 1$。问题指定了一个初始状态，即整个队列从未受控状态开始，因此时间 $t=0$ 时的初始状态向量为 $p_0 = [0, 1, 0, 0, 0]$。\n\n系统的演变遵循马尔可夫属性，即下一个周期的状态分布 $p_{t+1}$ 仅取决于当前分布 $p_t$ 和一个转移概率矩阵 $P$。它们之间的关系由矩阵乘法 $p_{t+1} = p_t P$ 给出。问题提供了两个不同的转移矩阵：$P_{\\text{SOC}}$ 用于标准治疗策略，$P_{\\text{BIO}}$ 用于生物制剂疗法策略。\n\n模拟迭代进行，总共 $T$ 个周期（月）。对于从 $1$ 到 $T$ 的每个周期 $t$，我们执行以下步骤：\n1. 周期 $t$ 开始时的状态分布为 $p_{t-1}$。\n2. 周期 $t$ 的期望成本根据状态分布 $p_{t-1}$ 计算。此成本是状态依赖性期望成本和任何特定治疗成本的总和。期望状态成本是状态分布向量 $p_{t-1}$ 与状态成本向量 $c = [c_C, c_U, c_S, c_B, c_A]$ 的点积。如果在周期 $t$ 使用生物制剂（由 $\\delta_t = 1$ 表示），则加上固定的生物制剂成本 $c_{\\text{bio}}$。公式为：\n$$\n\\text{Cost}_t = (p_{t-1} \\cdot c) + \\delta_t \\cdot c_{\\text{bio}}\n$$\n3. 周期 $t$ 的期望健康效用同样通过计算 $p_{t-1}$ 与健康状态效用向量 $u = [u_C, u_U, u_S, u_B, u_A]$ 的点积得到。通过乘以周期长度的年数 $\\Delta = \\frac{1}{12}$，将此效用转换为质量调整生命年（QALYs）：\n$$\n\\text{QALY}_t = (p_{t-1} \\cdot u) \\cdot \\Delta\n$$\n4. 未来的成本和QALYs的价值低于当前的，这一概念通过贴现来体现。周期 $t$ 的成本和QALYs使用成本的年贴现率 $r_c$ 和QALYs的年贴show率 $r_q$ 贴现回现值。贴现后的值为：\n$$\n\\text{DCost}_t = \\text{Cost}_t \\cdot (1+r_c)^{-t/12} \\quad \\text{and} \\quad \\text{DQALY}_t = \\text{QALY}_t \\cdot (1+r_q)^{-t/12}\n$$\n这些贴现值在时间跨度 $T$ 内累加，以得出策略的总贴现成本和QALYs。\n$$\n\\text{TotalCost} = \\sum_{t=1}^{T} \\text{DCost}_t, \\quad \\text{TotalQALY} = \\sum_{t=1}^{T} \\text{DQALY}_t\n$$\n5. 在计算完周期 $t$ 的回报后，使用适当的、取决于当前策略的转移矩阵 $P_t$ 来更新下一个周期 $t+1$ 开始时的状态分布：$p_t = p_{t-1} P_t$。\n\n三种策略的实现如下：\n- **策略 $\\mathcal{S}_1$（持续生物制剂）：** 对于所有周期 $t \\in \\{1,\\dots,T\\}$，生物制剂均处于激活状态（$\\delta_t=1$），因此转移矩阵为 $P_{\\text{BIO}}$，并增加成本 $c_{\\text{bio}}$。\n- **策略 $\\mathcal{S}_2$（标准治疗）：** 对于所有周期 $t \\in \\{1,\\dots,T\\}$，生物制剂均不激活（$\\delta_t=0$），转移矩阵为 $P_{\\text{SOC}}$，且不增加生物制剂成本。\n- **策略 $\\mathcal{S}_3$（适应性停药）：** 这是一种动态策略。在前12个周期，它遵循生物制剂策略（$\\delta_t=1, P_t = P_{\\text{BIO}}$）。在第12个周期结束时，对状态分布 $p_{12}$ 进行评估。如果处于“受控”状态的患者比例 $p_{12}(C)$ 达到或超过阈值 $\\theta$，则策略在所有后续周期切换为标准治疗（$t \\ge 13$, $\\delta_t=0$, $P_t = P_{\\text{SOC}}$）。否则，继续执行生物制剂策略。\n\n最后，为了在统一的尺度上比较这些策略，计算了净货币获益（NMB）。NMB使用支付意愿阈值 $\\lambda$（美元/QALY）将健康增益（TotalQALY）转换为货币价值，并减去总成本。\n$$\n\\text{NMB} = \\lambda \\cdot \\text{TotalQALY} - \\text{TotalCost}\n$$\n这些计算是使用 `numpy` 库实现的，以进行高效的向量和矩阵运算。通过使用指定的参数运行模拟来处理每个测试用例，并按要求计算和舍入最终的 $[\\text{TotalCost}, \\text{TotalQALY}, \\text{NMB}]$ 三元组。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define model parameters, run test cases, and print results.\n    \"\"\"\n    # Define fixed model parameters as specified in the problem statement\n    # Standard of Care (SOC) Transition Matrix\n    P_SOC = np.array([\n        [0.75, 0.15, 0.03, 0.05, 0.02],\n        [0.30, 0.45, 0.10, 0.10, 0.05],\n        [0.55, 0.25, 0.05, 0.10, 0.05],\n        [0.40, 0.40, 0.05, 0.10, 0.05],\n        [0.35, 0.45, 0.04, 0.06, 0.10]\n    ])\n    \n    # Biologic (BIO) Transition Matrix\n    P_BIO = np.array([\n        [0.85, 0.10, 0.01, 0.02, 0.02],\n        [0.50, 0.35, 0.05, 0.06, 0.04],\n        [0.65, 0.25, 0.02, 0.05, 0.03],\n        [0.55, 0.35, 0.03, 0.04, 0.03],\n        [0.40, 0.45, 0.03, 0.04, 0.08]\n    ])\n\n    # Per-cycle state costs and biologic cost. State order: [C, U, S, B, A]\n    c_base = np.array([150., 300., 5000., 200., 400.])\n    c_bio = 2000.\n\n    # Per-cycle health state utilities\n    u = np.array([0.90, 0.65, 0.50, 0.60, 0.55])\n    \n    # Initial state distribution: all patients start Uncontrolled (U)\n    p0 = np.array([0., 1., 0., 0., 0.])\n    \n    # Constants for QALYs and NMB\n    lambda_wtp = 100000.\n    cycle_duration_in_years = 1.0 / 12.0\n\n    def run_markov_model(T, r_c, r_q, strategy, theta, c_A_override):\n        \"\"\"\n        Executes the discrete-time Markov chain simulation for a given strategy and parameters.\n        \"\"\"\n        # Set the cost vector for this specific run, overriding c_A if necessary\n        cost_vector = c_base.copy()\n        cost_vector[4] = c_A_override\n        \n        # Initialize state probability vector and cumulative results\n        p_current = p0.copy()\n        total_discounted_cost = 0.0\n        total_discounted_qaly = 0.0\n        \n        # Flag for the adaptive strategy S3\n        use_soc_from_cycle_13 = False\n\n        # Main simulation loop over T months (cycles)\n        for t in range(1, T + 1):\n            # 1. Determine the active strategy for the current cycle 't'\n            transition_matrix = None\n            is_biologic_active = 0\n            \n            if strategy == 'S1':\n                is_biologic_active = 1\n                transition_matrix = P_BIO\n            elif strategy == 'S2':\n                is_biologic_active = 0\n                transition_matrix = P_SOC\n            elif strategy == 'S3':\n                if t = 12:\n                    is_biologic_active = 1\n                    transition_matrix = P_BIO\n                else:  # t > 12\n                    if use_soc_from_cycle_13:\n                        is_biologic_active = 0\n                        transition_matrix = P_SOC\n                    else:\n                        is_biologic_active = 1\n                        transition_matrix = P_BIO\n            \n            # 2. Calculate expected cost and QALYs for the current cycle\n            # These are based on the state probabilities at the *start* of the cycle (p_current)\n            cycle_cost = np.dot(p_current, cost_vector) + is_biologic_active * c_bio\n            cycle_qaly = np.dot(p_current, u) * cycle_duration_in_years\n            \n            # 3. Apply discounting and accumulate totals\n            discount_factor_cost = (1.0 + r_c)**(-t / 12.0)\n            discount_factor_qaly = (1.0 + r_q)**(-t / 12.0)\n            \n            total_discounted_cost += cycle_cost * discount_factor_cost\n            total_discounted_qaly += cycle_qaly * discount_factor_qaly\n            \n            # 4. Update the state probability vector for the next cycle\n            p_current = np.dot(p_current, transition_matrix)\n            \n            # 5. For S3, check the condition at the end of cycle 12\n            if strategy == 'S3' and t == 12:\n                # p_current is now p_12, the distribution at the start of cycle 13\n                # The state C (Controlled) is at index 0\n                if p_current[0] >= theta:\n                    use_soc_from_cycle_13 = True\n        \n        # Calculate Net Monetary Benefit (NMB)\n        nmb = lambda_wtp * total_discounted_qaly - total_discounted_cost\n        \n        # Return results rounded to the specified precision\n        return [\n            round(total_discounted_cost, 2),\n            round(total_discounted_qaly, 4),\n            round(nmb, 2)\n        ]\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {'T': 60, 'r_c': 0.03, 'r_q': 0.03, 'strategy': 'S1', 'theta': None, 'c_A': 400},\n        {'T': 60, 'r_c': 0.03, 'r_q': 0.03, 'strategy': 'S2', 'theta': None, 'c_A': 400},\n        {'T': 60, 'r_c': 0.03, 'r_q': 0.03, 'strategy': 'S3', 'theta': 0.60, 'c_A': 400},\n        {'T': 60, 'r_c': 0.00, 'r_q': 0.00, 'strategy': 'S1', 'theta': None, 'c_A': 800},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_markov_model(\n            T=case['T'],\n            r_c=case['r_c'],\n            r_q=case['r_q'],\n            strategy=case['strategy'],\n            theta=case['theta'],\n            c_A_override=case['c_A']\n        )\n        results.append(result)\n\n    # Format the final output string to be a list of lists with no spaces\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}