{
    "hands_on_practices": [
        {
            "introduction": "这项实践专注于一项核心临床技能：解读纯音测听图数据。我们将学习如何计算气骨导差（Air-Bone Gap, ABG）和纯音平均阈（Pure-Tone Average, PTA），它们是量化传导性听力损失和确定患者是否适合接受镫骨切除术的关键指标。本练习旨在架起原始数据与临床判断之间的桥梁 。",
            "id": "5057414",
            "problem": "一位临床特征与窗性耳硬化症相符的患者前来评估是否适合进行镫骨手术。耳硬化症因镫骨足板固定而产生传导性听力损失成分，典型表现为气导阈值与骨导阈值之间的差异增大。现提供以下单耳纯音听力测试结果，以分贝听力级（dB HL）报告，并已根据需要进行掩蔽。频率和阈值如下：\n\n- 频率 $500$ Hz：气导 $50$，骨导 $20$。\n- 频率 $1000$ Hz：气导 $45$，骨导 $15$。\n- 频率 $2000$ Hz：气导 $50$，骨导 $25$。\n- 频率 $3000$ Hz：气导 $40$，骨导 $15$。\n\n任务：\n1) 基于到达耳蜗的气导和骨导途径的根本区别，用精确的听力学术语定义气骨导差（ABG）和纯音平均阈（PTA）。\n2) 使用所给的阈值，计算每个所列频率下的ABG，然后计算$0.5$–$3$千赫兹范围内的平均ABG。\n3) 计算$0.5$–$2$千赫兹范围内的三频骨导PTA。\n4) 假设镫骨手术的适用条件要求：在$0.5$–$3$千赫兹范围内的平均ABG至少为$20$分贝，且在$0.5$–$2$千赫兹范围内的骨导PTA不差于$30$分贝听力级。将适用余量 $M$ 定义为平均ABG与$20$分贝之差，即 $M=\\overline{\\Delta}_{\\text{ABG}}-20$。报告 $M$ 的值。\n\n以分贝（dB）为单位表示最终报告值，并将您的答案四舍五入至四位有效数字。",
            "solution": "在进行求解之前，将首先对问题的科学合理性、完整性和客观性进行验证。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n问题提供了以下数据和定义：\n- 患有窗性耳硬化症临床特征的患者。\n- 纯音听力测试阈值，单位为分贝听力级 (dB HL)：\n  - 在频率 $f_1 = 500$ Hz：气导 $AC_1 = 50$，骨导 $BC_1 = 20$。\n  - 在频率 $f_2 = 1000$ Hz：气导 $AC_2 = 45$，骨导 $BC_2 = 15$。\n  - 在频率 $f_3 = 2000$ Hz：气导 $AC_3 = 50$，骨导 $BC_3 = 25$。\n  - 在频率 $f_4 = 3000$ Hz：气导 $AC_4 = 40$，骨导 $BC_4 = 15$。\n- 镫骨手术适用标准：\n  - $0.5$–$3$ 千赫兹范围内的平均气骨导差 ($\\overline{\\Delta}_{\\text{ABG}}$) 必须至少为 $20$ dB。\n  - $0.5$–$2$ 千赫兹范围内的三频骨导纯音平均阈 ($PTA_{BC}$) 不得差于 $30$ dB HL。\n- 适用余量定义：$M = \\overline{\\Delta}_{\\text{ABG}} - 20$。\n- $M$ 的最终答案需以分贝（dB）为单位报告，并四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学性**：该问题基于听力学和耳鼻喉科学的标准原理。气导、骨导、气骨导差（ABG）、纯音平均阈（PTA）和耳硬化症等概念是基础性的，并且描述准确。所提供的听力测试数据对于因镫骨固定导致传导性听力损失的患者在临床上是合理的。\n- **适定性**：该问题结构清晰，有明确定义的任务、给定的数据以及清晰的公式或计算规则。所有必需信息均已提供，且各项任务导向一个单一、唯一的解。\n- **客观性**：问题陈述基于定量数据和标准临床定义。它不含主观、模糊或基于观点的语言。\n问题被认为是完整、一致且科学有效的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**解答**\n\n**任务1：气骨导差（ABG）和纯音平均阈（PTA）的定义**\n听觉系统可以通过两种主要途径受到刺激。气导（AC）涉及声音通过外耳（耳道）、中耳（鼓膜和听小骨）传入内耳（耳蜗）。骨导（BC）则绕过外耳和中耳，通过颅骨直接将声音振动传递到耳蜗。\n\n- **气骨导差（ABG）** 在特定频率下定义为气导听阈与骨导听阈之间的差值，两者均以分贝听力级（dB HL）为单位。数学上，如果 $AC_f$ 和 $BC_f$ 是频率 $f$ 下的阈值，则 ABG 为 $\\Delta_{\\text{ABG}}(f) = AC_f - BC_f$。ABG 量化了由传导通路（即外耳或中耳）功能障碍引起的听力敏感度损失。在耳硬化症中，中耳镫骨的固定阻碍了声音的传输，从而产生显著的 ABG。\n\n- **纯音平均阈（PTA）** 是一个衡量听力敏感度的综合指标，计算方法是在一组指定的标准频率下，取听阈的算术平均值。它可以针对气导阈值或骨导阈值进行计算。它提供一个单一数值，常用于对听力损失的程度进行分类。\n\n**任务2：气骨导差与平均ABG的计算**\n使用提供的阈值，我们计算每个频率下的ABG：\n- 在 $f_1 = 500$ Hz：$\\Delta_{\\text{ABG}}(500) = AC_1 - BC_1 = 50 - 20 = 30$ dB。\n- 在 $f_2 = 1000$ Hz：$\\Delta_{\\text{ABG}}(1000) = AC_2 - BC_2 = 45 - 15 = 30$ dB。\n- 在 $f_3 = 2000$ Hz：$\\Delta_{\\text{ABG}}(2000) = AC_3 - BC_3 = 50 - 25 = 25$ dB。\n- 在 $f_4 = 3000$ Hz：$\\Delta_{\\text{ABG}}(3000) = AC_4 - BC_4 = 40 - 15 = 25$ dB。\n\n在指定频率（$500$、$1000$、$2000$ 和 $3000$ Hz）范围内的平均ABG，记为 $\\overline{\\Delta}_{\\text{ABG}}$，是这些值的算术平均值：\n$$\n\\overline{\\Delta}_{\\text{ABG}} = \\frac{\\Delta_{\\text{ABG}}(500) + \\Delta_{\\text{ABG}}(1000) + \\Delta_{\\text{ABG}}(2000) + \\Delta_{\\text{ABG}}(3000)}{4}\n$$\n$$\n\\overline{\\Delta}_{\\text{ABG}} = \\frac{30 + 30 + 25 + 25}{4} = \\frac{110}{4} = 27.5 \\text{ dB}\n$$\n\n**任务3：骨导PTA的计算**\n三频骨导PTA（$PTA_{BC}$）是使用 $0.5$、$1$ 和 $2$ 千赫兹（即 $500$ Hz、$1000$ Hz 和 $2000$ Hz）频率下的骨导阈值计算的。\n$$\nPTA_{BC} = \\frac{BC_{500} + BC_{1000} + BC_{2000}}{3}\n$$\n使用所给数据，其中 $BC_{500}=20$，$BC_{1000}=15$，$BC_{2000}=25$：\n$$\nPTA_{BC} = \\frac{20 + 15 + 25}{3} = \\frac{60}{3} = 20 \\text{ dB HL}\n$$\n\n**任务4：适用余量 $M$ 的计算**\n首先，我们评估患者是否满足镫骨手术的标准。\n- 标准 $1$：平均ABG是否至少为 $20$ dB？\n我们计算出的 $\\overline{\\Delta}_{\\text{ABG}}$ 为 $27.5$ dB。由于 $27.5 \\ge 20$，此标准已满足。\n- 标准 $2$：骨导PTA是否不差于 $30$ dB HL（即 $PTA_{BC} \\le 30$ dB HL）？\n我们计算出的 $PTA_{BC}$ 为 $20$ dB HL。由于 $20 \\le 30$，此标准也已满足。\n\n患者适合进行手术。适用余量 $M$ 定义为 $M = \\overline{\\Delta}_{\\text{ABG}} - 20$。\n代入我们计算出的平均ABG值：\n$$\nM = 27.5 - 20 = 7.5 \\text{ dB}\n$$\n问题要求最终答案四舍五入至四位有效数字。因此，$M = 7.500$ dB。",
            "answer": "$$\n\\boxed{7.500}\n$$"
        },
        {
            "introduction": "在决定手术后，下一步自然是预测手术结果。本练习通过计算预期的术后听力水平来模拟这一过程，其中考虑了假体的效能和Carhart切迹消失等生理变化。掌握这一技能有助于管理患者期望和评估手术成功率 。",
            "id": "5057474",
            "problem": "一名临床诊断为耳硬化症的患者接受了无并发症的镫骨切除术。术前在标准频率 $0.5$、$1$、$2$ 和 $4$ 千赫兹下的气导和骨导纯音听阈（纯音测听）如下（单位：分贝听力级）：\n- 在 $0.5$ 千赫兹处：气导 $= 55\\,\\mathrm{dB\\ HL}$，骨导 $= 20\\,\\mathrm{dB\\ HL}$。\n- 在 $1$ 千赫兹处：气导 $= 60\\,\\mathrm{dB\\ HL}$，骨导 $= 25\\,\\mathrm{dB\\ HL}$。\n- 在 $2$ 千赫兹处：气导 $= 65\\,\\mathrm{dB\\ HL}$，骨导 $= 40\\,\\mathrm{dB\\ HL}$。\n- 在 $4$ 千赫兹处：气导 $= 60\\,\\mathrm{dB\\ HL}$，骨导 $= 30\\,\\mathrm{dB\\ HL}$。\n\n假设术后出现以下普遍观察到的变化：\n- 人工听骨通过频率相关的有效增益恢复传导功能，在 $0.5$ 千赫兹、$1$ 千赫兹、$2$ 千赫兹和 $4$ 千赫兹的气导通路中，增益分别为 $30\\,\\mathrm{dB}$、$30\\,\\mathrm{dB}$、$25\\,\\mathrm{dB}$ 和 $20\\,\\mathrm{dB}$。\n- 卡哈特切迹（Carhart notch）的逆转使得骨导听阈在 $2$ 千赫兹处改善 $10\\,\\mathrm{dB}$，在其他所列频率处改善 $0\\,\\mathrm{dB}$。\n\n基于听力学的第一性原理和核心定义，使用以下物理和生理约束：\n- 频率 $f$ 处的气骨导差定义为 $ABG(f) = AC(f) - BC(f)$。\n- 术后，气导听阈不能优于（即低于）同频率的骨导听阈，即 $AC_{\\text{post}}(f) \\geq BC_{\\text{post}}(f)$，因此术后气骨导差为负在物理上是不可实现的。\n\n计算预期的术后四频率纯音平均气骨导差，其定义为 $0.5$、$1$、$2$ 和 $4$ 千赫兹术后气骨导差的算术平均值。然后，使用手术成功的标准（即残余平均气骨导差小于 $10\\,\\mathrm{dB\\ HL}$），确定此术后平均气骨导差的期望值。仅报告此预期平均值（单位为分贝听力级），作为你的最终答案，并四舍五入到三位有效数字。",
            "solution": "用户希望我按照以下步骤解决问题：\n1.  验证问题是否有效且定义明确。\n2.  如果有效，则继续计算。如果无效，则说明无效的原因并停止。\n3.  所有数学量必须使用 LaTeX 格式。\n4.  最终结果应采用指定格式，并用方框括起来。\n\n首先，我将验证问题。\n\n### 步骤 1：提取已知条件。\n该问题提供以下信息：\n-   **分析频率**： $f \\in \\{0.5, 1, 2, 4\\}\\,\\mathrm{kHz}$。\n-   **术前气导 (AC) 听阈**：\n    -   $AC_{\\text{pre}}(0.5\\,\\mathrm{kHz}) = 55\\,\\mathrm{dB\\ HL}$\n    -   $AC_{\\text{pre}}(1\\,\\mathrm{kHz}) = 60\\,\\mathrm{dB\\ HL}$\n    -   $AC_{\\text{pre}}(2\\,\\mathrm{kHz}) = 65\\,\\mathrm{dB\\ HL}$\n    -   $AC_{\\text{pre}}(4\\,\\mathrm{kHz}) = 60\\,\\mathrm{dB\\ HL}$\n-   **术前骨导 (BC) 听阈**：\n    -   $BC_{\\text{pre}}(0.5\\,\\mathrm{kHz}) = 20\\,\\mathrm{dB\\ HL}$\n    -   $BC_{\\text{pre}}(1\\,\\mathrm{kHz}) = 25\\,\\mathrm{dB\\ HL}$\n    -   $BC_{\\text{pre}}(2\\,\\mathrm{kHz}) = 40\\,\\mathrm{dB\\ HL}$\n    -   $BC_{\\text{pre}}(4\\,\\mathrm{kHz}) = 30\\,\\mathrm{dB\\ HL}$\n-   **人工听骨在气导通路中的有效增益**：\n    -   $G_{AC}(0.5\\,\\mathrm{kHz}) = 30\\,\\mathrm{dB}$\n    -   $G_{AC}(1\\,\\mathrm{kHz}) = 30\\,\\mathrm{dB}$\n    -   $G_{AC}(2\\,\\mathrm{kHz}) = 25\\,\\mathrm{dB}$\n    -   $G_{AC}(4\\,\\mathrm{kHz}) = 20\\,\\mathrm{dB}$\n-   **骨导听阈的改善（卡哈特切迹逆转）**：\n    -   $I_{BC}(2\\,\\mathrm{kHz}) = 10\\,\\mathrm{dB}$\n    -   $I_{BC}(f) = 0\\,\\mathrm{dB}$ for $f \\in \\{0.5, 1, 4\\}\\,\\mathrm{kHz}$\n-   **气骨导差 (ABG) 的定义**： $ABG(f) = AC(f) - BC(f)$。\n-   **物理约束**：术后气导听阈不能优于（低于）术后骨导听阈，即 $AC_{\\text{post}}(f) \\geq BC_{\\text{post}}(f)$。\n\n### 步骤 2：使用提取的已知条件进行验证。\n-   **科学依据**：该问题在科学上植根于听力学，这是耳鼻喉科的一个亚专业。耳硬化症、镫骨切除术、纯音测听、气导和骨导、气骨导差以及卡哈特切迹等概念都是该领域的标准和公认概念。术前听力损失和预期手术增益的数值在临床上是现实的。\n-   **适定性**：该问题是适定的。它提供了计算唯一数值答案所需的所有数据和关系。定义和约束条件清晰明确。\n-   **客观性**：问题陈述是客观的，没有主观论断。它依赖于标准的临床定义和定量数据。\n-   **一致性和完整性**：该问题在内部是一致且完整的。提供了所有必需的数值，并且已知条件之间没有矛盾。物理约束是一条关键信息，它使问题更符合实际，并已恰当包含。\n\n### 步骤 3：结论和行动。\n问题有效。我将继续进行完整解答。\n\n该问题要求计算预期的术后四频率纯音平均气骨导差。这将通过一系列步骤完成：\n1.  计算每个频率的术后骨导听阈。\n2.  根据人工听骨的增益计算理想的术后气导听阈。\n3.  应用“气导听阈不能优于骨导听阈”的物理约束，来确定实际的术后气导听阈。\n4.  计算每个频率的术后气骨导差。\n5.  计算这四个气骨导差的算术平均值。\n\n设 $AC_{\\text{pre}}(f)$ 和 $BC_{\\text{pre}}(f)$ 为频率 $f$ 处的术前气导和骨导听阈。设 $AC_{\\text{post}}(f)$ 和 $BC_{\\text{post}}(f)$ 为相应的术后听阈。\n\n**步骤 1：计算术后骨导听阈 ($BC_{\\text{post}}$)**\n术后骨导听阈是术前听阈减去因卡哈特切迹逆转带来的改善量 $I_{BC}(f)$。改善对应于听阈值（以 dB HL 计）的降低。\n$BC_{\\text{post}}(f) = BC_{\\text{pre}}(f) - I_{BC}(f)$\n\n-   在 $f = 0.5\\,\\mathrm{kHz}$ 处：\n    $BC_{\\text{post}}(0.5) = BC_{\\text{pre}}(0.5) - I_{BC}(0.5) = 20\\,\\mathrm{dB\\ HL} - 0\\,\\mathrm{dB} = 20\\,\\mathrm{dB\\ HL}$\n-   在 $f = 1\\,\\mathrm{kHz}$ 处：\n    $BC_{\\text{post}}(1) = BC_{\\text{pre}}(1) - I_{BC}(1) = 25\\,\\mathrm{dB\\ HL} - 0\\,\\mathrm{dB} = 25\\,\\mathrm{dB\\ HL}$\n-   在 $f = 2\\,\\mathrm{kHz}$ 处：\n    $BC_{\\text{post}}(2) = BC_{\\text{pre}}(2) - I_{BC}(2) = 40\\,\\mathrm{dB\\ HL} - 10\\,\\mathrm{dB} = 30\\,\\mathrm{dB\\ HL}$\n-   在 $f = 4\\,\\mathrm{kHz}$ 处：\n    $BC_{\\text{post}}(4) = BC_{\\text{pre}}(4) - I_{BC}(4) = 30\\,\\mathrm{dB\\ HL} - 0\\,\\mathrm{dB} = 30\\,\\mathrm{dB\\ HL}$\n\n**步骤 2：计算理想术后气导听阈 ($AC_{\\text{post,ideal}}$)**\n理想术后气导听阈是术前听阈减去人工听骨带来的有效增益 $G_{AC}(f)$。\n$AC_{\\text{post,ideal}}(f) = AC_{\\text{pre}}(f) - G_{AC}(f)$\n\n-   在 $f = 0.5\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post,ideal}}(0.5) = AC_{\\text{pre}}(0.5) - G_{AC}(0.5) = 55\\,\\mathrm{dB\\ HL} - 30\\,\\mathrm{dB} = 25\\,\\mathrm{dB\\ HL}$\n-   在 $f = 1\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post,ideal}}(1) = AC_{\\text{pre}}(1) - G_{AC}(1) = 60\\,\\mathrm{dB\\ HL} - 30\\,\\mathrm{dB} = 30\\,\\mathrm{dB\\ HL}$\n-   在 $f = 2\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post,ideal}}(2) = AC_{\\text{pre}}(2) - G_{AC}(2) = 65\\,\\mathrm{dB\\ HL} - 25\\,\\mathrm{dB} = 40\\,\\mathrm{dB\\ HL}$\n-   在 $f = 4\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post,ideal}}(4) = AC_{\\text{pre}}(4) - G_{AC}(4) = 60\\,\\mathrm{dB\\ HL} - 20\\,\\mathrm{dB} = 40\\,\\mathrm{dB\\ HL}$\n\n**步骤 3：确定实际术后气导听阈 ($AC_{\\text{post}}$)**\n问题陈述了约束条件 $AC_{\\text{post}}(f) \\geq BC_{\\text{post}}(f)$。这意味着气导听力不能优于骨导听力（即内耳的潜力）。因此，实际的术后气导听阈是理想计算听阈和术后骨导听阈中的最大值。较高的 dB HL 值代表较差的听力。\n$AC_{\\text{post}}(f) = \\max(AC_{\\text{post,ideal}}(f), BC_{\\text{post}}(f))$\n\n-   在 $f = 0.5\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post}}(0.5) = \\max(25\\,\\mathrm{dB\\ HL}, 20\\,\\mathrm{dB\\ HL}) = 25\\,\\mathrm{dB\\ HL}$\n-   在 $f = 1\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post}}(1) = \\max(30\\,\\mathrm{dB\\ HL}, 25\\,\\mathrm{dB\\ HL}) = 30\\,\\mathrm{dB\\ HL}$\n-   在 $f = 2\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post}}(2) = \\max(40\\,\\mathrm{dB\\ HL}, 30\\,\\mathrm{dB\\ HL}) = 40\\,\\mathrm{dB\\ HL}$\n-   在 $f = 4\\,\\mathrm{kHz}$ 处：\n    $AC_{\\text{post}}(4) = \\max(40\\,\\mathrm{dB\\ HL}, 30\\,\\mathrm{dB\\ HL}) = 40\\,\\mathrm{dB\\ HL}$\n\n**步骤 4：计算术后气骨导差 ($ABG_{\\text{post}}$)**\n术后气骨导差定义为术后气导听阈与骨导听阈之差。\n$ABG_{\\text{post}}(f) = AC_{\\text{post}}(f) - BC_{\\text{post}}(f)$\n\n-   在 $f = 0.5\\,\\mathrm{kHz}$ 处：\n    $ABG_{\\text{post}}(0.5) = 25\\,\\mathrm{dB\\ HL} - 20\\,\\mathrm{dB\\ HL} = 5\\,\\mathrm{dB\\ HL}$\n-   在 $f = 1\\,\\mathrm{kHz}$ 处：\n    $ABG_{\\text{post}}(1) = 30\\,\\mathrm{dB\\ HL} - 25\\,\\mathrm{dB\\ HL} = 5\\,\\mathrm{dB\\ HL}$\n-   在 $f = 2\\,\\mathrm{kHz}$ 处：\n    $ABG_{\\text{post}}(2) = 40\\,\\mathrm{dB\\ HL} - 30\\,\\mathrm{dB\\ HL} = 10\\,\\mathrm{dB\\ HL}$\n-   在 $f = 4\\,\\mathrm{kHz}$ 处：\n    $ABG_{\\text{post}}(4) = 40\\,\\mathrm{dB\\ HL} - 30\\,\\mathrm{dB\\ HL} = 10\\,\\mathrm{dB\\ HL}$\n\n**步骤 5：计算平均术后气骨导差**\n最后一步是计算四个术后气骨导差的算术平均值。\n$Average ABG_{\\text{post}} = \\frac{1}{4} \\sum_{f} ABG_{\\text{post}}(f)$\n其中总和是针对频率 $f \\in \\{0.5, 1, 2, 4\\}\\,\\mathrm{kHz}$。\n\n$Average ABG_{\\text{post}} = \\frac{ABG_{\\text{post}}(0.5) + ABG_{\\text{post}}(1) + ABG_{\\text{post}}(2) + ABG_{\\text{post}}(4)}{4}$\n$Average ABG_{\\text{post}} = \\frac{5 + 5 + 10 + 10}{4}\\,\\mathrm{dB\\ HL}$\n$Average ABG_{\\text{post}} = \\frac{30}{4}\\,\\mathrm{dB\\ HL} = 7.5\\,\\mathrm{dB\\ HL}$\n\n问题要求答案四舍五入到三位有效数字。数值 $7.5$ 有两位有效数字。为了用三位有效数字表示，我们在末尾加一个零，得到 $7.50$。\n手术成功的背景标准（残余平均气骨导差小于 $10\\,\\mathrm{dB\\ HL}$）得到了满足，因为 $7.50\\,\\mathrm{dB\\ HL}  10\\,\\mathrm{dB\\ HL}$，但问题要求的是计算出的数值本身。",
            "answer": "$$\\boxed{7.50}$$"
        },
        {
            "introduction": "为获得更深入、基于物理学的理解，本练习将指导您构建一个中耳的计算模型。通过将听骨链表示为质量-弹簧-阻尼系统，我们可以模拟耳硬化症（刚度增加）如何损害声音传导，以及镫骨切除术假体如何恢复其功能。这项高级练习将临床观察与底层的生物力学原理联系起来 。",
            "id": "5057453",
            "problem": "你需要构建一个描述人中耳听小骨链的集总参数模型，该模型能够捕捉耳硬化症（镫骨足板硬度增加）和镫骨切除术（用假体替换镫骨）对从鼓膜（TM）上的声压到镫骨足板速度的频域传递函数的影响。使用以下基本原理：牛顿第二定律 $m \\ddot{x} = \\sum F$、线性弹簧的胡克定律 $F = k \\Delta x$ 以及线性粘滞阻尼 $F = c \\Delta \\dot{x}$。将系统建模为两个广义坐标：$x_1$ 代表锤骨-砧骨复合体，$x_2$ 代表镫骨足板。声学输入压力 $P_e$ 作用在鼓膜（TM）面积 $A$ 上，在锤骨-砧骨节点上产生驱动力 $F_e = P_e A$。假设系统处于角频率为 $\\omega = 2\\pi f$ 的线性时谐稳态运动，其中 $f$ 是以 $\\mathrm{Hz}$ 为单位的频率，$\\omega$ 是以 $\\mathrm{rad/s}$ 为单位的角频率。\n\n通过对每个质量块上由弹簧和阻尼器产生的力求和，构建运动方程。假设：\n- 刚度为 $k_1$ 的弹簧和阻尼为 $c_1$ 的阻尼器将 $x_1$ 连接到地（代表鼓膜和锤骨悬韧带的顺应性及损耗）。\n- 刚度为 $k_2$ 的弹簧和阻尼为 $c_2$ 的阻尼器连接 $x_1$ 和 $x_2$ （代表砧镫关节的顺应性及损耗）。\n- 刚度为 $k_3$ 的弹簧和阻尼为 $c_3$ 的阻尼器将 $x_2$ 连接到地（代表卵圆窗和耳蜗输入的顺应性及损耗）。\n- 质量 $m_1$ 代表锤骨-砧骨， $m_2$ 代表镫骨。\n\n使用 $x_j(t) = \\Re\\{X_j e^{i \\omega t}\\}$ 变换到频域，这样 $\\dot{x}_j \\rightarrow i \\omega X_j$ 且 $\\ddot{x}_j \\rightarrow -\\omega^2 X_j$。根据这些关系构建复机械阻抗矩阵，并求解得到的线性系统以获得 $X_2$。我们感兴趣的传递函数是单位声压下镫骨足板速度的幅值，$|H(\\omega)| = \\left|\\dfrac{V_2}{P_e}\\right|$，其中 $V_2 = i \\omega X_2$，单位为 $\\mathrm{m\\cdot s^{-1}\\cdot Pa^{-1}}$。\n\n使用以下标称参数（除非在测试案例中另有说明，否则保持不变）：\n- $m_1 = 5.0 \\times 10^{-5}\\,\\mathrm{kg}$。\n- $m_2 = 2.0 \\times 10^{-6}\\,\\mathrm{kg}$。\n- $k_1 = 1.0 \\times 10^{4}\\,\\mathrm{N/m}$。\n- $k_2 = 8.0 \\times 10^{4}\\,\\mathrm{N/m}$。\n- $k_3 = 1.0 \\times 10^{5}\\,\\mathrm{N/m}$ (基准足板硬度)。\n- $c_1 = 2.0 \\times 10^{-2}\\,\\mathrm{N\\cdot s/m}$。\n- $c_2 = 1.0 \\times 10^{-2}\\,\\mathrm{N\\cdot s/m}$。\n- $c_3 = 2.0 \\times 10^{-2}\\,\\mathrm{N\\cdot s/m}$。\n- $A = 5.5 \\times 10^{-5}\\,\\mathrm{m^2}$。\n\n你的程序必须计算以下测试套件中各案例的 $|H(\\omega)|$，每个案例由频率 $f$ 和任何与上述标称值的参数变化指定。当测试案例未列出某个参数时，请使用其标称值。\n\n测试套件：\n1. 中音频频率下的基准正常耳朵：$f = 1000\\,\\mathrm{Hz}$。\n2. 中度耳硬化症（足板硬度增加）：$f = 1000\\,\\mathrm{Hz}$，$k_3 = 4.0 \\times 10^{5}\\,\\mathrm{N/m}$。\n3. 极端硬化边界情况：$f = 1000\\,\\mathrm{Hz}$，$k_3 = 1.0 \\times 10^{7}\\,\\mathrm{N/m}$。\n4. 低频行为检查：$f = 100\\,\\mathrm{Hz}$（使用基准硬度）。\n5. 镫骨切除术后假体：$f = 1000\\,\\mathrm{Hz}$，$k_3 = 2.0 \\times 10^{5}\\,\\mathrm{N/m}$，$m_2 = 1.5 \\times 10^{-6}\\,\\mathrm{kg}$，$c_3 = 1.5 \\times 10^{-2}\\,\\mathrm{N\\cdot s/m}$。\n\n根据关系式 $\\omega = 2\\pi f$（其中 $f$ 的单位为 $\\mathrm{Hz}$），$\\omega$ 的角度单位是 $\\mathrm{radians}$。对于每个案例，计算传递函数幅值 $|H(\\omega)|$（单位为 $\\mathrm{m\\cdot s^{-1}\\cdot Pa^{-1}}$），并四舍五入到六位小数。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[ r_1, r_2, r_3, r_4, r_5 \\right]$），每个 $r_j$ 是对应测试案例（按上述顺序列出）的四舍五入后的浮点数结果。",
            "solution": "该问题要求建立并求解一个人中耳的双自由度集总参数模型，以确定从鼓膜压力到镫骨足板速度的传递函数。求解过程应用了力学的基本原理。\n\n首先，我们为两个广义坐标建立运动方程：$x_1(t)$ 代表锤骨-砧骨复合体，$x_2(t)$ 代表镫骨。这是通过对每个质量应用牛顿第二定律 $\\sum F = m\\ddot{x}$ 来实现的。\n\n对于质量 $m_1$，受力包括：\n- 来自鼓膜（TM）的外部驱动力：$F_e(t) = P_e(t) A$。\n- 来自鼓膜和悬韧带的恢复力，建模为连接到地的弹簧：$-k_1 x_1$。\n- 来自鼓膜和悬韧带的耗散力，建模为连接到地的阻尼器：$-c_1 \\dot{x}_1$。\n- 来自砧镫关节的耦合力，建模为 $m_1$ 和 $m_2$ 之间的弹簧：$-k_2 (x_1 - x_2)$。\n- 来自砧镫关节的耗散耦合力，建模为 $m_1$ 和 $m_2$ 之间的阻尼器：$-c_2 (\\dot{x}_1 - \\dot{x}_2)$。\n\n将这些力相加，得到第一个运动方程：\n$$m_1 \\ddot{x}_1 = F_e(t) - k_1 x_1 - c_1 \\dot{x}_1 - k_2 (x_1 - x_2) - c_2 (\\dot{x}_1 - \\dot{x}_2)$$\n整理各项，我们得到：\n$$m_1 \\ddot{x}_1 + (c_1 + c_2) \\dot{x}_1 + (k_1 + k_2) x_1 - c_2 \\dot{x}_2 - k_2 x_2 = F_e(t)$$\n\n对于质量 $m_2$，受力包括：\n- 来自砧镫关节的耦合力：$k_2 (x_1 - x_2)$。\n- 来自砧镫关节的耗散耦合力：$c_2 (\\dot{x}_1 - \\dot{x}_2)$。\n- 来自环状韧带和耳蜗负载的恢复力，建模为连接到地的弹簧：$-k_3 x_2$。\n- 来自环状韧带和耳蜗负载的耗散力，建模为连接到地的阻尼器：$-c_3 \\dot{x}_2$。\n\n将这些力相加，得到第二个运动方程：\n$$m_2 \\ddot{x}_2 = k_2 (x_1 - x_2) + c_2 (\\dot{x}_1 - \\dot{x}_2) - k_3 x_2 - c_3 \\dot{x}_2$$\n整理各项，我们得到：\n$$m_2 \\ddot{x}_2 + (c_2 + c_3) \\dot{x}_2 + (k_2 + k_3) x_2 - c_2 \\dot{x}_1 - k_2 x_1 = 0$$\n\n接下来，我们假设一个线性时谐稳态响应，将这些微分方程转换为频域中的代数方程。设变量的复振幅为 $X_1$、$X_2$ 和 $P_e$，使得 $x_j(t) = \\Re\\{X_j e^{i \\omega t}\\}$ 且 $P_e(t) = \\Re\\{P_e e^{i \\omega t}\\}$。时间导数变换为 $\\dot{x}_j \\rightarrow i \\omega X_j$ 和 $\\ddot{x}_j \\rightarrow -\\omega^2 X_j$，其中 $\\omega = 2\\pi f$ 是角频率。\n\n将此变换应用于运动方程，得到：\n$$(-\\omega^2 m_1 + i\\omega(c_1 + c_2) + k_1 + k_2) X_1 - (i\\omega c_2 + k_2) X_2 = P_e A$$\n$$-(i\\omega c_2 + k_2) X_1 + (-\\omega^2 m_2 + i\\omega(c_2 + c_3) + k_2 + k_3) X_2 = 0$$\n\n这个线性方程组可以写成矩阵形式 $\\mathbf{Z}(\\omega) \\mathbf{X} = \\mathbf{F}$，其中 $\\mathbf{Z}(\\omega)$ 是复机械阻抗矩阵：\n$$\n\\begin{bmatrix} Z_{11}(\\omega)  Z_{12}(\\omega) \\\\ Z_{21}(\\omega)  Z_{22}(\\omega) \\end{bmatrix} \\begin{bmatrix} X_1 \\\\ X_2 \\end{bmatrix} = \\begin{bmatrix} P_e A \\\\ 0 \\end{bmatrix}\n$$\n阻抗矩阵的元素为：\n- $Z_{11}(\\omega) = (k_1 + k_2 - \\omega^2 m_1) + i\\omega(c_1 + c_2)$\n- $Z_{22}(\\omega) = (k_2 + k_3 - \\omega^2 m_2) + i\\omega(c_2 + c_3)$\n- $Z_{12}(\\omega) = Z_{21}(\\omega) = -(k_2 + i\\omega c_2)$\n\n我们需要求解镫骨的复位移 $X_2$。使用 Cramer's rule：\n$$X_2 = \\frac{\\det \\begin{pmatrix} Z_{11}  P_e A \\\\ Z_{21}  0 \\end{pmatrix}}{\\det \\begin{pmatrix} Z_{11}  Z_{12} \\\\ Z_{21}  Z_{22} \\end{pmatrix}} = \\frac{-Z_{21} P_e A}{Z_{11} Z_{22} - Z_{12} Z_{21}}$$\n代入 $Z_{12} = Z_{21}$ 和 $Z_{21}$ 的表达式：\n$$X_2 = \\frac{-[-(k_2 + i\\omega c_2)] P_e A}{Z_{11} Z_{22} - [-(k_2 + i\\omega c_2)]^2} = \\frac{(k_2 + i\\omega c_2) P_e A}{Z_{11} Z_{22} - (k_2 + i\\omega c_2)^2}$$\n\n问题要求的是从输入压力 $P_e$ 到镫骨速度 $V_2$ 的传递函数。镫骨速度的复振幅是 $V_2 = i\\omega X_2$。因此，传递函数 $H(\\omega)$ 是：\n$$H(\\omega) = \\frac{V_2}{P_e} = \\frac{i\\omega X_2}{P_e}$$\n代入 $X_2$ 的表达式：\n$$H(\\omega) = \\frac{i\\omega (k_2 + i\\omega c_2) A}{Z_{11}(\\omega) Z_{22}(\\omega) - (k_2 + i\\omega c_2)^2}$$\n\n最终需要计算的是这个复传递函数的幅值 $|H(\\omega)|$。实现方式是：针对每个测试案例的参数，计算 $Z_{11}$、$Z_{22}$ 和耦合项 $k_2 + i\\omega c_2$ 的复数值，将它们代入 $H(\\omega)$ 的表达式中，然后计算所得复数的绝对值。\n所提供的测试套件通过系统地改变参数 $f$、$k_3$、$m_2$ 和 $c_3$，来探索模型在标称条件、病理条件（耳硬化症）、术后条件（镫骨切除术）以及不同频率下的行为。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the middle ear transfer function for a suite of test cases.\n    \"\"\"\n\n    # Nominal parameters\n    nominal_params = {\n        'm1': 5.0e-5,  # kg\n        'm2': 2.0e-6,  # kg\n        'k1': 1.0e4,   # N/m\n        'k2': 8.0e4,   # N/m\n        'k3': 1.0e5,   # N/m\n        'c1': 2.0e-2,  # Ns/m\n        'c2': 1.0e-2,  # Ns/m\n        'c3': 2.0e-2,  # Ns/m\n        'A': 5.5e-5    # m^2\n    }\n\n    # Test suite definitions\n    test_cases = [\n        # Case 1: Baseline normal ear at mid-audio frequency\n        {'f': 1000.0},\n        # Case 2: Moderate otosclerosis\n        {'f': 1000.0, 'k3': 4.0e5},\n        # Case 3: Extreme stiffening\n        {'f': 1000.0, 'k3': 1.0e7},\n        # Case 4: Low-frequency behavior check\n        {'f': 100.0},\n        # Case 5: Post-stapedectomy prosthesis\n        {'f': 1000.0, 'k3': 2.0e5, 'm2': 1.5e-6, 'c3': 1.5e-2},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Create a parameter set for the current case\n        params = nominal_params.copy()\n        params.update(case)\n\n        f = params['f']\n        m1, m2 = params['m1'], params['m2']\n        k1, k2, k3 = params['k1'], params['k2'], params['k3']\n        c1, c2, c3 = params['c1'], params['c2'], params['c3']\n        A = params['A']\n\n        # Angular frequency\n        omega = 2 * np.pi * f\n\n        # Define complex impedance terms\n        # Note: 1j is the imaginary unit in Python\n        \n        # Z11 = (k1 + k2 - omega^2 * m1) + i*omega*(c1 + c2)\n        z11 = (k1 + k2 - omega**2 * m1) + 1j * omega * (c1 + c2)\n        \n        # Z22 = (k2 + k3 - omega^2 * m2) + i*omega*(c2 + c3)\n        z22 = (k2 + k3 - omega**2 * m2) + 1j * omega * (c2 + c3)\n        \n        # Coupling impedance term: Z_c = k2 + i*omega*c2\n        # The off-diagonal terms of the impedance matrix are Z12 = Z21 = -Z_c\n        z_c = k2 + 1j * omega * c2\n        \n        # Calculate the transfer function H(omega) = V2 / Pe\n        # H(omega) = (i*omega * X2) / Pe\n        # X2/Pe = (k2 + i*omega*c2) * A / (Z11 * Z22 - (k2 + i*omega*c2)^2)\n        # H(omega) = i*omega * (z_c * A) / (z11 * z22 - z_c**2)\n        \n        numerator = 1j * omega * z_c * A\n        denominator = z11 * z22 - z_c**2\n        \n        h_omega = numerator / denominator\n        \n        # The result is the magnitude of the transfer function\n        magnitude = np.abs(h_omega)\n        \n        results.append(round(magnitude, 6))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}