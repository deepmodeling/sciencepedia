{
    "hands_on_practices": [
        {
            "introduction": "龋病学的核心概念之一是Stephan曲线，它描述了牙菌斑在接触可发酵碳水化合物后$pH$值的动态变化。本练习旨在通过一个定量模型来深化您对这一过程的理解。通过计算产酸速率、菌斑体积和缓冲能力对$pH$值下降的影响，您将能亲手把握导致牙釉质脱矿的化学驱动力 ()。",
            "id": "4734036",
            "problem": "在暴露于蔗糖后的初始阶段，监测一个以产乳酸链球菌（例如，变形链球菌 Streptococcus mutans (S. mutans)）为主的牙菌斑微菌落。假设存在以下科学依据：(i) 菌斑控制体积内产生的非挥发性酸的质量守恒，(ii) 缓冲容量这个强度性质，在初始氢离子电位下定义为 $ \\beta = \\left.\\frac{dC_{b}}{d\\,pH}\\right|_{pH_0} $，单位为 $ \\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\text{每pH单位} $，它量化了使$pH$改变一个单位所需的强碱浓度的变化，并且根据小扰动的对称性，通过 $ dC_{a} = -\\beta\\, dpH $ 将增加的强一元酸浓度增量 $dC_{a}$ 与相反的 $dpH$ 在 $pH_0$ 附近关联起来，以及 (iii) 在一个短暂的观察窗口内，该系统可被视为一个混合均匀的隔室，其酸清除率可忽略不计，且在 $ pH_0 $ 附近的 $ \\beta $ 不随时间变化。测量得到该微菌落的乳酸产生速率在时间间隔 $ \\Delta t $ 内为常数 $ q_{acid} $（单位为 $ \\mathrm{mol}\\,\\mathrm{s}^{-1} $），菌斑控制体积为 $ V $。\n\n给定 $ q_{acid} = 3.20 \\times 10^{-9} $，$ \\Delta t = 180 $，$ V = 7.50 \\times 10^{-5} $ $\\mathrm{L}$，以及 $ \\beta = 1.50 \\times 10^{-2} $ $ \\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\text{每pH单位} $，利用上述依据，从第一性原理推导在时间间隔 $ \\Delta t $ 内初始$pH$变化量 $ \\Delta pH $ 的表达式，然后计算其在该系统中的值。指出在这些条件下 $ \\Delta pH $ 的符号。将您的答案四舍五入至三位有效数字。将$pH$变化表示为一个纯数（无量纲）。",
            "solution": "在尝试进行任何解答之前，将首先对问题进行严格的验证。\n\n### 第1步：提取已知条件\n问题陈述中提供的明确数据、定义和条件如下：\n- **产酸速率**：$q_{acid} = 3.20 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{s}^{-1}$\n- **时间间隔**：$\\Delta t = 180 \\, \\mathrm{s}$\n- **菌斑控制体积**：$V = 7.50 \\times 10^{-5} \\, \\mathrm{L}$\n- **缓冲容量**：$\\beta = 1.50 \\times 10^{-2} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\text{每pH单位}$\n- **缓冲容量的定义**：$\\beta = \\left.\\frac{dC_{b}}{d\\,pH}\\right|_{pH_0}$，其中 $C_b$ 是强碱的浓度。\n- **酸添加关系**：对于小扰动，强一元酸浓度增量 $dC_{a}$ 通过 $dC_{a} = -\\beta\\, dpH$ 与氢离子电位变化量 $dpH$ 相关联。\n- **系统假设**：\n    1. 所产酸的质量守恒。\n    2. 系统是一个混合均匀的隔室。\n    3. 在观察窗口期间，酸清除率可忽略不计。\n    4. 缓冲容量 $\\beta$ 在初始氢离子电位 $pH_0$ 附近不随时间变化。\n- **目标**：推导$pH$变化量 $\\Delta pH$ 的表达式，并计算其数值，四舍五入至三位有效数字。说明变化的符号。\n\n### 第2步：问题陈述的验证\n依据所需标准对问题进行评估。\n1.  **科学依据**：该问题在物理化学和微生物学（特别是龋病学）领域具有科学依据。该模型描述了牙菌斑生物膜在接触蔗糖后$pH$值的下降，这是理解龋齿的一个基石概念。关键要素——链球菌的产酸、菌斑体积以及菌斑液/唾液系统的缓冲能力——都是标准和公认的科学概念。缓冲容量 $\\beta$ 的定义及其在抵抗$pH$变化中的应用是酸碱化学的基本原理。\n2.  **适定性**：该问题是适定的。它提供了所有必要的参数（$q_{acid}$、$\\Delta t$、$V$、$\\beta$）和一组简化的但明确陈述的假设（恒定产酸速率、无清除、恒定$\\beta$），从而可以为 $\\Delta pH$ 推导出一个唯一且有意义的解。\n3.  **客观性**：问题以精确、客观和技术性的语言陈述，没有主观或含糊的术语。\n4.  **一致性和完整性**：所提供的数据内部一致且足以求解。单位是一致的：速率 $q_{acid}$ ($\\mathrm{mol}\\,\\mathrm{s}^{-1}$) 乘以时间 $\\Delta t$ ($\\mathrm{s}$) 得到摩尔数；除以体积 $V$ ($\\mathrm{L}$) 得到浓度 ($\\mathrm{mol}\\,\\mathrm{L}^{-1}$)；再除以缓冲容量 $\\beta$ ($\\mathrm{mol}\\,\\mathrm{L}^{-1}$) 得到一个无量纲的量，这对于 $\\Delta pH$ 是合适的。\n\n### 第3步：结论\n问题科学上合理，适定且内部一致。它被判定为**有效**。现在将按要求从第一性原理推导解答。\n\n### 推导与求解\n\n目标是确定在时间间隔 $\\Delta t$ 内氢离子电位 $\\Delta pH$ 的变化。我们从质量守恒原理开始。\n\n在时间间隔 $\\Delta t$ 内，微菌落产生的乳酸总摩尔量 $\\Delta n_{acid}$ 由恒定的产生速率 $q_{acid}$ 和该时间间隔的持续时间相乘得到。\n$$\n\\Delta n_{acid} = q_{acid} \\cdot \\Delta t\n$$\n在远高于其 $pKa$（约3.86）的生理$pH$范围内，乳酸是一种强一元酸。\n\n在系统是混合均匀隔室且酸清除可忽略的假设下，这部分酸量 $\\Delta n_{acid}$ 均匀分布在整个控制体积 $V$ 中。这导致酸的浓度增加 $\\Delta C_a$。\n$$\n\\Delta C_a = \\frac{\\Delta n_{acid}}{V} = \\frac{q_{acid} \\cdot \\Delta t}{V}\n$$\n问题提供了由缓冲容量 $\\beta$ 控制的酸浓度无穷小变化 $dC_a$ 与相应的氢离子电位无穷小变化 $dpH$ 之间的关系：\n$$\ndC_{a} = -\\beta\\, dpH\n$$\n$\\beta$ 恒定和时间间隔短的假设允许我们对这个微分关系进行积分，或者等效地，用有限变化（$\\Delta$）来近似它。对于在这种情况下预期的小扰动，这种线性化是合理的。\n$$\n\\Delta C_a \\approx -\\beta \\cdot \\Delta pH\n$$\n重新整理此方程以求解 $\\Delta pH$ 得：\n$$\n\\Delta pH = -\\frac{\\Delta C_a}{\\beta}\n$$\n代入我们关于 $\\Delta C_a$ 的表达式，得到氢离子电位变化的最终推导表达式：\n$$\n\\Delta pH = -\\frac{q_{acid} \\cdot \\Delta t}{V \\cdot \\beta}\n$$\n该表达式表明，$pH$的变化与产酸速率和时间间隔成正比，与系统的体积和缓冲容量成反比。\n\n$\\Delta pH$ 的符号由等式右侧各项的符号决定。参数 $q_{acid}$、$\\Delta t$、$V$ 和 $\\beta$ 均为正值。因此，得到的 $\\Delta pH$ 将为负，这与向缓冲体系中加入酸的情况在化学上是一致的。\n\n现在我们将给定值代入推导出的表达式中，计算 $\\Delta pH$ 的数值。\n- $q_{acid} = 3.20 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{s}^{-1}$\n- $\\Delta t = 180 \\, \\mathrm{s}$\n- $V = 7.50 \\times 10^{-5} \\, \\mathrm{L}$\n- $\\beta = 1.50 \\times 10^{-2} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n\n$$\n\\Delta pH = -\\frac{(3.20 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{s}^{-1}) \\cdot (180 \\, \\mathrm{s})}{(7.50 \\times 10^{-5} \\, \\mathrm{L}) \\cdot (1.50 \\times 10^{-2} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1})}\n$$\n首先，我们计算分子（产生的酸的总摩尔数）：\n$$\n\\Delta n_{acid} = (3.20 \\times 10^{-9}) \\cdot (180) \\, \\mathrm{mol} = 576 \\times 10^{-9} \\, \\mathrm{mol} = 5.76 \\times 10^{-7} \\, \\mathrm{mol}\n$$\n接下来，我们计算分母：\n$$\nV \\cdot \\beta = (7.50 \\times 10^{-5}) \\cdot (1.50 \\times 10^{-2}) \\, \\mathrm{mol} = 11.25 \\times 10^{-7} \\, \\mathrm{mol} = 1.125 \\times 10^{-6} \\, \\mathrm{mol}\n$$\n现在，我们计算最终的比率：\n$$\n\\Delta pH = -\\frac{5.76 \\times 10^{-7} \\, \\mathrm{mol}}{1.125 \\times 10^{-6} \\, \\mathrm{mol}} = -0.512\n$$\n计算证实了$pH$变化的负号。根据要求，四舍五入到三位有效数字的值为 $-0.512$。这表明在指定条件下，$pH$值下降了大约半个单位。",
            "answer": "$$\n\\boxed{-0.512}\n$$"
        },
        {
            "introduction": "在由产酸所导致的酸性环境中，致龋菌（如变形链球菌）为何能够持续存活并代谢？本练习将带您深入探索这些微生物的生存策略，即酸耐受性背后的生物能量学原理。您将通过计算在酸应激条件下，细胞维持胞内$pH$稳态的能量消耗如何影响其从糖酵解中获得的净$ATP$产量，从而揭示其关键的毒力机制 ()。",
            "id": "4733942",
            "problem": "致龋生物膜微环境对变形链球菌（Streptococcus mutans）施加强烈的酸应激，这是一种在龋损中占主导地位的乳酸菌。考虑一个进行同型乳酸发酵的变形链球菌单细胞，其中葡萄糖通过 Embden–Meyerhof 途径转化为乳酸，同时还原型烟酰胺腺嘌呤二核苷酸（$\\mathrm{NADH}$）被乳酸脱氢酶再氧化。假设外部 $pH$ 为 $pH_{\\text{out}} = 4.2$，细胞质 $pH$ 通过膜上的 $\\mathrm{F}_{1}\\mathrm{F}_{0}$-三磷酸腺苷酶（三磷酸腺苷，ATP）调控在 $pH_{\\text{in}} = 7.2$，该酶利用 ATP 将质子排出。\n\n仅使用以下经过充分检验的事实和定义作为基本依据：\n- 通过 Embden–Meyerhof 糖酵解进行的同型乳酸发酵，在丙酮酸还原前，通过糖酵解中的底物水平磷酸化净产生 ATP；乳酸的生成可再生 $\\mathrm{NAD}^{+}$。\n- 质子浓度为 $[\\mathrm{H}^{+}] = 10^{-\\mathrm{pH}}$（单位为摩尔浓度），在给定 $pH$ 下，酸解离常数为 $pK_{a}$ 的单质子弱酸的未解离分数 $f_{\\mathrm{HA}}$ 遵循 Henderson–Hasselbalch 关系式 $f_{\\mathrm{HA}} = \\frac{1}{1 + 10^{pH - pK_{a}}}$。\n- 跨膜的质子被动渗漏可由渗透定律近似表示为 $J_{\\mathrm{H}} = P_{\\mathrm{H}} A \\left( C_{\\text{out}} - C_{\\text{in}} \\right)$，其中 $P_{\\mathrm{H}}$ 是质子渗透性，$A$ 是膜面积，$C_{\\text{out}}$ 和 $C_{\\text{in}}$ 分别是外部和内部的质子浓度，单位为 $\\mathrm{mol/m^{3}}$。\n- 半径为 $r$ 的球形细胞的膜面积为 $A = 4 \\pi r^{2}$。\n- $\\mathrm{F}_{1}\\mathrm{F}_{0}$-ATP酶每水解一个 ATP 分子可转运 $n_{\\mathrm{H}}$ 个质子，因此泵出 $N_{\\mathrm{H}^{+}}$ 个质子所需的 ATP 量为 $N_{\\mathrm{H}^{+}} / n_{\\mathrm{H}}$。\n\n假设在低 pH 牙菌斑生态位中的变形链球菌具有以下科学上合理的参数：\n- 细胞半径 $r = 0.50 \\, \\mu \\mathrm{m}$。\n- 质子渗透性 $P_{\\mathrm{H}} = 1.0 \\times 10^{-8} \\, \\mathrm{m \\, s^{-1}}$。\n- 每个细胞的葡萄糖消耗速率 $v_{g} = 2.0 \\times 10^{-17} \\, \\mathrm{mol \\, s^{-1}}$（在所考虑的时间间隔内为常数）。\n- $\\mathrm{F}_{1}\\mathrm{F}_{0}$-ATP酶化学计量 $n_{\\mathrm{H}} = 3.0$ 个质子/每水解一个 ATP。\n- 乳酸 $pK_{a} = 3.86$。\n- 弱酸有效重返分数 $\\theta = 0.50$，定义为在外部产生的未解离乳酸分子中，重新进入细胞质并解离，每个分子释放一个质子的分数；对于同型乳酸发酵，每摩尔葡萄糖产生两个乳酸分子。\n\n任务：\n1. 从 Embden–Meyerhof 糖酵解和同型乳酸发酵的核心定义出发（不使用任何非基于这些基础推导的快捷公式），推导在同型乳酸发酵条件下，变形链球菌每消耗一摩尔葡萄糖的总净 ATP 产量。\n2. 使用指定的 $pH$ 值、膜几何形状、渗透定律、$\\mathrm{F}_{1}\\mathrm{F}_{0}$-ATP酶化学计量、乳酸的 Henderson–Hasselbalch 关系式以及有效重返分数 $\\theta$，计算每摩尔葡萄糖可用的净 ATP 摩尔数，需要减去用于以下过程所需的 ATP：\n   a) 泵出在以速率 $v_{g}$ 消耗一摩尔葡萄糖所需时间内，通过被动渗漏 $J_{\\mathrm{H}}$ 进入的质子，以及\n   b) 泵出由未解离乳酸重返所带入的质子。\n以每摩尔葡萄糖对应的三磷酸腺苷（ATP）摩尔数为单位表示最终结果。将您的答案保留四位有效数字。\n\n注释：\n- 使用 $A = 4 \\pi r^{2}$ 计算表面积，并在使用渗透性方程时，通过乘以 $1000$ 将质子浓度从摩尔浓度（molarity）转换为 $\\mathrm{mol/m^{3}}$。\n- 将外部乳酸池视为充分混合，从而外部的未解离分数由 $f_{\\mathrm{HA}} = \\frac{1}{1 + 10^{pH_{\\text{out}} - pK_{a}}}$ 给出，并取每产生一个乳酸分子的有效重返分数为 $\\theta f_{\\mathrm{HA}}$。",
            "solution": "所述问题在科学上是合理的、内容完整且提法恰当。它基于微生物学、生物化学和物理化学的既定原理。所有必要的参数都已提供，并且其数值在所描述的生物学背景下是合理的。任务定义明确，可以导出一个唯一的、有意义的解。因此，我将进行完整的推导和计算。\n\n根据题目要求，解答分为两个部分。\n\n**第一部分：同型乳酸发酵的总净 ATP 产量**\n\n题目要求从 Embden–Meyerhof 途径（糖酵解）和随后的同型乳酸发酵的基本原理推导 ATP 产量。\n\n1.  **糖酵解途径化学计量**：Embden–Meyerhof 途径将一个葡萄糖分子转化为两个丙酮酸分子。此过程分两个阶段进行：能量投资阶段和能量回报阶段。\n    *   **能量投资阶段**：此阶段中有两步消耗 ATP。首先，葡萄糖被磷酸化为 6-磷酸葡萄糖。其次，6-磷酸果糖被磷酸化为 1,6-二磷酸果糖。这些反应中的每一步都水解一个 ATP 分子。因此，每摩尔进入该途径的葡萄糖会消耗 $2$ 摩尔的 ATP。\n        $$\n        \\text{葡萄糖} + 2 \\, \\text{ATP} \\rightarrow \\text{1,6-二磷酸果糖} + 2 \\, \\text{ADP} + 2 \\, \\mathrm{H}^{+}\n        $$\n    *   **能量回报阶段**：1,6-二磷酸果糖（一个 $6$ 碳分子）被裂解为两个 $3$ 碳分子。这两个分子各自通过途径的剩余部分生成丙酮酸。在此阶段，有两个底物水平磷酸化步骤产生 ATP。对于每个 $3$ 碳分子，一个 ATP 由 1,3-二磷酸甘油酸生成，另一个由磷酸烯醇式丙酮酸生成。由于一个葡萄糖分子产生两个 $3$ 碳中间体，因此每摩尔葡萄糖总共产生 $2 \\times 2 = 4$ 摩尔的 ATP。\n        $$\n        \\text{1,6-二磷酸果糖} \\rightarrow 2 \\, \\text{丙酮酸} + 4 \\, \\text{ATP} + 2 \\, \\text{NADH}\n        $$\n2.  **糖酵解的净 ATP 产量**：糖酵解的净 ATP 产量是总产生的 ATP 减去总投入的 ATP。\n    $$\n    N_{\\mathrm{ATP, gross}} = (\\text{产生的ATP}) - (\\text{投入的ATP}) = 4 \\, \\text{mol} - 2 \\, \\text{mol} = 2 \\, \\text{mol}\n    $$\n    因此，糖酵解的净产量为每摩尔葡萄糖 $2$ 摩尔 ATP。\n\n3.  **发酵步骤**：在同型乳酸发酵中，糖酵解产生的两个丙酮酸分子被还原为两个乳酸分子。该反应由乳酸脱氢酶催化，用于将在糖酵解过程中产生的 $2$ 摩尔 NADH 再氧化为 $\\mathrm{NAD}^{+}$。\n    $$\n    2 \\, \\text{丙酮酸} + 2 \\, \\text{NADH} + 2 \\, \\mathrm{H}^{+} \\rightarrow 2 \\, \\text{乳酸} + 2 \\, \\mathrm{NAD}^{+}\n    $$\n    此步骤不涉及任何 ATP 的合成或消耗。其目的是再生糖酵解中 3-磷酸甘油醛脱氢酶反应所需的 $\\mathrm{NAD}^{+}$，从而使 ATP 的生产能够在厌氧条件下继续进行。\n\n因此，同型乳酸发酵中每摩尔葡萄糖的总净 ATP 产量为 $2$ 摩尔 ATP。\n\n**第二部分：扣除泵送成本后的可用净 ATP**\n\n为了在外部 $pH$ 为 $pH_{\\text{out}} = 4.2$ 的情况下维持细胞质 $pH$ 为 $pH_{\\text{in}} = 7.2$，细胞必须主动将质子泵出。如前所述，质子内流有两个来源：跨膜的被动渗漏和质子化乳酸的重返。泵出这些质子的 ATP 成本必须从总 ATP 产量中减去。所有计算都按每摩尔消耗的葡萄糖进行归一化。\n\n**a) 泵出被动渗漏质子的 ATP 成本**\n\n1.  **细胞表面积 ($A$)**：细胞是一个球体，半径 $r = 0.50 \\, \\mu\\mathrm{m} = 0.50 \\times 10^{-6} \\, \\mathrm{m}$。\n    $$\n    A = 4 \\pi r^2 = 4 \\pi (0.50 \\times 10^{-6} \\, \\mathrm{m})^2 = 4 \\pi (0.25 \\times 10^{-12} \\, \\mathrm{m}^2) = \\pi \\times 10^{-12} \\, \\mathrm{m}^2\n    $$\n\n2.  **质子浓度 ($C$)**：通过乘以 $1000$，将以摩尔浓度 ($M = \\mathrm{mol/L}$) 表示的浓度转换为 $\\mathrm{mol/m^3}$。\n    $$\n    C_{\\text{out}} = 10^{-pH_{\\text{out}}} \\times 1000 = 10^{-4.2} \\times 10^3 = 10^{-1.2} \\, \\mathrm{mol \\, m^{-3}}\n    $$\n    $$\n    C_{\\text{in}} = 10^{-pH_{\\text{in}}} \\times 1000 = 10^{-7.2} \\times 10^3 = 10^{-4.2} \\, \\mathrm{mol \\, m^{-3}}\n    $$\n\n3.  **质子渗漏速率 ($J_{\\mathrm{H}}$)**：每个细胞的质子进入速率由渗透定律给出，使用 $P_{\\mathrm{H}} = 1.0 \\times 10^{-8} \\, \\mathrm{m \\, s^{-1}}$。\n    $$\n    J_{\\mathrm{H}} = P_{\\mathrm{H}} A (C_{\\text{out}} - C_{\\text{in}}) = (1.0 \\times 10^{-8} \\, \\mathrm{m \\, s^{-1}}) (\\pi \\times 10^{-12} \\, \\mathrm{m}^2) (10^{-1.2} - 10^{-4.2} \\, \\mathrm{mol \\, m^{-3}})\n    $$\n\n4.  **每摩尔葡萄糖渗漏的质子摩尔数 ($N_{\\mathrm{H, leak}}$)**：这是质子渗漏速率与葡萄糖消耗速率（$v_g = 2.0 \\times 10^{-17} \\, \\mathrm{mol \\, s^{-1}}$）的比值。\n    $$\n    N_{\\mathrm{H, leak}} = \\frac{J_{\\mathrm{H}}}{v_g} = \\frac{(\\pi \\times 10^{-20}) (10^{-1.2} - 10^{-4.2})}{2.0 \\times 10^{-17}} \\, \\mathrm{mol \\, H^{+} \\, (mol \\, glucose)^{-1}}\n    $$\n    $$\n    N_{\\mathrm{H, leak}} = \\frac{\\pi}{2.0} \\times 10^{-3} (10^{-1.2} - 10^{-4.2}) \\, \\mathrm{mol \\, H^{+} \\, (mol \\, glucose)^{-1}}\n    $$\n\n5.  **渗漏的 ATP 成本 ($N_{\\mathrm{ATP, leak}}$)**：在化学计量为每水解一个 ATP 泵出 $n_{\\mathrm{H}} = 3.0$ 个质子的情况下：\n    $$\n    N_{\\mathrm{ATP, leak}} = \\frac{N_{\\mathrm{H, leak}}}{n_{\\mathrm{H}}} = \\frac{1}{3.0} \\left[ \\frac{\\pi}{2.0} \\times 10^{-3} (10^{-1.2} - 10^{-4.2}) \\right] \\, \\mathrm{mol \\, ATP \\, (mol \\, glucose)^{-1}}\n    $$\n\n**b) 泵出来自乳酸重返的质子的 ATP 成本**\n\n1.  **乳酸产量**：根据第一部分，每摩尔葡萄糖产生 $2$ 摩尔乳酸。\n\n2.  **未解离乳酸的分数 ($f_{\\mathrm{HA}}$)**：在 $pH_{\\text{out}} = 4.2$ 且乳酸 $pK_a = 3.86$ 的条件下，处于未解离形式（质子化）的乳酸分数由 Henderson-Hasselbalch 关系式给出：\n    $$\n    f_{\\mathrm{HA}} = \\frac{1}{1 + 10^{pH_{\\text{out}} - pK_a}} = \\frac{1}{1 + 10^{4.2 - 3.86}} = \\frac{1}{1 + 10^{0.34}}\n    $$\n\n3.  **重返质子的摩尔数 ($N_{\\mathrm{H, reentry}}$)**：每摩尔葡萄糖形成 $2$ 摩尔乳酸。其中重返并解离的分数为 $\\theta f_{\\mathrm{HA}}$，其中 $\\theta = 0.50$。\n    $$\n    N_{\\mathrm{H, reentry}} = (\\text{乳酸摩尔数}) \\times \\theta \\times f_{\\mathrm{HA}} = 2 \\times 0.50 \\times \\frac{1}{1 + 10^{0.34}} = \\frac{1}{1 + 10^{0.34}} \\, \\mathrm{mol \\, H^{+} \\, (mol \\, glucose)^{-1}}\n    $$\n\n4.  **重返的 ATP 成本 ($N_{\\mathrm{ATP, reentry}}$)**：使用相同的 ATP 酶化学计量 $n_{\\mathrm{H}} = 3.0$：\n    $$\n    N_{\\mathrm{ATP, reentry}} = \\frac{N_{\\mathrm{H, reentry}}}{n_{\\mathrm{H}}} = \\frac{1}{3.0} \\left( \\frac{1}{1 + 10^{0.34}} \\right) \\, \\mathrm{mol \\, ATP \\, (mol \\, glucose)^{-1}}\n    $$\n\n**可用总净 ATP ($N_{\\mathrm{ATP, net}}$)**\n\n可用的总净 ATP 是总产量减去质子泵送的总成本。\n$$\nN_{\\mathrm{ATP, net}} = N_{\\mathrm{ATP, gross}} - (N_{\\mathrm{ATP, leak}} + N_{\\mathrm{ATP, reentry}})\n$$\n$$\nN_{\\mathrm{ATP, net}} = 2.0 - \\left[ \\frac{1}{3.0} \\left( \\frac{\\pi}{2.0} \\times 10^{-3} (10^{-1.2} - 10^{-4.2}) \\right) + \\frac{1}{3.0} \\left( \\frac{1}{1 + 10^{0.34}} \\right) \\right]\n$$\n$$\nN_{\\mathrm{ATP, net}} = 2.0 - \\frac{1}{3.0} \\left[ \\frac{\\pi \\times 10^{-3}}{2.0} (10^{-1.2} - 10^{-4.2}) + \\frac{1}{1 + 10^{0.34}} \\right]\n$$\n\n现在，我们计算数值。\n首先，渗漏项的成本：\n$$\nN_{\\mathrm{ATP, leak}} = \\frac{1}{3.0} \\left[ \\frac{\\pi \\times 10^{-3}}{2.0} (10^{-1.2} - 10^{-4.2}) \\right] \\approx \\frac{1}{3.0} \\left[ (1.5708 \\times 10^{-3}) (0.063096 - 0.000063) \\right] \\approx \\frac{1}{3.0} [9.8998 \\times 10^{-5}] \\approx 3.300 \\times 10^{-5}\n$$\n其次，重返项的成本：\n$$\nN_{\\mathrm{ATP, reentry}} = \\frac{1}{3.0} \\left( \\frac{1}{1 + 10^{0.34}} \\right) \\approx \\frac{1}{3.0} \\left( \\frac{1}{1 + 2.1878} \\right) \\approx \\frac{1}{3.0} \\left( \\frac{1}{3.1878} \\right) \\approx \\frac{0.31370}{3.0} \\approx 0.10457\n$$\n总成本：\n$$\nN_{\\mathrm{ATP, cost}} = N_{\\mathrm{ATP, leak}} + N_{\\mathrm{ATP, reentry}} \\approx 3.300 \\times 10^{-5} + 0.10457 \\approx 0.10460\n$$\n最终净 ATP 产量：\n$$\nN_{\\mathrm{ATP, net}} = 2.0 - 0.10460 = 1.8954\n$$\n四舍五入到四位有效数字，结果是 $1.895$。",
            "answer": "$$\n\\boxed{1.895}\n$$"
        },
        {
            "introduction": "现代龋病微生物学研究已从单一菌种模型转向复杂的微生物群落分析。本练习为您提供了一个从理论走向实践的机会，处理真实的微生物组测序数据。您将学习并实施一种严谨的统计方法——成分数据分析（compositional data analysis），来准确识别与龋病相关的菌群，同时避免因数据特性而产生的伪相关性，这是开展现代微生物生态学研究的一项关键技能 ()。",
            "id": "4734005",
            "problem": "给定从多个微生物分类群中测量的龈上菌斑样本的组成型测序数据，以及指示每个样本是来自龋活跃位点还是无龋位点的二元标签。由于闭合约束，组成型数据位于单纯形中，在对原始计数或比例进行分析时可能产生伪相关。您的任务是设计并实现一个程序，该程序从组成型数据分析和统计推断的基本原理出发，执行中心对数比分析，以识别与龋病相关的分类群，同时避免伪相关。\n\n使用以下基本原理，而无需预先提供或假设快捷公式：(i) 组成型数据是受常数和运算约束的正值向量，(ii) 在 Aitchison 几何中，通过消除闭合效应的对数比变换来实现稳健的推断，(iii) 两组之间的统计比较应考虑不等方差，以及 (iv) 多重假设检验需要控制错误发现率。\n\n以精确的数学术语定义以下计算对象。设 $X \\in \\mathbb{R}_{+}^{n \\times p}$ 为严格非负计数矩阵，其中有 $n$ 个样本和 $p$ 个分类群，并设 $y \\in \\{0,1\\}^{n}$ 表示每个样本的二元龋病标签，其中 $y_i = 1$ 表示有龋，$y_i = 0$ 表示健康。为了在对数比空间中操作，您必须在变换前对 $X$ 应用一种有原则的零值处理策略，以避免出现未定义的对数，并与单纯形的几何结构保持一致。在变换到一个合适的对数比空间，该空间通过对每个组成进行中心化来消除闭合引起的相关性之后，为每个分类群 $j \\in \\{1,\\dots,p\\}$ 计算龋病组和健康组均值之间的组间差异，并检验该差异在不等方差下是否具有统计显著性。使用有效的升阶程序，在水平 $\\alpha$ 上控制错误发现率。当且仅当一个分类群的效应方向为严格正，并且在所选 $\\alpha$ 水平的错误发现率控制下是显著的，该分类群才被视为与龋病相关。\n\n您的程序必须根据上述原理，以纯粹的算法术语实现以下步骤：\n- 在应用中心对数比空间变换之前，用一个小的正常数替换 $X$ 中的零。\n- 为每个分类群 $j$ 计算一个组间统计量，以衡量变换后空间中龋病组和健康组的位置差异。\n- 为每个分类群 $j$ 执行一个有效的不等方差下的双样本检验，并获得一个 $p$ 值。\n- 通过对 $p$ 值集合应用一个有效的升阶程序，在水平 $\\alpha$ 上进行错误发现率控制，以获得调整后的决策阈值。\n- 返回在错误发现率控制下保留且具有正效应的分类群的索引集合。\n\n角度单位不适用。不涉及物理单位。所有输出必须是整数的数学列表。\n\n在以下显式参数值的测试套件上实现您的解决方案，这些测试套件强调了问题的不同方面。每个测试用例提供 $X$ 和 $y$。在程序输出中，分类群索引 $j$ 是从零开始的。所有测试用例的分类群排序固定如下：$t_0$ 是 Streptococcus mutans，$t_1$ 是 Veillonella parvula，$t_2$ 是 Scardovia wiggsiae，$t_3$ 是 Actinomyces naeslundii，以及 $t_4$ 是 Rothia dentocariosa。\n\n- 测试用例 1 (零值最少的平衡设计)：\n  - $n = 6$, $p = 5$.\n  - $X^{(1)}$ 行（每行为一个样本）：$(120,30,80,20,10)$, $(150,25,60,25,15)$, $(130,28,75,22,12)$, $(40,50,15,35,30)$, $(45,55,10,40,25)$, $(35,60,12,45,28)$.\n  - $y^{(1)} = (1,1,1,0,0,0)$.\n\n- 测试用例 2 (存在需要原则性处理的结构性零)：\n  - $n = 6$, $p = 5$.\n  - $X^{(2)}$ 行：$(80,0,40,0,5)$, $(90,5,35,0,10)$, $(85,0,38,2,0)$, $(20,30,5,25,15)$, $(25,28,6,30,12)$, $(18,35,4,20,10)$.\n  - $y^{(2)} = (1,1,1,0,0,0)$.\n\n- 测试用例 3 (具有一致相对富集模式的稀疏计数)：\n  - $n = 8$, $p = 5$.\n  - $X^{(3)}$ 行：$(25,5,18,3,1)$, $(22,4,20,2,1)$, $(24,6,17,4,2)$, $(23,5,19,3,1)$, $(8,10,6,9,3)$, $(9,12,5,8,2)$, $(7,11,7,10,4)$, $(8,9,6,9,3)$.\n  - $y^{(3)} = (1,1,1,1,0,0,0,0)$.\n\n对于所有测试用例，使用错误发现率水平 $\\alpha = 0.05$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个元素是对应测试用例的与龋病相关的、从零开始的分类群索引列表。例如，输出格式必须类似于 $[ [i\\_1,i\\_2], [j\\_1], [] ]$，不含任何附加文本。",
            "solution": "该问题提出了一个计算生物学领域，特别是微生物组数据分析领域中，有效且适定（well-posed）的任务。它要求实现一个标准的、统计上稳健的流程，从组成型测序数据中识别与龋齿相关的微生物分类群。该问题具有科学依据，无矛盾之处，并提供了进行求解所需的所有必要信息。所提出的方法，基于中心对数比变换、Welch's t-test 和 Benjamini-Hochberg 错误发现率控制，是现代微生物组分析的基石，并且适用于当前的数据和问题。\n\n解决方案是遵循一系列有原则的分析步骤来构建的，详述如下。\n\n首先，设原始计数数据由矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 表示，其中 $n$ 是样本数， $p$ 是微生物分类群的数量。一个对应的向量 $y \\in \\{0,1\\}^n$ 提供二元类别标签，其中 $y_i=1$ 表示样本来自龋活跃位点，$y_i=0$ 表示来自健康位点。\n\n分析流程如下：\n\n1.  **零值插补**：组成型数据分析依赖于对数比变换，而该变换对零值是未定义的。计数矩阵 $X$ 可能包含零，这表示分类群的缺失或测序深度不足。一个常见且必要的预处理步骤是用一个小的正数常量 $\\delta$ 替换这些零。这个过程称为插补，它创建了一个新矩阵 $X'$，其中每个元素都严格为正。\n    $$\n    X'_{i,j} = \\begin{cases} X_{i,j}  \\text{if } X_{i,j} > 0 \\\\ \\delta  \\text{if } X_{i,j} = 0 \\end{cases}\n    $$\n    对于本分析，选择 $\\delta = 0.5$。该值代表一个标准的伪计数，相对于典型计数值较小，但足以避免数值不稳定性。然后将矩阵 $X'$ 作为后续变换的输入。\n\n2.  **中心对数比（CLR）变换**：组成型数据的根本问题是单位和约束（闭合），这会在组分之间引发伪负相关。Aitchison 几何框架通过将数据从单纯形（组成空间）变换到标准欧几里得空间来解决此问题。中心对数比（CLR）变换就是这样一种方法。对于插补矩阵 $X'$ 中的每个样本（行）$\\mathbf{x}'_i$，通过取每个组分的对数并减去该样本的对数均值来进行中心化，从而计算出 CLR 变换后的向量 $\\mathbf{z}_i$。样本 $\\mathbf{x}'_i$ 各组分的几何平均值为 $g(\\mathbf{x}'_i) = \\left( \\prod_{j=1}^{p} x'_{i,j} \\right)^{1/p}$。第 $i$ 个样本的第 $j$ 个组分的 CLR 变换则为：\n    $$\n    z_{i,j} = \\ln\\left(\\frac{x'_{i,j}}{g(\\mathbf{x}'_i)}\\right) = \\ln(x'_{i,j}) - \\frac{1}{p}\\sum_{k=1}^{p}\\ln(x'_{i,k})\n    $$\n    这将产生一个矩阵 $Z \\in \\mathbb{R}^{n \\times p}$，其中各行之和为零（$\\sum_{j=1}^{p} z_{i,j} = 0$）。矩阵 $Z$ 中的数据现在位于一个实向量空间中，可以有效地应用标准统计检验。\n\n3.  **双样本假设检验**：为识别在龋活跃位点和健康位点之间丰度存在差异的分类群，我们为每个分类群 $j \\in \\{1, \\dots, p\\}$ 进行双样本检验。根据标签向量 $y$，将分类群 $j$ 的 CLR 变换数据划分为两组：龋病组 $Z_j^{(1)} = \\{z_{i,j} | y_i = 1\\}$ 和健康组 $Z_j^{(0)} = \\{z_{i,j} | y_i = 0\\}$。问题规定检验必须考虑两组之间可能存在的方差不等。Welch's t-test 是适用于此条件的恰当统计检验。对于每个分类群 $j$，我们检验原假设 $H_{0,j}: \\mu_j^{(1)} = \\mu_j^{(0)}$，其中 $\\mu_j^{(1)}$ 和 $\\mu_j^{(0)}$ 分别是龋病和健康群体 CLR 变换后丰度的真实均值。\n\n    Welch's t-统计量计算如下：\n    $$\n    t_j = \\frac{\\bar{z}_j^{(1)} - \\bar{z}_j^{(0)}}{\\sqrt{ \\frac{(s_j^{(1)})^2}{n_1} + \\frac{(s_j^{(0)})^2}{n_0} }}\n    $$\n    其中 $\\bar{z}_j$ 和 $s_j^2$ 分别是每组的样本均值和方差，而 $n_1$ 和 $n_0$ 是样本量。自由度 $\\nu_j$ 使用 Welch-Satterthwaite 方程进行估计。此检验为每个分类群产生一个 p 值 $p_j$，表示在原假设为真的情况下，观测到至少与测量值一样大的差异的概率。\n\n4.  **错误发现率（FDR）控制**：由于我们同时进行 $p$ 次假设检验，犯 I 型错误（假阳性）的风险会增加。为解决此问题，我们必须对多重比较进行校正。问题要求使用升阶程序将错误发现率控制在 $\\alpha=0.05$ 的水平。Benjamini-Hochberg (BH) 程序是用于此目的的标准有效方法。步骤如下：\n    a. 将 $p$ 个 p 值 $\\{p_1, \\dots, p_p\\}$ 从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(p)}$。\n    b. 找到最大的秩 $k$，使其对应的 p 值 $p_{(k)}$ 满足条件 $p_{(k)} \\le \\frac{k}{p} \\alpha$。\n    c. 如果存在这样的 $k$，则拒绝所有原假设 $H_{0,(i)}$（对于 $i=1, \\dots, k$）。这等同于找到一个阈值 $p_{BH}$（即 $p_{(k)}$），并拒绝任何满足 $p_j \\le p_{BH}$ 的原假设 $H_{0,j}$。如果不存在这样的 $k$，则不拒绝任何假设。\n\n5.  **识别与龋病相关的分类群**：一个分类群被认为与龋病相关，需满足两个条件：\n    a. **统计显著性**：根据 Benjamini-Hochberg 程序，在 $\\alpha = 0.05$ 的水平上，其原假设被拒绝。\n    b. **效应方向**：其 CLR 变换后丰度的均值在龋病组中严格大于健康组。这对应于一个正的效应大小，即 $\\bar{z}_j^{(1)} - \\bar{z}_j^{(0)} > 0$。\n\n每个测试用例的最终结果是满足这两个标准的分类群的从零开始的索引集合。",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the problem of identifying caries-associated taxa from compositional data.\n\n    The function implements a multi-step bioinformatic and statistical pipeline:\n    1. Zero Imputation: Replaces zero counts with a small constant (0.5).\n    2. Centered Log-Ratio (CLR) Transformation: Transforms data from the compositional\n       simplex to a Euclidean space to enable standard statistical analysis.\n    3. Welch's t-test: For each taxon, performs a two-sample t-test between\n       caries and healthy groups, assuming unequal variances.\n    4. False Discovery Rate (FDR) Control: Applies the Benjamini-Hochberg (BH)\n       procedure to the set of p-values to correct for multiple testing.\n    5. Final Selection: Identifies taxa that are statistically significant after\n       FDR correction and show a positive association with caries (higher mean\n       abundance in the caries group).\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X\": np.array([\n                [120, 30, 80, 20, 10],\n                [150, 25, 60, 25, 15],\n                [130, 28, 75, 22, 12],\n                [40, 50, 15, 35, 30],\n                [45, 55, 10, 40, 25],\n                [35, 60, 12, 45, 28]\n            ], dtype=float),\n            \"y\": np.array([1, 1, 1, 0, 0, 0])\n        },\n        {\n            \"X\": np.array([\n                [80, 0, 40, 0, 5],\n                [90, 5, 35, 0, 10],\n                [85, 0, 38, 2, 0],\n                [20, 30, 5, 25, 15],\n                [25, 28, 6, 30, 12],\n                [18, 35, 4, 20, 10]\n            ], dtype=float),\n            \"y\": np.array([1, 1, 1, 0, 0, 0])\n        },\n        {\n            \"X\": np.array([\n                [25, 5, 18, 3, 1],\n                [22, 4, 20, 2, 1],\n                [24, 6, 17, 4, 2],\n                [23, 5, 19, 3, 1],\n                [8, 10, 6, 9, 3],\n                [9, 12, 5, 8, 2],\n                [7, 11, 7, 10, 4],\n                [8, 9, 6, 9, 3]\n            ], dtype=float),\n            \"y\": np.array([1, 1, 1, 1, 0, 0, 0, 0])\n        }\n    ]\n    \n    alpha = 0.05\n    all_results = []\n\n    for case in test_cases:\n        X, y = case[\"X\"], case[\"y\"]\n        n_samples, n_taxa = X.shape\n\n        # Step 1: Zero Imputation\n        X_imputed = np.copy(X)\n        X_imputed[X_imputed == 0] = 0.5\n        \n        # Step 2: Centered Log-Ratio (CLR) Transformation\n        log_X = np.log(X_imputed)\n        gmean_log_X = np.mean(log_X, axis=1, keepdims=True)\n        Z = log_X - gmean_log_X\n        \n        caries_indices = (y == 1)\n        healthy_indices = (y == 0)\n\n        Z_caries = Z[caries_indices, :]\n        Z_healthy = Z[healthy_indices, :]\n\n        p_values = np.zeros(n_taxa)\n        effect_directions = np.zeros(n_taxa)\n\n        for j in range(n_taxa):\n            # Step 3: Two-Sample Hypothesis Testing (Welch's t-test)\n            group1 = Z_caries[:, j]\n            group2 = Z_healthy[:, j]\n            \n            # The test is for difference, so it is two-tailed.\n            t_stat, p_val = stats.ttest_ind(group1, group2, equal_var=False, nan_policy='raise')\n            p_values[j] = p_val\n            \n            # Calculate mean difference for effect direction\n            mean_diff = np.mean(group1) - np.mean(group2)\n            effect_directions[j] = mean_diff\n\n        # Step 4: False Discovery Rate (FDR) Control (Benjamini-Hochberg)\n        sorted_indices = np.argsort(p_values)\n        p_values_sorted = p_values[sorted_indices]\n        \n        bh_threshold = 0.0\n        for i in range(n_taxa - 1, -1, -1):\n            rank = i + 1\n            critical_value = (rank / n_taxa) * alpha\n            if p_values_sorted[i] = critical_value:\n                bh_threshold = p_values_sorted[i]\n                break\n        \n        significant_mask = (p_values = bh_threshold) if bh_threshold > 0 else np.zeros(n_taxa, dtype=bool)\n\n        # Step 5: Identify Caries-Associated Taxa\n        # A taxon must be significant AND have a positive effect direction\n        positive_effect_mask = effect_directions > 0\n        final_associated_mask = significant_mask  positive_effect_mask\n        \n        associated_taxa_indices = np.where(final_associated_mask)[0].tolist()\n        \n        all_results.append(associated_taxa_indices)\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}