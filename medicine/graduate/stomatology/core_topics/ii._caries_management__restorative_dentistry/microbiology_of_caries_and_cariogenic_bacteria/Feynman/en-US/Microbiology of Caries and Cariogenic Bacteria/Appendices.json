{
    "hands_on_practices": [
        {
            "introduction": "To understand the virulence of cariogenic bacteria, we must first examine their metabolic engine. This practice delves into the bioenergetics of *Streptococcus mutans*, challenging you to calculate the net energy yield under the harsh acidic conditions it creates. By working through this problem, you will gain a quantitative appreciation for the metabolic trade-offs involved in maintaining intracellular $pH$ and how this acid tolerance (aciduricity) is fundamentally linked to sustained acid production (acidogenicity). ",
            "id": "4733942",
            "problem": "A cariogenic biofilm microenvironment imposes strong acid stress on Streptococcus mutans, a lactic acid bacterium that dominates in carious lesions. Consider a single Streptococcus mutans cell in homolactic fermentation, where glucose is converted through the Embden–Meyerhof pathway to lactic acid with reoxidation of reduced nicotinamide adenine dinucleotide ($\\mathrm{NADH}$) by lactate dehydrogenase. Assume the external $pH$ is $pH_{\\text{out}} = 4.2$ and the cytoplasmic $pH$ is regulated at $pH_{\\text{in}} = 7.2$ by the membrane $\\mathrm{F}_{1}\\mathrm{F}_{0}$-adenosine triphosphatase (Adenosine Triphosphate, ATP) that uses ATP to extrude protons.\n\nUse only the following well-tested facts and definitions as the fundamental base:\n- Homolactic fermentation via Embden–Meyerhof glycolysis yields net ATP by substrate-level phosphorylation in glycolysis before pyruvate reduction; lactate production regenerates $\\mathrm{NAD}^{+}$.\n- The concentration of protons is $[\\mathrm{H}^{+}] = 10^{-\\mathrm{pH}}$ (in molarity), and the undissociated fraction of a monoprotic weak acid of acid dissociation constant $pK_{a}$ at a given $pH$ follows the Henderson–Hasselbalch relation $f_{\\mathrm{HA}} = \\frac{1}{1 + 10^{pH - pK_{a}}}$.\n- Passive proton leak across the membrane is approximated by a permeability law $J_{\\mathrm{H}} = P_{\\mathrm{H}} A \\left( C_{\\text{out}} - C_{\\text{in}} \\right)$, where $P_{\\mathrm{H}}$ is the proton permeability, $A$ is the membrane area, and $C_{\\text{out}}$ and $C_{\\text{in}}$ are external and internal proton concentrations in $\\mathrm{mol/m^{3}}$.\n- The membrane area of a spherical cell of radius $r$ is $A = 4 \\pi r^{2}$.\n- The $\\mathrm{F}_{1}\\mathrm{F}_{0}$-ATPase translocates $n_{\\mathrm{H}}$ protons per ATP hydrolyzed, so the ATP required to pump $N_{\\mathrm{H}^{+}}$ protons is $N_{\\mathrm{H}^{+}} / n_{\\mathrm{H}}$.\n\nAssume the following scientifically plausible parameters for Streptococcus mutans in a low $pH$ plaque niche:\n- Cell radius $r = 0.50 \\, \\mu \\mathrm{m}$.\n- Proton permeability $P_{\\mathrm{H}} = 1.0 \\times 10^{-8} \\, \\mathrm{m \\, s^{-1}}$.\n- Glucose consumption rate per cell $v_{g} = 2.0 \\times 10^{-17} \\, \\mathrm{mol \\, s^{-1}}$ (constant during the interval considered).\n- $\\mathrm{F}_{1}\\mathrm{F}_{0}$-ATPase stoichiometry $n_{\\mathrm{H}} = 3.0$ protons translocated per ATP hydrolyzed.\n- Lactic acid $pK_{a} = 3.86$.\n- Effective weak-acid re-entry fraction $\\theta = 0.50$, defined as the fraction of undissociated lactic acid molecules produced externally that re-enter the cytoplasm and dissociate, delivering one proton per molecule; for homolactic fermentation, two lactic acid molecules are produced per mole of glucose.\n\nTasks:\n1. Starting from the core definitions of Embden–Meyerhof glycolysis and homolactic fermentation (without using any shortcut formulas not derived from these bases), derive the gross net ATP yield per mole of glucose for Streptococcus mutans under homolactic fermentation.\n2. Using the specified $pH$ values, membrane geometry, permeability law, $\\mathrm{F}_{1}\\mathrm{F}_{0}$-ATPase stoichiometry, Henderson–Hasselbalch relation for lactic acid, and the effective re-entry fraction $\\theta$, compute the net moles of ATP available per mole of glucose after subtracting the ATP required to:\n   a) Pump protons entering by passive leak $J_{\\mathrm{H}}$ during the time needed for consumption of one mole of glucose at rate $v_{g}$, and\n   b) Pump protons delivered by re-entry of undissociated lactic acid.\nExpress the final result in moles of adenosine triphosphate (ATP) per mole of glucose. Round your answer to four significant figures.\n\nNotes:\n- Use $A = 4 \\pi r^{2}$ to compute the surface area and convert proton concentrations from molarity to $\\text{mol/m}^3$ by multiplying by $1000$ when using the permeability equation.\n- Treat the external lactic acid pool as sufficiently well-mixed that the undissociated fraction outside is given by $f_{\\mathrm{HA}} = \\frac{1}{1 + 10^{pH_{\\text{out}} - pK_{a}}}$, and take the effective re-entry fraction as $\\theta f_{\\mathrm{HA}}$ per lactic acid molecule produced.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It is based on established principles of microbiology, biochemistry, and physical chemistry. All necessary parameters are provided, and their values are plausible for the biological context described. The tasks are clearly defined and lead to a unique, meaningful solution. Therefore, I will proceed with a full derivation and calculation.\n\nThe solution is divided into two parts as requested by the problem statement.\n\n**Part 1: Gross Net ATP Yield from Homolactic Fermentation**\n\nThe problem requires a derivation of the ATP yield from the fundamental principles of the Embden–Meyerhof pathway (glycolysis) followed by homolactic fermentation.\n\n1.  **Glycolysis Pathway Stoichiometry**: The Embden–Meyerhof pathway converts one molecule of glucose into two molecules of pyruvate. This process occurs in two phases: an energy investment phase and an energy payoff phase.\n    *   **Energy Investment Phase**: Two steps in this phase consume ATP. First, glucose is phosphorylated to glucose-6-phosphate. Second, fructose-6-phosphate is phosphorylated to fructose-1,6-bisphosphate. Each of these reactions hydrolyzes one molecule of ATP. Thus, for each mole of glucose entering the pathway, $2$ moles of ATP are consumed.\n        $$\n        \\text{Glucose} + 2 \\, \\text{ATP} \\rightarrow \\text{Fructose-1,6-bisphosphate} + 2 \\, \\text{ADP} + 2 \\, \\mathrm{H}^{+}\n        $$\n    *   **Energy Payoff Phase**: The fructose-1,6-bisphosphate (a $6$-carbon molecule) is cleaved into two $3$-carbon molecules. Each of these molecules proceeds through the remainder of the pathway to pyruvate. In this phase, there are two substrate-level phosphorylation steps that generate ATP. For each $3$-carbon molecule, one ATP is generated from 1,3-bisphosphoglycerate and another from phosphoenolpyruvate. Since one molecule of glucose yields two $3$-carbon intermediates, a total of $2 \\times 2 = 4$ moles of ATP are generated per mole of glucose.\n        $$\n        \\text{Fructose-1,6-bisphosphate} \\rightarrow 2 \\, \\text{Pyruvate} + 4 \\, \\text{ATP} + 2 \\, \\text{NADH}\n        $$\n2.  **Net ATP from Glycolysis**: The net ATP yield from glycolysis is the total ATP produced minus the total ATP invested.\n    $$\n    N_{\\mathrm{ATP, gross}} = (\\text{ATP generated}) - (\\text{ATP invested}) = 4 \\, \\text{mol} - 2 \\, \\text{mol} = 2 \\, \\text{mol}\n    $$\n    Therefore, the net yield from glycolysis is $2$ moles of ATP per mole of glucose.\n\n3.  **Fermentation Step**: In homolactic fermentation, the two molecules of pyruvate generated from glycolysis are reduced to two molecules of lactate. This reaction, catalyzed by lactate dehydrogenase, serves to reoxidize the $2$ moles of NADH produced during glycolysis back to $\\mathrm{NAD}^{+}$.\n    $$\n    2 \\, \\text{Pyruvate} + 2 \\, \\text{NADH} + 2 \\, \\mathrm{H}^{+} \\rightarrow 2 \\, \\text{Lactate} + 2 \\, \\mathrm{NAD}^{+}\n    $$\n    This step does not involve any ATP synthesis or consumption. Its purpose is to regenerate the $\\mathrm{NAD}^{+}$ required for the glyceraldehyde-3-phosphate dehydrogenase reaction in glycolysis, allowing ATP production to continue under anaerobic conditions.\n\nThe gross net ATP yield per mole of glucose for homolactic fermentation is therefore $2$ moles of ATP.\n\n**Part 2: Net ATP Available after Pumping Costs**\n\nTo maintain a cytoplasmic $pH$ of $pH_{\\text{in}} = 7.2$ against an external $pH$ of $pH_{\\text{out}} = 4.2$, the cell must actively pump out protons. The proton influx has two sources as described: passive leak across the membrane and re-entry of protonated lactic acid. The ATP cost for pumping these protons must be subtracted from the gross ATP yield. All calculations are normalized per mole of glucose consumed.\n\n**a) ATP Cost for Pumping Protons from Passive Leak**\n\n1.  **Cell Surface Area ($A$)**: The cell is a sphere with radius $r = 0.50 \\, \\mu\\mathrm{m} = 0.50 \\times 10^{-6} \\, \\mathrm{m}$.\n    $$\n    A = 4 \\pi r^2 = 4 \\pi (0.50 \\times 10^{-6} \\, \\mathrm{m})^2 = 4 \\pi (0.25 \\times 10^{-12} \\, \\mathrm{m}^2) = \\pi \\times 10^{-12} \\, \\mathrm{m}^2\n    $$\n\n2.  **Proton Concentrations ($C$)**: The concentrations in molarity ($M = \\mathrm{mol/L}$) are converted to $\\mathrm{mol/m^3}$ by multiplying by $1000$.\n    $$\n    C_{\\text{out}} = 10^{-pH_{\\text{out}}} \\times 1000 = 10^{-4.2} \\times 10^3 = 10^{-1.2} \\, \\mathrm{mol \\, m^{-3}}\n    $$\n    $$\n    C_{\\text{in}} = 10^{-pH_{\\text{in}}} \\times 1000 = 10^{-7.2} \\times 10^3 = 10^{-4.2} \\, \\mathrm{mol \\, m^{-3}}\n    $$\n\n3.  **Proton Leak Rate ($J_{\\mathrm{H}}$)**: The rate of proton entry per cell is given by the permeability law, using $P_{\\mathrm{H}} = 1.0 \\times 10^{-8} \\, \\mathrm{m \\, s^{-1}}$.\n    $$\n    J_{\\mathrm{H}} = P_{\\mathrm{H}} A (C_{\\text{out}} - C_{\\text{in}}) = (1.0 \\times 10^{-8} \\, \\mathrm{m \\, s^{-1}}) (\\pi \\times 10^{-12} \\, \\mathrm{m}^2) (10^{-1.2} - 10^{-4.2} \\, \\mathrm{mol \\, m^{-3}})\n    $$\n\n4.  **Moles of Leaked Protons per Mole of Glucose ($N_{\\mathrm{H, leak}}$)**: This is the ratio of the proton leak rate to the glucose consumption rate ($v_g = 2.0 \\times 10^{-17} \\, \\mathrm{mol \\, s^{-1}}$).\n    $$\n    N_{\\mathrm{H, leak}} = \\frac{J_{\\mathrm{H}}}{v_g} = \\frac{(\\pi \\times 10^{-20}) (10^{-1.2} - 10^{-4.2})}{2.0 \\times 10^{-17}} \\, \\mathrm{mol \\, H^{+} \\, (mol \\, glucose)^{-1}}\n    $$\n    $$\n    N_{\\mathrm{H, leak}} = \\frac{\\pi}{2.0} \\times 10^{-3} (10^{-1.2} - 10^{-4.2}) \\, \\mathrm{mol \\, H^{+} \\, (mol \\, glucose)^{-1}}\n    $$\n\n5.  **ATP Cost for Leak ($N_{\\mathrm{ATP, leak}}$)**: With a stoichiometry of $n_{\\mathrm{H}} = 3.0$ protons pumped per ATP hydrolyzed:\n    $$\n    N_{\\mathrm{ATP, leak}} = \\frac{N_{\\mathrm{H, leak}}}{n_{\\mathrm{H}}} = \\frac{1}{3.0} \\left[ \\frac{\\pi}{2.0} \\times 10^{-3} (10^{-1.2} - 10^{-4.2}) \\right] \\, \\mathrm{mol \\, ATP \\, (mol \\, glucose)^{-1}}\n    $$\n\n**b) ATP Cost for Pumping Protons from Lactic Acid Re-entry**\n\n1.  **Lactic Acid Production**: From Part 1, $2$ moles of lactic acid are produced per mole of glucose.\n\n2.  **Fraction of Undissociated Lactic Acid ($f_{\\mathrm{HA}}$)**: At $pH_{\\text{out}} = 4.2$ and with lactic acid $pK_a = 3.86$, the fraction of lactic acid in the undissociated form (protonated) is given by the Henderson-Hasselbalch relation:\n    $$\n    f_{\\mathrm{HA}} = \\frac{1}{1 + 10^{pH_{\\text{out}} - pK_a}} = \\frac{1}{1 + 10^{4.2 - 3.86}} = \\frac{1}{1 + 10^{0.34}}\n    $$\n\n3.  **Moles of Re-entering Protons ($N_{\\mathrm{H, reentry}}$)**: Per mole of glucose, $2$ moles of lactic acid are formed. The fraction of these that re-enter and dissociate is $\\theta f_{\\mathrm{HA}}$, where $\\theta = 0.50$.\n    $$\n    N_{\\mathrm{H, reentry}} = (\\text{moles of lactate}) \\times \\theta \\times f_{\\mathrm{HA}} = 2 \\times 0.50 \\times \\frac{1}{1 + 10^{0.34}} = \\frac{1}{1 + 10^{0.34}} \\, \\mathrm{mol \\, H^{+} \\, (mol \\, glucose)^{-1}}\n    $$\n\n4.  **ATP Cost for Re-entry ($N_{\\mathrm{ATP, reentry}}$)**: Using the same ATPase stoichiometry $n_{\\mathrm{H}} = 3.0$:\n    $$\n    N_{\\mathrm{ATP, reentry}} = \\frac{N_{\\mathrm{H, reentry}}}{n_{\\mathrm{H}}} = \\frac{1}{3.0} \\left( \\frac{1}{1 + 10^{0.34}} \\right) \\, \\mathrm{mol \\, ATP \\, (mol \\, glucose)^{-1}}\n    $$\n\n**Total Net ATP Available ($N_{\\mathrm{ATP, net}}$)**\n\nThe total net ATP available is the gross yield minus the total cost for proton pumping.\n$$\nN_{\\mathrm{ATP, net}} = N_{\\mathrm{ATP, gross}} - (N_{\\mathrm{ATP, leak}} + N_{\\mathrm{ATP, reentry}})\n$$\n$$\nN_{\\mathrm{ATP, net}} = 2.0 - \\left[ \\frac{1}{3.0} \\left( \\frac{\\pi}{2.0} \\times 10^{-3} (10^{-1.2} - 10^{-4.2}) \\right) + \\frac{1}{3.0} \\left( \\frac{1}{1 + 10^{0.34}} \\right) \\right]\n$$\n$$\nN_{\\mathrm{ATP, net}} = 2.0 - \\frac{1}{3.0} \\left[ \\frac{\\pi \\times 10^{-3}}{2.0} (10^{-1.2} - 10^{-4.2}) + \\frac{1}{1 + 10^{0.34}} \\right]\n$$\n\nNow, we compute the numerical value.\nFirst, the leak term cost:\n$$\nN_{\\mathrm{ATP, leak}} = \\frac{1}{3.0} \\left[ \\frac{\\pi \\times 10^{-3}}{2.0} (10^{-1.2} - 10^{-4.2}) \\right] \\approx \\frac{1}{3.0} \\left[ (1.5708 \\times 10^{-3}) (0.063096 - 0.000063) \\right] \\approx \\frac{1}{3.0} [9.8998 \\times 10^{-5}] \\approx 3.300 \\times 10^{-5}\n$$\nNext, the re-entry term cost:\n$$\nN_{\\mathrm{ATP, reentry}} = \\frac{1}{3.0} \\left( \\frac{1}{1 + 10^{0.34}} \\right) \\approx \\frac{1}{3.0} \\left( \\frac{1}{1 + 2.1878} \\right) \\approx \\frac{1}{3.0} \\left( \\frac{1}{3.1878} \\right) \\approx \\frac{0.31370}{3.0} \\approx 0.10457\n$$\nTotal cost:\n$$\nN_{\\mathrm{ATP, cost}} = N_{\\mathrm{ATP, leak}} + N_{\\mathrm{ATP, reentry}} \\approx 3.300 \\times 10^{-5} + 0.10457 \\approx 0.10460\n$$\nFinal net ATP yield:\n$$\nN_{\\mathrm{ATP, net}} = 2.0 - 0.10460 = 1.8954\n$$\nRounding to four significant figures, the result is $1.895$.",
            "answer": "$$\n\\boxed{1.895}\n$$"
        },
        {
            "introduction": "Having explored the cellular metabolism of a single bacterium, we now scale up to model its impact on the biofilm microenvironment. This exercise applies principles of physical chemistry to predict the drop in plaque $pH$ resulting from the collective acid production of a bacterial microcolony. This hands-on calculation bridges the gap between microbial metabolism and the physicochemical event—demineralization—that defines a carious lesion, highlighting the critical roles of buffering capacity and biofilm volume. ",
            "id": "4734036",
            "problem": "A sucrose-challenged dental plaque microcolony dominated by lactic-acid-producing streptococci (for example, Streptococcus mutans (S. mutans)) is monitored during the initial post-exposure phase. Assume the following scientifically grounded bases: (i) conservation of mass for the produced nonvolatile acid within the plaque control volume, (ii) the intensive buffer capacity, defined at the initial hydrogen potential as $ \\beta = \\left.\\frac{dC_{b}}{d\\,pH}\\right|_{pH_0} $ with units of $ \\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\text{per pH unit} $, quantifies the change in strong base concentration required to change $pH$ by one unit and, by symmetry for small perturbations, relates an added strong monoprotic acid concentration increment $dC_{a}$ to an opposing $dpH$ via $ dC_{a} = -\\beta\\, dpH $ around $pH_0$, and (iii) during a short observation window the system can be treated as a well-mixed compartment with negligible acid clearance and time-invariant $ \\beta $ near $ pH_0 $. The lactic acid production rate by the microcolony is measured as a constant $ q_{acid} $ (in $ \\mathrm{mol}\\,\\mathrm{s}^{-1} $) over a time interval $ \\Delta t $, and the plaque control volume is $ V $.\n\nGiven $ q_{acid} = 3.20 \\times 10^{-9} $, $ \\Delta t = 180 $, $ V = 7.50 \\times 10^{-5} $ $\\mathrm{L}$, and $ \\beta = 1.50 \\times 10^{-2} $ $ \\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\text{per pH unit} $, use the bases above to derive, from first principles, an expression for the initial $pH$ change $ \\Delta pH $ over the interval $ \\Delta t $ and then compute its value for this system. State the sign of $ \\Delta pH $ under these conditions. Round your answer to three significant figures. Express the $pH$ change as a pure number (dimensionless).",
            "solution": "The problem will first be subject to rigorous validation before any attempt at a solution is made.\n\n### Step 1: Extraction of Givens\nThe explicit data, definitions, and conditions provided in the problem statement are as follows:\n- **Acid production rate**: $q_{acid} = 3.20 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{s}^{-1}$\n- **Time interval**: $\\Delta t = 180 \\, \\mathrm{s}$\n- **Plaque control volume**: $V = 7.50 \\times 10^{-5} \\, \\mathrm{L}$\n- **Buffer capacity**: $\\beta = 1.50 \\times 10^{-2} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\text{per pH unit}$\n- **Definition of buffer capacity**: $\\beta = \\left.\\frac{dC_{b}}{d\\,pH}\\right|_{pH_0}$, where $C_b$ is the concentration of strong base.\n- **Relationship for acid addition**: For a small perturbation, an increment of strong monoprotic acid concentration $dC_{a}$ relates to the change in hydrogen potential $dpH$ via $dC_{a} = -\\beta\\, dpH$.\n- **System assumptions**:\n    1. Conservation of mass for the produced acid.\n    2. The system is a well-mixed compartment.\n    3. Negligible acid clearance during the observation window.\n    4. The buffer capacity $\\beta$ is time-invariant near the initial hydrogen potential $pH_0$.\n- **Objective**: Derive an expression for the $pH$ change, $\\Delta pH$, and compute its numerical value, rounded to three significant figures. State the sign of the change.\n\n### Step 2: Validation of the Problem Statement\nThe problem is assessed against the required criteria.\n1.  **Scientific Grounding**: The problem is scientifically grounded in the fields of physical chemistry and microbiology (specifically, cariology). The model describes the drop in $pH$ in a dental plaque biofilm following sucrose exposure, a cornerstone concept in understanding dental caries. The key elements—acid production by streptococci, plaque volume, and the buffering capacity of the plaque fluid/saliva system—are all standard and established scientific concepts. The definition of buffer capacity, $\\beta$, and its application to resist $pH$ changes are fundamental principles of acid-base chemistry.\n2.  **Well-Posedness**: The problem is well-posed. It provides all necessary parameters ($q_{acid}$, $\\Delta t$, $V$, $\\beta$) and a set of simplifying, but clearly stated, assumptions (constant production rate, no clearance, constant $\\beta$) that allow for the derivation of a unique and meaningful solution for $\\Delta pH$.\n3.  **Objectivity**: The problem is stated in precise, objective, and technical language, free from subjective or ambiguous terminology.\n4.  **Consistency and Completeness**: The provided data are internally consistent and sufficient for a solution. The units are consistent: the rate $q_{acid}$ ($\\mathrm{mol}\\,\\mathrm{s}^{-1}$) multiplied by time $\\Delta t$ ($\\mathrm{s}$) gives moles; dividing by volume $V$ ($\\mathrm{L}$) gives concentration ($\\mathrm{mol}\\,\\mathrm{L}^{-1}$); dividing by buffer capacity $\\beta$ ($\\mathrm{mol}\\,\\mathrm{L}^{-1}$) yields a dimensionless quantity, which is appropriate for $\\Delta pH$.\n\n### Step 3: Verdict\nThe problem is scientifically sound, well-posed, and internally consistent. It is deemed **valid**. A solution will now be derived from first principles as requested.\n\n### Derivation and Solution\n\nThe objective is to determine the change in the hydrogen potential, $\\Delta pH$, over a time interval $\\Delta t$. We begin from the principle of conservation of mass.\n\nThe total molar quantity of lactic acid, $\\Delta n_{acid}$, produced by the microcolony over the time interval $\\Delta t$ is given by the product of the constant production rate, $q_{acid}$, and the duration of the interval.\n$$\n\\Delta n_{acid} = q_{acid} \\cdot \\Delta t\n$$\nLactic acid is a strong monoprotic acid in the context of physiological $pH$ ranges well above its $pK_a$ of approximately $3.86$.\n\nUnder the assumption that the system is a well-mixed compartment and acid clearance is negligible, this amount of acid, $\\Delta n_{acid}$, is distributed uniformly throughout the control volume $V$. This results in an increase in the concentration of the acid, $\\Delta C_a$.\n$$\n\\Delta C_a = \\frac{\\Delta n_{acid}}{V} = \\frac{q_{acid} \\cdot \\Delta t}{V}\n$$\nThe problem provides the relationship between an infinitesimal change in acid concentration, $dC_a$, and the corresponding infinitesimal change in hydrogen potential, $dpH$, as governed by the buffer capacity, $\\beta$:\n$$\ndC_{a} = -\\beta\\, dpH\n$$\nThe assumptions that $\\beta$ is constant and the time interval is short allow us to integrate this differential relationship or, equivalently, approximate it for finite changes ($\\Delta$). This linearization is justified for the small perturbations expected in this context.\n$$\n\\Delta C_a \\approx -\\beta \\cdot \\Delta pH\n$$\nRearranging this equation to solve for $\\Delta pH$ gives:\n$$\n\\Delta pH = -\\frac{\\Delta C_a}{\\beta}\n$$\nSubstituting our expression for $\\Delta C_a$ yields the final derived expression for the change in hydrogen potential:\n$$\n\\Delta pH = -\\frac{q_{acid} \\cdot \\Delta t}{V \\cdot \\beta}\n$$\nThis expression demonstrates that the change in $pH$ is directly proportional to the acid production rate and the time interval, and inversely proportional to the volume and the buffer capacity of the system.\n\nThe sign of $\\Delta pH$ is determined by the signs of the quantities on the right-hand side. The parameters $q_{acid}$, $\\Delta t$, $V$, and $\\beta$ are all given as positive quantities. Therefore, the resulting $\\Delta pH$ will be negative, which is chemically consistent with the addition of an acid to a buffered system.\n\nWe now compute the numerical value for $\\Delta pH$ by substituting the given values into the derived expression.\n- $q_{acid} = 3.20 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{s}^{-1}$\n- $\\Delta t = 180 \\, \\mathrm{s}$\n- $V = 7.50 \\times 10^{-5} \\, \\mathrm{L}$\n- $\\beta = 1.50 \\times 10^{-2} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$\n\n$$\n\\Delta pH = -\\frac{(3.20 \\times 10^{-9} \\, \\mathrm{mol}\\,\\mathrm{s}^{-1}) \\cdot (180 \\, \\mathrm{s})}{(7.50 \\times 10^{-5} \\, \\mathrm{L}) \\cdot (1.50 \\times 10^{-2} \\, \\mathrm{mol}\\,\\mathrm{L}^{-1})}\n$$\nFirst, we calculate the numerator (total moles of acid produced):\n$$\n\\Delta n_{acid} = (3.20 \\times 10^{-9}) \\cdot (180) \\, \\mathrm{mol} = 576 \\times 10^{-9} \\, \\mathrm{mol} = 5.76 \\times 10^{-7} \\, \\mathrm{mol}\n$$\nNext, we calculate the denominator:\n$$\nV \\cdot \\beta = (7.50 \\times 10^{-5}) \\cdot (1.50 \\times 10^{-2}) \\, \\mathrm{mol} = 11.25 \\times 10^{-7} \\, \\mathrm{mol} = 1.125 \\times 10^{-6} \\, \\mathrm{mol}\n$$\nNow, we compute the final ratio:\n$$\n\\Delta pH = -\\frac{5.76 \\times 10^{-7} \\, \\mathrm{mol}}{1.125 \\times 10^{-6} \\, \\mathrm{mol}} = -0.512\n$$\nThe calculation confirms the negative sign for the change in $pH$. The value, rounded to three significant figures as requested, is $-0.512$. This indicates a drop of approximately half a $pH$ unit under the specified conditions.",
            "answer": "$$\n\\boxed{-0.512}\n$$"
        },
        {
            "introduction": "Real-world oral biofilms are complex ecosystems, and identifying the key pathogenic players from sequencing data requires sophisticated statistical tools. This computational practice introduces a cornerstone of modern microbiome analysis: the centered log-ratio (CLR) transformation for handling compositional data. By implementing this analytical pipeline, you will learn to overcome the statistical pitfalls inherent in compositional datasets and robustly identify taxa significantly associated with dental caries. ",
            "id": "4734005",
            "problem": "You are given compositional sequencing data from supragingival plaque samples measured across multiple microbial taxa, with binary labels indicating whether each sample is from a caries-active site or a caries-free site. Compositional data reside in the simplex due to the closure constraint and can yield spurious correlations when analyzed on raw counts or proportions. Your task is to design and implement a program that, starting from foundational principles of compositional data analysis and statistical inference, performs a centered log-ratio analysis to identify taxa associated with caries while avoiding spurious correlations.\n\nUse the following foundational base without providing or assuming shortcut formulas in advance: (i) compositional data are positive-valued vectors constrained by a constant-sum operation, (ii) robust inference in the Aitchison geometry is achieved via log-ratio transformations that remove the effect of closure, (iii) statistical comparison between two groups should account for unequal variances, and (iv) multiple hypothesis testing requires control of the false discovery rate.\n\nDefine the following computational objects in precise mathematical terms. Let $X \\in \\mathbb{R}_{+}^{n \\times p}$ be the matrix of strictly nonnegative counts, with $n$ samples and $p$ taxa, and let $y \\in \\{0,1\\}^{n}$ denote the binary caries label for each sample, where $y_i = 1$ indicates caries and $y_i = 0$ indicates healthy. To operate in a log-ratio space, you must apply a principled zero-handling strategy to $X$ prior to transformation to avoid undefined logarithms, consistent with the geometry of the simplex. After transformation into an appropriate log-ratio space that centers each composition to remove closure-induced correlations, compute for each taxon $j \\in \\{1,\\dots,p\\}$ the group-wise difference between the caries and healthy means and test whether that difference is statistically significant under unequal variances. Control the false discovery rate at level $\\alpha$ using a valid step-up procedure. A taxon is deemed associated with caries if and only if its effect direction is strictly positive and it is significant under false discovery rate control at the chosen $\\alpha$.\n\nYour program must implement the following steps in pure algorithmic terms based on the above principles:\n- Replace zeros in $X$ with a small positive constant before applying the transformation into a centered log-ratio space.\n- Compute a group-wise statistic that measures the difference in location between caries and healthy in the transformed space for each taxon $j$.\n- For each taxon $j$, perform a valid two-sample test under unequal variances and obtain a $p$-value.\n- Apply a false discovery rate control at level $\\alpha$ via a valid step-up procedure over the set of $p$-values to obtain adjusted decision thresholds.\n- Return the set of indices of taxa with positive effects and retained under false discovery rate control.\n\nAngle units are not applicable. No physical units are involved. All outputs must be mathematical lists of integers.\n\nImplement your solution over the following test suite of explicit parameter values that stress different facets of the problem. Each test case provides $X$ and $y$. Taxa indices $j$ are zero-based in the program output. The taxa ordering is fixed across all test cases as follows: $t_0$ is Streptococcus mutans, $t_1$ is Veillonella parvula, $t_2$ is Scardovia wiggsiae, $t_3$ is Actinomyces naeslundii, and $t_4$ is Rothia dentocariosa.\n\n- Test Case $1$ (balanced design with minimal zeros):\n  - $n = 6$, $p = 5$.\n  - $X^{(1)}$ rows (each row is one sample): $(120,30,80,20,10)$, $(150,25,60,25,15)$, $(130,28,75,22,12)$, $(40,50,15,35,30)$, $(45,55,10,40,25)$, $(35,60,12,45,28)$.\n  - $y^{(1)} = (1,1,1,0,0,0)$.\n\n- Test Case $2$ (presence of structural zeros requiring principled handling):\n  - $n = 6$, $p = 5$.\n  - $X^{(2)}$ rows: $(80,0,40,0,5)$, $(90,5,35,0,10)$, $(85,0,38,2,0)$, $(20,30,5,25,15)$, $(25,28,6,30,12)$, $(18,35,4,20,10)$.\n  - $y^{(2)} = (1,1,1,0,0,0)$.\n\n- Test Case $3$ (sparse counts with consistent relative enrichment patterns):\n  - $n = 8$, $p = 5$.\n  - $X^{(3)}$ rows: $(25,5,18,3,1)$, $(22,4,20,2,1)$, $(24,6,17,4,2)$, $(23,5,19,3,1)$, $(8,10,6,9,3)$, $(9,12,5,8,2)$, $(7,11,7,10,4)$, $(8,9,6,9,3)$.\n  - $y^{(3)} = (1,1,1,1,0,0,0,0)$.\n\nFor all test cases, use a false discovery rate level $\\alpha = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list of zero-based taxon indices associated with caries for the corresponding test case. For example, the output format must look like $[ [i\\_1,i\\_2], [j\\_1], [] ]$, with no additional text.",
            "solution": "The problem presents a valid and well-posed task in computational biology, specifically in microbiome data analysis. It requires the implementation of a standard, statistically robust pipeline to identify microbial taxa associated with dental caries from compositional sequencing data. The problem is scientifically grounded, free of contradictions, and provides all necessary information to proceed with a solution. The proposed methodology, based on centered log-ratio transformation, Welch's t-test, and Benjamini-Hochberg false discovery rate control, is a cornerstone of modern microbiome analysis and is appropriate for the data and question at hand.\n\nThe solution is constructed by following a sequence of principled analytical steps, which are detailed below.\n\nFirst, let the raw count data be represented by a matrix $X \\in \\mathbb{R}^{n \\times p}$, where $n$ is the number of samples and $p$ is the number of microbial taxa. A corresponding vector $y \\in \\{0,1\\}^n$ provides the binary class labels, with $y_i=1$ indicating a sample from a caries-active site and $y_i=0$ indicating a healthy site.\n\nThe analytical pipeline proceeds as follows:\n\n1.  **Zero Value Imputation**: Compositional data analysis relies on log-ratio transformations, which are undefined for zero values. The count matrix $X$ may contain zeros, representing either the absence of a taxon or insufficient sequencing depth. A common and necessary preprocessing step is to replace these zeros with a small, positive constant, $\\delta$. This process, known as imputation, creates a new matrix $X'$ where every element is strictly positive.\n    $$\n    X'_{i,j} = \\begin{cases} X_{i,j} & \\text{if } X_{i,j} > 0 \\\\ \\delta & \\text{if } X_{i,j} = 0 \\end{cases}\n    $$\n    For this analysis, a value of $\\delta = 0.5$ is chosen. This value represents a standard pseudo-count that is small relative to typical count values but large enough to avoid numerical instability. The matrix $X'$ is then treated as the input for the subsequent transformation.\n\n2.  **Centered Log-Ratio (CLR) Transformation**: The fundamental issue with compositional data is the unit-sum constraint (closure), which induces spurious negative correlations between components. The Aitchison geometry framework addresses this by transforming the data from the simplex (the space of compositions) to a standard Euclidean space. The centered log-ratio (CLR) transformation is one such method. For each sample (row) $\\mathbf{x}'_i$ in the imputed matrix $X'$, the CLR-transformed vector $\\mathbf{z}_i$ is computed by taking the logarithm of each component and centering it by subtracting the mean of the logarithms for that sample. The geometric mean of the components of a sample $\\mathbf{x}'_i$ is given by $g(\\mathbf{x}'_i) = \\left( \\prod_{j=1}^{p} x'_{i,j} \\right)^{1/p}$. The CLR transformation for the $j$-th component of the $i$-th sample is then:\n    $$\n    z_{i,j} = \\ln\\left(\\frac{x'_{i,j}}{g(\\mathbf{x}'_i)}\\right) = \\ln(x'_{i,j}) - \\frac{1}{p}\\sum_{k=1}^{p}\\ln(x'_{i,k})\n    $$\n    This transformation results in a matrix $Z \\in \\mathbb{R}^{n \\times p}$ where the rows sum to zero ($\\sum_{j=1}^{p} z_{i,j} = 0$). The data in $Z$ are now in a real vector space where standard statistical tests can be validly applied.\n\n3.  **Two-Sample Hypothesis Testing**: To identify taxa that differ in abundance between caries-active and healthy sites, we perform a two-sample test for each taxon $j \\in \\{1, \\dots, p\\}$. The CLR-transformed data for taxon $j$ are partitioned into two groups based on the label vector $y$: the caries group $Z_j^{(1)} = \\{z_{i,j} | y_i = 1\\}$ and the healthy group $Z_j^{(0)} = \\{z_{i,j} | y_i = 0\\}$. The problem specifies that the test must account for potentially unequal variances between the two groups. Welch's t-test is the appropriate statistical test for this condition. For each taxon $j$, we test the null hypothesis $H_{0,j}: \\mu_j^{(1)} = \\mu_j^{(0)}$, where $\\mu_j^{(1)}$ and $\\mu_j^{(0)}$ are the true means of the CLR-transformed abundances for the caries and healthy populations, respectively.\n\n    The Welch's t-statistic is calculated as:\n    $$\n    t_j = \\frac{\\bar{z}_j^{(1)} - \\bar{z}_j^{(0)}}{\\sqrt{ \\frac{(s_j^{(1)})^2}{n_1} + \\frac{(s_j^{(0)})^2}{n_0} }}\n    $$\n    where $\\bar{z}_j$ and $s_j^2$ are the sample mean and variance for each group, and $n_1$ and $n_0$ are the sample sizes. The degrees of freedom, $\\nu_j$, are estimated using the Welch-Satterthwaite equation. This test yields a $p$-value, $p_j$, for each taxon, which represents the probability of observing a difference at least as large as the one measured, assuming the null hypothesis is true.\n\n4.  **False Discovery Rate (FDR) Control**: Since we are performing $p$ simultaneous hypothesis tests, there is an increased risk of making Type I errors (false positives). To address this, we must adjust for multiple comparisons. The problem mandates controlling the false discovery rate at a level $\\alpha=0.05$ using a step-up procedure. The Benjamini-Hochberg (BH) procedure is a standard and valid method for this purpose. The steps are as follows:\n    a. The $p$ p-values, $\\{p_1, \\dots, p_p\\}$, are ordered from smallest to largest: $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(p)}$.\n    b. We find the largest rank $k$ such that its corresponding p-value, $p_{(k)}$, satisfies the condition $p_{(k)} \\le \\frac{k}{p} \\alpha$.\n    c. If such a $k$ exists, all null hypotheses $H_{0,(i)}$ for $i=1, \\dots, k$ are rejected. This is equivalent to finding a threshold $p_{BH}$ (which is $p_{(k)}$) and rejecting any original hypothesis $H_{0,j}$ where $p_j \\le p_{BH}$. If no such $k$ exists, no hypotheses are rejected.\n\n5.  **Identification of Caries-Associated Taxa**: A taxon is deemed to be associated with caries if it satisfies two conditions:\n    a. **Statistical Significance**: Its null hypothesis is rejected according to the Benjamini-Hochberg procedure at level $\\alpha = 0.05$.\n    b. **Direction of Effect**: Its mean CLR-transformed abundance is strictly greater in the caries group than in the healthy group. This corresponds to a positive effect size, $\\bar{z}_j^{(1)} - \\bar{z}_j^{(0)} > 0$.\n\nThe final result for each test case is the set of zero-based indices of taxa that meet both of these criteria.",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the problem of identifying caries-associated taxa from compositional data.\n\n    The function implements a multi-step bioinformatic and statistical pipeline:\n    1. Zero Imputation: Replaces zero counts with a small constant (0.5).\n    2. Centered Log-Ratio (CLR) Transformation: Transforms data from the compositional\n       simplex to a Euclidean space to enable standard statistical analysis.\n    3. Welch's t-test: For each taxon, performs a two-sample t-test between\n       caries and healthy groups, assuming unequal variances.\n    4. False Discovery Rate (FDR) Control: Applies the Benjamini-Hochberg (BH)\n       procedure to the set of p-values to correct for multiple testing.\n    5. Final Selection: Identifies taxa that are statistically significant after\n       FDR correction and show a positive association with caries (higher mean\n       abundance in the caries group).\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X\": np.array([\n                [120, 30, 80, 20, 10],\n                [150, 25, 60, 25, 15],\n                [130, 28, 75, 22, 12],\n                [40, 50, 15, 35, 30],\n                [45, 55, 10, 40, 25],\n                [35, 60, 12, 45, 28]\n            ], dtype=float),\n            \"y\": np.array([1, 1, 1, 0, 0, 0])\n        },\n        {\n            \"X\": np.array([\n                [80, 0, 40, 0, 5],\n                [90, 5, 35, 0, 10],\n                [85, 0, 38, 2, 0],\n                [20, 30, 5, 25, 15],\n                [25, 28, 6, 30, 12],\n                [18, 35, 4, 20, 10]\n            ], dtype=float),\n            \"y\": np.array([1, 1, 1, 0, 0, 0])\n        },\n        {\n            \"X\": np.array([\n                [25, 5, 18, 3, 1],\n                [22, 4, 20, 2, 1],\n                [24, 6, 17, 4, 2],\n                [23, 5, 19, 3, 1],\n                [8, 10, 6, 9, 3],\n                [9, 12, 5, 8, 2],\n                [7, 11, 7, 10, 4],\n                [8, 9, 6, 9, 3]\n            ], dtype=float),\n            \"y\": np.array([1, 1, 1, 1, 0, 0, 0, 0])\n        }\n    ]\n    \n    alpha = 0.05\n    all_results = []\n\n    for case in test_cases:\n        X, y = case[\"X\"], case[\"y\"]\n        n_samples, n_taxa = X.shape\n\n        # Step 1: Zero Imputation\n        X_imputed = np.copy(X)\n        X_imputed[X_imputed == 0] = 0.5\n        \n        # Step 2: Centered Log-Ratio (CLR) Transformation\n        log_X = np.log(X_imputed)\n        gmean_log_X = np.mean(log_X, axis=1, keepdims=True)\n        Z = log_X - gmean_log_X\n        \n        caries_indices = (y == 1)\n        healthy_indices = (y == 0)\n\n        Z_caries = Z[caries_indices, :]\n        Z_healthy = Z[healthy_indices, :]\n\n        p_values = np.zeros(n_taxa)\n        effect_directions = np.zeros(n_taxa)\n\n        for j in range(n_taxa):\n            # Step 3: Two-Sample Hypothesis Testing (Welch's t-test)\n            group1 = Z_caries[:, j]\n            group2 = Z_healthy[:, j]\n            \n            # The test is for difference, so it is two-tailed.\n            t_stat, p_val = stats.ttest_ind(group1, group2, equal_var=False, nan_policy='raise')\n            p_values[j] = p_val\n            \n            # Calculate mean difference for effect direction\n            mean_diff = np.mean(group1) - np.mean(group2)\n            effect_directions[j] = mean_diff\n\n        # Step 4: False Discovery Rate (FDR) Control (Benjamini-Hochberg)\n        sorted_indices = np.argsort(p_values)\n        p_values_sorted = p_values[sorted_indices]\n        \n        bh_threshold = 0.0\n        for i in range(n_taxa - 1, -1, -1):\n            rank = i + 1\n            critical_value = (rank / n_taxa) * alpha\n            if p_values_sorted[i] = critical_value:\n                bh_threshold = p_values_sorted[i]\n                break\n        \n        significant_mask = (p_values = bh_threshold) if bh_threshold > 0 else np.zeros(n_taxa, dtype=bool)\n\n        # Step 5: Identify Caries-Associated Taxa\n        # A taxon must be significant AND have a positive effect direction\n        positive_effect_mask = effect_directions > 0\n        final_associated_mask = significant_mask  positive_effect_mask\n        \n        associated_taxa_indices = np.where(final_associated_mask)[0].tolist()\n        \n        all_results.append(associated_taxa_indices)\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}