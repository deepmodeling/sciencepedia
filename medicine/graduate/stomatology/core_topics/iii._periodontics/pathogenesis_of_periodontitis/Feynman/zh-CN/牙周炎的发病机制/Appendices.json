{
    "hands_on_practices": [
        {
            "introduction": "牙周炎的诊断和监测依赖于临床附着丧失 ($CAL$) 和影像学牙槽骨丧失 ($RBL$) 等指标。本练习旨在将这些纵向临床数据转化为量化的疾病进展速率，并将其与潜在的炎症和组织破坏分子通路联系起来。通过这种方式，我们可以从常规临床测量中估算疾病过程的强度，这突显了现代临床科学的量化本质，并为理解疾病的动态变化提供了坚实的基础。",
            "id": "4748216",
            "problem": "在牙周炎的发病机制中，龈下生态失调的生物膜会驱动宿主产生炎症反应，释放如白细胞介素-1β (IL-1β) 等促炎细胞因子，并激活如基质金属蛋白酶-8 (MMP-8) 等蛋白水解酶，从而导致胶原蛋白分解和牙槽骨吸收。考虑一名患者的一颗后牙，在时间 $t = 0, 2, 5$ 年时，对其进行了纵向监测，并获得了标准化的临床和影像学测量数据。在这些时间点，临床附着丧失 (CAL) 分别为 $2.0 \\ \\mathrm{mm}$、$3.4 \\ \\mathrm{mm}$ 和 $6.2 \\ \\mathrm{mm}$。标准化的根尖周X线片报告显示，牙骨质-牙釉质界到牙槽嵴顶的距离 (CEJ–AC) 分别为 $3.2 \\ \\mathrm{mm}$、$4.0 \\ \\mathrm{mm}$ 和 $6.5 \\ \\mathrm{mm}$。解剖学牙根长度为 $14.0 \\ \\mathrm{mm}$。假设生理性CEJ–AC为 $2.0 \\ \\mathrm{mm}$；每个时间点的病理性影像学骨丧失 (RBL) 是指超出 $2.0 \\ \\mathrm{mm}$ 的部分，且该值不小于零。\n\n请使用以下基于经过充分检验的生物学原理的建模与估计框架：\n- 将每种测量方式的疾病进展速率视为相应测量值与时间的最小二乘线性回归斜率。即，对于临床附着丧失 (CAL)，根据三个时间点的数据估计斜率 $s_{\\mathrm{CAL}}$（单位为 $\\mathrm{mm} \\cdot \\mathrm{year}^{-1}$）；对于病理性影像学骨丧失 (RBL，单位为 $\\mathrm{mm}$)，类似地估计 $s_{\\mathrm{RBL}}$（单位为 $\\mathrm{mm} \\cdot \\mathrm{year}^{-1}$）。\n- 通过加权组合 $G = w_{\\mathrm{CAL}} \\, s_{\\mathrm{CAL}} + w_{\\mathrm{RBL}} \\, s_{\\mathrm{RBL}}$ 定义一个复合进展指数，此处将其解释为一个连续的“分级”估计值，其中权重为 $w_{\\mathrm{CAL}} = 0.60$ 和 $w_{\\mathrm{RBL}} = 0.40$。\n- 假设在龈沟液 (GCF) 中处于准稳态时，细胞因子的产生与清除达到平衡。将 IL-1β 的产生速率建模为与复合进展指数成正比：$r_{\\mathrm{IL1}} = k_{1} \\, G$，其中 $k_{1} = 600 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1} \\cdot \\mathrm{mm}^{-1}$。设一级清除速率常数为 $k_{c} = 3.0 \\ \\mathrm{year}^{-1}$，则稳态 IL-1β 浓度为 $C_{\\mathrm{IL1}} = r_{\\mathrm{IL1}} / k_{c}$（单位为 $\\mathrm{pg} \\cdot \\mathrm{mL}^{-1}$）。\n- 将活性 MMP-8 的分数 $A$（无单位）建模为一个 Hill 型 S 状曲线，形式为 $A = \\dfrac{C_{\\mathrm{IL1}}^{n}}{K^{n} + C_{\\mathrm{IL1}}^{n}}$，其中 Hill 系数 $n = 2$，半活化常数 $K = 100 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1}$。\n\n计算预测的稳态 MMP-8 活化分数 $A$。将您的答案表示为四舍五入到四位有效数字的无单位小数。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、提法恰当且自洽的。所提供的数据、定义和模型是一致的，可以得出一个唯一的、可计算的解。任务是遵循一个多步骤的建模框架，计算预测的稳态 MMP-8 活化分数 $A$。\n\n解题过程按以下顺序进行：\n首先，我们计算指定时间点的病理性影像学骨丧失 (RBL) 的值。\n其次，我们通过执行最小二乘线性回归，确定临床附着丧失 ($s_{\\mathrm{CAL}}$) 和影像学骨丧失 ($s_{\\mathrm{RBL}}$) 的疾病进展速率。\n第三，我们计算复合进展指数 $G$。\n第四，我们计算白细胞介素-1β 的稳态浓度 $C_{\\mathrm{IL1}}$。\n最后，我们使用该浓度，通过给定的 Hill 方程计算 MMP-8 活化分数 $A$。\n\n**步骤1：计算病理性影像学骨丧失 (RBL)**\n\n问题将病理性 RBL 定义为牙骨质-牙釉质界到牙槽嵴顶的距离 (CEJ–AC) 超出 $2.0 \\ \\mathrm{mm}$ 生理基线的部分，且该值不小于零。公式为 $\\mathrm{RBL} = \\max(0, \\text{CEJ–AC} - 2.0 \\ \\mathrm{mm})$。\n给定的 CEJ–AC 测量值在时间 $t = 0, 2, 5$ 年。\n- 在 $t=0$ 时：CEJ–AC = $3.2 \\ \\mathrm{mm}$。RBL$(t=0) = \\max(0, 3.2 - 2.0) = 1.2 \\ \\mathrm{mm}$。\n- 在 $t=2$ 时：CEJ–AC = $4.0 \\ \\mathrm{mm}$。RBL$(t=2) = \\max(0, 4.0 - 2.0) = 2.0 \\ \\mathrm{mm}$。\n- 在 $t=5$ 时：CEJ–AC = $6.5 \\ \\mathrm{mm}$。RBL$(t=5) = \\max(0, 6.5 - 2.0) = 4.5 \\ \\mathrm{mm}$。\n\n**步骤2：估计临床附着丧失 ($s_{\\mathrm{CAL}}$) 的进展速率**\n\n进展速率是 CAL 相对于时间的最小二乘线性回归线的斜率。数据点 $(t_i, y_i)$ 为 $(0, 2.0)$、$(2, 3.4)$ 和 $(5, 6.2)$，其中 $t$ 的单位是年，$y$ (CAL) 的单位是 $\\mathrm{mm}$。对于 $N=3$ 个数据点，斜率 $s$ 由以下公式给出：\n$$s = \\frac{N \\sum(t_i y_i) - (\\sum t_i)(\\sum y_i)}{N \\sum(t_i^2) - (\\sum t_i)^2}$$\n我们计算必要的总和：\n- $\\sum t_i = 0 + 2 + 5 = 7$\n- $\\sum y_i = 2.0 + 3.4 + 6.2 = 11.6$\n- $\\sum t_i^2 = 0^2 + 2^2 + 5^2 = 0 + 4 + 25 = 29$\n- $\\sum (t_i y_i) = (0)(2.0) + (2)(3.4) + (5)(6.2) = 0 + 6.8 + 31.0 = 37.8$\n\n将这些值代入 $s_{\\mathrm{CAL}}$ 的斜率公式：\n$$s_{\\mathrm{CAL}} = \\frac{3 \\times 37.8 - 7 \\times 11.6}{3 \\times 29 - (7)^2} = \\frac{113.4 - 81.2}{87 - 49} = \\frac{32.2}{38} = \\frac{16.1}{19} \\ \\mathrm{mm} \\cdot \\mathrm{year}^{-1}$$\n\n**步骤3：估计影像学骨丧失 ($s_{\\mathrm{RBL}}$) 的进展速率**\n\n类似地，我们对 RBL 与时间进行线性回归。数据点 $(t_i, z_i)$ 为 $(0, 1.2)$、$(2, 2.0)$ 和 $(5, 4.5)$，其中 $z$ (RBL) 的单位是 $\\mathrm{mm}$。时间值及其总和与上面相同。\n- $\\sum z_i = 1.2 + 2.0 + 4.5 = 7.7$\n- $\\sum (t_i z_i) = (0)(1.2) + (2)(2.0) + (5)(4.5) = 0 + 4.0 + 22.5 = 26.5$\n\n代入 $s_{\\mathrm{RBL}}$ 的斜率公式：\n$$s_{\\mathrm{RBL}} = \\frac{3 \\times 26.5 - 7 \\times 7.7}{3 \\times 29 - (7)^2} = \\frac{79.5 - 53.9}{87 - 49} = \\frac{25.6}{38} = \\frac{12.8}{19} \\ \\mathrm{mm} \\cdot \\mathrm{year}^{-1}$$\n\n**步骤4：计算复合进展指数 ($G$)**\n\n指数 $G$ 是两个进展速率的加权和：$G = w_{\\mathrm{CAL}} \\, s_{\\mathrm{CAL}} + w_{\\mathrm{RBL}} \\, s_{\\mathrm{RBL}}$。\n给定的权重为 $w_{\\mathrm{CAL}} = 0.60$ 和 $w_{\\mathrm{RBL}} = 0.40$。\n$$G = (0.60) \\left(\\frac{16.1}{19}\\right) + (0.40) \\left(\\frac{12.8}{19}\\right) = \\frac{0.60 \\times 16.1 + 0.40 \\times 12.8}{19}$$\n$$G = \\frac{9.66 + 5.12}{19} = \\frac{14.78}{19} \\ \\mathrm{mm} \\cdot \\mathrm{year}^{-1}$$\n\n**步骤5：计算稳态 IL-1β 浓度 ($C_{\\mathrm{IL1}}$)**\n\n稳态浓度由 $C_{\\mathrm{IL1}} = r_{\\mathrm{IL1}} / k_{c}$ 给出，其中产生速率为 $r_{\\mathrm{IL1}} = k_{1} \\, G$。\n常数为 $k_1 = 600 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1} \\cdot \\mathrm{mm}^{-1}$ 和 $k_c = 3.0 \\ \\mathrm{year}^{-1}$。\n合并方程，我们得到 $C_{\\mathrm{IL1}} = \\frac{k_1 G}{k_c}$。\n$$C_{\\mathrm{IL1}} = \\frac{(600 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1} \\cdot \\mathrm{mm}^{-1}) \\left(\\frac{14.78}{19} \\ \\mathrm{mm} \\cdot \\mathrm{year}^{-1}\\right)}{3.0 \\ \\mathrm{year}^{-1}}$$\n注意单位组合正确：$(\\mathrm{pg} \\cdot \\mathrm{mL}^{-1} \\cdot \\mathrm{mm}^{-1}) \\cdot (\\mathrm{mm} \\cdot \\mathrm{year}^{-1}) / (\\mathrm{year}^{-1}) = \\mathrm{pg} \\cdot \\mathrm{mL}^{-1}$。\n$$C_{\\mathrm{IL1}} = \\frac{600 \\times 14.78}{19 \\times 3} = \\frac{200 \\times 14.78}{19} = \\frac{2956}{19} \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1}$$\n\n**步骤6：计算 MMP-8 活化分数 ($A$)**\n\n活性 MMP-8 的分数由 Hill 方程给出：\n$$A = \\frac{C_{\\mathrm{IL1}}^{n}}{K^{n} + C_{\\mathrm{IL1}}^{n}}$$\n其中 Hill 系数 $n=2$，半活化常数 $K = 100 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1}$。为了计算方便，可以将其重新排列为：\n$$A = \\frac{(C_{\\mathrm{IL1}}/K)^n}{1 + (C_{\\mathrm{IL1}}/K)^n}$$\n首先，我们计算浓度与半活化常数的比值：\n$$\\frac{C_{\\mathrm{IL1}}}{K} = \\frac{2956/19 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1}}{100 \\ \\mathrm{pg} \\cdot \\mathrm{mL}^{-1}} = \\frac{2956}{1900} = \\frac{739}{475}$$\n现在，我们将这个比值和 $n=2$ 代入 $A$ 的方程中：\n$$A = \\frac{(\\frac{739}{475})^2}{1 + (\\frac{739}{475})^2} = \\frac{739^2}{475^2 + 739^2}$$\n进行计算：\n- $739^2 = 546121$\n- $475^2 = 225625$\n- $475^2 + 739^2 = 225625 + 546121 = 771746$\n$$A = \\frac{546121}{771746} \\approx 0.7076403$$\n\n**步骤7：最终答案的形成**\n\n问题要求最终答案是一个四舍五入到四位有效数字的无单位小数。\n$$A \\approx 0.7076$$\n这是在给定模型和条件下，预测的 MMP-8 稳态活化分数。",
            "answer": "$$\\boxed{0.7076}$$"
        },
        {
            "introduction": "牙槽骨吸收是牙周炎不可逆的终点性破坏，其核心机制是破骨细胞介导的骨重塑失衡。这一过程受到核因子$κB$受体活化因子配体 ($RANKL$) 与其天然抑制剂骨保护素 ($OPG$) 之间比率的严密调控。 本练习让您亲身体验如何应用受体信号传导和系统生物学的基本原理，通过构建一个剂量-效应模型，将牙龈沟液 ($GCF$) 中这些关键生物标志物的浓度与破骨细胞的形成速率直接关联起来，从而定量预测组织破坏的潜力。",
            "id": "4748214",
            "problem": "一名患有广泛性III期牙周炎的患者，对其龈沟液 (GCF) 中的可溶性核因子κB受体活化因子配体 (RANKL) 和骨保护素 (OPG) 进行了检测。测量得到的浓度为 $[\\mathrm{RANKL}] = 180 \\,\\mathrm{pg/mL}$ 和 $[\\mathrm{OPG}] = 60 \\,\\mathrm{pg/mL}$。在牙周炎的发病机制中，RANKL–OPG轴调控破骨细胞的生成：RANKL通过RANK受体刺激破骨细胞前体的分化，而OPG作为一种诱骗受体，能够隔离RANKL并减弱信号传导。\n\n从以下基本依据出发：\n- 在受体介导的信号传导中，当一种激动剂受到可降低游离激动剂可用性的诱骗受体的竞争性拮抗时，对下游通路的净刺激可以由一个无量纲刺激变量来表征，该变量与局部微环境中 $[\\mathrm{RANKL}]/[\\mathrm{OPG}]$ 的比值成正比。\n- 对于具有 $n$ 个有效协同步骤并在刺激水平为 $EC_{50}$ 时达到半数最大激活的协同、可饱和信号转导级联反应，其响应函数的最小形式受限于以下条件：该函数对于刺激是单调递增的，界于0和1之间，当刺激等于 $EC_{50}$ 时其值等于 $1/2$，并且随着 $n$ 的增大而变得更陡峭。\n- 对牙周炎患病组织进行的离体破骨细胞生成测定校准为局部破骨细胞形成响应提供了以下参数：希尔系数 $n = 2$ (无量纲)，在RANKL与OPG比值为 $EC_{50} = 2$ (无量纲)时达到半数最大激活，以及最大破骨细胞形成速率 $V_{\\max} = 120 \\ \\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$。\n\n仅使用这些依据，首先计算由 $[\\mathrm{RANKL}]/[\\mathrm{OPG}]$ 比值给出的无量纲刺激。然后，推导出一个与上述约束条件一致的协同、可饱和的剂量-效应关系，并用它来预测该患者的破骨细胞形成速率。以 个细胞·天$^{-1}$·毫米$^{-2}$ 为单位报告最终的破骨细胞形成速率，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "在尝试任何解答之前，首先对问题陈述进行严格的验证程序。\n\n逐字提取已知条件：\n- 患者病理：广泛性III期牙周炎。\n- 龈沟液 (GCF) 中的分析物浓度：可溶性核因子κB受体活化因子配体，$[\\mathrm{RANKL}] = 180 \\,\\mathrm{pg/mL}$，以及骨保护素，$[\\mathrm{OPG}] = 60 \\,\\mathrm{pg/mL}$。\n- 刺激的基本依据：净刺激是一个无量纲变量，与 $[\\mathrm{RANKL}]/[\\mathrm{OPG}]$ 的比值成正比。\n- 响应函数的基本依据：响应函数的最小形式受限于以下条件：单调递增，界于0和1之间，具有 $n$ 个有效协同步骤，当刺激等于 $EC_{50}$ 时其值等于 $1/2$，且随着 $n$ 的增大而变得更陡峭。\n- 离体测定的校准参数：希尔系数 $n = 2$ (无量纲)，半数最大激活 $EC_{50} = 2$ (无量纲)，以及最大破骨细胞形成速率 $V_{\\max} = 120 \\ \\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$。\n\n根据既定标准对问题进行有效性评估。评估结果为 **有效**。\n1.  **科学依据**：该问题基于公认的RANKL-OPG信号轴，它是骨代谢的关键调节因子，也是牙周炎等骨吸收性疾病发病机制中的一个关键因素。建模方法采用了剂量-效应关系，这是药理学和系统生物学中的一种标准且恰当的方法。\n2.  **适定性**：该问题是适定的。它提供了所有必要的定量数据（$[\\mathrm{RANKL}]$、$[\\mathrm{OPG}]$、$n$、$EC_{50}$、$V_{\\max}$）和对所需模型属性的清晰描述，从而能够得出一个唯一且稳定的解。\n3.  **客观性与一致性**：该问题以客观、定量的术语陈述，没有歧义或主观论断。所有提供的单位和数值彼此一致。\n\n问题验证通过后，分步骤进行求解。\n\n首先，我们计算无量纲刺激变量，记为 $S$。根据问题的基本依据规定，该刺激是RANKL与其竞争性诱骗受体OPG的浓度之比。\n$$S = \\frac{[\\mathrm{RANKL}]}{[\\mathrm{OPG}]}$$\n代入该患者的测量浓度：\n$$S = \\frac{180 \\,\\mathrm{pg/mL}}{60 \\,\\mathrm{pg/mL}} = 3$$\n刺激 $S$ 是一个无量纲量，这与半数最大激活常数 $EC_{50}$ 的无量纲性质相一致。\n\n其次，我们必须根据所提供的约束条件推导出协同、可饱和的剂量-效应函数的数学形式。这组约束条件——单调递增、界于0和1之间、在 $S=EC_{50}$ 时值为 $1/2$、以及由指数 $n$ 控制的协同性——唯一地确定了希尔-朗缪尔方程，通常称为希尔方程。归一化响应函数 $f(S)$ 代表下游通路的分数激活，其表达式为：\n$$f(S) = \\frac{S^n}{EC_{50}^n + S^n}$$\n该方程严格遵守所有指定的约束条件。\n\n第三，我们使用此函数来预测破骨细胞的形成速率。实际速率（我们记为 $V$）是最大可能速率 $V_{\\max}$ 与分数激活 $f(S)$ 的乘积。\n$$V = V_{\\max} \\cdot f(S) = V_{\\max} \\left( \\frac{S^n}{EC_{50}^n + S^n} \\right)$$\n该方程给出了作为刺激和系统参数函数的破骨细胞形成速率。\n\n最后，我们将问题陈述中提供的数值代入此方程，以计算该患者的具体速率。\n参数如下：\n- 刺激: $S = 3$\n- 希尔系数: $n = 2$\n- 半数最大激活比率: $EC_{50} = 2$\n- 最大形成速率: $V_{\\max} = 120 \\ \\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$\n\n代入过程如下：\n$$V = 120 \\cdot \\frac{3^2}{2^2 + 3^2}$$\n$$V = 120 \\cdot \\frac{9}{4 + 9}$$\n$$V = 120 \\cdot \\frac{9}{13}$$\n$$V = \\frac{1080}{13} \\ \\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$$\n\n为获得最终数值答案，我们进行除法运算：\n$$V \\approx 83.076923... \\ \\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$$\n问题要求将最终答案四舍五入至四位有效数字。\n$$V \\approx 83.08 \\ \\text{个细胞} \\cdot \\text{天}^{-1} \\cdot \\text{毫米}^{-2}$$",
            "answer": "$$\\boxed{83.08}$$"
        },
        {
            "introduction": "牙周炎是一种多因素疾病，其发生发展受到微生物、宿主反应以及吸烟和糖尿病等系统性风险因素的共同影响。为了在这种复杂性中理清头绪，我们可以构建整合的数学模型，并使用敏感性分析来系统性地评估哪些因素对疾病结局的影响最大。 这项高级练习将指导您采用系统生物学的视角，通过计算建模来剖析不同风险因素的相对重要性。掌握这种方法对于未来在牙周病学领域制定精准的靶向治疗策略和推进个体化医疗至关重要。",
            "id": "4748237",
            "problem": "本任务要求您实现一个规范的敏感性分析程序，以确定在牙周炎的发病机制中，哪些生物驱动因素对牙槽骨丢失的影响最为显著。该程序需使用一个基于广为接受的骨免疫学原理的简化机理模型。目标是将一个简化的骨重塑模型与一个全局敏感性方法相结合，并为每个测试场景报告唯一一个最具影响力的参数，以基于1的索引形式表示。\n\n建模假设与基本原理：\n- 牙槽骨量 $B(t)$ 代表基线骨量的分数，其中 $B(t) \\in [0,1]$，其演变是成骨细胞形成和破骨细胞吸收的净结果。骨形成受稳态目标的限制，骨吸收由破骨细胞生成信号驱动。\n- 速率方程为：\n  $$\\frac{dB}{dt} = k_f \\,(1 - B) - k_r \\,A(R,I)\\,B,$$\n  其中 $k_f  0$ 是基线形成常数，$k_r  0$ 是吸收转换常数。这两个常数都是固定的，在同一测试用例的样本中不发生变化。除了时间（单位为天）外，所有量纲均为一，但您只需处理稳态情况，并报告一个无量纲的分数作为结果。不涉及角度。\n- 破骨细胞生成活性建模如下：\n  $$A(R,I) = R \\, h(I), \\quad h(I) = \\frac{I^{n}}{K^{n} + I^{n}},$$\n  其中 $R$ 是核因子κB受体活化因子配体与骨保护素（RANKL/OPG）的比值，$h(I)$ 是关于综合炎症驱动 $I$ 的饱和希尔函数，其希尔系数为 $n$，半活化常数为 $K$。\n- 综合炎症驱动 $I$ 是归一化决定因素的加权和：\n  $$I = w_P P + w_V V + w_S S + w_{Smk} Smk + w_{Hg} Hg,$$\n  其中：\n  - $P$ 是牙菌斑生物量（已归一化），\n  - $V$ 是细菌毒力（已归一化），\n  - $S$ 是宿主免疫敏感性（已归一化），\n  - $Smk$ 是吸烟暴露（已归一化），\n  - $Hg$ 是高血糖严重程度（已归一化）。\n  权重固定为 $w_P = 0.40$，$w_V = 0.15$，$w_S = 0.15$，$w_{Smk} = 0.15$ 和 $w_{Hg} = 0.15$，总和为 $1.00$。在敏感性分析中，比值 $R$ 和每个决定因素都被视为独立输入。\n\n固定参数值：\n- $k_f = 0.02$,\n- $k_r = 0.05$,\n- $n = 2$,\n- $K = 0.5$.\n\n结果定义：\n- 将稳态骨分数 $B^\\ast$ 定义为在恒定输入 $(P,V,S,Smk,Hg,R)$ 下 $\\frac{dB}{dt} = 0$ 的稳定解。我们关注的量是稳态骨丢失分数：\n  $$L^\\ast = 1 - B^\\ast,$$\n  该值必须以 $\\left[0,1\\right]$ 范围内的小数形式报告。您不会直接输出 $L^\\ast$；它在内部用于敏感性分析。\n\n全局敏感性分析规范：\n- 使用偏秩相关系数（PRCC）来量化每个输入参数对 $L^\\ast$ 的单调影响，同时控制其他参数的影响。偏秩相关系数（PRCC）的计算方法如下：\n  - 对每个输入和输出进行秩变换，\n  - 对于每个输入 $X_i$，将其秩对剩余输入的秩进行回归，得到残差 $e_{X_i}$，\n  - 将输出的秩对剩余输入的秩进行回归，得到残差 $e_{Y}$，\n  - 计算 $e_{X_i}$ 和 $e_{Y}$ 之间的皮尔逊相关性，得到 $X_i$ 的 PRCC。\n- 对于跨参数范围的抽样，每个测试用例使用拉丁超立方抽样（LHS）抽取 $N = 1000$ 个样本。必须固定随机种子以确保可复现性。\n\n敏感性分析的输入：\n- 待分析的参数排序如下：\n  $$[P, V, S, Smk, Hg, R],$$\n  您的程序必须报告在每个测试场景中，绝对PRCC值最大的参数的索引（基于1）。\n\n测试套件：\n- 使用以下三个测试用例，每个用例都由输入的均匀抽样范围定义：\n  1. 一般环境：\n     - $P \\in [0,1]$, $V \\in [0,1]$, $S \\in [0,1]$, $Smk \\in [0,1]$, $Hg \\in [0,1]$, $R \\in [0.5,2.0]$。\n  2. 低菌斑环境：\n     - $P \\in [0,0.2]$, $V \\in [0,1]$, $S \\in [0,1]$, $Smk \\in [0,1]$, $Hg \\in [0,1]$, $R \\in [0.5,2.0]$。\n  3. 高风险暴露偏斜：\n     - $P \\in [0.3,0.7]$, $V \\in [0,1]$, $S \\in [0,1]$, $Smk \\in [0.6,1.0]$, $Hg \\in [0.6,1.0]$, $R \\in [0.5,2.0]$。\n\n算法要求：\n- 从模型中推导出 $B^\\ast$ 并为每个样本计算 $L^\\ast$。\n- 为每个测试用例实现拉丁超立方抽样，样本数为 $N = 1000$，并使用固定的随机种子。\n- 计算 $6$ 个输入的PRCC，并为每个测试用例找出绝对PRCC值最大的参数的索引（基于1）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[r_1,r_2,r_3]$，其中 $r_j$ 是测试用例 $j$ 中最具影响力参数的基于1的索引。\n- 输出类型必须是整数列表。\n\n注意：\n- 仅使用指定的模型和敏感性方法以及给定的常数。不要引入额外的参数或修改基本方程。\n- 缩写定义：RANK配体（RANKL），骨保护素（OPG），偏秩相关系数（PRCC）。",
            "solution": "该问题要求对牙周炎发病机理的机理模型进行全局敏感性分析，以识别在不同环境情景下牙槽骨丢失的最主要驱动因素。解决方案包括三个主要阶段：推导稳态模型输出，实施拉丁超立方抽样（LHS）方案以生成输入参数集，以及计算偏秩相关系数（PRCC）以量化敏感性。\n\n牙槽骨量 $B(t)$ 的模型由以下常微分方程给出：\n$$\n\\frac{dB}{dt} = k_f \\,(1 - B) - k_r \\,A(R,I)\\,B\n$$\n其中 $B$ 是基线骨量的分数，$k_f = 0.02$ 是形成常数，$k_r = 0.05$ 是吸收转换常数。破骨细胞生成活性 $A(R,I)$ 取决于RANKL/OPG比值 $R$ 和炎症驱动 $I$。\n\n首先，我们确定稳态骨丢失 $L^\\ast$ 的解析表达式。稳态由条件 $\\frac{dB}{dt} = 0$ 定义。设 $B^\\ast$ 为稳态骨量。\n$$\nk_f (1 - B^\\ast) - k_r A(R,I) B^\\ast = 0\n$$\n重新整理各项以求解 $B^\\ast$：\n$$\nk_f = k_f B^\\ast + k_r A(R,I) B^\\ast\n$$\n$$\nk_f = B^\\ast (k_f + k_r A(R,I))\n$$\n$$\nB^\\ast = \\frac{k_f}{k_f + k_r A(R,I)}\n$$\n我们关注的结果是稳态骨丢失分数 $L^\\ast$，定义为 $L^\\ast = 1 - B^\\ast$。\n$$\nL^\\ast = 1 - \\frac{k_f}{k_f + k_r A(R,I)} = \\frac{(k_f + k_r A(R,I)) - k_f}{k_f + k_r A(R,I)}\n$$\n简化后得到：\n$$\nL^\\ast = \\frac{k_r A(R,I)}{k_f + k_r A(R,I)}\n$$\n函数 $A(R,I)$ 定义为 $A(R,I) = R \\cdot h(I)$，其中 $h(I)$ 是一个希尔函数，系数 $n=2$，半活化常数 $K=0.5$：\n$$\nh(I) = \\frac{I^n}{K^n + I^n} = \\frac{I^2}{0.5^2 + I^2} = \\frac{I^2}{0.25 + I^2}\n$$\n综合炎症驱动 $I$ 是 $5$ 个归一化决定因素 $[P, V, S, Smk, Hg]$ 的加权和。\n$$\nI = w_P P + w_V V + w_S S + w_{Smk} Smk + w_{Hg} Hg\n$$\n权重为 $w_P = 0.40$，$w_V = 0.15$，$w_S = 0.15$，$w_{Smk} = 0.15$ 和 $w_{Hg} = 0.15$。敏感性分析将对 $6$ 个输入参数 $[P, V, S, Smk, Hg, R]$ 进行。\n\n敏感性分析使用偏秩相关系数（PRCC）方法。该技术在控制其他输入影响的同时，衡量单个输入与输出之间的单调关系。实施步骤如下：\n1.  **抽样**：对于 $3$ 个测试用例中的每一个，我们使用拉丁超立方抽样（LHS）为 $6$ 个输入参数生成 $N=1000$ 个样本。样本从每个测试用例中指定的范围定义的均匀分布中抽取。固定的随机种子确保了可复现性。\n2.  **模型评估**：对于 $N=1000$ 个输入样本集中的每一个，使用推导出的解析表达式计算模型输出 $L^\\ast$。\n3.  **秩变换**：将 $6$ 个输入参数各自的 $N$ 个值以及输出 $L^\\ast$ 的 $N$ 个值转换为它们的秩。\n4.  **PRCC计算**：对于每个输入参数 $X_i$（其中 $i$ 的范围从 $1$ 到 $6$）：\n    a. 将 $X_i$ 的秩（表示为 $r(X_i)$）对其他 $5$ 个输入 $X_j$（其中 $j \\neq i$）的秩进行回归。计算此线性回归的残差 $e_{X_i}$。此步骤从 $r(X_i)$ 中移除了其他输入的线性影响。\n    b. 同样将输出 $L^\\ast$ 的秩（表示为 $r(L^\\ast)$）对相同的 $5$ 个输入 $X_j$（其中 $j \\neq i$）的秩进行回归。计算此回归的残差 $e_{L^\\ast}$。\n    c. 输入 $X_i$ 的 PRCC 是两组残差 $e_{X_i}$ 和 $e_{L^\\ast}$ 之间的皮尔逊相关系数。\n5.  **识别最具影响力的参数**：对于每个测试用例，比较计算出的 $6$ 个PRCC的绝对值。对应于最大绝对PRCC值的参数被识别为最具影响力的参数。结果以对应于顺序 $[P, V, S, Smk, Hg, R]$ 的基于1的索引报告。\n\n对三个测试场景中的每一个重复此过程，得出一个包含三个索引的列表，该列表构成最终答案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import qmc, rankdata\n\ndef solve():\n    \"\"\"\n    Implements a sensitivity analysis to identify the most influential biological\n    drivers of alveolar bone loss in a model of periodontitis pathogenesis.\n    \"\"\"\n\n    # --- Fixed parameter values ---\n    k_f = 0.02  # Formation constant\n    k_r = 0.05  # Resorptive turnover constant\n    n = 2       # Hill coefficient\n    K = 0.5     # Half-activation constant\n\n    # Weights for the composite inflammatory drive\n    weights = np.array([0.40, 0.15, 0.15, 0.15, 0.15])  # P, V, S, Smk, Hg\n\n    # --- Sensitivity analysis specification ---\n    N = 1000       # Number of samples for LHS\n    SEED = 123     # Fixed random seed for reproducibility\n    NUM_PARAMS = 6 # Number of input parameters: P, V, S, Smk, Hg, R\n\n    # --- Test suite: parameter ranges ---\n    # Each tuple contains lower and upper bounds for the 6 parameters.\n    test_cases = [\n        # 1. General environment\n        (np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.5]), np.array([1.0, 1.0, 1.0, 1.0, 1.0, 2.0])),\n        # 2. Low-plaque environment\n        (np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.5]), np.array([0.2, 1.0, 1.0, 1.0, 1.0, 2.0])),\n        # 3. High-risk exposure skew\n        (np.array([0.3, 0.0, 0.0, 0.6, 0.6, 0.5]), np.array([0.7, 1.0, 1.0, 1.0, 1.0, 2.0])),\n    ]\n\n    def model(P, V, S, Smk, Hg, R):\n        \"\"\"\n        Calculates the steady-state bone loss L_star based on input parameters.\n        \"\"\"\n        # Composite inflammatory drive\n        I_components = np.array([P, V, S, Smk, Hg])\n        I = np.dot(weights, I_components)\n        \n        # Hill function for inflammatory signaling\n        h_I = (I**n) / (K**n + I**n)\n        \n        # Osteoclastogenic activity\n        A_RI = R * h_I\n        \n        # Steady-state bone loss L_star\n        L_star = (k_r * A_RI) / (k_f + k_r * A_RI)\n        return L_star\n\n    def calculate_prcc(l_bounds, u_bounds):\n        \"\"\"\n        Performs LHS and calculates PRCC for all input parameters.\n        \"\"\"\n        # 1. Latin Hypercube Sampling\n        sampler = qmc.LatinHypercube(d=NUM_PARAMS, seed=SEED)\n        samples_01 = sampler.random(n=N)\n        scaled_samples = qmc.scale(samples_01, l_bounds, u_bounds)\n        \n        # 2. Model Evaluation\n        # The model function expects separate arguments, but scaled_samples is a (N, 6) array.\n        # We can either loop or transpose and unpack. Transposing is more efficient.\n        output_L_star = model(*scaled_samples.T)\n        \n        # 3. Rank Transformation\n        ranked_inputs = np.empty_like(scaled_samples)\n        for i in range(NUM_PARAMS):\n            ranked_inputs[:, i] = rankdata(scaled_samples[:, i])\n        \n        ranked_output = rankdata(output_L_star)\n\n        # 4. PRCC Calculation\n        prcc_values = np.zeros(NUM_PARAMS)\n        \n        # Add intercept term for linear regression\n        ranked_output_with_intercept = np.c_[np.ones(N), ranked_output.reshape(-1, 1)]\n\n        for i in range(NUM_PARAMS):\n            # Get ranks of input X_i\n            r_Xi = ranked_inputs[:, i]\n            \n            # Get ranks of other inputs X_{-i}\n            r_X_others = np.delete(ranked_inputs, i, axis=1)\n            \n            # Add intercept term for regression\n            X_reg = np.c_[np.ones(N), r_X_others]\n            \n            # a. Regress r(X_i) on r(X_{-i}) and get residuals\n            beta_i, _, _, _ = np.linalg.lstsq(X_reg, r_Xi, rcond=None)\n            residuals_Xi = r_Xi - X_reg @ beta_i\n            \n            # b. Regress r(L*) on r(X_{-i}) and get residuals\n            beta_L, _, _, _ = np.linalg.lstsq(X_reg, ranked_output, rcond=None)\n            residuals_L = ranked_output - X_reg @ beta_L\n            \n            # c. Compute Pearson correlation of residuals\n            prcc_values[i] = np.corrcoef(residuals_Xi, residuals_L)[0, 1]\n            \n        return prcc_values\n\n    final_results = []\n    for l_bounds, u_bounds in test_cases:\n        prccs = calculate_prcc(l_bounds, u_bounds)\n        # 5. Identify the most influential parameter (1-based index)\n        most_influential_idx = np.argmax(np.abs(prccs)) + 1\n        final_results.append(most_influential_idx)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}