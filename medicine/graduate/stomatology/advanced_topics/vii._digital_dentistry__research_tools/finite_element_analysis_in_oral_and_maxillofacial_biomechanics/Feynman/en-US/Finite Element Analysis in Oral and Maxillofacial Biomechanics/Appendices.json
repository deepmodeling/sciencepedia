{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in any finite element analysis is the accurate representation of real-world loads, which are often distributed pressures, within the discrete framework of the model. This exercise focuses on converting a continuous occlusal pressure on a tooth cusp into a set of 'consistent' nodal forces. Mastering this calculation is fundamental to setting up any valid biomechanical simulation, ensuring that the applied loads are statically equivalent to the physical reality we aim to model .",
            "id": "4718428",
            "problem": "In a bite-force simulation of the mesiobuccal cusp of a mandibular first molar, an occlusal contact patch is represented by a single planar face of a ten-node quadratic tetrahedral element (the face is the standard six-node quadratic triangular face). The outward unit normal of this face points occlusally. During clenching, the antagonist tooth applies a uniform pressure load of magnitude $p_{0} = 8.0 \\times 10^{6}$ Pa on this face, directed apically (i.e., opposite to the outward normal). The measured area of this triangular face is $A = 1.20 \\times 10^{-6}$ m$^2$.\n\nLet the face nodes be ordered so that nodes $1$, $2$, and $3$ are the vertices of the triangle, and nodes $4$, $5$, and $6$ are the midside nodes on edges $\\overline{12}$, $\\overline{23}$, and $\\overline{31}$, respectively. Assume the face is planar, the pressure is spatially uniform over the face, and the shape functions on the face are the standard quadratic Lagrange shape functions of a six-node triangle in barycentric coordinates.\n\nUsing the finite element method principle that a distributed surface traction $\\boldsymbol{t}$ contributes an equivalent nodal force vector given by the surface integral of the shape functions weighted by $\\boldsymbol{t}$, compute the six scalar normal components of the consistent equivalent nodal force vector associated with this face, that is, compute\n$$\nf_{i}^{n} = \\int_{S} N_{i}\\, \\boldsymbol{t} \\cdot \\boldsymbol{n}\\, \\mathrm{d}S \\quad \\text{for } i = 1,\\dots,6,\n$$\nwhere $S$ is the triangular face, $\\boldsymbol{n}$ is the outward unit normal, and $N_{i}$ are the face shape functions. Use the sign convention that positive force is along the outward unit normal. Express your final answer as a single row vector\n$$\n\\bigl[f_{1}^{n} \\;\\; f_{2}^{n} \\;\\; f_{3}^{n} \\;\\; f_{4}^{n} \\;\\; f_{5}^{n} \\;\\; f_{6}^{n}\\bigr].\n$$\n\nRound your answer to three significant figures. Express the result in Newtons.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It describes a standard procedure in computational mechanics for converting a distributed pressure load into a set of statically equivalent nodal forces for a quadratic finite element. All necessary data and definitions are provided. We may therefore proceed with the solution.\n\nThe problem requires the computation of the scalar normal components of the consistent nodal force vector, $f_{i}^{n}$, for a six-node quadratic triangular face subjected to a uniform pressure. The governing equation is given as:\n$$f_{i}^{n} = \\int_{S} N_{i}\\, \\boldsymbol{t} \\cdot \\boldsymbol{n}\\, \\mathrm{d}S \\quad \\text{for } i = 1, \\dots, 6$$\nHere, $S$ is the triangular face area, $N_{i}$ are the shape functions, $\\boldsymbol{n}$ is the outward unit normal vector, and $\\boldsymbol{t}$ is the surface traction vector. The sign convention specifies that a positive force is directed along $\\boldsymbol{n}$.\n\nThe applied load is a uniform pressure of magnitude $p_{0} = 8.0 \\times 10^{6}$ Pa, directed apically, which is opposite to the outward (occlusal) unit normal $\\boldsymbol{n}$. The surface traction vector $\\boldsymbol{t}$ represents force per unit area, so it is given by:\n$$\\boldsymbol{t} = -p_{0} \\boldsymbol{n}$$\nSubstituting this expression for $\\boldsymbol{t}$ into the integral for $f_{i}^{n}$ yields:\n$$f_{i}^{n} = \\int_{S} N_{i} (-p_{0} \\boldsymbol{n}) \\cdot \\boldsymbol{n}\\, \\mathrm{d}S$$\nSince $\\boldsymbol{n}$ is a unit vector, the scalar product $\\boldsymbol{n} \\cdot \\boldsymbol{n} = |\\boldsymbol{n}|^2 = 1$. The expression simplifies to:\n$$f_{i}^{n} = \\int_{S} N_{i} (-p_{0}) \\, \\mathrm{d}S$$\nGiven that the pressure $p_{0}$ is spatially uniform over the face $S$, it can be treated as a constant and factored out of the integral:\n$$f_{i}^{n} = -p_{0} \\int_{S} N_{i} \\, \\mathrm{d}S$$\nThe task thus reduces to evaluating the integral of each shape function $N_{i}$ over the area of the triangle, $A = 1.20 \\times 10^{-6}$ m$^2$.\n\nThe standard Lagrange shape functions for a six-node quadratic triangle are expressed in terms of barycentric coordinates $(\\zeta_1, \\zeta_2, \\zeta_3)$, where $\\zeta_1 + \\zeta_2 + \\zeta_3 = 1$.\nFor the vertex nodes ($i \\in \\{1, 2, 3\\}$):\n$$N_{i} = \\zeta_{i} (2\\zeta_{i} - 1)$$\nFor the midside nodes ($i \\in \\{4, 5, 6\\}$):\n$$N_{4} = 4\\zeta_{1}\\zeta_{2} \\quad (\\text{on edge } \\overline{12})$$\n$$N_{5} = 4\\zeta_{2}\\zeta_{3} \\quad (\\text{on edge } \\overline{23})$$\n$$N_{6} = 4\\zeta_{3}\\zeta_{1} \\quad (\\text{on edge } \\overline{31})$$\n\nThe integral of a monomial of barycentric coordinates over a triangular domain $S$ of area $A$ is given by the standard formula:\n$$\\int_S \\zeta_1^a \\zeta_2^b \\zeta_3^c \\, \\mathrm{d}S = A \\frac{a! b! c! 2!}{(a+b+c+2)!}$$\nWe apply this formula to find the integral of each shape function.\n\nFor a vertex node (e.g., node $1$):\n$$\\int_S N_1 \\, \\mathrm{d}S = \\int_S (2\\zeta_1^2 - \\zeta_1) \\, \\mathrm{d}S = 2\\int_S \\zeta_1^2 \\, \\mathrm{d}S - \\int_S \\zeta_1 \\, \\mathrm{d}S$$\nUsing the integration formula:\n$$\\int_S \\zeta_1^2 \\, \\mathrm{d}S = \\int_S \\zeta_1^2 \\zeta_2^0 \\zeta_3^0 \\, \\mathrm{d}S = A \\frac{2! 0! 0! 2!}{(2+0+0+2)!} = A \\frac{2 \\cdot 1 \\cdot 1 \\cdot 2}{4!} = A \\frac{4}{24} = \\frac{A}{6}$$\n$$\\int_S \\zeta_1 \\, \\mathrm{d}S = \\int_S \\zeta_1^1 \\zeta_2^0 \\zeta_3^0 \\, \\mathrm{d}S = A \\frac{1! 0! 0! 2!}{(1+0+0+2)!} = A \\frac{1 \\cdot 1 \\cdot 1 \\cdot 2}{3!} = A \\frac{2}{6} = \\frac{A}{3}$$\nSubstituting these results back:\n$$\\int_S N_1 \\, \\mathrm{d}S = 2\\left(\\frac{A}{6}\\right) - \\frac{A}{3} = \\frac{A}{3} - \\frac{A}{3} = 0$$\nBy symmetry, the integrals for the other vertex nodes are also zero:\n$$\\int_S N_2 \\, \\mathrm{d}S = 0, \\quad \\int_S N_3 \\, \\mathrm{d}S = 0$$\n\nFor a midside node (e.g., node $4$ on edge $\\overline{12}$):\n$$\\int_S N_4 \\, \\mathrm{d}S = \\int_S 4\\zeta_1 \\zeta_2 \\, \\mathrm{d}S = 4 \\int_S \\zeta_1^1 \\zeta_2^1 \\zeta_3^0 \\, \\mathrm{d}S$$\nUsing the integration formula:\n$$\\int_S \\zeta_1^1 \\zeta_2^1 \\zeta_3^0 \\, \\mathrm{d}S = A \\frac{1! 1! 0! 2!}{(1+1+0+2)!} = A \\frac{1 \\cdot 1 \\cdot 1 \\cdot 2}{4!} = A \\frac{2}{24} = \\frac{A}{12}$$\nSubstituting this result back:\n$$\\int_S N_4 \\, \\mathrm{d}S = 4\\left(\\frac{A}{12}\\right) = \\frac{A}{3}$$\nBy symmetry, the integrals for the other midside nodes are identical:\n$$\\int_S N_5 \\, \\mathrm{d}S = \\frac{A}{3}, \\quad \\int_S N_6 \\, \\mathrm{d}S = \\frac{A}{3}$$\nThis is a known result for quadratic Lagrange elements: a uniform pressure load distributes its equivalent forces entirely to the midside nodes, with the vertex nodes receiving zero force. The sum of the integrated shape functions is $\\sum_{i=1}^6 \\int_S N_i \\, \\mathrm{d}S = 3 \\times 0 + 3 \\times \\frac{A}{3} = A$, which correctly corresponds to $\\int_S (\\sum_i N_i) \\mathrm{d}S = \\int_S 1 \\, \\mathrm{d}S = A$.\n\nNow we compute the nodal forces:\nFor vertex nodes ($i = 1, 2, 3$):\n$$f_{1}^{n} = f_{2}^{n} = f_{3}^{n} = -p_{0} \\times 0 = 0 \\, \\text{N}$$\nFor midside nodes ($i = 4, 5, 6$):\n$$f_{4}^{n} = f_{5}^{n} = f_{6}^{n} = -p_{0} \\left(\\frac{A}{3}\\right) = -\\frac{p_{0}A}{3}$$\nSubstituting the given numerical values, $p_{0} = 8.0 \\times 10^{6}$ N/m$^2$ and $A = 1.20 \\times 10^{-6}$ m$^2$:\n$$f_{4,5,6}^{n} = -\\frac{(8.0 \\times 10^{6}) \\times (1.20 \\times 10^{-6})}{3} = -\\frac{9.6}{3} = -3.2 \\, \\text{N}$$\nThe total normal force on the face is $\\sum f_i^n = 3 \\times 0 + 3 \\times (-3.2) = -9.6 \\, \\text{N}$. This is equal to $-p_0 A$, confirming the equivalence.\n\nThe problem requires the answer to be rounded to three significant figures. The force value $-3.2$ N becomes $-3.20$ N. The zero forces are exact and can be written as $0.00$ for consistency in the final vector.\nThe final nodal force vector is:\n$$ \\bigl[f_{1}^{n} \\;\\; f_{2}^{n} \\;\\; f_{3}^{n} \\;\\; f_{4}^{n} \\;\\; f_{5}^{n} \\;\\; f_{6}^{n}\\bigr] = \\bigl[0.00 \\;\\; 0.00 \\;\\; 0.00 \\;\\; -3.20 \\;\\; -3.20 \\;\\; -3.20\\bigr] $$\nThe units for all components are Newtons (N).",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.00 & 0.00 & 0.00 & -3.20 & -3.20 & -3.20 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once a simulation is complete, the finite element analysis provides a detailed map of the stress state throughout the modeled structure. To make this data clinically actionable, we must interpret it using an appropriate failure theory to assess the risk of mechanical failure, such as bone fracture. This practice demonstrates how to use the Cauchy stress tensor from an FEA result, in conjunction with the pressure-sensitive Drucker–Prager failure criterion, to calculate a quantitative factor of safety at a high-stress location like the mandibular angle .",
            "id": "4718409",
            "problem": "A clinician uses Finite Element Analysis (FEA) to assess the mandibular angle of an adult patient under unilateral molar loading. The occlusal force magnitude is $F_{\\mathrm{occ}} = 700$ N applied at the second molar on the working side. The FEA model predicts the Cauchy stress tensor at a cortical bone element centered at the mandibular angle (anatomical axes: mediolateral $x$, superoinferior $y$, anteroposterior $z$) as\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n-300 & 60 & 0 \\\\\n60 & -150 & 40 \\\\\n0 & 40 & -120\n\\end{pmatrix} \\, \\mathrm{MPa}.\n$$\nTo estimate failure risk in cortical bone, adopt the pressure-sensitive Drucker–Prager (DP) failure criterion, calibrated so that it reproduces the observed uniaxial tensile and compressive strengths of mandibular cortical bone. Use the following material strengths measured in standardized tests: uniaxial tensile strength $\\sigma_{t} = 120 \\, \\mathrm{MPa}$ and uniaxial compressive strength $\\sigma_{c} = 180 \\, \\mathrm{MPa}$. Define the factor of safety as the ratio between the DP failure surface radius and the current stress state measure under the DP criterion. \n\nStarting from fundamental definitions of the stress invariants and the standard calibration of the Drucker–Prager parameters to uniaxial strengths, compute the factor of safety at the given element. Round your final result to three significant figures, and report it as a dimensionless number. Also, based on the computed factor of safety, briefly interpret the clinical risk under static occlusal loading in your reasoning, but express only the numerical factor of safety in your final answer.",
            "solution": "The user-provided problem is evaluated for validity.\n\n### Step 1: Extract Givens\n- Occlusal force magnitude: $F_{\\mathrm{occ}} = 700 \\, \\mathrm{N}$\n- Stress tensor at a cortical bone element:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n-300 & 60 & 0 \\\\\n60 & -150 & 40 \\\\\n0 & 40 & -120\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\n- Uniaxial tensile strength of mandibular cortical bone: $\\sigma_{t} = 120 \\, \\mathrm{MPa}$\n- Uniaxial compressive strength of mandibular cortical bone: $\\sigma_{c} = 180 \\, \\mathrm{MPa}$\n- Failure criterion: Pressure-sensitive Drucker–Prager (DP) criterion.\n- Definition of factor of safety (FS): The ratio between the DP failure surface radius and the current stress state measure under the DP criterion.\n- Required precision: Round the final result to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem uses standard principles from continuum mechanics (Cauchy stress tensor, stress invariants) and material failure theory (Drucker-Prager criterion). The application to bone biomechanics is a well-established field. The provided values for material strengths ($\\sigma_t$, $\\sigma_c$) and occlusal force ($F_{\\mathrm{occ}}$) are within physiologically realistic ranges for human mandible analysis. The stress tensor values, while high, are plausible for a stress concentration point like the mandibular angle.\n- **Well-Posed:** The problem is well-posed. It provides all necessary information—the stress state and the material properties—to calculate the Drucker-Prager parameters and the subsequent factor of safety. The definition of the factor of safety is unambiguous within the context of this failure criterion.\n- **Objective:** The problem is stated in precise, objective, and technical language, free from subjectivity or opinion.\n- **Completeness and Consistency:** The problem is self-contained. The occlusal force $F_{\\mathrm{occ}}$ is provided as context for the FEA simulation but is not directly used in the calculation, as the resulting stress tensor $\\boldsymbol{\\sigma}$ is given. This does not represent a contradiction but a focus on the post-processing stage of a finite element analysis. All necessary data for the specified task are present.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard engineering-mechanics problem applied to a biomechanical context. A complete, reasoned solution will be provided.\n\nThe problem requires the computation of the factor of safety (FS) at a specific point in the mandible, given the stress state and material properties, using the Drucker–Prager (DP) failure criterion.\n\nThe pressure-sensitive Drucker-Prager failure criterion is defined by the function:\n$$f(I_1, J_2) = \\sqrt{J_2} + \\alpha I_1 - k = 0$$\nwhere $I_1$ is the first invariant of the Cauchy stress tensor $\\boldsymbol{\\sigma}$, and $J_2$ is the second invariant of the deviatoric stress tensor $\\boldsymbol{s}$. The parameters $\\alpha$ and $k$ are material constants related to cohesion and internal friction.\n\nFirst, we calculate the stress invariants for the given stress tensor:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n-300 & 60 & 0 \\\\\n60 & -150 & 40 \\\\\n0 & 40 & -120\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\nThe first invariant of the stress tensor, $I_1$, is the trace of $\\boldsymbol{\\sigma}$:\n$$I_1 = \\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33} = (-300) + (-150) + (-120) = -570 \\, \\mathrm{MPa}$$\nThe deviatoric stress tensor is $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}I_1\\boldsymbol{I}$. The second invariant of the deviatoric stress, $J_2$, can be calculated using the components of $\\boldsymbol{\\sigma}$:\n$$J_2 = \\frac{1}{6} \\left[ (\\sigma_{11} - \\sigma_{22})^2 + (\\sigma_{22} - \\sigma_{33})^2 + (\\sigma_{33} - \\sigma_{11})^2 \\right] + \\sigma_{12}^2 + \\sigma_{23}^2 + \\sigma_{31}^2$$\nSubstituting the components of the given stress tensor:\n$$\n\\begin{aligned}\nJ_2 &= \\frac{1}{6} \\left[ (-300 - (-150))^2 + (-150 - (-120))^2 + (-120 - (-300))^2 \\right] + (60)^2 + (40)^2 + (0)^2 \\\\\n&= \\frac{1}{6} \\left[ (-150)^2 + (-30)^2 + (180)^2 \\right] + 3600 + 1600 \\\\\n&= \\frac{1}{6} \\left[ 22500 + 900 + 32400 \\right] + 5200 \\\\\n&= \\frac{55800}{6} + 5200 \\\\\n&= 9300 + 5200 = 14500 \\, \\mathrm{MPa}^2\n\\end{aligned}\n$$\nFrom this, we find $\\sqrt{J_2}$:\n$$\\sqrt{J_2} = \\sqrt{14500} = \\sqrt{100 \\times 145} = 10\\sqrt{145} \\, \\mathrm{MPa}$$\nNext, we determine the material parameters $\\alpha$ and $k$ by calibrating the DP criterion to the uniaxial tensile strength, $\\sigma_t = 120 \\, \\mathrm{MPa}$, and uniaxial compressive strength, $\\sigma_c = 180 \\, \\mathrm{MPa}$.\n\nFor uniaxial tension, the stress state is $\\sigma_{11} = \\sigma_t$, with all other components being zero. The invariants are $I_1 = \\sigma_t$ and $J_2 = \\frac{1}{3}\\sigma_t^2$. Substituting into the DP equation:\n$$\\sqrt{\\frac{1}{3}\\sigma_t^2} + \\alpha \\sigma_t - k = 0 \\implies \\frac{\\sigma_t}{\\sqrt{3}} + \\alpha \\sigma_t = k \\quad (1)$$\nFor uniaxial compression, the stress state is $\\sigma_{11} = -\\sigma_c$ (where $\\sigma_c$ is a positive value). The invariants are $I_1 = -\\sigma_c$ and $J_2 = \\frac{1}{3}\\sigma_c^2$. Substituting into the DP equation:\n$$\\sqrt{\\frac{1}{3}\\sigma_c^2} + \\alpha (-\\sigma_c) - k = 0 \\implies \\frac{\\sigma_c}{\\sqrt{3}} - \\alpha \\sigma_c = k \\quad (2)$$\nWe now have a system of two linear equations for $\\alpha$ and $k$. Equating $(1)$ and $(2)$:\n$$\\frac{\\sigma_t}{\\sqrt{3}} + \\alpha \\sigma_t = \\frac{\\sigma_c}{\\sqrt{3}} - \\alpha \\sigma_c$$\n$$\\alpha(\\sigma_t + \\sigma_c) = \\frac{\\sigma_c - \\sigma_t}{\\sqrt{3}}$$\n$$\\alpha = \\frac{\\sigma_c - \\sigma_t}{\\sqrt{3}(\\sigma_c + \\sigma_t)}$$\nSubstituting the given values $\\sigma_t = 120 \\, \\mathrm{MPa}$ and $\\sigma_c = 180 \\, \\mathrm{MPa}$:\n$$\\alpha = \\frac{180 - 120}{\\sqrt{3}(180 + 120)} = \\frac{60}{300\\sqrt{3}} = \\frac{1}{5\\sqrt{3}} = \\frac{\\sqrt{3}}{15}$$\nNow, we solve for $k$ using equation $(2)$:\n$$k = \\sigma_c \\left( \\frac{1}{\\sqrt{3}} - \\alpha \\right) = \\sigma_c \\left( \\frac{1}{\\sqrt{3}} - \\frac{\\sigma_c - \\sigma_t}{\\sqrt{3}(\\sigma_c + \\sigma_t)} \\right) = \\frac{\\sigma_c}{\\sqrt{3}} \\left( 1 - \\frac{\\sigma_c - \\sigma_t}{\\sigma_c + \\sigma_t} \\right)$$\n$$k = \\frac{\\sigma_c}{\\sqrt{3}} \\left( \\frac{\\sigma_c + \\sigma_t - (\\sigma_c - \\sigma_t)}{\\sigma_c + \\sigma_t} \\right) = \\frac{\\sigma_c}{\\sqrt{3}} \\left( \\frac{2\\sigma_t}{\\sigma_c + \\sigma_t} \\right) = \\frac{2\\sigma_c\\sigma_t}{\\sqrt{3}(\\sigma_c + \\sigma_t)}$$\nSubstituting the values:\n$$k = \\frac{2(180)(120)}{\\sqrt{3}(180 + 120)} = \\frac{43200}{300\\sqrt{3}} = \\frac{144}{\\sqrt{3}} = \\frac{144\\sqrt{3}}{3} = 48\\sqrt{3} \\, \\mathrm{MPa}$$\nThe problem defines the factor of safety (FS) as the ratio of the failure surface radius ($k$) to the current stress state measure ($\\sqrt{J_2} + \\alpha I_1$).\n$$\\mathrm{FS} = \\frac{k}{\\sqrt{J_2} + \\alpha I_1}$$\nThis definition corresponds to finding a scaling factor $\\eta = \\mathrm{FS}$ such that a scaled stress tensor $\\eta \\boldsymbol{\\sigma}$ lies on the failure surface. For the linear DP model, this leads to $\\eta(\\sqrt{J_2} + \\alpha I_1) = k$.\n\nNow we substitute the calculated values of $I_1$, $\\sqrt{J_2}$, $\\alpha$, and $k$ to find the FS:\n$$\\mathrm{FS} = \\frac{48\\sqrt{3}}{10\\sqrt{145} + (\\frac{\\sqrt{3}}{15})(-570)} = \\frac{48\\sqrt{3}}{10\\sqrt{145} - 38\\sqrt{3}}$$\nTo obtain a numerical value, we use approximations $\\sqrt{3} \\approx 1.73205$ and $\\sqrt{145} \\approx 12.04159$.\n$$\\mathrm{FS} \\approx \\frac{48 \\times 1.73205}{10 \\times 12.04159 - 38 \\times 1.73205} = \\frac{83.1384}{120.4159 - 65.8179} = \\frac{83.1384}{54.5980}$$\n$$\\mathrm{FS} \\approx 1.52273$$\nRounding to three significant figures, the factor of safety is $1.52$.\n\nA factor of safety of $1.52$ indicates that the stress state at the analyzed point is below the failure threshold predicted by the Drucker–Prager criterion. The applied load would need to be approximately $1.52$ times greater to initiate failure at this location under these specific static conditions. Clinically, this suggests a low immediate risk of fracture for a single occlusal event of this magnitude. However, this static analysis does not account for long-term effects such as fatigue from cyclic loading or biological adaptation.",
            "answer": "$$\\boxed{1.52}$$"
        },
        {
            "introduction": "The predictive power of a biomechanical model is critically dependent on the accuracy of its material properties, and biological tissues like bone exhibit complex, direction-dependent (anisotropic) behavior. This advanced hands-on exercise moves beyond using pre-built software and guides you in creating a two-dimensional finite element model from first principles. By implementing and comparing both isotropic and orthotropic constitutive laws for alveolar bone, you will directly quantify how material anisotropy influences predicted orthodontic tooth movement, a key consideration for realistic clinical simulations .",
            "id": "4718370",
            "problem": "Design and implement a two-dimensional linear elastic Finite Element Analysis (FEA) program to quantify how alveolar bone anisotropy influences orthodontic tooth movement in a simplified sagittal slice model. The model consists of a rectangular domain representing a Periodontal Ligament (PDL) layer bonded to a block of alveolar bone. Use plane stress kinematics, small strains, and linear elasticity. The unknown is the displacement field, and the driving load is a uniform horizontal surface traction applied along the tooth-PDL interface. Compare isotropic and orthotropic constitutive laws for the alveolar bone under identical loading, and report the predicted horizontal displacement at a reference point on the tooth-PDL interface.\n\nGeometry and boundary value problem:\n- Domain is the rectangle $\\Omega = [0,W] \\times [0,H]$ with height $H = 20\\,\\mathrm{mm}$ and width $W = t_{\\mathrm{PDL}} + t_{\\mathrm{bone}}$. Use $t_{\\mathrm{PDL}} = 0.32\\,\\mathrm{mm}$ and $t_{\\mathrm{bone}} = 3.00\\,\\mathrm{mm}$, so $W = 3.32\\,\\mathrm{mm}$. The out-of-plane thickness is $T = 1.00\\,\\mathrm{mm}$.\n- The left strip $\\Omega_{\\mathrm{PDL}} = [0,t_{\\mathrm{PDL}}] \\times [0,H]$ is the Periodontal Ligament (PDL). The remaining region $\\Omega_{\\mathrm{bone}} = (t_{\\mathrm{PDL}},W] \\times [0,H]$ is alveolar bone.\n- Boundary conditions:\n  - Essential (Dirichlet): zero displacement on the base, i.e., $\\mathbf{u} = \\mathbf{0}$ on $\\Gamma_{\\mathrm{base}} = \\{(x,y)\\in\\partial\\Omega \\mid y=0\\}$.\n  - Natural (Neumann): uniform horizontal traction $\\bar{t}_x$ on the left boundary $\\Gamma_{\\mathrm{tooth}} = \\{(x,y)\\in\\partial\\Omega \\mid x=0\\}$ and zero vertical traction. Use a total horizontal force $F_{\\mathrm{total}} = 1.00\\,\\mathrm{N}$, so the boundary traction magnitude is $\\bar{t}_x = F_{\\mathrm{total}}/(H\\,T)$ in $\\mathrm{N/mm^2}$ and $\\bar{t}_y = 0$. All other boundaries are traction-free.\n\nGoverning equations and discretization requirements:\n- Start from the strong form of static equilibrium with no body forces, $\\nabla\\cdot\\boldsymbol{\\sigma} = \\mathbf{0}$ in $\\Omega$, and traction boundary conditions $\\boldsymbol{\\sigma}\\mathbf{n} = \\bar{\\mathbf{t}}$ on $\\Gamma_t$, with $\\mathbf{u}=\\bar{\\mathbf{u}}$ on $\\Gamma_u$.\n- Use the Principle of Virtual Work: find $\\mathbf{u}$ such that for all admissible virtual displacements $\\delta\\mathbf{u}$,\n  $$\\int_{\\Omega} \\delta\\boldsymbol{\\varepsilon}^T \\boldsymbol{\\sigma}\\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\delta\\mathbf{u}^T \\bar{\\mathbf{t}}\\, \\mathrm{d}\\Gamma,$$\n  where $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\,\\mathbf{u}_e$ is the small-strain tensor and $\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}$ is the linear elastic constitutive law. Assemble the global system $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$ from element contributions $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B}\\, \\mathrm{d}\\Omega$ and traction contributions on boundary edges.\n- Mesh and elements: triangulate $\\Omega$ using a structured grid of $N_x \\times N_y$ rectangular cells, each split into two Constant Strain Triangle (CST) elements (linear shape functions). Use $N_x = 20$ and $N_y = 20$ so that node coordinates are $(x_i,y_j)$ with $x_i = i\\,(W/N_x)$ and $y_j = j\\,(H/N_y)$ for integers $i\\in[0,N_x]$, $j\\in[0,N_y]$. Use consistent counterclockwise node ordering to ensure positive element areas.\n- Constitutive laws (plane stress):\n  - Isotropic material (for PDL and, in some tests, for bone): with Young’s modulus $E$ and Poisson’s ratio $\\nu$, the constitutive matrix is\n    $$\\mathbf{D}_{\\mathrm{iso}} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix}.$$\n  - Orthotropic material (for bone in some tests), aligned with the $(x,y)$ axes, with moduli $E_x$, $E_y$, shear modulus $G_{xy}$, and major Poisson ratio $\\nu_{xy}$, and satisfying reciprocity $\\nu_{xy}/E_x = \\nu_{yx}/E_y$. Define the compliance matrix\n    $$\\mathbf{S} = \\begin{bmatrix} \\frac{1}{E_x} & -\\frac{\\nu_{xy}}{E_x} & 0 \\\\ -\\frac{\\nu_{yx}}{E_y} & \\frac{1}{E_y} & 0 \\\\ 0 & 0 & \\frac{1}{G_{xy}} \\end{bmatrix}, \\quad \\text{with } \\nu_{yx}=\\nu_{xy}\\,\\frac{E_y}{E_x},$$\n    and set $\\mathbf{D}_{\\mathrm{ortho}} = \\mathbf{S}^{-1}$.\n- Material assignment: for each element, compute its centroid $(x_c,y_c)$. If $x_c \\le t_{\\mathrm{PDL}}$, assign PDL properties; else assign bone properties according to the test case.\n\nTarget quantity:\n- Let the reference node be the mesh node on $\\Gamma_{\\mathrm{tooth}}$ whose $y$-coordinate is closest to $H/2$. Compute its horizontal displacement $u_x$ in $\\mathrm{mm}$ and report it in micrometers by multiplying by $10^3$.\n\nNumerical inputs and units:\n- Use $\\mathrm{mm}$ for lengths, $\\mathrm{N}$ for forces, and $\\mathrm{N/mm^2}$ (megapascal scale) for stresses and elastic moduli. Express the program’s final outputs in micrometers (i.e., $\\mathrm{\\mu m}$), as real-valued floats.\n\nTest suite:\nImplement four test cases with identical geometry, mesh, boundary conditions, and PDL properties, differing only in alveolar bone properties. For all tests, use PDL properties $E_{\\mathrm{PDL}} = 0.70\\,\\mathrm{MPa}$ and $\\nu_{\\mathrm{PDL}} = 0.45$, total horizontal force $F_{\\mathrm{total}} = 1.00\\,\\mathrm{N}$, so that $\\bar{t}_x = F_{\\mathrm{total}}/(H\\,T) = 1.00/(20.00\\cdot 1.00) = 0.05\\,\\mathrm{N/mm^2}$, and $\\bar{t}_y=0$.\n- Test $\\mathbf{1}$ (isotropic bone): $E_{\\mathrm{bone}} = 2000.00\\,\\mathrm{MPa}$, $\\nu_{\\mathrm{bone}} = 0.30$.\n- Test $\\mathbf{2}$ (orthotropic bone): $E_x = 3000.00\\,\\mathrm{MPa}$, $E_y = 1500.00\\,\\mathrm{MPa}$, $G_{xy} = 800.00\\,\\mathrm{MPa}$, $\\nu_{xy} = 0.25$.\n- Test $\\mathbf{3}$ (orthotropic bone mimicking isotropy): $E_x = 2000.00\\,\\mathrm{MPa}$, $E_y = 2000.00\\,\\mathrm{MPa}$, $\\nu_{xy} = 0.30$, $G_{xy} = \\dfrac{E_x}{2(1+\\nu_{xy})} = \\dfrac{2000.00}{2(1+0.30)}\\,\\mathrm{MPa}$.\n- Test $\\mathbf{4}$ (very stiff isotropic bone): $E_{\\mathrm{bone}} = 20000.00\\,\\mathrm{MPa}$, $\\nu_{\\mathrm{bone}} = 0.30$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Tests $\\mathbf{1}$ to $\\mathbf{4}$, where each entry is the horizontal displacement at the reference node in micrometers (i.e., $10^3$ times the displacement in $\\mathrm{mm}$). For example, the output format must be exactly like $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$.",
            "solution": "The user has requested the design and implementation of a two-dimensional linear elastic Finite Element Analysis (FEA) program to model orthodontic tooth movement. The problem is well-defined and grounded in the principles of continuum mechanics and numerical methods. I will proceed with a full solution.\n\n### **1. Problem Formulation**\n\nThe problem is governed by the principles of static equilibrium for a linear elastic solid under plane stress conditions. The governing partial differential equation is $\\nabla\\cdot\\boldsymbol{\\sigma} = \\mathbf{0}$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor. This strong form is converted into a weak form using the Principle of Virtual Work, which states that for any kinematically admissible virtual displacement field $\\delta\\mathbf{u}$, the virtual work done by internal stresses equals the virtual work done by external loads:\n$$\n\\int_{\\Omega} \\delta\\boldsymbol{\\varepsilon} : \\boldsymbol{\\sigma} \\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\delta\\mathbf{u} \\cdot \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma\n$$\nHere, $\\boldsymbol{\\varepsilon}$ is the infinitesimal strain tensor, $\\bar{\\mathbf{t}}$ is the applied traction vector on the boundary $\\Gamma_t$, and $\\Omega$ is the domain. In Voigt notation, this becomes:\n$$\n\\int_{\\Omega} \\delta\\boldsymbol{\\varepsilon}^T \\boldsymbol{\\sigma} \\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\delta\\mathbf{u}^T \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma\n$$\nThe problem is discretized using the Finite Element Method. The domain $\\Omega$ is partitioned into a mesh of simple triangular elements. Within each element $\\Omega_e$, the displacement field $\\mathbf{u}$ is approximated by interpolating nodal displacements $\\mathbf{u}_e$ using shape functions $\\mathbf{N}$: $\\mathbf{u}(x,y) = \\mathbf{N}(x,y) \\mathbf{u}_e$. The strain-displacement relationship for small strains is $\\boldsymbol{\\varepsilon} = \\mathbf{L} \\mathbf{u}$, where $\\mathbf{L}$ is a differential operator matrix. This leads to $\\boldsymbol{\\varepsilon} = (\\mathbf{L}\\mathbf{N}) \\mathbf{u}_e = \\mathbf{B} \\mathbf{u}_e$, where $\\mathbf{B}$ is the strain-displacement matrix. The constitutive relationship is given by linear elasticity, $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$, where $\\mathbf{D}$ is the material stiffness matrix.\n\nSubstituting these FE approximations into the weak form and noting that the equation must hold for any virtual displacement (i.e., for any $\\delta\\mathbf{u}_e$), we arrive at the standard system of linear equations for each element: $\\mathbf{K}_e \\mathbf{u}_e = \\mathbf{F}_e$, where:\n-   $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, \\mathrm{d}\\Omega$ is the element stiffness matrix.\n-   $\\mathbf{F}_e = \\int_{\\Gamma_e \\cap \\Gamma_t} \\mathbf{N}^T \\bar{\\mathbf{t}} \\, \\mathrm{d}\\Gamma$ is the element force vector from surface tractions.\n\nBy assembling the contributions from all elements, we obtain the global system of linear equations $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$, where $\\mathbf{U}$ is the global vector of unknown nodal displacements.\n\n### **2. Discretization and Element Formulation**\n\nThe specified domain $\\Omega = [0, W] \\times [0, H]$ is discretized using a structured grid of $N_x \\times N_y$ rectangular cells. Each cell is subdivided into two Constant Strain Triangle (CST) elements. CST elements use linear shape functions, resulting in a constant strain (and stress) field within each element.\n\nFor a CST element with nodes $(i, j, k)$ in counter-clockwise order with coordinates $(x_i, y_i), (x_j, y_j), (x_k, y_k)$, the strain-displacement matrix $\\mathbf{B}$ is constant and given by:\n$$\n\\mathbf{B} = \\frac{1}{2A}\n\\begin{bmatrix}\ny_{jk} & 0 & y_{ki} & 0 & y_{ij} & 0 \\\\\n0 & x_{kj} & 0 & x_{ik} & 0 & x_{ji} \\\\\nx_{kj} & y_{jk} & x_{ik} & y_{ki} & x_{ji} & y_{ij}\n\\end{bmatrix}\n$$\nwhere $y_{jk} = y_j - y_k$, $x_{kj} = x_k - x_j$, etc., and $A$ is the area of the triangle. The element stiffness matrix is then calculated as $\\mathbf{K}_e = \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\cdot A \\cdot T$, where $T$ is the out-of-plane thickness.\n\n### **3. Material Models (Constitutive Matrices)**\n\nThe material properties are assigned based on the element's centroid.\n-   **Isotropic Material (Plane Stress):** For Young's modulus $E$ and Poisson's ratio $\\nu$, the stiffness matrix $\\mathbf{D}_{\\mathrm{iso}}$ is:\n    $$ \\mathbf{D}_{\\mathrm{iso}} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix} $$\n-   **Orthotropic Material (Plane Stress):** For principal moduli $E_x, E_y$, shear modulus $G_{xy}$, and Poisson's ratio $\\nu_{xy}$ (with $\\nu_{yx} = \\nu_{xy} E_y/E_x$), the stiffness matrix $\\mathbf{D}_{\\mathrm{ortho}}$ is the inverse of the compliance matrix $\\mathbf{S}$:\n    $$ \\mathbf{D}_{\\mathrm{ortho}} = \\left( \\begin{bmatrix} 1/E_x & -\\nu_{xy}/E_x & 0 \\\\ -\\nu_{xy}/E_x & 1/E_y & 0 \\\\ 0 & 0 & 1/G_{xy} \\end{bmatrix} \\right)^{-1} = \\frac{1}{1-\\nu_{xy}\\nu_{yx}} \\begin{bmatrix} E_x & \\nu_{yx}E_x & 0 \\\\ \\nu_{xy}E_y & E_y & 0 \\\\ 0 & 0 & G_{xy}(1-\\nu_{xy}\\nu_{yx}) \\end{bmatrix} $$\n    Since $\\nu_{yx}E_x = \\nu_{xy}E_y$, the matrix is symmetric. The shear term simplifies because the off-diagonal terms of the compliance matrix are zero. Thus, the $(3,3)$ entry of $\\mathbf{D}$ is simply $G_{xy}$.\n\n### **4. Boundary Conditions**\n\n-   **Neumann (Force) Boundary Condition:** A uniform horizontal traction $\\bar{t}_x = F_{\\mathrm{total}}/(H T) = 1.00/(20.0 \\cdot 1.0) = 0.05 \\, \\mathrm{N/mm^2}$ is applied to the left boundary $\\Gamma_{\\mathrm{tooth}}$. For a linear element edge of length $L$ on this boundary, the consistent nodal forces are calculated. The total force on the edge, $L \\cdot T \\cdot \\bar{t}_x$, is distributed equally to its two nodes.\n-   **Dirichlet (Displacement) Boundary Condition:** The base of the model is fixed, $\\mathbf{u}=\\mathbf{0}$ on $\\Gamma_{\\mathrm{base}}$. This is enforced by modifying the global system $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$. For each degree of freedom (DOF) $d$ corresponding to a fixed displacement, the $d$-th row and column of $\\mathbf{K}$ are zeroed out, $K_{dd}$ is set to $1$, and the corresponding force entry $F_d$ is set to $0$.\n\n### **5. Solution and Implementation Strategy**\n\nThe core of the implementation involves the following steps, which are executed for each of the four test cases:\n1.  **Mesh Generation:** Create the node coordinates and element connectivity for the $N_x \\times N_y$ structured grid.\n2.  **Assembly:** Initialize a global stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{F}$ with zeros. Iterate through each element:\n    a. Determine the element's material properties (PDL or bone) based on its centroid.\n    b. Construct the appropriate material stiffness matrix $\\mathbf{D}$.\n    c. Calculate the element's strain-displacement matrix $\\mathbf{B}$ and its stiffness matrix $\\mathbf{K}_e$.\n    d. Add $\\mathbf{K}_e$ to the global matrix $\\mathbf{K}$ at the correct positions determined by the element's node-to-DOF mapping.\n3.  **Load Application:** Iterate through the element edges on the left boundary and add the corresponding consistent nodal forces to the global force vector $\\mathbf{F}$.\n4.  **Constraint Application:** Apply the Dirichlet boundary conditions by modifying $\\mathbf{K}$ and $\\mathbf{F}$.\n5.  **Solve:** Solve the linear system $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$ for the global displacement vector $\\mathbf{U}$ using a standard linear solver.\n6.  **Result Extraction:** Identify the reference node (at $x=0$, $y \\approx H/2$) and extract its horizontal displacement from $\\mathbf{U}$. The result is converted from millimeters to micrometers.\n\nThis process is repeated for all four test cases, which differ only in the material properties assigned to the bone region. The final results are collected and formatted as specified. Test Case 3 serves as a verification, as its orthotropic properties are specifically chosen to mimic the isotropic properties of Test Case 1, and should thus yield a nearly identical result.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and runs a 2D linear elastic FEA to analyze orthodontic tooth movement.\n    \"\"\"\n    \n    # Global parameters defined in the problem statement\n    H = 20.0  # mm, domain height\n    t_PDL = 0.32  # mm, PDL thickness\n    t_bone = 3.00  # mm, bone thickness\n    W = t_PDL + t_bone  # mm, domain width\n    T = 1.00  # mm, out-of-plane thickness\n    Nx = 20  # number of cells in x-direction\n    Ny = 20  # number of cells in y-direction\n    \n    # PDL material properties, constant for all tests\n    E_PDL = 0.70  # MPa\n    nu_PDL = 0.45\n    \n    # Applied load parameters, constant for all tests\n    F_total = 1.00  # N, total horizontal force\n    t_x = F_total / (H * T)  # N/mm^2 (MPa), uniform horizontal traction\n\n    # Definition of the four test cases\n    test_cases = [\n        # Test 1: Isotropic bone\n        {'type': 'iso', 'params': {'E': 2000.00, 'nu': 0.30}},\n        # Test 2: Orthotropic bone\n        {'type': 'ortho', 'params': {'Ex': 3000.00, 'Ey': 1500.00, 'Gxy': 800.00, 'nu_xy': 0.25}},\n        # Test 3: Orthotropic bone mimicking isotropy\n        {'type': 'ortho', 'params': {'Ex': 2000.00, 'Ey': 2000.00, 'nu_xy': 0.30, 'Gxy': 2000.00 / (2 * (1 + 0.30))}},\n        # Test 4: Very stiff isotropic bone\n        {'type': 'iso', 'params': {'E': 20000.00, 'nu': 0.30}},\n    ]\n\n    def get_D_iso(E, nu):\n        \"\"\"Computes the isotropic plane stress constitutive matrix.\"\"\"\n        factor = E / (1 - nu**2)\n        return factor * np.array([\n            [1, nu, 0],\n            [nu, 1, 0],\n            [0, 0, (1 - nu) / 2]\n        ])\n\n    def get_D_ortho(Ex, Ey, Gxy, nu_xy):\n        \"\"\"Computes the orthotropic plane stress constitutive matrix.\"\"\"\n        nu_yx = nu_xy * Ey / Ex\n        den = 1 - nu_xy * nu_yx\n        D11 = Ex / den\n        D22 = Ey / den\n        D12 = nu_yx * Ex / den  # which is also nu_xy * Ey / den\n        D33 = Gxy\n        return np.array([\n            [D11, D12, 0],\n            [D12, D22, 0],\n            [0,   0,   D33]\n        ])\n\n    def run_fea_for_case(bone_props):\n        \"\"\"Performs a full FEA for a given set of bone material properties.\"\"\"\n        \n        # 1. Mesh Generation\n        dx, dy = W / Nx, H / Ny\n        n_nodes = (Nx + 1) * (Ny + 1)\n        nodes = np.array([[i * dx, j * dy] for i in range(Nx + 1) for j in range(Ny + 1)])\n        \n        elements = []\n        for i in range(Nx):\n            for j in range(Ny):\n                n1 = i * (Ny + 1) + j        # Bottom-left\n                n2 = (i + 1) * (Ny + 1) + j  # Bottom-right\n                n3 = (i + 1) * (Ny + 1) + (j + 1) # Top-right\n                n4 = i * (Ny + 1) + (j + 1)      # Top-left\n                elements.append([n1, n2, n3]) # First triangle\n                elements.append([n1, n3, n4]) # Second triangle\n        elements = np.array(elements, dtype=int)\n        \n        n_elements = len(elements)\n        \n        # 2. FEA Assembly\n        n_dofs = 2 * n_nodes\n        K = np.zeros((n_dofs, n_dofs))\n        F = np.zeros(n_dofs)\n\n        D_pdl = get_D_iso(E_PDL, nu_PDL)\n        if bone_props['type'] == 'iso':\n            D_bone = get_D_iso(**bone_props['params'])\n        else: # 'ortho'\n            D_bone = get_D_ortho(**bone_props['params'])\n\n        for i in range(n_elements):\n            node_indices = elements[i]\n            x_coords = nodes[node_indices, 0]\n            y_coords = nodes[node_indices, 1]\n\n            xc = np.mean(x_coords)\n            D = D_pdl if xc <= t_PDL else D_bone\n\n            A_times_2 = x_coords[0] * (y_coords[1] - y_coords[2]) + \\\n                        x_coords[1] * (y_coords[2] - y_coords[0]) + \\\n                        x_coords[2] * (y_coords[0] - y_coords[1])\n            Area = A_times_2 / 2.0\n            \n            y23, y31, y12 = y_coords[1] - y_coords[2], y_coords[2] - y_coords[0], y_coords[0] - y_coords[1]\n            x32, x13, x21 = x_coords[2] - x_coords[1], x_coords[0] - x_coords[2], x_coords[1] - x_coords[0]\n            B = (1 / A_times_2) * np.array([\n                [y23, 0,   y31, 0,   y12, 0  ],\n                [0,   x32, 0,   x13, 0,   x21],\n                [x32, y23, x13, y31, x21, y12]\n            ])\n            \n            Ke = B.T @ D @ B * Area * T\n            \n            dof_map = np.kron(node_indices, [2, 2]) + np.kron(np.ones_like(node_indices), [0, 1])\n            K[np.ix_(dof_map, dof_map)] += Ke\n\n        # 3. Apply Boundary Conditions\n        # Neumann (Traction) on left face (x=0)\n        force_per_node_on_edge = (dy * T * t_x) / 2.0\n        for j in range(Ny):\n            node1_idx, node2_idx = j, j + 1\n            F[2 * node1_idx] += force_per_node_on_edge\n            F[2 * node2_idx] += force_per_node_on_edge\n\n        # Dirichlet (Displacement) on bottom face (y=0)\n        fixed_dofs = [2 * (i * (Ny + 1)) for i in range(Nx + 1)] + \\\n                     [2 * (i * (Ny + 1)) + 1 for i in range(Nx + 1)]\n        \n        for dof in fixed_dofs:\n            K[dof, :] = 0\n            K[:, dof] = 0\n            K[dof, dof] = 1.0\n            F[dof] = 0.0\n\n        # 4. Solve System\n        U = np.linalg.solve(K, F)\n        \n        # 5. Extract Result\n        # Reference node: x=0, y=H/2. i=0, j=Ny/2=10.\n        ref_node_idx = 0 * (Ny + 1) + 10\n        ref_dof_idx = 2 * ref_node_idx # x-displacement\n        \n        disp_mm = U[ref_dof_idx]\n        return disp_mm * 1000.0 # Convert to micrometers\n\n    # Main execution loop\n    results = [run_fea_for_case(case) for case in test_cases]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}