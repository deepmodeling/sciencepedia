{
    "hands_on_practices": [
        {
            "introduction": "Effective T-cell activation, a critical step in allograft rejection, requires both T-cell receptor engagement and costimulatory signals like those from the CD28 pathway. This exercise explores the quantitative impact of therapeutic costimulation blockade on downstream cytokine production. By applying the Hill function, a common model for cooperative biological processes, you will derive how a specific reduction in signaling strength translates into a non-linear change in Interleukin-2 (IL-2) levels, providing insight into the dose-response dynamics of immunosuppressive agents. ",
            "id": "5197228",
            "problem": "A transplant recipient undergoing systemic surgery receives a costimulation-blocking regimen that reduces the CD28 signaling axis of donor-reactive T cells. Interleukin-2 (IL-2) is a central cytokine required for clonal expansion and effector differentiation implicated in graft rejection, and its production depends on integrated T cell receptor (TCR) and CD28 costimulation. Empirically, many transcriptionally integrated immune outputs follow sigmoidal saturation laws consistent with cooperative control, where the effective downstream signal amplitude, denoted by $S$, drives IL-2 production according to a Hill-type relationship with coefficient $n=2$: \n$$\\text{IL2} \\propto \\frac{S^{2}}{K^{2}+S^{2}},$$\nwhere $K>0$ is the half-saturation constant reflecting the signal level at which the output reaches half of its plateau. Assume that the effective signal amplitude $S$ is directly proportional to CD28 signal strength so that a fractional change in CD28 produces the same fractional change in $S$. \n\nA regimen reduces CD28 costimulation by $70\\%$ from its baseline value. Let the baseline effective signal amplitude be $S_{0}$ prior to treatment, and let the new value after treatment be $S_{1}$. Using only the assumptions stated above and standard properties of proportional relationships and Hill-type functions, derive the fold-change in IL-2 production, defined as the ratio $\\text{IL2}_{\\text{after}}/\\text{IL2}_{\\text{before}}$, as a closed-form analytic expression in terms of $S_{0}$ and $K$. Express your final answer as a simplified analytic expression. No numerical approximation or rounding is required, and no units are needed because the fold-change is dimensionless.",
            "solution": "The problem is first validated to ensure it is self-contained, scientifically grounded, and well-posed.\n\n**Step 1: Extracted Givens**\n- The relationship between Interleukin-2 (IL-2) production and the effective downstream signal amplitude, $S$, is a Hill-type function: $\\text{IL2} \\propto \\frac{S^{2}}{K^{2}+S^{2}}$.\n- The Hill coefficient is given as $n=2$.\n- The half-saturation constant is $K > 0$.\n- The effective signal amplitude $S$ is directly proportional to the CD28 signal strength.\n- A treatment regimen reduces CD28 costimulation by $70\\%$.\n- $S_{0}$ is the baseline effective signal amplitude before treatment.\n- $S_{1}$ is the new effective signal amplitude after treatment.\n- The quantity to be derived is the fold-change in IL-2 production: $\\frac{\\text{IL2}_{\\text{after}}}{\\text{IL2}_{\\text{before}}}$.\n- The final answer must be a closed-form analytic expression in terms of $S_{0}$ and $K$.\n\n**Step 2: Validation Using Extracted Givens**\nThe problem is scientifically grounded, modeling T-cell activation with a standard Hill function, a common practice in systems biology. The parameters and relationships are well-defined. The question is objective, quantitative, and self-contained, providing all necessary information to derive a unique solution. The model is a simplification but does not violate fundamental principles. Therefore, the problem is deemed valid.\n\n**Step 3: Derivation of the Solution**\nBased on the provided proportional relationship, we can express the IL-2 production rate as a function of the signal amplitude $S$:\n$$ \\text{IL2}(S) = c \\frac{S^{2}}{K^{2} + S^{2}} $$\nwhere $c$ is a constant of proportionality.\n\nPrior to treatment, the signal amplitude is $S_{0}$. The baseline IL-2 production, $\\text{IL2}_{\\text{before}}$, is:\n$$ \\text{IL2}_{\\text{before}} = \\text{IL2}(S_{0}) = c \\frac{S_{0}^{2}}{K^{2} + S_{0}^{2}} $$\nThe problem states that the treatment regimen reduces CD28 costimulation by $70\\%$. This means the remaining CD28 signal is $100\\% - 70\\% = 30\\%$ of its baseline value.\nThe new CD28 signal strength is $(1 - 0.70)$ times the baseline signal, or $0.30$ times the baseline.\n\nIt is given that the effective signal amplitude $S$ is directly proportional to the CD28 signal strength. This implies that a fractional change in the CD28 signal strength results in the same fractional change in $S$. Therefore, the new signal amplitude after treatment, $S_{1}$, is $30\\%$ of the baseline signal amplitude $S_{0}$:\n$$ S_{1} = (1 - 0.70) S_{0} = 0.30 S_{0} = \\frac{3}{10} S_{0} $$\nThe IL-2 production after treatment, $\\text{IL2}_{\\text{after}}$, is calculated using the new signal amplitude $S_{1}$:\n$$ \\text{IL2}_{\\text{after}} = \\text{IL2}(S_{1}) = c \\frac{S_{1}^{2}}{K^{2} + S_{1}^{2}} $$\nSubstituting $S_{1} = \\frac{3}{10} S_{0}$ into this expression yields:\n$$ \\text{IL2}_{\\text{after}} = c \\frac{\\left(\\frac{3}{10} S_{0}\\right)^{2}}{K^{2} + \\left(\\frac{3}{10} S_{0}\\right)^{2}} = c \\frac{\\frac{9}{100} S_{0}^{2}}{K^{2} + \\frac{9}{100} S_{0}^{2}} $$\nThe fold-change in IL-2 production is the ratio of the production rate after treatment to the rate before treatment:\n$$ \\text{Fold-change} = \\frac{\\text{IL2}_{\\text{after}}}{\\text{IL2}_{\\text{before}}} = \\frac{c \\frac{\\frac{9}{100} S_{0}^{2}}{K^{2} + \\frac{9}{100} S_{0}^{2}}}{c \\frac{S_{0}^{2}}{K^{2} + S_{0}^{2}}} $$\nThe proportionality constant $c$ cancels out. Assuming a non-zero baseline signal ($S_{0} > 0$), the term $S_{0}^{2}$ also cancels from the numerator of both the main numerator and main denominator:\n$$ \\text{Fold-change} = \\frac{\\frac{\\frac{9}{100}}{K^{2} + \\frac{9}{100} S_{0}^{2}}}{\\frac{1}{K^{2} + S_{0}^{2}}} $$\nRearranging this complex fraction, we get:\n$$ \\text{Fold-change} = \\frac{9}{100} \\cdot \\frac{K^{2} + S_{0}^{2}}{K^{2} + \\frac{9}{100} S_{0}^{2}} $$\nTo obtain a simplified expression without fractions in the denominator, we can multiply the numerator and denominator of the main expression by $100$:\n$$ \\text{Fold-change} = \\frac{9 \\left(K^{2} + S_{0}^{2}\\right)}{100 \\left(K^{2} + \\frac{9}{100} S_{0}^{2}\\right)} = \\frac{9(K^{2} + S_{0}^{2})}{100K^{2} + 9S_{0}^{2}} $$\nThis is the final, simplified, closed-form analytic expression for the fold-change in IL-2 production in terms of the baseline signal $S_{0}$ and the half-saturation constant $K$.",
            "answer": "$$\n\\boxed{\\frac{9(K^{2} + S_{0}^{2})}{100K^{2} + 9S_{0}^{2}}}\n$$"
        },
        {
            "introduction": "Predicting which patients are most likely to develop de novo donor-specific antibodies (DSA) is a central goal in modern transplant management, allowing for personalized surveillance and therapy. This practice moves from cellular mechanisms to population-level risk by guiding you through the construction of a predictive model from first principles. You will learn to integrate distinct risk factors, such as the immunogenic Human Leukocyte Antigen (HLA) eplet load and recipient age, using an odds-ratio-based framework to calculate a patient's personalized one-year risk of DSA formation. ",
            "id": "5197265",
            "problem": "A surgical transplant program seeks to prospectively estimate the one-year probability of developing de novo donor-specific antibody (DSA) after kidney transplantation by integrating the immunogenic eplet load and its distribution across Human Leukocyte Antigen (HLA) classes along with recipient age. Use only the following foundational facts and definitions to derive a risk score and compute the probability for one specific recipient:\n\n1. The one-year incidence in a defined reference stratum with zero mismatched eplets and a reference age is given by a baseline probability $p_{0}$; the corresponding baseline odds are $\\dfrac{p_{0}}{1-p_{0}}$.\n2. When independent risk factors act multiplicatively on odds, the post-exposure odds equal the baseline odds multiplied by the product of the odds ratios (for each exposure).\n3. The odds ratio per unit exposure $u$ is the change in odds when $u$ increases by $1$; if an exposure increases by an integer $n$, the multiplicative effect on odds is the odds ratio raised to the power $n$.\n4. The relationship between probability $p$ and odds $o$ is $o=\\dfrac{p}{1-p}$ and its inverse $p=\\dfrac{o}{1+o}$. Equivalently, if the log-odds (logit) is $\\ell=\\ln\\!\\left(\\dfrac{p}{1-p}\\right)$, then $p=\\dfrac{1}{1+\\exp(-\\ell)}$.\n\nAssume the following scientifically plausible, well-tested inputs derived from observational transplant immunology:\n- Baseline one-year probability for the reference stratum (zero eplet mismatches) at reference age $a_{\\mathrm{ref}}=40$ years is $p_{0}=0.10$.\n- Per-eplet odds ratios differ by HLA class: for HLA class I eplets (A, B, C loci), $\\mathrm{OR}_{\\mathrm{I}}=1.02$ per eplet; for HLA class II eplets (DR, DQ, DP loci), $\\mathrm{OR}_{\\mathrm{II}}=1.07$ per eplet.\n- Recipient age modifies risk multiplicatively on the odds scale by a per-year odds ratio $\\mathrm{OR}_{\\mathrm{age}}=0.97$ for each year older than $a_{\\mathrm{ref}}$.\n- For a given recipient, the immunogenic eplet load is summarized by a total load $L$ and a class II fraction $f_{\\mathrm{II}}$, so that the class II eplet load is $N_{\\mathrm{II}}=f_{\\mathrm{II}}\\,L$ and the class I eplet load is $N_{\\mathrm{I}}=(1-f_{\\mathrm{II}})\\,L$.\n\nTask:\n(a) Starting from items $1$–$4$, symbolically derive a single closed-form expression for the predicted one-year probability $p$ as a function of $p_{0}$, $\\mathrm{OR}_{\\mathrm{I}}$, $\\mathrm{OR}_{\\mathrm{II}}$, $\\mathrm{OR}_{\\mathrm{age}}$, $L$, $f_{\\mathrm{II}}$, and the recipient age $a$ with reference age $a_{\\mathrm{ref}}$.\n(b) Using your derived expression, compute the predicted one-year probability for a recipient with $a=52$ years, $L=30$, and $f_{\\mathrm{II}}=0.60$. Express the final probability as a unitless decimal and round your answer to four significant figures.",
            "solution": "The user has provided a problem that requires the derivation of a risk score for transplant immunology and its application to a specific case.\n\n### Problem Validation\n\nFirst, I will validate the problem statement according to the specified criteria.\n\n**Step 1: Extract Givens**\n- Baseline probability in a reference stratum: $p_{0}$.\n- Baseline odds: $\\frac{p_{0}}{1-p_{0}}$.\n- Risk model: Post-exposure odds equal baseline odds multiplied by the product of odds ratios for independent risk factors.\n- Odds ratio exponentiation: For an exposure increase of $n$, the odds are multiplied by $\\mathrm{OR}^{n}$.\n- Probability-odds relation: $o=\\dfrac{p}{1-p}$, which implies $p=\\dfrac{o}{1+o}$.\n- Baseline probability value: $p_{0}=0.10$.\n- Reference age: $a_{\\mathrm{ref}}=40$ years.\n- Odds Ratio for Class I eplets: $\\mathrm{OR}_{\\mathrm{I}}=1.02$ per eplet.\n- Odds Ratio for Class II eplets: $\\mathrm{OR}_{\\mathrm{II}}=1.07$ per eplet.\n- Odds Ratio for age: $\\mathrm{OR}_{\\mathrm{age}}=0.97$ per year older than $a_{\\mathrm{ref}}$.\n- Eplet load variables: total load $L$, class II fraction $f_{\\mathrm{II}}$.\n- Class II eplet count: $N_{\\mathrm{II}}=f_{\\mathrm{II}}\\,L$.\n- Class I eplet count: $N_{\\mathrm{I}}=(1-f_{\\mathrm{II}})\\,L$.\n- Task (a): Derive a closed-form expression for probability $p$ as a function of $p_{0}$, $\\mathrm{OR}_{\\mathrm{I}}$, $\\mathrm{OR}_{\\mathrm{II}}$, $\\mathrm{OR}_{\\mathrm{age}}$, $L$, $f_{\\mathrm{II}}$, $a$, and $a_{\\mathrm{ref}}$.\n- Task (b): Compute $p$ for a recipient with $a=52$ years, $L=30$, and $f_{\\mathrm{II}}=0.60$. The final answer must be a decimal rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the logistic regression model, a fundamental and widely used tool in biostatistics and epidemiology for risk prediction. The specific risk factors—HLA eplet mismatches and recipient age—are well-established determinants of post-transplant outcomes in immunology. The stated values for odds ratios are realistic. The model is scientifically sound.\n- **Well-Posed:** The problem is clearly defined, with all necessary data and relationships provided to derive a unique mathematical expression and compute a single numerical answer.\n- **Objective:** The problem is stated in precise, quantitative terms, free from any subjective or ambiguous language.\n- **Completeness and Consistency:** The problem is self-contained. The definitions are consistent; for instance, the sum of Class I and Class II eplet counts, $N_{\\mathrm{I}} + N_{\\mathrm{II}} = (1-f_{\\mathrm{II}})L + f_{\\mathrm{II}}L = L$, correctly equals the total eplet load.\n- **Realism and Feasibility:** The scenario and data are plausible within the context of clinical transplant medicine.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, complete, and consistent. I will proceed with a full solution.\n\n### Solution\n\nThe solution is divided into two parts as requested: (a) the symbolic derivation of the probability formula and (b) the numerical calculation for a specific case.\n\n**(a) Derivation of the Probability Expression**\n\nThe problem states that the total odds of the event ($o$) are the product of the baseline odds ($o_0$) and the odds ratios associated with each risk factor. The reference stratum is defined by zero eplet mismatches and recipient age equal to the reference age, $a_{\\mathrm{ref}}$.\n\n1.  The baseline odds, $o_0$, are derived from the baseline probability, $p_0$:\n    $$o_0 = \\frac{p_0}{1-p_0}$$\n\n2.  The risk factors are the number of Class I eplets ($N_{\\mathrm{I}}$), the number of Class II eplets ($N_{\\mathrm{II}}$), and the deviation of the recipient's age ($a$) from the reference age ($a_{\\mathrm{ref}}$). The total odds, $o$, are calculated by multiplying the baseline odds by the odds ratio contributions from each factor.\n\n    -   The contribution from Class I eplets is $(\\mathrm{OR}_{\\mathrm{I}})^{N_{\\mathrm{I}}}$.\n    -   The contribution from Class II eplets is $(\\mathrm{OR}_{\\mathrm{II}})^{N_{\\mathrm{II}}}$.\n    -   The contribution from age is $(\\mathrm{OR}_{\\mathrm{age}})^{a - a_{\\mathrm{ref}}}$.\n\n    Combining these multiplicatively gives the total odds:\n    $$o = o_0 \\times (\\mathrm{OR}_{\\mathrm{I}})^{N_{\\mathrm{I}}} \\times (\\mathrm{OR}_{\\mathrm{II}})^{N_{\\mathrm{II}}} \\times (\\mathrm{OR}_{\\mathrm{age}})^{a - a_{\\mathrm{ref}}}$$\n\n3.  We substitute the given expressions for $o_0$, $N_{\\mathrm{I}}$, and $N_{\\mathrm{II}}$:\n    -   $o_0 = \\frac{p_0}{1-p_0}$\n    -   $N_{\\mathrm{I}} = (1-f_{\\mathrm{II}})L$\n    -   $N_{\\mathrm{II}} = f_{\\mathrm{II}}L$\n\n    The expression for the total odds $o$ becomes:\n    $$o = \\left(\\frac{p_0}{1-p_0}\\right) (\\mathrm{OR}_{\\mathrm{I}})^{(1-f_{\\mathrm{II}})L} (\\mathrm{OR}_{\\mathrm{II}})^{f_{\\mathrm{II}}L} (\\mathrm{OR}_{\\mathrm{age}})^{a - a_{\\mathrm{ref}}}$$\n\n4.  Finally, we convert the total odds $o$ back into a probability $p$ using the given relationship $p = \\frac{o}{1+o}$. Substituting the expression for $o$ yields the final closed-form expression for the probability $p$:\n    $$p(p_{0}, \\mathrm{OR}_{\\mathrm{I}}, \\mathrm{OR}_{\\mathrm{II}}, \\mathrm{OR}_{\\mathrm{age}}, L, f_{\\mathrm{II}}, a, a_{\\mathrm{ref}}) = \\frac{\\left(\\frac{p_0}{1-p_0}\\right) (\\mathrm{OR}_{\\mathrm{I}})^{(1-f_{\\mathrm{II}})L} (\\mathrm{OR}_{\\mathrm{II}})^{f_{\\mathrm{II}}L} (\\mathrm{OR}_{\\mathrm{age}})^{a - a_{\\mathrm{ref}}}}{1 + \\left(\\frac{p_0}{1-p_0}\\right) (\\mathrm{OR}_{\\mathrm{I}})^{(1-f_{\\mathrm{II}})L} (\\mathrm{OR}_{\\mathrm{II}})^{f_{\\mathrm{II}}L} (\\mathrm{OR}_{\\mathrm{age}})^{a - a_{\\mathrm{ref}}}} $$\n\nThis expression represents the predicted one-year probability of *de novo* DSA formation as a function of all the specified parameters.\n\n**(b) Numerical Calculation**\n\nWe are asked to compute the probability $p$ for a specific recipient with the following characteristics:\n- Recipient age: $a = 52$\n- Total eplet load: $L = 30$\n- Class II eplet fraction: $f_{\\mathrm{II}} = 0.60$\n\nWe use the given constants:\n- Baseline probability: $p_0 = 0.10$\n- Reference age: $a_{\\mathrm{ref}} = 40$\n- Odds Ratios: $\\mathrm{OR}_{\\mathrm{I}} = 1.02$, $\\mathrm{OR}_{\\mathrm{II}} = 1.07$, $\\mathrm{OR}_{\\mathrm{age}} = 0.97$\n\n1.  First, calculate the baseline odds $o_0$:\n    $$o_0 = \\frac{p_0}{1-p_0} = \\frac{0.10}{1 - 0.10} = \\frac{0.10}{0.90} = \\frac{1}{9}$$\n\n2.  Next, calculate the eplet counts and the age difference:\n    -   Class II eplet count: $N_{\\mathrm{II}} = f_{\\mathrm{II}}L = 0.60 \\times 30 = 18$\n    -   Class I eplet count: $N_{\\mathrm{I}} = (1 - f_{\\mathrm{II}})L = (1 - 0.60) \\times 30 = 0.40 \\times 30 = 12$\n    -   Age difference: $a - a_{\\mathrm{ref}} = 52 - 40 = 12$\n\n3.  Now, calculate the total odds $o$ by plugging these values into the expression derived in part (a):\n    $$o = o_0 \\times (\\mathrm{OR}_{\\mathrm{I}})^{N_{\\mathrm{I}}} \\times (\\mathrm{OR}_{\\mathrm{II}})^{N_{\\mathrm{II}}} \\times (\\mathrm{OR}_{\\mathrm{age}})^{a - a_{\\mathrm{ref}}}$$\n    $$o = \\frac{1}{9} \\times (1.02)^{12} \\times (1.07)^{18} \\times (0.97)^{12}$$\n    To ensure precision, we evaluate the terms:\n    -   $(1.02)^{12} \\approx 1.26824179$\n    -   $(1.07)^{18} \\approx 3.37993216$\n    -   $(0.97)^{12} \\approx 0.69384400$\n    \n    The product of the odds ratio terms is:\n    $$(\\mathrm{OR}_{\\mathrm{I}})^{12} (\\mathrm{OR}_{\\mathrm{II}})^{18} (\\mathrm{OR}_{\\mathrm{age}})^{12} \\approx 1.26824179 \\times 3.37993216 \\times 0.69384400 \\approx 2.97560727$$\n    The total odds are:\n    $$o \\approx \\frac{1}{9} \\times 2.97560727 \\approx 0.33062303$$\n\n4.  Finally, convert the total odds $o$ to the probability $p$:\n    $$p = \\frac{o}{1+o} \\approx \\frac{0.33062303}{1 + 0.33062303} = \\frac{0.33062303}{1.33062303} \\approx 0.2484832$$\n\n5.  The problem requires the final answer to be rounded to four significant figures.\n    $$p \\approx 0.2485$$\n    Let me recompute to avoid calculator entry error. The log-transform method is more stable.\n    Log-odds $\\ell = \\ln(o) = \\ln(1/9) + 12\\ln(1.02) + 18\\ln(1.07) + 12\\ln(0.97)$\n    $\\ell \\approx -2.19722458 + 12(0.01980263) + 18(0.06765865) + 12(-0.03045921)$\n    $\\ell \\approx -2.19722458 + 0.23763153 + 1.21785567 - 0.36551049$\n    $\\ell \\approx -1.10724787$\n    $p = \\frac{1}{1 + \\exp(-\\ell)} = \\frac{1}{1 + \\exp(1.10724787)} \\approx \\frac{1}{1+3.0260456} \\approx \\frac{1}{4.0260456} \\approx 0.2483832$\n    Rounding $0.2483832$ to four significant figures, the fifth digit is $8$, so we round up the fourth digit ($3$).\n    $$p \\approx 0.2484$$\n    This result is confirmed.",
            "answer": "$$\\boxed{0.2484}$$"
        },
        {
            "introduction": "The ultimate goal of transplant pharmacology is to tailor immunosuppression to the individual patient, balancing the prevention of rejection against the risks of drug toxicity and infection. This advanced practice guides you through the construction of a complete pharmacokinetics/pharmacodynamics (PK/PD) model for tacrolimus, a cornerstone immunosuppressant. By deriving and implementing a model that links drug dosage, patient-specific variability, and cellular-level effects to the clinical risk of acute rejection, you will gain hands-on experience with the powerful computational tools that underpin personalized transplant medicine. ",
            "id": "5197280",
            "problem": "You are to implement a complete, runnable program that, for a set of patient parameter values, computes the predicted risk of acute cellular rejection over a fixed horizon using a mechanistic Pharmacokinetics/Pharmacodynamics (PK/PD) model that links tacrolimus trough concentrations, Nuclear Factor of Activated T-cells (NFAT) inhibition, and hazard of rejection, while incorporating interpatient variability. The derivation must begin from fundamental laws and core definitions, and the algorithm must be described in purely mathematical and logical terms. No shortcut formulas should be assumed without derivation. All calculations must be scientifically plausible and internally consistent.\n\nDefinitions and base relationships to use:\n- Pharmacokinetics is described by a one-compartment model with first-order absorption and elimination. Let $A_{\\text{gut}}(t)$ be the amount in the gut compartment and $A_{\\text{central}}(t)$ be the amount in the central compartment. The mass-balance ordinary differential equations (ODEs) under repeated oral dosing of dose $D$ at interval $\\tau$ are:\n  $$\\frac{dA_{\\text{gut}}(t)}{dt} = -k_a A_{\\text{gut}}(t),\\quad \\frac{dA_{\\text{central}}(t)}{dt} = F\\,k_a A_{\\text{gut}}(t) - k_e A_{\\text{central}}(t),$$\n  where $k_a$ is the first-order absorption rate constant, $F$ is the bioavailability, and $k_e$ is the elimination rate constant. The elimination rate constant satisfies $k_e = \\frac{CL}{V}$, where $CL$ is clearance and $V$ is volume of distribution. The central concentration is $C(t) = \\frac{A_{\\text{central}}(t)}{V}$.\n- At steady state with repeated dosing every $\\tau$, the trough concentration $C_{\\text{trough}}$ is the concentration at $t=\\tau$ immediately before the next dose. You must obtain $C_{\\text{trough}}$ from the steady-state solution of the above ODEs via superposition of dose contributions and evaluation at $t=\\tau$. Express concentration in $\\text{ng}/\\text{mL}$.\n- Interpatient variability is modeled as log-normal random effects on $CL$, $F$, and $EC_{50}$: \n  $$CL_i = CL_{\\text{pop,kg}} \\cdot w \\cdot e^{\\eta_{\\text{CL}}},\\quad F_i = F_{\\text{pop}} \\cdot e^{\\eta_{F}},\\quad EC_{50,i} = EC_{50,\\text{pop}} \\cdot e^{\\eta_{EC50}},$$\n  where $w$ is body weight in $\\text{kg}$, $CL_{\\text{pop,kg}}$ is the population clearance per $\\text{kg}$, $F_{\\text{pop}}$ is population bioavailability, and $EC_{50,\\text{pop}}$ is the population concentration for half-maximal effect.\n- Pharmacodynamics is described by a Hill function mapping concentration to NFAT inhibition fraction $I(C)$:\n  $$I(C) = I_{\\max} \\cdot \\frac{C^{h}}{EC_{50}^{h} + C^{h}},$$\n  where $I_{\\max}$ is the maximal inhibition, $h$ is the Hill coefficient (dimensionless), and $EC_{50}$ is the half-maximal inhibitory concentration. Here $C$ is in $\\text{ng}/\\text{mL}$.\n- Hazard-based risk model for acute cellular rejection: let the instantaneous hazard of rejection be \n  $$\\lambda(C) = \\lambda_0 \\cdot e^{-\\beta \\, I(C)},$$\n  where $\\lambda_0$ is the baseline hazard when there is no drug (no inhibition) and $\\beta$ scales the hazard reduction due to NFAT inhibition. Approximating the hazard over the horizon as constant at the trough level (conservative approximation), the probability of at least one rejection event over horizon $T$ (in $\\text{days}$) is \n  $$P = 1 - e^{-\\lambda(C_{\\text{trough}})\\, T}.$$\n\nConstants to use in your computations:\n- $F_{\\text{pop}} = 0.25$ (dimensionless).\n- $CL_{\\text{pop,kg}} = 0.0286$ $\\text{L}/\\text{h}/\\text{kg}$.\n- $V_{\\text{pop,kg}} = 1.4$ $\\text{L}/\\text{kg}$.\n- $k_a = 2.0$ $\\text{h}^{-1}$.\n- $I_{\\max} = 1.0$ (dimensionless).\n- $h = 1.2$ (dimensionless).\n- $EC_{50,\\text{pop}} = 8.0$ $\\text{ng}/\\text{mL}$.\n- $\\lambda_0 = 0.05$ $\\text{day}^{-1}$.\n- $\\beta = 4.0$ (dimensionless).\n- $T = 30$ $\\text{days}$.\n- $\\tau = 12$ $\\text{h}$.\n\nUnits and output requirements:\n- Express $C_{\\text{trough}}$ in $\\text{ng}/\\text{mL}$ internally when computing $I(C)$.\n- Express the final risk $P$ as a decimal in $[0,1]$ (unitless probability).\n- Angles are not used in this problem.\n- The final output must be a single line containing the results as a comma-separated list enclosed in square brackets, such as $[x_1,x_2,x_3]$, where each $x_j$ is the risk $P$ for the corresponding test case. Do not print any additional text.\n\nTest suite:\nCompute the risk $P$ for the following five parameter sets, each given as a tuple $(w, D, \\eta_{\\text{CL}}, \\eta_{F}, \\eta_{EC50})$ where $w$ is in $\\text{kg}$, $D$ is in $\\text{mg}$ per dose, and the $\\eta$ terms are dimensionless:\n- Case $1$ (typical \"happy path\"): $(70.0, 1.0, 0.0, 0.0, 0.0)$.\n- Case $2$ (lower dose): $(70.0, 0.5, 0.0, 0.0, 0.0)$.\n- Case $3$ (higher dose and higher bioavailability): $(70.0, 2.0, 0.0, 0.2, 0.0)$.\n- Case $4$ (boundary, no drug): $(70.0, 0.0, 0.0, 0.0, 0.0)$.\n- Case $5$ (edge, higher clearance, lower bioavailability, higher $EC_{50}$): $(70.0, 1.0, 0.4, -0.1, 0.3)$.\n\nAlgorithmic requirements:\n- Derive $C_{\\text{trough}}$ from the steady-state solution of the one-compartment, first-order absorption and elimination model using superposition and evaluation at $t=\\tau$.\n- Use the interpatient variability relationships to compute $CL_i$, $F_i$, and $EC_{50,i}$ for each case, then compute $k_e$ and $V$ from $CL_i$ and $V_{\\text{pop,kg}}\\cdot w$.\n- Compute $I(C_{\\text{trough}})$ via the Hill function, then $\\lambda(C_{\\text{trough}})$ and finally $P$ over $T$ days.\n- Ensure numerical stability when $|k_a - k_e|$ is small by using a stable evaluation strategy that avoids division by nearly zero.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for the five cases in order: $[P_1,P_2,P_3,P_4,P_5]$.\n\nYour solution must start from the above base definitions and show how the implementation follows from them. The final program must be self-contained and require no user input or external files.",
            "solution": "The problem is assessed as valid. It is a scientifically grounded, well-posed, and objective problem in quantitative pharmacology. It presents a clear task of implementing a standard, albeit multi-step, mechanistic PK/PD model. All necessary parameters, constants, and equations are provided, and the problem is self-contained and free from ambiguity or contradiction.\n\nThe solution proceeds by first deriving the necessary mathematical formulas from the fundamental principles provided, and then outlining the algorithm for computation.\n\n### Pharmacokinetic (PK) Model Derivation\n\nThe foundation of the model is the one-compartment system with first-order absorption and elimination, described by the following system of linear ordinary differential equations (ODEs) for the amount of drug in the gut, $A_{\\text{gut}}(t)$, and central compartment, $A_{\\text{central}}(t)$:\n$$\n\\frac{dA_{\\text{gut}}(t)}{dt} = -k_a A_{\\text{gut}}(t)\n$$\n$$\n\\frac{dA_{\\text{central}}(t)}{dt} = F k_a A_{\\text{gut}}(t) - k_e A_{\\text{central}}(t)\n$$\nHere, $k_a$ is the absorption rate constant, $k_e$ is the elimination rate constant, $F$ is bioavailability, and a dose $D$ is administered orally at time $t=0$.\n\n**1. Single-Dose Concentration Profile**\n\nFirst, we solve for the concentration profile following a single oral dose $D$. The initial condition for the gut compartment is $A_{\\text{gut}}(0) = D$. The solution to the first ODE is:\n$A_{\\text{gut}}(t) = D e^{-k_a t}$\n\nSubstituting this into the second ODE gives a first-order linear non-homogeneous equation for $A_{\\text{central}}(t)$:\n$$\n\\frac{dA_{\\text{central}}(t)}{dt} + k_e A_{\\text{central}}(t) = F k_a D e^{-k_a t}\n$$\nWith the initial condition $A_{\\text{central}}(0) = 0$, the solution, typically found using an integrating factor ($e^{k_e t}$), is:\n$$\nA_{\\text{central}}(t) = \\frac{F k_a D}{k_e - k_a} (e^{-k_a t} - e^{-k_e t}) \\quad \\text{for } k_a \\neq k_e\n$$\nThe concentration in the central compartment, $C(t)$, is $A_{\\text{central}}(t) / V$, where $V$ is the volume of distribution:\n$$\nC_{\\text{single}}(t) = \\frac{F k_a D}{V(k_e - k_a)} (e^{-k_a t} - e^{-k_e t})\n$$\n\n**2. Steady-State Concentration Profile**\n\nAt steady state, with repeated dosing every $\\tau$ hours, the concentration at any time $t$ within a dosing interval is the sum of the contributions from the current dose and all previous doses (principle of superposition). Let $t$ be the time elapsed since the last dose. The time since the dose administered $n$ intervals ago is $t + n\\tau$.\n$$\nC_{ss}(t) = \\sum_{n=0}^{\\infty} C_{\\text{single}}(t + n\\tau) = \\frac{F k_a D}{V(k_e - k_a)} \\sum_{n=0}^{\\infty} \\left( e^{-k_a(t+n\\tau)} - e^{-k_e(t+n\\tau)} \\right)\n$$\nThe infinite sum can be broken into two geometric series:\n$$\n\\sum_{n=0}^{\\infty} e^{-k(t+n\\tau)} = e^{-kt} \\sum_{n=0}^{\\infty} (e^{-k\\tau})^n = \\frac{e^{-kt}}{1 - e^{-k\\tau}}\n$$\nSubstituting this back gives the steady-state concentration profile:\n$$\nC_{ss}(t) = \\frac{F k_a D}{V(k_e - k_a)} \\left( \\frac{e^{-k_a t}}{1 - e^{-k_a \\tau}} - \\frac{e^{-k_e t}}{1 - e^{-k_e \\tau}} \\right)\n$$\n\n**3. Steady-State Trough Concentration ($C_{\\text{trough}}$)**\n\nThe trough concentration occurs immediately before the next dose is administered, i.e., at $t=\\tau$.\n$$\nC_{\\text{trough}} = C_{ss}(\\tau) = \\frac{F k_a D}{V(k_e - k_a)} \\left( \\frac{e^{-k_a \\tau}}{1 - e^{-k_a \\tau}} - \\frac{e^{-k_e \\tau}}{1 - e^{-k_e \\tau}} \\right)\n$$\nThis is the general formula for trough concentration when $k_a \\neq k_e$.\n\n**4. Special Case for Numerical Stability ($k_a = k_e$)**\n\nWhen $k_a \\approx k_e$, the general formula becomes numerically unstable due to catastrophic cancellation in the numerator and a denominator approaching zero. We must derive a separate expression for the case $k_a = k_e = k$.\n\nThe ODE for $A_{\\text{central}}$ becomes:\n$$\n\\frac{dA_{\\text{central}}(t)}{dt} + k A_{\\text{central}}(t) = F k D e^{-k t}\n$$\nThe solution for a single dose is:\n$$\nA_{\\text{central}}(t) = F k D t e^{-k t} \\implies C_{\\text{single}}(t) = \\frac{F k D}{V} t e^{-k t}\n$$\nApplying superposition at steady state:\n$$\nC_{ss}(t) = \\sum_{n=0}^{\\infty} C_{\\text{single}}(t+n\\tau) = \\frac{F k D}{V} \\sum_{n=0}^{\\infty} (t+n\\tau) e^{-k(t+n\\tau)}\n$$\nThis sum can be evaluated, and at the trough ($t=\\tau$), the result simplifies to:\n$$\nC_{\\text{trough}} = \\frac{F k_a D \\tau}{V} \\frac{e^{-k_a \\tau}}{(1-e^{-k_a \\tau})^2}\n$$\nThis formula is also the limit of the general formula as $k_e \\to k_a$, which can be shown using L'Hôpital's rule. For implementation, we will use this specialized formula when $|k_a - k_e|$ is below a small tolerance.\n\n### Overall Algorithm\n\nThe risk probability $P$ is computed for each patient parameter set by following these steps:\n\n1.  **Compute Individual Parameters**: For each case $(w, D, \\eta_{\\text{CL}}, \\eta_{F}, \\eta_{EC50})$:\n    *   Volume of distribution: $V_i = V_{\\text{pop,kg}} \\cdot w$\n    *   Clearance: $CL_i = CL_{\\text{pop,kg}} \\cdot w \\cdot e^{\\eta_{\\text{CL}}}$\n    *   Bioavailability: $F_i = F_{\\text{pop}} \\cdot e^{\\eta_{F}}$\n    *   Half-maximal inhibitory concentration: $EC_{50,i} = EC_{50,\\text{pop}} \\cdot e^{\\eta_{EC50}}$\n\n2.  **Calculate Rate Constants**:\n    *   Elimination rate constant: $k_e = CL_i / V_i$\n\n3.  **Compute Trough Concentration**:\n    *   If the dose $D$ is $0$, $C_{\\text{trough}} = 0$.\n    *   Otherwise, calculate $C_{\\text{trough}}$ in units of mg/L using the PK formulas derived above. A small tolerance (e.g., $10^{-9}$) on $|k_a - k_e|$ is used to switch between the general and the special-case formula for numerical stability.\n    *   Convert units: $C_{\\text{trough}}[\\text{ng/mL}] = C_{\\text{trough}}[\\text{mg/L}] \\times 1000$.\n\n4.  **Compute Pharmacodynamic (PD) Effect**:\n    *   Calculate the NFAT inhibition fraction $I(C)$ using the Hill function with the individual's $EC_{50,i}$ and the computed $C_{\\text{trough}}$ in ng/mL:\n    $$\n    I(C_{\\text{trough}}) = I_{\\max} \\cdot \\frac{C_{\\text{trough}}^{h}}{EC_{50,i}^{h} + C_{\\text{trough}}^{h}}\n    $$\n\n5.  **Compute Hazard of Rejection**:\n    *   Calculate the instantaneous hazard of rejection $\\lambda$ based on the drug's effect:\n    $$\n    \\lambda(C_{\\text{trough}}) = \\lambda_0 \\cdot e^{-\\beta \\, I(C_{\\text{trough}})}\n    $$\n\n6.  **Compute Rejection Risk**:\n    *   Calculate the probability of rejection $P$ over the time horizon $T$, assuming a constant hazard:\n    $$\n    P = 1 - e^{-\\lambda(C_{\\text{trough}}) \\cdot T}\n    $$\nThis procedure is repeated for all test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the predicted risk of acute cellular rejection using a PK/PD model.\n    \"\"\"\n\n    # --- Define constants from the problem statement ---\n    F_pop = 0.25  # Population bioavailability (dimensionless)\n    CL_pop_kg = 0.0286  # Population clearance per kg (L/h/kg)\n    V_pop_kg = 1.4  # Population volume of distribution per kg (L/kg)\n    ka = 2.0  # Absorption rate constant (h^-1)\n    Imax = 1.0  # Maximal NFAT inhibition (dimensionless)\n    h = 1.2  # Hill coefficient (dimensionless)\n    EC50_pop = 8.0  # Population EC50 (ng/mL)\n    lambda0 = 0.05  # Baseline hazard (day^-1)\n    beta = 4.0  # Hazard reduction factor (dimensionless)\n    T = 30.0  # Time horizon (days)\n    tau = 12.0  # Dosing interval (h)\n\n    # --- Define the test suite ---\n    test_cases = [\n        # (w: kg, D: mg, eta_CL, eta_F, eta_EC50)\n        (70.0, 1.0, 0.0, 0.0, 0.0),\n        (70.0, 0.5, 0.0, 0.0, 0.0),\n        (70.0, 2.0, 0.0, 0.2, 0.0),\n        (70.0, 0.0, 0.0, 0.0, 0.0),\n        (70.0, 1.0, 0.4, -0.1, 0.3),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        w, D, eta_CL, eta_F, eta_EC50 = case\n\n        # Step 1: Compute individual parameters\n        V = V_pop_kg * w\n        CL = CL_pop_kg * w * np.exp(eta_CL)\n        F = F_pop * np.exp(eta_F)\n        EC50 = EC50_pop * np.exp(eta_EC50)\n\n        # Step 2: Calculate rate constants\n        ke = CL / V\n\n        # Step 3: Compute trough concentration\n        if D == 0.0:\n            c_trough_ng_ml = 0.0\n        else:\n            c_trough_mg_l = 0.0\n            # Use numerically stable formulas for C_trough\n            if abs(ka - ke) < 1e-9:\n                # Special case: ka is very close to ke\n                # Formula derived from the limit as ke -> ka\n                term1 = ka * tau * np.exp(-ka * tau)\n                term2 = (1.0 - np.exp(-ka * tau)) ** 2\n                c_trough_mg_l = (F * ka * D / V) * (term1 / term2)\n            else:\n                # General case: ka != ke\n                term_ka = np.exp(-ka * tau) / (1.0 - np.exp(-ka * tau))\n                term_ke = np.exp(-ke * tau) / (1.0 - np.exp(-ke * tau))\n                c_trough_mg_l = (F * ka * D) / (V * (ke - ka)) * (term_ka - term_ke)\n            \n            # Convert units from mg/L to ng/mL for PD model\n            c_trough_ng_ml = c_trough_mg_l * 1000.0\n        \n        # Step 4: Compute Pharmacodynamic (PD) effect (NFAT inhibition)\n        # Handle cases where concentration is extremely low\n        if c_trough_ng_ml < 1e-9:\n             inhibition = 0.0\n        else:\n            c_h = c_trough_ng_ml ** h\n            ec50_h = EC50 ** h\n            inhibition = Imax * c_h / (ec50_h + c_h)\n\n        # Step 5: Compute Hazard of Rejection\n        hazard = lambda0 * np.exp(-beta * inhibition)\n\n        # Step 6: Compute Rejection Risk\n        risk = 1.0 - np.exp(-hazard * T)\n        \n        results.append(risk)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}