{
    "hands_on_practices": [
        {
            "introduction": "在启动一项耗资巨大的测序实验之前，一个关键步骤是确定所需的测序深度。这能确保您的实验有足够的统计功效来检测您所关注的转录本，特别是那些丰度低但具有临床意义的异构体。本练习  将引导您计算以给定概率检测到一个特定异构体所需的最小读数（reads）数量，从而将泊松抽样模型（Poisson sampling model）等基本统计原理与实际的实验设计联系起来。",
            "id": "4393505",
            "problem": "某精准肿瘤学实验室中的一项靶向RNA测序分析旨在发现和量化临床上可操作的剪接异构体。考虑一个肿瘤样本中我们感兴趣的异构体，通过正交定量已知其真实丰度为 $1$ TPM（每百万转录本）。假设以下生成模型和条件基于标准的RNA测序实践：\n\n1. 测序片段从转录组中均匀随机抽样，每个片段独立且唯一地分配给其来源的转录本。映射到任何给定异构体的片段计数遵循泊松抽样模型。\n2. 一个片段来源于某个异构体的概率与其分子丰度乘以其有效长度成正比。设 $m_i$ 表示异构体 $i$ 的真实分子丰度，$L_i$ 表示其有效长度。如果 $f_i = m_i / \\sum_k m_k$ 是该异构体的分子分数，则片段来源概率满足 $p_i \\propto f_i L_i$，相对于文库平均有效长度 $\\bar{L} = \\sum_k f_k L_k$。\n3. 每百万转录本（TPM）的定义为 $\\sum_i \\mathrm{TPM}_i = 10^6$ 且 $\\mathrm{TPM}_i = 10^6 \\times f_i$。因此 $f_i = \\mathrm{TPM}_i / 10^6$。\n4. 感兴趣的异构体的有效长度为 $L_{\\mathrm{iso}} = 1500$ 个核苷酸，文库平均有效长度为 $\\bar{L} = 2000$ 个核苷酸。所有测序的片段都被视为可用于计数。\n\n设 $R$ 表示可用的测序片段总数。设 $X$ 是分配给感兴趣异构体的片段的随机计数，并假设 $X \\sim \\mathrm{Poisson}(\\lambda)$，其均值为 $\\lambda = R p_{\\mathrm{iso}}$。从第一性原理出发，推导 $p_{\\mathrm{iso}}$ 关于 $\\mathrm{TPM}_{\\mathrm{iso}}$、$L_{\\mathrm{iso}}$ 和 $\\bar{L}$ 的表达式，然后推导使得检测概率 $\\mathbb{P}[X \\ge 1] \\ge 0.95$ 的最小 $R$。对于 $\\mathrm{TPM}_{\\mathrm{iso}} = 1$、$L_{\\mathrm{iso}} = 1500$ 和 $\\bar{L} = 2000$ 的情况，计算这个最小的 $R$。将最终数值答案四舍五入到四位有效数字。结果以片段数量表示。\n\n另外，在不要求对最终数值答案进行额外计算的情况下，简要讨论如果计数模型相对于泊松分布是过离散的，并且遵循均值为 $\\lambda$、离散参数为 $\\phi > 0$（方差为 $\\lambda + \\phi \\lambda^2$）的负二项（NB）分布，所需的 $R$ 会如何变化。请基于第一性原理，通过比较泊松分布和NB分布下的 $\\mathbb{P}[X=0]$ 来进行讨论。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取给定条件\n- 感兴趣的异构体的真实丰度：$\\mathrm{TPM}_{\\mathrm{iso}} = 1$\n- 感兴趣的异构体的片段计数 $X$ 遵循泊松分布：$X \\sim \\mathrm{Poisson}(\\lambda)$\n- 片段的抽样是均匀、独立的，并且片段被唯一分配。\n- 一个片段来源于异构体 $i$ 的概率 $p_i$ 与其分子丰度 $m_i$ 乘以其有效长度 $L_i$ 成正比：$p_i \\propto f_i L_i$，其中 $f_i = m_i / \\sum_k m_k$ 是分子分数。\n- 文库平均有效长度定义为 $\\bar{L} = \\sum_k f_k L_k$。\n- 每百万转录本（TPM）的定义由 $\\sum_i \\mathrm{TPM}_i = 10^6$ 和 $\\mathrm{TPM}_i = 10^6 \\times f_i$ 给出。由此可得 $f_i = \\mathrm{TPM}_i / 10^6$。\n- 感兴趣的异构体的有效长度为 $L_{\\mathrm{iso}} = 1500$ 个核苷酸。\n- 文库平均有效长度为 $\\bar{L} = 2000$ 个核苷酸。\n- $R$ 是可用的测序片段总数。\n- 泊松分布的均值为 $\\lambda = R p_{\\mathrm{iso}}$。\n- 主要目标是找到最小的 $R$ 使得检测概率 $\\mathbb{P}[X \\ge 1] \\ge 0.95$。\n- 次要目标是讨论如果计数模型遵循均值为 $\\lambda$、离散参数为 $\\phi > 0$ 的负二项分布，$R$ 会如何变化。\n\n### 步骤 2：使用提取的给定条件进行验证\n- **科学依据**：该问题基于RNA测序数据分析的标准理论框架。读数计数的泊松抽样模型、有效长度的概念以及TPM的定义都是转录组学和精准医疗诊断中基本且广泛使用的概念。所提供的值在生物物理和计算上都是现实的。\n- **适定性**：该问题是适定的。它提供了一个清晰的生成模型和足够的信息来推导所需的量。目标陈述明确，可以获得一个唯一且有意义的解。\n- **客观性**：问题以精确、客观和正式的语言陈述。没有主观性或歧义。\n\n### 步骤 3：结论与行动\n该问题科学上合理，内容自洽且适定。它是 **有效的**。现在开始求解过程。\n\n### 求解推导\n\n求解过程分为四个部分：首先，推导 $p_{\\mathrm{iso}}$ 的表达式；其次，推导所需的最小测序深度 $R$ 的通用公式；第三，计算 $R$ 的数值；第四，讨论过离散计数模型的影响。\n\n**第1部分：片段来源概率 $p_{\\mathrm{iso}}$ 的推导**\n\n问题陈述，一个测序片段来源于异构体 $i$ 的概率 $p_i$ 与该异构体的分子分数 $f_i$ 及其有效长度 $L_i$ 的乘积成正比。\n$$p_i \\propto f_i L_i$$\n我们可以用一个比例常数 $C$ 将其写成等式：\n$$p_i = C f_i L_i$$\n转录组中所有异构体 $i$ 的概率之和必须等于 $1$。\n$$\\sum_i p_i = 1$$\n代入 $p_i$ 的表达式：\n$$\\sum_i (C f_i L_i) = C \\sum_i f_i L_i = 1$$\n问题将文库平均有效长度定义为 $\\bar{L} = \\sum_i f_i L_i$。因此：\n$$C \\bar{L} = 1 \\implies C = \\frac{1}{\\bar{L}}$$\n将此常数代回 $p_i$ 的表达式，得到片段来源概率的通用公式：\n$$p_i = \\frac{f_i L_i}{\\bar{L}}$$\n问题还定义了分子分数 $f_i$ 和每百万转录本 $\\mathrm{TPM}_i$ 之间的关系为 $f_i = \\mathrm{TPM}_i / 10^6$。将此代入 $p_i$ 的方程中：\n$$p_i = \\frac{(\\mathrm{TPM}_i / 10^6) L_i}{\\bar{L}} = \\frac{\\mathrm{TPM}_i L_i}{10^6 \\bar{L}}$$\n对于我们感兴趣的特定异构体，该表达式为：\n$$p_{\\mathrm{iso}} = \\frac{\\mathrm{TPM}_{\\mathrm{iso}} L_{\\mathrm{iso}}}{10^6 \\bar{L}}$$\n\n**第2部分：最小测序深度 $R$ 的推导**\n\n映射到感兴趣的异构体的片段数 $X$ 被建模为泊松随机变量，$X \\sim \\mathrm{Poisson}(\\lambda)$，其均值为 $\\lambda = R p_{\\mathrm{iso}}$。要求是检测概率至少为 $0.95$。\n$$\\mathbb{P}[X \\ge 1] \\ge 0.95$$\n事件 $X \\ge 1$ 是事件 $X=0$ 的补集。因此，\n$$1 - \\mathbb{P}[X=0] \\ge 0.95$$\n$$\\mathbb{P}[X=0] \\le 0.05$$\n对于均值为 $\\lambda$ 的泊松分布，其概率质量函数为 $\\mathbb{P}[X=k] = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$。对于 $k=0$：\n$$\\mathbb{P}[X=0] = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n条件变为：\n$$\\exp(-\\lambda) \\le 0.05$$\n对两边取自然对数：\n$$-\\lambda \\le \\ln(0.05)$$\n两边乘以 $-1$ 会反转不等号：\n$$\\lambda \\ge -\\ln(0.05) = \\ln\\left(\\frac{1}{0.05}\\right) = \\ln(20)$$\n现在，我们代入 $\\lambda = R p_{\\mathrm{iso}}$：\n$$R p_{\\mathrm{iso}} \\ge \\ln(20)$$\n求解 $R$ 得出所需最小测序深度的条件：\n$$R \\ge \\frac{\\ln(20)}{p_{\\mathrm{iso}}}$$\n最后，我们代入在第1部分中推导出的 $p_{\\mathrm{iso}}$ 的表达式：\n$$R \\ge \\frac{\\ln(20)}{\\frac{\\mathrm{TPM}_{\\mathrm{iso}} L_{\\mathrm{iso}}}{10^6 \\bar{L}}} = \\frac{10^6 \\bar{L} \\ln(20)}{\\mathrm{TPM}_{\\mathrm{iso}} L_{\\mathrm{iso}}}$$\n因此，所需的最小测序深度 $R_{\\mathrm{min}}$ 由此表达式给出。\n\n**第3部分：$R_{\\mathrm{min}}$ 的数值计算**\n\n我们将给定的值代入推导出的 $R_{\\mathrm{min}}$ 公式中：\n- $\\mathrm{TPM}_{\\mathrm{iso}} = 1$\n- $L_{\\mathrm{iso}} = 1500$\n- $\\bar{L} = 2000$\n\n$$R_{\\mathrm{min}} = \\frac{10^6 \\times 2000 \\times \\ln(20)}{1 \\times 1500} = \\frac{2000}{1500} \\times 10^6 \\ln(20) = \\frac{4}{3} \\times 10^6 \\ln(20)$$\n使用值 $\\ln(20) \\approx 2.99573227$：\n$$R_{\\mathrm{min}} \\approx \\frac{4}{3} \\times 10^6 \\times 2.99573227 \\approx 3994309.69$$\n问题要求将最终数值答案四舍五入到四位有效数字。\n$$R_{\\mathrm{min}} \\approx 3.994 \\times 10^6$$\n\n**第4部分：关于负二项（NB）模型的讨论**\n\n在过离散的情况下，计数模型被指定为均值为 $\\lambda$、离散参数为 $\\phi > 0$ 的负二项（NB）分布。此NB分布的方差为 $\\lambda + \\phi\\lambda^2$，对于 $\\phi > 0$，该方差大于泊松分布的方差（$\\lambda$）。\n\n我们必须比较泊松模型和NB模型的零计数概率 $\\mathbb{P}[X=0]$，因为这个概率决定了检测阈值。\n对于泊松分布，如前所述：$\\mathbb{P}_{\\mathrm{Poisson}}[X=0] = \\exp(-\\lambda)$。\n对于由均值 $\\lambda$ 和离散参数 $\\phi$ 参数化的NB分布，观察到 $k=0$ 个计数的概率是：\n$$\\mathbb{P}_{\\mathrm{NB}}[X=0] = \\left(1 + \\phi \\lambda \\right)^{-1/\\phi}$$\n为了在固定的 $\\lambda > 0$ 和任意 $\\phi > 0$ 的条件下比较这两个概率，我们分析函数 $g(\\phi) = (1 + \\phi \\lambda)^{-1/\\phi}$。当离散参数趋近于零时，NB分布收敛于泊松分布：\n$$\\lim_{\\phi \\to 0^+} \\mathbb{P}_{\\mathrm{NB}}[X=0] = \\lim_{\\phi \\to 0^+} (1 + \\phi \\lambda)^{-1/\\phi} = \\exp(-\\lambda) = \\mathbb{P}_{\\mathrm{Poisson}}[X=0]$$\n为了确定 $\\phi > 0$ 时的行为，我们可以证明 $\\ln(\\mathbb{P}_{\\mathrm{NB}}[X=0]) = -\\frac{\\ln(1+\\phi\\lambda)}{\\phi}$ 是一个关于 $\\phi$ 的严格递增函数。它对 $\\phi$ 的导数是 $\\frac{1}{\\phi^2}\\left(\\ln(1+\\phi\\lambda) - \\frac{\\phi\\lambda}{1+\\phi\\lambda}\\right)$。括号中的项对于 $\\phi\\lambda > 0$ 是正的，这符合我们的情况。\n因此，对于任何 $\\phi > 0$，$\\ln(\\mathbb{P}_{\\mathrm{NB}}[X=0]) > \\ln(\\mathbb{P}_{\\mathrm{Poisson}}[X=0])$，这意味着：\n$$\\mathbb{P}_{\\mathrm{NB}}[X=0] > \\mathbb{P}_{\\mathrm{Poisson}}[X=0]$$\n这意味着在相同的平均计数 $\\lambda$（即相同的测序深度 $R$）下，过离散的NB模型观察到零计数的概率高于泊松模型。\n为了满足检测要求 $\\mathbb{P}[X \\ge 1] \\ge 0.95$（等同于 $\\mathbb{P}[X=0] \\le 0.05$），一个具有更高内在零概率的模型将需要一个更高的平均计数 $\\lambda$ 来将此概率抑制到 $0.05$ 阈值以下。由于 $\\lambda=R p_{\\mathrm{iso}}$ 且 $p_{\\mathrm{iso}}$ 由异构体和文库的特性固定，实现更高的 $\\lambda$ 需要一个更大的 $R$ 值。\n因此，如果计数模型是过离散的并遵循负二项分布，那么为达到相同的检测效力所需的测序深度 $R$ 将大于泊松假设下所需的深度。",
            "answer": "$$\n\\boxed{3.994 \\times 10^6}\n$$"
        },
        {
            "introduction": "RNA测序分析的一个核心挑战是，短测序读数通常会比对到多个转录本异构体上，从而产生歧义。现代定量工具通过将读数分组到等价类（equivalence classes）中，并使用统计模型来解卷积这些计数，从而解决这个问题。本练习  让您置身于这一过程的核心，要求您建立并求解一个线性方程组，该方程组将观测到的读数计数与潜在的、未知的异构体丰度联系起来，从而让您对这些强大算法的工作原理有切实的理解。",
            "id": "4393439",
            "problem": "一个与精准肿瘤学分析组合相关的基因表达三种转录本异构体，分别表示为 $T_{1}$、$T_{2}$ 和 $T_{3}$。一个经过偏差校正的RNA测序 (RNA-Seq) 流程根据与异构体集合的兼容性，将测序片段分为三个等价类，分别表示为 $E_{1}$、$E_{2}$ 和 $E_{3}$。该流程报告了每个等价类 $E_{i}$ 的观测片段计数 $c_{i}$，并将片段的生成建模为一个混合模型：片段由转录本异构体 $T_{j}$ 生成，其比例与其未知的片段计数 $f_{j}$ 成正比；一个来自 $T_{j}$ 的片段以已知的条件概率 $A_{ij}$ 贡献给等价类 $E_{i}$，该概率反映了比对兼容性和有效长度校正。每个等价类中的总期望计数是所有异构体贡献的总和。\n\n使用混合模型的核心定义和计数过程中期望的线性性，推导出一个显式的线性系统，该系统通过一个其条目为上述条件概率的矩阵，将观测到的等价类计数与未知的转录本片段计数联系起来。然后，对于以下经过偏差校正的兼容性矩阵和观测计数，\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0.5  0.3  0.2 \\\\\n0.2  0.4  0.4 \\\\\n0.3  0.3  0.4\n\\end{pmatrix},\n\\qquad\nc \\;=\\;\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix},\n$$\n构建相应的线性系统，并确定其是否存在满足非负性约束 $f_{1} \\geq 0$, $f_{2} \\geq 0$, $f_{3} \\geq 0$ 的解。如果可解，计算片段计数向量 $f = (f_{1}, f_{2}, f_{3})$ 的唯一解。将最终的片段计数向量表示为行矩阵。无需四舍五入。",
            "solution": "用户希望我解决一个关于转录本异构体定量的问题。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n-   转录本异构体：$T_{1}$、$T_{2}$、$T_{3}$。\n-   等价类：$E_{1}$、$E_{2}$、$E_{3}$。\n-   每个等价类 $E_{i}$ 的观测片段计数由向量 $c$ 给出。\n-   每个转录本异构体 $T_{j}$ 的未知片段计数由向量 $f$ 给出，其分量为 $f_{j}$。\n-   一个来自 $T_{j}$ 的片段贡献给等价类 $E_{i}$ 的条件概率是 $A_{ij}$。\n-   模型被描述为一个混合模型：每个等价类中的总期望计数是所有异构体贡献的总和。\n-   具体的兼容性矩阵 $A$ 是：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0.5  0.3  0.2 \\\\\n0.2  0.4  0.4 \\\\\n0.3  0.3  0.4\n\\end{pmatrix}\n$$\n-   具体的观测计数向量 $c$ 是：\n$$\nc \\;=\\;\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix}\n$$\n-   解上施加了非负性约束：$f_{1} \\ge 0$、$f_{2} \\ge 0$、$f_{3} \\ge 0$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题描述了一个用于RNA-Seq数据转录本异构体定量的简化但标准且科学上有效的模型。使用等价类和混合模型对计数进行解卷积是广泛使用的生物信息学工具（例如 RSEM、Kallisto、Salmon）的基石。该公式与计算生物学中已确立的原则一致。\n-   **适定性：** 这个问题是适定的。它要求推导并求解一个线性方程组。问题提供了所有必要的数据（一个矩阵 $A$ 和一个向量 $c$）和清晰的指令。解的存在性和唯一性取决于矩阵 $A$ 的性质。可以计算 $A$ 的行列式：\n    $$\n    \\det(A) = 0.5(0.4 \\cdot 0.4 - 0.4 \\cdot 0.3) - 0.3(0.2 \\cdot 0.4 - 0.4 \\cdot 0.3) + 0.2(0.2 \\cdot 0.3 - 0.4 \\cdot 0.3)\n    $$\n    $$\n    \\det(A) = 0.5(0.16 - 0.12) - 0.3(0.08 - 0.12) + 0.2(0.06 - 0.12)\n    $$\n    $$\n    \\det(A) = 0.5(0.04) - 0.3(-0.04) + 0.2(-0.06) = 0.02 + 0.012 - 0.012 = 0.02\n    $$\n    由于 $\\det(A) \\neq 0$，矩阵 $A$ 是可逆的，这意味着线性系统存在唯一解。问题接着正确地要求检查这个唯一解是否满足非负性约束。\n-   **客观性：** 问题使用精确、客观和标准的科学术语陈述。它没有歧义或主观性陈述。\n-   **其他缺陷：** 该问题没有检查清单中的任何其他缺陷。数据是自洽的；例如，矩阵 $A$ 的各列之和均为1，如果 $A_{ij}$ 代表 $P(\\text{类别 } i | \\text{异构体 } j)$ 并且所有片段都被分配到其中一个类别，这是符合预期的。\n\n**步骤3：结论与行动**\n问题是有效的。将提供完整的解答。\n\n**解答推导**\n\n问题要求通过兼容性矩阵 $A$ 将观测到的等价类计数 ($c$) 与未知的转录本片段计数 ($f$) 联系起来。\n\n设 $f_{j}$ 是源自转录本异构体 $T_{j}$ 的未知片段数。设 $c_{i}$ 是分配给等价类 $E_{i}$ 的观测片段数。源自异构体 $T_{j}$ 的片段与等价类 $E_{i}$ 兼容（并因此对其有贡献）的条件概率由 $A_{ij}$ 给出。\n\n等价类 $E_{i}$ 中片段的总期望数，记为 $\\mathbb{E}[c_{i}]$，是来自每个转录本异构体的期望贡献之和。来自异构体 $T_{j}$ 对类别 $E_{i}$ 的期望贡献是来自 $T_{j}$ 的总片段数与分配的条件概率的乘积，即 $f_{j} A_{ij}$。\n\n对所有异构体 $j \\in \\{1, 2, 3\\}$ 求和，我们得到类别 $E_{i}$ 的总期望计数：\n$$\n\\mathbb{E}[c_{i}] = \\sum_{j=1}^{3} A_{ij} f_{j}\n$$\n在这个建模框架中，观测到的计数 $c_{i}$被视为其期望值 $\\mathbb{E}[c_{i}]$ 的最佳估计。因此，我们建立以下关系：\n$$\nc_{i} = \\sum_{j=1}^{3} A_{ij} f_{j}\n$$\n这组三个方程（对于 $i=1, 2, 3$）可以写成矩阵形式。设 $c$ 为观测计数的列向量，$f$ 为未知异构体计数的列向量。关系如下：\n$$\n\\begin{pmatrix} c_{1} \\\\ c_{2} \\\\ c_{3} \\end{pmatrix} = \\begin{pmatrix}\nA_{11}  A_{12}  A_{13} \\\\\nA_{21}  A_{22}  A_{23} \\\\\nA_{31}  A_{32}  A_{33}\n\\end{pmatrix}\n\\begin{pmatrix} f_{1} \\\\ f_{2} \\\\ f_{3} \\end{pmatrix}\n$$\n这就是线性系统 $c = Af$。\n\n现在，我们代入给定的 $A$ 和 $c$ 的数值：\n$$\n\\begin{pmatrix}\n0.5  0.3  0.2 \\\\\n0.2  0.4  0.4 \\\\\n0.3  0.3  0.4\n\\end{pmatrix}\n\\begin{pmatrix}\nf_{1} \\\\\nf_{2} \\\\\nf_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix}\n$$\n为了求解向量 $f$，我们必须计算矩阵 $A$ 的逆，记为 $A^{-1}$。解则由 $f = A^{-1}c$ 给出。正如在验证阶段所确立的，$\\det(A) = 0.02$，因此逆矩阵存在。\n\n逆矩阵 $A^{-1}$ 通过公式 $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$ 计算，其中 $\\text{adj}(A)$ 是 $A$ 的伴随矩阵（其代数余子式矩阵的转置）。\n\nA的代数余子式矩阵 $C$ 的条目为 $C_{ij} = (-1)^{i+j}M_{ij}$，其中 $M_{ij}$ 是条目 $A_{ij}$ 的余子式。\n$C_{11} = (0.4)(0.4) - (0.4)(0.3) = 0.16 - 0.12 = 0.04$\n$C_{12} = -((0.2)(0.4) - (0.4)(0.3)) = -(0.08 - 0.12) = 0.04$\n$C_{13} = (0.2)(0.3) - (0.4)(0.3) = 0.06 - 0.12 = -0.06$\n$C_{21} = -((0.3)(0.4) - (0.2)(0.3)) = -(0.12 - 0.06) = -0.06$\n$C_{22} = (0.5)(0.4) - (0.2)(0.3) = 0.20 - 0.06 = 0.14$\n$C_{23} = -((0.5)(0.3) - (0.3)(0.3)) = -(0.15 - 0.09) = -0.06$\n$C_{31} = (0.3)(0.4) - (0.2)(0.4) = 0.12 - 0.08 = 0.04$\n$C_{32} = -((0.5)(0.4) - (0.2)(0.2)) = -(0.20 - 0.04) = -0.16$\n$C_{33} = (0.5)(0.4) - (0.3)(0.2) = 0.20 - 0.06 = 0.14$\n\n代数余子式矩阵为 $C = \\begin{pmatrix} 0.04  0.04  -0.06 \\\\ -0.06  0.14  -0.06 \\\\ 0.04  -0.16  0.14 \\end{pmatrix}$。\n伴随矩阵是 $C$ 的转置：$\\text{adj}(A) = C^T = \\begin{pmatrix} 0.04  -0.06  0.04 \\\\ 0.04  0.14  -0.16 \\\\ -0.06  -0.06  0.14 \\end{pmatrix}$。\n\n逆矩阵是：\n$$\nA^{-1} = \\frac{1}{0.02} \\begin{pmatrix} 0.04  -0.06  0.04 \\\\ 0.04  0.14  -0.16 \\\\ -0.06  -0.06  0.14 \\end{pmatrix} = 50 \\begin{pmatrix} 0.04  -0.06  0.04 \\\\ 0.04  0.14  -0.16 \\\\ -0.06  -0.06  0.14 \\end{pmatrix} = \\begin{pmatrix} 2  -3  2 \\\\ 2  7  -8 \\\\ -3  -3  7 \\end{pmatrix}\n$$\n现在我们计算解向量 $f = A^{-1}c$：\n$$\n\\begin{pmatrix}\nf_{1} \\\\\nf_{2} \\\\\nf_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2  -3  2 \\\\\n2  7  -8 \\\\\n-3  -3  7\n\\end{pmatrix}\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix}\n$$\n$f$ 的分量是：\n$f_{1} = (2)(140) + (-3)(160) + (2)(150) = 280 - 480 + 300 = 100$\n$f_{2} = (2)(140) + (7)(160) + (-8)(150) = 280 + 1120 - 1200 = 200$\n$f_{3} = (-3)(140) + (-3)(160) + (7)(150) = -420 - 480 + 1050 = 150$\n\n片段计数向量的解是 $f = (100, 200, 150)^T$。\n\n最后一步是确定该解是否满足非负性约束：\n$f_{1} = 100 \\ge 0$\n$f_{2} = 200 \\ge 0$\n$f_{3} = 150 \\ge 0$\n所有分量都是非负的，因此该系统存在一个有效的、具有物理意义的解。片段计数向量的唯一解确实是 $(100, 200, 150)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n100  200  150\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "由于测序深度和转录本长度的差异，原始读数计数在样本或基因之间不具有直接可比性。像“每百万转录本数”（Transcripts Per Million, TPM）这样的归一化方法旨在校正这些偏差，但这些数字在物理上代表什么呢？本实践问题  挑战您进行逆向计算，将TPM值转换回绝对的片段计数。这个过程将加深您对TPM真实衡量标准及其与基础分子计数之间关系的理解。",
            "id": "4393435",
            "problem": "一个与癌症相关的基因有三个已注释的信使RNA（mRNA）异构体，其有效转录本长度（单位为核苷酸）由片段长度分布确定：异构体 $1$ 的长度为 $L_{1} = 900$，异构体 $2$ 的长度为 $L_{2} = 600$，异构体 $3$ 的长度为 $L_{3} = 750$。在一个单次RNA测序（RNA-Seq）样本中，通过一种报告每百万转录本数（TPM）值的标准方法对异构体水平的丰度进行量化，得到这些异构体的向量为 $\\left(T_{1}, T_{2}, T_{3}\\right) = \\left(20, 30, 10\\right)$。总共有 $F = 4350$ 个片段比对到了这个基因上。\n\n从单位长度归一化丰度和每百万转录本数（TPM）的定义出发，假设片段在每个异构体的有效长度上均匀采样，并且所有比对到该基因的片段都源自这三个异构体。在这些假设下，计算与给定的TPM值、有效长度和总比对片段数一致的异构体水平的片段计数 $\\left(r_{1}, r_{2}, r_{3}\\right)$，并验证这些异构体和基因上的质量守恒。在你的最终答案中，将异构体 $3$ 的计数表示为整数个片段。",
            "solution": "该问题要求根据给定的每百万转录本数（TPM）值、有效转录本长度以及比对到基因上的总片段数，来计算异构体特异性的片段计数。解决方案涉及在所述假设下，逆向执行标准的TPM计算过程。\n\n设 $r_i$ 为源自异构体 $i$ 的片段数，设 $L_i$ 为其有效长度。比对到该基因的总片段数为 $F = \\sum_{i} r_i$。我们已知有三个异构体，因此 $i \\in \\{1, 2, 3\\}$。\n\nRNA测序（RNA-Seq）量化的核心假设是，从一个转录本异构体 $i$ 中抽样得到的片段数 $r_i$ 与其摩尔浓度（丰度，记为 $\\eta_i$）和其有效长度 $L_i$ 均成正比。即，$r_i \\propto \\eta_i L_i$。这意味着摩尔浓度与按长度归一化的片段计数成正比：$\\eta_i \\propto \\frac{r_i}{L_i}$。\n\n每百万转录本数（TPM）是一种衡量转录本丰度的指标，它同时对测序深度和转录本长度进行归一化。一个转录本 $i$ 的TPM值，记为 $T_i$，定义为其经过长度归一化的丰度，再乘以一个缩放因子，使得样本中所有转录本的TPM值之和等于 $1,000,000$。\n\n异构体 $i$ 经过长度归一化的丰度与 $\\frac{r_i}{L_i}$ 成正比。因此，TPM值 $T_i$ 与此量成正比：\n$$ T_i = C \\cdot \\frac{r_i}{L_i} $$\n其中 $C$ 是一个归一化常数，对于给定样本中的所有转录本都是相同的。该常数的计算方法为 $C = \\frac{10^6}{\\sum_{j} (r_j/L_j)}$，其中求和遍及整个样本中的所有转录本。\n\n这个定义的一个关键特性是，任意两个转录本的TPM值之比仅取决于它们各自的片段计数和长度，因为常数 $C$ 会被消去：\n$$ \\frac{T_i}{T_k} = \\frac{C \\cdot (r_i / L_i)}{C \\cdot (r_k / L_k)} = \\frac{r_i / L_i}{r_k / L_k} $$\n这种关系独立于样本中的任何其他转录本，并且对我们特定基因的异构体成立。由此，我们可以用其TPM和长度来表示片段计数 $r_i$：\n$$ r_i = L_i \\cdot \\frac{T_i}{T_k} \\cdot \\frac{r_k}{L_k} $$\n这表明对于所有异构体，量 $r_i / (T_i L_i)$ 是一个常数。我们称这个常数为 $k$：\n$$ k = \\frac{r_i}{T_i L_i} \\implies r_i = k \\cdot (T_i L_i) $$\n\n我们已知比对到该基因的总片段数为 $F$。假设所有这些片段都源自这三个指定的异构体，我们有：\n$$ F = \\sum_{i=1}^{3} r_i $$\n将 $r_i$ 关于 $k$ 的表达式代入：\n$$ F = \\sum_{i=1}^{3} k \\cdot (T_i L_i) = k \\sum_{i=1}^{3} (T_i L_i) $$\n现在我们可以解出比例常数 $k$：\n$$ k = \\frac{F}{\\sum_{j=1}^{3} (T_j L_j)} $$\n一旦确定了 $k$，我们就可以计算每个异构体 $i$ 的单独片段计数：\n$$ r_i = k \\cdot (T_i L_i) = \\frac{F}{\\sum_{j=1}^{3} (T_j L_j)} \\cdot (T_i L_i) $$\n\n现在，我们将给定值代入此公式。\n给定值为：\n- 有效长度：$L_{1} = 900$, $L_{2} = 600$, $L_{3} = 750$。\n- TPM值：$T_{1} = 20$, $T_{2} = 30$, $T_{3} = 10$。\n- 基因的总比对片段数：$F = 4350$。\n\n首先，我们计算每个异构体的 $T_i L_i$ 项：\n- 对于异构体 $1$：$T_1 L_1 = 20 \\times 900 = 18000$。\n- 对于异构体 $2$：$T_2 L_2 = 30 \\times 600 = 18000$。\n- 对于异构体 $3$：$T_3 L_3 = 10 \\times 750 = 7500$。\n\n接下来，我们计算分母中的和：\n$$ \\sum_{j=1}^{3} (T_j L_j) = T_1 L_1 + T_2 L_2 + T_3 L_3 = 18000 + 18000 + 7500 = 43500 $$\n\n现在，我们计算比例常数 $k$：\n$$ k = \\frac{F}{43500} = \\frac{4350}{43500} = \\frac{1}{10} = 0.1 $$\n\n最后，我们使用 $k$ 来计算每个异构体的片段计数：\n- 异构体 $1$：$r_1 = k \\cdot (T_1 L_1) = 0.1 \\times 18000 = 1800$。\n- 异构体 $2$：$r_2 = k \\cdot (T_2 L_2) = 0.1 \\times 18000 = 1800$。\n- 异构体 $3$：$r_3 = k \\cdot (T_3 L_3) = 0.1 \\times 7500 = 750$。\n\n得到的异构体水平片段计数为 $(r_1, r_2, r_3) = (1800, 1800, 750)$。\n\n问题还要求验证质量守恒。这意味着计算出的异构体片段计数之和必须等于比对到基因上的总片段数。\n$$ \\sum_{i=1}^{3} r_i = r_1 + r_2 + r_3 = 1800 + 1800 + 750 = 4350 $$\n这个和确实等于给定的总片段计数 $F = 4350$。因此，质量守恒得到验证。\n\n问题要求的是异构体 $3$ 的片段计数，即 $r_3$。\n$$ r_3 = 750 $$\n这是一个整数个片段，符合预期。",
            "answer": "$$\\boxed{750}$$"
        }
    ]
}