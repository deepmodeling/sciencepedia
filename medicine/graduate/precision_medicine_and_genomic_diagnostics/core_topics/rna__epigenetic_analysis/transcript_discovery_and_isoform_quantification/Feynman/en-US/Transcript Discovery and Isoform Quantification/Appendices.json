{
    "hands_on_practices": [
        {
            "introduction": "Before we can quantify an isoform, we must first be able to detect it. This first practice explores a fundamental statistical question in experimental design: what is the minimum sequencing depth required to detect a low-abundance isoform with a specific level of confidence? By applying a Poisson sampling model, you will connect sequencing depth to detection probability, providing a critical skill for planning effective RNA-seq experiments in precision medicine .",
            "id": "4393505",
            "problem": "A targeted RNA sequencing assay in a precision oncology laboratory aims to discover and quantify clinically actionable splice isoforms. Consider an isoform of interest in a tumor sample whose true abundance is known from orthogonal quantification to be 1 Transcript Per Million (TPM). Assume the following generative model and conditions grounded in standard RNA sequencing practice:\n\n1. Sequencing fragments are sampled uniformly at random from the transcriptome, and each fragment is independently and uniquely assigned to its transcript of origin. The count of fragments mapping to any given isoform follows a Poisson sampling model.\n2. The probability that a fragment originates from an isoform is proportional to its molecule abundance times its effective length. Let $m_i$ denote the true molecular abundance of isoform $i$ and $L_i$ its effective length. If $f_i = m_i / \\sum_k m_k$ is the isoform’s molecule fraction, the fragment-origin probability satisfies $p_i \\propto f_i L_i$ relative to the library-average effective length $\\bar{L} = \\sum_k f_k L_k$.\n3. Transcripts Per Million (TPM) is defined such that $\\sum_i \\mathrm{TPM}_i = 10^6$ and $\\mathrm{TPM}_i = 10^6 \\times f_i$. Thus $f_i = \\mathrm{TPM}_i / 10^6$.\n4. The isoform of interest has effective length $L_{\\mathrm{iso}} = 1500$ nucleotides, and the library-average effective length is $\\bar{L} = 2000$ nucleotides. All sequenced fragments are considered usable for counting.\n\nLet $R$ denote the total number of usable sequenced fragments. Let $X$ be the random count of fragments assigned to the isoform of interest and suppose $X \\sim \\mathrm{Poisson}(\\lambda)$ with mean $\\lambda = R p_{\\mathrm{iso}}$. Derive from first principles an expression for $p_{\\mathrm{iso}}$ in terms of $\\mathrm{TPM}_{\\mathrm{iso}}$, $L_{\\mathrm{iso}}$, and $\\bar{L}$, and then derive the minimum $R$ such that the detection probability $\\mathbb{P}[X \\ge 1] \\ge 0.95$. Evaluate this minimum $R$ for $\\mathrm{TPM}_{\\mathrm{iso}} = 1$, $L_{\\mathrm{iso}} = 1500$, and $\\bar{L} = 2000$. Round your final numerical answer to four significant figures. Express the result as the number of fragments.\n\nSeparately, and without additional calculation requirements for the final numeric answer, briefly discuss how the required $R$ would change if the count model were overdispersed relative to Poisson and followed a Negative Binomial (NB) distribution with mean $\\lambda$ and dispersion parameter $\\phi > 0$ (variance $\\lambda + \\phi \\lambda^2$). Base your discussion on first principles by comparing $\\mathbb{P}[X=0]$ under Poisson and NB.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- True abundance of the isoform of interest: $\\mathrm{TPM}_{\\mathrm{iso}} = 1$\n- Fragment count $X$ for the isoform of interest follows a Poisson distribution: $X \\sim \\mathrm{Poisson}(\\lambda)$\n- The sampling of fragments is uniform, independent, and fragments are uniquely assigned.\n- The probability $p_i$ of a fragment originating from isoform $i$ is proportional to its molecule abundance $m_i$ times its effective length $L_i$: $p_i \\propto f_i L_i$, where $f_i = m_i / \\sum_k m_k$ is the molecule fraction.\n- The library-average effective length is defined as $\\bar{L} = \\sum_k f_k L_k$.\n- The definition of Transcripts Per Million (TPM) is given by $\\sum_i \\mathrm{TPM}_i = 10^6$ and $\\mathrm{TPM}_i = 10^6 \\times f_i$. From this, $f_i = \\mathrm{TPM}_i / 10^6$.\n- The effective length of the isoform of interest is $L_{\\mathrm{iso}} = 1500$ nucleotides.\n- The library-average effective length is $\\bar{L} = 2000$ nucleotides.\n- $R$ is the total number of usable sequenced fragments.\n- The mean of the Poisson distribution is $\\lambda = R p_{\\mathrm{iso}}$.\n- The primary objective is to find the minimum $R$ such that the detection probability $\\mathbb{P}[X \\ge 1] \\ge 0.95$.\n- A secondary objective is to discuss how $R$ would change if the count model followed a Negative Binomial distribution with mean $\\lambda$ and dispersion $\\phi > 0$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is grounded in the standard theoretical framework of RNA sequencing data analysis. The Poisson sampling model for read counts, the concept of effective length, and the definition of TPM are all fundamental and widely used concepts in transcriptomics and precision medicine diagnostics. The provided values are biophysically and computationally realistic.\n- **Well-Posed**: The problem is well-posed. It provides a clear generative model and sufficient information to derive the required quantities. The objectives are stated unambiguously, and a unique, meaningful solution is attainable.\n- **Objective**: The problem is stated in precise, objective, and formal language. It is free from subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, self-contained, and well-posed. It is **VALID**. The solution process will now proceed.\n\n### Solution Derivation\n\nThe solution is developed in four parts: first, deriving the expression for $p_{\\mathrm{iso}}$; second, deriving the general formula for the minimum required sequencing depth $R$; third, calculating the numerical value of $R$; and fourth, discussing the effect of an overdispersed count model.\n\n**Part 1: Derivation of the fragment-origin probability $p_{\\mathrm{iso}}$**\n\nThe problem states that the probability $p_i$ that a sequenced fragment originates from isoform $i$ is proportional to the product of the isoform's molecule fraction $f_i$ and its effective length $L_i$.\n$$p_i \\propto f_i L_i$$\nWe can write this as an equality with a constant of proportionality, $C$:\n$$p_i = C f_i L_i$$\nThe sum of probabilities over all isoforms $i$ in the transcriptome must equal $1$.\n$$\\sum_i p_i = 1$$\nSubstituting the expression for $p_i$:\n$$\\sum_i (C f_i L_i) = C \\sum_i f_i L_i = 1$$\nThe problem defines the library-average effective length as $\\bar{L} = \\sum_i f_i L_i$. Therefore:\n$$C \\bar{L} = 1 \\implies C = \\frac{1}{\\bar{L}}$$\nSubstituting this constant back into the expression for $p_i$ gives the general formula for the fragment-origin probability:\n$$p_i = \\frac{f_i L_i}{\\bar{L}}$$\nThe problem also defines the relationship between the molecule fraction $f_i$ and Transcripts Per Million $\\mathrm{TPM}_i$ as $f_i = \\mathrm{TPM}_i / 10^6$. Substituting this into the equation for $p_i$:\n$$p_i = \\frac{(\\mathrm{TPM}_i / 10^6) L_i}{\\bar{L}} = \\frac{\\mathrm{TPM}_i L_i}{10^6 \\bar{L}}$$\nFor the specific isoform of interest, this expression is:\n$$p_{\\mathrm{iso}} = \\frac{\\mathrm{TPM}_{\\mathrm{iso}} L_{\\mathrm{iso}}}{10^6 \\bar{L}}$$\n\n**Part 2: Derivation of the minimum sequencing depth $R$**\n\nThe number of fragments $X$ mapping to the isoform of interest is modeled as a Poisson random variable, $X \\sim \\mathrm{Poisson}(\\lambda)$, with mean $\\lambda = R p_{\\mathrm{iso}}$. The requirement is to have a detection probability of at least $0.95$.\n$$\\mathbb{P}[X \\ge 1] \\ge 0.95$$\nThe event $X \\ge 1$ is the complement of the event $X=0$. Thus,\n$$1 - \\mathbb{P}[X=0] \\ge 0.95$$\n$$\\mathbb{P}[X=0] \\le 0.05$$\nFor a Poisson distribution with mean $\\lambda$, the probability mass function is $\\mathbb{P}[X=k] = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$. For $k=0$:\n$$\\mathbb{P}[X=0] = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\nThe condition becomes:\n$$\\exp(-\\lambda) \\le 0.05$$\nTaking the natural logarithm of both sides:\n$$-\\lambda \\le \\ln(0.05)$$\nMultiplying by $-1$ reverses the inequality:\n$$\\lambda \\ge -\\ln(0.05) = \\ln\\left(\\frac{1}{0.05}\\right) = \\ln(20)$$\nNow, we substitute $\\lambda = R p_{\\mathrm{iso}}$:\n$$R p_{\\mathrm{iso}} \\ge \\ln(20)$$\nSolving for $R$ yields the condition for the minimum required sequencing depth:\n$$R \\ge \\frac{\\ln(20)}{p_{\\mathrm{iso}}}$$\nFinally, we substitute the expression for $p_{\\mathrm{iso}}$ derived in Part 1:\n$$R \\ge \\frac{\\ln(20)}{\\frac{\\mathrm{TPM}_{\\mathrm{iso}} L_{\\mathrm{iso}}}{10^6 \\bar{L}}} = \\frac{10^6 \\bar{L} \\ln(20)}{\\mathrm{TPM}_{\\mathrm{iso}} L_{\\mathrm{iso}}}$$\nThe minimum required sequencing depth, $R_{\\mathrm{min}}$, is therefore given by this expression.\n\n**Part 3: Numerical evaluation of $R_{\\mathrm{min}}$**\n\nWe substitute the given values into the derived formula for $R_{\\mathrm{min}}$:\n- $\\mathrm{TPM}_{\\mathrm{iso}} = 1$\n- $L_{\\mathrm{iso}} = 1500$\n- $\\bar{L} = 2000$\n\n$$R_{\\mathrm{min}} = \\frac{10^6 \\times 2000 \\times \\ln(20)}{1 \\times 1500} = \\frac{2000}{1500} \\times 10^6 \\ln(20) = \\frac{4}{3} \\times 10^6 \\ln(20)$$\nUsing the value $\\ln(20) \\approx 2.99573227$:\n$$R_{\\mathrm{min}} \\approx \\frac{4}{3} \\times 10^6 \\times 2.99573227 \\approx 3994309.69$$\nThe problem requires rounding the final numerical answer to four significant figures.\n$$R_{\\mathrm{min}} \\approx 3.994 \\times 10^6$$\n\n**Part 4: Discussion of the Negative Binomial (NB) model**\n\nIn the case of overdispersion, the count model is specified as a Negative Binomial (NB) distribution with mean $\\lambda$ and dispersion parameter $\\phi > 0$. The variance of this NB distribution is $\\lambda + \\phi\\lambda^2$, which is greater than the Poisson variance ($\\lambda$) for $\\phi > 0$.\n\nWe must compare the probability of zero counts, $\\mathbb{P}[X=0]$, for the Poisson and NB models, as this probability governs the detection threshold.\nFor Poisson, as established: $\\mathbb{P}_{\\mathrm{Poisson}}[X=0] = \\exp(-\\lambda)$.\nFor the NB distribution parameterized by mean $\\lambda$ and dispersion $\\phi$, the probability of observing $k=0$ counts is:\n$$\\mathbb{P}_{\\mathrm{NB}}[X=0] = \\left(1 + \\phi \\lambda \\right)^{-1/\\phi}$$\nTo compare these two probabilities for a fixed $\\lambda > 0$ and any $\\phi > 0$, we analyze the function $g(\\phi) = (1 + \\phi \\lambda)^{-1/\\phi}$. In the limit as the dispersion approaches zero, the NB distribution converges to the Poisson distribution:\n$$\\lim_{\\phi \\to 0^+} \\mathbb{P}_{\\mathrm{NB}}[X=0] = \\lim_{\\phi \\to 0^+} (1 + \\phi \\lambda)^{-1/\\phi} = \\exp(-\\lambda) = \\mathbb{P}_{\\mathrm{Poisson}}[X=0]$$\nTo determine the behavior for $\\phi > 0$, we can show that $\\ln(\\mathbb{P}_{\\mathrm{NB}}[X=0]) = -\\frac{\\ln(1+\\phi\\lambda)}{\\phi}$ is a strictly increasing function of $\\phi$. Its derivative with respect to $\\phi$ is $\\frac{1}{\\phi^2}\\left(\\ln(1+\\phi\\lambda) - \\frac{\\phi\\lambda}{1+\\phi\\lambda}\\right)$. The term in parentheses is positive for $\\phi\\lambda > 0$, which is our case.\nTherefore, for any $\\phi > 0$, $\\ln(\\mathbb{P}_{\\mathrm{NB}}[X=0]) > \\ln(\\mathbb{P}_{\\mathrm{Poisson}}[X=0])$, which implies:\n$$\\mathbb{P}_{\\mathrm{NB}}[X=0] > \\mathbb{P}_{\\mathrm{Poisson}}[X=0]$$\nThis means that for the same mean count $\\lambda$ (i.e., for the same sequencing depth $R$), the probability of observing zero counts is higher under the overdispersed NB model than under the Poisson model.\nTo satisfy the detection requirement $\\mathbb{P}[X \\ge 1] \\ge 0.95$, which is equivalent to $\\mathbb{P}[X=0] \\le 0.05$, a model with a higher intrinsic probability of zeros will require a higher mean count $\\lambda$ to suppress this probability below the $0.05$ threshold. Since $\\lambda=R p_{\\mathrm{iso}}$ and $p_{\\mathrm{iso}}$ is fixed by the properties of the isoform and the library, achieving a higher $\\lambda$ requires a larger value of $R$.\nConsequently, if the count model were overdispersed and followed a Negative Binomial distribution, the required sequencing depth $R$ to achieve the same detection power would be greater than that required under the Poisson assumption.",
            "answer": "$$\n\\boxed{3.994 \\times 10^6}\n$$"
        },
        {
            "introduction": "A central challenge in isoform quantification is that many sequencing reads are compatible with multiple transcripts, creating ambiguity. This practice delves into the mathematical engine of modern quantification tools, which use mixture models to resolve this ambiguity . You will set up and solve a system of linear equations that deconvolves observed fragment counts from \"equivalence classes\" into estimated abundances for individual isoforms, offering a hands-on look at this essential computational step.",
            "id": "4393439",
            "problem": "A gene implicated in a precision oncology panel expresses three transcript isoforms, denoted $T_{1}$, $T_{2}$, and $T_{3}$. A bias-corrected RNA sequencing (RNA-Seq) pipeline groups sequenced fragments into three equivalence classes based on compatibility with sets of isoforms, denoted $E_{1}$, $E_{2}$, and $E_{3}$. The pipeline reports observed fragment counts $c_{i}$ for each equivalence class $E_{i}$ and models fragment generation as a mixture: fragments are generated from transcript isoform $T_{j}$ in proportion to its unknown fragment count $f_{j}$, and a fragment from $T_{j}$ contributes to equivalence class $E_{i}$ with a known conditional probability $A_{ij}$ reflecting mapping compatibility and effective length corrections. The total expected count in each equivalence class is the sum of contributions from all isoforms.\n\nUsing core definitions of mixture models and the linearity of expectation in count processes, derive an explicit linear system relating the observed equivalence class counts to the unknown transcript fragment counts via a matrix whose entries are the conditional probabilities described above. Then, for the following bias-corrected compatibility matrix and observed counts,\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0.5 & 0.3 & 0.2 \\\\\n0.2 & 0.4 & 0.4 \\\\\n0.3 & 0.3 & 0.4\n\\end{pmatrix},\n\\qquad\nc \\;=\\;\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix},\n$$\nformulate the corresponding linear system and determine whether it admits a solution with the nonnegativity constraints $f_{1} \\geq 0$, $f_{2} \\geq 0$, $f_{3} \\geq 0$. If solvable, compute the unique solution for the fragment count vector $f = (f_{1}, f_{2}, f_{3})$. Express the final fragment count vector as a row matrix. No rounding is required.",
            "solution": "The user wants me to solve a problem about transcript isoform quantification.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   Transcript isoforms: $T_{1}$, $T_{2}$, $T_{3}$.\n-   Equivalence classes: $E_{1}$, $E_{2}$, $E_{3}$.\n-   Observed fragment counts for each equivalence class $E_{i}$ are given by the vector $c$.\n-   Unknown fragment counts for each transcript isoform $T_{j}$ are given by the vector $f$, with components $f_{j}$.\n-   The conditional probability that a fragment from $T_{j}$ contributes to equivalence class $E_{i}$ is $A_{ij}$.\n-   The model is described as a mixture: the total expected count in each equivalence class is the sum of contributions from all isoforms.\n-   The specific compatibility matrix $A$ is:\n$$\nA \\;=\\;\n\\begin{pmatrix}\n0.5 & 0.3 & 0.2 \\\\\n0.2 & 0.4 & 0.4 \\\\\n0.3 & 0.3 & 0.4\n\\end{pmatrix}\n$$\n-   The specific observed count vector $c$ is:\n$$\nc \\;=\\;\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix}\n$$\n-   Nonnegativity constraints are imposed on the solution: $f_{1} \\ge 0$, $f_{2} \\ge 0$, $f_{3} \\ge 0$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem describes a simplified but standard and scientifically valid model for transcript isoform quantification from RNA-Seq data. The use of equivalence classes and a mixture model to deconvolve counts is a cornerstone of widely used bioinformatics tools (e.g., RSEM, Kallisto, Salmon). The formulation is consistent with established principles in computational biology.\n-   **Well-Posed:** The problem is well-posed. It requires deriving and solving a system of linear equations. The problem provides all necessary data (a matrix $A$ and a vector $c$) and clear instructions. The existence and uniqueness of a solution depend on the properties of the matrix $A$. The determinant of $A$ can be computed:\n    $$\n    \\det(A) = 0.5(0.4 \\cdot 0.4 - 0.4 \\cdot 0.3) - 0.3(0.2 \\cdot 0.4 - 0.4 \\cdot 0.3) + 0.2(0.2 \\cdot 0.3 - 0.4 \\cdot 0.3)\n    $$\n    $$\n    \\det(A) = 0.5(0.16 - 0.12) - 0.3(0.08 - 0.12) + 0.2(0.06 - 0.12)\n    $$\n    $$\n    \\det(A) = 0.5(0.04) - 0.3(-0.04) + 0.2(-0.06) = 0.02 + 0.012 - 0.012 = 0.02\n    $$\n    Since $\\det(A) \\neq 0$, the matrix $A$ is invertible, which implies that a unique solution to the linear system exists. The problem then correctly asks to check if this unique solution satisfies the nonnegativity constraints.\n-   **Objective:** The problem is stated using precise, objective, and standard scientific terminology. It is free of ambiguity or subjective claims.\n-   **Other Flaws:** The problem does not exhibit any other flaws from the checklist. The data is self-consistent; for instance, the columns of matrix $A$ each sum to $1$, which is expected if $A_{ij}$ represents $P(\\text{class } i | \\text{isoform } j)$ and all fragments are assigned to one of the classes.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe problem requires relating the observed equivalence class counts ($c$) to the unknown transcript fragment counts ($f$) via the compatibility matrix $A$.\n\nLet $f_{j}$ be the unknown number of fragments originating from transcript isoform $T_{j}$. Let $c_{i}$ be the observed number of fragments assigned to equivalence class $E_{i}$. The conditional probability that a fragment originating from isoform $T_{j}$ is compatible with (and thus contributes to) equivalence class $E_{i}$ is given by $A_{ij}$.\n\nThe total expected number of fragments in equivalence class $E_{i}$, denoted $\\mathbb{E}[c_{i}]$, is the sum of the expected contributions from each transcript isoform. The expected contribution from isoform $T_{j}$ to class $E_{i}$ is the product of the total number of fragments from $T_{j}$ and the conditional probability of assignment, i.e., $f_{j} A_{ij}$.\n\nSumming over all isoforms $j \\in \\{1, 2, 3\\}$, we get the total expected count for class $E_{i}$:\n$$\n\\mathbb{E}[c_{i}] = \\sum_{j=1}^{3} A_{ij} f_{j}\n$$\nIn this modeling framework, the observed counts $c_{i}$ are treated as the best estimates for their expected values, $\\mathbb{E}[c_{i}]$. Therefore, we establish the relationship:\n$$\nc_{i} = \\sum_{j=1}^{3} A_{ij} f_{j}\n$$\nThis set of three equations (for $i=1, 2, 3$) can be written in matrix form. Let $c$ be the column vector of observed counts and $f$ be the column vector of unknown isoform counts. The relationship is:\n$$\n\\begin{pmatrix} c_{1} \\\\ c_{2} \\\\ c_{3} \\end{pmatrix} = \\begin{pmatrix}\nA_{11} & A_{12} & A_{13} \\\\\nA_{21} & A_{22} & A_{23} \\\\\nA_{31} & A_{32} & A_{33}\n\\end{pmatrix}\n\\begin{pmatrix} f_{1} \\\\ f_{2} \\\\ f_{3} \\end{pmatrix}\n$$\nThis is the linear system $c = Af$.\n\nNow, we substitute the given numerical values for $A$ and $c$:\n$$\n\\begin{pmatrix}\n0.5 & 0.3 & 0.2 \\\\\n0.2 & 0.4 & 0.4 \\\\\n0.3 & 0.3 & 0.4\n\\end{pmatrix}\n\\begin{pmatrix}\nf_{1} \\\\\nf_{2} \\\\\nf_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix}\n$$\nTo solve for the vector $f$, we must compute the inverse of matrix $A$, denoted $A^{-1}$. The solution is then given by $f = A^{-1}c$. As established during validation, $\\det(A) = 0.02$, so the inverse exists.\n\nThe inverse matrix $A^{-1}$ is calculated via the formula $A^{-1} = \\frac{1}{\\det(A)}\\text{adj}(A)$, where $\\text{adj}(A)$ is the adjugate of $A$ (the transpose of its cofactor matrix).\n\nThe cofactor matrix $C$ of A has entries $C_{ij} = (-1)^{i+j}M_{ij}$, where $M_{ij}$ is the minor of the entry $A_{ij}$.\n$C_{11} = (0.4)(0.4) - (0.4)(0.3) = 0.16 - 0.12 = 0.04$\n$C_{12} = -((0.2)(0.4) - (0.4)(0.3)) = -(0.08 - 0.12) = 0.04$\n$C_{13} = (0.2)(0.3) - (0.4)(0.3) = 0.06 - 0.12 = -0.06$\n$C_{21} = -((0.3)(0.4) - (0.2)(0.3)) = -(0.12 - 0.06) = -0.06$\n$C_{22} = (0.5)(0.4) - (0.2)(0.3) = 0.20 - 0.06 = 0.14$\n$C_{23} = -((0.5)(0.3) - (0.3)(0.3)) = -(0.15 - 0.09) = -0.06$\n$C_{31} = (0.3)(0.4) - (0.2)(0.4) = 0.12 - 0.08 = 0.04$\n$C_{32} = -((0.5)(0.4) - (0.2)(0.2)) = -(0.20 - 0.04) = -0.16$\n$C_{33} = (0.5)(0.4) - (0.3)(0.2) = 0.20 - 0.06 = 0.14$\n\nThe cofactor matrix is $C = \\begin{pmatrix} 0.04 & 0.04 & -0.06 \\\\ -0.06 & 0.14 & -0.06 \\\\ 0.04 & -0.16 & 0.14 \\end{pmatrix}$.\nThe adjugate matrix is the transpose of $C$: $\\text{adj}(A) = C^T = \\begin{pmatrix} 0.04 & -0.06 & 0.04 \\\\ 0.04 & 0.14 & -0.16 \\\\ -0.06 & -0.06 & 0.14 \\end{pmatrix}$.\n\nThe inverse matrix is:\n$$\nA^{-1} = \\frac{1}{0.02} \\begin{pmatrix} 0.04 & -0.06 & 0.04 \\\\ 0.04 & 0.14 & -0.16 \\\\ -0.06 & -0.06 & 0.14 \\end{pmatrix} = 50 \\begin{pmatrix} 0.04 & -0.06 & 0.04 \\\\ 0.04 & 0.14 & -0.16 \\\\ -0.06 & -0.06 & 0.14 \\end{pmatrix} = \\begin{pmatrix} 2 & -3 & 2 \\\\ 2 & 7 & -8 \\\\ -3 & -3 & 7 \\end{pmatrix}\n$$\nNow we compute the solution vector $f = A^{-1}c$:\n$$\n\\begin{pmatrix}\nf_{1} \\\\\nf_{2} \\\\\nf_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 & -3 & 2 \\\\\n2 & 7 & -8 \\\\\n-3 & -3 & 7\n\\end{pmatrix}\n\\begin{pmatrix}\n140 \\\\\n160 \\\\\n150\n\\end{pmatrix}\n$$\nThe components of $f$ are:\n$f_{1} = (2)(140) + (-3)(160) + (2)(150) = 280 - 480 + 300 = 100$\n$f_{2} = (2)(140) + (7)(160) + (-8)(150) = 280 + 1120 - 1200 = 200$\n$f_{3} = (-3)(140) + (-3)(160) + (7)(150) = -420 - 480 + 1050 = 150$\n\nThe solution for the fragment count vector is $f = (100, 200, 150)^T$.\n\nThe final step is to determine if this solution satisfies the nonnegativity constraints:\n$f_{1} = 100 \\ge 0$\n$f_{2} = 200 \\ge 0$\n$f_{3} = 150 \\ge 0$\nAll components are non-negative, so the system admits a valid, physically meaningful solution. The unique solution for the fragment count vector is indeed $(100, 200, 150)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n100 & 200 & 150\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Quantification pipelines report results in normalized units like Transcripts Per Million (TPM) to account for differences in transcript length and library size. To build a deep intuition for what these values mean, this final exercise challenges you to work backwards from the final output to the raw data . Given TPM values, transcript lengths, and total fragment counts for a gene, you will calculate the underlying isoform-specific fragment counts, reinforcing the precise relationships between molecular abundance, gene structure, and sequencing data.",
            "id": "4393435",
            "problem": "A cancer-relevant gene has three annotated messenger RNA isoforms with effective transcript lengths (in nucleotides) determined from the fragment length distribution: isoform $1$ has length $L_{1} = 900$, isoform $2$ has length $L_{2} = 600$, and isoform $3$ has length $L_{3} = 750$. In a single RNA sequencing (RNA-Seq) sample, isoform-level abundances were quantified by a standard method that reports Transcripts Per Million (TPM) values, yielding the vector $\\left(T_{1}, T_{2}, T_{3}\\right) = \\left(20, 30, 10\\right)$ for these isoforms. A total of $F = 4350$ fragments were mapped to this gene.\n\nStarting from the definitions of per-length normalized abundance and Transcripts Per Million (TPM), assume uniform sampling of fragments across each isoform’s effective length and that all fragments mapped to this gene originate from these three isoforms. Under these assumptions, compute the isoform-level fragment counts $\\left(r_{1}, r_{2}, r_{3}\\right)$ that are consistent with the given TPM values, effective lengths, and total mapped fragments, and verify mass conservation across the isoforms and the gene. Express the count for isoform $3$ as an integer number of fragments in your final answer.",
            "solution": "The problem requires the calculation of isoform-specific fragment counts from given Transcripts Per Million (TPM) values, effective transcript lengths, and the total number of fragments mapped to a gene. The solution involves reversing the standard TPM calculation under the stated assumptions.\n\nLet $r_i$ be the number of fragments originating from isoform $i$, and let $L_i$ be its effective length. The total number of fragments mapped to the gene is $F = \\sum_{i} r_i$. We are given three isoforms, so $i \\in \\{1, 2, 3\\}$.\n\nThe core assumption in RNA sequencing (RNA-Seq) quantification is that the number of fragments $r_i$ sampled from a transcript isoform $i$ is proportional to both its molar concentration (abundance, denoted $\\eta_i$) and its effective length $L_i$. That is, $r_i \\propto \\eta_i L_i$. This implies that the molar concentration is proportional to the fragment count normalized by length: $\\eta_i \\propto \\frac{r_i}{L_i}$.\n\nTranscripts Per Million (TPM) is a measure of transcript abundance that normalizes for both sequencing depth and transcript length. The TPM for a transcript $i$, denoted $T_i$, is defined as its length-normalized abundance, scaled by a factor that makes the sum of all TPM values across all transcripts in the sample equal to $1,000,000$.\n\nThe length-normalized abundance for isoform $i$ is proportional to $\\frac{r_i}{L_i}$. The TPM value $T_i$ is therefore directly proportional to this quantity:\n$$ T_i = C \\cdot \\frac{r_i}{L_i} $$\nwhere $C$ is a normalization constant that is the same for all transcripts in a given sample. This constant is calculated as $C = \\frac{10^6}{\\sum_{j} (r_j/L_j)}$, where the sum is over all transcripts in the entire sample.\n\nA key property of this definition is that the ratio of TPM values for any two transcripts depends only on their respective fragment counts and lengths, as the constant $C$ cancels out:\n$$ \\frac{T_i}{T_k} = \\frac{C \\cdot (r_i / L_i)}{C \\cdot (r_k / L_k)} = \\frac{r_i / L_i}{r_k / L_k} $$\nThis relationship is independent of any other transcripts in the sample and holds for the isoforms of our specific gene. From this, we can express the fragment count $r_i$ in terms of its TPM and length:\n$$ r_i = L_i \\cdot \\frac{T_i}{T_k} \\cdot \\frac{r_k}{L_k} $$\nThis shows that the quantity $r_i / (T_i L_i)$ is constant for all isoforms. Let's call this constant $k$:\n$$ k = \\frac{r_i}{T_i L_i} \\implies r_i = k \\cdot (T_i L_i) $$\n\nWe are given that the total number of fragments mapped to this gene is $F$. Under the assumption that all these fragments originate from the three specified isoforms, we have:\n$$ F = \\sum_{i=1}^{3} r_i $$\nSubstituting the expression for $r_i$ in terms of $k$:\n$$ F = \\sum_{i=1}^{3} k \\cdot (T_i L_i) = k \\sum_{i=1}^{3} (T_i L_i) $$\nWe can now solve for the constant of proportionality, $k$:\n$$ k = \\frac{F}{\\sum_{j=1}^{3} (T_j L_j)} $$\nOnce $k$ is determined, we can calculate the individual fragment count for each isoform $i$:\n$$ r_i = k \\cdot (T_i L_i) = \\frac{F}{\\sum_{j=1}^{3} (T_j L_j)} \\cdot (T_i L_i) $$\n\nNow, we substitute the given values into this formula.\nThe givens are:\n- Effective lengths: $L_{1} = 900$, $L_{2} = 600$, $L_{3} = 750$.\n- TPM values: $T_{1} = 20$, $T_{2} = 30$, $T_{3} = 10$.\n- Total mapped fragments for the gene: $F = 4350$.\n\nFirst, we compute the term $T_i L_i$ for each isoform:\n- For isoform $1$: $T_1 L_1 = 20 \\times 900 = 18000$.\n- For isoform $2$: $T_2 L_2 = 30 \\times 600 = 18000$.\n- For isoform $3$: $T_3 L_3 = 10 \\times 750 = 7500$.\n\nNext, we compute the sum in the denominator:\n$$ \\sum_{j=1}^{3} (T_j L_j) = T_1 L_1 + T_2 L_2 + T_3 L_3 = 18000 + 18000 + 7500 = 43500 $$\n\nNow, we calculate the proportionality constant $k$:\n$$ k = \\frac{F}{43500} = \\frac{4350}{43500} = \\frac{1}{10} = 0.1 $$\n\nFinally, we use $k$ to compute the fragment count for each isoform:\n- Isoform $1$: $r_1 = k \\cdot (T_1 L_1) = 0.1 \\times 18000 = 1800$.\n- Isoform $2$: $r_2 = k \\cdot (T_2 L_2) = 0.1 \\times 18000 = 1800$.\n- Isoform $3$: $r_3 = k \\cdot (T_3 L_3) = 0.1 \\times 7500 = 750$.\n\nThe resulting isoform-level fragment counts are $(r_1, r_2, r_3) = (1800, 1800, 750)$.\n\nThe problem also requires verification of mass conservation. This means the sum of the calculated isoform fragment counts must equal the total number of fragments mapped to the gene.\n$$ \\sum_{i=1}^{3} r_i = r_1 + r_2 + r_3 = 1800 + 1800 + 750 = 4350 $$\nThis sum is indeed equal to the given total fragment count $F = 4350$. Thus, mass conservation is verified.\n\nThe question asks for the fragment count for isoform $3$, which is $r_3$.\n$$ r_3 = 750 $$\nThis is an integer number of fragments, as expected.",
            "answer": "$$\\boxed{750}$$"
        }
    ]
}