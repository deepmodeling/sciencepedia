{
    "hands_on_practices": [
        {
            "introduction": "在表观遗传生物标志物的开发中，一个基础步骤是精确量化单个CpG位点的甲基化水平。本练习将引导您处理亚硫酸氢盐测序产生的原始读数计数，这是一种表观遗传学研究中的核心技术。您将学习如何将简单的点估计扩展为包含统计不确定性的置信区间，这是对位点甲基化状态进行稳健分类和确保下游分析可靠性的关键实践()。",
            "id": "4332324",
            "problem": "您的任务是为一个亚硫酸氢盐测序流程中的比对后统计评估模块进行形式化。在实践中，该流程将使用 Bismark 软件进行读取比对和甲基化调用。在精准医疗的胞嘧啶-磷酸-鸟嘌呤（CpG）甲基化生物标志物开发背景下，假设对于每个 CpG 位点，甲基化调用器都会生成甲基化读取和未甲基化读取的非负整数计数。根据标准的建模假设，每个与 CpG 位点重叠的读取都会产生一个独立的伯努利结果（甲基化或未甲基化），其未知参数 $p$ 代表该 CpG 位点的真实甲基化比例。因此，在该位点的 $n$ 个总读取中，甲基化读取的总数 $X$ 被建模为具有参数 $(n,p)$ 的二项分布随机变量的实现。\n\n您的任务是编写一个完整的程序，对于一组固定的 CpG 位点，计算甲基化比例的点估计和一个使用 Clopper–Pearson 方法在显著性水平 $\\alpha$ 下的精确双边等尾置信区间（CI），然后根据该区间以及用户指定的低甲基化和高甲基化阈值，将每个 CpG 分类为三个类别之一。具体来说，程序必须：\n\n- 对于每个具有甲基化计数 $x$ 和未甲基化计数 $y$ 的 CpG，计算总覆盖度 $n = x + y$。\n- 对于覆盖度 $n$ 严格小于最小覆盖度阈值 $n_{\\min}$ 的 CpG，通过返回下方指定的哨兵结果将其排除。\n- 对于通过覆盖度筛选的 CpG，计算甲基化点估计 $\\hat{p} = x / n$。\n- 通过反转二项模型，计算 $p$ 的双边精确 Clopper–Pearson $(1 - \\alpha)$ 置信区间 $\\left[L, U\\right]$。\n- 使用基于区间的逻辑以及阈值 $t_{\\text{low}}$ 和 $t_{\\text{high}}$（其中 $0 \\le t_{\\text{low}} < t_{\\text{high}} \\le 1$）对 CpG 进行分类：\n  - 如果 $U < t_{\\text{low}}$，则分类为低甲基化，并返回分类代码 $0$。\n  - 否则，如果 $L > t_{\\text{high}}$，则分类为高甲基化，并返回分类代码 $2$。\n  - 否则，分类为不明确，并返回分类代码 $1$。\n\n对于不满足最小覆盖度的 CpG，返回哨兵列表 $[-1.0, -1.0, -1.0, -1]$。\n\n每个浮点数输出必须四舍五入到六位小数。所有甲基化比例、置信区间界限和阈值都必须以 $[0,1]$ 范围内的小数表示（而非百分比）。\n\n对所有测试用例使用以下固定参数：\n- 显著性水平 $\\alpha = 0.05$，用于 $(1 - \\alpha) = 0.95$ 的置信区间。\n- 最小覆盖度 $n_{\\min} = 5$。\n- 阈值 $t_{\\text{low}} = 0.30$ 和 $t_{\\text{high}} = 0.70$。\n\n需要实现和评估的测试套件：\n- 情况 1：$(x, y) = (12, 8)$，因此 $n = 20$。\n- 情况 2：$(x, y) = (0, 20)$，因此 $n = 20$。\n- 情况 3：$(x, y) = (20, 0)$，因此 $n = 20$。\n- 情况 4：$(x, y) = (1, 2)$，因此 $n = 3$。\n- 情况 5：$(x, y) = (3, 7)$，因此 $n = 10$。\n- 情况 6：$(x, y) = (15, 15)$，因此 $n = 30$。\n\n您的程序必须生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中不含嵌入的空格。每个测试用例的结果必须是一个包含四个值的列表，形式为 $[\\hat{p}, L, U, c]$，其中 $\\hat{p}$ 是甲基化比例估计值， $L$ 和 $U$ 是 Clopper–Pearson 置信区间的下界和上界， $c$ 是如上定义的分类代码。最终输出的格式必须严格遵循：\n\"[[p1,L1,U1,c1],[p2,L2,U2,c2],[p3,L3,U3,c3],[p4,L4,U4,c4],[p5,L5,U5,c5],[p6,L6,U6,c6]]\"\n所有浮点数四舍五入到六位小数，且字符串中不含任何空格。",
            "solution": "该问题要求对亚硫酸氢盐测序数据的统计评估模块进行形式化和实现，这是表观遗传学研究中的一项常见任务。我们将首先验证问题的科学性和数学合理性，然后基于已建立的统计学原理构建解决方案。\n\n### 问题形式化与模型\n\n该问题的核心是分析特定 CpG 位点的 DNA 甲基化。对于每个位点，数据由亚硫酸氢盐测序得到的甲基化读取数 $x$ 和未甲基化读取数 $y$ 组成。\n\n覆盖该位点的总读取数，即覆盖度，为 $n = x+y$。我们将每次读取建模为一次独立的伯努利试验，其结果为“甲基化”的恒定未知概率为 $p$，$p$ 代表该 CpG 位点的真实甲基化比例。在此模型下，对于给定的覆盖度 $n$，甲基化读取的总数 $X$ 是一个服从二项分布的随机变量：\n$$ X \\sim \\text{Binomial}(n, p) $$\n其概率质量函数为：\n$$ P(X=k | n, p) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n\n任务是为一系列由 $(x,y)$ 计数定义的 CpG 位点执行以下步骤：\n1.  应用最小覆盖度筛选。\n2.  计算甲基化比例 $p$ 的点估计。\n3.  计算 $p$ 的双边置信区间。\n4.  基于置信区间对 CpG 位点的甲基化状态进行分类。\n\n### 逐步求解推导\n\n#### 1. 覆盖度筛选\n为保证统计推断的可靠性，最小覆盖度是必要的。问题指定了最小覆盖度阈值 $n_{\\min}$。任何覆盖度 $n = x+y < n_{\\min}$ 的 CpG 位点都将被排除在进一步分析之外。对于此类位点，返回哨兵结果 $[-1.0, -1.0, -1.0, -1]$。给定的值为 $n_{\\min}=5$。\n\n#### 2. 点估计\n对于通过覆盖度筛选（$n \\ge n_{\\min}$）的 CpG 位点，我们估计真实的甲基化比例 $p$。二项分布比例参数 $p$ 的最大似然估计（MLE）是样本比例：\n$$ \\hat{p} = \\frac{x}{n} $$\n这作为我们对甲基化水平的点估计。\n\n#### 3. Clopper-Pearson 置信区间\n点估计 $\\hat{p}$ 提供了一个单一值，但没有关于其不确定性的信息。置信区间（CI）为真实参数 $p$ 提供了一个合理的取值范围。问题指定了 Clopper-Pearson 方法，该方法通过反转二项检验来生成一个“精确”区间。\n\n对于 $(1-\\alpha)$ 的置信水平，双边等尾 Clopper-Pearson 区间 $[L, U]$ 的构造使其下界 $L$ 和上界 $U$ 满足以下方程：\n$$ P(X \\ge x | n, L) = \\sum_{k=x}^{n} \\binom{n}{k} L^k (1-L)^{n-k} = \\frac{\\alpha}{2} $$\n$$ P(X \\le x | n, U) = \\sum_{k=0}^{x} \\binom{n}{k} U^k (1-U)^{n-k} = \\frac{\\alpha}{2} $$\n这些方程将 $L$ 定义为使得观察到 $x$ 或更多甲基化读取的事件不至于异常罕见（概率不小于 $\\alpha/2$）的最大比例；将 $U$ 定义为使得观察到 $x$ 或更少甲基化读取的事件不至于异常罕见的最小比例。\n\n这些方程需要求解 $L$ 和 $U$。二项分布的累积分布函数（CDF）与正则化不完全贝塔函数 $I_z(a,b)$ 的关系如下：\n$$ \\sum_{k=x}^{n} \\binom{n}{k} p^k (1-p)^{n-k} = I_p(x, n-x+1) $$\n$$ \\sum_{k=0}^{x} \\binom{n}{k} p^k (1-p)^{n-k} = 1 - I_p(x+1, n-x) $$\n将这些关系代入 CI 界限的定义方程中，得到：\n$$ I_L(x, n-x+1) = \\frac{\\alpha}{2} $$\n$$ 1 - I_U(x+1, n-x) = \\frac{\\alpha}{2} \\implies I_U(x+1, n-x) = 1 - \\frac{\\alpha}{2} $$\n求解 $L$ 和 $U$ 需要找到正则化不完全贝塔函数的反函数，即贝塔分布的分位数函数（或百分点函数，PPF）。\n因此，$L$ 是形状参数为 $(x, n-x+1)$ 的贝塔分布的 $\\alpha/2$ 分位数，$U$ 是形状参数为 $(x+1, n-x)$ 的贝塔分布的 $(1-\\alpha/2)$ 分位数。\n\n界限由以下公式给出：\n$$ L = \\text{Beta.PPF}\\left(\\frac{\\alpha}{2}; x, n-x+1\\right) $$\n$$ U = \\text{Beta.PPF}\\left(1-\\frac{\\alpha}{2}; x+1, n-x\\right) $$\n\n必须处理特殊的边界情况：\n-   如果 $x=0$，则下界为 $L=0$。\n-   如果 $x=n$，则上界为 $U=1$。\n\n问题指定 $\\alpha=0.05$，因此我们使用 $\\alpha/2=0.025$ 和 $1-\\alpha/2=0.975$ 计算 $95\\%$ 的置信区间。\n\n#### 4. 基于区间的分类\n最后一步是将每个 CpG 位点分为三类之一：低甲基化、不明确或高甲基化。这种分类不是基于点估计 $\\hat{p}$，而是基于置信区间 $[L, U]$，因为它包含了统计不确定性。这是一种更保守且稳健的方法。\n\n给定阈值 $t_{\\text{low}}$ 和 $t_{\\text{high}}$（其中 $0 \\le t_{\\text{low}} < t_{\\text{high}} \\le 1$），分类规则如下：\n-   **低甲基化（代码 $0$）**：如果我们确信真实比例 $p$ 低于 $t_{\\text{low}}$。这在整个置信区间都低于该阈值时发生：$U < t_{\\text{low}}$。\n-   **高甲基化（代码 $2$）**：如果我们确信真实比例 $p$ 高于 $t_{\\text{high}}$。这在整个置信区间都高于该阈值时发生：$L > t_{\\text{high}}$。\n-   **不明确（代码 $1$）**：在所有其他情况下。这包括跨越一个或两个阈值的区间，表明数据不足以作出低甲基化或高甲基化的高置信度判断。\n\n问题指定 $t_{\\text{low}}=0.30$ 和 $t_{\\text{high}}=0.70$。\n\n这个系统化步骤将点估计与严格的不确定性量化相结合，以产生稳健的分类，这是开发可靠的表观遗传生物标志物的关键组成部分。实现将遵循这些推导出的步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Computes methylation statistics and classifies CpG sites based on bisulfite sequencing read counts.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    alpha = 0.05\n    n_min = 5\n    t_low = 0.30\n    t_high = 0.70\n\n    # --- Test Suite ---\n    test_cases = [\n        (12, 8),   # Case 1\n        (0, 20),   # Case 2\n        (20, 0),   # Case 3\n        (1, 2),    # Case 4\n        (3, 7),    # Case 5\n        (15, 15),  # Case 6\n    ]\n\n    results = []\n    for x, y in test_cases:\n        n = x + y\n\n        # Step 1: Coverage Filtering\n        if n < n_min:\n            results.append([-1.0, -1.0, -1.0, -1])\n            continue\n\n        # Step 2: Point Estimate\n        p_hat = x / n\n\n        # Step 3: Clopper-Pearson Confidence Interval\n        alpha_half = alpha / 2.0\n\n        # Handle edge cases for L and U bounds\n        if x == 0:\n            lower_bound = 0.0\n        else:\n            lower_bound = beta.ppf(alpha_half, x, n - x + 1)\n\n        if x == n:\n            upper_bound = 1.0\n        else:\n            upper_bound = beta.ppf(1 - alpha_half, x + 1, n - x)\n        \n        # Step 4: Interval-Based Classification\n        if upper_bound < t_low:\n            classification_code = 0  # Hypomethylated\n        elif lower_bound > t_high:\n            classification_code = 2  # Hypermethylated\n        else:\n            classification_code = 1  # Ambiguous\n            \n        results.append([p_hat, lower_bound, upper_bound, classification_code])\n\n    # --- Format final output string ---\n    results_str_list = []\n    for res in results:\n        if res == [-1.0, -1.0, -1.0, -1]:\n            # Handle sentinel case formatting as specified\n            results_str_list.append(\"[-1.0,-1.0,-1.0,-1]\")\n        else:\n            p_hat, l_bound, u_bound, code = res\n            # Round floats to six decimal places for all other cases\n            p_str = f\"{p_hat:.6f}\"\n            l_str = f\"{l_bound:.6f}\"\n            u_str = f\"{u_bound:.6f}\"\n            c_str = str(code)\n            results_str_list.append(f\"[{p_str},{l_str},{u_str},{c_str}]\")\n\n    # Combine all results into a single line string\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "量化甲基化水平后，下一个关键挑战是解释其变化的根源。本练习探讨甲基化数量性状位点 (meQTLs) 这一核心概念，即遗传变异本身（而非独立的表观遗传调控）决定了甲基化水平。理解如何识别并解释这种由遗传因素引起的混杂效应()，对于在疾病研究中区分真正的表观遗传信号与遗传假象至关重要。",
            "id": "4332306",
            "problem": "在精准医疗和基因组诊断中，甲基化数量性状基因座对于解读与疾病相关的表观遗传变异至关重要。请考虑以下基础知识和情景。\n\n基础知识：\n- 胞嘧啶-磷酸-鸟嘌呤（CpG）二核苷酸是5-甲基胞嘧啶（5mC）的主要基因组背景。根据化学定义，胞嘧啶第$5$位的甲基化要求CpG二联体中必须存在一个胞嘧啶碱基。如果一个单核苷酸多态性（SNP）将胞嘧啶转化为胸腺嘧啶（$\\mathrm{C}\\rightarrow\\mathrm{T}$）或将其鸟嘌呤伴侣转化为腺嘌呤（$\\mathrm{G}\\rightarrow\\mathrm{A}$），则该CpG位点被破坏，突变链上无法携带5mC。\n- 亚硫酸氢钠转化会将未甲基化的胞嘧啶脱氨基为尿嘧啶，后者在聚合酶和测序中被读取为胸腺嘧啶，而甲基化的胞嘧啶则受到保护。因此，在转化和测序或芯片杂交后，一个胸腺嘧啶信号既可能反映原始未甲基化的胞嘧啶，也可能反映由SNP引入的真实胸腺嘧啶；如果没有额外的序列背景信息，该检测方法本身无法区分这些来源。\n- 数量性状基因座是指遗传变异可以解释数量表型方差的基因组位点。甲基化数量性状基因座（meQTL）指的是数量性状为一个或多个CpG位点DNA甲基化水平的情况。\n\n情景：\n您正在对一个邻近疾病基因的CpG位点 $C^{\\ast}$ 进行病例-对照全表观基因组关联研究（EWAS）。附近的一个变异 $V$ 是一个CpG破坏性SNP，其替代等位基因存在时会破坏 $C^{\\ast}$ 中的胞嘧啶。设 $G\\in\\{0,1,2\\}$ 表示基因型，编码为 $V$ 位点上CpG破坏性等位基因的数量。假设一个完整的CpG位点上，每个等位基因的基线甲基化概率为 $m_{0}$，其中 $0 < m_{0} < 1$。被破坏的等位基因的甲基化贡献为零。总甲基化水平是两个等位基因的平均值。\n\n您还被告知，疾病状态对CpG位点 $C^{\\ast}$ 的甲基化没有直接的因果效应。然而，变异 $V$ 与一个真正的疾病易感变异 $D$ 处于连锁不平衡（LD）状态，导致 $V$ 的基因型频率在病例组和对照组之间存在差异：\n- 病例组：$\\Pr(G=0)=0.25, \\Pr(G=1)=0.50, \\Pr(G=2)=0.25$\n- 对照组：$\\Pr(G=0)=0.49, \\Pr(G=1)=0.42, \\Pr(G=2)=0.09$\n如果 $m_0=0.70$，则病例组的甲基化水平会比对照组低多少？在EWAS中观察到的甲基化水平差异的根本原因是什么？确定下面哪些陈述是正确的（可能有多个）。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、阐述清晰且客观的。它呈现了统计基因组学和表观遗传学领域中的一个现实情景。我们现在可以开始进行解答。\n\n这个问题的核心是全表观基因组关联研究（EWAS）中的一个经典混杂案例。我们被告知疾病对CpG位点 $C^{\\ast}$ 的甲基化没有直接的因果效应。然而，一个遗传变异 $V$ 破坏了该CpG位点，并且这个变异与一个真正的疾病相关变异 $D$ 处于连锁不平衡（LD）状态。这导致病例组和对照组中 $V$ 的基因型分布不同，从而在疾病状态和 $C^{\\ast}$ 的甲基化之间产生了虚假的关联。\n\n设 $M$ 为测得的甲基化水平，其范围可以从0到1。基因型 $G \\in \\{0, 1, 2\\}$ 代表个体携带的CpG破坏性等位基因的数量。问题陈述，一个完整等位基因上的甲基化概率为 $m_0 = 0.70$，而被破坏的等位基因的甲基化贡献为零。总甲基化水平是两个等位基因的平均值。\n\n给定基因型 $G$ 的预期甲基化水平为：\n- 对于 $G=0$（两个完整等位基因）：$E[M|G=0] = \\frac{m_0 + m_0}{2} = m_0$\n- 对于 $G=1$（一个完整，一个被破坏的等位基因）：$E[M|G=1] = \\frac{m_0 + 0}{2} = \\frac{m_0}{2}$\n- 对于 $G=2$（两个被破坏的等位基因）：$E[M|G=2] = \\frac{0 + 0}{2} = 0$\n\n现在我们可以使用全期望定律和给定的基因型频率来计算病例组和对照组的预期甲基化水平。\n\n病例组的预期甲基化：\n$$E[M|\\text{Case}] = \\sum_{g=0}^{2} E[M|G=g] \\cdot \\Pr(G=g|\\text{Case})$$\n$$E[M|\\text{Case}] = (m_0 \\cdot \\Pr(G=0|\\text{Case})) + (\\frac{m_0}{2} \\cdot \\Pr(G=1|\\text{Case})) + (0 \\cdot \\Pr(G=2|\\text{Case}))$$\n使用为病例组提供的概率（$\\Pr(G=0)=0.25$, $\\Pr(G=1)=0.50$, $\\Pr(G=2)=0.25$）和 $m_0 = 0.70$：\n$$E[M|\\text{Case}] = (0.70 \\cdot 0.25) + (\\frac{0.70}{2} \\cdot 0.50) + (0 \\cdot 0.25)$$\n$$E[M|\\text{Case}] = (0.175) + (0.35 \\cdot 0.50) + 0 = 0.175 + 0.175 = 0.35$$\n\n对照组的预期甲基化：\n$$E[M|\\text{Control}] = \\sum_{g=0}^{2} E[M|G=g] \\cdot \\Pr(G=g|\\text{Control})$$\n使用为对照组提供的概率（$\\Pr(G=0)=0.49$, $\\Pr(G=1)=0.42$, $\\Pr(G=2)=0.09$）和 $m_0 = 0.70$：\n$$E[M|\\text{Control}] = (0.70 \\cdot 0.49) + (\\frac{0.70}{2} \\cdot 0.42) + (0 \\cdot 0.09)$$\n$$E[M|\\text{Control}] = (0.343) + (0.35 \\cdot 0.42) + 0 = 0.343 + 0.147 = 0.49$$\n\n我们的计算表明，病例组的预期甲基化水平（$0.35$）显著低于对照组（$0.49$）。病例组中这种明显的“低甲基化”并非由疾病的表观遗传效应引起，而完全是由于病例组中CpG破坏性等位基因频率较高所致。这证实了所描述的混杂情景。我们现在将评估每个选项。\n\n***\n\n**A. 甲基化数量性状基因座是这样一个位点：其遗传变异与一个或多个顺式或反式CpG位点的DNA甲基化定量水平相关；一个CpG破坏性SNP（$\\mathrm{C}\\rightarrow\\mathrm{T}$ 或 $\\mathrm{G}\\rightarrow\\mathrm{A}$）会移除受影响等位基因上的甲基受体胞嘧啶，从而强制引起等位基因特异性低甲基化。如果疾病状态通过连锁不平衡与该破坏性等位基因相关联，那么在没有任何因果性表观遗传效应的情况下，也可能出现病例-对照组间的甲基化差异。过滤与SNP重叠的探针、在回归分析中对 $V$ 的基因型进行校正，以及利用杂合子中的等位基因特异性甲基化信息，都是减轻或诊断这种混杂效应的原则性方法。**\n\n- **分析：** 该陈述包含四个部分，所有部分都是正确的。\n  1. 甲基化数量性状基因座（meQTL）的定义是准确的：它描述了遗传变异（基因型）与甲基化水平之间的关联。这种关联可以是局部的（`cis`）或远端的（`trans`）。\n  2. CpG破坏性SNP的机制描述正确。通过移除胞嘧啶（或相邻的鸟嘌呤），该等位基因上用于甲基化的底物被消除，导致该特定DNA链（等位基因）上的甲基化水平被强制为$0$（等位基因特异性低甲基化）。\n  3. 对虚假关联的解释正是问题中详述并在我们上述推导中证实的混杂情景。meQTL变异（$V$）和疾病变异（$D$）之间的连锁不平衡（LD）造成了疾病与甲基化之间的非因果性关联。\n  4. 所提出的减轻和诊断策略都是该领域的标准最佳实践。过滤与已知SNP重叠的探针是EWAS中一个关键的质量控制步骤。在回归模型中对混杂SNP的基因型进行校正是消除混杂的标准统计方法。分析杂合子中的等位基因特异性甲基化是一种强大的实验方法，可以用来确认甲基化差异是由遗传序列本身驱动的。\n- **结论：** 正确。\n\n***\n\n**B. 甲基化数量性状基因座由DNA甲基化和基因表达之间的关联定义。CpG破坏性变异在亚硫酸氢钠转化后不能影响测得的甲基化水平，因为所有未甲基化的胞嘧啶都会被读取为胸腺嘧啶，所以基因型不会混淆甲基化测量。因此，在检验疾病效应时，无需对基因型进行控制。**\n\n- **分析：** 该陈述在多个基本点上都是错误的。\n  1. 这里提供的定义是表达数量性状甲基化（eQTM）的定义，而不是meQTL。meQTL关联的是基因型和甲基化。\n  2. 关于CpG破坏性变异“不能影响测得的甲基化”的说法是错误的。如果一个SNP将胞嘧啶变为胸腺嘧啶（$\\mathrm{C}\\rightarrow\\mathrm{T}$），基因组的那个位置现在就包含一个真正的胸腺嘧啶。在亚硫酸氢盐测序实验中，这将被读作‘T’，就像一个未甲基化的胞嘧啶转化为尿嘧啶然后被读作‘T’一样。这意味着SNP直接导致该等位基因上测得的甲基化为$0$，从而深刻地影响了测量结果。断言基因型不混淆甲基化测量与事实恰恰相反。\n  3. 因此，认为无需控制基因型的结论是极其错误的。\n- **结论：** 不正确。\n\n***\n\n**C. 甲基化数量性状基因座要求疾病直接改变该位点的甲基化；CpG破坏性变异只影响探针杂交，而不影响潜在的DNA甲基化生物学过程，因此，无论其与疾病变异的连锁不平衡程度如何，过滤掉次要等位基因频率低于0.05的变异就足以消除虚假关联。**\n\n- **分析：** 该陈述不正确。\n  1. 定义是错误的。meQTL由基因型-甲基化关联定义，与疾病无关。疾病-甲基化关联是在EWAS中研究的。\n  2. 声称CpG破坏性变异“只影响探针杂交，而不影响潜在的DNA甲基化生物学过程”是错误的。虽然它们可以影响微阵列上的探针杂交，但它们的主要效应是生物学上的：它们移除了作为DNA甲基转移酶底物的胞嘧啶。这是对该位点甲基化生物学的根本性改变。\n  3. 提议的解决方案是不充分的。基于固定的次要等位基因频率（MAF）阈值（如$0.05$）进行过滤，并不是处理此类混杂的有效或有针对性的方法。在该情景中，混杂SNP在病例组（$p=0.50$）和对照组（$p=0.30$）中都很常见，因此不会被过滤掉。任何频率的SNP都可能引起混杂。\n- **结论：** 不正确。\n\n***\n\n**D. 甲基化数量性状基因座是基因型与甲基化之间的关联，但仅限于启动子区域；CpG破坏性变异通过阻断亚硫酸氢钠转化来增加测得的甲基化水平，从而人为地夸大携带者中的甲基化。仅对估计的细胞类型组成进行校正即可消除这种偏倚。**\n\n- **分析：** 该陈述不正确。\n  1. meQTL的定义被错误地限制在“仅在启动子区域”。meQTL遍布整个基因组。\n  2. 描述的效应与实际情况相反。一个CpG破坏性变异导致胞嘧啶位置出现胸腺嘧啶（或者通过$\\mathrm{C}\\rightarrow\\mathrm{T}$ SNP直接产生，或者通过$\\mathrm{G}\\rightarrow\\mathrm{A}$ SNP使位点变为非CpG位点而等效产生）。这个T被解释为未甲基化信号，因此会*降低*测得的甲基化水平（beta值），而不是增加它。\n  3. 提议的解决方案与问题无关。为细胞类型组成进行校正是EWAS中纠正细胞类型异质性混杂的关键步骤，但它与CpG位点本身基因型造成的混杂是两个不同的问题。它无法消除所述的遗传偏倚。\n- **结论：** 不正确。\n\n***\n\n**E. 在上述情景中，即使疾病对甲基化没有真实的效应，基因型分布的差异也会纯粹由于完整CpG等位基因的丢失而导致病例组的预期甲基化水平较低。一个将甲基化水平对疾病和 $G$ 进行建模的线性模型可以消除这种偏倚，因为在所述假设下，甲基化的期望值是完整等位基因数量的线性函数。使用跨越 $V$ 和 $C^{\\ast}$ 的定相读段进行等位基因特异性甲基化分析，可以经验性地显示完整等位基因上的甲基化和被破坏等位基因上的甲基化缺失，从而区分序列驱动的效应和表观遗传的疾病效应。**\n\n- **分析：** 该陈述完全正确，并提供了精确的定量和方法论总结。\n  1. 第一句话正确地指出了混杂的结果：“病例组的预期甲基化水平较低”，我们最初的计算证实了这一点（$0.35$ vs. $0.49$）。\n  2. 第二句话正确地论证了使用线性模型的合理性。预期甲基化 $E[M|G] = m_0 - (m_0/2)G$ 是基因型剂量 $G$ 的线性函数。因此，在回归模型 `Methylation ~ Disease + G` 中将 $G$ 作为协变量，是校正基因型混杂效应的统计学上有效的方法。\n  3. 第三句话描述了一种复杂而强大的实验验证方法。等位基因特异性分析通过区分来自参考（完整）等位基因和替代（被破坏）等位基因的读段，为遗传机制提供了直接的经验证据。这是区分此类人为假象与真正与疾病相关的调控性表观遗传变化的决定性方法。\n- **结论：** 正确。",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "表观遗传生物标志物的发现通常涉及对数千个CpG位点进行并行筛选。这种高通量方法带来了一个重大的统计挑战：多重比较问题。在本练习中，您将应用Benjamini-Hochberg程序()，这是一种控制假发现率（False Discovery Rate, FDR）的标准化方法，目的是从大量潜在的候选位点中筛选出统计上可靠的生物标志物。",
            "id": "4332313",
            "problem": "在为一种复杂疾病开发基于血液的表观遗传生物标志物组时，您需要测量病例组和对照组中一组胞嘧啶-磷酸-鸟嘌呤 (CpG) 二核苷酸的差异性DNA甲基化。对于每个CpG位点，您将效应量估计为病例组和对照组之间甲基化分数的差异，并计算一个无差异的双边假设检验，从而在原假设下得到一个有效的p值。假设在Benjamini–Hochberg (BH) 程序控制错误发现率 (FDR) 所需的独立性（或正相关性）条件成立。错误发现率 (FDR) 定义为在所有声称的发现中，错误发现的期望比例。\n\n您获得了以下逐个CpG位点的结果（效应量对于多重检验计算不是必需的，但为完整起见在此显示）：CpG-A：效应量 $+0.12$，p值 $0.0205$；CpG-B：效应量 $-0.07$，p值 $0.043$；CpG-C：效应量 $+0.04$，p值 $0.0317$；CpG-D：效应量 $-0.15$，p值 $0.00082$；CpG-E：效应量 $+0.03$，p值 $0.081$；CpG-F：效应量 $-0.10$，p值 $0.0127$；CpG-G：效应量 $+0.05$，p值 $0.0047$；CpG-H：效应量 $-0.11$，p值 $0.00031$；CpG-I：效应量 $+0.02$，p值 $0.150$；CpG-J：效应量 $-0.06$，p值 $0.0068$；CpG-K：效应量 $+0.09$，p值 $0.00095$；CpG-L：效应量 $-0.08$，p值 $0.0021$。\n\n使用Benjamini–Hochberg方法在目标水平 $q=0.05$ 控制错误发现率，计算BH决策阈值。该阈值定义为最大的p值 $t$，使得所有小于或等于 $t$ 的p值在FDR水平 $q$ 下都被认为是显著的。将 $t$ 报告为一个纯数字。将您的答案四舍五入到四位有效数字。",
            "solution": "目标是，在目标错误发现率 (FDR) 水平 $q=0.05$ 下，使用Benjamini–Hochberg (BH) 程序确定最大的p值阈值 $t$，使得所有p值满足 $p \\le t$ 的检验都被判为显著，从而将FDR控制在指定水平。\n\n基本上，错误发现率 (FDR) 是错误发现数与总发现数之比的期望值。当原假设下的p值是独立的（或满足某些正相关条件）时，BH程序是一种经过充分检验的方法，可将FDR控制在水平 $q$。BH方法的构建过程是：将观察到的 $m$ 个p值按升序排列，$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$，并找出满足 $p_{(k)} \\le \\frac{k}{m} q$ 的最大索引 $k$。那么决策阈值就是 $t = p_{(k)}$，所有满足 $p \\le t$ 的检验都被视为发现。\n\n我们有 $m=12$ 个检验。提取p值（忽略用于多重性校正的效应量）：$0.0205, 0.043, 0.0317, 0.00082, 0.081, 0.0127, 0.0047, 0.00031, 0.150, 0.0068, 0.00095, 0.0021$。\n\n将它们按升序排序：\n- $p_{(1)}=0.00031$\n- $p_{(2)}=0.00082$\n- $p_{(3)}=0.00095$\n- $p_{(4)}=0.0021$\n- $p_{(5)}=0.0047$\n- $p_{(6)}=0.0068$\n- $p_{(7)}=0.0127$\n- $p_{(8)}=0.0205$\n- $p_{(9)}=0.0317$\n- $p_{(10)}=0.043$\n- $p_{(11)}=0.081$\n- $p_{(12)}=0.150$.\n\n计算BH临界值 $\\frac{k}{m}q = \\frac{k}{12}\\cdot 0.05$（对于 $k=1,\\dots,12$）并进行比较：\n- $k=1$: $\\frac{1}{12}\\cdot 0.05 \\approx 0.004166\\overline{6}$，且 $0.00031 \\le 0.004166\\overline{6}$，满足。\n- $k=2$: $\\frac{2}{12}\\cdot 0.05 \\approx 0.008333\\overline{3}$，且 $0.00082 \\le 0.008333\\overline{3}$，满足。\n- $k=3$: $\\frac{3}{12}\\cdot 0.05 = 0.0125$，且 $0.00095 \\le 0.0125$，满足。\n- $k=4$: $\\frac{4}{12}\\cdot 0.05 \\approx 0.016666\\overline{6}$，且 $0.0021 \\le 0.016666\\overline{6}$，满足。\n- $k=5$: $\\frac{5}{12}\\cdot 0.05 \\approx 0.020833\\overline{3}$，且 $0.0047 \\le 0.020833\\overline{3}$，满足。\n- $k=6$: $\\frac{6}{12}\\cdot 0.05 = 0.025$，且 $0.0068 \\le 0.025$，满足。\n- $k=7$: $\\frac{7}{12}\\cdot 0.05 \\approx 0.029166\\overline{6}$，且 $0.0127 \\le 0.029166\\overline{6}$，满足。\n- $k=8$: $\\frac{8}{12}\\cdot 0.05 \\approx 0.033333\\overline{3}$，且 $0.0205 \\le 0.033333\\overline{3}$，满足。\n- $k=9$: $\\frac{9}{12}\\cdot 0.05 = 0.0375$，且 $0.0317 \\le 0.0375$，满足。\n- $k=10$: $\\frac{10}{12}\\cdot 0.05 \\approx 0.041666\\overline{6}$，且 $0.043 \\nleq 0.041666\\overline{6}$，不满足。\n- $k=11$: $\\frac{11}{12}\\cdot 0.05 \\approx 0.045833\\overline{3}$，且 $0.081 \\nleq 0.045833\\overline{3}$，不满足。\n- $k=12$: $\\frac{12}{12}\\cdot 0.05 = 0.05$，且 $0.150 \\nleq 0.05$，不满足。\n\n满足 $p_{(k)} \\le \\frac{k}{12}\\cdot 0.05$ 的最大 $k$ 为 $k=9$。因此，BH决策阈值为\n$$\nt = p_{(9)} = 0.0317.\n$$\n四舍五入到四位有效数字，得到 $0.03170$。",
            "answer": "$$\\boxed{0.03170}$$"
        }
    ]
}