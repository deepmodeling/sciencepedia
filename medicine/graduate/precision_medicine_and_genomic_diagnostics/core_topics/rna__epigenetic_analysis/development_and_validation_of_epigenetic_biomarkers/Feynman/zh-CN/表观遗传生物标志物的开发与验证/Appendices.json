{
    "hands_on_practices": [
        {
            "introduction": "在表观遗传生物标志物的开发中，一个核心任务是将原始的亚硫酸氢盐测序读数转化为对每个$CpG$位点甲基化水平的精确量化。然而，一个简单的比例估计可能具有误导性，特别是在测序深度较低时。本练习将指导您完成一个关键的实践步骤：不仅计算甲基化比例的点估计，还为其构建一个严格的置信区间，从而为后续的统计分析提供不确定性的度量()。",
            "id": "4332324",
            "problem": "要求您形式化一个亚硫酸氢盐测序流程的比对后统计评估模块，该流程在实践中会使用 Bismark 软件执行读段比对和甲基化调用。在为精准医疗开发胞嘧啶-磷酸-鸟嘌呤 (CpG) 甲基化生物标志物的背景下，假设对于每个 CpG 位点，甲基化调用程序都会生成甲基化读段和未甲基化读段的非负整数计数。在标准建模假设下，每个覆盖 CpG 位点的读段都会产生一个独立的伯努利结果（甲基化或未甲基化），其未知参数 $p$ 代表该 CpG 位点的真实甲基化比例。因此，该位点 $n$ 个总读段中甲基化读段的总数 $X$ 被建模为具有参数 $(n,p)$ 的二项式随机变量的实现。\n\n您的任务是编写一个完整的程序，对于一组固定的 CpG 位点，使用 Clopper–Pearson 方法在显著性水平 $\\alpha$ 下，计算甲基化比例的点估计和精确的双侧等尾置信区间 (CI)，然后根据该区间以及用户指定的低甲基化和高甲基化阈值，将每个 CpG 位点分为三类之一。具体来说，该程序必须：\n\n- 对于每个具有甲基化计数 $x$ 和未甲基化计数 $y$ 的 CpG 位点，计算总覆盖度 $n = x + y$。\n- 通过返回下面指定的哨兵结果，排除覆盖度 $n$ 严格小于最小覆盖度阈值 $n_{\\min}$ 的 CpG 位点。\n- 对于通过覆盖度筛选的 CpG 位点，计算甲基化点估计 $\\hat{p} = x / n$。\n- 通过反演二项式模型，计算 $p$ 的双侧精确 Clopper–Pearson $(1 - \\alpha)$ 置信区间 $\\left[L, U\\right]$。\n- 使用基于区间的逻辑和阈值 $t_{\\text{low}}$ 与 $t_{\\text{high}}$ 对 CpG 位点进行分类，其中 $0 \\le t_{\\text{low}} < t_{\\text{high}} \\le 1$：\n  - 如果 $U < t_{\\text{low}}$，则分类为低甲基化，并返回分类代码 $0$。\n  - 否则，如果 $L > t_{\\text{high}}$，则分类为高甲基化，并返回分类代码 $2$。\n  - 否则，分类为不明确，并返回分类代码 $1$。\n\n对于不满足最小覆盖度的 CpG 位点，返回哨兵列表 $[-1.0, -1.0, -1.0, -1]$。\n\n每个浮点输出必须四舍五入到六位小数。所有甲基化比例、置信区间边界和阈值都必须表示为 $[0,1]$ 范围的小数（而不是百分比）。\n\n对所有测试用例使用以下固定参数：\n- 显著性水平 $\\alpha = 0.05$，用于 $(1 - \\alpha) = 0.95$ 的置信区间。\n- 最小覆盖度 $n_{\\min} = 5$。\n- 阈值 $t_{\\text{low}} = 0.30$ 和 $t_{\\text{high}} = 0.70$。\n\n要实现和评估的测试套件：\n- 案例 1：$(x, y) = (12, 8)$，所以 $n = 20$。\n- 案例 2：$(x, y) = (0, 20)$，所以 $n = 20$。\n- 案例 3：$(x, y) = (20, 0)$，所以 $n = 20$。\n- 案例 4：$(x, y) = (1, 2)$，所以 $n = 3$。\n- 案例 5：$(x, y) = (3, 7)$，所以 $n = 10$。\n- 案例 6：$(x, y) = (15, 15)$，所以 $n = 30$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，且不含嵌入的空格。每个测试用例的结果必须是一个包含四个值的列表，形式为 $[\\hat{p}, L, U, c]$，其中 $\\hat{p}$ 是甲基化比例估计值，$L$ 和 $U$ 是 Clopper–Pearson 置信区间的下限和上限，$c$ 是如上定义的分类代码。最终输出的格式必须与以下完全一样：\n\"[[p1,L1,U1,c1],[p2,L2,U2,c2],[p3,L3,U3,c3],[p4,L4,U4,c4],[p5,L5,U5,c5],[p6,L6,U6,c6]]\"\n所有浮点数四舍五入到六位小数，并且字符串中任何地方都没有空格。",
            "solution": "该问题要求对亚硫酸氢盐测序数据的统计评估模块进行形式化和实现，这是表观遗传学研究中的一项常见任务。我们将首先验证该问题的科学和数学合理性，然后基于已建立的统计学原理构建解决方案。\n\n### 问题阐述与模型\n\n该问题核心是分析特定 CpG 位点的 DNA 甲基化。对于每个位点，数据包括从亚硫酸氢盐测序中获得的甲基化读段数 $x$ 和未甲基化读段数 $y$。\n\n覆盖该位点的读段总数（即覆盖度）为 $n = x+y$。我们将每个读段建模为一次独立的伯努利试验，其结果为“甲基化”的概率为一个恒定的未知概率 $p$，该概率代表了该 CpG 位点的真实甲基化比例。在此模型下，对于给定的覆盖度 $n$，甲基化读段的总数 $X$ 是一个服从二项分布的随机变量：\n$$ X \\sim \\text{Binomial}(n, p) $$\n其概率质量函数由下式给出：\n$$ P(X=k | n, p) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n\n任务是为一系列由 $(x,y)$ 计数定义的 CpG 位点执行以下步骤：\n1.  应用最小覆盖度过滤器。\n2.  计算甲基化比例 $p$ 的点估计。\n3.  计算 $p$ 的双侧置信区间。\n4.  基于置信区间对 CpG 位点的甲基化状态进行分类。\n\n### 分步求解推导\n\n#### 1. 覆盖度筛选\n为了进行可靠的统计推断，最小覆盖度是必需的。问题指定了最小覆盖度阈值 $n_{\\min}$。任何覆盖度 $n = x+y < n_{\\min}$ 的 CpG 位点都将从进一步分析中排除。对于这类位点，返回一个哨兵结果 $[-1.0, -1.0, -1.0, -1]$。给定的值为 $n_{\\min}=5$。\n\n#### 2. 点估计\n对于通过覆盖度筛选（$n \\ge n_{\\min}$）的 CpG 位点，我们估计真实的甲基化比例 $p$。二项比例参数 $p$ 的最大似然估计 (MLE) 是样本比例：\n$$ \\hat{p} = \\frac{x}{n} $$\n这作为我们对甲基化水平的点估计。\n\n#### 3. Clopper-Pearson 置信区间\n点估计 $\\hat{p}$ 提供了一个单一值，但没有提供其不确定性的信息。置信区间 (CI) 为真实参数 $p$ 提供了一个合理的取值范围。问题指定了 Clopper-Pearson 方法，该方法通过反演二项检验来生成一个“精确”区间。\n\n对于 $(1-\\alpha)$ 的置信水平，双侧等尾 Clopper-Pearson 区间 $[L, U]$ 的构造使其下限 $L$ 和上限 $U$ 满足以下方程：\n$$ P(X \\ge x | n, L) = \\sum_{k=x}^{n} \\binom{n}{k} L^k (1-L)^{n-k} = \\frac{\\alpha}{2} $$\n$$ P(X \\le x | n, U) = \\sum_{k=0}^{x} \\binom{n}{k} U^k (1-U)^{n-k} = \\frac{\\alpha}{2} $$\n这些方程将 $L$ 定义为使得观察到 $x$ 个或更多甲基化读段的事件不至于异常罕见（概率不小于 $\\alpha/2$）的最大比例，而将 $U$ 定义为使得观察到 $x$ 个或更少甲基化读段的事件不至于异常罕见的最小比例。\n\n这些方程用于求解 $L$ 和 $U$。二项分布的累积分布函数 (CDF) 与正则化不完全贝塔函数 $I_z(a,b)$ 的关系如下：\n$$ \\sum_{k=x}^{n} \\binom{n}{k} p^k (1-p)^{n-k} = I_p(x, n-x+1) $$\n$$ \\sum_{k=0}^{x} \\binom{n}{k} p^k (1-p)^{n-k} = 1 - I_p(x+1, n-x) $$\n将这些关系代入 CI 边界的定义方程，得到：\n$$ I_L(x, n-x+1) = \\frac{\\alpha}{2} $$\n$$ 1 - I_U(x+1, n-x) = \\frac{\\alpha}{2} \\implies I_U(x+1, n-x) = 1 - \\frac{\\alpha}{2} $$\n求解 $L$ 和 $U$ 需要找到正则化不完全贝塔函数的反函数，即贝塔分布的分位数函数（或称百分点函数，PPF）。\n因此，$L$ 是形状参数为 $(x, n-x+1)$ 的贝塔分布的 $\\alpha/2$ 分位数，$U$ 是形状参数为 $(x+1, n-x)$ 的贝塔分布的 $(1-\\alpha/2)$ 分位数。\n\n上下限由以下公式给出：\n$$ L = \\text{Beta.PPF}\\left(\\frac{\\alpha}{2}; x, n-x+1\\right) $$\n$$ U = \\text{Beta.PPF}\\left(1-\\frac{\\alpha}{2}; x+1, n-x\\right) $$\n\n必须处理特殊的边界情况：\n-   如果 $x=0$，下限为 $L=0$。\n-   如果 $x=n$，上限为 $U=1$。\n\n问题指定 $\\alpha=0.05$，因此我们使用 $\\alpha/2=0.025$ 和 $1-\\alpha/2=0.975$ 来计算 $95\\%$ 置信区间。\n\n#### 4. 基于区间的分类\n最后一步是将每个 CpG 位点分为三类之一：低甲基化、不明确或高甲基化。这种分类不是基于点估计 $\\hat{p}$，而是基于包含了统计不确定性的置信区间 $[L, U]$。这是一种更保守、更稳健的方法。\n\n给定阈值 $t_{\\text{low}}$ 和 $t_{\\text{high}}$（其中 $0 \\le t_{\\text{low}} < t_{\\text{high}} \\le 1$），分类规则如下：\n-   **低甲基化（代码 $0$）**：如果我们确信真实比例 $p$ 低于 $t_{\\text{low}}$。这种情况发生在整个置信区间都位于阈值以下时：$U < t_{\\text{low}}$。\n-   **高甲基化（代码 $2$）**：如果我们确信真实比例 $p$ 高于 $t_{\\text{high}}$。这种情况发生在整个置信区间都位于阈值以上时：$L > t_{\\text{high}}$。\n-   **不明确（代码 $1$）**：所有其他情况。这包括跨越一个或两个阈值的区间，表明数据不足以做出低甲基化或高甲基化的高置信度判断。\n\n问题指定 $t_{\\text{low}}=0.30$ 和 $t_{\\text{high}}=0.70$。\n\n这个系统性步骤将点估计与严格的不确定性量化相结合，以产生稳健的分类，这是开发可靠的表观遗传生物标志物的关键组成部分。实现将遵循这些推导出的步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import beta\n\ndef solve():\n    \"\"\"\n    Computes methylation statistics and classifies CpG sites based on bisulfite sequencing read counts.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    alpha = 0.05\n    n_min = 5\n    t_low = 0.30\n    t_high = 0.70\n\n    # --- Test Suite ---\n    test_cases = [\n        (12, 8),   # Case 1\n        (0, 20),   # Case 2\n        (20, 0),   # Case 3\n        (1, 2),    # Case 4\n        (3, 7),    # Case 5\n        (15, 15),  # Case 6\n    ]\n\n    results = []\n    for x, y in test_cases:\n        n = x + y\n\n        # Step 1: Coverage Filtering\n        if n < n_min:\n            results.append([-1.0, -1.0, -1.0, -1])\n            continue\n\n        # Step 2: Point Estimate\n        p_hat = x / n\n\n        # Step 3: Clopper-Pearson Confidence Interval\n        alpha_half = alpha / 2.0\n\n        # Handle edge cases for L and U bounds\n        if x == 0:\n            lower_bound = 0.0\n        else:\n            lower_bound = beta.ppf(alpha_half, x, n - x + 1)\n\n        if x == n:\n            upper_bound = 1.0\n        else:\n            upper_bound = beta.ppf(1 - alpha_half, x + 1, n - x)\n        \n        # Step 4: Interval-Based Classification\n        if upper_bound < t_low:\n            classification_code = 0  # Hypomethylated\n        elif lower_bound > t_high:\n            classification_code = 2  # Hypermethylated\n        else:\n            classification_code = 1  # Ambiguous\n            \n        results.append([p_hat, lower_bound, upper_bound, classification_code])\n\n    # --- Format final output string ---\n    results_str_list = []\n    for res in results:\n        if res == [-1.0, -1.0, -1.0, -1]:\n            # Handle sentinel case formatting as specified\n            results_str_list.append(\"[-1.0,-1.0,-1.0,-1]\")\n        else:\n            p_hat, l_bound, u_bound, code = res\n            # Round floats to six decimal places for all other cases\n            p_str = f\"{p_hat:.6f}\"\n            l_str = f\"{l_bound:.6f}\"\n            u_str = f\"{u_bound:.6f}\"\n            c_str = str(code)\n            results_str_list.append(f\"[{p_str},{l_str},{u_str},{c_str}]\")\n\n    # Combine all results into a single line string\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在完成对数千甚至数百万个$CpG$位点的逐一量化后，研究人员面临的下一个挑战是在众多假设检验中识别出真正与疾病相关的信号。当进行大规模并行检验时，仅仅依赖传统的$p$值阈值会产生大量的假阳性结果。本练习将通过手动演算Benjamini-Hochberg（BH）程序，让您掌握控制伪发现率（FDR）这一关键的统计技能，以确保生物标志物发现的稳健性()。",
            "id": "4332313",
            "problem": "在为一种复杂疾病开发基于血液的表观遗传生物标志物组合时，您测量了病例组和对照组中一组胞嘧啶-磷酸-鸟嘌呤（CpG）二核苷酸的差异DNA甲基化。对于每个CpG位点，您将病例组和对照组之间甲基化分数的差异估计为效应大小，并计算一个关于无差异的双边假设检验，从而在零假设下得到一个有效的p值。假设在 Benjamini–Hochberg (BH) 程序控制错误发现率 (FDR) 时所满足的独立性（或正相关）条件成立。错误发现率 (FDR) 定义为所有声稱的发现中，错误发现的预期比例。\n\n您获得了以下各CpG位点的结果（效应大小在多重检验计算中不是必需的，但为了完整性而显示）：CpG-A：效应大小 $+0.12$，$p$-值 $0.0205$；CpG-B：效应大小 $-0.07$，$p$-值 $0.043$；CpG-C：效应大小 $+0.04$，$p$-值 $0.0317$；CpG-D：效应大小 $-0.15$，$p$-值 $0.00082$；CpG-E：效应大小 $+0.03$，$p$-值 $0.081$；CpG-F：效应大小 $-0.10$，$p$-值 $0.0127$；CpG-G：效应大小 $+0.05$，$p$-值 $0.0047$；CpG-H：效应大小 $-0.11$，$p$-值 $0.00031$；CpG-I：效应大小 $+0.02$，$p$-值 $0.150$；CpG-J：效应大小 $-0.06$，$p$-值 $0.0068$；CpG-K：效应大小 $+0.09$，$p$-值 $0.00095$；CpG-L：效应大小 $-0.08$，$p$-值 $0.0021$。\n\n使用 Benjamini–Hochberg 方法将错误发现率控制在目标水平 $q=0.05$，计算 BH 决策阈值，该阈值定义为最大的p值 $t$，使得所有小于或等于 $t$ 的p值在 FDR 水平 $q$ 下都被认为是显著的。将 $t$ 报告为一个纯数字。将您的答案四舍五入到四位有效数字。",
            "solution": "目标是确定，在使用 Benjamini–Hochberg (BH) 程序且目标错误发现率 (FDR) 水平为 $q=0.05$ 的情况下，最大的p值阈值 $t$ 是多少，使得将所有 $p \\leq t$ 的检验宣布为显著，能将 FDR 控制在指定水平。\n\n从基础上讲，错误发现率 (FDR) 是错误发现数与总发现数之比的期望值。BH 程序是一种经过充分检验的方法，当零假设的p值是独立的（或满足某些正相关条件）时，它能将 FDR 控制在水平 $q$。BH 程序的构造方法是，将观察到的 $m$ 个p值按升序排列，$p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(m)}$，然后找出满足 $p_{(k)} \\leq \\frac{k}{m} q$ 的最大索引 $k$。那么决策阈值就是 $t = p_{(k)}$，所有 $p \\leq t$ 的检验都被视为发现。\n\n我们有 $m=12$ 个检验。提取p值（忽略用于多重性校正的效应大小）：$0.0205, 0.043, 0.0317, 0.00082, 0.081, 0.0127, 0.0047, 0.00031, 0.150, 0.0068, 0.00095, 0.0021$。\n\n将它们按升序排列：\n- $p_{(1)}=0.00031$\n- $p_{(2)}=0.00082$\n- $p_{(3)}=0.00095$\n- $p_{(4)}=0.0021$\n- $p_{(5)}=0.0047$\n- $p_{(6)}=0.0068$\n- $p_{(7)}=0.0127$\n- $p_{(8)}=0.0205$\n- $p_{(9)}=0.0317$\n- $p_{(10)}=0.043$\n- $p_{(11)}=0.081$\n- $p_{(12)}=0.150$。\n\n计算 BH 临界值 $\\frac{k}{m}q = \\frac{k}{12}\\cdot 0.05$ (对于 $k=1,\\dots,12$) 并进行比较：\n- $k=1$: $\\frac{1}{12}\\cdot 0.05 \\approx 0.004167$，且 $0.00031 \\leq 0.004167$，满足。\n- $k=2$: $\\frac{2}{12}\\cdot 0.05 \\approx 0.008333$，且 $0.00082 \\leq 0.008333$，满足。\n- $k=3$: $\\frac{3}{12}\\cdot 0.05 = 0.0125$，且 $0.00095 \\leq 0.0125$，满足。\n- $k=4$: $\\frac{4}{12}\\cdot 0.05 \\approx 0.016667$，且 $0.0021 \\leq 0.016667$，满足。\n- $k=5$: $\\frac{5}{12}\\cdot 0.05 \\approx 0.020833$，且 $0.0047 \\leq 0.020833$，满足。\n- $k=6$: $\\frac{6}{12}\\cdot 0.05 = 0.025$，且 $0.0068 \\leq 0.025$，满足。\n- $k=7$: $\\frac{7}{12}\\cdot 0.05 \\approx 0.029167$，且 $0.0127 \\leq 0.029167$，满足。\n- $k=8$: $\\frac{8}{12}\\cdot 0.05 \\approx 0.033333$，且 $0.0205 \\leq 0.033333$，满足。\n- $k=9$: $\\frac{9}{12}\\cdot 0.05 = 0.0375$，且 $0.0317 \\leq 0.0375$，满足。\n- $k=10$: $\\frac{10}{12}\\cdot 0.05 \\approx 0.041667$，且 $0.043 \\not\\leq 0.041667$，不满足。\n- $k=11$: $\\frac{11}{12}\\cdot 0.05 \\approx 0.045833$，且 $0.081 \\not\\leq 0.045833$，不满足。\n- $k=12$: $\\frac{12}{12}\\cdot 0.05 = 0.05$，且 $0.150 \\not\\leq 0.05$，不满足。\n\n满足 $p_{(k)} \\leq \\frac{k}{12}\\cdot 0.05$ 的最大 $k$ 是 $k=9$。因此，BH 决策阈值是\n$$\nt = p_{(9)} = 0.0317.\n$$\n四舍五入到四位有效数字得到 $0.03170$。",
            "answer": "$$\\boxed{0.03170}$$"
        },
        {
            "introduction": "表观遗传学研究中最微妙的挑战之一，是区分真正的表观遗传调控与潜在的遗传变异所造成的混淆效应。一个在病例和对照组之间观察到的甲基化差异，可能并非由疾病本身引起，而是反映了两组之间潜在的基因序列差异。本练习通过一个关于甲基化数量性状位点（meQTL）的案例，深入探讨了这种由遗传驱动的伪影，并阐明了如何通过整合遗传信息来正确解读表观遗传数据()。",
            "id": "4332306",
            "problem": "在精准医疗和基因组诊断中，甲基化数量性状位点对于解释与疾病相关的表观遗传变异至关重要。请思考以下基本原理和情景。\n\n基本原理：\n- 胞嘧啶-磷酸-鸟嘌呤（CpG）二核苷酸是5-甲基胞嘧啶（5mC）存在的主要基因组背景。根据化学定义，胞嘧啶第$5$位的甲基化要求在一个CpG二联体中必须存在一个胞嘧啶碱基。如果一个单核苷酸多态性（SNP）将胞嘧啶转化为胸腺嘧啶（$\\mathrm{C}\\rightarrow\\mathrm{T}$）或将其鸟嘌呤伴侣转化为腺嘌呤（$\\mathrm{G}\\rightarrow\\mathrm{A}$），则该CpG位点被破坏，无法在突变链上携带5mC。\n- 亚硫酸氢钠转化会将未甲基化的胞嘧啶脱氨基，使其转变为尿嘧啶，而聚合酶和测序过程会将其读取为胸腺嘧啶，而已甲基化的胞嘧啶则受到保护。因此，经过转化和测序或芯片杂交后，胸腺嘧啶信号既可能反映一个原始的未甲基化胞嘧啶，也可能反映一个由SNP引入的真正的胸腺嘧啶；若无额外的序列背景信息，该检测方法本身无法区分这两种来源。\n- 数量性状位点是指一个基因组位点，其遗传变异可以解释某一数量性状表型的方差。甲基化数量性状位点（meQTL）指的是数量性状为一个或多个CpG位点上DNA甲基化水平的情况。\n\n情景：\n您对一个邻近某疾病基因的CpG位点$C^{\\ast}$进行了一项病例-对照全表观基因组关联研究（EWAS）。附近一个变异$V$是一个CpG破坏型SNP，其备选等位基因存在时会破坏$C^{\\ast}$中的胞嘧啶。设$G\\in\\{0,1,2\\}$表示基因型，编码为$V$位点上CpG破坏型等位基因的数量。假设一个完整CpG位点上，每个等位基因的基线甲基化概率为$m_{0}$，且 $0 < m_0 < 1$。因此，在一个二倍体基因组中，一个等位基因的甲基化贡献为$m_0$（如果完整）或$0$（如果被破坏），总甲基化水平是两个等位基因贡献的平均值。\n\n您还知道$V$与一个真正的致病SNP $D$处于连锁不平衡（LD）状态，但疾病本身对$C^{\\ast}$位点的甲基化没有直接的生物学效应。由于连锁不平衡，$V$的基因型频率在病例组和对照组之间有所不同：\n- 病例组：$\\Pr(G=0)=0.25$, $\\Pr(G=1)=0.50$, $\\Pr(G=2)=0.25$\n- 对照组：$\\Pr(G=0)=0.49$, $\\Pr(G=1)=0.42$, $\\Pr(G=2)=0.09$\n\n使用$m_{0}=0.70$。基于这些信息，评估以下哪个陈述（或多个陈述）是正确的。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理、阐述清晰且客观的。它展示了统计基因组学和表观遗传学领域中的一个现实情景。我们现在可以开始解答。\n\n这个问题的核心是在全表观基因组关联研究（EWAS）中一个经典的混杂案例。我们被告知，疾病对CpG位点$C^{\\ast}$的甲基化没有直接的因果效应。然而，一个遗传变异$V$破坏了这个CpG位点，并且这个变异与一个真正的疾病相关变异$D$处于连锁不平衡（LD）状态。这导致了病例组和对照组中$V$的基因型分布不同，从而在疾病状态和$C^{\\ast}$位点的甲基化之间产生了一个虚假的关联。\n\n设$M$为测得的甲基化水平，其范围可以从$0$到$1$。基因型$G \\in \\{0, 1, 2\\}$代表个体携带的CpG破坏型等位基因的数量。问题陈述中说明，一个完整等位基因上的甲基化概率为$m_0 = 0.70$，而被破坏的等位基因对甲基化的贡献为零。总甲基化水平是两个等位基因的平均值。\n\n以基因型$G$为条件的预期甲基化水平为：\n- 对于$G=0$（两个完整等位基因）：$E[M|G=0] = \\frac{m_0 + m_0}{2} = m_0$\n- 对于$G=1$（一个完整，一个被破坏的等位基因）：$E[M|G=1] = \\frac{m_0 + 0}{2} = \\frac{m_0}{2}$\n- 对于$G=2$（两个被破坏的等位基因）：$E[M|G=2] = \\frac{0 + 0}{2} = 0$\n\n我们现在可以使用全期望定律和给定的基因型频率来计算病例组和对照组的预期甲基化水平。\n\n病例组的预期甲基化：\n$$E[M|\\text{Case}] = \\sum_{g=0}^{2} E[M|G=g] \\cdot \\Pr(G=g|\\text{Case})$$\n$$E[M|\\text{Case}] = (m_0 \\cdot \\Pr(G=0|\\text{Case})) + (\\frac{m_0}{2} \\cdot \\Pr(G=1|\\text{Case})) + (0 \\cdot \\Pr(G=2|\\text{Case}))$$\n使用给定的病例组概率（$\\Pr(G=0)=0.25$, $\\Pr(G=1)=0.50$, $\\Pr(G=2)=0.25$）和$m_0 = 0.70$：\n$$E[M|\\text{Case}] = (0.70 \\cdot 0.25) + (\\frac{0.70}{2} \\cdot 0.50) + (0 \\cdot 0.25)$$\n$$E[M|\\text{Case}] = (0.175) + (0.35 \\cdot 0.50) + 0 = 0.175 + 0.175 = 0.35$$\n\n对照组的预期甲基化：\n$$E[M|\\text{Control}] = \\sum_{g=0}^{2} E[M|G=g] \\cdot \\Pr(G=g|\\text{Control})$$\n使用给定的对照组概率（$\\Pr(G=0)=0.49$, $\\Pr(G=1)=0.42$, $\\Pr(G=2)=0.09$）和$m_0 = 0.70$：\n$$E[M|\\text{Control}] = (0.70 \\cdot 0.49) + (\\frac{0.70}{2} \\cdot 0.42) + (0 \\cdot 0.09)$$\n$$E[M|\\text{Control}] = (0.343) + (0.35 \\cdot 0.42) + 0 = 0.343 + 0.147 = 0.49$$\n\n我们的计算表明，病例组的预期甲基化水平（$0.35$）显著低于对照组（$0.49$）。病例组中这种表观上的“低甲基化”并非由疾病的表观遗传效应引起，而完全是由于病例组中CpG破坏型等位基因频率较高所致。这证实了所描述的混杂情景。我们现在将评估每个选项。\n\n***\n\n**A. 甲基化数量性状位点是一个基因组位点，其遗传变异与一个或多个CpG位点在顺式或反式上的DNA甲基化定量水平相关；一个CpG破坏型SNP（$\\mathrm{C}\\rightarrow\\mathrm{T}$或$\\mathrm{G}\\rightarrow\\mathrm{A}$）会移除受影响等位基因上的甲基受体胞嘧啶，从而强制产生等位基因特异性低甲基化。如果疾病状态通过连锁不平衡与该破坏型等位基因相关联，那么即使没有任何因果性的表观遗传效应，也可能出现病例-对照组间的甲基化差异。过滤与SNP重叠的探针、在回归分析中对$V$位点的基因型进行校正，以及利用杂合子中的等位基因特异性甲基化，都是减轻或诊断这种混杂效应的有效方法。**\n\n- **分析：** 这个陈述包含四个部分，全部都是正确的。\n  1. 甲基化数量性状位点（meQTL）的定义是准确的：它描述了遗传变异（基因型）与甲基化水平之间的关联。这种关联可以是局部的（`cis`，顺式）或远端的（`trans`，反式）。\n  2. 对CpG破坏型SNP机理的描述是正确的。通过移除胞嘧啶（或相邻的鸟嘌呤），该等位基因上用于甲基化的底物被消除，导致该特定DNA链（等位基因）上强制的甲基化水平为$0$（等位基因特异性低甲基化）。\n  3. 对虚假关联的解释正是问题和我们上述推导中详述的混杂情景。meQTL变异（$V$）和疾病变异（$D$）之间的连锁不平衡（LD）造成了疾病与甲基化之间非因果性的关联。\n  4. 提议的减轻和诊断策略都是该领域的标准最佳实践。在EWAS中，过滤掉与已知SNP重叠的探针是一个关键的质量控制步骤。在回归模型中对混杂SNP的基因型进行校正是消除混杂的标准统计方法。分析杂合子中的等位基因特异性甲基化是一种强大的方法，可以实验性地证实甲基化差异是由遗传序列本身驱动的。\n- **结论：** 正确。\n\n***\n\n**B. 甲基化数量性状位点由DNA甲基化与基因表达之间的关联定义。CpG破坏型变异在亚硫酸氢钠转化后不能影响测得的甲基化，因为所有未甲基化的胞嘧啶都会被读取为胸腺嘧啶，所以基因型不会混淆甲基化测量。因此，在检验疾病效应时，无需对基因型进行控制。**\n\n- **分析：** 这个陈述在多个基本点上都是错误的。\n  1. 所提供的定义是表达数量性状甲基化（eQTM），而不是meQTL。meQTL连接的是基因型与甲基化。\n  2. 声称CpG破坏型变异“不能影响测得的甲基化”是错误的。如果一个SNP将胞嘧啶变为胸腺嘧啶（$\\mathrm{C}\\rightarrow\\mathrm{T}$），基因组的那个位置现在就含有一个真正的胸腺嘧啶。在亚硫酸氢盐测序实验中，这将被读取为'T'，就像一个未甲基化的胞嘧啶转化为尿嘧啶然后被读取为'T'一样。这意味着SNP直接导致该等位基因上测得的甲基化水平为$0$，从而深刻地影响了测量结果。断言基因型不会混淆甲基化测量与事实恰恰相反。\n  3. 因此，认为无需控制基因型的结论是极其错误的。\n- **结论：** 错误。\n\n***\n\n**C. 甲基化数量性状位点要求疾病直接改变该位点的甲基化；CpG破坏型变异只影响探针杂交，而不影响潜在的DNA甲基化生物学过程，因此，无论与疾病变异是否存在连锁不平衡，过滤掉次要等位基因频率低于$0.05$的变异就足以消除虚假关联。**\n\n- **分析：** 这个陈述是错误的。\n  1. 定义是错误的。meQTL由基因型-甲基化关联定义，与疾病无关。疾病-甲基化关联是在EWAS中研究的。\n  2. 声称CpG破坏型变异“只影响探针杂交，而不影响潜在的DNA甲基化生物学过程”是错误的。虽然它们可能影响微阵列上的探针杂交，但其主要效应是生物学上的：它们移除了作为DNA甲基转移酶底物的胞嘧啶。这是对该位点甲基化生物学的根本性改变。\n  3. 提议的解决方案是不充分的。基于一个固定的次要等位基因频率（MAF）阈值（如$0.05$）进行过滤，并不是处理此类混杂的针对性或有效方法。在情景中，混杂SNP在病例组（$p=0.50$）和对照组（$p=0.30$）中都很常见，所以不会被过滤掉。任何频率的SNP都可能引起混杂。\n- **结论：** 错误。\n\n***\n\n**D. 甲基化数量性状位点是基因型与甲基化之间的关联，但仅限于启动子区域；CpG破坏型变异通过阻断亚硫酸氢钠转化来增加测得的甲基化水平，因此会人为地夸大携带者的甲基化水平。仅对估计的细胞类型组成进行校正即可消除这种偏倚。**\n\n- **分析：** 这个陈述是错误的。\n  1. meQTL的定义被错误地限制在“仅限于启动子区域”。meQTL遍布整个基因组。\n  2. 所描述的效应与实际情况相反。CpG破坏型变异导致胞嘧啶位置上出现胸腺嘧啶（或者直接通过$\\mathrm{C}\\rightarrow\\mathrm{T}$ SNP，或者通过$\\mathrm{G}\\rightarrow\\mathrm{A}$ SNP使该位点变为非CpG位点而等效实现）。这个T被解释为未甲基化信号，因此会*降低*测得的甲基化水平（beta值），而不是增加它。\n  3. 提议的解决方案与问题无关。对细胞类型组成进行校正是EWAS中纠正由细胞类型异质性引起的混杂的关键步骤，但这与CpG位点本身的基因型混杂是两个不同的问题。它无法消除所描述的遗传偏倚。\n- **结论：** 错误。\n\n***\n\n**E. 在上述情景中，即使疾病对甲基化没有真正的效应，基因型分布的差异也会纯粹由于完整CpG等位基因的丢失而导致病例组的预期甲基化水平较低。一个关于甲基化对疾病和$G$的线性模型可以消除这种偏倚，因为在所述假设下，甲基化的期望值是完整等位基因数量的线性函数。利用跨越$V$和$C^{\\ast}$的定相读段进行等位基因特异性甲基化分析，可以从经验上显示完整等位基因上的甲基化和被破坏等位基因上的甲基化缺失，从而区分序列驱动的效应和表观遗传的疾病效应。**\n\n- **分析：** 这个陈述完全正确，并提供了一个精确的定量和方法学总结。\n  1. 第一句话正确地指出了混杂的结果：“导致病例组的预期甲基化水平较低”，我们最初的计算证实了这一点（$0.35$ 对 $0.49$）。\n  2. 第二句话正确地论证了使用线性模型的合理性。预期甲基化$E[M|G] = m_0 - (m_0/2)G$是基因型剂量$G$的线性函数。因此，在回归模型`Methylation ~ Disease + G`中将$G$作为协变量，是校正基因型混杂效应的统计学上有效的方法。\n  3. 第三句话描述了一种复杂而强大的实验验证方法。通过区分来自参考（完整）等位基因和备选（被破坏）等位基因的读段，等位基因特异性分析为遗传机制提供了直接的经验证据。这是区分此类人为效应与真正的、与疾病相关的调控性表观遗传变化的决定性方法。\n- **结论：** 正确。",
            "answer": "$$\\boxed{AE}$$"
        }
    ]
}