{
    "hands_on_practices": [
        {
            "introduction": "亚硫酸氢盐测序是DNA甲基化分析的金标准，但其化学转化过程并非完美。未甲基化的胞嘧啶可能转化不完全，而甲基化的胞嘧啶也可能被错误地脱氨基，这两种偏差都会影响甲基化水平的准确评估。本练习将引导您推导一个数学模型 ，以校正原始测序数据中的这些系统性偏差，从而更精确地估算真实的甲基化水平，这是准确解读数据的基本功。",
            "id": "5143326",
            "problem": "一个实验室正在比较经新鲜冷冻和福尔马林固定石蜡包埋（FFPE）处理的配对组织中，单个胞嘧啶-磷酸-鸟嘌呤（CpG）二核苷酸上的胞嘧啶甲基化情况。使用经过验证的、与基质相适应的方案从两种组织中提取了脱氧核糖核酸（DNA）。进行了亚硫酸氢钠转化；掺入的内参对照定量表明，在该方案下，一个未甲基化的胞嘧啶脱氨成尿嘧啶（并被读取为胸腺嘧啶）的概率为 $c_{u} = 0.95$，而一个甲基化的胞嘧啶脱氨（并被读取为胸腺嘧啶）的概率为 $d_{m} = 0.02$。在目标CpG位点，亚硫酸氢盐测序产生了以下计数：在新鲜冷冻样本中，总共 $120$ 个测序读数中有 $78$ 个报告为胞嘧啶，$42$ 个报告为胸腺嘧啶；在FFPE样本中，总共 $80$ 个测序读数中有 $30$ 个报告为胞嘧啶，$50$ 个报告为胸腺嘧啶。\n\n仅从以下定义出发：(i) 亚硫酸氢钠转化以概率 $c_{u}$ 将未甲基化的胞嘧啶脱氨成尿嘧啶，而甲基化的胞嘧啶以概率 $1 - d_{m}$ 保持为胞嘧啶；以及 (ii) 观测到的胞嘧啶比例等于在所有真实甲基化状态上汇总后观测到胞嘧啶的总概率。请推导出一个关于真实甲基化比例 $p$ 的估计量，用观测到的胞嘧啶比例 $y$、$c_{u}$ 和 $d_{m}$ 来表示。然后，使用该估计量和上述数据，计算新鲜冷冻与FFPE样本之间真实甲基化的校正后差异，定义为 $p_{\\mathrm{fresh}} - p_{\\mathrm{FFPE}}$。将您的答案四舍五入到 $4$ 位有效数字。将最终结果表示为一个无单位的分数。",
            "solution": "我们从亚硫酸氢钠转化和观测的概率模型开始。设 $p$ 表示CpG位点的真实甲基化比例，即在亚硫酸氢钠处理前，一个随机选择的DNA分子在该位点具有甲基化胞嘧啶的概率。设 $y$ 表示在亚硫酸氢钠处理和测序后，报告为胞嘧啶的测序读数的观测比例。\n\n根据所述方案下亚硫酸氢盐化学的定义，一个未甲基化的胞嘧啶以概率 $c_{u}$ 脱氨（并将被读取为胸腺嘧啶），因此它被观测为胞嘧啶的概率为 $1 - c_{u}$。一个甲基化的胞嘧啶能抵抗亚硫酸氢盐，但可能以概率 $d_{m}$ 发生意外脱氨，因此它被观测为胞嘧啶的概率为 $1 - d_{m}$。\n\n使用全概率定律，观测到的胞嘧啶比例 $y$ 是两种互斥的真实状态（甲基化与未甲基化）的总和：\n$$\ny \\;=\\; \\underbrace{p}_{\\text{true methylated}}\\cdot \\underbrace{(1 - d_{m})}_{\\text{observed as cytosine}} \\;+\\; \\underbrace{(1 - p)}_{\\text{true unmethylated}}\\cdot \\underbrace{(1 - c_{u})}_{\\text{observed as cytosine}}.\n$$\n这在代数上可以简化为：\n$$\ny \\;=\\; p(1 - d_{m}) + (1 - p)(1 - c_{u}) \\;=\\; (1 - c_{u}) + p\\big[(1 - d_{m}) - (1 - c_{u})\\big] \\;=\\; (1 - c_{u}) + p(c_{u} - d_{m}).\n$$\n对 $p$ 求解得到估计量：\n$$\n\\hat{p} \\;=\\; \\frac{y - (1 - c_{u})}{c_{u} - d_{m}}.\n$$\n\n现在我们为每个样本计算 $y$ 并应用该估计量。对于新鲜冷冻样本，观测到的胞嘧啶比例为\n$$\ny_{\\mathrm{fresh}} \\;=\\; \\frac{78}{120} \\;=\\; 0.65.\n$$\n当 $c_{u} = 0.95$ 且 $d_{m} = 0.02$ 时，我们有\n$$\n\\hat{p}_{\\mathrm{fresh}} \\;=\\; \\frac{0.65 - (1 - 0.95)}{0.95 - 0.02} \\;=\\; \\frac{0.65 - 0.05}{0.93} \\;=\\; \\frac{0.60}{0.93}.\n$$\n\n对于FFPE样本，观测到的胞嘧啶比例为\n$$\ny_{\\mathrm{FFPE}} \\;=\\; \\frac{30}{80} \\;=\\; 0.375,\n$$\n因此\n$$\n\\hat{p}_{\\mathrm{FFPE}} \\;=\\; \\frac{0.375 - (1 - 0.95)}{0.95 - 0.02} \\;=\\; \\frac{0.375 - 0.05}{0.93} \\;=\\; \\frac{0.325}{0.93}.\n$$\n\n真实甲基化的校正后差异为\n$$\n\\hat{p}_{\\mathrm{fresh}} - \\hat{p}_{\\mathrm{FFPE}} \\;=\\; \\frac{0.60}{0.93} - \\frac{0.325}{0.93} \\;=\\; \\frac{0.275}{0.93}.\n$$\n我们计算该商以获得数值，并四舍五入到 $4$ 位有效数字：\n$$\n\\frac{0.275}{0.93} \\;\\approx\\; 0.2956989247\\ldots \\;\\to\\; 0.2957 \\text{ (unitless)}.\n$$\n\n在差异甲基化分析中的解释：该推导表明，未甲基化胞嘧啶的不完全转化（由 $1 - c_{u}$ 量化）会夸大观测到的胞嘧啶计数，而甲基化胞嘧啶的意外脱氨（由 $d_{m}$ 量化）会减少它们。校正这两种偏差可以得到真实甲基化比例的线性解卷积。在比较新鲜冷冻和FFPE组织时，如果对每种基质都进行了验证（例如，通过与每种样本类型一起处理的内参对照），则可以应用相同的错分参数。如果由于提取诱导的损伤或FFPE典型的交联导致 $c_{u}$ 或 $d_{m}$ 因基质而异，则应使用基质特异性校准；否则，未经校正的比较可能会将转化假象错误地归因于生物学差异。在所述的、经过验证的参数下，新鲜冷冻样本在此CpG位点的真实甲基化水平（以分数单位计）大约高出 $0.2957$。",
            "answer": "$$\\boxed{0.2957}$$"
        },
        {
            "introduction": "除了实验过程中的化学偏差，DNA序列本身的遗传变异也会干扰甲基化分析。一个常见的例子是单核苷酸多态性 (Single Nucleotide Polymorphism, SNP)，它可能破坏或产生一个新的CpG位点，如果不加以考虑，将导致甲基化水平的错误估计。本练习旨在挑战您识别这些受SNP影响的位点 ，并利用变异等位基因频率来推导校正公式，从而消除这一关键的假阳性来源。",
            "id": "4334576",
            "problem": "一份癌症活检样本使用全基因组亚硫酸氢盐测序（WGBS）进行分析，并在正向链上一个参考胞嘧啶后跟一个鸟嘌呤的位置（一个CpG位点）进行甲基化检出。在亚硫酸氢盐转化中，未甲基化的胞嘧啶会脱氨基转变为尿嘧啶，并在测序中被读取为胸腺嘧啶，而甲基化的胞嘧啶则保持为胞嘧啶。某个胞嘧啶位置的基本甲基化估计量定义为含有胞嘧啶的测序读数占覆盖该位置总读数的比例。考虑单个CpG位点的以下数据：总覆盖度为 $N = 360$，观察到的胞嘧啶计数为 $n_C = 108$，胸腺嘧啶计数为 $n_T = 252$，得到的朴素甲基化估计值为 $\\hat{m} = n_C/(n_C+n_T)$。来自同一样本的变异检出产生了一个变异调用格式（VCF）条目，表明存在一个单核苷酸多态性（SNP），该SNP将CpG的胞嘧啶变成了胸腺嘧啶（$C \\to T$），变异等位基因频率为 $p = 0.25$，从而消除了该等位基因上的CpG。在相邻的鸟嘌呤处没有检出变异。该样本在此基因座上近似为二倍体，且无拷贝数变异。\n\n请从基本原理出发，解释在亚硫酸氢盐测序分析中，如何识别和过滤受单核苷酸多态性（SNP）或短插入/缺失（indel）影响的CpG位点，这些变异会产生或消除CpG。解释需考虑脱氧核糖核酸（DNA）的双链以及与二核苷酸重叠的小型indel。然后，在所述假设下，量化该 $C \\to T$ SNP对朴素甲基化估计值的影响，并为此位点提供一个校正后的甲基化估计值。选择一个选项，该选项最准确地描述了科学上合理的识别/过滤策略，并提供了正确的量化影响和校正估计值。\n\n选项:\nA. 扫描样本的VCF文件，查找影响任一链上CpG任一碱基的任何变异：在CpG胞嘧啶处，任何非胞嘧啶的替换；在相邻的鸟嘌呤处，任何非鸟嘌呤的替换；以及在$2$个核苷酸窗口内的单碱基indel，这些indel会使得$5'$端的胞嘧啶或$3'$端的鸟嘌呤被删除，或创建一个新的CpG（例如，在胞嘧啶旁边插入一个鸟嘌呤）。屏蔽这些位置，或使用变异等位基因频率调整甲基化估计值。对于一个消除CpG的SNP，若其等位基因频率为$p$，则朴素估计值的期望满足$\\hat{m} = (1-p)\\,m$，其中$m$是仍然含有CpG的等位基因上的真实甲基化水平，因此校正后的估计值为$\\tilde{m} = \\hat{m}/(1-p)$。当$N = 360$, $n_C = 108$, $n_T = 252$, $p = 0.25$时，$\\hat{m} = 0.30$，得出$\\tilde{m} = 0.30/0.75 = 0.40$。朴素估计值因一个乘法因子$(1-p)$和一个绝对偏移$-p\\,m$而向下偏倚。\nB. 仅识别正向（参考）链上胞嘧啶位置的SNP；忽略鸟嘌呤和反向链互补链上的变异，并忽略indel。通过将朴素估计值乘以$(1-p)$来校正消除CpG的SNP，即$\\tilde{m} = (1-p)\\,\\hat{m}$。当$p = 0.25$且$\\hat{m} = 0.30$时，报告$\\tilde{m} = 0.225$并声明如果比对质量高，则朴素估计值是无偏的。\nC. 使用群体次要等位基因频率（MAF）阈值来标记位点，而不考虑样本的VCF或链对称性，并通过加法调整$\\tilde{m} = \\hat{m} + p$来校正消除CpG的SNP。当$p = 0.25$且$\\hat{m} = 0.30$时，报告$\\tilde{m} = 0.55$，并声称朴素估计值向下偏倚$p$，而与真实甲基化水平$m$无关。\nD. 依赖于亚硫酸氢盐感知型比对工具来忽略由SNP引起的错配，假设来自消除CpG的等位基因的读数不会对CpG位置的胞嘧啶/胸腺嘧啶计数有贡献。因此，不需要特殊的识别/过滤，朴素估计值等于真实甲基化水平（$\\hat{m} = m$）。当$N = 360$, $n_C = 108$, $n_T = 252$时，报告$\\tilde{m} = 0.30$且无偏倚。\nE. 识别胞嘧啶处的变异，但将相邻鸟嘌呤处的变化视为无害，因为鸟嘌呤不直接被亚硫酸氢盐化学反应转化；仅当indel超过5个碱基时才将其纳入考虑。通过$\\tilde{m} = (\\hat{m}-p)/(1-p)$来校正消除CpG的SNP，得出$\\tilde{m} = (0.30-0.25)/0.75 \\approx 0.0667$，并得出结论：无论$m$为何值，朴素估计值都精确地向下偏倚$p$。",
            "solution": "用户提供了一个关于在存在单核苷酸多态性（SNP）的情况下分析全基因组亚硫酸氢盐测序（WGBS）DNA甲基化数据的问题。任务是验证问题，解释处理此类遗传变异的原则，并计算校正后的甲基化估计值。\n\n### 第一步：提取已知条件\n\n-   **分析方法：** 全基因组亚硫酸氢盐测序（WGBS）\n-   **生物学背景：** 癌症活检样本，在目标基因座上近似为二倍体，无拷贝数变异。\n-   **目标位点：** 一个参考CpG位点（正向链上的一个胞嘧啶后跟一个鸟嘌呤）。\n-   **亚硫酸氢盐转化化学：** 未甲基化的胞嘧啶（C）转化为尿嘧啶（U），在测序中被读取为胸腺嘧啶（T）。甲基化的胞嘧啶（mC）受到保护不被转化，仍为C。\n-   **CpG位点的测序数据：**\n    -   总读数覆盖度：$N = 360$。\n    -   观察到的胞嘧啶计数：$n_C = 108$。\n    -   观察到的胸腺嘧啶计数：$n_T = 252$。（注意：$n_C + n_T = 108 + 252 = 360 = N$，数据一致）。\n-   **朴素甲基化估计量：** $\\hat{m} = n_C / (n_C + n_T)$。\n-   **遗传变异信息（来自VCF文件）：**\n    -   在CpG胞嘧啶处存在一个单核苷酸多态性（SNP）：$C \\to T$。\n    -   该SNP消除了携带该变异的等位基因上的CpG位点。\n    -   变异等位基因频率为 $p = 0.25$。\n    -   在相邻的鸟嘌呤处没有检出变异。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学基础：** 该问题牢固地建立在分子生物学、基因组学和生物信息学的既定原则之上。对CpG位点、亚硫酸氢盐测序化学、甲基化估计以及SNP对甲基化检出产生的混淆效应的描述，都是表观遗传学领域中标准且科学准确的概念。\n-   **适定性：** 问题是适定的。它提供了所有必需的定量数据（$N$, $n_C$, $n_T$, $p$）和一组明确的假设（二倍体基因座，无其他变异），从而可以推导出一个唯一的、校正后的甲基化估计值。问题的定性部分，即要求给出通用策略，也在该领域的背景下定义明确。\n-   **客观性：** 问题陈述使用精确、客观、技术性的语言表达，没有歧义或主观性陈述。\n\n-   **缺陷清单评估：**\n    1.  **科学/事实不健全：** 无。前提在事实上是正确的。\n    2.  **非形式化/不相关：** 无。该问题是定量基因组学中一个标准的、可形式化的问题。\n    3.  **不完整/矛盾的设置：** 无。给定的数据是完整的且内部一致（$n_C + n_T = N$）。\n    4.  **不切实际/不可行：** 无。覆盖深度、读数计数和等位基因频率对于典型的杂合SNP的WGBS实验来说都是 realistic 的值。\n    5.  **不适定/结构不良：** 无。可以从提供的信息中推导出唯一的解。\n    6.  **伪深刻/琐碎：** 无。该问题解决了亚硫酸氢盐测序分析中一个真实且不平凡的挑战，需要仔细的定量推理。\n    7so.  **超出科学可验证性范围：** 无。该模型及其预测是可验证的。\n\n### 第三步：结论与行动\n\n问题陈述是**有效的**。我将继续推导解决方案并评估选项。\n\n### 求解推导\n\n**第一部分：识别和过滤受变异影响的CpG位点的一般策略**\n\nCpG位点是一个二核苷酸，$5'$-C-G-$3'$。由于DNA的互补性，正向链上的一个CpG对应于反向链上的一个CpG（反向互补链上的$5'$-C-G-$3'$）。因此，一个稳健的分析必须考虑可能在任一链上破坏此二核苷酸的变异。\n\n变异可以产生或消除一个CpG位点。\n1.  **消除CpG：**\n    -   正向链上胞嘧啶位置的替换（例如，$C \\to T$、$C \\to A$或$C \\to G$）直接移除了甲基化位点。\n    -   正向链上鸟嘌呤位置的替换（例如，$G \\to A$、$G \\to T$或$G \\to C$）破坏了CpG上下文。这也对应于反向链CpG的胞嘧啶发生$C \\to T$、$C \\to A$或$C \\to G$替换，从而消除了它。\n    -   移除C或G的短删除。\n    -   在C和G之间的短插入（例如，$CG \\to CTG$）。\n2.  **产生CpG：**\n    -   在原先没有C后跟G的地方，通过替换产生一个（例如，$TG \\to CG$或$CA \\to CG$）。\n    -   导致新的CG二核苷酸的indel。\n\n因此，一个科学上合理的识别和过滤策略需要将变异检出数据（例如，来自VCF文件）与CpG位点位置整合起来。具体来说，必须扫描VCF文件，查找任何位置与CpG二核苷酸的两碱基对窗口重叠的变异——无论是SNP还是短indel。任何受此类变异影响的位点都应被屏蔽（从分析中排除），或者如果可以从非亚硫酸氢盐测序数据中获得变异等位基因频率，则使用该频率校正其甲基化估计值。\n\n**第二部分：甲基化估计的定量校正**\n\n令 $m$ 为真正含有CpG位点的等位基因上胞嘧啶的真实甲基化比例。\n令 $p$ 为SNP（$C \\to T$）的变异等位基因频率。\n参考（含C）等位基因的比例是 $(1-p)$。\n变异（含T）等位基因的比例是 $p$。\n\n覆盖该位置的总读数数量为 $N$。这些读数是从两个等位基因群体中抽样的。\n-   来自参考（含C）等位基因的读数数量期望为 $N_{ref} = N(1-p)$。\n-   来自变异（含T）等位基因的读数数量期望为 $N_{var} = Np$。\n\n现在，我们来建模亚硫酸氢盐测序后观察到的C和T的期望计数。\n-   观察到的胞嘧啶（$C$）只能来自参考等位基因上的甲基化胞嘧啶。其期望计数为 $E[n_C] = N_{ref} \\times m = N(1-p)m$。\n-   观察到的胸腺嘧啶（$T$）可能来自两个来源：\n    1.  参考等位基因上的未甲基化胞嘧啶，它被转化为T。其期望计数为 $N_{ref} \\times (1-m) = N(1-p)(1-m)$。\n    2.  来自变异等位基因的胸腺嘧啶，它被读取为T。其期望计数为 $N_{var} = Np$。\n    胸腺嘧啶的总期望计数为 $E[n_T] = N(1-p)(1-m) + Np$。\n\n朴素甲基化估计值 $\\hat{m}$ 定义为观察到的C读数的比例：\n$$ \\hat{m} = \\frac{n_C}{N} = \\frac{n_C}{n_C + n_T} $$\n该估计量的期望值为：\n$$ E[\\hat{m}] = \\frac{E[n_C]}{N} = \\frac{N(1-p)m}{N} = (1-p)m $$\n这表明朴素估计量 $\\hat{m}$ 是真实甲基化水平 $m$ 的一个有偏估计量。偏差为 $E[\\hat{m}] - m = (1-p)m - m = -pm$。朴素估计值是一个低估值，其偏差的大小取决于等位基因频率 $p$ 和真实甲基化水平 $m$。\n\n为了找到 $m$ 的校正估计量（我们记为 $\\tilde{m}$），我们可以重排关系式 $E[\\hat{m}] = (1-p)m$。我们使用观察值 $\\hat{m}$作为其期望 $E[\\hat{m}]$ 的估计。\n$$ \\hat{m} \\approx (1-p)m $$\n解出 $m$ 得到校正估计量：\n$$ \\tilde{m} = \\frac{\\hat{m}}{1-p} $$\n\n**第三部分：使用给定数据进行计算**\n\n-   $N = 360$，$n_C = 108$，$n_T = 252$。\n-   $p = 0.25$。\n\n首先，计算朴素甲基化估计值：\n$$ \\hat{m} = \\frac{n_C}{N} = \\frac{108}{360} = 0.30 $$\n接下来，使用推导出的公式计算校正后的甲基化估计值：\n$$ \\tilde{m} = \\frac{\\hat{m}}{1-p} = \\frac{0.30}{1 - 0.25} = \\frac{0.30}{0.75} = \\frac{30}{75} = \\frac{2}{5} = 0.40 $$\n含有CpG的等位基因的校正甲基化水平为 $0.40$ 或 $40\\%$。\n\n让我们用原始计数来验证这个结果。如果真实甲基化水平 $m=0.40$：\n-   期望的 $n_C = N(1-p)m = 360 \\times (1-0.25) \\times 0.40 = 360 \\times 0.75 \\times 0.40 = 270 \\times 0.40 = 108$。\n-   期望的 $n_T = N(1-p)(1-m) + Np = 360 \\times 0.75 \\times (1-0.40) + 360 \\times 0.25 = 270 \\times 0.60 + 90 = 162 + 90 = 252$。\n计算出的真实甲基化水平完美地解释了观察到的读数计数。\n\n### 逐项分析选项\n\n**A. 扫描样本的VCF文件，查找影响任一链上CpG任一碱基的任何变异...以及单碱基indel...屏蔽这些位置，或使用变异等位基因频率调整甲基化估计值...对于一个消除CpG的SNP，若其等位基因频率为$p$，则朴素估计值的期望满足$\\hat{m} = (1-p)\\,m$...因此校正后的估计值为$\\tilde{m} = \\hat{m}/(1-p)$。当$N = 360$, $n_C = 108$, $n_T = 252$, $p = 0.25$时，$\\hat{m} = 0.30$，得出$\\tilde{m} = 0.30/0.75 = 0.40$。朴素估计值因一个乘法因子$(1-p)$和一个绝对偏移$-p\\,m$而向下偏倚。**\n-   **识别策略：** 正确。该策略是全面的，考虑了CpG的两个碱基，从而也考虑了双链，以及相关的短indel。\n-   **校正公式：** 正确。公式 $\\tilde{m} = \\hat{m}/(1-p)$ 与从基本原理推导出的完全一致。\n-   **计算：** 正确。$\\hat{m} = 108/360 = 0.30$，且 $\\tilde{m} = 0.30/0.75 = 0.40$。\n-   **偏差描述：** 正确。期望 $E[\\hat{m}]$ 确实是 $(1-p)m$，绝对偏差是 $E[\\hat{m}] - m = -pm$。\n-   **结论：** **正确**。\n\n**B. 仅识别正向（参考）链上胞嘧啶位置的SNP；忽略鸟嘌呤和反向链互补链上的变异，并忽略indel。校正...通过乘以...$\\tilde{m} = (1-p)\\,\\hat{m}$。当$p = 0.25$且$\\hat{m} = 0.30$时，报告$\\tilde{m} = 0.225$并声明...朴素估计值是无偏的...**\n-   **识别策略：** 不正确。该策略不完整，会漏掉许多破坏CpG的变异。\n-   **校正公式：** 不正确。公式应该是除以 $(1-p)$，而不是乘以。\n-   **计算：** 对于错误的公式，$0.30 \\times 0.75 = 0.225$ 的计算在算术上是正确的。但结果估计值不正确。\n-   **偏差描述：** 不正确。朴素估计值明显是有偏的。\n-   **结论：** **不正确**。\n\n**C. 使用群体次要等位基因频率（MAF）阈值...而不考虑样本的VCF...校正...通过加法调整$\\tilde{m} = \\hat{m} + p$。当$p = 0.25$且$\\hat{m} = 0.30$时，报告$\\tilde{m} = 0.55$，并声稱朴素估计值向下偏倚$p$，而与真实甲基化水平$m$无关。**\n-   **识别策略：** 不正确。样本特异性的VCF优于群体MAF。\n-   **校正公式：** 不正确。公式 $\\tilde{m} = \\hat{m} + p$ 不是从底层模型推导出来的。\n-   **计算：** 对于错误的公式，$0.30 + 0.25 = 0.55$ 的计算在算术上是正确的。但结果不正确。\n-   **偏差描述：** 不正确。偏差是 $-pm$，不是一个常数 $-p$。\n-   **结论：** **不正确**。\n\n**D. 依赖于亚硫酸氢盐感知型比对工具来忽略由SNP引起的错配，假设来自消除CpG的等位基因的读数不会对胞嘧啶/胸腺嘧啶计数有贡献...不需要特殊的识别/过滤，朴素估计值等于真实甲基化水平...报告$\\tilde{m} = 0.30$且无偏倚。**\n-   **识别策略：** 不正确。这表明对亚硫酸氢盐比对工具的工作原理有误解。它们无法区分遗传的T和亚硫酸氢盐转化的T。来自变异等位基因的读数肯定会对计数产生贡献。\n-   **校正公式：** 不正确。它声称不需要校正。\n-   **结论：** 不正确。朴素估计值是有偏的，因此报告 $\\tilde{m} = \\hat{m} = 0.30$ 是错误的。\n-   **结论：** **不正确**。\n\n**E. 识别胞嘧啶处的变异，但将相邻鸟嘌呤处的变化视为无害...仅当indel超过5个碱基时才将其纳入考虑。校正...通过$\\tilde{m} = (\\hat{m}-p)/(1-p)$，得出$\\tilde{m} = (0.30-0.25)/0.75 \\approx 0.0667$，并得出结论...朴素估计值都精确地向下偏倚$p$而与$m$无关。**\n-   **识别策略：** 不正确。鸟嘌呤处的变化并非无害，且indel阈值是武断且不恰当的。\n-   **校正公式：** 不正确。公式 $\\tilde{m} = (\\hat{m}-p)/(1-p)$ 无法从基本原理证明，并会导致一个有偏的估计量。\n-   **计算：** 对于错误的公式，$(0.30-0.25)/0.75 \\approx 0.0667$ 的计算在算術上是正确的。但结果不正确。\n-   **偏差描述：** 不正确。再次强调，偏差是 $-pm$，不是一个常数值。\n-   **结论：** **不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在比较生物学重复样本时，我们观察到的数据变异性常常超出简单的二项抽样误差所能解释的范围。这种被称为“过度离散”（overdispersion）的现象源于样本间真实的生物学异质性，例如细胞类型组分或表观遗传状态的差异。本高级练习将指导您构建一个贝叶斯分层模型（Beta-Binomial模型），通过推导后验均值，您将学会如何获得一个更稳健的甲基化“收缩”估计量，该估计量能够恰当地整合抽样变异和生物学变异。",
            "id": "4334596",
            "problem": "在精准肿瘤学中，启动子区域的胞嘧啶甲基化可以调节基因表达并影响临床表型。亚硫酸氢钠处理结合高通量测序（亚硫酸氢盐测序）将未甲基化的胞嘧啶转化为尿嘧啶（读取为胸腺嘧啶），而甲基化的胞嘧啶则保持为胞嘧啶。在通过全基因组亚硫酸氢盐测序（WGBS）检测的单个胞嘧啶-磷酸-鸟嘌呤（CpG）位点上，考虑 $R$ 个生物学重复。在重复 $r \\in \\{1,\\dots,R\\}$ 中，假设有 $n_r$ 个独立读段覆盖了该 CpG 位点，其中 $y_r$ 个读段报告了甲基化（即观察到胞嘧啶）。令 $p_r$ 表示重复 $r$ 中的真实甲基化概率。假设相对于生物学变异，亚硫酸氢盐转化和碱基识别错误可以忽略不计，因此在以 $p_r$ 为条件的每个读段都是成功概率为 $p_r$ 的伯努利试验。\n\n为了解释由异质性（例如，细胞类型混合和表观遗传变异）引起的生物学重复间的过度离散，我们使用一个分层公式来建模重复特异性的甲基化概率，其中 $p_r$ 是来自参数为 $(\\alpha,\\beta)$ 的 Beta 分布的独立抽样：\n- 条件抽样：$Y_r \\mid p_r \\sim \\mathrm{Binomial}(n_r, p_r)$，\n- 随机效应：$p_r \\sim \\mathrm{Beta}(\\alpha,\\beta)$，\n对于一个固定的 CpG 位点，所有重复共享相同的 $(\\alpha,\\beta)$。\n\n从二项分布和 Beta 分布的定义，以及 Beta 函数 $B(a,b) = \\int_{0}^{1} t^{a-1} (1-t)^{b-1} \\,\\mathrm{d}t$（对于 $a>0, b>0$）出发，完成以下任务：\n\n- 通过对 $p_r$ 进行积分，构建 $Y_r$ 的边际抽样模型，从而建立一个能用 $(\\alpha,\\beta)$ 和 $n_r$ 来描述重复间过度离散的 Beta-二项分布。\n- 利用 Beta 分布对于二项似然的共轭性，在 Beta 先验 $\\mathrm{Beta}(\\alpha,\\beta)$ 下，根据观测计数 $(y_r, n_r)$ 推导 $p_r$ 的后验分布。\n- 从该后验分布中，推导出后验均值 $\\mathbb{E}[\\,p_r \\mid y_r, n_r, \\alpha, \\beta\\,]$，并将其表示为关于 $(\\alpha,\\beta,y_r,n_r)$ 的封闭形式解析表达式。\n\n你的最终答案必须是 $p_r$ 后验均值的封闭形式解析表达式。不需要进行数值计算。如果引入任何角度量，请以弧度表示。如果引入任何物理单位，请明确说明；然而，对于此问题，最终表达式中没有物理单位。不要将答案写成不等式或方程；仅提供一个封闭形式的表达式。",
            "solution": "问题陈述已经过评估并被认为是有效的。它在统计基因组学领域，特别是在用于DNA甲基化的亚硫酸氢盐测序数据分析方面，具有科学依据。该问题设定良好，提供了一个完整且一致的分层统计模型，并要求推导一个明确定义的特定量（后验均值）。所用语言客观、正式。任务结构逻辑清晰，需要进行贝叶斯统计学中标准的、非平凡的推导。不存在矛盾、歧义或事实错误。\n\n该问题要求推导在重复 $r$ 中给定 CpG 位点的甲基化概率 $p_r$ 的后验均值。该模型被指定为分层结构：\n1.  在总共 $n_r$ 个读段中观测到 $y_r$ 个甲基化读段的似然，由一个以真实甲基化概率 $p_r$ 为条件的二项分布给出：\n    $$P(Y_r = y_r \\mid p_r, n_r) = \\binom{n_r}{y_r} p_r^{y_r} (1-p_r)^{n_r-y_r}$$\n    这是 $\\mathrm{Binomial}(n_r, p_r)$ 分布的概率质量函数（PMF）。\n\n2.  重复特异性甲基化概率 $p_r$ 的先验分布，由一个带有超参数 $\\alpha$ 和 $\\beta$ 的 Beta 分布给出：\n    $$f(p_r \\mid \\alpha, \\beta) = \\frac{p_r^{\\alpha-1} (1-p_r)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n    这是 $\\mathrm{Beta}(\\alpha, \\beta)$ 分布的概率密度函数（PDF），其中 $B(\\alpha, \\beta)$ 是 Beta 函数，定义为 $B(\\alpha,\\beta) = \\int_{0}^{1} t^{\\alpha-1} (1-t)^{\\beta-1} \\,\\mathrm{d}t$。\n\n问题要求进行三个推导。我们将逐步进行。\n\n**任务1：构建 $Y_r$ 的边际抽样模型。**\n观测到 $y_r$ 个甲基化读段的边际概率，是通过将似然与先验的乘积对 $p_r \\in [0, 1]$ 的所有可能值进行积分得到的。这个过程称为边际化。\n\n$$P(Y_r = y_r \\mid n_r, \\alpha, \\beta) = \\int_{0}^{1} P(Y_r = y_r \\mid p_r, n_r) f(p_r \\mid \\alpha, \\beta) \\, \\mathrm{d}p_r$$\n\n代入二项分布 PMF 和 Beta 分布 PDF 的表达式：\n$$P(Y_r = y_r \\mid n_r, \\alpha, \\beta) = \\int_{0}^{1} \\left[ \\binom{n_r}{y_r} p_r^{y_r} (1-p_r)^{n_r-y_r} \\right] \\left[ \\frac{p_r^{\\alpha-1} (1-p_r)^{\\beta-1}}{B(\\alpha, \\beta)} \\right] \\, \\mathrm{d}p_r$$\n\n我们可以将不依赖于 $p_r$ 的项移到积分符号外：\n$$P(Y_r = y_r \\mid n_r, \\alpha, \\beta) = \\frac{\\binom{n_r}{y_r}}{B(\\alpha, \\beta)} \\int_{0}^{1} p_r^{y_r} (1-p_r)^{n_r-y_r} p_r^{\\alpha-1} (1-p_r)^{\\beta-1} \\, \\mathrm{d}p_r$$\n\n合并 $p_r$ 和 $(1-p_r)$ 的幂：\n$$P(Y_r = y_r \\mid n_r, \\alpha, \\beta) = \\frac{\\binom{n_r}{y_r}}{B(\\alpha, \\beta)} \\int_{0}^{1} p_r^{(y_r + \\alpha) - 1} (1-p_r)^{(n_r - y_r + \\beta) - 1} \\, \\mathrm{d}p_r$$\n\n根据定义，右侧的积分是 Beta 函数 $B(y_r + \\alpha, n_r - y_r + \\beta)$。因此，边际概率为：\n$$P(Y_r = y_r \\mid n_r, \\alpha, \\beta) = \\binom{n_r}{y_r} \\frac{B(y_r + \\alpha, n_r - y_r + \\beta)}{B(\\alpha, \\beta)}$$\n这是 Beta-二项分布的概率质量函数，记为 $Y_r \\sim \\mathrm{BetaBinomial}(n_r, \\alpha, \\beta)$。该模型正确地捕捉了过度离散现象，因为它的方差大于具有固定概率的简单二项模型的方差。\n\n**任务2：推导 $p_r$ 的后验分布。**\n使用贝叶斯定理，给定观测数据 $(y_r, n_r)$ 和超参数 $(\\alpha, \\beta)$，$p_r$ 的后验分布正比于似然与先验的乘积：\n$$f(p_r \\mid y_r, n_r, \\alpha, \\beta) \\propto P(Y_r = y_r \\mid p_r, n_r) \\cdot f(p_r \\mid \\alpha, \\beta)$$\n\n代入似然和先验的函数形式，并省略常数因子（不依赖于 $p_r$ 的项，如 $\\binom{n_r}{y_r}$ 和 $1/B(\\alpha, \\beta)$）：\n$$f(p_r \\mid y_r, n_r, \\alpha, \\beta) \\propto \\left[ p_r^{y_r} (1-p_r)^{n_r-y_r} \\right] \\cdot \\left[ p_r^{\\alpha-1} (1-p_r)^{\\beta-1} \\right]$$\n\n合并指数：\n$$f(p_r \\mid y_r, n_r, \\alpha, \\beta) \\propto p_r^{y_r + \\alpha - 1} (1-p_r)^{n_r - y_r + \\beta - 1}$$\n\n这个表达式是 Beta 分布的核。我们可以识别出 $p_r$ 的后验分布是一个带有更新后参数 $\\alpha'$ 和 $\\beta'$ 的 Beta 分布：\n$$\\alpha' = y_r + \\alpha$$\n$$\\beta' = n_r - y_r + \\beta$$\n因此，后验分布为：\n$$p_r \\mid y_r, n_r, \\alpha, \\beta \\sim \\mathrm{Beta}(y_r + \\alpha, n_r - y_r + \\beta)$$\n这个结果说明了 Beta 先验与二项似然的共轭性：后验分布与先验分布属于同一族（Beta 族）。\n\n**任务3：推导后验均值 $\\mathbb{E}[\\,p_r \\mid y_r, n_r, \\alpha, \\beta\\,]$。**\n服从 Beta 分布 $\\mathrm{Beta}(a, b)$ 的随机变量 $X$ 的期望值（均值）由公式 $\\mathbb{E}[X] = \\frac{a}{a+b}$ 给出。\n\n我们将此公式应用于我们的 $p_r$ 后验分布，即 $\\mathrm{Beta}(\\alpha', \\beta')$，其中 $\\alpha' = y_r + \\alpha$ 和 $\\beta' = n_r - y_r + \\beta$。因此，后验均值为：\n$$\\mathbb{E}[p_r \\mid y_r, n_r, \\alpha, \\beta] = \\frac{\\alpha'}{\\alpha' + \\beta'}$$\n\n代入 $\\alpha'$ 和 $\\beta'$ 的表达式：\n$$\\mathbb{E}[p_r \\mid y_r, n_r, \\alpha, \\beta] = \\frac{y_r + \\alpha}{(y_r + \\alpha) + (n_r - y_r + \\beta)}$$\n\n化简分母：\n$$\\mathbb{E}[p_r \\mid y_r, n_r, \\alpha, \\beta] = \\frac{y_r + \\alpha}{y_r + \\alpha + n_r - y_r + \\beta} = \\frac{y_r + \\alpha}{n_r + \\alpha + \\beta}$$\n\n这个最终表达式是甲基化概率 $p_r$ 后验均值的封闭形式解析解。它可以被解释为一个“收缩”估计量，其中样本比例 $\\frac{y_r}{n_r}$ 被调整到朝向先验均值 $\\frac{\\alpha}{\\alpha+\\beta}$，调整的程度由样本大小 $n_r$ 和由 $\\alpha+\\beta$ 概括的先验强度决定。",
            "answer": "$$\\boxed{\\frac{y_r + \\alpha}{n_r + \\alpha + \\beta}}$$"
        }
    ]
}