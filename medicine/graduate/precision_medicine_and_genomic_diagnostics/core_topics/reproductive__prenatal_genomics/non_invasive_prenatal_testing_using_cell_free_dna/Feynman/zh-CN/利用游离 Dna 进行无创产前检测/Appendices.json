{
    "hands_on_practices": [
        {
            "introduction": "无创产前检测（NIPT）的核心在于识别特定染色体相较于正常参考群体的异常富集或缺失。$z$分数是将观测到的染色体片段比例与基线分布进行比较的标准化统计量，是判断非整倍体风险的主要依据。本练习将指导您完成这一基础但至关重要的计算，将原始测序读数转化为可解释的风险信号。",
            "id": "5141282",
            "problem": "在对游离DNA进行无创产前检测(NIPT)的浅层全基因组测序中，对于$21$号染色体的非整倍体检测，可以通过将观测到的特定染色体读数分数与一组整倍体妊娠样本在经过偏倚校正（例如，鸟嘌呤-胞嘧啶含量和可比对性归一化）后得到的参考分布进行比较来构建。\n\n考虑一个样本，其共有$30{,}000{,}000$条唯一比对的常染色体读数，其中$1{,}050{,}000$条比对到$21$号染色体。在相同的归一化和计数方案下，整倍体参考队列产生的$21$号染色体平均分数为$0.015$，样本间标准差为$0.0005$。\n\n从标准化的基本统计概念出发——即在整倍体的零假设下，将观测分数视为一个由参考均值和标准差表征的分布的实现——并假设由于读数数量巨大，标准化离差近似服从标准正态分布，请计算该样本中$21$号染色体的标准化离差（$z$分数）。\n\n然后，在一个使用双侧正态截断值$|z| \\ge 3$的研究环境中，解释该结果是否与用于标记潜在$21$三体判断的$21$号染色体占比过高的情况一致。\n\n在最终数值答案中，仅报告$z$分数，形式为一个纯数字，四舍五入至三位有效数字。不需要单位。",
            "solution": "该问题要求计算在一次无创产前检测中，对应于$21$号染色体的测序读数分数的标准化离差，即$z$分数。该分数用于评估观测到的分数是否在统计上偏离了整倍体样本的参考群体，这种偏离可能预示着像$21$三体这样的染色体非整倍体。\n\n首先，我们必须确定给定样本中$21$号染色体的观测读数分数。设$N_{total}$为唯一比对的常染色体读数总数，$N_{21}$为比对到$21$号染色体的读数数量。\n\n给定值为：\n常染色体读数总数，$N_{total} = 30{,}000{,}000$。\n$21$号染色体读数，$N_{21} = 1{,}050{,}000$。\n\n$21$号染色体的观测读数分数，记为$f_{obs}$，是$N_{21}$与$N_{total}$的比值：\n$$f_{obs} = \\frac{N_{21}}{N_{total}}$$\n代入给定值：\n$$f_{obs} = \\frac{1{,}050{,}000}{30{,}000{,}000} = \\frac{1.05}{30} = 0.035$$\n\n接下来，我们计算$z$分数。$z$分数是衡量一个观测值偏离参考分布均值的标准差倍数。问题指明参考分布来源于一个整倍体队列，并给出了其均值和标准差。\n\n设$\\mu_{ref}$为参考整倍体队列中$21$号染色体的平均分数，$\\sigma_{ref}$为该分数的样本间标准差。问题提供：\n参考分数的均值，$\\mu_{ref} = 0.015$。\n参考分数的标准差，$\\sigma_{ref} = 0.0005$。\n\n$z$分数的计算公式为：\n$$z = \\frac{f_{obs} - \\mu_{ref}}{\\sigma_{ref}}$$\n\n代入计算出的$f_{obs}$和给定的参考参数：\n$$z = \\frac{0.035 - 0.015}{0.0005}$$\n$$z = \\frac{0.020}{0.0005}$$\n为了简化分数，我们可以将分子和分母表示为科学记数法或整数比：\n$$z = \\frac{2 \\times 10^{-2}}{5 \\times 10^{-4}} = \\frac{2}{5} \\times 10^{-2 - (-4)} = 0.4 \\times 10^{2} = 40$$\n\n计算得出该样本中$21$号染色体的$z$分数恰好为$40$。\n\n问题还要求在一个研究背景下对这个结果进行解释，在该背景下，如果$z$分数的绝对值$|z|$大于或等于$3$，则标记为潜在的$21$三体。\n在我们的案例中， $|z| = |40| = 40$。\n由于$40 \\ge 3$，观测到的$21$号染色体读数分数比整倍体参考群体的均值高出$40$个标准差。这是一个非常强的统计信号，表明$21$号染色体存在显著的占比过高。这样的结果与胎儿基因组中存在额外一条$21$号染色体的情况高度一致，并且会被标记为$21$三体高风险。\n\n最终答案要求$z$分数是一个纯数字，并四舍五入到三位有效数字。精确值为$40$。为了用三位有效数字表示，我们写作$40.0$。",
            "answer": "$$\\boxed{40.0}$$"
        },
        {
            "introduction": "NIPT 检测的灵敏度和特异性在很大程度上取决于样本中胎儿来源的无细胞 DNA (cfDNA) 的比例，即胎儿分数（fetal fraction）。准确估算胎儿分数是确保检测质量和结果可靠性的关键步骤。本练习模拟了在怀有男性胎儿的情况下，如何利用 Y 染色体独有的测序读数来推导并计算胎儿分数及其置信区间。",
            "id": "5067552",
            "problem": "一个进行无创产前检测 (NIPT) 的实验室，使用母体血浆中的游离脱氧核糖核酸 (cfDNA)，对映射到常染色体特有区域或 Y 染色体特有区域的序列进行读取。考虑一次怀有男性胎儿的妊娠，并假设怀孕个体的核型为 $46,\\mathrm{XX}$，因此任何 Y 染色体 cfDNA 仅来源于胎儿。假设测序读段是均匀随机抽样的，其预期读段数与目标区域的拷贝数和可作图的单倍体长度成正比。设 $L_{A}$ 表示常染色体特有序列的总可作图单倍体长度，$L_{Y}$ 表示 Y 染色体特有序列的可作图单倍体长度。母体和胎儿的常染色体都以两份拷贝的形式存在。\n\n您观察到 $k_{Y}$ 个读段映射到 Y 染色体特有区域，以及 $N$ 个读段映射到常染色体特有区域。设 $T = N + k_{Y}$ 表示映射到这些目标集合的总读段数。设 $f$ 表示胎儿分数，定义为源自胎儿的 cfDNA 分子所占的比例。\n\n仅从上述比例抽样假设出发，首先根据观测比例 $q = k_{Y}/T$ 和已知常数 $L_{A}$ 和 $L_{Y}$ 推导 $f$ 的一个估计量。然后，使用以下数据，\n- $k_{Y} = 1{,}800$，\n- $N = 9{,}000{,}000$，\n- $L_{A} = 2.7 \\times 10^{9}$ 碱基对，\n- $L_{Y} = 1.0 \\times 10^{7}$ 碱基对，\n计算 $f$ 的点估计值。\n\n接下来，将 $k_{Y}$ 建模为参数为 $T$ 和 $q$ 的二项随机变量，并使用不带连续性校正的威尔逊得分法构建 $q$ 的双侧 $95\\%$ 置信区间（使用 $z_{0.975} = 1.96$）。通过将您的估计量应用于区间的端点，将此区间映射为 $f$ 的 $95\\%$ 置信区间。按此顺序报告三个值：$f$ 的点估计值，$f$ 的 $95\\%$ 置信区间的下限，以及 $f$ 的 $95\\%$ 置信区间的上限。将这三个值全部表示为小数（而非百分比），并各保留四位有效数字。",
            "solution": "第 1 部分：$f$ 的估计量的推导。\n\n设 $f$ 为胎儿分数，即母体血浆中源自胎儿的 cfDNA 分子的比例。怀孕个体的核型为 $46,\\mathrm{XX}$，胎儿为男性，$46,\\mathrm{XY}$。因此，所有来自 Y 染色体的 cfDNA 片段都源自胎儿。\n\n核心假设是测序读段的预期数量与染色体/区域的拷贝数及其可作图单倍体长度成正比。设 $\\kappa$ 为此比例常数。\n\n样本中常染色体 DNA 的总量由母亲和胎儿共同贡献。\n- 母体常染色体贡献与 $(1-f) \\times 2 \\times L_A$ 成正比，因为母亲每个常染色体有两份拷贝。\n- 胎儿常染色体贡献与 $f \\times 2 \\times L_A$ 成正比，因为胎儿每个常染色体也有两份拷贝。\n映射到常染色体特有区域的读段的预期数量 $E[N]$，与这些贡献的总和成正比：\n$$ E[N] = \\kappa \\left( (1-f) \\cdot 2L_A + f \\cdot 2L_A \\right) = \\kappa \\cdot 2L_A $$\n\n来自 Y 染色体的 cfDNA 仅来自胎儿。\n- 胎儿 Y 染色体贡献与 $f \\times 1 \\times L_Y$ 成正比，因为男性胎儿有一份 Y 染色体拷贝。\n- 母体 Y 染色体贡献为 $0$。\n映射到 Y 染色体特有区域的读段的预期数量 $E[k_Y]$ 为：\n$$ E[k_Y] = \\kappa \\cdot f L_Y $$\n\nY 染色体读段的理论比例（我们记为 $p_Y$）是 Y 染色体读段的预期数量与常染色体和 Y 染色体区域总预期读段数量的比值。\n$$ p_Y = \\frac{E[k_Y]}{E[N] + E[k_Y]} = \\frac{\\kappa f L_Y}{\\kappa \\cdot 2L_A + \\kappa f L_Y} = \\frac{f L_Y}{2L_A + f L_Y} $$\n我们可以使用观测比例 $q = \\frac{k_Y}{T} = \\frac{k_Y}{N+k_Y}$ 来估计这个理论比例 $p_Y$。通过令 $q = p_Y$，我们得到一个求解 $f$ 的方程：\n$$ q = \\frac{f L_Y}{2L_A + f L_Y} $$\n为了找到 $f$ 的估计量，我们整理这个方程：\n$$ q(2L_A + f L_Y) = f L_Y $$\n$$ 2qL_A + qfL_Y = f L_Y $$\n$$ 2qL_A = f L_Y - qfL_Y $$\n$$ 2qL_A = f(L_Y(1-q)) $$\n$$ f = \\frac{2qL_A}{L_Y(1-q)} $$\n这可以根据观测计数 $N$ 和 $k_Y$ 重写。由于 $q = k_Y/T$ 且 $1-q = N/T$，比率 $\\frac{q}{1-q} = \\frac{k_Y/T}{N/T} = \\frac{k_Y}{N}$。将此代入 $f$ 的表达式中：\n$$ \\hat{f} = \\frac{2L_A}{L_Y} \\frac{k_Y}{N} $$\n这就是所求的 $f$ 的估计量。\n\n第 2 部分：$f$ 的点估计值。\n\n我们已知以下数据：\n- $k_Y = 1800$\n- $N = 9000000$\n- $L_A = 2.7 \\times 10^9$ 碱基对\n- $L_Y = 1.0 \\times 10^7$ 碱基对\n\n首先，我们计算长度比和读段数比：\n$$ \\frac{2L_A}{L_Y} = \\frac{2 \\times 2.7 \\times 10^9}{1.0 \\times 10^7} = \\frac{5.4 \\times 10^9}{1.0 \\times 10^7} = 540 $$\n$$ \\frac{k_Y}{N} = \\frac{1800}{9000000} = \\frac{18}{90000} = \\frac{2}{10000} = 0.0002 $$\n现在，我们将这些值代入估计量 $\\hat{f}$ 中：\n$$ \\hat{f} = 540 \\times 0.0002 = 0.108 $$\n保留四位有效数字，点估计值为 $0.1080$。\n\n第 3 部分：$f$ 的 $95\\%$ 置信区间。\n\n首先，我们使用不带连续性校正的威尔逊得分法为比例 $q = k_Y/T$ 构建一个双侧 $95\\%$ 置信区间。试验次数为 $T = N+k_Y = 9000000 + 1800 = 9001800$。“成功”次数为 $k_Y = 1800$。$95\\%$ 置信水平的 z 分数为 $z = z_{0.975} = 1.96$。\n比例 $p$（此处为 $q$）的威尔逊得分区间的端点由下式给出：\n$$ \\frac{q + \\frac{z^2}{2T}}{1 + \\frac{z^2}{T}} \\pm \\frac{z}{1 + \\frac{z^2}{T}} \\sqrt{\\frac{q(1-q)}{T} + \\frac{z^2}{4T^2}} $$\n设此区间的下限和上限分别为 $q_{\\text{low}}$ 和 $q_{\\text{high}}$。\n我们有：\n- $q = \\frac{1800}{9001800} \\approx 0.0001999600$\n- $T = 9001800$\n- $z = 1.96$，所以 $z^2 = 3.8416$\n\n我们计算区间公式的各个组成部分：\n区间的中心是 $\\tilde{q} = \\frac{q + z^2/(2T)}{1 + z^2/T}$。\n$q + \\frac{z^2}{2T} = \\frac{1800}{9001800} + \\frac{3.8416}{2 \\times 9001800} = \\frac{1800 + 1.9208}{9001800} = \\frac{1801.9208}{9001800} \\approx 0.0002001711$\n$1 + \\frac{z^2}{T} = 1 + \\frac{3.8416}{9001800} \\approx 1.0000004268$\n$\\tilde{q} \\approx \\frac{0.0002001711}{1.0000004268} \\approx 0.0002001702$\n\n区间的半宽是 $W = \\frac{z}{1 + z^2/T}\\sqrt{\\frac{q(1-q)}{T} + \\frac{z^2}{4T^2}}$。\n$\\frac{q(1-q)}{T} = \\frac{(\\frac{1800}{9001800})(\\frac{9000000}{9001800})}{9001800} \\approx 2.2213 \\times 10^{-11}$\n$\\frac{z^2}{4T^2} = \\frac{3.8416}{4 \\times (9001800)^2} \\approx 1.1852 \\times 10^{-14}$\n平方根下的项约为 $\\approx 2.2214 \\times 10^{-11}$。其平方根约为 $\\approx 4.7132 \\times 10^{-6}$。\n$W \\approx \\frac{1.96}{1.0000004268} \\times 4.7132 \\times 10^{-6} \\approx 9.2378 \\times 10^{-6}$\n\n$q$ 的置信区间是 $[\\tilde{q} - W, \\tilde{q} + W]$。\n$q_{\\text{low}} = 0.0002001702 - 0.0000092378 = 0.0001909324$\n$q_{\\text{high}} = 0.0002001702 + 0.0000092378 = 0.0002094080$\n\n$f$ 的估计量是 $q$ 的函数：$f(q) = \\frac{2L_A}{L_Y} \\frac{q}{1-q}$。导数 $f'(q) = \\frac{2L_A}{L_Y} \\frac{1}{(1-q)^2}$ 在 $q \\in [0,1)$ 上为正，因此 $f(q)$ 是一个单调递增函数。因此，$f$ 的置信区间可以通过将函数 $f(q)$ 应用于 $q$ 的置信区间的端点来找到。\n\n$f_{\\text{low}} = f(q_{\\text{low}}) = \\frac{2L_A}{L_Y} \\frac{q_{\\text{low}}}{1-q_{\\text{low}}} = 540 \\times \\frac{0.0001909324}{1-0.0001909324} \\approx 540 \\times 0.0001909689 \\approx 0.103123$\n$f_{\\text{high}} = f(q_{\\text{high}}) = \\frac{2L_A}{L_Y} \\frac{q_{\\text{high}}}{1-q_{\\text{high}}} = 540 \\times \\frac{0.0002094080}{1-0.0002094080} \\approx 540 \\times 0.0002094520 \\approx 0.113104$\n\n将所需的三个值四舍五入到四位有效数字：\n- $f$ 的点估计值：$0.1080$\n- $f$ 的 $95\\%$ 置信区间下限：$0.1031$\n- $f$ 的 $95\\%$ 置信区间上限：$0.1131$\n\n最终结果是这三个值的有序三元组。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1080  0.1031  0.1131 \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个“高风险”的 NIPT 结果究竟意味着什么？即使一个测试具有极高的灵敏度和特异性，其阳性预测值（PPV）——即测试阳性时胎儿确实患病的概率——也受到疾病患病率的显著影响。本练习将运用贝叶斯定理来计算唐氏综合征 NIPT 筛查的 PPV，揭示为何 NIPT 是一种强大的筛查工具而非诊断测试，并强调其在患者咨询中的正确解读方式。",
            "id": "4364747",
            "problem": "在一个群体水平的无创产前检测 (NIPT) 项目中，该项目使用游离脱氧核糖核酸 (cfDNA) 来检测 $21$三体综合征，假设对于特定孕周的单胎妊娠，存在以下有经验支持的操作特性和流行病学数据：灵敏度为 $99\\%$，特异性为 $99.9\\%$，并且 $21$三体综合征的患病率（检测前概率）为 $1/700$。仅从灵敏度和特异性的基本定义以及 Bayes 定理出发，推导阳性预测值 (PPV)，即在该人群中 cfDNA NIPT 结果为阳性的后验概率 $P(\\text{Trisomy }21 \\mid \\text{positive test})$。以小数形式提供最终的 PPV，并四舍五入至四位有效数字。简要解释您计算出的 PPV 对于患者咨询和确诊性检测的临床意义，但请确保最终的数值答案按要求独立呈现。",
            "solution": "任务是推导用于 $21$三体综合征的无创产前检测 (NIPT) 的阳性预测值 (PPV)。PPV 是指在检测结果为阳性的条件下，胎儿确实患有该病的后验概率。这将通过使用 Bayes 定理以及所提供的流行病学和检测性能数据来完成。\n\n首先，我们定义相关事件：\n- $D$: 胎儿患有 $21$三体综合征的事件。这对应于疾病存在的情况。\n- $D^c$: 胎儿未患有 $21$三体综合征的事件。\n- $T^+$: NIPT 结果为阳性的事件。\n- $T^-$: NIPT 结果为阴性的事件。\n\n接下来，我们将问题给出的条件形式化为概率：\n1.  $21$三体综合征的患病率给出为 $1/700$。这是该病的先验概率，即 $P(D)$。\n    $$P(D) = \\frac{1}{700}$$\n    由此，未患病的概率为：\n    $$P(D^c) = 1 - P(D) = 1 - \\frac{1}{700} = \\frac{699}{700}$$\n\n2.  检测的灵敏度为 $99\\%$。灵敏度是指在疾病存在的情况下，检测结果为阳性的概率。这是真阳性率，即 $P(T^+ \\mid D)$。\n    $$P(T^+ \\mid D) = 99\\% = 0.99$$\n\n3.  检测的特异性为 $99.9\\%$。特异性是指在疾病不存在的情况下，检测结果为阴性的概率。这是真阴性率，即 $P(T^- \\mid D^c)$。\n    $$P(T^- \\mid D^c) = 99.9\\% = 0.999$$\n\n我们需要计算的量是阳性预测值 (PPV)，定义为 $P(D \\mid T^+)$，即在检测结果为阳性的条件下患病的概率。\n\n我们从 Bayes 定理开始：\n$$P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)}$$\n\n分母 $P(T^+)$ 是获得阳性检测结果的总概率。这可以使用全概率公式计算，即对两种可能的状态（患病或不患病）求和：\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\n使用条件概率的定义 $P(A \\cap B) = P(A \\mid B)P(B)$，我们可以写出：\n$$P(T^+) = P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c)$$\n\n项 $P(T^+ \\mid D^c)$ 是假阳性率。它是在疾病不存在的情况下检测结果为阳性的概率。这可以从特异性推导出来：\n$$P(T^+ \\mid D^c) = 1 - P(T^- \\mid D^c) = 1 - 0.999 = 0.001$$\n\n现在我们将 $P(T^+)$ 的表达式代回 Bayes 定理：\n$$PPV = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c)}$$\n\n我们拥有计算 PPV 所需的所有数值。让我们将它们代入公式：\n- $P(D) = \\frac{1}{700}$\n- $P(D^c) = \\frac{699}{700}$\n- $P(T^+ \\mid D) = 0.99$\n- $P(T^+ \\mid D^c) = 0.001$\n\n$$P(D \\mid T^+) = \\frac{(0.99) \\left(\\frac{1}{700}\\right)}{(0.99) \\left(\\frac{1}{700}\\right) + (0.001) \\left(\\frac{699}{700}\\right)}$$\n\n我们可以将分子和分母同乘以 $700$ 来简化表达式：\n$$P(D \\mid T^+) = \\frac{0.99}{0.99 + (0.001)(699)}$$\n$$P(D \\mid T^+) = \\frac{0.99}{0.99 + 0.699}$$\n$$P(D \\mid T^+) = \\frac{0.99}{1.689}$$\n\n现在，我们进行最后的除法运算：\n$$P(D \\mid T^+) \\approx 0.586145648...$$\n\n问题要求答案四舍五入到四位有效数字。\n$$P(D \\mid T^+) \\approx 0.5861$$\n\n计算出的阳性预测值约为 $0.5861$，即 $58.61\\%$。这个结果具有深远的临床意义。尽管该检测具有非常高的灵敏度 ($99\\%$) 和特异性 ($99.9\\%$)，阳性结果仅表示胎儿实际患有 $21$三体综合征的几率为 $58.61\\%$。剩下的 $41.39\\%$ 的几率代表假阳性。人群中该病相对较低的患病率显著影响了 PPV。这一计算强调了筛查性检测（如 NIPT）和诊断性检测之间的关键区别。对于患者咨询而言，必须解释清楚 NIPT 阳性结果并非最终诊断。它表明风险增加，并需要推荐进行确诊性检测，例如羊膜穿刺术或绒毛膜绒毛取样 (CVS)，这些检测虽然带有小的流产风险，但能提供明确的诊断。这可以防止仅凭筛查结果而产生的过度焦虑和不可逆的决定。",
            "answer": "$$\\boxed{0.5861}$$"
        }
    ]
}