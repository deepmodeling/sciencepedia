{
    "hands_on_practices": [
        {
            "introduction": "本练习聚焦于诊断测试评估的基石：计算阳性预测值（$PPV$）和阴性预测值（$NPV$）。通过从灵敏度、特异度和患病率等基本原理出发，您将学习到测试的性能如何关键地取决于其部署的人群——这是任何实施策略的核心洞见。",
            "id": "4352708",
            "problem": "某区域卫生系统正在实施一种新一代测序 (NGS) 检测方法，用于在高风险临床人群中检测与某种单基因遗传病相关的特定致病性变异。作为循证推广计划的一部分，实施团队试图量化该检测方法在该人群中的临床有效性。假设在目标环境中以下参数是已知且稳定的：检测灵敏度为 $0.98$，检测特异性为 $0.99$，受检人群中该变异的患病率为 $0.02$。请仅使用灵敏度、特异性和患病率的核心定义以及条件概率定律（贝叶斯定理），推导出计算该检测方法在此人群中的阳性预测值 (PPV) 和阴性预测值 (NPV) 所需的表达式。然后对这些表达式进行数值计算。\n\n请以小数形式报告最终的 PPV 和 NPV，并四舍五入至四位有效数字。同时，从临床有效性的角度解释结果，以便为实施决策提供参考（例如，是否应将确认性检测作为常规操作，以及该检测方法是否适用于在这种情况下排除疾病）。在最终的数值中不要使用百分号。",
            "solution": "该问题陈述已经过验证，被认为是合理的。这是一个在生物统计学中提法得当、有科学依据的问题，且解决该问题所需的所有信息均已提供。\n\n让我们为我们的分析定义事件：\n- $D$：某人携带致病性变异的事件。\n- $D^c$：某人不携带致病性变异的事件。\n- $T$：检测结果为阳性的事件。\n- $T^c$：检测结果为阴性的事件。\n\n从问题陈述中，我们可以提取以下概率：\n- 变异的患病率，$P(D) = 0.02$。\n- 检测的灵敏度，即在某人携带变异的情况下，检测结果为阳性的条件概率：$P(T|D) = 0.98$。\n- 检测的特异性，即在某人不携带变异的情况下，检测结果为阴性的条件概率：$P(T^c|D^c) = 0.99$。\n\n根据这些给定值，我们可以推导出其他必要的概率：\n- 不携带变异的概率：$P(D^c) = 1 - P(D) = 1 - 0.02 = 0.98$。\n- 假阳性率，即在某人不携带变异的情况下，检测结果为阳性的条件概率：$P(T|D^c) = 1 - P(T^c|D^c) = 1 - 0.99 = 0.01$。\n- 假阴性率，即在某人携带变异的情况下，检测结果为阴性的条件概率：$P(T^c|D) = 1 - P(T|D) = 1 - 0.98 = 0.02$。\n\n我们的目标是推导并计算阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式。\n\n**1. 阳性预测值 (PPV)**\n\nPPV 是指检测结果为阳性的人确实携带该变异的概率。这对应于条件概率 $P(D|T)$。我们使用贝叶斯定理来求这个值：\n$$P(D|T) = \\frac{P(T|D)P(D)}{P(T)}$$\n分母 $P(T)$ 是检测结果为阳性的总概率。我们可以使用全概率公式，对两种互斥情况（携带变异或不携带变异）求和来得到这个值。\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\n将此代入 PPV 的表达式，我们得到用已知量表示的完整公式：\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T|D)P(D) + P(T|D^c)P(D^c)}$$\n现在，我们可以代入数值：\n$$PPV = \\frac{(0.98)(0.02)}{(0.98)(0.02) + (0.01)(0.98)}$$\n$$PPV = \\frac{0.0196}{0.0196 + 0.0098} = \\frac{0.0196}{0.0294} = \\frac{2}{3}$$\n该数值约为 $0.66666...$。四舍五入到四位有效数字，PPV 为 $0.6667$。\n\n**2. 阴性预测值 (NPV)**\n\nNPV 是指检测结果为阴性的人确实不携带该变异的概率。这对应于条件概率 $P(D^c|T^c)$。同样，我们使用贝叶斯定理：\n$$P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c)}$$\n分母 $P(T^c)$ 是检测结果为阴性的总概率，我们使用全概率公式来求得：\n$$P(T^c) = P(T^c|D)P(D) + P(T^c|D^c)P(D^c)$$\n将此代入 NPV 的表达式，我们得到：\n$$NPV = P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c|D)P(D) + P(T^c|D^c)P(D^c)}$$\n现在，我们可以代入数值：\n$$NPV = \\frac{(0.99)(0.98)}{(0.02)(0.02) + (0.99)(0.98)}$$\n$$NPV = \\frac{0.9702}{0.0004 + 0.9702} = \\frac{0.9702}{0.9706}$$\n该数值约为 $0.999587...$。四舍五入到四位有效数字，NPV 为 $0.9996$。\n\n**临床实施的结果解释**\n\n- **PPV 解释**：PPV 为 $0.6667$ 意味着，对于该高风险人群中检测呈阳性的个体，其确实携带该致病性变异的概率为 $66.67\\%$。反之，这意味着在检测呈阳性的人群中，假阳性概率为 $1 - 0.6667 = 0.3333$，即 $33.33\\%$。尽管该检测将患病概率从 $2\\%$ 的基线患病率显著提高到超过 $66\\%$，但这个 PPV 值仍不足以被视为明确诊断。对于实施决策而言，这一结果强烈表明，在使用更具特异性的方法（例如 Sanger 测序）进行**确认性检测**必须成为处理所有阳性结果的临床常规流程，之后才能做出重大的临床管理决策。\n\n- **NPV 解释**：NPV 为 $0.9996$ 意味着，对于该人群中检测呈阴性的个体，其确实不携带该特定致病性变异的概率为 $99.96\\%$。这是一个非常高的置信水平。对于实施决策而言，这一结果表明该检测是**排除该疾病**的绝佳工具。阴性结果高度可靠，对阴性结果进行常规的确认性检测是不必要的，也不具成本效益。该检测方法适合用作筛查测试，以可靠地识别出那些不需要对该特定变异进行进一步调查的个体。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667  0.9996\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现代基因组风险工具通常提供一个概率，而不仅仅是“是”或“否”的二元结果。本练习介绍了布里尔分数（Brier score），一种评估这些概率性预测准确性的方法。通过为一个小型数据集计算该分数，有助于您建立直觉，理解我们如何衡量一个模型的置信度水平是否经过良好校准且具有临床意义。",
            "id": "4352712",
            "problem": "一个区域性卫生系统正在试点整合一种用于单基因癌症综合征的基因组信息风险分层工具，并辅以多基因风险评分（Polygenic Risk Score, PRS）。该工具以校准概率的形式输出针对二元结果（在确定的监测期内发病）的个性化风险预测，这些预测被输入电子健康记录（Electronic Health Record, EHR）以启动定制化的护理路径。为了评估这些概率性预测是否足够准确，以便为实施决策提供信息，团队决定使用一种正当评分规则，该规则量化了预测风险与二元事件实际结果之间的平均平方偏差。\n\n考虑一个包含四名个体的验证集，其预测风险为 $\\{0.1, 0.6, 0.8, 0.3\\}$，观察结果为 $\\{0, 1, 1, 0\\}$，其中 $0$ 表示未发病，$1$ 表示在监测期内发病。计算准确性得分，该得分定义为每个预测概率与相应二元结果之间平方差的样本均值。然后，在实施准备度的背景下，简要解释该得分的大小，并将其与一种总是预测验证集中经验患病率的朴素方法进行定性对比。\n\n将最终数值答案表示为四位有效数字的小数。无需单位。",
            "solution": "该问题是有效的。它在科学上基于概率性预测验证的原理，特别是使用了布里尔分数（Brier score），这是一种标准的正当评分规则。实施科学和基因组风险预测的背景是一个公认且活跃的研究领域。该问题提法明确，提供了计算唯一、有意义答案所需的所有数据和定义。\n\n问题要求计算一组概率性预测的“准确性得分”。\n该得分定义为每个预测概率与相应二元结果之间平方差的样本均值。这在形式上被称为布里尔分数（Brier score, $BS$）。\n\n设 $N$ 为验证集中的个体数量。\n设 $p_i$ 为个体 $i$ 的事件预测概率，其中 $i=1, \\dots, N$。\n设 $o_i$ 为个体 $i$ 的观察结果，其中如果事件发生则 $o_i=1$，如果未发生则 $o_i=0$。\n\n布里尔分数的计算公式为：\n$$\nBS = \\frac{1}{N} \\sum_{i=1}^{N} (p_i - o_i)^2\n$$\n\n根据问题陈述，我们已知：\n- 个体数量 $N=4$。\n- 预测风险（概率）集合 $P = \\{0.1, 0.6, 0.8, 0.3\\}$。\n- 观察结果集合 $O = \\{0, 1, 1, 0\\}$。\n\n我们可以将预测和结果分配给每个个体如下：\n- 个体 $1$：$p_1 = 0.1$, $o_1 = 0$\n- 个体 $2$：$p_2 = 0.6$, $o_2 = 1$\n- 个体 $3$：$p_3 = 0.8$, $o_3 = 1$\n- 个体 $4$：$p_4 = 0.3$, $o_4 = 0$\n\n现在，我们计算每个个体的平方差：\n- 对于个体 $1$：$(p_1 - o_1)^2 = (0.1 - 0)^2 = 0.1^2 = 0.01$\n- 对于个体 $2$：$(p_2 - o_2)^2 = (0.6 - 1)^2 = (-0.4)^2 = 0.16$\n- 对于个体 $3$：$(p_3 - o_3)^2 = (0.8 - 1)^2 = (-0.2)^2 = 0.04$\n- 对于个体 $4$：$(p_4 - o_4)^2 = (0.3 - 0)^2 = 0.3^2 = 0.09$\n\n接下来，我们将这些平方差相加：\n$$\n\\sum_{i=1}^{4} (p_i - o_i)^2 = 0.01 + 0.16 + 0.04 + 0.09 = 0.30\n$$\n\n最后，我们通过除以 $N=4$ 来计算均值：\n$$\nBS_{\\text{tool}} = \\frac{0.30}{4} = 0.075\n$$\n\n问题要求进行简要解释，并与一种朴素方法进行定性对比。朴素方法是总是预测经验患病率（结果的样本均值）。\n\n首先，我们计算经验患病率，记为 $\\bar{o}$：\n$$\n\\bar{o} = \\frac{1}{N} \\sum_{i=1}^{N} o_i = \\frac{0 + 1 + 1 + 0}{4} = \\frac{2}{4} = 0.5\n$$\n朴素模型会对所有四个个体预测 $p_i = 0.5$。我们可以计算这个朴素模型的布里尔分数 $BS_{\\text{naïve}}$：\n$$\nBS_{\\text{naïve}} = \\frac{1}{4} \\sum_{i=1}^{4} (0.5 - o_i)^2\n$$\n平方差为：\n- 对于 $o_1=0$：$(0.5 - 0)^2 = 0.25$\n- 对于 $o_2=1$：$(0.5 - 1)^2 = 0.25$\n- 对于 $o_3=1$：$(0.5 - 1)^2 = 0.25$\n- 对于 $o_4=0$：$(0.5 - 0)^2 = 0.25$\n\n这些平方差的总和是 $0.25 + 0.25 + 0.25 + 0.25 = 1.0$。\n朴素模型的布里尔分数为：\n$$\nBS_{\\text{naïve}} = \\frac{1.0}{4} = 0.25\n$$\n\n解释与对比：\n完美预测的布里尔分数为 $0$。该分数的范围是 $0$ 到 $1$，分数越低表示准确性越高。基因组风险工具的布里尔分数为 $BS_{\\text{tool}} = 0.075$。这是一个相对较低的值，表明模型的概率性预测接近观察到的二元结果。\n\n相比之下，朴素模型忽略了所有个体信息，仅为每个人预测总体事件率，其布里尔分数为 $BS_{\\text{naïve}} = 0.25$。由于 $0.075 \\ll 0.25$，基因组工具比这个简单的基线模型要准确得多。\n\n在实施准备度的背景下，这个结果是很有希望的。基因组工具提供了个性化的风险评估，这些评估能够区分高风险和低风险的个体，并且这种区分能力被证明远优于基于平均患病率的“一刀切”方法。更高的准确性（更低的布里尔分数）表明，该工具可以提供有意义的、针对特定患者的信息来指导临床决策，例如确定患者是否有资格接受定制化的监测或预防策略。一个表现出比朴素参考模型显著更优技能的模型是临床实施的有力候选者。\n\n最终数值答案必须表示为四位有效数字的小数。计算出的分数为 $0.075$。要用四位有效数字表示，我们写作 $0.07500$。",
            "answer": "$$\n\\boxed{0.07500}\n$$"
        },
        {
            "introduction": "随着算法工具被整合到医疗保健中，确保它们在不同患者群体中公平地执行是一项关键的实施挑战。本练习介绍了“均等机会”公平性标准，并要求您使用真实阳性率（$TPR$）来量化两个群体之间的差异。此实践提供了一种具体的方法来检测和衡量可能导致健康不平等的算法偏见。",
            "id": "4352805",
            "problem": "一家大型学术医疗中心正在将一个二元预测模型整合到其肿瘤学工作流程中，以优先安排遗传咨询转诊，旨在识别符合国家综合癌症网络（NCCN）遗传性癌症检测标准的个体。为了评估群体层面的公平性，实施团队比较了该模型在临床登记中观察到的两个患者亚群（表示为组 $1$ 和组 $2$）中的表现。设二元结果为患者是否真正符合NCCN遗传性癌症标准，模型的阳性预测表示转诊优先。\n\n使用以下基本定义：\n- 在根据真实标签评估的二元分类中，真阳性率（TPR），也称为灵敏度，定义为 $TPR = \\frac{TP}{TP + FN}$，其中 $TP$ 是真阳性的数量，$FN$ 是假阴性的数量。\n- 机会均等公平性要求指出，在那些真正应该被优先处理的个体（即具有阳性真实标签的个体）中，被预测为阳性的概率在不同群体间应相等。换句话说，模型应在各群体中实现相同的 $TPR$。\n\n从这些定义出发，推导一个有符号标量，用于量化组 $1$ 和组 $2$ 之间偏离机会均等的程度和方向。然后，根据为组 $1$ 经验估计的真阳性率 $TPR_{1} = 0.85$ 和为组 $2$ 经验估计的真阳性率 $TPR_{2} = 0.70$ 来计算该标量的值。将最终标量表示为十进制数。无需四舍五入。在您的推导和论证中，解释计算出的值对于基因组诊断中实施决策的公平性影响。最终答案必须是一个不带单位的实数。",
            "solution": "问题陈述经评估有效。它在科学上基于二元分类模型评估和算法公平性的原则，这些是统计学和机器学习中的既定概念。该问题定义明确，提供了所有必要的定义和数据（$TPR_{1} = 0.85$，$TPR_{2} = 0.70$），以推导和计算一个唯一的标量。它是客观的，并使用了精确、标准的术语。没有矛盾、信息缺失或违反科学原则的情况。因此，我们可以继续进行解答。\n\n目标是推导一个有符号标量，用于量化偏离机会均等公平性准则的程度，然后计算其值。机会均等准则要求真阳性率（$TPR$）在不同的受保护群体之间保持一致。$TPR$ 是指一个真正属于阳性类别（在本例中为符合NCCN标准）的个体被模型正确预测为阳性的概率。\n\n设 $A$ 为代表群体成员身份的随机变量，其中 $A=1$ 代表组 $1$，$A=2$ 代表组 $2$。设 $Y$ 为二元真实标签结果，其中 $Y=1$ 表示患者符合NCCN标准。设 $\\hat{Y}$ 为模型的二元预测，其中 $\\hat{Y}=1$ 表示阳性预测（优先转诊）。\n\n特定群体 $g$ 的真阳性率定义为条件概率：\n$$TPR_{g} = P(\\hat{Y}=1 | Y=1, A=g)$$\n这与所提供的定义 $TPR = \\frac{TP}{TP + FN}$ 一致，其中 $TP$（真阳性）是 $Y=1$ 且 $\\hat{Y}=1$ 的个体数量，$FN$（假阴性）是 $Y=1$ 且 $\\hat{Y}=0$ 的个体数量。分母 $TP+FN$ 代表具有阳性真实标签结果（$Y=1$）的个体总数。\n\n机会均等公平性准则要求模型对于所有群体中应获得阳性结果的个体表现同样出色。在数学上，这可以表示为：\n$$TPR_{1} = TPR_{2}$$\n或者，更一般地，$P(\\hat{Y}=1 | Y=1, A=1) = P(\\hat{Y}=1 | Y=1, A=2)$。\n\n根据此准则，当特定群体的 $TPR$ 之间的差异为零时，就达到了完全公平的状态。为了量化与这种理想状态的偏差，我们可以定义一个有符号标量，我们将其表示为 $\\Delta_{EO}$，代表机会均等差异。该标量最直接和标准的公式是两个比率之间的简单差值：\n$$\\Delta_{EO} = TPR_{1} - TPR_{2}$$\n该标量有效地捕捉了差异的大小和方向：\n- 如果 $\\Delta_{EO} = 0$，则满足机会均等准则。\n- 如果 $\\Delta_{EO} > 0$，则模型为组 $1$ 提供的真阳性率高于组 $2$，表明存在偏向组 $1$ 的偏见。\n- 如果 $\\Delta_{EO}  0$，则模型为组 $2$ 提供的真阳性率高于组 $1$，表明存在偏向组 $2$ 的偏见。\n其绝对值 $|\\Delta_{EO}|$ 表示公平性差距的大小。\n\n现在，我们使用问题陈述中提供的经验估计值来计算该标量：\n- $TPR_{1} = 0.85$\n- $TPR_{2} = 0.70$\n\n将这些值代入我们推导的公式中：\n$$\\Delta_{EO} = 0.85 - 0.70 = 0.15$$\n\n计算出的标量值为 $0.15$。\n\n**对基因组诊断中实施的解读：**\n\n$\\Delta_{EO} = 0.15$ 的值表明模型在两个患者亚群之间的表现存在显著差异。正号表示这种差异有利于组 $1$。具体来说，在真正符合NCCN遗传性癌症检测标准的患者中，来自组 $1$ 的患者有 $85\\%$ 的机会被模型正确地优先安排转诊，而来自组 $2$ 的患者只有 $70\\%$ 的机会。\n\n这 $15$ 个百分点的差异严重违反了机会均等公平性原则。这意味着该模型在识别组 $2$ 的高风险个体方面的失败率系统性地高于组 $1$。在基因组诊断的背景下，这具有关键的临床和伦理影响。对组 $2$ 中合格患者的识别不足可能导致错失遗传咨询、检测以及后续的预防性护理或早期癌症发现的机会。这可能直接导致或加剧健康差异，即一个群体由于临床决策支持工具中嵌入的系统性偏见而经历更差的健康结果。\n\n从实施科学的角度来看，在当前状态下部署此模型是不负责任的。实施团队必须在将模型整合到肿瘤学工作流程之前解决这种偏见。潜在的缓解策略包括：\n1.  **数据增强或重加权：** 增加组 $2$ 在训练数据中的代表性，或对在组 $2$ 个体上犯的分类错误分配更高的权重。\n2.  **算法修改：** 使用公平性感知机器学习算法，在训练过程中明确惩罚像 $TPR$ 这样的性能指标的差异。\n3.  **后处理：** 对每个组应用不同的分类阈值以使其 $TPR$ 相等。例如，可以降低组 $2$ 的阈值以将更多个体分类为阳性，从而提高其 $TPR$，但可能代价是该组的假阳性率会更高。\n\n这一差异的发现要求暂停实施，以调查其根本原因并修复模型，以确保为所有患者群体提供公平的护理。",
            "answer": "$$\n\\boxed{0.15}\n$$"
        }
    ]
}