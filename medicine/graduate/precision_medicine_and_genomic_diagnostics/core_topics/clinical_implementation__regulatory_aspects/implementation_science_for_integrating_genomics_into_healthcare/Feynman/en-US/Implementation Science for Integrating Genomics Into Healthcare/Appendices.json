{
    "hands_on_practices": [
        {
            "introduction": "Before a new genomic test can be integrated into clinical practice, its real-world performance must be rigorously evaluated. While test characteristics like sensitivity and specificity are intrinsic properties, their clinical meaning depends heavily on the prevalence of the condition in the target population. This foundational exercise  guides you through the calculation of Positive and Negative Predictive Values (PPV and NPV), demonstrating how the probability of a true result changes with disease prevalence. Mastering this concept is crucial for making informed decisions about a test's clinical utility and the need for confirmatory procedures.",
            "id": "4352708",
            "problem": "A regional health system is implementing a next-generation sequencing (NGS) assay to detect a specific pathogenic variant associated with a monogenic disorder in an at-risk clinical population. The implementation team seeks to quantify the clinical validity of the assay in this population as part of an evidence-based rollout plan. Assume the following are known and stable in the target setting: test sensitivity is $0.98$, test specificity is $0.99$, and the variant prevalence in the tested population is $0.02$. Using only core definitions of sensitivity, specificity, and prevalence and the law of conditional probability (Bayes' theorem), derive the expressions needed to compute the positive predictive value (PPV) and negative predictive value (NPV) for this assay in this population. Then evaluate these expressions numerically.\n\nReport your final PPV and NPV as decimals, rounded to four significant figures, and interpret the results in terms of clinical validity for implementation decisions (for example, whether confirmatory testing should be routine and whether the assay is suitable for ruling out disease in this setting). Do not use a percent sign in your final numeric values.",
            "solution": "The problem statement has been validated and is deemed sound. It is a well-posed, scientifically grounded problem in biostatistics, and all necessary information is provided for its solution.\n\nLet us define the events for our analysis:\n- $D$: The event that a person has the pathogenic variant.\n- $D^c$: The event that a person does not have the pathogenic variant.\n- $T$: The event that the assay returns a positive result.\n- $T^c$: The event that the assay returns a negative result.\n\nFrom the problem statement, we can extract the following probabilities:\n- The prevalence of the variant, $P(D) = 0.02$.\n- The sensitivity of the test, which is the conditional probability of a positive test result given that the person has the variant: $P(T|D) = 0.98$.\n- The specificity of the test, which is the conditional probability of a negative test result given that the person does not have the variant: $P(T^c|D^c) = 0.99$.\n\nFrom these given values, we can derive other necessary probabilities:\n- The probability of not having the variant: $P(D^c) = 1 - P(D) = 1 - 0.02 = 0.98$.\n- The false positive rate, which is the conditional probability of a positive test given the person does not have the variant: $P(T|D^c) = 1 - P(T^c|D^c) = 1 - 0.99 = 0.01$.\n- The false negative rate, which is the conditional probability of a negative test given the person has the variant: $P(T^c|D) = 1 - P(T|D) = 1 - 0.98 = 0.02$.\n\nOur goal is to derive the expressions for and calculate the Positive Predictive Value (PPV) and the Negative Predictive Value (NPV).\n\n**1. Positive Predictive Value (PPV)**\n\nThe PPV is the probability that a person with a positive test result truly has the variant. This corresponds to the conditional probability $P(D|T)$. We use Bayes' theorem to find this value:\n$$P(D|T) = \\frac{P(T|D)P(D)}{P(T)}$$\nThe denominator, $P(T)$, is the total probability of a positive test result. We can find this using the law of total probability, summing over the two mutually exclusive scenarios: having the variant or not having the variant.\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\nSubstituting this into the expression for PPV, we get the full formula in terms of our known quantities:\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T|D)P(D) + P(T|D^c)P(D^c)}$$\nNow, we can substitute the numerical values:\n$$PPV = \\frac{(0.98)(0.02)}{(0.98)(0.02) + (0.01)(0.98)}$$\n$$PPV = \\frac{0.0196}{0.0196 + 0.0098} = \\frac{0.0196}{0.0294} = \\frac{2}{3}$$\nNumerically, this value is approximately $0.66666...$. Rounded to four significant figures, the PPV is $0.6667$.\n\n**2. Negative Predictive Value (NPV)**\n\nThe NPV is the probability that a person with a negative test result truly does not have the variant. This corresponds to the conditional probability $P(D^c|T^c)$. Again, we use Bayes' theorem:\n$$P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c)}$$\nThe denominator, $P(T^c)$, is the total probability of a negative test result, which we find using the law of total probability:\n$$P(T^c) = P(T^c|D)P(D) + P(T^c|D^c)P(D^c)$$\nSubstituting this into the expression for NPV, we get:\n$$NPV = P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c|D)P(D) + P(T^c|D^c)P(D^c)}$$\nNow, we can substitute the numerical values:\n$$NPV = \\frac{(0.99)(0.98)}{(0.02)(0.02) + (0.99)(0.98)}$$\n$$NPV = \\frac{0.9702}{0.0004 + 0.9702} = \\frac{0.9702}{0.9706}$$\nNumerically, this value is approximately $0.999587...$. Rounded to four significant figures, the NPV is $0.9996$.\n\n**Interpretation of Results for Clinical Implementation**\n\n- **PPV Interpretation**: A PPV of $0.6667$ means that for an individual in this at-risk population who tests positive, there is a $66.67\\%$ probability that they actually have the pathogenic variant. Conversely, this implies a false positive probability of $1 - 0.6667 = 0.3333$, or $33.33\\%$, among those who test positive. While the test significantly increases the probability of disease from the baseline prevalence of $2\\%$ to over $66\\%$, this PPV is not high enough to be considered a definitive diagnosis. For implementation decisions, this result strongly indicates that **confirmatory testing** with a more specific method (e.g., Sanger sequencing) must be a routine part of the clinical workflow for all positive results before making significant clinical management decisions.\n\n- **NPV Interpretation**: An NPV of $0.9996$ means that for an individual in this population who tests negative, there is a $99.96\\%$ probability that they are truly free of the specific pathogenic variant. This is a very high level of confidence. For implementation decisions, this result demonstrates that the assay is an excellent tool for **ruling out the disorder**. A negative result is highly reliable, and routine confirmatory testing on negative results would be unnecessary and not cost-effective. The assay is suitable for use as a screening test to confidently identify individuals who do not require further investigation for this specific variant.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667 & 0.9996\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Successful implementation science extends beyond statistical evaluation to encompass practical operational planning. The performance metrics of a diagnostic test directly influence the demand for downstream resources, such as specialized genetic counseling. This practice  builds upon the principles of predictive values to model a tangible implementation outcome: resource allocation. By calculating the expected number of counseling sessions based on test performance and a defined triage policy, you will learn to translate statistical data into actionable plans for healthcare system readiness.",
            "id": "4352774",
            "problem": "A regional health system is implementing a next-generation sequencing diagnostic for a monogenic condition in a referred population where the pre-test probability of true disease is $0.30$. Validation studies in a population with similar spectrum of disease show analytic performance with clinical operating characteristics: sensitivity $0.95$ and specificity $0.98$. The program must plan genetic counseling capacity. As an implementation policy, all individuals with a positive test will be scheduled for counseling, and additionally $0.10$ of all individuals with a negative test will be scheduled for counseling based on a concurrent family-history triage protocol.\n\nStarting only from the definitions of sensitivity, specificity, the law of total probability, and Bayes’ theorem, and without assuming any closed-form predictive value formulas, do the following:\n\n1. Derive the post-test probability of true disease given a positive test (the positive predictive value, PPV) and the post-test probability of no disease given a negative test (the negative predictive value, NPV) for this referred population.\n2. Interpret these post-test probabilities in terms of patient-facing genetic counseling needs within an implementation science framework, including residual risk communication after negative results and confirmatory strategies after positive results.\n3. Compute the expected number of counseling sessions required per $1000$ tested under the stated policy.\n\nRound your final expected counseling load to three significant figures, and express the final answer in persons per $1000$ tested. Provide only the final expected counseling load as your final answer.",
            "solution": "The problem will first be validated for scientific soundness, self-consistency, and clarity. Following validation, a step-by-step solution will be derived from fundamental principles as stipulated.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Pre-test probability of true disease: $P(\\text{disease}) = 0.30$\n- Sensitivity of the test: $0.95$\n- Specificity of the test: $0.98$\n- Counseling policy: All individuals with a positive test are scheduled for counseling.\n- Counseling policy: $10\\%$ ($0.10$) of all individuals with a negative test are scheduled for counseling.\n- Population size for calculation: $1000$ tested individuals.\n- Constraints: The derivation must start from the definitions of sensitivity, specificity, the law of total probability, and Bayes’ theorem, without using pre-derived formulas for predictive values.\n- Required outputs:\n  1. Derivation of the positive predictive value (PPV) and negative predictive value (NPV).\n  2. Interpretation of these values for genetic counseling.\n  3. The expected number of counseling sessions per $1000$ individuals, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in standard biostatistics and epidemiology. The concepts of sensitivity, specificity, pre-test probability (prevalence), and predictive values are fundamental to the evaluation of diagnostic tests. The values provided ($0.95$ sensitivity, $0.98$ specificity, $0.30$ pre-test probability) are realistic for a targeted genetic test in a referred population. The scenario described is a common and critical challenge in the field of implementation science for medical genomics. The problem is scientifically sound.\n- **Well-Posed:** All necessary data to compute the requested quantities are provided. The instructions are clear, and the problem leads to a unique, stable, and meaningful solution.\n- **Objective:** The problem is phrased using precise, quantitative, and unbiased language. Part 2 asks for an \"interpretation,\" but it is constrained to a specific, objective \"implementation science framework,\" which concerns the practical application and impact of such statistical results, not subjective opinion.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, objective, and contains no internal contradictions or ambiguities. The solution process will now proceed.\n\n### Solution Derivation\n\nLet $D$ be the event that an individual has the true disease, and let $D^c$ be the event that the individual does not have the disease. Let $T^+$ be the event of a positive test result, and $T^-$ be the event of a negative test result.\n\nFrom the problem statement, we can define the following probabilities:\n- The pre-test probability of disease, or prevalence in this population, is $P(D) = 0.30$.\n- Consequently, the pre-test probability of not having the disease is $P(D^c) = 1 - P(D) = 1 - 0.30 = 0.70$.\n- Sensitivity is the probability of a positive test given disease: $P(T^+|D) = 0.95$.\n- Specificity is the probability of a negative test given no disease: $P(T^-|D^c) = 0.98$.\n\nFrom these definitions, we can also derive the probabilities of the complementary events:\n- The probability of a false negative (a negative test given disease) is $P(T^-|D) = 1 - P(T^+|D) = 1 - 0.95 = 0.05$.\n- The probability of a false positive (a positive test given no disease) is $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - 0.98 = 0.02$.\n\n**Part 1: Derivation of PPV and NPV**\n\nTo find the post-test probabilities, we first need the overall probabilities of obtaining positive and negative test results, $P(T^+)$ and $P(T^-)$. We use the law of total probability.\n\nThe probability of a positive test, $P(T^+)$, is the sum of the probabilities of a true positive and a false positive:\n$$P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c)$$\nSubstituting the given values:\n$$P(T^+) = (0.95)(0.30) + (0.02)(0.70) = 0.285 + 0.014 = 0.299$$\n\nThe probability of a negative test, $P(T^-)$, is the sum of the probabilities of a true negative and a false negative:\n$$P(T^-) = P(T^-|D^c)P(D^c) + P(T^-|D)P(D)$$\nSubstituting the given values:\n$$P(T^-) = (0.98)(0.70) + (0.05)(0.30) = 0.686 + 0.015 = 0.701$$\nAs a check, $P(T^+) + P(T^-) = 0.299 + 0.701 = 1.000$, as required.\n\nNow we can apply Bayes' theorem as requested to find the post-test probabilities.\n\nThe Positive Predictive Value (PPV) is the probability of disease given a positive test, $P(D|T^+)$.\n$$P(D|T^+) = \\frac{P(T^+|D)P(D)}{P(T^+)}$$\n$$P(D|T^+) = \\frac{0.95 \\times 0.30}{0.299} = \\frac{0.285}{0.299} \\approx 0.953177$$\n\nThe Negative Predictive Value (NPV) is the probability of no disease given a negative test, $P(D^c|T^-)$.\n$$P(D^c|T^-) = \\frac{P(T^-|D^c)P(D^c)}{P(T^-)}$$\n$$P(D^c|T^-) = \\frac{0.98 \\times 0.70}{0.701} = \\frac{0.686}{0.701} \\approx 0.978602$$\n\n**Part 2: Interpretation for Genetic Counseling**\n\nThe calculated post-test probabilities are central to patient-facing communication and clinical management within an implementation science framework.\n\n- **Positive Result Counseling:** The PPV is approximately $95.3\\%$. This means that for a patient with a positive test, there is a $95.3\\%$ chance they truly have the disease. However, it also means there is a $100\\% - 95.3\\% = 4.7\\%$ chance that the result is a false positive. Counseling for a positive result must therefore focus on communicating this high probability of disease while also transparently explaining the residual uncertainty. This necessitates a discussion about confirmatory strategies, such as orthogonal testing methods (e.g., Sanger sequencing to confirm an NGS variant), or testing other affected/unaffected family members to establish segregation of the variant with the disease. Managing patient anxiety and ensuring a clear understanding of the next steps are paramount.\n\n- **Negative Result Counseling:** The NPV is approximately $97.9\\%$. This is the probability that a person with a negative test is truly disease-free. The complement, $P(D|T^-) = 1 - P(D^c|T^-) \\approx 1 - 0.979 = 0.021$ or $2.1\\%$, represents the residual risk of having the disease despite a negative test. Counseling for a negative result, especially for the $10\\%$ triaged based on family history, must carefully address this residual risk. The discussion should cover the test's limitations (e.g., it may not detect all mutation types, such as large deletions or complex rearrangements) and explain that a negative result reduces the likelihood of disease but does not eliminate it entirely, particularly when strong clinical or family history indicators are present. Counseling helps the patient integrate the test result with their pre-existing risk profile.\n\n**Part 3: Compute Expected Counseling Sessions**\n\nThe policy requires counseling for all individuals with a positive test and for $10\\%$ of individuals with a negative test. We need to find the expected number of sessions for a cohort of $N = 1000$ individuals.\n\nThe expected number of individuals with a positive test is $N \\times P(T^+)$.\n$$E[\\text{Positive Tests}] = 1000 \\times 0.299 = 299$$\n\nThe expected number of individuals with a negative test is $N \\times P(T^-)$.\n$$E[\\text{Negative Tests}] = 1000 \\times 0.701 = 701$$\n\nThe number of counseling sessions for the positive-testing group is equal to the number of positive tests, which is $299$.\nThe number of counseling sessions for the negative-testing group is $10\\%$ of the number of negative tests.\n$$E[\\text{Counseling for Negatives}] = 0.10 \\times E[\\text{Negative Tests}] = 0.10 \\times 701 = 70.1$$\n\nThe total expected number of counseling sessions is the sum of these two groups.\n$$E[\\text{Total Counseling Sessions}] = E[\\text{Counseling for Positives}] + E[\\text{Counseling for Negatives}]$$\n$$E[\\text{Total Counseling Sessions}] = 299 + 70.1 = 369.1$$\n\nThe problem requires rounding the final answer to three significant figures. The number $369.1$ rounded to three significant figures is $369$.\n\nThe expected number of counseling sessions required per $1000$ tested individuals is $369$.",
            "answer": "$$\\boxed{369}$$"
        },
        {
            "introduction": "The integration of predictive algorithms into healthcare promises to personalize medicine, but it also carries the risk of perpetuating or even amplifying existing health disparities. A critical task in implementation science is to vet these tools for fairness, ensuring they work equitably across diverse patient populations. This exercise  introduces the concept of \"equal opportunity,\" a key fairness metric that evaluates whether a model correctly identifies at-risk individuals at the same rate across different groups. By quantifying the disparity in a model's True Positive Rate, you will gain a practical understanding of how to audit algorithms for bias, a crucial step in the ethical implementation of genomic technologies.",
            "id": "4352805",
            "problem": "A large academic medical center is integrating a binary predictive model into its oncology workflow to prioritize referrals for genetic counseling, aiming to detect individuals who meet National Comprehensive Cancer Network (NCCN) criteria for hereditary cancer testing. To evaluate group-level fairness, the implementation team compares the model’s performance across two patient subpopulations observed in the clinical registry, denoted Group $1$ and Group $2$. Let the binary outcome be whether a patient truly meets NCCN hereditary cancer criteria, and let the model’s positive prediction indicate referral prioritization.\n\nUse the following fundamental base:\n- In binary classification evaluated against ground truth, the True Positive Rate (TPR), also known as sensitivity, is defined as $TPR = \\frac{TP}{TP + FN}$, where $TP$ is the count of true positives and $FN$ is the count of false negatives.\n- The equal opportunity fairness requirement states that, among those who truly should be prioritized (i.e., those with the positive ground truth), the probability of being predicted positive should be equal across groups. In other words, the model should achieve the same $TPR$ across groups.\n\nStarting from these definitions, derive a signed scalar that quantifies the magnitude and direction of deviation from equal opportunity between Group $1$ and Group $2$. Then, evaluate this scalar given empirically estimated True Positive Rates $TPR_{1} = 0.85$ for Group $1$ and $TPR_{2} = 0.70$ for Group $2$. Express the final scalar as a decimal number. No rounding is required. In your derivation and reasoning, interpret the fairness implications of the computed value for implementation decisions in genomic diagnostics. The final answer must be a single real number without units.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of binary classification model evaluation and algorithmic fairness, which are established concepts in statistics and machine learning. The problem is well-posed, providing all necessary definitions and data ($TPR_{1} = 0.85$, $TPR_{2} = 0.70$) to derive and compute a unique scalar quantity. It is objective and uses precise, standard terminology. There are no contradictions, missing information, or violations of scientific principles. We may therefore proceed with the solution.\n\nThe goal is to derive a signed scalar that quantifies the deviation from the equal opportunity fairness criterion and then compute its value. The equal opportunity criterion requires that the True Positive Rate ($TPR$) be consistent across different protected groups. The $TPR$ is the probability that an individual who truly belongs to the positive class (in this case, meeting NCCN criteria) is correctly predicted as positive by the model.\n\nLet $A$ be the random variable representing group membership, where $A=1$ for Group $1$ and $A=2$ for Group $2$. Let $Y$ be the binary ground truth outcome, where $Y=1$ signifies that a patient meets the NCCN criteria. Let $\\hat{Y}$ be the model's binary prediction, where $\\hat{Y}=1$ indicates a positive prediction (prioritization for referral).\n\nThe True Positive Rate for a specific group $g$ is defined as the conditional probability:\n$$TPR_{g} = P(\\hat{Y}=1 | Y=1, A=g)$$\nThis is consistent with the definition provided, $TPR = \\frac{TP}{TP + FN}$, where $TP$ (True Positives) is the count of individuals with $Y=1$ and $\\hat{Y}=1$, and $FN$ (False Negatives) is the count of individuals with $Y=1$ and $\\hat{Y}=0$. The denominator $TP+FN$ represents the total number of individuals with the positive ground truth outcome ($Y=1$).\n\nThe equal opportunity fairness criterion requires that the model performs equally well for all groups among individuals who should receive the positive outcome. Mathematically, this translates to:\n$$TPR_{1} = TPR_{2}$$\nOr, more generally, $P(\\hat{Y}=1 | Y=1, A=1) = P(\\hat{Y}=1 | Y=1, A=2)$.\n\nA state of perfect fairness, according to this criterion, is achieved when the difference between the group-specific $TPR$s is zero. To quantify the deviation from this ideal state, we can define a signed scalar, which we will denote as $\\Delta_{EO}$, representing the Equal Opportunity Difference. The most direct and standard formulation for this scalar is the simple difference between the two rates:\n$$\\Delta_{EO} = TPR_{1} - TPR_{2}$$\nThis scalar effectively captures both the magnitude and direction of the disparity:\n- If $\\Delta_{EO} = 0$, the equal opportunity criterion is satisfied.\n- If $\\Delta_{EO} > 0$, the model provides a higher True Positive Rate for Group $1$ than for Group $2$, indicating a bias favoring Group $1$.\n- If $\\Delta_{EO} < 0$, the model provides a higher True Positive Rate for Group $2$ than for Group $1$, indicating a bias favoring Group $2$.\nThe magnitude, $|\\Delta_{EO}|$, indicates the size of the fairness gap.\n\nNow, we evaluate this scalar using the empirically estimated values provided in the problem statement:\n- $TPR_{1} = 0.85$\n- $TPR_{2} = 0.70$\n\nSubstituting these values into our derived formula:\n$$\\Delta_{EO} = 0.85 - 0.70 = 0.15$$\n\nThe computed value of the scalar is $0.15$.\n\n**Interpretation for Implementation in Genomic Diagnostics:**\n\nA value of $\\Delta_{EO} = 0.15$ indicates a significant disparity in the model's performance between the two patient subpopulations. The positive sign signifies that the disparity is in favor of Group $1$. Specifically, among patients who genuinely meet the NCCN criteria for hereditary cancer testing, a patient from Group $1$ has an $85\\%$ chance of being correctly prioritized for referral by the model, whereas a patient from Group $2$ has only a $70\\%$ chance.\n\nThis $15$ percentage point difference is a substantial violation of the equal opportunity fairness principle. It means that the model systematically fails to identify at-risk individuals in Group $2$ at a higher rate than it does for at-risk individuals in Group $1$. In the context of genomic diagnostics, this has critical clinical and ethical implications. The under-identification of qualified patients in Group $2$ can lead to missed opportunities for genetic counseling, testing, and subsequent preventative care or early cancer detection. This could directly contribute to, or exacerbate, health disparities, where one group experiences worse health outcomes due to systemic biases embedded in clinical decision-support tools.\n\nFrom an implementation science perspective, deploying this model in its current state would be irresponsible. The implementation team must address this bias before integration into the oncology workflow. Potential mitigation strategies include:\n1.  **Data Augmentation or Re-weighting:** Increasing the representation of Group $2$ in the training data or assigning higher weights to classification errors made on individuals from Group $2$.\n2.  **Algorithmic Modification:** Using fairness-aware machine learning algorithms that explicitly penalize disparities in performance metrics like $TPR$ during the training process.\n3.  **Post-processing:** Applying different classification thresholds for each group to equalize their $TPR$s. For example, the threshold for Group $2$ might be lowered to classify more individuals as positive, thereby increasing its $TPR$ at the potential cost of a higher False Positive Rate for that group.\n\nThe finding of this disparity mandates a pause in implementation to investigate its root cause and remediate the model to ensure equitable care for all patient populations.",
            "answer": "$$\n\\boxed{0.15}\n$$"
        }
    ]
}