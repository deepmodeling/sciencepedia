{
    "hands_on_practices": [
        {
            "introduction": "The clinical utility of pharmacogenomics hinges on translating a patient's genotype into a clear, actionable phenotype. This exercise introduces the foundational skill of calculating an enzyme's activity score, a standardized method that sums the functional contributions of each allele to predict metabolic capacity. Mastering this calculation is the first step toward personalized drug dosing recommendations. ",
            "id": "4386246",
            "problem": "In pharmacogenomics, star allele nomenclature encodes haplotype-defined function states for drug-metabolizing enzymes, such as Cytochrome P450 Family 2 Subfamily D Member 6 (CYP2D6). Assume the following foundational bases grounded in molecular biology and pharmacogenetics: the Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein) establishes that allelic variation in a gene can alter protein abundance or catalytic efficiency; for a diploid locus with independent transcription of each allele and absence of dominance or epistasis, the net enzymatic activity contributed by a diplotype can be modeled as the linear sum of the functional contributions of each allele; and Clinical Pharmacogenetics Implementation Consortium (CPIC) standardization assigns allele function values that are empirically derived from clinical pharmacokinetic and pharmacodynamic data.\n\nConsider a diplotype reported by a Clinical Laboratory Improvement Amendments (CLIA)–certified laboratory as \"CYP2D6*1/*4\", with copy number equal to $2$ (no duplication or deletion), and no hybrid structural variants. Use the following widely accepted allele function assignments: alleles designated \"normal function\" contribute an activity value of $1$, alleles designated \"decreased function\" contribute $0.5$, and alleles designated \"no function\" contribute $0$. The star allele CYP2D6*$1$ is classified as a normal function allele, and CYP2D6*$4$ is classified as a no function allele. The total activity score is defined as the sum of the allele activity values contributed by each chromosome, under the additive assumption stated above.\n\nAfter deriving the total activity score from first principles and the stated facts, classify the phenotype using CPIC’s standardized activity score thresholds: poor metabolizer (PM) for an activity score of $0$; intermediate metabolizer (IM) for $0  \\text{AS} \\le 1.0$; normal metabolizer (NM) for $1.0  \\text{AS} \\le 2.25$; and ultrarapid metabolizer (UM) for $\\text{AS} > 2.25$.\n\nCompute the total activity score for the diplotype \"CYP2D6*1/*4\". Provide the phenotype classification as part of your reasoning. The final answer must be the single total activity score value. No rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in established principles of pharmacogenomics, is well-posed with all necessary information provided, and is expressed in objective, unambiguous language. The premises regarding the functionality of Cytochrome P450 Family 2 Subfamily D Member 6 (`CYP2D6`) alleles, the additive model for diplotype activity, and the Clinical Pharmacogenetics Implementation Consortium (CPIC) classification standards are all consistent with current clinical practice in precision medicine.\n\nThe central task is to compute the total activity score for a given `CYP2D6` diplotype and subsequently classify the corresponding metabolic phenotype. The problem statement establishes that for a diploid locus with independent transcription and no dominance, the net enzymatic activity can be modeled as a linear sum of the contributions from each allele. This is the additive model.\n\nLet $\\text{AS}$ represent the total activity score. For a diplotype composed of two alleles, Allele 1 and Allele 2, the activity score is given by:\n$$\n\\text{AS} = \\text{ActivityValue}(\\text{Allele 1}) + \\text{ActivityValue}(\\text{Allele 2})\n$$\nThe problem specifies the diplotype is `CYP2D6*$1$/*$4$`. This means the two alleles present are `CYP2D6*$1$` and `CYP2D6*$4$`. The problem explicitly states that a copy number of $2$ and the absence of hybrid structural variants confirm a standard diploid arrangement, validating the use of this simple additive model.\n\nNext, we must use the provided allele function assignments to determine the activity value for each allele in the diplotype.\nThe problem states:\n1.  The `CYP2D6*$1$` allele is classified as a \"normal function\" allele.\n2.  The `CYP2D6*$4$` allele is classified as a \"no function\" allele.\n\nThe corresponding activity values are also provided:\n-   A normal function allele contributes an activity value of $1$.\n-   A no function allele contributes an activity value of $0$.\n\nTherefore, we can assign the specific numerical values:\n-   $\\text{ActivityValue}(\\text{CYP2D6*$1$}) = 1$\n-   $\\text{ActivityValue}(\\text{CYP2D6*$4$}) = 0$\n\nWe can now substitute these values into the formula for the total activity score:\n$$\n\\text{AS} = \\text{ActivityValue}(\\text{CYP2D6*$1$}) + \\text{ActivityValue}(\\text{CYP2D6*$4$})\n$$\n$$\n\\text{AS} = 1 + 0\n$$\n$$\n\\text{AS} = 1\n$$\nThe calculated total activity score for the `CYP2D6*$1$/*$4$` diplotype is $1$.\n\nThe final step of the reasoning process, as requested, is to classify the phenotype using the CPIC standardized activity score thresholds. The thresholds are defined as:\n-   Poor metabolizer: $\\text{AS} = 0$\n-   Intermediate metabolizer: $0  \\text{AS} \\le 1.0$\n-   Normal metabolizer: $1.0  \\text{AS} \\le 2.25$\n-   Ultrarapid metabolizer: $\\text{AS} > 2.25$\n\nOur calculated activity score is $\\text{AS}=1$. We evaluate this value against the given intervals. The value $1$ falls within the interval for an Intermediate Metabolizer ($0  \\text{AS} \\le 1.0$). Therefore, the predicted phenotype for an individual with the `CYP2D6*$1$/*$4$` diplotype is \"intermediate metabolizer\".\n\nThe problem asks for the total activity score as the final answer.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Beyond single nucleotide variants, the star allele system must also account for structural variations like gene duplications, which can dramatically alter enzyme activity. This practice explores how to interpret genotypes involving copy number variation (CNV), a common and critical feature of the `CYP2D6` gene. You will learn how the `xN` notation is integrated into the activity score calculation to refine phenotype prediction. ",
            "id": "4386216",
            "problem": "A clinical pharmacogenomics report for a patient lists the following for the cytochrome P450 family 2 subfamily D member 6 gene (CYP2D6): star allele genotype string \"CYP2D6*4x2/*4\", copy-number calling consistent with a total of three gene copies, long-range polymerase chain reaction (PCR) showing a tandem duplication in cis on one chromosome, and no evidence of hybrid alleles (for example, CYP2D6/CYP2D7 hybrids). The laboratory assigns the star alleles using the Pharmacogene Variation Consortium (PharmVar) definitions, where CYP2D6*4 is a no-function allele. Using only the following foundational bases: (i) the Central Dogma of Molecular Biology stating that gene sequence variation that disrupts normal transcript processing or protein structure can abolish enzyme activity, (ii) PharmVar star allele definitions that classify CYP2D6*4 as a no-function allele, and (iii) the Clinical Pharmacogenetics Implementation Consortium (CPIC) activity score framework in which a no-function allele contributes $0$ to the activity score and duplication multiplies the contribution of the duplicated haplotype by its copy count, determine the most accurate interpretation of the reported genotype with respect to the number of nonfunctional CYP2D6 copies and the predicted metabolizer phenotype.\n\nWhich option best reflects the correct interpretation?\n\nA. The call indicates exactly three nonfunctional CYP2D6 copies and an overall activity score of $0$, consistent with a poor metabolizer phenotype.\n\nB. The call indicates at least three nonfunctional CYP2D6 copies, but the duplication confers increased enzyme output; therefore, the phenotype is ultrarapid metabolizer.\n\nC. The call indicates two nonfunctional copies and one normal-function copy, producing an intermediate metabolizer phenotype.\n\nD. The call cannot be translated into a phenotype using star allele nomenclature when copy-number variation is present; a functional assay is required instead.",
            "solution": "### Step 1: Deconstruct the Problem\nThe following data and definitions are provided:\n*   **Gene:** `CYP2D6`\n*   **Genotype String:** `CYP2D6*4x2/*4`\n*   **Gene Copy Number:** Total of three gene copies confirmed.\n*   **Allele Configuration:** A tandem duplication in `cis` on one chromosome.\n*   **Allele Definition:** The `CYP2D6*4` allele is a no-function allele.\n*   **Activity Score Framework:** A no-function allele contributes a score of $0$. A duplication (`xN`) multiplies the duplicated haplotype's contribution by its copy count (`N`).\n\n### Step 2: Interpret the Genotype String\nThe standard star allele nomenclature separates the two haplotypes (the set of alleles on each of the two homologous chromosomes) with a slash (`/`).\n*   **Haplotype 1:** `*4x2`. This notation signifies that the `CYP2D6*4` allele is present, and it has been duplicated on this chromosome, resulting in $2$ copies in `cis` (on the same chromosome).\n*   **Haplotype 2:** `*4`. This notation signifies that the `CYP2D6*4` allele is present as a single copy on the second chromosome.\n\n### Step 3: Count the Nonfunctional Copies\n*   The problem states that `CYP2D6*4` is a no-function allele.\n*   Haplotype 1 (`*4x2`) contributes $2$ copies of the no-function `*4` allele.\n*   Haplotype 2 (`*4`) contributes $1$ copy of the no-function `*4` allele.\n*   The total number of gene copies is $2 + 1 = 3$.\n*   Since all copies are of the `*4` variant, the total number of nonfunctional copies is also $3$.\n\n### Step 4: Calculate the Activity Score ($\\text{AS}$)\nThe calculation follows the provided CPIC framework. The total $\\text{AS}$ is the sum of the scores from each haplotype.\n*   The activity value assigned to a single no-function allele like `*4` is $0$.\n*   **Score from Haplotype 1 (`*4x2`):** The activity score of the base allele (`*4`, value $0$) is multiplied by its copy number ($2$). The contribution from this haplotype is $0 \\times 2 = 0$.\n*   **Score from Haplotype 2 (`*4`):** This is a single-copy allele with an activity value of $0$. The contribution is $0$.\n*   **Total Activity Score:** $\\text{AS}_{\\text{total}} = (\\text{score from Haplotype 1}) + (\\text{score from Haplotype 2}) = 0 + 0 = 0$.\n\n### Step 5: Determine the Metabolizer Phenotype\nThe phenotype is assigned based on the total activity score. According to standard CPIC guidelines for `CYP2D6`:\n*   $\\text{AS} = 0$: Poor Metabolizer (PM)\n*   $0  \\text{AS} \\le 1.25$: Intermediate Metabolizer (IM)\n*   $1.25  \\text{AS} \\le 2.25$: Normal Metabolizer (NM)\n*   $\\text{AS} > 2.25$: Ultrarapid Metabolizer (UM)\nWith a calculated $\\text{AS}$ of $0$, the predicted phenotype for this patient is **Poor Metabolizer**.\n\n### Step 6: Evaluate the Options\n\n*   **A. The call indicates exactly three nonfunctional CYP2D6 copies and an overall activity score of $0$, consistent with a poor metabolizer phenotype.**\n    This statement aligns perfectly with the derivation. There are $3$ copies (`*4x2` and `*4`), all of which are the no-function `*4` allele. The activity score is $0+0=0$. An activity score of $0$ defines a poor metabolizer.\n    **Verdict: Correct.**\n\n*   **B. The call indicates at least three nonfunctional CYP2D6 copies, but the duplication confers increased enzyme output; therefore, the phenotype is ultrarapid metabolizer.**\n    This reasoning is flawed. While there are $3$ nonfunctional copies, duplication only confers increased output if the duplicated allele is functional. Duplicating a gene that produces a nonfunctional protein results in zero functional protein. The calculation is $0 \\times 2 = 0$, not an increase. An ultrarapid metabolizer phenotype requires a high activity score (typically $\\text{AS} > 2.25$), which is the opposite of the calculated score of $0$.\n    **Verdict: Incorrect.**\n\n*   **C. The call indicates two nonfunctional copies and one normal-function copy, producing an intermediate metabolizer phenotype.**\n    This is an incorrect interpretation of the genotype string `CYP2D6*4x2/*4`. This string indicates that all three copies are of the `*4` variant. There are no normal-function copies (which would typically be denoted `*1`). The count of alleles is wrong.\n    **Verdict: Incorrect.**\n\n*   **D. The call cannot be translated into a phenotype using star allele nomenclature when copy-number variation is present; a functional assay is required instead.**\n    This statement is false. The CPIC/PharmVar star allele nomenclature system is explicitly designed to incorporate copy number variation into phenotype prediction. The `xN` suffix is the standard notation for this purpose, and the activity score model is the established algorithm for making the translation.\n    **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The star allele is a convenient shorthand, but its integrity relies on precise mapping to foundational genomic data standards like HGVS nomenclature and dbSNP identifiers. This exercise simulates a crucial quality control task: validating the consistency of a reported star allele with its underlying variant definitions. This practice is especially important for genes on the reverse strand, where translating between coding and genomic coordinates requires careful application of molecular principles. ",
            "id": "4386167",
            "problem": "A clinical laboratory reports a pharmacogenetic result for the gene cytochrome P450 family 2 subfamily C member 19 (CYP2C19) as the star allele call \"CYP2C19*2\". In precision medicine, star alleles are curated by the Pharmacogene Variation Consortium (PharmVar), and are mapped to single nucleotide polymorphisms (SNPs) with Reference Single Nucleotide Polymorphism identifier (rsID) codes and Human Genome Variation Society (HGVS) nomenclature at both coding DNA (c.) and genomic DNA (g.) levels. The goal is to validate that the laboratory’s star allele call, rsID, and HGVS strings are internally consistent with PharmVar definitions and with the reference transcript mapping.\n\nFoundational information and definitions:\n- Central Dogma of Molecular Biology: DNA is transcribed to RNA and translated to protein, and for genes on the reverse strand, the coding DNA sequence corresponds to the reverse complement of the forward-strand genomic DNA.\n- HGVS nomenclature states that $c.$ positions are referenced to the complementary DNA (cDNA) of a specific transcript, with $c.1$ at the adenine of the ATG start codon, and $g.$ positions are referenced to the forward strand of the reference genome sequence.\n- The Pharmacogene Variation Consortium (PharmVar) curates star alleles and defines their core variants relative to a specified reference transcript and genome build.\n- The Genome Reference Consortium Human Build $38$ (GRCh38) chromosome reference sequence accession $NC\\_000010.11$ represents chromosome $10$ on the forward strand.\n- The National Center for Biotechnology Information Reference Sequence (RefSeq) transcript $NM\\_000769.3$ is the reference transcript used here for CYP2C19.\n\nAuthoritative dataset for this problem (assume all entries below are correct and current):\n- PharmVar defines CYP2C19*2 by a single core single-nucleotide variant with HGVS coding DNA level $NM\\_000769.3:c.681GA$ and rsID $rs4244285$.\n- CYP2C19 is located on the reverse strand of chromosome $10$; at the GRCh38 genomic coordinate $NC\\_000010.11:g.94761987$ the forward-strand reference base is cytosine ($C$). The $NM\\_000769.3$ cDNA position $c.681$ maps to $NC\\_000010.11:g.94761987$ (forward-strand coordinate). Because the gene is on the reverse strand, the cDNA reference base $G$ at $c.681$ is the reverse complement of the forward-strand genomic reference base $C$, and the $c.681GA$ change corresponds to a $g.94761987CT$ change on the forward strand.\n- The laboratory’s report lists the following for this patient’s variant: star allele \"CYP2C19*2\"; rsID $rs4244285$; HGVS coding DNA string $NM\\_000769.3:c.681GA$; HGVS genomic DNA string $NC\\_000010.11:g.94761987CT$.\n\nDefine the following indicator functions to quantify consistency:\n- $I\\_{\\mathrm{rs}} = 0$ if the laboratory’s rsID equals the PharmVar rsID; otherwise $I\\_{\\mathrm{rs}} = 1$.\n- $I\\_{c} = 0$ if the laboratory’s $c.$ HGVS string matches the PharmVar $c.$ HGVS string in both position and alleles; otherwise $I\\_{c} = 1$.\n- $I\\_{g} = 0$ if the laboratory’s $g.$ HGVS string matches the expected genomic variant obtained by mapping the PharmVar $c.$ variant through the reference transcript to the forward-strand reference genome, taking reverse-complement rules into account; otherwise $I\\_{g} = 1$.\n\nLet the laboratory’s genomic coordinate be $g\\_{\\mathrm{lab}} = 94761987$ and the transcript-derived mapping coordinate be $g\\_{\\mathrm{map}} = 94761987$. Define the scalar validation score\n$$\nS \\;=\\; I\\_{\\mathrm{rs}} \\;+\\; I\\_{c} \\;+\\; I\\_{g} \\;+\\; \\left|\\, g\\_{\\mathrm{lab}} - g\\_{\\mathrm{map}} \\,\\right|.\n$$\n\nUsing only the information provided above and first principles (Central Dogma, HGVS rules, and reverse-complement mapping for reverse-strand genes), compute the value of $S$. Report your final answer as a single real-valued number with no units. No rounding is required.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and internally consistent. It provides all necessary definitions, data, and constraints to compute a unique and meaningful solution. The problem requires the calculation of a validation score, $S$, based on the consistency of a clinical pharmacogenetic report with authoritative reference data. The calculation will proceed by evaluating each term in the definition of $S$.\n\nThe validation score is defined as:\n$$\nS \\;=\\; I\\_{\\mathrm{rs}} \\;+\\; I\\_{c} \\;+\\; I\\_{g} \\;+\\; \\left|\\, g\\_{\\mathrm{lab}} - g\\_{\\mathrm{map}} \\,\\right|\n$$\nEach term will be computed sequentially.\n\n**1. Evaluation of $I\\_{\\mathrm{rs}}$**\n\nThe indicator function $I\\_{\\mathrm{rs}}$ is defined as $0$ if the laboratory’s Reference Single Nucleotide Polymorphism identifier (rsID) matches the one defined by the Pharmacogene Variation Consortium (PharmVar), and $1$ otherwise.\n\n- The laboratory report lists the rsID as $rs4244285$.\n- The authoritative PharmVar dataset defines the core variant for $CYP2C19*2$ with the rsID $rs4244285$.\n\nSince the laboratory's rsID is identical to the PharmVar rsID, the condition for a value of $0$ is met.\n$$\nI\\_{\\mathrm{rs}} = 0\n$$\n\n**2. Evaluation of $I\\_{c}$**\n\nThe indicator function $I\\_{c}$ is defined as $0$ if the laboratory's coding DNA level Human Genome Variation Society (HGVS) string matches the PharmVar definition, and $1$ otherwise.\n\n- The laboratory report lists the HGVS coding DNA string as $NM\\_000769.3:c.681GA$.\n- The authoritative PharmVar dataset defines the core variant for $CYP2C19*2$ with the HGVS coding DNA string $NM\\_000769.3:c.681GA$.\n\nThe two strings are identical in every component (transcript ID, position, reference allele, and variant allele). Therefore, the condition for a value of $0$ is met.\n$$\nI\\_{c} = 0\n$$\n\n**3. Evaluation of $I\\_{g}$**\n\nThe indicator function $I\\_{g}$ is defined as $0$ if the laboratory's genomic DNA level HGVS string matches the expected genomic variant derived from the PharmVar $c.$ variant definition, and $1$ otherwise. This requires deriving the expected genomic string from first principles and the provided data.\n\n- The PharmVar definition is $NM\\_000769.3:c.681GA$.\n- The gene $CYP2C19$ is located on the reverse strand of chromosome $10$.\n- Per the Central Dogma and HGVS rules for reverse-strand genes, the coding DNA (cDNA) sequence, represented by the $NM\\_$ transcript, corresponds to the reverse complement of the sequence on the forward genomic reference strand ($NC\\_$ accession).\n- The reference mapping states that cDNA position $c.681$ maps to the forward-strand genomic coordinate $g.94761987$ on chromosome $10$ ($NC\\_000010.11$).\n- The reference allele at $c.681$ is $G$. The reverse complement of guanine ($G$) is cytosine ($C$). Therefore, the reference base on the forward genomic strand at position $g.94761987$ must be $C$. This is explicitly confirmed by the problem statement.\n- The variant allele at $c.681$ is $A$. The reverse complement of adenine ($A$) is thymine ($T$). Therefore, the variant base on the forward genomic strand at position $g.94761987$ must be $T$.\n- Combining these components, the expected genomic HGVS string is $NC\\_000010.11:g.94761987CT$.\n\nNow, we compare this derived string with the one from the laboratory report.\n- Expected genomic string: $NC\\_000010.11:g.94761987CT$.\n- Laboratory's genomic string: $NC\\_000010.11:g.94761987CT$.\n\nThe strings are identical. Thus, the condition for a value of $0$ is met.\n$$\nI\\_{g} = 0\n$$\n\n**4. Evaluation of $|\\, g\\_{\\mathrm{lab}} - g\\_{\\mathrm{map}} \\,|$**\n\nThis term quantifies the difference between the genomic coordinate reported by the laboratory and the coordinate derived from the reference transcript mapping.\n\n- The laboratory's genomic coordinate is given as $g\\_{\\mathrm{lab}} = 94761987$.\n- The transcript-derived mapping coordinate is given as $g\\_{\\mathrm{map}} = 94761987$.\n\nThe absolute difference is:\n$$\n|\\, g\\_{\\mathrm{lab}} - g\\_{\\mathrm{map}} \\,| = |\\, 94761987 - 94761987 \\,| = |\\, 0 \\,| = 0\n$$\n\n**5. Final Calculation of the Score $S$**\n\nThe total validation score $S$ is the sum of the individual components calculated above.\n$$\nS = I\\_{\\mathrm{rs}} + I\\_{c} + I\\_{g} + |\\, g\\_{\\mathrm{lab}} - g\\_{\\mathrm{map}} \\,|\n$$\nSubstituting the derived values:\n$$\nS = 0 + 0 + 0 + 0 = 0\n$$\nA score of $0$ indicates perfect consistency between the laboratory's report and the authoritative reference data, according to the defined validation metric.",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}