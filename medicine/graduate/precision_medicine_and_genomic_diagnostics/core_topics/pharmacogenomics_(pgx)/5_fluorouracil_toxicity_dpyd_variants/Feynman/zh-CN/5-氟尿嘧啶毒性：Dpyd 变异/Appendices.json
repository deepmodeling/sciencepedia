{
    "hands_on_practices": [
        {
            "introduction": "这项实践旨在建立一个基本原则：遗传信息如何转化为酶的功能。我们将使用一个简单的相加模型，该模型假设总酶活性是来自两个等位基因各自贡献的总和。这项练习  将让你计算携带一个正常等位基因和一个变异等位基因的个体预期的DPD残留活性，为理解基因型与表型的关系提供定量基础。",
            "id": "4313032",
            "problem": "一种化疗药物，5-fluorouracil，主要由二氢嘧啶脱氢酶（DPD）代谢，该酶由二氢嘧啶脱氢酶基因（DPYD）编码。$DPYD$ 基因的变异会改变 DPD 的酶功能，并可通过降低全身清除率来增加 5-fluorouracil 的毒性。体外功能测定将变异等位基因的活性报告为相对于野生型等位基因活性的一个介于 $0$ 和 $1$ 之间的分数。对于剪接位点变异 `DPYD*2A`（也称为 $c.1905+1G>A$），测得的等位基因活性为 $0$。对于被称为 HapB3 的单倍型，体外测量表明其等位基因活性存在分数性降低，记为 $r$，其中 $r \\in [0.25, 0.50]$，因此该等位基因的分数活性为 $1 - r$。\n\n假设一个二倍体加性基因剂量模型，其中两个等位基因的表达水平相等，并且 DPD 的催化活性与各等位基因特异性酶活性的总和成正比。在此模型下，个体相对于野生型纯合子基线的总酶活性是其两个等位基因活性的平均值。仅使用这些前提，从第一性原理推导出携带一个野生型等位基因和一个变异等位基因的杂合子个体在以下每种情况下的预期 DPD 残余活性：\n- `DPYD*2A` 杂合子（野生型加 `DPYD*2A`），\n- HapB3 杂合子（野生型加 HapB3，降低参数 $r \\in [0.25, 0.50]$）。\n\n将 HapB3 的结果以 $r$ 的函数符号形式表示。最终答案应以分数或小数形式给出，不带百分号，且是相对于值为 $1$ 的野生型纯合子基线。",
            "solution": "该问题提法明确，并基于药物基因组学的既定原则。我们将按照问题陈述的要求，从第一性原理出发推导所要求的量。\n\n中心前提是二倍体加性基因剂量模型，即个体的 DPD 总酶活性是其两个 *DPYD* 等位基因活性的平均值。设 $A_{allele1}$ 和 $A_{allele2}$ 表示个体中两个等位基因的分数活性。相对于野生型纯合子基线的 DPD 总残余活性 $A_{Total}$ 由以下公式给出：\n$$ A_{Total} = \\frac{A_{allele1} + A_{allele2}}{2} $$\n问题将野生型纯合子定义为基线参考，其总活性为 $1$。野生型纯合子拥有两个野生型等位基因。设 $A_{WT}$ 代表单个野生型等位基因的活性。根据该模型，野生型纯合子的总活性为：\n$$ A_{WT/WT} = \\frac{A_{WT} + A_{WT}}{2} = A_{WT} $$\n通过将此基线活性设为 $1$，我们确定了单个野生型等位基因的归一化活性：\n$$ A_{WT} = 1 $$\n所有其他等位基因的活性都相对于此值来表示。\n\n问题提供了两种特定变异等位基因的活性：\n1.  对于 `DPYD*2A` 变异，其等位基因活性被说明为 $0$。我们将其活性记为 $A_{\\ast 2A}$。因此：\n$$ A_{\\ast 2A} = 0 $$\n2.  对于 HapB3 单倍型，其等位基因活性降低了分数 $r$，其中 $r \\in [0.25, 0.50]$。由此得到的分数活性，我们记为 $A_{HapB3}$，是：\n$$ A_{HapB3} = 1 - r $$\n\n我们的任务是计算携带一个野生型等位基因和一个变异等位基因的杂合子个体的总活性。\n\n**情况 1：`DPYD*2A` 杂合子**\n`DPYD*2A` 杂合子个体拥有一个野生型等位基因和一个 `DPYD*2A` 等位基因。因此，$A_{allele1} = A_{WT}$ 且 $A_{allele2} = A_{\\ast 2A}$。我们将已知值代入模型方程：\n$$ A_{WT/\\ast 2A} = \\frac{A_{WT} + A_{\\ast 2A}}{2} = \\frac{1 + 0}{2} $$\n得到的 DPD 总活性为：\n$$ A_{WT/\\ast 2A} = \\frac{1}{2} = 0.5 $$\n这表示与野生型纯合子相比，DPD 残余活性为 $50\\%$。\n\n**情况 2：HapB3 杂合子**\nHapB3 单倍型的杂合子个体拥有一个野生型等位基因和一个 HapB3 等位基因。因此，$A_{allele1} = A_{WT}$ 且 $A_{allele2} = A_{HapB3}$。我们将定义的等位基因活性代入模型方程：\n$$ A_{WT/HapB3} = \\frac{A_{WT} + A_{HapB3}}{2} = \\frac{1 + (1 - r)}{2} $$\n简化表达式可得到作为降低参数 $r$ 的函数的 DPD 总活性：\n$$ A_{WT/HapB3} = \\frac{2 - r}{2} = 1 - \\frac{r}{2} $$\n鉴于 $r \\in [0.25, 0.50]$，HapB3 杂合子的预期残余活性将在 $[1 - \\frac{0.50}{2}, 1 - \\frac{0.25}{2}]$ 范围内，计算结果为 $[0.75, 0.875]$。然而，问题要求以 $r$ 的符号形式表示。\n\n这两个推导出的结果是针对指定杂合子基因型的 DPD 残余活性，它们是严格根据加性模型的前提计算得出的。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.5 & 1 - \\frac{r}{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "基于等位基因特异性功能的理念，临床指南通常使用标准化的“基因活性评分”对患者进行分类。该评分将复杂的遗传信息简化为一个可直接用于临床建议的单一数值。在这项实践中 ，你将应用广泛使用的CPIC框架，为具有特定基因型的患者计算一个`DPYD`活性评分，并确定其代谢表型，这是个性化5-FU给药方案中的关键一步。",
            "id": "4313067",
            "problem": "一名患者需要使用抗代谢药物5-氟尿嘧啶进行治疗。由二氢嘧啶脱氢酶基因（DPYD）编码的二氢嘧啶脱氢酶（DPD）催化5-氟尿嘧啶分解代谢的限速步骤。DPD活性的个体间差异部分可由DPYD的遗传变异来解释。临床药物遗传学实施联盟（CPIC）及其他药物基因组学框架采用一种加性基因活性模型，其中每个等位基因被赋予一个功能值，而总基因活性得分是二倍体基因型中两个等位基因功能值的总和。\n\n假设以下基本事实：\n- DPYD等位基因可根据其对DPD酶活性的功能影响分为：正常功能、功能减退和无功能。为正常功能、功能减退和无功能分别赋予数值$1.0$、$0.5$和$0$。\n- 基因活性得分$AS$通过对二倍体基因型中两个等位基因的特异性活性值求和计算得出：$AS = a_{1} + a_{2}$。\n- 代谢表型类别与$AS$的对应关系如下：正常代谢者，如果$AS = 2.0$；中间代谢者，如果$AS \\in \\{1.0, 1.5\\}$；弱代谢者，如果$AS \\in \\{0, 0.5\\}$。\n\n您被提供了以下基因型详情：\n- 一份 `DPYD*2A`（剪接位点变异$c.1905+1G>A$），这是一个无功能等位基因；因此指定$a_{1} = 0$。\n- 一份HapB3（通常由与结构单倍型连锁的$c.1236G>A$标记），在许多临床实践中与功能减退相关；为进行此计算，假设HapB3是一个功能减退的等位基因，并指定$a_{2} = 0.5$。\n- 不存在其他具有临床相关性的$DPYD$变异。\n\n仅使用上述加性模型和赋值，计算基因活性得分$AS$并预测代谢状态。为确保最终答案是数字形式，请使用以下数字代码对代谢状态进行编码：弱代谢者 $= 0$，中间代谢者 $= 1$，正常代谢者 $= 2$。\n\n将您的最终答案表示为行矩阵$\\begin{pmatrix} AS  \\text{code} \\end{pmatrix}$。无需四舍五入，也无需报告单位。在您关于HapB3部分功能分配的推理中，请明确说明任何假设。",
            "solution": "该问题经检验在科学上是合理的、提法得当且内部一致的。它基于临床药物遗传学实施联盟（CPIC）所使用的既定药物基因组学原理，用于根据*DPYD*基因型推荐5-氟尿嘧啶的剂量。解决该问题所需的所有信息均已提供。\n\n目标是计算具有特定*DPYD*基因型患者的二氢嘧啶脱氢酶（DPD）基因活性得分（$AS$），并确定相应的代谢表型。\n\n问题定义了一个加性模型来计算基因活性得分，即二倍体基因型中存在的两个等位基因的活性值之和。公式如下：\n$$\nAS = a_{1} + a_{2}\n$$\n其中$a_{1}$和$a_{2}$是分配给两个等位基因的数值功能值。\n\n问题为等位基因功能提供了以下赋值：\n- 正常功能等位基因：值为$1.0$\n- 功能减退等位基因：值为$0.5$\n- 无功能等位基因：值为$0$\n\n患者的基因型被描述为具有两个特定的等位基因：\n1.  一份 `DPYD*2A`。这被明确定义为一个无功能等位基因。因此，我们将其活性值$a_{1}$赋值为：\n    $$\n    a_{1} = 0\n    $$\n2.  一份HapB3。问题陈述指示，为进行此计算，假设这是一个功能减退的等位基因。因此，我们将其活性值$a_{2}$赋值为：\n    $$\n    a_{2} = 0.5\n    $$\n问题还指出，不存在其他具有临床相关性的*DPYD*变异，这证实了该基因型完全由这两个等位基因描述。\n\n使用提供的公式，我们现在可以计算总基因活性得分$AS$：\n$$\nAS = a_{1} + a_{2} = 0 + 0.5 = 0.5\n$$\n\n接下来，我们必须根据计算出的$AS$确定代谢表型。问题提供了以下对应关系：\n- 正常代谢者：$AS = 2.0$\n- 中间代谢者：$AS \\in \\{1.0, 1.5\\}$\n- 弱代谢者：$AS \\in \\{0, 0.5\\}$\n\n我们计算出的分数为$AS = 0.5$。该值落在为弱代谢表型定义的范围$\\{0, 0.5\\}$内。因此，该患者被归类为弱代谢者。\n\n最后，问题要求将代谢状态编码为数字代码。提供的代码如下：\n- 弱代谢者：代码 $= 0$\n- 中间代谢者：代码 $= 1$\n- 正常代谢者：代码 $= 2$\n\n由于该患者是弱代谢者，相应的数字代码为$0$。\n\n最终答案必须表示为行矩阵$\\begin{pmatrix} AS  \\text{code} \\end{pmatrix}$。代入计算出的值得到：\n$$\n\\begin{pmatrix} 0.5 & 0 \\end{pmatrix}\n$$\n这代表基因活性得分为$0.5$，以及“弱代谢者”的代谢状态代码为$0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "基因型为了解患者的代谢能力提供了一个强有力的视角，但它并不总是完整的。将遗传数据与其他临床测量数据（如生物标志物水平）相结合，可以优化风险评估。这项高级实践  引入了贝叶斯推断，作为一种形式化方法，用尿嘧啶表型测试的新证据来更新基于基因型的DPD缺乏症先验概率，展示了在精准医疗中如何整合多个数据流。",
            "id": "4313083",
            "problem": "一名临床医生正在为一名二氢嘧啶脱氢酶 (DPD) 基因 ($DPYD$) 存在已知变异的患者评估 5-氟尿嘧啶 (5-FU) 的预防性给药方案。该患者是剪接位点变异 `c.1905+1G>A`（也称为 `DPYD*2A`）的杂合子。将二元状态 $D$ 定义为“具有临床意义的 DPD 缺乏”，其操作化定义为 DPD 酶活性低于标准活性的 $70\\%$，并将其补集（“不缺乏”）定义为 $N$。给定该变异携带者基于基因型的先验概率 $P(D)$ 和一项尿嘧啶表型测量值，您需要使用贝叶斯定理来更新风险。\n\n请仅从条件概率的核心定义出发，推导后验概率 $P(D \\mid U=u)$ 的贝叶斯表达式，其中 $U$ 是治疗前血浆尿嘧啶浓度，$u$ 是一个观测值，且测量分布由连续概率密度函数建模。然后，在以下科学上合理的模型中应用您推导的表达式：\n\n- 根据患者基因型，缺乏的先验概率：$P(D) = 0.72$。\n- 补集先验概率：$P(N) = 1 - P(D)$。\n- 在给定 $D$ 的条件下，尿嘧啶浓度 $U$（单位 $\\mathrm{ng}/\\mathrm{mL}$）被建模为均值为 $\\mu_{D} = 19$、标准差为 $\\sigma_{D} = 5$ 的正态分布。\n- 在给定 $N$ 的条件下，尿嘧啶浓度 $U$ 被建模为均值为 $\\mu_{N} = 9$、标准差为 $\\sigma_{N} = 3$ 的正态分布。\n- 观测到的表型结果：$u = 14$。\n\n使用您推导的公式计算后验概率 $P(D \\mid U=14)$。将最终概率表示为小数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题已经过验证，被认为是有效的。它具有科学依据，问题提出得当，客观，并包含得出唯一解所需的所有信息。\n\n该问题需要分两部分作答：首先，推导贝叶斯定理的相关形式；其次，应用该形式计算一个特定的后验概率。\n\n### 第一部分：贝叶斯表达式的推导\n\n我们需要推导后验概率 $P(D \\mid U=u)$ 的表达式，其中 $D$ 是一个离散的二元状态（缺乏），而 $U$ 是一个代表测量值（尿嘧啶浓度）的连续随机变量。我们从条件概率的基本定义开始：\n$$P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$$\n令事件 $A$ 为状态 $D$，事件 $B$ 为观测到尿嘧啶浓度 $U$ 落在一个无穷小区间 $[u, u+du]$ 内。我们将此事件表示为 $\\{u \\le U \\le u+du\\}$。那么后验概率就是当区间宽度 $du$ 趋近于 $0$ 时，$P(D \\mid u \\le U \\le u+du)$ 的极限。\n\n应用条件概率的定义：\n$$P(D \\mid u \\le U \\le u+du) = \\frac{P(D \\cap \\{u \\le U \\le u+du\\})}{P(u \\le U \\le u+du)}$$\n分子中的联合概率可以再次使用条件概率的定义 $P(X \\cap Y) = P(X \\mid Y)P(Y)$ 来改写：\n$$P(D \\cap \\{u \\le U \\le u+du\\}) = P(u \\le U \\le u+du \\mid D) P(D)$$\n连续随机变量 $U$ 落入小区间 $[u, u+du]$ 的概率与其概率密度函数 (PDF) 相关。令 $f_U(u)$ 为 $U$ 的边缘概率密度函数，令 $f(u \\mid D)$ 和 $f(u \\mid N)$ 分别为给定状态是 $D$ 或其补集 $N$ 时 $U$ 的条件概率密度函数。对于一个非常小的区间宽度 $du$，我们可以做出以下近似：\n$$P(u \\le U \\le u+du) \\approx f_U(u) \\, du$$\n$$P(u \\le U \\le u+du \\mid D) \\approx f(u \\mid D) \\, du$$\n将这些表达式代回到我们的后验概率方程中：\n$$P(D \\mid u \\le U \\le u+du) \\approx \\frac{f(u \\mid D) \\, du \\cdot P(D)}{f_U(u) \\, du}$$\n分子和分母中的 $du$ 项相互抵消，得到：\n$$P(D \\mid U=u) = \\frac{f(u \\mid D) P(D)}{f_U(u)}$$\n这就是针对离散状态和连续观测的贝叶斯定理。项 $f(u \\mid D)$ 是在给定状态 $D$ 的情况下观测到值 $u$ 的似然。$P(D)$ 是状态 $D$ 的先验概率。分母 $f_U(u)$ 是观测值的边缘概率密度函数，通常称为“证据”。\n\n为了使这个表达式完全可用，我们使用全概率定律展开证据项。由于状态 $D$ 和 $N$ 是互斥且穷尽的（它们构成了事件空间的一个划分），我们可以将 $U$ 的边缘概率密度函数写成条件概率密度函数的加权和：\n$$f_U(u) = f(u \\mid D) P(D) + f(u \\mid N) P(N)$$\n将此展开式代入贝叶斯定理的分母，得到计算所需的最终形式：\n$$P(D \\mid U=u) = \\frac{f(u \\mid D) P(D)}{f(u \\mid D) P(D) + f(u \\mid N) P(N)}$$\n这就是推导出的表达式。\n\n### 第二部分：应用与计算\n\n我们现在使用所提供的数据应用此公式。\n给定的信息如下：\n-   DPD 缺乏的先验概率：$P(D) = 0.72$\n-   不缺乏的先验概率：$P(N) = 1 - P(D) = 1 - 0.72 = 0.28$\n-   观测到的尿嘧啶浓度：$u = 14 \\, \\mathrm{ng}/\\mathrm{mL}$\n-   给定 $D$ 时 $U$ 的条件分布是正态分布：$U \\mid D \\sim \\mathcal{N}(\\mu_{D}, \\sigma_{D}^2)$，其中 $\\mu_{D} = 19$，$\\sigma_{D} = 5$。\n-   给定 $N$ 时 $U$ 的条件分布是正态分布：$U \\mid N \\sim \\mathcal{N}(\\mu_{N}, \\sigma_{N}^2)$，其中 $\\mu_{N} = 9$，$\\sigma_{N} = 3$。\n\n正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数 (PDF) 由以下公式给出：\n$$f(x \\mid \\mu, \\sigma^2) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$$\n我们必须计算似然 $f(u=14 \\mid D)$ 和 $f(u=14 \\mid N)$。\n\n缺乏状态 $D$ 的似然：\n$$f(u=14 \\mid D) = \\frac{1}{\\sigma_D\\sqrt{2\\pi}} \\exp\\left(-\\frac{(14 - \\mu_D)^2}{2\\sigma_D^2}\\right)$$\n$$f(u=14 \\mid D) = \\frac{1}{5\\sqrt{2\\pi}} \\exp\\left(-\\frac{(14 - 19)^2}{2 \\cdot 5^2}\\right) = \\frac{1}{5\\sqrt{2\\pi}} \\exp\\left(-\\frac{(-5)^2}{50}\\right) = \\frac{1}{5\\sqrt{2\\pi}} \\exp\\left(-\\frac{25}{50}\\right) = \\frac{1}{5\\sqrt{2\\pi}} \\exp(-0.5)$$\n不缺乏状态 $N$ 的似然：\n$$f(u=14 \\mid N) = \\frac{1}{\\sigma_N\\sqrt{2\\pi}} \\exp\\left(-\\frac{(14 - \\mu_N)^2}{2\\sigma_N^2}\\right)$$\n$$f(u=14 \\mid N) = \\frac{1}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{(14 - 9)^2}{2 \\cdot 3^2}\\right) = \\frac{1}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{5^2}{18}\\right) = \\frac{1}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{25}{18}\\right)$$\n现在我们将这些似然和先验概率代入贝叶斯公式：\n$$P(D \\mid U=14) = \\frac{f(14 \\mid D) P(D)}{f(14 \\mid D) P(D) + f(14 \\mid N) P(N)}$$\n$$P(D \\mid U=14) = \\frac{\\left( \\frac{1}{5\\sqrt{2\\pi}} \\exp(-0.5) \\right) (0.72)}{\\left( \\frac{1}{5\\sqrt{2\\pi}} \\exp(-0.5) \\right) (0.72) + \\left( \\frac{1}{3\\sqrt{2\\pi}} \\exp\\left(-\\frac{25}{18}\\right) \\right) (0.28)}$$\n常数因子 $\\frac{1}{\\sqrt{2\\pi}}$ 出现在所有项中，可以消去：\n$$P(D \\mid U=14) = \\frac{\\frac{1}{5} \\exp(-0.5) \\cdot 0.72}{\\frac{1}{5} \\exp(-0.5) \\cdot 0.72 + \\frac{1}{3} \\exp\\left(-\\frac{25}{18}\\right) \\cdot 0.28}$$\n我们进行数值计算。\n设分子表示为 $\\mathcal{N'}$，分母中的两项分别表示为 $\\mathcal{D'}_1$ 和 $\\mathcal{D'}_2$。\n$$\\mathcal{N'} = \\mathcal{D'}_1 = \\frac{0.72}{5} \\exp(-0.5) = 0.144 \\exp(-0.5)$$\n$$\\mathcal{D'}_2 = \\frac{0.28}{3} \\exp\\left(-\\frac{25}{18}\\right)$$\n使用数值 $\\exp(-0.5) \\approx 0.60653066$ 和 $\\exp(-25/18) \\approx 0.24935240$：\n$$\\mathcal{N'} = 0.144 \\times 0.60653066 \\approx 0.087340416$$\n$$\\mathcal{D'}_2 = \\frac{0.28}{3} \\times 0.24935240 \\approx 0.09333333 \\times 0.24935240 \\approx 0.023272891$$\n后验概率为：\n$$P(D \\mid U=14) = \\frac{\\mathcal{N'}}{\\mathcal{D'}_1 + \\mathcal{D'}_2} = \\frac{0.087340416}{0.087340416 + 0.023272891} = \\frac{0.087340416}{0.110613307} \\approx 0.7895999$$\n观测到的尿嘧啶值 $u=14$ 位于两个均值 $\\mu_N=9$ 和 $\\mu_D=19$ 之间。虽然它与两个均值的距离都是 $5$ 个单位，但考虑到 $D$ 的分布标准差更大，且 $D$ 的先验概率已经很高（$0.72$），因此后验概率略有增加，约为 $0.79$。\n\n将最终答案四舍五入到四位有效数字，我们得到 $0.7896$。",
            "answer": "$$\\boxed{0.7896}$$"
        }
    ]
}