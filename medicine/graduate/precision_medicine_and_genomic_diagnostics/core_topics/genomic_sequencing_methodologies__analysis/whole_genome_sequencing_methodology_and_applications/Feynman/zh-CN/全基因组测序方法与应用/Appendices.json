{
    "hands_on_practices": [
        {
            "introduction": "在任何测序项目的规划阶段，一个最基本的问题是：“需要多少测序数据才足够？”。本练习将从第一性原理出发，基于随机霰弹法测序模型，推导计算预期覆盖度的基本公式 $C = NL/G$。 此练习进一步引入泊松分布，将其作为一种强大的近似方法，用以估算基因组中任意碱基未被覆盖到的概率，这是衡量测序数据质量的关键指标。",
            "id": "4397193",
            "problem": "在一项用于精准肿瘤学的随机鸟枪法全基因组测序实验中，一个大小为 $G$ 碱基对的单倍体人类基因组通过生成 $N$ 个长度均为 $L$ 碱基对的单端读段进行测序。假定读段沿着基因组均匀且独立地随机分布，其起始位置在所有可能的位置上是等概率的。假设 $G \\gg L$，因此边界效应可以忽略不计，且不存在比对偏好。某个基因组位置的覆盖深度定义为与该位置重叠的读段数量。\n\n仅从以下基本原理出发：\n- 中心法则确立了测序报告的是基因组位置上的核苷酸内容，而覆盖深度是在一个碱基上的独立观测计数。\n- 在均匀独立放置的条件下，任意一个读段覆盖一个特定碱基的概率等于能导致重叠的起始位置所占的比例，而一个碱基上的覆盖读段数是一系列独立伯努利试验的总和。\n- 对于大量试验中的小概率事件，参数为 $(n, p)$ 的二项分布可由均值为 $\\lambda = n p$ 的泊松分布近似。\n\n任务：\n1. 用 $G$、$N$ 和 $L$ 表示任意一个碱基上的期望覆盖深度。\n2. 使用由上述假设支持的适当极限论证，推导出一个给定碱基未被覆盖（覆盖深度等于零）的概率，用期望覆盖深度表示。\n3. 对于一个大小为 $G = 3.0 \\times 10^{9}$ 碱基对的基因组，有 $N = 8.0 \\times 10^{7}$ 个长度为 $L = 150$ 碱基对的读段，计算一个给定碱基未被覆盖的概率。将最终概率四舍五入到四位有效数字，并以不带单位的小数形式表示。",
            "solution": "该问题要求在一个随机鸟枪法测序实验中推导关键指标并进行后续的数值计算。该问题经验证是自洽的、有科学依据且良定的。我们将按顺序完成这三项任务。\n\n### 任务1：推导期望覆盖深度\n\n令 $G$ 为单倍体基因组的大小（单位为碱基对），$N$ 为读段总数，$L$ 为每个读段的长度（单位为碱基对）。读段是均匀且独立地随机放置的。我们需要求出任意一个碱基上的期望覆盖深度。我们用 $\\lambda$ 表示期望覆盖深度。\n\n考虑基因组中位置为 $k$ 的一个任意碱基。现在，考虑一个长度为 $L$ 的单次读段。该读段的起始位置是从所有可能的起始位置中均匀随机选择的。假设在一个离散模型中，读段从一个特定的碱基位置开始，那么有 $G$ 个可能的起始位置，从 $1$ 到 $G$ 编号。题目指出边界效应可以忽略不计，这等价于假设基因组是环形的，或者因为 $G \\gg L$ 允许我们忽略线性基因组两端附近碱基的边缘情况。\n\n一个从位置 $s$ 开始、长度为 $L$ 的读段将覆盖区间 $[s, s+L-1]$ 内的所有碱基。为了使我们位于位置 $k$ 的特定碱基被这个读段覆盖，它的位置必须落在这个区间内，即 $s \\le k \\le s+L-1$。这个不等式可以重新整理，以定义“成功”起始位置 $s$ 的范围：$k-L+1 \\le s \\le k$。\n\n满足这个条件的整数起始位置 $s$ 的数量为 $(k) - (k-L+1) + 1 = L$。由于读段总共有 $G$ 个可能的起始位置，且每个位置都是等概率的，因此单个随机放置的读段覆盖位置 $k$ 的特定碱基的概率 $p$ 是有利结果数与总结果数之比：\n$$p = \\frac{L}{G}$$\n在没有边界效应的假设下，这个概率对于任何碱基 $k$ 都是相同的。\n\n现在，我们考虑所有的 $N$ 个读段。每个读段的放置是一个独立事件。位置 $k$ 的总覆盖深度，我们称之为 $C_k$，是覆盖该位置的读段总数。我们可以定义 $N$ 个独立的伯努利随机变量 $X_i$（$i=1, \\dots, N$），其中如果读段 $i$ 覆盖碱基 $k$，则 $X_i=1$，否则 $X_i=0$。每次试验的成功概率是 $P(X_i=1) = p = L/G$。\n\n总覆盖深度是这些变量的和：$C_k = \\sum_{i=1}^{N} X_i$。\n根据期望的线性性质，期望覆盖深度 $\\lambda$ 为：\n$$\\lambda = E[C_k] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i]$$\n单个伯努利变量 $X_i$ 的期望是其成功概率，即 $E[X_i] = p = L/G$。因此，\n$$\\lambda = \\sum_{i=1}^{N} p = Np = \\frac{NL}{G}$$\n这就是任意一个碱基上的期望覆盖深度。\n\n### 任务2：推导未覆盖碱基的概率\n\n给定碱基的覆盖深度 $C_k$ 是 $N$ 次独立同分布的伯努利试验的总和，每次试验的成功概率为 $p=L/G$。因此，随机变量 $C_k$ 服从二项分布：$C_k \\sim \\text{Binomial}(N, p)$。观测到覆盖深度恰好为 $k$ 的概率是 $P(C_k=k) = \\binom{N}{k} p^k (1-p)^{N-k}$。\n\n问题陈述指导我们使用一个极限论证。在一个典型的全基因组测序实验中，读段数量 $N$ 非常大（在百万到十亿的量级），而单个读段覆盖特定碱基的概率 $p=L/G$ 非常小（因为 $G$ 相对于 $L$ 非常大）。这种情况——大量试验伴随着微小的成功概率——是二项分布可以被泊松分布精确近似的经典条件。\n\n近似的泊松分布的参数是其均值 $\\lambda$，该均值必须等于它所近似的二项分布的均值。正如任务1中推导的，这个均值是 $\\lambda = Np = NL/G$。\n\n令 $K$ 为表示特定碱基覆盖深度的随机变量，服从均值为 $\\lambda$ 的泊松分布。泊松分布的概率质量函数为：\n$$P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n其中 $k$ 是事件发生的次数（即覆盖深度）。\n\n我们要求的是一个给定碱基未被覆盖的概率。这对应于覆盖深度为零的情况，即 $k=0$。将 $k=0$ 代入泊松概率质量函数，得到：\n$$P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!}$$\n利用对于任何 $\\lambda$ 都有 $\\lambda^0=1$ 以及 $0!=1$ 的事实，我们发现：\n$$P(K=0) = \\exp(-\\lambda)$$\n这是一个给定碱基未被覆盖的概率，用期望覆盖深度 $\\lambda$ 表示。\n\n### 任务3：数值计算\n\n我们得到一个人类基因组测序实验的以下数值：\n- 基因组大小 $G = 3.0 \\times 10^{9}$ 碱基对。\n- 读段数量 $N = 8.0 \\times 10^{7}$ 个读段。\n- 读段长度 $L = 150$ 碱基对。\n\n首先，我们使用任务1中推导的公式计算期望覆盖深度 $\\lambda$：\n$$\\lambda = \\frac{NL}{G} = \\frac{(8.0 \\times 10^{7}) \\times 150}{3.0 \\times 10^{9}}$$\n$$\\lambda = \\frac{1200 \\times 10^{7}}{3.0 \\times 10^{9}} = \\frac{1.2 \\times 10^{10}}{3.0 \\times 10^{9}} = \\frac{12.0}{3.0} = 4.0$$\n期望覆盖深度为 $\\lambda=4.0$。\n\n接下来，我们使用任务2中的公式计算一个给定碱基未被覆盖的概率 $P(K=0)$：\n$$P(K=0) = \\exp(-\\lambda) = \\exp(-4.0)$$\n现在我们计算其数值：\n$$P(K=0) \\approx 0.0183156388...$$\n问题要求将此概率四舍五入到四位有效数字。前四位有效数字是 $1$、$8$、$3$ 和 $1$。第五位有效数字是 $5$，因此我们对第四位有效数字进行向上舍入。\n$$P(K=0) \\approx 0.01832$$\n这是最终的数值答案。",
            "answer": "$$\\boxed{0.01832}$$"
        },
        {
            "introduction": "将理论上的覆盖度目标转化为实际的测序方案，需要我们深入理解测序仪器的各项参数。本练习旨在将抽象的覆盖度目标与具体的实验计划联系起来，它将引导您考虑如流通池容量、运行效率和样本多重分析等现实因素。 通过这个计算，您将学会如何在这些变量之间进行权衡，以确定最终的单样本平均覆盖度，这对于设计性价比高且功效强大的测序研究至关重要。",
            "id": "4397209",
            "problem": "一家临床基因组学实验室正计划在具有 $k$ 个物理分离泳道的 Illumina 式图案化流动池上进行一次全基因组测序（WGS）。仪器规格书规定，每个泳道的理论容量为 $Y$ 吉碱基，定义为双末端测序中两端产生的碱基识别总数。由于成簇、相位和碱基识别中的非理想性，只有理论容量的一部分（比例为 $e$）能实现为可用碱基；这个比例 $e$ 被称为运行效率。\n\n该实验室将混合 $s$ 个带条形码的基因组 DNA 文库，并将这同一个多重混合池均匀地加载到所有泳道上，从而使这 $s$ 个文库平均共享整个流动池的产量。假设所有 $s$ 个文库的代表性均等，不存在系统性的索引不平衡，并且平均覆盖度定义为每个样本的总可用测序碱基数除以单倍体有效基因组大小。设人类单倍体有效基因组大小为 $G=2.90$ 吉碱基。\n\n从鸟枪法测序中通量和覆盖度的基本定义（在随机抽样下，平均覆盖度等于总测序碱基数除以基因组大小）出发，推导预期总运行产量和预期单样本平均覆盖度的表达式。然后，使用以下参数：\n- 泳道数 $k=8$\n- 每泳道理论容量 $Y=125$ 吉碱基\n- 运行效率 $e=0.84$\n- 多重混合样本数 $s=30$\n\n计算预期的单样本平均覆盖度。将你的最终答案四舍五入到四位有效数字。将覆盖度表示为一个无量纲的倍数（无单位）。你可以计算预期总产量作为中间量，但最终答案只报告单样本覆盖度。",
            "solution": "首先根据所需标准验证问题陈述。\n\n### 第1步：提取已知条件\n-   泳道数：$k$\n-   每泳道理论容量：$Y$\n-   运行效率：$e$\n-   多重混合样本数：$s$\n-   人类单倍体有效基因组大小：$G = 2.90$ 吉碱基\n-   平均覆盖度定义：$\\text{平均覆盖度} = \\frac{\\text{每样本总可用测序碱基数}}{\\text{单倍体有效基因组大小}}$\n-   条件：$s$ 个文库平均共享整个流动池的产量。\n-   用于计算的具体参数：\n    -   $k=8$\n    -   $Y=125$ 吉碱基\n    -   $e=0.84$\n    -   $s=30$\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据充分**：该问题坚实地基于新一代测序（NGS）的基本原理。流动池、测序产量、运行效率、多重混合和覆盖度等概念在基因组学和生物信息学中都是标准概念。所提供的人类有效基因组大小值（$G = 2.90$ 吉碱基）是用于覆盖度计算的标准、公认的近似值。所有参数对于现代高通量测序实验都是现实的。\n-   **问题适定**：问题定义清晰。它要求推导特定表达式并进行后续数值计算。变量之间的关系已明确说明，从而得出一个唯一、稳定且有意义的解。\n-   **客观性**：语言精确且专业，没有任何主观或含糊的术语。\n-   **完整性与一致性**：提供了所有必要的数据和定义。术语使用一致，问题陈述中没有矛盾。单位（产量和基因组大小的单位均为吉碱基）是一致的。\n\n### 第3步：结论与行动\n该问题被判定为**有效**，因为它科学合理、适定且完整。将推导解答。\n\n### 推导与计算\n主要任务是推导预期单样本平均覆盖度的表达式，然后计算其值。\n\n首先，我们推导预期总运行产量的表达式。流动池的总理论产量，记为 $Y_{total, theoretical}$，是泳道数 $k$ 与每泳道理论容量 $Y$ 的乘积。\n$$Y_{total, theoretical} = k \\cdot Y$$\n\n可用产量，我们记为 $Y_{total, usable}$，是考虑运行效率 $e$ 后实现的理论产量的一部分。\n$$Y_{total, usable} = e \\cdot Y_{total, theoretical} = e \\cdot k \\cdot Y$$\n该表达式代表预期的总运行产量，单位为吉碱基。\n\n接下来，我们确定分配给单个样本的可用测序数据量。问题陈述说明，总可用产量在 $s$ 个多重混合样本中平均分配。因此，每样本的可用产量，记为 $Y_{sample}$，是：\n$$Y_{sample} = \\frac{Y_{total, usable}}{s} = \\frac{e \\cdot k \\cdot Y}{s}$$\n\n问题将平均覆盖度 $C$ 定义为每样本总可用测序碱基数除以单倍体有效基因组大小 $G$。使用我们推导出的 $Y_{sample}$ 表达式：\n$$C = \\frac{Y_{sample}}{G}$$\n代入 $Y_{sample}$ 的表达式，得到预期单样本平均覆盖度的最终通用公式：\n$$C = \\frac{e \\cdot k \\cdot Y}{s \\cdot G}$$\n注意，由于 $Y$ 和 $G$ 的单位都是吉碱基，所以覆盖度 $C$ 是一个无量纲量，这是正确的。\n\n现在，我们将给定的数值代入此表达式以计算最终答案。\n参数如下：\n-   $k = 8$\n-   $Y = 125$ 吉碱基\n-   $e = 0.84$\n-   $s = 30$\n-   $G = 2.90$ 吉碱基\n\n将这些值代入覆盖度公式：\n$$C = \\frac{0.84 \\cdot 8 \\cdot 125}{30 \\cdot 2.90}$$\n首先，我们计算分子（总可用产量）：\n$$0.84 \\cdot 8 \\cdot 125 = 0.84 \\cdot 1000 = 840$$\n接下来，我们计算分母：\n$$30 \\cdot 2.90 = 3 \\cdot 29 = 87$$\n现在我们计算覆盖度的最终值：\n$$C = \\frac{840}{87} \\approx 9.65517241...$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $9.655$。第五位数字是 $1$，所以我们向下舍入。\n$$C \\approx 9.655$$\n预期的单样本平均覆盖度约为 $9.655$X。",
            "answer": "$$\\boxed{9.655}$$"
        },
        {
            "introduction": "生成并比对好测序读数后，我们的最终目标是获得生物学发现，例如确定一个个体的基因型。本练习将带您深入现代变异检测算法的核心，应用贝叶斯定理来解决这一问题。 它演示了如何将先验知识（来自群体频率）、观测证据（测序读数计数）以及一个明确的测序错误模型相结合，来计算每种可能基因型的后验概率，从而做出统计上稳健的结论。",
            "id": "4397190",
            "problem": "一个二倍体人类基因组中的双等位基因单核苷酸位点通过全基因组测序（WGS）被测序。您观察到总共有 $n = 40$ 条覆盖该位点的独立、高质量的测序读数，其中 $k = 18$ 条报告了变异等位基因，$n - k = 22$ 条报告了参考等位基因。假设每碱基的对称测序错误率为 $\\epsilon = 10^{-3}$，即来自真实参考等位基因的读数被错读为变异等位基因的概率为 $\\epsilon$，而来自真实变异等位基因的读数被错读为参考等位基因的概率也为 $\\epsilon$。假设从两条染色体上对等位基因的抽样是无偏的，并且各测序读数之间是独立的。\n\n给定在相关的祖源匹配人群中，变异等位基因的种群频率为 $f = 0.01$。在哈迪-温伯格平衡条件下，使用这个 $f$ 来为三种二倍体基因型 $G \\in \\{ \\text{hom-ref}, \\text{het}, \\text{hom-alt} \\}$ 设置基因型先验概率。使用贝叶斯法则和一个基于上述错误过程的二项抽样模型，计算给定数据 $(n, k)$ 时每种基因型的后验概率，并确定哪种基因型最有可能。\n\n只需报告最可能基因型的后验概率，以小数形式表示并四舍五入到 $4$ 位有效数字。不需要单位。",
            "solution": "用户希望使用贝叶斯推断解决一个基因组诊断学中的问题。\n\n### 步骤1：提取已知条件\n- 总测序读数数量：$n = 40$。\n- 报告变异等位基因的读数数量：$k = 18$。\n- 报告参考等位基因的读数数量：$n - k = 22$。\n- 对称测序错误率：$\\epsilon = 10^{-3}$。\n- 变异等位基因的种群频率：$f = 0.01$。\n- 基因型：$G \\in \\{ \\text{hom-ref}, \\text{het}, \\text{hom-alt} \\}$。将它们分别表示为 $G_0$、$G_1$ 和 $G_2$。\n- 模型假设如下：\n    1. 基因型先验概率遵循哈迪-温伯格平衡。\n    2. 测序读数计数遵循二项抽样模型。\n    3. 测序读数是独立的。\n    4. 从两条染色体上对等位基因的抽样是无偏的。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，属于基因组学中变异检测的标准实践。它使用了哈迪-温伯格平衡和带有二项似然的贝叶斯推断等已确立的原则，这些都是统计遗传学的基础。该问题提法明确，提供了所有必要的参数（$n$、$k$、$\\epsilon$、$f$）和一个明确的目标。语言精确客观。没有矛盾、信息缺失或违反科学原则的情况。因此，该问题被认为是有效的。\n\n### 步骤3：结论与行动\n问题有效。我现在将进行完整的解答。\n\n### 解题推导\n目标是计算三种可能基因型的后验概率 $P(G|D)$，其中 $G$ 是基因型，$D$ 是观测数据 $(n=40, k=18)$。我们使用贝叶斯法则：\n$$P(G_i|D) = \\frac{P(D|G_i) P(G_i)}{\\sum_{j=0}^{2} P(D|G_j) P(G_j)}$$\n对于 $i \\in \\{0, 1, 2\\}$，其中 $G_0 = \\text{hom-ref}$，$G_1 = \\text{het}$，以及 $G_2 = \\text{hom-alt}$。\n\n#### 1. 基因型先验概率, $P(G_i)$\n在哈迪-温伯格平衡下，基因型频率由等位基因频率决定。变异等位基因的频率给定为 $f = 0.01$。参考等位基因的频率为 $1-f = 0.99$。\n三种基因型的先验概率为：\n-   $P(G_0) = P(\\text{hom-ref}) = (1-f)^2 = (0.99)^2 = 0.9801$。\n-   $P(G_1) = P(\\text{het}) = 2f(1-f) = 2(0.01)(0.99) = 0.0198$。\n-   $P(G_2) = P(\\text{hom-alt}) = f^2 = (0.01)^2 = 0.0001$。\n先验概率之和为 $0.9801 + 0.0198 + 0.0001 = 1.0000$。\n\n#### 2. 似然, $P(D|G_i)$\n在总共 $n$ 条读数中观测到 $k$ 条变异读数的似然遵循二项分布：\n$$P(D|G_i) = P(k|n, \\theta_{G_i}) = \\binom{n}{k} \\theta_{G_i}^k (1-\\theta_{G_i})^{n-k}$$\n其中 $\\theta_{G_i}$ 是在给定基因型 $G_i$ 的情况下，单条读数为变异等位基因的概率。\n\n- 对于 $G_0$（纯合参考型，基因型RR）：两条染色体都携带参考等位基因。只有在发生测序错误时才能观测到变异读数。因此，一条读数为变异等位基因的概率是 $\\theta_{G_0} = \\epsilon$。\n- 对于 $G_1$（杂合型，基因型RA）：一条染色体是参考型，一条是变异型。假设从两条染色体上进行无偏抽样，则一条读数来自参考染色体的概率为 $0.5$，来自变异染色体的概率为 $0.5$。\n    - 读出变异等位基因的概率是：$P(\\text{read from A})P(\\text{not error}) + P(\\text{read from R})P(\\text{error}) = 0.5 \\times (1-\\epsilon) + 0.5 \\times \\epsilon = 0.5$。\n    - 因此，$\\theta_{G_1} = 0.5$。\n- 对于 $G_2$（纯合变异型，基因型AA）：两条染色体都携带变异等位基因。只有在发生错误时才能观测到参考读数。一条读数为变异等位基因的概率是 $\\theta_{G_2} = 1-\\epsilon$。\n\n代入给定值 $n=40$，$k=18$ 和 $\\epsilon=10^{-3}$：\n- $\\theta_{G_0} = 0.001$。\n- $\\theta_{G_1} = 0.5$。\n- $\\theta_{G_2} = 1 - 0.001 = 0.999$。\n\n似然值为：\n- $P(D|G_0) = \\binom{40}{18} (0.001)^{18} (0.999)^{22}$。\n- $P(D|G_1) = \\binom{40}{18} (0.5)^{18} (0.5)^{22} = \\binom{40}{18} (0.5)^{40}$。\n- $P(D|G_2) = \\binom{40}{18} (0.999)^{18} (0.001)^{22}$。\n\n#### 3. 后验概率, $P(G_i|D)$\n我们需要计算未归一化的后验概率，它与似然和先验的乘积 $P(D|G_i)P(G_i)$ 成正比。$\\binom{40}{18}$ 项是公共因子，在比较相对大小时可以省略。\n\n- $G_0$ 的未归一化后验概率：$T_0 \\propto (0.001)^{18}(0.999)^{22} \\times 0.9801$。\n- $G_1$ 的未归一化后验概率：$T_1 \\propto (0.5)^{40} \\times 0.0198$。\n- $G_2$ 的未归一化后验概率：$T_2 \\propto (0.999)^{18}(0.001)^{22} \\times 0.0001$。\n\n观测到的变异等位基因分数为 $k/n = 18/40 = 0.45$。这个值非常接近 $\\theta_{G_1}=0.5$，而与 $\\theta_{G_0}=0.001$ 和 $\\theta_{G_2}=0.999$ 相差甚远。这表明似然 $P(D|G_1)$ 将远大于 $P(D|G_0)$ 和 $P(D|G_2)$。$G_0$ 的先验概率最大，但 $G_0$ 的似然项极小，包含一个因子 $(10^{-3})^{18} = 10^{-54}$。$G_1$ 的先验概率很小，但其似然值要大得多。$G_2$ 的先验概率和似然值都非常小。因此，我们预期杂合基因型 $G_1$ 最有可能。\n\n最可能的基因型 $G_1$ 的后验概率是：\n$$P(G_1|D) = \\frac{P(D|G_1)P(G_1)}{P(D|G_0)P(G_0) + P(D|G_1)P(G_1) + P(D|G_2)P(G_2)}$$\n将分子和分母同除以 $P(D|G_1)P(G_1)$：\n$$P(G_1|D) = \\frac{1}{\\frac{P(D|G_0)P(G_0)}{P(D|G_1)P(G_1)} + 1 + \\frac{P(D|G_2)P(G_2)}{P(D|G_1)P(G_1)}}$$\n让我们计算这两个比率。二项式系数 $\\binom{40}{18}$ 会被消掉。\n\n比率1：\n$$\\frac{P(D|G_0)P(G_0)}{P(D|G_1)P(G_1)} = \\frac{(0.001)^{18}(0.999)^{22} \\times (0.99)^2}{(0.5)^{40} \\times 2(0.01)(0.99)} = \\frac{(0.001)^{18}(0.999)^{22} \\times 0.99}{(0.5)^{40} \\times 0.02}$$\n- 分子：$(10^{-3})^{18} \\times (0.999)^{22} \\times 0.99 \\approx 10^{-54} \\times 0.9782 \\times 0.99 \\approx 9.684 \\times 10^{-55}$。\n- 分母：$(0.5)^{40} \\times 0.02 \\approx (9.095 \\times 10^{-13}) \\times 0.02 \\approx 1.819 \\times 10^{-14}$。\n- 比率1：$\\frac{9.684 \\times 10^{-55}}{1.819 \\times 10^{-14}} \\approx 5.324 \\times 10^{-41}$。\n\n比率2：\n$$\\frac{P(D|G_2)P(G_2)}{P(D|G_1)P(G_1)} = \\frac{(0.999)^{18}(0.001)^{22} \\times (0.01)^2}{(0.5)^{40} \\times 2(0.01)(0.99)} = \\frac{(0.999)^{18}(0.001)^{22} \\times 0.01}{(0.5)^{40} \\times 1.98}$$\n- 分子：$(0.999)^{18} \\times (10^{-3})^{22} \\times 0.01 \\approx 0.9822 \\times 10^{-66} \\times 10^{-2} \\approx 9.822 \\times 10^{-69}$。\n- 分母：$(0.5)^{40} \\times 1.98 \\approx (9.095 \\times 10^{-13}) \\times 1.98 \\approx 1.801 \\times 10^{-12}$。\n- 比率2：$\\frac{9.822 \\times 10^{-69}}{1.801 \\times 10^{-12}} \\approx 5.454 \\times 10^{-57}$。\n\n两个比率都极小，这证实了 $G_1$ 的未归一化后验概率占主导地位。\n现在，我们计算 $G_1$ 的后验概率：\n$$P(G_1|D) = \\frac{1}{1 + 5.324 \\times 10^{-41} + 5.454 \\times 10^{-57}}$$\n对于任何实际的有效数字位数，该值都与 $1$ 无法区分。\n$P(G_1|D) \\approx 1 - 5.324 \\times 10^{-41}$。\n四舍五入到 $4$ 位有效数字，我们得到 $1.000$。\n\n最可能的基因型是杂合型（$G_1$），其后验概率极度接近于1。\n四舍五入到4位有效数字的概率是 $1.000$。",
            "answer": "$$\\boxed{1.000}$$"
        }
    ]
}