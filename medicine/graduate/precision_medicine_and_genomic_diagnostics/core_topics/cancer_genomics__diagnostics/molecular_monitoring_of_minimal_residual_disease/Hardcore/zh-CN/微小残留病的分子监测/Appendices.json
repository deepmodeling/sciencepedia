{
    "hands_on_practices": [
        {
            "introduction": "在基于下一代测序 (NGS) 的微小残留病 (MRD) 监测中，一个核心的挑战是如何从观测到的变异等位基因频率 (VAF) 准确推断出样本中肿瘤来源DNA的真实比例 ($f$)。直接将VAF等同于肿瘤DNA比例是一个常见的误解，因为它忽略了肿瘤基因组的复杂性。本练习将引导你从第一性原理出发，推导出一个更精确的模型，该模型考虑了肿瘤细胞中的拷贝数变异 (CNA) 和亚克隆结构，这是准确解读MRD检测结果并将其与临床病程联系起来的关键一步。",
            "id": "4361616",
            "problem": "一名患有血液系统恶性肿瘤的患者通过新一代测序技术（NGS）分析血浆游离DNA来监测微小残留病（MRD）。在基因$X$的一个单核苷酸变异（SNV）位点，肿瘤表现出拷贝数变异（CNA），肿瘤总拷贝数为$C_{t} = 3$，并伴有拷贝数中性的杂合性缺失（LOH），该LOH复制了突变等位基因，因此每个携带突变的肿瘤细胞在该位点携带$m = 2$个突变拷贝。该突变存在于一部分比例为$q = 0.7$的肿瘤细胞中（亚克隆）。正常细胞是二倍体，总拷贝数为$C_{n} = 2$，不携带突变拷贝。通过NGS在血浆样本中观察到的变异等位基因频率（VAF）为$V = 0.06$。假设文库制备无偏好，错误可忽略不计，且片段的代表性与混合物中基因组拷贝数成正比。\n\n从第一性原理出发，将VAF定义为混合物中所有细胞贡献的突变等位基因与总等位基因的比率，并将MRD定义为样本中肿瘤来源的DNA分数$f$，推导预期VAF $V$作为$f$、$q$、$m$、$C_{t}$和$C_{n}$的函数的表达式。然后，用代数方法求解该表达式，得到以$V$、$q$、$m$、$C_{t}$和$C_{n}$表示的$f$的封闭形式解。最后，使用给定的数值计算$f$。将您最终的MRD比例$f$表示为小数，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导肿瘤来源DNA分数$f$的表达式，该表达式是观察到的变异等位基因频率（$V$）以及肿瘤和正常细胞的各种基因组参数的函数。在推导出通用公式后，我们必须根据给定的具体参数计算$f$的数值。\n\n### 步骤1：预期变异等位基因频率（VAF）的推导\n\n问题陈述将变异等位基因频率$V$定义为样本中突变等位基因与总等位基因数的比率。样本由游离DNA混合物组成，其中分数$f$来自肿瘤细胞，分数$1-f$来自正常（非肿瘤）细胞。该分析假设从任何给定基因组位点测序的DNA片段数量与贡献细胞群体中该位点的拷贝数成正比。\n\n让我们对血浆样本中的总等位基因数和突变等位基因数进行建模。每种细胞类型（正常或肿瘤）贡献的等位基因数与其在cfDNA池中的分数代表性以及在目标位点的基因组拷贝数成正比。\n\nSNV位点的总等位基因数是正常和肿瘤细胞DNA部分贡献的总和。\n设$N_{alleles, total}$为总等位基因数。\n设$N_{alleles, normal}$为来自正常DNA部分的等位基因数。\n设$N_{alleles, tumor}$为来自肿瘤DNA部分的等位基因数。\n\n来自正常细胞的贡献，其拷贝数为$C_n$并占DNA分数的$1-f$，与$(1-f)C_n$成正比。\n$$N_{alleles, normal} \\propto (1-f)C_n$$\n\n来自肿瘤细胞的贡献，其总拷贝数为$C_t$并占DNA分数的$f$，与$fC_t$成正比。\n$$N_{alleles, tumor} \\propto fC_t$$\n\n因此，样本中的总等位基因数与这些贡献的总和成正比：\n$$N_{alleles, total} \\propto (1-f)C_n + fC_t$$\n\n接下来，我们确定样本中突变等位基因的数量。正常细胞携带0个突变拷贝。突变等位基因完全来源于肿瘤细胞部分。肿瘤群体是亚克隆的，其中分数$q$的肿瘤细胞携带该突变。每个携带突变的细胞都有$m$个突变拷贝。\n\n每个肿瘤细胞的平均突变等位基因数是各亚克隆群体的加权平均值：\n$$(\\text{每个肿瘤细胞的平均突变拷贝数}) = q \\cdot m + (1-q) \\cdot 0 = qm$$\n由肿瘤DNA分数$f$贡献的突变等位基因数与该分数乘以每个肿瘤细胞基因组的平均突变拷贝数成正比。\n$$N_{alleles, mutant} \\propto f \\cdot (qm)$$\n\nVAF，$V$，是突变等位基因数与总等位基因数的比率。比例常数相互抵消。\n$$V = \\frac{N_{alleles, mutant}}{N_{alleles, total}} = \\frac{f q m}{(1-f)C_n + fC_t}$$\n这就是推导出的预期VAF的表达式。这个方程可以解释为混合物中突变等位基因的平均拷贝数$\\langle CN_{mutant} \\rangle = fqm$与混合物中该位点的平均总拷贝数$\\langle CN_{total} \\rangle = (1-f)C_n + fC_t$的比率。\n\n### 步骤2：求解肿瘤分数$f$\n\n我们现在用代数方法求解推导出的$f$的表达式。\n$$V = \\frac{f q m}{(1-f)C_n + fC_t}$$\n两边同乘以分母：\n$$V \\left( (1-f)C_n + fC_t \\right) = f q m$$\n将$V$分配到左侧：\n$$V C_n - V f C_n + V f C_t = f q m$$\n将所有含$f$的项移到方程的一边：\n$$V C_n = f q m + V f C_n - V f C_t$$\n在右侧提出公因子$f$：\n$$V C_n = f(q m + V C_n - V f C_t)$$\n$$V C_n = f(q m + V(C_n - C_t))$$\n最后，分离$f$以获得封闭形式的表达式：\n$$f = \\frac{V C_n}{q m + V(C_n - C_t)}$$\n\n### 步骤3：$f$的数值计算\n\n我们已知以下数值：\n- 观察到的VAF，$V = 0.06$\n- 携带突变的肿瘤细胞比例，$q = 0.7$\n- 突变肿瘤细胞中的突变等位基因拷贝数，$m = 2$\n- 肿瘤细胞中的总拷贝数，$C_t = 3$\n- 正常细胞中的总拷贝数，$C_n = 2$\n\n将这些值代入$f$的表达式中：\n$$f = \\frac{(0.06) \\cdot (2)}{(0.7) \\cdot (2) + (0.06)(2 - 3)}$$\n$$f = \\frac{0.12}{1.4 + (0.06)(-1)}$$\n$$f = \\frac{0.12}{1.4 - 0.06}$$\n$$f = \\frac{0.12}{1.34}$$\n现在，我们进行除法运算：\n$$f \\approx 0.0895522388...$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是$8$、$9$、$5$和$5$。第五位有效数字是$2$，小于$5$，所以我们不对最后一位进行进位。\n$$f \\approx 0.08955$$\n这就是计算出的微小残留病（MRD）比例，以小数形式表示。",
            "answer": "$$\\boxed{0.08955}$$"
        },
        {
            "introduction": "数字PCR (dPCR) 技术通过将样本分散到数以万计的微反应单元中，实现了对核酸分子的绝对定量，为MRD监测提供了极高的灵敏度和精确度。该技术的核心数学基础是泊松分布，它描述了分子在这些微反应单元中的随机分配。本练习模拟了一个真实世界的dPCR定量工作流程，你将需要利用泊松统计来从阳性反应单元的数量估算出目标分子的浓度，并结合样本制备过程中的稀释因子，最终计算出原始血浆样本中的突变分子拷贝数。",
            "id": "4361707",
            "problem": "一个实验室使用数字聚合酶链式反应 (dPCR) 监测微小残留病 (MRD)，通过定量血浆中的突变循环肿瘤DNA靶标，其原理是利用了分子在微反应器中的随机分配遵循泊松过程这一事实。在一次单色检测中，体积为 $V_{\\mathrm{rxn}} = 20\\,\\mu\\mathrm{L}$ 的反应液被分配到 $N = 20000$ 个有效液滴中，平均液滴体积为 $v_p = 0.85\\,\\mathrm{nL}$。在一次运行中，阳性分区的数量为 $\\hat{n} = 150$。加入此反应的核酸提取物体积为 $V_{\\mathrm{in}} = 10\\,\\mu\\mathrm{L}$；从患者血浆中提取的核酸提取物总体积为 $V_{\\mathrm{ext}} = 50\\,\\mu\\mathrm{L}$，该提取物来源于 $V_{\\mathrm{plasma}} = 3\\,\\mathrm{mL}$ 的血浆。\n\n根据在相同化学和仪器设置下进行的先前加标验证，该实验室使用线性校准曲线来校正系统性偏差（包括提取回收率和阈值设定偏差）。该校准将测得的反应混合物浓度 $C_{\\mathrm{meas}}$（拷贝数/$\\mu\\mathrm{L}$反应混合物）映射为偏差校正后的反应浓度 $C_{\\mathrm{true}}$（拷贝数/$\\mu\\mathrm{L}$反应混合物），其关系为\n$C_{\\mathrm{true}} = \\alpha + \\beta\\,C_{\\mathrm{meas}}$，\n其中 $\\alpha = 0.10$ 且 $\\beta = 0.95$。\n\n假设分区占有情况遵循泊松定律，并且如果一个分区包含至少一个靶标分子，则该分区被记为阳性。利用这些假设和以上信息，计算原始血浆中估算的突变靶标浓度，单位为拷贝数/mL。将最终答案四舍五入至三位有效数字。以拷贝数/mL为单位表示最终结果。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 总反应体积：$V_{\\mathrm{rxn}} = 20\\,\\mu\\mathrm{L}$\n- 有效液滴（分区）数量：$N = 20000$\n- 平均液滴体积：$v_p = 0.85\\,\\mathrm{nL}$\n- 阳性分区数量：$\\hat{n} = 150$\n- 核酸提取物输入体积：$V_{\\mathrm{in}} = 10\\,\\mu\\mathrm{L}$\n- 核酸提取物总体积：$V_{\\mathrm{ext}} = 50\\,\\mu\\mathrm{L}$\n- 原始血浆体积：$V_{\\mathrm{plasma}} = 3\\,\\mathrm{mL}$\n- 校准曲线：$C_{\\mathrm{true}} = \\alpha + \\beta\\,C_{\\mathrm{meas}}$\n- 校准截距：$\\alpha = 0.10$\n- 校准斜率：$\\beta = 0.95$\n- 假设1：分区占有情况遵循泊松定律。\n- 假设2：如果一个分区包含至少一个靶标分子，则该分区为阳性。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了定量核酸的标准数字PCR (dPCR) 工作流程，这是现代分子诊断学的基石。使用泊松统计来模拟分子的随机分配是dPCR的基本原理。体积、分区数和阳性计数的数值对于一个典型的dPCR实验是符合实际的。问题提法得当，提供了通过一系列清晰、合乎逻辑的步骤计算所要求浓度所需的所有必要数据。语言客观且精确。不存在矛盾；例如，分析的液滴总体积（$N \\times v_p = 20000 \\times 0.85\\,\\mathrm{nL} = 17\\,\\mu\\mathrm{L})$ 小于反应体积 ($V_{\\mathrm{rxn}} = 20\\,\\mu\\mathrm{L}$)，这是预料之中的，因为存在分配效率低下和死体积。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n目标是计算原始血浆样本中突变靶标分子的浓度，单位为拷贝数/mL。解答过程分为四个主要步骤：\n1.  根据阳性分区的比例估算每个分区的平均分子数 ($\\lambda$)。\n2.  计算dPCR反应中测得的浓度 ($C_{\\mathrm{meas}}$)，并应用校准曲线求出校正后的浓度 ($C_{\\mathrm{true}}$)。\n3.  使用样本处理步骤中的稀释和浓缩因子，反向计算出原始血浆样本中的浓度。\n4.  计算最终数值结果并四舍五入到指定的精度。\n\n首先，我们使用泊松分布来模拟分子在 $N$ 个分区中的分布。一个分区恰好包含 $k$ 个分子的概率由 $P(k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$ 给出，其中 $\\lambda$ 是每个分区的平均分子数。如果一个分区包含一个或多个分子 ($k \\ge 1$)，则为阳性；如果为空 ($k=0$)，则为阴性。一个分区为阴性的概率是：\n$$P(k=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n实验观察到的阴性分区比例是 $\\frac{N - \\hat{n}}{N}$。将理论概率与观察到的比例等同起来，可以估算出 $\\lambda$：\n$$\\exp(-\\lambda) = \\frac{N - \\hat{n}}{N} = 1 - \\frac{\\hat{n}}{N}$$\n求解 $\\lambda$：\n$$\\lambda = -\\ln\\left(1 - \\frac{\\hat{n}}{N}\\right)$$\n代入给定值 $\\hat{n} = 150$ 和 $N = 20000$：\n$$\\lambda = -\\ln\\left(1 - \\frac{150}{20000}\\right) = -\\ln(1 - 0.0075) = -\\ln(0.9925)$$\n\n接下来，我们计算反应混合物中测得的浓度 $C_{\\mathrm{meas}}$。该浓度是每个分区的平均分子数 $\\lambda$ 除以单个分区的体积 $v_p$。我们必须确保单位一致。\n给定 $v_p = 0.85\\,\\mathrm{nL}$，我们将其转换为 $\\mu\\mathrm{L}$：\n$$v_p = 0.85\\,\\mathrm{nL} = 0.85 \\times 10^{-3}\\,\\mu\\mathrm{L}$$\n以拷贝数/$\\mu\\mathrm{L}$为单位的测量浓度是：\n$$C_{\\mathrm{meas}} = \\frac{\\lambda}{v_p} = \\frac{-\\ln(0.9925)}{0.85 \\times 10^{-3}}\\,\\frac{\\text{copies}}{\\mu\\mathrm{L}}$$\n\n现在，我们应用实验室的线性校准曲线来校正系统性偏差：\n$$C_{\\mathrm{true}} = \\alpha + \\beta\\,C_{\\mathrm{meas}}$$\n其中 $\\alpha = 0.10$ 且 $\\beta = 0.95$：\n$$C_{\\mathrm{true}} = 0.10 + 0.95 \\left( \\frac{-\\ln(0.9925)}{0.85 \\times 10^{-3}} \\right)$$\n这个 $C_{\\mathrm{true}}$ 代表dPCR反应混合物中靶标分子的经偏差校正后的浓度，单位是拷贝数/$\\mu\\mathrm{L}$。\n\n最后，我们必须将此浓度与原始血浆样本关联起来。设 $C_{\\mathrm{plasma}}$ 为血浆中的靶标浓度。血浆样本中的靶标分子总数为 $N_{\\mathrm{total}} = C_{\\mathrm{plasma}} \\times V_{\\mathrm{plasma}}$。假设这些分子被回收在总体积为 $V_{\\mathrm{ext}}$ 的核酸提取物中。因此，提取物中的浓度为 $C_{\\mathrm{ext}} = \\frac{N_{\\mathrm{total}}}{V_{\\mathrm{ext}}} = \\frac{C_{\\mathrm{plasma}} V_{\\mathrm{plasma}}}{V_{\\mathrm{ext}}}$。\n然后使用体积为 $V_{\\mathrm{in}}$ 的该提取物来制备最终体积为 $V_{\\mathrm{rxn}}$ 的反应混合物。此反应混合物中的浓度，对应于我们校正后的测量值 $C_{\\mathrm{true}}$，为：\n$$C_{\\mathrm{true}} = C_{\\mathrm{ext}} \\times \\frac{V_{\\mathrm{in}}}{V_{\\mathrm{rxn}}} = \\left(\\frac{C_{\\mathrm{plasma}} V_{\\mathrm{plasma}}}{V_{\\mathrm{ext}}}\\right) \\times \\frac{V_{\\mathrm{in}}}{V_{\\mathrm{rxn}}}$$\n我们现在可以求解所需的量，$C_{\\mathrm{plasma}}$：\n$$C_{\\mathrm{plasma}} = C_{\\mathrm{true}} \\times \\frac{V_{\\mathrm{rxn}}}{V_{\\mathrm{in}}} \\times \\frac{V_{\\mathrm{ext}}}{V_{\\mathrm{plasma}}}$$\n我们需要所有体积都使用一致的单位来计算最终浓度。目标单位是拷贝数/mL，所以我们将 $V_{\\mathrm{plasma}} = 3\\,\\mathrm{mL}$ 保持不变。其他体积的单位是 $\\mu\\mathrm{L}$。我们需要一个转换因子。让我们首先通过将 $V_{\\mathrm{plasma}}$ 转换为 $\\mu\\mathrm{L}$ 来计算单位为拷贝数/$\\mu\\mathrm{L}$的 $C_{\\mathrm{plasma}}$。\n$$V_{\\mathrm{plasma}} = 3\\,\\mathrm{mL} = 3000\\,\\mu\\mathrm{L}$$\n代入体积值：\n$$C_{\\mathrm{plasma}}[\\text{copies}/\\mu\\mathrm{L}] = C_{\\mathrm{true}} \\times \\frac{20\\,\\mu\\mathrm{L}}{10\\,\\mu\\mathrm{L}} \\times \\frac{50\\,\\mu\\mathrm{L}}{3000\\,\\mu\\mathrm{L}} = C_{\\mathrm{true}} \\times 2 \\times \\frac{1}{60} = \\frac{C_{\\mathrm{true}}}{30}$$\n为了以拷贝数/mL报告浓度，我们乘以 $1000\\,\\mu\\mathrm{L}/\\mathrm{mL}$：\n$$C_{\\mathrm{plasma}}[\\text{copies/mL}] = C_{\\mathrm{plasma}}[\\text{copies}/\\mu\\mathrm{L}] \\times 1000 = \\frac{C_{\\mathrm{true}}}{30} \\times 1000 = C_{\\mathrm{true}} \\times \\frac{100}{3}$$\n现在，我们代入 $C_{\\mathrm{true}}$ 的完整表达式：\n$$C_{\\mathrm{plasma}} = \\left[ 0.10 + 0.95 \\left( \\frac{-\\ln(0.9925)}{0.85 \\times 10^{-3}} \\right) \\right] \\times \\frac{100}{3}$$\n我们进行数值计算：\n$$\\lambda = -\\ln(0.9925) \\approx 0.0075282$$\n$$C_{\\mathrm{meas}} = \\frac{0.0075282}{0.85 \\times 10^{-3}} \\approx 8.8567\\,\\frac{\\text{copies}}{\\mu\\mathrm{L}}$$\n$$C_{\\mathrm{true}} = 0.10 + 0.95 \\times 8.8567 \\approx 0.10 + 8.413865 \\approx 8.513865\\,\\frac{\\text{copies}}{\\mu\\mathrm{L}}$$\n$$C_{\\mathrm{plasma}} = 8.513865 \\times \\frac{100}{3} \\approx 283.7955\\,\\frac{\\text{copies}}{\\mathrm{mL}}$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$C_{\\mathrm{plasma}} \\approx 284\\,\\frac{\\text{copies}}{\\mathrm{mL}}$$",
            "answer": "$$\\boxed{284}$$"
        },
        {
            "introduction": "为了提高MRD检测的灵敏度和特异性，临床实践中常采用个性化的多位点追踪策略，即同时监测多个肿瘤特异性突变。然而，这种方法引入了多重假设检验的统计学挑战，增加了假阳性发现的风险。本练习旨在介绍控制假阳性发现率 (FDR) 的统计学原理，你将学习并应用标准的Benjamini-Hochberg程序来校正一组来自不同基因座的p值，从而在保持高检测能力的同时，做出更为可靠的MRD阳性判断。",
            "id": "4361685",
            "problem": "在使用肿瘤信息引导的多位点追踪进行微小残留病灶（MRD）的分子监测中，会对一个患者特异性的位点组合进行纵向测序。对于每个位点，都会进行一次单位点假设检验，其原假设 $H_{0i}$ 为观察到的非参考读数源于背景错误过程（即位点 $i$ 不存在循环肿瘤DNA），备择假设 $H_{1i}$ 为该位点携带真实的肿瘤源信号。在频率派检验中，单位点检验会产生一个p值 $p_{i}$，其定义为在原假设 $H_{0i}$ 成立的情况下，获得一个至少与观测值同样极端的检验统计量的概率。\n\n对于多个位点，要将其中一个子集判断为阳性，就需要控制错误结论的比例。假发现率（FDR）是在所有检验中，所有被判断为阳性的结果里假阳性所占的预期比例。考虑在单个MRD时间点进行的 $N=10$ 个独立的位点水平检验，其单位点p值为\n$$\n0.12,\\;0.0041,\\;0.021,\\;0.35,\\;0.0008,\\;0.19,\\;0.055,\\;0.48,\\;0.012,\\;0.33.\n$$\n假设对于为真的原假设，其p值是独立同分布的，服从 $[0,1]$ 上的连续均匀随机变量。从p值、I类错误和假发现率的核心定义出发，推导一个有原则的决策规则，在独立性假设下，将 $N$ 个同时检验的假发现率控制在 $\\alpha=0.05$ 的水平，并将此规则应用于给定的p值集合，以确定在此时间点应有多少个位点被判断为MRD阳性。\n\n请给出应被判断为阳性的位点数量作为最终答案。无需四舍五入。",
            "solution": "用户希望我解决以下问题：\n在使用肿瘤信息引导的多位点追踪进行微小残留病灶（MRD）的分子监测中，会对一个患者特异性的位点组合进行纵向测序。对于每个位点，都会进行一次单位点假设检验，其原假设 $H_{0i}$ 为观察到的非参考读数源于背景错误过程（即位点 $i$ 不存在循环肿瘤DNA），备择假设 $H_{1i}$ 为该位点携带真实的肿瘤源信号。在频率派检验中，单位点检验会产生一个p值 $p_{i}$，其定义为在原假设 $H_{0i}$ 成立的情况下，获得一个至少与观测值同样极端的检验统计量的概率。对于多个位点，要将其中一个子集判断为阳性，就需要控制错误结论的比例。假发现率（FDR）是在所有检验中，所有被判断为阳性的结果里假阳性所占的预期比例。考虑在单个MRD时间点进行的 $N=10$ 个独立的位点水平检验，其单位点p值为 0.12, 0.0041, 0.021, 0.35, 0.0008, 0.19, 0.055, 0.48, 0.012, 0.33。假设对于为真的原假设，其p值是独立同分布的，服从 $[0,1]$ 上的连续均匀随机变量。从p值、I类错误和假发现率的核心定义出发，推导一个有原则的决策规则，在独立性假设下，将 $N$ 个同时检验的假发现率控制在 $\\alpha=0.05$ 的水平，并将此规则应用于给定的p值集合，以确定在此时间点应有多少个位点被判断为MRD阳性。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n- 任务：微小残留病灶（MRD）的分子监测。\n- 方法：通过测序进行多位点追踪。\n- 独立检验数量：$N=10$。\n- 每个位点 $i$ 的假设：$H_{0i}$（无肿瘤信号） vs. $H_{1i}$（有肿瘤信号）。\n- 检验输出：每个位点的一个p值，$p_i$。\n- 给定的p值：$0.12, 0.0041, 0.021, 0.35, 0.0008, 0.19, 0.055, 0.48, 0.012, 0.33$。\n- 目标：控制假发现率（FDR）。\n- FDR的定义：在所有被判断为阳性的结果中，假阳性所占的预期比例。\n- 期望的FDR控制水平：$\\alpha = 0.05$。\n- 假设1：$N=10$ 个检验是独立的。\n- 假设2：对于为真的原假设，p值是独立同分布（i.i.d.）的，服从连续均匀（$0,1$）随机变量。\n- 要求：推导一个用于FDR控制的有原则的决策规则，将其应用于数据，并确定应被判断为阳性的位点数量。\n\n**步骤2：使用提取的给定信息进行验证**\n该问题在科学上和数学上都是明确定义的。\n- **科学依据**：MRD监测、ctDNA检测、来自测序数据的p值以及多重假设检验的挑战等背景都是计算生物学和基因组医学中标准的、成熟的概念。这些假设（位点独立性，原假设p值的均匀分布）是开发和应用这些统计方法的典型假设。\n- **定义明确**：该问题提供了所有必要信息：一组p值、检验总数、独立性假设以及期望的误差控制水平（用于FDR的 $\\alpha$）。它要求推导并应用一个标准的统计程序（Benjamini-Hochberg），以找到一个唯一的、明确定义的答案（显著位点的数量）。\n- **客观性**：问题以精确、客观和技术性的语言陈述，没有歧义或主观性陈述。\n\n该问题没有任何无效性缺陷。它是在现实科学背景下多重假设检验问题的教科书式范例。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整解答。\n\n### 有原则的决策规则的推导\n\n该问题要求在进行 $N$ 个同时假设检验时，有一个能够控制假发现率（FDR）的决策规则。当一个为真的原假设 $H_{0i}$ 被错误地拒绝时，就会发生I类错误或假阳性。FDR是假阳性数量与发现（被拒绝的假设）总数之比的期望值。设 $V$ 为假阳性数量，$R$ 为被拒绝的假设总数。FDR定义为 $E[Q]$，其中当 $R > 0$ 时 $Q = V/R$，当 $R=0$ 时 $Q=0$。我们希望找到一个程序，使得 $E[Q] \\le \\alpha$。\n\n在检验独立性的假设下，最广泛使用且最有原则的方法是Benjamini-Hochberg（BH）程序。我们将推导其合理性。\n\n将 $N$ 个p值从最小到最大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(N)}$。BH程序是一个递增程序，其工作方式如下：\n\n1. 对于选定的FDR水平 $\\alpha$，找到满足 $p_{(k)} \\le \\frac{k}{N}\\alpha$ 的最大整数 $k$（从 $1$ 到 $N$）。\n2. 如果存在这样的 $k$，令其为 $k_{max}$。拒绝所有对应于 $i=1, 2, \\dots, k_{max}$ 的原假设 $H_{0(i)}$。\n3. 如果不存在这样的 $k$，则不拒绝任何原假设。\n\n被判断为阳性的位点数量为 $k_{max}$。\n\n为了理解为何这是一个有原则的规则，我们可以分析不等式 $p_{(k)} \\le \\frac{k}{N}\\alpha$。它可以重写为 $\\frac{N p_{(k)}}{k} \\le \\alpha$。让我们来解释一下左边的项。\n\n假设我们决定拒绝具有最小p值的 $k$ 个假设。我们隐式设置的阈值是 $t = p_{(k)}$。\n- $k$：这是我们做出的发现（拒绝）的数量 $R$。\n- $p_{(k)}$：这是我们对 $k$ 个发现所使用的p值阈值。\n- 在原假设下，p值在 $[0,1]$ 上均匀分布。如果在 $N$ 个检验中有 $N_0$ 个为真的原假设，那么假阳性（p值 $\\le t$ 的为真原假设）的期望数量是 $E[V] = N_0 t$。\n- 由于 $N_0$ 未知，我们可以使用一个保守界限 $N_0 \\le N$。因此，假阳性的期望数量有界：$E[V] \\le N t$。\n- 对于我们拒绝 $k$ 个假设的程序，阈值是 $t=p_{(k)}$，因此我们可以估计假阳性的期望数量有界于 $N p_{(k)}$。\n- 估计的期望假阳性数与发现数之比为 $\\frac{N p_{(k)}}{k}$。\n\n这个比率 $\\frac{N p_{(k)}}{k}$ 可以看作是如果我们将 $k$ 个位点判断为阳性时的FDR估计值。BH程序会寻找满足此估计FDR仍控制在期望水平 $\\alpha$ 或以下的最大的拒绝数量 $k$。通过取满足条件的最大 $k$（最宽松的阈值），该程序在最大化发现数量的同时，在检验独立性的前提下，可证明地将 $FDR \\le \\frac{N_0}{N}\\alpha \\le \\alpha$。这确立了BH程序就是问题所要求的有原则的决策规则。\n\n### 在给定数据上的应用\n\n我们有 $N=10$ 个p值，目标FDR为 $\\alpha=0.05$。这些p值为：\n$0.12, 0.0041, 0.021, 0.35, 0.0008, 0.19, 0.055, 0.48, 0.012, 0.33$。\n\n首先，我们将p值从最小到最大排序，$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(10)}$：\n$p_{(1)} = 0.0008$\n$p_{(2)} = 0.0041$\n$p_{(3)} = 0.012$\n$p_{(4)} = 0.021$\n$p_{(5)} = 0.055$\n$p_{(6)} = 0.12$\n$p_{(7)} = 0.19$\n$p_{(8)} = 0.33$\n$p_{(9)} = 0.35$\n$p_{(10)} = 0.48$\n\n接下来，我们计算每个排序 $i$ 的Benjamini-Hochberg临界值：$\\frac{i}{N}\\alpha = \\frac{i}{10}(0.05) = i \\times 0.005$。\n\n现在，我们寻找满足 $p_{(k)} \\le k \\times 0.005$ 的最大整数 $k \\in \\{1, \\dots, 10\\}$。我们从 $k=10$ 开始向下检查此条件，直到 $k=1$。\n\n- 对于 $k=10$：$p_{(10)} = 0.48$。临界值 = $10 \\times 0.005 = 0.05$。是否 $0.48 \\le 0.05$？否。\n- 对于 $k=9$：$p_{(9)} = 0.35$。临界值 = $9 \\times 0.005 = 0.045$。是否 $0.35 \\le 0.045$？否。\n- 对于 $k=8$：$p_{(8)} = 0.33$。临界值 = $8 \\times 0.005 = 0.04$。是否 $0.33 \\le 0.04$？否。\n- 对于 $k=7$：$p_{(7)} = 0.19$。临界值 = $7 \\times 0.005 = 0.035$。是否 $0.19 \\le 0.035$？否。\n- 对于 $k=6$：$p_{(6)} = 0.12$。临界值 = $6 \\times 0.005 = 0.03$。是否 $0.12 \\le 0.03$？否。\n- 对于 $k=5$：$p_{(5)} = 0.055$。临界值 = $5 \\times 0.005 = 0.025$。是否 $0.055 \\le 0.025$？否。\n- 对于 $k=4$：$p_{(4)} = 0.021$。临界值 = $4 \\times 0.005 = 0.02$。是否 $0.021 \\le 0.02$？否。\n- 对于 $k=3$：$p_{(3)} = 0.012$。临界值 = $3 \\times 0.005 = 0.015$。是否 $0.012 \\le 0.015$？是。\n\n由于当 $k=3$ 时条件满足，而当 $k=4$ 时条件不满足，因此满足条件的最大 $k$ 为 $k_{max}=3$。\n\n根据Benjamini-Hochberg程序，我们拒绝与3个最小p值相对应的原假设：$p_{(1)}=0.0008$，$p_{(2)}=0.0041$ 和 $p_{(3)}=0.012$。\n\n应被判断为MRD阳性的位点数量是 $k_{max}=3$。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}