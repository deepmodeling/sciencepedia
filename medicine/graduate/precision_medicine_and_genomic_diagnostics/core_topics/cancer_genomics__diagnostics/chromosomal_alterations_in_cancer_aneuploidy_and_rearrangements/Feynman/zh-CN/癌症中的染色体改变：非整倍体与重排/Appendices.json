{
    "hands_on_practices": [
        {
            "introduction": "在癌症基因组学中，一个核心挑战是如何解读来自肿瘤和正常细胞混合体的批量测序数据。本练习将指导您完成“解卷积”的基本过程——从观测到的混合信号中计算出真实的肿瘤特异性拷贝数。通过应用这些计算来定义和量化非整倍性和体细胞拷贝数变异（SCNA）负荷等指标，我们可以将原始数据转化为能够概括基因组不稳定性的、具有临床意义的总结性指标。",
            "id": "4322031",
            "problem": "在一个精准肿瘤学工作流程中，对单个实体瘤样本进行了一次批量全基因组测序分析。肿瘤细胞组分（纯度）估计为 $p = 0.7$。假设以下基本事实：\n- 在批量样本中，每个基因组片段观察到的绝对拷贝数来自于正常细胞（二倍体，拷贝数为 $2$）和肿瘤细胞贡献的线性混合。肿瘤的贡献由该片段的肿瘤平均拷贝数来体现，而正常细胞的贡献固定为 $2$。\n- 体细胞拷贝数变异 (Somatic Copy Number Alteration, SCNA) 定义为肿瘤平均拷贝数与二倍体状态 $2$ 的任何偏离。\n- 染色体臂水平的非整倍性指的是影响染色体臂大部分区域、且方向一致（增加或减少）的拷贝数不平衡。\n\n为集中计算，我们考虑的“目标基因组”仅由以下四个染色体臂组成，其长度和分段信息已给出。长度单位为百万碱基 (Mb)。对于每个片段，都提供了一个绝对批量拷贝数估计值，这是由肿瘤和正常细胞混合产生的可观察量。\n\n- 染色体臂 1p (长度 $120$ Mb):\n  - 片段 $[0, 60)$ Mb：观察到的绝对拷贝数为 $2.7$。\n  - 片段 $[60, 120)$ Mb：观察到的绝对拷贝数为 $2.0$。\n\n- 染色体臂 1q (长度 $150$ Mb):\n  - 片段 $[0, 120)$ Mb：观察到的绝对拷贝数为 $1.3$。\n  - 片段 $[120, 150)$ Mb：观察到的绝对拷贝数为 $2.0$。\n\n- 染色体臂 3p (长度 $100$ Mb):\n  - 片段 $[0, 40)$ Mb：观察到的绝对拷贝数为 $2.35$。\n  - 片段 $[40, 100)$ Mb：观察到的绝对拷贝数为 $2.0$。\n\n- 染色体臂 7q (长度 $160$ Mb):\n  - 片段 $[0, 160)$ Mb：观察到的绝对拷贝数为 $2.56$。\n\n仅使用上述基本混合原理，按以下步骤进行：\n\n1. 对每个片段，根据观察到的绝对拷贝数和纯度 $p$ 推导出肿瘤平均拷贝数，然后计算该片段的 SCNA 振幅，即肿瘤平均拷贝数与 $2$ 的绝对偏差。\n\n2. 定义一个“染色体臂水平非整倍性事件”：若某染色体臂上至少 $0.6$ 的长度显示出方向一致的 SCNA（如果肿瘤平均拷贝数 $> 2$ 则为增加，如果 $< 2$ 则为减少），并且在该方向一致部分上的平均绝对偏差至少为 $0.5$ 拷贝单位，则该事件存在。统计四个染色体臂上臂水平非整倍性事件的总数，得到 $N$。\n\n3. 将目标基因组上的 SCNA 负荷 $B$ 定义为振幅加权的基因组改变分数：\n   $$B \\equiv \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{\\text{tumor}} - 2|}{\\sum_{i} \\ell_{i}},$$\n   其中 $\\ell_{i}$ 是片段 $i$ 的长度，$C_{i}^{\\text{tumor}}$ 是片段 $i$ 的肿瘤平均拷贝数。\n\n4. 定义一个综合分数 $S \\equiv N + B$。\n\n计算所提供数据的 $S$ 值。将最终答案表示为一个纯数（无量纲）。将您的答案四舍五入到四位有效数字。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知条件\n\n*   肿瘤细胞组分（纯度）：$p = 0.7$。\n*   正常细胞为二倍体，拷贝数为 $2$。\n*   观察到的绝对拷贝数 ($C_{\\text{obs}}$) 是一个线性混合：$C_{\\text{obs}} = p \\cdot C_{\\text{tumor}} + (1-p) \\cdot 2$。\n*   体细胞拷贝数变异 (SCNA) 是肿瘤平均拷贝数 ($C_{\\text{tumor}}$) 与 $2$ 的任何偏离。\n*   如果至少 $0.6$ 的臂长显示出方向一致的 SCNA，并且该部分的平均绝对偏差至少为 $0.5$，则存在“臂水平非整倍性事件”。\n*   此类事件的总数为 $N$。\n*   SCNA 负荷为 $B \\equiv \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{\\text{tumor}} - 2|}{\\sum_{i} \\ell_{i}}$。\n*   综合分数为 $S \\equiv N + B$。\n*   四个染色体臂的数据：\n    *   染色体臂 1p (长度 $120$ Mb):\n        *   片段 $[0, 60)$ Mb：$C_{\\text{obs}} = 2.7$。\n        *   片段 $[60, 120)$ Mb：$C_{\\text{obs}} = 2.0$。\n    *   染色体臂 1q (长度 $150$ Mb):\n        *   片段 $[0, 120)$ Mb：$C_{\\text{obs}} = 1.3$。\n        *   片段 $[120, 150)$ Mb：$C_{\\text{obs}} = 2.0$。\n    *   染色体臂 3p (长度 $100$ Mb):\n        *   片段 $[0, 40)$ Mb：$C_{\\text{obs}} = 2.35$。\n        *   片段 $[40, 100)$ Mb：$C_{\\text{obs}} = 2.0$。\n    *   染色体臂 7q (长度 $160$ Mb):\n        *   片段 $[0, 160)$ Mb：$C_{\\text{obs}} = 2.56$。\n*   最终答案要求：计算 $S$ 并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n\n*   **科学依据：** 该问题使用了一个标准且被广泛接受的线性混合模型，用于将批量测序数据解构为肿瘤特异性拷贝数。这是癌症基因组学和精准医学中的一个基本概念。SCNA、非整倍性和 SCNA 负荷的定义与该领域的惯例一致。\n*   **良态问题：** 该问题提供了所有必要的数据（纯度、片段信息、定义）和一套清晰、顺序的计算步骤，以得出一个唯一且有意义的解。\n*   **客观性：** 该问题使用精确的定量语言陈述，没有歧义或主观论断。\n\n该问题不违反任何无效性标准。它在科学上是合理的，结构上是形式化的，内部是一致的，并且需要基于其前提进行多步骤的、不平凡的计算。\n\n### 步骤3：结论和行动\n\n该问题是有效的。我将继续进行解答。\n\n## 解答\n\n解题过程遵循题目中概述的四个步骤。\n\n### 步骤1：推导肿瘤平均拷贝数和 SCNA 振幅\n\n观察到的绝对拷贝数 $C_{\\text{obs}}$ 由线性混合模型给出：\n$$C_{\\text{obs}} = p \\cdot C_{\\text{tumor}} + (1-p) \\cdot C_{\\text{normal}}$$\n给定 $p = 0.7$ 和 $C_{\\text{normal}} = 2$，方程变为：\n$$C_{\\text{obs}} = 0.7 \\cdot C_{\\text{tumor}} + (1-0.7) \\cdot 2 = 0.7 \\cdot C_{\\text{tumor}} + 0.6$$\n整理方程以求解肿瘤平均拷贝数 $C_{\\text{tumor}}$，我们得到：\n$$C_{\\text{tumor}} = \\frac{C_{\\text{obs}} - 0.6}{0.7}$$\n每个片段的 SCNA 振幅定义为与二倍体状态的绝对偏差，即 $|C_{\\text{tumor}} - 2|$。我们为每个片段计算这些值。\n\n- **臂 1p，片段 $[0, 60)$ Mb**：$\\ell_1 = 60$ Mb, $C_{\\text{obs},1} = 2.7$。\n  $$C_{\\text{tumor},1} = \\frac{2.7 - 0.6}{0.7} = \\frac{2.1}{0.7} = 3$$\n  SCNA 振幅：$|3 - 2| = 1$。这是一个增加。\n\n- **臂 1p，片段 $[60, 120)$ Mb**：$\\ell_2 = 60$ Mb, $C_{\\text{obs},2} = 2.0$。\n  $$C_{\\text{tumor},2} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA 振幅：$|2 - 2| = 0$。这是二倍体。\n\n- **臂 1q，片段 $[0, 120)$ Mb**：$\\ell_3 = 120$ Mb, $C_{\\text{obs},3} = 1.3$。\n  $$C_{\\text{tumor},3} = \\frac{1.3 - 0.6}{0.7} = \\frac{0.7}{0.7} = 1$$\n  SCNA 振幅：$|1 - 2| = 1$。这是一个减少。\n\n- **臂 1q，片段 $[120, 150)$ Mb**：$\\ell_4 = 30$ Mb, $C_{\\text{obs},4} = 2.0$。\n  $$C_{\\text{tumor},4} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA 振幅：$|2 - 2| = 0$。这是二倍体。\n\n- **臂 3p，片段 $[0, 40)$ Mb**：$\\ell_5 = 40$ Mb, $C_{\\text{obs},5} = 2.35$。\n  $$C_{\\text{tumor},5} = \\frac{2.35 - 0.6}{0.7} = \\frac{1.75}{0.7} = 2.5$$\n  SCNA 振幅：$|2.5 - 2| = 0.5$。这是一个增加。\n\n- **臂 3p，片段 $[40, 100)$ Mb**：$\\ell_6 = 60$ Mb, $C_{\\text{obs},6} = 2.0$。\n  $$C_{\\text{tumor},6} = \\frac{2.0 - 0.6}{0.7} = \\frac{1.4}{0.7} = 2$$\n  SCNA 振幅：$|2 - 2| = 0$。这是二倍体。\n\n- **臂 7q，片段 $[0, 160)$ Mb**：$\\ell_7 = 160$ Mb, $C_{\\text{obs},7} = 2.56$。\n  $$C_{\\text{tumor},7} = \\frac{2.56 - 0.6}{0.7} = \\frac{1.96}{0.7} = 2.8$$\n  SCNA 振幅：$|2.8 - 2| = 0.8$。这是一个增加。\n\n### 步骤2：计算臂水平非整倍性事件数 ($N$)\n\n一个臂水平非整倍性事件要求至少 $0.6$ 的臂长具有一致的 SCNA 方向（增加或减少），且该区域的平均绝对偏差至少为 $0.5$。\n\n- **臂 1p (总长 $120$ Mb)**：有一个长度为 $60$ Mb 的片段发生增加。改变的臂长分数为 $\\frac{60}{120} = 0.5$。由于 $0.5 < 0.6$，臂 1p 不存在臂水平事件。\n\n- **臂 1q (总长 $150$ Mb)**：有一个长度为 $120$ Mb 的片段发生减少。改变的臂长分数为 $\\frac{120}{150} = 0.8$。由于 $0.8 \\ge 0.6$，第一个条件满足。这部分的平均绝对偏差是单个片段的振幅，即 $1$。由于 $1 \\ge 0.5$，第二个条件满足。因此，臂 1q 存在一个臂水平非整倍性事件。\n\n- **臂 3p (总长 $100$ Mb)**：有一个长度为 $40$ Mb 的片段发生增加。改变的臂长分数为 $\\frac{40}{100} = 0.4$。由于 $0.4 < 0.6$，臂 3p 不存在臂水平事件。\n\n- **臂 7q (总长 $160$ Mb)**：整个臂（长度 $160$ Mb）发生增加。改变的臂长分数为 $\\frac{160}{160} = 1.0$。由于 $1.0 \\ge 0.6$，第一个条件满足。平均绝对偏差是该片段的振幅，即 $0.8$。由于 $0.8 \\ge 0.5$，第二个条件满足。因此，臂 7q 存在一个臂水平非整倍性事件。\n\n臂水平非整倍性事件的总数是臂 1q 和 7q 上事件的总和。\n$$N = 1 + 1 = 2$$\n\n### 步骤3：计算 SCNA 负荷 ($B$)\n\nSCNA 负荷 $B$ 是振幅加权的基因组改变分数：\n$$B = \\frac{\\sum_{i} \\ell_{i} \\, |C_{i}^{\\text{tumor}} - 2|}{\\sum_{i} \\ell_{i}}$$\n分子是每个片段的长度与其 SCNA 振幅的乘积之和。我们只需对振幅不为零的片段求和。\n$$ \\text{分子} = (60 \\cdot 1) + (120 \\cdot 1) + (40 \\cdot 0.5) + (160 \\cdot 0.8) $$\n$$ \\text{分子} = 60 + 120 + 20 + 128 = 328 $$\n分母是所考虑基因组的总长度。\n$$ \\text{分母} = \\ell_{\\text{1p}} + \\ell_{\\text{1q}} + \\ell_{\\text{3p}} + \\ell_{\\text{7q}} = 120 + 150 + 100 + 160 = 530 $$\nSCNA 负荷为：\n$$B = \\frac{328}{530} \\approx 0.6188679...$$\n\n### 步骤4：计算综合分数 ($S$)\n\n综合分数 $S$ 定义为 $N + B$。\n$$ S = 2 + \\frac{328}{530} \\approx 2 + 0.6188679... = 2.6188679... $$\n题目要求将结果四舍五入到四位有效数字。前四位有效数字是 $2$、$6$、$1$ 和 $8$。第五位数字是 $8$，因此我们将第四位数字向上取整。\n$$ S \\approx 2.619 $$",
            "answer": "$$\n\\boxed{2.619}\n$$"
        },
        {
            "introduction": "本练习在前一个实践的基础上，聚焦于等位基因不平衡——染色体变异的一个关键方面。本练习介绍了一种强大的统计方法——贝叶斯因子（Bayes factor），用以区分杂合位点上不同的生物学情景，例如杂合性保留与拷贝数中性的杂合性丢失（LOH）。这个实践展示了概率模型如何为那些仅从拷贝数分析中不易察觉的特定基因组事件提供量化证据。",
            "id": "4322015",
            "problem": "通过高深度靶向测序对来自一名患者的肿瘤样本进行分析，分析位点是一个种系杂合的单核苷酸多态性（SNP），其等位基因表示为 $A$ 和 $B$。肿瘤纯度（定义为样本中癌细胞占有核细胞的比例）为 $p = 0.70$。考虑癌细胞中该基因座的两个竞争模型：\n\n- 模型 $\\mathcal{M}_0$（无杂合性丢失）：癌细胞在该基因座上是二体的且为杂合型 $A/B$。在非癌细胞（比例为 $1-p$）中，基因型也为 $A/B$。\n\n- 模型 $\\mathcal{M}_1$（通过有丝分裂重组导致的拷贝数中性杂合性丢失）：由于有丝分裂重组产生单亲二体性，癌细胞在该基因座上是二体的但为纯合型；它们是 $A/A$ 或 $B/B$ 的先验概率相等。在非癌细胞（比例为 $1-p$）中，基因型为 $A/B$。\n\n假设测序读数是独立同分布的伯努利试验，其成功概率等于细胞混合物中 $B$ 等位基因的真实潜在比例，并且不存在等位基因作图偏倚或超出二项式采样的过度离散。在该 SNP 位点，总共获得 $N = 100$ 个读数，其中 $k = 20$ 个报告为 $B$ 等位基因。\n\n假设模型 $\\mathcal{M}_0$ 和 $\\mathcal{M}_1$ 的先验概率相等，计算支持模型 $\\mathcal{M}_1$ 相对于 $\\mathcal{M}_0$ 的贝叶斯因子 $K$ 的以 10 为底的对数，其中 $K$ 定义为在 $\\mathcal{M}_1$ 和 $\\mathcal{M}_0$ 下观测数据的边际似然比。将您的答案四舍五入到四位有效数字。以无单位的纯数字形式表达您的答案。",
            "solution": "问题要求计算贝叶斯因子 $K$ 的以10为底的对数，该因子用于比较肿瘤在特定基因座上遗传状态的两种模型。贝叶斯因子是在每个模型下观测数据的边际似然之比。\n\n首先，我们为似然计算建立框架。数据 $D$ 包括在总共 $N=100$ 个测序读数中观察到 $k=20$ 个 $B$ 等位基因读数。问题陈述测序读数是独立同分布的伯努利试验。这意味着，给定测序 DNA 池中 $B$ 等位基因的真实比例 $\\theta$，$B$ 等位基因读数 $k$ 的数量遵循二项分布。在 $N$ 次试验中观察到 $k$ 次成功的概率质量函数 (PMF) 由下式给出：\n$$P(k|\\theta, N) = \\binom{N}{k} \\theta^k (1-\\theta)^{N-k}$$\n\n$B$ 等位基因的期望比例 $\\theta$ 取决于所考虑的模型。样本中的总 DNA 是来自癌细胞（比例为 $p$）和非癌细胞（比例为 $1-p$）的 DNA 混合物。总体等位基因比例 $\\theta$ 是这两个细胞群体中比例的加权平均值。所有非癌细胞都是种系杂合的 $A/B$ 型，因此该群体中 $B$ 等位基因的比例是 $0.5$。\n\n我们分别分析每个模型。\n\n**模型 $\\mathcal{M}_0$：无杂合性丢失**\n在此模型下，癌细胞保留其杂合 $A/B$ 基因型。\n- 癌细胞中 $B$ 等位基因的比例：$0.5$。\n- 非癌细胞中 $B$ 等位基因的比例：$0.5$。\n\n$B$ 等位基因的总体比例 $\\theta_0$ 为：\n$$\\theta_0 = p \\times (0.5) + (1-p) \\times (0.5) = 0.5p + 0.5 - 0.5p = 0.5$$\n模型 $\\mathcal{M}_0$ 下数据的似然是在给定 $\\theta_0 = 0.5$ 的条件下观察到 $k$ 个 $B$ 等位基因读数的概率：\n$$P(D|\\mathcal{M}_0) = P(k=20 | \\theta_0=0.5, N=100) = \\binom{100}{20} (0.5)^{20} (1-0.5)^{100-20} = \\binom{100}{20} (0.5)^{100}$$\n\n**模型 $\\mathcal{M}_1$：拷贝数中性杂合性丢失**\n该模型是两个子模型的混合体，我们将其表示为 $\\mathcal{M}_{1,A/A}$（癌细胞为纯合 $A/A$）和 $\\mathcal{M}_{1,B/B}$（癌细胞为纯合 $B/B$）。问题陈述它们具有相等的先验概率，$P(\\mathcal{M}_{1,A/A}|\\mathcal{M}_1) = P(\\mathcal{M}_{1,B/B}|\\mathcal{M}_1) = 0.5$。\n\n$\\mathcal{M}_1$ 的边际似然使用全概率定律计算：\n$$P(D|\\mathcal{M}_1) = P(D|\\mathcal{M}_{1,A/A})P(\\mathcal{M}_{1,A/A}|\\mathcal{M}_1) + P(D|\\mathcal{M}_{1,B/B})P(\\mathcal{M}_{1,B/B}|\\mathcal{M}_1)$$\n$$P(D|\\mathcal{M}_1) = 0.5 \\times P(D|\\mathcal{M}_{1,A/A}) + 0.5 \\times P(D|\\mathcal{M}_{1,B/B})$$\n\n我们需要计算每个子模型的似然。\n- **子模型 $\\mathcal{M}_{1,A/A}$**：癌细胞为 $A/A$。\n  - 癌细胞中 $B$ 等位基因的比例：$0$。\n  - 非癌细胞中 $B$ 等位基因的比例：$0.5$。\n  - $B$ 等位基因的总体比例 $\\theta_{1,A/A}$ 为：\n    $$\\theta_{1,A/A} = p \\times (0) + (1-p) \\times (0.5) = 0.5(1-p)$$\n  - 此子模型的似然为：\n    $$P(D|\\mathcal{M}_{1,A/A}) = \\binom{N}{k} (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k}$$\n\n- **子模型 $\\mathcal{M}_{1,B/B}$**：癌细胞为 $B/B$。\n  - 癌细胞中 $B$ 等位基因的比例：$1$。\n  - 非癌细胞中 $B$ 等位基因的比例：$0.5$。\n  - $B$ 等位基因的总体比例 $\\theta_{1,B/B}$ 为：\n    $$\\theta_{1,B/B} = p \\times (1) + (1-p) \\times (0.5) = p + 0.5 - 0.5p = 0.5(1+p)$$\n  - 此子模型的似然为：\n    $$P(D|\\mathcal{M}_{1,B/B}) = \\binom{N}{k} (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k}$$\n\n综合这些，$\\mathcal{M}_1$ 的边际似然为：\n$$P(D|\\mathcal{M}_1) = 0.5 \\binom{N}{k} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]$$\n\n现在我们可以计算支持 $\\mathcal{M}_1$ 相对于 $\\mathcal{M}_0$ 的贝叶斯因子 $K$：\n$$K = \\frac{P(D|\\mathcal{M}_1)}{P(D|\\mathcal{M}_0)} = \\frac{0.5 \\binom{N}{k} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]}{\\binom{N}{k} (0.5)^N}$$\n组合项 $\\binom{N}{k}$ 被约去：\n$$K = \\frac{0.5 \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]}{(0.5)^N} = 2^{N-1} \\left[ (\\theta_{1,A/A})^k (1-\\theta_{1,A/A})^{N-k} + (\\theta_{1,B/B})^k (1-\\theta_{1,B/B})^{N-k} \\right]$$\n\n我们代入给定的数值：$p = 0.70$，$N=100$，以及 $k=20$。\n首先，计算模型 $\\mathcal{M}_1$ 的等位基因比例：\n$$\\theta_{1,A/A} = 0.5(1-0.70) = 0.5(0.30) = 0.15$$\n$$1 - \\theta_{1,A/A} = 1 - 0.15 = 0.85$$\n$$\\theta_{1,B/B} = 0.5(1+0.70) = 0.5(1.70) = 0.85$$\n$$1 - \\theta_{1,B/B} = 1 - 0.85 = 0.15$$\n将这些代入 $K$ 的表达式中：\n$$K = 2^{100-1} \\left[ (0.15)^{20} (0.85)^{100-20} + (0.85)^{20} (0.15)^{100-20} \\right]$$\n$$K = 2^{99} \\left[ (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right]$$\n\n最后一步是计算 $K$ 的以 10 为底的对数：\n$$\\log_{10}(K) = \\log_{10}\\left(2^{99} \\left[ (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right]\\right)$$\n使用对数的性质：\n$$\\log_{10}(K) = 99 \\log_{10}(2) + \\log_{10}\\left( (0.15)^{20} (0.85)^{80} + (0.85)^{20} (0.15)^{80} \\right)$$\n让我们分别计算和中的两项。\n令 $T_1 = (0.15)^{20} (0.85)^{80}$ 且 $T_2 = (0.85)^{20} (0.15)^{80}$。\n$$\\log_{10}(T_1) = 20 \\log_{10}(0.15) + 80 \\log_{10}(0.85)$$\n$$\\log_{10}(T_2) = 20 \\log_{10}(0.85) + 80 \\log_{10}(0.15)$$\n使用标准值 $\\log_{10}(0.15) \\approx -0.8239$ 和 $\\log_{10}(0.85) \\approx -0.07058$：\n$$\\log_{10}(T_1) \\approx 20(-0.8239) + 80(-0.07058) = -16.478 - 5.6464 = -22.1244$$\n$$\\log_{10}(T_2) \\approx 20(-0.07058) + 80(-0.8239) = -1.4116 - 65.912 = -67.3236$$\n由于 $\\log_{10}(T_2)$ 比 $\\log_{10}(T_1)$ 负得多，因此 $T_2$ 比 $T_1$ 小很多个数量级。所以，和 $T_1 + T_2 \\approx T_1$。我们可以将其形式化：\n$$T_1 + T_2 = T_1 \\left(1 + \\frac{T_2}{T_1}\\right)$$\n$$\\log_{10}(T_1 + T_2) = \\log_{10}(T_1) + \\log_{10}\\left(1 + \\frac{T_2}{T_1}\\right)$$\n比值 $\\frac{T_2}{T_1} = \\frac{10^{-67.3236}}{10^{-22.1244}} = 10^{-45.1992}$，这是一个极度接近于零的数。项 $\\log_{10}(1 + 10^{-45.1992})$ 是无穷小的，可以安全地忽略。\n因此，$\\log_{10}(T_1+T_2) \\approx \\log_{10}(T_1)$。\n\n现在，我们计算 $\\log_{10}(K)$：\n$$\\log_{10}(K) \\approx 99 \\log_{10}(2) + \\log_{10}(T_1)$$\n$$\\log_{10}(K) \\approx 99 \\log_{10}(2) + 20 \\log_{10}(0.15) + 80 \\log_{10}(0.85)$$\n使用更高精度的值：\n$\\log_{10}(2) \\approx 0.3010300$\n$\\log_{10}(0.15) \\approx -0.8239087$\n$\\log_{10}(0.85) \\approx -0.0705811$\n$$\\log_{10}(K) \\approx 99(0.3010300) + 20(-0.8239087) + 80(-0.0705811)$$\n$$\\log_{10}(K) \\approx 29.80197 - 16.478174 - 5.646488$$\n$$\\log_{10}(K) \\approx 7.677308$$\n将结果四舍五入到四位有效数字，得到 $7.677$。",
            "answer": "$$\\boxed{7.677}$$"
        },
        {
            "introduction": "现在，我们将视角从片段级别的变化扩展到重排后癌症基因组的整体结构。本练习介绍了断点图（Breakpoint Graph），这是一种来自计算生物学的强大理论工具，用于建模和比较复杂的基因组重排。通过构建此图并分析其结构，您将计算两个基因组之间的“重排距离”，从而为区分它们的进化路径提供一个量化度量。这项实践有助于深入理解癌症中染色体进化的大尺度动态。",
            "id": "4321983",
            "problem": "考虑两个癌症基因组，它们表示为由有向基因片段组成的环状染色体集合。每个基因片段由一个整数标签 $g \\in \\{1,2,\\dots,n\\}$ 表示，并带有一个表示方向的符号：正向 $+g$ 意味着在按染色体顺序读取时，该片段从其尾端 $g_t$ 延伸到其头端 $g_h$；而负向 $-g$ 意味着在按染色体顺序读取时，该片段从其头端 $g_h$ 延伸到其尾端 $g_t$。环状染色体是一个有符号整数的循环列表，其中连续片段之间的邻接关系在末端回绕到起始。\n\n断点图（Breakpoint Graph）的构建方法如下。构建一个顶点集，包含任一基因组中存在的所有基因的全部基因末端 $\\{g_t,g_h\\}$。对于每个基因组，在末端之间添加带颜色的邻接边。对于环状染色体中的两个连续有符号片段 $x$ 和 $y$，邻接边定义为连接 $x$ 的右末端和 $y$ 的左末端的无序对，其中左、右末端的定义如下：\n- 如果 $x=+g$，则 $\\text{left}(x)=g_t$ 且 $\\text{right}(x)=g_h$。\n- 如果 $x=-g$，则 $\\text{left}(x)=g_h$ 且 $\\text{right}(x)=g_t$。\n对 $y$ 的定义也类似。对于环状染色体，还需添加连接最后一个片段的右末端和第一个片段的左末端的邻接关系。将第一个基因组的邻接边着为黑色，第二个基因组的邻接边着为灰色。最终在末端上得到的这个双色图就是断点图。在此图中，如果两个基因组包含相同的基因标签集，则每个顶点的度数恰好为 $2$（一条黑色和一条灰色的入射边）。\n\n在双断裂并连接（DCJ）模型下，这是对包括倒位、易位和其他双断裂事件在内的基因组重排的一种经过充分检验的抽象，将一个环状基因组转换为另一个所需的最少双断裂操作次数可以从断点图的基本属性中推导出来。具体来说，对于具有相同基因内容的环状基因组，最少操作次数是断点图中由黑灰边交替形成的环的数量的函数。\n\n您的任务是实现一个程序，为每个提供的测试用例，构建这对癌症基因组的断点图，并计算将第一个基因组转换为第二个基因组所需的最少双断裂操作次数。假设每个测试用例中的两个基因组都具有相同的基因内容，并且完全由环状染色体组成。\n\n定义和要求：\n- 令 $n$ 表示在给定测试用例的基因组对中存在的不同基因标签（绝对值）的总数。\n- 使用上述规则构建断点图。\n- 通过交替遍历黑色和灰色边，将图分解为不相交的环。\n- 令 $c$ 表示该测试用例中断点图的环数。\n- 使用环数和基因总数，计算所需的最少双断裂操作次数（一个整数）。\n\n测试套件：\n对于每个测试用例，两个基因组以环状染色体列表的形式给出，其中每个染色体本身是一个有符号整数列表。四个测试用例是：\n\n1. 基因组 A：一个环状染色体 $[1,-2,3,4]$；基因组 B：一个环状染色体 $[-2,1,4,3]$。\n2. 基因组 A：一个环状染色体 $[1,2,3,4,5]$；基因组 B：一个环状染色体 $[1,2,3,4,5]$。\n3. 基因组 A：一个环状染色体 $[1,2,3,4,5,6]$；基因组 B：一个环状染色体 $[4,-5,6,-1,2,-3]$。\n4. 基因组 A：一个环状染色体 $[1,-2,-3,4,-5,6]$；基因组 B：一个环状染色体 $[-1,2,-3,-4,5,-6]$。\n\n答案规范：\n- 对于每个测试用例，输出一个等于所需最少双断裂操作次数的整数。\n- 将所有测试用例的结果汇总到一行，形式为一个用方括号括起来的逗号分隔列表，例如 $[a,b,c,d]$，其中 $a$、$b$、$c$ 和 $d$ 是整数。\n\n不涉及物理单位、角度单位或百分比。程序必须以指定格式精确地产生一行输出。",
            "solution": "该问题要求计算将一个癌症基因组转换为另一个所需的最少双断裂并连接（DCJ）操作次数。两个基因组都由具有相同基因内容的环状染色体组成。这个距离可以通过一种称为断点图的结构来计算。\n\n首先，我们为基因组的组成部分建立一个形式化表示。一个带有标签 $g$ 的基因有两个末端：一个尾端 $g_t$ 和一个头端 $g_h$。我们可以将这些末端映射到一对唯一的整数。对于一个基因标签 $g \\in \\{1, 2, \\dots, n\\}$，我们定义映射：\n$$\ng_t \\mapsto 2g - 1\n$$\n$$\ng_h \\mapsto 2g\n$$\n我们图中的所有顶点集合将是整数集合 $\\{1, 2, \\dots, 2n\\}$。基因片段的方向决定了其末端的顺序。一个片段 $+g$ 从 $g_t$ 延伸到 $g_h$，而一个片段 $-g$ 从 $g_h$ 延伸到 $g_t$。我们可以如下定义一个有符号基因片段 $x$ 的左末端和右末端：\n- 如果 $x = +g$，则 $\\text{left}(x) = g_t \\mapsto 2g-1$ 且 $\\text{right}(x) = g_h \\mapsto 2g$。\n- 如果 $x = -g$，则 $\\text{left}(x) = g_h \\mapsto 2g$ 且 $\\text{right}(x) = g_t \\mapsto 2g-1$。\n\n断点图是在这 $2n$ 个顶点的集合上构建的。对于每个基因组，我们添加邻接边。在一个环状染色体中，对于任意两个连续的基因片段 $x$ 和 $y$，在 $x$ 的右末端和 $y$ 的左末端之间形成一个邻接关系。这也适用于最后一个和第一个片段，从而形成一个环。来自第一个基因组（基因组 A）的邻接关系被着为黑色，来自第二个基因组（基因组 B）的邻接关系被着为灰色。\n\n由于两个基因组都包含相同的 $n$ 个基因，每个末端顶点都将恰好有一条黑色边和一条灰色边与其相连。因此，整个断点图会分解为一组不相交的环，其中边的颜色交替出现（黑、灰、黑、灰...）。\n\n对于仅由具有相同基因内容的环状染色体组成的两个基因组 A 和 B，其 DCJ 距离，记为 $d_{DCJ}(A, B)$，由以下公式给出：\n$$\nd_{DCJ}(A, B) = n - c\n$$\n其中 $n$ 是基因的数量，$c$ 是断点图中黑灰交替环的数量。\n\n我们的任务是为每个测试用例计算 $c$。一种计算这些环的稳健方法是在顶点集上定义一个置换。令 $\\text{adj}_A(v)$ 是通过黑边与 $v$ 连接的顶点，$\\text{adj}_B(v)$ 是通过灰边与 $v$ 连接的顶点。从顶点 $v$ 开始，在交替环中的“一步”首先沿着一条黑边到达 $\\text{adj}_A(v)$，然后沿着一条灰边到达 $\\text{adj}_B(\\text{adj}_A(v))$。我们可以通过遍历交替的黑灰边来直接计算环的数量。\n\n算法流程如下：\n1.  对于每对基因组，确定唯一基因的总数 $n$。\n2.  根据给定的染色体结构，构建邻接映射 $\\text{adj}_A$ 和 $\\text{adj}_B$。这包括遍历每个染色体，识别连续的基因片段，并根据规则在它们对应的末端顶点之间添加边。\n3.  通过遍历所有顶点来计算交替环的数量 $c$。遍历从 $1$ 到 $2n$ 的所有顶点。如果一个顶点尚未被访问，就从它开始进行遍历，交替沿着黑边和灰边前进（例如，从 $v$ 到 $\\text{adj}_A(v)$，再到 $\\text{adj}_B(\\text{adj}_A(v))$，依此类推），直到返回起点，并将所发现环中的所有顶点标记为已访问。每发现一个新环，就增加一个环计数器。\n4.  使用公式 $d = n - c$ 计算最终距离。\n\n此过程应用于所提供的四个测试用例中的每一个。\n1.  对于案例 1，$n=4$。构建邻接关系并遍历，发现有 $c=2$ 个环。距离为 $4-2=2$。\n2.  对于案例 2，基因组是相同的。$n=5$。邻接关系完全相同，因此断点图有 $c=n=5$ 个环。距离为 $5-5=0$。\n3.  对于案例 3，$n=6$。构建图并计算环，得到 $c=3$ 个环。距离为 $6-3=3$。\n4.  对于案例 4，$n=6$。构建图并计算环，得到 $c=2$ 个环。距离为 $6-2=4$。",
            "answer": "[2,0,3,4]"
        }
    ]
}