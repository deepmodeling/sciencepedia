{
    "hands_on_practices": [
        {
            "introduction": "在任何像生殖系基因编辑这样影响深远的新医疗技术应用于人类之前，我们必须为其临床前安全性设立严格的标准。此练习  演示了如何利用贝叶斯统计学将审慎原则形式化，使我们能够量化我们对于有害脱靶效应风险低于可接受阈值的信心。它将“充分证据”这一抽象概念，转化为一个具体的、可计算的成功实验次数。",
            "id": "4337748",
            "problem": "一个计划进行首次人体种系基因组编辑的研究联合体，旨在建立一个基于贝叶斯决策的临床前证据阈值，以遵循生物医学伦理中的不伤害原则和预防原则。定义每次标准化编辑导致严重脱靶基因组改变的概率为 $p \\in [0,1]$。首次人体试验的伦理安全性被操作化定义为 $p \\leq \\theta$，其中 $\\theta = 0.01$。在任何人体应用之前，该联合体规定，安全性的贝叶斯后验概率 $\\Pr(p \\leq \\theta \\mid \\text{data})$ 必须超过 $0.95$。\n\n假设临床前编辑在一个经过验证的高保真体外模型中进行，并且：\n- 每次编辑都是一次独立的伯努利试验，发生严重脱靶事件的概率为 $p$，该事件若发生在人体内将具有临床意义。\n- 根据方案，可以无错误地检测到严重脱靶事件。\n- $p$ 的先验分布为 $\\text{Beta}(\\alpha_{0}, \\beta_{0})$，其中 $\\alpha_{0} = 1$ 且 $\\beta_{0} = 1$，以反映在 $[0,1]$ 上的先验无知。\n\n设 $n$ 为进行的独立临床前编辑次数，$k$ 为观察到的严重脱靶事件次数。根据伦理策略，进入首次人体试验要求 $\\Pr(p \\leq \\theta \\mid k, n) > 0.95$。假设临床前项目进行至未观察到严重脱靶事件，即 $k = 0$。请从基本原理出发，推导满足策略标准（对于 $\\theta = 0.01$）的最小整数 $n$，并以单个数字报告该最小 $n$ 值。除了选择达到标准的最小整数外，不需要进行其他舍入。答案无单位。",
            "solution": "问题要求确定在未观察到任何严重脱靶事件（$k=0$）的情况下，为满足特定的伦理安全标准而必须进行的独立临床前编辑的最小次数 $n$。该标准是在贝叶斯统计框架内制定的。\n\n### 第1步：问题构建与模型设定\n问题将严重脱靶事件的未知概率定义为 $p$。数据生成过程是一系列 $n$ 次独立的伯努利试验，每次试验产生脱靶事件的概率为 $p$。在 $n$ 次试验中观察到的事件数 $k$ 服从二项分布，其似然函数为：\n$$ L(p \\mid k, n) = \\binom{n}{k} p^k (1-p)^{n-k} $$\n关于参数 $p$ 的先验信念由贝塔分布 $p \\sim \\text{Beta}(\\alpha_0, \\beta_0)$ 建模。先验分布的概率密度函数（PDF）为：\n$$ f(p; \\alpha_0, \\beta_0) = \\frac{p^{\\alpha_0-1}(1-p)^{\\beta_0-1}}{B(\\alpha_0, \\beta_0)} $$\n其中 $B(\\alpha_0, \\beta_0)$ 是贝塔函数。给定的先验参数为 $\\alpha_0=1$ 和 $\\beta_0=1$，这对应于区间 $[0,1]$ 上的均匀分布，表示关于 $p$ 的最大先验不确定性。\n\n### 第2步：后验分布的推导\n贝塔分布是伯努利/二项似然的共轭先验。这意味着在给定数据 $(k, n)$ 的情况下，$p$ 的后验分布也是一个贝塔分布。后验概率密度函数正比于先验概率密度函数与似然函数的乘积：\n$$ f(p \\mid k, n) \\propto L(p \\mid k, n) \\times f(p; \\alpha_0, \\beta_0) $$\n$$ f(p \\mid k, n) \\propto p^k (1-p)^{n-k} \\times p^{\\alpha_0-1}(1-p)^{\\beta_0-1} $$\n$$ f(p \\mid k, n) \\propto p^{\\alpha_0+k-1} (1-p)^{\\beta_0+n-k-1} $$\n这是一个贝塔分布的核，其更新后的参数为 $\\alpha_{\\text{post}} = \\alpha_0 + k$ 和 $\\beta_{\\text{post}} = \\beta_0 + n - k$。因此，后验分布为：\n$$ p \\mid k,n \\sim \\text{Beta}(\\alpha_0 + k, \\beta_0 + n - k) $$\n问题明确指出没有观察到严重脱靶事件，因此 $k=0$。代入给定的值 $\\alpha_0=1$，$\\beta_0=1$ 和 $k=0$，后验参数变为：\n$$ \\alpha_{\\text{post}} = 1 + 0 = 1 $$\n$$ \\beta_{\\text{post}} = 1 + n - 0 = n + 1 $$\n因此，$p$ 的后验分布为 $p \\mid k=0, n \\sim \\text{Beta}(1, n+1)$。\n\n### 第3步：应用伦理策略标准\n伦理策略要求安全性的后验概率，定义为 $p \\leq \\theta$，必须大于 $0.95$。安全阈值给定为 $\\theta = 0.01$。用数学形式表示，此条件为：\n$$ \\Pr(p \\leq \\theta \\mid k=0, n) > 0.95 $$\n这个概率是后验分布 $\\text{Beta}(1, n+1)$ 在 $p=\\theta$ 处的累积分布函数（CDF）。贝塔分布 $\\text{Beta}(\\alpha, \\beta)$ 的CDF由以下积分给出：\n$$ F(x; \\alpha, \\beta) = \\int_0^x \\frac{t^{\\alpha-1}(1-t)^{\\beta-1}}{B(\\alpha, \\beta)} dt $$\n对于我们的后验分布 $\\text{Beta}(1, n+1)$ 和阈值 $\\theta=0.01$，这变为：\n$$ \\Pr(p \\leq 0.01 \\mid k=0, n) = \\int_0^{0.01} \\frac{t^{1-1}(1-t)^{(n+1)-1}}{B(1, n+1)} dt = \\frac{1}{B(1, n+1)} \\int_0^{0.01} (1-t)^n dt $$\n首先，我们计算贝塔函数 $B(1, n+1) = \\frac{\\Gamma(1)\\Gamma(n+1)}{\\Gamma(1+n+1)} = \\frac{0! \\cdot n!}{(n+1)!} = \\frac{1}{n+1}$，其中 $\\Gamma$ 是伽马函数。\n接着，我们计算积分：\n$$ \\int_0^{0.01} (1-t)^n dt = \\left[ -\\frac{(1-t)^{n+1}}{n+1} \\right]_0^{0.01} = \\left(-\\frac{(1-0.01)^{n+1}}{n+1}\\right) - \\left(-\\frac{(1-0)^{n+1}}{n+1}\\right) = \\frac{1 - (0.99)^{n+1}}{n+1} $$\n结合这些结果，后验概率为：\n$$ \\Pr(p \\leq 0.01 \\mid k=0, n) = (n+1) \\times \\left( \\frac{1 - (0.99)^{n+1}}{n+1} \\right) = 1 - (0.99)^{n+1} $$\n\n### 第4步：求解最小编辑次数 n\n我们必须找到满足从策略标准推导出的不等式的最小整数 $n$：\n$$ 1 - (0.99)^{n+1} > 0.95 $$\n整理不等式：\n$$ 0.05 > (0.99)^{n+1} $$\n为了解出 $n$，我们对不等式两边取自然对数。由于自然对数是严格递增函数，不等号的方向保持不变。\n$$ \\ln(0.05) > \\ln\\left((0.99)^{n+1}\\right) $$\n$$ \\ln(0.05) > (n+1) \\ln(0.99) $$\n$\\ln(0.99)$ 的值为负，因为其参数小于1。因此，两边同时除以 $\\ln(0.99)$ 会使不等号反向：\n$$ \\frac{\\ln(0.05)}{\\ln(0.99)}  n+1 $$\n解出 $n$：\n$$ n > \\frac{\\ln(0.05)}{\\ln(0.99)} - 1 $$\n现在，我们计算右侧的数值：\n$$ \\frac{\\ln(0.05)}{\\ln(0.99)} \\approx \\frac{-2.99573}{-0.01005} \\approx 298.08 $$\n所以不等式变为：\n$$ n > 298.08 - 1 $$\n$$ n > 297.08 $$\n由于 $n$ 必须是代表编辑次数的整数，满足此条件的最小整数 $n$ 为 $298$。\n这意味着，为了满足该联合体进入首次人体试验的伦理标准，必须进行至少298次临床前编辑，且未观察到任何严重脱靶事件。",
            "answer": "$$\\boxed{298}$$"
        },
        {
            "introduction": "一旦某项技术被认为足够安全，可以进行人体试验，伦理学家和临床医生就必须权衡其在每个具体应用中的预期危害和收益。此练习  介绍了一种量化比例性原则的方法，使用期望值计算来比较治疗效益与严重副作用的风险。这种框架虽然基于假设的数值，但阐明了伦理委员会可能用来确保干预措施的潜在回报不会被其风险所压倒的结构化推理过程。",
            "id": "4337772",
            "problem": "一个临床伦理委员会正在评估一项旨在避免一种高外显率、早发性单基因疾病的人类生殖系基因组编辑方案的可允许性。在该委员会针对精准医疗和基因组诊断学的决策框架中，弱预防原则通过一项基于期望值推理的相称性测试来操作化：合理可预见的严重伤害的期望负价值必须与期望的治疗效益相称。具体而言，委员会将相称性解释为要求严重脱靶效应的期望负价值不超过期望效益的一个分数 $\\lambda$，其中 $\\lambda \\in (0,1]$ 是一个反映弱预防原则严格程度的政策参数。\n\n假设以下经过伦理量化的参数，以可通约的伦理效用单位表示：每个胚胎发生严重脱靶事件的估计概率为 $p=0.01$，此类严重伤害的负价值大小为 $M=100$，以及为经过编辑的胚胎预防目标疾病的期望治疗效益为 $B=4$。一项政策草案提出了一个弱预防相称性阈值为 $\\lambda_{w}=0.20$。\n\n仅使用所述的期望值和相称性的核心定义，推导在给定 $p$、$M$ 和 $B$ 的情况下，能使干预措施在弱预防测试下满足相称性的最小相称性系数 $\\lambda_{\\min}$。将 $\\lambda_{\\min}$ 的数值以无量纲比率的形式报告，四舍五入到四位有效数字。在最终的方框答案中不要包含任何单位。",
            "solution": "问题的核心在于将委员会的相称性测试转化为数学表达式，并求解所需的参数。\n\n首先，我们必须计算严重脱靶效应的期望负价值。一个事件的期望值是其概率乘以其价值或负价值。设 $D$ 代表期望负价值。\n严重脱靶事件的概率给定为 $p$。\n此类事件的负价值大小给定为 $M$。\n因此，期望负价值为：\n$$D = p \\times M$$\n\n期望的治疗效益直接给定为 $B$。\n\n如上所述，相称性测试要求期望负价值 $D$ 不超过期望效益 $B$ 的一个分数 $\\lambda$。这可以表示为以下不等式：\n$$D \\le \\lambda B$$\n\n代入 $D$ 的表达式，我们得到：\n$$pM \\le \\lambda B$$\n\n问题要求的是能使干预措施满足相称性的最小相称性系数 $\\lambda_{\\min}$。这意味着我们正在寻找使该不等式成立的最小 $\\lambda$ 值。使干预措施满足相称性的所有 $\\lambda$ 值的集合可以通过整理不等式得到：\n$$\\lambda \\ge \\frac{pM}{B}$$\n\n该集合中的最小值 $\\lambda_{\\min}$ 是不等式边界上的值，即等式成立时：\n$$\\lambda_{\\min} = \\frac{pM}{B}$$\n\n现在，我们将给定的数值代入此表达式。已知条件是 $p=0.01$，$M=100$ 和 $B=4$。\n$$\\lambda_{\\min} = \\frac{0.01 \\times 100}{4}$$\n$$\\lambda_{\\min} = \\frac{1}{4}$$\n$$\\lambda_{\\min} = 0.25$$\n\n问题要求报告的数值需四舍五入到四位有效数字。确切值为 $0.25$。为了以四位有效数字的精度表示，我们在后面追加零。\n$$\\lambda_{\\min} = 0.2500$$\n\n这个值 $\\lambda_{\\min}=0.2500$ 是在指定框架下，干预措施被认为相称时，相称性参数 $\\lambda$ 的最小阈值。政策草案提议 $\\lambda_{w}=0.20$ 这一背景信息值得注意，因为我们计算出的最小要求值大于提议值（$0.2500 > 0.20$）。这意味着，在提议的政策下，这项特定的干预措施将被视为不成比例和不可允许的。这证实了该概念框架的一致性。",
            "answer": "$$\\boxed{0.2500}$$"
        },
        {
            "introduction": "生殖系编辑的伦理考量远远超出了个体范畴，因为任何改变都可能遗传给后代，从而可能改变人类基因库。这最后一个练习  将我们的视角从诊所转向整个群体，利用群体遗传学原理来模拟一个广泛的编辑项目将如何随时间改变有害等位基因的频率。通过计算实现公共卫生目标所需的干预率，我们可以开始探讨其长期的社会影响，以及公共卫生与优生学之间的复杂界限。",
            "id": "4337737",
            "problem": "某卫生部门正在考虑一个遗传干预项目，在该项目中，对携带单一、常染色体、有害等位基因风险的胚胎使用基因组诊断技术进行筛查，并且对携带该等位基因的胚胎中一个恒定比例$\\,\\alpha\\,$的胚胎进行种系基因组编辑，从而完美地将有害等位基因转化为野生型等位基因，且不产生嵌合现象。假设一个非常大的随机交配群体，没有迁移，没有出生后选择，且连锁可以忽略不计。设$\\,q_t\\,$表示在第$\\,t\\,$代胚胎筛查前，群体中有害等位基因的频率。设$\\,\\mu\\,$表示每一代中，作用于野生型等位基因、由野生型等位基因向有害等位基因的新生突变率，该突变发生在第$\\,t\\,$代和第$\\,t+1\\,$代之间。假设在编辑前能完美检测出携带者胚胎，并且编辑一旦应用，能完全纠正这些胚胎中的有害等位基因。\n\n仅从群体遗传学的基本原理出发（随机交配意味着等位基因被随机抽样，在没有其他因素作用下，等位基因频率在各代之间保持不变；每一代新生突变会将比例为$\\,\\mu\\,$的野生型等位基因转化为有害等位基因；编辑会降低实际被编辑胚胎中有害等位基因的频率），首先推导出关于$\\,q_t\\,$, $\\,\\alpha\\,$ 和 $\\,\\mu\\,$的$\\,q_{t+1}\\,$的一阶线性递推关系式。\n\n鉴于在实现公共卫生目标的同时，需要最小化干预强度的伦理承诺，假设在实施的时间尺度上突变率可以忽略不计，因此在规划时设定$\\,\\mu=0\\,$。该部门设定了一个可衡量的目标，即在恰好$\\,T\\,$个不重叠的世代内，将有害等位基因的频率从初始值$\\,q_0\\,$降低到至多为$\\,q_f\\,$，其中$\\,0  q_f  q_0$。推导出为达到此目标所需的最小恒定比例$\\alpha$，用$\\,q_0, q_f\\,$和$\\,T\\,$表示。将最终表达式放在一个方框中。",
            "solution": "该问题要求两个结果：首先，有害等位基因频率的一般递推关系；其次，在简化条件下达到特定目标所需的最小干预水平$\\alpha$。\n\n第一部分：$q_{t+1}$递推关系的推导\n\n设$q_t$为第$t$代群体中，胚胎筛查前有害等位基因（我们称之为$A$）的频率。野生型等位基因（$a$）的频率为$p_t = 1 - q_t$。假设群体由于随机交配而处于哈迪-温伯格平衡状态，受精时的基因型频率为：\n- 有害纯合子（$AA$）：$f(AA) = q_t^2$\n- 杂合子（$Aa$）：$f(Aa) = 2p_t q_t$\n- 野生型纯合子（$aa$）：$f(aa) = p_t^2$\n\n干预措施包括对“携带该等位基因的胚胎”中的一个恒定比例$\\alpha$进行编辑。这些胚胎指的是$AA$和$Aa$基因型。我们将其解释为，任何特定的携带者胚胎有$\\alpha$的概率被选中进行编辑，如果被选中，编辑过程会将其所有的$A$等位基因完美地转化为$a$等位基因。\n\n让我们计算一下此编辑步骤后的基因型频率。\n比例为$\\alpha$的$AA$胚胎被编辑，变为$aa$。剩余的比例，$1-\\alpha$，保持为$AA$。$AA$的新频率，记作$f'(AA)$，为：\n$$f'(AA) = (1-\\alpha) f(AA) = (1-\\alpha)q_t^2$$\n类似地，比例为$\\alpha$的$Aa$胚胎被编辑。由于编辑是完美的，它们也变为$aa$。剩余的比例，$1-\\alpha$，保持为$Aa$。$Aa$的新频率，记作$f'(Aa)$，为：\n$$f'(Aa) = (1-\\alpha) f(Aa) = (1-\\alpha)2p_t q_t$$\n原始的$aa$胚胎不受影响。由$AA$和$Aa$转化而来的胚胎被加入到这个池中。$aa$的新频率，$f'(aa)$，为：\n$$f'(aa) = f(aa) + \\alpha f(AA) + \\alpha f(Aa) = p_t^2 + \\alpha q_t^2 + \\alpha 2p_t q_t$$\n新频率的总和为$f'(AA) + f'(Aa) + f'(aa) = (1-\\alpha)q_t^2 + (1-\\alpha)2p_t q_t + p_t^2 + \\alpha q_t^2 + \\alpha 2p_t q_t = q_t^2 + 2p_t q_t + p_t^2 = (q_t+p_t)^2 = 1^2 = 1$，这证实了计算是一致的。\n\n现在，我们来计算编辑后有害等位基因$A$的即时频率，我们称之为$q_t'$。这是根据新的基因型频率计算得出的：\n$$q_t' = f'(AA) + \\frac{1}{2}f'(Aa)$$\n$$q_t' = (1-\\alpha)q_t^2 + \\frac{1}{2}(1-\\alpha)2p_t q_t$$\n$$q_t' = (1-\\alpha)q_t^2 + (1-\\alpha)p_t q_t$$\n提取公因式$(1-\\alpha)$和$q_t$：\n$$q_t' = (1-\\alpha)q_t (q_t + p_t)$$\n由于$q_t + p_t = 1$，这可以简化为：\n$$q_t' = (1-\\alpha)q_t$$\n这是一个线性关系，正如问题陈述所提示的。编辑后野生型等位基因的频率是$p_t' = 1 - q_t' = 1 - (1-\\alpha)q_t$。\n\n第二个过程是新生突变，它以$\\mu$的速率从野生型等位基因$a$突变为有害等位基因$A$。这发生在编辑后的等位基因库中，在下一代的等位基因频率建立之前。第$t+1$代中等位基因$A$的频率，记作$q_{t+1}$，是在编辑后存活下来的有害等位基因与由野生型等位基因突变产生的新有害等位基因之和。\n$$q_{t+1} = q_t' + \\mu p_t'$$\n代入$q_t'$和$p_t'$的表达式：\n$$q_{t+1} = (1-\\alpha)q_t + \\mu (1 - (1-\\alpha)q_t)$$\n$$q_{t+1} = (1-\\alpha)q_t + \\mu - \\mu(1-\\alpha)q_t$$\n合并含有$q_t$的项：\n$$q_{t+1} = [(1-\\alpha) - \\mu(1-\\alpha)]q_t + \\mu$$\n$$q_{t+1} = (1-\\alpha)(1-\\mu)q_t + \\mu$$\n这就是所求的$q_{t+1}$的一阶线性递推关系式。\n\n第二部分：最小干预比例$\\alpha$的确定\n\n对于问题的第二部分，我们被要求将突变率设为零，即$\\mu=0$。递推关系式大大简化：\n$$q_{t+1} = (1-\\alpha)(1-0)q_t + 0$$\n$$q_{t+1} = (1-\\alpha)q_t$$\n这是一个标准的几何衰减模型。通过迭代应用该递推关系，我们可以用初始频率$q_0$来表示任何一代$t$的等位基因频率：\n$$q_1 = (1-\\alpha)q_0$$\n$$q_2 = (1-\\alpha)q_1 = (1-\\alpha)^2 q_0$$\n根据归纳法，第$T$代的频率为：\n$$q_T = (1-\\alpha)^T q_0$$\n公共卫生目标是在恰好$T$个世代内将等位基因频率从$q_0$降低到至多为$q_f$。这转化为数学条件：\n$$q_T \\leq q_f$$\n代入我们关于$q_T$的表达式：\n$$(1-\\alpha)^T q_0 \\leq q_f$$\n我们必须求解$\\alpha$。由于$q_0 > 0$，我们可以两边同除以$q_0$：\n$$(1-\\alpha)^T \\leq \\frac{q_f}{q_0}$$\n给定$T \\in \\mathbb{N}$（$T \\geq 1$），且$0 \\leq \\alpha \\leq 1$和$0  q_f  q_0$，不等式两边均为正。我们可以对两边取$T$次根，而不改变不等号的方向：\n$$1-\\alpha \\leq \\left(\\frac{q_f}{q_0}\\right)^{\\frac{1}{T}}$$\n现在，我们分离出$\\alpha$：\n$$-\\alpha \\leq \\left(\\frac{q_f}{q_0}\\right)^{\\frac{1}{T}} - 1$$\n两边同乘以$-1$会使不等号反向：\n$$\\alpha \\geq 1 - \\left(\\frac{q_f}{q_0}\\right)^{\\frac{1}{T}}$$\n问题要求的是能达到目标的最小恒定比例$\\alpha$。当等式成立时，达到这个最小值。任何更小的$\\alpha$值都将导致$q_T > q_f$，从而无法达到目标。因此，$\\alpha$的精确最小值为：\n$$\\alpha = 1 - \\left(\\frac{q_f}{q_0}\\right)^{\\frac{1}{T}}$$\n该表达式是用给定的参数$q_0$，$q_f$和$T$来表示的。",
            "answer": "$$\n\\boxed{1 - \\left(\\frac{q_f}{q_0}\\right)^{\\frac{1}{T}}}\n$$"
        }
    ]
}