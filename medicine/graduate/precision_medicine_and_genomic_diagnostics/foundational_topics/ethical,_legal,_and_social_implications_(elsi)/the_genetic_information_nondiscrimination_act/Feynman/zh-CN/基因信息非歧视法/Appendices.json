{
    "hands_on_practices": [
        {
            "introduction": "在应用《遗传信息非歧视法案》(GINA) 时，首要且关键的一步是准确识别哪些信息属于其法律保护的范畴。这项实践将挑战您将 GINA 的具体法律定义应用于一个包含不同类型健康和个人数据的真实世界场景中。通过区分遗传测试结果、家族病史和常规临床指标，您将锻炼在实际合规工作中进行法律解释和风险评估的核心技能 。",
            "id": "4486137",
            "problem": "一家雇主的健康计划供应商提供了一个关于员工个人的混合数据集，其中包括：(i) 通过分析基于唾液的脱氧核糖核酸（DNA）得出的直接面向消费者的血统百分比结果，(ii) 一级亲属乳腺癌的自我报告家族史，以及 (iii) 用于糖尿病筛查和监测的糖化血红蛋白 $\\text{HbA}_{1\\text{c}}$ (HbA1c) 值。雇主的合规团队必须确定哪些元素构成《遗传信息非歧视法案》（GINA）下的“遗传信息”，从基本原则出发证明该确定，并制定修订步骤以避免雇主不被允许地获取遗传信息。\n\n从在此背景下指导分析的法定核心定义（GINA下“遗传信息”和“遗传测试”的定义）出发，选择最准确地识别哪些元素是“遗传信息”，根据这些定义解释原因，并提出针对雇佣情境的法律上合理的修订步骤的选项。\n\nA. 血统百分比结果和乳腺癌家族史都是“遗传信息”，而 $\\text{HbA}_{1\\text{c}}$ 值不是；血统结果是个人遗传测试的产物，而家族史是“家族成员中疾病或失调的体现”。$\\text{HbA}_{1\\text{c}}$ 虽然是与蛋白质相关的实验室值，但不检测基因型、突变或染色体变化，因此在GINA下不属于“遗传测试”。修订步骤：指示供应商和任何健康计划合作伙伴不要向雇主传输血统百分比输出或家族病史；在所有请求中包含GINA“安全港”语言；如果需要，仅要求汇总的、去身份识别的非遗传健康指标；隔离并清除任何无意中收到的遗传信息；培训员工并配置系统以阻止接收遗传信息。\n\nB. 所有三项都是“遗传信息”，因为GINA包括对蛋白质或代谢物的分析，因此 $\\text{HbA}_{1\\text{c}}$ 与血统和家族史一样计算在内；因此，雇主必须从传输给雇主的任何数据集中修订血统百分比、家族史和 $\\text{HbA}_{1\\text{c}}$，并且只能接收完全去身份识别的、没有个人级别值的人群摘要。\n\nC. 这些都不是“遗传 information”，因为血统百分比反映的是族裔而非疾病风险，家族史是传记性的，而 $\\text{HbA}_{1\\text{c}}$ 是常规医疗值；因此，无需进行修订，雇主可以为健康合规目的请求、要求或购买所有三类信息。\n\nD. 只有乳腺癌家族史是“遗传信息”；血统百分比不被涵盖，因为它们不报告突变或疾病，而 $\\text{HbA}_{1\\text{c}}$ 是常规临床测试。修订步骤：仅阻止家族病史，允许雇主接收和使用血统百分比输出和 $\\text{HbA}_{1\\text{c}}$。\n\nE. 血统百分比和 $\\text{HbA}_{1\\text{c}}$ 是“遗传信息”，而家族史仅受健康隐私规则管辖；修订步骤：删除血统和 $\\text{HbA}_{1\\text{c}}$，保留家族史用于休假管理和健康计划资格确定，并通知员工家族史可能用于雇佣决策。",
            "solution": "该问题要求分析三种类型的员工数据——(i) 直接面向消费者的血统百分比，(ii) 自我报告的乳腺癌家族史，以及 (iii) 糖化血红蛋白 $\\text{HbA}_{1\\text{c}}$ (HbA1c) 值——以确定哪些构成美国《遗传信息非歧视法案》（GINA）下的“遗传信息”，并为雇主提出适当的修订步骤。该分析必须基于“遗传信息”和“遗传测试”的法定定义。\n\n### 步骤1：验证问题陈述\n\n**已知条件：**\n1.  **数据项：** 一个混合数据集，包含：\n    *   (i) 通过分析基于唾液的脱氧核糖核酸（DNA）得出的直接面向消费者的血统百分比结果。\n    *   (ii) 一级亲属乳腺癌的自我报告家族史。\n    *   (iii) 用于糖尿病筛查和监测的糖化血红蛋白 $\\text{HbA}_{1\\text{c}}$ (HbA1c) 值。\n2.  **背景：** 数据由雇主的健康计划供应商持有。雇主的合规团队需要管理这些数据。\n3.  **任务：**\n    *   根据GINA确定哪些数据项是“遗传信息”。\n    *   使用GINA的核心定义（“遗传信息”和“遗传测试”）来证明该确定。\n    *   提出修订步骤以确保雇主合规。\n\n**验证：**\n1.  **科学和法律依据：** 该问题基于一部具体的、现实世界中的美国联邦法规，即2008年的《遗传信息非歧视法案》。所描述的数据类型（基于DNA的血统、家族病史和 $\\text{HbA}_{1\\text{c}}$）是常见的健康和个人数据形式。该场景为雇主提出了一个现实的合规挑战。其法律和科学前提是合理的。\n2.  **定义明确：** 该问题定义明确。它要求将特定的法律定义应用于一组事实，以得出关于法律地位和所需行动的结论。这种结构允许基于已确立的法律原则得出一个唯一、正确且有意义的解决方案。\n3.  **客观性：** 该问题以精确、客观且不带偏见的语言陈述。它描述了一个事实场景，并要求进行基于原则的法律分析。\n\n**结论：** 问题陈述有效。它在科学和法律上是合理的，定义明确且客观。我将继续进行解答。\n\n### 步骤2：从基本原则推导\n\n为解决此问题，我们必须将GINA及其执行法规（例如，《联邦法规汇编》第29篇第1635部分）中的核心定义应用于这三种数据元素中的每一种。\n\n**基本原则：GINA定义**\n\n1.  **遗传信息（《联邦法规汇编》第29篇第1635.3(c)条）**：术语“遗传信息”指关于以下内容的信息：\n    *   个人的遗传测试。\n    *   该个人家族成员的遗传测试。\n    *   该个人家族成员中疾病或失调的体现（即家族病史）。\n\n2.  **遗传测试（《联邦法规汇编》第29篇第1635.3(f)条）**：术语“遗传测试”指对人类DNA、RNA、染色体、蛋白质或代谢物的分析，以检测基因型、遗传变异或染色体变化。\n    *   **法规排除条款**：法规明确指出，“遗传测试”**不**包括“与已表现出的疾病、失调或病理状况直接相关的蛋白质或代谢物分析，且该状况可被医疗保健专业人员合理检测到”。\n\n**数据元素分析：**\n\n*   **(i) 来自DNA分析的直接面向消费者的血统百分比结果：**\n    *   这些结果是“人类DNA分析”的产物。此分析检测遗传变异（例如，单核苷酸多态性，或SNPs）以推断血统。\n    *   这完全符合“遗传测试”的定义。测试的目的（血统 vs. 健康）与该定义无关。\n    *   因此，血统百分比结果是个人“遗传测试”的产物，并构成GINA下的**“遗传信息”**。\n\n*   **(ii) 自我报告的乳腺癌家族史：**\n    *   这是关于“家族成员中疾病或失調[乳腺癌]的体现”的信息。\n    *   这完全符合“遗传信息”定义的第三部分。\n    *   因此，乳腺癌家族史是GINA下的**“遗传信息”**。\n\n*   **(iii) 糖化血红蛋白 $\\text{HbA}_{1\\text{c}}$ (HbA1c) 值：**\n    *   $\\text{HbA}_{1\\text{c}}$ 测试测量糖化血红蛋白的量，这是一种蛋白质。因此，它是“蛋白质分析”。\n    *   然而，该测试用于糖尿病筛查和监测。糖尿病是一种“已表现出的疾病、失调或病理状况”。测试结果（$\\text{HbA}_{1\\text{c}}$ 水平）与这种已表现的状况“直接相关”。\n    *   因此，$\\text{HbA}_{1\\text{c}}$ 测试属于法规排除条款的范围。出于GINA的目的，它**不**被视为“遗传测试”。\n    *   因此，$\\text{HbA}_{1\\text{c}}$ 值**不是**GINA下的“遗传信息”。然而，它是受其他法律（如HIPAA）保护的健康信息（PHI）。\n\n**总结与所需行动：**\n*   **遗传信息：** 血统结果和家族史。\n*   **非遗传信息：** $\\text{HbA}_{1\\text{c}}$ 值。\n\n根据GINA第二章，雇主被禁止请求、要求或购买关于雇员或雇员家属的遗传信息。为遵守规定，雇主必须确保不获取血统结果或家族史。\n\n**法律上合理的修订/合规步骤：**\n1.  **预防：** 主要策略是防止接收该信息。这涉及在合同上和操作上指示健康计划供应商不要向雇主传输任何被识别为“遗传信息”的数据。\n2.  **安全港：** 所有对健康信息的请求（例如，来自健康计划的请求）都应包含GINA“安全港”语言，该语言明确警告提供者不要共享遗传信息。\n3.  **数据最小化：** 如果收到任何个人数据，应严格限制为非遗传信息（例如，$\\text{HbA}_{1\\text{c}}$ 值，如果在健康计划规则下是允许的）。汇总和去身份识别的数据是更安全的选择。\n4.  **补救措施：** 如果无意中收到遗传信息，必须将其隔离，如果可能则清除，并且不得用于任何与雇佣相关的目的。必须培训员工处理此类情况，并配置系统以防止接收。\n\n### 步骤3：逐项分析选项\n\n**A. 血统百分比结果和乳腺癌家族史都是“遗传信息”，而 $\\text{HbA}_{1\\text{c}}$ 值不是；血统结果是个人遗传测试的产物，而家族史是“家族成员中疾病或失调的体现”。$\\text{HbA}_{1\\text{c}}$ 虽然是与蛋白质相关的实验室值，但不检测基因型、突变或染色体变化，因此在GINA下不属于“遗传测试”。修订步骤：指示供应商和任何健康计划合作伙伴不要向雇主传输血统百分比输出或家族病史；在所有请求中包含GINA“安全港”语言；如果需要，仅要求汇总的、去身份识别的非遗传健康指标；隔离并清除任何无意中收到的遗传信息；培训员工并配置系统以阻止接收遗传信息。**\n*   **分析：** 此选项正确地识别出血统结果和家族史是遗传信息，而 $\\text{HbA}_{1\\text{c}}$ 不是。其理由是正确的：血统结果来自遗传测试，而家族史是家族成员中疾病的体现。关于 $\\text{HbA}_{1\\text{c}}$ 的推理在技术上也是正确的，因为该测试测量的是与代谢状态相关的蛋白质浓度，而不是基因型。所提议的修订和合规步骤全面且在法律上是合理的，涵盖了预防、安全港、数据最小化和补救措施。\n*   **结论：** 正确。\n\n**B. 所有三项都是“遗传信息”，因为GINA包括对蛋白质或代谢物的分析，因此 $\\text{HbA}_{1\\text{c}}$ 与血统和家族史一样计算在内；因此，雇主必须从传输给雇主的任何数据集中修订血统百分比、家族史和 $\\text{HbA}_{1\\text{c}}$，并且只能接收完全去身份识别的、没有个人级别值的人群摘要。**\n*   **分析：** 此选项不正确，因为它错误地将 $\\text{HbA}_{1\\text{c}}$ 归类为遗传信息。它依赖于“蛋白质分析”的措辞，但未能应用与已表现疾病相关的测试的关键法规排除条款。\n*   **结论：** 不正确。\n\n**C. 这些都不是“遗传 information”，因为血统百分比反映的是族裔而非疾病风险，家族史是传记性的，而 $\\text{HbA}_{1\\text{c}}$ 是常规医疗值；因此，无需进行修订，雇主可以为健康合规目的请求、要求或购买所有三类信息。**\n*   **分析：** 此选项存在根本性缺陷。它误解了GINA的范围。“遗传测试”的定义不受目的（例如，疾病风险）的限制。“家族史”被明确定义为遗传信息。允许雇主“请求、要求或购买”这些信息将直接导致违反GINA。\n*   **结论：** 不正确。\n\n**D. 只有乳腺癌家族史是“遗传信息”；血统百分比不被涵盖，因为它们不报告突变或疾病，而 $\\text{HbA}_{1\\text{c}}$ 是常规临床测试。修订步骤：仅阻止家族病史，允许雇主接收和使用血统百分比输出和 $\\text{HbA}_{1\\text{c}}$。**\n*   **分析：** 此选项错误地将血统结果排除在遗传信息的定义之外。无论其目的如何，DNA分析都是一种遗传测试。允许雇主接收血统输出将是违反GINA的行为。\n*   **结论：** 不正确。\n\n**E. 血统百分比和 $\\text{HbA}_{1\\text{c}}$ 是“遗传信息”，而家族史仅受健康隐私规则管辖；修订步骤：删除血统和 $\\text{HbA}_{1\\text{c}}$，保留家族史用于休假管理和健康计划资格确定，并通知员工家族史可能用于雇佣决策。**\n*   **分析：** 此选项在多个方面都是不正确的。它错误地包含了 $\\text{HbA}_{1\\text{c}}$，并错误地将家族史从GINA的定义中排除。家族史是GINA下“遗传信息”的核心组成部分。提议“保留家族史”并将其“用于”雇佣决策的行动，是对GINA非歧视条款的公然且严重的违反行为。\n*   **结论：** 不正确。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "理解 GINA 的立法动机，对于深刻把握其精神至关重要，尤其是在健康保险领域。本练习将引导您构建一个概率模型，来量化保险公司通过使用遗传信息进行承保所能获得的财务优势。这项实践通过计算精算风险差异，清晰地揭示了遗传歧视背后的经济驱动力，并凸显了 GINA 在平衡精算公平与社会公平方面所扮演的关键角色 。",
            "id": "4390608",
            "problem": "一个健康计划考虑一个为期一年的灾难性临床事件，用事件 $E$ 表示。如果该事件发生，将产生 $C$ 美元的成本，否则成本为 $0$。该计划考虑使用基因型 $G \\in \\{1,0\\}$ 进行承保，其中 $G=1$ 表示携带与事件 $E$ 风险升高相关的遗传变异。假设在独立同分布抽取的受保人群中，以下条件成立：\n- 风险基因型的普遍率为 $P(G=1)=q$ 且 $P(G=0)=1-q$。\n- 事件风险为 $P(E \\mid G=1)=p_{1}$ 和 $P(E \\mid G=0)=p_{0}$，其中 $p_{1} > p_{0}$。\n- 如果事件 $E$ 发生，计划的成本为 $C$，否则为 $0$。\n\n为具体起见，取 $q=0.10$，$p_{1}=0.40$，$p_{0}=0.05$，$C=100{,}000$。\n\n将计划的预期损失定义为从该人群中抽取的每位潜在申请人的预期索赔成本。在遵守《遗传信息非歧视法案》(GINA) 的情况下，该计划不得在承保中使用遗传信息，因此会招收整个人群，而不以 $G$ 为条件。在一个假设的违规情景中，计划被允许使用 $P(E \\mid G)$ 基于遗传信息进行承保，假设它排除了所有 $G=1$ 的申请人（从而只招收 $G=0$ 的申请人）。\n\n仅使用基本概率定义（例如，期望和全概率定律），推导并计算每位潜在申请人的预期损失差异，定义为\n$$\\Delta L \\equiv \\text{(不使用遗传信息的预期损失)} - \\text{(基于 }G\\text{ 进行承保的预期损失)}$$\n以美元表示最终的预期损失差异。不要对答案进行四舍五入。\n\n然后，依据《遗传信息非歧视法案》(GINA) 的法定基准，简要解释为什么在健康保险承保中禁止利用任何基于 $P(E \\mid G)$ 的精算差异，即使这样做会减少 $\\Delta L$。",
            "solution": "所述问题具有科学依据，提法恰当且客观。它提出了一个来自精算科学和群体遗传学的标准（尽管简化了的）模型。所有必要的数据和定义都已提供，并且没有内部矛盾。因此，我们可以着手求解。\n\n设随机变量 $X$ 表示健康计划为单个潜在申请人承担的成本。问题陈述 $X = C$ 如果灾难性事件 $E$ 发生，否则 $X = 0$。该计划的每位潜在申请人的预期损失是该成本的期望值 $E[X]$。根据期望值的定义：\n$$E[X] = C \\cdot P(E) + 0 \\cdot P(\\text{非 } E) = C \\cdot P(E)$$\n问题的核心是在两种不同的承保情景下计算 $P(E)$。\n\n我们已知以下数值：\n- 事件成本，$C = \\$100,000$。\n- 风险基因型的普遍率，$P(G=1) = q = 0.10$。\n- 非风险基因型的普遍率，$P(G=0) = 1-q = 0.90$。\n- 给定风险基因型下事件的条件概率，$P(E \\mid G=1) = p_{1} = 0.40$。\n- 给定非风险基因型下事件的条件概率，$P(E \\mid G=0) = p_{0} = 0.05$。\n\n首先，我们计算不使用遗传信息时的预期损失，这对应于遵守 GINA 的情景。在这种情况下，计划招收所有潜在申请人。人群中事件 $E$ 的总概率必须使用全概率定律，以基因型 $G$ 为条件进行计算：\n$$P(E) = P(E \\mid G=1)P(G=1) + P(E \\mid G=0)P(G=0)$$\n代入符号变量：\n$$P(E) = p_{1}q + p_{0}(1-q)$$\n因此，在这种情景下的预期损失，我们记为 $L_{\\text{GINA}}$，是：\n$$L_{\\text{GINA}} = C \\cdot P(E) = C(p_{1}q + p_{0}(1-q))$$\n使用给定的数值：\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.40 \\cdot 0.10 + 0.05 \\cdot (1-0.10))$$\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.04 + 0.05 \\cdot 0.90)$$\n$$L_{\\text{GINA}} = 100,000 \\cdot (0.04 + 0.045)$$\n$$L_{\\text{GINA}} = 100,000 \\cdot 0.085 = 8,500$$\n因此，在 GINA 下，每位潜在申请人的预期损失为 $\\$8,500$。\n\n接下来，我们计算在假设的违规情景中，计划基于遗传信息进行承保时的预期损失。计划排除了所有 $G=1$ 的申请人，只招收 $G=0$ 的申请人。预期损失被定义为“每位潜在申请人”的损失，这意味着总预期成本是在整个原始人群中平均的，而不仅仅是在被招收的子群体中。\n基因型为 $G=1$ 的个体占人群的比例为 $q$，他们不被招收。因此，他们对计划成本的贡献为 $\\$0$。\n基因型为 $G=0$ 的个体占人群的比例为 $1-q$，他们被招收。对于这个子群体，事件 $E$ 的概率是 $p_0$。来自该群体的预期成本，在整个人群中平均后，为 $C \\cdot p_{0} \\cdot P(G=0) = C p_{0} (1-q)$。\n在此承保情景下的总预期损失，我们记为 $L_{\\text{underwriting}}$，是来自两个群体的预期成本之和：\n$$L_{\\text{underwriting}} = (\\text{来自 } G=1 \\text{ 组的成本}) + (\\text{来自 } G=0 \\text{ 组的成本})$$\n$$L_{\\text{underwriting}} = 0 + C \\cdot p_{0}(1-q) = C p_{0}(1-q)$$\n使用给定的数值：\n$$L_{\\text{underwriting}} = 100,000 \\cdot 0.05 \\cdot (1-0.10)$$\n$$L_{\\text{underwriting}} = 100,000 \\cdot 0.05 \\cdot 0.90$$\n$$L_{\\text{underwriting}} = 5,000 \\cdot 0.90 = 4,500$$\n因此，通过遗传信息承保，每位潜在申请人的预期损失为 $\\$4,500$。\n\n最后，我们计算预期损失差异 $\\Delta L$：\n$$\\Delta L = L_{\\text{GINA}} - L_{\\text{underwriting}}$$\n用符号表示：\n$$\\Delta L = C(p_{1}q + p_{0}(1-q)) - C p_{0}(1-q)$$\n$$\\Delta L = C p_{1}q$$\n这个结果是直观的：预期损失的减少恰好来自于排除了高风险群体 ($G=1$)，因此差异等于该群体的预期损失贡献 ($C \\cdot P(E \\text{ 与 } G=1) = C \\cdot P(E|G=1)P(G=1) = C p_1 q$)。\n使用数值计算：\n$$\\Delta L = 8,500 - 4,500 = 4,000$$\n或者，使用符号公式：\n$$\\Delta L = 100,000 \\cdot 0.40 \\cdot 0.10 = 100,000 \\cdot 0.04 = 4,000$$\n每位潜在申请人的预期损失差异为 $\\$4,000$。\n\n问题的第二部分要求解释禁止这种做法的法律规定。$2008$ 年的《遗传信息非歧视法案》(GINA) 是一项美国联邦法律，它确立了防止基于遗传信息的歧视的法律基准。GINA 的第一章专门适用于健康保险。它禁止团体健康计划和健康保险公司将个人的遗传信息（例如本问题中基因型 $G$ 的状态）用于承保目的。这包括有关资格、承保范围以及保费或缴费金额的决定。假设的情景中，计划拒绝招收 $G=1$ 的个体，这直接且明确地违反了这项法律禁令。该法律是作为一项公共政策颁布的，旨在促进人们在不担心遭受保险公司或雇主报复的情况下，获得基因检测和个性化医疗。它反映了一项社会共识，即获得健康保障的权利不应取决于个人的遗传倾向，因此，它凌驾于任何纯粹的精算或财务动机之上，例如此处计算出的 $\\Delta L$，这些动机可能会驱使计划进行歧视。",
            "answer": "$$\\boxed{4000}$$"
        },
        {
            "introduction": "在人工智能和机器学习时代，歧视行为可能不再是直接的，而是通过与受保护信息相关的“代理”变量，以更隐蔽的方式发生。这项前沿实践将向您介绍一种基于信息论的先进审计方法，用于检测预测模型中是否存在此类隐藏的依赖关系。掌握这种复杂的量化技术，将使您能够确保现代诊断工具不仅遵守 GINA 的字面规定，更能贯彻其禁止歧视的根本精神 。",
            "id": "4390560",
            "problem": "您的任务是为精准医疗和基因组诊断领域中的一个预测性诊断模型，构建并实施一个基于《遗传信息非歧视法案》(GINA) 的原则性审计框架。该审计必须使用信息论度量和从第一性原理出发的假设检验，来量化模型的输入特征是否充当了遗传信息的代理，然后根据数学定义的阈值来判定其合规性。\n\n背景框架：《遗传信息非歧-视法案》(GINA) 禁止在某些决策环境中使用遗传信息。为审计模型的特征是否存在对遗传信息的违禁依赖，您将使用信息论的核心定义和经典的独立性统计检验，来形式化一个信息量度量和一个合规性阈值。\n\n使用的基本定义：\n- 设遗传变量为一个离散随机变量 $G$，其取值于一个有限集合；设特征 $F$ 为一个离散随机变量，其取值于一个有限集合。审计将评估每个特征 $F$ 相对于 $G$ 的情况。\n- $F$ 和 $G$ 之间的香农互信息 (MI) 定义为\n$$\nI(F;G) \\equiv \\sum_{f} \\sum_{g} p_{F,G}(f,g) \\log\\left(\\frac{p_{F,G}(f,g)}{p_{F}(f)\\,p_{G}(g)}\\right),\n$$\n其中 $p_{F,G}(f,g)$ 表示联合概率质量函数，$p_{F}(f)$ 和 $p_{G}(g)$ 表示边缘概率。所有对数均为自然对数，因此 $I(F;G)$ 的单位是奈特 (nats)。\n- 给定一个大小为 $n$ 的数据集，其中包含观测对 $(f_i,g_i)$，$i=1,\\dots,n$，您将使用从计数中获得的经验分布来计算插件估计值 $\\hat{I}(F;G)$。\n\n从一个经过充分检验的统计事实中推导出的合规性阈值：\n- 为检验两个离散变量之间的独立性，似然比统计量渐近服从卡方分布。具体来说，在独立性零假设下，统计量 $2n\\,\\hat{I}(F;G)$ 在分布上收敛于一个卡方分布，其自由度等于 $(|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$，其中 $|\\mathcal{F}|$ 是 $F$ 的不同类别数，而 $|\\mathcal{G}|$ 是 $G$ 的不同类别数。\n- 使用此渐近结果，在选定的显著性水平 $0  \\alpha  1$ 下定义一个合规性阈值。对于自由度 $d \\equiv (|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$，令 $q_{1-\\alpha}(d)$ 表示自由度为 $d$ 的卡方分布的 $(1-\\alpha)$ 分位数。审计判定一个特征 $F$ 是合规的，如果其经验互信息满足 $\\hat{I}(F;G) \\le \\tau_{\\alpha}$，其中 $\\tau_{\\alpha}$ 是在水平 $\\alpha$ 下从独立性检验推导出的阈值；否则判定为不合规。如果 $d=0$（例如，一个常数特征），则认为该特征是合规的，因为它不可能携带关于 $G$ 的信息。\n\n算法要求：\n- 对于每个测试用例，使用经验计数为每个特征计算 $\\hat{I}(F;G)$。\n- 对于每个特征，计算自由度 $d$ 和由显著性水平为 $\\alpha$ 的卡方独立性检验所隐含的阈值 $\\tau_{\\alpha}$。\n- 如果 $\\hat{I}(F;G)  \\tau_{\\alpha}$ 且 $d0$，则该特征不合规，否则为合规。\n- 对于每个测试用例，输出该测试用例中所有特征里不合规特征的整数计数。\n\n数据规格和测试套件：\n- 所有变量都是离散且无单位的。不涉及物理单位或角度单位。不应输出百分比；分数和概率隐含在经验计算中。\n\n您必须完全按照下述规格实现以下四个测试用例。在每个案例中，构建 $G$ 和特征的数组，以使指定的联合结构成立。每个案例中的特征表示为 $F^{(1)},F^{(2)},F^{(3)}$，并且审计是针对每个 $F^{(j)}$ 相对于 $G$ 独立执行的。\n\n测试用例 1（理想情况；完全独立和一个常数特征）：\n- 样本量 $n=120$。\n- 遗传变量 $G$ 是二元的，包含 $60$ 个 $0$ 的实例，后跟 $60$ 个 $1$ 的实例。\n- 特征 $F^{(1)}$ 是二元的，且与 $G$ 完全独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n30  30\\\\\n30  30\n\\end{array}\\right],\n$$\n意即有 $30$ 个 $(F^{(1)}=0,G=0)$ 的实例，$30$ 个 $(F^{(1)}=0,G=1)$ 的实例，$30$ 个 $(F^{(1)}=1,G=0)$ 的实例，以及 $30$ 个 $(F^{(1)}=1,G=1)$ 的实例。\n- 特征 $F^{(2)}$ 是常数，对于所有 $120$ 个样本其值均为 $0$。\n- 特征 $F^{(3)}$ 是三元的，且与 $G$ 完全独立，其在 $(F^{(3)},G)$ 的 $3\\times 2$ 网格上的联合计数为\n$$\n\\left[\\begin{array}{cc}\n20  20\\\\\n20  20\\\\\n20  20\n\\end{array}\\right]。\n$$\n- 显著性水平 $\\alpha=0.05$。\n\n测试用例 2（强代理使用）：\n- 样本量 $n=100$。\n- 遗传变量 $G$ 是二元的，包含 $50$ 个 $0$ 的实例，后跟 $50$ 个 $1$ 的实例。\n- 特征 $F^{(1)}$ 是一个完美代理：对于所有 $100$ 个样本，$F^{(1)}=G$。\n- 特征 $F^{(2)}$ 是一个近乎完美的代理：首先对于所有样本，令 $F^{(2)}=G$，然后翻转 $F^{(2)}$ 的前 $5$ 个条目（将 $0$ 变为 $1$，将 $1$ 变为 $0$）。\n- 特征 $F^{(3)}$ 是二元的，且与 $G$ 完全独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n25  25\\\\\n25  25\n\\end{array}\\right]。\n$$\n- 显著性水平 $\\alpha=0.01$。\n\n测试用例 3（临界微弱依赖；应为合规）：\n- 样本量 $n=50$。\n- 遗传变量 $G$ 是二元的，包含 $25$ 个 $0$ 的实例，后跟 $25$ 个 $1$ 的实例。\n- 特征 $F^{(1)}$ 是二元的，通过联合计数与 $G$ 有轻微依赖\n$$\n\\left[\\begin{array}{cc}\n15  11\\\\\n10  14\n\\end{array}\\right],\n$$\n在 $50$ 个样本中，$F^{(1)}$ 与 $G$ 之间有 $29$ 次匹配。\n- 特征 $F^{(2)}$ 是二元的，且与 $G$ 近乎独立，其联合计数为\n$$\n\\left[\\begin{array}{cc}\n13  12\\\\\n12  13\n\\end{array}\\right]。\n$$\n- 特征 $F^{(3)}$ 是常数，对于所有 $50$ 个样本其值均为 $0$。\n- 显著性水平 $\\alpha=0.05$。\n\n测试用例 4（多类别遗传学；一个派生的二元指示器代理）：\n- 样本量 $n=90$。\n- 遗传变量 $G$ 是三元的，各有 $30$ 个 $0$、$1$ 和 $2$ 的实例。\n- 特征 $F^{(1)}$ 是一个二元指示器代理，确定性地定义为 $F^{(1)}=\\mathbb{1}\\{G=2\\}$，因此当且仅当 $G=2$ 时 $F^{(1)}=1$，否则 $F^{(1)}=0$。\n- 特征 $F^{(2)}$ 是三元的，且与 $G$ 完全独立，其在 $(F^{(2)},G)$ 的 $3\\times 3$ 网格上的联合计数为\n$$\n\\left[\\begin{array}{ccc}\n10  10  10\\\\\n10  10  10\\\\\n10  10  10\n\\end{array}\\right]。\n$$\n- 特征 $F^{(3)}$ 是常数，对于所有 $90$ 个样本其值均为 $0$。\n- 显著性水平 $\\alpha=0.05$。\n\n程序输出规范：\n- 实现审计并按所列顺序将其应用于四个测试用例。\n- 对于每个测试用例，生成一个整数，等于根据阈值规则判定为不合规的特征数量。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，并用方括号括起来（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_i$ 是测试用例 $i$ 的整数计数。\n\n程序必须是完整的、自包含的，并且不得需要任何用户输入、外部文件或网络访问。它必须完全符合单独指定的执行环境和库约束。",
            "solution": "审计预测模型是否符合《遗传信息非歧视法案》(GINA) 的问题，是一项定义明确且具有科学依据的任务。它要求将信息论和统计假设检验中已确立的原则应用于一组明确定义的数据。问题提供了所有必要的定义、常数和数据结构，以推导出唯一、可验证的解决方案。其前提在事实上是合理的，术语是精确的，目标是明确的。因此，该问题是有效的。\n\n解决方案首先建立理论框架，然后将其应用于指定的测试用例。\n\n**1. 理论框架**\n\n审计的核心是量化模型特征（由离散随机变量 $F$ 表示）与遗传信息（由离散随机变量 $G$ 表示）之间的统计依赖性。为此选择的度量是香农互信息 (MI)，定义如下：\n\n$$I(F;G) \\equiv \\sum_{f \\in \\mathcal{F}} \\sum_{g \\in \\mathcal{G}} p_{F,G}(f,g) \\log\\left(\\frac{p_{F,G}(f,g)}{p_{F}(f)\\,p_{G}(g)}\\right)$$\n\n这里，$p_{F,G}(f,g)$ 是 $(F,G)$ 的联合概率质量函数 (PMF)，$p_F(f)$ 和 $p_G(g)$ 分别是边缘 PMF。所有对数都是自然对数，因此 MI 的单位是奈特 (nats)。互信息是非负的，$I(F;G) \\ge 0$，并且当且仅当 $F$ 和 $G$ 统计独立时等于零。\n\n给定一个包含 $n$ 个观测值的数据集，我们不知道真实的 PMF。取而代之，我们使用从观测频率派生的经验分布。设 $N(f,g)$ 是特征值为 $f$ 且遗传变量值为 $g$ 的观测计数。这些计数构成一个列联表。经验联合 PMF 为 $\\hat{p}_{F,G}(f,g) = N(f,g)/n$。经验边缘概率为 $\\hat{p}_F(f) = \\sum_g \\hat{p}_{F,G}(f,g)$ 和 $\\hat{p}_G(g) = \\sum_f \\hat{p}_{F,G}(f,g)$。将这些代入 MI 公式，得到插件估计值 $\\hat{I}(F;G)$。\n\n观测到非零的经验 MI，即 $\\hat{I}(F;G)  0$，并不足以断定存在依赖关系，因为即使变量实际上是独立的，这也可能由随机抽样波动引起。需要进行统计检验来评估观测到的依赖性的显著性。该问题指定使用似然比检验（G检验）来检验列联表中的独立性。统计学中的一个关键结果表明，在独立性零假设 ($H_0$) 下，检验统计量 $2n\\,\\hat{I}(F;G)$ 渐近服从卡方 ($\\chi^2$) 分布。\n\n这个 $\\chi^2$ 分布的自由度 $d$ 由列联表的大小决定：\n\n$$d = (|\\mathcal{F}| - 1)(|\\mathcal{G}| - 1)$$\n\n其中 $|\\mathcal{F}|$ 和 $|\\mathcal{G}|$ 分别是特征 $F$ 和遗传变量 $G$ 的不同类别数。\n\n对于选定的显著性水平 $\\alpha$，我们可以从自由度为 $d$ 的 $\\chi^2$ 分布中找到一个临界值 $q_{1-\\alpha}(d)$，使得 $P(\\chi^2(d)  q_{1-\\alpha}(d)) = \\alpha$。如果观测到的检验统计量大于此临界值，我们将拒绝独立性零假设：\n\n$$2n\\,\\hat{I}(F;G)  q_{1-\\alpha}(d)$$\n\n此框架被用来定义合规规则。如果一个特征对 $G$ 的依赖性证据在水平 $\\alpha$ 上具有统计显著性，则该特征被视为不合规。重新整理上述不等式，如果一个特征 $F$ 的经验互信息超过推导出的阈值 $\\tau_{\\alpha}$，则它是不合规的：\n\n$$\\hat{I}(F;G)  \\tau_{\\alpha} \\quad \\text{其中} \\quad \\tau_{\\alpha} = \\frac{q_{1-\\alpha}(d)}{2n}$$\n\n当 $d=0$ 时会出现一种特殊情况。这发生在 $|\\mathcal{F}|=1$ 或 $|\\mathcal{G}|=1$ 时，意味着其中一个变量是常数。一个常数特征不能携带任何关于另一个变量的信息，因此 $\\hat{I}(F;G)$ 必然为 $0$。在这种情况下，该特征自动被视为合规。\n\n**2. 算法流程**\n\n对于每个测试用例中的每个特征，执行以下算法：\n\n1.  为特征 $F^{(j)}$ 和遗传变量 $G$ 构建观测到的联合计数的列联表。\n2.  从表中确定类别数 $|\\mathcal{F}|$ 和 $|\\mathcal{G}|$（即其维度）。\n3.  计算自由度 $d = (|\\mathcal{F}|-1)(|\\mathcal{G}|-1)$。\n4.  如果 $d=0$，该特征是合规的。对此特征的审计结束。\n5.  如果 $d0$，继续。通过对表中所有计数求和来计算总样本量 $n$。\n6.  从列联表计算经验互信息 $\\hat{I}(F;G)$。计算必须处理计数为 $0$ 的情况，因为相应的项 $p\\log(p/p_1p_2)$ 为 $0$。\n7.  使用给定的显著性水平 $\\alpha$，从自由度为 $d$ 的 $\\chi^2$ 分布中找到临界值 $q_{1-\\alpha}(d)$。\n8.  计算合规性阈值 $\\tau_{\\alpha} = q_{1-\\alpha}(d) / (2n)$。\n9.  将经验 MI 与阈值进行比较。如果 $\\hat{I}(F;G)  \\tau_{\\alpha}$，该特征被分类为不合规。否则，它是合规的。\n10. 每个测试用例的最终结果是其不合规特征的总数。\n\n此流程严格执行了指定的 GINA 合规性审计，将信息论和假设检验的原理转化为具体的决策算法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Constructs and implements a principled auditing framework for a predictive \n    diagnostic model based on the Genetic Information Nondiscrimination Act (GINA).\n    \"\"\"\n\n    def calculate_mi(contingency_table: np.ndarray) - float:\n        \"\"\"\n        Calculates the empirical mutual information from a contingency table of counts.\n\n        Args:\n            contingency_table: A 2D numpy array of joint counts.\n\n        Returns:\n            The mutual information in nats.\n        \"\"\"\n        total_n = np.sum(contingency_table)\n        if total_n == 0:\n            return 0.0\n\n        joint_pmf = contingency_table / total_n\n        \n        # Calculate marginal probabilities\n        p_F = np.sum(joint_pmf, axis=1, keepdims=True)\n        p_G = np.sum(joint_pmf, axis=0, keepdims=True)\n\n        # To avoid division by zero or log(0), we only compute over non-zero joint probabilities.\n        # Where joint_pmf is 0, the term in the sum is 0, so we can ignore it.\n        non_zero_indices = joint_pmf  0\n        \n        p = joint_pmf[non_zero_indices]\n        p_outer_product = (p_F @ p_G)[non_zero_indices]\n\n        # Mutual information I(F;G) = D_KL(P(F,G) || P(F)P(G))\n        mi = np.sum(p * np.log(p / p_outer_product))\n        \n        return mi\n\n    def audit_feature(feature_data, alpha: float) - bool:\n        \"\"\"\n        Audits a single feature for compliance.\n\n        Args:\n            feature_data: A 2D list/numpy array representing the contingency table, \n                          or the string 'constant'.\n            alpha: The significance level for the test.\n\n        Returns:\n            True if the feature is non-compliant, False otherwise.\n        \"\"\"\n        # A constant feature is always compliant.\n        if isinstance(feature_data, str) and feature_data == 'constant':\n            return False\n\n        contingency_table = np.array(feature_data, dtype=float)\n        \n        num_f, num_g = contingency_table.shape\n        d = (num_f - 1) * (num_g - 1)\n\n        # If degrees of freedom is 0, the feature is compliant.\n        if d == 0:\n            return False\n            \n        n = np.sum(contingency_table)\n\n        # Compute empirical mutual information\n        mi_hat = calculate_mi(contingency_table)\n\n        # Compute the threshold tau_alpha\n        chi2_critical_value = chi2.ppf(1 - alpha, d)\n        tau_alpha = chi2_critical_value / (2 * n)\n        \n        # A feature is non-compliant if its empirical MI exceeds the threshold.\n        is_non_compliant = mi_hat  tau_alpha\n        \n        return is_non_compliant\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[30, 30], [30, 30]],\n                'constant',\n                [[20, 20], [20, 20], [20, 20]],\n            ]\n        },\n        {\n            \"alpha\": 0.01,\n            \"features\": [\n                [[50, 0], [0, 50]],\n                [[45, 5], [5, 45]],\n                [[25, 25], [25, 25]],\n            ]\n        },\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[15, 11], [10, 14]],\n                [[13, 12], [12, 13]],\n                'constant',\n            ]\n        },\n        {\n            \"alpha\": 0.05,\n            \"features\": [\n                [[30, 30, 0], [0, 0, 30]],\n                [[10, 10, 10], [10, 10, 10], [10, 10, 10]],\n                'constant',\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        features = case[\"features\"]\n        non_compliant_count = 0\n        for feature_data in features:\n            if audit_feature(feature_data, alpha):\n                non_compliant_count += 1\n        results.append(non_compliant_count)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}