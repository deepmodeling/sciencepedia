{
    "hands_on_practices": [
        {
            "introduction": "诊断测试的性能评估始于理解其最核心的指标。本练习将指导您使用一个经典的 $2 \\times 2$ 混淆矩阵，从中计算出灵敏度（sensitivity）和特异度（specificity）。通过从第一性原理出发，您不仅能掌握这些基础计算，还能深入理解为何在案例对照研究中，这些指标能够独立于疾病患病率，成为衡量测试内在性能的稳定基石。",
            "id": "4332588",
            "problem": "一项靶向下一代测序分析在精准肿瘤学环境中被评估，用于检测致病性变异。在一项多中心病例对照评估中，样本被该分析分类为阳性或阴性，并由一种金标准正交方法确定其真实的变异状态。设真阳性计数为 $TP = 48$，假阴性计数为 $FN = 12$，假阳性计数为 $FP = 18$，真阴性计数为 $TN = 122$。仅使用条件概率和二元分类中错误率的基本定义，计算以下四个性能特征：灵敏度、特异度、假阳性率和假阴性率。然后，使用关于回顾性（病例对照）抽样下条件概率的第一性原理论证，确定这四个量中哪些在病例对照抽样下对疾病患病率是不变的。\n\n以单行矩阵的形式报告最终答案，顺序为 $\\bigl(\\text{sensitivity},\\ \\text{specificity},\\ \\text{false positive rate},\\ \\text{false negative rate},\\ I_{\\text{sensitivity}},\\ I_{\\text{specificity}},\\ I_{\\text{false positive rate}},\\ I_{\\text{false negative rate}}\\bigr)$，其中如果该量在病例对照抽样下对患病率不变，则 $I_{\\cdot}$ 为 $1$，否则为 $0$。将这四个率表示为精确的最简分数。不允许四舍五入。不变性指标必须报告为精确整数 $0$ 或 $1$。",
            "solution": "该问题陈述经评估具有科学依据、提法明确、客观且自洽。计算所需的所有数据均已提供，且所涉及的概念是统计学和临床诊断学的基础。因此，该问题是有效的。\n\n设 $D^+$ 表示个体携带致病性变异（为病例）的事件， $D^-$ 表示个体不携带该变异（为对照）的事件。设 $T^+$ 表示分析结果为阳性的事件， $T^-$ 表示分析结果为阴性的事件。\n\n提供的数据是在一个二元分类混淆矩阵中的四种可能结果的计数：\n- 真阳性（$TP$）：携带变异且检测结果为阳性的个体数量。$TP = 48$。\n- 假阴性（$FN$）：携带变异但检测结果为阴性的个体数量。$FN = 12$。\n- 假阳性（$FP$）：不携带变异但检测结果为阳性的个体数量。$FP = 18$。\n- 真阴性（$TN$）：不携带变异且检测结果为阴性的个体数量。$TN = 122$。\n\n根据这些计数，我们可以确定研究中病例和对照的总数：\n- 病例总数（携带变异的个体）：$P = TP + FN = 48 + 12 = 60$。\n- 对照总数（不携带变异的个体）：$N = FP + TN = 18 + 122 = 140$。\n\n这四个性能特征是基于它们作为条件概率的定义来计算的。\n\n1.  **灵敏度（真阳性率, $TPR$）**\n    灵敏度是在个体确实携带该变异的条件下，检测结果为阳性的概率。它是衡量检测方法识别真病例能力的指标。\n    $$ \\text{Sensitivity} = P(T^+ | D^+) = \\frac{\\text{Number of individuals with } T^+ \\text{ and } D^+}{\\text{Total number of individuals with } D^+} = \\frac{TP}{TP + FN} $$\n    代入给定值：\n    $$ \\text{Sensitivity} = \\frac{48}{48 + 12} = \\frac{48}{60} = \\frac{4 \\times 12}{5 \\times 12} = \\frac{4}{5} $$\n\n2.  **特异度（真阴性率, $TNR$）**\n    特异度是在个体确实不携带该变异的条件下，检测结果为阴性的概率。它是衡量检测方法识别真非病例能力的指标。\n    $$ \\text{Specificity} = P(T^- | D^-) = \\frac{\\text{Number of individuals with } T^- \\text{ and } D^-}{\\text{Total number of individuals with } D^-} = \\frac{TN}{TN + FP} $$\n    代入给定值：\n    $$ \\text{Specificity} = \\frac{122}{122 + 18} = \\frac{122}{140} = \\frac{61 \\times 2}{70 \\times 2} = \\frac{61}{70} $$\n\n3.  **假阳性率 ($FPR$)**\n    假阳性率是在个体确实不携带该变异的条件下，检测结果为阳性的概率。这是一类错误率。\n    $$ FPR = P(T^+ | D^-) = \\frac{\\text{Number of individuals with } T^+ \\text{ and } D^-}{\\text{Total number of individuals with } D^-} = \\frac{FP}{FP + TN} $$\n    它在定义上也与特异度相关：$FPR = 1 - \\text{Specificity}$。\n    代入给定值：\n    $$ FPR = \\frac{18}{18 + 122} = \\frac{18}{140} = \\frac{9 \\times 2}{70 \\times 2} = \\frac{9}{70} $$\n\n4.  **假阴性率 ($FNR$)**\n    假阴性率是在个体确实携带该变异的条件下，检测结果为阴性的概率。这是二类错误率。\n    $$ FNR = P(T^- | D^+) = \\frac{\\text{Number of individuals with } T^- \\text{ and } D^+}{\\text{Total number of individuals with } D^+} = \\frac{FN}{TP + FN} $$\n    它在定义上也与灵敏度相关：$FNR = 1 - \\text{Sensitivity}$。\n    代入给定值：\n    $$ FNR = \\frac{12}{48 + 12} = \\frac{12}{60} = \\frac{1 \\times 12}{5 \\times 12} = \\frac{1}{5} $$\n\n接下来，我们必须确定在病例对照抽样下，这些量中哪些对疾病患病率是不变的。\n\n病例对照研究是一种回顾性研究设计，其中受试者是根据其已知的结果状态来选择的。在这里，一组“病例”（携带变异的个体，$D^+$）和一组“对照”（不携带变异的个体，$D^-$）被组合在一起。研究样本中病例与对照的比例是由研究设计决定的，而不是由人群中疾病的自然患病率决定的。患病率 $\\pi = P(D^+)$ 是在一般人群中患有该疾病的先验概率，研究样本可能从该人群中抽取。在病例对照设计中，样本患病率是人为固定的，并不是对 $\\pi$ 的估计。\n\n我们根据这种抽样方案来分析这四个指标的定义：\n\n-   **灵敏度, $P(T^+|D^+)$**：这个概率是以事件 $D^+$ 为条件的。计算 $\\frac{TP}{TP+FN}$ 完全在病例组内进行。由于灵敏度的估计仅取决于已知患病的受试者，它与研究中包含了多少未患病的受试者无关。因此，灵敏度是检测方法对患病人群性能的内在特征，并且对一般人群中的疾病患病率是**不变的**。指标 $I_{\\text{sensitivity}}$ 为 $1$。\n\n-   **特异度, $P(T^-|D^-)$**：这个概率是以事件 $D^-$ 为条件的。计算 $\\frac{TN}{TN+FP}$ 完全在对照组内进行。与灵敏度类似，特异度的估计仅取决于已知无病的受试者。因此，它是检测方法对非患病人群性能的内在特征，并且对疾病患病率是**不变的**。指标 $I_{\\text{specificity}}$ 为 $1$。\n\n-   **假阳性率, $P(T^+|D^-)$**：这个概率也是以事件 $D^-$ 为条件的。其计算 $\\frac{FP}{FP+TN}$ 完全在对照组内进行。由于它就是 $1 - \\text{Specificity}$，它具有相同的性质。假阳性率对疾病患病率是**不变的**。指标 $I_{\\text{false positive rate}}$ 为 $1$。\n\n-   **假阴性率, $P(T^-|D^+)$**：这个概率也是以事件 $D^+$ 为条件的。其计算 $\\frac{FN}{TP+FN}$ 完全在病例组内进行。由于它就是 $1 - \\text{Sensitivity}$，它也具有相同的性质。假阴性率对疾病患病率是**不变的**。指标 $I_{\\text{false negative rate}}$ 为 $1$。\n\n总之，所有四个指标——灵敏度、特异度、假阳性率和假阴性率——都是以真实疾病状态为条件的概率来定义的。病例对照研究设计之所以能够直接估计这些量，正是因为它从患病和非患病这两个不同层级中进行抽样。这些指标是检测方法本身的属性，而不是其使用人群的属性。相比之下，像阳性预测值（$PPV = P(D^+|T^+)$）和阴性预测值（$NPV = P(D^-|T^-)$）这样的指标，通过贝叶斯定理，严重依赖于患病率 $\\pi = P(D^+)$，并且在没有关于 $\\pi$ 的外部知识的情况下，无法从病例对照研究中直接估计。\n\n计算出的值及其不变性指标如下：\n- 灵敏度：$\\frac{4}{5}$，不变（$I=1$）\n- 特异度：$\\frac{61}{70}$，不变（$I=1$）\n- 假阳性率：$\\frac{9}{70}$，不变（$I=1$）\n- 假阴性率：$\\frac{1}{5}$，不变（$I=1$）\n\n最终答案按指定顺序以单行矩阵形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{5}  \\frac{61}{70}  \\frac{9}{70}  \\frac{1}{5}  1  1  1  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "超越简单的“阳性”或“阴性”判断，许多现代诊断工具（如基因组分类器）提供了更精细的连续分数。本练习将引导您处理这类数据，通过构建受试者工作特征（ROC）曲线来全面评估测试性能。您将学习如何通过改变决策阈值来描绘真阳性率与假阳性率之间的动态平衡，并计算曲线下面积（AUC）这一概括性指标，以量化测试的整体区分能力。",
            "id": "4332613",
            "problem": "精准肿瘤学中使用的一种基因组分类器会为每个个体输出一个连续的诊断评分。考虑一个评估队列，其中有 $n_{D} = 4$ 名疾病病例和 $n_{N} = 4$ 名非疾病对照。观察到的分类器评分如下：疾病病例的评分为 $[0.95, 0.81, 0.77, 0.62]$，非疾病对照的评分为 $[0.83, 0.79, 0.70, 0.40]$。使用决策规则“如果评分大于或等于阈值 $\\tau$，则预测为疾病”，并通过改变 $\\tau$ 遍历所有观察到的评分来构建经验性受试者工作特征 (ROC) 曲线。ROC 曲线绘制了当 $\\tau$ 变化时，真阳性率 (TPR) 相对于假阳性率 (FPR) 的关系。\n\n从基本原理出发，使用灵敏度和特异度的标准条件概率定义，推导出通过对有限样本进行阈值处理而产生的经验性 ROC 点。明确指出不同疾病状态下评分相同的任何情况（评分并列），并解释在有限样本中必须如何处理此类并列情况，以生成一个良定义的经验性 ROC 曲线和曲线下面积。然后，使用与决策规则引起的阶梯式变化一致的阈值扫描方法，并通过沿 FPR 轴进行几何上合理的积分，计算 ROC 的经验性曲线下面积 (AUC)。\n\n将最终的 AUC 四舍五入至 $4$ 位有效数字，并以不带百分号的小数形式表示。",
            "solution": "该问题要求为一组来自患病和非患病个体队列的诊断评分构建受试者工作特征 (ROC) 曲线，并计算曲线下面积 (AUC)。\n\n### 步骤 1：问题验证\n\n问题给出了以下已知条件：\n-   疾病病例数：$n_{D} = 4$。\n-   疾病病例的评分：$[0.95, 0.81, 0.77, 0.62]$。\n-   非疾病对照数：$n_{N} = 4$。\n-   非疾病对照的评分：$[0.83, 0.79, 0.70, 0.40]$。\n-   决策规则：如果评分 $\\ge \\tau$，则预测为疾病。\n\n问题要求：\n1.  通过改变阈值 $\\tau$ 构建经验性 ROC 曲线。\n2.  解释如何处理评分并列的情况。\n3.  使用沿假阳性率 (FPR) 轴的几何积分计算经验性 AUC。\n4.  将最终的 AUC 四舍五入至 $4$ 位有效数字。\n\n该问题在科学上基于用于诊断测试评估的成熟统计方法——ROC 分析。问题陈述清晰，提供了所有必要数据，没有矛盾之处。任务是客观的，需要进行标准且可验证的计算。因此，该问题被认定为**有效**。\n\n### 步骤 2：理论框架\n\n设 $S$ 为诊断评分。设 $D$ 表示患病状态，$N$ 表示未患病状态。决策规则将评分 $S$ 大于或等于阈值 $\\tau$ 的个体分类为阳性 ($T+$)，否则分类为阴性 ($T-$)。\n\nROC 曲线的两个关键性能指标是真阳性率 (TPR) 和假阳性率 (FPR)。\n\n-   **真阳性率 (TPR)**，或称灵敏度，是在患病人群中正确预测为阳性的概率：$TPR(\\tau) = P(S \\ge \\tau | D)$。\n-   **假阳性率 (FPR)** 是在非患病人群中错误预测为阳性的概率：$FPR(\\tau) = P(S \\ge \\tau | N)$。请注意，特异度是 $1 - FPR(\\tau)$。\n\n对于有限样本，这些概率通过比例来估计：\n$$TPR(\\tau) = \\frac{\\text{评分为} \\ge \\tau \\text{的患病个体数}}{n_D} = \\frac{TP(\\tau)}{n_D}$$\n$$FPR(\\tau) = \\frac{\\text{评分为} \\ge \\tau \\text{的非患病个体数}}{n_N} = \\frac{FP(\\tau)}{n_N}$$\n其中 $TP(\\tau)$ 和 $FP(\\tau)$ 分别是在阈值 $\\tau$ 下的真阳性和假阳性计数。\n\n### 步骤 3：经验性 ROC 曲线构建\n\n经验性 ROC 曲线是通过为每个可能的阈值计算 $(FPR, TPR)$ 对来构建的。在有限样本中，相关阈值的集合由数据中存在的唯一评分值组成。为了构建曲线，我们可以将阈值 $\\tau$ 从高于最高分的值扫描到低于最低分的值。\n\n给定的评分为：\n-   患病 ($S_D$)：$\\{0.95, 0.81, 0.77, 0.62\\}$\n-   非患病 ($S_N$)：$\\{0.83, 0.79, 0.70, 0.40\\}$\n\n我们将所有评分合并并按降序排序，同时记下每个评分的类别：\n$0.95 (D), 0.83 (N), 0.81 (D), 0.79 (N), 0.77 (D), 0.70 (N), 0.62 (D), 0.40 (N)$。\n\n现在，我们改变阈值 $\\tau$ 并计算 $TP$ 和 $FP$ 的累积计数，以及相应的比率 $TPR$ 和 $FPR$。ROC 曲线从 $(0,0)$（对于 $\\tau  \\max(S)$）开始，到 $(1,1)$（对于 $\\tau \\le \\min(S)$）结束。\n\n1.  **初始点：** 对于任何 $\\tau  0.95$，没有评分 $\\ge \\tau$。所以，$TP=0, FP=0$。这给出了点 $(FPR, TPR) = (0/4, 0/4) = (0, 0)$。\n\n2.  **阈值 $\\tau$ 越过 $0.95$ (D)：** 对于 $0.83  \\tau \\le 0.95$，一个患病病例的评分 $\\ge \\tau$。$TP=1, FP=0$。这给出了点 $(0/4, 1/4) = (0, 0.25)$。曲线从 $(0,0)$ 向上移动到 $(0,0.25)$。\n\n3.  **阈值 $\\tau$ 越过 $0.83$ (N)：** 对于 $0.81  \\tau \\le 0.83$，一个患病和一个非患病的评分 $\\ge \\tau$。$TP=1, FP=1$。这给出了点 $(1/4, 1/4) = (0.25, 0.25)$。曲线从 $(0,0.25)$向右移动到 $(0.25,0.25)$。\n\n4.  **阈值 $\\tau$ 越过 $0.81$ (D)：** 对于 $0.79  \\tau \\le 0.81$，$TP=2, FP=1$。点：$(1/4, 2/4) = (0.25, 0.5)$。\n\n5.  **阈值 $\\tau$ 越过 $0.79$ (N)：** 对于 $0.77  \\tau \\le 0.79$，$TP=2, FP=2$。点：$(2/4, 2/4) = (0.5, 0.5)$。\n\n6.  **阈值 $\\tau$ 越过 $0.77$ (D)：** 对于 $0.70  \\tau \\le 0.77$，$TP=3, FP=2$。点：$(2/4, 3/4) = (0.5, 0.75)$。\n\n7.  **阈值 $\\tau$ 越过 $0.70$ (N)：** 对于 $0.62  \\tau \\le 0.70$，$TP=3, FP=3$。点：$(3/4, 3/4) = (0.75, 0.75)$。\n\n8.  **阈值 $\\tau$ 越过 $0.62$ (D)：** 对于 $0.40  \\tau \\le 0.62$，$TP=4, FP=3$。点：$(3/4, 4/4) = (0.75, 1.0)$。\n\n9.  **阈值 $\\tau$ 越过 $0.40$ (N)：** 对于 $\\tau \\le 0.40$，所有评分都 $\\ge \\tau$。$TP=4, FP=4$。点：$(4/4, 4/4) = (1.0, 1.0)$。\n\n经验性 ROC 曲线的顶点序列是：\n$P_0=(0, 0)$, $P_1=(0, 0.25)$, $P_2=(0.25, 0.25)$, $P_3=(0.25, 0.5)$, $P_4=(0.5, 0.5)$, $P_5=(0.5, 0.75)$, $P_6=(0.75, 0.75)$, $P_7=(0.75, 1.0)$, $P_8=(1.0, 1.0)$。\n\n### 步骤 4：处理评分并列的情况\n\n问题要求解释如何处理评分并列的情况。首先，我们注意到在给定的数据集中，患病和非患病个体之间没有相同的评分，两个组内部也没有。所有 $n_D + n_N = 8$ 个评分都是唯一的。\n\n在存在并列的一般情况下，假设一个评分值 $s^*$ 被 $k_D$ 个患病个体和 $k_N$ 个非患病个体共享。当决策阈值 $\\tau$ 降低到 $s^*$ 以下时，所有这些个体都会同时被重新分类为阳性。这导致真阳性计数一步增加 $k_D$，假阳性计数一步增加 $k_N$。\n\n如果在此阈值之前的 ROC 曲线上一点是 $(FPR_{i-1}, TPR_{i-1})$，那么新点将变为：\n$$FPR_i = FPR_{i-1} + \\frac{k_N}{n_N}$$\n$$TPR_i = TPR_{i-1} + \\frac{k_D}{n_D}$$\n这会在 ROC 图上产生一条连接 $(FPR_{i-1}, TPR_{i-1})$ 到 $(FPR_i, TPR_i)$ 的单一对角线段。这个过程确保了 ROC 曲线及其面积是良定义的。\n\n### 步骤 5：AUC 计算\n\n曲线下面积 (AUC) 是 ROC 函数 $TPR(FPR)$ 从 $FPR=0$ 到 $FPR=1$ 的积分。对于由一组顶点 $(x_i, y_i) = (FPR_i, TPR_i)$ 定义的经验性 ROC 曲线，AUC 可以通过将每对连续顶点与 FPR 轴形成的梯形面积相加来计算。具有顶点 $(x_{i-1}, y_{i-1})$ 和 $(x_i, y_i)$ 的梯形面积由下式给出：\n$$Area_i = \\frac{y_{i-1} + y_i}{2} (x_i - x_{i-1})$$\n总 AUC 是曲线上所有线段的这些面积之和。使用上面推导出的顶点 $P_0, \\dots, P_8$：\n\n-   线段 $P_0 \\to P_1$：$x_0=0, y_0=0$；$x_1=0, y_1=0.25$。面积 = $\\frac{0+0.25}{2}(0-0) = 0$。\n-   线段 $P_1 \\to P_2$：$x_1=0, y_1=0.25$；$x_2=0.25, y_2=0.25$。面积 = $\\frac{0.25+0.25}{2}(0.25-0) = 0.25 \\times 0.25 = 0.0625$。\n-   线段 $P_2 \\to P_3$：$x_2=0.25, y_2=0.25$；$x_3=0.25, y_3=0.5$。面积 = $\\frac{0.25+0.5}{2}(0.25-0.25) = 0$。\n-   线段 $P_3 \\to P_4$：$x_3=0.25, y_3=0.5$；$x_4=0.5, y_4=0.5$。面积 = $\\frac{0.5+0.5}{2}(0.5-0.25) = 0.5 \\times 0.25 = 0.125$。\n-   线段 $P_4 \\to P_5$：$x_4=0.5, y_4=0.5$；$x_5=0.5, y_5=0.75$。面积 = $\\frac{0.5+0.75}{2}(0.5-0.5) = 0$。\n-   线段 $P_5 \\to P_6$：$x_5=0.5, y_5=0.75$；$x_6=0.75, y_6=0.75$。面积 = $\\frac{0.75+0.75}{2}(0.75-0.5) = 0.75 \\times 0.25 = 0.1875$。\n-   线段 $P_6 \\to P_7$：$x_6=0.75, y_6=0.75$；$x_7=0.75, y_7=1.0$。面积 = $\\frac{0.75+1.0}{2}(0.75-0.75) = 0$。\n-   线段 $P_7 \\to P_8$：$x_7=0.75, y_7=1.0$；$x_8=1.0, y_8=1.0$。面积 = $\\frac{1.0+1.0}{2}(1.0-0.75) = 1.0 \\times 0.25 = 0.25$。\n\n总 AUC 是非零面积分量之和：\n$$AUC = 0.0625 + 0.125 + 0.1875 + 0.25 = 0.625$$\n问题要求将答案四舍五入至 $4$ 位有效数字。\n$$AUC = 0.6250$$",
            "answer": "$$\\boxed{0.6250}$$"
        },
        {
            "introduction": "虽然灵敏度和特异度是评估诊断测试的核心指标 ，但在实践中理解它们的背景依赖性至关重要。本练习将揭示一个被称为“谱系偏倚”（spectrum bias）的关键现象：即测试的观测性能会因患者群体的构成不同而发生变化。您将通过一个具体的计算案例，亲身体验即使测试方法完全相同，仅仅因为患者疾病严重程度的分布差异，也会导致观测到的灵敏度出现显著不同，这对在不同临床环境中应用和解释测试结果至关重要。",
            "id": "4332601",
            "problem": "在精准肿瘤学中使用的一种靶向测序分析中，变异检出算法会计算一个连续的对数似然比分数 $X$ 来判断是否存在驱动突变。当 $X \\geq c$ 时，报告为阳性。假设在给定真实突变状态和疾病生物学严重程度（反映了变异等位基因频率和肿瘤纯度）的条件下，分数 $X$ 具有以下分布，且这些分布在所有队列中都是相同的：\n\n- 对于生物学特征为轻度的真实突变病例，$X \\mid (D, S=\\text{mild}) \\sim \\mathcal{N}(\\mu_{\\text{mild}}, \\sigma^{2})$，其中 $\\mu_{\\text{mild}}=2$ 且 $\\sigma=1$。\n- 对于生物学特征为重度的真实突变病例，$X \\mid (D, S=\\text{severe}) \\sim \\mathcal{N}(\\mu_{\\text{severe}}, \\sigma^{2})$，其中 $\\mu_{\\text{severe}}=5$ 且 $\\sigma=1$。\n- 对于真实非突变病例，$X \\mid \\bar{D} \\sim \\mathcal{N}(0,1)$。\n\n决策阈值固定为 $c=3$，且该算法、其阈值以及上述所有条件分布在不同队列中均相同。\n\n两个研究队列仅在真实突变病例中疾病严重程度的构成上有所不同：\n- A队列有 $\\mathbb{P}(S=\\text{severe} \\mid D)=0.3$ 和 $\\mathbb{P}(S=\\text{mild} \\mid D)=0.7$。\n- B队列有 $\\mathbb{P}(S=\\text{severe} \\mid D)=0.7$ 和 $\\mathbb{P}(S=\\text{mild} \\mid D)=0.3$。\n\n该检测、测量过程或条件分布的任何其他方面均不依赖于队列。\n\n仅使用诊断测试性能的核心定义，完成以下任务：\n\n- 提供一个关于诊断测试评估中谱系偏倚（spectrum bias）的精确定义，说明病例组合（case-mix）如何在底层测试机制没有任何改变的情况下改变观察到的性能。\n- 使用灵敏度定义 $\\mathbb{P}(T^{+} \\mid D)$ 和固定阈值规则 $T^{+}\\iff X \\geq c$，推导A队列和B队列中观察到的灵敏度表达式，并计算差值 $\\Delta=\\text{sensitivity}_{B}-\\text{sensitivity}_{A}$。\n\n将 $\\Delta$ 的最终数值答案表示为小数，并四舍五入到四位有效数字。最终答案中不要包含任何单位。",
            "solution": "题目陈述已经过评估并被确定为有效。它在科学上基于生物统计学和诊断测试评估的原理，问题设定良好，给出的条件完整且一致，并以客观、正式的语言表达。它代表了概率论在精准医疗现实场景中的一个非平凡应用，特别是展示了谱系偏倚的概念。\n\n第一个任务是提供谱系偏倚的精确定义。谱系偏倚（Spectrum bias），也称为病例组合偏倚（case-mix bias），是一种现象，即诊断测试的观察性能（特别是其灵敏度和特异性）在不同人群或研究中会有所不同。这种变化并非源于测试本身内在属性的任何改变（例如，分析方法、决策阈值），而是被测试人群构成差异的结果。具体而言，灵敏度可能受到患病组内疾病严重程度、分期或其他患者特征“谱系”的影响，而特异性可能受到非患病组中替代病症谱系的影响。如果一个测试检测疾病的能力与疾病严重程度相关，那么一个重症病例比例较高的研究人群将表现出比一个轻症或早期病例比例较高的人群更高的表观灵敏度，即使该测试在任何给定严重程度水平上的条件性能对两组人群都是相同的。\n\n第二个任务是推导A队列和B队列的观察灵敏度并计算它们的差值。灵敏度定义为在个体确实患有该疾病（$D$）的条件下，测试结果为阳性（$T^{+}$）的概率，即 $\\mathbb{P}(T^{+} \\mid D)$。当对数似然比分数 $X$ 大于或等于阈值 $c$ 时，测试结果为阳性。因此，灵敏度为 $\\mathbb{P}(X \\geq c \\mid D)$。\n\n患病个体（$D$）群体是生物学特征为轻度（$S=\\text{mild}$）和重度（$S=\\text{severe}$）的病例的异质混合体。我们可以应用全概率定律将总灵敏度表示为这两个分层内灵敏度的加权平均值：\n$$\n\\text{Sensitivity} = \\mathbb{P}(X \\geq c \\mid D) = \\mathbb{P}(X \\geq c \\mid D, S=\\text{mild})\\mathbb{P}(S=\\text{mild} \\mid D) + \\mathbb{P}(X \\geq c \\mid D, S=\\text{severe})\\mathbb{P}(S=\\text{severe} \\mid D)\n$$\n让我们将特定分层的灵敏度表示为：\n$\\text{Sens}_{\\text{mild}} = \\mathbb{P}(X \\geq c \\mid D, S=\\text{mild})$\n$\\text{Sens}_{\\text{severe}} = \\mathbb{P}(X \\geq c \\mid D, S=\\text{severe})$\n\n这些特定分层的灵敏度由分数 $X$ 的底层条件分布和固定阈值 $c$ 决定。它们在不同队列中是恒定的，因为题目说明这些分布是相同的。给定：\n- 对于轻度病例：$X \\mid (D, S=\\text{mild}) \\sim \\mathcal{N}(\\mu_{\\text{mild}}, \\sigma^{2})$，其中 $\\mu_{\\text{mild}}=2$ 且 $\\sigma=1$。\n- 对于重度病例：$X \\mid (D, S=\\text{severe}) \\sim \\mathcal{N}(\\mu_{\\text{severe}}, \\sigma^{2})$，其中 $\\mu_{\\text{severe}}=5$ 且 $\\sigma=1$。\n- 阈值为 $c=3$。\n\n我们通过对正态分布进行标准化来计算特定分层的灵敏度。设 $Z$ 为标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$，并设 $\\Phi(\\cdot)$ 为其累积分布函数（CDF）。\n\n对于轻度分层：\n$$\n\\text{Sens}_{\\text{mild}} = \\mathbb{P}(X \\geq 3) = \\mathbb{P}\\left(\\frac{X - \\mu_{\\text{mild}}}{\\sigma} \\geq \\frac{3 - 2}{1}\\right) = \\mathbb{P}(Z \\geq 1) = 1 - \\Phi(1)\n$$\n对于重度分层：\n$$\n\\text{Sens}_{\\text{severe}} = \\mathbb{P}(X \\geq 3) = \\mathbb{P}\\left(\\frac{X - \\mu_{\\text{severe}}}{\\sigma} \\geq \\frac{3 - 5}{1}\\right) = \\mathbb{P}(Z \\geq -2) = 1 - \\Phi(-2)\n$$\n使用标准正态分布的对称性，$\\Phi(-z) = 1 - \\Phi(z)$，我们有：\n$$\n\\text{Sens}_{\\text{severe}} = 1 - (1 - \\Phi(2)) = \\Phi(2)\n$$\n现在我们可以使用每个队列特定的病例组合概率来计算其总灵敏度。\n\n对于A队列：\n$\\mathbb{P}_A(S=\\text{mild} \\mid D) = 0.7$\n$\\mathbb{P}_A(S=\\text{severe} \\mid D) = 0.3$\n$$\n\\text{sensitivity}_{A} = \\text{Sens}_{\\text{mild}} \\cdot \\mathbb{P}_A(S=\\text{mild} \\mid D) + \\text{Sens}_{\\text{severe}} \\cdot \\mathbb{P}_A(S=\\text{severe} \\mid D)\n$$\n$$\n\\text{sensitivity}_{A} = (1 - \\Phi(1)) \\cdot 0.7 + \\Phi(2) \\cdot 0.3\n$$\n\n对于B队列：\n$\\mathbb{P}_B(S=\\text{mild} \\mid D) = 0.3$\n$\\mathbb{P}_B(S=\\text{severe} \\mid D) = 0.7$\n$$\n\\text{sensitivity}_{B} = \\text{Sens}_{\\text{mild}} \\cdot \\mathbb{P}_B(S=\\text{mild} \\mid D) + \\text{Sens}_{\\text{severe}} \\cdot \\mathbb{P}_B(S=\\text{severe} \\mid D)\n$$\n$$\n\\text{sensitivity}_{B} = (1 - \\Phi(1)) \\cdot 0.3 + \\Phi(2) \\cdot 0.7\n$$\n\n题目要求计算差值 $\\Delta = \\text{sensitivity}_{B} - \\text{sensitivity}_{A}$。\n$$\n\\Delta = [0.3(1 - \\Phi(1)) + 0.7\\Phi(2)] - [0.7(1 - \\Phi(1)) + 0.3\\Phi(2)]\n$$\n按 $\\text{Sens}_{\\text{mild}}=(1 - \\Phi(1))$ 和 $\\text{Sens}_{\\text{severe}}=\\Phi(2)$ 分组：\n$$\n\\Delta = (0.3 - 0.7)(1 - \\Phi(1)) + (0.7 - 0.3)\\Phi(2)\n$$\n$$\n\\Delta = -0.4(1 - \\Phi(1)) + 0.4\\Phi(2)\n$$\n$$\n\\Delta = 0.4[\\Phi(2) - (1 - \\Phi(1))]\n$$\n$$\n\\Delta = 0.4[\\Phi(2) + \\Phi(1) - 1]\n$$\n为获得数值，我们使用正态CDF的标准值：\n$\\Phi(1) \\approx 0.84134$\n$\\Phi(2) \\approx 0.97725$\n将这些值代入 $\\Delta$ 的表达式中：\n$$\n\\Delta \\approx 0.4[0.97725 + 0.84134 - 1]\n$$\n$$\n\\Delta \\approx 0.4[1.81859 - 1]\n$$\n$$\n\\Delta \\approx 0.4[0.81859]\n$$\n$$\n\\Delta \\approx 0.327436\n$$\n按要求四舍五入到四位有效数字，我们得到 $\\Delta = 0.3274$。\n这个正差值证实了富含重度生物学特征病例的B队列，表现出比主要由轻度生物学特征病例组成的A队列更高的观察灵敏度。这是谱系偏倚的一个直接的定量证明。",
            "answer": "$$\\boxed{0.3274}$$"
        }
    ]
}