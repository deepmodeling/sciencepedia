{
    "hands_on_practices": [
        {
            "introduction": "对任何诊断测试的严谨评估都始于其最基本的性能特征。本练习将通过一个标准的混淆矩阵，让您扎实掌握灵敏度、特异性及其相关错误率的基本计算 。更重要的是，它还引导您思考哪些指标是测试的内在属性，哪些则依赖于研究设计，这是解读已发表研究证据的关键概念。",
            "id": "4332588",
            "problem": "一种靶向性下一代测序分析方法在精准肿瘤学背景下被评估用于检测一个致病性变异。在一项多中心病例对照评估中，样本通过该分析方法被分类为阳性或阴性，并由一个金标准正交方法确定真实的变异状态。设真阳性计数为 $TP = 48$，假阴性计数为 $FN = 12$，假阳性计数为 $FP = 18$，真阴性计数为 $TN = 122$。仅使用条件概率和二元分类中错误率的基本定义，计算以下四个性能特征：灵敏度、特异度、假阳性率和假阴性率。然后，使用关于回顾性（病例对照）抽样下条件概率的第一性原理论证，确定这四个量中哪些在病例对照抽样下对疾病患病率是不变的。\n\n将最终答案以单行矩阵的形式报告，顺序为 $\\bigl(\\text{灵敏度},\\ \\text{特异度},\\ \\text{假阳性率},\\ \\text{假阴性率},\\ I_{\\text{灵敏度}},\\ I_{\\text{特异度}},\\ I_{\\text{假阳性率}},\\ I_{\\text{假阴性率}}\\bigr)$，其中如果某量在病例对照抽样下对患病率不变，则 $I_{\\cdot}$ 为 $1$，否则为 $0$。将这四个率表示为精确的既约分数。不允许四舍五入。不变性指标必须报告为精确整数 $0$ 或 $1$。",
            "solution": "经评估，该问题陈述具有科学依据、问题明确、客观且自成体系。计算所需的所有数据均已提供，且所涉及的概念是统计学和临床诊断学的基础。因此，该问题是有效的。\n\n令 $D^+$ 表示个体携带致病性变异的事件（为病例），$D^-$ 表示个体不携带该变异的事件（为对照）。令 $T^+$ 表示分析结果为阳性的事件，$T^-$ 表示分析结果为阴性的事件。\n\n所提供的数据是二元分类混淆矩阵中四种可能结果的计数：\n- 真阳性（$TP$）：携带变异且检测结果为阳性的个体数量。$TP = 48$。\n- 假阴性（$FN$）：携带变异但检测结果为阴性的个体数量。$FN = 12$。\n- 假阳性（$FP$）：不携带变异但检测结果为阳性的个体数量。$FP = 18$。\n- 真阴性（$TN$）：不携带变异且检测结果为阴性的个体数量。$TN = 122$。\n\n根据这些计数，我们可以确定研究中病例和对照的总数：\n- 病例总数（携带变异的个体）：$P = TP + FN = 48 + 12 = 60$。\n- 对照总数（不携带变异的个体）：$N = FP + TN = 18 + 122 = 140$。\n\n这四个性能特征是根据它们作为条件概率的定义来计算的。\n\n1.  **灵敏度（真阳性率, $TPR$）**\n    灵敏度是在个体确实携带变异的情况下，检测结果为阳性的概率。它衡量了检测方法识别真病例的能力。\n    $$ \\text{灵敏度} = P(T^+ | D^+) = \\frac{\\text{同时具有 } T^+ \\text{ 和 } D^+ \\text{ 的个体数量}}{\\text{具有 } D^+ \\text{ 的个体总数}} = \\frac{TP}{TP + FN} $$\n    代入给定值：\n    $$ \\text{灵敏度} = \\frac{48}{48 + 12} = \\frac{48}{60} = \\frac{4 \\times 12}{5 \\times 12} = \\frac{4}{5} $$\n\n2.  **特异度（真阴性率, $TNR$）**\n    特异度是在个体确实不携带变异的情况下，检测结果为阴性的概率。它衡量了检测方法识别真非病例的能力。\n    $$ \\text{特异度} = P(T^- | D^-) = \\frac{\\text{同时具有 } T^- \\text{ 和 } D^- \\text{ 的个体数量}}{\\text{具有 } D^- \\text{ 的个体总数}} = \\frac{TN}{TN + FP} $$\n    代入给定值：\n    $$ \\text{特异度} = \\frac{122}{122 + 18} = \\frac{122}{140} = \\frac{61 \\times 2}{70 \\times 2} = \\frac{61}{70} $$\n\n3.  **假阳性率 ($FPR$)**\n    假阳性率是在个体确实不携带变异的情况下，检测结果为阳性的概率。这是一个I型错误率。\n    $$ FPR = P(T^+ | D^-) = \\frac{\\text{同时具有 } T^+ \\text{ 和 } D^- \\text{ 的个体数量}}{\\text{具有 } D^- \\text{ 的个体总数}} = \\frac{FP}{FP + TN} $$\n    根据定义，它也与特异度相关：$FPR = 1 - \\text{特异度}$。\n    代入给定值：\n    $$ FPR = \\frac{18}{18 + 122} = \\frac{18}{140} = \\frac{9 \\times 2}{70 \\times 2} = \\frac{9}{70} $$\n\n4.  **假阴性率 ($FNR$)**\n    假阴性率是在个体确实携带变异的情况下，检测结果为阴性的概率。这是一个II型错误率。\n    $$ FNR = P(T^- | D^+) = \\frac{\\text{同时具有 } T^- \\text{ 和 } D^+ \\text{ 的个体数量}}{\\text{具有 } D^+ \\text{ 的个体总数}} = \\frac{FN}{TP + FN} $$\n    根据定义，它也与灵敏度相关：$FNR = 1 - \\text{灵敏度}$。\n    代入给定值：\n    $$ FNR = \\frac{12}{48 + 12} = \\frac{12}{60} = \\frac{1 \\times 12}{5 \\times 12} = \\frac{1}{5} $$\n\n接下来，我们必须确定在病例对照抽样下，这些量中哪些对疾病患病率是不变的。\n\n病例对照研究是一种回顾性研究设计，其中研究对象是根据其已知的结果状态来选择的。在这里，一组“病例”（携带变异的个体, $D^+$）和一组“对照”（不携带变异的个体, $D^-$）被召集起来。研究样本中病例与对照的比例是由研究设计决定的，而不是由疾病在人群中的自然患病率决定的。患病率，$\\pi = P(D^+)$，是在一般人群中患有该疾病的先验概率，研究样本可能从该人群中抽取。在病例对照设计中，样本患病率是人为固定的，并不是对 $\\pi$ 的估计。\n\n我们根据这种抽样方案来分析这四个指标的定义：\n\n-   **灵敏度, $P(T^+|D^+)$**：这个概率是以事件 $D^+$ 为条件的。计算 $\\frac{TP}{TP+FN}$ 完全在病例组内进行。由于灵敏度的估计仅依赖于已知患病的受试者，因此它与研究中包含了多少未患病的受试者无关。因此，灵敏度是检测方法在患病人群中性能的内在特征，并且对一般人群中的疾病患病率是**不变的**。指标 $I_{\\text{灵敏度}}$ 为 $1$。\n\n-   **特异度, $P(T^-|D^-)$**：这个概率是以事件 $D^-$ 为条件的。计算 $\\frac{TN}{TN+FP}$ 完全在对照组内进行。与灵敏度类似，特异度的估计仅依赖于已知无病的受试者。因此，它是检测方法在非患病人群中性能的内在特征，并且对疾病患病率是**不变的**。指标 $I_{\\text{特异度}}$ 为 $1$。\n\n-   **假阳性率, $P(T^+|D^-)$**：这个概率也是以事件 $D^-$ 为条件的。它的计算 $\\frac{FP}{FP+TN}$ 完全在对照组内进行。由于它就是 $1 - \\text{特异度}$，所以它具有相同的性质。FPR对疾病患病率是**不变的**。指标 $I_{\\text{假阳性率}}$ 为 $1$。\n\n-   **假阴性率, $P(T^-|D^+)$**：这个概率也是以事件 $D^+$ 为条件的。它的计算 $\\frac{FN}{TP+FN}$ 完全在病例组内进行。由于它就是 $1 - \\text{灵敏度}$，所以它也具有相同的性质。FNR对疾病患病率是**不变的**。指标 $I_{\\text{假阴性率}}$ 为 $1$。\n\n总之，所有四个指标——灵敏度、特异度、假阳性率和假阴性率——都是由基于真实疾病状态的条件概率定义的。病例对照研究设计之所以能够直接估计这些量，正是因为它从患病和非患病的独立分层中抽样。这些指标是检测方法本身的属性，而不是其使用人群的属性。相比之下，像阳性预测值（$PPV = P(D^+|T^+)$）和阴性预测值（$NPV = P(D^-|T^-)$）这样的指标，通过Bayes' theorem，严重依赖于患病率 $\\pi = P(D^+)$，并且在没有 $\\pi$ 的外部知识的情况下，无法从病例对照研究中直接估计。\n\n计算出的值及其不变性指标如下：\n- 灵敏度：$\\frac{4}{5}$，不变（$I=1$）\n- 特异度：$\\frac{61}{70}$，不变（$I=1$）\n- 假阳性率：$\\frac{9}{70}$，不变（$I=1$）\n- 假阴性率：$\\frac{1}{5}$，不变（$I=1$）\n\n最终答案按指定顺序以单行矩阵形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{5} & \\frac{61}{70} & \\frac{9}{70} & \\frac{1}{5} & 1 & 1 & 1 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "简单的二元输出是一个很好的起点，但大多数现代基因组分类器会输出一个反映疾病可能性的连续分数。本练习将超越2x2列联表，展示如何通过构建受试者工作特征（ROC）曲线来评估这类测试在所有可能阈值下的性能 。通过计算曲线下面积（AUC），您将学习如何得出一个单一且强大的指标，以概括测试的整体区分能力。",
            "id": "4332613",
            "problem": "用于精准肿瘤学的一种基因组分类器为每个个体输出一个连续的诊断评分。考虑一个评估队列，其中有 $n_{D} = 4$ 个疾病病例和 $n_{N} = 4$ 个非患病对照。观察到的分类器评分如下：疾病病例的评分为 $[0.95, 0.81, 0.77, 0.62]$，非患病对照的评分为 $[0.83, 0.79, 0.70, 0.40]$。使用决策规则“如果评分大于或等于阈值 $\\tau$，则预测为疾病”，并通过在观察到的评分范围内变动 $\\tau$ 来构建经验受试者工作特征（ROC）曲线。ROC 曲线描绘了当 $\\tau$ 变化时，真阳性率（TPR）与假阳性率（FPR）之间的关系。\n\n从第一性原理出发，使用灵敏度和特异度作为条件概率的经典定义，来推导通过对有限样本进行阈值处理而产生的经验 ROC 点。明确指出不同疾病状态的评分之间的任何相同值（ties），并解释在有限样本中必须如何处理这些相同值，以生成一个定义明确的经验 ROC 曲线和曲线下面积。然后，使用与决策规则引起的分步变化一致的阈值扫描方法，并通过沿 FPR 轴的几何上合理的积分，计算 ROC 的经验曲线下面积（AUC）。\n\n将最终的 AUC 四舍五入到 $4$ 位有效数字，并以小数形式表示，不带百分号。",
            "solution": "该问题要求根据一组来自患病和非患病个体队列的诊断评分，构建受试者工作特征（ROC）曲线并计算曲线下面积（AUC）。\n\n### 步骤 1：问题验证\n\n问题给出了以下已知条件：\n-   疾病病例数：$n_{D} = 4$。\n-   疾病病例的评分：$[0.95, 0.81, 0.77, 0.62]$。\n-   非患病对照数：$n_{N} = 4$。\n-   非患病对照的评分：$[0.83, 0.79, 0.70, 0.40]$。\n-   决策规则：如果评分 $\\ge \\tau$，则预测为疾病。\n\n问题要求：\n1.  通过改变阈值 $\\tau$ 构建经验 ROC 曲线。\n2.  解释如何处理评分相同的情况。\n3.  使用沿假阳性率（FPR）轴的几何积分计算经验 AUC。\n4.  将最终的 AUC 四舍五入到 4 位有效数字。\n\n该问题在科学上基于用于诊断测试评估的、公认的 ROC 分析统计方法。问题陈述清晰，所有必要数据均已提供，且无矛盾之处。任务是客观的，需要进行标准的、可验证的计算。因此，该问题被认为是**有效的**。\n\n### 步骤 2：理论框架\n\n设 $S$ 为诊断评分。设 $D$ 表示患病状态，$N$ 表示未患病状态。决策规则将评分 $S$ 大于或等于阈值 $\\tau$ 的个体分类为阳性（$T+$），否则为阴性（$T-$）。\n\nROC 曲线的两个关键性能指标是真阳性率（TPR）和假阳性率（FPR）。\n\n-   **真阳性率（TPR）**，或称灵敏度（sensitivity），是在患病人群中做出正确阳性预测的概率：$TPR(\\tau) = P(S \\ge \\tau | D)$。\n-   **假阳性率（FPR）**是在非患病人群中做出错误阳性预测的概率：$FPR(\\tau) = P(S \\ge \\tau | N)$。请注意，特异度（Specificity）是 $1 - FPR(\\tau)$。\n\n对于有限样本，这些概率通过比例来估计：\n$$TPR(\\tau) = \\frac{\\text{评分为 } \\ge \\tau \\text{ 的疾病个体数}}{n_D} = \\frac{TP(\\tau)}{n_D}$$\n$$FPR(\\tau) = \\frac{\\text{评分为 } \\ge \\tau \\text{ 的非疾病个体数}}{n_N} = \\frac{FP(\\tau)}{n_N}$$\n其中，$TP(\\tau)$ 和 $FP(\\tau)$ 分别是在阈值 $\\tau$ 下的真阳性（true positives）和假阳性（false positives）计数。\n\n### 步骤 3：经验 ROC 曲线的构建\n\n经验 ROC 曲线是通过为每个可能的阈值计算 $(FPR, TPR)$ 对来构建的。在有限样本中，相关阈值的集合由数据中存在的唯一评分值组成。为了构建曲线，我们可以将阈值 $\\tau$ 从高于最高分的值扫描到低于最低分的值。\n\n给定的评分为：\n-   患病者 ($S_D$)：$\\{0.95, 0.81, 0.77, 0.62\\}$\n-   非患病者 ($S_N$)：$\\{0.83, 0.79, 0.70, 0.40\\}$\n\n我们将所有评分合并并按降序排序，同时记下每个评分的类别：\n$0.95 (D), 0.83 (N), 0.81 (D), 0.79 (N), 0.77 (D), 0.70 (N), 0.62 (D), 0.40 (N)$。\n\n现在，我们改变阈值 $\\tau$ 并计算 $TP$ 和 $FP$ 的累积计数，以及相应的比率 $TPR$ 和 $FPR$。ROC 曲线始于 $(0,0)$（对于 $\\tau > \\max(S)$）并终于 $(1,1)$（对于 $\\tau \\le \\min(S)$）。\n\n1.  **起始点：** 对于任何 $\\tau > 0.95$，没有评分 $\\ge \\tau$。所以，$TP=0, FP=0$。这给出了点 $(FPR, TPR) = (0/4, 0/4) = (0, 0)$。\n\n2.  **阈值 $\\tau$ 越过 $0.95$ (D)：** 对于 $0.83  \\tau \\le 0.95$，一个疾病病例的评分 $\\ge \\tau$。$TP=1, FP=0$。这给出了点 $(0/4, 1/4) = (0, 0.25)$。曲线从 $(0,0)$ 向上移动到 $(0,0.25)$。\n\n3.  **阈值 $\\tau$ 越过 $0.83$ (N)：** 对于 $0.81  \\tau \\le 0.83$，一个疾病病例和一个非患病对照的评分 $\\ge \\tau$。$TP=1, FP=1$。这给出了点 $(1/4, 1/4) = (0.25, 0.25)$。曲线从 $(0,0.25)$ 向右移动到 $(0.25,0.25)$。\n\n4.  **阈值 $\\tau$ 越过 $0.81$ (D)：** 对于 $0.79  \\tau \\le 0.81$，$TP=2, FP=1$。点：$(1/4, 2/4) = (0.25, 0.5)$。\n\n5.  **阈值 $\\tau$ 越过 $0.79$ (N)：** 对于 $0.77  \\tau \\le 0.79$，$TP=2, FP=2$。点：$(2/4, 2/4) = (0.5, 0.5)$。\n\n6.  **阈值 $\\tau$ 越过 $0.77$ (D)：** 对于 $0.70  \\tau \\le 0.77$，$TP=3, FP=2$。点：$(2/4, 3/4) = (0.5, 0.75)$。\n\n7.  **阈值 $\\tau$ 越过 $0.70$ (N)：** 对于 $0.62  \\tau \\le 0.70$，$TP=3, FP=3$。点：$(3/4, 3/4) = (0.75, 0.75)$。\n\n8.  **阈值 $\\tau$ 越过 $0.62$ (D)：** 对于 $0.40  \\tau \\le 0.62$，$TP=4, FP=3$。点：$(3/4, 4/4) = (0.75, 1.0)$。\n\n9.  **阈值 $\\tau$ 越过 $0.40$ (N)：** 对于 $\\tau \\le 0.40$，所有评分都 $\\ge \\tau$。$TP=4, FP=4$。点：$(4/4, 4/4) = (1.0, 1.0)$。\n\n经验 ROC 曲线的顶点是以下点序列：\n$P_0=(0, 0)$, $P_1=(0, 0.25)$, $P_2=(0.25, 0.25)$, $P_3=(0.25, 0.5)$, $P_4=(0.5, 0.5)$, $P_5=(0.5, 0.75)$, $P_6=(0.75, 0.75)$, $P_7=(0.75, 1.0)$, $P_8=(1.0, 1.0)$。\n\n### 步骤 4：处理评分相同的情况\n\n问题要求解释如何处理评分相同的情况。首先，我们注意到在给定的数据集中，疾病个体和非疾病个体之间没有相同的评分，两个组内部也没有。所有 $n_D + n_N = 8$ 个评分都是唯一的。\n\n在存在相同值的一般情况下，假设一个评价值 $s^*$ 被 $k_D$ 个疾病个体和 $k_N$ 个非疾病个体共享。当决策阈值 $\\tau$ 降低到 $s^*$ 以下时，所有这些个体都同时被重新分类为阳性。这会导致真阳性计数一步增加 $k_D$，假阳性计数一步增加 $k_N$。\n\n如果在此阈值之前的 ROC 曲线上一点是 $(FPR_{i-1}, TPR_{i-1})$，那么新的点将变为：\n$$FPR_i = FPR_{i-1} + \\frac{k_N}{n_N}$$\n$$TPR_i = TPR_{i-1} + \\frac{k_D}{n_D}$$\n这会在 ROC 图上产生一条连接 $(FPR_{i-1}, TPR_{i-1})$ 和 $(FPR_i, TPR_i)$ 的对角线段。此过程确保了 ROC 曲线及其面积是明确定义的。\n\n### 步骤 5：AUC 计算\n\n曲线下面积（AUC）是 ROC 函数 $TPR(FPR)$ 从 $FPR=0$ 到 $FPR=1$ 的积分。对于由一组顶点 $(x_i, y_i) = (FPR_i, TPR_i)$ 定义的经验 ROC 曲线，AUC 可以通过对每个连续顶点对与 FPR 轴形成的梯形面积求和来计算。具有顶点 $(x_{i-1}, y_{i-1})$ 和 $(x_i, y_i)$ 的梯形的面积由以下公式给出：\n$$Area_i = \\frac{y_{i-1} + y_i}{2} (x_i - x_{i-1})$$\n总 AUC 是曲线上所有线段面积的总和。使用上面推导出的顶点 $P_0, \\dots, P_8$：\n\n-   线段 $P_0 \\to P_1$：$x_0=0, y_0=0$; $x_1=0, y_1=0.25$。面积 = $\\frac{0+0.25}{2}(0-0) = 0$。\n-   线段 $P_1 \\to P_2$：$x_1=0, y_1=0.25$; $x_2=0.25, y_2=0.25$。面积 = $\\frac{0.25+0.25}{2}(0.25-0) = 0.25 \\times 0.25 = 0.0625$。\n-   线段 $P_2 \\to P_3$：$x_2=0.25, y_2=0.25$; $x_3=0.25, y_3=0.5$。面积 = $\\frac{0.25+0.5}{2}(0.25-0.25) = 0$。\n-   线段 $P_3 \\to P_4$：$x_3=0.25, y_3=0.5$; $x_4=0.5, y_4=0.5$。面积 = $\\frac{0.5+0.5}{2}(0.5-0.25) = 0.5 \\times 0.25 = 0.125$。\n-   线段 $P_4 \\to P_5$：$x_4=0.5, y_4=0.5$; $x_5=0.5, y_5=0.75$。面积 = $\\frac{0.5+0.75}{2}(0.5-0.5) = 0$。\n-   线段 $P_5 \\to P_6$：$x_5=0.5, y_5=0.75$; $x_6=0.75, y_6=0.75$。面积 = $\\frac{0.75+0.75}{2}(0.75-0.5) = 0.75 \\times 0.25 = 0.1875$。\n-   线段 $P_6 \\to P_7$：$x_6=0.75, y_6=0.75$; $x_7=0.75, y_7=1.0$。面积 = $\\frac{0.75+1.0}{2}(0.75-0.75) = 0$。\n-   线段 $P_7 \\to P_8$：$x_7=0.75, y_7=1.0$; $x_8=1.0, y_8=1.0$。面积 = $\\frac{1.0+1.0}{2}(1.0-0.75) = 1.0 \\times 0.25 = 0.25$。\n\n总 AUC 是非零面积分量的总和：\n$$AUC = 0.0625 + 0.125 + 0.1875 + 0.25 = 0.625$$\n问题要求答案四舍五入到 4 位有效数字。\n$$AUC = 0.6250$$",
            "answer": "$$\\boxed{0.6250}$$"
        },
        {
            "introduction": "高AUC通常被认为是优秀分类器的黄金标准，但这足够吗？这个高级练习探讨了模型正确排序患者的能力（区分度，由AUC衡量）和其提供准确风险概率的能力（校准度）之间的关键区别 。通过一个精心设计的假设情景，您将发现一个模型可以具有出色的区分度但校准度却很差，这对于在临床决策中应用预测模型是一个至关重要的见解。",
            "id": "4332632",
            "problem": "一家精准肿瘤学实验室部署了一个二元基因组分类器，根据游离DNA（cell-free DNA）特征对患者进行分流以进行靶向治疗。对于每位患者 $i$，该分类器会生成一个实值对数几率分数 $s_i \\in \\mathbb{R}$，并以logistic变换 $\\hat{p}(s_i) = \\sigma(s_i)$ 的形式报告可干预疾病的风险，其中 $\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$。假设数据生成机制使得在给定 $s$ 的条件下，疾病的真实条件概率为 $\\Pr(Y=1 \\mid s) = \\sigma(s)$，因此原始模型是完美校准的。\n\n为了研究诊断测试性能中区分度（discrimination）和校准度（calibration）之间的区别，该团队部署了一个修改后的模型，该模型将对数几率（logits）乘以一个常数因子 $c0$，报告的风险为 $\\hat{p}_c(s) = \\sigma(c s)$。\n\n从基本定义出发：\n- 受试者工作特征（ROC）曲线下面积（AUC）定义为 $\\mathrm{AUC} = \\Pr\\big(S^{+}  S^{-}\\big)$，其中 $S^{+}$ 和 $S^{-}$ 分别表示从阳性（positive）和阴性（negative）群体中独立抽取的得分。\n- 如果一个模型的预测概率几乎必然地等于真实条件概率，则该模型是完美校准的。校准度的一个常用诊断指标是校准斜率，其定义为在使用模型的预测对数几率 $\\ell = \\ln\\left(\\frac{\\hat{p}}{1 - \\hat{p}}\\right)$ 对结果 $Y$ 进行拟合的logistic再校准模型 $\\Pr(Y=1 \\mid \\ell) = \\sigma(\\alpha + \\beta \\ell)$ 中的系数 $\\beta$。\n\n你的任务有两项。首先，从基本原理出发，解释为什么一个模型可以有很高的 $\\mathrm{AUC}$（即强区分度）但校准度却很差，并用一个合成示例来说明，将对数几率乘以因子 $c$ 会保持区分度但损害校准度。其次，在给定的数据生成机制 $\\Pr(Y=1 \\mid s) = \\sigma(s)$ 下，以 $c$ 的函数形式，确定缩放后模型 $\\hat{p}_c(s) = \\sigma(c s)$ 的校准斜率 $\\beta(c)$ 的闭式解，然后计算该表达式在 $c = 3$ 时的值。只报告 $c = 3$ 时的最终值。不包含任何单位。如果需要近似，则将答案四舍五入到四位有效数字；否则，给出精确值。",
            "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n- 一个二元基因组分类器为每位患者 $i$ 生成一个实值对数几率分数 $s_i \\in \\mathbb{R}$。\n- 原始模型的风险预测为 $\\hat{p}(s_i) = \\sigma(s_i)$，其中 $\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$ 是 logistic sigmoid 函数。\n- 给定分数 $s$ 时，疾病（阳性类别 $Y=1$）的真实条件概率为 $\\Pr(Y=1 \\mid s) = \\sigma(s)$。这意味着原始模型是完美校准的。\n- 一个修改后的模型将对数几率乘以一个常数因子 $c0$，报告新的风险分数为 $\\hat{p}_c(s) = \\sigma(c s)$。\n- ROC曲线下面积（AUC）定义为 $\\mathrm{AUC} = \\Pr\\big(S^{+}  S^{-}\\big)$，其中 $S^{+}$ 和 $S^{-}$ 分别是从阳性（$Y=1$）和阴性（$Y=0$）群体中独立抽取的得分。\n- 如果一个模型的预测概率几乎必然地等于真实条件概率，那么该模型就是完美校准的。\n- 校准斜率是在 logistic 再校准模型 $\\Pr(Y=1 \\mid \\ell) = \\sigma(\\alpha + \\beta \\ell)$ 中的系数 $\\beta$，其中 $\\ell = \\ln\\left(\\frac{\\hat{p}}{1 - \\hat{p}}\\right)$ 是模型的预测对数几率。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：问题陈述牢固地植根于诊断测试评估的既定统计理论。AUC（区分度）、校准度、logistic变换和校准斜率等概念是机器学习和生物统计学中标准的、定义明确的度量标准。该设定代表了一个有效的理论练习，用以探究这些概念之间的关系。\n- **良构性**：该问题是良构的。它提供了所有必要的定义和条件，并且任务以数学精度进行了规定。关于真实数据生成过程的假设 $\\Pr(Y=1 \\mid s) = \\sigma(s)$ 提供了一个清晰的基准事实，可以据此评估修改后的模型。\n- **客观性**：问题以客观的数学语言陈述，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。这是诊断模型评估领域中一个合理且定义明确的问题。将提供完整的解答。\n\n### 解答\n\n根据要求，解答分为两部分：解释区分度与校准度之间的区别，以及推导缩放后模型的校准斜率。\n\n#### 第1部分：区分度（AUC）与校准度\n\n区分度和校准度是概率分类器性能的两个不同且通常独立的方面。\n\n**区分度**指模型区分阳性类别和阴性类别的能力。它衡量模型是否为阳性实例分配比阴性实例更高的分数。受试者工作特征（ROC）曲线下面积（AUC）是区分度的标准度量。它定义为随机选择的阳性实例得分高于随机选择的阴性实例的概率：$\\mathrm{AUC} = \\Pr(S^{+}  S^{-})$。关键在于，$\\mathrm{AUC}$ 仅取决于分数的**排序**。任何对分数进行的严格单调递增变换（例如，乘以一个正常数 $c$）都不会改变分数的相对顺序，因此也不会改变 AUC。在我们的例子中，从分数 $s$ 到 $cs$ 的变换是严格单调的（因为 $c > 0$），所以修改后的模型的 AUC 与原始模型完全相同。\n\n**校准度**则指模型预测的概率与真实事件发生频率的吻合程度。一个完美校准的模型，其预测的 30% 风险应该对应于该类事件的实际发生率为 30%。当我们将原始对数几率 $s$ 乘以因子 $c \\neq 1$ 时，预测的概率 $\\hat{p}_c(s) = \\sigma(cs)$ 将不再等于真实概率 $\\Pr(Y=1 \\mid s) = \\sigma(s)$。因此，校准度被破坏了。例如，如果 $c > 1$，模型会变得“过于自信”，其预测的概率会比真实概率更极端（更接近0或1）。如果 $0  c  1$，模型会变得“信心不足”。\n\n因此，一个模型（如我们的修改后模型，当 $c$ 很大时）可以具有完美的 AUC（如果原始模型是完美的），因为它完美地区分了病例，但其校准度却很差，因为它提供的概率值与现实不符。\n\n#### 第2部分：校准斜率的推导\n\n我们寻求在以下 logistic 再校准模型中 $\\beta$ 的值：\n$$ \\Pr(Y=1 \\mid \\ell_c) = \\sigma(\\alpha + \\beta \\ell_c) $$\n其中 $\\ell_c$ 是修改后模型的预测对数几率。\n根据定义，$\\hat{p}_c(s) = \\sigma(cs)$。因此，预测的对数几率为：\n$$ \\ell_c = \\ln\\left(\\frac{\\hat{p}_c(s)}{1 - \\hat{p}_c(s)}\\right) = \\ln\\left(\\frac{\\sigma(cs)}{1 - \\sigma(cs)}\\right) = cs $$\n我们已知该模型所处的数据生成机制是 $\\Pr(Y=1 \\mid s) = \\sigma(s)$。这意味着给定分数 $s$ 时，真实的条件对数几率为：\n$$ \\text{logit}(\\Pr(Y=1 \\mid s)) = \\ln\\left(\\frac{\\sigma(s)}{1 - \\sigma(s)}\\right) = s $$\n为了找到校准斜率，我们希望再校准模型尽可能地接近真实的数据生成过程。我们需要用 $\\ell_c$ 来表达真实的对数几率。从 $\\ell_c = cs$ 中，我们得到 $s = \\frac{\\ell_c}{c}$。\n因此，真实的对数几率可以表示为预测对数几率 $\\ell_c$ 的函数：\n$$ \\text{真实对数几率} = s = \\frac{1}{c} \\ell_c $$\n我们将这个真实关系与再校准模型 $\\alpha + \\beta \\ell_c$ 进行比较。为了使再校准模型完美地恢复真实概率，我们需要：\n$$ \\alpha + \\beta \\ell_c = \\frac{1}{c} \\ell_c $$\n通过匹配系数，我们发现理想的校准参数是 $\\alpha = 0$ 和 $\\beta = \\frac{1}{c}$。因此，校准斜率是 $\\beta(c) = \\frac{1}{c}$。\n\n问题要求计算 $c=3$ 时的值。\n$$ \\beta(3) = \\frac{1}{3} $$\n这个值是一个精确的分数。",
            "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$"
        }
    ]
}