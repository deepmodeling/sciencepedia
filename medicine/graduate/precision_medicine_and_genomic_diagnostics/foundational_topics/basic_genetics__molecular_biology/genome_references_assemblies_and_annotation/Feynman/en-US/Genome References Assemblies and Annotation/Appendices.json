{
    "hands_on_practices": [
        {
            "introduction": "The quality of a genome assembly is the bedrock upon which all subsequent genomic analyses are built. Since assemblies are constructed from smaller sequencing reads, they are often fragmented into scaffolds of varying lengths. This exercise provides a practical method for quantifying assembly contiguity by calculating the standard metrics $N50$ and $L50$, allowing you to assess improvements in assembly quality based on concrete, albeit hypothetical, data .",
            "id": "4346192",
            "problem": "A clinical genomics team is assembling a personalized reference for a structurally complex pharmacogenomics locus to support variant interpretation in a precision oncology workflow. Two draft assemblies are available for the locus: a pre-polishing assembly and a post-polishing assembly. In this context, contiguity metrics such as $N50$ and $L50$ are used to summarize assembly continuity based on scaffold lengths. Use the standard definitions grounded in assembly contiguity: sort scaffold lengths in non-increasing order, let the total assembled length be $T$, and let $T/2$ be the half-length threshold. The $L50$ is the smallest number of top-ranked scaffolds whose cumulative length is at least $T/2$, and the $N50$ is the length of the scaffold at that $L50$-th rank. These are widely used, well-tested metrics in genome assembly evaluation.\n\nYou are given the scaffold lengths (in kilobases, kb), unsorted, for each assembly:\n\n- Pre-polishing assembly (there are $15$ scaffolds): $590$, $710$, $350$, $300$, $400$, $950$, $600$, $150$, $720$, $250$, $480$, $880$, $520$, $380$, $200$.\n- Post-polishing assembly (there are $12$ scaffolds): $500$, $400$, $250$, $1400$, $600$, $1000$, $900$, $450$, $200$, $350$, $800$, $300$.\n\nTasks:\n- Using the core definition of $N50$ and $L50$, compute $N50$ and $L50$ for both the pre-polishing and post-polishing assemblies.\n- Based on these values and the definition of these metrics, reason whether the post-polishing assembly reflects an improvement or regression in contiguity and explain why, noting any caveats relevant to clinical-grade assemblies (e.g., base accuracy and structural correctness).\n- Define the dimensionless contiguity improvement index\n$$\nR \\equiv \\left(\\frac{N50_{\\text{post}}}{N50_{\\text{pre}}}\\right)\\left(\\frac{L50_{\\text{pre}}}{L50_{\\text{post}}}\\right).\n$$\nReport the value of $R$ as the final answer, rounded to four significant figures. Express the final answer as a unitless quantity. Do not include units in your final numeric answer.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides all necessary data and definitions for a unique solution. The concepts of genome assembly, contiguity, $N50$, and $L50$ are standard in genomics and bioinformatics.\n\nThe solution proceeds in three parts: first, we calculate the $N50$ and $L50$ metrics for the pre-polishing assembly; second, we do the same for the post-polishing assembly; and third, we compare the metrics, interpret the results, and compute the contiguity improvement index $R$.\n\n**Part 1: Analysis of the Pre-polishing Assembly**\n\nThe provided scaffold lengths for the pre-polishing assembly are (in kilobases, kb): $590$, $710$, $350$, $300$, $400$, $950$, $600$, $150$, $720$, $250$, $480$, $880$, $520$, $380$, $200$. There are $n_{\\text{pre}} = 15$ scaffolds.\n\nFirst, we sort these lengths in non-increasing (descending) order:\n$950, 880, 720, 710, 600, 590, 520, 480, 400, 380, 350, 300, 250, 200, 150$.\n\nNext, we calculate the total assembled length, $T_{\\text{pre}}$:\n$$ T_{\\text{pre}} = 950 + 880 + 720 + 710 + 600 + 590 + 520 + 480 + 400 + 380 + 350 + 300 + 250 + 200 + 150 = 7480 \\text{ kb} $$\nThe half-length threshold is $T_{\\text{pre}}/2$:\n$$ \\frac{T_{\\text{pre}}}{2} = \\frac{7480}{2} = 3740 \\text{ kb} $$\nNow, we find the smallest number of scaffolds whose cumulative length is at least $3740$ kb. We compute the cumulative sum of the sorted lengths:\n1. $950$\n2. $950 + 880 = 1830$\n3. $1830 + 720 = 2550$\n4. $2550 + 710 = 3260$\n5. $3260 + 600 = 3860$\n\nThe cumulative sum first exceeds the threshold of $3740$ kb with the inclusion of the 5th scaffold. Therefore, the $L50$ for the pre-polishing assembly is:\n$$ L50_{\\text{pre}} = 5 $$\nThe $N50$ is the length of this 5th scaffold in the sorted list.\n$$ N50_{\\text{pre}} = 600 \\text{ kb} $$\n\n**Part 2: Analysis of the Post-polishing Assembly**\n\nThe provided scaffold lengths for the post-polishing assembly are (in kb): $500$, $400$, $250$, $1400$, $600$, $1000$, $900$, $450$, $200$, $350$, $800$, $300$. There are $n_{\\text{post}} = 12$ scaffolds.\n\nWe sort these lengths in non-increasing order:\n$1400, 1000, 900, 800, 600, 500, 450, 400, 350, 300, 250, 200$.\n\nThe total assembled length, $T_{\\text{post}}$, is:\n$$ T_{\\text{post}} = 1400 + 1000 + 900 + 800 + 600 + 500 + 450 + 400 + 350 + 300 + 250 + 200 = 7150 \\text{ kb} $$\nThe half-length threshold is $T_{\\text{post}}/2$:\n$$ \\frac{T_{\\text{post}}}{2} = \\frac{7150}{2} = 3575 \\text{ kb} $$\nWe compute the cumulative sum of the sorted lengths to find the $L50$:\n1. $1400$\n2. $1400 + 1000 = 2400$\n3. $2400 + 900 = 3300$\n4. $3300 + 800 = 4100$\n\nThe cumulative sum first exceeds the threshold of $3575$ kb with the inclusion of the 4th scaffold. Thus, the $L50$ for the post-polishing assembly is:\n$$ L50_{\\text{post}} = 4 $$\nThe $N50$ is the length of this 4th scaffold.\n$$ N50_{\\text{post}} = 800 \\text{ kb} $$\n\n**Part 3: Interpretation and Calculation of R**\n\nWe summarize the computed metrics:\n- Pre-polishing: $L50_{\\text{pre}} = 5$, $N50_{\\text{pre}} = 600$ kb.\n- Post-polishing: $L50_{\\text{post}} = 4$, $N50_{\\text{post}} = 800$ kb.\n\nImprovement in assembly contiguity is indicated by a higher $N50$ value and a lower $L50$ value. The $N50$ increased from $600$ kb to $800$ kb, and the $L50$ decreased from $5$ to $4$. Both changes signify that the post-polishing assembly is more continuous (less fragmented) than the pre-polishing one. A higher $N50$ means that half of the assembly is contained in scaffolds of at least $800$ kb, a significant improvement. A lower $L50$ means fewer scaffolds are needed to cover that same half, indicating that the scaffolds are, on average, longer. This suggests the polishing process successfully joined previously separate scaffolds.\n\nHowever, for a clinical-grade assembly, contiguity is not the only measure of quality. The term \"polishing\" implies the correction of base-level errors (e.g., single nucleotide variants and small indels), which improves sequence accuracy. These contiguity metrics do not measure base accuracy. Furthermore, joining scaffolds might introduce new, larger-scale structural errors (misassemblies), which could be detrimental to variant interpretation in oncology. Also, the total assembly length decreased from $7480$ kb to $7150$ kb, which would require further investigation to ensure no critical genomic regions were lost. Therefore, while the metrics suggest an improvement in contiguity, a full validation of a clinical-grade assembly would require orthogonal methods to assess base accuracy, structural correctness, and completeness.\n\nFinally, we calculate the dimensionless contiguity improvement index $R$:\n$$ R \\equiv \\left(\\frac{N50_{\\text{post}}}{N50_{\\text{pre}}}\\right)\\left(\\frac{L50_{\\text{pre}}}{L50_{\\text{post}}}\\right) $$\nSubstituting the calculated values:\n$$ R = \\left(\\frac{800}{600}\\right)\\left(\\frac{5}{4}\\right) = \\left(\\frac{4}{3}\\right)\\left(\\frac{5}{4}\\right) = \\frac{20}{12} = \\frac{5}{3} $$\nAs a decimal, $R = 1.6666...$. Rounding to four significant figures gives $1.667$.",
            "answer": "$$\\boxed{1.667}$$"
        },
        {
            "introduction": "Accurately describing a genetic variant is a prerequisite for its interpretation, yet this task is complicated by repetitive sequences and differing conventions. This practice problem delves into the crucial process of variant normalization and the conversion between transcript-based ($c.$) and genome-based ($g.$) coordinates . Mastering this skill is essential for ensuring that variant data remains unambiguous and interoperable across different diagnostic pipelines.",
            "id": "4346162",
            "problem": "A clinical variant interpretation pipeline must interconvert transcript-level Human Genome Variation Society (HGVS) coding DNA sequence (c.) descriptions and genome-level (g.) coordinates on the Genome Reference Consortium Human Build 38 (GRCh38). The pipeline uses a normalization policy that resolves insertions occurring within short tandem repeats to the leftmost equivalent representation on the transcript sequence and, when the inserted sequence is identical to adjacent reference sequence, prefers a duplication (“dup”) description over an insertion (“ins”). This policy is chosen to harmonize with left-aligned normalization used in certain variant catalogs, even though the canonical HGVS “most 3′” rule differs; you must follow the stated policy in this problem.\n\nConsider a gene located on chromosome $5$ in GRCh38 on the forward strand. Its coding sequence (CDS) starts at the first base of exon $1$, so that the HGVS coding position $c.1$ is the first nucleotide of exon $1$. The gene has three exons:\n\n- Exon $1$: genomic coordinates $g = 1{,}000{,}100$ to $1{,}000{,}199$ (inclusive), length $L_1 = 100$.\n- Exon $2$: genomic coordinates $g = 1{,}001{,}000$ to $1{,}001{,}149$ (inclusive), length $L_2 = 150$.\n- Exon $3$: genomic coordinates $g = 1{,}002{,}000$ to $1{,}002{,}199$ (inclusive), length $L_3 = 200$.\n\nSplicing is canonical: the transcript is the concatenation of the exons in order, with no intronic sequence. Because $c.1$ is the first base of exon $1$, the HGVS coding positions span exon $1$ as $c.1$ through $c.100$, exon $2$ as $c.101$ through $c.250$, and exon $3$ as $c.251$ through $c.450$.\n\nWithin exon $2$, the first $12$ nucleotides of the exon (which correspond to transcript positions $c.101$ through $c.112$) are a repeated trinucleotide motif:\n$$\n\\text{exon 2 bases 1--12} = \\texttt{ATCATCATCATC}\n$$\nwhere bases $1$–$3$ of exon $2$ (i.e., positions $c.101$–$c.103$) are $\\texttt{ATC}$, bases $4$–$6$ (positions $c.104$–$c.106$) are $\\texttt{ATC}$, bases $7$–$9$ (positions $c.107$–$c.109$) are $\\texttt{ATC}$, and bases $10$–$12$ (positions $c.110$–$c.112$) are $\\texttt{ATC}$.\n\nA variant is initially described on the transcript as:\n$$\nc.110\\_111\\text{ins}\\,\\texttt{ATC}.\n$$\n\nUsing only the following foundational bases and rules:\n- Definition of HGVS coding sequence positions: $c.1$ is the first nucleotide of the CDS on the transcript; coding positions increase by $1$ along the $5'$ to $3'$ direction of the transcript.\n- The transcript sequence is the ordered concatenation of exons, with introns removed.\n- On the forward strand, the mapping from a coding position $c.n$ that lies within exon $i$ to a genomic coordinate $g$ is computed by adding to the exon’s genomic start the zero-based offset of $c.n$ within that exon.\n- The normalization policy in this problem: when an insertion occurs within a repeated motif and the inserted sequence equals the repeat unit, represent it as a duplication of the leftmost equivalent repeat unit on the transcript (i.e., choose the smallest $c.$ coordinates consistent with equivalence).\n\nDerive, from first principles, the leftmost normalized HGVS coding description for this event and then compute the genome-level duplication coordinates on GRCh38. Report as your final answer the genomic coordinate of the first base of the normalized duplication event (i.e., the lower genomic index of the two bases in the $g.$ “dup” interval) as an integer. No rounding is required; provide the exact integer value.",
            "solution": "We begin by restating the relevant definitions. Human Genome Variation Society (HGVS) coding sequence positions are defined such that $c.1$ is the first nucleotide of the coding sequence (CDS) on the transcript, and positions increase along the $5'$ to $3'$ direction. For a gene on the forward strand, the transcript is formed by concatenating exons in genomic order, and there is a direct mapping from a coding position within an exon to a genomic coordinate by adding the position’s offset within that exon to the exon’s genomic start.\n\nGiven three exons with lengths $L_1 = 100$, $L_2 = 150$, and $L_3 = 200$, and with $c.1$ at the first base of exon $1$, the coding position ranges are:\n- Exon $1$: $c.1$ through $c.100$.\n- Exon $2$: $c.101$ through $c.250$.\n- Exon $3$: $c.251$ through $c.450$.\n\nThe first $12$ bases of exon $2$ are $\\texttt{ATCATCATCATC}$, which can be partitioned into four consecutive $\\texttt{ATC}$ units:\n- Exon $2$ base $1$ ($c.101$) to base $3$ ($c.103$): $\\texttt{ATC}$.\n- Exon $2$ base $4$ ($c.104$) to base $6$ ($c.106$): $\\texttt{ATC}$.\n- Exon $2$ base $7$ ($c.107$) to base $9$ ($c.109$): $\\texttt{ATC}$.\n- Exon $2$ base $10$ ($c.110$) to base $12$ ($c.112$): $\\texttt{ATC}$.\n\nThe original variant description is $c.110\\_111\\text{ins}\\,\\texttt{ATC}$, indicating insertion of the trinucleotide $\\texttt{ATC}$ between positions $c.110$ and $c.111$. Because the local sequence is a repeated motif of $\\texttt{ATC}$, the inserted sequence equals the repeat unit that occurs immediately adjacent across multiple positions. Under the normalization policy specified for this problem, we must:\n1. Recognize that inserting $\\texttt{ATC}$ within a run of $\\texttt{ATC}$ repeats is equivalent to duplicating one of the existing $\\texttt{ATC}$ units.\n2. Choose the leftmost equivalent unit on the transcript to represent the event as a duplication (i.e., we should minimize the $c.$ interval).\n\nAmong the four $\\texttt{ATC}$ units spanning $c.101$–$c.103$, $c.104$–$c.106$, $c.107$–$c.109$, and $c.110$–$c.112$, the leftmost unit is the first one: $c.101$–$c.103$. Therefore, the normalized coding DNA description under the stated policy is:\n$$\nc.101\\_103\\text{dup}.\n$$\n\nWe now compute the genome-level (g.) coordinates of this duplication on GRCh38. The gene is on the forward strand, so mapping from $c.n$ to $g$ within an exon is a simple offset from the exon’s genomic start. Let the genomic start of exon $i$ be $G_i$ and its end be $H_i$, and let $c.n$ lie in exon $i$. Define the cumulative coding length before exon $i$ as $S_{i-1} = \\sum_{k=1}^{i-1} L_k$. The zero-based offset of $c.n$ within exon $i$ is:\n$$\n\\Delta = (n - S_{i-1}) - 1.\n$$\nThen the genomic coordinate is\n$$\ng = G_i + \\Delta.\n$$\n\nFor our duplication interval $c.101$–$c.103$, both positions lie in exon $2$. We have $G_2 = 1{,}001{,}000$ and $S_{1} = L_1 = 100$. Compute offsets:\n- For $c.101$: $n = 101$, so $\\Delta = (101 - 100) - 1 = 0$. Hence $g = 1{,}001{,}000 + 0 = 1{,}001{,}000$.\n- For $c.103$: $n = 103$, so $\\Delta = (103 - 100) - 1 = 2$. Hence $g = 1{,}001{,}000 + 2 = 1{,}001{,}002$.\n\nThus, the genome-level duplication interval is $g.1{,}001{,}000\\_1{,}001{,}002\\text{dup}$. The problem requests the genomic coordinate of the first base of the normalized duplication event (i.e., the lower genomic index). This is:\n$$\n1{,}001{,}000.\n$$\n\nTherefore, the final integer to report is $1{,}001{,}000$.",
            "answer": "$$\\boxed{1001000}$$"
        },
        {
            "introduction": "A single genomic variant's story does not end with its coordinates; its functional impact can vary dramatically depending on which transcript of a gene is expressed, a consequence of alternative splicing. This exercise simulates a real-world clinical scenario where you must determine a variant's impact on different transcripts and then synthesize these findings into a single, clinically relevant score . This moves beyond simple annotation to a more nuanced, quantitative assessment of a variant's potential pathogenicity.",
            "id": "4346191",
            "problem": "A laboratory investigating a clinically actionable missense change in a multi-transcript gene seeks a principled reconciliation of discordant amino acid consequences across transcripts when annotating on the Genome Reference Consortium Human Build 38 (GRCh38). Consider a hypothetical protein-coding gene, GENE-X, on the GRCh38 positive strand with three protein-coding transcripts: T1, T2, and T3. T1 is the canonical transcript per Matched Annotation from the National Center for Biotechnology Information (NCBI) and Ensembl (MANE) Select. A Single Nucleotide Variant (SNV) is observed at genomic coordinate $g = 12{,}345{,}678$ with reference base $C$ and alternate base $T$. All three transcripts include this position in-frame in their coding sequence. The codon context at this position differs across transcripts due to alternative splicing, but all codons are to be interpreted under the standard nuclear genetic code.\n\nFor each transcript, the codon containing the variant base (with the variant acting on the indicated codon position) is:\n\n- T1 (canonical): codon CCA with the variant at codon position $1$ changing $C \\rightarrow T$, yielding TCA.\n- T2 (non-canonical): codon CAG with the variant at codon position $1$ changing $C \\rightarrow T$, yielding TAG.\n- T3 (non-canonical): codon GCC with the variant at codon position $2$ changing $C \\rightarrow T$, yielding GTC.\n\nAssume no effect on splicing, no change to start codons, and that all three transcripts are otherwise fully protein-coding with the indicated reading frames.\n\nUsing foundational principles of the Central Dogma of Molecular Biology and the standard nuclear genetic code:\n1. Determine the amino acid change (original amino acid to new amino acid) for each transcript T1, T2, and T3.\n2. Classify each consequence as synonymous, missense, or nonsense (stop-gain).\n3. Define a three-level severity categorization for reconciliation: assign $0$ for synonymous, $1$ for missense, and $2$ for nonsense (stop-gain). The reconciled impact score is the expression-weighted average of these severities across transcripts, where the weights are the Transcripts Per Million (TPM) expression levels measured in the relevant clinical tissue. The TPMs are $w_{1} = 12$, $w_{2} = 3$, and $w_{3} = 5$ for T1, T2, and T3 respectively.\n\nCompute the reconciled impact score as a single real number. Round your answer to four significant figures. Express the final value as a pure number without any units.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a realistic scenario in clinical genomics, providing all necessary data and definitions for a unique and meaningful solution. The problem is free of contradictions, ambiguities, and factual errors.\n\nThe solution proceeds in three parts as requested: determining the amino acid consequence for each transcript, classifying the consequence, and computing a reconciled impact score.\n\n**Part 1: Determination of Amino Acid Changes**\n\nThe problem specifies a Single Nucleotide Variant (SNV) at a genomic position where the reference base is Cytosine ($C$) and the alternate base is Thymine ($T$). The gene is on the positive strand, so the provided codon sequences correspond to the DNA coding strand. To determine the amino acid, we must first transcribe these DNA codons into their corresponding mRNA codons, where Thymine ($T$) is replaced by Uracil ($U$), and then translate them using the standard nuclear genetic code.\n\nFor transcript T1 (canonical):\nThe reference DNA codon is $CCA$. The corresponding mRNA codon is $CCA$. According to the standard genetic code, $CCA$ codes for the amino acid Proline ($P$).\nThe variant results from a $C \\rightarrow T$ change at the first position of the codon, yielding the DNA codon $TCA$. The corresponding mRNA codon is $UCA$. According to the standard genetic code, $UCA$ codes for the amino acid Serine ($S$).\nThus, the consequence for T1 is a change from Proline to Serine, denoted as $P \\rightarrow S$.\n\nFor transcript T2 (non-canonical):\nThe reference DNA codon is $CAG$. The corresponding mRNA codon is $CAG$. According to the standard genetic code, $CAG$ codes for the amino acid Glutamine ($Q$).\nThe variant results from a $C \\rightarrow T$ change at the first position of the codon, yielding the DNA codon $TAG$. The corresponding mRNA codon is $UAG$. The $UAG$ codon is one of the three stop codons (specifically, the \"amber\" stop codon), which signals the termination of protein translation.\nThus, the consequence for T2 is a change from Glutamine to a stop codon, denoted as $Q \\rightarrow *$.\n\nFor transcript T3 (non-canonical):\nThe reference DNA codon is $GCC$. The corresponding mRNA codon is $GCC$. According to the standard genetic code, $GCC$ codes for the amino acid Alanine ($A$).\nThe variant results from a $C \\rightarrow T$ change at the second position of the codon, yielding the DNA codon $GTC$. The corresponding mRNA codon is $GUC$. According to the standard genetic code, $GUC$ codes for the amino acid Valine ($V$).\nThus, the consequence for T3 is a change from Alanine to Valine, denoted as $A \\rightarrow V$.\n\n**Part 2: Classification of Consequences**\n\nBased on the amino acid changes determined in Part 1, we classify each consequence.\n- T1 ($P \\rightarrow S$): This is a change from one amino acid to another. This is classified as a **missense** variant.\n- T2 ($Q \\rightarrow *$): This is a change from an amino acid to a premature stop codon. This is classified as a **nonsense** (or stop-gain) variant.\n- T3 ($A \\rightarrow V$): This is a change from one amino acid to another. This is classified as a **missense** variant.\n\n**Part 3: Computation of the Reconciled Impact Score**\n\nThe problem defines a three-level severity categorization and associated scores ($S_i$):\n- Synonymous: $S = 0$\n- Missense: $S = 1$\n- Nonsense (stop-gain): $S = 2$\n\nApplying this to our classifications from Part 2:\n- T1 (missense): The severity score is $S_1 = 1$.\n- T2 (nonsense): The severity score is $S_2 = 2$.\n- T3 (missense): The severity score is $S_3 = 1$.\n\nThe reconciled impact score, denoted $I$, is the expression-weighted average of these severities. The weights ($w_i$) are the Transcripts Per Million (TPM) values for each transcript:\n- $w_1 = 12$ for T1\n- $w_2 = 3$ for T2\n- $w_3 = 5$ for T3\n\nThe formula for the weighted average is:\n$$ I = \\frac{\\sum_{i=1}^{n} w_i S_i}{\\sum_{i=1}^{n} w_i} $$\nFor this problem with $n=3$ transcripts, the formula is:\n$$ I = \\frac{w_1 S_1 + w_2 S_2 + w_3 S_3}{w_1 + w_2 + w_3} $$\nSubstituting the given values for weights and the determined severity scores:\n$$ I = \\frac{(12)(1) + (3)(2) + (5)(1)}{12 + 3 + 5} $$\nCalculating the numerator:\n$$ 12 \\cdot 1 + 3 \\cdot 2 + 5 \\cdot 1 = 12 + 6 + 5 = 23 $$\nCalculating the denominator:\n$$ 12 + 3 + 5 = 20 $$\nThe reconciled impact score is the ratio:\n$$ I = \\frac{23}{20} = 1.15 $$\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $1.15$ has three significant figures. To express this with four significant figures, we append a trailing zero, yielding $1.150$.",
            "answer": "$$\\boxed{1.150}$$"
        }
    ]
}