## 引言
下一代测序（NGS）技术已成为生命科学研究和精准医学的基石，而文库制备作为其核心上游环节，其质量直接决定了最终测序数据的成败。这一过程将原始的[核酸](@entry_id:164998)样本转化为可在测序仪上进行高通量分析的结构化分子文库，但其间涉及复杂的[酶学](@entry_id:181455)反应和物理过程，每一个步骤都可能引入偏好和错误，从而影响研究结论的可靠性。许多研究人员和临床技术人员虽然熟悉操作流程，但对各步骤背后的深层原理及其对数据质量的定量影响缺乏系统性认知，这构成了理论与实践之间的关键知识鸿沟。

本文旨在弥合这一鸿沟，为读者构建一个关于[NGS文库制备](@entry_id:171227)策略的全面知识体系。我们将通过三个章节，带领您从基础原理走向前沿应用：第一章“原理与机制”将深入剖析文库构建各环节的分子生物学、化学及物理学基础，揭示偏好产生的根源；第二章“应用与跨学科交叉”将展示这些原理如何灵活应用于靶向测序、[单细胞分析](@entry_id:274805)、液体活检等不同场景；第三章“动手实践”则通过一系列计算问题，将理论知识转化为可量化的实践技能。通过本文的学习，您将不仅知其然，更知其所以然，从而能够更自信地设计、执行和解读NGS实验。

## 原理与机制

继前一章对下一代测序（NGS）工作流程的宏观介绍之后，本章将深入探讨测序文库制备的核心环节——将原始的DNA或RNA分子转化为可在测序仪上进行高通量分析的结构化分子的过程。文库制备的质量直接决定了测[序数](@entry_id:150084)据的准确性和可靠性，尤其是在要求定量精确的临床应用（如精准肿瘤学）中。本章将系统性地阐述文库构建各步骤背后的物理、化学及[酶学](@entry_id:181455)原理，并揭示可能引入偏好和错误的机制，为读者建立一个严谨而深入的知识框架。

### [DNA片段化](@entry_id:170520)：文库构建的第一步

测序文库的构建始于将长链的基因组DNA（gDNA）切割成特定长度范围的片段。片段化的均一性和[可控性](@entry_id:148402)对于后续步骤的效率以及测序覆盖度的均匀性至关重要。目前主流的片段化方法可分为两大类：物理方法和[酶学](@entry_id:181455)方法。

#### 机械片段化：声波聚焦技术

机械片段化，尤其是通过**自适应聚焦声波（Adaptive Focused Acoustics, AFA）**技术（如Covaris仪器），是一种广泛应用的物理方法。其核心机制并非简单的机械搅拌，而是利用高频声能在样本中诱导可控的**声波空化（acoustic cavitation）**现象。

该技术将聚焦的声波[能量传递](@entry_id:174809)到样本管中，能量在局部区域驱动微小气泡的振荡。这些振荡的物理过程可以分为两种模式：

1.  **稳定[空化](@entry_id:139719)（Stable Cavitation）**：在适度的声波压力下，气泡会稳定地周期性膨胀和收缩。这种振荡会在气泡周围产生强烈的微流（microstreaming），形成局部的高**剪切应力场（shear stress field）**。当DNA分子流经这些高剪切区域时，作用在分子上的[流体动力](@entry_id:750449)学剪切力会超过[磷酸二酯键](@entry_id:271137)的化学能垒，导致DNA双链随机断裂。这种断裂方式与DNA序列基本无关，因此产生的片段较为随机。

2.  **惯性[空化](@entry_id:139719)（Inertial Cavitation）**：当声波压力过高或能量注入时间过长（高占空比）时，气泡振荡会变得不稳定，最终在压缩相位发生剧烈的内爆式崩塌。这种崩塌会产生瞬时、极端的局部压力和温度，以及强大的冲击波。虽然惯性[空化](@entry_id:139719)也能打断DNA，但其过程高度随机且能量不均，容易产生非常短的片段（过度片段化），从而导致最终的片段大小分布变得更宽，这对于要求均一覆盖度的应用是不利的。

因此，为了获得特定目标尺寸（例如350 bp）且分布集中的DNA片段，必须精确调控AFA参数以主导稳定[空化](@entry_id:139719)，同时抑制惯性[空化](@entry_id:139719)。关键参数包括：
*   **峰值入射功率（Peak Incident Power, PIP）**：决定声波振幅。适度的功率足以产生稳定的微流剪切，而过高的功率则会诱发惯性空化。
*   **[占空比](@entry_id:199172)（Duty Factor）**：指声波“开启”时间占总处理时间的比例。低占空比（如5-20%）给予气泡在脉冲间隙恢复稳定振荡的时间，防止其过度生长至[不稳定状态](@entry_id:197287)。
*   **温度（Temperature）**：低温（如4-8°C）会增加样本[缓冲液](@entry_id:139484)的粘度，这有助于“阻尼”气泡壁的剧烈运动，进一步抑制惯性空化，使剪切场更加稳定和均一。同时，低温还能有效限制DNA的热损伤，如脱嘌呤。

通过优化这些参数，可以实现对[DNA片段化](@entry_id:170520)过程的精确控制，从而获得窄峰分布的DNA片段，这对于后续的全外显子或[全基因组测序](@entry_id:169777)至关重要 。

#### 酶学片段化

与物理方法不同，**酶学片段化（enzymatic fragmentation）**依赖于[生物催化剂](@entry_id:140501)。常用的酶包括非特异性[核酸](@entry_id:164998)内切酶或**[转座酶](@entry_id:273476)（transposases）**。这些酶能够识别并切割DNA双链上的磷酸二酯键。例如，基于[转座酶](@entry_id:273476)的“tagmentation”技术能同时完成DNA的片段化和接头序列的连接。

[酶学](@entry_id:181455)方法的优势在于操作简便、快速，且通常需要更少的起始DNA。然而，其主要缺点在于可能存在**序列偏好性（sequence context bias）**。许多DNA切割酶对特定的核苷酸序列或结构基序有或多或少的亲和力差异，这可能导致在基因组的某些区域切割效率更高，而在另一些区域效率更低，从而在最终的测序数据中引入覆盖度的偏好。此外，酶的活性严格依赖于温度和反应时间，需要精确控制以获得可重复的结果 。

### 片段末端的修复与修饰

无论是机械方法还是酶学方法，片段化过程往往会产生化学结构和物理形态各异的DNA末端。这些末端可能包括5'突出、3'突出、平末端、缺失5'磷酸基团的5'羟基末端，甚至由于氧化损伤产生的3'磷酸封闭末端。然而，标准的**连接反应（ligation）**需要[DNA连接酶](@entry_id:139273)（如T4 DNA Ligase）的底物是具有5'磷酸基团和3'羟基基团的**平末端（blunt end）**。因此，在连接接头之前，必须对这些异质性的末端进行修复和修饰。

这一过程被称为**末端修复（end repair）**，通常包含一组协同作用的酶学活性 ：

1.  **补平突出末端**：
    *   对于**5'突出**（即3'末端是凹陷的），需要利用具有**$5' \to 3'$聚合酶活性**的[DNA聚合酶](@entry_id:147287)，在dNTPs存在的情况下，以突出的5'单链为模板，将凹陷的3'末端延伸，形成平末端。
    *   对于**3'突出**，则需要利用具有**$3' \to 5'$外切[核酸](@entry_id:164998)酶活性**的酶，将3'端突出的单链[核苷](@entry_id:195320)酸“嚼回”，直至形成平末端。许多用于[分子克隆](@entry_id:189974)的[DNA聚合酶](@entry_id:147287)，如T4 [DNA聚合酶](@entry_id:147287)，同时具备这两种活性，使其成为末端修复的理想工具。

2.  **修[复化](@entry_id:260775)学末端**：
    *   对于缺失5'磷酸的**5'羟基末端**，需要使用**多聚[核苷](@entry_id:195320)酸激酶（Polynucleotide Kinase, PNK）**，它能将ATP的$\gamma$-磷酸基团转移到DNA的5'-OH上，生成连接反应所必需的5'-P。
    *   对于阻碍连接的**3'磷酸封闭末端**，需要具有**3'[磷酸酶](@entry_id:142277)活性**的酶将其去除，暴露出必需的3'-OH。值得注意的是，T4 PNK是一种多功能酶，除了其5'激[酶活性](@entry_id:143847)外，还天然具备3'-磷酸酶活性，因此它能一步完成两种化学末端的修复。

通过这一系列酶促反应，原本参差不齐的DNA片段群体被转化为化学和物理结构均一的、可高效进行下一步接头连接的底物。

#### A-Tailing：一种提升连接特异性的策略

作为平末端连接的替代方案，**A-tailing**策略被广泛采用以提高连接效率和特异性。在末端修复之后，使用一种不依赖模板的DNA聚合酶（如[Taq聚合酶](@entry_id:145833)的末端转移酶活性）在每个DNA片段的3'末端添加一个单一的腺嘌呤（A）[核苷](@entry_id:195320)酸。这样，所有的待测片段都带上了3'单A突出。相应地，所使用的测序接头则被设计成带有3'单[胸腺](@entry_id:183673)嘧啶（T）突出。

这种策略的巧妙之处在于，它利用了[沃森-克里克碱基配对](@entry_id:275890)的特异性来指导连接反应。从[热力学](@entry_id:172368)-动力学角度可以对其优势进行定量解释 。连接反应的速率$v$可以近似地认为与反应物浓度以及末端之间瞬时退火的平衡常数$K$成正比，即$v \propto K[\text{末端}_1][\text{末端}_2]$。而平衡常数$K$与末端配对的吉布斯自由能变$\Delta G$之间遵循关系$K = \exp(-\Delta G / (RT))$。

*   **期望的连接**：A尾片段与T尾接头之间的连接。其瞬时退火依赖于一个A-T配对，这是一个[热力学](@entry_id:172368)上有利的相互作用，具有负的自由能变$\Delta G_{\mathrm{AT}}$（例如，$-1.5 \, \text{kcal/mol}$）。这导致一个较大的[平衡常数](@entry_id:141040)$K_{\mathrm{AT}}$。
*   **不期望的连接**：片段与片段（A-A）或接头与接头（T-T）之间的自身连接。这些连接依赖于错配的单碱基退火，其自由能变$\Delta G_{\mathrm{mis}}$远不如匹配配对有利，通常是正值（例如，$\Delta G_{\mathrm{mis}} = +3.0 \, \text{kcal/mol}$），因此[平衡常数](@entry_id:141040)$K_{\mathrm{mis}}$非常小。

文库制备的**连接特异性（ligation specificity）**可以定义为期望[反应速率](@entry_id:185114)与非期望[反应速率](@entry_id:185114)总和之比。对于平末端连接，所有末端（片段-片段，接头-接头，片段-接头）之间的相互作用能可视为相同，因此特异性完全由反应物的浓度决定。然而，在A-T连接中，特异性还被一个[热力学因子](@entry_id:189257)$K_{\mathrm{AT}} / K_{\mathrm{mis}}$所放大。这个比值等于$\exp((\Delta G_{\mathrm{mis}} - \Delta G_{\mathrm{AT}}) / (RT))$。一个中等大小的自由能差异（例如$\Delta\Delta G = 4.5 \, \text{kcal/mol}$）可以被指数放大，导致特异性成千上万倍的提升。这就是A-tailing策略能有效抑制片段自连和接头二聚体形成，从而显著提高文库构建效率的根本原因。

### 接头连接与文库结构

接头（Adapter）是人工合成的短DNA序列，其连接到片段化DNA的两端，赋予文库分子进行后续测序所必需的功能。

#### 经典[Illumina](@entry_id:201471)文库的结构

一个典型的用于[Illumina](@entry_id:201471)平台的双末端索引配对末端测序文库分子，其单链结构（以“[正向链](@entry_id:636985)”为例）从5'到3'端依次包含以下功能元件 ：

$$ 5' - (\text{P5}) - (\text{i5索引}) - (\text{R1PS}) - (\text{DNA插入片段}) - (\text{R2PS}) - (\text{i7索引}) - (\text{P7}) - 3' $$

*   **P5 和 P7 序列**：这是文库分子两端的“锚点”，其序列分别与测序芯片（Flow Cell）表面上共价连接的两种寡核苷酸（P5' 和 P7'）互补。这种互补配对是文库分子被捕获到芯片表面并进行**桥式PCR（bridge amplification）**扩[增形](@entry_id:273206)成克隆簇（cluster）的基础。
*   **测序引物结合位点（R1PS 和 R2PS）**：Read 1 Primer Site 和 Read 2 Primer Site 是分别用于测序插入片段两端（Read 1 和 Read 2）的引物结合的位点。
*   **索引序列（Index, i5 和 i7）**：也称为条形码（barcode），是长度为8-12个碱基的独特序列。在**多重测序（multiplexing）**中，不同的样本被标记上不同的索引组合。测序完成后，通过读取这些索引序列，可以将混合在一起的测序读长（reads）准确地分配回各自的原始样本。

#### 接头设计：Y形接头

为了高效地将包含不同功能元件的P5和P7端同时连接到平末端或A尾的DNA片段上，并最大程度地减少**接头二聚体（adapter dimers）**的形成，一种精巧的设计是**Y形接头（Y-shaped adapters）** 。

这种接头由两条部分互补的寡核苷酸退火而成。其中心区域是双链，可以与DNA片段的末端进行连接（例如，通过T-A配对）。然而，其两臂的序列（分别含有P5和P7序列）彼此不互补，因此形成两个单链的“臂”，整体结构呈“Y”字形。

这种设计的关键优势在于：
1.  **抑制接头二聚体**：由于两个Y形接头的单链臂彼此不互补，它们无法直接通过[连接酶](@entry_id:139297)相互连接形成接头二聚体。这大大减少了这种主要的副产物，提高了有效文库的产出。
2.  **定向连接**：连接反应后，每个DNA片段的一端连接了含有P5序列的臂，另一端连接了含有P7序列的臂。
3.  **兼容桥式扩增**：在变性后，文库分子成为单链。其末端的P5或P7序列可以与Flow Cell上对应的P5'或P7'寡[核苷](@entry_id:195320)酸互补结合，启动桥式PCR，最终形成包含[正向链](@entry_id:636985)和反向链的克隆簇。

### 纯化与尺寸选择

文库构建的每一步后，通常都需要纯化步骤以去除前一步反应的剩余成分（如酶、盐离子、dNTPs）以及副产物（如接头二聚体）。同时，为了获得特定长度范围的文库，还需要进行尺寸选择。

**固相可逆固定（Solid Phase Reversible Immobilization, SPRI）**磁珠技术是这一过程的金标准。该技术利用表面羧基化的顺磁性微球，在特定的化学条件下可逆地结合DNA。其尺寸选择的原理基于[聚合物物理学](@entry_id:145330)和静电学 。

该过程的核心是向DNA和磁珠的悬液中加入**聚乙二醇（PEG）**和**氯化钠（NaCl）**。

*   **PEG的作用**：PEG是一种高分子聚合物，它在溶液中会占据大量空间，形成一个“分子拥挤”的环境。这种拥挤效应对DNA分子产生一种称为**耗尽吸引（depletion attraction）**的熵驱动力。简单来说，将一个DNA分子（可视为一个柔性线圈）从PEG溶液中“排除”并吸附到磁珠表面，会为PEG分子释放出更多的可用空间，从而增加整个系统的熵。这种熵增带来的自由能降低（$-\Delta G_{\text{dep}}$）是驱动DNA结合的主要吸[引力](@entry_id:189550)。根据聚合物物理模型，这种吸[引力](@entry_id:189550)的大小与DNA分子的有效体积（与**[回转半径](@entry_id:154974) $R_g$** 的三次方成正比）和PEG溶液的[渗透压](@entry_id:141891)$\Pi$成正比。由于长链DNA具有更大的$R_g$，它们会经历更强的耗尽吸[引力](@entry_id:189550)，因此更容易被吸附。PEG浓度$\phi$越高，[渗透压](@entry_id:141891)$\Pi$越大，吸[引力](@entry_id:189550)也越强。

*   **NaCl的作用**：[DNA骨架](@entry_id:166241)和磁珠表面的[羧基](@entry_id:196503)都带有负电荷，彼此之间存在[静电排斥](@entry_id:162128)力，这阻碍了DNA的结合。NaCl作为[电解质](@entry_id:261072)，其阳离子（Na$^+$）会在带负电的表面周围形成一个离子云，有效地**屏蔽（screen）**了[静电排斥](@entry_id:162128)。这种[屏蔽效应](@entry_id:136974)的程度由**[德拜长度](@entry_id:147934)（Debye length, $\lambda_D$）**来表征，其与离子强度$I$的平方根成反比（$\lambda_D \propto I^{-1/2}$）。NaCl浓度越高，离子强度$I$越大，[德拜长度](@entry_id:147934)$\lambda_D$越短，[静电排斥](@entry_id:162128)被屏蔽得越彻底，DNA就越容易靠近并结合到磁珠表面。

DNA是否结合到磁珠上，取决于耗尽吸[引力](@entry_id:189550)与[静电排斥](@entry_id:162128)力之间的平衡。当净自由能变为负时，结合发生。这定义了一个**尺寸选择阈值（cutoff length, $L^*$）**：
*   **调节PEG浓度**：提高PEG浓度会增强吸[引力](@entry_id:189550)，使得更短的DNA分子也能克服排斥力而结合，从而**降低**尺寸选择阈值$L^*$。
*   **调节NaCl浓度**：提高NaCl浓度会减弱排斥力，同样使得更短的DNA分子也能结合，从而**降低**尺寸选择阈值$L^*$。

通过精确控制PEG和NaCl的浓度（通常通过调节SPRI磁珠与样本的体积比），研究人员可以进行精细的尺寸选择，例如，通过两轮纯化（一轮去除过大片段，一轮结合目标片段）来富集特定长度范围的文库分子。

### 文库扩增及其偏好

经过接头连接和纯化后，文库中目标分子的数量可能仍然很低，不足以进行高效测序。因此，通常需要通过**[聚合酶链式反应](@entry_id:142924)（PCR）**进行**文库扩增（library amplification）**，以指数方式增加文库分子的拷贝数。

然而，PCR扩增并非一个完美均一的过程。它会不可避免地引入偏好，改变文库中不同分子间的相对丰度，从而影响下游定量分析的准确性。主要的PCR偏好来源包括 ：

1.  **GC偏好（GC Bias）**：扩增效率与DNA片段的GC含量相关。GC含量极高（如 >70%）或极低（如  30%）的片段往往在文库中被低估。
    *   **高GC片段**：G-C碱基对由三个[氢键](@entry_id:136659)稳定，而A-T对只有两个，且G-C对之间的[碱基堆积](@entry_id:192819)作用更强。这导致高[GC含量](@entry_id:275315)的DNA双链具有更高的**熔解温度（$T_m$）**。在PCR的变性步骤中，如果设定的变性温度不足以完全解开这些高$T_m$的模板，它们将无法有效扩增。此外，富含GC的[单链DNA](@entry_id:162691)也更容易在退火或延伸温度下形成稳定的二级结构（如发夹），阻碍引物结合和聚合酶延伸。
    *   **低GC片段**：虽然变性更容易，但其过低的稳定性也可能在某些条件下影响扩增效率。

2.  **长度偏好（Length Preference）**：PCR聚合酶倾向于更有效地扩增较短的DNA片段。
    *   **动力学限制**：[DNA聚合酶](@entry_id:147287)具有一定的延伸速度$v$（例如，50 nt/s）。在PCR的延伸步骤，设定的延伸时间为$\tau$。只有当片段长度$L$满足$L \le v \times \tau$时，聚合酶才有足够的时间完成整条链的复制。对于长度超过$v \times \tau$的片段，每一轮都可能产生大量未完全延伸的产物，这些不完整的产物无法在下一[轮作](@entry_id:163653)为有效模板，导致长片段的有效扩增效率显著低于短片段。

3.  **[嵌合体](@entry_id:264354)形成（Chimera Formation）**：在PCR[后期](@entry_id:165003)，当产物浓度非常高时，可能会形成嵌合体分子。
    *   **模板跳跃机制**：当聚合酶从一个模板上延伸一条新链但中途脱落时，这条未完成的产物在下一轮循环中可以作为一个“大引物”。如果它的3'端恰好与另一个不同的模板分子上的某个区域存在短暂的**微同源性（microhomology）**并发生[退火](@entry_id:159359)，聚合酶就会从这个新模板上继续延伸。最终产生的分子就是由两个或多个原始模板拼接而成的嵌合体。随着PCR循环数的增加，产物浓度呈指数增长，模板跳跃的概率也随之显著增加。

这些偏好是指数累积的。即使每一轮的效率差异很小，经过10-15轮扩增后，也会导致不同分子在最终文库中的丰度产生巨大差异。因此，在文库制备中，应尽量使用高保真、高处理能力的聚合酶，优化PCR条件，并使用最少的必要扩增循环数。

### 文库质量的量化与控制

在进行昂贵的测序之前，评估文库的质量至关重要。除了浓度和片段大小分布外，两个核心的质量指标是文库复杂度和测序重复率。

#### 文库复杂度与重复率

*   **文库复杂度（Library Complexity）**：指文库中**独特的、源自原始样本的DNA分子**的数量，记为$n$。它反映了文库所能代表的原始样本信息的丰富程度。文库复杂度主要受起始DNA的量和文库制备效率的限制。起始量越高、效率越高，复杂度通常也越高 。
*   **测序重复率（Duplicate Rate）**：指测序读长中由PCR扩增产生的冗余拷贝所占的比例。当[测序深度](@entry_id:178191)$r$（总读长数）远大于文库复杂度$n$时，就不可避免地要对同一个原始分子进行多次测序，产生大量重复。在一个理想的随机抽样模型中，当从一个复杂度为$n$的文库中测序$r$次时，期望能观测到的独特分子数是$n (1 - e^{-r/n})$。重复率则为$1 - \frac{n (1 - e^{-r/n})}{r}$。这个公式清晰地表明，重复率随着测序深度$r$的增加和文库复杂度$n$的降低而升高。

高重复率不仅浪费测序资源，更重要的是，如果不加区分，PCR重复会被误认为是生物学信号，从而严重扭曲等位基因频率等定量结果。

#### 独特分子标识符（UMI）的应用

为了精确地识别并去除PCR重复，**独特分子标识符（Unique Molecular Identifiers, UMIs）**应运而生。UMI是一段短的（通常6-12 bp）随机[核苷](@entry_id:195320)酸序列，它在**PCR扩增之前**就被连接到每一个原始DNA片段上。这样，源自同一个原始分子的所有PCR拷贝都会共享相同的UMI序列。

在数据分析时，可以将比对到基因组相同位置（具有相同的起始和终止坐标）且拥有相同UMI序列的读长归为一组，视为来自同一个原始分子的扩增产物。通过计算每个位置有多少个独特的UMI，就可以得到一个近乎无偏的原始分子计数，从而实现精确的定量分析 。

使用UMI时必须考虑**UMI碰撞（UMI collision）**的风险，即两个不同的原始分子偶然被标记上相同的UMI。碰撞的概率取决于UMI库的大小$M$（对于长度为$L_{\text{UMI}}$、[核苷](@entry_id:195320)酸种类为$s$的UMI， $M=s^{L_{\text{UMI}}}$）和文库复杂度$n$。当$n$远小于$M$时，[碰撞概率](@entry_id:269652)很低。反之，如果UMI库太小而文库复杂度太高（例如，用$4^8 \approx 6.5 \times 10^4$种UMI去标记$5 \times 10^6$个分子），碰撞将不可避免，导致分子计数的严重低估。

#### 索引策略与索引跳跃

**索引（Indexing）**技术使得在单次测序运行中能够混合并区分多个样本（多重测序）。然而，在[Illumina](@entry_id:201471)的某些测序平台，尤其是使用**排他性扩增（Exclusion Amplification, ExAmp）**化学的**图形化芯片（patterned flow cells）**（如NovaSeq系列）上，一个被称为**索引跳跃（index hopping）**的现象成为一个主要的错误来源 。

*   **机制**：索引跳跃是指在Flow Cell上，一个文库分子的索引序列被错误地替换为来自另一个文库分子的索引序列。其主要机制是，在测序开始前的簇生成过程中，溶液中残留的、未被完全纯化掉的游离接头或引物（带有索引）会作为引物，错误地退火到正在变性的文库分子上并被聚合酶延伸，从而将错误的索引“嫁接”到该分子上。

索引跳跃的后果取决于所使用的索引策略 ：
*   **单索引（Single Indexing）**：每个样本只靠一个索引（如i7）区分。任何i7索引的跳跃都会直接导致读长被错误地分配给另一个样本。
*   **组合双索引（Combinatorial Dual Indexing）**：使用i7和i5两个索引，但i7和i5的索引集被重复使用于不同的组合中。例如，样本A为(i7_1, i5_A)，样本B为(i7_2, i5_A)。在这种情况下，一个来自样本A的分子如果其i7_1索引跳跃成了i7_2，其索引组合就变成了(i7_2, i5_A)，会被错误地分配给样本B。因此，单次跳跃就足以造成样本误判。
*   **独特双索引（Unique Dual Indexing, UDI）**：每个样本被赋予一个**独一无二的(i7, i5)组合**，该组合在整个测序池中不被任何其他样本使用。这是对抗索引跳跃最有效的策略。当一个来自样本A（索引为(i7_A, i5_A)）的分子发生单次索引跳跃（如i7跳跃）时，它会变成一个例如(i7_B, i5_A)的组合。由于(i7_B, i5_A)并非任何一个样本的有效组合，这条读长在解复用时会被识别为“不确定（undetermined）”而被过滤掉，而不会被错误地分配给样本B。只有当极其罕见的双重跳跃事件恰好产生另一个有效的UDI组合时，才会发生样本误判。因此，UDI将样本误判的概率从与跳跃率$h$成正比，降低到与$h^2$成正比。

利用UDI策略，我们还可以精确地量化索引跳跃率。一个标准方法是，在样本池中掺入一个低比例（如1%）的、基因组来源完全不同的对照文库（如PhiX[噬菌体](@entry_id:139480)），并为其分配一个独特的UDI。测序后，通过统计在“不确定”读长中，有多少条序列可以比对到PhiX基因组上($U_{\phi}$)，并与被正确分配到PhiX样本的读长数($A_{\phi}$)进行比较，就可以估算出索引跳跃率$p_{\text{hop}} \approx U_{\phi} / (U_{\phi} + A_{\phi})$。例如，如果正确分配的PhiX读长有$9.9 \times 10^5$条，而在不确定读长中发现了$1.0 \times 10^4$条PhiX序列，那么跳跃率估计约为1% 。这为评估测序运行的质量和下游分析中设置适当的过滤阈值提供了关键依据。