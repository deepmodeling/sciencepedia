{
    "hands_on_practices": [
        {
            "introduction": "在为临床基因组学设施或大规模研究项目选择测序平台时，一个首要的考虑因素是其通量和可扩展性。本练习将原始的技术规格（例如每次运行的碱基对产出）转化为一个关键的、指导决策的指标：在满足临床标准的覆盖深度下，每次运行能够完成的人类基因组样本数量。通过这个实践，您将掌握支撑基因组学项目规划和预算分配的基础计算，这对于比较不同技术的实际应用效率至关重要 。",
            "id": "4328179",
            "problem": "在用于精准医疗的临床全基因组测序中，平台的通量和可用数据比例决定了在目标覆盖深度下可以完成多少个人类基因组。考虑三种平台各进行一次仪器运行：Illumina NovaSeq、Pacific Biosciences (PacBio) Sequel IIe 和 Oxford Nanopore Technologies (ONT) PromethION。Illumina NovaSeq 每次运行的总原始产量约为 $3.0\\times 10^{12}$ 个碱基对，PacBio Sequel IIe 的高保真 (HiFi) 读长产量上限为 $3.0\\times 10^{10}$ 个碱基对，ONT PromethION 的产量上限为 $2.0\\times 10^{11}$ 个碱基对。假设人类单倍体基因组大小为 $G=3.0\\times 10^{9}$ 个碱基对，临床要求的每个基因组覆盖深度为 $30$ 倍。为考虑质量控制和比对，使用以下特定于平台的可用数据比例：$f_{\\text{NovaSeq}}=0.85$（反映重复序列去除和质量修剪），$f_{\\text{SequelIIe}}=0.95$（通过 HiFi 筛选的读长），以及 $f_{\\text{PromethION}}=0.75$（满足准确度阈值并成功比对的读长比例）。\n\n从覆盖深度的基本定义（总可用测序碱基数除以参考基因组大小）出发，并将完成的基因组数量视为受可用数据限制的整数，确定每个平台每次运行在 $30\\times$ 覆盖深度下可以产生的完整人类基因组的最大整数数量。请以有序三元组 $\\left(N_{\\text{NovaSeq}}, N_{\\text{SequelIIe}}, N_{\\text{PromethION}}\\right)$ 的形式提供您的最终答案，其中每个 $N$ 是小于或等于可实现计数的最大整数。最终答案中不要包含任何单位。",
            "solution": "在尝试任何解决方案之前，该问题都经过了严格的验证过程。\n\n### 第一步：提取已知条件\n问题陈述中提供的数据、变量和条件如下：\n-   **平台 1：Illumina NovaSeq**\n    -   总原始产量：$D_{\\text{raw,NovaSeq}} = 3.0 \\times 10^{12}$ 个碱基对\n    -   可用数据比例：$f_{\\text{NovaSeq}} = 0.85$\n-   **平台 2：PacBio Sequel IIe**\n    -   总原始产量 (HiFi)：$D_{\\text{raw,SequelIIe}} = 3.0 \\times 10^{10}$ 个碱基对\n    -   可用数据比例：$f_{\\text{SequelIIe}} = 0.95$\n-   **平台 3：ONT PromethION**\n    -   总原始产量：$D_{\\text{raw,PromethION}} = 2.0 \\times 10^{11}$ 个碱基对\n    -   可用数据比例：$f_{\\text{PromethION}} = 0.75$\n-   **通用参数**\n    -   人类单倍体基因组大小：$G = 3.0 \\times 10^{9}$ 个碱基对\n    -   所需覆盖深度：$C = 30$ 倍\n-   **约束条件**\n    -   完成的基因组数量 $N$ 必须是小于或等于计算值的最大整数。\n    -   最终答案应为一个有序三元组 $\\left(N_{\\text{NovaSeq}}, N_{\\text{SequelIIe}}, N_{\\text{PromethION}}\\right)$。\n\n### 第二步：使用提取的已知条件进行验证\n根据既定标准对问题进行有效性评估。\n-   **科学依据：** 该问题基于基因组学，特别是全基因组测序的基本概念。指定的平台（Illumina NovaSeq、PacBio Sequel IIe、ONT PromethION）是真实且广泛使用的仪器。给定的产量值、基因组大小、覆盖度要求和可用数据比例是现实的，并代表了当前临床环境下的高通量测序实践。该问题没有科学错误或伪科学。\n-   **良态问题：** 所有必要的定量数据（$D_{\\text{raw}}$, $f$, $G$, $C$）均已提供。目标明确陈述：计算最大整数基因组数量。使用小于或等于计算值的最大整数（即下取整函数）的约束确保了唯一且稳定的解。\n-   **客观性：** 该问题以精确、无偏见和定量的语言表述。它没有任何主观或基于意见的主张。\n\n问题陈述被认定为具有科学依据、良态、客观且自洽。验证清单中列出的缺陷均不存在。\n\n### 第三步：结论与行动\n该问题是**有效的**。将推导解决方案。\n\n### 求解过程\n求解过程首先确定将单个（一个）人类基因组测序到指定覆盖深度所需的可用测序数据量。然后，计算每个平台每次运行可用的总数据量。最后，通过将可用总数据量除以每个基因组所需的数据量，并受整数约束的限制，来确定基因组的数量。\n\n设 $B_{\\text{req}}$ 为将一个基因组覆盖到深度 $C$ 所需的总可用测序碱基数。根据所给定义，这可以计算为覆盖深度与基因组大小的乘积：\n$$\nB_{\\text{req}} = C \\times G\n$$\n代入给定值 $C=30$ 和 $G=3.0 \\times 10^{9}$ 个碱基对：\n$$\nB_{\\text{req}} = 30 \\times (3.0 \\times 10^{9} \\text{ bp}) = 90 \\times 10^{9} \\text{ bp} = 9.0 \\times 10^{10} \\text{ bp}\n$$\n这是每个基因组所需的可用测序数据量。\n\n接下来，我们计算每个平台单次运行产生的总可用数据 $D_{\\text{usable}}$。这是总原始产量 $D_{\\text{raw}}$ 与平台特定的可用数据比例 $f$ 的乘积。\n$$\nD_{\\text{usable}} = D_{\\text{raw}} \\times f\n$$\n我们为三个平台分别计算这个值：\n\n**1. Illumina NovaSeq：**\n$$\nD_{\\text{usable, NovaSeq}} = D_{\\text{raw, NovaSeq}} \\times f_{\\text{NovaSeq}} = (3.0 \\times 10^{12}) \\times 0.85 = 2.55 \\times 10^{12} \\text{ bp}\n$$\n\n**2. PacBio Sequel IIe：**\n$$\nD_{\\text{usable, SequelIIe}} = D_{\\text{raw, SequelIIe}} \\times f_{\\text{SequelIIe}} = (3.0 \\times 10^{10}) \\times 0.95 = 2.85 \\times 10^{10} \\text{ bp}\n$$\n\n**3. ONT PromethION：**\n$$\nD_{\\text{usable, PromethION}} = D_{\\text{raw, PromethION}} \\times f_{\\text{PromethION}} = (2.0 \\times 10^{11}) \\times 0.75 = 1.5 \\times 10^{11} \\text{ bp}\n$$\n\n可以完成的基因组数量 $N$ 是该次运行的总可用数据除以每个基因组所需的可用数据。由于问题要求最大*整数*数量，我们应用下取整函数 $\\lfloor \\cdot \\rfloor$。\n$$\nN = \\left\\lfloor \\frac{D_{\\text{usable}}}{B_{\\text{req}}} \\right\\rfloor\n$$\n我们现在使用 $B_{\\text{req}} = 9.0 \\times 10^{10}$ bp 为每个平台计算 $N$。\n\n**1. Illumina NovaSeq：**\n$$\nN_{\\text{NovaSeq}} = \\left\\lfloor \\frac{2.55 \\times 10^{12}}{9.0 \\times 10^{10}} \\right\\rfloor = \\left\\lfloor \\frac{2.55}{9.0} \\times 10^{2} \\right\\rfloor = \\lfloor 0.2833... \\times 100 \\rfloor = \\lfloor 28.33... \\rfloor = 28\n$$\n\n**2. PacBio Sequel IIe：**\n$$\nN_{\\text{SequelIIe}} = \\left\\lfloor \\frac{2.85 \\times 10^{10}}{9.0 \\times 10^{10}} \\right\\rfloor = \\lfloor 0.3166... \\rfloor = 0\n$$\n\n**3. ONT PromethION：**\n$$\nN_{\\text{PromethION}} = \\left\\lfloor \\frac{1.5 \\times 10^{11}}{9.0 \\times 10^{10}} \\right\\rfloor = \\left\\lfloor \\frac{1.5}{9.0} \\times 10^{1} \\right\\rfloor = \\lfloor 0.1666... \\times 10 \\rfloor = \\lfloor 1.666... \\rfloor = 1\n$$\n\n每个平台每次运行在 $30\\times$ 覆盖深度下可完成的完整人类基因组的最大整数数量分别为：NovaSeq 为 $28$ 个，Sequel IIe 为 $0$ 个，PromethION 为 $1$ 个。最终答案是有序三元组 $(28, 0, 1)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 28  0  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在精准肿瘤学中，检测低丰度的嵌合体变异对于诊断和治疗至关重要，但这极具挑战性，特别是对于固有错误率较高的长读长测序技术。本练习应用统计功效分析的原理，来确定可靠地区分一个真实的低水平信号（嵌合体变异）与背景测序噪声所需的最小测序深度。这项实践将统计学理论（如假设检验、I型和II型错误）与测序实验的实际设计联系起来，这对于开发高灵敏度的诊断分析方法是一项关键技能 。",
            "id": "4328142",
            "problem": "一个正在为靶向基因包实施 Oxford Nanopore Technologies (ONT) 长读长测序的临床实验室，旨在前瞻性地设定一种测序深度策略，以检测与精准肿瘤学相关的低水平嵌合型单核苷酸变异。假设以下基础建模假设，这些假设反映了测序错误建模和推断性检验中经过充分检验的事实：\n\n- 覆盖一个位点的每条测序读长，对于其是否报告一个变异碱基检出，都是一次独立的伯努利试验。\n- 在该位点没有真实变异的原假设下，每条读长报告变异检出的概率等于 ONT 的每条读长碱基错判率 $p$，此处 $p=0.03$。\n- 在真实存在一个嵌合变异，其变异等位基因频率为 $f$（此处 $f=0.05$）的备择假设下，测序读长来源于携带变异碱基的分子的概率为 $f$，来源于携带参考碱基的分子的概率为 $1-f$。假设此位点的碱基检出错误是对称的，即一个真实的变异碱基被错判为参考碱基的概率为 $p$，一个真实的参考碱基被错判为变异碱基的概率也为 $p$。\n- 使用显著性水平为 $\\alpha=0.01$ 的单边二项检验来检出变异，条件是观测到的支持变异的读长数量超过一个将 I 型错误控制在 $\\alpha$ 的、依赖于数据的临界值。\n- 为保证临床灵敏度，要求在测序深度为 $n$ 时，该检验检测一个真实嵌合比例 $f$ 的统计功效至少为 $1-\\beta$，其中 $\\beta=0.10$。\n\n从二项分布的中心极限定理 (CLT) 和单边检验的统计功效定义出发，推导在所述模型下达到上述决策标准所需的最小测序深度 $n$ 的解析表达式（作为 $p$、$f$、$\\alpha$ 和 $\\beta$ 的函数）。然后，对于 ONT，使用 $p=0.03$、$f=0.05$、$\\alpha=0.01$ 和 $\\beta=0.10$ 对此表达式进行数值计算，并报告满足标准的最小整数 $n$。\n\n最后，在比较用于精准医疗的短读长和长读长测序技术的背景下，简要论证这样的测序深度要求将如何与实际的临床报告阈值（例如，最小变异读长数和最小可报告变异等位基因频率）相互作用，以及这些阈值在 ONT 长读长和每条读长错误率显著更低的短读长平台之间可能存在何种差异。\n\n你的最终数值答案必须是最小整数 $n$。不包括任何单位。不要四舍五入到固定的小数位数；而是报告满足标准的最小整数。",
            "solution": "该问题已被验证，并被确定为统计生物信息学中一个有科学依据、良定且客观的问题。我们可以进行正式解答。\n\n任务是推导检测嵌合型单核苷酸变异所需的最小测序深度 $n$。我们将根据中心极限定理 (CLT) 的使用要求，采用正态分布对二项分布进行近似。\n\n设 $X$ 为随机变量，表示在总共 $n$ 条读长中支持变异等位基因的读长数量。\n\n**1. 原假设 ($H_0$) 下的模型**\n在原假设下，不存在真实变异。观测到的变异等位基因总是测序错误。在任意给定读长上观测到变异等位基因的概率是每条读长的碱基错判率 $p$。\n设 $p_0$ 为此概率。\n$$p_0 = p$$\n因此，在 $H_0$ 下，变异读长数 $X$ 服从二项分布：\n$$X | H_0 \\sim \\text{Binomial}(n, p_0)$$\n均值和方差为：\n$$\\mu_0 = E[X|H_0] = n p_0 = np$$\n$$\\sigma_0^2 = \\text{Var}(X|H_0) = n p_0 (1-p_0) = np(1-p)$$\n\n**2. 备择假设 ($H_1$) 下的模型**\n在备择假设下，一个真实的嵌合变异以 $f$ 的变异等位基因频率 (VAF) 存在。一条读长可能来源于携带变异等位基因的分子（概率为 $f$），也可能来源于携带参考等位基因的分子（概率为 $1-f$）。错误模型是对称的。\n设 $p_1$ 为在任意给定读长上观测到变异等位基因的概率。我们使用全概率公式计算此概率：\n$$p_1 = P(\\text{call alt}) = P(\\text{call alt} | \\text{true alt})P(\\text{true alt}) + P(\\text{call alt} | \\text{true ref})P(\\text{true ref})$$\n根据问题陈述：\n- $P(\\text{true alt}) = f$\n- $P(\\text{true ref}) = 1-f$\n- $P(\\text{call alt} | \\text{true ref}) = p$ (一个参考碱基被错判为变异碱基)\n- 一个真实的变异碱基被错判为参考碱基的概率为 $p$，因此它被正确检出为变异的概率为 $1-p$。因此，$P(\\text{call alt} | \\text{true alt}) = 1-p$。\n\n将这些代入 $p_1$ 的方程中：\n$$p_1 = (1-p)f + p(1-f) = f - pf + p - pf = f + p - 2pf$$\n在 $H_1$ 下，变异读长数 $X$ 服从具有这个新概率的二项分布：\n$$X | H_1 \\sim \\text{Binomial}(n, p_1)$$\n均值和方差为：\n$$\\mu_1 = E[X|H_1] = n p_1$$\n$$\\sigma_1^2 = \\text{Var}(X|H_1) = n p_1 (1-p_1)$$\n\n**3. 检验统计量和 CLT 近似**\n对于足够大的 $n$，CLT 允许我们用正态分布来近似这些二项分布：\n$$X | H_0 \\approx N(\\mu_0, \\sigma_0^2) = N(np, np(1-p))$$\n$$X | H_1 \\approx N(\\mu_1, \\sigma_1^2) = N(np_1, np_1(1-p_1))$$\n我们使用单边检验，当变异读长数很大时拒绝 $H_0$。设 $k$ 为变异读长数的临界值。如果 $X > k$，我们就拒绝 $H_0$。\n\n**4. $n$ 的解析表达式推导**\n该检验必须满足两个条件：显著性水平 $\\alpha$ 和统计功效 $1-\\beta$。\n\n首先，I 型错误率（显著性）受 $\\alpha$ 约束：\n$$P(X > k | H_0) = \\alpha$$\n在 $H_0$ 下对变量进行标准化：\n$$P\\left(\\frac{X - \\mu_0}{\\sigma_0} > \\frac{k - \\mu_0}{\\sigma_0} \\right) = \\alpha$$\n设 $z_{\\alpha}$ 为标准正态分布的上 $\\alpha$-分位数，其中对于 $Z \\sim N(0,1)$ 有 $P(Z > z_{\\alpha}) = \\alpha$。则：\n$$\\frac{k - \\mu_0}{\\sigma_0} = z_{\\alpha}$$\n$$k = \\mu_0 + z_{\\alpha}\\sigma_0 = np + z_{\\alpha}\\sqrt{np(1-p)}$$\n\n其次，II 型错误率为 $\\beta$，这意味着统计功效为 $1-\\beta$：\n$$P(X > k | H_1) = 1-\\beta$$\n这等价于：\n$$P(X \\le k | H_1) = \\beta$$\n在 $H_1$ 下对变量进行标准化：\n$$P\\left(\\frac{X - \\mu_1}{\\sigma_1} \\le \\frac{k - \\mu_1}{\\sigma_1} \\right) = \\beta$$\n设 $z_{\\beta}$ 为标准正态分布的上 $\\beta$-分位数。那么对应的下侧分位数是 $-z_{\\beta}$，所以：\n$$\\frac{k - \\mu_1}{\\sigma_1} = -z_{\\beta}$$\n$$k = \\mu_1 - z_{\\beta}\\sigma_1 = np_1 - z_{\\beta}\\sqrt{np_1(1-p_1)}$$\n\n现在我们有两个关于临界值 $k$ 的表达式。通过令它们相等，我们可以解出 $n$：\n$$np + z_{\\alpha}\\sqrt{np(1-p)} = np_1 - z_{\\beta}\\sqrt{np_1(1-p_1)}$$\n重新排列各项，将 $n$ 和 $\\sqrt{n}$ 分组：\n$$np_1 - np = z_{\\alpha}\\sqrt{np(1-p)} + z_{\\beta}\\sqrt{np_1(1-p_1)}$$\n$$n(p_1 - p) = \\sqrt{n} \\left( z_{\\alpha}\\sqrt{p(1-p)} + z_{\\beta}\\sqrt{p_1(1-p_1)} \\right)$$\n解出 $\\sqrt{n}$：\n$$\\sqrt{n} = \\frac{z_{\\alpha}\\sqrt{p(1-p)} + z_{\\beta}\\sqrt{p_1(1-p_1)}}{p_1 - p}$$\n两边平方，得到所需的最小测序深度 $n$ 的解析表达式：\n$$n = \\left( \\frac{z_{\\alpha}\\sqrt{p(1-p)} + z_{\\beta}\\sqrt{p_1(1-p_1)}}{p_1 - p} \\right)^2$$\n代入 $p_1 = f+p-2pf$，分母变为 $p_1 - p = f(1-2p)$。\n$$n = \\left( \\frac{z_{\\alpha}\\sqrt{p(1-p)} + z_{\\beta}\\sqrt{(f+p-2pf)(1 - (f+p-2pf))}}{f(1-2p)} \\right)^2$$\n这是 $n$ 作为 $p$、$f$、$\\alpha$ 和 $\\beta$ 的函数的一般解析表达式。\n\n**5. 数值计算**\n给定以下值：\n- $p = 0.03$ (ONT 错误率)\n- $f = 0.05$ (嵌合 VAF)\n- $\\alpha = 0.01$ (显著性水平)\n- $\\beta = 0.10$ (II 型错误率)\n\n首先，我们从标准正态分布中找到临界值：\n- $z_{\\alpha} = z_{0.01} \\approx 2.3263$\n- $z_{\\beta} = z_{0.10} \\approx 1.2816$\n\n接下来，我们计算概率 $p_0$ 和 $p_1$：\n- $p_0 = p = 0.03$\n- $p_1 = f + p - 2pf = 0.05 + 0.03 - 2(0.05)(0.03) = 0.08 - 0.003 = 0.077$\n\n现在我们计算 $n$ 公式中的各项：\n- 分母：$p_1 - p_0 = 0.077 - 0.03 = 0.047$\n- 分子第一项：$z_{\\alpha}\\sqrt{p_0(1-p_0)} = 2.3263 \\times \\sqrt{0.03(1-0.03)} = 2.3263 \\times \\sqrt{0.0291} \\approx 2.3263 \\times 0.170587 \\approx 0.39684$\n- 分子第二项：$z_{\\beta}\\sqrt{p_1(1-p_1)} = 1.2816 \\times \\sqrt{0.077(1-0.077)} = 1.2816 \\times \\sqrt{0.071071} \\approx 1.2816 \\times 0.266591 \\approx 0.34166$\n\n结合这些来求 $n$：\n$$n = \\left( \\frac{0.39684 + 0.34166}{0.047} \\right)^2 = \\left( \\frac{0.73850}{0.047} \\right)^2 \\approx (15.7128)^2 \\approx 246.88$$\n由于测序深度 $n$ 必须是整数，且覆盖度必须至少达到这个值才能满足统计功效要求，我们必须对这个结果取上取整。\n$$n = \\lceil 246.88 \\rceil = 247$$\n\n**6. 论证与测序技术比较**\n对于 ONT 长读长测序，推导出的 $n=247$ 的测序深度要求凸显了该技术在精准肿瘤学中的一个关键挑战：其固有的高碱基错误率。\n\n高噪声基底（在原假设下，期望的变异读长数为 $np_0 = 247 \\times 0.03 \\approx 7.4$）使得检出变异需要一个高阈值。具体来说，临界计数值 $k$ 约为 $k = np_0 + z_{\\alpha}\\sqrt{np_0(1-p_0)} \\approx 7.41 + 2.3263\\sqrt{247(0.0291)} \\approx 7.41 + 6.24 \\approx 13.65$。这意味着需要至少 $14$ 条变异读长才能以 $99\\%$ 的置信度检出变异。这样高的最小变异读长数阈值对于控制假阳性是必要的，但会限制对极低水平变异的灵敏度。\n\n相比之下，短读长测序平台（例如 Illumina）的每读长错误率要低得多，通常为 $p' \\approx 0.001$。用这个错误率重复计算，会得出显著降低的测序深度要求，约为 $n' \\approx 51$。对于短读长数据，背景噪声极小（偶然期望的读长数为 $n'p' = 51 \\times 0.001 = 0.051$）。因此，观测到哪怕几条变异读长（例如 $3$ 或 $4$ 条）也可能具有高度显著性。这使得使用短读长数据的临床实验室能够设置低得多的最小变异读长数阈值，并以较适中的测序深度自信地报告低等位基因频率的变异。\n\n总之，虽然长读长测序在解析复杂结构变异和单倍型定相方面具有优势，但其较高的错误率给低频单核苷酸变异的检测带来了巨大的测序深度负担。与错误率较低的短读长技术所能达到的水平相比，这就要么需要进行非常深（且昂贵）的测序，要么需要接受更高的报告阈值（在变异读长数和最小 VAF 两方面）。",
            "answer": "$$\n\\boxed{247}\n$$"
        },
        {
            "introduction": "变异检测的准确性受到测序错误的根本性制约，而理解这些错误的性质——它们是随机的还是系统的——对于构建稳健的生物信息学分析流程至关重要。本练习使用一个简化的概率模型（二项分布）来计算在错误完全随机且独立的假设下，假阳性变异的期望数量。计算结果与真实世界数据的巨大差异，有力地揭示了系统性、依赖于序列上下文的错误的主导作用，这对于深刻理解变异检测中的真实挑战至关重要 。",
            "id": "4328189",
            "problem": "一家临床实验室正在验证用于精准肿瘤学中靶向变异检测的两种工作流程：一种是使用Illumina的短读长测序，另一种是使用牛津纳米孔技术（ONT）的长读长测序。考虑一个长度为 $L = 10 \\times 10^{6}$ 个碱基的靶向区域（panel），每个位点的覆盖度均匀为 $n = 100$ 条读数，并假设靶向区域内没有真实变异（所有位点均为纯合参考基因型）。设Illumina的每条读数的替换错误率为 $p_{s} = 0.001$，ONT的每条读数的插入/缺失（indel）错误率为 $p_{i} = 0.03$。\n\n在独立性模型下，一个简化的多数投票变异检出程序（variant caller）定义如下：在每个位点，对于单核苷酸变异（SNV）的检出，如果严格超过一半（$n$ 条读数）的读数报告了一个非参考碱基，则该程序将该位点标记为非参考；对于indel的检出，如果严格超过一半的读数报告了任何相对于参考序列的indel，则该程序将该位点标记为存在indel。假设在单个位点内，各条读数是独立的；在整个靶向区域内，各个位点也是独立的。该变异检出程序不要求特定非参考类别之间的一致性；它只统计每条读数对于SNV是参考还是非参考，对于indel是参考还是存在indel。\n\n仅使用独立伯努利试验的基本概率原理，不借助任何领域特定的简化公式，推导出在整个靶向区域内假阳性SNV检出和假阳性indel检出的期望数量的表达式。然后，对于给定的 $p_{s}$ 和 $p_{i}$ 在 $n = 100$ 的条件下，对这些期望值进行数值计算，将最终数值结果四舍五入至两位有效数字，并用科学记数法表示。将你的最终答案以行矩阵的形式给出，第一个元素等于期望的SNV假阳性数量，第二个元素等于期望的indel假阳性数量。\n\n最后，定性地简要讨论为什么对于短读长和长读长技术，独立性假设在真实数据中可能不成立，以及这将如何改变假阳性率。你的最终数值答案必须仅包含期望的数量，不带单位，并按要求以行矩阵形式呈现。",
            "solution": "该问题陈述经评估具有科学依据、定义明确且客观。所有必要的参数和定义均已提供，不存在矛盾或不成立的前提。该问题是概率论在生物信息学场景中的一个有效应用。\n\n任务是计算在指定模型下，单核苷酸变异（SNV）和插入/缺失（indel）的假阳性检出期望数量，然后讨论该模型的局限性。\n\n如果在没有真实变异的情况下，测序错误在大多数读数中累积，从而模拟出一个变异，那么在某个基因组位点上就会发生假阳性检出。问题将“大多数”定义为严格超过一半的读数。给定 $n=100$ 条读数的均匀覆盖度，如果包含错误的读数数量 $k > \\frac{n}{2} = 50$，即 $k \\geq 51$，则记录为一次假阳性。\n\n问题的核心在于应用二项分布。对于任何给定位点， $n$ 条测序读数中的每一条都代表一次独立的伯努利试验。如果一条读数包含所考虑类型的错误（替换或indel），则试验为“成功”；如果它与参考序列匹配，则为“失败”。\n\n设 $X$ 是一个随机变量，表示在给定位点上带有错误的读数数量。在独立性假设下， $X$ 服从二项分布， $X \\sim \\text{Binomial}(n, p)$，其中 $n$ 是试验次数（读数数量）， $p$ 是每次试验成功的概率（错误率）。其概率质量函数为：\n$$P(X=k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n其中 $k$ 是带有错误的读数数量。\n\n在单个位点上发生假阳性检出的概率，记为 $P_{FP}$，是含错误读数数量 $k$ 严格大于50的概率。这通过对 $k = 51, 52, \\dots, 100$ 的概率求和来计算：\n$$P_{FP} = P(X > 50) = P(X \\ge 51) = \\sum_{k=51}^{n} \\binom{n}{k} p^k (1-p)^{n-k}$$\n问题陈述，靶向区域的长度为 $L$ 个碱基，且各位点是独立的。整个区域内假阳性检出的总期望数 $E[N_{FP}]$ 是每个位点假阳性期望数的总和。根据期望的线性性质，并且由于所有位点的 $P_{FP}$ 相同，可得：\n$$E[N_{FP}] = L \\times P_{FP} = L \\sum_{k=51}^{n} \\binom{n}{k} p^k (1-p)^{n-k}$$\n我们现在将这个通用公式应用于两个指定的情况。\n\n**1. 期望的假阳性SNV检出数量（Illumina）**\n\n对于Illumina短读长工作流程，相关参数为：\n- 覆盖度：$n = 100$\n- 每条读数的替换错误率：$p_s = 0.001$\n- 靶向区域长度：$L = 10 \\times 10^6 = 10^7$\n\n设 $X_s$ 为在某个位点上带有替换错误的读数数量。$X_s \\sim \\text{Binomial}(100, 0.001)$。在单个位点上发生假阳性SNV检出的概率 $P_{FP,s}$ 为：\n$$P_{FP,s} = P(X_s \\ge 51) = \\sum_{k=51}^{100} \\binom{100}{k} (0.001)^k (1-0.001)^{100-k}$$\n该分布的均值为 $\\mu_s = n p_s = 100 \\times 0.001 = 0.1$。观测到51个或更多错误的结果的概率极小，因为它位于远离均值的分布极端尾部。需要进行数值计算。\n$$P_{FP,s} \\approx 1.155 \\times 10^{-119}$$\n整个区域内假阳性SNV检出的期望数量为：\n$$E[FP_{SNV}] = L \\times P_{FP,s} = 10^7 \\times (1.155 \\times 10^{-119}) = 1.155 \\times 10^{-112}$$\n四舍五入至两位有效数字，结果为 $1.2 \\times 10^{-112}$。\n\n**2. 期望的假阳性Indel检出数量（ONT）**\n\n对于ONT长读长工作流程，相关参数为：\n- 覆盖度：$n = 100$\n- 每条读数的indel错误率：$p_i = 0.03$\n- 靶向区域长度：$L = 10 \\times 10^6 = 10^7$\n\n设 $X_i$ 为在某个位点上带有indel错误的读数数量。$X_i \\sim \\text{Binomial}(100, 0.03)$。在单个位点上发生假阳性indel检出的概率 $P_{FP,i}$ 为：\n$$P_{FP,i} = P(X_i \\ge 51) = \\sum_{k=51}^{100} \\binom{100}{k} (0.03)^k (1-0.03)^{100-k}$$\n该分布的均值为 $\\mu_i = n p_i = 100 \\times 0.03 = 3$。虽然其错误率高于Illumina SNV的错误率，但51个错误的阈值仍然处于分布的极端尾部。需要进行数值计算。\n$$P_{FP,i} \\approx 1.758 \\times 10^{-58}$$\n整个区域内假阳性indel检出的期望数量为：\n$$E[FP_{Indel}] = L \\times P_{FP,i} = 10^7 \\times (1.758 \\times 10^{-58}) = 1.758 \\times 10^{-51}$$\n四舍五入至两位有效数字，结果为 $1.8 \\times 10^{-51}$。\n\n数值结果 $1.2 \\times 10^{-112}$ 和 $1.8 \\times 10^{-51}$ 实际上都等于零，这表明在这个理想化的模型下，由随机错误引起的高覆盖度下的假阳性几乎是不可能发生的。\n\n**3. 关于独立性假设的讨论**\n\n测序错误是独立、随机事件的假设是一个严重的过度简化，在真实世界的测序数据中并不成立。由于**系统性错误**的存在，实际的假阳性率远高于上述计算值。\n\n- **独立性的失效：** 测序错误通常不是随机的，而是与特定的DNA序列上下文相关。在短读长和长读长技术中，某些基序（例如，同聚物、富含G/C的区域、反向重复序列）本身就更难准确测序。在这种“困难”位点上发生的错误不是一个独立的随机事件，而是一种系统性偏差。这意味着，如果一条读数在该位点上出现错误，其他读数也更有可能出现相同的错误，这违反了在单个位点上读数之间相互独立的假设。\n- **对Illumina（短读长）数据的影响：** Illumina技术存在与上下文相关的替换错误（例如，在GGT基序处）、信号随读数长度增加而衰减的相位/预相位问题（phasing/pre-phasing issues），以及可能导致覆盖度不均一的PCR扩增偏好。如果某个位点容易出现系统性错误，那么该特定位点的有效错误概率 $p_s$ 会远高于全基因组平均值 $0.001$。这种局部错误率的增加可能导致一组读数都带有相同的非参考碱基，从而可能超过多数投票的阈值。\n- **对ONT（长读长）数据的影响：** 在ONT数据中，系统性错误更为显著。特别地，Indel错误在同聚物区域（例如，AAAAAA被读成AAAAA或AAAAAAA）很常见。将原始电信号转换为DNA碱基的碱基检出（basecalling）算法在某些上下文中可能存在持续的偏差。信号解读中的一个错误可能会影响一段碱基，从而产生相关性。由于这些错误是系统性的，它们不会被高覆盖度所平均掉。相反，同一个indel错误可能会出现在覆盖某个同聚物的大部分读数中，导致indel的假阳性率远高于预期。\n\n总而言之，独立性假设的失效意味着错误的真实分布不是二项分布。相反，对于有问题的位点，错误概率要高得多，且错误倾向于聚集出现。这种“肥尾”行为极大地增加了超过多数投票阈值的概率，使得系统性错误而非随机噪声成为高覆盖度测序数据中假阳性的主要来源。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.2 \\times 10^{-112}  1.8 \\times 10^{-51} \\end{pmatrix}}\n$$"
        }
    ]
}