{
    "hands_on_practices": [
        {
            "introduction": "有效的接头序列 trimming 并非简单的序列搜索，而是一个基于概率的决策过程。本练习将引导您深入理解其中的核心权衡：在确保高效检测到真实接头（灵敏度）与避免因随机序列相似性而错误修剪读段（特异性）之间取得平衡。通过对这些概率进行建模，我们可以为关键参数（如最小匹配长度）的选择提供坚实的理论依据 。",
            "id": "4313948",
            "problem": "用于精准肿瘤学的临床二代测序 (NGS) 流程，在进行变异检出之前，使用接头修剪来移除源自患者的测序读段中的人工合成接头污染。当一个读段中的某个窗口与接头的前缀存在一个长度至少为 $m$ 的连续完全匹配时，修剪工具便会宣告存在接头；一旦检测到，该读段将在此匹配的起始位置被修剪。最小重叠长度 $m$ 是宣告接头存在所需的最短连续完全匹配长度。在本题中，你将对此概念进行形式化，并在一个关于基因组背景和测序错误的概率模型下选择 $m$，以平衡假阳性控制和灵敏度。\n\n假设如下：\n- 读段长度为 $R = 151$ 个核苷酸，工具会扫描一个读段中所有长度为 $m$ 的可能窗口，因此每个读段的窗口数为 $n_{w} = R - m + 1$。\n- 人类基因组背景被建模为独立同分布 (i.i.d.) 的碱基，其频率为 $f_{A} = 0.3$，$f_{C} = 0.2$，$f_{G} = 0.2$ 和 $f_{T} = 0.3$。\n- 接头前缀是固定的，以序列 $\\mathrm{AGATCGGAAGAGC}$ 开头；其组成为 $p_{A} = \\frac{5}{13}$，$p_{C} = \\frac{2}{13}$，$p_{G} = \\frac{5}{13}$ 和 $p_{T} = \\frac{1}{13}$。假设接头前缀的逐位碱基组成是平稳的，因此与接頭碱基完全匹配的逐碱基概率在所有位置上是恒定的，等于 $q = f_{A} p_{A} + f_{C} p_{C} + f_{G} p_{G} + f_{T} p_{T}$。\n- 测序错误在碱基之间是独立的，每个碱基的错误概率为 $\\varepsilon = 0.005$；检测需要长度为 $m$ 的完全匹配，因此一个长度为 $m$ 的真实接头重叠被检测到的概率为 $(1 - \\varepsilon)^{m}$。\n\n施加了两个设计约束：\n1. 假阳性控制：在 $N = 10^{6}$ 个已知不含接头的读段中，因与接头发生随机完全匹配而被错误修剪的读段的期望数量不得超过 $F_{\\max} = 0.1$。\n2. 灵敏度：对于确实包含长度至少为 $m$ 的接头重叠的读段，检测概率必须至少为 $S_{\\min} = 0.9$。\n\n从上述模型假设出发，且不使用任何预先推导的快捷公式，推导出量化期望假阳性数和灵敏度作为 $m$ 的函数所需的表达式，并确定同时满足这两个约束条件的最小整数 $m$。将你的最终答案表示为单个整数 $m$。由于 $m$ 是整数且没有单位，因此不需要舍入说明。",
            "solution": "本题要求找到最小重叠长度 $m$ 的最小整数值，该值在一个NGS接头修剪场景中同时满足两个约束：一个关于灵敏度，一个关于假阳性率。我们将基于所提供的概率模型对每个约束进行形式化，推导出决定 $m$ 的不等式，并求解满足两个条件的最小整数 $m$。\n\n给定参数如下：\n- 读段长度：$R = 151$\n- 不含接头的读段数量：$N = 10^6$\n- 最大期望假阳性读段数：$F_{\\max} = 0.1$\n- 最小灵敏度：$S_{\\min} = 0.9$\n- 每个碱基的测序错误率：$\\varepsilon = 0.005$\n- 基因组碱基频率：$f_{A} = 0.3$, $f_{C} = 0.2$, $f_{G} = 0.2$, $f_{T} = 0.3$\n- 接头前缀碱基频率：$p_{A} = \\frac{5}{13}$, $p_{C} = \\frac{2}{13}$, $p_{G} = \\frac{5}{13}$, $p_{T} = \\frac{1}{13}$\n\n首先，我们分析关于灵敏度的约束。\n约束2：灵敏度\n灵敏度是检测到长度至少为 $m$ 的真实接头重叠的概率。题目指出，检测需要长度为 $m$ 的完全匹配。如果存在一个长度为 $m$ 的真实重叠，只有在该 $m$ 碱基区域内没有测序错误时才会被检测到。单个碱基没有错误的概率是 $1 - \\varepsilon$。由于错误在不同碱基间是独立的，因此长度为 $m$ 的序列中没有错误的概率是 $(1 - \\varepsilon)^m$。\n因此，灵敏度 $S(m)$ 由下式给出：\n$$S(m) = (1 - \\varepsilon)^m$$\n约束要求此概率至少为 $S_{\\min} = 0.9$。\n$$(1 - \\varepsilon)^m \\ge S_{\\min}$$\n代入值 $\\varepsilon = 0.005$ 和 $S_{\\min} = 0.9$：\n$$(1 - 0.005)^m \\ge 0.9$$\n$$(0.995)^m \\ge 0.9$$\n为求解 $m$，我们对两边取自然对数。由于 $\\ln(0.995)$ 是负数，我们在除以它时必须反转不等号。\n$$m \\ln(0.995) \\ge \\ln(0.9)$$\n$$m \\le \\frac{\\ln(0.9)}{\\ln(0.995)}$$\n使用数值，$\\ln(0.9) \\approx -0.10536$ 且 $\\ln(0.995) \\approx -0.0050125$。\n$$m \\le \\frac{-0.10536}{-0.0050125} \\approx 21.019$$\n由于 $m$ 必须是整数，灵敏度约束对 $m$ 施加了一个上界：\n$$m \\le 21$$\n\n接下来，我们分析关于假阳性的约束。\n约束1：假阳性控制\n当一个不含接头的读段由于与接头前缀发生偶然匹配而被修剪时，就会发生假阳性。这需要一个来自基因组的长度为 $m$ 的随机序列与一个来自接头前缀的长度为 $m$ 的序列完全匹配。\n\n首先，我们计算单个随机基因组碱基与接头前缀单个碱基匹配的概率 $q$。题目要求将接头前缀建模为具有由 $\\{p_A, p_C, p_G, p_T\\}$ 给出的平稳碱基组成，并将基因组背景建模为具有频率 $\\{f_A, f_C, f_G, f_T\\}$ 的独立同分布。在任何给定位置匹配的概率是匹配每种碱基类型的概率之和：\n$$q = P(\\text{基因组碱基} = \\text{接头碱基})$$\n$$q = P(\\text{匹配}|\\text{接头碱基为A})P(\\text{接头碱基为A}) + \\dots + P(\\text{匹配}|\\text{接头碱基为T})P(\\text{接头碱基为T})$$\n$$q = f_A p_A + f_C p_C + f_G p_G + f_T p_T$$\n代入给定的频率：\n$$q = (0.3)\\left(\\frac{5}{13}\\right) + (0.2)\\left(\\frac{2}{13}\\right) + (0.2)\\left(\\frac{5}{13}\\right) + (0.3)\\left(\\frac{1}{13}\\right)$$\n$$q = \\frac{1}{13} (1.5 + 0.4 + 1.0 + 0.3) = \\frac{3.2}{13}$$\n由于基因组碱基是独立同分布的，一个随机的 $m$ 碱基窗口与接头前缀匹配的概率是 $q^m$。\n\n如果 $n_w = R - m + 1$ 个可能窗口中至少有一个与接头前缀匹配，则一个读段被错误地修剪。设 $A_j$ 为在窗口 $j$ 中发生匹配的事件，其中 $j=1, \\dots, n_w$。一个读段被错误修剪的概率是 $P(\\cup_{j=1}^{n_w} A_j)$。\n在 $N$ 个不含接头的读段中，被错误修剪的读段的期望数量 $E_{FP}$ 是 $N \\cdot P(\\cup_{j=1}^{n_w} A_j)$。\n约束是 $E_{FP} \\le F_{\\max}$。\n$$N \\cdot P\\left(\\bigcup_{j=1}^{n_w} A_j\\right) \\le F_{\\max}$$\n由于窗口重叠，事件 $A_j$ 不是独立的。然而，我们可以使用 Boole 不等式（并集上界）来建立一个充分条件：$P(\\cup_{j=1}^{n_w} A_j) \\le \\sum_{j=1}^{n_w} P(A_j)$。\n在任何单个窗口中发生匹配的概率是 $P(A_j) = q^m$。\n总和是 $\\sum_{j=1}^{n_w} P(A_j) = n_w q^m = (R-m+1)q^m$。\n因此，满足该约束的一个充分条件是：\n$$N (R-m+1) q^m \\le F_{\\max}$$\n代入给定值：$N=10^6$, $R=151$, $F_{\\max}=0.1$, 以及 $q = 3.2/13$:\n$$10^6 (151 - m + 1) \\left(\\frac{3.2}{13}\\right)^m \\le 0.1$$\n$$10^6 (152 - m) \\left(\\frac{3.2}{13}\\right)^m \\le 0.1$$\n$$(152 - m) \\left(\\frac{3.2}{13}\\right)^m \\le 10^{-7}$$\n我们需要找到满足此不等式的最小整数 $m$。对于我们感兴趣的值，不等式左侧（我们称之为 $f(m)$）是 $m$ 的一个快速递减函数。我们可以通过测试整数值来找到最小的 $m$。\n让我们为几个整数 $m$ 计算 $f(m)$：\n对于 $m=15$：\n$$f(15) = (152 - 15) \\left(\\frac{3.2}{13}\\right)^{15} = 137 \\left(\\frac{3.2}{13}\\right)^{15} \\approx 137 \\times 1.0116 \\times 10^{-9} \\approx 1.386 \\times 10^{-7}$$\n由于 $1.386 \\times 10^{-7} > 10^{-7}$，$m=15$ 不满足此约束。\n\n对于 $m=16$：\n$$f(16) = (152 - 16) \\left(\\frac{3.2}{13}\\right)^{16} = 136 \\left(\\frac{3.2}{13}\\right)^{16} \\approx 136 \\times 2.490 \\times 10^{-10} \\approx 3.386 \\times 10^{-8}$$\n由于 $3.386 \\times 10^{-8} \\le 10^{-7}$，$m=16$ 满足此约束。\n因此，假阳性约束对 $m$ 施加了一个下界：\n$$m \\ge 16$$\n\n最后，我们结合两个约束来找到最小整数 $m$。\n灵敏度约束要求 $m \\le 21$。\n假阳性控制约束要求 $m \\ge 16$。\n为了同时满足这两个约束，$m$ 必须在整数范围 $[16, 21]$ 内。$m$ 的有效整数值集合是 $\\{16, 17, 18, 19, 20, 21\\}$。\n问题要求找到满足这两个约束的最小整数 $m$。这对应于有效集合中的最小值。\n因此，$m$ 的最小整数值为 16。",
            "answer": "$$\n\\boxed{16}\n$$"
        },
        {
            "introduction": "在基于扩增子的测序中，PCR 引物二聚体是一种常见且极具干扰性的副产物，若不加滤除，将严重影响下游分析的准确性。本实践练习将从常规的接头修剪，转向一项更具针对性的任务：设计一个专门滤除引物二聚体的过滤器 。这项挑战要求您综合运用序列匹配（包含对测序错误的容忍）与片段长度分析两种策略，以精确地区分这些技术性副产物和真实的生物信号。",
            "id": "4313892",
            "problem": "在用于肿瘤学中微小残留病检测的、基于扩增子的新一代测序(NGS)分析中，如果在变异检测之前不予去除，聚合酶链式反应(PCR)中的引物二聚体可能会增加假性变异信号。考虑一个肿瘤基因面板，其中每个扩增子都由一个已知的长度为 $p_f$ 个核苷酸的正向引物和一个已知的长度为 $p_r$ 个核苷酸的反向引物生成，且 $p_f = p_r = 22$。测序在Illumina平台上进行，采用双末端测序，每个读数的长度为 $R = 150$ 个核苷酸 ($2 \\times 150$)。在标准的接头序列修剪后，您希望通过识别几乎没有或完全没有中间插入序列的全长引物对来检测并移除PCR引物二聚体读数。假设以下经验支持的事实和定义作为基本依据：\n\n- 当正向引物和反向引物相互退火（或与短的互补人工产物退火）并被最低限度地延伸时，会产生引物二聚体片段，其片段长度约等于 $L_{\\mathrm{frag}} = p_f + i + p_r$，其中 $i$ 是引物之间的中间插入序列长度，在真实的引物二聚体中通常接近于 $0$。\n- 在此基因面板中，根据实验设计，合法的扩增子插入序列长度（不包括引物）在 $[120, 250]$ 个核苷酸范围内。\n- 单碱基测序错误率为 $\\epsilon = 5 \\times 10^{-3}$，并且为了估计随机匹配概率，可以认为不同位置的碱基识别是近似独立的。\n- 对于读数末端长度为 $p$ 的随机序列，在碱基频率相等的情况下，当 $p$ 很大时，与预先指定的 $p$-mer 完全匹配的概率可以忽略不计。允许少量错配可以容纳测序错误，同时仍保持极低的随机匹配概率。\n\n您的任务是指定一个检测规则，该规则 (i) 要求在读数末端识别出正确锚定且朝向向内的正向和反向引物，(ii) 为中间插入序列 $i$ 设定一个长度阈值，将读数分类为引物二聚体，并且 (iii) 在 $N = 10^{7}$ 个读数对的数据集中，实现低于 $10^{-6}$ 的数据集级别假阳性率。对于短片段，双末端读数将完全重叠并合并；将合并后的读数长度表示为 $L_{\\mathrm{merge}}$。请选择一个最正确且最保守地实现这些要求的选项，该选项应基于基本原理和既定事实，包括适当的错配容许度和分类长度阈值。\n\nA. 要求两个读数末端都包含长度为 $22$ 的全长正向和反向引物序列，方向正确朝内，每个序列与引物比对时最多允许 $m = 2$ 个错配，以容纳 $\\epsilon = 5 \\times 10^{-3}$ 的错误率。如果中间插入序列长度满足 $i \\le 8$，则将读数分类为引物二聚体，这等同于在成功合并时 $L_{\\mathrm{merge}} \\le p_f + p_r + 8 = 52$ 个核苷酸。\n\nB. 在读数末端使用来自正向和反向引物的 $12$ 个核苷酸的种子序列，每个种子序列最多允许 $m = 3$ 个错配。如果中间插入序列长度 $i \\le 20$ 个核苷酸，则分类为引物二聚体，这等同于在成功合并时 $L_{\\mathrm{merge}} \\le 64$ 个核苷酸。\n\nC. 仅要求在单个读数末端有一个全长引物，最多允许 $m = 2$ 个错配。如果通过双末端比对估计的片段长度满足 $L_{\\mathrm{frag}} \\le 100$ 个核苷酸，则分类为引物二聚体。\n\nD. 要求在读数末端与全长正向和反向引物完全匹配（$m = 0$）。如果中间插入序列长度 $i \\le 2$ 个核苷酸，则分类为引物二聚体，这等同于在成功合并时 $L_{\\mathrm{merge}} \\le p_f + p_r + 2 = 46$ 个核苷酸。",
            "solution": "### 步骤1：提取已知信息\n\n-   分析方法：用于微小残留病检测的基于扩增子的新一代测序(NGS)。\n-   正向引物长度：$p_f = 22$ 个核苷酸。\n-   反向引物长度：$p_r = 22$ 个核苷酸。\n-   测序技术：Illumina，双末端测序读数。\n-   读数长度：配对中的每个读数长度为 $R = 150$ 个核苷酸 ($2 \\times 150$）。\n-   引物二聚体片段长度：$L_{\\mathrm{frag}} = p_f + i + p_r$，其中 $i$ 是中间插入序列的长度，对于引物二聚体，$i \\approx 0$。\n-   合法扩增子插入序列长度范围：$i \\in [120, 250]$ 个核苷酸。\n-   单碱基测序错误率：$\\epsilon = 5 \\times 10^{-3}$。\n-   数据集中读数对的数量：$N = 10^7$。\n-   要求的数据集级别假阳性率：$  10^{-6}$。\n-   合并后读数长度（对于完全重叠的读数）：$L_{\\mathrm{merge}}$。\n-   检测规则要求：\n    1.  在读数末端识别出朝向向内的正向和反向引物。\n    2.  为分类设定一个插入序列长度阈值 $i$。\n    3.  达到指定的假阳性率。\n\n### 步骤2：使用提取的已知信息进行验证\n\n问题陈述在科学上是合理且严谨的。所描述的场景是临床NGS数据分析中一个标准且关键的质量控制步骤。提供的参数，如引物长度（$22$ nt）、读数长度（$150$ nt）和测序错误率（$\\epsilon=0.005$），对于现代Illumina测序是符合实际的。核心任务是区分PCR引物二聚体人工产物（$i \\approx 0$）和合法扩增子（$i \\in [120, 250]$）。这两个长度类别之间的巨大差异使得问题是可解的。检测规则的要求清晰客观。问题是自洽的，提供了所有必要的数据以在定量基础上评估选项。没有违反任何科学原理。\n\n### 步骤3：判断与行动\n\n问题陈述是**有效的**。解决过程将继续进行。\n\n### 基于原理的推导\n\n主要目标是设计一个过滤器，以移除源自引物二聚体人工产物的读数对，同时保留来自合法扩增子的读数对。\n\n一个引物二聚体片段由正向和反向引物组成，中间可能被一个非常短的非特异性插入序列隔开。其总长度为 $L_{\\mathrm{frag}} = p_f + p_r + i = 22 + 22 + i = 44 + i$，其中 $i$ 通常接近于 $0$。由于 $L_{\\mathrm{frag}}$ 远小于读数长度 $R=150$，双末端读数将完全重叠。在接头序列修剪和合并后，得到的一致性序列长度为 $L_{\\mathrm{merge}} \\approx L_{\\mathrm{frag}} = 44 + i$。\n\n一个合法扩增子片段的长度为 $L_{\\mathrm{frag}} = 44 + i$，其中 $i \\in [120, 250]$。因此，最短的合法片段长度为 $44 + 120 = 164$ 个核苷酸。\n\n引物二聚体和合法扩增子之间的根本区别在于插入序列长度 $i$。如果一个读数对的估计插入序列长度低于某个阈值 $i \\le i_{\\mathrm{thresh}}$，过滤器就会将其分类为引物二聚体。\n\n检测规则还必须通过匹配读数末端的已知引物序列来确认片段的身份。由于测序错误，我们必须允许一定数量的错配（$m$）。长度为 $p$ 的引物序列中的错误数量可以用二项分布 $B(p, \\epsilon)$ 来建模。对于长度为 $p=22$ 的引物和错误率 $\\epsilon = 5 \\times 10^{-3}$，预期的错误数量为 $E[k] = p \\epsilon = 22 \\times 0.005 = 0.11$。\n\n让我们计算在一个 22 碱基的引物序列中观察到 $k$ 个错误的概率：\n-   $P(k=0) = (1-\\epsilon)^{22} = (0.995)^{22} \\approx 0.8954$\n-   $P(k=1) = \\binom{22}{1} \\epsilon^1 (1-\\epsilon)^{21} = 22 \\times 0.005 \\times (0.995)^{21} \\approx 0.0989$\n-   $P(k=2) = \\binom{22}{2} \\epsilon^2 (1-\\epsilon)^{20} = 231 \\times (0.005)^2 \\times (0.995)^{20} \\approx 0.0052$\n\n累积概率为：\n-   $P(k \\le 0) \\approx 0.8954$（一个完全匹配的规则会漏掉约 $10.5\\%$ 的真实引物）。\n-   $P(k \\le 1) \\approx 0.8954 + 0.0989 = 0.9943$\n-   $P(k \\le 2) \\approx 0.9943 + 0.0052 = 0.9995$\n\n允许最多 $m=2$ 个错配可以捕获超过 $99.9\\%$ 的正确测序的引物，从而提供出色的灵敏度。一个引物二聚体涉及两个引物，因此使用此规则检测到两者的概率为 $(P(k \\le 2))^2 \\approx (0.9995)^2 \\approx 0.999$，这意味着该规则对于检测真实的引物二聚体人工产物具有非常高的灵敏度。\n\n当一个非引物二聚体的读数被错误地标记时，就会出现假阳性（FP）。这里分析的最可能的FP来源是恰好符合引物标准的脱靶读数（随机序列）。数据集的FP率，$N_{FP}/N$，必须小于 $10^{-6}$，这意味着一个随机读数对成为FP的概率，$P(\\text{FP})$，必须小于 $10^{-6}$。一个FP需要同时匹配正向和反向引物。一个随机的 $p$-mer 与一个特定的 $p$-mer 在最多 $m$ 个错配下匹配的概率是 $P_{\\text{match}}(p, m) = \\sum_{k=0}^{m} \\binom{p}{k} (1/4)^{p-k} (3/4)^k$。对于一个读数对，这个概率是 $(P_{\\text{match}}(p, m))^2$。\n\n一个“保守”的规则是指FP率非常低的规则，而一个“正确”的规则还必须具有高灵敏度以去除人工产物。\n\n### 逐项分析\n\n**A. 此选项使用全长引物（$p=22$）并允许 $m=2$ 个错配。如上计算，这为每个引物提供了出色的灵敏度（$99.9\\%$）。特异性由随机匹配概率决定。对于一个引物：$P_{\\text{match}}(22, 2) = \\sum_{k=0}^{2} \\binom{22}{k} (1/4)^{22-k} (3/4)^k \\approx 4.9 \\times 10^{-11}$。一个读数对要成为FP，必须匹配两个引物：$P(\\text{FP}) = (P_{\\text{match}}(22, 2))^2 \\approx (4.9 \\times 10^{-11})^2 \\approx 2.4 \\times 10^{-21}$。这个值远小于要求的 $10^{-6}$。长度阈值 $i \\le 8$（或 $L_{\\mathrm{merge}} \\le 52$）非常保守，因为它远离从 $i=120$ 开始的合法插入范围。此规则在统计上是合理的，具有高灵敏度、极高的特异性，并且是保守的。**结论：正确**\n\n**B. 此选项使用一个短的 $12$-nt 种子序列。对于一个 $12$-mer 来说，$m=3$ 的错配容许度非常宽松（$25\\%$ 的错配）。在 $12$ nt 中预期的错误数是 $12 \\times 0.005 = 0.06$。允许 $m=1$ 个错配将捕获 $P(k \\le 1) = (0.995)^{12} + 12(0.005)(0.995)^{11} \\approx 0.998$ 的真实种子序列。允许 $m=3$ 是过度的，并且不必要地损害了特异性。让我们计算此规则的随机匹配概率：$P_{\\text{match}}(12, 3) = \\sum_{k=0}^{3} \\binom{12}{k} (1/4)^{12-k} (3/4)^k \\approx 3.9 \\times 10^{-4}$。一个读数对的FP概率是 $P(\\text{FP}) = (P_{\\text{match}}(12, 3))^2 \\approx (3.9 \\times 10^{-4})^2 \\approx 1.5 \\times 10^{-7}$。虽然 $1.5 \\times 10^{-7}  10^{-6}$，但这个FP率比选项A高出 $10^{13}$ 倍以上。参数选择没有被错误模型很好地证明，并且该规则明显不如A保守。$i\\le20$ 的长度阈值也不如A保守，尽管仍然可以接受。**结论：不正确**（此选项可行，但不如A正确和保守）。\n\n**C. 此选项有根本性缺陷。引物二聚体是由*两个*引物形成的人工产物。一个只要求一个引物的规则对于这类人工产物不具有特异性。它会标记任何恰好以其中一个引物序列开头的短读数。此外，长度阈值 $L_{\\mathrm{frag}} \\le 100$ nt 对应于 $i \\le 100-44 = 56$ nt 的插入序列。这是一个非常宽松的阈值，增加了过滤掉带有大片段删除的合法读数的风险。**结论：不正确**\n\n**D. 此选项要求完全匹配（$m=0$）。如计算所示，单个引物被测序而没有任何错误的概率是 $P(k=0) \\approx 0.895$。一个二聚体中的*两个*引物都被完美测序的概率是 $(0.895)^2 \\approx 0.801$。这意味着该规则将无法检测大约 $20\\%$ 的真实引物二聚体人工产物，导致高假阴性率。虽然此规则具有最高的特异性（具有最低的FP率），但它不是“正确的”，因为它在去除引物二聚体的既定任务上是无效的。主要目标是清理数据，而留下 $20\\%$ 的目标人工产物是糟糕的性能。**结论：不正确**\n\n### 结论\n\n选项A提出了最科学严谨、平衡和保守的方法。它使用全长引物序列以获得最大特异性，允许统计上合理的错配数以确保高灵敏度，要求两个引物都符合二聚体的定义，并应用了一个安全、保守的长度阈值。它稳健地满足了所有既定要求。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在基因组学数据分析中，不存在“一刀切”的完美方案。本练习旨在将您的思维从对单个读段的过滤提升到设计全面的数据处理策略的高度。您将认识到，最优的过滤参数高度依赖于具体的测序方案（如杂交捕获与扩增子测序）和生物样本类型（如组织DNA与游离DNA）。这项挑战要求您综合运用所学知识，为不同的真实世界应用场景量身定制精细化的过滤规则。",
            "id": "4313865",
            "problem": "在精准肿瘤学中，一个靶向二代测序工作流程在比对前会使用接头修剪和读段（read）过滤。修剪后，每个读段的长度 $L$ 可变；一个最小长度过滤器会丢弃长度 $L  L_{\\min}$ 的读段。假设以下基本事实和定义成立：\n\n- 在一个大小为 $G$ 的大型真核生物基因组中（例如，人类基因组 $G \\approx 3\\times 10^{9}\\,\\mathrm{bp}$），一个随机 $L$-mer 的精确匹配期望计数大致与 $G/4^{L}$ 成比例，但真实基因组富含重复序列和低复杂度序列，这增加了小 $L$ 值的多重比对。\n- 在双末端测序中，从一个插入片段大小为 $I$ 的 DNA 片段生成两个读段，合适的配对需满足围绕 $I$ 的方向和距离约束；与单末端比对相比，一致性配对降低了伪比对的概率。\n- 在杂交捕获中，生物素化探针（“诱饵”）富集目标区域，但比对仍然是针对全基因组进行的；比对后，靶向读段是指那些比对结果与目标区间重叠的读段。\n- 在扩增子工作流程中，引物二聚体产物会产生主要由引物序列组成的短片段，这些片段对于变异检出没有信息价值，并且可能产生伪比对。\n- 唯一分子标识符（UMI）能够实现一致性序列生成，从而抑制随机测序错误，但不能纠正系统性的错误比对。\n\n您必须根据这些原则进行推理，为以下三个真实的肿瘤学方案，在保留靶向短片段与错误比对及产物残留的风险之间取得平衡：\n\n- 方案 $\\mathrm{P1}$（组织杂交捕获）：靶向区域大小 $1.5\\,\\mathrm{Mb}$，诱饵长度 $120\\,\\mathrm{nt}$，双末端 $2\\times 150\\,\\mathrm{bp}$，插入片段大小中位数 $I \\approx 220\\,\\mathrm{bp}$ 且具有中等变异性，靶向重复率约为 $20\\%$，并且在比对前已整合并修剪了 $12\\,\\mathrm{nt}$ 的 UMI。\n- 方案 $\\mathrm{P2}$（扩增子，血浆）：约 $300$ 个扩增子，平均长度 $160\\,\\mathrm{bp}$，每个引物长度约 $25\\,\\mathrm{nt}$，双末端 $2\\times 150\\,\\mathrm{bp}$，在 $40$–$60\\,\\mathrm{bp}$ 处有频繁的引物二聚体峰，无 UMI。\n- 方案 $\\mathrm{P3}$（游离 DNA 杂交捕获）：靶向区域大小 $500\\,\\mathrm{kb}$，诱饵长度 $80\\,\\mathrm{nt}$，双末端 $2\\times 100\\,\\mathrm{bp}$，游离 DNA 片段长度众数为 $167\\,\\mathrm{bp}$，并有许多 $90$–$150\\,\\mathrm{bp}$ 的片段，$10\\,\\mathrm{nt}$ UMI，用于稀有变异检测的超深度覆盖。\n\n考虑到过于激进的 $L_{\\min}$ 会在 $\\mathrm{P3}$ 中加剧等位基因偏好和覆盖度丢失，而过于宽松的 $L_{\\min}$ 则会在 $\\mathrm{P1}$ 和 $\\mathrm{P2}$ 中因错误比对或产物读段而增加假阳性。请从以下选项中选择一个最佳策略，用于接头修剪后针对特定方案的最小长度过滤（应用于每个配对读段），包括任何配对层面的“拯救”规则，以在控制产物和错误比对风险的同时，最大化地保留有信息价值的靶向短片段。\n\nA. 一刀切：对所有 $\\mathrm{P1}$–$\\mathrm{P3}$ 方案设置 $L_{\\min} = 50\\,\\mathrm{bp}$；无一例外地丢弃任何短于 $50\\,\\mathrm{bp}$ 的配对读段；不使用任何配对层面的拯救规则。\n\nB. 针对特定方案，并在合理情况下进行双末端拯救：\n- $\\mathrm{P1}$：设置 $L_{\\min} = 40\\,\\mathrm{bp}$；如果配对的两个读段都作为合适的配对进行比对，并且两个重叠都在靶向区域上，则接受短至 $30\\,\\mathrm{bp}$ 的配对读段（即，仅当得到合适的靶向配对支持时才拯救 $30 \\le L  40\\,\\mathrm{bp}$ 的读段）；否则丢弃。\n- $\\mathrm{P2}$：设置 $L_{\\min} = 60\\,\\mathrm{bp}$；不拯救低于 $60\\,\\mathrm{bp}$ 的读段，以抑制引物二聚体和仅含引物的读段。\n- $\\mathrm{P3}$：设置 $L_{\\min} = 30\\,\\mathrm{bp}$；要求所有保留的读段都具有合适的配对和靶向重叠；允许比对后进行基于 UMI 的一致性序列折叠。\n\nC. 在所有方案中积极保留短读段：为 $\\mathrm{P1}$ 和 $\\mathrm{P3}$ 设置 $L_{\\min} = 20\\,\\mathrm{bp}$，为 $\\mathrm{P2}$ 设置 $L_{\\min} = 30\\,\\mathrm{bp}$；接受任何比对到靶向区域的读段，无论其配对或方向如何；如果存在 UMI，则期望其能减轻任何错误膨胀。\n\nD. 诱饵长度启发式规则：对于捕获方案，将 $L_{\\min}$ 设置为诱饵长度的一半，对于扩增子方案则设置一个下限：\n- $\\mathrm{P1}$：$L_{\\min} = 60\\,\\mathrm{bp}$（$120\\,\\mathrm{nt}$ 诱饵的一半）。\n- $\\mathrm{P2}$：$L_{\\min} = 40\\,\\mathrm{bp}$（较短以避免丢失扩增子覆盖度）。\n- $\\mathrm{P3}$：$L_{\\min} = 40\\,\\mathrm{bp}$（$80\\,\\mathrm{nt}$ 诱饵的一半）。\n忽略配对层面的拯救和靶向配对约束。\n\n基于第一性原理和真实的实验约束，哪个选项最适合设置最小长度过滤器，既能尊重靶向捕获设计，又能保留有信息价值的靶向短片段？",
            "solution": "任务是为肿瘤学中的三种不同的二代测序（NGS）方案，在接头修剪后，确定最合适的设置最小读段长度过滤器（$L_{\\min}$）的策略。该策略必须从一系列基本原则和特定于方案的细节中推导出来，旨在最大化保留信息性数据的同时，控制产物和错误比对的风险。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n-   **基本原则：**\n    -   基因组大小 $G \\approx 3\\times 10^{9}\\,\\mathrm{bp}$。\n    -   一个随机 $L$-mer 的精确匹配期望计数 $\\sim G/4^{L}$。真实基因组有重复序列，增加了小 $L$ 值的多重比对。\n    -   双末端测序和合适的配对可减少伪比对。\n    -   杂交捕获比对到全基因组；靶向读段与靶向区间重叠。\n    -   扩增子工作流程可产生短的引物二聚体产物。\n    -   唯一分子标识符（UMI）纠正随机测序错误，但不纠正系统性错误比对。\n-   **方案 P1（组织杂交捕获）：**\n    -   靶向区域：$1.5\\,\\mathrm{Mb}$，双末端 $2\\times 150\\,\\mathrm{bp}$，UMI（$12\\,\\mathrm{nt}$），诱饵长度 $120\\,\\mathrm{nt}$，插入片段大小中位数 $I \\approx 220\\,\\mathrm{bp}$。\n-   **方案 P2（扩增子，血浆）：**\n    -   靶向区域：约 $300$ 个扩增子（平均长度 $160\\,\\mathrm{bp}$），双末端 $2\\times 150\\,\\mathrm{bp}$，无 UMI，引物长度约 $25\\,\\mathrm{nt}$，在 $40$–$60\\,\\mathrm{bp}$ 处有频繁的引物二聚体产物。\n-   **方案 P3（游离 DNA 杂交捕获）：**\n    -   靶向区域：$500\\,\\mathrm{kb}$，双末端 $2\\times 100\\,\\mathrm{bp}$，UMI（$10\\,\\mathrm{nt}$），诱饵长度 $80\\,\\mathrm{nt}$，cfDNA 片段长度众数为 $167\\,\\mathrm{bp}$，有许多 $90$–$150\\,\\mathrm{bp}$ 范围的片段。\n-   **一般性考虑：**\n    -   高 $L_{\\min}$ 对 P3 不利（等位基因偏好，覆盖度丢失）。\n    -   低 $L_{\\min}$ 对 P1 和 P2 不利（来自错误比对/产物的假阳性）。\n    -   过滤器应用于每个配对读段，可能存在配对的“拯救”规则。\n\n**步骤2：使用提取的已知条件进行验证**\n问题陈述具有科学依据。关于 NGS 技术（双末端测序、杂交捕获、扩增子、UMI）、其典型产物（引物二聚体、错误比对）以及三种方案的参数对象的描述在临床基因组学领域都是标准且现实的。问题的核心是在灵敏度（保留短但有信息价值的读段）和特异性（拒绝产物和伪比对读段）之间的权衡，这是生物信息学流程设计中的一个核心挑战。该问题提法恰当，为推理不同过滤策略的相对优点提供了充分的信息。它是客观、完整的，并且不包含科学或逻辑上的矛盾。语言精确并使用了标准术语。该问题并非无足轻重，需要对实验设计和数据分析之间的相互作用有细致的理解。\n\n**步骤3：结论和行动**\n问题是有效的。我将继续进行解决方案的推导和选项的评估。\n\n### 推导与选项分析\n\n最优策略必须根据每个方案的具体特点量身定制。\n\n**方案P1（组织杂交捕获）分析：**\n-   这是一个标准的杂交捕获实验。如果 DNA 片段短于 $150\\,\\mathrm{bp}$，读段长度可能就会短于原始读长（$150\\,\\mathrm{bp}$）。\n-   主要关注点是短读段的比对模糊性。对于小的 L 值，一个 L-mer 的唯一性很低。例如，对于 $L=30$，随机匹配的期望数很低（$G/4^L \\approx 0.0026$），但基因组中的重复结构可能导致一个 $30$-mer 比对到多个位置。\n-   关键的缓解因素是双末端信息。如果一个短读段的配对读段能够可靠地比对，那么这个短读段的基因组来源就受到了强有力的约束。这就是“拯救”一个短配对读段背后的原理。\n-   另一个证据层是靶向要求。一个正确配对的、在靶向区域上的读段对极不可能是伪比对。\n-   因此，一个明智的策略是设置一个适中的最小长度（例如，$L_{\\min}=40\\,\\mathrm{bp}$）来过滤掉最有问题的读段，但如果更短的读段（例如，短至 $L \\approx 30\\,\\mathrm{bp}$）属于高置信度的配对（正确配对且在靶向区域上），则对其进行拯救。这可以在不过度牺牲特异性的情况下最大化灵敏度。\n\n**方案P2（扩增子，血浆）分析：**\n-   其定义性特征是存在短的（$40$–$60\\,\\mathrm{bp}$）引物二聚体产物。这些是非生物性的，必须被移除以避免假阳性变异检出。\n-   读段长度过滤器是消除这些产物的直接而有效的方法。将 $L_{\\min}$ 设置为刚好高于这个范围，例如，$L_{\\min}=60\\,\\mathrm{bp}$，将会非常有效。\n-   由于 $40$–$60\\,\\mathrm{bp}$ 范围内的读段来源绝大多数是产物，因此没有理由使用“拯救”机制。拯救这些读段会适得其反，重新引入我们希望过滤掉的产物。真实的信号来自于约 $160\\,\\mathrm{bp}$ 的扩增子，它们将产生接近全长（约 $150\\,\\mathrm{bp}$）的读段。\n-   因此，一个严格、高的 $L_{\\min}$ 并且没有拯救机制是此方案最合适的策略。\n\n**方案P3（cfDNA 杂交捕获）分析：**\n-   其定义性特征是短的 DNA 片段是感兴趣的生物信号。cfDNA 片段组学中，有大量片段短于 $167\\,\\mathrm{bp}$ 的主峰。\n-   问题明确警告说，一个激进的（高的）$L_{\\min}$ 会导致“等位基因偏好和覆盖度丢失”。这意味着我们必须使用一个宽松的（低的）$L_{\\min}$ 来保留这些短的、有信息价值的片段。\n-   一个低的 $L_{\\min}$（例如，$30\\,\\mathrm{bp}$）增加了错误比对的风险。为了应对这一点，我们必须利用所有其他可用的证据。与 P1 一样，这是一个基于双末端捕获的实验。\n-   确保特异性的最稳健方法是要求*所有*保留的读段，尤其是短读段，都属于一个正确比对的配对，并且它们的比对结果与目标区域重叠。这种过滤器组合非常强大。\n-   UMI存在，并且对于纠正PCR/测序错误和从深度测序数据中获得准确的等位基因频率至关重要，但它们不能修复比对错误。必须依赖于基于比对的质量指标。\n\n**推导出的最优策略总结：**\n-   **P1：** 适中的 $L_{\\min}$（例如，$40\\,\\mathrm{bp}$），并为在靶向区域上的较短读段（例如，$30\\,\\mathrm{bp}$）提供基于配对的拯救。\n-   **P2：** 高且严格的 $L_{\\min}$（例如，$60\\,\\mathrm{bp}$），不进行拯救，以消除引物二聚体。\n-   **P3：** 低的 $L_{\\min}$（例如，$30\\,\\mathrm{bp}$），并对所有读段都要求正确的配对和靶向状态。\n\n现在可以将这个推导出的策略框架与所提供的选项进行比较。\n\n---\n\n**A. 一刀切：对所有 $\\mathrm{P1}$–$\\mathrm{P3}$ 方案设置 $L_{\\min} = 50\\,\\mathrm{bp}$；无一例外地丢弃任何短于 $50\\,\\mathrm{bp}$ 的配对读段；不使用任何配对层面的拯救规则。**\n这个策略是不合适的。单一的 $L_{\\min}$ 未能考虑到不同方案的需求。它对 P2 来说太宽松，因为 $50\\,\\mathrm{bp}$ 的 $L_{\\min}$ 会保留许多引物二聚体产物（$40$–$60\\,\\mathrm{bp}$）。它对 P3 来说太严格，因为它会丢弃短于 $50\\,\\mathrm{bp}$ 的有信息价值的 cfDNA 片段。缺乏拯救机制是一个普遍的弱点，未能利用双末端信息。\n**结论：不正确。**\n\n**B. 针对特定方案，并在合理情况下进行双末端拯救：**\n-   **P1：** 设置 $L_{\\min} = 40\\,\\mathrm{bp}$，并为正确的、在靶向区域上的配对拯救短至 $30\\,\\mathrm{bp}$ 的读段。这完全符合推导出的最优策略，平衡了灵敏度和特异性。\n-   **P2：** 设置 $L_{\\min} = 60\\,\\mathrm{bp}$，不进行拯救。这是消除已知的 $40$–$60\\,\\mathrm{bp}$ 引物二聚体产物的正确的激进过滤策略。\n-   **P3：** 设置 $L_{\\min} = 30\\,\\mathrm{bp}$，并要求所有读段都具有正确的配对和靶向状态。这正确地优先考虑了短 cfDNA 片段的灵敏度，同时使用严格的基于比对的标准来控制错误比对。\n这个选项的策略是一个细致入微、理由充分且针对特定方案的方法，与从第一性原理的推导完全一致。\n**结论：正确。**\n\n**C. 在所有方案中积极保留短读段：为 $\\mathrm{P1}$ 和 $\\mathrm{P3}$ 设置 $L_{\\min} = 20\\,\\mathrm{bp}$，为 $\\mathrm{P2}$ 设置 $L_{\\min} = 30\\,\\mathrm{bp}$；接受任何比对到靶向区域的读段，无论其配对或方向如何；如果存在 UMI，则期望其能减轻任何错误膨胀。**\n这个策略是鲁莽的。$20\\,\\mathrm{bp}$ 的 $L_{\\min}$ 对于在人类基因组中进行明确的比对来说太低，会引入大量的假阳性。对 P2 使用 $30\\,\\mathrm{bp}$ 的 $L_{\\min}$ 会保留所有引物二聚体产物。丢弃双末端方向和距离约束是一个严重的错误，它消除了对抗伪比对的最强大过滤器之一。关于 UMI 减轻比对错误的说法与问题陈述中的一个前提明确矛盾。\n**结论：不正确。**\n\n**D. 诱饵长度启发式规则：对于捕获方案，将 $L_{\\min}$ 设置为诱饵长度的一半，对于扩增子方案则设置一个下限：**\n-   **P1：** $L_{\\min} = 60\\,\\mathrm{bp}$（$120\\,\\mathrm{nt}$ 的一半）。这是不必要的激进，并且缺乏拯救机制。\n-   **P2：** $L_{\\min} = 40\\,\\mathrm{bp}$。这是一个灾难性的选择，因为它确保了 $40$–$60\\,\\mathrm{bp}$ 引物二聚体产物的保留。\n-   **P3：** $L_{\\min} = 40\\,\\mathrm{bp}$（$80\\,\\mathrm{nt}$ 的一半）。这对于 cfDNA 来说可能过于激进。\n将 $L_{\\min}$ 与诱饵长度联系起来的核心启发式规则是武断的，没有基于合理的原则。诱饵长度与捕获效率有关，而 $L_{\\min}$ 与比对特异性有关。此外，该策略忽略了双末端拯救，这是一个关键工具。\n**结论：不正确。**\n\n分析表明，选项 B 是唯一一个反映了对每个特定基因组学应用中所涉及的权衡有深刻和正确理解的选项。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}