{
    "hands_on_practices": [
        {
            "introduction": "联邦学习的核心在于聚合多个客户端的计算结果，而聚合规则的选择对最终模型的稳定性和可靠性至关重要。虽然联邦平均（Federated Averaging）是一种基础方法，但它对异常值或损坏的数据更新非常敏感，这在真实的基因组学研究中是常见问题。本练习旨在通过一个包含异常更新的假设场景，让您亲手量化不同聚合策略的差异，从而深入理解健壮性统计在构建可靠的隐私保护机器学习系统中的关键作用 。",
            "id": "4339357",
            "problem": "七个学术医疗中心在隐私保护的联邦学习中进行合作，使用正则化逻辑回归训练一个基因组分类器，以区分致病性变异和良性变异。在跨孤岛联邦分析框架下，每个站点根据其私有梯度步骤计算一个位于 $\\mathbb{R}^{4}$ 中的局部参数更新向量，并与聚合器共享，而不泄露原始的基因型-表型数据。考虑以下来自 $n=7$ 个站点的局部更新向量（行向量）：\n$$\nu_{1} = (0.12,\\,-0.08,\\,0.05,\\,0.01),\\quad\nu_{2} = (0.10,\\,-0.07,\\,0.06,\\,0.02),\\quad\nu_{3} = (0.11,\\,-0.09,\\,0.04,\\,0.03),\n$$\n$$\nu_{4} = (0.09,\\,-0.06,\\,0.05,\\,0.00),\\quad\nu_{5} = (0.13,\\,-0.07,\\,0.07,\\,0.02),\\quad\nu_{6} = (0.12,\\,-0.08,\\,0.06,\\,0.01),\n$$\n$$\nu_{7} = (2.00,\\,-1.50,\\,1.20,\\,0.80).\n$$\n假设 $u_{7}$ 是一个由暂时的变异检出流程中的错误引起的异常值。考虑两种典型的聚合规则：\n- 联邦平均 (FedAvg)：均值更新 $\\bar{u} = \\frac{1}{n}\\sum_{i=1}^{n} u_{i}$，\n- 逐坐标中位数：向量 $u_{\\mathrm{med}}$，其第 $j$ 个坐标是 $\\{u_{1j},\\dots,u_{nj}\\}$ 的中位数，其中 $j \\in \\{1,2,3,4\\}$。\n\n从此类聚合器的标准定义出发，计算在此情境下均值与逐坐标中位数之间的欧几里得距离 $\\|\\bar{u} - u_{\\mathrm{med}}\\|_{2}$。请以最简精确分数形式提供您的最终数值答案。简要解释此差异对联邦训练下基因组分类器稳定性的鲁棒性影响，将您的推理建立在鲁棒统计学的公认属性之上，并且不引用任何原始的患者级别数据。",
            "solution": "该情境是精准医疗中的跨孤岛联邦学习，其中每个站点 $i \\in \\{1,\\dots,7\\}$ 将一个局部更新向量 $u_{i} \\in \\mathbb{R}^{4}$ 发送给聚合器。聚合器使用算术平均（联邦平均）或逐坐标中位数来形成全局更新。我们从基本定义出发：\n\n1. 联邦平均 (FedAvg) 的均值定义为\n$$\n\\bar{u} \\equiv \\frac{1}{n} \\sum_{i=1}^{n} u_{i},\n$$\n其中 $n=7$。\n\n2. 逐坐标中位数 $u_{\\mathrm{med}}$ 的定义是，对于每个坐标 $j \\in \\{1,2,3,4\\}$，计算多重集 $\\{u_{1j},\\dots,u_{7j}\\}$ 的中位数；对于奇数 $n$，中位数是该坐标排序后的第 $\\frac{n+1}{2}$ 个元素。\n\n3. 欧几里得距离定义为\n$$\n\\|\\bar{u} - u_{\\mathrm{med}}\\|_{2} = \\sqrt{\\sum_{j=1}^{4} \\left(\\bar{u}_{j} - (u_{\\mathrm{med}})_{j}\\right)^{2}}.\n$$\n\n我们逐坐标计算 $\\bar{u}$。\n\n- 坐标 1：\n$$\n\\sum_{i=1}^{6} u_{i1} = 0.12 + 0.10 + 0.11 + 0.09 + 0.13 + 0.12 = 0.67,\\quad \\text{且 } u_{71}=2.00.\n$$\n因此，\n$$\n\\bar{u}_{1} = \\frac{0.67 + 2.00}{7} = \\frac{2.67}{7} = \\frac{267}{700}.\n$$\n\n- 坐标 2：\n$$\n\\sum_{i=1}^{6} u_{i2} = -0.08 - 0.07 - 0.09 - 0.06 - 0.07 - 0.08 = -0.45,\\quad \\text{且 } u_{72}=-1.50.\n$$\n因此，\n$$\n\\bar{u}_{2} = \\frac{-0.45 - 1.50}{7} = \\frac{-1.95}{7} = -\\frac{195}{700} = -\\frac{39}{140}.\n$$\n\n- 坐标 3：\n$$\n\\sum_{i=1}^{6} u_{i3} = 0.05 + 0.06 + 0.04 + 0.05 + 0.07 + 0.06 = 0.33,\\quad \\text{且 } u_{73}=1.20.\n$$\n因此，\n$$\n\\bar{u}_{3} = \\frac{0.33 + 1.20}{7} = \\frac{1.53}{7} = \\frac{153}{700}.\n$$\n\n- 坐标 4：\n$$\n\\sum_{i=1}^{6} u_{i4} = 0.01 + 0.02 + 0.03 + 0.00 + 0.02 + 0.01 = 0.09,\\quad \\text{且 } u_{74}=0.80.\n$$\n因此，\n$$\n\\bar{u}_{4} = \\frac{0.09 + 0.80}{7} = \\frac{0.89}{7} = \\frac{89}{700}.\n$$\n\n接下来，计算逐坐标中位数。对每个坐标，将 7 个值排序并取第 4 个。\n\n- 坐标 1 的值：\n$$\n\\{0.12,\\,0.10,\\,0.11,\\,0.09,\\,0.13,\\,0.12,\\,2.00\\} \\to \\{0.09,\\,0.10,\\,0.11,\\,0.12,\\,0.12,\\,0.13,\\,2.00\\},\n$$\n中位数是第 4 个值，0.12，因此 $(u_{\\mathrm{med}})_{1} = \\frac{12}{100} = \\frac{3}{25}$。\n\n- 坐标 2 的值：\n$$\n\\{-0.08,\\,-0.07,\\,-0.09,\\,-0.06,\\,-0.07,\\,-0.08,\\,-1.50\\} \\to \\{-1.50,\\,-0.09,\\,-0.08,\\,-0.08,\\,-0.07,\\,-0.07,\\,-0.06\\},\n$$\n中位数是第 4 个值，-0.08，因此 $(u_{\\mathrm{med}})_{2} = -\\frac{8}{100} = -\\frac{2}{25}$。\n\n- 坐标 3 的值：\n$$\n\\{0.05,\\,0.06,\\,0.04,\\,0.05,\\,0.07,\\,0.06,\\,1.20\\} \\to \\{0.04,\\,0.05,\\,0.05,\\,0.06,\\,0.06,\\,0.07,\\,1.20\\},\n$$\n中位数是第 4 个值，0.06，因此 $(u_{\\mathrm{med}})_{3} = \\frac{6}{100} = \\frac{3}{50}$。\n\n- 坐标 4 的值：\n$$\n\\{0.01,\\,0.02,\\,0.03,\\,0.00,\\,0.02,\\,0.01,\\,0.80\\} \\to \\{0.00,\\,0.01,\\,0.01,\\,0.02,\\,0.02,\\,0.03,\\,0.80\\},\n$$\n中位数是第 4 个值，0.02，因此 $(u_{\\mathrm{med}})_{4} = \\frac{2}{100} = \\frac{1}{50}$。\n\n因此，\n$$\nu_{\\mathrm{med}} = \\left(\\frac{3}{25},\\, -\\frac{2}{25},\\, \\frac{3}{50},\\, \\frac{1}{50}\\right).\n$$\n\n逐坐标地构建差值 $d \\equiv \\bar{u} - u_{\\mathrm{med}}$：\n$$\nd_{1} = \\frac{267}{700} - \\frac{3}{25} = \\frac{267}{700} - \\frac{84}{700} = \\frac{183}{700},\n$$\n$$\nd_{2} = -\\frac{39}{140} - \\left(-\\frac{2}{25}\\right) = -\\frac{195}{700} + \\frac{56}{700} = -\\frac{139}{700},\n$$\n$$\nd_{3} = \\frac{153}{700} - \\frac{3}{50} = \\frac{153}{700} - \\frac{42}{700} = \\frac{111}{700},\n$$\n$$\nd_{4} = \\frac{89}{700} - \\frac{1}{50} = \\frac{89}{700} - \\frac{14}{700} = \\frac{75}{700}.\n$$\n\n计算欧几里得范数：\n$$\n\\|\\bar{u} - u_{\\mathrm{med}}\\|_{2} = \\sqrt{\\left(\\frac{183}{700}\\right)^{2} + \\left(\\frac{139}{700}\\right)^{2} + \\left(\\frac{111}{700}\\right)^{2} + \\left(\\frac{75}{700}\\right)^{2}}\n= \\frac{1}{700}\\sqrt{183^{2} + 139^{2} + 111^{2} + 75^{2}}.\n$$\n计算平方和：\n$$\n183^{2} = 33489,\\quad 139^{2} = 19321,\\quad 111^{2} = 12321,\\quad 75^{2} = 5625,\n$$\n$$\n33489 + 19321 + 12321 + 5625 = 70756.\n$$\n注意到 $70756 = 266^{2}$，因此\n$$\n\\|\\bar{u} - u_{\\mathrm{med}}\\|_{2} = \\frac{266}{700} = \\frac{133}{350} = \\frac{19}{50}.\n$$\n\n鲁棒性影响的解释：在鲁棒统计学中，逐坐标中位数的崩溃点为 0.5，意味着它在每个坐标上可以容忍高达近 50% 的任意污染而不会发散，而均值的崩溃点为 0，并且对极端异常值高度敏感。在这里，尽管存在非常大的异常值 $u_{7}$，逐坐标中位数 $u_{\\mathrm{med}}$ 仍然接近六个非异常更新的中心趋势，而均值 $\\bar{u}$ 则被显著地移动了。欧几里得距离 $\\frac{19}{50}$ 量化了这种移动：一个主要由单个极端更新引起的相当大的差异。对于基因组分类器的联邦训练，选择逐坐标中位数聚合可以增强对偶尔出现的损坏或对抗性更新的稳定性，从而降低将伪信号传播到模型参数中的风险，所有这一切都无需通过共享原始患者级别的基因组数据来损害隐私。",
            "answer": "$$\\boxed{\\frac{19}{50}}$$"
        },
        {
            "introduction": "在聚合模型更新时，即使不共享原始数据，更新本身也可能泄露敏感信息。差分隐私（Differential Privacy, DP）为量化和控制这种隐私风险提供了严格的数学框架。在联邦学习中应用差分隐私（例如，通过DP-SGD），关键一步是精确计算聚合函数对单个客户端数据变化的敏感度（sensitivity）。这个练习将指导您计算联邦平均算法中一个关键的隐私参数——$L_2$敏感度，这是确定实现特定隐私级别所需添加噪声量的基础 。",
            "id": "4339375",
            "problem": "一个由四家基因组学实验室组成的联合体通过联邦学习（FL）进行合作，在精准医疗和基因组诊断的背景下，训练一个用于罕见变异致病性分析的分类器。每个机构训练一个本地模型，并生成一个本地参数更新向量 $u_k \\in \\mathbb{R}^{3}$，其中 $k \\in \\{1,2,3,4\\}$ 是机构的索引。为遵循隐私保护数据共享原则，系统在全局聚合中采用安全聚合（Secure Aggregation）技术，并根据数据集大小进行加权。令 $n_k$ 表示机构 $k$ 使用的基因组数量，$n = \\sum_{k=1}^{4} n_k$ 为所有机构的基因组总数。全局模型更新是客户端更新的加权平均值，权重为 $\\alpha_k = \\frac{n_k}{n}$，该权重根据数据集大小计算。\n\n该联合体从差分隐私（DP）的角度，在由 $L_2$ 范数诱导的平方欧几里得几何下，追踪聚合规则对单个异常更新的敏感度。对于客户端级别的邻接性（即替换一个客户端的整个更新，而其他客户端保持不变），在聚合之前，本地更新会经过范数裁剪，以确保对于一个固定的裁剪半径 $C > 0$ 满足 $\\|u_k\\|_{2} \\leq C$。\n\n使用以下来自一个真实联邦学习训练轮次的数据：\n- 客户端数据集大小：$n_1 = 1200$，$n_2 = 2200$，$n_3 = 1800$，$n_4 = 800$，于是 $n = 6000$。\n- 本地更新：$u_1 = (0.6, -0.2, 0.1)$，$u_2 = (-0.5, 0.3, 0.0)$，$u_3 = (0.2, 0.1, -0.4)$，$u_4 = (0.0, -0.1, 0.2)$。\n- 裁剪半径：$C = 3$。\n\n任务：\n1. 计算全局更新 $u = \\sum_{k=1}^{4} \\alpha_k u_k$。\n2. 对于客户端级别的邻接性和 $L_2$ 范数裁剪，推导聚合规则在将客户端2的裁剪后更新替换为另一个同样满足范数约束 $\\|u_2\\|_{2} \\leq C$ 的更新时的最差情况 $L_2$ 敏感度。\n\n仅报告客户端2的最差情况 $L_2$ 敏感度作为最终数值答案。无需四舍五入，最终报告值不使用单位。",
            "solution": "该问题要求完成两个任务，但最终答案仅需要第二个任务的结果。为了提供一个完整的解答，我们将处理这两个任务。\n\n首先，我们整理给定的数据。\n合作机构的数量为 $4$。\n每个机构 $k \\in \\{1, 2, 3, 4\\}$ 的数据集大小为：\n$n_1 = 1200$\n$n_2 = 2200$\n$n_3 = 1800$\n$n_4 = 800$\n\n基因组总数为 $n = \\sum_{k=1}^{4} n_k = 1200 + 2200 + 1800 + 800 = 6000$。\n\n聚合的权重为 $\\alpha_k = \\frac{n_k}{n}$。\n$\\alpha_1 = \\frac{1200}{6000} = \\frac{12}{60} = \\frac{1}{5}$\n$\\alpha_2 = \\frac{2200}{6000} = \\frac{22}{60} = \\frac{11}{30}$\n$\\alpha_3 = \\frac{1800}{6000} = \\frac{18}{60} = \\frac{3}{10}$\n$\\alpha_4 = \\frac{800}{6000} = \\frac{8}{60} = \\frac{2}{15}$\n快速检查可确认 $\\sum_{k=1}^{4} \\alpha_k = \\frac{1}{5} + \\frac{11}{30} + \\frac{3}{10} + \\frac{2}{15} = \\frac{6}{30} + \\frac{11}{30} + \\frac{9}{30} + \\frac{4}{30} = \\frac{30}{30} = 1$。\n\n本地更新如下所示：\n$u_1 = (0.6, -0.2, 0.1)$\n$u_2 = (-0.5, 0.3, 0.0)$\n$u_3 = (0.2, 0.1, -0.4)$\n$u_4 = (0.0, -0.1, 0.2)$\n\n更新将以半径 $C = 3$ 进行范数裁剪，这意味着用于聚合的每个更新 $u_k$ 都必须满足 $\\|u_k\\|_2 \\le 3$。我们来验证给定的更新是否满足此条件。\n$\\|u_1\\|_2 = \\sqrt{0.6^2 + (-0.2)^2 + 0.1^2} = \\sqrt{0.36 + 0.04 + 0.01} = \\sqrt{0.41}  3$。\n$\\|u_2\\|_2 = \\sqrt{(-0.5)^2 + 0.3^2 + 0.0^2} = \\sqrt{0.25 + 0.09 + 0.0} = \\sqrt{0.34}  3$。\n$\\|u_3\\|_2 = \\sqrt{0.2^2 + 0.1^2 + (-0.4)^2} = \\sqrt{0.04 + 0.01 + 0.16} = \\sqrt{0.21}  3$。\n$\\|u_4\\|_2 = \\sqrt{0.0^2 + (-0.1)^2 + 0.2^2} = \\sqrt{0.01 + 0.04} = \\sqrt{0.05}  3$。\n由于所有本地更新的 $L_2$ 范数均小于裁剪半径 $C=3$，因此未对这些特定向量应用裁剪。\n\n任务1：计算全局更新 $u = \\sum_{k=1}^{4} \\alpha_k u_k$。\n$u = \\alpha_1 u_1 + \\alpha_2 u_2 + \\alpha_3 u_3 + \\alpha_4 u_4$\n$u = \\frac{1}{5} u_1 + \\frac{11}{30} u_2 + \\frac{3}{10} u_3 + \\frac{2}{15} u_4$\n为简化计算，我们使用公分母 $30$：\n$u = \\frac{1}{30} (6 u_1 + 11 u_2 + 9 u_3 + 4 u_4)$\n$6 u_1 = 6(0.6, -0.2, 0.1) = (3.6, -1.2, 0.6)$\n$11 u_2 = 11(-0.5, 0.3, 0.0) = (-5.5, 3.3, 0.0)$\n$9 u_3 = 9(0.2, 0.1, -0.4) = (1.8, 0.9, -3.6)$\n$4 u_4 = 4(0.0, -0.1, 0.2) = (0.0, -0.4, 0.8)$\n这些向量的和为：\n$x$分量：$3.6 - 5.5 + 1.8 + 0.0 = -0.1$\n$y$分量：$-1.2 + 3.3 + 0.9 - 0.4 = 2.6$\n$z$分量：$0.6 + 0.0 - 3.6 + 0.8 = -2.2$\n所以，和向量为 $(-0.1, 2.6, -2.2)$。\n全局更新为 $u = \\frac{1}{30}(-0.1, 2.6, -2.2) = (-\\frac{0.1}{30}, \\frac{2.6}{30}, -\\frac{2.2}{30}) = (-\\frac{1}{300}, \\frac{26}{300}, -\\frac{22}{300}) = (-\\frac{1}{300}, \\frac{13}{150}, -\\frac{11}{150})$。\n\n任务2：推导聚合规则在替换客户端2的更新时的最差情况 $L_2$ 敏感度。\n聚合函数为 $f(u_1, u_2, u_3, u_4) = \\sum_{k=1}^{4} \\alpha_k u_k$。\n$L_2$ 敏感度是根据客户端级别的邻接性定义的。对于客户端2，这意味着我们考虑两组输入，这两组输入除了来自客户端2的更新不同外，其他都相同。令这两组输入由更新元组 $U = (u_1, u_2, u_3, u_4)$ 和 $U' = (u_1, u_2', u_3, u_4)$ 表示。更新 $u_2$ 和 $u_2'$ 可以是 $\\mathbb{R}^3$ 中的任意向量，只要它们满足范数裁剪约束，即 $\\|u_2\\|_2 \\leq C$ 和 $\\|u_2'\\|_2 \\leq C$。\n\n客户端2的 $L_2$ 敏感度，记作 $\\Delta_2 f_2$，是在所有此类邻接输入集上，输出 $f$ 的 $L_2$ 范数的最大可能变化：\n$$ \\Delta_2 f_2 = \\max_{U, U' \\text{在客户端2上邻近}} \\| f(U) - f(U') \\|_2 $$\n让我们计算差值 $f(U) - f(U')$：\n$$ f(U) - f(U') = \\left(\\sum_{k=1}^4 \\alpha_k u_k\\right) - \\left(\\alpha_1 u_1 + \\alpha_2 u_2' + \\alpha_3 u_3 + \\alpha_4 u_4\\right) $$\n$$ f(U) - f(U') = \\alpha_2 u_2 - \\alpha_2 u_2' = \\alpha_2(u_2 - u_2') $$\n现在，我们取这个差值的 $L_2$ 范数：\n$$ \\|f(U) - f(U')\\|_2 = \\|\\alpha_2(u_2 - u_2')\\|_2 = |\\alpha_2| \\|u_2 - u_2'\\|_2 $$\n由于 $\\alpha_2 = \\frac{n_2}{n}$ 是非负的，所以 $|\\alpha_2| = \\alpha_2$。\n$$ \\|f(U) - f(U')\\|_2 = \\alpha_2 \\|u_2 - u_2'\\|_2 $$\n为了找到敏感度，我们必须在 $u_2$ 和 $u_2'$ 的所有有效选择上最大化这个量：\n$$ \\Delta_2 f_2 = \\max_{\\substack{\\|u_2\\|_2 \\leq C \\\\ \\|u_2'\\|_2 \\leq C}} \\alpha_2 \\|u_2 - u_2'\\|_2 = \\alpha_2 \\left( \\max_{\\substack{\\|u_2\\|_2 \\leq C \\\\ \\|u_2'\\|_2 \\leq C}} \\|u_2 - u_2'\\|_2 \\right) $$\n项 $\\max \\|u_2 - u_2'\\|_2$ 表示在以原点为中心、半径为 $C$ 的球内的任意两点之间的最大欧几里得距离。这个最大距离是球的直径，即 $2C$。当 $u_2$ 和 $u_2'$ 位于球面上且方向相反时，达到这个最大值，例如，$u_2 = v$ 和 $u_2' = -v$，其中 $\\|v\\|_2 = C$。在这种情况下，$\\|u_2 - u_2'\\|_2 = \\|v - (-v)\\|_2 = \\|2v\\|_2 = 2\\|v\\|_2 = 2C$。\n\n因此，关于客户端2的最差情况 $L_2$ 敏感度为：\n$$ \\Delta_2 f_2 = \\alpha_2 (2C) $$\n关键要注意的是，这个敏感度不依赖于问题中提供的实际更新向量，而只依赖于客户端在聚合中的权重和裁剪界限。\n\n现在我们代入给定的数值：\n$\\alpha_2 = \\frac{11}{30}$\n$C = 3$\n\n$$ \\Delta_2 f_2 = \\frac{11}{30} \\times (2 \\times 3) = \\frac{11}{30} \\times 6 = \\frac{66}{30} = \\frac{11}{5} $$\n客户端2的最差情况 $L_2$ 敏感度为 $\\frac{11}{5}$。",
            "answer": "$$\\boxed{\\frac{11}{5}}$$"
        },
        {
            "introduction": "在理论上设计出隐私保护算法后，我们必须面对将其部署到大规模现实世界网络中的工程挑战，其中通信效率是决定性因素之一。诸如安全聚合（Secure Aggregation）之类的隐私增强技术虽然能防止服务器窺探单个更新，但会引入额外的通信开销。本练习提供了一个系统分析的实践机会，您将从基本原理出发，为跨孤岛联邦学习场景建模通信复杂度和瓶颈，从而评估系统在特定带宽和时间预算下的可扩展性极限 。",
            "id": "4339316",
            "problem": "在一个用于精准医疗和基因组诊断的跨孤岛联邦学习（FL）设置中，假设有 $K$ 家医院参与安全聚合（SA）以保护患者级别的梯度。考虑通过使用椭圆曲线迪菲-赫尔曼（Elliptic-Curve Diffie–Hellman, ECDH）建立的成对掩码种子来实现 SA。设全局模型有效载荷的大小为 $S_{m} = 200 \\times 10^{6}$ 字节，并且掩码上传使用一种加密方案，其密文扩展因子为 $\\alpha = 2.2$，因此每家医院的掩码更新大小为 $S_{u} = \\alpha S_{m}$ 字节。在 SA 设置阶段，每家医院都与所有其他医院执行成对的 ECDH 密钥交换，向每个对等方发送一条大小为 $s_{k} = 64 \\times 10^{3}$ 字节的消息。假设医院链路是对称的，带宽为 $B_{h} = 200 \\times 10^{6}$ 比特/秒，中央服务器也是对称的，带宽为 $B_{s} = 10 \\times 10^{9}$ 比特/秒。所有链路都是全双工的，在每个阶段，传输并行进行，当其瓶颈链路完成时该阶段结束。\n\n从第一性原理出发——具体来说，即在容量为 $B$ 比特/秒的链路上，传输 $x$ 比特数据的通信时间为 $t = x/B$——推导 (i) 系统范围内的每轮通信复杂度（以比特为单位），(ii) 在此设置中 SA 的逻辑通信阶段数（轮次复杂度），以及 (iii) 总轮次持续时间 $T_{\\text{round}}(K)$，其为广播阶段、SA 握手阶段以及掩码上传和聚合阶段的持续时间之和，每个阶段的持续时间取其竞争瓶颈中的最大值。然后，在时间预算 $T_{\\text{budget}} = 180$ 秒的条件下，确定使得 $T_{\\text{round}}(K) \\leq T_{\\text{budget}}$ 成立的最大整数 $K$。\n\n将最终答案表示为一个不带单位的整数。如果需要四舍五入，则保留三位有效数字。仅当计算相关时才使用弧度或度；此处角度不相关。",
            "solution": "解决方案的步骤是，首先根据医院数量 $K$ 推导出通信复杂度和轮次持续时间的表达式。然后，使用这些表达式求解满足给定时间预算的最大 $K$ 值。所有数据大小必须从字节转换为比特，使用转换因子 $1$ 字节 $= 8$ 比特。\n\n提供的参数如下：\n- 参与医院数量：$K$\n- 全局模型有效载荷大小：$S_{m} = 200 \\times 10^{6}$ 字节\n- 密文扩展因子：$\\alpha = 2.2$\n- 成对密钥交换消息大小：$s_{k} = 64 \\times 10^{3}$ 字节\n- 医院链路带宽：$B_{h} = 200 \\times 10^{6}$ 比特/秒\n- 服务器链路带宽：$B_{s} = 10 \\times 10^{9}$ 比特/秒\n- 时间预算：$T_{\\text{budget}} = 180$ 秒\n\n首先，我们将所有数据大小转换为比特：\n- 模型大小（比特）：$S_{m}^{\\text{bits}} = S_{m} \\times 8 = (200 \\times 10^{6}) \\times 8 = 1.6 \\times 10^{9}$ 比特。\n- 掩码更新大小（比特）：$S_{u}^{\\text{bits}} = \\alpha S_{m} \\times 8 = 2.2 \\times (1.6 \\times 10^{9}) = 3.52 \\times 10^{9}$ 比特。\n- 密钥消息大小（比特）：$s_{k}^{\\text{bits}} = s_{k} \\times 8 = (64 \\times 10^{3}) \\times 8 = 5.12 \\times 10^{5}$ 比特。\n\n(i) 系统范围内的每轮通信复杂度（比特），$C_{\\text{total}}(K)$。\n总通信量是所有三个阶段传输的比特数之和：\n1.  广播阶段：服务器向 $K$ 家医院中的每一家发送大小为 $S_{m}^{\\text{bits}}$ 的模型。发送的总比特数为 $K \\times S_{m}^{\\text{bits}}$。\n2.  SA 握手阶段：$K$ 家医院中的每一家都与其他 $K-1$ 家医院执行成对密钥交换。单条消息的大小为 $s_{k}^{\\text{bits}}$。消息总数为 $K(K-1)$。发送的总比特数为 $K(K-1) \\times s_{k}^{\\text{bits}}$。\n3.  掩码上传阶段：$K$ 家医院中的每一家都向服务器发送大小为 $S_{u}^{\\text{bits}}$ 的掩码更新。发送的总比特数为 $K \\times S_{u}^{\\text{bits}}$。\n\n总通信复杂度是这些贡献的总和：\n$$C_{\\text{total}}(K) = K \\cdot S_{m}^{\\text{bits}} + K(K-1) \\cdot s_{k}^{\\text{bits}} + K \\cdot S_{u}^{\\text{bits}}$$\n$$C_{\\text{total}}(K) = K (S_{m}^{\\text{bits}} + (K-1)s_{k}^{\\text{bits}} + \\alpha S_{m}^{\\text{bits}})$$\n$$C_{\\text{total}}(K) = K [(1+\\alpha)S_{m}^{\\text{bits}} + (K-1)s_{k}^{\\text{bits}}]$$\n\n(ii) 逻辑通信阶段数。\n问题陈述描述了一个包含三个不同通信阶段的序列：\n1.  服务器向所有医院广播全局模型。\n2.  医院执行成对的安全聚合（SA）握手。\n3.  医院将其掩码更新上传到服务器进行聚合。\n因此，每轮有 $3$ 个逻辑通信阶段。\n\n(iii) 总轮次持续时间 $T_{\\text{round}}(K)$。\n总持续时间是三个阶段的持续时间之和，$T_{\\text{round}}(K) = T_{1}(K) + T_{2}(K) + T_{3}(K)$。每个阶段的持续时间由其通信瓶颈决定。\n\n-   **阶段 1：广播持续时间, $T_{1}(K)$**\n    服务器向 $K$ 家医院发送 $S_{m}^{\\text{bits}}$。服务器的上行链路必须处理总共 $K \\times S_{m}^{\\text{bits}}$ 的流量。这需要时间 $t_{\\text{server}} = \\frac{K \\cdot S_{m}^{\\text{bits}}}{B_{s}}$。每家医院的下行链路必须接收 $S_{m}^{\\text{bits}}$ 的流量，这需要时间 $t_{\\text{hospital}} = \\frac{S_{m}^{\\text{bits}}}{B_{h}}$。当所有传输完成时，该阶段结束，因此其持续时间是这些时间中的最大值。\n    $$T_{1}(K) = \\max\\left(\\frac{K \\cdot S_{m}^{\\text{bits}}}{B_{s}}, \\frac{S_{m}^{\\text{bits}}}{B_{h}}\\right)$$\n\n-   **阶段 2：SA 握手持续时间, $T_{2}(K)$**\n    此阶段仅涉及医院之间的对等通信。每家医院发送 $K-1$ 条大小为 $s_{k}^{\\text{bits}}$ 的消息。由于链路是全双工的，我们考虑出向流量的瓶颈。单个医院发送的总数据量为 $(K-1)s_{k}^{\\text{bits}}$。所需时间由医院的链路容量 $B_{h}$ 决定。由于所有医院都并行执行此操作，因此持续时间为：\n    $$T_{2}(K) = \\frac{(K-1) \\cdot s_{k}^{\\text{bits}}}{B_{h}}$$\n\n-   **阶段 3：掩码上传持续时间, $T_{3}(K)$**\n    $K$ 家医院各自向服务器上传 $S_{u}^{\\text{bits}}$。每家医院的上行链路需要时间 $t_{\\text{hospital}} = \\frac{S_{u}^{\\text{bits}}}{B_{h}}$。服务器的下行链路必须接收总共 $K \\cdot S_{u}^{\\text{bits}}$ 的流量，这需要时间 $t_{\\text{server}} = \\frac{K \\cdot S_{u}^{\\text{bits}}}{B_{s}}$。该阶段的持续时间是这些时间中的最大值。\n    $$T_{3}(K) = \\max\\left(\\frac{S_{u}^{\\text{bits}}}{B_{h}}, \\frac{K \\cdot S_{u}^{\\text{bits}}}{B_{s}}\\right) = \\max\\left(\\frac{\\alpha S_{m}^{\\text{bits}}}{B_{h}}, \\frac{K \\alpha S_{m}^{\\text{bits}}}{B_{s}}\\right)$$\n\n总轮次持续时间为：\n$$T_{\\text{round}}(K) = \\max\\left(\\frac{K S_{m}^{\\text{bits}}}{B_{s}}, \\frac{S_{m}^{\\text{bits}}}{B_{h}}\\right) + \\frac{(K-1) s_{k}^{\\text{bits}}}{B_{h}} + \\max\\left(\\frac{\\alpha S_{m}^{\\text{bits}}}{B_{h}}, \\frac{K \\alpha S_{m}^{\\text{bits}}}{B_{s}}\\right)$$\n\n(iv) 给定时间预算下的最大整数 $K$。\n我们需要找到使 $T_{\\text{round}}(K) \\leq T_{\\text{budget}}$ 成立的最大整数 $K$，其中 $T_{\\text{budget}} = 180$ 秒。我们将数值代入 $T_{\\text{round}}(K)$ 的表达式中。\n\n-   对于 $T_{1}(K)$：\n    -   $\\frac{K S_{m}^{\\text{bits}}}{B_{s}} = \\frac{K \\times (1.6 \\times 10^{9})}{10 \\times 10^{9}} = 0.16 K$ 秒。\n    -   $\\frac{S_{m}^{\\text{bits}}}{B_{h}} = \\frac{1.6 \\times 10^{9}}{200 \\times 10^{6}} = 8$ 秒。\n    -   $T_{1}(K) = \\max(0.16 K, 8)$。交叉点发生在 $0.16K = 8$ 时，即 $K = 50$。\n\n-   对于 $T_{2}(K)$：\n    -   $T_{2}(K) = \\frac{(K-1) \\times (5.12 \\times 10^{5})}{200 \\times 10^{6}} = \\frac{5.12 \\times 10^{5}}{2 \\times 10^{8}}(K-1) = 0.00256(K-1)$ 秒。\n\n-   对于 $T_{3}(K)$：\n    -   $\\frac{\\alpha S_{m}^{\\text{bits}}}{B_{h}} = \\frac{3.52 \\times 10^{9}}{200 \\times 10^{6}} = 17.6$ 秒。\n    -   $\\frac{K \\alpha S_{m}^{\\text{bits}}}{B_{s}} = \\frac{K \\times (3.52 \\times 10^{9})}{10 \\times 10^{9}} = 0.352 K$ 秒。\n    -   $T_{3}(K) = \\max(17.6, 0.352 K)$。交叉点发生在 $0.352K = 17.6$ 时，即 $K = 50$。\n\n总持续时间 $T_{\\text{round}}(K)$ 有两种情况，取决于 $K \\leq 50$ 还是 $K  50$。\n\n情况 1: $K \\leq 50$。\n$$T_{\\text{round}}(K) = 8 + 0.00256(K-1) + 17.6 = 25.6 + 0.00256K - 0.00256 = 25.59744 + 0.00256K$$\n对于 $K=50$，$T_{\\text{round}}(50) = 25.59744 + 0.00256 \\times 50 = 25.72544$ 秒。这个值远低于 $180$ 秒的预算，因此最大 $K$ 值必须大于 $50$。\n\n情况 2: $K  50$。\n在这种情况下，两个 $\\max$ 函数都由 $K$ 的线性项决定。\n$$T_{\\text{round}}(K) = 0.16K + 0.00256(K-1) + 0.352K$$\n$$T_{\\text{round}}(K) = 0.16K + 0.00256K - 0.00256 + 0.352K$$\n$$T_{\\text{round}}(K) = (0.16 + 0.00256 + 0.352)K - 0.00256$$\n$$T_{\\text{round}}(K) = 0.51456K - 0.00256$$\n\n现在，我们求解不等式 $T_{\\text{round}}(K) \\leq 180$：\n$$0.51456K - 0.00256 \\leq 180$$\n$$0.51456K \\leq 180.00256$$\n$$K \\leq \\frac{180.00256}{0.51456}$$\n$$K \\leq 349.82...$$\n\n由于 $K$ 必须是整数，因此 $K$ 的最大值为 $349$。该值与我们 $K  50$ 的假设一致。\n为了确认，我们可以检查 $K=349$ 时的时间：\n$T_{\\text{round}}(349) = 0.51456(349) - 0.00256 = 179.58144 - 0.00256 = 179.57888$ 秒，该值 $\\leq 180$ 秒。\n对于 $K=350$：\n$T_{\\text{round}}(350) = 0.51456(350) - 0.00256 = 180.096 - 0.00256 = 180.09344$ 秒，该值 $ 180$ 秒。\n\n因此，医院的最大整数数量是 $349$。",
            "answer": "$$\\boxed{349}$$"
        }
    ]
}