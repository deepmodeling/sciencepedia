{
    "hands_on_practices": [
        {
            "introduction": "在解读基于真实世界证据（RWE）的观察性研究结果时，一个核心挑战是评估未测量混杂因素的潜在影响。E-值（E-value）是一种重要的敏感性分析工具，它量化了一个未测量混杂因素需要多大的强度才能完全“解释掉”观测到的关联效应。通过本练习，您将亲手计算并解释这一关键指标，从而更严谨地评估研究结论的稳健性。",
            "id": "4375630",
            "problem": "一项精准肿瘤学领域的真实世界证据 (RWE) 比较效果研究，使用了携带表皮生长因子受体 (EGFR) 突变的晚期非小细胞肺癌 (NSCLC) 患者的关联电子健康记录和基因组诊断数据。接受基因组指导的靶向治疗的患者与接受非靶向标准治疗的患者进行比较。在使用基于高维倾向性评分的逆概率加权法对已测量的混杂因素进行调整后，基因组指导的靶向治疗组的估计$12$个月死亡风险为$0.29$，非靶向标准治疗组为$0.50$，得出风险尺度上的观测风险比为$0.29/0.50$。\n\n假设可能存在一个未测量的混杂因素，该因素与治疗分配和结局均相关，且每种关联均在风险比尺度上量化，并以已测量的协变量为条件进行定义。使用风险比和风险比尺度上混杂偏倚的基本定义，计算观测点估计值的E值。E值被理解为：在分层的最坏情况对齐下，一个未测量的混杂因素需要与治疗分配和结局（方向相同）同时具有的、以风险比尺度衡量的最小关联强度，才能将观测到的关联推至风险比尺度上的精确零效应。将最终数值答案四舍五入至四位有效数字。将E值表示为无量纲量。",
            "solution": "用户提供了一个问题，要求根据一项精准肿瘤学的真实世界证据研究中的观测风险比计算E值。\n\n### 步骤1：问题验证\n\n首先，我将提取给定信息并验证问题陈述。\n\n#### 提取的已知条件\n- 研究类型：真实世界证据 (RWE) 比较效果研究。\n- 患者人群：携带表皮生长因子受体 (EGFR) 突变的晚期非小细胞肺癌 (NSCLC) 患者。\n- 暴露/治疗组：基因组指导的靶向治疗。\n- 对照/比较组：非靶向标准治疗。\n- 结局：$12$个月死亡风险。\n- 靶向治疗组调整后的$12$个月死亡风险：$R_T = 0.29$。\n- 标准治疗组调整后的$12$个月死亡风险：$R_C = 0.50$。\n- 风险尺度上的观测风险比：$RR_{obs} = R_T / R_C$。\n- 任务：计算观测点估计值的E值。\n- E值的定义：“在分层的最坏情况对齐下，一个未测量的混杂因素需要与治疗分配和结局（方向相同）同时具有的、以风险比尺度衡量的最小关联强度，才能将观测到的关联推至风险比尺度上的精确零效应。”\n- 要求：将最终答案四舍五入至四位有效数字。\n\n#### 验证\n1.  **科学依据**：该问题具有科学依据。它使用了风险比、混杂和敏感性分析等标准流行病学概念。E值是流行病学中一个成熟的指标，用于评估观察性研究的结果对未测量混杂因素的稳健性。精准肿瘤学和RWE的背景是现代且现实的。\n2.  **适定性**：该问题是适定的。它提供了计算观测风险比所需的所有数据（两种风险）。所提供的E值定义是标准的，并直接对应一个特定的数学公式，确保存在唯一解。\n3.  **客观性**：该问题以客观、定量的术语陈述，没有歧义或主观论断。\n\n该问题不违反任何科学或数学逻辑原则，不是不完整的，也不是基于错误的前提。因此，它被认为是有效的。\n\n### 步骤2：求解\n\n该问题要求计算观测风险比的E值。E值量化了一个未测量的混杂因素需要与暴露（治疗）和结局同时关联的最小强度，才能完全解释观测到的关联，即将风险比估计值移至零效应值$1$。\n\n首先，我们根据给定的风险计算观测风险比 $RR_{obs}$。设 $R_T$ 为靶向治疗组的风险，$R_C$ 为标准治疗（对照）组的 risk。\n\n$$ RR_{obs} = \\frac{R_T}{R_C} = \\frac{0.29}{0.50} = 0.58 $$\n\n观测到的风险比为 $0.58$，这表明靶向治疗具有保护效应（降低了死亡风险）。\n\nE值的标准公式是为大于$1$的风险比定义的。对于观测风险比 $RR > 1$，公式为：\n$$ E = RR + \\sqrt{RR(RR - 1)} $$\n\n当观测风险比小于$1$时（如此处的 $RR_{obs} = 0.58$），我们首先将风险比取倒数，以在一个值大于$1$的尺度上表示关联强度。这相当于评估标准治疗组相对于靶向治疗组的风险。我们将这个倒数风险比记为 $RR'_{obs}$。\n\n$$ RR'_{obs} = \\frac{1}{RR_{obs}} = \\frac{1}{0.58} $$\n\n现在，我们将E值公式应用于这个倒数风险比 $RR'_{obs}$：\n$$ E = RR'_{obs} + \\sqrt{RR'_{obs}(RR'_{obs} - 1)} $$\n\n代入 $RR'_{obs}$ 的值：\n$$ E = \\frac{1}{0.58} + \\sqrt{\\frac{1}{0.58} \\left( \\frac{1}{0.58} - 1 \\right)} $$\n\n我们进行计算：\n$$ \\frac{1}{0.58} \\approx 1.72413793 $$\n$$ \\frac{1}{0.58} - 1 \\approx 0.72413793 $$\n\n将这些值代入E值公式：\n$$ E \\approx 1.72413793 + \\sqrt{1.72413793 \\times 0.72413793} $$\n$$ E \\approx 1.72413793 + \\sqrt{1.24891800} $$\n$$ E \\approx 1.72413793 + 1.11754999 $$\n$$ E \\approx 2.84168792 $$\n\n问题要求答案四舍五入到四位有效数字。\n$$ E \\approx 2.842 $$\n\n这个约等于$2.842$的E值意味着，要完全解释观测到的基因组指导疗法的保护效应，一个未测量的混杂因素需要在已调整的已测量混杂因素之外，与治疗分配和结局（死亡）的关联风险比至少都达到$2.842$。例如，这个未测量的混杂因素需要将死亡风险增加$2.842$倍，并且在某个治疗组中的普遍程度是另一个组的$2.842$倍。这为评估研究发现在面对潜在未测量混杂因素时的稳健性提供了一个定量度量。",
            "answer": "$$ \\boxed{2.842} $$"
        },
        {
            "introduction": "在精准医学中，临床决策（如基因变异的致病性分类）很少依赖单一信息来源。本练习将演示如何运用贝叶斯框架，系统性地整合来自实验室功能实验和多种真实世界证据（RWE）的证据，以得出更可靠的结论。您将实践计算新证据如何更新我们对基因变异致病性的先验信念，这是基因组诊断学中的一项核心技能。",
            "id": "4375695",
            "problem": "一个临床实验室使用一个整合了实验室测试和真实世界证据（RWE; Real-World Evidence）的多证据分类工作流程，来评估1型乳腺癌易感基因（BRCA1）中的一个变异。用于推断致病性的体外功能性分析返回阳性结果（功能性破坏），其灵敏度为$0.92$，特异度为$0.95$。独立的RWE部分贡献了乘性证据，量化为似然比（LRs）：家族共分离LR为$5.5$，与致病性相矛盾的人群患病率证据LR为$0.4$，计算元预测器LR为$1.8$，以及治疗反应登记信号LR为$3.2$。假设所有证据来源在给定真实致病状态下是条件独立的，并且每个证据都按指示的方向应用。\n\n三个临床队列在测试前表现出不同的检验前患病率（先验概率），即变异在测试前真正致病的事件概率：$p_{\\mathrm{A}} = 0.02$（普通人群筛查），$p_{\\mathrm{B}} = 0.20$（遗传学转诊），以及$p_{\\mathrm{C}} = 0.50$（高风险门诊）。仅使用诊断测试评估和贝叶斯更新中的基本定义，计算整个工作流程的综合阳性似然比，以及每个队列对应的真实致病性的检验后概率。\n\n最后，将三个检验后概率中的最小值作为您的最终报告值。将其表示为小数，并四舍五入到四位有效数字。\n\n在您的推理中，解释变异分类的临床决策阈值（例如，像American College of Medical Genetics and Genomics (ACMG)等专业框架所使用的“可能致病”与“致病”等类别）如何与本场景中的检验前患病率和计算出的检验后概率相关联。",
            "solution": "问题陈述经过严格验证，确认有效。它在科学上基于诊断测试评估和贝叶斯统计的原理，这些原理是精准医学中证据整合的核心。问题设定良好、客观，并包含推导出唯一、有意义解所需的所有信息，无矛盾或歧义。\n\n求解过程首先从所有证据来源计算综合似然比，然后应用贝叶斯更新来确定每个给定检验前概率下的致病性检验后概率。\n\n设$D$为变异是真正致病的事件，设$D^c$为变异是非致病的（良性的）事件。设$P(D)$表示变异致病的先验概率。设$E$代表所有观察到的证据的集合。\n\n首先，我们确定体外功能性分析阳性结果的似然比。在这种情况下，阳性结果是指示功能性破坏的结果，与致病性一致。阳性似然比$LR_{+}$定义为致病性变异中出现阳性测试结果的概率与非致病性变异中出现阳性测试结果的概率之比。这等同于灵敏度（$S_n$）与假阳性率（$1 - S_p$）之比，其中$S_p$是特异度。\n\n给定的灵敏度为$S_n = 0.92$，特异度为$S_p = 0.95$。\n阳性功能性分析的似然比$LR_{\\text{assay}}$是：\n$$\nLR_{\\text{assay}} = \\frac{S_n}{1 - S_p} = \\frac{0.92}{1 - 0.95} = \\frac{0.92}{0.05} = 18.4\n$$\n\n接下来，我们计算整个工作流程的综合似然比$LR_{\\text{composite}}$。问题陈述中指出，所有证据来源在给定真实致病状态下是条件独立的。因此，综合似然比是各个似然比的乘积。\n各个似然比是：\n- $LR_{\\text{assay}} = 18.4$\n- $LR_{\\text{seg}} = 5.5$（家族共分离）\n- $LR_{\\text{pop}} = 0.4$（人群患病率）\n- $LR_{\\text{comp}} = 1.8$（计算元预测器）\n- $LR_{\\text{ther}} = 3.2$（治疗反应登记）\n\n综合似然比是：\n$$\nLR_{\\text{composite}} = LR_{\\text{assay}} \\times LR_{\\text{seg}} \\times LR_{\\text{pop}} \\times LR_{\\text{comp}} \\times LR_{\\text{ther}}\n$$\n$$\nLR_{\\text{composite}} = 18.4 \\times 5.5 \\times 0.4 \\times 1.8 \\times 3.2 = 233.1648\n$$\n\n为了求出致病性的检验后概率$P(D|E)$，我们使用贝叶斯定理的优势比形式。致病性的先验优势比由$O_{\\text{prior}} = \\frac{P(D)}{1 - P(D)}$给出。后验优势比通过将先验优势比乘以综合似然比来计算：$O_{\\text{posterior}} = O_{\\text{prior}} \\times LR_{\\text{composite}}$。最后，后验概率通过公式$P(D|E) = \\frac{O_{\\text{posterior}}}{1 + O_{\\text{posterior}}}$从后验优势比中恢复。\n\n我们现在为三个临床队列中的每一个进行计算。\n\n**队列A（普通人群筛查）：**\n检验前患病率为$p_{\\mathrm{A}} = P(D)_{\\mathrm{A}} = 0.02$。\n先验优势比为：\n$$\nO_{\\text{prior, A}} = \\frac{0.02}{1 - 0.02} = \\frac{0.02}{0.98} = \\frac{1}{49}\n$$\n后验优势比为：\n$$\nO_{\\text{posterior, A}} = O_{\\text{prior, A}} \\times LR_{\\text{composite}} = \\frac{1}{49} \\times 233.1648 \\approx 4.758465\n$$\n检验后概率为：\n$$\nP(D|E)_{\\mathrm{A}} = \\frac{O_{\\text{posterior, A}}}{1 + O_{\\text{posterior, A}}} = \\frac{4.758465}{1 + 4.758465} \\approx 0.826343\n$$\n\n**队列B（遗传学转诊）：**\n检验前患病率为$p_{\\mathrm{B}} = P(D)_{\\mathrm{B}} = 0.20$。\n先验优势比为：\n$$\nO_{\\text{prior, B}} = \\frac{0.20}{1 - 0.20} = \\frac{0.20}{0.80} = \\frac{1}{4}\n$$\n后验优势比为：\n$$\nO_{\\text{posterior, B}} = O_{\\text{prior, B}} \\times LR_{\\text{composite}} = \\frac{1}{4} \\times 233.1648 = 58.2912\n$$\n检验后概率为：\n$$\nP(D|E)_{\\mathrm{B}} = \\frac{O_{\\text{posterior, B}}}{1 + O_{\\text{posterior, B}}} = \\frac{58.2912}{1 + 58.2912} \\approx 0.983134\n$$\n\n**队列C（高风险门诊）：**\n检验前患病率为$p_{\\mathrm{C}} = P(D)_{\\mathrm{C}} = 0.50$。\n先验优势比为：\n$$\nO_{\\text{prior, C}} = \\frac{0.50}{1 - 0.50} = \\frac{0.50}{0.50} = 1\n$$\n后验优势比为：\n$$\nO_{\\text{posterior, C}} = O_{\\text{prior, C}} \\times LR_{\\text{composite}} = 1 \\times 233.1648 = 233.1648\n$$\n检验后概率为：\n$$\nP(D|E)_{\\mathrm{C}} = \\frac{O_{\\text{posterior, C}}}{1 + O_{\\text{posterior, C}}} = \\frac{233.1648}{1 + 233.1648} \\approx 0.995730\n$$\n\n三个检验后概率分别约为$0.8263$、$0.9831$和$0.9957$。其中最小的是队列A的值，为$0.826343$。四舍五入到四位有效数字得到$0.8263$。\n\n关于这些概率与临床决策阈值之间的关系：\n专业指南，例如来自American College of Medical Genetics and Genomics (ACMG)的指南，为变异分类建立了诸如“致病”、“可能致病”和“意义不明确的变异”（VUS）等类别。这些类别对应于检验后概率的范围。例如，一个常见的框架将“致病”映射到$P(D|E) > 0.99$，“可能致病”映射到$0.90  P(D|E) \\leq 0.99$，而“VUS”则映射到“可能致病”和“可能良性”之间的范围。\n\n这个问题说明了一个关键原则：同样一组新证据（由$LR_{\\text{composite}} = 233.1648$概括）可能会根据检验前概率的不同而导致不同的临床分类，而检验前概率是由患者的临床背景决定的。\n- 对于队列A（低先验概率，$p_A = 0.02$），检验后概率为$P(D|E)_{\\mathrm{A}} \\approx 0.8263$。这个值不满足“可能致病”的典型阈值（例如，$0.90$）。该变异可能被归类为VUS，尽管有强烈的致病性证据，需要进一步调查，但可能不会立即采取临床行动。\n- 对于队列B（中等先验概率，$p_B = 0.20$），检验后概率为$P(D|E)_{\\mathrm{B}} \\approx 0.9831$。这完全落在“可能致病”的范围内（$0.90  P \\leq 0.99$）。这种分类通常会引发临床管理决策。\n- 对于队列C（高先验概率，$p_C = 0.50$），检验后概率为$P(D|E)_{\\mathrm{C}} \\approx 0.9957$。这超过了“致病”的严格阈值（$>0.99$），表明置信度非常高，并为明确的临床行动提供了坚实的基础。\n\n因此，检验前患病率不仅是公式的一个输入，而且是循证医学的一个关键组成部分，表明测试结果不能在真空中解释。告知先验概率的患者个人和家族史对于遗传变异的最终评估是不可或缺的。\n\n三个检验后概率中最小的是$P(D|E)_{\\mathrm{A}} \\approx 0.826343$。",
            "answer": "$$\\boxed{0.8263}$$"
        },
        {
            "introduction": "真实世界中的患者诊疗过程是动态的，治疗决策和患者健康状况随时间变化，这会导致出现“时变混杂”问题，常规的统计调整方法难以处理。本练习将介绍边际结构模型（Marginal Structural Models, MSMs）与稳定化逆概率治疗加权（stabilized Inverse Probability of Treatment Weighting, IPTW）这一强大组合，它能有效估计动态治疗方案的因果效应。您将为一个具体案例计算其稳定化权重，并学习如何设定该方法所服务的最终因果模型。",
            "id": "4375632",
            "problem": "一项真实世界证据队列研究追踪了在 $T=2$ 个决策时间点（$t \\in \\{0,1\\}$）开始接受基因型指导剂量方案的窄治疗指数药物治疗的成年人，并在 $t=2$ 时进行结局评估。在每个时间点 $t$，临床医生根据观测历史选择高剂量递增（$A_t=1$）或不递增（$A_t=0$）。基线信息包括一个药物基因组学变异 $G \\in \\{0,1\\}$，该变异指示慢代谢者状态（$G=1$）。一个时变实验室协变量 $L_t \\in \\{0,1\\}$ 指示肝毒性标志（当丙氨酸氨基转移酶升高时 $L_t=1$）。二元结局 $Y$（例如，在 $t=2$ 时达到治疗目标）可能受到整个治疗历史 $\\bar{A}=(A_0,A_1)$ 的影响。\n\n假设满足标准的纵向因果推断条件：在给定已测量历史的条件下，满足一致性、正值性和序贯可交换性（即无未测量混杂）。您将使用时变倾向性得分构建稳定的治疗逆概率权重，然后指定一个边际结构模型（MSM）来分析高剂量方案对 $Y$ 的因果效应。\n\n治疗分配模型由观测数据估计如下。对于分母（在每个时间点给定完整已测量历史的治疗机制）：\n- 对于 $t=0$：$\\logit\\big(\\Pr(A_0=1 \\mid L_0,G)\\big) = -0.2 - 1.1\\,L_0 - 0.8\\,G$。\n- 对于 $t=1$：$\\logit\\big(\\Pr(A_1=1 \\mid A_0,L_1,G)\\big) = -0.4 + 1.0\\,A_0 - 0.9\\,L_1 - 0.6\\,G - 0.5\\,A_0 G$。\n\n对于分子（仅通过基线基因型和既往治疗进行稳定化）：\n- 对于 $t=0$：$\\logit\\big(\\Pr(A_0=1 \\mid G)\\big) = -0.1 - 0.7\\,G$。\n- 对于 $t=1$：$\\logit\\big(\\Pr(A_1=1 \\mid A_0,G)\\big) = -0.3 + 0.9\\,A_0 - 0.5\\,G$。\n\n此处，$\\logit(p) = \\ln\\!\\big(p/(1-p)\\big)$，logistic 函数为 $\\mathrm{logistic}(x)=1/\\big(1+\\exp(-x)\\big)$。\n\n考虑一个具有以下观测轨迹的个体：$G=1$, $L_0=1$, $A_0=1$, $L_1=0$, $A_1=0$。利用序贯可交换性原理和联合治疗历史分布的因子分解，推导出两个决策时间点的稳定治疗逆概率权重，表示为在 $t \\in \\{0,1\\}$ 上，观测到的治疗值的适当条件概率的乘积。然后，使用上述拟合模型，利用 $\\mathrm{logistic}(x)=1/\\big(1+\\exp(-x)\\big)$ 计算概率，为该给定个体数值计算此稳定权重。最后，编写一个边际结构模型（MSM），该模型使用 logistic 连接函数，包含 $A_0$ 和 $A_1$ 的主效应，以描述 $\\bar{A}=(A_0,A_1)$ 对二元结局 $Y$ 的因果效应。\n\n只需报告最终的稳定权重值，以小数形式表示，并四舍五入到四位有效数字。无需单位。",
            "solution": "该问题要求计算特定个体观测轨迹的稳定治疗逆概率权重（$SW$），并指定一个边际结构模型（MSM）。\n\n首先，我们为具有观测治疗历史 $\\bar{A}=(A_0, A_1)$ 的个体建立稳定权重的一般公式。该研究有两个决策点，$t=0$ 和 $t=1$。稳定权重 $SW(\\bar{A})$ 是分子与分母的比值，其中分子是在给定基线协变量和既往治疗的情况下接受观测治疗的条件概率的乘积，分母是在每个时间点给定完整已测量历史的情况下接受观测治疗的条件概率的乘积。在时间点 $t$ 的完整已测量历史包括既往治疗 $\\bar{A}_{t-1}$、时变协变量 $\\bar{L}_t$ 和基线协变量 $G$。分子中的稳定化因子基于基线药物基因组学变异 $G$ 和既往治疗。\n\n稳定权重的一般公式为：\n$$\nSW(\\bar{A}) = \\prod_{t=0}^{1} \\frac{\\Pr(A_t \\mid \\bar{A}_{t-1}, G)}{\\Pr(A_t \\mid \\bar{A}_{t-1}, \\bar{L}_t, G)}\n$$\n对于两个时间点 $t=0$ 和 $t=1$，该公式展开为：\n$$\nSW(A_0, A_1) = \\frac{\\Pr(A_0 \\mid G)}{\\Pr(A_0 \\mid L_0, G)} \\times \\frac{\\Pr(A_1 \\mid A_0, G)}{\\Pr(A_1 \\mid A_0, L_1, G)}\n$$\n我们得到了特定个体的轨迹：\n- 基线药物基因组学变异: $G=1$\n- 基线实验室协变量: $L_0=1$\n- $t=0$ 时的治疗: $A_0=1$\n- $t=1$ 时的时变实验室协变量: $L_1=0$\n- $t=1$ 时的治疗: $A_1=0$\n\n我们将这些观测值代入权重公式：\n$$\nSW = \\frac{\\Pr(A_0=1 \\mid G=1)}{\\Pr(A_0=1 \\mid L_0=1, G=1)} \\times \\frac{\\Pr(A_1=0 \\mid A_0=1, G=1)}{\\Pr(A_1=0 \\mid A_0=1, L_1=0, G=1)}\n$$\n我们使用提供的 logistic 回归模型和 logistic 函数 $\\mathrm{logistic}(x) = 1/(1+\\exp(-x))$ 计算这四个概率中的每一个。\n\n1.  **$t=0$ 时的分子：$\\Pr(A_0=1 \\mid G=1)$**\n    模型为 $\\logit\\big(\\Pr(A_0=1 \\mid G)\\big) = -0.1 - 0.7\\,G$。\n    对于 $G=1$，线性预测器为 $\\eta_{num,0} = -0.1 - 0.7(1) = -0.8$。\n    该概率为 $\\Pr(A_0=1 \\mid G=1) = \\mathrm{logistic}(-0.8) = \\frac{1}{1+\\exp(0.8)}$。\n\n2.  **$t=0$ 时的分母：$\\Pr(A_0=1 \\mid L_0=1, G=1)$**\n    模型为 $\\logit\\big(\\Pr(A_0=1 \\mid L_0,G)\\big) = -0.2 - 1.1\\,L_0 - 0.8\\,G$。\n    对于 $L_0=1$ 和 $G=1$，线性预测器为 $\\eta_{den,0} = -0.2 - 1.1(1) - 0.8(1) = -2.1$。\n    该概率为 $\\Pr(A_0=1 \\mid L_0=1, G=1) = \\mathrm{logistic}(-2.1) = \\frac{1}{1+\\exp(2.1)}$。\n\n3.  **$t=1$ 时的分子：$\\Pr(A_1=0 \\mid A_0=1, G=1)$**\n    该模型是关于 $\\Pr(A_1=1 \\mid \\dots)$ 的。我们首先计算这个概率，然后求得 $\\Pr(A_1=0) = 1 - \\Pr(A_1=1)$。\n    模型为 $\\logit\\big(\\Pr(A_1=1 \\mid A_0,G)\\big) = -0.3 + 0.9\\,A_0 - 0.5\\,G$。\n    对于 $A_0=1$ 和 $G=1$，线性预测器为 $\\eta_{num,1} = -0.3 + 0.9(1) - 0.5(1) = 0.1$。\n    所以，$\\Pr(A_1=1 \\mid A_0=1, G=1) = \\mathrm{logistic}(0.1) = \\frac{1}{1+\\exp(-0.1)}$。\n    所求概率为 $\\Pr(A_1=0 \\mid A_0=1, G=1) = 1 - \\mathrm{logistic}(0.1) = 1 - \\frac{1}{1+\\exp(-0.1)} = \\frac{\\exp(-0.1)}{1+\\exp(-0.1)} = \\frac{1}{1+\\exp(0.1)} = \\mathrm{logistic}(-0.1)$。\n\n4.  **$t=1$ 时的分母：$\\Pr(A_1=0 \\mid A_0=1, L_1=0, G=1)$**\n    模型为 $\\logit\\big(\\Pr(A_1=1 \\mid A_0,L_1,G)\\big) = -0.4 + 1.0\\,A_0 - 0.9\\,L_1 - 0.6\\,G - 0.5\\,A_0 G$。\n    对于 $A_0=1$，$L_1=0$ 和 $G=1$，线性预测器为 $\\eta_{den,1} = -0.4 + 1.0(1) - 0.9(0) - 0.6(1) - 0.5(1)(1) = -0.4 + 1.0 - 0 - 0.6 - 0.5 = -0.5$。\n    所以，$\\Pr(A_1=1 \\mid A_0=1, L_1=0, G=1) = \\mathrm{logistic}(-0.5) = \\frac{1}{1+\\exp(0.5)}$。\n    所求概率为 $\\Pr(A_1=0 \\mid A_0=1, L_1=0, G=1) = 1 - \\mathrm{logistic}(-0.5) = 1 - \\frac{1}{1+\\exp(0.5)} = \\frac{\\exp(0.5)}{1+\\exp(0.5)} = \\frac{1}{1+\\exp(-0.5)} = \\mathrm{logistic}(0.5)$。\n\n现在我们组合稳定权重 $SW$：\n$$\nSW = \\frac{\\mathrm{logistic}(-0.8)}{\\mathrm{logistic}(-2.1)} \\times \\frac{\\mathrm{logistic}(-0.1)}{\\mathrm{logistic}(0.5)}\n$$\n代入 logistic 函数的表达式：\n$$\nSW = \\frac{\\frac{1}{1+\\exp(0.8)}}{\\frac{1}{1+\\exp(2.1)}} \\times \\frac{\\frac{1}{1+\\exp(0.1)}}{\\frac{1}{1+\\exp(-0.5)}} = \\frac{1+\\exp(2.1)}{1+\\exp(0.8)} \\times \\frac{1+\\exp(-0.5)}{1+\\exp(0.1)}\n$$\n现在，我们对此表达式进行数值计算：\n$\\exp(0.8) \\approx 2.225541$\n$\\exp(2.1) \\approx 8.166170$\n$\\exp(0.1) \\approx 1.105171$\n$\\exp(-0.5) \\approx 0.606531$\n$$\nSW \\approx \\frac{1+8.166170}{1+2.225541} \\times \\frac{1+0.606531}{1+1.105171} = \\frac{9.166170}{3.225541} \\times \\frac{1.606531}{2.105171} \\approx 2.84169 \\times 0.763135 \\approx 2.168709\n$$\n四舍五入到四位有效数字，稳定权重为 $2.169$。\n\n最后，我们指定所要求的边际结构模型（MSM）。MSM 描述了治疗历史 $\\bar{A}=(A_0, A_1)$ 对期望潜在结局 $Y^{\\bar{a}}$ 的因果效应。对于二元结局 $Y$ 和 logistic 连接函数，模型是针对结局概率的对数几率来设定的。包含 $A_0$ 和 $A_1$ 主效应的模型是：\n$$\n\\logit(\\Pr(Y^{\\bar{a}}=1)) = \\psi_0 + \\psi_1 a_0 + \\psi_2 a_1\n$$\n其中 $\\bar{a}=(a_0, a_1)$ 代表一个特定的治疗方案，$\\psi_0, \\psi_1, \\psi_2$ 是待估计的因果参数，通常通过对观测结局 $Y$ 和观测治疗 $A_0$、$A_1$ 进行加权 logistic 回归拟合来估计，其中权重为稳定权重。",
            "answer": "$$\n\\boxed{2.169}\n$$"
        }
    ]
}