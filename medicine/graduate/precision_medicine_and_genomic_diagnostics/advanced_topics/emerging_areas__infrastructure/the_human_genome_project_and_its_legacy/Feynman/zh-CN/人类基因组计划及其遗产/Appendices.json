{
    "hands_on_practices": [
        {
            "introduction": "第一个练习让我们立足于新一代测序数据的实际情况。我们将学习计算有效测序深度，这是评估数据质量和下游分析成功可能性的关键初步指标。这项计算要求我们考虑在标准质量控制和去除PCR重复序列过程中的数据损失，这是任何基因组学家的基本技能 。",
            "id": "4391383",
            "problem": "精准医学中，人类基因组计划 (Human Genome Project, HGP) 的一个核心操作意义是，短读长数据集可以与一个高质量的人类组装进行比对，以量化有效测序深度，而有效测序深度决定了变异发现的灵敏度。考虑一次在 HGP 成果上建立的人类参考基因组上进行的全基因组临床测序，其中单倍体有效基因组大小为 $G = 3.10 \\times 10^{9}$ 个碱基对。该仪器产生了 $N = 1.2 \\times 10^{9}$ 个双末端读段对，每个读段的长度为 $L = 150$ 个碱基对（因此每个读段对贡献 $2L$ 个碱基）。在质量控制过程中，有比例为 $0.15$ 的读段对因质量低或接头污染而被丢弃。在剩余的读段对中，又有比例为 $0.20$ 的因属于聚合酶链式反应 (PCR) 重复而在读段对水平上被移除。假设所有保留的读段对都唯一地比对到参考基因组上并贡献其全部长度，且忽略配对读段之间的任何重叠或软剪切。\n\n仅使用第一性原理以及测序和覆盖度的核心定义，计算这些数据所隐含的单倍体基因组的有效平均测序深度（倍数覆盖度）。将您的最终答案表示为一个纯数（倍数覆盖度，无量纲），并四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n-   单倍体有效基因组大小：$G = 3.10 \\times 10^{9}$ 个碱基对\n-   初始双末端读段对总数：$N = 1.2 \\times 10^{9}$\n-   每个读段的长度：$L = 150$ 个碱基对\n-   每个读段对贡献的碱基数：$2L$\n-   因质量低而丢弃的读段对比例：$f_{qc} = 0.15$\n-   从*剩余*读段对中因PCR重复而移除的比例：$f_{dup} = 0.20$\n-   假设：所有保留的读段对都唯一比对并贡献其全部长度。\n-   目标：计算有效平均测序深度（倍数覆盖度），并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行评估。\n-   **科学依据**：该问题在根本上是合理的。它描述了基因组学和生物信息学中一个标准且关键的计算，特别是在下一代测序 (NGS) 数据的质量评估方面。测序深度、读段长度、双末端读段、质量过滤和PCR重复移除等概念都是该领域的核心。所提供的人类基因组大小、读段计数和读段长度等数值对于一个现代全基因组测序实验是切合实际的。\n-   **适定性**：该问题是适定的。它提供了所有必需的数值数据，并为数据过滤定义了一个清晰、有序的过程。目标是明确且无歧义的，从而可以得出一个唯一、可计算的解。\n-   **客观性**：该问题以精确、客观和技术性的语言陈述。它没有主观性、歧义或观点。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它是一个在定量基因组学领域中科学上连贯、适定且客观的练习。可以开始求解过程。\n\n有效平均测序深度，或称倍数覆盖度，用 $C$ 表示，其定义是比对到参考基因组上的测序碱基总数除以该参考基因组的大小。覆盖度的单位是 'X' 或 '倍'，是无量纲的。\n\n$$C = \\frac{\\text{Total number of effective mapped bases}}{\\text{Effective genome size}}$$\n\n给定条件如下：\n-   初始读段对数量，$N = 1.2 \\times 10^{9}$。\n-   单个读段的长度，$L = 150$ 个碱基对。因此每个读段对贡献的总长度为 $2L$。\n-   单倍体基因组大小，$G = 3.10 \\times 10^{9}$ 个碱基对。\n-   因质量控制而损失的读段对比例，$f_{qc} = 0.15$。\n-   从剩余读段对中因PCR重复移除而损失的比例，$f_{dup} = 0.20$。\n\n我们必须首先计算成功保留并比对到基因组上的读段对数量。\n\n1.  从初始读段对数量 $N = 1.2 \\times 10^{9}$ 开始。\n\n2.  这些读段对中有比例为 $f_{qc} = 0.15$ 的被丢弃。剩余的比例是 $(1 - f_{qc})$。质量控制后的读段对数量 $N_{qc}$ 为：\n    $$N_{qc} = N \\times (1 - f_{qc})$$\n\n3.  在这些剩余的 $N_{qc}$ 对中，又有比例为 $f_{dup} = 0.20$ 的因是PCR重复而被移除。保留的比例是 $(1 - f_{dup})$。最终保留的读段对数量 $N_{retained}$ 为：\n    $$N_{retained} = N_{qc} \\times (1 - f_{dup}) = N \\times (1 - f_{qc}) \\times (1 - f_{dup})$$\n\n4.  问题陈述指出，每个保留的读段对都将其全部长度 $2L$ 个碱基贡献给有效比对数据。因此，有效比对碱基的总数为：\n    $$\\text{Total Mapped Bases} = N_{retained} \\times 2L = N \\times (1 - f_{qc}) \\times (1 - f_{dup}) \\times 2L$$\n\n5.  现在，我们可以通过将总比对碱基数除以基因组大小 $G$ 来计算平均测序深度 $C$：\n    $$C = \\frac{N \\times (1 - f_{qc}) \\times (1 - f_{dup}) \\times 2L}{G}$$\n\n将给定值代入此表达式：\n-   $N = 1.2 \\times 10^{9}$\n-   $G = 3.10 \\times 10^{9}$\n-   $L = 150$\n-   $f_{qc} = 0.15$\n-   $f_{dup} = 0.20$\n\n计算过程如下：\n$$C = \\frac{(1.2 \\times 10^{9}) \\times (1 - 0.15) \\times (1 - 0.20) \\times (2 \\times 150)}{3.10 \\times 10^{9}}$$\n\n首先，计算分子中的各项：\n-   保留因子为 $(1 - 0.15) = 0.85$ 和 $(1 - 0.20) = 0.80$。\n-   每个读段对的长度为 $2L = 2 \\times 150 = 300$ 个碱基。\n\n将这些值代入 $C$ 的方程：\n$$C = \\frac{(1.2 \\times 10^{9}) \\times 0.85 \\times 0.80 \\times 300}{3.10 \\times 10^{9}}$$\n\n分子和分母中的因子 $10^{9}$相互抵消：\n$$C = \\frac{1.2 \\times 0.85 \\times 0.80 \\times 300}{3.10}$$\n\n现在，计算分子的乘积：\n-   $1.2 \\times 0.85 = 1.02$\n-   $1.02 \\times 0.80 = 0.816$\n-   $0.816 \\times 300 = 244.8$\n\n因此，$C$ 的表达式简化为：\n$$C = \\frac{244.8}{3.10}$$\n\n进行最后的除法运算：\n$$C \\approx 78.9677419...$$\n\n问题要求最终答案四舍五入到四位有效数字。前四位有效数字是 $7$、$8$、$9$ 和 $6$。第五位数字是 $7$，大于等于 $5$，所以我们将第四位数字向上取整。\n$$C \\approx 78.97$$\n\n有效平均测序深度为 $78.97$X。",
            "answer": "$$\\boxed{78.97}$$"
        },
        {
            "introduction": "在原始测序数据的基础上，本练习将探讨我们如何衡量基因组组装的质量，这直接承袭了人类基因组计划期间开发的方法。你将计算重叠群N50（contig N50），一个衡量组装连续性的关键指标，并在概念上将其与支架N50（scaffold N50）区分开来。这个练习强调了如何利用长程信息将零散的重叠群转化为染色体级别的组装体 。",
            "id": "4391378",
            "problem": "人类基因组计划（HGP）的一项核心遗产是定量组装指标的标准化，这些指标使得在精准医疗和基因组诊断学中使用的基因组构建版本能够进行可重复的比较。考虑一个基因组组装草图，其重叠群（contig，每个contig是一个没有间隙的连续脱氧核糖核酸（DNA）序列）的长度分别为 $1.2$ Mb、$0.9$ Mb、$0.7$ Mb、$0.4$ Mb 和 $0.3$ Mb。使用基因组组装评估中采纳的 contig N50 的标准定义，计算该数据集的 contig N50。然后，解释为什么使用全基因组范围的长程图谱（如光学图谱或高通量染色体构象捕获 (Hi-C)）将这些 contig 排序和定向组装成支架（scaffold）可以增加 scaffold N50，但不会改变 contig 的连续性。\n\n以兆碱基（Mb）为单位表示 contig N50 的最终数值答案，并将答案四舍五入到三位有效数字。从第一性原理出发，依据关于基因组组装指标和长程支架构建技术的核心定义和广泛接受的事实，提供你的推理过程。",
            "solution": "该问题是有效的，因为它在基因组学领域有科学依据，数据充分、提法得当，并且其表述是客观的。它要求计算一个标准的基因组组装指标，并基于已确立的基因组支架构建原理解释原因。\n\n问题要求计算给定一组 contig 长度的 contig N50，并解释支架构建如何影响组装指标。我们将依次处理这两个部分。\n\n首先，我们计算 contig N50。N50 指标是广泛用于衡量基因组组装连续性的一个度量。它被定义为这样一个最小的 contig 长度，即所有长度等于或大于该长度的 contig 的长度总和至少占总组装大小的 $50\\%$。\n\n给定的 contig 长度为 $L_1 = 1.2$ Mb, $L_2 = 0.9$ Mb, $L_3 = 0.7$ Mb, $L_4 = 0.4$ Mb, and $L_5 = 0.3$ Mb。\n\n步骤1：计算总组装大小，记为 $G$。\n总组装大小是所有 contig 长度的总和：\n$$G = \\sum_{i=1}^{5} L_i = 1.2 + 0.9 + 0.7 + 0.4 + 0.3 = 3.5 \\text{ Mb}$$\n\n步骤2：确定总组装大小的 $50\\%$ 阈值。\n这个阈值，我们可以称之为 $G_{50}$，是：\n$$G_{50} = 0.50 \\times G = 0.5 \\times 3.5 \\text{ Mb} = 1.75 \\text{ Mb}$$\n\n步骤3：将 contig 按长度降序排列。\n给定的列表已经是降序排列的：\n$1.2$ Mb、$0.9$ Mb、$0.7$ Mb、$0.4$ Mb、$0.3$ Mb。\n\n步骤4：从最长的 contig 开始，计算 contig 长度的累积和，直到总和大于或等于 $G_{50}$。\n- 最长的 contig 长度为 $1.2$ Mb。累积和为 $1.2$ Mb。这小于 $1.75$ Mb。\n- 我们加上次长 contig 的长度 $0.9$ Mb。新的累积和为 $1.2 \\text{ Mb} + 0.9 \\text{ Mb} = 2.1$ Mb。\n\n这个 $2.1$ Mb 的累积和大于 $1.75$ Mb 的目标阈值。N50 值是使总和超过阈值时最后加入的那个 contig 的长度。在这种情况下，那个 contig 的长度是 $0.9$ Mb。问题要求答案表示为三位有效数字，因此 $0.9$ Mb 表示为 $0.900$ Mb。\n\n因此，该组装的 contig N50 是 $0.900$ Mb。\n\n其次，我们解释为什么支架构建会增加 scaffold N50，但不会改变 contig 的连续性。\n**Contig**（源自“contiguous”，连续的）是由读长组装而成的连续 DNA 序列片段，其中没有未知序列的间隙。Contig 的长度是精确已知的。\n**Scaffold**（支架）是通过沿染色体对多个 contig 进行排序和定向而创建的更高阶结构。一个 scaffold 内 contig 之间的间隙代表未知序列的区域，但其大小是估计的。这些间隙通常在序列文件中用特定数量的 'N' 字符表示。\n\n**支架构建**（scaffolding）过程利用光学图谱或 Hi-C 等技术提供的长程信息，来确定在基因组中物理上邻近的 contig 的相对位置和方向。例如，如果 Hi-C 数据表明 contig A 和 contig B 相邻，它们可以被连接成一个单一的 scaffold（例如，A-NNN...NNN-B）。\n\n这个过程不会改变底层的 contig。Contig A 和 contig B 的序列保持不变；它们只是被放置在一个更大的上下文中。因此，所有 contig 的集合及其各自的长度与支架构建前的集合保持一致。由于 **contig N50** 仅基于这组 contig 长度计算，因此它在支架构建过程中保持不变。“Contig 连续性”没有改变，因为没有新的序列被添加到 contig 本身，它们也没有被断开或合并。\n\n然而，支架构建会生成一组新的序列用于分析：即 scaffolds。其中一些 scaffold 可能由多个 contig 连接而成，使其比任何单个源 contig 都长得多。剩余的未被支架化的 contig 则被视为长度等于其 contig 长度的 scaffold。\n\n要计算 **scaffold N50**，需要使用这些新 scaffold 的长度。例如，如果我们将数据集中 $1.2$ Mb 和 $0.7$ Mb 的 contig 连接起来，就会创建一个长度至少为 $1.2 + 0.7 = 1.9$ Mb（加上估计的间隙大小）的新 scaffold。用于 N50 计算的新序列长度集合将是（例如）{$1.9$ Mb, $0.9$ Mb, $0.4$ Mb, $0.3$ Mb}。总组装大小 $G$ 保持不变（$3.5$ Mb），$50\\%$ 阈值 $G_{50}$ 也保持不变（$1.75$ Mb）。现在最长的序列是 $1.9$ Mb，它已经大于 $1.75$ Mb。因此，scaffold N50 将是这个新的长 scaffold 的长度（在这个假设情况下是 $1.9$ Mb），这比原来 $0.900$ Mb 的 contig N50 要大得多。\n\n总之，支架构建通过将 contig 连接成更长的 scaffold 来增加 N50 值，从而提高了组装的长程连续性（由 scaffold N50 衡量），而不会改变基本的 contig 集合或其内部序列（因此也不会改变 contig N50）。",
            "answer": "$$\n\\boxed{0.900}\n$$"
        },
        {
            "introduction": "拥有高质量的数据集后，下一步通常是为临床或研究目的鉴定遗传变异。本练习将让你扮演临床科学家的角色，评估一个新的变异检出工具。通过将该工具的输出与“金标准”基准数据集进行比较，你将计算如灵敏度、特异性和 $F_1$ 分数等基本性能指标，这些指标对于确定诊断测试的可靠性至关重要 。",
            "id": "4391334",
            "problem": "人类基因组计划 (Human Genome Project, HGP) 的一项核心遗产是建立了标准化的参考资源和高可信度的基准数据集（例如，瓶中基因组 (Genome in a Bottle, GIAB)），这些资源和数据集能够对用于精准医疗和基因组诊断的变异检出性能进行严格评估。考虑在一个已定义的可检出区域内，对照一个类似GIAB的真实参考资源，对一个单核苷酸多态性 (SNP) 检出工具进行评估。该真实参考资源在同一可检出区域内指定了 $50{,}000$ 个经整理的SNP阳性位点和 $5{,}000{,}000$ 个经整理的SNP阴性位点。该检出工具单次运行后，对照此真实参考资源产生的判定结果如下：真阳性 (TP) $=49{,}000$，假阳性 (FP) $=1{,}000$，以及假阴性 (FN) $=1,000$。假设在经整理的SNP阴性集合中，所有未被该检出工具识别为SNP的位点均为真阴性 (TN)，并且基准测试区域内没有未解决或不可检出的位点。\n\n请仅从应用于变异检出的二元分类混淆矩阵的诊断测试性能基本定义出发，推导并计算该检出工具在此数据集上的灵敏度、特异度和 $F_{1}$ 分数。将这三个量表示为区间 $[0,1]$ 内的小数。将最终数值四舍五入至四位有效数字。请将您的最终答案以一个单行矩阵的形式给出，其中依次包含灵敏度、特异度和 $F_{1}$ 分数。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它提供了一套完整且一致的数据，用于使用标准性能指标评估一个二元分类器——在本例中是一个基因组变异检出工具。该问题背景与基因组诊断和精准医疗领域直接相关，而这正是人类基因组计划的一项关键遗产。我们将继续推导并计算所要求的指标。\n\n问题提供了将一个单核苷酸多态性 (SNP) 检出工具与一个高可信度真实参考资源进行比较后得出的以下数据：\n\n1.  经整理的SNP阳性位点数（Condition Positive, $P$）为 $P = 50,000$。\n2.  经整理的SNP阴性位点数（Condition Negative, $N$）为 $N = 5,000,000$。\n3.  真阳性（$TP$）数，即检出工具正确识别出SNP的次数，为 $TP = 49,000$。\n4.  假阳性（$FP$）数，即检出工具在阴性位点上错误识别出SNP的次数，为 $FP = 1,000$。\n5.  假阴性（$FN$）数，即检出工具未能识别出真实SNP的次数，为 $FN = 1,000$。\n\n根据这些给定条件，我们必须首先确定真阴性（$TN$）的数量，即检出工具正确识别为阴性的经整理SNP阴性位点数。问题陈述，在SNP阴性集合中所有未被检出为SNP的位点均为真阴性。SNP阴性位点的总数是 $N$，其中被错误检出为阳性的位点数是 $FP$。因此，真阴性的数量由以下公式给出：\n$$\nTN = N - FP\n$$\n代入所提供的值：\n$$\nTN = 5,000,000 - 1,000 = 4,999,000\n$$\n我们可以验证所提供数字的一致性。阳性样本总数必须等于真阳性与假阴性之和：\n$$\nP = TP + FN = 49,000 + 1,000 = 50,000\n$$\n这与给定的 $P$ 值相符。阴性样本总数必须等于假阳性与真阴性之和：\n$$\nN = FP + TN = 1,000 + 4,999,000 = 5,000,000\n$$\n这与给定的 $N$ 值相符。数据内部是一致的。\n\n现在，我们来推导并计算三个要求的性能指标。\n\n**1. 灵敏度 (Sensitivity)（或称召回率 (Recall) 或真阳性率 (True Positive Rate)）**\n\n灵敏度衡量在实际为阳性的实例中被分类器正确识别的比例。它定义为真阳性数与阳性样本总数（$P = TP + FN$）之比。\n\n基本定义为：\n$$\n\\text{Sensitivity} = \\frac{TP}{P} = \\frac{TP}{TP + FN}\n$$\n代入给定值：\n$$\n\\text{Sensitivity} = \\frac{49,000}{49,000 + 1,000} = \\frac{49,000}{50,000} = 0.98\n$$\n四舍五入到四位有效数字，灵敏度为 $0.9800$。\n\n**2. 特异度 (Specificity)（或称真阴性率 (True Negative Rate)）**\n\n特异度衡量在实际为阴性的实例中被分类器正确识别的比例。它定义为真阴性数与阴性样本总数（$N = FP + TN$）之比。\n\n基本定义为：\n$$\n\\text{Specificity} = \\frac{TN}{N} = \\frac{TN}{FP + TN}\n$$\n使用我们计算出的 $TN$ 值：\n$$\n\\text{Specificity} = \\frac{4,999,000}{1,000 + 4,999,000} = \\frac{4,999,000}{5,000,000} = 0.9998\n$$\n该值已表示为四位有效数字。\n\n**3. $F_1$ 分数**\n\n$F_1$ 分数是精确率 (Precision) 和召回率 (Recall)（即灵敏度）的调和平均数。它提供了一个单一指标，平衡了精确率和召回率两方面的考量。\n\n首先，让我们定义精确率，也称为阳性预测值 (Positive Predictive Value, PPV)。精确率衡量在预测为阳性的实例中，实际为阳性的比例。其定义为：\n$$\n\\text{Precision} = \\frac{TP}{\\text{Predicted Positive}} = \\frac{TP}{TP + FP}\n$$\n对于此数据集，精确率为：\n$$\n\\text{Precision} = \\frac{49,000}{49,000 + 1,000} = \\frac{49,000}{50,000} = 0.98\n$$\n召回率是灵敏度的另一个术语，我们已计算出其值为 $0.98$。\n\n$F_1$ 分数的定义为：\n$$\nF_1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}}\n$$\n一个更直接的公式，由上式推导而来，并用基本计数（$TP, FP, FN$）表示，是：\n$$\nF_1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}\n$$\n使用此直接公式和给定值：\n$$\nF_1 = \\frac{2 \\cdot 49,000}{2 \\cdot 49,000 + 1,000 + 1,000} = \\frac{98,000}{98,000 + 2,000} = \\frac{98,000}{100,000} = 0.98\n$$\n四舍五入到四位有效数字，$F_1$ 分数为 $0.9800$。\n\n总结来说，该SNP检出工具计算出的性能指标，四舍五入至四位有效数字后为：\n- 灵敏度：$0.9800$\n- 特异度：$0.9998$\n- $F_1$ 分数：$0.9800$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9800 & 0.9998 & 0.9800\n\\end{pmatrix}\n}\n$$"
        }
    ]
}