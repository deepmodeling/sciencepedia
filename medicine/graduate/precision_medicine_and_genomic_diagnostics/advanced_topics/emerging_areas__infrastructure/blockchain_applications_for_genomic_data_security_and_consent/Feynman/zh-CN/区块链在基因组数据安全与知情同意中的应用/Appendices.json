{
    "hands_on_practices": [
        {
            "introduction": "区块链的不可篡改性依赖于密码学哈希函数。本练习将通过计算攻击者在不被发现的情况下伪造记录的概率，来量化这种方法的安全性 ()。这种动手计算有助于您直观地理解支撑整个系统的“计算安全性”概念。",
            "id": "4320246",
            "problem": "一个精准肿瘤学联盟通过将规范化后的变异调用格式 (VCF) 文件提交到许可链来记录每位患者文件的完整性。该提交形式为一个密码学承诺，其值等于一个具有 $n$ 位输出的哈希函数的输出。存储的承诺是规范化记录 $R$ 的 $n$ 位摘要 $H(R)$。为了在不被检测到的情况下破坏审计追踪，攻击者必须生成一个篡改后的记录 $R^{\\prime} \\neq R$，使得 $H(R^{\\prime}) = H(R)$。这样一来，当验证者重新计算哈希值时，会错误地根据链上承诺验证通过这个篡改后的记录。假设以下基本前提：\n- 该哈希函数表现为从比特串空间到 $2^{n}$ 种可能的 $n$ 位输出集合的均匀随机映射（这是现代密码学中抗碰撞性和抗第二原像性的基础——随机预言机理想化模型）。\n- 攻击者构建的每个不同的篡改候选记录 $R^{\\prime}$ 所产生的 $n$ 位输出，相对于固定的目标摘要 $H(R)$，是在 $2^{n}$ 种可能的摘要上独立且均匀分布的。\n- 针对单个目标记录 $R$，攻击者最多可以准备 $Q$ 个不同的、语法上有效的篡改记录 $R^{\\prime}_{1},\\dots,R^{\\prime}_{Q}$ 来与存储的摘要进行比对测试。\n\n从这些基本事实和初等概率论出发，推导在 $Q$ 次尝试中至少有一次导致错误验证的确切概率，即对于某个 $i \\in \\{1,\\dots,Q\\}$，有 $H(R^{\\prime}_{i}) = H(R)$。请将最终答案表示为仅含 $n$ 和 $Q$ 的闭式解析表达式，无需近似。\n\n然后，在您的解题过程（而非最终答案）中，使用您的表达式和第一性原理来论证，为什么在精准医疗中选择 $n \\ge 256$ 对于确保临床数据完整性是合适的，即即便 $Q$ 反映了对可行攻击尝试次数的极其保守的全系统范围上限，错误验证的总概率仍然可以忽略不计。不需要进行数值四舍五入，概率值也不报告单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第 1 步：提取已知信息\n- 一个哈希函数具有 $n$ 位输出。\n- 一条规范化记录 $R$ 的密码学承诺是其哈希摘要 $H(R)$。\n- 攻击者试图找到一个篡改后的记录 $R^{\\prime} \\neq R$，使得 $H(R^{\\prime}) = H(R)$。这是一种第二原像攻击。\n- 哈希函数被建模为随机预言机：一个到 $2^n$ 种可能输出的均匀随机映射。\n- 每个不同的篡改候选记录 $R^{\\prime}$ 的哈希输出在 $2^n$ 种可能的摘要上是独立且均匀分布的。\n- 针对单个目标记录 $R$，攻击者最多可以生成并测试 $Q$ 个不同的篡改记录 $R^{\\prime}_{1}, \\dots, R^{\\prime}_{Q}$。\n\n### 第 2 步：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n\n- **科学上合理**：该问题基于随机预言机模型，这是理论密码学中用于分析哈希函数安全性的一个标准且基础的理想化模型。该场景描述了第二原像攻击，这是一个经典的密码学问题。其应用背景——在临床环境中使用区块链保障数据完整性——是一个公认且正在被积极探索的领域。问题的前提是科学上合理的。\n- **定义明确**：该问题是定义明确的。它提供了所有必要信息：哈希输出空间的大小 ($2^n$)、攻击尝试的次数 ($Q$)，以及概率模型（独立、均匀的试验）。它要求一个特定的量——至少一次成功的确切概率——这可以从已知信息中唯一确定。\n- **客观**：该问题以精确、客观、形式化的语言陈述，没有歧义或主观性陈述。\n\n该问题未表现出验证清单中列出的任何缺陷。它在科学上是合理的、可形式化的、信息完整的且定义明确的。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。将推导其解答。\n\n### 概率推导\n目标是计算攻击者在 $Q$ 次尝试内为给定的哈希摘要 $H(R)$ 找到第二原像的概率。这等同于在集合 $\\{R^{\\prime}_1, \\dots, R^{\\prime}_Q\\}$ 中，至少存在一个篡改记录 $R^{\\prime}_i$ 满足条件 $H(R^{\\prime}_i) = H(R)$ 的概率。\n\n令 $N$ 为可能的 $n$ 位哈希输出的总数。我们有 $N = 2^n$。目标摘要是一个单一的、固定的值 $h = H(R)$。\n\n根据问题陈述，对于任何候选记录 $R^{\\prime}_i$，其输出 $H(R^{\\prime}_i)$ 在 $N$ 个可能值上是均匀分布的。因此，单次尝试成功的概率，即 $H(R^{\\prime}_i)$ 与特定目标 $h$ 匹配的概率为：\n$$ P(H(R^{\\prime}_i) = h) = \\frac{1}{N} = \\frac{1}{2^n} $$\n令 $E_i$ 为第 $i$ 次尝试成功的事件，即 $H(R^{\\prime}_i) = H(R)$。问题要求的是事件 $A = E_1 \\cup E_2 \\cup \\dots \\cup E_Q$ 的概率，也就是 $Q$ 次尝试中至少有一次成功的事件。\n\n首先计算其补事件 $A^c$ 的概率会更易于处理，$A^c$ 是指*所有* $Q$ 次尝试都失败的事件。\n单次尝试失败的概率是：\n$$ P(E_i^c) = P(H(R^{\\prime}_i) \\neq H(R)) = 1 - P(E_i) = 1 - \\frac{1}{2^n} $$\n问题陈述指出，不同候选记录的输出是独立的。因此，事件 $E_1, E_2, \\dots, E_Q$ 是独立的伯努利试验。所有 $Q$ 次独立尝试都失败的概率是它们各自失败概率的乘积：\n$$ P(A^c) = P(E_1^c \\cap E_2^c \\cap \\dots \\cap E_Q^c) = \\prod_{i=1}^{Q} P(E_i^c) = \\left(1 - \\frac{1}{2^n}\\right)^Q $$\n因此，至少有一次成功的概率 $P(A)$ 等于 $1$ 减去全部失败的概率：\n$$ P(A) = 1 - P(A^c) = 1 - \\left(1 - \\frac{1}{2^n}\\right)^Q $$\n这就是关于 $n$ 和 $Q$ 的、用于表示错误验证概率的确切、闭式解析表达式。\n\n### 选择 $n \\ge 256$ 的合理性论证\n推导出的概率 $p_{ success} = 1 - \\left(1 - \\frac{1}{2^n}\\right)^Q$ 量化了该承诺方案抵抗第二原像攻击的安全性。在如临床数据完整性这类高风险应用中，要使此概率被视为“可忽略不计”，它必须小到没有任何物理意义。我们必须在选择 $n=256$ 和对 $Q$ 进行极其保守估计的情况下评估这一点。\n\n项 $Q$ 代表攻击者可以执行的总计算工作量。让我们为 $Q$ 设定一个不切实际但保守的上限。比特币网络是巨大专业算力的集合，其总哈希率约为每秒 $10^{21}$ 次哈希。我们假设一个攻击者能够支配这种算力一千年（约 $3.15 \\times 10^{10}$ 秒）。\n计算出的总哈希次数将是：\n$$ Q \\approx (10^{21} \\ \\text{s}^{-1}) \\times (3.15 \\times 10^{10} \\ \\text{s}) \\approx 3.15 \\times 10^{31} $$\n为了将其表示为 2 的幂，我们使用近似值 $10^3 \\approx 2^{10}$：\n$$ Q \\approx 3.15 \\times (10^3)^{10.33} \\approx 3.15 \\times (2^{10})^{10.33} = 3.15 \\times 2^{103.3} $$\n因为 $3.15  4 = 2^2$，我们可以建立一个宽松但安全的上限：$Q  2^2 \\times 2^{103.3} = 2^{105.3}$。为简单起见，我们取 $Q = 2^{106}$。这个计算量远超任何单一实体当前或可预见的计算能力。\n\n现在，我们用 $n=256$ 和这个巨大的 $Q=2^{106}$ 来评估成功概率。\n对于每次试验极小的成功概率 $p = 1/2^n$，总概率的表达式可以通过一阶泰勒展开进行精确近似：$(1-p)^Q \\approx 1 - Qp$。\n$$ p_{success} \\approx 1 - \\left(1 - Q \\frac{1}{2^n}\\right) = \\frac{Q}{2^n} $$\n代入我们的值：\n$$ p_{success} \\approx \\frac{2^{106}}{2^{256}} = 2^{106 - 256} = 2^{-150} $$\n$2^{-150}$ 这个概率小到天文数字级别，没有任何物理上的直观意义。作为参照，可观测宇宙中原子的估计数量约为 $10^{80}$，这小于 $2^{266}$。在这些极为宽松的假设下，攻击者成功的概率，远小于（例如）从一万亿乘以一万亿个宇宙中随机选中一个预先指定的单个原子的概率。\n\n一个哈希函数抵抗第二原像攻击的安全性由其“位安全性”来描述，对于一个 $n$ 位的哈希函数，其位安全性为 $n$。256 位的安全级别意味着攻击者需要执行大约 $2^{256}$ 次操作才能有显著的成功机会。如上所示，即使是远超全球算力许多数量级的计算努力，所产生的成功概率也实际上为零。因此，选择 $n \\ge 256$ 提供了一个足以抵御可预见未来所有经典计算能力进步的安全边际，使其成为确保关键基因组数据不可否认完整性的恰当选择。",
            "answer": "$$\n\\boxed{1 - \\left(1 - \\frac{1}{2^n}\\right)^Q}\n$$"
        },
        {
            "introduction": "虽然将所有数据存储在链上能提供最高的安全性，但这通常成本高昂且效率低下。本练习探讨了一种常见的解决方案：使用默克尔承诺（Merkle commitments）将链下数据锚定到区块链上 ()。通过计算和比较不同策略的存储成本，您将对设计可扩展且可持续的医疗保健区块链系统所涉及的架构权衡有更实际的理解。",
            "id": "4320216",
            "problem": "一家医院部署了一个许可链，以保护和审计对基因组数据的访问，作为精准医疗和基因组诊断的一部分。该区块链作为一个只追加日志来运行。每个审计事件记录了操作者地址、时间戳、数字签名以及事件负载的加密哈希。通过每月的默克尔树承诺启用链下归档，这些承诺将每个基因组的审计事件批次锚定在链上。该医院每年处理 $M$ 个完整基因组；对于每个处理过的基因组，当年有 $E$ 个审计事件。事件分为两类：同意更新和访问事件。设同意更新的比例为 $p_{c}$，访问事件的比例为 $1 - p_{c}$。假设链上条目和承诺的字节级结构如下：\n- 对于发布在链上的同意更新事件：负载 $256$ 字节，签名 $64$ 字节，哈希 $32$ 字节，操作者地址 $20$ 字节，时间戳 $8$ 字节，以及交易开销 $110$ 字节，总计 $s_{c}$ 字节。\n- 对于发布在链上的访问事件：负载 $128$ 字节，签名 $64$ 字节，哈希 $32$ 字节，操作者地址 $20$ 字节，时间戳 $8$ 字节，以及交易开销 $110$ 字节，总计 $s_{a}$ 字节。\n- 对于在归档策略下发布在链上的每月每个基因组的默克尔承诺：默克尔根 $32$ 字节，批次盐值 $32$ 字节，周期标识符 $16$ 字节，审计者地址 $20$ 字节，签名 $64$ 字节，以及交易开销 $110$ 字节，总计 $s_{\\mathrm{commit}}$ 字节。每个基因组每年有 $12$ 个这样的承诺。在归档策略下，同意更新继续单独发布在链上，而访问事件则保存在链下，并且只包含在每月的承诺中。\n\n假设 $M = 18{,}500$，$E = 320$，$p_{c} = 0.07$，计算在以下策略下的预期年链上存储增长：\n1. 将每个审计事件都发布在链上的朴素策略。\n2. 为每个基因组发布每月承诺，并且只将同意更新单独保留在链上的归档策略。\n\n然后，通过报告归档策略的预期年链上存储增长与朴素策略的预期年链上存储增长的比率来评估该裁剪策略。使用期望对事件混合的线性性质，并假设事件类型和负载大小是独立的。将最终比率四舍五入到四位有效数字。以不带单位的小数形式表示最终比率。最终答案必须是单个实数。",
            "solution": "我们从核心定义开始：\n- 区块链是一个只追加日志；链上存储通过添加以字节描述的条目来累积。\n- 当事件从有限的类型混合中抽取时，一个随机选择的事件的期望大小是各种类型大小的混合加权平均值。\n- 期望的线性性质意味着，当事件数量和事件大小独立时，预期的总大小是预期的事件数量乘以每个事件的期望大小。\n\n首先，根据给定的字节组成部分计算每个条目的大小：\n- 同意更新事件的链上大小：\n$$\ns_{c} = 256 + 64 + 32 + 20 + 8 + 110 = 490 \\text{ 字节}。\n$$\n- 访问事件的链上大小：\n$$\ns_{a} = 128 + 64 + 32 + 20 + 8 + 110 = 362 \\text{ 字节}。\n$$\n- 每月默克尔承诺的链上大小：\n$$\ns_{\\mathrm{commit}} = 32 + 32 + 16 + 20 + 64 + 110 = 274 \\text{ 字节}。\n$$\n\n设 $M = 18{,}500$，$E = 320$，以及 $p_{c} = 0.07$，则 $1 - p_{c} = 0.93$。\n\n朴素策略：\n- 在混合模型下，每个事件的期望大小为\n$$\n\\mathbb{E}[S_{\\text{event}}] = p_{c} \\, s_{c} + (1 - p_{c}) \\, s_{a} = 0.07 \\cdot 490 + 0.93 \\cdot 362.\n$$\n计算数值：\n$$\n0.07 \\cdot 490 = 34.3, \\quad 0.93 \\cdot 362 = 336.66, \\quad \\Rightarrow \\mathbb{E}[S_{\\text{event}}] = 34.3 + 336.66 = 370.96 \\text{ 字节}。\n$$\n- 所有基因组每年的预期事件总数为 $M E = 18{,}500 \\times 320 = 5{,}920{,}000$ 个事件。\n- 因此，在朴素策略下，预期的年链上存储为\n$$\nS_{\\text{naive}} = (M E) \\cdot \\mathbb{E}[S_{\\text{event}}] = 5{,}920{,}000 \\times 370.96 = 2{,}196{,}083{,}200 \\text{ 字节}。\n$$\n\n归档策略：\n- 每个基因组的每月承诺：每个基因组每年有 $12$ 个承诺，每个大小为 $s_{\\mathrm{commit}} = 274$ 字节。对于每个基因组，这部分贡献的存储为\n$$\n12 \\cdot s_{\\mathrm{commit}} = 12 \\cdot 274 = 3{,}288 \\text{ 字节}。\n$$\n- 同意更新仍然单独保留在链上。每个基因组每年预期的同意事件数量为 $p_{c} E = 0.07 \\times 320 = 22.4$。每个同意事件贡献 $s_{c} = 490$ 字节，因此每个基因组预期的同意事件字节数为\n$$\n( p_{c} E ) \\cdot s_{c} = 22.4 \\cdot 490 = 10{,}976 \\text{ 字节}。\n$$\n- 在归档策略下，每个基因组每年的预期链上存储是两部分之和：\n$$\n3{,}288 + 10{,}976 = 14{,}264 \\text{ 字节}。\n$$\n- 对于所有基因组，预期的年链上存储为\n$$\nS_{\\text{archival}} = M \\cdot 14{,}264 = 18{,}500 \\cdot 14{,}264 = 263{,}884{,}000 \\text{ 字节}。\n$$\n\n通过比率进行评估：\n- 裁剪评估比率是归档策略的存储量除以朴素策略的存储量：\n$$\nR = \\frac{S_{\\text{archival}}}{S_{\\text{naive}}} = \\frac{263{,}884{,}000}{2{,}196{,}083{,}200}.\n$$\n计算小数值。观察到\n$$\n2{,}196{,}083{,}200 \\times 0.12 = 263{,}529{,}984,\n$$\n并且需要的剩余部分是 $263{,}884{,}000 - 263{,}529{,}984 = 354{,}016$。分母乘以 $0.00016$ 是\n$$\n2{,}196{,}083{,}200 \\times 0.00016 = 351{,}373.312,\n$$\n剩余 $2{,}642.688$。分母乘以 $0.0000012$ 是\n$$\n2{,}196{,}083{,}200 \\times 0.0000012 = 2{,}635.29984,\n$$\n这几乎填满了剩余部分。因此\n$$\nR \\approx 0.12 + 0.00016 + 0.0000012 = 0.1201612.\n$$\n四舍五入到四位有效数字，比率为\n$$\nR \\approx 0.1202.\n$$\n这个小数没有单位，它表示通过带有链上承诺的链下归档相对于朴素策略所实现的预期年链上存储的缩减比例。",
            "answer": "$$\\boxed{0.1202}$$"
        },
        {
            "introduction": "验证知情同意通常需要根据患者定义的规则检查请求者的敏感属性，这会带来隐私困境。零知识证明（zk-SNARKs）为此提供了一个强大的解决方案，它允许在不泄露底层数据的情况下完成验证过程 ()。本练习将让您通过设计一个基本的知情同意验证“电路”并估算其复杂度，具体了解此类系统的构建方式，从而揭开这项前沿技术的神秘面纱。",
            "id": "4320232",
            "problem": "考虑一个用于精准医疗基因组诊断的同意管理系统，该系统通过一个区块链智能合约实现，该合约能验证来自零知识简洁非交互式知识论证 (zk-SNARK) 的证明。其目标是，仅当请求者的角色属性和声明的研究范围满足已发布的同意谓词时，才允许请求者访问加密的基因组数据，同时对验证者隐藏请求者的详细属性。假设该 zk-SNARK 在一个有限域上实例化，其计算被建模为一个一阶秩约束系统 (R1CS)，其中每个约束的形式为 $L(\\mathbf{z}) \\cdot R(\\mathbf{z}) = O(\\mathbf{z})$，这里的 $L$、$R$ 和 $O$ 是变量向量 $\\mathbf{z}$ 的仿射线性形式。定义电路规模为此类乘法约束的总数。\n\n设请求者的角色属性向量为 $\\mathbf{a} = (a_{1}, a_{2}, \\dots, a_{n})$，其中每个 $a_{i} \\in \\{0,1\\}$ 编码一个角色属性是否存在（例如，$a_{i} = 1$ 可能表示“机构审查委员会批准的研究员”）。设研究范围由单个域元素 $s$ 表示，该元素编码一个枚举的研究标识符。公开同意以 $m$ 个析取谓词的形式发布，每个谓词 $j \\in \\{1,2,\\dots,m\\}$ 指定一个所需角色属性索引 $i_{j}$ 及其所需值 $c_{j} \\in \\{0,1\\}$，以及一个在域中的所需研究范围值 $s_{j}$。当且仅当 $m$ 个谓词中有一个成立时，即对于某个 $j$ 有 $(a_{i_{j}} = c_{j})$ 且 $(s = s_{j})$，请求被授权。\n\n从布尔约束 $x \\in \\{0,1\\}$（通过 $x(x-1)=0$ 强制执行）的定义以及等式和门控的 R1CS 公式化出发，推导一个 R1CS 电路，该电路：\n1. 强制每个角色属性 $a_{i}$ 的布尔性。\n2. 使用 $m$ 个指示变量 $b_{1}, \\dots, b_{m}$（其中 $b_{j} \\in \\{0,1\\}$）来门控第 $j$ 个谓词，使得 $b_{j}=1$ 强制 $(a_{i_{j}} = c_{j})$ 且 $(s = s_{j})$，而 $b_{j}=0$ 使该门控无效。\n3. 通过要求 $\\sum_{j=1}^{m} b_{j} = 1$ 来强制恰好有一个谓词是活动的。\n\n假设每个布尔性条件 $x(x-1)=0$ 恰好花费一个 R1CS 乘法约束，每个与常数的等式检查通过一个形如 $b_{j} \\cdot (x - \\text{const}) = 0$ 的乘法约束在一个门控内部强制执行，并且“恰好一个活动谓词”的条件通过单个乘法约束 $(\\sum_{j=1}^{m} b_{j} - 1) \\cdot 1 = 0$ 来强制执行。不包括哈希或承诺验证的成本；将 $s$ 和所有常数视为电路可用的域元素。使用这些基础和电路的第一性原理推导，计算近似电路规模（R1CS 乘法约束的总数）作为 $m$ 和 $n$ 的函数的闭式表达式。将您的最终答案表示为仅包含 $m$ 和 $n$ 的单个解析表达式，不带单位，且不要四舍五入。",
            "solution": "该问题要求针对 zk-SNARK 中特定的同意验证逻辑，为其 R1CS 乘法约束的总数（即电路规模）推导出一个闭式表达式。总电路规模是强制执行所有指定逻辑条件所需约束的总和。让我们通过系统地分析问题陈述中描述的每个要求来推导这个规模。\n\n一个 R1CS 约束的形式为 $L(\\mathbf{z}) \\cdot R(\\mathbf{z}) = O(\\mathbf{z})$，其中 $L$、$R$ 和 $O$ 是见证向量 $\\mathbf{z}$ 中变量的仿射线性组合。总电路规模是这类乘法约束的总数。\n\n推导过程分解为与电路三个主要要求相关的成本：\n1.  强制 $n$ 个角色属性 $\\mathbf{a} = (a_1, a_2, \\dots, a_n)$ 的布尔性质。\n2.  使用 $m$ 个指示变量 $\\mathbf{b} = (b_1, b_2, \\dots, b_m)$ 实现门控谓词逻辑。\n3.  强制 $m$ 个谓词中恰好有一个是活动的。\n\n让我们根据提供的成本模型计算每个部分的约束数量。\n\n**1. 布尔属性 ($a_i$) 的约束**\n问题指出，每个角色属性 $a_i$ 都必须是布尔值，即 $a_i \\in \\{0, 1\\}$。这个条件通过以下代数约束来强制执行：\n$$a_i(a_i - 1) = 0$$\n对于每个 $a_i$ 这是一个单一的乘法约束。在 R1CS 形式 $L \\cdot R = O$ 中，我们可以设置 $L(\\mathbf{z}) = a_i$，$R(\\mathbf{z}) = a_i - 1$ 和 $O(\\mathbf{z}) = 0$。\n问题指定有 $n$ 个这样的角色属性。因此，这部分的总约束数是属性的数量，即 $n$。\n$$C_a = n$$\n\n**2. 门控谓词逻辑的约束**\n电路的这一部分使用 $m$ 个指示变量 $b_1, \\dots, b_m$ 来选择并强制执行 $m$ 个析取谓词中的一个。该逻辑涉及确保指示变量本身是布尔值，并使用它们来门控相关条件。\n\n**2a. 布尔指示变量 ($b_j$) 的约束**\n问题指定指示变量 $b_j$ 也必须是布尔值，即 $b_j \\in \\{0, 1\\}$。与属性 $a_i$ 类似，这通过以下约束来强制执行：\n$$b_j(b_j - 1) = 0$$\n对每个 $j \\in \\{1, 2, \\dots, m\\}$。\n根据问题的成本模型，每次这样的检查花费一个乘法约束。由于有 $m$ 个指示变量，确保其布尔性质的总约束数是：\n$$C_b = m$$\n\n**2b. 门控谓词条件的约束**\n对于每个谓词 $j$，如果对应的指示变量 $b_j$ 为 $1$，电路必须强制执行条件 $(a_{i_j} = c_j)$ 和 $(s = s_j)$。如果 $b_j=0$，这些条件必须是无效的。这是通过门控等式约束实现的。\n\n对于属性检查，约束是：\n$$b_j \\cdot (a_{i_j} - c_j) = 0$$\n对于研究范围检查，约束是：\n$$b_j \\cdot (s - s_j) = 0$$\n问题陈述中说“每个与常数的等式检查通过一个乘法约束在一个门控内部强制执行”。每个谓词 $j$ 涉及两个这样的等式检查：一个用于属性，一个用于范围。因此，对于 $m$ 个谓词中的每一个，我们都需要 $2$ 个乘法约束。\n\n门控所有 $m$ 个谓词的总约束数是：\n$$C_{\\text{gates}} = 2 \\times m = 2m$$\n\n**3. “恰好一个活动谓词”的约束**\n最终的要求是必须恰好满足一个谓词。这通过确保指示变量 $b_j$ 中恰好有一个等于 $1$，而所有其他都等于 $0$ 来强制执行。这由求和约束表示：\n$$\\sum_{j=1}^{m} b_j = 1$$\n问题明确指出，此条件通过一个形如以下的单一 R1CS 乘法约束来强制执行：\n$$\\left(\\sum_{j=1}^{m} b_j - 1\\right) \\cdot 1 = 0$$\n在这里，我们可以设置 $L(\\mathbf{z}) = \\sum_{j=1}^{m} b_j - 1$，$R(\\mathbf{z}) = 1$ 和 $O(\\mathbf{z}) = 0$。这完全符合 R1CS 结构，并且根据问题的指示，恰好花费一个约束。请注意，这个约束与每个 $b_j$ 的布尔性约束（来自第 2a 部分）相结合，足以保证恰好有一个 $b_j$ 为 $1$。\n这部分的总约束数是：\n$$C_{\\text{sum}} = 1$$\n\n**总电路规模**\n总电路规模，记为 $S(m, n)$，是上面推导的所有部分约束的总和。\n$$S(m, n) = C_a + C_b + C_{\\text{gates}} + C_{\\text{sum}}$$\n代入我们求得的值：\n$$S(m, n) = n + m + 2m + 1$$\n$$S(m, n) = n + 3m + 1$$\n这就是 R1CS 乘法约束总数的闭式表达式，它是角色属性数量 $n$ 和同意谓词数量 $m$ 的函数。",
            "answer": "$$\n\\boxed{n + 3m + 1}\n$$"
        }
    ]
}