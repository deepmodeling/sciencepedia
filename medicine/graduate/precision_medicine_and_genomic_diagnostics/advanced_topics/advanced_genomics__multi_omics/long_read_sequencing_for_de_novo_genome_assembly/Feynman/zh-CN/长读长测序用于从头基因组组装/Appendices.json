{
    "hands_on_practices": [
        {
            "introduction": "在任何基因组学项目启动之前，审慎的实验设计是确保成功的基石，在临床应用中尤其如此。这项练习将理论上的覆盖度目标与测序产出变异、文库质量过滤等实际因素联系起来，引导您应用统计学原理来估算所需的测序资源。通过这个实践，您将掌握如何在充满不确定性的真实世界条件下，为达到临床级别的组装质量而进行稳健的规划。",
            "id": "4356388",
            "problem": "计划使用牛津纳米孔技术（Oxford Nanopore Technologies, ONT）或太平洋生物科学公司（Pacific Biosciences, PacBio）的长读长测序技术进行临床从头人类基因组组装。对于大小为 $G=3.1$ 吉碱基对的人类单倍体基因组，目标单倍体覆盖度为 $c=30$。每个流动池的预计原始产量为 $Y$ 吉碱基对。由于文库和读长质量的影响，只有一部分原始产量对有效组装覆盖度有贡献：有 $q=0.85$ 的碱基通过了组装流程中使用的质量阈值，在去除接头和污染物后，有 $m=0.98$ 的碱基来源于人类DNA，并且为了满足组装软件的最小读长要求，经过长度筛选后保留了 $r=0.95$ 的碱基。由于孔间和运行间的差异，每个流动池的有效产量是可变的；假设每个流动池的有效产量是独立同分布的，其变异系数 $\\gamma=0.25$ （定义为标准差除以均值）。为保证临床要求，$n$ 个流动池的总有效产量必须以至少 $0.95$ 的单侧概率达到或超过目标覆盖度。\n\n仅从覆盖度定义（预期覆盖度等于测序总碱基数除以基因组大小）和适用于独立贡献总和的标准概率极限定理出发，推导出一个最小整数 $n$ 作为 $Y$ 的函数的封闭式表达式，该表达式保证有效总产量以至少 $0.95$ 的单侧概率达到或超过 $G$ 上的 $c$ 倍目标。最终答案应表示为仅含 $Y$ 的单一解析表达式，并使用向上取整函数表示最小整数流动池数。最终表达式中不要包含单位。",
            "solution": "该问题经评估有效，因为它具有科学依据、问题明确、客观，并包含足够的信息以推导出唯一解。该场景是统计学原理在基因组学实际问题中的一个标准应用。\n\n目标是找到所需的最少整数流动池数 $n$ ，以在指定单侧概率下，对大小为 $G$ 的基因组实现目标单倍体覆盖度 $c$ 。\n\n首先，我们定义问题陈述中提供的参数和变量。\n- 目标单倍体覆盖度: $c = 30$。\n- 单倍体基因组大小: $G = 3.1$ 吉碱基对。\n- 每个流动池的预计原始产量: $Y$ 吉碱基对。\n- 通过质量阈值的碱基比例: $q = 0.85$。\n- 来自人类DNA（非污染物）的碱基比例: $m = 0.98$。\n- 长度筛选后保留的碱基比例: $r = 0.95$。\n- 每个流动池有效产量的变异系数: $\\gamma = 0.25$。\n- 流动池数量，待确定的整数: $n$。\n- 要求的单侧概率: $P \\ge 0.95$。\n\n在大小为 $G$ 的基因组上实现覆盖度 $c$ 所需的有效碱基总数为乘积 $c \\times G$。我们将此目标产量表示为 $B_{target}$。\n$$B_{target} = cG$$\n每个流动池的原始产量 $Y$ 会因几个因素而减少。对有效组装覆盖度有贡献的原始产量比例，我们表示为 $f$ ，是给定比例的乘积：\n$$f = q \\times m \\times r = 0.85 \\times 0.98 \\times 0.95 = 0.79135$$\n设 $y_i$ 是表示第 $i$ 个流动池有效产量的随机变量。问题陈述预计原始产量为 $Y$，因此我们取每个流动池的平均有效产量 $\\mu_y$ 为：\n$$\\mu_y = Y \\times f = 0.79135 Y$$\n问题指明，每个流动池的有效产量是独立同分布的（i.i.d.），变异系数为 $\\gamma = 0.25$。变异系数定义为标准差与均值的比值。因此，每个流动池有效产量的标准差 $\\sigma_y$ 为：\n$$\\sigma_y = \\gamma \\mu_y = 0.25 \\times (0.79135 Y) = 0.1978375 Y$$\n$n$ 个流动池的总有效产量 $T_n$ 是各个产量的总和：\n$$T_n = \\sum_{i=1}^n y_i$$\n由于变量 $y_i$ 的独立同分布特性，总产量的均值 $\\mu_{T_n}$ 和总产量的方差 $\\sigma_{T_n}^2$ 分别为：\n$$\\mu_{T_n} = E[T_n] = n \\mu_y = n(0.79135 Y)$$\n$$\\sigma_{T_n}^2 = \\text{Var}(T_n) = n \\sigma_y^2 = n (\\gamma \\mu_y)^2 = n \\gamma^2 \\mu_y^2 = n(0.1978375 Y)^2$$\n总产量的标准差为：\n$$\\sigma_{T_n} = \\sqrt{n \\sigma_y^2} = \\sigma_y \\sqrt{n} = \\gamma \\mu_y \\sqrt{n} = 0.1978375 Y \\sqrt{n}$$\n问题要求总有效产量 $T_n$ 达到或超过目标产量 $B_{target}$ 的概率至少为 $0.95$：\n$$P(T_n \\ge cG) \\ge 0.95$$\n根据问题陈述的提示（“适用于独立贡献总和的标准概率极限定理”），我们应用中心极限定理（CLT）。对于足够大的 $n$，总和 $T_n$ 的分布可以近似为均值为 $\\mu_{T_n}$、标准差为 $\\sigma_{T_n}$ 的正态分布。\n$$T_n \\sim \\mathcal{N}(\\mu_{T_n}, \\sigma_{T_n}^2)$$\n为了使用此近似，我们将变量 $T_n$ 标准化为标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$：\n$$Z = \\frac{T_n - \\mu_{T_n}}{\\sigma_{T_n}}$$\n不等式可以改写为关于 $Z$ 的形式：\n$$P\\left(\\frac{T_n - \\mu_{T_n}}{\\sigma_{T_n}} \\ge \\frac{cG - \\mu_{T_n}}{\\sigma_{T_n}}\\right) \\ge 0.95$$\n$$P\\left(Z \\ge \\frac{cG - n\\mu_y}{\\sigma_y \\sqrt{n}}\\right) \\ge 0.95$$\n设 $z_{0.95}$ 是标准正态分布的临界值，使得 $P(Z \\le z_{0.95}) = 0.95$。这对应于第 $95$ 百分位数。根据标准统计表，$z_{0.95} \\approx 1.645$。条件 $P(Z \\ge k) \\ge 0.95$ 等价于 $P(Z  k) \\le 0.05$。这意味着参数 $k$ 必须小于或等于第 $5$ 百分位数，即 $-z_{0.95}$。\n因此，我们必须有：\n$$\\frac{cG - n\\mu_y}{\\sigma_y \\sqrt{n}} \\le -z_{0.95}$$\n重新整理不等式以求解 $n$：\n$$cG - n\\mu_y \\le -z_{0.95} \\sigma_y \\sqrt{n}$$\n$$n\\mu_y - z_{0.95} \\sigma_y \\sqrt{n} - cG \\ge 0$$\n代入 $\\mu_y = Yf$ 和 $\\sigma_y = \\gamma Yf$：\n$$n(Yf) - z_{0.95} (\\gamma Yf) \\sqrt{n} - cG \\ge 0$$\n这是一个关于 $x = \\sqrt{n}$ 的二次不等式：\n$$(Yf)x^2 - (z_{0.95} \\gamma Yf)x - cG \\ge 0$$\n该二次表达式对应一个开口向上的抛物线（因为 $Yf  0$）。当 $x$ 的值大于或等于相应二次方程 $(Yf)x^2 - (z_{0.95} \\gamma Yf)x - cG = 0$ 的较大根时，该不等式成立。根由求根公式给出：\n$$x = \\frac{z_{0.95} \\gamma Yf \\pm \\sqrt{(-z_{0.95} \\gamma Yf)^2 - 4(Yf)(-cG)}}{2(Yf)}$$\n由于 $x = \\sqrt{n}$ 必须为正，我们取正根：\n$$\\sqrt{n} \\ge \\frac{z_{0.95} \\gamma Yf + \\sqrt{(z_{0.95} \\gamma Yf)^2 + 4(Yf)(cG)}}{2Yf}$$\n为了简化，我们可以将分子和分母同除以 $Yf$：\n$$\\sqrt{n} \\ge \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\frac{(z_{0.95} \\gamma Yf)^2}{(2Yf)^2} + \\frac{4YfcG}{(2Yf)^2}}$$\n$$\\sqrt{n} \\ge \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 + \\frac{cG}{Yf}}$$\n两边平方得到关于 $n$ 的条件：\n$$n \\ge \\left( \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 + \\frac{cG}{Yf}} \\right)^2$$\n由于 $n$ 必须是整数，我们对该表达式向上取整，以找到满足条件的最小整数 $n$。\n$$n = \\left\\lceil \\left( \\frac{z_{0.95} \\gamma}{2} + \\sqrt{\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 + \\frac{cG}{Yf}} \\right)^2 \\right\\rceil$$\n现在，我们代入常数的数值：\n- $z_{0.95} \\approx 1.645$\n- $\\gamma = 0.25$\n- $c = 30$\n- $G = 3.1$\n- $f = 0.79135$\n我们来计算常数项：\n$$cG = 30 \\times 3.1 = 93$$\n$$\\frac{z_{0.95} \\gamma}{2} = \\frac{1.645 \\times 0.25}{2} = 0.205625$$\n$$\\left(\\frac{z_{0.95} \\gamma}{2}\\right)^2 = (0.205625)^2 = 0.042281640625$$\n$$\\frac{cG}{f} = \\frac{93}{0.79135}$$\n将这些值代入 $n$ 的表达式中：\n$$n = \\left\\lceil \\left( 0.205625 + \\sqrt{0.042281640625 + \\frac{93}{0.79135 Y}} \\right)^2 \\right\\rceil$$\n这就是所需的最小整数 $n$ 仅作为 $Y$ 的函数的封闭式表达式。",
            "answer": "$$\\boxed{\\left\\lceil \\left( 0.205625 + \\sqrt{0.042281640625 + \\frac{93}{0.79135Y}} \\right)^2 \\right\\rceil}$$"
        },
        {
            "introduction": "基因组中的片段重复 (segmental duplications, SDs) 是从头组装中最艰巨的挑战之一，它们常导致组装错误地将多个拷贝合并成一个序列，即“塌陷”现象。本练习揭示了一个核心的组装质量诊断原则：利用测序读段比对回组装体上的覆盖深度作为基因组拷贝数的代理指标。通过分析不同情况下的预期覆盖度，您将学会如何识别并解释这种关键的组装错误，从而更深入地理解组装体的结构准确性。",
            "id": "4356402",
            "problem": "一名研究人员使用长读长数据从头组装人类基因组，并评估组装中片段重复（segmental duplication, SD）家族的折叠与解析情况。读段（Reads）从基因组中均匀且独立地采样，独特序列中的单碱基覆盖度遵循泊松过程，平均深度为 $C$（倍覆盖度）。读段通过一个比对器比对回组装结果，该比对器为每个读段报告唯一的最佳比对，并在存在多个同样好的比对时，在它们之间进行均匀随机选择。该组装是一个主要的、单倍体表示：如果一个旁系同源家族被完全解析，则每个旁系同源拷贝都由其自身的重叠群（contig）表示；如果它是折叠的，则单个重叠群表示多个旁系同源拷贝的共有序列。为简化问题，假设在标准的鸟嘌呤-胞嘧啶（GC）校正后没有比对或碱基组成偏差，并且在一个家族内，所有旁系同源拷贝具有相同的长度 $L$。\n\n你观察到独特区域的平均单碱基覆盖度为 $C = 30$。考虑三个SD家族：\n- 家族 $\\mathrm{F1}$：真实基因组包含 $k_1 = 3$ 个近乎相同的拷贝（每个长度为 $L = 40\\,\\mathrm{kb}$），而组装将它们表示为一个长度为 $L$ 的单一折叠重叠群。\n- 家族 $\\mathrm{F2}$：真实基因组包含 $k_2 = 4$ 个拷贝（每个长度为 $L$）；组装将其中 $m_2 = 2$ 个拷贝解析为两个不同的重叠群（每个长度为 $L$），并将剩余的 $k_2 - m_2 = 2$ 个拷贝折叠成一个额外的长度为 $L$ 的重叠群。\n- 家族 $\\mathrm{F3}$：真实基因组包含 $k_3 = 2$ 个拷贝（每个长度为 $L$），组装将两者完全解析为两个不同的重叠群（每个长度为 $L$）。\n\n根据这些关于折叠区域与解析区域中预期覆盖度乘数以及基于覆盖度的拷贝数检测方法的假设，选择下面所有正确的陈述。\n\nA. 在 $\\mathrm{F1}$ 中，单一折叠重叠群上的预期单碱基覆盖度约为 $3C$，因此当 $C = 30$ 时，观察到的深度集中在 $90$ 左右。\n\nB. 在 $\\mathrm{F2}$ 中，两个已解析的旁系同源重叠群各自的预期单碱基覆盖度为 $C$（约 $30$），而折叠的重叠群的预期单碱基覆盖度为 $2C$（约 $60$）。\n\nC. 在 $\\mathrm{F3}$ 中，因为来自两个旁系同源拷贝的读段随机分配到两个已解析的重叠群上，所以每个重叠群的预期单碱基覆盖度是 $C/2$（约 $15$）。\n\nD. 一个基于覆盖度的拷贝数估计器，设置 $\\hat{k} = \\mathrm{round}(\\bar{c}/C)$，其中 $\\bar{c}$ 是在基于独特区域进行GC校正后，家族内一个足够长窗口中的平均单碱基覆盖度。该估计器在泊松模型下是最大似然估计（MLE），并且在均匀采样和所述比对策略下，对于真实拷贝数 $k$ 是无偏的；折叠区域将因此产生 $\\hat{k}  1$。\n\nE. 为了避免假阳性，在与全基因组基线比较之前，必须将折叠区域的预期覆盖度除以其重叠群长度，因为单碱基覆盖度随重叠群长度而变化，即使拷贝数不变，较长的折叠重叠群也会夸大表观深度。",
            "solution": "用户希望对所提供的问题陈述进行严格验证，然后是详细的解决方案和对所有选项的评估。\n\n### 第1步：提取已知条件\n\n-   **测序模型：** 读段从基因组中均匀且独立地采样。\n-   **覆盖度模型：** 在独特的、单拷贝区域中，单碱基覆盖度遵循平均深度为 $C$ 的泊松过程。\n-   **比对策略：** 比对器将每个读段映射到其唯一的最佳比对位置。对于同样好的比对，平局会通过均匀随机的方式打破。\n-   **组装结构：** 该组装是一个主要的、单倍体表示。\n    -   一个已解析的片段重复（SD）家族，其每个旁系同源拷贝都由一个不同的重叠群表示。\n    -   一个折叠的SD家族，由一个单一的重叠群表示多个旁系同源拷贝的共有序列。\n-   **假设：** 无比对或碱基组成偏差（经GC校正后）。在一个SD家族内，所有旁系同源拷贝的长度均为 $L$。\n-   **观测数据：** 独特区域的平均覆盖度为 $C = 30$。\n-   **家族 $\\mathrm{F1}$:**\n    -   真实基因组拷贝数：$k_1 = 3$。\n    -   拷贝长度：$L = 40\\,\\mathrm{kb}$。\n    -   组装表示：1个长度为 $L$ 的折叠重叠群。\n-   **家族 $\\mathrm{F2}$:**\n    -   真实基因组拷贝数：$k_2 = 4$。\n    -   组装表示：$m_2 = 2$ 个已解析的重叠群（每个长度为 $L$），以及1个折叠的重叠群（长度为 $L$）代表剩余的 $k_2 - m_2 = 2$ 个拷贝。\n-   **家族 $\\mathrm{F3}$:**\n    -   真实基因组拷贝数：$k_3 = 2$。\n    -   组装表示：2个完全解析的不同重叠群（每个长度为 $L$）。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学基础：** 该问题牢固地植根于计算生物学和基因组学。对读段覆盖度使用泊松模型、从头组装、片段重复、折叠/解析区域以及基于覆盖度的拷贝数估计等概念，都是该领域标准和基础的内容。该模型是一种简化，但代表了一个有效且广泛使用的一阶近似。\n-   **定义明确：** 该问题定义良好。给定的条件和假设为计算每种情况下的预期覆盖度提供了清晰的框架。选项中提出的问题都可以在此框架内得到解答。\n-   **客观性：** 问题陈述是定量的和客观的，使用了精确的定义，避免了模糊性或主观性陈述。\n-   **缺陷清单：**\n    1.  **科学/事实不健全：** 无。该模型就其目的而言是科学合理的。\n    2.  **不可形式化/不相关：** 该问题是可形式化的，并且与指定主题直接相关。\n    3.  **不完整/矛盾的设置：** 设置是自洽和完整的。对于每个家族，真实基因组状态与组装表示之间的关系都得到了清晰的描述。\n    4.  **不切实际/不可行：** 参数（$C=30$, $k=2-4$）对于现代基因组学项目是现实的。比对模型是一个标准的简化。\n    5.  **定义不当/结构不良：** 问题结构良好，并能在给定模型下导出唯一的一组预期覆盖度值。\n    6.  **伪深刻/琐碎：** 问题需要正确应用测序覆盖度的基本原理，并非琐碎问题。\n    7.  **超出科学可验证性：** 所有论断都可以通过基于所提供模型的数学推导来验证。\n\n### 第3步：结论与行动\n\n问题陈述是有效的。我将继续推导解决方案并评估选项。\n\n### 基于原理的推导\n\n基本原理是，从任何区域生成的序列数据量与其在基因组中的总长度成正比。平均覆盖度 $C$ 是为单拷贝（独特）区域定义的。因此，从一个长度为 $L$ 且存在 $k$ 个拷贝的基因组元件中测序得到的总碱基数，预期与 $k \\times L$ 成正比。覆盖度定义为（测序的总碱基数）/（序列长度），因此一个长度为 $L$ 的单拷贝区域的预期覆盖度是 $C \\times L / L = C$。\n\n让我们将此应用于一个组装好的重叠群。一个组装好的重叠群上的预期单碱基覆盖度 $\\bar{c}$，是比对到其上的所有读段的总碱基数除以该重叠群的长度。\n\n$$\n\\bar{c} = \\frac{E[\\text{比对到重叠群的读段总碱基数}]}{\\text{重叠群长度}}\n$$\n\n让我们根据问题的比对策略分析每个家族的预期覆盖度。\n\n**家族F1的分析：**\n-   基因组包含 $k_1 = 3$ 个长度为 $L$ 的近乎相同的片段拷贝。\n-   从这3个拷贝中测序得到的预期总碱基数：$3 \\times L \\times C$。\n-   组装结果是一个长度为 $L$ 的单一折叠重叠群。因为真实的拷贝是“近乎相同的”，所以来自所有3个拷贝的读段都会比对到这个单一重叠群上。\n-   折叠重叠群上的预期覆盖度：\n    $$\n    \\bar{c}_1 = \\frac{3LC}{L} = 3C\n    $$\n-   当 $C = 30$ 时，预期覆盖度为 $\\bar{c}_1 = 3 \\times 30 = 90$。\n\n**家族F2的分析：**\n-   基因组包含 $k_2 = 4$ 个拷贝。\n-   组装结果有2个已解析的重叠群和1个折叠的重叠群。\n-   **已解析的重叠群：** 2个已解析的重叠群中的每一个都代表一个单一的、不同的基因组拷贝。“已解析”意味着有足够的分化，使得比对器能够将来自特定基因组拷贝的读段唯一地比对到其对应的组装重叠群上。\n    -   对于每个已解析的重叠群，它接收来自1个基因组拷贝的读段。\n    -   预期覆盖度：$\\bar{c}_{2, \\text{resolved}} = \\frac{1 \\times L \\times C}{L} = C$。当 $C=30$ 时，此值为 $30$。\n-   **折叠的重叠群：** 这个重叠群代表了剩余的 $k_2 - m_2 = 2$ 个基因组拷贝。来自这2个拷贝的读段将比对到这个单一重叠群上。\n    -   预期覆盖度：$\\bar{c}_{2, \\text{collapsed}} = \\frac{2 \\times L \\times C}{L} = 2C$。当 $C=30$ 时，此值为 $60$。\n\n**家族F3的分析：**\n-   基因组包含 $k_3 = 2$ 个拷贝。\n-   组装结果有2个完全解析的重叠群。与F2中的已解析重叠群一样，“已解析”意味着读段从特定的基因组拷贝唯一地比对到其对应的组装重叠群。\n-   2个重叠群中的每一个都精确地接收来自1个基因组拷贝的读段。\n-   每个重叠群上的预期覆盖度：\n    $$\n    \\bar{c}_3 = \\frac{1 \\times L \\times C}{L} = C\n    $$\n-   当 $C = 30$ 时，预期覆盖度为 $30$。\n\n### 逐项分析选项\n\n**A. 在 $\\mathrm{F1}$ 中，单一折叠重叠群上的预期单碱基覆盖度约为 $3C$，因此当 $C = 30$ 时，观察到的深度集中在 $90$ 左右。**\n-   我们对F1的推导表明，预期覆盖度为 $\\bar{c}_1 = 3C$。\n-   代入 $C = 30$，我们得到预期覆盖度为 $90$。\n-   均值为 $90$ 的泊松分布的标准差为 $\\sqrt{90} \\approx 9.49$。由于标准差相对于均值较小，观察到的覆盖度确实会紧密地聚集或“集中”在 $90$ 左右。\n-   该陈述是 **正确的**。\n\n**B. 在 $\\mathrm{F2}$ 中，两个已解析的旁系同源重叠群各自的预期单碱基覆盖度为 $C$（约 $30$），而折叠的重叠群的预期单碱基覆盖度为 $2C$（约 $60$）。**\n-   我们对F2的推导表明，2个已解析的重叠群各自的预期覆盖度为 $C$（即 $30$），而单一的折叠重叠群（代表2个真实拷贝）的预期覆盖度为 $2C$（即 $60$）。\n-   这个陈述与我们的分析完全匹配。\n-   该陈述是 **正确的**。\n\n**C. 在 $\\mathrm{F3}$ 中，因为来自两个旁系同源拷贝的读段随机分配到两个已解析的重叠群上，所以每个重叠群的预期单碱基覆盖度是 $C/2$（约 $15$）。**\n-   该陈述包含一个前提（“随机分配”）和一个结论（覆盖度是 $C/2$）。让我们基于前提分析结论。\n-   如果来自 $k_3 = 2$ 个真实拷贝的读段随机分配到两个组装的重叠群上，那么测序数据的总量（$2LC$）将被分配给它们。平均而言，每个重叠群将接收总数据的一半：$\\frac{2LC}{2} = LC$。\n-   一个长度为 $L$ 的重叠群的预期覆盖度将是 $\\frac{LC}{L} = C$。\n-   即使接受其前提，该陈述关于覆盖度为 $C/2$ 的结论在计算上也是不正确的。此外，随机分配的前提与拷贝被“解析”的概念相矛盾，后者意味着它们可以被比对器区分，从而导致唯一的而非随机的比对。在唯一比对的情况下，覆盖度也应为 $C$。\n-   该陈述是 **错误的**。\n\n**D. 一个基于覆盖度的拷贝数估计器，设置 $\\hat{k} = \\mathrm{round}(\\bar{c}/C)$，其中 $\\bar{c}$ 是在基于独特区域进行GC校正后，家族内一个足够长窗口中的平均单碱基覆盖度。该估计器在泊松模型下是最大似然估计（MLE），并且在均匀采样和所述比对策略下，对于真实拷贝数 $k$ 是无偏的；折叠区域将因此产生 $\\hat{k}  1$。**\n-   让我们检查这个陈述中关于一个代表 $k$ 个真实拷贝的折叠区域的各个组成部分。\n    1.  **MLE：** 观察到的平均覆盖度是 $\\bar{c}$。在泊松模型下，均值参数的MLE是 $\\bar{c}$。模型均值为 $\\lambda = kC$。我们想找到最大化观察到 $\\bar{c}$ 的可能性的整数 $k$。这可以通过选择使 $kC$ 最接近 $\\bar{c}$ 的整数 $k$ 来实现，这等同于找到最接近 $\\bar{c}/C$ 的整数 $k$。这正是 $\\hat{k} = \\mathrm{round}(\\bar{c}/C)$ 所计算的。因此，这是整数拷贝数 $k$ 的MLE。\n    2.  **无偏性：** 对于连续拷贝数的估计量 $\\bar{c}/C$ 是无偏的，因为 $E[\\bar{c}/C] = E[\\bar{c}]/C = (kC)/C = k$。对于一个足够长的窗口，中心极限定理意味着 $\\bar{c}$ 的分布近似为正态分布，因此是对称的。对一个对称分布的变量进行四舍五入得到的估计量也是（渐近）无偏的。\n    3.  **折叠区域的结果：** 一个折叠区域，根据定义，代表了 $k  1$ 个拷贝。其预期覆盖度是 $\\bar{c} = kC$，所以估计的拷贝数是 $\\hat{k} = \\mathrm{round}(kC/C) = k  1$。\n-   该陈述准确地描述了在此背景下基于覆盖度的拷贝数估计的统计基础和实际应用。\n-   该陈述是 **正确的**。\n\n**E. 为了避免假阳性，在与全基因组基线比较之前，必须将折叠区域的预期覆盖度除以其重叠群长度，因为单碱基覆盖度随重叠群长度而变化，即使拷贝数不变，较长的折叠重叠群也会夸大表观深度。**\n-   这个陈述从根本上误解了单碱基覆盖度的概念。单碱基覆盖度 $\\bar{c}$ 是一个强度量（intensive quantity），意味着它是一个平均值，不会随区域的大小（长度）而变化。它被计算为 $\\bar{c} = (\\sum_{\\text{碱基}} \\text{深度}) / \\text{长度}$。随重叠群长度变化的量是比对上的读段总数，而不是单碱基覆盖度。\n-   将单碱基覆盖度 $\\bar{c}$ 除以重叠群长度 $L$ 在此上下文中是一个无意义的操作。人们应该将单碱基覆盖度 $\\bar{c}$ 直接与基线单碱基覆盖度 $C$ 进行比较。\n-   “单碱基覆盖度随重叠群长度而变化”的前提是错误的。\n-   该陈述是 **错误的**。\n\n### 最终结论\n\n正确的陈述是A、B和D。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "一个基因组组装的最终价值体现在其对下游生物学分析的支持能力上，例如精确检测结构变异 (structural variants, SVs)。这项练习模拟了验证组装体性能的关键步骤：将其与一个公认的“金标准”基准进行比较。通过计算灵敏度、特异性和精确度等核心指标，您不仅将学会如何量化评估组装质量，还将理解特定的组装缺陷（如嵌合体）如何直接影响这些对临床诊断至关重要的性能指标。",
            "id": "4356396",
            "problem": "一个临床全基因组通过长读长测序进行了从头组装，并与人类参考基因组 GRCh38 进行了比对，其结构性变异根据 Genome in a Bottle (GIAB) 结构性变异基准集进行了评估。评估仅限于 GIAB 的高置信度区间和一个包含 $K = 20{,}000$ 个不同位点的候选基因座精选目录，目录中每个位点在基准中被标记为结构性变异阳性或结构性变异阴性。其中，$P = 2{,}400$ 个位点被标记为阳性，$N = 17{,}600$ 个位点被标记为阴性。组装到参考基因组的比对产生了一个结构性变异的检出集，该检出集通过在每个事件的两个断裂点处使用 $\\pm 50$ 个碱基对的断点容忍度与 GIAB 目录进行匹配。高置信度区间之外的检出被排除在评估之外。\n\n在高置信度目录内，对同一基因座上的重叠检出进行去重后，观察到以下结果：\n- $2{,}268$ 个阳性位点在断点容忍度窗口内有一个匹配的检出事件，被计为真阳性。\n- $132$ 个阳性位点在容忍度内没有匹配的检出，被计为假阴性。\n- $144$ 个阴性位点在容忍度内被错误地检出为结构性变异，被计为假阳性。\n- 所有剩余的阴性位点被计为真阴性。\n\n独立的组装质量评估表明，嵌合重叠群连接影响了重复区域，导致了 $90$ 个假阳性；而局部错误组装使断点移出了匹配容忍度范围，导致了 $80$ 个假阴性。\n\n使用应用于此项基于基因座的评估的灵敏度、特异度和精确度的标准混淆矩阵定义，计算这三个指标。然后，计算灵敏度和精确度的调和平均数（即 $F_1$ 分数）。简要解释在组装到参考基因组的比对和断点匹配方面，重叠群错误组装如何使这项基于基因座的评估中获得的三个指标产生偏差。\n\n最终答案以 $F_1$ 分数表示，四舍五入到四位有效数字，报告为一个无量纲小数。最终答案中不需要其他四舍五入的值。",
            "solution": "首先验证问题陈述的科学合理性、完整性和客观性。\n\n### 步骤1：提取给定信息\n- 候选基因座总数，$K = 20{,}000$。\n- 阳性基因座总数（基准真相结构性变异），$P = 2{,}400$。\n- 阴性基因座总数（基准真相阴性），$N = 17{,}600$。\n- 断点匹配容忍度：在两个断裂点处均为 $\\pm 50$ 个碱基对。\n- 真阳性（TP）：有匹配检出的阳性位点数 = $2{,}268$。\n- 假阴性（FN）：无匹配检出的阳性位点数 = $132$。\n- 假阳性（FP）：被错误检出为结构性变异的阴性位点数 = $144$。\n- 真阴性（TN）：所有剩余的阴性位点。\n- 嵌合重叠群连接对假阳性的贡献：$90$ 例。\n- 局部错误组装对假阴性的贡献：$80$ 例。\n\n### 步骤2：使用提取的给定信息进行验证\n该问题在计算基因组学和生物信息学这一成熟领域有科学依据，使用了标准术语（长读长测序、从头组装、结构性变异、GIAB基准、混淆矩阵）。所提供的数据是自洽且完整的。真阳性和假阴性之和，$\\text{TP} + \\text{FN} = 2{,}268 + 132 = 2{,}400$，正确地等于阳性基因座总数 $P$。阴性基因座总数给出为 $N = 17{,}600$。真阴性数可以推导为 $\\text{TN} = N - \\text{FP} = 17{,}600 - 144 = 17{,}456$，这是明确定义的。基因座总数 $K = P + N = 2{,}400 + 17{,}600 = 20{,}000$ 也是一致的。问题提出得当、客观，且不含科学或事实上的不合理之处。所描述的场景对于临床基因组学验证研究是符合实际的。\n\n### 步骤3：结论与行动\n问题被认为是有效的。将提供解决方案。\n\n### 解决方案推导\n\n该问题要求根据所提供的数据定义的混淆矩阵计算三个标准性能指标（灵敏度、特异度、精确度）和一个派生指标（$F_1$ 分数）。它还要求解释特定的组装错误如何使这些指标产生偏差。\n\n首先，我们根据给定的信息将混淆矩阵的各组成部分形式化：\n- 真阳性（$\\text{TP}$）：正确识别出的阳性基因座数量。\n  $$ \\text{TP} = 2{,}268 $$\n- 假阴性（$\\text{FN}$）：组装器/检出器漏掉的阳性基因座数量。\n  $$ \\text{FN} = 132 $$\n- 假阳性（$\\text{FP}$）：被错误识别为阳性的阴性基因座数量。\n  $$ \\text{FP} = 144 $$\n- 真阴性（$\\text{TN}$）：正确识别出的阴性基因座数量。这是根据总阴性数 $N$ 和假阳性数 $\\text{FP}$ 计算得出的。\n  $$ \\text{TN} = N - \\text{FP} = 17{,}600 - 144 = 17{,}456 $$\n\n有了这些值，我们就可以计算所需的指标。\n\n**1. 灵敏度（召回率或真阳性率）**\n灵敏度衡量被正确识别的实际阳性样本的比例。\n$$ \\text{Sensitivity} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}} = \\frac{2{,}268}{2{,}268 + 132} = \\frac{2{,}268}{2{,}400} = 0.945 $$\n\n**2. 特异度（真阴性率）**\n特异度衡量被正确识别的实际阴性样本的比例。\n$$ \\text{Specificity} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}} = \\frac{17{,}456}{17{,}456 + 144} = \\frac{17{,}456}{17{,}600} \\approx 0.9918 $$\n\n**3. 精确度（阳性预测值）**\n精确度衡量阳性识别中实际正确的比例。\n$$ \\text{Precision} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}} = \\frac{2{,}268}{2{,}268 + 144} = \\frac{2{,}268}{2{,}412} \\approx 0.93997 $$\n\n**4. $F_1$ 分数**\n$F_1$ 分数是精确度和灵敏度的调和平均数，提供了一个平衡两者的单一指标。\n通用公式为：\n$$ F_1 = 2 \\times \\frac{\\text{Precision} \\times \\text{Sensitivity}}{\\text{Precision} + \\text{Sensitivity}} $$\n使用混淆矩阵各组成部分的更直接公式为：\n$$ F_1 = \\frac{2 \\times \\text{TP}}{2 \\times \\text{TP} + \\text{FP} + \\text{FN}} $$\n使用给定值代入此公式：\n$$ F_1 = \\frac{2 \\times 2{,}268}{2 \\times 2{,}268 + 144 + 132} = \\frac{4{,}536}{4{,}536 + 276} = \\frac{4{,}536}{4{,}812} $$\n计算小数值：\n$$ F_1 \\approx 0.9426433915... $$\n按题目要求四舍五入到四位有效数字，得到 $0.9426$。\n\n**5. 关于重叠群错误组装导致偏差的解释**\n\n问题要求解释重叠群错误组装如何使三个主要指标（灵敏度、特异度、精确度）产生偏差。所提供的信息将 $90$ 个假阳性归因于嵌合重叠群，将 $80$ 个假阴性归因于局部错误组装。\n\n- **由嵌合重叠群连接引起的偏差（假阳性）：**\n嵌合重叠群是组装过程中的人造产物，其中基因组中不连续的片段被错误地连接在一起。当这样的重叠群与参考基因组比对时，这种人为的连接可能被比对算法误解为实际基因组中不存在的结构性变异（例如，大规模的易位、倒位或缺失）。这会导致在实际上是阴性的基因座上产生假阳性检出。假阳性（$\\text{FP}$）数量的增加直接影响两个指标：\n1.  **特异度：** $\\text{Specificity} = \\frac{\\text{TN}}{\\text{TN} + \\text{FP}}$。增加的 $\\text{FP}$ 数量会减少分子（因为 $\\text{TN} = N - \\text{FP}$）并增加分母，从而**对特异度产生负向偏差（降低特异度）**。组装体正确识别真阴性位点的能力下降。\n2.  **精确度：** $\\text{Precision} = \\frac{\\text{TP}}{\\text{TP} + \\text{FP}}$。增加的 $\\text{FP}$ 数量会增加分母，从而**对精确度产生负向偏差（降低精确度）**。“阳性”检出中有更高比例是错误的。\n灵敏度不受此类错误的直接影响。\n\n- **由局部错误组装引起的偏差（假阴性）：**\n局部错误组装涉及组装好的重叠群序列中的小规模错误，通常发生在复杂或重复区域。当一个真实的结构性变异存在时，其精确的断点在参考基因组中是确定的。覆盖该变异的重叠群中的局部错误组装可能会改变一个或两个断点周围的序列。这可能导致比对报告的变异断点位置落在指定的匹配容忍度窗口（此处为 $\\pm 50$ bp）之外。因此，从组装体中检出的变异无法与基准目录中的基准真相变异匹配，导致未能检测到真实变异。这被计为假阴性（$\\text{FN}$）。假阴性（$\\text{FN}$）数量的增加直接影响一个指标：\n1.  **灵敏度：** $\\text{Sensitivity} = \\frac{\\text{TP}}{\\text{TP} + \\text{FN}}$。增加的 $\\text{FN}$ 数量会增加分母，从而**对灵敏度产生负向偏差（降低灵敏度）**。基于组装的检出方法检测存在的真实变异的能力下降。\n特异度和精确度不受此类错误的直接影响。\n\n总之，重叠群错误组装会引入系统性偏差，从而降低性能评估的准确性。嵌合体人为地增加了结构性变异的数量，降低了特异度和精确度，而局部错误组装则掩盖了真实变异的信号，降低了灵敏度。",
            "answer": "$$\n\\boxed{0.9426}\n$$"
        }
    ]
}