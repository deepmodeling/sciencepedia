{
    "hands_on_practices": [
        {
            "introduction": "基于读深度的结构变异检测，其核心在于识别基因组特定区域读数覆盖的显著变化。为了将“显著”这一概念量化，我们通常采用统计模型来评估观测到的读数偏差是否仅由随机抽样噪声引起。本练习将指导您从第一性原理出发，基于泊松分布和中心极限定理，为一个假设的拷贝数缺失区域计算其标准化得分（Z-score），这是许多拷贝数变异（CNV）检测算法中的关键第一步。",
            "id": "4332052",
            "problem": "一个基于读取深度的结构变异检测器，使用根植于泊松抽样模型的正态近似来标准化窗口内的计数。假设一个全基因组测序实验，其全基因组具有均一的可比对性（mappability）且碱基对之间的覆盖度相互独立，其中每个碱基的覆盖度被建模为均值为 $\\lambda$、方差为 $\\lambda$ 的泊松随机变量。设全基因组的平均覆盖度为 $30\\times$，即 $\\lambda = 30$。考虑一个长度为 $100\\,\\text{kb}$ 的窗口（其中 $1\\,\\text{kb} = 10^{3}$ 个碱基对），并假设此窗口中观测到的平均覆盖度相对于全基因组平均值减少了 $0.15$，从而窗口内的观测平均覆盖度为 $0.85 \\times 30$。\n\n从泊松分布的基本性质（均值和方差相等）以及独立泊松变量在碱基对间的可加性出发，推导在该窗口的覆盖度遵循全基因组平均值的零假设下，此窗口内总覆盖度的标准化正态分数（z-score）。当窗口长度较大时，使用中心极限定理来证明对独立泊松变量之和进行正态近似的合理性。\n\n将最终的z-score表示为一个四舍五入到四位有效数字的实数。无需单位。",
            "solution": "问题陈述经评估后被认为是有效的。它在科学上基于标准的基因组数据生物统计模型，问题设定良好，并为得出唯一解提供了所有必要信息。\n\n目标是计算在指定基因组窗口中观测到的总读取覆盖度的标准化正态分数（z-score）。z-score是衡量一个观测值偏离一个分布均值的标准差倍数。其定义为：\n$$Z = \\frac{X - \\mu}{\\sigma}$$\n其中 $X$ 是观测值，$\\mu$ 是零假设下的期望值（均值），$\\sigma$ 是零假设下的标准差。\n\n首先，我们必须定义我们感兴趣的随机变量及其在零假设 $H_0$ 下的分布。零假设指出，所讨论的基因组窗口的覆盖度特征与全基因组的平均水平相同。\n\n设 $C_i$ 为表示覆盖碱基对 $i$ 的读取数量的随机变量。根据问题陈述，$C_i$ 服从泊松分布，其均值和方差等于全基因组的平均覆盖度 $\\lambda$。\n$$C_i \\sim \\text{Poisson}(\\lambda)$$\n给定条件指出 $\\lambda = 30$。因此，对于每个碱基对 $i$：\n$$E[C_i] = \\lambda = 30$$\n$$\\text{Var}(C_i) = \\lambda = 30$$\n\n问题考虑一个长度为 $L = 100\\,\\text{kb}$ 的窗口。我们将此长度转换为碱基对（bp）：\n$$L = 100\\,\\text{kb} \\times \\frac{10^3\\,\\text{bp}}{1\\,\\text{kb}} = 100 \\times 10^3\\,\\text{bp} = 10^5\\,\\text{bp}$$\n\n窗口内的总覆盖度（我们记为 $T$）是该窗口内每个碱基对处覆盖度的总和。根据问题陈述，假设每个碱基对的覆盖度是独立的：\n$$T = \\sum_{i=1}^{L} C_i$$\n\n泊松分布的一个基本性质是，独立泊松随机变量之和仍然是一个泊松随机变量，其均值等于各个均值之和。在零假设下，所有 $C_i$ 都是参数为 $\\lambda$ 的独立同分布（i.i.d.）随机变量。因此，总覆盖度 $T$ 服从参数为 $L\\lambda$ 的泊松分布。\n$$T \\sim \\text{Poisson}(L\\lambda)$$\n\n在零假设下，总覆盖度 $T$ 的均值 ($\\mu_T$) 和方差 ($\\sigma_T^2$) 分别为：\n$$\\mu_T = E[T] = L\\lambda$$\n$$\\sigma_T^2 = \\text{Var}(T) = L\\lambda$$\n标准差 ($\\sigma_T$) 是方差的平方根：\n$$\\sigma_T = \\sqrt{L\\lambda}$$\n\n现在我们可以代入给定的值：\n$$\\mu_T = (10^5) \\times (30) = 3 \\times 10^6$$\n$$\\sigma_T = \\sqrt{(10^5) \\times (30)} = \\sqrt{3 \\times 10^6} = \\sqrt{3} \\times 10^3$$\n\n问题陈述我们应使用中心极限定理（CLT）来证明正态近似的合理性。对于足够大的泊松参数 $L\\lambda$，泊松分布 $\\text{Poisson}(L\\lambda)$ 可以被一个具有相同均值和方差的正态分布 $\\mathcal{N}(L\\lambda, L\\lambda)$ 精确地近似。在我们的例子中，$L\\lambda = 3 \\times 10^6$，这是一个非常大的数，使得正态近似异常准确。\n\n接下来，我们必须确定窗口内的观测总覆盖度，我们记为 $T_{\\text{obs}}$。问题陈述中提到，窗口内观测到的*平均*覆盖度是全基因组平均覆盖度 $30$ 的 $0.85$ 倍。\n$$\\text{Observed mean coverage} = 0.85 \\times 30 = 25.5$$\n观测到的总覆盖度是这个平均覆盖度乘以窗口长度 $L$：\n$$T_{\\text{obs}} = (\\text{Observed mean coverage}) \\times L = 25.5 \\times 10^5 = 2.55 \\times 10^6$$\n\n最后，我们计算总覆盖度的z-score。我们使用 $Z$ 的公式，并代入我们计算出的观测总覆盖度 ($T_{\\text{obs}}$)、$H_0$ 下的期望总覆盖度 ($\\mu_T$) 以及 $H_0$ 下的总覆盖度标准差 ($\\sigma_T$)：\n$$Z = \\frac{T_{\\text{obs}} - \\mu_T}{\\sigma_T}$$\n$$Z = \\frac{2.55 \\times 10^6 - 3 \\times 10^6}{\\sqrt{3} \\times 10^3}$$\n$$Z = \\frac{-0.45 \\times 10^6}{\\sqrt{3} \\times 10^3}$$\n$$Z = \\frac{-4.5 \\times 10^5}{\\sqrt{3} \\times 10^3}$$\n$$Z = \\frac{-450}{\\sqrt{3}}$$\n\n为了获得数值，我们可以将分母有理化或直接计算该值：\n$$Z = \\frac{-450}{\\sqrt{3}} = \\frac{-450\\sqrt{3}}{3} = -150\\sqrt{3}$$\n使用近似值 $\\sqrt{3} \\approx 1.7320508$：\n$$Z \\approx -150 \\times 1.7320508 \\approx -259.80762$$\n问题要求答案四舍五入到四位有效数字。\n$$Z \\approx -259.8$$\n这个z-score表明，窗口中观测到的总覆盖度比零假设下的期望覆盖度低了大约 $259.8$ 个标准差，这是一个极其显著的偏差。",
            "answer": "$$\\boxed{-259.8}$$"
        },
        {
            "introduction": "在癌症基因组学中，测序信号源自肿瘤细胞和正常细胞的混合体，这使得结构变异的解析变得复杂。为了准确推断拷贝数状态，算法必须整合多种信号，如读深度和B等位基因频率（BAF），并对肿瘤纯度和亚克隆结构等因素进行建模。本练习将挑战您在一个包含肿瘤异质性的现实场景中，推导预期的读深度比率和BAF，从而加深对这些集成信号如何反映底层复杂生物学状态的理解。",
            "id": "4332078",
            "problem": "一种基于测序的结构变异检测工具整合了读取深度和B等位基因频率来推断异质性肿瘤样本中的拷贝数状态。考虑一个肿瘤-正常组织混合样本，其肿瘤纯度 $p=0.6$（即肿瘤细胞比例为 $0.6$，正常细胞比例为 $0.4$），其中正常细胞是二倍体，肿瘤的基线倍性为 $3$。在一个包含胚系杂合单核苷酸多态性（SNP）且等位基因为 $A$ 和 $B$ 的位点上，假设存在以下生物学情况：该位点上的克隆性基线肿瘤基因型为 $AAB$（即总拷贝数为 $3$，其中一个为 $B$ 拷贝），一个影响 $40\\%$ 肿瘤细胞的单拷贝增益亚克隆在该位点上复制了 $A$ 等位基因，在该亚克隆中产生了 $AAAB$ 基因型（即总拷贝数为 $4$，其中一个为 $B$ 拷贝）。剩余的 $60\\%$ 肿瘤细胞保持 $AAB$ 状态。正常细胞在该位点为 $AB$ 型（即总拷贝数为 $2$，其中一个为 $B$ 拷贝）。假设没有等位基因映射偏倚，每个拷贝的测序产量均一，并且预期读取深度与总拷贝数成正比。\n\n仅使用以下基本定义：(i) 一个位点上的预期读取深度与所有细胞贡献的预期总拷贝数成正比，以及 (ii) 在每个拷贝产量均一的情况下，B等位基因频率（BAF）是来自 $B$ 等位基因的预期读取数与该位点上预期总读取数的比率，推导该位点上的预期读取深度比 $R$（定义为肿瘤预期读取深度除以匹配的正常样本预期读取深度）和该肿瘤-正常组织混合样本中该位点的预期B等位基因频率。将您的最终数值答案四舍五入至四位有效数字。最终答案中不包含单位。",
            "solution": "我们从定义和混合物组成开始。设 $p$ 为肿瘤比例，则正常组织比例为 $1-p$。该位点上肿瘤的基线倍性为 $3$，基因型为 $AAB$（一个 $B$ 拷贝），一个占肿瘤细胞 $0.4$ 比例的亚克隆获得一个额外的 $A$ 拷贝，导致基因型变为 $AAAB$（仍然是一个 $B$ 拷贝，但总拷贝数为 $4$）。剩余 $0.6$ 的肿瘤细胞保持 $AAB$ 状态。正常细胞是二倍体，基因型为 $AB$（一个 $B$ 拷贝）。\n\n根据每个拷贝测序产量均一的假设，一个位点的预期读取深度与预期总拷贝数成正比，来自等位基因 $B$ 的预期读取数与 $B$ 拷贝的预期数量成正比。\n\n定义样本中每个细胞区室的绝对比例：\n- 正常细胞：比例 $f_{N} = 1-p$。\n- 无增益的肿瘤细胞：比例 $f_{T,3} = p \\times 0.6$。\n- 有增益的肿瘤细胞：比例 $f_{T,4} = p \\times 0.4$。\n\n当 $p=0.6$ 时，这些比例为\n$$\nf_{N} = 0.4,\\quad f_{T,3} = 0.6 \\times 0.6 = 0.36,\\quad f_{T,4} = 0.6 \\times 0.4 = 0.24.\n$$\n\n设 $C_{i}$ 表示区室 $i$ 的总拷贝数，$B_{i}$ 表示 $B$ 等位基因的拷贝数。根据问题设定，\n- 正常细胞：$C_{N} = 2$, $B_{N} = 1$。\n- 无增益的肿瘤细胞 ($AAB$)：$C_{T,3} = 3$, $B_{T,3} = 1$。\n- 有增益的肿瘤细胞 ($AAAB$)：$C_{T,4} = 4$, $B_{T,4} = 1$。\n\n1) 预期读取深度比 $R$。\n\n混合样本中每个细胞的预期总拷贝数是加权平均值\n$$\n\\overline{C} \\equiv f_{N} C_{N} + f_{T,3} C_{T,3} + f_{T,4} C_{T,4}.\n$$\n代入数值，\n$$\n\\overline{C} = 0.4 \\times 2 + 0.36 \\times 3 + 0.24 \\times 4 = 0.8 + 1.08 + 0.96 = 2.84.\n$$\n在此位点上的一个匹配的正常样本的预期总拷贝数为 $2$。在每个拷贝产量相等且经过适当的全局归一化后，预期的读取深度比是预期拷贝数的比率，\n$$\nR = \\frac{\\overline{C}}{2} = \\frac{2.84}{2} = 1.42.\n$$\n\n2) 预期B等位基因频率。\n\n根据定义，B等位基因频率是来自 $B$ 的预期读取数与预期总读取数的比率。在每个拷贝产量均一的情况下，这等于混合物中 $B$ 拷贝的预期数量与预期总拷贝数的比率：\n$$\n\\text{BAF} = \\frac{\\overline{B}}{\\overline{C}},\n$$\n其中\n$$\n\\overline{B} \\equiv f_{N} B_{N} + f_{T,3} B_{T,3} + f_{T,4} B_{T,4}.\n$$\n代入数值，\n$$\n\\overline{B} = 0.4 \\times 1 + 0.36 \\times 1 + 0.24 \\times 1 = 0.4 + 0.36 + 0.24 = 1.0.\n$$\n因此，\n$$\n\\text{BAF} = \\frac{1.0}{2.84} \\approx 0.3521126761\\ldots\n$$\n四舍五入至四位有效数字，\n$$\nR = 1.420,\\quad \\text{BAF} = 0.3521.\n$$\n这些是按要求得出的无量纲量。",
            "answer": "$$\\boxed{\\begin{pmatrix}1.420  0.3521\\end{pmatrix}}$$"
        },
        {
            "introduction": "开发出一种结构变异检测算法后，下一个关键步骤是客观地评估其性能。通过将算法的预测结果与一个“金标准”真实数据集进行比较，我们可以量化其准确性。本练习将引导您运用评估算法性能的基本概念——精确率（precision）、召回率（recall）和F1分数（F1 score），这些是生物信息学中用于衡量和比较工具性能的通用语言。",
            "id": "4332017",
            "problem": "一个临床全基因组测序流程评估一个结构变异（SV）检测工具在肿瘤-正常样本对上的表现，以支持精准医疗决策。一个 SV 事件由两个基因组断点和一个类型标签（例如，缺失、重复、倒位）来表征。该评估协议定义一个预测的 SV 是对一个真实 SV 的正确检测，当且仅当：(i) SV 类型匹配，(ii) 两个预测的断点都在相应真实断点的 $\\delta$ 个碱基对的容差范围内，以及 (iii) 断点方向一致。为避免对预测或真实事件进行重复计数，通过对满足容差和类型约束的预测-真实对进行最大二分匹配，强制匹配为一对一。\n\n对于固定的断点容差 $\\delta = 75$ 个碱基对，金标准真实集包含 $N_{\\text{true}} = 400$ 个 SV，而检测工具输出 $N_{\\text{pred}} = 380$ 个 SV。根据上述协议执行一对一匹配后，匹配对的数量为 $TP = 312$（真阳性）。在此评估定义下，所有未匹配的预测被视为假阳性，所有未匹配的真实事件被视为假阴性。\n\n仅使用混淆计数和基于集合的评估的基本定义，推导精确率、召回率和 $F1$ 分数关于 $TP$、$FP$ 和 $FN$ 的表达式，并根据给定的计数计算它们的值。将每个指标表示为区间 $[0,1]$ 内的小数，并将最终报告的值四舍五入到四位有效数字。以行向量的形式呈现你的最终答案，顺序为：精确率、召回率、$F1$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于生物信息学和基因组学中评估算法性能的标准实践。该问题设定良好、客观，并为求解提供了完整一致的数据集。不存在逻辑矛盾、科学不准确或定义不清的术语。因此，我们可以进行正式求解。\n\n该问题要求基于一组评估计数，为一个结构变异（SV）检测工具计算三个标准性能指标——精确率、召回率和 $F1$ 分数。提供的基本量是：\n- 金标准集中真实 SV 的总数：$N_{\\text{true}} = 400$。\n- 检测工具预测的 SV 总数：$N_{\\text{pred}} = 380$。\n- 通过一对一匹配协议确定的真阳性（$TP$）检测数：$TP = 312$。\n\n问题将假阳性（$FP$）定义为未匹配的预测，将假阴性（$FN$）定义为未匹配的真实事件。这些定义在基于集合的评估协议中是标准的。\n\n首先，我们使用提供的数据推导假阳性（$FP$）和假阴性（$FN$）数量的表达式。\n\n所有预测的集合，其大小为 $N_{\\text{pred}}$，被划分为两个不相交的子集：与真实 SV 正确匹配的（真阳性）和不匹配的（假阳性）。因此，预测总数是真阳性和假阳性的和：\n$$N_{\\text{pred}} = TP + FP$$\n根据这个基本关系，我们可以用给定的量来表示假阳性的数量：\n$$FP = N_{\\text{pred}} - TP$$\n代入给定值：\n$$FP = 380 - 312 = 68$$\n\n同样，所有真实 SV 的集合，其大小为 $N_{\\text{true}}$，被划分为两个不相交的子集：被检测工具正确检测到的（真阳性）和被遗漏的（假阴性）。这给出了以下关系：\n$$N_{\\text{true}} = TP + FN$$\n由此，我们用给定的量来表示假阴性的数量：\n$$FN = N_{\\text{true}} - TP$$\n代入给定值：\n$$FN = 400 - 312 = 88$$\n\n现在我们定义并计算所需的指标。\n\n**1. 精确率（阳性预测值）**\n精确率衡量检测工具所做出的阳性预测的准确性。它是预测的 SV 中实际为真实 SV 的比例。精确率的表达式为：\n$$\\text{Precision} = \\frac{TP}{TP + FP}$$\n请注意，分母 $TP + FP$ 是预测的总数 $N_{\\text{pred}}$。\n$$\\text{Precision} = \\frac{TP}{N_{\\text{pred}}} = \\frac{312}{380}$$\n计算小数值：\n$$\\text{Precision} = 0.8210526...$$\n四舍五入到四位有效数字，我们得到 $0.8211$。\n\n**2. 召回率（灵敏度或真阳性率）**\n召回率衡量检测工具找到所有真实 SV 的能力。它是所有真实 SV 中被正确检测到的比例。召回率的表达式为：\n$$\\text{Recall} = \\frac{TP}{TP + FN}$$\n请注意，分母 $TP + FN$ 是真实事件的总数 $N_{\\text{true}}$。\n$$\\text{Recall} = \\frac{TP}{N_{\\text{true}}} = \\frac{312}{400}$$\n计算小数值：\n$$\\text{Recall} = 0.78$$\n为了用四位有效数字表示，我们写作 $0.7800$。\n\n**3. $F1$ 分数**\n$F1$ 分数是精确率和召回率的调和平均数。它提供了一个平衡这两个指标的单一分数。通用公式为：\n$$F1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}}$$\n可以推导出以混淆矩阵计数（$TP$、$FP$、$FN$）表示的更直接的表达式：\n$$F1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}$$\n这种形式通常更受欢迎，因为它避免了使用精确率和召回率的中间四舍五入值。代入 $TP$、$FP$ 和 $FN$ 的值：\n$$F1 = \\frac{2 \\cdot 312}{2 \\cdot 312 + 68 + 88} = \\frac{624}{624 + 156} = \\frac{624}{780}$$\n计算小数值：\n$$F1 = 0.8$$\n为了用四位有效数字表示，我们写作 $0.8000$。\n\n计算出的值，四舍五入到四位有效数字，是：\n- 精确率：$0.8211$\n- 召回率：$0.7800$\n- $F1$ 分数：$0.8000$\n\n这些值将按指定顺序以行向量的形式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8211  0.7800  0.8000 \\end{pmatrix}}$$"
        }
    ]
}