{
    "hands_on_practices": [
        {
            "introduction": "双端测序（Paired-end sequencing）是结构变异（SV）检测的基石。然而，一个“异常”的插入片段大小（insert size）这一模糊概念，如何转化为一个可用于算法的精确标准呢？本练习将演示如何从统计学第一性原理出发，通过控制假阳性率（False Positive Rate），为“异常”读对（discordant read pair）建立一个定量的、统计上严谨的定义。掌握这一过程对于构建可靠的、基于双端测序证据的SV检测算法至关重要。",
            "id": "4332030",
            "problem": "在用于精准医疗和基因组诊断学中结构变异检测的双末端测序中，如果一个读段对的观测插入片段大小与文库插入片段大小分布一致，则称其为一致读段对，否则称为不一致读段对。考虑一个文库，其一致读段对的插入片段大小由均值为 $\\mu = 350$ 碱基对（bp）和标准差为 $\\sigma = 50$ bp 的高斯（正态）分布建模。假设比对过程为每个读段对产生一个插入片段大小 $S$，并且在确实为一致读段对的条件下，$S$ 的分布为 $S \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。\n\n使用假阳性率（FPR）的定义 $\\alpha = \\mathbb{P}(\\text{标记为不一致} \\mid \\text{确实为一致})$，从基本原理推导一个双边决策规则。该规则在将FPR控制在 $\\alpha = 0.01$ 的同时，如果 $S$ 落在关于 $\\mu$ 的对称接受域之外，就将该读段对标记为不一致。您的推导应从正态分布的性质和尾部概率的定义开始。\n\n然后，将您的通用决策规则应用于给定的参数 $\\mu = 350$ bp 和 $\\sigma = 50$ bp，以获得 $S$ 的明确数值下限和上限阈值。最终阈值以碱基对（bp）表示，并将数值结果四舍五入到四位有效数字。",
            "solution": "问题陈述具有科学依据、是良定的、客观的，并包含得出唯一解所需的所有信息。因此，该问题被视为有效。我们开始进行推导。\n\n问题要求建立一个双边决策规则，根据其插入片段大小 $S$ 将一个双末端读段分类为不一致。我们已知，对于一个确实为一致的读段对，其插入片段大小服从均值为 $\\mu = 350$ 碱基对（bp）和标准差为 $\\sigma = 50$ bp 的正态分布 $S \\sim \\mathcal{N}(\\mu, \\sigma^2)$。该决策规则必须将假阳性率（FPR）$\\alpha$ 控制在 $0.01$。\n\nFPR 被定义为当一个读段对实际上确实是一致的情况下，将其标记为不一致的概率。在统计学上，这对应于第一类错误。令 $H_0$ 为原假设，即读段对是确实一致的。\n$$H_0: \\text{读段对是一致的。}$$\n在 $H_0$ 成立的条件下，插入片段大小的分布为 $S \\sim \\mathcal{N}(\\mu, \\sigma^2)$。\n\n决策规则是，如果插入片段大小 $S$ 对于某个正值 $\\delta$ 落在对称接受域 $[\\mu - \\delta, \\mu + \\delta]$ 之外，则将该读段标记为不一致。这意味着如果 $S  \\mu - \\delta$ 或 $S > \\mu + \\delta$，我们将其标记为不一致。我们标记为不一致的值的集合是拒绝域，即 $\\mathcal{R} = (-\\infty, \\mu - \\delta) \\cup (\\mu + \\delta, \\infty)$。\n\nFPR $\\alpha$ 是在原假设下此事件发生的概率：\n$$\\alpha = \\mathbb{P}(S \\in \\mathcal{R} \\mid H_0) = \\mathbb{P}((S  \\mu - \\delta) \\lor (S > \\mu + \\delta))$$\n由于事件 $(S  \\mu - \\delta)$ 和 $(S > \\mu + \\delta)$ 是互斥的，它们的并集的概率是它们概率的和：\n$$\\alpha = \\mathbb{P}(S  \\mu - \\delta) + \\mathbb{P}(S > \\mu + \\delta)$$\n正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 关于其均值 $\\mu$ 是对称的。因此，观测到一个比均值小至少 $\\delta$ 的值的概率等于观测到一个比均值大至少 $\\delta$ 的值的概率：\n$$\\mathbb{P}(S  \\mu - \\delta) = \\mathbb{P}(S > \\mu + \\delta)$$\n将此代入 $\\alpha$ 的表达式中，得到：\n$$\\alpha = 2 \\cdot \\mathbb{P}(S > \\mu + \\delta)$$\n这意味着拒绝域的每个尾部必须包含 $\\alpha/2$ 的概率：\n$$\\mathbb{P}(S > \\mu + \\delta) = \\frac{\\alpha}{2}$$\n为了找到 $\\delta$ 的值，我们对随机变量 $S$ 进行标准化。令 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$，定义为：\n$$Z = \\frac{S - \\mu}{\\sigma}$$\n我们用 $Z$ 来变换不等式 $S > \\mu + \\delta$：\n$$S - \\mu > \\delta \\implies \\frac{S - \\mu}{\\sigma} > \\frac{\\delta}{\\sigma} \\implies Z > \\frac{\\delta}{\\sigma}$$\n所以，关于概率的条件变为：\n$$\\mathbb{P}\\left(Z > \\frac{\\delta}{\\sigma}\\right) = \\frac{\\alpha}{2}$$\n根据定义，标准正态分布的上$q$-分位数（记为 $z_q$）是满足 $\\mathbb{P}(Z > z_q) = q$ 的值。将此与我们的方程进行比较，我们得到：\n$$\\frac{\\delta}{\\sigma} = z_{\\alpha/2}$$\n解出 $\\delta$，我们得到：\n$$\\delta = \\sigma \\cdot z_{\\alpha/2}$$\n这个 $\\delta$ 的表达式定义了接受域。通用决策规则由下限阈值 $L = \\mu - \\delta$ 和上限阈值 $U = \\mu + \\delta$ 决定。代入 $\\delta$ 的表达式：\n$$L = \\mu - \\sigma \\cdot z_{\\alpha/2}$$\n$$U = \\mu + \\sigma \\cdot z_{\\alpha/2}$$\n如果一个读段对的观测插入片段大小 $S$ 小于 $L$ 或大于 $U$，则将其标记为不一致。这样就完成了从基本原理推导通用规则的过程。\n\n现在，我们将此规则应用于给定的参数：$\\mu = 350$ bp, $\\sigma = 50$ bp, 和 $\\alpha = 0.01$。\n我们需要找到分位数 $z_{\\alpha/2}$ 的值：\n$$z_{\\alpha/2} = z_{0.01/2} = z_{0.005}$$\n这是使标准正态分布的累积分布函数（CDF）$\\Phi(z)$ 等于 $1 - 0.005 = 0.995$ 的值。我们从标准统计表或计算中找到这个值：\n$$z_{0.005} \\approx 2.5758$$\n使用这个值，我们现在可以计算数值阈值 $L$ 和 $U$：\n$$L = 350 - 50 \\cdot z_{0.005} \\approx 350 - 50 \\cdot 2.5758 = 350 - 128.79 = 221.21 \\text{ bp}$$\n$$U = 350 + 50 \\cdot z_{0.005} \\approx 350 + 50 \\cdot 2.5758 = 350 + 128.79 = 478.79 \\text{ bp}$$\n问题要求最终数值结果四舍五入到四位有效数字。\n下限阈值 $221.21$ 四舍五入到四位有效数字是 $221.2$。\n上限阈值 $478.79$ 四舍五入到四位有效数字是 $478.8$。\n\n因此，决策规则是：如果一个读段对的插入片段大小小于 $221.2$ bp 或大于 $478.8$ bp，则将其标记为不一致。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n221.2  478.8\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "作为双端测序信号的补充，读深度（read-depth）分析能够揭示基因组片段的拷贝数增加（gain）或减少（loss）。本练习将引导你完成一个关键的计算过程：将原始的测序深度变化转化为一个标准化的统计得分（z-score）。这是任何基于读深度的拷贝数变异（CNV）检测算法中的重要第一步，你将应用泊松分布（Poisson distribution）和中心极限定理（Central Limit Theorem）的原理来处理一个真实的基因组学场景。",
            "id": "4332052",
            "problem": "一个基于读取深度的结构变异检测器，使用基于泊松抽样模型的正态近似来标准化窗口内的计数。假设一个全基因组测序实验具有均一的可比对性，且各碱基对的覆盖度相互独立，其中每个碱基的覆盖度被建模为一个均值和方差均为 $\\lambda$ 的泊松随机变量。设全基因组平均覆盖度为 $30\\times$，即 $\\lambda = 30$。考虑一个长度为 $100\\,\\text{kb}$ 的窗口，其中 $1\\,\\text{kb} = 10^{3}$ 碱基对。假设该窗口内观测到的平均覆盖度相对于全基因组平均值减少了 $0.15$，从而得到该窗口内的观测平均覆盖度为 $0.85 \\times 30$。\n\n从泊松分布的基本性质（均值与方差相等）以及独立泊松变量在碱基对上的可加性出发，推导在该窗口的覆盖度遵循全基因组平均水平的零假设下，此窗口内总覆盖度的标准化正态分数（z-score）。当窗口长度很大时，使用中心极限定理来证明独立泊松变量之和的正态近似是合理的。\n\n将最终的z-score表示为一个四舍五入到四位有效数字的实数。无需单位。",
            "solution": "问题陈述已经过评估并被认为是有效的。它在科学上基于基因组数据的标准生物统计模型，问题提法得当，并为得出唯一解提供了所有必要信息。\n\n目标是计算在指定基因组窗口中观测到的总读取覆盖度的标准化正态分数（z-score）。z-score是衡量一个观测值与分布均值相差多少个标准差的度量。其定义如下：\n$$Z = \\frac{X - \\mu}{\\sigma}$$\n其中 $X$ 是观测值，$\\mu$ 是零假设下的期望值（均值），$\\sigma$ 是零假设下的标准差。\n\n首先，我们必须定义我们感兴趣的随机变量及其在零假设 $H_0$ 下的分布。零假设指出，所讨论的基因组窗口具有与全基因组平均水平相同的覆盖度概况。\n\n设 $C_i$ 是表示覆盖碱基对 $i$ 的读取数的随机变量。根据问题陈述，$C_i$ 服从泊松分布，其均值和方差等于全基因组平均覆盖度 $\\lambda$。\n$$C_i \\sim \\text{Poisson}(\\lambda)$$\n已知条件表明 $\\lambda = 30$。因此，对于每个碱基对 $i$：\n$$E[C_i] = \\lambda = 30$$\n$$\\text{Var}(C_i) = \\lambda = 30$$\n\n问题考虑一个长度为 $L = 100\\,\\text{kb}$ 的窗口。我们将此长度转换为碱基对（bp）：\n$$L = 100\\,\\text{kb} \\times \\frac{10^3\\,\\text{bp}}{1\\,\\text{kb}} = 100 \\times 10^3\\,\\text{bp} = 10^5\\,\\text{bp}$$\n\n窗口内的总覆盖度（我们记为 $T$）是该窗口内每个碱基对覆盖度的总和。根据问题陈述，假设每个碱基对的覆盖度是独立的：\n$$T = \\sum_{i=1}^{L} C_i$$\n\n泊松分布的一个基本性质是，独立泊松随机变量之和仍然是泊松随机变量，其均值等于各独立变量均值之和。在零假设下，所有的 $C_i$ 都是参数为 $\\lambda$ 的独立同分布（i.i.d.）随机变量。因此，总覆盖度 $T$ 服从参数为 $L\\lambda$ 的泊松分布。\n$$T \\sim \\text{Poisson}(L\\lambda)$$\n\n在零假设下，总覆盖度 $T$ 的均值（$\\mu_T$）和方差（$\\sigma_T^2$）为：\n$$\\mu_T = E[T] = L\\lambda$$\n$$\\sigma_T^2 = \\text{Var}(T) = L\\lambda$$\n标准差（$\\sigma_T$）是方差的平方根：\n$$\\sigma_T = \\sqrt{L\\lambda}$$\n\n现在我们可以代入给定值：\n$$\\mu_T = (10^5) \\times (30) = 3 \\times 10^6$$\n$$\\sigma_T = \\sqrt{(10^5) \\times (30)} = \\sqrt{3 \\times 10^6} = \\sqrt{3} \\times 10^3$$\n\n问题陈述指出我们应该使用中心极限定理（CLT）来证明正态近似的合理性。对于足够大的泊松参数 $L\\lambda$，泊松分布 $\\text{Poisson}(L\\lambda)$ 可以被一个具有相同均值和方差的正态分布 $\\mathcal{N}(L\\lambda, L\\lambda)$ 精确近似。在我们的例子中，$L\\lambda = 3 \\times 10^6$，这是一个非常大的数，使得正态近似异常准确。\n\n接下来，我们必须确定窗口中观测到的总覆盖度，我们将其记为 $T_{\\text{obs}}$。问题陈述指出，窗口中观测到的*平均*覆盖度是全基因组平均值 $30$ 的 $0.85$ 倍。\n$$\\text{Observed mean coverage} = 0.85 \\times 30 = 25.5$$\n观测到的总覆盖度是这个平均覆盖度乘以窗口长度 $L$：\n$$T_{\\text{obs}} = (\\text{Observed mean coverage}) \\times L = 25.5 \\times 10^5 = 2.55 \\times 10^6$$\n\n最后，我们计算总覆盖度的z-score。我们使用 $Z$ 的公式，并代入我们计算出的观测总覆盖度（$T_{\\text{obs}}$）、$H_0$ 下的期望总覆盖度（$\\mu_T$）以及 $H_0$ 下的总覆盖度标准差（$\\sigma_T$）：\n$$Z = \\frac{T_{\\text{obs}} - \\mu_T}{\\sigma_T}$$\n$$Z = \\frac{2.55 \\times 10^6 - 3 \\times 10^6}{\\sqrt{3} \\times 10^3}$$\n$$Z = \\frac{-0.45 \\times 10^6}{\\sqrt{3} \\times 10^3}$$\n$$Z = \\frac{-4.5 \\times 10^5}{\\sqrt{3} \\times 10^3}$$\n$$Z = \\frac{-450}{\\sqrt{3}}$$\n\n为了获得数值，我们可以将分母有理化或直接计算该值：\n$$Z = \\frac{-450}{\\sqrt{3}} = \\frac{-450\\sqrt{3}}{3} = -150\\sqrt{3}$$\n使用近似值 $\\sqrt{3} \\approx 1.7320508$：\n$$Z \\approx -150 \\times 1.7320508 \\approx -259.80762$$\n问题要求答案四舍五入到四位有效数字。\n$$Z \\approx -259.8$$\n这个z-score表明，在零假设下，窗口中观测到的总覆盖度比期望覆盖度大约低了 $259.8$ 个标准差，这是一个极其显著的偏差。",
            "answer": "$$\\boxed{-259.8}$$"
        },
        {
            "introduction": "开发或选择一个合适的结构变异检测算法，需要一套可靠的方法来衡量其准确性。本练习将指导你如何基于一组给定的真阳性（true positives）、假阳性（false positives）和假阴性（false negatives）计数，计算出精确率（precision）、召回率（recall）和F1分数（F1 score）这些核心性能指标。在临床或科研环境中，掌握这些概念对于算法的基准测试和结果解释至关重要。",
            "id": "4332017",
            "problem": "一个临床全基因组测序流程评估了一个结构变异（SV）检测工具在肿瘤-正常样本对上的表现，以支持精准医疗决策。一个SV事件由两个基因组断点和一个类型标签（例如，缺失、重复、倒位）来表征。该评估协议定义一个预测的SV是对一个真实SV的正确检测，当且仅当：（i）SV类型匹配，（ii）两个预测的断点都在相应真实断点的$\\delta$个碱基对的容差范围内，以及（iii）断点方向一致。为避免对预测或真实事件进行重复计数，通过对满足容差和类型约束的预测-真实配对进行最大二分匹配，强制实现一一对应。\n\n对于固定的断点容差$\\delta = 75$个碱基对，金标准真实集包含 $N_{\\text{true}} = 400$ 个SV，而该检测工具输出了 $N_{\\text{pred}} = 380$ 个SV。在上述协议下执行一一匹配后，匹配对的数量为真阳性（$TP = 312$）。根据此评估定义，所有未匹配的预测被视为假阳性，所有未匹配的真实事件被视为假阴性。\n\n仅使用混淆计数和基于集合的评估的基本定义，推导精确率、召回率和 $F1$ 度量关于 $TP$、$FP$ 和 $FN$ 的表达式，并根据给定的计数计算它们的值。将每个度量表示为区间 $[0,1]$ 内的小数，并将最终报告的值四舍五入到四位有效数字。以行向量的形式呈现你的最终答案，顺序为：精确率、召回率、$F1$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于生物信息学和基因组学中评估算法性能的标准实践。该问题定义明确、客观，并为求解提供了完整且一致的数据集。不存在逻辑矛盾、科学不准确或定义不善的术语。因此，我们可以进行正式求解。\n\n该问题要求基于一组评估计数，为一个结构变异（SV）检测工具计算三个标准性能度量——精确率、召回率和 $F1$ 度量。提供的基本量为：\n- 金标准真实集中的真实SV总数：$N_{\\text{true}} = 400$。\n- 检测工具预测的SV总数：$N_{\\text{pred}} = 380$。\n- 通过一一匹配协议确定的真阳性（$TP$）检测数量：$TP = 312$。\n\n问题将假阳性（$FP$）定义为未匹配的预测，将假阴性（$FN$）定义为未匹配的真实事件。这些定义在基于集合的评估协议中是标准的。\n\n首先，我们使用所提供的数据推导假阳性（$FP$）和假阴性（$FN$）数量的表达式。\n\n所有预测的集合，其大小为 $N_{\\text{pred}}$，被划分为两个不相交的子集：与真实SV正确匹配的预测（真阳性）和不匹配的预测（假阳性）。因此，预测总数是真阳性和假阳性的总和：\n$$N_{\\text{pred}} = TP + FP$$\n根据这个基本关系，我们可以用给定的量来表示假阳性的数量：\n$$FP = N_{\\text{pred}} - TP$$\n代入给定值：\n$$FP = 380 - 312 = 68$$\n\n同样，所有真实SV的集合，其大小为 $N_{\\text{true}}$，被划分为两个不相交的子集：被检测工具正确检测到的（真阳性）和被漏掉的（假阴性）。这给出了以下关系：\n$$N_{\\text{true}} = TP + FN$$\n由此，我们用给定的量来表示假阴性的数量：\n$$FN = N_{\\text{true}} - TP$$\n代入给定值：\n$$FN = 400 - 312 = 88$$\n\n现在我们定义并计算所需的度量。\n\n**1. 精确率（阳性预测值）**\n精确率衡量检测工具所做出的阳性预测的准确性。它是预测的SV中实际为真实SV的比例。精确率的表达式为：\n$$\\text{Precision} = \\frac{TP}{TP + FP}$$\n注意分母 $TP + FP$ 是预测的总数 $N_{\\text{pred}}$。\n$$\\text{Precision} = \\frac{TP}{N_{\\text{pred}}} = \\frac{312}{380}$$\n计算小数值：\n$$\\text{Precision} = 0.8210526...$$\n四舍五入到四位有效数字，我们得到 $0.8211$。\n\n**2. 召回率（灵敏度或真阳性率）**\n召回率衡量检测工具找到所有真实SV的能力。它是所有真实SV中被正确检测到的比例。召回率的表达式为：\n$$\\text{Recall} = \\frac{TP}{TP + FN}$$\n注意分母 $TP + FN$ 是真实事件的总数 $N_{\\text{true}}$。\n$$\\text{Recall} = \\frac{TP}{N_{\\text{true}}} = \\frac{312}{400}$$\n计算小数值：\n$$\\text{Recall} = 0.78$$\n为了用四位有效数字表示，我们写作 $0.7800$。\n\n**3. $F1$ 度量**\n$F1$ 度量是精确率和召回率的调和平均数。它提供了一个平衡这两个度量的单一分数。通用公式是：\n$$F1 = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}}$$\n可以推导出用混淆矩阵计数（$TP$、$FP$、$FN$）表示的更直接的表达式：\n$$F1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}$$\n这种形式通常更受青睐，因为它避免了使用精确率和召回率的中间舍入值。代入 $TP$、$FP$ 和 $FN$ 的值：\n$$F1 = \\frac{2 \\cdot 312}{2 \\cdot 312 + 68 + 88} = \\frac{624}{624 + 156} = \\frac{624}{780}$$\n计算小数值：\n$$F1 = 0.8$$\n为了用四位有效数字表示，我们写作 $0.8000$。\n\n计算出的值，四舍五入到四位有效数字，为：\n- 精确率：$0.8211$\n- 召回率：$0.7800$\n- $F1$ 度量：$0.8000$\n\n这些值将按指定顺序以行向量的形式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8211  0.7800  0.8000 \\end{pmatrix}}$$"
        }
    ]
}