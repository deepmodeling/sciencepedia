{
    "hands_on_practices": [
        {
            "introduction": "成功的宏基因组学分析始于可靠的实验设计，其核心问题之一是确定所需的测序深度。为了能从复杂样本中可靠地检测或组装病原体的基因组，其基因组必须被足够数量的测序读数所覆盖。本练习  将引导您从第一性原理出发，推导期望基因组覆盖度的计算公式，将总读数数量、读长和病原体丰度等关键实验参数与这一关键质量指标直接联系起来。",
            "id": "4358557",
            "problem": "一次使用下一代测序 (NGS) 技术的临床全宏基因组鸟枪法 (WMS) 测序，从一个异质样本中产生了 $N$ 条独立的固定长度为 $L$ 个碱基对的读长。假设测序读长中有一部分（比例为 $f$）来源于单一病原体物种，其单倍体基因组长度为 $G$ 个碱基对。假设整个样本中的分子采样是无偏且均匀的，读长的来源在适当时能被正确地归属到病原体，并且相对于 $L \\ll G$ 而言，末端效应可以忽略不计。仅使用测序产量和基因组覆盖度的基本定义，推导该病原体的预期平均基因组覆盖度 $C$（无量纲的倍数值）关于 $N$、$L$、$f$ 和 $G$ 的闭式解析表达式。然后，计算当 $N = 5.0 \\times 10^{7}$ 条读长，$L = 150$ 个碱基对，$f = 10^{-3}$，以及 $G = 5$ 兆碱基（其中 1 兆碱基等于 $10^{6}$ 个碱基对）时 $C$ 的数值。将您的最终数值答案表示为无量纲的覆盖倍数，并四舍五入到四位有效数字。",
            "solution": "用户提供了一个问题陈述。我现在将执行强制性验证程序。\n\n### 步骤 1：提取已知条件\n- $N$：独立读长的总数\n- $L$：每条读长的固定长度（单位：碱基对）\n- $f$：来源于单一病原体物种的读长比例\n- $G$：病原体的单倍体基因组长度（单位：碱基对）\n- $C$：病原体的预期平均基因组覆盖度\n- 假设：分子的无偏、均匀采样\n- 假设：读长来源被正确分配\n- 假设：末端效应可忽略不计 ($L \\ll G$)\n- 用于计算的数值：\n  - $N = 5.0 \\times 10^{7}$ 条读长\n  - $L = 150$ 个碱基对\n  - $f = 10^{-3}$\n  - $G = 5$ 兆碱基，其中 1 兆碱基等于 $10^{6}$ 个碱基对\n- 任务 1：推导 $C$ 关于 $N$、$L$、$f$ 和 $G$ 的闭式解析表达式。\n- 任务 2：计算 $C$ 的数值并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学性**：该问题植根于基因组学和生物信息学的基本原理，特别是鸟枪法测序和基因组覆盖度的概念。该场景是宏基因组实验的标准表示。\n- **良构性**：该问题是良构的。它提供了所有必要的参数和简化假设（例如，均匀采样、可忽略的末端效应），以推导出预期平均覆盖度的唯一、有意义的解。\n- **客观性**：该问题以精确、客观和定量的术语陈述。它不含任何主观或基于观点的内容。\n- **缺陷清单**：该问题没有表现出任何列出的缺陷。\n  1. 它是科学和事实上正确的。\n  2. 它可以直接形式化，并且与指定主题高度相关。\n  3. 它是完整的且内部一致的。\n  4. 提供的数值对于现代下一代测序 (NGS) 实验是现实的。\n  5. 它的结构良好，并能导出一个唯一的解。\n  6. 它是生物信息学中一个基础但非平凡的概念性问题。\n  7. 推导和结果在数学上是可验证的。\n\n### 步骤 3：结论和行动\n该问题是 **有效的**。将提供完整的解答。\n\n该问题要求从宏基因组测序数据集中推导病原体的预期平均基因组覆盖度 $C$，然后进行数值计算。\n\n首先，我们定义实验中生成的测序数据总量。实验产生 $N$ 条读长，每条长度为 $L$。因此，测序的总碱基对数（总产量）是读长数量与每条读长长度的乘积。\n$$\n\\text{总产量} = N \\times L\n$$\n\n接下来，我们确定总产量中对应于目标病原体的部分。问题陈述，比例为 $f$ 的读长来源于该病原体。由于采样是无偏的，这个比例也代表了属于该病原体的测序总碱基的比例。因此，从该病原体测序得到的总碱基对数，我们可以表示为 $B_{pathogen}$，其值为：\n$$\nB_{pathogen} = f \\times (\\text{总产量}) = f \\times N \\times L\n$$\n\n平均基因组覆盖度 $C$ 定义为针对特定基因组测序的总碱基数除以该基因组的长度。这给出了一个无量纲的“倍数”值，表示平均而言，基因组中的每个碱基被测序了多少次。使用病原体的基因组长度 $G$，我们可以将覆盖度的定义写为：\n$$\nC = \\frac{B_{pathogen}}{G}\n$$\n\n将 $B_{pathogen}$ 的表达式代入 $C$ 的定义，我们得到病原体预期平均基因组覆盖度的闭式解析表达式：\n$$\nC = \\frac{f \\times N \\times L}{G}\n$$\n这就完成了任务的第一部分。\n\n对于第二部分，我们必须使用所提供的数据计算 $C$ 的数值。给定的值为：\n- $N = 5.0 \\times 10^{7}$ 条读长\n- $L = 150$ 个碱基对 (bp)\n- $f = 10^{-3}$\n- $G = 5$ 兆碱基。我们必须将其转换为碱基对。由于 1 兆碱基等于 $10^{6}$ 个碱基对，因此 $G = 5 \\times 10^{6}$ bp。\n\n现在，我们将这些值代入我们推导出的公式中：\n$$\nC = \\frac{(10^{-3}) \\times (5.0 \\times 10^{7}) \\times (150)}{5 \\times 10^{6}}\n$$\n\n让我们简化这个表达式。\n首先，我们计算分子：\n$$\n\\text{分子} = 10^{-3} \\times 5.0 \\times 10^{7} \\times 150 = 5.0 \\times 10^{(7-3)} \\times 150 = 5.0 \\times 10^{4} \\times 150\n$$\n$$\n\\text{分子} = (5.0 \\times 150) \\times 10^{4} = 750 \\times 10^{4} = 7.5 \\times 10^{2} \\times 10^{4} = 7.5 \\times 10^{6}\n$$\n\n分母是：\n$$\n\\text{分母} = 5 \\times 10^{6}\n$$\n\n现在，我们计算 $C$ 的比率：\n$$\nC = \\frac{7.5 \\times 10^{6}}{5 \\times 10^{6}} = \\frac{7.5}{5} = 1.5\n$$\n\n结果是无量纲的覆盖倍数为 $1.5$X。问题要求答案四舍五入到四位有效数字。为了用四位有效数字表示 $1.5$，我们添加尾随的零。\n$$\nC = 1.500\n$$\n均匀采样和正确读长归属的假设对于此计算至关重要，因为它们允许我们直接使用比例 $f$ 来量化病原体特异性的测序产量。假设 $L \\ll G$（$150 \\ll 5 \\times 10^{6}$）证明了忽略边缘效应的合理性，例如读长可能延伸出线性染色体末端的情况，这是此类分析中的标准简化方法。",
            "answer": "$$\\boxed{1.500}$$"
        },
        {
            "introduction": "在高通量测序中，为了提高效率，将数十甚至数百个样本混合测序（即“多重化”）已成为标准操作。然而，这也引入了“索引跳跃”（index hopping）的风险——这是一种技术性假象，导致一个样本的读数被错误地分配给另一个样本，从而造成信息学上的污染。本实践问题  探讨了这一现象的定量影响，特别是当高滴度阳性对照样本污染低生物量临床标本时的关键情景，并演示了如何估算由此产生的假阳性读数数量。",
            "id": "4358600",
            "problem": "一个进行宏基因组下一代测序 (mNGS) 以进行病原体鉴定的临床实验室，对疑似中枢神经系统感染的脑脊液样本进行多重处理。在一次测序运行中，有 $N = 96$ 个文库：$N_{\\text{high}} = 1$ 个含有 Escherichia coli DNA 的高丰度阳性质控文库和 $N_{\\text{low}} = 95$ 个低生物量临床文库。高丰度文库贡献了 $R_{\\text{high}} = 5.0 \\times 10^{6}$ 条映射到 Escherichia coli 的读数。本次运行中，每条读数的有效索引错配（索引跳跃加上任何等效的条形码错配）率为 $r = 0.002$。假设当一条读数发生错配时，它被分配到其真实来源以外的任何其他文库的概率是相等的，并且为了本次计算的目的，源自低生物量文库错配到高丰度文库的读数可以忽略不计。\n\n仅使用应用于独立伯努利试验的期望值基本概率定义，从第一性原理推导单个低生物量文库中，仅由源自高丰度文库的读数错配所导致的 Escherichia coli 污染读数的期望数量。陈述使计算得以明确所需的任何额外的最小假设。\n\n将最终结果四舍五入至四位有效数字。以读数（reads）为单位表示最终的期望数量。",
            "solution": "在尝试解答之前，首先验证问题陈述的科学合理性、一致性和完整性。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题陈述中提供了以下量和条件：\n- 测序运行中的文库总数：$N = 96$。\n- 高丰度阳性质控文库数量：$N_{\\text{high}} = 1$。\n- 低生物量临床文库数量：$N_{\\text{low}} = 95$。\n- 从高丰度文库映射到 *Escherichia coli* 的读数数量：$R_{\\text{high}} = 5.0 \\times 10^{6}$。\n- 每条读数的有效索引错配率：$r = 0.002$。\n- 条件1：当一条读数发生错配时，它被分配到其真实来源以外的任何其他文库的概率是相等的。\n- 条件2：源自低生物量文库错配到高丰度文库的读数可以忽略不计。\n- 任务：从第一性原理推导单个低生物量文库中 *E. coli* 污染读数的期望数量。\n- 约束：推导必须使用应用于独立伯努利试验的期望值基本概率定义。\n- 最终输出：结果必须四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据充分**：该问题设置在宏基因组下一代测序 (mNGS) 的背景下，这是现代基因组诊断学中的一项标准技术。索引错配（或索引跳跃）是多重测序实验中一种有充分记录的人为现象。给定的文库数量 ($N=96$)、对照的读数数量 ($R_{\\text{high}} = 5.0 \\times 10^{6}$) 和错配率 ($r=0.002$) 对于在 Illumina 等平台上进行的典型测序运行是符合实际的。该主题与*用于病原体鉴定的宏基因组测序*这一特定主题直接相关。\n- **问题定义良好**：问题陈述清晰，包含足够的信息以推导出唯一解。数字是一致的 ($N_{\\text{high}} + N_{\\text{low}} = 1 + 95 = 96 = N$)。这些条件提供了一个清晰的概率模型。\n- **客观性**：问题以精确、客观的科学语言陈述，没有模糊性或主观性陈述。\n\n**步骤3：结论与行动**\n\n该问题在科学上是合理的、自洽的、定义良好的和客观的。它不违反任何无效标准。因此，该问题被视为**有效**，并将推导出解决方案。\n\n### 解题推导\n\n目标是计算源自高丰度 *E. coli* 对照文库，但由于索引错配而被错误分配到某个特定低生物量文库的读数的期望数量。我们将按要求从第一性原理进行推导。\n\n让我们考虑源自高丰度文库的 $R_{\\text{high}}$ 条读数中的单条读数。我们关心的是这条特定读数被错配并最终进入某个特定的低生物量文库的事件。我们将这个特定的文库称为“目标文库”。\n\n这个过程可以建模为一系列 $R_{\\text{high}}$ 次独立的伯努利试验，其中每次试验对应一条读数。对于每次试验（即对于每条读数），“成功”被定义为该读数被错配到我们的特定目标文库。\n\n设 $p$ 为单次试验中成功的概率。该事件的发生需要满足两个独立的条件：\n1.  该读数被错配。其概率由给定的索引错配率给出，$P(\\text{错配}) = r$。\n2.  在读数被错配的条件下，它被分配到我们的特定目标文库。问题陈述指出，一条错配的读数被分配到其真实来源以外的任何其他文库的概率是相等的。总共有 $N$ 个文库，因此一条错配的读数有 $N-1$ 个可能的目标。因为有 $N_{\\text{low}} = 95$ 个低生物量文库，并且 $N-1 = 96-1 = 95$，所以可能的目标集合恰好是所有低生物量文库的集合。因此，错配的读数落入任何一个特定目标文库的概率是 $P(\\text{到目标文库} | \\text{错配}) = \\frac{1}{N-1}$。\n\n来自高丰度文库的单条读数污染特定目标文库的概率 $p$ 是这两个事件概率的乘积：\n$$p = P(\\text{错配}) \\times P(\\text{到目标文库} | \\text{错配}) = r \\cdot \\frac{1}{N-1}$$\n\n现在，令 $X$ 为代表目标文库中污染读数总数的随机变量。我们可以将 $X$ 表示为 $R_{\\text{high}}$ 个独立同分布 (i.i.d.) 的指示随机变量 $X_i$ 的和，其中 $i = 1, 2, \\dots, R_{\\text{high}}$：\n$$X = \\sum_{i=1}^{R_{\\text{high}}} X_i$$\n其中，如果第 $i$ 条读数是“成功”的（污染了目标文库），则 $X_i=1$，否则 $X_i=0$。\n\n根据定义，单个指示变量 $X_i$ 的期望值为：\n$$E[X_i] = (1 \\cdot P(X_i=1)) + (0 \\cdot P(X_i=0)) = P(X_i=1) = p$$\n\n根据期望的线性性质，和的期望值等于期望值的和：\n$$E[X] = E\\left[\\sum_{i=1}^{R_{\\text{high}}} X_i\\right] = \\sum_{i=1}^{R_{\\text{high}}} E[X_i]$$\n因为所有的 $X_i$ 都是独立同分布的，所以对所有 $i$ 都有 $E[X_i] = p$。因此：\n$$E[X] = \\sum_{i=1}^{R_{\\text{high}}} p = R_{\\text{high}} \\cdot p$$\n\n代入 $p$ 的表达式，我们得到污染读数期望数量的最终公式：\n$$E[X] = R_{\\text{high}} \\cdot \\frac{r}{N-1}$$\n\n这个从第一性原理出发的推导符合问题的约束。所做的最小假设（大部分在问题陈述中已明确或隐含）是：\n1.  $R_{\\text{high}}$ 条读数中每一条的错配都是一个独立事件（如“独立的伯努利试验”所规定）。\n2.  对于所有源自高丰度文库的读数，错配率 $r$ 是恒定的。\n3.  一条错配读数的目标文库遵循一个在 $N-1$ 个可能的备选文库上的离散均匀概率分布。\n\n现在我们可以将给定的数值代入推导出的公式中：\n- $R_{\\text{high}} = 5.0 \\times 10^{6}$\n- $r = 0.002$\n- $N = 96$，所以 $N-1 = 95$\n\n$$E[X] = (5.0 \\times 10^{6}) \\cdot \\frac{0.002}{95}$$\n$$E[X] = \\frac{5.0 \\times 10^{6} \\times 2 \\times 10^{-3}}{95} = \\frac{10 \\times 10^{3}}{95} = \\frac{10000}{95}$$\n$$E[X] \\approx 105.263157...$$\n\n问题要求将最终结果四舍五入到四位有效数字。\n$$E[X] \\approx 105.3$$\n\n单个低生物量文库中 *Escherichia coli* 污染读数的期望数量是 $105.3$。",
            "answer": "$$\\boxed{105.3}$$"
        },
        {
            "introduction": "诊断宏基因组学的最终目标是对病原体的存在与否做出明确的判断。然而，来自实验室试剂和样本间串扰的背景污染使这一决策变得复杂。本练习  为应对这一挑战引入了一个严谨的统计学框架，利用阴性对照的数据来模拟背景“噪音”，并建立一个控制假阳性率的决策阈值，这是可靠诊断测试的基石。",
            "id": "4358619",
            "problem": "在精准医疗和基因组诊断学中，鸟枪法宏基因组测序被用于鉴定低生物量临床样本中的病原体。试剂空白（阴性对照）表征了由工作流程和试剂引入的背景污染。考虑一个批次，其中试剂空白产生了总共 $500$ 个微生物读数，而一个低生物量临床样本产生了 $1{,}000$ 个微生物读数。通常将空白样本中的背景微生物读数计数视为源自分子上具有独立增量的计数过程，在广泛接受的假设下，该过程可以很好地用泊松分布进行建模，其率参数 $\\lambda_{b}$ 等于试剂空白的均值。\n\n为了控制病原体存在的假阳性判断，在仅含背景的模型下，定义总微生物读数计数的单边决策阈值 $T_{\\alpha}$，使得 I 型错误率（假阳性率，FPR）为 $\\alpha = 0.01$。从试剂空白的泊松模型出发，并利用一个经过充分检验的事实，即对于较大的泊松均值，该分布可以通过带有连续性校正的高斯分布很好地近似，推导出一个用 $\\lambda_{b}$、$\\alpha$ 和标准正态分位数表示 $T_{\\alpha}$ 的闭式近似解。然后，对 $\\lambda_{b} = 500$ 和 $\\alpha = 0.01$ 的情况，对 $T_{\\alpha}$ 进行数值计算。\n\n将您的最终阈值舍入到四位有效数字。将最终阈值表示为读数计数（单位：读数）。",
            "solution": "该问题要求推导和评估一个用于在宏基因组样本中鉴定病原体读数的决策阈值，同时控制背景污染。对问题陈述的验证证实了其科学合理性、一致性和良定性。\n\n仅含背景模型假定微生物读数的数量（由随机变量 $X$ 表示）遵循平均率为 $\\lambda_b$ 的泊松分布。原假设 $H_0$ 是给定的样本仅包含背景污染。\n$$ X \\sim \\text{Poisson}(\\lambda_b) $$\n问题提供了试剂空白的均值作为此率的估计量，因此我们设定 $\\lambda_b = 500$。\n\n目标是找到读数计数的单边决策阈值 $T_{\\alpha}$，使得 I 型错误率（假阳性率，FPR）为 $\\alpha = 0.01$。I 型错误是在原假设为真时拒绝原假设的概率。对于一个我们寻找读数超额的单边检验，如果观测到的计数大于或等于某个整数阈值，我们就拒绝 $H_0$。设这个整数阈值为 $k$。那么 I 型错误定义为：\n$$ P(X \\ge k | H_0) \\le \\alpha $$\n问题要求使用泊松分布的正态近似（包括连续性校正）来求出连续阈值 $T_{\\alpha}$ 的闭式近似解。对于大的 $\\lambda_b$，泊松分布 Poisson($\\lambda_b$) 可以用一个均值为 $\\mu = \\lambda_b$、方差为 $\\sigma^2 = \\lambda_b$ 的正态分布 $Y \\sim N(\\mu, \\sigma^2)$ 来近似。\n\n应用连续性校正是为了用连续变量来近似离散变量的概率。观测到至少为 $T_{\\alpha}$ 的整数计数（暂时假设 $T_{\\alpha}$ 是一个整数）的概率，可以通过正态曲线上大于 $T_{\\alpha} - 0.5$ 的值的面积来近似。\n$$ P(X \\ge T_{\\alpha}) \\approx P(Y > T_{\\alpha} - 0.5) $$\n我们将这个近似概率设为等于 $\\alpha$：\n$$ P(Y > T_{\\alpha} - 0.5) = \\alpha $$\n为了评估这个概率，我们对正态变量 $Y$ 进行标准化。令 $Z$ 为标准正态变量，$Z = \\frac{Y - \\mu}{\\sigma} = \\frac{Y - \\lambda_b}{\\sqrt{\\lambda_b}}$。那么 $Z \\sim N(0, 1)$。\n$$ P\\left(\\frac{Y - \\lambda_b}{\\sqrt{\\lambda_b}} > \\frac{(T_{\\alpha} - 0.5) - \\lambda_b}{\\sqrt{\\lambda_b}}\\right) = \\alpha $$\n$$ P\\left(Z > \\frac{T_{\\alpha} - 0.5 - \\lambda_b}{\\sqrt{\\lambda_b}}\\right) = \\alpha $$\n令 $z_{\\alpha}$ 为单边检验的标准正态分位数，其定义为 $P(Z > z_{\\alpha}) = \\alpha$。这是标准正态曲线下其右侧面积等于 $\\alpha$ 的值。通过令参数相等，我们得到：\n$$ z_{\\alpha} = \\frac{T_{\\alpha} - 0.5 - \\lambda_b}{\\sqrt{\\lambda_b}} $$\n我们现在可以解出 $T_{\\alpha}$，以获得所需的闭式近似解：\n$$ z_{\\alpha} \\sqrt{\\lambda_b} = T_{\\alpha} - 0.5 - \\lambda_b $$\n$$ T_{\\alpha} = \\lambda_b + 0.5 + z_{\\alpha} \\sqrt{\\lambda_b} $$\n这个表达式用背景均值 $\\lambda_b$ 和对应于 I 型错误率 $\\alpha$ 的标准正态分位数 $z_{\\alpha}$ 来表示决策阈值 $T_{\\alpha}$。\n\n接下来，我们用给定的数值 $\\lambda_b = 500$ 和 $\\alpha = 0.01$ 对此表达式进行数值计算。\n首先，我们必须找到 $z_{0.01}$ 的值。这对应于标准正态分布上的一个点，在该点上累积分布函数 (CDF) $\\Phi(z)$ 等于 $1 - \\alpha = 1 - 0.01 = 0.99$。\n$$ \\Phi(z_{0.01}) = 0.99 $$\n使用标准统计表或计算函数，可以找到该值为 $z_{0.01} \\approx 2.32634787$。\n\n现在，我们将这些值代入推导出的 $T_{\\alpha}$ 公式中：\n$$ T_{0.01} = 500 + 0.5 + z_{0.01} \\sqrt{500} $$\n$$ T_{0.01} \\approx 500 + 0.5 + (2.32634787) \\times \\sqrt{500} $$\n$500$ 的平方根是 $\\sqrt{500} = 10\\sqrt{5} \\approx 22.36067977$。\n$$ T_{0.01} \\approx 500.5 + (2.32634787)(22.36067977) $$\n$$ T_{0.01} \\approx 500.5 + 52.0163326 $$\n$$ T_{0.01} \\approx 552.5163326 $$\n问题要求将最终阈值舍入到四位有效数字。前四位有效数字是 $5$、$5$、$2$ 和 $5$。第五位数字是 $1$，所以我们向下舍入。\n$$ T_{0.01} \\approx 552.5 $$\n因此，表示为读数计数的决策阈值约为 $552.5$。",
            "answer": "$$\\boxed{552.5}$$"
        }
    ]
}