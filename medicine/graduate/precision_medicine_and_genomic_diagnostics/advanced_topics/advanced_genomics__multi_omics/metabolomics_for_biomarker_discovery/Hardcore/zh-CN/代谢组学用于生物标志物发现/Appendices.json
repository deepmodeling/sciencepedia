{
    "hands_on_practices": [
        {
            "introduction": "在高分辨率质谱分析中，精确的质量测定是可靠鉴定代谢物身份的基石。本练习将帮助您区分外部和内标校准策略，并掌握计算质量误差（以百万分率 ppm 为单位）的方法，这是评估代谢组学数据质量的一项基本技能。通过这个练习，您将深入理解确保代谢物鉴定置信度的技术细节。",
            "id": "4358307",
            "problem": "在高分辨率液相色谱-质谱 (LC–MS) 代谢组学工作流程中，为了发现生物标志物，精确的质量测量是可靠地指定元素组成以及后续与基因组诊断相结合的基础。考虑内源性硫醇代谢物谷胱甘肽，其中性分子式为 $\\mathrm{C}_{10}\\mathrm{H}_{17}\\mathrm{N}_{3}\\mathrm{O}_{6}\\mathrm{S}$。在正电喷雾电离模式下运行的 Orbitrap 仪器上测量了单质子化离子 $\\left[\\mathrm{M}+\\mathrm{H}\\right]^{+}$。在分析运行前，使用一组外标对仪器进行了校准；未使用锁模内标。\n\n在此外标校准下，在 $m/z = 308.091650000$ 处观测到对应于谷胱甘肽 $\\left[\\mathrm{M}+\\mathrm{H}\\right]^{+}$ 的一个特定特征峰。对中性分子使用以下单同位素原子质量：碳 ($\\mathrm{C}$) $12.000000000$，氢 ($\\mathrm{H}$) $1.00782503223$，氮 ($\\mathrm{N}$) $14.00307400443$，氧 ($\\mathrm{O}$) $15.99491461957$，硫 ($\\mathrm{S}$) $31.9720711744$，以及质子 $\\mathrm{H}^{+}$ 的质量 $1.00727646688$。假设 $\\left[\\mathrm{M}+\\mathrm{H}\\right]^{+}$ 的单位电荷为 $z=1$。\n\n从质谱测量和校准的基本原理出发，简要解释外标质量校准和内标质量校准在校正系统性频率-质量映射以及运行过程中的漂移方面的区别。然后，首先根据其元素组成和电荷态推导出理论 $m/z$，再计算外标校准下测得的谷胱甘肽 $\\left[\\mathrm{M}+\\mathrm{H}\\right]^{+}$ 特征峰的质量误差（以百万分率计）。将最终数值四舍五入至四位有效数字。将最终答案表示为一个代表百万分率的纯数（不包含任何单位符号）。",
            "solution": "高分辨率质谱通过校准建立的仪器特定转换函数，将离子运动产生的频率（例如，Orbitrap 中的轨道频率或傅里叶变换离子回旋共振 (FT-ICR) 中的回旋频率）映射到质量，从而测量质荷比 $m/z$。由于这种映射对仪器条件敏感，并且会随时间漂移（例如，由于温度、压力或电压的变化），因此使用校准策略来确保精确的质量测量。\n\n外标质量校准使用在分析运行前测量的标准化合物来构建频率-质量映射。调整仪器参数，使已知的标准物质质量与其预期的 $m/z$ 值对齐，然后将此校准应用于后续样品，在采集过程中不进行进一步校正。内标质量校准使用样品运行期间存在的参考离子（无论是掺入的校准物还是内源性的锁模离子）来实时地、连续或周期性地校正映射，以补偿运行内的漂移。因此，内标校准通常在运行期间产生更高的质量准确度，因为它能跟踪并校正随时间变化的偏差，而外标校准则依赖于条件保持稳定的假设。\n\n为计算外标校准测量的质量误差（以百万分率计），我们首先根据谷胱甘肽的单同位素元素组成，推导其单质子化离子 $\\left[\\mathrm{M}+\\mathrm{H}\\right]^{+}$ 的理论 $m/z$。分子式为 $\\mathrm{C}_{10}\\mathrm{H}_{17}\\mathrm{N}_{3}\\mathrm{O}_{6}\\mathrm{S}$ 的谷胱甘肽的单同位素中性质量 $m_{\\mathrm{neutral}}$ 为\n$$\nm_{\\mathrm{neutral}} = 10 \\times 12.000000000 + 17 \\times 1.00782503223 + 3 \\times 14.00307400443 + 6 \\times 15.99491461957 + 1 \\times 31.9720711744.\n$$\n计算各项：\n$$\n10 \\times 12.000000000 = 120.000000000,\n$$\n$$\n17 \\times 1.00782503223 = 17.13302554791,\n$$\n$$\n3 \\times 14.00307400443 = 42.00922201329,\n$$\n$$\n6 \\times 15.99491461957 = 95.96948771742,\n$$\n$$\n1 \\times 31.9720711744 = 31.9720711744.\n$$\n求和，\n$$\nm_{\\mathrm{neutral}} = 120.000000000 + 17.13302554791 + 42.00922201329 + 95.96948771742 + 31.9720711744 = 307.08380645302.\n$$\n对于电荷为 $z=1$ 的单质子化离子，其理论 $m/z$ 是中性质量加上质子质量：\n$$\nm_{\\mathrm{theo}} = m_{\\mathrm{neutral}} + m_{\\mathrm{H}^{+}} = 307.08380645302 + 1.00727646688 = 308.09108291990.\n$$\n观测到的外标校准值为\n$$\nm_{\\mathrm{obs}} = 308.09165000000.\n$$\n质量误差（以百万分率 ppm 计）由观测质量与理论质量之间的标准关系定义：\n$$\n\\mathrm{ppm} = 10^{6} \\cdot \\frac{m_{\\mathrm{obs}} - m_{\\mathrm{theo}}}{m_{\\mathrm{theo}}}.\n$$\n计算分子差值：\n$$\nm_{\\mathrm{obs}} - m_{\\mathrm{theo}} = 308.09165000000 - 308.09108291990 = 0.00056708010.\n$$\n构成比率：\n$$\n\\frac{m_{\\mathrm{obs}} - m_{\\mathrm{theo}}}{m_{\\mathrm{theo}}} = \\frac{0.00056708010}{308.09108291990}.\n$$\n乘以 $10^{6}$ 得到百万分率：\n$$\n\\mathrm{ppm} = 10^{6} \\cdot \\frac{0.00056708010}{308.09108291990} = \\frac{567.08010}{308.09108291990}.\n$$\n计算商以获得 ppm 数值：\n$$\n\\mathrm{ppm} \\approx 1.84062484.\n$$\n四舍五入至四位有效数字，质量误差为\n$$\n1.841.\n$$\n这个正值表明，外标校准的测量值比理论 $m/z$ 高约 $1.841$ 百万分率，这与外标校准不能校正运行内漂移的预期相符，而内标校准则通过在采集过程中锁定质量标尺来减少这种偏差。",
            "answer": "$$\\boxed{1.841}$$"
        },
        {
            "introduction": "在对原始代谢组学数据进行多变量分析之前，数据转换和标准化是至关重要的步骤。本练习从第一性原理出发，探讨了不同的数据缩放方法（如仅对数转换、单位方差缩放和帕累托缩放）如何影响数据的方差结构，从而帮助您理解这些选择对后续模型（如主成分分析）的深远影响。掌握这些技术对于从复杂数据集中提取有意义的生物学信息至关重要。",
            "id": "4358289",
            "problem": "一项精准医学中的代谢组学研究旨在通过量化 $n$ 个受试者的代谢物峰强度，来发现能够区分两个患者亚组的生物标志物。假设由 $i \\in \\{1,2\\}$ 索引的两种代谢物，其原始峰强度为 $I_{i}$。生物学和技术性方差的乘法性质可以很好地由对数正态分布描述：$I_{i} \\sim \\mathrm{LogNormal}(\\mu_{i}, \\tau_{i}^{2})$，这意味着 $\\ln(I_{i}) \\sim \\mathcal{N}(\\mu_{i}, \\tau_{i}^{2})$，且在不同 $i$ 之间相互独立。考虑三种变换方案，每种方案都在对数变换后的强度进行均值中心化之后应用：\n- 仅对数变换：$Y_{i} = \\ln(I_{i}) - \\mathbb{E}[\\ln(I_{i})]$。\n- 自标度变换：$A_{i} = \\dfrac{\\ln(I_{i}) - \\mathbb{E}[\\ln(I_{i})]}{\\sqrt{\\operatorname{Var}(\\ln(I_{i}))}}$。\n- 帕累托标度变换：$P_{i} = \\dfrac{\\ln(I_{i}) - \\mathbb{E}[\\ln(I_{i})]}{\\sqrt{\\sqrt{\\operatorname{Var}(\\ln(I_{i}))}}}$。\n\n从对数正态分布的基本定义以及方差在仿射变换下的性质出发，推导在每种方案下，代谢物1相对于代谢物2的方差比 $R_{12}$ 的闭式解析表达式，其中 $R_{12} = \\dfrac{\\operatorname{Var}(T_{1})}{\\operatorname{Var}(T_{2})}$，$T_{i}$ 分别表示三种方案下的 $Y_{i}$、$A_{i}$ 或 $P_{i}$。然后，从第一性原理出发，论证这些方差结构如何在精准医学的生物标志物发现中影响下游的多变量建模选择，例如主成分分析（PCA）和偏最小二乘法（PLS），并解释每种方案对不同分析任务的适用性。\n\n将最终答案以单行矩阵的形式给出，该矩阵包含分别对应于仅对数变换、自标度变换和帕累托标度变换的三种 $R_{12}$ 表达式。无需进行数值计算或四舍五入。",
            "solution": "### 方差比的推导\n\n令随机变量 $X_{i}$ 表示代谢物 $i$ 的对数变换强度，即 $X_{i} = \\ln(I_{i})$。根据问题陈述，我们知道 $X_{i} \\sim \\mathcal{N}(\\mu_{i}, \\tau_{i}^{2})$。因此，我们有总体均值 $\\mathbb{E}[X_{i}] = \\mu_{i}$ 和总体方差 $\\operatorname{Var}(X_i) = \\tau_i^2$。\n\n这些变换方案可以用 $X_i$、$\\mu_i$ 和 $\\tau_i^2$ 来表示：\n-   仅对数变换：$Y_{i} = X_{i} - \\mu_{i}$。\n-   自标度变换：$A_{i} = \\dfrac{X_{i} - \\mu_{i}}{\\sqrt{\\tau_{i}^2}} = \\dfrac{X_{i} - \\mu_{i}}{\\tau_{i}}$。\n-   帕累托标度变换：$P_{i} = \\dfrac{X_{i} - \\mu_{i}}{\\sqrt{\\sqrt{\\tau_{i}^2}}} = \\dfrac{X_{i} - \\mu_{i}}{\\sqrt{\\tau_{i}}}$。\n\n我们将使用随机变量 $Z$ 仿射变换的方差基本性质：$\\operatorname{Var}(aZ + b) = a^{2}\\operatorname{Var}(Z)$，其中 $a$ 和 $b$ 是常数。\n\n**1. 仅对数变换 ($Y_i$)**\n变换后的变量为 $Y_{i} = X_{i} - \\mu_{i}$。这是一个仿射变换，其中 $a=1$ 且 $b=-\\mu_{i}$。方差为：\n$$ \\operatorname{Var}(Y_{i}) = \\operatorname{Var}(X_{i} - \\mu_{i}) = 1^2 \\operatorname{Var}(X_{i}) = \\tau_i^2 $$\n代谢物1和2的方差比为：\n$$ R_{12}^{(Y)} = \\frac{\\operatorname{Var}(Y_{1})}{\\operatorname{Var}(Y_{2})} = \\frac{\\tau_1^2}{\\tau_2^2} $$\n\n**2. 自标度变换 ($A_i$)**\n变换后的变量为 $A_{i} = \\dfrac{X_{i} - \\mu_{i}}{\\tau_{i}} = \\left(\\dfrac{1}{\\tau_{i}}\\right)X_{i} - \\dfrac{\\mu_{i}}{\\tau_{i}}$。这是一个仿射变换，其中 $a = \\dfrac{1}{\\tau_{i}}$ 且 $b = -\\dfrac{\\mu_{i}}{\\tau_{i}}$。方差为：\n$$ \\operatorname{Var}(A_{i}) = \\operatorname{Var}\\left(\\frac{1}{\\tau_{i}}X_{i} - \\frac{\\mu_{i}}{\\tau_{i}}\\right) = \\left(\\frac{1}{\\tau_{i}}\\right)^2 \\operatorname{Var}(X_{i}) = \\frac{1}{\\tau_i^2} \\cdot \\tau_i^2 = 1 $$\n每个经过自标度变换的代谢物的方差都为1。代谢物1和2的方差比为：\n$$ R_{12}^{(A)} = \\frac{\\operatorname{Var}(A_{1})}{\\operatorname{Var}(A_{2})} = \\frac{1}{1} = 1 $$\n\n**3. 帕累托标度变换 ($P_i$)**\n变换后的变量为 $P_{i} = \\dfrac{X_{i} - \\mu_{i}}{\\sqrt{\\tau_{i}}}$。这是一个仿射变换，其中 $a = \\dfrac{1}{\\sqrt{\\tau_{i}}}$ 且 $b = -\\dfrac{\\mu_{i}}{\\sqrt{\\tau_{i}}}$。方差为：\n$$ \\operatorname{Var}(P_{i}) = \\operatorname{Var}\\left(\\frac{1}{\\sqrt{\\tau_{i}}}X_{i} - \\frac{\\mu_{i}}{\\sqrt{\\tau_{i}}}\\right) = \\left(\\frac{1}{\\sqrt{\\tau_{i}}}\\right)^2 \\operatorname{Var}(X_{i}) = \\frac{1}{\\tau_{i}} \\cdot \\tau_i^2 = \\tau_i $$\n代谢物1和2的方差比为：\n$$ R_{12}^{(P)} = \\frac{\\operatorname{Var}(P_{1})}{\\operatorname{Var}(P_{2})} = \\frac{\\tau_1}{\\tau_2} $$\n\n### 对多变量建模的影响及适用性\n\n诸如主成分分析（PCA）和偏最小二乘法（PLS）等多变量投影方法是方差驱动的。新投影空间的坐标轴（主成分或潜变量）被定义为原始变量的线性组合，其选择旨在最大化某个方差或协方差准则。因此，原始变量的相对标度深刻地影响最终的模型。方差较高的变量将对模型结构产生更大的影响，甚至可能主导模型。因此，标度变换方案的选择是基于分析目标的一项关键决策。\n\n-   **仅对数变换：** 该方案保留了对数变换数据的原始方差结构，其中 $\\operatorname{Var}(Y_i) = \\tau_i^2$。在PCA/PLS模型中，具有高内在生物学或技术变异性（即大的 $\\tau_i^2$）的代谢物将主导前几个主成分。如果认为这种高方差与感兴趣的生物学问题直接相关，这可能是理想的。然而，在生物标志物发现中，这通常是一个缺点，因为高丰度或技术噪音大的代谢物可能会掩盖低方差代谢物中那些虽然微小但一致且能真正区分患者亚组的变化。它仅在已知具有最大方差的特征是最重要的情况下才适用。\n\n-   **自标度变换：** 该方案将所有代谢物的方差均一化为1，即 $\\operatorname{Var}(A_i) = 1$。因此，每个代谢物被赋予相同的权重，或影响模型的同等机会。分析的驱动力从方差大小转向代谢物之间的相关性结构。这通常是非靶向生物标志物发现中的默认选择，因为它确保了低丰度或低方差的代谢物在计算中不会被忽略。它允许模型检测到那些绝对变化虽小但与表型高度相关的代谢物所涉及的模式。其主要缺点是可能放大噪音：对于内在方差 $\\tau_i^2$ 非常小的代谢物，除以一个小的标准差 $\\tau_i$ 会放大测量误差相对于生物信号的贡献。\n\n-   **帕累托标度变换：** 该方案导致 $\\operatorname{Var}(P_i) = \\tau_i$，代表了一种折衷。它在不完全消除方差信息的情况下，减少了最高方差代谢物的压倒性影响。原始方差 $\\tau_i^2$ 被平方根变换所“抑制”。例如，如果 $\\tau_1^2 = 100\\tau_2^2$，那么经过帕累托标度变换后，$\\operatorname{Var}(P_1) = 10\\operatorname{Var}(P_2)$。这与仅对数变换数据中100倍的差异相比是显著的减少。帕累托标度变换通常被认为是代谢组学中的一种最佳平衡，因为它保留了对较大倍数变化的代谢物（这些通常具有生物学意义）的一些强调，同时仍允许低方差代谢物对模型做出贡献。当大的和微小的效应都可能具有研究价值，并且希望避免保留原始方差或完全均一化方差这两种极端情况时，它是适用的。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{\\tau_1^2}{\\tau_2^2}  1  \\frac{\\tau_1}{\\tau_2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在非靶向代谢组学研究中，我们同时对成千上万种代谢物进行假设检验，这带来了严重的多重检验问题。本练习旨在阐明控制伪发现率（FDR）的 Benjamini–Hochberg 程序背后的统计学原理，并指导您通过计算 $q$ 值来实际评估潜在生物标志物的统计显著性。这是在生物标志物发现中从大量候选物中筛选出真正信号的关键一步。",
            "id": "4358285",
            "problem": "在一项用于精准医疗和基因组诊断中发现生物标志物的大规模非靶向液相色谱-质谱 (LC–MS) 代谢组学研究中，假设您要检验两个匹配良好的队列中一组候选代谢物的差异丰度。假定满足多重检验理论中常用的以下基本条件：(i) 在真实零假设下，检验的 $p$-值随机占优于单位区间上的均匀分布，因此对于任何 $t \\in [0,1]$，都有 $\\mathbb{P}(p \\leq t) \\leq t$；(ii) 零假设 $p$-值的集合彼此独立，并且独立于非零假设的 $p$-值。设同时检验的假设数量为 $m$，其中 $m_{0}$ 表示真实零假设的数量。\n\n从错误发现率 (FDR) 的定义出发，即 $\\mathrm{FDR} = \\mathbb{E}\\!\\left[\\frac{V}{\\max(R,1)}\\right]$，其中 $V$ 是错误拒绝的数量，$R$ 是总拒绝数量，请推导 Benjamini–Hochberg (BH) 升阶程序，该程序在上述独立性假设下将 FDR 控制在用户指定的水平 $\\alpha \\in (0,1)$。特别地，推导确定最大拒绝秩的规则，并解释为什么这能保证 $\\mathrm{FDR} \\leq \\alpha$。\n\n然后，使用 BH 框架，将每个被检验特征的 $q$-值定义为通过 BH 程序判定该特征为显著时的最小 FDR 水平。根据此定义，计算以下 $m=12$ 种代谢物的 $q$-值，这些代谢物在队列比较中观测到的双边 $p$-值如下：\n- Citrate: $0.0009$\n- Acylcarnitine C16: $0.0025$\n- Lactate: $0.0041$\n- Kynurenine: $0.0068$\n- Succinate: $0.011$\n- Glycine: $0.013$\n- Lysophosphatidylcholine LPC(18:2): $0.021$\n- Alpha-hydroxybutyrate: $0.031$\n- Sphingomyelin SM(d18{:}1/24{:}0): $0.047$\n- Creatinine: $0.062$\n- Trimethylamine N-oxide (TMAO): $0.084$\n- Glucose: $0.16$\n\n完成推导和计算后，报告 Kynurenine 的 Benjamini–Hochberg $q$-值。最终答案以纯数字形式表示（无单位），并四舍五入至四位有效数字。",
            "solution": "### 第一部分：Benjamini–Hochberg 程序的推导与论证\n\n我们有 $m$ 个同时检验的假设 $H_1, \\ldots, H_m$，其对应的 $p$-值为 $p_1, \\ldots, p_m$。设 $m_0$ 为真实零假设的数量。设排序后的 $p$-值为 $p_{(1)} \\le p_{(2)} \\le \\ldots \\le p_{(m)}$。\n\n用于将错误发现率 (FDR) 控制在水平 $\\alpha \\in (0,1)$ 的 Benjamini–Hochberg (BH) 升阶程序如下：\n1.  找到最大整数 $k$，使得 $p_{(k)} \\le \\frac{k}{m}\\alpha$。\n2.  如果存在这样的 $k$，则拒绝所有零假设 $H_{(i)}$，其中 $i = 1, \\ldots, k$。\n3.  如果不存在这样的 $k$，则不拒绝任何零假设。\n\n总拒绝数为 $R=k$，错误拒绝数（第一类错误）为 $V$，即 $k$ 个被拒绝的假设中真实零假设的数量。错误发现率定义为 $\\mathrm{FDR} = \\mathbb{E}\\!\\left[\\frac{V}{\\max(R,1)}\\right]$。我们现在证明，在真实零假设对应的 $p$-值相互独立的假设下，该程序保证 $\\mathrm{FDR} \\leq \\frac{m_0}{m}\\alpha \\leq \\alpha$。\n\n设 $I_0$ 是对应于 $m_0$ 个真实零假设的索引集合。设 $R$ 是总拒绝数。错误发现比例为 $Q = \\frac{V}{R}$（如果 $R0$），$Q=0$（如果 $R=0$）。我们希望证明 $E[Q] \\le \\frac{m_0}{m} \\alpha$。\n\n根据期望的线性性质，我们可以写出：\n$$ \\mathrm{FDR} = \\mathbb{E}[Q] = \\mathbb{E}\\left[ \\sum_{i \\in I_0} \\frac{I(H_i \\text{ is rejected})}{\\max(R,1)} \\right] = \\sum_{i \\in I_0} \\mathbb{E}\\left[ \\frac{I(H_i \\text{ is rejected})}{\\max(R,1)} \\right] $$\n其中 $I(\\cdot)$ 是指示函数。\n\n让我们关注一个单一的真实零假设 $H_i$，$i \\in I_0$。设其 p 值为 $p_i$。如果 $p_i \\le p_{(k)}$，BH 程序会拒绝 $H_i$，其中 $k$ 是由该程序决定的随机索引。这种依赖性使得直接计算变得困难。\n\n遵循 Benjamini 和 Hochberg 的原始逻辑，一个更直接的证明过程如下。设 $R$ 为被拒绝假设的随机数量。如果 $R=r  0$，则该程序拒绝了所有 $p$-值至多为 $p_{(r)}$ 的假设，并且我们从规则中得知 $p_{(r)} \\le \\frac{r}{m}\\alpha$。因此，任何被拒绝的真实零假设 $H_i$ 必定有 $p_i \\le p_{(r)} \\le \\frac{r}{m}\\alpha$。\n\n因此，对于给定的拒绝数 $R=r$，错误发现数 $V$ 有界：\n$$ V \\le \\sum_{i \\in I_0} I\\left(p_i \\le \\frac{r}{m}\\alpha\\right) $$\n以 $R=r$ 为条件，错误发现比例为 $\\frac{V}{r}$。其期望为：\n$$ \\mathbb{E}\\left[\\frac{V}{r} \\bigg| R=r\\right] \\le \\mathbb{E}\\left[ \\frac{1}{r} \\sum_{i \\in I_0} I\\left(p_i \\le \\frac{r}{m}\\alpha\\right) \\bigg| R=r \\right] $$\n关键假设是，零假设的 $p$-值与非零假设的 $p$-值相互独立。$R=r$ 的值由全部 $p$-值集合确定。然而，由于独立性假设，以 $R=r$ 为条件并不会扭曲零假设 $p$-值的分布，从而使属性 $\\mathbb{P}(p_i \\le t) \\le t$ 失效。\n$$ \\mathbb{E}\\left[\\frac{V}{r} \\bigg| R=r\\right] \\le \\frac{1}{r} \\sum_{i \\in I_0} \\mathbb{P}\\left(p_i \\le \\frac{r}{m}\\alpha \\bigg| R=r\\right) $$\n在指定的独立性条件下，我们可以陈述 $\\mathbb{P}(p_i \\le t | R=r) \\le t$。这是关键的一步。因此：\n$$ \\mathbb{E}\\left[\\frac{V}{r} \\bigg| R=r\\right] \\le \\frac{1}{r} \\sum_{i \\in I_0} \\frac{r}{m}\\alpha = \\frac{1}{r} \\cdot m_0 \\cdot \\frac{r}{m}\\alpha = \\frac{m_0}{m}\\alpha $$\n这个不等式对 $R$ 的任何可能结果 $r0$ 都成立。我们现在可以对 $R$ 取期望：\n$$ \\mathrm{FDR} = \\mathbb{E}\\left[\\frac{V}{\\max(R,1)}\\right] = \\mathbb{E}\\left[\\mathbb{E}\\left[\\frac{V}{\\max(R,1)} \\bigg| R\\right]\\right] $$\n$$ \\mathrm{FDR} = \\sum_{r=1}^m \\mathbb{E}\\left[\\frac{V}{r} \\bigg| R=r\\right]\\mathbb{P}(R=r) \\le \\sum_{r=1}^m \\frac{m_0}{m}\\alpha \\cdot \\mathbb{P}(R=r) = \\frac{m_0}{m}\\alpha \\sum_{r=1}^m \\mathbb{P}(R=r) $$\n因为 $\\sum_{r=1}^m \\mathbb{P}(R=r) = \\mathbb{P}(R0) \\le 1$，我们有：\n$$ \\mathrm{FDR} \\le \\frac{m_0}{m}\\alpha $$\n由于真实零假设的数量 $m_0$ 小于或等于总检验数 $m$，我们有 $\\frac{m_0}{m} \\le 1$，这便完成了证明：\n$$ \\mathrm{FDR} \\le \\frac{m_0}{m}\\alpha \\le \\alpha $$\n\n### 第二部分：q 值的定义与计算\n\n特定特征（假设）的 $q$-值定义为该特征将被判定为显著的最小 FDR 水平 $\\alpha$。\n设排序后的 $p$-值为 $p_{(1)} \\le p_{(2)} \\le \\ldots \\le p_{(m)}$。对于这个排序中的第 $i$ 个假设 $H_{(i)}$，要被判定为显著，BH 程序必须至少拒绝到秩 $i$。这意味着必须存在某个 $k \\ge i$ 使得 $p_{(k)} \\le \\frac{k}{m}\\alpha$。\n这个不等式可以重写为 $\\alpha \\ge p_{(k)} \\frac{m}{k}$。为了找到满足此条件的*最小* $\\alpha$（对于至少一个 $k \\ge i$），我们必须在从 $i$ 到 $m$ 的所有可能的 $k$ 中找到这些下界的最小值。\n因此，第 $i$ 个有序 $p$-值的 $q$-值，记为 $q_{(i)}$，是：\n$$ q_{(i)} = \\min_{k=i, \\ldots, m} \\left\\{ \\frac{m \\cdot p_{(k)}}{k} \\right\\} $$\n这个定义确保了 $q$-值是单调非递减的，即 $q_{(1)} \\le q_{(2)} \\le \\dots \\le q_{(m)}$。这可以从等价的递归定义中看出：\n$q_{(m)} = p_{(m)}$，并且对于 $i = m-1, \\ldots, 1$，$q_{(i)} = \\min\\left(q_{(i+1)}, \\frac{m \\cdot p_{(i)}}{i}\\right)$。\n\n给定 $m=12$ 种代谢物及其对应的 $p$-值，这些值已经排序：\n1. Citrate: $p_{(1)} = 0.0009$\n2. Acylcarnitine C16: $p_{(2)} = 0.0025$\n3. Lactate: $p_{(3)} = 0.0041$\n4. Kynurenine: $p_{(4)} = 0.0068$\n5. Succinate: $p_{(5)} = 0.011$\n6. Glycine: $p_{(6)} = 0.013$\n7. LPC(18:2): $p_{(7)} = 0.021$\n8. Alpha-hydroxybutyrate: $p_{(8)} = 0.031$\n9. SM(d18{:}1/24{:}0): $p_{(9)} = 0.047$\n10. Creatinine: $p_{(10)} = 0.062$\n11. TMAO: $p_{(11)} = 0.084$\n12. Glucose: $p_{(12)} = 0.16$\n\n我们需要计算 Kynurenine 的 $q$-值，它是列表中的第4个代谢物，因此我们需要计算 $q_{(4)}$。我们使用公式 $q_{(4)} = \\min_{k=4, \\ldots, 12} \\left\\{ \\frac{12 \\cdot p_{(k)}}{k} \\right\\}$。\n\n首先，我们计算 $k=4, \\ldots, 12$ 时 $\\frac{m \\cdot p_{(k)}}{k}$ 的值：\n- 对于 $k=4$: $\\frac{12 \\times 0.0068}{4} = 3 \\times 0.0068 = 0.0204$\n- 对于 $k=5$: $\\frac{12 \\times 0.011}{5} = \\frac{0.132}{5} = 0.0264$\n- 对于 $k=6$: $\\frac{12 \\times 0.013}{6} = 2 \\times 0.013 = 0.026$\n- 对于 $k=7$: $\\frac{12 \\times 0.021}{7} \\approx 0.036$\n- 对于 $k=8$: $\\frac{12 \\times 0.031}{8} = 1.5 \\times 0.031 = 0.0465$\n- 对于 $k=9$: $\\frac{12 \\times 0.047}{9} = \\frac{4}{3} \\times 0.047 \\approx 0.062667$\n- 对于 $k=10$: $\\frac{12 \\times 0.062}{10} = 1.2 \\times 0.062 = 0.0744$\n- 对于 $k=11$: $\\frac{12 \\times 0.084}{11} \\approx 0.091636$\n- 对于 $k=12$: $\\frac{12 \\times 0.16}{12} = 0.16$\n\nKynurenine 的 $q$-值，$q_{(4)}$，是这些计算值的最小值：\n$$ q_{(4)} = \\min\\{0.0204, 0.0264, 0.026, 0.036, 0.0465, 0.062667, 0.0744, 0.091636, 0.16\\} $$\n该集合中的最小值为 $0.0204$。\n因此，Kynurenine 的 $q$-值为 $0.0204$。\n\n题目要求将答案四舍五入到四位有效数字。确切值为 $0.0204$，有三位有效数字。为了以四位有效数字的精度表示，我们在末尾添加一个零。\n\n最终答案：$0.02040$。",
            "answer": "$$\\boxed{0.02040}$$"
        }
    ]
}