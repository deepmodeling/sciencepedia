{
    "hands_on_practices": [
        {
            "introduction": "在启动任何饱和基因组编辑（SGE）项目之前，规划变体文库的规模是至关重要的第一步。这个练习将指导你使用基本的组合数学原理，计算覆盖一个目标外显子所有可能的单核苷酸变异所需的文库大小 。通过这个计算，你将学会如何将抽象的“饱和”概念转化为具体的数字，从而将基因长度和实验冗余度等设计参数与文库的物理复杂性直接联系起来。",
            "id": "4329417",
            "problem": "一个研究团队正在使用成簇规律间隔短回文重复序列 (CRISPR) 技术设计一个饱和基因组编辑 (SGE) 文库，以绘制单个编码外显子上的变异效应图谱。该外显子长度为 $L$ 个碱基对，设计目标是包含该外显子每个位置上所有可能的单核苷酸替换。在此背景下，单核苷酸替换定义为在某个基因组位置上将一个碱基精确地改变为标准脱氧核糖核酸 (DNA) 字母表 $\\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$ 中的任何其他碱基，不包括该位置的原始碱基。该团队还要求冗余度，即每个不同的变异体必须由 $r$ 个独立合成的供体构建体（例如，带独特分子条形码的寡核苷酸）来代表，以确保实验的随机性不会导致变异效应的检测效能不足。\n\n仅使用以下基本依据和定义：\n- 分子生物学中心法则确立了编码外显子是编码信使核糖核酸 (mRNA) 并最终编码蛋白质的DNA片段，其序列以碱基对为单位进行测量。\n- DNA字母表的基数为 $4$，在某个位置上的单核苷酸替换是将当前碱基替换为任何其他碱基，从而在每个位置产生 $4 - 1$ 种可能的替换。\n- 组合数学中的乘法法则指出，如果一个过程有 $a$ 种可能的方式发生，而另一个独立的过程有 $b$ 种可能的方式发生，那么组合过程有 $a \\times b$ 种可能的方式发生。\n\n假设没有插入、删除或多核苷酸变化，并且除了变异体及其冗余度外，不包含任何野生型对照或其他设计元件。请推导一个符号表达式，以最简闭式形式表示文库中所需的独特构建体总数，该表达式是关于 $L$ 和 $r$ 的函数。请将最终答案表示为单个解析表达式。无需四舍五入，最终表达式中不应包含任何物理单位。",
            "solution": "用户提供的问题已根据指定标准进行了分析和验证。\n\n### 第1步：提取已知条件\n- 外显子长度：$L$ 个碱基对。\n- 文库设计目标：包含外显子每个位置上所有可能的单核苷酸替换。\n- 单核苷酸替换的定义：在一个位置上将一个碱基替换为其他 $3$ 种标准DNA碱基中的任意一种。DNA字母表为 $\\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T} \\}$。\n- 冗余度：每个不同的变异体由 $r$ 个独立合成的供体构建体代表。\n- 提供的基本原理：关于编码外显子的分子生物学中心法则；DNA字母表基数为 $4$，导致每个位置有 $4-1$ 种替换；组合数学中的乘法法则。\n- 排除项：无插入、删除、多核苷酸变化、野生型对照或其他设计元件。\n- 目标：推导所需独特构建体总数的符号表达式，作为 $L$ 和 $r$ 的函数。\n\n### 第2步：使用提取的已知条件进行验证\n问题评估如下：\n- **科学依据充分**：该问题基于分子生物学、遗传学和CRISPR技术（特别是饱和基因组编辑）的既定原理。提供的关于编码外显子、单核苷酸替换和DNA字母表的定义在事实上是正确的，并且是该领域的标准。\n- **定义明确**：问题定义清晰。它提供了所有必需的参数（$L$ 和 $r$）和约束条件，以推导出文库构建体总数的唯一数学表达式。\n- **客观性**：语言精确、技术性强，且没有主观或含糊的术语。\n\n基于此评估，该问题被认为是有效且可解的。\n\n### 第3步：推导解决方案\n目标是计算针对长度为 $L$ 的外显子、冗余度为 $r$ 的饱和基因组编辑文库所需的构建体总数 $N$。\n\n1.  **确定可能的独特变异体数量。**\n    一个独特的变异体由一次单核苷酸替换定义。要确定这样一个变异体，我们必须做出两个独立的选择：\n    a.  **替换的位置：**外显子长度为 $L$ 个碱基对。因此，有 $L$ 个不同的位置可以发生替换。\n    b.  **替换核苷酸的种类：**在任何给定位置，DNA字母表包含 $4$ 种碱基。替换要求将原始碱基更改为其他碱基之一。这使得在该特定位置的新核苷酸有 $4 - 1 = 3$ 种可能的选择。\n\n2.  **应用乘法法则。**\n    问题提供了乘法法则：如果一个过程有 $a$ 种方式发生，另一个独立的过程有 $b$ 种方式发生，那么组合过程有 $a \\times b$ 种方式发生。\n    在此背景下，创建独特变异体的过程涉及选择一个位置（$L$ 种方式）和选择一种替换（$3$ 种方式）。\n    设 $V$ 为该外显子可能存在的不同单核苷酸变异体的总数。应用乘法法则：\n    $$V = (\\text{Number of positions}) \\times (\\text{Number of substitutions per position})$$\n    $$V = L \\times 3 = 3L$$\n    因此，文库中必须包含 $3L$ 个独特的变异体。\n\n3.  **整合冗余度因子。**\n    问题指出，每个不同的变异体必须由 $r$ 个独立合成的构建体代表。这种冗余度旨在通过克服实验噪声和随机性来确保对变异效应的稳健检测。\n    设 $N$ 为文库中构建体的总数。要计算 $N$，我们将不同变异体的总数 $V$ 乘以冗余度因子 $r$。\n    $$N = V \\times r$$\n    代入 $V$ 的表达式：\n    $$N = (3L) \\times r = 3Lr$$\n\n该表达式代表了文库所需的构建体总数，是外显子长度 $L$ 和冗余度因子 $r$ 的函数。它处于最简闭式形式。",
            "answer": "$$\\boxed{3Lr}$$"
        },
        {
            "introduction": "实验完成后，下一步是从测序数据中量化每个变体的功能效应，这通常通过估算其在竞争性生长环境中的选择系数来完成。在此练习中，你将应用多项式抽样模型下的最大似然估计（MLE）框架，这是统计遗传学中的一个基石方法 。通过这个过程，你不仅能学会如何将原始的测序读数转化为有生物学意义的适应度分数，还将学习如何使用费雪信息（Fisher Information）来量化我们对该估计值的置信度。",
            "id": "4329374",
            "problem": "在一项使用成簇规律间隔短回文重复序列（CRISPR）来扰动编码区中所有单核苷酸变异的汇集式饱和基因组编辑（SGE）实验中，您希望在一个竞争性生长实验下估计单个变异 $v$ 的选择系数 $s$。实验设计如下。一个单倍体细胞群体被编辑，以包含一个变异文库，其初始频率 $\\{q_i\\}_{i=1}^{K}$ 通过新一代测序（NGS）测量。然后，该群体在固定条件下繁殖，经历 $t$ 次有丝分裂倍增。繁殖后，通过NGS获得一个大小为 $N$ 个读段的选择后样本，得到计数 $\\{X_i\\}_{i=1}^{K}$，其中 $\\sum_{i=1}^{K} X_i = N$。假设采用标准乘性适应度模型，其中预期的选择后比例与 $q_i \\exp(s_i t)$ 成正比，其中 $s_i$ 是变异 $i$ 相对于参考背景（设为 $0$）的选择系数。关注单个变异 $v$，其选择系数是唯一的未知参数，记为 $s$，而所有其他变异的 $s_i = 0$。\n\n在此模型下，选择后的计数服从多项分布，其细胞概率为\n$$\np_i(s) \\propto q_i \\exp(s_i t), \\quad \\text{使得} \\quad p_v(s) = \\frac{q_v \\exp(s t)}{q_v \\exp(s t) + \\sum_{j \\neq v} q_j}, \\quad p_j(s) = \\frac{q_j}{q_v \\exp(s t) + \\sum_{\\ell \\neq v} q_\\ell} \\text{ 对 } j \\neq v \\text{ 成立}.\n$$\n设 $X_v = k$ 表示变异 $v$ 观测到的选择后计数。\n\n从多项似然的定义以及费雪信息是对数似然二阶导数的负期望的定义出发，完成以下任务：\n1. 推导 $s$ 的对数似然函数（可以忽略不依赖于 $s$ 的加法常数），并证明最大似然估计（MLE）$\\hat{s}$ 满足 $p_v(\\hat{s}) = k/N$。然后，以 $k$、$N$、$q_v$、$t$ 和 $\\sum_{j \\neq v} q_j$ 的形式求出 $\\hat{s}$ 的闭合解。\n2. 在此多项模型下，推导 $s$ 的费雪信息，并证明其可以简化为仅与 $N$、$t$ 和 $p_v(s)$ 相关的简单函数。\n3. 使用渐近正态近似，基于在 $\\hat{s}$ 处求值的费雪信息，构建一个名义覆盖率为 $1-\\alpha$ 的 $s$ 的双侧置信区间。\n\n现在，将您的推导应用于以下真实的SGE数据集：有 $K$ 个变异，其中焦点变异的初始频率为 $q_v = 10^{-3}$，所有其他变异的聚合频率为 $\\sum_{j \\neq v} q_j = 1 - q_v$。经过 $t = 10$ 次有丝分裂倍增后，选择后的读段深度为 $N = 2.0 \\times 10^{5}$，焦点变异的计数为 $k = 90$。取 $\\alpha = 0.05$ 以及相应的标准正态分位数 $\\Phi^{-1}(1 - \\alpha/2)$。\n\n请报告 $s$ 的双侧 $95\\%$ 置信区间半宽度（即从 $\\hat{s}$ 上加减的量）作为最终结果，以每代自然对数适应度为单位表示。将您的答案四舍五入至四位有效数字。",
            "solution": "### 第1步：提取已知信息\n\n问题为一项汇集式饱和基因组编辑（SGE）实验提供了以下信息：\n-   使用了单倍体细胞群体。\n-   实验涉及一个包含 $K$ 个变异的文库，其初始频率为 $\\{q_i\\}_{i=1}^{K}$。\n-   群体繁殖了 $t$ 次有丝分裂倍增。\n-   对一个包含 $N$ 个读段的选择后样本进行测序，得到计数 $\\{X_i\\}_{i=1}^{K}$，其中 $\\sum_{i=1}^{K} X_i = N$。\n-   乘性适应度模型给出的预期选择后比例与 $q_i \\exp(s_i t)$ 成正比，其中 $s_i$ 是选择系数。\n-   单个变异 $v$ 有一个未知的选择系数 $s$，而所有其他变异的 $s_i = 0$ ($i \\neq v$)。\n-   选择后的细胞概率为：\n    $$\n    p_v(s) = \\frac{q_v \\exp(s t)}{q_v \\exp(s t) + \\sum_{j \\neq v} q_j}\n    $$\n    $$\n    p_j(s) = \\frac{q_j}{q_v \\exp(s t) + \\sum_{\\ell \\neq v} q_\\ell} \\text{ 对 } j \\neq v \\text{ 成立}\n    $$\n-   变异 $v$ 的观测计数为 $X_v = k$。\n-   费雪信息定义为对数似然二阶导数的负期望。\n-   需要构建一个名义覆盖率为 $1-\\alpha$ 的双侧置信区间的渐近正态近似。\n-   用于应用的数值数据：\n    -   焦点变异的初始频率：$q_v = 10^{-3}$\n    -   其他变异的聚合初始频率：$\\sum_{j \\neq v} q_j = 1 - q_v$\n    -   倍增次数：$t = 10$\n    -   选择后总读段深度：$N = 2.0 \\times 10^{5}$\n    -   焦点变异计数：$k = 90$\n    -   显著性水平：$\\alpha = 0.05$\n    -   标准正态分位数：$\\Phi^{-1}(1 - \\alpha/2)$\n\n### 第2步：使用提取的已知信息进行验证\n\n这个问题具有科学依据。所描述的模型——竞争性生长导致频率变化，随后进行多项抽样——是遗传学和基因组学中分析汇集式CRISPR筛选和其他批量竞争实验的标准且被广泛接受的框架。最大似然估计（MLE）、费雪信息和渐近正态性的使用是统计推断中的经典方法。这个问题提法得当，提供了执行所要求的推导和计算所需的所有必要信息。语言客观而精确。数值对于深度测序实验是切合实际的。所有定义都清晰，并且设置是内部一致的。未发现任何缺陷。\n\n### 第3步：结论与行动\n\n问题有效。下面是完整的、有理有据的解答。\n\n### 解答推导\n\n$K$ 个变异的计数 $\\{X_i\\}_{i=1}^{K}$ 服从多项分布，总计数为 $N$，概率为 $\\{p_i(s)\\}_{i=1}^{K}$。似然函数由下式给出：\n$$L(s; \\{X_i\\}) = \\frac{N!}{X_1! \\dots X_K!} \\prod_{i=1}^{K} p_i(s)^{X_i}$$\n对数似然 $\\ell(s) = \\ln L(s)$ 为：\n$$\\ell(s) = \\ln(N!) - \\sum_{i=1}^{K} \\ln(X_i!) + \\sum_{i=1}^{K} X_i \\ln p_i(s)$$\n在不考虑不依赖于参数 $s$ 的加法常数的情况下，对数似然为：\n$$\\ell(s) \\propto \\sum_{i=1}^{K} X_i \\ln p_i(s) = X_v \\ln p_v(s) + \\sum_{j \\neq v} X_j \\ln p_j(s)$$\n设概率的分母为 $D(s) = q_v \\exp(st) + \\sum_{j \\neq v} q_j$。代入 $p_v(s)$ 和 $p_j(s)$ 的表达式：\n$$\\ell(s) \\propto X_v \\ln\\left(\\frac{q_v \\exp(st)}{D(s)}\\right) + \\sum_{j \\neq v} X_j \\ln\\left(\\frac{q_j}{D(s)}\\right)$$\n$$\\ell(s) \\propto X_v (\\ln(q_v) + st - \\ln D(s)) + \\sum_{j \\neq v} X_j (\\ln(q_j) - \\ln D(s))$$\n对包含 $s$ 的项进行分组：\n$$\\ell(s) \\propto X_v s t - \\left(X_v + \\sum_{j \\neq v} X_j\\right) \\ln D(s)$$\n由于 $\\sum_{i=1}^{K} X_i = N$，这可以简化为：\n$$\\ell(s) \\propto X_v s t - N \\ln(q_v \\exp(st) + \\sum_{j \\neq v} q_j)$$\n这就是 $s$ 的对数似然（忽略了加法常数），如第1部分所要求。\n\n**第1部分：最大似然估计（MLE）**\n\n为了找到MLE $\\hat{s}$，我们将 $\\ell(s)$ 对 $s$ 求导，并令结果为零。\n$$\\frac{d\\ell}{ds} = \\frac{d}{ds} \\left(X_v s t - N \\ln(q_v \\exp(st) + \\sum_{j \\neq v} q_j)\\right)$$\n$$\\frac{d\\ell}{ds} = X_v t - N \\frac{1}{q_v \\exp(st) + \\sum_{j \\neq v} q_j} \\cdot (q_v t \\exp(st))$$\n识别出 $p_v(s)$ 的定义，我们可以写成：\n$$\\frac{d\\ell}{ds} = X_v t - N t \\left(\\frac{q_v \\exp(st)}{q_v \\exp(st) + \\sum_{j \\neq v} q_j}\\right) = X_v t - N t p_v(s)$$\n$$\\frac{d\\ell}{ds} = t (X_v - N p_v(s))$$\n将导数设为零以求得MLE $\\hat{s}$：\n$$t (X_v - N p_v(\\hat{s})) = 0$$\n由于 $t > 0$，我们必须有 $X_v - N p_v(\\hat{s}) = 0$。给定观测值 $X_v=k$，这给出了MLE的条件：\n$$p_v(\\hat{s}) = \\frac{k}{N}$$\n这表明，MLE是使得模型中变异 $v$ 的概率与选择后样本中观测到的频率相匹配的值 $\\hat{s}$。\n\n现在，我们以闭合形式求解 $\\hat{s}$。令 $Q_{\\text{other}} = \\sum_{j \\neq v} q_j$。\n$$\\frac{q_v \\exp(\\hat{s} t)}{q_v \\exp(\\hat{s} t) + Q_{\\text{other}}} = \\frac{k}{N}$$\n$$N q_v \\exp(\\hat{s} t) = k (q_v \\exp(\\hat{s} t) + Q_{\\text{other}})$$\n$$N q_v \\exp(\\hat{s} t) - k q_v \\exp(\\hat{s} t) = k Q_{\\text{other}}$$\n$$(N - k) q_v \\exp(\\hat{s} t) = k Q_{\\text{other}}$$\n$$\\exp(\\hat{s} t) = \\frac{k}{(N-k)} \\frac{Q_{\\text{other}}}{q_v}$$\n对两边取自然对数，然后除以 $t$：\n$$\\hat{s} = \\frac{1}{t} \\ln\\left(\\frac{k}{N-k} \\frac{Q_{\\text{other}}}{q_v}\\right) = \\frac{1}{t} \\ln\\left(\\frac{k}{N-k} \\frac{\\sum_{j \\neq v} q_j}{q_v}\\right)$$\n\n**第2部分：费雪信息**\n\n费雪信息 $I(s)$ 定义为 $I(s) = -E\\left[\\frac{d^2\\ell}{ds^2}\\right]$。我们首先计算对数似然的二阶导数。\n$$\\frac{d^2\\ell}{ds^2} = \\frac{d}{ds} \\left( t (X_v - N p_v(s)) \\right) = -N t \\frac{dp_v(s)}{ds}$$\n我们需要计算 $p_v(s)$ 对 $s$ 的导数。使用商法则：\n$$p_v(s) = \\frac{q_v \\exp(st)}{D(s)}$$\n$$\\frac{dp_v(s)}{ds} = \\frac{(q_v t \\exp(st))D(s) - q_v \\exp(st) (q_v t \\exp(st))}{D(s)^2}$$\n$$\\frac{dp_v(s)}{ds} = \\frac{q_v t \\exp(st) (D(s) - q_v \\exp(st))}{D(s)^2}$$\n由于 $D(s) - q_v \\exp(st) = \\sum_{j \\neq v} q_j = Q_{\\text{other}}$：\n$$\\frac{dp_v(s)}{ds} = \\frac{q_v t \\exp(st) Q_{\\text{other}}}{D(s)^2} = t \\left(\\frac{q_v \\exp(st)}{D(s)}\\right) \\left(\\frac{Q_{\\text{other}}}{D(s)}\\right)$$\n认识到 $\\sum_{j \\neq v} p_j(s) = \\frac{\\sum_{j \\neq v} q_j}{D(s)} = \\frac{Q_{\\text{other}}}{D(s)}$ 且 $\\sum_{j \\neq v} p_j(s) = 1 - p_v(s)$：\n$$\\frac{dp_v(s)}{ds} = t \\cdot p_v(s) \\cdot (1-p_v(s))$$\n将此代入二阶导数的表达式中：\n$$\\frac{d^2\\ell}{ds^2} = -N t \\left(t \\cdot p_v(s) (1-p_v(s))\\right) = -N t^2 p_v(s) (1-p_v(s))$$\n二阶导数不依赖于随机变量 $X_v$，只依赖于参数 $s$（通过 $p_v(s)$）。因此，其期望就是表达式本身：\n$$E\\left[\\frac{d^2\\ell}{ds^2}\\right] = -N t^2 p_v(s) (1-p_v(s))$$\n费雪信息为：\n$$I(s) = -E\\left[\\frac{d^2\\ell}{ds^2}\\right] = N t^2 p_v(s) (1-p_v(s))$$\n这是一个关于 $N$、$t$ 和 $p_v(s)$ 的简单函数，符合要求。\n\n**第3部分：置信区间与应用**\n\nMLE的渐近理论表明，$\\hat{s}$ 近似服从正态分布，均值为 $s$，方差为 $I(s)^{-1}$。我们通过在MLE $\\hat{s}$ 处评估费雪信息来估计 $\\hat{s}$ 的标准误。\n$$\\text{SE}(\\hat{s}) = \\sqrt{I(\\hat{s})^{-1}} = \\frac{1}{\\sqrt{I(\\hat{s})}}$$\n使用第1部分的结果 $p_v(\\hat{s}) = k/N$：\n$$I(\\hat{s}) = N t^2 p_v(\\hat{s})(1 - p_v(\\hat{s})) = N t^2 \\left(\\frac{k}{N}\\right) \\left(1 - \\frac{k}{N}\\right) = N t^2 \\frac{k(N-k)}{N^2} = t^2 \\frac{k(N-k)}{N}$$\n估计的标准误为：\n$$\\text{SE}(\\hat{s}) = \\frac{1}{\\sqrt{t^2 \\frac{k(N-k)}{N}}} = \\frac{1}{t} \\sqrt{\\frac{N}{k(N-k)}}$$\n$s$ 的一个双侧 $1-\\alpha$ 置信区间由 $\\hat{s} \\pm z_{1-\\alpha/2} \\cdot \\text{SE}(\\hat{s})$ 给出，其中 $z_{1-\\alpha/2} = \\Phi^{-1}(1-\\alpha/2)$ 是标准正态分布的分位数。该区间的半宽度为：\n$$W = z_{1-\\alpha/2} \\cdot \\text{SE}(\\hat{s}) = z_{1-\\alpha/2} \\frac{1}{t} \\sqrt{\\frac{N}{k(N-k)}}$$\n\n现在我们将此应用于给定的数据：\n- $t = 10$\n- $N = 2.0 \\times 10^5$\n- $k = 90$\n- $\\alpha = 0.05$，所以 $1-\\alpha/2 = 0.975$。对应的分位数是 $z_{0.975} = \\Phi^{-1}(0.975) \\approx 1.95996$。\n\n首先，计算平方根内的项：\n$$\\frac{N}{k(N-k)} = \\frac{2.0 \\times 10^5}{90 \\times (2.0 \\times 10^5 - 90)} = \\frac{200000}{90 \\times 199910} = \\frac{200000}{17991900} \\approx 0.01111601$$\n现在，计算标准误：\n$$\\text{SE}(\\hat{s}) = \\frac{1}{10} \\sqrt{0.01111601} \\approx \\frac{1}{10} \\times 0.1054325 = 0.01054325$$\n最后，计算半宽度 $W$：\n$$W = z_{0.975} \\cdot \\text{SE}(\\hat{s}) \\approx 1.95996 \\times 0.01054325 \\approx 0.0206643$$\n四舍五入到四位有效数字，半宽度为 $0.02066$。",
            "answer": "$$\\boxed{0.02066}$$"
        },
        {
            "introduction": "真实的实验并非完美无瑕，基于CRISPR的编辑可能会引入系统性偏差，例如由DNA双链断裂本身引起的细胞毒性，这会与变体的真实效应相混淆。这个高级练习将展示如何利用线性模型和精巧的实验设计（包括匹配的野生型对照）来分离变体的真实效应与这些混杂因素 。通过构建稳健的统计模型来从实验噪声中解析出真实的生物学信号，你将掌握一项定量生物学研究中的关键技能。",
            "id": "4329401",
            "problem": "进行了一项基于文库的变异效应作图实验，该实验使用成簇规律间隔短回文重复序列 (CRISPR) 和同源指导修复 (HDR) 技术，旨在量化一个临床可操作基因中所有单核苷酸变异的适应度影响。该设计在基因座 $L$ 上平铺了 $K$ 种不同的CRISPR指导核糖核蛋白。对于每个指导 $k \\in \\{1,\\dots,K\\}$ 和每个生物学重复 $r \\in \\{1,\\dots,R\\}$，递送了两个HDR模板：一个模板引入特定的变异 $v$；另一个模板则恢复精确的野生型序列（作为匹配的切割修复对照）。经过持续时间为 $T$ 的竞争后，深度测序得出每个编辑后的等位基因在时间 $0$ 和时间 $T$ 的频率。对于每个 $(k,r)$，将变异 $v$ 的测量对数倍数变化定义为\n$$\ny_{v,k,r} \\equiv \\ln\\!\\left(\\frac{f_{v,k,r}(T)}{f_{v,k,r}(0)}\\right),\n$$\n将匹配的野生型HDR对照的测量对数倍数变化定义为\n$$\ny_{w,k,r} \\equiv \\ln\\!\\left(\\frac{f_{w,k,r}(T)}{f_{w,k,r}(0)}\\right).\n$$\n假设在一个混合竞争体系中，任何等位基因的对数频率随时间的预期变化，是变异特异性的马尔萨斯适应度效应与源于基因座 $L$ 的双链断裂（DSB）切割和重复水平漂移的共享组分之和。具体而言，假设对于每个 $(k,r)$，\n$$\ny_{v,k,r} \\;=\\; s_v\\,T \\;+\\; c_L\\,T \\;+\\; d_k\\,T \\;+\\; m_r\\,T \\;+\\; \\varepsilon_{v,k,r},\n$$\n并且\n$$\ny_{w,k,r} \\;=\\; 0\\cdot T \\;+\\; c_L\\,T \\;+\\; d_k\\,T \\;+\\; m_r\\,T \\;+\\; \\varepsilon_{w,k,r},\n$$\n其中，$s_v$ 是单位时间的真实变异特异性适应度效应，$c_L$ 是单位时间的基因座特异性切割毒性（在基因座 $L$ 的所有指导RNA中共享），$d_k$ 是单位时间的指导RNA特异性附加切割毒性，$m_r$ 是单位时间的重复水平漂移，而 $\\varepsilon_{v,k,r}$ 和 $\\varepsilon_{w,k,r}$ 是独立的零均值噪声项。对于每个 $(k,r)$，定义一个已知的逆方差权重\n$$\nw_{k,r} \\equiv \\frac{1}{\\operatorname{Var}\\!\\left(y_{v,k,r} - y_{w,k,r}\\right)},\n$$\n这反映了不同指导RNA和重复之间的异方差测量不确定性，并假设 $\\varepsilon_{v,k,r}$ 和 $\\varepsilon_{w,k,r}$ 是方差有限的高斯分布。\n\n从混合竞争中马尔萨斯适应度的定义和上述加性分解出发，通过利用匹配的HDR野生型对照和对共享组分建模，推导出一个用于真实变异特异性适应度 $s_v$ 的最小方差无偏线性估计量的单一闭式解析表达式，该表达式将变异效应与基因座特异性和指导RNA特异性的切割毒性分离开。你的最终表达式应完全用 $T$、权重 $w_{k,r}$ 以及测量量 $y_{v,k,r}$ 和 $y_{w,k,r}$ 来表示。答案应该是一个解析表达式；不要提供任何数值计算。如果你引入任何额外的符号，请精确定义它们。表达最终的单位时间适应度效应（最终表达式中无需打印单位）。无需四舍五入。",
            "solution": "问题要求推导真实变异特异性适应度效应 $s_v$ 的最小方差无偏线性估计量。这也被称为最佳线性无偏估计量（BLUE）。推导过程首先简化给定的统计模型以分离出目标参数 $s_v$，然后应用具有异方差噪声的线性模型的最优估计原理。\n\n让我们从分析所提供的对数倍数变化模型开始：\n$$\ny_{v,k,r} \\;=\\; s_v\\,T \\;+\\; c_L\\,T \\;+\\; d_k\\,T \\;+\\; m_r\\,T \\;+\\; \\varepsilon_{v,k,r}\n$$\n$$\ny_{w,k,r} \\;=\\; 0\\cdot T \\;+\\; c_L\\,T \\;+\\; d_k\\,T \\;+\\; m_r\\,T \\;+\\; \\varepsilon_{w,k,r}\n$$\n实验设计至关重要，它为每个变异测量都包含一个匹配的野生型对照。通过计算每个指导 $k$ 和重复 $r$ 中变异体与其对应的野生型对照的对数倍数变化之差，我们可以消除共享的冗余参数。让我们将这个差值定义为 $\\Delta y_{k,r}$：\n$$\n\\Delta y_{k,r} \\equiv y_{v,k,r} - y_{w,k,r}\n$$\n将给定的模型方程代入此定义中，可得：\n$$\n\\Delta y_{k,r} = (s_v\\,T \\;+\\; c_L\\,T \\;+\\; d_k\\,T \\;+\\; m_r\\,T \\;+\\; \\varepsilon_{v,k,r}) - (c_L\\,T \\;+\\; d_k\\,T \\;+\\; m_r\\,T \\;+\\; \\varepsilon_{w,k,r})\n$$\n对应于基因座特异性毒性（$c_L$）、指导RNA特异性毒性（$d_k$）和重复水平漂移（$m_r$）的项完全抵消：\n$$\n\\Delta y_{k,r} = s_v\\,T + (\\varepsilon_{v,k,r} - \\varepsilon_{w,k,r})\n$$\n让我们定义一个新的复合噪声项 $\\eta_{k,r} \\equiv \\varepsilon_{v,k,r} - \\varepsilon_{w,k,r}$。由于 $\\varepsilon_{v,k,r}$ 和 $\\varepsilon_{w,k,r}$ 是独立的且均值为零，因此新的噪声项 $\\eta_{k,r}$ 的均值也为零：\n$$\n\\mathbb{E}[\\eta_{k,r}] = \\mathbb{E}[\\varepsilon_{v,k,r}] - \\mathbb{E}[\\varepsilon_{w,k,r}] = 0 - 0 = 0\n$$\n现在，每个测量对的简化模型是：\n$$\n\\Delta y_{k,r} = s_v\\,T + \\eta_{k,r}\n$$\n异方差性问题依然存在，因为 $\\eta_{k,r}$ 的方差对于每个 $(k,r)$ 可能不同。$\\eta_{k,r}$ 的方差由 $\\operatorname{Var}(\\eta_{k,r}) = \\operatorname{Var}(\\varepsilon_{v,k,r} - \\varepsilon_{w,k,r})$ 给出。由于 epsilon 项的独立性，该方差为 $\\operatorname{Var}(\\eta_{k,r}) = \\operatorname{Var}(\\varepsilon_{v,k,r}) + \\operatorname{Var}(\\varepsilon_{w,k,r})$。\n问题给出的逆方差权重 $w_{k,r}$ 为：\n$$\nw_{k,r} \\equiv \\frac{1}{\\operatorname{Var}\\!\\left(y_{v,k,r} - y_{w,k,r}\\right)} = \\frac{1}{\\operatorname{Var}\\!\\left(\\Delta y_{k,r}\\right)}\n$$\n由于对于给定的变异体，$s_v T$ 是一个常数，所以 $\\operatorname{Var}(\\Delta y_{k,r}) = \\operatorname{Var}(s_v T + \\eta_{k,r}) = \\operatorname{Var}(\\eta_{k,r})$。因此，我们有 $\\operatorname{Var}(\\eta_{k,r}) = 1/w_{k,r}$。\n\n为了估计 $s_v$，我们可以重排简化模型。对于 $K \\times R$ 个独立测量中的每一个，我们可以构建一个关于 $s_v$ 的独立估计：\n$$\n\\frac{\\Delta y_{k,r}}{T} = s_v + \\frac{\\eta_{k,r}}{T}\n$$\n令 $Z_{k,r} \\equiv \\frac{\\Delta y_{k,r}}{T}$。则我们有 $Z_{k,r} = s_v + \\epsilon'_{k,r}$，其中 $\\epsilon'_{k,r} = \\eta_{k,r}/T$。每个 $Z_{k,r}$ 都是 $s_v$ 的一个无偏估计量，因为 $\\mathbb{E}[Z_{k,r}] = s_v + \\mathbb{E}[\\eta_{k,r}]/T = s_v$。然而，这些估计量具有不同的方差：\n$$\n\\operatorname{Var}(Z_{k,r}) = \\operatorname{Var}\\left(\\frac{\\eta_{k,r}}{T}\\right) = \\frac{1}{T^2}\\operatorname{Var}(\\eta_{k,r}) = \\frac{1}{T^2 w_{k,r}}\n$$\n$s_v$ 的最佳线性无偏估计量（BLUE）是各个独立估计量 $Z_{k,r}$ 的逆方差加权平均。这个平均值的最优权重（我们称之为 $\\alpha_{k,r}$）与每个 $Z_{k,r}$ 的方差的倒数成正比：\n$$\n\\alpha_{k,r} \\propto \\frac{1}{\\operatorname{Var}(Z_{k,r})} = T^2 w_{k,r}\n$$\n为确保最终的估计量是无偏的，这些权重之和必须为 $1$。我们对它们进行相应的归一化：\n$$\n\\alpha_{k,r} = \\frac{T^2 w_{k,r}}{\\sum_{i=1}^K \\sum_{j=1}^R T^2 w_{i,j}} = \\frac{w_{k,r}}{\\sum_{i=1}^K \\sum_{j=1}^R w_{i,j}}\n$$\n$s_v$ 的最佳线性无偏估计量（BLUE），记作 $\\hat{s}_v$，是 $Z_{k,r}$ 与这些最优权重的线性组合：\n$$\n\\hat{s}_v = \\sum_{k=1}^K \\sum_{r=1}^R \\alpha_{k,r} Z_{k,r}\n$$\n代入 $\\alpha_{k,r}$ 和 $Z_{k,r}$ 的表达式可得：\n$$\n\\hat{s}_v = \\sum_{k=1}^K \\sum_{r=1}^R \\left( \\frac{w_{k,r}}{\\sum_{i=1}^K \\sum_{j=1}^R w_{i,j}} \\right) \\left( \\frac{y_{v,k,r} - y_{w,k,r}}{T} \\right)\n$$\n通过将不依赖于求和索引 $k$ 和 $r$ 的项提取出来，该表达式可以重排成更紧凑的形式：\n$$\n\\hat{s}_v = \\frac{1}{T \\left(\\sum_{k=1}^K \\sum_{r=1}^R w_{k,r}\\right)} \\sum_{k=1}^K \\sum_{r=1}^R w_{k,r} (y_{v,k,r} - y_{w,k,r})\n$$\n这就是 $s_v$ 的最小方差无偏线性估计量的最终闭式解析表达式。它正确地结合了所有可用的测量值，并根据其已知的逆方差进行加权，从而生成该变异体适应度效应的单一、最优估计，同时对指定的混杂因素具有稳健性。",
            "answer": "$$\n\\boxed{\\frac{\\sum_{k=1}^{K} \\sum_{r=1}^{R} w_{k,r} (y_{v,k,r} - y_{w,k,r})}{T \\sum_{k=1}^{K} \\sum_{r=1}^{R} w_{k,r}}}\n$$"
        }
    ]
}