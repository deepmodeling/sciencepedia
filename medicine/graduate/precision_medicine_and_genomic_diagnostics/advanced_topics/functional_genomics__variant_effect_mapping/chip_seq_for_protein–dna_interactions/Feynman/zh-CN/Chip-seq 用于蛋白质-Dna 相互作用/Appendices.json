{
    "hands_on_practices": [
        {
            "introduction": "ChIP-seq 分析的核心是识别转录因子的结合位点。我们可以使用位置权重矩阵（Position Weight Matrix, PWM）来模拟结合偏好，并通过计算对数似然比分数来区分真实的结合事件和背景 DNA 序列。这项练习  提供了计算该分数的实践，这是任何处理转录因子结合数据的基因组学家的核心技能。",
            "id": "4321569",
            "problem": "一家临床基因组学实验室正在研究一名患者肿瘤基因组中的一个特定的六核苷酸位点是否可能被一个与免疫治疗反应相关的转录因子结合，该研究基于染色质免疫沉淀后测序 (ChIP-seq) 技术。该结合模型由一个位置权重矩阵 (PWM) 编码，该矩阵给出了在真实结合位点中，于每个位置上观测到核苷酸 $\\mathrm{A}$、$\\mathrm{C}$、$\\mathrm{G}$ 或 $\\mathrm{T}$ 的条件概率。全基因组背景核苷酸分布是非均匀的。假设在结合模型和背景模型下，各个位置之间是独立的，并使用源于结合模型与背景模型之间二元假设检验的对数似然比框架。\n\n从高置信度ChIP-seq峰估计出的转录因子PWM（长度为 $6$）如下：\n\n- 位置 $1$：$\\mathrm{A}: 0.45$，$\\mathrm{C}: 0.15$，$\\mathrm{G}: 0.10$，$\\mathrm{T}: 0.30$\n- 位置 $2$：$\\mathrm{A}: 0.10$，$\\mathrm{C}: 0.40$，$\\mathrm{G}: 0.40$，$\\mathrm{T}: 0.10$\n- 位置 $3$：$\\mathrm{A}: 0.35$，$\\mathrm{C}: 0.25$，$\\mathrm{G}: 0.15$，$\\mathrm{T}: 0.25$\n- 位置 $4$：$\\mathrm{A}: 0.05$，$\\mathrm{C}: 0.05$，$\\mathrm{G}: 0.80$，$\\mathrm{T}: 0.10$\n- 位置 $5$：$\\mathrm{A}: 0.50$，$\\mathrm{C}: 0.10$，$\\mathrm{G}: 0.30$，$\\mathrm{T}: 0.10$\n- 位置 $6$：$\\mathrm{A}: 0.20$，$\\mathrm{C}: 0.40$，$\\mathrm{G}: 0.20$，$\\mathrm{T}: 0.20$\n\n背景核苷酸分布（全基因组估计）为：\n$$\nq(\\mathrm{A}) = 0.30,\\quad q(\\mathrm{C}) = 0.20,\\quad q(\\mathrm{G}) = 0.20,\\quad q(\\mathrm{T}) = 0.30.\n$$\n\n候选基因组位点是序列 $\\mathrm{S} = \\mathrm{A}\\mathrm{C}\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{C}$，从左到右与PWM的位置 $1$ 到 $6$ 对齐。\n\n一个用于判断可能结合的经验阈值 $\\tau$，是通过受试者工作特征曲线校准选择以将假发现率 (FDR) 控制在 $0.05$ 的，其在自然对数单位下为 $\\tau = 3.5$。\n\n仅使用独立性假设下的似然性的基本定义以及作为结合模型和背景模型之间贝叶斯因子的对数似然比，计算 $\\mathrm{S}$ 的基序对数似然得分，并通过将该得分与 $\\tau$ 比较来评估 $\\mathrm{S}$ 是否可能被结合。报告两个量：\n- 对数似然比得分，以自然对数为单位，四舍五入到四位有效数字。\n- 结合指示符 $\\mathbb{I}_{\\text{bound}}$，定义为：如果得分大于或等于 $\\tau$，则为 $1$，否则为 $0$。\n\n如果您提供这两个量，请将它们写为单个矩阵中的一个双元素行。该得分没有物理单位。",
            "solution": "该问题被评估为有效。它在科学上基于生物信息学和统计基因组学的既定原则，特别是使用位置权重矩阵（PWMs）和对数似然比对DNA序列基序进行评分。这是一个适定问题，所有必要的数据（PWM、背景概率、候选序列和决策阈值）都已提供。定义清晰，目标明确。PWM中每个位置的概率以及背景分布中的概率之和为$1$，确保它们是正确的概率分布。没有矛盾、歧义或事实错误。\n\n该问题要求计算给定DNA序列的对数似然比得分，这是检验两个竞争性假设的标准方法：\n- $H_1$：序列 $S$ 由一个结合位点模型生成，该模型由位置权重矩阵（PWM）表示。\n- $H_0$：序列 $S$ 由一个背景模型生成，该模型由全基因组核苷酸频率表示。\n\n设长度为 $L=6$ 的DNA序列表示为 $S = s_1s_2...s_L$。问题陈述了对两个模型都假设核苷酸位置之间是独立的。\n\n在结合模型（$H_1$）下观测到序列 $S$ 的似然性是根据PWM在每个位置 $i$ 观测到相应核苷酸 $s_i$ 的概率的乘积。设 $P_i(b)$ 为PWM中位置 $i$ 处核苷酸 $b$ 的概率。\n$$\nL(S|H_1) = P(S|H_1) = \\prod_{i=1}^{6} P_i(s_i)\n$$\n\n在背景模型（$H_0$）下观测到序列 $S$ 的似然性是序列中每个核苷酸的背景概率的乘积。设 $q(b)$ 为核苷酸 $b$ 的背景概率。\n$$\nL(S|H_0) = P(S|H_0) = \\prod_{i=1}^{6} q(s_i)\n$$\n\n似然比（LR）是这两个似然性的比值。基于此比率的得分，通常称为对数优势比得分，是比较 $H_1$ 与 $H_0$ 证据的一种贝叶斯因子形式。\n$$\n\\text{LR}(S) = \\frac{L(S|H_1)}{L(S|H_0)} = \\frac{\\prod_{i=1}^{6} P_i(s_i)}{\\prod_{i=1}^{6} q(s_i)} = \\prod_{i=1}^{6} \\frac{P_i(s_i)}{q(s_i)}\n$$\n\n问题要求以自然对数为单位的对数似然比（LLR）得分。这通过取LR的自然对数来计算。\n$$\n\\text{LLR}(S) = \\ln(\\text{LR}(S)) = \\ln \\left( \\prod_{i=1}^{6} \\frac{P_i(s_i)}{q(s_i)} \\right) = \\sum_{i=1}^{6} \\ln \\left( \\frac{P_i(s_i)}{q(s_i)} \\right)\n$$\n\n候选序列是 $S = \\mathrm{A}\\mathrm{C}\\mathrm{A}\\mathrm{G}\\mathrm{A}\\mathrm{C}$。我们现在从给定的PWM和背景分布中提取 $S$ 中每个位置的相关概率。\n\n- 对于位置 $i=1$，$s_1=\\mathrm{A}$：$P_1(\\mathrm{A}) = 0.45$，$q(\\mathrm{A}) = 0.30$。\n- 对于位置 $i=2$，$s_2=\\mathrm{C}$：$P_2(\\mathrm{C}) = 0.40$，$q(\\mathrm{C}) = 0.20$。\n- 对于位置 $i=3$，$s_3=\\mathrm{A}$：$P_3(\\mathrm{A}) = 0.35$，$q(\\mathrm{A}) = 0.30$。\n- 对于位置 $i=4$，$s_4=\\mathrm{G}$：$P_4(\\mathrm{G}) = 0.80$，$q(\\mathrm{G}) = 0.20$。\n- 对于位置 $i=5$，$s_5=\\mathrm{A}$：$P_5(\\mathrm{A}) = 0.50$，$q(\\mathrm{A}) = 0.30$。\n- 对于位置 $i=6$，$s_6=\\mathrm{C}$：$P_6(\\mathrm{C}) = 0.40$，$q(\\mathrm{C}) = 0.20$。\n\n我们通过对每个位置的单个对数比率求和来计算LLR得分：\n$$\n\\text{LLR}(S) = \\ln\\left(\\frac{0.45}{0.30}\\right) + \\ln\\left(\\frac{0.40}{0.20}\\right) + \\ln\\left(\\frac{0.35}{0.30}\\right) + \\ln\\left(\\frac{0.80}{0.20}\\right) + \\ln\\left(\\frac{0.50}{0.30}\\right) + \\ln\\left(\\frac{0.40}{0.20}\\right)\n$$\n$$\n\\text{LLR}(S) = \\ln(1.5) + \\ln(2) + \\ln\\left(\\frac{7}{6}\\right) + \\ln(4) + \\ln\\left(\\frac{5}{3}\\right) + \\ln(2)\n$$\n使用属性 $\\ln(a) + \\ln(b) = \\ln(ab)$，我们也可以这样计算：\n$$\n\\text{LLR}(S) = \\ln\\left(1.5 \\times 2 \\times \\frac{7}{6} \\times 4 \\times \\frac{5}{3} \\times 2\\right) = \\ln\\left(3 \\times \\frac{7}{6} \\times 4 \\times \\frac{5}{3} \\times 2\\right) = \\ln\\left(\\frac{140}{3}\\right)\n$$\n数值计算对数之和：\n$$\n\\text{LLR}(S) \\approx 0.405465 + 0.693147 + 0.154151 + 1.386294 + 0.510826 + 0.693147\n$$\n$$\n\\text{LLR}(S) \\approx 3.84303\n$$\n按要求四舍五入到四位有效数字，得分为 $3.843$。\n\n第二个任务是评估该位点是否可能被结合。这通过将计算出的得分与给定的阈值 $\\tau = 3.5$ 进行比较来完成。\n结合指示符 $\\mathbb{I}_{\\text{bound}}$ 定义为：\n$$\n\\mathbb{I}_{\\text{bound}} =\n\\begin{cases}\n1  & \\text{if } \\text{LLR}(S) \\ge \\tau \\\\\n0  & \\text{if } \\text{LLR}(S) < \\tau\n\\end{cases}\n$$\n我们将计算出的得分与阈值进行比较：\n$$\n3.843 \\ge 3.5\n$$\n这个不等式成立。因此，结合指示符为 $\\mathbb{I}_{\\text{bound}} = 1$。序列 $S$ 被认为可能被该转录因子结合。\n\n需要报告的两个量是对数似然比得分（$3.843$）和结合指示符（$1$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.843 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在跨不同条件或患者定量比较蛋白质-DNA 结合时，校正技术差异对于得出准确结论至关重要。外源 spike-in 对照提供了一种稳健的归一化方法，它创建了一个标准参照物，所有样本都可以据此进行缩放。这项练习  将引导您完成从 spike-in 读数计算归一化因子的过程，这是确保差异结合分析可靠性的关键步骤。",
            "id": "4321532",
            "problem": "一个实验室正在进行染色质免疫沉淀结合高通量测序 (ChIP-seq) 来量化蛋白质-脱氧核糖核酸 (DNA) 的相互作用。在免疫沉淀 (IP) 之前，每个样本中都加入了恒定量的外源 spike-in 对照染色质。其基本假设是，对于每个样本，spike-in 比对上的读数与样本特异性的测序深度和全局 IP 产率成正比，而所有样本中 spike-in 的加入量是相同的。两个标记为样本 $\\mathrm{A}$ 和样本 $\\mathrm{B}$ 的样本，使用相同的实验方案和等量的 spike-in 加入量并行处理。比对后，样本 $\\mathrm{A}$ 的 spike-in 读数为 $1.0 \\times 10^{6}$，样本 $\\mathrm{B}$ 的 spike-in 读数为 $6.0 \\times 10^{5}$。三个峰 $p_{1}$、$p_{2}$ 和 $p_{3}$ 的原始 IP 峰读数（与宿主基因组的唯一比对）如下：对于样本 $\\mathrm{A}$，$p_{1}: 15000$，$p_{2}: 6200$，$p_{3}: 3100$；对于样本 $\\mathrm{B}$，$p_{1}: 9000$，$p_{2}: 4200$，$p_{3}: 2100$。\n\n仅使用以下基本原理：等量的 spike-in 加入量意味着观察到的 spike-in 读数反映了样本特异性的乘法缩放因子（文库大小和 IP 产率），且归一化应重缩放每个样本的读数，以使 spike-in 读数与选定的参考值相匹配。请以样本 $\\mathrm{A}$ 的 spike-in 作为参考，计算样本 $\\mathrm{A}$ 和 $\\mathrm{B}$ 的归一化缩放因子。然后应用这些缩放因子来重缩放两个样本的 IP 峰读数。\n\n请将您的最终答案以单行矩阵的形式给出，按顺序包含：样本 $\\mathrm{A}$ 的缩放因子、样本 $\\mathrm{B}$ 的缩放因子、样本 $\\mathrm{A}$ 的三个重缩放峰读数（按 $p_{1}, p_{2}, p_{3}$ 顺序）、以及样本 $\\mathrm{B}$ 的三个重缩放峰读数（按 $p_{1}, p_{2}, p_{3}$ 顺序）。所有数值需精确表达，无需四舍五入，最终答案中不应包含单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤 1：提取已知条件**\n- **样本：** 样本 $\\mathrm{A}$ 和样本 $\\mathrm{B}$。\n- **Spike-in 对照：** 每个样本中都加入恒定量的外源 spike-in 对照染色质。两个样本的加入量相同。\n- **Spike-in 读数：**\n  - 样本 $\\mathrm{A}$ ($S_A$)：$1.0 \\times 10^{6}$\n  - 样本 $\\mathrm{B}$ ($S_B$)：$6.0 \\times 10^{5}$\n- **原始 IP 峰读数：**\n  - 样本 $\\mathrm{A}$：\n    - 峰 $p_{1}^{A}$：$15000$\n    - 峰 $p_{2}^{A}$：$6200$\n    - 峰 $p_{3}^{A}$：$3100$\n  - 样本 $\\mathrm{B}$：\n    - 峰 $p_{1}^{B}$：$9000$\n    - 峰 $p_{2}^{B}$：$4200$\n    - 峰 $p_{3}^{B}$：$2100$\n- **归一化原理：** 观察到的 spike-in 读数反映了样本特异性的乘法缩放因子。归一化操作会重缩放每个样本的读数，使得 spike-in 读数与选定的参考值相匹配。\n- **归一化参考：** 样本 $\\mathrm{A}$ 的 spike-in 读数作为参考。\n- **任务：** 计算样本 $\\mathrm{A}$ 和 $\\mathrm{B}$ 的归一化缩放因子，并应用这些因子来重缩放两个样本的原始 IP 峰读数。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题在科学上是合理的。使用外源 spike-in 对照是归一化高通量测序数据（尤其是在 ChIP-seq 中）的一种标准且稳健的方法，用于校正技术差异，如免疫沉淀效率和测序深度。所述原理是该技术的基础。\n- **适定性：** 该问题是适定的。所有必要的数值数据和具体的归一化程序都已提供。目标明确陈述，可以得出一个唯一且有意义的解。\n- **客观性：** 该问题以客观、定量的语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n该问题被认为是有效的，因为它有科学依据、适定且客观。将推导解答。\n\n**解答推导**\n设 $R_{raw, i}$ 为样本 $i$ 中给定基因组区域（spike-in 对照区域或目标峰）的原始读数。该观测读数是目标 DNA 片段的真实丰度 $T_i$ 与样本特异性效率因子 $k_i$ 的乘积。因子 $k_i$ 包含了样本 $i$ 的所有乘法偏差来源，包括文库大小和免疫沉淀 (IP) 产率。\n$$R_{raw, i} = k_i T_i$$\nspike-in DNA以等量 $T_{spike}$ 添加到两个样本中。因此，观察到的 spike-in 读数 $S_A$ 和 $S_B$ 由下式给出：\n$$S_A = k_A T_{spike}$$\n$$S_B = k_B T_{spike}$$\n归一化的目的是校正不同的效率因子 $k_A$ 和 $k_B$。我们通过为每个样本计算一个归一化缩放因子 $f_i$ 来实现这一点。该因子旨在调整测量读数，使得所有样本的 spike-in 读数变得等于一个选定的参考值 $S_{ref}$。\n问题指定样本 $\\mathrm{A}$ 的 spike-in 读数作为参考。因此，$S_{ref} = S_A$。\n重缩放后的读数 $R_{norm, i}$ 是通过将原始读数乘以缩放因子得到的：\n$$R_{norm, i} = f_i R_{raw, i}$$\n对于 spike-in 读数，归一化条件是：\n$$f_A S_A = S_{ref}$$\n$$f_B S_B = S_{ref}$$\n首先，我们计算样本 $\\mathrm{A}$ 的缩放因子 $f_A$。\n$$f_A S_A = S_A$$\n这意味着参考样本的缩放因子为 $f_A = 1$。\n\n接下来，我们计算样本 $\\mathrm{B}$ 的缩放因子 $f_B$。\n$$f_B S_B = S_A$$\n$$f_B = \\frac{S_A}{S_B}$$\n代入给定值：\n$$f_B = \\frac{1.0 \\times 10^{6}}{6.0 \\times 10^{5}} = \\frac{10}{6} = \\frac{5}{3}$$\n现在，我们将这些缩放因子应用于每个样本的原始 IP 峰读数。设 $p_{i, norm}^{j}$ 为样本 $j$ 中峰 $p_i$ 的归一化读数。\n\n对于样本 $\\mathrm{A}$，其 $f_A = 1$：\n归一化读数与原始读数相同。\n- 归一化的 $p_{1}^{A} = f_A \\times p_{1}^{A} = 1 \\times 15000 = 15000$\n- 归一化的 $p_{2}^{A} = f_A \\times p_{2}^{A} = 1 \\times 6200 = 6200$\n- 归一化的 $p_{3}^{A} = f_A \\times p_{3}^{A} = 1 \\times 3100 = 3100$\n\n对于样本 $\\mathrm{B}$，其 $f_B = \\frac{5}{3}$：\n- 归一化的 $p_{1}^{B} = f_B \\times p_{1}^{B} = \\frac{5}{3} \\times 9000 = 5 \\times 3000 = 15000$\n- 归一化的 $p_{2}^{B} = f_B \\times p_{2}^{B} = \\frac{5}{3} \\times 4200 = 5 \\times 1400 = 7000$\n- 归一化的 $p_{3}^{B} = f_B \\times p_{3}^{B} = \\frac{5}{3} \\times 2100 = 5 \\times 700 = 3500$\n\n最终结果按指定顺序包含缩放因子和重缩放后的峰读数：\n1. 样本 $\\mathrm{A}$ 的缩放因子：$f_A = 1$\n2. 样本 $\\mathrm{B}$ 的缩放因子：$f_B = \\frac{5}{3}$\n3. 样本 $\\mathrm{A}$ 的重缩放峰读数：$15000$, $6200$, $3100$\n4. 样本 $\\mathrm{B}$ 的重缩放峰读数：$15000$, $7000$, $3500$\n\n这八个值将以单行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\frac{5}{3} & 15000 & 6200 & 3100 & 15000 & 7000 & 3500\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "精准基因组学的一个关键目标是预测遗传变异的功能性后果，特别是那些位于增强子等非编码区的变异。我们可以整合计算预测（变异如何改变结合基序分数）与实验证据（来自 ChIP-seq 数据的等位基因特异性结合）来进行稳健的评估。这项高级练习  要求您构建一个结合了基于 PWM 的评分和读数计数的统计分析的流程，模拟了评估调控变异的真实工作流程。",
            "id": "4321558",
            "problem": "您需要实现一个原则性的、自洽的计算流程，该流程在给定一个位置权重矩阵 (PWM) 和支持增强子内单核苷酸变异处等位基因特异性结合的染色质免疫沉淀测序 (ChIP-seq) 读数计数的情况下，评估每个变异是否可能影响转录因子结合。您的程序必须为每个测试用例生成定量输出，并提供一个整合了预测的基序亲和力变化和观察到的等位基因特异性结合证据的最终决策指标。\n\n基本依据和允许的假设：\n- 一个位置权重矩阵 (PWM) 为一个长度为 $L$ 的基序中的每个位置 $i \\in \\{1,\\dots,L\\}$ 编码了在该位置观察到核苷酸 $x \\in \\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$ 的概率 $P(x,i)$。设核苷酸 $x$ 的背景概率为 $b(x)$。\n- 在标准独立性模型下，一个序列 $s = s_1 s_2 \\dots s_L$ 由基序而非背景生成的证据由相对于背景的对数似然比分数 $S(s)$ 给出。\n- 基序窗口内位置 $k$ 处的一个单核苷酸变异将 $s_k$ 变为一个替换碱基，产生一个替换序列 $s^{\\text{alt}}$。分数的变化为 $\\Delta S = S(s^{\\text{alt}}) - S(s)$，并且在似然模型下，相对结合亲和力比率为 $\\exp(\\Delta S)$。\n- 观察到的等位基因特异性结合建模如下：对于增强子内一个杂合位点的重复实验 $j \\in \\{1,\\dots,R\\}$，设 $r_j$ 是支持参考等位基因的 ChIP-seq 读数， $a_j$ 是支持替换等位基因的读数，这些读数是覆盖该变异的读数。在无等位基因特异性结合的原假设下，每个读数的等位基因身份被视为一个独立的伯努利试验，对于任一等位基因的概率为 $p=0.5$，从而产生一个二项分布模型。重复实验是独立的，可以通过对计数求和来合并。\n- 对于较大的总计数，使用对二项分布的正态近似来计算与 $p=0.5$ 偏差的双边 $p$ 值。\n- 为量化观测数据中的效应大小，使用带有伪计数的替换等位基因与参考等位基因计数的以 2 为底的倍数变化对数。\n\n嵌入在测试套件中的输入规范：\n- 基序长度为 $L = 6$。位置权重矩阵 (PWM) $P(x,i)$ 被指定为每个位置 $i\\in\\{1,2,3,4,5,6\\}$ 上核苷酸按 $\\text{A},\\text{C},\\text{G},\\text{T}$ 顺序的概率：\n  - 位置 $1$: $[0.1, 0.7, 0.1, 0.1]$\n  - 位置 $2$: $[0.7, 0.1, 0.1, 0.1]$\n  - 位置 $3$: $[0.1, 0.7, 0.1, 0.1]$\n  - 位置 $4$: $[0.1, 0.1, 0.7, 0.1]$\n  - 位置 $5$: $[0.1, 0.1, 0.1, 0.7]$\n  - 位置 $6$: $[0.1, 0.1, 0.7, 0.1]$\n- 背景分布是均匀的，$b(\\text{A})=b(\\text{C})=b(\\text{G})=b(\\text{T})=0.25$。\n- 分数使用自然对数，将分数映射到亲和力比率使用指数函数。观测到的倍数变化使用以 2 为底的对数。\n- 计算替换等位基因与参考等位基因计数的以 2 为底的倍数变化对数时，使用伪计数 $\\alpha_{\\text{pc}}=0.5$。\n- 对等位基因特异性结合检验使用双边显著性阈值 $\\alpha = 0.01$。\n- 通过将各重复实验的计数相加来合并重复实验，然后计算检验统计量。\n\n为每个测试用例实现的具体任务：\n1. 计算参考序列 $s$ (长度为 $L$) 在 PWM 下相对于背景的基序对数似然比分数 $S(s)$。\n2. 通过将位置 $k$ (从零开始的索引) 上的碱基替换为替换核苷酸，计算替换序列 $s^{\\text{alt}}$。计算 $S(s^{\\text{alt}})$。\n3. 计算分数变化 $\\Delta S = S(s^{\\text{alt}}) - S(s)$。\n4. 计算预测的相对结合亲和力比率 $\\exp(\\Delta S)$。\n5. 对于观测数据，设 $R = \\sum_{j=1}^{R} r_j$， $A = \\sum_{j=1}^{R} a_j$，且 $N = R + A$。在原假设 $p=0.5$ 下，计算一个正态近似 $z$-统计量和相应的双边 $p$ 值。如果 $N=0$，则定义 $p$ 值为 $1$。\n6. 计算观察到的等位基因特异性效应大小为 $\\log_2\\left(\\dfrac{A + \\alpha_{\\text{pc}}}{R + \\alpha_{\\text{pc}}}\\right)$。\n7. 当且仅当双边 $p$ 值小于 $\\alpha$ 且预测变化 $\\Delta S$ 的方向与观察到的方向 $\\operatorname{sign}(A-R)$ 一致时，生成一个等于整数 $1$ 的决策指标；否则输出 $0$。\n\n测试套件：\n为以下 5 个案例提供结果。在每个案例中，参考序列 $s$ 的长度为 $L=6$，变异索引 $k$ 是从零开始的，重复实验以配对 $(r_j,a_j)$ 的形式列出：\n\n- 案例 $1$：$s=\\text{CACGTG}$，$k=3$，替换碱基 $\\text{A}$，重复实验 $\\{(40,10),(30,8)\\}$。\n- 案例 $2$：$s=\\text{TACGTG}$，$k=0$，替换碱基 $\\text{C}$，重复实验 $\\{(12,28),(15,35)\\}$。\n- 案例 $3$：$s=\\text{CACGTA}$，$k=5$，替换碱基 $\\text{G}$，重复实验 $\\{(18,20),(22,26)\\}$。\n- 案例 $4$：$s=\\text{CACGTG}$，$k=3$，替换碱基 $\\text{T}$，重复实验 $\\{(25,0),(20,0)\\}$。\n- 案例 $5$：$s=\\text{CACGTG}$，$k=2$，替换碱基 $\\text{A}$，重复实验 $\\{(1,0),(0,1)\\}$。\n\n角度单位不适用。不涉及物理单位。\n\n要求的最终输出格式：\n- 对于每个测试用例，按顺序 $[\\Delta S,\\ \\exp(\\Delta S),\\ (A/R) \\text{ 的 } \\log_2 \\text{ 倍数变化 (使用 } \\alpha_{\\text{pc}}=0.5),\\ \\text{双边 }p\\text{-值},\\ \\text{指标}]$ 计算并输出一个列表。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是对应一个测试用例的列表，例如 $[\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$。",
            "solution": "问题陈述在基因组诊断学领域提出了一个有效且定义明确的计算任务。它要求将基于序列的生物物理建模（使用位置权重矩阵）与实验数据（ChIP-seq 读数计数）的统计分析相结合，以评估单核苷酸变异对转录因子结合的功能性后果。该问题在科学上基于分子生物学和生物信息学的既定原则，在数学上和逻辑上是自洽的，并为每个测试用例提供了计算唯一解所需的所有数据和参数。\n\n以下是该计算流程的原则性、分步推导。\n\n**问题验证**\n\n**步骤 1：提取的已知条件**\n- **模型参数**：\n    - 基序长度：$L = 6$。\n    - 位置权重矩阵 (PWM) $P(x,i)$，对于 $x \\in \\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$ 和 $i \\in \\{1, \\dots, 6\\}$：\n        - 位置 $1$：$[0.1, 0.7, 0.1, 0.1]$\n        - 位置 $2$：$[0.7, 0.1, 0.1, 0.1]$\n        - 位置 $3$：$[0.1, 0.7, 0.1, 0.1]$\n        - 位置 $4$：$[0.1, 0.1, 0.7, 0.1]$\n        - 位置 $5$：$[0.1, 0.1, 0.1, 0.7]$\n        - 位置 $6$：$[0.1, 0.1, 0.7, 0.1]$\n    - 背景核苷酸概率：均匀分布，$b(\\text{A})=b(\\text{C})=b(\\text{G})=b(\\text{T})=0.25$。\n- **计算规则**：\n    - 对数似然比分数 $S(s)$ 使用自然对数。\n    - 相对结合亲和力比率为 $\\exp(\\Delta S)$。\n    - 观察到的等位基因特异性效应大小为 $\\log_2\\left(\\frac{A + \\alpha_{\\text{pc}}}{R + \\alpha_{\\text{pc}}}\\right)$，伪计数 $\\alpha_{\\text{pc}}=0.5$。\n    - 等位基因特异性结合 (ASB) 显著性使用正态近似对二项分布模型进行检验，原假设为 $p=0.5$。\n    - ASB 检验使用双边显著性阈值 $\\alpha = 0.01$。\n    - 通过对读数计数 $(r_j, a_j)$ 求和来合并重复实验。设 $R = \\sum r_j$ 和 $A = \\sum a_j$。\n    - 如果总读数 $N=R+A=0$，则 $p$ 值定义为 $1$。\n- **任务与输出**：\n    1. 计算 $S(s)$。\n    2. 计算 $S(s^{\\text{alt}})$。\n    3. 计算 $\\Delta S = S(s^{\\text{alt}}) - S(s)$。\n    4. 计算 $\\exp(\\Delta S)$。\n    5. 计算 ASB 的双边 $p$ 值。\n    6. 计算观察到的 $\\log_2$ 倍数变化。\n    7. 计算一个决策指标：如果 $p\\text{-值} < \\alpha$ 且 $\\operatorname{sign}(\\Delta S)$ 与 $\\operatorname{sign}(A-R)$ 匹配，则为 $1$，否则为 $0$。\n    - 每个案例的输出是一个列表：$[\\Delta S, \\exp(\\Delta S), \\log_2\\text{ 倍数变化}, p\\text{-值}, \\text{指标}]$。\n- **测试套件**：\n    - 案例 $1$：$s=\\text{CACGTG}$，$k=3$，替换碱基 $\\text{A}$，重复实验 $\\{(40,10),(30,8)\\}$。\n    - 案例 $2$：$s=\\text{TACGTG}$，$k=0$，替换碱基 $\\text{C}$，重复实验 $\\{(12,28),(15,35)\\}$。\n    - 案例 $3$：$s=\\text{CACGTA}$，$k=5$，替换碱基 $\\text{G}$，重复实验 $\\{(18,20),(22,26)\\}$。\n    - 案例 $4$：$s=\\text{CACGTG}$，$k=3$，替换碱基 $\\text{T}$，重复实验 $\\{(25,0),(20,0)\\}$。\n    - 案例 $5$：$s=\\text{CACGTG}$，$k=2$，替换碱基 $\\text{A}$，重复实验 $\\{(1,0),(0,1)\\}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是有效的。它有科学依据，是适定且客观的。它不包含科学或事实上的不健全之处，是可形式化且相关的，提供了完整且无矛盾的设置，描述了一个计算上可行的任务，结构良好，并且并非微不足道。它满足有效问题的所有标准。\n\n**步骤 3：结论与行动**\n问题有效。开始求解。\n\n**计算方法**\n\n该分析将结合亲和力变化的理论预测与等位基因特异性结合的经验性测量相结合。\n\n**1. 基序评分和预测的亲和力变化 ($\\Delta S$ 和 $\\exp(\\Delta S)$)**\n\n转录因子与 DNA 序列 $s = s_1s_2...s_L$ 的结合亲和力可以使用位置权重矩阵 (PWM) 进行建模。分数 $S(s)$ 表示序列由基序模型生成与由背景模型生成的对数似然比。假设位置之间相互独立，该分数为：\n$$S(s) = \\sum_{i=1}^{L} \\log \\left( \\frac{P(s_i, i)}{b(s_i)} \\right)$$\n其中 $P(s_i, i)$ 是来自 PWM 的位置 $i$ 处核苷酸 $s_i$ 的概率，$b(s_i)$ 是 $s_i$ 的背景概率。问题指定使用自然对数 ($\\log$)。\n\n单核苷酸变异将特定位置 $k$ 的参考碱基 $s_k$ 替换为替换碱基 $s_k^{\\text{alt}}$，产生一个替换序列 $s^{\\text{alt}}$。分数的变化 $\\Delta S$ 为：\n$$\\Delta S = S(s^{\\text{alt}}) - S(s) = \\left( \\sum_{i=1}^{L} \\log \\frac{P(s^{\\text{alt}}_i, i)}{b(s^{\\text{alt}}_i)} \\right) - \\left( \\sum_{i=1}^{L} \\log \\frac{P(s_i, i)}{b(s_i)} \\right)$$\n由于序列仅在位置 $k$ 处不同，求和中的所有其他项都相互抵消，剩下：\n$$\\Delta S = \\log \\left( \\frac{P(s_k^{\\text{alt}}, k)}{b(s_k^{\\text{alt}})} \\right) - \\log \\left( \\frac{P(s_k, k)}{b(s_k)} \\right)$$\n鉴于背景是均匀的，即对于所有核苷酸 $x$ 都有 $b(x) = 0.25$，这可以进一步简化为：\n$$\\Delta S = \\log(P(s_k^{\\text{alt}}, k)) - \\log(P(s_k, k))$$\n这个 $\\Delta S$ 值预测了结合能的变化。正的 $\\Delta S$ 预测替换等位基因的结合更强，而负的 $\\Delta S$ 预测结合更弱。根据生物物理模型，预测的相对结合亲和力比率为 $\\exp(\\Delta S)$。\n\n**2. 等位基因特异性结合 (ASB) 分析**\n\n差异性结合的实验证据来自杂合位点的 ChIP-seq 数据。我们检验原假设 ($H_0$)：参考等位基因和替换等位基因之间的结合没有差异。在 $H_0$ 下，一个覆盖该变异的读数有相等的概率 ($p=0.5$) 起源于携带参考等位基因的染色体或携带替换等位基因的染色体。\n\n设 $R = \\sum r_j$ 和 $A = \\sum a_j$ 分别是支持参考等位基因和替换等位基因的总读数计数，这些计数是在所有重复实验中求和得到的。信息性读数的总数是 $N = R+A$。支持一个等位基因（例如，$A$）的读数数量遵循二项分布，$A \\sim \\text{Binomial}(N, p=0.5)$。\n\n对于大的 $N$，该分布可以用均值为 $\\mu = Np = 0.5N$、标准差为 $\\sigma = \\sqrt{Np(1-p)} = \\sqrt{N(0.5)(0.5)} = 0.5\\sqrt{N}$ 的正态分布来近似。\n\n计算一个 $z$-统计量来衡量观测计数 $A$ 与其在 $H_0$ 下的期望值的偏差：\n$$z = \\frac{A - \\mu}{\\sigma} = \\frac{A - 0.5(R+A)}{0.5\\sqrt{R+A}} = \\frac{0.5A - 0.5R}{0.5\\sqrt{R+A}} = \\frac{A-R}{\\sqrt{R+A}}$$\n此表达式在 $N > 0$ 时有效。如果 $N=0$，则无可用数据，p 值定义为 $1$。双边 $p$ 值用于量化观察到至少与测量到的偏差一样极端的概率，它是根据标准正态累积分布函数 (CDF) $\\Phi(z)$ 计算的：\n$$p\\text{-value} = 2 \\times P(Z \\ge |z|) = 2 \\times (1 - \\Phi(|z|))$$\n\n**3. 观测的等位基因效应大小**\n\n为量化观测到的等位基因不平衡的幅度，我们计算了替换等位基因与参考等位基因计数的以 2 为底的倍数变化对数。一个伪计数 $\\alpha_{\\text{pc}}=0.5$ 被加到每个计数上，以稳定该比率，尤其是在其中一个计数为零时。\n$$\\text{log}_2\\text{ Fold-Change} = \\log_2\\left(\\frac{A + \\alpha_{\\text{pc}}}{R + \\alpha_{\\text{pc}}}\\right)$$\n\n**4. 综合决策指标**\n\n最终决策综合了预测模型和实验数据。一个变异当且仅当满足以下两个条件时，才被标记为对结合具有功能性影响（指标 = $1$）：\n1.  **统计显著性**：观察到的等位基因特异性结合在统计上是显著的，即 $p$ 值小于指定的阈值，$p < \\alpha = 0.01$。\n2.  **效应的一致性**：预测的结合亲和力变化方向与观察到的等位基因不平衡方向一致。如果 $\\Delta S$ 的符号与观察到的计数差异 $(A-R)$ 的符号匹配，则该条件为真。\n    - $\\Delta S > 0$（预测替换等位基因结合更强）且 $A > R$（观察到更多替换等位基因的读数）。\n    - $\\Delta S < 0$（预测替换等位基因结合更弱）且 $A < R$（观察到更少替换等位基因的读数）。\n    - $\\Delta S = 0$ 且 $A = R$。\n    在数学上，该条件为 $\\operatorname{sign}(\\Delta S) = \\operatorname{sign}(A-R)$。如果任一条件不满足，则指标设为 $0$。\n\n该流程为评估推定的调控变异的功能性后果提供了一个严谨的框架。",
            "answer": "[[-1.9459,0.1429,-1.9307,2.96e-08,1], [1.9459,7.0,-1.2091,0.000145,1], [1.9459,7.0,0.1985,0.5175,0], [-1.9459,0.1429,-6.5236,1.99e-11,1], [-1.9459,0.1429,0.0,1.0,0]]"
        }
    ]
}