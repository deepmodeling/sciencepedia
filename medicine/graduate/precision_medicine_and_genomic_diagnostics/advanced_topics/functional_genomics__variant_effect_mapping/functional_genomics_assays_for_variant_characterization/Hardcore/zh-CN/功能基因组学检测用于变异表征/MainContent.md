## 引言
在基因组时代，我们以前所未有的规模识别出海量的遗传变异，但理解这些变异的功能后果仍然是精准医学面临的核心挑战。[全基因组](@entry_id:195052)关联研究（GWAS）已将数千个位点与人类疾病联系起来，然而这些信号大多位于非编码区，其背后的生物学机制仍是巨大的谜团。为了弥合[基因型与表型](@entry_id:142682)之间的鸿沟，我们迫切需要能够系统性、高通量地评估变异功能的实验方法。功能基因组学检测正为此而生，它们通过在受控环境中精确操纵遗传序列，为我们提供了从[统计关联](@entry_id:172897)走向因果机制的关键钥匙。

本文将系统性地介绍用于变异功能表征的核心功能基因组学检测技术。在第一章“原理与机制”中，我们将深入探讨这些检测的因果推断框架，辨析MPRA、CRISPR、DMS等关键技术的设计原理与定量模型。接下来的“应用与交叉学科联系”一章将通过丰富的案例，展示这些技术如何应用于剖析分子通路、解读临床变异以及推动药物基因组学的发展。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为数据分析的实践能力。通过这三个章节的学习，读者将全面掌握[功能基因组学](@entry_id:155630)检测的理论基础与应用前景，为开展前沿的基因组学研究奠定坚实的基础。

## 原理与机制

本章旨在阐述用于变异功能表征的[功能基因组学](@entry_id:155630)检测的底层原理和核心机制。在上一章绪论的基础上，我们将深入探讨这些技术如何帮助我们从关联走向因果，并系统性地审视各类检测的设计、执行和解读。

### [功能基因组学](@entry_id:155630)的因果推断框架

[功能基因组学](@entry_id:155630)检测的核心目标是超越单纯的统计关联，探究特定基因变异与其分子表型之间的**因果关系**。为了严谨地定义这一目标，我们引入因果推断的形式化语言。在观测基因组学研究中，如全基因组关联研究 (GWAS) 或表达[数量性状](@entry_id:144946)位点 (eQTL) 研究，我们通常估计的是条件概率 $P(Y \mid X=x)$。这里，$X$ 代表一个变异的等位基因状态（例如，参考等位基因REF或备选等位基因ALT），$Y$ 代表一个分子表型（例如，基因表达水平）。这个[条件概率](@entry_id:151013)描述了在携带等位基因 $x$ 的群体中观察到表型 $Y$ 的概率。然而，这个关联可能受到许多混杂因素 $Z$ 的影响，例如[连锁不平衡 (LD)](@entry_id:156098)、[群体结构](@entry_id:148599)、细胞环境或技术批次效应。因此，$P(Y \mid X=x)$ 并不直接等同于该变异的因果效应。

相比之下，[功能基因组学](@entry_id:155630)检测旨在估计一个**干预后**的概率，即 $P(Y \mid do(X=x))$。这里的 $do(X=x)$ 算子，源于 Judea Pearl 的因果推断理论，代表一个主动的、受控的干预，即强制将系统的等位基因状态设置为 $x$，并观察其对表型 $Y$ 的影响。通过在受控的实验环境中（即固定混杂因素 $Z$）比较不同等位基因状态下的结果，我们可以分离出变异本身的因果效应。例如，我们可以计算等位基因特异性的因果效应 $\Delta = \mathbb{E}[Y \mid do(X=\text{ALT})] - \mathbb{E}[Y \mid do(X=\text{REF})]$。

因此，**功能基因组学变异表征检测**被严谨地定义为一系列实验干预，它们通过精确设定变异的等位基因状态并测量其对近端分子表型的直接影响，从而估计 $P(Y \mid do(X=x))$。这与依赖于对未经操控的群体进行关联分析的观测基因组学研究（如[eQTL作图](@entry_id:194864)）形成了本质区别 。

### 顺式调控效应的检测：从自然实验到[高通量筛选](@entry_id:271166)

基因表达的调控可分为**顺式 (cis)** 和**反式 (trans)** 两类。[顺式调控元件](@entry_id:275840)是影响同一条染色体上邻近基因表达的DNA序列（如启动子、增[强子](@entry_id:198809)），而反式调控因子（如转录因子）是可移动的分子，能够与基因组中任何位置的顺式元件结合。功能基因组学的一个主要挑战是区分这两种效应。

#### [等位基因特异性表达](@entry_id:178721)：细胞内的自然对照

在二倍体生物中，一个杂合位点的存在为我们提供了一个精巧的“自然实验”，用于识别顺式调控变异。在一个杂合子个体的细胞核内，来自父本和母本的两条同源染色体共享完全相同的反式环境——即相同浓度和活性的转录因子、[辅因子](@entry_id:137503)及其他调控蛋白。

基于这一原理，我们可以通过**[等位基因特异性表达](@entry_id:178721) (Allele-Specific Expression, ASE)** 分析来检测顺式调控效应。ASE指的是在单个杂合子样本中，测量来自同一基因座的两个不同等位基因的转录本丰度是否存在不平衡。在没有顺式调控差异的零假设下，我们预期两个等位基因的转录速率相等。这意味着，任何一个[信使RNA](@entry_id:262893) (mRNA) 分子来源于参考等位基因或备选等位基因的概率均为 $0.5$。

因此，通过对杂合样本进行RNA测序 (RNA-seq)，我们可以统计与该变异位点重叠的、能够区分等位基因来源的读段 (reads)。在零假设下，来源于参考等位基因的读段数应服从成功概率 $p=0.5$ 的二项分布。例如，假设在一个RNA-seq实验中，我们共获得了 $100$ 条能够区分等位基因的读段，其中 $n_{\mathrm{ref}} = 70$ 条来自参考等位基因，$n_{\mathrm{alt}} = 30$ 条来自备选等位基因。这个 $70:30$ 的比例显著偏离了预期的 $50:50$。通过二项检验可以计算出，观察到如此极端或更极端比例的概率极低。在排除了技术偏好（如比对偏好或基因组[拷贝数变异](@entry_id:176528)）后，这种显著的等位基因不平衡强烈地表明存在一个顺式调控变异，导致两个等位基因的转录效率不同 。

#### 大规模并行[报告基因](@entry_id:187344)检测：系统性地筛选调控元件

虽然ASE是研究内源性顺式调控的有力工具，但它受限于自然存在的杂合位点。为了系统性地、高通量地测试任何感兴趣的DNA序列（包括罕见变[异或](@entry_id:172120)合成序列）的调控功能，研究人员开发了**大规模并行报告基因检测 (Massively Parallel Reporter Assays, MPRA)**。

MPRA的核心思想是将成千上万个候选调控元件分别克隆到一个标准化的报告基因质粒上。每个质粒包含一个候选DNA序列、一个驱动基础转录的**最小启动子 (minimal promoter)**，以及一个被转录的、作为**分子条形码 (barcode)** 的独特DNA序列。这个文库被导入细胞中，通过对转录出的RNA和作为对照的输入DNA进行深度测序，我们可以通过计算每个条形码的RNA与DNA读段数的比值来量化其对应候选序列的调控活性 。

MPRA的内部有效性依赖于几个关键假设。首先，通过将RNA读段数与DNA读段数进行归一化，可以校正每个质粒在细胞群体中初始拷贝数的差异。其次，由于所有构建体共享相同的启动子和转录单元骨架，可以假设RNA的稳定性等转录后效应在不同构建体之间是恒定的。因此，测得的活性比值主要反映了候选序列本身对转录起始速率的调控能力。

然而，将MPRA的结果外推至内源性基因组环境（即外部有效性）则需要更强的假设。质粒DNA（通常是[附加体](@entry_id:182435)形式）的染色质状态、核小体排布、以及与转录因子的[化学计量关系](@entry_id:144494)，都与整合在染色体上的内源性DNA有显著差异。此外，内源性增[强子](@entry_id:198809)通常通过染色质三维结构（如染色质环）与远距离的启动子发生物理互作，而这种长程调控机制在质粒检测中是缺失的。因此，要认为MPRA的结果能够有效预测内源性功能，必须假设这些“上下文”差异不会从根本上改变不同变异调控活性的相对排序 。

### 关键检测技术及其机制辨析

#### 基于[报告基因](@entry_id:187344)的检测：MPRA vs. STARR-seq

在MPRA家族中，除了经典的MPRA，还有一种重要的变体叫做**自转录活性调控区测序 (Self-Transcribing Active Regulatory Region sequencing, STARR-seq)**。这两种技术在构建体设计和信号来源上存在根本差异，从而导致了不同的偏好性和动态范围。

- **MPRA**：如前所述，候选元件被置于启动子**上游**，其调控活性由一个独立的、位于转录本中的**条形码**来报告。信号来源于条形码的丰度。
- **STARR-seq**：候选元件被置于一个最小启动子的**下游**，直接位于转录单元内部。如果该元件具有增[强子](@entry_id:198809)活性，它会驱动自身序列的转录。信号来源于增强[子序列](@entry_id:147702)本身的丰度。

这一核心差异带来了重要后果。在MPRA中，由于候选元件的序列与被测量的条形码序列是[解耦](@entry_id:160890)的，我们可以为同一个候选元件设计多个不同的条形码。这使得我们可以通过对多个条形码的结果进行平均，来有效减小由条形码序列本身引起的随机噪声或偏好（如对[RNA稳定性](@entry_id:175712)或[逆转录](@entry_id:141572)效率的影响）。根据统计学原理，如果每个条形码引入的随机误差方差为 $\sigma_{\theta}^2$，那么通过对 $k$ 个独立条形码进行平均，估计量的方差将缩小至约 $\sigma_{\theta}^2/k$。

而在STARR-seq中，信号分子（RNA）本身就包含了候选元件的序列。这意味着，候选元件的**转录调控活性**与其序列可能引起的**转录后效应**（如影响[RNA稳定性](@entry_id:175712)、剪接或二级结构）被**混淆 (conflate)** 在了一起。一个真正的强效增[强子](@entry_id:198809)，如果其序列恰好包含一个不稳定的RNA基序，其测得的活性可能会被错误地低估。这种混淆无法通过平均来消除，可能导致测量动态范围的扩大，但这种扩大的一部分来源于噪声而非真实的调控信号，从而使结果的解读变得复杂 。

#### 基于[CRISPR](@entry_id:143814)的扰动：在内源性位点进行编辑

[CRISPR-Cas9](@entry_id:136660)系统及其衍生物为在内源性基因组上下文中研究基因功能提供了前所未有的强大工具。通过设计不同的向导RNA (sgRNA) 和改造[Cas9蛋白](@entry_id:169445)，可以实现对基因表达的多种精确调控。

- **[CRISPR干扰](@entry_id:137238) (CRISPR interference, [CRISPRi](@entry_id:137238))**：该技术使用一种催化失活的[Cas9蛋白](@entry_id:169445) ([dCas9](@entry_id:177683))，它能结合DNA但不能切割。dCas9与一个[转录抑制](@entry_id:200111)结构域（如KRAB）融合。当sgRNA引导[dCas9](@entry_id:177683)-KRAB结合到基因的[转录起始位点](@entry_id:263682) (TSS) 附近时，它会通过[空间位阻](@entry_id:156748)效应阻止转录机器的结合，并招募[组蛋白修饰](@entry_id:183079)酶形成抑制性染色质，从而**下调**[基因转录](@entry_id:155521)。这会导致mRNA水平 ($T$) 和蛋白水平 ($P$) 的降低。

- **[CRISPR激活](@entry_id:272273) (CRISPR activation, [CRISPRa](@entry_id:272273))**：该技术同样使用dCas9，但其融合的是一个或多个转录激活结构域（如VP64, VPR）。当[sgRNA](@entry_id:154544)引导dCas9-激活子结合到基因启动子上游或增[强子](@entry_id:198809)区域时，它会招募转录因子和RNA聚合酶，从而**上调**基因转录。这会导致mRNA水平 ($T$) 和蛋白水平 ($P$) 的升高。

- **[CRISPR基因敲除](@entry_id:263165) ([CRISPR](@entry_id:143814) knockout)**：该技术使用具有[核酸](@entry_id:164998)内切[酶活性](@entry_id:143847)的野生型[Cas9蛋白](@entry_id:169445)。当sgRNA引导Cas9结合到基因的编码区（通常是早期的外显子）时，Cas9会制造一个DNA双链断裂 (DSB)。在细胞中，这种断裂主要通过易错的非同源末端连接 (NHEJ) 途径进行修复，常常导致小片段的插入或删除 (indels)。如果indel的长度不是3的倍数，就会引起**[移码突变](@entry_id:138848) (frameshift mutation)**，通常会产生一个过早的[终止密码子](@entry_id:275088)，导致翻译出无功能的[截短蛋白](@entry_id:270764)或通过无义介导的mRNA降解 (NMD) 途径使mRNA被降解。最终结果是功能性蛋白 ($P$) 的**敲除**。

在典型的功能筛选实验中，这些扰动对细胞适应度 ($S$) 的影响取决于该基因的功能。如果一个基因的蛋白丰度与细胞适应度正相关，那么[CRISPRi](@entry_id:137238)和[基因敲除](@entry_id:145810)会导致适应度下降（在混合筛选中表现为[sgRNA](@entry_id:154544)丰度的负向富集，即 $S  0$），而[CRISPRa](@entry_id:272273)则会提高适应度（表现为正向富集，$S > 0$）。

### 编码变异与蛋白功能的检测

#### [深度突变扫描](@entry_id:196200)

对于编码区的变异，其影响主要体现在蛋白的稳定性、折叠或功能上。**[深度突变扫描](@entry_id:196200) (Deep Mutational Scanning, DMS)** 是表征这类变异效应的核心技术。

DMS是一种混合筛选实验，它首先构建一个包含目标基因成千上万种编码变异的文库。这些变异（如所有可能的单氨基酸替换）被引入细胞群体，每个细胞通常只携带一种变异。然后，这个细胞群体在特定的[选择压力](@entry_id:167536)下生长一段时间。通过对选择前和选择后群体中的变异文库进行深度测序，我们可以量化每种变异在选择过程中的丰度变化。

分析DMS数据的基本模型是**马尔萨斯[生长模型](@entry_id:184670)**。假设在选择期间，携带基因型 $g$ 的细胞数量 $A_g(t)$ 呈指数增长：$A_g(t) = A_g(0)\exp(m_g t)$，其中 $m_g$ 是该基因型的[马尔萨斯适应度](@entry_id:155166)参数。通过测序，我们得到选择前后每个变异的读段数 $n_{g,0}$ 和 $n_{g,t}$。

为了估计一个变异 $i$ 相对于野生型 (wt) 的选择系数 $s_i = m_i - m_{\mathrm{wt}}$，我们计算一个富集分数。可以证明，变异 $i$ 相对于野生型的对数富集比值与相对选择系数成正比：
$$
\ln\left(\frac{n_{i,t}/n_{\mathrm{wt},t}}{n_{i,0}/n_{\mathrm{wt},0}}\right) = (m_i - m_{\mathrm{wt}})t = s_i t
$$
这个“比值的比值”结构非常巧妙，因为它消除了不同时间点测序深度不一致带来的影响。因此，单位时间的选择系数可以通过以下公式估计：
$$
\hat{s}_i = \frac{1}{t} \left[ \ln\left(\frac{n_{i,t}}{n_{i,0}}\right) - \ln\left(\frac{n_{\mathrm{wt},t}}{n_{\mathrm{wt},0}}\right) \right]
$$
在实际操作中，为了避免对零取对数，通常会给所有读段数加上一个小的假计数 $\epsilon$。DMS实验成功的关键在于，每个测序读段必须能明确地与其对应的变异身份相关联，这通常通过直接测序突变区域或预先映射好的[DNA条形码](@entry_id:268758)来实现 。

### 高级主题：实验设计、偏好与定量解读

#### 实验设计中的偏好控制

高质量的功能基因组学检测要求对潜在的系统性偏好有深刻的理解和精巧的控制。以MPRA为例，主要存在三类偏好：

1.  **PCR扩增偏好**：在文库制备过程中，不同序列可能因[GC含量](@entry_id:275315)等原因被不同效率地扩增。解决方案是在任何扩增步骤之前，为每个独立的RNA或DNA分子加上一个**[唯一分子标识符](@entry_id:192673) (Unique Molecular Identifier, UMI)**。通过在数据分析时对具有相同UMI的读段进行去重，可以恢复到扩增前的原始分子数量，从而消除PCR偏好。

2.  **序列上下文偏好**：[克隆载体](@entry_id:204535)上邻近候选元件的序列（侧翼序列）本身可能具有调控活性，从而干扰测量。解决方案是将每个待测变异克隆到多个（例如 $c > 1$）不同的、标准化的侧翼序列上下文中。通过拟合线性模型，可以将变异本身的效应与上下文效应分离开来。

3.  **整合位点效应**：当使用慢病毒等载体将[报告基因](@entry_id:187344)整合到基因组中时，整合位点周围的染色质环境会极大地影响报告基因的表达，产生所谓的“位置效应”。解决方案有两种：其一，为每个候选元件使用大量（例如 $b \gg 1$）独立的条形码。每个条形码理论上对应一个独立的整合事件，通过对大量随机整合位点的活性进行平均，可以得到对位置效应不敏感的[稳健估计](@entry_id:261282)。其二，使用[位点特异性重组酶](@entry_id:184708)（如Cre-LoxP或Flp-FRT）将文库精确地整合到基因组中的一个或几个“安全港 (safe-harbor)”位点。这些位点通常被认为染色质环境相对中性且稳定，从而消除了位置效应的变异性。

此外，为了将相对活性值校准到绝对尺度，实验中通常会加入已知浓度的**外部RNA控制联盟 (ERCC)** 的RNA分子作为外参 (spike-in) 。一个能够同时量化并校正这三类偏好的优秀设计，必须综合运用UMI、多上下文设计、多条形码/定点整合以及外参标准  。

#### [遗传相互作用](@entry_id:177731)：[上位性](@entry_id:136574)

生物系统是复杂的，基因变异的影响往往不是简单相加的。当两个或多个突变的组合效应不等于它们各自效应之和时，就发生了**[上位性](@entry_id:136574) (epistasis)**。在DMS实验的框架下，上位性被定义为适应度在马尔萨斯尺度上的非加性。

考虑一个包含两个位点（1和2）的系统，我们有四种基因型：野生型(00)、两个单突变体(10, 01)和双突变体(11)。我们可以构建一个线性模型来描述它们的对数富集分数 $f_g$：
$$
f_g = \beta_0 + s_1 x_{g1} + s_2 x_{g2} + s_{12} x_{g1} x_{g2}
$$
这里，$x_{gi}$ 是[指示变量](@entry_id:266428)（突变存在为1，否则为0），$s_1$ 和 $s_2$ 是单个突变的主效应，$s_{12}$ 就是两个位点间的**上位性互作参数**。通过代数运算，可以推导出 $s_{12}$ 的表达式：
$$
s_{12} = f_{11} - f_{10} - f_{01} + f_{00}
$$
这个值量化了双突变体的实际适应度与基于单突变效应简单加和预测的适应度之间的差异。例如，在某DMS实验中，计算得到的四个基因型的富集分数分别为 $f_{00} = \ln(1.8)$, $f_{10} = \ln(1.4)$, $f_{01} = \ln(2.5)$, $f_{11} = \ln(1.68)$。那么，[上位性](@entry_id:136574)参数为 $s_{12} = \ln(1.68) - \ln(1.4) - \ln(2.5) + \ln(1.8) = \ln(0.864) \approx -0.1462$。负值表示**拮抗性上位性**，即双突变体的有害效应小于预期的加和效应 。

#### 无偏估计的形式化条件

最后，为了确保[功能基因组学](@entry_id:155630)检测的结果能够被解读为对变异效应的**[无偏估计](@entry_id:756289)**，必须满足一系列严格的统计和因果推断条件。假设我们的目标估计量 $\Delta_{v}^{\star}$ 是在目标临床细胞群体（具有上下文分布 $P_{T}(C)$）中，变异 $v$ 相对于参考等位基因的平均对数活性差异。而我们的检测估计量 $\widehat{\Delta}_{v}$ 是在检测的细胞上下文分布 $P_{A}(C)$ 下测得的。

要使得 $\mathbb{E}[\widehat{\Delta}_{v}] = \Delta_{v}^{\star}$，必须满足以下一组充分必要条件：

1.  **因果可识别性**：包括干预的一致性（构建体忠实地实现了目标变异）、稳定单元处理值假设（SUTVA，即不同构建体之间无干扰）、[可交换性](@entry_id:263314)（通过随机化设计，变异分配与潜在的混杂因素无关）和正性（目标群体中可能出现的细胞状态在检测中也必须可能出现）。
2.  **有效的测量模型**：检测读出值（如对数RNA/DNA比值）与真实的对数活性之间必须存在一个经过校准的线性关系，其斜率已知或为1，且截距在不同变异间恒定从而可以在差分中抵消。
3.  **可转移性**：这是连接实验与现实的关键。必须满足以下三者之一：(i) 检测的上下文分布与[目标分布](@entry_id:634522)完全一致，即 $P_{A}(C) = P_{T}(C)$；(ii) 变异的因果效应在不同上下文中是恒定的（效应不依赖于上下文）；或 (iii) 采用正确的统计重加权方法，将从 $P_A(C)$ 中得到的[期望值](@entry_id:150961)校正为在 $P_T(C)$ 下的[期望值](@entry_id:150961)。

违反其中任何一条，都可能导致估计量的系统性偏倚，从而做出错误的[科学推断](@entry_id:155119) 。这套严谨的框架为我们设计、分析和批判性地评估[功能基因组学](@entry_id:155630)检测提供了根本性的指导。