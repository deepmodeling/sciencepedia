{
    "hands_on_practices": [
        {
            "introduction": "过表达分析（Over-Representation Analysis, ORA）是一种基础方法，用于检验一个预先定义的基因集（如某个通路）是否在一份“显著”基因列表中富集。本练习将引导你手动完成 ORA 的核心统计检验——Fisher 精确检验。通过从头计算基于超几何分布的 $p$ 值，你将深刻理解我们如何评估在一个差异表达基因列表中观察到特定数量通路成员的统计显著性 。",
            "id": "4343610",
            "problem": "一项精准肿瘤学研究使用靶向核糖核酸测序（RNA-seq）技术，对一个包含 $N$ 个基因的特选基因面板进行分析，以识别可能涉及可干预通路的差异表达基因。考虑该面板中的一个通路基因集，其成员数量为 $K$。在实验流程中，根据指定的假发现率控制，总共有 $M$ 个基因被判定为差异表达，其中 $x$ 个基因属于该通路基因集。构建一个 $2 \\times 2$ 列联表，行表示是否差异表达（是/否），列表示是否属于通路成员（是/否）。Fisher 精确检验（FET）通过固定边缘总和并根据超几何模型量化无放回抽样，来评估通路中差异表达基因的富集情况。\n\n在一个特定的肿瘤样本中，使用一个包含 $N = 30$ 个基因的面板进行分析，一个特选通路包含其中 $K = 9$ 个基因。实验流程判定 $M = 8$ 个基因为差异表达，其中 $x = 5$ 个是该通路的成员。得到的 $2 \\times 2$ 列联表如下：\n- 差异表达-是 且 通路成员-是：$5$\n- 差异表达-是 且 通路成员-否：$3$\n- 差异表达-否 且 通路成员-是：$4$\n- 差异表达-否 且 通路成员-否：$18$\n\n从无放回抽样的基本原理和 Fisher 精确检验的条件化方法出发，计算富集的精确单侧 $p$ 值。该 $p$ 值定义为：在给定固定边缘总和的情况下，在 $M$ 个差异表达基因中观察到 $X \\geq x$ 个通路成员的概率。请展示从第一性原理出发的完整推导过程和详细的计算步骤。将最终的 $p$ 值四舍五入至四位有效数字。无需单位。",
            "solution": "问题陈述具有科学依据，表述清晰，客观且内部一致。它描述了 Fisher 精确检验在基因集富集分析中的一个标准应用，这是生物信息学和精准医学中的一项基本技术。所有必要数据均已提供，且无矛盾之处。因此，该问题是有效的，可以推导出解决方案。\n\n问题的核心是使用 Fisher 精确检验计算富集的单侧 $p$ 值。该检验适用于分析行和列的总数（边缘总和）被视为固定的列联表。其基础概率模型是超几何分布，该分布描述了从有限总体中进行无放回抽样时，抽到一定数量“成功”样本的概率。\n\n在此背景下，总体由基因面板上的 $N$ 个基因组成。“成功”事件是属于特选通路的 $K$ 个基因。我们抽取一个大小为 $M$ 的样本，代表被判定为差异表达的基因。我们想要计算在这个样本中观察到 $k$ 个通路基因的概率。\n\n观察到恰好 $k$ 次成功的超几何分布的概率质量函数由以下公式给出：\n$$\nP(X=k) = \\frac{\\binom{K}{k} \\binom{N-K}{M-k}}{\\binom{N}{M}}\n$$\n其中：\n- $N$ 是总体中的基因总数（基因面板大小）。\n- $K$ 是总体中具有目标属性的基因总数（通路成员）。\n- $M$ 是抽取的样本中的基因数量（差异表达基因）。\n- $k$ 是样本中具有目标属性的基因数量。\n\n根据问题陈述，我们已知：\n- $N = 30$\n- $K = 9$\n- $M = 8$\n- 在差异表达基因中观察到的通路成员数量为 $x = 5$。\n\n富集的单侧 $p$ 值是指在富集方向上，观察到与观测结果一样极端或更极端结果的概率。这意味着我们必须计算在给定固定边缘总和的情况下，在差异表达基因集中观察到 $x$ 个或更多通路基因的概率。数学上表示为 $P(X \\ge x)$，其中 $X$ 是表示 $M$ 个差异表达基因中通路基因数量的随机变量。\n\n对于我们的具体数值， $p$ 值为：\n$$\np = P(X \\ge 5) = \\sum_{k=5}^{\\min(K,M)} P(X=k)\n$$\n由于 $K=9$ 且 $M=8$，样本中通路基因的最大可能数量为 $\\min(9, 8) = 8$。因此，求和为：\n$$\np = P(X=5) + P(X=6) + P(X=7) + P(X=8)\n$$\n我们使用超几何公式计算每一项：\n$$\nP(X=k) = \\frac{\\binom{9}{k} \\binom{30-9}{8-k}}{\\binom{30}{8}} = \\frac{\\binom{9}{k} \\binom{21}{8-k}}{\\binom{30}{8}}\n$$\n\n首先，我们计算分母，即从 $N=30$ 个基因的面板中选择 $M=8$ 个基因的总方式数：\n$$\n\\binom{N}{M} = \\binom{30}{8} = \\frac{30!}{8!(30-8)!} = \\frac{30!}{8!22!} = \\frac{30 \\times 29 \\times 28 \\times 27 \\times 26 \\times 25 \\times 24 \\times 23}{8 \\times 7 \\times 6 \\times 5 \\times 4 \\times 3 \\times 2 \\times 1} = 5,852,925\n$$\n这是 $8$ 个差异表达基因的可能组合总数。\n\n接下来，我们计算求和中每一项的分子：\n1. 对于 $k=5$（观测结果）：\n从 $9$ 个通路基因中选择 $5$ 个，并从 $21$ 个非通路基因中选择 $3$ 个的方式数为：\n$$\n\\binom{9}{5}\\binom{21}{8-5} = \\binom{9}{5}\\binom{21}{3} = \\left(\\frac{9 \\times 8 \\times 7 \\times 6}{4 \\times 3 \\times 2 \\times 1}\\right) \\times \\left(\\frac{21 \\times 20 \\times 19}{3 \\times 2 \\times 1}\\right) = 126 \\times 1330 = 167,580\n$$\n\n2. 对于 $k=6$：\n从 $9$ 个通路基因中选择 $6$ 个，并从 $21$ 个非通路基因中选择 $2$ 个的方式数为：\n$$\n\\binom{9}{6}\\binom{21}{8-6} = \\binom{9}{3}\\binom{21}{2} = \\left(\\frac{9 \\times 8 \\times 7}{3 \\times 2 \\times 1}\\right) \\times \\left(\\frac{21 \\times 20}{2 \\times 1}\\right) = 84 \\times 210 = 17,640\n$$\n\n3. 对于 $k=7$：\n从 $9$ 个通路基因中选择 $7$ 个，并从 $21$ 个非通路基因中选择 $1$ 个的方式数为：\n$$\n\\binom{9}{7}\\binom{21}{8-7} = \\binom{9}{2}\\binom{21}{1} = \\left(\\frac{9 \\times 8}{2 \\times 1}\\right) \\times \\left(21\\right) = 36 \\times 21 = 756\n$$\n\n4. 对于 $k=8$：\n从 $9$ 个通路基因中选择 $8$ 个，并从 $21$ 个非通路基因中选择 $0$ 个的方式数为：\n$$\n\\binom{9}{8}\\binom{21}{8-8} = \\binom{9}{1}\\binom{21}{0} = \\left(9\\right) \\times \\left(1\\right) = 9\n$$\n\n现在，我们将这些计数相加，然后除以组合总数，得到 $p$ 值：\n$$\np = \\frac{167,580 + 17,640 + 756 + 9}{5,852,925} = \\frac{185,985}{5,852,925}\n$$\n进行最后的除法计算：\n$$\np \\approx 0.031776507...\n$$\n问题要求将结果四舍五入到四位有效数字。第五位有效数字是 $7$，所以我们将第四位有效数字向上取整。\n$$\np \\approx 0.03178\n$$",
            "answer": "$$\n\\boxed{0.03178}\n$$"
        },
        {
            "introduction": "在同时对数千个通路进行检验时，我们必然会由于随机机会而得到一些看似显著的结果。因此，多重检验校正是分析流程中不可或缺的一步。本练习将介绍 Benjamini-Hochberg 程序，这是一种控制假发现率（False Discovery Rate, FDR）的标准方法，对于从高通量研究的统计噪音中筛选出真实的生物学信号至关重要 。",
            "id": "4343651",
            "problem": "一个分子肿瘤委员会正在根据一项对接受了下一代测序分析的患者队列进行的基因集富集分析中得到的通路水平信号，来确定靶向治疗的优先顺序。一项竞争性富集测试为 $m$ 条不同的通路生成了原始的通路 $p$ 值。该研究计划使用Benjamini–Hochberg升阶程序，在 $\\alpha = 0.05$ 的水平上控制假发现率（FDR），并遵循其在高通量基因组学中有效性所需的常规假设（例如，各通路间的检验统计量相互独立或呈正相关）。\n\n给定以下通路列表及其原始 $p$ 值（通路名称仅为生物医学背景；对于多重检验程序而言，只有 $p$ 值是重要的）：\n\n- 同源重组：$0.019$\n- 错配修复：$0.0025$\n- 磷脂酰肌醇3-激酶–Akt (PI3K–Akt) 信号通路：$0.041$\n- 丝裂原活化蛋白激酶 (MAPK) 信号通路：$0.052$\n- 细胞周期：$0.011$\n- 肿瘤蛋白53 ($p53$) 信号通路：$0.0009$\n- 血管内皮生长因子 (VEGF) 信号通路：$0.034$\n- Janus激酶–信号转导与转录激活子 (JAK–STAT) 信号通路：$0.028$\n- 转化生长因子-β (TGF-$\\beta$) 信号通路：$0.071$\n- Wnt信号通路：$0.12$\n- Notch信号通路：$0.006$\n- Hedgehog信号通路：$0.0041$\n\n任务：\n1. 计算所有 $m$ 条通路的Benjamini–Hochberg校正 $p$ 值。\n2. 根据这些校正后的 $p$ 值，确定在FDR水平 $\\alpha = 0.05$ 时哪些通路是显著的。\n\n最终答案只需提供显著通路的数量。不要包含任何单位。除了给定 $p$ 值所隐含的精度外，不需要进行额外的四舍五入。",
            "solution": "所述问题是有效的。它提出了一个清晰、独立且有科学依据的任务，这是生物信息学和统计基因组学领域的核心问题。该问题提供了一系列来自基因集富集分析的原始 $p$ 值，并要求应用标准的Benjamini–Hochberg (BH) 程序来控制假发现率 (FDR)。这是一个定义明确的问题，其唯一正确的解可以从一个已建立的统计算法中推导出来。所有必要的数据（$p$ 值集合）和参数（FDR水平 $\\alpha$）均已提供。\n\n目标是使用BH程序，在FDR水平 $\\alpha = 0.05$ 的条件下，确定在多重比较校正后， $m$ 条被测试通路中哪些是统计显著的。通路的数量，也就是假设检验的数量，是 $m=12$。\n\nBenjamini–Hochberg程序包括以下步骤：\n\n1.  **对 $p$ 值排序**：设原始 $p$ 值为 $p_1, p_2, \\ldots, p_m$。将这些值按升序排序，记为 $p_{(1)} \\le p_{(2)} \\le \\ldots \\le p_{(m)}$。排序后的第 $i$ 个 $p$ 值 $p_{(i)}$ 的秩为 $i$。\n\n给定的原始 $p$ 值为：$0.019$、$0.0025$、$0.041$、$0.052$、$0.011$、$0.0009$、$0.034$、$0.028$、$0.071$、$0.12$、$0.006$ 和 $0.0041$。\n\n对这 $m=12$ 个值进行排序得到：\n- $p_{(1)} = 0.0009$ (肿瘤蛋白53 ($p53$) 信号通路)\n- $p_{(2)} = 0.0025$ (错配修复)\n- $p_{(3)} = 0.0041$ (Hedgehog信号通路)\n- $p_{(4)} = 0.006$ (Notch信号通路)\n- $p_{(5)} = 0.011$ (细胞周期)\n- $p_{(6)} = 0.019$ (同源重组)\n- $p_{(7)} = 0.028$ (Janus激酶–信号转导与转录激活子 (JAK–STAT) 信号通路)\n- $p_{(8)} = 0.034$ (血管内皮生长因子 (VEGF) 信号通路)\n- $p_{(9)} = 0.041$ (磷脂酰肌醇3-激酶–Akt (PI3K–Akt) 信号通路)\n- $p_{(10)} = 0.052$ (丝裂原活化蛋白激酶 (MAPK) 信号通路)\n- $p_{(11)} = 0.071$ (转化生长因子-β (TGF-$\\beta$) 信号通路)\n- $p_{(12)} = 0.12$ (Wnt信号通路)\n\n2.  **计算校正后的 $p$ 值**：对于第 $i$ 个排序后的原始 $p$ 值，其BH校正 $p$ 值（记为 $p_{adj}$）的计算要确保校正后的 $p$ 值列表是单调不减的。对于每个原始 $p$ 值 $p_{(i)}$，我们首先计算一个值 $q_{(i)} = \\frac{m \\cdot p_{(i)}}{i}$。然后通过强制单调性来找到校正后的 $p$ 值 $p_{adj,(i)}$。从最大的原始 $p$ 值开始：\n$$p_{adj,(m)} = q_{(m)} = p_{(m)}$$\n对于 $i = m-1, m-2, \\dots, 1$：\n$$p_{adj,(i)} = \\min(p_{adj,(i+1)}, q_{(i)}) = \\min\\left(p_{adj,(i+1)}, \\frac{m \\cdot p_{(i)}}{i}\\right)$$\n这等价于更简洁的公式 $p_{adj,(i)} = \\min_{j=i}^{m} \\left(\\frac{m \\cdot p_{(j)}}{j}\\right)$。\n\n让我们计算 $i=1, \\dots, 12$ 的值：\n- 对于 $i=1$：$q_{(1)} = \\frac{12 \\times 0.0009}{1} = 0.0108$\n- 对于 $i=2$：$q_{(2)} = \\frac{12 \\times 0.0025}{2} = 0.015$\n- 对于 $i=3$：$q_{(3)} = \\frac{12 \\times 0.0041}{3} = 0.0164$\n- 对于 $i=4$：$q_{(4)} = \\frac{12 \\times 0.006}{4} = 0.018$\n- 对于 $i=5$：$q_{(5)} = \\frac{12 \\times 0.011}{5} = 0.0264$\n- 对于 $i=6$：$q_{(6)} = \\frac{12 \\times 0.019}{6} = 0.038$\n- 对于 $i=7$：$q_{(7)} = \\frac{12 \\times 0.028}{7} \\approx 0.048$\n- 对于 $i=8$：$q_{(8)} = \\frac{12 \\times 0.034}{8} = 0.051$\n- 对于 $i=9$：$q_{(9)} = \\frac{12 \\times 0.041}{9} \\approx 0.05467$\n- 对于 $i=10$：$q_{(10)} = \\frac{12 \\times 0.052}{10} = 0.0624$\n- 对于 $i=11$：$q_{(11)} = \\frac{12 \\times 0.071}{11} \\approx 0.07745$\n- 对于 $i=12$：$q_{(12)} = \\frac{12 \\times 0.12}{12} = 0.12$\n\n现在我们从 $i=12$ 开始向后计算，以强制执行单调性条件：\n- $p_{adj,(12)} = q_{(12)} = 0.12$\n- $p_{adj,(11)} = \\min(p_{adj,(12)}, q_{(11)}) = \\min(0.12, 0.07745\\ldots) = 0.07745\\ldots$\n- $p_{adj,(10)} = \\min(p_{adj,(11)}, q_{(10)}) = \\min(0.07745\\ldots, 0.0624) = 0.0624$\n- $p_{adj,(9)} = \\min(p_{adj,(10)}, q_{(9)}) = \\min(0.0624, 0.05467\\ldots) = 0.05467\\ldots$\n- $p_{adj,(8)} = \\min(p_{adj,(9)}, q_{(8)}) = \\min(0.05467\\ldots, 0.051) = 0.051$\n- $p_{adj,(7)} = \\min(p_{adj,(8)}, q_{(7)}) = \\min(0.051, 0.048) = 0.048$\n- $p_{adj,(6)} = \\min(p_{adj,(7)}, q_{(6)}) = \\min(0.048, 0.038) = 0.038$\n- $p_{adj,(5)} = \\min(p_{adj,(6)}, q_{(5)}) = \\min(0.038, 0.0264) = 0.0264$\n- $p_{adj,(4)} = \\min(p_{adj,(5)}, q_{(4)}) = \\min(0.0264, 0.018) = 0.018$\n- $p_{adj,(3)} = \\min(p_{adj,(4)}, q_{(3)}) = \\min(0.018, 0.0164) = 0.0164$\n- $p_{adj,(2)} = \\min(p_{adj,(3)}, q_{(2)}) = \\min(0.0164, 0.015) = 0.015$\n- $p_{adj,(1)} = \\min(p_{adj,(2)}, q_{(1)}) = \\min(0.015, 0.0108) = 0.0108$\n\n每条通路的校正 $p$ 值为：\n- p53 信号通路 ($p=0.0009$): $p_{adj} = 0.0108$\n- 错配修复 ($p=0.0025$): $p_{adj} = 0.015$\n- Hedgehog信号通路 ($p=0.0041$): $p_{adj} = 0.0164$\n- Notch信号通路 ($p=0.006$): $p_{adj} = 0.018$\n- 细胞周期 ($p=0.011$): $p_{adj} = 0.0264$\n- 同源重组 ($p=0.019$): $p_{adj} = 0.038$\n- JAK–STAT信号通路 ($p=0.028$): $p_{adj} = 0.048$\n- VEGF信号通路 ($p=0.034$): $p_{adj} = 0.051$\n- PI3K–Akt信号通路 ($p=0.041$): $p_{adj} \\approx 0.0547$\n- MAPK信号通路 ($p=0.052$): $p_{adj} = 0.0624$\n- TGF-$\\beta$信号通路 ($p=0.071$): $p_{adj} \\approx 0.0775$\n- Wnt信号通路 ($p=0.12$): $p_{adj} = 0.12$\n\n3.  **确定显著通路**：如果一条通路的校正 $p$ 值小于或等于指定的FDR水平 $\\alpha$，则该通路被认为是显著的。这里，$\\alpha=0.05$。\n\n我们将每条通路的校正 $p$ 值与 $0.05$ 进行比较：\n- p53 信号通路: $0.0108 \\le 0.05$ (显著)\n- 错配修复: $0.015 \\le 0.05$ (显著)\n- Hedgehog信号通路: $0.0164 \\le 0.05$ (显著)\n- Notch信号通路: $0.018 \\le 0.05$ (显著)\n- 细胞周期: $0.0264 \\le 0.05$ (显著)\n- 同源重组: $0.038 \\le 0.05$ (显著)\n- JAK–STAT信号通路: $0.048 \\le 0.05$ (显著)\n- VEGF信号通路: $0.051 > 0.05$ (不显著)\n- PI3K–Akt信号通路: $0.0547 > 0.05$ (不显著)\n- MAPK信号通路: $0.0624 > 0.05$ (不显著)\n- TGF-$\\beta$信号通路: $0.0775 > 0.05$ (不显著)\n- Wnt信号通路: $0.12 > 0.05$ (不显著)\n\n通过计算满足显著性标准的通路数量，我们发现有 $7$ 条显著通路。",
            "answer": "$$\\boxed{7}$$"
        }
    ]
}