{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在阐明特征向量中心性的基本原理，该度量标准用于评估网络中节点的重要性。通过从一个简单的基因相互作用网络入手，您将亲手推导并计算一个关键基因的中心性分数，从而加深对“一个节点的价值取决于其邻居的价值”这一核心思想的理解。",
            "id": "4387242",
            "problem": "在一项关于精准医疗和基因组诊断学中使用的疾病特异性基因模块的系统生物学研究中，考虑一个由三个基因 $\\{G_{1}, G_{2}, G_{3}\\}$ 组成的小型无向基因相互作用网络，其非负相互作用强度由邻接矩阵 $A$ 捕获。假设该网络是连通的，相互作用是对称的，并且邻接矩阵具有非负项，反映了测得的功能关联（例如，共表达或蛋白质-蛋白质相互作用证据）。该矩阵为\n$$\nA=\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}.\n$$\n在疾病网络分析中使用的基于特征向量的中心性的一项核心原则是，一个基因 $G_{i}$ 的影响力（中心性）$c_{i}$ 与其邻居的影响力根据相互作用强度加权后的总和成正比。从这个比例原则和关于非负不可约矩阵的标准线性代数结果出发，推导中心性向量 $c$ 必须满足的定义关系。使用这个关系和 $A$ 的主特征向量，计算基因 $G_{2}$ 的特征向量中心性，约定中心性向量被缩放至单位欧几里得范数（平方和等于 $1$）。以简化的精确表达式形式提供您的答案，不带单位。",
            "solution": "特征向量中心性的核心原则是，一个节点 $i$ 的中心性 $c_i$ 与其邻居中心性的加权总和成正比。权重由邻接矩阵 $A$ 的项 $A_{ij}$ 给出。这可以数学化地表示为：\n$$\nc_i \\propto \\sum_{j} A_{ij} c_j\n$$\n引入一个对所有节点都相同的比例常数 $\\frac{1}{\\lambda}$，我们得到一个线性方程组：\n$$\nc_i = \\frac{1}{\\lambda} \\sum_{j} A_{ij} c_j\n$$\n这个方程组可以用矩阵形式表示。设 $c$ 为中心性列向量，$c = (c_1, c_2, c_3)^T$。该方程组变为：\n$$\nc = \\frac{1}{\\lambda} Ac\n$$\n两边乘以 $\\lambda$，我们得到中心性向量的定义关系：\n$$\nAc = \\lambda c\n$$\n这是一个标准的特征值方程，它确立了中心性向量 $c$ 是邻接矩阵 $A$ 的一个特征向量。根据Perron-Frobenius定理，对于非负不可约矩阵（如本例中的连通图邻接矩阵），存在一个唯一的最大实特征值 $\\lambda_{\\text{max}}$，其对应的特征向量（主特征向量）的所有分量均为正。这个主特征向量被用来定义中心性。\n\n接下来，我们计算给定邻接矩阵 $A$ 的特征值和主特征向量：\n$$\nA=\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}\n$$\n特征值通过求解特征方程 $\\det(A - \\lambda I) = 0$ 得到：\n$$\n\\det\\begin{pmatrix}\n-\\lambda  & 1 & 0 \\\\\n1 & -\\lambda & 1 \\\\\n0 & 1 & -\\lambda\n\\end{pmatrix} = -\\lambda(\\lambda^2 - 1) - 1(-\\lambda) = -\\lambda^3 + 2\\lambda = \\lambda(2 - \\lambda^2) = 0\n$$\n特征值为 $\\lambda = 0, \\sqrt{2}, -\\sqrt{2}$。最大特征值为 $\\lambda_{\\text{max}} = \\sqrt{2}$。\n\n现在，我们通过求解 $(A - \\sqrt{2}I)c = 0$ 来找到对应于 $\\lambda = \\sqrt{2}$ 的特征向量 $c = (c_1, c_2, c_3)^T$：\n$$\n\\begin{pmatrix}\n-\\sqrt{2} & 1 & 0 \\\\\n1 & -\\sqrt{2} & 1 \\\\\n0 & 1 & -\\sqrt{2}\n\\end{pmatrix}\n\\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了以下方程组：\n1. $-\\sqrt{2}c_1 + c_2 = 0 \\implies c_2 = \\sqrt{2}c_1$\n2. $c_2 - \\sqrt{2}c_3 = 0 \\implies c_2 = \\sqrt{2}c_3$\n\n从方程(1)和(2)可知 $c_1 = c_3$。因此，特征向量的形式为 $(k, k\\sqrt{2}, k)^T$，其中 $k$ 是一个常数。\n\n为了获得唯一的中心性向量，我们将其归一化为单位欧几里得范数，即 $c_1^2 + c_2^2 + c_3^2 = 1$：\n$$\n(k)^2 + (k\\sqrt{2})^2 + (k)^2 = 1\n$$\n$$\nk^2 + 2k^2 + k^2 = 4k^2 = 1\n$$\n$$\nk^2 = \\frac{1}{4} \\implies k = \\frac{1}{2}\n$$\n我们取正根以确保中心性分数为正。归一化后的中心性向量为：\n$$\nc = \\begin{pmatrix} 1/2 \\\\ (\\sqrt{2})/2 \\\\ 1/2 \\end{pmatrix}\n$$\n基因 $G_1$、$G_2$ 和 $G_3$ 的特征向量中心性分别为 $c_1 = \\frac{1}{2}$、$c_2 = \\frac{\\sqrt{2}}{2}$ 和 $c_3 = \\frac{1}{2}$。\n\n问题要求的是基因 $G_2$ 的特征向量中心性，即 $c_2$。\n$$\nc_2 = \\frac{\\sqrt{2}}{2}\n$$",
            "answer": "$$\\boxed{\\frac{\\sqrt{2}}{2}}$$"
        },
        {
            "introduction": "介数中心性从信息流的角度量化了节点在网络中的“桥梁”作用。本练习将引导您推导其在加权网络中的计算方法，其中边的权重代表了生物相互作用的可靠性，这在分析真实的、带有不确定性的组学数据时尤为重要。通过解决这个问题，您将学会如何处理加权图中的最短路径问题，并理解介数中心性在识别疾病通路中潜在瓶颈基因方面的应用。",
            "id": "4387192",
            "problem": "在精准医疗的疾病网络分析中，基因及其相互作用自然地被建模为图，其中节点代表分子实体（例如，基因），边则编码了从多组学数据整合中推断出的功能关系。考虑一个无向图，其中简单路径是由边连接的独特节点的序列，而最短路径是其端点之间具有最小路径长度的任何简单路径。\n\n仅从这些核心定义出发，首先推导出一个无向图中节点的介数中心性的一般表达式，该表达式用节点对之间的最短路径数量以及这些最短路径中经过焦点节点的子集来表示。您的推导必须基于这样一个定义性思想：一个节点的中介作用与其在所有其他节点对之间中介的最短路径流量的比例成正比，且不能借用任何预先给出的中心性公式。\n\n接下来，将推导扩展到加权图，其边编码了估计的相互作用可靠性。假设边权重 $w_{ij}$ 位于区间 $(0,1]$ 内，并表示在给定疾病背景下，某个相互作用具有功能相关性的估计概率（或可靠性）。使用广泛采用的变换 $l_{ij} = -\\ln(w_{ij})$ 将可靠性转换为可加的非负边长，形式化地说明在加权情况下，最短路径计算和最短路径多重性的计数如何变化。简要解释为什么这种变换适用于沿路径的乘性可靠性。\n\n最后，考虑节点集 $\\{G_1,G_2,G_3,G_4\\}$ 上的以下无向加权疾病模块，其中仅有的边及其可靠性如下：\n- $(G_1,G_2)$，可靠性为 $w_{12} = \\exp(-0.3)$，\n- $(G_1,G_3)$，可靠性为 $w_{13} = \\exp(-0.4)$，\n- $(G_2,G_3)$，可靠性为 $w_{23} = \\exp(-0.2)$，\n- $(G_3,G_4)$，可靠性为 $w_{34} = \\exp(-0.5)$，\n- $(G_2,G_4)$，可靠性为 $w_{24} = \\exp(-0.7)$。\n\n不存在其他边。使用对所有无序节点对 $\\{s,t\\}$ 的求和，计算基因 $G_3$ 的未归一化介数中心性。",
            "solution": "### 第1部分：介数中心性的推导\n\n介数中心性 $C_B(v)$ 量化了节点 $v$ 在网络中作为“桥梁”的重要性。其核心思想是，一个节点的重要性取决于它在多大程度上位于其他节点对之间的最短通信路径上。\n\n令 $V$ 为图的节点集。对于任意两个节点 $s, t \\in V$，令 $\\sigma_{st}$ 为从 $s$ 到 $t$ 的最短路径的总数。令 $\\sigma_{st}(v)$ 为从 $s$ 到 $t$ 的最短路径中经过节点 $v$ 的路径数量。\n\n对于一对特定的节点 $\\{s, t\\}$（其中 $s \\neq v, t \\neq v$），流经 $v$ 的信息量可以被认为是 $\\frac{\\sigma_{st}(v)}{\\sigma_{st}}$。为了得到节点 $v$ 的总介数中心性，我们将它对所有其他节点对的贡献相加。为避免重复计数，我们对所有无序节点对 $\\{s,t\\}$ 进行求和。因此，节点 $v$ 的未归一化介数中心性 $C_B(v)$ 的表达式为：\n$$\nC_B(v) = \\sum_{s \\neq v \\neq t \\in V, s < t} \\frac{\\sigma_{st}(v)}{\\sigma_{st}}\n$$\n其中 $s < t$ 是一种表示对无序对求和的约定。\n\n### 第2部分：加权图的扩展\n\n在加权图中，边的权重代表了某种成本或距离。在我们的例子中，可靠性 $w_{ij} \\in (0, 1]$ 是一个乘性度量：一条路径的整体可靠性是路径上所有边的可靠性之积。为了使用适用于可加成本（如距离）的最短路径算法（如Dijkstra算法），我们需要将乘性的可靠性转换为可加的“长度”。\n\n对数变换 $l_{ij} = -\\ln(w_{ij})$ 能完美实现这一点。因为 $w_{ij} \\in (0, 1]$，所以 $l_{ij} \\ge 0$。一条路径 $P$ 的总长度 $L(P)$ 就是路径上所有边长之和：$L(P) = \\sum_{(i,j) \\in P} l_{ij}$。这对应于路径总可靠性 $W(P) = \\prod_{(i,j) \\in P} w_{ij}$ 的对数：\n$$\nL(P) = \\sum_{(i,j) \\in P} -\\ln(w_{ij}) = -\\ln\\left(\\prod_{(i,j) \\in P} w_{ij}\\right) = -\\ln(W(P))\n$$\n由于负对数函数是单调递减的，最小化路径长度 $L(P)$ 等价于最大化路径可靠性 $W(P)$。因此，我们可以使用标准的寻路算法在由边长 $l_{ij}$ 定义的图上找到“最短路径”，这些路径即对应于原始网络中“最可靠的路径”。最短路径的数量 $\\sigma_{st}$ 和经过特定节点的数量 $\\sigma_{st}(v)$ 的计算方法保持不变，只是现在基于加权路径长度。\n\n### 第3部分：计算基因 $G_3$ 的介数中心性\n\n首先，我们将给定的可靠性权重 $w_{ij}$ 转换为边长 $l_{ij} = -\\ln(w_{ij})$：\n- $l_{12} = -\\ln(\\exp(-0.3)) = 0.3$\n- $l_{13} = -\\ln(\\exp(-0.4)) = 0.4$\n- $l_{23} = -\\ln(\\exp(-0.2)) = 0.2$\n- $l_{34} = -\\ln(\\exp(-0.5)) = 0.5$\n- $l_{24} = -\\ln(\\exp(-0.7)) = 0.7$\n\n接下来，我们计算所有不包含 $G_3$ 的节点对之间的最短路径，并检查 $G_3$ 在其中扮演的角色。这些节点对为 $\\{G_1, G_2\\}, \\{G_1, G_4\\}, \\{G_2, G_4\\}$。\n\n1.  **节点对 $\\{G_1, G_2\\}$**:\n    - 路径 $G_1-G_2$ (直接): 长度 = $l_{12} = 0.3$.\n    - 路径 $G_1-G_3-G_2$: 长度 = $l_{13} + l_{23} = 0.4 + 0.2 = 0.6$.\n    - 最短路径是 $G_1-G_2$，长度为 0.3。$\\sigma_{12} = 1$。\n    - 该路径不经过 $G_3$，所以 $\\sigma_{12}(G_3) = 0$。对 $C_B(G_3)$ 的贡献为 $0/1 = 0$。\n\n2.  **节点对 $\\{G_1, G_4\\}$**:\n    - 路径 $G_1-G_3-G_4$: 长度 = $l_{13} + l_{34} = 0.4 + 0.5 = 0.9$.\n    - 路径 $G_1-G_2-G_4$: 长度 = $l_{12} + l_{24} = 0.3 + 0.7 = 1.0$.\n    - 路径 $G_1-G_2-G_3-G_4$: 长度 = $l_{12} + l_{23} + l_{34} = 0.3 + 0.2 + 0.5 = 1.0$.\n    - 最短路径是 $G_1-G_3-G_4$，长度为 0.9。$\\sigma_{14} = 1$。\n    - 该路径经过 $G_3$，所以 $\\sigma_{14}(G_3) = 1$。对 $C_B(G_3)$ 的贡献为 $1/1 = 1$。\n\n3.  **节点对 $\\{G_2, G_4\\}$**:\n    - 路径 $G_2-G_4$ (直接): 长度 = $l_{24} = 0.7$.\n    - 路径 $G_2-G_3-G_4$: 长度 = $l_{23} + l_{34} = 0.2 + 0.5 = 0.7$.\n    - 路径 $G_2-G_1-G_3-G_4$: 长度 = $l_{12} + l_{13} + l_{34} = 0.3 + 0.4 + 0.5 = 1.2$.\n    - 有两条最短路径，$G_2-G_4$ 和 $G_2-G_3-G_4$，长度均为 0.7。$\\sigma_{24} = 2$。\n    - 其中一条路径 ($G_2-G_3-G_4$) 经过 $G_3$，所以 $\\sigma_{24}(G_3) = 1$。对 $C_B(G_3)$ 的贡献为 $1/2 = 0.5$。\n\n最后，我们将所有贡献相加得到 $G_3$ 的未归一化介数中心性：\n$$\nC_B(G_3) = \\frac{\\sigma_{12}(G_3)}{\\sigma_{12}} + \\frac{\\sigma_{14}(G_3)}{\\sigma_{14}} + \\frac{\\sigma_{24}(G_3)}{\\sigma_{24}} = 0 + 1 + 0.5 = 1.5\n$$",
            "answer": "$$\\boxed{1.500}$$"
        },
        {
            "introduction": "图卷积网络（GCN）将深度学习的强大能力扩展到了图结构数据，为系统生物学提供了前沿的分析工具。本练习要求您从基本原理出发，构建一个标准的GCN层，并理解其对称归一化在处理生物网络中度异质性（如枢纽基因）时的关键作用。通过在一个具体的基因网络上应用您所推导的公式，您将体验到GCN如何通过聚合邻域信息来学习功能相关的基因表征。",
            "id": "4387216",
            "problem": "考虑一个用于精准医疗和基因组诊断的疾病-基因相互作用网络，其中每个节点代表一个基因，一条无向边代表一个与疾病表型相关的已验证的功能性相互作用。设该网络为一个简单的无向图，其邻接矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，度矩阵为 $D \\in \\mathbb{R}^{n \\times n}$，定义为 $D_{ii} = \\sum_{j} A_{ij}$。节点信号 $H^{(l)} \\in \\mathbb{R}^{n \\times f}$ 在第 $l$ 层为每个基因持有 $f$ 个特征。一个图卷积网络 (GCN) 层是一个局部的、排列等变的线性算子，后跟一个逐点非线性函数 $\\sigma(\\cdot)$，作用于 $H^{(l)}$ 和一个可训练的权重矩阵 $W^{(l)} \\in \\mathbb{R}^{f \\times g}$，以产生 $H^{(l+1)} \\in \\mathbb{R}^{n \\times g}$。从以下基本原则出发：\n- 局部性和沿边传播：消息只能沿着已存在的边和自环传递。\n- 排列等变性：通过任何排列对节点重新索引不会改变算子的函数形式。\n- 稳定性和对称性：线性传播算子应相对于适当的内积是自伴的，以避免度引起的偏差。\n- 度归一化：应重新缩放消息的幅度，以减轻中心基因不成比例的影响，并避免在异构连接性中出现幅度爆炸或消失。\n- 自身信息保留：每个节点在每一步都应保留其自身信号的一部分。\n使用带自环的邻接矩阵 $\\tilde{A} = A + I$ 及其对应的度矩阵 $\\tilde{D}$，推导一个满足上述属性的图卷积层，并将其表示为一个作用于 $H^{(l)}$ 和 $W^{(l)}$ 的闭式算子，后跟 $\\sigma(\\cdot)$。从生物学角度解释为什么所选的归一化方法能够解决疾病网络中由中心节点主导的信号问题。\n\n然后，将您推导的层应用于以下具体示例。考虑 $n=3$ 个标记为 $G_{1}, G_{2}, G_{3}$ 的基因，它们之间有无向边 $\\{(G_{1},G_{2}), (G_{2},G_{3})\\}$，并在所有节点上包含自环。因此，不带自环的邻接矩阵为\n$$\nA=\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix},\n$$\n带自环的邻接矩阵为 $\\tilde{A}=A+I$。设特征维度为 $f=1$，下一层的维度为 $g=1$，并对该层使用恒等激活函数 $\\sigma(x)=x$。设输入特征为\n$$\nH^{(l)}=\\begin{pmatrix}1.0\\\\ -2.0\\\\ 0.5\\end{pmatrix},\n$$\n标量权重为 $W^{(l)}=2.5$。使用您推导的算子，计算一层之后节点 $G_{2}$ 的特征更新值。将您的答案四舍五入到四位有效数字。不需要单位。",
            "solution": "### GCN层的推导\n\n图卷积层通过聚合每个节点局部邻域的信息来更新其特征表示。我们将根据给定的原则构建这个算子。\n\n1.  **局部聚合与自身信息**：最简单的局部聚合是求和邻居节点的特征，在矩阵形式下为 $A H^{(l)}$。为了保留自身信息，我们使用带自环的邻接矩阵 $\\tilde{A} = A + I$。传播规则变为 $\\tilde{A} H^{(l)}$。\n2.  **可学习变换与排列等变性**：为了使模型可学习，我们引入权重矩阵 $W^{(l)}$，将聚合后的特征进行线性变换。传播和变换结合为 $\\tilde{A} H^{(l)} W^{(l)}$。此形式满足排列等变性。\n3.  **度归一化、稳定性和对称性**：$\\tilde{A}$ 算子会导致高阶（中心）节点的信号被放大。为避免信号爆炸或消失，需要归一化。一种稳定且对称的归一化方法是使用算子 $S = \\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2}$，其中 $\\tilde{D}$ 是 $\\tilde{A}$ 的度矩阵。此算子对来自高阶节点和去往高阶节点的消息都进行了缩放。\n\n结合所有原则，并应用非线性激活函数 $\\sigma(\\cdot)$，我们得到标准GCN层的更新规则：\n$$ H^{(l+1)} = \\sigma\\left( \\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2} H^{(l)} W^{(l)} \\right) $$\n\n**生物学解释**：在基因网络中，一些“中心基因”具有极高的连接度。若无归一化，它们的信号将主导邻居节点的特征更新。对称归一化 $S = \\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2}$ 通过因子 $1/\\sqrt{\\tilde{d}_i \\tilde{d}_j}$ 来缩放从基因 $j$ 到基因 $i$ 的消息。这既降低了来自中心基因 $j$（$\\tilde{d}_j$大）的信号强度，也减弱了中心基因 $i$（$\\tilde{d}_i$大）接收到的聚合信号的总幅度。这种平衡的聚合使得模型能够从中心基因和连接较少的基因中稳健地学习，从而获得对疾病机制更全面的理解。\n\n### 应用于具体示例\n\n我们需要计算节点 $G_2$ 的更新后特征值。更新规则为 $H^{(l+1)} = \\sigma(S H^{(l)} W^{(l)})$，其中 $S = \\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2}$。\n\n1.  **计算 $\\tilde{A}$ 和 $\\tilde{D}$**：\n    $$ \\tilde{A} = A + I = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} $$\n    $\\tilde{A}$ 的对角线度为 $\\tilde{d}_1=2, \\tilde{d}_2=3, \\tilde{d}_3=2$。因此，\n    $$ \\tilde{D} = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  2 \\end{pmatrix} \\quad \\text{且} \\quad \\tilde{D}^{-1/2} = \\begin{pmatrix} 1/\\sqrt{2}  0  0 \\\\ 0  1/\\sqrt{3}  0 \\\\ 0  0  1/\\sqrt{2} \\end{pmatrix} $$\n\n2.  **计算传播矩阵 $S$**：\n    $$ S = \\tilde{D}^{-1/2} \\tilde{A} \\tilde{D}^{-1/2} = \\begin{pmatrix} 1/\\sqrt{2}  0  0 \\\\ 0  1/\\sqrt{3}  0 \\\\ 0  0  1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} 1  1  0 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{2}  0  0 \\\\ 0  1/\\sqrt{3}  0 \\\\ 0  0  1/\\sqrt{2} \\end{pmatrix} $$\n    $$ S = \\begin{pmatrix} 1/2 & 1/\\sqrt{6} & 0 \\\\ 1/\\sqrt{6} & 1/3 & 1/\\sqrt{6} \\\\ 0 & 1/\\sqrt{6} & 1/2 \\end{pmatrix} $$\n\n3.  **计算节点 $G_2$ 的特征更新**：\n    我们计算 $H^{(l+1)} = S H^{(l)} W^{(l)}$ 的第二行元素，其中 $\\sigma(x)=x$。\n    $$ (H^{(l+1)})_2 = (S_{21} H_1^{(l)} + S_{22} H_2^{(l)} + S_{23} H_3^{(l)}) \\times W^{(l)} $$\n    $$ (H^{(l+1)})_2 = \\left(\\frac{1}{\\sqrt{6}} \\times 1.0 + \\frac{1}{3} \\times (-2.0) + \\frac{1}{\\sqrt{6}} \\times 0.5\\right) \\times 2.5 $$\n    $$ (H^{(l+1)})_2 = \\left(\\frac{1.5}{\\sqrt{6}} - \\frac{2}{3}\\right) \\times 2.5 $$\n    数值计算：\n    $$ (H^{(l+1)})_2 \\approx (0.612372 - 0.666667) \\times 2.5 $$\n    $$ (H^{(l+1)})_2 \\approx (-0.054295) \\times 2.5 = -0.1357375 $$\n    四舍五入到四位有效数字，结果为 $-0.1357$。",
            "answer": "$$\\boxed{-0.1357}$$"
        }
    ]
}