{
    "hands_on_practices": [
        {
            "introduction": "单倍型定相始于解读单个测序读段提供的证据。本练习将演示如何应用贝叶斯定理，利用多个长读段及其 Phred 质量分数来定量权衡证据，从而计算特定相位构型（即顺式 `cis` 或反式 `trans`）的后验概率。这项实践旨在巩固支撑现代定相工具的统计推断基本原理 ()。",
            "id": "4388611",
            "problem": "同一基因内的两个单核苷酸变异 (SNVs) 相距 $2$ 千碱基 (kb)。三个独立的长读长分子都跨越了这两个SNV，并且每个分子都提供了一个读长层面的定相结果（一致性 (concordant) 表示两个变异在同一单倍型上，不一致性 (discordant) 表示它们在相对的单倍型上）。其中一个读长为不一致性，其Phred质量分数 $Q=20$；另外两个读长为一致性，其Phred质量分数均为 $Q=30$。假设每个读长的定相错误概率遵循Phred定义 $p_{\\mathrm{err}}=10^{-Q/10}$，各分子间的读长错误是独立的，并且在这些分子的 $2$ kb 范围内没有读长内部的转换错误。设先验概率为 $P(\\text{cis})=\\frac{1}{2}$ 和 $P(\\text{trans})=\\frac{1}{2}$。利用贝叶斯法则和这些假设，计算在这三个读长的条件下，两个SNV为顺式构型（cis）的后验概率。请用小数表示最终答案，并四舍五入到四位有效数字。",
            "solution": "首先对问题进行验证，以确保其科学上成立、定义明确且客观。\n\n### 步骤 1：提取已知条件\n- 两个单核苷酸变异 (SNVs) 相距 $2$ 千碱基 (kb)。\n- 有三个独立的长读长分子跨越了这两个SNV。\n- 读长1为不一致性，Phred质量分数为 $Q=20$。\n- 读长2为一致性，Phred质量分数为 $Q=30$。\n- 读长3为一致性，Phred质量分数为 $Q=30$。\n- 一致性读长表示两个变异在同一单倍型上。这对应于 `顺式` (cis) 构型。\n- 不一致性读长表示两个变异在相对的单倍型上。这对应于 `反式` (trans) 构型。\n- 每个读长的定相错误概率由Phred分数定义为 $p_{\\mathrm{err}}=10^{-Q/10}$。\n- 各分子间的读长错误是独立的。\n- 在 $2$ kb 的距离内没有读长内部的转换错误。\n- 给定的先验概率为 $P(\\text{cis})=\\frac{1}{2}$ 和 $P(\\text{trans})=\\frac{1}{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上是成立的，使用了基因组学和生物信息学中的标准概念，如SNV、单倍型定相、长读长测序和Phred质量分数。贝叶斯法则的应用是该领域进行统计推断的标准方法。错误概率模型是Phred分数定义的直接且正确的应用。诸如读长独立、在指定距离内无转换错误等假设是合理的简化，使得问题定义明确。问题的陈述是客观的，提供了所有必要的数值和定义。没有矛盾、歧义或事实上的不健全之处。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。有必要提供完整解答。\n\n### 解题推导\n目标是根据这三个读长的数据，计算两个SNV处于 `顺式` (cis) 构型的后验概率。设 $H_{\\text{cis}}$ 为真实构型为 `顺式` (cis) 的假设， $H_{\\text{trans}}$ 为真实构型为 `反式` (trans) 的假设。设 $D$ 代表从三个读长观测到的数据。我们要求解 $P(H_{\\text{cis}} | D)$。\n\n根据贝叶斯定理：\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}}) P(H_{\\text{cis}})}{P(D)}$$\n项 $P(D)$ 是证据的总概率，由全概率公式给出：\n$$P(D) = P(D | H_{\\text{cis}}) P(H_{\\text{cis}}) + P(D | H_{\\text{trans}}) P(H_{\\text{trans}})$$\n将此代入贝叶斯公式可得：\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}}) P(H_{\\text{cis}})}{P(D | H_{\\text{cis}}) P(H_{\\text{cis}}) + P(D | H_{\\text{trans}}) P(H_{\\text{trans}})}$$\n问题陈述先验概率相等：$P(H_{\\text{cis}}) = P(H_{\\text{trans}}) = \\frac{1}{2}$。这些项可以消去，将方程简化为似然比：\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}})}{P(D | H_{\\text{cis}}) + P(D | H_{\\text{trans}})}$$\n接下来，我们必须计算似然 $P(D | H_{\\text{cis}})$ 和 $P(D | H_{\\text{trans}})$。数据 $D$ 由三个独立的读长观测组成：\n- $R_1$：不一致性， $Q_1 = 20$\n- $R_2$：一致性， $Q_2 = 30$\n- $R_3$：一致性， $Q_3 = 30$\n\n每个读长的定相错误概率由 $p_{\\mathrm{err}} = 10^{-Q/10}$ 给出。\n- 对于 $R_1$：$p_{\\mathrm{err},1} = 10^{-20/10} = 10^{-2} = 0.01$。正确定相的概率为 $1 - p_{\\mathrm{err},1} = 0.99$。\n- 对于 $R_2$ 和 $R_3$：$p_{\\mathrm{err},2} = p_{\\mathrm{err},3} = 10^{-30/10} = 10^{-3} = 0.001$。正确定相的概率为 $1 - p_{\\mathrm{err},2} = 1-p_{\\mathrm{err},3} = 0.999$。\n\n在给定假设下数据的似然是每个独立观测概率的乘积。\n\n1.  **$H_{\\text{cis}}$ 的似然：**\n    如果真实构型为 `顺式` (cis)，则一致性读长是正确观测，不一致性读长是错误观测。\n    - $P(R_1=\\text{discordant} | H_{\\text{cis}}) = p_{\\mathrm{err},1}$ (错误)\n    - $P(R_2=\\text{concordant} | H_{\\text{cis}}) = 1 - p_{\\mathrm{err},2}$ (正确)\n    - $P(R_3=\\text{concordant} | H_{\\text{cis}}) = 1 - p_{\\mathrm{err},3}$ (正确)\n    因此，似然为：\n    $$P(D | H_{\\text{cis}}) = p_{\\mathrm{err},1} \\times (1 - p_{\\mathrm{err},2}) \\times (1 - p_{\\mathrm{err},3})$$\n    $$P(D | H_{\\text{cis}}) = 0.01 \\times (0.999) \\times (0.999) = 0.01 \\times (0.999)^2 = 0.01 \\times 0.998001 = 0.00998001$$\n\n2.  **$H_{\\text{trans}}$ 的似然：**\n    如果真实构型为 `反式` (trans)，则不一致性读长是正确观测，一致性读长是错误观测。\n    - $P(R_1=\\text{discordant} | H_{\\text{trans}}) = 1 - p_{\\mathrm{err},1}$ (正确)\n    - $P(R_2=\\text{concordant} | H_{\\text{trans}}) = p_{\\mathrm{err},2}$ (错误)\n    - $P(R_3=\\text{concordant} | H_{\\text{trans}}) = p_{\\mathrm{err},3}$ (错误)\n    因此，似然为：\n    $$P(D | H_{\\text{trans}}) = (1 - p_{\\mathrm{err},1}) \\times p_{\\mathrm{err},2} \\times p_{\\mathrm{err},3}$$\n    $$P(D | H_{\\text{trans}}) = (0.99) \\times 0.001 \\times 0.001 = 0.99 \\times (0.001)^2 = 0.99 \\times 0.000001 = 0.00000099$$\n\n现在，我们将这些似然值代入后验概率公式：\n$$P(H_{\\text{cis}} | D) = \\frac{P(D | H_{\\text{cis}})}{P(D | H_{\\text{cis}}) + P(D | H_{\\text{trans}})} = \\frac{0.00998001}{0.00998001 + 0.00000099}$$\n$$P(H_{\\text{cis}} | D) = \\frac{0.00998001}{0.009981} \\approx 0.99990081154$$\n\n问题要求答案四舍五入到四位有效数字。\n$$P(H_{\\text{cis}} | D) \\approx 0.9999$$",
            "answer": "$$\\boxed{0.9999}$$"
        },
        {
            "introduction": "虽然单个读段能提供局部证据，但要组装出完整的单倍型则需要一个全局性的策略。本练习介绍了一种强大的算法模型，它将单倍型定相问题转化为寻找加权图中的最小割（minimum cut）。通过根据测序质量数据计算边权重并找出最优分区，您将深入理解复杂的定相问题是如何通过计算方法解决的 ()。",
            "id": "4388626",
            "problem": "在用于精准医疗和基因组诊断的基于图的单倍型定相中，相邻的杂合单核苷酸变异通过对一个图进行分区来被分组到两个单倍型中。该图的顶点代表变异，边则编码了基于测序读段（read）的证据，表明特定的变异对共定相于同一条染色体上。考虑一个与药物基因组学相关的基因中的四个杂合变异，标记为 $A$、$B$、$C$ 和 $D$。存在边 $(A,B)$、$(B,C)$ 和 $(C,D)$，每条边都由两个独立的、跨越相应变异对的双末端测序读段支持。假设根据正交的定相信息，已知变异 $A$ 位于单倍型 $H_1$ 上，而变异 $D$ 位于单倍型 $H_2$ 上，并且切割一条边 $(i,j)$ 对应于将 $i$ 和 $j$ 放置在不同的单倍型上，从而与跨越 $(i,j)$ 的测序读段相矛盾。\n\n使用以下基本依据：\n- Phred碱基质量定义：对于任何质量评分为 $Q$ 的碱基检出，其检出错误的概率为 $p_{\\text{err}} = 10^{-Q/10}$。\n- 一个读段内不同位置以及不同读段之间的碱基检出错误是相互独立的。\n- 独立事件的似然原理：如果多个独立事件必须同时出错才能解释一个矛盾，那么其组合概率是它们各自概率的乘积，而负对数似然是可加的。\n\n对于每个跨越变异 $i$ 和 $j$ 的读段 $k$，将 $p_{i}^{(k)}$ 和 $p_{j}^{(k)}$ 定义为分别在与 $i$ 和 $j$ 重叠的碱基上的错误概率，这些概率由提供的Phred分数得出。将读段 $k$ 对于 $(i,j)$ 的相同单倍型断言是错误的概率，建模为该读段中两个碱基检出至少有一个是错误的事件。对于 $i$ 和 $j$ 处的两个独立碱基检出错误事件，这个并集的概率是 $p_{i}^{(k)} + p_{j}^{(k)} - p_{i}^{(k)} p_{j}^{(k)}$。对于一条由多个读段支持的边 $(i,j)$，将其切割惩罚权重定义为所有支持读段同时产生误导的概率的负自然对数。在独立性假设下，这等于每个读段产生误导的概率的负自然对数之和。\n\n跨越每条边的两个读段的Phred质量分数如下：\n- 边 $(A,B)$: 读段 $1$ 的质量分数为 $(Q_{A}, Q_{B}) = (30, 30)$; 读段 $2$ 的质量分数为 $(Q_{A}, Q_{B}) = (40, 35)$。\n- 边 $(B,C)$: 读段 $1$ 的质量分数为 $(Q_{B}, Q_{C}) = (30, 20)$; 读段 $2$ 的质量分数为 $(Q_{B}, Q_{C}) = (35, 25)$。\n- 边 $(C,D)$: 读段 $1$ 的质量分数为 $(Q_{C}, Q_{D}) = (25, 35)$; 读段 $2$ 的质量分数为 $(Q_{C}, Q_{D}) = (30, 40)$。\n\n计算此图的最小权重切割值，约束条件是 $A$ 和 $D$ 位于不同的单倍型上，并报告最小切割的值（即跨越分区的边的权重之和）。将最终的切割权重表示为一个无量纲的量，并将您的答案四舍五入到四位有效数字。此外，在您的推导中，解释上述定义的边权重如何反映测序读段中的碱基质量，以及为什么更高质量的证据会导致更大的切割惩罚。",
            "solution": "该问题具有科学依据，提法明确且客观。它提出了一个用于单倍型定相的标准模型（尽管有所简化），该模型在图上使用最小割公式，这是计算基因组学中一种有效且广泛使用的技术。所有必要的数据和定义都已提供，没有内部矛盾或科学上不合理的假设。因此，该问题被认为是有效的，并将提供解决方案。\n\n问题要求计算一个代表四个杂合变异 $A$、$B$、$C$ 和 $D$ 的图的最小权重切割。该图由顶点 $\\{A, B, C, D\\}$ 和边 $(A,B)$、$(B,C)$、$(C,D)$ 组成，形成一条线性路径。我们给定的约束条件是变异 $A$ 位于单倍型 $H_1$ 上，变异 $D$ 位于单倍型 $H_2$ 上。一次切割对应于将顶点划分为两个集合，每个单倍型一个，其权重是连接 $H_1$ 中的顶点和 $H_2$ 中的顶点的所有边的权重之和。我们寻求使这个总权重最小化的分区。\n\n首先，我们必须计算每条边的权重。一条边 $(i, j)$ 的权重，记为 $w(i,j)$，被定义为所有支持读段同时产生误导的概率的负自然对数。这是每个读段的负对数似然之和。\n对于跨越变异 $i$ 和 $j$ 的单个读段 $k$，其碱基检出错误概率为 $p_{i}^{(k)}$ 和 $p_{j}^{(k)}$，该读段产生误导（即两个碱基检出中至少有一个不正确）的概率由下式给出：\n$$P_k(\\text{misleading}) = p_{i}^{(k)} + p_{j}^{(k)} - p_{i}^{(k)} p_{j}^{(k)}$$\n错误概率 $p$ 是根据 Phred 质量分数 $Q$ 使用公式 $p = 10^{-Q/10}$ 得出的。\n由 $N$ 个读段支持的边的权重为：\n$$w(i,j) = \\sum_{k=1}^{N} \\left[ -\\ln\\left( P_k(\\text{misleading}) \\right) \\right]$$\n\n现在，我们计算三条边中每一条的权重。\n\n1.  **边 $(A,B)$**\n    - 读段 $1$: $(Q_A, Q_B) = (30, 30)$。\n      $p_A^{(1)} = 10^{-30/10} = 10^{-3}$。\n      $p_B^{(1)} = 10^{-30/10} = 10^{-3}$。\n      $P_1(\\text{misleading}) = 10^{-3} + 10^{-3} - (10^{-3})(10^{-3}) = 2 \\times 10^{-3} - 10^{-6} = 0.001999$。\n      权重贡献为 $w_1 = -\\ln(0.001999) \\approx 6.215108$。\n    - 读段 $2$: $(Q_A, Q_B) = (40, 35)$。\n      $p_A^{(2)} = 10^{-40/10} = 10^{-4}$。\n      $p_B^{(2)} = 10^{-35/10} = 10^{-3.5}$。\n      $P_2(\\text{misleading}) = 10^{-4} + 10^{-3.5} - (10^{-4})(10^{-3.5}) = 10^{-4} + 10^{-3.5} - 10^{-7.5} \\approx 0.000416196$。\n      权重贡献为 $w_2 = -\\ln(10^{-4} + 10^{-3.5} - 10^{-7.5}) \\approx 7.785233$。\n    - 边 $(A,B)$ 的总权重：\n      $$w(A,B) = w_1 + w_2 \\approx 6.215108 + 7.785233 = 14.000341$$\n\n2.  **边 $(B,C)$**\n    - 读段 $1$: $(Q_B, Q_C) = (30, 20)$。\n      $p_B^{(1)} = 10^{-30/10} = 10^{-3}$。\n      $p_C^{(1)} = 10^{-20/10} = 10^{-2}$。\n      $P_1(\\text{misleading}) = 10^{-3} + 10^{-2} - (10^{-3})(10^{-2}) = 1.1 \\times 10^{-2} - 10^{-5} = 0.01099$。\n      权重贡献为 $w_1 = -\\ln(0.01099) \\approx 4.510858$。\n    - 读段 $2$: $(Q_B, Q_C) = (35, 25)$。\n      $p_B^{(2)} = 10^{-35/10} = 10^{-3.5}$。\n      $p_C^{(2)} = 10^{-25/10} = 10^{-2.5}$。\n      $P_2(\\text{misleading}) = 10^{-3.5} + 10^{-2.5} - (10^{-3.5})(10^{-2.5}) = 10^{-3.5} + 10^{-2.5} - 10^{-6} \\approx 0.003477505$。\n      权重贡献为 $w_2 = -\\ln(10^{-3.5} + 10^{-2.5} - 10^{-6}) \\approx 5.661642$。\n    - 边 $(B,C)$ 的总权重：\n      $$w(B,C) = w_1 + w_2 \\approx 4.510858 + 5.661642 = 10.172500$$\n\n3.  **边 $(C,D)$**\n    - 读段 $1$: $(Q_C, Q_D) = (25, 35)$。\n      $p_C^{(1)} = 10^{-25/10} = 10^{-2.5}$。\n      $p_D^{(1)} = 10^{-35/10} = 10^{-3.5}$。\n      $P_1(\\text{misleading}) = 10^{-2.5} + 10^{-3.5} - (10^{-2.5})(10^{-3.5}) = 10^{-2.5} + 10^{-3.5} - 10^{-6} \\approx 0.003477505$。\n      权重贡献为 $w_1 = -\\ln(10^{-2.5} + 10^{-3.5} - 10^{-6}) \\approx 5.661642$。\n    - 读段 $2$: $(Q_C, Q_D) = (30, 40)$。\n      $p_C^{(2)} = 10^{-30/10} = 10^{-3}$。\n      $p_D^{(2)} = 10^{-40/10} = 10^{-4}$。\n      $P_2(\\text{misleading}) = 10^{-3} + 10^{-4} - (10^{-3})(10^{-4}) = 1.1 \\times 10^{-3} - 10^{-7} = 0.0010999$。\n      权重贡献为 $w_2 = -\\ln(0.0010999) \\approx 6.812403$。\n    - 边 $(C,D)$ 的总权重：\n      $$w(C,D) = w_1 + w_2 \\approx 5.661642 + 6.812403 = 12.474045$$\n\n问题是将顶点 $\\{A, B, C, D\\}$ 划分为两个集合 $H_1$ 和 $H_2$，使得 $A \\in H_1$，$D \\in H_2$，并且连接这两个集合的边的权重之和最小化。$B$ 和 $C$ 的分配决定了分区。有四种可能性：\n1.  $B \\in H_1$, $C \\in H_1$。分区为 $\\{A, B, C\\} | \\{D\\}$。唯一的切割边是 $(C,D)$。总权重 = $w(C,D) \\approx 12.47$。\n2.  $B \\in H_1$, $C \\in H_2$。分区为 $\\{A, B\\} | \\{C, D\\}$。唯一的切割边是 $(B,C)$。总权重 = $w(B,C) \\approx 10.17$。\n3.  $B \\in H_2$, $C \\in H_2$。分区为 $\\{A\\} | \\{B, C, D\\}$。唯一的切割边是 $(A,B)$。总权重 = $w(A,B) \\approx 14.00$。\n4.  $B \\in H_2$, $C \\in H_1$。分区为 $\\{A, C\\} | \\{B, D\\}$。集合之间的路径是 $A \\to B$ 和 $C \\to B$。切割边是 $(A,B)$、$(B,C)$ 和 $(C,D)$。总权重 = $w(A,B) + w(B,C) + w(C,D) \\approx 14.00 + 10.17 + 12.47 = 36.64$。\n\n比较四个总切割权重：\n$$ \\min(12.474045, 10.172500, 14.000341, 36.646886) = 10.172500 $$\n最小权重切割值约为 $10.1725$。这对应于 $A$ 和 $B$ 在单倍型 $H_1$ 上，$C$ 和 $D$ 在单倍型 $H_2$ 上的分区。\n\n边权重直接反映了碱基质量。更高的 Phred 质量分数 $Q$ 对应于指数级更低的碱基检出错误概率 $p = 10^{-Q/10}$。一个读段产生误导的概率 $P(\\text{misleading})$ 是这些错误概率的函数。对于高质量的读段，$p$ 非常小，使得 $P(\\text{misleading})$ 也非常小。边权重是这个概率的负自然对数，$w = -\\ln(P(\\text{misleading}))$。由于 $-\\ln(x)$ 对于 $x>0$ 是一个单调递减函数，一个更小的错误概率（更高质量的证据）会导致一个更大的权重。因此，更大的权重表示两个变异在同一条染色体上的证据更强，因此，切割该边（代表与该证据相矛盾）的惩罚也更大。\n\n将最小切割值四舍五入到四位有效数字得到 $10.17$。",
            "answer": "$$\\boxed{10.17}$$"
        },
        {
            "introduction": "在预测出单倍型之后，评估其准确性是至关重要的一步。本练习将介绍转换错误（switch error），这是评估定相算法性能的一个基本指标。通过将预测的单倍型与已知的“金标准”进行比较，您将学会如何量化定相错误并计算转换错误率，这是基因组学研究中的一个关键基准 ()。",
            "id": "4388681",
            "problem": "一个临床研究团队正在验证一个药物基因组学基因区域内的单倍型定相，该区域跨越一个包含$10$个单核苷酸多态性（SNP）的区块。每个SNP都是双等位基因的，并且对于该样本是杂合的，等位基因被编码为$0$或$1$。在每个位置上定义了两个单倍型，对应于两条同源染色体。该区块的真实单倍型$H^{T}_{1}$和$H^{T}_{2}$是从基于三联体（trio-based）的基准真相（ground truth）中得知的。一个算法预测了同一区块的单倍型$H^{P}_{1}$和$H^{P}_{2}$。\n\n使用以下数据：\n- 真实单倍型：\n$$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0), \\quad H^{T}_{2} = (0, 1, 0, 0, 1, 1, 0, 1, 0, 1)。$$\n- 预测单倍型：\n$$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0), \\quad H^{P}_{2} = (0, 1, 1, 0, 0, 1, 0, 0, 1, 1)。$$\n\n使用的定义：\n1. 在SNP $i$处的单倍型定相为每条同源染色体分配等位基因；对于双等位基因杂合位点，对所有$i$，$H^{T}_{1}[i] \\neq H^{T}_{2}[i]$和$H^{P}_{1}[i] \\neq H^{P}_{2}[i]$都成立。\n2. 如果在位置$i$处将$H^{P}_{1}$与$\\{H^{T}_{1}, H^{T}_{2}\\}$中的一个对齐的映射与在位置$i+1$处的映射不同，则在相邻的SNP $i$和$i+1$之间发生转换错误。形式上，定义一个序列$s_{i} \\in \\{+1,-1\\}$，其中如果$H^{P}_{1}[i] = H^{T}_{1}[i]$，则$s_{i} = +1$；如果$H^{P}_{1}[i] = H^{T}_{2}[i]$，则$s_{i} = -1$。当$s_{i+1} \\neq s_{i}$时，计为一个转换错误。\n3. 转换错误计数是在这个$10$-SNP区块中，满足$s_{i+1} \\neq s_{i}$的索引$i \\in \\{1,\\dots,9\\}$的总数。\n4. 转换错误率是转换错误计数除以相邻杂合SNP对的数量，对于$10$个杂合SNP，该数量等于$9$。将该率表示为小数分数。\n\n计算预测单倍型相对于真实单倍型的转换错误计数和转换错误率。将转换错误率四舍五入到$4$位有效数字。将最终比率表示为小数分数（不要使用百分号）。以两个值的形式提供最终答案：首先是整数形式的转换错误计数，其次是四舍五入后的转换错误率。",
            "solution": "用户要求计算一组预测单倍型相对于一个已知真实集合的转换错误计数和转换错误率。\n\n首先，对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n-   区块中的SNP数量：$10$。\n-   所有SNP都是双等位基因且杂合的。\n-   等位基因编码：$0$或$1$。\n-   真实单倍型：$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0)$ 和 $H^{T}_{2} = (0, 1, 0, 0, 1, 1, 0, 1, 0, 1)$。\n-   预测单倍型：$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0)$ 和 $H^{P}_{2} = (0, 1, 1, 0, 0, 1, 0, 0, 1, 1)$。\n-   杂合位点的定义：对于所有SNP索引$i$，$H^{T}_{1}[i] \\neq H^{T}_{2}[i]$ 和 $H^{P}_{1}[i] \\neq H^{P}_{2}[i]$。\n-   对齐序列$s_{i}$的定义：如果$H^{P}_{1}[i] = H^{T}_{1}[i]$，则$s_{i} = +1$；如果$H^{P}_{1}[i] = H^{T}_{2}[i]$，则$s_{i} = -1$。\n-   转换错误的定义：如果在相邻的SNP $i$和$i+1$之间$s_{i+1} \\neq s_{i}$，则发生转换错误。\n-   转换错误计数的定义：满足$s_{i+1} \\neq s_{i}$的索引$i \\in \\{1,\\dots,9\\}$的总数。\n-   转换错误率的定义：转换错误计数除以相邻杂合SNP对的数量，即$9$。该率表示为四舍五入到$4$位有效数字的小数。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据，因为它使用了基因组学和生物信息学领域的标准术语和度量（转换错误率）来评估单倍型定相的准确性。提供的数据与定义一致；对于每个SNP位置$i$，两个真实单倍型上的等位基因是不同的（$H^{T}_{1}[i] + H^{T}_{2}[i] = 1$），预测的单倍型也是如此（$H^{P}_{1}[i] + H^{P}_{2}[i] = 1$），满足杂合性条件。该问题是适定的，提供了所有必要的数据和明确的定义以计算唯一解。语言客观且正式。未发现任何缺陷。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整的解决方案。\n\n问题的核心是确定对齐序列$s_i$，然后计算该对齐在相邻位置之间“转换”的次数。序列$s_i$追踪预测单倍型$H^{P}_{1}$是匹配真实单倍型$H^{T}_{1}$（我们可以任意将其标记为“正确”相位）还是匹配$H^{T}_{2}$（“转换”相位）。\n\n通过在每个从$1$到$10$的SNP位置$i$上比较预测单倍型$H^{P}_{1}$与真实单倍型$H^{T}_{1}$，来构建对齐序列$s = (s_1, s_2, \\dots, s_{10})$。\n已知：\n$$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0)$$\n$$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0)$$\n\n根据定义，如果$H^{P}_{1}[i] = H^{T}_{1}[i]$，则$s_{i} = +1$，否则$s_{i} = -1$（因为杂合性意味着如果$H^{P}_{1}[i] \\neq H^{T}_{1}[i]$，那么必然有$H^{P}_{1}[i] = H^{T}_{2}[i]$）。\n\n让我们计算每个位置$i$的$s_i$：\n-   对于$i=1$：$H^{P}_{1}[1] = 1$且$H^{T}_{1}[1] = 1$。它们相等，所以$s_1 = +1$。\n-   对于$i=2$：$H^{P}_{1}[2] = 0$且$H^{T}_{1}[2] = 0$。它们相等，所以$s_2 = +1$。\n-   对于$i=3$：$H^{P}_{1}[3] = 0$且$H^{T}_{1}[3] = 1$。它们不相等，所以$s_3 = -1$。\n-   对于$i=4$：$H^{P}_{1}[4] = 1$且$H^{T}_{1}[4] = 1$。它们相等，所以$s_4 = +1$。\n-   对于$i=5$：$H^{P}_{1}[5] = 1$且$H^{T}_{1}[5] = 0$。它们不相等，所以$s_5 = -1$。\n-   对于$i=6$：$H^{P}_{1}[6] = 0$且$H^{T}_{1}[6] = 0$。它们相等，所以$s_6 = +1$。\n-   对于$i=7$：$H^{P}_{1}[7] = 1$且$H^{T}_{1}[7] = 1$。它们相等，所以$s_7 = +1$。\n-   对于$i=8$：$H^{P}_{1}[8] = 1$且$H^{T}_{1}[8] = 0$。它们不相等，所以$s_8 = -1$。\n-   对于$i=9$：$H^{P}_{1}[9] = 0$且$H^{T}_{1}[9] = 1$。它们不相等，所以$s_9 = -1$。\n-   对于$i=10$：$H^{P}_{1}[10] = 0$且$H^{T}_{1}[10] = 0$。它们相等，所以$s_{10} = +1$。\n\n完整的对齐序列是$s = (+1, +1, -1, +1, -1, +1, +1, -1, -1, +1)$。\n\n接下来，我们计算转换错误计数。如果在索引$i$处$s_{i+1} \\neq s_i$，则发生转换错误。我们对$i=1, \\dots, 9$进行检查。\n-   $i=1$：$s_2 = +1$, $s_1 = +1$。$s_2 = s_1$。无转换。\n-   $i=2$：$s_3 = -1$, $s_2 = +1$。$s_3 \\neq s_2$。**转换 1**。\n-   $i=3$：$s_4 = +1$, $s_3 = -1$。$s_4 \\neq s_3$。**转换 2**。\n-   $i=4$：$s_5 = -1$, $s_4 = +1$。$s_5 \\neq s_4$。**转换 3**。\n-   $i=5$：$s_6 = +1$, $s_5 = -1$。$s_6 \\neq s_5$。**转换 4**。\n-   $i=6$：$s_7 = +1$, $s_6 = +1$。$s_7 = s_6$。无转换。\n-   $i=7$：$s_8 = -1$, $s_7 = +1$。$s_8 \\neq s_7$。**转换 5**。\n-   $i=8$：$s_9 = -1$, $s_8 = -1$。$s_9 = s_8$。无转换。\n-   $i=9$：$s_{10} = +1$, $s_9 = -1$。$s_{10} \\neq s_9$。**转换 6**。\n\n通过将这些发生次数相加，总的转换错误计数为$6$。\n\n最后，我们计算转换错误率。它是转换错误计数除以发生转换的机会数量，即相邻SNP对的数量。对于一个包含$10$个SNP的区块，有$10-1 = 9$个相邻对。\n$$ \\text{转换错误率} = \\frac{\\text{转换错误计数}}{\\text{相邻对的数量}} = \\frac{6}{9} $$\n化简该分数得到：\n$$ \\frac{6}{9} = \\frac{2}{3} $$\n作为小数，这是$0.6666\\overline{6}$。问题要求将其四舍五入到$4$位有效数字。\n$$ 0.6666\\overline{6} \\approx 0.6667 $$\n\n两个所求的值是转换错误计数（$6$）和转换错误率（$0.6667$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6 & 0.6667\n\\end{pmatrix}\n}\n$$"
        }
    ]
}