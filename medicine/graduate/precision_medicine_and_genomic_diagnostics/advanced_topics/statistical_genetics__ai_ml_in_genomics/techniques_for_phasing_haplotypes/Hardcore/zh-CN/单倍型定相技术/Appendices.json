{
    "hands_on_practices": [
        {
            "introduction": "单倍型定相的基础是对来自测序读段的证据进行解读。本练习将演示如何应用贝叶斯定理，结合 Phred 质量分数，来量化两个变异之间连锁关系（顺式或反式）的置信度。通过这个计算，您可以亲身体验现代定相算法所依赖的核心概率推理过程 。",
            "id": "4388611",
            "problem": "同一基因内的两个单核苷酸变异 (SNV) 相距 $2$ 千碱基 (kb)。三个独立的长读段分子跨越这两个 SNV，并且每个分子都提供了一个读段级别的定相分配（一致性表示两个变异位于同一单倍型上，不一致性表示它们位于相对的单倍型上）。一个读段为不一致性，其 Phred 质量分数为 $Q=20$；另外两个读段为一致性，其 Phred 质量分数均为 $Q=30$。假设每个读段的定相错误概率遵循 Phred 定义 $p_{\\mathrm{err}}=10^{-Q/10}$，各分子间的读段错误是独立的，并且这些分子在 $2$ kb 范围内没有读段内转换错误。设先验概率为 $P(\\text{cis})=P(\\text{trans})=\\frac{1}{2}$。利用贝叶斯法则和这些假设，计算在这三个读段给定的情况下，这两个 SNV 呈顺式（cis）构型的后验概率。请将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "首先验证该问题，以确保其科学上成立、设定良好且客观。\n\n### 步骤 1：提取已知条件\n- 两个单核苷酸变异 (SNV) 相距 $2$ 千碱基 (kb)。\n- 有三个独立的长读段分子跨越这两个 SNV。\n- 读段 1 为不一致性，Phred 质量分数为 $Q=20$。\n- 读段 2 为一致性，Phred 质量分数为 $Q=30$。\n- 读段 3 为一致性，Phred 质量分数为 $Q=30$。\n- 一致性读段表示两个变异位于同一单倍型上。这对应于 `cis`（顺式）构型。\n- 不一致性读段表示两个变异位于相对的单倍型上。这对应于 `trans`（反式）构型。\n- 每个读段的定相错误概率由 Phred 分数定义为 $p_{\\mathrm{err}}=10^{-Q/10}$。\n- 各分子间的读段错误是独立的。\n- 在 $2$ kb 距离内没有读段内转换错误。\n- 给定的先验概率为 $P(\\text{cis})=\\frac{1}{2}$ 和 $P(\\text{trans})=\\frac{1}{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上是成立的，使用了基因组学和生物信息学中的标准概念，如 SNV、单倍型定相、长读段测序和 Phred 质量分数。贝叶斯法则的应用是该领域中进行统计推断的标准方法。错误概率模型是 Phred 分数定义的直接且正确的应用。诸如读段独立、在指定距离内无转换错误等假设是合理的简化，使问题设定良好。问题陈述客观，提供了所有必要的数值和定义。没有矛盾、歧义或事实上的不健全之处。\n\n### 步骤 3：结论与行动\n该问题被判定为有效，并将提供解答。\n\n### 步骤 4：计算后验概率\n\n我们使用贝叶斯定理来计算顺式（cis）构型的后验概率。贝叶斯定理的公式为：\n$$ P(\\text{cis} | \\text{数据}) = \\frac{P(\\text{数据} | \\text{cis}) \\cdot P(\\text{cis})}{P(\\text{数据})} $$\n其中，$P(\\text{数据}) = P(\\text{数据} | \\text{cis}) \\cdot P(\\text{cis}) + P(\\text{数据} | \\text{trans}) \\cdot P(\\text{trans})$。\n\n首先，计算每个读段的错误概率：\n-   对于 $Q=20$ 的读段，错误概率为 $p_{20} = 10^{-20/10} = 10^{-2} = 0.01$。\n-   对于 $Q=30$ 的读段，错误概率为 $p_{30} = 10^{-30/10} = 10^{-3} = 0.001$。\n\n接下来，计算似然函数 $L(\\text{cis}) = P(\\text{数据} | \\text{cis})$ 和 $L(\\text{trans}) = P(\\text{数据} | \\text{trans})$。\n“数据”包括一个不一致性读段（$Q=20$）和两个一致性读段（$Q=30$）。\n\n-   **计算 $L(\\text{cis})$**：\n    如果真实构型是 `cis`，则“一致性”读段是正确的，“不一致性”读段是错误的。\n    -   观察到不一致性读段的概率 = $p_{20} = 0.01$。\n    -   观察到一致性读段的概率 = $1 - p_{30} = 1 - 0.001 = 0.999$。\n    -   由于读段是独立的，似然函数为三者概率的乘积：\n        $$ L(\\text{cis}) = p_{20} \\times (1 - p_{30}) \\times (1 - p_{30}) = 0.01 \\times 0.999 \\times 0.999 = 0.00998001 $$\n\n-   **计算 $L(\\text{trans})$**：\n    如果真实构型是 `trans`，则“不一致性”读段是正确的，“一致性”读段是错误的。\n    -   观察到不一致性读段的概率 = $1 - p_{20} = 1 - 0.01 = 0.99$。\n    -   观察到一致性读段的概率 = $p_{30} = 0.001$。\n    -   似然函数为：\n        $$ L(\\text{trans}) = (1 - p_{20}) \\times p_{30} \\times p_{30} = 0.99 \\times 0.001 \\times 0.001 = 0.00000099 $$\n\n最后，计算后验概率。由于先验概率相等（$P(\\text{cis}) = P(\\text{trans}) = 0.5$），后验概率可以简化为：\n$$ P(\\text{cis} | \\text{数据}) = \\frac{L(\\text{cis})}{L(\\text{cis}) + L(\\text{trans})} $$\n$$ P(\\text{cis} | \\text{数据}) = \\frac{0.00998001}{0.00998001 + 0.00000099} = \\frac{0.00998001}{0.009981} \\approx 0.9998998... $$\n\n根据题目要求，将结果四舍五入到四位有效数字，得到 $0.9999$。",
            "answer": "$$\\boxed{0.9999}$$"
        },
        {
            "introduction": "要确定一个基因组区域的单倍型，需要将多个独立的、局部的连锁信息整合成两条完整连贯的染色单体序列。本练习介绍了一种强大的图论模型，其中最优单倍型方案对应于一个最小权重切割 。这项实践阐明了计算工具如何根据证据的质量（由边的权重代表）来权衡和解决相互矛盾的读段信息，从而构建出最可靠的单倍型区块。",
            "id": "4388626",
            "problem": "在用于精准医疗和基因组诊断的基于图的单倍型定相技术中，通过对一个图进行分区，将相邻的杂合单核苷酸变异归入两个单倍型；在该图中，顶点代表变异，边编码了基于测序读段的证据，表明特定变异对在同一条染色体上是同相的。考虑一个药理基因组学相关基因中的四个杂合变异，标记为$A$、$B$、$C$和$D$。存在边$(A,B)$、$(B,C)$和$(C,D)$，每条边都由两个跨越相应变异对的独立双末端测序读段支持。假设根据正交的定相信息，已知变异$A$位于单倍型$H_1$上，变异$D$位于单倍型$H_2$上，并且切割一条边$(i,j)$对应于将$i$和$j$置于不同的单倍型上，从而与跨越$(i,j)$的测序读段相矛盾。\n\n使用以下基本依据：\n- Phred碱基质量定义：对于任何质量分数为$Q$的碱基检出，其检出错误的概率为$p_{\\text{err}} = 10^{-Q/10}$。\n- 在一个读段内不同位置之间以及不同读段之间的碱基检出错误是独立的。\n- 独立事件的似然原则：如果多个独立事件必须同时出错才能解释一个矛盾，则其组合概率是它们各自概率的乘积，并且负对数似然是可加的。\n\n对于跨越变异$i$和$j$的每个读段$k$，将$p_{i}^{(k)}$和$p_{j}^{(k)}$定义为分别在与$i$和$j$重叠的碱基处的错误概率，这些概率由给定的Phred分数得到。将读段$k$对于$(i,j)$的相同单倍型断言是错误的概率建模为该读段中至少有一个碱基检出是错误的事件。对于$i$和$j$处的两个独立碱基检出错误事件，这个并集的概率是$p_{i}^{(k)} + p_{j}^{(k)} - p_{i}^{(k)} p_{j}^{(k)}$。对于由多个读段支持的边$(i,j)$，将其切割惩罚权重定义为所有支持读段同时产生误导的概率的负自然对数。在独立性假设下，这等于每个读段产生误导的概率的负自然对数之和。\n\n跨越每条边的两个读段的Phred质量分数如下：\n- 边$(A,B)$：读段1的$(Q_{A}, Q_{B}) = (30, 30)$；读段2的$(Q_{A}, Q_{B}) = (40, 35)$。\n- 边$(B,C)$：读段1的$(Q_{B}, Q_{C}) = (30, 20)$；读段2的$(Q_{B}, Q_{C}) = (35, 25)$。\n- 边$(C,D)$：读段1的$(Q_{C}, Q_{D}) = (25, 35)$；读段2的$(Q_{C}, Q_{D}) = (30, 40)$。\n\n计算该图的最小加权切割值，约束条件是$A$和$D$位于不同的单倍型上，并报告最小切割值（即跨越分区的边的权重之和）。将最终的切割权重表示为一个无量纲量，并将您的答案四舍五入到四位有效数字。此外，在您的推导过程中，解释上述定义的边权重如何反映测序读段中的碱基质量，以及为什么更高质量的证据会导致更大的切割惩罚。",
            "solution": "该问题具有科学依据，提法明确且客观。它提出了一个标准的、尽管是简化的、使用图上的最小割公式进行单倍型定相的模型，这是计算基因组学中一种有效且广泛使用的技术。所有必要的数据和定义都已提供，没有内部矛盾或科学上不合理的假设。因此，该问题被认为是有效的，并将提供解答。\n\n问题要求计算一个代表四个杂合变异（标记为$A$、$B$、$C$和$D$）的图的最小加权切割值。该图由顶点$\\{A, B, C, D\\}$和边$(A,B)$、$(B,C)$、$(C,D)$组成，形成一条线性路径。我们被给予的约束条件是变异$A$在单倍型$H_1$上，变异$D$在单倍型$H_2$上。一次切割对应于将顶点划分为两个集合，每个集合代表一个单倍型，其权重是连接$H_1$中顶点和$H_2$中顶点的所有边的权重之和。我们寻求使这个总权重最小化的分区。\n\n首先，我们必须计算每条边的权重。一条边$(i, j)$的权重，记作$w(i,j)$，被定义为所有支持读段同时产生误导的概率的负自然对数。这等于每个读段的负对数似然之和。\n对于跨越变异$i$和$j$的单个读段$k$，其碱基检出错误概率为$p_{i}^{(k)}$和$p_{j}^{(k)}$，该读段产生误导（即两个碱基检出中至少有一个不正确）的概率由下式给出：\n$$P_k(\\text{misleading}) = p_{i}^{(k)} + p_{j}^{(k)} - p_{i}^{(k)} p_{j}^{(k)}$$\n错误概率$p$由Phred质量分数$Q$通过公式$p = 10^{-Q/10}$导出。\n由$N$个读段支持的边的权重为：\n$$w(i,j) = \\sum_{k=1}^{N} \\left[ -\\ln\\left( P_k(\\text{misleading}) \\right) \\right]$$\n\n现在，我们计算三条边中每一条的权重。\n\n1.  **边 $(A,B)$**\n    - 读段1：$(Q_A, Q_B) = (30, 30)$。\n      $p_A^{(1)} = 10^{-30/10} = 10^{-3}$。\n      $p_B^{(1)} = 10^{-30/10} = 10^{-3}$。\n      $P_1(\\text{misleading}) = 10^{-3} + 10^{-3} - (10^{-3})(10^{-3}) = 2 \\times 10^{-3} - 10^{-6} = 0.001999$。\n      权重贡献为 $w_1 = -\\ln(0.001999) \\approx 6.215108$。\n    - 读段2：$(Q_A, Q_B) = (40, 35)$。\n      $p_A^{(2)} = 10^{-40/10} = 10^{-4}$。\n      $p_B^{(2)} = 10^{-35/10} = 10^{-3.5}$。\n      $P_2(\\text{misleading}) = 10^{-4} + 10^{-3.5} - (10^{-4})(10^{-3.5}) = 10^{-4} + 10^{-3.5} - 10^{-7.5} \\approx 0.000416196$。\n      权重贡献为 $w_2 = -\\ln(10^{-4} + 10^{-3.5} - 10^{-7.5}) \\approx 7.785233$。\n    - 边$(A,B)$的总权重：\n      $$w(A,B) = w_1 + w_2 \\approx 6.215108 + 7.785233 = 14.000341$$\n\n2.  **边 $(B,C)$**\n    - 读段1：$(Q_B, Q_C) = (30, 20)$。\n      $p_B^{(1)} = 10^{-30/10} = 10^{-3}$。\n      $p_C^{(1)} = 10^{-20/10} = 10^{-2}$。\n      $P_1(\\text{misleading}) = 10^{-3} + 10^{-2} - (10^{-3})(10^{-2}) = 1.1 \\times 10^{-2} - 10^{-5} = 0.01099$。\n      权重贡献为 $w_1 = -\\ln(0.01099) \\approx 4.510858$。\n    - 读段2：$(Q_B, Q_C) = (35, 25)$。\n      $p_B^{(2)} = 10^{-35/10} = 10^{-3.5}$。\n      $p_C^{(2)} = 10^{-25/10} = 10^{-2.5}$。\n      $P_2(\\text{misleading}) = 10^{-3.5} + 10^{-2.5} - (10^{-3.5})(10^{-2.5}) = 10^{-3.5} + 10^{-2.5} - 10^{-6} \\approx 0.003477505$。\n      权重贡献为 $w_2 = -\\ln(10^{-3.5} + 10^{-2.5} - 10^{-6}) \\approx 5.661642$。\n    - 边$(B,C)$的总权重：\n      $$w(B,C) = w_1 + w_2 \\approx 4.510858 + 5.661642 = 10.172500$$\n\n3.  **边 $(C,D)$**\n    - 读段1：$(Q_C, Q_D) = (25, 35)$。\n      $p_C^{(1)} = 10^{-25/10} = 10^{-2.5}$。\n      $p_D^{(1)} = 10^{-35/10} = 10^{-3.5}$。\n      $P_1(\\text{misleading}) = 10^{-2.5} + 10^{-3.5} - (10^{-2.5})(10^{-3.5}) = 10^{-2.5} + 10^{-3.5} - 10^{-6} \\approx 0.003477505$。\n      权重贡献为 $w_1 = -\\ln(10^{-2.5} + 10^{-3.5} - 10^{-6}) \\approx 5.661642$。\n    - 读段2：$(Q_C, Q_D) = (30, 40)$。\n      $p_C^{(2)} = 10^{-30/10} = 10^{-3}$。\n      $p_D^{(2)} = 10^{-40/10} = 10^{-4}$。\n      $P_2(\\text{misleading}) = 10^{-3} + 10^{-4} - (10^{-3})(10^{-4}) = 1.1 \\times 10^{-3} - 10^{-7} = 0.0010999$。\n      权重贡献为 $w_2 = -\\ln(0.0010999) \\approx 6.812403$。\n    - 边$(C,D)$的总权重：\n      $$w(C,D) = w_1 + w_2 \\approx 5.661642 + 6.812403 = 12.474045$$\n\n问题是要将顶点$\\{A, B, C, D\\}$划分为两个集合$H_1$和$H_2$，使得$A \\in H_1$，$D \\in H_2$，并且连接这两个集合的边的权重之和最小。顶点$B$和$C$的分配决定了分区。由于图是线性的，我们只需要考虑三种可能的单一切割：\n1.  切割$(A,B)$: 分区为 $\\{A\\} | \\{B, C, D\\}$。切割权重 = $w(A,B) \\approx 14.00$。\n2.  切割$(B,C)$: 分区为 $\\{A, B\\} | \\{C, D\\}$。切割权重 = $w(B,C) \\approx 10.17$。\n3.  切割$(C,D)$: 分区为 $\\{A, B, C\\} | \\{D\\}$。切割权重 = $w(C,D) \\approx 12.47$。\n\n比较三种可能的切割权重：\n$$ \\min(14.000341, 10.172500, 12.474045) = 10.172500 $$\n最小加权切割值约为$10.1725$。这对应于$A$和$B$在单倍型$H_1$上，而$C$和$D$在单倍型$H_2$上的分区。\n\n边权重直接反映了碱基质量。更高的Phred质量分数$Q$对应于指数级更低的碱基检出错误概率$p = 10^{-Q/10}$。一个读段产生误导的概率，$P(\\text{misleading})$，是这些错误概率的函数。对于高质量的读段，$p$非常小，使得$P(\\text{misleading})$也非常小。边权重是此概率的负自然对数，$w = -\\ln(P(\\text{misleading}))$。由于对于$x0$，$-\\ln(x)$是一个单调递减函数，因此更小的错误概率（更高质量的证据）会导致更大的权重。因此，更大的权重表示两个变异在同一条染色体上的证据更强，因此，切割该边（代表与该证据相矛盾）的惩罚也更大。\n\n将最小切割值四舍五入到四位有效数字得到$10.17$。",
            "answer": "$$\\boxed{10.17}$$"
        },
        {
            "introduction": "在算法预测出单倍型后，对其准确性进行量化评估是至关重要的一步。本练习将介绍“转换错误”（switch error），这是衡量定相结果局部准确性的黄金标准 。通过将预测的单倍型与已知的“真实”单倍型进行逐位比较，您将学会如何计算转换错误率，并深入理解这一指标在评估算法性能时的核心作用。",
            "id": "4388681",
            "problem": "一个临床研究团队正在验证一个药物基因组学基因区域内的单倍型定相，该区域跨越一个包含$10$个单核苷酸多态性（SNP）的区块。对于该样本，每个SNP都是双等位基因且为杂合的，等位基因编码为$0$或$1$。在每个位置上定义了两个单倍型，对应于两条同源染色体。该区块的真实单倍型$H^{T}_{1}$和$H^{T}_{2}$由基于三联体（trio-based）的基准真相（ground truth）确定。一个算法预测了同一区块的单倍型$H^{P}_{1}$和$H^{P}_{2}$。\n\n使用以下数据：\n- 真实单倍型：\n$$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0), \\quad H^{T}_{2} = (0, 1, 0, 0, 1, 1, 0, 1, 0, 1)。$$\n- 预测单倍型：\n$$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0), \\quad H^{P}_{2} = (0, 1, 1, 0, 0, 1, 0, 0, 1, 1)。$$\n\n使用的定义：\n1. SNP $i$处的单倍型定相为每条同源染色体分配等位基因；对于双等位基因杂合位点，对所有$i$均有$H^{T}_{1}[i] \\neq H^{T}_{2}[i]$和$H^{P}_{1}[i] \\neq H^{P}_{2}[i]$成立。\n2. 如果在位置$i$上将$H^{P}_{1}$与$\\{H^{T}_{1}, H^{T}_{2}\\}$之一对齐的映射与在位置$i+1$上的映射不同，则在相邻的SNP $i$和$i+1$之间发生转换错误。形式上，定义一个序列$s_{i} \\in \\{+1,-1\\}$，其中如果$H^{P}_{1}[i] = H^{T}_{1}[i]$，则$s_{i} = +1$；如果$H^{P}_{1}[i] = H^{T}_{2}[i]$，则$s_{i} = -1$。当$s_{i+1} \\neq s_{i}$时，记为一个转换错误。\n3. 转换错误计数是在这个$10$-SNP区块中，满足$s_{i+1} \\neq s_{i}$的索引$i \\in \\{1,\\dots,9\\}$的总数。\n4. 转换错误率是转换错误计数除以相邻杂合SNP对的数量，对于$10$个杂合SNP，该数量为$9$。将该比率表示为小数。\n\n计算预测单倍型相对于真实单倍型的转换错误计数和转换错误率。将转换错误率四舍五入至$4$位有效数字。将最终比率表示为小数（不要使用百分号）。提供最终答案为两个值：首先是整数形式的转换错误计数，其次是四舍五入后的转换错误率。",
            "solution": "用户要求计算一组预测单倍型相对于已知真实单倍型的转换错误计数和转换错误率。\n\n首先，对问题陈述进行验证。\n\n**第1步：提取已知条件**\n-   区块中的SNP数量：$10$。\n-   所有SNP均为双等位基因且为杂合。\n-   等位基因编码：$0$或$1$。\n-   真实单倍型：$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0)$ 和 $H^{T}_{2} = (0, 1, 0, 0, 1, 1, 0, 1, 0, 1)$。\n-   预测单倍型：$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0)$ 和 $H^{P}_{2} = (0, 1, 1, 0, 0, 1, 0, 0, 1, 1)$。\n-   杂合位点的定义：对于所有SNP索引$i$，$H^{T}_{1}[i] \\neq H^{T}_{2}[i]$且$H^{P}_{1}[i] \\neq H^{P}_{2}[i]$。\n-   比对序列$s_{i}$的定义：如果$H^{P}_{1}[i] = H^{T}_{1}[i]$，则$s_{i} = +1$；如果$H^{P}_{1}[i] = H^{T}_{2}[i]$，则$s_{i} = -1$。\n-   转换错误的定义：在相邻的SNP $i$和$i+1$之间，如果$s_{i+1} \\neq s_{i}$，则发生转换错误。\n-   转换错误计数的定义：满足$s_{i+1} \\neq s_{i}$的索引$i \\in \\{1,\\dots,9\\}$的总数。\n-   转换错误率的定义：转换错误计数除以相邻杂合SNP对的数量，即$9$。该比率表示为四舍五入到$4$位有效数字的小数。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它使用了基因组学和生物信息学领域评估单倍型定相准确性的标准术语和指标（转换错误率）。所提供的数据与定义一致；对于每个SNP位置$i$，两个真实单倍型上的等位基因是不同的（$H^{T}_{1}[i] + H^{T}_{2}[i] = 1$），预测单倍型同样如此（$H^{P}_{1}[i] + H^{P}_{2}[i] = 1$），满足杂合性条件。该问题提法明确，提供了计算唯一解所需的所有数据和清晰的定义。语言客观、正式。未发现任何缺陷。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n问题的核心是确定比对序列$s_i$，然后计算该比对在相邻位置之间“转换”的次数。序列$s_i$追踪预测单倍型$H^{P}_{1}$是与真实单倍型$H^{T}_{1}$（我们可以任意将其标记为“正确”相位）匹配，还是与$H^{T}_{2}$（“转换”相位）匹配。\n\n比对序列$s = (s_1, s_2, \\dots, s_{10})$是通过在每个SNP位置$i$（从$1$到$10$）比较预测单倍型$H^{P}_{1}$与真实单倍型$H^{T}_{1}$来构建的。\n已知：\n$$H^{T}_{1} = (1, 0, 1, 1, 0, 0, 1, 0, 1, 0)$$\n$$H^{P}_{1} = (1, 0, 0, 1, 1, 0, 1, 1, 0, 0)$$\n\n根据定义，如果$H^{P}_{1}[i] = H^{T}_{1}[i]$，则$s_{i} = +1$；否则$s_{i} = -1$（因为杂合性意味着如果$H^{P}_{1}[i] \\neq H^{T}_{1}[i]$，那么必然有$H^{P}_{1}[i] = H^{T}_{2}[i]$）。\n\n我们来计算每个位置$i$的$s_i$：\n-   对于$i=1$：$H^{P}_{1}[1] = 1$ 且 $H^{T}_{1}[1] = 1$。它们相等，所以$s_1 = +1$。\n-   对于$i=2$：$H^{P}_{1}[2] = 0$ 且 $H^{T}_{1}[2] = 0$。它们相等，所以$s_2 = +1$。\n-   对于$i=3$：$H^{P}_{1}[3] = 0$ 且 $H^{T}_{1}[3] = 1$。它们不相等，所以$s_3 = -1$。\n-   对于$i=4$：$H^{P}_{1}[4] = 1$ 且 $H^{T}_{1}[4] = 1$。它们相等，所以$s_4 = +1$。\n-   对于$i=5$：$H^{P}_{1}[5] = 1$ 且 $H^{T}_{1}[5] = 0$。它们不相等，所以$s_5 = -1$。\n-   对于$i=6$：$H^{P}_{1}[6] = 0$ 且 $H^{T}_{1}[6] = 0$。它们相等，所以$s_6 = +1$。\n-   对于$i=7$：$H^{P}_{1}[7] = 1$ 且 $H^{T}_{1}[7] = 1$。它们相等，所以$s_7 = +1$。\n-   对于$i=8$：$H^{P}_{1}[8] = 1$ 且 $H^{T}_{1}[8] = 0$。它们不相等，所以$s_8 = -1$。\n-   对于$i=9$：$H^{P}_{1}[9] = 0$ 且 $H^{T}_{1}[9] = 1$。它们不相等，所以$s_9 = -1$。\n-   对于$i=10$：$H^{P}_{1}[10] = 0$ 且 $H^{T}_{1}[10] = 0$。它们相等，所以$s_{10} = +1$。\n\n完整的比对序列是$s = (+1, +1, -1, +1, -1, +1, +1, -1, -1, +1)$。\n\n接下来，我们计算转换错误计数。如果$s_{i+1} \\neq s_i$，则在索引$i$处发生转换错误。我们对$i=1, \\dots, 9$进行检查。\n-   $i=1$：$s_2 = +1$, $s_1 = +1$。$s_2 = s_1$。无转换。\n-   $i=2$：$s_3 = -1$, $s_2 = +1$。$s_3 \\neq s_2$。**转换 1**。\n-   $i=3$：$s_4 = +1$, $s_3 = -1$。$s_4 \\neq s_3$。**转换 2**。\n-   $i=4$：$s_5 = -1$, $s_4 = +1$。$s_5 \\neq s_4$。**转换 3**。\n-   $i=5$：$s_6 = +1$, $s_5 = -1$。$s_6 \\neq s_5$。**转换 4**。\n-   $i=6$：$s_7 = +1$, $s_6 = +1$。$s_7 = s_6$。无转换。\n-   $i=7$：$s_8 = -1$, $s_7 = +1$。$s_8 \\neq s_7$。**转换 5**。\n-   $i=8$：$s_9 = -1$, $s_8 = -1$。$s_9 = s_8$。无转换。\n-   $i=9$：$s_{10} = +1$, $s_9 = -1$。$s_{10} \\neq s_9$。**转换 6**。\n\n将这些情况相加，总转换错误计数为$6$。\n\n最后，我们计算转换错误率。它是转换错误计数除以可能发生转换的机会数，即相邻SNP对的数量。对于一个包含$10$个SNP的区块，有$10-1 = 9$个相邻对。\n$$ \\text{转换错误率} = \\frac{\\text{转换错误计数}}{\\text{相邻对数量}} = \\frac{6}{9} $$\n化简该分数得：\n$$ \\frac{6}{9} = \\frac{2}{3} $$\n换算成小数，即为$0.6666\\overline{6}$。问题要求将其四舍五入到$4$位有效数字。\n$$ 0.6666\\overline{6} \\approx 0.6667 $$\n\n所需的两个值是转换错误计数（$6$）和转换错误率（$0.6667$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6  0.6667\n\\end{pmatrix}\n}\n$$"
        }
    ]
}