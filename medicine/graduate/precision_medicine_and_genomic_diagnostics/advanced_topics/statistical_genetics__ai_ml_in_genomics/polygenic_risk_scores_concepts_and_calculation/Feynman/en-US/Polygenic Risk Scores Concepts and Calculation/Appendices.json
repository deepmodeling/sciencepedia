{
    "hands_on_practices": [
        {
            "introduction": "A Polygenic Risk Score (PRS) is built from the summary statistics of a Genome-Wide Association Study (GWAS), but we cannot simply use every genetic variant associated with a trait. Due to Linkage Disequilibrium (LD), many nearby SNPs are correlated and provide redundant information. This exercise guides you through LD clumping, a fundamental procedure used to select a set of informative, largely independent \"index SNPs\" that will form the basis of the PRS, ensuring that each distinct genetic signal is counted only once .",
            "id": "4369034",
            "problem": "A polygenic risk score (PRS) for a disease is defined as the linear combination of single-nucleotide polymorphism (SNP) genotypes weighted by their genome-wide association study (GWAS) effect sizes. Formally, for a set of SNPs with aligned effect alleles, the PRS for an individual is $ \\sum_{i} w_{i} \\, G_{i} $, where $ G_{i} $ is the allele dosage for SNP $ i $ and $ w_{i} $ is its weight. To avoid redundancy due to linkage disequilibrium (LD), LD clumping is applied to select approximately independent index SNPs based on statistical significance and pairwise LD.\n\nConsider a single locus with six SNPs $ G_{1}, G_{2}, G_{3}, G_{4}, G_{5}, G_{6} $. The genome-wide association study (GWAS) provides per-SNP marginal log-odds effect sizes $ \\hat{\\beta}_{i} $ and $ p $-values $ p_{i} $:\n- $ \\hat{\\beta}_{1} = 0.07 $, $ p_{1} = 3.0 \\times 10^{-4} $,\n- $ \\hat{\\beta}_{2} = -0.11 $, $ p_{2} = 1.0 \\times 10^{-5} $,\n- $ \\hat{\\beta}_{3} = 0.02 $, $ p_{3} = 3.0 \\times 10^{-3} $,\n- $ \\hat{\\beta}_{4} = 0.05 $, $ p_{4} = 1.2 \\times 10^{-4} $,\n- $ \\hat{\\beta}_{5} = 0.13 $, $ p_{5} = 8.0 \\times 10^{-8} $,\n- $ \\hat{\\beta}_{6} = -0.03 $, $ p_{6} = 9.0 \\times 10^{-4} $.\n\nThe LD matrix $ R $ for these SNPs (with entries $ r_{ij} $ equal to the Pearson correlation of dosages between $ G_{i} $ and $ G_{j} $) is:\n$$\nR = \\begin{pmatrix}\n1  0.62  0.10  0.18  0.48  0.05 \\\\\n0.62  1  0.08  0.22  0.65  0.12 \\\\\n0.10  0.08  1  0.09  0.06  0.11 \\\\\n0.18  0.22  0.09  1  0.35  0.15 \\\\\n0.48  0.65  0.06  0.35  1  0.20 \\\\\n0.05  0.12  0.11  0.15  0.20  1\n\\end{pmatrix}.\n$$\n\nPerform LD clumping with the following parameters:\n- inclusion $ p $-value threshold $ p_{\\max} = 5.0 \\times 10^{-4} $,\n- LD threshold $ r_{\\text{thr}}^{2} = 0.20 $,\n- a single-window assumption that all six SNPs reside within one clumping window.\n\nClumping is defined as:\n1. Restrict to SNPs with $ p_{i} \\leq p_{\\max} $.\n2. Rank the remaining SNPs by ascending $ p_{i} $.\n3. Iteratively select the most significant remaining SNP as the index variant; remove any remaining SNP $ j $ that satisfies $ r_{ij}^{2} \\geq r_{\\text{thr}}^{2} $ relative to the selected index SNP $ i $. Continue until no SNPs remain.\n\nAssume effect alleles are aligned and that PRS weights for selected index SNPs are their GWAS marginal log-odds $ \\hat{\\beta}_{i} $ without further shrinkage or reweighting. Execute the clumping procedure and report the resulting PRS weights $ w_{i} $ in a single row matrix (LaTeX $ \\texttt{pmatrix} $), ordered by the sequence in which the index SNPs are selected. No rounding is required.",
            "solution": "The objective is to apply LD clumping to select approximately independent index SNPs and then assign the PRS weights equal to their GWAS effect sizes. We start from the definition of the polygenic risk score as $ \\sum_{i} w_{i} G_{i} $, with weights $ w_{i} $ typically taken as the marginal GWAS effect sizes under a linear combination model, and from the definition of LD clumping based on removing SNPs in high squared correlation $ r^{2} $ with a chosen index SNP.\n\nStep 1: Apply the inclusion $ p $-value threshold $ p_{\\max} = 5.0 \\times 10^{-4} $. The SNPs with $ p_{i} \\leq p_{\\max} $ are:\n- $ G_{5} $ with $ p_{5} = 8.0 \\times 10^{-8} $,\n- $ G_{2} $ with $ p_{2} = 1.0 \\times 10^{-5} $,\n- $ G_{4} $ with $ p_{4} = 1.2 \\times 10^{-4} $,\n- $ G_{1} $ with $ p_{1} = 3.0 \\times 10^{-4} $.\nThe SNPs $ G_{3} $ and $ G_{6} $ are excluded since $ p_{3} = 3.0 \\times 10^{-3} $ and $ p_{6} = 9.0 \\times 10^{-4} $ exceed $ p_{\\max} $.\n\nStep 2: Rank the included SNPs by ascending $ p $-value:\n- First: $ G_{5} $ ($ p_{5} = 8.0 \\times 10^{-8} $),\n- Second: $ G_{2} $ ($ p_{2} = 1.0 \\times 10^{-5} $),\n- Third: $ G_{4} $ ($ p_{4} = 1.2 \\times 10^{-4} $),\n- Fourth: $ G_{1} $ ($ p_{1} = 3.0 \\times 10^{-4} $).\n\nStep 3: Iterative clumping with threshold $ r_{\\text{thr}}^{2} = 0.20 $.\n- Select $ G_{5} $ as the first index SNP. Compute $ r_{5j}^{2} $ for each remaining SNP $ j \\in \\{2,4,1\\} $ using the LD matrix:\n  - $ r_{5,2} = 0.65 \\Rightarrow r_{5,2}^{2} = 0.65^{2} = 0.4225 \\geq 0.20 $, so remove $ G_{2} $.\n  - $ r_{5,4} = 0.35 \\Rightarrow r_{5,4}^{2} = 0.35^{2} = 0.1225  0.20 $, so keep $ G_{4} $.\n  - $ r_{5,1} = 0.48 \\Rightarrow r_{5,1}^{2} = 0.48^{2} = 0.2304 \\geq 0.20 $, so remove $ G_{1} $.\n  After this step, the remaining SNP set is $ \\{ G_{4} \\} $.\n- Select $ G_{4} $ as the second index SNP. There are no other SNPs left to evaluate for removal.\n\nThus, the selected index SNPs, in order of selection, are $ G_{5} $ followed by $ G_{4} $.\n\nStep 4: Assign PRS weights $ w_{i} = \\hat{\\beta}_{i} $ for the selected index SNPs, using the provided GWAS effect sizes:\n- For $ G_{5} $, $ \\hat{\\beta}_{5} = 0.13 $, so $ w_{5} = 0.13 $.\n- For $ G_{4} $, $ \\hat{\\beta}_{4} = 0.05 $, so $ w_{4} = 0.05 $.\n\nReport the weights in the order of selection as a single row matrix. Therefore, the PRS weights vector is\n$$\n\\begin{pmatrix}\n0.13  0.05\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.13  0.05\\end{pmatrix}}$$"
        },
        {
            "introduction": "Once a set of index SNPs and their corresponding effect weights are established, the next step is to calculate the PRS for an individual. In modern genomics, genotypes are often imputed rather than directly measured, providing probabilities for carrying 0, 1, or 2 copies of an allele. This practice demonstrates how to calculate an individual's PRS by using these probabilities to compute an expected allele count, or \"dosage.\" Furthermore, it introduces the critical concept of mean-centering the score, which adjusts the individual's PRS relative to the average score in a reference population, providing a more meaningful baseline for comparison .",
            "id": "4369030",
            "problem": "In a case-control study of a complex disease, risk is modeled on the log-odds scale using an additive genetic architecture across independent biallelic loci. Consider three single-nucleotide variants indexed by $j \\in \\{1,2,3\\}$, each with a per-allele log-odds effect size $\\beta_{j}$ and an imputed genotype for one individual summarized by the posterior probabilities $\\big(P_{j,0},P_{j,1},P_{j,2}\\big)$ for carrying $0$, $1$, or $2$ copies of the minor allele. Assume a reference population in Hardy–Weinberg equilibrium with minor-allele frequency $f_{j}$ at each locus.\n\nStarting from the definition of the expectation of a discrete random variable and the Hardy–Weinberg principle for genotype frequencies, construct the individual’s mean-centered Polygenic Risk Score (PRS) on the log-odds scale relative to the reference population by: (i) replacing each unobserved genotype count with its conditional expectation given the imputation posterior, and (ii) subtracting the population mean genotype count at each locus. Then, evaluate this mean-centered PRS numerically for the following data:\n- Per-allele log-odds effect sizes: $\\beta_{1}=0.15$, $\\beta_{2}=-0.07$, $\\beta_{3}=0.04$.\n- Imputation posterior probabilities:\n  - Locus $1$: $\\big(P_{1,0},P_{1,1},P_{1,2}\\big)=\\big(0.02,0.18,0.80\\big)$,\n  - Locus $2$: $\\big(P_{2,0},P_{2,1},P_{2,2}\\big)=\\big(0.60,0.35,0.05\\big)$,\n  - Locus $3$: $\\big(P_{3,0},P_{3,1},P_{3,2}\\big)=\\big(0.10,0.30,0.60\\big)$.\n- Reference population minor-allele frequencies: $f_{1}=0.45$, $f_{2}=0.20$, $f_{3}=0.40$.\n\nProvide the final numerical value of the mean-centered PRS as a single real number. Round your answer to four significant figures. No units are required.",
            "solution": "A Polygenic Risk Score (PRS) under an additive model is a weighted sum of allele counts across multiple genetic loci. On the log-odds scale, it is given by:\n$$\nPRS = \\sum_{j} \\beta_j G_j\n$$\nwhere $\\beta_j$ is the per-allele log-odds effect size for the minor allele at locus $j$, and $G_j$ is the number of minor alleles (genotype count, taking values in $\\{0, 1, 2\\}$) for an individual at that locus.\n\nThe problem requires constructing a mean-centered PRS, which takes the form:\n$$\nPRS_{centered} = \\sum_{j} \\beta_j (G_{j, \\text{ind}} - G_{j, \\text{pop mean}})\n$$\nwhere $G_{j, \\text{ind}}$ is the individual's genotype count and $G_{j, \\text{pop mean}}$ is the mean genotype count in the reference population.\n\n**Part (i): Individual's Genotype Count**\nThe individual's true genotype count $G_j$ is not directly observed. We are instructed to replace it with its conditional expectation, $\\hat{G}_j$, given the imputation posterior probabilities $(P_{j,0}, P_{j,1}, P_{j,2})$. The expectation of this discrete random variable is:\n$$\n\\hat{G}_j = E[G_j | \\text{imputation data}] = (0 \\cdot P_{j,0}) + (1 \\cdot P_{j,1}) + (2 \\cdot P_{j,2}) = P_{j,1} + 2P_{j,2}\n$$\n\n**Part (ii): Population Mean Genotype Count**\nThe reference population is in Hardy–Weinberg equilibrium (HWE) with minor-allele frequency $f_j$. Under HWE, the frequencies of genotypes with $0$, $1$, and $2$ minor alleles are $(1-f_j)^2$, $2f_j(1-f_j)$, and $f_j^2$, respectively. The mean genotype count in the population, $E_{pop}[G_j]$, is the expectation of the genotype count under this distribution:\n$$\nE_{pop}[G_j] = (0 \\cdot (1-f_j)^2) + (1 \\cdot 2f_j(1-f_j)) + (2 \\cdot f_j^2)\n$$\n$$\nE_{pop}[G_j] = 2f_j - 2f_j^2 + 2f_j^2 = 2f_j\n$$\n\n**Constructing the Mean-Centered PRS**\nCombining these results, the formula for the individual's mean-centered PRS is:\n$$\nPRS_{centered} = \\sum_{j=1}^{3} \\beta_j (\\hat{G}_j - E_{pop}[G_j]) = \\sum_{j=1}^{3} \\beta_j ((P_{j,1} + 2P_{j,2}) - 2f_j)\n$$\n\n**Numerical Evaluation**\nWe now calculate the components for each locus $j \\in \\{1, 2, 3\\}$.\n\n**For Locus 1:**\n- $\\beta_1 = 0.15$\n- $\\hat{G}_1 = P_{1,1} + 2P_{1,2} = 0.18 + 2(0.80) = 0.18 + 1.60 = 1.78$\n- $E_{pop}[G_1] = 2f_1 = 2(0.45) = 0.90$\n- The contribution from locus $1$ is: $\\beta_1 (\\hat{G}_1 - E_{pop}[G_1]) = 0.15(1.78 - 0.90) = 0.15(0.88) = 0.132$\n\n**For Locus 2:**\n- $\\beta_2 = -0.07$\n- $\\hat{G}_2 = P_{2,1} + 2P_{2,2} = 0.35 + 2(0.05) = 0.35 + 0.10 = 0.45$\n- $E_{pop}[G_2] = 2f_2 = 2(0.20) = 0.40$\n- The contribution from locus $2$ is: $\\beta_2 (\\hat{G}_2 - E_{pop}[G_2]) = -0.07(0.45 - 0.40) = -0.07(0.05) = -0.0035$\n\n**For Locus 3:**\n- $\\beta_3 = 0.04$\n- $\\hat{G}_3 = P_{3,1} + 2P_{3,2} = 0.30 + 2(0.60) = 0.30 + 1.20 = 1.50$\n- $E_{pop}[G_3] = 2f_3 = 2(0.40) = 0.80$\n- The contribution from locus $3$ is: $\\beta_3 (\\hat{G}_3 - E_{pop}[G_3]) = 0.04(1.50 - 0.80) = 0.04(0.70) = 0.028$\n\n**Total Mean-Centered PRS**\nThe total PRS is the sum of the contributions from each locus:\n$$\nPRS_{centered} = 0.132 + (-0.0035) + 0.028\n$$\n$$\nPRS_{centered} = 0.132 - 0.0035 + 0.028 = 0.1285 + 0.028 = 0.1565\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value, $0.1565$, already has exactly four significant figures ($1$, $5$, $6$, $5$). Therefore, no further rounding is necessary.",
            "answer": "$$ \\boxed{0.1565} $$"
        },
        {
            "introduction": "A raw PRS value, such as $0.645$, has little intrinsic meaning until it is placed within a population context. To make the score interpretable, we need to know where an individual's score falls within the distribution of scores for a relevant reference population. This practice delves into the statistical theory behind PRS interpretation, asking you to derive the formula for converting a raw score into a percentile. By assuming the PRS distribution is approximately Normal, you will see how standardization provides a powerful and intuitive way to communicate genetic risk .",
            "id": "4368997",
            "problem": "In a precision medicine pipeline for genomic diagnostics, an individual's Polygenic Risk Score (PRS) for a complex disease is computed as a weighted sum of single-nucleotide polymorphism effect sizes. Under the assumption that many independent additive genetic effects contribute to the PRS, the Central Limit Theorem implies that the distribution of PRS in a large, ancestrally matched reference population is well approximated by a Gaussian (normal) distribution with mean $\\mu$ and standard deviation $\\sigma$. Let $X$ denote the random variable representing the PRS in the reference population, and suppose $X$ is approximately distributed as a normal distribution with mean $\\mu$ and variance $\\sigma^{2}$. The percentile of an individual's raw PRS value $x$ is defined as the probability that a randomly selected individual from the reference population has PRS less than or equal to $x$, i.e., the cumulative distribution function (CDF) of $X$ evaluated at $x$. Using the definition of the cumulative distribution function (CDF) and the standardization (z-scoring) transformation to the standard normal distribution, derive an analytic expression that converts the raw PRS value $x$ to its percentile in terms of $\\mu$, $\\sigma$, and $x$, expressed via the standard normal cumulative distribution function $\\Phi$. Your final answer must be a single closed-form expression.",
            "solution": "The problem asks for the derivation of an analytic expression for the percentile of a raw Polygenic Risk Score (PRS) value, $x$. The percentile is defined as the probability that a randomly selected individual from a reference population has a PRS less than or equal to $x$.\n\nFirst, we formalize the problem based on the provided information. Let $X$ be the random variable representing the PRS in the reference population. The problem states that $X$ is well-approximated by a normal (Gaussian) distribution with a mean of $\\mu$ and a variance of $\\sigma^2$. This is denoted as $X \\sim N(\\mu, \\sigma^2)$. The standard deviation of this distribution is $\\sigma$.\n\nThe percentile corresponding to a specific PRS value $x$ is the value of the cumulative distribution function (CDF) of $X$ evaluated at $x$, which we denote as $F_X(x)$. By definition, this is:\n$$\n\\text{Percentile}(x) = P(X \\le x)\n$$\n\nThe goal is to express this probability in terms of the standard normal cumulative distribution function, $\\Phi(z)$. The standard normal distribution is a special case of the normal distribution with a mean of $0$ and a variance of $1$. A random variable $Z$ following this distribution is denoted as $Z \\sim N(0, 1)$. Its CDF is given by:\n$$\n\\Phi(z) = P(Z \\le z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{z} \\exp\\left(-\\frac{t^2}{2}\\right) dt\n$$\n\nTo relate the probability $P(X \\le x)$ to the standard normal CDF $\\Phi$, we must perform a standardization transformation (also known as creating a z-score). This transformation converts the random variable $X$ into a standard normal random variable $Z$. The transformation is defined as:\n$$\nZ = \\frac{X - \\mu}{\\sigma}\n$$\nGiven that $X \\sim N(\\mu, \\sigma^2)$, the transformed variable $Z$ will have a distribution $Z \\sim N(0, 1)$.\n\nNow, we can manipulate the inequality inside the probability expression $P(X \\le x)$ to express it in terms of $Z$.\nWe start with the inequality:\n$$\nX \\le x\n$$\nTo apply the standardization, we first subtract the mean $\\mu$ from both sides of the inequality:\n$$\nX - \\mu \\le x - \\mu\n$$\nNext, we divide both sides by the standard deviation $\\sigma$. Since $\\sigma$ represents a standard deviation, it is inherently a non-negative quantity. For a non-degenerate normal distribution, $\\sigma  0$. Dividing by a positive number does not change the direction of the inequality:\n$$\n\\frac{X - \\mu}{\\sigma} \\le \\frac{x - \\mu}{\\sigma}\n$$\nThe left side of this inequality is precisely our standardized random variable $Z$. Therefore, the inequality becomes:\n$$\nZ \\le \\frac{x - \\mu}{\\sigma}\n$$\nBy substituting this transformed inequality back into the probability expression, we find that the probability for $X$ can be expressed as a probability for $Z$:\n$$\nP(X \\le x) = P\\left(\\frac{X - \\mu}{\\sigma} \\le \\frac{x - \\mu}{\\sigma}\\right) = P\\left(Z \\le \\frac{x - \\mu}{\\sigma}\\right)\n$$\nBy the definition of the standard normal CDF, $\\Phi(z) = P(Z \\le z)$, we can directly write the final expression. We set the argument of $\\Phi$ to the value on the right side of our inequality:\n$$\nP\\left(Z \\le \\frac{x - \\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{x - \\mu}{\\sigma}\\right)\n$$\nThus, the analytic expression that converts the raw PRS value $x$ to its percentile in the reference population, expressed in terms of $\\mu$, $\\sigma$, $x$, and the standard normal CDF $\\Phi$, is $\\Phi\\left(\\frac{x - \\mu}{\\sigma}\\right)$. This closed-form expression represents the fraction of the reference population with a PRS at or below the value $x$.",
            "answer": "$$\\boxed{\\Phi\\left(\\frac{x - \\mu}{\\sigma}\\right)}$$"
        }
    ]
}