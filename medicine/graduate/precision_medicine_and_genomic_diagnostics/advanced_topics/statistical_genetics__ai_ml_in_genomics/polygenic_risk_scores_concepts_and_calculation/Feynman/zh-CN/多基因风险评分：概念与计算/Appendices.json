{
    "hands_on_practices": [
        {
            "introduction": "在构建多基因风险评分（PRS）时，一个关键的初始步骤是从全基因组关联研究（GWAS）中发现的众多相关单核苷酸多态性（SNP）中进行筛选。由于连锁不平衡（LD），许多SNP的遗传效应是相关的，将它们全部纳入模型会造成信息冗余。本练习将引导您完成连锁不平衡筛选（LD clumping）的算法过程，这是一个选择近似独立的代表性SNP以构建有效PRS的核心实践。",
            "id": "4369034",
            "problem": "一种疾病的多基因风险评分（PRS）定义为单核苷酸多态性（SNP）基因型与其全基因组关联研究（GWAS）效应值加权的线性组合。形式上，对于一组具有对齐效应等位基因的SNP，个体的PRS为 $ \\sum_{i} w_{i} \\, G_{i} $，其中 $ G_{i} $ 是SNP $ i $ 的等位基因剂量，$ w_{i} $ 是其权重。为避免因连锁不平衡（LD）引起的冗余，应用LD clumping方法，根据统计显著性和成对LD来选择近似独立的索引SNP。\n\n考虑一个包含六个SNP $ G_{1}, G_{2}, G_{3}, G_{4}, G_{5}, G_{6} $ 的单个基因座。全基因组关联研究（GWAS）提供了每个SNP的边际对数优势比效应值 $ \\hat{\\beta}_{i} $ 和 $ p $ 值 $ p_{i} $：\n- $ \\hat{\\beta}_{1} = 0.07 $，$ p_{1} = 3.0 \\times 10^{-4} $，\n- $ \\hat{\\beta}_{2} = -0.11 $，$ p_{2} = 1.0 \\times 10^{-5} $，\n- $ \\hat{\\beta}_{3} = 0.02 $，$ p_{3} = 3.0 \\times 10^{-3} $，\n- $ \\hat{\\beta}_{4} = 0.05 $，$ p_{4} = 1.2 \\times 10^{-4} $，\n- $ \\hat{\\beta}_{5} = 0.13 $，$ p_{5} = 8.0 \\times 10^{-8} $，\n- $ \\hat{\\beta}_{6} = -0.03 $，$ p_{6} = 9.0 \\times 10^{-4} $。\n\n这些SNP的LD矩阵 $ R $（其中条目 $ r_{ij} $ 等于 $ G_{i} $ 和 $ G_{j} $ 之间剂量的皮尔逊相关系数）为：\n$$\nR = \\begin{pmatrix}\n1  0.62  0.10  0.18  0.48  0.05 \\\\\n0.62  1  0.08  0.22  0.65  0.12 \\\\\n0.10  0.08  1  0.09  0.06  0.11 \\\\\n0.18  0.22  0.09  1  0.35  0.15 \\\\\n0.48  0.65  0.06  0.35  1  0.20 \\\\\n0.05  0.12  0.11  0.15  0.20  1\n\\end{pmatrix}.\n$$\n\n使用以下参数执行LD clumping：\n- 纳入 $ p $ 值阈值 $ p_{\\max} = 5.0 \\times 10^{-4} $，\n- LD阈值 $ r_{\\text{thr}}^{2} = 0.20 $，\n- 一个单一窗口假设，即所有六个SNP都位于一个clumping窗口内。\n\nClumping的定义如下：\n1. 筛选出 $ p_{i} \\leq p_{\\max} $ 的SNP。\n2. 将剩余的SNP按 $ p_{i} $ 值升序排列。\n3. 迭代选择最显著的剩余SNP作为索引变异；移除任何相对于所选索引SNP $ i $ 满足 $ r_{ij}^{2} \\geq r_{\\text{thr}}^{2} $ 的剩余SNP $ j $。重复此过程，直到没有SNP剩下。\n\n假设效应等位基因已对齐，并且所选索引SNP的PRS权重是其GWAS边际对数优势比 $ \\hat{\\beta}_{i} $，无需进一步的收缩或重新加权。执行clumping过程，并按索引SNP被选择的顺序，将得到的PRS权重 $ w_{i} $ 报告在一个单行矩阵（LaTeX $ \\texttt{pmatrix} $）中。无需四舍五入。",
            "solution": "目标是应用LD clumping来选择近似独立的索引SNP，然后将PRS权重赋值为其GWAS效应值。我们从多基因风险评分的定义 $ \\sum_{i} w_{i} G_{i} $（其中权重 $ w_{i} $ 通常取为线性组合模型下的边际GWAS效应值）和LD clumping的定义（基于移除与所选索引SNP具有高平方相关性 $ r^{2} $ 的SNP）开始。\n\n步骤1：应用纳入 $ p $ 值阈值 $ p_{\\max} = 5.0 \\times 10^{-4} $。满足 $ p_{i} \\leq p_{\\max} $ 的SNP有：\n- $ G_{5} $，$ p_{5} = 8.0 \\times 10^{-8} $，\n- $ G_{2} $，$ p_{2} = 1.0 \\times 10^{-5} $，\n- $ G_{4} $，$ p_{4} = 1.2 \\times 10^{-4} $，\n- $ G_{1} $，$ p_{1} = 3.0 \\times 10^{-4} $。\nSNP $ G_{3} $ 和 $ G_{6} $ 被排除，因为它们的 $ p $ 值 $ p_{3} = 3.0 \\times 10^{-3} $ 和 $ p_{6} = 9.0 \\times 10^{-4} $ 超过了 $ p_{\\max} $。\n\n步骤2：将入选的SNP按 $ p $ 值升序排列：\n- 第一：$ G_{5} $ ($ p_{5} = 8.0 \\times 10^{-8} $)，\n- 第二：$ G_{2} $ ($ p_{2} = 1.0 \\times 10^{-5} $)，\n- 第三：$ G_{4} $ ($ p_{4} = 1.2 \\times 10^{-4} $)，\n- 第四：$ G_{1} $ ($ p_{1} = 3.0 \\times 10^{-4} $)。\n\n步骤3：使用阈值 $ r_{\\text{thr}}^{2} = 0.20 $ 进行迭代clumping。\n- 选择 $ G_{5} $ 作为第一个索引SNP。使用LD矩阵为每个剩余的SNP $ j \\in \\{2,4,1\\} $ 计算 $ r_{5j}^{2} $：\n  - $ r_{5,2} = 0.65 \\Rightarrow r_{5,2}^{2} = 0.65^{2} = 0.4225 \\geq 0.20 $，因此移除 $ G_{2} $。\n  - $ r_{5,4} = 0.35 \\Rightarrow r_{5,4}^{2} = 0.35^{2} = 0.1225  0.20 $，因此保留 $ G_{4} $。\n  - $ r_{5,1} = 0.48 \\Rightarrow r_{5,1}^{2} = 0.48^{2} = 0.2304 \\geq 0.20 $，因此移除 $ G_{1} $。\n  此步骤后，剩余的SNP集合为 $ \\{ G_{4} \\} $。\n- 选择 $ G_{4} $ 作为第二个索引SNP。没有其他剩余的SNP可供评估移除。\n\n因此，按选择顺序，所选的索引SNP为 $ G_{5} $，然后是 $ G_{4} $。\n\n步骤4：为所选的索引SNP分配PRS权重 $ w_{i} = \\hat{\\beta}_{i} $，使用提供的GWAS效应值：\n- 对于 $ G_{5} $，$ \\hat{\\beta}_{5} = 0.13 $，因此 $ w_{5} = 0.13 $。\n- 对于 $ G_{4} $，$ \\hat{\\beta}_{4} = 0.05 $，因此 $ w_{4} = 0.05 $。\n\n按选择顺序将权重报告为单行矩阵。因此，PRS权重向量为\n$$\n\\begin{pmatrix}\n0.13  0.05\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.13  0.05\\end{pmatrix}}$$"
        },
        {
            "introduction": "选定用于评分的SNP后，我们便可以为特定个体计算其多基因风险评分。在实践中，我们通常使用经基因型填补（genotype imputation）得到的概率性数据，而非确定的基因型。本练习将指导您如何利用填补后验概率计算期望的等位基因剂量，并结合GWAS效应量（effect size）来构建一个以人群为基准进行中心化的PRS。",
            "id": "4369030",
            "problem": "在一个复杂疾病的病例对照研究中，风险在对数优势比尺度上使用跨独立双等位基因位点的加性遗传结构进行建模。考虑三个由 $j \\in \\{1,2,3\\}$ 索引的单核苷酸变异，每个变异都有一个单位点等位基因的对数优势比效应值 $\\beta_{j}$，以及一个个体的推算基因型，其由携带 $0$、$1$ 或 $2$ 个次要等位基因的后验概率 $\\big(P_{j,0},P_{j,1},P_{j,2}\\big)$ 概括。假设一个参考群体处于哈代-温伯格平衡状态，每个位点的次要等位基因频率为 $f_{j}$。\n\n从离散随机变量期望的定义和哈代-温伯格基因型频率原理出发，通过以下步骤构建该个体相对于参考群体的、在对数优势比尺度上的均值中心化多基因风险评分 (PRS)：(i) 用给定推算后验概率的条件期望替换每个未观察到的基因型计数，以及 (ii) 在每个位点减去群体平均基因型计数。然后，使用以下数据对这个均值中心化的 PRS 进行数值评估：\n- 单位点等位基因的对数优势比效应值：$\\beta_{1}=0.15$，$\\beta_{2}=-0.07$，$\\beta_{3}=0.04$。\n- 推算后验概率：\n  - 位点 $1$：$\\big(P_{1,0},P_{1,1},P_{1,2}\\big)=\\big(0.02,0.18,0.80\\big)$，\n  - 位点 $2$：$\\big(P_{2,0},P_{2,1},P_{2,2}\\big)=\\big(0.60,0.35,0.05\\big)$，\n  - 位点 $3$：$\\big(P_{3,0},P_{3,1},P_{3,2}\\big)=\\big(0.10,0.30,0.60\\big)$。\n- 参考群体次要等位基因频率：$f_{1}=0.45$，$f_{2}=0.20$，$f_{3}=0.40$。\n\n以单个实数的形式提供均值中心化 PRS 的最终数值。将您的答案四舍五入到四位有效数字。不需要单位。",
            "solution": "在加性模型下，多基因风险评分 (PRS) 是多个遗传位点上等位基因计数的加权和。在对数优势比尺度上，它由下式给出：\n$$\nPRS = \\sum_{j} \\beta_j G_j\n$$\n其中 $\\beta_j$ 是位点 $j$ 上次要等位基因的单位点等位基因对数优势比效应值，而 $G_j$ 是个体在该位点上的次要等位基因数量（基因型计数，取值于 $\\{0, 1, 2\\}$）。\n\n问题要求构建一个均值中心化的 PRS，其形式如下：\n$$\nPRS_{centered} = \\sum_{j} \\beta_j (G_{j, \\text{ind}} - G_{j, \\text{pop mean}})\n$$\n其中 $G_{j, \\text{ind}}$ 是个体的基因型计数，而 $G_{j, \\text{pop mean}}$ 是参考群体中的平均基因型计数。\n\n**部分 (i)：个体的基因型计数**\n个体的真实基因型计数 $G_j$ 未被直接观察到。我们被要求用给定推算后验概率 $(P_{j,0}, P_{j,1}, P_{j,2})$ 的条件期望 $\\hat{G}_j$ 来代替它。这个离散随机变量的期望是：\n$$\n\\hat{G}_j = E[G_j | \\text{imputation data}] = (0 \\cdot P_{j,0}) + (1 \\cdot P_{j,1}) + (2 \\cdot P_{j,2}) = P_{j,1} + 2P_{j,2}\n$$\n\n**部分 (ii)：群体平均基因型计数**\n参考群体处于哈代-温伯格平衡 (HWE) 状态，其次要等位基因频率为 $f_j$。在 HWE 下，具有 $0$、$1$ 和 $2$ 个次要等位基因的基因型频率分别为 $(1-f_j)^2$、$2f_j(1-f_j)$ 和 $f_j^2$。群体中的平均基因型计数 $E_{pop}[G_j]$ 是该分布下基因型计数的期望：\n$$\nE_{pop}[G_j] = (0 \\cdot (1-f_j)^2) + (1 \\cdot 2f_j(1-f_j)) + (2 \\cdot f_j^2)\n$$\n$$\nE_{pop}[G_j] = 2f_j - 2f_j^2 + 2f_j^2 = 2f_j\n$$\n\n**构建均值中心化 PRS**\n结合这些结果，个体均值中心化 PRS 的公式为：\n$$\nPRS_{centered} = \\sum_{j=1}^{3} \\beta_j (\\hat{G}_j - E_{pop}[G_j]) = \\sum_{j=1}^{3} \\beta_j ((P_{j,1} + 2P_{j,2}) - 2f_j)\n$$\n\n**数值评估**\n我们现在计算每个位点 $j \\in \\{1, 2, 3\\}$ 的分量。\n\n**对于位点 1：**\n- $\\beta_1 = 0.15$\n- $\\hat{G}_1 = P_{1,1} + 2P_{1,2} = 0.18 + 2(0.80) = 0.18 + 1.60 = 1.78$\n- $E_{pop}[G_1] = 2f_1 = 2(0.45) = 0.90$\n- 来自位点 1 的贡献是：$\\beta_1 (\\hat{G}_1 - E_{pop}[G_1]) = 0.15(1.78 - 0.90) = 0.15(0.88) = 0.132$\n\n**对于位点 2：**\n- $\\beta_2 = -0.07$\n- $\\hat{G}_2 = P_{2,1} + 2P_{2,2} = 0.35 + 2(0.05) = 0.35 + 0.10 = 0.45$\n- $E_{pop}[G_2] = 2f_2 = 2(0.20) = 0.40$\n- 来自位点 2 的贡献是：$\\beta_2 (\\hat{G}_2 - E_{pop}[G_2]) = -0.07(0.45 - 0.40) = -0.07(0.05) = -0.0035$\n\n**对于位点 3：**\n- $\\beta_3 = 0.04$\n- $\\hat{G}_3 = P_{3,1} + 2P_{3,2} = 0.30 + 2(0.60) = 0.30 + 1.20 = 1.50$\n- $E_{pop}[G_3] = 2f_3 = 2(0.40) = 0.80$\n- 来自位点 3 的贡献是：$\\beta_3 (\\hat{G}_3 - E_{pop}[G_3]) = 0.04(1.50 - 0.80) = 0.04(0.70) = 0.028$\n\n**总均值中心化 PRS**\n总 PRS 是每个位点贡献的总和：\n$$\nPRS_{centered} = 0.132 + (-0.0035) + 0.028\n$$\n$$\nPRS_{centered} = 0.132 - 0.0035 + 0.028 = 0.1285 + 0.028 = 0.1565\n$$\n问题要求答案四舍五入到四位有效数字。计算出的值 $0.1565$ 已经恰好有四位有效数字 ($1$, $5$, $6$, $5$)。因此，无需进一步四舍五入。",
            "answer": "$$ \\boxed{0.1565} $$"
        },
        {
            "introduction": "一个原始的多基因风险评分数值本身（例如 $0.6453$）缺乏直观的临床意义，其相对高低取决于它在参考人群中的位置。为了使评分具有可比性和可解释性，必须将其标准化。本练习将向您展示如何将一个原始PRS分数转换为标准的z-score，从而能够清晰地了解一个个体相对于参考群体的遗传风险水平。",
            "id": "4369012",
            "problem": "在精准医疗的背景下，多基因风险评分 (Polygenic Risk Score, PRS) 在一个加性遗传模型下，汇总了许多单核苷酸多态性 (Single-Nucleotide Polymorphisms, SNPs) 的贡献。在该模型中，从全基因组关联研究 (Genome-Wide Association Studies, GWAS) 中估计出的每个等位基因的效应，与通过插补得到的个体效应等位基因基因型剂量相结合。考虑一个由 $5$ 个 SNPs 构建的 PRS，其 GWAS 每个等位基因的对数优势比权重与效应等位基因对齐，以及个体相应的效应等位基因剂量如下：\n- SNP $1$：权重 $0.137$，剂量 $1.8$。\n- SNP $2$：权重 $-0.052$，剂量 $0.7$。\n- SNP $3$：权重 $0.221$，剂量 $2.0$。\n- SNP $4$：权重 $0.018$，剂量 $1.2$。\n- SNP $5$：权重 $-0.095$，剂量 $0.3$。\n\n假设加性模型成立，链方向比对正确，并且除了所述内容外，没有应用进一步的收缩或缩放。对于此精确设定（相同的 SNP 集合、权重和等位基因编码），参考人群的 PRS 分布的均值为 $\\mu = 0.312$，标准差 (SD) 为 $\\sigma = 0.274$。\n\n使用这些输入计算个体的 PRS，然后使用提供的参考均值和标准差将其标准化为 $z$-分数。仅报告最终的标准化 PRS（$z$-分数），并四舍五入到 $4$ 位有效数字。",
            "solution": "该问题首先要求基于加性遗传模型计算个体的多基因风险评分 (PRS)。PRS 的计算方法是，将一组 $N$ 个单核苷酸多态性 (SNPs) 的每个等位基因效应权重 ($w_i$) 与相应的效应等位基因剂量 ($d_i$) 的乘积相加。PRS 的公式为：\n$$PRS = \\sum_{i=1}^{N} w_i d_i$$\n在这个问题中，我们给出了 $N=5$ 个 SNPs 的权重和剂量：\n1. SNP $1$：权重 $w_1 = 0.137$，剂量 $d_1 = 1.8$\n2. SNP $2$：权重 $w_2 = -0.052$，剂量 $d_2 = 0.7$\n3. SNP $3$：权重 $w_3 = 0.221$，剂量 $d_3 = 2.0$\n4. SNP $4$：权重 $w_4 = 0.018$，剂量 $d_4 = 1.2$\n5. SNP $5$：权重 $w_5 = -0.095$，剂量 $d_5 = 0.3$\n\n我们通过将这些值代入公式来计算个体的 PRS：\n$$PRS = (w_1 d_1) + (w_2 d_2) + (w_3 d_3) + (w_4 d_4) + (w_5 d_5)$$\n$$PRS = (0.137 \\times 1.8) + (-0.052 \\times 0.7) + (0.221 \\times 2.0) + (0.018 \\times 1.2) + (-0.095 \\times 0.3)$$\n首先，我们计算每个乘积项：\n- 第 $1$ 项：$0.137 \\times 1.8 = 0.2466$\n- 第 $2$ 项：$-0.052 \\times 0.7 = -0.0364$\n- 第 $3$ 项：$0.221 \\times 2.0 = 0.4420$\n- 第 $4$ 项：$0.018 \\times 1.2 = 0.0216$\n- 第 $5$ 项：$-0.095 \\times 0.3 = -0.0285$\n\n接下来，我们将这些项相加以获得总 PRS：\n$$PRS = 0.2466 - 0.0364 + 0.4420 + 0.0216 - 0.0285$$\n$$PRS = 0.6453$$\n\n问题的第二部分是使用提供的参考人群均值 ($\\mu$) 和标准差 ($\\sigma$) 将此原始 PRS 标准化为 $z$-分数。$z$-分数的公式为：\n$$z = \\frac{X - \\mu}{\\sigma}$$\n其中 $X$ 是个体的分数，也就是计算出的 PRS。\n给定的参考人群参数为：\n- 均值 $\\mu = 0.312$\n- 标准差 $\\sigma = 0.274$\n\n将计算出的 PRS 和给定的人群参数代入 $z$-分数公式：\n$$z = \\frac{0.6453 - 0.312}{0.274}$$\n$$z = \\frac{0.3333}{0.274}$$\n$$z \\approx 1.21642335766$$\n\n问题要求最终答案四舍五入到 $4$ 位有效数字。计算值约为 $1.2164$。前四位有效数字是 $1$、$2$、$1$ 和 $6$。第五位数字是 $4$，小于 $5$，因此我们向下舍入，保持第四位有效数字不变。\n因此，标准化 PRS（即 $z$-分数）四舍五入到 $4$ 位有效数字为 $1.216$。",
            "answer": "$$\\boxed{1.216}$$"
        }
    ]
}