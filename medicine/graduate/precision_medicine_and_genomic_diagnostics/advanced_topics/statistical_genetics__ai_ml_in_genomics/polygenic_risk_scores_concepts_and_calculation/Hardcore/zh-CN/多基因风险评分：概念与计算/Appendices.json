{
    "hands_on_practices": [
        {
            "introduction": "要掌握多基因风险评分 (PRS)，动手实践至关重要。本章将指导您完成三个核心练习，涵盖了从构建到解释 PRS 的关键步骤。我们的第一个练习专注于一个基本步骤：从全基因组关联研究 (GWAS) 的大量结果中选择信息最丰富且不冗余的遗传变异。由于连锁不平衡 (LD) 的存在，许多信号是相关的，因此我们使用一种称为 LD 聚类 (LD clumping) 的算法来挑选出最具代表性的“索引 SNPs”，以避免重复计算遗传效应。这个练习将让您亲手执行这一关键算法，为构建一个稳健的 PRS 打下基础。",
            "id": "4369034",
            "problem": "一种疾病的多基因风险评分 (PRS) 定义为单核苷酸多态性 (SNP) 基因型的线性组合，其权重为其全基因组关联研究 (GWAS) 的效应量。形式上，对于一组具有对齐的效应等位基因的 SNP，个体的 PRS 为 $ \\sum_{i} w_{i} \\, G_{i} $，其中 $ G_{i} $ 是 SNP $ i $ 的等位基因剂量，$ w_{i} $ 是其权重。为避免因连锁不平衡 (LD) 引起的冗余，应用 LD 聚类（clumping）方法，根据统计显著性和成对 LD 来选择近似独立的指示性 SNP。\n\n考虑一个含有六个 SNP $ G_{1}, G_{2}, G_{3}, G_{4}, G_{5}, G_{6} $ 的单个基因座。全基因组关联研究 (GWAS) 提供了每个 SNP 的边际对数优势比效应量 $ \\hat{\\beta}_{i} $ 和 $ p $ 值 $ p_{i} $：\n- $ \\hat{\\beta}_{1} = 0.07 $，$ p_{1} = 3.0 \\times 10^{-4} $，\n- $ \\hat{\\beta}_{2} = -0.11 $，$ p_{2} = 1.0 \\times 10^{-5} $，\n- $ \\hat{\\beta}_{3} = 0.02 $，$ p_{3} = 3.0 \\times 10^{-3} $，\n- $ \\hat{\\beta}_{4} = 0.05 $，$ p_{4} = 1.2 \\times 10^{-4} $，\n- $ \\hat{\\beta}_{5} = 0.13 $，$ p_{5} = 8.0 \\times 10^{-8} $，\n- $ \\hat{\\beta}_{6} = -0.03 $，$ p_{6} = 9.0 \\times 10^{-4} $。\n\n这些 SNP 的 LD 矩阵 $ R $（其中条目 $ r_{ij} $ 等于 $ G_{i} $ 和 $ G_{j} $ 之间剂量的皮尔逊相关性）为：\n$$\nR = \\begin{pmatrix}\n1  0.62  0.10  0.18  0.48  0.05 \\\\\n0.62  1  0.08  0.22  0.65  0.12 \\\\\n0.10  0.08  1  0.09  0.06  0.11 \\\\\n0.18  0.22  0.09  1  0.35  0.15 \\\\\n0.48  0.65  0.06  0.35  1  0.20 \\\\\n0.05  0.12  0.11  0.15  0.20  1\n\\end{pmatrix}.\n$$\n\n使用以下参数执行 LD 聚类：\n- 纳入 $ p $ 值阈值 $ p_{\\max} = 5.0 \\times 10^{-4} $，\n- LD 阈值 $ r_{\\text{thr}}^{2} = 0.20 $，\n- 单一窗口假设，即所有六个 SNP 都位于一个聚类窗口内。\n\n聚类定义如下：\n1. 筛选出 $ p_{i} \\leq p_{\\max} $ 的 SNP。\n2. 将剩余的 SNP 按 $ p_{i} $ 升序排列。\n3. 迭代选择剩余的最显著的 SNP 作为指示性变异；移除与所选指示性 SNP $ i $ 满足 $ r_{ij}^{2} \\geq r_{\\text{thr}}^{2} $ 的任何剩余 SNP $ j $。继续此过程，直到没有 SNP 剩余。\n\n假设效应等位基因已对齐，并且所选指示性 SNP 的 PRS 权重是其 GWAS 边际对数优势比 $ \\hat{\\beta}_{i} $，无需进一步的收缩或重新加权。执行聚类过程，并按指示性 SNP 被选中的顺序，将得到的 PRS 权重 $ w_{i} $ 报告在一个单行矩阵（LaTeX $ \\texttt{pmatrix} $）中。无需四舍五入。",
            "solution": "目标是应用 LD 聚类来选择近似独立的指示性 SNP，然后将 PRS 权重设定为等于它们的 GWAS 效应量。我们从多基因风险评分的定义 $ \\sum_{i} w_{i} G_{i} $ 开始，在线性组合模型下，权重 $ w_{i} $ 通常取为边际 GWAS 效应量，并从 LD 聚类的定义开始，即基于与选定指示性 SNP 的高平方相关性 $ r^{2} $ 来移除 SNP。\n\n步骤 1：应用纳入 $ p $ 值阈值 $ p_{\\max} = 5.0 \\times 10^{-4} $。满足 $ p_{i} \\leq p_{\\max} $ 的 SNP 是：\n- $ G_{5} $，$ p_{5} = 8.0 \\times 10^{-8} $，\n- $ G_{2} $，$ p_{2} = 1.0 \\times 10^{-5} $，\n- $ G_{4} $，$ p_{4} = 1.2 \\times 10^{-4} $，\n- $ G_{1} $，$ p_{1} = 3.0 \\times 10^{-4} $。\nSNP $ G_{3} $ 和 $ G_{6} $ 被排除，因为它们的 $ p_{3} = 3.0 \\times 10^{-3} $ 和 $ p_{6} = 9.0 \\times 10^{-4} $ 超过了 $ p_{\\max} $。\n\n步骤 2：将入选的 SNP 按 $ p $ 值升序排列：\n- 第一：$ G_{5} $ ($ p_{5} = 8.0 \\times 10^{-8} $)，\n- 第二：$ G_{2} $ ($ p_{2} = 1.0 \\times 10^{-5} $)，\n- 第三：$ G_{4} $ ($ p_{4} = 1.2 \\times 10^{-4} $)，\n- 第四：$ G_{1} $ ($ p_{1} = 3.0 \\times 10^{-4} $)。\n\n步骤 3：使用阈值 $ r_{\\text{thr}}^{2} = 0.20 $ 进行迭代聚类。\n- 选择 $ G_{5} $ 作为第一个指示性 SNP。使用 LD 矩阵计算每个剩余 SNP $ j \\in \\{2,4,1\\} $ 的 $ r_{5j}^{2} $：\n  - $ r_{5,2} = 0.65 \\Rightarrow r_{5,2}^{2} = 0.65^{2} = 0.4225 \\geq 0.20 $，因此移除 $ G_{2} $。\n  - $ r_{5,4} = 0.35 \\Rightarrow r_{5,4}^{2} = 0.35^{2} = 0.1225  0.20 $，因此保留 $ G_{4} $。\n  - $ r_{5,1} = 0.48 \\Rightarrow r_{5,1}^{2} = 0.48^{2} = 0.2304 \\geq 0.20 $，因此移除 $ G_{1} $。\n  此步骤后，剩余的 SNP 集合是 $ \\{ G_{4} \\} $。\n- 选择 $ G_{4} $ 作为第二个指示性 SNP。没有其他剩余的 SNP 需要评估移除。\n\n因此，按选择顺序列出的指示性 SNP 是 $ G_{5} $，然后是 $ G_{4} $。\n\n步骤 4：对于选定的指示性 SNP，使用提供的 GWAS 效应量来分配 PRS 权重 $ w_{i} = \\hat{\\beta}_{i} $：\n- 对于 $ G_{5} $，$ \\hat{\\beta}_{5} = 0.13 $，所以 $ w_{5} = 0.13 $。\n- 对于 $ G_{4} $，$ \\hat{\\beta}_{4} = 0.05 $，所以 $ w_{4} = 0.05 $。\n\n将权重按选择顺序报告为单行矩阵。因此，PRS 权重向量是\n$$\n\\begin{pmatrix}\n0.13  0.05\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.13  0.05\\end{pmatrix}}$$"
        },
        {
            "introduction": "在确定了用于评分的 SNPs 及其权重之后，下一步是为特定个体计算评分。在现代基因组学中，我们处理的通常是“估算”基因型数据，这意味着我们得到的是基因型的概率而非确定的结果。本练习将向您展示如何利用这些概率计算预期的等位基因剂量，并构建一个“均值中心化”的 PRS。这种中心化的方法通过将个体的遗传风险与群体平均水平进行比较，使得分数更具解释性。",
            "id": "4369030",
            "problem": "在一项复杂疾病的病例对照研究中，风险通过在多个独立的双等位基因位点上使用加性遗传结构，在对数优势比尺度上进行建模。\n\n考虑由 $j \\in \\{1,2,3\\}$ 索引的三个单核苷酸变异，每个变异都具有每个等位基因的对数优势比效应量 $\\beta_{j}$，以及一个个体的填补基因型，该基因型由携带 $0$、$1$ 或 $2$ 个次要等位基因的后验概率 $\\big(P_{j,0},P_{j,1},P_{j,2}\\big)$ 概括。假设一个参考群体在每个位点上都处于哈迪-温伯格平衡状态，且次要等位基因频率为 $f_{j}$。\n\n从离散随机变量的期望的定义和基因型频率的哈迪-温伯格原理出发，通过以下步骤构建该个体相对于参考群体的、在对数优势比尺度上的均值中心化多基因风险评分（PRS）：(i) 将每个未观察到的基因型计数替换为其在给定填补后验概率下的条件期望，以及 (ii) 减去每个位点上的群体平均基因型计数。然后，根据以下数据，数值计算这个均值中心化的PRS：\n- 每个等位基因的对数优势比效应量：$\\beta_{1}=0.15$，$\\beta_{2}=-0.07$，$\\beta_{3}=0.04$。\n- 填补后验概率：\n  - 位点 $1$：$\\big(P_{1,0},P_{1,1},P_{1,2}\\big)=\\big(0.02,0.18,0.80\\big)$，\n  - 位点 $2$：$\\big(P_{2,0},P_{2,1},P_{2,2}\\big)=\\big(0.60,0.35,0.05\\big)$，\n  - 位点 $3$：$\\big(P_{3,0},P_{3,1},P_{3,2}\\big)=\\big(0.10,0.30,0.60\\big)$。\n- 参考群体次要等位基因频率：$f_{1}=0.45$，$f_{2}=0.20$，$f_{3}=0.40$。\n\n以单个实数的形式提供均值中心化PRS的最终数值。将答案四舍五入至四位有效数字。无需单位。",
            "solution": "在加性模型下，多基因风险评分（PRS）是多个遗传位点上等位基因计数的加权和。在对数优势比尺度上，它由下式给出：\n$$\nPRS = \\sum_{j} \\beta_j G_j\n$$\n其中 $\\beta_j$ 是位点 $j$ 上次要等位基因的每个等位基因的对数优势比效应量，$G_j$ 是个体在该位点上的次要等位基因数量（基因型计数，取值于 $\\{0, 1, 2\\}$）。\n\n问题要求构建一个均值中心化的PRS，其形式为：\n$$\nPRS_{centered} = \\sum_{j} \\beta_j (G_{j, \\text{ind}} - G_{j, \\text{pop mean}})\n$$\n其中 $G_{j, \\text{ind}}$ 是个体的基因型计数，$G_{j, \\text{pop mean}}$ 是参考群体中的平均基因型计数。\n\n**第 (i) 部分：个体的基因型计数**\n个体的真实基因型计数 $G_j$ 未被直接观察到。我们被要求用其在给定填补后验概率 $(P_{j,0}, P_{j,1}, P_{j,2})$ 下的条件期望 $\\hat{G}_j$ 来替代它。这个离散随机变量的期望是：\n$$\n\\hat{G}_j = E[G_j | \\text{imputation data}] = (0 \\cdot P_{j,0}) + (1 \\cdot P_{j,1}) + (2 \\cdot P_{j,2}) = P_{j,1} + 2P_{j,2}\n$$\n\n**第 (ii) 部分：群体平均基因型计数**\n参考群体处于哈迪-温伯格平衡（HWE）状态，其次要等位基因频率为 $f_j$。在HWE下，携带 $0$、$1$ 和 $2$ 个次要等位基因的基因型频率分别为 $(1-f_j)^2$、$2f_j(1-f_j)$ 和 $f_j^2$。群体中的平均基因型计数 $E_{pop}[G_j]$ 是该分布下基因型计数的期望值：\n$$\nE_{pop}[G_j] = (0 \\cdot (1-f_j)^2) + (1 \\cdot 2f_j(1-f_j)) + (2 \\cdot f_j^2)\n$$\n$$\nE_{pop}[G_j] = 2f_j - 2f_j^2 + 2f_j^2 = 2f_j\n$$\n\n**构建均值中心化的PRS**\n结合这些结果，个体均值中心化PRS的公式为：\n$$\nPRS_{centered} = \\sum_{j=1}^{3} \\beta_j (\\hat{G}_j - E_{pop}[G_j]) = \\sum_{j=1}^{3} \\beta_j ((P_{j,1} + 2P_{j,2}) - 2f_j)\n$$\n\n**数值计算**\n我们现在为每个位点 $j \\in \\{1, 2, 3\\}$ 计算其组成部分。\n\n**对于位点 1：**\n- $\\beta_1 = 0.15$\n- $\\hat{G}_1 = P_{1,1} + 2P_{1,2} = 0.18 + 2(0.80) = 0.18 + 1.60 = 1.78$\n- $E_{pop}[G_1] = 2f_1 = 2(0.45) = 0.90$\n- 来自位点 1 的贡献是：$\\beta_1 (\\hat{G}_1 - E_{pop}[G_1]) = 0.15(1.78 - 0.90) = 0.15(0.88) = 0.132$\n\n**对于位点 2：**\n- $\\beta_2 = -0.07$\n- $\\hat{G}_2 = P_{2,1} + 2P_{2,2} = 0.35 + 2(0.05) = 0.35 + 0.10 = 0.45$\n- $E_{pop}[G_2] = 2f_2 = 2(0.20) = 0.40$\n- 来自位点 2 的贡献是：$\\beta_2 (\\hat{G}_2 - E_{pop}[G_2]) = -0.07(0.45 - 0.40) = -0.07(0.05) = -0.0035$\n\n**对于位点 3：**\n- $\\beta_3 = 0.04$\n- $\\hat{G}_3 = P_{3,1} + 2P_{3,2} = 0.30 + 2(0.60) = 0.30 + 1.20 = 1.50$\n- $E_{pop}[G_3] = 2f_3 = 2(0.40) = 0.80$\n- 来自位点 3 的贡献是：$\\beta_3 (\\hat{G}_3 - E_{pop}[G_3]) = 0.04(1.50 - 0.80) = 0.04(0.70) = 0.028$\n\n**总均值中心化PRS**\n总PRS是每个位点贡献的总和：\n$$\nPRS_{centered} = 0.132 + (-0.0035) + 0.028\n$$\n$$\nPRS_{centered} = 0.132 - 0.0035 + 0.028 = 0.1285 + 0.028 = 0.1565\n$$\n题目要求答案四舍五入至四位有效数字。计算出的值 $0.1565$ 已经恰好有四位有效数字（$1$、$5$、$6$、$5$）。因此，无需进一步四舍五入。",
            "answer": "$$ \\boxed{0.1565} $$"
        },
        {
            "introduction": "一个原始的 PRS 数值本身并没有太多意义；其临床和研究价值来自于将其置于参考群体的大背景下进行解读。本练习探讨了这一关键解释步骤背后的理论基础。它将演示中心极限定理如何允许我们将 PRS 的分布近似为正态分布，并由此推导出一个简洁的公式，使用标准正态分布将任何原始分数转换为其对应的百分位等级，从而赋予该数值明确的统计意义。",
            "id": "4368997",
            "problem": "在用于基因组诊断的精准医疗流程中，个体对于某种复杂疾病的多基因风险评分（PRS）是通过单核苷酸多态性效应大小的加权和计算得出的。在许多独立的加性遗传效应共同构成PRS的假设下，中心极限定理意味着在一个大型、祖源匹配的参考人群中，PRS的分布可以很好地用均值为 $\\mu$、标准差为 $\\sigma$ 的高斯（正态）分布来近似。令 $X$ 表示参考人群中PRS的随机变量，并假设 $X$ 近似服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布。个体原始PRS值 $x$ 的百分位数定义为从参考人群中随机抽取一个个体，其PRS小于或等于 $x$ 的概率，即 $X$ 的累积分布函数（CDF）在 $x$ 处的值。使用累积分布函数（CDF）的定义以及到标准正态分布的标准化（z-score）变换，推导一个将原始PRS值 $x$ 转换为其百分位数的解析表达式，该表达式用 $\\mu$、$\\sigma$ 和 $x$ 表示，并通过标准正态累积分布函数 $\\Phi$ 来表达。你的最终答案必须是单个闭式表达式。",
            "solution": "题目要求推导原始多基因风险评分（PRS）值 $x$ 的百分位数的解析表达式。百分位数定义为从参考人群中随机抽取一个个体，其PRS小于或等于 $x$ 的概率。\n\n首先，我们根据所提供的信息将问题形式化。令 $X$ 为代表参考人群中PRS的随机变量。题目指出，$X$ 可以很好地用均值为 $\\mu$、方差为 $\\sigma^2$ 的正态（高斯）分布来近似。这被记为 $X \\sim N(\\mu, \\sigma^2)$。该分布的标准差为 $\\sigma$。\n\n与特定PRS值 $x$ 对应的百分位数是 $X$ 的累积分布函数（CDF）在 $x$ 处的值，我们将其记为 $F_X(x)$。根据定义，即为：\n$$\n\\text{Percentile}(x) = P(X \\le x)\n$$\n\n目标是使用标准正态累积分布函数 $\\Phi(z)$ 来表示此概率。标准正态分布是均值为 $0$、方差为 $1$ 的正态分布的一个特例。服从此分布的随机变量 $Z$ 记为 $Z \\sim N(0, 1)$。其CDF由下式给出：\n$$\n\\Phi(z) = P(Z \\le z) = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{z} \\exp\\left(-\\frac{t^2}{2}\\right) dt\n$$\n\n为了将概率 $P(X \\le x)$ 与标准正态CDF $\\Phi$ 联系起来，我们必须执行标准化变换（也称为创建z-score）。此变换将随机变量 $X$ 转换为标准正态随机变量 $Z$。该变换定义为：\n$$\nZ = \\frac{X - \\mu}{\\sigma}\n$$\n已知 $X \\sim N(\\mu, \\sigma^2)$，变换后的变量 $Z$ 将服从分布 $Z \\sim N(0, 1)$。\n\n现在，我们可以操作概率表达式 $P(X \\le x)$ 内部的不等式，以用 $Z$ 来表示它。\n我们从不等式开始：\n$$\nX \\le x\n$$\n为了应用标准化，我们首先在不等式两边减去均值 $\\mu$：\n$$\nX - \\mu \\le x - \\mu\n$$\n接下来，我们将两边除以标准差 $\\sigma$。由于 $\\sigma$ 代表标准差，它本质上是一个非负量。对于一个非退化的正态分布，$\\sigma > 0$。除以一个正数不会改变不等式的方向：\n$$\n\\frac{X - \\mu}{\\sigma} \\le \\frac{x - \\mu}{\\sigma}\n$$\n这个不等式的左边正是我们的标准化随机变量 $Z$。因此，不等式变为：\n$$\nZ \\le \\frac{x - \\mu}{\\sigma}\n$$\n将这个变换后的不等式代回概率表达式中，我们发现关于 $X$ 的概率可以表示为关于 $Z$ 的概率：\n$$\nP(X \\le x) = P\\left(\\frac{X - \\mu}{\\sigma} \\le \\frac{x - \\mu}{\\sigma}\\right) = P\\left(Z \\le \\frac{x - \\mu}{\\sigma}\\right)\n$$\n根据标准正态CDF的定义 $\\Phi(z) = P(Z \\le z)$，我们可以直接写出最终表达式。我们将 $\\Phi$ 的参数设置为我们不等式右侧的值：\n$$\nP\\left(Z \\le \\frac{x - \\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{x - \\mu}{\\sigma}\\right)\n$$\n因此，将原始PRS值 $x$ 转换为其在参考人群中百分位数的解析表达式，用 $\\mu$, $\\sigma$, $x$ 和标准正态CDF $\\Phi$ 表示，是 $\\Phi\\left(\\frac{x - \\mu}{\\sigma}\\right)$。这个闭式表达式代表了参考人群中PRS值小于或等于 $x$ 的比例。",
            "answer": "$$\\boxed{\\Phi\\left(\\frac{x - \\mu}{\\sigma}\\right)}$$"
        }
    ]
}