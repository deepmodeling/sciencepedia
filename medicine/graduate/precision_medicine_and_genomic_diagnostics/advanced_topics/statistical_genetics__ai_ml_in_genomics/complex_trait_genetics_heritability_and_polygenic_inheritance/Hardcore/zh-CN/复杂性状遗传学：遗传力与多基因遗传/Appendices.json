{
    "hands_on_practices": [
        {
            "introduction": "亲子回归是估计狭义遗传力（$h^2$）的一种经典方法，它构成了复杂性状遗传学的基础。通过这项练习，你将从第一性原理出发，推导后代表型对中亲代（mid-parent）表型回归的斜率与遗传力之间的直接关系。更重要的是，本题探讨了一个现实世界中的关键问题：父母表型中的测量误差如何影响遗传力的估计，以及如何利用可靠性数据来校正这种偏差，从而获得更准确的遗传力估计值。",
            "id": "4328507",
            "problem": "在一项旨在实现精准医疗和基因组诊断的基于人群的生物样本库研究中，考虑一个复杂数量性状，例如成年人收缩压。假设其为加性多基因结构，伴随随机交配且无选择性交配，并忽略显性、上位性、代际间共享环境协方差以及基因-环境相关性。定义狭义遗传力为 $h^{2} = V_{A} / V_{P}$，其中 $V_{A}$ 是加性遗传方差，$V_{P}$ 是总表型方差。\n\n进行亲代中值-子代回归分析，使用观测到的亲代中值表型作为预测变量，子代表型作为响应变量。令 $Y_{f}^{\\mathrm{true}}$ 和 $Y_{m}^{\\mathrm{true}}$ 表示真实的亲代表型，$Y_{f}^{\\mathrm{obs}} = Y_{f}^{\\mathrm{true}} + e_{f}$ 和 $Y_{m}^{\\mathrm{obs}} = Y_{m}^{\\mathrm{true}} + e_{m}$ 为其观测值，其中 $e_{f}$ 和 $e_{m}$ 是独立的经典测量误差，均值为零，方差为 $\\sigma_{e}^{2}$，且与所有真实表型独立。真实亲代中值为 $M^{\\mathrm{true}} = \\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}$，观测亲代中值为 $M^{\\mathrm{obs}} = \\frac{Y_{f}^{\\mathrm{obs}} + Y_{m}^{\\mathrm{obs}}}{2} = M^{\\mathrm{true}} + \\varepsilon_{M}$，其中 $\\varepsilon_{M} = \\frac{e_{f} + e_{m}}{2}$。子代表型 $Y_{o}$ 的测量误差可忽略不计。在数据集中，子代对观测亲代中值的普通最小二乘法回归斜率为 $b = 0.45$。独立的重测信度研究确定，每个亲本的重测信度（定义为 $\\mathrm{Var}(Y^{\\mathrm{true}})/\\mathrm{Var}(Y^{\\mathrm{obs}})$）为 $r_{p} = 0.80$。\n\n从核心数量遗传学定义和谱系中协方差的性质出发，推导子代对真实亲代中值的回归斜率与 $h^{2}$ 之间的关系，然后推导亲本中的经典测量误差如何减弱观测斜率。利用这些推导，计算该数据集经测量误差校正后的狭义遗传力 $h^{2}$，并报告一个单一数值。无需四舍五入。",
            "solution": "问题要求计算经过亲代表型测量误差校正后的狭义遗传力 $h^2$。解答将按照题目要求分三步进行：首先，推导真实亲代中值-子代回归斜率与 $h^2$ 之间的关系；其次，推导测量误差对该斜率的减弱作用；最后，应用这些推导从所提供的数据中计算出 $h^2$。\n\n如题所述，在忽略显性和上位性的情况下，数量性状表型的基本模型是 $Y^{\\mathrm{true}} = A + E_{u}$，其中 $A$ 是加性遗传值，$E_{u}$ 是特殊环境贡献。总表型方差为 $V_P = \\mathrm{Var}(Y^{\\mathrm{true}}) = \\mathrm{Var}(A) + \\mathrm{Var}(E_{u}) = V_A + V_E$。狭义遗传力定义为 $h^2 = V_A / V_P$。\n\n**1. 子代表型对真实亲代中值表型的回归**\n\n响应变量 $Y$ 对预测变量 $X$ 的简单线性回归斜率由 $\\beta_{Y|X} = \\frac{\\mathrm{Cov}(X, Y)}{\\mathrm{Var}(X)}$ 给出。在这里，响应变量是子代表型 $Y_o$，预测变量是真实亲代中值表型 $M^{\\mathrm{true}} = \\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}$。子代表型的测量误差可忽略不计，因此我们可以将其表示为 $Y_o$。该斜率，我们称之为 $\\beta^{\\mathrm{true}}$，是：\n$$\n\\beta^{\\mathrm{true}} = \\frac{\\mathrm{Cov}(Y_o, M^{\\mathrm{true}})}{\\mathrm{Var}(M^{\\mathrm{true}})}\n$$\n我们必须计算分子中的协方差和分母中的方差。\n\n分子：$\\mathrm{Cov}(Y_o, M^{\\mathrm{true}})$\n根据 $M^{\\mathrm{true}}$ 的定义和协方差的性质：\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) = \\mathrm{Cov}\\left(Y_o, \\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}\\right) = \\frac{1}{2} \\left[ \\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}}) + \\mathrm{Cov}(Y_o, Y_{m}^{\\mathrm{true}}) \\right]\n$$\n子代与单个亲本（例如，父亲）之间的协方差是 $\\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}})$。在题目的假设（代际间无共享环境，纯粹的加性遗传）下，该协方差等于它们加性遗传值的协方差：$\\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}}) = \\mathrm{Cov}(A_o, A_f)$。子代从每个亲本随机获得一半的等位基因，因此亲子间加性遗传值的协方差为 $\\frac{1}{2}V_A$。因此：\n$$\n\\mathrm{Cov}(Y_o, Y_{f}^{\\mathrm{true}}) = \\mathrm{Cov}(Y_o, Y_{m}^{\\mathrm{true}}) = \\frac{1}{2}V_A\n$$\n将此代入与亲代中值协方差的表达式中：\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) = \\frac{1}{2} \\left( \\frac{1}{2}V_A + \\frac{1}{2}V_A \\right) = \\frac{1}{2}V_A\n$$\n\n分母：$\\mathrm{Var}(M^{\\mathrm{true}})$\n根据 $M^{\\mathrm{true}}$ 的定义和方差的性质：\n$$\n\\mathrm{Var}(M^{\\mathrm{true}}) = \\mathrm{Var}\\left(\\frac{Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}}{2}\\right) = \\frac{1}{4} \\mathrm{Var}(Y_{f}^{\\mathrm{true}} + Y_{m}^{\\mathrm{true}}) = \\frac{1}{4} \\left[ \\mathrm{Var}(Y_{f}^{\\mathrm{true}}) + \\mathrm{Var}(Y_{m}^{\\mathrm{true}}) + 2\\mathrm{Cov}(Y_{f}^{\\mathrm{true}}, Y_{m}^{\\mathrm{true}}) \\right]\n$$\n亲本来自同一群体，所以 $\\mathrm{Var}(Y_{f}^{\\mathrm{true}}) = \\mathrm{Var}(Y_{m}^{\\mathrm{true}}) = V_P$。题目规定了随机交配且无选择性交配，这意味着亲本的表型不相关：$\\mathrm{Cov}(Y_{f}^{\\mathrm{true}}, Y_{m}^{\\mathrm{true}}) = 0$。因此：\n$$\n\\mathrm{Var}(M^{\\mathrm{true}}) = \\frac{1}{4} (V_P + V_P + 0) = \\frac{2V_P}{4} = \\frac{1}{2}V_P\n$$\n\n结合分子和分母，真实的回归斜率为：\n$$\n\\beta^{\\mathrm{true}} = \\frac{\\frac{1}{2}V_A}{\\frac{1}{2}V_P} = \\frac{V_A}{V_P} = h^2\n$$\n这就得出了经典的数量遗传学结论：子代表型对真实亲代中值表型的回归斜率等于狭义遗传力。\n\n**2. 测量误差对斜率的减弱作用**\n\n观测回归是 $Y_o$ 对观测亲代中值表型 $M^{\\mathrm{obs}} = \\frac{Y_{f}^{\\mathrm{obs}} + Y_{m}^{\\mathrm{obs}}}{2}$ 的回归。给出的观测斜率 $b=0.45$ 为：\n$$\nb = \\frac{\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}})}{\\mathrm{Var}(M^{\\mathrm{obs}})}\n$$\n我们分别分析测量误差对分子和分母的影响。观测表型为 $Y_{f}^{\\mathrm{obs}} = Y_{f}^{\\mathrm{true}} + e_{f}$ 和 $Y_{m}^{\\mathrm{obs}} = Y_{m}^{\\mathrm{true}} + e_{m}$。观测亲代中值为 $M^{\\mathrm{obs}} = M^{\\mathrm{true}} + \\varepsilon_M$，其中 $\\varepsilon_M = \\frac{e_f + e_m}{2}$。\n\n分子：$\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}})$\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}}) = \\mathrm{Cov}(Y_o, M^{\\mathrm{true}} + \\varepsilon_M) = \\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) + \\mathrm{Cov}(Y_o, \\varepsilon_M)\n$$\n测量误差 $e_f$ 和 $e_m$ 与所有真实表型（包括 $Y_o$）独立。因此，它们的平均值 $\\varepsilon_M$ 也与 $Y_o$ 独立，这意味着 $\\mathrm{Cov}(Y_o, \\varepsilon_M) = 0$。分子不受测量误差的影响：\n$$\n\\mathrm{Cov}(Y_o, M^{\\mathrm{obs}}) = \\mathrm{Cov}(Y_o, M^{\\mathrm{true}}) = \\frac{1}{2}V_A\n$$\n\n分母：$\\mathrm{Var}(M^{\\mathrm{obs}})$\n$$\n\\mathrm{Var}(M^{\\mathrm{obs}}) = \\mathrm{Var}(M^{\\mathrm{true}} + \\varepsilon_M) = \\mathrm{Var}(M^{\\mathrm{true}}) + \\mathrm{Var}(\\varepsilon_M) + 2\\mathrm{Cov}(M^{\\mathrm{true}}, \\varepsilon_M)\n$$\n由于误差与真实表型独立，$\\mathrm{Cov}(M^{\\mathrm{true}}, \\varepsilon_M) = 0$。误差项 $\\varepsilon_M$ 的方差为：\n$$\n\\mathrm{Var}(\\varepsilon_M) = \\mathrm{Var}\\left(\\frac{e_f + e_m}{2}\\right) = \\frac{1}{4}\\mathrm{Var}(e_f + e_m)\n$$\n由于 $e_f$ 和 $e_m$ 是独立的，方差均为 $\\sigma_e^2$，所以 $\\mathrm{Var}(e_f + e_m) = \\mathrm{Var}(e_f) + \\mathrm{Var}(e_m) = \\sigma_e^2 + \\sigma_e^2 = 2\\sigma_e^2$。\n$$\n\\mathrm{Var}(\\varepsilon_M) = \\frac{1}{4}(2\\sigma_e^2) = \\frac{1}{2}\\sigma_e^2\n$$\n观测亲代中值的总方差是：\n$$\n\\mathrm{Var}(M^{\\mathrm{obs}}) = \\mathrm{Var}(M^{\\mathrm{true}}) + \\mathrm{Var}(\\varepsilon_M) = \\frac{1}{2}V_P + \\frac{1}{2}\\sigma_e^2 = \\frac{1}{2}(V_P + \\sigma_e^2)\n$$\n因此，观测回归斜率 $b$ 是：\n$$\nb = \\frac{\\frac{1}{2}V_A}{\\frac{1}{2}(V_P + \\sigma_e^2)} = \\frac{V_A}{V_P + \\sigma_e^2}\n$$\n这可以改写为以 $h^2$ 表示的形式：\n$$\nb = \\frac{V_A/V_P}{(V_P + \\sigma_e^2)/V_P} = \\frac{h^2}{1 + \\sigma_e^2/V_P}\n$$\n这个表达式显示了真实斜率 $h^2$ 被一个与测量误差方差相关的因子所减弱。\n\n**3. 校正后遗传力的计算**\n\n为了求解 $h^2$，我们必须找到衰减因子的值。题目提供了每个亲本的重测信度 $r_p = 0.80$，定义为：\n$$\nr_p = \\frac{\\mathrm{Var}(Y^{\\mathrm{true}})}{\\mathrm{Var}(Y^{\\mathrm{obs}})}\n$$\n对于单个亲本，$\\mathrm{Var}(Y^{\\mathrm{true}}) = V_P$。观测方差为 $\\mathrm{Var}(Y^{\\mathrm{obs}}) = \\mathrm{Var}(Y^{\\mathrm{true}} + e) = \\mathrm{Var}(Y^{\\mathrm{true}}) + \\mathrm{Var}(e) = V_P + \\sigma_e^2$。因此，\n$$\nr_p = \\frac{V_P}{V_P + \\sigma_e^2}\n$$\n现在，让我们检查观测斜率 $b$ 表达式中的衰减因子：\n$$\nb = \\frac{V_A}{V_P + \\sigma_e^2} = \\left(\\frac{V_A}{V_P}\\right) \\left(\\frac{V_P}{V_P + \\sigma_e^2}\\right) = h^2 \\cdot r_p\n$$\n这个关系非常简单：观测斜率是狭义遗传力与单个亲本测量信度的乘积。这是因为计算亲代中值的过程将信号方差（$\\mathrm{Var}(M^{\\mathrm{true}}) = V_P/2$）和噪声方差（$\\mathrm{Var}(\\varepsilon_M) = \\sigma_e^2/2$）都按相同的因子 $1/2$ 进行了缩放，从而使它们的比率，即信度，保持不变。亲代中值预测变量的信度是 $r_M = \\frac{\\mathrm{Var}(M^{\\mathrm{true}})}{\\mathrm{Var}(M^{\\mathrm{obs}})} = \\frac{V_P/2}{(V_P + \\sigma_e^2)/2} = \\frac{V_P}{V_P + \\sigma_e^2} = r_p$。\n\n我们已知 $b = 0.45$ 和 $r_p = 0.80$。现在我们可以求解 $h^2$：\n$$\nh^2 = \\frac{b}{r_p} = \\frac{0.45}{0.80}\n$$\n$$\nh^2 = \\frac{45/100}{80/100} = \\frac{45}{80} = \\frac{9}{16}\n$$\n将此分数转换为小数即可得到最终的数值答案。\n$$\nh^2 = 0.5625\n$$",
            "answer": "$$\\boxed{0.5625}$$"
        },
        {
            "introduction": "虽然亲子回归为理解遗传力提供了理论基础，但现代基因组学使我们能够利用全基因组关联研究（GWAS）的汇总统计数据，在大型、无亲缘关系的群体中估计由常见单核苷酸多态性（SNP）解释的遗传力（$h^2_{\\text{SNP}}$）。连锁不平衡分数回归（LD Score regression）是一种核心技术，它巧妙地利用了连锁不平衡模式来区分真正的多基因信号和由群体分层等因素造成的混杂。这项实践将指导你推导LDSC的基本方程，并应用它从真实的GWAS汇总数据中计算$h^2_{\\text{SNP}}$。",
            "id": "4328524",
            "problem": "一个研究团队在加性多基因模型下，对一个单位方差的连续性状进行了一项大规模全基因组关联研究 (GWAS)。基因型被标准化，使得每个单核苷酸多态性 (SNP) 基因型的均值为零，方差为一；表型也被标准化，使其均值为零，方差为一。该团队计划使用连锁不平衡 (LD) 得分回归 (LDSC) 来估计单核苷酸多态性遗传力，记为 $h^{2}_{\\text{SNP}}$。其中，SNP $j$ 的连锁不平衡 (LD) 得分 $\\ell_{j}$ 定义为该SNP与所有其他已测序SNP之间相关系数的平方和。假设满足LD得分回归的标准条件：加性遗传效应、全基因组范围内SNP效应值小且近似独立、效应值与局部LD无关。此外，假设由群体分层等造成的混杂偏倚可以忽略不计，使得回归截距的期望值等于1。\n\n从加性模型和 $h^{2}_{\\text{SNP}}$（定义为所有已测序SNP解释的表型方差比例）的定义出发，推导一个表达式，将所有SNP的关联 $\\chi^{2}$ 统计量的期望均值与 $h^{2}_{\\text{SNP}}$、样本量 $N$、SNP数量 $M$ 以及平均LD得分 $\\bar{\\ell}$ 联系起来。然后，使用提供的GWAS荟萃分析的汇总统计数据——平均 $\\chi^{2}$ 统计量 $\\overline{\\chi^{2}} = 1.30$、样本量 $N = 200{,}000$、平均LD得分 $\\bar{\\ell} = 100$ 和SNP数量 $M = 1{,}000{,}000$——在所述假设下计算 $h^{2}_{\\text{SNP}}$。\n\n将你的最终答案表示为小数。除精确算术外，不需要进行四舍五入。",
            "solution": "任务有两部分：首先，推导平均卡方 ($\\chi^2$) 统计量、SNP遗传力 ($h^{2}_{\\text{SNP}}$)、样本量 ($N$)、SNP数量 ($M$) 和平均LD得分 ($\\bar{\\ell}$) 之间的理论关系；其次，利用所提供的数据计算 $h^{2}_{\\text{SNP}}$。\n\n**第一部分：LD得分回归方程的推导**\n\n我们从一个包含 $N$ 个个体的样本中表型 $y$ 的标准加性线性模型开始。个体 $i$ 的表型由下式给出：\n$$\ny_i = \\sum_{j=1}^{M} X_{ij} \\beta_j + \\epsilon_i\n$$\n其中 $M$ 是已测序SNP的数量，$X_{ij}$ 是个体 $i$ 在SNP $j$ 处的标准化基因型，$\\beta_j$ 是SNP $j$ 的真实加性遗传效应，$\\epsilon_i$ 是个体 $i$ 的非遗传成分（环境效应和噪声）。\n\n问题陈述指出表型和基因型都经过了标准化。这意味着：\n- 表型：$\\mathbb{E}[y_i] = 0$ 且 $\\text{Var}(y) = 1$。\n- 基因型：对于每个SNP $j$，在 $N$ 个个体中，$\\mathbb{E}[X_{ij}] = 0$ 且 $\\text{Var}(X_j) = 1$。\n\nSNP遗传力 $h^{2}_{\\text{SNP}}$ 定义为所有已测序SNP所解释的表型方差的比例。由于 $\\text{Var}(y)=1$，我们有：\n$$\nh^{2}_{\\text{SNP}} = \\text{Var}\\left(\\sum_{j=1}^{M} X_{ij} \\beta_j\\right)\n$$\nLDSC中使用的多基因模型的核心假设是，效应值 $\\beta_j$ 是从一个均值为 $0$、方差为 $\\mathbb{E}[\\beta_j^2] = \\frac{h^{2}_{\\text{SNP}}}{M}$ 的分布中独立抽取的随机变量。这确保了如果所有SNP都处于连锁平衡（不相关），总遗传方差将是 $\\sum_{j=1}^{M} \\text{Var}(\\beta_j) \\text{Var}(X_j) = M \\times \\frac{h^{2}_{\\text{SNP}}}{M} \\times 1 = h^{2}_{\\text{SNP}}$。\n\n在GWAS中，我们使用简单线性回归来估计每个SNP $j$ 的边际效应。对于标准化变量，估计的效应值 $\\hat{\\beta}_j$ 是基因型 $X_j$ 和表型 $y$ 之间的样本相关性：\n$$\n\\hat{\\beta}_j = \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} y_i\n$$\n代入 $y_i$ 的真实模型：\n$$\n\\hat{\\beta}_j = \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} \\left( \\sum_{k=1}^{M} X_{ik} \\beta_k + \\epsilon_i \\right) = \\sum_{k=1}^{M} \\left( \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} X_{ik} \\right) \\beta_k + \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} \\epsilon_i\n$$\n项 $\\frac{1}{N} \\sum_{i=1}^{N} X_{ij} X_{ik}$ 是SNP $j$ 和SNP $k$ 之间的样本相关性，记为 $r_{jk}$。第二项代表抽样噪声。因此，我们可以写成：\n$$\n\\hat{\\beta}_j = \\sum_{k=1}^{M} r_{jk} \\beta_k + e_j\n$$\n其中 $e_j = \\frac{1}{N} \\sum_{i=1}^{N} X_{ij} \\epsilon_i$。\n\nSNP $j$ 的关联检验统计量通常是一个z-得分，$Z_j = \\frac{\\hat{\\beta}_j}{\\text{SE}(\\hat{\\beta}_j)}$。对于大样本量 $N$ 和标准化变量，效应估计的标准误近似为 $\\text{SE}(\\hat{\\beta}_j) \\approx \\frac{1}{\\sqrt{N}}$。\n$\\chi^2$ 统计量是z-得分的平方：$\\chi^2_j = Z_j^2 \\approx N \\hat{\\beta}_j^2$。\n$$\n\\chi^2_j \\approx N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k + e_j \\right)^2 = N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)^2 + 2N e_j \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right) + N e_j^2\n$$\n我们关心的是该统计量的期望值 $\\mathbb{E}[\\chi^2_j]$，其中期望是针对真实效应 $\\beta_k$ 的分布和个体抽样（这决定了 $e_j$）来计算的。\n$$\n\\mathbb{E}[\\chi^2_j] = \\mathbb{E}\\left[N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)^2\\right] + 2N \\mathbb{E}\\left[e_j \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)\\right] + \\mathbb{E}[N e_j^2]\n$$\n假设遗传效应 $\\beta_k$ 与非遗传成分 $\\epsilon_i$ 无关，因此也与抽样噪声 $e_j$ 无关。所以，交叉项为零：$\\mathbb{E}[e_j (\\dots)] = \\mathbb{E}[e_j]\\mathbb{E}[(\\dots)] = 0$。\n\n我们来计算剩下的两项。\n第一项是来自遗传和LD的贡献：\n$$\n\\mathbb{E}\\left[N \\left( \\sum_{k=1}^{M} r_{jk} \\beta_k \\right)^2\\right] = N \\mathbb{E}\\left[ \\left(\\sum_k r_{jk} \\beta_k\\right) \\left(\\sum_m r_{jm} \\beta_m\\right) \\right] = N \\sum_{k,m} r_{jk} r_{jm} \\mathbb{E}[\\beta_k \\beta_m]\n$$\n由于不同SNP的效应值是独立的，当 $k \\neq m$ 时 $\\mathbb{E}[\\beta_k \\beta_m] = 0$。因此，我们只考虑 $k = m$ 的项。使用 $\\mathbb{E}[\\beta_k^2] = \\frac{h^{2}_{\\text{SNP}}}{M}$：\n$$\nN \\sum_{k=1}^{M} r_{jk}^2 \\mathbb{E}[\\beta_k^2] = N \\sum_{k=1}^{M} r_{jk}^2 \\left(\\frac{h^{2}_{\\text{SNP}}}{M}\\right) = N \\frac{h^{2}_{\\text{SNP}}}{M} \\sum_{k=1}^{M} r_{jk}^2\n$$\nSNP $j$ 的LD得分定义为 $\\ell_j = \\sum_{k=1}^{M} r_{jk}^2$。所以该项变为 $N \\frac{h^{2}_{\\text{SNP}}}{M} \\ell_j$。\n\n第二项是来自抽样方差的贡献，$\\mathbb{E}[N e_j^2]$。在无遗传效应的零假设下（即所有 $j$ 的 $\\beta_j = 0$），单个检验的 $\\chi^2$ 统计量服从自由度为1的 $\\chi^2$ 分布，其期望值为 $1$。因此，抽样噪声对期望 $\\chi^2$ 统计量的贡献是 $1$。\n\n结合这些项，单个SNP $j$ 的期望 $\\chi^2$ 统计量为：\n$$\n\\mathbb{E}[\\chi^2_j] = N \\frac{h^{2}_{\\text{SNP}}}{M} \\ell_j + 1\n$$\n这个方程构成了LD得分回归的基础，即我们将观察到的 $\\chi^2_j$ 统计量对它们预先计算的LD得分 $\\ell_j$ 进行回归。问题要求的是涉及*平均* $\\chi^2$ 统计量 $\\overline{\\chi^2}$ 的关系。我们通过对上述表达式在所有 $M$ 个SNP上取平均来找到这个关系：\n$$\n\\mathbb{E}[\\overline{\\chi^2}] = \\mathbb{E}\\left[\\frac{1}{M}\\sum_{j=1}^{M} \\chi^2_j\\right] = \\frac{1}{M}\\sum_{j=1}^{M} \\mathbb{E}[\\chi^2_j] = \\frac{1}{M}\\sum_{j=1}^{M} \\left(N \\frac{h^{2}_{\\text{SNP}}}{M} \\ell_j + 1\\right)\n$$\n$$\n\\mathbb{E}[\\overline{\\chi^2}] = \\frac{N h^{2}_{\\text{SNP}}}{M^2} \\sum_{j=1}^{M} \\ell_j + \\frac{1}{M}\\sum_{j=1}^{M} 1 = \\frac{N h^{2}_{\\text{SNP}}}{M} \\left(\\frac{1}{M}\\sum_{j=1}^{M} \\ell_j\\right) + 1\n$$\n认识到 $\\bar{\\ell} = \\frac{1}{M}\\sum_{j=1}^{M} \\ell_j$ 是平均LD得分，我们得到最终推导的表达式：\n$$\n\\mathbb{E}[\\overline{\\chi^2}] = \\frac{N h^{2}_{\\text{SNP}}}{M} \\bar{\\ell} + 1\n$$\n\n**第二部分：$h^{2}_{\\text{SNP}}$的计算**\n\n我们使用观察到的平均 $\\chi^2$ 统计量 $\\overline{\\chi^2} = 1.30$ 作为其期望 $\\mathbb{E}[\\overline{\\chi^2}]$ 的估计值。现在我们可以解出 $h^{2}_{\\text{SNP}}$：\n$$\n\\overline{\\chi^2} = \\frac{N \\bar{\\ell}}{M} h^{2}_{\\text{SNP}} + 1\n$$\n$$\n\\overline{\\chi^2} - 1 = \\frac{N \\bar{\\ell}}{M} h^{2}_{\\text{SNP}}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{M (\\overline{\\chi^2} - 1)}{N \\bar{\\ell}}\n$$\n提供的汇总统计数据是：\n- $\\overline{\\chi^2} = 1.30$\n- $N = 200{,}000 = 2 \\times 10^5$\n- $\\bar{\\ell} = 100 = 10^2$\n- $M = 1{,}000{,}000 = 10^6$\n\n将这些值代入 $h^{2}_{\\text{SNP}}$ 的表达式中：\n$$\nh^{2}_{\\text{SNP}} = \\frac{1{,}000{,}000 \\times (1.30 - 1)}{200{,}000 \\times 100}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{10^6 \\times 0.30}{(2 \\times 10^5) \\times 10^2}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{0.30 \\times 10^6}{2 \\times 10^7}\n$$\n$$\nh^{2}_{\\text{SNP}} = \\frac{0.30}{2 \\times 10^{7-6}} = \\frac{0.30}{2 \\times 10^1} = \\frac{0.30}{20}\n$$\n$$\nh^{2}_{\\text{SNP}} = 0.015\n$$\n估计的SNP遗传力为 $0.015$，即 $1.5\\%$。",
            "answer": "$$\n\\boxed{0.015}\n$$"
        },
        {
            "introduction": "许多复杂性状在表型上是相关的，一个关键问题是这种相关性在多大程度上源于共享的遗传因素。双变量连锁不平衡分数回归（Bivariate LD Score regression）将单变量LDSC的原理扩展到两个性状，使我们能够量化它们之间的遗传相关性（$\\rho_g$）。在本练习中，你将利用两个性状的GWAS汇总统计数据来估计遗传相关性，并深入探讨一个重要概念：为何遗传相关性与表型相关性可能不一致，甚至符号相反。",
            "id": "4328573",
            "problem": "一个生物样本库队列对两个标准化的复杂性状（分别记为性状$A$和性状$B$）进行了两次独立的全基因组关联研究（GWAS；Genome-Wide Association Study），研究对象为相同血统的无亲缘关系个体。对通过质量控制的$M$个常见单核苷酸多态性（SNP；Single Nucleotide Polymorphism）计算了汇总统计数据，并在一个匹配的连锁不平衡（LD；Linkage Disequilibrium）参考面板中估计了连锁不平衡（LD）分数$\\ell_j$。设$z_{1j}$和$z_{2j}$分别为SNP $j$在性状$A$和性状$B$中的边际$z$分数。定义跨性状矩$\\chi^{(12)}_j = z_{1j} z_{2j}$和单性状矩$\\chi^{(1)}_j = z_{1j}^2$以及$\\chi^{(2)}_j = z_{2j}^2$。假设为加性多基因结构、同方差SNP效应，并且混杂偏倚和样本重叠可以忽略不计。\n\n您已获得关于$M$个SNP的以下汇总量：\n- SNP数量：$M = 10^6$。\n- GWAS样本量：性状$A$为$N_1 = 3 \\times 10^5$，性状$B$为$N_2 = 2 \\times 10^5$。\n- LD分数总和：$S_{\\ell} = \\sum_{j=1}^{M} \\ell_j = 10^8$ 和 $S_{\\ell^2} = \\sum_{j=1}^{M} \\ell_j^2 = 1.5 \\times 10^{10}$。\n- 跨性状汇总矩：$S_{x} = \\sum_{j=1}^{M} \\chi^{(12)}_j = 1.0383 \\times 10^6$ 和 $S_{\\ell x} = \\sum_{j=1}^{M} \\ell_j \\chi^{(12)}_j = 1.55745 \\times 10^8$。\n- 性状$A$汇总矩：$S_{y1} = \\sum_{j=1}^{M} \\chi^{(1)}_j = 7 \\times 10^6$ 和 $S_{\\ell y1} = \\sum_{j=1}^{M} \\ell_j \\chi^{(1)}_j = 10^9$。\n- 性状$B$汇总矩：$S_{y2} = \\sum_{j=1}^{M} \\chi^{(2)}_j = 3 \\times 10^6$ 和 $S_{\\ell y2} = \\sum_{j=1}^{M} \\ell_j \\chi^{(2)}_j = 4 \\times 10^8$。\n\n从LD分数的基本定义和SNP效应的加性随机效应模型出发，使用双变量LD分数回归来：\n1. 根据这些汇总数据估计性状$A$和$B$之间的遗传相关性$\\rho_g$。您的计算过程应为：首先估计连接矩与LD分数的回归斜率，然后将这些斜率映射为性状$A$和$B$在观测尺度上的SNP遗传力，最后将跨性状斜率转换为遗传协方差，从而得到$\\rho_g$。\n2. 简要解释，在一个外部队列中测得$A$和$B$之间的表型相关性为负（$r_p = -0.12$）的情况下，为何仍可能出现正的$\\rho_g$。\n\n给出$\\rho_g$的最终数值，并将其四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "该问题要求使用来自全基因组关联研究（GWAS）的汇总统计数据，通过双变量LD分数（LDSC）回归，来估计两个性状A和B之间的遗传相关性$\\rho_g$。此外，问题还要求解释遗传相关性与表型相关性符号之间可能存在的差异。\n\n### 第一部分：遗传相关性（$\\rho_g$）的估计\n\n**理论框架**\n\nLDSC方法基于单个核苷酸多态性（SNP）的期望卡方统计量（记为$\\chi_j^2 = z_j^2$）与其LD分数（$\\ell_j$）之间的线性关系。LD分数$\\ell_j = \\sum_{k} r_{jk}^2$量化了SNP $j$与其他SNP处于连锁不平衡（LD）的程度。\n\n在加性多基因模型、同方差SNP效应、以及可忽略的混杂偏倚（例如，由群体分层引起的偏倚）和研究间无样本重叠的假设下，单性状和跨性状矩的期望值由以下公式给出：\n\n1.  对于性状A（用下标$1$表示）：\n    $$E[\\chi^{(1)}_j] = E[z_{1j}^2] = \\frac{N_1 h_1^2}{M} \\ell_j + 1$$\n2.  对于性状B（用下标$2$表示）：\n    $$E[\\chi^{(2)}_j] = E[z_{2j}^2] = \\frac{N_2 h_2^2}{M} \\ell_j + 1$$\n3.  对于跨性状乘积：\n    $$E[\\chi^{(12)}_j] = E[z_{1j} z_{2j}] = \\frac{\\sqrt{N_1 N_2} \\rho_{g12}}{M} \\ell_j$$\n\n在这些方程中：\n- $N_k$是性状$k$的样本量。\n- $M$是分析中使用的SNP数量。\n- $h_k^2$是性状$k$的SNP遗传力。\n- $\\rho_{g12}$是性状A和B之间的遗传协方差。\n- 单性状方程中为$1$的截距源于SNP效应量估计中的抽样噪声。\n- 跨性状方程的截距为$0$，因为研究是独立的（无样本重叠），所以$z_{1j}$和$z_{2j}$的估计误差不相关。\n\n这些方程代表了简单的线性模型。我们可以通过对所有$M$个SNP的矩（$\\chi_j$）关于LD分数（$\\ell_j$）进行普通最小二乘（OLS）回归来估计斜率。\n\n**回归斜率的估计**\n\n$y$对$x$的简单线性回归的斜率$b$由以下公式给出：\n$$b = \\frac{M \\sum_{j=1}^{M} x_j y_j - (\\sum_{j=1}^{M} x_j)(\\sum_{j=1}^{M} y_j)}{M \\sum_{j=1}^{M} x_j^2 - (\\sum_{j=1}^{M} x_j)^2}$$\n分母$D$对所有三个回归都是相同的。使用提供的汇总总和：\n$S_{\\ell} = \\sum_{j=1}^{M} \\ell_j = 10^8$\n$S_{\\ell^2} = \\sum_{j=1}^{M} \\ell_j^2 = 1.5 \\times 10^{10}$\n$M = 10^6$\n\n$$D = M S_{\\ell^2} - (S_{\\ell})^2 = (10^6)(1.5 \\times 10^{10}) - (10^8)^2 = 1.5 \\times 10^{16} - 1 \\times 10^{16} = 5 \\times 10^{15}$$\n\n现在，我们计算每种情况的斜率。\n\n1.  **性状A的斜率（$b_1$）**：$\\chi^{(1)}_j$对$\\ell_j$的回归。\n    分子是 $N_1^{num} = M S_{\\ell y1} - S_{\\ell} S_{y1}$。\n    使用 $S_{y1} = \\sum \\chi^{(1)}_j = 7 \\times 10^6$ 和 $S_{\\ell y1} = \\sum \\ell_j \\chi^{(1)}_j = 10^9$：\n    $$N_1^{num} = (10^6)(10^9) - (10^8)(7 \\times 10^6) = 10^{15} - 7 \\times 10^{14} = 3 \\times 10^{14}$$\n    $$b_1 = \\frac{N_1^{num}}{D} = \\frac{3 \\times 10^{14}}{5 \\times 10^{15}} = 0.06$$\n\n2.  **性状B的斜率（$b_2$）**：$\\chi^{(2)}_j$对$\\ell_j$的回归。\n    分子是 $N_2^{num} = M S_{\\ell y2} - S_{\\ell} S_{y2}$。\n    使用 $S_{y2} = \\sum \\chi^{(2)}_j = 3 \\times 10^6$ 和 $S_{\\ell y2} = \\sum \\ell_j \\chi^{(2)}_j = 4 \\times 10^8$：\n    $$N_2^{num} = (10^6)(4 \\times 10^8) - (10^8)(3 \\times 10^6) = 4 \\times 10^{14} - 3 \\times 10^{14} = 10^{14}$$\n    $$b_2 = \\frac{N_2^{num}}{D} = \\frac{10^{14}}{5 \\times 10^{15}} = 0.02$$\n\n3.  **跨性状斜率（$b_{12}$）**：$\\chi^{(12)}_j$对$\\ell_j$的回归。\n    分子是 $N_{12}^{num} = M S_{\\ell x} - S_{\\ell} S_{x}$。\n    使用 $S_{x} = \\sum \\chi^{(12)}_j = 1.0383 \\times 10^6$ 和 $S_{\\ell x} = \\sum \\ell_j \\chi^{(12)}_j = 1.55745 \\times 10^8$：\n    $$N_{12}^{num} = (10^6)(1.55745 \\times 10^8) - (10^8)(1.0383 \\times 10^6) = 1.55745 \\times 10^{14} - 1.0383 \\times 10^{14} = 5.1915 \\times 10^{13}$$\n    $$b_{12} = \\frac{N_{12}^{num}}{D} = \\frac{5.1915 \\times 10^{13}}{5 \\times 10^{15}} = 0.010383$$\n\n作为验证，这些回归的截距应分别为$1$、$1$和$0$，这与所提供的数据相符。\n\n**遗传参数的计算**\n\n从理论模型中，我们得到关于斜率的以下关系：\n$$b_1 = \\frac{N_1 h_1^2}{M} \\quad \\implies \\quad h_1^2 = \\frac{b_1 M}{N_1}$$\n$$b_2 = \\frac{N_2 h_2^2}{M} \\quad \\implies \\quad h_2^2 = \\frac{b_2 M}{N_2}$$\n$$b_{12} = \\frac{\\sqrt{N_1 N_2} \\rho_{g12}}{M} \\quad \\implies \\quad \\rho_{g12} = \\frac{b_{12} M}{\\sqrt{N_1 N_2}}$$\n\n遗传相关性$\\rho_g$定义为标准化的遗传协方差：\n$$\\rho_g = \\frac{\\rho_{g12}}{\\sqrt{h_1^2 h_2^2}}$$\n\n代入$h_1^2$、$h_2^2$和$\\rho_{g12}$的表达式：\n$$\\rho_g = \\frac{\\frac{b_{12} M}{\\sqrt{N_1 N_2}}}{\\sqrt{\\left(\\frac{b_1 M}{N_1}\\right) \\left(\\frac{b_2 M}{N_2}\\right)}} = \\frac{\\frac{b_{12} M}{\\sqrt{N_1 N_2}}}{\\frac{M}{\\sqrt{N_1 N_2}} \\sqrt{b_1 b_2}} = \\frac{b_{12}}{\\sqrt{b_1 b_2}}$$\n\n这表明遗传相关性可以直接从回归斜率计算得出，而无需样本量或SNP数量。\n\n代入估计的斜率值：\n$$b_1 = 0.06$$\n$$b_2 = 0.02$$\n$$b_{12} = 0.010383$$\n$$\\rho_g = \\frac{0.010383}{\\sqrt{0.06 \\times 0.02}} = \\frac{0.010383}{\\sqrt{0.0012}} \\approx \\frac{0.010383}{0.034641016} \\approx 0.299732$$\n四舍五入到四位有效数字，估计的遗传相关性为$\\rho_g = 0.2997$。\n\n### 第二部分：对$\\rho_g  0$而$r_p  0$的解释\n\n两个性状之间的表型相关性（$r_p$）是共享遗传影响（基因多效性）和共享环境影响的函数。这种关系可以用数量遗传模型表示：\n$$r_p = \\rho_g \\sqrt{h_1^2 h_2^2} + \\rho_e \\sqrt{e_1^2 e_2^2}$$\n其中$\\rho_e$是环境相关性，$e_k^2 = 1 - h_k^2$是由环境因素决定的方差比例（环境决定度）。\n\n给定$r_p = -0.12$，我们估计出$\\rho_g \\approx 0.2997$。正的遗传相关性表明，平均而言，增加性状A的遗传变异也倾向于增加性状B。\n\n要使观测到的表型相关性$r_p$在遗传相关性$\\rho_g$为正的情况下为负，环境相关性$\\rho_e$必须为负，并且其贡献的绝对值必须大于遗传贡献且符号相反。\n\n让我们计算遗传力：\n$h_1^2 = \\frac{b_1 M}{N_1} = \\frac{(0.06)(10^6)}{3 \\times 10^5} = 0.2$\n$h_2^2 = \\frac{b_2 M}{N_2} = \\frac{(0.02)(10^6)}{2 \\times 10^5} = 0.1$\n那么，$e_1^2 = 1 - 0.2 = 0.8$ 且 $e_2^2 = 1 - 0.1 = 0.9$。\n\n对表型相关性的遗传贡献是：\n$\\rho_g \\sqrt{h_1^2 h_2^2} \\approx 0.2997 \\sqrt{0.2 \\times 0.1} = 0.2997 \\sqrt{0.02} \\approx 0.0424$\n\n那么环境贡献必须是：\n$\\rho_e \\sqrt{e_1^2 e_2^2} = r_p - \\rho_g \\sqrt{h_1^2 h_2^2} \\approx -0.12 - 0.0424 = -0.1624$\n这意味着一个负的环境相关性：\n$\\rho_e = \\frac{-0.1624}{\\sqrt{0.8 \\times 0.9}} = \\frac{-0.1624}{\\sqrt{0.72}} \\approx -0.191$\n\n总之，如果存在一个足够强的、方向相反的负环境相关性，那么正的遗传相关性可以与负的表型相关性共存。这意味着，倾向于增加性状A的环境因素与倾向于减少性状B的环境因素相关联（反之亦然），并且这种对表型的拮抗性环境效应超过了共享遗传的协同效应。",
            "answer": "$$\\boxed{0.2997}$$"
        }
    ]
}