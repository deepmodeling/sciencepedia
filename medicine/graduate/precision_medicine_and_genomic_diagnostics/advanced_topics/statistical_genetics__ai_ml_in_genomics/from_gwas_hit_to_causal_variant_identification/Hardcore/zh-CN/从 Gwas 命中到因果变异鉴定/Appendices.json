{
    "hands_on_practices": [
        {
            "introduction": "在从全基因组关联研究（GWAS）的命中信号转向确定因果变异的过程中，第一步是理解并准备分析所需的基础数据。精细定位方法并非孤立地分析单个遗传变异，而是依赖于变异之间被称为连锁不平衡（Linkage Disequilibrium, LD）的相关性模式。因此，根据合适的参考人群样本准确估算LD矩阵（$R$矩阵）是一项至关重要的准备工作。本实践练习将指导您完成构建此矩阵的核心计算任务，并突出真实世界中的挑战，例如样本量有限导致的估计误差以及通过正则化方法进行数值优化的必要性。掌握这项技能是进行任何多变异遗传分析的基石。",
            "id": "4341798",
            "problem": "给定一组个体在参考面板中的基因型剂量矩阵，以及部分单核苷酸多态性 (SNPs) 相应的外部等位基因频率。您的任务是实现一个程序，为每个测试用例计算成对的连锁不平衡 (LD) 相关矩阵 $R$，评估使用外部等位基因频率与样本等位基因频率对 $R$ 的影响，并对 $R$ 应用基于收缩的正则化以减轻抽样方差。您的程序必须按如下规定输出每个测试用例的摘要指标。\n\n基本原理和定义：\n- 单核苷酸多态性 (SNP) 在一个基因型矩阵 $G \\in \\mathbb{R}^{n \\times m}$ 中编码，其条目在 $\\{0,1,2\\}$ 中，表示 $n$ 个个体和 $m$ 个 SNPs 的备择等位基因剂量。\n- 在哈迪-温伯格平衡 (HWE) 条件下，对于一个备择等位基因频率为 $p \\in (0,1)$ 的 SNP，其基因型剂量的期望均值为 $2p$，方差为 $2p(1-p)$。\n- 令 $p_j$ 表示 SNP $j$ 的等位基因频率，可以由外部提供，也可以从样本中估计为 $\\hat{p}_j = \\frac{1}{2n}\\sum_{i=1}^{n} G_{ij}$。定义标准化基因型矩阵 $X \\in \\mathbb{R}^{n \\times m}$ 为\n$$\nX_{ij} \\;=\\; \\frac{G_{ij} - 2p_j}{\\sqrt{2p_j(1-p_j)}} \\, ,\n$$\n其中分母通过在平方根内加上一个小的正常数 $\\varepsilon$ 来稳定，以避免除以零。\n- 样本 LD 相关矩阵估计为\n$$\nR \\;=\\; \\frac{1}{n-1} X^\\top X \\, ,\n$$\n当标准化精确时，这等于样本相关性。\n- 有限样本估计误差会在 $R$ 中引入抽样方差。一种常用的正则化方法是向单位矩阵收缩：\n$$\nR_{\\lambda} \\;=\\; (1-\\lambda) R \\;+\\; \\lambda I_m \\, ,\n$$\n其中 $I_m$ 是 $m \\times m$ 的单位矩阵，$\\lambda \\in [0,1]$ 是收缩强度。\n- 假设标准化数据服从高斯-威沙特模型。最小化期望弗罗贝尼乌斯平方误差的最优收缩强度的一个近似插入式估计量可以实现为\n$$\n\\lambda^\\star \\;=\\; \\min\\!\\Bigg( 1, \\; \\max\\!\\Big( 0, \\; \\frac{\\phi}{\\delta + \\eta} \\Big) \\Bigg) \\, ,\n$$\n其中 $\\eta  0$ 是一个用于数值稳定性的小数，并且\n$$\n\\phi \\;=\\; \\frac{1}{n-1} \\sum_{i \\neq j} \\big( R_{ij}^2 + 1 \\big) \\, , \\qquad\n\\delta \\;=\\; \\sum_{i \\neq j} R_{ij}^2 \\, .\n$$\n\n每个测试用例所需的计算：\n1. 给定 $G$ 和外部等位基因频率 $\\{p_j\\}_{j=1}^{m}$，在标准化过程中使用外部频率计算 $R_{\\text{ext}}$。\n2. 使用样本等位基因频率 $\\{\\hat{p}_j\\}_{j=1}^{m}$ 进行标准化，计算 $R_{\\text{samp}}$。\n3. 使用 $R_{\\text{ext}}$，计算收缩强度 $\\lambda^\\star$ 和正则化矩阵\n$$\nR_{\\text{reg}} \\;=\\; (1-\\lambda^\\star) R_{\\text{ext}} \\;+\\; \\lambda^\\star I_m \\, .\n$$\n\n您的程序必须为每个测试用例输出以下三个量：\n- $R_{\\text{ext}}$ 和 $R_{\\text{samp}}$ 之间的最大逐项绝对偏差：\n$$\nd \\;=\\; \\max_{i,j} \\big| \\big(R_{\\text{ext}}\\big)_{ij} - \\big(R_{\\text{samp}}\\big)_{ij} \\big| \\, .\n$$\n- $R_{\\text{ext}}$ 和 $R_{\\text{reg}}$ 之差的弗罗贝尼乌斯范数：\n$$\nf \\;=\\; \\big\\| R_{\\text{ext}} - R_{\\text{reg}} \\big\\|_{\\mathrm{F}} \\, .\n$$\n- 一个布尔值，指示 $R_{\\text{reg}}$ 是否为严格正定。严格正定定义为所有特征值严格大于一个阈值 $\\tau$，其中 $\\tau = 10^{-8}$：\n$$\n\\text{is\\_spd} \\;=\\; \\big( \\lambda_{\\min}(R_{\\text{reg}})  \\tau \\big) \\, .\n$$\n\n数值约定：\n- 如果需要，在 $X_{ij}$ 的方差分母稳定化中使用 $\\varepsilon = 10^{-8}$。\n- 在 $\\lambda^\\star$ 的分母中使用 $\\eta = 10^{-12}$ 以避免除以零。\n- 使用 $\\tau = 10^{-8}$ 来检验严格正定性。\n\n测试套件：\n提供以下四个测试用例。每个用例包含 $n$、$m$、基因型矩阵 $G$（行主序：$n$ 行 $m$ 列），以及外部等位基因频率向量 $(p_1,\\ldots,p_m)$。\n\n- 测试用例A（一般情况；中等相关性）：$n=8$, $m=4$,\n  $$\n  G \\;=\\; \\begin{bmatrix}\n  0  0  2  1 \\\\\n  1  1  1  1 \\\\\n  2  2  0  2 \\\\\n  0  1  1  0 \\\\\n  1  1  2  2 \\\\\n  2  2  1  2 \\\\\n  0  0  0  0 \\\\\n  1  1  1  1\n  \\end{bmatrix} \\, , \\quad\n  (p_1,p_2,p_3,p_4) \\;=\\; (0.4,\\, 0.45,\\, 0.52,\\, 0.55) \\, .\n  $$\n- 测试用例B（存在稀有等位基因）：$n=10$, $m=3$,\n  $$\n  G \\;=\\; \\begin{bmatrix}\n  0  0  2 \\\\\n  0  1  1 \\\\\n  0  1  1 \\\\\n  0  0  2 \\\\\n  0  1  0 \\\\\n  0  0  1 \\\\\n  0  1  2 \\\\\n  0  0  0 \\\\\n  1  0  1 \\\\\n  0  1  2\n  \\end{bmatrix} \\, , \\quad\n  (p_1,p_2,p_3) \\;=\\; (0.04,\\, 0.3,\\, 0.55) \\, .\n  $$\n- 测试用例C（$m  n$ 导致 $R$ 秩亏）：$n=5$, $m=6$,\n  $$\n  G \\;=\\; \\begin{bmatrix}\n  0  1  2  0  1  2 \\\\\n  1  2  1  1  2  1 \\\\\n  2  1  0  2  1  0 \\\\\n  0  0  1  0  0  1 \\\\\n  1  1  2  1  1  2\n  \\end{bmatrix} \\, , \\quad\n  (p_1,\\ldots,p_6) \\;=\\; (0.2,\\, 0.5,\\, 0.6,\\, 0.3,\\, 0.5,\\, 0.6) \\, .\n  $$\n- 测试用例D（两个SNP之间完全相关）：$n=6$, $m=3$,\n  $$\n  G \\;=\\; \\begin{bmatrix}\n  0  0  0 \\\\\n  0  0  1 \\\\\n  1  1  0 \\\\\n  1  1  1 \\\\\n  2  2  0 \\\\\n  2  2  1\n  \\end{bmatrix} \\, , \\quad\n  (p_1,p_2,p_3) \\;=\\; (0.5,\\, 0.5,\\, 0.5) \\, .\n  $$\n\n最终输出格式：\n- 对于每个测试用例，计算上文定义的 $(d, f, \\text{is\\_spd})$。您的程序必须生成一行输出，包含一个由四个列表组成的列表，每个对应一个测试用例，顺序为 A、B、C、D。每个内部列表必须是 $[d,f,\\text{is\\_spd}]$ 的形式，其中 $d$ 和 $f$ 四舍五入到恰好 $6$ 位小数，而 $\\text{is\\_spd}$ 是一个布尔值。例如：\n$$\n\\big[ [d_A,f_A,\\text{is\\_spd}_A],\\; [d_B,f_B,\\text{is\\_spd}_B],\\; [d_C,f_C,\\text{is\\_spd}_C],\\; [d_D,f_D,\\text{is\\_spd}_D] \\big] \\, .\n$$\n\n科学真实性要求：\n- 您的实现应遵守上述定义，并且在给定常数 $\\varepsilon$、$\\eta$ 和 $\\tau$ 的情况下必须是数值稳定的。不得使用任何随机组件。",
            "solution": "该问题被认为是有效的，因为它在统计遗传学方面有科学依据，定义明确且提供了所有必要信息，并且其表述是客观的。它提出了一个清晰、算法上明确定义的任务，没有内部矛盾或不可行的要求。我们将继续提供一个完整的解决方案。\n\n任务是分析几个测试用例的基因型数据，通过计算和比较连锁不平衡 (LD) 相关矩阵 $R$ 的不同估计值。该过程涉及标准化基因型数据、计算相关矩阵以及应用收缩正则化技术。对于每个案例，我们必须报告三个摘要指标：两种 LD 估计之间的最大偏差 ($d$)、正则化调整的幅度 ($f$)，以及对正则化矩阵的严格正定性检验 (`is_spd`)。\n\n让我们将步骤形式化。\n\n一个给定的测试用例提供了一个基因型矩阵 $G \\in \\mathbb{R}^{n \\times m}$（$n$ 个个体，$m$ 个 SNP），以及一个外部等位基因频率向量 $p_{\\text{ext}} = (p_1, \\ldots, p_m)$。为数值稳定性和测试指定了常数 $\\varepsilon = 10^{-8}$、$\\eta = 10^{-12}$ 和 $\\tau = 10^{-8}$。\n\n**步骤 1：基因型矩阵的标准化**\n\n第一步是标准化基因型矩阵 $G$。标准化公式如下：\n$$\nX_{ij} = \\frac{G_{ij} - 2p_j}{\\sqrt{2p_j(1-p_j)}}\n$$\n其中 $p_j$ 是 SNP $j$ 的备择等位基因频率。分母，代表在哈迪-温伯格平衡 (HWE) 下的标准差，被稳定化以防止除以零或非常小的数。我们通过将分母计算为 $\\sqrt{2p_j(1-p_j) + \\varepsilon}$ 来实现这一点。\n\n对于每个测试用例，必须执行两次此标准化：\n1.  使用提供的外部等位基因频率 $\\{p_j\\}_{j=1}^{m}$ 生成一个矩阵 $X_{\\text{ext}}$。\n2.  使用样本估计的等位基因频率 $\\{\\hat{p}_j\\}_{j=1}^{m}$ 生成一个矩阵 $X_{\\text{samp}}$。SNP $j$ 的样本等位基因频率从数据中估计如下：\n    $$\n    \\hat{p}_j = \\frac{1}{2n} \\sum_{i=1}^{n} G_{ij}\n    $$\n\n**步骤 2：LD 相关矩阵的计算**\n\n有了标准化矩阵，我们使用标准化数据的样本协方差公式来计算两个 LD 相关矩阵 $R_{\\text{ext}}$ 和 $R_{\\text{samp}}$：\n$$\nR = \\frac{1}{n-1} X^\\top X\n$$\n这得到：\n$$\nR_{\\text{ext}} = \\frac{1}{n-1} X_{\\text{ext}}^\\top X_{\\text{ext}}\n$$\n$$\nR_{\\text{samp}} = \\frac{1}{n-1} X_{\\text{samp}}^\\top X_{\\text{samp}}\n$$\n$R_{\\text{ext}}$ 和 $R_{\\text{samp}}$ 都是 $m \\times m$ 的对称矩阵。\n\n**步骤 3：偏差指标 $d$ 的计算**\n\n第一个所需的输出指标 $d$ 量化了源自外部频率与样本频率的 LD 矩阵之间的差异。它是最大的逐项绝对差：\n$$\nd = \\max_{i,j} \\left| \\left(R_{\\text{ext}}\\right)_{ij} - \\left(R_{\\text{samp}}\\right)_{ij} \\right|\n$$\n\n**步骤 4：收缩正则化**\n\n对矩阵 $R_{\\text{ext}}$ 进行正则化，以减少因有限样本量 ($n$) 导致的估计误差。正则化通过向单位矩阵 $I_m$ 收缩来执行：\n$$\nR_{\\text{reg}} = (1-\\lambda^\\star) R_{\\text{ext}} + \\lambda^\\star I_m\n$$\n最优收缩强度 $\\lambda^\\star$ 使用提供的插入式公式进行估计。首先，我们基于 $R_{\\text{ext}}$ 计算中间量 $\\phi$ 和 $\\delta$：\n$$\n\\delta = \\sum_{i \\neq j} \\left(R_{\\text{ext}}\\right)_{ij}^2\n$$\n$$\n\\phi = \\frac{1}{n-1} \\sum_{i \\neq j} \\left( \\left(R_{\\text{ext}}\\right)_{ij}^2 + 1 \\right)\n$$\n术语 $\\sum_{i \\neq j} (\\cdot)$ 表示对矩阵所有非对角元素的求和。这可以通过对所有元素求和然后减去对角线元素的和来计算。令 $S = \\sum_{i,j} \\left(R_{\\text{ext}}\\right)_{ij}^2$，$S_{\\text{diag}} = \\sum_{i} \\left(R_{\\text{ext}}\\right)_{ii}^2$。则 $\\delta = S - S_{\\text{diag}}$。求和 $\\sum_{i \\neq j} 1$ 是非对角元素的数量，即 $m(m-1)$。因此，$\\phi$可以计算为：\n$$\n\\phi = \\frac{1}{n-1} \\left( \\delta + m(m-1) \\right)\n$$\n然后计算收缩强度 $\\lambda^\\star$，并裁剪到区间 $[0,1]$ 内，并使用 $\\eta$ 进行数值稳定：\n$$\n\\lambda^\\star = \\min\\left( 1, \\max\\left( 0, \\frac{\\phi}{\\delta + \\eta} \\right) \\right)\n$$\n有了 $\\lambda^\\star$，我们现在可以计算正则化矩阵 $R_{\\text{reg}}$。\n\n**步骤 5：正则化效果指标 $f$ 的计算**\n\n第二个输出指标 $f$ 衡量正则化所应用的变化幅度。它是原始矩阵和正则化矩阵之差的弗罗贝尼乌斯范数：\n$$\nf = \\left\\| R_{\\text{ext}} - R_{\\text{reg}} \\right\\|_{\\mathrm{F}}\n$$\n代入 $R_{\\text{reg}}$ 的定义，我们可以看到 $R_{\\text{ext}} - R_{\\text{reg}} = \\lambda^\\star (R_{\\text{ext}} - I_m)$。因此：\n$$\nf = \\lambda^\\star \\left\\| R_{\\text{ext}} - I_m \\right\\|_{\\mathrm{F}}\n$$\n其中范数计算为 $\\|A\\|_{\\mathrm{F}} = \\sqrt{\\sum_{i,j} A_{ij}^2}$。\n\n**步骤 6：严格正定性 (SPD) 测试**\n\n最后的指标 `is_spd` 是一个布尔值，指示 $R_{\\text{reg}}$ 是否为严格正定。如果一个矩阵的所有特征值都严格为正，则该矩阵是严格正定的。我们用一个小的正阈值 $\\tau = 10^{-8}$ 来检验这个条件：\n$$\n\\text{is\\_spd} = \\left( \\lambda_{\\min}(R_{\\text{reg}})  \\tau \\right)\n$$\n其中 $\\lambda_{\\min}(R_{\\text{reg}})$ 是 $R_{\\text{reg}}$ 的最小特征值。由于 $R_{\\text{reg}}$ 是通过构造对称的，它的特征值是实数，可以使用高效的数值算法来找到它们。\n\n我们将把这一整套计算应用于所提供的四个测试用例中的每一个，并按规定格式化结果 ($d$, $f$, `is_spd`)。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the final output.\n    \"\"\"\n    \n    # Numerical conventions\n    epsilon = 1e-8\n    eta = 1e-12\n    tau = 1e-8\n\n    # Test suite definition\n    test_cases = [\n        (8, 4, np.array([\n            [0, 0, 2, 1], [1, 1, 1, 1], [2, 2, 0, 2], [0, 1, 1, 0],\n            [1, 1, 2, 2], [2, 2, 1, 2], [0, 0, 0, 0], [1, 1, 1, 1]\n        ]), np.array([0.4, 0.45, 0.52, 0.55])),\n        (10, 3, np.array([\n            [0, 0, 2], [0, 1, 1], [0, 1, 1], [0, 0, 2], [0, 1, 0],\n            [0, 0, 1], [0, 1, 2], [0, 0, 0], [1, 0, 1], [0, 1, 2]\n        ]), np.array([0.04, 0.3, 0.55])),\n        (5, 6, np.array([\n            [0, 1, 2, 0, 1, 2], [1, 2, 1, 1, 2, 1], [2, 1, 0, 2, 1, 0],\n            [0, 0, 1, 0, 0, 1], [1, 1, 2, 1, 1, 2]\n        ]), np.array([0.2, 0.5, 0.6, 0.3, 0.5, 0.6])),\n        (6, 3, np.array([\n            [0, 0, 0], [0, 0, 1], [1, 1, 0], [1, 1, 1],\n            [2, 2, 0], [2, 2, 1]\n        ]), np.array([0.5, 0.5, 0.5]))\n    ]\n    \n    all_results = []\n\n    for n, m, G, p_ext in test_cases:\n        G_float = G.astype(np.float64)\n\n        # Helper function for standardization\n        def standardize(genotypes, freqs):\n            mean = 2 * freqs\n            # Stabilized variance term: add epsilon inside square root\n            variance = 2 * freqs * (1 - freqs)\n            std_dev = np.sqrt(variance + epsilon)\n            return (genotypes - mean) / std_dev\n        \n        # Helper function for LD matrix calculation\n        def calculate_R(X_mat, n_samples):\n            return (1 / (n_samples - 1)) * (X_mat.T @ X_mat)\n\n        # 1. Compute R_ext\n        X_ext = standardize(G_float, p_ext)\n        R_ext = calculate_R(X_ext, n)\n\n        # 2. Compute R_samp\n        p_samp = np.sum(G_float, axis=0) / (2 * n)\n        X_samp = standardize(G_float, p_samp)\n        R_samp = calculate_R(X_samp, n)\n        \n        # 3. Compute metric d\n        d = np.max(np.abs(R_ext - R_samp))\n\n        # 4. Compute shrinkage intensity lambda_star using R_ext\n        # Sum of squared off-diagonal elements\n        off_diag_sq_sum = np.sum(R_ext**2) - np.sum(np.diag(R_ext)**2)\n        \n        delta = off_diag_sq_sum\n        phi = (1 / (n - 1)) * (delta + m * (m - 1))\n        \n        lambda_val = phi / (delta + eta)\n        lambda_star = np.clip(lambda_val, 0, 1)\n        \n        # 5. Compute R_reg\n        I_m = np.identity(m)\n        R_reg = (1 - lambda_star) * R_ext + lambda_star * I_m\n\n        # 6. Compute metric f\n        f = np.linalg.norm(R_ext - R_reg, 'fro')\n\n        # 7. Compute metric is_spd\n        # Use eigvalsh for symmetric matrices; it's faster and returns sorted eigenvalues\n        eigenvalues = np.linalg.eigvalsh(R_reg)\n        is_spd = eigenvalues[0] > tau\n        \n        all_results.append([d, f, is_spd])\n\n    # Format the final output string as a list of lists representation\n    output_parts = [\n        f\"[{d:.6f},{f:.6f},{s}]\" for d, f, s in all_results\n    ]\n    final_output_str = f\"[{','.join(output_parts)}]\"\n    \n    # Re-insert spaces to match the visual Python list representation\n    # This is a bit of a hack but ensures the string format is precise\n    # str list representation has `True`, not `true`. Python's f-string does this correctly.\n    # It adds a space after commas.\n    final_output_str = final_output_str.replace(\",\", \", \")\n    final_output_str = final_output_str.replace(\"[,\", \"[\")\n\n    final_output_str = final_output_str.replace(\"[ \", \"[\")\n    for i in range(len(all_results)-1):\n        # target_str = f\"{all_results[i][2]}],[{all_results[i+1][0]:.6f}\"\n        # replace_str = f\"{all_results[i][2]}], [{all_results[i+1][0]:.6f}\"\n        # final_output_str = final_output_str.replace(target_str, replace_str)\n        pass # The default string representation seems to be the target.\n    \n    # A more robust way to get the desired string representation is to build it manually\n    list_of_lists_str = []\n    for d, f, s in all_results:\n        list_of_lists_str.append(f\"[{d:.6f}, {f:.6f}, {s}]\")\n    \n    final_str = f\"[{', '.join(list_of_lists_str)}]\"\n    \n    # The template `print(f\"[{','.join(map(str, results))}]\")` with formatted\n    # floats and bools is simpler and gives a compact, valid JSON-like format.\n    # We will favor that for robustness. The example format might be illustrative.\n    \n    formatted_results = []\n    for d_val, f_val, s_val in all_results:\n        # Create a list with formatted numbers to be converted to a string\n        formatted_sublist = [f\"{d_val:.6f}\", f\"{f_val:.6f}\", str(s_val)]\n        # Create the string for the sublist\n        formatted_results.append(f\"[{','.join(formatted_sublist)}]\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当GWAS在一个基因组区域中识别出多个关联的单核苷酸多态性（SNPs）时，下一个关键问题是：这些信号是源于单个因果变异，还是代表了多个独立的遗传效应？本练习深入探讨了回答这一问题的核心统计技术：条件分析。通过亲手计算一个条件化$z$-分数，您将学习如何从统计上“校正”一个主导SNP的效应，从而检验该位点是否存在次级的、独立的关联信号。这项实践揭示了诸如GCTA-COJO等工具背后的数学原理，对于正确解读复杂的关联信号图谱至关重要。",
            "id": "4341984",
            "problem": "在精准医疗和基因组诊断的一次精细定位分析中，您获得了一个包含四个单核苷酸多态性（SNPs；Single-Nucleotide Polymorphisms）位点的全基因组关联研究（GWAS；Genome-Wide Association Study）的边际关联统计量。假设基因型已经标准化，并且根据线性关联检验的大样本理论，各个SNP的边际$z$分数向量近似服从多元正态分布，其相关性等于连锁不平衡（LD；Linkage Disequilibrium）矩阵。\n\n边际$z$分数为\n$$\n\\boldsymbol{z} = \\begin{pmatrix} 6.10 \\\\ 4.30 \\\\ 2.10 \\\\ -1.20 \\end{pmatrix},\n$$\n且LD相关矩阵为\n$$\nR = \\begin{pmatrix}\n1  0.20  0.05  -0.02 \\\\\n0.20  1  0.10  -0.01 \\\\\n0.05  0.10  1  0 \\\\\n-0.02  -0.01  0  1\n\\end{pmatrix}.\n$$\n\n请将具有最大绝对边际$z$分数的SNP确定为领头SNP，并考虑将SNP $2$作为候选次级信号。仅使用多元正态分布条件化的基本原理，并假设$\\boldsymbol{z}$的协方差等于$R$，推导在以领头SNP为条件后，SNP $2$的相应条件检验统计量。然后，在$M = 20$次检验中，判断该候选次级信号在双边Bonferroni校正的族系错误率$\\alpha = 0.05$下是否仍然显著。\n\n最终答案只报告SNP $2$的条件$z$分数。将您的最终答案四舍五入至四位有效数字。无需单位。",
            "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够信息以获得唯一解。其基础模型将GWAS的$z$分数视为从一个协方差结构等于连锁不平衡（LD）矩阵的多元正态分布中抽取的样本，这是统计遗传学中用于精细定位和条件分析的标准且被广泛接受的框架。所提供的数据是一致且符合实际的。因此，该问题是有效的，我将进行完整解答。\n\n目标是计算在考虑了领头SNP的影响后，SNP $2$的条件检验统计量。这个过程被称为条件分析，它有助于区分是单个关联信号通过LD影响多个相关的SNP，还是一个位点上存在多个不同的关联信号。\n\n首先，我们确定领头SNP，它被定义为具有最大绝对边际$z$分数的SNP。给定的$z$分数向量为：\n$$\n\\boldsymbol{z} = \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\\\ z_4 \\end{pmatrix} = \\begin{pmatrix} 6.10 \\\\ 4.30 \\\\ 2.10 \\\\ -1.20 \\end{pmatrix}\n$$\n绝对值为$|z_1| = 6.10$、$|z_2| = 4.30$、$|z_3| = 2.10$和$|z_4| = |-1.20| = 1.20$。这些值中的最大值为$6.10$，对应于SNP $1$。因此，SNP $1$是领头SNP。\n\n接下来，我们根据领头SNP（即SNP $1$）的观测统计量，推导候选次级信号（即SNP $2$）的条件检验统计量。设SNP $1$和SNP $2$的$z$分数对应的随机变量分别为$Z_1$和$Z_2$。根据问题陈述，它们的联合分布是二元正态分布，其均值向量反映了它们真实的遗传效应，协方差矩阵则从给定的LD矩阵$R$中提取：\n$$\n\\begin{pmatrix} Z_1 \\\\ Z_2 \\end{pmatrix} \\sim \\mathcal{N} \\left( \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\end{pmatrix}, \\begin{pmatrix} R_{11}  R_{12} \\\\ R_{21}  R_{22} \\end{pmatrix} \\right)\n$$\n其中$\\lambda_1$和$\\lambda_2$是表示真实效应的非中心化参数，协方差子矩阵为：\n$$\n\\begin{pmatrix} R_{11}  R_{12} \\\\ R_{21}  R_{22} \\end{pmatrix} = \\begin{pmatrix} 1  0.20 \\\\ 0.20  1 \\end{pmatrix}\n$$\nSNP $2$的条件检验统计量，我们记为$z_{2|1}$，是SNP $2$处关联性的一个标准化度量，该关联性不能被其与SNP $1$的LD所解释。这是根据条件正态分布的性质推导出来的。条件统计量是$Z_2$的观测值减去其在给定$Z_1$下的期望值，再除以条件标准差。\n在给定$Z_1 = z_1$的情况下，$Z_2$的期望值为$E[Z_2 | Z_1=z_1] = \\lambda_2 + R_{21} R_{11}^{-1} (z_1 - \\lambda_1)$。条件方差为$\\text{Var}(Z_2 | Z_1=z_1) = R_{22} - R_{21} R_{11}^{-1} R_{12}$。\n\n为了构建一个检验SNP $2$没有独立效应（即原假设$H_0: \\lambda_2 = 0$）的检验统计量，我们用领头SNP的观测统计量$z_1$来近似其未知的真实效应$\\lambda_1$。这在诸如GCTA-COJO等方法中是一种标准近似。在此近似下，由于与SNP $1$的LD，$Z_2$的期望值为$R_{21}R_{11}^{-1}z_1$。条件统计量是通过将观测到的$z_2$与该期望值之差进行标准化来构建的：\n$$\nz_{2|1} = \\frac{z_2 - E[Z_2 | Z_1=z_1, \\lambda_1=z_1, \\lambda_2=0]}{\\sqrt{\\text{Var}(Z_2 | Z_1=z_1)}} = \\frac{z_2 - R_{21} R_{11}^{-1} z_1}{\\sqrt{R_{22} - R_{21} R_{11}^{-1} R_{12}}}\n$$\n由于$R$是一个相关矩阵，对角线元素$R_{11}$和$R_{22}$等于$1$。代入这些值可以简化公式：\n$$\nz_{2|1} = \\frac{z_2 - R_{21} z_1}{\\sqrt{1 - R_{21}^2}}\n$$\n这个公式有效地计算了$z_2$对$z_1$回归的标准化残差，该残差代表了$z_2$信号中统计上独立于$z_1$信号的部分。\n\n现在我们代入给定的数值：$z_1 = 6.10$，$z_2 = 4.30$，以及$R_{21} = 0.20$。\n$$\nz_{2|1} = \\frac{4.30 - (0.20)(6.10)}{\\sqrt{1 - (0.20)^2}}\n$$\n首先，计算分子：\n$$\n4.30 - (0.20)(6.10) = 4.30 - 1.22 = 3.08\n$$\n接下来，计算分母：\n$$\n\\sqrt{1 - (0.20)^2} = \\sqrt{1 - 0.04} = \\sqrt{0.96}\n$$\n因此，条件$z$分数为：\n$$\nz_{2|1} = \\frac{3.08}{\\sqrt{0.96}} \\approx \\frac{3.08}{0.9797959} \\approx 3.14351\n$$\n四舍五入到四位有效数字，我们得到$z_{2|1} = 3.144$。\n\n最后，问题要求确定这个次级信号在Bonferroni校正的阈值下是否显著。对于$M = 20$次检验，族系错误率为$\\alpha = 0.05$。单次检验的$p$值的校正显著性水平是$p_{\\text{thresh}} = \\frac{\\alpha}{M} = \\frac{0.05}{20} = 0.0025$。\n我们的条件统计量$z_{2|1} \\approx 3.144$的双边$p$值为$p = 2 \\times P(Z  |3.144|)$，其中$Z \\sim \\mathcal{N}(0,1)$。这个$p$值约等于$0.00167$。由于$0.00167  0.0025$，在考虑了领头SNP $1$并进行多重检验校正后，SNP $2$的条件信号确实是统计显著的。最终要求的答案是条件$z$分数的值本身。",
            "answer": "$$\n\\boxed{3.144}\n$$"
        },
        {
            "introduction": "确定因果变异很少能仅通过统计学方法完成，它要求研究者整合来自多种不同数据类型的证据。这个压轴实践模拟了一个真实的科研场景，挑战您扮演一个精细定位项目的首席研究员。通过整合跨族裔的GWAS数据与丰富的基因功能组学信息（如eQTL、染色质可及性、报告基因实验等），您将学习如何构建一个从变异到基因再到功能的连贯机制假说，并设计严谨的实验验证计划。这项综合性练习汇集了整个课程的核心概念，推动您从统计推断迈向提出可检验的生物学机制，这是精准医学研究的核心能力。",
            "id": "4341927",
            "problem": "给定一个基因组位点，其中包含四个双等位基因变异，分别表示为 $v_1$、$v_2$、$v_3$ 和 $v_4$。在两个人群中拥有全基因组关联研究 (GWAS) 的摘要统计数据：欧洲祖源 (EUR) 和非洲祖源 (AFR)。对于每个祖源，您拥有与某个复杂性状关联的 $z$-score、祖源特异性的连锁不平衡 (LD) 矩阵、来自疾病相关细胞类型的功能注释、相关组织中最近的表达基因 $G$ 的表达数量性状位点 (eQTL) 摘要统计数据、基因 $G$ 蛋白质产物的蛋白质数量性状位点 (pQTL) 摘要统计数据，以及每个变异的等位基因特异性调控活性的大规模并行报告基因检测 (MPRA) 测量值。\n\n使用的定义和基本原理：\n- 贝叶斯定理：后验优势比与先验优势比乘以似然比成正比。\n- 在单因果变异精细定位 (fine-mapping) 中，变异 $i$ 的后验纳入概率 (PIP) 可以从各变异的相对后验优势比中推导得出，其中似然值可以在跨祖源共享因果模型下，根据关联统计数据和祖源特异性 LD 进行近似计算。\n- 一个 $95\\%$ 可信集是指其累积 PIP 至少为 $0.95$ 的最小变异集合。\n- 共定位评估两个性状（例如 GWAS 和 eQTL）是否共享一个因果变异；当单个变异能同时解释两种信号且 LD 标签模式在不同祖源间保持一致时，证据强度增加。\n- 跨祖源精细定位利用 LD 差异来提高因果解析度。\n- 功能先验必须通过全基因组富集进行校准，而不能用作确定性过滤器。\n\n该位点的数据：\n- EUR GWAS $z$-score：$z^{\\mathrm{EUR}}_{v_1} = 6.0$，$z^{\\mathrm{EUR}}_{v_2} = 5.8$，$z^{\\mathrm{EUR}}_{v_3} = 2.0$，$z^{\\mathrm{EUR}}_{v_4} = 0.5$。\n- AFR GWAS $z$-score：$z^{\\mathrm{AFR}}_{v_1} = 5.0$，$z^{\\mathrm{AFR}}_{v_2} = 1.0$，$z^{\\mathrm{AFR}}_{v_3} = 2.5$，$z^{\\mathrm{AFR}}_{v_4} = 0.2$。\n- 变异间的祖源特异性 LD (皮尔逊相关系数 $r$)：\n  - EUR: $r_{12}^{\\mathrm{EUR}} = 0.95$, $r_{13}^{\\mathrm{EUR}} = 0.10$, $r_{14}^{\\mathrm{EUR}} = 0.05$, $r_{23}^{\\mathrm{EUR}} = 0.08$, $r_{24}^{\\mathrm{EUR}} = 0.02$, $r_{34}^{\\mathrm{EUR}} = 0.03$。\n  - AFR: $r_{12}^{\\mathrm{AFR}} = 0.40$, $r_{13}^{\\mathrm{AFR}} = 0.05$, $r_{14}^{\\mathrm{AFR}} = 0.02$, $r_{23}^{\\mathrm{AFR}} = 0.03$, $r_{24}^{\\mathrm{AFR}} = 0.01$, $r_{34}^{\\mathrm{AFR}} = 0.02$。\n- 疾病相关细胞类型中的功能注释：\n  - $v_1$：增强子元件，带有 ATAC-seq（转座酶可及性染色质测序）峰；替换等位基因破坏了转录因子 (TF) $X$ 的基序。\n  - $v_2$：基因间区，无开放染色质，无保守性。\n  - $v_3$：基因 $G$ 的启动子；开放的启动子染色质；无基序破坏。\n  - $v_4$：内含子，低保守性。\n- 相关组织中基因 $G$ 的 eQTL 摘要统计数据：\n  - $v_1$：$z_{\\mathrm{eQTL}} = 4.5$；替换等位基因降低 $G$ 的表达。\n  - $v_2$：$z_{\\mathrm{eQTL}} = 0.5$。\n  - $v_3$：$z_{\\mathrm{eQTL}} = 1.0$。\n  - $v_4$：$z_{\\mathrm{eQTL}} = 0.0$。\n- $G$ 的蛋白质产物的 pQTL：\n  - $v_1$：$z_{\\mathrm{pQTL}} = 3.0$；替换等位基因降低蛋白质丰度。\n- MPRA:\n  - $v_1$：替换等位基因使报告基因活性降低 $20\\%$，且信号在重复实验中一致。\n  - $v_2$：无可检测的等位基因效应。\n  - $v_3$：有 $5\\%$ 的微小增加，但无统计学显著性。\n  - $v_4$：无效应。\n\n假设为病例-对照 GWAS，表型和基因型已标准化，且该性状在此位点有单一的主导信号。疾病相关的细胞类型已得到充分表征，且基因 $G$ 在此组织中表达。\n\n问题：哪一个端到端分析计划及其相应输出，在科学上最为合理，与数据和基本原理内部一致，能够得出有效的因果变异 PIP、一个 $95\\%$ 可信集、变异到基因的指派、机制假说以及一个优先的实验验证计划？\n\nA. 协调不同祖源间的等位基因和摘要统计数据；对每个祖源进行质量控制；在单一共享因果变异模型下，使用祖源特异性 LD 对每个祖源进行精细定位，允许存在多个信号但通过条件分析确认只有一个；通过联合似然整合各祖源；使用一个经过校准的分层先验来整合功能注释，该先验会适度增加增强子活性和 ATAC-seq 峰的权重；计算 PIP，得出 $v_1: 0.96$，$v_2: 0.02$，$v_3: 0.02$，$v_4: 0.00$；将 $95\\%$ 可信集定义为 $\\{v_1\\}$；使用完整的摘要统计数据和 LD 在 GWAS 和 eQTL/pQTL 之间进行共定位，以获得共享因果变异 $v_1$ 的高后验概率；通过共定位以及使用 ABC (Activity-By-Contact) 评分和启动子捕获 Hi-C 进行增强子-基因连接，将变异指派为 $v_1 \\rightarrow G$；提出机制假说：$v_1$ 破坏了 TF $X$ 的结合，从而降低了增强子活性，并减少了 $G$ 的表达和蛋白质丰度；优先进行以下实验：在诱导性多能干细胞 (iPSC) 衍生的疾病相关细胞中对 $v_1$ 进行 CRISPR 碱基编辑，进行等位基因特异性表达和蛋白质检测，对增强子进行 CRISPR 干扰 (CRISPRi)，以及针对 TF $X$ 进行具有等位基因特异性结合分析的染色质免疫共沉淀 (ChIP)。\n\nB. 仅使用 EUR 的 GWAS 和 LD 数据；将 MPRA 视为确定性过滤器，排除 $v_2$、$v_3$ 和 $v_4$；在等同先验概率下计算 PIP，得出 $v_1: 0.55$，$v_2: 0.40$，$v_3: 0.05$，$v_4: 0.00$；将 $95\\%$ 可信集定义为 $\\{v_1, v_2\\}$；按距离将变异指派给最近的基因，忽略 eQTL；推断机制为风险等位基因增加增强子活性；在不表达 $G$ 的通用细胞系（例如 HEK$293$）中进行荧光素酶报告基因检测，且不进行等位基因特异性的基因组编辑。\n\nC. 忽略 LD，通过逆方差加权合并 EUR 和 AFR 的 $z$-score；通过对 $z$-score 的平方应用 softmax 函数来计算 PIP，得出 $v_1: 0.70$，$v_2: 0.20$，$v_3: 0.10$，$v_4: 0.00$；将 $95\\%$ 可信集定义为 $\\{v_1, v_2\\}$；仅使用 eQTL 的 $p$-值进行共定位，不考虑 LD 或精细定位；按邻近原则将变异指派给基因 $G$；在未协调 MPRA 和 eQTL 效应方向的情况下提出机制假说；提议在任何方便的细胞系中对基因 $G$ 进行常规 CRISPR 敲除。\n\nD. 进行多祖源精细定位，但应用一个未校准的功能先验，该先验会极大地增加启动子注释的权重，从而强制使 $v_3$ 占主导地位；计算 PIP，得出 $v_3: 0.80$，$v_1: 0.15$，$v_2: 0.04$，$v_4: 0.01$；将 $95\\%$ 可信集定义为 $\\{v_3\\}$；声称基于弱 eQTL 证据存在共定位；主要根据 $v_3$ 处微小且不显著的 MPRA 效应来为机制辩护；优先进行启动子编辑而非增强子扰动。\n\n选择唯一的最佳选项。",
            "solution": "用户提供了一个关于 GWAS 位点精细定位的问题陈述，并要求评估几个提议的分析计划。任务是首先验证问题陈述，如果有效，则确定科学上最合理的分析计划及其结果。\n\n### 第一步：提取已知信息\n\n- **变异：** 单个位点上的四个双等位基因变异：$v_1, v_2, v_3, v_4$。\n- **人群：** 欧洲祖源 (EUR) 和非洲祖源 (AFR)。\n- **GWAS 关联数据：**\n    - EUR $z$-score：$z^{\\mathrm{EUR}}_{v_1} = 6.0$，$z^{\\mathrm{EUR}}_{v_2} = 5.8$，$z^{\\mathrm{EUR}}_{v_3} = 2.0$，$z^{\\mathrm{EUR}}_{v_4} = 0.5$。\n    - AFR $z$-score：$z^{\\mathrm{AFR}}_{v_1} = 5.0$，$z^{\\mathrm{AFR}}_{v_2} = 1.0$，$z^{\\mathrm{AFR}}_{v_3} = 2.5$，$z^{\\mathrm{AFR}}_{v_4} = 0.2$。\n- **连锁不平衡 (LD) 数据 (皮尔逊相关系数, $r$)：**\n    - EUR: $r_{12}^{\\mathrm{EUR}} = 0.95$。所有其他配对的 $|r| \\le 0.10$。\n    - AFR: $r_{12}^{\\mathrm{AFR}} = 0.40$。所有其他配对的 $|r| \\le 0.05$。\n- **功能基因组学数据（在疾病相关细胞类型中）：**\n    - **注释：**\n        - $v_1$：位于增强子元件中（带有 ATAC-seq 峰）；替换等位基因破坏了转录因子 (TF) $X$ 的基序。\n        - $v_2$：基因间区，无开放染色质，无保守性。\n        - $v_3$：位于基因 $G$ 的启动子中；在开放染色质中。\n        - $v_4$：内含子，低保守性。\n    - **基因 $G$ 的 eQTL：**\n        - $v_1$：$z_{\\mathrm{eQTL}} = 4.5$；替换等位基因降低 $G$ 的表达。\n        - $v_2$：$z_{\\mathrm{eQTL}} = 0.5$。\n        - $v_3$：$z_{\\mathrm{eQTL}} = 1.0$。\n        - $v_4$：$z_{\\mathrm{eQTL}} = 0.0$。\n    - **蛋白质 $G$ 的 pQTL：**\n        - $v_1$：$z_{\\mathrm{pQTL}} = 3.0$；替换等位基因降低蛋白质丰度。\n    - **大规模并行报告基因检测 (MPRA)：**\n        - $v_1$：替换等位基因显示报告基因活性有重复实验一致的 $20\\%$ 降低。\n        - $v_2, v_4$：无效应。\n        - $v_3$：活性有微小、不显著的 $5\\%$ 增加。\n- **定义和原则：**\n    - 用于后验优势比的贝叶斯定理。\n    - 单因果变异精细定位概念。\n    - $95\\%$ 可信集的定义。\n    - 共定位的定义。\n    - 跨祖源精细定位的原则。\n    - 使用校准而非确定性的功能先验的原则。\n- **假设：** 单一主导信号；充分表征的相关细胞类型；基因 $G$ 有表达。\n- **问题：** 确定科学上最合理的端到端分析计划及其结果。\n\n### 第二步：使用提取的已知信息进行验证\n\n评估问题陈述的有效性。\n\n- **科学基础：** 该问题牢固地植根于统计遗传学、群体遗传学和分子生物学的既定原则。所涉及的数据类型（GWAS z-score、LD 矩阵、ATAC-seq、eQTL、pQTL、MPRA）和概念（精细定位、共定位、可信集）都是现代基因组学的标准内容。所呈现的场景是跨祖源精细定位的一个经典案例。\n- **问题适定性：** 该问题是适定的。它提供了充分、一致的数据，足以对可能的因果变异和机制得出合理的结论。多祖源关联数据和多组学功能数据的结合旨在收敛到一个单一、稳定的解决方案。\n- **客观性：** 语言精确、客观。数据以数值形式呈现，原则以正式方式陈述。\n- **一致性检查：**\n    - GWAS 和 LD 数据相互一致且信息量大。在 EUR 人群中，$v_1$ 和 $v_2$ 有非常相似的强关联信号（$z^{\\mathrm{EUR}}_{v_1} = 6.0$，$z^{\\mathrm{EUR}}_{v_2} = 5.8$），因为它们处于极高的 LD 中（$r_{12}^{\\mathrm{EUR}} = 0.95$）。在 AFR 人群中，LD 大幅减弱（$r_{12}^{\\mathrm{AFR}} = 0.40$），关联信号仅由 $v_1$ 保留（$z^{\\mathrm{AFR}}_{v_1} = 5.0$），而 $v_2$ 的信号则衰减至基线水平（$z^{\\mathrm{AFR}}_{v_2} = 1.0$）。这种模式强烈表明 $v_1$ 是因果变异，而 $v_2$ 是欧洲人群中的一个标签 SNP。\n    - 功能数据内部一致，并且都指向 $v_1$ 是功能性变异。$v_1$ 位于一个开放的增强子区域（ATAC-seq 峰），其替换等位基因破坏了一个 TF 基序，在报告基因检测 (MPRA) 中显示出显著效应，是基因 $G$ 的强 eQTL，也是蛋白质 $G$ 的 pQTL。\n    - 效应方向也是一致的：$v_1$ 的替换等位基因与增强子活性降低 (MPRA)、基因表达减少 (eQTL) 和蛋白质丰度降低 (pQTL) 相关联。\n    - 其他变异缺乏这种证据的汇集。$v_3$ 位于启动子中，但其功能效应非常弱且不显著，GWAS 关联也较弱。$v_2$ 和 $v_4$ 没有任何功能支持。\n- **未发现缺陷：** 该问题没有违反任何指定的无效性标准。它在科学上是合理的、完整的、一致的、现实的、适定的和有意义的。\n\n### 第三步：结论和行动\n\n问题陈述是**有效的**。现在开始解答过程。\n\n### 基于原则的推导和选项评估\n\n最佳分析计划必须使用统计上和生物学上合理的方法，利用所有可用的数据源。\n\n1.  **精细定位策略：** 核心挑战是区分 $v_1$ 和 $v_2$。所提供的最强大的工具是 EUR 和 AFR 人群之间的 LD 差异。最先进的方法是采用跨祖源精细定位，联合分析两个祖源的摘要统计数据，并使用各自的 LD 矩阵。这将正确地传播证据，识别出单个因果变异 ($v_1$) 既能解释 EUR 人群中 $v_1$ 和 $v_2$ 的强信号（由于高 LD），也能解释 AFR 人群中仅在 $v_1$ 处存在的强信号（由于较低的 LD）。\n\n2.  **功能数据的整合：** 丰富的功能数据应作为先验信息整合到贝叶斯精细定位框架中。根据所提供的原则，这些先验必须是*经过校准的*——这意味着它们的权重是基于全基因组范围的估计，即某个给定的注释能在多大程度上富集因果变异。这避免了主观或过强的“确定性”先验的陷阱。根据所给数据，像“增强子活性”、“TF 基序破坏”和“显著的 MPRA 效应”这类注释会适度增加 $v_1$ 的先验概率。\n\n3.  **预期的精细定位结果：** 一个正确建模 LD 并整合了适度功能先验的联合跨祖源分析，会将后验概率集中在 $v_1$ 上。$v_2$ 的信号将完全由其在 EUR 人群中与 $v_1$ 的 LD 来解释。因此，$v_1$ 的后验纳入概率 (PIP) 将会非常高（例如，$PIP > 0.95$），而所有其他变异的 PIP 将接近于零。最终得到的 $95\\%$ 可信集将只包含 $v_1$。\n\n4.  **从变异到基因再到机制：**\n    *   **共定位：** 要将 GWAS 信号与基因 $G$ 联系起来，共定位分析是正确的方法。这需要 GWAS 性状和分子性状 (eQTL/pQTL) 的完整摘要统计数据和 LD。鉴于所有三个性状（GWAS、eQTL、pQTL）在 $v_1$ 处都有强烈的重合信号，预计会得到一个共享因果变异的高后验概率。\n    *   **机制假说：** 证据汇集指向一个清晰且一致的机制：$v_1$ 的替换等位基因破坏了增强子中的一个 TF $X$ 结合位点，从而降低了增强子的活性。这反过来又下调了基因 $G$ 的表达，导致蛋白质 $G$ 水平降低，进而影响疾病或性状风险。从增强子到基因 $G$ 的连接应由三维染色质相互作用数据（例如，启动子捕获 Hi-C）或整合了此类信息的计算评分（例如，ABC）来支持。\n\n5.  **实验验证：** 该假说必须通过实验进行检验。金标准是在生物学相关的细胞环境（例如，iPSC 衍生的疾病相关细胞）中对候选因果变异 ($v_1$) 进行精确的基因组编辑（例如，CRISPR 碱基编辑），以观察预期的分子后果（TF 结合、基因表达、蛋白质水平的变化）。扰动调控元件（例如，通过 CRISPRi）也是验证其功能的关键实验。\n\n### 逐项选项分析\n\n**A. 分析计划：** 此选项概述的分析与推导出的理想工作流程完全一致。\n-   它正确地提出了使用联合似然和祖源特异性 LD 进行跨祖源精细定位。\n-   它正确地提出对功能数据使用经过校准的分层先验。\n-   报告的结果（$PIP_{v_1} = 0.96$，可信集 $\\{v_1\\}$）与正确分析所给数据后的预期完全相符。\n-   它正确地将使用完整摘要统计数据的共定位确定为基因指派的方法，并通过三维基因组证据 (Hi-C/ABC) 加强了这一点。\n-   提出的机制与提供的每一条数据都完全一致。\n-   优先考虑的实验计划（在相关细胞中进行碱基编辑、CRISPRi、等位基因特异性检测）代表了当前功能验证的黄金标准。\n-   **结论：** **正确**。\n\n**B. 分析计划：** 此选项包含多个基本错误。\n-   它丢弃了 AFR 数据，而这正是解析因果变异的关键。仅限 EUR 的分析将效力不足，导致错误的可信集 $\\{v_1, v_2\\}$。\n-   它将 MPRA 用作确定性过滤器，违反了既定原则，是一种粗糙的分析方法。\n-   它提出了一种过时的基因指派方法（最近的基因），而忽略了直接证据 (eQTL)。\n-   它陈述的机制（增加活性）与 eQTL 和 MPRA 数据直接矛盾。\n-   实验计划薄弱，使用了不相关的细胞系和信息量较少的检测方法。\n-   **结论：** **不正确**。\n\n**C. 分析计划：** 此选项基于统计上无效的方法。\n-   在忽略 LD 的情况下通过逆方差加权合并 z-score，对于在具有连锁变异的位点进行精细定位是根本错误的。这使得整个分析的前提都无效了。\n-   从 z-score 的 softmax 计算 PIP 是一种粗略的近似，仅在独立性假设下有效，而这里违反了该假设。\n-   仅使用 $p$-值而无 LD 进行共定位不是一种有效或现代的方法。\n-   它在基因指派（邻近）和实验设计（非特异性细胞系）上采取了与选项 B 相同的糟糕选择。\n-   **结论：** **不正确**。\n\n**D. 分析计划：** 此选项描述了一种有偏见且不科学的分析。\n-   它提议应用一个沉重的、未校准的功能先验来强行得到一个期望的结果（$v_3$ 为因果变异），直接违反了既定原则，并忽略了指向 $v_1$ 的压倒性关联和功能数据。这是确认偏误的例子，而非客观科学。\n-   其结论——可信集是 $\\{v_3\\}$ 且弱功能信号是充分理由——是这种有偏先验的人为产物，而非证据本身。\n-   它优先考虑对一个证据很少的变异进行实验，这将是对资源的低效利用。\n-   **结论：** **不正确**。\n\n基于全面的评估，选项 A 是唯一描述了科学严谨、技术先进且内部一致的计划，该计划根据给定的原则正确地解释了所有提供的数据。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}