{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的多重检验校正方法之前，首先必须从根本上理解为什么需要这些方法。本练习  将通过一个思想实验来阐明这一问题，即在一个所有原假设均为真的“全局无效”情景下，即使采用合理的显著性水平，我们预期会产生多少个假阳性发现。这个基础计算揭示了在大规模假设检验中固有的假阳性累积风险。",
            "id": "4317840",
            "problem": "在一个与精准医疗相关的高通量基因组诊断筛选中，假设一个实验室评估 $m=10{,}000$ 个独立的假设，每个假设对应一个独特的变异与治疗反应表型之间的关联。为了量化未经校正的分析的基线假阳性行为，假设所有原假设均为真，并且在原假设下，计算出的 $p$-值是独立的，并精确地在 $[0,1]$ 上服从均匀分布。该实验室计划，如果一个变异的未经校正的 $p$-值至多为固定阈值 $\\alpha=0.001$，则称其为一个发现。\n\n仅从以下定义出发：在原假设为真时，$p$-值服从 $\\mathrm{Uniform}(0,1)$ 分布；各项检验之间保持独立性；族系错误率 (FWER) 是在整个检验族中出现至少一个假发现的概率。请从基本定义出发推导：\n- 在阈值 $\\alpha$ 下，未经校正的发现的期望数量，以及\n- 在阈值 $\\alpha$ 下的族系错误率 (FWER)。\n\n请将您的最终答案表示为单个有序对 $\\left(E, F\\right)$，其中 $E$ 是未经校正的发现的期望数量，$F$ 是族系错误率。无需四舍五入，也无需单位。",
            "solution": "用户想要解决一个关于基因组学中统计指标的问题。\n\n### 步骤1：问题验证\n\n我将首先根据指定程序验证问题陈述。\n\n#### 步骤1.1：提取已知条件\n\n-   独立假设的数量：$m=10{,}000$\n-   条件：所有原假设均为真。\n-   p值的分布：独立同分布于 $\\mathrm{Uniform}(0,1)$。\n-   发现阈值：如果p值至多为 $\\alpha=0.001$，则声明为一项发现。\n-   族系错误率 (FWER) 的定义：至少出现一个假发现的概率。\n-   要求输出：从基本定义出发推导 (a) 未经校正的发现的期望数量 $E$，和 (b) 族系错误率 $F$。\n\n#### 步骤1.2：使用提取的已知条件进行验证\n\n-   **科学基础：** 该问题牢固地植根于统计假设检验的基本原理，特别是在多重比较的背景下。其假设——在原假设下，p值是独立的并服从 $\\mathrm{Uniform}(0,1)$ 分布——是该领域的基石。所描述的场景（所有原假设均为真的“全局原假设”）是用于评估多重检验程序在I类错误控制方面最坏情况性能的标准理论构造。\n-   **适定性：** 这是一个适定问题。它提供了所有必要的参数（$m$, $\\alpha$）、分布和定义，以唯一地确定我们感兴趣的量（$E$ 和 $F$）。\n-   **客观性：** 该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n-   **完整性和一致性：** 问题设置是完整的且内部一致。没有信息缺失，也没有相互矛盾的约束。\n-   **现实性：** 检验数量（$m=10{,}000$）和显著性阈值（$\\alpha=0.001$）的取值对于基因组学中的高通量筛选是现实的。\n-   **结论：** 该问题是有效的。它是生物统计学中一个标准的、基本的问题，用于检验核心概念。\n\n### 步骤2：解题推导\n\n由于该问题是有效的，我现在将从基本定义出发推导所需的量。\n\n#### 发现的期望数量 ($E$) 的推导\n\n令 $p_i$ 表示第 $i$ 个假设的p值，其中 $i \\in \\{1, 2, \\ldots, m\\}$。我们已知 $p_i \\sim \\mathrm{Uniform}(0,1)$。\n\n如果第 $i$ 个假设的p值满足 $p_i \\le \\alpha$，则称其为一项发现。我们为该事件定义一个指示随机变量 $D_i$：\n$$\nD_i = \n\\begin{cases} \n1  \\text{if } p_i \\le \\alpha \\\\\n0  \\text{if } p_i  \\alpha \n\\end{cases}\n$$\n变量 $D_i$ 服从伯努利分布，$D_i \\sim \\mathrm{Bernoulli}(\\pi)$，其中成功概率 $\\pi$ 是单次检验中获得一项发现的概率。这个概率由下式给出：\n$$\n\\pi = P(D_i = 1) = P(p_i \\le \\alpha)\n$$\n由于 $p_i$ 在区间 $[0,1]$ 上均匀分布，其累积分布函数 (CDF) 为 $F(x) = x$（对于 $x \\in [0,1]$）。因此，\n$$\n\\pi = P(p_i \\le \\alpha) = \\int_{0}^{\\alpha} 1 \\, dx = \\alpha\n$$\n这个伯努利随机变量的期望值为 $E[D_i] = \\pi = \\alpha$。\n\n总发现数，我们可以用 $V$ 表示，是所有 $m$ 次检验的单个指示变量之和：\n$$\nV = \\sum_{i=1}^{m} D_i\n$$\n未经校正的发现的期望数量 $E$ 是 $V$ 的期望。根据期望的线性性质，我们有：\n$$\nE = E[V] = E\\left[\\sum_{i=1}^{m} D_i\\right] = \\sum_{i=1}^{m} E[D_i]\n$$\n由于对所有 $i$ 都有 $E[D_i] = \\alpha$，所以总和变为：\n$$\nE = \\sum_{i=1}^{m} \\alpha = m \\alpha\n$$\n代入给定值 $m = 10{,}000$ 和 $\\alpha = 0.001$：\n$$\nE = 10,000 \\times 0.001 = 10\n$$\n\n#### 族系错误率 (FWER) 的推导\n\n问题陈述所有原假设均为真。因此，根据定义，任何发现都是一个假发现（I类错误）。FWER被定义为犯下至少一个假发现的概率。\n$$\n\\text{FWER} = P(\\text{at least one discovery}) = P(V \\ge 1)\n$$\n计算其互补事件的概率更为直接，即零发现的概率，$P(V=0)$。\n$$\nP(V=0) = P(D_1=0 \\text{ and } D_2=0 \\text{ and } \\ldots \\text{ and } D_m=0)\n$$\n在单次检验中未获得发现的概率是：\n$$\nP(D_i = 0) = P(p_i  \\alpha) = 1 - P(p_i \\le \\alpha) = 1 - \\alpha\n$$\n问题陈述p值是独立的。这意味着事件 $\\{D_i=0\\}$ 在所有 $i$ 上也是独立的。因此，所有 $m$ 次检验都没有发现的概率是它们各自概率的乘积：\n$$\nP(V=0) = \\prod_{i=1}^{m} P(D_i=0) = \\prod_{i=1}^{m} (1-\\alpha) = (1-\\alpha)^m\n$$\nFWER，我们记为 $F$，则为：\n$$\nF = \\text{FWER} = 1 - P(V=0) = 1 - (1-\\alpha)^m\n$$\n代入给定值 $m = 10{,}000$ 和 $\\alpha = 0.001$：\n$$\nF = 1 - (1 - 0.001)^{10000} = 1 - (0.999)^{10000}\n$$\n问题不要求数值近似，所以这个精确形式就是FWER的最终表达式。\n\n最终答案是有序对 $(E, F)$。\n$$\nE = 10\n$$\n$$\nF = 1 - (0.999)^{10000}\n$$",
            "answer": "$$\n\\boxed{(10, 1 - (0.999)^{10000})}\n$$"
        },
        {
            "introduction": "控制总体错误率（Family-Wise Error Rate, FWER）是多重检验校正中最严格的方法，旨在将犯至少一次I类错误的概率控制在预设水平 $ \\alpha $ 之下。Holm-Bonferroni 方法是一种经典且强大的逐步（step-down）程序，它比简单的Bonferroni校正更具功效。本练习  提供了一个将Holm方法应用于一组有序p值的具体演练，帮助您掌握其逐步拒绝的逻辑。",
            "id": "4317768",
            "problem": "在一项精准医疗领域的药物基因组学研究中，一个靶向基因panel（targeted panel）用于评估一个队列中遗传变异与某个连续型药物反应生物标志物之间的关联。为将总体错误率（Family-Wise Error Rate, FWER）维持在预设水平，该实验室采用了一种逐步多重检验程序。假设$m=5$个变异-生物标志物关联检验产生了排序后的$p$值：$[0.001, 0.01, 0.02, 0.04, 0.2]$。该研究旨在使用Holm方法将FWER控制在$\\alpha=0.05$的水平。请仅使用FWER控制的核心原则和基因组学中多重比较的单调逐步下降逻辑，确定在Holm方法下应拒绝的原假设总数。请以无单位的单个整数形式提供最终答案。",
            "solution": "在尝试任何解决方案之前，首先评估问题陈述的有效性。\n\n**步骤1：提取已知条件**\n-   执行的关联检验次数，$m = 5$。\n-   来自检验的排序后的$p$值：$p_{(1)}=0.001$, $p_{(2)}=0.01$, $p_{(3)}=0.02$, $p_{(4)}=0.04$, $p_{(5)}=0.2$。\n-   预设的总体错误率（FWER）控制水平，$\\alpha = 0.05$。\n-   多重检验校正程序：Holm方法（一种逐步法）。\n-   目标：确定要拒绝的原假设总数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及到一个标准且被广泛接受的统计程序（Holm方法）在多重检验校正中的应用，而多重检验校正是基因组学和精准医疗中的一个关键概念。该问题提法明确，提供了所有必要的数值和一个清晰定义的目标。它是自洽且内部一致的。数据（$p$值、$m$、$\\alpha$）在所述情境下是现实的。语言客观且明确。该问题不违反任何有效性标准。\n\n**步骤3：结论与行动**\n该问题被认定为有效。将推导解决方案。\n\n目标是确定从一组$m=5$个检验中应拒绝的原假设数量，给定它们排序后的$p$值，同时将总体错误率（FWER）控制在$\\alpha = 0.05$。FWER是在所有假设检验中至少犯一次I类错误（假阳性）的概率。Holm方法，也称为Holm-Bonferroni方法，是一种控制FWER的逐步下降法。\n\n该方法按以下步骤进行：\n令$H_1, H_2, \\dots, H_m$为原假设，令$p_1, p_2, \\dots, p_m$为对应的$p$值。\n1.  将$p$值从小到大排序：$p_{(1)} \\leq p_{(2)} \\leq \\cdots \\leq p_{(m)}$。令$H_{(1)}, H_{(2)}, \\dots, H_{(m)}$为对应的原假设。问题已提供这些排序后的$p$值：\n    -   $p_{(1)} = 0.001$\n    -   $p_{(2)} = 0.01$\n    -   $p_{(3)} = 0.02$\n    -   $p_{(4)} = 0.04$\n    -   $p_{(5)} = 0.2$\n\n2.  该程序从对应最小$p$值$p_{(1)}$的假设开始，依次检验每个假设。对于每个步骤$k$（其中$k=1, 2, \\dots, m$），将第$k$个排序的$p$值$p_{(k)}$与一个调整后的显著性水平$\\frac{\\alpha}{m - k + 1}$进行比较。\n\n3.  当条件首次不满足时，程序停止。如果第一次失败发生在步骤$k$，我们拒绝原假设$H_{(1)}, \\dots, H_{(k-1)}$，并且不拒绝余下的假设$H_{(k)}, \\dots, H_{(m)}$。如果对于所有的$k=1, \\dots, m$，条件都满足，那么所有原假设都被拒绝。\n\n我们将此算法应用于给定的数据。此处，$m=5$且$\\alpha=0.05$。\n\n步骤 $k=1$:\n比较 $p_{(1)}$ 与 $\\frac{\\alpha}{m - 1 + 1} = \\frac{\\alpha}{5} = \\frac{0.05}{5} = 0.01$。\n检验为：$p_{(1)} \\leq 0.01$ 是否成立？\n我们有 $p_{(1)} = 0.001$。由于 $0.001 \\leq 0.01$，条件满足。我们继续下一步。原假设 $H_{(1)}$ 被考虑拒绝。\n\n步骤 $k=2$:\n比较 $p_{(2)}$ 与 $\\frac{\\alpha}{m - 2 + 1} = \\frac{\\alpha}{4} = \\frac{0.05}{4} = 0.0125$。\n检验为：$p_{(2)} \\leq 0.0125$ 是否成立？\n我们有 $p_{(2)} = 0.01$。由于 $0.01 \\leq 0.0125$，条件满足。我们继续下一步。原假设 $H_{(2)}$ 也被考虑拒绝。\n\n步骤 $k=3$:\n比较 $p_{(3)}$ 与 $\\frac{\\alpha}{m - 3 + 1} = \\frac{\\alpha}{3} = \\frac{0.05}{3} \\approx 0.01667$。\n检验为：$p_{(3)} \\leq 0.01667$ 是否成立？\n我们有 $p_{(3)} = 0.02$。由于 $0.02 > 0.01667$，条件不满足。\n\n程序在 $k=3$ 处停止。根据规则，我们拒绝所有对于 $j  k$ 的假设 $H_{(j)}$。在本例中，我们拒绝与 $p_{(1)}$ 和 $p_{(2)}$ 对应的原假设。余下的假设 $H_{(3)}$、$H_{(4)}$ 和 $H_{(5)}$ 不被拒绝。\n\n因此，被拒绝的原假设总数为 $k-1 = 3-1 = 2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在许多探索性的基因组学研究中，控制错误发现率（False Discovery Rate, FDR）——即在所有阳性发现中假阳性所占的比例——被认为是一种比FWER更实用、更具统计功效的策略。Benjamini-Hochberg (BH) 和 Benjamini-Yekutieli (BY) 程序是控制FDR的基石方法。通过这个练习 ，您将应用这两种逐步（step-up）程序，并比较它们在不同依赖性假设下的结果，从而理解保守性与统计功效之间的权衡。",
            "id": "4317734",
            "problem": "一项在精准肿瘤学中的靶向种系测序研究评估了 $m=8$ 个候选基因与一个二元临床终点的关联性，得到了排序后的 $p$ 值 $p_{(1)} \\leq p_{(2)} \\leq \\cdots \\leq p_{(8)}$。排序后的 $p$ 值为\n$$\np_{(1)}=0.004,\\; p_{(2)}=0.006,\\; p_{(3)}=0.011,\\; p_{(4)}=0.018,\\; p_{(5)}=0.032,\\; p_{(6)}=0.041,\\; p_{(7)}=0.072,\\; p_{(8)}=0.12.\n$$\n在名义水平 $\\alpha=0.1$ 下，应用两种控制错误发现率（FDR）的递增多重检验程序：Benjamini–Hochberg (BH) 程序，它在独立性或某些正相关依赖结构下控制FDR；以及Benjamini–Yekutieli (BY) 程序，它在任意依赖结构下控制FDR。对于每种程序，确定在水平 $\\alpha$ 下哪些假设被拒绝，并令 $D_{\\mathrm{BH}}$ 和 $D_{\\mathrm{BY}}$ 分别表示在BH和BY程序下被拒绝的假设数量。报告单一数值 $D_{\\mathrm{BH}}-D_{\\mathrm{BY}}$。将最终答案表示为整数。无需四舍五入。",
            "solution": "用户提供了有效的问题陈述。\n\n### 第一步：提取已知信息\n- 待检验的假设数量：$m=8$。\n- 排序后的p值：$p_{(1)}=0.004, p_{(2)}=0.006, p_{(3)}=0.011, p_{(4)}=0.018, p_{(5)}=0.032, p_{(6)}=0.041, p_{(7)}=0.072, p_{(8)}=0.12$。\n- 期望的错误发现率（FDR）控制水平：$\\alpha=0.1$。\n- 应用的程序：Benjamini–Hochberg (BH) 和 Benjamini–Yekutieli (BY)。\n- 待确定的量：$D_{\\mathrm{BH}}$，即BH程序下拒绝的假设数量，以及$D_{\\mathrm{BY}}$，即BY程序下拒绝的假设数量。\n- 需报告的最终值：$D_{\\mathrm{BH}} - D_{\\mathrm{BY}}$。\n\n### 第二步：使用提取的已知信息进行验证\n该问题具有科学依据，提法明确，且客观。它展示了两种基本的多重检验校正统计程序的标准应用，这两种程序是基因组数据分析的核心。所有必要的数据均已提供，术语精确，设置没有任何矛盾、歧义或事实错误。该问题要求直接、严谨地应用既定算法，从而得出一个唯一的、可验证的解。\n\n### 第三步：结论与行动\n该问题有效。将提供完整解答。\n\n该问题要求应用两种不同的多重假设检验程序，即Benjamini-Hochberg (BH) 和 Benjamini-Yekutieli (BY) 程序，以在名义水平 $\\alpha=0.1$ 下控制错误发现率（FDR）。我们从一项基因组研究中获得了 $m=8$ 个排序后的 $p$ 值。\n\n首先，我们应用Benjamini-Hochberg (BH) 程序。这是一个递增程序，它在检验是独立的或满足正回归依赖性的假设下控制FDR。该程序如下：给定排序后的 $p$ 值 $p_{(1)} \\leq p_{(2)} \\leq \\cdots \\leq p_{(m)}$，我们找到满足以下条件的最大整数 $k$：\n$$p_{(k)} \\leq \\frac{k}{m} \\alpha$$\n如果存在这样的 $k$，我们拒绝与 $p$ 值 $p_{(1)}, p_{(2)}, \\dots, p_{(k)}$ 对应的零假设。拒绝的假设数量为 $D_{\\mathrm{BH}} = k$。如果不存在这样的 $k$，则不拒绝任何假设。\n\n在此问题中，$m=8$ 且 $\\alpha=0.1$。对于每个排序后的 $p$ 值 $p_{(k)}$，BH阈值为 $\\frac{k}{8}(0.1) = 0.0125 \\cdot k$。我们来检验从 $k=1$ 到 $k=8$ 的每个 $k$ 的条件。\n\n当 $k=1$ 时：$p_{(1)} = 0.004$。阈值为 $0.0125 \\times 1 = 0.0125$。由于 $0.004 \\leq 0.0125$，条件成立。\n当 $k=2$ 时：$p_{(2)} = 0.006$。阈值为 $0.0125 \\times 2 = 0.025$。由于 $0.006 \\leq 0.025$，条件成立。\n当 $k=3$ 时：$p_{(3)} = 0.011$。阈值为 $0.0125 \\times 3 = 0.0375$。由于 $0.011 \\leq 0.0375$，条件成立。\n当 $k=4$ 时：$p_{(4)} = 0.018$。阈值为 $0.0125 \\times 4 = 0.05$。由于 $0.018 \\leq 0.05$，条件成立。\n当 $k=5$ 时：$p_{(5)} = 0.032$。阈值为 $0.0125 \\times 5 = 0.0625$。由于 $0.032 \\leq 0.0625$，条件成立。\n当 $k=6$ 时：$p_{(6)} = 0.041$。阈值为 $0.0125 \\times 6 = 0.075$。由于 $0.041 \\leq 0.075$，条件成立。\n当 $k=7$ 时：$p_{(7)} = 0.072$。阈值为 $0.0125 \\times 7 = 0.0875$。由于 $0.072 \\leq 0.0875$，条件成立。\n当 $k=8$ 时：$p_{(8)} = 0.12$。阈值为 $0.0125 \\times 8 = 0.1$。由于 $0.12 > 0.1$，条件不成立。\n\n满足条件 $p_{(k)} \\leq \\frac{k}{m} \\alpha$ 的最大 $k$ 值为 $k=7$。因此，根据BH程序，我们拒绝与最小的7个 $p$ 值相对应的零假设。被拒绝的假设数量为 $D_{\\mathrm{BH}} = 7$。\n\n接下来，我们应用Benjamini-Yekutieli (BY) 程序。该程序更为严格，在检验之间存在任意依赖结构的情况下控制FDR。它通过引入一个校正因子 $C(m)$ 来修改BH程序，该因子是第 $m$ 个调和数。该程序如下：找到满足以下条件的最大整数 $k$：\n$$p_{(k)} \\leq \\frac{k}{m \\cdot C(m)} \\alpha$$\n其中 $C(m) = \\sum_{i=1}^{m} \\frac{1}{i}$。拒绝的假设数量为 $D_{\\mathrm{BY}}=k$。\n\n对于 $m=8$，校正因子为 $C(8) = H_8$，即第8个调和数。\n$$C(8) = \\sum_{i=1}^{8} \\frac{1}{i} = \\frac{1}{1} + \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} + \\frac{1}{6} + \\frac{1}{7} + \\frac{1}{8}$$\n使用公分母840计算此和：\n$$C(8) = \\frac{840}{840} + \\frac{420}{840} + \\frac{280}{840} + \\frac{210}{840} + \\frac{168}{840} + \\frac{140}{840} + \\frac{120}{840} + \\frac{105}{840} = \\frac{840+420+280+210+168+140+120+105}{840} = \\frac{2283}{840} = \\frac{761}{280}$$\n用小数形式表示，$C(8) \\approx 2.717857$。\n对于每个排序后的 $p$ 值 $p_{(k)}$，BY阈值为 $\\frac{k}{m \\cdot C(m)} \\alpha = \\frac{k}{8 \\cdot (761/280)} (0.1) = \\frac{k \\cdot 0.1}{(761/35)} = \\frac{3.5 \\cdot k}{761}$。\n\n我们来检验每个 $k$ 的条件：\n对于 $k$ 的阈值为：$T_k = \\frac{3.5k}{761}$。\n当 $k=1$ 时：$p_{(1)} = 0.004$。阈值为 $T_1 = \\frac{3.5}{761} \\approx 0.004599$。由于 $0.004 \\leq T_1$，条件成立。\n当 $k=2$ 时：$p_{(2)} = 0.006$。阈值为 $T_2 = \\frac{7.0}{761} \\approx 0.009198$。由于 $0.006 \\leq T_2$，条件成立。\n当 $k=3$ 时：$p_{(3)} = 0.011$。阈值为 $T_3 = \\frac{10.5}{761} \\approx 0.013798$。由于 $0.011 \\leq T_3$，条件成立。\n当 $k=4$ 时：$p_{(4)} = 0.018$。阈值为 $T_4 = \\frac{14.0}{761} \\approx 0.018397$。由于 $0.018 \\leq T_4$，条件成立。\n当 $k=5$ 时：$p_{(5)} = 0.032$。阈值为 $T_5 = \\frac{17.5}{761} \\approx 0.022996$。由于 $0.032 > T_5$，条件不成立。\n由于当 $k=5$ 时条件不成立，我们无需检查大于5的 $k$。\n\n满足条件 $p_{(k)} \\leq \\frac{k}{m \\cdot C(m)} \\alpha$ 的最大 $k$ 值为 $k=4$。因此，根据BY程序，我们拒绝与最小的4个 $p$ 值相对应的零假设。被拒绝的假设数量为 $D_{\\mathrm{BY}} = 4$。\n\n问题要求计算 $D_{\\mathrm{BH}} - D_{\\mathrm{BY}}$ 的值。\n$D_{\\mathrm{BH}} = 7$\n$D_{\\mathrm{BY}} = 4$\n差值为 $D_{\\mathrm{BH}} - D_{\\mathrm{BY}} = 7 - 4 = 3$。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}