{
    "hands_on_practices": [
        {
            "introduction": "在孟德尔随机化（MR）分析中，最基本的因果效应估计方法是使用单个遗传变异作为工具变量。本练习将指导您计算Wald估算值，即工具变量与结局关联强度和工具变量与暴露关联强度的比值。掌握这一核心计算是理解更复杂MR方法的第一步。",
            "id": "4357996",
            "problem": "一项基因组诊断学中的精准医疗研究旨在使用孟德尔随机化（Mendelian Randomization, MR）来估计标准化血浆生物标志物 $X$ 对标准化疾病性状 $Y$ 的因果效应。研究使用一个单一的遗传变异 $G$（单核苷酸多态性，Single-Nucleotide Polymorphism, SNP）作为工具变量。假设以下核心工具变量假设成立：相关性（$G$ 与 $X$ 相关）、独立性（$G$ 独立于 $X$ 和 $Y$ 的混杂因素），以及排他性限制（$G$ 仅通过 $X$ 影响 $Y$）。这些关联在一个双样本设定中进行估计，其中抽样误差独立且符合大样本正态性。设 $\\hat{\\beta}_{GX}$ 表示 $G$ 与 $X$ 的估计关联，$\\hat{\\beta}_{GY}$ 表示 $G$ 与 $Y$ 的估计关联。给定数据为 $\\hat{\\beta}_{GX} = 0.08$（每个等位基因的标准差单位）、$\\hat{\\beta}_{GY} = -0.016$（每个等位基因的标准差单位）、$\\text{SE}(\\hat{\\beta}_{GX}) = 0.01$ 和 $\\text{SE}(\\hat{\\beta}_{GY}) = 0.005$，其中 $\\text{SE}$ 表示标准误差（Standard Error, SE）。\n\n在与上述假设一致的线性结构模型下，使用一阶多元 delta 方法计算 $X$ 对 $Y$ 的因果效应的 Wald 估计量及其标准误差，并假设 $\\hat{\\beta}_{GX}$ 和 $\\hat{\\beta}_{GY}$ 相互独立。将估计量及其标准误差均四舍五入至四位有效数字。将您的最终答案表示为一个包含两个条目的行向量 $\\begin{pmatrix}\\text{estimate}  \\text{standard error}\\end{pmatrix}$，不带单位。",
            "solution": "目标是使用单个工具变量 $G$，通过孟德尔随机化 (MR) 估计 $X$ 对 $Y$ 的因果效应。在工具变量假设（相关性、独立性和排他性限制）以及线性结构模型下，群体水平的因果效应由工具变量-结局关联与工具变量-暴露关联的比率来识别。相应的样本估计量是 Wald 估计量，即估计关联的比率。\n\n设 $\\hat{\\beta}_{GX}$ 表示 $G$ 与 $X$ 的估计关联，$\\hat{\\beta}_{GY}$ 表示 $G$ 与 $Y$ 的估计关联。Wald 估计量为\n$$\n\\hat{\\beta}_{YX}^{\\text{Wald}} = \\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}}。\n$$\n根据 $\\hat{\\beta}_{GX} = 0.08$ 和 $\\hat{\\beta}_{GY} = -0.016$，我们计算\n$$\n\\hat{\\beta}_{YX}^{\\text{Wald}} = \\frac{-0.016}{0.08} = -0.2。\n$$\n\n接下来，我们使用一阶多元 delta 方法计算比率估计量的标准误差。定义函数 $g(a,b) = \\frac{a}{b}$，其中 $(a,b)$ 对应于 $(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX})$。$g$ 在 $(a,b)$ 处的梯度为\n$$\n\\nabla g(a,b) = \\left( \\frac{\\partial g}{\\partial a}, \\frac{\\partial g}{\\partial b} \\right) = \\left( \\frac{1}{b}, -\\frac{a}{b^{2}} \\right)。\n$$\n假设在双样本设定中抽样误差独立，因此 $\\operatorname{Cov}(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX}) = 0$，并记 $\\operatorname{Var}(\\hat{\\beta}_{GY}) = \\text{SE}(\\hat{\\beta}_{GY})^{2}$ 和 $\\operatorname{Var}(\\hat{\\beta}_{GX}) = \\text{SE}(\\hat{\\beta}_{GX})^{2}$，则 $g(\\hat{\\beta}_{GY}, \\hat{\\beta}_{GX})$ 方差的 delta 方法近似值为\n$$\n\\operatorname{Var}\\!\\left(\\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}}\\right) \\approx \\left(\\frac{1}{\\hat{\\beta}_{GX}}\\right)^{2} \\operatorname{Var}(\\hat{\\beta}_{GY}) + \\left(\\frac{\\hat{\\beta}_{GY}}{\\hat{\\beta}_{GX}^{2}}\\right)^{2} \\operatorname{Var}(\\hat{\\beta}_{GX})\n$$。\n代入给定值 $\\hat{\\beta}_{GX} = 0.08$、$\\hat{\\beta}_{GY} = -0.016$、$\\text{SE}(\\hat{\\beta}_{GX}) = 0.01$ 和 $\\text{SE}(\\hat{\\beta}_{GY}) = 0.005$：\n$$\n\\operatorname{Var}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx \\frac{(0.005)^{2}}{(0.08)^{2}} + \\frac{(-0.016)^{2} (0.01)^{2}}{(0.08)^{4}}。\n$$\n分别计算各项：\n- 第一项：\n$$\n\\frac{(0.005)^{2}}{(0.08)^{2}} = \\frac{0.000025}{0.0064} = 0.00390625。\n$$\n- 第二项：\n$$\n\\frac{(-0.016)^{2} (0.01)^{2}}{(0.08)^{4}} = \\frac{0.000256 \\times 0.0001}{0.00004096} = \\frac{2.56 \\times 10^{-8}}{4.096 \\times 10^{-5}} = 6.25 \\times 10^{-4} = 0.000625。\n$$\n将两项相加，\n$$\n\\operatorname{Var}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx 0.00390625 + 0.000625 = 0.00453125。\n$$\n因此，标准误差为\n$$\n\\text{SE}\\!\\left(\\hat{\\beta}_{YX}^{\\text{Wald}}\\right) \\approx \\sqrt{0.00453125} \\approx 0.06731,\n$$\n四舍五入到四位有效数字。\n\nWald 估计值本身恰好是 $-0.2$，四舍五入到四位有效数字为 $-0.2000$。要求的最终答案是包含估计值及其标准误差的二元行向量，两者均四舍五入到四位有效数字且不带单位：\n$$\n\\begin{pmatrix}\n-0.2000  0.06731\n\\end{pmatrix}。\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.2000  0.06731\\end{pmatrix}}$$"
        },
        {
            "introduction": "当有多个有效的工具变量可用时，我们可以将它们的因果效应估计值合并，以获得更高的统计功效和更精确的结果。逆方差加权（IVW）方法是实现这一目标的主要工具，它通过对每个工具变量的估计值进行加权平均来得到一个统一的因果效应估计。本练习将让您实践如何应用IVW方法，这是多工具变量MR分析的标准流程。",
            "id": "4358027",
            "problem": "一个精准医学研究团队试图使用孟德尔随机化（Mendelian Randomization, MR）来估计连续生物标志物暴露对二元疾病结局的因果效应。该团队已确定了四个与暴露密切相关的独立单核苷酸多态性（Single-Nucleotide Polymorphism, SNP）工具变量，并收集了两样本汇总关联估计值。对于每个 SNP $j \\in \\{1,2,3,4\\}$，他们报告了基因与暴露的关联 $\\hat{\\beta}_{GX,j}$ 和与结局的关联 $\\hat{\\beta}_{GY,j}$，以及相应的标准误 $\\mathrm{SE}(\\hat{\\beta}_{GX,j})$ 和 $\\mathrm{SE}(\\hat{\\beta}_{GY,j})$。MR 的关联性、独立性和排他性限制假设被认为是合理的，并且用于暴露和结局关联的样本是独立的。\n\n可用的汇总数据如下：\n- SNP $1$：$\\hat{\\beta}_{GX,1} = 0.08$，$\\mathrm{SE}(\\hat{\\beta}_{GX,1}) = 0.004$；$\\hat{\\beta}_{GY,1} = 0.032$，$\\mathrm{SE}(\\hat{\\beta}_{GY,1}) = 0.015$。\n- SNP $2$：$\\hat{\\beta}_{GX,2} = 0.12$，$\\mathrm{SE}(\\hat{\\beta}_{GX,2}) = 0.005$；$\\hat{\\beta}_{GY,2} = 0.050$，$\\mathrm{SE}(\\hat{\\beta}_{GY,2}) = 0.020$。\n- SNP $3$：$\\hat{\\beta}_{GX,3} = 0.05$，$\\mathrm{SE}(\\hat{\\beta}_{GX,3}) = 0.003$；$\\hat{\\beta}_{GY,3} = 0.020$，$\\mathrm{SE}(\\hat{\\beta}_{GY,3}) = 0.012$。\n- SNP $4$：$\\hat{\\beta}_{GX,4} = 0.10$，$\\mathrm{SE}(\\hat{\\beta}_{GX,4}) = 0.004$；$\\hat{\\beta}_{GY,4} = 0.036$，$\\mathrm{SE}(\\hat{\\beta}_{GY,4}) = 0.018$。\n\n假设一个线性因果模型将 SNP-结局关联与 SNP-暴露关联和单个因果效应参数的乘积联系起来，外加一个随机误差，其方差在报告的结局标准误范围内已知。同时，假设无测量误差（No Measurement Error, NOME）近似对于暴露关联成立，即在加权时 $\\hat{\\beta}_{GX,j}$ 的不确定性可以忽略不计。在这些假设下，使用反方差加权（Inverse-Variance Weighted, IVW）方法（权重与结局关联方差的倒数成正比、且通过原点的加权最小二乘法）来计算：\n- 因果效应的 IVW 点估计值，以及\n- 使用正态近似法计算出的相应 $95\\%$ 置信区间。\n\n将这三个数字（点估计值、置信区间下限和置信区间上限）中的每一个都四舍五入到四位有效数字。最终数值答案以不带单位的小数形式表示。",
            "solution": "用户提供的问题已经过验证，被确定为一个有效的、适定的科学问题。\n\n该问题要求基于两样本孟德尔随机化（Mendelian Randomization, MR）研究的汇总数据，计算因果效应的反方差加权（Inverse-Variance Weighted, IVW）点估计值及其相应的 $95\\%$ 置信区间。\n\nIVW方法的核心原理是对 SNP-结局关联（$\\hat{\\beta}_{GY,j}$）与 SNP-暴露关联（$\\hat{\\beta}_{GX,j}$）进行加权线性回归，并约束该回归线通过原点。每个 SNP $j$ 的模型为：\n$$ \\hat{\\beta}_{GY,j} = \\beta_{IVW} \\hat{\\beta}_{GX,j} + \\epsilon_j $$\n其中 $\\beta_{IVW}$ 是我们要求解的因果效应估计值。\n\n问题指明权重与结局关联方差的倒数成正比。这与无测量误差（NOME）假设（即将 $\\hat{\\beta}_{GX,j}$ 视为固定的已知值）相结合，导出了标准的 IVW 估计量。第 $j$ 个工具变量的权重为 $w_j = 1 / \\mathrm{SE}(\\hat{\\beta}_{GY,j})^2$。\n\nIVW 点估计值 $\\hat{\\beta}_{IVW}$ 的公式是加权最小二乘问题的解：\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum_{j=1}^{J} w_j \\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\sum_{j=1}^{J} w_j \\hat{\\beta}_{GX,j}^2} = \\frac{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}}{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}} $$\n其中 $J=4$ 是 SNP 的数量。\n\n假设工具变量相互独立且 NOME 假设成立，IVW 估计值的标准误由下式给出：\n$$ \\mathrm{SE}(\\hat{\\beta}_{IVW}) = \\sqrt{\\frac{1}{\\sum_{j=1}^{J} \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}}} $$\n\n我们将为 $J=4$ 个 SNP 中的每一个计算 $\\hat{\\beta}_{IVW}$ 公式中的分子项和分母项。令 $N_j = \\frac{\\hat{\\beta}_{GX,j} \\hat{\\beta}_{GY,j}}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}$ 和 $D_j = \\frac{\\hat{\\beta}_{GX,j}^2}{\\mathrm{SE}(\\hat{\\beta}_{GY,j})^2}$。\n\n对于 SNP 1:\n$\\hat{\\beta}_{GX,1} = 0.08$, $\\hat{\\beta}_{GY,1} = 0.032$, $\\mathrm{SE}(\\hat{\\beta}_{GY,1}) = 0.015$。\n$N_1 = \\frac{0.08 \\times 0.032}{0.015^2} = \\frac{0.00256}{0.000225} = \\frac{512}{45}$\n$D_1 = \\frac{0.08^2}{0.015^2} = \\frac{0.0064}{0.000225} = \\frac{256}{9}$\n\n对于 SNP 2:\n$\\hat{\\beta}_{GX,2} = 0.12$, $\\hat{\\beta}_{GY,2} = 0.050$, $\\mathrm{SE}(\\hat{\\beta}_{GY,2}) = 0.020$。\n$N_2 = \\frac{0.12 \\times 0.050}{0.020^2} = \\frac{0.006}{0.0004} = 15$\n$D_2 = \\frac{0.12^2}{0.020^2} = \\frac{0.0144}{0.0004} = 36$\n\n对于 SNP 3:\n$\\hat{\\beta}_{GX,3} = 0.05$, $\\hat{\\beta}_{GY,3} = 0.020$, $\\mathrm{SE}(\\hat{\\beta}_{GY,3}) = 0.012$。\n$N_3 = \\frac{0.05 \\times 0.020}{0.012^2} = \\frac{0.001}{0.000144} = \\frac{125}{18}$\n$D_3 = \\frac{0.05^2}{0.012^2} = \\frac{0.0025}{0.000144} = \\frac{625}{36}$\n\n对于 SNP 4:\n$\\hat{\\beta}_{GX,4} = 0.10$, $\\hat{\\beta}_{GY,4} = 0.036$, $\\mathrm{SE}(\\hat{\\beta}_{GY,4}) = 0.018$。\n$N_4 = \\frac{0.10 \\times 0.036}{0.018^2} = \\frac{0.0036}{0.000324} = \\frac{100}{9}$\n$D_4 = \\frac{0.10^2}{0.018^2} = \\frac{0.01}{0.000324} = \\frac{2500}{81}$\n\n现在，我们将这些项相加：\n$$ \\sum_{j=1}^{4} N_j = \\frac{512}{45} + 15 + \\frac{125}{18} + \\frac{100}{9} = \\frac{1024 + 1350 + 625 + 1000}{90} = \\frac{3999}{90} $$\n$$ \\sum_{j=1}^{4} D_j = \\frac{256}{9} + 36 + \\frac{625}{36} + \\frac{2500}{81} = \\frac{9216 + 11664 + 5625 + 10000}{324} = \\frac{36505}{324} $$\n\nIVW 点估计值为：\n$$ \\hat{\\beta}_{IVW} = \\frac{\\sum N_j}{\\sum D_j} = \\frac{3999/90}{36505/324} = \\frac{3999}{90} \\times \\frac{324}{36505} \\approx 0.3943673 $$\n四舍五入到四位有效数字，点估计值为 $0.3944$。\n\n该估计值的标准误为：\n$$ \\mathrm{SE}(\\hat{\\beta}_{IVW}) = \\frac{1}{\\sqrt{\\sum D_j}} = \\frac{1}{\\sqrt{36505/324}} = \\sqrt{\\frac{324}{36505}} \\approx 0.0942103 $$\n\n为了计算 $95\\%$ 置信区间，我们使用正态近似法：\n$$ CI_{95\\%} = \\hat{\\beta}_{IVW} \\pm z_{0.975} \\times \\mathrm{SE}(\\hat{\\beta}_{IVW}) $$\n对于 $95\\%$ 的置信水平，标准正态分布的临界值为 $z_{0.975} \\approx 1.96$。\n\n误差范围是：\n$$ ME = 1.96 \\times 0.0942103 \\approx 0.1846522 $$\n\n置信区间的下限和上限分别为：\n下限：$LB = 0.3943673 - 0.1846522 = 0.2097151$\n上限：$UB = 0.3943673 + 0.1846522 = 0.5790195$\n\n将这些界限四舍五入到四位有效数字：\n下限 $\\approx 0.2097$\n上限 $\\approx 0.5790$（末尾的零是有效数字）\n\n最终结果，四舍五入到四位有效数字，为：\n-   IVW 点估计值：$0.3944$\n-   $95\\%$ CI 下限：$0.2097$\n-   $95\\%$ CI 上限：$0.5790$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3944  0.2097  0.5790 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "MR分析的一个关键挑战是水平多效性，即遗传工具通过暴露之外的途径影响结局，这会违反核心假设。加权中位数估计量是一种稳健的方法，即使部分工具变量无效（即存在水平多效性），它仍能提供有效的因果估计。通过本练习，您将学习如何计算这种稳健的估计量，并理解在面对潜在的假设违背时，进行稳健推断的重要性。",
            "id": "4358001",
            "problem": "一位精准医学领域的研究人员正在使用孟德尔随机化 (MR) 方法，通过五个独立的单核苷酸多态性 (SNP) 来估计某项暴露对一个结局的因果效应。对于 SNP 工具变量 $i \\in \\{1,\\dots,5\\}$，其特定于 SNP 的 Wald 比率 $r_i = \\hat{\\beta}_{Y \\mid G_i}/\\hat{\\beta}_{X \\mid G_i}$ 是由核心的工具变量量值定义的，其中 $\\hat{\\beta}_{Y \\mid G_i}$ 和 $\\hat{\\beta}_{X \\mid G_i}$ 分别是结局和暴露对 SNP $i$ 的全基因组关联研究回归系数。假设每个比率估计值 $r_i$ 都具有有限方差，并且可获得逆方差权重 $w_i$，其与 $1/\\operatorname{Var}(r_i)$ 成正比，较大的 $w_i$ 表示较高的精度。简单加权中位数估计量是使 $\\sum_{i=1}^{5} w_i |r_i - \\theta|$ 最小化的值 $\\theta$。\n\n现给出以下五个 Wald 比率（单位：暴露每增加一个标准差，结局的标准差变化量）和相应的正权重：\n- SNP $1$：$r_1 = 0.12$，$w_1 = 4.0$。\n- SNP $2$：$r_2 = 0.18$，$w_2 = 5.5$。\n- SNP $3$：$r_3 = 0.22$，$w_3 = 6.0$。\n- SNP $4$：$r_4 = 0.95$，$w_4 = 0.5$。\n- SNP $5$：$r_5 = 0.15$，$w_5 = 4.5$。\n\n使用这五个特定于 SNP 的比率和权重，计算因果效应的简单加权中位数估计量。将答案四舍五入至四位有效数字。以暴露每增加一个标准差，结局的标准差变化量为单位表示最终效应。\n\n然后，在中位数有效性假设（即至少 $0.5$ 的总权重来自有效的工具变量）下，判断该估计量对于这五个 SNP 中存在单个水平多效性异常值是否稳健，并根据所提供的权重用一句话证明你的判断。你的数值答案应只反映点估计值；任何证明都应包含在你的计算过程中，而不是在最终的数值答案中。",
            "solution": "用户提供了一个问题，在尝试解决之前需要进行验证。\n\n### 步骤 1：提取已知条件\n-   单核苷酸多态性 (SNP) 的数量为 $5$。\n-   SNP 工具变量索引为 $i \\in \\{1, \\dots, 5\\}$。\n-   特定于 SNP 的 Wald 比率为 $r_i = \\hat{\\beta}_{Y \\mid G_i}/\\hat{\\beta}_{X \\mid G_i}$。\n-   逆方差权重 $w_i$ 与 $1/\\operatorname{Var}(r_i)$ 成正比。\n-   简单加权中位数估计量 $\\theta$ 是使总和 $\\sum_{i=1}^{5} w_i |r_i - \\theta|$ 最小化的值。\n-   给定的 Wald 比率 ($r_i$) 和正权重 ($w_i$) 如下：\n    -   SNP $1$：$r_1 = 0.12$，$w_1 = 4.0$。\n    -   SNP $2$：$r_2 = 0.18$，$w_2 = 5.5$。\n    -   SNP $3$：$r_3 = 0.22$，$w_3 = 6.0$。\n    -   SNP $4$：$r_4 = 0.95$，$w_4 = 0.5$。\n    -   SNP $5$：$r_5 = 0.15$，$w_5 = 4.5$。\n-   要求计算简单加权中位数估计量 $\\theta$。\n-   最终答案必须四舍五入到四位有效数字。\n-   中位数有效性假设是，至少 $0.5$ 的总权重来自有效的工具变量。\n-   第二个任务是在此假设下，判断该估计量对单个水平多效性异常值是否稳健，并提供一句话的证明。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实合理性**：该问题在科学上是合理的。它描述了简单加权中位数估计量，这是孟德尔随机化 (MR) 中用于遗传学和流行病学因果推断的一种标准且广泛使用的方法。Wald 比率、逆方差加权、水平多效性和中位数有效性假设等概念都是 MR 领域内基本且正确陈述的原则。\n2.  **非形式化或不相关**：该问题可以形式化为一个定义明确的统计估计任务。它与*精准医学和基因组诊断*领域内的*孟德尔随机化因果推断*主题直接相关。\n3.  **不完整或矛盾的设置**：该问题是完整的。它提供了计算加权中位数所需的所有必要数据（比率集 $r_i$ 及其相应权重 $w_i$）。没有矛盾的陈述。\n4.  **不切实际或不可行**：所提供的数据是现实的。这种量级的 Wald 比率和给定的权重模式（其中潜在的异常值权重非常低，表明精度较低）在真实世界的全基因组关联研究 (GWAS) 汇总数据中是合理的。\n5.  **不适定或结构不良**：该问题是适定的。$\\sum w_i |r_i - \\theta|$ 的最小化定义了加权中位数，对于连续分布或具有奇数个数据点的离散分布，它是一个唯一的估计量，或者在不唯一时按惯例确定。根据给定的数据，存在唯一解。\n6.  **伪深刻、琐碎或同义反复**：该问题并非琐碎。它要求正确应用加权中位数的定义，这涉及排序、计算累积权重和识别正确的数据点。\n7.  **无法进行科学验证**：计算是确定性的且可验证的。\n\n### 步骤 3：结论和行动\n该问题是**有效的**。将提供解决方案。\n\n目标是找到使目标函数 $S(\\theta) = \\sum_{i=1}^{5} w_i |r_i - \\theta|$ 最小化的 $\\theta$ 值。这个最小化问题的解是 Wald 比率集合 $\\{r_1, r_2, r_3, r_4, r_5\\}$ 在相应权重 $\\{w_1, w_2, w_3, w_4, w_5\\}$ 下的加权中位数。\n\n寻找加权中位数的过程如下：\n1.  将 Wald 比率 $r_i$ 按数值升序排列，同时保持其关联的权重 $w_i$ 与之配对。设排序后的比率为 $r_{(j)}$，其权重为 $w_{(j)}$，其中 $j=1, \\dots, 5$。\n2.  计算所有权重的总和，$W = \\sum_{i=1}^{5} w_i$。\n3.  计算排序后权重的累积和，$C_j = \\sum_{k=1}^{j} w_{(k)}$。\n4.  加权中位数估计量 $\\theta$ 是其累积权重 $C_j$ 第一个达到或超过总权重一半 ($W/2$) 的那个排序后的比率 $r_{(j)}$。\n\n首先，我们列出给定的数据对 $(r_i, w_i)$：\n$(0.12, 4.0)$, $(0.18, 5.5)$, $(0.22, 6.0)$, $(0.95, 0.5)$, $(0.15, 4.5)$。\n\n步骤 1：按 $r_i$ 的值对数据对进行排序：\n-   $j=1$: $(r_{(1)}, w_{(1)}) = (0.12, 4.0)$\n-   $j=2$: $(r_{(2)}, w_{(2)}) = (0.15, 4.5)$\n-   $j=3$: $(r_{(3)}, w_{(3)}) = (0.18, 5.5)$\n-   $j=4$: $(r_{(4)}, w_{(4)}) = (0.22, 6.0)$\n-   $j=5$: $(r_{(5)}, w_{(5)}) = (0.95, 0.5)$\n\n步骤 2：计算总权重 $W$：\n$$W = \\sum_{i=1}^{5} w_i = 4.0 + 5.5 + 6.0 + 0.5 + 4.5 = 20.5$$\n总权重的一半是 $W/2 = 20.5 / 2 = 10.25$。\n\n步骤 3：计算排序后权重的累积和：\n-   $C_1 = w_{(1)} = 4.0$\n-   $C_2 = w_{(1)} + w_{(2)} = 4.0 + 4.5 = 8.5$\n-   $C_3 = w_{(1)} + w_{(2)} + w_{(3)} = 8.5 + 5.5 = 14.0$\n-   $C_4 = w_{(1)} + w_{(2)} + w_{(3)} + w_{(4)} = 14.0 + 6.0 = 20.0$\n-   $C_5 = w_{(1)} + w_{(2)} + w_{(3)} + w_{(4)} + w_{(5)} = 20.0 + 0.5 = 20.5$\n\n步骤 4：确定加权中位数。我们寻找第一个使 $C_j \\ge W/2 = 10.25$ 的索引 $j$。\n-   $C_1 = 4.0  10.25$\n-   $C_2 = 8.5  10.25$\n-   $C_3 = 14.0 \\ge 10.25$\n第一个达到或超过 $10.25$ 的累积权重是 $C_3$。因此，加权中位数估计量是相应的值 $r_{(3)}$。\n$$\\theta = r_{(3)} = 0.18$$\n问题要求答案四舍五入到四位有效数字。\n$$\\theta = 0.1800$$\n该效应的单位是暴露每增加一个标准差，结局的标准差变化量。\n\n接下来，我们评估该估计量对单个多效性异常值的稳健性。中位数有效性假设指出，只要至少 $50\\%$ 的总权重来自有效的工具变量，该估计量就是一致的。一个推论是，只要无效工具变量（异常值）贡献的权重低于总权重的 $50\\%$，加权中位数就能稳健地抵抗由这些无效工具变量引起的偏倚。\n\n在给定的数据集中，值 $r_4 = 0.95$ 相对于其他四个聚集在 $0.12$ 和 $0.22$ 之间的比率来说，是一个明显的异常值。我们假设这个 SNP 就是那个多效性异常值。\n与这个潜在异常值相关的权重是 $w_4 = 0.5$。\n总权重是 $W = 20.5$。\n这个单个异常值贡献的总权重比例是：\n$$\\frac{w_4}{W} = \\frac{0.5}{20.5} \\approx 0.02439$$\n这大约相当于总权重的 $2.44\\%$。由于该值远低于 $50\\%$ 的阈值，因此加权中位数不受此异常值的影响。剩余的 $97.56\\%$ 的权重来自其他四个工具变量，它们满足了中位数有效性假设。因此，该估计量是稳健的。\n\n所需的证明如下：该估计量是稳健的，因为单个潜在异常值贡献的权重为 $w_4=0.5$，仅占总权重（$W=20.5$）的约 $2.4\\%$，这个值远低于会破坏中位数的 $50\\%$ 阈值。",
            "answer": "$$\n\\boxed{0.1800}\n$$"
        }
    ]
}