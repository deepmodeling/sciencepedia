{
    "hands_on_practices": [
        {
            "introduction": "构建多基因风险评分（PRS）的第一步通常是处理全基因组关联研究（GWAS）的汇总统计数据。本练习将重点介绍一种被称为“聚类和阈值化”（clumping-and-thresholding, P+T）的常用方法，该方法用于筛选出一组近似独立的遗传变异。通过这个动手实践，您将亲身体验这一关键的数据处理步骤，从而理解如何从庞大的GWAS数据中构建一个有意义的PRS。",
            "id": "4326863",
            "problem": "在多基因风险建模中，一个核心定义是个体的多基因风险评分 (PRS) 是通过对选定的单核苷酸多态性 (SNPs) 的基因型剂量进行加权求和来计算的，其中权重是从全基因组关联研究 (GWAS) 中得出的等位基因效应值。形式上，对于选定集合 $\\mathcal{J}$ 中由 $j$ 索引的 SNPs，原始 PRS 为 $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$，其中 $\\hat{\\beta}_{j}$ 是 GWAS 效应值（例如，每个等位基因的对数优势比或标准化回归系数），$G_{j}\\in\\{0,1,2\\}$ 是个体风险增加等位基因的基因型剂量。在广泛使用的聚类和阈值法（通常称为 $P+T$）中，SNP 的选择过程如下：(i) 对 GWAS 摘要统计数据应用一个 p 值阈值，然后 (ii) 通过修剪来解决局部连锁不平衡 (LD)，以使保留的 SNPs 之间的两两 LD 低于指定的阈值，该阈值通常用两个基因座上等位基因之间的平方相关系数 $r^{2}$ 来衡量。\n\n考虑一个由 10 个 SNPs 组成的示例基因座集，标记为 $s_{1},\\dots,s_{10}$。给定以下单个个体的 GWAS p 值、等位基因效应值 $\\hat{\\beta}_{j}$ 和基因型剂量 $G_{j}$：\n- p 值：$p_{1}=1.0\\times 10^{-8}$，$p_{2}=2.0\\times 10^{-7}$，$p_{3}=1.0\\times 10^{-5}$，$p_{4}=4.0\\times 10^{-6}$，$p_{5}=3.0\\times 10^{-5}$，$p_{6}=4.0\\times 10^{-7}$，$p_{7}=2.0\\times 10^{-6}$，$p_{8}=7.0\\times 10^{-6}$，$p_{9}=4.0\\times 10^{-9}$，$p_{10}=1.0\\times 10^{-4}$。\n- 效应值：$\\hat{\\beta}_{1}=0.12$，$\\hat{\\beta}_{2}=0.08$，$\\hat{\\beta}_{3}=-0.05$，$\\hat{\\beta}_{4}=0.04$，$\\hat{\\beta}_{5}=0.02$，$\\hat{\\beta}_{6}=0.09$，$\\hat{\\beta}_{7}=0.06$，$\\hat{\\beta}_{8}=-0.03$，$\\hat{\\beta}_{9}=0.11$，$\\hat{\\beta}_{10}=-0.01$。\n- 个体基因型（剂量）：$G_{1}=2$，$G_{2}=1$，$G_{3}=0$，$G_{4}=2$，$G_{5}=1$，$G_{6}=0$，$G_{7}=2$，$G_{8}=1$，$G_{9}=1$，$G_{10}=2$。\n\n无序 SNP 对之间的两两 LD 由 $r^{2}$ 总结。以下 SNP 对具有非默认的 LD 值：\n- 区域 1 LD：$r^{2}(s_{1},s_{2})=0.35$，$r^{2}(s_{1},s_{4})=0.12$，$r^{2}(s_{2},s_{4})=0.08$。\n- 区域 2 LD：$r^{2}(s_{6},s_{7})=0.15$，$r^{2}(s_{6},s_{8})=0.11$，$r^{2}(s_{7},s_{8})=0.09$。\n- 区域 3 LD：$r^{2}(s_{3},s_{5})=0.20$，$r^{2}(s_{3},s_{10})=0.05$，$r^{2}(s_{5},s_{10})=0.14$。\n对于上面未列出的所有其他无序对 $(s_{i},s_{j})$，取 $r^{2}(s_{i},s_{j})=0.04$。\n\n使用 $P+T$ 程序，GWAS p 值阈值为 $p  5\\times 10^{-6}$，LD 修剪保留与已选 SNPs 的两两 $r^{2}$ 严格小于 $0.1$ 的 SNPs，通过以下明确的聚类规则构建所选 SNP 集合：在通过 p 值阈值的 SNPs 中，按 p 值升序排列；遍历此有序列表，当选择一个 SNP 时，排除任何与所选 SNP 的 $r^{2}$ 大于或等于 $0.1$ 的剩余 SNP。继续此过程，直到有序列表被遍历完毕。然后为给定个体计算得到的原始 PRS $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$。将最终的 PRS 表示为一个无单位的数字，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取给定信息\n- **PRS 公式**：原始多基因风险评分 (PRS) 为 $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$，其中 $\\mathcal{J}$ 是选定的单核苷酸多态性 (SNPs) 集合，$\\hat{\\beta}_{j}$ 是效应值，$G_{j}$ 是基因型剂量。\n- **SNPs**：一个由 10 个 SNPs 组成的集合，索引为 $j=1, \\dots, 10$。\n- **GWAS p 值**：$p_{1}=1.0\\times 10^{-8}$，$p_{2}=2.0\\times 10^{-7}$，$p_{3}=1.0\\times 10^{-5}$，$p_{4}=4.0\\times 10^{-6}$，$p_{5}=3.0\\times 10^{-5}$，$p_{6}=4.0\\times 10^{-7}$，$p_{7}=2.0\\times 10^{-6}$，$p_{8}=7.0\\times 10^{-6}$，$p_{9}=4.0\\times 10^{-9}$，$p_{10}=1.0\\times 10^{-4}$。\n- **效应值 ($\\hat{\\beta}_{j}$)**：$\\hat{\\beta}_{1}=0.12$，$\\hat{\\beta}_{2}=0.08$，$\\hat{\\beta}_{3}=-0.05$，$\\hat{\\beta}_{4}=0.04$，$\\hat{\\beta}_{5}=0.02$，$\\hat{\\beta}_{6}=0.09$，$\\hat{\\beta}_{7}=0.06$，$\\hat{\\beta}_{8}=-0.03$，$\\hat{\\beta}_{9}=0.11$，$\\hat{\\beta}_{10}=-0.01$。\n- **个体基因型 ($G_{j}$)**：$G_{1}=2$，$G_{2}=1$，$G_{3}=0$，$G_{4}=2$，$G_{5}=1$，$G_{6}=0$，$G_{7}=2$，$G_{8}=1$，$G_{9}=1$，$G_{10}=2$。\n- **连锁不平衡 ($r^{2}$)**：\n  - $r^{2}(s_{1},s_{2})=0.35$\n  - $r^{2}(s_{1},s_{4})=0.12$\n  - $r^{2}(s_{2},s_{4})=0.08$\n  - $r^{2}(s_{6},s_{7})=0.15$\n  - $r^{2}(s_{6},s_{8})=0.11$\n  - $r^{2}(s_{7},s_{8})=0.09$\n  - $r^{2}(s_{3},s_{5})=0.20$\n  - $r^{2}(s_{3},s_{10})=0.05$\n  - $r^{2}(s_{5},s_{10})=0.14$\n  - 所有其他的两两 $r^{2}$ 值为 $0.04$。\n- **$P+T$ 程序参数**：\n  - p 值阈值：$p  5\\times 10^{-6}$。\n  - LD 修剪阈值：$r^{2}  0.1$。\n- **聚类规则**：按 p 值阈值筛选 SNPs，将它们按 p 值升序排列，然后遍历：选择一个索引 SNP，并修剪掉任何与该索引 SNP 的 $r^{2} \\ge 0.1$ 的剩余 SNPs。\n- **任务**：计算原始 PRS，$S$，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，描述了用于构建 PRS 的标准聚类和阈值法 ($P+T$)，这是统计遗传学中的一项基石技术。所有的定义和参数——p 值、效应值、基因型剂量 ($G_j \\in \\{0, 1, 2\\}$) 和连锁不平衡 ($r^2$)——都是标准的，并且具有合理的值。该问题提法恰当且自洽；所有必要的数据和一个用于 SNP 选择的确定性、无歧义的算法都已提供，确保了唯一解。语言客观而精确。该问题没有违反任何有效性标准。\n\n### 步骤 3：结论与行动\n该问题是有效的，可以按陈述求解。\n\n### 解答\n多基因风险评分 (PRS) 的计算分两个主要阶段进行：首先，使用指定的聚类和阈值法 ($P+T$) 程序选择相关 SNPs 的集合 $\\mathcal{J}$；其次，计算加权和 $S = \\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$。\n\n**阶段 1：使用 $P+T$ 程序进行 SNP 选择**\n\n该程序包括一个 p 值阈值筛选步骤，随后是一个连锁不平衡 (LD) 修剪（或聚类）步骤。\n\n**步骤 (i)：p 值阈值筛选**\n我们首先识别所有 GWAS p 值严格小于阈值 $5\\times 10^{-6}$ 的 SNPs。我们检查每个 SNP：\n- $s_{1}: p_{1}=1.0\\times 10^{-8}  5\\times 10^{-6}$ (通过)\n- $s_{2}: p_{2}=2.0\\times 10^{-7}  5\\times 10^{-6}$ (通过)\n- $s_{3}: p_{3}=1.0\\times 10^{-5} \\ge 5\\times 10^{-6}$ (未通过)\n- $s_{4}: p_{4}=4.0\\times 10^{-6}  5\\times 10^{-6}$ (通过)\n- $s_{5}: p_{5}=3.0\\times 10^{-5} \\ge 5\\times 10^{-6}$ (未通过)\n- $s_{6}: p_{6}=4.0\\times 10^{-7}  5\\times 10^{-6}$ (通过)\n- $s_{7}: p_{7}=2.0\\times 10^{-6}  5\\times 10^{-6}$ (通过)\n- $s_{8}: p_{8}=7.0\\times 10^{-6} \\ge 5\\times 10^{-6}$ (未通过)\n- $s_{9}: p_{9}=4.0\\times 10^{-9}  5\\times 10^{-6}$ (通过)\n- $s_{10}: p_{10}=1.0\\times 10^{-4} \\ge 5\\times 10^{-6}$ (未通过)\n\n通过此筛选的 SNPs 集合，我们称之为候选集 $\\mathcal{C}$，是 $\\mathcal{C} = \\{s_{1}, s_{2}, s_{4}, s_{6}, s_{7}, s_{9}\\}$。\n\n**步骤 (ii)：LD 聚类**\n聚类算法要求将 $\\mathcal{C}$ 中的 SNPs 按其 p 值升序排列。\n候选 SNPs 的 p 值为：\n- $p_{9} = 4.0\\times 10^{-9}$\n- $p_{1} = 1.0\\times 10^{-8}$\n- $p_{2} = 2.0\\times 10^{-7}$\n- $p_{6} = 4.0\\times 10^{-7}$\n- $p_{7} = 2.0\\times 10^{-6}$\n- $p_{4} = 4.0\\times 10^{-6}$\n\n要遍历的有序候选列表是 $(s_{9}, s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$。设 $\\mathcal{J}$ 为最终选定的 SNPs 集合，初始化为空。修剪规则是，如果任何剩余的候选 SNP $s_k$ 与当前索引 SNP $s_i$ 的 LD 满足 $r^{2}(s_i, s_k) \\ge 0.1$，则丢弃该 SNP $s_k$。\n\n**迭代 1：**\n- 索引 SNP: $s_{9}$ (最显著的 SNP)。它被添加到选择集中：$\\mathcal{J}=\\{s_{9}\\}$。\n- 我们检查剩余的候选者 $(s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$ 与 $s_{9}$ 的 LD。除非特别说明，LD 为 $r^2=0.04$。\n  - $r^{2}(s_{9}, s_{1}) = 0.04  0.1$。保留 $s_{1}$。\n  - $r^{2}(s_{9}, s_{2}) = 0.04  0.1$。保留 $s_{2}$。\n  - $r^{2}(s_{9}, s_{6}) = 0.04  0.1$。保留 $s_{6}$。\n  - $r^{2}(s_{9}, s_{7}) = 0.04  0.1$。保留 $s_{7}$。\n  - $r^{2}(s_{9}, s_{4}) = 0.04  0.1$。保留 $s_{4}$。\n- 剩余候选列表不变：$(s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$。\n\n**迭代 2：**\n- 索引 SNP: $s_{1}$ (有序列表中的下一个 SNP)。它被添加到选择集中：$\\mathcal{J}=\\{s_{9}, s_{1}\\}$。\n- 我们检查剩余的候选者 $(s_{2}, s_{6}, s_{7}, s_{4})$ 与 $s_{1}$ 的 LD。\n  - $r^{2}(s_{1}, s_{2}) = 0.35 \\ge 0.1$。从列表中修剪掉 $s_{2}$。\n  - $r^{2}(s_{1}, s_{6}) = 0.04  0.1$。保留 $s_{6}$。\n  - $r^{2}(s_{1}, s_{7}) = 0.04  0.1$。保留 $s_{7}$。\n  - $r^{2}(s_{1}, s_{4}) = 0.12 \\ge 0.1$。从列表中修剪掉 $s_{4}$。\n- 现在的剩余候选列表是 $(s_{6}, s_{7})$。\n\n**迭代 3：**\n- 索引 SNP: $s_{6}$。它被添加到选择集中：$\\mathcal{J}=\\{s_{9}, s_{1}, s_{6}\\}$。\n- 我们检查唯一剩余的候选者 $(s_{7})$ 与 $s_{6}$ 的 LD。\n  - $r^{2}(s_{6}, s_{7}) = 0.15 \\ge 0.1$。从列表中修剪掉 $s_{7}$。\n- 现在的剩余候选列表为空。\n\n随着候选列表被遍历完毕，算法终止。最终选择的 SNPs 集合是 $\\mathcal{J} = \\{s_{1}, s_{6}, s_{9}\\}$。\n\n**阶段 2：PRS 计算**\n\n原始 PRS, $S$, 是使用公式 $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$ 为选定的 SNPs $\\mathcal{J}=\\{1, 6, 9\\}$ 计算的。\n$$S = \\hat{\\beta}_{1}G_{1} + \\hat{\\beta}_{6}G_{6} + \\hat{\\beta}_{9}G_{9}$$\n我们代入这三个 SNPs 的给定效应值 ($\\hat{\\beta}_{j}$) 和基因型剂量 ($G_{j}$)：\n- 对于 $j=1$：$\\hat{\\beta}_{1}=0.12$，$G_{1}=2$\n- 对于 $j=6$：$\\hat{\\beta}_{6}=0.09$，$G_{6}=0$\n- 对于 $j=9$：$\\hat{\\beta}_{9}=0.11$，$G_{9}=1$\n\n计算过程如下：\n$$S = (0.12 \\times 2) + (0.09 \\times 0) + (0.11 \\times 1)$$\n$$S = 0.24 + 0 + 0.11$$\n$$S = 0.35$$\n问题要求将答案四舍五入到四位有效数字。计算出的值 $0.35$ 有两位有效数字。为了用四位有效数字表示，我们添加尾随零。\n$$S = 0.3500$$",
            "answer": "$$\\boxed{0.3500}$$"
        },
        {
            "introduction": "一旦选定了用于评分的变异及其权重，下一步就是为特定个体计算其多基因风险评分。本练习演示了原始PRS的基本计算，即作为等位基因计数的加权总和。此外，它还引入了将分数与参考人群进行比较以进行标准化的关键步骤，这是在特定背景下解释个体遗传风险所必需的。",
            "id": "4326881",
            "problem": "在一家精准医疗诊所中，使用线性多基因评分来总结加性遗传模型下复杂性状的常见变异易感性。某一个体在 $5$ 个独立的单核苷酸多态性 (SNP) 上的风险等位基因剂量为 $x=(2,1,0,2,1)$，来自外部全基因组关联研究 (GWAS) 的相应每等位基因效应量估计值为 $\\hat{\\beta}=(0.08,-0.05,0.12,0.02,0.09)$。假设采用常规的加性模型，其中每个位点独立地、加性地贡献于易感性尺度上的对数风险，风险等位基因剂量是每个位点的准确计数，并且这 $5$ 个位点在发现研究中已经过连锁不平衡剪枝，因此权重可以线性组合而不会重复计算相关信号。使用线性多基因评分的常规定义，即通过加权和汇总特定位点的贡献，根据这些输入构建该个体的未标准化评分 $S$。然后，使用均值为 $\\mu=0.15$、标准差为 $\\sigma=0.10$ 的参考人群评分分布，计算该个体相对于该参考的标准化值 $z$。将报告的两个值都四舍五入到四位有效数字。以包含 $S$ 和 $z$ 的行向量形式报告您的最终答案，顺序如此。不需要单位。",
            "solution": "用户要求根据提供的遗传数据计算未标准化和标准化的多基因评分。\n\n### 步骤 1：问题验证\n\n首先，根据所需标准验证问题陈述。\n\n**提取的已知条件：**\n-   **模型：** 基于加性遗传模型的线性多基因评分。\n-   **风险等位基因剂量向量：** $x = (2, 1, 0, 2, 1)$，对应 $5$ 个独立的单核苷酸多态性 (SNP)。\n-   **每等位基因效应量估计值向量：** $\\hat{\\beta} = (0.08, -0.05, 0.12, 0.02, 0.09)$。\n-   **未标准化评分 ($S$) 的定义：** 特定位点贡献的加权和，这可转化为剂量向量和效应量向量的点积。\n-   **参考人群参数：** 均值 $\\mu = 0.15$，标准差 $\\sigma = 0.10$。\n-   **任务：**\n    1.  计算未标准化评分 $S$。\n    2.  计算标准化评分 $z$。\n    3.  将两个值都四舍五入到四位有效数字。\n    4.  以行向量 $[S, z]$ 的形式报告结果。\n\n**验证结论：**\n该问题被判定为**有效**。\n-   **科学依据：** 所描述的计算多基因评分的方法是统计遗传学和精准医疗领域的标准实践。加性模型、使用全基因组关联研究 (GWAS) 的效应量以及标准化都是公认的概念。\n-   **定义明确：** 所有必要的数据和定义都已提供，可得出唯一解。向量 $x$ 和 $\\hat{\\beta}$ 的维度一致。\n-   **客观性：** 问题以精确的定量语言陈述，没有歧义或主观论断。\n-   该问题不违反任何其他无效标准（例如，它不是不完整的、矛盾的、不切实际的或微不足道的）。\n\n可以继续进行求解过程。\n\n### 步骤 2：计算未标准化多基因评分 ($S$)\n\n问题将未标准化多基因评分 $S$ 定义为风险等位基因剂量的加权和，其中权重是相应的每等位基因效应量。这可以表示为剂量向量 $x$ 和效应量向量 $\\hat{\\beta}$ 的点积。对于 $n$ 个 SNP，公式为：\n$$S = \\sum_{i=1}^{n} x_i \\hat{\\beta}_i = x \\cdot \\hat{\\beta}$$\n在本例中，我们有 $n=5$ 个 SNP。给定的向量是：\n$$x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\\\ x_5 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}$$\n$$\\hat{\\beta} = \\begin{pmatrix} \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\\\ \\hat{\\beta}_3 \\\\ \\hat{\\beta}_4 \\\\ \\hat{\\beta}_5 \\end{pmatrix} = \\begin{pmatrix} 0.08 \\\\ -0.05 \\\\ 0.12 \\\\ 0.02 \\\\ 0.09 \\end{pmatrix}$$\n计算如下：\n$$S = (x_1 \\times \\hat{\\beta}_1) + (x_2 \\times \\hat{\\beta}_2) + (x_3 \\times \\hat{\\beta}_3) + (x_4 \\times \\hat{\\beta}_4) + (x_5 \\times \\hat{\\beta}_5)$$\n$$S = (2 \\times 0.08) + (1 \\times -0.05) + (0 \\times 0.12) + (2 \\times 0.02) + (1 \\times 0.09)$$\n$$S = 0.16 - 0.05 + 0 + 0.04 + 0.09$$\n$$S = 0.11 + 0.04 + 0.09$$\n$$S = 0.24$$\n问题要求将此值四舍五入到四位有效数字。值 $0.24$ 有两位有效数字。为了用四位有效数字表示，我们添加尾随零：\n$$S = 0.2400$$\n\n### 步骤 3：计算标准化多基因评分 ($z$)\n\n标准化评分，即 $z$-分数，衡量个体评分与参考人群均值相差多少个标准差。公式为：\n$$z = \\frac{S - \\mu}{\\sigma}$$\n使用计算出的未标准化评分 $S = 0.24$ 和给定的参考人群参数 $\\mu = 0.15$ 和 $\\sigma = 0.10$：\n$$z = \\frac{0.24 - 0.15}{0.10}$$\n$$z = \\frac{0.09}{0.10}$$\n$$z = 0.9$$\n问题要求也将此值四舍五入到四位有效数字。值 $0.9$ 有一位有效数字。为了用四位有效数字表示，我们添加尾随零：\n$$z = 0.9000$$\n\n### 步骤 4：最终答案的构建\n\n最终答案要求以行向量的形式报告，其中包含按顺序排列的 $S$ 和 $z$ 的舍入值。\n所需的向量是 $(S, z)$，即 $(0.2400, 0.9000)$。这在 LaTeX 中使用 `pmatrix` 环境表示。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2400  0.9000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "多基因风险评分（PRS）面临的一个主要挑战是其在不同人群间的可移植性有限，这通常会导致校准不佳。本练习直面这一问题，探讨了一个将PRS模型应用于具有不同疾病患病率人群的假设场景。通过从基本原理推导必要的校准参数，本实践阐明了如何修正模型的“宏观校准”（calibration-in-the-large），以确保模型在新的临床环境中能提供准确的绝对风险估计。",
            "id": "4326811",
            "problem": "一个在欧洲血统（EUR）人群中训练和校准的多基因风险评分（PRS）模型，通过一个 logistic 链接函数来预测一种复杂疾病的绝对概率。设个体的评分为 $S$，并假设在 EUR 人群中训练的模型产生一个线性预测因子 $L = b_{0} + b_{1} S$ 和估计风险 $\\operatorname{logit}^{-1}(L)$，其中 $\\operatorname{logit}(p) = \\ln\\!\\left(\\frac{p}{1-p}\\right)$ 且 $\\operatorname{logit}^{-1}(x) = \\frac{1}{1+\\exp(-x)}$。假设在 EUR 人群中，该模型得到了良好校准（即，平均预测风险等于观察到的患病率），疾病患病率为 $p_{\\mathrm{EUR}} = 0.1$。该模型被移植到一个目标人群中，该人群的疾病患病率恰好是前者的两倍，即 $p_{\\mathrm{target}} = 0.2$。假设 PRS 在对数优势比尺度上的每标准差效应量以及 $S$ 的分布在不同人群间是可移植的（即，以 $S$ 为条件的病例-对照对数似然比是不变的），因此任何校准失准都完全源于基线疾病患病率的变化。\n\n将应用于目标人群的标准 logistic 校准模型定义为\n$$\n\\operatorname{logit}\\!\\big(P(Y=1 \\mid L)\\big) = a + c\\,L,\n$$\n其中 $a$ 是校准截距（calibration-in-the-large），$c$ 是校准斜率。从优势比和 logit 链接函数的定义出发，并且不调用任何预先陈述的移植方程，推导由纯粹的患病率变化所隐含的 $a$ 和 $c$ 的值，然后通过修改原始模型，提出一种有原则的重新校准方法，以在目标人群中恢复校准后的绝对风险。\n\n报告在此情景下校准截距 $a$ 的数值，四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "我们从 logistic 回归、优势比和用于更新优势比的 Bayes 定理的基本原理开始。logistic 模型意味着，对于评分为 $S$ 的个体，在 EUR 人群中患病的对数优势比为\n$$\n\\operatorname{logit}\\!\\big(P_{\\mathrm{EUR}}(Y=1 \\mid S)\\big) = b_{0} + b_{1} S = L.\n$$\n等价地，在 EUR 人群中的优势比是\n$$\n\\frac{P_{\\mathrm{EUR}}(Y=1 \\mid S)}{1 - P_{\\mathrm{EUR}}(Y=1 \\mid S)} = \\exp(L).\n$$\n截距 $b_{0}$ 编码了疾病的基线（先验）优势比，而 $b_{1} S$ 代表在以 $S$ 为条件的病例-对照对数似然比在人群间不变的假设下，由 PRS 贡献的对数似然比。设 EUR 人群的边际患病率为 $p_{\\mathrm{EUR}}$，目标人群的边际患病率为 $p_{\\mathrm{target}}$。它们对应的先验优势比为\n$$\nO_{\\mathrm{EUR}} = \\frac{p_{\\mathrm{EUR}}}{1 - p_{\\mathrm{EUR}}}, \\qquad O_{\\mathrm{target}} = \\frac{p_{\\mathrm{target}}}{1 - p_{\\mathrm{target}}}.\n$$\n\n在只有先验概率在人群间发生变化（即以 $S$ 为条件的似然函数的可移植性）的假设下，Bayes 定理意味着后验优势比是先验优势比乘以似然比。因为 $b_{1} S$ 代表对数似然比部分，仅将先验优势比从 $O_{\\mathrm{EUR}}$ 改变为 $O_{\\mathrm{target}}$，会对每个 $S$ 值将 EUR 后验优势比乘以一个常数因子 $\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}$。因此，给定 $S$ 时，目标人群的后验优势比满足\n$$\n\\frac{P_{\\mathrm{target}}(Y=1 \\mid S)}{1 - P_{\\mathrm{target}}(Y=1 \\mid S)} \\;=\\; \\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}} \\times \\frac{P_{\\mathrm{EUR}}(Y=1 \\mid S)}{1 - P_{\\mathrm{EUR}}(Y=1 \\mid S)} \\;=\\; \\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}} \\times \\exp(L).\n$$\n取自然对数，\n$$\n\\operatorname{logit}\\!\\big(P_{\\mathrm{target}}(Y=1 \\mid S)\\big) \\;=\\; \\ln\\!\\left(\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}\\right) + L.\n$$\n与校准模型 $\\operatorname{logit}(P(Y=1 \\mid L)) = a + c\\,L$ 比较，我们看到患病率的变化在 logit 上引起了一个纯粹的加性偏移，偏移量为常数\n$$\na \\;=\\; \\ln\\!\\left(\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}\\right) \\;=\\; \\big[\\ln(O_{\\mathrm{target}}) - \\ln(O_{\\mathrm{EUR}})\\big] \\;=\\; \\operatorname{logit}(p_{\\mathrm{target}}) - \\operatorname{logit}(p_{\\mathrm{EUR}}),\n$$\n斜率为\n$$\nc \\;=\\; 1,\n$$\n因为似然比项 $b_{1} S$ 保持不变。因此，在纯粹的患病率变化下，校准斜率为 $1$，校准截距等于目标患病率和源患病率的 logit 值之差。\n\n一种有原则的重新校准方法直接得出：只修改原始模型的截距。如果原始 EUR 模型是 $\\operatorname{logit}(P_{\\mathrm{EUR}}(Y=1 \\mid S)) = b_{0} + b_{1} S$，则将重新校准的目标模型定义为\n$$\n\\operatorname{logit}(P_{\\mathrm{target}}(Y=1 \\mid S)) \\;=\\; \\big(b_{0} + a\\big) + b_{1} S,\n$$\n其中\n$$\na \\;=\\; \\operatorname{logit}(p_{\\mathrm{target}}) - \\operatorname{logit}(p_{\\mathrm{EUR}}) \\;=\\; \\ln\\!\\left(\\frac{p_{\\mathrm{target}}}{1 - p_{\\mathrm{target}}}\\right) - \\ln\\!\\left(\\frac{p_{\\mathrm{EUR}}}{1 - p_{\\mathrm{EUR}}}\\right).\n$$\n等价地，为了从带有线性预测因子 $L$ 的 EUR 预测中获得目标人群中校准后的绝对风险，计算 $\\operatorname{logit}^{-1}(L + a)$。\n\n我们现在计算当 $p_{\\mathrm{EUR}} = 0.1$ 和 $p_{\\mathrm{target}} = 0.2$ 时 $a$ 的数值：\n$$\nO_{\\mathrm{EUR}} \\;=\\; \\frac{0.1}{1 - 0.1} \\;=\\; \\frac{0.1}{0.9} \\;=\\; \\frac{1}{9},\n$$\n$$\nO_{\\mathrm{target}} \\;=\\; \\frac{0.2}{1 - 0.2} \\;=\\; \\frac{0.2}{0.8} \\;=\\; \\frac{1}{4}.\n$$\n因此，\n$$\na \\;=\\; \\ln\\!\\left(\\frac{O_{\\mathrm{target}}}{O_{\\mathrm{EUR}}}\\right) \\;=\\; \\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{9}}\\right) \\;=\\; \\ln\\!\\left(\\frac{9}{4}\\right) \\;=\\; \\ln(9) - \\ln(4).\n$$\n使用 $\\ln(9) \\approx 2.197224577$ 和 $\\ln(4) \\approx 1.386294361$，\n$$\na \\;\\approx\\; 2.197224577 - 1.386294361 \\;=\\; 0.810930216.\n$$\n四舍五入到四位有效数字，$a \\approx 0.8109$。\n\n总结：在患病率增加两倍且效应量可移植的情况下，校准斜率为 $1$，校准截距为 $a = \\operatorname{logit}(0.2) - \\operatorname{logit}(0.1) = \\ln(9/4)$，通过将 $a$ 加到原始截距上（或等价地，在应用逆 logit 函数之前将 $a$ 加到线性预测因子 $L$ 上）来实现重新校准。",
            "answer": "$$\\boxed{0.8109}$$"
        }
    ]
}