{
    "hands_on_practices": [
        {
            "introduction": "在整合不同来源的数据之前，第一步通常是独立地对每种模态进行预处理。对于 scRNA-seq 数据，原始的 UMI 计数会受到测序深度（文库大小）差异的显著影响，高表达基因的巨大数值范围也会扭曲下游分析。这项练习  将指导您完成一个标准的标准化流程——将原始计数转换为相对丰度，然后进行对数转换。这是几乎所有单细胞分析流程中不可或缺的一步，旨在稳定方差并使细胞间的表达水平具有可比性。",
            "id": "4607704",
            "problem": "一项临床研究旨在整合单细胞RNA测序（scRNA-seq）和使用测序的单细胞转座酶可及性染色质分析（scATAC-seq）图谱，以发现在异质性肿瘤微环境中与治疗反应相关的基因调控程序。为了构建一个联合潜空间，必须首先将scRNA-seq模态转换为一个稳定的、相对丰度的尺度，该尺度在不同测序深度的细胞之间具有可比性。在scRNA-seq中，细胞 $i$ 中基因 $g$ 的唯一分子标识符（UMI）计数 $c_{ig}$ 与捕获的转录本分子数量成正比，而总和 $\\sum_{g} c_{ig}$ 反映了细胞 $i$ 的文库大小。\n\n从以下基于单细胞转录本定量标准实践的、经过充分测试的处理步骤开始：\n- 通过将一个基因的原始计数除以细胞的总UMI计数来获得相对丰度，得到分数 $c_{ig} / \\sum_{g} c_{ig}$。\n- 为了使尺度具有可解释性，并减轻单细胞数据中典型的极端稀疏性，同时保持细胞间的可比性，将此分数乘以 $10^{4}$，将其重新缩放到“每 $10^{4}$ 个计数”的单位。\n- 为了稳定方差并减弱高表达基因的影响，对重新缩放后的量应用以 $2$ 为底的对数，在取对数前加上一个为 $1$ 的伪计数，以避免对零取对数。\n\n使用这些定义，推导对数归一化表达 $\\tilde{x}_{ig}$ 的符号表达式，然后计算一个特定基因的原始UMI计数为 $c_{ig} = 50$、细胞总UMI计数为 $\\sum_{g} c_{ig} = 5000$ 的情况下的数值。将你的最终答案表示为一个无量纲值，并四舍五入到四位有效数字。",
            "solution": "问题陈述是生物信息学和计算生物学领域内一个有效且表述良好的请求。它描述了单细胞RNA测序（scRNA-seq）数据归一化的标准流程，这是多组学整合等下游分析的关键预处理步骤。所有提供的信息在科学上都是合理的、自洽的，并且足以推导出唯一解。\n\n任务是首先推导出细胞 $i$ 中基因 $g$ 的对数归一化表达（表示为 $\\tilde{x}_{ig}$）的符号表达式，然后在给定特定UMI计数的情况下计算其数值。我们将遵循规定的操作顺序。\n\n设 $c_{ig}$ 为细胞 $i$ 中基因 $g$ 的原始唯一分子标识符（UMI）计数。\n设 $C_i = \\sum_{g} c_{ig}$ 为细胞 $i$ 的总UMI计数，也称为细胞的文库大小。\n\n归一化过程包括三个定义的步骤：\n\n步骤 1：计算基因转录本在细胞中的相对丰度。这通过将基因的原始计数除以细胞的总UMI计数来实现。\n$$ \\text{相对丰度} = \\frac{c_{ig}}{C_i} = \\frac{c_{ig}}{\\sum_{g} c_{ig}} $$\n\n步骤 2：将相对丰度重新缩放到一个通用尺度，通常是“每10,000个计数”（CP10k）或“每10,000个转录本”（TP10k），以便于在具有不同文库大小的细胞之间进行比较。这通过将相对丰度乘以一个比例因子 $10^4$ 来完成。\n$$ \\text{重新缩放值} = \\left( \\frac{c_{ig}}{\\sum_{g} c_{ig}} \\right) \\times 10^4 $$\n\n步骤 3：对重新缩放后的值进行对数转换。这种转换有助于稳定不同表达水平基因的方差，并减少数据分布的偏度。在取对数之前加上一个为 $1$ 的伪计数，以确保对数的参数始终为正，从而避免处理计数为零的基因时出现问题。对数的底数指定为 $2$。\n因此，对数归一化表达 $\\tilde{x}_{ig}$ 为：\n$$ \\tilde{x}_{ig} = \\log_{2}\\left( \\left( \\frac{c_{ig}}{\\sum_{g} c_{ig}} \\right) \\times 10^4 + 1 \\right) $$\n这就是所要求的符号表达式。\n\n现在，我们将根据给定数据计算 $\\tilde{x}_{ig}$ 的值：\n- 目标基因的原始UMI计数：$c_{ig} = 50$\n- 细胞的总UMI计数：$\\sum_{g} c_{ig} = 5000$\n\n将这些值代入符号表达式：\n$$ \\tilde{x}_{ig} = \\log_{2}\\left( \\left( \\frac{50}{5000} \\right) \\times 10^4 + 1 \\right) $$\n\n首先，我们计算分数：\n$$ \\frac{50}{5000} = \\frac{5}{500} = \\frac{1}{100} = 0.01 $$\n\n接下来，我们进行重新缩放：\n$$ 0.01 \\times 10^4 = 0.01 \\times 10000 = 100 $$\n\n然后，我们加上伪计数 $1$：\n$$ 100 + 1 = 101 $$\n\n最后，我们取以 $2$ 为底的对数：\n$$ \\tilde{x}_{ig} = \\log_{2}(101) $$\n\n为了计算数值，我们可以使用对数的换底公式 $\\log_{b}(a) = \\frac{\\ln(a)}{\\ln(b)}$：\n$$ \\tilde{x}_{ig} = \\frac{\\ln(101)}{\\ln(2)} $$\n\n使用自然对数的标准值：\n$$ \\ln(101) \\approx 4.6151205168 $$\n$$ \\ln(2) \\approx 0.6931471806 $$\n\n$$ \\tilde{x}_{ig} \\approx \\frac{4.6151205168}{0.6931471806} \\approx 6.6582115934 $$\n\n题目要求答案四舍五入到四位有效数字。前四位有效数字是 $6$、$6$、$5$ 和 $8$。第五位有效数字是 $2$，小于 $5$，因此我们向下舍入（即，不改变最后一位数字）。\n\n因此，对数归一化表达值约为 $6.658$。这个值是无量纲的，因为初始分数中分子和分母的计数单位相互抵消了。",
            "answer": "$$\n\\boxed{6.658}\n$$"
        },
        {
            "introduction": "与 scRNA-seq 类似，scATAC-seq 数据也具有高稀疏性和技术噪音，需要进行有效的特征加权才能揭示其生物学意义。直接使用染色质开放区域的原始片段计数是次优的，因为它忽略了一个区域在细胞群体中的特异性。这项练习  引入了改编自信息检索领域的词频-逆文档频率 (TF-IDF) 变换。通过同时考虑一个“峰”在一个细胞内的相对可及性（词频）及其在所有细胞中的罕见程度（逆文档频率），该方法能有效突显出具有细胞特异性的关键调控元件。",
            "id": "4381593",
            "problem": "在单细胞转座酶可及性染色质测序 (scATAC-seq) 中，为了实现精准医疗和基因组诊断，与单细胞核糖核酸测序 (scRNA-seq) 的整合通常需要构建一种染色质可及性的特征表示，该表示对细胞间测序深度的变异和峰在群体中的普遍性具有稳健性。一种广泛使用的方法是改编最初源于信息检索领域的词频-逆文档频率 (TF-IDF)，来对每个细胞中的每个峰进行加权。\n\n考虑一个含有 $N$ 个细胞的数据集，其中一个峰 $j$ 在 $n_{j}$ 个细胞中被观察到（片段数非零）。对于一个给定的细胞 $i$，设 $x_{ij}$ 表示峰 $j$ 的片段计数，并设 $\\sum_{k} x_{ik}$ 表示细胞 $i$ 特征空间中所有峰的总片段计数。使用以下基本定义：\n- 词频 (Term frequency) 是细胞内的相对丰度，定义为在细胞 $i$ 中分配给峰 $j$ 的片段所占的比例。\n- 逆文档频率 (Inverse document frequency) 是全局稀有度权重，定义为总细胞数与观察到峰 $j$ 的细胞数之比的自然对数。\n\n从这些定义出发，构建细胞 $i$ 中峰 $j$ 的组合 TF-IDF 权重，并将其应用于多组学整合流程中使用的以下科学真实场景：\n- 细胞总数 $N = 1200$。\n- 对于特定峰 $j^{\\ast}$，具有 $x_{ij^{\\ast}} > 0$ 的细胞数为 $n_{j^{\\ast}} = 96$。\n- 对于特定细胞 $i^{\\ast}$，该峰的计数为 $x_{i^{\\ast} j^{\\ast}} = 9$，所有峰的总片段数为 $\\sum_{k} x_{i^{\\ast} k} = 1875$。\n\n使用自然对数计算 $\\left(i^{\\ast}, j^{\\ast}\\right)$ 的 TF-IDF 权重。将最终数值答案四舍五入到四位有效数字。最终答案中不要包含任何单位。",
            "solution": "题目要求计算来自单细胞转座酶可及性染色质测序 (scATAC-seq) 数据集中，特定细胞中特定峰的词频-逆文档频率 (TF-IDF) 权重。我将首先验证问题陈述，如果有效，则继续进行解答。\n\n### 第1步：提取已知信息\n问题陈述中提供的数据和定义如下：\n-   细胞总数: $N$\n-   观察到峰 $j$ 的细胞数: $n_j$\n-   细胞 $i$ 中峰 $j$ 的片段计数: $x_{ij}$\n-   细胞 $i$ 中所有峰的总片段计数: $\\sum_{k} x_{ik}$\n-   细胞 $i$ 中峰 $j$ 的词频 (TF) 定义：“在细胞 $i$ 中分配给峰 $j$ 的片段所占的比例。”\n-   峰 $j$ 的逆文档频率 (IDF) 定义：“总细胞数与观察到峰 $j$ 的细胞数之比的自然对数。”\n-   特定场景值：\n    -   细胞总数：$N = 1200$\n    -   对于特定峰 $j^{\\ast}$，片段数非零的细胞数为 $n_{j^{\\ast}} = 96$。\n    -   对于特定细胞 $i^{\\ast}$，峰 $j^{\\ast}$ 的片段计数为 $x_{i^{\\ast} j^{\\ast}} = 9$。\n    -   对于同一细胞 $i^{\\ast}$，总片段计数为 $\\sum_{k} x_{i^{\\ast} k} = 1875$。\n-   任务是计算配对 $(i^{\\ast}, j^{\\ast})$ 的 TF-IDF 权重，并将数值结果四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n\n-   **科学依据**：该问题描述了 TF-IDF 变换，这是一种在计算生物学中用于对像 scATAC-seq 这样的高维单细胞数据中的特征进行归一化和加权的成熟方法。将其应用于整合 scATAC-seq 和 scRNA-seq 以实现精准医疗是一个当前且相关的主题。定义和数值都具有科学真实性。\n-   **问题明确**：该问题为 TF 和 IDF 提供了明确的定义，所有必要的数值（$N$、$n_{j^{\\ast}}$、$x_{i^{\\ast}j^{\\ast}}$ 和 $\\sum_k x_{i^{\\ast}k}$）以及一个清晰的目标。存在唯一的可计算解。\n-   **客观性**：问题以精确、客观的语言陈述，没有偏见或主观性陈述。\n-   **不完整或矛盾的设置**：问题是自洽的，并为计算提供了所有必要的信息。没有矛盾之处。\n-   **不切实际或不可行**：所提供的数值对于典型的 scATAC-seq 实验是合理的。\n\n问题陈述科学合理、问题明确、客观且完整。\n\n### 第3步：结论与行动\n该问题是**有效的**。将根据所提供的定义和数据推导解答。\n\n### 解答推导\n细胞 $i$ 中峰 $j$ 的 TF-IDF 权重，我们记为 $W_{ij}$，是词频 ($\\text{TF}_{ij}$) 和逆文档频率 ($\\text{IDF}_j$) 的乘积。\n$$ W_{ij} = \\text{TF}_{ij} \\times \\text{IDF}_j $$\n\n首先，我们根据其定义将词频形式化：“在细胞 $i$ 中分配给峰 $j$ 的片段所占的比例。” 这可以转化为数学表达式：\n$$ \\text{TF}_{ij} = \\frac{x_{ij}}{\\sum_{k} x_{ik}} $$\n该项量化了单个细胞内峰的可及性信号的相对丰度，并通过细胞的总测序深度进行了归一化。\n\n接下来，我们将逆文档频率形式化：“总细胞数与观察到峰 $j$ 的细胞数之比的自然对数。” 这可以转化为：\n$$ \\text{IDF}_j = \\ln\\left(\\frac{N}{n_j}\\right) $$\n该项为在细胞群体中稀有的峰赋予更高的权重，从而突出了可能对某些细胞亚群具有特异性的特征。\n\n结合这两个表达式，TF-IDF 权重的完整公式是：\n$$ W_{ij} = \\left( \\frac{x_{ij}}{\\sum_{k} x_{ik}} \\right) \\times \\ln\\left(\\frac{N}{n_j}\\right) $$\n\n现在，我们使用提供的数值将此公式应用于细胞 $i^{\\ast}$ 和峰 $j^{\\ast}$ 的特定情况：\n-   $N = 1200$\n-   $n_{j^{\\ast}} = 96$\n-   $x_{i^{\\ast} j^{\\ast}} = 9$\n-   $\\sum_{k} x_{i^{\\ast} k} = 1875$\n\n首先，我们计算 $\\text{TF}_{i^{\\ast}j^{\\ast}}$ 分量：\n$$ \\text{TF}_{i^{\\ast}j^{\\ast}} = \\frac{x_{i^{\\ast} j^{\\ast}}}{\\sum_{k} x_{i^{\\ast} k}} = \\frac{9}{1875} = 0.0048 $$\n\n接下来，我们计算 $\\text{IDF}_{j^{\\ast}}$ 分量：\n$$ \\text{IDF}_{j^{\\ast}} = \\ln\\left(\\frac{N}{n_{j^{\\ast}}}\\right) = \\ln\\left(\\frac{1200}{96}\\right) = \\ln(12.5) $$\n使用计算器计算自然对数：\n$$ \\ln(12.5) \\approx 2.5257286 $$\n\n最后，我们通过将两个分量相乘来计算 TF-IDF 权重 $W_{i^{\\ast}j^{\\ast}}$：\n$$ W_{i^{\\ast}j^{\\ast}} = \\text{TF}_{i^{\\ast}j^{\\ast}} \\times \\text{IDF}_{j^{\\ast}} = 0.0048 \\times \\ln(12.5) $$\n$$ W_{i^{\\ast}j^{\\ast}} \\approx 0.0048 \\times 2.5257286 \\approx 0.012123497 $$\n\n题目要求将最终答案四舍五入到四位有效数字。第一个有效数字是百分位上的 $1$。前四位有效数字是 $1, 2, 1, 2$。第五位有效数字是 $3$，小于 $5$，因此我们向下舍入。\n$$ W_{i^{\\ast}j^{\\ast}} \\approx 0.01212 $$\n这是最终的数值答案。",
            "answer": "$$\\boxed{0.01212}$$"
        },
        {
            "introduction": "在分别对 RNA 和 ATAC 数据进行预处理后，核心挑战便在于如何将它们有意义地结合起来。加权最近邻 (WNN) 算法是解决这一挑战的强大框架，它并非简单地将两种数据“平均”，而是为每个细胞动态地计算两种模态的权重。这项练习  将带您亲手实现 WNN 算法的核心逻辑：根据每个细胞在不同模态中的信噪比来计算其专属权重，并利用这些权重来构建一个统一的、代表综合生物学状态的细胞邻接图。这个过程是理解现代多组学整合策略的关键。",
            "id": "4607733",
            "problem": "考虑五个单细胞，标记为 $C_{1}, C_{2}, C_{3}, C_{4}, C_{5}$。对于每对细胞，给出了它们在核糖核酸 (RNA) 空间和转座酶可及性染色质测序 (ATAC-seq) 空间中，经过标准归一化后以欧几里得距离测量的模态特异性相异度。目标是使用加权最近邻 (WNN) 整合方法，为 $k=2$ 构建一个融合有向 $k$-最近邻 (kNN) 图。\n\n基本原理：\n- 度量空间上的 $k$-最近邻图为每个查询点分配在指定的查询到候选点距离下，距离最小的 $k$ 个邻居。\n- 加权最近邻整合为每个查询细胞定义了一个整合的查询到候选点相异度，该相异度是模态特异性相异度的凸组合，其中模态权重反映了查询细胞的模态特异性信号强度。权重由提供的每个细胞的信噪比值通过归一化确定，使得对于每个查询细胞，权重都是非负的且总和为 $1$。\n\n数据：\n- 成对 RNA 距离 $d_{\\mathrm{RNA}}(C_{i}, C_{j})$ (对于 $i  j$)：\n  - $d_{\\mathrm{RNA}}(C_{1}, C_{2}) = 1.2$, $d_{\\mathrm{RNA}}(C_{1}, C_{3}) = 3.5$, $d_{\\mathrm{RNA}}(C_{1}, C_{4}) = 2.0$, $d_{\\mathrm{RNA}}(C_{1}, C_{5}) = 3.0$。\n  - $d_{\\mathrm{RNA}}(C_{2}, C_{3}) = 2.8$, $d_{\\mathrm{RNA}}(C_{2}, C_{4}) = 1.5$, $d_{\\mathrm{RNA}}(C_{2}, C_{5}) = 2.7$。\n  - $d_{\\mathrm{RNA}}(C_{3}, C_{4}) = 3.2$, $d_{\\mathrm{RNA}}(C_{3}, C_{5}) = 1.1$。\n  - $d_{\\mathrm{RNA}}(C_{4}, C_{5}) = 2.9$。\n- 成对 ATAC-seq 距离 $d_{\\mathrm{ATAC}}(C_{i}, C_{j})$ (对于 $i  j$)：\n  - $d_{\\mathrm{ATAC}}(C_{1}, C_{2}) = 2.6$, $d_{\\mathrm{ATAC}}(C_{1}, C_{3}) = 2.9$, $d_{\\mathrm{ATAC}}(C_{1}, C_{4}) = 3.4$, $d_{\\mathrm{ATAC}}(C_{1}, C_{5}) = 1.3$。\n  - $d_{\\mathrm{ATAC}}(C_{2}, C_{3}) = 1.0$, $d_{\\mathrm{ATAC}}(C_{2}, C_{4}) = 2.2$, $d_{\\mathrm{ATAC}}(C_{2}, C_{5}) = 2.5$。\n  - $d_{\\mathrm{ATAC}}(C_{3}, C_{4}) = 2.4$, $d_{\\mathrm{ATAC}}(C_{3}, C_{5}) = 2.0$。\n  - $d_{\\mathrm{ATAC}}(C_{4}, C_{5}) = 1.7$。\n- 模态特异性信噪比值：\n  - RNA 信号强度 $s_{\\mathrm{RNA}}(C_i)$：$s_{\\mathrm{RNA}}(C_{1}) = 4$, $s_{\\mathrm{RNA}}(C_{2}) = 6$, $s_{\\mathrm{RNA}}(C_{3}) = 3$, $s_{\\mathrm{RNA}}(C_{4}) = 9$, $s_{\\mathrm{RNA}}(C_{5}) = 2$。\n  - ATAC-seq 信号强度 $s_{\\mathrm{ATAC}}(C_i)$：$s_{\\mathrm{ATAC}}(C_{1}) = 1$, $s_{\\mathrm{ATAC}}(C_{2}) = 7$, $s_{\\mathrm{ATAC}}(C_{3}) = 8$, $s_{\\mathrm{ATAC}}(C_{4}) = 3$, $s_{\\mathrm{ATAC}}(C_{5}) = 3$。\n\n任务：\n1. 推导每个细胞的模态权重并计算整合有向相异度。\n2. 对于每个查询细胞，确定其两个最近邻，并指定融合有向 $2$-NN 图。\n3. 计算融合图中相互最近邻对的总数。",
            "solution": "问题陈述已解析和验证。\n\n### 步骤1：提取已知信息\n- **细胞**：五个单细胞，标记为 $C_{1}, C_{2}, C_{3}, C_{4}, C_{5}$。\n- **数据模态**：核糖核酸 (RNA) 和转座酶可及性染色质测序 (ATAC-seq)。\n- **成对 RNA 距离 $d_{\\mathrm{RNA}}(C_{i}, C_{j})$**：\n  - $d_{\\mathrm{RNA}}(C_{1}, C_{2}) = 1.2$， $d_{\\mathrm{RNA}}(C_{1}, C_{3}) = 3.5$， $d_{\\mathrm{RNA}}(C_{1}, C_{4}) = 2.0$， $d_{\\mathrm{RNA}}(C_{1}, C_{5}) = 3.0$。\n  - $d_{\\mathrm{RNA}}(C_{2}, C_{3}) = 2.8$， $d_{\\mathrm{RNA}}(C_{2}, C_{4}) = 1.5$， $d_{\\mathrm{RNA}}(C_{2}, C_{5}) = 2.7$。\n  - $d_{\\mathrm{RNA}}(C_{3}, C_{4}) = 3.2$， $d_{\\mathrm{RNA}}(C_{3}, C_{5}) = 1.1$。\n  - $d_{\\mathrm{RNA}}(C_{4}, C_{5}) = 2.9$。\n- **成对 ATAC-seq 距离 $d_{\\mathrm{ATAC}}(C_{i}, C_{j})$**：\n  - $d_{\\mathrm{ATAC}}(C_{1}, C_{2}) = 2.6$， $d_{\\mathrm{ATAC}}(C_{1}, C_{3}) = 2.9$， $d_{\\mathrm{ATAC}}(C_{1}, C_{4}) = 3.4$， $d_{\\mathrm{ATAC}}(C_{1}, C_{5}) = 1.3$。\n  - $d_{\\mathrm{ATAC}}(C_{2}, C_{3}) = 1.0$， $d_{\\mathrm{ATAC}}(C_{2}, C_{4}) = 2.2$， $d_{\\mathrm{ATAC}}(C_{2}, C_{5}) = 2.5$。\n  - $d_{\\mathrm{ATAC}}(C_{3}, C_{4}) = 2.4$， $d_{\\mathrm{ATAC}}(C_{3}, C_{5}) = 2.0$。\n  - $d_{\\mathrm{ATAC}}(C_{4}, C_{5}) = 1.7$。\n- **模态特异性信噪比值**：\n  - RNA 信号强度：$s_{\\mathrm{RNA}}(C_{1}) = 4$, $s_{\\mathrm{RNA}}(C_{2}) = 6$, $s_{\\mathrm{RNA}}(C_{3}) = 3$, $s_{\\mathrm{RNA}}(C_{4}) = 9$, $s_{\\mathrm{RNA}}(C_{5}) = 2$。\n  - ATAC-seq 信号强度：$s_{\\mathrm{ATAC}}(C_{1}) = 1$, $s_{\\mathrm{ATAC}}(C_{2}) = 7$, $s_{\\mathrm{ATAC}}(C_{3}) = 8$, $s_{\\mathrm{ATAC}}(C_{4}) = 3$, $s_{\\mathrm{ATAC}}(C_{5}) = 3$。\n- **方法论**：使用加权最近邻 (WNN) 整合方法构建 $k=2$ 的融合有向 $k$-最近邻 (kNN) 图。整合相异度是模态特异性相异度的凸组合。每个细胞的权重由信噪比值通过归一化得到，使其总和为 $1$。\n- **任务**：\n  1. 推导每个细胞的模态权重并计算整合有向相异度。\n  2. 确定融合有向 $2$-NN 图。\n  3. 计算相互最近邻对的总数。\n\n### 步骤2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于加权最近邻 (WNN) 算法，这是生物信息学领域用于单细胞多组学数据整合的一种成熟且广泛使用的方法。kNN 图、欧几里得距离和凸组合等概念是数据科学和数学中的标准概念。模态 (RNA, ATAC-seq) 是现实世界中的生物技术。因此，该问题在科学上是合理的。\n- **适定性**：该问题提供了所有必要的数据（两种模态的成对距离、每个细胞的信号强度以及 $k$ 的值）。指令具体，并能导出一个单一、可验证的答案。结构逻辑清晰且自包含。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观或基于价值的陈述。\n- **其他缺陷**：该问题没有违反任何其他验证标准。它与生物信息学直接相关，完整，对于一个示例问题来说是现实的，并且结构良好。\n\n### 步骤3：结论与行动\n问题被判定为 **有效**。将提供完整解答。\n\n### 解答\n解答过程遵循问题陈述中列出的三个任务。提供的模态特异性距离是欧几里得距离，因此是对称的：$d(C_{i}, C_{j}) = d(C_{j}, C_{i})$。\n\n**任务1：推导每个细胞的模态权重并计算整合相异度。**\n\n首先，我们计算每个细胞 $C_{i}$ 的模态权重。对于给定的细胞 $C_i$，RNA 和 ATAC-seq 模态的权重，记为 $w_{\\mathrm{RNA}}(C_{i})$ 和 $w_{\\mathrm{ATAC}}(C_{i})$，是通过将各自的信号强度 $s_{\\mathrm{RNA}}(C_{i})$ 和 $s_{\\mathrm{ATAC}}(C_{i})$ 归一化使其总和为 $1$ 来确定的。\n权重的计算公式为：\n$$w_{\\mathrm{RNA}}(C_{i}) = \\frac{s_{\\mathrm{RNA}}(C_{i})}{s_{\\mathrm{RNA}}(C_{i}) + s_{\\mathrm{ATAC}}(C_{i})}, \\quad w_{\\mathrm{ATAC}}(C_{i}) = \\frac{s_{\\mathrm{ATAC}}(C_{i})}{s_{\\mathrm{RNA}}(C_{i}) + s_{\\mathrm{ATAC}}(C_{i})}$$\n\n- 对于 $C_{1}$: $s_{\\mathrm{RNA}}(C_{1}) = 4, s_{\\mathrm{ATAC}}(C_{1}) = 1$。\n  $w_{\\mathrm{RNA}}(C_{1}) = \\frac{4}{4+1} = \\frac{4}{5}$，$w_{\\mathrm{ATAC}}(C_{1}) = \\frac{1}{4+1} = \\frac{1}{5}$。\n- 对于 $C_{2}$: $s_{\\mathrm{RNA}}(C_{2}) = 6, s_{\\mathrm{ATAC}}(C_{2}) = 7$。\n  $w_{\\mathrm{RNA}}(C_{2}) = \\frac{6}{6+7} = \\frac{6}{13}$，$w_{\\mathrm{ATAC}}(C_{2}) = \\frac{7}{6+7} = \\frac{7}{13}$。\n- 对于 $C_{3}$: $s_{\\mathrm{RNA}}(C_{3}) = 3, s_{\\mathrm{ATAC}}(C_{3}) = 8$。\n  $w_{\\mathrm{RNA}}(C_{3}) = \\frac{3}{3+8} = \\frac{3}{11}$，$w_{\\mathrm{ATAC}}(C_{3}) = \\frac{8}{3+8} = \\frac{8}{11}$。\n- 对于 $C_{4}$: $s_{\\mathrm{RNA}}(C_{4}) = 9, s_{\\mathrm{ATAC}}(C_{4}) = 3$。\n  $w_{\\mathrm{RNA}}(C_{4}) = \\frac{9}{9+3} = \\frac{9}{12} = \\frac{3}{4}$，$w_{\\mathrm{ATAC}}(C_{4}) = \\frac{3}{9+3} = \\frac{3}{12} = \\frac{1}{4}$。\n- 对于 $C_{5}$: $s_{\\mathrm{RNA}}(C_{5}) = 2, s_{\\mathrm{ATAC}}(C_{5}) = 3$。\n  $w_{\\mathrm{RNA}}(C_{5}) = \\frac{2}{2+3} = \\frac{2}{5}$，$w_{\\mathrm{ATAC}}(C_{5}) = \\frac{3}{2+3} = \\frac{3}{5}$。\n\n接下来，我们使用以下公式计算从每个查询细胞 $C_{i}$ 到每个候选细胞 $C_{j}$ ($i \\neq j$) 的整合有向相异度 $d_{\\mathrm{WNN}}(C_{i}, C_{j})$：\n$$d_{\\mathrm{WNN}}(C_{i}, C_{j}) = w_{\\mathrm{RNA}}(C_{i}) \\cdot d_{\\mathrm{RNA}}(C_{i}, C_{j}) + w_{\\mathrm{ATAC}}(C_{i}) \\cdot d_{\\mathrm{ATAC}}(C_{i}, C_{j})$$\n由于距离是对称的，$d_{\\mathrm{RNA}}(C_{i}, C_{j}) = d_{\\mathrm{RNA}}(C_{j}, C_{i})$ 并且 $d_{\\mathrm{ATAC}}(C_{i}, C_{j}) = d_{\\mathrm{ATAC}}(C_{j}, C_{i})$。\n\n对每个查询细胞 $C_{i}$ 的计算：\n\n- **查询 $C_{1}$** ($w_{\\mathrm{RNA}}=\\frac{4}{5}, w_{\\mathrm{ATAC}}=\\frac{1}{5}$):\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{2}) = \\frac{4}{5}(1.2) + \\frac{1}{5}(2.6) = \\frac{4.8 + 2.6}{5} = \\frac{7.4}{5} = 1.48$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{3}) = \\frac{4}{5}(3.5) + \\frac{1}{5}(2.9) = \\frac{14.0 + 2.9}{5} = \\frac{16.9}{5} = 3.38$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{4}) = \\frac{4}{5}(2.0) + \\frac{1}{5}(3.4) = \\frac{8.0 + 3.4}{5} = \\frac{11.4}{5} = 2.28$\n  - $d_{\\mathrm{WNN}}(C_{1}, C_{5}) = \\frac{4}{5}(3.0) + \\frac{1}{5}(1.3) = \\frac{12.0 + 1.3}{5} = \\frac{13.3}{5} = 2.66$\n\n- **查询 $C_{2}$** ($w_{\\mathrm{RNA}}=\\frac{6}{13}, w_{\\mathrm{ATAC}}=\\frac{7}{13}$):\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{1}) = \\frac{6}{13}(1.2) + \\frac{7}{13}(2.6) = \\frac{7.2 + 18.2}{13} = \\frac{25.4}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{3}) = \\frac{6}{13}(2.8) + \\frac{7}{13}(1.0) = \\frac{16.8 + 7.0}{13} = \\frac{23.8}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{4}) = \\frac{6}{13}(1.5) + \\frac{7}{13}(2.2) = \\frac{9.0 + 15.4}{13} = \\frac{24.4}{13}$\n  - $d_{\\mathrm{WNN}}(C_{2}, C_{5}) = \\frac{6}{13}(2.7) + \\frac{7}{13}(2.5) = \\frac{16.2 + 17.5}{13} = \\frac{33.7}{13}$\n\n- **查询 $C_{3}$** ($w_{\\mathrm{RNA}}=\\frac{3}{11}, w_{\\mathrm{ATAC}}=\\frac{8}{11}$):\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{1}) = \\frac{3}{11}(3.5) + \\frac{8}{11}(2.9) = \\frac{10.5 + 23.2}{11} = \\frac{33.7}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{2}) = \\frac{3}{11}(2.8) + \\frac{8}{11}(1.0) = \\frac{8.4 + 8.0}{11} = \\frac{16.4}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{4}) = \\frac{3}{11}(3.2) + \\frac{8}{11}(2.4) = \\frac{9.6 + 19.2}{11} = \\frac{28.8}{11}$\n  - $d_{\\mathrm{WNN}}(C_{3}, C_{5}) = \\frac{3}{11}(1.1) + \\frac{8}{11}(2.0) = \\frac{3.3 + 16.0}{11} = \\frac{19.3}{11}$\n\n- **查询 $C_{4}$** ($w_{\\mathrm{RNA}}=\\frac{3}{4}, w_{\\mathrm{ATAC}}=\\frac{1}{4}$):\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{1}) = \\frac{3}{4}(2.0) + \\frac{1}{4}(3.4) = \\frac{6.0 + 3.4}{4} = \\frac{9.4}{4} = 2.35$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{2}) = \\frac{3}{4}(1.5) + \\frac{1}{4}(2.2) = \\frac{4.5 + 2.2}{4} = \\frac{6.7}{4} = 1.675$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{3}) = \\frac{3}{4}(3.2) + \\frac{1}{4}(2.4) = \\frac{9.6 + 2.4}{4} = \\frac{12.0}{4} = 3.0$\n  - $d_{\\mathrm{WNN}}(C_{4}, C_{5}) = \\frac{3}{4}(2.9) + \\frac{1}{4}(1.7) = \\frac{8.7 + 1.7}{4} = \\frac{10.4}{4} = 2.6$\n\n- **查询 $C_{5}$** ($w_{\\mathrm{RNA}}=\\frac{2}{5}, w_{\\mathrm{ATAC}}=\\frac{3}{5}$):\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{1}) = \\frac{2}{5}(3.0) + \\frac{3}{5}(1.3) = \\frac{6.0 + 3.9}{5} = \\frac{9.9}{5} = 1.98$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{2}) = \\frac{2}{5}(2.7) + \\frac{3}{5}(2.5) = \\frac{5.4 + 7.5}{5} = \\frac{12.9}{5} = 2.58$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{3}) = \\frac{2}{5}(1.1) + \\frac{3}{5}(2.0) = \\frac{2.2 + 6.0}{5} = \\frac{8.2}{5} = 1.64$\n  - $d_{\\mathrm{WNN}}(C_{5}, C_{4}) = \\frac{2}{5}(2.9) + \\frac{3}{5}(1.7) = \\frac{5.8 + 5.1}{5} = \\frac{10.9}{5} = 2.18$\n\n**任务2：确定 $k=2$ 的融合有向 $k$-最近邻图。**\n\n对于每个细胞 $C_{i}$，我们找出具有最小 $d_{\\mathrm{WNN}}(C_{i}, C_{j})$ 值的两个细胞 $C_{j}$。\n\n- **$C_{1}$ 的邻居**：\n  - 距离：$d(C_{1}, C_{2})=1.48$, $d(C_{1}, C_{4})=2.28$, $d(C_{1}, C_{5})=2.66$, $d(C_{1}, C_{3})=3.38$。\n  - 两个最近的邻居是 $C_{2}$ 和 $C_{4}$。邻居集合 $N(C_{1}) = \\{C_{2}, C_{4}\\}$。\n\n- **$C_{2}$ 的邻居**：\n  - 距离：$d(C_{2}, C_{3})=\\frac{23.8}{13} \\approx 1.831$, $d(C_{2}, C_{4})=\\frac{24.4}{13} \\approx 1.877$, $d(C_{2}, C_{1})=\\frac{25.4}{13} \\approx 1.954$, $d(C_{2}, C_{5})=\\frac{33.7}{13} \\approx 2.592$。\n  - 两个最近的邻居是 $C_{3}$ 和 $C_{4}$。邻居集合 $N(C_{2}) = \\{C_{3}, C_{4}\\}$。\n\n- **$C_{3}$ 的邻居**：\n  - 距离：$d(C_{3}, C_{2})=\\frac{16.4}{11} \\approx 1.491$, $d(C_{3}, C_{5})=\\frac{19.3}{11} \\approx 1.755$, $d(C_{3}, C_{4})=\\frac{28.8}{11} \\approx 2.618$, $d(C_{3}, C_{1})=\\frac{33.7}{11} \\approx 3.064$。\n  - 两个最近的邻居是 $C_{2}$ 和 $C_{5}$。邻居集合 $N(C_{3}) = \\{C_{2}, C_{5}\\}$。\n\n- **$C_{4}$ 的邻居**：\n  - 距离：$d(C_{4}, C_{2})=1.675$, $d(C_{4}, C_{1})=2.35$, $d(C_{4}, C_{5})=2.6$, $d(C_{4}, C_{3})=3.0$。\n  - 两个最近的邻居是 $C_{2}$ 和 $C_{1}$。邻居集合 $N(C_{4}) = \\{C_{1}, C_{2}\\}$。\n\n- **$C_{5}$ 的邻居**：\n  - 距离：$d(C_{5}, C_{3})=1.64$, $d(C_{5}, C_{1})=1.98$, $d(C_{5}, C_{4})=2.18$, $d(C_{5}, C_{2})=2.58$。\n  - 两个最近的邻居是 $C_{3}$ 和 $C_{1}$。邻居集合 $N(C_{5}) = \\{C_{1}, C_{3}\\}$。\n\n$2$-NN 集合总结：\n- $N(C_{1}) = \\{C_{2}, C_{4}\\}$\n- $N(C_{2}) = \\{C_{3}, C_{4}\\}$\n- $N(C_{3}) = \\{C_{2}, C_{5}\\}$\n- $N(C_{4}) = \\{C_{1}, C_{2}\\}$\n- $N(C_{5}) = \\{C_{1}, C_{3}\\}$\n\n**任务3：计算相互最近邻对的总数。**\n\n如果 $C_{j}$ 在 $C_{i}$ 的 $2$-NN 集合中（即 $C_{j} \\in N(C_i)$），并且 $C_{i}$ 在 $C_{j}$ 的 $2$-NN 集合中（即 $C_{i} \\in N(C_j)$），则一个无序对 $\\{C_{i}, C_{j}\\}$ 是一个相互最近邻对。我们检查所有 $\\binom{5}{2}=10$ 个无序对。\n\n- $\\{C_{1}, C_{2}\\}$: $C_{2} \\in N(C_{1})$？是。$C_{1} \\in N(C_{2})$？否。不是相互的。\n- $\\{C_{1}, C_{3}\\}$: $C_{3} \\in N(C_{1})$？否。不是相互的。\n- $\\{C_{1}, C_{4}\\}$: $C_{4} \\in N(C_{1})$？是。$C_{1} \\in N(C_{4})$？是。**这是一个相互对。**\n- $\\{C_{1}, C_{5}\\}$: $C_{5} \\in N(C_{1})$？否。（尽管 $C_{1} \\in N(C_{5})$，但不是相互的）。\n- $\\{C_{2}, C_{3}\\}$: $C_{3} \\in N(C_{2})$？是。$C_{2} \\in N(C_{3})$？是。**这是一个相互对。**\n- $\\{C_{2}, C_{4}\\}$: $C_{4} \\in N(C_{2})$？是。$C_{2} \\in N(C_{4})$？是。**这是一个相互对。**\n- $\\{C_{2}, C_{5}\\}$: $C_{5} \\in N(C_{2})$？否。不是相互的。\n- $\\{C_{3}, C_{4}\\}$: $C_{4} \\in N(C_{3})$？否。不是相互的。\n- $\\{C_{3}, C_{5}\\}$: $C_{5} \\in N(C_{3})$？是。$C_{3} \\in N(C_{5})$？是。**这是一个相互对。**\n- $\\{C_{4}, C_{5}\\}$: $C_{5} \\in N(C_{4})$？否。不是相互的。\n\n相互最近邻对是 $\\{C_{1}, C_{4}\\}$、$\\{C_{2}, C_{3}\\}$、$\\{C_{2}, C_{4}\\}$ 和 $\\{C_{3}, C_{5}\\}$。\n相互最近邻对的总数是 $4$。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}