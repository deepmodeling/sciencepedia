{
    "hands_on_practices": [
        {
            "introduction": "在临床实践中，我们经常需要通过定义参考区间来区分“正常”与“异常”的生理指标。这些区间通常基于健康人群中该指标分布的百分位数。本练习  将指导你从第一性原理出发，推导并计算对数正态分布变量的百分位数，这是解释和应用生理测量数据的一项基本技能。",
            "id": "4990452",
            "problem": "一个临床实验室正在为表面健康的成年人群建立空腹血浆甘油三酯浓度（用随机变量 $X$ 表示，单位为 $\\text{mg/dL}$）的参考区间。经验证据表明，$X$ 是严格为正且呈右偏态的，并且 $X$ 的自然对数近似服从高斯分布。因此，将 $X$ 建模为参数为 $(\\mu,\\sigma^{2})$ 的对数正态分布，这意味着 $Y=\\ln X$ 服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布。在这种情况下，参考限值由总体百分位数指定。\n\n仅使用累积分布函数和分位数的定义、$\\ln(\\cdot)$ 在 $(0,\\infty)$ 上是严格递增（单调）函数这一事实，以及对 $Y$ 的分布假设，从第一性原理出发，推导出用 $p$、$\\mu$ 和 $\\sigma$ 表示的 $X$ 的第 $p$ 个百分位数 $q_{p}$ 的通用表达式。然后，对于 $p=0.95$，当 $(\\mu,\\sigma^{2})=(\\ln 100,\\,0.25)$ 时，计算相应的参考限值。以 $\\text{mg/dL}$ 为单位表示您的最终值，并将答案四舍五入到四位有效数字。",
            "solution": "令 $X$ 为一个服从参数为 $(\\mu, \\sigma^2)$ 的对数正态分布的随机变量。这意味着随机变量 $Y = \\ln(X)$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，即 $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$。我们希望找到 $X$ 的第 $p$ 个百分位数，我们将其记为 $q_p$。\n\n根据百分位数的定义，$q_p$ 是这样一个值，使得 $X$ 小于或等于 $q_p$ 的概率为 $p$。用 $X$ 的累积分布函数(CDF) $F_X(x)$ 表示，即：\n$$F_X(q_p) = P(X \\le q_p) = p$$\n\n由于自然对数函数 $\\ln(\\cdot)$ 在其定义域 $(0, \\infty)$ 上是严格递增的，不等式 $X \\le q_p$ 等价于不等式 $\\ln(X) \\le \\ln(q_p)$。因此，我们可以将概率写为：\n$$P(X \\le q_p) = P(\\ln(X) \\le \\ln(q_p))$$\n\n代入 $Y = \\ln(X)$，我们得到：\n$$P(Y \\le \\ln(q_p)) = p$$\n\n这个表达式是随机变量 $Y$ 的累积分布函数(CDF) $F_Y(y)$ 在 $y = \\ln(q_p)$ 处的值：\n$$F_Y(\\ln(q_p)) = p$$\n\n为了计算 $F_Y$，我们将正态变量 $Y$ 标准化。令 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$，定义为 $Z = \\frac{Y - \\mu}{\\sigma}$。$Z$ 的累积分布函数记为 $\\Phi(z) = P(Z \\le z)$。\n\n我们可以用 $\\Phi$ 来表示 $Y$ 的累积分布函数：\n$$F_Y(y) = P(Y \\le y) = P\\left(\\frac{Y - \\mu}{\\sigma} \\le \\frac{y - \\mu}{\\sigma}\\right) = P\\left(Z \\le \\frac{y - \\mu}{\\sigma}\\right) = \\Phi\\left(\\frac{y - \\mu}{\\sigma}\\right)$$\n\n将 $y = \\ln(q_p)$ 代入此关系式，我们有：\n$$F_Y(\\ln(q_p)) = \\Phi\\left(\\frac{\\ln(q_p) - \\mu}{\\sigma}\\right)$$\n\n结合我们的方程，我们得到：\n$$p = \\Phi\\left(\\frac{\\ln(q_p) - \\mu}{\\sigma}\\right)$$\n\n为了解出 $q_p$，我们首先对两边应用标准正态分布的反累积分布函数，即分位数函数 $\\Phi^{-1}(p)$。令 $z_p = \\Phi^{-1}(p)$ 为标准正态分布的第 $p$ 个分位数。\n$$\\Phi^{-1}(p) = \\frac{\\ln(q_p) - \\mu}{\\sigma}$$\n$$z_p = \\frac{\\ln(q_p) - \\mu}{\\sigma}$$\n\n现在，我们求解 $\\ln(q_p)$：\n$$z_p \\sigma = \\ln(q_p) - \\mu$$\n$$\\ln(q_p) = \\mu + z_p \\sigma$$\n\n最后，我们对两边取指数来解出 $q_p$：\n$$q_p = \\exp(\\mu + z_p \\sigma)$$\n\n将 $z_p$ 替换为其定义 $\\Phi^{-1}(p)$，我们得到对数正态分布的第 $p$ 个百分位数的通用表达式：\n$$q_p = \\exp(\\mu + \\sigma \\Phi^{-1}(p))$$\n\n**针对特定情况的计算**\n\n我们被要求计算第 $95$ 个百分位数，所以 $p=0.95$。给定的参数是 $\\mu = \\ln 100$ 和 $\\sigma^2 = 0.25$。首先，我们求标准差 $\\sigma$：\n$$\\sigma = \\sqrt{\\sigma^2} = \\sqrt{0.25} = 0.5$$\n\n接下来，我们需要 $\\Phi^{-1}(0.95)$ 的值，也就是对应于累积概率为 $0.95$ 的 $z$-分数。从标准正态分布表或统计软件中，可以得到这个值是：\n$$z_{0.95} = \\Phi^{-1}(0.95) \\approx 1.64485$$\n\n现在，我们将 $\\mu$、$\\sigma$ 和 $z_{0.95}$ 的值代入我们推导出的 $q_p$ 公式中：\n$$q_{0.95} = \\exp(\\ln 100 + 0.5 \\times \\Phi^{-1}(0.95))$$\n$$q_{0.95} \\approx \\exp(\\ln 100 + 0.5 \\times 1.64485)$$\n\n我们可以利用指数的性质来简化表达式：\n$$q_{0.95} = \\exp(\\ln 100) \\times \\exp(0.5 \\times 1.64485)$$\n$$q_{0.95} = 100 \\times \\exp(0.822425)$$\n\n现在，我们计算数值：\n$$\\exp(0.822425) \\approx 2.27596$$\n$$q_{0.95} \\approx 100 \\times 2.27596 = 227.596$$\n\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $2$、$2$、$7$ 和 $5$。第五位数字是 $9$，所以我们将第四位数字向上取整。\n$$q_{0.95} \\approx 227.6$$\n单位是 $\\text{mg/dL}$。",
            "answer": "$$\n\\boxed{227.6}\n$$"
        },
        {
            "introduction": "对于许多生理浓度指标，治疗效果通常表现为乘性效应而非加性效应，因此在对数尺度上进行建模更为合适。本练习  聚焦于一个常见的临床研究场景，你将学习如何从对数线性回归模型的结果中，为代表几何均值“倍数变化”的参数构建置信区间。这是量化和解释治疗效果的一项核心技能。",
            "id": "4990433",
            "problem": "考虑一项关于抗高血压治疗的随机临床研究，其中在随机分组前和某个固定的随访时间点，测量了 $n$ 名患者的尿白蛋白与肌酐比值 (UACR)。经验证据和生理学考量支持，像UACR这样的严格为正的浓度型测量值是右偏的，并且可以很好地用对数正态分布来建模：如果 $Y$ 表示UACR，那么 $\\ln(Y)$ 被建模为高斯分布。在自然对数尺度上，对随访UACR（根据基线UACR和年龄进行调整）拟合了一个对数线性回归模型，\n$$\n\\ln(Y_{i}) = \\alpha + \\beta T_{i} + \\gamma \\ln(Y_{i,\\text{baseline}}) + \\delta \\ln(\\text{Age}_{i}) + \\varepsilon_{i},\n$$\n其中 $T_{i} \\in \\{0,1\\}$ 是治疗指示变量，$\\varepsilon_{i}$ 是独立同分布的，且 $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$，$\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 是回归系数。在该模型中，参数 $\\beta$ 代表了治疗对 $\\ln(Y)$ 均值的加性效应，治疗组相对于对照组，$Y$ 的几何平均值的倍数变化是 $\\exp(\\beta)$。\n\n假设从拟合模型中得到的最大似然估计量 (MLE) $\\hat{\\beta}$ 及其估计的标准误 $\\operatorname{SE}(\\hat{\\beta})$ 分别为 $\\hat{\\beta} = 0.300$ 和 $\\operatorname{SE}(\\hat{\\beta}) = 0.120$。假设满足标准正则性条件，以确保最大似然估计量在大样本情况下近似服从正态分布。设显著性水平为 $\\alpha = 0.05$。仅使用关于对数正态模型、最大似然估计量的正态近似以及单调变换的基本定义和经过验证的事实，计算倍数变化 $\\exp(\\beta)$ 的 $100(1-\\alpha)\\%$ 置信区间。\n\n将最终置信区间的端点表示为无量纲的小数，并将您的答案四舍五入到四位有效数字。将这两个端点作为您的最终答案。",
            "solution": "本题的目标是基于对数线性回归模型的估计值，计算倍数变化参数 $\\exp(\\beta)$ 的 $100(1-\\alpha)\\%$ 置信区间。\n\n所提供的信息包括：\n1.  治疗效应系数的最大似然估计 (MLE)，$\\hat{\\beta} = 0.300$。\n2.  该估计量的估计标准误，$\\operatorname{SE}(\\hat{\\beta}) = 0.120$。\n3.  置信区间的显著性水平，$\\alpha = 0.05$，对应于 $100(1-0.05)\\% = 95\\%$ 的置信水平。\n4.  假设在大样本量 $n$ 的情况下，最大似然估计量 $\\hat{\\beta}$ 的抽样分布近似为正态分布。\n\n求解过程分为两个主要步骤：首先，我们在对数尺度上为参数 $\\beta$ 构建一个置信区间；其次，我们对该区间进行变换，以获得倍数变化 $\\exp(\\beta)$ 的置信区间。\n\n**步骤1：构建 $\\beta$ 的 $95\\%$ 置信区间。**\n\n根据问题陈述，在标准正则性条件下，最大似然估计量 $\\hat{\\beta}$ 近似服从正态分布。具体来说，$\\hat{\\beta}$ 的分布可以近似为：\n$$ \\hat{\\beta} \\sim \\mathcal{N}\\left(\\beta, \\left[\\operatorname{SE}(\\hat{\\beta})\\right]^2\\right) $$\n由此，我们可以构建标准化量 $Z$：\n$$ Z = \\frac{\\hat{\\beta} - \\beta}{\\operatorname{SE}(\\hat{\\beta})} \\sim \\mathcal{N}(0, 1) $$\n$\\beta$ 的一个 $100(1-\\alpha)\\%$ 置信区间是一个区间 $[\\beta_L, \\beta_U]$，满足 $P(\\beta_L \\le \\beta \\le \\beta_U) = 1-\\alpha$。这可以从枢轴量 $Z$ 构建。我们从标准正态分布中找到临界值 $z_{1-\\alpha/2}$，使得 $P(-z_{1-\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1-\\alpha$。\n对于显著性水平 $\\alpha = 0.05$，我们需要分位数 $z_{1-0.05/2} = z_{0.975}$。这是一个标准的、公认的值：\n$$ z_{0.975} \\approx 1.96 $$\n使用这个临界值，$\\beta$ 的 $95\\%$ 置信区间由以下公式给出：\n$$ \\left[ \\hat{\\beta} - z_{1-\\alpha/2} \\operatorname{SE}(\\hat{\\beta}), \\; \\hat{\\beta} + z_{1-\\alpha/2} \\operatorname{SE}(\\hat{\\beta}) \\right] $$\n代入给定的数值：\n$$ \\left[ 0.300 - 1.96 \\times 0.120, \\; 0.300 + 1.96 \\times 0.120 \\right] $$\n首先，我们计算误差范围：\n$$ \\text{误差范围} = 1.96 \\times 0.120 = 0.2352 $$\n现在，我们计算 $\\beta$ 置信区间的下限和上限：\n$$ \\beta_L = 0.300 - 0.2352 = 0.0648 $$\n$$ \\beta_U = 0.300 + 0.2352 = 0.5352 $$\n因此，$\\beta$ 的 $95\\%$ 置信区间为 $[0.0648, 0.5352]$。\n\n**步骤2：将置信区间变换到倍数变化 $\\exp(\\beta)$ 的尺度上。**\n\n我们感兴趣的参数是几何平均值的倍数变化，由 $\\exp(\\beta)$ 给出。置信区间的一个基本性质是它们可以通过单调函数进行变换。如果 $[L, U]$ 是参数 $\\theta$ 的一个 $100(1-\\alpha)\\%$ 置信区间，且 $g(\\cdot)$ 是一个严格递增函数，那么 $[g(L), g(U)]$ 就是 $g(\\theta)$ 的一个 $100(1-\\alpha)\\%$ 置信区间。\n\n在这个问题中，该函数是自然指数函数，$g(\\beta) = \\exp(\\beta)$。这个函数对所有实数都是严格递增的。因此，我们可以通过对 $\\beta$ 置信区间的端点取指数，来获得倍数变化 $\\exp(\\beta)$ 的置信区间。\n\n$\\exp(\\beta)$ 置信区间的下限是：\n$$ \\exp(\\beta_L) = \\exp(0.0648) $$\n$\\exp(\\beta)$ 置信区间的上限是：\n$$ \\exp(\\beta_U) = \\exp(0.5352) $$\n\n现在，我们计算这些端点的数值：\n$$ \\text{下限} = \\exp(0.0648) \\approx 1.0669528 $$\n$$ \\text{上限} = \\exp(0.5352) \\approx 1.7077836 $$\n问题要求最终答案四舍五入到四位有效数字。\n- 对于下限 $1.0669528...$，前四位有效数字是 $1.066$。第五位数字是 $9$，所以我们将第四位数字向上取整。四舍五入后的值为 $1.067$。\n- 对于上限 $1.7077836...$，前四位有效数字是 $1.707$。第五位数字是 $7$，所以我们将第四位数字向上取整。四舍五入后的值为 $1.708$。\n\n因此，倍数变化 $\\exp(\\beta)$ 的 $95\\%$ 置信区间约为 $[1.067, 1.708]$。这两个端点作为最终答案呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.067  1.708\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然对数正态模型在对数尺度上进行拟合和推断，但我们最终往往需要在原始尺度上报告结果，例如群体的平均值 $E[X]$。由于 $E[X]$ 的表达式 $\\exp(\\mu + \\sigma^2/2)$ 涉及两个参数，其置信区间的解析计算并不直接。本练习  将介绍参数自助法（parametric bootstrap），这是一种强大的计算方法，用于为这类复杂参数构建可靠的置信区间，是现代统计实践中不可或缺的工具。",
            "id": "4990413",
            "problem": "一种生物医学设备测量严格为正的生理量，其经验分布呈重度右偏态。假设每次测量的对数（自然对数，底为 $e$）可以很好地建模为来自正态分布的独立同分布样本。你的任务是为原始测量尺度上的总体均值构建一个参数化自助法（parametric bootstrap）双侧置信区间，置信水平为指定值。目标估计量是生理测量值 $X$ 的期望 $E[X]$。自助法过程必须通过在对数尺度上从拟合的正态模型进行模拟，在每个自助样本中重新拟合该模型，然后转换回原始尺度以重新估计目标估计量。\n\n你的程序必须从基本定义开始，实现以下内容：\n\n- 模型与参数估计：设 $(X_{1},\\dots,X_{n})$ 表示一个严格为正的测量的独立同分布样本。设 $(Y_{1},\\dots,Y_{n})$ 及其 $Y_{i}=\\log(X_{i})$ 表示它们的自然对数。假设 $(Y_{1},\\dots,Y_{n})$ 独立同分布于均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态分布。通过最大似然估计（MLE）拟合 $\\mu$ 和 $\\sigma^{2}$，对于正态模型，MLE 满足 $\\hat{\\mu}$ 等于 $(Y_{i})$ 的样本均值，$\\hat{\\sigma}^{2}$ 等于与 $\\hat{\\mu}$ 的离差平方的样本平均值，即 $\\hat{\\mu}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$ 和 $\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(Y_{i}-\\hat{\\mu})^{2}$。\n\n- 原始尺度上的目标估计量：原始尺度上的总体均值是 $E[X]$。使用基本概率变换将 $E[X]$ 表示为 $\\mu$ 和 $\\sigma^{2}$ 的函数，并使用置入原则（plug-in principle），将 MLEs $\\hat{\\mu}$ 和 $\\hat{\\sigma}^{2}$ 代入导出的表达式中，以定义 $E[X]$ 的点估计。\n\n- 参数化自助法：给定 $(\\hat{\\mu},\\hat{\\sigma}^{2})$ 和样本量 $n$，通过从均值为 $\\hat{\\mu}$、方差为 $\\hat{\\sigma}^{2}$ 的正态分布中抽取 $n$ 个独立值，在对数尺度上生成 $B$ 个自助数据集，在每个自助数据集中通过 MLE 在对数尺度上重新拟合 $(\\mu,\\sigma^{2})$，转换到原始尺度通过置入原则重新估计 $E[X]$，并收集估计量的 $B$ 个自助法重复样本。使用百分位数法（percentile method），取 $\\alpha/2$ 和 $1-\\alpha/2$ 水平的下和上经验分位数，形成置信水平为 $c$ 的双侧置信区间，其中 $\\alpha=1-c$。\n\n- 数值稳定性与可复现性：所有对数必须是自然对数。为确保可复현性，使用一个固定的基础随机种子，并且为了保证测试用例之间的独立性，将种子按测试用例索引（从零开始）进行偏移。使用确定性的分位数定义。\n\n使用以下测试套件。对于每个案例，将所有输入视为无量纲的正实数。不需要进行物理单位转换。\n\n- 案例 A（中等偏度，中等样本量）：$x=$ [$0.85$, $1.10$, $0.65$, $1.35$, $2.05$, $0.95$, $1.25$, $1.80$, $0.70$, $1.55$, $2.40$, $0.90$, $1.15$, $1.05$, $1.95$]，其中 $B=$ $20000$ 且 $c=$ $0.95$。\n- 案例 B（小样本，包含近零值）：$x=$ [$0.04$, $0.06$, $0.08$, $0.12$, $0.20$, $0.45$, $0.90$, $1.80$]，其中 $B=$ $20000$ 且 $c=$ $0.95$。\n- 案例 C（存在大异常值）：$x=$ [$6.50$, $7.20$, $5.80$, $8.10$, $9.30$, $10.00$, $11.40$, $12.20$, $7.80$, $8.60$, $9.90$, $10.70$, $6.90$, $5.40$, $13.50$, $14.20$, $9.10$, $8.90$, $7.40$, $10.80$, $12.60$, $11.10$, $200.00$, $9.70$, $8.30$]，其中 $B=$ $20000$ 且 $c=$ $0.95$。\n\n算法要求与输出规范：\n\n- 对每个数据集，在对数尺度上使用上文定义的最大似然估计（MLE）来获取 $(\\hat{\\mu},\\hat{\\sigma}^{2})$。\n- 对每个数据集，使用 $(\\hat{\\mu},\\hat{\\sigma}^{2})$ 计算 $E[X]$ 的置入点估计。\n- 在对数尺度上实现一个具有 $B$ 个重复样本的参数化自助法，以获取在 $\\alpha/2$ 和 $1-\\alpha/2$ 水平上的百分位置信区间端点，其中 $\\alpha=1-c$。使用固定的基础种子 $13579$，并按案例索引进行偏移（即，案例 A 使用种子 $13579+0$，案例 B 使用种子 $13579+1$，案例 C 使用种子 $13579+2$）。使用确定性的分位数规则。\n- 对于每个案例，返回一个包含三个浮点数的列表：下端点、上端点和置入点估计，每个都精确到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含三个案例的结果，格式为由逗号分隔的这三个三元列表，不含嵌入空格，并用方括号括起来。例如，要求的格式形如 [[lowerA,upperA,pointA],[lowerB,upperB,pointB],[lowerC,upperC,pointC]]，每个浮点数都精确打印到 $6$ 位小数。\n\n设计覆盖范围理由：案例 A 探索了典型使用场景；案例 B 测试了原始尺度上非常小的值（导致对数值为很大的负数）的行为；案例 C 考察了对原始尺度上极端高异常值的敏感性，这些异常值在对数尺度上变得温和。\n\n您的程序必须是完全确定性的，并且不得需要任何用户输入、外部文件或网络访问。所有输出都必须是无单位的实数。不涉及角度。置信水平必须以小数（例如，$0.95$）而不是百分比形式提供。",
            "solution": "本问题的目标是为服从对数正态分布的生理测量值 $X$ 的总体均值构建参数化自助法置信区间。解决方案包含以下几个步骤：推导目标估计量，指定估计过程，以及详细说明自助法算法。\n\n**1. 理论基础：对数正态分布及其均值**\n\n问题陈述，测量值 $X_i$ 严格为正，其自然对数 $Y_i = \\log(X_i)$ 是来自均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布的独立同分布（i.i.d.）样本。这是 $X$ 的对数正态分布的定义。我们将其写作 $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$，这意味着 $X = e^Y$ 服从对数正态分布。\n\n目标估计量是原始尺度上测量的总体均值 $E[X]$。为了推导 $E[X]$ 的表达式，我们使用期望的定义和正态分布的性质。\n$$\nE[X] = E[e^Y]\n$$\n此表达式是正态随机变量 $Y$ 的矩生成函数（MGF），记为 $M_Y(t) = E[e^{tY}]$，在 $t=1$ 处求值。$Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的 MGF 已知为：\n$$\nM_Y(t) = e^{\\mu t + \\frac{1}{2}\\sigma^2 t^2}\n$$\n在 $t=1$ 处求值，得到对数正态分布均值的表达式：\n$$\nE[X] = e^{\\mu + \\frac{1}{2}\\sigma^2}\n$$\n这就是我们希望估计的理论量。\n\n**2. 参数估计：最大似然估计（MLE）**\n\n基础正态分布的参数 $\\mu$ 和 $\\sigma^2$ 是未知的，必须从数据中估计。给定一个对数转换后的数据样本 $(Y_1, \\dots, Y_n)$，问题指定使用最大似然估计量（MLEs）。对于正态分布，它们由以下公式给出：\n- $\\mu$ 的样本均值：\n$$\n\\hat{\\mu} = \\frac{1}{n}\\sum_{i=1}^{n}Y_i\n$$\n- $\\sigma^2$ 的样本方差（分母为 $n$）：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n}\\sum_{i=1}^{n}(Y_i - \\hat{\\mu})^2\n$$\n注意，这个 $\\sigma^2$ 的估计量是样本方差的有偏版本。\n\n使用置入原则，我们将这些估计值代入 $E[X]$ 的表达式中，以获得总体均值的点估计：\n$$\n\\widehat{E[X]} = e^{\\hat{\\mu} + \\frac{1}{2}\\hat{\\sigma}^2}\n$$\n\n**3. 用于置信区间的参数化自助法算法**\n\n置信区间为估计量 $E[X]$ 提供了一个合理值的范围。我们使用参数化自助法程序来构建此区间，该程序在拟合的模型下模拟抽样过程。\n\n算法如下：\n1.  **初始分析**：给定原始数据样本 $(X_1, \\dots, X_n)$，计算对数转换后的数据 $(Y_1, \\dots, Y_n)$，其中 $Y_i = \\log(X_i)$。\n2.  **拟合初始模型**：根据上述定义，从对数数据 $(Y_1, \\dots, Y_n)$ 中计算 MLEs $\\hat{\\mu}$ 和 $\\hat{\\sigma}^2$。同时计算初始点估计 $\\widehat{E[X]} = e^{\\hat{\\mu} + \\hat{\\sigma}^2/2}$。\n3.  **自助法重抽样**：重复以下步骤 $B$ 次（其中 $B$ 是自助法重复的次数，例如 $B=20000$）：\n    a. **模拟数据**：通过从拟合的正态分布 $\\mathcal{N}(\\hat{\\mu}, \\hat{\\sigma}^2)$ 中抽取 $n$ 个独立同分布值，生成一个对数数据的自助样本 $(Y_1^*, \\dots, Y_n^*)$。\n    b. **重新估计参数**：使用自助样本 $(Y_1^*, \\dots, Y_n^*)$，计算参数的新 MLEs：\n       $$\n       \\hat{\\mu}^* = \\frac{1}{n}\\sum_{i=1}^{n}Y_i^*\n       $$\n       $$\n       (\\hat{\\sigma}^2)^* = \\frac{1}{n}\\sum_{i=1}^{n}(Y_i^* - \\hat{\\mu}^*)^2\n       $$\n    c. **计算自助法统计量**：根据这些新参数计算均值的置入估计。这是我们感兴趣的统计量的一个自助法重复样本：\n       $$\n       \\widehat{E[X]}^* = e^{\\hat{\\mu}^* + \\frac{1}{2}(\\hat{\\sigma}^2)^*}\n       $$\n4.  **构建置信区间**：收集所有 $B$ 个自助法重复样本 $\\{\\widehat{E[X]}_1^*, \\dots, \\widehat{E[X]}_B^*\\}$。问题指定使用百分位数法。对于置信水平 $c$，我们设 $\\alpha = 1-c$。双侧 $(1-\\alpha) \\times 100\\%$ 置信区间由自助法重复样本分布的经验 $\\alpha/2$ 和 $1-\\alpha/2$ 分位数构成。\n    - 下端点是 $(\\alpha/2)$ 分位数。\n    - 上端点是 $(1-\\alpha/2)$ 分位数。\n    对于 $c=0.95$，$\\alpha=0.05$，因此我们使用 $0.025$ 和 $0.975$ 分位数。\n\n**4. 实现细节与可复现性**\n\n实现将使用 `numpy` 库进行所有数值计算。\n- 初始数据 $x$ 使用 `numpy.log` 进行转换。\n- $\\hat{\\mu}$ 使用 `numpy.mean` 计算。\n- $\\hat{\\sigma}^2$ 使用 `numpy.var` 计算（默认使用分母 $n$，即 `ddof=0`）。\n- 自助样本使用 `numpy.random.default_rng(seed).normal(loc, scale, size)` 生成，其中 `scale` 必须是标准差 $\\hat{\\sigma} = \\sqrt{\\hat{\\sigma}^2}$。\n- 为确保可复现性，每个测试用例使用一个特定的随机数生成器种子，并按指定的案例索引进行偏移（$13579+0$，$13579+1$ 等）。\n- 置信区间的端点使用 `numpy.quantile` 计算，它能提供一个确定性的结果。\n- 每个案例的最终输出包括下端点、上端点和原始点估计，所有值都四舍五入到 $6$ 位小数。\n\n此程序将应用于所提供的三个测试案例中的每一个，利用指定的参数和种子来产生一个确定性且可验证的结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates a parametric bootstrap confidence interval for the mean of a\n    log-normally distributed variable.\n    \"\"\"\n\n    test_cases = [\n        # Case A\n        {'x': [0.85, 1.10, 0.65, 1.35, 2.05, 0.95, 1.25, 1.80, 0.70, 1.55, 2.40, 0.90, 1.15, 1.05, 1.95],\n         'B': 20000,\n         'c': 0.95},\n        # Case B\n        {'x': [0.04, 0.06, 0.08, 0.12, 0.20, 0.45, 0.90, 1.80],\n         'B': 20000,\n         'c': 0.95},\n        # Case C\n        {'x': [6.50, 7.20, 5.80, 8.10, 9.30, 10.00, 11.40, 12.20, 7.80, 8.60, 9.90, 10.70, 6.90, 5.40, 13.50, 14.20, 9.10, 8.90, 7.40, 10.80, 12.60, 11.10, 200.00, 9.70, 8.30],\n         'B': 20000,\n         'c': 0.95}\n    ]\n\n    base_seed = 13579\n    results = []\n\n    for i, case in enumerate(test_cases):\n        seed = base_seed + i\n        lower, upper, point_estimate = bootstrap_ci_lognormal_mean(\n            data=case['x'],\n            num_bootstrap_samples=case['B'],\n            confidence_level=case['c'],\n            seed=seed\n        )\n        results.append([lower, upper, point_estimate])\n\n    # Format the final output string as per requirements.\n    formatted_results = [f\"[{l:.6f},{u:.6f},{p:.6f}]\" for l, u, p in results]\n    print(f\"[[{','.join(formatted_results)}]]\")\n\ndef bootstrap_ci_lognormal_mean(data, num_bootstrap_samples, confidence_level, seed):\n    \"\"\"\n    Computes a parametric bootstrap confidence interval for the mean of a\n    log-normally distributed variable.\n\n    Args:\n        data (list or np.ndarray): The sample of strictly positive measurements.\n        num_bootstrap_samples (int): The number of bootstrap samples to generate (B).\n        confidence_level (float): The confidence level for the interval (c).\n        seed (int): The seed for the random number generator.\n\n    Returns:\n        tuple: A tuple containing the lower endpoint, upper endpoint, and the\n               plug-in point estimate, each rounded to 6 decimal places.\n    \"\"\"\n    x_original = np.asarray(data)\n    y_original = np.log(x_original)\n    n = len(y_original)\n\n    # Step 1: Fit the model to the original data (MLE for Normal distribution on log scale)\n    mu_hat = np.mean(y_original)\n    sigma2_hat = np.var(y_original)  # MLE for variance (denominator n)\n\n    # Step 2: Calculate the plug-in point estimate for E[X]\n    # E[X] = exp(mu + sigma^2 / 2)\n    point_estimate = np.exp(mu_hat + 0.5 * sigma2_hat)\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(seed)\n    \n    # Standard deviation for random number generation\n    sigma_hat = np.sqrt(sigma2_hat)\n\n    bootstrap_estimates = np.zeros(num_bootstrap_samples)\n\n    # Step 3: Run the parametric bootstrap\n    for i in range(num_bootstrap_samples):\n        # a. Simulate new data on the log scale\n        y_star = rng.normal(loc=mu_hat, scale=sigma_hat, size=n)\n\n        # b. Re-estimate parameters from the bootstrap sample\n        mu_hat_star = np.mean(y_star)\n        sigma2_hat_star = np.var(y_star)\n\n        # c. Calculate the bootstrap replicate of the statistic\n        bootstrap_estimates[i] = np.exp(mu_hat_star + 0.5 * sigma2_hat_star)\n\n    # Step 4: Construct the percentile confidence interval\n    alpha = 1.0 - confidence_level\n    lower_quantile = alpha / 2.0\n    upper_quantile = 1.0 - lower_quantile\n\n    lower_bound = np.quantile(bootstrap_estimates, lower_quantile)\n    upper_bound = np.quantile(bootstrap_estimates, upper_quantile)\n\n    return lower_bound, upper_bound, point_estimate\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}