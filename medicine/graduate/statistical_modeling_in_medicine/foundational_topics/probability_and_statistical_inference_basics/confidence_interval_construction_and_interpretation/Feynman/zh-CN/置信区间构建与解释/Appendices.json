{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在加深对置信区间构建方式及其方法选择重要性的理解。我们将从一个常见却充满挑战的情景——二项分布比例的估计——入手。通过推导并批判性地分析朴素的Wald区间，特别是在处理罕见事件时其暴露的缺陷，我们将展示为何需要更稳健的方法，并从第一性原理出发，通过反演得分检验来构建性能更优的Wilson得分区间。",
            "id": "4957390",
            "problem": "一项多中心II期肿瘤学研究监测一种新型单克隆抗体输注期间即刻超敏反应的发生率。令 $p$ 表示任何给定输注导致超敏反应的真实概率。在 $n$ 次独立输注中，观察到的反应次数 $X$ 被建模为一个二项随机变量，其概率质量函数为 $P(X=x \\mid p) = \\binom{n}{x} p^{x} (1-p)^{n-x}$，其中 $x \\in \\{0,1,\\dots,n\\}$。在该研究中，观察到 $n$ 次连续输注中发生了 $x=0$ 次反应。\n\n任务：\n1. 从二项模型和中心极限定理（CLT）出发，利用 $p$ 的最大似然估计（MLE）及其渐近分布，构建所谓的Wald置信区间，用于估计二项比例 $p$。对Wald区间的覆盖性质进行有理有据的评述，重点关注参数边界行为（$p \\approx 0$ 和 $p \\approx 1$），并讨论这些性质为何源于其构建方法。\n2. 从二项模型下对 $H_{0}: p=p_{0}$ 的分数检验出发，通过反演双边检验，推导出名义置信水平为 $1-\\alpha$ 的Wilson分数置信区间。你的推导应清楚地说明检验反演如何导出一个关于 $p$ 的二次不等式，并得出一个在中心和尺度上与Wald区间不同的区间。不要假设任何快捷公式；从第一性原理推导其解析表达式。\n3. 将你推导的Wilson分数区间应用于研究案例，其中 $n=62$，$x=0$，$1-\\alpha=0.95$（因此标准正态分布的分位数为 $z_{1-\\alpha/2} \\approx 1.96$）。计算在此情况下 $p$ 的Wilson区间的上界。将最终答案表示为小数比例，并四舍五入至四位有效数字。",
            "solution": "本问题探讨二项比例 $p$ 的置信区间的构建和性质。我们将首先推导并评述Wald区间，然后推导更优的Wilson分数区间，最后将Wilson区间应用于给定的临床研究数据。\n\n**第一部分：Wald置信区间及其评述**\n\n在 $n$ 次输注中观察到的反应次数 $X$ 服从二项分布，$X \\sim \\text{Binomial}(n, p)$。给定观测值 $X=x$ 时，$p$ 的似然函数正比于 $p^x (1-p)^{n-x}$。对数似然函数为 $\\ell(p; x) = x \\ln(p) + (n-x) \\ln(1-p)$。\n\n为了找到 $p$ 的最大似然估计（MLE），我们将 $\\ell(p)$ 对 $p$ 求导，并令结果为零：\n$$\n\\frac{d\\ell}{dp} = \\frac{x}{p} - \\frac{n-x}{1-p} = 0\n$$\n解出 $p$ 得到MLE，$\\hat{p} = \\frac{x}{n}$。\n\n中心极限定理（CLT）应用于独立伯努利试验之和时，指出样本比例 $\\hat{p}$ 是渐近正态分布的。更正式地，根据MLE的性质，$\\hat{p}$ 是一致的，并且是渐近正态的，其均值为 $p$，方差等于费雪信息量的倒数。$n$ 次试验的费雪信息量为 $I_n(p) = \\frac{n}{p(1-p)}$。因此，$\\hat{p}$ 的渐近方差为 $\\text{Var}(\\hat{p}) = \\frac{p(1-p)}{n}$。\n其渐近分布为：\n$$\n\\hat{p} \\stackrel{a}{\\sim} N\\left(p, \\frac{p(1-p)}{n}\\right)\n$$\n由此，我们可以构建一个标准化的枢轴量：\n$$\nZ = \\frac{\\hat{p} - p}{\\sqrt{\\frac{p(1-p)}{n}}} \\stackrel{a}{\\sim} N(0,1)\n$$\nWald置信区间是通过将标准误项中的未知参数 $p$ 替换为其一致估计量 $\\hat{p}$ 来构建的。得到的统计量是：\n$$\nW = \\frac{\\hat{p} - p}{\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}} \\stackrel{a}{\\sim} N(0,1)\n$$\n一个 $100(1-\\alpha)\\%$ 的置信区间是通过取所有满足 $|W| \\le z_{1-\\alpha/2}$ 的 $p$ 值集合来找到的，其中 $z_{1-\\alpha/2}$ 是标准正态分布的上 $1-\\alpha/2$ 分位数。这导出了如下区间：\n$$\n\\hat{p} \\pm z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{n}}\n$$\nWald区间的评述：Wald区间尽管构造简单直观，但其性能较差，尤其是在真实参数 $p$ 接近参数空间边界时，即 $p \\approx 0$ 或 $p \\approx 1$。这些不良的覆盖性质直接源于其构建方法。其关键缺陷在于对标准误的“代入”估计，即 $\\sqrt{\\hat{p}(1-\\hat{p})/n}$。当观察到的成功次数 $x$ 为 $0$ 或 $n$ 时，MLE $\\hat{p}$ 分别为 $0$ 或 $1$。\n- 如果 $x=0$，则 $\\hat{p}=0$。估计的标准误变为 $\\sqrt{0(1-0)/n} = 0$。Wald区间坍缩为 $[0, 0]$，一个零宽度的区间。这荒谬地意味着 $p$ 精确为 $0$ 的置信度为 $100(1-\\alpha)\\%$，这是一个从有限样本中得出的毫无道理的强结论。如果真实的 $p$ 很小但为正，该区间将无法覆盖它，导致实际覆盖概率为 $0$。\n- 类似地，如果 $x=n$，则 $\\hat{p}=1$，区间坍缩为 $[1, 1]$。\n这种在边界处的退化是一个严重的失败。此外，对于接近 $0$ 或 $1$ 的 $p$ 值，$\\hat{p}$ 的分布是高度偏斜的，除非 $n$ 极大，否则正态近似效果很差。因此，Wald区间的实际覆盖概率可能远低于名义的 $1-\\alpha$ 水平，并且会随着 $p$ 和 $n$ 的变化而剧烈波动。\n\n**第二部分：Wilson分数置信区间**\n\nWilson区间是通过反演分数检验推导出来的，这避免了Wald区间构造中存在的有问题的标准误代入估计。对于原假设 $H_0: p = p_0$ 的分数检验使用以下检验统计量：\n$$\nZ(p_0) = \\frac{\\hat{p} - p_0}{\\sqrt{\\frac{p_0(1-p_0)}{n}}}\n$$\n在 $H_0$ 下，该统计量渐近服从 $N(0,1)$ 分布。注意，分母中的标准误是假设值 $p_0$ 的函数，而不是估计值 $\\hat{p}$ 的函数。\n\n一个 $100(1-\\alpha)\\%$ 的置信区间由所有使得我们在显著性水平 $\\alpha$ 下*不*拒绝原假设 $H_0: p=p_0$ 的 $p_0$ 值集合构成。对于双边检验，这个非拒绝域由 $|Z(p_0)| \\le z_{1-\\alpha/2}$ 定义。令 $z = z_{1-\\alpha/2}$，这等价于：\n$$\n(Z(p_0))^2 \\le z^2\n$$\n代入分数统计量的表达式，得到不等式：\n$$\n\\frac{(\\hat{p} - p_0)^2}{\\frac{p_0(1-p_0)}{n}} \\le z^2\n$$\n现在必须对该不等式求解 $p_0$。两边同乘以分母得到：\n$$\nn(\\hat{p} - p_0)^2 \\le z^2 p_0(1-p_0)\n$$\n这就是问题所要求的关于 $p_0$ 的二次不等式。为了找到区间，我们展开并整理各项，得到标准二次形式 $A p_0^2 + B p_0 + C \\le 0$：\n$$\nn(\\hat{p}^2 - 2\\hat{p}p_0 + p_0^2) \\le z^2 p_0 - z^2 p_0^2\n$$\n$$\n(n+z^2)p_0^2 - (2n\\hat{p} + z^2)p_0 + n\\hat{p}^2 \\le 0\n$$\n这描述了一个开口向上的关于 $p_0$ 的抛物线，因为首项系数 $A=(n+z^2)$ 为正。该不等式对于位于相应二次方程的根之间的 $p_0$ 值成立：\n$$\n(n+z^2)p_0^2 - (2n\\hat{p} + z^2)p_0 + n\\hat{p}^2 = 0\n$$\n使用二次公式 $p_0 = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$，根为：\n$$\np_0 = \\frac{(2n\\hat{p} + z^2) \\pm \\sqrt{(2n\\hat{p} + z^2)^2 - 4(n+z^2)(n\\hat{p}^2)}}{2(n+z^2)}\n$$\n简化判别式： $(2n\\hat{p} + z^2)^2 - 4(n+z^2)(n\\hat{p}^2) = 4n^2\\hat{p}^2 + 4n\\hat{p}z^2 + z^4 - 4n^2\\hat{p}^2 - 4nz^2\\hat{p}^2 = z^2(z^2 + 4n\\hat{p}(1-\\hat{p}))$\n构成Wilson区间下界和上界的根是：\n$$\n\\frac{2n\\hat{p} + z^2 \\pm z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}}{2(n+z^2)}\n$$\n这个表达式可以重新整理，以突显其与Wald区间在中心和尺度上的差异。Wilson区间的中心是 $\\frac{n\\hat{p} + z^2/2}{n+z^2} = \\frac{x+z^2/2}{n+z^2}$，它是样本比例 $\\hat{p}$ 和 $1/2$ 的加权平均。这将中心从边界 $0$ 和 $1$ 拉开，从而改善了性能。尺度（半宽度）也更复杂，并且在 $\\hat{p}=0$ 或 $\\hat{p}=1$ 时不会变为零。\n\n**第三部分：应用于研究案例**\n\n我们得到以下数据：$n=62$ 次输注，$x=0$ 次反应。期望的置信水平为 $1-\\alpha=0.95$，因此 $\\alpha=0.05$。相应的标准正态分位数为 $z_{1-\\alpha/2} = z_{0.975} \\approx 1.96$。\n\n样本比例为 $\\hat{p} = x/n = 0/62 = 0$。我们使用推导出的Wilson区间界限的公式。题目要求我们计算上界。\n$$\n\\text{上界} = \\frac{2n\\hat{p} + z^2 + z\\sqrt{4n\\hat{p}(1-\\hat{p}) + z^2}}{2(n+z^2)}\n$$\n代入给定值：\n$$\n\\text{上界} = \\frac{2(62)(0) + (1.96)^2 + 1.96\\sqrt{4(62)(0)(1-0) + (1.96)^2}}{2(62+(1.96)^2)}\n$$\n$$\n= \\frac{(1.96)^2 + 1.96\\sqrt{(1.96)^2}}{2(62+(1.96)^2)}\n$$\n$$\n= \\frac{(1.96)^2 + 1.96(1.96)}{2(62+(1.96)^2)} = \\frac{2(1.96)^2}{2(62+(1.96)^2)}\n$$\n$$\n= \\frac{(1.96)^2}{62+(1.96)^2} = \\frac{3.8416}{62+3.8416} = \\frac{3.8416}{65.8416}\n$$\n进行除法运算得到约 $0.05834800$。\n\n问题要求将最终答案四舍五入至四位有效数字。第一位有效数字是 $5$，第二位是 $8$，第三位是 $3$，第四位是 $4$。第五位有效数字是 $8$。由于 $8 \\ge 5$，我们将第四位有效数字向上取整。\n因此，上界为 $0.05835$。\n\n完整的Wilson区间为 $[0, 0.05835]$。与Wald区间的 $[0,0]$ 不同，该区间正确地反映了 $p$ 的不确定性，并为超敏反应的可能发生率提供了一个非零的上限。",
            "answer": "$$\n\\boxed{0.05835}\n$$"
        },
        {
            "introduction": "在掌握了单个参数的区间估计后，我们将练习的难度提升一步，转向处理两独立组的比较，这是临床研究中的核心任务。本练习将引入风险比（Risk Ratio, $RR$）作为衡量效应大小的关键指标，并解释为何处理这类比率参数时，我们通常在对数尺度上进行统计推断以获得更好的正态近似效果。这将自然地引出“德尔塔方法”（delta method），这是一个功能强大的工具，用于推导经过变换后的估计量的方差，从而为风险比构建置信区间。",
            "id": "4957413",
            "problem": "一个临床流行病学团队评估一种新的围手术期消毒方案对成年患者手术部位感染风险的影响。在一项前瞻性多中心队列研究中，组 $1$（采用新方案的医院）招募了 $n_{1}$ 名患者，其中 $x_{1}$ 人发生感染；组 $2$（维持既往实践的医院）招募了 $n_{2}$ 名患者，其中 $x_{2}$ 人发生感染。假设组内为独立的伯努利抽样，并令 $p_{1}$ 和 $p_{2}$ 分别表示组 $1$ 和组 $2$ 的真实感染风险。感兴趣的参数是风险比 $\\text{RR} = p_{1} / p_{2}$。\n\n从伯努利抽样下样本比例的中心极限定理（CLT）和渐近正态估计量的平滑变换的delta方法出发，推导在二项抽样下对数风险比估计量 $\\log \\hat{\\text{RR}}$ 的大样本方差，并用此构建 $\\text{RR}$ 在自然尺度上的双侧 $95\\%$ 置信区间。在推导中，将各组的 $\\hat{p}_{i} = x_{i} / n_{i}$ 视为 $p_{i}$ 的最大似然估计（MLE），证明 $\\hat{p}_{1}$ 和 $\\hat{p}_{2}$ 的独立性，并将delta方法应用于变换 $g(p_{1}, p_{2}) = \\log p_{1} - \\log p_{2}$。\n\n现在考虑以下数据：组 $1$ 有 $n_{1} = 800$ 名患者，其中 $x_{1} = 120$ 人感染；组 $2$ 有 $n_{2} = 900$ 名患者，其中 $x_{2} = 180$ 人感染。使用 $95\\%$ 的双侧置信水平和标准正态分位数 $z_{0.975} = 1.96$，计算对数尺度上的置信区间界限，然后通过取指数将其转换回 $\\text{RR}$ 尺度。仅报告 $\\text{RR}$ 的 $95\\%$ 置信区间的下限，四舍五入至四位有效数字。无需单位。",
            "solution": "问题要求推导风险比 $\\text{RR} = p_1 / p_2$ 的置信区间。按规定，标准方法是在对数尺度上进行计算以改善正态近似，然后变换回来。\n\n令 $\\hat{p}_1 = x_1/n_1$ 和 $\\hat{p}_2 = x_2/n_2$ 分别为组 $1$ 和组 $2$ 中感染的样本比例。这些是真实比例 $p_1$ 和 $p_2$ 的最大似然估计（MLE）。\n\n在大样本量 $n_i$ 的伯努利抽样假设下，中心极限定理（CLT）指出，样本比例 $\\hat{p}_i$ 的分布近似为正态分布：\n$$ \\hat{p}_i \\approx \\mathcal{N}\\left(p_i, \\frac{p_i(1-p_i)}{n_i}\\right) $$\n其中 $i \\in \\{1, 2\\}$。\n\n问题陈述指出，队列研究的两个组是独立的。组 $1$ 由采用新方案的医院组成，组 $2$ 由维持既往实践的不同医院组成。由于样本是从两个不同且不重叠的总体（或研究组）中抽取的，因此估计量 $\\hat{p}_1$ 和 $\\hat{p}_2$ 在统计上是独立的。\n\n我们感兴趣的函数是 $g(p_1, p_2) = \\log(p_1) - \\log(p_2)$。该量的估计量为 $\\log(\\hat{\\text{RR}}) = g(\\hat{p}_1, \\hat{p}_2) = \\log(\\hat{p}_1) - \\log(\\hat{p}_2)$。我们应用多元delta方法来求其大样本方差。随机向量 $\\hat{\\theta}$ 的函数 $g(\\hat{\\theta})$ 的方差近似为 $(\\nabla g)^T \\Sigma (\\nabla g)$，其中 $\\nabla g$ 是 $g$ 的梯度，$\\Sigma$ 是 $\\hat{\\theta}$ 的协方差矩阵。\n\n这里，估计量向量是 $\\hat{\\theta} = (\\hat{p}_1, \\hat{p}_2)^T$。$g(p_1, p_2)$ 的梯度是：\n$$ \\nabla g(p_1, p_2) = \\begin{pmatrix} \\frac{\\partial g}{\\partial p_1} \\\\ \\frac{\\partial g}{\\partial p_2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{p_1} \\\\ -\\frac{1}{p_2} \\end{pmatrix} $$\n由于 $\\hat{p}_1$ 和 $\\hat{p}_2$ 的独立性，它们的协方差为 $0$。$(\\hat{p}_1, \\hat{p}_2)^T$ 的协方差矩阵是对角矩阵：\n$$ \\Sigma = \\begin{pmatrix} \\text{Var}(\\hat{p}_1) & 0 \\\\ 0 & \\text{Var}(\\hat{p}_2) \\end{pmatrix} = \\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1} & 0 \\\\ 0 & \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix} $$\n那么 $\\log(\\hat{\\text{RR}})$ 的渐近方差为：\n$$ \\text{Var}(\\log \\hat{\\text{RR}}) \\approx [\\nabla g(p_1, p_2)]^T \\Sigma [\\nabla g(p_1, p_2)] $$\n$$ \\text{Var}(\\log \\hat{\\text{RR}}) \\approx \\begin{pmatrix} \\frac{1}{p_1} & -\\frac{1}{p_2} \\end{pmatrix} \\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1} & 0 \\\\ 0 & \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{p_1} \\\\ -\\frac{1}{p_2} \\end{pmatrix} $$\n$$ \\text{Var}(\\log \\hat{\\text{RR}}) \\approx \\left(\\frac{1}{p_1}\\right)^2 \\text{Var}(\\hat{p}_1) + \\left(-\\frac{1}{p_2}\\right)^2 \\text{Var}(\\hat{p}_2) $$\n$$ \\text{Var}(\\log \\hat{\\text{RR}}) \\approx \\frac{1}{p_1^2} \\left(\\frac{p_1(1-p_1)}{n_1}\\right) + \\frac{1}{p_2^2} \\left(\\frac{p_2(1-p_2)}{n_2}\\right) $$\n$$ \\text{Var}(\\log \\hat{\\text{RR}}) \\approx \\frac{1-p_1}{n_1 p_1} + \\frac{1-p_2}{n_2 p_2} $$\n为了构建置信区间，我们需要从数据中估计这个方差。我们用估计量 $\\hat{p}_1$ 和 $\\hat{p}_2$ 替代真实参数 $p_1$ 和 $p_2$。估计方差，即 $\\log(\\hat{\\text{RR}})$ 的标准误的平方，为：\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) = \\frac{1-\\hat{p}_1}{n_1 \\hat{p}_1} + \\frac{1-\\hat{p}_2}{n_2 \\hat{p}_2} $$\n代入 $\\hat{p}_i = x_i/n_i$：\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) = \\frac{1 - x_1/n_1}{n_1 (x_1/n_1)} + \\frac{1 - x_2/n_2}{n_2 (x_2/n_2)} = \\frac{(n_1-x_1)/n_1}{x_1} + \\frac{(n_2-x_2)/n_2}{x_2} $$\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) = \\frac{n_1-x_1}{n_1 x_1} + \\frac{n_2-x_2}{n_2 x_2} = \\left(\\frac{1}{x_1} - \\frac{1}{n_1}\\right) + \\left(\\frac{1}{x_2} - \\frac{1}{n_2}\\right) $$\n$\\log(\\text{RR})$ 的一个双侧 $95\\%$ 置信区间的构造如下：\n$$ \\log(\\hat{\\text{RR}}) \\pm z_{0.975} \\sqrt{\\widehat{\\text{Var}}(\\log \\hat{\\text{RR}})} $$\n为了得到 $\\text{RR}$ 本身的置信区间，我们对 $\\log(\\text{RR})$ 区间的界限取指数。\n\n现在，我们将此应用于给定的数据：\n-   组 $1$：$n_1 = 800$, $x_1 = 120$。\n-   组 $2$：$n_2 = 900$, $x_2 = 180$。\n\n首先，计算点估计值：\n$$ \\hat{p}_1 = \\frac{x_1}{n_1} = \\frac{120}{800} = 0.15 $$\n$$ \\hat{p}_2 = \\frac{x_2}{n_2} = \\frac{180}{900} = 0.20 $$\n估计的风险比为：\n$$ \\hat{\\text{RR}} = \\frac{\\hat{p}_1}{\\hat{p}_2} = \\frac{0.15}{0.20} = 0.75 $$\n估计的风险比的自然对数为：\n$$ \\log(\\hat{\\text{RR}}) = \\ln(0.75) \\approx -0.28768 $$\n接下来，计算 $\\log(\\hat{\\text{RR}})$ 的估计方差：\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) = \\frac{1}{x_1} - \\frac{1}{n_1} + \\frac{1}{x_2} - \\frac{1}{n_2} = \\frac{1}{120} - \\frac{1}{800} + \\frac{1}{180} - \\frac{1}{900} $$\n我们来计算各项：\n$$ \\frac{1}{120} \\approx 0.0083333... $$\n$$ \\frac{1}{800} = 0.00125 $$\n$$ \\frac{1}{180} \\approx 0.0055555... $$\n$$ \\frac{1}{900} \\approx 0.0011111... $$\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) \\approx 0.0083333 - 0.00125 + 0.0055556 - 0.0011111 \\approx 0.0115278 $$\n为保证精度，使用分数计算：\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) = \\left(\\frac{1}{120} - \\frac{1}{800}\\right) + \\left(\\frac{1}{180} - \\frac{1}{900}\\right) = \\left(\\frac{20-3}{2400}\\right) + \\left(\\frac{5-1}{900}\\right) = \\frac{17}{2400} + \\frac{4}{900} = \\frac{17}{2400} + \\frac{1}{225} $$\n$2400$ 和 $225$ 的最小公倍数是 $7200$。\n$$ \\widehat{\\text{Var}}(\\log \\hat{\\text{RR}}) = \\frac{17 \\times 3}{7200} + \\frac{1 \\times 32}{7200} = \\frac{51+32}{7200} = \\frac{83}{7200} $$\n标准误（SE）是方差的平方根：\n$$ \\text{SE}(\\log \\hat{\\text{RR}}) = \\sqrt{\\frac{83}{7200}} \\approx 0.107368 $$\n$\\log(\\text{RR})$ 的 $95\\%$ 置信区间为：\n$$ \\log(\\hat{\\text{RR}}) \\pm z_{0.975} \\times \\text{SE}(\\log \\hat{\\text{RR}}) $$\n$$ -0.28768 \\pm 1.96 \\times 0.107368 $$\n$$ -0.28768 \\pm 0.210441 $$\n$\\log(\\text{RR})$ 的下限是：\n$$ \\text{LL}_{\\log} = -0.28768 - 0.210441 = -0.498121 $$\n$\\log(\\text{RR})$ 的上限是：\n$$ \\text{UL}_{\\log} = -0.28768 + 0.210441 = -0.077239 $$\n为了得到 $\\text{RR}$ 的置信区间，我们对这些界限取指数。问题要求的是 $\\text{RR}$ 的 $95\\%$ 置信区间的下限。\n$$ \\text{LL}_{\\text{RR}} = \\exp(\\text{LL}_{\\log}) = \\exp(-0.498121) \\approx 0.60767 $$\n四舍五入至四位有效数字，下限为 $0.6077$。",
            "answer": "$$\\boxed{0.6077}$$"
        },
        {
            "introduction": "最后一个练习将我们的视角从数据分析转向至关重要的研究设计阶段。它提出了一个研究者必须回答的核心问题：“我的研究需要多少受试者？”。此练习强调了统计精确度（由置信区间宽度决定）与临床相关性（由效应大小的临床意义决定）之间的关键区别，并指导你如何基于预设的置信区间宽度来计算样本量。通过这个练习，你将学会如何将置信区间的概念应用于研究规划，确保研究结果具有足够的精确度。",
            "id": "4957371",
            "problem": "一项平行的双臂随机临床试验将比较一种新的降压药与安慰剂对主要终点——收缩压变化（以 $\\mathrm{mmHg}$ 为单位）的影响。研究者们判断，有利于药物的平均差异 $\\delta^{\\star} = 5$ $\\mathrm{mmHg}$ 在幅度上具有临床相关性，但他们希望为研究的统计精确性进行设计：具体来说，他们希望在置信水平为 $0.95$ 时，组间平均差异的双侧置信区间（CI）的总宽度达到预设的 $W^{\\star} = 6$ $\\mathrm{mmHg}$。来自可比人群的历史数据表明，共同的结果标准差为 $\\sigma = 12$ $\\mathrm{mmHg}$。假设等比例分配、参与者相互独立，并且结果值在以治疗组为条件下独立同分布，且方差相同。在规划时，使用对应于双侧覆盖率 $0.95$ 的标准正态分位数。预计失访率为 $d = 0.15$，这将导致这些参与者的结果无法用于主要分析。\n\n仅从样本均值的抽样分布定义和经过充分检验的事实，以及正态位置参数双侧置信区间的构建出发，推导在等比例分配下，两个独立均值之差的样本量与置信区间宽度之间的关系。利用此推导计算需要招募的最少参与者总数，以便在失访率为 $d$ 的情况下，主要分析将以 $0.95$ 的置信水平实现不大于 $W^{\\star}$ 的置信区间宽度。\n\n在你的推导中，通过指出哪些量编码了哪个概念，明确区分统计精确性（区间宽度）和临床相关性（效应大小）。将最终答案报告为最小的总招募人数（一个整数）。无需四舍五入到特定数量的有效数字；报告满足设计要求的确切最小整数。",
            "solution": "该问题要求计算在一项双臂随机临床试验中需要招募的参与者总数，以达到预设的均值差置信区间宽度。该解决方案源于统计估计的基本原理。\n\n设治疗组用下标 $T$ 表示，安慰剂组用 $P$ 表示。收缩压的真实平均变化分别为 $\\mu_T$ 和 $\\mu_P$。我们感兴趣的参数是这些均值之差，$\\Delta = \\mu_T - \\mu_P$。\n\n研究设计指定了等比例分配。设每组中可用于主要分析的数据的参与者人数为 $n$。用于分析的总样本量为 $N_{analysis} = 2n$。设 $\\bar{X}_T$ 和 $\\bar{X}_P$ 分别为治疗组和安慰剂组的收缩压样本均值变化。$\\Delta$ 的点估计量为 $\\hat{\\Delta} = \\bar{X}_T - \\bar{X}_P$。\n\n问题陈述，在以治疗组为条件下，结果是独立同分布的，并具有共同的结果标准差 $\\sigma$。根据基础统计理论，样本均值的抽样分布近似为正态分布（根据中心极限定理，如果基础数据是正态的，则为精确正态分布）：\n$\\bar{X}_T \\sim \\mathcal{N}(\\mu_T, \\sigma^2/n)$\n$\\bar{X}_P \\sim \\mathcal{N}(\\mu_P, \\sigma^2/n)$\n\n因为两个组是独立的，所以估计量 $\\hat{\\Delta}$ 的抽样分布也是正态的。该估计量的期望值为 $E[\\hat{\\Delta}] = E[\\bar{X}_T] - E[\\bar{X}_P] = \\mu_T - \\mu_P = \\Delta$，这意味着 $\\hat{\\Delta}$ 是 $\\Delta$ 的一个无偏估计量。该估计量的方差是样本均值方差之和：\n$$\n\\mathrm{Var}(\\hat{\\Delta}) = \\mathrm{Var}(\\bar{X}_T) + \\mathrm{Var}(\\bar{X}_P) = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} = \\frac{2\\sigma^2}{n}\n$$\n该估计量的标准误是其方差的平方根：\n$$\n\\mathrm{SE}(\\hat{\\Delta}) = \\sqrt{\\frac{2\\sigma^2}{n}} = \\sigma\\sqrt{\\frac{2}{n}}\n$$\n在置信水平为 $1-\\alpha$ 时，$\\Delta$ 的双侧置信区间（CI）构建如下：\n$$\n\\hat{\\Delta} \\pm z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\hat{\\Delta})\n$$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$ 分位数。此置信区间的总宽度 $W$ 是其上界和下界之差：\n$$\nW = (\\hat{\\Delta} + z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\hat{\\Delta})) - (\\hat{\\Delta} - z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\hat{\\Delta})) = 2 \\cdot z_{1-\\alpha/2} \\cdot \\mathrm{SE}(\\hat{\\Delta})\n$$\n代入标准误的表达式，我们推导出样本量和置信区间宽度之间的关系：\n$$\nW = 2 \\cdot z_{1-\\alpha/2} \\cdot \\sigma\\sqrt{\\frac{2}{n}}\n$$\n这个方程将统计精确性的概念形式化。置信区间宽度 $W$ 由置信水平（$1-\\alpha$，通过 $z_{1-\\alpha/2}$）、结果变异性（$\\sigma$）和每组的样本量（$n$）决定。问题指定了一个基于精确性的样本量计算，要求实现的宽度 $W$ 不大于目标宽度 $W^{\\star} = 6$ $\\mathrm{mmHg}$。给定的置信水平为 $0.95$。\n\n区分统计精确性与临床相关性这两个概念至关重要。临床相关性由量 $\\delta^{\\star} = 5$ $\\mathrm{mmHg}$ 编码，它代表被认为具有临床意义的治疗效果的大小。这个值将用于基于统计功效的样本量计算（即，确保在效应存在时有高概率检测到它），但它不是此处所要求的基于精确性的计算的一部分。\n\n为了求得所需的样本量，我们将 $W$ 设置为目标宽度 $W^{\\star}$，然后解出参与者人数。更方便的做法是首先求解总分析样本量 $N_{analysis} = 2n$。由于 $n = N_{analysis}/2$，我们可以将标准误重写为 $\\mathrm{SE}(\\hat{\\Delta}) = \\sigma\\sqrt{2/(N_{analysis}/2)} = \\sigma\\sqrt{4/N_{analysis}} = 2\\sigma/\\sqrt{N_{analysis}}$。\n宽度变为：\n$$\nW^{\\star} = 2 \\cdot z_{1-\\alpha/2} \\cdot \\frac{2\\sigma}{\\sqrt{N_{analysis}}} = \\frac{4 \\cdot z_{1-\\alpha/2} \\cdot \\sigma}{\\sqrt{N_{analysis}}}\n$$\n求解 $N_{analysis}$：\n$$\n\\sqrt{N_{analysis}} = \\frac{4 \\cdot z_{1-\\alpha/2} \\cdot \\sigma}{W^{\\star}} \\implies N_{analysis} = \\left(\\frac{4 \\cdot z_{1-\\alpha/2} \\cdot \\sigma}{W^{\\star}}\\right)^2\n$$\n现在我们将给定的值代入这个推导出的公式中：\n- 目标置信区间宽度：$W^{\\star} = 6$ $\\mathrm{mmHg}$。\n- 共同标准差：$\\sigma = 12$ $\\mathrm{mmHg}$。\n- 置信水平：$1-\\alpha = 0.95$，因此 $\\alpha = 0.05$。所需的分位数是 $z_{1-0.05/2} = z_{0.975}$，对于标准正态分布，其值约为 $1.96$。\n\n$$\nN_{analysis} = \\left(\\frac{4 \\cdot 1.96 \\cdot 12}{6}\\right)^2 = \\left(4 \\cdot 1.96 \\cdot 2\\right)^2 = (15.68)^2 = 245.8624\n$$\n这是为达到期望的置信区间宽度所需的拥有完整数据的最少参与者人数。\n\n问题陈述预计有比例为 $d = 0.15$ 的参与者将失访。为了考虑到这一点，我们必须招募更多的参与者 $N_{enroll}$，使得在人员流失后剩余的人数至少为 $N_{analysis}$。\n可用于分析的参与者人数为 $N_{enroll} \\cdot (1-d)$。我们需要：\n$$\nN_{enroll} \\cdot (1-d) \\ge N_{analysis}\n$$\n求解 $N_{enroll}$：\n$$\nN_{enroll} \\ge \\frac{N_{analysis}}{1-d} = \\frac{245.8624}{1-0.15} = \\frac{245.8624}{0.85} \\approx 289.25\n$$\n由于招募的参与者人数必须是整数，我们必须对这个值取上整以满足不等式。$N_{enroll}$ 的最小整数值为 $290$。这个总招募人数可以平均分配到两个组，每组 $145$ 名参与者，满足等比例分配的约束。",
            "answer": "$$\n\\boxed{290}\n$$"
        }
    ]
}