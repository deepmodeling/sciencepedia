{
    "hands_on_practices": [
        {
            "introduction": "在医学研究中，一项基本任务是规划研究的规模以确保其结论具有足够的精度。本练习将理论知识（二项分布和中心极限定理）与实践相结合，引导你推导出一个用于确定所需样本量的实用公式。掌握这项技能对于设计可靠的流行病学调查和临床试验至关重要。",
            "id": "4980500",
            "problem": "某个医院系统正计划进行一项横断面血清阳性率研究，以估计目标人群中针对某种新型病原体的抗体真实阳性率 $p$。设 $X$ 表示在一个大小为 $n$ 的简单随机样本中的血清阳性个体数，并将阳性率的估计量定义为 $\\hat{p} = X/n$。假设 $X$ 的数据生成机制服从二项分布，并且研究团队将基于 $\\hat{p}$ 使用正态近似来为 $p$ 构建一个双侧 $(1-\\alpha)$ 置信区间 (CI)。该团队为置信区间指定了所需的误差范围 $m$，其定义为区间的半宽。\n\n请仅使用二项分布的基本性质、误差范围的定义以及一个基于中心极限定理 (CLT) 的有效大样本近似，推导并给出一个用于计算最小样本量 $n$（作为一个实值函数）的闭式表达式，该样本量是在置信水平 $1-\\alpha$ 下达到指定误差范围 $m$ 所需的，并且该表达式仅用 $p$、$m$ 和 $\\alpha$ 表示。你的最终答案必须是一个关于 $n$ 的单一解析表达式。无需进行取整。",
            "solution": "在尝试提供解决方案之前，将首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n#### 步骤 1：提取已知条件\n从问题陈述中逐字提取的已知条件如下：\n- 真实抗体阳性率：$p$\n- 血清阳性个体数：$X$\n- 样本量：$n$\n- 阳性率估计量：$\\hat{p} = X/n$\n- $X$ 的数据生成机制：二项分布，即 $X \\sim \\text{Binomial}(n,p)$\n- 置信区间构建方法：正态近似\n- 置信水平：$1-\\alpha$\n- 误差范围（置信区间的半宽）：$m$\n- 目标：推导最小样本量 $n$ 的闭式表达式，该表达式为 $p$、$m$ 和 $\\alpha$ 的实值函数。\n\n#### 步骤 2：使用提取的已知条件进行验证\n根据所提供的已知条件评估问题的有效性。\n\n- **科学依据（关键）**：该问题在根本上是合理的。它描述了生物统计学和流行病学中用于规划研究的标准且广泛应用的程序。对于简单随机样本，使用二项分布来建模固定次数独立试验中的阳性结果数是合适的。应用中心极限定理 (CLT) 来证明样本比例的抽样分布的正态近似是有效的，这是大样本统计推断的基石。\n- **适定性**：该问题是适定的。它提供了一个明确的目标（推导 $n$ 的表达式）和实现该目标所需的所有必要组成部分（$p, m, \\alpha$ 和统计框架）。推导过程会得出一个唯一的解析解。\n- **客观性（关键）**：该问题是以精确、客观和形式化的科学语言陈述的，没有任何主观性或模糊性。\n\n该问题未表现出说明中列出的任何缺陷（例如，科学上不合理、信息缺失、条件不切实际、模糊不清）。它是统计理论中一个经典的、可形式化的问题。\n\n#### 步骤 3：结论与行动\n问题被判定为**有效**。现在将提供一个完整的、有理有据的解决方案。\n\n### 样本量公式推导\n\n目标是推导出一个表达式，用于计算在指定的误差范围 $m$ 和置信水平 $1-\\alpha$ 下，估计总体阳性率 $p$ 所需的最小样本量 $n$。\n\n1.  **估计量的性质**：\n    随机变量 $X$ 代表大小为 $n$ 的样本中的血清阳性个体数，根据题意其服从二项分布，$X \\sim \\text{Binomial}(n, p)$。阳性率的估计量为 $\\hat{p} = X/n$。\n\n    估计量 $\\hat{p}$ 的期望值（均值）是：\n    $$E[\\hat{p}] = E\\left[\\frac{X}{n}\\right] = \\frac{1}{n}E[X]$$\n    已知二项随机变量的均值为 $np$，我们有：\n    $$E[\\hat{p}] = \\frac{1}{n}(np) = p$$\n    这表明 $\\hat{p}$ 是 $p$ 的一个无偏估计量。\n\n    估计量 $\\hat{p}$ 的方差是：\n    $$\\text{Var}(\\hat{p}) = \\text{Var}\\left(\\frac{X}{n}\\right) = \\frac{1}{n^2}\\text{Var}(X)$$\n    已知二项随机变量的方差为 $np(1-p)$，我们有：\n    $$\\text{Var}(\\hat{p}) = \\frac{1}{n^2}(np(1-p)) = \\frac{p(1-p)}{n}$$\n    该估计量的标准差，即标准误 (SE)，是方差的平方根：\n    $$\\text{SE}(\\hat{p}) = \\sqrt{\\frac{p(1-p)}{n}}$$\n\n2.  **正态近似与置信区间构建**：\n    问题指定使用正态近似，对于大样本量 $n$，这可由中心极限定理来证明是合理的。$\\hat{p}$ 的抽样分布可以近似为一个正态分布：\n    $$\\hat{p} \\approx \\mathcal{N}\\left(p, \\frac{p(1-p)}{n}\\right)$$\n    真实阳性率 $p$ 的一个置信水平为 $1-\\alpha$ 的双侧置信区间构建如下：\n    $$\\text{CI} = \\text{estimator} \\pm (\\text{critical value}) \\times (\\text{standard error})$$\n    对于正态近似，临界值从标准正态分布 $Z \\sim \\mathcal{N}(0,1)$ 中获得。设 $z_{1-\\alpha/2}$ 为临界值，使得标准正态曲线下 $-z_{1-\\alpha/2}$ 和 $z_{1-\\alpha/2}$ 之间的面积为 $1-\\alpha$。那么置信区间由下式给出：\n    $$\\text{CI} = \\hat{p} \\pm z_{1-\\alpha/2} \\cdot \\text{SE}(\\hat{p})$$\n    代入真实标准误的表达式（这在假定 $p$ 已知的规划阶段是合适的）：\n    $$\\text{CI} = \\hat{p} \\pm z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}$$\n\n3.  **误差范围与样本量计算**：\n    误差范围 $m$ 定义为置信区间的半宽。从置信区间的结构中，我们可以确定误差范围为：\n    $$m = z_{1-\\alpha/2} \\sqrt{\\frac{p(1-p)}{n}}$$\n    我们的目标是解出该方程中的 $n$。我们进行代数运算。首先，将方程两边平方：\n    $$m^2 = (z_{1-\\alpha/2})^2 \\left(\\sqrt{\\frac{p(1-p)}{n}}\\right)^2$$\n    $$m^2 = (z_{1-\\alpha/2})^2 \\frac{p(1-p)}{n}$$\n    接下来，我们分离出 $n$。将方程两边同乘以 $n$：\n    $$n \\cdot m^2 = (z_{1-\\alpha/2})^2 p(1-p)$$\n    最后，两边同除以 $m^2$ 以获得 $n$ 的表达式：\n    $$n = \\frac{(z_{1-\\alpha/2})^2 p(1-p)}{m^2}$$\n    这就是所需的最小样本量 $n$（作为一个实值函数）的闭式表达式，该表达式仅由真实阳性率 $p$、期望的误差范围 $m$ 和置信水平 $1-\\alpha$（它决定了临界值 $z_{1-\\alpha/2}$）来表示。",
            "answer": "$$\\boxed{\\frac{(z_{1-\\alpha/2})^2 p(1-p)}{m^2}}$$"
        },
        {
            "introduction": "虽然泊松分布是计数数据的标准模型，但真实的医学数据往往表现出比模型假设更大的变异性（即“过度离散”现象）。本练习探讨了一种强大的建模技术——泊松-伽马混合模型，并从中推导出负二项分布，为分析此类复杂数据提供了更灵活的工具。通过这个过程，你将学会如何诊断并处理数据分析中的一个常见挑战。",
            "id": "4980516",
            "problem": "一家医院监测一个大病区连续 $n$ 周的住院患者跌倒事件的每周计数。由于患者构成和人员配备水平的波动，每周的事件发生率在各周之间是异质的。一位流行病学家提出了以下生成模型：在给定一个潜在一率 $\\Lambda$ 的条件下，每周的计数 $Y$ 服从均值为 $\\Lambda$ 的泊松分布；而在各周之间，潜在一率 $\\Lambda$ 根据形状参数为 $k$、尺度参数为 $\\theta$ 的伽马分布而变化，其均值为 $\\mu = k \\theta$。假设各周是独立的。\n\n从这些假设以及泊松分布和伽马分布的基本定义出发，推导 $Y$ 的边际概率质量函数，并用参数 $(k,\\mu)$ 表示。然后，将独立观测值 $y_1,\\dots,y_n$ 的对数似然函数 $\\ell(k,\\mu \\mid y_1,\\dots,y_n)$ 写成仅关于 $k$ 和 $\\mu$ 的函数。\n\n医院提供了以下 $n=12$ 周的观测周计数：\n$$\n4,\\ 9,\\ 7,\\ 12,\\ 3,\\ 11,\\ 0,\\ 8,\\ 14,\\ 5,\\ 6,\\ 10.\n$$\n使用矩估计法（MoM）原理，将推导出的边际分布的理论均值和方差与经验均值和经验总体方差 $s^2 = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\bar{y})^2$ 相等，从而获得离散参数 $k$ 的矩估计量。根据所提供的数据计算其数值。将最终的数值估计四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "该问题经评估有效。它在科学上基于标准的统计理论（泊松-伽马混合模型），问题设定良好，目标明确，信息充分，并以客观语言表述，没有任何事实不符或含糊之处。因此，我们可以着手解答。\n\n该问题要求基于一个关于每周跌倒事件计数 $Y$ 的分层模型进行几项推导。该模型假设，在给定潜在一率 $\\Lambda$ 的条件下，计数 $Y$ 服从泊松分布，而率 $\\Lambda$ 本身服从伽马分布。\n\n1.  **推导 $Y$ 的边际概率质量函数 (PMF)**\n\n给定率 $\\Lambda = \\lambda$ 时，计数 $Y$ 的条件分布是泊松分布：\n$$P(Y=y \\mid \\Lambda=\\lambda) = \\frac{\\lambda^y \\exp(-\\lambda)}{y!}, \\quad \\text{for } y \\in \\{0, 1, 2, \\dots\\}$$\n假设率 $\\Lambda$ 服从形状参数为 $k$、尺度参数为 $\\theta$ 的伽马分布，记作 $\\Lambda \\sim \\text{Gamma}(k, \\theta)$。$\\Lambda$ 的概率密度函数 (PDF) 是：\n$$f_{\\Lambda}(\\lambda) = \\frac{1}{\\Gamma(k)\\theta^k} \\lambda^{k-1} \\exp(-\\lambda/\\theta), \\quad \\text{for } \\lambda > 0$$\n$Y$ 的边际 PMF 是通过将 $Y$ 的条件 PMF 和 $\\Lambda$ 的 PDF 的乘积对 $\\lambda$ 的所有可能值进行积分得到的：\n$$P(Y=y) = \\int_{0}^{\\infty} P(Y=y \\mid \\Lambda=\\lambda) f_{\\Lambda}(\\lambda) \\,d\\lambda$$\n代入泊松 PMF 和伽马 PDF 的表达式：\n$$P(Y=y) = \\int_{0}^{\\infty} \\frac{\\lambda^y \\exp(-\\lambda)}{y!} \\cdot \\frac{1}{\\Gamma(k)\\theta^k} \\lambda^{k-1} \\exp(-\\lambda/\\theta) \\,d\\lambda$$\n我们可以重新整理各项，分离出关于 $\\lambda$ 的积分：\n$$P(Y=y) = \\frac{1}{y! \\Gamma(k) \\theta^k} \\int_{0}^{\\infty} \\lambda^{y+k-1} \\exp\\left(-\\lambda\\left(1 + \\frac{1}{\\theta}\\right)\\right) \\,d\\lambda$$\n$$P(Y=y) = \\frac{1}{y! \\Gamma(k) \\theta^k} \\int_{0}^{\\infty} \\lambda^{(y+k)-1} \\exp\\left(-\\frac{\\lambda}{\\frac{\\theta}{1+\\theta}}\\right) \\,d\\lambda$$\n该积分是伽马分布的核。已知此积分的值为 $\\Gamma(y+k) \\left(\\frac{\\theta}{1+\\theta}\\right)^{y+k}$。\n将此结果代回，我们得到：\n$$P(Y=y) = \\frac{1}{y! \\Gamma(k) \\theta^k} \\cdot \\Gamma(y+k) \\left(\\frac{\\theta}{1+\\theta}\\right)^{y+k}$$\n这个表达式可以简化为：\n$$P(Y=y) = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\frac{\\theta^{y+k}}{\\theta^k (1+\\theta)^{y+k}} = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\left(\\frac{\\theta}{1+\\theta}\\right)^y \\left(\\frac{1}{1+\\theta}\\right)^k$$\n这是负二项分布的 PMF，通常使用广义二项式系数 $\\binom{n}{k} = \\frac{\\Gamma(n+1)}{k!\\Gamma(n-k+1)}$ 来表示。具体来说，由于 $\\binom{y+k-1}{y} = \\frac{\\Gamma(y+k)}{y!\\Gamma(k)}$，我们有：\n$$P(Y=y) = \\binom{y+k-1}{y} \\left(\\frac{1}{1+\\theta}\\right)^k \\left(\\frac{\\theta}{1+\\theta}\\right)^y$$\n\n2.  **重新参数化与对数似然函数**\n\n问题要求用参数 $(k, \\mu)$ 来表示 PMF，其中 $\\mu = k\\theta$ 是伽马分布的均值。我们将 $\\theta = \\mu/k$ 代入 PMF：\n$$1+\\theta = 1 + \\frac{\\mu}{k} = \\frac{k+\\mu}{k} \\implies \\frac{1}{1+\\theta} = \\frac{k}{k+\\mu}$$\n$$\\frac{\\theta}{1+\\theta} = \\frac{\\mu/k}{(k+\\mu)/k} = \\frac{\\mu}{k+\\mu}$$\n将这些代入 PMF 得到：\n$$P(Y=y; k, \\mu) = \\frac{\\Gamma(y+k)}{y! \\Gamma(k)} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^y$$\n对于独立观测值 $y_1, y_2, \\dots, y_n$，似然函数是各个概率的乘积：\n$$L(k, \\mu \\mid y_1, \\dots, y_n) = \\prod_{i=1}^{n} P(Y=y_i; k, \\mu) = \\prod_{i=1}^{n} \\left[ \\frac{\\Gamma(y_i+k)}{y_i! \\Gamma(k)} \\left(\\frac{k}{k+\\mu}\\right)^k \\left(\\frac{\\mu}{k+\\mu}\\right)^{y_i} \\right]$$\n对数似然函数 $\\ell(k, \\mu \\mid y_1, \\dots, y_n) = \\ln(L)$ 是各个概率对数的和：\n$$\\ell(k, \\mu \\mid y_1, \\dots, y_n) = \\sum_{i=1}^{n} \\left[ \\ln(\\Gamma(y_i+k)) - \\ln(y_i!) - \\ln(\\Gamma(k)) + k\\ln\\left(\\frac{k}{k+\\mu}\\right) + y_i\\ln\\left(\\frac{\\mu}{k+\\mu}\\right) \\right]$$\n这可以写成：\n$$\\ell(k, \\mu \\mid y_1, \\dots, y_n) = \\sum_{i=1}^{n} \\ln(\\Gamma(y_i+k)) - \\sum_{i=1}^{n} \\ln(y_i!) - n\\ln(\\Gamma(k)) + nk\\ln(k) - nk\\ln(k+\\mu) + \\left(\\sum_{i=1}^{n} y_i\\right) (\\ln(\\mu) - \\ln(k+\\mu))$$\n这就是作为 $k$ 和 $\\mu$ 的函数的对数似然函数。\n\n3.  **矩估计法 (MoM) 估计**\n\n为了找到 $k$ 的矩估计量，我们首先需要 $Y$ 的边际分布的理论均值和方差。我们使用全期望定律和全方差定律。\n$Y$ 的均值是：\n$$E[Y] = E[E[Y \\mid \\Lambda]] = E[\\Lambda]$$\n由于 $\\Lambda \\sim \\text{Gamma}(k, \\theta)$ 且均值为 $\\mu = k\\theta$，我们有 $E[Y] = \\mu$。\n$Y$ 的方差是：\n$$Var(Y) = E[Var(Y \\mid \\Lambda)] + Var(E[Y \\mid \\Lambda])$$\n对于泊松分布，$Var(Y \\mid \\Lambda) = \\Lambda$ 且 $E[Y \\mid \\Lambda] = \\Lambda$。因此：\n$$Var(Y) = E[\\Lambda] + Var(\\Lambda)$$\n$\\text{Gamma}(k, \\theta)$ 分布的方差是 $k\\theta^2$。所以：\n$$Var(Y) = k\\theta + k\\theta^2$$\n我们通过代入 $\\theta = \\mu/k$ 将其表示为 $\\mu$ 和 $k$ 的函数：\n$$Var(Y) = k\\left(\\frac{\\mu}{k}\\right) + k\\left(\\frac{\\mu}{k}\\right)^2 = \\mu + k\\frac{\\mu^2}{k^2} = \\mu + \\frac{\\mu^2}{k}$$\n矩估计法将这些理论矩与相应的经验矩相等。经验均值是 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$，经验总体方差是 $s^2 = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\bar{y})^2$。\n矩估计方程是：\n1.  $\\hat{\\mu}_{MoM} = \\bar{y}$\n2.  $\\hat{\\sigma}^2_{MoM} = s^2 = \\hat{\\mu}_{MoM} + \\frac{\\hat{\\mu}_{MoM}^2}{\\hat{k}_{MoM}}$\n\n从第二个方程，我们求解 $k$ 的矩估计量，记作 $\\hat{k}_{MoM}$：\n$$s^2 = \\bar{y} + \\frac{\\bar{y}^2}{\\hat{k}_{MoM}} \\implies s^2 - \\bar{y} = \\frac{\\bar{y}^2}{\\hat{k}_{MoM}}$$\n$$\\hat{k}_{MoM} = \\frac{\\bar{y}^2}{s^2 - \\bar{y}}$$\n注意，为了使该估计量为正，样本方差 $s^2$ 必须大于样本均值 $\\bar{y}$，这种情况被称为过度离散（相对于方差等于均值的泊松模型）。\n\n4.  **数值计算**\n\n所提供的数据是 $n=12$ 周的周计数：\n$$y = (4, 9, 7, 12, 3, 11, 0, 8, 14, 5, 6, 10)$$\n首先，我们计算样本均值 $\\bar{y}$：\n$$\\sum_{i=1}^{12} y_i = 4+9+7+12+3+11+0+8+14+5+6+10 = 89$$\n$$\\bar{y} = \\frac{89}{12}$$\n接下来，我们计算样本总体方差 $s^2$。我们首先求平方和：\n$$\\sum_{i=1}^{12} y_i^2 = 16+81+49+144+9+121+0+64+196+25+36+100 = 841$$\n$$s^2 = \\frac{1}{n} \\sum_{i=1}^{n} y_i^2 - \\bar{y}^2 = \\frac{841}{12} - \\left(\\frac{89}{12}\\right)^2 = \\frac{841 \\times 12 - 89^2}{144} = \\frac{10092 - 7921}{144} = \\frac{2171}{144}$$\n样本方差 $s^2 \\approx 15.076$ 确实大于样本均值 $\\bar{y} \\approx 7.417$，因此数据存在过度离散。\n现在我们可以计算 $k$ 的矩估计值：\n$$\\hat{k}_{MoM} = \\frac{\\bar{y}^2}{s^2 - \\bar{y}} = \\frac{\\left(\\frac{89}{12}\\right)^2}{\\frac{2171}{144} - \\frac{89}{12}} = \\frac{\\frac{7921}{144}}{\\frac{2171 - (89 \\times 12)}{144}} = \\frac{7921}{2171 - 1068} = \\frac{7921}{1103}$$\n$$\\hat{k}_{MoM} \\approx 7.18132366...$$\n四舍五入到四位有效数字，离散参数 $k$ 的矩估计值为 $7.181$。",
            "answer": "$$\\boxed{7.181}$$"
        },
        {
            "introduction": "虽然正态近似在许多情况下是强大的工具，但它们并非普遍适用，尤其是在处理医学监测中常见的稀有事件时。本练习旨在锻炼你的批判性思维，识别正态近似失效的场景。你将学习并应用“精确方法”（如Clopper-Pearson区间和Fisher精确检验），这些方法是在处理稀疏数据时确保结论有效性的黄金标准。",
            "id": "4980553",
            "problem": "一个医院质量监控项目旨在评估罕见的术后并发症。在一个队列中，每位患者发生脓毒症的概率被认为极小。在一个固定的時期内，研究人员收集了以下数据：在接受新预防性方案的 $n_1=400$ 名患者中，有 $x_1=2$ 名出现了脓毒症；在同期接受标准护理的对照组队列 $n_0=400$ 名患者中，有 $x_0=6$ 名出现了脓毒症。在另一项独立的输液安全审计中，一个肿瘤中心在 $T=2500$ 次独立输液中观察到 $k=1$ 例过敏性休克，并使用泊松过程对输液次数进行建模。\n\n一位分析师建议使用正态近似来对二项分布比例和泊松分布率进行假设检验和构建置信区间 (CI)。您必须评估这些正态近似在何种情况以及为何会因极端概率或稀疏计数而失效，并且必须使用精确方法提出科学合理的修正方案。\n\n您的推理应基于以下基础且被广泛接受的定义和事实：\n- 如果 $X \\sim \\mathrm{Binomial}(n,p)$，则其概率质量函数为 $P(X=x)=\\binom{n}{x}p^{x}(1-p)^{n-x}$，适用于 $x\\in\\{0,1,\\dots,n\\}$，并且 $E[X]=np$，$\\mathrm{Var}(X)=np(1-p)$。\n- 如果 $Y \\sim \\mathrm{Poisson}(\\lambda)$，则其概率质量函数为 $P(Y=y)=e^{-\\lambda}\\lambda^{y}/y!$，适用于 $y\\in\\{0,1,2,\\dots\\}$，并且 $E[Y]=\\lambda$，$\\mathrm{Var}(Y)=\\lambda$。\n- 中心极限定理 (CLT) 指出，在满足某些正则性条件的前提下，随着项数的增加，经过适当标准化的独立同分布随机变量之和在分布上收敛于正态分布。\n\n以下哪些陈述正确地指出了上述情况下正态近似的失效模式，并提出了适当的精确方法补救措施？请选择所有适用项。\n\nA. 对于 $p$ 接近 $0$ 或 $1$ 的 $X\\sim \\mathrm{Binomial}(n,p)$，当 $n\\hat{p}(1-\\hat{p})$ 很小时，样本比例的抽样分布的正态近似会失效，例如在 $\\hat{p}=x_1/n_1=2/400$ 的情况下；此时应使用精确二项检验和通过反转二项累积分布函数获得的精确二项置信区间（例如 Clopper–Pearson 区间）。\nB. 只要 $n\\hat{p}\\ge 5$ 或 $n(1-\\hat{p})\\ge 5$，单独使用连续性校正就能使正态近似变得可接受；因此，对于 $\\hat{p}=6/400$ 的对照组队列，正态近似是可接受的。\nC. 对于具有稀疏计数的 $Y\\sim \\mathrm{Poisson}(\\lambda)$，例如观察到 $k=1$ 个事件且期望计数 $\\lambda$ 接近 $0$ 时，使用均值为 $\\lambda$ 和方差为 $\\lambda$ 的正态近似是不可靠的；应通过反转泊松累积分布函数来获得精确的单样本泊松检验和置信区间。\nD. 当使用基于正态分布的二项置信区间时，将 $\\hat{p}$ 替换为调整后的估计量 $\\tilde{p}=\\dfrac{\\hat{p}+2/n}{1+4/n}$，可以确保对所有的 $n$ 和 $p$ 都具有精确的覆盖率。\nE. 在具有罕见事件和固定边际的 $2\\times 2$ 列联表中，Fisher 精确检验提供了一种检验比例相等性的精确方法，而无需依赖渐近正态近似；它适用于比较 $n_1=400$ 中的 $x_1=2$ 与 $n_0=400$ 中的 $x_0=6$ 的情况。\nF. 当在二项样本中观察到 $x=0$ 个事件时，正态近似会失效，因为 $\\hat{p}(1-\\hat{p})=0$，但转换为在 logit 标度 $\\mathrm{logit}(\\hat{p})$ 上进行正态近似总是能为真实值 $p$ 产生精确的覆盖率。",
            "solution": "### 问题验证\n\n#### 步骤 1：提取已知条件\n\n-   脓毒症数据（预防性方案队列）：$n_1=400$ 名患者，$x_1=2$ 例脓毒症病例。\n-   脓毒症数据（对照组队列）：$n_0=400$ 名患者，$x_0=6$ 例脓毒症病例。\n-   输液安全数据：在 $T=2500$ 次独立输液中发生 $k=1$ 例过敏性休克事件。输液计数的模型是泊松过程。\n-   二项分布定义：对于 $X \\sim \\mathrm{Binomial}(n,p)$，$P(X=x)=\\binom{n}{x}p^{x}(1-p)^{n-x}$，$E[X]=np$，$\\mathrm{Var}(X)=np(1-p)$。\n-   泊松分布定义：对于 $Y \\sim \\mathrm{Poisson}(\\lambda)$，$P(Y=y)=e^{-\\lambda}\\lambda^{y}/y!$，$E[Y]=\\lambda$，$\\mathrm{Var}(Y)=\\lambda$。\n-   中心极限定理 (CLT) 被陈述为正态近似的基础。\n\n#### 步骤 2：使用提取的已知条件进行验证\n\n1.  **科学依据充分**：该问题基于计数数据和比例分析的标准统计理论，这是生物统计学和流行病学的基本组成部分。问题场景（术后并发症、输液安全）是现实的医疗监视情境。二项分布和泊松分布的定义是正确的。引用中心极限定理作为正态近似的理论基础是恰当的。\n2.  **问题定义明确**：问题要求评估关于正态近似的有效性和精确方法效用的陈述。所提供的数据足以评估这些统计概念。问题的结构旨在测试对统计原理的理解，并且可以确定一组明确的正确/错误陈述。\n3.  **客观性**：语言精确客观。它呈现了数据和标准的统计定义，没有偏见或主观论断。任务是基于这些客观事实来评估陈述。\n4.  **未检测到其他缺陷**：该问题并非不完整、矛盾、不现实、定义不善、无聊或超出科学可验证范围。数据值（如低事件计数 $2$、$6$、$1$）是特意选择的，旨在探讨渐近统计方法的已知局限性，这是一个标准的教学目标。\n\n#### 步骤 3：结论与行动\n\n问题陈述是**有效的**。这是一个在应用统计学中定义明确的问题。我现在将通过评估每个选项来给出解答。\n\n### 解题推导\n\n问题的核心是评估当事件概率极低（或极高）或观测计数稀疏时，离散分布（二项分布、泊松分布）的正态近似的失效情况。在这些情况下，分布是高度偏态的，违反了正态分布所假设的对称性。\n\n**A. 对于 $p$ 接近 $0$ 或 $1$ 的 $X\\sim \\mathrm{Binomial}(n,p)$，当 $n\\hat{p}(1-\\hat{p})$ 很小时，样本比例的抽样分布的正态近似会失效，例如在 $\\hat{p}=x_1/n_1=2/400$ 的情况下；此时应使用精确二项检验和通过反转二项累积分布函数获得的精确二项置信区间（例如 Clopper–Pearson 区间）。**\n\n-   **分析**：二项分布的正态近似是由 De Moivre-Laplace 定理（中心极限定理的一个特例）证明的。评估此近似是否充分的一个常用经验法则是，期望成功次数 $np$ 和期望失败次数 $n(1-p)$ 都应足够大（例如，$\\geq 5$ 或 $\\geq 10$）。当 $p$ 接近 $0$ 或 $1$ 时，除非 $n$ 非常大，否则二项分布是高度偏态的。在本例中，$\\hat{p}_1 = x_1/n_1 = 2/400 = 0.005$。观测到的成功次数为 $x_1=2$。估计的期望成功次数是 $n_1\\hat{p}_1 = 2$，低于常用的阈值 $5$。$n\\hat{p}(1-\\hat{p})$ 是计数 $X$ 的估计方差，其值为 $400(0.005)(0.995) = 1.99$。这个小值表明抽样分布高度偏态，对称的正态近似效果不佳。建议的补救措施是使用“精确”方法。Clopper-Pearson 区间是通过找到 $p_L$ 和 $p_U$ 来构造的，使得 $P(X \\ge x | p_U) = \\alpha/2$ 和 $P(X \\le x | p_L) = \\alpha/2$，这涉及到反转二项累积分布函数（CDF）。这种方法被称为“精确”方法，因为它直接使用二项分布，并保证对所有 $p$ 值，覆盖概率至少为 $1-\\alpha$。该陈述准确地描述了失效模式和标准的正确补救措施。\n-   **结论**：**正确**。\n\n**B. 只要 $n\\hat{p}\\ge 5$ 或 $n(1-\\hat{p})\\ge 5$，单独使用连续性校正就能使正态近似变得可接受；因此，对于 $\\hat{p}=6/400$ 的对照组队列，正态近似是可接受的。**\n\n-   **分析**：这个陈述有两个主要缺陷。首先，正态近似的经验法则是 $n\\hat{p}$ **和** $n(1-\\hat{p})$ 都必须足够大，而不是“$n\\hat{p} \\ge 5$ **或** $n(1-\\hat{p}) \\ge 5$”。使用“或”是不正确的。举一个反例，如果 $x=0$，那么 $\\hat{p}=0$，所以 $n\\hat{p}=0$。然而，$n(1-\\hat{p})=n$，对于大的 $n$ 这将满足“或”条件，但当 $x=0$ 时正态近似是非常不准确的。其次，对于对照组队列，$n_0=400$，$x_0=6$。因此 $\\hat{p}_0 = 6/400 = 0.015$。成功次数是 $n_0\\hat{p}_0 = 6$，失败次数是 $n_0(1-\\hat{p}_0) = 394$。虽然 $6$ 达到了阈值 $5$，但它仍然是一个小数，并且比例的潜在分布是偏态的。连续性校正是一种改进，但它不能完全解决偏度问题，声称近似变得“可接受”是言过其實的。更精确的方法（例如，Wilson score、Agresti-Coull 或精确方法）是更可取的。然而，主要的错误是准则中的“或”。\n-   **结论**：**错误**。\n\n**C. 对于具有稀疏计数的 $Y\\sim \\mathrm{Poisson}(\\lambda)$，例如观察到 $k=1$ 个事件且期望计数 $\\lambda$ 接近 $0$ 时，使用均值为 $\\lambda$ 和方差为 $\\lambda$ 的正态近似是不可靠的；应通过反转泊松累积分布函数来获得精确的单样本泊松检验和置信区间。**\n\n-   **分析**：泊松分布的正态近似 $Y \\sim \\mathrm{N}(\\lambda, \\lambda)$ 在 $\\lambda$ 较大时有效。对于输液安全审计，我们观察到 $k=1$ 个事件。参数 $\\lambda$（该时期内的期望事件数）的最大似然估计是 $\\hat{\\lambda}=1$。一个 $\\lambda=1$ 的泊松分布是高度偏态的：$P(Y=0) \\approx 0.368$，$P(Y=1) \\approx 0.368$，$P(Y=2) \\approx 0.184$。这与对称的钟形正态曲线相去甚远。因此，正态近似确实是不可靠的。建议的补救措施是“精确”方法，与二项分布情况类似，它涉及反转泊松 CDF 以找到置信限 $\\lambda_L$ 和 $\\lambda_U$。具体来说，对于观测值 $k$ 和置信水平 $1-\\alpha$，区间由方程 $P(Y \\ge k | \\lambda=\\lambda_L) = \\alpha/2$ 和 $P(Y \\le k | \\lambda=\\lambda_U) = \\alpha/2$ 导出。这是在计数较小时获取泊松参数置信区间的标准且理论上合理的过程。\n-   **结论**：**正确**。\n\n**D. 当使用基于正态分布的二项置信区间时，将 $\\hat{p}$ 替换为调整后的估计量 $\\tilde{p}=\\dfrac{\\hat{p}+2/n}{1+4/n}$，可以确保对所有的 $n$ 和 $p$ 都具有精确的覆盖率。**\n\n-   **分析**：估计量 $\\tilde{p}=\\dfrac{\\hat{p}+2/n}{1+4/n} = \\dfrac{x/n+2/n}{1+4/n} = \\dfrac{x+2}{n+4}$。使用此估计量的基于正态分布的区间是 Agresti-Coull 区间。虽然该区间已被证明具有出色的性能，其平均覆盖概率非常接近名义水平，但它不提供“精确”覆盖率。“精确覆盖率”一词意味着对于任何给定的真实 $p$，覆盖概率都恰好是 $1-\\alpha$。任何基于对离散分布（二项分布）的连续近似（正态分布）的区间都无法实现这一点。任何此类区间的覆盖概率都会随 $p$ 的变化而波动。即使是 Clopper-Pearson“精确”区间也没有精确的覆盖率；它是保守的，意味着其覆盖率保证 $\\ge 1-\\alpha$，但并非恰好等于 $1-\\alpha$。声称 Agresti-Coull 区间对“所有 $n$ 和 $p$”都提供“精确覆盖率”是错误的。\n-   **结论**：**错误**。\n\n**E. 在具有罕见事件和固定边际的 $2\\times 2$ 列联表中，Fisher 精确检验提供了一种检验比例相等性的精确方法，而无需依赖渐近正态近似；它适用于比较 $n_1=400$ 中的 $x_1=2$ 与 $n_0=400$ 中的 $x_0=6$ 的情况。**\n\n-   **分析**：两个队列之间的比较可以用一个 $2\\times 2$ 列联表来表示，表中包含脓毒症/无脓毒症与方案/对照组的计数。计数分别为 $(x_1, n_1-x_1)$ 和 $(x_0, n_0-x_0)$，即 $(2, 398)$ 和 $(6, 394)$。Fisher 精确检验就是为这类表格设计的。它计算在给定边际总和（行总和 $400, 400$；列总和 $8, 792$）的条件下，观察到当前表格以及所有其他更极端表格的概率。这个概率是使用超几何分布计算的。该方法之所以是“精确”的，是因为它不依赖任何大样本近似，比如卡方分布（其本身就基于正态近似）。在 $2\\times 2$ 表的假设检验中，它是金标准，尤其是当事件计数很小（如此处的 $2$ 和 $6$），导致卡方近似不太可靠时。因此，该陈述为这一特定比较正确地指出了合适的精确方法。\n-   **结论**：**正确**。\n\n**F. 当在二项样本中观察到 $x=0$ 个事件时，正态近似会失效，因为 $\\hat{p}(1-\\hat{p})=0$，但转换为在 logit 标度 $\\mathrm{logit}(\\hat{p})$ 上进行正态近似总是能为真实值 $p$ 产生精确的覆盖率。**\n\n-   **分析**：陈述的第一部分是正确的。当 $x=0$ 时，$\\hat{p}=0$，标准 Wald 区间 $\\hat{p} \\pm z_{\\alpha/2}\\sqrt{\\hat{p}(1-\\hat{p})/n}$ 会坍缩为点 $[0,0]$，这是无意义的。正态近似会灾难性地失效。第二部分提出了一个补救措施：对 $\\mathrm{logit}(\\hat{p})$ 使用正态近似。然而，$\\mathrm{logit}(\\hat{p}) = \\log(\\hat{p}/(1-\\hat{p}))$。如果 $\\hat{p}=0$，$\\mathrm{logit}(0)$ 未定义（$\\mathrm{logit}(\\hat{p})$ 的方差估计量也未定义）。因此，所述方法甚至无法应用。虽然存在一些变通方法（例如，给 $x$ 和 $n-x$ 加上一个小的常数如 $0.5$），但得到的区间仍然是一个近似值。声称它“总是产生精确的覆盖率”是错误的，原因与选项 D 相同：没有基于连续近似的离散参数区间可以对所有参数值都具有精确的覆盖率。\n-   **结论**：**错误**。\n\n### 正确选项总结\n陈述 A、C 和 E 正确地指出了在稀疏数据背景下正态近似的失效情况，并提出了适当的、理论上合理的“精确”补救措施。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}