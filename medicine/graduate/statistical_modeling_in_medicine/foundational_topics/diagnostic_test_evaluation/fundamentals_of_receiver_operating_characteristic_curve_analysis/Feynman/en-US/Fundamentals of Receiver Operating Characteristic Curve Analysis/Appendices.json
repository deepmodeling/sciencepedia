{
    "hands_on_practices": [
        {
            "introduction": "This first exercise tackles a fundamental task in diagnostic medicine: selecting an optimal threshold for a continuous biomarker. We will use Youden's index, a popular metric that maximizes the vertical distance between the ROC curve and the chance line, effectively balancing sensitivity and specificity. By deriving the optimal threshold from the underlying normal distributions of the healthy and diseased populations , you will solidify your understanding of how performance metrics are intrinsically linked to the probabilistic models of the data.",
            "id": "4963858",
            "problem": "A continuous diagnostic biomarker $X$ is used to detect a disease in a cohort. The decision rule classifies an individual as test-positive if $X \\ge t$ for some threshold $t \\in \\mathbb{R}$. In this cohort, the conditional distribution of $X$ given non-disease is normal with mean $\\mu_{0}$ and variance $\\sigma_{0}^{2}$, and the conditional distribution of $X$ given disease is normal with mean $\\mu_{1}$ and variance $\\sigma_{1}^{2}$. Specifically, suppose $X \\mid (D=0) \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$ with $\\mu_{0}=5$ and $\\sigma_{0}=1.5$, and $X \\mid (D=1) \\sim \\mathcal{N}(\\mu_{1},\\sigma_{1}^{2})$ with $\\mu_{1}=8$ and $\\sigma_{1}=2$. For any threshold $t$, define the true positive rate $\\mathrm{TPR}(t) = \\mathbb{P}(X \\ge t \\mid D=1)$, the false positive rate $\\mathrm{FPR}(t) = \\mathbb{P}(X \\ge t \\mid D=0)$, and Youden’s index $J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$, which is a functional of the receiver operating characteristic (ROC) curve.\n\nStarting only from these core definitions and the stated distributional assumptions, derive the threshold $t^{\\star}$ that maximizes Youden’s index $J(t)$ and compute its numerical value for the given parameters. Do not assume equal variances or invoke any unproven shortcuts. Round your final numerical answer to four significant figures. Express your answer as the optimal threshold value $t^{\\star}$ (no units).",
            "solution": "The problem is to find the threshold $t^{\\star}$ that maximizes Youden's index, $J(t)$, for a diagnostic test based on a continuous biomarker $X$.\n\nFirst, we validate the problem statement.\n**Step 1: Extract Givens**\n- Biomarker: $X$\n- Decision rule: Test-positive if $X \\ge t$.\n- Distribution for non-diseased individuals ($D=0$): $X \\mid (D=0) \\sim \\mathcal{N}(\\mu_{0},\\sigma_{0}^{2})$, where $\\mu_{0}=5$ and $\\sigma_{0}=1.5$.\n- Distribution for diseased individuals ($D=1$): $X \\mid (D=1) \\sim \\mathcal{N}(\\mu_{1},\\sigma_{1}^{2})$, where $\\mu_{1}=8$ and $\\sigma_{1}=2$.\n- True Positive Rate: $\\mathrm{TPR}(t) = \\mathbb{P}(X \\ge t \\mid D=1)$.\n- False Positive Rate: $\\mathrm{FPR}(t) = \\mathbb{P}(X \\ge t \\mid D=0)$.\n- Youden’s Index: $J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing standard definitions and models from statistical decision theory and biostatistics (Normal distribution, ROC analysis, Youden's index). It is well-posed, as it asks to maximize a well-defined, continuous, and differentiable function. The problem is objective, self-contained, and consistent, providing all necessary parameters and definitions. The parameter values are realistic. The task is non-trivial, requiring derivation and calculation, particularly because the variances are not equal. The problem is mathematically verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. We may proceed with the solution.\n\nThe goal is to find $t^{\\star} = \\arg\\max_{t} J(t)$. We begin by expressing $J(t)$ in an analytical form.\nLet $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution, $\\mathcal{N}(0,1)$. The probability of a normal random variable $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$ being greater than or equal to a value $t$ is given by:\n$$ \\mathbb{P}(Y \\ge t) = 1 - \\mathbb{P}(Y < t) = 1 - \\Phi\\left(\\frac{t-\\mu}{\\sigma}\\right) $$\nUsing this, we can define the $\\mathrm{TPR}(t)$ and $\\mathrm{FPR}(t)$ for the given distributions.\n\nFor the diseased population, $X_1 \\sim \\mathcal{N}(\\mu_1, \\sigma_1^2)$:\n$$ \\mathrm{TPR}(t) = \\mathbb{P}(X \\ge t \\mid D=1) = 1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right) $$\nFor the non-diseased population, $X_0 \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$:\n$$ \\mathrm{FPR}(t) = \\mathbb{P}(X \\ge t \\mid D=0) = 1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right) $$\nNow, we can write the expression for Youden's index, $J(t)$:\n$$ J(t) = \\mathrm{TPR}(t) - \\mathrm{FPR}(t) = \\left(1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right)\\right) - \\left(1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right)\\right) $$\n$$ J(t) = \\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right) - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right) $$\nTo find the threshold $t$ that maximizes $J(t)$, we compute its derivative with respect to $t$ and set it to zero. Let $\\phi(z)$ be the probability density function (PDF) of the standard normal distribution, which is the derivative of its CDF, $\\frac{d\\Phi(z)}{dz} = \\phi(z)$. Using the chain rule:\n$$ \\frac{dJ}{dt} = \\frac{d}{dt}\\left[\\Phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right)\\right] - \\frac{d}{dt}\\left[\\Phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right)\\right] $$\n$$ \\frac{dJ}{dt} = \\phi\\left(\\frac{t-\\mu_0}{\\sigma_0}\\right) \\cdot \\frac{1}{\\sigma_0} - \\phi\\left(\\frac{t-\\mu_1}{\\sigma_1}\\right) \\cdot \\frac{1}{\\sigma_1} $$\nThe term $\\frac{1}{\\sigma} \\phi\\left(\\frac{t-\\mu}{\\sigma}\\right)$ is the PDF of a general normal distribution $\\mathcal{N}(\\mu, \\sigma^2)$, which we denote as $f(t; \\mu, \\sigma^2)$. So, we can write the derivative as:\n$$ \\frac{dJ}{dt} = f(t; \\mu_0, \\sigma_0^2) - f(t; \\mu_1, \\sigma_1^2) $$\nSetting the derivative to zero to find the critical points $t^{\\star}$:\n$$ f(t^{\\star}; \\mu_0, \\sigma_0^2) = f(t^{\\star}; \\mu_1, \\sigma_1^2) $$\nThis result signifies that the optimal threshold for Youden's index is the value of $t$ where the probability density functions of the two classes intersect. Now we solve this equation for $t^{\\star}$.\n$$ \\frac{1}{\\sigma_0\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t^{\\star}-\\mu_0)^2}{2\\sigma_0^2}\\right) = \\frac{1}{\\sigma_1\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t^{\\star}-\\mu_1)^2}{2\\sigma_1^2}\\right) $$\nTaking the natural logarithm of both sides:\n$$ \\ln\\left(\\frac{1}{\\sigma_0}\\right) - \\frac{(t^{\\star}-\\mu_0)^2}{2\\sigma_0^2} = \\ln\\left(\\frac{1}{\\sigma_1}\\right) - \\frac{(t^{\\star}-\\mu_1)^2}{2\\sigma_1^2} $$\nRearranging the terms yields:\n$$ \\frac{(t^{\\star}-\\mu_1)^2}{2\\sigma_1^2} - \\frac{(t^{\\star}-\\mu_0)^2}{2\\sigma_0^2} = \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right) $$\nMultiplying by $2\\sigma_0^2\\sigma_1^2$ to clear the denominators:\n$$ \\sigma_0^2(t^{\\star}-\\mu_1)^2 - \\sigma_1^2(t^{\\star}-\\mu_0)^2 = 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right) $$\nExpanding the squared terms:\n$$ \\sigma_0^2(t^{\\star 2} - 2\\mu_1 t^{\\star} + \\mu_1^2) - \\sigma_1^2(t^{\\star 2} - 2\\mu_0 t^{\\star} + \\mu_0^2) = 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right) $$\nGrouping terms by powers of $t^{\\star}$, we obtain a quadratic equation $At^{\\star 2} + Bt^{\\star} + C = 0$:\n$$ (\\sigma_0^2 - \\sigma_1^2)t^{\\star 2} + 2(\\mu_0\\sigma_1^2 - \\mu_1\\sigma_0^2)t^{\\star} + (\\mu_1^2\\sigma_0^2 - \\mu_0^2\\sigma_1^2 - 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right)) = 0 $$\nThe coefficients are:\n$A = \\sigma_0^2 - \\sigma_1^2$\n$B = 2(\\mu_0\\sigma_1^2 - \\mu_1\\sigma_0^2)$\n$C = \\mu_1^2\\sigma_0^2 - \\mu_0^2\\sigma_1^2 - 2\\sigma_0^2\\sigma_1^2 \\ln\\left(\\frac{\\sigma_0}{\\sigma_1}\\right)$\n\nNow, we substitute the given numerical values: $\\mu_{0}=5$, $\\sigma_{0}=1.5$, $\\mu_{1}=8$, $\\sigma_{1}=2$.\n$\\sigma_0^2 = (1.5)^2 = 2.25$\n$\\sigma_1^2 = (2)^2 = 4$\n\n$A = 2.25 - 4 = -1.75$\n$B = 2(5 \\cdot 4 - 8 \\cdot 2.25) = 2(20 - 18) = 4$\n$C = 8^2 \\cdot 2.25 - 5^2 \\cdot 4 - 2(2.25)(4) \\ln\\left(\\frac{1.5}{2}\\right) = 64 \\cdot 2.25 - 25 \\cdot 4 - 18 \\ln(0.75)$\n$C = 144 - 100 - 18 \\ln(0.75) = 44 - 18 \\ln(0.75)$\n\nUsing $\\ln(0.75) \\approx -0.28768$:\n$C \\approx 44 - 18(-0.28768) \\approx 44 + 5.17824 = 49.17824$\n\nThe quadratic equation for $t^{\\star}$ is:\n$$ -1.75t^{\\star 2} + 4t^{\\star} + 49.17824 = 0 $$\nWe solve for $t^{\\star}$ using the quadratic formula $t^{\\star} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$:\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{4^2 - 4(-1.75)(49.17824)}}{2(-1.75)}$\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{16 + 7(49.17824)}}{-3.5}$\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{16 + 344.24768}}{-3.5}$\n$t^{\\star} = \\frac{-4 \\pm \\sqrt{360.24768}}{-3.5}$\n$t^{\\star} = \\frac{-4 \\pm 18.98019}{-3.5}$\n\nThis gives two solutions:\n$t_1^{\\star} = \\frac{-4 + 18.98019}{-3.5} = \\frac{14.98019}{-3.5} \\approx -4.28005$\n$t_2^{\\star} = \\frac{-4 - 18.98019}{-3.5} = \\frac{-22.98019}{-3.5} \\approx 6.56577$\n\nSince the means of the non-diseased and diseased populations are $\\mu_0 = 5$ and $\\mu_1 = 8$ respectively, with the diseased population having a higher mean biomarker value, the optimal threshold $t^{\\star}$ is expected to lie between these two values. The solution $t_1^{\\star} \\approx -4.28$ is not medically or statistically meaningful in this context. The solution $t_2^{\\star} \\approx 6.566$ lies between $5$ and $8$. A formal analysis of the second derivative of $J(t)$ would confirm that $t_2^{\\star}$ corresponds to a maximum and $t_1^{\\star}$ corresponds to a minimum of Youden's Index. Thus, the optimal threshold is $t^{\\star} = t_2^{\\star}$.\n\nRounding the result to four significant figures:\n$t^{\\star} \\approx 6.566$",
            "answer": "$$\\boxed{6.566}$$"
        },
        {
            "introduction": "While Youden's index provides a statistically grounded optimum, clinical decisions often hinge on economic and epidemiological factors. This practice moves beyond purely statistical criteria by incorporating the prevalence of the disease and the specific costs associated with false negative and false positive results. Your task is to derive the threshold that minimizes the overall expected cost of testing , demonstrating how decision theory provides a powerful framework for tailoring diagnostic strategies to real-world contexts.",
            "id": "4963859",
            "problem": "A medical screening test outputs a continuous diagnostic score $S \\in \\mathbb{R}$. In a target clinical population, the disease indicator $D \\in \\{0,1\\}$ has prevalence $P(D=1)=\\pi$ with $\\pi \\in (0,1)$. You adopt a threshold rule: declare $D=1$ (disease present) if and only if $S \\ge \\tau$, where $\\tau \\in \\mathbb{R}$ is a threshold to be chosen. The receiver operating characteristic (ROC) curve is induced by varying $\\tau$.\n\nAssume the following class-conditional distributions for the score:\n- Conditional on disease, $S \\mid D=1 \\sim \\mathcal{N}(\\mu_{1},\\sigma^{2})$.\n- Conditional on no disease, $S \\mid D=0 \\sim \\mathcal{N}(\\mu_{0},\\sigma^{2})$.\n\nHere $\\mu_{1},\\mu_{0} \\in \\mathbb{R}$, $\\sigma > 0$, and $\\mu_{1} > \\mu_{0}$.\n\nAssign decision costs consistent with a one-step screening decision: a false negative (missed disease) incurs cost $c_{\\mathrm{FN}}>0$, a false positive (unnecessary follow-up) incurs cost $c_{\\mathrm{FP}}>0$, and correct decisions have zero cost. Let the expected cost per screened individual be defined in terms of the threshold $\\tau$ via the joint distribution of $(S,D)$, using the standard definitions of sensitivity and specificity that underlie the receiver operating characteristic (ROC) curve.\n\nStarting only from the fundamental definitions of expected cost under misclassification and the above distributional assumptions, derive the closed-form expression for the threshold $\\tau^{\\star}$ that minimizes the expected cost as a function of $\\mu_{0}$, $\\mu_{1}$, $\\sigma$, $c_{\\mathrm{FN}}$, $c_{\\mathrm{FP}}$, and $\\pi$. Express your final answer as a single simplified algebraic expression in these symbols. No numerical evaluation is required and no rounding is permitted. The final answer must be a single symbolic mathematical expression.",
            "solution": "We begin from the definitions that connect binary classification performance to the receiver operating characteristic (ROC) curve and expected cost. For a threshold $\\tau \\in \\mathbb{R}$, the rule classifies $D=1$ if and only if $S \\ge \\tau$. The false negative probability is $P(S<\\tau \\mid D=1)$ and the false positive probability is $P(S \\ge \\tau \\mid D=0)$. With prevalence $P(D=1)=\\pi$ and $P(D=0)=1-\\pi$, and costs $c_{\\mathrm{FN}}>0$ and $c_{\\mathrm{FP}}>0$ for false negative and false positive decisions respectively, the expected cost per individual as a function of $\\tau$ is\n$$\nR(\\tau) \\;=\\; c_{\\mathrm{FN}} \\,\\pi \\,P(S<\\tau \\mid D=1) \\;+\\; c_{\\mathrm{FP}} \\,(1-\\pi)\\,P(S\\ge \\tau \\mid D=0).\n$$\nUnder the assumed Gaussian models, denote the class-conditional cumulative distribution functions (CDF) by\n$$\nF_{1}(\\tau) \\;=\\; P(S \\le \\tau \\mid D=1) \\;=\\; \\Phi\\!\\left(\\frac{\\tau-\\mu_{1}}{\\sigma}\\right), \\qquad\nF_{0}(\\tau) \\;=\\; P(S \\le \\tau \\mid D=0) \\;=\\; \\Phi\\!\\left(\\frac{\\tau-\\mu_{0}}{\\sigma}\\right),\n$$\nwhere $\\Phi$ is the standard normal CDF. Then $P(S<\\tau \\mid D=1)=F_{1}(\\tau)$, and $P(S\\ge\\tau \\mid D=0)=1-F_{0}(\\tau)$. The expected cost becomes\n$$\nR(\\tau) \\;=\\; c_{\\mathrm{FN}}\\,\\pi\\,F_{1}(\\tau) \\;+\\; c_{\\mathrm{FP}}\\,(1-\\pi)\\,\\bigl(1-F_{0}(\\tau)\\bigr).\n$$\nTo minimize $R(\\tau)$ over $\\tau$, we differentiate with respect to $\\tau$ and set the derivative equal to zero. The derivative of a cumulative distribution function is its density, so with class-conditional densities\n$$\nf_{1}(\\tau) \\;=\\; \\frac{1}{\\sigma}\\,\\varphi\\!\\left(\\frac{\\tau-\\mu_{1}}{\\sigma}\\right), \\qquad\nf_{0}(\\tau) \\;=\\; \\frac{1}{\\sigma}\\,\\varphi\\!\\left(\\frac{\\tau-\\mu_{0}}{\\sigma}\\right),\n$$\nwhere $\\varphi$ is the standard normal density, we have\n$$\n\\frac{d}{d\\tau}R(\\tau) \\;=\\; c_{\\mathrm{FN}}\\,\\pi\\,f_{1}(\\tau) \\;-\\; c_{\\mathrm{FP}}\\,(1-\\pi)\\,f_{0}(\\tau).\n$$\nA stationary point $\\tau^{\\star}$ satisfies\n$$\nc_{\\mathrm{FN}}\\,\\pi\\,f_{1}(\\tau^{\\star}) \\;=\\; c_{\\mathrm{FP}}\\,(1-\\pi)\\,f_{0}(\\tau^{\\star}).\n$$\nRearranging gives the likelihood ratio condition\n$$\n\\frac{f_{1}(\\tau^{\\star})}{f_{0}(\\tau^{\\star})} \\;=\\; \\frac{c_{\\mathrm{FP}}\\,(1-\\pi)}{c_{\\mathrm{FN}}\\,\\pi}.\n$$\nBecause $f_{1}$ and $f_{0}$ are Gaussian densities with equal variance, the left-hand side is a strictly increasing function of $\\tau$ (since $\\mu_{1}>\\mu_{0}$), ensuring a unique solution that minimizes $R(\\tau)$.\n\nWe now compute $f_{1}(\\tau)/f_{0}(\\tau)$ explicitly. The class-conditional densities are\n$$\nf_{1}(s) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(s-\\mu_{1})^{2}}{2\\sigma^{2}}\\right), \\qquad\nf_{0}(s) \\;=\\; \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{(s-\\mu_{0})^{2}}{2\\sigma^{2}}\\right).\n$$\nThus,\n$$\n\\ln\\!\\left(\\frac{f_{1}(s)}{f_{0}(s)}\\right) \\;=\\; -\\frac{(s-\\mu_{1})^{2}}{2\\sigma^{2}} + \\frac{(s-\\mu_{0})^{2}}{2\\sigma^{2}}\n\\;=\\; \\frac{(\\mu_{1}-\\mu_{0})}{\\sigma^{2}}\\,s \\;-\\; \\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2\\sigma^{2}}.\n$$\nSetting $s=\\tau^{\\star}$ and equating to $\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right)$ yields\n$$\n\\frac{(\\mu_{1}-\\mu_{0})}{\\sigma^{2}}\\,\\tau^{\\star} \\;-\\; \\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2\\sigma^{2}} \\;=\\; \\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right).\n$$\nSolving for $\\tau^{\\star}$ gives\n$$\n\\tau^{\\star} \\;=\\; \\frac{\\sigma^{2}}{\\mu_{1}-\\mu_{0}}\\,\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right) \\;+\\; \\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2(\\mu_{1}-\\mu_{0})}.\n$$\nRecognizing that $\\frac{\\mu_{1}^{2}-\\mu_{0}^{2}}{2(\\mu_{1}-\\mu_{0})}=\\frac{\\mu_{1}+\\mu_{0}}{2}$, we obtain the simplified closed form\n$$\n\\tau^{\\star} \\;=\\; \\frac{\\mu_{1}+\\mu_{0}}{2} \\;+\\; \\frac{\\sigma^{2}}{\\mu_{1}-\\mu_{0}}\\,\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right).\n$$\nThis $\\tau^{\\star}$ uniquely minimizes the expected cost $R(\\tau)$ given the specified Gaussian score model, prevalence $\\pi$, and misclassification costs, and corresponds geometrically to the point on the receiver operating characteristic (ROC) curve where the tangent slope equals $\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}$.",
            "answer": "$$\\boxed{\\frac{\\mu_{1}+\\mu_{0}}{2}+\\frac{\\sigma^{2}}{\\mu_{1}-\\mu_{0}}\\ln\\!\\left(\\frac{c_{\\mathrm{FP}}(1-\\pi)}{c_{\\mathrm{FN}}\\pi}\\right)}$$"
        },
        {
            "introduction": "The overall performance of a diagnostic test, often summarized by the total Area Under the Curve (AUC), may not always be the most relevant measure. In many scenarios, such as population screening, performance in the low false-positive rate region is paramount. This final exercise introduces the concept of the partial AUC (pAUC) as a tool for this focused evaluation, even incorporating a weight function to reflect clinical priorities . By working with a non-normal (exponential) biomarker model, you will also see how ROC principles generalize beyond the classic binormal case.",
            "id": "4963883",
            "problem": "In a case-control study evaluating a continuous, positive-valued serum biomarker for early detection of a disease, suppose the biomarker level $S$ is modeled as exponentially distributed in both populations: $S \\mid D=1 \\sim \\text{Exp}(\\lambda_{1})$ in diseased ($D=1$) and $S \\mid D=0 \\sim \\text{Exp}(\\lambda_{0})$ in non-diseased ($D=0$), where $\\text{Exp}(\\lambda)$ denotes the exponential distribution with rate parameter $\\lambda$ and support $[0,\\infty)$. The test classifies an individual as positive if $S \\geq c$ for threshold $c \\geq 0$. The Receiver Operating Characteristic (ROC) curve is defined as the locus of pairs $\\big(\\text{FPR}(c), \\text{TPR}(c)\\big)$ as $c$ varies over $[0,\\infty)$, where the false positive rate is $\\text{FPR}(c) = \\mathbb{P}(S \\geq c \\mid D=0)$ and the true positive rate is $\\text{TPR}(c) = \\mathbb{P}(S \\geq c \\mid D=1)$.\n\nA clinical guideline places emphasis on the low false positive rate regime, specifically $\\text{FPR} \\in [0,\\alpha]$ with $\\alpha = 0.1$, and adopts the weight function $w(u) = u^{r}(1-u)^{s}$ on the false positive rate $u$, with $r = \\tfrac{1}{2}$ and $s = 2$, to reflect higher importance near $u=0$ while tapering near $u=\\alpha$. Define the normalized weighted partial area under the ROC curve on $[0,\\alpha]$ as\n$$\n\\text{W-pAUC}(\\alpha; w) \\equiv \\frac{\\displaystyle \\int_{0}^{\\alpha} \\text{ROC}(u)\\, w(u)\\, \\mathrm{d}u}{\\displaystyle \\int_{0}^{\\alpha} w(u)\\, \\mathrm{d}u},\n$$\nwhere $\\text{ROC}(u)$ is the true positive rate expressed as a function of the false positive rate $u$.\n\nTake $\\lambda_{1} = 0.7$ and $\\lambda_{0} = 1.4$. Starting only from the definitions of $\\text{FPR}(c)$ and $\\text{TPR}(c)$ for the exponential model and the definition of the ROC curve as $\\text{TPR}$ versus $\\text{FPR}$ across thresholds, derive the functional form of $\\text{ROC}(u)$ for this model and compute the normalized weighted partial area $\\text{W-pAUC}(0.1; w)$ with the given $w(u)$, expressing the final numerical value. Round your answer to four significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of statistical modeling and receiver operating characteristic (ROC) analysis, is well-posed with all necessary definitions and parameters provided, and is expressed objectively without ambiguity. The task is to compute a normalized weighted partial area under the ROC curve (W-pAUC) for a biomarker modeled with exponential distributions.\n\nThe solution proceeds in five steps: (1) deriving the True Positive Rate (TPR) and False Positive Rate (FPR) as functions of the diagnostic threshold $c$; (2) deriving the ROC curve by expressing TPR as a function of FPR; (3) calculating the numerator of the W-pAUC expression, which is the weighted partial area; (4) calculating the denominator, which is the integral of the weight function; and (5) computing the final ratio.\n\n**Step 1: Derive $\\text{TPR}(c)$ and $\\text{FPR}(c)$**\n\nThe biomarker level $S$ is modeled by an exponential distribution, $\\text{Exp}(\\lambda)$, which has the probability density function (PDF) $f(s; \\lambda) = \\lambda \\exp(-\\lambda s)$ for $s \\geq 0$ and the cumulative distribution function (CDF) $F(s; \\lambda) = \\mathbb{P}(S \\leq s) = 1 - \\exp(-\\lambda s)$. The probability of the biomarker exceeding a threshold $c$ is given by the survival function:\n$$ \\mathbb{P}(S \\geq c) = 1 - F(c; \\lambda) = 1 - (1 - \\exp(-\\lambda c)) = \\exp(-\\lambda c) $$\nThe False Positive Rate, $\\text{FPR}(c)$, is the probability of a positive test ($S \\geq c$) in the non-diseased population ($D=0$), which is modeled by $S \\mid D=0 \\sim \\text{Exp}(\\lambda_{0})$.\n$$ \\text{FPR}(c) = \\mathbb{P}(S \\geq c \\mid D=0) = \\exp(-\\lambda_{0} c) $$\nThe True Positive Rate, $\\text{TPR}(c)$, is the probability of a positive test ($S \\geq c$) in the diseased population ($D=1$), which is modeled by $S \\mid D=1 \\sim \\text{Exp}(\\lambda_{1})$.\n$$ \\text{TPR}(c) = \\mathbb{P}(S \\geq c \\mid D=1) = \\exp(-\\lambda_{1} c) $$\n\n**Step 2: Derive the ROC curve, $\\text{ROC}(u)$**\n\nThe ROC curve is the plot of $\\text{TPR}$ versus $\\text{FPR}$. We express $\\text{TPR}$ as a function of $\\text{FPR}$. Let $u = \\text{FPR}(c)$.\n$$ u = \\exp(-\\lambda_{0} c) $$\nTo express $\\text{TPR}$ in terms of $u$, we first solve for the threshold $c$:\n$$ \\ln(u) = -\\lambda_{0} c \\implies c = -\\frac{\\ln(u)}{\\lambda_{0}} $$\nNote that as the threshold $c$ varies from $\\infty$ to $0$, $u$ varies from $0$ to $1$.\nNow, substitute this expression for $c$ into the equation for $\\text{TPR}$:\n$$ \\text{TPR} = \\exp(-\\lambda_{1} c) = \\exp\\left(-\\lambda_{1} \\left(-\\frac{\\ln(u)}{\\lambda_{0}}\\right)\\right) = \\exp\\left(\\frac{\\lambda_{1}}{\\lambda_{0}} \\ln(u)\\right) $$\nUsing the property $\\exp(a \\ln b) = b^a$, we obtain the functional form of the ROC curve:\n$$ \\text{ROC}(u) = u^{\\lambda_{1}/\\lambda_{0}} $$\nGiven the parameter values $\\lambda_{1} = 0.7$ and $\\lambda_{0} = 1.4$, the ratio is $\\frac{\\lambda_{1}}{\\lambda_{0}} = \\frac{0.7}{1.4} = \\frac{1}{2}$.\nThus, the specific ROC curve for this model is:\n$$ \\text{ROC}(u) = u^{1/2} $$\n\n**Step 3: Calculate the numerator integral**\n\nThe numerator of the $\\text{W-pAUC}$ expression is $N = \\int_{0}^{\\alpha} \\text{ROC}(u)\\, w(u)\\, \\mathrm{d}u$.\nWe are given the weight function $w(u) = u^{r}(1-u)^{s}$ with $r = \\frac{1}{2}$ and $s=2$, so $w(u) = u^{1/2}(1-u)^2$. The upper limit of integration is $\\alpha = 0.1$.\nSubstituting the expressions for $\\text{ROC}(u)$ and $w(u)$:\n$$ N = \\int_{0}^{0.1} \\left(u^{1/2}\\right) \\left(u^{1/2}(1-u)^2\\right) \\mathrm{d}u = \\int_{0}^{0.1} u(1-u)^2 \\mathrm{d}u $$\nExpand the integrand:\n$$ N = \\int_{0}^{0.1} u(1 - 2u + u^2) \\mathrm{d}u = \\int_{0}^{0.1} (u - 2u^2 + u^3) \\mathrm{d}u $$\nPerform the integration:\n$$ N = \\left[ \\frac{1}{2}u^2 - \\frac{2}{3}u^3 + \\frac{1}{4}u^4 \\right]_{0}^{0.1} $$\nEvaluate the definite integral:\n$$ N = \\left(\\frac{1}{2}(0.1)^2 - \\frac{2}{3}(0.1)^3 + \\frac{1}{4}(0.1)^4\\right) - 0 $$\n$$ N = \\frac{1}{2}(0.01) - \\frac{2}{3}(0.001) + \\frac{1}{4}(0.0001) = 0.005 - \\frac{0.002}{3} + 0.000025 $$\n$$ N = \\frac{5}{1000} - \\frac{2}{3000} + \\frac{25}{1000000} = \\frac{1}{200} - \\frac{1}{1500} + \\frac{1}{40000} $$\nUsing a common denominator of $120000$:\n$$ N = \\frac{600}{120000} - \\frac{80}{120000} + \\frac{3}{120000} = \\frac{523}{120000} $$\n\n**Step 4: Calculate the denominator integral**\n\nThe denominator of the $\\text{W-pAUC}$ expression is $D = \\int_{0}^{\\alpha} w(u)\\, \\mathrm{d}u$.\n$$ D = \\int_{0}^{0.1} u^{1/2}(1-u)^2 \\mathrm{d}u $$\nExpand the integrand:\n$$ D = \\int_{0}^{0.1} u^{1/2}(1 - 2u + u^2) \\mathrm{d}u = \\int_{0}^{0.1} (u^{1/2} - 2u^{3/2} + u^{5/2}) \\mathrm{d}u $$\nPerform the integration:\n$$ D = \\left[ \\frac{u^{3/2}}{3/2} - 2\\frac{u^{5/2}}{5/2} + \\frac{u^{7/2}}{7/2} \\right]_{0}^{0.1} = \\left[ \\frac{2}{3}u^{3/2} - \\frac{4}{5}u^{5/2} + \\frac{2}{7}u^{7/2} \\right]_{0}^{0.1} $$\nEvaluate the definite integral:\n$$ D = \\frac{2}{3}(0.1)^{3/2} - \\frac{4}{5}(0.1)^{5/2} + \\frac{2}{7}(0.1)^{7/2} - 0 $$\n$$ D = \\frac{2}{3}(0.1)^{1.5} - \\frac{4}{5}(0.1)^{2.5} + \\frac{2}{7}(0.1)^{3.5} $$\n\n**Step 5: Compute the final ratio and round**\n\nThe normalized weighted partial AUC is the ratio $N/D$:\n$$ \\text{W-pAUC}(0.1; w) = \\frac{N}{D} = \\frac{\\frac{523}{120000}}{\\frac{2}{3}(0.1)^{1.5} - \\frac{4}{5}(0.1)^{2.5} + \\frac{2}{7}(0.1)^{3.5}} $$\nNow, we compute the numerical values.\nThe numerator is $N = \\frac{523}{120000} \\approx 0.004358333$.\nThe denominator is:\n$D \\approx \\frac{2}{3}(0.03162278) - \\frac{4}{5}(0.00316228) + \\frac{2}{7}(0.00031623)$\n$D \\approx 0.02108185 - 0.00252982 + 0.00009035 \\approx 0.01864238$\nThe final ratio is:\n$$ \\text{W-pAUC}(0.1; w) \\approx \\frac{0.004358333}{0.01864238} \\approx 0.23378531 $$\nRounding the result to four significant figures gives $0.2338$.",
            "answer": "$$\\boxed{0.2338}$$"
        }
    ]
}