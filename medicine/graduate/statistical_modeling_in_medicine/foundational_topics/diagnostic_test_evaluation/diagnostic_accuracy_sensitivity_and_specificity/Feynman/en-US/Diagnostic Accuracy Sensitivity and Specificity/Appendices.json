{
    "hands_on_practices": [
        {
            "introduction": "Understanding a diagnostic test's performance requires moving beyond its intrinsic characteristics like sensitivity and specificity. This exercise will guide you through deriving and calculating the Positive and Negative Predictive Values ($PPV$ and $NPV$), demonstrating how a test's utility is profoundly influenced by the prevalence of the disease in the target population. Mastering this connection is fundamental to correctly interpreting test results in clinical practice, especially in rare disease screening scenarios .",
            "id": "4959511",
            "problem": "A hospital is piloting a blood-based screening assay for a rare hereditary cardiomyopathy in an asymptomatic adult population. Let the disease prevalence be $\\pi$, and suppose the assay has sensitivity $Se$ and specificity $Sp$. Consider a single screening round where every individual is tested once and the interpretation is based on a dichotomous test result (positive or negative).\n\nYou are given scientifically validated operating characteristics from an independent clinical validation study applied to a population similar to the pilot setting: sensitivity $Se = 0.92$, specificity $Sp = 0.985$, and disease prevalence $\\pi = 0.0015$. Using only core definitions of sensitivity, specificity, prevalence, Positive Predictive Value (PPV), and Negative Predictive Value (NPV), together with first principles of probability, derive from these primitives the analytic expressions for PPV and NPV in terms of $Se$, $Sp$, and $\\pi$, and then evaluate them for the given values. In addition, provide a brief clinical interpretation of the resulting PPV and NPV in the context of a rare disease where $\\pi \\ll 1$.\n\nExpress the final PPV and NPV as decimal numbers, rounded to four significant figures. Do not use a percentage sign in your answer. The final answer must present PPV and NPV in a single row vector.",
            "solution": "The problem asks for the derivation and calculation of the Positive Predictive Value ($PPV$) and Negative Predictive Value ($NPV$) for a medical screening assay, followed by a clinical interpretation. The derivation must proceed from first principles of probability and core definitions.\n\nFirst, let us define the relevant events based on the problem statement:\n- Let $D$ be the event that a randomly selected individual from the population has the disease (hereditary cardiomyopathy).\n- Let $D^c$ be the complementary event that the individual does not have the disease.\n- Let $T^+$ be the event that the screening assay yields a positive result.\n- Let $T^-$ be the event that the screening assay yields a negative result.\n\nThe given parameters are formally defined as conditional and unconditional probabilities:\n- The disease prevalence is $\\pi = P(D)$. The probability of not having the disease is therefore $P(D^c) = 1 - \\pi$.\n- The sensitivity of the assay is $Se = P(T^+ | D)$. This is the probability of a positive test given the individual has the disease.\n- The specificity of the assay is $Sp = P(T^- | D^c)$. This is the probability of a negative test given the individual does not have the disease.\n\nFrom these definitions, we can also define the probabilities of incorrect test results:\n- The false positive rate is the probability of a positive test given the individual does not have the disease: $P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp$.\n- The false negative rate is the probability of a negative test given the individual has the disease: $P(T^- | D) = 1 - P(T^+ | D) = 1 - Se$.\n\n**Derivation of the Positive Predictive Value ($PPV$)**\n\nThe $PPV$ is defined as the probability that an individual has the disease given a positive test result, which is the conditional probability $P(D | T^+)$. We derive its expression using Bayes' theorem:\n$$PPV = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}$$\nThe term in the denominator, $P(T^+)$, represents the overall probability of receiving a positive test result in the population. We can express $P(T^+)$ using the law of total probability, by conditioning on the disease status (whether an individual has the disease or not):\n$$P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c)$$\nUsing the definition of conditional probability, $P(A \\cap B) = P(A|B)P(B)$, we can write:\n$$P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)$$\nSubstituting the given definitions of $Se$, $Sp$, and $\\pi$ into this expression:\n$$P(T^+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)$$\nThe term $(Se)(\\pi)$ is the probability of a true positive result, and the term $(1 - Sp)(1 - \\pi)$ is the probability of a false positive result.\nBy substituting this expression for $P(T^+)$ back into the formula for $PPV$, we obtain the final analytic expression:\n$$PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)}$$\n\n**Derivation of the Negative Predictive Value ($NPV$)**\n\nThe $NPV$ is defined as the probability that an individual is disease-free given a negative test result, which is the conditional probability $P(D^c | T^-)$. We derive its expression similarly using Bayes' theorem:\n$$NPV = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}$$\nThe denominator, $P(T^-)$, is the overall probability of a negative test result. We expand this using the law of total probability:\n$$P(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)$$\nSubstituting the definitions of $Se$, $Sp$, and $\\pi$:\n$$P(T^-) = (Sp)(1 - \\pi) + (1 - Se)(\\pi)$$\nThe term $(Sp)(1 - \\pi)$ is the probability of a true negative, and the term $(1 - Se)(\\pi)$ is the probability of a false negative.\nSubstituting this expression for $P(T^-)$ back into the formula for $NPV$:\n$$NPV = \\frac{Sp \\cdot (1 - \\pi)}{Sp \\cdot (1 - \\pi) + (1 - Se) \\cdot \\pi}$$\n\n**Numerical Evaluation**\n\nWe are given the values: $Se = 0.92$, $Sp = 0.985$, and $\\pi = 0.0015$.\n\nWe now calculate the $PPV$:\n$$PPV = \\frac{0.92 \\cdot 0.0015}{0.92 \\cdot 0.0015 + (1 - 0.985)(1 - 0.0015)}$$\n$$PPV = \\frac{0.00138}{0.00138 + (0.015)(0.9985)}$$\n$$PPV = \\frac{0.00138}{0.00138 + 0.0149775}$$\n$$PPV = \\frac{0.00138}{0.0163575} \\approx 0.0843640$$\nRounding to four significant figures, we get $PPV = 0.08436$.\n\nNext, we calculate the $NPV$:\n$$NPV = \\frac{0.985 \\cdot (1 - 0.0015)}{0.985 \\cdot (1 - 0.0015) + (1 - 0.92) \\cdot 0.0015}$$\n$$NPV = \\frac{0.985 \\cdot 0.9985}{0.985 \\cdot 0.9985 + (0.08) \\cdot 0.0015}$$\n$$NPV = \\frac{0.9835225}{0.9835225 + 0.00012}$$\n$$NPV = \\frac{0.9835225}{0.9836425} \\approx 0.9998780$$\nRounding to four significant figures, we get $NPV = 0.9999$.\n\n**Clinical Interpretation**\n\nThe calculated $PPV$ of approximately $0.08436$ implies that for every individual who tests positive, there is only an $8.436\\%$ chance that they actually have the disease. Conversely, there is a $91.564\\%$ probability that the positive result is a false alarm. This counterintuitively low $PPV$, despite the test's high sensitivity and specificity, is a direct and well-known consequence of applying a screening test to a population where the disease is rare ($\\pi \\ll 1$). The total number of false positives generated from the large disease-free population, given by $(1 - Sp)(1 - \\pi)$, substantially outnumbers the true positives from the small diseased population, given by $Se \\cdot \\pi$. Clinically, a positive screening result should therefore not be interpreted as a diagnosis but as an indication for more definitive confirmatory testing to distinguish the few true positives from the many false positives.\n\nThe calculated $NPV$ of approximately $0.9999$ is exceptionally high. This means that an individual who tests negative is almost certain ($99.99\\%$) to be free of the disease. This high degree of certainty is extremely valuable in a screening context. For a rare disease, a test with high $NPV$ allows clinicians to confidently rule out the condition for the vast majority of the population who test negative, thus providing reassurance and preventing unnecessary anxiety and costly, invasive follow-up procedures. The high value of the $NPV$ is maintained in low-prevalence settings, making it a critical performance metric for any screening program.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.08436 & 0.9999\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The sensitivity and specificity values reported for a diagnostic test are not absolute truths but estimates derived from finite samples. This practice focuses on quantifying the uncertainty inherent in these estimates by deriving the standard error for sensitivity and constructing a confidence interval. By applying the normal approximation with a continuity correction, you will learn a standard statistical method for reporting the precision of a key diagnostic accuracy metric .",
            "id": "4959510",
            "problem": "A prospective diagnostic accuracy study enrolls a cohort of patients and verifies disease status with a gold standard. Among those with confirmed disease, each patient independently yields a positive test result with probability equal to the true sensitivity, denoted by $Se$. Let the number of true positives (TP) among diseased patients be $TP$, the number of false negatives (FN) be $FN$, and the total number of diseased patients be $n_{D} = TP + FN$. The sample estimate of sensitivity is $\\hat{Se} = \\frac{TP}{n_{D}}$.\n\nStarting only from the binomial model for $TP$ under independent trials, derive the sampling variance of $\\hat{Se}$ and the associated standard error. Then construct a large-sample two-sided confidence interval (CI) for $Se$ based on normal theory that incorporates continuity correction by adjusting the binomial count by $\\pm 0.5$ before invoking the normal approximation, and then translating the correction to the proportion scale. Explicitly state any approximations you make in moving from the exact binomial to the approximate normal-based CI.\n\nApply your result to the following data: $TP = 198$, $FN = 49$. Use a two-sided $0.95$ confidence level and the corresponding standard normal quantile $z_{1-\\alpha/2}$. Express the final CI bounds as decimals, and round both bounds to four significant figures. Report the lower and upper bounds as a single row matrix $\\begin{pmatrix}\\text{lower} & \\text{upper}\\end{pmatrix}$ with no units and no percent signs.",
            "solution": "This problem requires deriving the variance of the sample sensitivity, constructing a continuity-corrected confidence interval, and applying it to given data.\n\n**1. Derivation of Sampling Variance and Standard Error**\n\nThe number of true positives, $TP$, among $n_D$ diseased individuals is modeled as a binomial random variable with $n_D$ independent trials and a success probability of $Se$ (the true sensitivity).\n$$TP \\sim \\text{Binomial}(n_D, Se)$$\nThe variance of a binomial random variable is $\\text{Var}(TP) = n_D Se (1 - Se)$. The sample estimate of sensitivity is $\\hat{Se} = \\frac{TP}{n_D}$. Using the property that $\\text{Var}(cX) = c^2 \\text{Var}(X)$ for a constant $c$, we can find the variance of $\\hat{Se}$:\n$$\\text{Var}(\\hat{Se}) = \\text{Var}\\left(\\frac{TP}{n_D}\\right) = \\frac{1}{n_D^2} \\text{Var}(TP) = \\frac{1}{n_D^2} [n_D Se(1-Se)]$$\nThis simplifies to the sampling variance of $\\hat{Se}$:\n$$\\text{Var}(\\hat{Se}) = \\frac{Se(1 - Se)}{n_D}$$\nThe standard error of the estimate, $SE(\\hat{Se})$, is the square root of the sampling variance:\n$$SE(\\hat{Se}) = \\sqrt{\\frac{Se(1 - Se)}{n_D}}$$\n\n**2. Construction of a Large-Sample Confidence Interval**\n\nFor a sufficiently large sample size $n_D$, the sampling distribution of $\\hat{Se}$ can be approximated by a normal distribution. A confidence interval can be constructed using this approximation. The problem specifies a continuity correction to account for approximating the discrete binomial distribution with a continuous normal one. The correction term is $\\frac{1}{2n_D}$, which is added to the margin of error of the standard Wald interval. The formula for the two-sided $(1-\\alpha)$ confidence interval with this correction is:\n$$CI = \\hat{Se} \\pm \\left( z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{Se}(1-\\hat{Se})}{n_D}} + \\frac{1}{2n_D} \\right)$$\nThe main approximations in this method are (1) the use of the normal distribution to approximate the binomial distribution, and (2) the use of the sample estimate $\\hat{Se}$ in place of the true parameter $Se$ when calculating the standard error.\n\n**3. Application to Provided Data**\n\nGiven data:\n- True Positives, $TP = 198$\n- False Negatives, $FN = 49$\n- Confidence level = $0.95$\n\nFirst, calculate the required sample statistics:\n- Total diseased patients: $n_D = TP + FN = 198 + 49 = 247$\n- Sample sensitivity: $\\hat{Se} = \\frac{TP}{n_D} = \\frac{198}{247} \\approx 0.801619$\n\nFor a $95\\%$ confidence level, $\\alpha = 0.05$, and the corresponding standard normal quantile is $z_{1-\\alpha/2} = z_{0.975} \\approx 1.96$.\n\nNow, calculate the total margin of error, which includes the standard error term and the continuity correction:\n- Standard error term of the margin of error: \n$$z_{1-\\alpha/2} \\sqrt{\\frac{\\hat{Se}(1-\\hat{Se})}{n_D}} = 1.96 \\sqrt{\\frac{0.801619(1 - 0.801619)}{247}} \\approx 1.96 \\times 0.025373 \\approx 0.04973$$\n- Continuity correction term:\n$$\\frac{1}{2n_D} = \\frac{1}{2 \\times 247} = \\frac{1}{494} \\approx 0.002024$$\n- Total margin of error:\n$$M \\approx 0.04973 + 0.002024 = 0.051754$$\n\nFinally, calculate the confidence interval bounds:\n- Lower bound = $\\hat{Se} - M \\approx 0.801619 - 0.051754 = 0.749865$\n- Upper bound = $\\hat{Se} + M \\approx 0.801619 + 0.051754 = 0.853373$\n\nRounding both bounds to four significant figures gives the final result.\n- Lower bound: $0.7499$\n- Upper bound: $0.8534$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.7499 & 0.8534 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Many diagnostic tests are based on continuous biomarkers, requiring the selection of a threshold to classify results as positive or negative. This exercise introduces the Receiver Operating Characteristic (ROC) curve and Youden's index ($J$), a popular metric for choosing an optimal threshold by maximizing the balance between sensitivity and specificity. You will prove the geometric interpretation of Youden's index and derive the optimal cutoff for a common scenario involving Gaussian-distributed biomarker data .",
            "id": "4959573",
            "problem": "Consider a binary disease status variable $D \\in \\{0,1\\}$ and a continuous biomarker $X \\in \\mathbb{R}$ used to classify individuals as test-positive if $X \\geq \\tau$ for a threshold $\\tau \\in \\mathbb{R}$. Suppose the biomarker follows equal-variance Gaussian models: $X \\mid D=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$ and $X \\mid D=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$ with $\\mu_{1} > \\mu_{0}$ and $\\sigma > 0$. Define the sensitivity $\\mathrm{Se}(\\tau) = \\mathbb{P}(X \\geq \\tau \\mid D=1)$ and the specificity $\\mathrm{Sp}(\\tau) = \\mathbb{P}(X < \\tau \\mid D=0)$. The Receiver Operating Characteristic (ROC) curve is the set of points $(\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau))$ traced by varying $\\tau$, where $\\mathrm{TPR}(\\tau) = \\mathrm{Se}(\\tau)$ is the true positive rate (TPR) and $\\mathrm{FPR}(\\tau) = 1 - \\mathrm{Sp}(\\tau)$ is the false positive rate (FPR). The chance line is $y = x$ in the ROC plane. Define Youden’s index $J(\\tau) = \\mathrm{Se}(\\tau) + \\mathrm{Sp}(\\tau) - 1$. \n\nUsing only these definitions and standard properties of the Gaussian distribution, do the following:\n- Show, from first principles, that the vertical distance from the chance line to the ROC point generated by a threshold $\\tau$ equals $J(\\tau)$, and therefore that maximizing $J(\\tau)$ over $\\tau$ corresponds to maximizing the vertical distance from the chance line.\n- Derive the threshold $\\tau^{\\ast}$ that maximizes $J(\\tau)$ under the equal-variance Gaussian model, and then compute the maximum Youden’s index $J^{\\ast} = J(\\tau^{\\ast})$ for the parameter values $\\mu_{0} = 0$, $\\mu_{1} = 2$, and $\\sigma = 1$.\n\nReport the single numerical value $J^{\\ast}$ as a decimal, rounded to $4$ significant figures. Do not use a percentage sign.",
            "solution": "The solution involves two parts: a geometric proof relating Youden's index to the ROC curve, and the derivation of the optimal threshold under a Gaussian model.\n\n**1. Geometric Interpretation of Youden's Index**\n\nFirst, we show that the vertical distance from the chance line ($y=x$) to an ROC point is equal to Youden's index for the corresponding threshold $\\tau$.\nThe ROC curve is plotted on a plane where the horizontal axis is the False Positive Rate, $\\mathrm{FPR}(\\tau)$, and the vertical axis is the True Positive Rate, $\\mathrm{TPR}(\\tau)$. A point on the ROC curve is given by the coordinates $(\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau))$. The point on the chance line with the same horizontal coordinate is $(\\mathrm{FPR}(\\tau), \\mathrm{FPR}(\\tau))$. \n\nThe vertical distance, $V(\\tau)$, between these two points is the difference in their vertical coordinates:\n$$V(\\tau) = \\mathrm{TPR}(\\tau) - \\mathrm{FPR}(\\tau)$$\nUsing the provided definitions $\\mathrm{TPR}(\\tau) = \\mathrm{Se}(\\tau)$ and $\\mathrm{FPR}(\\tau) = 1 - \\mathrm{Sp}(\\tau)$, we substitute them into the expression for $V(\\tau)$:\n$$V(\\tau) = \\mathrm{Se}(\\tau) - (1 - \\mathrm{Sp}(\\tau)) = \\mathrm{Se}(\\tau) + \\mathrm{Sp}(\\tau) - 1$$\nThis is precisely the definition of Youden's index, $J(\\tau)$. Thus, we have shown that $V(\\tau) = J(\\tau)$. Maximizing Youden's index over all possible thresholds $\\tau$ is therefore equivalent to finding the point on the ROC curve that has the maximum vertical distance to the chance line.\n\n**2. Derivation of the Optimal Threshold and Maximum Youden's Index**\n\nNext, we derive the threshold $\\tau^{\\ast}$ that maximizes $J(\\tau)$ under the specified equal-variance Gaussian model. Let $\\Phi(z)$ be the cumulative distribution function (CDF) of the standard normal distribution $\\mathcal{N}(0, 1)$, and let $\\phi(z)$ be its probability density function (PDF).\n\nThe sensitivity and specificity as functions of the threshold $\\tau$ are:\n$$\\mathrm{Se}(\\tau) = \\mathbb{P}(X \\geq \\tau \\mid D=1) = \\mathbb{P}\\left(\\frac{X - \\mu_{1}}{\\sigma} \\geq \\frac{\\tau - \\mu_{1}}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)$$\n$$\\mathrm{Sp}(\\tau) = \\mathbb{P}(X < \\tau \\mid D=0) = \\mathbb{P}\\left(\\frac{X - \\mu_{0}}{\\sigma} < \\frac{\\tau - \\mu_{0}}{\\sigma}\\right) = \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right)$$\nYouden's index is then:\n$$J(\\tau) = \\mathrm{Se}(\\tau) + \\mathrm{Sp}(\\tau) - 1 = \\Phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right) - \\Phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)$$\nTo maximize $J(\\tau)$, we compute its derivative with respect to $\\tau$ and set it to zero. Using the chain rule and the fact that $\\frac{d}{dz}\\Phi(z) = \\phi(z)$:\n$$\\frac{dJ}{d\\tau} = \\frac{1}{\\sigma}\\phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right) - \\frac{1}{\\sigma}\\phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right) = 0$$\nThis implies $\\phi\\left(\\frac{\\tau - \\mu_{0}}{\\sigma}\\right) = \\phi\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right)$. Since the standard normal PDF $\\phi(z)$ is symmetric about $z=0$, this equality holds if the arguments are equal in magnitude: $|\\frac{\\tau - \\mu_{0}}{\\sigma}| = |\\frac{\\tau - \\mu_{1}}{\\sigma}|$. The non-trivial solution (since $\\mu_1 > \\mu_0$) is when one argument is the negative of the other:\n$$\\frac{\\tau - \\mu_{0}}{\\sigma} = -\\left(\\frac{\\tau - \\mu_{1}}{\\sigma}\\right) \\implies \\tau - \\mu_{0} = -\\tau + \\mu_{1} \\implies 2\\tau = \\mu_{0} + \\mu_{1}$$\nThe optimal threshold is the midpoint of the means:\n$$\\tau^{\\ast} = \\frac{\\mu_{0} + \\mu_{1}}{2}$$\nTo compute the maximum Youden's index $J^{\\ast} = J(\\tau^{\\ast})$, we substitute $\\tau^{\\ast}$ back into the expression for $J(\\tau)$:\n$$J^{\\ast} = \\Phi\\left(\\frac{(\\mu_{0} + \\mu_{1})/2 - \\mu_{0}}{\\sigma}\\right) - \\Phi\\left(\\frac{(\\mu_{0} + \\mu_{1})/2 - \\mu_{1}}{\\sigma}\\right)$$\n$$J^{\\ast} = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{2\\sigma}\\right) - \\Phi\\left(-\\frac{\\mu_{1} - \\mu_{0}}{2\\sigma}\\right)$$\nUsing the property $\\Phi(-z) = 1 - \\Phi(z)$, this simplifies to:\n$$J^{\\ast} = \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{2\\sigma}\\right) - \\left[1 - \\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{2\\sigma}\\right)\\right] = 2\\Phi\\left(\\frac{\\mu_{1} - \\mu_{0}}{2\\sigma}\\right) - 1$$\nFinally, we substitute the given parameter values $\\mu_{0} = 0$, $\\mu_{1} = 2$, and $\\sigma = 1$:\n$$\\frac{\\mu_{1} - \\mu_{0}}{2\\sigma} = \\frac{2 - 0}{2 \\times 1} = 1$$\n$$J^{\\ast} = 2\\Phi(1) - 1$$\nUsing the standard value $\\Phi(1) \\approx 0.841345$, we calculate:\n$$J^{\\ast} \\approx 2 \\times 0.841345 - 1 = 1.68269 - 1 = 0.68269$$\nRounding to $4$ significant figures, the result is $0.6827$.",
            "answer": "$$\\boxed{0.6827}$$"
        }
    ]
}