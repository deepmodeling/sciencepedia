{
    "hands_on_practices": [
        {
            "introduction": "在分析纵向数据时，即使是最简单的基线-随访设计，分析方法的选择也至关重要。本练习将探讨两种常用方法——差值分析和协方差分析（ANCOVA），并从理论上证明当基线和随访结果相关时，为何其中一种方法通常更优。通过这个推导，您将深入理解统计效率以及正确建模协方差结构对提升检验效力的重要性()。",
            "id": "4951173",
            "problem": "考虑一项随机、平行对照临床试验，该试验包含 $2$ 个组，每组样本量为 $n$。试验为每位参与者在基线（$Y_{0}$）和单次治疗后随访（$Y_{1}$）时测量一项连续性生物标志物。假设如下：\n\n- 受试者是独立同分布且被随机分配的，因此治疗指标 $X \\in \\{0,1\\}$ 与所有基线协变量（包括 $Y_{0}$）独立。\n- 数据对 $(Y_{0}, Y_{1})$ 服从二元正态分布，且其边际方差在各组间不变，为 $\\operatorname{Var}(Y_{0}) = \\sigma_{0}^{2}$，$\\operatorname{Var}(Y_{1}) = \\sigma_{1}^{2}$，相关系数为 $\\rho = \\operatorname{Corr}(Y_{0}, Y_{1})$。治疗对 $Y_{1}$ 具有加性效应，且不会改变这些方差或 $\\rho$。\n- 组内方差齐性成立，并且除了因治疗导致的 $Y_{1}$ 均值外，两组的所有量都是相同的。\n\n考虑使用两种分析策略来估计对 $Y_{1}$ 的平均治疗效应：\n\n$1.$ 变化评分法：为每个参与者计算 $D = Y_{1} - Y_{0}$，并将 $D$ 的组间均值之差作为治疗效应的估计值。\n\n$2.$ 协方差分析 (ANCOVA)：将 $Y_{1}$ 对治疗指标 $X$ 和基线值 $Y_{0}$ 进行回归，并使用 $X$ 的系数作为治疗效应的估计量。\n\n将 ANCOVA 相对于变化评分分析的效率增益定义为变化评分估计量的大样本方差与 ANCOVA 估计量的大样本方差之比。在上述假设下，推导此效率增益，并将其表示为一个以 $\\sigma_{0}^{2}$、$\\sigma_{1}^{2}$ 和 $\\rho$ 表示的封闭形式解析表达式。将你的最终答案表示为单个解析表达式。不需要数值近似或四舍五入，最终答案中不应包含任何单位。",
            "solution": "用户想要推导在随机临床试验中，用于估计治疗效应的协方差分析（ANCOVA）模型相对于变化评分分析的效率增益。效率增益定义为变化评分估计量的大样本方差与 ANCOVA 估计量的大样本方差之比。\n\n首先验证该问题，以确保其科学基础扎实、提法明确且客观。\n\n### 第一步：提取已知条件\n- 一项随机、平行对照临床试验，设有两个组，每组样本量为 $n$。\n- 在基线（$Y_{0}$）和一次治疗后随访（$Y_{1}$）时测量一个连续性生物标志物。\n- 治疗指标为 $X \\in \\{0,1\\}$。随机化意味着 $X$ 与 $Y_{0}$ 相互独立。\n- 数据对 $(Y_{0}, Y_{1})$ 服从二元正态分布。\n- 边际方差在各组间不变：$\\operatorname{Var}(Y_{0}) = \\sigma_{0}^{2}$ 和 $\\operatorname{Var}(Y_{1}) = \\sigma_{1}^{2}$。\n- 相关系数在各组间不变：$\\rho = \\operatorname{Corr}(Y_{0}, Y_{1})$。\n- 治疗对 $Y_{1}$ 具有加性效应，且不改变方差或相关系数。\n- 策略 1：对 $D = Y_{1} - Y_{0}$ 进行变化评分分析。估计量是 $D$ 的组间均值之差。\n- 策略 2：ANCOVA，将 $Y_{1}$ 对 $X$ 和 $Y_{0}$ 进行回归。估计量是 $X$ 的系数。\n- 目标：推导效率增益，定义为 $\\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) / \\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}})$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是临床试验证据统计分析中的一个标准、经典问题。诸如二元正态性、方差齐性和加性治疗效应等假设，是用于比较不同估计量统计特性的常见理想化条件。该问题是自洽的，提供了推导所要求表达式所需的所有必要信息。其语言精确、客观。不存在科学或逻辑上的缺陷、矛盾或含糊之处。\n\n### 第三步：结论与行动\n该问题是 **有效的**。将提供一个完整的、有理有据的解答。\n\n### 效率增益的推导\n\n推导过程分为三部分：首先，我们求出变化评分估计量的大样本方差；其次，我们求出 ANCOVA 估计量的大样本方差；最后，我们计算它们的比率。\n\n**1. 变化评分估计量（$\\hat{\\tau}_{\\text{CS}}$）的方差**\n\n每个参与者 $i$ 的变化评分定义为 $D_i = Y_{1i} - Y_{0i}$。治疗效应通过治疗组（$X=1$）与对照组（$X=0$）之间平均变化评分的差值来估计：\n$$ \\hat{\\tau}_{\\text{CS}} = \\bar{D}_1 - \\bar{D}_0 = \\frac{1}{n} \\sum_{i:X_i=1} D_i - \\frac{1}{n} \\sum_{i:X_i=0} D_i $$\n由于随机化，两组是独立的，因此估计量的方差是两个样本均值方差之和：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\operatorname{Var}(\\bar{D}_1) + \\operatorname{Var}(\\bar{D}_0) $$\n鉴于在每组样本量为 $n$ 的组内受试者是独立同分布的，我们有：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\frac{\\operatorname{Var}(D | X=1)}{n} + \\frac{\\operatorname{Var}(D | X=0)}{n} $$\n问题陈述方差在组间是不变的。这意味着变化评分 $D$ 的方差在两组中是相同的：$\\operatorname{Var}(D | X=1) = \\operatorname{Var}(D | X=0) = \\operatorname{Var}(D)$。因此：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\frac{2}{n} \\operatorname{Var}(D) $$\n变化评分 $D$ 的方差为：\n$$ \\operatorname{Var}(D) = \\operatorname{Var}(Y_1 - Y_0) = \\operatorname{Var}(Y_1) + \\operatorname{Var}(Y_0) - 2 \\operatorname{Cov}(Y_1, Y_0) $$\n使用给定的参数 $\\operatorname{Var}(Y_0) = \\sigma_0^2$、$\\operatorname{Var}(Y_1) = \\sigma_1^2$ 以及相关性的定义 $\\operatorname{Cov}(Y_1, Y_0) = \\rho \\sqrt{\\operatorname{Var}(Y_0)\\operatorname{Var}(Y_1)} = \\rho \\sigma_0 \\sigma_1$，我们得到：\n$$ \\operatorname{Var}(D) = \\sigma_1^2 + \\sigma_0^2 - 2 \\rho \\sigma_0 \\sigma_1 $$\n将其代回，变化评分估计量的大样本方差为：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{CS}}) = \\frac{2}{n} (\\sigma_0^2 + \\sigma_1^2 - 2 \\rho \\sigma_0 \\sigma_1) $$\n\n**2. ANCOVA 估计量（$\\hat{\\tau}_{\\text{ANCOVA}}$）的方差**\n\nANCOVA 模型是一个多元线性回归：\n$$ Y_{1i} = \\beta_0 + \\tau_{\\text{ANCOVA}} X_i + \\beta_1 Y_{0i} + \\epsilon_i $$\n估计量 $\\hat{\\tau}_{\\text{ANCOVA}}$ 是治疗指标 $X_i$ 系数的普通最小二乘（OLS）估计。回归系数的大样本方差可以使用 Frisch-Waugh-Lovell 定理找到。$\\hat{\\tau}_{\\text{ANCOVA}}$ 的方差由下式给出：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}}) = \\frac{\\sigma_\\epsilon^2}{\\sum_{i=1}^{2n} \\tilde{X}_i^2} $$\n其中 $\\sigma_\\epsilon^2 = \\operatorname{Var}(\\epsilon_i) = \\operatorname{Var}(Y_1 | X, Y_0)$ 是残差方差，$\\tilde{X}_i$ 是将 $X_i$ 对模型中其他协变量（在此情况下为截距和 $Y_{0i}$）进行回归所得的残差。\n\n首先，我们确定分母 $\\sum \\tilde{X}_i^2$。由于受试者被随机分配到治疗组，因此 $X_i$ 与基线测量值 $Y_{0i}$ 独立。因此，当 $n$ 很大时，$X_i$ 对 $Y_{0i}$ 的回归得到的斜率趋于零。残差即为 $\\tilde{X}_i \\approx X_i - \\bar{X}$。\n总样本量为 $2n$，每组有 $n$ 名受试者。治疗指标的均值为 $\\bar{X} = \\frac{n \\cdot 1 + n \\cdot 0}{2n} = \\frac{1}{2}$。残差平方和为：\n$$ \\sum_{i=1}^{2n} \\tilde{X}_i^2 \\approx \\sum_{i=1}^{2n} (X_i - \\bar{X})^2 = n \\left(1 - \\frac{1}{2}\\right)^2 + n \\left(0 - \\frac{1}{2}\\right)^2 = n \\left(\\frac{1}{4}\\right) + n \\left(\\frac{1}{4}\\right) = \\frac{n}{2} $$\n接下来，我们确定分子 $\\sigma_\\epsilon^2$。这是在给定 $X$ 和 $Y_0$ 条件下 $Y_1$ 的方差。由于治疗效应是纯粹加性的，以 $X$ 为条件不会在以 $Y_0$ 为条件的基础上进一步减小方差。因此，$\\sigma_\\epsilon^2 = \\operatorname{Var}(Y_1 | Y_0)$。对于二元正态分布，条件方差由下式给出：\n$$ \\operatorname{Var}(Y_1 | Y_0) = \\operatorname{Var}(Y_1) (1 - \\operatorname{Corr}(Y_0, Y_1)^2) $$\n代入给定参数 $\\operatorname{Var}(Y_1) = \\sigma_1^2$ 和 $\\operatorname{Corr}(Y_0, Y_1) = \\rho$：\n$$ \\sigma_\\epsilon^2 = \\sigma_1^2 (1 - \\rho^2) $$\n结合分子和分母，ANCOVA 估计量的大样本方差为：\n$$ \\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}}) = \\frac{\\sigma_1^2 (1 - \\rho^2)}{n/2} = \\frac{2 \\sigma_1^2 (1 - \\rho^2)}{n} $$\n\n**3. 效率增益**\n\nANCOVA 相对于变化评分分析的效率增益是它们方差的比率：\n$$ \\text{效率增益} = \\frac{\\operatorname{Var}(\\hat{\\tau}_{\\text{CS}})}{\\operatorname{Var}(\\hat{\\tau}_{\\text{ANCOVA}})} $$\n代入上面推导出的表达式：\n$$ \\text{效率增益} = \\frac{\\frac{2}{n} (\\sigma_0^2 + \\sigma_1^2 - 2 \\rho \\sigma_0 \\sigma_1)}{\\frac{2}{n} \\sigma_1^2 (1 - \\rho^2)} $$\n消去公因子 $\\frac{2}{n}$ 得到最终表达式：\n$$ \\text{效率增益} = \\frac{\\sigma_0^2 + \\sigma_1^2 - 2 \\rho \\sigma_0 \\sigma_1}{\\sigma_1^2 (1 - \\rho^2)} $$\n该表达式表示，在指定假设下，与变化评分分析相比，使用 ANCOVA 时治疗效应估计量方差减小的因子。",
            "answer": "$$\n\\boxed{\\frac{\\sigma_{0}^{2} + \\sigma_{1}^{2} - 2 \\rho \\sigma_{0} \\sigma_{1}}{\\sigma_{1}^{2} (1 - \\rho^{2})}}\n$$"
        },
        {
            "introduction": "在建立了处理重复测量数据需要高级模型的重要性之后，我们转向了线性混合效应模型（LMM）的核心部分：随机效应。随机效应旨在捕捉个体间的异质性，但我们如何确定数据中确实存在这种异质性，以支持使用更复杂的模型呢？本练习将指导您推导用于检验方差分量（即随机效应方差）是否为零的似然比检验（LRT），并揭示当零假设值位于参数空间边界时出现的特殊统计问题及其解决方案()。",
            "id": "4951121",
            "problem": "考虑一项对接受抗高血压治疗的成年人收缩压进行的纵向研究，该研究在多次临床访视中进行重复测量。对于患者 $i \\in \\{1,\\dots,n\\}$ 和访视 $j \\in \\{1,\\dots,m_i\\}$，设观测到的收缩压为 $Y_{ij}$。一种常用于重复测量的线性混合效应模型是随机截距模型\n$$\nY_{ij} \\;=\\; \\beta_0 \\;+\\; \\beta_1 t_{ij} \\;+\\; b_i \\;+\\; \\varepsilon_{ij},\n$$\n其中 $t_{ij}$ 是以基线为中心访视时间（单位：月），$b_i \\sim \\mathcal{N}(0,\\sigma_b^2)$ 是特定于受试者的随机截距，$\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立于 $b_i$ 的残差。将观测值堆叠成向量 $Y$，其固定效应设计矩阵为 $X$，随机效应设计矩阵为 $Z$。在标准假设下，$Y \\sim \\mathcal{N}(X\\beta, V)$，其中 $V = ZGZ^{\\top} + R$，$G = \\sigma_b^2 I_n$，$R = \\sigma^2 I_{N}$，并且 $N = \\sum_{i=1}^{n} m_i$。\n\n您感兴趣的是检验是否存在受试者间的异质性。形式上，考虑\n$$\nH_0: \\sigma_b^2 = 0 \\quad \\text{versus} \\quad H_1: \\sigma_b^2 > 0,\n$$\n其中 $\\sigma_b^2$ 是一个被约束为非负的方差分量。从广义最大似然框架和多元正态似然的性质出发，推导在这种边界情况下检验 $H_0$ 与 $H_1$ 的似然比检验 (LRT) 统计量，并基于得分函数和费雪信息的首要原则渐近理论，证明在 $H_0$ 下 LRT 的正确参考分布。\n\n假设对一个包含 $n$ 名患者和均衡访视的数据集进行最大似然拟合，得到在完整模型下（$\\sigma_b^2 \\ge 0$）的优化对数似然值为 $l_1 = -838.015$，在零模型下（$\\sigma_b^2 = 0$）的优化对数似然值为 $l_0 = -840.015$。在您推导出的适当参考分布下，计算观测到的 LRT 统计量和相应的 p 值。将最终的 p 值四舍五入至四位有效数字，并以小数形式表示。",
            "solution": "用户希望我解决一个关于线性混合效应模型中假设检验的问题。\n\n**第一部分：问题验证**\n\n1.  **提取已知条件：**\n    *   模型: $Y_{ij} = \\beta_0 + \\beta_1 t_{ij} + b_i + \\varepsilon_{ij}$\n    *   $i$: 患者索引, $i \\in \\{1,\\dots,n\\}$\n    *   $j$: 访视索引, $j \\in \\{1,\\dots,m_i\\}$\n    *   $Y_{ij}$: 观测收缩压\n    *   $t_{ij}$: 访视时间，中心化\n    *   $b_i$: 随机截距, $b_i \\sim \\mathcal{N}(0,\\sigma_b^2)$\n    *   $\\varepsilon_{ij}$: 残差, $\\varepsilon_{ij} \\sim \\mathcal{N}(0,\\sigma^2)$\n    *   $b_i$ 和 $\\varepsilon_{ij}$ 相互独立。\n    *   假设检验: $H_0: \\sigma_b^2 = 0$ 对比 $H_1: \\sigma_b^2 > 0$。\n    *   参数 $\\sigma_b^2$ 被约束为非负。\n    *   数据：完整模型下的最大化对数似然值 ($l_1$) 为 $-838.015$。零模型下的最大化对数似然值 ($l_0$) 为 $-840.015$。\n\n2.  **使用提取的已知条件进行验证：**\n    *   **科学依据：** 该问题基于成熟的线性混合效应模型和似然比检验的统计理论。该框架是分析医学研究和其他领域中纵向数据的标准方法。\n    *   **适定性：** 该问题是适定的。它清晰地定义了统计模型、参数、分布以及待检验的具体假设。要求在边界条件下推导检验统计量的渐近分布，是统计理论中一个标准但较高级的问题，有其唯一且众所周知的解。所提供的数据足以进行要求的计算。\n    *   **客观性：** 该问题使用精确、客观和标准的统计术语进行陈述。\n    *   **完整性与一致性：** 该问题是自洽且一致的。它提供了所有必要的信息和定义。\n    *   **现实性与可行性：** 问题场景（监测血压）和统计模型完全符合现实。提供的对数似然值是合理的。\n    *   **结构与复杂性：** 该问题不是不适定的、琐碎的或伪深刻的。需要处理边界条件（$\\sigma_b^2 = 0$）这一点违反了威尔克斯定理（Wilks' theorem）的标准正则性条件，因此需要对参考分布进行更基本的推导。这构成了一个真正的概念性挑战。\n    *   **可验证性：** 推导过程和最终结果可以通过既有的统计学文献（例如，Self  Liang, 1987; Stram  Lee, 1994）进行数学验证。\n\n3.  **结论与行动：**\n    该问题是**有效的**。我将继续提供完整解答。\n\n**第二部分：解题推导**\n\n该问题要求推导在参数空间边界上检验方差分量的似然比检验（LRT）统计量及其渐近分布，然后使用所提供的数据进行计算。\n\nLRT 统计量的一般形式为\n$$\n\\lambda = 2(l_1 - l_0)\n$$\n其中，$l_1$ 是在完整模型（包含感兴趣的参数）下的最大化对数似然值，$l_0$ 是在原假设下的最大化对数似然值。在本问题中，原假设为 $H_0: \\sigma_b^2 = 0$，备择假设为 $H_1: \\sigma_b^2 > 0$。方差分量 $\\sigma_b^2$ 的参数空间为 $[0, \\infty)$。\n\n根据标准渐近理论（威尔克斯定理），在某些正则性条件下，LRT 统计量 $\\lambda$ 在 $H_0$ 下服从卡方分布，其自由度等于完整模型和零模型之间自由参数数量的差。这里，完整模型有参数 $\\{\\beta_0, \\beta_1, \\sigma^2, \\sigma_b^2\\}$，零模型有参数 $\\{\\beta_0, \\beta_1, \\sigma^2\\}$。差异为一个参数 $\\sigma_b^2$。对威尔克斯定理的简单应用会得出 $\\lambda \\sim \\chi_1^2$。然而，这是不正确的，因为一个关键的正则性条件被违反了：参数的零假设值（$\\sigma_b^2 = 0$）位于参数空间 $[0, \\infty)$ 的边界上，而不是其内部。\n\n为了找到正确的渐近分布，我们必须使用一种更基本的方法，该方法基于得分函数的性质和最大似然估计量（MLE）在边界处的行为。设 $\\theta = (\\boldsymbol{\\beta}, \\sigma^2, \\sigma_b^2)$ 是所有参数的向量。设 $l(\\theta)$ 是对数似然函数。完整模型下的 MLE $\\hat{\\theta}_1$ 是通过在约束条件 $\\sigma_b^2 \\ge 0$ 下最大化 $l(\\theta)$ 得到的。零模型下的 MLE $\\hat{\\theta}_0$ 是通过将 $\\sigma_b^2$ 固定为 $0$ 来最大化 $l(\\theta)$ 得到的。\n\n考虑 $\\sigma_b^2$ 的得分函数，即对数似然函数关于 $\\sigma_b^2$ 的偏导数，在原假设下，并在其他参数的零模型 MLE 处取值：$S_b = \\frac{\\partial l}{\\partial \\sigma_b^2}|_{\\sigma_b^2=0, \\boldsymbol{\\beta}=\\hat{\\boldsymbol{\\beta}}_0, \\sigma^2=\\hat{\\sigma}_0^2}$。在 $H_0$ 下，得分函数 $S_b$ 渐近服从均值为 0、方差由费雪信息矩阵相应元素给出的正态分布。\n\nLRT 的行为取决于 $S_b$ 的符号。如果 $S_b > 0$，当从 $\\sigma_b^2=0$ 移动到允许区域 $\\sigma_b^2 > 0$ 时，似然函数会增加。在这种情况下，完整模型下的约束 MLE $\\hat{\\sigma}_{b,1}^2$ 将为正（$\\hat{\\sigma}_{b,1}^2 > 0$）。当 MLE 位于参数空间内部时，标准渐近论证成立。LRT 统计量可以近似为得分统计量的二次型，$\\lambda \\approx S_b^2 / I_{bb}$，其中 $I_{bb}$ 是 $\\sigma_b^2$ 的费雪信息。这个量服从 $\\chi_1^2$ 分布。\n\n相反，如果 $S_b \\le 0$，通过从 $\\sigma_b^2=0$ 向负值方向移动，似然函数达到最大值（或至少不增加）。由于参数空间被约束为 $\\sigma_b^2 \\ge 0$，MLE 被迫位于边界上：$\\hat{\\sigma}_{b,1}^2 = 0$。在这种情况下，完整模型下所有参数的 MLE 与零模型下的 MLE 相同。因此，最大化的对数似然值相同，$l_1 = l_0$，LRT 统计量为 $\\lambda = 2(l_1 - l_0) = 0$。\n\n由于在 $H_0$ 下，得分函数 $S_b$ 渐近地以 0 为中心，所以 $S_b > 0$ 的概率约为 0.5，$S_b \\le 0$ 的概率也约为 0.5。这导出了一个结论，即 LRT 统计量 $\\lambda$ 的渐近分布是两个分布的混合：\n1. 以 0.5 的概率，$\\lambda = 0$（在零点的一个点质量，可以表示为 $\\chi_0^2$ 分布）。\n2. 以 0.5 的概率，$\\lambda$ 服从 $\\chi_1^2$ 分布。\n\n因此，在 $H_0$ 下 $\\lambda$ 的渐近分布是 $\\chi_0^2$ 分布和 $\\chi_1^2$ 分布的 50:50 混合：\n$$\n\\lambda \\sim \\frac{1}{2}\\chi_0^2 + \\frac{1}{2}\\chi_1^2\n$$\n对于一个观测到的检验统计量 $\\lambda_{obs}$，p 值是在零分布下观测到同样极端或更极端值的概率。对于一个非零的观测值 $\\lambda_{obs} > 0$：\n$$\np\\text{-value} = P(\\lambda \\ge \\lambda_{obs})\n$$\n使用混合分布：\n$$\nP(\\lambda \\ge \\lambda_{obs}) = \\frac{1}{2} P(\\chi_0^2 \\ge \\lambda_{obs}) + \\frac{1}{2} P(\\chi_1^2 \\ge \\lambda_{obs})\n$$\n因为 $\\lambda_{obs} > 0$，概率 $P(\\chi_0^2 \\ge \\lambda_{obs})$ 为 0。表达式简化为：\n$$\np\\text{-value} = \\frac{1}{2} P(\\chi_1^2 \\ge \\lambda_{obs})\n$$\n这意味着正确的 p 值是使用标准（且不正确的）$\\chi_1^2$ 参考分布计算出的值的一半。\n\n现在，我们将此理论应用于给定的数据。\n完整模型下的最大化对数似然值为 $l_1 = -838.015$。\n零模型下的最大化对数似然值为 $l_0 = -840.015$。\n\n观测到的 LRT 统计量为：\n$$\n\\lambda_{obs} = 2(l_1 - l_0) = 2(-838.015 - (-840.015)) = 2(2.0) = 4.0\n$$\n由于 $\\lambda_{obs}=4.0 > 0$，$\\sigma_b^2$ 的 MLE 为正，我们处于非平凡情况。p 值的计算如下：\n$$\np\\text{-value} = \\frac{1}{2} P(\\chi_1^2 \\ge 4.0)\n$$\n如果一个随机变量 $W = Z^2$，其中 $Z \\sim \\mathcal{N}(0,1)$，则 $W$ 服从 $\\chi_1^2$ 分布。因此，\n$$\nP(\\chi_1^2 \\ge 4.0) = P(Z^2 \\ge 4.0) = P(|Z| \\ge \\sqrt{4.0}) = P(|Z| \\ge 2.0)\n$$\n这个概率对应于标准正态分布在 $Z=-2$ 和 $Z=2$ 之外的双尾面积。从标准正态分布表或计算器可知，$P(Z > 2) \\approx 0.02275$。根据对称性，$P(Z  -2) \\approx 0.02275$。\n所以，\n$$\nP(\\chi_1^2 \\ge 4.0) = P(Z > 2) + P(Z  -2) \\approx 0.02275 + 0.02275 = 0.0455\n$$\n最终的 p 值为：\n$$\np\\text{-value} = \\frac{1}{2} \\times 0.0455 = 0.02275\n$$\n问题要求将 p 值四舍五入到四位有效数字。计算出的值为 $0.02275$。前四位有效数字是 2、2、7 和 5。下一位数字是 0（来自更精确的计算，得到 0.02275013...），因此无需进一步舍入。最终答案是 $0.02275$。\n这个 p 值通常被认为具有统计显著性（例如，在 $\\alpha=0.05$ 的水平上），因此可以拒绝原假设 $H_0: \\sigma_b^2 = 0$。这表明收缩压存在显著的受试者间异质性，并且这种异质性被随机截距所捕捉。",
            "answer": "$$\n\\boxed{0.02275}\n$$"
        },
        {
            "introduction": "当我们确定一个合适的线性混合效应模型后，下一步便是利用该模型回答具体的科学问题。研究者们通常对不同时间段内的变化趋势或特定时间点之间的差异感兴趣，这些问题往往无法通过检验单个模型系数来回答。本练习将向您介绍如何使用对比矩阵（contrast matrix）和沃尔德检验（Wald test）这一通用框架，来检验关于固定效应的复杂联合假设，从而将模型拟合结果转化为有意义的临床或生物学结论()。",
            "id": "4951162",
            "problem": "考虑一项针对原发性高血压成年人的纵向研究，其中在四个临床访视点测量了收缩压：基线 ($t_{0}$)、4周 ($t_{1}$)、12周 ($t_{2}$) 和24周 ($t_{3}$)。将一个包含受试者特异性随机截距和访视特异性固定效应的线性混合模型 (LMM) 拟合到重复测量数据中。令访视特异性固定效应均值的向量为 $\\beta = (\\mu_{0}, \\mu_{1}, \\mu_{2}, \\mu_{3})^{T}$，表示每次访视时总体平均收缩压。在 LMM 中最大似然估计的标准正则性条件下，广义最小二乘 (GLS) 估计量 $\\hat{\\beta}$ 近似服从多元正态分布，其均值为 $\\beta$，协方差矩阵为 $\\widehat{\\text{Var}}(\\hat{\\beta})$。\n\n假设拟合模型得到的固定效应估计值为\n$$\n\\hat{\\beta} = \\begin{pmatrix} 132.0 \\\\ 128.5 \\\\ 127.0 \\\\ 125.5 \\end{pmatrix},\n$$\n以及一个具有合理复合对称结构的 $\\hat{\\beta}$ 的估计协方差矩阵，\n$$\n\\widehat{\\text{Var}}(\\hat{\\beta}) = \\begin{pmatrix}\n0.49  0.22  0.22  0.22 \\\\\n0.22  0.49  0.22  0.22 \\\\\n0.22  0.22  0.49  0.22 \\\\\n0.22  0.22  0.22  0.49\n\\end{pmatrix}.\n$$\n\n您有兴趣同时检验从基线开始的早期变化是否为零，以及从12周到24周的晚期变化是否为零，即联合零假设 $H_{0}: \\mu_{1} - \\mu_{0} = 0$ 和 $\\mu_{3} - \\mu_{2} = 0$。\n\n仅使用 $\\hat{\\beta}$ 近似服从多元正态分布以及多元正态向量的线性函数也服从多元正态分布这两个基本事实，执行以下操作：\n\n- 构建将 $\\beta$ 映射到两个差异 $(\\mu_{1} - \\mu_{0}, \\mu_{3} - \\mu_{2})^{T}$ 的对比矩阵 $C$。\n- 从第一性原理出发，为一般线性假设 $H_{0}$ 推导相应的 Wald 检验统计量。\n- 使用所提供的 $\\hat{\\beta}$ 和 $\\widehat{\\text{Var}}(\\hat{\\beta})$ 计算该 Wald 检验统计量的数值。\n\n将您的最终数值答案四舍五入至四位有效数字。答案中不要报告任何单位。",
            "solution": "该问题被评估为具有科学依据、提法得当、客观，并包含获得唯一解所需的所有必要信息。因此，该问题被视为有效。\n\n该问题要求构建一个对比矩阵，推导一个 Wald 检验统计量，并针对线性混合模型 (LMM) 的固定效应的联合零假设计算其值。\n\n固定效应参数估计的向量为 $\\hat{\\beta}$，它近似服从多元正态分布，均值为 $\\beta$，估计的协方差矩阵为 $\\widehat{\\text{Var}}(\\hat{\\beta}) = \\hat{V}$。\n$$\n\\hat{\\beta} \\sim \\mathcal{N}(\\beta, \\hat{V})\n$$\n其中\n$$\n\\hat{\\beta} = \\begin{pmatrix} 132.0 \\\\ 128.5 \\\\ 127.0 \\\\ 125.5 \\end{pmatrix}, \\quad \\hat{V} = \\widehat{\\text{Var}}(\\hat{\\beta}) = \\begin{pmatrix}\n0.49  0.22  0.22  0.22 \\\\\n0.22  0.49  0.22  0.22 \\\\\n0.22  0.22  0.49  0.22 \\\\\n0.22  0.22  0.22  0.49\n\\end{pmatrix}\n$$\n参数向量为 $\\beta = (\\mu_0, \\mu_1, \\mu_2, \\mu_3)^T$。我们关注的联合零假设是：\n$$\nH_0: \\mu_1 - \\mu_0 = 0 \\quad \\text{和} \\quad \\mu_3 - \\mu_2 = 0\n$$\n\n这是一个形式为 $H_0: C\\beta = \\mathbf{0}$ 的一般线性假设，其中 $C$ 是一个对比矩阵，$\\mathbf{0}$ 是一个零向量。\n\n**1. 构建对比矩阵 $C$**\n\n目标是定义一个矩阵 $C$，它将参数向量 $\\beta$ 变换为一个包含两个指定差异的向量。\n$$\nC\\beta = \\begin{pmatrix} \\mu_1 - \\mu_0 \\\\ \\mu_3 - \\mu_2 \\end{pmatrix}\n$$\n我们可以明确地写出这个变换：\n$$\n\\begin{pmatrix} \\mu_1 - \\mu_0 \\\\ \\mu_3 - \\mu_2 \\end{pmatrix} = \\begin{pmatrix} (-1)\\mu_0 + (1)\\mu_1 + (0)\\mu_2 + (0)\\mu_3 \\\\ (0)\\mu_0 + (0)\\mu_1 + (-1)\\mu_2 + (1)\\mu_3 \\end{pmatrix}\n$$\n这直接给出了对比矩阵 $C$ 的行。第一行对应于第一个对比中 $(\\mu_0, \\mu_1, \\mu_2, \\mu_3)$ 的系数，第二行对应于第二个对比的系数。\n$$\nC = \\begin{pmatrix}\n-1  1  0  0 \\\\\n0  0  -1  1\n\\end{pmatrix}\n$$\n这是一个 $2 \\times 4$ 矩阵，它将 $4 \\times 1$ 的向量 $\\beta$ 正确地映射到一个 $2 \\times 1$ 的对比向量。\n\n**2. 推导 Wald 检验统计量**\n\n推导过程基于一个基本事实：一个多元正态随机向量的线性变换仍然是一个多元正态随机向量。\n我们从估计量 $\\hat{\\beta}$ 的近似分布开始：\n$$\n\\hat{\\beta} \\sim \\mathcal{N}(\\beta, V)\n$$\n其中 $V = \\text{Var}(\\hat{\\beta})$。\n我们感兴趣的线性变换由对比矩阵 $C$ 定义。让我们考虑随机向量 $C\\hat{\\beta}$ 的分布。\n$C\\hat{\\beta}$ 的期望是：\n$$\nE[C\\hat{\\beta}] = C E[\\hat{\\beta}] = C\\beta\n$$\n$C\\hat{\\beta}$ 的协方差矩阵由夹心公式给出：\n$$\n\\text{Var}(C\\hat{\\beta}) = C \\text{Var}(\\hat{\\beta}) C^T = CVC^T\n$$\n因此，估计的对比的分布为：\n$$\nC\\hat{\\beta} \\sim \\mathcal{N}(C\\beta, CVC^T)\n$$\n在零假设 $H_0: C\\beta = \\mathbf{0}$ 下，该分布简化为：\n$$\nC\\hat{\\beta} \\sim \\mathcal{N}(\\mathbf{0}, CVC^T)\n$$\n对于一个 $q$ 维随机向量 $X \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma)$，其二次型 $X^T \\Sigma^{-1} X$ 服从自由度为 $q$ 的卡方分布，即 $X^T \\Sigma^{-1} X \\sim \\chi^2_q$。\n将此定理应用于我们的情况，我们设 $X = C\\hat{\\beta}$ 和 $\\Sigma = CVC^T$。维度 $q$ 是对比的数量（$C$ 的行数），即 $q=2$。\n因此，Wald 检验统计量 $W$ 是二次型：\n$$\nW = (C\\hat{\\beta})^T (CVC^T)^{-1} (C\\hat{\\beta})\n$$\n在实践中，真实的协方差矩阵 $V$ 是未知的，并被其一致估计量 $\\hat{V} = \\widehat{\\text{Var}}(\\hat{\\beta})$ 所取代。由此得到的检验统计量为：\n$$\nW = (C\\hat{\\beta})^T (C\\hat{V}C^T)^{-1} (C\\hat{\\beta}) \\sim \\chi^2_q\n$$\n这就是用于线性假设 $H_0: C\\beta = \\mathbf{0}$ 的 Wald 统计量的通用公式。\n\n**3. 计算 Wald 检验统计量的数值**\n\n现在我们使用所提供的数据计算 $W$ 的值。\n\n首先，计算估计的对比向量 $C\\hat{\\beta}$：\n$$\nC\\hat{\\beta} = \\begin{pmatrix} -1  1  0  0 \\\\ 0  0  -1  1 \\end{pmatrix} \\begin{pmatrix} 132.0 \\\\ 128.5 \\\\ 127.0 \\\\ 125.5 \\end{pmatrix} = \\begin{pmatrix} 128.5 - 132.0 \\\\ 125.5 - 127.0 \\end{pmatrix} = \\begin{pmatrix} -3.5 \\\\ -1.5 \\end{pmatrix}\n$$\n\n接下来，计算估计的对比的协方差矩阵 $\\Sigma_C = C\\hat{V}C^T$：\n$$\n\\Sigma_C = \\begin{pmatrix} -1  1  0  0 \\\\ 0  0  -1  1 \\end{pmatrix} \\begin{pmatrix}\n0.49  0.22  0.22  0.22 \\\\\n0.22  0.49  0.22  0.22 \\\\\n0.22  0.22  0.49  0.22 \\\\\n0.22  0.22  0.22  0.49\n\\end{pmatrix} \\begin{pmatrix} -1  0 \\\\ 1  0 \\\\ 0  -1 \\\\ 0  1 \\end{pmatrix}\n$$\n第一个对比 $(\\mu_1 - \\mu_0)$ 的方差是 $\\Sigma_C$ 的 $(1,1)$ 元素：\n$$\n\\text{Var}(\\hat{\\mu}_1 - \\hat{\\mu}_0) = \\text{Var}(\\hat{\\mu}_1) + \\text{Var}(\\hat{\\mu}_0) - 2\\text{Cov}(\\hat{\\mu}_1, \\hat{\\mu}_0) = 0.49 + 0.49 - 2(0.22) = 0.98 - 0.44 = 0.54\n$$\n第二个对比 $(\\mu_3 - \\mu_2)$ 的方差是 $\\Sigma_C$ 的 $(2,2)$ 元素：\n$$\n\\text{Var}(\\hat{\\mu}_3 - \\hat{\\mu}_2) = \\text{Var}(\\hat{\\mu}_3) + \\text{Var}(\\hat{\\mu}_2) - 2\\text{Cov}(\\hat{\\mu}_3, \\hat{\\mu}_2) = 0.49 + 0.49 - 2(0.22) = 0.98 - 0.44 = 0.54\n$$\n两个对比之间的协方差是 $\\Sigma_C$ 的 $(1,2)$ 和 $(2,1)$ 元素：\n$$\n\\text{Cov}(\\hat{\\mu}_1 - \\hat{\\mu}_0, \\hat{\\mu}_3 - \\hat{\\mu}_2) = \\text{Cov}(\\hat{\\mu}_1, \\hat{\\mu}_3) - \\text{Cov}(\\hat{\\mu}_1, \\hat{\\mu}_2) - \\text{Cov}(\\hat{\\mu}_0, \\hat{\\mu}_3) + \\text{Cov}(\\hat{\\mu}_0, \\hat{\\mu}_2)\n$$\n从矩阵 $\\hat{V}$ 中可知，所有这些协方差项都等于 $0.22$。\n$$\n\\text{Cov}(\\dots) = 0.22 - 0.22 - 0.22 + 0.22 = 0\n$$\n所以，对比的协方差矩阵是：\n$$\n\\Sigma_C = \\begin{pmatrix} 0.54  0 \\\\ 0  0.54 \\end{pmatrix}\n$$\n现在，计算 $\\Sigma_C$ 的逆矩阵：\n$$\n\\Sigma_C^{-1} = \\begin{pmatrix} 0.54  0 \\\\ 0  0.54 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{0.54}  0 \\\\ 0  \\frac{1}{0.54} \\end{pmatrix}\n$$\n最后，计算 Wald 统计量 $W$：\n$$\nW = (C\\hat{\\beta})^T \\Sigma_C^{-1} (C\\hat{\\beta}) = \\begin{pmatrix} -3.5  -1.5 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{0.54}  0 \\\\ 0  \\frac{1}{0.54} \\end{pmatrix} \\begin{pmatrix} -3.5 \\\\ -1.5 \\end{pmatrix}\n$$\n$$\nW = \\frac{(-3.5)^2}{0.54} + \\frac{(-1.5)^2}{0.54} = \\frac{12.25 + 2.25}{0.54} = \\frac{14.5}{0.54}\n$$\n计算数值：\n$$\nW = \\frac{14.5}{0.54} \\approx 26.85185...\n$$\n四舍五入到四位有效数字，Wald 检验统计量的值为 $26.85$。\n该值将与自由度为 $q=2$ 的卡方分布进行比较，以获得联合假设检验的p值。例如，当 $\\alpha=0.05$ 时，临界值为 $\\chi^2_{2, 0.95} \\approx 5.99$。由于 $26.85  5.99$，因此在该显著性水平下，将拒绝零假设。",
            "answer": "$$\n\\boxed{26.85}\n$$"
        }
    ]
}