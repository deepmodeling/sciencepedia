{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。孟德尔随机化（MR）分析的核心在于利用遗传变异作为工具变量来推断因果效应。最基础的估算方法是Wald比率法，它通过基因-结局关联效应与基因-暴露关联效应的比值来量化暴露对结局的因果效应，其直观意义是“单位暴露量变化引起的结局变化”。本练习将通过一个单样本MR研究的具体场景，让你亲手计算这一核心因果效应估计值。",
            "id": "4966470",
            "problem": "一个生物统计学团队正在进行一项单样本孟德尔随机化（MR）研究，旨在使用单个遗传变异作为工具变量（IV）来估计一个暴露对一个二元疾病结局的因果效应。设 $G$ 表示单个核苷酸多态性的效应等位基因数量，$X$ 为标准化暴露（以标准差为单位），$Y \\in \\{0,1\\}$ 为疾病指标。遗传与暴露的关联概括为 $X$ 对 $G$ 的线性模型中的回归系数 $\\hat{\\gamma}_{GX}$，而遗传与结局的关联概括为 $Y$ 对 $G$ 的逻辑斯谛回归中的系数 $\\hat{\\gamma}_{GY}$，因此 $\\hat{\\gamma}_{GY}$ 是在 log-odds 尺度上。假设工具变量的核心条件（相关性、独立性和排他性限制）成立，并且结局的结构模型在 $X$ 的 log-odds 尺度上是可加的。给定 $\\hat{\\gamma}_{GX} = 0.2$（每个效应等位基因对应的 $X$ 的标准差单位）和 $\\hat{\\gamma}_{GY} = 0.04$（每个效应等位基因对应的 $Y$ 的 log-odds）。\n\n仅使用上述核心定义和模型假设，计算 $X$ 增加一个标准差对 $Y$ 的 log-odds 的因果效应。请用 log-odds 尺度上的单个实数表示你的答案。无需四舍五入，只报告数值，不带单位，但其可解释性是暴露每增加一个标准差对结局 log-odds 尺度的影响。",
            "solution": "该问题要求使用一个遗传变异 $G$ 作为工具变量（IV），来估计暴露 $X$ 对二元结局 $Y$ 的因果效应。这是孟德尔随机化（MR）的一个标准应用。我们已获得单样本研究背景下所需的估计值。\n\n设 $\\beta_{YX}$ 代表暴露 $X$ 每增加一个标准差（$1$ SD）对疾病结局 $Y$ 的 log-odds 的因果效应。该问题假设结局的结构模型在 log-odds 尺度上是可加的：\n$$ \\text{logit}(P(Y=1|X,U)) = \\alpha_0 + \\beta_{YX} X + f(U) $$\n这里，$\\text{logit}(p) = \\ln(p/(1-p))$，$U$ 代表所有可能与 $X$ 和 $Y$ 相关的未测量混杂因素。目标是估计 $\\beta_{YX}$。\n\n遗传变异 $G$ 被用作工具变量。要使 $G$ 成为一个有效的工具变量，它必须满足三个核心条件，问题中已说明这些条件成立：\n1.  **相关性：** 工具变量 $G$ 必须与暴露 $X$ 相关。这种关系由 $X$ 对 $G$ 回归的系数 $\\gamma_{GX}$ 来量化。模型为 $E[X|G] = \\beta_{X0} + \\gamma_{GX} G$。我们得到的估计值为 $\\hat{\\gamma}_{GX} = 0.2$。该值意味着变异 $G$ 每增加一个效应等位基因，暴露 $X$ 就增加 $0.2$ 个标准差。\n2.  **独立性：** 工具变量 $G$ 必须独立于任何影响 $X$ 和 $Y$ 的未测量混杂因素 $U$。这个假设，$G \\perp U$，至关重要，因为它确保了 $G$ 和 $Y$ 之间的任何关联都不是由混杂引起的。\n3.  **排他性限制：** 工具变量 $G$ 仅通过其对暴露 $X$ 的影响来影响结局 $Y$。不存在从 $G$ 到 $Y$ 绕过 $X$ 的直接因果路径。\n\n在这三个假设下，遗传工具 $G$ 与结局 $Y$ 之间的关联可以用来推断 $X$ 对 $Y$ 的因果效应。$G$ 与 $Y$ 之间的关联由 $Y$ 对 $G$ 的逻辑斯谛回归系数 $\\hat{\\gamma}_{GY}$ 给出：\n$$ \\text{logit}(P(Y=1|G)) = \\beta_{Y0} + \\gamma_{GY} G $$\n我们得到的估计值为 $\\hat{\\gamma}_{GY} = 0.04$，它代表 $G$ 每增加一个效应等位基因时，疾病 $Y$ 的 log-odds 的变化。\n\n排他性限制原则意味着 $G$ 对 $Y$ 的 log-odds 的总效应完全是通过 $X$ 来介导的。这使我们能够将关联 $\\gamma_{GY}$ 分解为 $G$ 对 $X$ 的效应与 $X$ 对 $Y$ 的 log-odds 的因果效应的乘积。这可以被看作一个因果链：$G \\rightarrow X \\rightarrow Y$。\n该关系由下式给出：\n$$ \\gamma_{GY} = \\gamma_{GX} \\cdot \\beta_{YX} $$\n在没有交互作用的线性模型系统中，该方程精确成立，并且在逻辑斯谛结局模型的背景下，它为 $\\beta_{YX}$ 提供了一个一致的估计量，尤其是在遗传效应较小（这很常见）的情况下。因果效应 $\\beta_{YX}$ 的估计量是通过重排该方程得到的。这种 IV 估计量的特定形式被称为 Wald 比率。\n\n因此，因果效应的估计值 $\\hat{\\beta}_{YX}$ 是遗传与结局的关联与遗传与暴露的关联之比：\n$$ \\hat{\\beta}_{YX} = \\frac{\\hat{\\gamma}_{GY}}{\\hat{\\gamma}_{GX}} $$\n\n我们已知以下数值：\n-   $\\hat{\\gamma}_{GX} = 0.2$（每个效应等位基因对应的 $X$ 的标准差单位）\n-   $\\hat{\\gamma}_{GY} = 0.04$（每个效应等位基因对应的 $Y$ 的 log-odds）\n\n将这些值代入 Wald 比率公式：\n$$ \\hat{\\beta}_{YX} = \\frac{0.04}{0.2} $$\n进行除法计算：\n$$ \\hat{\\beta}_{YX} = \\frac{4/100}{2/10} = \\frac{4}{100} \\cdot \\frac{10}{2} = \\frac{40}{200} = \\frac{1}{5} $$\n$$ \\hat{\\beta}_{YX} = 0.2 $$\n所得结果 $0.2$ 是暴露 $X$ 每增加一个标准差对疾病 $Y$ 的 log-odds 的估计因果效应。其单位是（$Y$ 的 log-odds）/（$X$ 的标准差），这正是问题所要求的。",
            "answer": "$$\\boxed{0.2}$$"
        },
        {
            "introduction": "一个有效的工具变量（IV）必须满足几个核心假设，其中“关联性”假设是首要前提，即工具变量必须与暴露因素有足够强的关联。在实践中，我们通常使用第一阶段回归的 $F$ 统计量来评估工具变量的强度，一个过弱的工具变量（weak instrument）会导致有偏和不精确的因果估计。此练习旨在让你掌握如何根据回归结果计算 $F$ 统计量，并使用公认的准则（例如 Staiger and Stock 提出的 $F \\gt 10$）判断工具变量的强度。",
            "id": "4966489",
            "problem": "一项孟德尔随机化（MR）研究使用单个遗传变异——单核苷酸多态性（SNP）——作为工具变量（IV），来估计暴露量 $X$ 对结局 $Y$ 的因果效应。工具变量的相关性通过在一个大样本中使用普通最小二乘法（OLS）对暴露量 $X$ 关于工具变量 $Z$ 进行第一阶段回归来评估，该回归模型设定为 $X = \\pi Z + \\eta$，其中 $\\pi$ 是工具-暴露效应，$\\eta$ 是扰动项。\n\n给定估计的第一阶段系数 $\\hat{\\pi} = 0.05$ 及其标准误 $SE(\\hat{\\pi}) = 0.02$。假设样本量足够大，以至于大样本近似成立。\n\n使用线性模型的假设检验标准框架，以及在原假设 $H_{0} : \\pi = 0$ 下检验工具变量相关性的 $F$ 统计量的定义，从第一性原理推导出适用于单个线性约束的检验统计量，并根据所提供的估计值计算其数值。然后，根据工具变量分析中的公认实践，判断在该经验法则阈值下，该工具变量是否被认为是强工具变量。无需四舍五入；将 $F$ 统计量报告为精确值。最终答案必须是 $F$ 统计量的单个数值（无单位）。",
            "solution": "该问题要求推导和计算用于检验工具变量 $Z$ 相关性的 $F$ 统计量。该检验的原假设是工具变量与暴露量没有关联，在第一阶段回归模型 $X = \\pi Z + \\eta$ 中表示为 $H_{0} : \\pi = 0$。\n\n在线性回归模型中，对单个系数的单个线性约束进行检验最直接的方法是使用 $t$ 统计量。$t$ 统计量定义为估计系数与其标准误的比值，该比值以原假设下的系数值为中心。\n\n用于检验 $H_{0} : \\pi = \\pi_{0}$ 的 $t$ 统计量的一般形式为：\n$$\nt = \\frac{\\hat{\\pi} - \\pi_{0}}{SE(\\hat{\\pi})}\n$$\n在本问题中，原假设为 $H_{0} : \\pi = 0$，因此 $\\pi_{0} = 0$。$t$ 统计量简化为：\n$$\nt = \\frac{\\hat{\\pi}}{SE(\\hat{\\pi})}\n$$\n线性模型理论中的一个基本原理是 $t$ 统计量和 $F$ 统计量之间的关系。对于涉及单个线性约束的检验（本例中为 $k=1$ 个约束，即 $\\pi=0$），$F$ 统计量恰好是相应 $t$ 统计量的平方。这一关系在大样本情况下成立，而这也是问题陈述中给出的一个假设。\n$$\nF = t^2\n$$\n这种关系构成了问题所要求的第一性原理推导，因为它将针对单个参数的基本检验（$t$ 检验）与更通用的线性约束 $F$ 检验框架联系起来。\n\n现在，我们可以使用提供的估计值来计算检验统计量的值。\n已知：\n- 估计系数：$\\hat{\\pi} = 0.05$\n- 系数的标准误：$SE(\\hat{\\pi}) = 0.02$\n\n首先，我们计算 $t$ 统计量的值：\n$$\nt = \\frac{0.05}{0.02} = 2.5\n$$\n接下来，我们使用关系式 $F = t^2$ 来求出 $F$ 统计量：\n$$\nF = (2.5)^2 = 6.25\n$$\n计算得出的用于检验工具变量相关性的 $F$ 统计量为 $6.25$。\n\n最后，问题要求判断该工具变量是否被认为是强的。在工具变量分析中，一个源于 Staiger 和 Stock (1997) 研究的常用经验法则是用来评估工具变量强度的。根据这个惯例，如果第一阶段的 $F$ 统计量小于10，则该工具变量被认为是“弱”的。弱工具变量可能导致分析第二阶段的因果估计有偏且不精确。\n\n在本例中，计算出的 $F$ 统计量为 $6.25$。由于 $6.25  10$，根据这个广泛接受的阈值，该单个SNP工具变量将被归类为弱工具变量。这表明该研究可能存在弱工具变量偏误。\n\n所要求的最终答案是 $F$ 统计量的数值。",
            "answer": "$$\\boxed{6.25}$$"
        },
        {
            "introduction": "除了关联性，工具变量的“排他性”假设同样至关重要，它要求工具变量只能通过暴露因素影响结局，而不存在其他直接通路。当遗传变异通过独立于暴露的途径影响结局时，就会发生水平多效性（horizontal pleiotropy），这会违反排他性假设。MR-Egger回归是检测“定向多效性”（一种系统性的水平多效性）的常用敏感性分析方法，其截距项提供了是否存在这种系统性偏倚的证据。本练习将指导你如何解释MR-Egger的截距项检验结果，以评估因果推断的稳健性。",
            "id": "4966512",
            "problem": "您进行了一项两样本孟德尔随机化（MR）分析，使用许多独立的全基因组显著单核苷酸多态性（SNPs）作为工具变量，以估计心血管代谢暴露对一种二元疾病结局的因果效应。为了检验工具变量强度独立于直接效应（InSIDE）的假设并评估定向多效性，您对各个SNP特异性关联进行了MR-Egger回归拟合。MR-Egger回归的截距估计值为 $\\hat{\\beta}_{0}=0.02$，其标准误为 $\\mathrm{SE}(\\hat{\\beta}_{0})=0.01$。假设在常规的大样本条件下，MR-Egger截距估计量是渐近正态的，并且可以对原假设 $H_{0}:\\beta_{0}=0$ 通过双边Wald检验进行推断。使用 $\\alpha=0.05$ 的显著性水平。\n\n计算检验 $H_{0}:\\beta_{0}=0$ 的双边 $p$ 值，并仅根据此 $p$ 值和 $\\alpha$ 值，判断是否存在定向多效性的统计学证据。将您的 $p$ 值四舍五入至四位有效数字，并以小数形式表示。最终答案应仅为该 $p$ 值。",
            "solution": "科学目标是检验所有工具变量的平均直接（多效性）效应是否为零，这在孟德尔随机化（MR）框架中可以通过MR-Egger回归的截距进行评估。在标准正则性条件和大量工具变量的情况下，MR-Egger截距估计量近似服从正态分布：\n$$\n\\hat{\\beta}_{0} \\sim \\mathcal{N}\\!\\left(\\beta_{0}, \\ \\mathrm{SE}(\\hat{\\beta}_{0})^{2}\\right).\n$$\n为了检验原假设 $H_{0}:\\beta_{0}=0$ 与双边备择假设 $H_{1}:\\beta_{0}\\neq 0$，我们使用Wald统计量\n$$\nZ \\;=\\; \\frac{\\hat{\\beta}_{0}-0}{\\mathrm{SE}(\\hat{\\beta}_{0})}.\n$$\n给定 $\\hat{\\beta}_{0}=0.02$ 和 $\\mathrm{SE}(\\hat{\\beta}_{0})=0.01$，我们计算\n$$\nZ \\;=\\; \\frac{0.02}{0.01} \\;=\\; 2.\n$$\n在 $H_{0}$ 和大样本正态近似下，$Z$ 近似服从标准正态分布，因此双边 $p$ 值为\n$$\np \\;=\\; 2\\left[1-\\Phi\\!\\left(|Z|\\right)\\right] \\;=\\; 2\\left[1-\\Phi(2)\\right],\n$$\n其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数。使用熟知的值 $\\Phi(2)\\approx 0.977249868$，我们得到\n$$\np \\;\\approx\\; 2\\left(1-0.977249868\\right) \\;=\\; 2\\cdot 0.022750132 \\;=\\; 0.045500264.\n$$\n四舍五入至四位有效数字，$p$ 值为 $0.04550$。\n\n在显著性水平 $\\alpha=0.05$ 下进行解释，由于 $p \\approx 0.04550  0.05$，存在反对 $H_{0}$ 的统计学证据，根据MR-Egger截距检验，这表明存在定向多效性。然而，要求的最终答案仅为 $p$ 值。",
            "answer": "$$\\boxed{0.04550}$$"
        }
    ]
}