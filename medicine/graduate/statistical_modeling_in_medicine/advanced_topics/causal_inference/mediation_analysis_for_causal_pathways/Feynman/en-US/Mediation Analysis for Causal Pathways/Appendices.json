{
    "hands_on_practices": [
        {
            "introduction": "This practice bridges the gap between the theoretical definitions of causal effects and their practical estimation. You will start from the counterfactual definition of the Natural Indirect Effect (NIE) and derive its identification formula using the mediation assumptions in a setting with discrete variables. This exercise reinforces the fundamental \"mediation formula\" and provides concrete experience in calculating effects from observable conditional probabilities, a cornerstone of applied mediation analysis. ",
            "id": "4972558",
            "problem": "A hospital-based Randomized Controlled Trial (RCT) evaluates a new anti-inflammatory therapy, with binary exposure $X \\in \\{0,1\\}$ indicating assignment to new therapy ($X=1$) or standard care ($X=0$). The mediator is a binary early biological response $M \\in \\{0,1\\}$, defined as a rapid reduction in C-Reactive Protein (CRP), and the outcome $Y \\in \\{0,1\\}$ is clinical remission at $12$ weeks. Let $C$ denote a categorical baseline risk score taking three values $c \\in \\{0,1,2\\}$ with known distribution. Use the potential outcomes framework with $Y(x,m)$ denoting the outcome that would be observed if exposure is set to $x$ and the mediator is set to $m$, and $M(x)$ denoting the mediator that would be observed if exposure is set to $x$. Assume the following identification conditions hold: consistency, positivity, and sequential ignorability, that is, no unmeasured confounding for the exposure–mediator and mediator–outcome links given observed baseline covariates $C$, and that the mediator–outcome ignorability holds given exposure and covariates.\n\nStarting from these definitions and assumptions, derive the discrete summation identification formula for the Natural Indirect Effect (NIE) of changing exposure from $x'=0$ to $x=1$, defined as $\\text{NIE}(1,0) = \\mathbb{E}[Y(0, M(1)) - Y(0, M(0))]$. Express the identified NIE as a summation over the support of $C$ and the binary mediator $M \\in \\{0,1\\}$ using observable conditional probabilities. Then, using the following observed quantities from the RCT, compute the NIE, and round your final answer to four significant figures.\n\nThe baseline covariate distribution is: $\\mathbb{P}(C=0) = 0.40$, $\\mathbb{P}(C=1) = 0.35$, $\\mathbb{P}(C=2) = 0.25$.\n\nMediator model under exposure and covariates:\n$\\mathbb{P}(M=1 \\mid X=1, C=0) = 0.60$, $\\mathbb{P}(M=1 \\mid X=0, C=0) = 0.30$,\n$\\mathbb{P}(M=1 \\mid X=1, C=1) = 0.55$, $\\mathbb{P}(M=1 \\mid X=0, C=1) = 0.25$,\n$\\mathbb{P}(M=1 \\mid X=1, C=2) = 0.50$, $\\mathbb{P}(M=1 \\mid X=0, C=2) = 0.20$.\n\nOutcome model under $X=0$:\n$\\mathbb{E}[Y \\mid X=0, M=1, C=0] = 0.70$, $\\mathbb{E}[Y \\mid X=0, M=0, C=0] = 0.40$,\n$\\mathbb{E}[Y \\mid X=0, M=1, C=1] = 0.65$, $\\mathbb{E}[Y \\mid X=0, M=0, C=1] = 0.35$,\n$\\mathbb{E}[Y \\mid X=0, M=1, C=2] = 0.60$, $\\mathbb{E}[Y \\mid X=0, M=0, C=2] = 0.30$.\n\nYou must present the NIE first as a discrete summation formula identified under the stated assumptions and then compute its numerical value. Provide the final numerical answer as instructed, expressed as a decimal without a percentage sign.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It provides a standard exercise in causal mediation analysis with a complete and consistent set of definitions, assumptions, and data. Therefore, a solution will be provided.\n\nThe objective is to derive the identification formula for the Natural Indirect Effect (NIE) and then compute its value. The NIE is defined as the effect of the treatment on the outcome that operates through the mediator. For a change in exposure from $x'=0$ to $x=1$, the NIE is given by:\n$$\n\\text{NIE}(1,0) = \\mathbb{E}[Y(0, M(1)) - Y(0, M(0))]\n$$\nUsing the linearity of expectation, we can write this as:\n$$\n\\text{NIE}(1,0) = \\mathbb{E}[Y(0, M(1))] - \\mathbb{E}[Y(0, M(0))]\n$$\nWe identify each term on the right-hand side using the provided assumptions and data. The assumptions are: consistency, positivity, and sequential ignorability given covariates $C$. Sequential ignorability implies:\n$1.$ No unmeasured confounding of the exposure-outcome, exposure-mediator, and mediator-outcome relationships, conditional on $C$. Specifically, for all $x, m, x'$:\n   - $\\{Y(x,m), M(x')\\} \\perp X \\mid C$ (Exposure ignorability, satisfied by randomization of $X$)\n   - $Y(x,m) \\perp M \\mid X=x, C$ (Mediator ignorability)\n$2.$ An additional assumption, often taken for NIE identification, is $Y(x,m) \\perp M(x') \\mid C$ for $x \\neq x'$. This is a cross-world counterfactual independence assumption.\n\nLet's first identify the term $\\mathbb{E}[Y(0, M(1))]$. We use the law of total expectation, conditioning on the covariate $C$:\n$$\n\\mathbb{E}[Y(0, M(1))] = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{E}[Y(0, M(1)) \\mid C=c] \\mathbb{P}(C=c)\n$$\nNow we focus on the conditional expectation $\\mathbb{E}[Y(0, M(1)) \\mid C=c]$. We expand over the possible values of the potential mediator $M(1)$:\n$$\n\\mathbb{E}[Y(0, M(1)) \\mid C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y(0, M(1)) \\mid M(1)=m, C=c] \\mathbb{P}(M(1)=m \\mid C=c)\n$$\nBy definition, if $M(1)=m$, then $Y(0, M(1))$ becomes $Y(0, m)$. The expression simplifies to:\n$$\n\\mathbb{E}[Y(0, M(1)) \\mid C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y(0, m) \\mid M(1)=m, C=c] \\mathbb{P}(M(1)=m \\mid C=c)\n$$\nUsing the cross-world independence assumption $Y(0,m) \\perp M(1) \\mid C=c$, we have $\\mathbb{E}[Y(0, m) \\mid M(1)=m, C=c] = \\mathbb{E}[Y(0, m) \\mid C=c]$.\nSo,\n$$\n\\mathbb{E}[Y(0, M(1)) \\mid C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y(0, m) \\mid C=c] \\mathbb{P}(M(1)=m \\mid C=c)\n$$\nNow we must identify the two factors in the summation with observable quantities:\n- For $\\mathbb{P}(M(1)=m \\mid C=c)$: Using exposure ignorability ($M(1) \\perp X \\mid C$), we have $\\mathbb{P}(M(1)=m \\mid C=c) = \\mathbb{P}(M(1)=m \\mid X=1, C=c)$. By consistency ($M=M(1)$ when $X=1$), this equals $\\mathbb{P}(M=m \\mid X=1, C=c)$.\n- For $\\mathbb{E}[Y(0, m) \\mid C=c]$: Using exposure ignorability ($Y(0,m) \\perp X \\mid C$), we have $\\mathbb{E}[Y(0, m) \\mid C=c] = \\mathbb{E}[Y(0, m) \\mid X=0, C=c]$. Then, using mediator ignorability ($Y(0,m) \\perp M \\mid X=0, C=c$) and consistency ($Y=Y(0,m)$ when $X=0, M=m$), we get $\\mathbb{E}[Y(0, m) \\mid X=0, C=c] = \\mathbb{E}[Y \\mid X=0, M=m, C=c]$.\n\nSubstituting these back, we get the identified expression for the first term:\n$$\n\\mathbb{E}[Y(0, M(1))] = \\sum_{c \\in \\{0,1,2\\}} \\left( \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\mathbb{P}(M=m \\mid X=1, C=c) \\right) \\mathbb{P}(C=c)\n$$\n\nNext, we identify the second term, $\\mathbb{E}[Y(0, M(0))]$. This quantity represents the expected outcome under control ($X=0$) for both exposure and mediator pathways. It is directly identifiable from the data in the control arm.\n$$\n\\mathbb{E}[Y(0, M(0))] = \\mathbb{E}[Y \\mid X=0]\n$$\nBy the law of total expectation over $C$ and $M$:\n$$\n\\mathbb{E}[Y \\mid X=0] = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{E}[Y \\mid X=0, C=c] \\mathbb{P}(C=c \\mid X=0)\n$$\nSince $X$ is randomized, $C \\perp X$, so $\\mathbb{P}(C=c \\mid X=0) = \\mathbb{P}(C=c)$.\n$$\n\\mathbb{E}[Y \\mid X=0, C=c] = \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\mathbb{P}(M=m \\mid X=0, C=c)\n$$\nTherefore, the identified expression for the second term is:\n$$\n\\mathbb{E}[Y(0, M(0))] = \\sum_{c \\in \\{0,1,2\\}} \\left( \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\mathbb{P}(M=m \\mid X=0, C=c) \\right) \\mathbb{P}(C=c)\n$$\nSubtracting the second identified term from the first gives the discrete summation formula for the NIE:\n$$\n\\text{NIE}(1,0) = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{P}(C=c) \\sum_{m \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, M=m, C=c] \\left( \\mathbb{P}(M=m \\mid X=1, C=c) - \\mathbb{P}(M=m \\mid X=0, C=c) \\right)\n$$\nThis is the requested identification formula. For a binary mediator $M \\in \\{0,1\\}$, we can simplify this expression. Let $\\Delta\\mathbb{P}_M(c) = \\mathbb{P}(M=1 \\mid X=1, C=c) - \\mathbb{P}(M=1 \\mid X=0, C=c)$. Then $\\mathbb{P}(M=0 \\mid X=1, C=c) - \\mathbb{P}(M=0 \\mid X=0, C=c) = -\\Delta\\mathbb{P}_M(c)$. The inner sum becomes:\n$$\n\\left( \\mathbb{E}[Y \\mid X=0, M=1, C=c] - \\mathbb{E}[Y \\mid X=0, M=0, C=c] \\right) \\times \\left( \\mathbb{P}(M=1 \\mid X=1, C=c) - \\mathbb{P}(M=1 \\mid X=0, C=c) \\right)\n$$\nSo, the full expression for calculation is:\n$$\n\\text{NIE}(1,0) = \\sum_{c \\in \\{0,1,2\\}} \\mathbb{P}(C=c) \\Big[ (\\mathbb{E}[Y \\mid X=0, M=1, C=c] - \\mathbb{E}[Y \\mid X=0, M=0, C=c]) \\times (\\mathbb{P}(M=1 \\mid X=1, C=c) - \\mathbb{P}(M=1 \\mid X=0, C=c)) \\Big]\n$$\nNow we compute the numerical value using the provided data. Let's calculate the stratum-specific contribution for each value of $c$.\n\nFor $C=0$:\n- Difference in outcome expectation: $ \\mathbb{E}[Y \\mid X=0, M=1, C=0] - \\mathbb{E}[Y \\mid X=0, M=0, C=0] = 0.70 - 0.40 = 0.30 $\n- Difference in mediator probability: $ \\mathbb{P}(M=1 \\mid X=1, C=0) - \\mathbb{P}(M=1 \\mid X=0, C=0) = 0.60 - 0.30 = 0.30 $\n- Contribution from $C=0$: $ 0.30 \\times 0.30 = 0.09 $\n\nFor $C=1$:\n- Difference in outcome expectation: $ \\mathbb{E}[Y \\mid X=0, M=1, C=1] - \\mathbb{E}[Y \\mid X=0, M=0, C=1] = 0.65 - 0.35 = 0.30 $\n- Difference in mediator probability: $ \\mathbb{P}(M=1 \\mid X=1, C=1) - \\mathbb{P}(M=1 \\mid X=0, C=1) = 0.55 - 0.25 = 0.30 $\n- Contribution from $C=1$: $ 0.30 \\times 0.30 = 0.09 $\n\nFor $C=2$:\n- Difference in outcome expectation: $ \\mathbb{E}[Y \\mid X=0, M=1, C=2] - \\mathbb{E}[Y \\mid X=0, M=0, C=2] = 0.60 - 0.30 = 0.30 $\n- Difference in mediator probability: $ \\mathbb{P}(M=1 \\mid X=1, C=2) - \\mathbb{P}(M=1 \\mid X=0, C=2) = 0.50 - 0.20 = 0.30 $\n- Contribution from $C=2$: $ 0.30 \\times 0.30 = 0.09 $\n\nThe total NIE is the weighted average of these contributions, weighted by the distribution of $C$:\n$$\n\\text{NIE} = \\mathbb{P}(C=0) \\times (0.09) + \\mathbb{P}(C=1) \\times (0.09) + \\mathbb{P}(C=2) \\times (0.09)\n$$\n$$\n\\text{NIE} = (0.40 \\times 0.09) + (0.35 \\times 0.09) + (0.25 \\times 0.09)\n$$\n$$\n\\text{NIE} = (0.40 + 0.35 + 0.25) \\times 0.09 = 1.00 \\times 0.09 = 0.09\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\text{NIE} = 0.09000\n$$",
            "answer": "$$\\boxed{0.09000}$$"
        },
        {
            "introduction": "A critical step in any mediation analysis is to investigate the presence of an exposure-mediator interaction, as assuming additivity can be a strong and often incorrect simplification. This exercise demonstrates how to formally test for such an interaction within a regression framework and explores its profound implications for defining and estimating natural effects. By working through this problem, you will see how the presence of an interaction term, $\\beta_3 (A \\times M)$, fundamentally alters the expressions for the Pure Natural Direct Effect (PNDE) and Pure Natural Indirect Effect (PNIE). ",
            "id": "4972604",
            "problem": "A clinical trial investigates whether the effect of a binary treatment $A \\in \\{0,1\\}$ on a continuous pulmonary outcome $Y$ is mediated by a continuous inflammation biomarker $M$. The trial randomized $A$, and investigators adjusted the analysis to ensure there is no unmeasured confounding of the mediator–outcome relation given $A$ (sequential ignorability), along with consistency and positivity. The mediator and outcome are modeled as follows, with an identity link for the outcome:\n$$\nM = \\alpha_0 + \\alpha_1 A + \\eta, \\qquad\nY = \\beta_0 + \\beta_1 A + \\beta_2 M + \\beta_3 (A \\times M) + \\varepsilon,\n$$\nwhere $\\eta$ and $\\varepsilon$ have mean $0$. Fitted values and uncertainty summaries from large-sample regression are:\n$\\hat{\\alpha}_0 = 2.0$, $\\hat{\\alpha}_1 = -0.5$; $\\hat{\\beta}_0 = 10.0$, $\\hat{\\beta}_1 = 1.2$, $\\hat{\\beta}_2 = 3.0$, $\\hat{\\beta}_3 = -0.8$, $\\mathrm{SE}(\\hat{\\beta}_3) = 0.35$.\nUsing only these models, basic properties of linear expectations, and the potential outcomes definitions of the pure natural direct effect (PNDE) and pure natural indirect effect (PNIE),\n$$\n\\text{PNDE} = \\mathbb{E}\\big[Y_{1,M_0} - Y_{0,M_0}\\big], \\qquad\n\\text{PNIE} = \\mathbb{E}\\big[Y_{0,M_1} - Y_{0,M_0}\\big],\n$$\nselect the single option that correctly:\n(i) specifies an appropriate regression-based test for the $A \\times M$ interaction and carries it out with the given summaries, and\n(ii) states the correct implications of the presence of interaction for estimation of PNDE and PNIE under the identity-link outcome model and gives their numeric values implied by the fitted models.\n\nA. Use a Wald test of $H_0\\!:\\, \\beta_3 = 0$ based on $\\hat{\\beta}_3/\\mathrm{SE}(\\hat{\\beta}_3)$; here, $z \\approx -0.8/0.35 \\approx -2.29$, two-sided $p \\approx 0.022$, indicating evidence of interaction. With interaction present under an identity-link outcome model, PNDE depends on the distribution of $M$ under $A=0$ and equals $\\beta_1 + \\beta_3 \\,\\mathbb{E}[M_0]$, while PNIE does not involve $\\beta_3$ and equals $\\beta_2\\{\\mathbb{E}[M_1]-\\mathbb{E}[M_0]\\}$. Numerically, $\\mathbb{E}[M_0]=\\alpha_0=2.0$ and $\\mathbb{E}[M_1]-\\mathbb{E}[M_0]=\\alpha_1=-0.5$, so PNDE $=\\;1.2+(-0.8)\\times 2.0=\\,-0.4$ and PNIE $=\\;3.0\\times(-0.5)=\\,-1.5$.\n\nB. Jointly test $H_0\\!:\\, \\beta_2=\\beta_3=0$ using a two degree-of-freedom Wald test; because $\\hat{\\beta}_3$ is not large relative to its standard error, conclude no interaction. With interaction present, approximate PNDE by $\\beta_1$ and PNIE by $\\alpha_1(\\beta_2+\\beta_3)$; numerically, PNDE $=\\;1.2$ and PNIE $=\\;-0.5\\times(3.0-0.8)=\\,-1.1$.\n\nC. Use a likelihood ratio test comparing the outcome model with and without $A \\times M$; with $1$ degree of freedom and a typical improvement consistent with $\\hat{\\beta}_3=-0.8$, conclude a two-sided $p \\approx 0.02$ and evidence of interaction. Because interaction is present, PNDE and PNIE are not identified and have no meaningful interpretation, so they should not be estimated.\n\nD. Use a Wald test of $H_0\\!:\\, \\beta_3 = 0$ with $z \\approx -0.8/0.35 \\approx -2.29$, but because $|z|<2.58$, conclude no interaction at the $5\\%$ level. With interaction present, PNDE equals $\\beta_1 + \\beta_3 \\,\\mathbb{E}[M_1]$ and PNIE equals $\\beta_2\\,\\alpha_1 + \\beta_3\\,\\alpha_1\\,\\mathbb{E}[M_0]$. Numerically, PNDE $=\\;1.2+(-0.8)\\times 1.5=\\;0.0$ and PNIE $=\\;3.0\\times(-0.5)+(-0.8)\\times(-0.5)\\times 2.0=\\;-0.7$.",
            "solution": "### Step 1: Extract Givens\n\nThe problem provides the following information for a mediation analysis:\n-   Binary treatment: $A \\in \\{0,1\\}$\n-   Continuous mediator: $M$\n-   Continuous outcome: $Y$\n-   Assumptions: $A$ is randomized; sequential ignorability ($Y_{a,m} \\perp M_a' | A=a'$ and $M_a \\perp \\!\\!\\! \\perp A$); consistency; positivity.\n-   Mediator Model: $M = \\alpha_0 + \\alpha_1 A + \\eta$, where $\\mathbb{E}[\\eta]=0$.\n-   Outcome Model (Identity Link): $Y = \\beta_0 + \\beta_1 A + \\beta_2 M + \\beta_3 (A \\times M) + \\varepsilon$, where $\\mathbb{E}[\\varepsilon]=0$.\n-   Fitted Model Parameters: $\\hat{\\alpha}_0 = 2.0$, $\\hat{\\alpha}_1 = -0.5$, $\\hat{\\beta}_0 = 10.0$, $\\hat{\\beta}_1 = 1.2$, $\\hat{\\beta}_2 = 3.0$, $\\hat{\\beta}_3 = -0.8$.\n-   Uncertainty Summary: $\\mathrm{SE}(\\hat{\\beta}_3) = 0.35$.\n-   Potential Outcomes Definitions:\n    -   Pure Natural Direct Effect (PNDE): $\\text{PNDE} = \\mathbb{E}[Y_{1,M_0} - Y_{0,M_0}]$\n    -   Pure Natural Indirect Effect (PNIE): $\\text{PNIE} = \\mathbb{E}[Y_{0,M_1} - Y_{0,M_0}]$\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is situated within the well-established framework of causal mediation analysis using potential outcomes and regression modeling. The concepts of PNDE, PNIE, and sequential ignorability are standard in this field. The models are linear, which is a common and valid simplification.\n-   **Well-Posed**: The problem provides all necessary definitions, models, and estimated coefficients to perform the required tasks: testing for interaction and calculating the causal effects. The question is specific and leads to a unique solution based on the provided information.\n-   **Objective**: The problem is stated in precise, objective mathematical and statistical language. There are no subjective or ambiguous terms.\n-   **No Flaws Detected**: The problem does not violate any of the invalidity criteria. It is a standard, solvable problem in applied statistics and causal inference.\n\n### Step 3: Verdict and Action\n\nThe problem statement is valid. The solution process will proceed.\n\n### Derivation of Causal Effects and Interaction Test\n\nThe task is twofold: (i) test for an A x M interaction and (ii) determine the expressions and values for PNDE and PNIE.\n\n#### (i) Test for Interaction\n\nThe outcome model is $Y = \\beta_0 + \\beta_1 A + \\beta_2 M + \\beta_3 (A \\times M) + \\varepsilon$. The term $(A \\times M)$ represents the interaction between the treatment $A$ and the mediator $M$. The coefficient $\\beta_3$ quantifies the magnitude of this interaction. The presence of a statistically significant interaction is assessed by testing the null hypothesis $H_0: \\beta_3 = 0$ against the alternative $H_1: \\beta_3 \\neq 0$.\n\nGiven the large-sample regression context, the appropriate test for a single parameter is a Wald test. The Wald test statistic, $z$, is calculated as the ratio of the estimated coefficient to its standard error:\n$$\nz = \\frac{\\hat{\\beta}_3}{\\mathrm{SE}(\\hat{\\beta}_3)}\n$$\nUsing the provided values:\n$$\nz = \\frac{-0.8}{0.35} \\approx -2.2857\n$$\nRounding to two decimal places gives $z \\approx -2.29$. The two-sided $p$-value for this $z$-statistic is given by $P(|Z| \\ge |-2.29|)$, where $Z$ is a standard normal random variable. This is $2 \\times \\Phi(-2.29)$, where $\\Phi$ is the standard normal cumulative distribution function.\n$$\np\\text{-value} \\approx 2 \\times 0.0110 = 0.022\n$$\nSince the $p$-value of $0.022$ is less than the conventional significance level of $\\alpha=0.05$, we reject the null hypothesis $H_0: \\beta_3 = 0$ and conclude that there is statistically significant evidence of an interaction between treatment $A$ and mediator $M$.\n\n#### (ii) Implications and Calculation of PNDE and PNIE\n\nUnder the given modeling assumptions and the consistency assumption (i.e., $Y=Y_A$ and $M=M_A$), the population-level expectation of the potential outcome $Y_{a,m}$ is given by the regression equation, averaged over the error distribution:\n$$\n\\mathbb{E}[Y_{a,m}] = \\beta_0 + \\beta_1 a + \\beta_2 m + \\beta_3 (a \\times m)\n$$\nSimilarly, the potential mediator $M_a$ under treatment level $a$ has an expected value derived from the mediator model:\n$$\n\\mathbb{E}[M_a] = \\mathbb{E}[\\alpha_0 + \\alpha_1 a + \\eta] = \\alpha_0 + \\alpha_1 a\n$$\nSpecifically, for $a=0$ and $a=1$:\n$$\n\\mathbb{E}[M_0] = \\alpha_0\n$$\n$$\n\\mathbb{E}[M_1] = \\alpha_0 + \\alpha_1\n$$\n\nNow, we derive the expressions for PNDE and PNIE using their definitions.\n\n**Pure Natural Direct Effect (PNDE):**\n$$\n\\text{PNDE} = \\mathbb{E}[Y_{1,M_0} - Y_{0,M_0}]\n$$\nUsing the law of total expectation, we have $\\mathbb{E}[Y_{a,M_b}] = \\mathbb{E}[\\mathbb{E}[Y_{a,M_b}|M_b]] = \\mathbb{E}[\\beta_0 + \\beta_1 a + \\beta_2 M_b + \\beta_3 (a \\times M_b)]$.\n$$\n\\text{PNDE} = \\mathbb{E}[\\beta_0 + \\beta_1(1) + \\beta_2 M_0 + \\beta_3(1 \\times M_0)] - \\mathbb{E}[\\beta_0 + \\beta_1(0) + \\beta_2 M_0 + \\beta_3(0 \\times M_0)]\n$$\n$$\n\\text{PNDE} = \\mathbb{E}[\\beta_0 + \\beta_1 + \\beta_2 M_0 + \\beta_3 M_0] - \\mathbb{E}[\\beta_0 + \\beta_2 M_0]\n$$\nBy linearity of expectation:\n$$\n\\text{PNDE} = (\\beta_0 + \\beta_1 + \\beta_2 \\mathbb{E}[M_0] + \\beta_3 \\mathbb{E}[M_0]) - (\\beta_0 + \\beta_2 \\mathbb{E}[M_0])\n$$\n$$\n\\text{PNDE} = \\beta_1 + \\beta_3 \\mathbb{E}[M_0]\n$$\nSubstituting $\\mathbb{E}[M_0] = \\alpha_0$:\n$$\n\\text{PNDE} = \\beta_1 + \\beta_3 \\alpha_0\n$$\nWith interaction ($\\beta_3 \\neq 0$), the PNDE depends on the level of the mediator under the control condition, $\\mathbb{E}[M_0]$.\n\n**Pure Natural Indirect Effect (PNIE):**\n$$\n\\text{PNIE} = \\mathbb{E}[Y_{0,M_1} - Y_{0,M_0}]\n$$\n$$\n\\text{PNIE} = \\mathbb{E}[\\beta_0 + \\beta_1(0) + \\beta_2 M_1 + \\beta_3(0 \\times M_1)] - \\mathbb{E}[\\beta_0 + \\beta_1(0) + \\beta_2 M_0 + \\beta_3(0 \\times M_0)]\n$$\n$$\n\\text{PNIE} = \\mathbb{E}[\\beta_0 + \\beta_2 M_1] - \\mathbb{E}[\\beta_0 + \\beta_2 M_0]\n$$\nBy linearity of expectation:\n$$\n\\text{PNIE} = (\\beta_0 + \\beta_2 \\mathbb{E}[M_1]) - (\\beta_0 + \\beta_2 \\mathbb{E}[M_0])\n$$\n$$\n\\text{PNIE} = \\beta_2 (\\mathbb{E}[M_1] - \\mathbb{E}[M_0])\n$$\nSubstituting $\\mathbb{E}[M_1] - \\mathbb{E}[M_0] = (\\alpha_0 + \\alpha_1) - \\alpha_0 = \\alpha_1$:\n$$\n\\text{PNIE} = \\beta_2 \\alpha_1\n$$\nThe expression for PNIE does not involve the interaction coefficient $\\beta_3$.\n\n**Numerical Calculation:**\nUsing the provided fitted values: $\\hat{\\alpha}_0 = 2.0$, $\\hat{\\alpha}_1 = -0.5$, $\\hat{\\beta}_1 = 1.2$, $\\hat{\\beta}_2 = 3.0$, $\\hat{\\beta}_3 = -0.8$.\n$$\n\\widehat{\\text{PNDE}} = \\hat{\\beta}_1 + \\hat{\\beta}_3 \\hat{\\alpha}_0 = 1.2 + (-0.8)(2.0) = 1.2 - 1.6 = -0.4\n$$\n$$\n\\widehat{\\text{PNIE}} = \\hat{\\beta}_2 \\hat{\\alpha}_1 = (3.0)(-0.5) = -1.5\n$$\n\n### Option-by-Option Analysis\n\n**Option A:**\n- **(i) Interaction test**: States to use a Wald test for $H_0: \\beta_3=0$, calculates $z \\approx -2.29$ with $p \\approx 0.022$, and correctly concludes evidence of interaction. This matches our derivation.\n- **(ii) Implications and values**: States that PNDE equals $\\beta_1 + \\beta_3 \\mathbb{E}[M_0]$ and PNIE equals $\\beta_2\\{\\mathbb{E}[M_1]-\\mathbb{E}[M_0]\\}$. These expressions are correct. It then correctly substitutes $\\mathbb{E}[M_0]=\\alpha_0$ and $\\mathbb{E}[M_1]-\\mathbb{E}[M_0]=\\alpha_1$. It calculates the estimates as PNDE $= -0.4$ and PNIE $= -1.5$. These calculations are also correct.\n- **Verdict**: **Correct**.\n\n**Option B:**\n- **(i) Interaction test**: Proposes a joint test of $H_0: \\beta_2=\\beta_3=0$. This is not the correct test for interaction alone; it tests for any effect involving the mediator path. It also incorrectly concludes no interaction based on a subjective assessment of the test statistic.\n- **(ii) Implications and values**: The expression for PNIE, $\\alpha_1(\\beta_2+\\beta_3)$, is incorrect; this is the expression for the Total Natural Indirect Effect (TNIE). The approximation for PNDE, $\\beta_1$, is only valid if $\\beta_3 = 0$, which is contrary to the evidence.\n- **Verdict**: **Incorrect**.\n\n**Option C:**\n- **(i) Interaction test**: Proposes a likelihood ratio test, which is a valid alternative, and reaches a conclusion consistent with the Wald test. This part is plausible.\n- **(ii) Implications and values**: Claims that PNDE and PNIE are not identified in the presence of interaction. This is fundamentally false. The effects are well-defined and are identified under the stated assumptions and model structure, as shown by our derivation of their expressions in terms of model parameters.\n- **Verdict**: **Incorrect**.\n\n**Option D:**\n- **(i) Interaction test**: Correctly identifies the Wald test and calculates the $z$-statistic. However, it draws the wrong conclusion, stating \"no interaction at the $5\\%$ level\" because $|z| < 2.58$. The critical value for a two-sided $5\\%$ test is $z_{\\alpha/2} = 1.96$. Since $|-2.29| > 1.96$, the null should be rejected. The value $2.58$ corresponds to a $1\\%$ significance level.\n- **(ii) Implications and values**: The formula for PNDE, $\\beta_1 + \\beta_3 \\mathbb{E}[M_1]$, is incorrect; it should use $\\mathbb{E}[M_0]$. The formula for PNIE, $\\beta_2\\alpha_1 + \\beta_3\\alpha_1\\mathbb{E}[M_0]$, is also incorrect; it should be just $\\beta_2\\alpha_1$.\n- **Verdict**: **Incorrect**.\n\nBased on the thorough analysis, only option A correctly performs the statistical test, interprets its meaning, derives the correct expressions for the causal effects in the presence of interaction, and calculates their values correctly.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "After calculating point estimates for the Natural Direct and Indirect Effects, a crucial final step is to quantify their statistical uncertainty. Because these effects are often complex, nonlinear functions of model parameters, their sampling distributions can be skewed, rendering standard normal-based confidence intervals unreliable in smaller samples. This practice introduces the nonparametric bootstrap as a robust and computationally intensive, yet powerful, method for constructing accurate confidence intervals, which is essential for rigorous scientific inference in mediation analysis. ",
            "id": "4972590",
            "problem": "A randomized clinical trial evaluates a new anti-inflammatory therapy with treatment indicator $A \\in \\{0,1\\}$ assigned at baseline. A mediator $M$ is a post-treatment serum biomarker measured at $2$ weeks, and the primary outcome $Y \\in \\{0,1\\}$ is remission at $6$ months. Baseline covariates $X$ are recorded. The analyst seeks to estimate the Natural Direct Effect (NDE) and Natural Indirect Effect (NIE) of $A$ on $Y$ through $M$ under standard causal identification conditions: consistency, positivity, and sequential ignorability (no unmeasured confounding of $A \\rightarrow M$ and $M \\rightarrow Y$ given $X$, and no exposure-induced confounding of the $M \\rightarrow Y$ path). The analyst fits parametric models for the mediator, $p(M \\mid A, X)$, and for the outcome, $p(Y \\mid A, M, X)$, and uses a plug-in procedure based on model-based predictions and integration over the empirical distribution of $X$ and the mediator model to estimate the NDE and NIE. The sample size is $n=120$, and there is moderate skewness in the estimated effects.\n\nFrom first principles of the bootstrap and the properties of nonlinear functionals of estimated nuisance models, select all options that correctly outline a bootstrap procedure to obtain confidence intervals for the NDE and NIE and correctly justify its use over normal approximations in small samples.\n\nA. Nonparametric bootstrap at the individual level: draw $B$ replicate datasets by resampling $n$ patients with replacement from the empirical distribution of $(Y, M, A, X)$; in each replicate $b$, refit $p(M \\mid A, X)$ and $p(Y \\mid A, M, X)$ using the bootstrap sample, recompute the plug-in estimates $\\widehat{\\mathrm{NDE}}^{(b)}$ and $\\widehat{\\mathrm{NIE}}^{(b)}$ with the same procedure applied to the original data, and form $1-\\alpha$ confidence intervals using the percentile or Bias-Corrected and Accelerated (BCa) method based on $\\{\\widehat{\\mathrm{NDE}}^{(b)}\\}_{b=1}^B$ and $\\{\\widehat{\\mathrm{NIE}}^{(b)}\\}_{b=1}^B$. Justification: because the NDE and NIE are nonlinear functionals of estimated nuisance models, their sampling distributions can be skewed in small $n$, and the bootstrap better captures this than normal approximations.\n\nB. Parametric bootstrap of the mediator only: simulate $B$ new mediator datasets $\\{M^{(b)}\\}$ from the fitted $p(M \\mid A, X)$ while keeping the outcome model $p(Y \\mid A, M, X)$ fixed at its original parameter estimates without refitting; recompute $\\widehat{\\mathrm{NDE}}^{(b)}$ and $\\widehat{\\mathrm{NIE}}^{(b)}$ for each $b$; then form normal confidence intervals using a delta-method approximation around the original estimates. Justification: fixing the outcome model stabilizes the bootstrap and normal approximations are adequate.\n\nC. Residual bootstrap on the outcome model: for the binary outcome, compute residuals from the fitted logistic regression for $p(Y \\mid A, M, X)$, resample these residuals and add them to the fitted linear predictors to form $B$ pseudo-datasets for $Y$ while holding $M$, $A$, and $X$ fixed; recompute the plug-in NDE and NIE without refitting the mediator model; construct normal confidence intervals using the empirical variance of the bootstrap estimates. Justification: residual resampling mimics sampling variation even with binary outcomes.\n\nD. Stratified nonparametric bootstrap by treatment arm: within each level of $A$, draw with replacement $n_0$ and $n_1$ patients to match the original counts, forming $B$ replicate datasets that preserve randomization proportions; in each bootstrap sample, refit both $p(M \\mid A, X)$ and $p(Y \\mid A, M, X)$, recompute $\\widehat{\\mathrm{NDE}}^{(b)}$ and $\\widehat{\\mathrm{NIE}}^{(b)}$, and use BCa intervals at level $1-\\alpha$. Justification: stratification respects the randomized design, reduces Monte Carlo variability of treatment allocation, and BCa intervals accommodate bias and skewness of the nonlinear effect functionals in small samples.\n\nE. Asymptotic normal confidence intervals only: compute $\\widehat{\\mathrm{NDE}}$ and $\\widehat{\\mathrm{NIE}}$ once, derive their asymptotic variances via a sandwich estimator or the Sobel delta-method for products of coefficients, and form symmetric $1-\\alpha$ intervals assuming normality. Justification: the Central Limit Theorem ensures normality even for nonlinear mappings at $n=120$, so bootstrap is unnecessary.\n\nSelect all that apply.",
            "solution": "The user wants a critical validation of the problem statement, followed by a detailed solution and evaluation of options regarding bootstrap confidence intervals for causal mediation effects.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Study Design:** A randomized clinical trial.\n- **Treatment:** $A \\in \\{0,1\\}$, assigned at baseline.\n- **Mediator:** $M$, post-treatment serum biomarker measured at $2$ weeks.\n- **Outcome:** $Y \\in \\{0,1\\}$, remission at $6$ months.\n- **Covariates:** $X$, baseline covariates.\n- **Objective:** Estimate the Natural Direct Effect (NDE) and Natural Indirect Effect (NIE) of $A$ on $Y$ through $M$.\n- **Causal Assumptions:** Consistency, positivity, and sequential ignorability (no unmeasured confounding of $A \\rightarrow M$ and $M \\rightarrow Y$ given $X$, and no exposure-induced confounding of the $M \\rightarrow Y$ path).\n- **Estimation Procedure:**\n    1. Fit parametric models for the mediator, $p(M \\mid A, X)$, and the outcome, $p(Y \\mid A, M, X)$.\n    2. Use a plug-in procedure with model-based predictions and integration over the empirical distribution of $X$ and the mediator model to obtain point estimates of NDE and NIE.\n- **Sample Characteristics:** Sample size $n=120$; moderate skewness in the estimated effects.\n- **Question:** Select all options that correctly outline a bootstrap procedure for confidence intervals for NDE and NIE and justify its use over normal approximations in small samples.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a standard causal mediation analysis, a well-established discipline within statistics and its applications in medicine. The definitions of NDE and NIE, the identification assumptions (sequential ignorability), and the use of a plug-in estimator based on parametric models are all standard and correct components of this framework.\n- **Well-Posed:** The problem is well-posed. It asks for an evaluation of different bootstrap procedures for constructing confidence intervals for well-defined statistical quantities (NDE, NIE). The context provided is sufficient to determine the appropriateness of each proposed method.\n- **Objective:** The problem is stated in precise, objective, and technical language common to statistics and biostatistics. The mention of \"moderate skewness in the estimated effects\" is a crucial, objective piece of information that guides the choice of inferential procedure.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, objective, and self-contained. There are no contradictions, ambiguities, or factual errors. Therefore, the problem is **valid**. We may proceed to the solution.\n\n### Derivation and Option Analysis\n\nThe core of the problem lies in obtaining valid confidence intervals for the Natural Direct Effect (NDE) and Natural Indirect Effect (NIE). Under the stated assumptions, these are identified via the \"mediation formula\":\n$$E[Y(a, M(a'))] = \\int_x \\left( \\int_m E[Y \\mid A=a, M=m, X=x] \\, dP(M=m \\mid A=a', X=x) \\right) \\, dP(X=x)$$\nThe NDE and NIE are then defined as contrasts of these potential outcome means:\n$$\\mathrm{NDE} = E[Y(1, M(0))] - E[Y(0, M(0))]$$\n$$\\mathrm{NIE} = E[Y(1, M(1))] - E[Y(1, M(0))]$$\nThe problem states that a plug-in estimator is used. This means we first estimate the conditional expectations and probabilities by fitting models: $\\hat{p}(Y \\mid A, M, X)$ and $\\hat{p}(M \\mid A, X)$. Then, we replace the true functions and distributions with these estimates and the empirical distribution of $X$, respectively, to compute $\\widehat{\\mathrm{NDE}}$ and $\\widehat{\\mathrm{NIE}}$. For a sample of size $n$, this looks like:\n$$\\widehat{E}[Y(a, M(a'))] = \\frac{1}{n} \\sum_{i=1}^n \\left( \\int_m \\hat{p}(Y=1 \\mid A=a, M=m, X=X_i) \\, \\hat{p}(M=m \\mid A=a', X=X_i) \\, dm \\right)$$\n\nThese estimators, $\\widehat{\\mathrm{NDE}}$ and $\\widehat{\\mathrm{NIE}}$, are complex and nonlinear functions of the parameters of the two fitted models. While they are asymptotically normal under regularity conditions (due to the Central Limit Theorem and the Delta method), this approximation can be poor in finite samples. The problem specifies a sample size of $n=120$, which is small to moderate, and explicitly notes \"moderate skewness in the estimated effects.\" This indicates that the sampling distributions of $\\widehat{\\mathrm{NDE}}$ and $\\widehat{\\mathrm{NIE}}$ are likely not symmetric, making confidence intervals based on the normal approximation (e.g., $\\hat{\\theta} \\pm z_{1-\\alpha/2} \\times \\widehat{\\mathrm{SE}}$) potentially inaccurate in terms of coverage probability.\n\nThe bootstrap is an excellent alternative for obtaining confidence intervals in such situations. A valid bootstrap procedure must mimic the full data-generating and estimation process to capture all sources of sampling uncertainty. In this case, uncertainty arises from both the estimation of the mediator model $p(M \\mid A, X)$ and the outcome model $p(Y \\mid A, M, X)$.\n\n**Analysis of Options:**\n\n**A. Nonparametric bootstrap at the individual level...**\n- **Procedure:** This option describes the standard nonparametric bootstrap. It involves resampling entire observation vectors $(Y_i, M_i, A_i, X_i)$ with replacement. In each bootstrap replicate, both the mediator model $p(M \\mid A, X)$ and the outcome model $p(Y \\mid A, M, X)$ are re-estimated from scratch. The NDE and NIE are then recomputed. This process correctly emulates the original sampling and estimation procedure, thereby capturing the full sampling variability, including that from fitting both nuisance models.\n- **CI Construction:** It proposes using percentile or BCa (Bias-Corrected and Accelerated) intervals. Both are standard bootstrap CI methods. The BCa method is particularly adept at handling the bias and skewness mentioned in the problem, offering better performance than simple percentile or normal-approximation-based intervals.\n- **Justification:** The justification correctly points out that the NDE and NIE are nonlinear functionals, their sampling distributions can be skewed in small samples ($n=120$), and the bootstrap is superior to normal approximations in capturing such skewness.\n- **Verdict:** **Correct**. This is a textbook application of the nonparametric bootstrap for a complex estimator.\n\n**B. Parametric bootstrap of the mediator only...**\n- **Procedure:** This procedure is flawed. It only resamples the mediator $M$ from its fitted model, but crucially, it keeps the outcome model $p(Y \\mid A, M, X)$ fixed. This fails to account for the sampling uncertainty associated with estimating the parameters of the outcome model. By ignoring a source of variation, the resulting confidence intervals will be too narrow and will undercover.\n- **CI Construction:** It proposes using normal confidence intervals, which negates one of the main advantages of the bootstrap: the ability to form intervals without assuming normality. This is inconsistent with the problem's observation of skewness.\n- **Justification:** The justification is weak and incorrect. Claiming that fixing one model \"stabilizes\" the bootstrap does not justify ignoring a source of uncertainty. Stating that normal approximations are adequate contradicts the problem premise.\n- **Verdict:** **Incorrect**.\n\n**C. Residual bootstrap on the outcome model...**\n- **Procedure:** This procedure has two major flaws. First, applying a simple residual bootstrap to a binary outcome $Y \\in \\{0,1\\}$ from a logistic model is not straightforward or valid. The residuals $Y_i - \\hat{p}_i$ are not from a common distribution, and simply resampling and adding them does not guarantee a valid binary outcome. Second, like option B, it fails to refit the mediator model, thus ignoring the uncertainty from its estimation.\n- **CI Construction:** It suggests normal confidence intervals, which is suboptimal for skewed distributions.\n- **Justification:** The claim that \"residual resampling mimics sampling variation even with binary outcomes\" is false for the simple procedure described.\n- **Verdict:** **Incorrect**.\n\n**D. Stratified nonparametric bootstrap by treatment arm...**\n- **Procedure:** This option proposes a stratified nonparametric bootstrap. Since the treatment $A$ was assigned in a randomized trial, the number of individuals in each arm ($n_0$ and $n_1$) is fixed by the study design. Simple nonparametric resampling (as in A) allows these numbers to vary across bootstrap samples. Stratifying the resampling by treatment arm (i.e., sampling $n_0$ from the control group and $n_1$ from the treatment group, with replacement) honors the fixed-by-design nature of the treatment allocation. This is a valid refinement that can increase precision and better reflect the original study design. The rest of the procedure—refitting both models and recomputing the effects—is correct for the same reasons as in option A.\n- **CI Construction:** It advocates for BCa intervals, which is the most appropriate choice given the potential for bias and skewness.\n- **Justification:** The justification is excellent. It correctly states that stratification respects the randomized design and that BCa intervals accommodate the known issues of bias and skewness with nonlinear estimators in small samples.\n- **Verdict:** **Correct**. This describes a superior, yet still fundamentally correct, bootstrap procedure compared to option A for a randomized trial context.\n\n**E. Asymptotic normal confidence intervals only...**\n- **Procedure:** This describes the classic \"large-sample\" approach using the Delta method (or its robust sandwich variant).\n- **Justification:** The justification is the critical point of failure. It claims that the Central Limit Theorem \"ensures normality\" at $n=120$. This is a misinterpretation. The CLT ensures convergence to a normal distribution *as $n \\to \\infty$*. For a finite sample of $n=120$ and a complex, nonlinear estimator, the approximation can be poor. The problem statement provides direct evidence against this assumption by noting \"moderate skewness in the estimated effects,\" making symmetric, normal-based intervals inappropriate. Therefore, declaring the bootstrap \"unnecessary\" is incorrect.\n- **Verdict:** **Incorrect**.\n\nIn conclusion, options A and D both describe valid and appropriate bootstrap procedures. Option D is a methodologically sound refinement of A for the specific context of a randomized trial. Both are correct choices.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}