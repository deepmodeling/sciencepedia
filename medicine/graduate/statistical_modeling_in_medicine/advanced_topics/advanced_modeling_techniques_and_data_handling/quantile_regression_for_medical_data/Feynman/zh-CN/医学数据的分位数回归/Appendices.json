{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握分位数回归，我们必须首先理解其核心引擎：弹球损失函数 (pinball loss function)，也称为检验损失 (check loss)。与普通最小二乘法对所有误差进行二次惩罚不同，分位数回归使用一种非对称的损失函数 $\\rho_{\\tau}(u) = u(\\tau - \\mathbf{1}\\{u \\lt 0\\})$，使我们能够精确地对准结果分布的任何特定分位数 $\\tau$。本练习  提供了计算该损失函数的基础实践，让您亲身体验不同分位数如何对高估和低估的预测误差施加不同的权重，从而建立对分位数回归工作原理的直观理解。",
            "id": "4981835",
            "problem": "给定应用于成年患者空腹血糖测量的几个分位数回归 (QR) 模型的拟合残差。分位数回归 (QR) 通过最小化一个非对称绝对偏差准则来估计条件分位数，该准则根据选定的分位数水平对上尾和下尾误差进行不同程度的惩罚。设患者 $i$ 的残差为 $e_i = y_i - \\hat{y}_i$，其中 $y_i$ 是观察到的血糖浓度，单位为 $\\mathrm{mg/dL}$，而 $\\hat{y}_i$ 是模型预测值。上尾误差对应于 $e_i  0$ 的残差（观测值超过预测值），下尾误差对应于 $e_i  0$ 的残差（观测值低于预测值）。\n\n从核心定义出发，即对于 $\\tau \\in (0,1)$，条件 $\\tau$-分位数是通过最小化一个根据残差符号对其贡献进行差异化加权的非对称绝对偏差风险来获得的。请为每个测试用例计算：\n- 总弹球损失（单位为 $\\mathrm{mg/dL}$），通过对指定 $\\tau$ 的所有残差的非对称绝对偏差贡献进行汇总得到。\n- 上尾损失分量（单位为 $\\mathrm{mg/dL}$），定义为在相同的非对称绝对偏差原则下，由 $e_i  0$ 的残差所贡献的总弹球损失部分。\n- 上尾误差对总弹球损失的贡献分数，以小数表示。如果总弹球损失为零，则将此分数定义为 $0.0$。\n- 一个布尔值，指示上尾误差是否主导总弹球损失，定义为该分数严格大于 $0.5$。\n\n所有损失量必须以 $\\mathrm{mg/dL}$ 表示，所有分数必须是小数。对于每个测试用例，返回一个包含 $[\\text{total\\_loss}, \\text{upper\\_tail\\_loss}, \\text{fraction\\_upper\\_tail}, \\text{dominates}]$ 的列表。\n\n使用以下分位数水平和残差集的测试套件（所有残差单位均为 $\\mathrm{mg/dL}$）：\n- 测试用例 $1$：$\\tau = 0.5$，残差 $\\{ -10, 5, -3, 8, 0 \\}$。\n- 测试用例 $2$：$\\tau = 0.9$，残差 $\\{ 2, 15, 40, -5, -1 \\}$。\n- 测试用例 $3$：$\\tau = 0.1$，残差 $\\{ -20, -10, -5, 0, 3 \\}$。\n- 测试用例 $4$：$\\tau = 0.7$，残差 $\\{ 0, 0, 0 \\}$。\n- 测试用例 $5$：$\\tau = 0.8$，残差 $\\{ 5, 10, 0.5 \\}$。\n- 测试用例 $6$：$\\tau = 0.8$，残差 $\\{ -7, -3, -0.5 \\}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果都按上述顺序格式化为列表。例如，输出应类似于 $[ [\\dots], [\\dots], \\dots ]$，不含任何额外文本。确保所有数值量中，损失以 $\\mathrm{mg/dL}$ 表示，分数以小数表示。",
            "solution": "该问题要求计算与弹球损失函数相关的几个量，该函数是分位数回归的核心。验证过程确认了该问题具有科学依据、提法明确，并包含了获得唯一解所需的所有信息。\n\n基本概念是弹球损失函数，对于给定的分位数水平 $\\tau \\in (0,1)$ 和单个残差 $u$，记为 $\\rho_\\tau(u)$。问题将其描述为“非对称绝对偏差风险”。数学上，它定义为：\n$$\n\\rho_\\tau(u) = \\begin{cases} \\tau u  \\text{if } u \\ge 0 \\\\ (\\tau - 1) u  \\text{if } u  0 \\end{cases}\n$$\n该函数非对称地惩罚正残差（低估，$u > 0$）和负残差（高估，$u  0$）。正残差的权重是 $\\tau$，负残差绝对值的权重是 $1-\\tau$，因为对于 $u0$，有 $(\\tau-1)u = -(1-\\tau)u = (1-\\tau)|u|$。\n\n对于给定的残差集 $\\{e_1, e_2, \\dots, e_n\\}$，我们可以如下定义所需的量：\n\n1.  **总弹球损失 ($L_{\\text{total}}$)**：这是所有残差的总损失。通过对每个单独残差 $e_i$ 的弹球损失求和来计算。\n    $$\n    L_{\\text{total}} = \\sum_{i=1}^{n} \\rho_\\tau(e_i) = \\sum_{i: e_i \\ge 0} \\tau e_i + \\sum_{i: e_i  0} (\\tau - 1) e_i\n    $$\n    所有量的单位均为 $\\mathrm{mg/dL}$，与残差单位一致。\n\n2.  **上尾损失分量 ($L_{\\text{upper}}$)**：这是仅由正残差 ($e_i > 0$) 贡献的总损失部分。根据 $\\rho_\\tau(u)$ 的定义，该分量为：\n    $$\n    L_{\\text{upper}} = \\sum_{i: e_i > 0} \\tau e_i\n    $$\n    根据问题规范“残差 $e_i > 0$”，$e_i=0$ 的残差对总损失的贡献为 $0$，不包含在此求和中。\n\n3.  **上尾损失分数 ($F_{\\text{upper}}$)**：这是上尾损失与总损失的比率。对于总损失为零的情况，提供了一个特殊条件。\n    $$\n    F_{\\text{upper}} = \\begin{cases} \\frac{L_{\\text{upper}}}{L_{\\text{total}}}  \\text{if } L_{\\text{total}} > 0 \\\\ 0.0  \\text{if } L_{\\text{total}} = 0 \\end{cases}\n    $$\n\n4.  **主导布尔值 ($D_{\\text{upper}}$)**：这是一个布尔值，指示上尾损失是否严格构成总损失的一半以上。\n    $$\n    D_{\\text{upper}} = (F_{\\text{upper}} > 0.5)\n    $$\n\n我们现在将这些定义应用于每个测试用例。\n\n**测试用例 1：** $\\tau = 0.5$，残差 $\\{ -10, 5, -3, 8, 0 \\}$。\n正残差为 $\\{5, 8\\}$，负残差为 $\\{-10, -3\\}$。\n$L_{\\text{upper}} = 0.5 \\times (5 + 8) = 0.5 \\times 13 = 6.5$。\n来自负残差的损失是 $(0.5 - 1) \\times (-10 - 3) = -0.5 \\times (-13) = 6.5$。\n$L_{\\text{total}} = 6.5 + 6.5 = 13.0$。\n$F_{\\text{upper}} = 6.5 / 13.0 = 0.5$。\n$D_{\\text{upper}} = (0.5 > 0.5)$ 为假。\n结果: $[13.0, 6.5, 0.5, \\text{False}]$\n\n**测试用例 2：** $\\tau = 0.9$，残差 $\\{ 2, 15, 40, -5, -1 \\}$。\n正残差为 $\\{2, 15, 40\\}$，负残差为 $\\{-5, -1\\}$。\n$L_{\\text{upper}} = 0.9 \\times (2 + 15 + 40) = 0.9 \\times 57 = 51.3$。\n来自负残差的损失是 $(0.9 - 1) \\times (-5 - 1) = -0.1 \\times (-6) = 0.6$。\n$L_{\\text{total}} = 51.3 + 0.6 = 51.9$。\n$F_{\\text{upper}} = 51.3 / 51.9 \\approx 0.988439$。\n$D_{\\text{upper}} = (0.988439 > 0.5)$ 为真。\n结果: $[51.9, 51.3, 0.988439..., \\text{True}]$\n\n**测试用例 3：** $\\tau = 0.1$，残差 $\\{ -20, -10, -5, 0, 3 \\}$。\n正残差为 $\\{3\\}$，负残差为 $\\{-20, -10, -5\\}$。\n$L_{\\text{upper}} = 0.1 \\times 3 = 0.3$。\n来自负残差的损失是 $(0.1 - 1) \\times (-20 - 10 - 5) = -0.9 \\times (-35) = 31.5$。\n$L_{\\text{total}} = 0.3 + 31.5 = 31.8$。\n$F_{\\text{upper}} = 0.3 / 31.8 \\approx 0.009434$。\n$D_{\\text{upper}} = (0.009434 > 0.5)$ 为假。\n结果: $[31.8, 0.3, 0.009434..., \\text{False}]$\n\n**测试用例 4：** $\\tau = 0.7$，残差 $\\{ 0, 0, 0 \\}$。\n没有正或负残差。所有残差均为 $0$。\n$L_{\\text{upper}} = 0.7 \\times 0 = 0.0$。\n来自负残差的损失为 $0.0$。\n$L_{\\text{total}} = 0.0$。\n根据问题定义，由于 $L_{\\text{total}} = 0$，所以 $F_{\\text{upper}} = 0.0$。\n$D_{\\text{upper}} = (0.0 > 0.5)$ 为假。\n结果: $[0.0, 0.0, 0.0, \\text{False}]$\n\n**测试用例 5：** $\\tau = 0.8$，残差 $\\{ 5, 10, 0.5 \\}$。\n所有残差均为正。\n$L_{\\text{upper}} = 0.8 \\times (5 + 10 + 0.5) = 0.8 \\times 15.5 = 12.4$。\n来自负残差的损失为 $0.0$。\n$L_{\\text{total}} = 12.4 + 0.0 = 12.4$。\n$F_{\\text{upper}} = 12.4 / 12.4 = 1.0$。\n$D_{\\text{upper}} = (1.0 > 0.5)$ 为真。\n结果: $[12.4, 12.4, 1.0, \\text{True}]$\n\n**测试用例 6：** $\\tau = 0.8$，残差 $\\{ -7, -3, -0.5 \\}$。\n所有残差均为负。\n$L_{\\text{upper}} = 0.8 \\times 0 = 0.0$。\n来自负残差的损失是 $(0.8 - 1) \\times (-7 - 3 - 0.5) = -0.2 \\times (-10.5) = 2.1$。\n$L_{\\text{total}} = 0.0 + 2.1 = 2.1$。\n$F_{\\text{upper}} = 0.0 / 2.1 = 0.0$。\n$D_{\\text{upper}} = (0.0 > 0.5)$ 为假。\n结果: $[2.1, 0.0, 0.0, \\text{False}]$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quantile regression loss metrics for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (quantile_level, list_of_residuals).\n    test_cases = [\n        (0.5, [-10, 5, -3, 8, 0]),\n        (0.9, [2, 15, 40, -5, -1]),\n        (0.1, [-20, -10, -5, 0, 3]),\n        (0.7, [0, 0, 0]),\n        (0.8, [5, 10, 0.5]),\n        (0.8, [-7, -3, -0.5]),\n    ]\n\n    results = []\n    for tau, residuals_list in test_cases:\n        # Convert list of residuals to a numpy array for efficient computation.\n        residuals = np.array(residuals_list, dtype=np.float64)\n        \n        # Isolate positive and negative residuals.\n        # Per the problem, upper-tail corresponds to e_i  0.\n        pos_residuals = residuals[residuals > 0]\n        neg_residuals = residuals[residuals  0]\n        \n        # 1. Calculate the total pinball loss.\n        # The loss is the sum of two components: one for positive/zero residuals\n        # and one for negative residuals. The pinball loss function rho_tau(u) is\n        # tau * u for u >= 0 and (tau - 1) * u for u  0.\n        \n        # Calculate the upper-tail loss component from positive residuals.\n        upper_tail_loss = tau * np.sum(pos_residuals)\n        \n        # Calculate the lower-tail loss component from negative residuals.\n        lower_tail_loss = (tau - 1) * np.sum(neg_residuals)\n        \n        # The total loss is the sum of the two components.\n        total_loss = upper_tail_loss + lower_tail_loss\n        \n        # 2. The upper_tail_loss is already calculated.\n        # It is the portion of the total pinball loss attributable to e_i  0.\n        \n        # 3. Calculate the fraction of total loss from upper-tail errors.\n        # Handle the case where total loss is zero.\n        if total_loss > 0:\n            fraction_upper_tail = upper_tail_loss / total_loss\n        else:\n            fraction_upper_tail = 0.0\n            \n        # 4. Determine if upper-tail errors dominate (fraction > 0.5).\n        dominates = fraction_upper_tail > 0.5\n        \n        # Append the results for the current test case.\n        results.append([\n            total_loss, \n            upper_tail_loss, \n            fraction_upper_tail, \n            dominates\n        ])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is used.\n    # We replace spaces to generate a more compact, but still valid, format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "通过最小化弹球损失函数拟合出分位数回归模型后，其主要用途便是为特定的条件分位数生成预测值。在医学等领域，这些预测对于构建风险评估剖面或生长曲线等参考图表非常有价值。本动手练习  将指导您完成应用一个已拟合的、包含多项式和交互项的复杂模型，来预测个体在特定高分位数下的收缩压。这个过程将抽象的统计模型转化为具体的临床洞察。",
            "id": "4981834",
            "problem": "一项关于心血管衰老的队列研究使用分位数回归对给定年龄和性别的收缩压（SBP）的条件分位数进行建模。其基本定义是，条件 $\\tau$-分位数函数 $Q_{Y}(\\tau \\mid X=x)$ 满足 $\\mathbb{P}(Y \\leq Q_{Y}(\\tau \\mid X=x) \\mid X=x) = \\tau$。分位数回归估计量 $\\hat{\\beta}(\\tau)$ 是通过在训练样本上最小化检验（弹球）损失 $\\rho_{\\tau}(u) = u\\left(\\tau - \\mathbf{1}\\{u  0\\}\\right)$ 的经验和得到的，其中 $\\mathbf{1}\\{\\cdot\\}$ 表示指示函数。在这项研究中，SBP在$\\tau = 0.9$处的条件$\\tau$-分位数的工作模型使用了标准化年龄的多项式基和与性别的交互作用：\n$$\nQ_{\\mathrm{SBP}}(0.9 \\mid a, S) = \\beta_{0}(0.9) + \\beta_{S}(0.9)\\,S + \\beta_{1}(0.9)\\,z + \\beta_{2}(0.9)\\,z^{2} + \\beta_{3}(0.9)\\,z^{3} + \\gamma_{1}(0.9)\\,S z + \\gamma_{2}(0.9)\\,S z^{2} + \\gamma_{3}(0.9)\\,S z^{3},\n$$\n其中 $a$ 是以年为单位的年龄，$S$ 是性别指示符，男性编码为 $S=1$，女性编码为 $S=0$，$z$ 是标准化年龄，定义为 $z = (a - 55)/10$。在 $\\tau = 0.9$ 处的拟合系数估计值为：\n$$\n\\hat{\\beta}_{0}(0.9) = 130,\\quad \\hat{\\beta}_{S}(0.9) = 7,\\quad \\hat{\\beta}_{1}(0.9) = 9,\\quad \\hat{\\beta}_{2}(0.9) = 1.2,\\quad \\hat{\\beta}_{3}(0.9) = -0.5,\n$$\n$$\n\\hat{\\gamma}_{1}(0.9) = 2.5,\\quad \\hat{\\gamma}_{2}(0.9) = 0.4,\\quad \\hat{\\gamma}_{3}(0.9) = -0.2.\n$$\n对于一名年龄为 $a = 72$ 岁（因此 $S = 1$）的男性患者，使用提供的 $\\hat{\\beta}(0.9)$ 值计算SBP的预测$0.9$-分位数。将您的最终答案以毫米汞柱（mmHg）为单位表示，并四舍五入到四位有效数字。",
            "solution": "对问题陈述进行有效性评估。\n\n### 第1步：提取已知信息\n- **条件分位数定义**: $\\mathbb{P}(Y \\leq Q_{Y}(\\tau \\mid X=x) \\mid X=x) = \\tau$。\n- **分位数回归估计量定义**: $\\hat{\\beta}(\\tau)$ 最小化检验损失函数 $\\rho_{\\tau}(u) = u\\left(\\tau - \\mathbf{1}\\{u  0\\}\\right)$ 的和。\n- **SBP在$\\tau=0.9$处的条件分位数模型**:\n$$\nQ_{\\mathrm{SBP}}(0.9 \\mid a, S) = \\beta_{0}(0.9) + \\beta_{S}(0.9)\\,S + \\beta_{1}(0.9)\\,z + \\beta_{2}(0.9)\\,z^{2} + \\beta_{3}(0.9)\\,z^{3} + \\gamma_{1}(0.9)\\,S z + \\gamma_{2}(0.9)\\,S z^{2} + \\gamma_{3}(0.9)\\,S z^{3}\n$$\n- **变量定义**:\n  - $a$：年龄（单位：年）。\n  - $S$：性别指示符，$S=1$ 为男性，$S=0$ 为女性。\n  - $z$：标准化年龄，$z = (a - 55)/10$。\n- **在 $\\tau=0.9$ 处的拟合系数估计值**:\n  - $\\hat{\\beta}_{0}(0.9) = 130$\n  - $\\hat{\\beta}_{S}(0.9) = 7$\n  - $\\hat{\\beta}_{1}(0.9) = 9$\n  - $\\hat{\\beta}_{2}(0.9) = 1.2$\n  - $\\hat{\\beta}_{3}(0.9) = -0.5$\n  - $\\hat{\\gamma}_{1}(0.9) = 2.5$\n  - $\\hat{\\gamma}_{2}(0.9) = 0.4$\n  - $\\hat{\\gamma}_{3}(0.9) = -0.2$\n- **任务数据**:\n  - 患者为男性，因此 $S=1$。\n  - 患者年龄为 $a = 72$ 岁。\n- **要求的输出格式**:\n  - 计算SBP的预测$0.9$-分位数。\n  - 以mmHg为单位表示答案。\n  - 四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知信息进行验证\n问题定义明确且科学上合理。\n- **科学依据**：该问题描述了分位数回归（一种成熟的统计方法）在建模生理变量（收缩压）方面的标准应用。带有交互项的多项式模型是生物统计学中的常见做法。所呈现的概念和数值都是现实的。\n- **适定性**：提供了所有必要的组成部分：明确的模型方程、全套拟合系数以及用于预测的协变量的具体值。该任务是一个直接计算，保证了唯一解。\n- **客观性**：该问题使用精确、形式化的数学和统计语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n问题有效。将推导解答。\n\n任务是计算一名年龄为$72$岁的男性患者的收缩压（SBP）的预测$0.9$-分位数。该预测值表示为 $\\hat{Q}_{\\mathrm{SBP}}(0.9 \\mid a, S)$，使用提供的拟合模型和系数进行计算。\n\n预测$\\tau=0.9$分位数的模型方程为：\n$$\n\\hat{Q}_{\\mathrm{SBP}}(0.9 \\mid a, S) = \\hat{\\beta}_{0}(0.9) + \\hat{\\beta}_{S}(0.9)\\,S + \\hat{\\beta}_{1}(0.9)\\,z + \\hat{\\beta}_{2}(0.9)\\,z^{2} + \\hat{\\beta}_{3}(0.9)\\,z^{3} + \\hat{\\gamma}_{1}(0.9)\\,S z + \\hat{\\gamma}_{2}(0.9)\\,S z^{2} + \\hat{\\gamma}_{3}(0.9)\\,S z^{3}\n$$\n患者为男性，因此性别指示符为 $S=1$。患者年龄为 $a=72$。\n\n首先，我们计算标准化年龄 $z$：\n$$\nz = \\frac{a - 55}{10} = \\frac{72 - 55}{10} = \\frac{17}{10} = 1.7\n$$\n接下来，我们计算所需的 $z$ 的幂：\n$$\nz^{2} = (1.7)^{2} = 2.89\n$$\n$$\nz^{3} = (1.7)^{3} = 4.913\n$$\n现在，将 $S=1$ 以及 $z$、$z^2$ 和 $z^3$ 的值与给定的系数估计值一起代入模型方程。为清晰起见，我们代入 $\\tau=0.9$ 并从系数表示法中省略该参数。\n$$\n\\hat{Q}_{\\mathrm{SBP}} = \\hat{\\beta}_{0} + \\hat{\\beta}_{S}S + \\hat{\\beta}_{1}z + \\hat{\\beta}_{2}z^{2} + \\hat{\\beta}_{3}z^{3} + \\hat{\\gamma}_{1}Sz + \\hat{\\gamma}_{2}Sz^{2} + \\hat{\\gamma}_{3}Sz^{3}\n$$\n代入数值：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 130 + (7)(1) + (9)(1.7) + (1.2)(2.89) + (-0.5)(4.913) + (2.5)(1)(1.7) + (0.4)(1)(2.89) + (-0.2)(1)(4.913)\n$$\n由于 $S=1$，我们可以根据 $z$ 的幂重新组合各项：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = (\\hat{\\beta}_{0} + \\hat{\\beta}_{S}) + (\\hat{\\beta}_{1} + \\hat{\\gamma}_{1})z + (\\hat{\\beta}_{2} + \\hat{\\gamma}_{2})z^{2} + (\\hat{\\beta}_{3} + \\hat{\\gamma}_{3})z^{3}\n$$\n计算组合系数：\n- 截距项：$\\hat{\\beta}_{0} + \\hat{\\beta}_{S} = 130 + 7 = 137$\n- $z$ 的系数：$\\hat{\\beta}_{1} + \\hat{\\gamma}_{1} = 9 + 2.5 = 11.5$\n- $z^2$ 的系数：$\\hat{\\beta}_{2} + \\hat{\\gamma}_{2} = 1.2 + 0.4 = 1.6$\n- $z^3$ 的系数：$\\hat{\\beta}_{3} + \\hat{\\gamma}_{3} = -0.5 + (-0.2) = -0.7$\n\n现在将这些组合系数和 $z$ 的幂代入简化后的表达式中：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 137 + (11.5)(1.7) + (1.6)(2.89) + (-0.7)(4.913)\n$$\n进行乘法运算：\n- $(11.5)(1.7) = 19.55$\n- $(1.6)(2.89) = 4.624$\n- $(-0.7)(4.913) = -3.4391$\n\n最后，将各项相加：\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 137 + 19.55 + 4.624 - 3.4391\n$$\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 156.55 + 4.624 - 3.4391\n$$\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 161.174 - 3.4391\n$$\n$$\n\\hat{Q}_{\\mathrm{SBP}} = 157.7349\n$$\n题目要求答案四舍五入到四位有效数字。该数字为 $157.7349$。前四位有效数字是 $1$、$5$、$7$ 和 $7$。第五位有效数字是 $3$，小于 $5$，因此我们向下舍入（截断）。\n四舍五入后的值为 $157.7$。",
            "answer": "$$\\boxed{157.7}$$"
        },
        {
            "introduction": "高级统计建模不仅限于做出点预测，更要进行统计推断——即量化不确定性并对不同组别进行正式比较。本实践练习  将您的技能提升到一个新层次，展示了如何在分位数回归框架内进行统计推断。您不仅需要为不同患者群体计算预测分位数，还将为其差异构建一个置信区间，这是判断观测效应是否具有统计显著性的关键一步。此过程需要同时使用系数估计值及其协方差矩阵，从而展示了一个更完整的分析工作流程。",
            "id": "4981851",
            "problem": "一项医院研究分析了成年人收缩压（以毫米汞柱，mmHg表示）的条件上尾分布，该分布被建模为年龄和性别的函数。设$Y$表示收缩压，$A$表示年龄（以年为单位），$M$表示一个二元男性指标（男性为$M=1$，女性为$M=0$）。在$\\tau=0.75$处的条件$\\tau$-分位数函数被假定为协变量的线性函数，具体为\n$$\nQ_{Y \\mid A,M}(0.75 \\mid a,m) = \\beta_0 + \\beta_A\\,a + \\beta_M\\,m + \\beta_{AM}\\,a\\,m.\n$$\n在$\\tau=0.75$处的回归系数通过分位数回归估计为$\\hat{\\beta}_{0.75} = (\\hat{\\beta}_0,\\hat{\\beta}_A,\\hat{\\beta}_M,\\hat{\\beta}_{AM})^{\\top}$，其值为\n$$\n\\hat{\\beta}_0 = 94.0,\\quad \\hat{\\beta}_A = 0.70,\\quad \\hat{\\beta}_M = 6.00,\\quad \\hat{\\beta}_{AM} = 0.03.\n$$\n$\\hat{\\beta}_{0.75}$的一个估计的渐近协方差矩阵如下：\n$$\n\\hat{V}_{0.75} =\n\\begin{pmatrix}\n6.25  -0.02  0.30  -0.015 \\\\\n-0.02  0.05  -0.005  0.0001 \\\\\n0.30  -0.005  2.89  -0.002 \\\\\n-0.015  0.0001  -0.002  0.02\n\\end{pmatrix}.\n$$\n使用这些估计值，为60岁的患者执行以下操作：\n1. 计算一位60岁女性（$M=0$）的收缩压预测0.75-分位数。\n2. 计算一位60岁男性（$M=1$）的收缩压预测0.75-分位数。\n3. 计算60岁时男性和女性预测的0.75-分位数之间的估计差异。\n4. 使用基于$\\hat{V}_{0.75}$的渐近正态近似，为第3项中的差异构建一个双侧95%置信区间（CI）。\n\n将您的数值答案四舍五入到四位有效数字。所有数值答案均以毫米汞柱（mmHg）表示。请按以下顺序提供您的最终数值结果：60岁女性的预测分位数，60岁男性的预测分位数，估计差异，置信区间下限，置信区间上限。",
            "solution": "在固定分位数水平$\\tau$下的分位数回归由经验目标$\\sum_{i=1}^{n} \\rho_{\\tau}\\!\\left(Y_i - X_i^{\\top}\\beta\\right)$的最小化器$\\hat{\\beta}_{\\tau}$定义，其中检验损失为$\\rho_{\\tau}(u) = u\\left(\\tau - \\mathbf{1}\\{u  0\\}\\right)$，$X_i$是协变量向量。在标准正则性条件下（独立同分布（i.i.d.）抽样，在目标分位数处$Y$的条件密度严格为正，以及适当的矩条件和设计条件），$\\hat{\\beta}_{\\tau}$是一个一致估计量，并允许渐近正态近似，\n$$\n\\sqrt{n}\\left(\\hat{\\beta}_{\\tau} - \\beta_{\\tau}\\right) \\overset{d}{\\to} \\mathcal{N}\\!\\left(0, V_{\\tau}\\right),\n$$\n其中$V_{\\tau}$可以通过一个稳健的三明治协方差估计量（记为$\\hat{V}_{\\tau}$）进行一致估计。对于任何固定的协变量向量$x$，预测的条件$\\tau$-分位数是$x^{\\top}\\hat{\\beta}_{\\tau}$，对于任何线性对比$l^{\\top}\\beta_{\\tau}$，其渐近方差为$l^{\\top}\\hat{V}_{\\tau} l$。\n\n我们已知线性设定\n$$\nQ_{Y \\mid A,M}(0.75 \\mid a,m) = \\beta_0 + \\beta_A\\,a + \\beta_M\\,m + \\beta_{AM}\\,a\\,m,\n$$\n以及在$\\tau=0.75$处的估计值，\n$$\n\\hat{\\beta}_0 = 94.0,\\quad \\hat{\\beta}_A = 0.70,\\quad \\hat{\\beta}_M = 6.00,\\quad \\hat{\\beta}_{AM} = 0.03,\n$$\n其协方差矩阵为\n$$\n\\hat{V}_{0.75} =\n\\begin{pmatrix}\n6.25  -0.02  0.30  -0.015 \\\\\n-0.02  0.05  -0.005  0.0001 \\\\\n0.30  -0.005  2.89  -0.002 \\\\\n-0.015  0.0001  -0.002  0.02\n\\end{pmatrix}.\n$$\n\n步骤$1$（女性，$A=60$，$M=0$）。一位60岁女性的协变量向量是$x_f = (1, 60, 0, 0)^{\\top}$。预测的0.75-分位数是\n$$\nx_f^{\\top}\\hat{\\beta}_{0.75} = \\hat{\\beta}_0 + \\hat{\\beta}_A \\cdot 60 + \\hat{\\beta}_M \\cdot 0 + \\hat{\\beta}_{AM} \\cdot 60 \\cdot 0 = 94.0 + 0.70 \\cdot 60 = 136.0.\n$$\n\n步骤$2$（男性，$A=60$，$M=1$）。一位60岁男性的协变量向量是$x_m = (1, 60, 1, 60)^{\\top}$。预测的0.75-分位数是\n$$\nx_m^{\\top}\\hat{\\beta}_{0.75} = \\hat{\\beta}_0 + \\hat{\\beta}_A \\cdot 60 + \\hat{\\beta}_M \\cdot 1 + \\hat{\\beta}_{AM} \\cdot 60 \\cdot 1 = 94.0 + 0.70 \\cdot 60 + 6.00 + 0.03 \\cdot 60 = 143.8.\n$$\n\n步骤$3$（差异，男性减去女性）。在$A=60$时，预测分位数的差异是\n$$\n\\widehat{\\Delta} = x_m^{\\top}\\hat{\\beta}_{0.75} - x_f^{\\top}\\hat{\\beta}_{0.75} = \\hat{\\beta}_M + 60\\,\\hat{\\beta}_{AM} = 6.00 + 60 \\cdot 0.03 = 7.80.\n$$\n\n步骤$4$（差异的双侧95%置信区间）。该差异是一个线性对比，其中$l = (0, 0, 1, 60)^{\\top}$，所以其渐近方差为\n$$\n\\operatorname{Var}(\\widehat{\\Delta}) = l^{\\top}\\hat{V}_{0.75}\\,l\n= \\hat{V}_{33} + 60^2 \\hat{V}_{44} + 2 \\cdot 60\\, \\hat{V}_{34}.\n$$\n使用$\\hat{V}_{0.75}$中的条目，\n$$\n\\operatorname{Var}(\\widehat{\\Delta}) = 2.89 + 60^2 \\cdot 0.02 + 2 \\cdot 60 \\cdot (-0.002)\n= 2.89 + 3600 \\cdot 0.02 - 0.24 = 2.89 + 72 - 0.24 = 74.65.\n$$\n标准误是\n$$\n\\operatorname{SE}(\\widehat{\\Delta}) = \\sqrt{74.65} \\approx 8.640.\n$$\n在渐近正态近似下，一个双侧95%置信区间由下式给出\n$$\n\\widehat{\\Delta} \\pm z_{0.975} \\cdot \\operatorname{SE}(\\widehat{\\Delta}),\n$$\n其中$z_{0.975} \\approx 1.96$。因此，\n$$\n\\text{CI}_{95\\%} = 7.80 \\pm 1.96 \\cdot 8.640 = 7.80 \\pm 16.9344,\n$$\n这得出的端点为\n$$\n\\text{Lower} = 7.80 - 16.9344 = -9.1344,\\qquad \\text{Upper} = 7.80 + 16.9344 = 24.7344.\n$$\n\n将所有要求的量四舍五入到四位有效数字，并以毫米汞柱（mmHg）表示：\n- 60岁女性的预测0.75-分位数：$136.0$。\n- 60岁男性的预测0.75-分位数：$143.8$。\n- 估计差异（男性减去女性）：$7.800$。\n- 95%置信区间下限：$-9.134$。\n- 95%置信区间上限：$24.73$。\n\n这五个数值结果按指定顺序是最终输出。",
            "answer": "$$\\boxed{\\begin{pmatrix}136.0  143.8  7.800  -9.134  24.73\\end{pmatrix}}$$"
        }
    ]
}