{
    "hands_on_practices": [
        {
            "introduction": "我们首先从最简单的情景——完全随机缺失（MCAR）——入手。这个练习通过量化统计效率的损失，来展示数据缺失所带来的实际代价。通过推导方差膨胀因子，您将精确地看到信息是如何丢失的，这为您后续学习比简单的完整病例分析更复杂的方法提供了有力的动机。",
            "id": "4973778",
            "problem": "在一项关于连续生物标志物的纵向观察性研究中，设 $\\{Y_{i}\\}_{i=1}^{n}$ 独立同分布，其均值为 $\\mu=\\mathbb{E}[Y]$，方差为 $\\sigma^{2}=\\operatorname{Var}(Y)$。设 $\\{R_{i}\\}_{i=1}^{n}$ 为独立同分布的缺失指示变量，其中 $R_{i}\\in\\{0,1\\}$ 表示 $Y_{i}$ 是否被观测到。定义 $\\pi=\\mathbb{E}[R]\\in(0,1)$ 为观测比例。假设数据满足完全随机缺失（MCAR）机制，这意味着 $R_{i}$ 与 $Y_{i}$ 及任何协变量均独立。作为背景知识，随机缺失（MAR）允许缺失性依赖于已观测的协变量，但不依赖于缺失值本身；而非随机缺失（NMAR）则允许缺失性依赖于未观测的结果。\n\n考虑完整病例估计量\n$$\n\\hat{\\mu}_{\\text{cc}}=\\frac{\\sum_{i=1}^{n}R_{i}Y_{i}}{\\sum_{i=1}^{n}R_{i}}.\n$$\n从基本定义和标准极限定理出发，推导在MCAR条件下 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差，然后通过计算方差膨胀因子来量化其相对于全数据样本均值 $\\bar{Y}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}$ 的效率损失。方差膨胀因子定义为 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差与 $\\bar{Y}_{n}$ 的大样本方差之比。请将最终答案表示为关于 $\\pi$ 的封闭形式解析表达式。无需进行数值近似或四舍五入，且不涉及物理单位。",
            "solution": "所述问题是有效的。这是一个统计理论中的良定问题，其基础是处理缺失数据的既定原则。所有术语都有正式定义，且前提条件是自洽的，足以推导出唯一解。\n\n目标是推导完整病例估计量 $\\hat{\\mu}_{\\text{cc}}$ 相对于全数据样本均值 $\\bar{Y}_{n}$ 的方差膨胀因子。该因子定义为它们的大样本方差之比。\n\n首先，我们确定全数据样本均值 $\\bar{Y}_{n}$ 的大样本方差。\n全数据估计量定义为：\n$$\n\\bar{Y}_{n} = \\frac{1}{n} \\sum_{i=1}^{n} Y_{i}\n$$\n变量 $\\{Y_i\\}_{i=1}^n$ 是独立同分布（i.i.d.）的，方差为 $\\operatorname{Var}(Y) = \\sigma^2$。因此，样本均值的方差为：\n$$\n\\operatorname{Var}(\\bar{Y}_{n}) = \\operatorname{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} Y_{i}\\right) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\operatorname{Var}(Y_{i}) = \\frac{1}{n^2} (n \\sigma^2) = \\frac{\\sigma^2}{n}\n$$\n这个精确方差即为 $\\bar{Y}_{n}$ 的大样本方差。\n\n接下来，我们推导完整病例估计量 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差。\n该估计量定义为比率：\n$$\n\\hat{\\mu}_{\\text{cc}} = \\frac{\\sum_{i=1}^{n} R_{i} Y_{i}}{\\sum_{i=1}^{n} R_{i}} = \\frac{\\frac{1}{n} \\sum_{i=1}^{n} R_{i} Y_{i}}{\\frac{1}{n} \\sum_{i=1}^{n} R_{i}}\n$$\n这是两个样本均值的比率。我们可以使用多元中心极限定理（CLT）和Delta方法来求出 $\\hat{\\mu}_{\\text{cc}}$ 的渐近分布。\n让我们定义一个随机变量向量 $W_i = \\begin{pmatrix} R_i Y_i \\\\ R_i \\end{pmatrix}$。因为 $\\{Y_i\\}_{i=1}^n$ 和 $\\{R_i\\}_{i=1}^n$ 是独立同分布的序列，并且（由于MCAR）它们相互独立，所以向量序列 $\\{W_i\\}_{i=1}^n$ 也是独立同分布的。\n\n我们首先计算 $W_i$ 的期望。\n$\\mathbb{E}[R_i] = \\pi$。\n在完全随机缺失（MCAR）假设下，$R_i$ 与 $Y_i$ 独立。因此：\n$\\mathbb{E}[R_i Y_i] = \\mathbb{E}[R_i] \\mathbb{E}[Y_i] = \\pi \\mu$。\n期望向量为：\n$$\n\\mathbb{E}[W_i] = \\begin{pmatrix} \\mathbb{E}[R_i Y_i] \\\\ \\mathbb{E}[R_i] \\end{pmatrix} = \\begin{pmatrix} \\pi \\mu \\\\ \\pi \\end{pmatrix}\n$$\n接下来，我们计算 $W_i$ 的协方差矩阵，记为 $\\Sigma_W = \\operatorname{Cov}(W_i)$。\n$$\n\\Sigma_W = \\begin{pmatrix} \\operatorname{Var}(R_i Y_i) & \\operatorname{Cov}(R_i Y_i, R_i) \\\\ \\operatorname{Cov}(R_i Y_i, R_i) & \\operatorname{Var}(R_i) \\end{pmatrix}\n$$\n各个分量计算如下：\n1.  $\\operatorname{Var}(R_i)$: 由于 $R_i$ 是参数为 $\\pi$ 的伯努利随机变量，其方差为 $\\operatorname{Var}(R_i) = \\pi(1-\\pi)$。\n2.  $\\operatorname{Var}(R_i Y_i) = \\mathbb{E}[(R_i Y_i)^2] - (\\mathbb{E}[R_i Y_i])^2$。\n    由于 $R_i \\in \\{0, 1\\}$，我们有 $R_i^2 = R_i$。\n    $\\mathbb{E}[(R_i Y_i)^2] = \\mathbb{E}[R_i^2 Y_i^2] = \\mathbb{E}[R_i Y_i^2]$。根据MCAR，这等于 $\\mathbb{E}[R_i]\\mathbb{E}[Y_i^2]$。\n    我们知道 $\\mathbb{E}[Y_i^2] = \\operatorname{Var}(Y_i) + (\\mathbb{E}[Y_i])^2 = \\sigma^2 + \\mu^2$。\n    所以，$\\mathbb{E}[R_i Y_i^2] = \\pi (\\sigma^2 + \\mu^2)$。\n    因此，$\\operatorname{Var}(R_i Y_i) = \\pi(\\sigma^2 + \\mu^2) - (\\pi \\mu)^2 = \\pi \\sigma^2 + \\pi \\mu^2 - \\pi^2 \\mu^2 = \\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi)$。\n3.  $\\operatorname{Cov}(R_i Y_i, R_i) = \\mathbb{E}[(R_i Y_i)R_i] - \\mathbb{E}[R_i Y_i]\\mathbb{E}[R_i]$。\n    $\\mathbb{E}[(R_i Y_i)R_i] = \\mathbb{E}[R_i^2 Y_i] = \\mathbb{E}[R_i Y_i] = \\pi \\mu$。\n    所以，$\\operatorname{Cov}(R_i Y_i, R_i) = \\pi \\mu - (\\pi \\mu)\\pi = \\pi \\mu (1-\\pi)$。\n\n协方差矩阵为：\n$$\n\\Sigma_W = \\begin{pmatrix} \\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi) & \\mu \\pi(1-\\pi) \\\\ \\mu \\pi(1-\\pi) & \\pi(1-\\pi) \\end{pmatrix}\n$$\n估计量 $\\hat{\\mu}_{\\text{cc}}$ 是 $W_i$ 样本均值的函数 $g$，其中 $g(a,b) = a/b$。令 $\\bar{W}_n = \\frac{1}{n} \\sum_{i=1}^n W_i$。根据多元CLT，$\\sqrt{n}(\\bar{W}_n - \\mathbb{E}[W_i])$ 依分布收敛于一个均值为 $0$、协方差矩阵为 $\\Sigma_W$ 的多元正态分布。\n为求得 $\\hat{\\mu}_{\\text{cc}} = g(\\bar{W}_n)$ 的渐近方差，我们使用Delta方法。$\\sqrt{n}(\\hat{\\mu}_{\\text{cc}} - \\mu)$ 的渐近方差由 $\\nabla g^T \\Sigma_W \\nabla g$ 给出，其中梯度 $\\nabla g$ 在 $\\mathbb{E}[W_i]$ 处取值。\n函数 $g(a,b)$ 的梯度为 $\\nabla g(a,b) = \\begin{pmatrix} 1/b \\\\ -a/b^2 \\end{pmatrix}$。\n在 $\\mathbb{E}[W_i] = (\\pi\\mu, \\pi)^T$ 处取值：\n$$\n\\nabla g(\\pi\\mu, \\pi) = \\begin{pmatrix} 1/\\pi \\\\ -\\pi\\mu/\\pi^2 \\end{pmatrix} = \\begin{pmatrix} 1/\\pi \\\\ -\\mu/\\pi \\end{pmatrix}\n$$\n现在我们计算二次型 $\\nabla g^T \\Sigma_W \\nabla g$：\n$$\n\\begin{pmatrix} \\frac{1}{\\pi} & -\\frac{\\mu}{\\pi} \\end{pmatrix} \\begin{pmatrix} \\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi) & \\mu \\pi(1-\\pi) \\\\ \\mu \\pi(1-\\pi) & \\pi(1-\\pi) \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\pi} \\\\ -\\frac{\\mu}{\\pi} \\end{pmatrix}\n$$\n首先，将行向量与矩阵相乘：\n$$\n\\begin{pmatrix} \\frac{1}{\\pi}(\\pi \\sigma^2 + \\mu^2 \\pi(1-\\pi)) - \\frac{\\mu}{\\pi}(\\mu \\pi(1-\\pi)) & \\frac{1}{\\pi}(\\mu \\pi(1-\\pi)) - \\frac{\\mu}{\\pi}(\\pi(1-\\pi)) \\end{pmatrix}\n$$\n第一个分量化简为：\n$$\n(\\sigma^2 + \\mu^2(1-\\pi)) - \\mu^2(1-\\pi) = \\sigma^2\n$$\n第二个分量化简为：\n$$\n\\mu(1-\\pi) - \\mu(1-\\pi) = 0\n$$\n所以中间结果是行向量 $\\begin{pmatrix} \\sigma^2 & 0 \\end{pmatrix}$。\n最后，我们将其与列向量相乘：\n$$\n\\begin{pmatrix} \\sigma^2 & 0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\pi} \\\\ -\\frac{\\mu}{\\pi} \\end{pmatrix} = \\sigma^2 \\cdot \\frac{1}{\\pi} + 0 \\cdot \\left(-\\frac{\\mu}{\\pi}\\right) = \\frac{\\sigma^2}{\\pi}\n$$\n这就是 $\\sqrt{n}(\\hat{\\mu}_{\\text{cc}} - \\mu)$ 的极限分布的方差。估计量 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差是此量除以 $n$：\n$$\n\\text{大样本方差}(\\hat{\\mu}_{\\text{cc}}) = \\frac{\\sigma^2}{n\\pi}\n$$\n最后，我们计算方差膨胀因子（VIF），即 $\\hat{\\mu}_{\\text{cc}}$ 的大样本方差与 $\\bar{Y}_{n}$ 的大样本方差之比：\n$$\n\\text{VIF} = \\frac{\\text{大样本方差}(\\hat{\\mu}_{\\text{cc}})}{\\text{大样本方差}(\\bar{Y}_{n})} = \\frac{\\frac{\\sigma^2}{n\\pi}}{\\frac{\\sigma^2}{n}}\n$$\n项 $\\sigma^2$ 和 $n$相互抵消，得到：\n$$\n\\text{VIF} = \\frac{1}{\\pi}\n$$\n这个结果是直观的：完整病例估计量的方差膨胀了一个因子，该因子等于观测概率的倒数。如果所有数据都被观测到（$\\pi=1$），方差膨胀因子为1，正如预期。如果只有一半数据被观测到（$\\pi=0.5$），方差则加倍。",
            "answer": "$$\n\\boxed{\\frac{1}{\\pi}}\n$$"
        },
        {
            "introduction": "在理解了问题的严重性之后，我们转向解决问题。本练习将引导您逐步完成期望最大化（EM）算法的一次迭代，这是一种处理随机缺失（MAR）数据的强大似然方法。通过手动执行计算，您将揭开这个“黑箱”过程的神秘面纱，并具体理解算法是如何迭代地处理缺失信息的。",
            "id": "4973852",
            "problem": "一项临床研究为每位患者测量一对连续结果：血液生物标志物 $X$ 和生理指标 $Y$。$(X,Y)$ 的联合分布假定为二元正态分布，其均值向量为 $\\mu = (\\mu_{x}, \\mu_{y})^{\\top}$，协方差矩阵为 $\\Sigma = \\begin{pmatrix} \\sigma_{xx} & \\sigma_{xy} \\\\ \\sigma_{xy} & \\sigma_{yy} \\end{pmatrix}$。对于某些患者，$X$ 的数据是缺失的，其缺失机制是随机缺失（MAR），意味着在以 $Y$ 为条件后，$X$ 缺失的概率可能依赖于 $Y$ 但不依赖于 $X$。在参数分离的随机缺失（MAR）条件下，该缺失机制对于基于似然的推断是可忽略的。\n\n给定 $N=4$ 个独立观测值，$Y$ 被完全观测到而 $X$ 可能缺失：$(x_{1}, y_{1}) = (-1, 0)$，$(x_{2} \\text{ 缺失}, y_{2} = 2)$，$(x_{3}, y_{3}) = (1,4)$，$(x_{4} \\text{ 缺失}, y_{4} = 6)$。假设期望最大化（EM）算法的当前参数迭代值为\n$$\n\\mu^{(0)} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\qquad \n\\Sigma^{(0)} = \\begin{pmatrix} 9 & 2 \\\\ 2 & 4 \\end{pmatrix}.\n$$\n\n从适用于此情景的第一性原理出发，即：(i) 随机缺失（MAR）机制的定义以及在参数分离下的可忽略性，(ii) 多元正态分布族的联合和条件分布性质，以及 (iii) 通过最大化期望完全数据对数似然来定义的期望最大化（EM）算法，执行一次完整的EM迭代。在E步中，给定观测数据和当前参数 $\\mu^{(0)}$ 与 $\\Sigma^{(0)}$，计算完全数据对数似然的充分统计量的条件期望。在M步中，最大化期望完全数据对数似然，以在最大似然参数化下获得更新后的均值向量 $\\mu^{(1)}$ 和协方差矩阵 $\\Sigma^{(1)}$，其中协方差使用因子 $1/N$（而不是无偏因子）。\n\n提供 $\\mu_{x}^{(1)}$、$\\mu_{y}^{(1)}$、$\\sigma_{xx}^{(1)}$、$\\sigma_{xy}^{(1)}$ 和 $\\sigma_{yy}^{(1)}$ 的明确数值。不要四舍五入。将您的最终答案表示为按 $\\mu_{x}^{(1)}$、$\\mu_{y}^{(1)}$、$\\sigma_{xx}^{(1)}$、$\\sigma_{xy}^{(1)}$、$\\sigma_{yy}^{(1)}$ 顺序排列的单行矩阵。",
            "solution": "该问题是有效的，因为它在科学上基于统计理论，问题表述清晰、客观，并包含了执行所要求计算的所有必要信息。\n\n期望最大化（EM）算法是一种迭代方法，用于在统计模型中寻找参数的最大似然估计，其中模型依赖于未观测到的潜变量。在本例中，未观测变量是血液生物标志物 $X$ 的缺失值。该算法在两个步骤之间交替进行：期望（E）步和最大化（M）步。\n\n设完全数据为 $Z = (X, Y)$，其中 $Z_i = (X_i, Y_i)^\\top$ 对于 $i=1, \\dots, N$。数据被假定是从一个二元正态分布 $\\mathcal{N}(\\mu, \\Sigma)$ 中抽取的。我们有 $N=4$ 个观测值。观测数据包括 $Z_{obs} = \\{(x_1, y_1), y_2, (x_3, y_3), y_4\\}$，缺失数据为 $Z_{mis} = \\{x_2, x_4\\}$。在迭代 $t=0$ 时的初始参数估计为：\n$$\n\\mu^{(0)} = \\begin{pmatrix} \\mu_{x}^{(0)} \\\\ \\mu_{y}^{(0)} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\qquad \n\\Sigma^{(0)} = \\begin{pmatrix} \\sigma_{xx}^{(0)} & \\sigma_{xy}^{(0)} \\\\ \\sigma_{xy}^{(0)} & \\sigma_{yy}^{(0)} \\end{pmatrix} = \\begin{pmatrix} 9 & 2 \\\\ 2 & 4 \\end{pmatrix}.\n$$\n\n对于来自二元正态分布的 $N$ 个观测值，完全数据对数似然在忽略一个常数的情况下，正比于：\n$$\nl(\\mu, \\Sigma; Z) \\propto - \\frac{N}{2} \\ln \\det(\\Sigma) - \\frac{1}{2} \\sum_{i=1}^{N} (Z_i - \\mu)^\\top \\Sigma^{-1} (Z_i - \\mu)\n$$\n这个似然是正态分布充分统计量的函数，这些统计量是 $\\sum_{i=1}^N Z_i$ 和 $\\sum_{i=1}^N Z_i Z_i^\\top$。以分量形式表示，充分统计量是 $\\sum X_i$、$\\sum Y_i$、$\\sum X_i^2$、$\\sum Y_i^2$ 和 $\\sum X_i Y_i$。\n\n**E步：计算充分统计量的条件期望**\n\n在E步中，我们计算在给定观测数据 $Z_{obs}$ 和当前参数估计 $\\theta^{(0)} = (\\mu^{(0)}, \\Sigma^{(0)})$ 下的完全数据对数似然的期望。这等价于计算充分统计量的条件期望。\n对于 $X_i$ 和 $Y_i$ 都被观测到的观测值（即 $i=1, 3$），统计量就是它们的观测值。\n对于 $X_i$ 缺失的观测值（即 $i=2, 4$），我们需要计算在给定 $Y_i=y_i$ 和 $\\theta^{(0)}$ 的条件下，$X_i$ 及其函数的条件期望。\n\n对于一个二元正态分布，给定 $Y=y$ 时 $X$ 的条件分布是一个一元正态分布，$X | Y=y \\sim \\mathcal{N}(\\mu_{x|y}, \\sigma^2_{x|y})$，其均值和方差为：\n$$\n\\mu_{x|y} = \\mu_x + \\frac{\\sigma_{xy}}{\\sigma_{yy}}(y - \\mu_y)\n$$\n$$\n\\sigma^2_{x|y} = \\sigma_{xx} - \\frac{\\sigma_{xy}^2}{\\sigma_{yy}}\n$$\n使用当前参数 $\\theta^{(0)}$：\n$$\n\\sigma^{2, (0)}_{x|y} = \\sigma_{xx}^{(0)} - \\frac{(\\sigma_{xy}^{(0)})^2}{\\sigma_{yy}^{(0)}} = 9 - \\frac{2^2}{4} = 9 - 1 = 8\n$$\n观测值 $i$ 的条件均值为：\n$$\n\\mu_{x|y_i}^{(0)} = \\mu_x^{(0)} + \\frac{\\sigma_{xy}^{(0)}}{\\sigma_{yy}^{(0)}}(y_i - \\mu_y^{(0)}) = 1 + \\frac{2}{4}(y_i - 2) = 1 + 0.5(y_i - 2)\n$$\n我们需要计算对于 $i=2, 4$ 的条件期望 $E[X_i | y_i, \\theta^{(0)}]$ 和 $E[X_i^2 | y_i, \\theta^{(0)}]$。对于一个正态变量 $W \\sim \\mathcal{N}(\\mu_W, \\sigma_W^2)$，我们有 $E[W] = \\mu_W$ 和 $E[W^2] = \\text{Var}(W) + (E[W])^2 = \\sigma_W^2 + \\mu_W^2$。\n\n对于观测值 $i=2$，其 $y_2=2$：\n$$\nE[X_2 | y_2=2, \\theta^{(0)}] = 1 + 0.5(2-2) = 1\n$$\n$$\nE[X_2^2 | y_2=2, \\theta^{(0)}] = \\sigma^{2, (0)}_{x|y} + (E[X_2 | y_2=2, \\theta^{(0)}])^2 = 8 + 1^2 = 9\n$$\n$$\nE[X_2 Y_2 | y_2=2, \\theta^{(0)}] = y_2 E[X_2 | y_2=2, \\theta^{(0)}] = 2 \\times 1 = 2\n$$\n\n对于观测值 $i=4$，其 $y_4=6$：\n$$\nE[X_4 | y_4=6, \\theta^{(0)}] = 1 + 0.5(6-2) = 1 + 0.5(4) = 3\n$$\n$$\nE[X_4^2 | y_4=6, \\theta^{(0)}] = \\sigma^{2, (0)}_{x|y} + (E[X_4 | y_4=6, \\theta^{(0)}])^2 = 8 + 3^2 = 8 + 9 = 17\n$$\n$$\nE[X_4 Y_4 | y_4=6, \\theta^{(0)}] = y_4 E[X_4 | y_4=6, \\theta^{(0)}] = 6 \\times 3 = 18\n$$\n\n现在我们计算所有 $N=4$ 个观测值的总期望充分统计量。我们将 $E^{(0)}[\\cdot]$ 表示为 $E[\\cdot | Z_{obs}, \\theta^{(0)}]$。\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 X_i\\right] = x_1 + E[X_2 | \\dots] + x_3 + E[X_4 | \\dots] = -1 + 1 + 1 + 3 = 4\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 Y_i\\right] = \\sum_{i=1}^4 y_i = 0 + 2 + 4 + 6 = 12 \\quad (\\text{因为 } Y \\text{ 是完全观测的})\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 X_i^2\\right] = x_1^2 + E[X_2^2 | \\dots] + x_3^2 + E[X_4^2 | \\dots] = (-1)^2 + 9 + 1^2 + 17 = 1 + 9 + 1 + 17 = 28\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 Y_i^2\\right] = \\sum_{i=1}^4 y_i^2 = 0^2 + 2^2 + 4^2 + 6^2 = 0 + 4 + 16 + 36 = 56\n$$\n$$\nE^{(0)}\\left[\\sum_{i=1}^4 X_i Y_i\\right] = x_1 y_1 + E[X_2 Y_2 | \\dots] + x_3 y_3 + E[X_4 Y_4 | \\dots] = (-1)(0) + 2 + (1)(4) + 18 = 0 + 2 + 4 + 18 = 24\n$$\n\n**M步：最大化期望对数似然**\n\n在M步中，我们找到参数 $\\theta^{(1)}=(\\mu^{(1)}, \\Sigma^{(1)})$ 来最大化期望完全数据对数似然。这是通过使用二元正态分布的标准最大似然估计量来完成的，其中充分统计量被替换为在E步中计算出的它们的条件期望。\n\n更新后的均值向量 $\\mu^{(1)}$ 为：\n$$\n\\mu_x^{(1)} = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^4 X_i\\right] = \\frac{4}{4} = 1\n$$\n$$\n\\mu_y^{(1)} = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^4 Y_i\\right] = \\frac{12}{4} = 3\n$$\n所以，$\\mu^{(1)} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$。\n\n更新后的协方差矩阵 $\\Sigma^{(1)}$ （使用MLE的 $1/N$ 因子）为：\n$$\n\\Sigma^{(1)} = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^N (Z_i - \\mu^{(1)})(Z_i - \\mu^{(1)})^\\top\\right] = \\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^N Z_i Z_i^\\top\\right] - \\mu^{(1)}(\\mu^{(1)})^\\top\n$$\n首先，我们计算期望二阶矩矩阵：\n$$\n\\frac{1}{N} E^{(0)}\\left[\\sum_{i=1}^N Z_i Z_i^\\top\\right] = \\frac{1}{4} \\begin{pmatrix} E^{(0)}[\\sum X_i^2] & E^{(0)}[\\sum X_i Y_i] \\\\ E^{(0)}[\\sum X_i Y_i] & E^{(0)}[\\sum Y_i^2] \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 28 & 24 \\\\ 24 & 56 \\end{pmatrix} = \\begin{pmatrix} 7 & 6 \\\\ 6 & 14 \\end{pmatrix}\n$$\n接下来，我们计算新均值的外积：\n$$\n\\mu^{(1)}(\\mu^{(1)})^\\top = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} \\begin{pmatrix} 1 & 3 \\end{pmatrix} = \\begin{pmatrix} 1 & 3 \\\\ 3 & 9 \\end{pmatrix}\n$$\n最后，我们计算 $\\Sigma^{(1)}$：\n$$\n\\Sigma^{(1)} = \\begin{pmatrix} 7 & 6 \\\\ 6 & 14 \\end{pmatrix} - \\begin{pmatrix} 1 & 3 \\\\ 3 & 9 \\end{pmatrix} = \\begin{pmatrix} 7-1 & 6-3 \\\\ 6-3 & 14-9 \\end{pmatrix} = \\begin{pmatrix} 6 & 3 \\\\ 3 & 5 \\end{pmatrix}\n$$\n更新后的协方差矩阵的元素为 $\\sigma_{xx}^{(1)} = 6$，$\\sigma_{xy}^{(1)} = 3$ 和 $\\sigma_{yy}^{(1)} = 5$。\n\n一次完整EM迭代的结果是更新后的参数：\n$\\mu_{x}^{(1)} = 1$\n$\\mu_{y}^{(1)} = 3$\n$\\sigma_{xx}^{(1)} = 6$\n$\\sigma_{xy}^{(1)} = 3$\n$\\sigma_{yy}^{(1)} = 5$\n这些是所要求的数值。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1 & 3 & 6 & 3 & 5 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后，我们来探讨另一种广泛使用的方法——多重插补（MI）——中一个常见但微妙的错误。本练习将探讨“协调性”（congeniality）这一关键概念，强调为何插补模型必须至少与最终的分析模型一样复杂。在分析多重插补数据集时，尤其是在研究交互作用等复杂关系时，理解这一原则对于避免结果偏倚至关重要。",
            "id": "4973789",
            "problem": "一项肿瘤学的随机比较效果研究收集了连续生物标志物 $X$、随机治疗指示变量 $Z \\in \\{0,1\\}$ 以及6个月时的连续进展评分 $Y$。部分 $Y$ 值为缺失值。设 $R$ 为 $Y$ 的缺失指示变量，当 $Y$ 被观测到时 $R=1$，当 $Y$ 缺失时 $R=0$。假设缺失机制满足随机缺失（MAR）：$\\mathbb{P}(R=1 \\mid Y,X,Z)=\\mathbb{P}(R=1 \\mid X)$，且科学估计量为生物标志物对治疗效果的修饰程度，操作化定义为 $Y$ 的线性模型中 $XZ$ 交互作用项的系数。\n\n一位分析师计划使用多重插补（MI）及 Rubin 合并规则来处理缺失的 $Y$，然后拟合一个包含 $1$、$X$、$Z$ 和 $XZ$ 作为回归变量的分析模型。插补器考虑了几个关于 $Y \\mid X,Z$ 的候选插补模型。\n\n哪个选项正确解释了插补模型和分析模型之间的“协调性”（congeniality）概念，并给出了一个科学上合理的例子，说明在MAR条件下，违反协调性会导致 $XZ$ 交互作用的合并估计产生偏倚？\n\nA. 协调性要求插补模型与分析模型对于与估计量相关的联合分布是兼容的，并且至少与分析模型同样丰富，包括相同的变量及其函数形式（例如，交互作用和非线性变换），从而使目标估计量是插补模型后验预测分布的一个泛函。例如，如果真实的数据生成模型是 $Y=\\beta_{0}+\\beta_{1}X+\\beta_{2}Z+\\beta_{3}XZ+\\varepsilon$，其中 $\\mathbb{E}[\\varepsilon \\mid X,Z]=0$ 且 $R \\perp Y \\mid X$ (MAR)，但用于缺失 $Y$ 的插补模型忽略了 $XZ$ 项，并使用线性可加均值 $\\mathbb{E}[Y \\mid X,Z]=\\alpha_{0}+\\alpha_{1}X+\\alpha_{2}Z$，那么填补后的完整数据集将在 $R=0$ 的子集中系统性地低估交互作用信号。因此，即使插补次数 $m \\to \\infty$，XZ 系数的合并 MI 估计也会偏向于 $0$，因为插补模型与分析模型不协调。\n\nB. 在 MAR 条件下，只要插补模型包含与分析模型相同的一组变量作为预测变量，无论它是否包含相同的变换（例如，交互作用或非线性项），MI 都能为任何分析模型提供无偏的合并点估计。因此，当分析模型包含 $XZ$ 项时，从插补模型中省略它不会使 $XZ$ 系数的 MI 估计产生偏倚。\n\nC. 协调性只涉及方差估计；只要 MAR 成立，一个忽略了分析模型中使用的交互作用或非线性项的插补模型将产生正确的合并点估计，最坏情况下由于模型错配而导致标准误偏于保守。\n\nD. 对于一个使用包含 $XZ$ 交互作用的对数线性泊松回归进行分析的计数结局，在 MAR 条件下，从一个关于 $X$ 和 $Z$ 的等方差正态线性回归（不包括 $XZ$）来插补缺失的计数值是协调的，因为两个模型都是参数线性的；因此，当 $m \\to \\infty$ 时，交互作用的合并估计是无偏的。\n\n选择唯一最佳答案。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   一项肿瘤学的随机比较效果研究。\n-   收集的变量：\n    -   $X$：一个连续生物标志物。\n    -   $Z$：一个随机治疗指示变量，$Z \\in \\{0,1\\}$。\n    -   $Y$：6个月时的连续进展评分。$Y$ 的某些值是缺失的。\n-   $Y$ 的缺失指示变量：$R$，当 $Y$ 被观测到时 $R=1$，当 $Y$ 缺失时 $R=0$。\n-   假定的缺失机制：随机缺失（MAR），具体为 $\\mathbb{P}(R=1 \\mid Y,X,Z)=\\mathbb{P}(R=1 \\mid X)$。\n-   科学估计量：生物标志物对治疗效果的修饰程度。\n-   估计量的操作化定义：$Y$ 的线性模型中 $XZ$ 交互作用项的系数。\n-   提议的分析方法：\n    1.  使用多重插补（MI）及 Rubin 合并规则来处理缺失的 $Y$。\n    2.  拟合一个包含 $1$、$X$、$Z$ 和 $XZ$ 作为回归变量的分析模型（实质性模型）。\n-   插补模型：考虑了关于 $Y$ 给定 $X$ 和 $Z$ 的条件分布，即 $Y \\mid X,Z$ 的候选模型。\n-   问题：找出哪个选项正确解释了插补模型和分析模型之间的协调性概念，并提供一个科学上合理的例子，说明在指定的 MAR 机制下，违反协调性会导致偏倚。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题设置在临床试验缺失数据统计推断的标准框架内。MAR、多重插补、线性回归和交互效应等概念是生物统计学及相关领域的基础且成熟的概念。指定的 MAR 机制 $\\mathbb{P}(R=1 \\mid Y,X,Z)=\\mathbb{P}(R=1 \\mid X)$ 是 MAR 的一个有效但具体的实例。\n-   **定义明确：** 问题要求关于多重插补中“协调性”的正确概念解释和有效示例。问题结构旨在基于已建立的统计理论，在选项中找到唯一的正确答案。\n-   **客观性：** 问题使用精确、客观的统计术语陈述。没有歧义或主观性。\n-   **完整性与一致性：** 问题提供了足够的信息来评估选项。它定义了所有变量、估计量、缺失数据机制和分析方法。没有内部矛盾。\n-   **可行性：** 所描述的情景在医学研究中是现实且常见的。\n\n问题陈述通过了所有验证标准。这是一个应用统计学中有效、定义明确且有科学依据的问题。\n\n### 步骤3：结论与行动\n该问题是有效的。解决方案将首先分析多重插补和协调性的原理，然后对每个选项进行评估。\n\n### 推导与分析\n\n此问题的核心在于理解多重插补（MI）背景下的“协调性”（congeniality）或相容性（compatibility）概念，该概念由 Meng (1994) 首次正式描述。MI 是一个两阶段过程：\n1.  **插补阶段：** 将缺失值填补 $m > 1$ 次，创建 $m$ 个完整数据集。这些插补值是从给定观测数据的条件下，缺失数据的后验预测分布中抽取的，并基于一个指定的插补模型。\n2.  **分析阶段：** 在 $m$ 个完整数据集中的每一个上执行所需的分析（例如，拟合回归模型）。\n3.  **合并阶段：** 使用 Rubin 规则将 $m$ 次分析的结果合并，以获得单一的点估计和方差估计，该方差估计考虑了插补内变异和插补间变異。\n\n为了使合并后的估计具有良好的统计特性（例如，对目标估计量的一致性），插补模型和分析模型必须是“协调的”。协调性的一个主要条件是，插补模型必须至少与分析模型一样复杂或通用。这意味着任何作为科学问题一部分的变量、交互项或变量的非线性变换（即包含在分析模型中）也必须包含在插补模型中。\n\n如果模型不协调，就可能引入偏倚。让我们考虑这个具体情景。\n**分析模型**是 $Y$ 的一个线性模型：\n$$\n\\mathbb{E}[Y \\mid X,Z] = \\beta_{0} + \\beta_{1}X + \\beta_{2}Z + \\beta_{3}XZ\n$$\n感兴趣的**估计量**是 $\\beta_{3}$，即 $XZ$ 交互作用项的系数。\n\n假设使用了一个**不协调的插补模型**，该模型省略了交互作用项：\n$$\n\\mathbb{E}[Y \\mid X,Z] = \\alpha_{0} + \\alpha_{1}X + \\alpha_{2}Z\n$$\n该插补模型隐含地假设真实的交互效应为零（$\\beta_{3}=0$）。当使用此模型为缺失的 $Y$ 值（即 $R=0$ 的受试者）生成插补值时，插补值 $Y_{imp}$ 将从一个其均值结构对 $X$ 和 $Z$ 是可加形式的分布中抽取。因此，在插补的数据点内，没有 $XZ$ 交互作用的证据。\n\n$m$ 个完整数据集中的每一个都由两部分组成：\n1.  $R=1$ 受试者的观测数据 $(Y_{obs}, X, Z)$。\n2.  $R=0$ 受试者的插补数据 $(Y_{imp}, X, Z)$。\n\n当分析师将分析模型（包括 $XZ$ 项）拟合到一个完整的数据集时，得到的估计值 $\\hat{\\beta_3}$ 将是存在于观测数据中的交互效应与内置于插补数据中的零交互效应的混合。该估计值将偏向插补模型的假设，即偏向于 $0$。这种偏倚不是有限样本量或有限插补次数（$m$）的结果；它是一种系统性的建模误差。即使样本量和 $m$ 趋于无穷大，它仍然存在。MAR 假设 $\\mathbb{P}(R=1 \\mid Y,X,Z)=\\mathbb{P}(R=1 \\mid X)$ 使得插补成为可能，但不能防止这种模型设定错误导致的偏倚。\n\n### 逐项评估选项\n\n**A. 协调性要求插补模型与分析模型对于与估计量相关的联合分布是兼容的，并且至少与分析模型同样丰富，包括相同的变量及其函数形式（例如，交互作用和非线性变换），从而使目标估计量是插补模型后验预测分布的一个泛函。例如，如果真实的数据生成模型是 $Y=\\beta_{0}+\\beta_{1}X+\\beta_{2}Z+\\beta_{3}XZ+\\varepsilon$，其中 $\\mathbb{E}[\\varepsilon \\mid X,Z]=0$ 且 $R \\perp Y \\mid X$ (MAR)，但用于缺失 $Y$ 的插补模型忽略了 $XZ$ 项，并使用线性可加均值 $\\mathbb{E}[Y \\mid X,Z]=\\alpha_{0}+\\alpha_{1}X+\\alpha_{2}Z$，那么填补后的完整数据集将在 $R=0$ 的子集中系统性地低估交互作用信号。因此，即使插补次数 $m \\to \\infty$，XZ 系数的合并 MI 估计也会偏向于 $0$，因为插补模型与分析模型不协调。**\n\n该选项提供了协调性的精确且正确的定义。其示例完美地说明了违反该原则的后果：使用一个比分析模型更简单（省略 $XZ$ 项）的插补模型。关于插补值将缺少交互作用信号，导致合并估计偏向于 $0$ 的解释完全正确。该偏倚对于 $m \\to \\infty$ 仍然存在的说法也是正确的。符号 $R \\perp Y \\mid X$ 是对给定 MAR 假设 $\\mathbb{P}(R=1 \\mid Y,X,Z)=\\mathbb{P}(R=1 \\mid X)$ 的有效陈述。\n\n**结论：正确。**\n\n**B. 在 MAR 条件下，只要插补模型包含与分析模型相同的一组变量作为预测变量，无论它是否包含相同的变换（例如，交互作用或非线性项），MI 都能为任何分析模型提供无偏的合并点估计。因此，当分析模型包含 $XZ$ 项时，从插补模型中省略它不会使 $XZ$ 系数的 MI 估计产生偏倚。**\n\n这个陈述是错误的。它错误地声称包含基础变量（$X$ 和 $Z$）就足以保证无偏性。如上所述，关系的函数形式，包括像 $XZ$ 这样的交互作用，是至关重要的。从插补模型中省略分析模型中存在的项是 MI 中偏倚的一个经典原因。\n\n**结论：不正确。**\n\n**C. 协调性只涉及方差估计；只要 MAR 成立，一个忽略了分析模型中使用的交互作用或非线性项的插补模型将产生正确的合并点估计，最坏情况下由于模型错配而导致标准误偏于保守。**\n\n这个陈述是错误的。不协调性，特别是当插补模型被错误地设定为比分析模型更简单时，主要导致有偏的点估计。虽然它也影响方差估计，通常导致方差低估（即，不保守的标准误），因为插补模型未能传播关于更复杂结构的不确定性，但主要问题是点估计的偏倚。声称点估计是正确的，这从根本上是错误的。\n\n**结论：不正确。**\n\n**D. 对于一个使用包含 $XZ$ 交互作用的对数线性泊松回归进行分析的计数结局，在 MAR 条件下，从一个关于 $X$ 和 $Z$ 的等方差正态线性回归（不包括 $XZ$）来插补缺失的计数值是协调的，因为两个模型都是参数线性的；因此，当 $m \\to \\infty$ 时，交互作用的合并估计是无偏的。**\n\n这个陈述基于多个理由是错误的。\n1.  **交互作用的遗漏：** 它提出了一个排除了 $XZ$ 交互作用的插补模型，而分析模型却包含了它。如前所述，这是一种导致偏倚的不协调形式。\n2.  **分布不匹配：** 它建议使用正态线性回归模型（该模型假定变量是连续、等方差的，并且可以生成负值或非整数值）来插补一个计数变量（它是离散且非负的）。插补模型和分析模型之间分布假设的这种不匹配是另一种可能导致偏倚和其他问题的不协调形式。\n3.  **无效的理由：** “因为两个模型都是参数线性的”这一协调性声明是无关且具有误导性的。广义线性模型的这一属性并不能凌駕于关于所含变量/项和分布假设适当性的基本协调性要求之上。\n因此，关于估计是无偏的结论是不正确的。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}