{
    "hands_on_practices": [
        {
            "introduction": "评估比例风险 (PH) 假设的一个基本方法是图形化检查。此练习将引导您完成一个核心技能的实践：为不同组别计算并绘制累积风险函数，并通过检查它们的对数差是否随时间保持恒定来直观地评估 PH 假设。这个基于 Nelson–Aalen 估计量的方法是生存分析工具箱中的一个基础技术 。",
            "id": "4991166",
            "problem": "一项随机临床研究跟踪两个由 $g \\in \\{1,2\\}$ 索引的组，以比较发生心血管事件的时间。对于组 $g$ 中的受试者 $i$，$T_{gi}$ 是事件或删失发生的时间，$\\Delta_{gi} \\in \\{0,1\\}$ 是事件指示符。风险函数为 $h_g(t)$，累积风险为 $H_g(t) = \\int_0^t h_g(u)\\,du$。生存函数为 $S_g(t) = \\exp\\{-H_g(t)\\}$。在比例风险（PH）假设下，存在一个恒定的风险比 $\\theta > 0$，使得对于所有 $t \\ge 0$，$h_2(t) = \\theta \\, h_1(t)$。您的任务是使用特定于组的 Nelson-Aalen 估计量来估计 $H_g(t)$，并通过检查特定于组的累积风险对数的差值是否随 $t$ 近似恒定来评估 PH 假设。\n数据：组1有 $n_1 = 4$ 名受试者，其观测到的 $(T_{1i}, \\Delta_{1i})$ 等于 $(1,1)$、$(3,1)$、$(5,0)$、$(7,1)$。组2有 $n_2 = 4$ 名受试者，其 $(T_{2i}, \\Delta_{2i})$ 等于 $(2,1)$、$(4,1)$、$(6,1)$、$(8,0)$。假设无左截断以及独立的、非信息性的右删失。考虑两组中所有不同事件时间的合并集合。\n从 $h_g(t)$ 和 $H_g(t)$ 的核心定义出发，并使用在各组内计算的、经过充分检验的 $H_g(t)$ 的 Nelson-Aalen 估计量，从概念上和计算上完成以下任务：\n- 对于每个组 $g \\in \\{1,2\\}$，定义在该组中每个不同事件时间 $t_j$ 之前的特定于组的风险集大小 $r_g(t_j)$ 和在 $t_j$ 时的事件数 $d_g(t_j)$。使用这些值计算特定于组的 Nelson-Aalen 估计量 $\\widehat H_g(t)$，它是在合并的事件时间上直至观察到的最大事件时间的右连续阶梯函数。\n- 在 $\\log \\widehat H_g(t)$ 有定义时，使用它来检查 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 是否随 $t$ 近似恒定，并说明 PH 假设在这些数据中是否得到支持。\n- 明确说明计算对数所需的任何约束以及任何对结（tie）的处理。\n以下哪些陈述是正确的？选择所有适用的选项。\n\nA. 对于每个组 $g$，Nelson-Aalen 估计量仅使用组内风险集进行计算：$\\widehat H_g(t) = \\sum_{t_{gj} \\le t} d_g(t_{gj}) / r_g(t_{gj})$，其中 $r_g(t_{gj})$ 计算组 $g$ 中在 $t_{gj}$ 之前处于风险中的受试者数量，$d_g(t_{gj})$ 计算组 $g$ 在 $t_{gj}$ 时的事件数量。为了评估比例风险，在两个 $\\widehat H_g(t) > 0$ 的合并事件时间 $t$ 上评估 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$，并检查其是否随 $t$ 近似恒定。\n\nB. 一种更简单且等效的 PH 诊断方法是为每个组计算 Kaplan-Meier 估计量 $\\widehat S_g(t)$，并检查 $\\widehat S_1(t) - \\widehat S_2(t)$ 是否随 $t$ 近似恒定；如果是，则 PH 假设成立。\n\nC. 为了稳定估计，每个组的 Nelson-Aalen 增量中的分母应该是两组的合并风险计数，即来自所有受试者的 $r(t_j)$，而不是组内的 $r_g(t_j)$。\n\nD. 因为在比例风险假设下，对于某个常数 $\\theta$ 有 $H_2(t) = \\theta H_1(t)$，所以对数差值检验的一个等效诊断方法是检查 $\\widehat H_2(t) / \\widehat H_1(t)$ 在两个分母都为正的时间段内是否随 $t$ 近似恒定。\n\nE. 如果在给定时间 $t$，组 $g$ 中存在 $d_g(t) \\ge 2$ 个结事件（tied events），则在 $t$ 时的 Nelson-Aalen 增量是 $d_g(t) / r_g(t)$，其中使用恰好在 $t$ 之前的特定于组的风险集大小；这种对结的处理是 Nelson-Aalen 的标准方法。\n\nF. 使用所提供的数据，在两者都有定义的时间段内计算出的 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 值随 $t$ 变化很大，因此 PH 假设在此样本中不受支持。\n\nG. 当早期时间的 $\\widehat H_g(t) = 0$ 时，可以接受将 $\\log \\widehat H_g(t)$ 定义为 $0$，以便所有合并的事件时间都可以无限制地用于对数差值图中。",
            "solution": "### 问题验证\n\n#### 步骤1：提取给定信息\n- **研究设置**：一项随机临床研究，有两个由 $g \\in \\{1,2\\}$ 索引的组。\n- **每个受试者的数据**：对于组 $g$ 中的受试者 $i$，观测数据为 $(T_{gi}, \\Delta_{gi})$，其中 $T_{gi}$ 是事件或删失发生的时间，$\\Delta_{gi} \\in \\{0,1\\}$ 是事件指示符（$\\Delta_{gi}=1$ 表示事件，$\\Delta_{gi}=0$ 表示删失）。\n- **风险函数**：$h_g(t)$ 是组 $g$ 的风险函数。\n- **累积风险函数**：$H_g(t) = \\int_0^t h_g(u)\\,du$。\n- **生存函数**：$S_g(t) = \\exp\\{-H_g(t)\\}$。\n- **比例风险（PH）假设**：存在一个恒定的风险比 $\\theta > 0$，使得对于所有 $t \\ge 0$，$h_2(t) = \\theta \\, h_1(t)$。\n- **任务**：通过检查特定于组的 Nelson-Aalen 估计量的对数差值 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 是否随时间 $t$ 近似恒定来评估 PH 假设。\n- **组1的数据**：$n_1 = 4$ 名受试者，其 $(T_{1i}, \\Delta_{1i})$ 对为：$(1,1)$、$(3,1)$、$(5,0)$、$(7,1)$。\n- **组2的数据**：$n_2 = 4$ 名受试者，其 $(T_{2i}, \\Delta_{2i})$ 对为：$(2,1)$、$(4,1)$、$(6,1)$、$(8,0)$。\n- **假设**：无左截断，独立的、非信息性的右删失。\n- **计算说明**：使用特定于组的 Nelson-Aalen 估计量 $\\widehat H_g(t) = \\sum_{t_{gj} \\le t} d_g(t_{gj}) / r_g(t_{gj})$，其中 $r_g(t_j)$ 是在时间 $t_j$ 之前组 $g$ 中处于风险中的受试者数量，$d_g(t_j)$ 是在时间 $t_j$ 时组 $g$ 中的事件数量。评估应在合并的不同事件时间集合上进行。\n\n#### 步骤2：使用提取的给定信息进行验证\n根据验证标准评估问题陈述：\n- **科学依据**：该问题设置在生存分析的标准框架内，这是生物统计学和医学统计学的核心主题。所有定义——风险函数、累积风险函数、生存函数、比例风险假设和 Nelson-Aalen 估计量——都是标准的且符合教科书。所提出的评估 PH 假设的方法是一种有效且广泛使用的图形技术。没有科学或事实错误。\n- **问题明确**：问题结构清晰。它提供了具体数据、一个明确定义的统计模型（PH 模型）、一个标准的非参数估计量（Nelson-Aalen）和一个精确的任务（计算估计量和一个诊断量，然后评估具体陈述）。数据完整且足以执行所需的计算。计算存在唯一解。\n- **客观性**：语言精确、量化，没有主观性或歧义。像“风险集”、“事件指示符”和“Nelson-Aalen 估计量”等术语在该领域有明确的定义。\n\n该问题没有违反任何无效性标准。它是应用统计学中一个标准的、正式的练习。\n\n#### 步骤3：结论与行动\n问题有效。将继续进行求解过程。\n\n### 解题推导\n\n比例风险（PH）假设指出，对于一个常数 $\\theta > 0$，有 $h_2(t) = \\theta h_1(t)$。将两边从 $0$ 到 $t$ 积分，得到累积风险函数的关系：\n$$ H_2(t) = \\int_0^t h_2(u)\\,du = \\int_0^t \\theta h_1(u)\\,du = \\theta \\int_0^t h_1(u)\\,du = \\theta H_1(t) $$\n对两边取自然对数（对于使得 $H_1(t) > 0$ 和 $H_2(t) > 0$ 的 $t$），我们得到：\n$$ \\log H_2(t) = \\log(\\theta H_1(t)) = \\log \\theta + \\log H_1(t) $$\n整理得：\n$$ \\log H_2(t) - \\log H_1(t) = \\log \\theta $$\n这表明，在 PH 假设下，两组的对数累积风险之差是一个常数 $\\log \\theta$。问题要求检查 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 是否恒定，这等同于检查 $\\log \\widehat H_2(t) - \\log \\widehat H_1(t)$ 是否恒定（其常数只是前者的相反数）。我们可以通过用 Nelson-Aalen 估计值 $\\widehat H_g(t)$ 替换理论函数 $H_g(t)$ 来评估这一点。\n\n组 $g$ 的累积风险的 Nelson-Aalen 估计量由下式给出：\n$$ \\widehat H_g(t) = \\sum_{t_{gj} \\le t} \\frac{d_g(t_{gj})}{r_g(t_{gj})} $$\n其中 $t_{gj}$ 是组 $g$ 中的不同事件时间，$d_g(t_{gj})$ 是在时间 $t_{gj}$ 时组 $g$ 中的事件数，而 $r_g(t_{gj})$ 是在时间 $t_{gj}$ 之前组 $g$ 中处于风险中的受试者数量。\n\n**1. 组1的计算：**\n数据：$(1,1), (3,1), (5,0), (7,1)$。初始风险集大小 $n_1=4$。\n不同的事件时间为 $t=1, 3, 7$。\n- 在 $t=1$ 时：$d_1(1)=1$, $r_1(1)=4$。增量为 $1/4$。对于 $1 \\le t  3$，$\\widehat H_1(t) = 1/4$。\n- 在 $t=3$ 时：一名受试者发生事件。$r_1(3)=3$。$d_1(3)=1$。增量为 $1/3$。对于 $3 \\le t  5$，$\\widehat H_1(t) = 1/4 + 1/3 = 7/12$。\n- 在 $t=5$ 时：一名受试者被删失。对于后续时间，风险集大小从 $2$ 减小到 $1$。$\\widehat H_1(t)$ 没有增量。对于 $5 \\le t  7$，$\\widehat H_1(t)$ 保持为 $7/12$。\n- 在 $t=7$ 时：一名受试者在 $t=1$ 时发生事件，一名在 $t=3$ 时发生事件，一名在 $t=5$ 时被删失。在 $t=7$ 之前的风险集为 $r_1(7)=1$。$d_1(7)=1$。增量为 $1/1 = 1$。对于 $t \\ge 7$，$\\widehat H_1(t) = 7/12 + 1 = 19/12$。\n\n**2. 组2的计算：**\n数据：$(2,1), (4,1), (6,1), (8,0)$。初始风险集大小 $n_2=4$。\n不同的事件时间为 $t=2, 4, 6$。\n- 在 $t=2$ 时：$d_2(2)=1$, $r_2(2)=4$。增量为 $1/4$。对于 $2 \\le t  4$，$\\widehat H_2(t) = 1/4$。\n- 在 $t=4$ 时：一名受试者发生事件。$r_2(4)=3$。$d_2(4)=1$。增量为 $1/3$。对于 $4 \\le t  6$，$\\widehat H_2(t) = 1/4 + 1/3 = 7/12$。\n- 在 $t=6$ 时：一名受试者发生事件。$r_2(6)=2$。$d_2(6)=1$。增量为 $1/2$。对于 $t \\ge 6$，$\\widehat H_2(t) = 7/12 + 1/2 = 13/12$。\n- 在 $t=8$ 时：一名受试者被删失。\n\n**3. 评估PH假设：**\n我们在合并的不同事件时间 $t \\in \\{1, 2, 3, 4, 6, 7\\}$ 上评估 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$，并限制在 $\\widehat H_1(t)0$ 和 $\\widehat H_2(t)0$ 的时间点。\n\n| 时间 $t$ | $\\widehat H_1(t)$ | $\\widehat H_2(t)$ | $\\log \\widehat H_1(t)$ | $\\log \\widehat H_2(t)$ | $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ |\n| :------: | :--------------: | :--------------: | :-------------------: | :-------------------: | :---------------------------------------------: |\n| 1 | $1/4$ | $0$ | $\\approx -1.386$ | 未定义 | 未定义 |\n| 2 | $1/4$ | $1/4$ | $\\approx -1.386$ | $\\approx -1.386$ | $0$ |\n| 3 | $7/12$ | $1/4$ | $\\approx -0.539$ | $\\approx -1.386$ | $\\approx 0.847$ |\n| 4 | $7/12$ | $7/12$ | $\\approx -0.539$ | $\\approx -0.539$ | $0$ |\n| 6 | $7/12$ | $13/12$ | $\\approx -0.539$ | $\\approx 0.080$ | $\\approx -0.619$ |\n| 7 | $19/12$ | $13/12$ | $\\approx 0.459$ | $\\approx 0.080$ | $\\approx 0.379$ |\n\n差值 $\\{0, 0.847, 0, -0.619, 0.379\\}$ 波动显著，看起来不是恒定的。这表明比例风险假设不受这些数据的支持。\n\n### 逐项分析\n\n**A. 对于每个组 $g$，Nelson-Aalen 估计量仅使用组内风险集进行计算：$\\widehat H_g(t) = \\sum_{t_{gj} \\le t} d_g(t_{gj}) / r_g(t_{gj})$，其中 $r_g(t_{gj})$ 计算组 $g$ 中在 $t_{gj}$ 之前处于风险中的受试者数量，$d_g(t_{gj})$ 计算组 $g$ 在 $t_{gj}$ 时的事件数量。为了评估比例风险，在两个 $\\widehat H_g(t)  0$ 的合并事件时间 $t$ 上评估 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$，并检查其是否随 $t$ 近似恒定。**\n该陈述准确地描述了标准程序。要估计特定于组的累积风险，必须使用特定于组的风险集和事件计数。诊断检验涉及比较这些估计函数，特别是寻找对数尺度上的恒定差异，这对应于原始尺度上的恒定比率。将时间限制在估计量为正的范围内，对于对数函数在数学上是必需的。\n**结论：正确**\n\n**B. 一种更简单且等效的 PH 诊断方法是为每个组计算 Kaplan-Meier 估计量 $\\widehat S_g(t)$，并检查 $\\widehat S_1(t) - \\widehat S_2(t)$ 是否随 $t$ 近似恒定；如果是，则 PH 假设成立。**\n这是不正确的。在 PH 假设下，$S_2(t) = [S_1(t)]^\\theta$。这是一个幂关系，而不是加性关系。差值 $S_1(t) - S_2(t)$ 不会是恒定的。使用生存函数的正确诊断方法是绘制 $\\log(-\\log \\widehat S_2(t))$ 对 $\\log(-\\log \\widehat S_1(t))$ 的图，这应该会产生一条斜率为 $\\theta$ 的直线。或者，绘制 $\\log(-\\log \\widehat S_2(t)) - \\log(-\\log \\widehat S_1(t))$ 对 $\\log(t)$ 的图，应该是一条高度为 $\\log \\theta$ 的水平线。\n**结论：不正确**\n\n**C. 为了稳定估计，每个组的 Nelson-Aalen 增量中的分母应该是两组的合并风险计数，即来自所有受试者的 $r(t_j)$，而不是组内的 $r_g(t_j)$。**\n这对于创建 PH 诊断图的目的是不正确的。使用合并的风险集是估计*共同*累积风险函数的方法，这是构建对数秩检验（log-rank test）统计量以检验零假设 $H_0: \\theta=1$ 的关键组成部分。这里的目标不同：分别估计 $\\widehat H_1(t)$ 和 $\\widehat H_2(t)$，以查看它们的关系是否与任何 $\\theta$ 的比例性一致。这需要特定于组的估计量。\n**结论：不正确**\n\n**D. 因为在比例风险假设下，对于某个常数 $\\theta$ 有 $H_2(t) = \\theta H_1(t)$，所以对数差值检验的一个等效诊断方法是检查 $\\widehat H_2(t) / \\widehat H_1(t)$ 在两个分母都为正的时间段内是否随 $t$ 近似恒定。**\n这是正确的。关系 $H_2(t) = \\theta H_1(t)$ 直接意味着对于所有 $H_1(t)  0$ 的 $t$，比率 $H_2(t) / H_1(t) = \\theta$。因此，检查估计量比率 $\\widehat H_2(t) / \\widehat H_1(t)$ 的恒定性是评估 PH 假设的一种直接且数学上等效的方法。取对数可以使这种关系线性化，这在视觉检查中通常是首选，因为它可以更容易地检测到与恒定性的偏差并稳定方差，但比率图也是一种有效的诊断方法。\n**结论：正确**\n\n**E. 如果在给定时间 $t$，组 $g$ 中存在 $d_g(t) \\ge 2$ 个结事件（tied events），则在 $t$ 时的 Nelson-Aalen 增量是 $d_g(t) / r_g(t)$，其中使用恰好在 $t$ 之前的特定于组的风险集大小；这种对结的处理是 Nelson-Aalen 的标准方法。**\n这个陈述是正确的。Nelson-Aalen 框架自然地处理了结事件时间。时间 $t$ 的风险增量估计为该时间的总事件数除以紧接其前的风险人数。这是 Nelson-Aalen 估计量对结的标准定义和处理方法。尽管所提供的数据中没有结，但所描述的原则是准确的。\n**结论：正确**\n\n**F. 使用所提供的数据，在两者都有定义的时间段内计算出的 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 值随 $t$ 变化很大，因此 PH 假设在此样本中不受支持。**\n如上面的计算所示，计算出的差值 $\\log \\widehat H_1(t) - \\log \\widehat H_2(t)$ 在相关时间点上取值为 $\\{0, \\approx 0.847, 0, \\approx-0.619, \\approx 0.379\\}$。这个序列显然不是恒定的。相对于值本身，变化是巨大的。因此，对这些数据的视觉检查会让人质疑 PH 假设的有效性。\n**结论：正确**\n\n**G. 当早期时间的 $\\widehat H_g(t) = 0$ 时，可以接受将 $\\log \\widehat H_g(t)$ 定义为 $0$，以便所有合并的事件时间都可以无限制地用于对数差值图中。**\n这在数学上是不正确的。$0$ 的自然对数是未定义的（它趋向于 $-\\infty$）。分配一个任意的有限值（如 $0$）是对对数函数数学性质的篡改，会严重扭曲诊断图。正确的程序是将图的定义域限制在 $\\widehat H_1(t)$ 和 $\\widehat H_2(t)$ 都严格为正的时间 $t$。\n**结论：不正确**",
            "answer": "$$\\boxed{ADEF}$$"
        },
        {
            "introduction": "当诸如 Schoenfeld 残差检验等诊断工具明确指出比例风险假设被违背后，继续使用标准的 Cox 模型将可能得出误导性结论。本练习模拟了一个真实世界的数据分析挑战，您需要基于给定的诊断证据和模型比较准则（如赤池信息量准则 AIC），来决定是保留 Cox 模型，还是选择一个更合适的非比例风险模型，例如加速失效时间 (AFT) 模型 。这项实践旨在培养您在模型假设不满足时进行合理模型选择的能力。",
            "id": "4991128",
            "problem": "考虑一项带有右删失事件发生时间结果的随机临床试验，其中事件为疾病进展时间。令 $T$ 表示非负生存时间，$\\delta \\in \\{0,1\\}$ 表示事件指示符（如果观察到进展，则 $\\delta=1$，如果删失，则为 $0$）。令 $\\mathbf{x}$ 表示一个协变量向量，包括二元治疗指示符 $Z \\in \\{0,1\\}$、基线年龄 $A$（以年为单位）以及作为有序评分的疾病分期 $S$。风险函数为 $h(t \\mid \\mathbf{x})$，生存函数为 $S(t \\mid \\mathbf{x})$，密度函数为 $f(t \\mid \\mathbf{x})$。您的任务是评估比例风险（Proportional Hazards, PH）假设，如果该假设被违反，则使用加速失效时间（Accelerated Failure Time, AFT）框架来论证一个科学上合理的非比例风险替代方案，并展示一个使用残差诊断和信息准则在 PH 和 AFT 模型之间进行选择的原则性程序。\n\n需要使用的基本定义如下：\n- Cox 比例风险 (PH) 模型：$h(t \\mid \\mathbf{x}) = h_0(t) \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$，其中 $h_0(t)$ 是未指定的基线风险，$\\boldsymbol{\\beta}$ 是回归参数。在 PH 假设下，对于固定的 $\\mathbf{x}_1$ 和 $\\mathbf{x}_2$，风险比 $\\mathrm{HR}(t; \\mathbf{x}_1,\\mathbf{x}_2) = h(t \\mid \\mathbf{x}_1)/h(t \\mid \\mathbf{x}_2)$ 在时间 $t$ 上是恒定的。\n- 加速失效时间 (AFT) 模型：$\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$，其中 $W$ 服从一个指定的基线误差分布，其累积分布函数为 $F_W(\\cdot)$，密度函数为 $f_W(\\cdot)$，且 $\\sigma0$ 是一个尺度参数。等价地，$S(t \\mid \\mathbf{x}) = S_0\\!\\left(t \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})\\right)$，其中 $S_0(\\cdot)$ 是由 $W$ 导出的基线生存函数。\n\n假设您在一个大小为 $n=800$、右删失率为 $30\\%$ 的数据集上拟合了一个包含协变量 $(Z,A,S)$ 的 Cox PH 模型。您计算了每个协变量的缩放 Schoenfeld 残差，并应用了 Grambsch and Therneau (GT) 检验来检验斜率是否为零（相对于 $\\log(t)$）：\n- 对于 $Z$，相对于 $\\log(t)$ 的估计斜率为 $0.35$，双侧 $p$ 值为 $p=0.0003$；对于 $A$ 和 $S$，斜率接近于 $0$，且 $p0.20$。\n一个对数负对数图（log-minus-log plot），即按 $Z$ 分层的 $\\log\\{-\\log \\widehat{S}(t \\mid Z)\\}$ 对 $\\log(t)$ 的曲线图，显示出明显的非平行和交叉。\n然后，您使用 $(Z,A,S)$ 拟合了三个参数化 AFT 候选模型：对数正态、对数逻辑和 Weibull。对于对数正态 AFT 拟合，未删失案例的标准化误差残差 $\\widehat{\\epsilon}_i = \\{\\log(t_i) - \\mathbf{x}_i^\\top \\widehat{\\boldsymbol{\\beta}}\\}/\\widehat{\\sigma}$ 在正态分位数-分位数图（quantile-quantile plot）上排列紧密（相关性为 $0.995$），而对数逻辑模型的类似残差在逻辑分位数-分位数图上排列较差（相关性为 $0.972$）。Weibull AFT 在相应的分位数图上显示出明显的尾部偏差。\n您还计算了已拟合模型的信息准则：\n- 使用偏似然的 Cox PH 模型：$\\mathrm{AIC}_{\\mathrm{Cox}} = 1420$。\n- 对数正态 AFT（全似然）：$\\mathrm{AIC}_{\\mathrm{LN}} = 1388$。\n- 对数逻辑 AFT（全似然）：$\\mathrm{AIC}_{\\mathrm{LL}} = 1401$。\n- Weibull PH 参数化（使用 PH 链接的全似然）：$\\mathrm{AIC}_{\\mathrm{WPH}} = 1416$。\n\n仅使用上述基本定义和报告的诊断结果，选择最能正确解释加速失效时间模型如何作为非比例风险替代方案的选项，并展示一个通过残差诊断和信息准则在该数据集上选择 PH 或 AFT 模型的有效、分步的程序，最终得出一个合理的模型选择。\n\nA. AFT 模型通过 $T^* = T \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$ 对时间进行重新缩放，这通常会产生一个随时间变化的风险比，除非基线风险 $h_0(t)$ 具有特殊的幂律形式（例如，Weibull 分布）。一个原则性的选择程序是：首先，通过将缩放 Schoenfeld 残差对时间函数进行回归并执行 Grambsch and Therneau 检验来评估 PH 假设；$Z$ 的非零斜率（$p=0.0003$）意味着 $Z$ 违反了 PH 假设，这一点由非平行的对数负对数曲线所证实。接下来，拟合候选的 AFT 族并评估模型特定的残差（例如，通过分位数-分位数图将标准化 AFT 误差与假设的 $W$ 分布进行比较，或将 Cox–Snell 残差与指数参考分布进行比较）；对数正态 AFT 残差的近正态排列（相关性为 $0.995$）表明模型是充分的。最后，比较 Cox PH（偏似然）和参数化 AFT 拟合的 Akaike 信息准则；最低的 $\\mathrm{AIC}$（此处为 $\\mathrm{AIC}_{\\mathrm{LN}}=1388$，而 $\\mathrm{AIC}_{\\mathrm{Cox}}=1420$ 和 $\\mathrm{AIC}_{\\mathrm{LL}}=1401$）支持对数正态 AFT 作为 $Z$ 的首选非比例风险替代模型，同时保留 $A$ 和 $S$ 作为与时间无关的效应。\n\nB. AFT 模型加速了风险，因此如果对数秩检验（log-rank test）显著，则应接受 PH 假设并选择具有最高一致性指数（concordance index）的模型；残差和信息准则都是次要的。由于对数秩检验通常很敏感，应继续使用 Cox PH 模型并忽略 Schoenfeld 残差的趋势；基于偏似然和全似然计算的信息准则不具有可比性。\n\nC. 如果基线分布是对数正态的，AFT 模型等同于 PH 模型。要进行选择，绘制鞅残差（martingale residuals）对时间的图来评估 PH 假设，然后选择直接从 Cox 偏似然和 AFT 全似然计算出的具有最低贝叶斯信息准则（Bayesian Information Criterion）的模型。鉴于报告的 $Z$ 的 $p=0.0003$，选择 Weibull PH 模型，因为它的风险随时间恒定。\n\nD. AFT 模型通过一个加性移位来改变基线风险，因此如果 Grambsch and Therneau 检验显示任何显著性，应重新拟合一个带有 $Z \\times \\log(t)$ 交互项的含时依懒性 Cox PH 模型，并选择具有最小偏差残差（deviance residuals）总和的模型；忽略半参数和参数模型之间的信息准则比较，因为它们使用不同的似然。鉴于残差模式，应首选 Cox PH 模型，因为它比参数化 AFT 模型更稳健。",
            "solution": "用户要求对一个关于生存分析中比较比例风险（PH）和加速失效时间（AFT）模型的问题陈述进行严格验证，并随后提供详细的解决方案和选项评估。\n\n### 第 1 步：提取已知信息\n- **问题领域**：随机临床试验，右删失事件发生时间数据（疾病进展时间）。\n- **变量**：$T$（生存时间），$\\delta$（事件指示符），$\\mathbf{x}$（协变量向量），$Z$（二元治疗指示符），$A$（基线年龄），$S$（有序疾病分期）。\n- **模型定义**：\n    - **Cox PH 模型**：$h(t \\mid \\mathbf{x}) = h_0(t) \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$，其中风险比随时间恒定。\n    - **AFT 模型**：$\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$，或等价地，$S(t \\mid \\mathbf{x}) = S_0\\!\\left(t \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})\\right)$。\n- **数据集和 Cox 模型诊断**：\n    - 样本量 $n=800$，删失率 $30\\%$。协变量为 $(Z,A,S)$。\n    - 对缩放 Schoenfeld 残差与 $\\log(t)$ 的 Grambsch and Therneau (GT) 检验：\n        - 对于 $Z$：估计斜率 $= 0.35$，$p$ 值 $= 0.0003$。\n        - 对于 $A, S$：斜率接近 $0$，$p$ 值 $ 0.20$。\n    - $\\log\\{-\\log \\widehat{S}(t \\mid Z)\\}$ 对 $\\log(t)$ 的图显示“明显的非平行和交叉”。\n- **AFT 模型诊断**：\n    - 拟合了三种 AFT 模型：对数正态、对数逻辑、Weibull。\n    - 通过 Q-Q 图检查标准化误差残差 $\\widehat{\\epsilon}_i = \\{\\log(t_i) - \\mathbf{x}_i^\\top \\widehat{\\boldsymbol{\\beta}}\\}/\\widehat{\\sigma}$：\n        - 对数正态 AFT：正态 Q-Q 图相关性为 $0.995$。\n        - 对数逻辑 AFT：逻辑 Q-Q 图相关性为 $0.972$。\n        - Weibull AFT：在其对应的 Q-Q 图上“有明显的尾部偏差”。\n- **信息准则**：\n    - $\\mathrm{AIC}_{\\mathrm{Cox}} = 1420$（偏似然）。\n    - $\\mathrm{AIC}_{\\mathrm{LN}} = 1388$（对数正态 AFT，全似然）。\n    - $\\mathrm{AIC}_{\\mathrm{LL}} = 1401$（对数逻辑 AFT，全似然）。\n    - $\\mathrm{AIC}_{\\mathrm{WPH}} = 1416$（Weibull PH，全似然）。\n\n### 第 2 步：使用提取的已知信息进行验证\n1.  **科学依据**：该问题基于生物统计学中生存分析的标准、公认原则。Cox PH 模型、AFT 模型、Schoenfeld 残差、Grambsch-Therneau 检验、对数负对数图、参数模型的特定残差以及 Akaike 信息准则（AIC）都是该领域的基本概念和工具。定义是正确的。该问题在科学和数学上是合理的。\n2.  **适定性**：该问题提供了一个清晰的场景、来自诊断检验和模型拟合的具体数值结果，并要求基于这些证据进行合理的选择。信息足以进行所需的推理，并从选项中得出一个唯一的最佳答案。\n3.  **客观性**：该问题使用精确的技术语言陈述。数据和诊断结果是定量的、客观的。任务是将既定的统计原则应用于这些证据，这是一个客观的过程。\n\n问题陈述没有表现出说明中列出的任何缺陷（例如，科学不合理性、不完整性、模糊性）。尽管存在细微差别，但将来自偏似然（Cox 模型）的 AIC 与来自全似然（参数模型）的 AICs 进行比较是一种公认的做法。为了问题的目的，将这些值作为已知条件给出是一种有效的简化。\n\n### 第 3 步：结论和行动\n问题陈述是有效的。将推导出一个完整的解决方案。\n\n### 推导与选项分析\n\n任务是根据所提供的证据，确定在 PH 和 AFT 模型之间进行选择的最正确的解释和程序。一个原则性的方法包括三个主要阶段：（1）评估初始模型（Cox PH）的假设，（2）如果假设被违反，则拟合合理的替代模型，以及（3）比较竞争模型以选择最佳模型。\n\n**1. 比例风险假设的评估**\n\nPH 假设指出，任何两个个体的风险比率随时间是恒定的。对于拟合的 Cox 模型，问题提供了关于此假设的两个关键证据。\n\n-   **Grambsch and Therneau (GT) 检验**：这是一个用于 PH 假设的正式检验。它检验缩放 Schoenfeld 残差对时间函数（通常是 $t$ 或 $\\log(t)$）回归的斜率是否为零。一个显著的 p 值表明相应协变量的效应随时间变化，从而违反了 PH 假设。\n    -   对于治疗指示符 $Z$，该检验得出了一个高度显著的 p 值，$p=0.0003$。这是反对治疗效应满足 PH 假设的强有力统计证据。正斜率（$0.35$）表明治疗的风险比随着时间的推移而增加。\n    -   对于年龄（$A$）和分期（$S$），p 值很大（$p0.20$），表明对于这些协变量，PH 假设是合适的。\n\n-   **对数负对数图**：如果某协变量满足 PH 假设，那么按该协变量不同分层绘制的 $\\log(-\\log(\\widehat{S}(t)))$ 对 $\\log(t)$ 的图应产生平行的曲线。\n    -   问题陈述这些按 $Z$ 分层的曲线显示出“明显的非平行和交叉”。这是非比例风险的一个经典视觉表示。交叉的曲线意味着风险比不仅是时间依赖的，而且在某个时间点会反转方向（例如，从 $1$ 变为 $1$）。\n\n**关于 PH 假设的结论**：来自正式统计检验和图形诊断的有力证据表明，对于治疗协变量 $Z$，比例风险假设被违反了。因此，标准的 Cox PH 模型对于此数据集是设定不当的，应考虑替代模型。\n\n**2. AFT 模型作为非 PH 替代方案**\n\nAFT 模型为协变量效应提供了一种替代的物理解释。协变量不是乘以风险，而是加速或减速事件发生的时间。该模型为 $\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$，等价于 $T = T_0 \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$，其中 $T_0 = \\exp(\\sigma W)$ 是时间的基线随机变量。\n\nAFT 模型的风险函数为 $h(t \\mid \\mathbf{x}) = h_0(t \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})) \\exp(-\\mathbf{x}^\\top \\boldsymbol{\\beta})$。对于具有协变量 $\\mathbf{x}_1$ 和 $\\mathbf{x}_2$ 的两个个体，其风险比为：\n$$\n\\mathrm{HR}(t) = \\frac{h(t \\mid \\mathbf{x}_1)}{h(t \\mid \\mathbf{x}_2)} = \\frac{h_0(t \\exp(-\\mathbf{x}_1^\\top \\boldsymbol{\\beta}))}{h_0(t \\exp(-\\mathbf{x}_2^\\top \\boldsymbol{\\beta}))} \\exp((\\mathbf{x}_2 - \\mathbf{x}_1)^\\top \\boldsymbol{\\beta})\n$$\n这个比率通常是时间 $t$ 的函数，意味着 AFT 模型本质上是一个非 PH 模型。唯一的例外是当基线风险 $h_0(t)$ 服从时间的幂律，$h_0(t) \\propto t^{\\alpha-1}$，这对应于 Weibull 分布。在这种特殊情况下，AFT 模型同时也是一个 PH 模型。对于其他常见的 AFT 分布，如对数正态或对数逻辑分布，PH 属性不成立。因此，AFT 模型代表了一大类具有机械性解释的非 PH 模型。\n\n**3. 在候选模型中进行选择**\n\n鉴于 PH 假设被违反，下一步是找到一个拟合得更好的模型。问题探讨了三个参数化 AFT 模型。它们之间的选择取决于两个标准：分布假设的充分性以及与其他候选模型相比的整体模型拟合度。\n\n-   **AFT 模型的残差诊断**：对于参数化 AFT 模型，必须检查 $\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\sigma W$ 中误差项 $W$ 的假设分布。标准化误差残差是 $W$ 的估计值，通过 Q-Q 图将其与假设分布的理论分位数进行比较。\n    -   **对数正态 AFT** 在正态 Q-Q 图上显示出近乎完美的拟合（相关性 $0.995$），有力地支持了其分布假设。\n    -   **对数逻辑 AFT** 显示出较差的拟合（相关性 $0.972$）。\n    -   **Weibull AFT** 显示出“明显的尾部偏差”，表明拟合不佳。\n    -   基于残差，对数正态 AFT 模型明显是最佳选择。\n\n-   **用于模型比较的信息准则**：Akaike 信息准则（AIC）提供了一种相对的模型质量度量，它对参数数量进行惩罚以防止过拟合。较低的 AIC 表示更好的模型。\n    -   $\\mathrm{AIC}_{\\mathrm{Cox}} = 1420$\n    -   $\\mathrm{AIC}_{\\mathrm{LN}} = 1388$\n    -   $\\mathrm{AIC}_{\\mathrm{LL}} = 1401$\n    -   $\\mathrm{AIC}_{\\mathrm{WPH}} = 1416$\n    -   比较这些值，对数正态 AFT 模型具有最低的 AIC（$1388$），且优势明显。差异 $\\Delta \\mathrm{AIC} = \\mathrm{AIC}_{\\mathrm{Cox}} - \\mathrm{AIC}_{\\mathrm{LN}} = 32$ 为选择对数正态 AFT 模型而不是 Cox PH 模型提供了非常强的支持。\n\n**总体结论**：系统性分析得出以下程序和结论：\n1.  使用 GT 检验和图形方法检查 PH 假设。在此，该假设对于 $Z$ 明显被违反。\n2.  提出并拟合科学上合理的替代模型，例如参数化 AFT 模型。\n3.  使用适当的残差诊断（例如，标准化误差残差的 Q-Q 图）评估每个 AFT 候选模型的拟合情况。发现对数正态 AFT 是拟合最好的。\n4.  使用像 AIC 这样的全局拟合准则比较所有候选模型（包括初始的 Cox 模型）。对数正态 AFT 模型受到强烈支持。\n最终选择是对数正态 AFT 模型。\n\n### 逐项选项分析\n\n**A. AFT 模型通过 $T^* = T \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})$ 对时间进行重新缩放，这通常会产生一个随时间变化的风险比，除非基线风险 $h_0(t)$ 具有特殊的幂律形式（例如，Weibull 分布）。一个原则性的选择程序是：首先，通过将缩放 Schoenfeld 残差对时间函数进行回归并执行 Grambsch and Therneau 检验来评估 PH 假设；$Z$ 的非零斜率（$p=0.0003$）意味着 $Z$ 违反了 PH 假设，这一点由非平行的对数负对数曲线所证实。接下来，拟合候选的 AFT 族并评估模型特定的残差（例如，通过分位数-分位数图将标准化 AFT 误差与假设的 $W$ 分布进行比较，或将 Cox–Snell 残差与指数参考分布进行比较）；对数正态 AFT 残差的近正态排列（相关性为 $0.995$）表明模型是充分的。最后，比较 Cox PH（偏似然）和参数化 AFT 拟合的 Akaike 信息准则；最低的 $\\mathrm{AIC}$（此处为 $\\mathrm{AIC}_{\\mathrm{LN}}=1388$，而 $\\mathrm{AIC}_{\\mathrm{Cox}}=1420$ 和 $\\mathrm{AIC}_{\\mathrm{LL}}=1401$）支持对数正态 AFT 作为 $Z$ 的首选非比例风险替代模型，同时保留 $A$ 和 $S$ 作为与时间无关的效应。**\n\n该选项准确地描述了 AFT 模型与 PH 模型的关​​系，为模型选择制定了一个逻辑上合理且标准的逐步程序，正确地解释了问题陈述中提供的所有诊断和比较证据，并得出了正确的结论。关于“保留 $A$ 和 $S$ 作为与时间无关的效应”的说法，是可接受的简写，意指将它们包含在所选模型中，且其系数是恒定的。**正确**。\n\n**B. AFT 模型加速了风险，因此如果对数秩检验（log-rank test）显著，则应接受 PH 假设并选择具有最高一致性指数（concordance index）的模型；残差和信息准则都是次要的。由于对数秩检验通常很敏感，应继续使用 Cox PH 模型并忽略 Schoenfeld 残差的趋势；基于偏似然和全似然计算的信息准则不具有可比性。**\n\n该选项存在根本性错误。（1）AFT 模型加速的是*时间*，而不是风险。（2）显著的对数秩检验并不能验证 PH 假设。（3）忽略对模型假设的正式检验（Schoenfeld 残差）是不良的统计实践。（4）一致性指数是区分度的度量，而不是校准度或假设有效性的度量。（5）信息准则是模型比较的关键。**不正确**。\n\n**C. 如果基线分布是对数正态的，AFT 模型等同于 PH 模型。要进行选择，绘制鞅残差（martingale residuals）对时间的图来评估 PH 假设，然后选择直接从 Cox 偏似然和 AFT 全似然计算出的具有最低贝叶斯信息准则（Bayesian Information Criterion）的模型。鉴于报告的 $Z$ 的 $p=0.0003$，选择 Weibull PH 模型，因为它的风险随时间恒定。**\n\n该选项包含多个错误。（1）AFT 模型与 PH 模型等价是对于 **Weibull** 分布，而不是对数正态分布。（2）虽然鞅残差很有用，但缩放 Schoenfeld 残差是评估特定协变量 PH 假设的最直接工具。（3）问题给出的是 AIC，而不是 BIC。（4）Weibull 模型的风险函数通常不随时间恒定，只有其特例——指数分布——才是这样。在有强烈证据反对 PH 的情况下选择一个 PH 模型是不合逻辑的。**不正确**。\n\n**D. AFT 模型通过一个加性移位来改变基线风险，因此如果 Grambsch and Therneau 检验显示任何显著性，应重新拟合一个带有 $Z \\times \\log(t)$ 交互项的含时依懒性 Cox PH 模型，并选择具有最小偏差残差（deviance residuals）总和的模型；忽略半参数和参数模型之间的信息准则比较，因为它们使用不同的似然。鉴于残差模式，应首选 Cox PH 模型，因为它比参数化 AFT 模型更稳健。**\n\n该选项是不正确的。（1）AFT 模型在时间尺度上是乘性的，而不是在风险尺度上是加性的（那是加性风险模型）。（2）偏差残差的总和不是一个标准的模型选择准则。（3）忽略 AIC 是没有根据的。（4）最终建议首选 Cox PH 模型直接与显示其主要假设被违反的诊断证据（“残差模式”）相矛盾。一个模型对于其自身核心假设的违反并不“稳健”。**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "比例风险假设的违背，特别是当出现风险交叉（即治疗效果随时间从有害转为有益）时，会导致单一的风险比 (Hazard Ratio) 成为一个极具误导性的效应总结指标。本练习通过一个具体的数值案例，演示了如何计算和解释在临床上更具意义和稳健性的替代指标。您将亲手计算限制性平均生存时间 (Restricted Mean Survival Time, RMST) 的差异以及特定时间点的生存概率，这些都是在处理非比例风险数据时推荐使用的重要报告指标 。",
            "id": "4991141",
            "problem": "一项随机对照试验（RCT）在一组患者群体中比较了一种新疗法与标准护理，事件时间以自随机化起的月数来衡量。研究者怀疑，由于新疗法的早期毒性和晚期获益，比例风险（PH）假设可能不成立。假设真实的特定原因风险是分段恒定的，并由以下科学上合理的模型给出：对于对照组，风险函数为：当 $0 \\le t  6$ 时，$h_{C}(t) = 0.08$ 每月；当 $t \\ge 6$ 时，$h_{C}(t) = 0.02$ 每月；对于治疗组，风险函数为：当 $0 \\le t  3$ 时，$h_{T}(t) = 0.16$ 每月；当 $3 \\le t  9$ 时，$h_{T}(t) = 0.04$ 每月；当 $t \\ge 9$ 时，$h_{T}(t) = 0.01$ 每月。假设删失是独立的，并且没有竞争风险。\n\n从生存分析的基本原理出发，即风险函数 $h(t)$、累积风险函数 $H(t) = \\int_{0}^{t} h(s)\\,ds$ 和生存函数 $S(t) = \\exp(-H(t))$ 的定义，评估时变风险比在临床环境中的可解释性。在不假设PH的情况下，当PH假设被违背时，针对临床相关的时间点（如 $t = 12$ 个月），提出具有临床可解释性的替代报告策略。\n\n在这种情况下，下列哪些陈述最具有说服力？选择所有适用项。\n\nA. 在不包含时间与治疗交互作用的情况下，拟合Cox比例风险模型（Cox PH）会产生一个单一的风险比，该风险比是 $h_{T}(t)/h_{C}(t)$ 在时间 $t$ 上的简单算术平均值，并且这个数值可以被解释为在所有时间点上恒定的相对风险降低。\n\nB. 当PH假设被违背时，报告在临床选定的时间点 $\\tau$ 的限制性平均生存时间（RMST）差异比单一风险比更具可解释性。在此情景下，当 $\\tau = 12$ 个月时，RMST的差异（治疗组减去对照组）约为-1.14个月。\n\nC. 在 $t = 24$ 个月时的瞬时风险比等于0.5，这个值可以被解释为接受治疗的患者存活时间至少是对照组患者两倍的概率。\n\nD. 在存在早期伤害和晚期获益的非比例风险情况下，单一风险比可能会产生误导。将生存概率 $S_{T}(12)$ 和 $S_{C}(12)$ 与RMST差异一同呈现，可以提高临床可解释性。在此情景下，$S_{T}(12) \\approx 0.472$ 且 $S_{C}(12) \\approx 0.549$。\n\nE. 违背PH假设会使Kaplan-Meier（KM）估计量失效，因此，除非PH假设成立，否则无法对RMST进行非参数估计。",
            "solution": "用户提供的问题陈述经评估有效。它在科学上基于标准的生存分析理论，问题阐述清晰，包含了推导唯一解所需的所有信息，并且语言客观。非比例风险的情景是生物统计学中一个经典且重要的话题。\n\n该问题需要对一个非比例风险的情景进行深入分析。我们将首先从给定的分段恒定风险函数中推导出必要的量。\n\n风险函数如下所示：\n对照组（C）：\n$h_{C}(t) = 0.08$ 当 $0 \\le t  6$\n$h_{C}(t) = 0.02$ 当 $t \\ge 6$\n\n治疗组（T）：\n$h_{T}(t) = 0.16$ 当 $0 \\le t  3$\n$h_{T}(t) = 0.04$ 当 $3 \\le t  9$\n$h_{T}(t) = 0.01$ 当 $t \\ge 9$\n\n比例风险（PH）假设要求风险比 $HR(t) = h_{T}(t) / h_{C}(t)$ 随时间保持恒定。我们来检验一下：\n- 当 $t \\in [0, 3)$ 时: $HR(t) = 0.16 / 0.08 = 2.0$\n- 当 $t \\in [3, 6)$ 时: $HR(t) = 0.04 / 0.08 = 0.5$\n- 当 $t \\in [6, 9)$ 时: $HR(t) = 0.04 / 0.02 = 2.0$\n- 当 $t \\ge 9$ 时: $HR(t) = 0.01 / 0.02 = 0.5$\n\n风险比不是恒定的，这证实了PH假设被违背。治疗在初期以及6-9个月时与较高的风险（伤害）相关，而在3-6个月以及 $t \\ge 9$ 时与较低的风险（获益）相关。\n\n接下来，我们推导生存函数 $S(t) = \\exp(-H(t))$，其中 $H(t) = \\int_0^t h(s) ds$。\n\n**对于对照组（C）：**\n累积风险函数 $H_C(t)$ 为：\n- 当 $0 \\le t  6$ 时: $H_C(t) = \\int_0^t 0.08 ds = 0.08t$。\n- 当 $t \\ge 6$ 时: $H_C(t) = \\int_0^6 0.08 ds + \\int_6^t 0.02 ds = 0.08(6) + 0.02(t-6) = 0.48 + 0.02t - 0.12 = 0.02t + 0.36$。\n生存函数 $S_C(t)$ 为：\n- 当 $0 \\le t  6$ 时: $S_C(t) = \\exp(-0.08t)$。\n- 当 $t \\ge 6$ 时: $S_C(t) = \\exp(-(0.02t + 0.36))$。\n\n**对于治疗组（T）：**\n累积风险函数 $H_T(t)$ 为：\n- 当 $0 \\le t  3$ 时: $H_T(t) = \\int_0^t 0.16 ds = 0.16t$。\n- 当 $3 \\le t  9$ 时: $H_T(t) = \\int_0^3 0.16 ds + \\int_3^t 0.04 ds = 0.16(3) + 0.04(t-3) = 0.48 + 0.04t - 0.12 = 0.04t + 0.36$。\n- 当 $t \\ge 9$ 时: $H_T(t) = H_T(9) + \\int_9^t 0.01 ds = (0.04(9) + 0.36) + 0.01(t-9) = 0.72 + 0.01t - 0.09 = 0.01t + 0.63$。\n生存函数 $S_T(t)$ 为：\n- 当 $0 \\le t  3$ 时: $S_T(t) = \\exp(-0.16t)$。\n- 当 $3 \\le t  9$ 时: $S_T(t) = \\exp(-(0.04t + 0.36))$。\n- 当 $t \\ge 9$ 时: $S_T(t) = \\exp(-(0.01t + 0.63))$。\n\n现在我们评估每个选项。\n\n**A. 在不包含时间与治疗交互作用的情况下，拟合Cox比例风险模型（Cox PH）会产生一个单一的风险比，该风险比是 $h_{T}(t)/h_{C}(t)$ 在时间 $t$ 上的简单算术平均值，并且这个数值可以被解释为在所有时间点上恒定的相对风险降低。**\n这个陈述是错误的。当PH假设被违背时，由标准Cox模型估计出的单一风险比不是一个简单的算术平均值。它是真实时变风险比的一个加权平均值，其中权重是在每个事件时间点处于风险中的个体数量的复杂函数。得到的单一HR通常难以解释，并且可能无法准确反映任何特定时间点的治疗效果。将这个单一的、平均化的值归因于所有时间点上恒定的相对风险，正是忽略PH违背所导致的误解。\n**结论：错误。**\n\n**B. 当PH假设被违背时，报告在临床选定的时间点 $\\tau$ 的限制性平均生存时间（RMST）差异比单一风险比更具可解释性。在此情景下，当 $\\tau = 12$ 个月时，RMST的差异（治疗组减去对照组）约为-1.14个月。**\n该陈述的第一部分是现代生存分析的核心原则。RMST定义为 $\\int_0^\\tau S(t) dt$，表示在前 $\\tau$ 个月内的平均无事件生存时间。RMST的差异是由于治疗在该时期内获得或损失的平均时间，这是一个高度可解释的度量，不依赖于PH假设。\n为了验证数值声明，我们计算每个组在 $\\tau = 12$ 个月时的RMST。\n$RMST_{C}(12) = \\int_0^{12} S_C(t) dt = \\int_0^6 e^{-0.08t} dt + \\int_6^{12} e^{-(0.02t + 0.36)} dt$\n$= \\left[-\\frac{e^{-0.08t}}{0.08}\\right]_0^6 + \\left[-\\frac{e^{-(0.02t+0.36)}}{0.02}\\right]_6^{12}$\n$= \\frac{1-e^{-0.48}}{0.08} + \\frac{e^{-(0.02 \\cdot 6 + 0.36)} - e^{-(0.02 \\cdot 12 + 0.36)}}{0.02}$\n$= \\frac{1-e^{-0.48}}{0.08} + \\frac{e^{-0.48} - e^{-0.60}}{0.02}$\n使用 $e^{-0.48} \\approx 0.618783$ 和 $e^{-0.60} \\approx 0.548812$,\n$RMST_{C}(12) \\approx \\frac{1-0.618783}{0.08} + \\frac{0.618783 - 0.548812}{0.02} \\approx 4.76521 + 3.49855 \\approx 8.2638$ 个月。\n\n$RMST_{T}(12) = \\int_0^{12} S_T(t) dt = \\int_0^3 e^{-0.16t} dt + \\int_3^9 e^{-(0.04t+0.36)} dt + \\int_9^{12} e^{-(0.01t+0.63)} dt$\n$= \\left[-\\frac{e^{-0.16t}}{0.16}\\right]_0^3 + \\left[-\\frac{e^{-(0.04t+0.36)}}{0.04}\\right]_3^9 + \\left[-\\frac{e^{-(0.01t+0.63)}}{0.01}\\right]_9^{12}$\n$= \\frac{1-e^{-0.48}}{0.16} + \\frac{e^{-(0.04 \\cdot 3 + 0.36)} - e^{-(0.04 \\cdot 9 + 0.36)}}{0.04} + \\frac{e^{-(0.01 \\cdot 9 + 0.63)} - e^{-(0.01 \\cdot 12 + 0.63)}}{0.01}$\n$= \\frac{1-e^{-0.48}}{0.16} + \\frac{e^{-0.48} - e^{-0.72}}{0.04} + \\frac{e^{-0.72} - e^{-0.75}}{0.01}$\n使用 $e^{-0.72} \\approx 0.486752$ 和 $e^{-0.75} \\approx 0.472367$,\n$RMST_{T}(12) \\approx \\frac{1-0.618783}{0.16} + \\frac{0.618783-0.486752}{0.04} + \\frac{0.486752-0.472367}{0.01}$\n$\\approx 2.38260 + 3.30078 + 1.4385 \\approx 7.1219$ 个月。\n\n差异为 $RMST_{T}(12) - RMST_{C}(12) \\approx 7.1219 - 8.2638 \\approx -1.1419$ 个月。\n大约-1.14个月的值是正确的。负值表示，在前12个月内，治疗组患者的平均生存时间比对照组患者短约1.14个月，这与早期毒性一致。\n**结论：正确。**\n\n**C. 在 $t = 24$ 个月时的瞬时风险比等于0.5，这个值可以被解释为接受治疗的患者存活时间至少是对照组患者两倍的概率。**\n在 $t=24$ 个月时：\n$h_C(24) = 0.02$ (因为 $24 \\ge 6$)\n$h_T(24) = 0.01$ (因为 $24 \\ge 9$)\n瞬时风险比是 $HR(24) = h_T(24) / h_C(24) = 0.01 / 0.02 = 0.5$。陈述的这一部分在算术上是正确的。\n然而，这种解释是完全错误的。风险是瞬时失效率，而不是概率。风险比是这些率的比值。它不能直接解释为存活时间延长某一倍数的概率。这是对风险比概念的根本误解。\n**结论：错误。**\n\n**D. 在存在早期伤害和晚期获益的非比例风险情况下，单一风险比可能会产生误导。将生存概率 $S_{T}(12)$ 和 $S_{C}(12)$ 与RMST差异一同呈现，可以提高临床可解释性。在此情景下，$S_{T}(12) \\approx 0.472$ 且 $S_{C}(12) \\approx 0.549$。**\n前两句话阐明了报告非比例风险试验结果的最佳实践方法。单一的汇总HR掩盖了治疗效果随时间变化的性质。报告标志性时间点的生存概率（例如，1年时）和RMST差异，提供了一个更丰富、更稳健、更具临床可解释性的总结。\n我们来验证 $S(12)$ 的数值声明。\n对于对照组，$t=12 \\ge 6$，所以我们使用 $S_C(t) = \\exp(-(0.02t + 0.36))$。\n$S_C(12) = \\exp(-(0.02 \\times 12 + 0.36)) = \\exp(-(0.24 + 0.36)) = \\exp(-0.60) \\approx 0.54881$。四舍五入为 $0.549$。\n对于治疗组，$t=12 \\ge 9$，所以我们使用 $S_T(t) = \\exp(-(0.01t + 0.63))$。\n$S_T(12) = \\exp(-(0.01 \\times 12 + 0.63)) = \\exp(-(0.12 + 0.63)) = \\exp(-0.75) \\approx 0.47237$。四舍五入为 $0.472$。\n这个陈述的所有部分都是正确的：原理是合理的，支持的计算是准确的。\n**结论：正确。**\n\n**E. 违背PH假设会使Kaplan-Meier（KM）估计量失效，因此，除非PH假设成立，否则无法对RMST进行非参数估计。**\n这个陈述是根本错误的。Kaplan-Meier估计量用于估计*单个患者组*的生存函数 $S(t)$。其有效性不依赖于组间的任何比较，也不依赖于关于风险函数形状的任何假设（如PH）。人们只需分别为治疗组和对照组计算KM曲线。PH假设仅在使用如对数秩检验或Cox模型等方法比较这两条曲线时才相关。由于KM估计量是有效的，无论PH是否成立，作为KM曲线下面积的RMST都可以进行非参数估计。\n**结论：错误。**",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}