{
    "hands_on_practices": [
        {
            "introduction": "The foundation of analyzing time-to-event data with competing risks lies in correctly accounting for individuals at risk at each moment in time. This first exercise provides a hands-on opportunity to build the nonparametric estimator of the cumulative incidence function (CIF) from the ground up, using a small, raw dataset. By manually constructing the risk table, you will develop a core intuition for how individuals move in and out of risk due to events, censoring, and even complex entry patterns like left truncation, which is essential for correctly applying the Aalen-Johansen estimator .",
            "id": "4987832",
            "problem": "A clinical cohort study follows $n=6$ subjects from the time each subject enters observation until a first failure from one of two mutually exclusive causes (cause $1$ or cause $2$) or independent right censoring. Observation times are measured from a common origin, but subjects may enter late (left truncation). The observed data for each subject $i$ are the entry time $a_i$, the exit time $t_i$, and the event indicator $\\delta_i \\in \\{0,1,2\\}$, where $\\delta_i=0$ denotes right censoring, $\\delta_i=1$ denotes a failure from cause $1$, and $\\delta_i=2$ denotes a failure from cause $2$. The dataset is:\n- Subject $1$: $a_1=0.0$, $t_1=1.8$, $\\delta_1=1$.\n- Subject $2$: $a_2=0.0$, $t_2=2.7$, $\\delta_2=2$.\n- Subject $3$: $a_3=0.0$, $t_3=3.2$, $\\delta_3=0$.\n- Subject $4$: $a_4=2.1$, $t_4=4.0$, $\\delta_4=1$.\n- Subject $5$: $a_5=2.9$, $t_5=5.5$, $\\delta_5=2$.\n- Subject $6$: $a_6=4.2$, $t_6=6.0$, $\\delta_6=0$.\n\nAssume independent censoring, no tied event times, and that the two causes are the only failure types. Starting from fundamental definitions of the cause-specific hazard and the survival function in a competing risks framework, do the following:\n1. Construct the risk table at each distinct event time, listing for each event time $t$ the number at risk just prior to $t$ and the number of events by cause at $t$.\n2. Using the risk table, reason from first principles to compute the Cumulative Incidence Function (CIF) for cause $1$ at time $t=5.0$.\n\nExpress the final probability as a decimal rounded to four significant figures. No percentage signs are permitted; the answer must be unitless and presented as a single number.",
            "solution": "The goal is to compute the Cumulative Incidence Function (CIF) for cause $1$ at time $t=5.0$ in the presence of competing risks. The CIF for cause $k$ at time $t$ is defined as the probability of failing from cause $k$ by time $t$, accounting for the possibility of failure from other causes. In continuous time with competing risks, this probability can be represented via the cause-specific hazard and the overall survival function. For discrete event times, the nonparametric estimator consistent with these definitions is obtained by:\n- Constructing the risk sets at event times,\n- Estimating the overall survival as the product over event times of one minus the total event probability at each time,\n- Accumulating the cause-specific event probabilities weighted by the survival just prior to each event time.\n\nFirst, identify the distinct event times (exclude censoring times). From the data:\n- Event times: $1.8$ (cause $1$), $2.7$ (cause $2$), $4.0$ (cause $1$), $5.5$ (cause $2$).\n- Censoring times: $3.2$, $6.0$.\n\nNext, construct the risk table. For each event time $t$, the number at risk just prior to $t$, denoted $Y(t^{-})$, includes subjects with $a_i \\leq t$ whose exit times exceed or equal $t$ and who have not yet experienced an event or been censored before $t$. The counts $d_{1}(t)$ and $d_{2}(t)$ denote the numbers of events from causes $1$ and $2$ at time $t$.\n\n- At $t=1.8$:\n  - At risk: subjects $1$, $2$, $3$ (since $a_1=a_2=a_3=0.0 \\leq 1.8$, and $t_1=1.8$, $t_2=2.7$, $t_3=3.2 \\geq 1.8$), while subjects $4$, $5$, $6$ have $a_4=2.1$, $a_5=2.9$, $a_6=4.2 > 1.8$.\n  - Therefore, $Y(1.8^{-})=3$.\n  - Events: $\\delta_1=1$ at $t_1=1.8$, so $d_{1}(1.8)=1$, $d_{2}(1.8)=0$.\n\n- At $t=2.7$:\n  - Subject $1$ has failed at $1.8$ and leaves the risk set; subject $3$ is still under observation until $3.2$; subject $4$ has entered by $2.1$ and has not yet failed ($t_4=4.0$); subjects $5$ and $6$ have not entered by $2.7$.\n  - Therefore, at risk: subjects $2$, $3$, $4$, giving $Y(2.7^{-})=3$.\n  - Events: $\\delta_2=2$ at $t_2=2.7$, so $d_{1}(2.7)=0$, $d_{2}(2.7)=1$.\n\n- At $t=4.0$:\n  - Subject $2$ has failed at $2.7$; subject $3$ has been censored at $3.2$ and is no longer at risk; subject $4$ remains at risk until $4.0$; subject $5$ entered at $2.9$ and is at risk at $4.0$; subject $6$ has not yet entered ($a_6=4.2$).\n  - Therefore, at risk: subjects $4$, $5$, giving $Y(4.0^{-})=2$.\n  - Events: $\\delta_4=1$ at $t_4=4.0$, so $d_{1}(4.0)=1$, $d_{2}(4.0)=0$.\n\n- At $t=5.5$:\n  - Subject $4$ failed at $4.0$; subject $5$ remains at risk until $5.5$; subject $6$ has entered at $4.2$ and is at risk at $5.5$.\n  - Therefore, at risk: subjects $5$, $6$, giving $Y(5.5^{-})=2$.\n  - Events: $\\delta_5=2$ at $t_5=5.5$, so $d_{1}(5.5)=0$, $d_{2}(5.5)=1$.\n\nSummarizing the risk table entries needed up to $t=5.0$:\n- $t=1.8$: $Y(1.8^{-})=3$, $d_{1}(1.8)=1$, $d_{2}(1.8)=0$.\n- $t=2.7$: $Y(2.7^{-})=3$, $d_{1}(2.7)=0$, $d_{2}(2.7)=1$.\n- $t=4.0$: $Y(4.0^{-})=2$, $d_{1}(4.0)=1$, $d_{2}(4.0)=0$.\n(The event at $t=5.5$ is beyond $t=5.0$ and does not contribute to the CIF at $t=5.0$.)\n\nFrom first principles, the overall survival function $S(t)$ in the presence of competing risks is the probability of no event of any cause by time $t$. In the nonparametric product-limit framework, at each event time $t_j$ with total events $d(t_j)=d_{1}(t_j)+d_{2}(t_j)$ and risk set size $Y(t_j^{-})$, the estimated conditional survival multiplier is $1 - \\frac{d(t_j)}{Y(t_j^{-})}$. Therefore, the survival just prior to each event time accumulates multiplicatively over previous event times:\n$$\nS(t_j^{-})=\\prod_{t_\\ell < t_j} \\left(1 - \\frac{d(t_\\ell)}{Y(t_\\ell^{-})}\\right).\n$$\nThe cause-$1$ CIF at time $t$ accumulates the cause-$1$ event probability at each event time $t_j \\leq t$, weighted by the survival just prior to $t_j$:\n$$\n\\text{CIF}_{1}(t)=\\sum_{t_j \\leq t} S(t_j^{-}) \\cdot \\frac{d_{1}(t_j)}{Y(t_j^{-})}.\n$$\n\nCompute $S(t_j^{-})$ at the event times up to $t=5.0$:\n- At $t_1=1.8$: there are no prior events, so\n$$\nS(1.8^{-})=1.\n$$\nTotal events at $1.8$ are $d(1.8)=1$, risk set $Y(1.8^{-})=3$, so after $1.8$,\n$$\nS(1.8)=S(1.8^{-})\\left(1 - \\frac{1}{3}\\right)=1 \\cdot \\frac{2}{3}=\\frac{2}{3}.\n$$\n- At $t_2=2.7$: survival just prior to $2.7$ is\n$$\nS(2.7^{-})=S(1.8)=\\frac{2}{3}.\n$$\nTotal events at $2.7$ are $d(2.7)=1$, risk set $Y(2.7^{-})=3$, so after $2.7$,\n$$\nS(2.7)=S(2.7^{-})\\left(1 - \\frac{1}{3}\\right)=\\frac{2}{3} \\cdot \\frac{2}{3}=\\frac{4}{9}.\n$$\n- At $t_3=4.0$: survival just prior to $4.0$ is\n$$\nS(4.0^{-})=S(2.7)=\\frac{4}{9}.\n$$\n\nNow compute the contributions to $\\text{CIF}_{1}(5.0)$ from event times $\\leq 5.0$:\n- At $t=1.8$ (cause $1$ event):\n$$\n\\text{contribution at } 1.8 = S(1.8^{-}) \\cdot \\frac{d_{1}(1.8)}{Y(1.8^{-})} = 1 \\cdot \\frac{1}{3} = \\frac{1}{3}.\n$$\n- At $t=2.7$ (cause $2$ event): $d_{1}(2.7)=0$, so no contribution to cause $1$ CIF.\n- At $t=4.0$ (cause $1$ event):\n$$\n\\text{contribution at } 4.0 = S(4.0^{-}) \\cdot \\frac{d_{1}(4.0)}{Y(4.0^{-})} = \\frac{4}{9} \\cdot \\frac{1}{2} = \\frac{2}{9}.\n$$\n\nTherefore,\n$$\n\\text{CIF}_{1}(5.0) = \\frac{1}{3} + \\frac{2}{9} = \\frac{3}{9} + \\frac{2}{9} = \\frac{5}{9}.\n$$\n\nExpressed as a decimal and rounded to four significant figures,\n$$\n\\frac{5}{9} \\approx 0.5556.\n$$",
            "answer": "$$\\boxed{0.5556}$$"
        },
        {
            "introduction": "After mastering the correct method for estimating the CIF, it is equally important to understand why seemingly simpler alternatives are incorrect. This practice is a critical exercise designed to demonstrate the bias introduced by the common mistake of treating competing events as if they were standard right-censoring . By calculating both the proper CIF and the naive estimate derived from the Kaplan-Meier survival function ($1 - \\widehat{S}_{\\text{KM}}(t)$), you will quantify the resulting overestimation and solidify your understanding of why the CIF is the only valid approach for estimating event probabilities in a competing risks setting.",
            "id": "4987838",
            "problem": "A cohort study in oncology follows $12$ patients from enrollment to either cancer-specific death (event of interest, cause $k=1$), non-cancer death (competing event, cause $k=2$), or administrative censoring. Time is recorded in months. Consider the following dataset, which is constructed to examine the discrepancy between the cumulative incidence of cause $k=1$ and what would be estimated by treating competing events as censored:\n- Patient $1$: time $1$, cause $1$.\n- Patient $2$: time $1$, cause $2$.\n- Patient $3$: time $1$, cause $2$.\n- Patient $4$: time $2$, cause $1$.\n- Patient $5$: time $2$, cause $2$.\n- Patient $6$: time $3$, cause $1$.\n- Patient $7$: time $4$, cause $2$.\n- Patient $8$: time $5$, cause $2$.\n- Patient $9$: time $6$, censored.\n- Patient $10$: time $6$, censored.\n- Patient $11$: time $6$, censored.\n- Patient $12$: time $6$, censored.\n\nUsing only the following foundational principles:\n- The cumulative incidence function for cause $k$ at time $t$, denoted $F_k(t)$, is defined as the probability of failing from cause $k$ by time $t$ in the presence of competing risks.\n- The overall event-free survival function $S(t)$ is the probability of remaining free of any event by time $t$.\n- Estimation at discrete event times proceeds by multiplying survival decrements of the form $1 - d/n$ when there are $d$ events among $n$ at risk, and by summing increments of the form $S(t_{-}) \\times (d_k/n)$ for the cause-specific incidence, where $t_{-}$ denotes the instant just prior to $t$.\n\nCarry out the following, adhering to the standard product-limit convention that events are processed before censored observations when they share the same recorded time:\n1. Compute the nonparametric estimator of the cumulative incidence function for cause $k=1$ at $t=5$, denoted $F_1(5)$, from first principles.\n2. Compute the complement of the Kaplan-Meier (KM) estimator at $t=5$ obtained by treating competing events (cause $k=2$) as right-censoring, that is, compute $1 - \\widehat{S}_{\\text{KM,censor-comp}}(5)$.\n3. Compute the magnitude of overestimation at $t=5$, defined as $\\left[1 - \\widehat{S}_{\\text{KM,censor-comp}}(5)\\right] - F_1(5)$.\n\nExpress your final answer as an exact reduced fraction with no units.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the established principles of survival analysis and competing risks, specifically the estimation of the cumulative incidence function (CIF) and the Kaplan-Meier survival function. The problem is well-posed, providing a complete dataset and explicit definitions for the quantities to be calculated, ensuring a unique and meaningful solution. The language is objective and the setup is consistent.\n\nThe solution requires three calculations:\n1.  The cumulative incidence function for cause $k=1$ at time $t=5$, denoted $F_1(5)$.\n2.  The complement of the Kaplan-Meier estimate at $t=5$ when competing events are treated as censored, $1 - \\widehat{S}_{\\text{KM,censor-comp}}(5)$.\n3.  The difference between these two quantities.\n\nFirst, we organize the data by event times. Let $t_j$ be the $j$-th ordered event time, $n_j$ be the number of individuals at risk just before $t_j$, $d_{1j}$ be the number of events of cause $1$ (cancer-specific death) at $t_j$, and $d_{2j}$ be the number of events of cause $2$ (non-cancer death) at $t_j$. The total number of events at $t_j$ is $d_j = d_{1j} + d_{2j}$. Censored observations are denoted by $c_j$. The distinct event times are $t \\in \\{1, 2, 3, 4, 5\\}$.\n\n**1. Computation of the Cumulative Incidence Function $F_1(5)$**\n\nThe estimator for the cumulative incidence function for cause $k=1$ is given by $\\widehat{F}_1(t) = \\sum_{t_j \\le t} \\widehat{S}(t_{j-1}) \\frac{d_{1j}}{n_j}$, where $\\widehat{S}(t)$ is the overall event-free survival function and $t_{j-1}$ is the time of the previous event. The overall survival is estimated using the product-limit formula: $\\widehat{S}(t) = \\prod_{t_j \\le t} (1 - \\frac{d_j}{n_j})$, with the convention that $\\widehat{S}(0) = 1$.\n\nWe construct a table to track the calculations:\n- At $t_1=1$: $n_1=12$, $d_{11}=1$, $d_{21}=2$, so $d_1=3$.\n  - The increment to $\\widehat{F}_1$ is $\\widehat{S}(0) \\frac{d_{11}}{n_1} = 1 \\times \\frac{1}{12} = \\frac{1}{12}$.\n  - The overall survival at $t=1$ is $\\widehat{S}(1) = \\widehat{S}(0) \\times (1 - \\frac{d_1}{n_1}) = 1 \\times (1 - \\frac{3}{12}) = \\frac{9}{12} = \\frac{3}{4}$.\n- At $t_2=2$: The number at risk is $n_2=12-3=9$. We have $d_{12}=1$ and $d_{22}=1$, so $d_2=2$.\n  - The increment to $\\widehat{F}_1$ is $\\widehat{S}(1) \\frac{d_{12}}{n_2} = \\frac{3}{4} \\times \\frac{1}{9} = \\frac{3}{36} = \\frac{1}{12}$.\n  - The overall survival at $t=2$ is $\\widehat{S}(2) = \\widehat{S}(1) \\times (1 - \\frac{d_2}{n_2}) = \\frac{3}{4} \\times (1 - \\frac{2}{9}) = \\frac{3}{4} \\times \\frac{7}{9} = \\frac{7}{12}$.\n- At $t_3=3$: The number at risk is $n_3=9-2=7$. We have $d_{13}=1$ and $d_{23}=0$, so $d_3=1$.\n  - The increment to $\\widehat{F}_1$ is $\\widehat{S}(2) \\frac{d_{13}}{n_3} = \\frac{7}{12} \\times \\frac{1}{7} = \\frac{7}{84} = \\frac{1}{12}$.\n  - The overall survival at $t=3$ is $\\widehat{S}(3) = \\widehat{S}(2) \\times (1 - \\frac{d_3}{n_3}) = \\frac{7}{12} \\times (1 - \\frac{1}{7}) = \\frac{7}{12} \\times \\frac{6}{7} = \\frac{1}{2}$.\n- At $t_4=4$: The number at risk is $n_4=7-1=6$. We have $d_{14}=0$ and $d_{24}=1$, so $d_4=1$.\n  - The increment to $\\widehat{F}_1$ is $\\widehat{S}(3) \\frac{d_{14}}{n_4} = \\frac{1}{2} \\times \\frac{0}{6} = 0$.\n  - The overall survival at $t=4$ is $\\widehat{S}(4) = \\widehat{S}(3) \\times (1 - \\frac{d_4}{n_4}) = \\frac{1}{2} \\times (1 - \\frac{1}{6}) = \\frac{5}{12}$.\n- At $t_5=5$: The number at risk is $n_5=6-1=5$. We have $d_{15}=0$ and $d_{25}=1$, so $d_5=1$.\n  - The increment to $\\widehat{F}_1$ is $\\widehat{S}(4) \\frac{d_{15}}{n_5} = \\frac{5}{12} \\times \\frac{0}{5} = 0$.\n  - The overall survival at $t=5$ is $\\widehat{S}(5) = \\widehat{S}(4) \\times (1 - \\frac{d_5}{n_5}) = \\frac{5}{12} \\times (1 - \\frac{1}{5}) = \\frac{1}{3}$.\n\nThe cumulative incidence for cause $1$ at $t=5$ is the sum of the increments up to this time:\n$$F_1(5) = \\frac{1}{12} + \\frac{1}{12} + \\frac{1}{12} + 0 + 0 = \\frac{3}{12} = \\frac{1}{4}$$\n\n**2. Computation of $1 - \\widehat{S}_{\\text{KM,censor-comp}}(5)$**\n\nIn this analysis, events of cause $2$ are treated as right-censored. The events of interest are only cause $1$ deaths. The event times for cause $1$ are $t^* \\in \\{1, 2, 3\\}$.\nLet $d_j^*$ be the number of cause $1$ events at time $t_j^*$, and $n_j^*$ be the number at risk.\n- At $t_1^*=1$: $n_1^*=12$, $d_1^*=1$. At this time, $2$ individuals are censored due to cause $2$ events.\n  - $\\widehat{S}_{\\text{KM,censor-comp}}(1) = (1 - \\frac{d_1^*}{n_1^*}) = 1 - \\frac{1}{12} = \\frac{11}{12}$.\n  - The number at risk for the next step is $12 - 1 - 2 = 9$.\n- At $t_2^*=2$: $n_2^*=9$, $d_2^*=1$. At this time, $1$ individual is censored due to a cause $2$ event.\n  - $\\widehat{S}_{\\text{KM,censor-comp}}(2) = \\widehat{S}_{\\text{KM,censor-comp}}(1) \\times (1 - \\frac{d_2^*}{n_2^*}) = \\frac{11}{12} \\times (1 - \\frac{1}{9}) = \\frac{11}{12} \\times \\frac{8}{9} = \\frac{88}{108} = \\frac{22}{27}$.\n  - The number at risk for the next step is $9 - 1 - 1 = 7$.\n- At $t_3^*=3$: $n_3^*=7$, $d_3^*=1$. No other censoring occurs at this time.\n  - $\\widehat{S}_{\\text{KM,censor-comp}}(3) = \\widehat{S}_{\\text{KM,censor-comp}}(2) \\times (1 - \\frac{d_3^*}{n_3^*}) = \\frac{22}{27} \\times (1 - \\frac{1}{7}) = \\frac{22}{27} \\times \\frac{6}{7} = \\frac{132}{189} = \\frac{44}{63}$.\nThe last event of interest (cause $1$) occurred at $t=3$. For $t > 3$, the Kaplan-Meier estimate remains constant until the next event, but there are no further events of interest. Therefore, $\\widehat{S}_{\\text{KM,censor-comp}}(5) = \\widehat{S}_{\\text{KM,censor-comp}}(3) = \\frac{44}{63}$.\nThe complement is:\n$$1 - \\widehat{S}_{\\text{KM,censor-comp}}(5) = 1 - \\frac{44}{63} = \\frac{63-44}{63} = \\frac{19}{63}$$\n\n**3. Computation of the Magnitude of Overestimation**\n\nThe overestimation is the difference between the naive (1-KM) estimate and the correct CIF estimate:\n$$\\text{Overestimation} = \\left[1 - \\widehat{S}_{\\text{KM,censor-comp}}(5)\\right] - F_1(5)$$\n$$\\text{Overestimation} = \\frac{19}{63} - \\frac{1}{4}$$\nTo subtract these fractions, we find a common denominator, which is $\\text{lcm}(63, 4) = 252$.\n$$\\text{Overestimation} = \\frac{19 \\times 4}{63 \\times 4} - \\frac{1 \\times 63}{4 \\times 63} = \\frac{76}{252} - \\frac{63}{252} = \\frac{76 - 63}{252} = \\frac{13}{252}$$\nThe prime factors of the denominator are $252 = 2^2 \\times 3^2 \\times 7$. The numerator is the prime number $13$. Thus, the fraction is irreducible.",
            "answer": "$$\\boxed{\\frac{13}{252}}$$"
        },
        {
            "introduction": "In modern medical statistics, we rarely stop at simple nonparametric estimates; we aim to build models that predict risk based on patient characteristics. This final practice bridges the gap between fundamental CIF estimation and its application in regression modeling, specifically within the cause-specific proportional hazards framework . You will design and implement a numerical algorithm to compute subject-specific CIFs from the outputs of a fitted model, a task central to generating personalized risk predictions. This exercise translates the theoretical definition of the CIF, $F_k(t \\mid X) = \\int_0^t S(u^- \\mid X) dH_k(u \\mid X)$, into a practical computational tool.",
            "id": "4987841",
            "problem": "You are given a competing risks setting with cause-specific proportional hazards models and Breslow estimators of the baseline cumulative hazards. The task is to implement a numerical algorithm that computes the cumulative incidence function on a time grid by integrating the product of the overall survival and the cause-specific hazard, using the Breslow step-function estimates as inputs. Your program must implement this algorithm and evaluate it on a specified test suite.\n\nStart from the following fundamental base:\n- For each cause $k \\in \\{1,\\dots,K\\}$, the cause-specific proportional hazards model specifies the hazard as $h_k(t \\mid X) = h_{0k}(t)\\exp(\\beta_k^\\top X)$ for covariates $X$.\n- The cumulative cause-specific hazard for cause $k$ is $H_k(t \\mid X) = \\int_0^t h_k(u \\mid X)\\,du$.\n- The overall survival is $S(t \\mid X) = \\exp\\!\\left(-\\sum_{m=1}^K H_m(t \\mid X)\\right)$.\n- The cumulative incidence function for cause $k$ is $F_k(t \\mid X) = \\mathbb{P}(T \\le t, \\text{cause}=k \\mid X)$, defined by the Riemann–Stieltjes integral $F_k(t \\mid X) = \\int_0^t S(u^- \\mid X)\\,dH_k(u \\mid X)$.\n- The Breslow estimator of the baseline cumulative hazard for cause $k$ is a right-continuous step function $\\hat H_{0k}(t)$ that increases only at observed event times.\n\nUsing only these foundational definitions, design from first principles a discrete-time algorithm on a grid that:\n- Takes as input a common increasing time grid $\\{t_j\\}_{j=1}^J$ with $t_j \\in \\mathbb{R}_+$, the step-function values $\\{\\hat H_{0k}(t_j)\\}_{j=1}^J$ for each cause $k$, the regression vectors $\\{\\beta_k\\}_{k=1}^K$, and a covariate vector $X$.\n- Uses the Breslow step increments in $\\hat H_{0k}$ to generate the subject-specific hazard increments for each cause $k$, and numerically integrates the product of the left-continuous survival and the cause-specific hazard to compute $\\hat F_k(t \\mid X)$ up to a specified evaluation time $t_{\\text{eval}}$.\n- Assumes that any $t_j > t_{\\text{eval}}$ contributes no increment to the integral.\n- Produces $\\hat F_k(t_{\\text{eval}} \\mid X)$ for each cause $k$.\n\nYour implementation must follow the Riemann–Stieltjes logic for step functions: use the left-continuous survival $S(t_j^- \\mid X)$ multiplied by the jump increment in $H_k$ at $t_j$. You must not assume any continuity beyond the jumps present in the Breslow estimators. All computations should be performed in floating point, and your final answers should be rounded to $10$ decimal places.\n\nTest Suite:\nImplement your algorithm and evaluate it on the following three test cases. In all cases, the time grid is common to all causes within a test case, and the Breslow baseline cumulative hazards are given at those grid times.\n\n- Test Case $1$:\n  - Number of causes $K = 2$.\n  - Covariate dimension $p = 1$ with $X = [\\,1\\,]$.\n  - Time grid $\\bigl[t_1,t_2,t_3\\bigr] = [\\,1,2,3\\,]$.\n  - Breslow baseline cumulative hazards:\n    - Cause $1$: $\\bigl[\\hat H_{01}(t_1), \\hat H_{01}(t_2), \\hat H_{01}(t_3)\\bigr] = [\\,0.1, 0.1, 0.1\\,]$.\n    - Cause $2$: $\\bigl[\\hat H_{02}(t_1), \\hat H_{02}(t_2), \\hat H_{02}(t_3)\\bigr] = [\\,0.0, 0.2, 0.2\\,]$.\n  - Regression vectors:\n    - Cause $1$: $\\beta_1 = [\\,\\log(2)\\,]$.\n    - Cause $2$: $\\beta_2 = [\\,\\log(0.5)\\,]$.\n  - Evaluation time $t_{\\text{eval}} = 3$.\n\n- Test Case $2$:\n  - Number of causes $K = 2$.\n  - Covariate dimension $p = 2$ with $X = [\\,1,0\\,]$.\n  - Time grid $\\bigl[t_1,t_2\\bigr] = [\\,1,2\\,]$.\n  - Breslow baseline cumulative hazards:\n    - Cause $1$: $\\bigl[\\hat H_{01}(t_1), \\hat H_{01}(t_2)\\bigr] = [\\,0.1, 0.3\\,]$.\n    - Cause $2$: $\\bigl[\\hat H_{02}(t_1), \\hat H_{02}(t_2)\\bigr] = [\\,0.0, 0.0\\,]$.\n  - Regression vectors:\n    - Cause $1$: $\\beta_1 = [\\,0, 5\\,]$.\n    - Cause $2$: $\\beta_2 = [\\,\\log(3), -2\\,]$.\n  - Evaluation time $t_{\\text{eval}} = 2$.\n\n- Test Case $3$:\n  - Number of causes $K = 3$.\n  - Covariate dimension $p = 1$ with $X = [\\,1\\,]$.\n  - Time grid $\\bigl[t_1,t_2,t_3\\bigr] = [\\,1,2,3\\,]$.\n  - Breslow baseline cumulative hazards:\n    - Cause $1$: $\\bigl[\\hat H_{01}(t_1), \\hat H_{01}(t_2), \\hat H_{01}(t_3)\\bigr] = [\\,0.05, 0.05, 0.05\\,]$.\n    - Cause $2$: $\\bigl[\\hat H_{02}(t_1), \\hat H_{02}(t_2), \\hat H_{02}(t_3)\\bigr] = [\\,0.0, 0.1, 0.1\\,]$.\n    - Cause $3$: $\\bigl[\\hat H_{03}(t_1), \\hat H_{03}(t_2), \\hat H_{03}(t_3)\\bigr] = [\\,0.0, 0.0, 0.2\\,]$.\n  - Regression vectors:\n    - Cause $1$: $\\beta_1 = [\\,\\log(1.5)\\,]$.\n    - Cause $2$: $\\beta_2 = [\\,0\\,]$.\n    - Cause $3$: $\\beta_3 = [\\,\\log(2)\\,]$.\n  - Evaluation time $t_{\\text{eval}} = 2.5$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The list must be formed by concatenating, for each test case in the given order, the values $\\bigl[\\hat F_1(t_{\\text{eval}}\\mid X), \\hat F_2(t_{\\text{eval}}\\mid X), \\dots, \\hat F_K(t_{\\text{eval}}\\mid X)\\bigr]$.\n- Each value must be rounded to $10$ decimal places.\n- For example, the shape should be $[\\text{TC1 cause 1}, \\text{TC1 cause 2}, \\dots, \\text{TC2 cause 1}, \\dots, \\text{TC3 last cause}]$.\n\nAll answers must be real numbers (decimals), not percentages. No physical units are involved. The program must be fully self-contained and produce the required single-line output without any user input.",
            "solution": "The problem requires the design and implementation of a numerical algorithm to compute the cumulative incidence function (CIF) for each cause in a competing risks setting. The inputs are based on cause-specific proportional hazards models with baseline cumulative hazards estimated by the Breslow method. The solution must be derived from first principles.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Model Specification**: For each cause $k \\in \\{1,\\dots,K\\}$, the cause-specific hazard is $h_k(t \\mid X) = h_{0k}(t)\\exp(\\beta_k^\\top X)$.\n- **Cumulative Hazard**: The cumulative cause-specific hazard is $H_k(t \\mid X) = \\int_0^t h_k(u \\mid X)\\,du$.\n- **Overall Survival**: The overall survival function is $S(t \\mid X) = \\exp\\!\\left(-\\sum_{m=1}^K H_m(t \\mid X)\\right)$.\n- **Cumulative Incidence Function (CIF)**: The CIF for cause $k$ is $F_k(t \\mid X) = \\mathbb{P}(T \\le t, \\text{cause}=k \\mid X)$, defined by the Riemann–Stieltjes integral $F_k(t \\mid X) = \\int_0^t S(u^- \\mid X)\\,dH_k(u \\mid X)$.\n- **Estimator**: The Breslow estimator for the baseline cumulative hazard, $\\hat H_{0k}(t)$, is a right-continuous step function that increases only at observed event times.\n- **Inputs**: A common increasing time grid $\\{t_j\\}_{j=1}^J$, step-function values $\\{\\hat H_{0k}(t_j)\\}_{j=1}^J$ for each cause $k$, regression vectors $\\{\\beta_k\\}_{k=1}^K$, a covariate vector $X$.\n- **Task**: Compute $\\hat F_k(t_{\\text{eval}} \\mid X)$ for each cause $k$, up to a specified evaluation time $t_{\\text{eval}}$.\n- **Algorithm Constraint**: The numerical integration must use the left-continuous survival $S(t_j^- \\mid X)$ multiplied by the jump increment in $H_k$ at $t_j$. Increments at times $t_j > t_{\\text{eval}}$ are zero.\n- **Test Suite**: Three specific test cases are provided with all necessary numerical inputs.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is firmly rooted in the theory of survival analysis and competing risks, which are standard topics in biostatistics and medical statistics. All provided formulas for the hazard, survival, and CIF are standard and correct. The Breslow estimator is a widely used non-parametric estimator for the cumulative baseline hazard.\n- **Well-Posed**: The problem is well-defined. It provides a clear objective (compute the CIF), a complete set of inputs for each test case, and a specific definition of the quantity to be computed via a Riemann-Stieltjes integral. The instruction to discretize this integral using the properties of the Breslow step-function estimator provides a clear path to a unique numerical solution.\n- **Objective**: The problem is stated in precise, mathematical language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is scientifically sound, well-posed, and objective. There are no contradictions, missing information, or other flaws. A solution can be derived and implemented as requested.\n\n### Algorithmic Derivation from First Principles\n\nThe objective is to compute the estimator for the cumulative incidence function, $\\hat F_k(t \\mid X)$, for a specific cause $k$ and covariate vector $X$ at time $t = t_{\\text{eval}}$. The fundamental definition is the Riemann-Stieltjes integral:\n$$ \\hat F_k(t_{\\text{eval}} \\mid X) = \\int_0^{t_{\\text{eval}}} \\hat S(u^- \\mid X)\\,d\\hat H_k(u \\mid X) $$\nHere, the hats ( $\\hat{\\cdot}$ ) denote that we are working with estimated quantities derived from the data. Specifically, we are given the Breslow estimator for the baseline cumulative hazard, $\\hat H_{0k}(t)$.\n\nFrom the proportional hazards model, the estimated subject-specific cumulative hazard for cause $k$ is:\n$$ \\hat H_k(t \\mid X) = \\hat H_{0k}(t) \\cdot \\exp(\\beta_k^\\top X) $$\nSince the Breslow estimator $\\hat H_{0k}(t)$ is a right-continuous step function, the subject-specific cumulative hazard $\\hat H_k(t \\mid X)$ is also a right-continuous step function. Such a function only increases at a discrete set of time points, which are given by the time grid $\\{t_j\\}_{j=1}^J$.\n\nA Riemann-Stieltjes integral with a step function as the integrator simplifies to a sum over the jumps of the integrator. Let $\\Delta \\hat H_k(t_j \\mid X)$ be the jump in $\\hat H_k(t \\mid X)$ at time $t_j$. The integral becomes:\n$$ \\hat F_k(t_{\\text{eval}} \\mid X) = \\sum_{j: t_j \\le t_{\\text{eval}}} \\hat S(t_j^- \\mid X) \\cdot \\Delta \\hat H_k(t_j \\mid X) $$\nThe term $\\hat S(u^- \\mid X)$ is the left-continuous version of the overall survival function.\n\nThe algorithm proceeds by summing these contributions over the time grid. Let us define the necessary components for a discrete-time computation on the grid $\\{t_j\\}_{j=1}^J$. To handle the interval from $0$ to $t_1$, we augment the grid with $t_0 = 0$, at which all cumulative hazards are zero, i.e., $\\hat H_{0k}(t_0) = 0$ for all $k$. The time grid becomes $\\{t_0, t_1, \\dots, t_J\\}$.\n\n1.  **Jump in Cumulative Hazard**: The jump in the baseline cumulative hazard for cause $k$ at time $t_j$ is the difference between its value at $t_j$ and its value just before $t_j$. Since $\\hat H_{0k}(t)$ is a step function with jumps at the $t_j$, the value just before $t_j$ is $\\hat H_{0k}(t_{j-1})$.\n    $$ \\Delta \\hat H_{0k}(t_j) = \\hat H_{0k}(t_j) - \\hat H_{0k}(t_{j-1}) \\quad (\\text{for } j \\ge 1) $$\n    The jump in the subject-specific cumulative hazard is then:\n    $$ \\Delta \\hat H_k(t_j \\mid X) = \\Delta \\hat H_{0k}(t_j) \\cdot \\exp(\\beta_k^\\top X) $$\n\n2.  **Left-Continuous Survival**: The term $\\hat S(t_j^- \\mid X)$ is the value of the survival function immediately before the jump at $t_j$. Since the cumulative hazards are right-continuous, the survival function $\\hat S(t \\mid X)$ is also right-continuous. The value at $t_j^-$ is determined by the cumulative hazard accumulated up to, and including, the previous time point $t_{j-1}$.\n    The overall cumulative hazard at time $t_{j-1}$ is:\n    $$ \\hat H_{\\text{all}}(t_{j-1} \\mid X) = \\sum_{m=1}^K \\hat H_m(t_{j-1} \\mid X) = \\sum_{m=1}^K \\hat H_{0m}(t_{j-1}) \\cdot \\exp(\\beta_m^\\top X) $$\n    Therefore, the left-continuous survival at $t_j$ is:\n    $$ \\hat S(t_j^- \\mid X) = \\hat S(t_{j-1} \\mid X) = \\exp\\left( - \\hat H_{\\text{all}}(t_{j-1} \\mid X) \\right) $$\n    Note that at the first step ($j=1$), $\\hat S(t_1^- \\mid X) = \\hat S(t_0 \\mid X) = \\exp(-\\hat H_{\\text{all}}(t_0 \\mid X)) = \\exp(0) = 1$.\n\n3.  **Iterative Computation**: We can compute $\\hat F_k(t_{\\text{eval}} \\mid X)$ by initializing it to $0$ and iteratively adding the increments for each time point $t_j \\le t_{\\text{eval}}$.\n\nThe discrete-time algorithm is as follows:\nInitialize $\\hat F_k \\leftarrow 0$ for $k=1, \\dots, K$.\nDefine an augmented time grid with $t_0=0$ and $\\hat H_{0k}(t_0)=0$ for all $k$.\nFor $j = 1, 2, \\dots, J$:\n1.  If $t_j > t_{\\text{eval}}$, terminate the loop.\n2.  Calculate the left-continuous survival probability at $t_j$:\n    $ \\hat S(t_j^- \\mid X) = \\exp\\left( -\\sum_{m=1}^K \\hat H_{0m}(t_{j-1}) \\cdot \\exp(\\beta_m^\\top X) \\right) $.\n3.  For each cause $k = 1, \\dots, K$:\n    a. Calculate the jump in the baseline cumulative hazard:\n       $\\Delta \\hat H_{0k}(t_j) = \\hat H_{0k}(t_j) - \\hat H_{0k}(t_{j-1})$.\n    b. Calculate the jump in the subject-specific cumulative hazard:\n       $\\Delta \\hat H_k(t_j \\mid X) = \\Delta \\hat H_{0k}(t_j) \\cdot \\exp(\\beta_k^\\top X)$.\n    c. Calculate the CIF increment:\n       $\\text{increment}_k = \\hat S(t_j^- \\mid X) \\cdot \\Delta \\hat H_k(t_j \\mid X)$.\n    d. Update the CIF:\n       $\\hat F_k \\leftarrow \\hat F_k + \\text{increment}_k$.\n\nAfter iterating through all relevant time points, the final values of $\\hat F_k$ are the required results, $\\hat F_k(t_{\\text{eval}} \\mid X)$. This procedure correctly implements the numerical integration of the Riemann-Stieltjes integral for step functions as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculation of CIF for all test cases and print the final results.\n    \"\"\"\n    test_cases = [\n        {\n            \"K\": 2, \"p\": 1, \"X\": np.array([1.0]),\n            \"time_grid\": np.array([1.0, 2.0, 3.0]),\n            \"H0_values\": [\n                np.array([0.1, 0.1, 0.1]),  # Cause 1\n                np.array([0.0, 0.2, 0.2])   # Cause 2\n            ],\n            \"betas\": [\n                np.array([np.log(2.0)]),    # Cause 1\n                np.array([np.log(0.5)])     # Cause 2\n            ],\n            \"t_eval\": 3.0\n        },\n        {\n            \"K\": 2, \"p\": 2, \"X\": np.array([1.0, 0.0]),\n            \"time_grid\": np.array([1.0, 2.0]),\n            \"H0_values\": [\n                np.array([0.1, 0.3]),      # Cause 1\n                np.array([0.0, 0.0])       # Cause 2\n            ],\n            \"betas\": [\n                np.array([0.0, 5.0]),             # Cause 1\n                np.array([np.log(3.0), -2.0])     # Cause 2\n            ],\n            \"t_eval\": 2.0\n        },\n        {\n            \"K\": 3, \"p\": 1, \"X\": np.array([1.0]),\n            \"time_grid\": np.array([1.0, 2.0, 3.0]),\n            \"H0_values\": [\n                np.array([0.05, 0.05, 0.05]), # Cause 1\n                np.array([0.0, 0.1, 0.1]),   # Cause 2\n                np.array([0.0, 0.0, 0.2])    # Cause 3\n            ],\n            \"betas\": [\n                np.array([np.log(1.5)]),    # Cause 1\n                np.array([0.0]),            # Cause 2\n                np.array([np.log(2.0)])     # Cause 3\n            ],\n            \"t_eval\": 2.5\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        case_results = calculate_cif(case)\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.10f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_cif(case):\n    \"\"\"\n    Computes the cumulative incidence functions for a single test case.\n\n    Args:\n        case (dict): A dictionary containing all parameters for one test case.\n\n    Returns:\n        list: A list of the computed CIF values for each cause at t_eval.\n    \"\"\"\n    K = case[\"K\"]\n    X = case[\"X\"]\n    time_grid = case[\"time_grid\"]\n    H0_values = case[\"H0_values\"]\n    betas = case[\"betas\"]\n    t_eval = case[\"t_eval\"]\n\n    # Augment the time grid and baseline cumulative hazards with a point at t=0\n    # where H0(0) = 0 for all causes.\n    aug_time = np.insert(time_grid, 0, 0.0)\n    aug_H0_values = [np.insert(h, 0, 0.0) for h in H0_values]\n\n    # Pre-calculate the risk scores exp(beta_k^T * X) for each cause k.\n    risk_scores = [np.exp(np.dot(b, X)) for b in betas]\n\n    # Initialize the CIFs for all K causes to zero.\n    cifs = np.zeros(K)\n\n    # Iterate over the time grid points to sum the increments to the CIFs.\n    # The loop starts from j=1 to access t_j and t_{j-1}.\n    for j in range(1, len(aug_time)):\n        t_j = aug_time[j]\n\n        # Per the problem statement, time points after t_eval contribute no increment.\n        if t_j > t_eval:\n            break\n\n        # Calculate the overall cumulative hazard at the a time t_{j-1}\n        # to find the left-continuous survival S(t_j^-).\n        H_all_prev = 0.0\n        for k in range(K):\n            H0_k_prev_time = aug_H0_values[k][j-1]\n            H_all_prev += H0_k_prev_time * risk_scores[k]\n        \n        S_left_continuous = np.exp(-H_all_prev)\n\n        # For each cause, calculate the increment to its CIF and add it.\n        for k in range(K):\n            # Calculate the jump in the baseline cumulative hazard at t_j.\n            delta_H0k = aug_H0_values[k][j] - aug_H0_values[k][j-1]\n\n            # Calculate the jump in the subject-specific cumulative hazard.\n            delta_Hk = delta_H0k * risk_scores[k]\n\n            # Calculate the CIF increment and update the total.\n            increment = S_left_continuous * delta_Hk\n            cifs[k] += increment\n            \n    return cifs.tolist()\n\nsolve()\n```"
        }
    ]
}