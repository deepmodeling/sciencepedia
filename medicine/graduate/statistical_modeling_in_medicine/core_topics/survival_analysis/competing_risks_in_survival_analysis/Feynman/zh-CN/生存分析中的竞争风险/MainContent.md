## 引言
在经典的[生存分析](@entry_id:264012)中，我们关注的是单个事件“何时”发生。然而，现实世界要复杂得多，个体往往面临多种可能的结局，它们相互“竞争”，决定了最终的命运。例如，患者可能死于心脏病，也可能死于癌症；一项新技术可能被市场广泛接纳，也可能被竞争对手淘汰。这种存在多个互斥终点事件的情景，就是“[竞争风险](@entry_id:173277)”分析的核心领域。面对这种复杂性，一个常见但极其危险的诱惑是将我们不关心的事件当作普通[删失数据](@entry_id:173222)处理。这种简化会引入严重的系统性偏差，导致对风险的错误评估和潜在的误导性结论。

为了装备您应对这一挑战，本文将系统地剖析[竞争风险分析](@entry_id:634319)的理论与实践。在**“原理与机制”**一章中，我们将从第一性原理出发，厘清原因别定[风险率](@entry_id:266388)（CSH）和[累积发生率函数](@entry_id:904847)（CIF）等核心概念，并深入比较两种主流建模方法——原因别定风险模型与[亚分布风险模型](@entry_id:893400)的哲学与实践差异。接着，在**“应用与[交叉](@entry_id:147634)学科联系”**一章，我们将探索这些模型如何在临床医学、[公共卫生](@entry_id:273864)、金融乃至人工智能等前沿领域解决实际问题。最后，**“动手实践”**部分将通过具体的练习，巩固您对关键理论的理解。本文旨在为您提供一幅关于[竞争风险分析](@entry_id:634319)的清晰路[线图](@entry_id:264599)，让您不仅能理解其数学之美，更能掌握其作为强大分析工具的精髓。让我们从最基本的原理开始，解开这团交织的命运之线。

## 原理与机制

在[生存分析](@entry_id:264012)的迷人世界里，我们试图预测“何时”会发生某个事件。但现实往往更为复杂，我们还必须面对“会发生哪个事件”的问题。当多种结局相互竞争，共同争夺一个个体的最终命运时，我们就进入了[竞争风险](@entry_id:173277)（Competing Risks）的领域。想象一位心脏病患者，他可能死于心脏病发作，也可能死于癌症，或者在研究结束前因为搬家而失访。心脏病死亡和癌症死亡就是“竞争事件”，而失访则是一种“删失”，意味着我们停止了观察。要解开这团交织的命运之线，我们需要一套独特而深刻的原理。

### 我们能观察到什么？率、风险与多态模型

让我们像物理学家一样，从最基本的可观测量出发。在一个[竞争风险](@entry_id:173277)研究中，对于每个个体，我们能记录下的只有两件事：事件发生或观察停止的**时间** $T$，以及发生的具体**事件类型** $\Delta$（比如 $\Delta=1$ 代表心脏病死亡，$\Delta=2$ 代表癌症死亡，$\Delta=0$ 代表删失）。这组数据 $(T, \Delta)$ 是我们认识这个[随机过程](@entry_id:159502)的唯一窗口 。

基于这些[可观测量](@entry_id:267133)，我们可以定义两个核心概念，它们是从两个不同维度来描述风险：

1.  **原因别定风险率 (Cause-Specific Hazard, CSH)**，记为 $\lambda_k(t)$。它回答了这样一个问题：“在 $t$ 时刻，对于所有仍然‘在场’（即尚未经历任何事件且未被删失）的个体，他们因第 $k$ 种原因发生事件的[瞬时速率](@entry_id:182981)是多少？”这就像是在测量特定死因在特定时刻对幸存者群体的“作用力”大小。其严格定义为：
    $$ \lambda_k(t) = \lim_{h\downarrow 0}\frac{\mathbb{P}(T \in [t, t+h), \Delta=k \mid T \ge t)}{h} $$
    这里的条件 $T \ge t$ 至关重要，它定义了计算[风险率](@entry_id:266388)的“[风险集](@entry_id:917426)”——只有那些在 $t$ 时刻仍然存活且未失访的个体 。

2.  **[累积发生率函数](@entry_id:904847) (Cumulative Incidence Function, CIF)**，记为 $F_k(t)$。它回答了一个更实际的问题：“从开始到 $t$ 时刻，一个随机个体因第 $k$ 种原因发生事件的累积概率是多少？”这直接对应于临床上常说的“[绝对风险](@entry_id:897826)”（Absolute Risk）。其定义为：
    $$ F_k(t) = \mathbb{P}(T \le t, \Delta=k) $$
    这个概率捕捉了在现实世界中（即所有风险并存的情况下），到特定时间点，结局 $k$ 实际发生了多少 。

$\lambda_k(t)$ 是一个[瞬时速率](@entry_id:182981)（rate），而 $F_k(t)$ 是一个累积概率（probability）。它们从不同角度描述了同一过程，就像速度和位移的关系一样。那么，连接它们的桥梁是什么呢？

### 连接瞬时率与累积风险的优美桥梁

想象在时间 $t$ 的一个微小瞬间 $du$，因原因 $k$ 而发生事件的概率是什么？这取决于两个因素：首先，个体必须“存活”到 $u$ 时刻，没有因任何原因出局，这个概率是**总生存概率** $S(u) = \mathbb{P}(T > u)$；其次，在这个瞬间，原因 $k$ 的“作用力”——原因别定风险率 $\lambda_k(u)$——作用于该个体。因此，在这个微小瞬间 $du$ 内因原因 $k$ 发生事件的概率就是 $S(u) \lambda_k(u) du$。

将这些微小的概率从 0 时刻累加到 $t$ 时刻，我们就得到了[累积发生率函数](@entry_id:904847)：
$$ F_k(t) = \int_{0}^{t} S(u) \lambda_k(u) du $$
这个积分公式是[竞争风险分析](@entry_id:634319)的基石 。它优美地揭示了竞争的本质：第 $k$ 种事件的累积风险 $F_k(t)$，不仅取决于其自身的[风险率](@entry_id:266388) $\lambda_k(t)$，还通过总[生存函数](@entry_id:267383) $S(t)$，深刻地依赖于**所有其他竞争事件**的[风险率](@entry_id:266388)。总[生存函数](@entry_id:267383) $S(t)$ 是由所有原因的总风险率 $\lambda_{total}(t) = \sum_j \lambda_j(t)$ 决定的：
$$ S(t) = \exp\left(-\int_0^t \sum_j \lambda_j(u) du\right) $$
如果一个竞争事件（比如癌症）的风险率很高，它会导致 $S(t)$ 迅速下降，从而使得留给心脏病（原因 $k=1$）发生作用的机会窗口变小，最终降低心脏病的累积发生率 $F_1(t)$。这就像在一场比赛中，即使你是最快的选手，但如果许多其他选手抄近道提前到达终点（竞争事件），你赢得比赛的实际可能性也会降低。

### 一个常见的误区：将[竞争风险](@entry_id:173277)视为删失的诱惑

面对竞争事件，一个看似自然且简单的想法是：“我只关心心脏病死亡，那么对于那些死于癌症的患者，我能否就把他们当作在癌症死亡那一刻‘删失’掉，然后用标准的 [Kaplan-Meier](@entry_id:169317) 方法来分析？”

这是一个极其危险的误区，但它能帮助我们更深刻地理解[竞争风险](@entry_id:173277)的本质。当我们把竞争事件当作删失处理时，我们所估计的不再是现实世界中的“[绝对风险](@entry_id:897826)”（即 CIF），而是一个被称为**“净风险”（Net Risk）**的理论量。这相当于在问：“在一个**假想世界**里，如果所有其他[竞争风险](@entry_id:173277)都被奇迹般地消除了，那么因我们关心的那个原因发生事件的概率是多少？”

这种方法为什么会出错？让我们再次回到瞬时增量的视角 。正确的 CIF 估计，其在每个事件时刻的增量，来源于**仅该原因**的事件数 $dN_k(t)$。而 [Kaplan-Meier](@entry_id:169317) 方法的增量，来源于**所有**被视为“事件”的计数 $dN(t)$。当我们将竞争事件错误地视为删失时，我们实际上是在估计 $1-S_{KM}(t)$，其增量来源于我们关心的事件，而其他事件（我们本应视为竞争的）则被错误地从[风险集](@entry_id:917426)中移除，但不计入事件总数。这种方法实际上是在试图估计一个不存在[竞争风险](@entry_id:173277)的世界中的[生存曲线](@entry_id:924638)。

一个具体的例子能让这一点更清晰 。假设在一个研究中，疾病（D）的年风险率 $\lambda_D$ 恒为 $0.04$，而竞争事件（C）的年[风险率](@entry_id:266388) $\lambda_C$ 恒为 $0.06$。
- **正确的5年[绝对风险](@entry_id:897826) (CIF)** 是：$F_D(5) = \int_0^5 \lambda_D S(t) dt = \frac{\lambda_D}{\lambda_D+\lambda_C}(1 - \exp(-(\lambda_D+\lambda_C) \cdot 5)) = \frac{0.04}{0.10}(1 - \exp(-0.5)) \approx 0.157$。
- **错误的5年“净风险”** (通过1-KM方法估计) 是：$1 - \exp(-\lambda_D \cdot 5) = 1 - \exp(-0.2) \approx 0.181$。

$0.181$ 远大于 $0.157$！这种高估是系统性的，因为它忽略了竞争事件会“带走”一部分本可能经历目标事件的个体，从而减少了目标事件的发生机会。

### 两种看待世界的方式：建模的哲学

当引入协变量（如治疗手段、基因型）时，我们希望评估这些因素对事件风险的影响。在[竞争风险](@entry_id:173277)框架下，主要有两种建模哲学，它们对应着两种看待世界的不同方式。

#### 方法一：对“率”建模（原因别定风险模型）

这是最直接的方法。我们对每个原因的瞬时[风险率](@entry_id:266388) $\lambda_k(t)$ 分别建立模型，最常用的是 Cox [比例风险模型](@entry_id:921975)：
$$ \lambda_k(t|X) = \lambda_{0k}(t) \exp(\beta_k X) $$
这里的[风险集](@entry_id:917426) $R^{\mathrm{CS}}(t)$ 非常直观：它只包含在 $t$ 时刻仍然存活且未被删失的个体。一旦某人因任何原因死亡或失访，他就会被永久地移出[风险集](@entry_id:917426) 。

模型中的系数 $\exp(\beta_k)$ 有着清晰的解释：它是**瞬时[风险比](@entry_id:173429)（Hazard Ratio, HR）**。例如，如果治疗组 $X=1$ 相对于对照组 $X=0$ 的 $\exp(\beta_1)=0.7$，这意味着在任何时刻 $t$，对于当时仍然存活的患者群体，治疗能使他们因原因1死亡的[瞬时速率](@entry_id:182981)降低30% 。

然而，这里有一个巨大的陷阱！瞬时风险率降低30%，是否意味着5年内的累积风险（CIF）也降低30%呢？**答案是否定的**。回顾我们的积分公式 $F_k(t) = \int S(u) \lambda_k(u) du$。[协变](@entry_id:634097)量 $X$ 不仅通过 $\lambda_k(u|X)$ 影响被积函数，它还可能通过影响其他竞争事件的风险率 $\lambda_j(u|X)$，进而改变总[生存函数](@entry_id:267383) $S(u|X)$，从而以一种复杂、[非线性](@entry_id:637147)的方式影响最终的累积风险 $F_k(t)$。一个药物可能极大地降低了心脏病死亡的**瞬时[风险率](@entry_id:266388)**，但如果它对癌症[死亡率](@entry_id:904968)毫无影响甚至有轻微提升，那么最终它对心脏病**累积发生率**的改善效果可能会大打[折扣](@entry_id:139170) 。

#### 方法二：直接对“累积风险”建模（[亚分布风险模型](@entry_id:893400)）

如果我们最关心的是协变量对“[绝对风险](@entry_id:897826)”（CIF）的直接影响，那么原因别定风险模型似乎有些绕。Fine 和 Gray 提出了一种天才的替代方案——[亚分布风险模型](@entry_id:893400) (Subdistribution Hazard Model)。

这种方法的精妙之处在于它重新定义了“[风险集](@entry_id:917426)”。为了直接模拟 $F_k(t)$，我们需要一个与之对应的“[危险率](@entry_id:266388)”。标准的危险率-[生存函数](@entry_id:267383)关系是 $\lambda(t) = f(t)/S(t)$。对于 CIF，其密度是 $f_k(t) = dF_k(t)/dt$，而对应的“[生存函数](@entry_id:267383)”是 $1 - F_k(t)$。因此，一个“合适的”[危险率](@entry_id:266388)应该是 $\tilde{\lambda}_k(t) = \frac{dF_k(t)/dt}{1-F_k(t)}$。

为了让这个[危险率](@entry_id:266388)能从数据中估计出来，Fine 和 Gray 构建了一个看似怪异的[风险集](@entry_id:917426) $R^{\mathrm{SD}}(t)$ ：
- 对于我们关心的事件 $k=1$，它的亚[分布](@entry_id:182848)[风险集](@entry_id:917426)在 $t$ 时刻包含两类人：
    1.  所有在 $t$ 时刻仍然存活且未删失的个体。
    2.  所有在 $t$ 时刻之前**已经因竞争事件（如 $k=2$）死亡的个体**！

没错，死于竞争事件的人在亚[分布](@entry_id:182848)的[风险集](@entry_id:917426)中被视为“不朽的幽灵”，永远留在了分母中。为什么要这么做？因为 $1-F_1(t)$ 这个量，即“尚未因原因1死亡的概率”，其对应的群体就包括了“还活着的人”和“已经因其他原因死了的人”。通过这种巧妙的[风险集](@entry_id:917426)构建，我们定义的**亚[分布](@entry_id:182848)[风险率](@entry_id:266388) (Subdistribution Hazard, SDH)** $\tilde{\lambda}_1(t)$ 就与 $F_1(t)$ 建立了直接而简单的关系 ：
$$ F_1(t) = 1 - \exp\left(-\int_0^t \tilde{\lambda}_1(u) du\right) $$
这完美地恢复了标准[生存分析](@entry_id:264012)中[危险率](@entry_id:266388)与事件概率之间的简洁形式！

现在，如果我们建立一个关于亚[分布](@entry_id:182848)风险率的[比例风险模型](@entry_id:921975) $\tilde{\lambda}_1(t|X) = \tilde{\lambda}_{01}(t) \exp(\gamma X)$，那么系数 $\exp(\gamma)$ 就有了更直接的意义。它虽然不是一个恒定的 CIF 比值，但它意味着两组的 CIF 之间存在一个固定的、由 $\exp(\gamma)$ 决定的函数关系 ：
$$ 1 - F_1(t|X=1) = [1 - F_1(t|X=0)]^{\exp(\gamma)} $$
这个公式告诉我们，一旦知道了对照组的累积发生率曲线，我们就可以通过 $\gamma$ 直接计算出处理组的整条曲线。这使得[亚分布风险模型](@entry_id:893400)在预测[绝对风险](@entry_id:897826)和评估[公共卫生](@entry_id:273864)影响方面非常强大。

### 尾声：我们究竟能知道什么？（可识别性问题）

在这次旅程的最后，让我们思考一个更深层次的哲学问题：通过观察现实世界的数据 $(T, \Delta)$，我们知识的边界在哪里？

一个惊人而深刻的结论是：只要我们做出了标准的“非[信息性删失](@entry_id:903061)”假设（即删失的发生与未来的事件风险无关），我们就可以从数据中唯一地、无偏地估计出整个系统的**原因别定风险率** $\lambda_k(t)$ 和**累积发生率** $F_k(t)$。这些量是**可识别的 (identifiable)**，因为它们完全是基于可观测量的[分布](@entry_id:182848)来定义的 。

然而，我们永远无法仅从这些数据中得知**潜在的（latent）**[随机过程](@entry_id:159502)是怎样的。我们能否知道，在没有其他风险的理想世界里，一个人的“潜在心脏病死亡时间”和他的“潜在癌症死亡时间”是否相关？比如，拥有某种基因的人是否同时对两种疾病都更易感（正相关）？或者对一种病更易感而对另一种更有抵抗力（负相关）？

答案是，我们**永远无法知道**。Tsiatis 在1975年证明了一个基本定理：存在无穷多个具有不同潜在依赖结构（例如，潜在时间独立、正相关、负相关）的理论模型，它们可以生成完全相同的可观测数据[分布](@entry_id:182848)，也就是完全相同的 $\lambda_k(t)$ 和 $F_k(t)$ 集合。既然我们无法从观测上区分这些理论模型，那么潜在的依赖结构就是**不可识别的 (non-identifiable)**。

这是一个关于科学谦逊的深刻教训。[竞争风险分析](@entry_id:634319)教会我们，要严格区分我们可以从数据中学习到的东西（可识别的量，如 CSH 和 CIF），和那些依赖于无法检验的、关于“潜在世界”的额外假设才能得到的东西。我们的模型和结论，必须牢牢地建立在可观测世界的基础之上。