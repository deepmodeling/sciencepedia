{
    "hands_on_practices": [
        {
            "introduction": "统计建模的一个主要目标是做出具体的预测。对于加速失效时间（AFT）模型而言，这意味着将模型的参数转化为可量化的生存时间度量。本练习将指导您推导对数正态和对数逻辑斯谛AFT模型的预测中位生存时间和四分位距（IQR），从而加深您对模型结构与其在患者预后方面的实际意义之间直接联系的理解。",
            "id": "4772574",
            "problem": "一位生物统计学家正在使用加速失效时间（AFT）模型分析事件发生时间结果。令 $T$ 表示一个正的生存时间，$\\mathbf{x} \\in \\mathbb{R}^{p}$ 表示一个固定的协变量向量，其线性预测变量为 $\\mathbf{x}^{\\top}\\boldsymbol{\\beta}$。AFT模型由以下对数线性表示法指定：\n$$\n\\log T \\mid \\mathbf{x} \\;=\\; \\mathbf{x}^{\\top}\\boldsymbol{\\beta} \\;+\\; \\varepsilon,\n$$\n其中 $\\varepsilon$ 与 $\\mathbf{x}$ 无关，并遵循基线误差分布。考虑 $\\varepsilon$ 的两种基线设定：\n\n1. 对数正态AFT：$\\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2})$，其中 $\\sigma>0$。\n2. 对数逻辑斯谛AFT：$\\varepsilon \\sim \\text{Logistic}(0,s)$，位置参数为 $0$，尺度参数为 $s>0$，累积分布函数为 $F_{\\varepsilon}(u)=\\left(1+\\exp\\!\\left(-u/s\\right)\\right)^{-1}$。\n\n对于每种基线设定，推导 $T\\mid \\mathbf{x}$ 的中位数和四分位距（IQR），将其表示为 $\\mathbf{x}^{\\top}\\boldsymbol{\\beta}$ 和相应基线参数（对数正态模型为 $\\sigma$，对数逻辑斯谛模型为 $s$）的显式函数。请用闭合形式表达您的答案，仅使用标准函数和常数（例如，您可以使用 $\\Phi^{-1}$ 表示标准正态分布的分位数函数，用 $\\ln$ 表示自然对数）。请按以下顺序提供您的最终结果，共四个表达式：对数正态中位数、对数正态IQR、对数逻辑斯谛中位数、对数逻辑斯谛IQR。请勿对答案进行四舍五入。",
            "solution": "该问题是有效的，因为它提法明确，科学上基于已建立的统计理论（加速失效时间模型），并以客观、正式的语言呈现。所有必要信息均已提供，且无矛盾之处。\n\n加速失效时间（AFT）模型由生存时间 $T$、协变量向量 $\\mathbf{x}$ 和误差项 $\\varepsilon$ 之间的对数线性关系定义：\n$$\n\\log T = \\mathbf{x}^{\\top}\\boldsymbol{\\beta} + \\varepsilon\n$$\n其中 $\\varepsilon$ 与 $\\mathbf{x}$ 无关，并遵循一个特定的基线误差分布。该方程意味着生存时间 $T$ 可以表示为：\n$$\nT = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta} + \\varepsilon) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\exp(\\varepsilon)\n$$\n为了求出给定 $\\mathbf{x}$ 时 $T$ 的分位数，我们可以先求出 $\\log T$ 的分位数。令 $q_p(V)$ 表示随机变量 $V$ 的第 $p$ 分位数，其中 $p \\in (0, 1)$。由于 $\\mathbf{x}^{\\top}\\boldsymbol{\\beta}$ 相对于 $\\varepsilon$ 的分布是一个常数，$\\log T$ 的第 $p$ 分位数为：\n$$\nq_p(\\log T) = \\mathbf{x}^{\\top}\\boldsymbol{\\beta} + q_p(\\varepsilon)\n$$\n指数函数是严格单调的，因此 $T$ 的分位数可以通过对 $\\log T$ 的分位数取指数得到：\n$$\nq_p(T) = \\exp(q_p(\\log T)) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta} + q_p(\\varepsilon)) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\exp(q_p(\\varepsilon))\n$$\n中位数是 $p=0.5$ 的分位数，即 $q_{0.5}(T)$。四分位距（IQR）是第三四分位数（$p=0.75$）与第一四分位数（$p=0.25$）之差：\n$$\n\\text{IQR}(T) = q_{0.75}(T) - q_{0.25}(T) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\left(\\exp(q_{0.75}(\\varepsilon)) - \\exp(q_{0.25}(\\varepsilon))\\right)\n$$\n我们现在将此通用框架应用于为 $\\varepsilon$ 指定的两种基线分布。\n\n### 1. 对数正态AFT模型\n在这里，误差项遵循正态分布，$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$，其中 $\\sigma > 0$。令 $Z \\sim \\mathcal{N}(0, 1)$ 为一个标准正态变量，则 $\\varepsilon = \\sigma Z$。$\\varepsilon$ 的第 $p$ 分位数通过 $P(\\varepsilon \\le q_p(\\varepsilon)) = p$ 求得。\n$$\nP(\\sigma Z \\le q_p(\\varepsilon)) = P(Z \\le q_p(\\varepsilon)/\\sigma) = p\n$$\n令 $\\Phi$ 为标准正态分布的累积分布函数（CDF）。则 $\\Phi(q_p(\\varepsilon)/\\sigma) = p$，这意味着 $q_p(\\varepsilon)/\\sigma = \\Phi^{-1}(p)$，其中 $\\Phi^{-1}$ 是标准正态分布的分位数函数。\n$$\nq_p(\\varepsilon) = \\sigma \\Phi^{-1}(p)\n$$\n**$T \\mid \\mathbf{x}$ 的中位数：**\n对于中位数， $p=0.5$。标准正态分布的中位数为 $0$，所以 $\\Phi^{-1}(0.5) = 0$。\n$$\nq_{0.5}(\\varepsilon) = \\sigma \\Phi^{-1}(0.5) = \\sigma \\cdot 0 = 0\n$$\n因此，$T \\mid \\mathbf{x}$ 的中位数为：\n$$\n\\text{Median}(T \\mid \\mathbf{x}) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta} + 0) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\n$$\n**$T \\mid \\mathbf{x}$ 的四分位距（IQR）：**\n对于IQR，我们需要 $p=0.25$ 和 $p=0.75$ 对应的四分位数。\n$$\nq_{0.75}(\\varepsilon) = \\sigma \\Phi^{-1}(0.75)\n$$\n$$\nq_{0.25}(\\varepsilon) = \\sigma \\Phi^{-1}(0.25)\n$$\n由于正态分布关于 $0$ 的对称性，我们有 $\\Phi^{-1}(0.25) = -\\Phi^{-1}(1-0.25) = -\\Phi^{-1}(0.75)$。\n将这些代入 $T$ 的IQR的通用公式中：\n$$\n\\text{IQR}(T \\mid \\mathbf{x}) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta}) \\left( \\exp(\\sigma \\Phi^{-1}(0.75)) - \\exp(-\\sigma \\Phi^{-1}(0.75)) \\right)\n$$\n使用恒等式 $2\\sinh(y) = \\exp(y) - \\exp(-y)$，这可以更紧凑地写为：\n$$\n\\text{IQR}(T \\mid \\mathbf{x}) = 2\\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\sinh(\\sigma\\Phi^{-1}(0.75))\n$$\n\n### 2. 对数逻辑斯谛AFT模型\n在这里，误差项遵循逻辑斯谛分布，$\\varepsilon \\sim \\text{Logistic}(0, s)$，其尺度参数 $s > 0$，累积分布函数为 $F_{\\varepsilon}(u) = (1+\\exp(-u/s))^{-1}$。为了求出 $\\varepsilon$ 的第 $p$ 分位数 $q_p(\\varepsilon)$，我们令 $F_{\\varepsilon}(q_p(\\varepsilon)) = p$ 并求解 $q_p(\\varepsilon)$：\n$$\np = \\frac{1}{1 + \\exp(-q_p(\\varepsilon)/s)} \\implies 1 + \\exp(-q_p(\\varepsilon)/s) = \\frac{1}{p}\n$$\n$$\n\\exp(-q_p(\\varepsilon)/s) = \\frac{1}{p} - 1 = \\frac{1-p}{p}\n$$\n对两边取自然对数：\n$$\n-\\frac{q_p(\\varepsilon)}{s} = \\ln\\left(\\frac{1-p}{p}\\right) = -\\ln\\left(\\frac{p}{1-p}\\right)\n$$\n$$\nq_p(\\varepsilon) = s \\ln\\left(\\frac{p}{1-p}\\right)\n$$\n**$T \\mid \\mathbf{x}$ 的中位数：**\n对于中位数， $p=0.5$。\n$$\nq_{0.5}(\\varepsilon) = s \\ln\\left(\\frac{0.5}{1-0.5}\\right) = s \\ln(1) = 0\n$$\n逻辑斯谛分布关于其位置参数（在此例中为 $0$）对称。$T \\mid \\mathbf{x}$ 的中位数为：\n$$\n\\text{Median}(T \\mid \\mathbf{x}) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta} + 0) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\n$$\n**$T \\mid \\mathbf{x}$ 的四分位距（IQR）：**\n对于IQR，我们需要 $p=0.25$ 和 $p=0.75$ 对应的四分位数。\n$$\nq_{0.75}(\\varepsilon) = s \\ln\\left(\\frac{0.75}{0.25}\\right) = s \\ln(3)\n$$\n$$\nq_{0.25}(\\varepsilon) = s \\ln\\left(\\frac{0.25}{0.75}\\right) = s \\ln(1/3) = -s \\ln(3)\n$$\n将这些代入 $T$ 的IQR的通用公式中：\n$$\n\\text{IQR}(T \\mid \\mathbf{x}) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\left(\\exp(s \\ln(3)) - \\exp(-s \\ln(3))\\right)\n$$\n使用性质 $\\exp(a \\ln b) = b^a$，可简化为：\n$$\n\\text{IQR}(T \\mid \\mathbf{x}) = \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})(3^s - 3^{-s})\n$$\n\n按指定顺序（对数正态中位数、对数正态IQR、对数逻辑斯谛中位数、对数逻辑斯谛IQR）所需的四个表达式是：\n1. $\\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})$\n2. $2\\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\sinh(\\sigma\\Phi^{-1}(0.75))$\n3. $\\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})$\n4. $\\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})(3^s - 3^{-s})$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta}),  2\\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})\\sinh(\\sigma\\Phi^{-1}(0.75)),  \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta}),  \\exp(\\mathbf{x}^{\\top}\\boldsymbol{\\beta})(3^{s} - 3^{-s}) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "时间比 $\\exp(\\beta_j)$ 为解释AFT模型中的协变量效应提供了一种直观的方式。然而，仅有单点的估计值是不够的；我们还必须量化其不确定性。本练习聚焦于为时间比构建和解释置信区间的核心统计任务，这项技能对于从临床试验数据中得出有效、基于证据的结论至关重要。",
            "id": "4949753",
            "problem": "一项随机临床试验评估了一种新疗法相对于标准护理是否能延长疾病复发时间。一个加速失效时间 (AFT) 模型（Accelerated Failure Time (AFT)）被拟合到数据中，其中给定协变量向量 $\\boldsymbol{x}$ 的事件时间 $T$ 的条件对数满足 $\\ln(T) = \\boldsymbol{x}^{\\top}\\boldsymbol{\\beta} + \\sigma \\varepsilon$，其中 $\\varepsilon$ 服从均值为 $0$、方差为 $1$ 的基准分布，且 $\\sigma \\gt 0$。治疗指示变量是第 $j$ 个分量 $x_{j} \\in \\{0,1\\}$，其中 $x_{j} = 1$ 代表新疗法，$x_{j} = 0$ 代表标准护理。$x_{j}$ 每增加一个单位所关联的时间比率为 $\\theta = \\exp(\\beta_{j})$，它量化了治疗组相对于对照组在典型事件时间上的乘性变化。\n\n假设最大似然估计量 $\\widehat{\\beta}_{j}$ 是渐近正态的，其渐近方差由估计的协方差矩阵的相应对角线元素给出，因此 $\\widehat{\\beta}_{j} \\approx \\mathcal{N}(\\beta_{j}, \\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}))$。仅使用AFT模型的定义、最大似然估计量的大样本正态性以及用于平滑变换的delta方法，推导时间比率 $\\theta = \\exp(\\beta_{j})$ 的一个大样本 $(1-\\alpha)$ 置信区间，该区间完全用 $\\widehat{\\beta}_{j}$、$\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})$ 和标准正态分位数 $z_{1-\\alpha/2}$ 表示。然后，对于一个研究，其中拟合模型得出 $\\widehat{\\beta}_{j} = 0.182$ 和 $\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}) = 0.0049$，在置信水平为 $0.95$ 时，计算 $\\theta$ 的 $(1-\\alpha)$ 置信区间，并报告其两个端点。将你的两个数值端点四舍五入到四位有效数字。最后，根据新疗法与标准护理相比在复发时间上的乘性变化，陈述该区间的临床疗效解释。",
            "solution": "该问题要求在一个加速失效时间 (AFT) 模型中推导时间比率 $\\theta$ 的大样本置信区间，对该区间进行数值评估，并给出其临床解释。\n\n首先，我们验证问题陈述。\n步骤1：提取已知信息。\n- AFT模型由 $\\ln(T) = \\boldsymbol{x}^{\\top}\\boldsymbol{\\beta} + \\sigma \\varepsilon$ 定义，其中 $\\varepsilon$ 的均值为 $0$，方差为 $1$，且 $\\sigma  0$。\n- 协变量 $x_{j} \\in \\{0, 1\\}$ 是治疗指示变量（$1$ 代表新疗法，$0$ 代表标准护理）。\n- 时间比率定义为 $\\theta = \\exp(\\beta_{j})$。\n- 最大似然估计量 $\\widehat{\\beta}_{j}$ 是渐近正态的：$\\widehat{\\beta}_{j} \\approx \\mathcal{N}(\\beta_{j}, \\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}))$。\n- 任务是推导 $\\theta$ 的一个 $(1-\\alpha)$ 置信区间。\n- 推导过程应使用delta方法。\n- 区间的最终表达式应使用 $\\widehat{\\beta}_{j}$、$\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})$ 和 $z_{1-\\alpha/2}$ 表示。\n- 用于数值评估的数据：$\\widehat{\\beta}_{j} = 0.182$，$\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}) = 0.0049$，置信水平为 $0.95$。\n- 最终的数值端点必须四舍五入到四位有效数字。\n- 需要对该区间进行临床解释。\n\n步骤2：使用提取的已知信息进行验证。\n该问题具有科学依据，因为它使用了统计理论中标准的、公认的概念，即加速失效时间模型、最大似然估计、delta方法和置信区间构造。这些是生物统计学和生存分析中的核心主题。该问题是适定的，提供了推导唯一解析表达式和计算特定数值结果所需的所有信息和假设。语言是客观和正式的。该问题不违反任何无效标准。这是一个统计建模中的标准、可解问题。\n\n步骤3：结论和行动。\n问题有效。我们继续进行解答。\n\n**第1部分：$\\theta$ 的置信区间的推导**\n\n我们已知参数 $\\beta_{j}$ 的最大似然估计量 $\\widehat{\\beta}_{j}$ 是渐近正态分布的：\n$$ \\widehat{\\beta}_{j} \\sim \\mathcal{N}\\left(\\beta_{j}, \\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})\\right) $$\n由此，我们可以构建一个服从标准正态分布的枢轴量：\n$$ \\frac{\\widehat{\\beta}_{j} - \\beta_{j}}{\\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}} \\approx \\mathcal{N}(0, 1) $$\n令 $\\mathrm{SE}(\\widehat{\\beta}_{j}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}$ 为 $\\widehat{\\beta}_{j}$ 的标准误。基于此枢轴量，可以构造 $\\beta_{j}$ 的一个大样本 $(1-\\alpha)$ 置信区间。对于标准正态分布，区间 $(-z_{1-\\alpha/2}, z_{1-\\alpha/2})$ 包含了 $(1-\\alpha)$ 的概率质量，其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。因此，我们有：\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\widehat{\\beta}_{j} - \\beta_{j}}{\\mathrm{SE}(\\widehat{\\beta}_{j})} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\n整理不等式以分离出 $\\beta_{j}$，得到 $\\beta_{j}$ 的置信区间：\n$$ \\left[ \\widehat{\\beta}_{j} - z_{1-\\alpha/2} \\mathrm{SE}(\\widehat{\\beta}_{j}), \\quad \\widehat{\\beta}_{j} + z_{1-\\alpha/2} \\mathrm{SE}(\\widehat{\\beta}_{j}) \\right] $$\n代回 $\\mathrm{SE}(\\widehat{\\beta}_{j}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}$，$\\beta_{j}$ 的区间为：\n$$ \\left[ \\widehat{\\beta}_{j} - z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}, \\quad \\widehat{\\beta}_{j} + z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})} \\right] $$\n问题要求的是时间比率 $\\theta = \\exp(\\beta_{j})$ 的置信区间。变换 $g(\\beta_j) = \\exp(\\beta_j)$ 是一个光滑、严格递增（单调）的函数。一个变换后参数的有效置信区间可以通过将变换应用于原始参数置信区间的端点来获得。这个过程在理论上由delta方法保证。将delta方法应用于函数 $h(\\theta) = \\ln(\\theta)$ 表明，$\\ln(\\widehat{\\theta}) = \\widehat{\\beta}_{j}$ 的方差约等于 $\\widehat{\\beta}_{j}$ 的方差，这验证了在对数尺度上（即对 $\\beta_j$）构建区间然后进行逆变换的合理性。\n\n将指数函数应用于 $\\beta_{j}$ 区间的下限和上限，我们得到 $\\theta$ 的 $(1-\\alpha)$ 置信区间：\n$$ \\left[ \\exp\\left(\\widehat{\\beta}_{j} - z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}\\right), \\quad \\exp\\left(\\widehat{\\beta}_{j} + z_{1-\\alpha/2} \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})}\\right) \\right] $$\n这就是所要求的时间比率 $\\theta$ 的置信区间的通用表达式。\n\n**第2部分：置信区间的数值评估**\n\n我们已知以下数值：\n- 估计系数：$\\widehat{\\beta}_{j} = 0.182$\n- 估计方差：$\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j}) = 0.0049$\n- 置信水平：$1-\\alpha = 0.95$\n\n首先，我们计算 $\\widehat{\\beta}_{j}$ 的标准误：\n$$ \\mathrm{SE}(\\widehat{\\beta}_{j}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\beta}_{j})} = \\sqrt{0.0049} = 0.07 $$\n对于 $0.95$ 的置信水平，$\\alpha = 0.05$，所以 $\\alpha/2 = 0.025$。相关的标准正态分位数是：\n$$ z_{1-\\alpha/2} = z_{1-0.025} = z_{0.975} $$\n$z_{0.975}$ 的标准值约为 $1.960$。\n\n接下来，我们计算 $\\beta_{j}$ 置信区间的界限：\n$\\beta_{j}$ 的下限：\n$$ L_{\\beta} = \\widehat{\\beta}_{j} - z_{0.975} \\mathrm{SE}(\\widehat{\\beta}_{j}) = 0.182 - 1.960 \\times 0.07 = 0.182 - 0.1372 = 0.0448 $$\n$\\beta_{j}$ 的上限：\n$$ U_{\\beta} = \\widehat{\\beta}_{j} + z_{0.975} \\mathrm{SE}(\\widehat{\\beta}_{j}) = 0.182 + 1.960 \\times 0.07 = 0.182 + 0.1372 = 0.3192 $$\n现在，我们对这些界限取指数，以求出 $\\theta = \\exp(\\beta_{j})$ 的置信区间：\n$\\theta$ 的下限：\n$$ L_{\\theta} = \\exp(L_{\\beta}) = \\exp(0.0448) \\approx 1.045815... $$\n$\\theta$ 的上限：\n$$ U_{\\theta} = \\exp(U_{\\beta}) = \\exp(0.3192) \\approx 1.376040... $$\n将这些端点四舍五入到四位有效数字，得到：\n$$ L_{\\theta} \\approx 1.046 $$\n$$ U_{\\theta} \\approx 1.376 $$\n时间比率 $\\theta$ 的 $95\\%$ 置信区间约为 $[1.046, 1.376]$。\n\n**第3部分：临床疗效解释**\n\n时间比率 $\\theta = \\exp(\\beta_j)$ 代表在所有其他协变量相等的情况下，接受新疗法（$x_j=1$）的患者与接受标准护理（$x_j=0$）的患者相比，事件时间变化的乘性因子。$\\theta  1$ 的值表示新疗法延长了复发时间，$\\theta  1$ 表示缩短了时间，而 $\\theta = 1$ 表示没有效果。\n\n我们计算出的 $\\theta$ 的 $95\\%$ 置信区间是 $[1.046, 1.376]$。整个区间都位于 $1$ 之上。这表明新疗法具有统计上显著的积极效果。临床解释如下：我们有 $95\\%$ 的信心认为，与标准护理相比，新疗法将疾病复发的中位时间乘以一个介于 $1.046$ 和 $1.376$ 之间的因子。换句话说，新疗法与复发中位时间增加 $4.6\\%$ 至 $37.6\\%$ 相关。由于零值 $\\theta=1$（无效果）不包含在置信区间内，这一结果为新疗法在该患者群体中延长疾病复发时间方面优于标准护理提供了强有力的证据。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.046,  1.376\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "拟合模型后，下一个关键步骤是评估其拟合优度。本练习将介绍Cox-Snell残差，这是一种功能强大的诊断工具，可用于检验包括AFT模型在内的任何生存模型的假设。通过理解这些残差的理论基础，您将学会如何诊断模型设定错误，即使在处理右删失数据这一复杂情况时也同样适用。",
            "id": "4949812",
            "problem": "一项临床肿瘤学研究使用加速失效时间 (AFT) 模型对患者 $i$ 的影像学进展时间 $T_i$ 进行建模，其中 $\\log T_i = \\mathbf{x}_i^\\top \\boldsymbol{\\beta} + \\epsilon_i$，$\\mathbf{x}_i$ 是一个 $p$ 维协变量向量，$\\boldsymbol{\\beta}$ 是一个系数向量，而 $\\epsilon_i$ 服从一个具有生存函数 $S_0(\\cdot)$ 的连续基线分布。条件生存函数为 $S(t \\mid \\mathbf{x}) = \\mathbb{P}(T  t \\mid \\mathbf{x})$。患者会受到 $C_i$ 的独立右删失，得到观测时间 $\\tilde T_i = \\min(T_i, C_i)$ 和事件指示符 $\\delta_i = \\mathbf{1}\\{T_i \\le C_i\\}$。在拟合 AFT 模型以获得 $S(t \\mid \\mathbf{x})$ 的估计量 $\\hat S(t \\mid \\mathbf{x})$ 后，将受试者 $i$ 的 Cox-Snell 残差定义为 $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$。\n\n从第一性原理出发，使用生存函数 $S(t \\mid \\mathbf{x})$、累积风险 $H(t \\mid \\mathbf{x}) = -\\log S(t \\mid \\mathbf{x})$ 的定义，以及连续随机变量的单调变换性质，来推断在一个正确设定的、且条件生存函数 $S(t \\mid \\mathbf{x})$ 被一致估计的 AFT 模型下，$\\hat R_i$ 的预期分布行为。假设为独立右删失。下列哪些陈述是正确的？\n\nA. 在正确设定和精确参数下，对于未删失的受试者，随机变量 $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ 是独立同分布的，其累积分布函数为 $F_R(r) = 1 - \\exp(-r)$，密度函数为 $f_R(r) = \\exp(-r)$，其中 $r \\ge 0$。\n\nB. 在 AFT 模型中，条件生存函数满足 $S(t \\mid \\mathbf{x}) = S_0\\!\\big(t \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})\\big)$；因此 $R_i = H_0\\!\\big(T_i \\exp(\\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}})\\big)$，并且在真实模型下，$R_i$ 服从 $\\mathrm{Exponential}(1)$ 分布。\n\nC. 在独立右删失的情况下，使用 $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$ 会在 $\\delta_i = 0$ 时产生在 $\\hat R_i$ 处右删失的残差，并且如果模型设定正确，残差生存函数的 Kaplan-Meier 估计量应近似服从 $\\exp(-r)$。\n\nD. 因为在 AFT 模型中时间是在对数尺度上建模的，所以适当的 Cox-Snell 残差是 $R_i = -\\log \\hat S(\\log T_i \\mid \\mathbf{x}_i)$，在正确设定下该残差服从 $\\mathrm{Normal}(0,1)$ 分布。\n\nE. 如果基线事件时间分布是形状参数为 $k$ 的 $\\mathrm{Weibull}$ 分布，那么在正确设定下，Cox-Snell 残差服从 $\\mathrm{Gamma}(k,1)$ 分布。\n\n选择所有适用项。",
            "solution": "首先必须评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n-   **模型**：事件时间 $T_i$ 的加速失效时间 (AFT) 模型。\n-   **方程**：$\\log T_i = \\mathbf{x}_i^\\top \\boldsymbol{\\beta} + \\epsilon_i$。\n-   **变量**：$\\mathbf{x}_i$ 是一个 $p$ 维协变量向量；$\\boldsymbol{\\beta}$ 是系数向量；$\\epsilon_i$ 是来自连续基线分布的误差项。\n-   **基线生存**：$S_0(\\cdot)$ 是与误差项的基线分布相对应的生存函数。\n-   **条件生存**：$S(t \\mid \\mathbf{x}) = \\mathbb{P}(T  t \\mid \\mathbf{x})$。\n-   **删失**：受 $C_i$ 独立右删失。\n-   **观测数据**：$\\tilde T_i = \\min(T_i, C_i)$ 和事件指示符 $\\delta_i = \\mathbf{1}\\{T_i \\le C_i\\}$。\n-   **估计量**：$\\hat S(t \\mid \\mathbf{x})$ 是 $S(t \\mid \\mathbf{x})$ 的一个估计量。\n-   **Cox-Snell 残差定义**：$\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$。\n-   **问题**：在一个正确设定的、且估计一致的模型下，确定 $\\hat R_i$ 的分布行为的正确陈述。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于生存分析中公认的原理，特别是 AFT 模型和 Cox-Snell 残差。所有概念在统计理论及其在医学研究中的应用中都是标准的。\n-   **适定性**：该问题要求在一套标准假设（正确的模型设定，一致的估计）下推导理论性质。从这些前提出发，可以得出一组唯一的正确结论。\n-   **客观性**：语言是正式的，不含主观性。\n-   **缺陷检查表**：该问题不违反任何科学原理，陈述正式、完整，在理论背景下是现实的，并且是适定的。定义是标准的。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。将推导解答。\n\n### 从第一性原理推导\nCox-Snell 残差性质背后的基本原理是概率积分变换 (PIT)。对于一个具有累积分布函数 (CDF) $F(t) = \\mathbb{P}(T \\le t)$ 和生存函数 $S(t) = 1 - F(t)$ 的连续随机变量 $T$，随机变量 $U = F(T)$ 在 $[0,1]$ 上均匀分布。等价地，$1-S(T)$ 在 $[0,1]$ 上均匀分布，随机变量 $U' = S(T)$ 也是如此。\n\n我们来证明 $U' = S(T)$ 的情况。由于 $T$ 是连续的，$S(t)$ 是一个严格递减的函数。对于任何 $u \\in (0, 1)$，我们可以求出 $U'$ 的累积分布函数：\n$$ \\mathbb{P}(U' \\le u) = \\mathbb{P}(S(T) \\le u) $$\n因为 $S(\\cdot)$ 是严格递减的，其反函数 $S^{-1}(\\cdot)$ 存在且也是严格递减的。\n$$ \\mathbb{P}(S(T) \\le u) = \\mathbb{P}(T \\ge S^{-1}(u)) = S(S^{-1}(u)) = u $$\n这是 $\\mathrm{Uniform}(0,1)$ 分布的累积分布函数。\n\n现在，考虑随机变量 $R = -\\log(U')$。如果 $U' \\sim \\mathrm{Uniform}(0,1)$，其累积分布函数为 $F_{U'}(u) = u$，其中 $u \\in [0,1]$。对于 $r \\ge 0$，$R$ 的累积分布函数是：\n$$ F_R(r) = \\mathbb{P}(R \\le r) = \\mathbb{P}(-\\log U' \\le r) = \\mathbb{P}(\\log U' \\ge -r) = \\mathbb{P}(U' \\ge e^{-r}) $$\n由于 $U' \\sim \\mathrm{Uniform}(0,1)$，对于 $v \\in [0,1]$，$\\mathbb{P}(U' \\ge v) = 1 - v$。因此：\n$$ F_R(r) = 1 - e^{-r} $$\n这是标准指数分布，即 $\\mathrm{Exponential}(1)$ 的累积分布函数，其率参数为 $\\lambda=1$。其概率密度函数 (PDF) 为 $f_R(r) = e^{-r}$，其中 $r \\ge 0$。\n\n这个结果可以应用于生存分析。对于一个给定协变量为 $\\mathbf{x}_i$ 的受试者，其事件时间 $T_i$ 是一个随机变量，其条件生存函数为 $S(t \\mid \\mathbf{x}_i)$。在模型设定正确的假设下，对于未删失的观测值，定义的“真实”Cox-Snell 残差 $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ 必须服从 $\\mathrm{Exponential}(1)$ 分布。这是因为根据 PIT，$S(T_i \\mid \\mathbf{x}_i)$ 服从 $\\mathrm{Uniform}(0,1)$ 分布。只要基线生存函数 $S_0(\\cdot)$ 是连续的，这个性质就成立，而与其具体形式无关。\n\n在实践中计算的是估计残差 $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$。如果模型是正确的，且参数的估计量是一致的，那么 $\\hat S(t \\mid \\mathbf{x}_i)$ 就是 $S(t \\mid \\mathbf{x}_i)$ 的一致估计量，对于未删失的受试者，$\\hat R_i$ 的分布将近似为 $\\mathrm{Exponential}(1)$。\n\n### 逐项分析\n\n**A. 在正确设定和精确参数下，对于未删失的受试者，随机变量 $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ 是独立同分布的，其累积分布函数为 $F_R(r) = 1 - \\exp(-r)$，密度函数为 $f_R(r) = \\exp(-r)$，其中 $r \\ge 0$。**\n\n如上所推导，对于任何单个受试者 $i$，只要模型 $S(t \\mid \\mathbf{x}_i)$ 是正确的，随机变量 $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ 就服从 $\\mathrm{Exponential}(1)$ 分布。$\\mathrm{Exponential}(1)$ 分布的累积分布函数确实是 $F_R(r) = 1 - \\exp(-r)$，其密度函数是 $f_R(r) = \\exp(-r)$，其中 $r \\ge 0$。\n问题假设了一个标准的受试者独立的研究设置。由于从 $T_i$ 到 $R_i$ 的转换是针对每个受试者的，因此得到的残差 $R_i$ 也是独立的。\n此外，该转换将每个 $T_i$ 的分布（依赖于 $\\mathbf{x}_i$）映射到*相同*的标准分布，即 $\\mathrm{Exponential}(1)$。因此，残差 $R_i$ 是同分布的。该陈述是 PIT 的直接推论。\n\n结论：**正确**。\n\n**B. 在 AFT 模型中，条件生存函数满足 $S(t \\mid \\mathbf{x}) = S_0\\!\\big(t \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})\\big)$；因此 $R_i = H_0\\!\\big(T_i \\exp(\\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}})\\big)$，并且在真实模型下，$R_i$ 服从 $\\mathrm{Exponential}(1)$ 分布。**\n\n让我们从模型 $\\log T = \\mathbf{x}^\\top \\boldsymbol{\\beta} + \\epsilon$ 推导 AFT 生存函数。这意味着 $T = e^{\\epsilon} e^{\\mathbf{x}^\\top \\boldsymbol{\\beta}}$。令 $T_0 = e^{\\epsilon}$ 为基线事件时间，其生存函数为 $S_0(\\cdot)$。则 $T = T_0 e^{\\mathbf{x}^\\top \\boldsymbol{\\beta}}$。\n条件生存函数为：\n$$ S(t \\mid \\mathbf{x}) = \\mathbb{P}(T > t \\mid \\mathbf{x}) = \\mathbb{P}(T_0 e^{\\mathbf{x}^\\top \\boldsymbol{\\beta}} > t) = \\mathbb{P}(T_0 > t e^{-\\mathbf{x}^\\top \\boldsymbol{\\beta}}) = S_0(t e^{-\\mathbf{x}^\\top \\boldsymbol{\\beta}}) $$\n该陈述声称 $S(t \\mid \\mathbf{x}) = S_0\\!\\big(t \\exp(\\mathbf{x}^\\top \\boldsymbol{\\beta})\\big)$。这在指数中的符号是错误的。这种形式意味着正系数 $\\beta_j$ 会缩短生存期，这与 AFT 模型的典型解释（它“加速”或拉伸时间）相反。\n因此，残差的表达式也是不正确的。正确的真实残差是 $R_i = -\\log S(T_i \\mid \\mathbf{x}_i) = -\\log S_0(T_i e^{-\\mathbf{x}_i^\\top \\boldsymbol{\\beta}})$。令 $H_0(t) = -\\log S_0(t)$ 为基线累积风险。则 $R_i = H_0(T_i e^{-\\mathbf{x}_i^\\top \\boldsymbol{\\beta}})$。该陈述给出了一个不正确的公式 $R_i = H_0\\!\\big(T_i \\exp(\\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}})\\big)$，它使用了错误的符号，并将估计参数（$\\hat{\\boldsymbol{\\beta}}$）与关于真实模型的陈述混合在一起。虽然正确定义的残差服从 $\\mathrm{Exponential}(1)$ 分布，但此选项中提出的整个推理链都是有缺陷的。\n\n结论：**不正确**。\n\n**C. 在独立右删失的情况下，使用 $\\hat R_i = -\\log \\hat S(\\tilde T_i \\mid \\mathbf{x}_i)$ 会在 $\\delta_i = 0$ 时产生在 $\\hat R_i$ 处右删失的残差，并且如果模型设定正确，残差生存函数的 Kaplan-Meier 估计量应近似服从 $\\exp(-r)$。**\n\n当一个观测值是右删失时，我们观测到 $\\tilde T_i = C_i$ 并知道真实的事件时间 $T_i  C_i$。计算出的残差是 $\\hat R_i = -\\log \\hat S(C_i \\mid \\mathbf{x}_i)$。真实的、未观测到的残差是 $R_i^* = -\\log \\hat S(T_i \\mid \\mathbf{x}_i)$。由于 $T_i  C_i$ 且生存函数 $\\hat S$ 是递减的，我们有 $\\hat S(T_i \\mid \\mathbf{x}_i)  \\hat S(C_i \\mid \\mathbf{x}_i)$。取负对数会反转不等式：$R_i^* > \\hat R_i$。这意味着对于一个删失的观测值，计算出的残差 $\\hat R_i$ 是真实事件残差 $R_i^*$ 的一个下界。这就是残差右删失的定义。删失指示符 $\\delta_i$ 也适用于残差。\n由于真实残差 $R_i$ 服从 $\\mathrm{Exponential}(1)$ 分布（生存函数为 $S(r) = e^{-r}$），计算出的残差集合 $\\{\\hat R_i, \\delta_i\\}$ 构成了一个来自近似 $\\mathrm{Exponential}(1)$ 分布的右删失样本。为了检验这一点，可以从这个删失样本中计算生存函数的 Kaplan-Meier 估计量。如果模型设定正确，这条经验生存曲线应该紧密地遵循理论上的 $\\mathrm{Exponential}(1)$ 生存曲线 $S(r) = e^{-r}$。这是生存模型的一种标准图形诊断技术。\n\n结论：**正确**。\n\n**D. 因为在 AFT 模型中时间是在对数尺度上建模的，所以适当的 Cox-Snell 残差是 $R_i = -\\log \\hat S(\\log T_i \\mid \\mathbf{x}_i)$，在正确设定下该残差服从 $\\mathrm{Normal}(0,1)$ 分布。**\n\nCox-Snell 残差的定义是 $H(\\tilde T \\mid \\mathbf{x}) = -\\log S(\\tilde T \\mid \\mathbf{x})$，其中 $H$ 和 $S$ 是在原始时间尺度 $t$ 上定义的累积风险和生存函数。其参数必须是时间，所以在 $\\log T_i$ 处评估 $\\hat S$ 是不正确的；$\\hat S$ 的定义域是时间，而不是对数时间。其次，如前所述，正确定义的 Cox-Snell 残差的分布是 $\\mathrm{Exponential}(1)$，而不是 $\\mathrm{Normal}(0,1)$。对数时间尺度上的残差，比如 $\\log T_i - \\mathbf{x}_i^\\top \\hat{\\boldsymbol{\\beta}}$，如果假设误差项 $\\epsilon_i$ 服从正态分布，则可能期望它们是正态的，但这些不是 Cox-Snell 残差。该陈述混淆了不同类型的残差及其性质。\n\n结论：**不正确**。\n\n**E. 如果基线事件时间分布是形状参数为 $k$ 的 $\\mathrm{Weibull}$ 分布，那么在正确设定下，Cox-Snell 残差服从 $\\mathrm{Gamma}(k,1)$ 分布。**\n\n通过 PIT 的一般推导表明，Cox-Snell 残差 $R_i = -\\log S(T_i \\mid \\mathbf{x}_i)$ 服从 $\\mathrm{Exponential}(1)$ 分布，无论基线分布是什么，只要它是连续的。我们可以对 Weibull 分布的情况进行验证。设基线为 $T_0 \\sim \\mathrm{Weibull}(\\lambda_0, k)$，所以 $S_0(t) = \\exp(-(\\lambda_0 t)^k)$。条件生存函数是 $S(t \\mid \\mathbf{x}) = S_0(t e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}}) = \\exp(-(\\lambda_0 t e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})^k)$。残差是 $R = -\\log S(T \\mid \\mathbf{x}) = (\\lambda_0 T e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})^k$。我们知道给定 $\\mathbf{x}$ 的 $T$ 服从形状参数为 $k$、尺度参数为 $(\\lambda_0 e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})^{-1}$ 的 Weibull 分布。令 $Y = T \\cdot (\\lambda_0 e^{-\\mathbf{x}^\\top\\boldsymbol{\\beta}})$。随机变量 $Y$ 服从形状参数为 $k$、尺度参数为 1 的标准 Weibull 分布，因此其生存函数为 $\\mathbb{P}(Yy) = \\exp(-y^k)$。残差是 $R = Y^k$。\n$R$ 的累积分布函数是 $\\mathbb{P}(R \\le r) = \\mathbb{P}(Y^k \\le r) = \\mathbb{P}(Y \\le r^{1/k}) = 1 - \\exp(-(r^{1/k})^k) = 1 - \\exp(-r)$。\n这是 $\\mathrm{Exponential}(1)$ 分布的累积分布函数，也就是一个 $\\mathrm{Gamma}(1,1)$ 分布。该陈述声称分布是 $\\mathrm{Gamma}(k,1)$，但这仅在 $k=1$ 的特殊情况（即指数基线）下成立。对于任何其他形状参数 $k \\ne 1$，该主张都是错误的。该分布是不变的。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}