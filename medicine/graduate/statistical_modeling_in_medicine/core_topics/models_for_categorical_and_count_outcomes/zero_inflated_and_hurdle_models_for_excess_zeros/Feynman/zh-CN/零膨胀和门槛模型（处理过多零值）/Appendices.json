{
    "hands_on_practices": [
        {
            "introduction": "在计数数据分析中，过度离散（即方差大于均值）常常被误解为数据中存在“额外零”的直接证据。本练习旨在从第一性原理出发，澄清这一常见误解，帮助你辨别过度离散和额外零这两个不同但相关的概念。通过构建一个反例，你将深入理解为何在选择零膨胀模型或跨栏模型之前，进行审慎的诊断分析至关重要。",
            "id": "4993564",
            "problem": "一家医疗中心追踪慢性呼吸系统疾病患者每年严重急性发作的次数。令 $Y$ 表示每患者年的计数。该中心观察到过度离散现象，即与泊松基准模型相比，$\\mathrm{Var}(Y)>\\mathrm{E}(Y)$。分析人员正在考虑是否需要使用零膨胀模型来解释明显偏大的零计数比例。\n\n仅使用核心定义和经过充分检验的事实，按如下步骤进行。\n\n1) 从第一性原理出发，解释为什么仅有过度离散并不逻辑上意味着“零过多”。此处，“零过多”指的是在零点处的概率质量 $\\mathbb{P}(Y=0)$ 大于具有相同均值的适当选择的基准计数模型的期望值。您的解释应明确阐述关于二阶矩（方差膨胀）的陈述与关于单点（$0$）概率质量的陈述之间的区别。给出一个具体的构造，该构造是一个过度离散的计数分布，但其零点概率不足（即 $\\mathbb{P}(Y=0)$ 小于具有相同均值的标准基准模型，如泊松分布），从而证明过度离散本身并不能保证零过多。\n\n2) 现在假设 $Y$ 服从负二项 (NB) 模型，该模型在生物统计学中广泛用于处理过度离散的计数数据，并通过 Poisson-Gamma 混合模型定义：在给定特定于个体的脆弱性参数 $\\,\\Theta\\,$ 的条件下，$Y \\mid \\Theta \\sim \\mathrm{Poisson}(\\lambda\\,\\Theta)$，且脆弱性参数 $\\Theta \\sim \\mathrm{Gamma}(k,\\text{rate}=k)$，因此 $\\mathrm{E}[\\Theta]=1$ 且 $\\mathrm{Var}(\\Theta)=1/k$。因此，$\\mathrm{E}[Y]=\\lambda$ 且 $\\mathrm{Var}(Y)=\\lambda+\\lambda^{2}/k$。从这个混合定义和泊松随机变量的概率定义出发，推导边际零概率 $\\mathbb{P}(Y=0)$ 关于 $\\,\\lambda\\,$ 和 $\\,k\\,$ 的闭式表达式。\n\n对于一个均值为 $\\lambda=2.4$、离散参数为 $k=1.5$ 的队列，对您推导出的表达式进行数值计算。将最终数值答案四舍五入至四位有效数字。以无单位小数的形式报告最终量。",
            "solution": "问题陈述具有科学依据，表述清晰，且无矛盾之处。它提出了应用统计学中一个标准但微妙的概念性挑战。因此，我们可以开始解题。\n\n1) “过度离散并不逻辑上意味着零过多”这一陈述涉及分布的二阶矩与单点概率质量之间的关系。在计数数据的背景下，过度离散意味着随机变量 $Y$ 的方差大于其期望值，即 $\\mathrm{Var}(Y) > \\mathrm{E}(Y)$。这是与泊松分布相比较而言的，对于泊松分布，$\\mathrm{Var}(Y) = \\mathrm{E}(Y)$。“零过多”意味着观察到的零计数概率 $\\mathbb{P}(Y=0)$ 大于具有相同均值的基准模型所预测的概率。对于均值为 $\\mu = \\mathrm{E}(Y)$ 的泊松基准模型，这意味着 $\\mathbb{P}(Y=0) > \\exp(-\\mu)$。\n\n方差定义为 $\\mathrm{Var}(Y) = \\mathrm{E}[(Y-\\mu)^2] = \\sum_{k=0}^{\\infty} (k-\\mu)^2 \\mathbb{P}(Y=k)$，是分布的一个全局属性，因为它是对所有可能结果进行加权平均得到的。它衡量概率质量围绕均值的散布程度。与基准模型相比，分布的尾部（即远离均值的值处）有更多的概率质量可以导致较大的方差。\n\n相反，$\\mathbb{P}(Y=0)$ 是一个局部属性，指的是在单点 $k=0$ 处的概率质量。可以在不增加甚至减少 $k=0$ 处概率质量的情况下增大方差。这可以通过将概率质量从均值附近转移到分布的上尾部来实现。将 $k=0$ 处的概率质量移走并重新分配到一个非常大的 $k$ 值上，会同时减少 $\\mathbb{P}(Y=0)$ 并增加方差，因为新的大结果值所对应的巨大平方偏差 $(k-\\mu)^2$ 会对求和贡献很大。\n\n为提供一个具体的构造，我们定义一个基准模型 $Y_P \\sim \\mathrm{Poisson}(\\lambda=1)$。\n对此基准模型：\n- 均值：$\\mathrm{E}[Y_P] = 1$。\n- 方差：$\\mathrm{Var}[Y_P] = 1$。\n- 零概率：$\\mathbb{P}(Y_P=0) = \\exp(-1) \\approx 0.3679$。\n\n现在，我们构造一个新的离散随机变量 $Y$，其概率质量函数 (PMF) 如下，设计使其具有相同的均值、过度离散，但表现出零点概率不足：\n令 $Y$ 在 $\\{0, 1, 11\\}$ 中取值，其 PMF 为：\n- $\\mathbb{P}(Y=0) = 0.1$\n- $\\mathbb{P}(Y=1) = 0.89$\n- $\\mathbb{P}(Y=11) = 0.01$\n概率之和为 $0.1 + 0.89 + 0.01 = 1$，因此这是一个有效的 PMF。\n\n让我们检查它的性质：\n- 均值：$\\mathrm{E}[Y] = (0 \\times 0.1) + (1 \\times 0.89) + (11 \\times 0.01) = 0 + 0.89 + 0.11 = 1$。均值与泊松基准模型相同。\n- 零概率：$\\mathbb{P}(Y=0) = 0.1$。与基准模型相比，$0.1  \\exp(-1) \\approx 0.3679$。因此，该分布存在“零点概率不足”，而非零过多。\n- 方差：首先，我们计算二阶矩 $\\mathrm{E}[Y^2]$。\n$\\mathrm{E}[Y^2] = (0^2 \\times 0.1) + (1^2 \\times 0.89) + (11^2 \\times 0.01) = 0 + 0.89 + (121 \\times 0.01) = 0.89 + 1.21 = 2.1$。\n方差为 $\\mathrm{Var}(Y) = \\mathrm{E}[Y^2] - (\\mathrm{E}[Y])^2 = 2.1 - 1^2 = 1.1$。\n因为 $\\mathrm{Var}(Y) = 1.1  \\mathrm{E}[Y] = 1$，所以该分布是过度离散的。\n\n这个构造展示了一个随机变量 $Y$，它相对于其均值是过度离散的，但其零计数概率却小于相应的泊松分布。因此，仅观察到过度离散现象不足以断定存在零过多。\n\n2) 我们被要求推导作为 Poisson-Gamma 混合定义的负二项模型的边际概率 $\\mathbb{P}(Y=0)$。模型由以下公式给出：\n$Y \\mid \\Theta \\sim \\mathrm{Poisson}(\\lambda\\Theta)$\n$\\Theta \\sim \\mathrm{Gamma}(\\text{shape}=k, \\text{rate}=k)$\n\n边际概率 $\\mathbb{P}(Y=0)$ 是通过对脆弱性参数 $\\Theta$ 的分布求条件概率 $\\mathbb{P}(Y=0|\\Theta)$ 的平均值得到的。\n$\\Theta \\sim \\mathrm{Gamma}(\\text{shape}=\\alpha, \\text{rate}=\\beta)$ 的概率密度函数 (PDF) 为 $f(\\theta; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)}\\theta^{\\alpha-1}\\exp(-\\beta\\theta)$，其中 $\\theta  0$。在我们的例子中，$\\alpha=k$ 且 $\\beta=k$，所以 $\\Theta$ 的 PDF 为：\n$$f_{\\Theta}(\\theta) = \\frac{k^k}{\\Gamma(k)}\\theta^{k-1}\\exp(-k\\theta)$$\n对于均值为 $\\mu$ 的泊松分布，结果为零的概率是 $\\exp(-\\mu)$。在这里，条件均值是 $\\lambda\\Theta$，所以条件零概率是：\n$$\\mathbb{P}(Y=0|\\Theta=\\theta) = \\exp(-\\lambda\\theta)$$\n为了找到边际概率，我们计算条件概率关于 $\\Theta$ 的期望：\n$$\\mathbb{P}(Y=0) = \\mathrm{E}_{\\Theta}[\\mathbb{P}(Y=0|\\Theta)] = \\int_0^\\infty \\mathbb{P}(Y=0|\\Theta=\\theta) f_{\\Theta}(\\theta) d\\theta$$\n代入条件概率和 $\\Theta$ 的 PDF 的表达式：\n$$\\mathbb{P}(Y=0) = \\int_0^\\infty \\exp(-\\lambda\\theta) \\left( \\frac{k^k}{\\Gamma(k)}\\theta^{k-1}\\exp(-k\\theta) \\right) d\\theta$$\n我们可以合并指数项并将常数提到积分符号外：\n$$\\mathbb{P}(Y=0) = \\frac{k^k}{\\Gamma(k)} \\int_0^\\infty \\theta^{k-1} \\exp(-k\\theta - \\lambda\\theta) d\\theta$$\n$$\\mathbb{P}(Y=0) = \\frac{k^k}{\\Gamma(k)} \\int_0^\\infty \\theta^{k-1} \\exp(-(\\lambda+k)\\theta) d\\theta$$\n这个积分是 Gamma 分布归一化常数的核心部分。我们使用恒等式 $\\int_0^\\infty x^{\\alpha-1}\\exp(-\\beta x)dx = \\frac{\\Gamma(\\alpha)}{\\beta^\\alpha}$。这里，$\\alpha=k$ 且 $\\beta=\\lambda+k$。\n应用此恒等式，积分解得：\n$$\\int_0^\\infty \\theta^{k-1} \\exp(-(\\lambda+k)\\theta) d\\theta = \\frac{\\Gamma(k)}{(\\lambda+k)^k}$$\n将此结果代回我们关于 $\\mathbb{P}(Y=0)$ 的表达式中：\n$$\\mathbb{P}(Y=0) = \\frac{k^k}{\\Gamma(k)} \\left( \\frac{\\Gamma(k)}{(\\lambda+k)^k} \\right) = \\frac{k^k}{(\\lambda+k)^k}$$\n因此，边际零概率的闭式表达式为：\n$$\\mathbb{P}(Y=0) = \\left(\\frac{k}{\\lambda+k}\\right)^k$$\n对于给定的队列，我们有均值计数 $\\lambda=2.4$ 和离散参数 $k=1.5$。我们对推导出的表达式进行数值计算：\n$$\\mathbb{P}(Y=0) = \\left(\\frac{1.5}{2.4+1.5}\\right)^{1.5} = \\left(\\frac{1.5}{3.9}\\right)^{1.5} = \\left(\\frac{5}{13}\\right)^{1.5}$$\n计算该值：\n$$\\left(\\frac{5}{13}\\right)^{1.5} \\approx (0.38461538)^{1.5} \\approx 0.23853535$$\n将此结果四舍五入至四位有效数字，得到 $0.2385$。",
            "answer": "$$\\boxed{0.2385}$$"
        },
        {
            "introduction": "在确信需要处理额外零点后，我们转向零膨胀泊松 (ZIP) 模型的实际应用。这个练习提供了一个具体的临床场景，指导你如何利用 ZIP 模型的混合结构来解释观测到的零值。通过计算一个观测到的零来自于“结构性零”成分的后验概率，你将获得对模型内部工作机制的定量理解，并学会如何解读其参数。",
            "id": "4993558",
            "problem": "某个医院系统使用零膨胀泊松（ZIP）模型对因哮喘急性发作导致的每月急诊就诊次数进行建模。ZIP模型假设了以下生成机制：对于患者 $i$，其以概率 $\\pi_i$ 处于结构性零状态，观测到的计数 $Y_i$ 确定性地为 $0$；否则，以概率 $1 - \\pi_i$，该计数来自均值为 $\\lambda_i$ 的泊松分布。结构性零概率 $\\pi_i$ 通过逻辑（logit）链接函数与协变量相关联，泊松均值 $\\lambda_i$ 通过对数（log）链接函数与协变量相关联，这两种链接函数在广义线性模型中都是标准配置。\n\n对于单个患者 $i$，假设拟合的协变量模型如下：\n$$\\mathrm{logit}(\\pi_i) = \\alpha_0 + \\alpha_1 \\,\\mathrm{Prophylaxis}_i + \\alpha_2 \\,\\mathrm{Immunocompromised}_i + \\alpha_3 \\,\\mathrm{PriorExacerbation}_i,$$\n$$\\ln(\\lambda_i) = \\beta_0 + \\beta_1 \\,\\mathrm{Smoking}_i + \\beta_2 \\,\\frac{\\mathrm{Age}_i}{10} + \\beta_3 \\,\\mathrm{Prophylaxis}_i + \\beta_4 \\,\\mathrm{ComorbidityIndex}_i.$$\n\n假设以下估计系数来自一项经过验证的研究：\n$$\\alpha_0 = -0.5,\\quad \\alpha_1 = 0.8,\\quad \\alpha_2 = 0.4,\\quad \\alpha_3 = -0.6,$$\n$$\\beta_0 = -0.6,\\quad \\beta_1 = 0.4,\\quad \\beta_2 = 0.05,\\quad \\beta_3 = -0.3,\\quad \\beta_4 = 0.1.$$\n\n对于我们感兴趣的患者，其协变量值如下：\n$$\\mathrm{Prophylaxis}_i = 1,\\quad \\mathrm{Immunocompromised}_i = 0,\\quad \\mathrm{PriorExacerbation}_i = 0,$$\n$$\\mathrm{Smoking}_i = 1,\\quad \\mathrm{Age}_i = 60,\\quad \\mathrm{ComorbidityIndex}_i = 2.$$\n\n在某个给定的月份，观测到的计数为 $y_i = 0$。请从ZIP模型的混合定义和贝叶斯法则出发，使用由拟合模型得出的上述 $(\\pi_i,\\lambda_i)$，推导并计算这个观测到的零来自于结构性零部分而非泊松部分的后验概率。请将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "本题要求在零膨胀泊松（ZIP）模型的框架内计算一个后验概率。具体来说，在观测到的计数为零的条件下，我们需要确定这个零是源于模型的“结构性零”部分而非“计数”（泊松）部分的概率。这个问题可以使用贝叶斯法则来解决。\n\n令 $Y_i$ 为代表患者 $i$ 的急诊就诊次数的随机变量。ZIP模型假设了两个过程的混合。我们可以引入一个潜在的二元变量 $S_i$，用以指示观测值是从哪个部分抽取的。\n如果患者属于结构性零组（在给定情境下是“总是零”的患者），则令 $S_i = 1$。其概率为 $P(S_i=1) = \\pi_i$。\n如果患者属于“风险”组，其计数遵循泊松分布，则令 $S_i = 0$。其概率为 $P(S_i=0) = 1-\\pi_i$。\n\n模型定义如下：\n- 如果 $S_i=1$，则观测计数 $Y_i$ 确定性地为 $0$。因此，条件概率为 $P(Y_i=0 | S_i=1) = 1$。\n- 如果 $S_i=0$，则计数 $Y_i$ 遵循均值为 $\\lambda_i$ 的泊松分布，即 $Y_i | (S_i=0) \\sim \\mathrm{Poisson}(\\lambda_i)$。其概率质量函数为 $P(Y_i=k | S_i=0) = \\frac{\\exp(-\\lambda_i)\\lambda_i^k}{k!}$，其中 $k \\in \\{0, 1, 2, ...\\}$。\n\n题目说明，对于我们感兴趣的患者，观测到的计数是 $y_i = 0$。我们被要求计算这个零是结构性零的后验概率，即 $P(S_i=1 | Y_i=0)$。\n\n使用贝叶斯法则，这个后验概率由下式给出：\n$$P(S_i=1 | Y_i=0) = \\frac{P(Y_i=0 | S_i=1) P(S_i=1)}{P(Y_i=0)}$$\n此方程中的各项为：\n- $P(S_i=1) = \\pi_i$，即属于结构性零组的先验概率。\n- $P(Y_i=0 | S_i=1) = 1$，根据模型定义。\n- $P(Y_i=0)$ 是观测到零的总概率，可以使用全概率法则求得：\n$$P(Y_i=0) = P(Y_i=0 | S_i=1)P(S_i=1) + P(Y_i=0 | S_i=0)P(S_i=0)$$\n项 $P(Y_i=0 | S_i=0)$ 是从泊松部分观测到零的概率，即：\n$$P(Y_i=0 | S_i=0) = \\frac{\\exp(-\\lambda_i)\\lambda_i^0}{0!} = \\exp(-\\lambda_i)$$\n将各分量代入全概率法则，得到：\n$$P(Y_i=0) = (1)(\\pi_i) + (\\exp(-\\lambda_i))(1-\\pi_i) = \\pi_i + (1-\\pi_i)\\exp(-\\lambda_i)$$\n现在，我们可以写出所求后验概率的最终表达式：\n$$P(S_i=1 | Y_i=0) = \\frac{1 \\cdot \\pi_i}{\\pi_i + (1-\\pi_i)\\exp(-\\lambda_i)}$$\n\n下一步是使用给定的协变量模型和估计系数来计算患者特定的参数 $\\pi_i$ 和 $\\lambda_i$。\n\n首先，我们计算结构性零概率 $\\pi_i$ 的线性预测量：\n$$\\mathrm{logit}(\\pi_i) = \\alpha_0 + \\alpha_1 \\,\\mathrm{Prophylaxis}_i + \\alpha_2 \\,\\mathrm{Immunocompromised}_i + \\alpha_3 \\,\\mathrm{PriorExacerbation}_i$$\n代入给定的系数和协变量值：\n$$\\mathrm{logit}(\\pi_i) = -0.5 + (0.8)(1) + (0.4)(0) + (-0.6)(0) = -0.5 + 0.8 = 0.3$$\n为了求得 $\\pi_i$，我们应用反logit（逻辑斯蒂）函数：\n$$\\pi_i = \\mathrm{logit}^{-1}(0.3) = \\frac{\\exp(0.3)}{1 + \\exp(0.3)}$$\n\n接下来，我们计算泊松均值 $\\lambda_i$ 的线性预测量：\n$$\\ln(\\lambda_i) = \\beta_0 + \\beta_1 \\,\\mathrm{Smoking}_i + \\beta_2 \\,\\frac{\\mathrm{Age}_i}{10} + \\beta_3 \\,\\mathrm{Prophylaxis}_i + \\beta_4 \\,\\mathrm{ComorbidityIndex}_i$$\n代入给定的系数和协变量值：\n$$\\ln(\\lambda_i) = -0.6 + (0.4)(1) + (0.05)\\left(\\frac{60}{10}\\right) + (-0.3)(1) + (0.1)(2)$$\n$$\\ln(\\lambda_i) = -0.6 + 0.4 + (0.05)(6) - 0.3 + 0.2$$\n$$\\ln(\\lambda_i) = -0.6 + 0.4 + 0.3 - 0.3 + 0.2 = 0$$\n为了求得 $\\lambda_i$，我们应用反对数（指数）函数：\n$$\\lambda_i = \\exp(0) = 1$$\n\n现在我们将 $\\pi_i$ 的表达式和 $\\lambda_i$ 的值代入我们的后验概率公式。为简化计算，我们可以将分子和分母同乘以 $(1 + \\exp(0.3))$:\n$$P(S_i=1 | Y_i=0) = \\frac{\\frac{\\exp(0.3)}{1 + \\exp(0.3)}}{\\frac{\\exp(0.3)}{1 + \\exp(0.3)} + \\left(1 - \\frac{\\exp(0.3)}{1 + \\exp(0.3)}\\right)\\exp(-1)}$$\n$$P(S_i=1 | Y_i=0) = \\frac{\\frac{\\exp(0.3)}{1 + \\exp(0.3)}}{\\frac{\\exp(0.3)}{1 + \\exp(0.3)} + \\frac{1}{1 + \\exp(0.3)}\\exp(-1)}$$\n$$P(S_i=1 | Y_i=0) = \\frac{\\exp(0.3)}{\\exp(0.3) + \\exp(-1)}$$\n现在我们计算数值：\n$$\\exp(0.3) \\approx 1.3498588$$\n$$\\exp(-1) \\approx 0.3678794$$\n$$P(S_i=1 | Y_i=0) \\approx \\frac{1.3498588}{1.3498588 + 0.3678794} = \\frac{1.3498588}{1.7177382} \\approx 0.7858310$$\n按题目要求，将结果四舍五入到四位有效数字，我们得到 $0.7858$。\n\n这个值表示，在给定模型和该患者特定协变量的情况下，观测到的零计数是由于该患者处于结构性零状态的后验概率。",
            "answer": "$$\\boxed{0.7858}$$"
        },
        {
            "introduction": "选择正确的统计模型对于得出有效的科学结论至关重要，但如果我们选错了模型会发生什么？本练习探讨了模型误设的实际后果，特别是当使用标准泊松回归分析存在额外零的数据时。通过分析一个假设的临床试验，你将推断出在估计处理效应时产生的偏差方向，从而深刻体会到零膨胀模型和跨栏模型在避免错误结论中的核心价值。",
            "id": "4993552",
            "problem": "一项随机对照试验比较了一项新的预防性项目与常规护理在有呼吸道感染风险的患者中的效果。结局是每位患者在$12$个月内有记录的感染次数，记为 $Y \\in \\{0,1,2,\\ldots\\}$，治疗为 $T \\in \\{0,1\\}$，其中 $T=1$ 代表新项目。许多患者的 $Y=0$。研究人员怀疑，一些零是结构性零（例如，由于没有暴露，患者在此期间确实没有风险），而另一些是抽样零（有风险的患者在此期间碰巧没有发生事件）。\n\n考虑了两种数据生成机制：\n\n- 结构性零机制：在给定 $T=t$ 的条件下，患者有 $\\pi_t$ 的概率没有风险，此时 $Y=0$ 是确定性的；有 $1-\\pi_t$ 的概率有风险，此时 $Y \\mid \\text{有风险},T=t \\sim \\text{Poisson}(\\lambda_t)$，均值为 $\\lambda_t0$。\n\n- 抽样零机制：在给定 $T=t$ 的条件下，所有患者都有风险，并且 $Y \\mid T=t$ 服从均值为 $\\lambda_t0$、过度离散参数为 $\\kappa0$ 的负二项 (NB) 分布，因此 $P(Y=0 \\mid T=t)0$ 是由抽样变异性引起的。\n\n研究人员拟合了一个标准的对数线性泊松回归模型，$E(Y \\mid T=t)=\\exp(\\beta_0+\\beta_1 t)$，该模型忽略了零膨胀，并将 $\\hat{\\beta}_1$ 报告为治疗的对数率比。然而，他们感兴趣的科学估计量是有风险个体中的对数率比，定义为 $\\theta=\\log(\\lambda_1)-\\log(\\lambda_0)$。\n\n使用混合分布、条件期望以及广义线性模型 (GLM) 对数连接函数性质的基本原理，论证忽略过多零值对 $\\theta$ 估计的影响。特别是，确定在不同机制和参数变化下，$\\hat{\\beta}_1$ 相对于 $\\theta$ 的偏差方向。\n\n以下哪些陈述是正确的？\n\nA. 在结构性零机制中，如果治疗增加了无风险的概率（即 $\\pi_1\\pi_0$），同时保持有风险均值不变（即 $\\lambda_1=\\lambda_0$），那么忽略零膨胀的泊松回归将估计出一个负的治疗对数率比，从而相对于 $\\lambda$ 上的零目标产生虚假的保护效应。\n\nB. 在结构性零机制中，如果两组中无风险的概率相同（即 $\\pi_1=\\pi_0$），并且有风险均值在治疗上是对数线性的（即 $\\lambda_t=\\exp(\\alpha_0+\\alpha_1 t)$），那么忽略零膨胀的泊松回归的治疗系数对于有风险患者的对数率比 $\\theta$ 是无偏的。\n\nC. 当零是由于过度离散（例如，均值为 $\\lambda_t$、离散参数为 $\\kappa$ 的负二项分布）造成的抽样零，并且条件均值被正确地建模为治疗的对数线性函数时，拟合泊松广义线性模型会得到治疗系数对数率比的无偏估计，但会低估其方差；稳健三明治方差或负二项回归可以校正标准误。\n\nD. 无论零是结构性的还是抽样性的，忽略过多的零总是会使治疗效应的估计偏向于零，因为零稀释了均值。\n\nE. 在结构性零机制中，如果治疗既降低了无风险的概率（即 $\\pi_1  \\pi_0$），也降低了有风险均值（即 $\\lambda_1  \\lambda_0$），那么忽略零膨胀的泊松回归系数相对于对 $\\lambda$ 的效应的偏差是偏向于零的，因为在边际均值中，$(1-\\pi)$ 的增加抵消了 $\\lambda$ 的部分减少。",
            "solution": "本题旨在分析当真实数据生成过程（DGP）包含过多零值，而分析时却误用了标准泊松回归模型时，对治疗效应估计产生的偏差。我们将基于广义线性模型（GLM）和拟似然理论来系统地评估每个选项。\n\n首先，我们确定一个关键原则：当使用对数连接函数的GLM时，如泊松回归，其系数估计量 $\\hat{\\beta}_1$ 会一致地估计（即依概率收敛于）真实条件均值的对数比率。即：\n$$ \\hat{\\beta}_1 \\xrightarrow{p} \\beta_{1, \\text{pop}} = \\log(E_{\\text{true}}[Y \\mid T=1]) - \\log(E_{\\text{true}}[Y \\mid T=0]) $$\n我们的目标是比较这个估计值 $\\beta_{1, \\text{pop}}$ 与我们真正感兴趣的科学参数 $\\theta = \\log(\\lambda_1) - \\log(\\lambda_0)$。\n\n我们需要为两种数据生成机制推导真实的条件期望 $E_{\\text{true}}[Y \\mid T=t]$。\n\n**机制1：结构性零 (零膨胀泊松)**\n根据全期望定律，边际期望为：\n$$ E[Y \\mid T=t] = (1-\\pi_t) \\cdot E[Y \\mid \\text{有风险}, T=t] + \\pi_t \\cdot E[Y \\mid \\text{无风险}, T=t] $$\n$$ E[Y \\mid T=t] = (1-\\pi_t)\\lambda_t + \\pi_t \\cdot 0 = (1-\\pi_t)\\lambda_t $$\n因此，泊松回归估计的效应是：\n$$ \\beta_{1, \\text{pop}} = \\log((1-\\pi_1)\\lambda_1) - \\log((1-\\pi_0)\\lambda_0) = \\left(\\log(\\lambda_1) - \\log(\\lambda_0)\\right) + \\left(\\log(1-\\pi_1) - \\log(1-\\pi_0)\\right) $$\n$$ \\beta_{1, \\text{pop}} = \\theta + \\log\\left(\\frac{1-\\pi_1}{1-\\pi_0}\\right) $$\n该估计的渐近偏差为 $\\text{Bias} = \\log\\left(\\frac{1-\\pi_1}{1-\\pi_0}\\right)$。\n\n**机制2：抽样零 (负二项)**\n在这种情况下，DGP的条件均值就是 $\\lambda_t$。\n$$ E[Y \\mid T=t] = \\lambda_t $$\n泊松回归模型假设 $E[Y \\mid T=t] = \\exp(\\beta_0 + \\beta_1 t)$。由于真实条件均值 $E[Y \\mid T=t] = \\lambda_t$ 与泊松回归所假设的均值函数形式一致（假设 $\\lambda_t$ 也是对数线性的），根据拟似然理论，即使分布（方差结构）设定错误，$\\hat{\\beta}_1$ 仍然是 $\\theta$ 的一致估计量。\n因此，$\\beta_{1, \\text{pop}} = \\theta$，渐近偏差为零。\n\n现在我们逐项分析：\n\n**A.** 假设 $\\pi_1 > \\pi_0$ 且 $\\lambda_1 = \\lambda_0$。这意味着真实效应 $\\theta = \\log(\\lambda_0/\\lambda_0) = 0$。泊松回归估计的效应为 $\\beta_{1, \\text{pop}} = 0 + \\log\\left(\\frac{1-\\pi_1}{1-\\pi_0}\\right)$。由于 $\\pi_1 > \\pi_0 \\implies 1-\\pi_1  1-\\pi_0 \\implies \\frac{1-\\pi_1}{1-\\pi_0}  1$，偏差项 $\\log\\left(\\frac{1-\\pi_1}{1-\\pi_0}\\right)$ 为负。因此，$\\beta_{1, \\text{pop}}  0$。模型错误地报告了一个保护性效应，而实际上治疗只是增加了患者无风险的比例。**陈述A是正确的。**\n\n**B.** 假设 $\\pi_1 = \\pi_0 = \\pi$。偏差项变为 $\\log\\left(\\frac{1-\\pi}{1-\\pi}\\right) = \\log(1) = 0$。因此，$\\beta_{1, \\text{pop}} = \\theta$。泊松回归的治疗系数 $\\hat{\\beta}_1$ 是 $\\theta$ 的渐近无偏估计量。**陈述B是正确的。**\n\n**C.** 当DGP是负二项分布（一种过度离散模型）且均值函数被正确设定为对数线性时，泊松回归的系数估计量是一致的（即无偏的）。然而，泊松模型假定方差等于均值，而负二项模型的方差大于均值。这种对方差的错误设定会导致标准误被低估。使用稳健（三明治）方差估计或直接拟合负二项回归模型是修正此问题的标准方法。**陈述C是正确的。**\n\n**D.** 这个强烈的“总是”断言是错误的。陈述C提供了一个反例：在抽样零（负二项）机制下，估计是无偏的，而非偏向于零。此外，在结构性零机制下，偏差的方向取决于治疗如何影响 $\\pi$。例如，如果一个有害的治疗（$\\theta > 0$）同时增加了无风险的概率（$\\pi_1 > \\pi_0$），那么估计的效应 $\\beta_{1, \\text{pop}} = \\theta + (\\text{一个负值})$ 将偏向于零。但如果一个保护性治疗（$\\theta  0$）也增加了无风险概率（$\\pi_1 > \\pi_0$），则估计的效应将比真实效应更负，即偏离零。**陈述D是错误的。**\n\n**E.** 假设 $\\pi_1  \\pi_0$（治疗降低了无风险概率）且 $\\lambda_1  \\lambda_0$（治疗也降低了有风险个体的率）。真实效应 $\\theta = \\log(\\lambda_1/\\lambda_0)$ 是负的。偏差项为 $\\log\\left(\\frac{1-\\pi_1}{1-\\pi_0}\\right)$。由于 $\\pi_1  \\pi_0 \\implies 1-\\pi_1 > 1-\\pi_0 \\implies \\frac{1-\\pi_1}{1-\\pi_0} > 1$，所以偏差项是正的。因此，估计的效应是 $\\beta_{1, \\text{pop}} = \\theta + (\\text{一个正偏差})$。将一个正数加到一个负数上，会使结果更接近零。因此，估计的效应被衰减，即偏向于零。其背后的直观解释是，治疗虽然降低了风险人群的发病率（$\\lambda$ 减少），但也让更多的人进入了风险人群（$1-\\pi$ 增加），这两个效应在边际均值上相互抵消，导致观察到的总体效应小于真实的条件效应。**陈述E是正确的。**\n\n综上所述，陈述A、B、C、E是正确的。",
            "answer": "$$\\boxed{ABCE}$$"
        }
    ]
}