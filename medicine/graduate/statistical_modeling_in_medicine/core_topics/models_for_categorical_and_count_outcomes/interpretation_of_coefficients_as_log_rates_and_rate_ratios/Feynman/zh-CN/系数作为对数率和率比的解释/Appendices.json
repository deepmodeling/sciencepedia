{
    "hands_on_practices": [
        {
            "introduction": "第一个练习侧重于将模型系数与发生率比（Incidence Rate Ratio, IRR）联系起来的基本原理。通过从带有对数连接函数的泊松广义线性模型（Poisson Generalized Linear Model, GLM）的数学结构出发，你将从第一性原理推导出这种关系。这个实践对于理解为何对一个系数取指数会得到该系数对应的协变量变化对事件发生率的乘性效应至关重要。",
            "id": "4967689",
            "problem": "一家医院的感染控制小组对在固定监测期内每个重症监护室观察到的中心静脉置管相关血流感染数量进行建模。对于单元 $i$，观测计数为 $Y_i$，暴露量为总患者日 $E_i$。该小组假设数据生成过程服从泊松分布，并使用一个带有对数连接函数和暴露量偏移量的广义线性模型 (GLM)：\n$$\n\\log(\\mu_i) \\;=\\; \\log(E_i) \\;+\\; \\beta_0 \\;+\\; 0.5\\, X_i,\n$$\n其中 $\\mu_i$ 是单元 $i$ 的期望计数，$X_i$ 是一个连续的、单位标度的侵入性操作风险指数，其构建方式使得 $X_i$ 的 $1$ 个单位变化具有临床意义。模型中没有其他协变量。单元 $i$ 的发病率定义为 $\\lambda_i \\equiv \\mu_i / E_i$。\n\n仅使用带暴露量的计数数据的泊松率的核心定义以及带有对数连接函数和暴露量偏移量的 GLM 结构，推导出发病率 $\\lambda_i$ 作为 $X_i$ 的函数表达式，然后计算当 $X_i$ 增加一个单位时（保持其他所有条件不变）的发病率比 (IRR)。请以精确的解析表达式形式给出 IRR 的最终答案（不要进行数值近似）。最终答案不需要单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 单元 $i$ 的观测计数为 $Y_i$。\n- 单元 $i$ 的暴露量是总患者日，$E_i$。\n- 数据生成过程假设为泊松过程。\n- 带有对数连接函数和暴露量偏移量的广义线性模型 (GLM) 是：\n$$\n\\log(\\mu_i) \\;=\\; \\log(E_i) \\;+\\; \\beta_0 \\;+\\; 0.5\\, X_i\n$$\n- $\\mu_i$ 是单元 $i$ 的期望计数。\n- $X_i$ 是一个连续的、单位标度的风险指数。\n- 单元 $i$ 的发病率定义为 $\\lambda_i \\equiv \\mu_i / E_i$。\n- 目标是推导出发病率 $\\lambda_i$ 的表达式，并计算 $X_i$ 增加一个单位时的发病率比 (IRR)。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在科学和统计上是合理的。它描述了一个标准的泊松回归模型，这是生物统计学和流行病学中分析带相应暴露变量的计数数据的基本工具。使用对数连接函数和暴露量偏移项是建模率的经典方法。\n- **适定性**：该问题是适定的。它提供了一个具体的模型方程和清晰的定义，可以通过直接的数学推导得出所需的量（$\\lambda_i$ 和 IRR）。在统计建模的背景下，解是唯一的且有意义的。\n- **客观性**：问题以统计学和流行病学中常见的精确、客观的语言陈述。诸如“泊松数据生成过程”、“对数连接函数”和“发病率比”等术语具有标准的、明确的定义。\n- **不完整或矛盾的设置**：问题是自洽且一致的。所有进行推导所需的信息都已提供。模型结构是标准的且内部一致。\n- **不切实际或不可行**：该场景是此统计模型的经典且现实的应用。所有量都以符号形式或以合理的系数给出，因此不存在数据真实性的问题。\n- **不适定或结构不良**：问题结构清晰，没有歧义。\n- **结论**：问题有效。\n\n### 步骤 3：结论与行动\n问题有效，将提供解答。\n\n### 解题推导\n该问题要求基于所提供的模型结构进行两项推导。\n\n首先，我们推导出发病率 $\\lambda_i$ 作为风险指数 $X_i$ 的函数表达式。我们从给定的模型方程开始：\n$$\n\\log(\\mu_i) = \\log(E_i) + \\beta_0 + 0.5\\, X_i\n$$\n为了找到与发病率 $\\lambda_i \\equiv \\mu_i / E_i$ 相关的表达式，我们可以通过从方程两边减去偏移项 $\\log(E_i)$ 来重新整理方程：\n$$\n\\log(\\mu_i) - \\log(E_i) = \\beta_0 + 0.5\\, X_i\n$$\n使用对数性质 $\\log(a) - \\log(b) = \\log(a/b)$，方程的左侧可以重写为：\n$$\n\\log\\left(\\frac{\\mu_i}{E_i}\\right) = \\beta_0 + 0.5\\, X_i\n$$\n根据所给的发病率定义 $\\lambda_i = \\mu_i / E_i$。将其代入方程得到：\n$$\n\\log(\\lambda_i) = \\beta_0 + 0.5\\, X_i\n$$\n这个方程表明，该模型是关于发病率 $\\lambda_i$ 的一个对数线性模型。为了求解 $\\lambda_i$，我们对等式两边取自然指数：\n$$\n\\exp(\\log(\\lambda_i)) = \\exp(\\beta_0 + 0.5\\, X_i)\n$$\n由于指数函数是自然对数的反函数，上式简化为：\n$$\n\\lambda_i = \\exp(\\beta_0 + 0.5\\, X_i)\n$$\n这就是发病率 $\\lambda_i$ 作为 $X_i$ 的函数表达式。\n\n其次，我们计算 $X_i$ 增加一个单位时的发病率比 (IRR)。IRR 是某个预测变量水平下的发病率与基线水平下的发病率之比。在这里，我们关心的是将 $X_i$ 增加 $1$ 个单位的效果。\n\n设 $\\lambda_i$ 是对应于风险指数 $X_i$ 的率，如上所推导：\n$$\n\\lambda_i = \\exp(\\beta_0 + 0.5\\, X_i)\n$$\n设 $\\lambda_i'$ 是对应于风险指数为 $X_i + 1$ 的新率：\n$$\n\\lambda_i' = \\exp\\left(\\beta_0 + 0.5\\, (X_i + 1)\\right)\n$$\nIRR 是比率 $\\lambda_i' / \\lambda_i$：\n$$\n\\text{IRR} = \\frac{\\lambda_i'}{\\lambda_i} = \\frac{\\exp\\left(\\beta_0 + 0.5\\, (X_i + 1)\\right)}{\\exp(\\beta_0 + 0.5\\, X_i)}\n$$\n使用指数性质 $a^m / a^n = a^{m-n}$，该表达式简化为：\n$$\n\\text{IRR} = \\exp\\left( (\\beta_0 + 0.5\\, (X_i + 1)) - (\\beta_0 + 0.5\\, X_i) \\right)\n$$\n我们简化指数中的表达式：\n$$\n(\\beta_0 + 0.5\\, X_i + 0.5) - \\beta_0 - 0.5\\, X_i = 0.5\n$$\n因此，发病率比为：\n$$\n\\text{IRR} = \\exp(0.5)\n$$\n这个结果展示了对数线性模型的一个通用性质：对于系数为 $\\beta$ 的预测变量 $X$， $X$ 每增加一个单位，率比为 $\\exp(\\beta)$。在本例中，$X_i$ 的系数明确给出为 $0.5$。最终答案是该值的精确解析表达式。",
            "answer": "$$\n\\boxed{\\exp(0.5)}\n$$"
        },
        {
            "introduction": "在发生率比（IRR）的基本概念之上，下一个问题将模型置于一个真实的临床情境中。你将使用模型的截距和系数来计算特定患者的发生率，然后预测其在给定时间内的预期事件数。这个练习搭建了从解释单个系数到应用完整模型进行预测的桥梁，展示了如何将理论模型转化为具体的临床预测。",
            "id": "4967677",
            "problem": "在一项关于慢性阻塞性肺疾病急性加重的纵向研究中，临床医生记录了每位参与者在观察随访期内需要全身性皮质类固醇治疗的急性加重次数。对于随访时间可能不等的罕见事件，假设可以用泊松过程来建模计数，其中在由标量协变量 $X$ 定义的分层内，事件发生率是恒定的。使用具有标准对数连接函数的广义线性模型 (GLM) 来关联发病率与 $X$，当 $X$ 每增加 $1$ 个单位时，其估计系数为 $\\beta = 0.2$。当 $X=0$ 时的基线发病率估计为每年人均 $0.08$ 次事件。\n\n一位新患者的 $X=3$，观察时间为 $2.5$ 人年。仅使用发病率作为单位时间预期事件数的核心定义以及具有对数连接函数的泊松 GLM 结构，从第一性原理出发，推导该患者的预期急性加重次数，清楚阐明为什么系数 $\\beta$ 代表对数发病率尺度上的变化，以及这如何意味着发病率尺度上的乘法变化。然后，为该患者数值计算预期事件数。将最终数值答案四舍五入至四位有效数字。将最终预期计数表示为纯数（无单位）。",
            "solution": "该问题要求基于具有对数连接函数的泊松广义线性模型（GLM），推导并计算一位患者的预期急性加重次数。推导必须从第一性原理开始。\n\n设 $Y$ 为观察到的患者急性加重（事件）次数的随机变量，设 $t$ 为观察期持续时间，单位为人年。问题指出，计数被建模为源自泊松过程。这意味着，对于一个具有恒定发病率 $\\lambda$（单位时间的预期事件数）的给定患者，在时间段 $t$ 内的事件数 $Y$ 服从均值为 $\\mu$ 的泊松分布。平均计数 $\\mu$ 和发病率 $\\lambda$ 之间的关系由率的核心定义给出：\n$$ \\mu = E[Y] = \\lambda \\times t $$\n\n问题指定使用具有标准对数连接函数的 GLM 来建模发病率 $\\lambda$ 和标量协变量 $X$ 之间的关系。GLM 的一般结构包括三个组成部分：随机部分（响应的分布）、系统部分（线性预测器）和连接函数。\n1.  **随机部分**：事件数 $Y$ 服从泊松分布，$Y \\sim \\text{Poisson}(\\mu)$。\n2.  **系统部分**：线性预测器 $\\eta$ 是协变量的线性函数。在本例中，$\\eta = \\beta_0 + \\beta X$，其中 $\\beta_0$ 是截距，$\\beta$ 是协变量 $X$ 的系数。\n3.  **连接函数**：泊松分布的标准连接函数是自然对数。它将响应的期望值与线性预测器联系起来。在建模率时，模型中会包含暴露时间 $t$ 的偏移项，用于预期计数 $\\mu$。模型为：\n    $$ \\ln(\\mu) = \\eta + \\ln(t) = \\beta_0 + \\beta X + \\ln(t) $$\n    其中 $\\ln(t)$ 是偏移项，即一个系数被约束为 $1$ 的预测变量。\n\n从这些第一性原理出发，我们可以推导出率 $\\lambda$ 的模型。通过重新排列方程：\n$$ \\ln(\\mu) - \\ln(t) = \\beta_0 + \\beta X $$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到：\n$$ \\ln\\left(\\frac{\\mu}{t}\\right) = \\beta_0 + \\beta X $$\n由于 $\\lambda = \\mu/t$，发病率的模型为：\n$$ \\ln(\\lambda) = \\beta_0 + \\beta X $$\n这个方程表明，GLM 直接将发病率的对数建模为协变量 $X$ 的线性函数。\n\n为了阐明为什么系数 $\\beta$ 代表对数发病率尺度上的变化，我们考虑当 $X$ 增加一个单位时对数率的变化。设 $\\lambda(X)$ 为协变量值为 $X$ 的患者的发病率。\n该患者的对数率为 $\\ln(\\lambda(X)) = \\beta_0 + \\beta X$。\n对于协变量值为 $X+1$ 的另一位患者，对数率为 $\\ln(\\lambda(X+1)) = \\beta_0 + \\beta(X+1) = \\beta_0 + \\beta X + \\beta$。\n对数率的差异是：\n$$ \\ln(\\lambda(X+1)) - \\ln(\\lambda(X)) = (\\beta_0 + \\beta X + \\beta) - (\\beta_0 + \\beta X) = \\beta $$\n这个恒等式证明了，当 $X$ 每增加一个单位时，$\\beta$ 是*发病率对数*的加性变化量。\n\n为了说明这如何意味着在发病率尺度上的乘法变化，我们对上面推导的关系取指数。再次从对数率的差异开始：\n$$ \\ln(\\lambda(X+1)) - \\ln(\\lambda(X)) = \\beta $$\n应用对数法则 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$ \\ln\\left(\\frac{\\lambda(X+1)}{\\lambda(X)}\\right) = \\beta $$\n对两边以 $e$ 为底取指数，得到率的比值：\n$$ \\frac{\\lambda(X+1)}{\\lambda(X)} = \\exp(\\beta) $$\n这个比值，被称为发病率比（IRR），表明当 $X$ 每增加一个单位时，发病率 $\\lambda$ 乘以一个因子 $\\exp(\\beta)$。\n\n现在，我们为新患者计算预期事件数。\n首先，我们确定模型参数 $\\beta_0$ 和 $\\beta$。给定 $\\beta = 0.2$。还给定在 $X=0$ 时的基线发病率为 $\\lambda_0 = 0.08$ 事件/人年。使用模型方程：\n$$ \\ln(\\lambda_0) = \\beta_0 + \\beta \\times 0 \\implies \\ln(0.08) = \\beta_0 $$\n因此，对数率的完整模型是：\n$$ \\ln(\\lambda) = \\ln(0.08) + 0.2 X $$\n新患者的协变量值为 $X_{new} = 3$。我们求出其特定的发病率 $\\lambda_{new}$：\n$$ \\ln(\\lambda_{new}) = \\ln(0.08) + 0.2 \\times 3 = \\ln(0.08) + 0.6 $$\n为了求出发病率 $\\lambda_{new}$，我们取指数：\n$$ \\lambda_{new} = \\exp(\\ln(0.08) + 0.6) = \\exp(\\ln(0.08)) \\times \\exp(0.6) = 0.08 \\times \\exp(0.6) $$\n该患者被观察了 $t_{new} = 2.5$ 人年。预期的急性加重次数 $\\mu_{new}$ 是其发病率和观察时间的乘积：\n$$ \\mu_{new} = \\lambda_{new} \\times t_{new} = (0.08 \\times \\exp(0.6)) \\times 2.5 $$\n我们可以重新排列并计算数值：\n$$ \\mu_{new} = 0.08 \\times 2.5 \\times \\exp(0.6) = 0.2 \\times \\exp(0.6) $$\n计算 $\\exp(0.6)$ 的值：\n$$ \\exp(0.6) \\approx 1.8221188 $$\n因此，预期的事件数是：\n$$ \\mu_{new} \\approx 0.2 \\times 1.8221188 = 0.36442376 $$\n问题要求将结果四舍五入到四位有效数字。前四位有效数字是 $3$、$6$、$4$ 和 $4$。第五位数字是 $2$，所以我们向下舍入。\n$$ \\mu_{new} \\approx 0.3644 $$\n该患者的预期急性加重次数为 $0.3644$。",
            "answer": "$$\\boxed{0.3644}$$"
        },
        {
            "introduction": "最后一个实践解决了一个在应用建模中至关重要且常见的问题：确保时间单位的一致性。当模型中作为偏移量的暴露时间以一种单位（例如，月）衡量，而我们感兴趣的率是另一种单位（例如，年）时，必须进行仔细的转换。本练习将指导你如何正确调整模型的截距 $\\alpha$，以报告符合要求单位的基线率，这是确保模型解释和结果报告准确性的一项关键技能。",
            "id": "4967660",
            "problem": "一项针对慢性阻塞性肺疾病患者的队列研究旨在模拟每位患者在随访期间经历的急性加重住院次数。对于患者 $i$，令 $Y_i$ 表示急性加重住院的次数，令 $E_i$ 表示以月为单位测量的随访时间。使用具有泊松分布和对数连接函数的广义线性模型对数据进行拟合，并为暴露时间指定一个偏移量，具体如下：\n$$\n\\ln\\!\\big(\\mathbb{E}[Y_i]\\big) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i),\n$$\n其中，$X_{1i}$ 是当前吸烟状况的指示变量（如果当前吸烟，则 $X_{1i}=1$，否则 $X_{1i}=0$），$X_{2i}$ 是基线肺功能的标准化连续协变量。拟合得到的系数为：\n$$\n\\hat{\\alpha} \\;=\\; -3.2,\\quad \\hat{\\beta}_1 \\;=\\; 0.4055,\\quad \\hat{\\beta}_2 \\;=\\; -0.2231.\n$$\n\n请使用带对数连接和暴露偏移量的泊松均值结构的基本定义，并仔细考虑偏移量 $E_i$ 的时间单位是月，通过将截距适当地转换为以年为单位的时间，计算参考概况（$X_{1i}=0$ 和 $X_{2i}=0$）的基线期望事件率（每人年）。以事件/人年为单位表示您的答案，并将答案四舍五入到 $4$ 位有效数字。不要提供任何中间率；仅报告年度基线率作为您的最终数值。",
            "solution": "所给问题是统计建模原则的有效应用，并且是良定的。获得唯一解所需的所有数据和条件均已提供，问题陈述在科学上是合理的，其依据是广义线性模型的既定理论。\n\n该问题为患者 $i$ 在 $E_i$ 个月的随访期内的住院次数 $Y_i$ 指定了一个泊松回归模型。该模型由下式给出：\n$$\n\\ln\\!\\big(\\mathbb{E}[Y_i]\\big) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i)\n$$\n此处，$\\mathbb{E}[Y_i]$ 是患者 $i$ 在其特定随访时间 $E_i$ 内的期望事件数。我们记为 $\\lambda_i$ 的事件率是每单位时间的期望事件数。由于暴露时间 $E_i$ 以月为单位，$\\lambda_i$ 代表每人月的事件率。期望计数、率和暴露时间之间的关系是：\n$$\n\\mathbb{E}[Y_i] \\;=\\; \\lambda_i \\times E_i\n$$\n我们可以将这个定义代入模型方程中：\n$$\n\\ln(\\lambda_i \\times E_i) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i)\n$$\n根据对数性质 $\\ln(ab) = \\ln(a) + \\ln(b)$，方程左边变为：\n$$\n\\ln(\\lambda_i) + \\ln(E_i) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i} \\;+\\; \\ln(E_i)\n$$\n方程两边都出现了 $\\ln(E_i)$ 项，可以消去。这揭示了事件率本身的潜在模型：\n$$\n\\ln(\\lambda_i) \\;=\\; \\alpha \\;+\\; \\beta_1 X_{1i} \\;+\\; \\beta_2 X_{2i}\n$$\n该方程表明，协变量的线性组合模拟了每月事件率的自然对数。\n\n问题要求计算基线期望事件率。基线（或参考）概况对应于所有协变量都设置为其参考水平的患者。在本例中，这是一个非吸烟者（$X_{1i}=0$），且具有平均基线肺功能（$X_{2i}=0$，因为它是一个标准化协变量）。\n\n令 $\\lambda_{\\text{base, month}}$ 为每人月的基线事件率。我们可以通过将 $X_{1i}=0$ 和 $X_{2i}=0$ 代入对数率模型来求其值：\n$$\n\\ln(\\lambda_{\\text{base, month}}) \\;=\\; \\alpha \\;+\\; \\beta_1 (0) \\;+\\; \\beta_2 (0) \\;=\\; \\alpha\n$$\n为了求出率本身，我们对两边取指数：\n$$\n\\lambda_{\\text{base, month}} \\;=\\; \\exp(\\alpha)\n$$\n使用提供的截距估计值 $\\hat{\\alpha} = -3.2$，估计的每月基线率为：\n$$\n\\hat{\\lambda}_{\\text{base, month}} \\;=\\; \\exp(-3.2)\n$$\n问题要求基线率以事件/人年表示，而不是每人月。令 $\\hat{\\lambda}_{\\text{base, year}}$ 为年度估计基线率。由于一年有 $12$ 个月，我们必须将月率乘以 $12$：\n$$\n\\hat{\\lambda}_{\\text{base, year}} \\;=\\; \\hat{\\lambda}_{\\text{base, month}} \\times 12 \\;=\\; 12 \\times \\exp(-3.2)\n$$\n现在，我们计算其数值：\n$$\n\\hat{\\lambda}_{\\text{base, year}} \\;=\\; 12 \\times \\exp(-3.2) \\approx 12 \\times 0.0407622... \\approx 0.4891464...\n$$\n问题要求最终答案四舍五入到 $4$ 位有效数字。$0.4891464...$ 的前四位有效数字是 $4$、$8$、$9$ 和 $1$。第五位有效数字是 $4$，小于 $5$，所以我们向下舍入。\n$$\n\\hat{\\lambda}_{\\text{base, year}} \\approx 0.4891\n$$\n因此，基线期望事件率为 $0.4891$ 次急性加重住院/人年。",
            "answer": "$$\\boxed{0.4891}$$"
        }
    ]
}