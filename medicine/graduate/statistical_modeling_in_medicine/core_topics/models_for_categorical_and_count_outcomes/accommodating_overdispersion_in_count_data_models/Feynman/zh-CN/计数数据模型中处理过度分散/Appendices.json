{
    "hands_on_practices": [
        {
            "introduction": "在处理医学计数数据时，我们经常观察到“零膨胀”现象，即零值的数量远超标准泊松分布的预期。零膨胀泊松 (ZIP) 模型为这种情况提供了直观的解释，它假设数据来自两个群体的混合：一个是从不会发生事件的“结构性零”群体，另一个是事件发生遵循泊松过程的“风险”群体。通过从第一性原理出发推导 ZIP 分布的均值和方差 ，我们可以清晰地看到这种混合结构如何自然地导致数据方差大于均值，从而产生过度离散。这项练习旨在帮助你建立对过度离散来源的深刻理解，这是选择更复杂模型之前至关重要的一步。",
            "id": "4950089",
            "problem": "在一项针对慢性阻塞性肺疾病患者的纵向研究中，临床医生记录了每位患者在固定的$1$年期间内经历的急性加重次数。为了处理因患者没有加重风险（例如，由于稳定的表型或持续坚持预防性治疗）而产生的结构性零，使用零膨胀泊松 (ZIP) 模型来对计数 $Y$ 进行建模。设结构性零指示变量 $Z$ 是一个潜变量，服从 $Z \\sim \\text{Bernoulli}(\\pi)$ 分布，其中 $Z=1$ 表示结构性零，$Z=0$ 表示易于发生事件。在给定 $Z$ 的条件下，定义\n- $Y \\mid Z=1 = 0$ 几乎必然成立，且\n- $Y \\mid Z=0 \\sim \\text{Poisson}(\\lambda)$,\n其中 $Z$ 与泊松部分独立。这里，$\\pi \\in [0,1)$ 是结构性零的概率，$\\lambda>0$ 是易感患者中的泊松率。\n\n仅从基本概率定律以及泊松分布的均值和方差均等于其率的核心性质出发，推导 $Y$ 的无条件均值 $\\mathbb{E}[Y]$ 和方差 $\\operatorname{Var}(Y)$ 关于 $\\pi$ 和 $\\lambda$ 的闭式表达式。然后，解释与具有相同均值的非膨胀泊松模型相比，结构性零的存在如何导致离散度的增加。\n\n将您的最终答案以一个包含均值和方差的单行矩阵对的形式给出。不需要进行数值计算。",
            "solution": "问题陈述是一个在初等概率论和统计建模中提法恰当且具有科学依据的练习。所有组成部分都得到了明确定义，其前提与零膨胀泊松 (ZIP) 模型的既定公式一致。因此，该问题是有效的。我们着手进行推导。\n\n随机变量 $Y$ 代表急性加重的次数。其分布是由一个潜伯努利变量 $Z$ 决定的混合分布。给定的性质如下：\n- $Z \\sim \\text{Bernoulli}(\\pi)$，使得 $P(Z=1) = \\pi$ 且 $P(Z=0) = 1-\\pi$。\n- $Y$ 在给定 $Z$ 下的条件分布为：\n  - $Y \\mid Z=1 = 0$（在 $0$ 处的点质量）。\n  - $Y \\mid Z=0 \\sim \\text{Poisson}(\\lambda)$。\n- 泊松($\\mu$)分布的核心性质是 $\\mathbb{E}[\\text{Poisson}(\\mu)] = \\mu$ 和 $\\operatorname{Var}(\\text{Poisson}(\\mu)) = \\mu$。\n\n我们的目标是求出无条件均值 $\\mathbb{E}[Y]$ 和无条件方差 $\\operatorname{Var}(Y)$。\n\n**1. 均值 $\\mathbb{E}[Y]$ 的推导**\n\n我们使用全期望定律，即 $\\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y \\mid Z]]$。\n首先，我们计算对于 $Z$ 的每个可能值的条件期望 $\\mathbb{E}[Y \\mid Z]$。\n- 如果 $Z=1$，计数 $Y$ 固定为 $0$。因此，其期望为 $\\mathbb{E}[Y \\mid Z=1] = 0$。\n- 如果 $Z=0$，计数 $Y$ 服从率为 $\\lambda$ 的泊松分布。因此，其期望为 $\\mathbb{E}[Y \\mid Z=0] = \\lambda$。\n\n表达式 $\\mathbb{E}[Y \\mid Z]$ 本身是一个随机变量，它以概率 $P(Z=1) = \\pi$ 取值 $0$，以概率 $P(Z=0) = 1-\\pi$ 取值 $\\lambda$。\n现在，我们对这个随机变量关于 $Z$ 的分布求期望：\n$$ \\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{E}[Y \\mid Z]] = \\mathbb{E}[Y \\mid Z=0] \\cdot P(Z=0) + \\mathbb{E}[Y \\mid Z=1] \\cdot P(Z=1) $$\n代入我们求得的值：\n$$ \\mathbb{E}[Y] = \\lambda \\cdot (1-\\pi) + 0 \\cdot \\pi = \\lambda(1-\\pi) $$\n这就是服从 ZIP 分布的随机变量 $Y$ 的无条件均值。\n\n**2. 方差 $\\operatorname{Var}(Y)$ 的推导**\n\n我们使用全方差定律，即：\n$$ \\operatorname{Var}(Y) = \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] + \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) $$\n我们将分别计算这两项。\n\n**第1项：$\\mathbb{E}[\\operatorname{Var}(Y \\mid Z)]$ (条件方差的期望)**\n\n首先，我们求出对于 $Z$ 的每个值的条件方差 $\\operatorname{Var}(Y \\mid Z)$。\n- 如果 $Z=1$，计数 $Y$ 固定为常数 $0$。常数的方差为 $0$，所以 $\\operatorname{Var}(Y \\mid Z=1) = 0$。\n- 如果 $Z=0$，计数 $Y$ 服从率为 $\\lambda$ 的泊松分布。泊松($\\lambda$)分布的方差等于其率，所以 $\\operatorname{Var}(Y \\mid Z=0) = \\lambda$。\n\n表达式 $\\operatorname{Var}(Y \\mid Z)$ 是一个随机变量，以概率 $\\pi$ 取值 $0$，以概率 $1-\\pi$ 取值 $\\lambda$。我们计算其期望：\n$$ \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] = \\operatorname{Var}(Y \\mid Z=0) \\cdot P(Z=0) + \\operatorname{Var}(Y \\mid Z=1) \\cdot P(Z=1) $$\n$$ \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] = \\lambda \\cdot (1-\\pi) + 0 \\cdot \\pi = \\lambda(1-\\pi) $$\n\n**第2项：$\\operatorname{Var}(\\mathbb{E}[Y \\mid Z])$ (条件期望的方差)**\n\n如前所述，$\\mathbb{E}[Y \\mid Z]$ 是一个随机变量，以概率 $1-\\pi$ 取值 $\\lambda$，以概率 $\\pi$ 取值 $0$。我们称这个类伯努利随机变量为 $W$。我们需要求出其方差 $\\operatorname{Var}(W)$。\n方差由 $\\operatorname{Var}(W) = \\mathbb{E}[W^2] - (\\mathbb{E}[W])^2$ 给出。\n我们已经知道 $W$ 的均值：$\\mathbb{E}[W] = \\mathbb{E}[\\mathbb{E}[Y \\mid Z]] = \\mathbb{E}[Y] = \\lambda(1-\\pi)$。\n接下来，我们计算二阶矩 $\\mathbb{E}[W^2]$：\n$$ \\mathbb{E}[W^2] = (\\lambda)^2 \\cdot P(Z=0) + (0)^2 \\cdot P(Z=1) = \\lambda^2(1-\\pi) + 0 = \\lambda^2(1-\\pi) $$\n现在我们可以计算 $W$ 的方差：\n$$ \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) = \\operatorname{Var}(W) = \\mathbb{E}[W^2] - (\\mathbb{E}[W])^2 $$\n$$ \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) = \\lambda^2(1-\\pi) - (\\lambda(1-\\pi))^2 $$\n$$ \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) = \\lambda^2(1-\\pi) - \\lambda^2(1-\\pi)^2 = \\lambda^2(1-\\pi) [1 - (1-\\pi)] = \\lambda^2\\pi(1-\\pi) $$\n\n**合并各项：**\n\n最后，我们将两项相加得到 $Y$ 的无条件方差：\n$$ \\operatorname{Var}(Y) = \\mathbb{E}[\\operatorname{Var}(Y \\mid Z)] + \\operatorname{Var}(\\mathbb{E}[Y \\mid Z]) $$\n$$ \\operatorname{Var}(Y) = \\lambda(1-\\pi) + \\lambda^2\\pi(1-\\pi) $$\n我们可以对这个表达式进行因式分解，以获得更紧凑的形式：\n$$ \\operatorname{Var}(Y) = \\lambda(1-\\pi) (1 + \\lambda\\pi) $$\n\n**3. 离散度的解释**\n\n设 $\\mu_Y = \\mathbb{E}[Y] = \\lambda(1-\\pi)$ 为服从 ZIP 分布的变量 $Y$ 的均值。\n一个具有相同均值的标准（非膨胀）泊松模型，其率参数应等于 $\\mu_Y$。对于这样一个泊松模型，假设随机变量为 $Y_P \\sim \\text{Poisson}(\\mu_Y)$，其方差等于均值：\n$$ \\operatorname{Var}(Y_P) = \\mu_Y = \\lambda(1-\\pi) $$\n现在，我们将其与我们的 ZIP 模型的方差 $\\operatorname{Var}(Y)$ 进行比较：\n$$ \\operatorname{Var}(Y) = \\lambda(1-\\pi) + \\lambda^2\\pi(1-\\pi) = \\mu_Y + \\lambda^2\\pi(1-\\pi) $$\n项 $\\lambda^2\\pi(1-\\pi)$ 代表了由零膨胀部分对方差的贡献。\n在约束条件 $\\lambda > 0$ 和 $\\pi \\in [0,1)$ 下，这一项是非负的。\n- 如果 $\\pi = 0$，则没有零膨胀。ZIP 模型退化为标准的泊松($\\lambda$)模型，且 $\\operatorname{Var}(Y) = \\mu_Y$。\n- 如果 $\\pi \\in (0,1)$，则项 $\\lambda^2\\pi(1-\\pi)$ 是严格为正的。因此，$\\operatorname{Var}(Y) > \\mu_Y$。\n\n这种方差超过均值的情况被称为**过度离散 (overdispersion)**。结构性零 ($\\pi > 0$) 的存在为总体引入了额外的变异来源。该总体是两个群体的异质混合体：一个“从不发生事件”群组和一个“有风险”群组。这种异质性使得总方差膨胀，超过了具有相同平均事件率的同质泊松过程所预期的方差。量 $\\lambda^2\\pi(1-\\pi)$ 精确地量化了由潜在混合结构引起的这种额外方差。\n\n最终推导出的均值和方差表达式为：\n均值：$\\mathbb{E}[Y] = \\lambda(1-\\pi)$\n方差：$\\operatorname{Var}(Y) = \\lambda(1-\\pi)(1 + \\lambda\\pi)$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\lambda(1-\\pi) & \\lambda(1-\\pi)(1+\\lambda\\pi) \\end{pmatrix}}$$"
        },
        {
            "introduction": "在实践中，诊断过度离散并不仅仅是计算一个方差与均值的比率。标准的离散度统计量，如皮尔逊卡方统计量和偏差统计量，可能会被少数极端异常值或高杠杆点“污染”，从而给出过度离散的虚假信号。这项练习  挑战你超越简单的诊断指标，批判性地思考过度离散的真正来源。你将学习如何区分由少数影响点驱动的“伪”过度离散和数据中普遍存在的“真”过度离散，并探索用于进行稳健诊断的实用策略，确保模型选择的正确性。",
            "id": "4822247",
            "problem": "一家医院的感染控制团队分析了在 $n=240$ 个病房-月中耐甲氧西林金黄色葡萄球菌病例的月度计数，暴露偏移量由患者-天数给出。他们为计数结果拟合了一个带有对数连接的泊松广义线性模型，其中有 $p=6$ 个回归系数，包括一个截距和对数偏移量。泊松诊断显示，皮尔逊离散度估计和基于偏差的离散度估计都显著高于 $1$（例如，比率分别约为 $2.8$ 和 $3.1$）。仔细观察残差图发现，少数几个观测值具有非常大的绝对偏差残差（超过 $4$），并且由于极端的协变量模式和非常小的暴露偏移量而具有异常高的杠杆值。\n\n从医学结果中计数数据的广义线性模型的基本原理出发，解释为什么大残差或杠杆点会夸大皮尔逊和偏差离散度诊断结果，并指出有哪些稳健的基于残差的检查方法有助于确认过度离散是普遍存在的，而不是由少数有影响力的观测值驱动的。下列哪些陈述最为恰当？\n\nA. 皮尔逊和偏差离散度诊断汇总了残差的贡献，这些贡献随着观测计数和拟合计数之间差异的增大而迅速增加，因此少数几个大残差可以主导这些总和；高杠杆值观测值也可能扭曲许多其他观测值的拟合均值，从而夸大全局离散度诊断。稳健的检查方法包括对一小部分最大的绝对偏差或皮尔逊残差进行修剪或缩尾处理，然后重新计算离散度；如果修剪后的离散度仍然远高于 $1$，这支持了真实的过度离散超出了少数几个有影响力的点。\n\nB. 对离散度估计值进行留一法敏感性分析，即 $\\hat{\\phi}_{(-i)}$，可以揭示是否有一小部分观测值导致了夸大；用基于残差的稳健尺度估计量来补充这一分析，例如根据泊松参考进行缩放的皮尔逊残差平方的中位数，或者Huber化的残差平方和，以在评估离散度时减弱离群值的影响。\n\nC. 如果负二项回归的赤池信息准则 (AIC) 低于泊松模型，那么过度离散必定是真实的，而不是由杠杆值或模型设定错误引起的，因此基于残差的检查是不必要的。\n\nD. 对计数应用对数变换并拟合普通最小二乘法，可以保证在变换尺度上的同方差性；因此，由皮尔逊或偏差诊断检测到的任何泊松过度离散都是伪的，可以忽略基于残差的过度离散检查。\n\nE. 可以使用在拟合的泊松模型下的参数自举法来近似一个稳健离散度统计量（例如，平方偏差残差的 $10\\%$ 修剪均值）的抽样分布；将观测到的稳健统计量与自举参照进行比较，并在暂时排除杠杆值高于预设阈值的点后检查残差与拟合值图，可以为残差方差是否仍随均值增加（与真实的过度离散一致）提供证据。\n\n选择所有适用的选项。",
            "solution": "该问题陈述提出了一个在应用统计学中有效且经典的问题，特别是在计数数据的广义线性模型 (GLM) 的背景下。所描述的情景——诊断泊松回归中的过度离散，并区分普遍存在的过度离散和由有影响力的离群值引起的假象——在流行病学和医学等领域是一项关键任务。所提供的数据和观察结果在内部是一致的，并且在科学上是合理的。\n\n### 问题陈述的验证\n\n**步骤1：提取给定信息**\n-   **模型：** 带有对数连接的泊松广义线性模型。\n-   **数据：** 耐甲氧西林金黄色葡萄球菌 (MRSA) 病例的月度计数。\n-   **样本量：** $n=240$ 个病房-月。\n-   **暴露：** 患者-天数，在模型中用作对数偏移量。\n-   **模型复杂度：** $p=6$ 个回归系数，包括一个截距和对数偏移项。\n-   **诊断发现1：** 皮尔逊离散度估计值远大于 $1$（例如，$\\approx 2.8$）。\n-   **诊断发现2：** 基于偏差的离散度估计值远大于 $1$（例如，$\\approx 3.1$）。\n-   **诊断发现3：** 残差图显示少数观测值具有非常大的绝对偏差残差（$>4$）。\n-   **诊断发现4：** 这些特定的观测值由于极端的协变量模式和非常小的暴露偏移量而具有异常高的杠杆值。\n\n**步骤2：使用提取的信息进行验证**\n-   **科学依据充分：** 该问题牢固地植根于广义线性模型的理论，这是现代统计推断的基石。泊松回归、过度离散、皮尔逊和偏差统计量、残差和杠杆值等概念都是标准内容。应用于医院感染数据的案例是一个教科书式的例子。\n-   **问题定义明确：** 该问题要求解释一种统计现象并确定适当的诊断方法。它清晰、具体，并且基于已建立的统计原则有明确的答案。\n-   **客观性：** 语言正式、客观，使用标准术语，没有歧义或主观论断。\n\n**步骤3：结论和行动**\n问题陈述有效。我将进行完整解答。\n\n### 从基本原理推导\n\n在泊松GLM中，观测值 $i$ 的计数结果 $Y_i$ 假定服从泊松分布，$Y_i \\sim \\text{Poisson}(\\mu_i)$。泊松分布的一个关键特征是其方差等于其均值：$\\text{Var}(Y_i) = \\mu_i$。该模型通过一个连接函数将均值 $\\mu_i$ 与一组预测变量 $\\mathbf{x}_i$ 联系起来，通常是对数连接：\n$$ \\log(\\mu_i) = \\mathbf{x}_i^T \\boldsymbol{\\beta} $$\n在这个问题中，一个暴露项 $E_i$（患者-天数）被作为偏移量包含在内，因此模型是：\n$$ \\log(\\mu_i) = \\log(E_i) + \\mathbf{x}_i^T \\boldsymbol{\\beta}' \\implies \\mu_i = E_i \\exp(\\mathbf{x}_i^T \\boldsymbol{\\beta}') $$\n其中 $\\boldsymbol{\\beta}'$ 表示除偏移量外的 $p-1$ 个预测变量的系数。\n\n当数据中观测到的方差大于模型假设的方差时，就会发生过度离散。对于泊松模型，这意味着实际方差大于均值，即 $\\text{Var}(Y_i) > \\mu_i$。这通常被建模为 $\\text{Var}(Y_i) = \\phi \\mu_i$，其中 $\\phi > 1$ 是离散参数。\n\n在拟合模型得到估计均值 $\\hat{\\mu}_i$ 后，常用两个统计量来估计 $\\phi$：\n\n1.  **皮尔逊卡方统计量：** 这是皮尔逊残差平方和：\n    $$ \\chi^2 = \\sum_{i=1}^{n} \\frac{(y_i - \\hat{\\mu}_i)^2}{\\hat{\\mu}_i} $$\n    皮尔逊离散度估计值为 $\\hat{\\phi}_P = \\frac{\\chi^2}{df}$，其中自由度 $df = n - p$。\n\n2.  **偏差统计量：** 这基于拟合模型和饱和模型（一个完美拟合数据的模型）的对数似然之差：\n    $$ D = 2 \\sum_{i=1}^{n} \\left[ y_i \\log\\left(\\frac{y_i}{\\hat{\\mu}_i}\\right) - (y_i - \\hat{\\mu}_i) \\right] $$\n    基于偏差的离散度估计值为 $\\hat{\\phi}_D = \\frac{D}{df}$。\n\n**为什么大残差或杠杆点会夸大离散度诊断结果：**\n$\\chi^2$ 和 $D$ 都是非负项的和，每个观测值对应一项。\n-   **大残差：** 观测计数 $y_i$ 和拟合均值 $\\hat{\\mu}_i$ 之间存在巨大差异的观测值将对这些和做出巨大贡献。皮尔逊贡献项 $(y_i - \\hat{\\mu}_i)^2/\\hat{\\mu}_i$ 随着原始残差 $(y_i - \\hat{\\mu}_i)$ 的增加而呈二次方增长。偏差贡献也随着这种差异迅速增加。如问题所述，少数几个偏差残差超过 $4$。偏差残差是 $r_{D_i} = \\text{sign}(y_i - \\hat{\\mu}_i)\\sqrt{d_i}$，其中 $d_i$ 是偏差和中的第 $i$ 项。一个 $r_{D_i} = 4$ 的残差意味着对总偏差 $D$ 的贡献为 $d_i = 16$。如果存在少数几个这样的点，它们可以主导总和，并显著夸大整体统计量 $\\chi^2$ 和 $D$，即使大多数数据点都很好地符合泊松方差假设，也会导致大的离散度估计值 $\\hat{\\phi}_P$ 和 $\\hat{\\phi}_D$。\n\n-   **高杠杆点：** 在GLM中，一个观测值的杠杆值（通常由帽子矩阵的对角元素 $h_{ii}$ 度量）量化了其影响模型拟合的潜力。具有高杠杆值的点，通常是由于其协变量 $\\mathbf{x}_i$ 中存在极端值，可以对估计的回归系数 $\\hat{\\boldsymbol{\\beta}}$ 产生强烈的拉动作用。这种对 $\\hat{\\boldsymbol{\\beta}}$ 的扭曲反过来又会导致*许多其他*观测值（$j \\neq i$）的拟合值 $\\hat{\\mu}_j$ 不佳，从而造成普遍较大的残差。这进而夸大了全局汇总统计量 $\\chi^2$ 和 $D$。\n\n**针对普遍性过度离散的稳健检查：**\n目标是确定高离散度是数据的真实、普遍特征（表明像负二项这样的模型更合适）还是少数有影响力的点的假象。稳健方法被设计为对一小部分离群值不敏感。\n-   **残差修剪/缩尾处理：** 在移除（修剪）或降低（缩尾处理）具有最大绝对残差的观测值的权重后，重新计算离散度估计。如果估计值仍然很高，则表明过度离散是一个更普遍的特征。\n-   **稳健的尺度估计量：** 不使用平方残差的均值（$\\hat{\\phi}_P$ 中隐含的），而是使用一个稳健的离散度度量，例如平方残差的中位数，它对极端值不敏感。\n-   **影响分析：** 系统地逐个移除观测值（留一法）并跟踪离散度估计的变化，可以精确定位导致夸大的特定观测值。\n-   **自举法：** 使用参数自举法从拟合的泊松模型中模拟数据。这在泊松模型是正确的零假设下，生成了任何选定的离散度统计量（包括稳健统计量）的抽样分布。将观测到的统计量与此分布进行比较提供了一个正式的检验。\n\n### 选项评估\n\n**A. 皮尔逊和偏差离散度诊断汇总了残差的贡献，这些贡献随着观测计数和拟合计数之间差异的增大而迅速增加，因此少数几个大残差可以主导这些总和；高杠杆值观测值也可能扭曲许多其他观测值的拟合均值，从而夸大全局离散度诊断。稳健的检查方法包括对一小部分最大的绝对偏差或皮尔逊残差进行修剪或缩尾处理，然后重新计算离散度；如果修剪后的离散度仍然远高于 $1$，这支持了真实的过度离散超出了少数几个有影响力的点。**\n这个陈述是对情况的极好总结。它正确地指出了离散度统计量基于求和的性质使其对离群值敏感。它正确地描述了有影响力点的双重作用：自身具有大残差，同时也扭曲了其他点的拟合。所提出的稳健检查方法（修剪/缩尾处理残差并重新计算离散度）是诊断高离散度来源的标准且适当的方法。对此检查结果的解释也是正确的。\n**结论：正确**\n\n**B. 对离散度估计值进行留一法敏感性分析，即 $\\hat{\\phi}_{(-i)}$，可以揭示是否有一小部分观测值导致了夸大；用基于残差的稳健尺度估计量来补充这一分析，例如根据泊松参考进行缩放的皮尔逊残差平方的中位数，或者Huber化的残差平方和，以在评估离散度时减弱离群值的影响。**\n这个陈述描述了两种有效且强大的稳健诊断技术。留一法分析是评估每个单独点对像 $\\hat{\\phi}$ 这样的汇总统计量影响的直接方法。使用稳健的尺度估计量（如中位数或基于Huber M-估计的估计量）是获得不受少数极端残差扭曲的离散度估计的主要策略。这些方法直接解决了区分离群值驱动的过度离散和普遍存在的过度离散的问题。\n**结论：正确**\n\n**C. 如果负二项回归的赤池信息准则 (AIC) 低于泊松模型，那么过度离散必定是真实的，而不是由杠杆值或模型设定错误引起的，因此基于残差的检查是不必要的。**\n这个陈述是不正确的。虽然负二项 (NB) 模型的AIC较低是其比泊松模型提供更好拟合的有力证据，但这并不是过度离散是“真实的”（即是数据生成过程的全局特征）的确定性证明。NB模型的优越拟合可能仅仅是因为其额外的离散参数有效地容纳了由同样少数几个有影响力的离群值引入的大方差。AIC比较的是一组模型的相对质量；它不验证胜出模型的基本假设。基本的诊断检查（对残差、杠杆值等）*总是*必要的，即使是对由AIC选出的模型，以确保它是数据的有效表示。忽视这些检查是一个严重的方法论错误。\n**结论：不正确**\n\n**D. 对计数应用对数变换并拟合普通最小二乘法，可以保证在变换尺度上的同方差性；因此，由皮尔逊或偏差诊断检测到的任何泊松过度离散都是伪的，可以忽略基于残差的过度离散检查。**\n这个陈述在多个方面都是不正确的。首先，对数变换 $\\log(Y)$ 并不能稳定泊松分布变量 $Y$ 的方差。使用一阶泰勒展开（德尔塔方法），变换后变量的方差约为 $\\text{Var}(\\log(Y)) \\approx [\\frac{d}{d\\mu}\\log(\\mu)]^2 \\text{Var}(Y) = (1/\\mu)^2 \\mu = 1/\\mu$。对数尺度上的方差依赖于均值 $\\mu$，因此不是同方差的。（泊松变量的方差稳定变换是平方根，而不是对数）。其次，对变换后的计数应用普通最小二乘法是有问题的：$\\log(0)$ 是未定义的，需要像 $\\log(Y+c)$ 这样的临时调整，并且普通最小二乘法没有正确考虑数据的离散性。泊松过度离散是“伪的”这一结论是基于一个错误的前提。\n**结论：不正确**\n\n**E. 可以使用在拟合的泊松模型下的参数自举法来近似一个稳健离散度统计量（例如，平方偏差残差的 $10\\%$-修剪均值）的抽样分布；将观测到的稳健统计量与自举参照进行比较，并在暂时排除杠杆值高于预设阈值的点后检查残差与拟合值图，可以为残差方差是否仍随均值增加（与真实的过度离散一致）提供证据。**\n这个陈述描述了一套复杂且在统计上有效的诊断程序。参数自举法是一种强大而灵活的假设检验方法，非常适合用于推导自定义或稳健统计量的零分布，而这些统计量的解析结果是不可用的。将观测到的稳健统计量与这个参照分布进行比较，是在对离群值不敏感的情况下检验过度离散的合理方法。此外，暂时移除高杠杆点以检查剩余数据在残差图上的潜在结构的策略是一种非常有用的影响诊断方法。这种技术的组合是研究观测到的过度离散性质的绝佳方式。\n**结论：正确**",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "当我们怀疑数据存在过度离散，并且已经排除了异常值的干扰后，下一步便是进行形式化的假设检验，以决定是否有充分的统计证据支持我们从泊松模型转向更复杂的模型，如负二项分布模型。这项练习  将指导你构建一个得分检验 (score test)，这是一种在广义线性模型框架下检验过度离散的经典且高效的方法。通过亲手推导检验统计量并将其应用于一个假设场景，你将掌握如何利用统计推断来做出有原则的模型选择决策，从而在模型的简约性与拟合优度之间找到平衡。",
            "id": "4950109",
            "problem": "在一个基于医院的慢性病患者队列中，每位患者在固定随访期内的急诊就诊次数通过一个带对数连接函数和人时偏移量的泊松广义线性模型（GLM）进行建模。原假设下的基线模型假定泊松变异：对于患者 $i$，计数 $Y_i$ 的均值为 $E(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$，方差为 $\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。考虑一种备择情况，其中计数服从负二项（NB）分布，其均值相同，但方差为 $\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i + \\alpha \\mu_i^2$，其中 $\\alpha \\ge 0$ 是一个过度离散参数。你需要基于负二项备择假设，构建一个得分检验来检验是否存在超泊松变异，该检验在 $\\alpha = 0$ 处进行，且 $\\mu_i$ 中的讨厌参数在原假设下通过泊松广义线性模型进行估计。\n\n从由 $(\\mu_i, \\alpha)$ 参数化的泊松似然和负二项似然的基本定义出发，执行以下操作：\n\n1) 在 $\\alpha = 0$ 处，保持 $\\mu_i$ 固定，推导关于 $\\alpha$ 的得分，并展示如何在原假设模型下获得其方差。利用这些结果，以 $\\{Y_i, \\mu_i\\}_{i=1}^n$ 的形式，用闭合形式构建得分检验统计量。明确指出该检验统计量的零分布。\n\n2) 对于以下 $n = 10$ 名患者，在原假设下已经拟合了一个泊松广义线性模型，得到了拟合均值 $\\hat{\\mu}_i$ 以及观测计数 $y_i$。请使用你推导的表达式，通过将 $\\hat{\\mu}_i$ 代入 $\\mu_i$ 来计算得分检验统计量 $S$ 的数值：\n- 患者 $1$：$y_1 = 0$，$\\hat{\\mu}_1 = 0.4$。\n- 患者 $2$：$y_2 = 1$，$\\hat{\\mu}_2 = 0.6$。\n- 患者 $3$：$y_3 = 0$，$\\hat{\\mu}_3 = 0.5$。\n- 患者 $4$：$y_4 = 2$，$\\hat{\\mu}_4 = 1.1$。\n- 患者 $5$：$y_5 = 3$，$\\hat{\\mu}_5 = 1.5$。\n- 患者 $6$：$y_6 = 0$，$\\hat{\\mu}_6 = 0.7$。\n- 患者 $7$：$y_7 = 4$，$\\hat{\\mu}_7 = 2.1$。\n- 患者 $8$：$y_8 = 1$，$\\hat{\\mu}_8 = 0.9$。\n- 患者 $9$：$y_9 = 2$，$\\hat{\\mu}_9 = 1.2$。\n- 患者 $10$：$y_{10} = 5$，$\\hat{\\mu}_{10} = 3.0$。\n\n计算 $S$ 并报告其值。将你的答案四舍五入到四位有效数字。\n\n注意：对于第（1）部分，请从似然定义开始，而不是从任何预先记下的检验公式开始。对于第（2）部分，请使用第（1）部分的结果和提供的 $\\hat{\\mu}_i$ 值。最终报告的答案必须是按要求给出的 $S$ 的单个数值。",
            "solution": "### 步骤 1：提取已知条件\n-   **原假设（$H_0$）下的模型**：对于患者 $i$，计数 $Y_i$ 服从泊松分布。\n    -   均值：$E(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。\n    -   方差：$\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。\n    -   均值通过带对数连接函数的泊松GLM建模：$\\ln(\\mu_i) = \\boldsymbol{x}_i^T \\boldsymbol{\\beta}$。\n-   **备择假设（$H_A$）下的模型**：计数 $Y_i$ 服从负二项（NB）分布。\n    -   均值：$E(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i$。\n    -   方差：$\\operatorname{Var}(Y_i \\mid \\boldsymbol{x}_i) = \\mu_i + \\alpha \\mu_i^2$，其中 $\\alpha \\ge 0$ 是一个过度离散参数。\n-   **假设检验**：针对 $H_0: \\alpha=0$ 与 $H_A: \\alpha > 0$ 的得分检验。\n-   **讨厌参数**：定义 $\\mu_i$ 的参数（即 $\\boldsymbol{\\beta}$）在 $H_0$ 下使用泊松GLM进行估计。\n-   **第2部分的数据**：来自原泊松模型的 $n=10$ 名患者的样本，包含观测计数 $y_i$ 和拟合均值 $\\hat{\\mu}_i$。\n    - 患者 $1$：$y_1=0$，$\\hat{\\mu}_1 = 0.4$。\n    - 患者 $2$：$y_2=1$，$\\hat{\\mu}_2 = 0.6$。\n    - 患者 $3$：$y_3=0$，$\\hat{\\mu}_3 = 0.5$。\n    - 患者 $4$：$y_4=2$，$\\hat{\\mu}_4 = 1.1$。\n    - 患者 $5$：$y_5=3$，$\\hat{\\mu}_5 = 1.5$。\n    - 患者 $6$：$y_6=0$，$\\hat{\\mu}_6 = 0.7$。\n    - 患者 $7$：$y_7=4$，$\\hat{\\mu}_7 = 2.1$。\n    - 患者 $8$：$y_8=1$，$\\hat{\\mu}_8 = 0.9$。\n    - 患者 $9$：$y_9=2$，$\\hat{\\mu}_9 = 1.2$。\n    - 患者 $10$：$y_{10}=5$，$\\hat{\\mu}_{10} = 3.0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是生物统计学和广义线性模型中的一个标准课题。指定的负二项方差形式 $\\mu + \\alpha\\mu^2$ 是一族标准参数化（NB2族）中的一种。推导得分检验的任务是一个明确定义的统计过程。该问题是自洽的，提供了所有必要的理论背景和数值数据。语言精确客观。没有矛盾、歧义或不切实际的假设。该问题提法得当且可解。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n***\n\n### 第1部分：得分检验的推导\n\n得分检验由备择模型的对数似然函数的梯度构建，并在原假设下进行评估。\n\n均值为 $\\mu$、方差为 $\\mu + \\alpha \\mu^2$ 的负二项（NB）分布的概率质量函数（PMF）由下式给出：\n$$ P(Y=y; \\mu, \\alpha) = \\frac{\\Gamma(y + \\alpha^{-1})}{\\Gamma(\\alpha^{-1}) y!} \\left(\\frac{\\alpha\\mu}{1+\\alpha\\mu}\\right)^y \\left(\\frac{1}{1+\\alpha\\mu}\\right)^{\\alpha^{-1}} $$\n对于 $y = 0, 1, 2, ...$。当 $\\alpha \\to 0$ 时，该分布趋近于均值为 $\\mu$ 的泊松分布。\n\n单个观测值 $Y_i$ 的对数似然为：\n$$ \\ell_i(\\mu_i, \\alpha) = \\ln \\Gamma(y_i + \\alpha^{-1}) - \\ln \\Gamma(\\alpha^{-1}) - \\ln(y_i!) + y_i \\ln(\\alpha\\mu_i) - (y_i + \\alpha^{-1}) \\ln(1+\\alpha\\mu_i) $$\n对于 $n$ 个独立观测值，总对数似然为 $\\ell(\\boldsymbol{\\mu}, \\alpha) = \\sum_{i=1}^n \\ell_i(\\mu_i, \\alpha)$。\n\n由于 $\\alpha^{-1}$ 项的存在，直接对 $\\alpha$ 求导很麻烦。一个更易于处理的方法是求 $\\ell_i$ 在 $\\alpha=0$ 附近的泰勒级数展开。可以证明，对数似然可以近似为：\n$$ \\ell_i(\\mu_i, \\alpha) \\approx \\ell_{Poisson}(\\mu_i; y_i) + \\frac{\\alpha}{2} \\left[ (y_i - \\mu_i)^2 - y_i \\right] + O(\\alpha^2) $$\n其中 $\\ell_{Poisson}(\\mu_i; y_i) = y_i \\ln(\\mu_i) - \\mu_i - \\ln(y_i!)$ 是泊松分布的对数似然。\n\n关于 $\\alpha$ 的得分是总对数似然关于 $\\alpha$ 的偏导数。对于单个观测值，得分分量为：\n$$ U_i(\\alpha) = \\frac{\\partial \\ell_i}{\\partial \\alpha} $$\n在 $\\alpha=0$ 处求值，我们得到：\n$$ U_i(0) = \\left. \\frac{\\partial \\ell_i}{\\partial \\alpha} \\right|_{\\alpha=0} = \\frac{1}{2} \\left[ (y_i - \\mu_i)^2 - y_i \\right] $$\n在 $\\alpha=0$ 处评估的总得分 $U(\\alpha)$ 是所有观测值的总和：\n$$ U(0) = \\sum_{i=1}^n U_i(0) = \\frac{1}{2} \\sum_{i=1}^n \\left[ (Y_i - \\mu_i)^2 - Y_i \\right] $$\n得分检验要求将讨厌参数（$\\mu_i$ 中的 $\\boldsymbol{\\beta}$）替换为其在 $H_0$ 下的极大似然估计。设 $\\hat{\\mu}_i$ 为泊松GLM的拟合值。于是，得分统计量基于：\n$$ U(0)|_{\\mu=\\hat{\\mu}} = \\frac{1}{2} \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] $$\n\n接下来，我们需要得分在 $H_0: \\alpha=0$ 下的方差，即费雪信息 $I_{\\alpha\\alpha}(0)$。在 $H_0$ 下，$Y_i \\sim \\text{Poisson}(\\mu_i)$。\n首先，我们验证在 $H_0$ 下得分的期望为零：\n$$ E[U_i(0)] = E\\left[ \\frac{1}{2} \\left( (Y_i - \\mu_i)^2 - Y_i \\right) \\right] = \\frac{1}{2} \\left( E[(Y_i - \\mu_i)^2] - E[Y_i] \\right) $$\n对于泊松分布，$E[Y_i] = \\mu_i$ 且方差 $E[(Y_i - \\mu_i)^2] = \\mu_i$。因此，\n$$ E[U_i(0)] = \\frac{1}{2} (\\mu_i - \\mu_i) = 0 $$\n观测值 $i$ 的得分方差为 $\\operatorname{Var}(U_i(0)) = E[U_i(0)^2] - (E[U_i(0)])^2 = E[U_i(0)^2]$。\n$$ \\operatorname{Var}(U_i(0)) = E\\left[ \\left( \\frac{1}{2} \\left[ (Y_i - \\mu_i)^2 - Y_i \\right] \\right)^2 \\right] = \\frac{1}{4} E\\left[ \\left( (Y_i - \\mu_i)^2 - Y_i \\right)^2 \\right] $$\n$$ = \\frac{1}{4} E\\left[ (Y_i - \\mu_i)^4 - 2Y_i(Y_i - \\mu_i)^2 + Y_i^2 \\right] $$\n我们使用泊松分布的矩：\n-   $E[(Y_i - \\mu_i)^2] = \\mu_i$\n-   $E[(Y_i - \\mu_i)^3] = \\mu_i$\n-   $E[(Y_i - \\mu_i)^4] = 3\\mu_i^2 + \\mu_i$\n我们还需要另外两个期望：\n-   $E[Y_i^2] = \\operatorname{Var}(Y_i) + (E[Y_i])^2 = \\mu_i + \\mu_i^2$\n-   $E[Y_i(Y_i-\\mu_i)^2] = E[(\\mu_i + (Y_i-\\mu_i))(Y_i-\\mu_i)^2] = E[\\mu_i(Y_i-\\mu_i)^2 + (Y_i-\\mu_i)^3] = \\mu_i E[(Y_i-\\mu_i)^2] + E[(Y_i-\\mu_i)^3] = \\mu_i(\\mu_i) + \\mu_i = \\mu_i^2 + \\mu_i$\n将这些代入方差表达式：\n$$ \\operatorname{Var}(U_i(0)) = \\frac{1}{4} \\left[ (3\\mu_i^2 + \\mu_i) - 2(\\mu_i^2 + \\mu_i) + (\\mu_i^2 + \\mu_i) \\right] $$\n$$ = \\frac{1}{4} [ (3-2+1)\\mu_i^2 + (1-2+1)\\mu_i ] = \\frac{1}{4} [2\\mu_i^2] = \\frac{\\mu_i^2}{2} $$\n由于观测是独立的，总信息量是单个方差之和：\n$$ I_{\\alpha\\alpha}(0) = \\operatorname{Var}(U(0)) = \\sum_{i=1}^n \\operatorname{Var}(U_i(0)) = \\sum_{i=1}^n \\frac{\\mu_i^2}{2} = \\frac{1}{2} \\sum_{i=1}^n \\mu_i^2 $$\n得分检验统计量 $S$ 构建为 $S = \\frac{U(0)^2}{I_{\\alpha\\alpha}(0)}$，其中 $\\mu_i$ 被 $\\hat{\\mu}_i$ 替换：\n$$ S = \\frac{\\left( \\frac{1}{2} \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] \\right)^2}{\\frac{1}{2} \\sum_{i=1}^n \\hat{\\mu}_i^2} $$\n$$ S = \\frac{\\frac{1}{4} \\left( \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] \\right)^2}{\\frac{1}{2} \\sum_{i=1}^n \\hat{\\mu}_i^2} = \\frac{\\left( \\sum_{i=1}^n \\left[ (Y_i - \\hat{\\mu}_i)^2 - Y_i \\right] \\right)^2}{2 \\sum_{i=1}^n \\hat{\\mu}_i^2} $$\n这是得分检验统计量的闭合形式表达式。在原假设 $H_0: \\alpha=0$ 下，该统计量渐近服从自由度为1的卡方分布，$S \\sim \\chi_1^2$。\n\n### 第2部分：检验统计量的计算\n\n我们使用推导出的 $S$ 公式和给定的数据，将 $\\hat{\\mu}_i$ 代入 $\\mu_i$，$y_i$ 代入 $Y_i$。\n$S$ 的分子是 $\\left( \\sum_{i=1}^{10} \\left[ (y_i - \\hat{\\mu}_i)^2 - y_i \\right] \\right)^2$。\n我们为每位患者计算项 $d_i = (y_i - \\hat{\\mu}_i)^2 - y_i$：\n-   $d_1 = (0 - 0.4)^2 - 0 = 0.16$\n-   $d_2 = (1 - 0.6)^2 - 1 = 0.16 - 1 = -0.84$\n-   $d_3 = (0 - 0.5)^2 - 0 = 0.25$\n-   $d_4 = (2 - 1.1)^2 - 2 = 0.81 - 2 = -1.19$\n-   $d_5 = (3 - 1.5)^2 - 3 = 2.25 - 3 = -0.75$\n-   $d_6 = (0 - 0.7)^2 - 0 = 0.49$\n-   $d_7 = (4 - 2.1)^2 - 4 = 3.61 - 4 = -0.39$\n-   $d_8 = (1 - 0.9)^2 - 1 = 0.01 - 1 = -0.99$\n-   $d_9 = (2 - 1.2)^2 - 2 = 0.64 - 2 = -1.36$\n-   $d_{10} = (5 - 3.0)^2 - 5 = 4.0 - 5 = -1.00$\n\n总和为：\n$$ \\sum_{i=1}^{10} d_i = 0.16 - 0.84 + 0.25 - 1.19 - 0.75 + 0.49 - 0.39 - 0.99 - 1.36 - 1.00 = -5.62 $$\n分子是 $(-5.62)^2 = 31.5844$。\n\n$S$ 的分母是 $2 \\sum_{i=1}^{10} \\hat{\\mu}_i^2$。\n我们为每位患者计算 $\\hat{\\mu}_i^2$：\n-   $\\hat{\\mu}_1^2 = 0.4^2 = 0.16$\n-   $\\hat{\\mu}_2^2 = 0.6^2 = 0.36$\n-   $\\hat{\\mu}_3^2 = 0.5^2 = 0.25$\n-   $\\hat{\\mu}_4^2 = 1.1^2 = 1.21$\n-   $\\hat{\\mu}_5^2 = 1.5^2 = 2.25$\n-   $\\hat{\\mu}_6^2 = 0.7^2 = 0.49$\n-   $\\hat{\\mu}_7^2 = 2.1^2 = 4.41$\n-   $\\hat{\\mu}_8^2 = 0.9^2 = 0.81$\n-   $\\hat{\\mu}_9^2 = 1.2^2 = 1.44$\n-   $\\hat{\\mu}_{10}^2 = 3.0^2 = 9.00$\n\n总和为：\n$$ \\sum_{i=1}^{10} \\hat{\\mu}_i^2 = 0.16 + 0.36 + 0.25 + 1.21 + 2.25 + 0.49 + 4.41 + 0.81 + 1.44 + 9.00 = 20.38 $$\n分母是 $2 \\times 20.38 = 40.76$。\n\n最后，得分检验统计量 $S$ 是：\n$$ S = \\frac{31.5844}{40.76} \\approx 0.77493621197 $$\n四舍五入到四位有效数字，我们得到 $S = 0.7749$。",
            "answer": "$$\n\\boxed{0.7749}\n$$"
        }
    ]
}