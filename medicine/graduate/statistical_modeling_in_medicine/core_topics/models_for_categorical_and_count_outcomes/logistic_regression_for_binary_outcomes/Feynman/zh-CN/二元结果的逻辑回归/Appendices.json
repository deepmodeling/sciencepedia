{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握逻辑回归，就必须理解其参数是如何从数据中估计出来的。在完全依赖统计软件之前，亲手通过第一性原理推导估算过程是至关重要的一步。这个练习将指导您在一个最简单的逻辑回归模型（仅含截距项）中，从似然函数出发，推导出最大似然估计（MLE）及其置信区间，从而将抽象的理论与具体的计算联系起来。",
            "id": "4807790",
            "problem": "一项肿瘤学领域的 II 期单臂初步研究评估了一种研究性药物，其二元结局为六周内的临床缓解，记为参与者 $i$ 的 $Y_{i} \\in \\{0,1\\}$。研究人员希望报告基线缓解对数优势（log-odds），假设采用仅含截距项的逻辑回归模型，当不包含协变量且所有参与者的缓解概率恒定时，该模型是合适的。抽样模型假设独立的伯努利试验，具有共同的缓解概率 $p$，且链接函数满足 $\\operatorname{logit}(p)=\\beta_{0}$，其中 $\\beta_{0}$ 是截距。\n\n在该研究中，共招募了 $n=10$ 名参与者，观察到 $k=3$ 例缓解。在逻辑回归中最大似然估计的标准正则性条件下，从第一性原理出发，使用伯努利似然和关于 $\\beta_{0}$ 的费雪信息，推导对数优势尺度上的最大似然估计（MLE）$\\hat{\\beta}_{0}$ 及其大样本沃尔德 95% 置信区间（CI）。使用适用于 95% CI 的标准正态双侧临界值。\n\n报告三个数值：点估计值 $\\hat{\\beta}_{0}$，以及沃尔德 95% CI 的下限和上限，所有数值均在对数优势尺度上。将每个报告值四舍五入至四位有效数字。",
            "solution": "问题陈述经评估是有效的。它在科学上基于统计推断的原理，特别是逻辑回归模型的最大似然估计。该问题是适定的，提供了所有必要的数据（$n=10$，$k=3$）和一个明确的目标：为对数优势参数 $\\beta_0$ 推导最大似然估计和沃尔德置信区间。语言客观且明确。对于相对较小的样本量（$n=10$）使用大样本近似是旨在教授该方法的教科书问题的标准特征，并不会使问题无效。\n\n推导过程从第一性原理出发，如下所示。\n\n设参与者 $i$ 的二元结局为 $Y_i \\in \\{0, 1\\}$，其中 $Y_i=1$ 表示临床缓解。这些结局被建模为独立同分布的伯努利随机变量，$Y_i \\sim \\text{Bernoulli}(p)$，其中 $p$ 是共同的缓解概率。样本量为 $n=10$，观察到的总缓解数为 $k=3$。\n\n观测数据（包括 $k$ 例缓解和 $n-k$ 例未缓解）的似然函数由各个伯努利概率的乘积给出：\n$$L(p) = \\prod_{i=1}^{n} p^{y_i} (1-p)^{1-y_i} = p^{\\sum y_i} (1-p)^{n-\\sum y_i} = p^k (1-p)^{n-k}$$\n\n问题指定了一个仅含截距项的逻辑回归模型，其中缓解的对数优势通过 logit 链接函数与截距 $\\beta_0$ 相关联：\n$$\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\beta_0$$\n根据这个关系，我们可以将概率 $p$ 表示为 $\\beta_0$ 的函数：\n$$p(\\beta_0) = \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = (1 + \\exp(-\\beta_0))^{-1}$$\n因此，$1-p$ 可以表示为：\n$$1-p(\\beta_0) = 1 - \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = \\frac{1}{1+\\exp(\\beta_0)}$$\n\n将这些表达式代入似然函数，得到以 $\\beta_0$ 表示的似然函数：\n$$L(\\beta_0) = \\left(\\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)}\\right)^k \\left(\\frac{1}{1+\\exp(\\beta_0)}\\right)^{n-k} = \\frac{\\exp(k\\beta_0)}{(1+\\exp(\\beta_0))^n}$$\n\n为了找到 $\\beta_0$ 的最大似然估计（MLE），我们处理对数似然函数 $\\ell(\\beta_0) = \\ln(L(\\beta_0))$：\n$$\\ell(\\beta_0) = k\\beta_0 - n\\ln(1+\\exp(\\beta_0))$$\n\n我们通过对 $\\ell(\\beta_0)$ 关于 $\\beta_0$ 求导，并将结果（得分函数，$U(\\beta_0)$）设为零来找到最大值：\n$$\\frac{d\\ell}{d\\beta_0} = U(\\beta_0) = k - n \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = k - np$$\n设 $U(\\hat{\\beta}_0)=0$ 来求解 MLE，意味着 $k - n\\hat{p} = 0$，这得出 $p$ 的 MLE 为 $\\hat{p} = \\frac{k}{n}$。根据 MLE 的不变性，$\\beta_0$ 的 MLE 为：\n$$\\hat{\\beta}_0 = \\operatorname{logit}(\\hat{p}) = \\ln\\left(\\frac{\\hat{p}}{1-\\hat{p}}\\right) = \\ln\\left(\\frac{k/n}{1-k/n}\\right) = \\ln\\left(\\frac{k}{n-k}\\right)$$\n代入给定值 $n=10$ 和 $k=3$：\n$$\\hat{\\beta}_0 = \\ln\\left(\\frac{3}{10-3}\\right) = \\ln\\left(\\frac{3}{7}\\right) \\approx -0.84729786$$\n\n接下来，我们使用费雪信息推导 $\\hat{\\beta}_0$ 的标准误。费雪信息 $I(\\beta_0)$ 是对数似然函数二阶导数的期望值的负数。\n二阶导数是：\n$$\\frac{d^2\\ell}{d\\beta_0^2} = \\frac{d}{d\\beta_0}(k - np) = -n\\frac{dp}{d\\beta_0}$$\n因为 $p = (1+\\exp(-\\beta_0))^{-1}$，其导数为 $\\frac{dp}{d\\beta_0} = -(1+\\exp(-\\beta_0))^{-2} \\cdot (-\\exp(-\\beta_0)) = \\frac{\\exp(-\\beta_0)}{(1+\\exp(-\\beta_0))^2} = \\frac{1}{1+\\exp(\\beta_0)} \\cdot \\frac{\\exp(\\beta_0)}{1+\\exp(\\beta_0)} = p(1-p)$。\n因此，对数似然的二阶导数是：\n$$\\frac{d^2\\ell}{d\\beta_0^2} = -np(1-p)$$\n由于这个表达式不依赖于数据 $y_i$（只通过 $p$ 依赖于参数 $\\beta_0$），其期望就是表达式本身。$n$ 个观测值的费雪信息是：\n$$I(\\beta_0) = -E\\left[\\frac{d^2\\ell}{d\\beta_0^2}\\right] = -(-np(1-p)) = np(1-p)$$\n$\\hat{\\beta}_0$ 的渐近方差是费雪信息的倒数，在真实参数值处进行评估。我们通过代入 MLE $\\hat{p}$ 来估计此方差：\n$$\\widehat{\\operatorname{Var}}(\\hat{\\beta}_0) = [I(\\hat{\\beta}_0)]^{-1} = \\frac{1}{n\\hat{p}(1-\\hat{p})}$$\n标准误（SE）是这个估计方差的平方根：\n$$\\operatorname{SE}(\\hat{\\beta}_0) = \\sqrt{\\frac{1}{n\\hat{p}(1-\\hat{p})}} = \\sqrt{\\frac{1}{n\\frac{k}{n}(1-\\frac{k}{n})}} = \\sqrt{\\frac{n}{k(n-k)}}$$\n代入给定值：\n$$\\operatorname{SE}(\\hat{\\beta}_0) = \\sqrt{\\frac{10}{3(10-3)}} = \\sqrt{\\frac{10}{21}} \\approx 0.69006556$$\n\n$\\beta_0$ 的大样本沃尔德 95% 置信区间（CI）由下式给出：\n$$\\hat{\\beta}_0 \\pm z_{1-\\alpha/2} \\operatorname{SE}(\\hat{\\beta}_0)$$\n对于 95% CI，$\\alpha=0.05$，所以我们需要来自标准正态分布的临界值 $z_{1-0.05/2} = z_{0.975}$。标准值为 $z_{0.975} \\approx 1.96$。\n误差范围（ME）是：\n$$\\text{ME} = 1.96 \\times \\operatorname{SE}(\\hat{\\beta}_0) \\approx 1.96 \\times 0.69006556 \\approx 1.35252849$$\nCI 的下限（LB）是：\n$$\\text{LB} = \\hat{\\beta}_0 - \\text{ME} \\approx -0.84729786 - 1.35252849 = -2.19982635$$\nCI 的上限（UB）是：\n$$\\text{UB} = \\hat{\\beta}_0 + \\text{ME} \\approx -0.84729786 + 1.35252849 = 0.50523063$$\n\n最后，我们将所需的三个值四舍五入到四位有效数字：\n点估计值 $\\hat{\\beta}_0$：$-0.8473$\n下限：$-2.200$\n上限：$0.5052$",
            "answer": "$$\\boxed{\\begin{pmatrix} -0.8473  -2.200  0.5052 \\end{pmatrix}}$$"
        },
        {
            "introduction": "逻辑回归模型的系数通常是通过一种名为“迭代重加权最小二乘法”（Iteratively Reweighted Least Squares, IRLS）的算法来拟合的。这个练习将揭开这个算法“黑箱”的神秘面纱。通过亲手完成一次完整的迭代计算，您将具体地理解模型是如何通过逐步逼近来找到最优参数的，从而对模型拟合过程建立起一个直观而深刻的认识。",
            "id": "4970685",
            "problem": "考虑一个用于短期围手术期研究的二元结果模型，其中每位患者 $i \\in \\{1,2,3\\}$ 贡献一次伯努利试验 $y_{i} \\in \\{0,1\\}$，该试验指示是否发生术后急性并发症。设协变量向量为 $x_{i} \\in \\mathbb{R}^{2}$，包含一个截距项和一个标准化的手术复杂度评分，参数向量记为 $\\beta \\in \\mathbb{R}^{2}$。该广义线性模型使用 logit 链接函数，因此条件均值 $p_{i} = \\mathbb{E}(y_{i} \\mid x_{i}, \\beta)$ 满足 $\\operatorname{logit}(p_{i}) = x_{i}^{\\top} \\beta$。数据由设计矩阵 $X = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix}$ 和结果向量 $y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 给出。从初始参数 $\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，执行一次迭代重加权最小二乘法（IRLS）迭代（首先根据带有 logit 链接的伯努利对数似然定义得分函数和观测信息，然后从这些基本原理推导出 IRLS 所需的量），并计算初始迭代中的以下对象：模型预测概率向量 $p^{(0)}$、对角权重矩阵 $W^{(0)}$、工作响应 $z^{(0)}$ 以及更新后的参数向量 $\\beta^{(1)}$。将所有计算量精确表示为有理数或整数；无需四舍五入。将您的最终答案以包含所有四个结果的单一复合表达式形式提供，顺序为 $\\left(p^{(0)}, W^{(0)}, z^{(0)}, \\beta^{(1)}\\right)$。",
            "solution": "本题要求解逻辑回归模型在进行一次迭代重加权最小二乘法（IRLS）算法迭代后，得到的预测概率 $p^{(0)}$、权重矩阵 $W^{(0)}$、工作响应 $z^{(0)}$ 和更新后的参数向量 $\\beta^{(1)}$。\n\n### 第1步：问题验证\n\n这是一个关于广义线性模型（GLM）计算统计学的标准、定义明确的练习题。\n\n*   **提取的已知条件**：\n    *   模型：用于二元结果 $y_i \\in \\{0, 1\\}$ 的逻辑回归。\n    *   观测数量：$N=3$。\n    *   链接函数：$\\operatorname{logit}(p_i) = \\ln\\left(\\frac{p_i}{1-p_i}\\right) = x_i^\\top \\beta$。\n    *   设计矩阵：$X = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix}$。\n    *   结果向量：$y = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n    *   初始参数向量：$\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n    *   任务：从 $\\beta^{(0)}$ 开始执行一次 IRLS 迭代，并计算 $p^{(0)}$、 $W^{(0)}$、 $z^{(0)}$ 和 $\\beta^{(1)}$。\n\n*   **验证结论**：\n    *   该问题在 GLM 理论上是**科学严谨的**。\n    *   它是**适定的**，为 IRLS 算法的单次、唯一迭代提供了所有必要信息。\n    *   其语言是**客观的**和数学上精确的。\n    *   该问题是**有效的**。\n\n### 第2步：从基本原理推导 IRLS 算法\n\nGLM 的 IRLS 算法可以作为最大化对数似然的牛顿-拉夫逊方法推导出来。对于二元结果 $y_i \\sim \\text{Bernoulli}(p_i)$，单个观测 $i$ 的对数似然为：\n$$\n\\ell_i(\\beta) = y_i \\ln(p_i) + (1-y_i) \\ln(1-p_i)\n$$\n总对数似然为 $\\ell(\\beta) = \\sum_{i=1}^{N} \\ell_i(\\beta)$。链接函数将概率 $p_i$ 与线性预测器 $\\eta_i = x_i^\\top \\beta$ 相关联：\n$$\n\\eta_i = \\ln\\left(\\frac{p_i}{1-p_i}\\right) \\implies p_i = \\frac{\\exp(\\eta_i)}{1+\\exp(\\eta_i)} = \\frac{1}{1+\\exp(-\\eta_i)}\n$$\n这是 logistic S 型函数，$\\sigma(\\eta_i)$。其导数为 $\\frac{d p_i}{d \\eta_i} = p_i(1-p_i)$。\n\n**1. 得分函数（对数似然的梯度）**\n我们求 $\\ell(\\beta)$ 关于参数向量 $\\beta$ 的梯度。对单个观测的贡献使用链式法则：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta_j} = \\frac{\\partial \\ell_i}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta_j}\n$$\n各个分量为：\n$$\n\\frac{\\partial \\ell_i}{\\partial p_i} = \\frac{y_i}{p_i} - \\frac{1-y_i}{1-p_i} = \\frac{y_i - p_i}{p_i(1-p_i)}\n$$\n$$\n\\frac{\\partial p_i}{\\partial \\eta_i} = p_i(1-p_i)\n$$\n$$\n\\frac{\\partial \\eta_i}{\\partial \\beta_j} = \\frac{\\partial (x_i^\\top \\beta)}{\\partial \\beta_j} = x_{ij}\n$$\n将这些组合起来得到：\n$$\n\\frac{\\partial \\ell_i}{\\partial \\beta_j} = \\frac{y_i - p_i}{p_i(1-p_i)} \\cdot p_i(1-p_i) \\cdot x_{ij} = (y_i - p_i) x_{ij}\n$$\n整个数据集的得分向量是所有观测值的总和，可以写成矩阵形式：\n$$\nS(\\beta) = \\nabla_\\beta \\ell(\\beta) = \\sum_{i=1}^{N} (y_i - p_i) x_i = X^\\top (y - p)\n$$\n\n**2. 观测信息矩阵（负海森矩阵）**\n接下来，我们计算海森矩阵 $\\mathcal{H}(\\beta) = \\frac{\\partial^2 \\ell(\\beta)}{\\partial \\beta \\partial \\beta^\\top}$。其元素 $(\\mathcal{H})_{jk}$ 为：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\beta_k \\partial \\beta_j} = \\sum_{i=1}^{N} \\frac{\\partial}{\\partial \\beta_k} \\left[ (y_i - p_i) x_{ij} \\right] = \\sum_{i=1}^{N} - \\frac{\\partial p_i}{\\partial \\beta_k} x_{ij}\n$$\n再次使用链式法则，$\\frac{\\partial p_i}{\\partial \\beta_k} = \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta_k} = p_i(1-p_i) x_{ik}$。将此代入：\n$$\n\\frac{\\partial^2 \\ell}{\\partial \\beta_k \\partial \\beta_j} = \\sum_{i=1}^{N} -p_i(1-p_i) x_{ik} x_{ij}\n$$\n在矩阵形式中，海森矩阵为 $\\mathcal{H}(\\beta) = -X^\\top W X$，其中 $W$ 是一个对角矩阵，其对角线元素为 $W_{ii} = p_i(1-p_i)$。观测信息矩阵是 $J(\\beta) = -\\mathcal{H}(\\beta) = X^\\top W X$。\n\n**3. IRLS 更新步骤**\n用于找到 $\\ell(\\beta)$ 最大值的牛顿-拉夫逊更新公式为：\n$$\n\\beta^{(t+1)} = \\beta^{(t)} - [\\mathcal{H}(\\beta^{(t)})]^{-1} S(\\beta^{(t)})\n$$\n代入我们的得分 $S$ 和海森矩阵 $\\mathcal{H}$ 的表达式：\n$$\n\\beta^{(t+1)} = \\beta^{(t)} - [-X^\\top W^{(t)} X]^{-1} [X^\\top (y - p^{(t)})] = \\beta^{(t)} + (X^\\top W^{(t)} X)^{-1} X^\\top (y - p^{(t)})\n$$\n为了将其看作一个加权最小二乘问题，我们重新排列各项：\n$$\n(X^\\top W^{(t)} X) \\beta^{(t+1)} = (X^\\top W^{(t)} X) \\beta^{(t)} + X^\\top (y - p^{(t)})\n$$\n让我们定义一个“工作响应”向量 $z^{(t)}$，使得更新是加权正规方程的解：$\\beta^{(t+1)} = (X^\\top W^{(t)} X)^{-1} X^\\top W^{(t)} z^{(t)}$。这意味着 $X^\\top W^{(t)} z^{(t)} = (X^\\top W^{(t)} X) \\beta^{(t)} + X^\\top (y - p^{(t)})$。我们可以解出 $z^{(t)}$：\n$$\nW^{(t)} z^{(t)} = W^{(t)} X \\beta^{(t)} + (y - p^{(t)}) \\implies z^{(t)} = X \\beta^{(t)} + (W^{(t)})^{-1} (y - p^{(t)})\n$$\n回顾 $\\eta^{(t)} = X \\beta^{(t)}$，工作响应为：\n$$\nz^{(t)} = \\eta^{(t)} + (W^{(t)})^{-1} (y - p^{(t)})\n$$\n\n### 第3步：第一次迭代的计算\n\n给定初始参数向量 $\\beta^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n**1. 计算概率 $p^{(0)}$**\n首先，计算线性预测器 $\\eta^{(0)} = X \\beta^{(0)}$：\n$$\n\\eta^{(0)} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，使用反链接函数 $p_i = \\sigma(\\eta_i)$ 计算概率 $p_i^{(0)}$：\n$$\np_i^{(0)} = \\frac{1}{1+\\exp(-\\eta_i^{(0)})} = \\frac{1}{1+\\exp(0)} = \\frac{1}{1+1} = \\frac{1}{2} \\quad \\text{对于 } i=1,2,3\n$$\n因此，概率向量为：\n$$\np^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n\n**2. 计算权重矩阵 $W^{(0)}$**\n对角线权重为 $W_{ii}^{(0)} = p_i^{(0)}(1 - p_i^{(0)})$：\n$$\nW_{ii}^{(0)} = \\frac{1}{2} \\left(1 - \\frac{1}{2}\\right) = \\frac{1}{4} \\quad \\text{对于 } i=1,2,3\n$$\n权重矩阵为：\n$$\nW^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix}\n$$\n\n**3. 计算工作响应 $z^{(0)}$**\n工作响应为 $z^{(0)} = \\eta^{(0)} + (W^{(0)})^{-1} (y - p^{(0)})$：\n$$\ny - p^{(0)} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}\n$$\n权重矩阵的逆为 $(W^{(0)})^{-1} = \\text{diag}(4, 4, 4)$。\n$$\nz^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 4  0  0 \\\\ 0  4  0 \\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n\n**4. 计算更新后的参数 $\\beta^{(1)}$**\n更新公式为 $\\beta^{(1)} = (X^\\top W^{(0)} X)^{-1} X^\\top W^{(0)} z^{(0)}$。\n首先，计算 $X^\\top W^{(0)} X$：\n$$\nX^\\top W^{(0)} X = \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3  3 \\\\ 3  5 \\end{pmatrix}\n$$\n接下来，求该矩阵的逆：\n$$\n(X^\\top W^{(0)} X)^{-1} = \\left(\\frac{1}{4} \\begin{pmatrix} 3  3 \\\\ 3  5 \\end{pmatrix}\\right)^{-1} = 4 \\cdot \\frac{1}{3(5)-3(3)} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix} = \\frac{4}{6} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix}\n$$\n现在，计算 $X^\\top W^{(0)} z^{(0)}$：\n$$\nX^\\top W^{(0)} z^{(0)} = \\frac{1}{4} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2+2+2 \\\\ 0+2+4 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n最后，计算 $\\beta^{(1)}$：\n$$\n\\beta^{(1)} = \\left(\\frac{2}{3} \\begin{pmatrix} 5  -3 \\\\ -3  3 \\end{pmatrix}\\right) \\begin{pmatrix} 1/2 \\\\ 3/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5(1/2) - 3(3/2) \\\\ -3(1/2) + 3(3/2) \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 5/2 - 9/2 \\\\ -3/2 + 9/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -4/2 \\\\ 6/2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} -2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}\n$$\n\n初始迭代中要求的四个量是：\n$p^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix}$, $W^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix}$, $z^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix}$, and $\\beta^{(1)} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{aligned}\np^{(0)} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 1/2 \\end{pmatrix} \\\\\nW^{(0)} = \\begin{pmatrix} 1/4  0  0 \\\\ 0  1/4  0 \\\\ 0  0  1/4 \\end{pmatrix} \\\\\nz^{(0)} = \\begin{pmatrix} -2 \\\\ 2 \\\\ 2 \\end{pmatrix} \\\\\n\\beta^{(1)} = \\begin{pmatrix} -4/3 \\\\ 2 \\end{pmatrix}\n\\end{aligned}\n}\n$$"
        },
        {
            "introduction": "比值比（Odds Ratio, OR）是逻辑回归分析中的核心效应量，但它具有一个独特的统计学特性，称为“不可坍缩性”（non-collapsibility）。这意味着合并后的（边际）比值比并不等于各分层比值比的加权平均值，即使分层变量不是混杂因素。这个练习将通过一个具体的数值案例来阐明这一违反直觉但至关重要的概念，从而加深您对模型结果的理解，并提升您在实际研究中正确解释和比较比值比的能力。",
            "id": "4608697",
            "problem": "一位流行病学家研究了在由二元协变量 $Z$（分层 $Z=0$ 和分层 $Z=1$）定义的两个分层中，二元暴露 $X$（暴露 $X=1$，非暴露 $X=0$）与二元结局 $Y$（发生事件 $Y=1$，未发生事件 $Y=0$）之间的关联。该结局可以被认为是30天内住院，而暴露则为接受了预防性干预。研究者记录了以下计数：\n\n分层 $Z=0$：\n- 在暴露组（$X=1$）中：$a_0 = 20$ 例事件和 $b_0 = 90$ 例非事件。\n- 在非暴露组（$X=0$）中：$c_0 = 11$ 例事件和 $d_0 = 99$ 例非事件。\n\n分层 $Z=1$：\n- 在暴露组（$X=1$）中：$a_1 = 60$ 例事件和 $b_1 = 45$ 例非事件。\n- 在非暴露组（$X=0$）中：$c_1 = 42$ 例事件和 $d_1 = 63$ 例非事件。\n\n仅使用风险、比值和比值比的核心定义，完成以下任务：\n- 验证在 $Z=0$ 和 $Z=1$ 中，层特异性比值比是相同的。\n- 验证在 $Z=0$ 和 $Z=1$ 之间，基线风险（非暴露组 $X=0$ 的风险）是不同的。\n- 通过汇总各层计数并忽略 $Z$，计算边际（合并的、未分层的）比值比。\n\n哪个陈述是正确的？\n\nA. 各层合并的边际比值比约等于 $1.81$，这与共同的层特异性比值比 $2.00$ 不同，表明即使在没有混杂的情况下，当基线风险不同时，比值比也具有不可合并性。\n\nB. 只要层特异性比值比相同，边际比值比就等于 $2.00$；因此，比值比通常是可以在各层之间合并的。\n\nC. 边际风险比等于 $1.81$，并且只要层特异性比值比在各层中是恒定的，边际风险比就等于边际比值比。\n\nD. 边际比值比约等于 $1.33$，因为在一个分层中结局很常见，这迫使合并估计值与风险比相同。",
            "solution": "问题陈述提供了一项流行病学研究的数据，并要求评估有关比值比的陈述。需要的第一步是验证问题陈述本身。\n\n### 第一步：提取已知条件\n-   **暴露 $X$**：二元变量，$X=1$（暴露），$X=0$（非暴露）。\n-   **结局 $Y$**：二元变量，$Y=1$（事件），$Y=0$（无事件）。\n-   **协变量 $Z$**：二元变量，定义了两个分层，$Z=0$ 和 $Z=1$。\n-   **分层 $Z=0$ 的数据**：\n    -   暴露组（$X=1$）：$a_0 = 20$ 例事件，$b_0 = 90$ 例非事件。\n    -   非暴露组（$X=0$）：$c_0 = 11$ 例事件，$d_0 = 99$ 例非事件。\n-   **分层 $Z=1$ 的数据**：\n    -   暴露组（$X=1$）：$a_1 = 60$ 例事件，$b_1 = 45$ 例非事件。\n    -   非暴露组（$X=0$）：$c_1 = 42$ 例事件，$d_1 = 63$ 例非事件。\n-   **核心任务**：问题要求：\n    1.  验证层特异性比值比是相同的。\n    2.  验证各层之间的基线风险（非暴露组的风险）不同。\n    3.  计算边际（合并）比值比。\n\n### 第二步：使用提取的已知条件进行验证\n问题定义明确，并基于标准的流行病学和统计学原理。\n-   **科学依据**：该问题使用了流行病学的基本概念：暴露、结局、分层、风险、比值和比值比。它提出了一个经典的数值例子，用以说明比值比的不可合并性。这是生物统计学中的一个标准课题。\n-   **定义明确**：所有必要的数据（两个 $2 \\times 2$ 表的计数）都已提供。术语定义清晰，所要求的计算会得出一个唯一且有意义的结果。\n-   **客观性**：问题是用定量数据和客观定义来陈述的，没有模糊性或主观论断。\n\n### 第三步：结论与行动\n问题陈述是有效的。我们可以通过执行所需的计算来继续解答。\n\n### 推导与计算\n\n我们将使用的核心定义是：\n-   风险：$P(Y=1) = \\frac{\\text{事件数}}{\\text{总人数}}$。\n-   比值：$\\frac{P(Y=1)}{P(Y=0)} = \\frac{P(Y=1)}{1 - P(Y=1)} = \\frac{\\text{事件数}}{\\text{非事件数}}$。\n-   比值比 (OR)：$\\frac{\\text{暴露组的比值}}{\\text{非暴露组的比值}} = \\frac{a/b}{c/d} = \\frac{ad}{bc}$。\n\n**1. 层特异性比值比**\n\n对于分层 $Z=0$：\n暴露组 ($X=1$) 的事件比值为 $Odds_{X=1, Z=0} = \\frac{a_0}{b_0} = \\frac{20}{90} = \\frac{2}{9}$。\n非暴露组 ($X=0$) 的事件比值为 $Odds_{X=0, Z=0} = \\frac{c_0}{d_0} = \\frac{11}{99} = \\frac{1}{9}$。\n层特异性比值比为：\n$$OR_0 = \\frac{Odds_{X=1, Z=0}}{Odds_{X=0, Z=0}} = \\frac{2/9}{1/9} = 2.0$$\n或者，使用交叉乘积公式：\n$$OR_0 = \\frac{a_0 d_0}{b_0 c_0} = \\frac{20 \\times 99}{90 \\times 11} = \\frac{1980}{990} = 2.0$$\n\n对于分层 $Z=1$：\n暴露组 ($X=1$) 的事件比值为 $Odds_{X=1, Z=1} = \\frac{a_1}{b_1} = \\frac{60}{45} = \\frac{4}{3}$。\n非暴露组 ($X=0$) 的事件比值为 $Odds_{X=0, Z=1} = \\frac{c_1}{d_1} = \\frac{42}{63} = \\frac{2}{3}$。\n层特异性比值比为：\n$$OR_1 = \\frac{Odds_{X=1, Z=1}}{Odds_{X=0, Z=1}} = \\frac{4/3}{2/3} = 2.0$$\n或者，使用交叉乘积公式：\n$$OR_1 = \\frac{a_1 d_1}{b_1 c_1} = \\frac{60 \\times 63}{45 \\times 42} = \\frac{3780}{1890} = 2.0$$\n\n层特异性比值比是相同的：$OR_0 = OR_1 = 2.0$。\n\n**2. 基线风险**\n\n基线风险是每个分层中非暴露组 ($X=0$) 发生结局的风险。\n对于分层 $Z=0$：\n$$Risk_{X=0, Z=0} = \\frac{c_0}{c_0+d_0} = \\frac{11}{11+99} = \\frac{11}{110} = 0.1$$\n对于分层 $Z=1$：\n$$Risk_{X=0, Z=1} = \\frac{c_1}{c_1+d_1} = \\frac{42}{42+63} = \\frac{42}{105} = 0.4$$\n\n基线风险 $0.1$ 和 $0.4$ 是不同的。\n\n**3. 边际（合并）比值比**\n\n首先，我们将两个分层的计数汇总，形成一个边际 $2 \\times 2$ 表：\n-   总暴露事件数：$a_{marginal} = a_0 + a_1 = 20 + 60 = 80$。\n-   总暴露非事件数：$b_{marginal} = b_0 + b_1 = 90 + 45 = 135$。\n-   总非暴露事件数：$c_{marginal} = c_0 + c_1 = 11 + 42 = 53$。\n-   总非暴露非事件数：$d_{marginal} = d_0 + d_1 = 99 + 63 = 162$。\n\n边际比值比由这个汇总表计算得出：\n$$OR_{marginal} = \\frac{a_{marginal} \\times d_{marginal}}{b_{marginal} \\times c_{marginal}} = \\frac{80 \\times 162}{135 \\times 53} = \\frac{12960}{7155} \\approx 1.81132$$\n四舍五入到两位小数，$OR_{marginal} \\approx 1.81$。\n\n一个重要的注意事项是检查是否存在混杂。混杂因素必须与暴露和结局都有关联。可以检查其与暴露的关联：\n$P(X=1|Z=0) = \\frac{a_0+b_0}{a_0+b_0+c_0+d_0} = \\frac{110}{220} = 0.5$。\n$P(X=1|Z=1) = \\frac{a_1+b_1}{a_1+b_1+c_1+d_1} = \\frac{105}{210} = 0.5$。\n由于 $P(X=1|Z=0) = P(X=1|Z=1)$，协变量 $Z$ 与暴露 $X$ 无关。因此，$Z$ 不是一个混杂因素。\n\n### 逐项分析\n\n**A. 各层合并的边际比值比约等于 $1.81$，这与共同的层特异性比值比 $2.00$ 不同，表明即使在没有混杂的情况下，当基线风险不同时，比值比也具有不可合并性。**\n-   我们的计算表明，边际比值比确实约等于 $1.81$。\n-   我们的计算表明，共同的层特异性比值比是 $2.00$。\n-   这两个值，$1.81$ 和 $2.00$，是不同的。\n-   边际度量与恒定的层特异性度量之间的这种差异就是不可合并性的定义。\n-   该陈述正确地指出了本问题中导致不可合并性的条件：当分层变量（$Z$）是结局（$Y$）的风险因素时，即使它不是一个混杂因素（即与暴露 $X$ 无关），比值比也是不可合并的。我们验证了基线风险不同（$0.1$ 对 $0.4$），因此 $Z$ 是 $Y$ 的一个风险因素。我们还验证了 $Z$ 与 $X$ 无关，因此不存在混杂。该陈述完全准确。\n-   **结论：正确。**\n\n**B. 只要层特异性比值比相同，边际比值比就等于 $2.00$；因此，比值比通常是可以在各层之间合并的。**\n-   前提是错误的。我们计算出边际比值比约为 $1.81$，而不是 $2.00$。\n-   结论也是错误的。比值比通常是不可合并的，这是众所周知的事实。本问题中的情况是证明比值比可合并这一说法的一个教科书式的反例。\n-   **结论：不正确。**\n\n**C. 边际风险比等于 $1.81$，并且只要层特异性比值比在各层中是恒定的，边际风险比就等于边际比值比。**\n-   我们来计算边际风险比 ($RR_{marginal}$)。\n    -   暴露组的边际风险：$Risk_{X=1, marginal} = \\frac{a_{marginal}}{a_{marginal}+b_{marginal}} = \\frac{80}{80+135} = \\frac{80}{215}$。\n    -   非暴露组的边际风险：$Risk_{X=0, marginal} = \\frac{c_{marginal}}{c_{marginal}+d_{marginal}} = \\frac{53}{53+162} = \\frac{53}{215}$。\n    -   $RR_{marginal} = \\frac{80/215}{53/215} = \\frac{80}{53} \\approx 1.51$。\n-   该陈述声称边际风险比为 $1.81$，这是错误的。\n-   陈述的第二部分声称在给定条件下，边际风险比等于边际比值比。这也是错误的；我们发现 $RR_{marginal} \\approx 1.51$ 而 $OR_{marginal} \\approx 1.81$。除非结局罕见，否则这两个度量通常不相等。\n-   **结论：不正确。**\n\n**D. 边际比值比约等于 $1.33$，因为在一个分层中结局很常见，这迫使合并估计值与风险比相同。**\n-   第一部分是错误的。边际比值比约为 $1.81$，而不是 $1.33$。（值 $1.33$ 约等于分层 $Z=1$ 中暴露组的比值，即 $60/45 = 4/3 \\approx 1.33$）。\n-   其推理也是有缺陷的。常见结局会导致比值比和风险比发散，而不是收敛。关于常见结局迫使合并比值比等于风险比的说法是不正确的。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}