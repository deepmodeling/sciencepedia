{
    "hands_on_practices": [
        {
            "introduction": "在构建回归模型时，一个核心问题是如何确定连续预测变量与结果之间的函数关系。简单地假设线性关系可能导致模型设定偏误，而似然比检验 (Likelihood Ratio Test, LRT) 为我们提供了一个严格的统计框架，用以比较嵌套模型。这项练习将演示如何利用模型对数似然或偏差的差异，来判断是否需要引入如样条函数等非线性项，从而更准确地捕捉数据中的复杂模式。",
            "id": "4979389",
            "problem": "一家医院对 $n=1500$ 名成年重症监护室入院患者进行了一项队列研究，以对院内死亡率进行建模。令 $Y_{i} \\in \\{0,1\\}$ 表示死亡结局，并假设患者之间相互独立。考虑一个逻辑回归，它是广义线性模型 (GLM) 的一种特殊情况，使用 logit 连接函数，将 $Y_{i}$ 建模为参数为 $p_{i}$ 的伯努利随机变量，其中对数优势比是协变量的线性函数。模型拟合的基本基础是独立伯努利观测的似然函数 $\\mathcal{L}(\\theta) = \\prod_{i=1}^{n} p_{i}^{Y_{i}} (1-p_{i})^{1-Y_{i}}$，其对数似然函数为 $\\ell(\\theta) = \\sum_{i=1}^{n} \\left\\{ Y_{i} \\ln(p_{i}) + (1-Y_{i}) \\ln(1-p_{i}) \\right\\}$，模型偏差定义为 $D = -2\\,\\ell(\\hat{\\theta})$（不考虑加性常数），其中 $\\hat{\\theta}$ 表示最大似然估计值。\n\n为了评估基线血清肌酐浓度 $C$（单位为 $\\mathrm{mg}/\\mathrm{dL}$）对死亡率的影响是线性的还是需要非线性，研究人员使用相同的调整协变量（年龄、性别和共病指数）和相同的样本拟合了两个嵌套模型：\n\n- 简化模型 $\\mathcal{M}_{R}$：包含单个线性项 $C$。\n- 完整模型 $\\mathcal{M}_{F}$：$C$ 的限制性立方样条 (RCS) 表示，函数总自由度为 $4$（即，包括线性分量在内的 $4$ 个基函数），因此在线性项之外增加了 $3$ 个非线性基参数。\n\n对同一数据集上的嵌套模型进行最大似然拟合，得到以下摘要：\n- 简化模型的对数似然 $\\ell_{R} = -629.124$，偏差 $D_{R} = 1258.248$。\n- 完整模型的对数似然 $\\ell_{F} = -624.450$，偏差 $D_{F} = 1248.900$。\n\n使用似然、偏差的基本定义以及嵌套模型的似然比统计量的大样本零分布，计算“血清肌酐的效应是线性的”这一假设相对于“其效应是非线性的”这一备择假设的 $p$ 值。将答案四舍五入到四位有效数字。以纯数字形式表示最终答案（无单位）。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于统计建模的既定原则，特别是广义线性模型的似然理论。该问题定义明确，为唯一解提供了所有必要信息，并且没有矛盾、歧义或事实错误。所提供的数值数据在内部是一致的，因为偏差值是从对数似然值正确推导出来的（$D = -2\\ell$）。对于简化模型，$-2 \\times (-629.124) = 1258.248$，对于完整模型，$-2 \\times (-624.450) = 1248.900$。因此，我们可以进行正式求解。\n\n问题要求进行统计检验来比较两个嵌套模型：一个简化模型 $\\mathcal{M}_{R}$，其中血清肌酐 $C$ 的效应是线性的；以及一个完整模型 $\\mathcal{M}_{F}$，其中该效应由一个更复杂的非线性函数（限制性立方样条）表示。用于此比较的适当统计程序是似然比检验 (LRT)。\n\n此检验的原假设和备择假设是：\n$H_{0}$：死亡率的对数优势比与血清肌酐 $C$ 之间的关系是线性的。完整模型中用于非线性的额外参数为零。这对应于简化模型 $\\mathcal{M}_{R}$。\n$H_{A}$：该关系是限制性立方样条函数指定的非线性关系。至少有一个额外的非线性参数不为零。这对应于完整模型 $\\mathcal{M}_{F}$。\n\n似然比检验统计量，我们将其表示为 $\\Lambda_{LR}$，是根据两个模型的最大化对数似然 $\\ell_{R}$ 和 $\\ell_{F}$ 计算的。该统计量由下式给出：\n$$ \\Lambda_{LR} = 2 (\\ell_{F} - \\ell_{R}) $$\n或者，它可以使用模型偏差 $D_R$ 和 $D_F$ 来定义，其中偏差定义为 $D = -2\\ell$。\n$$ \\Lambda_{LR} = -2\\ell_{R} - (-2\\ell_{F}) = D_{R} - D_{F} $$\n\n使用提供的对数似然值：\n- 简化模型的对数似然 $\\ell_{R} = -629.124$。\n- 完整模型的对数似然 $\\ell_{F} = -624.450$。\n\n检验统计量计算如下：\n$$ \\Lambda_{LR} = 2 (-624.450 - (-629.124)) = 2 (-624.450 + 629.124) = 2(4.674) = 9.348 $$\n\n为了验证，我们可以使用偏差值：\n- 简化模型的偏差 $D_{R} = 1258.248$。\n- 完整模型的偏差 $D_{F} = 1248.900$。\n\n检验统计量为：\n$$ \\Lambda_{LR} = 1258.248 - 1248.900 = 9.348 $$\n结果相同，证实了计算的正确性。似然比检验统计量的值是 $9.348$。\n\n根据 Wilks 定理，对于大样本，在原假设 ($H_{0}$)下，似然比检验统计量 $\\Lambda_{LR}$ 的分布近似于卡方 ($\\chi^2$) 分布。这个 $\\chi^2$ 分布的自由度 ($df$) 等于完整模型和简化模型之间的参数数量之差。\n\n问题陈述指出，完整模型 $\\mathcal{M}_{F}$ 使用的关于 $C$ 的限制性立方样条函数具有 $4$ 个总自由度。简化模型 $\\mathcal{M}_{R}$ 使用单个线性项，对应 $1$ 个自由度。因此，参数数量的差异为：\n$$ df = (\\text{parameters in } \\mathcal{M}_{F}) - (\\text{parameters in } \\mathcal{M}_{R}) = 4 - 1 = 3 $$\n这与问题陈述中“完整模型在线性项之外增加了‘$3$ 个非线性基参数’”的说法一致。\n\n为了获得 $p$ 值，我们计算从自由度为 $3$ 的 $\\chi^2$ 分布中，观测到一个大于或等于我们计算出的检验统计量 $\\Lambda_{LR} = 9.348$ 的值的概率。$p$ 值由下式给出：\n$$ p = P(\\chi^2_{df=3} \\ge 9.348) $$\n\n这个概率必须使用统计软件或卡方分布表来计算。计算得出：\n$$ p \\approx 0.025003 $$\n\n问题要求答案四舍五入到四位有效数字。将 $0.025003$ 四舍五入到四位有效数字得到 $0.02500$。\n这个 $p$ 值表示，如果真实关系确实是线性的，仅凭偶然机会观测到如此大的模型拟合度改善（通过对数似然的增加来衡量）的概率。由于 $p$ 值很小（例如，小于常规的 $0.05$ 显著性水平），因此有统计上显著的证据拒绝线性效应的原假设，而支持样条模型所描述的非线性效应的备择假设。",
            "answer": "$$\\boxed{0.02500}$$"
        },
        {
            "introduction": "一个看似拟合良好的模型，其稳定性也可能受到个别数据点的过度影响。识别这些“强影响点”是模型诊断的关键一步，以确保研究结论的稳健性。这项练习将介绍DFBETA，一个衡量删除单个观测值后回归系数变化的标准化指标，并重点探讨如何根据样本量调整阈值来解释其大小，以及发现强影响点后应采取的审慎分析步骤。",
            "id": "4979343",
            "problem": "一个包含 $n=325$ 名成年患者的重症监护队列被用于分析，使用带有 logit 链接的逻辑回归模型来建模院内死亡率。协变量是入院时的血清乳酸（单位为 $\\mathrm{mmol/L}$）和年龄（单位为 $\\mathrm{years}$）。为了评估单个观测值对血清乳酸估计回归系数的影响，计算了一种名为 DFBETA（beta 差异）的病例删除诊断指标，它反映了从拟合中省略单个患者时乳酸系数的标准化变化。对于一名乳酸水平异常高的患者，其乳酸系数的绝对 DFBETA 值据报道为 $|DFBETA|=0.35$。\n\n基于病例删除如何影响最大似然估计的原则性考量以及回归诊断中标准化影响的常用阈值，哪个选项最能描述该患者对乳酸系数的可能影响以及适当的下一步措施？\n\nA. 因为样本量为 $n=325$，数值 $|DFBETA|=0.35$ 超过了根据样本量调整的阈值，表明该患者对乳酸系数具有影响力；该病例需要进行审查和敏感性分析，但自动排除是不合理的。\n\nB. 因为 $|DFBETA|=0.351$，该患者不具有影响力；无需采取进一步措施。\n\nC. 在逻辑回归中，任何 $|DFBETA|0.30$ 的情况都要求删除该病例，以保持系数估计的无偏性。\n\nD. DFBETA 的阈值不适用于逻辑回归；在二元结果模型中，只应使用库克距离（Cook’s distance）来衡量影响。\n\nE. 由于 $|DFBETA|=0.351$，该患者严重扭曲了模型，必须在排除该患者后重新拟合乳酸系数。",
            "solution": "用户提供了一个医学统计建模领域的问题，具体涉及逻辑回归的模型诊断。我将首先验证问题陈述，然后进行完整的解答和选项评估。\n\n### 问题验证\n\n**步骤 1：提取已知信息**\n-   样本量：$n=325$ 名成年患者。\n-   模型：带有 logit 链接的逻辑回归。\n-   结果变量：院内死亡率。\n-   协变量：入院时的血清乳酸（单位为 $\\mathrm{mmol/L}$）和年龄（单位为 $\\mathrm{years}$）。\n-   诊断工具：DFBETA（beta 差异），被描述为当单个患者被省略时乳酸系数的标准化变化。\n-   数据点：对于一名“乳酸水平异常高”的患者，该诊断指标的绝对值为 $|DFBETA|=0.35$。\n-   问题：根据原则性考量和常用阈值，描述该患者的影响力并确定适当的下一步措施。\n\n**步骤 2：使用提取的已知信息进行验证**\n-   **科学依据：** 该问题牢固地建立在公认的统计理论之上。逻辑回归是建模二元结果（如死亡率）的标准方法。DFBETA 是一种经典且广泛使用的病例删除影响诊断方法，适用于包括逻辑回归在内的广义线性模型。在重症监护医学背景下，使用乳酸和年龄等预测因子来预测死亡率，是此类模型的现实且常见的应用。\n-   **问题定义明确：** 该问题提供了应用影响诊断标准解释规则所需的所有信息（$n=325$ 和具体的 $|DFBETA|$ 值）。它要求基于既定原则进行评估，这指向了应用统计学领域内一个明确的答案。\n-   **客观性：** 问题陈述是客观的。“乳酸水平异常高”被呈现为促使进行诊断检查的患者特征，这是一种标准做法，而非主观论断。数值是具体给出的。问题本身指导解答者使用“原则性考量”和“常用阈值”，避免了主观性。\n\n该问题没有违反任何无效标准。它在科学上是合理的、定义明确的且客观的。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。我现在将进行完整的推导和分析。\n\n### 解答推导\n\n问题的核心在于如何解释单个观测值的 DFBETA 值。DFBETA 是一种量化观测值对特定回归系数影响的诊断指标。问题指出，计算出的值是一个“标准化变化”，通常表示为 DFBETAS。对于系数 $\\beta_j$ 和观测值 $i$，DFBETAS 的计算公式为：\n$$ DFBETAS_{i,j} = \\frac{\\hat{\\beta}_j - \\hat{\\beta}_{j(i)}}{SE_{(i)}(\\hat{\\beta}_j)} $$\n其中 $\\hat{\\beta}_j$ 是使用完整数据集估计的系数，$\\hat{\\beta}_{j(i)}$ 是删除观测值 $i$ 后估计的系数，而 $SE_{(i)}(\\hat{\\beta}_j)$ 是在没有观测值 $i$ 的模型拟合中该系数的标准误。该诊断指标以标准误为单位来衡量系数的变化。\n\n问题是在一个样本量为 $n=325$ 的研究中，如何解释 $|DFBETAS| = 0.35$ 这个数值。使用 DFBETAS 识别影响点有两种常见的经验法则：\n\n1.  **绝对阈值：** 一些从业者认为，如果 $|DFBETAS|  1$ 或者更保守地 $|DFBETAS|  2$，则该观测值具有影响力。$|DFBETAS|  1$ 的值意味着删除单个观测值会使系数估计值移动超过一个标准误，这是一个显著的变化。\n2.  **根据样本量调整的阈值：** 一个更被广泛推荐的阈值，特别是对于较大数据集，是由 Belsley, Kuh, and Welsch 提出的。他们建议，如果一个观测值的 $|DFBETAS|$ 值超过 $\\frac{2}{\\sqrt{n}}$，则该观测值可能具有影响力。这个阈值考虑到了在大学习中，任何单个观测值预计都会有较小的影响。\n\n让我们将根据样本量调整的阈值应用于给定问题：\n-   样本量：$n = 325$。\n-   阈值：$\\frac{2}{\\sqrt{n}} = \\frac{2}{\\sqrt{325}}$。\n\n为了评估这一点，我们可以近似计算 $\\sqrt{325}$：\n$\\sqrt{325} = \\sqrt{25 \\times 13} = 5\\sqrt{13}$。\n因为 $3.6^2 = 12.96$ 且 $3.7^2 = 13.69$，所以 $\\sqrt{13}$ 略大于 3.6。一个更精确的值是 $\\sqrt{325} \\approx 18.028$。\n因此，阈值为：\n$$ \\frac{2}{18.028} \\approx 0.111 $$\n题目给出，对于所讨论的患者，其 $|DFBETA| = 0.35$。\n将观测值与阈值进行比较：\n$$ 0.35  0.111 $$\n观测到的乳酸系数的 $|DFBETA|$ 值大大超过了根据样本量调整的阈值。因此，根据这一标准准则，该患者是乳酸系数的一个影响点。\n\n下一步是决定采取何种适当的行动。将一个点识别为“影响点”并不自动意味着应该删除它。自动删除是一种糟糕的统计实践，因为它可能通过审查有效数据而引入偏差，并可能导致模型不能很好地代表潜在的人群。影响诊断的目的是标记出需要进一步审查的案例。原则性的方法包括：\n1.  **数据验证：** 检查患者记录中是否存在数据录入错误或测量伪影。该患者的乳酸值是否被正确记录？\n2.  **合理性检查：** 评估观测值虽然极端，但在临床和生物学上是否合理。\n3.  **敏感性分析：** 在不包含该影响点的情况下重新拟合模型，并将结果（系数、标准误、p 值和总体结论）与原始模型进行比较。应该理解并报告这单个案例对研究结论的影响。\n\n基于此分析，该患者确实具有影响力，正确的做法是进行仔细的审查和敏感性分析，而不是自动排除。\n\n### 逐项分析\n\n**A. 因为样本量为 $n=325$，数值 $|DFBETA|=0.35$ 超过了根据样本量调整的阈值，表明该患者对乳酸系数具有影响力；该病例需要进行审查和敏感性分析，但自动排除是不合理的。**\n-   该选项正确地指出，影响力应相对于样本量来判断。它正确地应用了这一原则，因为我们计算出的阈值约为 $0.11$，而 $0.35$ 超过了该值。然后，它推荐了应用统计学中正确的行动方案：审查和敏感性分析，同时明确告诫不要自动排除。这一陈述与我们的推导完全一致。\n-   **结论：正确。**\n\n**B. 因为 $|DFBETA|=0.351$，该患者不具有影响力；无需采取进一步措施。**\n-   该选项使用了 $|DFBETA|  1$ 的绝对阈值。虽然这是识别*高度*影响点的一个有效（尽管不太敏感）的经验法则，但忽略任何低于此阈值的点是不可取的，特别是当更敏感的、根据样本量调整的阈值（本例中为 $0.111$）被明显超过时。宣布该患者“不具有影响力”并且“无需采取进一步措施”是错误的，并且是对标准诊断程序的轻视。\n-   **结论：不正确。**\n\n**C. 在逻辑回归中，任何 $|DFBETA|0.30$ 的情况都要求删除该病例，以保持系数估计的无偏性。**\n-   这个陈述在多个方面都有缺陷。首先，对于 DFBETA，没有一个通用的、僵化的 $0.30$ 阈值。其次，更关键的是，一个影响点并不*强制要求*被删除。自动删除是糟糕的实践。第三，删除一个有效（但极端）的数据点本身就可能引入偏差，导致模型不能代表患者特征的全部范围。\n-   **结论：不正确。**\n\n**D. DFBETA 的阈值不适用于逻辑回归；在二元结果模型中，只应使用库克距离（Cook’s distance）来衡量影响。**\n-   这个陈述在事实上是不正确的。DFBETA 和 DFBETAS 是广义线性模型（GLM）的标准诊断指标，而逻辑回归是其中的一个重要成员。虽然库克距离是另一个重要的影响度量（评估对所有系数的总体影响），但它的目的与 DFBETA 不同，后者评估对单个特定系数的影响。两者都是有效的，并且常用于逻辑回归。\n-   **结论：不正确。**\n\n**E. 由于 $|DFBETA|=0.351$，该患者严重扭曲了模型，必须在排除该患者后重新拟合乳酸系数。**\n-   该选项的前提包含一个基本的数学错误：声称 $0.35  1$ 是错误的。此外，即使该值大于 $1$，得出模型*必须*在没有该患者的情况下重新拟合的结论也过于强烈，代表了糟糕的统计实践，正如在选项 C 的分析中所解释的那样。\n-   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在面对多个候选模型时，研究者需要在模型拟合优度与模型复杂度之间做出权衡。参数越多的模型虽然能更好地拟合现有数据，但可能因过拟合而导致其在预测新数据时表现不佳。本练习将探讨两种关键的模型选择工具——赤池信息准则 (Akaike Information Criterion, AIC) 和贝叶斯信息准则 (Bayesian Information Criterion, BIC)，它们通过对模型复杂度施加惩罚来解决这一问题，帮助我们挑选出预测性能更优的模型。",
            "id": "4979360",
            "problem": "一个医院研究团队正在比较两个概率模型，用于在一个包含 $n=1000$ 名患者的队列中预测一个二元结果（术后并发症的出现与否）。两个模型都通过最大似然法进行拟合，并且旨在用于样本外预测。模型 $1$ 使用 $k_{1}=10$ 个参数，并达到了最大化对数似然值 $\\ell_{1}=-520$。模型 $2$ 使用 $k_{2}=15$ 个参数，并达到了最大化对数似然值 $\\ell_{2}=-505$。从最大似然估计的定义、惩罚模型复杂度以近似样本外期望散度的原则，以及通过模型的期望预测性能和边际似然来比较模型的渐近论证出发，推导赤池信息准则（AIC）和贝叶斯信息准则（BIC）的大样本形式。在给定 $\\ell_{1}$、$\\ell_{2}$、$k_{1}$、$k_{2}$ 和 $n$ 的情况下，使用这些推导出的形式计算两个模型的准则值，并确定每个准则偏好哪个模型。不需要四舍五入；在适当的情况下报告精确表达式。将你的最终答案表示为一个行向量 $\\left(AIC_{1},\\,AIC_{2},\\,BIC_{1},\\,BIC_{2},\\,a_{\\mathrm{AIC}},\\,a_{\\mathrm{BIC}}\\right)$，其中如果AIC偏好模型1，则$a_{\\mathrm{AIC}}$等于1，如果AIC偏好模型2，则$a_{\\mathrm{AIC}}$等于2；并且如果BIC偏好模型1，则$a_{\\mathrm{BIC}}$等于1，如果BIC偏好模型2，则$a_{\\mathrm{BIC}}$等于2。",
            "solution": "问题要求从第一性原理出发推导赤池信息准则（AIC）和贝叶斯信息准则（BIC），随后应用它们来比较两个统计模型。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 样本量：$n=1000$\n- 模型1参数：$k_1 = 10$\n- 模型1最大化对数似然：$\\ell_1 = -520$\n- 模型2参数：$k_2 = 15$\n- 模型2最大化对数似然：$\\ell_2 = -505$\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于已建立的模型选择统计理论。它提法明确、客观，并为求解提供了完整且一致的信息集。所提供的值对于此类医学研究是切合实际的。从基本原理推导AIC和BIC的任务是理论统计学中一个标准但高级的练习。该问题不违反任何无效性标准。\n\n**步骤3：结论与行动**\n问题被认定为有效。将提供完整解答。\n\n### 赤池信息准则（AIC）的推导\n\nAIC的目标是选择一个在来自同一数据生成过程的新的、未见过的数据上提供最佳预测性能的模型。它形式化了模型拟合度（拟合优度）和模型复杂度之间的权衡。该框架基于最小化真实的、未知的数据生成分布 $f(x)$ 与由拟合模型所代表的分布 $g(x|\\hat{\\theta})$ 之间的期望Kullback-Leibler（KL）散度，其中 $\\hat{\\theta}$ 是模型参数的最大似然估计（MLE）。\n\nKL散度定义为：\n$$\nD_{\\text{KL}}(f || g) = \\int f(x) \\ln\\left(\\frac{f(x)}{g(x|\\hat{\\theta})}\\right) dx = E_{f(x)}[\\ln f(x)] - E_{f(x)}[\\ln g(x|\\hat{\\theta})]\n$$\n为了选择一个模型，我们希望找到使该散度最小化的模型 $g$。由于 $E_{f(x)}[\\ln f(x)]$ 对所有模型都是一个常数，这等价于在真实分布下最大化模型的期望对数似然 $E_{f(x)}[\\ln g(x|\\hat{\\theta})]$。\n\n挑战在于我们不知道 $f(x)$，而且我们只有一个数据集，它产生了一个单一的估计值 $\\hat{\\theta}$。样本内最大化对数似然 $\\ell(\\hat{\\theta}) = \\sum_{i=1}^n \\ln g(x_i|\\hat{\\theta})$ 是样本外期望对数似然的一个有偏估计量。Akaike 证明，在某些正则性条件下，对于大样本，偏差约等于估计参数的数量 $k$。\n\n具体来说，他证明了目标量（与期望KL散度成正比）的一个近似无偏估计量是由最大化对数似然减去参数数量的惩罚项给出的。\n最大化对数似然的期望值可以通过以下渐近关系与真实的期望对数似然相关联：\n$$\nE_{\\text{data}} \\left[ E_{f(y)}[\\ln g(y|\\hat{\\theta})] \\right] \\approx E_{\\text{data}}[\\ell(\\hat{\\theta})] - k\n$$\n其中 $y$ 代表一个新的数据点。因此，$\\ell(\\hat{\\theta}) - k$ 是期望预测对数似然的一个渐近无偏估计量（相差一个缩放因子 $n$）。为了将该准则置于类似偏差的尺度上，习惯上乘以 $-2$。这就得到了赤池信息准则：\n$$\n\\text{AIC} = -2\\ell(\\hat{\\theta}) + 2k\n$$\n其中 $\\ell(\\hat{\\theta})$ 是模型的最大化对数似然， $k$ 是自由参数的数量。AIC值最低的模型是首选，因为它被估计具有最低的信息损失，从而具有最佳的样本外预测性能。\n\n### 贝叶斯信息准则（BIC）的推导\n\nBIC，或称 Schwarz 准则，源于模型选择的贝叶斯视角。其目标是在给定数据 $D$ 的情况下，选择后验概率最高的模型。设 $\\{M_1, M_2, \\dots, M_m\\}$ 为候选模型集。根据贝叶斯定理，模型 $M_j$ 的后验概率为：\n$$\nP(M_j|D) = \\frac{P(D|M_j) P(M_j)}{P(D)}\n$$\n如果我们假设所有模型具有相同的先验概率 $P(M_j) = \\text{constant}$，那么选择后验概率最高的模型等价于选择使边际似然 $P(D|M_j)$ 最大化的模型。边际似然是通过在模型的整个参数空间 $\\Theta_j$ 上对似然函数进行积分来计算的，并由参数的先验分布 $P(\\theta|M_j)$ 加权：\n$$\nP(D|M_j) = \\int_{\\Theta_j} P(D|\\theta, M_j) P(\\theta|M_j) d\\theta\n$$\n这里，$P(D|\\theta, M_j)$ 是似然函数 $L(\\theta|D)$。这个积分通常是难以处理的。对于大样本量 $n$，我们可以使用拉普拉斯近似。设 $\\ell(\\theta) = \\ln L(\\theta|D)$ 为对数似然。我们可以在其最大值点，即最大似然估计 $\\hat{\\theta}$ 附近，对 $\\ell(\\theta)$ 进行二阶泰勒展开：\n$$\n\\ell(\\theta) \\approx \\ell(\\hat{\\theta}) + (\\theta - \\hat{\\theta})^T \\nabla\\ell(\\hat{\\theta}) + \\frac{1}{2}(\\theta - \\hat{\\theta})^T \\nabla^2\\ell(\\hat{\\theta}) (\\theta - \\hat{\\theta})\n$$\n由于 $\\hat{\\theta}$ 是最大似然估计，梯度 $\\nabla\\ell(\\hat{\\theta})$ 为零。项 $\\nabla^2\\ell(\\hat{\\theta})$ 是海森矩阵 $H$。对于大样本，$-H$ 可以用费雪信息矩阵 $I(\\hat{\\theta})$ 来近似，它与 $n$ 成比例。\n边际似然的积分变为：\n$$\nP(D|M_j) \\approx \\int \\exp\\left(\\ell(\\hat{\\theta}) + \\frac{1}{2}(\\theta - \\hat{\\theta})^T H (\\theta - \\hat{\\theta})\\right) P(\\theta|M_j) d\\theta\n$$\n假设先验 $P(\\theta|M_j)$ 在 $\\hat{\\theta}$ 附近相对平坦，我们可以用其在最大似然估计点的值 $P(\\hat{\\theta}|M_j)$ 来近似，并将其移到积分外。\n$$\nP(D|M_j) \\approx \\exp(\\ell(\\hat{\\theta})) P(\\hat{\\theta}|M_j) \\int \\exp\\left(-\\frac{1}{2}(\\theta - \\hat{\\theta})^T (-H) (\\theta - \\hat{\\theta})\\right) d\\theta\n$$\n该积分是多元高斯形式。其值为 $(2\\pi)^{k/2} |-H|^{-1/2}$。渐近地，观测到的费雪信息 $-H$ 约等于单个观测值的费雪信息的 $n$ 倍，所以 $|-H| \\propto n^k$。将其代回：\n$$\nP(D|M_j) \\propto L(\\hat{\\theta}) n^{-k/2}\n$$\n取对数：\n$$\n\\ln P(D|M_j) \\approx \\ln L(\\hat{\\theta}) - \\frac{k}{2} \\ln(n) = \\ell(\\hat{\\theta}) - \\frac{k}{2} \\ln(n)\n$$\n其中不随 $n$ 增长的项已被舍去。习惯上，BIC 通过乘以 $-2$ 来定义在偏差尺度上：\n$$\n\\text{BIC} = -2\\ell(\\hat{\\theta}) + k \\ln(n)\n$$\nBIC值最低的模型是首选。对于任何 $n  e^2 \\approx 7.4$，BIC对模型复杂度的惩罚比AIC更重。其目标是一致性：如果真实模型在候选模型之中，当 $n \\to \\infty$ 时，BIC将以趋近于1的概率选择它。\n\n### 应用于模型\n\n给定 $n=1000$。\n对于模型1：$k_1 = 10$, $\\ell_1 = -520$。\n对于模型2：$k_2 = 15$, $\\ell_2 = -505$。\n\n**AIC计算：**\n公式为 $\\text{AIC} = -2\\ell + 2k$。\n对于模型1：\n$$\n\\text{AIC}_1 = -2(-520) + 2(10) = 1040 + 20 = 1060\n$$\n对于模型2：\n$$\n\\text{AIC}_2 = -2(-505) + 2(15) = 1010 + 30 = 1040\n$$\n\n**BIC计算：**\n公式为 $\\text{BIC} = -2\\ell + k \\ln(n)$。\n对于模型1：\n$$\n\\text{BIC}_1 = -2(-520) + 10 \\ln(1000) = 1040 + 10 \\ln(1000)\n$$\n对于模型2：\n$$\n\\text{BIC}_2 = -2(-505) + 15 \\ln(1000) = 1010 + 15 \\ln(1000)\n$$\n\n### 模型比较\n\n**AIC比较：**\n我们比较 $\\text{AIC}_1 = 1060$ 和 $\\text{AIC}_2 = 1040$。因为较低的AIC值表示更好的模型，我们寻找最小值。\n$$\n1040  1060 \\implies \\text{AIC}_2  \\text{AIC}_1\n$$\n因此，AIC偏好模型2。指示符 $a_{\\text{AIC}}$ 为 $2$。\n\n**BIC比较：**\n我们比较 $\\text{BIC}_1 = 1040 + 10 \\ln(1000)$ 和 $\\text{BIC}_2 = 1010 + 15 \\ln(1000)$。\n为了确定哪个更小，我们来考察它们的差值：\n$$\n\\text{BIC}_2 - \\text{BIC}_1 = (1010 + 15 \\ln(1000)) - (1040 + 10 \\ln(1000))\n$$\n$$\n\\text{BIC}_2 - \\text{BIC}_1 = (1010 - 1040) + (15 - 10)\\ln(1000) = -30 + 5 \\ln(1000)\n$$\n我们需要确定这个差值的符号。这取决于 $5 \\ln(1000)$ 是大于还是小于 $30$。这个不等式等价于 $\\ln(1000) > 6$，或 $1000 > e^6$。\n我们知道 $e \\approx 2.718$，所以 $e^2 \\approx 7.389$ 并且 $e^3 \\approx 20.086$。\n那么 $e^6 = (e^3)^2 \\approx (20.086)^2 \\approx 403.4$。\n由于 $1000 > 403.4$，所以 $\\ln(1000) > 6$ 是成立的。\n因此，$5 \\ln(1000) > 30$，这意味着 $\\text{BIC}_2 - \\text{BIC}_1 > 0$，或 $\\text{BIC}_2 > \\text{BIC}_1$。\n因为较低的BIC值表示更好的模型，所以BIC偏好模型1。指示符 $a_{\\text{BIC}}$ 为 $1$。\n\n最终结果是：\n$\\text{AIC}_1 = 1060$\n$\\text{AIC}_2 = 1040$\n$\\text{BIC}_1 = 1040 + 10 \\ln(1000)$\n$\\text{BIC}_2 = 1010 + 15 \\ln(1000)$\n$a_{\\text{AIC}} = 2$\n$a_{\\text{BIC}} = 1$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1060  1040  1040 + 10\\ln(1000)  1010 + 15\\ln(1000)  2  1 \\end{pmatrix}}\n$$"
        }
    ]
}