{
    "hands_on_practices": [
        {
            "introduction": "第一个实践聚焦于线性回归的基石：估计模型系数。你将使用来自一个假设性临床试验的汇总统计数据，应用普通最小二乘法 (OLS) 公式来计算截距和斜率，然后将这些数值结果转化为具有临床意义的解释。本练习旨在巩固基本计算，并强调统计输出与实际医学应用之间的关键联系。",
            "id": "4840047",
            "problem": "一个临床药理学团队正在对一种新型降血压药物进行早期剂量探索研究。对于每位参与者，团队记录了所施用的剂量（单位为毫克）以及四周后收缩压（SBP）的变化（单位为毫米汞柱）。假设参与者 $i$ 的剂量与收缩压变化之间的关系遵循简单线性回归模型\n$$\nY_i \\;=\\; \\beta_0 \\;+\\; \\beta_1 X_i \\;+\\; \\varepsilon_i,\n$$\n其中 $Y_i$ 是收缩压变化，$X_i$ 是剂量，$\\beta_0$ 和 $\\beta_1$ 是未知的回归参数，误差 $\\varepsilon_i$ 相互独立，均值为 $0$ 且方差恒定，这反映了在医学证据生成中证明普通最小二乘估计合理性的标准条件。\n\n一个包含 $n=40$ 名参与者的数据集产生了以下摘要统计量：样本均值 $\\bar{X}=5$ 和 $\\bar{Y}=12$，以及中心化和 $S_{xx}=160$ 和 $S_{xy}=320$。从最小二乘原理出发，推导出估计量 $(\\hat{\\beta}_0,\\hat{\\beta}_1)$，并使用提供的摘要数据计算其数值。然后，在降血压疗效的剂量-反应背景下，对斜率 $\\hat{\\beta}_1$ 提供一个有临床意义的解释，明确指出每单位剂量变化对应的收缩压变化。报告 $(\\hat{\\beta}_0,\\hat{\\beta}_1)$ 为精确值，不进行四舍五入。解释中应使用毫克作为剂量单位，毫米汞柱作为收缩压变化单位，但数值估计量本身应不带单位报告。",
            "solution": "该问题被评估为有效。它在应用于标准临床研究背景的统计推断中，提出了一个定义明确、有科学依据且客观的问题。所提供的摘要统计量是完整且一致的，允许通过普通最小二乘法得到唯一解。\n\n简单线性回归模型由下式给出\n$$\nY_i \\;=\\; \\beta_0 \\;+\\; \\beta_1 X_i \\;+\\; \\varepsilon_i,\n$$\n其中 $Y_i$ 是收缩压（SBP）的变化，$X_i$ 是施用的剂量，$\\beta_0$ 和 $\\beta_1$ 是未知的回归参数，$\\varepsilon_i$ 是独立同分布的随机误差，其均值为 $E[\\varepsilon_i] = 0$ 且方差恒定为 $\\text{Var}(\\varepsilon_i) = \\sigma^2$。\n\n普通最小二乘法（OLS）原理旨在找到使残差平方和（SSR）最小化的估计量 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$。残差平方和被定义为 $\\beta_0$ 和 $\\beta_1$ 的函数：\n$$\nSSR(\\beta_0, \\beta_1) = \\sum_{i=1}^{n} (Y_i - \\hat{Y}_i)^2 = \\sum_{i=1}^{n} (Y_i - (\\beta_0 + \\beta_1 X_i))^2.\n$$\n为了找到使该函数最小化的 $\\beta_0$ 和 $\\beta_1$ 的值，我们对 $SSR(\\beta_0, \\beta_1)$ 分别求关于每个参数的偏导数，并将其设为零。这些就是正规方程。\n\n关于 $\\beta_0$ 的偏导数是：\n$$\n\\frac{\\partial SSR}{\\partial \\beta_0} = \\sum_{i=1}^{n} 2(Y_i - \\beta_0 - \\beta_1 X_i)(-1) = -2 \\sum_{i=1}^{n} (Y_i - \\beta_0 - \\beta_1 X_i).\n$$\n将其设为零，得到关于估计量 $\\hat{\\beta}_0$ 和 $\\hat{\\beta}_1$ 的第一个正规方程：\n$$\n\\sum_{i=1}^{n} (Y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 X_i) = 0 \\\\\n\\sum Y_i - n\\hat{\\beta}_0 - \\hat{\\beta}_1 \\sum X_i = 0.\n$$\n除以样本大小 $n$ 可得：\n$$\n\\bar{Y} - \\hat{\\beta}_0 - \\hat{\\beta}_1 \\bar{X} = 0,\n$$\n这可以重新整理以用斜率估计量 $\\hat{\\beta}_1$ 来表示截距估计量 $\\hat{\\beta}_0$：\n$$\n\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X}.\n$$\n此推导表明最小二乘回归线必须通过样本均值点 $(\\bar{X}, \\bar{Y})$。\n\n关于 $\\beta_1$ 的偏导数是：\n$$\n\\frac{\\partial SSR}{\\partial \\beta_1} = \\sum_{i=1}^{n} 2(Y_i - \\beta_0 - \\beta_1 X_i)(-X_i) = -2 \\sum_{i=1}^{n} X_i(Y_i - \\beta_0 - \\beta_1 X_i).\n$$\n将其设为零，得到第二个正规方程：\n$$\n\\sum_{i=1}^{n} X_i(Y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 X_i) = 0 \\\\\n\\sum X_i Y_i - \\hat{\\beta}_0 \\sum X_i - \\hat{\\beta}_1 \\sum X_i^2 = 0.\n$$\n现在，将第一个正规方程中 $\\hat{\\beta}_0$ 的表达式代入第二个：\n$$\n\\sum X_i Y_i - (\\bar{Y} - \\hat{\\beta}_1 \\bar{X}) \\sum X_i - \\hat{\\beta}_1 \\sum X_i^2 = 0 \\\\\n\\sum X_i Y_i - \\bar{Y}\\sum X_i + \\hat{\\beta}_1 \\bar{X}\\sum X_i - \\hat{\\beta}_1 \\sum X_i^2 = 0.\n$$\n重新整理以解出 $\\hat{\\beta}_1$：\n$$\n\\hat{\\beta}_1 \\left( \\bar{X}\\sum X_i - \\sum X_i^2 \\right) = \\bar{Y}\\sum X_i - \\sum X_i Y_i.\n$$\n两边乘以 $-1$ 并代入 $\\sum X_i = n\\bar{X}$：\n$$\n\\hat{\\beta}_1 \\left( \\sum X_i^2 - n\\bar{X}^2 \\right) = \\sum X_i Y_i - n\\bar{X}\\bar{Y}.\n$$\n括号中的项是离均差平方和与积和的定义：\n$S_{xx} = \\sum_{i=1}^{n} (X_i - \\bar{X})^2 = \\sum X_i^2 - n\\bar{X}^2$。\n$S_{xy} = \\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y}) = \\sum X_i Y_i - n\\bar{X}\\bar{Y}$。\n\n因此，推导出的斜率参数 $\\beta_1$ 的估计量为：\n$$\n\\hat{\\beta}_1 = \\frac{\\sum X_i Y_i - n\\bar{X}\\bar{Y}}{\\sum X_i^2 - n\\bar{X}^2} = \\frac{S_{xy}}{S_{xx}}.\n$$\n因此，推导出的估计量为 $\\hat{\\beta}_1 = \\frac{S_{xy}}{S_{xx}}$ 和 $\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X}$。\n\n现在，我们使用包含 $n=40$ 名参与者的数据集的摘要统计量来计算数值：$\\bar{X}=5$, $\\bar{Y}=12$, $S_{xx}=160$, and $S_{xy}=320$。\n\n首先，我们计算斜率估计值 $\\hat{\\beta}_1$：\n$$\n\\hat{\\beta}_1 = \\frac{S_{xy}}{S_{xx}} = \\frac{320}{160} = 2.\n$$\n接着，我们计算截距估计值 $\\hat{\\beta}_0$：\n$$\n\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X} = 12 - (2)(5) = 12 - 10 = 2.\n$$\n估计的回归方程式为 $\\hat{Y}_i = 2 + 2 X_i$。估计的参数为 $(\\hat{\\beta}_0, \\hat{\\beta}_1) = (2, 2)$。\n\n最后，我们对斜率估计量 $\\hat{\\beta}_1$ 提供一个具有临床意义的解释。回归线的斜率代表预测变量每增加一个单位，反应变量的估计变化量。在这里，反应变量 $Y$ 是收缩压的变化（单位为毫米汞柱，mmHg），预测变量 $X$ 是剂量（单位为毫克，mg）。\n\n$\\hat{\\beta}_1 = 2$ 的值表示，新型药物的剂量每增加 1 毫克，收缩压的变化估计会增加 2 毫米汞柱。收缩压变化的正值表示血压升高。因此，这个结果表明，在观察到的剂量范围内，该药物具有升压作用，这与降血压药物的预期目的相反。这在早期试验中是一个关键的发现，表明该药物可能无效甚至可能有害。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基础知识之后，这个实践将探讨当自变量的单位发生改变时，回归系数会如何变化。这种情况在医学研究中整合来自不同来源的数据时很常见。通过推导新旧系数之间的关系，你将更深刻地理解斜率的含义以及模型的结构特性，例如预测值的不变性。",
            "id": "4984474",
            "problem": "一个临床药理学团队使用普通最小二乘法（OLS）的简单线性回归模型，研究结局变量——12周低密度脂蛋白胆固醇（LDL-C）的变化量 $Y$（单位 $\\mathrm{mmol}/\\mathrm{L}$）——与预测变量——基线他汀类药物剂量 $X$（单位 $\\mathrm{mg}$）——之间的关系：对于受试者 $i=1,\\dots,n$，模型为 $Y_{i}=\\beta_{0}+\\beta_{1}X_{i}+\\varepsilon_{i}$，其中随机误差 $\\varepsilon_{i}$ 满足 $\\mathbb{E}[\\varepsilon_{i}]=0$，$\\operatorname{Var}(\\varepsilon_{i})=\\sigma^{2}\\in(0,\\infty)$，并且 $\\{\\varepsilon_{i}\\}$ 与 $X_{i}$ 以及彼此之间不相关。设基于 $X$ 的原始单位拟合的OLS估计值为 $\\hat{\\beta}_{0}$ 和 $\\hat{\\beta}_{1}$。\n\n为了协调多个研究中的单位，数据协调中心通过 $X^{\\ast}_{i}=cX_{i}$（其中 $c=10^{-3}$）将预测变量的单位重新换算为克，并更一般地考虑任意严格正的换算因子 $c>0$。请从OLS作为残差平方和最小化者的定义出发，并仅使用样本均值和方差的核心性质，推导对于 $Y$ 对 $X^{\\ast}$ 的回归，新的OLS估计值 $(\\hat{\\beta}_{0}^{\\ast},\\hat{\\beta}_{1}^{\\ast})$ 关于 $(\\hat{\\beta}_{0},\\hat{\\beta}_{1})$ 和 $c$ 的解析表达式。解释在将单位从 $\\mathrm{mg}$ 转换为 $\\mathrm{g}$ 时，这种换算如何改变斜率的临床解释，以及为什么预测结果在这种单位变化下保持不变。\n\n以包含数对 $(\\hat{\\beta}_{1}^{\\ast},\\hat{\\beta}_{0}^{\\ast})$ 的单个闭式表达式提供最终答案。不需要进行数值舍入。最终答案中不包含任何单位。",
            "solution": "问题陈述被评估为有效。它在科学上基于统计建模的原理，特别是简单线性回归。问题设置是适定的、完整的和客观的，描述了在预测变量线性换算下，系数估计值如何变换的标准分析。不存在缺陷、矛盾或歧义。\n\n任务是推导对换算后的预测变量 $X^{\\ast}$ 进行结果 $Y$ 回归的新普通最小二乘（OLS）估计值 $(\\hat{\\beta}_{0}^{\\ast}, \\hat{\\beta}_{1}^{\\ast})$。原始模型是 $Y_{i}=\\beta_{0}+\\beta_{1}X_{i}+\\varepsilon_{i}$，对于受试者 $i=1,\\dots,n$，新的预测变量定义为 $X^{\\ast}_{i}=cX_{i}$，其中 $c>0$ 是一个严格为正的常数。推导必须从最小化残差平方和开始。\n\n新的回归模型是 $Y_i = \\beta_0^{\\ast} + \\beta_1^{\\ast} X_i^{\\ast} + \\varepsilon_i^{\\ast}$。OLS估计值 $(\\hat{\\beta}_{0}^{\\ast}, \\hat{\\beta}_{1}^{\\ast})$ 是使残差平方和 $SSR(\\beta_0^{\\ast}, \\beta_1^{\\ast})$ 最小化的 $(\\beta_0^{\\ast}, \\beta_1^{\\ast})$ 的值：\n$$ SSR(\\beta_0^{\\ast}, \\beta_1^{\\ast}) = \\sum_{i=1}^{n} (Y_i - (\\beta_0^{\\ast} + \\beta_1^{\\ast} X_i^{\\ast}))^2 $$\n为了找到最小值，我们计算关于 $\\beta_0^{\\ast}$ 和 $\\beta_1^{\\ast}$ 的偏导数，并将其设为零。这些是正规方程。\n\n关于 $\\beta_0^{\\ast}$ 的偏导数是：\n$$ \\frac{\\partial SSR}{\\partial \\beta_0^{\\ast}} = \\sum_{i=1}^{n} 2(Y_i - \\hat{\\beta}_0^{\\ast} - \\hat{\\beta}_1^{\\ast} X_i^{\\ast})(-1) = -2 \\sum_{i=1}^{n} (Y_i - \\hat{\\beta}_0^{\\ast} - \\hat{\\beta}_1^{\\ast} X_i^{\\ast}) $$\n将其设为 $0$ 可得：\n$$ \\sum_{i=1}^{n} Y_i - n\\hat{\\beta}_0^{\\ast} - \\hat{\\beta}_1^{\\ast} \\sum_{i=1}^{n} X_i^{\\ast} = 0 $$\n除以 $n$ 并重新整理，我们用样本均值 $\\bar{Y} = \\frac{1}{n}\\sum Y_i$ 和 $\\bar{X}^{\\ast} = \\frac{1}{n}\\sum X_i^{\\ast}$ 来表示 $\\hat{\\beta}_0^{\\ast}$：\n$$ \\bar{Y} - \\hat{\\beta}_0^{\\ast} - \\hat{\\beta}_1^{\\ast} \\bar{X}^{\\ast} = 0 \\implies \\hat{\\beta}_0^{\\ast} = \\bar{Y} - \\hat{\\beta}_1^{\\ast} \\bar{X}^{\\ast} $$\n\n关于 $\\beta_1^{\\ast}$ 的偏导数是：\n$$ \\frac{\\partial SSR}{\\partial \\beta_1^{\\ast}} = \\sum_{i=1}^{n} 2(Y_i - \\hat{\\beta}_0^{\\ast} - \\hat{\\beta}_1^{\\ast} X_i^{\\ast})(-X_i^{\\ast}) = -2 \\sum_{i=1}^{n} (Y_i - \\hat{\\beta}_0^{\\ast} - \\hat{\\beta}_1^{\\ast} X_i^{\\ast})X_i^{\\ast} $$\n将其设为 $0$ 并代入 $\\hat{\\beta}_0^{\\ast}$ 的表达式：\n$$ \\sum_{i=1}^{n} (Y_i - (\\bar{Y} - \\hat{\\beta}_1^{\\ast} \\bar{X}^{\\ast}) - \\hat{\\beta}_1^{\\ast} X_i^{\\ast})X_i^{\\ast} = 0 $$\n$$ \\sum_{i=1}^{n} ((Y_i - \\bar{Y}) - \\hat{\\beta}_1^{\\ast}(X_i^{\\ast} - \\bar{X}^{\\ast}))X_i^{\\ast} = 0 $$\n$$ \\sum_{i=1}^{n} (Y_i - \\bar{Y})X_i^{\\ast} - \\hat{\\beta}_1^{\\ast} \\sum_{i=1}^{n} (X_i^{\\ast} - \\bar{X}^{\\ast})X_i^{\\ast} = 0 $$\n求解 $\\hat{\\beta}_1^{\\ast}$ 可得：\n$$ \\hat{\\beta}_1^{\\ast} = \\frac{\\sum_{i=1}^{n} (Y_i - \\bar{Y})X_i^{\\ast}}{\\sum_{i=1}^{n} (X_i^{\\ast} - \\bar{X}^{\\ast})X_i^{\\ast}} $$\n使用标准恒等式 $\\sum (A_i - \\bar{A})B_i = \\sum (A_i - \\bar{A})(B_i - \\bar{B})$ 和 $\\sum (B_i - \\bar{B})B_i = \\sum (B_i - \\bar{B})^2$，我们可以将其重写为更常见的形式：\n$$ \\hat{\\beta}_1^{\\ast} = \\frac{\\sum_{i=1}^{n} (X_i^{\\ast} - \\bar{X}^{\\ast})(Y_i - \\bar{Y})}{\\sum_{i=1}^{n} (X_i^{\\ast} - \\bar{X}^{\\ast})^2} $$\n现在，我们将这些新的估计值与原始估计值 $(\\hat{\\beta}_{0}, \\hat{\\beta}_{1})$ 联系起来。原始估计值由以下公式给出：\n$$ \\hat{\\beta}_1 = \\frac{\\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^{n} (X_i - \\bar{X})^2} \\quad \\text{和} \\quad \\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X} $$\n我们使用变换 $X^{\\ast}_{i}=cX_{i}$。这意味着样本均值也相应地进行换算：$\\bar{X}^{\\ast} = \\frac{1}{n}\\sum_{i=1}^{n} (cX_i) = c(\\frac{1}{n}\\sum_{i=1}^{n} X_i) = c\\bar{X}$。\n\n将这些代入 $\\hat{\\beta}_1^{\\ast}$ 的表达式中：\n$$ \\hat{\\beta}_1^{\\ast} = \\frac{\\sum_{i=1}^{n} (cX_i - c\\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^{n} (cX_i - c\\bar{X})^2} = \\frac{c \\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y})}{c^2 \\sum_{i=1}^{n} (X_i - \\bar{X})^2} = \\frac{1}{c} \\left( \\frac{\\sum_{i=1}^{n} (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^{n} (X_i - \\bar{X})^2} \\right) $$\n因此，我们得到了斜率系数的关系：\n$$ \\hat{\\beta}_1^{\\ast} = \\frac{1}{c} \\hat{\\beta}_1 $$\n现在，我们来求截距系数的关系：\n$$ \\hat{\\beta}_0^{\\ast} = \\bar{Y} - \\hat{\\beta}_1^{\\ast} \\bar{X}^{\\ast} = \\bar{Y} - \\left(\\frac{1}{c} \\hat{\\beta}_1\\right) (c\\bar{X}) = \\bar{Y} - \\hat{\\beta}_1 \\bar{X} $$\n根据定义，$\\hat{\\beta}_0 = \\bar{Y} - \\hat{\\beta}_1 \\bar{X}$。因此：\n$$ \\hat{\\beta}_0^{\\ast} = \\hat{\\beta}_0 $$\nOLS截距在预测变量的换算下是不变的。\n\n接下来，我们讨论临床解释。原始预测变量 $X$ 是以毫克（$\\mathrm{mg}$）为单位的他汀类药物剂量，结果 $Y$ 是以 $\\mathrm{mmol}/\\mathrm{L}$ 为单位的LDL-C变化量。原始斜率 $\\hat{\\beta}_1$ 表示他汀类药物剂量每增加 $1~\\mathrm{mg}$，LDL-C（单位 $\\mathrm{mmol}/\\mathrm{L}$）的估计平均变化量。\n为了将预测变量的单位从毫克（$\\mathrm{mg}$）转换为克（$\\mathrm{g}$），我们使用因子 $c = 10^{-3}$，因为 $X^{\\ast} (\\mathrm{g}) = 10^{-3} X (\\mathrm{mg})$。新的斜率是：\n$$ \\hat{\\beta}_1^{\\ast} = \\frac{\\hat{\\beta}_1}{c} = \\frac{\\hat{\\beta}_1}{10^{-3}} = 1000\\hat{\\beta}_1 $$\n这个新的斜率 $\\hat{\\beta}_1^{\\ast}$ 表示他汀类药物剂量每增加 $1~\\mathrm{g}$，LDL-C（单位 $\\mathrm{mmol}/\\mathrm{L}$）的估计平均变化量。由于增加 $1~\\mathrm{g}$ 是增加 $1~\\mathrm{mg}$ 的1000倍，相应的LDL-C预期变化量也大1000倍。系数的大小发生变化，以反映预测变量尺度的变化。\n\n最后，我们证明预测结果保持不变。对于给定的观测值 $i$，原始模型的预测值为 $\\hat{Y}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 X_i$。对于相同的观测值，新模型的预测值为 $\\hat{Y}_i^{\\ast} = \\hat{\\beta}_0^{\\ast} + \\hat{\\beta}_1^{\\ast} X_i^{\\ast}$。代入推导出的系数和预测变量的关系：\n$$ \\hat{Y}_i^{\\ast} = (\\hat{\\beta}_0) + \\left(\\frac{1}{c}\\hat{\\beta}_1\\right) (cX_i) = \\hat{\\beta}_0 + \\hat{\\beta}_1 X_i = \\hat{Y}_i $$\n预测值是相同的。这在逻辑上是必然的：预测变量测量单位的变化只是数据表示形式的表面变化，而不是潜在物理或生物关系的变化。统计模型会正确地调整其系数，以确保对任何给定的物理剂量（例如，$50~\\mathrm{mg}$ 的剂量，也即 $0.05~\\mathrm{g}$ 的剂量）的预测值保持不变，无论使用何种单位。截距保持不变，因为它对应于零剂量（$X=0~\\mathrm{mg}$ 等价于 $X^{\\ast}=0~\\mathrm{g}$）时的预测结果，而斜率则与预测变量的单位尺度成反比变化，以保持它们的乘积恒定。\n\n最终答案要求用 $(\\hat{\\beta}_{1}, \\hat{\\beta}_{0})$ 和 $c$ 来表示数对 $(\\hat{\\beta}_{1}^{\\ast}, \\hat{\\beta}_{0}^{\\ast})$。表达式为 $\\hat{\\beta}_1^{\\ast} = \\frac{\\hat{\\beta}_1}{c}$ 和 $\\hat{\\beta}_0^{\\ast} = \\hat{\\beta}_0$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\hat{\\beta}_{1}}{c}  \\hat{\\beta}_{0} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "最后一个实践将介绍一种用于量化不确定性的强大计算技术：非参数自助法 (nonparametric bootstrap)。你将不再依赖传统统计检验的严格理论假设，而是通过重采样来为回归斜率构建置信区间。这个动手编程练习展示了一种稳健、现代的统计推断方法，它在生物信息学和医学统计学中得到了广泛应用。",
            "id": "2429424",
            "problem": "给定您多个独立的成对观测值集合，这些观测值代表了来自单一生物体的不同蛋白质编码基因的鸟嘌呤-胞嘧啶含量（GC含量）和归一化基因表达水平。对于每个集合，考虑简单线性回归模型 $y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$，其中 $x_i$ 表示GC含量（表示为区间 $[0,1]$ 内的一个分数），$y_i$ 表示以2为底的对数百万转录本（TPM）尺度上的归一化表达水平，$\\beta_0$ 是截距，$\\beta_1$ 是斜率，$\\varepsilon_i$ 是观测值 $i$ 的未观测到的残差。斜率 $\\beta_1$ 定义为在该模型下最小化残差平方和的普通最小二乘系数。\n\n您的任务是使用对成对观测值进行非参数自助法重采样的方法，为每个集合的斜率 $\\beta_1$ 构建一个置信水平为 $0.95$ 的双侧置信区间。对于每个集合，将观测到的配对 $\\{(x_i,y_i)\\}_{i=1}^n$ 视为一个经验分布，该分布在每个观测对上赋予 $1/n$ 的概率质量。从中进行 $B$ 次有放回的自助采样，每次样本大小为 $n$，为每个自助样本计算斜率估计值，然后报告自助法斜率分布中下端点位于概率 $0.025$ 处、上端点位于概率 $0.975$ 处的百分位区间。对于每个集合，请使用提供的伪随机种子以确保可复现性。\n\n测试套件（四个不同的集合）。在每种情况下，$x$ 表示GC含量（分数），$y$ 表示以2为底的TPM对数值。对于每种情况，报告 $\\beta_1$ 的 $0.95$ 置信区间的两个端点。\n\n- 案例 $1$（普遍递增关联）：\n  - $x$：$0.34, 0.36, 0.40, 0.41, 0.43, 0.45, 0.48, 0.50, 0.52, 0.55, 0.57, 0.60$\n  - $y$：$4.10, 4.00, 4.30, 4.50, 4.60, 4.90, 5.00, 5.30, 5.40, 5.80, 6.00, 6.20$\n  - 置信水平：$0.95$；自助法重复次数：$B=8000$；种子：$13579$。\n\n- 案例 $2$（接近零的关联）：\n  - $x$：$0.31, 0.33, 0.35, 0.38, 0.40, 0.42, 0.44, 0.47, 0.49, 0.51, 0.53, 0.56$\n  - $y$：$5.10, 4.95, 5.05, 5.00, 5.02, 4.98, 5.01, 5.04, 4.96, 5.03, 4.97, 5.00$\n  - 置信水平：$0.95$；自助法重复次数：$B=8000$；种子：$24680$。\n\n- 案例 $3$（普遍递减关联）：\n  - $x$：$0.30, 0.34, 0.37, 0.39, 0.41, 0.44, 0.46, 0.49, 0.51, 0.54, 0.58, 0.61$\n  - $y$：$7.00, 6.80, 6.60, 6.50, 6.30, 6.10, 6.00, 5.90, 5.70, 5.50, 5.30, 5.20$\n  - 置信水平：$0.95$；自助法重复次数：$B=8000$；种子：$11235$。\n\n- 案例 $4$（样本量较小，递增关联）：\n  - $x$：$0.32, 0.36, 0.40, 0.45, 0.50, 0.54, 0.58, 0.62$\n  - $y$：$3.80, 3.95, 4.10, 4.30, 4.45, 4.60, 4.80, 4.95$\n  - 置信水平：$0.95$；自助法重复次数：$B=8000$；种子：$98765$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。列表中的每个元素对应于上述顺序的一个测试案例，并且本身是一个包含置信区间下端点和上端点的双元素列表。每个数值端点必须使用标准四舍五入法保留六位小数。例如，一个有效的输出形状是 $[[\\ell_1,u_1],[\\ell_2,u_2],[\\ell_3,u_3],[\\ell_4,u_4]]$，其中 $\\ell_k$ 和 $u_k$ 分别表示案例 $k$ 的下端点和上端点。",
            "solution": "在尝试任何解决方案之前，问题陈述都经过了严格的验证。\n\n**步骤 1：提取给定条件**\n- **模型**：简单线性回归模型，形式为 $y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$。\n- **自变量 ($x_i$)**：鸟嘌呤-胞嘧啶含量 (GC含量)，一个在 $[0,1]$ 区间内的分数。\n- **因变量 ($y_i$)**：归一化基因表达水平，以2为底的对数百万转录本 (TPM) 尺度。\n- **目标参数**：使用普通最小二乘法 (OLS) 估计的斜率系数 $\\beta_1$。\n- **任务**：为四个独立的成对观测值集合，构建 $\\beta_1$ 的置信水平为 $0.95$ 的双侧置信区间。\n- **方法论**：对成对观测值 $\\{(x_i, y_i)\\}$ 进行非参数自助法重采样。置信区间为百分位区间。\n- **步骤**：\n    1. 对于每个包含 $n$ 对观测值的集合，有放回地抽取 $B$ 个大小为 $n$ 的自助样本。\n    2. 为每个自助样本计算 OLS 斜率估计值 $\\hat{\\beta}_1^*$。\n    3. 从得到的自助法斜率分布的分位数构建置信区间。下端点是 $0.025$ 分位数，上端点是 $0.975$ 分位数。\n- **各案例特定参数**：\n    - **案例 1**：提供了数据数组 $x$ 和 $y$。$B=8000$ 次自助法重复。伪随机数生成种子为 $13579$。\n    - **案例 2**：提供了数据数组 $x$ 和 $y$。$B=8000$ 次自助法重复。种子为 $24680$。\n    - **案例 3**：提供了数据数组 $x$ 和 $y$。$B=8000$ 次自助法重复。种子为 $11235$。\n    - **案例 4**：提供了数据数组 $x$ 和 $y$。$B=8000$ 次自助法重复。种子为 $98765$。\n- **输出格式**：单行包含一个双元素列表的列表，`[[\\ell_1,u_1],[\\ell_2,u_2],[\\ell_3,u_3],[\\ell_4,u_4]]`，其中 $\\ell_k$ 和 $u_k$ 是案例 $k$ 的下端点和上端点，四舍五入到六位小数。\n\n**步骤 2：验证**\n- **科学依据**：该问题具有坚实的科学基础。研究诸如GC含量之类的基因组特征与基因表达之间的关系是计算生物学和生物信息学中的一个基本课题。简单线性回归和非参数自助法是用于此类分析的标准、稳健的统计方法。该问题不含伪科学。\n- **适定性**：该问题是适定的。它清楚地定义了输入（数据、参数）、统计程序（OLS、百分位自助法）以及所需的输出格式。提供种子确保了唯一且可复现的解决方案。\n- **客观性**：问题以精确、客观和定量的术语陈述。没有主观或模糊的陈述。\n- **完整性与一致性**：问题是自洽的。每个案例所需的所有数据、模型和参数（样本大小 $n$、重复次数 $B$、置信水平 $1-\\alpha$ 和随机种子）都已明确提供。没有内部矛盾。\n\n**步骤 3：结论**\n该问题被认为是**有效的**。这是一个应用于现实生物学背景的标准统计任务，定义严谨，并包含其解决方案所需的所有必要信息。因此，我们可以继续进行。\n\n**求解方法**\n\n目标是为简单线性回归模型的斜率参数 $\\beta_1$ 构建一个 $95\\%$ 的置信区间。指定的方法是非参数自助法，该方法对误差项 $\\varepsilon_i$ 的分布不做强假设。\n\n我们感兴趣的统计量是普通最小二乘法 (OLS) 对斜率的估计值 $\\hat{\\beta}_1$。对于一个包含 $n$ 对观测值 $\\{(x_i, y_i)\\}_{i=1}^n$ 的样本，最小化残差平方和 $\\sum_{i=1}^n (y_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 x_i))^2$ 的 OLS 估计量 $\\hat{\\beta}_1$ 由以下公式给出：\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2} = \\frac{\\text{Cov}(x, y)}{\\text{Var}(x)}\n$$\n其中 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^n x_i$ 和 $\\bar{y} = \\frac{1}{n} \\sum_{i=1}^n y_i$ 分别是自变量和因变量的样本均值。\n\n解决方案的核心是非参数自助法算法，我们将把它应用于所有四个案例：\n1. 原始的 $n$ 对数据集 $D = \\{(x_1, y_1), \\dots, (x_n, y_n)\\}$ 被视为经验分布函数，其中每对观测值被选中的概率为 $1/n$。\n2. 使用指定的种子初始化伪随机数生成器以确保可复现性。\n3. 共生成 $B=8000$ 个自助样本。每个自助样本 $D^*_j$（其中 $j \\in \\{1, \\dots, B\\}$）是通过从原始数据集 $D$ 中有放回地抽取 $n$ 对观测值而创建的。\n4. 对于每个自助样本 $D^*_j$，使用 $D^*_j$ 中的数据，通过上述公式计算 OLS 斜率估计值，记为 $\\hat{\\beta}_{1,j}^*$。\n5. 这个过程产生一个包含 $B$ 个自助法斜率估计值的集合，即 $\\{\\hat{\\beta}_{1,1}^*, \\hat{\\beta}_{1,2}^*, \\dots, \\hat{\\beta}_{1,B}^*\\}$。这个集合可作为估计量 $\\hat{\\beta}_1$ 抽样分布的经验近似。\n\n为了构建置信区间，我们使用百分位法。对于置信水平 $1-\\alpha = 0.95$，我们有 $\\alpha=0.05$。置信区间的下界和上界由排序后的自助法斜率分布的 $\\alpha/2 = 0.025$ 和 $1-\\alpha/2 = 0.975$ 分位数确定。\n- 设排序后的自助法斜率列表为 $\\hat{\\beta}_{1,(1)}^* \\leq \\hat{\\beta}_{1,(2)}^* \\leq \\dots \\leq \\hat{\\beta}_{1,(B)}^*$。\n- 下端点 $\\ell$ 是此排序列表中位于第 $B \\times (\\alpha/2)$ 位置的值。\n- 上端点 $u$ 是位于第 $B \\times (1-\\alpha/2)$ 位置的值。\n\n将使用 Python 的 `numpy` 库进行实现。对于每个案例，我们将：\n- 定义数据数组 $x$ 和 $y$。\n- 使用给定的种子实例化一个随机数生成器。\n- 循环 $B=8000$ 次。在每次迭代中，生成自助法索引，选择相应的配对以形成自助样本，并计算斜率 $\\hat{\\beta}_1^*$。\n- 循环结束后，将使用 `numpy.quantile` 高效地计算这 $8000$ 个斜率估计值集合的 $0.025$ 和 $0.975$ 分位数。\n- 所得的端点将按要求四舍五入到六位小数。最终输出将格式化为表示列表的列表的单个字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes 95% bootstrap confidence intervals for the slope of a simple linear regression model\n    for four different bioinformatics datasets.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"x\": np.array([0.34, 0.36, 0.40, 0.41, 0.43, 0.45, 0.48, 0.50, 0.52, 0.55, 0.57, 0.60]),\n            \"y\": np.array([4.10, 4.00, 4.30, 4.50, 4.60, 4.90, 5.00, 5.30, 5.40, 5.80, 6.00, 6.20]),\n            \"B\": 8000,\n            \"seed\": 13579\n        },\n        {\n            \"x\": np.array([0.31, 0.33, 0.35, 0.38, 0.40, 0.42, 0.44, 0.47, 0.49, 0.51, 0.53, 0.56]),\n            \"y\": np.array([5.10, 4.95, 5.05, 5.00, 5.02, 4.98, 5.01, 5.04, 4.96, 5.03, 4.97, 5.00]),\n            \"B\": 8000,\n            \"seed\": 24680\n        },\n        {\n            \"x\": np.array([0.30, 0.34, 0.37, 0.39, 0.41, 0.44, 0.46, 0.49, 0.51, 0.54, 0.58, 0.61]),\n            \"y\": np.array([7.00, 6.80, 6.60, 6.50, 6.30, 6.10, 6.00, 5.90, 5.70, 5.50, 5.30, 5.20]),\n            \"B\": 8000,\n            \"seed\": 11235\n        },\n        {\n            \"x\": np.array([0.32, 0.36, 0.40, 0.45, 0.50, 0.54, 0.58, 0.62]),\n            \"y\": np.array([3.80, 3.95, 4.10, 4.30, 4.45, 4.60, 4.80, 4.95]),\n            \"B\": 8000,\n            \"seed\": 98765\n        }\n    ]\n\n    all_results = []\n    confidence_level = 0.95\n    alpha = 1.0 - confidence_level\n    lower_quantile = alpha / 2.0\n    upper_quantile = 1.0 - lower_quantile\n\n    def calculate_slope(x, y):\n        \"\"\"Calculates the OLS slope coefficient.\"\"\"\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        numerator = np.sum((x - x_mean) * (y - y_mean))\n        denominator = np.sum((x - x_mean)**2)\n        # Denominator is non-zero for the given datasets and their bootstrap samples\n        # as x values are not all identical.\n        return numerator / denominator\n\n    for case in test_cases:\n        x_data = case[\"x\"]\n        y_data = case[\"y\"]\n        n = len(x_data)\n        B = case[\"B\"]\n        seed = case[\"seed\"]\n\n        rng = np.random.default_rng(seed)\n        \n        bootstrap_slopes = np.empty(B)\n\n        for i in range(B):\n            indices = rng.choice(n, size=n, replace=True)\n            x_boot = x_data[indices]\n            y_boot = y_data[indices]\n            \n            # The case where all x_boot values are identical is highly improbable\n            # and does not occur with the given seeds and data. We proceed without\n            # an explicit check for denominator == 0 for efficiency.\n            bootstrap_slopes[i] = calculate_slope(x_boot, y_boot)\n        \n        ci_lower = np.quantile(bootstrap_slopes, lower_quantile)\n        ci_upper = np.quantile(bootstrap_slopes, upper_quantile)\n\n        rounded_result = [round(ci_lower, 6), round(ci_upper, 6)]\n        all_results.append(rounded_result)\n\n    # Format the output string exactly as specified.\n    # `map(str, all_results)` produces strings like '[1.23, 4.56]',\n    # which are then joined by commas.\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}