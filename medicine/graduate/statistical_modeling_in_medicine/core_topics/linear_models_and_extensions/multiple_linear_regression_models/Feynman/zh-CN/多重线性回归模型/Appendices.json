{
    "hands_on_practices": [
        {
            "introduction": "在医学研究中，一个治疗方法的效果往往不是一成不变的，它可能因患者的年龄、病情严重程度等其他因素而异。包含交互项的多元线性回归模型是量化这种效应修饰（effect modification）的有力工具。本练习将指导您如何在一个包含治疗与年龄交互项的模型中，计算特定年龄下治疗的边际效应及其标准误，这对于从模型中提取具有临床意义的、个体化的结论至关重要。",
            "id": "4977020",
            "problem": "一项随机对照试验 (RCT) 评估了一种新的抗高血压疗法对 $3$ 个月后收缩压 (SBP) 短期变化的影响，该变化以毫米汞柱 (mmHg) 为单位测量。令 $y$ 表示观察到的 SBP 变化，其中负值表示降低。患者由一个二元处理分配 $x_{\\text{treat}} \\in \\{0,1\\}$ 和以年为单位的年龄 $x_{\\text{age}} \\in \\mathbb{R}$ 来表征。考虑以下通过普通最小二乘法 (OLS) 拟合的条件期望的多元线性回归模型，\n$$\nE[y \\mid x] \\;=\\; \\beta_0 \\;+\\; \\beta_{\\text{treat}}\\, x_{\\text{treat}} \\;+\\; \\beta_{\\text{age}}\\, x_{\\text{age}} \\;+\\; \\beta_{\\text{treat}\\times \\text{age}}\\, \\big(x_{\\text{treat}} \\cdot x_{\\text{age}}\\big),\n$$\n将在指定年龄 $a_0$ 时的边际处理效应定义为在该年龄下条件均值相对于处理的变化率。给定 OLS 系数估计值\n$$\n\\hat{\\boldsymbol{\\beta}} \\;=\\; \\big(\\hat{\\beta}_0,\\hat{\\beta}_{\\text{treat}},\\hat{\\beta}_{\\text{age}},\\hat{\\beta}_{\\text{treat}\\times \\text{age}}\\big)^{\\top}\n\\;=\\;\n\\big(1.8,\\,-4.6,\\,0.12,\\,-0.045\\big)^{\\top},\n$$\n及其估计的方差-协方差矩阵（单位为 $\\text{mmHg}^2$），\n$$\n\\hat{\\Sigma} \\;=\\;\n\\begin{pmatrix}\n4.0  & -0.12  & -0.02  & 0.001 \\\\\n-0.12  & 1.44  & 0.03  & 0.006 \\\\\n-0.02  & 0.03  & 0.0025  & -0.0002 \\\\\n0.001  & 0.006  & -0.0002  & 0.0009\n\\end{pmatrix}.\n$$\n取指定年龄为 $a_0 = 65$。仅使用 $E[y \\mid x]$ 的线性预测器的定义、作为偏导数的边际效应概念，以及 OLS 系数估计值的任何线性组合的方差由方差-协方差矩阵决定的性质，计算在年龄 $a_0$ 时的估计边际处理效应的标准误。将您的答案四舍五入到四位有效数字，并以 $\\text{mmHg}$ 为单位表示。",
            "solution": "多元线性回归模型指定了一个线性条件均值，\n$$\nE[y \\mid x] \\;=\\; \\beta_0 \\;+\\; \\beta_{\\text{treat}}\\, x_{\\text{treat}} \\;+\\; \\beta_{\\text{age}}\\, x_{\\text{age}} \\;+\\; \\beta_{\\text{treat}\\times \\text{age}}\\, \\big(x_{\\text{treat}} \\cdot x_{\\text{age}}\\big).\n$$\n根据定义，在年龄 $x_{\\text{age}} = a_0$ 时的边际处理效应是条件均值相对于 $x_{\\text{treat}}$ 的偏导数，并在 $x_{\\text{age}} = a_0$ 处求值：\n$$\n\\frac{\\partial}{\\partial x_{\\text{treat}}} E[y \\mid x] \\bigg|_{x_{\\text{age}}=a_0}\n\\;=\\;\n\\beta_{\\text{treat}} \\;+\\; \\beta_{\\text{treat}\\times \\text{age}}\\, a_0.\n$$\n这个量衡量了在年龄 $a_0$ 时，$E[y \\mid x]$ 随 $x_{\\text{treat}}$ 单位变化的瞬时变化。由于 $x_{\\text{treat}}$ 是一个指示变量，这等价于在线性模型下，年龄为 $a_0$ 的处理组和未处理组之间条件均值的差异。\n\n边际处理效应的相应估计量是\n$$\n\\hat{L}(a_0) \\;=\\; \\hat{\\beta}_{\\text{treat}} \\;+\\; \\hat{\\beta}_{\\text{treat}\\times \\text{age}}\\, a_0.\n$$\n为了获得其标准误，我们使用 OLS 的一个经过充分检验的性质，即估计系数的任何线性组合的方差由方差-协方差矩阵决定。设系数向量的排序如下\n$$\n\\hat{\\boldsymbol{\\beta}} \\;=\\; \\big(\\hat{\\beta}_0,\\hat{\\beta}_{\\text{treat}},\\hat{\\beta}_{\\text{age}},\\hat{\\beta}_{\\text{treat}\\times \\text{age}}\\big)^{\\top}.\n$$\n那么 $\\hat{L}(a_0)$ 是一个权重向量为\n$$\n\\boldsymbol{g}(a_0) \\;=\\; \\big(0,\\,1,\\,0,\\,a_0\\big)^{\\top}\n$$\n的线性组合。因此，\n$$\n\\operatorname{Var}\\big(\\hat{L}(a_0)\\big) \\;=\\; \\boldsymbol{g}(a_0)^{\\top}\\, \\hat{\\Sigma}\\, \\boldsymbol{g}(a_0),\n\\quad\n\\text{和}\n\\quad\n\\operatorname{SE}\\big(\\hat{L}(a_0)\\big) \\;=\\; \\sqrt{\\,\\boldsymbol{g}(a_0)^{\\top}\\, \\hat{\\Sigma}\\, \\boldsymbol{g}(a_0)\\,}.\n$$\n代入 $a_0 = 65$ 和给定的 $\\hat{\\Sigma}$，只有涉及 $\\hat{\\beta}_{\\text{treat}}$ 和 $\\hat{\\beta}_{\\text{treat}\\times \\text{age}}$ 的项有贡献：\n$$\n\\boldsymbol{g}(65)^{\\top}\\, \\hat{\\Sigma}\\, \\boldsymbol{g}(65)\n\\;=\\;\n\\hat{\\Sigma}_{22}\n\\;+\\;\n2 \\cdot 65 \\cdot \\hat{\\Sigma}_{24}\n\\;+\\;\n65^2 \\cdot \\hat{\\Sigma}_{44}.\n$$\n已知 $\\hat{\\Sigma}_{22} = 1.44$，$\\hat{\\Sigma}_{24} = 0.006$ 和 $\\hat{\\Sigma}_{44} = 0.0009$，我们得到\n$$\n\\operatorname{Var}\\big(\\hat{L}(65)\\big)\n\\;=\\;\n1.44 \\;+\\; 2 \\cdot 65 \\cdot 0.006 \\;+\\; 65^2 \\cdot 0.0009\n\\;=\\;\n1.44 \\;+\\; 0.78 \\;+\\; 3.8025\n\\;=\\;\n6.0225.\n$$\n因此标准误是\n$$\n\\operatorname{SE}\\big(\\hat{L}(65)\\big)\n\\;=\\;\n\\sqrt{6.0225}\n\\;\\approx\\;\n2.454077\\ldots\n$$\n四舍五入到四位有效数字（并按要求以 $\\text{mmHg}$ 为单位表示），标准误为 $2.454$。\n\n为了解释，在 65 岁时的估计边际处理效应是\n$$\n\\hat{L}(65) \\;=\\; \\hat{\\beta}_{\\text{treat}} \\;+\\; \\hat{\\beta}_{\\text{treat}\\times \\text{age}} \\cdot 65\n\\;=\\; -4.6 \\;+\\; (-0.045)\\cdot 65\n\\;=\\; -7.525,\n$$\n这意味着，在 65 岁时，相对于对照组，治疗与预期 SBP 变化减少约 $7.525$ $\\text{mmHg}$ 相关，其标准误约为 $2.454$ $\\text{mmHg}$。标准误的计算是通过方差-协方差矩阵得出 OLS 系数估计值的线性组合的方差。",
            "answer": "$$\\boxed{2.454}$$"
        },
        {
            "introduction": "当变量之间的关系并非线性时，我们常常会使用多项式回归。然而，直接在模型中引入变量的高次幂（如 $x^2, x^3$）会引发严重的多重共线性和数值计算问题，使得系数估计不稳定且难以解释。本练习将介绍一种更为稳健的方法——使用格拉姆-施密特（Gram–Schmidt）过程构建正交多项式基来拟合模型，这不仅能提高模型的数值稳定性，还能加深您对不同基底下回归系数之间关系的理解。",
            "id": "4977056",
            "problem": "一项小型观察性研究探究了无急性感染的成年人中年龄与高敏C反应蛋白 (hsCRP) 之间的关系。设响应变量为hsCRP浓度（单位：毫克/升，mg/L），记为 $y$，解释变量为年龄（单位：年），记为 $x$。多元线性回归模型允许 $x$ 的多项式依赖关系和一个截距项，并带有加性噪声 $\\varepsilon$，假定其均值为零且方差有限。为提高相对于原始幂次项的数值稳定性，该多项式模型使用正交多项式构建，这些正交多项式是通过对中心化年龄 $x_{c} = x - \\bar{x}$ 进行Gram–Schmidt过程得到的。两个函数 $f$ 和 $g$ 在观测样本上的内积定义为 $\\langle f, g \\rangle = \\sum_{i=1}^{n} f(x_{c,i}) g(x_{c,i})$，其中 $n$ 是样本量，$x_{c,i}$ 是中心化年龄值。\n\n$n=5$ 名受试者的数据：\n- 年龄（年）: $\\{36, 38, 40, 42, 44\\}$。\n- hsCRP值 (mg/L): $\\{3.7, 1.9, 1.3, 1.9, 3.7\\}$。\n\n考虑模型\n$$\ny_i = \\beta_0 p_0(x_{c,i}) + \\beta_1 p_1(x_{c,i}) + \\beta_2 p_2(x_{c,i}) + \\beta_3 p_3(x_{c,i}) + \\varepsilon_i,\n$$\n其中 $\\{p_0, p_1, p_2, p_3\\}$ 是在给定内积下对 $\\{1, x_c, x_c^2, x_c^3\\}$ 应用Gram–Schmidt过程得到的正交多项式。利用Gram–Schmidt构造所蕴含的正交性，通过普通最小二乘法拟合此模型，然后将拟合模型以原始单项式基 $\\{1, x_c, x_c^2, x_c^3\\}$ 表示：\n$$\ny_i = \\alpha_0 + \\alpha_1 x_{c,i} + \\alpha_2 x_{c,i}^2 + \\alpha_3 x_{c,i}^3 + \\varepsilon_i.\n$$\n\n从最小二乘估计和Gram–Schmidt过程的基本定义出发，推导正交多项式和相应的最小二乘系数，将拟合模型转换为原始单项式基，并确定原始二次项系数 $\\alpha_2$ 的数值。以 $\\text{mg/L}/\\text{年}^2$ 为单位用数值表示最终系数，并将答案四舍五入到四位有效数字。",
            "solution": "用户需要找到以原始单项式基表示的多项式回归模型中二次项的系数 $\\alpha_2$。题目要求首先使用通过Gram–Schmidt过程得到的正交多项式基来拟合模型。\n\n在平均年龄处中心化的原始单项式基模型由下式给出\n$$\n\\hat{y}_i = \\alpha_0 + \\alpha_1 x_{c,i} + \\alpha_2 x_{c,i}^2 + \\alpha_3 x_{c,i}^3\n$$\n其中 $x_{c,i} = x_i - \\bar{x}$。该模型将通过首先拟合一个等价的正交基 $\\{p_0, p_1, p_2, p_3\\}$ 模型来估计：\n$$\n\\hat{y}_i = \\hat{\\beta}_0 p_0(x_{c,i}) + \\hat{\\beta}_1 p_1(x_{c,i}) + \\hat{\\beta}_2 p_2(x_{c,i}) + \\hat{\\beta}_3 p_3(x_{c,i})\n$$\n题目要求我们求出 $\\alpha_2$。\n\n**步骤1：数据准备和初步计算**\n首先，我们准备数据。给定的年龄为 $x = \\{36, 38, 40, 42, 44\\}$。样本量为 $n=5$。平均年龄是\n$$\n\\bar{x} = \\frac{36 + 38 + 40 + 42 + 44}{5} = \\frac{200}{5} = 40 \\text{ 年}.\n$$\n中心化年龄值为 $x_{c,i} = x_i - \\bar{x}$：\n$$\n\\{x_{c,i}\\} = \\{36-40, 38-40, 40-40, 42-40, 44-40\\} = \\{-4, -2, 0, 2, 4\\}.\n$$\n响应变量值为 $y = \\{3.7, 1.9, 1.3, 1.9, 3.7\\}$。\nGram–Schmidt过程的内积需要计算 $x_{c,i}$ 的幂次和。由于 $x_{c,i}$ 值关于0对称，所有奇次幂的和均为零：对于奇数 $k$，$\\sum x_c^k = 0$。\n$$\n\\sum_{i=1}^{5} x_{c,i}^0 = \\sum_{i=1}^{5} 1 = 5 \\\\\n\\sum_{i=1}^{5} x_{c,i}^1 = -4 - 2 + 0 + 2 + 4 = 0 \\\\\n\\sum_{i=1}^{5} x_{c,i}^2 = (-4)^2 + (-2)^2 + 0^2 + 2^2 + 4^2 = 16 + 4 + 0 + 4 + 16 = 40 \\\\\n\\sum_{i=1}^{5} x_{c,i}^3 = (-4)^3 + (-2)^3 + 0^3 + 2^3 + 4^3 = -64 - 8 + 0 + 8 + 64 = 0 \\\\\n\\sum_{i=1}^{5} x_{c,i}^4 = (-4)^4 + (-2)^4 + 0^4 + 2^4 + 4^4 = 256 + 16 + 0 + 16 + 256 = 544\n$$\n\n**步骤2：Gram–Schmidt正交化**\n我们使用内积 $\\langle f, g \\rangle = \\sum_{i=1}^{n} f(x_{c,i})g(x_{c,i})$ 对单项式基 $\\{v_0, v_1, v_2, v_3\\} = \\{1, x_c, x_c^2, x_c^3\\}$ 应用Gram–Schmidt过程。\n\n第一个正交多项式 $p_0$：\n$$\np_0(x_c) = v_0(x_c) = 1\n$$\n其范数的平方为 $\\langle p_0, p_0 \\rangle = \\sum_{i=1}^{5} 1^2 = 5$。\n\n第二个正交多项式 $p_1$：\n$$\np_1(x_c) = v_1(x_c) - \\frac{\\langle v_1, p_0 \\rangle}{\\langle p_0, p_0 \\rangle} p_0(x_c) = x_c - \\frac{\\sum x_c \\cdot 1}{\\sum 1^2} \\cdot 1 = x_c - \\frac{0}{5} \\cdot 1 = x_c\n$$\n其范数的平方为 $\\langle p_1, p_1 \\rangle = \\sum x_c^2 = 40$。\n\n第三个正交多项式 $p_2$：\n$$\np_2(x_c) = v_2(x_c) - \\frac{\\langle v_2, p_0 \\rangle}{\\langle p_0, p_0 \\rangle} p_0(x_c) - \\frac{\\langle v_2, p_1 \\rangle}{\\langle p_1, p_1 \\rangle} p_1(x_c)\n$$\n内积为：\n$\\langle v_2, p_0 \\rangle = \\langle x_c^2, 1 \\rangle = \\sum x_c^2 = 40$.\n$\\langle v_2, p_1 \\rangle = \\langle x_c^2, x_c \\rangle = \\sum x_c^3 = 0$.\n因此，\n$$\np_2(x_c) = x_c^2 - \\frac{40}{5} \\cdot 1 - \\frac{0}{40} \\cdot x_c = x_c^2 - 8\n$$\n其范数的平方为 $\\langle p_2, p_2 \\rangle = \\sum (x_c^2 - 8)^2 = \\sum (x_c^4 - 16x_c^2 + 64) = \\sum x_c^4 - 16\\sum x_c^2 + 64\\sum 1 = 544 - 16(40) + 64(5) = 544 - 640 + 320 = 224$。\n\n我们可以继续求 $p_3(x_c)$，但我们将证明这对于求 $\\alpha_2$ 是不必要的。\n\n**步骤3：系数 $\\alpha_k$ 和 $\\beta_k$ 之间的关系**\n拟合后的模型可以在任一基中表示。我们令两种形式相等：\n$$\n\\alpha_0 + \\alpha_1 x_c + \\alpha_2 x_c^2 + \\alpha_3 x_c^3 = \\hat{\\beta}_0 p_0(x_c) + \\hat{\\beta}_1 p_1(x_c) + \\hat{\\beta}_2 p_2(x_c) + \\hat{\\beta}_3 p_3(x_c)\n$$\n代入正交多项式的表达式：\n$$\n\\alpha_0 + \\alpha_1 x_c + \\alpha_2 x_c^2 + \\alpha_3 x_c^3 = \\hat{\\beta}_0 (1) + \\hat{\\beta}_1 (x_c) + \\hat{\\beta}_2 (x_c^2 - 8) + \\hat{\\beta}_3 p_3(x_c)\n$$\n注意到 $p_3(x_c)$ 的形式将是 $x_c^3 + c_{31}x_c + c_{30}$，因为 $\\langle x_c^3, x_c^2 \\rangle = \\sum x_c^5 = 0$。$x_c^2$ 项将会缺失。按 $x_c$ 的幂次合并项：\n$$\n\\alpha_0 + \\alpha_1 x_c + \\alpha_2 x_c^2 + \\alpha_3 x_c^3 = (\\hat{\\beta}_0 - 8 \\hat{\\beta}_2 + \\dots) + (\\hat{\\beta}_1 + \\dots)x_c + (\\hat{\\beta}_2)x_c^2 + (\\hat{\\beta}_3)x_c^3\n$$\n通过比较等式两边 $x_c$ 幂次的系数，我们得到二次项系数的关系：\n$$\n\\alpha_2 = \\hat{\\beta}_2\n$$\n因此，为了求得 $\\alpha_2$，我们只需要计算 $\\hat{\\beta}_2$。\n\n**步骤4：$\\hat{\\beta}_2$ 的最小二乘估计**\n在正交基中，系数的普通最小二乘估计由以下简单公式给出：\n$$\n\\hat{\\beta}_k = \\frac{\\langle y, p_k \\rangle}{\\langle p_k, p_k \\rangle} = \\frac{\\sum_{i=1}^n y_i p_k(x_{c,i})}{\\sum_{i=1}^n p_k(x_{c,i})^2}\n$$\n对于 $k=2$，我们有：\n$$\n\\hat{\\beta}_2 = \\frac{\\langle y, p_2 \\rangle}{\\langle p_2, p_2 \\rangle} = \\frac{\\sum_{i=1}^5 y_i (x_{c,i}^2 - 8)}{\\sum_{i=1}^5 (x_{c,i}^2 - 8)^2}\n$$\n分母已经计算过，为 $\\langle p_2, p_2 \\rangle = 224$。\n我们现在计算分子 $\\langle y, p_2 \\rangle$。$p_2(x_{c,i}) = x_{c,i}^2 - 8$ 在样本点处的值为：\n$\\{16-8, 4-8, 0-8, 4-8, 16-8\\} = \\{8, -4, -8, -4, 8\\}$。\nhsCRP 值为 $y = \\{3.7, 1.9, 1.3, 1.9, 3.7\\}$。\n$$\n\\langle y, p_2 \\rangle = \\sum_{i=1}^5 y_i p_2(x_{c,i}) = (3.7)(8) + (1.9)(-4) + (1.3)(-8) + (1.9)(-4) + (3.7)(8)\n$$\n$$\n\\langle y, p_2 \\rangle = 29.6 - 7.6 - 10.4 - 7.6 + 29.6 = 2 \\times (29.6 - 7.6) - 10.4 = 2 \\times (22.0) - 10.4 = 44.0 - 10.4 = 33.6\n$$\n现在我们可以计算 $\\hat{\\beta}_2$：\n$$\n\\hat{\\beta}_2 = \\frac{33.6}{224}\n$$\n为了简化分数：\n$$\n\\hat{\\beta}_2 = \\frac{336}{2240} = \\frac{168}{1120} = \\frac{84}{560} = \\frac{42}{280} = \\frac{21}{140} = \\frac{3}{20} = 0.15\n$$\n由于 $\\alpha_2 = \\hat{\\beta}_2$，原始二次项系数的值为 $\\alpha_2 = 0.15$。单位是 $y$ 的单位除以 $x_c$ 单位的平方，即 $\\text{mg/L}/\\text{年}^2$。\n\n**步骤5：最终答案格式化**\n题目要求将 $\\alpha_2$ 的数值四舍五入到四位有效数字。\n$$\n\\alpha_2 = 0.1500\n$$",
            "answer": "$$\n\\boxed{0.1500}\n$$"
        },
        {
            "introduction": "一个可靠的回归模型，其结论不应过度依赖于任何单个观测值。因此，诊断影响力点（influential points）是模型评估的关键一步。本练习将带您从第一性原理出发，推导并计算“留一法”（leave-one-out）诊断统计量，即删除单个观测点后模型系数的变化量，从而量化每个数据点对治疗效果估计值的影响力。",
            "id": "4977029",
            "problem": "一项临床试验评估一种新型抗高血压药物。结果变量是十二周后的收缩压降低值，以毫米汞柱 (mmHg) 为单位。令 $y_i$ 表示患者 $i$ 的收缩压降低值。拟合了一个带有截距项、治疗指示变量和中心化基线协变量的多元线性回归模型：\n$$\ny_i = \\beta_0 + \\beta_T T_i + \\beta_B b_i + \\varepsilon_i,\n$$\n其中，对于标准治疗，$T_i$ 编码为 $-1$，对于新药，$T_i$ 编码为 $+1$；$b_i$ 是基线收缩压与队列均值的偏差（单位：mmHg）。对于 $i = 1,\\dots,6$ 的数据集如下：\n- $i=1$：$T_1=-1$，$b_1=-2$，$y_1=4$\n- $i=2$：$T_2=-1$，$b_2=-1$，$y_2=2$\n- $i=3$：$T_3=-1$，$b_3=3$，$y_3=11$\n- $i=4$：$T_4=+1$，$b_4=-3$，$y_4=11$\n- $i=5$：$T_5=+1$，$b_5=+1$，$y_5=16$\n- $i=6$：$T_6=+1$，$b_6=+2$，$y_6=16$\n\n从普通最小二乘法正规方程和适当的矩阵恒等式出发，推导当删除观测值 $i$ 时，治疗系数估计值 $\\hat{\\beta}_T$ 变化量的留一法表达式，并为每个 $i$ 计算这个变化量。通过报告在 $i=1,\\dots,6$ 范围内 $\\hat{\\beta}_T$ 的最大留一法绝对变化量，来量化 $\\hat{\\beta}_T$ 对删除每个观测值的敏感性。\n\n将您的最终数值答案四舍五入至四位有效数字。以 mmHg/治疗指示变量单位来表示其大小。",
            "solution": "首先，我们推导在删除单个观测值时，普通最小二乘 (OLS) 系数估计值变化的一般表达式。多元线性回归模型以矩阵形式给出：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\n$$\n其中 $\\mathbf{y}$ 是 $n \\times 1$ 的结果向量，$\\mathbf{X}$ 是 $n \\times p$ 的设计矩阵，$\\boldsymbol{\\beta}$ 是 $p \\times 1$ 的系数向量，$\\boldsymbol{\\varepsilon}$ 是 $n \\times 1$ 的误差向量。使用所有 $n$ 个观测值时，$\\boldsymbol{\\beta}$ 的 OLS 估计量由正规方程给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}\n$$\n令 $\\hat{\\boldsymbol{\\beta}}_{(i)}$ 为删除第 $i$ 个观测值后得到的 OLS 估计量。令 $\\mathbf{x}_i^T$ 为 $\\mathbf{X}$ 的第 $i$ 行，$y_i$ 为 $\\mathbf{y}$ 的第 $i$ 个元素。留一法 (LOO) 回归的设计矩阵和响应向量分别是 $\\mathbf{X}_{(i)}$ 和 $\\mathbf{y}_{(i)}$。我们可以写出 $\\mathbf{X}^T\\mathbf{X} = \\mathbf{X}_{(i)}^T\\mathbf{X}_{(i)} + \\mathbf{x}_i\\mathbf{x}_i^T$ 和 $\\mathbf{X}^T\\mathbf{y} = \\mathbf{X}_{(i)}^T\\mathbf{y}_{(i)} + \\mathbf{x}_i y_i$。\n\n留一法估计量为 $\\hat{\\boldsymbol{\\beta}}_{(i)} = (\\mathbf{X}_{(i)}^T\\mathbf{X}_{(i)})^{-1}\\mathbf{X}_{(i)}^T\\mathbf{y}_{(i)}$。代入上述关系式：\n$$\n\\hat{\\boldsymbol{\\beta}}_{(i)} = (\\mathbf{X}^T\\mathbf{X} - \\mathbf{x}_i\\mathbf{x}_i^T)^{-1}(\\mathbf{X}^T\\mathbf{y} - \\mathbf{x}_i y_i)\n$$\n使用谢尔曼-莫里森-伍德伯里公式 $(A-\\mathbf{uv}^T)^{-1} = A^{-1} + \\frac{A^{-1}\\mathbf{uv}^T A^{-1}}{1-\\mathbf{v}^T A^{-1}\\mathbf{u}}$，并令 $A=\\mathbf{X}^T\\mathbf{X}$ 和 $\\mathbf{u}=\\mathbf{v}=\\mathbf{x}_i$，我们得到：\n$$\n(\\mathbf{X}^T\\mathbf{X} - \\mathbf{x}_i\\mathbf{x}_i^T)^{-1} = (\\mathbf{X}^T\\mathbf{X})^{-1} + \\frac{(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{x}_i\\mathbf{x}_i^T(\\mathbf{X}^T\\mathbf{X})^{-1}}{1 - \\mathbf{x}_i^T(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{x}_i}\n$$\n令 $h_{ii} = \\mathbf{x}_i^T(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{x}_i$ 为第 $i$ 个杠杆值（即帽子矩阵 $\\mathbf{H} = \\mathbf{X}(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T$ 的第 $i$ 个对角元素）。系数向量的变化量 $\\Delta\\hat{\\boldsymbol{\\beta}}^{(i)} = \\hat{\\boldsymbol{\\beta}}_{(i)} - \\hat{\\boldsymbol{\\beta}}$ 可以推导为：\n$$\n\\hat{\\boldsymbol{\\beta}}_{(i)} - \\hat{\\boldsymbol{\\beta}} = - \\frac{(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{x}_i(y_i - \\mathbf{x}_i^T\\hat{\\boldsymbol{\\beta}})}{1-h_{ii}} = - \\frac{(\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{x}_i e_i}{1-h_{ii}}\n$$\n其中 $e_i = y_i - \\hat{y}_i$ 是第 $i$ 个 OLS 残差。特定系数 $\\hat{\\beta}_T$ 的变化量，我们记为 $\\Delta\\hat{\\beta}_T^{(i)}$，是该向量中对应于 $\\beta_T$ 的分量。\n\n现在，我们将此应用于给定数据。模型为 $y_i = \\beta_0 + \\beta_T T_i + \\beta_B b_i + \\varepsilon_i$。系数向量为 $\\boldsymbol{\\beta} = (\\beta_0, \\beta_T, \\beta_B)^T$。样本量为 $n=6$。设计矩阵 $\\mathbf{X}$ 和响应向量 $\\mathbf{y}$ 为：\n$$\n\\mathbf{X} = \\begin{pmatrix} 1  & -1  & -2 \\\\ 1  & -1  & -1 \\\\ 1  & -1  & 3 \\\\ 1  & 1  & -3 \\\\ 1  & 1  & 1 \\\\ 1  & 1  & 2 \\end{pmatrix}, \\quad \\mathbf{y} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 11 \\\\ 11 \\\\ 16 \\\\ 16 \\end{pmatrix}\n$$\n我们计算 $\\mathbf{X}^T\\mathbf{X}$。列向量为 $\\mathbf{c}_0 = \\mathbf{1}$，$\\mathbf{c}_T = \\mathbf{T}$ 和 $\\mathbf{c}_B = \\mathbf{b}$。我们检查其正交性：\n$\\sum T_i = -1-1-1+1+1+1 = 0$。\n$\\sum b_i = -2-1+3-3+1+2 = 0$。\n$\\sum T_i b_i = (-1)(-2)+(-1)(-1)+(-1)(3)+(1)(-3)+(1)(1)+(1)(2) = 2+1-3-3+1+2 = 0$。\n这些列相互正交。这极大地简化了问题，因为 $\\mathbf{X}^T\\mathbf{X}$ 是一个对角矩阵。\n$$\n\\mathbf{X}^T\\mathbf{X} = \\begin{pmatrix} \\sum 1  & \\sum T_i  & \\sum b_i \\\\ \\sum T_i  & \\sum T_i^2  & \\sum T_i b_i \\\\ \\sum b_i  & \\sum T_i b_i  & \\sum b_i^2 \\end{pmatrix} = \\begin{pmatrix} 6  & 0  & 0 \\\\ 0  & 6  & 0 \\\\ 0  & 0  & 28 \\end{pmatrix}\n$$\n其逆矩阵为 $C = (\\mathbf{X}^T\\mathbf{X})^{-1} = \\begin{pmatrix} 1/6  & 0  & 0 \\\\ 0  & 1/6  & 0 \\\\ 0  & 0  & 1/28 \\end{pmatrix}$。\n接下来，我们计算 $\\mathbf{X}^T\\mathbf{y}$：\n$\\sum y_i = 4+2+11+11+16+16=60$。\n$\\sum T_i y_i = -4-2-11+11+16+16=26$。\n$\\sum b_i y_i = -8-2+33-33+16+32=38$。\n所以，$\\mathbf{X}^T\\mathbf{y} = (60, 26, 38)^T$。\nOLS 估计值为：\n$$\n\\hat{\\boldsymbol{\\beta}} = C \\mathbf{X}^T\\mathbf{y} = \\begin{pmatrix} 1/6  & 0  & 0 \\\\ 0  & 1/6  & 0 \\\\ 0  & 0  & 1/28 \\end{pmatrix} \\begin{pmatrix} 60 \\\\ 26 \\\\ 38 \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ 26/6 \\\\ 38/28 \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ 13/3 \\\\ 19/14 \\end{pmatrix}\n$$\n因此，$\\hat{\\beta}_0=10$，$\\hat{\\beta}_T=13/3$，且 $\\hat{\\beta}_B=19/14$。拟合的模型为 $\\hat{y}_i = 10 + \\frac{13}{3}T_i + \\frac{19}{14}b_i$。\n\n我们需要计算每个观测值的杠杆值 $h_{ii}$ 和残差 $e_i$。\n$h_{ii} = \\mathbf{x}_i^T C \\mathbf{x}_i = (1, T_i, b_i) \\begin{pmatrix} 1/6  & 0  & 0 \\\\ 0  & 1/6  & 0 \\\\ 0  & 0  & 1/28 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ T_i \\\\ b_i \\end{pmatrix} = \\frac{1}{6} + \\frac{T_i^2}{6} + \\frac{b_i^2}{28}$。由于对所有 $i$ 都有 $T_i^2=1$，所以 $h_{ii} = \\frac{1}{3} + \\frac{b_i^2}{28}$。\n\n$\\hat{\\beta}_T$ 的变化量是向量 $\\hat{\\boldsymbol{\\beta}}_{(i)} - \\hat{\\boldsymbol{\\beta}}$ 的第二个分量。令 $C_{T,T}$ 为 $C$ 的第二个对角元素。\n$\\Delta\\hat{\\beta}_T^{(i)} = \\hat{\\beta}_{T,(i)} - \\hat{\\beta}_T = - \\frac{(C\\mathbf{x}_i)_T e_i}{1-h_{ii}} = - \\frac{C_{T,T} T_i e_i}{1-h_{ii}} = - \\frac{(1/6) T_i e_i}{1-h_{ii}}$。\n\n我们为每个 $i$ 计算这些量：\n$i=1$：$T_1=-1, b_1=-2, y_1=4$。\n$h_{11} = 1/3 + (-2)^2/28 = 1/3+4/28 = 1/3+1/7 = 10/21$。\n$\\hat{y}_1 = 10 + \\frac{13}{3}(-1) + \\frac{19}{14}(-2) = 10 - 13/3 - 19/7 = (210-91-57)/21 = 62/21$。\n$e_1 = 4 - 62/21 = (84-62)/21 = 22/21$。\n$\\Delta\\hat{\\beta}_T^{(1)} = -\\frac{(1/6)(-1)(22/21)}{1-10/21} = \\frac{22/126}{11/21} = \\frac{22}{126}\\frac{21}{11} = \\frac{2}{6} = 1/3$。\n\n$i=2$：$T_2=-1, b_2=-1, y_2=2$。\n$h_{22} = 1/3 + (-1)^2/28 = 1/3+1/28 = (28+3)/84 = 31/84$。\n$\\hat{y}_2 = 10 + \\frac{13}{3}(-1) + \\frac{19}{14}(-1) = (420-182-57)/42 = 181/42$。\n$e_2 = 2 - 181/42 = (84-181)/42 = -97/42$。\n$\\Delta\\hat{\\beta}_T^{(2)} = -\\frac{(1/6)(-1)(-97/42)}{1-31/84} = -\\frac{97/252}{53/84} = -\\frac{97}{252}\\frac{84}{53} = -97/(3 \\times 53) = -97/159$。\n\n$i=3$：$T_3=-1, b_3=3, y_3=11$。\n$h_{33} = 1/3 + 3^2/28 = 1/3+9/28 = (28+27)/84 = 55/84$。\n$\\hat{y}_3 = 10 + \\frac{13}{3}(-1) + \\frac{19}{14}(3) = (420-182+171)/42 = 409/42$。\n$e_3 = 11 - 409/42 = (462-409)/42 = 53/42$。\n$\\Delta\\hat{\\beta}_T^{(3)} = -\\frac{(1/6)(-1)(53/42)}{1-55/84} = \\frac{53/252}{29/84} = \\frac{53}{252}\\frac{84}{29} = 53/(3 \\times 29) = 53/87$。\n\n$i=4$：$T_4=1, b_4=-3, y_4=11$。\n$h_{44} = 1/3 + (-3)^2/28 = 55/84$。\n$\\hat{y}_4 = 10 + \\frac{13}{3}(1) + \\frac{19}{14}(-3) = (420+182-171)/42 = 431/42$。\n$e_4 = 11 - 431/42 = (462-431)/42 = 31/42$。\n$\\Delta\\hat{\\beta}_T^{(4)} = -\\frac{(1/6)(1)(31/42)}{1-55/84} = -\\frac{31/252}{29/84} = -\\frac{31}{252}\\frac{84}{29} = -31/87$。\n\n$i=5$：$T_5=1, b_5=1, y_5=16$。\n$h_{55} = 1/3 + 1^2/28 = 31/84$。\n$\\hat{y}_5 = 10 + \\frac{13}{3}(1) + \\frac{19}{14}(1) = (420+182+57)/42 = 659/42$。\n$e_5 = 16 - 659/42 = (672-659)/42 = 13/42$。\n$\\Delta\\hat{\\beta}_T^{(5)} = -\\frac{(1/6)(1)(13/42)}{1-31/84} = -\\frac{13/252}{53/84} = -\\frac{13}{252}\\frac{84}{53} = -13/159$。\n\n$i=6$：$T_6=1, b_6=2, y_6=16$。\n$h_{66} = 1/3 + 2^2/28 = 10/21$。\n$\\hat{y}_6 = 10 + \\frac{13}{3}(1) + \\frac{19}{14}(2) = (210+91+57)/21 = 358/21$。\n$e_6 = 16 - 358/21 = (336-358)/21 = -22/21$。\n$\\Delta\\hat{\\beta}_T^{(6)} = -\\frac{(1/6)(1)(-22/21)}{1-10/21} = \\frac{22/126}{11/21} = \\frac{22}{126}\\frac{21}{11} = 1/3$。\n\n计算出的变化量为：\n$\\Delta\\hat{\\beta}_T^{(1)} = 1/3 \\approx 0.3333$\n$\\Delta\\hat{\\beta}_T^{(2)} = -97/159 \\approx -0.6101$\n$\\Delta\\hat{\\beta}_T^{(3)} = 53/87 \\approx 0.6092$\n$\\Delta\\hat{\\beta}_T^{(4)} = -31/87 \\approx -0.3563$\n$\\Delta\\hat{\\beta}_T^{(5)} = -13/159 \\approx -0.0818$\n$\\Delta\\hat{\\beta}_T^{(6)} = 1/3 \\approx 0.3333$\n\n我们现在找出最大的绝对变化量 $\\max_i |\\Delta\\hat{\\beta}_T^{(i)}|$。\n$|\\Delta\\hat{\\beta}_T^{(1)}|=1/3 \\approx 0.3333$\n$|\\Delta\\hat{\\beta}_T^{(2)}|=97/159 \\approx 0.61006$\n$|\\Delta\\hat{\\beta}_T^{(3)}|=53/87 \\approx 0.60919$\n$|\\Delta\\hat{\\beta}_T^{(4)}|=31/87 \\approx 0.35632$\n$|\\Delta\\hat{\\beta}_T^{(5)}|=13/159 \\approx 0.08176$\n$|\\Delta\\hat{\\beta}_T^{(6)}|=1/3 \\approx 0.3333$\n\n通过比较这些值，最大值显然是 $|-97/159| = 97/159$。\n数值为 $97 \\div 159 \\approx 0.61006289...$。\n四舍五入到四位有效数字，我们得到 $0.6101$。",
            "answer": "$$\n\\boxed{0.6101}\n$$"
        }
    ]
}