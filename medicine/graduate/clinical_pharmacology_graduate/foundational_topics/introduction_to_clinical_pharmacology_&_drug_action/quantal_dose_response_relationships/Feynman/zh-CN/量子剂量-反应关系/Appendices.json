{
    "hands_on_practices": [
        {
            "introduction": "在量效关系分析中，最基本的任务是从实验数据中估计出中位有效剂量（$ED_{50}$）等关键参数。这项练习将引导您从第一性原理出发，使用最大似然估计（MLE）方法拟合一个logistic回归模型。通过处理一个精心设计的假设数据集，您将深入理解观测数据、统计模型以及由此衍生的药理学参数之间的内在联系。",
            "id": "4586965",
            "problem": "一种新型镇痛药在平行组剂量范围探索实验中表现出量效治疗反应。在三个剂量水平 $d_{1} = 15$ mg、$d_{2} = 30$ mg 和 $d_{3} = 60$ mg下，每个剂量组随机分配了 $n_{i} = 50$ 名受试者。有治疗反应（是/否）的受试者人数分别为 $y_{1} = 10$、$y_{2} = 25$ 和 $y_{3} = 40$。假设在剂量 $d$ 下的反应概率遵循一个逻辑斯谛模型，其中剂量的自然对数作为预测变量：$p(d) = \\frac{1}{1 + \\exp\\!\\big(-\\alpha - \\beta \\ln d\\big)}$，其中 $\\alpha$ 和 $\\beta$ 是待通过最大似然估计（MLE）估计的未知参数。\n\n从量性结果的二项似然和标准logit链接函数出发，建立最大似然估计问题并推导得分方程。使用所提供的数据，计算参数估计值 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$，过程中不使用任何快捷公式。然后，使用半数有效剂量（ED$_{50}$）的定义（即满足 $p(d) = 0.5$ 的剂量 $d$），推导出 ED$_{50}$ 关于 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 的表达式，并计算其在该数据集下的数值。\n\n以 mg 为单位表示最终的 ED$_{50}$。如果答案是精确值，请勿四舍五入。",
            "solution": "### 步骤1：提取已知信息\n- 剂量水平：$d_{1} = 15$ mg，$d_{2} = 30$ mg，$d_{3} = 60$ mg。\n- 每个剂量水平的受试者人数：$n_{1} = n_{2} = n_{3} = 50$。\n- 有治疗反应的受试者人数：$y_{1} = 10$，$y_{2} = 25$，$y_{3} = 40$。\n- 反应概率模型 $p(d)$：$p(d) = \\frac{1}{1 + \\exp(-\\alpha - \\beta \\ln d)}$。\n- 半数有效剂量 ED$_{50}$ 的定义：使 $p(d) = 0.5$ 的剂量 $d$。\n\n### 步骤2：使用提取的已知信息进行验证\n问题陈述具有科学依据，提法恰当且客观。它提供了一个使用逻辑斯谛回归建模的标准量性剂量反应情景，这是生物统计学和药理学的基石。数据完整、一致，并且足以估计两个模型参数 $\\alpha$ 和 $\\beta$。目标是找到这些参数的最大似然估计（MLE）以及一个派生量，即 ED$_{50}$。该问题是一个正式的、可解的统计估计练习。没有违反科学原则，没有歧义，也没有缺失信息。\n\n### 步骤3：结论与行动\n该问题有效。将提供一个完整、合理的解答。\n\n### 解题推导\n\n每个剂量水平 $d_i$ 的反应是一个二项结果。$n_i$ 名受试者中的反应数 $y_i$ 服从二项分布 $Y_i \\sim \\text{Binomial}(n_i, p_i)$，其中 $p_i = p(d_i)$ 是该剂量的反应概率。单个剂量组的概率质量函数为：\n$$ L_i(\\alpha, \\beta | y_i, n_i, d_i) = \\binom{n_i}{y_i} p_i^{y_i} (1 - p_i)^{n_i - y_i} $$\n其中 $p_i = \\frac{1}{1 + \\exp(-\\alpha - \\beta \\ln d_i)}$。\n\n假设三个独立剂量组的结果是相互独立的，总似然函数 $L(\\alpha, \\beta)$ 是各独立似然的乘积：\n$$ L(\\alpha, \\beta) = \\prod_{i=1}^{3} L_i = \\prod_{i=1}^{3} \\binom{n_i}{y_i} p_i^{y_i} (1 - p_i)^{n_i - y_i} $$\n\n对于最大似然估计，处理对数似然函数 $\\ell(\\alpha, \\beta) = \\ln L(\\alpha, \\beta)$ 更为方便：\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ \\ln\\binom{n_i}{y_i} + y_i \\ln(p_i) + (n_i - y_i) \\ln(1 - p_i) \\right] $$\n为了找到最大化此函数的参数 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$，我们可以忽略常数项 $\\sum \\ln\\binom{n_i}{y_i}$。设 $\\eta_i = \\alpha + \\beta \\ln d_i$。逻辑斯谛函数可写为 $p_i = \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}$，且 $1 - p_i = \\frac{1}{1 + \\exp(\\eta_i)}$。\n将这些代入对数似然函数（忽略常数项）得到：\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i \\ln\\left(\\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)}\\right) + (n_i - y_i) \\ln\\left(\\frac{1}{1 + \\exp(\\eta_i)}\\right) \\right] $$\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i (\\eta_i - \\ln(1 + \\exp(\\eta_i))) - (n_i - y_i) \\ln(1 + \\exp(\\eta_i)) \\right] $$\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i \\eta_i - n_i \\ln(1 + \\exp(\\eta_i)) \\right] $$\n$$ \\ell(\\alpha, \\beta) = \\sum_{i=1}^{3} \\left[ y_i (\\alpha + \\beta \\ln d_i) - n_i \\ln(1 + \\exp(\\alpha + \\beta \\ln d_i)) \\right] $$\n\n通过将对数似然函数关于 $\\alpha$ 和 $\\beta$ 的偏导数设为零，可以得到得分方程。\n第二项关于 $\\alpha$ 的导数是：\n$$ \\frac{\\partial}{\\partial \\alpha} \\left[ n_i \\ln(1 + \\exp(\\eta_i)) \\right] = n_i \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)} \\cdot \\frac{\\partial \\eta_i}{\\partial \\alpha} = n_i p_i \\cdot 1 = n_i p_i $$\n关于 $\\beta$ 的导数是：\n$$ \\frac{\\partial}{\\partial \\beta} \\left[ n_i \\ln(1 + \\exp(\\eta_i)) \\right] = n_i \\frac{\\exp(\\eta_i)}{1 + \\exp(\\eta_i)} \\cdot \\frac{\\partial \\eta_i}{\\partial \\beta} = n_i p_i \\cdot \\ln d_i $$\n\n得分方程 $U_{\\alpha} = \\frac{\\partial \\ell}{\\partial \\alpha} = 0$ 和 $U_{\\beta} = \\frac{\\partial \\ell}{\\partial \\beta} = 0$ 为：\n$$ U_{\\alpha} = \\sum_{i=1}^{3} \\left( y_i - n_i p_i \\right) = 0 $$\n$$ U_{\\beta} = \\sum_{i=1}^{3} \\left( y_i \\ln d_i - n_i p_i \\ln d_i \\right) = \\sum_{i=1}^{3} (y_i - n_i p_i) \\ln d_i = 0 $$\n这些方程是关于 $\\alpha$ 和 $\\beta$ 的非线性方程，通常需要数值求解。然而，所提供的数据表现出一种特殊结构。观察到的反应比例如下：\n$p_{\\text{obs},1} = y_1/n_1 = 10/50 = 0.2$\n$p_{\\text{obs},2} = y_2/n_2 = 25/50 = 0.5$\n$p_{\\text{obs},3} = y_3/n_3 = 40/50 = 0.8$\n\n模型为 $\\text{logit}(p(d)) = \\ln\\left(\\frac{p(d)}{1-p(d)}\\right) = \\alpha + \\beta \\ln d$。\n让我们看看是否存在参数 $\\alpha$ 和 $\\beta$，使得拟合概率 $\\hat{p}_i$ 与观察比例 $p_{\\text{obs},i}$ 完全匹配。这要求观察比例的logit值是剂量对数的线性函数。\n$$ \\text{logit}(p_{\\text{obs},1}) = \\ln\\left(\\frac{0.2}{1-0.2}\\right) = \\ln(0.25) = -\\ln(4) $$\n$$ \\text{logit}(p_{\\text{obs},2}) = \\ln\\left(\\frac{0.5}{1-0.5}\\right) = \\ln(1) = 0 $$\n$$ \\text{logit}(p_{\\text{obs},3}) = \\ln\\left(\\frac{0.8}{1-0.8}\\right) = \\ln(4) $$\n我们得到了一个关于 $\\alpha$ 和 $\\beta$ 的线性方程组：\n1. $\\alpha + \\beta \\ln(15) = -\\ln(4)$\n2. $\\alpha + \\beta \\ln(30) = 0$\n3. $\\alpha + \\beta \\ln(60) = \\ln(4)$\n\n从方程(2)中，我们找到了 $\\alpha$ 和 $\\beta$ 之间的一个关系：\n$$ \\alpha = -\\beta \\ln(30) $$\n将此代入方程(1)：\n$$ -\\beta \\ln(30) + \\beta \\ln(15) = -\\ln(4) $$\n$$ \\beta (\\ln(15) - \\ln(30)) = -\\ln(4) $$\n$$ \\beta \\ln\\left(\\frac{15}{30}\\right) = -\\ln(4) $$\n$$ \\beta \\ln(0.5) = -\\ln(4) $$\n$$ -\\beta \\ln(2) = -2\\ln(2) $$\n$$ \\hat{\\beta} = 2 $$\n现在我们求解 $\\alpha$ 的估计值：\n$$ \\hat{\\alpha} = -2 \\ln(30) $$\n我们必须验证这些估计值是否满足方程(3)：\n$$ \\hat{\\alpha} + \\hat{\\beta} \\ln(60) = -2\\ln(30) + 2\\ln(60) = 2(\\ln(60) - \\ln(30)) = 2\\ln\\left(\\frac{60}{30}\\right) = 2\\ln(2) = \\ln(4) $$\n方程成立。数据点在logit-对数剂量空间中完全位于一条直线上。在这种特殊情况下，最大似然估计就是这条直线的参数。最大似然估计值为 $\\hat{\\alpha} = -2\\ln(30)$ 和 $\\hat{\\beta} = 2$。\n\n接下来，我们推导 ED$_{50}$ 的表达式。根据定义，这是反应概率为 $0.5$ 时的剂量 $d$：\n$$ p(\\text{ED}_{50}) = \\frac{1}{1 + \\exp(-\\alpha - \\beta \\ln(\\text{ED}_{50}))} = 0.5 $$\n$$ 1 + \\exp(-\\alpha - \\beta \\ln(\\text{ED}_{50})) = 2 $$\n$$ \\exp(-\\alpha - \\beta \\ln(\\text{ED}_{50})) = 1 $$\n对两边取自然对数：\n$$ -\\alpha - \\beta \\ln(\\text{ED}_{50}) = 0 $$\n$$ \\beta \\ln(\\text{ED}_{50}) = -\\alpha $$\n$$ \\ln(\\text{ED}_{50}) = -\\frac{\\alpha}{\\beta} $$\n$$ \\text{ED}_{50} = \\exp\\left(-\\frac{\\alpha}{\\beta}\\right) $$\n\n最后，我们使用估计的参数 $\\hat{\\alpha}$ 和 $\\hat{\\beta}$ 计算 ED$_{50}$ 的数值：\n$$ \\widehat{\\text{ED}}_{50} = \\exp\\left(-\\frac{\\hat{\\alpha}}{\\hat{\\beta}}\\right) = \\exp\\left(-\\frac{-2\\ln(30)}{2}\\right) $$\n$$ \\widehat{\\text{ED}}_{50} = \\exp\\left(\\ln(30)\\right) $$\n$$ \\widehat{\\text{ED}}_{50} = 30 $$\n估计的半数有效剂量为 $30$ mg。这个结果与输入数据一致，在输入数据中，$30$ mg 的剂量恰好在 $50$ 名受试者中产生了 $25$ 例反应，即 $50\\%$ 的反应率。",
            "answer": "$$\\boxed{30}$$"
        },
        {
            "introduction": "一旦建立了剂量-反应模型，精确解读其参数以表征药物特性就变得至关重要，这不仅仅局限于计算$ED_{50}$。剂量-反应曲线的陡峭程度是一个关键特征，它反映了药物效应随剂量变化的敏感性。本练习将演示如何从一个已拟合的probit模型中计算四分位距（IQR），为曲线的陡峭度提供一个量化指标，从而增强您从模型参数中提取全面信息的能力。",
            "id": "4586928",
            "problem": "一种新的抗惊厥药在平行分组、单剂量研究中进行评估，其二元终点定义为在固定观察窗内完全抑制癫痫发作。设剂量 $D$（单位为 $\\mathrm{mg}\\cdot\\mathrm{kg}^{-1}$）下的响应概率为 $p(D)$。对这些数据的剂量自然对数拟合一个带有概率单位链接的标准量效反应模型，得到以下关系\n$\\Phi^{-1}\\!\\big(p(D)\\big)=\\alpha+\\beta\\ln(D)$，\n其中 $\\Phi^{-1}$ 表示标准正态分布的分位数函数，拟合参数为 $\\alpha=-1.2$ 和 $\\beta=0.8$。50%群体的有效剂量（ED；中位有效剂量，$ED_{50}$）定义为使得 $p(D)=0.5$ 的唯一剂量 $D$。功效的剂量四分位距（IQR）定义为分别使 $p(D)=0.75$ 和 $p(D)=0.25$ 的剂量之差。\n\n仅从模型以及概率单位链接、$ED_{50}$ 和 IQR 的定义出发，推导达到任意响应概率 $p\\in(0,1)$ 的剂量的封闭形式表达式，然后具体化该表达式以确定 $ED_{50}$ 和剂量的 IQR。最后，将剂量的 IQR 与 $ED_{50}$ 的比值报告为一个实数。为进行数值计算，您可以使用 $\\Phi^{-1}(0.25)=-0.67448975$ 和 $\\Phi^{-1}(0.75)=+0.67448975$。将最终比值四舍五入至四位有效数字，并以纯小数形式报告（无单位），因为它是无量纲的。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   剂量-反应模型由以下方程给出：$\\Phi^{-1}(p(D)) = \\alpha + \\beta \\ln(D)$，其中 $\\Phi^{-1}$ 是标准正态分布的分位数函数（逆累积分布函数），$p(D)$ 是剂量 $D$ 下的响应概率，$\\ln(D)$ 是剂量的自然对数。\n-   拟合参数为 $\\alpha = -1.2$ 和 $\\beta = 0.8$。\n-   中位有效剂量 $ED_{50}$ 定义为使得 $p(D) = 0.5$ 的剂量 $D$。\n-   剂量的四分位距（IQR）定义为对应于响应概率为 $0.75$ 和 $0.25$ 的剂量之差，即 $D_{0.75} - D_{0.25}$。\n-   提供了标准正态分位数的数值：$\\Phi^{-1}(0.25) = -0.67448975$ 和 $\\Phi^{-1}(0.75) = 0.67448975$。\n-   目标是计算无量纲比值 $\\frac{\\text{IQR}}{ED_{50}}$ 并将其四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题在对数剂量尺度上使用概率单位模型，这是分析药理学和毒理学中量性剂量-反应数据的标准、有科学依据的方法。$ED_{50}$ 和 IQR 的概念是该领域的基本指标。该问题在科学上是合理的。\n-   **适定性：** 该问题是适定的。它提供了一个具体的模型、所有必要的参数值和清晰的定义，从而可以为所要求的比值找到一个唯一且有意义的解。\n-   **客观性：** 该问题以精确、客观和正式的科学语言陈述。\n\n### 步骤 3：结论与行动\n该问题被认为是 **有效的**，因为它是自洽的、有科学依据且适定的。将推导一个完整的解。\n\n### 解题推导\n\n问题的核心是量性剂量-反应关系：\n$$ \\Phi^{-1}(p) = \\alpha + \\beta \\ln(D) $$\n其中 $p$ 是响应概率 $p(D)$。\n\n首先，我们推导达到任意响应概率 $p \\in (0, 1)$ 的剂量 $D$ 的通用封闭形式表达式。我们重排模型方程以解出 $D$：\n$$ \\beta \\ln(D) = \\Phi^{-1}(p) - \\alpha $$\n$$ \\ln(D) = \\frac{\\Phi^{-1}(p) - \\alpha}{\\beta} $$\n对两边取指数，得到剂量 $D$ 作为概率 $p$ 的函数：\n$$ D(p) = \\exp\\left(\\frac{\\Phi^{-1}(p) - \\alpha}{\\beta}\\right) $$\n这是在比例为 $p$ 的群体中产生响应所需剂量的通用表达式。\n\n接下来，我们具体化此表达式以求得 $ED_{50}$。根据定义，$ED_{50}$ 是当 $p = 0.5$ 时的剂量 $D$。对于标准正态分布，中位数（第50百分位数）在 $z=0$ 处。因此，当 $p=0.5$ 时分位数函数的值为 $\\Phi^{-1}(0.5) = 0$。将此代入我们的通用剂量表达式可得：\n$$ ED_{50} = D(0.5) = \\exp\\left(\\frac{\\Phi^{-1}(0.5) - \\alpha}{\\beta}\\right) = \\exp\\left(\\frac{0 - \\alpha}{\\beta}\\right) = \\exp\\left(-\\frac{\\alpha}{\\beta}\\right) $$\n\n现在，我们确定四分位距（IQR）。IQR 是当 $p=0.75$ 时的剂量（$D_{0.75}$）与当 $p=0.25$ 时的剂量（$D_{0.25}$）之差。使用我们的通用剂量公式：\n$$ D_{0.75} = D(0.75) = \\exp\\left(\\frac{\\Phi^{-1}(0.75) - \\alpha}{\\beta}\\right) $$\n$$ D_{0.25} = D(0.25) = \\exp\\left(\\frac{\\Phi^{-1}(0.25) - \\alpha}{\\beta}\\right) $$\n因此 IQR 为：\n$$ \\text{IQR} = D_{0.75} - D_{0.25} = \\exp\\left(\\frac{\\Phi^{-1}(0.75) - \\alpha}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25) - \\alpha}{\\beta}\\right) $$\n\n最后一步是求 IQR 与 $ED_{50}$ 的比值：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\frac{\\exp\\left(\\frac{\\Phi^{-1}(0.75) - \\alpha}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25) - \\alpha}{\\beta}\\right)}{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)} $$\n我们可以利用指数性质 $\\exp(a-b) = \\exp(a)\\exp(-b)$ 来简化分子：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\frac{\\exp\\left(\\frac{\\Phi^{-1}(0.75)}{\\beta}\\right)\\exp\\left(-\\frac{\\alpha}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25)}{\\beta}\\right)\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)}{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)} $$\n在分子中提出公因式 $\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)$：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\frac{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right) \\left[ \\exp\\left(\\frac{\\Phi^{-1}(0.75)}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25)}{\\beta}\\right) \\right]}{\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)} $$\n$\\exp\\left(-\\frac{\\alpha}{\\beta}\\right)$ 项被约去，表明该比值与参数 $\\alpha$ 无关：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp\\left(\\frac{\\Phi^{-1}(0.75)}{\\beta}\\right) - \\exp\\left(\\frac{\\Phi^{-1}(0.25)}{\\beta}\\right) $$\n由于标准正态分布的对称性，$\\Phi^{-1}(0.25) = -\\Phi^{-1}(0.75)$。令 $z_q = \\Phi^{-1}(0.75)$。表达式变为：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp\\left(\\frac{z_q}{\\beta}\\right) - \\exp\\left(-\\frac{z_q}{\\beta}\\right) = 2\\sinh\\left(\\frac{z_q}{\\beta}\\right) $$\n这个简洁的形式突显了其对斜率参数 $\\beta$ 和分布离散程度（由 $z_q$ 量化）的依赖性。\n\n现在，我们代入给定的数值：$\\beta = 0.8$，$\\Phi^{-1}(0.75) = 0.67448975$ 以及 $\\Phi^{-1}(0.25) = -0.67448975$。\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp\\left(\\frac{0.67448975}{0.8}\\right) - \\exp\\left(\\frac{-0.67448975}{0.8}\\right) $$\n首先，计算指数的参数：\n$$ \\frac{0.67448975}{0.8} = 0.8431121875 $$\n该比值为：\n$$ \\frac{\\text{IQR}}{ED_{50}} = \\exp(0.8431121875) - \\exp(-0.8431121875) $$\n$$ \\frac{\\text{IQR}}{ED_{50}} \\approx 2.32353033 - 0.43037922 \\approx 1.89315111 $$\n问题要求将最终结果四舍五入至四位有效数字。前四位有效数字是 $1$、$8$、$9$ 和 $3$。第五位有效数字是 $1$，所以我们向下舍入。\n$$ \\frac{\\text{IQR}}{ED_{50}} \\approx 1.893 $$\n这个无量纲比值量化了剂量-反应曲线的相对离散程度，值越大表示曲线越平缓（即，相对于中位有效剂量，从 $25\\%$ 响应到 $75\\%$ 响应需要更宽的剂量范围）。",
            "answer": "$$\n\\boxed{1.893}\n$$"
        }
    ]
}