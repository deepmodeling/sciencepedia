{
    "hands_on_practices": [
        {
            "introduction": "在评估镇静催眠药的临床应用之前，我们必须首先掌握其在体内的基本动力学特征。本练习将引导你计算两个核心的药代动力学参数：消除半衰期（$t_{1/2}$）和稳态蓄积比（$R_{ss}$）。通过将药物的内在特性——清除率（$CL$）和分布容积（$V_d$）——与这些临床上至关重要的指标联系起来，你将为设计合理的给药方案和预测药物在患者体内的行为打下坚实的基础。",
            "id": "4540023",
            "problem": "一名患有严重广泛性焦虑的住院患者开始服用一种口服苯二氮䓬类药物。在该个体中，该药物的药代动力学行为可由一个单室模型充分描述，其特点是两次给药之间为线性一级消除，且每次给药后药物瞬时分布。在该患者中，测得该药物的全身清除率$CL = 15\\ \\mathrm{L/h}$，表观分布容积$V_d = 120\\ \\mathrm{L}$。维持治疗方案以$\\tau = 12\\ \\mathrm{h}$的固定给药间隔给药。仅使用应用于镇静剂、催眠药和抗焦虑药的药代动力学基本定义，计算该给药间隔$\\tau$下的终末消除半衰期$t_{1/2}$和稳态蓄积比。将这两个量均四舍五入至四位有效数字。$t_{1/2}$以小时为单位表示，蓄积比表示为无单位的小数。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 药物的药代动力学行为由单室模型描述。\n- 消除是线性一级过程。\n- 每次给药后分布是瞬时的。\n- 全身清除率：$CL = 15\\ \\mathrm{L/h}$。\n- 表观分布容积：$V_d = 120\\ \\mathrm{L}$。\n- 给药间隔：$\\tau = 12\\ \\mathrm{h}$。\n- 要求输出：终末消除半衰期 ($t_{1/2}$) 和稳态蓄积比 ($R_{ss}$)。\n- 结果必须四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于带有一级消除的单室模型，这是经典药代动力学的基石。所提供的清除率和分布容积值对于人体内某些苯二氮䓬类药物在生理学上是合理的。问题背景适用于临床药理学。\n- **适定性：** 该问题提供了所有必要的参数（$CL$、$V_d$、$\\tau$），可以使用标准、明确的药代动力学方程唯一确定所求量（$t_{1/2}$、$R_{ss}$）。\n- **客观性：** 问题陈述使用了精确的、定量的语言，没有歧义或主观陈述。\n\n### 步骤3：结论与行动\n该问题在科学上合理、适定且客观。它不包含矛盾、缺失信息或其他使其无效的缺陷。因此，该问题被视为**有效的**，并将提供解答。\n\n求解过程首先确定一级消除速率常数 $k_e$，这是一个由给定的清除率和分布容积导出的基本参数。然后，该常数被用来计算消除半衰期和蓄积比。\n\n在单室模型中，全身清除率（$CL$）、表观分布容积（$V_d$）和一级消除速率常数（$k_e$）之间的关系由清除率的定义给出：\n$$CL = k_e \\cdot V_{d}$$\n我们可以重新排列这个方程来求解 $k_e$：\n$$k_e = \\frac{CL}{V_{d}}$$\n代入给定值：\n$$k_e = \\frac{15\\ \\mathrm{L/h}}{120\\ \\mathrm{L}} = 0.125\\ \\mathrm{h^{-1}}$$\n\n首先，我们计算终末消除半衰期，$t_{1/2}$。对于一级过程，半衰期定义为浓度降低一半所需的时间。它通过以下方程与消除速率常数相关联：\n$$t_{1/2} = \\frac{\\ln(2)}{k_e}$$\n代入计算出的 $k_e$ 值：\n$$t_{1/2} = \\frac{\\ln(2)}{0.125\\ \\mathrm{h^{-1}}}$$\n使用值 $\\ln(2) \\approx 0.69314718...$：\n$$t_{1/2} \\approx \\frac{0.69314718}{0.125}\\ \\mathrm{h} \\approx 5.54517744\\ \\mathrm{h}$$\n按要求四舍五入至四位有效数字，我们得到：\n$$t_{1/2} = 5.545\\ \\mathrm{h}$$\n\n接下来，我们计算稳态蓄积比，$R_{ss}$。该比率量化了重复给药时药物在体内的蓄积程度。对于以恒定间隔 $\\tau$ 给药的药物，其定义为：\n$$R_{ss} = \\frac{1}{1 - f}$$\n其中 $f$ 是在下一次给药前体内剩余药物的分数，由 $f = \\exp(-k_e \\tau)$ 给出。将此代入 $R_{ss}$ 的方程中：\n$$R_{ss} = \\frac{1}{1 - \\exp(-k_e \\tau)}$$\n乘积 $k_e \\tau$ 是一个无单位的量：\n$$k_e \\tau = (0.125\\ \\mathrm{h^{-1}}) \\cdot (12\\ \\mathrm{h}) = 1.5$$\n现在，将此值代入 $R_{ss}$ 的表达式中：\n$$R_{ss} = \\frac{1}{1 - \\exp(-1.5)}$$\n使用值 $\\exp(-1.5) \\approx 0.22313016...$：\n$$R_{ss} \\approx \\frac{1}{1 - 0.22313016} = \\frac{1}{0.77686984} \\approx 1.2872339$$\n按要求四舍五入至四位有效数字，我们得到：\n$$R_{ss} = 1.287$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 5.545  1.287 \\end{pmatrix}}$$"
        },
        {
            "introduction": "临床药理学的精髓在于个体化治疗，而非一概而论。老年人等特殊人群在药物处置（药代动力学）和药物效应（药效学）方面常表现出显著差异。本练习将药代动力学（PK）与药效学（PD）原理相结合，以解决一个真实的临床问题：如何根据老年患者的清除率（$CL$）下降和药物敏感性（$EC_{50}$）改变，来调整镇静药物的初始剂量和后续的剂量滴定方案。这项实践突显了定量药理学在指导精准、安全的个体化给药方面的重要价值，尤其是在处理镇静催眠药这类治疗窗较窄的药物时。",
            "id": "4539983",
            "problem": "一位80岁的患者正被考虑使用替马西泮（temazepam）作为催眠药。已知对于较年轻的成年人，每晚口服 $15$ mg 替马西泮可产生临床上可接受的催眠效果。要求您为这位80岁的患者确定一个初始夜间剂量，使其预期产生相同的药效学效应，并根据一个保守的、基于暴露的规则，指定首次向上滴定步骤的滴定增量。使用以下有科学依据的假设和定义：\n\n- 在线性动力学下，药代动力学暴露与剂量除以全身清除率（CL）成正比，即在固定的给药间隔和生物利用度下，平均浓度与$D/\\mathrm{CL}$成正比；将比例常数记为 $k$。\n- 催眠效应可以用一个标准的最大效应模型来描述，$E(C) = E_{\\max}\\,\\dfrac{C}{EC_{50} + C}$，其中 $E_{\\max}$ 是最大效应，$EC_{50}$ 是产生半数最大效应的浓度，$C$ 是浓度。\n- 与较年轻的成年人相比，这位80岁患者的全身清除率降低至年轻成年人的 $0.60$ 倍，药效学敏感性增加，使得 $EC_{50}$ 降低至年轻成年人 $EC_{50}$ 的 $0.70$ 倍。\n- 假设两组间的口服生物利用度不变，并且比例常数 $k$ 在年轻成年人和80岁患者中相同。\n\n任务：\n1. 仅使用上述定义，并要求80岁患者的效应与年轻成年人服用 $15$ mg 时的效应相匹配，推导并计算80岁患者的初始夜间剂量。\n2. 定义一个保守的滴定规则，其中首次向上滴定步骤应使药代动力学暴露（即成比例的平均浓度）相对于前一次暴露增加不超过 $0.20$。计算从初始剂量开始的相应剂量增量。\n\n将两个所求数值均四舍五入至三位有效数字，并以 mg 为单位表示。以两个数字的形式提供您的最终答案：初始夜间剂量和首次滴定增量。",
            "solution": "我们从两个基本关系开始：线性药代动力学意味着平均浓度与剂量除以全身清除率成正比，因此 $C \\propto D/\\mathrm{CL}$，而药效学最大效应模型为 $E(C) = E_{\\max}\\,\\dfrac{C}{EC_{50} + C}$。\n\n设年轻成年人的参考剂量为 $D_{0} = 15$ mg，其全身清除率为 $\\mathrm{CL}_{0}$，半数最大效应浓度为 $EC_{50,0}$。设80岁患者的初始剂量为 $D_{1}$，其全身清除率为 $\\mathrm{CL}_{1}$，半数最大效应浓度为 $EC_{50,1}$。根据假设，$\\mathrm{CL}_{1} = 0.60\\,\\mathrm{CL}_{0}$ 且 $EC_{50,1} = 0.70\\,EC_{50,0}$。设平均浓度与 $D/\\mathrm{CL}$ 之间的比例常数为 $k$，对两组均相同，因此 $C_{0} = k\\,\\dfrac{D_{0}}{\\mathrm{CL}_{0}}$ 且 $C_{1} = k\\,\\dfrac{D_{1}}{\\mathrm{CL}_{1}}$。\n\n为了与年轻成年人在剂量 $D_{0}$ 时的效应相匹配，我们要求\n$$\nE_{\\max}\\,\\frac{C_{1}}{EC_{50,1} + C_{1}} \\;=\\; E_{\\max}\\,\\frac{C_{0}}{EC_{50,0} + C_{0}}.\n$$\n消去 $E_{\\max}$ 并交叉相乘，\n$$\nC_{1}\\,(EC_{50,0} + C_{0}) \\;=\\; C_{0}\\,(EC_{50,1} + C_{1}).\n$$\n展开并化简，\n$$\nC_{1}\\,EC_{50,0} + C_{1}\\,C_{0} \\;=\\; C_{0}\\,EC_{50,1} + C_{0}\\,C_{1} \\;\\;\\Longrightarrow\\;\\; C_{1}\\,EC_{50,0} \\;=\\; C_{0}\\,EC_{50,1}.\n$$\n因此，\n$$\nC_{1} \\;=\\; C_{0}\\,\\frac{EC_{50,1}}{EC_{50,0}} \\;=\\; C_{0}\\,\\cdot 0.70.\n$$\n使用 $C = k\\,D/\\mathrm{CL}$，我们得到\n$$\nk\\,\\frac{D_{1}}{\\mathrm{CL}_{1}} \\;=\\; 0.70\\,\\left(k\\,\\frac{D_{0}}{\\mathrm{CL}_{0}}\\right)\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{D_{1}}{\\mathrm{CL}_{1}} \\;=\\; 0.70\\,\\frac{D_{0}}{\\mathrm{CL}_{0}}\n\\;\\;\\Longrightarrow\\;\\;\nD_{1} \\;=\\; 0.70\\,D_{0}\\,\\frac{\\mathrm{CL}_{1}}{\\mathrm{CL}_{0}}.\n$$\n代入 $\\dfrac{\\mathrm{CL}_{1}}{\\mathrm{CL}_{0}} = 0.60$ 和 $D_{0} = 15$ mg，\n$$\nD_{1} \\;=\\; 0.70 \\times 15 \\times 0.60 \\;=\\; 6.3 \\;\\text{mg}.\n$$\n四舍五入至三位有效数字，得到初始夜间剂量为 $6.30$ mg。\n\n对于滴定增量，基于暴露的规则规定，首次向上滴定步骤应使药代动力学暴露相对于前一次暴露增加不超过 $0.20$。在线性动力学和恒定的 $\\mathrm{CL}_{1}$ 条件下，暴露与 $D/\\mathrm{CL}_{1}$ 成正比，因此暴露的分数增加等于剂量的分数增加。因此，如果当前剂量为 $D_{1}$，分数增加 $f = 0.20$ 对应的绝对剂量增量为\n$$\n\\Delta D \\;=\\; f\\,D_{1} \\;=\\; 0.20 \\times 6.3 \\;=\\; 1.26 \\;\\text{mg}.\n$$\n四舍五入至三位有效数字，$\\Delta D = 1.26$ mg。\n\n因此，所求的两个数字是初始夜间剂量 $6.30$ mg 和首次滴定增量 $1.26$ mg。",
            "answer": "$$\\boxed{\\begin{pmatrix}6.30  1.26\\end{pmatrix}}$$"
        },
        {
            "introduction": "在前面的练习中，我们使用了给定的药效学参数，如 $EC_{50}$ 和 $E_{max}$。然而，这些关键参数从何而来？它们源于对临床或临床前实验数据的定量分析。本项高级实践将让你扮演一名药物计量学家的角色，使用非线性最小二乘法（NLS）这一强大的统计工具，将S型Emax模型拟合到浓度-效应数据。通过完成这个编程练习，你将获得从原始数据中建立定量模型的实践经验，深刻理解支撑循证给药决策的药效学参数是如何被确定的。",
            "id": "4539757",
            "problem": "给定一种镇静剂在多个血浆浓度下的镇静评分观测值。假设血浆浓度与镇静评分之间的药效学关系遵循经过充分检验的S型Emax模型。该模型源于受体占据原理，其中在血漿浓度为 $C$ 时观测到的镇静效应 $E$ 由以下公式建模：\n$$\nE(C) = \\frac{E_{\\max} \\cdot C^{\\gamma}}{EC_{50}^{\\gamma} + C^{\\gamma}},\n$$\n其中 $E_{\\max}$ 代表最大可能镇静效应，其单位与观测到的镇静评分相同；$EC_{50}$ 代表达到半数最大镇静效应时的血浆浓度；$\\gamma$ (希尔系数) 代表浓度-效应曲线的陡峭程度。假设观测值 $E(C)$ 受到均值为 $0$ 且方差恒定的附加、独立、同分布噪声的影响，并假设 $E_{\\max} > 0$、$EC_{50} > 0$ 且 $\\gamma > 0$。\n\n您的任务是使用非线性最小二乘法 (NLS) 来估计 $E_{\\max}$、$EC_{50}$ 和 $\\gamma$，方法是最小化每个给定数据集的残差平方和。浓度单位为毫克/升 (mg/L)，镇静评分为0到10范围内的无单位数值。最终的数值估计值必须以浮点数形式报告，并四舍五入到三位小数。建模和优化必须纯粹用数学术语来表述，除了基本模型和标准的最小二乘优化之外，不得依赖任何快捷公式。\n\n数据集（每个数据集都是一个由 $(C, E)$ 对组成的列表，其中 $C$ 的单位为 mg/L，E 无单位）：\n\n- 测试用例1（具有中等效价和中等陡峭度的典型案例）：\n  - 浓度 $C$：$[0, 0.5, 1, 2, 4, 8]$ mg/L\n  - 镇静评分 $E$：$[0.00, 0.60, 2.10, 5.05, 8.10, 9.20]$\n\n- 测试用例2（在低浓度下具有强效价和较缓陡峭度的药物）：\n  - 浓度 $C$：$[0, 0.1, 0.2, 0.5, 1.0, 2.0]$ mg/L\n  - 镇静评分 $E$：$[0.00, 1.20, 1.90, 3.60, 4.70, 5.50]$\n\n- 测试用例3（导致快速饱和的陡峭浓度-反应关系）：\n  - 浓度 $C$：$[0, 1, 2, 3, 6, 12]$ mg/L\n  - 镇静评分 $E$：$[0.00, 0.11, 1.50, 4.40, 8.50, 8.95]$\n\n优化要求和约束条件：\n- 将NLS目标定义为每个数据集中，所有观测镇静值 $E$ 与模型预测镇静值 $E(C)$ 之差的平方和。\n- 将参数约束在反映临床药理学的合理范围内：\n  - $E_{\\max} \\in [0.01, 100.0]$\n  - $EC_{50} \\in [10^{-6}, 100.0]$ mg/L\n  - $\\gamma \\in [0.1, 10.0]$\n\n答案规格：\n- 对于每个数据集，使用NLS估计 $E_{\\max}$、$EC_{50}$ 和 $\\gamma$。\n- 将最终估计值表示为四舍五入到三位小数的浮点数，$EC_{50}$ 的单位为 mg/L，$E_{\\max}$ 和 $\\gamma$ 无单位。\n- 您的程序应生成单行输出，其中包含一个由列表组成的列表，以逗号分隔。每个内部列表按 $[E_{\\max}, EC_{50}, \\gamma]$ 的顺序排列，并用方括号括起来。例如，输出应具有以下形式：\n  $[[e_{1}, ec_{1}, g_{1}], [e_{2}, ec_{2}, g_{2}], [e_{3}, ec_{3}, g_{3}]]$\n  其中每个 $e_{i}$、$ec_{i}$ 和 $g_{i}$ 都是四舍五入到三位小数的浮点数。\n\n测试套件覆盖范围说明：\n- 测试用例1提供了一个“理想路径”，其数据点在低、中、高浓度下均有信息丰富的分布。\n- 测试用例2强调了低 $EC_{50}$ 和缓和 $\\gamma$ 的边界条件，确保了在低浓度下的可识别性。\n- 测试用例3探查了高 $\\gamma$（陡峭曲线）的边缘情况，测试了当效应迅速饱和时的优化稳定性和参数可识别性。\n\n实现说明：\n- 优化必须完全依赖于数学上定义的NLS。除了基本的Emax模型和标准优化程序外，不允许使用任何启发式捷径或目标公式。",
            "solution": "用户提供的问题是有效的。它在科学上基于临床药理学原理，特别是药效学，并且作为一个非线性参数估计任务，在数学上是适定的。该问题是客观、自包含的，并且没有任何说明中列出的使其无效的缺陷。因此，我将提供一个完整的解决方案。\n\n### 方法介绍\n\n该问题要求估计S型 $E_{\\max}$ 模型的参数，这是药理学中用于描述药物浓度与其效应之间关系的一个基本方程。该模型由以下公式给出：\n$$\nE(C) = \\frac{E_{\\max} \\cdot C^{\\gamma}}{EC_{50}^{\\gamma} + C^{\\gamma}}\n$$\n其中 $E(C)$ 是浓度为 $C$ 时的效应，$E_{\\max}$ 是最大可能效应，$EC_{50}$ 是产生 $50\\%$ 最大效应时的浓度，而 $\\gamma$（希尔系数）描述了浓度-反应曲线的陡峭程度。\n\n参数 $\\mathbf{p} = [E_{\\max}, EC_{50}, \\gamma]$ 是未知的，必须根据实验数据进行估计，实验数据由观测到的浓度和效应组成的对 $(C_i, E_i)$ 构成。问题陈述观测值受到附加的、独立的、同分布的噪声影响。在这些假设下，非线性最小二乘法 (NLS) 是进行参数估计的合适方法。\n\n### 非线性最小二乘法 (NLS) 公式\n\nNLS的核心原理是找到一组参数 $\\mathbf{p}$，使得残差平方和 (SSR)（也称为误差平方和）最小化。第 $i$ 个数据点的残差是观测效应 $E_i$ 与模型预测效应 $E(C_i; \\mathbf{p})$ 之间的差值。因此，要最小化的目标函数 $S(\\mathbf{p})$ 是：\n$$\nS(\\mathbf{p}) = \\sum_{i=1}^{n} \\left( E_i - E(C_i; \\mathbf{p}) \\right)^2\n$$\n其中 $n$ 是给定数据集中的数据点数量。\n\n因此，优化问题可表述为：\n$$\n\\hat{\\mathbf{p}} = \\arg\\min_{\\mathbf{p}} S(\\mathbf{p})\n$$\n并受限于给定的参数边界：\n$$\nE_{\\max} \\in [0.01, 100.0]\n$$\n$$\nEC_{50} \\in [10^{-6}, 100.0]\n$$\n$$\n\\gamma \\in [0.1, 10.0]\n$$\n\n### 数值解策略\n\n由于模型函数 $E(C; \\mathbf{p})$ 对于参数 $EC_{50}$ 和 $\\gamma$ 是非线性的，因此 $\\hat{\\mathbf{p}}$ 不存在闭式解析解。我们必须采用迭代数值优化算法。适用于此任务并能处理指定的箱式约束（边界）的算法是带边界的有限内存Broyden–Fletcher–Goldfarb–Shanno算法（L-BFGS-B）。\n\n每个数据集的处理过程如下：\n1.  **定义目标函数**：实现一个代表 $S(\\mathbf{p})$ 的函数。该函数将参数向量 $\\mathbf{p}$ 和数据 $(C, E)$ 作为输入，并返回 SSR。为了数值稳定性，模型 $E(C)$ 可以表示为：\n    $$\n    E(C, \\mathbf{p}) = E_{\\max} \\frac{\\left(\\frac{C}{EC_{50}}\\right)^{\\gamma}}{1 + \\left(\\frac{C}{EC_{50}}\\right)^{\\gamma}}\n    $$\n    考虑到 $EC_{50}$ 和 $\\gamma$ 的正约束，这种形式对于 $C \\ge 0$ 表现良好。\n\n2.  **提供初始猜测值**：迭代算法需要参数向量的初始猜测值 $\\mathbf{p}_0 = [E_{\\max,0}, EC_{50,0}, \\gamma_0]$。从数据观察中得出的良好初始猜测值能提高收敛到全局最小值的可能性。\n    -   $E_{\\max,0}$ 可通过最大观测效应来近似。\n    -   $EC_{50,0}$ 可通过找到对应于大约 $E_{\\max,0}/2$ 效应的浓度 $C$ 来近似。\n    -   $\\gamma_0$ 可设为典型值，例如 $1.0$ 或 $2.0$。\n\n3.  **执行优化**：调用L-BFGS-B优化器，向其提供目标函数、初始猜测值 $\\mathbf{p}_0$、数据和参数边界。优化器迭代调整 $\\mathbf{p}$ 以最小化SSR，直到满足收敛准则。\n\n4.  **提取结果**：优化器返回的最终参数向量 $\\hat{\\mathbf{p}}$ 包含了 $E_{\\max}$、$EC_{50}$ 和 $\\gamma$ 的NLS估计值。然后按要求将这些值四舍五入到三位小数。\n\n此过程将独立应用于所提供的三个数据集中的每一个，以获得它们各自的参数估计值。",
            "answer": "[[9.998, 2.222, 2.378], [6.141, 0.443, 1.350], [9.167, 3.541, 4.416]]"
        }
    ]
}