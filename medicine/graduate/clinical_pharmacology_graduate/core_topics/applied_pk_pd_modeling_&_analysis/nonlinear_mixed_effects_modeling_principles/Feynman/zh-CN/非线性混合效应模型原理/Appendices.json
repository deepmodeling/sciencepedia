{
    "hands_on_practices": [
        {
            "introduction": "非线性混合效应模型常常融合生理学原理，例如将体重等协变量进行异速标度。本练习将演示一项基本技术：使用对数变换将一个乘性、非线性的模型转化为线性形式。掌握这项技能使您能够正确解释模型参数，并理解协变量与药代动力学参数之间的关系 。",
            "id": "4568900",
            "problem": "在非线性混合效应模型（NLME）框架下，考虑一项群体药代动力学研究中个体清除率的结构参数化。假设个体清除率 $CL_{i}$ 被建模为一个典型值和个体间变异的乘积分解，同时包含以70公斤为参考的体重 $WT_{i}$ 的异速生长协变量效应。具体而言，假设以下具有科学依据的基础：\n\n- 源自生理学理论的异速生长标度：对于成年哺乳动物，典型代谢率与身体质量遵循指数为 $3/4$ 的幂律关系。\n- 对数正态的个体间变异：正参数上的乘性随机效应可以表示为一个均值为零的正态随机变量的指数，这意味着在对数尺度上噪声具有可加性。\n- 协变量与随机效应的独立性：体重 $WT_{i}$ 被视为一个与随机效应独立的观测协变量。\n\n从这些原则出发，设参数化为\n$$\nCL_{i} \\;=\\; \\theta_{CL} \\left(\\frac{WT_{i}}{70}\\right)^{\\beta} \\exp\\!\\big(\\eta_{CL,i}\\big),\n$$\n其中 $\\theta_{CL} \\!>\\! 0$ 是体重 $WT=70$ 公斤时的典型清除率，$\\beta$ 是异速生长指数，而 $\\eta_{CL,i} \\sim \\mathcal{N}(0,\\omega_{CL}^{2})$ 代表对数尺度上的个体间变异。\n\n假设生理学上合理的异速生长指数 $\\beta = 0.75$。仅使用上述基础和自然对数的一般性质，推导 $\\ln(CL_{i})$ 和 $\\ln(WT_{i}/70)$ 之间的线性关系，并为具有加性误差 $\\eta_{CL,i}$ 的对数-线性表示确定回归截距和斜率。以行矩阵的形式提供您的最终答案，矩阵中依次包含截距和斜率。不需要进行数值代入，也无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于药代动力学和异速生长标度的既定原则，问题提法恰当且有唯一解，并且没有歧义或矛盾。因此，我们可以进行推导。\n\n出发点是给定的个体清除率 $CL_{i}$ 的结构模型：\n$$\nCL_{i} = \\theta_{CL} \\left(\\frac{WT_{i}}{70}\\right)^{\\beta} \\exp(\\eta_{CL,i})\n$$\n其中 $CL_{i}$ 是第 $i$ 个个体的清除率，$\\theta_{CL}$ 是体重为70公斤的个体的典型清除率，$WT_{i}$ 是第 $i$ 个个体的体重，$\\beta$ 是异速生长指数，$\\eta_{CL,i}$ 是代表个体间变异的随机效应，且 $\\eta_{CL,i} \\sim \\mathcal{N}(0, \\omega_{CL}^{2})$。\n\n目标是推导 $\\ln(CL_{i})$ 和 $\\ln(WT_{i}/70)$ 之间的线性关系。这个过程通过对等式两边应用自然对数函数来实现。\n$$\n\\ln(CL_{i}) = \\ln\\left( \\theta_{CL} \\left(\\frac{WT_{i}}{70}\\right)^{\\beta} \\exp(\\eta_{CL,i}) \\right)\n$$\n利用对数的性质，即积的对数等于对数的和，$\\ln(a \\cdot b \\cdot c) = \\ln(a) + \\ln(b) + \\ln(c)$，我们可以展开等式的右边：\n$$\n\\ln(CL_{i}) = \\ln(\\theta_{CL}) + \\ln\\left( \\left(\\frac{WT_{i}}{70}\\right)^{\\beta} \\right) + \\ln(\\exp(\\eta_{CL,i}))\n$$\n接下来，我们应用另外两个对数的性质。首先，对第二项应用幂法则 $\\ln(x^{p}) = p \\ln(x)$。其次，对第三项应用自然对数是指数函数的反函数这一性质，即 $\\ln(\\exp(x)) = x$。这得到：\n$$\n\\ln(CL_{i}) = \\ln(\\theta_{CL}) + \\beta \\ln\\left(\\frac{WT_{i}}{70}\\right) + \\eta_{CL,i}\n$$\n这个方程表示一个线性模型。一个通用的线性回归模型具有以下形式：\n$$\nY = \\text{截距} + (\\text{斜率}) \\cdot X + \\text{误差}\n$$\n通过将我们推导出的方程与此通用形式进行比较，我们可以确定相应的组成部分：\n- 因变量 $Y$ 是 $\\ln(CL_{i})$。\n- 自变量 $X$ 是 $\\ln(WT_{i}/70)$。\n- 加性误差项是 $\\eta_{CL,i}$，这与问题的假设一致，因为 $\\eta_{CL,i}$ 是一个均值为0的随机变量。\n- 截距是常数项，对应于 $\\ln(\\theta_{CL})$。\n- 斜率是自变量的系数，对应于 $\\beta$。\n\n问题指定假设生理学上合理的异速生长指数 $\\beta = 0.75$。将这个值代入斜率，我们得到：\n斜率 $= \\beta = 0.75$。\n截距保持其符号形式 $\\ln(\\theta_{CL})$，因为没有提供典型清除率 $\\theta_{CL}$ 的值。\n\n因此，该对数-线性表示的回归截距和斜率分别为 $\\ln(\\theta_{CL})$ 和 $0.75$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\ln(\\theta_{CL}) & 0.75 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实的临床数据常常包含低于定量下限 (LLOQ) 的测量值。简单地忽略这些数据点或用任意值替代它们会引入偏差。本练习将指导您完成推导此类删失观测值似然贡献的统计学方法，确保所有可用信息都正确地纳入模型中 。",
            "id": "4568933",
            "problem": "在用于临床药理学的非线性混合效应 (NLME) 群体药代动力学模型中，假设第 $i$ 个个体具有随机效应 $\\phi_i$，在第 $j$ 个观测时点的结构预测为 $f_{ij} = f(t_{ij}; \\phi_i)$。观测模型由加性残差结构 $y_{ij} = f_{ij} + \\epsilon_{ij}$ 定义，其中 $\\epsilon_{ij} \\sim \\mathcal{N}(0, \\sigma_{add}^{2})$，并且在给定 $\\phi_i$ 的条件下，在各观测时点间条件独立。该测定方法具有定量下限 (LLOQ)，对于个体 $i$ 在第 $j$ 个观测时点的测量值是删失的，这意味着只观测到事件 $y_{ij}  LLOQ$。从删失观测的似然贡献等于在给定 $\\phi_i$ 的条件下 $y_{ij}$ 的假定条件分布下观测事件的概率这一基本定义出发，推导删失似然贡献 $P(y_{ij}  LLOQ \\mid \\phi_i)$ 的闭式表达式，并用标准正态累积分布函数 $\\Phi(\\cdot)$ 来表示。您的最终答案必须仅用 $LLOQ$、$f_{ij}$ 和 $\\sigma_{add}$ 来表示。您的最终答案必须是一个单一的闭式解析表达式。",
            "solution": "该问题是有效的，因为其科学基础在于药代动力学建模和统计学的原理，问题提法得当，目标明确，信息充分，并且以客观、正式的语言表述。不存在矛盾、歧义或事实不准确之处。因此，我们可以进行推导。\n\n目标是推导删失观测的似然贡献的闭式表达式，该贡献被定义为所观测事件的概率。该事件是指测量值 $y_{ij}$ 低于定量下限 $LLOQ$。因此，对于个体 $i$ 在观测时点 $j$ 的这个删失观测，其似然贡献由条件概率 $P(y_{ij}  LLOQ \\mid \\phi_i)$ 给出。\n\n问题给出了观测值 $y_{ij}$ 的结构模型：\n$$\ny_{ij} = f_{ij} + \\epsilon_{ij}\n$$\n此处，$f_{ij}$ 表示模型预测的个体 $i$ 在观测时点 $j$ 的浓度，它是特定于个体的随机效应向量 $\\phi_i$ 的函数。$\\epsilon_{ij}$ 项是加性残差。\n\n残差的分布被指定为均值为 $0$、方差为 $\\sigma_{add}^{2}$ 的正态分布：\n$$\n\\epsilon_{ij} \\sim \\mathcal{N}(0, \\sigma_{add}^{2})\n$$\n问题说明，在给定 $\\phi_i$ 的条件下，残差 $\\epsilon_{ij}$ 在各观测时点 $j$ 间条件独立。\n\n我们通过将观测模型代入概率不等式来开始推导：\n$$\nP(y_{ij}  LLOQ \\mid \\phi_i) = P(f_{ij} + \\epsilon_{ij}  LLOQ \\mid \\phi_i)\n$$\n条件是基于随机效应 $\\phi_i$。由于结构预测 $f_{ij} = f(t_{ij}; \\phi_i)$ 是 $\\phi_i$ 的确定性函数，在这个条件概率中，$f_{ij}$ 被视为一个固定的已知值。因此，我们可以重排不等式以分离出随机变量 $\\epsilon_{ij}$：\n$$\nP(f_{ij} + \\epsilon_{ij}  LLOQ \\mid \\phi_i) = P(\\epsilon_{ij}  LLOQ - f_{ij} \\mid \\phi_i)\n$$\n问题指出，在给定 $\\phi_i$ 的条件下，残差 $\\epsilon_{ij}$ 相互条件独立。标准的 NLME 模型公式进一步假设残差 $\\epsilon_{ij}$ 与随机效应 $\\phi_i$ 独立。因此，$\\epsilon_{ij}$ 的分布不依赖于 $\\phi_i$，并且可以从只涉及 $\\epsilon_{ij}$ 的概率陈述中移除对 $\\phi_i$ 的条件：\n$$\nP(\\epsilon_{ij}  LLOQ - f_{ij} \\mid \\phi_i) = P(\\epsilon_{ij}  LLOQ - f_{ij})\n$$\n我们有一个涉及正态分布随机变量 $\\epsilon_{ij} \\sim \\mathcal{N}(0, \\sigma_{add}^{2})$ 的概率陈述。为了用标准正态累积分布函数 (CDF) $\\Phi(\\cdot)$ 来表示这个概率，我们必须对随机变量进行标准化。一个随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 可以通过变换 $Z = (X - \\mu) / \\sigma$ 被标准化为一个随机变量 $Z \\sim \\mathcal{N}(0, 1)$。\n\n对于我们的变量 $\\epsilon_{ij}$，均值为 $\\mu = 0$，标准差为 $\\sigma = \\sqrt{\\sigma_{add}^{2}} = \\sigma_{add}$。标准化后的变量是 $\\frac{\\epsilon_{ij} - 0}{\\sigma_{add}} = \\frac{\\epsilon_{ij}}{\\sigma_{add}}$，它服从标准正态分布 $\\mathcal{N}(0, 1)$。\n\n我们将此标准化应用于我们的不等式。由于标准差 $\\sigma_{add}$ 内在地是正数 ($\\sigma_{add}  0$)，除以它不会改变不等式的方向：\n$$\nP(\\epsilon_{ij}  LLOQ - f_{ij}) = P\\left(\\frac{\\epsilon_{ij}}{\\sigma_{add}}  \\frac{LLOQ - f_{ij}}{\\sigma_{add}}\\right)\n$$\n对于一个标准正态变量 $Z$，概率 $P(Z  z)$ 根据定义是在点 $z$ 处的标准正态 CDF 的值，记为 $\\Phi(z)$。因此，我们可以将表达式写为：\n$$\nP\\left(\\frac{\\epsilon_{ij}}{\\sigma_{add}}  \\frac{LLOQ - f_{ij}}{\\sigma_{add}}\\right) = \\Phi\\left(\\frac{LLOQ - f_{ij}}{\\sigma_{add}}\\right)\n$$\n这个表达式代表了删失观测的闭式似然贡献。它用标准正态 CDF $\\Phi(\\cdot)$ 表示，并且仅依赖于指定的量：定量下限 $LLOQ$、模型预测值 $f_{ij}$ 和加性残差标准差 $\\sigma_{add}$。",
            "answer": "$$\\boxed{\\Phi\\left(\\frac{LLOQ - f_{ij}}{\\sigma_{add}}\\right)}$$"
        },
        {
            "introduction": "评估非线性混合效应模型的拟合优度，需要的不仅仅是简单的残差。这项高级练习要求您计算条件加权残差 (CWRES)，这是一个关键的诊断工具，它通过完整的条件方差来标准化残差，同时考虑了残差误差和参数不确定性。从第一性原理出发实现这一计算，将加深您对Delta方法以及NLME模型中变异性来源的理解 。",
            "id": "4568868",
            "problem": "在临床药理学中，我们考虑一个用于单室系统中静脉推注剂量的非线性混合效应模型。对于个体 $i$ 在采样时间 $t_{ij}$，其结构浓度预测由经过充分检验的单室模型公式给出\n$$\nC_{ij} = \\frac{D_i}{V_i}\\exp\\!\\left(-\\frac{CL_i}{V_i}\\,t_{ij}\\right),\n$$\n其中 $D_i$ 是给药剂量，$CL_i$ 是清除率，$V_i$ 是分布容积。个体间变异由对数正态随机效应表示，\n$$\nCL_i = CL_{\\text{pop}}\\exp(\\eta_{CL,i}),\\quad V_i = V_{\\text{pop}}\\exp(\\eta_{V,i}),\n$$\n其中 $CL_{\\text{pop}}$ 和 $V_{\\text{pop}}$ 是群体参数，而 $(\\eta_{CL,i},\\eta_{V,i})$ 是个体特异性随机效应，其条件均值（经验贝叶斯估计，EBE）用于预测，其条件协方差矩阵记为 $S_i \\in \\mathbb{R}^{2\\times 2}$。观测模型是一个组合的比例-加性残差误差模型，\n$$\ny_{ij} = C_{ij}\\left(1+\\epsilon_{p,ij}\\right) + \\epsilon_{a,ij},\n$$\n其中 $\\epsilon_{p,ij}\\sim \\mathcal{N}(0,\\sigma_p^2)$ 和 $\\epsilon_{a,ij}\\sim \\mathcal{N}(0,\\sigma_a^2)$，它们彼此独立且与随机效应无关。所有浓度单位必须为 $\\mathrm{mg/L}$，剂量单位为 $\\mathrm{mg}$，清除率单位为 $\\mathrm{L/h}$，容积单位为 $\\mathrm{L}$，时间单位为 $\\mathrm{h}$。\n\n条件加权残差（CWRES）对每个观测值的定义是：残差除以给定模型和数据下观测值的条件方差的平方根。为了以科学严谨的方式估计条件方差，使用一阶灵敏度（Delta 方法）近似：如果 $C_{ij}$ 依赖于具有条件协方差 $S_i$ 的不确定性 $\\boldsymbol{\\eta}_i = (\\eta_{CL,i}, \\eta_{V,i})^\\top$，那么观测值 $y_{ij}$ 的总条件方差为\n$$\n\\mathrm{Var}\\!\\left[y_{ij}\\mid \\text{data}\\right] \\approx \\nabla_{\\boldsymbol{\\eta}} C_{ij}^\\top S_i \\nabla_{\\boldsymbol{\\eta}} C_{ij} \\;+\\; C_{ij}^2\\sigma_p^2 \\;+\\; \\sigma_a^2.\n$$\n梯度 $\\nabla_{\\boldsymbol{\\eta}} C_{ij}$ 必须使用链式法则和上述结构模型定义从第一性原理推导得出。\n\n您的任务是编写一个完整的程序，该程序能够：\n- 从 $CL_{\\text{pop}}$、$V_{\\text{pop}}$ 和提供的 EBE 值 $(\\eta_{CL,i},\\eta_{V,i})$ 计算 $CL_i$ 和 $V_i$。\n- 为每个采样时间 $t_{ij}$ 计算 $C_{ij}$。\n- 推导 $\\nabla_{\\boldsymbol{\\eta}} C_{ij}$ 并使用 Delta 方法和提供的 $S_i$ 来估计条件方差。\n- 为每个观测值 $y_{ij}$ 计算 CWRES，公式为 $(y_{ij}-C_{ij})/\\sqrt{\\mathrm{Var}[y_{ij}\\mid \\text{data}]}$。\n- 生成一行输出，其中包含所有 CWRES 值，形式为方括号内的逗号分隔列表，每个数值四舍五入到 $6$ 位小数。CWRES 是无量纲的。\n\n使用以下测试套件，它涵盖了一个通用情况、一个边界条件和一个边缘情况：\n- 情况 1（通用“理想路径”）：\n  - $D_1 = 100\\ \\mathrm{mg}$，$CL_{\\text{pop}} = 5\\ \\mathrm{L/h}$，$V_{\\text{pop}} = 50\\ \\mathrm{L}$。\n  - $\\eta_{CL,1} = 0.1$，$\\eta_{V,1} = -0.05$ (EBE)。\n  - $S_1 = \\begin{pmatrix} 0.04  0.01 \\\\ 0.01  0.03 \\end{pmatrix}$。\n  - 采样时间 $t_{1j}\\in \\{0.5, 2.0, 8.0\\}\\ \\mathrm{h}$。\n  - 观测值 $y_{1j}\\in \\{2.06, 1.62, 0.80\\}\\ \\mathrm{mg/L}$。\n  - $\\sigma_p = 0.15$ (无量纲)，$\\sigma_a = 0.05\\ \\mathrm{mg/L}$。\n- 情况 2（时间零点的边界条件）：\n  - $D_2 = 200\\ \\mathrm{mg}$，$CL_{\\text{pop}} = 3\\ \\mathrm{L/h}$，$V_{\\text{pop}} = 40\\ \\mathrm{L}$。\n  - $\\eta_{CL,2} = 0.0$，$\\eta_{V,2} = 0.0$ (EBE)。\n  - $S_2 = \\begin{pmatrix} 0.0001  0.0 \\\\ 0.0  0.0001 \\end{pmatrix}$。\n  - 采样时间 $t_{2j}\\in \\{0.0, 1.0\\}\\ \\mathrm{h}$。\n  - 观测值 $y_{2j}\\in \\{5.05, 4.60\\}\\ \\mathrm{mg/L}$。\n  - $\\sigma_p = 0.10$ (无量纲)，$\\sigma_a = 0.02\\ \\mathrm{mg/L}$。\n- 情况 3（比例误差为零且 $\\boldsymbol{\\eta}$ 相关时的边缘情况）：\n  - $D_3 = 50\\ \\mathrm{mg}$，$CL_{\\text{pop}} = 10\\ \\mathrm{L/h}$，$V_{\\text{pop}} = 20\\ \\mathrm{L}$。\n  - $\\eta_{CL,3} = -0.2$，$\\eta_{V,3} = 0.2$ (EBE)。\n  - $S_3 = \\begin{pmatrix} 0.05  -0.02 \\\\ -0.02  0.07 \\end{pmatrix}$。\n  - 采样时间 $t_{3j}\\in \\{0.5, 3.0\\}\\ \\mathrm{h}$。\n  - 观测值 $y_{3j}\\in \\{2.35, 0.60\\}\\ \\mathrm{mg/L}$。\n  - $\\sigma_p = 0.00$ (无量纲)，$\\sigma_a = 0.10\\ \\mathrm{mg/L}$。\n\n您的程序应生成单行输出，其中包含按上述顺序列出的所有观测值的 CWRES（逐个情况，每个情况内按时间顺序），格式为方括号内的逗号分隔列表，每个条目四舍五入到 $6$ 位小数（例如，$[x_1,x_2,\\dots]$）。",
            "solution": "该问题是有效的。这是一个在临床药理学领域中良定的、有科学依据的问题，它自成体系且没有矛盾。所用的模型、参数和数据在药物计量学领域是标准的，并与基本原理一致。所有提供的协方差矩阵都是正定的。该任务要求严格应用已有的数学和统计方法。\n\n目标是为一系列药代动力学观测数据计算条件加权残差（CWRES）。计算从基本模型定义开始，按一系列步骤执行。\n\n基础模型由三个部分组成：描述药物浓度随时间变化的结构模型，关键参数的个体间变异模型，以及观测数据的残差误差模型。\n对于个体 $i$，在静脉推注剂量 $D_i$ 后时间点 $t_{ij}$ 的药物浓度 $C_{ij}$ 的结构模型由单室模型给出：\n$$\nC_{ij} = \\frac{D_i}{V_i}\\exp\\left(-\\frac{CL_i}{V_i}t_{ij}\\right)\n$$\n参数清除率（$CL_i$）和分布容积（$V_i$）在个体之间存在差异。这种变异性围绕群体典型值（$CL_{\\text{pop}}$，$V_{\\text{pop}}$）进行对数正态建模：\n$$\nCL_i = CL_{\\text{pop}}\\exp(\\eta_{CL,i})\n$$\n$$\nV_i = V_{\\text{pop}}\\exp(\\eta_{V,i})\n$$\n在这里，$\\eta_{CL,i}$ 和 $\\eta_{V,i}$ 是个体特异性随机效应，我们使用它们的条件均值（经验贝叶斯估计，EBEs）进行预测。\n\n观测浓度 $y_{ij}$ 通过一个组合的比例和加性误差模型与真实（结构）浓度 $C_{ij}$ 相关联：\n$$\ny_{ij} = C_{ij}(1+\\epsilon_{p,ij}) + \\epsilon_{a,ij}\n$$\n其中 $\\epsilon_{p,ij} \\sim \\mathcal{N}(0, \\sigma_p^2)$ 和 $\\epsilon_{a,ij} \\sim \\mathcal{N}(0, \\sigma_a^2)$ 分别代表独立的、服从正态分布的比例和加性误差项。\n\nCWRES 定义为观测浓度与预测浓度之差，通过观测值的条件标准差的估计值进行归一化。CWRES 的公式是：\n$$\n\\text{CWRES}_{ij} = \\frac{y_{ij} - C_{ij}}{\\sqrt{\\mathrm{Var}[y_{ij} \\mid \\text{data}]}}\n$$\n其中 $C_{ij}$ 是使用 $\\boldsymbol{\\eta}_i = (\\eta_{CL,i}, \\eta_{V,i})^\\top$ 的 EBEs 计算的。条件方差 $\\mathrm{Var}[y_{ij} \\mid \\text{data}]$ 考虑了两个变异来源：个体参数 $\\boldsymbol{\\eta}_i$ 的不确定性和残差未解释的变异（测量误差）。\n\n总条件方差使用一阶泰勒展开（Delta 方法）进行近似。它等于参数不确定性引起的方差与残差误差的方差之和：\n$$\n\\mathrm{Var}[y_{ij} \\mid \\text{data}] \\approx \\nabla_{\\boldsymbol{\\eta}} C_{ij}^\\top S_i \\nabla_{\\boldsymbol{\\eta}} C_{ij} + \\mathrm{Var}\\left[C_{ij}\\epsilon_{p,ij} + \\epsilon_{a,ij}\\right]\n$$\n鉴于误差项的独立性，残差方差分量为：\n$$\n\\mathrm{Var}\\left[C_{ij}\\epsilon_{p,ij} + \\epsilon_{a,ij}\\right] = C_{ij}^2 \\mathrm{Var}[\\epsilon_{p,ij}] + \\mathrm{Var}[\\epsilon_{a,ij}] = C_{ij}^2\\sigma_p^2 + \\sigma_a^2\n$$\n项 $\\nabla_{\\boldsymbol{\\eta}} C_{ij}$ 是结构模型 $C_{ij}$ 相对于随机效应 $\\boldsymbol{\\eta}_i$ 的梯度（一阶偏导数向量），在 EBEs 处求值。$S_i$ 是 EBEs 的条件协方差矩阵。\n\n关键步骤是推导梯度 $\\nabla_{\\boldsymbol{\\eta}} C_{ij} = \\left(\\frac{\\partial C_{ij}}{\\partial \\eta_{CL,i}}, \\frac{\\partial C_{ij}}{\\partial \\eta_{V,i}}\\right)^\\top$。我们应用链式法则。\n\n我们来推导第一个分量，$\\frac{\\partial C_{ij}}{\\partial \\eta_{CL,i}}$：\n$$\n\\frac{\\partial C_{ij}}{\\partial \\eta_{CL,i}} = \\frac{\\partial C_{ij}}{\\partial CL_i} \\frac{\\partial CL_i}{\\partial \\eta_{CL,i}}\n$$\n$CL_i$ 关于 $\\eta_{CL,i}$ 的导数是：\n$$\n\\frac{\\partial CL_i}{\\partial \\eta_{CL,i}} = \\frac{\\partial}{\\partial \\eta_{CL,i}} \\left(CL_{\\text{pop}}\\exp(\\eta_{CL,i})\\right) = CL_{\\text{pop}}\\exp(\\eta_{CL,i}) = CL_i\n$$\n$C_{ij}$ 关于 $CL_i$ 的导数是：\n$$\n\\frac{\\partial C_{ij}}{\\partial CL_i} = \\frac{\\partial}{\\partial CL_i} \\left(\\frac{D_i}{V_i}\\exp\\left(-\\frac{CL_i}{V_i}t_{ij}\\right)\\right) = \\frac{D_i}{V_i} \\exp\\left(-\\frac{CL_i}{V_i}t_{ij}\\right) \\cdot \\left(-\\frac{t_{ij}}{V_i}\\right) = -C_{ij}\\frac{t_{ij}}{V_i}\n$$\n将它们组合起来，我们得到：\n$$\n\\frac{\\partial C_{ij}}{\\partial \\eta_{CL,i}} = \\left(-C_{ij}\\frac{t_{ij}}{V_i}\\right) \\cdot CL_i = -C_{ij}\\frac{CL_i t_{ij}}{V_i}\n$$\n现在，对于第二个分量，$\\frac{\\partial C_{ij}}{\\partial \\eta_{V,i}}$：\n$$\n\\frac{\\partial C_{ij}}{\\partial \\eta_{V,i}} = \\frac{\\partial C_{ij}}{\\partial V_i} \\frac{\\partial V_i}{\\partial \\eta_{V,i}}\n$$\n$V_i$ 关于 $\\eta_{V,i}$ 的导数是：\n$$\n\\frac{\\partial V_i}{\\partial \\eta_{V,i}} = \\frac{\\partial}{\\partial \\eta_{V,i}} \\left(V_{\\text{pop}}\\exp(\\eta_{V,i})\\right) = V_{\\text{pop}}\\exp(\\eta_{V,i}) = V_i\n$$\n$C_{ij}$ 关于 $V_i$ 的导数需要使用乘法法则，因为 $V_i$ 出现在指数前因子和指数内部：\n$$\n\\frac{\\partial C_{ij}}{\\partial V_i} = \\frac{\\partial}{\\partial V_i} \\left(D_i V_i^{-1} \\exp\\left(-\\frac{CL_i t_{ij}}{V_i}\\right)\\right)\n$$\n$$\n= D_i \\left[ (-1)V_i^{-2}\\exp\\left(-\\frac{CL_i t_{ij}}{V_i}\\right) + V_i^{-1}\\exp\\left(-\\frac{CL_i t_{ij}}{V_i}\\right) \\cdot \\left(\\frac{CL_i t_{ij}}{V_i^2}\\right) \\right]\n$$\n$$\n= \\frac{D_i}{V_i}\\exp\\left(-\\frac{CL_i t_{ij}}{V_i}\\right) \\left[ -\\frac{1}{V_i} + \\frac{CL_i t_{ij}}{V_i^2} \\right] = C_{ij} \\frac{1}{V_i}\\left(\\frac{CL_i t_{ij}}{V_i} - 1\\right)\n$$\n将它们组合起来，我们发现：\n$$\n\\frac{\\partial C_{ij}}{\\partial \\eta_{V,i}} = \\left(C_{ij} \\frac{1}{V_i}\\left(\\frac{CL_i t_{ij}}{V_i} - 1\\right)\\right) \\cdot V_i = C_{ij}\\left(\\frac{CL_i t_{ij}}{V_i} - 1\\right)\n$$\n因此，梯度向量为：\n$$\n\\nabla_{\\boldsymbol{\\eta}} C_{ij} = \\begin{pmatrix} -C_{ij} \\frac{CL_i t_{ij}}{V_i} \\\\ C_{ij}\\left(\\frac{CL_i t_{ij}}{V_i} - 1\\right) \\end{pmatrix}\n$$\n来自参数不确定性的方差贡献是二次型 $\\text{Var}_{\\eta} = \\nabla_{\\boldsymbol{\\eta}} C_{ij}^\\top S_i \\nabla_{\\boldsymbol{\\eta}} C_{ij}$。\n\n对于每个观测值 $(y_{ij}, t_{ij})$ 的完整算法如下：\n1. 使用群体参数和 EBEs $\\eta_{CL,i}$ 和 $\\eta_{V,i}$ 计算个体参数 $CL_i$ 和 $V_i$。\n2. 使用结构模型计算预测浓度 $C_{ij}$。\n3. 使用推导出的公式计算梯度 $\\nabla_{\\boldsymbol{\\eta}} C_{ij}$ 的分量。\n4. 计算由参数不确定性引起的方差：$\\text{Var}_{\\eta} = \\nabla_{\\boldsymbol{\\eta}} C_{ij}^\\top S_i \\nabla_{\\boldsymbol{\\eta}} C_{ij}$。\n5. 计算残差误差方差：$\\text{Var}_{\\epsilon} = C_{ij}^2\\sigma_p^2 + \\sigma_a^2$。\n6. 将方差相加得到总条件方差：$\\text{Var}_{\\text{total}} = \\text{Var}_{\\eta} + \\text{Var}_{\\epsilon}$。\n7. 计算 CWRES：$\\text{CWRES}_{ij} = (y_{ij} - C_{ij}) / \\sqrt{\\text{Var}_{\\text{total}}}$。\n\n此过程将应用于所提供测试套件中的所有观测值。",
            "answer": "[-0.198946,0.306073,0.185207,0.099039,-0.208151,0.208886,0.22276]"
        }
    ]
}