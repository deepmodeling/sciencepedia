{
    "hands_on_practices": [
        {
            "introduction": "设计给药方案的第一步通常是确定一个负荷剂量，以快速达到目标治疗浓度。这个练习将通过从第一性原理出发，帮助您掌握剂量、表观分布容积和生物利用度之间的基本关系。通过推导单次口服负荷剂量的公式 ，您将巩固对药物如何在体内分布的核心概念的理解。",
            "id": "4576857",
            "problem": "需要为一名患者设计一种口服药物的单剂量给药方案，该患者的药代动力学可以用具有线性（一级）消除和分布的单室模型来近似。表观分布容积为 $V=50\\ \\text{L}$，系统清除率为 $CL=5\\ \\text{L/h}$，绝对口服生物利用度为 $F=0.8$。您希望达到的目标总血浆浓度为 $C_{\\text{target}}=10\\ \\text{mg/L}$，作为吸收后即刻的峰浓度。\n\n仅从质量平衡的第一性原理和单室线性药代动力学的核心定义出发，推导出口服负荷剂量 $D_{\\text{LD}}$ 的表达式，该剂量是在快速吸收后（假设与给药时间尺度上的分布和消除相比，任何吸收延迟都可以忽略不计）立即达到 $C_{\\text{target}}$ 所需的。清楚地陈述您推导所需的所有模型假设，并论证该计算是否需要 $CL$。\n\n然后，使用所提供的参数值计算 $D_{\\text{LD}}$ 的数值。以 $\\text{mg}$ 为单位表示最终剂量，并将您的答案四舍五入到三位有效数字。",
            "solution": "所述问题具有科学依据、提法明确、客观，并包含足够的信息以得出唯一解。该问题基于临床药理学中的标准基础模型。因此，该问题被认为是有效的，并将提供解答。\n\n目标是推导出口服负荷剂量 $D_{\\text{LD}}$ 的表达式，该剂量是在吸收后立即达到目标血浆浓度 $C_{\\text{target}}$ 所必需的。此推导将基于单室药代动力学模型内的质量平衡第一性原理。\n\n首先，我们定义核心概念。\n表观分布容积 $V$ 是一个比例常数，它将体内任意时刻 $t$ 的药物总量（记为 $A(t)$）与血浆中的药物浓度 $C(t)$ 联系起来。这种关系是单个、充分混合室的质量平衡陈述：\n$$A(t) = V \\cdot C(t)$$\n\n对于口服给药的药物，由于不完全吸收和/或首过代谢，并非所有给药剂量 $D$ 都能进入体循环。进入体循环的给药剂量分数是绝对生物利用度 $F$。因此，进入人体体循环的药物总量由乘积 $F \\cdot D$ 给出。在本例中，剂量是负荷剂量 $D_{\\text{LD}}$。因此，将被吸收到体循环中的药物总量是 $F \\cdot D_{\\text{LD}}$。\n\n问题指明，目标浓度 $C_{\\text{target}}$ 是要作为“吸收后即刻的峰浓度”来达到的。这意味着一个模型假设，即整个吸收过程被认为是瞬时完成的。让我们将这个瞬时吸收完成后的即刻时间记为 $t=0^+$。在这一刻，全部生物可利用剂量 $F \\cdot D_{\\text{LD}}$ 已经进入体循环并分布在整个容积 $V$ 中。瞬时吸收的假设也意味着我们可以忽略在有限的吸收期间可能发生的任何药物消除。因此，在 $t=0^+$ 时，体内的药物总量恰好是生物可利用剂量：\n$$A(t=0^+) = F \\cdot D_{\\text{LD}}$$\n\n在同一瞬间，血浆浓度达到其峰值，即我们的目标浓度 $C_{\\text{target}}$：\n$$C(t=0^+) = C_{\\text{target}}$$\n\n通过在 $t=0^+$ 这个特定时刻应用分布容积的定义，我们得到：\n$$A(t=0^+) = V \\cdot C(t=0^+)$$\n\n现在我们可以将 $A(t=0^+)$ 和 $C(t=0^+)$ 的表达式代入此方程：\n$$F \\cdot D_{\\text{LD}} = V \\cdot C_{\\text{target}}$$\n\n我们的目标是求出所需的负荷剂量 $D_{\\text{LD}}$。我们可以重新整理方程来解出 $D_{\\text{LD}}$：\n$$D_{\\text{LD}} = \\frac{V \\cdot C_{\\text{target}}}{F}$$\n\n这就是推导出的口服负荷剂量表达式。\n\n此推导所需的模型假设如下：\n1.  **单室模型**：药物在单个、均质的容积 $V$ 中瞬时且均匀地分布。\n2.  **瞬时吸收**：药物从胃肠道吸收到体循环的速度是无限快的。这是计算负荷剂量时常用的简化方法，等同于将吸收速率常数 $k_a$ 设为无穷大。\n3.  **达到峰浓度前消除可忽略**：作为瞬时吸收假设的直接结果，在达到峰浓度之前没有显著量的药物被消除。计算是在消除过程有机会减少体内药物量之前的一个时间点（$t=0^+$）进行的。\n4.  **线性药代动力学**：所有过程（分布、消除）都是一级的，意味着参数 $V$、$CL$ 和 $F$ 是常数，不随剂量或浓度而改变。\n\n此计算不需要系统清除率 $CL$。推导出的表达式 $D_{\\text{LD}} = \\frac{V \\cdot C_{\\text{target}}}{F}$ 不包含 $CL$。清除率是衡量药物从体内消除速率的指标 ($-\\frac{dA(t)}{dt} = CL \\cdot C(t)$)。由于问题要求在瞬时吸收和分布的假设下，计算达到初始目标浓度所需的剂量，我们实际上是在计算将表观分布容积“填充”到所需浓度所需的药物质量。消除过程随时间发生，在达到峰值的那一刻尚未开始，因此由 $CL$ 控制的其速率与此特定计算无关。\n\n最后，我们使用提供的参数计算 $D_{\\text{LD}}$ 的数值：\n表观分布容积, $V = 50\\ \\text{L}$。\n目标总血浆浓度, $C_{\\text{target}} = 10\\ \\text{mg/L}$。\n绝对口服生物利用度, $F = 0.8$。\n\n将这些值代入我们推导的公式：\n$$D_{\\text{LD}} = \\frac{(50\\ \\text{L}) \\cdot (10\\ \\text{mg/L})}{0.8}$$\n$$D_{\\text{LD}} = \\frac{500\\ \\text{mg}}{0.8}$$\n$$D_{\\text{LD}} = 625\\ \\text{mg}$$\n\n计算值为 $625$。这个数字恰好有三位有效数字，因此不需要进一步四舍五入。最终剂量为 $625\\ \\text{mg}$。",
            "answer": "$$\\boxed{625}$$"
        },
        {
            "introduction": "在给予负荷剂量后，维持药物浓度在治疗窗内需要一个精确的维持给药方案。本练习将药代动力学（PK）与药效学（PD）目标相结合，这是一个在临床实践中选择有效且安全剂量的关键步骤。您将为一个β-内酰胺类抗生素计算达到特定稳态药效目标（$fT>\\text{MIC}$）所需的剂量 ，从而深入理解浓度-时间曲线与药物疗效之间的联系。",
            "id": "4576855",
            "problem": "一名疑似革兰氏阴性菌败血症的成年患者将接受静脉注射β-内酰胺类抗生素。假设采用单室模型，具有线性动力学、每次给药后瞬时分布和一级消除的特点。时间依赖性杀菌的药效学目标是，在每个给药间隔内，药物浓度高于最低抑菌浓度的时间分数（表示为 $fT>\\text{MIC}$）为 $0.60$。药物的游离（未结合）分数为 $f=0.70$，最低抑菌浓度 (MIC) 为 $1$ mg/L，消除半衰期为 $t_{1/2}=2$ h，给药间隔为 $\\tau=8$ h（即每8小时一次），稳态下的表观分布容积为 $V_d=25$ L（反映了细胞外液的扩张）。假设处于稳态，并忽略任何随时间变化的蛋白结合。\n\n使用一级消除和多次给药叠加的基本原理，确定在每8小时（q8h）给药方案下，为达到 $fT>\\text{MIC}=0.60$ 所需的单次给药剂量（以毫克为单位）。\n\n- 最终的单次给药剂量以毫克表示。\n- 将答案四舍五入至三位有效数字。",
            "solution": "我们从单室模型中一级消除和稳态叠加的核心定义开始。\n\n1. 将消除速率常数与半衰期关联起来：\n$$\nk \\;=\\; \\frac{\\ln 2}{t_{1/2}}.\n$$\n\n2. 对于瞬时分布和线性动力学的静脉推注剂量，单次给药后的浓度衰减如下：\n$$\nC(t) \\;=\\; C_{0}\\,\\exp(-k t), \\quad t \\ge 0,\n$$\n其中 $C_{0}$ 是给药后的瞬时浓度。对于每 $\\tau$ 小时给予的多次相同剂量，给药间隔内的稳态浓度曲线是周期性的，等于从稳态峰浓度 $C_{\\max,\\text{ss}}$ 开始的指数衰减：\n$$\nC_{\\text{ss}}(t) \\;=\\; C_{\\max,\\text{ss}}\\,\\exp(-k t), \\quad 0 \\le t \\le \\tau.\n$$\n通过对重复推注的几何级数进行叠加，稳态峰浓度与剂量和分布容积的关系为：\n$$\nC_{\\max,\\text{ss}} \\;=\\; \\frac{\\text{Dose}/V_d}{1 - \\exp(-k\\tau)}.\n$$\n\n3. 药效学目标以游离（未结合）浓度 $f\\,C_{\\text{ss}}(t)$ 表示。定义 $t_M$ 为一个给药间隔内 $f\\,C_{\\text{ss}}(t)$ 超过最低抑菌浓度 (MIC) 的持续时间。在边界时间 $t_M$ 处，\n$$\nf\\,C_{\\text{ss}}(t_M) \\;=\\; \\text{MIC}.\n$$\n使用 $C_{\\text{ss}}(t)=C_{\\max,\\text{ss}}\\,\\exp(-k t)$，求解 $t_M$：\n$$\nf\\,C_{\\max,\\text{ss}}\\,\\exp(-k t_M) \\;=\\; \\text{MIC}\n\\;\\;\\Rightarrow\\;\\;\n\\exp(-k t_M) \\;=\\; \\frac{\\text{MIC}}{f\\,C_{\\max,\\text{ss}}}\n\\;\\;\\Rightarrow\\;\\;\nt_M \\;=\\; \\frac{1}{k}\\,\\ln\\!\\left(\\frac{f\\,C_{\\max,\\text{ss}}}{\\text{MIC}}\\right).\n$$\n\n4. 目标 $fT>\\text{MIC} = 0.60$ 意味着在每个给药间隔中，游离浓度超过 MIC 的时间应占 $0.60$ 的比例，因此：\n$$\n\\frac{t_M}{\\tau} \\;=\\; 0.60\n\\;\\;\\Rightarrow\\;\\;\nt_M \\;=\\; 0.60\\,\\tau.\n$$\n将此式与上面的表达式相等，得到对稳态峰浓度的要求：\n$$\n\\frac{1}{k}\\,\\ln\\!\\left(\\frac{f\\,C_{\\max,\\text{ss}}}{\\text{MIC}}\\right) \\;=\\; 0.60\\,\\tau\n\\;\\;\\Rightarrow\\;\\;\n\\ln\\!\\left(\\frac{f\\,C_{\\max,\\text{ss}}}{\\text{MIC}}\\right) \\;=\\; 0.60\\,k\\,\\tau\n\\;\\;\\Rightarrow\\;\\;\nC_{\\max,\\text{ss}} \\;=\\; \\frac{\\text{MIC}}{f}\\,\\exp\\!\\big(0.60\\,k\\,\\tau\\big).\n$$\n\n5. 将此要求代入稳态峰浓度-剂量关系式，以求解所需剂量：\n$$\n\\frac{\\text{Dose}}{V_d}\\,\\frac{1}{1-\\exp(-k\\tau)} \\;=\\; \\frac{\\text{MIC}}{f}\\,\\exp\\!\\big(0.60\\,k\\,\\tau\\big)\n\\;\\;\\Rightarrow\\;\\;\n\\text{Dose} \\;=\\; V_d\\,\\big[1-\\exp(-k\\tau)\\big]\\;\\frac{\\text{MIC}}{f}\\,\\exp\\!\\big(0.60\\,k\\,\\tau\\big).\n$$\n\n6. 先符号化地代入给定参数，然后进行数值计算：\n- $t_{1/2} = 2$ h，所以\n$$\nk \\;=\\; \\frac{\\ln 2}{2} \\;\\text{h}^{-1}.\n$$\n- $\\tau = 8$ h，所以\n$$\nk\\,\\tau \\;=\\; \\frac{\\ln 2}{2}\\times 8 \\;=\\; 4\\,\\ln 2 \\;=\\; \\ln(2^{4}) \\;=\\; \\ln(16).\n$$\n因此\n$$\n\\exp(-k\\tau) \\;=\\; \\exp\\!\\big(-\\ln 16\\big) \\;=\\; \\frac{1}{16}\n\\quad\\text{和}\\quad\n1-\\exp(-k\\tau) \\;=\\; 1-\\frac{1}{16} \\;=\\; \\frac{15}{16}.\n$$\n此外，\n$$\n0.60\\,k\\,\\tau \\;=\\; 0.60 \\times \\ln(16) \\;=\\; \\ln\\!\\big(16^{0.60}\\big) \\;=\\; \\ln\\!\\big(2^{4\\times 0.60}\\big) \\;=\\; \\ln\\!\\big(2^{2.4}\\big),\n$$\n所以\n$$\n\\exp\\!\\big(0.60\\,k\\,\\tau\\big) \\;=\\; 2^{2.4}.\n$$\n将这些代入剂量表达式中：\n$$\n\\text{Dose} \\;=\\; V_d \\left(\\frac{15}{16}\\right)\\,\\frac{\\text{MIC}}{f}\\,2^{2.4}.\n$$\n\n7. 使用 $V_d=25$ L，$\\text{MIC}=1$ mg/L 和 $f=0.70$ 计算数值：\n- $2^{2.4} \\approx 5.278031643$,\n- $\\frac{15}{16} = 0.9375$,\n- $\\frac{\\text{MIC}}{f} = \\frac{1}{0.70} \\approx 1.428571429$.\n因此\n$$\n\\text{Dose} \\;\\approx\\; 25 \\times 0.9375 \\times 1.428571429 \\times 5.278031643 \\;\\text{mg}\n\\;\\approx\\; 176.7198095 \\;\\text{mg}.\n$$\n\n四舍五入至三位有效数字，所需的单次给药剂量为 $177$ mg。\n\n因此，在所述假设下，为通过每8小时（q8h）给药方案达到 $fT>\\text{MIC}=0.60$ 的目标，单次给药剂量应为 $177$ mg。",
            "answer": "$$\\boxed{177}$$"
        },
        {
            "introduction": "真实世界中的患者在药物代谢和分布方面存在显著的个体差异，因此评估给药方案时不能仅依赖于“典型”患者的参数。这项高级实践将引导您使用群体药代动力学模拟，这是一种评估给药方案在多样化人群中表现的强大现代方法。通过编写程序来模拟群体反应 ，您将学会如何量化并预测达到治疗目标的概率，这是模型引导的药物研发（MIDD）中的核心技能。",
            "id": "4576837",
            "problem": "要求您设计并实现一个基于仿真的程序，用于在一个单室线性药代动力学模型中量化给药方案在稳态谷浓度方面的性能，该程序适用于临床药理学中的剂量和给药方案选择。该模型考虑血管外给药、即时输入、一级消除以及清除率的个体间变异。您的实现必须遵循基本的质量平衡定律以及清除率和分布容积的定义，不得依赖任何预先封装的药代动力学计量学快捷方法。\n\n使用的起点和定义：\n- 药代动力学/药效动力学 (PK/PD) 指的是剂量、药物浓度随时间的变化以及效应之间的定量关系；在本任务中，仅关注药代动力学。\n- 清除率 $CL$ 定义为消除速率等于 $CL \\cdot C$，其中 $C$ 是浓度。分布容积 $V$ 通过 $C = A/V$ 将药物量 $A$ 与浓度相关联。对于具有一级消除的单室模型，消除速率常数为 $k = CL/V$。在血管外即时输入和线性动力学条件下，两次给药之间，浓度根据质量平衡呈指数衰减。\n- 在线性动力学和固定给药间隔的多次给药条件下达到稳态时，总浓度是之前所有剂量所产生的指数衰减贡献的叠加。\n\n个体间变异 (IIV) 模型：\n- 假设 $CL$ 存在对数正态的个体间变异 (IIV)：对于个体 $i$，$CL_i = CL_{typ} \\exp(\\eta_i)$，其中 $\\eta_i$ 服从均值为 $0$、方差为 $\\omega^2$ 的正态分布。将自然标度上给定的变异系数（记为 $\\omega_{CL}$）解释为对数正态模型下 $CL_i$ 分布所期望的变异系数。您必须校准 $\\omega$，使得 $CL_i$ 在自然标度上的变异系数等于 $\\omega_{CL}$。典型值 $CL_{typ}$ 是对数正态分布的几何平均值。所有个体的分布容积 $V$ 固定为其典型值。所有情况下的生物利用度 $F=1$。\n\n目标：\n- 对于每个测试用例，模拟一个包含 $N$ 个个体的虚拟队列，根据上述 IIV 模型抽取 $CL_i$ 值，为每个个体计算在指定剂量 $D$ 和给药间隔 $\\tau$ 下的精确稳态谷浓度 $C_{min,ss}$（即下一次给药前瞬间的浓度），并估计 $C_{min,ss}  C_{min,target}$ 的个体比例。\n- 稳态谷浓度的计算必须遵循第一性原理：即单室一级消除模型中的质量平衡，使用之前剂量的衰减贡献的叠加，以及 $k = CL/V$ 的定义。\n\n仿真要求：\n- 使用固定的随机数生成器种子 $20231111$ 以确保可复现性。\n- 所有浓度单位必须为 $\\text{mg/L}$，清除率单位为 $\\text{L/h}$，容积单位为 $\\text{L}$，时间单位为 $\\text{h}$，剂量单位为 $\\text{mg}$。\n- 估计的比例必须以小数形式打印（不带百分号），每个值四舍五入到 $6$ 位小数。\n\n测试套件：\n对于以下每一组参数，按上述说明计算所需的比例。所有情况下，均使用 $F=1$。\n\n1. 基线变异性和给药方案：\n   - $CL_{typ} = 6\\,\\text{L/h}$，$V_{typ} = 60\\,\\text{L}$，$\\omega_{CL} = 0.30$ (变异系数)，$D = 100\\,\\text{mg}$，$\\tau = 12\\,\\text{h}$，$N=100000$，$C_{min,target} = 2\\,\\text{mg/L}$。\n\n2. 零变异边界情况：\n   - $CL_{typ} = 6\\,\\text{L/h}$，$V_{typ} = 60\\,\\text{L}$，$\\omega_{CL} = 0.00$ (变异系数)，$D = 100\\,\\text{mg}$，$\\tau = 12\\,\\text{h}$，$N=1000$，$C_{min,target} = 2\\,\\text{mg/L}$。\n\n3. 存在变异的高剂量情况：\n   - $CL_{typ} = 6\\,\\text{L/h}$，$V_{typ} = 60\\,\\text{L}$，$\\omega_{CL} = 0.30$ (变异系数)，$D = 500\\,\\text{mg}$，$\\tau = 12\\,\\text{h}$，$N=100000$，$C_{min,target} = 2\\,\\text{mg/L}$。\n\n4. 较长给药间隔及较慢典型清除率：\n   - $CL_{typ} = 3\\,\\text{L/h}$，$V_{typ} = 60\\,\\text{L}$，$\\omega_{CL} = 0.30$ (变异系数)，$D = 100\\,\\text{mg}$，$\\tau = 24\\,\\text{h}$，$N=100000$，$C_{min,target} = 2\\,\\text{mg/L}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内无空格，结果按上述测试用例的顺序排列。每个值必须四舍五入到 $6$ 位小数。例如：$\\texttt{[0.123456,0.000000,0.987654,0.555000]}$。",
            "solution": "该问题是有效的，因为它基于基本的药代动力学原理，具有科学依据，提法得当，并包含了推导唯一解所需的所有信息。\n\n该问题要求设计一个仿真程序，以估计一个虚拟患者队列中，稳态谷浓度 ($C_{\\text{min,ss}}$) 低于目标阈值 ($C_{\\text{min,target}}$) 的患者比例。该仿真基于一个单室药代动力学模型，该模型包含即时血管外输入、一级消除和清除率的个体间变异。\n\n下文我们将首先从第一性原理推导必要的方程，然后概述仿真算法。\n\n**1. 稳态谷浓度 ($C_{\\text{min,ss}}$) 的推导**\n\n该模型由单个房室内的质量平衡定义。设 $A(t)$ 为时间 $t$ 时体内的药物量，$V$ 为分布容积，$CL$ 为清除率。浓度为 $C(t) = A(t)/V$。消除速率定义为 $CL \\cdot C(t)$。\n\n两次给药之间体内药物量的变化率由以下微分方程控制：\n$$\n\\frac{dA(t)}{dt} = - (\\text{消除速率}) = -CL \\cdot C(t)\n$$\n代入 $C(t) = A(t)/V$ 并定义一级消除速率常数 $k = CL/V$，我们得到：\n$$\n\\frac{dA(t)}{dt} = -\\frac{CL}{V} A(t) = -k A(t)\n$$\n这是一个一阶线性常微分方程。其解描述了药物量随时间的指数衰减：\n$$\nA(t) = A_0 e^{-kt}\n$$\n其中 $A_0$ 是时间 $t=0$ 时的初始药物量。用浓度表示，则为：\n$$\nC(t) = C_0 e^{-kt}\n$$\n其中 $C_0 = A_0/V$。\n\n问题指定了一个多次给药方案，其中剂量 $D$ 以固定间隔 $\\tau$ 给药。生物利用度 $F$ 假定为 $1$。“即时输入”意味着在每个给药间隔开始时，体内的药物量会瞬时增加一个剂量 $D$。\n\n设 $C_{\\text{min,ss}}$ 为稳态谷浓度（给药前的瞬时浓度），$C_{\\text{max,ss}}$ 为稳态峰浓度（给药后的瞬时浓度）。在稳态下，给药前的瞬时浓度为 $C_{\\text{min,ss}}$。给药后，浓度立即增加 $D/V$：\n$$\nC_{\\text{max,ss}} = C_{\\text{min,ss}} + \\frac{D \\cdot F}{V} = C_{\\text{min,ss}} + \\frac{D}{V}\n$$\n在给药间隔 $\\tau$ 内，该峰浓度呈指数衰减。下一次给药前的瞬时浓度（在稳态下，该值再次为 $C_{\\text{min,ss}}$）为：\n$$\nC_{\\text{min,ss}} = C_{\\text{max,ss}} \\cdot e^{-k\\tau}\n$$\n我们现在有一个包含两个未知数 $C_{\\text{min,ss}}$ 和 $C_{\\text{max,ss}}$ 的二元方程组。将第一个方程代入第二个方程：\n$$\nC_{\\text{min,ss}} = \\left( C_{\\text{min,ss}} + \\frac{D}{V} \\right) e^{-k\\tau}\n$$\n$$\nC_{\\text{min,ss}} = C_{\\text{min,ss}} e^{-k\\tau} + \\frac{D}{V} e^{-k\\tau}\n$$\n$$\nC_{\\text{min,ss}} (1 - e^{-k\\tau}) = \\frac{D}{V} e^{-k\\tau}\n$$\n解出 $C_{\\text{min,ss}}$，得到稳态谷浓度的公式：\n$$\nC_{\\text{min,ss}} = \\frac{D}{V} \\cdot \\frac{e^{-k\\tau}}{1 - e^{-k\\tau}}\n$$\n该公式是按要求从第一性原理推导出来的。\n\n**2. 建模个体间变异 (IIV)**\n\n问题指定了清除率 ($CL$) 的对数正态变异。对于个体 $i$，其清除率 $CL_i$ 由下式给出：\n$$\nCL_i = CL_{typ} \\exp(\\eta_i)\n$$\n其中 $CL_{typ}$ 是群体中的典型（几何平均）清除率，$\\eta_i$ 是从均值为 $0$、方差为 $\\omega^2$ 的正态分布中抽取的随机变量，即 $\\eta_i \\sim N(0, \\omega^2)$。\n\n我们必须根据自然标度上给定的清除率变异系数 (CV)（记为 $\\omega_{CL}$）来校准参数 $\\omega$。对于一个对数正态分布变量 $X = \\exp(Y)$，其中 $Y \\sim N(\\mu, \\sigma^2)$，其变异系数的平方 (CV²) 与方差 $\\sigma^2$ 的关系如下：\n$$\nCV^2 = \\frac{\\text{Var}(X)}{(E[X])^2} = \\exp(\\sigma^2) - 1\n$$\n在本例中，$X$ 是 $CL_i$，$\\ln(CL_i) = \\ln(CL_{typ}) + \\eta_i$，因此 $\\ln(CL_i)$ 服从均值为 $\\mu = \\ln(CL_{typ})$、方差为 $\\sigma^2 = \\omega^2$ 的正态分布。我们已知 $CV = \\omega_{CL}$。因此：\n$$\n\\omega_{CL}^2 = \\exp(\\omega^2) - 1\n$$\n解出 $\\omega^2$，我们得到 $\\omega^2 = \\ln(\\omega_{CL}^2 + 1)$。因此，用于生成 $\\eta_i$ 值的标准差 $\\omega$ 为：\n$$\n\\omega = \\sqrt{\\ln(\\omega_{CL}^2 + 1)}\n$$\n如果 $\\omega_{CL} = 0$，则 $\\omega=0$，表示没有变异。所有个体的分布容积 $V$ 固定为其典型值 $V_{typ}$。\n\n**3. 仿真算法**\n\n对于每个测试用例，我们执行以下步骤：\n1.  **初始化**：将随机数生成器种子设置为 $20231111$ 以确保可复现性。\n2.  **参数**：提取当前测试用例的参数：$CL_{typ}$、$V_{typ}$、$\\omega_{CL}$、$D$、$\\tau$、$N$ 和 $C_{\\text{min,target}}$。\n3.  **变异设置**：为对数空间的变异性计算标准差 $\\omega = \\sqrt{\\ln(\\omega_{CL}^2 + 1)}$。如果 $\\omega_{CL}=0$，则 $\\omega=0$。\n4.  **生成队列**：\n    a. 从分布 $N(0, \\omega^2)$ 中生成 $N$ 个随机变量值 $\\eta_i$。\n    b. 对于每个 $\\eta_i$，计算个体的清除率：$CL_i = CL_{typ} \\exp(\\eta_i)$。\n5.  **计算个体PK**：对于 $N$ 个个体中的每一个：\n    a. 计算个体的消除速率常数：$k_i = CL_i / V_{typ}$。\n    b. 使用推导出的公式计算个体的稳态谷浓度：\n       $$\n       C_{\\text{min,ss},i} = \\frac{D}{V_{typ}} \\cdot \\frac{e^{-k_i \\tau}}{1 - e^{-k_i \\tau}}\n       $$\n6.  **估计比例**：统计 $C_{\\text{min,ss},i}  C_{\\text{min,target}}$ 的个体数量。所需的比例是该计数除以总个体数 $N$。\n7.  **格式化输出**：将最终比例四舍五入到 $6$ 位小数。\n\n对问题陈述中提供的四个测试用例均执行此程序。在实现中使用向量化将确保计算的高效性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates steady-state trough concentrations for a virtual cohort based on\n    a one-compartment PK model and estimates the proportion of individuals\n    below a target concentration.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"CL_typ\": 6.0, \"V_typ\": 60.0, \"omega_CL\": 0.30, \n            \"D\": 100.0, \"tau\": 12.0, \"N\": 100000, \"C_min_target\": 2.0\n        },\n        {\n            \"CL_typ\": 6.0, \"V_typ\": 60.0, \"omega_CL\": 0.00, \n            \"D\": 100.0, \"tau\": 12.0, \"N\": 1000, \"C_min_target\": 2.0\n        },\n        {\n            \"CL_typ\": 6.0, \"V_typ\": 60.0, \"omega_CL\": 0.30, \n            \"D\": 500.0, \"tau\": 12.0, \"N\": 100000, \"C_min_target\": 2.0\n        },\n        {\n            \"CL_typ\": 3.0, \"V_typ\": 60.0, \"omega_CL\": 0.30, \n            \"D\": 100.0, \"tau\": 24.0, \"N\": 100000, \"C_min_target\": 2.0\n        },\n    ]\n\n    # Initialize the random number generator with a fixed seed for reproducibility.\n    # The generator is initialized once to ensure the sequence of random numbers\n    # is a single stream across all test cases that require it.\n    rng = np.random.default_rng(seed=20231111)\n\n    results = []\n    \n    for params in test_cases:\n        # Extract parameters for the current test case.\n        CL_typ = params[\"CL_typ\"]\n        V_typ = params[\"V_typ\"]\n        omega_CL = params[\"omega_CL\"]\n        D = params[\"D\"]\n        tau = params[\"tau\"]\n        N = params[\"N\"]\n        C_min_target = params[\"C_min_target\"]\n        F = 1.0  # Bioavailability is fixed at 1.\n\n        # Generate a cohort of N individuals with variability on clearance.\n        if omega_CL > 0.0:\n            # Calibrate omega (std. dev. in log space) from the given\n            # coefficient of variation (omega_CL) in natural space.\n            # The relationship is omega^2 = ln(CV^2 + 1).\n            omega = np.sqrt(np.log(omega_CL**2 + 1))\n            \n            # Generate random effects for N individuals from N(0, omega^2).\n            eta_i = rng.normal(loc=0.0, scale=omega, size=N)\n            \n            # Calculate individual clearance values based on the log-normal model.\n            CL_i = CL_typ * np.exp(eta_i)\n        else:\n            # For the zero variability case, all individuals have the typical clearance.\n            CL_i = np.full(N, CL_typ)\n\n        # Calculate individual elimination rate constants (k = CL/V).\n        k_i = CL_i / V_typ\n\n        # Calculate steady-state trough concentration (Cmin,ss) for each individual.\n        # Formula: Cmin_ss = (D*F/V) * exp(-k*tau) / (1 - exp(-k*tau))\n        # Since F=1, we use D directly.\n        exp_term = np.exp(-k_i * tau)\n        C_min_ss_i = (D / V_typ) * exp_term / (1 - exp_term)\n\n        # Estimate the proportion of individuals with Cmin,ss below the target.\n        proportion = np.sum(C_min_ss_i  C_min_target) / N\n        \n        # Append the formatted result to the list.\n        # The f-string format specifier .6f handles rounding to 6 decimal places.\n        results.append(f\"{proportion:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}