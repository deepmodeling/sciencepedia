{
    "hands_on_practices": [
        {
            "introduction": "理解靶标介导的药物处置（TMDD）的第一步是量化药物与其靶标之间的相互作用。这个练习  侧重于使用基本的朗缪尔等温线模型来计算关键指标——靶标占有率。通过这个练习，您将掌握药物浓度和结合亲和力（以解离常数 $K_D$ 表示）如何共同决定靶标参与的程度，并理解结合限制与饱和状态之间的区别。",
            "id": "4595274",
            "problem": "在靶介导的药物处置 (TMDD) 条件下，治疗性配体与其药理学靶点之间的单位点结合相互作用可以用平衡反应 $D + R \\rightleftharpoons DR$ 来描述，其中 $D$ 是游离药物浓度，$R$ 是游离受体浓度，$DR$ 是药物-受体复合物浓度。该平衡受质量作用定律的支配，其结合速率常数为 $k_{\\text{on}}$，解离速率常数为 $k_{\\text{off}}$，解离常数 $K_D$ 定义为 $K_D = k_{\\text{off}}/k_{\\text{on}}$。总受体浓度满足守恒关系 $R_{\\text{tot}} = R + DR$。假设受体位点是均一且不相互作用的群体，结合方式为一对一，并且系统已达到平衡，靶点结合没有引起游离药物的显著耗尽，这与朗缪尔等温线描述一致。\n\n在一个处于药代动力学稳态的血浆样本中，测得的游离药物浓度为 $D = 8.0$ nM，解离常数为 $K_D = 1.25$ nM。仅使用第一性原理（质量作用定律和化学计量守恒）和这些测量值，推导出靶点占据分数 $DR/R_{\\text{tot}}$，然后根据给定的数值进行计算。将最终的占据率表示为无量纲的小数，并将答案四舍五入到四位有效数字。\n\n在你的推理中，解释占据率对 $D$ 和 $K_D$ 的函数依赖关系如何揭示一个给药方案是处于与靶介导的药物处置 (TMDD) 相关的结合限制区还是饱和区。你最终提交的答案必须只包含占据率的数值。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 平衡反应：$D + R \\rightleftharpoons DR$，其中 $D$ 是游离药物浓度，$R$ 是游离受体浓度，$DR$ 是药物-受体复合物浓度。\n- 质量作用定律支配该平衡，结合速率常数为 $k_{\\text{on}}$，解离速率常数为 $k_{\\text{off}}$。\n- 解离常数定义：$K_D = \\frac{k_{\\text{off}}}{k_{\\text{on}}}$。\n- 总受体守恒：$R_{\\text{tot}} = R + DR$。\n- 假设：均一的非相互作用受体位点，一对一结合，系统处于平衡状态，靶点结合不引起游离药物的显著耗尽（朗缪尔等温线条件）。\n- 测量的游离药物浓度：$D = 8.0$ nM。\n- 解离常数：$K_D = 1.25$ nM。\n- 目标：推导并计算靶点占据分数 $\\frac{DR}{R_{\\text{tot}}}$。\n- 最终答案要求格式：四舍五入到四位有效数字的无量纲小数。\n- 附加任务：解释占据率对 $D$ 和 $K_D$ 的函数依赖关系，及其与靶介导药物处置 (TMDD) 中的结合限制区和饱和区的关系。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于化学平衡、质量作用定律和受体理论的基本原理，这些都是药理学的核心。TMDD 的概念及其与受体占据和饱和的关系是科学上合理且公认的。\n- **适定性：** 该问题提供了推导和计算靶点占据率所需的所有必要数据（$D$ 和 $K_D$）和定义（$K_D$ 和 $R_{\\text{tot}}$）。所做的假设，特别是朗缪尔等温线假设，适当地简化了系统，确保了唯一解的存在。\n- **客观性：** 问题的陈述语言精确、定量且无偏见。\n- **完整性和一致性：** 该问题是自洽的且内部一致。各项假设是兼容的，并为标准推导指明了路径。\n- **现实性：** 给定的药物浓度（$8.0$ nM）和解离常数（$1.25$ nM）值在生物治疗药物的实际范围内。\n- **其他标准：** 该问题不是不适定的、琐碎的或无法验证的。\n\n### 步骤 3：结论与行动\n问题有效。将提供详细的解答。\n\n### 推导与求解\n\n目标是使用第一性原理推导靶点占据分数（定义为 $\\frac{DR}{R_{\\text{tot}}}$）的表达式。出发点是将质量作用定律应用于稳态下的结合平衡。\n\n平衡反应由下式给出：\n$$D + R \\rightleftharpoons DR$$\n在平衡状态下，结合速率（$k_{\\text{on}}[D][R]$）等于解离速率（$k_{\\text{off}}[DR]$），其中方括号表示浓度。为简化起见，我们直接使用问题陈述中指定的符号。\n$$k_{\\text{on}} D R = k_{\\text{off}} DR$$\n解离常数 $K_D$ 定义为解离速率常数与结合速率常数的比值，即 $K_D = \\frac{k_{\\text{off}}}{k_{\\text{on}}}$。整理平衡方程，我们得到：\n$$K_D = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{D R}{DR}$$\n该方程给出了游离药物、游离受体和药物-受体复合物浓度之间的关系。我们的目标是表示占据分数 $\\frac{DR}{R_{\\text{tot}}}$。为此，我们必须利用总受体的守恒关系，从方程中消去游离受体浓度 $R$。\n\n总受体浓度 $R_{\\text{tot}}$ 是游离受体和结合受体的总和：\n$$R_{\\text{tot}} = R + DR$$\n这可以重新整理，以总浓度和结合浓度来表示游离受体浓度：\n$$R = R_{\\text{tot}} - DR$$\n现在，我们将这个 $R$ 的表达式代入从质量作用定律导出的平衡方程中：\n$$K_D = \\frac{D (R_{\\text{tot}} - DR)}{DR}$$\n下一步是通过代数变换重新整理此方程，以求解比率 $\\frac{DR}{R_{\\text{tot}}}$。\n$$K_D (DR) = D (R_{\\text{tot}} - DR)$$\n$$K_D (DR) = D R_{\\text{tot}} - D (DR)$$\n为了将包含 $DR$ 的项归类，我们将 $D(DR)$ 加到等式两边：\n$$K_D (DR) + D (DR) = D R_{\\text{tot}}$$\n在等式左边提出公因子 $DR$：\n$$(DR)(K_D + D) = D R_{\\text{tot}}$$\n最后，为了得到靶点占据分数，我们将等式两边同时除以 $R_{\\text{tot}}$ 和 $(K_D + D)$：\n$$\\frac{DR}{R_{\\text{tot}}} = \\frac{D}{K_D + D}$$\n这就是所求的靶点占据率表达式。对于一个 Hill 系数为 $1$ 的系统，这种函数形式被称为 Hill-Langmuir 方程。\n\n现在，我们使用给定的数值来计算这个表达式：\n- 游离药物浓度，$D = 8.0$ nM。\n- 解离常数，$K_D = 1.25$ nM。\n\n将这些值代入推导出的公式中：\n$$\\frac{DR}{R_{\\text{tot}}} = \\frac{8.0}{1.25 + 8.0}$$\n$$\\frac{DR}{R_{\\text{tot}}} = \\frac{8.0}{9.25}$$\n$$\\frac{DR}{R_{\\text{tot}}} \\approx 0.86486486...$$\n题目要求答案四舍五入到四位有效数字。因此，靶点占据率为 $0.8649$。\n\n### TMDD 区域的讨论\n推导出的关系式 “占据率 = $\\frac{D}{K_D + D}$” 对于理解表现出靶介导药物处置 (TMDD) 的药物行为至关重要。根据药物浓度 $D$ 和解离常数 $K_D$ 之间的关系，系统行为可以分为不同的区域。\n\n1.  **结合限制区 ($D \\ll K_D$)**：当游离药物浓度远低于 $K_D$ 时，分母 $(K_D + D)$ 可以近似为 $K_D$。占据率方程简化为：\n    $$\\frac{DR}{R_{\\text{tot}}} \\approx \\frac{D}{K_D}$$\n    在此区域，靶点占据率与药物浓度近似成线性关系。系统远未达到饱和。通过靶点结合的药物清除是显著的，并且高度依赖于浓度，这通常导致明显的非线性药代动力学。药物的消除受限于药物与可用受体结合的速率。\n\n2.  **饱和区 ($D \\gg K_D$)**：当游离药物浓度远高于 $K_D$ 时，分母 $(K_D + D)$ 可以近似为 $D$。占据率方程简化为：\n    $$\\frac{DR}{R_{\\text{tot}}} \\approx \\frac{D}{D} = 1$$\n    在此区域，靶点占据率接近其最大值 $1$ (或 $100\\%$)。受体已饱和。药物浓度的进一步增加不会显著提高占据率。因此，靶介导的清除途径也已饱和，并以其最大速率运行。由于清除过程主要由非饱和途径（例如，肾脏或肝脏清除）主导，药物的整体药代动力学趋于线性。\n\n3.  **过渡区 ($D \\approx K_D$)**：当药物浓度与 $K_D$ 在同一数量级时，必须使用完整的非线性方程。在 $D = K_D$ 的特定浓度下，占据率恰好为 $0.5$ 或 $50\\%$。系统正处于结合限制状态和饱和状态之间的过渡阶段。\n\n在本问题的背景下，$D = 8.0$ nM 且 $K_D = 1.25$ nM，我们有 $D = 6.4 \\times K_D$。由于 $D$ 显著大于 $K_D$，系统运行在近饱和区，这由计算出的约 $86.5\\%$ 的高占据率所反映。",
            "answer": "$$\\boxed{0.8649}$$"
        },
        {
            "introduction": "在静态占有率概念的基础上，这个实践  进入了一个更贴近临床的场景：如何长时间维持治疗效果。该练习要求您设计一个恒速输注方案，以达到特定的稳态靶标占有率。这促使我们将药物输入（输注）、线性清除以及TMDD特有的非线性、可饱和清除途径整合起来进行考量。",
            "id": "4595253",
            "problem": "一种单克隆抗体在单室系统中通过静脉恒速输注表现出靶标介导的药物处置 (TMDD) 特性。该药物与膜靶标结合，其结合速率常数为 $k_{\\text{on}}$，解离速率常数为 $k_{\\text{off}}$，药物-靶标复合物的内化速率常数为 $k_{\\text{int}}$。可及的总靶标浓度为 $R_{\\text{tot}}$，游离药物浓度为 $D$。系统容积为 $V$，药物经历线性系统清除，其清除率为 $CL$。假设输注和消除处于稳态，并对结合与复合物周转采用准稳态 (QSS) 机制。\n\n使用以下参数值：\n- $R_{\\text{tot}} = 10\\,\\text{nM}$，\n- $K_{\\text{ss}} = 2.1\\,\\text{nM}$ (准稳态常数)，\n- $k_{\\text{int}} = 0.1\\,\\text{h}^{-1}$，\n- $CL = 0.8\\,\\text{L}\\,\\text{h}^{-1}$，\n- $V = 5\\,\\text{L}$。\n\n给定恒定输注速率 $R_{0} = 100\\,\\text{nmol}\\,\\text{h}^{-1}$。\n\n仅从基本质量平衡原理和 QSS 前提（不使用任何预先给定的占有率或结合代数捷径）出发，(i) 推导在恒速输注下，同时考虑线性清除和靶标介导的内化作用时，游离药物浓度 $D$ 的稳态方程，然后计算与 $R_{0}$ 对应的稳态分数占有率 $\\theta \\equiv \\frac{DR}{R_{\\text{tot}}}$。接下来，(ii) 确定在稳态下达到目标占有率阈值 $\\theta^{\\ast} = 0.90$ 所需的输注速率 $R_{0}$。\n\n在最终答案中报告两个量：\n- 给定 $R_{0} = 100\\,\\text{nmol}\\,\\text{h}^{-1}$ 时的稳态分数占有率（以小数形式表示，而非百分比），\n- 达到 $\\theta^{\\ast} = 0.90$ 所需的输注速率（单位为 $\\text{nmol}\\,\\text{h}^{-1}$）。\n\n将两个量均四舍五入至四位有效数字。",
            "solution": "该问题经评估为有效，因为它在科学上基于临床药理学原理，特别是靶标介导的药物处置 (TMDD)；问题陈述清晰，信息充分，并以客观、正式的语言表述。我们开始求解。\n\n问题要求从基本原理进行推导。我们首先定义各种物质并写出它们的质量平衡方程。设 $D$ 为容积为 $V$ 的中央室中的游离药物浓度，$[R]$ 为游离靶标浓度，$[DR]$ 为药物-靶标复合物的浓度。总靶标浓度是恒定的，$R_{\\text{tot}} = [R] + [DR]$。\n\n系统动力学由以下过程描述：\n1.  药物以速率 $R_0$ 恒速输注。\n2.  游离药物的线性系统清除，清除率为 $CL$。\n3.  药物与其靶标的可逆结合，结合速率常数为 $k_{\\text{on}}$，解离速率常数为 $k_{\\text{off}}$。\n4.  药物-靶标复合物的不可逆内化（及后续消除），速率常数为 $k_{\\text{int}}$。\n\n中央室中游离药物量的变化率由以下质量平衡给出：\n$$ V\\frac{dD}{dt} = R_0 - CL \\cdot D - V \\left( k_{\\text{on}} D [R] - k_{\\text{off}} [DR] \\right) $$\n右侧第一项是输注速率。第二项是线性消除速率。第三项是药物与靶标结合的净速率，此过程消耗游离药物。\n\n药物-靶标复合物浓度的变化率为：\n$$ \\frac{d[DR]}{dt} = k_{\\text{on}} D [R] - k_{\\text{off}} [DR] - k_{\\text{int}} [DR] $$\n$$ \\frac{d[DR]}{dt} = k_{\\text{on}} D (R_{\\text{tot}} - [DR]) - (k_{\\text{off}} + k_{\\text{int}}) [DR] $$\n\n问题指明对结合与复合物周转采用准稳态 (QSS) 近似。这意味着复合物浓度的调整速度远快于游离药物浓度，因此我们可以令 $\\frac{d[DR]}{dt} \\approx 0$：\n$$ k_{\\text{on}} D (R_{\\text{tot}} - [DR]) = (k_{\\text{off}} + k_{\\text{int}}) [DR] $$\n求解 $[DR]$：\n$$ k_{\\text{on}} D R_{\\text{tot}} = (k_{\\text{on}} D + k_{\\text{off}} + k_{\\text{int}}) [DR] $$\n$$ [DR] = \\frac{k_{\\text{on}} D R_{\\text{tot}}}{k_{\\text{on}} D + k_{\\text{off}} + k_{\\text{int}}} $$\n分子和分母同除以 $k_{\\text{on}}$ 得：\n$$ [DR] = \\frac{D R_{\\text{tot}}}{D + \\frac{k_{\\text{off}} + k_{\\text{int}}}{k_{\\text{on}}}} $$\n问题定义了准稳态常数 $K_{\\text{ss}} = \\frac{k_{\\text{off}} + k_{\\text{int}}}{k_{\\text{on}}}$。代入此定义，我们得到复合物浓度的 QSS 表达式：\n$$ [DR] = \\frac{R_{\\text{tot}} D}{K_{\\text{ss}} + D} $$\n\n系统中的总药物消除通过两条途径发生：游离药物的线性清除和复合物的内化。当输注速率等于总消除速率时，系统达到整体稳态。总消除速率为 $CL \\cdot D + V \\cdot k_{\\text{int}} [DR]$。在稳态下（此时 $\\frac{dD}{dt}=0$ 且所有浓度恒定），令药物输入速率等于药物输出速率，我们有：\n$$ R_0 = CL \\cdot D_{ss} + V \\cdot k_{\\text{int}} [DR]_{ss} $$\n其中下标 $ss$ 表示稳态。代入 $[DR]_{ss}$ 的 QSS 表达式：\n$$ R_0 = CL \\cdot D_{ss} + V \\cdot k_{\\text{int}} \\left( \\frac{R_{\\text{tot}} D_{ss}}{K_{\\text{ss}} + D_{ss}} \\right) $$\n这就是推导出的、同时考虑了线性和靶标介导的清除途径的游离药物浓度 $D_{ss}$ 的稳态方程。为简化起见，我们省略下标 $ss$。\n\n(i) 计算当 $R_0 = 100\\,\\text{nmol}\\,\\text{h}^{-1}$ 时的稳态分数占有率 $\\theta$。\n首先，我们必须求解 $D$ 的稳态方程。我们将其整理成关于 $D$ 的一元二次方程：\n$$ R_0 (K_{\\text{ss}} + D) = CL \\cdot D(K_{\\text{ss}} + D) + V \\cdot k_{\\text{int}} R_{\\text{tot}} D $$\n$$ R_0 K_{\\text{ss}} + R_0 D = CL \\cdot K_{\\text{ss}} D + CL \\cdot D^2 + V k_{\\text{int}} R_{\\text{tot}} D $$\n$$ (CL) D^2 + (CL \\cdot K_{\\text{ss}} + V k_{\\text{int}} R_{\\text{tot}} - R_0) D - R_0 K_{\\text{ss}} = 0 $$\n我们代入给定的参数值：\n$R_{\\text{tot}} = 10\\,\\text{nM}$\n$K_{\\text{ss}} = 2.1\\,\\text{nM}$\n$k_{\\text{int}} = 0.1\\,\\text{h}^{-1}$\n$CL = 0.8\\,\\text{L}\\,\\text{h}^{-1}$\n$V = 5\\,\\text{L}$\n$R_0 = 100\\,\\text{nmol}\\,\\text{h}^{-1}$\n\n一元二次方程 $aD^2 + bD + c = 0$ 的系数为：\n$a = CL = 0.8$\n$b = CL \\cdot K_{\\text{ss}} + V k_{\\text{int}} R_{\\text{tot}} - R_0 = (0.8)(2.1) + (5)(0.1)(10) - 100 = 1.68 + 5 - 100 = -93.32$\n$c = -R_0 K_{\\text{ss}} = -(100)(2.1) = -210$\n\n方程为 $0.8 D^2 - 93.32 D - 210 = 0$。使用求根公式 $D = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 并选择浓度为正值的根：\n$$ D = \\frac{93.32 + \\sqrt{(-93.32)^2 - 4(0.8)(-210)}}{2(0.8)} $$\n$$ D = \\frac{93.32 + \\sqrt{8708.6224 + 672}}{1.6} $$\n$$ D = \\frac{93.32 + \\sqrt{9380.6224}}{1.6} \\approx \\frac{93.32 + 96.8536}{1.6} \\approx \\frac{190.1736}{1.6} \\approx 118.8585\\,\\text{nM} $$\n\n分数占有率 $\\theta$ 定义为已占靶标与总靶标之比，即 $\\theta = \\frac{[DR]}{R_{\\text{tot}}}$。使用我们得到的 $[DR]$ 的 QSS 表达式：\n$$ \\theta = \\frac{1}{R_{\\text{tot}}} \\left( \\frac{R_{\\text{tot}} D}{K_{\\text{ss}} + D} \\right) = \\frac{D}{K_{\\text{ss}} + D} $$\n代入计算出的 $D$ 值和给定的 $K_{\\text{ss}}$：\n$$ \\theta = \\frac{118.8585}{2.1 + 118.8585} = \\frac{118.8585}{120.9585} \\approx 0.982637 $$\n四舍五入至四位有效数字，分数占有率为 $\\theta \\approx 0.9826$。\n\n(ii) 确定达到 $\\theta^* = 0.90$ 所需的输注速率 $R_0$。\n首先，我们找出对应于 $\\theta^* = 0.90$ 所需的稳态游离药物浓度 $D^*$。\n$$ \\theta^* = \\frac{D^*}{K_{\\text{ss}} + D^*} \\implies 0.90 = \\frac{D^*}{2.1 + D^*} $$\n$$ 0.90(2.1 + D^*) = D^* $$\n$$ 1.89 + 0.90 D^* = D^* $$\n$$ 0.10 D^* = 1.89 \\implies D^* = 18.9\\,\\text{nM} $$\n现在我们使用稳态方程来计算所需的输注速率 $R_0$：\n$$ R_0 = CL \\cdot D^* + V \\cdot k_{\\text{int}} \\left( \\frac{R_{\\text{tot}} D^*}{K_{\\text{ss}} + D^*} \\right) $$\n括号中的项可以使用占有率的定义进行简化：$\\frac{R_{\\text{tot}} D^*}{K_{\\text{ss}} + D^*} = R_{\\text{tot}} \\theta^*$。\n$$ R_0 = CL \\cdot D^* + V \\cdot k_{\\text{int}} \\cdot R_{\\text{tot}} \\cdot \\theta^* $$\n代入数值：\n$$ R_0 = (0.8\\,\\text{L}\\,\\text{h}^{-1})(18.9\\,\\text{nmol}\\,\\text{L}^{-1}) + (5\\,\\text{L})(0.1\\,\\text{h}^{-1})(10\\,\\text{nmol}\\,\\text{L}^{-1})(0.90) $$\n$$ R_0 = 15.12\\,\\text{nmol}\\,\\text{h}^{-1} + 4.5\\,\\text{nmol}\\,\\text{h}^{-1} $$\n$$ R_0 = 19.62\\,\\text{nmol}\\,\\text{h}^{-1} $$\n四舍五入至四位有效数字不改变此值，因此所需的输注速率为 $19.62\\,\\text{nmol}\\,\\text{h}^{-1}$。\n\n需要报告的两个量是给定 $R_0$ 时的分数占有率和达到目标占有率所需的 $R_0$。\n- 分数占有率：$0.9826$\n- 所需输注速率：$19.62\\,\\text{nmol}\\,\\text{h}^{-1}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 0.9826  19.62 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然稳态分析很有用，但药物和生物标志物的水平在体内很少是静止不变的。这个高级实践  引入了计算模拟，旨在探索TMDD及其药效学后果的完整动态过程。通过数值求解微分方程组，我们可以将药物处置、靶标结合和最终的生物学反应之间的动态相互作用可视化，从而获得比静态模型更深刻、更丰富的理解。",
            "id": "4595251",
            "problem": "考虑一个药理学系统，其中治疗药物遵循靶介导的药物处置 (TMDD) 模式与生物靶点相互作用。药物通过质量作用动力学与靶点结合，下游的生物标志物根据由靶点占有率驱动的间接响应模型受到抑制。请构建并模拟以下耦合常微分方程 (ODE) 系统，以计算生物标志物抑制的时间进程。\n\n使用质量作用结合、线性消除、受体合成与降解以及生物标志物间接响应的基本假设。令 $D$ 表示游离药物浓度，$R$ 表示游离靶点浓度，$DR$ 表示药物-靶点复合物浓度，$B$ 表示生物标志物浓度。时间用 $t$ 表示。所有浓度单位为纳摩尔 (nM)，时间单位为小时 (h)。模型如下：\n\n$$\\frac{dD}{dt} = -k_{\\text{el}} D - k_{\\text{on}} D R + k_{\\text{off}} DR,$$\n$$\\frac{dR}{dt} = k_{\\text{syn}} - k_{\\text{deg}} R - k_{\\text{on}} D R + k_{\\text{off}} DR,$$\n$$\\frac{dDR}{dt} = k_{\\text{on}} D R - (k_{\\text{off}} + k_{\\text{int}}) DR,$$\n$$\\frac{dB}{dt} = k_{\\text{in}} \\left(1 - \\eta \\, \\theta \\right) - k_{\\text{out}} B,$$\n\n其中，$k_{\\text{on}}$ 是结合速率常数，单位为 $\\text{(nM)}^{-1}\\text{h}^{-1}$；$k_{\\text{off}}$ 是解离速率常数，单位为 $\\text{h}^{-1}$；$k_{\\text{int}}$ 是复合物的内化速率常数，单位为 $\\text{h}^{-1}$；$k_{\\text{el}}$ 是药物线性消除速率常数，单位为 $\\text{h}^{-1}$；$k_{\\text{syn}}$ 是靶点合成速率，单位为 $\\text{nM}\\,\\text{h}^{-1}$；$k_{\\text{deg}}$ 是靶点降解速率，单位为 $\\text{h}^{-1}$；$k_{\\text{in}}$ 是生物标志物零级生成速率，单位为 $\\text{nM}\\,\\text{h}^{-1}$；$k_{\\text{out}}$ 是生物标志物一级损失速率，单位为 $\\text{h}^{-1}$；$\\eta$ 是一个介于 $0$ 和 $1$ 之间的无单位效能参数。靶点占有率定义为与药物结合的总靶点分数：\n$$\\theta(t) = \\frac{DR(t)}{R(t) + DR(t)}.$$\n\n初始条件反映了给药前的稳态基线和静脉推注剂量：\n$$D(0) = D_0,$$\n$$R(0) = \\frac{k_{\\text{syn}}}{k_{\\text{deg}}},$$\n$$DR(0) = 0,$$\n$$B(0) = \\frac{k_{\\text{in}}}{k_{\\text{out}}}.$$\n\n您的任务是针对一组参数案例，在指定的时间范围内对 ODE 进行数值积分，计算生物标志物抑制比 $B(t)/B(0)$ 随时间的变化，然后为每个案例输出两个指标：\n- 模拟时间窗内的最小抑制比 $\\min_t \\left(B(t)/B(0)\\right)$，以小数形式表示。\n- 最低点时间，定义为 $B(t)/B(0)$ 达到其最小值时的时间 $t$（单位为 h）。\n\n每个案例的两个输出都必须四舍五入到四位小数。如果在数值精度范围内，多个时间点达到完全相同的最小值，则返回最早的时间。在计算 $\\theta(t)$ 时，请使用数值稳定的实现方式以避免除以零。\n\n模拟以下测试套件。在所有案例中，时间以小时为单位，浓度以纳摩尔为单位。速率常数的单位与上述定义一致。\n\n案例 1（一般情景）：\n- $k_{\\text{on}} = 0.05$,\n- $k_{\\text{off}} = 0.5$,\n- $k_{\\text{int}} = 0.1$,\n- $k_{\\text{el}} = 0.2$,\n- $k_{\\text{syn}} = 1$,\n- $k_{\\text{deg}} = 0.05$,\n- $D_0 = 100$,\n- $k_{\\text{in}} = 1$,\n- $k_{\\text{out}} = 0.1$,\n- $\\eta = 0.8$,\n- 模拟时间从 $t = 0$ 到 $t = 72$。\n\n案例 2（高亲和力及更高靶点表达）：\n- $k_{\\text{on}} = 0.1$,\n- $k_{\\text{off}} = 0.05$,\n- $k_{\\text{int}} = 0.2$,\n- $k_{\\text{el}} = 0.1$,\n- $k_{\\text{syn}} = 5$,\n- $k_{\\text{deg}} = 0.1$,\n- $D_0 = 30$,\n- $k_{\\text{in}} = 2$,\n- $k_{\\text{out}} = 0.2$,\n- $\\eta = 0.5$,\n- 模拟时间从 $t = 0$ 到 $t = 72$。\n\n案例 3（边界情况：无药效学效应）：\n- $k_{\\text{on}} = 0.05$,\n- $k_{\\text{off}} = 0.5$,\n- $k_{\\text{int}} = 0.1$,\n- $k_{\\text{el}} = 0.2$,\n- $k_{\\text{syn}} = 1$,\n- $k_{\\text{deg}} = 0.05$,\n- $D_0 = 100$,\n- $k_{\\text{in}} = 1$,\n- $k_{\\text{out}} = 0.1$,\n- $\\eta = 0$,\n- 模拟时间从 $t = 0$ 到 $t = 72$。\n\n案例 4（边缘情况：生物标志物快速周转及高剂量）：\n- $k_{\\text{on}} = 0.02$,\n- $k_{\\text{off}} = 0.2$,\n- $k_{\\text{int}} = 0.1$,\n- $k_{\\text{el}} = 0.3$,\n- $k_{\\text{syn}} = 1$,\n- $k_{\\text{deg}} = 0.1$,\n- $D_0 = 200$,\n- $k_{\\text{in}} = 10$,\n- $k_{\\text{out}} = 1$,\n- $\\eta = 1$,\n- 模拟时间从 $t = 0$ 到 $t = 72$。\n\n您的程序必须为每个案例数值积分 ODE 系统，计算最小抑制比和相应的最低点时间，将两者都四舍五入到四位小数，并汇总所有四个案例的结果。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素都是一个形式为 $[\\min(B/B_0), t_{\\text{nadir}}]$ 的双项列表。例如，一个有效的输出形状是 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，其中每个 $x_i$ 和 $y_i$ 都是四位小数的浮点数。",
            "solution": "该问题要求对描述靶介导的药物处置 (TMDD) 及后续生物标志物响应的耦合常微分方程 (ODE) 系统进行数值模拟。解决方案涉及在指定的时间范围内对这些方程进行积分，并分析所得的生物标志物浓度轨迹，以提取关键的药效学指标。\n\n### 1. 问题验证\n所提供的问题陈述已经过严格验证，并被认为是**有效的**。\n- **科学依据**：该模型基于临床药理学的既定原则，即药物-靶点结合的质量作用动力学和生物标志物动态的间接响应模型。这些都是标准的、广为接受的框架。\n- **适定性**：该问题被表述为一个一阶 ODE 系统的初值问题。定义导数的函数是连续且局部利普希茨的，这保证了给定初始条件下局部解的存在性和唯一性。所有必要的参数和初始条件都已提供，使得问题自洽且可解。\n- **客观性与清晰度**：问题使用精确、无歧义的科学语言进行陈述。所有变量、参数和目标都得到了清晰的定义。\n\n该问题是计算系统药理学中一个标准的、有一定难度的练习。\n\n### 2. 理论框架\n\n该系统由一组四个耦合的 ODE 描述，分别对应游离药物 ($D$)、游离靶点 ($R$)、药物-靶点复合物 ($DR$) 和生物标志物 ($B$) 的浓度。\n\n1.  **药物动力学**：游离药物浓度 $D$ 的方程为：\n    $$\n    \\frac{dD}{dt} = -k_{\\text{el}} D - k_{\\text{on}} D R + k_{\\text{off}} DR\n    $$\n    该方程考虑了三个过程：从系统中线性消除 ($-k_{\\text{el}} D$)、与靶点结合形成复合物 ($-k_{\\text{on}} D R$)，以及复合物解离变回游离药物和靶点 ($+k_{\\text{off}} DR$)。\n\n2.  **靶点动力学**：游离靶点浓度 $R$ 的方程为：\n    $$\n    \\frac{dR}{dt} = k_{\\text{syn}} - k_{\\text{deg}} R - k_{\\text{on}} D R + k_{\\text{off}} DR\n    $$\n    该方程描述了新靶点蛋白的零级合成 ($k_{\\text{syn}}$)、其一级降解 ($-k_{\\text{deg}} R$)，以及通过与药物的结合和解离所产生的消耗与再生。\n\n3.  **复合物动力学**：药物-靶点复合物浓度 $DR$ 的方程为：\n    $$\n    \\frac{dDR}{dt} = k_{\\text{on}} D R - (k_{\\text{off}} + k_{\\text{int}}) DR\n    $$\n    复合物通过结合形成 ($+k_{\\text{on}} D R$)，并通过两种途径被消除：解离 ($-k_{\\text{off}} DR$) 和内化后降解 ($-k_{\\text{int}} DR$)。后者是一个不可逆过程，会同时从系统中移除药物和靶点。\n\n4.  **生物标志物动力学**：生物标志物浓度 $B$ 的方程遵循一个间接响应模型：\n    $$\n    \\frac{dB}{dt} = k_{\\text{in}} \\left(1 - \\eta \\, \\theta \\right) - k_{\\text{out}} B\n    $$\n    在这里，生物标志物有一个零级生成速率 $k_{\\text{in}}$，该速率受药物效应调节，以及一个一级消除速率 $k_{\\text{out}}$。药物的效应由靶点占有率 $\\theta$ 介导，$\\theta$ 定义为与药物结合的总靶点分数：\n    $$\n    \\theta(t) = \\frac{DR(t)}{R(t) + DR(t)}\n    $$\n    参数 $\\eta$ 表示生物标志物生成所能达到的最大分数抑制，其中 $\\eta=0$ 表示无效应，$\\eta=1$ 表示在完全占有下完全抑制。\n\n### 3. 初始条件\n初始条件的设定反映了在给处于稳态的受试者施用静脉推注剂量 ($D_0$) 后瞬间的系统状态。在给药前 ($t<0$)，$D=0$ 且 $DR=0$。靶点和生物标志物处于其基线稳态水平，这可以通过在无药物存在时将其各自的导数设为零来求得：\n-   由 $\\frac{dR}{dt} = k_{\\text{syn}} - k_{\\text{deg}} R = 0$，我们得到 $R(0) = \\frac{k_{\\text{syn}}}{k_{\\text{deg}}}$。\n-   由 $\\frac{dB}{dt} = k_{\\text{in}} - k_{\\text{out}} B = 0$，我们得到 $B(0) = \\frac{k_{\\text{in}}}{k_{\\text{out}}}$。\n-   初始药物浓度为 $D(0) = D_0$，且尚未形成复合物，所以 $DR(0) = 0$。\n\n### 4. 数值解法策略\n\n该 ODE 系统需通过数值方法求解。这是必要的，因为这个非线性系统通常没有解析解。\n\n1.  **求解器选择**：我们采用 `scipy.integrate` 库中的 `solve_ivp` 函数。TMDD 模型可能表现出“刚性”，这是一种数值属性，即解的各分量在相差悬殊的时间尺度上变化（例如，快速结合与慢速消除）。刚性系统需要专门的隐式求解器来维持稳定性和准确性。因此，选择 `Radau` 或 `BDF` 方法是合适的，因为它们非常适合处理此类问题。\n\n2.  **ODE 系统的实现**：定义一个 Python 函数，用于在给定当前状态向量 $\\mathbf{y} = [D, R, DR, B]$ 和时间 $t$ 的情况下，计算导数向量 $\\frac{d\\mathbf{y}}{dt} = [\\frac{dD}{dt}, \\frac{dR}{dt}, \\frac{dDR}{dt}, \\frac{dB}{dt}]$。对靶点占有率 $\\theta$ 使用数值稳健的实现，以防止除以零，特别是在总靶点浓度 ($R + DR$) 可能接近零的情况下。使用带 `where` 子句的 `numpy.divide` 非常适合此目的。\n\n3.  **模拟与分析**：对每个参数案例：\n    a. 构建初始状态向量 $\\mathbf{y}_0 = [D_0, R(0), DR(0), B(0)]$。\n    b. 使用 `solve_ivp` 并设置 `dense_output=True` 选项，将 ODE 系统从 $t=0$ 积分到 $t=72$ 小时。这提供了一个解的插值函数，允许在积分区间内的任意时间点进行求值。\n    c. 在一个密集的时间点网格（例如 $2000$ 个点）上评估解，以准确捕捉时间进程的形状。\n    d. 计算所有评估时间点的生物标志物抑制比 $B(t)/B(0)$。\n    e. 使用 `numpy.min` 找到该比率的最小值，即最低点抑制。\n    f. 使用 `numpy.argmin` 找到首次出现该最小值的索引，并查找相应的时间，即最低点时间。\n    g. 按要求将所得的最低点抑制和最低点时间四舍五入到四位小数。\n\n4.  **输出格式化**：将所有案例的结果汇总成一个由双元素列表组成的列表。然后将此最终数据结构转换为完全匹配指定格式的字符串，确保标准的列表到字符串转换不会引入多余的空格。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the TMDD-IDR model for four different parameter cases,\n    calculates the nadir biomarker suppression and time to nadir,\n    and prints the formatted results.\n    \"\"\"\n\n    def tmd_idr_model(t, y, params):\n        \"\"\"\n        Defines the system of ordinary differential equations for the TMDD-IDR model.\n\n        Args:\n            t (float): Time.\n            y (list or array): State vector [D, R, DR, B].\n            params (tuple): Model parameters (k_on, k_off, k_int, k_el, k_syn,\n                                k_deg, k_in, k_out, eta).\n\n        Returns:\n            list: The derivatives [dD/dt, dR/dt, dDR/dt, dB/dt].\n        \"\"\"\n        D, R, DR, B = y\n        k_on, k_off, k_int, k_el, k_syn, k_deg, k_in, k_out, eta = params\n\n        # Total target concentration\n        R_total = R + DR\n\n        # Target occupancy theta, with protection against division by zero.\n        # If R_total is 0, occupancy is 0.\n        theta = np.divide(DR, R_total, out=np.zeros_like(DR), where=(R_total != 0))\n\n        # System of ODEs\n        dD_dt = -k_el * D - k_on * D * R + k_off * DR\n        dR_dt = k_syn - k_deg * R - k_on * D * R + k_off * DR\n        dDR_dt = k_on * D * R - (k_off + k_int) * DR\n        dB_dt = k_in * (1.0 - eta * theta) - k_out * B\n\n        return [dD_dt, dR_dt, dDR_dt, dB_dt]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general scenario)\n        {'k_on': 0.05, 'k_off': 0.5, 'k_int': 0.1, 'k_el': 0.2, 'k_syn': 1,\n         'k_deg': 0.05, 'D0': 100, 'k_in': 1, 'k_out': 0.1, 'eta': 0.8, 't_end': 72},\n        # Case 2 (high affinity and higher target expression)\n        {'k_on': 0.1, 'k_off': 0.05, 'k_int': 0.2, 'k_el': 0.1, 'k_syn': 5,\n         'k_deg': 0.1, 'D0': 30, 'k_in': 2, 'k_out': 0.2, 'eta': 0.5, 't_end': 72},\n        # Case 3 (boundary case: no pharmacodynamic effect)\n        {'k_on': 0.05, 'k_off': 0.5, 'k_int': 0.1, 'k_el': 0.2, 'k_syn': 1,\n         'k_deg': 0.05, 'D0': 100, 'k_in': 1, 'k_out': 0.1, 'eta': 0, 't_end': 72},\n        # Case 4 (edge case: fast biomarker turnover and high dose)\n        {'k_on': 0.02, 'k_off': 0.2, 'k_int': 0.1, 'k_el': 0.3, 'k_syn': 1,\n         'k_deg': 0.1, 'D0': 200, 'k_in': 10, 'k_out': 1, 'eta': 1, 't_end': 72},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        k_on = case['k_on']\n        k_off = case['k_off']\n        k_int = case['k_int']\n        k_el = case['k_el']\n        k_syn = case['k_syn']\n        k_deg = case['k_deg']\n        D0 = case['D0']\n        k_in = case['k_in']\n        k_out = case['k_out']\n        eta = case['eta']\n        t_end = case['t_end']\n\n        # Calculate initial conditions based on pre-dose steady state\n        R0 = k_syn / k_deg\n        B0 = k_in / k_out\n        y0 = [D0, R0, 0, B0]\n\n        # Time span for the simulation\n        t_span = (0, t_end)\n        \n        # Package parameters for the solver\n        params_tuple = (k_on, k_off, k_int, k_el, k_syn, k_deg, k_in, k_out, eta)\n\n        # Numerically integrate the ODE system using a stiff solver\n        sol = solve_ivp(\n            tmd_idr_model,\n            t_span,\n            y0,\n            args=(params_tuple,),\n            method='Radau',  # A robust solver for potentially stiff systems\n            dense_output=True\n        )\n\n        # Evaluate the solution on a fine time grid to find the nadir accurately\n        t_eval = np.linspace(t_span[0], t_span[1], 2001)\n        y_eval = sol.sol(t_eval)\n\n        # Extract the biomarker concentration trajectory\n        B_t = y_eval[3]\n\n        # Calculate the biomarker suppression ratio B(t)/B(0)\n        # B0 is guaranteed to be > 0 since k_in > 0 and k_out > 0 in all cases\n        suppression_ratio = B_t / B0\n\n        # Find the minimum suppression ratio (nadir)\n        nadir_suppression = np.min(suppression_ratio)\n\n        # Find the time at which the nadir is first reached\n        nadir_index = np.argmin(suppression_ratio)\n        time_to_nadir = t_eval[nadir_index]\n\n        # Round results to four decimal places\n        rounded_nadir = round(nadir_suppression, 4)\n        rounded_time = round(time_to_nadir, 4)\n\n        all_results.append([rounded_nadir, rounded_time])\n\n    # Format the final output string exactly as specified, without extraneous spaces\n    formatted_pairs = [f'[{res[0]:.4f},{res[1]:.4f}]' for res in all_results]\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}