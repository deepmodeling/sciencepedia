{
    "hands_on_practices": [
        {
            "introduction": "在细胞毒性药物的临床应用中，精确控制药物暴露是平衡疗效与毒性的核心。本练习将指导您从最基本的质量平衡原理出发，构建一个单室线性药代动力学模型。您将推导在连续静脉输注下达到目标稳态血浆浓度（$C_{ss}$）所需输注速率的关键方程，并分析在间歇输注方案中调整输注时长如何影响峰浓度（$C_{max}$），这对于管理与峰浓度相关的毒性至关重要。",
            "id": "4579827",
            "problem": "一名成年患者将接受一种细胞毒性药物，该药物遵循单室模型，具有线性（一级）消除和输注期间的零级输入。该药物治疗指数窄，存在与峰浓度相关的毒性问题。测得患者的全身清除率为 $CL = 4.200 \\ \\mathrm{L \\cdot h^{-1}}$，连续静脉输注下的目标稳态血浆浓度为 $C_{ss,\\mathrm{target}} = 2.700 \\ \\mathrm{mg \\cdot L^{-1}}$。假设分布容积 $V$ 不随时间变化，且等于 $V = 40.0 \\ \\mathrm{L}$。\n\n使用质量平衡第一性原理：\n1) 从描述体内药量的控制微分方程出发，推导在连续输注下达到目标稳态浓度所需的恒定输注速率 $R_{0}$ 的表达式，然后根据所提供的数据计算其数值。答案保留四位有效数字，单位为 $\\mathrm{mg \\cdot h^{-1}}$。\n\n2) 现在考虑一个间歇给药方案，其中在稳态下每 $\\tau$ 小时通过零级输注方式给予一个固定剂量 $D$，输注持续时间为 $T_{\\mathrm{inf}}$。从相同的质量平衡基础出发，推导输注结束时的稳态峰浓度 $C_{\\max,\\mathrm{ss}}$ 作为 $D$, $T_{\\mathrm{inf}}$, $\\tau$, $CL$ 和 $V$ 的函数表达式。使用您的表达式，提供一个简洁的、机理性的解释，说明在保持 $D$, $\\tau$ 和 $CL$ 不变的情况下，改变 $T_{\\mathrm{inf}}$ 如何影响 $C_{\\max,\\mathrm{ss}}$，并明确指出消除速率常数 $k$ 的作用以及控制函数的任何单调性。此部分不计算任何数值。请清楚地说明所有符号的含义。\n\n最终评分仅需要 $R_{0}$ 的数值。",
            "solution": "该问题被评估为有效，因为它在科学上基于已建立的药代动力学原理，问题提法适定，有通向唯一解的清晰路径，并且其语言和参数是客观的。完成指定任务所需的所有数据均已提供，且前提条件一致且符合实际。\n\n在单室模型中，控制体内药量 $A(t)$ 的基本原理是质量平衡方程。药物量的变化速率是药物给药速率（输入速率）与药物消除速率（输出速率）之差：\n$$\n\\frac{dA(t)}{dt} = \\text{输入速率} - \\text{输出速率}\n$$\n输入速率由输注速率决定，我们将其表示为 $R(t)$。消除过程被规定为一级过程，意味着消除速率与当前体内的药量成正比：$\\text{输出速率} = k \\cdot A(t)$，其中 $k$ 是一级消除速率常数。因此，控制微分方程为：\n$$\n\\frac{dA(t)}{dt} = R(t) - k \\cdot A(t)\n$$\n血浆浓度 $C(t)$ 通过分布容积 $V$ 与药量相关，即 $C(t) = A(t)/V$。系统清除率 $CL$ 根据定义 $CL = k \\cdot V$ 与消除速率常数和分布容积相关。由此，我们可以将消除速率常数表示为 $k = \\frac{CL}{V}$。\n\n**第1部分：恒定输注速率 $R_0$ 的推导与计算**\n\n对于连续静脉输注，给药速率是恒定的，即 $R(t) = R_0$。体内药量的微分方程为：\n$$\n\\frac{dA(t)}{dt} = R_0 - k \\cdot A(t)\n$$\n根据定义，在稳态时，体内的药量是恒定的，我们将其表示为 $A_{ss}$。这意味着它对时间的变化率为零：\n$$\n\\frac{dA_{ss}}{dt} = 0\n$$\n将此条件代入微分方程，得到：\n$$\n0 = R_0 - k \\cdot A_{ss}\n$$\n这就得出了基本的稳态关系：输入速率等于输出速率。\n$$\nR_0 = k \\cdot A_{ss}\n$$\n问题指定了目标稳态*浓度* $C_{ss, \\mathrm{target}}$。我们可以用这个浓度来表示稳态药量 $A_{ss}$：$A_{ss} = C_{ss, \\mathrm{target}} \\cdot V$。将其代入 $R_0$ 的方程：\n$$\nR_0 = k \\cdot (C_{ss, \\mathrm{target}} \\cdot V)\n$$\n回顾清除率的定义 $CL = k \\cdot V$，我们可以将其代入 $R_0$ 的表达式中：\n$$\nR_0 = C_{ss, \\mathrm{target}} \\cdot CL\n$$\n这就是达到目标稳态浓度所需的恒定输注速率的推导表达式。\n\n现在，我们使用所提供的数据计算 $R_0$ 的数值：\n全身清除率，$CL = 4.200 \\ \\mathrm{L \\cdot h^{-1}}$。\n目标稳态浓度，$C_{ss, \\mathrm{target}} = 2.700 \\ \\mathrm{mg \\cdot L^{-1}}$。\n\n$$\nR_0 = (2.700 \\ \\mathrm{mg \\cdot L^{-1}}) \\cdot (4.200 \\ \\mathrm{L \\cdot h^{-1}})\n$$\n$$\nR_0 = 11.34 \\ \\mathrm{mg \\cdot h^{-1}}\n$$\n结果 $11.34$ 具有四位有效数字，符合要求。\n\n**第2部分：间歇输注下 $C_{\\max,ss}$ 的推导与分析**\n\n对于间歇给药方案，以 $R' = D/T_{\\mathrm{inf}}$ 的恒定速率，在 $T_{\\mathrm{inf}}$ 的持续时间内通过零级输注给予固定剂量 $D$。此循环每 $\\tau$ 小时重复一次。在稳态下，一个给药间隔 $t \\in [0, \\tau]$ 内的浓度曲线由两个阶段描述。\n\n阶段 I：输注期 ($0 \\le t \\le T_{\\mathrm{inf}}$)\n控制微分方程为 $\\frac{dA(t)}{dt} = R' - k \\cdot A(t)$。设 $A_{\\min,ss}$ 为输注开始时的药量。输注期间药量的解为：\n$$\nA(t) = \\frac{R'}{k} + \\left(A_{\\min,ss} - \\frac{R'}{k}\\right) \\exp(-kt)\n$$\n峰值药量 $A_{\\max,ss}$ 出现在输注结束时，即 $t = T_{\\mathrm{inf}}$：\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\left(1 - \\exp(-k T_{\\mathrm{inf}})\\right) + A_{\\min,ss} \\exp(-k T_{\\mathrm{inf}})\n$$\n\n阶段 II：输注后期 ($T_{\\mathrm{inf}}  t \\le \\tau$)\n输注已停止 ($R'=0$)，控制方程为 $\\frac{dA(t)}{dt} = -k \\cdot A(t)$。药量从峰值开始呈指数衰减：\n$$\nA(t) = A_{\\max,ss} \\exp(-k(t - T_{\\mathrm{inf}}))\n$$\n在给药间隔结束时，即 $t=\\tau$，药量回到下一个周期的谷值水平：\n$$\nA_{\\min,ss} = A_{\\max,ss} \\exp(-k(\\tau - T_{\\mathrm{inf}}))\n$$\n我们将 $A_{\\min,ss}$ 的这个表达式代入 $A_{\\max,ss}$ 的方程中：\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\left(1 - \\exp(-k T_{\\mathrm{inf}})\\right) + \\left( A_{\\max,ss} \\exp(-k(\\tau - T_{\\mathrm{inf}})) \\right) \\exp(-k T_{\\mathrm{inf}})\n$$\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\left(1 - \\exp(-k T_{\\mathrm{inf}})\\right) + A_{\\max,ss} \\exp(-k\\tau)\n$$\n求解 $A_{\\max,ss}$：\n$$\nA_{\\max,ss} (1 - \\exp(-k\\tau)) = \\frac{R'}{k} (1 - \\exp(-k T_{\\mathrm{inf}}))\n$$\n$$\nA_{\\max,ss} = \\frac{R'}{k} \\frac{1 - \\exp(-k T_{\\mathrm{inf}})}{1 - \\exp(-k\\tau)}\n$$\n为了得到峰浓度 $C_{\\max,ss}$，我们除以 $V$ 并代入 $R' = D/T_{\\mathrm{inf}}$ 和 $k=CL/V$：\n$$\nC_{\\max,ss} = \\frac{A_{\\max,ss}}{V} = \\frac{D/T_{\\mathrm{inf}}}{k \\cdot V} \\frac{1 - \\exp(-k T_{\\mathrm{inf}})}{1 - \\exp(-k\\tau)}\n$$\n使用 $CL = k \\cdot V$，最终表达式为：\n$$\nC_{\\max,ss} = \\frac{D}{CL \\cdot T_{\\mathrm{inf}}} \\frac{1 - \\exp\\left(-\\frac{CL}{V} T_{\\mathrm{inf}}\\right)}{1 - \\exp\\left(-\\frac{CL}{V} \\tau\\right)}\n$$\n该表达式给出了 $C_{\\max,ss}$ 作为 $D$, $T_{\\mathrm{inf}}$, $\\tau$, $CL$ 和 $V$ 的函数。\n\n为了解释 $T_{\\mathrm{inf}}$ 的影响，我们保持 $D$, $\\tau$, $CL$ 和 $V$ 恒定。消除速率常数 $k = CL/V$ 也为恒定值。此时 $C_{\\max,ss}$ 的行为由依赖于 $T_{\\mathrm{inf}}$ 的项决定：\n$$\nf(T_{\\mathrm{inf}}) = \\frac{1 - \\exp(-k T_{\\mathrm{inf}})}{T_{\\mathrm{inf}}}\n$$\n为确定此函数的单调性，我们考察它对 $T_{\\mathrm{inf}}$ 的导数：\n$$\n\\frac{df}{dT_{\\mathrm{inf}}} = \\frac{T_{\\mathrm{inf}} \\cdot (k \\exp(-k T_{\\mathrm{inf}})) - (1 - \\exp(-k T_{\\mathrm{inf}})) \\cdot 1}{T_{\\mathrm{inf}}^2} = \\frac{\\exp(-k T_{\\mathrm{inf}})(k T_{\\mathrm{inf}} + 1) - 1}{T_{\\mathrm{inf}}^2}\n$$\n对于 $T_{\\mathrm{inf}} > 0$，分母始终为正。可以证明，对于 $T_{\\mathrm{inf}} > 0$，分子始终为负。函数 $g(x) = \\exp(-ax)(ax+1)-1$ 满足 $g(0)=0$，其导数 $g'(x) = -a^2x\\exp(-ax)$ 在 $a,x>0$ 时为负。因此，$g(x)$ 从 $0$ 开始严格单调递减，这意味着当 $x>0$ 时 $g(x)  0$。因此，对于所有 $T_{\\mathrm{inf}} > 0$，$\\frac{df}{dT_{\\mathrm{inf}}}  0$。\n\n这证明了 $f(T_{\\mathrm{inf}})$ 是一个严格单调递减的函数。因此，当输注持续时间 $T_{\\mathrm{inf}}$ 增加时（同时保持总剂量 $D$ 不变），稳态峰浓度 $C_{\\max,ss}$ 会降低。\n\n从机理上讲，这是因为较长的输注持续时间意味着较低的药物输入速率（$R' = D/T_{\\mathrm{inf}}$）。药物消除（其速率与体内药量成正比，由 $k$ 控制）有更多时间来抵消输注期间较慢的药物给药过程。这导致在输注结束时净累积量减少，从而产生较低的峰浓度。消除速率常数 $k$ 决定了消除过程的“强度”；较高的 $k$ 意味着消除在抵消药物输入方面更有效，使得 $C_{\\max,ss}$ 随 $T_{\\mathrm{inf}}$ 增加而降低的效应更加显著。对于有峰浓度相关毒性问题的药物，延长输注时间是在维持相同给药间隔内总药物暴露量不变的情况下，降低峰浓度的标准策略。",
            "answer": "$$\\boxed{11.34}$$"
        },
        {
            "introduction": "虽然线性模型是理解药代动力学的基石，但许多生物过程（尤其是药物代谢）的容量是有限的。本练习引入了米氏动力学（Michaelis-Menten kinetics）来描述这种可饱和的消除过程，这对于许多治疗窗口狭窄的细胞毒性药物尤其重要。您将计算在这种非线性条件下血药浓度下降所需的时间，并深入理解其与一级动力学模型的关键区别及线性近似的适用范围。",
            "id": "4579785",
            "problem": "将一种细胞毒性抗代谢物以单次快速静脉推注的方式给药于一名成年患者。其药代动力学可通过一个由米氏动力学控制饱和消除的单室模型很好地描述。假设瞬时混合、表观分布容积恒定且无持续输入。设体内药物量为 $A(t)$，血浆浓度为 $C(t)$，且有 $A(t) = V\\,C(t)$，其中 $V$ 是表观分布容积。消除速率由一个能力有限的代谢过程决定，其特征为最大代谢能力 $V_{\\max}$ 和米氏常数 $K_{m}$。\n\n已知 $V_{\\max} = 50$ mg/h，$K_{m} = 2$ mg/L，$V = 20$ L，推注后即刻的初始浓度 $C_{1} = 10$ mg/L，目标较低浓度 $C_{2} = 1$ mg/L，计算浓度从 $C_{1}$ 下降到 $C_{2}$ 所需的时间。将时间以小时表示，并将答案四舍五入至四位有效数字。\n\n此外，基于药代动力学和酶动力学的基本原理，讨论对于此类细胞毒性药物，在何种参数范围内，$C(t)$ 下降的对数线性（一级）近似是可接受的。",
            "solution": "该问题要求计算在米氏动力学控制下，药物浓度从指定的初始值降至最终值所需的时间，并讨论一级近似在何种条件下有效。\n\n首先，我们建立控制微分方程。体内药物量 $A(t)$ 的变化率等于消除速率的负值。消除遵循米氏动力学，因此消除速率由下式给出：$\\frac{V_{\\max} C(t)}{K_{m} + C(t)}$。\n\n药物量 $A(t)$ 的微分方程为：\n$$ \\frac{dA(t)}{dt} = - \\frac{V_{\\max} C(t)}{K_{m} + C(t)} $$\n我们已知体内药物量与血浆浓度之间的关系为 $A(t) = V C(t)$，其中 $V$ 是恒定的表观分布容积。对该关系式关于时间 $t$ 求导，得到：\n$$ \\frac{dA(t)}{dt} = V \\frac{dC(t)}{dt} $$\n将此代入速率方程，得到关于浓度 $C(t)$ 的微分方程：\n$$ V \\frac{dC(t)}{dt} = - \\frac{V_{\\max} C(t)}{K_{m} + C(t)} $$\n$$ \\frac{dC(t)}{dt} = - \\frac{V_{\\max}}{V} \\frac{C(t)}{K_{m} + C(t)} $$\n这是一个可分离的一阶常微分方程。为了求出浓度从初始值 $C_{1}$ 降至最终值 $C_{2}$ 所需的时间 $t$，我们分离变量并进行积分。设浓度为 $C_{1}$ 的时间为 $t=0$，浓度为 $C_{2}$ 的时间为 $t$。\n$$ \\frac{K_{m} + C}{C} dC = - \\frac{V_{\\max}}{V} dt $$\n$$ \\left( \\frac{K_{m}}{C} + 1 \\right) dC = - \\frac{V_{\\max}}{V} dt $$\n我们将左侧从 $C_{1}$ 积分到 $C_{2}$，右侧从 $0$ 积分到 $t$：\n$$ \\int_{C_{1}}^{C_{2}} \\left( \\frac{K_{m}}{C} + 1 \\right) dC = \\int_{0}^{t} - \\frac{V_{\\max}}{V} d\\tau $$\n计算积分得到：\n$$ \\left[ K_{m} \\ln(C) + C \\right]_{C_{1}}^{C_{2}} = \\left[ - \\frac{V_{\\max}}{V} \\tau \\right]_{0}^{t} $$\n$$ (K_{m} \\ln(C_{2}) + C_{2}) - (K_{m} \\ln(C_{1}) + C_{1}) = - \\frac{V_{\\max}}{V} t $$\n$$ K_{m} \\left( \\ln(C_{2}) - \\ln(C_{1}) \\right) + (C_{2} - C_{1}) = - \\frac{V_{\\max}}{V} t $$\n$$ K_{m} \\ln\\left(\\frac{C_{2}}{C_{1}}\\right) + (C_{2} - C_{1}) = - \\frac{V_{\\max}}{V} t $$\n求解时间间隔 $t$：\n$$ t = - \\frac{V}{V_{\\max}} \\left[ K_{m} \\ln\\left(\\frac{C_{2}}{C_{1}}\\right) + (C_{2} - C_{1}) \\right] $$\n利用属性 $\\ln(x/y) = -\\ln(y/x)$，我们可以将表达式写成更方便的形式：\n$$ t = \\frac{V}{V_{\\max}} \\left[ K_{m} \\ln\\left(\\frac{C_{1}}{C_{2}}\\right) + (C_{1} - C_{2}) \\right] $$\n现在，我们代入给定的数值：$V_{\\max} = 50$ mg/h，$K_{m} = 2$ mg/L，$V = 20$ L，$C_{1} = 10$ mg/L，以及 $C_{2} = 1$ mg/L。\n$$ t = \\frac{20 \\text{ L}}{50 \\text{ mg/h}} \\left[ (2 \\text{ mg/L}) \\ln\\left(\\frac{10 \\text{ mg/L}}{1 \\text{ mg/L}}\\right) + (10 \\text{ mg/L} - 1 \\text{ mg/L}) \\right] $$\n$$ t = 0.4 \\frac{\\text{L} \\cdot \\text{h}}{\\text{mg}} \\left[ 2 \\ln(10) + 9 \\right] \\frac{\\text{mg}}{\\text{L}} $$\n$$ t = 0.4 \\left( 2 \\ln(10) + 9 \\right) \\text{h} $$\n使用 $\\ln(10) \\approx 2.302585$ 的值：\n$$ t \\approx 0.4 \\left( 2 \\times 2.302585 + 9 \\right) \\text{h} $$\n$$ t \\approx 0.4 \\left( 4.60517 + 9 \\right) \\text{h} $$\n$$ t \\approx 0.4 \\left( 13.60517 \\right) \\text{h} $$\n$$ t \\approx 5.442068 \\text{ h} $$\n四舍五入到四位有效数字，所需时间为 $t = 5.442$ 小时。\n\n对于问题的第二部分，我们讨论在何种参数范围内对数线性（一级）近似是可接受的。消除速率由米氏表达式给出：\n$$ \\text{消除速率} = \\frac{V_{\\max} C}{K_{m} + C} $$\n一级过程的特征是消除速率与浓度成正比，即 $\\text{消除速率} = k_{el} V C$，其中 $k_{el}$ 是一级消除速率常数。要使米氏模型能近似为一级过程，其速率表达式必须能简化为与 $C$ 成正比的形式。\n\n该近似在药物浓度远低于米氏常数的条件下有效，即 $C \\ll K_{m}$。在此范围内，米氏方程的分母可以近似为 $K_{m} + C \\approx K_{m}$。消除速率则变为：\n$$ \\text{消除速率} \\approx \\frac{V_{\\max} C}{K_{m}} = \\left(\\frac{V_{\\max}}{K_{m}}\\right) C $$\n项 $\\frac{V_{\\max}}{K_{m}}$ 是一个常数，代表当消除未饱和时药物的清除率（$CL$）。浓度的微分方程变为：\n$$ V \\frac{dC}{dt} = - \\left(\\frac{V_{\\max}}{K_{m}}\\right) C $$\n$$ \\frac{dC}{dt} = - \\left(\\frac{V_{\\max}}{V K_{m}}\\right) C = -k_{el} C $$\n这是一级消除的微分方程，其中一级消除速率常数为 $k_{el} = \\frac{V_{\\max}}{V K_{m}}$。该方程的解是 $C(t) = C(0) \\exp(-k_{el} t)$，这对应于半对数图上的线性下降（对数线性动力学）。\n\n相反，当药物浓度远高于米氏常数时（$C \\gg K_{m}$），分母变为 $K_{m} + C \\approx C$。消除速率接近其最大值：\n$$ \\text{消除速率} \\approx \\frac{V_{\\max} C}{C} = V_{\\max} $$\n这对应于零级动力学，其中药物以恒定速率消除，与浓度无关。浓度曲线随时间呈线性变化，而非对数线性。\n\n对于通常具有窄治疗窗的细胞毒性药物，其治疗浓度很容易达到或超过其代谢途径的 $K_{m}$ 值。在这种情况下，消除是能力有限的（可饱和的），不能用简单的一级模型准确描述。当实际过程是饱和的（零级或混合级）时，若假设为一级动力学，将导致对药物暴露（曲线下面积，AUC）的低估，并可能导致意外的药物蓄积和毒性。因此，对于此类药物，只有当其血浆浓度持续且显著低于其 $K_{m}$ 时，对数线性近似才是可接受的。在本题的具体案例中，初始浓度 $C_{1}=10$ mg/L 是 $K_{m}=2$ mg/L 的五倍，表明系统开始时处于接近饱和（零级）的状态，并随着浓度下降至 $C_{2}=1$ mg/L 而过渡到混合级阶段。在此范围内，一级模型将非常不准确。",
            "answer": "$$\\boxed{5.442}$$"
        },
        {
            "introduction": "将理论模型应用于具有个体差异的临床情境是药理学实践的关键一步。本练习将理论与临床决策相结合，探讨如何为不同体型的患者（特别是肥胖患者）调整剂量。通过一个计算模拟任务，您将使用异速生长模型（allometric scaling）和体表面积（BSA）给药法，来量化评估“剂量封顶”这一临床常用策略对药物暴露指标（如 $C_{max}$ 和 AUC）的影响，从而为临床决策提供定量依据。",
            "id": "4579812",
            "problem": "要求您实现一个模拟程序，用于评估在肥胖患者中，对按体表面积（BSA）给药的细胞毒性药物进行剂量封顶的影响。评估方法是比较两种给药策略下的暴露指标：完全基于BSA的给药与BSA封顶给药。药代动力学模型为一级消除的单室静脉（IV）输注模型。您的程序必须为每个指定的测试用例计算两种给药策略下的最大浓度（Cmax）和浓度-时间曲线下面积（AUC），并以严格定义的输出格式返回这些值。\n\n从以下原理和核心定义开始：\n- 体内药物总量的质量平衡：在输注期间，药物量 $A(t)$ 根据 $dA/dt = R_0 - \\text{CL} \\cdot C(t)$ 演变，其中 $C(t) = A(t)/V$。\n- 输注为零级动力学，在有限时间内以恒定速率 $R_0$ 进行。\n- 适用线性动力学，具有一级消除以及不随时间变化的清除率和分布容积。\n- 对于单次给药，浓度-时间曲线下面积满足线性动力学下的清除率恒等式。\n\n使用这些经过充分检验的公式和事实作为您推导和程序设计的基础：\n- 使用Mosteller公式计算体表面积（BSA）：$\\text{BSA} = \\sqrt{\\dfrac{H \\cdot W}{3600}}$，其中 $H$ 是身高（厘米），$W$ 是体重（千克）。\n- 清除率和分布容积的异速生长标度关系：$\\text{CL}(W) = \\text{CL}_{\\text{std}} \\cdot \\left(\\dfrac{W}{70}\\right)^{0.75}$ 和 $V(W) = V_{\\text{std}} \\cdot \\left(\\dfrac{W}{70}\\right)^{1.0}$。\n- 零级输注在时间 $t_{\\text{inf}}$ 结束，之后在无进一步药物输入的情况下进行消除。\n- 在线性动力学下，单次给药的总AUC由清除率和给药总剂量决定。\n\n给药策略：\n- 完全基于BSA的给药：$\\text{Dose}_{\\text{full}} = D_{\\text{m2}} \\cdot \\text{BSA}$。\n- 带上限 $B_{\\max}$ 的BSA封顶给药：$\\text{Dose}_{\\text{capped}} = D_{\\text{m2}} \\cdot \\min(\\text{BSA}, B_{\\max})$。\n\n药代动力学模型规格：\n- 单室模型，零级输注，持续时间为 $t_{\\text{inf}}$ 小时。\n- 线性一级消除，$\\text{CL}$ 和 $V$ 的异速生长标度如上所述。\n\n要求的输出和单位：\n- 计算两种给药策略下输注结束时的Cmax，单位为 $\\mathrm{mg/L}$，四舍五入到四位小数。\n- 计算两种给药策略下从时间零到无穷大的AUC，单位为 $\\mathrm{mg \\cdot h/L}$，四舍五入到四位小数。\n\n角度单位：不适用。百分比：不适用。\n\n所有测试用例使用的参数：\n- 每平方米剂量 $D_{\\text{m2}} = 75\\,\\mathrm{mg/m^2}$。\n- BSA上限 $B_{\\max} = 2.0\\,\\mathrm{m^2}$。\n- 输注持续时间 $t_{\\text{inf}} = 1.0\\,\\mathrm{h}$。\n- 标准清除率 $\\text{CL}_{\\text{std}} = 30\\,\\mathrm{L/h}$。\n- 标准容积 $V_{\\text{std}} = 150\\,\\mathrm{L}$。\n\n测试套件（每个案例是一对 $(W, H)$，其中体重单位为千克，身高单位为厘米），设计用于覆盖一个无封顶效应的非肥胖案例、一个处于封顶边界的案例以及多个因封顶而减少剂量的肥胖案例：\n- 案例1（无封顶效应）：$(W,H) = (70, 175)$。\n- 案例2（恰好在上限）：$(W,H) = (80, 180)$。\n- 案例3（中度肥胖）：$(W,H) = (110, 175)$。\n- 案例4（极度肥胖，较矮）：$(W,H) = (140, 165)$。\n- 案例5（高个，肥胖）：$(W,H) = (95, 200)$。\n\n对于每个案例，您必须：\n- 使用给定公式计算 $\\text{BSA}$。\n- 计算 $\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$。\n- 使用异速生长关系计算 $\\text{CL}$ 和 $V$。\n- 确定两种给药策略下输注结束时的Cmax（曲线中的最大浓度），单位为 $\\mathrm{mg/L}$，四舍五入到四位小数。\n- 确定两种给药策略下从 $0$ 到 $\\infty$ 的AUC，单位为 $\\mathrm{mg \\cdot h/L}$，四舍五入到四位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个结果列表，其中每个结果按上述顺​​序对应一个测试用例，并且其本身是按 $[\\text{Cmax}_{\\text{full}}, \\text{Cmax}_{\\text{capped}}, \\text{AUC}_{\\text{full}}, \\text{AUC}_{\\text{capped}}]$ 顺序包含四个浮点数的列表，其值按指定单位四舍五入到四位小数。\n- 示例格式（仅为说明）：$[[x_1,y_1,z_1,w_1],[x_2,y_2,z_2,w_2],\\dots]$。\n\n您的任务：\n- 实现一个完整、可运行的程序，完全按照规定执行这些计算，使用给定的参数和测试套件，并以指定的最终输出格式单行打印结果。",
            "solution": "该问题是有效的。它提出了一个定义明确的计算任务，该任务基于既有的科学原理和模型，属于临床药理学领域。所有必要的参数和公式均已提供，设置在内部是一致的，并且要求的输出也已明确指定。\n\n解决方案是通过将基本的药代动力学原理应用于一个单室零级静脉输注模型而得出的。每个测试用例的处理过程包括确定患者特异性参数，计算两种不同策略下的剂量，然后计算最大浓度（$C_{\\text{max}}$）和浓度-时间曲线下面积（AUC）这两个药代动力学指标。\n\n### 1. 患者特异性药代动力学参数\n\n对于每位由体重（$W$，单位：千克）和身高（$H$，单位：厘米）定义的患者，我们首先计算其个体化的药代动力学参数：体表面积（BSA）、清除率（CL）和分布容积（$V$）。\n\n- **体表面积（BSA）**：使用Mosteller公式计算，这是一种广泛接受的经验关系式。\n$$\n\\text{BSA} = \\sqrt{\\frac{H \\cdot W}{3600}}\n$$\n当 $H$ 的单位是 $\\text{cm}$ 且 $W$ 的单位是 $\\text{kg}$ 时，其单位为 $\\text{m}^2$。\n\n- **清除率（CL）和分布容积（V）**：这些参数使用异速生长标度确定，它将生理变量与体重联系起来。该标度是相对于体重为 $70\\,\\text{kg}$ 的标准受试者而言的。\n$$\n\\text{CL}(W) = \\text{CL}_{\\text{std}} \\cdot \\left(\\frac{W}{70}\\right)^{0.75}\n$$\n$$\nV(W) = V_{\\text{std}} \\cdot \\left(\\frac{W}{70}\\right)^{1.0}\n$$\n给定 $\\text{CL}_{\\text{std}} = 30\\,\\text{L/h}$ 和 $V_{\\text{std}} = 150\\,\\text{L}$，患者特异性CL的单位为 $\\text{L/h}$，V的单位为 $\\text{L}$。\n\n### 2. 给药策略\n\n细胞毒性药物的总剂量基于两种不同的策略计算，两者都使用标称的每平方米剂量，$D_{\\text{m2}} = 75\\,\\text{mg/m}^2$。\n\n- **完全基于BSA的给药（$\\text{Dose}_{\\text{full}}$）**：剂量与患者计算出的BSA成正比。\n$$\n\\text{Dose}_{\\text{full}} = D_{\\text{m2}} \\cdot \\text{BSA}\n$$\n\n- **BSA封顶给药（$\\text{Dose}_{\\text{capped}}$）**：用于计算剂量的BSA值被限制在一个最大值 $B_{\\max} = 2.0\\,\\text{m}^2$。这种做法在肥胖患者中很常见，目的是为了减轻毒性。\n$$\n\\text{Dose}_{\\text{capped}} = D_{\\text{m2}} \\cdot \\min(\\text{BSA}, B_{\\max})\n$$\n如果患者的BSA小于或等于 $B_{\\max}$，两种给药策略将产生相同的剂量。\n\n### 3. 药代动力学指标计算\n\n对于每种剂量（$\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$），我们计算AUC和 $C_{\\text{max}}$。\n\n- **曲线下面积（AUC）**：对于具有线性一级消除的系统，从时间零到无穷大的总暴露量 $\\text{AUC}_{0-\\infty}$，与给药总剂量和药物清除率有根本关系。这是药代动力学的核心原则。\n$$\n\\text{AUC}_{0-\\infty} = \\frac{\\text{Dose}}{\\text{CL}}\n$$\n该公式分别应用于 $\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$，以求得 $\\text{AUC}_{\\text{full}}$ 和 $\\text{AUC}_{\\text{capped}}$。单位为 $\\text{mg} \\cdot \\text{h/L}$。\n\n- **最大浓度（$C_{\\text{max}}$）**：在输注期间（$0 \\le t \\le t_{\\text{inf}}$），体内的药物浓度 $C(t)$ 由单室模型质量平衡方程 $V \\frac{dC}{dt} = R_0 - \\text{CL} \\cdot C(t)$ 的解来描述，其中 $R_0 = \\text{Dose}/t_{\\text{inf}}$ 是恒定的输注速率。在 $C(0)=0$ 条件下的解是：\n$$\nC(t) = \\frac{R_0}{\\text{CL}} \\left(1 - e^{-k_e t}\\right)\n$$\n其中 $k_e = \\text{CL}/V$ 是一级消除速率常数。\n对于零级输注，药物浓度在输注期间单调增加。因此，最大浓度 $C_{\\text{max}}$ 出现在输注停止的时刻，即 $t = t_{\\text{inf}}$。\n$$\nC_{\\text{max}} = C(t_{\\text{inf}}) = \\frac{R_0}{\\text{CL}} \\left(1 - e^{-k_e t_{\\text{inf}}}\\right) = \\frac{\\text{Dose}/t_{\\text{inf}}}{\\text{CL}} \\left(1 - e^{-(\\text{CL}/V) t_{\\text{inf}}}\\right)\n$$\n该公式分别应用于每种剂量，以求得 $C_{\\text{max,full}}$ 和 $C_{\\text{max,capped}}$，单位为 $\\text{mg/L}$。\n\n### 4. 计算算法\n\n该实现对每个测试用例 $(W, H)$ 遵循一个系统化的步骤：\n1. 计算患者特异性参数：$\\text{BSA}$、$\\text{CL}$ 和 $V$。\n2. 计算 $\\text{Dose}_{\\text{full}}$ 和 $\\text{Dose}_{\\text{capped}}$。\n3. 计算 $\\text{AUC}_{\\text{full}} = \\text{Dose}_{\\text{full}} / \\text{CL}$ 和使用推导出的公式计算 $C_{\\text{max,full}}$。\n4. 由于AUC和 $C_{\\text{max}}$ 均与剂量成正比，封顶情况下的指标可以通过对完全剂量结果进行缩放来高效计算：\n   $$\n   \\text{DoseRatio} = \\frac{\\text{Dose}_{\\text{capped}}}{\\text{Dose}_{\\text{full}}} = \\frac{\\min(\\text{BSA}, B_{\\max})}{\\text{BSA}}\n   $$\n   $$\n   \\text{AUC}_{\\text{capped}} = \\text{AUC}_{\\text{full}} \\cdot \\text{DoseRatio}\n   $$\n   $$\n   C_{\\text{max,capped}} = C_{\\text{max,full}} \\cdot \\text{DoseRatio}\n   $$\n5. 得到的四个指标 $[\\text{Cmax}_{\\text{full}}, \\text{Cmax}_{\\text{capped}}, \\text{AUC}_{\\text{full}}, \\text{AUC}_{\\text{capped}}]$ 四舍五入到四位小数，并收集起来用于最终输出。\n\n对所有指定的测试用例重复此过程，以生成最终结果集。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates Cmax and AUC for cytotoxic agents under full vs. capped BSA dosing.\n    \"\"\"\n    # Define problem parameters\n    D_m2 = 75.0      # Dose per square meter (mg/m^2)\n    B_max = 2.0      # BSA cap (m^2)\n    t_inf = 1.0      # Infusion duration (h)\n    CL_std = 30.0    # Standard clearance (L/h)\n    V_std = 150.0    # Standard volume of distribution (L)\n    W_std = 70.0     # Standard weight (kg)\n\n    # Define the test suite: (Weight in kg, Height in cm)\n    test_cases = [\n        (70, 175),\n        (80, 180),\n        (110, 175),\n        (140, 165),\n        (95, 200),\n    ]\n\n    all_results = []\n\n    for W, H in test_cases:\n        # Step 1: Calculate patient-specific parameters\n        # Mosteller formula for Body Surface Area (BSA)\n        bsa = np.sqrt((H * W) / 3600.0)\n\n        # Allometric scaling for Clearance (CL) and Volume (V)\n        cl = CL_std * np.power(W / W_std, 0.75)\n        v = V_std * np.power(W / W_std, 1.0)\n        \n        # Elimination rate constant\n        k_e = cl / v\n\n        # Step 2: Calculate doses for both strategies\n        dose_full = D_m2 * bsa\n        capped_bsa = min(bsa, B_max)\n        dose_capped = D_m2 * capped_bsa\n\n        # Step 3: Calculate pharmacokinetic metrics for the full dose\n        # Handle the edge case of zero dose to avoid division by zero\n        if dose_full == 0:\n            cmax_full = 0.0\n            auc_full = 0.0\n        else:\n            # Infusion rate for full dose\n            R0_full = dose_full / t_inf\n            \n            # Cmax at the end of infusion for full dose\n            cmax_full = (R0_full / cl) * (1.0 - np.exp(-k_e * t_inf))\n            \n            # AUC from 0 to infinity for full dose\n            auc_full = dose_full / cl\n\n        # Step 4: Calculate metrics for the capped dose by scaling\n        # The relationship between metrics and dose is linear\n        if dose_full == 0:\n            dose_ratio = 0.0\n        else:\n            dose_ratio = dose_capped / dose_full\n        \n        cmax_capped = cmax_full * dose_ratio\n        auc_capped = auc_full * dose_ratio\n\n        # Collect the results for the current case\n        case_results = [cmax_full, cmax_capped, auc_full, auc_capped]\n        all_results.append(case_results)\n\n    # Step 5: Format the final output string exactly as required\n    # List of strings, where each string is a formatted inner list\n    # e.g., '[0.1234, 5.6789, ...]'\n    list_of_list_strings = []\n    for result_list in all_results:\n        # Format each number to 4 decimal places, creating a list of strings\n        # e.g., ['0.1234', '5.6789', ...]\n        formatted_numbers = [f\"{val:.4f}\" for val in result_list]\n        \n        # Join with \", \" to get a space after the comma, and add brackets\n        # e.g., '[0.1234, 5.6789]'\n        inner_list_str = '[' + ', '.join(formatted_numbers) + ']'\n        list_of_list_strings.append(inner_list_str)\n\n    # Join the outer list elements with a comma (no space) and add brackets\n    # e.g., '[[...],[...]]'\n    final_output_str = '[' + ','.join(list_of_list_strings) + ']'\n    \n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}