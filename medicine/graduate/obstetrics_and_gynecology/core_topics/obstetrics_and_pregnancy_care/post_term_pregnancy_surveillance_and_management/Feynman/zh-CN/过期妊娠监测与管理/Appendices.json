{
    "hands_on_practices": [
        {
            "introduction": "在过期妊娠的管理中，准确解读胎儿监护工具的结果至关重要。无应激试验（NST）是一项基础的产前监护技术，但其原始的敏感性和特异性本身并不能直接指导临床决策。本练习将引导您应用贝叶斯定理，计算非应激试验（NST）的阳性预测值（PPV）和阴性预测值（NPV），从而加深您对特定人群中疾病患病率如何影响检测预测价值的理解，这是在临床实践中准确解读检测结果的核心技能。",
            "id": "4492246",
            "problem": "一家三级产科中心正在对晚期和过期妊娠进行胎儿监护。考虑一个妊娠周数为 $41$ 周的患者队列，她们正在接受无应激试验（NST），这是过期妊娠管理中的一项核心监护工具。定义事件 $D$ 为胎儿在未来 $7$ 天内出现临床上显著的损害（例如，出生时酸血症、因胎儿指征紧急手术分娩或死产的复合结局），并定义 $\\overline{D}$ 为没有此类损害。设 $T^{+}$ 表示阳性（无保障）的NST结果， $T^{-}$ 表示阴性（有保障）的NST结果。已知在该人群中，NST预测 $D$ 的灵敏度为 $0.85$，特异度为 $0.90$，$D$ 的患病率为 $0.03$。\n\n使用灵敏度、特异度和患病率的定义，并以贝叶斯定理和全概率公式为基础，推导阳性预测值 $\\mathbb{P}(D \\mid T^{+})$ 和阴性预测值 $\\mathbb{P}(\\overline{D} \\mid T^{-})$ 关于灵敏度、特异度和患病率的一般表达式。然后，使用灵敏度 $0.85$、特异度 $0.90$ 和患病率 $0.03$ 对这些表达式进行数值计算。\n\n将阳性预测值和阴性预测值以小数形式报告（非百分比），并四舍五入至四位有效数字。以有序对 $\\left(\\text{PPV}, \\text{NPV}\\right)$ 的形式提供您的最终数值结果。",
            "solution": "首先将根据所需标准对问题陈述进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   **背景**：晚期和过期妊娠的胎儿监护（妊娠周数 $41$ 周）。\n-   **事件**：\n    -   $D$：胎儿在未来 $7$ 天内出现临床上显著的损害。\n    -   $\\overline{D}$：没有此类损害。\n-   **试验结果**：\n    -   $T^{+}$：阳性（无保障）的无应激试验（NST）。\n    -   $T^{-}$：阴性（有保障）的NST。\n-   **概率**：\n    -   NST预测 $D$ 的灵敏度：$\\mathbb{P}(T^{+} \\mid D) = 0.85$。\n    -   NST预测 $D$ 的特异度：$\\mathbb{P}(T^{-} \\mid \\overline{D}) = 0.90$。\n    -   $D$ 的患病率：$\\mathbb{P}(D) = 0.03$。\n-   **任务要求**：\n    1.  推导阳性预测值 $\\mathbb{P}(D \\mid T^{+})$ 和阴性预测值 $\\mathbb{P}(\\overline{D} \\mid T^{-})$ 关于灵敏度、特异度和患病率的一般表达式。\n    2.  使用给定值对这些表达式进行数值计算。\n    3.  以有序对的形式报告数值结果，以小数表示并四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学性**：该问题设置在真实的临床背景（产科学）中，并使用标准的流行病学和统计学概念（灵敏度、特异度、患病率、预测值）。贝叶斯定理的应用是解决此类问题的正确数学框架。所提供的值对于此类诊断测试是合理的。\n-   **适定性**：该问题是适定的。它提供了推导所需表达式和计算数值所需的所有必要信息。问题明确，可得出唯一解。\n-   **客观性**：语言客观、精确，没有主观论断或偏见。\n\n该问题没有任何缺陷。它科学合理、结构正式、信息完整且可验证。\n\n**步骤3：结论与行动**\n\n此问题**有效**。将提供完整解答。\n\n### 解答\n\n目标是推导阳性预测值（PPV）和阴性预测值（NPV）的表达式，然后计算它们的数值。\n\n设 $S_e$ 表示试验的灵敏度，$S_p$ 表示特异度，$P_v$ 表示患病率。\n根据已知条件，我们有：\n-   灵敏度：$S_e = \\mathbb{P}(T^{+} \\mid D) = 0.85$\n-   特异度：$S_p = \\mathbb{P}(T^{-} \\mid \\overline{D}) = 0.90$\n-   患病率：$P_v = \\mathbb{P}(D) = 0.03$\n\n根据这些定义，我们可以推导出其他必要的概率：\n-   假阴性的概率是 $1 - S_e = \\mathbb{P}(T^{-} \\mid D) = 1 - 0.85 = 0.15$。\n-   无病的概率是 $\\mathbb{P}(\\overline{D}) = 1 - P_v = 1 - 0.03 = 0.97$。\n-   假阳性的概率是 $1 - S_p = \\mathbb{P}(T^{+} \\mid \\overline{D}) = 1 - 0.90 = 0.10$。\n\n**1. 阳性预测值（PPV）的推导**\n\n阳性预测值是在试验结果为阳性的情况下患有该病的概率，即 $\\mathbb{P}(D \\mid T^{+})$。根据贝叶斯定理：\n$$ \\mathbb{P}(D \\mid T^{+}) = \\frac{\\mathbb{P}(T^{+} \\mid D) \\mathbb{P}(D)}{\\mathbb{P}(T^{+})} $$\n分母 $\\mathbb{P}(T^{+})$ 是试验结果为阳性的总概率。可以使用全概率公式展开：\n$$ \\mathbb{P}(T^{+}) = \\mathbb{P}(T^{+} \\mid D) \\mathbb{P}(D) + \\mathbb{P}(T^{+} \\mid \\overline{D}) \\mathbb{P}(\\overline{D}) $$\n代入灵敏度、特异度和患病率的项：\n$$ \\mathbb{P}(T^{+}) = (S_e)(P_v) + (1 - S_p)(1 - P_v) $$\n因此，PPV 的一般表达式为：\n$$ \\text{PPV} = \\mathbb{P}(D \\mid T^{+}) = \\frac{(S_e)(P_v)}{(S_e)(P_v) + (1 - S_p)(1 - P_v)} $$\n\n**2. 阴性预测值（NPV）的推导**\n\n阴性预测值是在试验结果为阴性的情况下不患该病的概率，即 $\\mathbb{P}(\\overline{D} \\mid T^{-})$。根据贝叶斯定理：\n$$ \\mathbb{P}(\\overline{D} \\mid T^{-}) = \\frac{\\mathbb{P}(T^{-} \\mid \\overline{D}) \\mathbb{P}(\\overline{D})}{\\mathbb{P}(T^{-})} $$\n分母 $\\mathbb{P}(T^{-})$ 是试验结果为阴性的总概率。可以使用全概率公式展开：\n$$ \\mathbb{P}(T^{-}) = \\mathbb{P}(T^{-} \\mid \\overline{D}) \\mathbb{P}(\\overline{D}) + \\mathbb{P}(T^{-} \\mid D) \\mathbb{P}(D) $$\n代入灵敏度、特异度和患病率的项：\n$$ \\mathbb{P}(T^{-}) = (S_p)(1 - P_v) + (1 - S_e)(P_v) $$\n因此，NPV 的一般表达式为：\n$$ \\text{NPV} = \\mathbb{P}(\\overline{D} \\mid T^{-}) = \\frac{(S_p)(1 - P_v)}{(S_p)(1 - P_v) + (1 - S_e)(P_v)} $$\n\n**3. 数值计算**\n\n现在，我们将给定的数值代入推导出的表达式中。\n-   $S_e = 0.85$\n-   $S_p = 0.90$\n-   $P_v = 0.03$\n\n**计算 PPV：**\n$$ \\text{PPV} = \\frac{(0.85)(0.03)}{(0.85)(0.03) + (1 - 0.90)(1 - 0.03)} $$\n$$ \\text{PPV} = \\frac{0.0255}{0.0255 + (0.10)(0.97)} $$\n$$ \\text{PPV} = \\frac{0.0255}{0.0255 + 0.097} $$\n$$ \\text{PPV} = \\frac{0.0255}{0.1225} \\approx 0.208163265... $$\n四舍五入到四位有效数字，我们得到 $\\text{PPV} = 0.2082$。\n\n**计算 NPV：**\n$$ \\text{NPV} = \\frac{(0.90)(1 - 0.03)}{(0.90)(1 - 0.03) + (1 - 0.85)(0.03)} $$\n$$ \\text{NPV} = \\frac{(0.90)(0.97)}{(0.90)(0.97) + (0.15)(0.03)} $$\n$$ \\text{NPV} = \\frac{0.873}{0.873 + 0.0045} $$\n$$ \\text{NPV} = \\frac{0.873}{0.8775} \\approx 0.994871794... $$\n四舍五入到四位有效数字，我们得到 $\\text{NPV} = 0.9949$。\n\n最终答案是有序对 $(\\text{PPV}, \\text{NPV})$。",
            "answer": "$$\\boxed{(0.2082, 0.9949)}$$"
        },
        {
            "introduction": "临床实践中，单一检测结果往往不足以做出最终决策，尤其是在面对初步的非保证性结果时。本练习模拟了一个常见的临床场景：在一次无反应的NST之后，通常会进行生物物理评分（BPP）以进一步评估胎儿状况。这个实践旨在演示贝叶斯更新的核心思想，即如何利用连续的检测结果动态地修正对胎儿风险的评估。通过计算这一系列检测后的最终后验概率，您将量化地理解一个更具特异性的检测（如BPP）如何澄清一个模糊的初步结果，从而避免不必要的医疗干预。",
            "id": "4492284",
            "problem": "一名孕 $2$ 产 $1$、孕周 $41^{+3}$ 周的过期单胎妊娠孕妇正在接受常规胎儿监护。临床问题是胎儿当前是否受损（操作性定义为临床上显著的缺氧或酸血症，可能需要在 $24$ 小时内分娩）。在本单元中，请考虑以下情景和参数：\n\n- 在此过期妊娠监护人群中，胎儿受损的先验概率为 $p_{0} = 0.12$。\n- 第一个测试是无应激试验（Non-Stress Test, NST），其中无反应结果被视为胎儿受损的阳性测试。在这种情况下，NST 的灵敏度为 $Se_{\\mathrm{NST}} = 0.70$，特异度为 $Sp_{\\mathrm{NST}} = 0.80$。\n- 第二个测试是生物物理评分（Biophysical Profile, BPP），其中正常的 BPP（评分 $\\geq 8$ 且未因无反应而扣分）被视为胎儿受损的阴性测试。在这种情况下，异常 BPP 的灵敏度为 $Se_{\\mathrm{BPP}} = 0.95$，特异度为 $Sp_{\\mathrm{BPP}} = 0.90$。\n- 假设 NST 和 BPP 在给定真实胎儿状态（受损与未受损）的情况下是条件独立的。\n\n该患者的结果序列是无反应的 NST，随后是正常的 BPP。\n\n仅使用上述信息和基于临床测试特征的概率推断第一性原理，计算经过这一系列测试后当前胎儿受损的后验概率。将最终概率以小数形式表示，并四舍五入到四位有效数字。请勿使用百分号。\n\n然后，基于此监护方案的分娩行动阈值 $\\tau = 0.10$，从概念上解释（除了您计算的后验概率外，无需额外计算）与仅根据无反应的 NST 采取行动相比，无反应的 NST 加上正常的 BPP 这一组合如何减少不必要的分娩。",
            "solution": "该问题是有效的，因为它在科学上基于概率推断，信息充分且一致，问题提出得当，并且其表述是客观的。\n\n此问题要求使用贝叶斯定理以序贯方式计算后验概率。让我们根据所提供的信息定义相关事件和概率。\n\n设 $C$ 为胎儿受损事件。其补集 $C^c$ 为胎儿未受损事件。\n胎儿受损的先验概率为 $P(C) = p_{0} = 0.12$。\n因此，胎儿未受损的概率为 $P(C^c) = 1 - P(C) = 1 - 0.12 = 0.88$。\n\n设 $T_1^+$ 表示阳性无应激试验（NST），即无反应结果。\n设 $T_2^-$ 表示阴性生物物理评分（BPP），即正常结果（评分 $\\geq 8$）。\n患者的测试结果序列为 $(T_1^+, T_2^-)$。\n\n提供的测试特征如下：\n对于 NST：\n- 灵敏度：$Se_{\\mathrm{NST}} = P(T_1^+ | C) = 0.70$。\n- 特异度：$Sp_{\\mathrm{NST}} = P(T_1^- | C^c) = 0.80$，其中 $T_1^-$ 是阴性（有反应）的 NST。\n从特异度可以推导出 NST 的假阳性率：$P(T_1^+ | C^c) = 1 - Sp_{\\mathrm{NST}} = 1 - 0.80 = 0.20$。\n\n对于 BPP：\n- 灵敏度：$Se_{\\mathrm{BPP}} = P(T_2^+ | C) = 0.95$，其中 $T_2^+$ 是阳性（异常）的 BPP。\n- 特异度：$Sp_{\\mathrm{BPP}} = P(T_2^- | C^c) = 0.90$。\n从灵敏度可以推导出 BPP 的假阴性率：$P(T_2^- | C) = 1 - Se_{\\mathrm{BPP}} = 1 - 0.95 = 0.05$。\n\n我们需要计算在 NST 阳性和 BPP 阴性的条件下，胎儿受损的后验概率，即 $P(C | T_1^+, T_2^-)$。\n我们将使用贝叶斯定理。问题陈述，在给定真实胎儿状态下，这两个测试是条件独立的。这意味着 $P(T_1^+, T_2^- | C) = P(T_1^+ | C) P(T_2^- | C)$ 并且 $P(T_1^+, T_2^- | C^c) = P(T_1^+ | C^c) P(T_2^- | C^c)$。\n\n后验概率的公式为：\n$$ P(C | T_1^+, T_2^-) = \\frac{P(T_1^+, T_2^- | C) P(C)}{P(T_1^+, T_2^-)} $$\n分母 $P(T_1^+, T_2^-)$ 可以使用全概率公式展开：\n$$ P(T_1^+, T_2^-) = P(T_1^+, T_2^- | C) P(C) + P(T_1^+, T_2^- | C^c) P(C^c) $$\n将条件独立性假设代入完整的贝叶斯定理公式：\n$$ P(C | T_1^+, T_2^-) = \\frac{P(T_1^+ | C) P(T_2^- | C) P(C)}{P(T_1^+ | C) P(T_2^- | C) P(C) + P(T_1^+ | C^c) P(T_2^- | C^c) P(C^c)} $$\n\n现在，我们将给定的数值代入此表达式。\n公式的组成部分如下：\n- $P(C) = 0.12$\n- $P(C^c) = 0.88$\n- $P(T_1^+ | C) = 0.70$\n- $P(T_2^- | C) = 0.05$\n- $P(T_1^+ | C^c) = 0.20$\n- $P(T_2^- | C^c) = 0.90$\n\n分子是患有该疾病且得到这一特定测试结果组合的概率：\n$$ \\text{Numerator} = P(T_1^+ | C) P(T_2^- | C) P(C) = (0.70) \\times (0.05) \\times (0.12) = 0.0042 $$\n\n分母是在受损和未受损胎儿中得到这一测试结果组合的总概率。它由两项组成：\n第一项与分子相同：\n$$ P(T_1^+ | C) P(T_2^- | C) P(C) = 0.0042 $$\n第二项是未患该疾病但得到这一特定测试结果组合的概率：\n$$ P(T_1^+ | C^c) P(T_2^- | C^c) P(C^c) = (0.20) \\times (0.90) \\times (0.88) = 0.1584 $$\n总分母是这两项之和：\n$$ \\text{Denominator} = 0.0042 + 0.1584 = 0.1626 $$\n\n最后，后验概率是分子与分母的比值：\n$$ P(C | T_1^+, T_2^-) = \\frac{0.0042}{0.1626} \\approx 0.025830258... $$\n四舍五入到四位有效数字，我们得到 $0.02583$。\n\n对于问题的第二部分，我们需要在给定行动阈值 $\\tau = 0.10$ 的情况下，从概念上解释这种序贯测试如何减少不必要的分娩。\n首先，考虑仅根据 NST 结果采取行动的情况。该患者的 NST 结果为无反应，即阳性测试 ($T_1^+$)。仅此单一测试后，胎儿受损的后验概率 $P(C|T_1^+)$ 将为：\n$$ P(C|T_1^+) = \\frac{P(T_1^+|C)P(C)}{P(T_1^+|C)P(C) + P(T_1^+|C^c)P(C^c)} = \\frac{(0.70)(0.12)}{(0.70)(0.12) + (0.20)(0.88)} = \\frac{0.084}{0.084 + 0.176} = \\frac{0.084}{0.260} \\approx 0.323 $$\n由于这个概率（约 $0.323$）大于行动阈值 $\\tau = 0.10$，因此仅根据无反应的 NST 结果就会做出分娩的决定。\n\n然而，监护方案包括随后的 BPP。患者正常的 BPP 结果 ($T_2^-$) 提供了反对胎儿受损的有力证据，因为 BPP 具有高特异度 ($Sp_{\\mathrm{BPP}}=0.90$) 且其假阴性率低 ($1 - Se_{\\mathrm{BPP}}=0.05$)。这一新信息将受损概率显著向下修正，从 $P(C|T_1^+) \\approx 0.323$ 修正到我们计算出的最终后验概率 $P(C|T_1^+, T_2^-) \\approx 0.02583$。\n\n这个约 $2.6\\%$ 的最终概率远低于行动阈值 $\\tau = 0.10$。因此，根据组合的测试结果，决定是继续监护而不是进行分娩。\n\n总之，在无反应的 NST 之后序贯使用 BPP 可以澄清胎儿的状态。无反应的 NST 具有相对较高的假阳性率（在本例中为 $P(T_1^+|C^c)=0.20$），这意味着许多未受损的胎儿会出现此结果。后续的 BPP 是一项诊断准确性更高的测试，能有效地筛除这些假阳性结果。通过重新评估风险并发现其较低，组合测试策略避免了因仅根据初始、特异性较低的测试结果而采取行动所导致的医源性分娩。这提高了监护策略的整体特异度，并避免了与并非真正有指征的干预相关的母体和胎儿风险。",
            "answer": "$$\n\\boxed{0.02583}\n$$"
        },
        {
            "introduction": "在决定对过期妊娠进行引产后，临床工作重点从风险评估转向干预效果的预测，向患者提供关于引产成功可能性的循证建议变得至关重要。本练习将向您介绍逻辑回归，这是一种强大的统计工具，用于根据一个或多个预测变量来模拟二元结局（例如，成功或失败）的概率。在此，您将使用宫颈Bishop评分作为预测因子，来计算24小时内成功阴道分娩的概率。这项动手实践将向您展示如何将一个临床参数（Bishop评分）转化为量化预测，为患者咨询和制定管理计划提供更坚实的循证基础。",
            "id": "4492285",
            "problem": "一位妊娠 $\\geq 41$ 周、胎儿监护良好的初产妇因过期妊娠计划进行引产。在该机构中，既往过期妊娠引产的监测数据已通过逻辑回归进行建模，其中 $24$ 小时内阴道分娩的概率 $p$ 与 Bishop 评分相关联。基本假设如下：\n\n- 概率为 $p$ 的事件的比值定义为 $p/(1 - p)$。\n- 在逻辑回归中，比值的对数（对数比值）被建模为预测变量的线性函数：$$\\ln\\!\\left(\\frac{p}{1 - p}\\right) = \\beta_{0} + \\beta_{1}\\,x,$$ 其中 $x$ 是预测变量。\n- 对于该亚组的过期妊娠引产，预测变量 $x$ 是 Bishop 评分，并且对于指定的引产方案（人工破膜并用催产素加强），估计的系数为 $\\beta_{0} = -2.1$ 和 $\\beta_{1} = 0.45$。\n\n假设在引产开始时，患者的 Bishop 评分为 $6$。从上述基本定义出发，推导 $p$ 的解析表达式，然后计算该患者在 $24$ 小时内阴道分娩概率的数值。\n\n将最终概率表示为小数，并将答案四舍五入到 $4$ 位有效数字。不要使用百分号。",
            "solution": "首先对问题陈述进行验证。\n\n已知条件如下：\n1.  一个关于妊娠 $\\geq 41$ 周、正在进行引产的初产妇在 $24$ 小时内阴道分娩概率 $p$ 的逻辑回归模型。\n2.  比值的定义：$\\frac{p}{1 - p}$。\n3.  对数比值的模型方程：$\\ln\\!\\left(\\frac{p}{1 - p}\\right) = \\beta_{0} + \\beta_{1}\\,x$。\n4.  预测变量 $x$ 是 Bishop 评分。\n5.  估计的模型系数为 $\\beta_{0} = -2.1$ 和 $\\beta_{1} = 0.45$。\n6.  特定患者的 Bishop 评分为 $x = 6$。\n7.  任务是推导 $p$ 的解析表达式并计算其值，四舍五入到 $4$ 位有效数字。\n\n验证评估：\n该问题具有科学依据，采用了在医学研究和产科中用于风险和成功预测的成熟标准统计方法（逻辑回归）。Bishop 评分是一种有效且广泛使用的临床工具。问题陈述清晰，提供了计算概率 $p$ 的唯一值所需的所有必要信息（$\\beta_0$、$\\beta_1$、$x$）。语言客观、精确，没有歧义。问题是自洽的、一致的，并且需要直接的数学推导和计算。因此，该问题被认为是有效的，并将提供解答。\n\n起点是所提供的逻辑回归模型：\n$$\n\\ln\\!\\left(\\frac{p}{1 - p}\\right) = \\beta_{0} + \\beta_{1}\\,x\n$$\n其中 $p$ 是目标结果的概率。为了找到 $p$ 的解析表达式，我们必须解这个方程求出 $p$。\n\n首先，我们对等式两边取指数以消除自然对数：\n$$\n\\frac{p}{1 - p} = \\exp(\\beta_{0} + \\beta_{1}\\,x)\n$$\n右边的项代表事件的比值。令 $O = \\exp(\\beta_{0} + \\beta_{1}\\,x)$。方程变为：\n$$\n\\frac{p}{1 - p} = O\n$$\n现在，我们求解 $p$：\n$$\np = O(1 - p)\n$$\n$$\np = O - O\\,p\n$$\n$$\np + O\\,p = O\n$$\n$$\np(1 + O) = O\n$$\n$$\np = \\frac{O}{1 + O}\n$$\n将比值 $O$ 的表达式代回此方程，得到概率 $p$ 的通用解析表达式：\n$$\np(x) = \\frac{\\exp(\\beta_{0} + \\beta_{1}\\,x)}{1 + \\exp(\\beta_{0} + \\beta_{1}\\,x)}\n$$\n这是标准的逻辑斯谛函数。\n\n接下来，我们计算给定患者的概率数值。所提供的值为 $\\beta_{0} = -2.1$、$\\beta_{1} = 0.45$，以及患者的 Bishop 评分为 $x = 6$。\n\n首先，我们计算线性预测变量的值，即指数函数的参数（对数比值）：\n$$\n\\beta_{0} + \\beta_{1}\\,x = -2.1 + (0.45)(6)\n$$\n$$\n\\beta_{0} + \\beta_{1}\\,x = -2.1 + 2.7 = 0.6\n$$\n现在，我们将这个值代入 $p$ 的表达式中：\n$$\np = \\frac{\\exp(0.6)}{1 + \\exp(0.6)}\n$$\n使用计算器计算 $\\exp(0.6)$ 的值：\n$$\n\\exp(0.6) \\approx 1.8221188\n$$\n将此数值代入 $p$ 的方程中：\n$$\np \\approx \\frac{1.8221188}{1 + 1.8221188} = \\frac{1.8221188}{2.8221188} \\approx 0.64565346\n$$\n问题要求将答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $6$、$4$、$5$ 和 $6$。第五位数字是 $5$，所以我们将第四位数字向上取整。\n$$\np \\approx 0.6457\n$$\n因此，该患者在 $24$ 小时内阴道分娩的概率约为 $0.6457$。",
            "answer": "$$\n\\boxed{0.6457}\n$$"
        }
    ]
}