{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践练习展示了在时间周期上应用守恒律的威力。我们将探讨如何设计药物输注方案以维持期望的平均药物浓度，这是药代动力学的基石。这个练习揭示了一个优雅的原则：对于处于周期性稳态的线性系统，在考虑时间平均浓度时，输注波形的复杂细节变得无关紧要 。",
            "id": "3878824",
            "problem": "一个体积为 $V$、以清除率 $CL$ 为特征进行线性消除的单一充分混合的中央生理室，由一个每隔周期 $T$ 重复一次的周期性输注输入 $R_{in}(t)$ 供给。设中央室浓度为 $C(t)$，其药量为 $A(t)=V\\,C(t)$。主导的质量守恒原理意味着中央室中流入和流出的平衡，产生一个形式为 $dA/dt = R_{in}(t) - \\text{(消除速率)}$ 的常微分方程（ODE），单位为单位时间的质量。假设消除通过 $CL$ 与 $C(t)$ 成正比，因此消除速率等于 $CL\\,C(t)$。\n\n通过选择决定 $R_{in}(t)$ 的振幅或基线的未知输注参数来设计给药方案，使得在一个周期内 $C(t)$ 的周期性稳态时间平均值等于预设目标 $\\overline{C}_{\\text{target}}$。三角函数中出现的角度必须以弧度为单位解释。所有物理量使用以下单位：$CL$ 单位为升/小时 (L/h)，$V$ 单位为升 (L)，$T$、$\\tau$、$\\tau_{\\text{on}}$、$\\delta_{\\text{up}}$ 和 $\\delta_{\\text{down}}$ 单位为小时 (h)，$R_{in}(t)$ 及任何振幅参数单位为毫克/小时 (mg/h)，$C(t)$ 和 $\\overline{C}_{\\text{target}}$ 单位为毫克/升 (mg/L)。您的程序必须为每个指定的波形计算出达到周期性稳态下目标时间平均浓度的唯一输注参数值，并将这些参数值作为一个逗号分隔的列表输出，列表用方括号括起来，单位为 mg/h，不含任何额外文本。\n\n您必须仅使用上述质量守恒和线性消除假设，并且不得依赖于超出在周期性稳态下对 ODE 进行一个周期积分所得出的快捷公式。设计必须对任何现代编程语言都普遍有效，并纯粹用数学和逻辑术语表达。\n\n测试套件。对于以下每种情况，确定并以浮点数形式报告相应的输注参数（单位：mg/h）。角度单位是弧度。\n\n- 情况 $1$（方波输注）：周期 $T = 12$ h，每个周期内以恒定速率 $r_0$（未知）输注的持续时间为 $\\tau=3$ h，其余时间为 $0$；清除率 $CL=5$ L/h；目标平均浓度 $\\overline{C}_{\\text{target}}=2$ mg/L。确定 $r_0$。\n\n- 情况 $2$（三角波输注）：周期 $T=8$ h；在每个周期内，输注在 $\\tau=2$ h 时间内从 $0$ 线性上升至峰值 $r_0$（未知），其余时间为 $0$；清除率 $CL=4.5$ L/h；目标平均浓度 $\\overline{C}_{\\text{target}}=3$ mg/L。确定 $r_0$。\n\n- 情况 $3$（带基线的正弦输注）：周期 $T=24$ h；输注 $R_{in}(t) = b_0 + a \\sin\\!\\big(2\\pi t/T\\big)$，已知振幅 $a=10$ mg/h，基线 $b_0$ 未知；清除率 $CL=4$ L/h；目标平均浓度 $\\overline{C}_{\\text{target}}=3$ mg/L。确定 $b_0$。\n\n- 情况 $4$（梯形输注）：周期 $T=8$ h；输注在 $\\delta_{\\text{up}}=1$ h 内从 $0$ 线性上升至平台值 $r_0$（未知），在 $r_0$ 处保持 $\\tau_{\\text{on}}=4$ h，然后在 $\\delta_{\\text{down}}=1$ h 内从 $r_0$ 线性下降至 $0$，其余时间为 $0$；清除率 $CL=6$ L/h；目标平均浓度 $\\overline{C}_{\\text{target}}=1.5$ mg/L。确定 $r_0$。\n\n- 情况 $5$（恒定输注）：周期 $T=24$ h；输注 $R_{in}(t) = r_0$（未知常数）；清除率 $CL=7$ L/h；目标平均浓度 $\\overline{C}_{\\text{target}}=1.25$ mg/L。确定 $r_0$。\n\n最终输出格式。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，单位为 mg/h，顺序为 $[r_0^{(1)},r_0^{(2)},b_0^{(3)},r_0^{(4)},r_0^{(5)}]$，其中上标表示如上所述的案例编号。例如，如果 `[40.0,80.0,12.0,14.4,8.75]` 是计算出的正确输注参数（单位：mg/h），那么这种形式的输出是有效的。",
            "solution": "该问题已经过验证，被认为是合理的。它在科学上基于线性药代动力学原理，提法明确，信息充分，可以为每种情况确定唯一解，并以客观、正式的语言表达。核心任务要求应用周期性稳态条件下的质量守恒原理，这是生物医学系统建模中的一个基本概念。提到室体积 $V$ 但未提供其值并不会使问题不完整，因为事实证明该参数对于确定时间平均输注速率和时间平均浓度之间的关系是不必要的。\n\n解决方案首先推导在周期性稳态下平均输注速率和平均药物浓度之间的一般关系。然后将此关系应用于五种具体的给药方案。\n\n室内物质数量 $A(t)$ 的主导常微分方程由质量平衡原理给出：\n$$\n\\frac{dA(t)}{dt} = R_{in}(t) - R_{out}(t)\n$$\n其中 $R_{in}(t)$ 是输注速率，$R_{out}(t)$ 是消除速率。问题指出消除是线性的，由清除率 $CL$ 表征，因此消除速率为 $R_{out}(t) = CL \\cdot C(t)$。药量 $A(t)$ 通过 $A(t) = V \\cdot C(t)$ 与浓度 $C(t)$ 和体积 $V$ 相关。将这些代入质量平衡方程可得：\n$$\n\\frac{d(V \\cdot C(t))}{dt} = R_{in}(t) - CL \\cdot C(t)\n$$\n由于体积 $V$ 是恒定的，我们有：\n$$\nV \\frac{dC(t)}{dt} = R_{in}(t) - CL \\cdot C(t)\n$$\n问题指明系统处于周期性稳态。这意味着浓度曲线以周期 $T$ 呈周期性，即对所有 $t$ 都有 $C(t+T) = C(t)$。因此，室内的药量也是周期性的，$A(t+T) = A(t)$。\n\n为了找到平均值之间的关系，我们将 $A(t)$ 的质量平衡方程在一个完整周期内积分，从任意时间 $t_0$ 到 $t_0+T$：\n$$\n\\int_{t_0}^{t_0+T} \\frac{dA(t)}{dt} dt = \\int_{t_0}^{t_0+T} \\left( R_{in}(t) - CL \\cdot C(t) \\right) dt\n$$\n根据微积分基本定理，左侧为 $A(t_0+T) - A(t_0)$。由于周期性稳态条件，$A(t_0+T) = A(t_0)$，因此左侧计算结果为 $0$。\n$$\n0 = \\int_{t_0}^{t_0+T} R_{in}(t) dt - \\int_{t_0}^{t_0+T} CL \\cdot C(t) dt\n$$\n重新整理并注意到 $CL$ 是一个常数，我们得到：\n$$\nCL \\int_{t_0}^{t_0+T} C(t) dt = \\int_{t_0}^{t_0+T} R_{in}(t) dt\n$$\n函数 $f(t)$ 在一个周期 $T$ 内的时间平均值定义为 $\\overline{f} = \\frac{1}{T} \\int_{t_0}^{t_0+T} f(t) dt$。应用此定义，我们可以用时间平均浓度 $\\overline{C}$ 和时间平均输注速率 $\\overline{R_{in}}$ 来重写该方程：\n$$\nCL \\cdot (T \\cdot \\overline{C}) = T \\cdot \\overline{R_{in}}\n$$\n$$\nCL \\cdot \\overline{C} = \\overline{R_{in}}\n$$\n这个简洁的结果表明，在线性系统的稳态下，平均消除速率必须等于平均输入速率。问题要求我们设计输注方案，使得平均浓度 $\\overline{C}$ 与目标值 $\\overline{C}_{\\text{target}}$ 相匹配。因此，设计方程为：\n$$\n\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}}\n$$\n对于每种情况，我们将根据给定的 $CL$ 和 $\\overline{C}_{\\text{target}}$ 计算所需的平均输注速率，然后通过将特定波形的计算平均输注速率设置为此目标值来确定未知的输注参数。\n\n情况 $1$：方波输注\n给定：$T = 12$ h，输注持续时间 $\\tau=3$ h，$CL=5$ L/h，$\\overline{C}_{\\text{target}}=2$ mg/L。\n所需的平均输注速率为 $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 5 \\cdot 2 = 10$ mg/h。\n输注速率 $R_{in}(t)$ 在持续时间 $\\tau$ 内为常数 $r_0$，其余时间为 $0$。平均速率是单个周期内输注的总量除以周期时长：\n$\\overline{R_{in}} = \\frac{1}{T} \\int_0^T R_{in}(t) dt = \\frac{1}{T} (r_0 \\cdot \\tau) = \\frac{r_0 \\cdot 3}{12} = \\frac{r_0}{4}$。\n将 $\\overline{R_{in}}$ 的两个表达式相等：$\\frac{r_0}{4} = 10$，得出 $r_0 = 40$ mg/h。\n\n情况 $2$：三角波输注\n给定：$T=8$ h，上升持续时间 $\\tau=2$ h，$CL=4.5$ L/h，$\\overline{C}_{\\text{target}}=3$ mg/L。\n所需的平均输注速率为 $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 4.5 \\cdot 3 = 13.5$ mg/h。\n输注曲线是一个底为 $\\tau=2$ h、高为 $r_0$ 的三角形。每个周期输注的总量是这个三角形的面积，即 $\\frac{1}{2} \\cdot \\text{底} \\cdot \\text{高} = \\frac{1}{2} \\tau r_0 = \\frac{1}{2} (2) r_0 = r_0$。\n平均速率为 $\\overline{R_{in}} = \\frac{r_0}{T} = \\frac{r_0}{8}$。\n等式为：$\\frac{r_0}{8} = 13.5$，得出 $r_0 = 8 \\cdot 13.5 = 108$ mg/h。\n\n情况 $3$：带基线的正弦输注\n给定：$T=24$ h，$R_{in}(t) = b_0 + a \\sin(2\\pi t/T)$，其中 $a=10$ mg/h，$CL=4$ L/h，$\\overline{C}_{\\text{target}}=3$ mg/L。\n所需的平均输注速率为 $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 4 \\cdot 3 = 12$ mg/h。\n正弦函数在一个完整周期内的平均值为 $0$。因此，$R_{in}(t)$ 的平均值就是基线分量：\n$\\overline{R_{in}} = \\frac{1}{T} \\int_0^T (b_0 + a \\sin(2\\pi t/T)) dt = b_0$。\n等式得出未知基线：$b_0 = 12$ mg/h。振幅 $a$ 不影响平均浓度。\n\n情况 $4$：梯形输注\n给定：$T=8$ h，上升时间 $\\delta_{\\text{up}}=1$ h，平台时间 $\\tau_{\\text{on}}=4$ h，下降时间 $\\delta_{\\text{down}}=1$ h，$CL=6$ L/h，$\\overline{C}_{\\text{target}}=1.5$ mg/L。\n所需的平均输注速率为 $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 6 \\cdot 1.5 = 9$ mg/h。\n输注曲线是一个高为 $r_0$ 的梯形。输注的总量是这个梯形的面积。该面积可以通过将初始上升段（三角形）、平台段（矩形）和最终下降段（三角形）的面积相加来计算：\n面积 = $(\\frac{1}{2} \\delta_{\\text{up}} r_0) + (\\tau_{\\text{on}} r_0) + (\\frac{1}{2} \\delta_{\\text{down}} r_0) = (\\frac{1}{2} \\cdot 1 \\cdot r_0) + (4 \\cdot r_0) + (\\frac{1}{2} \\cdot 1 \\cdot r_0) = 0.5 r_0 + 4 r_0 + 0.5 r_0 = 5 r_0$。\n平均速率为 $\\overline{R_{in}} = \\frac{\\text{面积}}{T} = \\frac{5 r_0}{8}$。\n等式为：$\\frac{5 r_0}{8} = 9$，得出 $5 r_0 = 72$，所以 $r_0 = \\frac{72}{5} = 14.4$ mg/h。\n\n情况 $5$：恒定输注\n给定：$T=24$ h，$R_{in}(t) = r_0$（常数），$CL=7$ L/h，$\\overline{C}_{\\text{target}}=1.25$ mg/L。\n所需的平均输注速率为 $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 7 \\cdot 1.25 = 8.75$ mg/h。\n对于恒定输注 $R_{in}(t) = r_0$，平均速率就是 $r_0$。\n$\\overline{R_{in}} = r_0$。\n等式得出所需的恒定速率：$r_0 = 8.75$ mg/h。\n\n计算出的参数为：$r_0^{(1)} = 40.0$，$r_0^{(2)} = 108.0$，$b_0^{(3)} = 12.0$，$r_0^{(4)} = 14.4$ 和 $r_0^{(5)} = 8.75$，单位均为 mg/h。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the unknown infusion parameters for five different dosing regimens\n    to achieve a target time-average drug concentration at periodic steady-state.\n\n    The core principle used is that at periodic steady-state in a linear\n    pharmacokinetic system, the average rate of infusion equals the average\n    rate of elimination: R_in_avg = CL * C_target_avg.\n    \"\"\"\n    \n    results = []\n\n    # Case 1 (square-wave infusion):\n    # R_in_avg = (r0 * tau) / T\n    # r0 = (CL * C_target * T) / tau\n    T1 = 12.0\n    tau1 = 3.0\n    CL1 = 5.0\n    C_target1 = 2.0\n    r0_1 = (CL1 * C_target1 * T1) / tau1\n    results.append(r0_1)\n\n    # Case 2 (triangular infusion):\n    # Total infused amount per period (Area) = 0.5 * tau * r0\n    # R_in_avg = Area / T = (0.5 * tau * r0) / T\n    # r0 = (CL * C_target * T) / (0.5 * tau)\n    T2 = 8.0\n    tau2 = 2.0\n    CL2 = 4.5\n    C_target2 = 3.0\n    r0_2 = (CL2 * C_target2 * T2) / (0.5 * tau2)\n    results.append(r0_2)\n\n    # Case 3 (sinusoidal infusion with baseline):\n    # R_in_avg = b0, since the average of a sine wave over a full period is 0.\n    # b0 = CL * C_target\n    CL3 = 4.0\n    C_target3 = 3.0\n    b0_3 = CL3 * C_target3\n    results.append(b0_3)\n\n    # Case 4 (trapezoidal infusion):\n    # Total infused amount per period (Area) = Area_triangle1 + Area_rect + Area_triangle2\n    # Area = (0.5 * delta_up * r0) + (tau_on * r0) + (0.5 * delta_down * r0)\n    # Area = r0 * (0.5 * delta_up + tau_on + 0.5 * delta_down)\n    # The problem can also be viewed as a trapezoid with height r0 and parallel\n    # sides of length tau_on and (delta_up + tau_on + delta_down).\n    # Area = 0.5 * (tau_on + (delta_up + tau_on + delta_down)) * r0\n    # R_in_avg = Area / T\n    # r0 = (CL * C_target * T) / Area_factor where Area = Area_factor * r0\n    T4 = 8.0\n    delta_up4 = 1.0\n    tau_on4 = 4.0\n    delta_down4 = 1.0\n    CL4 = 6.0\n    C_target4 = 1.5\n    # Area_factor = 0.5 * delta_up4 + tau_on4 + 0.5 * delta_down4\n    Area_factor4 = 0.5 * (tau_on4 + (delta_up4 + tau_on4 + delta_down4))\n    r0_4 = (CL4 * C_target4 * T4) / Area_factor4\n    results.append(r0_4)\n\n    # Case 5 (constant infusion):\n    # R_in_avg = r0\n    # r0 = CL * C_target\n    CL5 = 7.0\n    C_target5 = 1.25\n    r0_5 = CL5 * C_target5\n    results.append(r0_5)\n\n    # The final print statement must produce only the single-line format\n    # \"[result1,result2,result3,result4,result5]\" with no other text.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在单室模型的基础上，这个实践练习将守恒原理扩展到了一个空间分布系统。我们将模拟尿素在肾脏集合管中的运输，其特性沿其长度是变化的。通过推导并求解连接段的质量平衡方程，你将学习一种为血管或肾单位等管状结构中的运输现象建模的基本技术 。",
            "id": "3878827",
            "problem": "将单个肾单位集合管建模为沿轴向坐标 $x$ 排列的一维管道，其中 $x=0$ 为入口，$x=L$ 为出口。管腔内尿素浓度用 $C(x)$ 表示，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$。该管道被划分为 $S$ 个连续的管段，索引为 $s \\in \\{1,\\dots,S\\}$，各段长度为 $\\{L_s\\}$（单位为 $\\mathrm{m}$），且满足 $\\sum_{s=1}^{S} L_s = L$。在管段 $s$ 内，体积流率 $Q_s$（单位为 $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$）为常数，膜尿素渗透性 $P_s$（单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$）为常数，单位轴向长度的表面积 $S'_s$（单位为 $\\mathrm{m}$）为常数，以及周围间质尿素浓度 $C_{\\mathrm{is},s}$（单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$）为常数。假设系统处于稳态且横截面均匀，因此任何微分控制体积内尿素质量的轴向累积为零。与周围环境的唯一交换是与跨膜浓度差成正比的跨壁通量。\n\n仅从一维控制体积中溶质的质量守恒原理以及通量与跨膜浓度差成正比的定义出发，根据所述假设推导出每个管段中 $C(x)$ 的控制方程。然后，利用 $C(x)$ 在管段界面处的逻辑连续性以及指定的入口边界浓度 $C(0)=C_{\\mathrm{in}}$，确定整个集合管的 $C(x)$。\n\n为计算目的，您必须仅在管段边界处，即在轴向位置 $x_0 = 0$、$x_1 = L_1$、$x_2 = L_1+L_2$ 等等，直到 $x_S = \\sum_{s=1}^{S} L_s$ 处，评估解。所有中间计算必须使用国际单位制（SI）进行，最终报告的浓度必须以 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ 表示，并四舍五入到 $6$ 位小数。\n\n实现一个程序，为以下每个测试用例计算并报告这些边界位置处的管腔尿素浓度列表。在所有情况下，设置 $S=3$，并对每个管段使用相同的单位长度表面积，$S'_s = 6.0 \\times 10^{-5}\\ \\mathrm{m}$ (对所有 $s$ 成立)。\n\n测试用例 1 (代表性髓质梯度)：\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 管段长度： $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$。\n- 体积流率： $Q_1 = 8.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 6.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 5.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$。\n- 渗透性： $P_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 间质浓度： $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 200.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 400.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n测试用例 2 (高流率情况)：\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 管段长度： $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$。\n- 体积流率： $Q_1 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$。\n- 渗透性： $P_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 间质浓度： $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 200.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 400.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n测试用例 3 (低渗透性，间质浓度下降)：\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n- 管段长度： $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$。\n- 体积流率： $Q_1 = 8.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 6.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 5.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$。\n- 渗透性： $P_1 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$。\n- 间质浓度： $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个测试用例，并且本身也是一个用方括号括起来的逗号分隔列表，表示轴向边界浓度 $[C(x_0), C(x_1), C(x_2), C(x_3)]$，单位为 $\\mathrm{mol}\\,\\mathrm{m}^{-3}$，每个值都四舍五入到 $6$ 位小数。例如，打印的结构必须类似于 $[[c_{0,1},c_{1,1},c_{2,1},c_{3,1}],[c_{0,2},c_{1,2},c_{2,2},c_{3,2}],[c_{0,3},c_{1,3},c_{2,3},c_{3,3}]]$，其中 $c_{i,j}$ 表示测试用例 $j$ 的第 $i$ 个边界值。",
            "solution": "该问题是生物医学系统建模中守恒定律的经典应用，特别是管状结构中的溶质输运。该问题基于质量守恒的基本原理和菲克扩散定律（近似为通量与跨膜浓度差成正比）。这些是生理学和输运现象中的标准、成熟的原理。问题提供了物理控制模型，定义了所有必要参数，并指定了初始边界条件（$C(0) = C_{\\mathrm{in}}$）和管段之间的连续性条件。这种设置可以导出一个唯一的解。\n\n### **求解推导与算法设计**\n\n问题的核心是通过应用质量守恒原理来确定管腔尿素浓度分布 $C(x)$。\n\n**1. 推导控制微分方程**\n\n考虑管道的一个微分控制体积，即位于轴向位置 $x$ 处长度为 $\\Delta x$ 的薄片。在稳态下，此体积内溶质（尿素）的累积速率为零。因此，进入该体积的质量速率必须等于离开它的质量速率。\n质量通过平流以 $Q_s C(x)$ 的速率在 $x$ 处进入控制体积。质量以两种方式离开：通过在位置 $x+\\Delta x$ 处的平流，速率为 $Q_s C(x+\\Delta x)$；以及通过跨膜壁的输运。跨壁通量为 $J_s = P_s (C(x) - C_{\\mathrm{is},s})$。微分薄片的表面积为 $S'_s \\Delta x$。\n微分体积的质量平衡方程为：\n$$\nQ_s C(x) - \\left[ Q_s C(x+\\Delta x) + P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x \\right] = 0\n$$\n整理并取 $\\Delta x \\to 0$ 的极限，我们得到管段 $s$ 内 $C(x)$ 的一阶常微分控制方程（ODE）：\n$$\nQ_s \\frac{dC}{dx} + P_s S'_s (C(x) - C_{\\mathrm{is},s}) = 0\n$$\n\n**2. 求解微分方程**\n\n这是一个线性、可分离的常微分方程。我们可以将其改写为：\n$$\n\\frac{dC}{C - C_{\\mathrm{is},s}} = -\\frac{P_s S'_s}{Q_s} dx\n$$\n设管段 $s$ 的起点和终点分别为 $x_{s-1}$ 和 $x_s$，长度为 $L_s$。在该管段上对 ODE 进行积分：\n$$\n\\int_{C(x_{s-1})}^{C(x_s)} \\frac{dC}{C - C_{\\mathrm{is},s}} = -\\int_{x_{s-1}}^{x_s} \\frac{P_s S'_s}{Q_s} dx\n$$\n$$\n\\ln\\left( \\frac{C(x_s) - C_{\\mathrm{is},s}}{C(x_{s-1}) - C_{\\mathrm{is},s}} \\right) = -\\frac{P_s S'_s L_s}{Q_s}\n$$\n对两边取指数并求解管段的出口浓度 $C(x_s)$：\n$$\nC(x_s) = C_{\\mathrm{is},s} + \\left( C(x_{s-1}) - C_{\\mathrm{is},s} \\right) \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n$$\n\n**3. 建立迭代算法**\n\n问题要求计算管段边界处的浓度值：$C(x_0), C(x_1), \\dots, C(x_S)$。\n*   我们从第一个管段起点的给定入口浓度开始：$C(x_0) = C_{\\mathrm{in}}$。\n*   由于浓度的连续性，管段 $s-1$ 的出口浓度即为管段 $s$ 的入口浓度：$C(x_{s-1})$。\n*   我们可以迭代进行。对于从 $1$ 到 $S$ 的每个管段 $s$：\n    $$\n    C(x_s) = C_{\\mathrm{is},s} + \\left( C(x_{s-1}) - C_{\\mathrm{is},s} \\right) \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n    $$\n这使我们能够逐步计算边界浓度序列 $C(x_0), C(x_1), C(x_2), \\dots, C(x_S)$。对于给定的 $S=3$ 的问题，我们将计算 $C(x_0), C(x_1), C(x_2), C(x_3)$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the urea concentration at segment boundaries in a model of a\n    nephron collecting duct for multiple test cases.\n    \"\"\"\n    \n    # Define the common parameter S_prime\n    S_prime = 6.0e-5  # m\n\n    # Define the test cases as a list of dictionaries.\n    test_cases = [\n        {\n            # Test case 1 (representative medullary gradient)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [8.0e-13, 6.0e-13, 5.0e-13],\n            \"P_s\": [1.0e-6, 1.0e-5, 1.0e-4],\n            \"C_is_s\": [50.0, 200.0, 400.0]\n        },\n        {\n            # Test case 2 (high-flow regime)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [2.0e-12, 2.0e-12, 2.0e-12],\n            \"P_s\": [1.0e-6, 1.0e-5, 1.0e-4],\n            \"C_is_s\": [50.0, 200.0, 400.0]\n        },\n        {\n            # Test case 3 (low-permeability, declining interstitial)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [8.0e-13, 6.0e-13, 5.0e-13],\n            \"P_s\": [1.0e-7, 1.0e-7, 1.0e-7],\n            \"C_is_s\": [50.0, 50.0, 50.0]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        C_in = case[\"C_in\"]\n        L_s = case[\"L_s\"]\n        Q_s = case[\"Q_s\"]\n        P_s = case[\"P_s\"]\n        C_is_s = case[\"C_is_s\"]\n        \n        # Number of segments\n        S = len(L_s)\n        \n        # List to store concentrations at boundaries [C(x0), C(x1), ..., C(xS)]\n        boundary_concentrations = [C_in]\n        \n        current_C = C_in\n        \n        # Iterate through each segment to calculate the outlet concentration\n        for s in range(S):\n            L = L_s[s]\n            Q = Q_s[s]\n            P = P_s[s]\n            C_is = C_is_s[s]\n            \n            # The inlet concentration for this segment is the outlet of the previous one\n            C_in_segment = current_C\n            \n            # Dimensionless exponent k = (P * S' * L) / Q\n            k = (P * S_prime * L) / Q\n            \n            # Calculate the outlet concentration for the current segment\n            C_out_segment = C_is + (C_in_segment - C_is) * np.exp(-k)\n            \n            # Store the result and update the current concentration for the next iteration\n            boundary_concentrations.append(C_out_segment)\n            current_C = C_out_segment\n        \n        all_results.append(boundary_concentrations)\n\n    # Format the final output string as per the problem specification\n    # [[c_0,1,c_1,1,...],[c_0,2,c_1,2,...],...] with 6 decimal places.\n    \n    # A list to hold string representations of each test case's results\n    inner_lists_str = []\n    \n    for result_list in all_results:\n        # Format each concentration to 6 decimal places\n        rounded_res = [f\"{c:.6f}\" for c in result_list]\n        # Join the numbers with commas and enclose in brackets\n        inner_str = f\"[{','.join(rounded_res)}]\"\n        inner_lists_str.append(inner_str)\n        \n    # Join the inner lists with commas and enclose in outer brackets\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "我们最后的实践练习探讨了一个当理论模型与计算现实相遇时的关键挑战。我们将研究一种求解守恒律的常用数值方法，如何会因为一种称为“数值扩散”的人为效应而矛盾地无法保持物质总量的守恒。这个高级练习强调了分析数值工具以确保计算模型忠实地代表基本物理原理的重要性 。",
            "id": "3878823",
            "problem": "考虑一个灌注组织的一维毛细血管段，其被建模为一根长度为 $L$、恒定横截面积为 $A$ 的管道，以恒定的轴向速度 $u$ 平流输运浓度为 $c(x,t)$ 的稀释非反应性溶质。管腔内溶质的控制性守恒律为连续性方程 $\\frac{\\partial c}{\\partial t} + u\\frac{\\partial c}{\\partial x} = 0$，其中 $x=L$ 处为流出边界。使用一个包含 $N$ 个宽度为 $\\Delta x = L/N$ 的控制体的均匀有限体积网格，并通过带有迎风数值通量的前向欧拉步长在时间上对半离散更新进行近似。令 Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = u \\Delta t / \\Delta x$。\n\n假设初始管腔浓度向出口处呈斜坡式下降，以模拟一个陡峭的冲刷前缘：\n- 对于 $0 \\le x \\le L - \\delta$，有 $c(x,0) = c_{0}$，\n- 对于 $L - \\delta \\le x \\le L$，有 $c(x,0) = c_{0} \\,(L - x)/\\delta$，\n其中 $c$ 是连续的，且 $c(L,0)=0$。\n\n按如下方式处理迎风格式的数值扩散对全局质量的单步主阶效应：将迎风离散格式视为求解一个出现了伪扩散项的修正偏微分方程，并假设在单个时间步长 $\\Delta t$ 内，出口梯度与其初始值保持相等，且由于 $x=0$ 处的梯度为零，该处的入口数值扩散通量可忽略不计。利用这些假设，计算单个时间步长内完全由数值扩散引起的离散全局质量损失。\n\n使用以下参数值：\n- $L = 1.0 \\times 10^{-2}\\ \\text{m}$，\n- $A = 1.0 \\times 10^{-6}\\ \\text{m}^{2}$，\n- $u = 1.0 \\times 10^{-3}\\ \\text{m}\\,\\text{s}^{-1}$，\n- $N = 100$，因此 $\\Delta x = L/N$，\n- $\\lambda = 0.60$，\n- $\\Delta t = \\lambda \\Delta x / u$，\n- $c_{0} = 1.0\\ \\text{mmol}\\,\\text{m}^{-3}$，\n- $\\delta = 5.0 \\times 10^{-4}\\ \\text{m}$。\n\n仅从守恒律和离散迎风通量出发，推导该格式所引起的主阶数值扩散系数，然后评估由相关的出口扩散通量所导致的单步质量差异。以 $\\text{mmol}$ 为单位表示最终的质量差异，并将您的答案四舍五入至三位有效数字。此外，简要解释此数值扩散对灌注模型中守恒性的影响，并区分流出边界条件下的局部守恒和全局守恒。",
            "solution": "该问题要求计算在一维平流方程上应用迎风有限体积格式所产生的数值扩散在单个时间步长内造成的全局质量损失。首先，对问题进行验证，以确保其科学上合理、适定且客观。所有有效性条件均已满足。在微血管灌注的数学模型背景下，所提供的参数是一致且物理上合理的。因此，我们可以着手求解。\n\n求解过程包括三个主要步骤：\n1.  推导前向欧拉、迎风半离散格式的修正偏微分方程 (MPDE)，以确定主阶数值扩散项及其系数 $K_{num}$。\n2.  使用 MPDE 为域内总溶质质量的变化率建立表达式，并识别出由跨越区域边界的伪数值扩散所引起的组分。\n3.  使用给定的初始条件和参数值，评估在单个时间步长 $\\Delta t$ 内的此质量损失。\n\n**1. 数值扩散系数的推导**\n\n控制物理方程是浓度为 $c(x,t)$ 的溶质以恒定速度 $u$ 运动的一维平流方程：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0\n$$\n该区域被离散为宽度为 $\\Delta x$ 的有限体积。对于单元 $i$，使用迎风通量（对于 $u > 0$，界面 $i+1/2$ 处的通量取决于上游单元 $i$）的半离散方程为：\n$$\n\\frac{d c_i}{d t} = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = -\\frac{u c_i - u c_{i-1}}{\\Delta x}\n$$\n应用时间步长为 $\\Delta t$ 的前向欧拉法进行时间积分：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = -u \\frac{c_i^n - c_{i-1}^n}{\\Delta x}\n$$\n其中 $c_i^n$ 是在时间步 $n$ 时单元 $i$ 中的浓度。\n我们在点 $(x_i, t_n)$ 附近对离散方程中的各项进行泰勒级数展开。经过代数运算，并用 $c_{tt} \\approx u^2 c_{xx}$ 代替时间导数，我们得到修正偏微分方程 (MPDE)：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right) \\frac{\\partial^2 c}{\\partial x^2} + \\dots = \\frac{u \\Delta x}{2} (1 - \\lambda) \\frac{\\partial^2 c}{\\partial x^2} + \\dots\n$$\n其中 Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = u \\Delta t / \\Delta x$。主阶误差项具有扩散项的形式。因此，数值扩散系数为：\n$$\nK_{num} = \\frac{u \\Delta x}{2} (1 - \\lambda)\n$$\n\n**2. 质量损失的公式化**\n\n毛细血管腔内溶质的总质量为 $M(t) = \\int_0^L A c(x,t) dx$。通过在整个区域长度上对 MPDE进行积分，可以得到总质量的变化率：\n$$\n\\frac{dM}{dt} = A \\int_0^L \\frac{\\partial c}{\\partial t} dx = A \\int_0^L \\left( -u \\frac{\\partial c}{\\partial x} + K_{num} \\frac{\\partial^2 c}{\\partial x^2} \\right) dx\n$$\n$$\n\\frac{dM}{dt} = A \\left[ -u c(x,t) + K_{num} \\frac{\\partial c}{\\partial x} \\right]_0^L\n$$\n$$\n\\frac{dM}{dt} = \\underbrace{A [u c(0,t) - u c(L,t)]}_{\\text{物理平流通量}} + \\underbrace{A \\left[ K_{num} \\frac{\\partial c}{\\partial x}\\bigg|_{x=L} - K_{num} \\frac{\\partial c}{\\partial x}\\bigg|_{x=0} \\right]}_{\\text{伪扩散通量}}\n$$\n问题要求计算完全由数值扩散引起的全局质量损失。这对应于第二项。由数值扩散引起的质量变化率为：\n$$\n\\dot{M}_{num} = A K_{num} \\left( \\frac{\\partial c}{\\partial x}\\bigg|_{x=L} - \\frac{\\partial c}{\\partial x}\\bigg|_{x=0} \\right)\n$$\n我们应用问题的假设：入口扩散通量可以忽略 ($\\frac{\\partial c}{\\partial x}\\big|_{x=0} = 0$)，并且出口梯度等于其初始值。根据给定的初始条件 $c(x,0) = c_{0} (L - x)/\\delta$ 对于 $L - \\delta \\le x \\le L$，我们得到 $\\frac{\\partial c}{\\partial x}\\big|_{x=L, t=0} = -c_0/\\delta$。\n$$\n\\dot{M}_{num} = A K_{num} \\left( -\\frac{c_0}{\\delta} - 0 \\right) = -\\frac{A K_{num} c_0}{\\delta}\n$$\n负号表示域内质量的损失。在单个时间步长 $\\Delta t$ 内的总质量损失近似为：\n$$\n\\Delta M_{loss, num} = |\\dot{M}_{num}| \\Delta t = \\frac{A K_{num} c_0 \\Delta t}{\\delta}\n$$\n\n**3. 数值计算**\n\n现在我们代入给定的参数值：\n- $L = 1.0 \\times 10^{-2}\\ \\text{m}$\n- $A = 1.0 \\times 10^{-6}\\ \\text{m}^{2}$\n- $u = 1.0 \\times 10^{-3}\\ \\text{m}\\,\\text{s}^{-1}$\n- $N = 100 \\implies \\Delta x = 1.0 \\times 10^{-4}\\ \\text{m}$\n- $\\lambda = 0.60$\n- $c_{0} = 1.0\\ \\text{mmol}\\,\\text{m}^{-3}$\n- $\\delta = 5.0 \\times 10^{-4}\\ \\text{m}$\n- $\\Delta t = \\lambda \\Delta x / u = 6.0 \\times 10^{-2}\\ \\text{s}$\n\n首先，我们计算数值扩散系数 $K_{num}$：\n$$\nK_{num} = \\frac{(1.0 \\times 10^{-3}) (1.0 \\times 10^{-4})}{2} (1 - 0.60) = 2.0 \\times 10^{-8}\\ \\text{m}^2\\,\\text{s}^{-1}\n$$\n现在，我们计算单个时间步长内的总质量损失：\n$$\n\\Delta M_{loss, num} = \\frac{A K_{num} c_0 \\Delta t}{\\delta} = \\frac{(1.0 \\times 10^{-6}\\ \\text{m}^2) (2.0 \\times 10^{-8}\\ \\text{m}^2\\,\\text{s}^{-1}) (1.0\\ \\text{mmol}\\,\\text{m}^{-3}) (6.0 \\times 10^{-2}\\ \\text{s})}{5.0 \\times 10^{-4}\\ \\text{m}}\n$$\n$$\n\\Delta M_{loss, num} = \\frac{1.2 \\times 10^{-15}}{5.0 \\times 10^{-4}}\\ \\text{mmol} = 2.4 \\times 10^{-12}\\ \\text{mmol}\n$$\n按要求四舍五入至三位有效数字：\n$$\n\\Delta M_{loss, num} = 2.40 \\times 10^{-12}\\ \\text{mmol}\n$$\n\n**对灌注模型中守恒性的影响**\n\n数值扩散的概念对灌注计算模型中的守恒性具有重要影响。区分局部和全局守恒性质至关重要。\n\n有限体积格式根据其构造是局部守恒的。任何给定控制体内的质量变化都与其各面上的数值通量之和精确平衡。质量从一个单元完美地转移到其相邻单元，而不会在离散区域的内部被人为地创造或销毁。\n\n然而，全局守恒关系到整个计算域内的总质量。总质量的变化应仅由穿过外部边界的物理通量决定。上述分析表明，一阶迎风格式实际上求解的是一个包含伪扩散项的修正方程。这导致了一个人为的扩散通量 $J_{num} = -K_{num} \\partial c/\\partial x$。在浓度梯度非零的流出边界处（例如当一个陡峭的前缘离开区域时），这将产生一个非零的伪通量 $J_{num}(L,t)$。该通量表现为一种非物理性的质量从区域中泄漏。因此，尽管该格式在单元之间是完全守恒的（局部守恒），但在有流出的系统中，它无法保持总质量守恒（全局不守恒）。这导致对总溶质质量的系统性低估，在追踪物质输送或冲刷过程的模型中，这可能是一个重要的误差来源。通常需要使用高阶数值格式来减小这种数值扩散的量级，并改善全局质量守恒性。",
            "answer": "$$ \\boxed{2.40 \\times 10^{-12}} $$"
        }
    ]
}