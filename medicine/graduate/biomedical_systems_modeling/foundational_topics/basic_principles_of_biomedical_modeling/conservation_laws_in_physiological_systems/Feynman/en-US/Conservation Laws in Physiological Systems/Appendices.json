{
    "hands_on_practices": [
        {
            "introduction": "One of the most powerful applications of conservation laws in physiology is in pharmacokinetics, the study of how drugs move through the body. This first practice applies the principle of mass conservation to a simplified whole-body model to design drug dosing strategies. By analyzing the system at a periodic steady-state, you will discover an elegant and powerful relationship between the average drug infusion rate and the average concentration, a cornerstone of modern therapeutic design .",
            "id": "3878824",
            "problem": "A single well-mixed central physiological compartment with volume $V$ and linear elimination characterized by clearance $CL$ is supplied by a periodic infusion input $R_{in}(t)$ that repeats every period $T$. Let the central compartment concentration be $C(t)$ and its amount be $A(t)=V\\,C(t)$. The governing conservation of mass principle implies a balance between inflow and outflow in the central compartment, resulting in an ordinary differential equation (ODE) of the form $dA/dt = R_{in}(t) - \\text{(elimination rate)}$ in units of mass per unit time. Assume elimination is proportional to $C(t)$ through $CL$, so that the elimination rate equals $CL\\,C(t)$.\n\nDesign the dosing regimen by choosing the unknown infusion parameter(s) that determine the amplitude or baseline of $R_{in}(t)$ so that the periodic steady-state time-average of $C(t)$ over one period equals a prescribed target $\\overline{C}_{\\text{target}}$. Angles appearing in trigonometric functions must be interpreted in radians. All physical quantities use the following units: $CL$ in liters per hour (L/h), $V$ in liters (L), $T$, $\\tau$, $\\tau_{\\text{on}}$, $\\delta_{\\text{up}}$, and $\\delta_{\\text{down}}$ in hours (h), $R_{in}(t)$ and any amplitude parameters in milligrams per hour (mg/h), and $C(t)$ and $\\overline{C}_{\\text{target}}$ in milligrams per liter (mg/L). Your program must compute, for each specified waveform, the unique infusion parameter value that achieves the target time-average concentration at periodic steady-state, and output these parameter values as a single comma-separated list enclosed in square brackets, in mg/h, with no additional text.\n\nYou must use only the conservation of mass and linear elimination assumptions described above, and you must not rely on shortcut formulas beyond what follows from integrating the ODE over one period in the periodic steady-state regime. The design must be universally valid for any modern programming language and be expressed purely in mathematical and logical terms.\n\nTest Suite. For each case below, determine and report the corresponding infusion parameter in mg/h as a float. The angle unit is radians.\n\n- Case $1$ (square-wave infusion): Period $T = 12$ h, on-duration $\\tau=3$ h each period at constant rate $r_0$ (unknown), otherwise $0$; clearance $CL=5$ L/h; target average concentration $\\overline{C}_{\\text{target}}=2$ mg/L. Determine $r_0$.\n\n- Case $2$ (triangular infusion): Period $T=8$ h; during each period the infusion ramps linearly from $0$ to a peak $r_0$ (unknown) over time $\\tau=2$ h and is $0$ otherwise; clearance $CL=4.5$ L/h; target average concentration $\\overline{C}_{\\text{target}}=3$ mg/L. Determine $r_0$.\n\n- Case $3$ (sinusoidal infusion with baseline): Period $T=24$ h; infusion $R_{in}(t) = b_0 + a \\sin\\!\\big(2\\pi t/T\\big)$ with known amplitude $a=10$ mg/h and unknown baseline $b_0$; clearance $CL=4$ L/h; target average concentration $\\overline{C}_{\\text{target}}=3$ mg/L. Determine $b_0$.\n\n- Case $4$ (trapezoidal infusion): Period $T=8$ h; infusion linearly ramps up from $0$ to plateau $r_0$ (unknown) over $\\delta_{\\text{up}}=1$ h, stays at $r_0$ for $\\tau_{\\text{on}}=4$ h, then linearly ramps down from $r_0$ to $0$ over $\\delta_{\\text{down}}=1$ h, and is $0$ otherwise; clearance $CL=6$ L/h; target average concentration $\\overline{C}_{\\text{target}}=1.5$ mg/L. Determine $r_0$.\n\n- Case $5$ (constant infusion): Period $T=24$ h; infusion $R_{in}(t) = r_0$ (unknown constant); clearance $CL=7$ L/h; target average concentration $\\overline{C}_{\\text{target}}=1.25$ mg/L. Determine $r_0$.\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in mg/h, ordered as $[r_0^{(1)},r_0^{(2)},b_0^{(3)},r_0^{(4)},r_0^{(5)}]$, where superscripts indicate the case number as described above. For example, an output of the form $\\big[40.0,80.0,12.0,14.4,8.75\\big]$ would be valid if those were the correct computed infusion parameters in mg/h.",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in the principles of linear pharmacokinetics, is well-posed with sufficient information to determine a unique solution for each case, and is expressed in objective, formal language. The central task requires the application of the conservation of mass principle under periodic steady-state conditions, a fundamental concept in biomedical systems modeling. The mention of the compartment volume $V$ without providing its value does not render the problem incomplete, as this parameter proves to be unnecessary for determining the relationship between the time-averaged infusion rate and the time-averaged concentration.\n\nThe solution proceeds by first deriving the general relationship between the average infusion rate and the average drug concentration at periodic steady-state. This relationship will then be applied to each of the five specific dosing regimens.\n\nThe governing ordinary differential equation for the amount of substance $A(t)$ in the compartment is given by the principle of mass balance:\n$$\n\\frac{dA(t)}{dt} = R_{in}(t) - R_{out}(t)\n$$\nwhere $R_{in}(t)$ is the rate of infusion and $R_{out}(t)$ is the rate of elimination. The problem states that elimination is linear, characterized by a clearance $CL$, such that the elimination rate is $R_{out}(t) = CL \\cdot C(t)$. The amount $A(t)$ is related to the concentration $C(t)$ and volume $V$ by $A(t) = V \\cdot C(t)$. Substituting these into the mass balance equation yields:\n$$\n\\frac{d(V \\cdot C(t))}{dt} = R_{in}(t) - CL \\cdot C(t)\n$$\nSince the volume $V$ is constant, we have:\n$$\nV \\frac{dC(t)}{dt} = R_{in}(t) - CL \\cdot C(t)\n$$\nThe problem specifies that the system is at a periodic steady-state. This means that the concentration profile is periodic with period $T$, i.e., $C(t+T) = C(t)$ for all $t$. Consequently, the amount in the compartment is also periodic, $A(t+T) = A(t)$.\n\nTo find the relationship between the averages, we integrate the mass balance equation for $A(t)$ over one full period, from an arbitrary time $t_0$ to $t_0+T$:\n$$\n\\int_{t_0}^{t_0+T} \\frac{dA(t)}{dt} dt = \\int_{t_0}^{t_0+T} \\left( R_{in}(t) - CL \\cdot C(t) \\right) dt\n$$\nThe left-hand side, by the fundamental theorem of calculus, is $A(t_0+T) - A(t_0)$. Due to the periodic steady-state condition, $A(t_0+T) = A(t_0)$, so the left-hand side evaluates to $0$.\n$$\n0 = \\int_{t_0}^{t_0+T} R_{in}(t) dt - \\int_{t_0}^{t_0+T} CL \\cdot C(t) dt\n$$\nRearranging and noting that $CL$ is a constant, we get:\n$$\nCL \\int_{t_0}^{t_0+T} C(t) dt = \\int_{t_0}^{t_0+T} R_{in}(t) dt\n$$\nThe definition of the time-average of a function $f(t)$ over a period $T$ is $\\overline{f} = \\frac{1}{T} \\int_{t_0}^{t_0+T} f(t) dt$. Applying this definition, we can rewrite the equation in terms of the time-average concentration $\\overline{C}$ and time-average infusion rate $\\overline{R_{in}}$:\n$$\nCL \\cdot (T \\cdot \\overline{C}) = T \\cdot \\overline{R_{in}}\n$$\n$$\nCL \\cdot \\overline{C} = \\overline{R_{in}}\n$$\nThis elegant result demonstrates that at steady-state in a linear system, the average elimination rate must equal the average input rate. The problem requires us to design the infusion regimen such that the average concentration $\\overline{C}$ matches a target value, $\\overline{C}_{\\text{target}}$. Therefore, the design equation is:\n$$\n\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}}\n$$\nFor each case, we will calculate the required average infusion rate from the given $CL$ and $\\overline{C}_{\\text{target}}$, then determine the unknown infusion parameter by setting the calculated average infusion rate for the specific waveform equal to this target value.\n\nCase $1$: Square-wave infusion\nGiven: $T = 12$ h, infusion on-duration $\\tau=3$ h, $CL=5$ L/h, $\\overline{C}_{\\text{target}}=2$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 5 \\cdot 2 = 10$ mg/h.\nThe infusion rate $R_{in}(t)$ is a constant $r_0$ for a duration $\\tau$ and $0$ otherwise. The average rate is the total amount infused over one period divided by the period duration:\n$\\overline{R_{in}} = \\frac{1}{T} \\int_0^T R_{in}(t) dt = \\frac{1}{T} (r_0 \\cdot \\tau) = \\frac{r_0 \\cdot 3}{12} = \\frac{r_0}{4}$.\nEquating the two expressions for $\\overline{R_{in}}$: $\\frac{r_0}{4} = 10$, which gives $r_0 = 40$ mg/h.\n\nCase $2$: Triangular infusion\nGiven: $T=8$ h, ramp duration $\\tau=2$ h, $CL=4.5$ L/h, $\\overline{C}_{\\text{target}}=3$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 4.5 \\cdot 3 = 13.5$ mg/h.\nThe infusion profile is a triangle with base $\\tau=2$ h and height $r_0$. The total amount infused per period is the area of this triangle, which is $\\frac{1}{2} \\cdot \\text{base} \\cdot \\text{height} = \\frac{1}{2} \\tau r_0 = \\frac{1}{2} (2) r_0 = r_0$.\nThe average rate is $\\overline{R_{in}} = \\frac{r_0}{T} = \\frac{r_0}{8}$.\nEquating yields: $\\frac{r_0}{8} = 13.5$, which gives $r_0 = 8 \\cdot 13.5 = 108$ mg/h.\n\nCase $3$: Sinusoidal infusion with baseline\nGiven: $T=24$ h, $R_{in}(t) = b_0 + a \\sin(2\\pi t/T)$ with $a=10$ mg/h, $CL=4$ L/h, $\\overline{C}_{\\text{target}}=3$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 4 \\cdot 3 = 12$ mg/h.\nThe average of a sinusoidal function over a full period is $0$. Thus, the average of $R_{in}(t)$ is simply the baseline component:\n$\\overline{R_{in}} = \\frac{1}{T} \\int_0^T (b_0 + a \\sin(2\\pi t/T)) dt = b_0$.\nEquating gives the unknown baseline: $b_0 = 12$ mg/h. The amplitude $a$ does not affect the average concentration.\n\nCase $4$: Trapezoidal infusion\nGiven: $T=8$ h, ramp-up $\\delta_{\\text{up}}=1$ h, plateau $\\tau_{\\text{on}}=4$ h, ramp-down $\\delta_{\\text{down}}=1$ h, $CL=6$ L/h, $\\overline{C}_{\\text{target}}=1.5$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 6 \\cdot 1.5 = 9$ mg/h.\nThe infusion profile is a trapezoid with height $r_0$. The total amount infused is the area of this trapezoid. The area can be calculated by summing the areas of the initial ramp (triangle), the plateau (rectangle), and the final ramp (triangle):\nArea = $(\\frac{1}{2} \\delta_{\\text{up}} r_0) + (\\tau_{\\text{on}} r_0) + (\\frac{1}{2} \\delta_{\\text{down}} r_0) = (\\frac{1}{2} \\cdot 1 \\cdot r_0) + (4 \\cdot r_0) + (\\frac{1}{2} \\cdot 1 \\cdot r_0) = 0.5 r_0 + 4 r_0 + 0.5 r_0 = 5 r_0$.\nThe average rate is $\\overline{R_{in}} = \\frac{\\text{Area}}{T} = \\frac{5 r_0}{8}$.\nEquating yields: $\\frac{5 r_0}{8} = 9$, which gives $5 r_0 = 72$, so $r_0 = \\frac{72}{5} = 14.4$ mg/h.\n\nCase $5$: Constant infusion\nGiven: $T=24$ h, $R_{in}(t) = r_0$ (constant), $CL=7$ L/h, $\\overline{C}_{\\text{target}}=1.25$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 7 \\cdot 1.25 = 8.75$ mg/h.\nFor a constant infusion $R_{in}(t) = r_0$, the average rate is simply $r_0$.\n$\\overline{R_{in}} = r_0$.\nEquating gives the required constant rate: $r_0 = 8.75$ mg/h.\n\nThe computed parameters are: $r_0^{(1)} = 40.0$, $r_0^{(2)} = 108.0$, $b_0^{(3)} = 12.0$, $r_0^{(4)} = 14.4$, and $r_0^{(5)} = 8.75$, all in units of mg/h.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the unknown infusion parameters for five different dosing regimens\n    to achieve a target time-average drug concentration at periodic steady-state.\n\n    The core principle used is that at periodic steady-state in a linear\n    pharmacokinetic system, the average rate of infusion equals the average\n    rate of elimination: R_in_avg = CL * C_target_avg.\n    \"\"\"\n    \n    results = []\n\n    # Case 1 (square-wave infusion):\n    # R_in_avg = (r0 * tau) / T\n    # r0 = (CL * C_target * T) / tau\n    T1 = 12.0\n    tau1 = 3.0\n    CL1 = 5.0\n    C_target1 = 2.0\n    r0_1 = (CL1 * C_target1 * T1) / tau1\n    results.append(r0_1)\n\n    # Case 2 (triangular infusion):\n    # Total infused amount per period (Area) = 0.5 * tau * r0\n    # R_in_avg = Area / T = (0.5 * tau * r0) / T\n    # r0 = (CL * C_target * T) / (0.5 * tau)\n    T2 = 8.0\n    tau2 = 2.0\n    CL2 = 4.5\n    C_target2 = 3.0\n    r0_2 = (CL2 * C_target2 * T2) / (0.5 * tau2)\n    results.append(r0_2)\n\n    # Case 3 (sinusoidal infusion with baseline):\n    # R_in_avg = b0, since the average of a sine wave over a full period is 0.\n    # b0 = CL * C_target\n    CL3 = 4.0\n    C_target3 = 3.0\n    b0_3 = CL3 * C_target3\n    results.append(b0_3)\n\n    # Case 4 (trapezoidal infusion):\n    # Total infused amount per period (Area) = Area_triangle1 + Area_rect + Area_triangle2\n    # Area = (0.5 * delta_up * r0) + (tau_on * r0) + (0.5 * delta_down * r0)\n    # Area = r0 * (0.5 * delta_up + tau_on + 0.5 * delta_down)\n    # The problem can also be viewed as a trapezoid with height r0 and parallel\n    # sides of length tau_on and (delta_up + tau_on + delta_down).\n    # Area = 0.5 * (tau_on + (delta_up + tau_on + delta_down)) * r0\n    # R_in_avg = Area / T\n    # r0 = (CL * C_target * T) / Area_factor where Area = Area_factor * r0\n    T4 = 8.0\n    delta_up4 = 1.0\n    tau_on4 = 4.0\n    delta_down4 = 1.0\n    CL4 = 6.0\n    C_target4 = 1.5\n    # Area_factor = 0.5 * delta_up4 + tau_on4 + 0.5 * delta_down4\n    Area_factor4 = 0.5 * (tau_on4 + (delta_up4 + tau_on4 + delta_down4))\n    r0_4 = (CL4 * C_target4 * T4) / Area_factor4\n    results.append(r0_4)\n\n    # Case 5 (constant infusion):\n    # R_in_avg = r0\n    # r0 = CL * C_target\n    CL5 = 7.0\n    C_target5 = 1.25\n    r0_5 = CL5 * C_target5\n    results.append(r0_5)\n\n    # The final print statement must produce only the single-line format\n    # \"[result1,result2,result3,result4,result5]\" with no other text.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from a well-mixed, lumped-parameter model, our next practice explores conservation laws in a spatially-distributed system. We will model a kidney collecting duct as a one-dimensional tube, applying mass balance to an infinitesimal control volume to derive a differential equation governing solute concentration. This exercise demonstrates how to translate the abstract principle of conservation into a predictive mathematical model that captures continuous changes along a physiological pathway, a critical skill for modeling organ-level transport phenomena .",
            "id": "3878827",
            "problem": "A single-nephron collecting duct is modeled as a one-dimensional tube aligned along an axial coordinate $x$ with $x=0$ at the inlet and $x=L$ at the outlet. The luminal urea concentration is denoted by $C(x)$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. The tube is partitioned into $S$ contiguous segments indexed by $s \\in \\{1,\\dots,S\\}$ with lengths $\\{L_s\\}$ in $\\mathrm{m}$ such that $\\sum_{s=1}^{S} L_s = L$. Within segment $s$, the volumetric flow rate $Q_s$ in $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$ is constant, the membrane urea permeability $P_s$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ is constant, the surface area per unit axial length $S'_s$ in $\\mathrm{m}$ is constant, and the surrounding interstitial urea concentration $C_{\\mathrm{is},s}$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ is constant. Assume steady state and uniform cross-section so that axial accumulation of urea mass within any differential control volume is zero. The only exchange with the surroundings is a transmural flux proportional to the transmembrane concentration difference.\n\nStarting solely from the conservation of mass principle for a solute in a one-dimensional control volume and the definition of flux proportional to a concentration difference across a membrane, derive the governing equation for $C(x)$ in each segment under the stated assumptions. Then, using logical continuity of $C(x)$ at segment interfaces and the specified inlet boundary concentration $C(0)=C_{\\mathrm{in}}$, determine $C(x)$ along the entire duct.\n\nFor computational purposes, you must evaluate the solution only at the segment boundaries, that is, at axial positions $x_0 = 0$, $x_1 = L_1$, $x_2 = L_1+L_2$, and so on up to $x_S = \\sum_{s=1}^{S} L_s$. All intermediate calculations must be performed in International System of Units (SI), and the final reported concentrations must be expressed in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, rounded to $6$ decimal places.\n\nImplement a program that computes and reports the list of luminal urea concentrations at these boundary positions for each of the following test cases. In all cases, set $S=3$ and use the same surface area per unit length for each segment, $S'_s = 6.0 \\times 10^{-5}\\ \\mathrm{m}$ for all $s$.\n\nTest case $1$ (representative medullary gradient):\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Segment lengths: $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$.\n- Volumetric flows: $Q_1 = 8.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 6.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 5.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n- Permeabilities: $P_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Interstitial concentrations: $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 200.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 400.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nTest case $2$ (high-flow regime):\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Segment lengths: $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$.\n- Volumetric flows: $Q_1 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n- Permeabilities: $P_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Interstitial concentrations: $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 200.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 400.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nTest case $3$ (low-permeability, declining interstitial):\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Segment lengths: $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$.\n- Volumetric flows: $Q_1 = 8.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 6.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 5.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n- Permeabilities: $P_1 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Interstitial concentrations: $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a bracketed comma-separated list of the axial boundary concentrations $[C(x_0), C(x_1), C(x_2), C(x_3)]$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, each rounded to $6$ decimal places. For example, the printed structure must look like $[[c_{0,1},c_{1,1},c_{2,1},c_{3,1}],[c_{0,2},c_{1,2},c_{2,2},c_{3,2}],[c_{0,3},c_{1,3},c_{2,3},c_{3,3}]]$ where $c_{i,j}$ denotes the $i$-th boundary value for test case $j$.",
            "solution": "The user wants me to solve a mass transport problem in a model of a kidney nephron's collecting duct.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n\n*   **System Geometry**: A one-dimensional tube along an axial coordinate $x$, from $x=0$ (inlet) to $x=L$ (outlet). The tube is partitioned into $S$ contiguous segments.\n*   **Variables**:\n    *   $C(x)$: Luminal urea concentration ($\\mathrm{mol}\\,\\mathrm{m}^{-3}$).\n*   **Segment-wise Constants ($s \\in \\{1,\\dots,S\\}$)**:\n    *   $L_s$: Length of segment $s$ ($\\mathrm{m}$). Condition: $\\sum_{s=1}^{S} L_s = L$.\n    *   $Q_s$: Volumetric flow rate in segment $s$ ($\\mathrm{m}^3\\,\\mathrm{s}^{-1}$).\n    *   $P_s$: Membrane urea permeability in segment $s$ ($\\mathrm{m}\\,\\mathrm{s}^{-1}$).\n    *   $S'_s$: Surface area per unit axial length in segment $s$ ($\\mathrm{m}$).\n    *   $C_{\\mathrm{is},s}$: Surrounding interstitial urea concentration in segment $s$ ($\\mathrm{mol}\\,\\mathrm{m}^{-3}$).\n*   **Assumptions**:\n    *   Steady state: Axial accumulation of mass in any differential volume is zero.\n    *   Uniform cross-section.\n    *   Transmural flux is the only exchange with surroundings.\n    *   Flux is proportional to the transmembrane concentration difference: $J \\propto (C(x) - C_{\\mathrm{is}})$.\n*   **Boundary and Continuity Conditions**:\n    *   Inlet boundary condition: $C(0) = C_{\\mathrm{in}}$.\n    *   Logical continuity of $C(x)$ at segment interfaces.\n*   **Computational Task**:\n    *   Evaluate $C(x)$ at segment boundaries: $x_0 = 0$, $x_1 = L_1$, $x_2 = L_1+L_2$, ..., $x_S = \\sum_{s=1}^{S} L_s$.\n    - All units are SI. Final results in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, rounded to $6$ decimal places.\n*   **Test Case Parameters**:\n    *   Common for all cases: $S=3$, $S'_s = 6.0 \\times 10^{-5}\\ \\mathrm{m}$ for all $s$.\n    *   **Test Case 1**:\n        *   $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n        *   $L = [0.005, 0.003, 0.005]\\ \\mathrm{m}$.\n        *   $Q = [8.0 \\times 10^{-13}, 6.0 \\times 10^{-13}, 5.0 \\times 10^{-13}]\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n        *   $P = [1.0 \\times 10^{-6}, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-4}]\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n        *   $C_{\\mathrm{is}} = [50.0, 200.0, 400.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    *   **Test Case 2**:\n        *   $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n        *   $L = [0.005, 0.003, 0.005]\\ \\mathrm{m}$.\n        *   $Q = [2.0 \\times 10^{-12}, 2.0 \\times 10^{-12}, 2.0 \\times 10^{-12}]\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n        *   $P = [1.0 \\times 10^{-6}, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-4}]\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n        *   $C_{\\mathrm{is}} = [50.0, 200.0, 400.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    *   **Test Case 3**:\n        *   $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n        *   $L = [0.005, 0.003, 0.005]\\ \\mathrm{m}$.\n        *   $Q = [8.0 \\times 10^{-13}, 6.0 \\times 10^{-13}, 5.0 \\times 10^{-13}]\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n        *   $P = [1.0 \\times 10^{-7}, 1.0 \\times 10^{-7}, 1.0 \\times 10^{-7}]\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n        *   $C_{\\mathrm{is}} = [50.0, 50.0, 50.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is a classic application of conservation laws in biomedical systems modeling, specifically solute transport in a tubular structure.\n1.  **Scientifically Grounded**: The problem is based on the fundamental principle of conservation of mass and Fick's law of diffusion (approximated as a flux proportional to a concentration difference across a membrane). These are standard, well-established principles in physiology and transport phenomena. The model is a simplification but is not unscientific.\n2.  **Well-Posed**: The problem provides a governing physical model, defines all necessary parameters for each segment, and specifies an initial boundary condition ($C(0) = C_{\\mathrm{in}}$) and continuity conditions between segments. This setup leads to a unique solution for $C(x)$.\n3.  **Objective**: The language is precise and quantitative. All terms are defined, and the parameters are given numerically. There are no subjective or opinion-based statements.\n4.  **No other flaws detected**: The problem is not incomplete, contradictory, unrealistic (within the context of a model), or trivial. The provided parameters are dimensionally consistent and within plausible physiological ranges for single-nephron models.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be derived and implemented.\n\n### **Solution Derivation and Algorithm Design**\n\nThe core of the problem is to determine the luminal urea concentration profile $C(x)$ by applying the principle of mass conservation.\n\n**1. Derive the Governing Differential Equation**\n\nConsider a differential control volume of the tube, a slice of length $\\Delta x$ located at axial position $x$. At steady state, the rate of accumulation of solute (urea) within this volume is zero. Therefore, the rate of mass entering the volume must equal the rate of mass leaving it.\n$$\n(\\text{Rate of mass in}) - (\\text{Rate of mass out}) = 0\n$$\nMass enters the control volume at $x$ via advection (bulk flow) at a rate of $Q_s C(x)$, where the units are $(\\mathrm{m}^3\\,\\mathrm{s}^{-1}) \\cdot (\\mathrm{mol}\\,\\mathrm{m}^{-3}) = \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\n\nMass leaves the control volume in two ways:\n1.  By advection at position $x+\\Delta x$, at a rate of $Q_s C(x+\\Delta x)$.\n2.  By transmural transport (flux) across the membrane wall. The flux $J_s$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$) is proportional to the concentration difference: $J_s = P_s (C(x) - C_{\\mathrm{is},s})$. The surface area of the differential slice is $S'_s \\Delta x$. Thus, the rate of mass leaving through the wall is $J_s \\cdot (S'_s \\Delta x) = P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x$.\n\nWithin any given segment $s$, the parameters $Q_s$, $P_s$, $S'_s$, and $C_{\\mathrm{is},s}$ are constant. The mass balance equation for the differential volume is:\n$$\nQ_s C(x) - \\left[ Q_s C(x+\\Delta x) + P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x \\right] = 0\n$$\nRearranging the terms:\n$$\nQ_s (C(x) - C(x+\\Delta x)) - P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x = 0\n$$\nDividing by $\\Delta x$ and rearranging:\n$$\nQ_s \\frac{C(x+\\Delta x) - C(x)}{\\Delta x} + P_s S'_s (C(x) - C_{\\mathrm{is},s}) = 0\n$$\nTaking the limit as $\\Delta x \\to 0$, we obtain the governing first-order ordinary differential equation (ODE) for $C(x)$ within segment $s$:\n$$\nQ_s \\frac{dC}{dx} + P_s S'_s (C(x) - C_{\\mathrm{is},s}) = 0\n$$\n\n**2. Solve the Differential Equation**\n\nThis is a linear, separable ODE. We can rewrite it as:\n$$\n\\frac{dC}{C - C_{\\mathrm{is},s}} = -\\frac{P_s S'_s}{Q_s} dx\n$$\nLet's define a local coordinate system for each segment $s$. Let the global coordinate of the start of segment $s$ be $x_{s-1}$ and the end be $x_s$. The length of the segment is $L_s = x_s - x_{s-1}$. We integrate the ODE over the length of segment $s$, from $x_{s-1}$ to $x_s$. The concentration at these points are $C(x_{s-1})$ and $C(x_s)$, respectively.\n$$\n\\int_{C(x_{s-1})}^{C(x_s)} \\frac{dC}{C - C_{\\mathrm{is},s}} = -\\int_{x_{s-1}}^{x_s} \\frac{P_s S'_s}{Q_s} dx\n$$\nThe integration yields:\n$$\n\\left[ \\ln|C - C_{\\mathrm{is},s}| \\right]_{C(x_{s-1})}^{C(x_s)} = -\\frac{P_s S'_s}{Q_s} [x]_{x_{s-1}}^{x_s}\n$$\n$$\n\\ln\\left( \\frac{C(x_s) - C_{\\mathrm{is},s}}{C(x_{s-1}) - C_{\\mathrm{is},s}} \\right) = -\\frac{P_s S'_s (x_s - x_{s-1})}{Q_s} = -\\frac{P_s S'_s L_s}{Q_s}\n$$\nExponentiating both sides gives:\n$$\n\\frac{C(x_s) - C_{\\mathrm{is},s}}{C(x_{s-1}) - C_{\\mathrm{is},s}} = \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n$$\nSolving for the outlet concentration of the segment, $C(x_s)$:\n$$\nC(x_s) = C_{\\mathrm{is},s} + \\left( C(x_{s-1}) - C_{\\mathrm{is},s} \\right) \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n$$\nThe dimensionless group in the exponent, $k_s = \\frac{P_s S'_s L_s}{Q_s}$, represents the ratio of the membrane transport rate to the advective transport rate.\n\n**3. Develop the Iterative Algorithm**\n\nThe problem requires the concentration values at the segment boundaries: $C(x_0), C(x_1), \\dots, C(x_S)$.\n*   We start with the given inlet concentration at the beginning of the first segment: $C(x_0) = C_{\\mathrm{in}}$.\n*   The concentration at the end of the first segment, $C(x_1)$, is calculated using the derived formula for $s=1$:\n    $$\n    C(x_1) = C_{\\mathrm{is},1} + \\left( C(x_0) - C_{\\mathrm{is},1} \\right) \\exp\\left(-\\frac{P_1 S'_1 L_1}{Q_1}\\right)\n    $$\n*   Due to the continuity of concentration, the outlet concentration of segment $s-1$ is the inlet concentration for segment $s$: $C(x_{s-1})$.\n*   We can proceed iteratively. For each segment $s$ from $1$ to $S$:\n    $$\n    C(x_s) = C_{\\mathrm{is},s} + \\left( C(x_{s-1}) - C_{\\mathrm{is},s} \\right) \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n    $$\nThis allows us to compute the sequence of boundary concentrations $C(x_0), C(x_1), C(x_2), \\dots, C(x_S)$ step-by-step. For the given problem with $S=3$, we will compute $C(x_0), C(x_1), C(x_2), C(x_3)$.\n\n**4. Computational Implementation**\nThe algorithm will be implemented in Python for each test case.\n1.  Initialize a list of concentrations with the inlet value, `[C_in]`.\n2.  Loop through the segments from $s=1$ to $S=3$.\n3.  In each iteration, use the last calculated concentration as the input for the current segment.\n4.  Apply the derived formula to calculate the outlet concentration for the current segment.\n5.  Append the new concentration to the list.\n6.  After iterating through all segments, the list will contain all boundary concentrations.\n7.  The final numerical results are then rounded to $6$ decimal places as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the urea concentration at segment boundaries in a model of a\n    nephron collecting duct for multiple test cases.\n    \"\"\"\n    \n    # Define the common parameter S_prime\n    S_prime = 6.0e-5  # m\n\n    # Define the test cases as a list of dictionaries.\n    test_cases = [\n        {\n            # Test case 1 (representative medullary gradient)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [8.0e-13, 6.0e-13, 5.0e-13],\n            \"P_s\": [1.0e-6, 1.0e-5, 1.0e-4],\n            \"C_is_s\": [50.0, 200.0, 400.0]\n        },\n        {\n            # Test case 2 (high-flow regime)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [2.0e-12, 2.0e-12, 2.0e-12],\n            \"P_s\": [1.0e-6, 1.0e-5, 1.0e-4],\n            \"C_is_s\": [50.0, 200.0, 400.0]\n        },\n        {\n            # Test case 3 (low-permeability, declining interstitial)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [8.0e-13, 6.0e-13, 5.0e-13],\n            \"P_s\": [1.0e-7, 1.0e-7, 1.0e-7],\n            \"C_is_s\": [50.0, 50.0, 50.0]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        C_in = case[\"C_in\"]\n        L_s = case[\"L_s\"]\n        Q_s = case[\"Q_s\"]\n        P_s = case[\"P_s\"]\n        C_is_s = case[\"C_is_s\"]\n        \n        # Number of segments\n        S = len(L_s)\n        \n        # List to store concentrations at boundaries [C(x0), C(x1), ..., C(xS)]\n        boundary_concentrations = [C_in]\n        \n        current_C = C_in\n        \n        # Iterate through each segment to calculate the outlet concentration\n        for s in range(S):\n            L = L_s[s]\n            Q = Q_s[s]\n            P = P_s[s]\n            C_is = C_is_s[s]\n            \n            # The inlet concentration for this segment is the outlet of the previous one\n            C_in_segment = current_C\n            \n            # Dimensionless exponent k = (P * S' * L) / Q\n            k = (P * S_prime * L) / Q\n            \n            # Calculate the outlet concentration for the current segment\n            C_out_segment = C_is + (C_in_segment - C_is) * np.exp(-k)\n            \n            # Store the result and update the current concentration for the next iteration\n            boundary_concentrations.append(C_out_segment)\n            current_C = C_out_segment\n        \n        all_results.append(boundary_concentrations)\n\n    # Format the final output string as per the problem specification\n    # [[c_0,1,c_1,1,...],[c_0,2,c_1,2,...],...] with 6 decimal places.\n    \n    # A list to hold string representations of each test case's results\n    inner_lists_str = []\n    \n    for result_list in all_results:\n        # Format each concentration to 6 decimal places\n        rounded_res = [f\"{c:.6f}\" for c in result_list]\n        # Join the numbers with commas and enclose in brackets\n        inner_str = f\"[{','.join(rounded_res)}]\"\n        inner_lists_str.append(inner_str)\n        \n    # Join the inner lists with commas and enclose in outer brackets\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "In modern biomedical modeling, analytical solutions are rare, and we often rely on numerical methods to solve the governing conservation equations. This advanced practice confronts a critical challenge in computational modeling: the potential for numerical schemes to violate the very laws they aim to represent. You will analyze a common numerical method for fluid transport and derive the \"numerical diffusion\" it introduces, quantifying its effect on global mass conservation and learning why a locally conservative scheme is not guaranteed to be globally conservative .",
            "id": "3878823",
            "problem": "Consider a one-dimensional capillary segment perfusing tissue, modeled as a conduit of length $L$ and constant cross-sectional area $A$, transporting a dilute, nonreactive solute of concentration $c(x,t)$ by advection at constant axial velocity $u$. The governing conservation law for solute in the lumen is the continuity equation $\\partial c / \\partial t + \\partial (u c)/\\partial x = 0$, with outflow at $x=L$. A uniform finite volume grid is used with $N$ control volumes of width $\\Delta x = L/N$, and the semi-discrete update is approximated in time by a forward-Euler step with an upwind numerical flux. Let the Courant–Friedrichs–Lewy (CFL) number be $\\lambda = u \\Delta t / \\Delta x$.\n\nAssume the initial lumen concentration is a ramp down to the outlet to mimic a steep washout front:\n- $c(x,0) = c_{0}$ for $0 \\le x \\le L - \\delta$,\n- $c(x,0) = c_{0} \\,(L - x)/\\delta$ for $L - \\delta \\le x \\le L$,\nwith $c$ continuous and $c(L,0)=0$.\n\nTreat the one-step, leading-order effect of the upwind scheme’s numerical diffusion on global mass as follows: regard the upwind discretization as solving a modified partial differential equation in which a spurious diffusion term appears, and assume the outlet gradient remains equal to its initial value over the single time step $\\Delta t$, and that the inlet numerical diffusive flux at $x=0$ is negligible due to the zero gradient there. Using these assumptions, compute the discrete global mass loss over one time step attributable solely to numerical diffusion.\n\nUse the parameter values:\n- $L = 1.0 \\times 10^{-2}\\ \\text{m}$,\n- $A = 1.0 \\times 10^{-6}\\ \\text{m}^{2}$,\n- $u = 1.0 \\times 10^{-3}\\ \\text{m}\\,\\text{s}^{-1}$,\n- $N = 100$ so that $\\Delta x = L/N$,\n- $\\lambda = 0.60$,\n- $\\Delta t = \\lambda \\Delta x / u$,\n- $c_{0} = 1.0\\ \\text{mmol}\\,\\text{m}^{-3}$,\n- $\\delta = 5.0 \\times 10^{-4}\\ \\text{m}$.\n\nStarting only from the conservation law and the discrete upwind flux, derive the leading-order numerical diffusion coefficient induced by the scheme and then evaluate the resulting one-step mass discrepancy due to the associated outlet diffusive flux. Express the final mass discrepancy in $\\text{mmol}$ and round your answer to three significant figures. Also, briefly explain the implications of this numerical diffusion for conservation in perfusion models, distinguishing between local and global conservation under outflow boundary conditions.",
            "solution": "The problem asks for the global mass loss over a single time step due to numerical diffusion from an upwind finite volume scheme applied to a one-dimensional advection equation. First, the problem is validated to ensure it is scientifically sound, well-posed, and objective. All conditions for validity are met. The parameters provided are consistent and physically plausible within the context of a mathematical model for microvascular perfusion. We may therefore proceed with the solution.\n\nThe solution process involves three main steps:\n1.  Derive the modified partial differential equation (MPDE) for the forward-Euler, upwind semi-discretization to identify the leading-order numerical diffusion term and its coefficient, $K_{num}$.\n2.  Use the MPDE to formulate an expression for the rate of change of total solute mass within the domain, identifying the component attributable to spurious numerical diffusion across the domain boundaries.\n3.  Evaluate this mass loss over a single time step, $\\Delta t$, using the provided initial conditions and parameter values.\n\n**1. Derivation of the Numerical Diffusion Coefficient**\n\nThe governing physical equation is the one-dimensional advection equation for a solute with concentration $c(x,t)$ at constant velocity $u$:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0\n$$\nThe domain is discretized into finite volumes of width $\\Delta x$. For a cell $i$, the semi-discrete equation using an upwind flux (for $u > 0$, the flux at interface $i+1/2$ depends on the upstream cell, $i$) is:\n$$\n\\frac{d c_i}{d t} = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = -\\frac{u c_i - u c_{i-1}}{\\Delta x}\n$$\nApplying the forward-Euler method for time integration with step $\\Delta t$:\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} = -u \\frac{c_i^n - c_{i-1}^n}{\\Delta x}\n$$\nwhere $c_i^n$ is the concentration in cell $i$ at time step $n$.\nWe perform a Taylor series expansion of the terms in the discrete equation around the point $(x_i, t_n)$, denoting $c(x_i, t_n)$ as $c$ and its partial derivatives by subscripts (e.g., $c_t, c_x, c_{xx}$):\n$$\nc_i^{n+1} = c(x_i, t_n + \\Delta t) = c + \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + O((\\Delta t)^3)\n$$\n$$\nc_{i-1}^n = c(x_i - \\Delta x, t_n) = c - \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} - \\frac{(\\Delta x)^3}{6} c_{xxx} + O((\\Delta x)^4)\n$$\nSubstituting these expansions into the discrete equation gives:\n$$\n\\frac{1}{\\Delta t} \\left( \\Delta t c_t + \\frac{(\\Delta t)^2}{2} c_{tt} + \\dots \\right) = -\\frac{u}{\\Delta x} \\left( c_i^n - \\left( c - \\Delta x c_x + \\frac{(\\Delta x)^2}{2} c_{xx} + \\dots \\right) \\right)\n$$\n$$\nc_t + \\frac{\\Delta t}{2} c_{tt} + \\dots = -\\frac{u}{\\Delta x} \\left( \\Delta x c_x - \\frac{(\\Delta x)^2}{2} c_{xx} + \\dots \\right)\n$$\n$$\nc_t + u c_x = \\frac{u \\Delta x}{2} c_{xx} - \\frac{\\Delta t}{2} c_{tt} + \\dots\n$$\nThis expression contains a second-order time derivative, $c_{tt}$. To relate it to spatial derivatives, we differentiate the PDE we are approximating. To leading order, $c_t \\approx -u c_x$. This implies $c_{tt} \\approx -u c_{xt} = -u(c_t)_x \\approx -u(-u c_x)_x = u^2 c_{xx}$. Substituting this back into the equation:\n$$\nc_t + u c_x = \\frac{u \\Delta x}{2} c_{xx} - \\frac{\\Delta t}{2} (u^2 c_{xx}) + O(\\Delta x^2, \\Delta t^2)\n$$\n$$\nc_t + u c_x = \\left( \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} \\right) c_{xx} + \\dots\n$$\nFactoring out $\\frac{u \\Delta x}{2}$ and using the definition of the Courant–Friedrichs–Lewy (CFL) number, $\\lambda = u \\Delta t / \\Delta x$:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right) \\frac{\\partial^2 c}{\\partial x^2} + \\dots = \\frac{u \\Delta x}{2} (1 - \\lambda) \\frac{\\partial^2 c}{\\partial x^2} + \\dots\n$$\nThis is the modified partial differential equation (MPDE). The leading-order error term has the form of a diffusion term. The numerical diffusion coefficient is thus:\n$$\nK_{num} = \\frac{u \\Delta x}{2} (1 - \\lambda)\n$$\n\n**2. Formulation of Mass Loss**\n\nThe total mass of solute in the capillary lumen is $M(t) = \\int_0^L A c(x,t) dx$, where $A$ is the constant cross-sectional area. The rate of change of total mass is found by integrating the MPDE over the length of the domain:\n$$\n\\frac{dM}{dt} = A \\int_0^L \\frac{\\partial c}{\\partial t} dx = A \\int_0^L \\left( -u \\frac{\\partial c}{\\partial x} + K_{num} \\frac{\\partial^2 c}{\\partial x^2} \\right) dx\n$$\n$$\n\\frac{dM}{dt} = A \\left[ -u c(x,t) + K_{num} \\frac{\\partial c}{\\partial x} \\right]_0^L\n$$\n$$\n\\frac{dM}{dt} = \\underbrace{A [u c(0,t) - u c(L,t)]}_{\\text{Physical Advective Flux}} + \\underbrace{A \\left[ K_{num} \\frac{\\partial c}{\\partial x}\\bigg|_{x=L} - K_{num} \\frac{\\partial c}{\\partial x}\\bigg|_{x=0} \\right]}_{\\text{Spurious Diffusive Flux}}\n$$\nThe problem asks for the global mass loss attributable solely to numerical diffusion. This corresponds to the second term, which represents a net flux of mass due to the artificial diffusion. The rate of mass change due to numerical diffusion is:\n$$\n\\dot{M}_{num} = A K_{num} \\left( \\frac{\\partial c}{\\partial x}\\bigg|_{x=L} - \\frac{\\partial c}{\\partial x}\\bigg|_{x=0} \\right)\n$$\nWe apply the problem's assumptions: the inlet diffusive flux is negligible, meaning $\\frac{\\partial c}{\\partial x}\\big|_{x=0} = 0$, and the outlet gradient is constant over one time step and equal to its initial value.\nWe calculate the initial outlet gradient from the given initial condition:\nFor $L - \\delta \\le x \\le L$, $c(x,0) = c_{0} (L - x)/\\delta$.\nThe spatial gradient in this region is:\n$$\n\\frac{\\partial c}{\\partial x}(x,0) = \\frac{d}{dx} \\left( \\frac{c_{0}}{\\delta} (L - x) \\right) = -\\frac{c_0}{\\delta}\n$$\nThis gradient is constant for $x \\in (L-\\delta, L)$, so $\\frac{\\partial c}{\\partial x}\\big|_{x=L, t=0} = -c_0/\\delta$.\nSubstituting these gradients into the expression for $\\dot{M}_{num}$:\n$$\n\\dot{M}_{num} = A K_{num} \\left( -\\frac{c_0}{\\delta} - 0 \\right) = -\\frac{A K_{num} c_0}{\\delta}\n$$\nThe negative sign indicates a loss of mass from the domain. The rate of mass loss is $|\\dot{M}_{num}| = \\frac{A K_{num} c_0}{\\delta}$.\nThe total mass loss over a single time step $\\Delta t$ is approximated as:\n$\\Delta M_{loss, num} = |\\dot{M}_{num}| \\Delta t = \\frac{A K_{num} c_0 \\Delta t}{\\delta}$\nSubstituting the expression for $K_{num}$:\n$\\Delta M_{loss, num} = \\frac{A c_0 \\Delta t}{\\delta} \\left( \\frac{u \\Delta x}{2} (1 - \\lambda) \\right)$\n\n**3. Numerical Evaluation**\n\nWe now substitute the given parameter values:\n- $L = 1.0 \\times 10^{-2}\\ \\text{m}$\n- $A = 1.0 \\times 10^{-6}\\ \\text{m}^{2}$\n- $u = 1.0 \\times 10^{-3}\\ \\text{m}\\,\\text{s}^{-1}$\n- $N = 100$, so $\\Delta x = L/N = (1.0 \\times 10^{-2}\\ \\text{m})/100 = 1.0 \\times 10^{-4}\\ \\text{m}$\n- $\\lambda = 0.60$\n- $c_{0} = 1.0\\ \\text{mmol}\\,\\text{m}^{-3}$\n- $\\delta = 5.0 \\times 10^{-4}\\ \\text{m}$\n- $\\Delta t = \\lambda \\Delta x / u = (0.60 \\times 1.0 \\times 10^{-4}\\ \\text{m}) / (1.0 \\times 10^{-3}\\ \\text{m}\\,\\text{s}^{-1}) = 6.0 \\times 10^{-2}\\ \\text{s}$\n\nFirst, we calculate the numerical diffusion coefficient $K_{num}$:\n$K_{num} = \\frac{(1.0 \\times 10^{-3}) (1.0 \\times 10^{-4})}{2} (1 - 0.60) = \\frac{1.0 \\times 10^{-7}}{2} (0.40) = 2.0 \\times 10^{-8}\\ \\text{m}^2\\,\\text{s}^{-1}$\n\nNow, we calculate the total mass loss over one time step:\n$\\Delta M_{loss, num} = \\frac{(1.0 \\times 10^{-6}\\ \\text{m}^2) (2.0 \\times 10^{-8}\\ \\text{m}^2\\,\\text{s}^{-1}) (1.0\\ \\text{mmol}\\,\\text{m}^{-3}) (6.0 \\times 10^{-2}\\ \\text{s})}{5.0 \\times 10^{-4}\\ \\text{m}}$\n$\\Delta M_{loss, num} = \\frac{1.0 \\times 2.0 \\times 1.0 \\times 6.0}{5.0} \\times \\frac{10^{-6} \\times 10^{-8} \\times 10^{-2}}{10^{-4}}\\ \\text{mmol}$\n$\\Delta M_{loss, num} = \\frac{12.0}{5.0} \\times 10^{-16 - (-4)}\\ \\text{mmol} = 2.4 \\times 10^{-12}\\ \\text{mmol}$\nRounding to three significant figures as requested:\n$\\Delta M_{loss, num} = 2.40 \\times 10^{-12}\\ \\text{mmol}$\n\n**Implications for Conservation in Perfusion Models**\n\nThe concept of numerical diffusion has significant implications for conservation in computational models of perfusion. It is crucial to distinguish between local and global conservation properties.\n\nA finite volume scheme, by its construction, is locally conservative. The change of mass in any given control volume is exactly balanced by the sum of numerical fluxes across its faces. Mass is perfectly transferred from one cell to its neighbor without being artificially created or destroyed within the discrete interior of the domain.\n\nGlobal conservation, however, concerns the total mass within the entire computational domain. The change in total mass should be governed only by the physical fluxes across the external boundaries. The analysis above shows that the first-order upwind scheme effectively solves a modified equation that includes a spurious diffusion term. This leads to an artificial diffusive flux, $J_{num} = -K_{num} \\partial c/\\partial x$. At an outflow boundary where the concentration gradient is non-zero (such as when a sharp front exits the domain), this results in a non-zero spurious flux, $J_{num}(L,t)$. This flux acts as an unphysical leakage of mass from the domain. Consequently, while the scheme is perfectly conservative cell-to-cell (local conservation), it fails to conserve total mass in a system with outflow (global non-conservation). This leads to a systematic underestimation of the total solute mass, which can be a significant source of error in models tracking substance delivery or washout over time. Higher-order numerical schemes are generally required to reduce the magnitude of this numerical diffusion and improve global mass conservation.",
            "answer": "$$ \\boxed{2.40 \\times 10^{-12}} $$"
        }
    ]
}