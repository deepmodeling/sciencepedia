{
    "hands_on_practices": [
        {
            "introduction": "This first practice applies the law of mass conservation to a foundational problem in pharmacokinetics: designing a drug dosing regimen. We will work with a single-compartment model, a common simplification where the body is treated as a single, well-mixed volume. The key insight you will develop is that for a linear system at periodic steady-state, the time-averaged rate of drug administration must exactly balance the time-averaged rate of elimination, a principle that greatly simplifies the design process .",
            "id": "3878824",
            "problem": "A single well-mixed central physiological compartment with volume $V$ and linear elimination characterized by clearance $CL$ is supplied by a periodic infusion input $R_{in}(t)$ that repeats every period $T$. Let the central compartment concentration be $C(t)$ and its amount be $A(t)=V\\,C(t)$. The governing conservation of mass principle implies a balance between inflow and outflow in the central compartment, resulting in an ordinary differential equation (ODE) of the form $dA/dt = R_{in}(t) - \\text{(elimination rate)}$ in units of mass per unit time. Assume elimination is proportional to $C(t)$ through $CL$, so that the elimination rate equals $CL\\,C(t)$.\n\nDesign the dosing regimen by choosing the unknown infusion parameter(s) that determine the amplitude or baseline of $R_{in}(t)$ so that the periodic steady-state time-average of $C(t)$ over one period equals a prescribed target $\\overline{C}_{\\text{target}}$. Angles appearing in trigonometric functions must be interpreted in radians. All physical quantities use the following units: $CL$ in liters per hour (L/h), $V$ in liters (L), $T$, $\\tau$, $\\tau_{\\text{on}}$, $\\delta_{\\text{up}}$, and $\\delta_{\\text{down}}$ in hours (h), $R_{in}(t)$ and any amplitude parameters in milligrams per hour (mg/h), and $C(t)$ and $\\overline{C}_{\\text{target}}$ in milligrams per liter (mg/L). Your program must compute, for each specified waveform, the unique infusion parameter value that achieves the target time-average concentration at periodic steady-state, and output these parameter values as a single comma-separated list enclosed in square brackets, in mg/h, with no additional text.\n\nYou must use only the conservation of mass and linear elimination assumptions described above, and you must not rely on shortcut formulas beyond what follows from integrating the ODE over one period in the periodic steady-state regime. The design must be universally valid for any modern programming language and be expressed purely in mathematical and logical terms.\n\nTest Suite. For each case below, determine and report the corresponding infusion parameter in mg/h as a float. The angle unit is radians.\n\n- Case $1$ (square-wave infusion): Period $T = 12$ h, on-duration $\\tau=3$ h each period at constant rate $r_0$ (unknown), otherwise $0$; clearance $CL=5$ L/h; target average concentration $\\overline{C}_{\\text{target}}=2$ mg/L. Determine $r_0$.\n\n- Case $2$ (triangular infusion): Period $T=8$ h; during each period the infusion ramps linearly from $0$ to a peak $r_0$ (unknown) over time $\\tau=2$ h and is $0$ otherwise; clearance $CL=4.5$ L/h; target average concentration $\\overline{C}_{\\text{target}}=3$ mg/L. Determine $r_0$.\n\n- Case $3$ (sinusoidal infusion with baseline): Period $T=24$ h; infusion $R_{in}(t) = b_0 + a \\sin\\!\\big(2\\pi t/T\\big)$ with known amplitude $a=10$ mg/h and unknown baseline $b_0$; clearance $CL=4$ L/h; target average concentration $\\overline{C}_{\\text{target}}=3$ mg/L. Determine $b_0$.\n\n- Case $4$ (trapezoidal infusion): Period $T=8$ h; infusion linearly ramps up from $0$ to plateau $r_0$ (unknown) over $\\delta_{\\text{up}}=1$ h, stays at $r_0$ for $\\tau_{\\text{on}}=4$ h, then linearly ramps down from $r_0$ to $0$ over $\\delta_{\\text{down}}=1$ h, and is $0$ otherwise; clearance $CL=6$ L/h; target average concentration $\\overline{C}_{\\text{target}}=1.5$ mg/L. Determine $r_0$.\n\n- Case $5$ (constant infusion): Period $T=24$ h; infusion $R_{in}(t) = r_0$ (unknown constant); clearance $CL=7$ L/h; target average concentration $\\overline{C}_{\\text{target}}=1.25$ mg/L. Determine $r_0$.\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in mg/h, ordered as $[r_0^{(1)},r_0^{(2)},b_0^{(3)},r_0^{(4)},r_0^{(5)}]$, where superscripts indicate the case number as described above. For example, an output of the form `[40.0,108.0,12.0,14.4,8.75]` would be valid if those were the correct computed infusion parameters in mg/h.",
            "solution": "The problem has been validated and is deemed sound. It is scientifically grounded in the principles of linear pharmacokinetics, is well-posed with sufficient information to determine a unique solution for each case, and is expressed in objective, formal language. The central task requires the application of the conservation of mass principle under periodic steady-state conditions, a fundamental concept in biomedical systems modeling. The mention of the compartment volume $V$ without providing its value does not render the problem incomplete, as this parameter proves to be unnecessary for determining the relationship between the time-averaged infusion rate and the time-averaged concentration.\n\nThe solution proceeds by first deriving the general relationship between the average infusion rate and the average drug concentration at periodic steady-state. This relationship will then be applied to each of the five specific dosing regimens.\n\nThe governing ordinary differential equation for the amount of substance $A(t)$ in the compartment is given by the principle of mass balance:\n$$\n\\frac{dA(t)}{dt} = R_{in}(t) - R_{out}(t)\n$$\nwhere $R_{in}(t)$ is the rate of infusion and $R_{out}(t)$ is the rate of elimination. The problem states that elimination is linear, characterized by a clearance $CL$, such that the elimination rate is $R_{out}(t) = CL \\cdot C(t)$. The amount $A(t)$ is related to the concentration $C(t)$ and volume $V$ by $A(t) = V \\cdot C(t)$. Substituting these into the mass balance equation yields:\n$$\n\\frac{d(V \\cdot C(t))}{dt} = R_{in}(t) - CL \\cdot C(t)\n$$\nSince the volume $V$ is constant, we have:\n$$\nV \\frac{dC(t)}{dt} = R_{in}(t) - CL \\cdot C(t)\n$$\nThe problem specifies that the system is at a periodic steady-state. This means that the concentration profile is periodic with period $T$, i.e., $C(t+T) = C(t)$ for all $t$. Consequently, the amount in the compartment is also periodic, $A(t+T) = A(t)$.\n\nTo find the relationship between the averages, we integrate the mass balance equation for $A(t)$ over one full period, from an arbitrary time $t_0$ to $t_0+T$:\n$$\n\\int_{t_0}^{t_0+T} \\frac{dA(t)}{dt} dt = \\int_{t_0}^{t_0+T} \\left( R_{in}(t) - CL \\cdot C(t) \\right) dt\n$$\nThe left-hand side, by the fundamental theorem of calculus, is $A(t_0+T) - A(t_0)$. Due to the periodic steady-state condition, $A(t_0+T) = A(t_0)$, so the left-hand side evaluates to $0$.\n$$\n0 = \\int_{t_0}^{t_0+T} R_{in}(t) dt - \\int_{t_0}^{t_0+T} CL \\cdot C(t) dt\n$$\nRearranging and noting that $CL$ is a constant, we get:\n$$\nCL \\int_{t_0}^{t_0+T} C(t) dt = \\int_{t_0}^{t_0+T} R_{in}(t) dt\n$$\nThe definition of the time-average of a function $f(t)$ over a period $T$ is $\\overline{f} = \\frac{1}{T} \\int_{t_0}^{t_0+T} f(t) dt$. Applying this definition, we can rewrite the equation in terms of the time-average concentration $\\overline{C}$ and time-average infusion rate $\\overline{R_{in}}$:\n$$\nCL \\cdot (T \\cdot \\overline{C}) = T \\cdot \\overline{R_{in}}\n$$\n$$\nCL \\cdot \\overline{C} = \\overline{R_{in}}\n$$\nThis elegant result demonstrates that at steady-state in a linear system, the average elimination rate must equal the average input rate. The problem requires us to design the infusion regimen such that the average concentration $\\overline{C}$ matches a target value, $\\overline{C}_{\\text{target}}$. Therefore, the design equation is:\n$$\n\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}}\n$$\nFor each case, we will calculate the required average infusion rate from the given $CL$ and $\\overline{C}_{\\text{target}}$, then determine the unknown infusion parameter by setting the calculated average infusion rate for the specific waveform equal to this target value.\n\nCase $1$: Square-wave infusion\nGiven: $T = 12$ h, infusion on-duration $\\tau=3$ h, $CL=5$ L/h, $\\overline{C}_{\\text{target}}=2$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 5 \\cdot 2 = 10$ mg/h.\nThe infusion rate $R_{in}(t)$ is a constant $r_0$ for a duration $\\tau$ and $0$ otherwise. The average rate is the total amount infused over one period divided by the period duration:\n$\\overline{R_{in}} = \\frac{1}{T} \\int_0^T R_{in}(t) dt = \\frac{1}{T} (r_0 \\cdot \\tau) = \\frac{r_0 \\cdot 3}{12} = \\frac{r_0}{4}$.\nEquating the two expressions for $\\overline{R_{in}}$: $\\frac{r_0}{4} = 10$, which gives $r_0 = 40$ mg/h.\n\nCase $2$: Triangular infusion\nGiven: $T=8$ h, ramp duration $\\tau=2$ h, $CL=4.5$ L/h, $\\overline{C}_{\\text{target}}=3$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 4.5 \\cdot 3 = 13.5$ mg/h.\nThe infusion profile is a triangle with base $\\tau=2$ h and height $r_0$. The total amount infused per period is the area of this triangle, which is $\\frac{1}{2} \\cdot \\text{base} \\cdot \\text{height} = \\frac{1}{2} \\tau r_0 = \\frac{1}{2} (2) r_0 = r_0$.\nThe average rate is $\\overline{R_{in}} = \\frac{r_0}{T} = \\frac{r_0}{8}$.\nEquating yields: $\\frac{r_0}{8} = 13.5$, which gives $r_0 = 8 \\cdot 13.5 = 108$ mg/h.\n\nCase $3$: Sinusoidal infusion with baseline\nGiven: $T=24$ h, $R_{in}(t) = b_0 + a \\sin(2\\pi t/T)$ with $a=10$ mg/h, $CL=4$ L/h, $\\overline{C}_{\\text{target}}=3$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 4 \\cdot 3 = 12$ mg/h.\nThe average of a sinusoidal function over a full period is $0$. Thus, the average of $R_{in}(t)$ is simply the baseline component:\n$\\overline{R_{in}} = \\frac{1}{T} \\int_0^T (b_0 + a \\sin(2\\pi t/T)) dt = b_0$.\nEquating gives the unknown baseline: $b_0 = 12$ mg/h. The amplitude $a$ does not affect the average concentration.\n\nCase $4$: Trapezoidal infusion\nGiven: $T=8$ h, ramp-up $\\delta_{\\text{up}}=1$ h, plateau $\\tau_{\\text{on}}=4$ h, ramp-down $\\delta_{\\text{down}}=1$ h, $CL=6$ L/h, $\\overline{C}_{\\text{target}}=1.5$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 6 \\cdot 1.5 = 9$ mg/h.\nThe infusion profile is a trapezoid with height $r_0$. The total amount infused is the area of this trapezoid. The area can be calculated by summing the areas of the initial ramp (triangle), the plateau (rectangle), and the final ramp (triangle):\nArea = $(\\frac{1}{2} \\delta_{\\text{up}} r_0) + (\\tau_{\\text{on}} r_0) + (\\frac{1}{2} \\delta_{\\text{down}} r_0) = (\\frac{1}{2} \\cdot 1 \\cdot r_0) + (4 \\cdot r_0) + (\\frac{1}{2} \\cdot 1 \\cdot r_0) = 0.5 r_0 + 4 r_0 + 0.5 r_0 = 5 r_0$.\nThe average rate is $\\overline{R_{in}} = \\frac{\\text{Area}}{T} = \\frac{5 r_0}{8}$.\nEquating yields: $\\frac{5 r_0}{8} = 9$, which gives $5 r_0 = 72$, so $r_0 = \\frac{72}{5} = 14.4$ mg/h.\n\nCase $5$: Constant infusion\nGiven: $T=24$ h, $R_{in}(t) = r_0$ (constant), $CL=7$ L/h, $\\overline{C}_{\\text{target}}=1.25$ mg/L.\nThe required average infusion rate is $\\overline{R_{in}} = CL \\cdot \\overline{C}_{\\text{target}} = 7 \\cdot 1.25 = 8.75$ mg/h.\nFor a constant infusion $R_{in}(t) = r_0$, the average rate is simply $r_0$.\n$\\overline{R_{in}} = r_0$.\nEquating gives the required constant rate: $r_0 = 8.75$ mg/h.\n\nThe computed parameters are: $r_0^{(1)} = 40.0$, $r_0^{(2)} = 108.0$, $b_0^{(3)} = 12.0$, $r_0^{(4)} = 14.4$, and $r_0^{(5)} = 8.75$, all in units of mg/h.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the unknown infusion parameters for five different dosing regimens\n    to achieve a target time-average drug concentration at periodic steady-state.\n\n    The core principle used is that at periodic steady-state in a linear\n    pharmacokinetic system, the average rate of infusion equals the average\n    rate of elimination: R_in_avg = CL * C_target_avg.\n    \"\"\"\n    \n    results = []\n\n    # Case 1 (square-wave infusion):\n    # R_in_avg = (r0 * tau) / T\n    # r0 = (CL * C_target * T) / tau\n    T1 = 12.0\n    tau1 = 3.0\n    CL1 = 5.0\n    C_target1 = 2.0\n    r0_1 = (CL1 * C_target1 * T1) / tau1\n    results.append(r0_1)\n\n    # Case 2 (triangular infusion):\n    # Total infused amount per period (Area) = 0.5 * tau * r0\n    # R_in_avg = Area / T = (0.5 * tau * r0) / T\n    # r0 = (CL * C_target * T) / (0.5 * tau)\n    T2 = 8.0\n    tau2 = 2.0\n    CL2 = 4.5\n    C_target2 = 3.0\n    r0_2 = (CL2 * C_target2 * T2) / (0.5 * tau2)\n    results.append(r0_2)\n\n    # Case 3 (sinusoidal infusion with baseline):\n    # R_in_avg = b0, since the average of a sine wave over a full period is 0.\n    # b0 = CL * C_target\n    CL3 = 4.0\n    C_target3 = 3.0\n    b0_3 = CL3 * C_target3\n    results.append(b0_3)\n\n    # Case 4 (trapezoidal infusion):\n    # Total infused amount per period (Area) = Area_triangle1 + Area_rect + Area_triangle2\n    # Area = (0.5 * delta_up * r0) + (tau_on * r0) + (0.5 * delta_down * r0)\n    # Area = r0 * (0.5 * delta_up + tau_on + 0.5 * delta_down)\n    # R_in_avg = Area / T\n    # r0 = (CL * C_target * T) / Area_factor where Area = Area_factor * r0\n    T4 = 8.0\n    delta_up4 = 1.0\n    tau_on4 = 4.0\n    delta_down4 = 1.0\n    CL4 = 6.0\n    C_target4 = 1.5\n    # The total amount infused is the area under the rate curve\n    Area_factor4 = (0.5 * delta_up4) + tau_on4 + (0.5 * delta_down4)\n    r0_4 = (CL4 * C_target4 * T4) / Area_factor4\n    results.append(r0_4)\n\n    # Case 5 (constant infusion):\n    # R_in_avg = r0\n    # r0 = CL * C_target\n    CL5 = 7.0\n    C_target5 = 1.25\n    r0_5 = CL5 * C_target5\n    results.append(r0_5)\n\n    # The final print statement must produce only the single-line format\n    # \"[result1,result2,result3,result4,result5]\" with no other text.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from lumped-parameter systems to spatially distributed ones, this exercise challenges you to model solute transport along a nephron's collecting duct. You will apply the principle of mass conservation to a differential control volume to derive the governing equation for urea concentration as a function of position. By solving this equation for a series of distinct tubular segments, this practice demonstrates how to handle axial heterogeneity and provides a powerful, iterative method for analyzing transport in tubular structures common throughout physiology .",
            "id": "3878827",
            "problem": "A single-nephron collecting duct is modeled as a one-dimensional tube aligned along an axial coordinate $x$ with $x=0$ at the inlet and $x=L$ at the outlet. The luminal urea concentration is denoted by $C(x)$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. The tube is partitioned into $S$ contiguous segments indexed by $s \\in \\{1,\\dots,S\\}$ with lengths $\\{L_s\\}$ in $\\mathrm{m}$ such that $\\sum_{s=1}^{S} L_s = L$. Within segment $s$, the volumetric flow rate $Q_s$ in $\\mathrm{m}^3\\,\\mathrm{s}^{-1}$ is constant, the membrane urea permeability $P_s$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ is constant, the surface area per unit axial length $S'_s$ in $\\mathrm{m}$ is constant, and the surrounding interstitial urea concentration $C_{\\mathrm{is},s}$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$ is constant. Assume steady state and uniform cross-section so that axial accumulation of urea mass within any differential control volume is zero. The only exchange with the surroundings is a transmural flux proportional to the transmembrane concentration difference.\n\nStarting solely from the conservation of mass principle for a solute in a one-dimensional control volume and the definition of flux proportional to a concentration difference across a membrane, derive the governing equation for $C(x)$ in each segment under the stated assumptions. Then, using logical continuity of $C(x)$ at segment interfaces and the specified inlet boundary concentration $C(0)=C_{\\mathrm{in}}$, determine $C(x)$ along the entire duct.\n\nFor computational purposes, you must evaluate the solution only at the segment boundaries, that is, at axial positions $x_0 = 0$, $x_1 = L_1$, $x_2 = L_1+L_2$, and so on up to $x_S = \\sum_{s=1}^{S} L_s$. All intermediate calculations must be performed in International System of Units (SI), and the final reported concentrations must be expressed in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, rounded to $6$ decimal places.\n\nImplement a program that computes and reports the list of luminal urea concentrations at these boundary positions for each of the following test cases. In all cases, set $S=3$ and use the same surface area per unit length for each segment, $S'_s = 6.0 \\times 10^{-5}\\ \\mathrm{m}$ for all $s$.\n\nTest case $1$ (representative medullary gradient):\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Segment lengths: $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$.\n- Volumetric flows: $Q_1 = 8.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 6.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 5.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n- Permeabilities: $P_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Interstitial concentrations: $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 200.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 400.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nTest case $2$ (high-flow regime):\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Segment lengths: $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$.\n- Volumetric flows: $Q_1 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 2.0 \\times 10^{-12}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n- Permeabilities: $P_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-5}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-4}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Interstitial concentrations: $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 200.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 400.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nTest case $3$ (low-permeability, declining interstitial):\n- $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n- Segment lengths: $L_1 = 0.005\\ \\mathrm{m}$, $L_2 = 0.003\\ \\mathrm{m}$, $L_3 = 0.005\\ \\mathrm{m}$.\n- Volumetric flows: $Q_1 = 8.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_2 = 6.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$, $Q_3 = 5.0 \\times 10^{-13}\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n- Permeabilities: $P_1 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_2 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $P_3 = 1.0 \\times 10^{-7}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- Interstitial concentrations: $C_{\\mathrm{is},1} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},2} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$, $C_{\\mathrm{is},3} = 50.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a bracketed comma-separated list of the axial boundary concentrations $[C(x_0), C(x_1), C(x_2), C(x_3)]$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, each rounded to $6$ decimal places. For example, the printed structure must look like $[[c_{0,1},c_{1,1},c_{2,1},c_{3,1}],[c_{0,2},c_{1,2},c_{2,2},c_{3,2}],[c_{0,3},c_{1,3},c_{2,3},c_{3,3}]]$ where $c_{i,j}$ denotes the $i$-th boundary value for test case $j$.",
            "solution": "The user wants me to solve a mass transport problem in a model of a kidney nephron's collecting duct.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n\n*   **System Geometry**: A one-dimensional tube along an axial coordinate $x$, from $x=0$ (inlet) to $x=L$ (outlet). The tube is partitioned into $S$ contiguous segments.\n*   **Variables**:\n    *   $C(x)$: Luminal urea concentration ($\\mathrm{mol}\\,\\mathrm{m}^{-3}$).\n*   **Segment-wise Constants ($s \\in \\{1,\\dots,S\\}$)**:\n    *   $L_s$: Length of segment $s$ ($\\mathrm{m}$). Condition: $\\sum_{s=1}^{S} L_s = L$.\n    *   $Q_s$: Volumetric flow rate in segment $s$ ($\\mathrm{m}^3\\,\\mathrm{s}^{-1}$).\n    *   $P_s$: Membrane urea permeability in segment $s$ ($\\mathrm{m}\\,\\mathrm{s}^{-1}$).\n    *   $S'_s$: Surface area per unit axial length in segment $s$ ($\\mathrm{m}$).\n    *   $C_{\\mathrm{is},s}$: Surrounding interstitial urea concentration in segment $s$ ($\\mathrm{mol}\\,\\mathrm{m}^{-3}$).\n*   **Assumptions**:\n    *   Steady state: Axial accumulation of mass in any differential volume is zero.\n    *   Uniform cross-section.\n    *   Transmural flux is the only exchange with surroundings.\n    *   Flux is proportional to the transmembrane concentration difference: $J \\propto (C(x) - C_{\\mathrm{is}})$.\n*   **Boundary and Continuity Conditions**:\n    *   Inlet boundary condition: $C(0) = C_{\\mathrm{in}}$.\n    *   Logical continuity of $C(x)$ at segment interfaces.\n*   **Computational Task**:\n    *   Evaluate $C(x)$ at segment boundaries: $x_0 = 0$, $x_1 = L_1$, $x_2 = L_1+L_2$, ..., $x_S = \\sum_{s=1}^{S} L_s$.\n    - All units are SI. Final results in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, rounded to $6$ decimal places.\n*   **Test Case Parameters**:\n    *   Common for all cases: $S=3$, $S'_s = 6.0 \\times 10^{-5}\\ \\mathrm{m}$ for all $s$.\n    *   **Test Case 1**:\n        *   $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n        *   $L = [0.005, 0.003, 0.005]\\ \\mathrm{m}$.\n        *   $Q = [8.0 \\times 10^{-13}, 6.0 \\times 10^{-13}, 5.0 \\times 10^{-13}]\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n        *   $P = [1.0 \\times 10^{-6}, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-4}]\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n        *   $C_{\\mathrm{is}} = [50.0, 200.0, 400.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    *   **Test Case 2**:\n        *   $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n        *   $L = [0.005, 0.003, 0.005]\\ \\mathrm{m}$.\n        *   $Q = [2.0 \\times 10^{-12}, 2.0 \\times 10^{-12}, 2.0 \\times 10^{-12}]\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n        *   $P = [1.0 \\times 10^{-6}, 1.0 \\times 10^{-5}, 1.0 \\times 10^{-4}]\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n        *   $C_{\\mathrm{is}} = [50.0, 200.0, 400.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n    *   **Test Case 3**:\n        *   $C_{\\mathrm{in}} = 100.0\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n        *   $L = [0.005, 0.003, 0.005]\\ \\mathrm{m}$.\n        *   $Q = [8.0 \\times 10^{-13}, 6.0 \\times 10^{-13}, 5.0 \\times 10^{-13}]\\ \\mathrm{m}^3\\,\\mathrm{s}^{-1}$.\n        *   $P = [1.0 \\times 10^{-7}, 1.0 \\times 10^{-7}, 1.0 \\times 10^{-7}]\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n        *   $C_{\\mathrm{is}} = [50.0, 50.0, 50.0]\\ \\mathrm{mol}\\,\\mathrm{m}^{-3}$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is a classic application of conservation laws in biomedical systems modeling, specifically solute transport in a tubular structure.\n1.  **Scientifically Grounded**: The problem is based on the fundamental principle of conservation of mass and Fick's law of diffusion (approximated as a flux proportional to a concentration difference across a membrane). These are standard, well-established principles in physiology and transport phenomena. The model is a simplification but is not unscientific.\n2.  **Well-Posed**: The problem provides a governing physical model, defines all necessary parameters for each segment, and specifies an initial boundary condition ($C(0) = C_{\\mathrm{in}}$) and continuity conditions between segments. This setup leads to a unique solution for $C(x)$.\n3.  **Objective**: The language is precise and quantitative. All terms are defined, and the parameters are given numerically. There are no subjective or opinion-based statements.\n4.  **No other flaws detected**: The problem is not incomplete, contradictory, unrealistic (within the context of a model), or trivial. The provided parameters are dimensionally consistent and within plausible physiological ranges for single-nephron models.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be derived and implemented.\n\n### **Solution Derivation and Algorithm Design**\n\nThe core of the problem is to determine the luminal urea concentration profile $C(x)$ by applying the principle of mass conservation.\n\n**1. Derive the Governing Differential Equation**\n\nConsider a differential control volume of the tube, a slice of length $\\Delta x$ located at axial position $x$. At steady state, the rate of accumulation of solute (urea) within this volume is zero. Therefore, the rate of mass entering the volume must equal the rate of mass leaving it.\n$$\n(\\text{Rate of mass in}) - (\\text{Rate of mass out}) = 0\n$$\nMass enters the control volume at $x$ via advection (bulk flow) at a rate of $Q_s C(x)$, where the units are $(\\mathrm{m}^3\\,\\mathrm{s}^{-1}) \\cdot (\\mathrm{mol}\\,\\mathrm{m}^{-3}) = \\mathrm{mol}\\,\\mathrm{s}^{-1}$.\n\nMass leaves the control volume in two ways:\n1.  By advection at position $x+\\Delta x$, at a rate of $Q_s C(x+\\Delta x)$.\n2.  By transmural transport (flux) across the membrane wall. The flux $J_s$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$) is proportional to the concentration difference: $J_s = P_s (C(x) - C_{\\mathrm{is},s})$. The surface area of the differential slice is $S'_s \\Delta x$. Thus, the rate of mass leaving through the wall is $J_s \\cdot (S'_s \\Delta x) = P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x$.\n\nWithin any given segment $s$, the parameters $Q_s$, $P_s$, $S'_s$, and $C_{\\mathrm{is},s}$ are constant. The mass balance equation for the differential volume is:\n$$\nQ_s C(x) - \\left[ Q_s C(x+\\Delta x) + P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x \\right] = 0\n$$\nRearranging the terms:\n$$\nQ_s (C(x) - C(x+\\Delta x)) - P_s S'_s (C(x) - C_{\\mathrm{is},s}) \\Delta x = 0\n$$\nDividing by $\\Delta x$ and rearranging:\n$$\nQ_s \\frac{C(x+\\Delta x) - C(x)}{\\Delta x} + P_s S'_s (C(x) - C_{\\mathrm{is},s}) = 0\n$$\nTaking the limit as $\\Delta x \\to 0$, we obtain the governing first-order ordinary differential equation (ODE) for $C(x)$ within segment $s$:\n$$\nQ_s \\frac{dC}{dx} + P_s S'_s (C(x) - C_{\\mathrm{is},s}) = 0\n$$\n\n**2. Solve the Differential Equation**\n\nThis is a linear, separable ODE. We can rewrite it as:\n$$\n\\frac{dC}{C - C_{\\mathrm{is},s}} = -\\frac{P_s S'_s}{Q_s} dx\n$$\nLet's define a local coordinate system for each segment $s$. Let the global coordinate of the start of segment $s$ be $x_{s-1}$ and the end be $x_s$. The length of the segment is $L_s = x_s - x_{s-1}$. We integrate the ODE over the length of segment $s$, from $x_{s-1}$ to $x_s$. The concentration at these points are $C(x_{s-1})$ and $C(x_s)$, respectively.\n$$\n\\int_{C(x_{s-1})}^{C(x_s)} \\frac{dC}{C - C_{\\mathrm{is},s}} = -\\int_{x_{s-1}}^{x_s} \\frac{P_s S'_s}{Q_s} dx\n$$\nThe integration yields:\n$$\n\\left[ \\ln|C - C_{\\mathrm{is},s}| \\right]_{C(x_{s-1})}^{C(x_s)} = -\\frac{P_s S'_s}{Q_s} [x]_{x_{s-1}}^{x_s}\n$$\n$$\n\\ln\\left( \\frac{C(x_s) - C_{\\mathrm{is},s}}{C(x_{s-1}) - C_{\\mathrm{is},s}} \\right) = -\\frac{P_s S'_s (x_s - x_{s-1})}{Q_s} = -\\frac{P_s S'_s L_s}{Q_s}\n$$\nExponentiating both sides gives:\n$$\n\\frac{C(x_s) - C_{\\mathrm{is},s}}{C(x_{s-1}) - C_{\\mathrm{is},s}} = \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n$$\nSolving for the outlet concentration of the segment, $C(x_s)$:\n$$\nC(x_s) = C_{\\mathrm{is},s} + \\left( C(x_{s-1}) - C_{\\mathrm{is},s} \\right) \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n$$\nThe dimensionless group in the exponent, $k_s = \\frac{P_s S'_s L_s}{Q_s}$, represents the ratio of the membrane transport rate to the advective transport rate.\n\n**3. Develop the Iterative Algorithm**\n\nThe problem requires the concentration values at the segment boundaries: $C(x_0), C(x_1), \\dots, C(x_S)$.\n*   We start with the given inlet concentration at the beginning of the first segment: $C(x_0) = C_{\\mathrm{in}}$.\n*   The concentration at the end of the first segment, $C(x_1)$, is calculated using the derived formula for $s=1$:\n    $$\n    C(x_1) = C_{\\mathrm{is},1} + \\left( C(x_0) - C_{\\mathrm{is},1} \\right) \\exp\\left(-\\frac{P_1 S'_1 L_1}{Q_1}\\right)\n    $$\n*   Due to the continuity of concentration, the outlet concentration of segment $s-1$ is the inlet concentration for segment $s$: $C(x_{s-1})$.\n*   We can proceed iteratively. For each segment $s$ from $1$ to $S$:\n    $$\n    C(x_s) = C_{\\mathrm{is},s} + \\left( C(x_{s-1}) - C_{\\mathrm{is},s} \\right) \\exp\\left(-\\frac{P_s S'_s L_s}{Q_s}\\right)\n    $$\nThis allows us to compute the sequence of boundary concentrations $C(x_0), C(x_1), C(x_2), \\dots, C(x_S)$ step-by-step. For the given problem with $S=3$, we will compute $C(x_0), C(x_1), C(x_2), C(x_3)$.\n\n**4. Computational Implementation**\nThe algorithm will be implemented in Python for each test case.\n1.  Initialize a list of concentrations with the inlet value, `[C_in]`.\n2.  Loop through the segments from $s=1$ to $S=3$.\n3.  In each iteration, use the last calculated concentration as the input for the current segment.\n4.  Apply the derived formula to calculate the outlet concentration for the current segment.\n5.  Append the new concentration to the list.\n6.  After iterating through all segments, the list will contain all boundary concentrations.\n7.  The final numerical results are then rounded to $6$ decimal places as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the urea concentration at segment boundaries in a model of a\n    nephron collecting duct for multiple test cases.\n    \"\"\"\n    \n    # Define the common parameter S_prime\n    S_prime = 6.0e-5  # m\n\n    # Define the test cases as a list of dictionaries.\n    test_cases = [\n        {\n            # Test case 1 (representative medullary gradient)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [8.0e-13, 6.0e-13, 5.0e-13],\n            \"P_s\": [1.0e-6, 1.0e-5, 1.0e-4],\n            \"C_is_s\": [50.0, 200.0, 400.0]\n        },\n        {\n            # Test case 2 (high-flow regime)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [2.0e-12, 2.0e-12, 2.0e-12],\n            \"P_s\": [1.0e-6, 1.0e-5, 1.0e-4],\n            \"C_is_s\": [50.0, 200.0, 400.0]\n        },\n        {\n            # Test case 3 (low-permeability, declining interstitial)\n            \"C_in\": 100.0,\n            \"L_s\": [0.005, 0.003, 0.005],\n            \"Q_s\": [8.0e-13, 6.0e-13, 5.0e-13],\n            \"P_s\": [1.0e-7, 1.0e-7, 1.0e-7],\n            \"C_is_s\": [50.0, 50.0, 50.0]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        C_in = case[\"C_in\"]\n        L_s = case[\"L_s\"]\n        Q_s = case[\"Q_s\"]\n        P_s = case[\"P_s\"]\n        C_is_s = case[\"C_is_s\"]\n        \n        # Number of segments\n        S = len(L_s)\n        \n        # List to store concentrations at boundaries [C(x0), C(x1), ..., C(xS)]\n        boundary_concentrations = [C_in]\n        \n        current_C = C_in\n        \n        # Iterate through each segment to calculate the outlet concentration\n        for s in range(S):\n            L = L_s[s]\n            Q = Q_s[s]\n            P = P_s[s]\n            C_is = C_is_s[s]\n            \n            # The inlet concentration for this segment is the outlet of the previous one\n            C_in_segment = current_C\n            \n            # Dimensionless exponent k = (P * S' * L) / Q\n            k = (P * S_prime * L) / Q\n            \n            # Calculate the outlet concentration for the current segment\n            C_out_segment = C_is + (C_in_segment - C_is) * np.exp(-k)\n            \n            # Store the result and update the current concentration for the next iteration\n            boundary_concentrations.append(C_out_segment)\n            current_C = C_out_segment\n        \n        all_results.append(boundary_concentrations)\n\n    # Format the final output string as per the problem specification\n    # [[c_0,1,c_1,1,...],[c_0,2,c_1,2,...],...] with 6 decimal places.\n    \n    # A list to hold string representations of each test case's results\n    inner_lists_str = []\n    \n    for result_list in all_results:\n        # Format each concentration to 6 decimal places\n        rounded_res = [f\"{c:.6f}\" for c in result_list]\n        # Join the numbers with commas and enclose in brackets\n        inner_str = f\"[{','.join(rounded_res)}]\"\n        inner_lists_str.append(inner_str)\n        \n    # Join the inner lists with commas and enclose in outer brackets\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "This final practice synthesizes our understanding of conservation laws by tackling the bioheat equation, a cornerstone of thermal modeling in physiology. Here, you will apply the principle of energy conservation to a spherical tumor model, accounting for heat generation from metabolism, heat loss from blood perfusion, and heat transport via conduction. The goal is to derive and solve the governing boundary value problem to find the steady-state temperature profile, providing essential practice in handling more complex geometries and the multi-physics nature of biological systems .",
            "id": "3878871",
            "problem": "A spherical tumor of radius $R$ is embedded in well-perfused tissue. Assume isotropic, spatially uniform thermal conductivity $k$ and a spatially uniform metabolic heat generation rate $q_{met}$. Model the thermal effect of blood perfusion as a linear volumetric sink proportional to the local temperature difference from arterial blood at temperature $T_{a}$, with proportionality constant $\\omega_{b}$, where $\\omega_{b}$ has units of $\\mathrm{W\\,m^{-3}\\,K^{-1}}$. Neglect any external heat sources or sinks other than perfusion and metabolism. Under steady state, the tumor temperature is spherically symmetric, $T = T(r)$, and the boundary is held at a fixed temperature $T(R) = T_{0}$. Require that the temperature remain finite at the center $r = 0$.\n\nStarting from conservation of energy applied to a spherical differential control volume and Fourier’s law of heat conduction, write down the steady-state balance and specialize it to spherical symmetry with constant properties. Solve the resulting boundary value problem to obtain the radial temperature profile $T(r)$ for $0 \\le r \\le R$.\n\nProvide a single closed-form analytical expression for $T(r)$ as a function of $r$, $k$, $\\omega_{b}$, $q_{met}$, $R$, $T_{a}$, and $T_{0}$. Express the final temperature profile in Kelvin. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for the steady-state temperature profile $T(r)$ within a spherical tumor. The solution is obtained by formulating and solving a boundary value problem derived from the principle of energy conservation.\n\nFirst, we establish the governing differential equation. The general form of the steady-state heat equation with internal heat generation is $\\nabla \\cdot \\vec{q} = \\dot{q}_{gen}$, where $\\vec{q}$ is the heat flux vector and $\\dot{q}_{gen}$ is the volumetric rate of heat generation.\n\nThe heat flux $\\vec{q}$ is described by Fourier's law of heat conduction. For an isotropic medium with thermal conductivity $k$ and a spherically symmetric temperature profile $T(r)$, the heat flux is purely radial:\n$$ \\vec{q} = -k \\nabla T(r) = -k \\frac{dT}{dr} \\hat{r} $$\nwhere $\\hat{r}$ is the unit vector in the radial direction.\n\nThe total volumetric heat generation rate, $\\dot{q}_{gen}$, is the sum of metabolic heat generation, $q_{met}$, and the heat exchange due to blood perfusion. The perfusion is modeled as a sink, removing heat at a rate proportional to the temperature difference between the tissue $T$ and the arterial blood $T_a$. Thus, the perfusion term is $-\\omega_b(T - T_a)$. The total generation rate is:\n$$ \\dot{q}_{gen} = q_{met} - \\omega_{b} (T(r) - T_{a}) $$\n\nThe divergence of the heat flux vector in spherical coordinates for a function that depends only on $r$ is:\n$$ \\nabla \\cdot \\vec{q} = \\frac{1}{r^2} \\frac{d}{dr}(r^2 q_r) = \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\left(-k \\frac{dT}{dr}\\right)\\right) $$\nSince the thermal conductivity $k$ is assumed to be constant, we have:\n$$ \\nabla \\cdot \\vec{q} = -\\frac{k}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dT}{dr}\\right) $$\nSubstituting the expressions for $\\nabla \\cdot \\vec{q}$ and $\\dot{q}_{gen}$ into the energy conservation equation gives:\n$$ -\\frac{k}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dT}{dr}\\right) = q_{met} - \\omega_{b} (T(r) - T_{a}) $$\nRearranging this equation yields the governing second-order ordinary differential equation (ODE) for the temperature profile $T(r)$:\n$$ \\frac{d}{dr}\\left(r^2 \\frac{dT}{dr}\\right) - \\frac{\\omega_{b}}{k} r^2 T(r) = -\\frac{r^2}{k}(q_{met} + \\omega_{b} T_{a}) $$\nThis is a non-homogeneous linear ODE. To solve it, we first simplify it by introducing a new variable, $\\Theta(r)$, to homogenize the equation. Let $\\Theta(r) = T(r) - T_{\\infty}$, where $T_{\\infty}$ is a constant. The derivative terms are $\\frac{dT}{dr} = \\frac{d\\Theta}{dr}$. Substituting into the ODE:\n$$ \\frac{d}{dr}\\left(r^2 \\frac{d\\Theta}{dr}\\right) - \\frac{\\omega_{b}}{k} r^2 (\\Theta(r) + T_{\\infty}) = -\\frac{r^2}{k}(q_{met} + \\omega_{b} T_{a}) $$\n$$ \\frac{d}{dr}\\left(r^2 \\frac{d\\Theta}{dr}\\right) - \\frac{\\omega_{b}}{k} r^2 \\Theta(r) = \\frac{\\omega_{b}}{k} r^2 T_{\\infty} - \\frac{r^2}{k}(q_{met} + \\omega_{b} T_{a}) $$\nThe equation becomes homogeneous if we choose $T_{\\infty}$ such that the right-hand side is zero:\n$$ \\frac{\\omega_{b}}{k} r^2 T_{\\infty} - \\frac{r^2}{k}(q_{met} + \\omega_{b} T_{a}) = 0 $$\n$$ \\omega_{b} T_{\\infty} = q_{met} + \\omega_{b} T_{a} \\implies T_{\\infty} = T_{a} + \\frac{q_{met}}{\\omega_{b}} $$\nWith this choice of $T_{\\infty}$, the variable $\\Theta(r)$ is defined as $\\Theta(r) = T(r) - \\left(T_{a} + \\frac{q_{met}}{\\omega_{b}}\\right)$, and it satisfies the homogeneous ODE:\n$$ \\frac{d}{dr}\\left(r^2 \\frac{d\\Theta}{dr}\\right) - \\frac{\\omega_{b}}{k} r^2 \\Theta(r) = 0 $$\nLet $\\lambda^2 = \\frac{\\omega_{b}}{k}$. The equation is $\\frac{d}{dr}(r^2 \\frac{d\\Theta}{dr}) - \\lambda^2 r^2 \\Theta = 0$. This is a form of the spherical modified Bessel equation. By making the substitution $u(r) = r\\Theta(r)$, the equation transforms to the standard form $u''(r) - \\lambda^2 u(r) = 0$.\nThe general solution for $u(r)$ is $u(r) = C_1 e^{\\lambda r} + C_2 e^{-\\lambda r}$, or equivalently, in terms of hyperbolic functions, $u(r) = A \\cosh(\\lambda r) + B \\sinh(\\lambda r)$.\nTherefore, the solution for $\\Theta(r)$ is:\n$$ \\Theta(r) = \\frac{u(r)}{r} = A \\frac{\\cosh(\\lambda r)}{r} + B \\frac{\\sinh(\\lambda r)}{r} $$\nWe now apply the boundary conditions to determine the constants $A$ and $B$.\nThe first condition is that the temperature must be finite at the center of the tumor, $r=0$.\nAs $r \\to 0$, the term $\\frac{\\sinh(\\lambda r)}{r}$ approaches $\\lambda$ (by L'Hôpital's rule or Taylor expansion).\nHowever, the term $\\frac{\\cosh(\\lambda r)}{r}$ approaches $\\frac{1}{0}$, which is singular. For $\\Theta(0)$ to be finite, the coefficient of the singular term must be zero. Thus, we must have $A=0$.\nThe solution simplifies to:\n$$ \\Theta(r) = B \\frac{\\sinh(\\lambda r)}{r} $$\nThe second boundary condition is $T(R) = T_0$. In terms of $\\Theta(r)$, this is:\n$$ \\Theta(R) = T(R) - \\left(T_{a} + \\frac{q_{met}}{\\omega_{b}}\\right) = T_0 - T_{a} - \\frac{q_{met}}{\\omega_{b}} $$\nApplying this condition to our solution for $\\Theta(r)$:\n$$ \\Theta(R) = B \\frac{\\sinh(\\lambda R)}{R} = T_0 - T_{a} - \\frac{q_{met}}{\\omega_{b}} $$\nSolving for the constant $B$:\n$$ B = \\frac{R}{\\sinh(\\lambda R)} \\left(T_0 - T_{a} - \\frac{q_{met}}{\\omega_{b}}\\right) $$\nNow, we substitute $B$ back into the solution for $\\Theta(r)$:\n$$ \\Theta(r) = \\frac{R}{\\sinh(\\lambda R)} \\left(T_0 - T_{a} - \\frac{q_{met}}{\\omega_{b}}\\right) \\frac{\\sinh(\\lambda r)}{r} $$\nFinally, we transform back to the original temperature variable $T(r)$ using $T(r) = \\Theta(r) + T_a + \\frac{q_{met}}{\\omega_b}$:\n$$ T(r) = \\left(T_0 - T_{a} - \\frac{q_{met}}{\\omega_{b}}\\right) \\frac{R}{r} \\frac{\\sinh(\\lambda r)}{\\sinh(\\lambda R)} + T_{a} + \\frac{q_{met}}{\\omega_{b}} $$\nSubstituting $\\lambda = \\sqrt{\\frac{\\omega_{b}}{k}}$ gives the final expression for the radial temperature profile:\n$$ T(r) = \\left(T_0 - T_{a} - \\frac{q_{met}}{\\omega_{b}}\\right) \\frac{R}{r} \\frac{\\sinh\\left(r\\sqrt{\\frac{\\omega_{b}}{k}}\\right)}{\\sinh\\left(R\\sqrt{\\frac{\\omega_{b}}{k}}\\right)} + T_{a} + \\frac{q_{met}}{\\omega_{b}} $$\nThis expression provides the temperature $T$ at any radial position $r$ within the tumor, from $r=0$ to $r=R$, as a function of the given physical and geometric parameters.",
            "answer": "$$\\boxed{T(r) = T_{a} + \\frac{q_{met}}{\\omega_{b}} + \\left(T_{0} - T_{a} - \\frac{q_{met}}{\\omega_{b}}\\right) \\frac{R}{r} \\frac{\\sinh\\left(r\\sqrt{\\frac{\\omega_{b}}{k}}\\right)}{\\sinh\\left(R\\sqrt{\\frac{\\omega_{b}}{k}}\\right)}}$$"
        }
    ]
}