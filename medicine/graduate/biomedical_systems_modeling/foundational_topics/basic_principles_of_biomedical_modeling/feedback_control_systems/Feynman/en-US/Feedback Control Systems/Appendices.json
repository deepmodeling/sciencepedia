{
    "hands_on_practices": [
        {
            "introduction": "Before we can confidently use a model for prediction or control, we must ask a fundamental question: can its parameters be uniquely determined from experimental data? This property, known as structural identifiability, is a prerequisite for meaningful parameter estimation. This exercise  provides hands-on practice in testing for structural identifiability using the input-output equation method, a core skill for any systems modeler.",
            "id": "3885524",
            "problem": "Consider a one-compartment Pharmacokinetic (PK) model used in closed-loop drug delivery, where an intravenous infusion is adjusted by a controller to track a desired concentration trajectory. The state is the plasma drug concentration $c(t)$, the measured output is $y(t) = c(t)$, the compartment volume is $V > 0$, and the clearance is $CL > 0$. The mass balance in the compartment is given by $V \\,\\dot{c}(t) = u(t) - CL \\, c(t)$, where $u(t)$ is the infusion rate. A known proportional controller (a special case of Proportional-Integral-Derivative (PID) control) is applied such that $u(t) = K \\,\\big(r(t) - y(t)\\big)$, where $K > 0$ is a known constant gain and $r(t)$ is a known reference concentration trajectory that is designed by the clinician. Assume noiseless, continuous-time measurements of $y(t)$ and known $r(t)$, with $r(t)$ selected such that the resulting input-output dynamics are persistently exciting in the sense of linear system identification.\n\n1) Provide a precise definition of structural identifiability for a parametric dynamical system with measured output and known input, in terms of uniqueness of the parameter-to-output mapping for almost all admissible inputs and initial conditions in the noise-free case.\n\n2) Starting from the mass balance and controller equations above, eliminate the unmeasured states and derive the input-output differential equation that relates $y(t)$ and $r(t)$ and depends only on the unknown parameters $V$ and $CL$ and the known gain $K$.\n\n3) Test structural identifiability of $V$ and $CL$ using the input-output equation from part (2) by examining the injectivity of the mapping from the unknown parameters to the coefficients of the input-output relation. State any conditions necessary for injectivity.\n\n4) Let the input-output differential equation be written in the normalized (monic) form $\\dot{y}(t) + a \\, y(t) = b \\, r(t)$, where $a$ and $b$ are scalar coefficients that can, in principle, be identified from noiseless data $y(t)$ and known $r(t)$ under persistency of excitation. Express the clearance parameter $CL$ as a closed-form analytic expression in terms of the known controller gain $K$ and the identified coefficients $a$ and $b$. Provide your final answer as a single analytic expression. No numerical approximation is required and no units should be included in the final expression.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in standard pharmacokinetic modeling and control theory, is well-posed, objective, and self-contained. The provided information is sufficient and consistent for deriving a unique solution.\n\nThis problem consists of four parts. First, providing a definition of structural identifiability. Second, deriving an input-output differential equation. Third, analyzing the structural identifiability of the model parameters. Fourth, deriving a specific expression for the clearance parameter.\n\n1) Structural identifiability is a property of a parametric model structure that determines whether it is possible, in principle, to uniquely determine the values of the unknown parameters from ideal, noise-free input-output data. For a parametric dynamical system described by state equations $\\dot{\\mathbf{x}}(t) = \\mathbf{f}(\\mathbf{x}(t), u(t), \\boldsymbol{\\theta})$ and output equations $\\mathbf{y}(t) = \\mathbf{g}(\\mathbf{x}(t), \\boldsymbol{\\theta})$, where $\\boldsymbol{\\theta}$ is the vector of unknown parameters, the model is said to be structurally globally identifiable if, for almost all admissible inputs $u(t)$ and for any initial conditions, the equality of the outputs $\\mathbf{y}(t, \\boldsymbol{\\theta}_1) = \\mathbf{y}(t, \\boldsymbol{\\theta}_2)$ for all time $t \\geq 0$ necessarily implies that the parameter vectors are identical, $\\boldsymbol{\\theta}_1 = \\boldsymbol{\\theta}_2$. The model is structurally locally identifiable if for any $\\boldsymbol{\\theta}_1$ in the parameter space, there exists a neighborhood around it such that $\\mathbf{y}(t, \\boldsymbol{\\theta}_1) = \\mathbf{y}(t, \\boldsymbol{\\theta}_2)$ implies $\\boldsymbol{\\theta}_1 = \\boldsymbol{\\theta}_2$ for any $\\boldsymbol{\\theta}_2$ in that neighborhood. The analysis concerns the injectivity of the mapping from the parameter space to the space of possible noise-free outputs.\n\n2) We are given the following system equations:\nThe mass balance equation for the drug concentration $c(t)$:\n$$V \\,\\dot{c}(t) = u(t) - CL \\, c(t)$$\nThe proportional controller law:\n$$u(t) = K \\,\\big(r(t) - y(t)\\big)$$\nAnd the measurement equation:\n$$y(t) = c(t)$$\nThe parameters $V$ and $CL$ are unknown, while the controller gain $K$ is known. Both $V$, $CL$, and $K$ are strictly positive constants. The reference trajectory $r(t)$ is a known input, and $y(t)$ is the measured output.\n\nTo derive the input-output differential equation relating $y(t)$ and $r(t)$, we first substitute the measurement equation into the mass balance equation. Since $y(t) = c(t)$, it follows that their time derivatives are also equal, $\\dot{y}(t) = \\dot{c}(t)$. Substituting these into the mass balance equation gives:\n$$V \\,\\dot{y}(t) = u(t) - CL \\, y(t)$$\nNext, we substitute the expression for the control input $u(t)$ from the controller law into the above equation:\n$$V \\,\\dot{y}(t) = \\Big( K \\,\\big(r(t) - y(t)\\big) \\Big) - CL \\, y(t)$$\nNow, we expand the terms and rearrange the equation to group terms involving $y(t)$ and its derivative on the left-hand side and the term involving the input $r(t)$ on the right-hand side.\n$$V \\,\\dot{y}(t) = K \\, r(t) - K \\, y(t) - CL \\, y(t)$$\n$$V \\,\\dot{y}(t) + K \\, y(t) + CL \\, y(t) = K \\, r(t)$$\nFactoring out $y(t)$ on the left-hand side yields the final input-output differential equation:\n$$V \\,\\dot{y}(t) + (K + CL) \\, y(t) = K \\, r(t)$$\nThis is a first-order linear ordinary differential equation that relates the output $y(t)$ to the reference input $r(t)$, with coefficients that depend on the unknown parameters $V$ and $CL$ and the known gain $K$.\n\n3) To test for structural identifiability, we examine the mapping from the unknown parameters $\\{V, CL\\}$ to the coefficients of the input-output relation. The problem statement refers to a normalized (monic) form of the differential equation, which is obtained by dividing through by the coefficient of the highest-order derivative, $V$. Since $V>0$, this is always possible.\n$$\\dot{y}(t) + \\frac{K + CL}{V} \\, y(t) = \\frac{K}{V} \\, r(t)$$\nThis equation is of the general form $\\dot{y}(t) + c_1 y(t) = c_2 r(t)$. The assumption that the input $r(t)$ is \"persistently exciting\" ensures that the coefficients $c_1$ and $c_2$ can be uniquely determined from noise-free measurements of $y(t)$ and knowledge of $r(t)$. Let us define these identifiable coefficients:\n$$c_1 = \\frac{K + CL}{V}$$\n$$c_2 = \\frac{K}{V}$$\nThe structural identifiability of $V$ and $CL$ is established if we can find a unique solution for $V$ and $CL$ from these two equations, given that $K$ is known.\n\nFrom the equation for $c_2$, we can express $V$ as:\n$$V = \\frac{K}{c_2}$$\nFor this expression to be defined, we must have $c_2 \\neq 0$.\nNow, substitute this expression for $V$ into the equation for $c_1$:\n$$c_1 = \\frac{K + CL}{K/c_2} = \\frac{c_2 (K + CL)}{K}$$\nWe can now solve for $CL$:\n$$c_1 K = c_2 (K + CL)$$\n$$\\frac{c_1 K}{c_2} = K + CL$$\n$$CL = \\frac{c_1 K}{c_2} - K = K \\left( \\frac{c_1}{c_2} - 1 \\right)$$\nSince we have derived unique expressions for both $V$ and $CL$ in terms of the identifiable coefficients $c_1$ and $c_2$ and the known gain $K$, the parameters $V$ and $CL$ are structurally globally identifiable.\nThe necessary condition for injectivity of the mapping is that a solution can be calculated, which requires $c_2 \\neq 0$. Furthermore, for the parameters to be physically meaningful as per the problem statement ($V > 0$, $CL > 0$), the identified coefficients must satisfy certain conditions. Given $K > 0$:\n1. $V > 0$ requires $\\frac{K}{c_2} > 0$, which implies $c_2 > 0$.\n2. $CL > 0$ requires $K \\left( \\frac{c_1}{c_2} - 1 \\right) > 0$, which implies $\\frac{c_1}{c_2} > 1$, or $c_1 > c_2$.\nTherefore, the parameters are structurally identifiable, and for a physically meaningful result, the identified coefficients must satisfy $c_1 > c_2 > 0$.\n\n4) We are asked to express the clearance parameter $CL$ as a closed-form analytic expression in terms of the known controller gain $K$ and the identified coefficients $a$ and $b$ from the normalized input-output equation $\\dot{y}(t) + a \\, y(t) = b \\, r(t)$.\nBy comparing this form with the equation derived in part (3), we can equate the coefficients:\n$$a = c_1 = \\frac{K + CL}{V}$$\n$$b = c_2 = \\frac{K}{V}$$\nWe have a system of two algebraic equations for the two unknowns $V$ and $CL$. We seek an expression for $CL$. From the second equation, we solve for $V$:\n$$V = \\frac{K}{b}$$\nNow, we substitute this expression for $V$ into the first equation:\n$$a = \\frac{K + CL}{K / b}$$\nRearranging to solve for $CL$:\n$$a = \\frac{b(K + CL)}{K}$$\nMultiply both sides by $K$:\n$$aK = b(K + CL)$$\nDistribute $b$ on the right-hand side:\n$$aK = bK + b \\cdot CL$$\nIsolate the term with $CL$:\n$$b \\cdot CL = aK - bK$$\nFactor out $K$ on the right-hand side:\n$$b \\cdot CL = K(a - b)$$\nFinally, divide by $b$ (which must be non-zero for the system to be identifiable) to get the expression for $CL$:\n$$CL = \\frac{K(a - b)}{b}$$\nThis is the required closed-form analytic expression for the clearance parameter.",
            "answer": "$$\\boxed{\\frac{K(a-b)}{b}}$$"
        },
        {
            "introduction": "Time delays are ubiquitous in biological systems, arising from processes like cell signaling and transport, and can critically affect system stability. This practice demonstrates how to analyze a system with time delay by approximating it with a finite-dimensional 'linear chain' model. By deriving the characteristic equation and finding the critical delay at which instability occurs , you will gain insight into a powerful technique for predicting delay-induced oscillations.",
            "id": "3885548",
            "problem": "Consider a linear time-invariant (LTI) closed-loop model of a scalar biomedical variable $x(t)$ (for example, a regulated blood variable concentration deviation from setpoint) under negative feedback. The open-loop plant is a single compartment with first-order elimination and actuation effectiveness, described by the mass balance\n$$\n\\frac{d x(t)}{d t} = -a\\,x(t) + b\\,u_{\\text{del}}(t),\n$$\nwhere $a>0$ is the elimination rate, $b>0$ is the actuation effectiveness, and $u_{\\text{del}}(t)$ is the actuation after a distributed delay representing synthesis, transport, and receptor binding effects. The feedback controller is proportional, $u(t) = -k\\,x(t)$, where $k>0$.\n\nTo approximate the distributed delay with mean $\\tau>0$, use the linear chain trick with $N=2$ first-order stages, each with a common transition rate $\\alpha$, so that the mean delay satisfies $\\tau = \\frac{N}{\\alpha} = \\frac{2}{\\alpha}$. The chain states $z_{1}(t)$ and $z_{2}(t)$ satisfy mass-balance dynamics driven by the undelayed control signal $u(t)$, and the delayed actuation entering the plant is $u_{\\text{del}}(t) = z_{2}(t)$. Assume all signals are small deviations around a regulated equilibrium so that linearization is valid.\n\nStarting from these modeling assumptions and core definitions, construct the finite-dimensional approximation via the linear chain trick, derive the closed-loop characteristic equation, and analyze the stability change as the mean delay $\\tau$ increases (equivalently, as $\\alpha$ decreases). Under the assumption $b\\,k > 8 a$ so that a finite positive critical delay exists, determine the smallest positive mean delay $\\tau_{c}$ at which the closed-loop system first loses asymptotic stability via a pair of complex-conjugate roots crossing the imaginary axis. Express your final answer for $\\tau_{c}$ in seconds as a single closed-form analytic expression in terms of $a$, $b$, and $k$ with $a>0$, $b>0$, $k>0$. No numerical evaluation is required.",
            "solution": "The problem is well-posed, scientifically grounded, and contains sufficient information to determine a unique solution. It describes a standard problem in control theoryâ€”the stability analysis of a time-delayed feedback system. The use of the linear chain trick to approximate the distributed delay is a valid and common technique. The provided condition $b\\,k > 8 a$ ensures the existence of a finite critical delay for the system to lose stability, which is consistent with the physics of such systems. Therefore, the problem is valid.\n\nThe system dynamics are described by the following set of linear time-invariant (LTI) ordinary differential equations. The plant dynamics for the biomedical variable $x(t)$ are given by:\n$$\n\\frac{d x(t)}{d t} = -a\\,x(t) + b\\,u_{\\text{del}}(t)\n$$\nwhere $a>0$, $b>0$. The actuation signal $u_{\\text{del}}(t)$ is the output of a two-stage linear chain that approximates a distributed delay. The input to this chain is the proportional control law:\n$$\nu(t) = -k\\,x(t)\n$$\nwhere $k>0$. The linear chain with $N=2$ stages and transition rate $\\alpha$ is described by the state variables $z_1(t)$ and $z_2(t)$:\n$$\n\\frac{d z_1(t)}{d t} = \\alpha\\,(u(t) - z_1(t)) = \\alpha\\,(-k\\,x(t) - z_1(t))\n$$\n$$\n\\frac{d z_2(t)}{d t} = \\alpha\\,(z_1(t) - z_2(t))\n$$\nThe delayed actuation is the output of the second stage, $u_{\\text{del}}(t) = z_2(t)$. The mean delay is $\\tau = \\frac{N}{\\alpha} = \\frac{2}{\\alpha}$.\n\nWe can assemble these equations into a single state-space model. Let the state vector be $\\mathbf{v}(t) = \\begin{pmatrix} x(t) & z_1(t) & z_2(t) \\end{pmatrix}^T$. The system dynamics are $\\frac{d\\mathbf{v}}{dt} = \\mathbf{A}\\,\\mathbf{v}$, where the system matrix $\\mathbf{A}$ is:\n$$\n\\mathbf{A} = \\begin{pmatrix} -a & 0 & b \\\\ -\\alpha k & -\\alpha & 0 \\\\ 0 & \\alpha & -\\alpha \\end{pmatrix}\n$$\nThe stability of the system is determined by the eigenvalues of $\\mathbf{A}$, which are the roots of the characteristic equation $\\det(s\\mathbf{I} - \\mathbf{A}) = 0$.\n$$\n\\det \\begin{pmatrix} s+a & 0 & -b \\\\ \\alpha k & s+\\alpha & 0 \\\\ 0 & -\\alpha & s+\\alpha \\end{pmatrix} = 0\n$$\nWe compute the determinant by cofactor expansion along the first row:\n$$\n(s+a) \\det \\begin{pmatrix} s+\\alpha & 0 \\\\ -\\alpha & s+\\alpha \\end{pmatrix} - (0) \\cdot (\\dots) + (-b) \\det \\begin{pmatrix} \\alpha k & s+\\alpha \\\\ 0 & -\\alpha \\end{pmatrix} = 0\n$$\n$$\n(s+a)(s+\\alpha)^2 - b((\\alpha k)(-\\alpha) - 0) = 0\n$$\n$$\n(s+a)(s+\\alpha)^2 + b k \\alpha^2 = 0\n$$\nExpanding the polynomial gives the characteristic equation:\n$$\n(s+a)(s^2 + 2\\alpha s + \\alpha^2) + b k \\alpha^2 = 0\n$$\n$$\ns^3 + 2\\alpha s^2 + \\alpha^2 s + a s^2 + 2a\\alpha s + a\\alpha^2 + b k \\alpha^2 = 0\n$$\n$$\ns^3 + (a+2\\alpha)s^2 + \\alpha(\\alpha+2a)s + \\alpha^2(a+bk) = 0\n$$\nThe system loses stability when a pair of complex-conjugate roots crosses the imaginary axis. This occurs when there is a root $s=i\\omega$ for some real frequency $\\omega > 0$. We substitute $s=i\\omega$ into the characteristic equation:\n$$\n(i\\omega)^3 + (a+2\\alpha)(i\\omega)^2 + \\alpha(\\alpha+2a)(i\\omega) + \\alpha^2(a+bk) = 0\n$$\n$$\n-i\\omega^3 - (a+2\\alpha)\\omega^2 + i\\alpha(\\alpha+2a)\\omega + \\alpha^2(a+bk) = 0\n$$\nFor this equation to hold, both the real and imaginary parts must be zero.\nReal part:\n$$\n-(a+2\\alpha)\\omega^2 + \\alpha^2(a+bk) = 0 \\quad (1)\n$$\nImaginary part:\n$$\n-\\omega^3 + \\alpha(\\alpha+2a)\\omega = 0\n$$\nFactoring the imaginary part equation gives $\\omega(-\\omega^2 + \\alpha(\\alpha+2a)) = 0$. One solution is $\\omega=0$, which corresponds to a non-oscillatory instability. If $s=0$, the characteristic equation becomes $\\alpha^2(a+bk)=0$. Since $a, b, k, \\alpha$ are all positive, this cannot be zero. Therefore, stability is lost through an oscillatory instability (Hopf bifurcation), meaning $\\omega \\neq 0$. This implies:\n$$\n\\omega^2 = \\alpha(\\alpha+2a) \\quad (2)\n$$\nSince $\\omega^2 > 0$ and $a>0$, this requires $\\alpha>0$, which is consistent with its definition as a rate. Now we substitute this expression for $\\omega^2$ into the real part equation $(1)$:\n$$\n-(a+2\\alpha)[\\alpha(\\alpha+2a)] + \\alpha^2(a+bk) = 0\n$$\nSince the critical value of $\\alpha$ must be positive, we can divide by $\\alpha$:\n$$\n-(a+2\\alpha)(\\alpha+2a) + \\alpha(a+bk) = 0\n$$\n$$\n-(2\\alpha^2 + 4a\\alpha + a\\alpha + 2a^2) + \\alpha a + \\alpha bk = 0\n$$\n$$\n-2\\alpha^2 - 5a\\alpha - 2a^2 + a\\alpha + bk\\alpha = 0\n$$\n$$\n-2\\alpha^2 + (bk - 4a)\\alpha - 2a^2 = 0\n$$\nMultiplying by $-1$ gives a quadratic equation for the critical value(s) of $\\alpha$, denoted $\\alpha_c$:\n$$\n2\\alpha_c^2 - (bk-4a)\\alpha_c + 2a^2 = 0\n$$\nWe solve for $\\alpha_c$ using the quadratic formula:\n$$\n\\alpha_c = \\frac{(bk-4a) \\pm \\sqrt{(-(bk-4a))^2 - 4(2)(2a^2)}}{2(2)}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{(bk-4a)^2 - 16a^2}}{4}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{b^2k^2 - 8abk + 16a^2 - 16a^2}}{4}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{b^2k^2 - 8abk}}{4} = \\frac{bk-4a \\pm \\sqrt{bk(bk - 8a)}}{4}\n$$\nThe problem states that $bk > 8a$, which ensures that the discriminant $bk(bk-8a)$ is positive, so two distinct positive real roots for $\\alpha_c$ exist. Let's call them $\\alpha_{c1}$ and $\\alpha_{c2}$.\nThe system is stable when the Routh-Hurwitz conditions are met. The critical condition is $p_2 p_1 - p_0 > 0$, where $p_2=(a+2\\alpha)$, $p_1=\\alpha(\\alpha+2a)$, and $p_0=\\alpha^2(a+bk)$. The stability boundary is where $p_2 p_1 - p_0 = 0$, which led to our quadratic equation for $\\alpha_c$. The expression $2\\alpha^2 - (bk-4a)\\alpha + 2a^2$ is a parabola opening upwards. It is negative between its roots $\\alpha_{c2}$ (smaller root) and $\\alpha_{c1}$ (larger root), which corresponds to instability.\nThe system starts with a very small delay $\\tau \\approx 0$, which corresponds to a very large rate $\\alpha \\to \\infty$. In this limit, the system is stable. As the delay $\\tau$ increases from $0$, $\\alpha = 2/\\tau$ decreases from $\\infty$. The system first loses stability when $\\alpha$ decreases to the larger root, $\\alpha_{c1}$:\n$$\n\\alpha_{c1} = \\frac{bk-4a + \\sqrt{bk(bk - 8a)}}{4}\n$$\nThe problem asks for the smallest positive mean delay $\\tau_c$ at which the system first loses stability. This corresponds to the largest critical rate, $\\alpha_{c1}$. The critical delay is:\n$$\n\\tau_c = \\frac{2}{\\alpha_{c1}} = \\frac{2}{\\frac{bk-4a + \\sqrt{bk(bk - 8a)}}{4}}\n$$\n$$\n\\tau_c = \\frac{8}{bk-4a + \\sqrt{bk(bk - 8a)}}\n$$\nThis is the closed-form expression for the critical delay.",
            "answer": "$$\\boxed{\\frac{8}{bk-4a + \\sqrt{bk(bk - 8a)}}}$$"
        },
        {
            "introduction": "Modern controllers are typically implemented on digital computers, which interact with continuous biological systems at discrete time intervals. To design such a controller, one must first derive an accurate discrete-time model that describes the system's evolution from one sampling instant to the next. This exercise  guides you through this crucial conversion process, deriving the exact discrete-time equivalent of a continuous-time pharmacokinetic model under a zero-order hold assumption.",
            "id": "3885564",
            "problem": "Consider a two-compartment intravenous pharmacokinetic (PK) model used for feedback control of drug infusion in a sedated patient. Let the states be the drug amounts $x_{1}(t)$ in the central compartment and $x_{2}(t)$ in the peripheral compartment, respectively. The input $u(t)$ is the infusion rate into the central compartment (mass per unit time). The intercompartmental transfer rate constants are $k_{12} > 0$ (from central to peripheral) and $k_{21} > 0$ (from peripheral to central), and the elimination rate constant from the central compartment is $k_{10} > 0$. Under mass balance principles and first-order kinetics, the continuous-time linear time-invariant model is\n$$\n\\frac{d}{dt}\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix}\n-(k_{10} + k_{12}) & k_{21} \\\\\nk_{12} & -k_{21}\n\\end{pmatrix}}_{A}\n\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n+\n\\underbrace{\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}}_{B} u(t).\n$$\nA digital controller samples the system every $T_{s} > 0$ seconds, and applies a piecewise-constant command to the infusion pump over each sampling interval. Specifically, under Zero-Order Hold (ZOH), the input is held constant on each sampling interval: $u(t) = u_{k}$ for $t \\in [k T_{s}, (k+1) T_{s})$, where $u_{k}$ is the sampled input computed by the controller at time $k T_{s}$.\n\nDerive the discrete-time model of the form $x_{k+1} = A_{d} x_{k} + B_{d} u_{k}$ implied by the above continuous-time dynamics and ZOH input, where $x_{k} \\triangleq x(k T_{s})$. Express $A_{d}$ and $B_{d}$ as closed-form analytic expressions in terms of $A$, $B$, and $T_{s}$. You must provide symbolic expressions only; do not substitute numerical values. The final answer must be the ordered pair $(A_{d}, B_{d})$ written in a single row using a matrix notation, and you should not include physical units in the final answer.",
            "solution": "The starting point is the continuous-time linear time-invariant state-space model derived from mass balance with first-order kinetics:\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\nwhere $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$ is the state vector of drug amounts, $u(t)$ is the infusion rate input, and the matrices\n$$\nA = \\begin{pmatrix}\n-(k_{10} + k_{12}) & k_{21} \\\\\nk_{12} & -k_{21}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\ncollect the rate constants and input distribution across compartments. The model is linear time-invariant and hence its solution under any input is well described by the variation-of-constants formula, a well-tested result in linear systems theory:\n$$\nx(t) = \\exp(A (t - t_{0})) x(t_{0}) + \\int_{t_{0}}^{t} \\exp(A (t - \\tau)) B u(\\tau) \\, d\\tau,\n$$\nwhere $\\exp(\\cdot)$ denotes the matrix exponential and $t_{0}$ is an initial time.\n\nUnder Zero-Order Hold (ZOH), $u(t)$ is piecewise constant on each sampling interval, namely $u(t) = u_{k}$ for $t \\in [k T_{s}, (k+1) T_{s})$. Setting $t_{0} = k T_{s}$ and $t = (k+1) T_{s}$, and defining $x_{k} \\triangleq x(k T_{s})$ and $x_{k+1} \\triangleq x((k+1) T_{s})$, the solution becomes\n$$\nx_{k+1} = \\exp(A T_{s}) x_{k} + \\int_{k T_{s}}^{(k+1) T_{s}} \\exp(A ((k+1) T_{s} - \\tau)) B u(\\tau) \\, d\\tau.\n$$\nSince $u(\\tau) = u_{k}$ is constant over $[k T_{s}, (k+1) T_{s})$, we can factor $u_{k}$ out of the integral and change variables. Let $\\theta = (k+1) T_{s} - \\tau$, so as $\\tau$ goes from $k T_{s}$ to $(k+1) T_{s}$, $\\theta$ goes from $T_{s}$ down to $0$. Reversing the limits,\n$$\n\\int_{k T_{s}}^{(k+1) T_{s}} \\exp(A ((k+1) T_{s} - \\tau)) B \\, d\\tau\n= \\int_{0}^{T_{s}} \\exp(A \\theta) B \\, d\\theta.\n$$\nTherefore, the exact discrete-time model under ZOH is\n$$\nx_{k+1} = A_{d} x_{k} + B_{d} u_{k},\n$$\nwith\n$$\nA_{d} = \\exp(A T_{s}), \\qquad B_{d} = \\int_{0}^{T_{s}} \\exp(A \\theta) B \\, d\\theta.\n$$\n\nTo obtain a closed-form expression for $B_{d}$, we use a well-known identity for the integral of the matrix exponential. Provided $A$ is nonsingular, which holds here because\n$$\n\\det(A) = k_{10} k_{21} > 0,\n$$\nwe have\n$$\n\\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta = A^{-1} \\left( \\exp(A T_{s}) - I \\right),\n$$\nwhere $I$ is the identity matrix of appropriate dimension. This identity follows from differentiating $\\exp(A \\theta)$ with respect to $\\theta$ and observing that $A \\exp(A \\theta) = \\frac{d}{d\\theta} \\exp(A \\theta)$, yielding\n$$\n\\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta\n= \\left[ A^{-1} \\exp(A \\theta) \\right]_{0}^{T_{s}}\n= A^{-1} \\left( \\exp(A T_{s}) - I \\right).\n$$\nMultiplying on the right by $B$ gives\n$$\nB_{d} = \\left( \\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta \\right) B\n= A^{-1} \\left( \\exp(A T_{s}) - I \\right) B.\n$$\n\nCollecting results, the discrete-time model matrices are\n$$\nA_{d} = \\exp(A T_{s}), \\qquad B_{d} = A^{-1} \\left( \\exp(A T_{s}) - I \\right) B,\n$$\nwhich are closed-form analytic expressions in terms of $A$, $B$, and $T_{s}$, valid under Zero-Order Hold sampling of the PK model.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\exp(A T_{s}) & A^{-1}\\!\\left(\\exp(A T_{s}) - I\\right) B \\end{pmatrix}}$$"
        }
    ]
}