{
    "hands_on_practices": [
        {
            "introduction": "生物医学系统本质上是连续时间的，但现代控制器通常是数字化的，以离散的时间步长运行。本练习旨在弥合这一差距，指导您将一个连续时间的药代动力学（PK）模型转换为其精确的离散时间等效形式，这对于设计和实现基于模型的数字反馈控制器至关重要。 通过掌握零阶保持（ZOH）的离散化方法，您将学会如何准确预测系统在采样时刻之间的行为。",
            "id": "3885564",
            "problem": "考虑一个用于镇静患者药物输注反馈控制的双室静脉药代动力学（PK）模型。设状态分别为中央室的药物量 $x_{1}(t)$ 和外周室的药物量 $x_{2}(t)$。输入 $u(t)$ 是进入中央室的输注速率（单位时间的质量）。室间转运速率常数分别为 $k_{12} > 0$（从中央室到外周室）和 $k_{21} > 0$（从外周室到中央室），从中央室的消除速率常数为 $k_{10} > 0$。根据质量平衡原理和一级动力学，连续时间线性时不变模型为\n$$\n\\frac{d}{dt}\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix}\n-(k_{10} + k_{12})  k_{21} \\\\\nk_{12}  -k_{21}\n\\end{pmatrix}}_{A}\n\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n+\n\\underbrace{\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}}_{B} u(t).\n$$\n一个数字控制器每 $T_{s}  0$ 秒对系统进行一次采样，并在每个采样间隔内向输液泵施加一个分段常数指令。具体来说，在零阶保持器（ZOH）下，每个采样间隔内的输入保持恒定：对于 $t \\in [k T_{s}, (k+1) T_{s})$，有 $u(t) = u_{k}$，其中 $u_{k}$ 是控制器在时间 $k T_{s}$ 计算出的采样输入。\n\n根据上述连续时间动态和ZOH输入，推导形式为 $x_{k+1} = A_{d} x_{k} + B_{d} u_{k}$ 的离散时间模型，其中 $x_{k} \\triangleq x(k T_{s})$。将 $A_{d}$ 和 $B_{d}$ 表示为以 $A$、$B$ 和 $T_{s}$ 表示的闭式解析表达式。您必须只提供符号表达式；不要代入数值。最终答案必须是使用矩阵表示法写在单行中的有序对 $(A_{d}, B_{d})$，并且最终答案中不应包含物理单位。",
            "solution": "出发点是由质量平衡和一级动力学推导出的连续时间线性时不变状态空间模型：\n$$\n\\dot{x}(t) = A x(t) + B u(t),\n$$\n其中 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$ 是药物量的状态向量，$u(t)$ 是输注速率输入，矩阵\n$$\nA = \\begin{pmatrix}\n-(k_{10} + k_{12})  k_{21} \\\\\nk_{12}  -k_{21}\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n集合了速率常数和输入在各室的分布。该模型是线性时不变的，因此其在任何输入下的解都可以通过常数变易法很好地描述，这是线性系统理论中一个经过充分检验的结果：\n$$\nx(t) = \\exp(A (t - t_{0})) x(t_{0}) + \\int_{t_{0}}^{t} \\exp(A (t - \\tau)) B u(\\tau) \\, d\\tau,\n$$\n其中 $\\exp(\\cdot)$ 表示矩阵指数，$t_{0}$ 是初始时间。\n\n在零阶保持器（ZOH）下，$u(t)$ 在每个采样间隔上是分段常数，即对于 $t \\in [k T_{s}, (k+1) T_{s})$ 有 $u(t) = u_{k}$。设 $t_{0} = k T_{s}$ 和 $t = (k+1) T_{s}$，并定义 $x_{k} \\triangleq x(k T_{s})$ 和 $x_{k+1} \\triangleq x((k+1) T_{s})$，解变为\n$$\nx_{k+1} = \\exp(A T_{s}) x_{k} + \\int_{k T_{s}}^{(k+1) T_{s}} \\exp(A ((k+1) T_{s} - \\tau)) B u(\\tau) \\, d\\tau.\n$$\n由于 $u(\\tau) = u_{k}$ 在 $[k T_{s}, (k+1) T_{s})$ 上是常数，我们可以将 $u_{k}$ 从积分中提出来并进行变量替换。令 $\\theta = (k+1) T_{s} - \\tau$，那么当 $\\tau$ 从 $k T_{s}$ 变化到 $(k+1) T_{s}$ 时，$\\theta$ 从 $T_{s}$ 递减到 $0$。反转积分限，\n$$\n\\int_{k T_{s}}^{(k+1) T_{s}} \\exp(A ((k+1) T_{s} - \\tau)) B \\, d\\tau\n= \\int_{0}^{T_{s}} \\exp(A \\theta) B \\, d\\theta.\n$$\n因此，ZOH下的精确离散时间模型为\n$$\nx_{k+1} = A_{d} x_{k} + B_{d} u_{k},\n$$\n其中\n$$\nA_{d} = \\exp(A T_{s}), \\qquad B_{d} = \\int_{0}^{T_{s}} \\exp(A \\theta) B \\, d\\theta.\n$$\n\n为了得到 $B_{d}$ 的闭式表达式，我们使用一个关于矩阵指数积分的著名恒等式。假定 $A$ 是非奇异的，此条件在此成立，因为\n$$\n\\det(A) = k_{21} k_{10}  0,\n$$\n我们有\n$$\n\\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta = A^{-1} \\left( \\exp(A T_{s}) - I \\right),\n$$\n其中 $I$ 是适当维度的单位矩阵。这个恒等式可以通过对 $\\exp(A \\theta)$ 关于 $\\theta$ 求导并观察到 $A \\exp(A \\theta) = \\frac{d}{d\\theta} \\exp(A \\theta)$ 而得出，从而得到\n$$\n\\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta\n= \\left[ A^{-1} \\exp(A \\theta) \\right]_{0}^{T_{s}}\n= A^{-1} \\left( \\exp(A T_{s}) - I \\right).\n$$\n在右侧乘以 $B$ 得到\n$$\nB_{d} = \\left( \\int_{0}^{T_{s}} \\exp(A \\theta) \\, d\\theta \\right) B\n= A^{-1} \\left( \\exp(A T_{s}) - I \\right) B.\n$$\n\n汇总结果，离散时间模型的矩阵为\n$$\nA_{d} = \\exp(A T_{s}), \\qquad B_{d} = A^{-1} \\left( \\exp(A T_{s}) - I \\right) B,\n$$\n这些是关于 $A$、$B$ 和 $T_{s}$ 的闭式解析表达式，在对PK模型进行零阶保持采样的情况下有效。",
            "answer": "$$\\boxed{( \\exp(A T_{s}), A^{-1}(\\exp(A T_{s}) - I)B )}$$"
        },
        {
            "introduction": "建立一个数学模型结构只是第一步；一个更深层次的问题是：我们能否从实验数据中唯一地确定模型的参数？本练习介绍了结构可辨识性的关键概念，它允许我们在收集任何数据之前，从理论上评估模型参数是否可以被唯一确定。 通过分析一个闭环给药系统的输入-输出关系，您将练习一种检验可辨识性的方法，这是确保模型预测可靠性和后续控制设计有效性的基础。",
            "id": "3885524",
            "problem": "考虑一个用于闭环给药的单室药代动力学（PK）模型，其中静脉输注由控制器调节，以追踪期望的浓度轨迹。状态是血浆药物浓度 $c(t)$，测量输出是 $y(t) = c(t)$，室体积为 $V  0$，清除率为 $CL  0$。该室中的质量平衡由 $V \\,\\dot{c}(t) = u(t) - CL \\, c(t)$ 给出，其中 $u(t)$ 是输注速率。应用一个已知的比例控制器（比例-积分-微分（PID）控制的一个特例），使得 $u(t) = K \\,\\big(r(t) - y(t)\\big)$，其中 $K  0$ 是一个已知的恒定增益，$r(t)$ 是由临床医生设计的已知参考浓度轨迹。假设对 $y(t)$ 进行无噪声的连续时间测量，且 $r(t)$ 已知，并且选择的 $r(t)$ 使得在线性系统辨识意义上，所得到的输入-输出动态是持续激励的。\n\n1) 对于一个具有测量输出和已知输入的参数化动力系统，根据在无噪声情况下对于几乎所有容许输入和初始条件，参数到输出映射的唯一性，给出结构可辨识性的精确定义。\n\n2) 从上面的质量平衡和控制器方程出发，消去未测量的状态，推导关联 $y(t)$ 和 $r(t)$ 且仅依赖于未知参数 $V$ 和 $CL$ 以及已知增益 $K$ 的输入-输出微分方程。\n\n3) 使用第 (2) 部分得到的输入-输出方程，通过检验从未知参数到输入-输出关系系数的映射的单射性，来检验 $V$ 和 $CL$ 的结构可辨识性。陈述单射性所需的任何必要条件。\n\n4) 设输入-输出微分方程写作归一化（首一）形式 $\\dot{y}(t) + a \\, y(t) = b \\, r(t)$，其中 $a$ 和 $b$ 是标量系数，原则上可以在持续激励条件下从无噪声数据 $y(t)$ 和已知 $r(t)$ 中辨识出来。将清除率参数 $CL$ 表示为已知控制器增益 $K$ 和已辨识系数 $a$ 和 $b$ 的闭式解析表达式。以单个解析表达式的形式提供最终答案。不需要数值近似，最终表达式中不应包含单位。",
            "solution": "1) 结构可辨识性是参数化模型结构的一种属性，它决定了原则上是否可能从理想的、无噪声的输入-输出数据中唯一地确定未知参数的值。对于由状态方程 $\\dot{\\mathbf{x}}(t) = \\mathbf{f}(\\mathbf{x}(t), u(t), \\boldsymbol{\\theta})$ 和输出方程 $\\mathbf{y}(t) = \\mathbf{g}(\\mathbf{x}(t), \\boldsymbol{\\theta})$ 描述的参数化动力系统，其中 $\\boldsymbol{\\theta}$ 是未知参数的向量，如果对于几乎所有容许输入 $u(t)$ 和任何初始条件，输出相等 $\\mathbf{y}(t, \\boldsymbol{\\theta}_1) = \\mathbf{y}(t, \\boldsymbol{\\theta}_2)$（对于所有时间 $t \\geq 0$）必然意味着参数向量相同，即 $\\boldsymbol{\\theta}_1 = \\boldsymbol{\\theta}_2$，则称该模型是结构全局可辨识的。如果对于参数空间中的任何 $\\boldsymbol{\\theta}_1$，都存在一个其邻域，使得对于该邻域中的任何 $\\boldsymbol{\\theta}_2$，$\\mathbf{y}(t, \\boldsymbol{\\theta}_1) = \\mathbf{y}(t, \\boldsymbol{\\theta}_2)$ 均能推出 $\\boldsymbol{\\theta}_1 = \\boldsymbol{\\theta}_2$，则该模型是结构局部可辨识的。该分析关注的是从参数空间到可能的无噪声输出空间的映射的单射性。\n\n2) 给定以下系统方程：\n药物浓度 $c(t)$ 的质量平衡方程：\n$$V \\,\\dot{c}(t) = u(t) - CL \\, c(t)$$\n比例控制器定律：\n$$u(t) = K \\,\\big(r(t) - y(t)\\big)$$\n以及测量方程：\n$$y(t) = c(t)$$\n参数 $V$ 和 $CL$ 是未知的，而控制器增益 $K$ 是已知的。$V$、$CL$ 和 $K$ 都是严格正常数。参考轨迹 $r(t)$ 是已知输入，而 $y(t)$ 是测量输出。\n\n为了推导关联 $y(t)$ 和 $r(t)$ 的输入-输出微分方程，我们首先将测量方程代入质量平衡方程。由于 $y(t) = c(t)$，因此它们的时间导数也相等，即 $\\dot{y}(t) = \\dot{c}(t)$。将这些代入质量平衡方程得到：\n$$V \\,\\dot{y}(t) = u(t) - CL \\, y(t)$$\n接下来，我们将控制器定律中控制输入 $u(t)$ 的表达式代入上述方程：\n$$V \\,\\dot{y}(t) = \\Big( K \\,\\big(r(t) - y(t)\\big) \\Big) - CL \\, y(t)$$\n现在，我们展开各项并重新整理方程，将涉及 $y(t)$ 及其导数的项组合在左侧，将涉及输入 $r(t)$ 的项放在右侧。\n$$V \\,\\dot{y}(t) = K \\, r(t) - K \\, y(t) - CL \\, y(t)$$\n$$V \\,\\dot{y}(t) + K \\, y(t) + CL \\, y(t) = K \\, r(t)$$\n在左侧提取公因式 $y(t)$，得到最终的输入-输出微分方程：\n$$V \\,\\dot{y}(t) + (K + CL) \\, y(t) = K \\, r(t)$$\n这是一个一阶线性常微分方程，它将输出 $y(t)$ 与参考输入 $r(t)$ 联系起来，其系数依赖于未知参数 $V$ 和 $CL$ 以及已知增益 $K$。\n\n3) 为了检验结构可辨识性，我们考察从未知参数 $\\{V, CL\\}$ 到输入-输出关系系数的映射。问题陈述中提到了微分方程的归一化（首一）形式，这可以通过除以最高阶导数的系数 $V$ 来获得。由于 $V0$，这总是可能的。\n$$\\dot{y}(t) + \\frac{K + CL}{V} \\, y(t) = \\frac{K}{V} \\, r(t)$$\n这个方程具有一般形式 $\\dot{y}(t) + c_1 y(t) = c_2 r(t)$。输入 $r(t)$ 是“持续激励”的假设确保了系数 $c_1$ 和 $c_2$ 可以从无噪声的 $y(t)$ 测量值和已知的 $r(t)$ 中唯一确定。我们定义这些可辨识系数：\n$$c_1 = \\frac{K + CL}{V}$$\n$$c_2 = \\frac{K}{V}$$\n如果我们能从这两个方程中找到 $V$ 和 $CL$ 的唯一解（假定 $K$ 已知），那么 $V$ 和 $CL$ 的结构可辨识性就得以确立。\n\n从关于 $c_2$ 的方程中，我们可以将 $V$ 表示为：\n$$V = \\frac{K}{c_2}$$\n为了使该表达式有定义，我们必须有 $c_2 \\neq 0$。\n现在，将这个 $V$ 的表达式代入关于 $c_1$ 的方程：\n$$c_1 = \\frac{K + CL}{K/c_2} = \\frac{c_2 (K + CL)}{K}$$\n我们现在可以求解 $CL$：\n$$c_1 K = c_2 (K + CL)$$\n$$\\frac{c_1 K}{c_2} = K + CL$$\n$$CL = \\frac{c_1 K}{c_2} - K = K \\left( \\frac{c_1}{c_2} - 1 \\right)$$\n由于我们已经用可辨识系数 $c_1$ 和 $c_2$ 以及已知增益 $K$ 推导出了 $V$ 和 $CL$ 的唯一表达式，因此参数 $V$ 和 $CL$ 是结构全局可辨识的。\n映射单射性的必要条件是解可以被计算出来，这要求 $c_2 \\neq 0$。此外，为了使参数根据问题陈述具有物理意义（$V  0$, $CL  0$），已辨识的系数必须满足某些条件。给定 $K  0$：\n1. $V  0$ 要求 $\\frac{K}{c_2}  0$，这意味着 $c_2  0$。\n2. $CL  0$ 要求 $K \\left( \\frac{c_1}{c_2} - 1 \\right)  0$，这意味着 $\\frac{c_1}{c_2}  1$，即 $c_1  c_2$。\n因此，这些参数是结构可辨识的，并且为了得到具有物理意义的结果，已辨识的系数必须满足 $c_1  c_2  0$。\n\n4) 我们被要求将清除率参数 $CL$ 表示为已知控制器增益 $K$ 和从归一化输入-输出方程 $\\dot{y}(t) + a \\, y(t) = b \\, r(t)$ 中辨识出的系数 $a$ 和 $b$ 的闭式解析表达式。通过将此形式与第 (3) 部分推导的方程进行比较，我们可以令系数相等：\n$$a = c_1 = \\frac{K + CL}{V}$$\n$$b = c_2 = \\frac{K}{V}$$\n我们得到了一个关于两个未知数 $V$ 和 $CL$ 的二元代数方程组。我们寻求 $CL$ 的表达式。从第二个方程，我们解出 $V$：\n$$V = \\frac{K}{b}$$\n现在，我们将这个 $V$ 的表达式代入第一个方程：\n$$a = \\frac{K + CL}{K / b}$$\n重新整理以求解 $CL$：\n$$a = \\frac{b(K + CL)}{K}$$\n两边同乘以 $K$：\n$$aK = b(K + CL)$$\n在右侧展开 $b$：\n$$aK = bK + b \\cdot CL$$\n分离含有 $CL$ 的项：\n$$b \\cdot CL = aK - bK$$\n在右侧提取公因式 $K$：\n$$b \\cdot CL = K(a - b)$$\n最后，除以 $b$（为使系统可辨识，该值必须非零），得到 $CL$ 的表达式：\n$$CL = \\frac{K(a - b)}{b}$$\n这就是所求的清除率参数的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{K(a-b)}{b}}$$"
        },
        {
            "introduction": "许多生理过程表现出固有的非线性行为，这给标准线性控制器的设计带来了挑战。本练习将引导您应用一种强大的非线性控制技术——精确输入-输出线性化——将一个非线性生理级联模型转化为一个等效的线性系统。 更重要的是，您将分析由此产生的“零动态”，这是确保系统内部状态在输出被完美控制时保持稳定的关键一步，从而避免潜在的危险的隐藏不稳定性。",
            "id": "3885559",
            "problem": "一个三态单输入单输出（SISO）生理级联被建模为一个控制仿射非线性系统，其状态向量为 $x = (x_{1}, x_{2}, x_{3})$，其中 $x_{1}$ 表示循环生物标志物浓度，$x_{2}$ 是一个中间介质，$x_{3}$ 是一个受体占据状态。输注控制输入 $u$ 作用于该中间介质。其动力学方程为\n$$\n\\begin{aligned}\n\\dot{x}_{1} = -a\\,x_{1} + x_{2}, \\\\\n\\dot{x}_{2} = -b\\,x_{2} + s\\,x_{3} + u, \\\\\n\\dot{x}_{3} = -c\\,x_{3} + d\\,x_{2},\n\\end{aligned}\n$$\n其中常数 $a, b, c, d, s \\in \\mathbb{R}_{0}$ 均为严格正值。测量输出选择为 $y = h(x) = x_{1} + p\\,x_{3}$，其中 $p \\in \\mathbb{R}$ 是一个设计参数。\n\n从控制仿射系统的李导数定义出发，即 $L_{f} h(x) = \\nabla h(x) \\cdot f(x)$ 和 $L_{g} h(x) = \\nabla h(x) \\cdot g(x)$，其中 $f(x)$ 是漂移向量场，$g(x)$ 是输入向量场（在 $\\dot{x} = f(x) + g(x)\\,u$ 中），执行以下操作：\n\n1. 计算一阶李导数 $L_{f} h(x)$ 和 $L_{g} h(x)$，并在条件 $p \\neq -\\frac{1}{d}$ 下确定在 $x$ 点的相对阶。\n2. 计算为实现相对阶为二的精确输入-输出线性化所需的高阶李导数，具体为 $L_{f}^{2} h(x)$ 和 $L_{g} L_{f} h(x)$。\n3. 使用SISO控制仿射系统的基本输入-输出线性化原理（不使用问题中给出的任何快捷公式），推导状态依赖的输入变换，该变换将输入-输出动力学变为二阶线性，且新输入为 $v$，使得闭环输入-输出行为是一个由 $v$ 驱动的二重积分器。\n4. 推导与通过限制在零输出流形 $y \\equiv 0$ 和 $v \\equiv 0$ 上获得的内部坐标相关的零动态。说明 $p$ 的选择如何影响零动态的稳定性，并选择 $p$ 以确保内部动力学的指数稳定性。从第一性原理出发证明你的选择。\n\n你的最终答案必须是关于输入变换的单个闭式解析表达式，用 $x_{1}$、$x_{2}$、$x_{3}$、$a$、$b$、$c$、$d$、$s$、$p$ 和 $v$ 表示。最终答案中不要包含等号。无需单位。无需四舍五入。",
            "solution": "系统动力学由 $\\dot{x} = f(x) + g(x)u$ 给出，其中 $x = (x_{1}, x_{2}, x_{3})$ 是状态向量，$u$ 是控制输入。\n根据给定的方程：\n$$\n\\begin{pmatrix} \\dot{x}_{1} \\\\ \\dot{x}_{2} \\\\ \\dot{x}_{3} \\end{pmatrix} = \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} u\n$$\n漂移向量场 $f(x)$ 和输入向量场 $g(x)$ 分别为：\n$$\nf(x) = \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n输出为 $y = h(x) = x_{1} + p\\,x_{3}$。\n\n**1. 一阶李导数与相对阶**\n\n为了求相对阶，我们连续计算 $h(x)$ 的李导数，直到输入 $u$ 显式出现。输出的时间导数为 $\\dot{y} = \\frac{\\partial h}{\\partial x} \\dot{x} = \\nabla h(x) \\cdot (f(x) + g(x)u) = L_f h(x) + L_g h(x) u$。\n\n$h(x)$ 的梯度为 $\\nabla h(x) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1}  \\frac{\\partial h}{\\partial x_2}  \\frac{\\partial h}{\\partial x_3} \\end{pmatrix} = \\begin{pmatrix} 1  0  p \\end{pmatrix}$。\n\n首先，我们计算 $h(x)$ 关于 $g(x)$ 的李导数：\n$$\nL_{g} h(x) = \\nabla h(x) \\cdot g(x) = \\begin{pmatrix} 1  0  p \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 0\n$$\n由于 $L_{g} h(x) = 0$，输入 $u$ 不出现在输出的一阶导数中。相对阶至少为二。\n\n接下来，我们计算 $h(x)$ 关于 $f(x)$ 的李导数：\n$$\nL_{f} h(x) = \\nabla h(x) \\cdot f(x) = \\begin{pmatrix} 1  0  p \\end{pmatrix} \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}\n$$\n$$\nL_{f} h(x) = 1(-a\\,x_{1} + x_{2}) + 0(-b\\,x_{2} + s\\,x_{3}) + p(-c\\,x_{3} + d\\,x_{2}) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3}\n$$\n所以，输出的一阶时间导数为 $\\dot{y} = L_{f} h(x)$。\n\n**2. 相对阶为二时的高阶李导数**\n\n为了求输出的二阶导数，我们对 $\\dot{y}$ 求导：\n$$\n\\ddot{y} = \\frac{d}{dt}(L_{f} h(x)) = \\nabla(L_{f} h(x)) \\cdot \\dot{x} = \\nabla(L_{f} h(x)) \\cdot (f(x) + g(x)u)\n$$\n$$\n\\ddot{y} = L_{f}^{2} h(x) + L_{g} L_{f} h(x) u\n$$\n我们需要计算 $L_{f}^{2} h(x)$ 和 $L_{g} L_{f} h(x)$ 这两项。令 $\\psi(x) = L_{f} h(x) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3}$。$\\psi(x)$ 的梯度为：\n$$\n\\nabla \\psi(x) = \\nabla(L_{f} h(x)) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix}\n$$\n现在我们可以计算 $L_{g} L_{f} h(x)$：\n$$\nL_{g} L_{f} h(x) = \\nabla(L_{f} h(x)) \\cdot g(x) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 1+p\\,d\n$$\n题目给出的条件 $p \\neq -1/d$ 确保了 $L_{g} L_{f} h(x) = 1+p\\,d \\neq 0$。由于 $L_{g} h(x) = 0$ 且 $L_{g} L_{f} h(x) \\neq 0$，系统的相对阶对于所有 $x$ 都恰好为二。\n\n接下来，我们计算 $L_{f}^{2} h(x) = L_{f}(L_f h(x))$：\n$$\nL_{f}^{2} h(x) = \\nabla(L_{f} h(x)) \\cdot f(x) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix} \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}\n$$\n$$\nL_{f}^{2} h(x) = -a(-a\\,x_{1} + x_{2}) + (1+p\\,d)(-b\\,x_{2} + s\\,x_{3}) - p\\,c(-c\\,x_{3} + d\\,x_{2})\n$$\n展开并合并关于 $x_{1}$、$x_{2}$ 和 $x_{3}$ 的项：\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} - a\\,x_{2} - b\\,x_{2} - b\\,p\\,d\\,x_{2} + s\\,x_{3} + s\\,p\\,d\\,x_{3} + p\\,c^{2}x_{3} - p\\,c\\,d\\,x_{2}\n$$\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} + (-a - b - b\\,p\\,d - p\\,c\\,d)x_{2} + (s + s\\,p\\,d + p\\,c^{2})x_{3}\n$$\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3}\n$$\n\n**3. 输入-输出线性化控制律**\n\n目标是找到一个关于 $u$ 的状态反馈控制律，使得输入-输出动力学呈线性关系 $\\ddot{y} = v$，其中 $v$ 是一个新的外部输入。我们将推导出的 $\\ddot{y}$ 表达式设为等于 $v$：\n$$\n\\ddot{y} = L_{f}^{2} h(x) + L_{g} L_{f} h(x) u = v\n$$\n$$\na^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3} + (1+p\\,d)u = v\n$$\n求解控制输入 $u$：\n$$\n(1+p\\,d)u = v - \\left[ a^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3} \\right]\n$$\n$$\nu = \\frac{1}{1+p\\,d} \\left( v - a^{2}x_{1} + (a+b+p(b\\,d+c\\,d))x_{2} - (s+p(s\\,d+c^{2}))x_{3} \\right)\n$$\n这就是所需的输入变换。\n\n**4. 零动态分析**\n\n零动态是当输出在所有时间内保持为零（即 $y(t) \\equiv 0$）时系统的内部动力学。这意味着输出的所有时间导数也为零。对于一个相对阶为二的系统，我们要求 $y(t)=0$ 和 $\\dot{y}(t)=0$。\n这可以通过设置新输入 $v=0$ 来实现，此时 $\\ddot{y}=0$。状态轨迹随后被限制在零动态流形 $Z^* = \\{x \\in \\mathbb{R}^3 \\mid h(x)=0, L_f h(x)=0 \\}$ 上。\n\n1.  $h(x) = x_{1} + p\\,x_{3} = 0 \\implies x_{1} = -p\\,x_{3}$\n2.  $L_{f} h(x) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0$\n\n将第一个方程中的 $x_{1}$ 代入第二个方程：\n$$\n-a(-p\\,x_{3}) + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0\n$$\n$$\na\\,p\\,x_{3} + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0\n$$\n$$\n(1+p\\,d)x_{2} + p(a-c)x_{3} = 0\n$$\n由于 $1+p\\,d \\neq 0$，我们可以解出 $x_{2}$：\n$$\nx_{2} = -\\frac{p(a-c)}{1+p\\,d} x_{3}\n$$\n在 $Z^*$ 上，系统的状态完全由 $x_3$ 决定。我们选择 $\\eta = x_3$ 作为一维内部动力学的坐标。其动力学由在 $Z^*$ 上求值的 $\\dot{\\eta} = \\dot{x}_{3}$ 给出。\n$$\n\\dot{\\eta} = \\dot{x}_{3} = -c\\,x_{3} + d\\,x_{2}\n$$\n代入在 $Z^*$ 上的 $x_{2}$ 表达式：\n$$\n\\dot{\\eta} = -c\\,\\eta + d \\left( -\\frac{p(a-c)}{1+p\\,d} \\eta \\right) = \\left( -c - \\frac{d\\,p(a-c)}{1+p\\,d} \\right) \\eta\n$$\n$$\n\\dot{\\eta} = \\left( \\frac{-c(1+p\\,d) - d\\,p(a-c)}{1+p\\,d} \\right) \\eta = \\left( \\frac{-c - c\\,p\\,d - a\\,d\\,p + c\\,d\\,p}{1+p\\,d} \\right) \\eta\n$$\n$$\n\\dot{\\eta} = \\left( \\frac{-c - a\\,d\\,p}{1+p\\,d} \\right) \\eta = -\\left( \\frac{c + a\\,d\\,p}{1+p\\,d} \\right) \\eta\n$$\n如果特征值 $\\lambda = -\\frac{c + a\\,d\\,p}{1+p\\,d}$ 是严格负的，则零动态是指数稳定的。这要求该分数为正：\n$$\n\\frac{c + a\\,d\\,p}{1+p\\,d}  0\n$$\n由于 $a, c, d$ 都是严格正常数，保证稳定性的一个充分条件是选择设计参数 $p$，使得分子和分母都为正。\n1. 分母为正：$1+p\\,d  0 \\implies p\\,d  -1 \\implies p  -1/d$。\n2. 分子为正：$c+a\\,d\\,p  0 \\implies a\\,d\\,p  -c \\implies p  -c/(a\\,d)$。\n为了同时满足这两个条件，我们必须选择 $p  \\max\\left(-\\frac{1}{d}, -\\frac{c}{a\\,d}\\right)$。由于两个阈值都是负的，任何 $p \\ge 0$ 的选择都能确保零动态的指数稳定性。一个简单而有效的选择是 $p=0$。这个选择对应于仅测量生物标志物浓度 $x_{1}$ 作为输出。",
            "answer": "$$\n\\boxed{\\frac{1}{1+p\\,d} \\left( v - a^{2} x_{1} + \\left( a+b+p(b\\,d+c\\,d) \\right) x_{2} - \\left( s+p(s\\,d+c^{2}) \\right) x_{3} \\right)}\n$$"
        }
    ]
}