{
    "hands_on_practices": [
        {
            "introduction": "Before a model can be used for control design, we must determine if its parameters can be uniquely identified from experimental data. This practice introduces the crucial concept of structural identifiability, which provides a theoretical test for this property, independent of data quality. By deriving the input-output relationship for a controlled pharmacokinetic system, you will learn how to assess whether key physiological parameters like clearance and volume of distribution can be determined from measurements ().",
            "id": "3885524",
            "problem": "Consider a one-compartment Pharmacokinetic (PK) model used in closed-loop drug delivery, where an intravenous infusion is adjusted by a controller to track a desired concentration trajectory. The state is the plasma drug concentration $c(t)$, the measured output is $y(t) = c(t)$, the compartment volume is $V  0$, and the clearance is $CL  0$. The mass balance in the compartment is given by $V \\,\\dot{c}(t) = u(t) - CL \\, c(t)$, where $u(t)$ is the infusion rate. A known proportional controller (a special case of Proportional-Integral-Derivative (PID) control) is applied such that $u(t) = K \\,\\big(r(t) - y(t)\\big)$, where $K  0$ is a known constant gain and $r(t)$ is a known reference concentration trajectory that is designed by the clinician. Assume noiseless, continuous-time measurements of $y(t)$ and known $r(t)$, with $r(t)$ selected such that the resulting input-output dynamics are persistently exciting in the sense of linear system identification.\n\n1) Provide a precise definition of structural identifiability for a parametric dynamical system with measured output and known input, in terms of uniqueness of the parameter-to-output mapping for almost all admissible inputs and initial conditions in the noise-free case.\n\n2) Starting from the mass balance and controller equations above, eliminate the unmeasured states and derive the input-output differential equation that relates $y(t)$ and $r(t)$ and depends only on the unknown parameters $V$ and $CL$ and the known gain $K$.\n\n3) Test structural identifiability of $V$ and $CL$ using the input-output equation from part (2) by examining the injectivity of the mapping from the unknown parameters to the coefficients of the input-output relation. State any conditions necessary for injectivity.\n\n4) Let the input-output differential equation be written in the normalized (monic) form $\\dot{y}(t) + a \\, y(t) = b \\, r(t)$, where $a$ and $b$ are scalar coefficients that can, in principle, be identified from noiseless data $y(t)$ and known $r(t)$ under persistency of excitation. Express the clearance parameter $CL$ as a closed-form analytic expression in terms of the known controller gain $K$ and the identified coefficients $a$ and $b$. Provide your final answer as a single analytic expression. No numerical approximation is required and no units should be included in the final expression.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in standard pharmacokinetic modeling and control theory, is well-posed, objective, and self-contained. The provided information is sufficient and consistent for deriving a unique solution.\n\nThis problem consists of four parts. First, providing a definition of structural identifiability. Second, deriving an input-output differential equation. Third, analyzing the structural identifiability of the model parameters. Fourth, deriving a specific expression for the clearance parameter.\n\n1) Structural identifiability is a property of a parametric model structure that determines whether it is possible, in principle, to uniquely determine the values of the unknown parameters from ideal, noise-free input-output data. For a parametric dynamical system described by state equations $\\dot{\\mathbf{x}}(t) = \\mathbf{f}(\\mathbf{x}(t), u(t), \\boldsymbol{\\theta})$ and output equations $\\mathbf{y}(t) = \\mathbf{g}(\\mathbf{x}(t), \\boldsymbol{\\theta})$, where $\\boldsymbol{\\theta}$ is the vector of unknown parameters, the model is said to be structurally globally identifiable if, for almost all admissible inputs $u(t)$ and for any initial conditions, the equality of the outputs $\\mathbf{y}(t, \\boldsymbol{\\theta}_1) = \\mathbf{y}(t, \\boldsymbol{\\theta}_2)$ for all time $t \\geq 0$ necessarily implies that the parameter vectors are identical, $\\boldsymbol{\\theta}_1 = \\boldsymbol{\\theta}_2$. The model is structurally locally identifiable if for any $\\boldsymbol{\\theta}_1$ in the parameter space, there exists a neighborhood around it such that $\\mathbf{y}(t, \\boldsymbol{\\theta}_1) = \\mathbf{y}(t, \\boldsymbol{\\theta}_2)$ implies $\\boldsymbol{\\theta}_1 = \\boldsymbol{\\theta}_2$ for any $\\boldsymbol{\\theta}_2$ in that neighborhood. The analysis concerns the injectivity of the mapping from the parameter space to the space of possible noise-free outputs.\n\n2) We are given the following system equations:\nThe mass balance equation for the drug concentration $c(t)$:\n$$V \\,\\dot{c}(t) = u(t) - CL \\, c(t)$$\nThe proportional controller law:\n$$u(t) = K \\,\\big(r(t) - y(t)\\big)$$\nAnd the measurement equation:\n$$y(t) = c(t)$$\nThe parameters $V$ and $CL$ are unknown, while the controller gain $K$ is known. Both $V$, $CL$, and $K$ are strictly positive constants. The reference trajectory $r(t)$ is a known input, and $y(t)$ is the measured output.\n\nTo derive the input-output differential equation relating $y(t)$ and $r(t)$, we first substitute the measurement equation into the mass balance equation. Since $y(t) = c(t)$, it follows that their time derivatives are also equal, $\\dot{y}(t) = \\dot{c}(t)$. Substituting these into the mass balance equation gives:\n$$V \\,\\dot{y}(t) = u(t) - CL \\, y(t)$$\nNext, we substitute the expression for the control input $u(t)$ from the controller law into the above equation:\n$$V \\,\\dot{y}(t) = \\Big( K \\,\\big(r(t) - y(t)\\big) \\Big) - CL \\, y(t)$$\nNow, we expand the terms and rearrange the equation to group terms involving $y(t)$ and its derivative on the left-hand side and the term involving the input $r(t)$ on the right-hand side.\n$$V \\,\\dot{y}(t) = K \\, r(t) - K \\, y(t) - CL \\, y(t)$$\n$$V \\,\\dot{y}(t) + K \\, y(t) + CL \\, y(t) = K \\, r(t)$$\nFactoring out $y(t)$ on the left-hand side yields the final input-output differential equation:\n$$V \\,\\dot{y}(t) + (K + CL) \\, y(t) = K \\, r(t)$$\nThis is a first-order linear ordinary differential equation that relates the output $y(t)$ to the reference input $r(t)$, with coefficients that depend on the unknown parameters $V$ and $CL$ and the known gain $K$.\n\n3) To test for structural identifiability, we examine the mapping from the unknown parameters $\\{V, CL\\}$ to the coefficients of the input-output relation. The problem statement refers to a normalized (monic) form of the differential equation, which is obtained by dividing through by the coefficient of the highest-order derivative, $V$. Since $V0$, this is always possible.\n$$\\dot{y}(t) + \\frac{K + CL}{V} \\, y(t) = \\frac{K}{V} \\, r(t)$$\nThis equation is of the general form $\\dot{y}(t) + c_1 y(t) = c_2 r(t)$. The assumption that the input $r(t)$ is \"persistently exciting\" ensures that the coefficients $c_1$ and $c_2$ can be uniquely determined from noise-free measurements of $y(t)$ and knowledge of $r(t)$. Let us define these identifiable coefficients:\n$$c_1 = \\frac{K + CL}{V}$$\n$$c_2 = \\frac{K}{V}$$\nThe structural identifiability of $V$ and $CL$ is established if we can find a unique solution for $V$ and $CL$ from these two equations, given that $K$ is known.\n\nFrom the equation for $c_2$, we can express $V$ as:\n$$V = \\frac{K}{c_2}$$\nFor this expression to be defined, we must have $c_2 \\neq 0$.\nNow, substitute this expression for $V$ into the equation for $c_1$:\n$$c_1 = \\frac{K + CL}{K/c_2} = \\frac{c_2 (K + CL)}{K}$$\nWe can now solve for $CL$:\n$$c_1 K = c_2 (K + CL)$$\n$$\\frac{c_1 K}{c_2} = K + CL$$\n$$CL = \\frac{c_1 K}{c_2} - K = K \\left( \\frac{c_1}{c_2} - 1 \\right)$$\nSince we have derived unique expressions for both $V$ and $CL$ in terms of the identifiable coefficients $c_1$ and $c_2$ and the known gain $K$, the parameters $V$ and $CL$ are structurally globally identifiable.\nThe necessary condition for injectivity of the mapping is that a solution can be calculated, which requires $c_2 \\neq 0$. Furthermore, for the parameters to be physically meaningful as per the problem statement ($V  0$, $CL  0$), the identified coefficients must satisfy certain conditions. Given $K  0$:\n1. $V  0$ requires $\\frac{K}{c_2}  0$, which implies $c_2  0$.\n2. $CL  0$ requires $K \\left( \\frac{c_1}{c_2} - 1 \\right)  0$, which implies $\\frac{c_1}{c_2}  1$, or $c_1  c_2$.\nTherefore, the parameters are structurally identifiable, and for a physically meaningful result, the identified coefficients must satisfy $c_1  c_2  0$.\n\n4) We are asked to express the clearance parameter $CL$ as a closed-form analytic expression in terms of the known controller gain $K$ and the identified coefficients $a$ and $b$ from the normalized input-output equation $\\dot{y}(t) + a \\, y(t) = b \\, r(t)$.\nBy comparing this form with the equation derived in part (3), we can equate the coefficients:\n$$a = c_1 = \\frac{K + CL}{V}$$\n$$b = c_2 = \\frac{K}{V}$$\nWe have a system of two algebraic equations for the two unknowns $V$ and $CL$. We seek an expression for $CL$. From the second equation, we solve for $V$:\n$$V = \\frac{K}{b}$$\nNow, we substitute this expression for $V$ into the first equation:\n$$a = \\frac{K + CL}{K / b}$$\nRearranging to solve for $CL$:\n$$a = \\frac{b(K + CL)}{K}$$\nMultiply both sides by $K$:\n$$aK = b(K + CL)$$\nDistribute $b$ on the right-hand side:\n$$aK = bK + b \\cdot CL$$\nIsolate the term with $CL$:\n$$b \\cdot CL = aK - bK$$\nFactor out $K$ on the right-hand side:\n$$b \\cdot CL = K(a - b)$$\nFinally, divide by $b$ (which must be non-zero for the system to be identifiable) to get the expression for $CL$:\n$$CL = \\frac{K(a - b)}{b}$$\nThis is the required closed-form analytic expression for the clearance parameter.",
            "answer": "$$\\boxed{\\frac{K(a-b)}{b}}$$"
        },
        {
            "introduction": "While linear models are useful, many physiological systems exhibit significant nonlinearities. This exercise demonstrates a powerful technique, feedback linearization, for designing controllers for such systems by mathematically transforming the complex nonlinear dynamics into a simple, linear input-output response. You will apply tools from differential geometry, such as Lie derivatives, to construct a control law and discover how design choices, such as the output parameter $p$, can be used to ensure the system's internal stability ().",
            "id": "3885559",
            "problem": "A three-state Single-Input Single-Output (SISO) physiological cascade is modeled as a control-affine nonlinear system with state vector $x = (x_{1}, x_{2}, x_{3})$, where $x_{1}$ represents a circulating biomarker concentration, $x_{2}$ is an intermediate mediator, and $x_{3}$ is a receptor occupancy state. The infusion control input $u$ acts on the mediator. The dynamics are\n$$\n\\begin{aligned}\n\\dot{x}_{1} = -a\\,x_{1} + x_{2}, \\\\\n\\dot{x}_{2} = -b\\,x_{2} + s\\,x_{3} + u, \\\\\n\\dot{x}_{3} = -c\\,x_{3} + d\\,x_{2},\n\\end{aligned}\n$$\nwith strictly positive constants $a, b, c, d, s \\in \\mathbb{R}_{0}$. The measured output is chosen as $y = h(x) = x_{1} + p\\,x_{3}$, where $p \\in \\mathbb{R}$ is a design parameter.\n\nStarting from the definitions of Lie derivatives for control-affine systems, namely $L_{f} h(x) = \\nabla h(x) \\cdot f(x)$ and $L_{g} h(x) = \\nabla h(x) \\cdot g(x)$, where $f(x)$ is the drift vector field and $g(x)$ is the input vector field in $\\dot{x} = f(x) + g(x)\\,u$, perform the following:\n\n1. Compute the first Lie derivatives $L_{f} h(x)$ and $L_{g} h(x)$ and determine the relative degree at $x$ under the condition $p \\neq -\\frac{1}{d}$.\n2. Compute the higher Lie derivatives needed for exact input-output linearization with relative degree two, specifically $L_{f}^{2} h(x)$ and $L_{g} L_{f} h(x)$.\n3. Using the fundamental input-output linearization principle for SISO control-affine systems (without invoking any shortcut formulas given in the problem), derive the state-dependent input transformation that renders the input-output dynamics linear of order two with a new input $v$, so that the closed-loop input-output behavior is a double integrator driven by $v$.\n4. Derive the zero dynamics associated with the internal coordinate obtained by restricting to the zero-output manifold $y \\equiv 0$ and $v \\equiv 0$. Show how the choice of $p$ affects the stability of the zero dynamics, and choose $p$ to ensure exponential stability of the internal dynamics. Justify your choice from first principles.\n\nYour final answer must be a single closed-form analytic expression for the input transformation in terms of $x_{1}$, $x_{2}$, $x_{3}$, $a$, $b$, $c$, $d$, $s$, $p$, and $v$. Do not include an equality sign in the final answer. No units are required. No rounding is required.",
            "solution": "The problem presents a control-affine nonlinear system and asks for the derivation of an input-output linearizing controller, along with an analysis of the system's zero dynamics. The problem statement is scientifically grounded in control theory and systems biology, well-posed, and objective. All necessary information is provided. Therefore, the problem is valid, and we proceed with the solution.\n\nThe system dynamics are given by $\\dot{x} = f(x) + g(x)u$, where $x = (x_{1}, x_{2}, x_{3})$ is the state vector and $u$ is the control input.\nFrom the given equations:\n$$\n\\begin{pmatrix} \\dot{x}_{1} \\\\ \\dot{x}_{2} \\\\ \\dot{x}_{3} \\end{pmatrix} = \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} u\n$$\nThe drift vector field $f(x)$ and the input vector field $g(x)$ are:\n$$\nf(x) = \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nThe output is $y = h(x) = x_{1} + p\\,x_{3}$.\n\n**1. First Lie Derivatives and Relative Degree**\n\nTo find the relative degree, we compute successive Lie derivatives of $h(x)$ until the input $u$ explicitly appears. The time derivative of the output is $\\dot{y} = \\frac{\\partial h}{\\partial x} \\dot{x} = \\nabla h(x) \\cdot (f(x) + g(x)u) = L_f h(x) + L_g h(x) u$.\n\nThe gradient of $h(x)$ is $\\nabla h(x) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x_1}  \\frac{\\partial h}{\\partial x_2}  \\frac{\\partial h}{\\partial x_3} \\end{pmatrix} = \\begin{pmatrix} 1  0  p \\end{pmatrix}$.\n\nFirst, we compute the Lie derivative of $h(x)$ with respect to $g(x)$:\n$$\nL_{g} h(x) = \\nabla h(x) \\cdot g(x) = \\begin{pmatrix} 1  0  p \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 0\n$$\nSince $L_{g} h(x) = 0$, the input $u$ does not appear in the first derivative of the output. The relative degree is at least two.\n\nNext, we compute the Lie derivative of $h(x)$ with respect to $f(x)$:\n$$\nL_{f} h(x) = \\nabla h(x) \\cdot f(x) = \\begin{pmatrix} 1  0  p \\end{pmatrix} \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}\n$$\n$$\nL_{f} h(x) = 1(-a\\,x_{1} + x_{2}) + 0(-b\\,x_{2} + s\\,x_{3}) + p(-c\\,x_{3} + d\\,x_{2}) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3}\n$$\nSo, the first time derivative of the output is $\\dot{y} = L_{f} h(x)$.\n\n**2. Higher Lie Derivatives for Relative Degree Two**\n\nTo find the second derivative of the output, we differentiate $\\dot{y}$:\n$$\n\\ddot{y} = \\frac{d}{dt}(L_{f} h(x)) = \\nabla(L_{f} h(x)) \\cdot \\dot{x} = \\nabla(L_{f} h(x)) \\cdot (f(x) + g(x)u)\n$$\n$$\n\\ddot{y} = L_{f}^{2} h(x) + L_{g} L_{f} h(x) u\n$$\nWe need to compute the terms $L_{f}^{2} h(x)$ and $L_{g} L_{f} h(x)$. Let $\\psi(x) = L_{f} h(x) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3}$. The gradient of $\\psi(x)$ is:\n$$\n\\nabla \\psi(x) = \\nabla(L_{f} h(x)) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix}\n$$\nNow we can compute $L_{g} L_{f} h(x)$:\n$$\nL_{g} L_{f} h(x) = \\nabla(L_{f} h(x)) \\cdot g(x) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 1+p\\,d\n$$\nThe problem states the condition $p \\neq -1/d$, which ensures $L_{g} L_{f} h(x) = 1+p\\,d \\neq 0$. Since $L_{g} h(x) = 0$ and $L_{g} L_{f} h(x) \\neq 0$, the relative degree of the system is exactly two for all $x$.\n\nNext, we compute $L_{f}^{2} h(x) = L_{f}(L_f h(x))$:\n$$\nL_{f}^{2} h(x) = \\nabla(L_{f} h(x)) \\cdot f(x) = \\begin{pmatrix} -a  1+p\\,d  -p\\,c \\end{pmatrix} \\begin{pmatrix} -a\\,x_{1} + x_{2} \\\\ -b\\,x_{2} + s\\,x_{3} \\\\ -c\\,x_{3} + d\\,x_{2} \\end{pmatrix}\n$$\n$$\nL_{f}^{2} h(x) = -a(-a\\,x_{1} + x_{2}) + (1+p\\,d)(-b\\,x_{2} + s\\,x_{3}) - p\\,c(-c\\,x_{3} + d\\,x_{2})\n$$\nExpanding and collecting terms for $x_{1}$, $x_{2}$, and $x_{3}$:\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} - a\\,x_{2} - b\\,x_{2} - b\\,p\\,d\\,x_{2} + s\\,x_{3} + s\\,p\\,d\\,x_{3} + p\\,c^{2}x_{3} - p\\,c\\,d\\,x_{2}\n$$\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} + (-a - b - b\\,p\\,d - p\\,c\\,d)x_{2} + (s + s\\,p\\,d + p\\,c^{2})x_{3}\n$$\n$$\nL_{f}^{2} h(x) = a^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3}\n$$\n\n**3. Input-Output Linearizing Control Law**\n\nThe goal is to find a state feedback control law for $u$ that yields linear input-output dynamics $\\ddot{y} = v$, where $v$ is a new external input. We set our derived expression for $\\ddot{y}$ equal to $v$:\n$$\n\\ddot{y} = L_{f}^{2} h(x) + L_{g} L_{f} h(x) u = v\n$$\n$$\na^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3} + (1+p\\,d)u = v\n$$\nSolving for the control input $u$:\n$$\n(1+p\\,d)u = v - \\left[ a^{2}x_{1} - (a+b+p(b\\,d+c\\,d))x_{2} + (s+p(s\\,d+c^{2}))x_{3} \\right]\n$$\n$$\nu = \\frac{1}{1+p\\,d} \\left( v - a^{2}x_{1} + (a+b+p(b\\,d+c\\,d))x_{2} - (s+p(s\\,d+c^{2}))x_{3} \\right)\n$$\nThis is the required input transformation.\n\n**4. Zero Dynamics Analysis**\n\nThe zero dynamics are the internal dynamics of the system when the output is kept at zero for all time, i.e., $y(t) \\equiv 0$. This implies all time derivatives of the output are also zero. For a system of relative degree two, we require $y(t)=0$ and $\\dot{y}(t)=0$.\nThis is achieved by setting the new input $v=0$, which makes $\\ddot{y}=0$. The state trajectory is then confined to the zero-dynamics manifold $Z^* = \\{x \\in \\mathbb{R}^3 \\mid h(x)=0, L_f h(x)=0 \\}$.\n\n1.  $h(x) = x_{1} + p\\,x_{3} = 0 \\implies x_{1} = -p\\,x_{3}$\n2.  $L_{f} h(x) = -a\\,x_{1} + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0$\n\nSubstitute $x_{1}$ from the first equation into the second:\n$$\n-a(-p\\,x_{3}) + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0\n$$\n$$\na\\,p\\,x_{3} + (1+p\\,d)x_{2} - p\\,c\\,x_{3} = 0\n$$\n$$\n(1+p\\,d)x_{2} + p(a-c)x_{3} = 0\n$$\nSince $1+p\\,d \\neq 0$, we can solve for $x_{2}$:\n$$\nx_{2} = -\\frac{p(a-c)}{1+p\\,d} x_{3}\n$$\nThe state of the system on $Z^*$ is completely determined by $x_3$. We choose $\\eta = x_3$ as the coordinate for the one-dimensional internal dynamics. The dynamics are given by $\\dot{\\eta} = \\dot{x}_{3}$ evaluated on $Z^*$.\n$$\n\\dot{\\eta} = \\dot{x}_{3} = -c\\,x_{3} + d\\,x_{2}\n$$\nSubstitute the expression for $x_{2}$ on $Z^*$:\n$$\n\\dot{\\eta} = -c\\,\\eta + d \\left( -\\frac{p(a-c)}{1+p\\,d} \\eta \\right) = \\left( -c - \\frac{d\\,p(a-c)}{1+p\\,d} \\right) \\eta\n$$\n$$\n\\dot{\\eta} = \\left( \\frac{-c(1+p\\,d) - d\\,p(a-c)}{1+p\\,d} \\right) \\eta = \\left( \\frac{-c - c\\,p\\,d - a\\,d\\,p + c\\,d\\,p}{1+p\\,d} \\right) \\eta\n$$\n$$\n\\dot{\\eta} = \\left( \\frac{-c - a\\,d\\,p}{1+p\\,d} \\right) \\eta = -\\left( \\frac{c + a\\,d\\,p}{1+p\\,d} \\right) \\eta\n$$\nThe zero dynamics are exponentially stable if the eigenvalue $\\lambda = -\\frac{c + a\\,d\\,p}{1+p\\,d}$ is strictly negative. This requires the fraction to be positive:\n$$\n\\frac{c + a\\,d\\,p}{1+p\\,d}  0\n$$\nSince $a, c, d$ are all strictly positive constants, a sufficient condition to guarantee stability is to choose the design parameter $p$ such that both the numerator and the denominator are positive.\n1. Denominator positive: $1+p\\,d  0 \\implies p\\,d  -1 \\implies p  -1/d$.\n2. Numerator positive: $c+a\\,d\\,p  0 \\implies a\\,d\\,p  -c \\implies p  -c/(a\\,d)$.\nTo satisfy both conditions, we must choose $p  \\max\\left(-\\frac{1}{d}, -\\frac{c}{a\\,d}\\right)$. Since both threshold values are negative, any choice of $p \\ge 0$ ensures exponential stability of the zero dynamics. A simple and effective choice is $p=0$. This choice corresponds to measuring only the biomarker concentration $x_{1}$ as the output.\n\nThe final expression for the input transformation remains in terms of the general parameter $p$, as required.",
            "answer": "$$\n\\boxed{\\frac{1}{1+p\\,d} \\left( v - a^{2} x_{1} + \\left( a+b+p(b\\,d+c\\,d) \\right) x_{2} - \\left( s+p(s\\,d+c^{2}) \\right) x_{3} \\right)}\n$$"
        },
        {
            "introduction": "Time delays are ubiquitous in biological feedback loops, arising from processes like gene expression, protein synthesis, and transport, and they can be a potent source of instability. This practice provides a method to analyze the impact of such delays by approximating the delay with a finite-dimensional system using the 'linear chain trick'. By constructing the characteristic equation for the augmented system, you will determine the critical delay time at which a stable system is driven into oscillations, a fundamental skill in robust biomedical control design ().",
            "id": "3885548",
            "problem": "Consider a linear time-invariant (LTI) closed-loop model of a scalar biomedical variable $x(t)$ (for example, a regulated blood variable concentration deviation from setpoint) under negative feedback. The open-loop plant is a single compartment with first-order elimination and actuation effectiveness, described by the mass balance\n$$\n\\frac{d x(t)}{d t} = -a\\,x(t) + b\\,u_{\\text{del}}(t),\n$$\nwhere $a0$ is the elimination rate, $b0$ is the actuation effectiveness, and $u_{\\text{del}}(t)$ is the actuation after a distributed delay representing synthesis, transport, and receptor binding effects. The feedback controller is proportional, $u(t) = -k\\,x(t)$, where $k0$.\n\nTo approximate the distributed delay with mean $\\tau0$, use the linear chain trick with $N=2$ first-order stages, each with a common transition rate $\\alpha$, so that the mean delay satisfies $\\tau = \\frac{N}{\\alpha} = \\frac{2}{\\alpha}$. The chain states $z_{1}(t)$ and $z_{2}(t)$ satisfy mass-balance dynamics driven by the undelayed control signal $u(t)$, and the delayed actuation entering the plant is $u_{\\text{del}}(t) = z_{2}(t)$. Assume all signals are small deviations around a regulated equilibrium so that linearization is valid.\n\nStarting from these modeling assumptions and core definitions, construct the finite-dimensional approximation via the linear chain trick, derive the closed-loop characteristic equation, and analyze the stability change as the mean delay $\\tau$ increases (equivalently, as $\\alpha$ decreases). Under the assumption $b\\,k  8 a$ so that a finite positive critical delay exists, determine the smallest positive mean delay $\\tau_{c}$ at which the closed-loop system first loses asymptotic stability via a pair of complex-conjugate roots crossing the imaginary axis. Express your final answer for $\\tau_{c}$ in seconds as a single closed-form analytic expression in terms of $a$, $b$, and $k$ with $a0$, $b0$, $k0$. No numerical evaluation is required.",
            "solution": "The problem is well-posed, scientifically grounded, and contains sufficient information to determine a unique solution. It describes a standard problem in control theoryâ€”the stability analysis of a time-delayed feedback system. The use of the linear chain trick to approximate the distributed delay is a valid and common technique. The provided condition $b\\,k  8 a$ ensures the existence of a finite critical delay for the system to lose stability, which is consistent with the physics of such systems. Therefore, the problem is valid.\n\nThe system dynamics are described by the following set of linear time-invariant (LTI) ordinary differential equations. The plant dynamics for the biomedical variable $x(t)$ are given by:\n$$\n\\frac{d x(t)}{d t} = -a\\,x(t) + b\\,u_{\\text{del}}(t)\n$$\nwhere $a0$, $b0$. The actuation signal $u_{\\text{del}}(t)$ is the output of a two-stage linear chain that approximates a distributed delay. The input to this chain is the proportional control law:\n$$\nu(t) = -k\\,x(t)\n$$\nwhere $k0$. The linear chain with $N=2$ stages and transition rate $\\alpha$ is described by the state variables $z_1(t)$ and $z_2(t)$:\n$$\n\\frac{d z_1(t)}{d t} = \\alpha\\,(u(t) - z_1(t)) = \\alpha\\,(-k\\,x(t) - z_1(t))\n$$\n$$\n\\frac{d z_2(t)}{d t} = \\alpha\\,(z_1(t) - z_2(t))\n$$\nThe delayed actuation is the output of the second stage, $u_{\\text{del}}(t) = z_2(t)$. The mean delay is $\\tau = \\frac{N}{\\alpha} = \\frac{2}{\\alpha}$.\n\nWe can assemble these equations into a single state-space model. Let the state vector be $\\mathbf{v}(t) = \\begin{pmatrix} x(t)  z_1(t)  z_2(t) \\end{pmatrix}^T$. The system dynamics are $\\frac{d\\mathbf{v}}{dt} = \\mathbf{A}\\,\\mathbf{v}$, where the system matrix $\\mathbf{A}$ is:\n$$\n\\mathbf{A} = \\begin{pmatrix} -a  0  b \\\\ -\\alpha k  -\\alpha  0 \\\\ 0  \\alpha  -\\alpha \\end{pmatrix}\n$$\nThe stability of the system is determined by the eigenvalues of $\\mathbf{A}$, which are the roots of the characteristic equation $\\det(s\\mathbf{I} - \\mathbf{A}) = 0$.\n$$\n\\det \\begin{pmatrix} s+a  0  -b \\\\ \\alpha k  s+\\alpha  0 \\\\ 0  -\\alpha  s+\\alpha \\end{pmatrix} = 0\n$$\nWe compute the determinant by cofactor expansion along the first row:\n$$\n(s+a) \\det \\begin{pmatrix} s+\\alpha  0 \\\\ -\\alpha  s+\\alpha \\end{pmatrix} - (0) \\cdot (\\dots) + (-b) \\det \\begin{pmatrix} \\alpha k  s+\\alpha \\\\ 0  -\\alpha \\end{pmatrix} = 0\n$$\n$$\n(s+a)(s+\\alpha)^2 - b((\\alpha k)(-\\alpha) - 0) = 0\n$$\n$$\n(s+a)(s+\\alpha)^2 + b k \\alpha^2 = 0\n$$\nExpanding the polynomial gives the characteristic equation:\n$$\n(s+a)(s^2 + 2\\alpha s + \\alpha^2) + b k \\alpha^2 = 0\n$$\n$$\ns^3 + 2\\alpha s^2 + \\alpha^2 s + a s^2 + 2a\\alpha s + a\\alpha^2 + b k \\alpha^2 = 0\n$$\n$$\ns^3 + (a+2\\alpha)s^2 + \\alpha(\\alpha+2a)s + \\alpha^2(a+bk) = 0\n$$\nThe system loses stability when a pair of complex-conjugate roots crosses the imaginary axis. This occurs when there is a root $s=i\\omega$ for some real frequency $\\omega  0$. We substitute $s=i\\omega$ into the characteristic equation:\n$$\n(i\\omega)^3 + (a+2\\alpha)(i\\omega)^2 + \\alpha(\\alpha+2a)(i\\omega) + \\alpha^2(a+bk) = 0\n$$\n$$\n-i\\omega^3 - (a+2\\alpha)\\omega^2 + i\\alpha(\\alpha+2a)\\omega + \\alpha^2(a+bk) = 0\n$$\nFor this equation to hold, both the real and imaginary parts must be zero.\nReal part:\n$$\n-(a+2\\alpha)\\omega^2 + \\alpha^2(a+bk) = 0 \\quad (1)\n$$\nImaginary part:\n$$\n-\\omega^3 + \\alpha(\\alpha+2a)\\omega = 0\n$$\nFactoring the imaginary part equation gives $\\omega(-\\omega^2 + \\alpha(\\alpha+2a)) = 0$. One solution is $\\omega=0$, which corresponds to a non-oscillatory instability. If $s=0$, the characteristic equation becomes $\\alpha^2(a+bk)=0$. Since $a, b, k, \\alpha$ are all positive, this cannot be zero. Therefore, stability is lost through an oscillatory instability (Hopf bifurcation), meaning $\\omega \\neq 0$. This implies:\n$$\n\\omega^2 = \\alpha(\\alpha+2a) \\quad (2)\n$$\nSince $\\omega^2  0$ and $a0$, this requires $\\alpha0$, which is consistent with its definition as a rate. Now we substitute this expression for $\\omega^2$ into the real part equation $(1)$:\n$$\n-(a+2\\alpha)[\\alpha(\\alpha+2a)] + \\alpha^2(a+bk) = 0\n$$\nSince the critical value of $\\alpha$ must be positive, we can divide by $\\alpha$:\n$$\n-(a+2\\alpha)(\\alpha+2a) + \\alpha(a+bk) = 0\n$$\n$$\n-(2\\alpha^2 + 4a\\alpha + a\\alpha + 2a^2) + \\alpha a + \\alpha bk = 0\n$$\n$$\n-2\\alpha^2 - 5a\\alpha - 2a^2 + a\\alpha + bk\\alpha = 0\n$$\n$$\n-2\\alpha^2 + (bk - 4a)\\alpha - 2a^2 = 0\n$$\nMultiplying by $-1$ gives a quadratic equation for the critical value(s) of $\\alpha$, denoted $\\alpha_c$:\n$$\n2\\alpha_c^2 - (bk-4a)\\alpha_c + 2a^2 = 0\n$$\nWe solve for $\\alpha_c$ using the quadratic formula:\n$$\n\\alpha_c = \\frac{(bk-4a) \\pm \\sqrt{(-(bk-4a))^2 - 4(2)(2a^2)}}{2(2)}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{(bk-4a)^2 - 16a^2}}{4}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{b^2k^2 - 8abk + 16a^2 - 16a^2}}{4}\n$$\n$$\n\\alpha_c = \\frac{bk-4a \\pm \\sqrt{b^2k^2 - 8abk}}{4} = \\frac{bk-4a \\pm \\sqrt{bk(bk - 8a)}}{4}\n$$\nThe problem states that $bk  8a$, which ensures that the discriminant $bk(bk-8a)$ is positive, so two distinct positive real roots for $\\alpha_c$ exist. Let's call them $\\alpha_{c1}$ and $\\alpha_{c2}$.\nThe system is stable when the Routh-Hurwitz conditions are met. The critical condition is $p_2 p_1 - p_0  0$, where $p_2=(a+2\\alpha)$, $p_1=\\alpha(\\alpha+2a)$, and $p_0=\\alpha^2(a+bk)$. The stability boundary is where $p_2 p_1 - p_0 = 0$, which led to our quadratic equation for $\\alpha_c$. The expression $2\\alpha^2 - (bk-4a)\\alpha + 2a^2$ is a parabola opening upwards. It is negative between its roots $\\alpha_{c2}$ (smaller root) and $\\alpha_{c1}$ (larger root), which corresponds to instability.\nThe system starts with a very small delay $\\tau \\approx 0$, which corresponds to a very large rate $\\alpha \\to \\infty$. In this limit, the system is stable. As the delay $\\tau$ increases from $0$, $\\alpha = 2/\\tau$ decreases from $\\infty$. The system first loses stability when $\\alpha$ decreases to the larger root, $\\alpha_{c1}$:\n$$\n\\alpha_{c1} = \\frac{bk-4a + \\sqrt{bk(bk - 8a)}}{4}\n$$\nThe problem asks for the smallest positive mean delay $\\tau_c$ at which the system first loses stability. This corresponds to the largest critical rate, $\\alpha_{c1}$. The critical delay is:\n$$\n\\tau_c = \\frac{2}{\\alpha_{c1}} = \\frac{2}{\\frac{bk-4a + \\sqrt{bk(bk - 8a)}}{4}}\n$$\n$$\n\\tau_c = \\frac{8}{bk-4a + \\sqrt{bk(bk - 8a)}}\n$$\nThis is the closed-form expression for the critical delay.",
            "answer": "$$\\boxed{\\frac{8}{bk-4a + \\sqrt{bk(bk - 8a)}}}$$"
        }
    ]
}