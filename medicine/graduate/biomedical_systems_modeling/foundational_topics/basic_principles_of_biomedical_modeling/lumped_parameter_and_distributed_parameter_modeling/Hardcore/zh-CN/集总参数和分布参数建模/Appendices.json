{
    "hands_on_practices": [
        {
            "introduction": "集总参数模型是生物医学系统建模的基石，尤其在药物动力学（pharmacokinetics）领域。本练习将通过一个经典的二室模型来实践核心分析技术。通过建立和求解描述药物在体内分布的常微分方程组，您将掌握计算稳态浓度和主导系统动态响应时间常数的能力，这些都是评估药物疗效和设计给药方案的关键技能。",
            "id": "3898618",
            "problem": "将一种治疗剂通过恒速静脉输注的方式给药于一位患者，其在体内的分布由一个集总参数二室药代动力学模型表示。中央室代表血浆，体积为 $V_1$；外周室代表组织，体积为 $V_2$。药物以恒定速率 $R_{\\text{in}}$ 输注到中央室，通过线性清除率 $CL$ 从中央室消除，并以室间清除率 $Q$ 在两室之间进行双向交换。设状态变量为中央室和外周室中的药物量，分别为 $A_1(t)$ 和 $A_2(t)$，浓度分别为 $C_1(t) = A_1(t)/V_1$ 和 $C_2(t) = A_2(t)/V_2$。\n\n使用质量守恒和线性转运来对系统进行建模，其中药物消除与 $C_1(t)$ 成正比，比例系数为 $CL$，室间流动与室浓度成正比，比例系数为 $Q$。参数如下：\n- $V_1 = 5$ L, $V_2 = 15$ L,\n- $CL = 0.6$ L/min,\n- $Q = 1.2$ L/min,\n- $R_{\\text{in}} = 6$ mg/min.\n\n任务：\n1. 从质量守恒以及 $C_1(t)$ 和 $C_2(t)$ 的定义出发，推导关于 $A_1(t)$ 和 $A_2(t)$ 的常微分方程（ODE）系统，并将其写成向量-矩阵形式 $\\dot{\\mathbf{A}}(t) = \\mathbf{M}\\,\\mathbf{A}(t) + \\mathbf{u}$，其中 $\\mathbf{A}(t) = \\begin{pmatrix}A_1(t) \\\\ A_2(t)\\end{pmatrix}$。\n2. 通过求解ODE系统的平衡点，计算恒速输注下的稳态浓度 $C_{1,\\text{ss}}$ 和 $C_{2,\\text{ss}}$。\n3. 对系统矩阵 $\\mathbf{M}$ 进行特征值分析，确定主导时间常数 $\\tau_{\\text{dom}}$，其定义为 $\\tau_{\\text{dom}} = -1/\\lambda_{\\text{dom}}$，其中 $\\lambda_{\\text{dom}}$ 是 $\\mathbf{M}$ 的具有最大实部（最接近于零）的特征值。\n\n稳态浓度以 mg/L 为单位，主导时间常数以分钟为单位。提供精确的解析表达式，不要四舍五入。最终答案必须是包含 $C_{1,\\text{ss}}$、$C_{2,\\text{ss}}$ 和 $\\tau_{\\text{dom}}$（按此顺序）的单个组合对象。",
            "solution": "用户希望我解决一个基于二室药代动力学模型的问题。\n\n### 第1步：提取已知条件\n- **模型类型**: 集总参数二室模型。\n- **房室**: 中央室（血浆），体积 $V_1$；外周室（组织），体积 $V_2$。\n- **状态变量**: 中央室中的药量 $A_1(t)$，外周室中的药量 $A_2(t)$。\n- **浓度**: $C_1(t) = A_1(t)/V_1$，$C_2(t) = A_2(t)/V_2$。\n- **输入与输出**:\n    - 向中央室恒速输注：速率 $R_{\\text{in}}$。\n    - 从中央室线性消除：清除率 $CL$。消除速率为 $CL \\times C_1(t)$。\n    - 室间双向交换：室间清除率 $Q$。流速为 $Q \\times C_1(t)$ 和 $Q \\times C_2(t)$。\n- **参数值**:\n    - $V_1 = 5$ L\n    - $V_2 = 15$ L\n    - $CL = 0.6$ L/min\n    - $Q = 1.2$ L/min\n    - $R_{\\text{in}} = 6$ mg/min\n- **任务**:\n    1. 推导ODE系统，形式为 $\\dot{\\mathbf{A}}(t) = \\mathbf{M}\\,\\mathbf{A}(t) + \\mathbf{u}$。\n    2. 计算稳态浓度 $C_{1,\\text{ss}}$ 和 $C_{2,\\text{ss}}$。\n    3. 计算主导时间常数 $\\tau_{\\text{dom}} = -1/\\lambda_{\\text{dom}}$，其中 $\\lambda_{\\text{dom}}$ 是 $\\mathbf{M}$ 的最接近零的特征值。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**: 该问题描述了一个在药代动力学中使用的标准二室模型，这是生物医学工程和药理学中一个成熟的子领域。质量守恒和线性动力学原理是此类建模的基础。该问题具有科学合理性。\n- **适定性**: 该问题定义清晰，提供了所有必要的参数和关系。它要求推导线性ODE系统、计算其稳态并分析其特征值，这些都是标准步骤，会导向一个唯一的稳定解。由于存在消除途径，该系统是稳定的。\n- **客观性**: 该问题使用精确、标准的术语和定量值进行陈述。它没有歧义、主观性或观点。\n- **其他标准**: 该问题是自包含的，其参数在量纲上是一致的，并且与生物医学系统中的集总参数建模直接相关。\n\n### 第3步：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答\n\n解答过程按题目要求分为三个部分。\n\n**任务1：推导ODE系统**\n\n我们对每个室应用质量守恒原理。一个室中药物量的变化率等于流入速率减去流出速率。\n\n对于中央室（1室），药物以速率 $R_{\\text{in}}$ 通过输注进入，并以速率 $Q \\times C_2(t)$ 从外周室进入。药物以速率 $CL \\times C_1(t)$ 通过消除离开，并以速率 $Q \\times C_1(t)$ 转移到外周室离开。\n$A_1(t)$ 的质量平衡方程为：\n$$\n\\frac{dA_1}{dt} = R_{\\text{in}} + Q C_2(t) - (CL + Q) C_1(t)\n$$\n对于外周室（2室），药物以速率 $Q \\times C_1(t)$ 从中央室进入，并以速率 $Q \\times C_2(t)$ 返回中央室而离开。\n$A_2(t)$ 的质量平衡方程为：\n$$\n\\frac{dA_2}{dt} = Q C_1(t) - Q C_2(t)\n$$\n为了用状态变量 $A_1(t)$ 和 $A_2(t)$ 表示这些方程，我们代入浓度的定义 $C_1(t) = A_1(t)/V_1$ 和 $C_2(t) = A_2(t)/V_2$：\n$$\n\\frac{dA_1}{dt} = R_{\\text{in}} + Q \\frac{A_2(t)}{V_2} - (CL + Q) \\frac{A_1(t)}{V_1}\n$$\n$$\n\\frac{dA_2}{dt} = Q \\frac{A_1(t)}{V_1} - Q \\frac{A_2(t)}{V_2}\n$$\n将这些方程整理成 $\\dot{\\mathbf{A}}(t) = \\mathbf{M}\\,\\mathbf{A}(t) + \\mathbf{u}$ 的形式：\n$$\n\\frac{dA_1}{dt} = -\\left(\\frac{CL+Q}{V_1}\\right) A_1(t) + \\left(\\frac{Q}{V_2}\\right) A_2(t) + R_{\\text{in}}\n$$\n$$\n\\frac{dA_2}{dt} = \\left(\\frac{Q}{V_1}\\right) A_1(t) - \\left(\\frac{Q}{V_2}\\right) A_2(t)\n$$\n用向量-矩阵形式表示，该系统为：\n$$\n\\begin{pmatrix} \\dot{A_1}(t) \\\\ \\dot{A_2}(t) \\end{pmatrix} = \\begin{pmatrix} -\\frac{CL+Q}{V_1} & \\frac{Q}{V_2} \\\\ \\frac{Q}{V_1} & -\\frac{Q}{V_2} \\end{pmatrix} \\begin{pmatrix} A_1(t) \\\\ A_2(t) \\end{pmatrix} + \\begin{pmatrix} R_{\\text{in}} \\\\ 0 \\end{pmatrix}\n$$\n因此，系统矩阵 $\\mathbf{M}$ 和输入向量 $\\mathbf{u}$ 为：\n$$\n\\mathbf{M} = \\begin{pmatrix} -\\frac{CL+Q}{V_1} & \\frac{Q}{V_2} \\\\ \\frac{Q}{V_1} & -\\frac{Q}{V_2} \\end{pmatrix}, \\quad \\mathbf{u} = \\begin{pmatrix} R_{\\text{in}} \\\\ 0 \\end{pmatrix}\n$$\n\n**任务2：稳态浓度**\n\n在稳态下，各室中的药物量是恒定的，因此它们的时间导数为零：$\\dot{A_1}(t) = 0$ 且 $\\dot{A_2}(t) = 0$。设稳态药量为 $A_{1,\\text{ss}}$ 和 $A_{2,\\text{ss}}$。ODE系统变为一个代数系统：\n$$\n0 = R_{\\text{in}} + Q C_{2,\\text{ss}} - (CL + Q) C_{1,\\text{ss}}\n$$\n$$\n0 = Q C_{1,\\text{ss}} - Q C_{2,\\text{ss}}\n$$\n从第二个方程可知，由于 $Q>0$，我们发现稳态时浓度必须相等：\n$$\nC_{1,\\text{ss}} = C_{2,\\text{ss}}\n$$\n这在物理上是直观的，因为室间的净流动需要浓度梯度。\n将 $C_{2,\\text{ss}} = C_{1,\\text{ss}}$ 代入第一个方程：\n$$\n0 = R_{\\text{in}} + Q C_{1,\\text{ss}} - (CL + Q) C_{1,\\text{ss}}\n$$\n$$\n0 = R_{\\text{in}} - CL \\cdot C_{1,\\text{ss}}\n$$\n这个结果表明，在稳态下，药物输注的速率等于药物消除的速率。求解稳态浓度：\n$$\nC_{1,\\text{ss}} = \\frac{R_{\\text{in}}}{CL}\n$$\n使用给定的参数值：\n$$\nR_{\\text{in}} = 6 \\text{ mg/min}, \\quad CL = 0.6 \\text{ L/min}\n$$\n$$\nC_{1,\\text{ss}} = \\frac{6 \\text{ mg/min}}{0.6 \\text{ L/min}} = 10 \\text{ mg/L}\n$$\n因为 $C_{1,\\text{ss}} = C_{2,\\text{ss}}$，我们有：\n$$\nC_{2,\\text{ss}} = 10 \\text{ mg/L}\n$$\n\n**任务3：主导时间常数**\n\n系统的动态行为由矩阵 $\\mathbf{M}$ 的特征值决定。主导时间常数由实部最大（最接近于零）的特征值决定，记为 $\\lambda_{\\text{dom}}$。\n特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{M} - \\lambda\\mathbf{I}) = 0$ 的根。\n特征方程为 $\\lambda^2 - \\text{Tr}(\\mathbf{M})\\lambda + \\det(\\mathbf{M}) = 0$。\n\n我们来计算 $\\mathbf{M}$ 的迹和行列式：\n$$\n\\text{Tr}(\\mathbf{M}) = -\\frac{CL+Q}{V_1} - \\frac{Q}{V_2}\n$$\n$$\n\\det(\\mathbf{M}) = \\left(-\\frac{CL+Q}{V_1}\\right) \\left(-\\frac{Q}{V_2}\\right) - \\left(\\frac{Q}{V_1}\\right) \\left(\\frac{Q}{V_2}\\right) = \\frac{(CL+Q)Q}{V_1 V_2} - \\frac{Q^2}{V_1 V_2} = \\frac{CL \\cdot Q}{V_1 V_2}\n$$\n让我们将参数值代入为精确分数以保持精度：\n$V_1 = 5$, $V_2 = 15$, $CL = 0.6 = \\frac{3}{5}$, $Q = 1.2 = \\frac{6}{5}$。\n设 $P = -\\text{Tr}(\\mathbf{M})$ 且 $S = \\det(\\mathbf{M})$。\n$$\nP = \\frac{CL+Q}{V_1} + \\frac{Q}{V_2} = \\frac{\\frac{3}{5}+\\frac{6}{5}}{5} + \\frac{\\frac{6}{5}}{15} = \\frac{\\frac{9}{5}}{5} + \\frac{6}{75} = \\frac{9}{25} + \\frac{2}{25} = \\frac{11}{25} \\text{ min}^{-1}\n$$\n$$\nS = \\frac{CL \\cdot Q}{V_1 V_2} = \\frac{(\\frac{3}{5})(\\frac{6}{5})}{5 \\times 15} = \\frac{\\frac{18}{25}}{75} = \\frac{18}{1875} = \\frac{6}{625} \\text{ min}^{-2}\n$$\n特征方程为 $\\lambda^2 + P\\lambda + S = 0$，即 $\\lambda^2 + \\frac{11}{25}\\lambda + \\frac{6}{625} = 0$。\n$\\lambda$ 的解由二次公式给出：\n$$\n\\lambda = \\frac{-P \\pm \\sqrt{P^2 - 4S}}{2}\n$$\n判别式为：\n$$\nD = P^2 - 4S = \\left(\\frac{11}{25}\\right)^2 - 4\\left(\\frac{6}{625}\\right) = \\frac{121}{625} - \\frac{24}{625} = \\frac{97}{625}\n$$\n所以，$\\sqrt{D} = \\sqrt{\\frac{97}{625}} = \\frac{\\sqrt{97}}{25}$。\n特征值为：\n$$\n\\lambda = \\frac{-\\frac{11}{25} \\pm \\frac{\\sqrt{97}}{25}}{2} = \\frac{-11 \\pm \\sqrt{97}}{50}\n$$\n两个特征值都是实数且为负，因为 $11 = \\sqrt{121} > \\sqrt{97}$。主导特征值 $\\lambda_{\\text{dom}}$ 是更接近于零的那个（即数值较大的那个）：\n$$\n\\lambda_{\\text{dom}} = \\frac{-11 + \\sqrt{97}}{50}\n$$\n主导时间常数 $\\tau_{\\text{dom}}$ 定义为 $-1/\\lambda_{\\text{dom}}$：\n$$\n\\tau_{\\text{dom}} = -\\frac{1}{\\lambda_{\\text{dom}}} = -\\frac{50}{-11 + \\sqrt{97}} = \\frac{50}{11 - \\sqrt{97}}\n$$\n为了使分母有理化，我们将分子和分母同乘以共轭项 $(11 + \\sqrt{97})$：\n$$\n\\tau_{\\text{dom}} = \\frac{50(11 + \\sqrt{97})}{(11 - \\sqrt{97})(11 + \\sqrt{97})} = \\frac{50(11 + \\sqrt{97})}{11^2 - (\\sqrt{97})^2} = \\frac{50(11 + \\sqrt{97})}{121 - 97} = \\frac{50(11 + \\sqrt{97})}{24}\n$$\n通过除以 $2$ 来简化分数 $\\frac{50}{24}$：\n$$\n\\tau_{\\text{dom}} = \\frac{25}{12}(11 + \\sqrt{97}) \\text{ min}\n$$\n\n最终结果为 $C_{1,\\text{ss}} = 10 \\text{ mg/L}$，$C_{2,\\text{ss}} = 10 \\text{ mg/L}$，以及 $\\tau_{\\text{dom}} = \\frac{25}{12}(11 + \\sqrt{97})$ min。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 10 & 10 & \\frac{25}{12}(11 + \\sqrt{97}) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "许多集总参数模型本质上是更为复杂的分布式参数系统在空间上的离散化。然而，这种简化并非没有代价。本练习将引导您通过修正方程分析（modified equation analysis）来探究这一过程的微妙之处，具体来说，是分析一维平流方程的不同离散格式。通过此练习，您将揭示一阶迎风格式如何引入非物理的“数值扩散”（numerical diffusion），并能量化其大小，这对于在模拟中区分数值伪影和真实物理现象至关重要。",
            "id": "3898648",
            "problem": "一个浓度场为 $c(x,t)$ 的示踪溶质，在长度为 $L$ 的直的、刚性的微血管段中，以稳定、空间均匀的轴向速度 $u>0$ 进行输运。假设相对于对流输运，轴向分子扩散可忽略不计，径向梯度也可忽略不计，因此轴向输运可以很好地用恒定体积流量的守恒定律来描述，该定律简化为被动标量的一维平流偏微分方程（PDE）：$\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$。考虑一个间距为 $\\Delta x$ 的均匀空间网格，网格点为 $x_i = i \\Delta x$，其中 $i \\in \\mathbb{Z}$ 在集总参数视角下为分布式血管的隔室索引。在内部节点，考虑对 $\\frac{\\partial c}{\\partial x}$ 进行两种空间离散化：使用 $c_{i+1}$ 和 $c_{i-1}$ 的中心差分格式，以及当 $u>0$ 时使用 $c_{i}$ 和 $c_{i-1}$ 的一阶迎风格式。将时间视为连续的（半离散分析），并假设 $c(x,t)$ 足够光滑以支持泰勒展开。从该偏微分方程和这些半离散空间近似出发，通过将 $c_{i\\pm 1}(t)$ 在 $x_i$ 附近进行泰勒级数展开，并代入半离散方程中，进行修正方程分析。识别每种格式的截断误差中的主导项，并判断其是色散性的（奇数阶导数）还是耗散性的（偶数阶导数）。最后，对于一阶迎风空间离散化，将修正方程改写为平流-扩散形式 $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = D_{\\mathrm{eq}} \\frac{\\partial^{2} c}{\\partial x^{2}} + \\text{高阶项}$，并确定等效扩散系数 $D_{\\mathrm{eq}}$ 关于 $u$ 和 $\\Delta x$ 的解析表达式。用国际单位制（SI）基本单位平方米每秒 $(\\mathrm{m}^{2}/\\mathrm{s})$ 表示您最终的 $D_{\\mathrm{eq}}$ 表达式。无需进行数值四舍五入；提供一个封闭形式的符号表达式。",
            "solution": "该问题要求对一维平流方程的两种空间离散格式进行修正方程分析。这种分析揭示了由离散化引入的截断误差的性质，该误差表现为数值格式实际求解的微分方程中的附加项。\n\n控制的分布参数模型是一维平流偏微分方程（PDE）：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0\n$$\n其中 $c(x,t)$ 是浓度，$u > 0$ 是恒定的平流速度。\n\n我们分析两种半离散近似，其中时间 $t$ 保持连续，但空间域被离散化为点 $x_i = i \\Delta x$。这些点上的浓度表示为 $c_i(t) = c(x_i, t)$。在 $x_i$ 处的时间导数 $\\frac{\\partial c}{\\partial t}$ 被替换为 $\\frac{d c_i}{d t}$。空间导数 $\\frac{\\partial c}{\\partial x}$ 使用有限差分进行近似。我们使用 $c(x,t)$ 在点 $x_i$ 附近的泰勒级数展开来推导修正方程。$c_{i+1} = c(x_i+\\Delta x,t)$ 和 $c_{i-1} = c(x_i-\\Delta x,t)$ 的展开式为：\n$$\nc_{i+1}(t) = c_i + \\Delta x \\frac{\\partial c}{\\partial x}\\bigg|_{i} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 c}{\\partial x^2}\\bigg|_{i} + \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 c}{\\partial x^3}\\bigg|_{i} + \\mathcal{O}((\\Delta x)^4)\n$$\n$$\nc_{i-1}(t) = c_i - \\Delta x \\frac{\\partial c}{\\partial x}\\bigg|_{i} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 c}{\\partial x^2}\\bigg|_{i} - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 c}{\\partial x^3}\\bigg|_{i} + \\mathcal{O}((\\Delta x)^4)\n$$\n其中导数在 $x_i$ 处求值。\n\n**第一部分：中心差分格式**\n\n空间导数的中心差分近似为：\n$$\n\\frac{\\partial c}{\\partial x}\\bigg|_{i} \\approx \\frac{c_{i+1} - c_{i-1}}{2 \\Delta x}\n$$\n将此代入控制偏微分方程，得到集总参数模型的半离散方程：\n$$\n\\frac{d c_i}{d t} + u \\left( \\frac{c_{i+1} - c_{i-1}}{2 \\Delta x} \\right) = 0\n$$\n为了找到修正方程，我们将 $c_{i+1}$ 和 $c_{i-1}$ 的泰勒级数代入有限差分项中：\n$$\nc_{i+1} - c_{i-1} = \\left( c_i + \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\dots \\right) - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\dots \\right)\n$$\n$$\nc_{i+1} - c_{i-1} = 2 \\Delta x \\frac{\\partial c}{\\partial x} + 2 \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\mathcal{O}((\\Delta x)^5)\n$$\n除以 $2 \\Delta x$：\n$$\n\\frac{c_{i+1} - c_{i-1}}{2 \\Delta x} = \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4)\n$$\n将此代回半离散方程，得到修正方程：\n$$\n\\frac{\\partial c}{\\partial t} + u \\left( \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4) \\right) = 0\n$$\n重新整理以匹配原始偏微分方程加误差项的形式：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} - \\mathcal{O}(u (\\Delta x)^4)\n$$\n截断误差中的主导项是 $-u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3}$。由于该项涉及奇数阶空间导数（三阶导数），它会在数值解中引入非物理振荡，即色散。因此，中心差分格式的主导误差是**色散性的**。\n\n**第二部分：一阶迎风格式**\n\n对于 $u > 0$，“迎风”方向是 $x$ 轴负方向，因此一阶迎风格式使用网格点 $x_i$ 和 $x_{i-1}$。空间导数的近似为：\n$$\n\\frac{\\partial c}{\\partial x}\\bigg|_{i} \\approx \\frac{c_i - c_{i-1}}{\\Delta x}\n$$\n半离散方程为：\n$$\n\\frac{d c_i}{d t} + u \\left( \\frac{c_i - c_{i-1}}{\\Delta x} \\right) = 0\n$$\n我们将 $c_{i-1}$ 的泰勒级数代入有限差分项中：\n$$\n\\frac{c_i - c_{i-1}}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ c_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\dots \\right) \\right]\n$$\n$$\n\\frac{c_i - c_{i-1}}{\\Delta x} = \\frac{1}{\\Delta x} \\left( \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 c}{\\partial x^3} - \\dots \\right)\n$$\n$$\n\\frac{c_i - c_{i-1}}{\\Delta x} = \\frac{\\partial c}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} - \\mathcal{O}((\\Delta x)^3)\n$$\n将此结果代入半离散方程，得到迎风格式的修正方程：\n$$\n\\frac{\\partial c}{\\partial t} + u \\left( \\frac{\\partial c}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} - \\dots \\right) = 0\n$$\n重新整理以分离误差项：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} - u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\dots\n$$\n截断误差中的主导项是 $u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2}$。由于该项涉及偶数阶空间导数（二阶导数），它模仿了物理扩散过程，导致尖锐梯度被抹平。这种效应被称为数值耗散或人工粘性。因此，一阶迎风格式的主导误差是**耗散性的**。\n\n**第三部分：等效扩散系数**\n\n问题要求将迎风格式的修正方程改写为平流-扩散形式：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = D_{\\mathrm{eq}} \\frac{\\partial^{2} c}{\\partial x^{2}} + \\text{高阶项}\n$$\n通过将此形式与我们推导出的修正方程进行比较，\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\left( u \\frac{\\Delta x}{2} \\right) \\frac{\\partial^2 c}{\\partial x^2} - u \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 c}{\\partial x^3} + \\dots\n$$\n我们可以直接将二阶导数项的系数识别为等效扩散系数 $D_{\\mathrm{eq}}$。\n$$\nD_{\\mathrm{eq}} = \\frac{u \\Delta x}{2}\n$$\n为了验证单位，令 $[X]$ 表示量 $X$ 的单位。速度 $u$ 的单位是 $[u] = \\mathrm{m}/\\mathrm{s}$，网格间距 $\\Delta x$ 的单位是 $[\\Delta x] = \\mathrm{m}$。因此，$D_{\\mathrm{eq}}$ 的单位是：\n$$\n[D_{\\mathrm{eq}}] = [u] [\\Delta x] = \\left( \\frac{\\mathrm{m}}{\\mathrm{s}} \\right) (\\mathrm{m}) = \\frac{\\mathrm{m}^2}{\\mathrm{s}}\n$$\n这与扩散系数的单位一致，符合要求。",
            "answer": "$$\\boxed{\\frac{u \\Delta x}{2}}$$"
        },
        {
            "introduction": "一个生物医学模型的实用性最终取决于其参数能否通过实验数据进行标定。本练习将带您进入模型参数估计的实践领域，这是一个连接理论与应用的关键环节。您将处理一个具有压力依赖性阻力的非线性血流动力学模型，通过将模型线性化并应用普通最小二乘法（OLS）来估计关键参数 $R_0$ 和 $\\alpha$。此外，您还将学习使用 delta 方法来量化估计参数的不确定性，这对于验证模型的可靠性和预测能力至关重要。",
            "id": "3898622",
            "problem": "考虑一段短血管段中的稳态不可压缩流，该血管段被建模为一个阻性元件。流经该段的稳态压降（记为 $\\Delta P$）满足本构关系 $\\Delta P = R(P)\\,Q$，此关系源于准稳态层流中的质量守恒和能量平衡。其中，$Q$ 是体积流量，$R(P)$ 是与压力相关的流体动力学阻力。在某些可塌陷或可扩张的血管中，一个用于描述压力依赖性的一阶模型为 $R(P) = R_0\\,(1 + \\alpha P)$，其中 $R_0$ 是基线阻力，$\\alpha$ 用于量化线性压力敏感度。给定三元组 $(P_i, Q_i, \\Delta P_i)$，其中 $P_i$ 是测量的跨壁压，$Q_i$ 是测量的流量，$\\Delta P_i$ 是测量的压降，且 $\\Delta P_i$ 中含有加性测量噪声。对于每个数据集，在 $\\Delta P$ 的加性噪声模型下，通过最小化残差平方和来估计 $R_0$ 和 $\\alpha$，并使用适当的大样本或小样本近似法计算 $R_0$ 和 $\\alpha$ 在 $95\\%$ 置信水平下的双侧置信区间。所有压力单位必须为千帕 (kPa)，所有流量单位必须为毫升/秒 (mL/s)，所有压降单位必须为千帕 (kPa)，$R_0$ 的报告单位必须为 $\\text{kPa}\\cdot \\text{s}/\\text{mL}$，$\\alpha$ 的报告单位必须为 $1/\\text{kPa}$。所有数值输出均表示为十进制浮点数。\n\n将估计问题纯粹用数学术语表述如下。假设 $\\Delta P_i$ 上的加性噪声 $\\varepsilon_i$ 是独立同分布的，其均值为零，方差有限，模型为\n$$\n\\Delta P_i = R_0\\,(1 + \\alpha P_i)\\,Q_i + \\varepsilon_i.\n$$\n这意味着一个关于变换后回归量的线性回归：\n$$\ny_i = \\theta_1 x_{1i} + \\theta_2 x_{2i} + \\varepsilon_i,\n$$\n其中 $y_i = \\Delta P_i$, $x_{1i} = Q_i$, $x_{2i} = P_i Q_i$，未知参数向量 $\\theta = [\\theta_1,\\theta_2]^\\top$ 满足 $\\theta_1 = R_0$ 和 $\\theta_2 = R_0 \\alpha$。通过普通最小二乘法 (OLS) 估计 $\\theta$，然后通过映射 $R_0 = \\theta_1$ 和 $\\alpha = \\theta_2/\\theta_1$ 来恢复 $R_0$ 和 $\\alpha$。使用 $\\hat{\\theta}$ 的 OLS 协方差和针对比率 $\\alpha$ 的 delta 方法，构建 $R_0$ 和 $\\alpha$ 的近似 $95\\%$ 置信区间。\n\n您的程序必须为以下测试套件中的每个数据集解决上述问题，并生成单行输出。输出内容为一个方括号括起来的逗号分隔列表，其中每个数据集的结果本身就是一个列表，顺序为 $[R_0^{\\text{hat}}, \\alpha^{\\text{hat}}, R_{0,\\text{low}}, R_{0,\\text{high}}, \\alpha_{\\text{low}}, \\alpha_{\\text{high}}]$，其中的界限对应于双侧 $95\\%$ 置信区间。将报告的每个浮点数四舍五入到 $6$ 位小数。\n\n数据集（每行定义一个 $(P, Q, \\Delta P)$ 序列）：\n\n- 数据集 A（典型变异，中等噪声）：\n  - $P = [2.0, 3.5, 5.0, 6.5, 8.0, 9.5, 11.0, 12.5, 14.0, 15.5]$\n  - $Q = [2.5, 3.0, 3.2, 3.5, 3.8, 4.0, 4.2, 4.5, 4.7, 5.0]$\n  - $\\Delta P = [0.222, 0.2696, 0.3102, 0.3508, 0.40628, 0.4356, 0.48784, 0.537, 0.58856, 0.643]$\n\n- 数据集 B（低压范围，$\\alpha$ 的可辨识性弱）：\n  - $P = [0.0, 0.2, 0.4, 0.6, 0.8]$\n  - $Q = [2.0, 2.1, 2.2, 2.3, 2.4]$\n  - $\\Delta P = [0.2005, 0.21044, 0.22206, 0.23256, 0.24394]$\n\n- 数据集 C（宽范围，较高噪声）：\n  - $P = [1.0, 2.0, 3.0, 5.0, 7.0, 9.0, 10.0, 12.0, 14.0, 16.0, 18.0, 20.0]$\n  - $Q = [1.8, 2.0, 2.2, 2.6, 3.0, 3.4, 3.6, 3.8, 4.0, 4.3, 4.6, 5.0]$\n  - $\\Delta P = [0.13448, 0.1194, 0.16576, 0.1828, 0.2706, 0.28916, 0.3656, 0.37716, 0.4516, 0.48568, 0.58908, 0.635]$\n\n算法和输出要求：\n\n- 使用普通最小二乘法 (OLS) 估计 $\\hat{\\theta} = (\\hat{\\theta}_1, \\hat{\\theta}_2)^\\top$。\n- 使用自由度为 $N - 2$ 的无偏残差方差估计量，其中 $N$ 是数据集中样本的数量。\n- 使用 delta 方法从 $\\hat{\\theta}$ 的协方差中获取 $\\hat{\\alpha} = \\hat{\\theta}_2/\\hat{\\theta}_1$ 的近似方差。\n- 使用自由度为 $N-2$ 的学生 t 分布的分位数来构建双侧 $95\\%$ 置信区间。\n- 您的程序应生成单行输出，包含一个方括号括起来的逗号分隔列表，其中每个数据集的 $6$ 元组都用方括号括起来，数字四舍五入到 $6$ 位小数，例如 $[[r_{1},a_{1},l_{r1},u_{r1},l_{a1},u_{a1}],[r_{2},a_{2},l_{r2},u_{r2},l_{a2},u_{a2}],[r_{3},a_{3},l_{r3},u_{r3},l_{a3},u_{a3}]]$，其中 $r_i$ 表示数据集 $i$ 的 $R_0^{\\text{hat}}$，$a_i$ 表示数据集 $i$ 的 $\\alpha^{\\text{hat}}$，$l$ 和 $u$ 分别表示置信下限和上限。",
            "solution": "该问题要求根据给定的血管段压降本构关系 $\\Delta P = R_0(1 + \\alpha P)Q$ 来估计两个参数 $R_0$ 和 $\\alpha$。我们获得了带有噪声的压降测量值 $\\Delta P_i$，以及相应的跨壁压 $P_i$ 和流量 $Q_i$。任务是使用普通最小二乘法 (OLS) 回归进行此估计，并为估计值构建 $95\\%$ 的置信区间。\n\n估计过程的结构如下：首先，我们针对一组新参数将模型线性化。给定的模型是：\n$$\n\\Delta P_i = R_0\\,(1 + \\alpha P_i)\\,Q_i + \\varepsilon_i\n$$\n其中 $\\varepsilon_i$ 是均值为 $0$、方差为 $\\sigma^2$ 的独立同分布噪声项。该方程可以展开为：\n$$\n\\Delta P_i = R_0 Q_i + (R_0 \\alpha) P_i Q_i + \\varepsilon_i\n$$\n这是一个形如 $y_i = \\theta_1 x_{1i} + \\theta_2 x_{2i} + \\varepsilon_i$ 的线性模型，其中：\n- 响应变量是 $y_i = \\Delta P_i$。\n- 回归量（预测变量）是 $x_{1i} = Q_i$ 和 $x_{2i} = P_i Q_i$。\n- 待估计的参数是 $\\theta_1 = R_0$ 和 $\\theta_2 = R_0 \\alpha$。\n\n对于一个包含 $N$ 个测量值的数据集，该方程组可以写成矩阵形式：\n$$\n\\mathbf{y} = X\\mathbf{\\theta} + \\mathbf{\\varepsilon}\n$$\n其中：\n- $\\mathbf{y} = [\\Delta P_1, \\Delta P_2, \\dots, \\Delta P_N]^\\top$ 是观测到的压降的 $N \\times 1$ 向量。\n- $X$ 是 $N \\times 2$ 的设计矩阵，其第 $i$ 行为 $[x_{1i}, x_{2i}] = [Q_i, P_i Q_i]$。\n- $\\mathbf{\\theta} = [\\theta_1, \\theta_2]^\\top$ 是未知参数的 $2 \\times 1$ 向量。\n- $\\mathbf{\\varepsilon} = [\\varepsilon_1, \\varepsilon_2, \\dots, \\varepsilon_N]^\\top$ 是未观测到的随机误差的向量。\n\n$\\mathbf{\\theta}$ 的普通最小二乘法 (OLS) 估计值（记为 $\\hat{\\mathbf{\\theta}}$）是使残差平方和 $SSR = \\sum_{i=1}^N (y_i - (\\theta_1 x_{1i} + \\theta_2 x_{2i}))^2$ 最小化的向量。解由正规方程给出：\n$$\n\\hat{\\mathbf{\\theta}} = (X^\\top X)^{-1} X^\\top \\mathbf{y}\n$$\n一旦我们得到估计值 $\\hat{\\mathbf{\\theta}} = [\\hat{\\theta}_1, \\hat{\\theta}_2]^\\top$，我们就可以恢复原始物理参数的估计值 $\\hat{R}_0$ 和 $\\hat{\\alpha}$：\n$$\n\\hat{R}_0 = \\hat{\\theta}_1\n$$\n$$\n\\hat{\\alpha} = \\frac{\\hat{\\theta}_2}{\\hat{\\theta}_1}\n$$\n\n为了构建置信区间，我们首先需要估计误差项的方差 $\\sigma^2$。$\\sigma^2$ 的一个无偏估计量是均方误差 $s^2$：\n$$\ns^2 = \\frac{1}{N-p} \\sum_{i=1}^N e_i^2 = \\frac{SSR}{N-p}\n$$\n其中 $e_i = y_i - (\\hat{\\theta}_1 x_{1i} + \\hat{\\theta}_2 x_{2i})$ 是残差，$p=2$ 是线性模型中参数的数量。估计的自由度为 $df = N-2$。\n\n参数向量 $\\hat{\\mathbf{\\theta}}$ 的估计协方差矩阵由下式给出：\n$$\n\\text{Cov}(\\hat{\\mathbf{\\theta}}) = s^2(X^\\top X)^{-1} = \\begin{pmatrix} \\text{Var}(\\hat{\\theta}_1) & \\text{Cov}(\\hat{\\theta}_1, \\hat{\\theta}_2) \\\\ \\text{Cov}(\\hat{\\theta}_1, \\hat{\\theta}_2) & \\text{Var}(\\hat{\\theta}_2) \\end{pmatrix} = \\begin{pmatrix} \\sigma^2_{\\hat{\\theta}_1} & \\sigma_{\\hat{\\theta}_1, \\hat{\\theta}_2} \\\\ \\sigma_{\\hat{\\theta}_1, \\hat{\\theta}_2} & \\sigma^2_{\\hat{\\theta}_2} \\end{pmatrix}\n$$\n\n参数的 $100(1-\\gamma)\\%$ 置信区间构建为 $\\text{估计值} \\pm t_{1-\\gamma/2, df} \\cdot \\text{SE}(\\text{估计值})$，其中 $t_{1-\\gamma/2, df}$ 是自由度为 $df$ 的学生 t 分布的上 $(1-\\gamma/2)$ 分位数。对于 $95\\%$ 的置信水平，$\\gamma = 0.05$。\n\n对于 $R_0$，由于 $\\hat{R}_0 = \\hat{\\theta}_1$，其标准误为 $SE(\\hat{R}_0) = \\sqrt{\\text{Var}(\\hat{\\theta}_1)} = \\sqrt{\\sigma^2_{\\hat{\\theta}_1}}$。$R_0$ 的 $95\\%$ 置信区间是：\n$$\nCI(R_0) = \\hat{R}_0 \\pm t_{0.975, N-2} \\cdot SE(\\hat{R}_0)\n$$\n\n对于 $\\alpha$，它是估计参数的非线性函数 ($\\hat{\\alpha} = \\hat{\\theta}_2 / \\hat{\\theta}_1$)，我们使用 delta 方法来近似其方差。函数为 $g(\\theta_1, \\theta_2) = \\theta_2/\\theta_1$。$g$ 的梯度是 $\\nabla g = [-\\theta_2/\\theta_1^2, 1/\\theta_1]^\\top$。$\\hat{\\alpha}$ 的近似方差是：\n$$\n\\text{Var}(\\hat{\\alpha}) \\approx (\\nabla g|_{\\hat{\\mathbf{\\theta}}})^\\top \\text{Cov}(\\hat{\\mathbf{\\theta}}) (\\nabla g|_{\\hat{\\mathbf{\\theta}}})\n$$\n代入各个分量，我们得到：\n$$\n\\text{Var}(\\hat{\\alpha}) \\approx \\begin{bmatrix} -\\frac{\\hat{\\theta}_2}{\\hat{\\theta}_1^2} & \\frac{1}{\\hat{\\theta}_1} \\end{bmatrix} \\begin{pmatrix} \\sigma^2_{\\hat{\\theta}_1} & \\sigma_{\\hat{\\theta}_1, \\hat{\\theta}_2} \\\\ \\sigma_{\\hat{\\theta}_1, \\hat{\\theta}_2} & \\sigma^2_{\\hat{\\theta}_2} \\end{pmatrix} \\begin{bmatrix} -\\frac{\\hat{\\theta}_2}{\\hat{\\theta}_1^2} \\\\ \\frac{1}{\\hat{\\theta}_1} \\end{bmatrix}\n$$\n$$\n\\text{Var}(\\hat{\\alpha}) \\approx \\left(\\frac{\\hat{\\theta}_2}{\\hat{\\theta}_1^2}\\right)^2 \\sigma^2_{\\hat{\\theta}_1} - 2\\frac{\\hat{\\theta}_2}{\\hat{\\theta}_1^3} \\sigma_{\\hat{\\theta}_1, \\hat{\\theta}_2} + \\frac{1}{\\hat{\\theta}_1^2} \\sigma^2_{\\hat{\\theta}_2}\n$$\n使用 $\\hat{\\alpha} = \\hat{\\theta}_2/\\hat{\\theta}_1$，可以简化计算：\n$$\n\\text{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\hat{R}_0^2} \\left[ \\hat{\\alpha}^2 \\sigma^2_{\\hat{\\theta}_1} - 2\\hat{\\alpha} \\sigma_{\\hat{\\theta}_1, \\hat{\\theta}_2} + \\sigma^2_{\\hat{\\theta}_2} \\right]\n$$\n$\\hat{\\alpha}$ 的标准误是 $SE(\\hat{\\alpha}) = \\sqrt{\\text{Var}(\\hat{\\alpha})}$。$\\alpha$ 的 $95\\%$ 置信区间是：\n$$\nCI(\\alpha) = \\hat{\\alpha} \\pm t_{0.975, N-2} \\cdot SE(\\hat{\\alpha})\n$$\n此过程将应用于所提供的三个数据集中的每一个。",
            "answer": "[[0.080182,0.005011,0.070966,0.089398,-0.003926,0.013948],[0.100196,0.001648,0.099190,0.101202,-0.004276,0.007572],[0.082046,0.003507,0.046949,0.117142,-0.002621,0.009635]]"
        }
    ]
}