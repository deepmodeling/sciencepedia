{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在检验您对单位点结合模型的基础理解。通过应用核心的结合等温线方程，您将计算在不同配体浓度下的配体结合量，从而将基本参数 $K_d$ 和 $B_{\\max}$ 与可观测结果直接联系起来。这项实践强化了配体浓度与受体占有率之间的双曲线关系，这是饱和结合分析的基石。",
            "id": "3924131",
            "problem": "一种膜制备物含有受体，这些受体在可逆质量作用动力学下与单价配体结合，其结合反应写为 $R + L \\rightleftharpoons RL$。解离常数 $K_{d}$ 在平衡时定义为 $K_{d} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{[R][L]}{[RL]}$，其中 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 分别是结合和解离速率常数，而 $[R]$、$[L]$ 和 $[RL]$ 分别表示游离受体、游离配体和受体-配体复合物的平衡摩尔浓度。每单位质量膜的受体结合位点总数由 $B_{\\max}$ 量化，其定义为在饱和配体浓度下，每毫克膜结合的配体量。\n\n假设添加的总配体远大于总受体位点，因此游离配体浓度可以等同于添加的配体浓度 $L$（即 $[L] \\approx L$），并且存在单一类别的非协同性结合位点。对于一个受体制备物，其特征为 $B_{\\max} = 500\\,\\mathrm{fmol/mg}$ 和 $K_{d} = 2\\,\\mathrm{nM}$，请确定在配体浓度 $L = 0.5\\,\\mathrm{nM}$、$L = 2\\,\\mathrm{nM}$ 和 $L = 10\\,\\mathrm{nM}$ 时的结合量 $B$（单位为 $\\mathrm{fmol/mg}$）。\n\n将每个结合量四舍五入至四位有效数字，并将这三个值以单个行向量的形式报告。结合量以 $\\mathrm{fmol/mg}$ 为单位表示。然后，使用 Scatchard 分析的框架，推断计算出的这三个点是否与单位点模型所隐含的 Scatchard 图中的线性或曲率一致，并根据计算值定性地证明你的推断。最终报告的数值答案必须仅为这三个结合量。",
            "solution": "该受体-配体系统通过可逆反应 $R + L \\rightleftharpoons RL$ 在质量作用动力学下建模。在平衡时，正向和反向通量相等，即 $k_{\\text{on}}[R][L] = k_{\\text{off}}[RL]$。解离常数定义为 $K_{d} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{[R][L]}{[RL]}$。设每单位质量的总受体位点量为 $B_{\\max}$，这对应于以单位质量的量测量的总受体位点 $[R]_{\\text{tot}}$；为保持一致性，我们使用已占据受体的分数进行计算。在平衡时，受体位点守恒给出 $[R]_{\\text{tot}} = [R] + [RL]$。\n\n定义分数占据率 $\\theta$ 为 $\\theta = \\frac{[RL]}{[R]_{\\text{tot}}}$。使用 $K_{d} = \\frac{[R][L]}{[RL]}$ 和 $[R] = [R]_{\\text{tot}} - [RL] = [R]_{\\text{tot}}(1 - \\theta)$ 以及 $[RL] = \\theta [R]_{\\text{tot}}$，我们得到\n\n$$\nK_{d} = \\frac{[R][L]}{[RL]} = \\frac{([R]_{\\text{tot}} - [RL])L}{[RL]} = \\frac{(1 - \\theta)L}{\\theta}.\n$$\n\n求解 $\\theta$ 得\n\n$$\n\\theta = \\frac{L}{K_{d} + L}.\n$$\n\n每单位质量膜的结合量是分数占据率与每单位质量总结合位点数的乘积：\n\n$$\nB = \\theta B_{\\max} = B_{\\max}\\,\\frac{L}{K_{d} + L}.\n$$\n\n给定 $B_{\\max} = 500\\,\\mathrm{fmol/mg}$ 和 $K_{d} = 2\\,\\mathrm{nM}$，并且假设 $[L] \\approx L$ 允许我们直接用添加的配体浓度替代游离配体浓度。在每个指定的 $L$ 值下计算 $B$：\n\n1. 对于 $L = 0.5\\,\\mathrm{nM}$，\n\n$$\n\\theta = \\frac{0.5}{2 + 0.5} = \\frac{0.5}{2.5} = 0.2,\\quad B = 500 \\times 0.2 = 100\\,\\mathrm{fmol/mg}.\n$$\n\n四舍五入至四位有效数字：$100.0\\,\\mathrm{fmol/mg}$。\n\n2. 对于 $L = 2\\,\\mathrm{nM}$，\n\n$$\n\\theta = \\frac{2}{2 + 2} = \\frac{2}{4} = 0.5,\\quad B = 500 \\times 0.5 = 250\\,\\mathrm{fmol/mg}.\n$$\n\n四舍五入至四位有效数字：$250.0\\,\\mathrm{fmol/mg}$。\n\n3. 对于 $L = 10\\,\\mathrm{nM}$，\n\n$$\n\\theta = \\frac{10}{2 + 10} = \\frac{10}{12} = \\frac{5}{6} \\approx 0.833333\\ldots,\\quad B = 500 \\times \\frac{10}{12} = \\frac{5000}{12} \\approx 416.666\\ldots\\,\\mathrm{fmol/mg}.\n$$\n\n四舍五入至四位有效数字：$416.7\\,\\mathrm{fmol/mg}$。\n\n为了通过 Scatchard 分析解释这些结果，回想一下 Scatchard 图是绘制 $B/L$ 相对于 $B$ 的图。对于单一类别的非协同性位点，\n\n$$\n\\frac{B}{L} = \\frac{B_{\\max}}{K_{d}} - \\frac{B}{K_{d}},\n$$\n\n这是一条斜率为 $-\\frac{1}{K_{d}}$、截距为 $\\frac{B_{\\max}}{K_{d}}$ 的直线。当 $K_{d} = 2\\,\\mathrm{nM}$ 时，斜率为 $-\\frac{1}{2}\\,\\mathrm{nM}^{-1}$，截距为 $\\frac{500}{2} = 250\\,\\mathrm{fmol/mg/nM}$。使用计算出的 $B$ 值，我们发现\n\n$$\n\\frac{B}{L}\\bigg|_{L=0.5} = \\frac{100}{0.5} = 200,\\quad \\frac{B}{L}\\bigg|_{L=2} = \\frac{250}{2} = 125,\\quad \\frac{B}{L}\\bigg|_{L=10} \\approx \\frac{416.7}{10} \\approx 41.67,\n$$\n\n单位均为 $\\mathrm{fmol/mg/nM}$。这三个点满足线性关系 $\\frac{B}{L} = 250 - \\frac{B}{2}$，表明 Scatchard 图中没有曲率，这与单一均一类别的非协同性结合位点是一致的。\n\n根据说明，最终报告的数值答案是这三个结合量，四舍五入至四位有效数字并以 $\\mathrm{fmol/mg}$ 为单位表示。",
            "answer": "$$\\boxed{\\begin{pmatrix}100.0  250.0  416.7\\end{pmatrix}}$$"
        },
        {
            "introduction": "在许多理论分析中，我们假设游离配体浓度恒定且等于加入的总配体浓度，但这仅在配体远超量时才成立。本练习将挑战这一简化假设，引导您推导出一个考虑了配体耗尽的精确解。通过比较精确解和近似解的结果，您将量化由简化带来的误差，这对于设计有效的实验和在受体浓度不可忽略时准确解读数据至关重要。",
            "id": "3924146",
            "problem": "一个处于平衡状态的单一位点受体-配体系统由质量作用定律和质量守恒定律建模。设游离受体浓度为 $[R]$，游离配体浓度为 $[L]$，结合复合物浓度为 $[RL]$。解离常数 ($K_d$) 定义为 $K_d = \\frac{[R][L]}{[RL]}$。总受体和总配体浓度是守恒的：$R_{\\text{tot}} = [R]+[RL]$ 且 $L_{\\text{tot}} = [L]+[RL]$。\n\n仅从这些定义和守恒定律出发，推导一个平衡复合物浓度 $[RL]$ 的显式表达式，该表达式能正确地解释配体耗尽（即有限的 $L_{\\text{tot}}$）。然后，在游离配体浓度近似保持恒定并等于其总浓度（$[L]\\approx L_{\\text{tot}}$）的近似条件下，推导 $[RL]$ 的相应近似表达式。使用参数值 $R_{\\text{tot}}=20\\,\\mathrm{nM}$，$L_{\\text{tot}}=25\\,\\mathrm{nM}$ 和 $K_d=5\\,\\mathrm{nM}$，计算这两个预测值。最后，报告这两个关于 $[RL]$ 的预测值之间的绝对偏差。\n\n将您最终报告的数字四舍五入到四位有效数字。以纳摩尔浓度 $(\\mathrm{nM})$ 为单位表示最终的量。",
            "solution": "第一步是推导考虑了配体耗尽的平衡复合物浓度 $[RL]$ 的精确表达式。该系统由三个方程定义：\n解离常数 $K_d$ 的定义：\n$$K_d = \\frac{[R][L]}{[RL]}$$\n总受体浓度 $R_{\\text{tot}}$ 的守恒：\n$$R_{\\text{tot}} = [R] + [RL]$$\n总配体浓度 $L_{\\text{tot}}$ 的守恒：\n$$L_{\\text{tot}} = [L] + [RL]$$\n\n根据守恒方程，我们可以用总浓度和结合复合物浓度 $[RL]$ 来表示游离浓度 $[R]$ 和 $[L]$：\n$$[R] = R_{\\text{tot}} - [RL]$$\n$$[L] = L_{\\text{tot}} - [RL]$$\n将这些表达式代入 $K_d$ 的方程，得到：\n$$K_d = \\frac{(R_{\\text{tot}} - [RL])(L_{\\text{tot}} - [RL])}{[RL]}$$\n为了求解 $[RL]$，我们将此方程重排为标准二次型 $ax^2 + bx + c = 0$，其中变量 $x$ 是 $[RL]$。\n$$K_d [RL] = (R_{\\text{tot}} - [RL])(L_{\\text{tot}} - [RL])$$\n$$K_d [RL] = R_{\\text{tot}}L_{\\text{tot}} - R_{\\text{tot}}[RL] - L_{\\text{tot}}[RL] + [RL]^2$$\n$$0 = [RL]^2 - (R_{\\text{tot}} + L_{\\text{tot}} + K_d)[RL] + R_{\\text{tot}}L_{\\text{tot}}$$\n这是一个关于 $[RL]$ 的二次方程。我们应用二次公式来求解：\n$$[RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n对于我们的方程，$a=1$，$b = -(R_{\\text{tot}} + L_{\\text{tot}} + K_d)$，且 $c = R_{\\text{tot}}L_{\\text{tot}}$。\n$$[RL] = \\frac{(R_{\\text{tot}} + L_{\\text{tot}} + K_d) \\pm \\sqrt{(-(R_{\\text{tot}} + L_{\\text{tot}} + K_d))^2 - 4(1)(R_{\\text{tot}}L_{\\text{tot}})}}{2}$$\n$$[RL] = \\frac{(R_{\\text{tot}} + L_{\\text{tot}} + K_d) \\pm \\sqrt{(R_{\\text{tot}} + L_{\\text{tot}} + K_d)^2 - 4R_{\\text{tot}}L_{\\text{tot}}}}{2}$$\n我们必须选择物理上正确的根。复合物的浓度 $[RL]$ 不能超过受体的总浓度 $R_{\\text{tot}}$ 或配体的总浓度 $L_{\\text{tot}}$。平方根下的项总是小于 $(R_{\\text{tot}} + L_{\\text{tot}} + K_d)^2$。如果我们选择正根，分子将大于 $(R_{\\text{tot}} + L_{\\text{tot}} + K_d)$。这将导致 $[RL]$ 的值可以被证明大于 $R_{\\text{tot}}$ 和 $L_{\\text{tot}}$，这在物理上是不可能的。因此，我们必须选择负根。$[RL]$ 的精确表达式为：\n$$[RL]_{\\text{exact}} = \\frac{(R_{\\text{tot}} + L_{\\text{tot}} + K_d) - \\sqrt{(R_{\\text{tot}} + L_{\\text{tot}} + K_d)^2 - 4R_{\\text{tot}}L_{\\text{tot}}}}{2}$$\n\n接下来，我们在游离配体浓度约等于总配体浓度（即 $[L] \\approx L_{\\text{tot}}$）的条件下推导 $[RL]$ 的近似表达式。当 $L_{\\text{tot}} \\gg R_{\\text{tot}}$ 时，此近似有效。我们再次从 $K_d$ 的定义和受体守恒定律出发：\n$$K_d = \\frac{[R][L]}{[RL]}$$\n$$[R] = R_{\\text{tot}} - [RL]$$\n代入 $[R]$ 并应用 $[L]$ 的近似：\n$$K_d \\approx \\frac{(R_{\\text{tot}} - [RL])L_{\\text{tot}}}{[RL]}$$\n现在，我们求解 $[RL]$：\n$$K_d [RL] = R_{\\text{tot}}L_{\\text{tot}} - [RL]L_{\\text{tot}}$$\n$$[RL](K_d + L_{\\text{tot}}) = R_{\\text{tot}}L_{\\text{tot}}$$\n$$[RL]_{\\text{approx}} = \\frac{R_{\\text{tot}}L_{\\text{tot}}}{K_d + L_{\\text{tot}}}$$\n\n现在，我们使用给定的参数值来计算这两个表达式：$R_{\\text{tot}}=20\\,\\mathrm{nM}$，$L_{\\text{tot}}=25\\,\\mathrm{nM}$ 和 $K_d=5\\,\\mathrm{nM}$。\n对于精确解：\n$$[RL]_{\\text{exact}} = \\frac{(20 + 25 + 5) - \\sqrt{(20 + 25 + 5)^2 - 4(20)(25)}}{2} \\,\\mathrm{nM}$$\n$$[RL]_{\\text{exact}} = \\frac{50 - \\sqrt{50^2 - 2000}}{2} \\,\\mathrm{nM}$$\n$$[RL]_{\\text{exact}} = \\frac{50 - \\sqrt{2500 - 2000}}{2} \\,\\mathrm{nM}$$\n$$[RL]_{\\text{exact}} = \\frac{50 - \\sqrt{500}}{2} \\,\\mathrm{nM} = \\frac{50 - 10\\sqrt{5}}{2} \\,\\mathrm{nM} = (25 - 5\\sqrt{5}) \\,\\mathrm{nM}$$\n数值上，$[RL]_{\\text{exact}} \\approx 13.819660\\,\\mathrm{nM}$。\n\n对于近似解：\n$$[RL]_{\\text{approx}} = \\frac{(20)(25)}{5 + 25} \\,\\mathrm{nM}$$\n$$[RL]_{\\text{approx}} = \\frac{500}{30} \\,\\mathrm{nM} = \\frac{50}{3} \\,\\mathrm{nM}$$\n数值上，$[RL]_{\\text{approx}} \\approx 16.666667\\,\\mathrm{nM}$。\n\n最后，我们计算两个预测值之间的绝对偏差 $\\Delta$。\n$$\\Delta = |[RL]_{\\text{approx}} - [RL]_{\\text{exact}}|$$\n$$\\Delta = \\left| \\frac{50}{3} - (25 - 5\\sqrt{5}) \\right| \\,\\mathrm{nM}$$\n$$\\Delta \\approx |16.666667 - 13.819660| \\,\\mathrm{nM}$$\n$$\\Delta \\approx 2.847007 \\,\\mathrm{nM}$$\n四舍五入到四位有效数字，绝对偏差为 $2.847\\,\\mathrm{nM}$。",
            "answer": "$$\\boxed{2.847}$$"
        },
        {
            "introduction": "本练习将理论付诸实践，让您扮演实验科学家的角色来分析结合数据。利用Scatchard图作为线性化工具，您不仅将从数据集中估计关键参数 $K_d$ 和 $B_{\\max}$，还将通过计算置信区间来严格量化其可靠性。这项计算任务强调，任何参数估计若无其不确定性的度量便是不完整的，这是稳健科学建模和数据解读的核心原则。",
            "id": "3924117",
            "problem": "您正在为一个均质样品中的单一位点受体-配体平衡结合进行建模。在一系列平衡点上，测量了每单位质量组织的结合配体量（以$B$表示，单位为$\\mathrm{fmol}/\\mathrm{mg}$）和游离配体浓度（以$F$表示，单位为$\\mathrm{nM}$）。从化学动力学的第一性原理出发，考虑单一类型的受体$R$与配体$L$结合形成复合物$RL$，其正向速率常数为$k_{\\mathrm{on}}$，逆向速率常数为$k_{\\mathrm{off}}$。在平衡状态下，质量作用定律成立，并定义解离常数$K_d$为$K_d = \\dfrac{[R][L]}{[RL]}$，其中$[R]$是未结合受体的浓度，$[L]$是未结合配体的浓度，$[RL]$是受体-配体复合物的浓度。总受体浓度$[R_{\\mathrm{tot}}]$是守恒的，即$[R_{\\mathrm{tot}}] = [R] + [RL]$。可测量的每单位质量结合量$B$与$[RL]$成正比，可测量的游离浓度$F$与$[L]$成正比，且存在已知的比例常数将实验室单位与摩尔单位联系起来。请使用这些原理来构建$B$、$F$、$K_d$和$B_{\\max}$之间的平衡关系，其中$B_{\\max}$是当$F \\to \\infty$时每单位质量的渐近结合量。\n\n使用您推导出的平衡关系，构建Scatchard变换，并通过普通最小二乘法（OLS）对$B/F$与$B$进行线性回归。设线性拟合为$y = m x + c$，其中$x = B$，$y = B/F$。根据拟合的斜率$m$和截距$c$，计算解离常数$K_d$（单位为$\\mathrm{nM}$）和最大结合量$B_{\\max}$（单位为$\\mathrm{fmol}/\\mathrm{mg}$）。通过以下步骤计算$K_d$和$B_{\\max}$在置信水平$0.95$下的双侧置信区间来量化不确定性：\n- 在标准的同方差$y$值加性误差假设下，根据OLS拟合估计残差方差，\n- 从OLS获得$(m,c)$的协方差，\n- 使用一阶泰勒近似（delta方法）将不确定性传播到$(K_d, B_{\\max})$，\n- 使用自由度为$n-2$的学生t分布的临界值，其中$n$是数据点的数量。\n\n所有最终数值答案均以指定的物理单位表示：$K_d$单位为$\\mathrm{nM}$，$B_{\\max}$单位为$\\mathrm{fmol}/\\mathrm{mg}$。将报告的每个数字四舍五入到三位小数。每个测试用例的最终输出必须是列表$[K_d, K_{d,\\mathrm{low}}, K_{d,\\mathrm{high}}, B_{\\max}, B_{\\max,\\mathrm{low}}, B_{\\max,\\mathrm{high}}]$，其中“low”和“high”分别表示置信区间的下界和上界。\n\n测试套件：\n- 案例1（一般情况，中等噪声）：使用$F = [0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 16.0, 24.0]$（单位$\\mathrm{nM}$）和测量的$B = [65.4667, 116.3857, 174.2778, 250.1538, 299.1619, 334.2345, 343.5459, 364.0642]$（单位$\\mathrm{fmol}/\\mathrm{mg}$）。\n- 案例2（低浓度范围）：使用$F = [0.1, 0.2, 0.3, 0.4, 0.6, 0.8, 1.0, 1.2]$（单位$\\mathrm{nM}$）和测量的$B = [5.15196, 9.43538, 14.5509, 18.1685, 27.3857, 33.7828, 42.5667, 47.8871]$（单位$\\mathrm{fmol}/\\mathrm{mg}$）。\n- 案例3（几乎无噪声的参考）：使用$F = [0.5, 1.0, 2.0, 3.0, 5.0, 7.0, 10.0, 15.0]$（单位$\\mathrm{nM}$）和测量的$B = [130.4348, 214.2857, 315.7895, 375.0, 441.1765, 477.2727, 508.4746, 535.7143]$（单位$\\mathrm{fmol}/\\mathrm{mg}$）。\n- 案例4（存在异常值）：使用$F = [0.5, 1.0, 2.0, 4.0, 6.0, 9.0, 12.0, 18.0]$（单位$\\mathrm{nM}$）和测量的$B = [70.4286, 126.5, 198.0, 288.7143, 329.3333, 430.0, 400.5, 427.3714]$（单位$\\mathrm{fmol}/\\mathrm{mg}$）。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表用方括号括起来，其中的条目是与上述四个案例相对应的四个内部列表。例如，输出格式应类似于$[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，并填入精确的数值，按规定四舍五入到三位小数。",
            "solution": "该问题要求使用Scatchard图和普通最小二乘法（OLS）回归分析单一位点受体-配体结合数据，以确定解离常数（$K_d$）和最大结合容量（$B_{\\max}$），包括它们各自的置信区间。该解决方案是从化学动力学的第一性原理发展而来的。\n\n### 平衡结合关系\n配体（$L$）与单一类型受体（$R$）可逆结合形成复合物（$RL$）的过程由以下反应描述：\n$$R + L \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} RL$$\n在平衡状态下，正向和逆向反应的速率相等。质量作用定律给出了各物质浓度之间的关系，由解离常数$K_d$定义：\n$$K_d = \\frac{[R][L]}{[RL]} = \\frac{k_{\\text{off}}}{k_{\\text{on}}}$$\n其中$[R]$是游离受体的浓度，$[L]$是游离配体的浓度，$[RL]$是受体-配体复合物的浓度。\n\n总受体浓度$[R_{\\mathrm{tot}}]$是守恒的：\n$$[R_{\\mathrm{tot}}] = [R] + [RL]$$\n由此，我们可以将游离受体浓度表示为$[R] = [R_{\\mathrm{tot}}] - [RL]$。将此代入$K_d$的表达式中：\n$$K_d = \\frac{([R_{\\mathrm{tot}}] - [RL])[L]}{[RL]}$$\n我们可以重新整理这个方程来求解结合复合物的浓度$[RL]$：\n$$K_d [RL] = ([R_{\\mathrm{tot}}] - [RL])[L]$$\n$$K_d [RL] + [RL][L] = [R_{\\mathrm{tot}}][L]$$\n$$[RL](K_d + [L]) = [R_{\\mathrm{tot}}][L]$$\n$$[RL] = \\frac{[R_{\\mathrm{tot}}][L]}{K_d + [L]}$$\n这个方程描述了结合复合物浓度和游离配体浓度之间的双曲线关系。问题定义了可测量的量$B$（每单位质量的结合配体）和$F$（游离配体浓度），它们分别与$[RL]$和$[L]$成正比。最大结合容量$B_{\\max}$对应于所有受体都饱和的状态，即$[RL] = [R_{\\mathrm{tot}}]$。因此，我们可以将比例关系写为：\n$$B \\propto [RL] \\quad\\quad F \\propto [L] \\quad\\quad B_{\\max} \\propto [R_{\\mathrm{tot}}]$$\n通过将比例常数吸收到参数中，我们可以用可测量的量来表示这种关系：\n$$B = \\frac{B_{\\max} F}{K_d + F}$$\n在这里，$K_d$是以与$F$相同浓度单位（本例中为$\\mathrm{nM}$）表示的解离常数。这是单一位点结合的基本方程。\n\n### Scatchard变换与线性回归\n为了从实验数据中估计参数$K_d$和$B_{\\max}$，可以对结合方程进行线性化。Scatchard变换就是这样一种方法。我们重新整理结合方程：\n$$B(K_d + F) = B_{\\max} F$$\n$$B K_d + B F = B_{\\max} F$$\n将整个方程除以$F$得到：\n$$B \\frac{K_d}{F} + B = B_{\\max}$$\n再除以$K_d$并重新整理，得到线性形式：\n$$\\frac{B}{F} = -\\frac{1}{K_d} B + \\frac{B_{\\max}}{K_d}$$\n该方程是直线形式$y = mx + c$，其中：\n- 因变量是 $y = B/F$。\n- 自变量是 $x = B$。\n- 斜率是 $m = -1/K_d$。\n- y轴截距是 $c = B_{\\max}/K_d$。\n\n给定一组$n$个数据点$(F_i, B_i)$，我们将其转换为$(x_i, y_i) = (B_i, B_i/F_i)$，并执行普通最小二乘法（OLS）线性回归，以找到最佳拟合斜率$m$和截距$c$。根据这些拟合参数，我们可以计算出动力学参数：\n$$K_d = -\\frac{1}{m}$$\n$$B_{\\max} = c \\cdot K_d = c \\left(-\\frac{1}{m}\\right) = -\\frac{c}{m}$$\n\n### 不确定性量化与置信区间\n为了量化我们对$K_d$和$B_{\\max}$估计的不确定性，我们使用delta方法（一阶泰勒级数近似）从OLS参数$(m, c)$传播不确定性。\n\n首先，我们从OLS拟合中估计残差的方差。残差为$e_i = y_i - (m x_i + c)$。残差方差$s_e^2$是误差方差$\\sigma^2$的无偏估计量，计算公式为：\n$$s_e^2 = \\frac{1}{n-2} \\sum_{i=1}^{n} (y_i - (m x_i + c))^2$$\n分母$n-2$代表自由度，因为从数据中估计了两个参数（$m$和$c$）。\n\n接下来，我们确定OLS估计量$(m, c)$的方差-协方差矩阵。方差和协方差为：\n$$\\mathrm{Var}(m) = \\sigma_m^2 = \\frac{s_e^2}{\\sum_{i=1}^n (x_i - \\bar{x})^2}$$\n$$\\mathrm{Var}(c) = \\sigma_c^2 = s_e^2 \\left( \\frac{1}{n} + \\frac{\\bar{x}^2}{\\sum_{i=1}^n (x_i - \\bar{x})^2} \\right)$$\n$$\\mathrm{Cov}(m, c) = \\sigma_{mc} = -s_e^2 \\frac{\\bar{x}}{\\sum_{i=1}^n (x_i - \\bar{x})^2}$$\n其中$\\bar{x}$是$x_i$值的平均值。\n\n然后使用delta方法近似计算$K_d$和$B_{\\max}$的方差。对于一个通用函数$g(m, c)$，其方差为：\n$$\\mathrm{Var}(g) \\approx \\left(\\frac{\\partial g}{\\partial m}\\right)^2 \\sigma_m^2 + \\left(\\frac{\\partial g}{\\partial c}\\right)^2 \\sigma_c^2 + 2 \\left(\\frac{\\partial g}{\\partial m}\\right) \\left(\\frac{\\partial g}{\\partial c}\\right) \\sigma_{mc}$$\n\n对于$K_d(m) = -1/m$：\n偏导数为$\\frac{\\partial K_d}{\\partial m} = 1/m^2$和$\\frac{\\partial K_d}{\\partial c} = 0$。方差为：\n$$\\mathrm{Var}(K_d) \\approx \\left(\\frac{1}{m^2}\\right)^2 \\sigma_m^2 = \\frac{\\sigma_m^2}{m^4}$$\n标准误差为$SE(K_d) = \\sqrt{\\mathrm{Var}(K_d)} = |\\sigma_m / m^2|$。\n\n对于$B_{\\max}(m, c) = -c/m$：\n偏导数为$\\frac{\\partial B_{\\max}}{\\partial m} = c/m^2$和$\\frac{\\partial B_{\\max}}{\\partial c} = -1/m$。方差为：\n$$\\mathrm{Var}(B_{\\max}) \\approx \\left(\\frac{c}{m^2}\\right)^2 \\sigma_m^2 + \\left(-\\frac{1}{m}\\right)^2 \\sigma_c^2 + 2 \\left(\\frac{c}{m^2}\\right) \\left(-\\frac{1}{m}\\right) \\sigma_{mc}$$\n$$\\mathrm{Var}(B_{\\max}) \\approx \\frac{c^2}{m^4}\\sigma_m^2 + \\frac{1}{m^2}\\sigma_c^2 - \\frac{2c}{m^3}\\sigma_{mc}$$\n标准误差为$SE(B_{\\max}) = \\sqrt{\\mathrm{Var}(B_{\\max})}$。\n\n最后，使用自由度为$n-2$的学生t分布的临界值$t_{\\alpha/2, n-2}$构建置信水平为$1-\\alpha=0.95$的双侧置信区间。参数$\\theta$的置信区间由下式给出：\n$$\\theta \\pm t_{\\alpha/2, n-2} \\cdot SE(\\theta)$$\n对于$K_d$和$B_{\\max}$，$95\\%$置信区间的下界和上界为：\n$$K_{d, \\text{low}} = K_d - t_{0.025, n-2} \\cdot SE(K_d) \\quad , \\quad K_{d, \\text{high}} = K_d + t_{0.025, n-2} \\cdot SE(K_d)$$\n$$B_{\\max, \\text{low}} = B_{\\max} - t_{0.025, n-2} \\cdot SE(B_{\\max}) \\quad , \\quad B_{\\max, \\text{high}} = B_{\\max} + t_{0.025, n-2} \\cdot SE(B_{\\max})$$\n然后以$[K_d, K_{d,\\mathrm{low}}, K_{d,\\mathrm{high}}, B_{\\max}, B_{\\max,\\mathrm{low}}, B_{\\max,\\mathrm{high}}]$的格式报告结果，所有值均四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef analyze_binding(F_data, B_data):\n    \"\"\"\n    Analyzes receptor-ligand binding data using a Scatchard plot and OLS.\n\n    Args:\n        F_data (list): A list of free ligand concentrations (in nM).\n        B_data (list): A list of bound ligand per mass of tissue (in fmol/mg).\n\n    Returns:\n        list: A list containing [Kd, Kd_low, Kd_high, Bmax, Bmax_low, Bmax_high],\n              all rounded to three decimal places.\n    \"\"\"\n    F = np.array(F_data, dtype=np.float64)\n    B = np.array(B_data, dtype=np.float64)\n\n    # Scatchard transformation\n    x = B\n    y = B / F\n\n    n = len(x)\n    df = n - 2\n    \n    # Perform Ordinary Least Squares (OLS) regression\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n\n    S_xx = np.sum((x - x_mean)**2)\n    S_xy = np.sum((x - x_mean) * (y - y_mean))\n\n    # Slope (m) and intercept (c) of the Scatchard plot\n    m = S_xy / S_xx\n    c = y_mean - m * x_mean\n\n    # Check for non-physical results (positive slope)\n    if m >= 0:\n        # A positive slope in a Scatchard plot is non-physical for single-site binding.\n        # This can happen with extremely noisy or ill-behaved data.\n        # We return NaNs to indicate failure of the model fit.\n        return [np.nan] * 6\n\n    # Calculate Kd and Bmax from slope and intercept\n    Kd = -1.0 / m\n    Bmax = -c / m\n\n    # Calculate uncertainty\n    # 1. Residual variance\n    y_pred = m * x + c\n    residuals = y - y_pred\n    SSE = np.sum(residuals**2)\n    s_e_sq = SSE / df  # Residual variance (s_e^2)\n\n    # 2. Covariance of (m, c)\n    var_m = s_e_sq / S_xx\n    var_c = s_e_sq * (1/n + x_mean**2 / S_xx)\n    cov_mc = -s_e_sq * x_mean / S_xx\n\n    # 3. Propagate error to Kd and Bmax (Delta Method)\n    # Variance of Kd\n    var_Kd = (1 / m**4) * var_m\n    se_Kd = np.sqrt(var_Kd)\n\n    # Variance of Bmax\n    var_Bmax = ((c**2 / m**4) * var_m) + ((1 / m**2) * var_c) - ((2 * c / m**3) * cov_mc)\n    se_Bmax = np.sqrt(var_Bmax)\n\n    # 4. Compute confidence intervals\n    confidence_level = 0.95\n    t_crit = t.ppf((1 + confidence_level) / 2, df)\n\n    Kd_low = Kd - t_crit * se_Kd\n    Kd_high = Kd + t_crit * se_Kd\n    Bmax_low = Bmax - t_crit * se_Bmax\n    Bmax_high = Bmax + t_crit * se_Bmax\n\n    return [Kd, Kd_low, Kd_high, Bmax, Bmax_low, Bmax_high]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        (\n            [0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 16.0, 24.0],\n            [65.4667, 116.3857, 174.2778, 250.1538, 299.1619, 334.2345, 343.5459, 364.0642]\n        ),\n        # Case 2\n        (\n            [0.1, 0.2, 0.3, 0.4, 0.6, 0.8, 1.0, 1.2],\n            [5.15196, 9.43538, 14.5509, 18.1685, 27.3857, 33.7828, 42.5667, 47.8871]\n        ),\n        # Case 3\n        (\n            [0.5, 1.0, 2.0, 3.0, 5.0, 7.0, 10.0, 15.0],\n            [130.4348, 214.2857, 315.7895, 375.0, 441.1765, 477.2727, 508.4746, 535.7143]\n        ),\n        # Case 4\n        (\n            [0.5, 1.0, 2.0, 4.0, 6.0, 9.0, 12.0, 18.0],\n            [70.4286, 126.5, 198.0, 288.7143, 329.3333, 430.0, 400.5, 427.3714]\n        )\n    ]\n\n    # Process each case and format for final output\n    final_results = []\n    for F_data, B_data in test_cases:\n        result_list = analyze_binding(F_data, B_data)\n        inner_str = f\"[{','.join([f'{x:.3f}' for x in result_list])}]\"\n        final_results.append(inner_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```"
        }
    ]
}