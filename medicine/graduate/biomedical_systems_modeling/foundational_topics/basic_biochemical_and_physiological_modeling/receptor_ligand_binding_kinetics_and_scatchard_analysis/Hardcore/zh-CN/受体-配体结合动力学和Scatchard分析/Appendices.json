{
    "hands_on_practices": [
        {
            "introduction": "虽然平衡解离常数 $K_d$ 是表征受体-配体亲和力的核心参数，但深入理解其背后的动力学过程——即结合速率常数（$k_{\\mathrm{on}}$）和解离速率常数（$k_{\\mathrm{off}}$）——对于揭示相互作用的动态特性至关重要。本练习将指导您如何通过分析在不同配体浓度下测得的表观结合速率常数（$k_{\\mathrm{obs}}$），来估算这些基本的动力学参数。通过这个过程，您将学习如何将宏观可测量的速率与微观动力学常数联系起来，这是生物物理研究中的一项基本技能 。",
            "id": "3924124",
            "problem": "在充分混合的条件下，一个膜受体与一个可溶性配体发生可逆结合。假设配体库很大，因此在结合阶段，游离配体浓度 $L$ 保持有效恒定。设 $B(t)$ 表示受体-配体复合物的浓度，$R_{\\mathrm{T}}$ 表示细胞表面的总受体浓度。该结合遵循基元质量作用动力学，结合速率常数为 $k_{\\mathrm{on}}$，解离速率常数为 $k_{\\mathrm{off}}$。在一系列结合实验中，对 $B(t)$ 进行单指数拟合，得到在三个配体浓度下的观测结合速率常数：当 $L=1\\,\\mathrm{nM}$ 时，$k_{\\mathrm{obs}}=0.03\\,\\mathrm{s^{-1}}$；当 $L=2\\,\\mathrm{nM}$ 时，$k_{\\mathrm{obs}}=0.05\\,\\mathrm{s^{-1}}$；当 $L=5\\,\\mathrm{nM}$ 时，$k_{\\mathrm{obs}}=0.12\\,\\mathrm{s^{-1}}$。\n\n从 $B(t)$ 的质量作用描述出发，在伪一级假设下，推导观测结合速率常数对 $L$ 的依赖关系。然后，使用对三个数据点 $\\{(L, k_{\\mathrm{obs}})\\}$ 的未加权最小二乘线性拟合，估计 $k_{\\mathrm{on}}$ 和 $k_{\\mathrm{off}}$。最后，计算这些动力学参数所隐含的解离常数（记为解离常数 $(K_d)$）。\n\n报告 $k_{\\mathrm{on}}$（单位为 $\\mathrm{M^{-1}\\,s^{-1}}$）、$k_{\\mathrm{off}}$（单位为 $\\mathrm{s^{-1}}$）和 $K_d$（单位为 $\\mathrm{nM}$）。将每个报告的数值四舍五入到四位有效数字。最终答案必须是一个单行矩阵，按 $k_{\\mathrm{on}}$、$k_{\\mathrm{off}}$、$K_d$ 的顺序包含这三个数字。",
            "solution": "用户要求验证问题陈述的有效性，如果问题有效，则提供完整解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   $B(t)$: 受体-配体复合物的浓度。\n*   $R_{\\mathrm{T}}$: 总受体浓度。\n*   $L$: 游离配体浓度，假定为常数。\n*   $k_{\\mathrm{on}}$: 结合速率常数。\n*   $k_{\\mathrm{off}}$: 解离速率常数。\n*   $K_d$: 解离常数。\n*   数据点 1: $L_1 = 1\\,\\mathrm{nM}$, $k_{\\mathrm{obs},1} = 0.03\\,\\mathrm{s^{-1}}$。\n*   数据点 2: $L_2 = 2\\,\\mathrm{nM}$, $k_{\\mathrm{obs},2} = 0.05\\,\\mathrm{s^{-1}}$。\n*   数据点 3: $L_3 = 5\\,\\mathrm{nM}$, $k_{\\mathrm{obs},3} = 0.12\\,\\mathrm{s^{-1}}$。\n*   任务：\n    1.  推导观测结合速率常数 $k_{\\mathrm{obs}}$ 对 $L$ 的依赖关系。\n    2.  使用未加权最小二乘线性拟合估计 $k_{\\mathrm{on}}$ 和 $k_{\\mathrm{off}}$。\n    3.  计算解离常数 $K_d$。\n    4.  报告 $k_{\\mathrm{on}}$（单位为 $\\mathrm{M^{-1}\\,s^{-1}}$）、$k_{\\mathrm{off}}$（单位为 $\\mathrm{s^{-1}}$）和 $K_d$（单位为 $\\mathrm{nM}$）。\n    5.  将最终答案四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学上合理**：该问题使用质量作用定律描述受体-配体结合动力学，这是化学和生物动力学的基本原理。伪一级近似（$L$ 恒定）是一种标准的实验和分析技术。该问题牢固地植根于成熟的生物物理化学。\n*   **适定性**：该问题是适定的。它提供了足够的数据（3个点）来确定线性模型的两个参数（$k_{\\mathrm{on}}$ 和 $k_{\\mathrm{off}}$）。它明确了要使用的方法（未加权最小二乘线性拟合）以及所需的输出格式和单位。存在唯一解。\n*   **客观性**：语言技术性强、精确，没有主观或含糊的术语。\n\n该问题没有表现出验证清单中列出的任何缺陷（科学上不合理、非形式化、设置不完整、不切实际、病态、伪深刻或无法验证）。数据值对于此类实验在物理上是合理的。\n\n**步骤3：结论与行动**\n\n此问题**有效**。将提供完整解答。\n\n### 解答\n\n第一步是推导观测到的结合速率常数 $k_{\\mathrm{obs}}$ 与配体浓度 $L$ 之间的关系。结合反应如下：\n$$ R + L \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} B $$\n其中 $R$ 是游离受体的浓度，$L$ 是游离配体的浓度，$B$ 是受体-配体复合物的浓度。在任意时间 $t$，游离受体的浓度为 $R(t) = R_{\\mathrm{T}} - B(t)$，其中 $R_{\\mathrm{T}}$ 是总受体浓度。\n\n根据质量作用定律，复合物 $B(t)$ 的形成速率为：\n$$ \\frac{dB}{dt} = k_{\\mathrm{on}} R(t) L - k_{\\mathrm{off}} B(t) $$\n将 $R(t) = R_{\\mathrm{T}} - B(t)$ 代入方程得：\n$$ \\frac{dB}{dt} = k_{\\mathrm{on}} (R_{\\mathrm{T}} - B(t)) L - k_{\\mathrm{off}} B(t) $$\n问题陈述 $L$ 是常数（伪一级条件）。我们可以通过对含 $B(t)$ 的项进行分组来重新整理方程：\n$$ \\frac{dB}{dt} = k_{\\mathrm{on}} L R_{\\mathrm{T}} - k_{\\mathrm{on}} L B(t) - k_{\\mathrm{off}} B(t) $$\n$$ \\frac{dB}{dt} = k_{\\mathrm{on}} L R_{\\mathrm{T}} - (k_{\\mathrm{on}} L + k_{\\mathrm{off}}) B(t) $$\n这是一个关于 $B(t)$ 的一阶线性常微分方程。假设初始条件为 $B(0)=0$（结合实验开始时没有复合物），该方程的解是指数上升至最大值：\n$$ B(t) = B_{\\mathrm{eq}} (1 - \\exp(-k_{\\mathrm{obs}} t)) $$\n通过将微分方程与解的形式进行比较，观测速率常数 $k_{\\mathrm{obs}}$ 被确定为 $B(t)$ 项的系数。\n$$ k_{\\mathrm{obs}} = k_{\\mathrm{on}} L + k_{\\mathrm{off}} $$\n这个推导出的方程表明 $k_{\\mathrm{obs}}$ 是配体浓度 $L$ 的线性函数。该关系呈直线形式 $y = mx + c$，其中 $y = k_{\\mathrm{obs}}$，$x = L$，斜率 $m = k_{\\mathrm{on}}$，y轴截距 $c = k_{\\mathrm{off}}$。\n\n接下来，我们对所提供的数据进行未加权最小二乘线性拟合，以估计 $k_{\\mathrm{on}}$ 和 $k_{\\mathrm{off}}$。数据点为 $(L_i, k_{\\mathrm{obs},i})$: $(1\\,\\mathrm{nM}, 0.03\\,\\mathrm{s^{-1}})$，$(2\\,\\mathrm{nM}, 0.05\\,\\mathrm{s^{-1}})$ 和 $(5\\,\\mathrm{nM}, 0.12\\,\\mathrm{s^{-1}})$。为了计算，我们设 $x_i$ 为 $L$ 的值（单位为 $\\mathrm{nM}$），$y_i$ 为 $k_{\\mathrm{obs}}$ 的值（单位为 $\\mathrm{s^{-1}}$）。\n数据点数量为 $n=3$。我们计算所需的总和：\n$$ \\sum_{i=1}^{3} x_i = 1 + 2 + 5 = 8 $$\n$$ \\sum_{i=1}^{3} y_i = 0.03 + 0.05 + 0.12 = 0.20 $$\n$$ \\sum_{i=1}^{3} x_i^2 = 1^2 + 2^2 + 5^2 = 1 + 4 + 25 = 30 $$\n$$ \\sum_{i=1}^{3} x_i y_i = (1)(0.03) + (2)(0.05) + (5)(0.12) = 0.03 + 0.10 + 0.60 = 0.73 $$\n\n最佳拟合线的斜率 $m$ 和y轴截距 $c$ 计算如下：\n$$ m = \\frac{n \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{n \\sum(x_i^2) - (\\sum x_i)^2} $$\n$$ c = \\bar{y} - m\\bar{x} = \\frac{\\sum y_i}{n} - m\\frac{\\sum x_i}{n} $$\n\n根据我们的数据：\n$$ m = k_{\\mathrm{on}} = \\frac{3(0.73) - (8)(0.20)}{3(30) - (8)^2} = \\frac{2.19 - 1.60}{90 - 64} = \\frac{0.59}{26} \\approx 0.0226923\\,\\mathrm{nM^{-1}\\,s^{-1}} $$\n$$ c = k_{\\mathrm{off}} = \\frac{0.20}{3} - \\left(\\frac{0.59}{26}\\right)\\frac{8}{3} = \\frac{1}{3}\\left(0.20 - \\frac{4.72}{26}\\right) = \\frac{1}{3}\\left(\\frac{5.2 - 4.72}{26}\\right) = \\frac{0.48}{78} = \\frac{0.16}{26} \\approx 0.0061538\\,\\mathrm{s^{-1}} $$\n\n问题要求 $k_{\\mathrm{on}}$ 的单位为 $\\mathrm{M^{-1}\\,s^{-1}}$。我们必须从 $\\mathrm{nM^{-1}\\,s^{-1}}$ 进行转换。由于 $1\\,\\mathrm{nM} = 10^{-9}\\,\\mathrm{M}$，因此 $1\\,\\mathrm{nM^{-1}} = 10^9\\,\\mathrm{M^{-1}}$。\n$$ k_{\\mathrm{on}} = \\frac{0.59}{26}\\,\\mathrm{nM^{-1}\\,s^{-1}} = \\frac{0.59}{26} \\times 10^9\\,\\mathrm{M^{-1}\\,s^{-1}} \\approx 2.26923 \\times 10^7\\,\\mathrm{M^{-1}\\,s^{-1}} $$\n四舍五入到四位有效数字，$k_{\\mathrm{on}} = 2.269 \\times 10^7\\,\\mathrm{M^{-1}\\,s^{-1}}$。\n\n解离速率常数为 $k_{\\mathrm{off}} = c \\approx 0.0061538\\,\\mathrm{s^{-1}}$。单位已正确。四舍五入到四位有效数字，得到 $k_{\\mathrm{off}} = 0.006154\\,\\mathrm{s^{-1}}$。\n\n最后，我们计算解离常数 $K_d$，它被定义为解离速率常数与结合速率常数的比值：\n$$ K_d = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}} $$\n为了得到单位为 $\\mathrm{nM}$ 的 $K_d$，我们使用单位为 $\\mathrm{nM^{-1}\\,s^{-1}}$ 的 $k_{\\mathrm{on}}$ 和单位为 $\\mathrm{s^{-1}}$ 的 $k_{\\mathrm{off}}$。为确保精度，使用精确的分数形式：\n$$ K_d = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}} = \\frac{0.16/26\\,\\mathrm{s^{-1}}}{0.59/26\\,\\mathrm{nM^{-1}\\,s^{-1}}} = \\frac{0.16}{0.59}\\,\\mathrm{nM} \\approx 0.271186\\,\\mathrm{nM} $$\n四舍五入到四位有效数字，$K_d = 0.2712\\,\\mathrm{nM}$。\n\n估计的参数为：\n$k_{\\mathrm{on}} = 2.269 \\times 10^7\\,\\mathrm{M^{-1}\\,s^{-1}}$\n$k_{\\mathrm{off}} = 0.006154\\,\\mathrm{s^{-1}}$\n$K_d = 0.2712\\,\\mathrm{nM}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.269 \\times 10^{7}  0.006154  0.2712 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在从动力学转向平衡态分析后，一个核心目标是从饱和结合实验数据中确定两个关键的平衡参数：解离常数（$K_d$）和最大结合容量（$B_{\\max}$）。本练习将引导您完成经典的Scatchard分析流程，这是一种将双曲线结合曲线线性化的常用方法。更重要的是，本练习超越了简单的点估计，引入了一套完整的统计学方法来计算这些参数的置信区间，这对于严谨地报告和解释实验结果至关重要 。",
            "id": "3924117",
            "problem": "您正在一个均质样本中对平衡状态下的单一位点受体-配体结合进行建模。在一系列平衡点上，测量了每单位质量组织的结合配体量（记为 $B$，单位为 $\\mathrm{fmol}/\\mathrm{mg}$）和游离配体浓度（记为 $F$，单位为 $\\mathrm{nM}$）。从化学动力学的第一性原理出发，考虑单一类型的受体 $R$ 与配体 $L$ 结合形成复合物 $RL$，其正向速率常数为 $k_{\\mathrm{on}}$，逆向速率常数为 $k_{\\mathrm{off}}$。在平衡状态下，质量作用定律成立，并定义解离常数 $K_d$ 为 $K_d = \\dfrac{[R][L]}{[RL]}$，其中 $[R]$ 是未结合受体的浓度，$[L]$ 是未结合配体的浓度，$[RL]$ 是受体-配体复合物的浓度。总受体浓度 $[R_{\\mathrm{tot}}]$ 是守恒的，即 $[R_{\\mathrm{tot}}] = [R] + [RL]$。可测量的每单位质量结合量 $B$ 与 $[RL]$ 成正比，可测量的游离浓度 $F$ 与 $[L]$ 成正比，并且存在已知的比例关系将实验室单位与摩尔单位联系起来。利用这些原理，构建 $B$、$F$、$K_d$ 和 $B_{\\max}$ 之间的平衡关系式，其中 $B_{\\max}$ 是当 $F \\to \\infty$ 时每单位质量的渐近结合量。\n\n使用您推导出的平衡关系式，构建 Scatchard 变换，并通过普通最小二乘法 (OLS) 对 $B/F$ 与 $B$ 进行线性回归。设线性拟合为 $y = m x + c$，其中 $x = B$ 且 $y = B/F$。根据拟合的斜率 $m$ 和截距 $c$，计算解离常数 $K_d$（单位为 $\\mathrm{nM}$）和最大结合量 $B_{\\max}$（单位为 $\\mathrm{fmol}/\\mathrm{mg}$）。通过以下步骤计算 $K_d$ 和 $B_{\\max}$ 在置信水平 $0.95$ 下的双侧置信区间来量化不确定性：\n- 在标准的同方差 $y$ 值附加误差假设下，根据 OLS 拟合估计残差方差，\n- 从 OLS 中获得 $(m,c)$ 的协方差，\n- 使用一阶泰勒近似（delta 方法）将不确定性传播到 $(K_d, B_{\\max})$，\n- 使用自由度为 $n-2$ 的 Student's $t$ 分布的临界值，其中 $n$ 是数据点的数量。\n\n所有最终数值答案均需使用指定的物理单位表示：$K_d$ 的单位为 $\\mathrm{nM}$，$B_{\\max}$ 的单位为 $\\mathrm{fmol}/\\mathrm{mg}$。将每个报告的数字四舍五入到三位小数。每个测试用例的最终输出必须是列表 $[K_d, K_{d,\\mathrm{low}}, K_{d,\\mathrm{high}}, B_{\\max}, B_{\\max,\\mathrm{low}}, B_{\\max,\\mathrm{high}}]$，其中“low”和“high”分别表示置信区间的下界和上界。\n\n测试套件：\n- 用例 $1$（通用，中等噪声）：使用 $F = [0.5, 1, 2, 4, 8, 12, 16, 24]$（单位 $\\mathrm{nM}$）和测得的 $B = [65.4667, 116.3857, 174.2778, 250.1538, 299.1619, 334.2345, 343.5459, 364.0642]$（单位 $\\mathrm{fmol}/\\mathrm{mg}$）。\n- 用例 $2$（低浓度区间）：使用 $F = [0.1, 0.2, 0.3, 0.4, 0.6, 0.8, 1.0, 1.2]$（单位 $\\mathrm{nM}$）和测得的 $B = [5.15196, 9.43538, 14.5509, 18.1685, 27.3857, 33.7828, 42.5667, 47.8871]$（单位 $\\mathrm{fmol}/\\mathrm{mg}$）。\n- 用例 $3$（近无噪声参考）：使用 $F = [0.5, 1, 2, 3, 5, 7, 10, 15]$（单位 $\\mathrm{nM}$）和测得的 $B = [130.4348, 214.2857, 315.7895, 375.0, 441.1765, 477.2727, 508.4746, 535.7143]$（单位 $\\mathrm{fmol}/\\mathrm{mg}$）。\n- 用例 $4$（存在离群值）：使用 $F = [0.5, 1, 2, 4, 6, 9, 12, 18]$（单位 $\\mathrm{nM}$）和测得的 $B = [70.4286, 126.5, 198.0, 288.7143, 329.3333, 430.0, 400.5, 427.3714]$（单位 $\\mathrm{fmol}/\\mathrm{mg}$）。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果，其中条目是与上述四个用例相对应的四个内部列表，并按顺序排列。例如，输出格式应类似于 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$，并按规定填入精确的数值并四舍五入到三位小数。",
            "solution": "该问题要求使用 Scatchard 图和普通最小二乘法 (OLS) 回归分析单一位点受体-配体结合数据，以确定解离常数 ($K_d$) 和最大结合容量 ($B_{\\max}$)，包括它们各自的置信区间。解决方案是从化学动力学的第一性原理推导出来的。\n\n### 平衡结合关系\n配体 ($L$) 与单一类型受体 ($R$) 可逆结合形成复合物 ($RL$) 的反应过程如下：\n$$R + L \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} RL$$\n在平衡状态下，正向和逆向反应的速率相等。质量作用定律给出了由解离常数 $K_d$ 定义的各物质浓度之间的关系：\n$$K_d = \\frac{[R][L]}{[RL]} = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}}$$\n其中 $[R]$ 是游离受体的浓度，$[L]$ 是游离配体的浓度，$[RL]$ 是受体-配体复合物的浓度。\n\n总受体浓度 $[R_{\\mathrm{tot}}]$ 是守恒的：\n$$[R_{\\mathrm{tot}}] = [R] + [RL]$$\n由此，我们可以将游离受体浓度表示为 $[R] = [R_{\\mathrm{tot}}] - [RL]$。将其代入 $K_d$ 的表达式中：\n$$K_d = \\frac{([R_{\\mathrm{tot}}] - [RL])[L]}{[RL]}$$\n我们可以重排此方程以求解结合复合物的浓度 $[RL]$：\n$$K_d [RL] = ([R_{\\mathrm{tot}}] - [RL])[L]$$\n$$K_d [RL] + [RL][L] = [R_{\\mathrm{tot}}][L]$$\n$$[RL](K_d + [L]) = [R_{\\mathrm{tot}}][L]$$\n$$[RL] = \\frac{[R_{\\mathrm{tot}}][L]}{K_d + [L]}$$\n该方程描述了结合复合物浓度与游离配体浓度之间的双曲线关系。问题定义了可测量的量 $B$（每单位质量的结合配体）和 $F$（游离配体浓度），它们分别与 $[RL]$ 和 $[L]$ 成正比。最大结合容量 $B_{\\max}$ 对应于所有受体都饱和的状态，即 $[RL] = [R_{\\mathrm{tot}}]$。因此，我们可以将比例关系写为：\n$$B \\propto [RL] \\quad\\quad F \\propto [L] \\quad\\quad B_{\\max} \\propto [R_{\\mathrm{tot}}]$$\n通过将比例常数吸收到参数中，我们可以用可测量的量来表示这种关系：\n$$B = \\frac{B_{\\max} F}{K_d + F}$$\n这里，$K_d$ 是以与 $F$ 相同的浓度单位（本例中为 $\\mathrm{nM}$）表示的解离常数。这是单一位点结合的基本方程。\n\n### Scatchard 变换与线性回归\n为了从实验数据中估计参数 $K_d$ 和 $B_{\\max}$，可以对结合方程进行线性化。Scatchard 变换就是这样一种方法。我们重排结合方程：\n$$B(K_d + F) = B_{\\max} F$$\n$$B K_d + B F = B_{\\max} F$$\n将整个方程除以 $F$ 得：\n$$B \\frac{K_d}{F} + B = B_{\\max}$$\n除以 $K_d$ 并重排，得到线性形式：\n$$\\frac{B}{F} = -\\frac{1}{K_d} B + \\frac{B_{\\max}}{K_d}$$\n该方程是直线形式 $y = mx + c$，其中：\n- 因变量为 $y = B/F$。\n- 自变量为 $x = B$。\n- 斜率为 $m = -1/K_d$。\n- y 轴截距为 $c = B_{\\max}/K_d$。\n\n给定一组 $n$ 个数据点 $(F_i, B_i)$，我们将其转换为 $(x_i, y_i) = (B_i, B_i/F_i)$，并执行普通最小二乘法 (OLS) 线性回归，以找到最佳拟合斜率 $m$ 和截距 $c$。根据这些拟合参数，我们可以计算出动力学参数：\n$$K_d = -\\frac{1}{m}$$\n$$B_{\\max} = c \\cdot K_d = c \\left(-\\frac{1}{m}\\right) = -\\frac{c}{m}$$\n\n### 不确定性量化与置信区间\n为了量化我们对 $K_d$ 和 $B_{\\max}$ 估计的不确定性，我们使用 delta 方法（一阶泰勒级数近似）从 OLS 参数 $(m, c)$ 传播不确定性。\n\n首先，我们估计 OLS 拟合的残差方差。残差为 $e_i = y_i - (m x_i + c)$。残差方差 $s_e^2$ 是误差方差 $\\sigma^2$ 的无偏估计量，计算公式如下：\n$$s_e^2 = \\frac{1}{n-2} \\sum_{i=1}^{n} (y_i - (m x_i + c))^2$$\n分母 $n-2$ 代表自由度，因为从数据中估计了两个参数（$m$ 和 $c$）。\n\n接下来，我们确定 OLS 估计量 $(m, c)$ 的方差-协方差矩阵。方差和协方差为：\n$$\\mathrm{Var}(m) = \\sigma_m^2 = \\frac{s_e^2}{\\sum_{i=1}^n (x_i - \\bar{x})^2}$$\n$$\\mathrm{Var}(c) = \\sigma_c^2 = s_e^2 \\left( \\frac{1}{n} + \\frac{\\bar{x}^2}{\\sum_{i=1}^n (x_i - \\bar{x})^2} \\right)$$\n$$\\mathrm{Cov}(m, c) = \\sigma_{mc} = -s_e^2 \\frac{\\bar{x}}{\\sum_{i=1}^n (x_i - \\bar{x})^2}$$\n其中 $\\bar{x}$ 是 $x_i$ 值的平均值。\n\n$K_d$ 和 $B_{\\max}$ 的方差随后使用 delta 方法进行近似。对于一个通用函数 $g(m, c)$，其方差为：\n$$\\mathrm{Var}(g) \\approx \\left(\\frac{\\partial g}{\\partial m}\\right)^2 \\sigma_m^2 + \\left(\\frac{\\partial g}{\\partial c}\\right)^2 \\sigma_c^2 + 2 \\left(\\frac{\\partial g}{\\partial m}\\right) \\left(\\frac{\\partial g}{\\partial c}\\right) \\sigma_{mc}$$\n\n对于 $K_d(m) = -1/m$：\n偏导数为 $\\frac{\\partial K_d}{\\partial m} = 1/m^2$ 和 $\\frac{\\partial K_d}{\\partial c} = 0$。方差为：\n$$\\mathrm{Var}(K_d) \\approx \\left(\\frac{1}{m^2}\\right)^2 \\sigma_m^2 = \\frac{\\sigma_m^2}{m^4}$$\n标准误为 $SE(K_d) = \\sqrt{\\mathrm{Var}(K_d)} = |\\sigma_m / m^2|$。\n\n对于 $B_{\\max}(m, c) = -c/m$：\n偏导数为 $\\frac{\\partial B_{\\max}}{\\partial m} = c/m^2$ 和 $\\frac{\\partial B_{\\max}}{\\partial c} = -1/m$。方差为：\n$$\\mathrm{Var}(B_{\\max}) \\approx \\left(\\frac{c}{m^2}\\right)^2 \\sigma_m^2 + \\left(-\\frac{1}{m}\\right)^2 \\sigma_c^2 + 2 \\left(\\frac{c}{m^2}\\right) \\left(-\\frac{1}{m}\\right) \\sigma_{mc}$$\n$$\\mathrm{Var}(B_{\\max}) \\approx \\frac{c^2}{m^4}\\sigma_m^2 + \\frac{1}{m^2}\\sigma_c^2 - \\frac{2c}{m^3}\\sigma_{mc}$$\n标准误为 $SE(B_{\\max}) = \\sqrt{\\mathrm{Var}(B_{\\max})}$。\n\n最后，使用自由度为 $n-2$ 的 Student's $t$ 分布的临界值 $t_{\\alpha/2, n-2}$ 构建置信水平为 $1-\\alpha=0.95$ 的双侧置信区间。参数 $\\theta$ 的置信区间由下式给出：\n$$\\theta \\pm t_{\\alpha/2, n-2} \\cdot SE(\\theta)$$\n对于 $K_d$ 和 $B_{\\max}$，$95\\%$ 置信区间的下界和上界为：\n$$K_{d, \\text{low}} = K_d - t_{0.025, n-2} \\cdot SE(K_d) \\quad , \\quad K_{d, \\text{high}} = K_d + t_{0.025, n-2} \\cdot SE(K_d)$$\n$$B_{\\max, \\text{low}} = B_{\\max} - t_{0.025, n-2} \\cdot SE(B_{\\max}) \\quad , \\quad B_{\\max, \\text{high}} = B_{\\max} + t_{0.025, n-2} \\cdot SE(B_{\\max})$$\n然后以 $[K_d, K_{d,\\mathrm{low}}, K_{d,\\mathrm{high}}, B_{\\max}, B_{\\max,\\mathrm{low}}, B_{\\max,\\mathrm{high}}]$ 的格式报告结果，所有数值四舍五入到三位小数。",
            "answer": "[[4.996,3.136,6.857,400.180,361.309,439.052],[1.996,1.442,2.549,99.932,87.697,112.167],[4.000,4.000,4.000,600.000,600.000,600.000],[5.932,2.698,9.166,497.025,414.280,579.770]]"
        },
        {
            "introduction": "在真实世界的实验中，原始数据很少是完美的，常常会受到各种伪影的干扰，其中非特异性结合是一个常见问题。如果处理不当，非特异性结合会扭曲数据，导致对亲和力和结合容量的错误估计。本计算练习模拟了这一情景，让您通过编程来主动观察对非特异性结合的校正不足或过度校正，会如何系统性地影响 $K_D$ 和 $B_{\\max}$ 的估算结果。这项实践旨在培养您对数据质量和分析模型中隐含假设的批判性思维能力 。",
            "id": "3924137",
            "problem": "您将处理一个受体-配体结合动力学和 Scatchard 分析领域的建模任务。在具有单一受体类别的平衡结合测定中，观测到的总结合量包括特异性结合和非特异性结合两部分。在此问题中，您必须从受体和配体可逆结合的质量作用定律出发，推导出构建 Scatchard 图以及校正非特异性结合所需的关系式。然后，实现这些关系式，以演示减去非特异性项的效果，并量化当非特异性斜率被错误估计时产生的残余偏差。\n\n起点和定义：\n- 受体 $R$ 与配体 $L$ 结合形成复合物 $RL$，其正向速率常数为 $k_{\\mathrm{on}}$，逆向速率常数为 $k_{\\mathrm{off}}$。在平衡状态下，已结合的受体浓度 $B$（特异性结合）和游离配体浓度 $F$ 满足质量作用定律。将解离常数 $K_{\\mathrm{D}}$ 定义为 $K_{\\mathrm{D}} = k_{\\mathrm{off}} / k_{\\mathrm{on}}$，并将总受体浓度（结合容量）$B_{\\max}$ 定义为最大可能结合浓度。\n- 观测到的总结合量 $B_{\\mathrm{T}}$ 包括非特异性结合，该结合被建模为一个线性项 $\\alpha F$，其中 $\\alpha$ 是非特异性斜率。因此，$B_{\\mathrm{T}} = B + \\alpha F$。\n- Scatchard 图由数据对 $\\left(B/F, B\\right)$ 构建。\n\n任务：\n1. 仅使用平衡状态下的质量作用定律和上述定义，推导出所需函数关系以：\n   - 将 $B$ 表示为 $F$、$B_{\\max}$ 和 $K_{\\mathrm{D}}$ 的函数。\n   - 展示非特异性结合如何改变可观测量 $B_{\\mathrm{T}}$ 并影响 Scatchard 图 $\\left(B_{\\mathrm{T}}/F, B_{\\mathrm{T}}\\right)$。\n   - 展示减去一个估计值 $\\alpha_{\\mathrm{est}} F$ 以形成 $B_{\\mathrm{corr}} = B_{\\mathrm{T}} - \\alpha_{\\mathrm{est}} F$ 如何影响 Scatchard 图 $\\left(B_{\\mathrm{corr}}/F, B_{\\mathrm{corr}}\\right)$。\n2. 实现一个程序，该程序：\n   - 使用推导出的关系式，在指定的 $F$ 值范围内生成 $\\left(F, B_{\\mathrm{T}}\\right)$ 的合成数据集（假设 $F$ 是实验控制的游离配体浓度）。\n   - 对于三种情况：$\\alpha_{\\mathrm{est}} = \\alpha$、$\\alpha_{\\mathrm{est}} = (1 - 0.1)\\alpha$ 和 $\\alpha_{\\mathrm{est}} = (1 + 0.1)\\alpha$，使用校正后的结合量 $B_{\\mathrm{corr}} = B_{\\mathrm{T}} - \\alpha_{\\mathrm{est}} F$ 构建 Scatchard 数据。\n   - 使用最小二乘法对 $\\left(B_{\\mathrm{corr}}/F\\right)$ 与 $B_{\\mathrm{corr}}$ 的关系进行直线拟合，并从拟合的直线参数中提取估计的 $B_{\\max}$ 和 $K_{\\mathrm{D}}$。\n   - 当 $\\alpha_{\\mathrm{est}}$ 与真实值 $\\alpha$ 相差 $\\pm 0.1 \\alpha$ 时，计算估计值中的残余偏差，并以小数形式报告相对误差（对于数量 $Q$，输出 $(\\widehat{Q} - Q)/Q$）。\n\n单位和输出要求：\n- 浓度 $F$、$B$、$B_{\\mathrm{T}}$、$B_{\\mathrm{corr}}$、$B_{\\max}$ 和 $K_{\\mathrm{D}}$ 必须统一以纳摩尔（nM）为单位处理。您的程序必须以纳摩尔（nM）为单位输出 $B_{\\max}$ 和 $K_{\\mathrm{D}}$，并将偏差度量以小数形式输出（不带百分号）。\n- 对于每个测试用例，您的程序必须按以下顺序输出一个包含 6 个浮点数的列表：\n  1. 使用 $\\alpha_{\\mathrm{est}} = \\alpha$ 时的 $\\widehat{B}_{\\max}$，\n  2. 使用 $\\alpha_{\\mathrm{est}} = \\alpha$ 时的 $\\widehat{K}_{\\mathrm{D}}$，\n  3. 当 $\\alpha_{\\mathrm{est}} = (1 - 0.1)\\alpha$ 时 $B_{\\max}$ 的相对误差，\n  4. 当 $\\alpha_{\\mathrm{est}} = (1 - 0.1)\\alpha$ 时 $K_{\\mathrm{D}}$ 的相对误差，\n  5. 当 $\\alpha_{\\mathrm{est}} = (1 + 0.1)\\alpha$ 时 $B_{\\max}$ 的相对误差，\n  6. 当 $\\alpha_{\\mathrm{est}} = (1 + 0.1)\\alpha$ 时 $K_{\\mathrm{D}}$ 的相对误差。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的列表的列表，列表之间用逗号分隔（例如：\"[[a,b,c,d,e,f],[...],...]\"），不含空格。\n\n测试套件：\n使用以下参数集来测试不同的机制和边界情况。对于每种情况，使用对数间距和指定的点数，在所述范围内生成游离配体浓度 $F$ 的网格。\n- 情况 1（一般情况）：$B_{\\max} = 100$ nM, $K_{\\mathrm{D}} = 10$ nM, $\\alpha = 0.05$, $F \\in [0.1, 100]$ nM, $30$ 点。\n- 情况 2（边界情况，非特异性可忽略）：$B_{\\max} = 30$ nM, $K_{\\mathrm{D}} = 1$ nM, $\\alpha = 0.0$, $F \\in [0.1, 100]$ nM, $30$ 点。\n- 情况 3（高非特异性和低容量）：$B_{\\max} = 10$ nM, $K_{\\mathrm{D}} = 50$ nM, $\\alpha = 0.1$, $F \\in [0.1, 200]$ nM, $30$ 点。\n\n最终输出格式：\n- 您的程序必须打印单行，其中包含一个顶级列表，该列表包含三个子列表（每个子列表对应一种情况），并严格按照上述情况的顺序排列。每个子列表必须包含所描述的六个浮点数结果，格式化为无空格，例如：\"[[x1,x2,x3,x4,x5,x6],[y1,y2,y3,y4,y5,y6],[z1,z2,z3,z4,z5,z6]]\"。",
            "solution": "用户提供了一个基于生物化学动力学原理的有效问题陈述。任务是推导控制受体-配体结合（包括非特异性效应）的方程，然后实现一个计算模型，以量化因未正确处理这种非特异性结合而导致的参数估计偏差。该问题定义明确，科学上合理，并提供了所有必要的信息。\n\n### 第1部分：理论推导\n\n该问题要求从可逆双分子反应的质量作用定律开始进行推导。\n\n**1. 特异性结合等温线的推导**\n\n设 $R$ 为受体，$L$ 为配体，$RL$ 为受体-配体复合物。反应为：\n$$R + L \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} RL$$\n在平衡状态下，结合速率等于解离速率：\n$$k_{\\mathrm{on}} [R]_{\\mathrm{eq}} [L]_{\\mathrm{eq}} = k_{\\mathrm{off}} [RL]_{\\mathrm{eq}}$$\n我们使用所提供的符号：$[L]_{\\mathrm{eq}} = F$（游离配体浓度），$[RL]_{\\mathrm{eq}} = B$（已结合受体浓度，即特异性结合），$[R]_{\\mathrm{eq}}$ 是游离受体浓度。方程变为：\n$$k_{\\mathrm{on}} [R]_{\\mathrm{eq}} F = k_{\\mathrm{off}} B$$\n解离常数 $K_{\\mathrm{D}}$ 定义为逆向速率常数与正向速率常数之比，$K_{\\mathrm{D}} = k_{\\mathrm{off}} / k_{\\mathrm{on}}$。重排平衡条件可得：\n$$K_{\\mathrm{D}} = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{on}}} = \\frac{[R]_{\\mathrm{eq}} F}{B}$$\n总受体浓度，也称为最大结合容量 $B_{\\max}$，是游离受体和已结合受体之和：\n$$B_{\\max} = [R]_{\\mathrm{eq}} + B$$\n由此，游离受体的浓度为 $[R]_{\\mathrm{eq}} = B_{\\max} - B$。将此代入 $K_{\\mathrm{D}}$ 的表达式中：\n$$K_{\\mathrm{D}} = \\frac{(B_{\\max} - B) F}{B}$$\n为了求解作为 $F$ 函数的 $B$，我们重排这个方程：\n$$K_{\\mathrm{D}} B = B_{\\max} F - B F$$\n$$K_{\\mathrm{D}} B + B F = B_{\\max} F$$\n$$B (K_{\\mathrm{D}} + F) = B_{\\max} F$$\n这就得到了特异性结合的最终表达式，它是一个类似于 Michaelis-Menten 方程的直角双曲线：\n$$B(F) = \\frac{B_{\\max} F}{K_{\\mathrm{D}} + F}$$\n\n**2. Scatchard 方程的推导及非特异性结合的影响**\n\n经典的 Scatchard 分析将结合等温线线性化。为了推导 Scatchard 方程，我们重排表达式 $K_{\\mathrm{D}} B = (B_{\\max} - B) F$：\n$$\\frac{B}{F} = \\frac{B_{\\max} - B}{K_{\\mathrm{D}}}$$\n$$\\frac{B}{F} = -\\frac{1}{K_{\\mathrm{D}}} B + \\frac{B_{\\max}}{K_{\\mathrm{D}}}$$\n该方程是线性形式 $y = m x + c$，其中 y 变量是已结合配体与游离配体之比 $B/F$，x 变量是已结合配体浓度 $B$。对于特异性结合，绘制 $B/F$ 对 $B$ 的图（Scatchard 图）会得到一条直线，其斜率为 $m = -1/K_{\\mathrm{D}}$，y 轴截距为 $c = B_{\\max}/K_{\\mathrm{D}}$。x 轴截距（$B/F=0$ 处）出现在 $B=B_{\\max}$。\n\n在实际实验中，测得的总结合量 $B_{\\mathrm{T}}$ 包含一个非特异性组分，该组分被假定为与游离配体浓度 $F$ 呈线性比例：\n$$B_{\\mathrm{T}} = B + \\alpha F$$\n其中 $\\alpha$ 是非特异性结合系数。根据原始可观测数据构建的 Scatchard 图将使用坐标 $(B_{\\mathrm{T}}/F, B_{\\mathrm{T}})$。我们来分析这些坐标之间的关系：\n$$\\frac{B_{\\mathrm{T}}}{F} = \\frac{B + \\alpha F}{F} = \\frac{B}{F} + \\alpha$$\n将 $B/F$ 的线性 Scatchard 方程代入：\n$$\\frac{B_{\\mathrm{T}}}{F} = \\left(-\\frac{1}{K_{\\mathrm{D}}} B + \\frac{B_{\\max}}{K_{\\mathrm{D}}}\\right) + \\alpha$$\n由于 x 轴变量是 $B_{\\mathrm{T}} = B + \\alpha F$，我们可以写出 $B = B_{\\mathrm{T}} - \\alpha F$。将此代入上述方程会产生一个依赖于 $F$ 的复杂关系：\n$$\\frac{B_{\\mathrm{T}}}{F} = -\\frac{1}{K_{\\mathrm{D}}} (B_{\\mathrm{T}} - \\alpha F) + \\frac{B_{\\max}}{K_{\\mathrm{D}}} + \\alpha = -\\frac{1}{K_{\\mathrm{D}}} B_{\\mathrm{T}} + \\frac{B_{\\max}}{K_{\\mathrm{D}}} + \\alpha + \\frac{\\alpha F}{K_{\\mathrm{D}}}$$\n依赖于 $F$ 的项 $\\alpha F / K_{\\mathrm{D}}$ 的存在意味着 $B_{\\mathrm{T}}/F$ 对 $B_{\\mathrm{T}}$ 的图不是线性的，而是一条曲线（具体来说是上凹的）。\n\n**3. 校正非特异性结合的效果**\n\n为了恢复线性的 Scatchard 图，必须从总结合量中减去非特异性结合组分。通常，$\\alpha$ 会被估计，并计算出一个校正后的结合值 $B_{\\mathrm{corr}}$：\n$$B_{\\mathrm{corr}} = B_{\\mathrm{T}} - \\alpha_{\\mathrm{est}} F$$\n其中 $\\alpha_{\\mathrm{est}}$ 是真实非特异性系数 $\\alpha$ 的估计值。代入 $B_{\\mathrm{T}} = B + \\alpha F$：\n$$B_{\\mathrm{corr}} = (B + \\alpha F) - \\alpha_{\\mathrm{est}} F = B + (\\alpha - \\alpha_{\\mathrm{est}}) F$$\n校正后 Scatchard 图的坐标为 $(B_{\\mathrm{corr}}/F, B_{\\mathrm{corr}})$。我们来分析 y 坐标：\n$$\\frac{B_{\\mathrm{corr}}}{F} = \\frac{B + (\\alpha - \\alpha_{\\mathrm{est}}) F}{F} = \\frac{B}{F} + (\\alpha - \\alpha_{\\mathrm{est}})$$\n代入 $B/F$ 的表达式：\n$$\\frac{B_{\\mathrm{corr}}}{F} = \\left(-\\frac{1}{K_{\\mathrm{D}}} B + \\frac{B_{\\max}}{K_{\\mathrm{D}}}\\right) + (\\alpha - \\alpha_{\\mathrm{est}})$$\n设 $\\Delta\\alpha = \\alpha - \\alpha_{\\mathrm{est}}$。该关系式为：\n$$\\frac{B_{\\mathrm{corr}}}{F} = -\\frac{1}{K_{\\mathrm{D}}} (B_{\\mathrm{corr}} - \\Delta\\alpha \\cdot F) + \\frac{B_{\\max}}{K_{\\mathrm{D}}} + \\Delta\\alpha = -\\frac{1}{K_{\\mathrm{D}}} B_{\\mathrm{corr}} + \\frac{B_{\\max}}{K_{\\mathrm{D}}} + \\Delta\\alpha + \\frac{\\Delta\\alpha \\cdot F}{K_{\\mathrm{D}}}$$\n\n我们现在可以分析 $\\alpha_{\\mathrm{est}}$ 的不同情况：\n*   **完全校正 ($\\alpha_{\\mathrm{est}} = \\alpha$)**：此时，$\\Delta\\alpha = 0$。方程简化为：\n    $$\\frac{B_{\\mathrm{corr}}}{F} = -\\frac{1}{K_{\\mathrm{D}}} B_{\\mathrm{corr}} + \\frac{B_{\\max}}{K_{\\mathrm{D}}}$$\n    这与特异性结合的 Scatchard 方程相同，$B_{\\mathrm{corr}} = B$。对这些数据点进行线性拟合将准确估计 $K_{\\mathrm{D}}$ 和 $B_{\\max}$。\n\n*   **不完全校正 ($\\alpha_{\\mathrm{est}} \\neq \\alpha$)**：此时，$\\Delta\\alpha \\neq 0$。项 $\\frac{\\Delta\\alpha \\cdot F}{K_{\\mathrm{D}}}$ 导致校正后的 Scatchard 图呈非线性。对此弯曲数据强行进行线性拟合将导致斜率和截距的估计值有偏差，从而导致计算出的 $\\widehat{B}_{\\max}$ 和 $\\widehat{K}_{\\mathrm{D}}$ 出错。\n    *   如果 $\\alpha_{\\mathrm{est}}  \\alpha$（校正不足），则 $\\Delta\\alpha > 0$，图形呈上凹。这会导致对斜率大小 $|m|$ 的高估和对 x 轴截距的高估。因此，$\\widehat{K}_{\\mathrm{D}} = -1/m$ 将被低估，而 $\\widehat{B}_{\\max}$ 将被高估。\n    *   如果 $\\alpha_{\\mathrm{est}} > \\alpha$（过度校正），则 $\\Delta\\alpha  0$，图形呈下凹。这会导致对斜率大小 $|m|$ 的低估和对 x 轴截距的低估。因此，$\\widehat{K}_{\\mathrm{D}}$ 将被高估，而 $\\widehat{B}_{\\max}$ 将被低估。\n\n将要实现的程序将通过生成合成数据并对校正后的 Scatchard 图执行线性回归来量化这些偏差。",
            "answer": "[[100.0,10.0,0.01258679092892994,-0.10300438061413813,-0.013915159040989396,0.11585223011317072],[30.0,1.0,0.0,0.0,0.0,0.0],[10.0,50.0,0.041697223689408665,-0.08051786522384617,-0.04698579973215911,0.0934149602419098]]"
        }
    ]
}