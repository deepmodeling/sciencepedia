{
    "hands_on_practices": [
        {
            "introduction": "To fully appreciate cooperativity, we must first master the non-cooperative baseline. This practice  challenges you to demonstrate from first principles that the classic Michaelis-Menten model of enzyme kinetics is a special case of the Hill equation where the Hill coefficient $n$ is equal to $1$. By rigorously connecting these two foundational models, you will build a solid conceptual framework for identifying and quantifying true cooperative effects in more complex systems.",
            "id": "3879836",
            "problem": "You are asked to show, from first principles of the law of mass action and conservation of mass, that a single-substrate enzyme reaction operating under the Quasi-Steady-State Approximation (QSSA) can be represented by a Hill-type input-output relation with Hill exponent equal to $1$. Your derivation must start from the fundamental reaction scheme $E + S \\rightleftharpoons ES \\rightarrow E + P$ with forward association rate constant $k_{1}$, reverse dissociation rate constant $k_{-1}$, and catalytic rate constant $k_{\\mathrm{cat}}$. Let the total enzyme concentration be $E_{\\mathrm{tot}}$, substrate concentration be $S$, and product concentration be $P$. Assume $S$ is buffered so that its value is effectively constant on the timescale of formation of $ES$. Use only the law of mass action, conservation of mass, and the Quasi-Steady-State Approximation (QSSA) for the intermediate $ES$.\n\nTasks:\n1) Derive, using only the law of mass action and the QSSA for the intermediate complex, a closed-form expression for the product formation velocity $v$ in terms of $k_{1}$, $k_{-1}$, $k_{\\mathrm{cat}}$, $E_{\\mathrm{tot}}$, and $S$. Also derive the dimensionless fraction of enzyme bound in the complex, defined as the occupancy $\\theta = [ES]/E_{\\mathrm{tot}}$.\n2) Separately, for a one-site noncooperative binding system (which is the $n=1$ case of a Hill-type model), write the most general occupancy function compatible with a single binding site that is monotone in the ligand concentration, equals $0$ at zero ligand, and tends to $1$ as ligand goes to infinity. Identify the single parameter in that function with the necessary combination of kinetic parameters from part (1) so that the normalized reaction velocity $v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$ equals the occupancy $\\theta$ for all $S \\ge 0$.\n3) Prove the equivalence found in part (2) by explicit algebraic manipulation starting from the result of part (1) and your chosen one-site occupancy function from part (2).\n4) Implement a program that, for each test case below, computes: (i) the velocity obtained from your derivation in part (1), (ii) the velocity predicted by the $n=1$ Hill-type occupancy from part (2) after your parameter identification, and (iii) the absolute difference between these two velocities. The program must aggregate all test case outputs into one final line as specified under “Final Output Format.”\n\nScientific realism and units:\n- Concentration units must be in molarity (mol/L).\n- Time units must be in seconds.\n- Rate constants: $k_{1}$ in $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$, $k_{-1}$ in $\\mathrm{s}^{-1}$, and $k_{\\mathrm{cat}}$ in $\\mathrm{s}^{-1}$.\n- The velocity $v$ must be expressed in $\\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\mathrm{s}^{-1}$ as a decimal number.\n\nTest suite:\nUse the following parameter sets. Each test case has the ordered tuple $(k_{1}, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, S)$, in the units stated above.\n- Case A: ($1.0 \\times 10^6$, $100.0$, $50.0$, $1.0 \\times 10^{-6}$, $1.5 \\times 10^{-4}$)\n- Case B: ($1.0 \\times 10^6$, $100.0$, $50.0$, $1.0 \\times 10^{-6}$, $0.0$)\n- Case C: ($1.0 \\times 10^6$, $100.0$, $50.0$, $2.0 \\times 10^{-6}$, $1.0 \\times 10^{-2}$)\n- Case D: ($1.0 \\times 10^6$, $100.0$, $0.0$, $5.0 \\times 10^{-6}$, $1.0 \\times 10^{-3}$)\n- Case E: ($2.0 \\times 10^5$, $20.0$, $200.0$, $5.0 \\times 10^{-7}$, $1.0 \\times 10^{-3}$)\n\nFor each case, the program must compute:\n- The velocity $v_{\\mathrm{QSSA}}$ derived in Task 1.\n- The velocity $v_{\\mathrm{Hill}, n=1}$ predicted in Task 2 after your parameter identification.\n- The absolute difference $\\lvert v_{\\mathrm{QSSA}} - v_{\\mathrm{Hill}, n=1}\\rvert$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of per-case sublists, with each sublist in the order $[v_{\\mathrm{QSSA}}, v_{\\mathrm{Hill}, n=1}, \\lvert v_{\\mathrm{QSSA}} - v_{\\mathrm{Hill}, n=1}\\rvert]$. The entire output must be a single line representing a list of lists with no spaces, for example:\n\"[[x11,x12,x13],[x21,x22,x23],...]\" where each $x_{ij}$ is a decimal number. All velocities are in $\\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\mathrm{s}^{-1}$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of chemical kinetics and biomedical systems modeling, is well-posed with a unique and meaningful solution, and is expressed objectively with a complete and consistent set of givens. The tasks involve a standard derivation of the Michaelis-Menten equation and its comparison to the Hill equation, a fundamental concept in biochemistry.\n\nHere is the step-by-step derivation and proof as requested.\n\nThe fundamental reaction scheme for a single-substrate enzyme reaction is given by:\n$$\nE + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_{\\mathrm{cat}}}{\\longrightarrow} E + P\n$$\nwhere $E$ is the enzyme, $S$ is the substrate, $ES$ is the enzyme-substrate complex, and $P$ is the product. The rate constants are $k_1$ (forward association), $k_{-1}$ (reverse dissociation), and $k_{\\mathrm{cat}}$ (catalysis).\n\nThe problem requires a derivation based on three core principles:\n1.  The Law of Mass Action: The rate of a reaction is proportional to the product of the concentrations of the reactants.\n2.  Conservation of Mass: The total amount of enzyme is constant.\n3.  The Quasi-Steady-State Approximation (QSSA): The concentration of the intermediate complex $ES$ is assumed to be constant over the timescale of product formation.\n\n**Task 1: Derivation of Product Formation Velocity ($v$) and Occupancy ($\\theta$)**\n\nFirst, we apply the law of mass action to write the differential equation for the rate of change of the enzyme-substrate complex concentration, $[ES]$:\n$$\n\\frac{d[ES]}{dt} = (\\text{rate of formation of } ES) - (\\text{rate of breakdown of } ES)\n$$\nThe formation of $ES$ occurs from $E$ and $S$ with rate constant $k_1$. The breakdown of $ES$ occurs either by dissociation back to $E$ and $S$ with rate constant $k_{-1}$ or by catalysis to $E$ and $P$ with rate constant $k_{\\mathrm{cat}}$. This gives:\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_{\\mathrm{cat}}[ES] = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES]\n$$\nThe velocity of the reaction, $v$, is defined as the rate of product formation:\n$$\nv = \\frac{d[P]}{dt} = k_{\\mathrm{cat}}[ES]\n$$\nNext, we apply the principle of mass conservation for the enzyme. The total enzyme concentration, $E_{\\mathrm{tot}}$, is the sum of the free enzyme concentration, $[E]$, and the concentration of enzyme bound in the complex, $[ES]$:\n$$\nE_{\\mathrm{tot}} = [E] + [ES]\n$$\nThis allows us to express the concentration of free enzyme as:\n$$\n[E] = E_{\\mathrm{tot}} - [ES]\n$$\nNow, we apply the Quasi-Steady-State Approximation (QSSA), which assumes that the concentration of the intermediate complex $[ES]$ changes much more slowly than the substrate and product concentrations, and thus can be considered to be in a steady state, i.e., $\\frac{d[ES]}{dt} \\approx 0$.\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\nSubstituting the expression for $[E]$ from the conservation law into the steady-state equation gives:\n$$\nk_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\nWe now solve this algebraic equation for $[ES]$. Expanding the first term:\n$$\nk_1 E_{\\mathrm{tot}}[S] - k_1 [ES][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\nGrouping all terms containing $[ES]$ on one side:\n$$\nk_1 E_{\\mathrm{tot}}[S] = k_1 [ES][S] + (k_{-1} + k_{\\mathrm{cat}})[ES]\n$$\n$$\nk_1 E_{\\mathrm{tot}}[S] = [ES] (k_1 [S] + k_{-1} + k_{\\mathrm{cat}})\n$$\nIsolating $[ES]$:\n$$\n[ES] = \\frac{k_1 E_{\\mathrm{tot}}[S]}{k_1 [S] + k_{-1} + k_{\\mathrm{cat}}}\n$$\nTo simplify, we divide the numerator and denominator by $k_1$:\n$$\n[ES] = \\frac{E_{\\mathrm{tot}}[S]}{[S] + \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}}\n$$\nWe define the Michaelis constant, $K_M$, as the specific combination of rate constants:\n$$\nK_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}\n$$\nSubstituting $K_M$ into the expression for $[ES]$ yields:\n$$\n[ES] = \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]}\n$$\nNow we can derive the expression for the reaction velocity, $v$, by substituting this result into the velocity equation $v = k_{\\mathrm{cat}}[ES]$:\n$$\nv = k_{\\mathrm{cat}} \\left( \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} \\right) = \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]}\n$$\nThis is the renowned Michaelis-Menten equation. The maximum velocity, $v_{\\mathrm{max}}$, is achieved when the enzyme is saturated with substrate (i.e., as $[S] \\to \\infty$), which gives $v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$.\n\nFinally, we derive the dimensionless occupancy, $\\theta$, defined as the fraction of enzyme bound in the complex:\n$$\n\\theta = \\frac{[ES]}{E_{\\mathrm{tot}}}\n$$\nSubstituting the expression for $[ES]$:\n$$\n\\theta = \\frac{1}{E_{\\mathrm{tot}}} \\left( \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} \\right) = \\frac{[S]}{K_M + [S]}\n$$\nThis completes the derivation for Task 1.\n\n**Task 2: One-Site Occupancy Function and Parameter Identification**\n\nThe Hill equation describes cooperative binding. For a general number of binding sites, $n$, the occupancy $\\theta$ as a function of ligand concentration $[S]$ is given by:\n$$\n\\theta([S]) = \\frac{[S]^n}{K_d^n + [S]^n}\n$$\nwhere $n$ is the Hill exponent and $K_d$ is the apparent dissociation constant. A one-site noncooperative binding system corresponds to a Hill exponent of $n=1$. The occupancy function is therefore:\n$$\n\\theta([S]) = \\frac{[S]}{K_d + [S]}\n$$\nThis function satisfies the required properties:\n- It is monotonic in $[S]$.\n- At zero ligand concentration, $\\theta(0) = 0$.\n- It saturates at high ligand concentration, $\\lim_{[S]\\to\\infty} \\theta([S]) = 1$.\nThe single parameter in this model is the dissociation constant $K_d$.\n\nThe problem asks us to identify this parameter $K_d$ by equating the occupancy $\\theta$ to the normalized reaction velocity, $\\frac{v}{v_{\\mathrm{max}}}$. From Task 1, we have $v = \\frac{v_{\\mathrm{max}}[S]}{K_M + [S]}$, where $v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$.\nThe normalized velocity is:\n$$\n\\frac{v}{v_{\\mathrm{max}}} = \\frac{1}{v_{\\mathrm{max}}} \\left( \\frac{v_{\\mathrm{max}}[S]}{K_M + [S]} \\right) = \\frac{[S]}{K_M + [S]}\n$$\nEquating the Hill occupancy function for $n=1$ with this normalized velocity:\n$$\n\\frac{[S]}{K_d + [S]} = \\frac{[S]}{K_M + [S]}\n$$\nFor this equality to hold for all substrate concentrations $[S] \\ge 0$, the parameters in the denominators must be equal. Thus, we identify the dissociation constant $K_d$ from the binding model with the Michaelis constant $K_M$ from the kinetic model:\n$$\nK_d = K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}\n$$\nThis identification shows that the Michaelis-Menten kinetic model is mathematically a special case of the Hill model for $n=1$.\n\n**Task 3: Proof of Equivalence**\n\nWe are asked to prove the equivalence found in Task 2 by explicit algebraic manipulation. The goal is to show that the normalized reaction velocity from the QSSA derivation is identical to the occupancy predicted by the one-site Hill model.\n\n1.  From the QSSA derivation in Task 1, the reaction velocity is $v_{\\mathrm{QSSA}} = \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]}$.\n2.  The velocity predicted by the one-site Hill model, $v_{\\mathrm{Hill}, n=1}$, is the product of the maximum possible velocity, $v_{\\mathrm{max}}$, and the Hill occupancy function $\\theta([S])$ with $n=1$:\n    $$\n    v_{\\mathrm{Hill}, n=1} = v_{\\mathrm{max}} \\cdot \\theta([S])\n    $$\n3.  The maximum velocity is $v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$. The one-site Hill occupancy function is $\\theta([S]) = \\frac{[S]}{K_d + [S]}$. Therefore:\n    $$\n    v_{\\mathrm{Hill}, n=1} = (k_{\\mathrm{cat}}E_{\\mathrm{tot}}) \\left(\\frac{[S]}{K_d + [S]}\\right)\n    $$\n4.  Applying the parameter identification from Task 2, we set $K_d = K_M$:\n    $$\n    v_{\\mathrm{Hill}, n=1} = \\frac{k_{\\mathrm{cat}}E_{\\mathrm{tot}}[S]}{K_M + [S]}\n    $$\n5.  Comparing this expression to the one derived from QSSA:\n    $$\n    v_{\\mathrm{QSSA}} = \\frac{k_{\\mathrm{cat}}E_{\\mathrm{tot}}[S]}{K_M + [S]}\n    $$\n    The two expressions are algebraically identical. Thus, we have explicitly proven that $v_{\\mathrm{QSSA}} = v_{\\mathrm{Hill}, n=1}$ given the identification $K_d = K_M$. This confirms that single-substrate enzyme kinetics under the QSSA can be represented by a Hill-type relation with a Hill exponent of $n=1$. Q.E.D.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes enzyme reaction velocities based on Michaelis-Menten kinetics (derived from QSSA)\n    and a corresponding Hill n=1 model, and calculates the absolute difference.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k1, k_neg1, k_cat, E_tot, S)\n    test_cases = [\n        (1.0e6, 100.0, 50.0, 1.0e-6, 1.5e-4),   # Case A\n        (1.0e6, 100.0, 50.0, 1.0e-6, 0.0),      # Case B\n        (1.0e6, 100.0, 50.0, 2.0e-6, 1.0e-2),   # Case C\n        (1.0e6, 100.0, 0.0, 5.0e-6, 1.0e-3),    # Case D\n        (2.0e5, 20.0, 200.0, 5.0e-7, 1.0e-3)    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        k1, k_neg1, k_cat, E_tot, S = case\n\n        # The derivation shows that the underlying mathematical expressions for\n        # v_QSSA and v_Hill_n=1 are identical. The calculation is performed once.\n        \n        # Avoid division by zero if k1 is zero.\n        if k1 == 0:\n            # If k1 is 0, no complex can form, so velocity is 0. K_M would be infinite.\n            # This case is not in the test suite but is good practice.\n            v = 0.0\n        else:\n            # Calculate the Michaelis constant, K_M\n            # K_M has units of concentration (mol/L)\n            K_M = (k_neg1 + k_cat) / k1\n\n            # Calculate the maximum velocity, v_max\n            # v_max has units of mol L^-1 s^-1\n            v_max = k_cat * E_tot\n\n            # Calculate the reaction velocity using the Michaelis-Menten equation\n            # Denominator cannot be zero since S >= 0 and K_M > 0 for non-zero rates.\n            v = v_max * S / (K_M + S)\n\n        v_qssa = v\n        v_hill_n1 = v\n        \n        # Calculate the absolute difference. Due to identical algebraic forms,\n        # this should be 0.0, subject to floating-point precision.\n        abs_diff = np.abs(v_qssa - v_hill_n1)\n\n        results.append([v_qssa, v_hill_n1, abs_diff])\n\n    # Format the final output string as a list of lists with no spaces.\n    # str(results) produces a string like '[[...], [...]]' with spaces.\n    # We remove the spaces to match the required format.\n    final_output_string = str(results).replace(\" \", \"\")\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "With a theoretical foundation in place, we now turn to the practical task of extracting cooperativity parameters from experimental data. The Hill plot is the quintessential tool for this purpose, allowing for the visualization and quantification of cooperative binding. In this exercise , you will derive the linearization that makes the Hill plot possible and apply it to analyze binding data, thereby estimating the Hill coefficient $n$ and the apparent dissociation constant $K_d$.",
            "id": "3879800",
            "problem": "A receptor–ligand system at isothermal equilibrium is observed where a receptor $R$ can bind a ligand $L$ with cooperative characteristics. Let the fractional occupancy be $Y \\in (0,1)$, defined as the fraction of binding sites occupied at equilibrium. The base of this problem is the thermodynamic law of mass action applied to chemical equilibrium and the definition of fractional occupancy. Starting from this base only, derive the linearization used in a Hill plot, which captures the relationship between $Y$ and the ligand concentration $[L]$ under a cooperative binding model, and explain how to estimate the Hill coefficient $n$ and an apparent dissociation constant $K_d$ from such a linearization. Then, implement the derived method in code to analyze the following datasets.\n\nYour algorithm must:\n- Use the definition of fractional occupancy $Y$ and mass-action equilibrium to justify a transformation yielding a linear relation in terms of $\\log$ of appropriate combinations of $Y$ and $[L]$ that are suitable for Ordinary Least Squares (OLS) estimation, where Ordinary Least Squares (OLS) stands for the method of minimizing the sum of squared residuals in a linear model.\n- Use the natural logarithm $\\log$ (base $e$) everywhere unless otherwise stated explicitly.\n- Handle numerical singularities that occur when $Y$ is near $0$ or $1$ by clipping $Y$ to the open interval $(\\varepsilon, 1-\\varepsilon)$ with $\\varepsilon = 10^{-12}$ before applying any logarithmic transformation.\n- Estimate the Hill coefficient $n$ and the apparent dissociation constant $K_d$ from the slope and intercept of the fitted line in the chosen Hill-plot coordinates.\n- Report $K_d$ in molar units $M$.\n\nTest suite (each case provides $[L]$ in $M$ and $Y$ as dimensionless fractional occupancy):\n- Case $1$ (baseline, approximately non-cooperative behavior): $[L] = [\\,10^{-8},\\,5\\times 10^{-8},\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6},\\,5\\times 10^{-6}\\,]$, $Y = [\\,0.019608,\\,0.090909,\\,0.166667,\\,0.500000,\\,0.666667,\\,0.909091\\,]$.\n- Case $2$ (positive cooperativity): $[L] = [\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6},\\,2\\times 10^{-6},\\,5\\times 10^{-6},\\,10^{-5}\\,]$, $Y = [\\,0.002494,\\,0.058824,\\,0.200000,\\,0.500000,\\,0.862069,\\,0.961538\\,]$.\n- Case $3$ (negative cooperativity): $[L] = [\\,10^{-9},\\,10^{-8},\\,10^{-7},\\,10^{-6},\\,10^{-5}\\,]$, $Y = [\\,0.030657,\\,0.090909,\\,0.240253,\\,0.500000,\\,0.759141\\,]$.\n- Case $4$ (edge-case extremes): $[L] = [\\,10^{-9},\\,5\\times 10^{-9},\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6}\\,]$, $Y = [\\,0.000001,\\,0.000125,\\,0.500000,\\,0.992063,\\,0.999001\\,]$.\n- Case $5$ (sparse sampling): $[L] = [\\,10^{-6},\\,3\\times 10^{-6},\\,10^{-5}\\,]$, $Y = [\\,0.161398,\\,0.500000,\\,0.858026\\,]$.\n\nYour program should:\n- Construct the Hill plot according to your derived linearization for each case.\n- Fit a straight line using OLS in the transformed coordinates.\n- Return, for each case in order, the estimated Hill coefficient $n$ and the apparent dissociation constant $K_d$ in $M$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be flattened such that for case $1$ you output $n$ followed by $K_d$, then for case $2$ you output $n$ followed by $K_d$, and so on. For example, the format is $[\\text{n}_1,\\text{K\\_d}_1,\\text{n}_2,\\text{K\\_d}_2,\\dots]$.",
            "solution": "The problem requires a derivation of the linearization used for a Hill plot, starting from the law of mass action, and an explanation of how to estimate the Hill coefficient $n$ and apparent dissociation constant $K_d$ from it. The foundation of this model is the cooperative binding of a ligand $L$ to a receptor $R$.\n\nWe begin by phenomenologically modeling the binding of $n$ ligand molecules to a receptor $R$ as a single concerted step:\n$$ R + nL \\rightleftharpoons RL_n $$\nThis reaction assumes that all $n$ binding sites on the receptor are either simultaneously empty or simultaneously occupied. While this is a simplification, it provides a useful macroscopic description of cooperative binding.\n\nAccording to the law of mass action, at equilibrium, the macroscopic association constant, $K_a$, is given by the ratio of the concentration of the product to the concentrations of the reactants:\n$$ K_a = \\frac{[RL_n]}{[R][L]^n} $$\nIt is often more convenient to work with the macroscopic dissociation constant, $K_D$, which is the reciprocal of $K_a$:\n$$ K_D = \\frac{1}{K_a} = \\frac{[R][L]^n}{[RL_n]} $$\n\nThe fractional occupancy, $Y$, is defined as the fraction of total receptor binding sites that are occupied by the ligand. Within this all-or-none model, the concentration of occupied sites is represented by the concentration of the fully bound complex, $[RL_n]$, and the total concentration of receptor sites is proportional to the total receptor concentration, $[R]_{\\text{total}} = [R] + [RL_n]$. Thus, the fractional occupancy is:\n$$ Y = \\frac{[RL_n]}{[R]_{\\text{total}}} = \\frac{[RL_n]}{[R] + [RL_n]} $$\n\nTo express $Y$ as a function of the ligand concentration $[L]$, we can rearrange the equilibrium expression for $K_D$ to solve for the concentration of free receptor, $[R]$:\n$$ [R] = \\frac{K_D [RL_n]}{[L]^n} $$\nSubstituting this expression for $[R]$ into the equation for $Y$:\n$$ Y = \\frac{[RL_n]}{\\frac{K_D [RL_n]}{[L]^n} + [RL_n]} $$\nWe can cancel the term $[RL_n]$ from the numerator and denominator:\n$$ Y = \\frac{1}{\\frac{K_D}{[L]^n} + 1} = \\frac{[L]^n}{K_D + [L]^n} $$\nThis equation is a form of the Hill equation. The constant $K_D$ is related to the ligand concentration that results in half-maximal occupancy. Let's define the apparent dissociation constant, $K_d$, as precisely this concentration: the value of $[L]$ for which $Y=0.5$. Substituting $Y=0.5$ and $[L]=K_d$ into the equation:\n$$ 0.5 = \\frac{K_d^n}{K_D + K_d^n} \\implies 0.5(K_D + K_d^n) = K_d^n \\implies 0.5 K_D = 0.5 K_d^n \\implies K_D = K_d^n $$\nBy substituting $K_D = K_d^n$ back into our equation for $Y$, we obtain the standard Hill equation in terms of the apparent dissociation constant $K_d$:\n$$ Y = \\frac{[L]^n}{K_d^n + [L]^n} $$\nHere, $n$ is the Hill coefficient which quantifies the degree of cooperativity ($n1$ for positive cooperativity, $n1$ for negative cooperativity, and $n=1$ for non-cooperative binding) and $K_d$ is the ligand concentration that yields half-occupancy.\n\nTo estimate $n$ and $K_d$ from experimental data $([L]_i, Y_i)$, we must first linearize the Hill equation. We can rearrange the equation to express the ratio of occupied to unoccupied sites:\n$$ Y(K_d^n + [L]^n) = [L]^n $$\n$$ Y K_d^n = [L]^n - Y[L]^n = [L]^n(1-Y) $$\n$$ \\frac{Y}{1-Y} = \\frac{[L]^n}{K_d^n} = \\left(\\frac{[L]}{K_d}\\right)^n $$\nThe term $Y/(1-Y)$ is known as the odds of binding. Taking the natural logarithm (as specified by the problem) of both sides yields a linear relationship:\n$$ \\log\\left(\\frac{Y}{1-Y}\\right) = \\log\\left(\\left(\\frac{[L]}{K_d}\\right)^n\\right) $$\n$$ \\log\\left(\\frac{Y}{1-Y}\\right) = n \\log\\left(\\frac{[L]}{K_d}\\right) = n\\log([L]) - n\\log(K_d) $$\nThis equation is in the form of a straight line, $y_{\\text{fit}} = m x_{\\text{fit}} + c$, which is the basis for the Hill plot. We can identify the components:\n- The dependent variable is $y_{\\text{fit}} = \\log\\left(\\frac{Y}{1-Y}\\right)$.\n- The independent variable is $x_{\\text{fit}} = \\log([L])$.\n- The slope is $m = n$.\n- The y-intercept is $c = -n\\log(K_d)$.\n\nGiven a set of experimental data points $([L]_i, Y_i)$, we first transform them into the coordinates $(x_{\\text{fit}, i}, y_{\\text{fit}, i}) = (\\log([L]_i), \\log(Y_i/(1-Y_i)))$. A practical consideration is that for values of $Y$ very close to $0$ or $1$, the term $\\log(Y/(1-Y))$ will approach $-\\infty$ or $+\\infty$, respectively. To avoid numerical instability, we first clip the observed $Y$ values to a small, machine-representable interval away from the boundaries, such as $(\\varepsilon, 1-\\varepsilon)$ for a small $\\varepsilon  0$. The problem specifies using $\\varepsilon = 10^{-12}$.\n\nWith the transformed data, we can perform an Ordinary Least Squares (OLS) linear regression to find the best-fit slope, $\\hat{m}$, and intercept, $\\hat{c}$, that minimize the sum of squared residuals. From these fitted parameters, we estimate the Hill parameters:\n1. The Hill coefficient, $n$, is estimated directly from the slope:\n   $$ \\hat{n} = \\hat{m} $$\n2. The apparent dissociation constant, $K_d$, is estimated from the slope and intercept. From $\\hat{c} = -\\hat{n}\\log(\\hat{K}_d)$, we can solve for $\\hat{K}_d$:\n   $$ \\log(\\hat{K}_d) = -\\frac{\\hat{c}}{\\hat{n}} $$\n   $$ \\hat{K}_d = \\exp\\left(-\\frac{\\hat{c}}{\\hat{m}}\\right) $$\n\nThe algorithm implemented in the code follows these steps for each provided dataset. It transforms the raw $([L], Y)$ data into the linear Hill plot coordinates $(\\log([L]), \\log(Y/(1-Y)))$, performs an OLS fit to extract the slope and intercept, and then calculates the estimates for $n$ and $K_d$ using the relationships derived above.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives Hill plot parameters (n, Kd) for several receptor-ligand binding datasets.\n    \"\"\"\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"L\": np.array([1e-8, 5e-8, 1e-7, 5e-7, 1e-6, 5e-6]),\n            \"Y\": np.array([0.019608, 0.090909, 0.166667, 0.500000, 0.666667, 0.909091])\n        },\n        {\n            \"L\": np.array([1e-7, 5e-7, 1e-6, 2e-6, 5e-6, 1e-5]),\n            \"Y\": np.array([0.002494, 0.058824, 0.200000, 0.500000, 0.862069, 0.961538])\n        },\n        {\n            \"L\": np.array([1e-9, 1e-8, 1e-7, 1e-6, 1e-5]),\n            \"Y\": np.array([0.030657, 0.090909, 0.240253, 0.500000, 0.759141])\n        },\n        {\n            \"L\": np.array([1e-9, 5e-9, 1e-7, 5e-7, 1e-6]),\n            \"Y\": np.array([0.000001, 0.000125, 0.500000, 0.992063, 0.999001])\n        },\n        {\n            \"L\": np.array([1e-6, 3e-6, 1e-5]),\n            \"Y\": np.array([0.161398, 0.500000, 0.858026])\n        }\n    ]\n\n    results = []\n    epsilon = 1e-12\n\n    for case in test_cases:\n        L = case[\"L\"]\n        Y = case[\"Y\"]\n\n        # 1. Clip Y to avoid numerical singularities at 0 and 1\n        Y_clipped = np.clip(Y, epsilon, 1 - epsilon)\n\n        # 2. Transform data for Hill plot\n        # x_fit = log([L])\n        # y_fit = log(Y / (1 - Y))\n        x_fit = np.log(L)\n        y_fit = np.log(Y_clipped / (1 - Y_clipped))\n\n        # 3. Perform Ordinary Least Squares (OLS) linear regression\n        # y_fit = m * x_fit + c\n        # We need to find slope m and intercept c.\n        N = len(x_fit)\n        sum_x = np.sum(x_fit)\n        sum_y = np.sum(y_fit)\n        sum_xy = np.sum(x_fit * y_fit)\n        sum_x2 = np.sum(x_fit * x_fit)\n\n        # Calculate slope (m) and intercept (c) using standard OLS formulas\n        # m = (N * sum(xy) - sum(x) * sum(y)) / (N * sum(x^2) - (sum(x))^2)\n        # c = (sum(y) - m * sum(x)) / N\n        denominator = N * sum_x2 - sum_x**2\n        if np.abs(denominator)  1e-15:\n            # This would occur if all log([L]) values are identical, which is\n            # not the case here but is a necessary check for robust code.\n            # The slope is effectively infinite or undefined.\n            m = np.inf\n            c = np.nan\n        else:\n            m = (N * sum_xy - sum_x * sum_y) / denominator\n            c = (sum_y - m * sum_x) / N\n\n        # 4. Estimate Hill parameters n and Kd\n        # n = m\n        # Kd = exp(-c / m)\n        n = m\n        \n        if np.abs(m)  1e-15:\n            # If slope is zero, Kd is undefined in this formulation.\n            Kd = np.nan \n        else:\n            Kd = np.exp(-c / m)\n\n        results.extend([n, Kd])\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Cooperative interactions are fundamental not only to substrate binding but also to the sophisticated regulation of enzyme activity through allosteric inhibition. This advanced practice  extends the concept of cooperativity to a multi-site inhibitor model, a common motif in pharmacology and cell signaling. You will employ a statistical thermodynamics approach to derive the enzyme's activity as a function of inhibitor concentration and calculate the half-maximal inhibitory concentration ($I_{1/2}$).",
            "id": "3879824",
            "problem": "An enzyme $E$ participates in a catalytic reaction whose initial velocity in the absence of inhibitor is $v_{0}$. The enzyme has two identical allosteric inhibitor binding sites for a small-molecule inhibitor $I$. Binding is at thermodynamic equilibrium and the inhibitor concentration is much larger than the total enzyme concentration so that the free inhibitor concentration equals the total inhibitor concentration. Cooperative interactions between the two inhibitor molecules bound to the same enzyme are modeled by an interaction parameter $\\omega$ as follows: the statistical weight of the doubly occupied state is multiplied by $\\omega$ relative to what would be expected for two independent sites. The dissociation constant for binding to an unoccupied site is $K$. The singly occupied state has a twofold combinatorial multiplicity because there are two equivalent sites.\n\nAssume the following activity model: if $n \\in \\{0,1,2\\}$ inhibitor molecules are bound to an enzyme molecule, its catalytic activity is reduced multiplicatively by a factor $\\beta^{n}$ relative to the uninhibited activity, where $0\\beta1$ is a fixed number characterizing per-site inhibitory efficacy. Let $a(I)$ denote the normalized activity $v(I)/v_{0}$ at inhibitor concentration $I$.\n\nStarting from fundamental equilibrium binding and statistical thermodynamics (binding polynomial and microstate probabilities), derive $a(I)$ in terms of $I$, $K$, $\\beta$, and $\\omega$, and then determine the inhibitor concentration $I_{1/2}$ such that $a(I_{1/2}) = \\tfrac{1}{2}$.\n\nUse the parameter values $K = 1.0 \\times 10^{-7}\\,\\mathrm{M}$, $\\beta = 0.30$, and $\\omega = 10$. Express your final $I_{1/2}$ in nanomolar (nM) and round your answer to three significant figures. The final answer must be a single real number.",
            "solution": "The problem asks for a derivation of the normalized enzyme activity $a(I)$ as a function of inhibitor concentration $I$ and subsequent calculation of the half-maximal inhibitory concentration, $I_{1/2}$.\n\nFirst, we establish the model for inhibitor binding based on statistical thermodynamics. The enzyme $E$ has two identical and distinguishable binding sites for the inhibitor $I$. There are three possible species in equilibrium: $E$ (no inhibitor bound), $EI$ (one inhibitor bound), and $EI_2$ (two inhibitors bound). We define the statistical weights of these species relative to the unbound enzyme $E$, whose weight is taken as $1$.\n\nLet $[I]$ be the free inhibitor concentration and $K$ be the dissociation constant for an inhibitor binding to an unoccupied site. The problem states that $[I]$ is much larger than the total enzyme concentration, so we can treat $[I]$ as a constant parameter, which we denote as $I$.\n\n1.  **Statistical weight of $E$ (state with $n=0$ inhibitors):**\n    By definition, the statistical weight is $w_0 = 1$.\n\n2.  **Statistical weight of $EI$ (state with $n=1$ inhibitor):**\n    There are two identical sites where the first inhibitor can bind. The problem states a \"twofold combinatorial multiplicity\". For each site, the binding equilibrium is $E + I \\rightleftharpoons EI_{\\text{site}}$. The association constant for a single site is $1/K$. Since there are two sites, the statistical weight relative to the free enzyme is the sum of weights for binding to each site, which is $w_1 = \\binom{2}{1} \\frac{I}{K} = 2\\frac{I}{K}$.\n\n3.  **Statistical weight of $EI_2$ (state with $n=2$ inhibitors):**\n    For two independent and identical sites, the statistical weight for binding two inhibitors would be $(\\frac{I}{K})^2$. The problem introduces a cooperativity interaction parameter $\\omega$, stating that the statistical weight of the doubly occupied state is multiplied by $\\omega$. Thus, the weight is $w_2 = \\binom{2}{2} \\omega (\\frac{I}{K})^2 = \\omega (\\frac{I}{K})^2$.\n\nThe binding polynomial, $P(I)$, which serves as the partition function for the system, is the sum of all statistical weights:\n$$P(I) = w_0 + w_1 + w_2 = 1 + 2\\frac{I}{K} + \\omega \\left(\\frac{I}{K}\\right)^2$$\n\nThe fraction of enzyme molecules in each state ($p_n$) is the statistical weight of that state divided by the binding polynomial:\n$p_0 = \\frac{w_0}{P(I)} = \\frac{1}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n$p_1 = \\frac{w_1}{P(I)} = \\frac{2\\frac{I}{K}}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n$p_2 = \\frac{w_2}{P(I)} = \\frac{\\omega (\\frac{I}{K})^2}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n\nThe total catalytic velocity $v(I)$ is the weighted sum of the activities of each species. The activity of an enzyme with $n$ inhibitors is given as $\\beta^n v_0$, where $v_0$ is the uninhibited velocity and $0  \\beta  1$.\n$v(I) = p_0 \\cdot (\\beta^0 v_0) + p_1 \\cdot (\\beta^1 v_0) + p_2 \\cdot (\\beta^2 v_0)$\n$v(I) = v_0 (p_0 + \\beta p_1 + \\beta^2 p_2)$\n\nThe normalized activity $a(I)$ is $v(I)/v_0$:\n$a(I) = p_0 + \\beta p_1 + \\beta^2 p_2$\nSubstituting the expressions for $p_n$:\n$$a(I) = \\frac{1 + \\beta \\left(2\\frac{I}{K}\\right) + \\beta^2 \\left(\\omega \\left(\\frac{I}{K}\\right)^2\\right)}{1 + 2\\frac{I}{K} + \\omega \\left(\\frac{I}{K}\\right)^2}$$\nThis is the derived expression for $a(I)$.\n\nNext, we determine the inhibitor concentration $I_{1/2}$ at which the normalized activity is $a(I_{1/2}) = \\frac{1}{2}$.\nLet $x = \\frac{I_{1/2}}{K}$. The equation becomes:\n$$\\frac{1 + 2\\beta x + \\omega\\beta^2 x^2}{1 + 2x + \\omega x^2} = \\frac{1}{2}$$\nCross-multiplying gives:\n$2(1 + 2\\beta x + \\omega\\beta^2 x^2) = 1 + 2x + \\omega x^2$\n$2 + 4\\beta x + 2\\omega\\beta^2 x^2 = 1 + 2x + \\omega x^2$\nRearranging the terms to form a standard quadratic equation $Ax^2 + Bx + C = 0$:\n$(2\\omega\\beta^2 - \\omega)x^2 + (4\\beta - 2)x + (2 - 1) = 0$\n$$\\omega(2\\beta^2 - 1)x^2 + 2(2\\beta - 1)x + 1 = 0$$\n\nNow, we substitute the given parameter values: $K = 1.0 \\times 10^{-7}\\,\\mathrm{M}$, $\\beta = 0.30$, and $\\omega = 10$.\nFirst, calculate the coefficients of the quadratic equation:\n$A = \\omega(2\\beta^2 - 1) = 10(2(0.30)^2 - 1) = 10(2(0.09) - 1) = 10(0.18 - 1) = 10(-0.82) = -8.2$\n$B = 2(2\\beta - 1) = 2(2(0.30) - 1) = 2(0.6 - 1) = 2(-0.4) = -0.8$\n$C = 1$\nThe equation is $-8.2x^2 - 0.8x + 1 = 0$, which is equivalent to $8.2x^2 + 0.8x - 1 = 0$.\n\nWe solve for $x$ using the quadratic formula $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$:\n$x = \\frac{-0.8 \\pm \\sqrt{(0.8)^2 - 4(8.2)(-1)}}{2(8.2)}$\n$x = \\frac{-0.8 \\pm \\sqrt{0.64 + 32.8}}{16.4}$\n$x = \\frac{-0.8 \\pm \\sqrt{33.44}}{16.4}$\nSince $x = I_{1/2}/K$ represents a ratio of concentrations, it must be a positive real number. We therefore take the positive root:\n$x = \\frac{-0.8 + \\sqrt{33.44}}{16.4} \\approx \\frac{-0.8 + 5.78273}{16.4} \\approx \\frac{4.98273}{16.4} \\approx 0.303825$\n\nFinally, we calculate $I_{1/2}$:\n$I_{1/2} = x \\cdot K \\approx 0.303825 \\times (1.0 \\times 10^{-7}\\,\\mathrm{M}) \\approx 3.03825 \\times 10^{-8}\\,\\mathrm{M}$\n\nThe problem asks for the answer in nanomolar (nM). We convert from M to nM:\n$1\\,\\mathrm{M} = 10^9\\,\\mathrm{nM}$\n$I_{1/2} \\approx (3.03825 \\times 10^{-8}) \\times 10^9\\,\\mathrm{nM} = 30.3825\\,\\mathrm{nM}$\n\nRounding to three significant figures, we get:\n$I_{1/2} \\approx 30.4\\,\\mathrm{nM}$",
            "answer": "$$\n\\boxed{30.4}\n$$"
        }
    ]
}