{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握协同结合的数学模型，最好的起点是将其与我们已知的知识联系起来。此练习旨在通过从第一性原理出发，严格证明经典的Michaelis-Menten酶动力学模型是希尔方程在非协同情况（即希尔系数$n=1$）下的一个特例。通过完成这个推导，你将加深对这两个基本生化模型的内在联系的理解，并为后续更复杂的协同系统分析打下坚实的基础。",
            "id": "3879836",
            "problem": "要求您从质量作用定律和质量守恒的第一性原理出发，证明在准稳态近似(QSSA)下运行的单底物酶促反应，可以用一个Hill指数等于$1$的Hill型输入-输出关系来表示。您的推导必须从基本反应机理 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 开始，其中正向结合速率常数为$k_{1}$，逆向解离速率常数为$k_{-1}$，催化速率常数为$k_{\\mathrm{cat}}$。设总酶浓度为$E_{\\mathrm{tot}}$，底物浓度为$S$，产物浓度为$P$。假设$S$是缓冲的，因此其值在$ES$形成的时间尺度上可视为常数。仅使用质量作用定律、质量守恒以及对中间体$ES$的准稳态近似(QSSA)。\n\n任务：\n1) 仅使用质量作用定律和对中间复合物的QSSA，推导产物生成速率$v$关于$k_{1}$、$k_{-1}$、$k_{\\mathrm{cat}}$、$E_{\\mathrm{tot}}$和$S$的闭式表达式。同时推导结合在复合物中的酶的无量纲分数，定义为占有率$\\theta = [ES]/E_{\\mathrm{tot}}$。\n2) 单独地，对于一个单一位点非协同结合系统（即Hill型模型中$n=1$的情况），写出与单一位点兼容的最普适的占有率函数，该函数对配体浓度是单调的，在配体浓度为零时等于$0$，并在配体趋于无穷大时趋于$1$。将该函数中的单一参数与第(1)部分中得到的动力学参数的必要组合进行辨识，使得对于所有$S \\ge 0$，归一化反应速率$v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$都等于占有率$\\theta$。\n3) 从第(1)部分的结果和您在第(2)部分中选择的单一位点占有率函数出发，通过显式的代数操作证明在第(2)部分中发现的等价性。\n4) 实现一个程序，对于下方的每个测试用例，计算：(i) 从您在第(1)部分的推导中获得的速度，(ii) 在您进行参数辨识后，由$n=1$的Hill型占有率在第(2)部分中预测的速度，以及(iii) 这两个速度之间的绝对差。程序必须将所有测试用例的输出汇总到“最终输出格式”中指定的单行中。\n\n科学真实性与单位：\n- 浓度单位必须是摩尔浓度 (mol/L)。\n- 时间单位必须是秒。\n- 速率常数：$k_{1}$的单位为$\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$，$k_{-1}$的单位为$\\mathrm{s}^{-1}$，$k_{\\mathrm{cat}}$的单位为$\\mathrm{s}^{-1}$。\n- 速率$v$必须以$\\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\mathrm{s}^{-1}$为单位，表示为十进制数。\n\n测试套件：\n使用以下参数集。每个测试用例都是一个有序元组$(k_{1}, k_{-1}, k_{\\mathrm{cat}}, E_{\\mathrm{tot}}, S)$，单位如上所述。\n- 案例 A：($1.0 \\times 10^6$, $100.0$, $50.0$, $1.0 \\times 10^{-6}$, $1.5 \\times 10^{-4}$)\n- 案例 B：($1.0 \\times 10^6$, $100.0$, $50.0$, $1.0 \\times 10^{-6}$, $0.0$)\n- 案例 C：($1.0 \\times 10^6$, $100.0$, $50.0$, $2.0 \\times 10^{-6}$, $1.0 \\times 10^{-2}$)\n- 案例 D：($1.0 \\times 10^6$, $100.0$, $0.0$, $5.0 \\times 10^{-6}$, $1.0 \\times 10^{-3}$)\n- 案例 E：($2.0 \\times 10^5$, $20.0$, $200.0$, $5.0 \\times 10^{-7}$, $1.0 \\times 10^{-3}$)\n\n对于每个案例，程序必须计算：\n- 在任务1中推导出的速率$v_{\\mathrm{QSSA}}$。\n- 在任务2中进行参数辨识后预测的速率$v_{\\mathrm{Hill}, n=1}$。\n- 绝对差$\\lvert v_{\\mathrm{QSSA}} - v_{\\mathrm{Hill}, n=1}\\rvert$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由每个案例的子列表组成的逗号分隔列表，每个子列表的顺序为$[v_{\\mathrm{QSSA}}, v_{\\mathrm{Hill}, n=1}, \\lvert v_{\\mathrm{QSSA}} - v_{\\mathrm{Hill}, n=1}\\rvert]$。整个输出必须是表示列表的列表的单行，不含空格，例如：“[[x11,x12,x13],[x21,x22,x23],...]”，其中每个$x_{ij}$都是一个十进制数。所有速率的单位均为$\\mathrm{mol}\\,\\mathrm{L}^{-1}\\,\\mathrm{s}^{-1}$。",
            "solution": "该问题被认为是有效的，因为它科学地基于化学动力学和生物医学系统建模的原理，问题陈述清晰，具有唯一且有意义的解，并且以客观的方式表达，提供了一套完整且一致的给定条件。这些任务涉及Michaelis-Menten方程的标准推导，并将其与Hill方程进行比较，这是生物化学中的一个基本概念。\n\n以下是按要求进行的逐步推导和证明。\n\n单底物酶促反应的基本反应机理如下：\n$$\nE + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\stackrel{k_{\\mathrm{cat}}}{\\longrightarrow} E + P\n$$\n其中$E$是酶，$S$是底物，$ES$是酶-底物复合物，$P$是产物。速率常数分别为$k_1$（正向结合）、$k_{-1}$（逆向解离）和$k_{\\mathrm{cat}}$（催化）。\n\n该问题要求基于三个核心原理进行推导：\n1.  质量作用定律：反应速率与反应物浓度的乘积成正比。\n2.  质量守恒：酶的总量是恒定的。\n3.  准稳态近似 (QSSA)：假设中间复合物$ES$的浓度在产物形成的时间尺度上是恒定的。\n\n**任务1：产物生成速率($v$)和占有率($\\theta$)的推导**\n\n首先，我们应用质量作用定律来写出酶-底物复合物浓度$[ES]$变化率的微分方程：\n$$\n\\frac{d[ES]}{dt} = (\\text{rate of formation of } ES) - (\\text{rate of breakdown of } ES)\n$$\n$ES$由$E$和$S$以速率常数$k_1$形成。$ES$的分解则通过两种途径发生：一是以速率常数$k_{-1}$解离回$E$和$S$，二是以速率常数$k_{\\mathrm{cat}}$催化生成$E$和$P$。由此可得：\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_{\\mathrm{cat}}[ES] = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES]\n$$\n反应速率$v$定义为产物的生成速率：\n$$\nv = \\frac{d[P]}{dt} = k_{\\mathrm{cat}}[ES]\n$$\n接下来，我们对酶应用质量守恒原理。总酶浓度$E_{\\mathrm{tot}}$是游离酶浓度$[E]$与结合在复合物中的酶浓度$[ES]$之和：\n$$\nE_{\\mathrm{tot}} = [E] + [ES]\n$$\n这使我们能够将游离酶的浓度表示为：\n$$\n[E] = E_{\\mathrm{tot}} - [ES]\n$$\n现在，我们应用准稳态近似 (QSSA)，该近似假设中间复合物$[ES]$的浓度变化远慢于底物和产物的浓度变化，因此可以认为其处于稳态，即$\\frac{d[ES]}{dt} \\approx 0$。\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\n将质量守恒定律中得到的$[E]$的表达式代入稳态方程，可得：\n$$\nk_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\n现在我们求解这个关于$[ES]$的代数方程。展开第一项：\n$$\nk_1 E_{\\mathrm{tot}}[S] - k_1 [ES][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] = 0\n$$\n将所有包含$[ES]$的项归到一边：\n$$\nk_1 E_{\\mathrm{tot}}[S] = k_1 [ES][S] + (k_{-1} + k_{\\mathrm{cat}})[ES]\n$$\n$$\nk_1 E_{\\mathrm{tot}}[S] = [ES] (k_1 [S] + k_{-1} + k_{\\mathrm{cat}})\n$$\n分离出$[ES]$：\n$$\n[ES] = \\frac{k_1 E_{\\mathrm{tot}}[S]}{k_1 [S] + k_{-1} + k_{\\mathrm{cat}}}\n$$\n为简化起见，我们将分子和分母同除以$k_1$：\n$$\n[ES] = \\frac{E_{\\mathrm{tot}}[S]}{[S] + \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}}\n$$\n我们定义Michaelis常数$K_M$为速率常数的特定组合：\n$$\nK_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}\n$$\n将$K_M$代入$[ES]$的表达式中，得到：\n$$\n[ES] = \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]}\n$$\n现在我们可以通过将此结果代入速率方程$v = k_{\\mathrm{cat}}[ES]$来推导反应速率$v$的表达式：\n$$\nv = k_{\\mathrm{cat}} \\left( \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} \\right) = \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]}\n$$\n这就是著名的Michaelis-Menten方程。当酶被底物饱和时（即当$[S] \\to \\infty$时），达到最大速率$v_{\\mathrm{max}}$，此时$v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$。\n\n最后，我们推导无量纲的占有率$\\theta$，其定义为结合在复合物中的酶的分数：\n$$\n\\theta = \\frac{[ES]}{E_{\\mathrm{tot}}}\n$$\n代入$[ES]$的表达式：\n$$\n\\theta = \\frac{1}{E_{\\mathrm{tot}}} \\left( \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} \\right) = \\frac{[S]}{K_M + [S]}\n$$\n至此，任务1的推导完成。\n\n**任务2：单一位点占有率函数与参数辨识**\n\nHill方程描述了协同结合。对于一个具有$n$个结合位点的通用情况，占有率$\\theta$作为配体浓度$[S]$的函数由下式给出：\n$$\n\\theta([S]) = \\frac{[S]^n}{K_d^n + [S]^n}\n$$\n其中$n$是Hill指数，$K_d$是表观解离常数。单一位点非协同结合系统对应于Hill指数$n=1$的情况。因此，占有率函数为：\n$$\n\\theta([S]) = \\frac{[S]}{K_d + [S]}\n$$\n该函数满足所要求的性质：\n- 它对$[S]$是单调的。\n- 在配体浓度为零时，$\\theta(0) = 0$。\n- 在高配体浓度下饱和，$\\lim_{[S]\\to\\infty} \\theta([S]) = 1$。\n该模型中的单一参数是解离常数$K_d$。\n\n问题要求我们通过将占有率$\\theta$与归一化反应速率$\\frac{v}{v_{\\mathrm{max}}}$相等来辨识参数$K_d$。根据任务1，我们有$v = \\frac{v_{\\mathrm{max}}[S]}{K_M + [S]}$，其中$v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$。\n归一化速率为：\n$$\n\\frac{v}{v_{\\mathrm{max}}} = \\frac{1}{v_{\\mathrm{max}}} \\left( \\frac{v_{\\mathrm{max}}[S]}{K_M + [S]} \\right) = \\frac{[S]}{K_M + [S]}\n$$\n将$n=1$的Hill占有率函数与此归一化速率相等：\n$$\n\\frac{[S]}{K_d + [S]} = \\frac{[S]}{K_M + [S]}\n$$\n为使此等式对所有底物浓度$[S] \\ge 0$成立，分母中的参数必须相等。因此，我们将结合模型中的解离常数$K_d$与动力学模型中的Michaelis常数$K_M$进行辨识：\n$$\nK_d = K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}\n$$\n这一辨识表明，Michaelis-Menten动力学模型在数学上是$n=1$时Hill模型的一个特例。\n\n**任务3：等价性证明**\n\n我们被要求通过显式的代数操作来证明任务2中发现的等价性。目标是证明从QSSA推导出的归一化反应速率与单一位点Hill模型预测的占有率是相同的。\n\n1.  根据任务1中的QSSA推导，反应速率为$v_{\\mathrm{QSSA}} = \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]}$。\n2.  由单一位点Hill模型预测的速率$v_{\\mathrm{Hill}, n=1}$是最大可能速率$v_{\\mathrm{max}}$与$n=1$时的Hill占有率函数$\\theta([S])$的乘积：\n    $$\n    v_{\\mathrm{Hill}, n=1} = v_{\\mathrm{max}} \\cdot \\theta([S])\n    $$\n3.  最大速率为$v_{\\mathrm{max}} = k_{\\mathrm{cat}}E_{\\mathrm{tot}}$。单一位点Hill占有率函数为$\\theta([S]) = \\frac{[S]}{K_d + [S]}$。因此：\n    $$\n    v_{\\mathrm{Hill}, n=1} = (k_{\\mathrm{cat}}E_{\\mathrm{tot}}) \\left(\\frac{[S]}{K_d + [S]}\\right)\n    $$\n4.  应用任务2中的参数辨识，我们令$K_d = K_M$：\n    $$\n    v_{\\mathrm{Hill}, n=1} = \\frac{k_{\\mathrm{cat}}E_{\\mathrm{tot}}[S]}{K_M + [S]}\n    $$\n5.  将此表达式与从QSSA推导出的表达式进行比较：\n    $$\n    v_{\\mathrm{QSSA}} = \\frac{k_{\\mathrm{cat}}E_{\\mathrm{tot}}[S]}{K_M + [S]}\n    $$\n    这两个表达式在代数上是完全相同的。因此，在给定辨识$K_d = K_M$的条件下，我们已明确证明$v_{\\mathrm{QSSA}} = v_{\\mathrm{Hill}, n=1}$。这证实了在QSSA下的单底物酶动力学可以用一个Hill指数为$n=1$的Hill型关系来表示。证毕。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes enzyme reaction velocities based on Michaelis-Menten kinetics (derived from QSSA)\n    and a corresponding Hill n=1 model, and calculates the absolute difference.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k1, k_neg1, k_cat, E_tot, S)\n    test_cases = [\n        (1.0e6, 100.0, 50.0, 1.0e-6, 1.5e-4),   # Case A\n        (1.0e6, 100.0, 50.0, 1.0e-6, 0.0),      # Case B\n        (1.0e6, 100.0, 50.0, 2.0e-6, 1.0e-2),   # Case C\n        (1.0e6, 100.0, 0.0, 5.0e-6, 1.0e-3),    # Case D\n        (2.0e5, 20.0, 200.0, 5.0e-7, 1.0e-3)    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        k1, k_neg1, k_cat, E_tot, S = case\n\n        # The derivation shows that the underlying mathematical expressions for\n        # v_QSSA and v_Hill_n=1 are identical. The calculation is performed once.\n        \n        # Avoid division by zero if k1 is zero.\n        if k1 == 0:\n            # If k1 is 0, no complex can form, so velocity is 0. K_M would be infinite.\n            # This case is not in the test suite but is good practice.\n            v = 0.0\n        else:\n            # Calculate the Michaelis constant, K_M\n            # K_M has units of concentration (mol/L)\n            K_M = (k_neg1 + k_cat) / k1\n\n            # Calculate the maximum velocity, v_max\n            # v_max has units of mol L^-1 s^-1\n            v_max = k_cat * E_tot\n\n            # Calculate the reaction velocity using the Michaelis-Menten equation\n            # Denominator cannot be zero since S >= 0 and K_M > 0 for non-zero rates.\n            v = v_max * S / (K_M + S)\n\n        v_qssa = v\n        v_hill_n1 = v\n        \n        # Calculate the absolute difference. Due to identical algebraic forms,\n        # this should be 0.0, subject to floating-point precision.\n        abs_diff = np.abs(v_qssa - v_hill_n1)\n\n        results.append([v_qssa, v_hill_n1, abs_diff])\n\n    # Format the final output string as a list of lists with no spaces.\n    # str(results) produces a string like '[[...], [...]]' with spaces.\n    # We remove the spaces to match the required format.\n    final_output_string = str(results).replace(\" \", \"\")\n\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型的力量在于其能够解释和量化实验数据。本练习将引导你掌握一项核心的生物物理数据分析技能：使用希尔图（Hill plot）分析法从配体结合数据中提取关键参数。你将学习如何通过对希尔方程进行线性化转换，从实验曲线中估算出希尔系数$n$和表观解离常数$K_d$，从而量化协同性的强度和配体亲和力。",
            "id": "3879800",
            "problem": "一个处于等温平衡状态的受体-配体系统被观察到，其中受体 $R$ 可以与配体 $L$ 结合，并表现出协同特性。设分数占据率为 $Y \\in (0,1)$，定义为平衡时被占据的结合位点的比例。本问题的基础是应用于化学平衡的热力学质量作用定律以及分数占据率的定义。请仅以此为基础，推导用于希尔图（Hill plot）的线性化方法，该方法在协同结合模型下捕捉了 $Y$ 与配体浓度 $[L]$ 之间的关系，并解释如何从此线性化关系中估计希尔系数 $n$ 和表观解离常数 $K_d$。然后，用代码实现所推导的方法，以分析以下数据集。\n\n你的算法必须：\n- 使用分数占据率 $Y$ 的定义和质量作用平衡来证明一个变换的合理性，该变换能产生一个关于 $Y$ 和 $[L]$ 的适当组合的对数（$\\log$）的线性关系，且该关系适用于普通最小二乘法（Ordinary Least Squares, OLS）估计。此处，普通最小二乘法（OLS）指在线性模型中最小化残差平方和的方法。\n- 除非另有明确说明，否则一律使用自然对数 $\\log$（以 $e$ 为底）。\n- 通过在应用任何对数变换之前，将 $Y$ 裁剪到开放区间 $(\\varepsilon, 1-\\varepsilon)$（其中 $\\varepsilon = 10^{-12}$）内，来处理当 $Y$ 接近 $0$ 或 $1$ 时出现的数值奇异点。\n- 从所选希尔图坐标系中拟合直线的斜率和截距估计希尔系数 $n$ 和表观解离常数 $K_d$。\n- 以摩尔单位 $M$ 报告 $K_d$。\n\n测试套件（每个案例提供以 $M$ 为单位的 $[L]$ 和无量纲的分数占据率 $Y$）：\n- 案例1（基线，近似非协同行为）：$[L] = [\\,10^{-8},\\,5\\times 10^{-8},\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6},\\,5\\times 10^{-6}\\,]$，$Y = [\\,0.019608,\\,0.090909,\\,0.166667,\\,0.500000,\\,0.666667,\\,0.909091\\,]$。\n- 案例2（正协同性）：$[L] = [\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6},\\,2\\times 10^{-6},\\,5\\times 10^{-6},\\,10^{-5}\\,]$，$Y = [\\,0.002494,\\,0.058824,\\,0.200000,\\,0.500000,\\,0.862069,\\,0.961538\\,]$。\n- 案例3（负协同性）：$[L] = [\\,10^{-9},\\,10^{-8},\\,10^{-7},\\,10^{-6},\\,10^{-5}\\,]$，$Y = [\\,0.030657,\\,0.090909,\\,0.240253,\\,0.500000,\\,0.759141\\,]$。\n- 案例4（边缘极端情况）：$[L] = [\\,10^{-9},\\,5\\times 10^{-9},\\,10^{-7},\\,5\\times 10^{-7},\\,10^{-6}\\,]$，$Y = [\\,0.000001,\\,0.000125,\\,0.500000,\\,0.992063,\\,0.999001\\,]$。\n- 案例5（稀疏采样）：$[L] = [\\,10^{-6},\\,3\\times 10^{-6},\\,10^{-5}\\,]$，$Y = [\\,0.161398,\\,0.500000,\\,0.858026\\,]$。\n\n你的程序应该：\n- 根据你为每个案例推导的线性化方法构建希尔图。\n- 在变换后的坐标系中使用 OLS 拟合一条直线。\n- 按顺序为每个案例返回估计的希尔系数 $n$ 和以 $M$ 为单位的表观解离常数 $K_d$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须是扁平化的，即对于案例1，你输出 $n$ 后跟 $K_d$，然后对于案例2，输出 $n$ 后跟 $K_d$，依此类推。例如，格式为 $[n_1, K_{d,1}, n_2, K_{d,2}, \\dots]$。",
            "solution": "该问题要求从质量作用定律出发，推导用于希尔图的线性化方法，并解释如何从中估计希尔系数 $n$ 和表观解离常数 $K_d$。该模型的基础是配体 $L$ 与受体 $R$ 的协同结合。\n\n我们首先将 $n$ 个配体分子与一个受体 $R$ 的结合，在唯象上建模为一个协同步骤：\n$$ R + nL \\rightleftharpoons RL_n $$\n该反应假设受体上的所有 $n$ 个结合位点要么同时为空，要么同时被占据。虽然这是一种简化，但它为协同结合提供了一个有用的宏观描述。\n\n根据质量作用定律，在平衡状态下，宏观结合常数 $K_a$ 由产物浓度与反应物浓度的比值给出：\n$$ K_a = \\frac{[RL_n]}{[R][L]^n} $$\n通常使用宏观解离常数 $K_D$ 更为方便，它是 $K_a$ 的倒数：\n$$ K_D = \\frac{1}{K_a} = \\frac{[R][L]^n}{[RL_n]} $$\n\n分数占据率 $Y$ 定义为被配体占据的受体总结合位点的比例。在这个“全或无”模型中，被占据位点的浓度由完全结合的复合物浓度 $[RL_n]$ 表示，而受体位点的总浓度与总受体浓度 $[R]_{\\text{total}} = [R] + [RL_n]$ 成正比。因此，分数占据率为：\n$$ Y = \\frac{[RL_n]}{[R]_{\\text{total}}} = \\frac{[RL_n]}{[R] + [RL_n]} $$\n\n为了将 $Y$ 表示为配体浓度 $[L]$ 的函数，我们可以重排 $K_D$ 的平衡表达式，以求解游离受体浓度 $[R]$：\n$$ [R] = \\frac{K_D [RL_n]}{[L]^n} $$\n将这个 $[R]$ 的表达式代入 $Y$ 的方程中：\n$$ Y = \\frac{[RL_n]}{\\frac{K_D [RL_n]}{[L]^n} + [RL_n]} $$\n我们可以消去分子和分母中的 $[RL_n]$ 项：\n$$ Y = \\frac{1}{\\frac{K_D}{[L]^n} + 1} = \\frac{[L]^n}{K_D + [L]^n} $$\n该方程是希尔方程的一种形式。常数 $K_D$ 与导致半数最大占据率时的配体浓度有关。我们精确地将表观解离常数 $K_d$ 定义为该浓度：即当 $Y=0.5$ 时的 $[L]$ 值。将 $Y=0.5$ 和 $[L]=K_d$ 代入方程：\n$$ 0.5 = \\frac{K_d^n}{K_D + K_d^n} \\implies 0.5(K_D + K_d^n) = K_d^n \\implies 0.5 K_D = 0.5 K_d^n \\implies K_D = K_d^n $$\n通过将 $K_D = K_d^n$ 代回我们的 $Y$ 方程，我们得到了以表观解离常数 $K_d$ 表示的标准希尔方程：\n$$ Y = \\frac{[L]^n}{K_d^n + [L]^n} $$\n此处，$n$ 是希尔系数，用于量化协同程度（$n>1$ 表示正协同性，$n1$ 表示负协同性，$n=1$ 表示非协同结合），而 $K_d$ 是产生半数占据率时的配体浓度。\n\n为了从实验数据 $([L]_i, Y_i)$ 中估计 $n$ 和 $K_d$，我们必须首先对希尔方程进行线性化。我们可以重排该方程以表示已占据位点与未占据位点的比率：\n$$ Y(K_d^n + [L]^n) = [L]^n $$\n$$ Y K_d^n = [L]^n - Y[L]^n = [L]^n(1-Y) $$\n$$ \\frac{Y}{1-Y} = \\frac{[L]^n}{K_d^n} = \\left(\\frac{[L]}{K_d}\\right)^n $$\n项 $Y/(1-Y)$ 被称为结合优势比。对两边取自然对数（按题目要求），得到一个线性关系：\n$$ \\log\\left(\\frac{Y}{1-Y}\\right) = \\log\\left(\\left(\\frac{[L]}{K_d}\\right)^n\\right) $$\n$$ \\log\\left(\\frac{Y}{1-Y}\\right) = n \\log\\left(\\frac{[L]}{K_d}\\right) = n\\log([L]) - n\\log(K_d) $$\n该方程具有直线形式 $y_{\\text{fit}} = m x_{\\text{fit}} + c$，这是希尔图的基础。我们可以确定其组成部分：\n- 因变量是 $y_{\\text{fit}} = \\log\\left(\\frac{Y}{1-Y}\\right)$。\n- 自变量是 $x_{\\text{fit}} = \\log([L])$。\n- 斜率是 $m = n$。\n- y轴截距是 $c = -n\\log(K_d)$。\n\n给定一组实验数据点 $([L]_i, Y_i)$，我们首先将它们转换为坐标 $(x_{\\text{fit}, i}, y_{\\text{fit}, i}) = (\\log([L]_i), \\log(Y_i/(1-Y_i)))$。一个实际的考虑是，当 $Y$ 的值非常接近 $0$ 或 $1$ 时，项 $\\log(Y/(1-Y))$ 将分别趋近于 $-\\infty$ 或 $+\\infty$。为避免数值不稳定，我们首先将观测到的 $Y$ 值裁剪到一个远离边界的、机器可表示的小区间内，例如 $(\\varepsilon, 1-\\varepsilon)$，其中 $\\varepsilon$ 是一个小的正数。题目指定使用 $\\varepsilon = 10^{-12}$。\n\n利用变换后的数据，我们可以执行普通最小二乘法（OLS）线性回归，以找到最小化残差平方和的最佳拟合斜率 $\\hat{m}$ 和截距 $\\hat{c}$。根据这些拟合参数，我们估计希尔参数：\n1. 希尔系数 $n$ 直接从斜率估计：\n   $$ \\hat{n} = \\hat{m} $$\n2. 表观解离常数 $K_d$ 从斜率和截距估计。从 $\\hat{c} = -\\hat{n}\\log(\\hat{K}_d)$，我们可以解出 $\\hat{K}_d$：\n   $$ \\log(\\hat{K}_d) = -\\frac{\\hat{c}}{\\hat{n}} $$\n   $$ \\hat{K}_d = \\exp\\left(-\\frac{\\hat{c}}{\\hat{m}}\\right) $$\n\n代码中实现的算法对每个提供的数据集都遵循这些步骤。它将原始的 $([L], Y)$ 数据转换为线性的希尔图坐标 $(\\log([L]), \\log(Y/(1-Y)))$，执行 OLS 拟合以提取斜率和截距，然后使用上述推导的关系计算 $n$ 和 $K_d$ 的估计值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives Hill plot parameters (n, Kd) for several receptor-ligand binding datasets.\n    \"\"\"\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"L\": np.array([1e-8, 5e-8, 1e-7, 5e-7, 1e-6, 5e-6]),\n            \"Y\": np.array([0.019608, 0.090909, 0.166667, 0.500000, 0.666667, 0.909091])\n        },\n        {\n            \"L\": np.array([1e-7, 5e-7, 1e-6, 2e-6, 5e-6, 1e-5]),\n            \"Y\": np.array([0.002494, 0.058824, 0.200000, 0.500000, 0.862069, 0.961538])\n        },\n        {\n            \"L\": np.array([1e-9, 1e-8, 1e-7, 1e-6, 1e-5]),\n            \"Y\": np.array([0.030657, 0.090909, 0.240253, 0.500000, 0.759141])\n        },\n        {\n            \"L\": np.array([1e-9, 5e-9, 1e-7, 5e-7, 1e-6]),\n            \"Y\": np.array([0.000001, 0.000125, 0.500000, 0.992063, 0.999001])\n        },\n        {\n            \"L\": np.array([1e-6, 3e-6, 1e-5]),\n            \"Y\": np.array([0.161398, 0.500000, 0.858026])\n        }\n    ]\n\n    results = []\n    epsilon = 1e-12\n\n    for case in test_cases:\n        L = case[\"L\"]\n        Y = case[\"Y\"]\n\n        # 1. Clip Y to avoid numerical singularities at 0 and 1\n        Y_clipped = np.clip(Y, epsilon, 1 - epsilon)\n\n        # 2. Transform data for Hill plot\n        # x_fit = log([L])\n        # y_fit = log(Y / (1 - Y))\n        x_fit = np.log(L)\n        y_fit = np.log(Y_clipped / (1 - Y_clipped))\n\n        # 3. Perform Ordinary Least Squares (OLS) linear regression\n        # y_fit = m * x_fit + c\n        # We need to find slope m and intercept c.\n        N = len(x_fit)\n        sum_x = np.sum(x_fit)\n        sum_y = np.sum(y_fit)\n        sum_xy = np.sum(x_fit * y_fit)\n        sum_x2 = np.sum(x_fit * x_fit)\n\n        # Calculate slope (m) and intercept (c) using standard OLS formulas\n        # m = (N * sum(xy) - sum(x) * sum(y)) / (N * sum(x^2) - (sum(x))^2)\n        # c = (sum(y) - m * sum(x)) / N\n        denominator = N * sum_x2 - sum_x**2\n        if np.abs(denominator)  1e-15:\n            # This would occur if all log([L]) values are identical, which is\n            # not the case here but is a necessary check for robust code.\n            # The slope is effectively infinite or undefined.\n            m = np.inf\n            c = np.nan\n        else:\n            m = (N * sum_xy - sum_x * sum_y) / denominator\n            c = (sum_y - m * sum_x) / N\n\n        # 4. Estimate Hill parameters n and Kd\n        # n = m\n        # Kd = exp(-c / m)\n        n = m\n        \n        if np.abs(m)  1e-15:\n            # If slope is zero, Kd is undefined in this formulation.\n            Kd = np.nan \n        else:\n            Kd = np.exp(-c / m)\n\n        results.extend([n, Kd])\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "协同结合不仅限于底物激活，它在变构抑制等药物作用机制中也扮演着核心角色。这个高级练习挑战你运用统计热力学原理，为具有多个抑制剂结合位点的酶构建一个协同抑制模型。通过推导归一化酶活性与抑制剂浓度的关系，并计算半数抑制浓度（$I_{1/2}$），你将学会如何将抽象的协同作用参数（如$\\omega$和$\\beta$）与可测量的宏观药效联系起来。",
            "id": "3879824",
            "problem": "一种酶 $E$ 参与一个催化反应，在没有抑制剂存在时，其初始速率为 $v_{0}$。该酶具有两个相同的变构抑制剂结合位点，用于结合小分子抑制剂 $I$。结合处于热力学平衡状态，且抑制剂浓度远大于总酶浓度，因此游离抑制剂浓度等于总抑制剂浓度。结合到同一酶上的两个抑制剂分子之间的协同相互作用通过一个相互作用参数 $\\omega$ 进行建模，具体如下：双占据状态的统计权重相对于两个独立位点所预期的值乘以 $\\omega$。与未占据位点结合的解离常数为 $K$。单占据状态具有双重组合多样性，因为有两个等效位点。\n\n假设采用以下活性模型：如果有 $n \\in \\{0,1,2\\}$ 个抑制剂分子与一个酶分子结合，其催化活性相对于未受抑制的活性会以乘法方式降低一个因子 $\\beta^{n}$，其中 $0  \\beta  1$ 是一个表征每个位点抑制效力的固定数值。令 $a(I)$ 表示在抑制剂浓度为 $I$ 时的标准化活性 $v(I)/v_{0}$。\n\n从基本平衡结合和统计热力学（结合多项式和微观状态概率）出发，推导 $a(I)$ 关于 $I$、$K$、$\\beta$ 和 $\\omega$ 的表达式，然后确定抑制剂浓度 $I_{1/2}$，使得 $a(I_{1/2}) = \\tfrac{1}{2}$。\n\n使用参数值 $K = 1.0 \\times 10^{-7}\\,\\mathrm{M}$，$\\beta = 0.30$ 和 $\\omega = 10$。以纳摩尔（nM）为单位表示你最终的 $I_{1/2}$，并将答案四舍五入到三位有效数字。最终答案必须是一个实数。",
            "solution": "该问题要求推导标准化酶活性 $a(I)$ 作为抑制剂浓度 $I$ 的函数，并随后计算半数抑制浓度 $I_{1/2}$。\n\n首先，我们基于统计热力学建立抑制剂结合模型。酶 $E$ 具有两个相同且可区分的抑制剂 $I$ 结合位点。在平衡状态下存在三种可能的物种：$E$（未结合抑制剂）、$EI$（结合一个抑制剂）和 $EI_2$（结合两个抑制剂）。我们定义这些物种相对于未结合的酶 $E$ 的统计权重，其中 $E$ 的权重取为 $1$。\n\n令 $[I]$ 为游离抑制剂浓度，$K$ 为抑制剂与一个未占据位点结合的解离常数。问题陈述 $[I]$ 远大于总酶浓度，因此我们可以将 $[I]$ 视为一个恒定参数，记为 $I$。\n\n1.  **$E$ 的统计权重（$n=0$ 个抑制剂的状态）：**\n    根据定义，统计权重为 $w_0 = 1$。\n\n2.  **$EI$ 的统计权重（$n=1$ 个抑制剂的状态）：**\n    第一个抑制剂可以结合到两个相同的位点上。问题陈述了“双重组合多样性”。对于每个位点，结合平衡为 $E + I \\rightleftharpoons EI_{\\text{site}}$。单个位点的结合常数为 $1/K$。由于有两个位点，相对于游离酶的统计权重是结合到每个位点权重的总和，即 $w_1 = \\binom{2}{1} \\frac{I}{K} = 2\\frac{I}{K}$。\n\n3.  **$EI_2$ 的统计权重（$n=2$ 个抑制剂的状态）：**\n    对于两个独立且相同的位点，结合两个抑制剂的统计权重将是 $(\\frac{I}{K})^2$。问题引入了一个协同相互作用参数 $\\omega$，指出双占据状态的统计权重乘以 $\\omega$。因此，权重为 $w_2 = \\binom{2}{2} \\omega (\\frac{I}{K})^2 = \\omega (\\frac{I}{K})^2$。\n\n作为系统配分函数的结合多项式 $P(I)$ 是所有统计权重的总和：\n$$P(I) = w_0 + w_1 + w_2 = 1 + 2\\frac{I}{K} + \\omega \\left(\\frac{I}{K}\\right)^2$$\n\n处于各种状态的酶分子比例 ($p_n$) 是该状态的统计权重除以结合多项式：\n$p_0 = \\frac{w_0}{P(I)} = \\frac{1}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n$p_1 = \\frac{w_1}{P(I)} = \\frac{2\\frac{I}{K}}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n$p_2 = \\frac{w_2}{P(I)} = \\frac{\\omega (\\frac{I}{K})^2}{1 + 2\\frac{I}{K} + \\omega (\\frac{I}{K})^2}$\n\n总催化速率 $v(I)$ 是每种物种活性的加权和。具有 $n$ 个抑制剂的酶的活性由 $\\beta^n v_0$ 给出，其中 $v_0$ 是未受抑制的速率，且 $0  \\beta  1$。\n$v(I) = p_0 \\cdot (\\beta^0 v_0) + p_1 \\cdot (\\beta^1 v_0) + p_2 \\cdot (\\beta^2 v_0)$\n$v(I) = v_0 (p_0 + \\beta p_1 + \\beta^2 p_2)$\n\n标准化活性 $a(I)$ 为 $v(I)/v_0$：\n$a(I) = p_0 + \\beta p_1 + \\beta^2 p_2$\n代入 $p_n$ 的表达式：\n$$a(I) = \\frac{1 + \\beta \\left(2\\frac{I}{K}\\right) + \\beta^2 \\left(\\omega \\left(\\frac{I}{K}\\right)^2\\right)}{1 + 2\\frac{I}{K} + \\omega \\left(\\frac{I}{K}\\right)^2}$$\n这就是推导出的 $a(I)$ 的表达式。\n\n接下来，我们确定标准化活性为 $a(I_{1/2}) = \\frac{1}{2}$ 时的抑制剂浓度 $I_{1/2}$。\n令 $x = \\frac{I_{1/2}}{K}$。方程变为：\n$$\\frac{1 + 2\\beta x + \\omega\\beta^2 x^2}{1 + 2x + \\omega x^2} = \\frac{1}{2}$$\n交叉相乘得到：\n$2(1 + 2\\beta x + \\omega\\beta^2 x^2) = 1 + 2x + \\omega x^2$\n$2 + 4\\beta x + 2\\omega\\beta^2 x^2 = 1 + 2x + \\omega x^2$\n整理各项，形成一个标准的二次方程 $Ax^2 + Bx + C = 0$：\n$(2\\omega\\beta^2 - \\omega)x^2 + (4\\beta - 2)x + (2 - 1) = 0$\n$$\\omega(2\\beta^2 - 1)x^2 + 2(2\\beta - 1)x + 1 = 0$$\n\n现在，我们代入给定的参数值：$K = 1.0 \\times 10^{-7}\\,\\mathrm{M}$，$\\beta = 0.30$ 和 $\\omega = 10$。\n首先，计算二次方程的系数：\n$A = \\omega(2\\beta^2 - 1) = 10(2(0.30)^2 - 1) = 10(2(0.09) - 1) = 10(0.18 - 1) = 10(-0.82) = -8.2$\n$B = 2(2\\beta - 1) = 2(2(0.30) - 1) = 2(0.6 - 1) = 2(-0.4) = -0.8$\n$C = 1$\n方程为 $-8.2x^2 - 0.8x + 1 = 0$，等价于 $8.2x^2 + 0.8x - 1 = 0$。\n\n我们使用二次方程求根公式 $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解 $x$：\n$x = \\frac{-0.8 \\pm \\sqrt{(0.8)^2 - 4(8.2)(-1)}}{2(8.2)}$\n$x = \\frac{-0.8 \\pm \\sqrt{0.64 + 32.8}}{16.4}$\n$x = \\frac{-0.8 \\pm \\sqrt{33.44}}{16.4}$\n由于 $x = I_{1/2}/K$ 代表浓度之比，它必须是一个正实数。因此，我们取正根：\n$x = \\frac{-0.8 + \\sqrt{33.44}}{16.4} \\approx \\frac{-0.8 + 5.78273}{16.4} \\approx \\frac{4.98273}{16.4} \\approx 0.303825$\n\n最后，我们计算 $I_{1/2}$：\n$I_{1/2} = x \\cdot K \\approx 0.303825 \\times (1.0 \\times 10^{-7}\\,\\mathrm{M}) \\approx 3.03825 \\times 10^{-8}\\,\\mathrm{M}$\n\n问题要求答案以纳摩尔（nM）为单位。我们将 M 转换为 nM：\n$1\\,\\mathrm{M} = 10^9\\,\\mathrm{nM}$\n$I_{1/2} \\approx (3.03825 \\times 10^{-8}) \\times 10^9\\,\\mathrm{nM} = 30.3825\\,\\mathrm{nM}$\n\n四舍五入到三位有效数字，我们得到：\n$I_{1/2} \\approx 30.4\\,\\mathrm{nM}$",
            "answer": "$$\n\\boxed{30.4}\n$$"
        }
    ]
}