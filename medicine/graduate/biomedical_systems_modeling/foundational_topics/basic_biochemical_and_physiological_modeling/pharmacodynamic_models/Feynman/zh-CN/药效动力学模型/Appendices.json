{
    "hands_on_practices": [
        {
            "introduction": "许多药物通过与受体结合来发挥作用。这项练习将引导你从基本原理出发，推导竞争性拮抗剂如何影响激动剂的效力。理解激动剂-拮抗剂的相互作用是药理学的基石，通过本练习，你将亲手计算拮抗剂存在时激动剂剂量-效应曲线的变化，从而加深对药物竞争性结合模型的理解。",
            "id": "3917700",
            "problem": "受体介导的药物反应通过质量作用定律下的竞争性结合方案进行建模。一种激动剂（浓度表示为 $C$）与单一受体群体 $R$ 结合，形成复合物 $AR$，其平衡结合常数 $K_{A}$ 定义为 $K_{A} = \\dfrac{[R][A]}{[AR]}$。一种竞争性拮抗剂（浓度表示为 $I$）与同一位点结合，形成 $IR$，其抑制常数 $K_{i}$ 定义为 $K_{i} = \\dfrac{[R][I]}{[IR]}$。假设快速平衡、单一结合位点、无协同性、无备用受体，并且效应与激动剂的受体占据分数成正比。在这些假设下，最大效应的分数等于激动剂占据的受体分数。\n\n已知在没有拮抗剂的情况下，激动剂的半数有效浓度 ($EC_{50}$) 为 $1$ mg/L，且希尔系数 (Hill coefficient) 为 $1$，因此在所述假设下 $EC_{50} = K_{A}$。一种竞争性拮抗剂以恒定浓度 $I = 1$ mg/L 与抑制常数 $K_{i} = 0.5$ mg/L 共同给药。\n\n仅使用质量作用定律、受体的质量平衡以及半数有效浓度的定义（在指定条件下产生最大效应一半的激动剂浓度），推导出存在拮抗剂时的表观半数有效浓度（记为 $EC_{50}'$），然后计算在激动剂浓度 $C = 1$ mg/L 时的相对效应（作为存在拮抗剂时最大效应的无量纲分数）。\n\n提供两个结果的精确值，不要四舍五入。将 $EC_{50}'$ 以 mg/L 表示，相对效应以不带百分号的小数表示。你最终报告的答案应按顺序 $\\big(EC_{50}', \\text{在 } C=1\\ \\text{mg/L} \\text{ 时的相对效应}\\big)$ 包含这两个值。",
            "solution": "该问题经核实具有科学依据，提法明确且客观。问题陈述中存在一个微小的术语不一致之处，$K_A$ 被称为“结合常数”，但其数学定义却是解离常数的公式，$K_A = \\frac{[R][A]}{[AR]}$。然而，后续的陈述 $EC_{50} = K_A$ 阐明了其预期含义，因为在这个简单的结合模型中，半数有效浓度等同于解离常数。因此，该问题可以使用所提供的数学定义来解决。\n\n设 $C$ 为激动剂浓度，$I$ 为拮抗剂浓度。设 $[R]$ 为游离受体浓度，$[AR]$ 为激动剂-受体复合物浓度，$[IR]$ 为拮抗剂-受体复合物浓度。总受体浓度 $[R_T]$ 是恒定的。\n\n受体的质量平衡方程为：\n$$[R_T] = [R] + [AR] + [IR]$$\n\n根据问题陈述，效应 ($E$) 与最大效应 ($E_{max}$) 之间的关系与激动剂的受体占据分数成正比。设此占据分数为 $\\theta_C$。\n$$\\frac{E}{E_{max}} = \\theta_C = \\frac{[AR]}{[R_T]}$$\n\n激动剂的平衡解离常数（记为 $K_A$）和拮抗剂的抑制常数（记为 $K_i$）由质量作用定律给出如下：\n$$K_A = \\frac{[R]C}{[AR]} \\quad \\implies \\quad [AR] = \\frac{[R]C}{K_A}$$\n$$K_i = \\frac{[R]I}{[IR]} \\quad \\implies \\quad [IR] = \\frac{[R]I}{K_i}$$\n请注意，为与问题中激动剂浓度的其余符号保持一致，问题中 $K_A$ 定义里的符号 $A$ 已被替换为 $C$。\n\n我们可以通过将 $[AR]$ 和 $[IR]$ 的表达式代入质量平衡方程，用游离受体浓度 $[R]$ 来表示总受体浓度 $[R_T]$：\n$$[R_T] = [R] + \\frac{[R]C}{K_A} + \\frac{[R]I}{K_i}$$\n提取公因子 $[R]$ 得：\n$$[R_T] = [R] \\left( 1 + \\frac{C}{K_A} + \\frac{I}{K_i} \\right)$$\n\n现在，我们可以写出占据分数 $\\theta_C$ 的表达式：\n$$\\theta_C = \\frac{[AR]}{[R_T]} = \\frac{\\frac{[R]C}{K_A}}{[R] \\left( 1 + \\frac{C}{K_A} + \\frac{I}{K_i} \\right)}$$\n分子和分母中的项 $[R]$ 被消去：\n$$\\theta_C = \\frac{\\frac{C}{K_A}}{1 + \\frac{C}{K_A} + \\frac{I}{K_i}}$$\n为简化此表达式，我们将分子和分母同乘以 $K_A$：\n$$\\theta_C = \\frac{C}{K_A \\left( 1 + \\frac{C}{K_A} + \\frac{I}{K_i} \\right)} = \\frac{C}{K_A + C + K_A \\frac{I}{K_i}}$$\n重新排列分母中的项，得到剂量-反应关系：\n$$\\theta_C = \\frac{C}{C + K_A \\left( 1 + \\frac{I}{K_i} \\right)}$$\n\n表观半数有效浓度 $EC_{50}'$ 是产生最大效应一半时的激动剂浓度 $C$，这对应于占据分数 $\\theta_C = \\frac{1}{2}$。我们设 $C = EC_{50}'$ 和 $\\theta_C = \\frac{1}{2}$：\n$$\\frac{1}{2} = \\frac{EC_{50}'}{EC_{50}' + K_A \\left( 1 + \\frac{I}{K_i} \\right)}$$\n求解 $EC_{50}'$：\n$$EC_{50}' + K_A \\left( 1 + \\frac{I}{K_i} \\right) = 2 \\cdot EC_{50}'$$\n$$EC_{50}' = K_A \\left( 1 + \\frac{I}{K_i} \\right)$$\n这是第一个需要推导的公式。现在，我们计算其数值。\n\n问题提供了以下数值：\n$EC_{50} = 1$ mg/L。由于希尔系数为 $1$ 且没有备用受体，所以 $K_A = EC_{50} = 1$ mg/L。\n拮抗剂浓度为 $I = 1$ mg/L。\n抑制常数为 $K_i = 0.5$ mg/L。\n\n将这些值代入 $EC_{50}'$ 的表达式中：\n$$EC_{50}' = (1 \\text{ mg/L}) \\left( 1 + \\frac{1 \\text{ mg/L}}{0.5 \\text{ mg/L}} \\right)$$\n$$EC_{50}' = 1 \\cdot (1 + 2) = 3 \\text{ mg/L}$$\n\n第二个任务是计算在有拮抗剂存在的情况下，当激动剂浓度 $C = 1$ mg/L 时的相对效应。相对效应等于占据分数 $\\theta_C$。我们使用推导出的剂量-反应方程和已知数值：\n$$\\text{相对效应} = \\theta_C = \\frac{C}{C + K_A \\left( 1 + \\frac{I}{K_i} \\right)}$$\n项 $K_A \\left( 1 + \\frac{I}{K_i} \\right)$ 正是我们刚刚计算出的表观 $EC_{50}'$。\n$$\\text{相对效应} = \\frac{C}{C + EC_{50}'}$$\n代入 $C = 1$ mg/L 和 $EC_{50}' = 3$ mg/L：\n$$\\text{相对效应} = \\frac{1}{1 + 3} = \\frac{1}{4} = 0.25$$\n\n所需的两个值是表观半数有效浓度 $EC_{50}'$ 和在 $C=1$ mg/L 时的相对效应。\n$EC_{50}' = 3$ mg/L。\n在 $C=1$ mg/L 时的相对效应 = $0.25$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3  0.25 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "药物效应的产生和消退通常存在时间延迟，并非瞬时发生。本练习将介绍间接效应模型，这是一种广泛用于描述血药浓度变化与生理效应之间时滞的强大工具。通过模拟这一模型，你将发现一阶线性系统的一个基本特性，并深入理解药物作用的时间动态过程，这对于优化给药方案至关重要。",
            "id": "3917669",
            "problem": "考虑一个标准的间接响应药效学（PD）模型，在该模型中，药物抑制响应介质的零级生成。响应变量 $R(t)$ 的单位为任意响应“单位”（units），药物血浆浓度为 $C(t)$，单位为 mg/L。主导的质量平衡方程是一阶线性常微分方程（ODE）\n$$\n\\frac{dR}{dt} \\;=\\; k_{\\text{in}}(C(t)) \\;-\\; k_{\\text{out}}\\,R(t),\n$$\n其中 $k_{\\text{in}}(C)$ 是受药物浓度调控的零级生成速率，$k_{\\text{out}}$ 是一级消除速率。药物对生成的抑制效应由一个抑制性最大效应函数建模，\n$$\nk_{\\text{in}}(C) \\;=\\; k_{\\text{in},0}\\,\\bigl(1 - I(C)\\bigr), \\quad I(C) \\;=\\; \\frac{I_{\\max}\\,C}{IC_{50} + C}.\n$$\n使用以下参数值：$k_{\\text{in},0}=10$ units/h，$k_{\\text{out}}=0.5$ h$^{-1}$，$I_{\\max}=0.8$，$IC_{50}=2$ mg/L。\n\n假设药物浓度为阶跃输入：当 $t  0$ 时，$C(t)=C_0$（一个常数）；当 $t \\ge 0$ 时，$C(t)=C_1$（一个常数）。系统在 $t  0$ 时初始处于稳态，因此 $R(0)=R_{\\text{ss}}(C_0)$，其中 $R_{\\text{ss}}(C)$ 表示当浓度固定为 $C$ 时的稳态响应。\n\n任务：\n- 对于下面测试套件中指定的每对 $(C_0, C_1)$，在 $C(t)$ 阶跃变化的条件下模拟 $t \\ge 0$ 时的 $R(t)$，并计算时间 $t_{0.9}$（单位为小时），在该时间点 $R(t)$ 已经完成了从旧稳态到新稳态总变化的 0.9。形式上，$t_{0.9}$ 是满足以下条件的最小 $t \\ge 0$：\n$$\n\\left| R(t) - R_{\\text{ss}}(C_1) \\right| \\;\\le\\; 0.1\\, \\left| R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1) \\right|.\n$$\n如果稳态没有变化（即 $R_{\\text{ss}}(C_0) = R_{\\text{ss}}(C_1)$），则定义 $t_{0.9}=0$。\n- 将每个 $t_{0.9}$ 以小时为单位表示，并四舍五入到六位小数。\n\n您可以假定的基本原理：应用于响应室的质量平衡、恒定输入的稳态定义，以及具有常系数的线性一阶常微分方程的性质。\n\n测试套件（每种情况为一对 $(C_0, C_1)$，单位为 mg/L）：\n1. $(0, 1)$\n2. $(0, 10)$\n3. $(5, 0)$\n4. $(1, 1)$\n\n您的程序应生成单行输出，其中包含按测试套件顺序排列的结果，格式为方括号括起来的逗号分隔列表（例如 $[t_{0.9}^{(1)},t_{0.9}^{(2)},t_{0.9}^{(3)},t_{0.9}^{(4)}]$）。所有时间都必须以小时为单位，并四舍五入到六位小数。",
            "solution": "经评估，用户提供的问题是有效的。它以药效学建模的既定原则为科学基础，问题提法清晰，信息充分，可得出唯一解，并以客观、正式的语言表述。\n\n问题描述了一个间接响应药效学模型，该模型由一个关于响应变量 $R(t)$ 的一阶线性常微分方程（ODE）控制：\n$$\n\\frac{dR}{dt} \\;=\\; k_{\\text{in}}(C(t)) \\;-\\; k_{\\text{out}}\\,R(t)\n$$\n此处，$k_{\\text{in}}(C)$ 是依赖于药物浓度的生成速率，$k_{\\text{out}}$ 是响应的一级消除速率常数。生成速率受药物浓度 $C$ 的抑制，遵循 $I_{\\max}$ 模型：\n$$\nk_{\\text{in}}(C) \\;=\\; k_{\\text{in},0}\\,\\left(1 - I(C)\\right), \\quad \\text{where} \\quad I(C) \\;=\\; \\frac{I_{\\max}\\,C}{IC_{50} + C}\n$$\n给定的参数为 $k_{\\text{in},0}=10$ units/h，$k_{\\text{out}}=0.5$ h$^{-1}$，$I_{\\max}=0.8$，$IC_{50}=2$ mg/L。\n\n首先，我们确定在恒定药物浓度 $C$ 下的稳态响应 $R_{\\text{ss}}(C)$。在稳态时，$\\frac{dR}{dt} = 0$。求解 $R(t) = R_{\\text{ss}}(C)$ 的常微分方程可得：\n$$\n0 \\;=\\; k_{\\text{in}}(C) \\;-\\; k_{\\text{out}}\\,R_{\\text{ss}}(C)\n$$\n$$\nR_{\\text{ss}}(C) \\;=\\; \\frac{k_{\\text{in}}(C)}{k_{\\text{out}}} \\;=\\; \\frac{k_{\\text{in},0}}{k_{\\text{out}}}\\,\\left(1 - \\frac{I_{\\max}\\,C}{IC_{50} + C}\\right)\n$$\n问题指出，当 $t  0$ 时，系统处于浓度为 $C_0$ 的稳态，因此在 $t=0$ 时的初始条件是 $R(0) = R_{\\text{ss}}(C_0)$。当 $t \\ge 0$ 时，浓度为常数 $C_1$。因此，对于 $t \\ge 0$ 的常微分方程为：\n$$\n\\frac{dR}{dt} \\;=\\; k_{\\text{in}}(C_1) \\;-\\; k_{\\text{out}}\\,R(t)\n$$\n这是一个带有常数强迫项的线性一阶常微分方程。我们可以将其重写为：\n$$\n\\frac{dR}{dt} + k_{\\text{out}}\\,R(t) = k_{\\text{in}}(C_1)\n$$\n对于形式为 $\\frac{dy}{dt} + ay = b$ 且初始条件为 $y(0)$ 的方程，其通解为 $y(t) = \\frac{b}{a} + \\left(y(0) - \\frac{b}{a}\\right)e^{-at}$。\n在本例中，$a = k_{\\text{out}}$，$b = k_{\\text{in}}(C_1)$，初始条件为 $R(0)=R_{\\text{ss}}(C_0)$。项 $\\frac{b}{a}$ 对应于新的稳态 $R_{\\text{ss}}(C_1) = \\frac{k_{\\text{in}}(C_1)}{k_{\\text{out}}}$。\n将这些代入通解，得到 $t \\ge 0$ 时响应的时间进程：\n$$\nR(t) \\;=\\; R_{\\text{ss}}(C_1) + \\left(R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1)\\right)e^{-k_{\\text{out}}\\,t}\n$$\n我们的任务是找到时间 $t_{0.9}$，它被定义为响应从旧稳态 $R_{\\text{ss}}(C_0)$ 到新稳态 $R_{\\text{ss}}(C_1)$ 的变化完成了 $90\\%$ 所需的最小时间 $t \\ge 0$。剩余的变化分数为 $10\\%$，形式上表示为：\n$$\n\\left| R(t) - R_{\\text{ss}}(C_1) \\right| \\;\\le\\; 0.1\\, \\left| R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1) \\right|\n$$\n从 $R(t)$ 的解，我们可以表示出差值 $R(t) - R_{\\text{ss}}(C_1)$：\n$$\nR(t) - R_{\\text{ss}}(C_1) \\;=\\; \\left(R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1)\\right)e^{-k_{\\text{out}}\\,t}\n$$\n对两边取绝对值可得：\n$$\n\\left| R(t) - R_{\\text{ss}}(C_1) \\right| \\;=\\; \\left| R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1) \\right|e^{-k_{\\text{out}}\\,t}\n$$\n因为对于实数 $t$ 和正数 $k_{\\text{out}}$，$e^{-k_{\\text{out}}\\,t}$ 总是正的。\n\n将此代入 $t_{0.9}$ 的不等式中：\n$$\n\\left| R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1) \\right|e^{-k_{\\text{out}}\\,t} \\;\\le\\; 0.1\\, \\left| R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1) \\right|\n$$\n我们分析两种情况：\n\n情况1：$R_{\\text{ss}}(C_0) = R_{\\text{ss}}(C_1)$。这发生在稳态没有变化时。由于 $R_{\\text{ss}}(C)$ 是关于 $C \\ge 0$ 的严格单调递减函数（给定 $I_{\\max} > 0$ 和 $IC_{50} > 0$），此条件当且仅当 $C_0 = C_1$ 时成立。在这种情况下，不等式变为 $0 \\le 0.1 \\cdot 0$，可简化为 $0 \\le 0$。这对所有 $t \\ge 0$ 都成立。满足条件的最小 $t$ 是 $t=0$，因此 $t_{0.9}=0$，与问题陈述中规定的一致。\n\n情况2：$R_{\\text{ss}}(C_0) \\neq R_{\\text{ss}}(C_1)$。这当且仅当 $C_0 \\neq C_1$ 时发生。在这种情况下，项 $\\left| R_{\\text{ss}}(C_0) - R_{\\text{ss}}(C_1) \\right|$ 是一个正常数，可以从不等式两边消去：\n$$\ne^{-k_{\\text{out}}\\,t} \\;\\le\\; 0.1\n$$\n为了找到满足此条件的最小时间 $t_{0.9}$，我们解这个等式：\n$$\ne^{-k_{\\text{out}}\\,t_{0.9}} \\;=\\; 0.1\n$$\n对两边取自然对数：\n$$\n-k_{\\text{out}}\\,t_{0.9} \\;=\\; \\ln(0.1) \\;=\\; -\\ln(10)\n$$\n$$\nt_{0.9} \\;=\\; \\frac{\\ln(10)}{k_{\\text{out}}}\n$$\n这个结果展示了一阶线性系统的一个关键特性：达到总变化的某个分数所需的时间与初始和最终状态（$C_0$ 和 $C_1$）无关，仅取决于系统的内在速率常数（$k_{\\text{out}}$）。\n\n现在，我们使用给定的参数 $k_{\\text{out}}=0.5$ h$^{-1}$，计算在 $C_0 \\neq C_1$ 的一般情况下 $t_{0.9}$ 的数值：\n$$\nt_{0.9} \\;=\\; \\frac{\\ln(10)}{0.5} \\;=\\; 2\\ln(10) \\;\\approx\\; 2 \\times 2.30258509299... \\;\\approx\\; 4.60517018599... \\;\\text{hours}\n$$\n四舍五入到六位小数，$t_{0.9} = 4.605170$ 小时。\n\n我们现在可以解决测试套件中的每一种情况：\n1.  $(C_0, C_1) = (0, 1)$: 由于 $C_0 \\neq C_1$，所以 $t_{0.9} = 4.605170$ 小时。\n2.  $(C_0, C_1) = (0, 10)$: 由于 $C_0 \\neq C_1$，所以 $t_{0.9} = 4.605170$ 小时。\n3.  $(C_0, C_1) = (5, 0)$: 由于 $C_0 \\neq C_1$，所以 $t_{0.9} = 4.605170$ 小时。\n4.  $(C_0, C_1) = (1, 1)$: 由于 $C_0 = C_1$，稳态没有变化。根据我们的分析和问题定义，$t_{0.9} = 0$ 小时。\n\n最终结果被收集并格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the time t_0.9 for a series of concentration step changes\n    in an indirect response pharmacodynamic model.\n    \"\"\"\n    # Define the rate constant from the problem statement.\n    # The other parameters (k_in,0, I_max, IC_50) are not needed for this specific calculation.\n    k_out = 0.5  # units: h^-1\n\n    # Define the test cases from the problem statement.\n    # Each case is a pair (C0, C1) in mg/L.\n    test_cases = [\n        (0.0, 1.0),\n        (0.0, 10.0),\n        (5.0, 0.0),\n        (1.0, 1.0),\n    ]\n\n    # Calculate t_0.9 for the general case where C0 is not equal to C1.\n    # t_0.9 = ln(10) / k_out.\n    # The time to reach a fraction of the new steady state is independent\n    # of the initial and final concentrations for a first-order linear system.\n    t_0_9_general = np.log(10) / k_out\n\n    results = []\n    for c0, c1 in test_cases:\n        # If C0 equals C1, there is no change in steady state.\n        # The response is constant, and the condition is met at t=0.\n        if c0 == c1:\n            t_0_9 = 0.0\n        else:\n            # For any step change, t_0.9 has the same value.\n            t_0_9 = t_0_9_general\n        results.append(t_0_9)\n\n    # Format the results to six decimal places, as required.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现代药物治疗常常涉及多种药物的联合使用，以期达到协同增效的目的。这项高级练习将挑战你从受体理论等基本原理出发，构建一个双药联合作用的机制模型，其中一种药物通过变构调节增强另一种药物的功效。这是一个综合性练习，它将模型推导与计算机模拟相结合，让你能够亲手探索和量化药物协同作用的复杂机制。",
            "id": "3917678",
            "problem": "必须为药效学（PD）建立并实现一个机制性组合模型。在此模型中，一种药物通过变构机制增加另一种药物的效应参数$\\tau$。研究需以受体理论和质量作用结合定律为基础，且不预设任何特定的最终组合公式。请使用以下科学合理且被广泛接受的基本要素：\n- 质量作用受体结合：在浓度为 $ C $、平衡解离常数为 $ K $ 时，配体对受体的占有率为分数 $ C/(K+C) $。\n- 从刺激 $ S $ 到效应 $ E $ 的饱和转导映射是单调、有界的，并且可以采用双曲线函数形式，使得归一化效应 $ E/E_{\\max} $ 是 $ S $ 的函数，当 $ S \\to \\infty $ 时趋近于 $ 1 $，当 $ S = 0 $ 时等于 $ 0 $。\n- 作用于不同位点的变构调节剂，其占有率在浓度为 $ C_B $、解离常数为 $ K_B $ 时是可饱和的。它对主要激动剂效应参数 $ \\tau $ 的影响必须通过一个物理上合理的函数来介导，该函数在 $ C_B = 0 $ 时为零，在 $ C_B \\to \\infty $ 时饱和，并以乘法方式缩放 $ \\tau $。\n\n按如下方式构建模型。药物 $ A $ 是一种激动剂，在游离浓度为 $ C_A $ 时与单一受体群体结合，解离常数为 $ K_A $。药物 $ B $ 是一种变构调节剂，在游离浓度为 $ C_B $ 时解离常数为 $ K_B $，它通过一个可饱和的变构相互作用增加药物 $ A $ 的效应参数 $ \\tau $，该作用的强度由一个效应-协同参数 $ \\gamma $ 控制。药物 $ B $ 单独在测量输出端不产生效应；其作用纯粹是调节性的。所要求的效应是归一化效应 $ E/E_{\\max} $，该值是无量纲的。所有浓度 $ C_A $ 和 $ C_B $ 以及所有解离常数 $ K_A $ 和 $ K_B $ 都必须以微摩尔（µM）为单位处理。最终程序必须只计算无量纲的输出。\n\n您的任务是：\n1. 从基本要素出发，推导出一个一致且明确的表达式，用于描述双药系统的归一化组合效应 $ E/E_{\\max} $。在该系统中，药物 $ B $ 通过一个可饱和的乘法变构机制增加药物 $ A $ 的效应参数 $ \\tau $，且药物 $ A $ 的刺激与其占有率乘以有效效应成正比。\n2. 对每个测试用例，在 $ C_A $ 和 $ C_B $ 的矩形剂量网格上实施仿真，计算每个网格点的组合效应，并将该网格总结为下面详述的四个指标。\n\n定义每个测试用例需要计算的指标：\n- 点 $ (C_A = K_A,\\, C_B = 0) $ 处的基线归一化效应 $ E_{\\text{baseline}} $。\n- 点 $ (C_A = K_A,\\, C_B = K_B) $ 处的组合归一化效应 $ E_{\\text{combo}} $。\n- 整个剂量网格上的最大归一化效应，记为 $ E_{\\text{max}} $。\n- 平均协同作用 $ \\overline{\\Delta} $，对于所有 $ C_B  0 $ 的网格点，定义为 $ E(C_A,C_B) - E(C_A,0) $ 在网格上的平均值，其中每一项都通过 $ E_{\\max} $ 进行归一化，以使协同作用无量纲。\n\n测试套件和参数集：\n- 测试用例 1（典型协同调节）：\n  - $ K_A = 1.0 $ µM, $ \\tau_0 = 1.0 $, $ \\gamma = 3.0 $, $ K_B = 2.0 $ µM, $ E_{\\max} = 1.0 $。\n  - $ C_A $ 网格（单位 µM）：$ \\{0, 0.5, 1, 2, 5\\} $。\n  - $ C_B $ 网格（单位 µM）：$ \\{0, 1, 2, 4, 10\\} $。\n- 测试用例 2（无调节边界条件）：\n  - $ K_A = 1.0 $ µM, $ \\tau_0 = 1.0 $, $ \\gamma = 0.0 $, $ K_B = 1.0 $ µM, $ E_{\\max} = 1.0 $。\n  - $ C_A $ 网格（单位 µM）：$ \\{0, 0.5, 1, 2, 5\\} $。\n  - $ C_B $ 网格（单位 µM）：$ \\{0, 1, 2, 4, 10\\} $。\n- 测试用例 3（强变构增强作用，快速饱和）：\n  - $ K_A = 1.0 $ µM, $ \\tau_0 = 0.1 $, $ \\gamma = 50.0 $, $ K_B = 0.1 $ µM, $ E_{\\max} = 1.0 $。\n  - $ C_A $ 网格（单位 µM）：$ \\{0, 0.5, 1, 2, 5\\} $。\n  - $ C_B $ 网格（单位 µM）：$ \\{0, 0.05, 0.1, 0.2, 1.0\\} $。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。该列表必须按顺序包含测试用例 1、测试用例 2、然后是测试用例 3 的四个指标 $ [E_{\\text{baseline}}, E_{\\text{combo}}, E_{\\text{max}}, \\overline{\\Delta}] $，并将它们平展成一个列表。所有输出都必须是无量纲浮点数。例如，输出应类似于 $ [r_1,r_2,r_3,r_4,r_5,r_6,r_7,r_8,r_9,r_{10},r_{11},r_{12}] $，其中 $ r_i $ 是依次代表三个测试用例的指标的浮点数。",
            "solution": "该问题经确认为具有科学依据、定义明确且自成体系，可以进行严谨的求解。核心任务是推导并实现一个机制性的药效学（PD）模型，用于描述一种药物变构增强另一种药物效力的双药组合。\n\n模型的推导基于所述的受体理论和质量作用动力学的第一性原理。设 $C_A$ 和 $C_B$ 分别为药物 A（激动剂）和药物 B（调节剂）的浓度。它们对应的平衡解离常数分别为 $K_A$ 和 $K_B$。\n\n首先，我们基于质量作用结合定律定义药物 A 的受体占有率分数（$RO_A$）。这是在给定浓度 $C_A$ 下被药物结合的受体所占的比例：\n$$\nRO_A = \\frac{C_A}{K_A + C_A}\n$$\n\n接下来，我们对药物 A 的有效效应 $\\tau_{eff}$进行建模。问题陈述药物 B 通过一个可饱和的、乘法性的、由协同参数 $\\gamma$ 控制的变构相互作用来增加药物 A 的基础效应 $\\tau_0$。当药物 B 的浓度 $C_B$ 为零时，其影响必须为零。一个满足这些约束条件的物理上合理的函数是：\n$$\n\\tau_{eff}(C_B) = \\tau_0 \\left(1 + \\gamma \\frac{C_B}{K_B + C_B}\\right)\n$$\n在此公式中，当 $C_B = 0$ 时，$\\tau_{eff} = \\tau_0$。当 $C_B \\to \\infty$ 时，项 $\\frac{C_B}{K_B + C_B}$ 趋近于 $1$，$\\tau_{eff}$ 饱和于 $\\tau_0(1+\\gamma)$。该调节相对于 $\\tau_0$ 是乘法性的。\n\n由激动剂产生的刺激 $S$ 与其受体占有率乘以其有效效应成正比。这是激动作用操作模型中的一个核心概念。\n$$\nS(C_A, C_B) = \\tau_{eff}(C_B) \\times RO_A = \\tau_0 \\left(1 + \\gamma \\frac{C_B}{K_B + C_B}\\right) \\frac{C_A}{K_A + C_A}\n$$\n\n最后，刺激 $S$ 通过一个饱和转导函数转换为归一化的生理效应 $e(C_A, C_B)$。问题指定了一个双曲線函数，它将 $S=0$ 映射到 $e=0$，并在 $S \\to \\infty$ 时饱和于 $e=1$。与 Black 和 Leff 的操作模型一致的该关系的典范形式是：\n$$\ne(C_A, C_B) = \\frac{E(C_A, C_B)}{E_{\\max,param}} = \\frac{S(C_A, C_B)}{S(C_A, C_B) + 1}\n$$\n此处，$E_{\\max,param}$ 是系统可能的最大效应，在所有测试用例中均作为参数给出，其值为 $1.0$。结合 $S$ 的表达式，得到归一化效应的最终模型：\n$$\ne(C_A, C_B) = \\frac{\\tau_0 \\left(1 + \\gamma \\frac{C_B}{K_B + C_B}\\right) \\frac{C_A}{K_A + C_A}}{\\tau_0 \\left(1 + \\gamma \\frac{C_B}{K_B + C_B}\\right) \\frac{C_A}{K_A + C_A} + 1}\n$$\n该方程被用于在指定的浓度网格上模拟组合药物效应。\n\n四个所需指标的计算方法如下：\n1. 基线归一化效应 $E_{\\text{baseline}}$ 是在 $C_A = K_A$ 和 $C_B = 0$ 时的效应：\n$$\nE_{\\text{baseline}} = e(K_A, 0) = \\frac{\\tau_0 \\frac{K_A}{K_A+K_A}}{\\tau_0 \\frac{K_A}{K_A+K_A} + 1} = \\frac{\\tau_0 / 2}{\\tau_0 / 2 + 1} = \\frac{\\tau_0}{\\tau_0 + 2}\n$$\n2. 组合归一化效应 $E_{\\text{combo}}$ 是在 $C_A = K_A$ 和 $C_B = K_B$ 时的效应：\n$$\nS(K_A, K_B) = \\tau_0 \\left(1 + \\gamma \\frac{K_B}{K_B + K_B}\\right) \\frac{K_A}{K_A + K_A} = \\frac{\\tau_0}{2}\\left(1 + \\frac{\\gamma}{2}\\right)\n$$\n$$\nE_{\\text{combo}} = e(K_A, K_B) = \\frac{S(K_A, K_B)}{S(K_A, K_B) + 1} = \\frac{\\frac{\\tau_0}{2}(1 + \\frac{\\gamma}{2})}{\\frac{\\tau_0}{2}(1 + \\frac{\\gamma}{2}) + 1} = \\frac{\\tau_0(1 + \\gamma/2)}{\\tau_0(1 + \\gamma/2) + 2}\n$$\n3. 最大归一化效应 $E_{\\text{max}}$ 是在指定剂量网格的所有点上计算出的 $e(C_A, C_B)$ 的最大值。务必将这个计算出的指标与模型参数 $E_{\\max,param}$ 区分开。\n$$\nE_{\\text{max}} = \\max_{C_A \\in \\text{grid}, C_B \\in \\text{grid}} e(C_A, C_B)\n$$\n4. 平均协同作用 $\\overline{\\Delta}$ 是协同作用（定义为差值 $e(C_A, C_B) - e(C_A, 0)$）在所有 $C_B  0$ 的网格点上的平均值。问题描述中的措辞“each term normalized by $E_{\\max}$”被解释为作用于已经归一化的效应 $e$。\n$$\n\\overline{\\Delta} = \\frac{1}{N_{C_A} \\times (N_{C_B} - 1)} \\sum_{C_A \\in \\text{grid}} \\sum_{C_B \\in \\text{grid, } C_B  0} \\left[ e(C_A, C_B) - e(C_A, 0) \\right]\n$$\n其中 $N_{C_A}$ 和 $N_{C_B}$ 分别是各自浓度网格中的点数。\n\n实现过程将系统地将这些计算应用于每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the pharmacodynamic modeling problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"params\": {\"KA\": 1.0, \"tau0\": 1.0, \"gamma\": 3.0, \"KB\": 2.0},\n            \"grids\": {\n                \"CA\": np.array([0.0, 0.5, 1.0, 2.0, 5.0]),\n                \"CB\": np.array([0.0, 1.0, 2.0, 4.0, 10.0]),\n            },\n        },\n        {\n            \"params\": {\"KA\": 1.0, \"tau0\": 1.0, \"gamma\": 0.0, \"KB\": 1.0},\n            \"grids\": {\n                \"CA\": np.array([0.0, 0.5, 1.0, 2.0, 5.0]),\n                \"CB\": np.array([0.0, 1.0, 2.0, 4.0, 10.0]),\n            },\n        },\n        {\n            \"params\": {\"KA\": 1.0, \"tau0\": 0.1, \"gamma\": 50.0, \"KB\": 0.1},\n            \"grids\": {\n                \"CA\": np.array([0.0, 0.5, 1.0, 2.0, 5.0]),\n                \"CB\": np.array([0.0, 0.05, 0.1, 0.2, 1.0]),\n            },\n        },\n    ]\n\n    all_results = []\n\n    def calculate_normalized_effect(CA, CB, KA, KB, tau0, gamma):\n        \"\"\"\n        Calculates the normalized effect based on the derived mechanistic model.\n        Args:\n            CA (float or np.ndarray): Concentration of Drug A.\n            CB (float or np.ndarray): Concentration of Drug B.\n            KA (float): Dissociation constant for Drug A.\n            KB (float): Dissociation constant for Drug B.\n            tau0 (float): Basal efficacy of Drug A.\n            gamma (float): Efficacy-cooperativity parameter for Drug B.\n        Returns:\n            float or np.ndarray: The normalized effect e(CA, CB).\n        \"\"\"\n        # Receptor occupancy of Drug A\n        ro_A = CA / (KA + CA)\n        \n        # Effective efficacy of Drug A modulated by Drug B\n        tau_eff = tau0 * (1.0 + gamma * (CB / (KB + CB)))\n        \n        # Stimulus\n        stimulus = tau_eff * ro_A\n        \n        # Transduction to normalized effect\n        effect = stimulus / (stimulus + 1.0)\n        \n        # Handle cases where CA=0, which should result in an effect of 0.\n        # np.divide handles division by zero gracefully but direct check is cleaner.\n        if isinstance(CA, np.ndarray):\n            effect[CA == 0] = 0.0\n        elif CA == 0:\n            effect = 0.0\n            \n        return effect\n\n    for case in test_cases:\n        params = case[\"params\"]\n        grids = case[\"grids\"]\n        \n        KA, tau0, gamma, KB = params[\"KA\"], params[\"tau0\"], params[\"gamma\"], params[\"KB\"]\n        CA_grid, CB_grid = grids[\"CA\"], grids[\"CB\"]\n\n        # 1. Compute effect matrix over the dose grid\n        # Use meshgrid to prepare for vectorized calculation\n        CA_mesh, CB_mesh = np.meshgrid(CA_grid, CB_grid, indexing='ij')\n        \n        effect_matrix = calculate_normalized_effect(CA_mesh, CB_mesh, KA, KB, tau0, gamma)\n\n        # 2. Calculate the four metrics\n        \n        # E_baseline: Effect at (CA = KA, CB = 0)\n        E_baseline = calculate_normalized_effect(KA, 0.0, KA, KB, tau0, gamma)\n        \n        # E_combo: Effect at (CA = KA, CB = KB)\n        E_combo = calculate_normalized_effect(KA, KB, KA, KB, tau0, gamma)\n        \n        # E_max_metric: Maximum normalized effect over the entire grid\n        E_max_metric = np.max(effect_matrix)\n        \n        # Mean synergy (delta_bar)\n        # Effects at CB=0 (baseline for each CA)\n        baseline_effects_per_CA = effect_matrix[:, 0]\n        \n        # Sub-matrix for CB  0\n        synergy_grid_effects = effect_matrix[:, 1:]\n        \n        # Synergy is the difference from baseline\n        # Broadcasting baseline_effects_per_CA to match synergy_grid_effects shape\n        synergy_matrix = synergy_grid_effects - baseline_effects_per_CA[:, np.newaxis]\n        \n        # Mean synergy calculation over all points where CB  0\n        delta_bar = np.mean(synergy_matrix)\n\n        # Append results for this test case\n        all_results.extend([E_baseline, E_combo, E_max_metric, delta_bar])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}