{
    "hands_on_practices": [
        {
            "introduction": "理论与应用的结合始于基本功的演练。本练习将引导您从酶促反应的基本步骤出发，应用准稳态近似（QSSA）来推导熟悉的米氏常数 $K_M$ 和催化常数 $k_{\\text{cat}}$。这项基础性练习旨在强化这些常数的物理意义，并训练您计算初始反应速率 $v_0$，这是实验酶学的基石。",
            "id": "2649716",
            "problem": "一种用于基准测试抑制机制的酶催化反应，在旨在验证无抑制剂（作为对照）时初始速率体系的条件下进行研究。基本机理是两步结合和催化方案\n$$\nE + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P,\n$$\n其中总酶浓度守恒，因此 $[E]_{0} = [E] + [ES]$。假设质量作用动力学，早期产物逆向形成可忽略不计，并且 $[S]_{0} \\gg [E]_{0}$。准稳态近似（QSSA）定义为在初始速率窗口内 $d[ES]/dt \\approx 0$ 的假设。\n\n给定以下物理上合理的参数：\n- 结合速率常数 $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$，\n- 解离速率常数 $k_{-1} = 180\\ \\mathrm{s}^{-1}$，\n- 催化速率常数 $k_{2} = 20\\ \\mathrm{s}^{-1}$，\n- 总酶浓度 $[E]_{0} = 12\\ \\mathrm{nM}$，\n- 初始底物浓度 $[S]_{0} = 50\\ \\mathrm{\\mu M}$，\n\n从质量作用速率方程和守恒定律出发，执行以下操作，不得引用任何未从这些原理推导出的结果：\n\n1) 在QSSA下，用 $k_{1}$、$k_{-1}$ 和 $k_{2}$ 推导米氏常数 $K_{M}$ 和催化常数 $k_{\\text{cat}}$ 的定义。\n\n2) 使用你推导的关系式，计算 $K_{M}$（单位为 $\\mathrm{M}$）、$k_{\\text{cat}}$（单位为 $\\mathrm{s}^{-1}$）和在 $t=0$ 时的初始速率 $v_{0}$（单位为 $\\mathrm{M}\\ \\mathrm{s}^{-1}$）。\n\n3) 使用化学计量关系 $S \\to P$ 并假设初始速率在前 $5$ 秒内保持近似恒定，估算 $5$ 秒后底物消耗的比例，结果表示为无单位的小数。根据此比例，通过与一个保守的小变化标准（例如，小于 $0.05$）进行比较，评估初始速率近似在 $5$ 秒内是否仍然有效。\n\n将第3部分中你报告的最终比例四舍五入到四位有效数字。将最终答案表示为无单位的小数。仅报告此最终比例作为你的答案。",
            "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n-   机理：$E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P$\n-   守恒定律：$[E]_{0} = [E] + [ES]$\n-   假设：质量作用动力学，可忽略的产物逆向形成，$[S]_{0} \\gg [E]_{0}$，准稳态近似（QSSA）$d[ES]/dt \\approx 0$。\n-   参数：\n    -   $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$\n    -   $k_{-1} = 180\\ \\mathrm{s}^{-1}$\n    -   $k_{2} = 20\\ \\mathrm{s}^{-1}$\n    -   $[E]_{0} = 12\\ \\mathrm{nM}$\n    -   $[S]_{0} = 50\\ \\mathrm{\\mu M}$\n\n**第2步：使用提取的已知条件进行验证**\n该问题提出了酶动力学中的一个标准情景，基于对Michaelis-Menten机理的Briggs-Haldane处理。\n-   **科学依据：** 该问题基于化学动力学的基本原理，特别是质量作用定律和准稳态近似。所有概念都是物理化学和生物化学的核心内容。\n-   **良态问题：** 问题定义清晰，提供了推导所求量唯一解所需的所有参数和假设。条件 $[S]_{0} \\gg [E]_{0}$ 得到满足，因为 $50 \\times 10^{-6}\\ \\mathrm{M} \\gg 12 \\times 10^{-9}\\ \\mathrm{M}$。\n-   **客观性：** 语言精确且定量，没有任何主观或模棱两可的术语。\n-   **完整性与一致性：** 数据充分且一致。速率常数和浓度的单位对于所需计算是适当且量纲一致的。\n-   **合理性：** 所提供的动力学参数和浓度对于酶系统是物理上现实的。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。这是一个良态的、科学上合理的题目，可以按要求从第一性原理求解。继续进行解答。\n\n根据问题陈述的要求，解答分为三部分构建。\n\n**第1部分：$K_M$ 和 $k_{\\text{cat}}$ 的推导**\n\n酶-底物复合物浓度 $[ES]$ 的变化率由应用于给定机理的质量作用定律描述：\n$$\n\\frac{d[ES]}{dt} = k_{1}[E][S] - k_{-1}[ES] - k_{2}[ES] = k_{1}[E][S] - (k_{-1} + k_{2})[ES]\n$$\n反应速率 $v$ 是产物 $P$ 的生成速率：\n$$\nv = \\frac{d[P]}{dt} = k_{2}[ES]\n$$\n准稳态近似（QSSA）假设中间复合物 $[ES]$ 的浓度在初始速率测量的时间尺度内保持近似恒定，即 $\\frac{d[ES]}{dt} \\approx 0$。将此近似应用于 $[ES]$ 的速率方程，得到：\n$$\nk_{1}[E][S] \\approx (k_{-1} + k_{2})[ES]\n$$\n总酶浓度 $[E]_{0}$ 是守恒的：$[E]_{0} = [E] + [ES]$。这使我们能够将游离酶的浓度 $[E]$ 表示为 $[E] = [E]_{0} - [ES]$。将此代入稳态方程，得到：\n$$\nk_{1}([E]_{0} - [ES])[S] \\approx (k_{-1} + k_{2})[ES]\n$$\n我们重排此表达式以求解 $[ES]$：\n$$\nk_{1}[E]_{0}[S] - k_{1}[ES][S] \\approx (k_{-1} + k_{2})[ES]\n$$\n$$\nk_{1}[E]_{0}[S] \\approx (k_{-1} + k_{2})[ES] + k_{1}[ES][S]\n$$\n$$\nk_{1}[E]_{0}[S] \\approx [ES]((k_{-1} + k_{2}) + k_{1}[S])\n$$\n$$\n[ES] \\approx \\frac{k_{1}[E]_{0}[S]}{(k_{-1} + k_{2}) + k_{1}[S]}\n$$\n为了得到速率定律的标准形式，我们将分子和分母同时除以 $k_{1}$：\n$$\n[ES] \\approx \\frac{[E]_{0}[S]}{\\frac{k_{-1} + k_{2}}{k_{1}} + [S]}\n$$\n现在，将此 $[ES]$ 的表达式代回反应速率 $v$ 的方程中：\n$$\nv = k_{2}[ES] \\approx \\frac{k_{2}[E]_{0}[S]}{\\frac{k_{-1} + k_{2}}{k_{1}} + [S]}\n$$\n该方程即为Michaelis-Menten速率定律，通常写作 $v = \\frac{k_{\\text{cat}}[E]_{0}[S]}{K_{M} + [S]}$。通过将推导的方程与标准形式直接比较，我们确定了催化常数 $k_{\\text{cat}}$ 和米氏常数 $K_{M}$ 的定义：\n$$\nk_{\\text{cat}} = k_{2}\n$$\n$$\nK_{M} = \\frac{k_{-1} + k_{2}}{k_{1}}\n$$\n推导完成。\n\n**第2部分：$K_{M}$、$k_{\\text{cat}}$ 和 $v_{0}$ 的计算**\n\n使用给定的参数值：\n-   $k_{1} = 1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}$\n-   $k_{-1} = 180\\ \\mathrm{s}^{-1}$\n-   $k_{2} = 20\\ \\mathrm{s}^{-1}$\n-   $[E]_{0} = 12\\ \\mathrm{nM} = 1.2 \\times 10^{-8}\\ \\mathrm{M}$\n-   $[S]_{0} = 50\\ \\mathrm{\\mu M} = 5.0 \\times 10^{-5}\\ \\mathrm{M}$\n\n我们计算 $k_{\\text{cat}}$：\n$$\nk_{\\text{cat}} = k_{2} = 20\\ \\mathrm{s}^{-1}\n$$\n接下来，我们计算 $K_{M}$：\n$$\nK_{M} = \\frac{k_{-1} + k_{2}}{k_{1}} = \\frac{180\\ \\mathrm{s}^{-1} + 20\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}} = \\frac{200\\ \\mathrm{s}^{-1}}{1.2 \\times 10^{7}\\ \\mathrm{M}^{-1}\\ \\mathrm{s}^{-1}}\n$$\n$$\nK_{M} = \\frac{2}{1.2} \\times 10^{-5}\\ \\mathrm{M} = \\frac{5}{3} \\times 10^{-5}\\ \\mathrm{M} \\approx 1.67 \\times 10^{-5}\\ \\mathrm{M}\n$$\n初始速率 $v_{0}$ 是在 $t=0$ 时的速率，此时 $[S] = [S]_{0}$。我们使用推导出的速率定律：\n$$\nv_{0} = \\frac{k_{\\text{cat}}[E]_{0}[S]_{0}}{K_{M} + [S]_{0}}\n$$\n代入数值：\n$$\nv_{0} = \\frac{(20\\ \\mathrm{s}^{-1})(1.2 \\times 10^{-8}\\ \\mathrm{M})(5.0 \\times 10^{-5}\\ \\mathrm{M})}{(\\frac{5}{3} \\times 10^{-5}\\ \\mathrm{M}) + (5.0 \\times 10^{-5}\\ \\mathrm{M})}\n$$\n分子是：\n$$\n(20)(1.2 \\times 10^{-8})(5.0 \\times 10^{-5})\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1} = 120 \\times 10^{-13}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1} = 1.2 \\times 10^{-11}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1}\n$$\n分母是：\n$$\n\\left(\\frac{5}{3} + 5\\right) \\times 10^{-5}\\ \\mathrm{M} = \\left(\\frac{5}{3} + \\frac{15}{3}\\right) \\times 10^{-5}\\ \\mathrm{M} = \\frac{20}{3} \\times 10^{-5}\\ \\mathrm{M}\n$$\n因此，初始速率为：\n$$\nv_{0} = \\frac{1.2 \\times 10^{-11}\\ \\mathrm{M}^2\\ \\mathrm{s}^{-1}}{\\frac{20}{3} \\times 10^{-5}\\ \\mathrm{M}} = \\frac{1.2 \\times 3}{20} \\times 10^{-6}\\ \\mathrm{M}\\ \\mathrm{s}^{-1} = 0.18 \\times 10^{-6}\\ \\mathrm{M}\\ \\mathrm{s}^{-1} = 1.8 \\times 10^{-7}\\ \\mathrm{M}\\ \\mathrm{s}^{-1}\n$$\n\n**第3部分：底物消耗和有效性评估**\n\n初始速率近似假设在短时间间隔 $\\Delta t$ 内，速率 $v \\approx v_{0}$。速率通过 $v = -\\frac{d[S]}{dt}$ 与底物消耗相关。如果 $v$ 是常数，则在 $\\Delta t$ 时间内消耗的底物量为 $|\\Delta[S]| \\approx v_{0} \\Delta t$。\n给定 $\\Delta t = 5\\ \\mathrm{s}$：\n$$\n|\\Delta[S]| \\approx (1.8 \\times 10^{-7}\\ \\mathrm{M}\\ \\mathrm{s}^{-1}) \\times (5\\ \\mathrm{s}) = 9.0 \\times 10^{-7}\\ \\mathrm{M}\n$$\n底物消耗的比例是被消耗的底物量与初始底物浓度 $[S]_{0}$ 的比值：\n$$\n\\text{消耗比例} = \\frac{|\\Delta[S]|}{[S]_{0}} \\approx \\frac{v_{0} \\Delta t}{[S]_{0}}\n$$\n代入数值：\n$$\n\\text{消耗比例} \\approx \\frac{9.0 \\times 10^{-7}\\ \\mathrm{M}}{5.0 \\times 10^{-5}\\ \\mathrm{M}} = \\frac{9.0}{500} = \\frac{1.8}{100} = 0.018\n$$\n题目要求将此比例报告为四位有效数字。因此，该比例为 $0.01800$。\n为了评估初始速率近似的有效性，我们将此比例与小于 $0.05$ 的标准进行比较。由于 $0.01800  0.05$，底物消耗约为 $1.8\\%$，这完全在可接受的范围内，表明初始速率假设在 $5$ 秒的时间间隔内是有效的。底物浓度的变化不足以引起与初始速率的显著偏差。\n\n最终答案是底物消耗的无单位小数比例，四舍五入到四位有效数字。",
            "answer": "$$\\boxed{0.01800}$$"
        },
        {
            "introduction": "虽然初始速率分析功能强大，但理解整个反应进程随时间的变化能提供一个更全面的视角。本练习要求您推导米氏方程的积分形式，从而得到底物浓度随时间变化的解析解。通过将这个基于准稳态近似的解析解与完整质量作用常微分方程组的数值解进行比较，您将对稳态近似的准确性和局限性获得定量的认识。",
            "id": "3901788",
            "problem": "考虑由基元步骤 $E + S \\rightleftharpoons ES$ 和 $ES \\rightarrow E + P$ 描述的不可逆酶促反应体系，其中 $E$ 是游离酶，$S$ 是底物，$ES$ 是酶-底物复合物，$P$ 是产物。正向结合、逆向解离和催化速率常数分别为 $k_1$、$k_{-1}$ 和 $k_{\\mathrm{cat}}$，且均为严格正值。假设体系为充分混合的封闭体系，总酶浓度 $E_{\\mathrm{tot}}$ 恒定，且初始为仅含底物的溶液，其中 $S(0) = S_0$，$ES(0) = 0$，$P(0) = 0$，$E(0) = E_{\\mathrm{tot}}$。浓度单位为摩尔/升 (M)，时间单位为秒 (s)。\n\n从上述反应的质量作用定律出发，根据第一性原理推导在 Briggs-Haldane 准稳态近似 (QSSA) 下底物的时间进程，并将其表示为 $t$、$S_0$、$E_{\\mathrm{tot}}$、$k_1$、$k_{-1}$ 和 $k_{\\mathrm{cat}}$ 的闭式解析函数。同时，建立无近似的完整有限维质量作用常微分方程 (ODE) 模型，并数值计算底物的时间进程。使用这两种方法，对每个指定的参数集和最终时间 $t$，评估由完整质量作用 ODE 模型预测的底物浓度与由 QSSA 推导的解析进程曲线预测的底物浓度之间的绝对差。将最终的差值以摩尔/升 (M) 为单位，表示为浮点数。\n\n您的程序必须实现以下两者：\n- 在 Briggs-Haldane 准稳态近似 (QSSA) 下推导的解析时间进程解。\n- 精确质量作用 ODE 的数值积分。\n\n对于下方的每个参数集，计算由 $\\Delta S = \\lvert S_{\\mathrm{ODE}}(t) - S_{\\mathrm{QSSA}}(t) \\rvert$ 定义的绝对差 $\\Delta S$，其中 $S_{\\mathrm{ODE}}(t)$ 是通过数值积分完整质量作用 ODE 得到的底物浓度，而 $S_{\\mathrm{QSSA}}(t)$ 是从解析 QSSA 进程曲线得到的底物浓度。以摩尔/升 (M) 为单位，将 $\\Delta S$ 报告为浮点数。\n\n使用以下参数集测试套件，所有浓度单位为 M，时间单位为 s：\n- 测试用例 1 (一般情况)：$k_1 = 10^6$，$k_{-1} = 10$，$k_{\\mathrm{cat}} = 100$，$E_{\\mathrm{tot}} = 10^{-7}$，$S_0 = 10^{-4}$，$t = 5 \\times 10^{-2}$。\n- 测试用例 2 (底物远过量)：$k_1 = 10^6$，$k_{-1} = 10$，$k_{\\mathrm{cat}} = 100$，$E_{\\mathrm{tot}} = 10^{-7}$，$S_0 = 10^{-3}$，$t = 10^{-2}$。\n- 测试用例 3 (酶浓度与底物浓度相当，对 QSSA 构成挑战)：$k_1 = 5 \\times 10^5$，$k_{-1} = 2$，$k_{\\mathrm{cat}} = 20$，$E_{\\mathrm{tot}} = 10^{-5}$，$S_0 = 2 \\times 10^{-6}$，$t = 2 \\times 10^{-2}$。\n- 测试用例 4 (初始时间边界)：$k_1 = 10^6$，$k_{-1} = 1$，$k_{\\mathrm{cat}} = 50$，$E_{\\mathrm{tot}} = 5 \\times 10^{-8}$，$S_0 = 5 \\times 10^{-5}$，$t = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试用例相同（例如，$[x_1,x_2,x_3,x_4]$），其中每个 $x_i$ 是相应测试用例计算出的 $\\Delta S$（单位为 M）。",
            "solution": "本问题要求推导并比较两种用于描述酶促反应中底物浓度随时间变化的模型：完整的质量作用常微分方程 (ODE) 模型和从 Briggs-Haldane 准稳态近似 (QSSA) 推导出的解析解。\n\n反应机理由以下两个基元步骤给出：\n$$ E + S \\underset{k_{-1}}{\\stackrel{k_1}{\\rightleftharpoons}} ES \\quad \\text{(快速可逆结合)} $$\n$$ ES \\stackrel{k_{\\mathrm{cat}}}{\\rightarrow} E + P \\quad \\text{(慢速不可逆催化)} $$\n其中 $E$、$S$、$ES$ 和 $P$ 分别代表游离酶、底物、酶-底物复合物和产物。速率常数 $k_1$ (正向结合，单位：M$^{-1}$s$^{-1}$)、$k_{-1}$ (逆向解离，单位：s$^{-1}$) 和 $k_{\\mathrm{cat}}$ (催化，单位：s$^{-1}$) 均为严格正值。该体系是封闭的，总酶浓度 $E_{\\mathrm{tot}}$ 恒定。在时间 $t=0$ 时的初始条件为 $[S](0) = S_0$、$[E](0) = E_{\\mathrm{tot}}$、$[ES](0) = 0$ 和 $[P](0) = 0$。\n\n### 步骤 1：构建完整的质量作用 ODE 模型\n\n将质量作用定律应用于该反应方案，可得到一个描述化学物质浓度随时间演变的常微分方程组。设 $[S]$、$[E]$、$[ES]$ 和 $[P]$ 表示这些浓度。\n\n$$ \\frac{d[S]}{dt} = -k_1 [E][S] + k_{-1}[ES] $$\n$$ \\frac{d[E]}{dt} = -k_1 [E][S] + (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n$$ \\frac{d[P]}{dt} = k_{\\mathrm{cat}}[ES] $$\n\n总酶浓度是守恒的：\n$$ [E](t) + [ES](t) = E_{\\mathrm{tot}} $$\n该守恒定律允许我们通过代入 $[E] = E_{\\mathrm{tot}} - [ES]$ 来从系统中消去 $[E]$。系统的动力学可以完全由 $[S]$ 和 $[ES]$ 的浓度来描述：\n\n$$ \\frac{d[S]}{dt} = -k_1 (E_{\\mathrm{tot}} - [ES])[S] + k_{-1}[ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] $$\n\n这两个耦合的非线性 ODE，连同初始条件 $[S](0) = S_0$ 和 $[ES](0) = 0$，构成了完整的质量作用模型。该系统没有通用的闭式解析解，必须进行数值求解。此模型将被称为“ODE 模型”。\n\n### 步骤 2：推导 QSSA 解析进程曲线\n\nBriggs-Haldane 准稳态近似 (QSSA) 通过假设在一个非常短暂的初始瞬态期之后，酶-底物复合物 $[ES]$ 的浓度变化远慢于底物和产物的浓度变化来简化系统。在数学上，这表示为：\n$$ \\frac{d[ES]}{dt} \\approx 0 $$\n\n将此近似应用于 $[ES]$ 的 ODE：\n$$ k_1 [E][S] - (k_{-1} + k_{\\mathrm{cat}})[ES] \\approx 0 $$\n再次代入酶守恒定律 $[E] = E_{\\mathrm{tot}} - [ES]$：\n$$ k_1 (E_{\\mathrm{tot}} - [ES])[S] - (k_{-1} + k_{\\mathrm{cat}})[ES] \\approx 0 $$\n我们现在可以解这个代数方程，求出复合物的准稳态浓度 $[ES]_{\\mathrm{ss}}$：\n$$ k_1 E_{\\mathrm{tot}}[S] - k_1 [ES]_{\\mathrm{ss}}[S] \\approx (k_{-1} + k_{\\mathrm{cat}})[ES]_{\\mathrm{ss}} $$\n$$ k_1 E_{\\mathrm{tot}}[S] \\approx (k_1[S] + k_{-1} + k_{\\mathrm{cat}})[ES]_{\\mathrm{ss}} $$\n$$ [ES]_{\\mathrm{ss}} \\approx \\frac{k_1 E_{\\mathrm{tot}}[S]}{k_1[S] + k_{-1} + k_{\\mathrm{cat}}} = \\frac{E_{\\mathrm{tot}}[S]}{\\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1} + [S]} $$\n\n这就得到了我们熟悉的 Michaelis-Menten 形式。我们将米氏常数 $K_M$ 定义为：\n$$ K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1} $$\n所以，稳态复合物浓度为：\n$$ [ES]_{\\mathrm{ss}} \\approx \\frac{E_{\\mathrm{tot}}[S]}{K_M + [S]} $$\n假设结合和解离导致 $[S]$ 的变化处于平衡状态，那么底物消耗的速率可以近似为转化为产物的速率。一个更严谨的方法是注意到，系统中底物的总量 $[S]_{\\mathrm{total}} = [S] + [ES]$ 仅通过催化步骤消耗：$d[S]_{\\mathrm{total}}/dt = -k_{\\mathrm{cat}}[ES]$。在 QSSA 下，假设 $[ES] \\ll [S]$，因此 $d[S]/dt \\approx d[S]_{\\mathrm{total}}/dt$。这就得到了 Michaelis-Menten 速率定律：\n$$ \\frac{d[S]}{dt} \\approx -k_{\\mathrm{cat}}[ES]_{\\mathrm{ss}} = - \\frac{k_{\\mathrm{cat}} E_{\\mathrm{tot}}[S]}{K_M + [S]} $$\n设 $V_{\\max} = k_{\\mathrm{cat}} E_{\\mathrm{tot}}$ 为最大反应速率。方程变为：\n$$ \\frac{d[S]}{dt} = - \\frac{V_{\\max}[S]}{K_M + [S]} $$\n这个一阶 ODE 是可分离的。我们可以对其进行积分，以求得作为时间函数的底物浓度 $[S](t)$，这被称为进程曲线。\n$$ \\frac{K_M + [S]}{[S]} d[S] = -V_{\\max} dt $$\n$$ \\left( \\frac{K_M}{[S]} + 1 \\right) d[S] = -V_{\\max} dt $$\n从 $t=0$ 到 $t$（以及从 $[S](0)=S_0$ 到 $[S](t)$）进行积分：\n$$ \\int_{S_0}^{[S](t)} \\left( \\frac{K_M}{[S']} + 1 \\right) d[S'] = \\int_0^t -V_{\\max} dt' $$\n$$ \\left[ K_M \\ln([S']) + [S'] \\right]_{S_0}^{[S](t)} = -V_{\\max} t $$\n$$ (K_M \\ln([S](t)) + [S](t)) - (K_M \\ln(S_0) + S_0) = -V_{\\max} t $$\n这为 $[S](t)$ 提供了一个隐式解。为了获得闭式显式解，我们可以使用 Lambert W 函数，该函数定义为方程 $W(z)e^{W(z)} = z$ 的解。重新整理该隐式方程：\n$$ K_M \\ln\\left(\\frac{[S](t)}{S_0}\\right) + [S](t) - S_0 = -V_{\\max} t $$\n$$ \\frac{[S](t)}{K_M} - \\frac{S_0}{K_M} + \\ln\\left(\\frac{[S](t)}{K_M}\\right) - \\ln\\left(\\frac{S_0}{K_M}\\right) = -\\frac{V_{\\max} t}{K_M} $$\n$$ \\ln\\left(\\frac{[S](t)}{K_M}\\right) + \\frac{[S](t)}{K_M} = \\ln\\left(\\frac{S_0}{K_M}\\right) + \\frac{S_0}{K_M} - \\frac{V_{\\max} t}{K_M} $$\n设 $y(t) = \\frac{[S](t)}{K_M}$。那么 $\\ln(y) + y = C(t)$，其中 $C(t)$ 是等式右侧。对两边取指数，得到 $y e^y = e^{C(t)}$。这是 $W(z)e^{W(z)}=z$ 的形式。一个更直接的重排是：\n$$ [S](t) e^{[S](t)/K_M} = S_0 e^{(S_0 - V_{\\max}t)/K_M} $$\n乘以 $1/K_M$：\n$$ \\frac{[S](t)}{K_M} e^{[S](t)/K_M} = \\frac{S_0}{K_M} e^{\\frac{S_0 - V_{\\max}t}{K_M}} $$\n对两边应用 Lambert W 函数，得到：\n$$ \\frac{[S](t)}{K_M} = W\\left( \\frac{S_0}{K_M} \\exp\\left(\\frac{S_0 - V_{\\max}t}{K_M}\\right) \\right) $$\n因此，QSSA 下底物浓度的显式解析解为：\n$$ [S]_{\\mathrm{QSSA}}(t) = K_M \\cdot W\\left( \\frac{S_0}{K_M} \\exp\\left(\\frac{S_0 - V_{\\max} t}{K_M}\\right) \\right) $$\n其中 $W$ 是 Lambert W 函数的主分支 ($k=0$)。\n\n### 步骤 3：计算差异\n\n对于每个测试用例，我们在指定的最终时间 $t$ 计算底物浓度的两个值：\n1.  $S_{\\mathrm{ODE}}(t)$：通过从 $t=0$ 到最终时间数值积分完整的质量作用 ODE 系统得到的底物浓度。\n2.  $S_{\\mathrm{QSSA}}(t)$：使用包含 Lambert W 函数的推导解析公式计算出的底物浓度。\n\n最终需要报告的量是这两个值之间的绝对差：\n$$ \\Delta S = \\lvert S_{\\mathrm{ODE}}(t) - S_{\\mathrm{QSSA}}(t) \\rvert $$\n该差异量化了准稳态近似在给定参数和时间下引入的误差。当总酶浓度远小于底物浓度与米氏常数之和 ($E_{\\mathrm{tot}} \\ll [S] + K_M$) 时，QSSA 通常是有效的。这些测试用例旨在探索该条件成立以及被违反的各种情况。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.special import lambertw\n\ndef solve():\n    \"\"\"\n    Solves the problem by comparing the full mass-action ODE model with the\n    QSSA-derived analytic solution for enzyme kinetics.\n    \"\"\"\n    \n    # Test cases: (k1, k_neg1, k_cat, E_tot, S0, t)\n    test_cases = [\n        # Test case 1 (general regime)\n        (1e6, 10, 100, 1e-7, 1e-4, 5e-2),\n        # Test case 2 (substrate in large excess)\n        (1e6, 10, 100, 1e-7, 1e-3, 1e-2),\n        # Test case 3 (enzyme comparable to substrate, challenging QSSA)\n        (5e5, 2, 20, 1e-5, 2e-6, 2e-2),\n        # Test case 4 (boundary at initial time)\n        (1e6, 1, 50, 5e-8, 5e-5, 0.0),\n    ]\n\n    results = []\n\n    def mass_action_ode(t, y, k1, k_neg1, k_cat, E_tot):\n        \"\"\"\n        Defines the system of ODEs for the full mass-action model.\n        y[0] is substrate concentration [S]\n        y[1] is enzyme-substrate complex concentration [ES]\n        \"\"\"\n        S, ES = y\n        E = E_tot - ES\n        \n        dS_dt = -k1 * E * S + k_neg1 * ES\n        dES_dt = k1 * E * S - (k_neg1 + k_cat) * ES\n        \n        return [dS_dt, dES_dt]\n\n    def qssa_analytic_solution(t, S0, E_tot, k1, k_neg1, k_cat):\n        \"\"\"\n        Calculates the substrate concentration using the analytic solution\n        derived from the QSSA, which involves the Lambert W function.\n        \"\"\"\n        if t == 0:\n            return S0\n\n        Km = (k_neg1 + k_cat) / k1\n        Vmax = k_cat * E_tot\n        \n        # The argument for the Lambert W function\n        # Using np.exp for safe handling of large exponents\n        arg = (S0 / Km) * np.exp((S0 - Vmax * t) / Km)\n        \n        # The lambertw function returns a complex number; we take the real part.\n        # For positive real arguments, the principal branch (k=0) is real.\n        s_qssa = Km * np.real(lambertw(arg, k=0))\n        \n        return s_qssa\n\n    for case in test_cases:\n        k1, k_neg1, k_cat, E_tot, S0, t_final = case\n        \n        # For t=0, the difference is trivially zero as both models start at S0.\n        if t_final == 0:\n            results.append(0.0)\n            continue\n\n        # 1. Numerical solution of the full mass-action ODEs\n        y0 = [S0, 0] # Initial conditions: [S(0), ES(0)]\n        t_span = [0, t_final]\n        \n        # Use a stiff solver with tight tolerances for high accuracy\n        sol = solve_ivp(\n            mass_action_ode, \n            t_span, \n            y0, \n            args=(k1, k_neg1, k_cat, E_tot),\n            method='Radau',\n            dense_output=True,\n            rtol=1e-9, \n            atol=1e-12\n        )\n        \n        S_ode = sol.sol(t_final)[0]\n\n        # 2. Analytic solution from QSSA\n        S_qssa = qssa_analytic_solution(t_final, S0, E_tot, k1, k_neg1, k_cat)\n\n        # 3. Compute absolute difference\n        delta_S = np.abs(S_ode - S_qssa)\n        results.append(delta_S)\n        \n    # Format the final output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(f'{r:.18e}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "系统建模的一项关键任务是理解模型的输出如何响应其参数的变化。本练习将引入灵敏度分析的概念，这是一个用以量化各动力学参数对反应速率影响的强大工具。您将通过推导和计算归一化灵敏度系数，揭示在不同底物浓度条件下，哪些参数是决定酶行为的最关键驱动因素。",
            "id": "3901785",
            "problem": "考虑一个单底物、单产物的酶促反应，其基元质量作用机制为 $E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P$，其中 $E$ 是游离酶，$S$ 是底物，$ES$ 是酶-底物复合物，$P$ 是产物。设总酶浓度为 $E_{T} = [E] + [ES]$。在准稳态近似 (QSSA)下，产物生成速率 $v$ 可以通过经过充分检验的生物化学动力学和代数操作，用 $k_{1}$、$k_{-1}$、$k_{2}$、$E_{T}$ 和 $[S]$ 来表示。Briggs-Haldane 观点根据基元速率常数 $k_{1}$、$k_{-1}$ 和 $k_{2}$ 来解释米氏常数 $K_{M}$。\n\n您的任务是：从质量作用描述和 QSSA 概念出发，推导出一个关于参数 $k_{1}$、$k_{-1}$、$k_{2}$、$E_{T}$ 和 $[S]$ 的 $v$ 的表达式，然后解析计算 $v$ 对每个参数 $p \\in \\{k_{1}, k_{-1}, k_{2}, E_{T}, [S]\\}$ 的归一化灵敏度系数，其定义为 $S_{p} = \\left(\\dfrac{p}{v}\\right)\\dfrac{\\partial v}{\\partial p}$。您必须在一个程序中实现这些闭式解灵敏度系数。所有量均应采用一致的物理单位：$k_{1}$ 的单位为 $\\mathrm{M}^{-1}\\mathrm{s}^{-1}$，$k_{-1}$ 的单位为 $\\mathrm{s}^{-1}$，$k_{2}$ 的单位为 $\\mathrm{s}^{-1}$，$E_{T}$ 的单位为 $\\mathrm{M}$，$[S]$ 的单位为 $\\mathrm{M}$。输出是无量纲的归一化灵敏度，并且必须表示为十进制数（不带百分号）。\n\n实现一个程序，该程序对下面的测试套件中的每一组参数，使用您推导出的解析表达式计算并返回包含五个归一化灵敏度系数的向量 $[S_{k_{1}}, S_{k_{-1}}, S_{k_{2}}, S_{E_{T}}, S_{[S]}]$。请勿在最终输出中使用数值微分；期望的结果应来自您的解析推导。\n\n测试套件（所有参数均使用指定单位）：\n- 情况 A（平衡状态）：$k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$，$k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$，$k_{2} = 5.0 \\times 10^{1}\\ \\mathrm{s}^{-1}$，$E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$，$[S] = 1.0 \\times 10^{-4}\\ \\mathrm{M}$。\n- 情况 B（低底物浓度）：$k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$，$k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$，$k_{2} = 5.0 \\times 10^{1}\\ \\mathrm{s}^{-1}$，$E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$，$[S] = 1.0 \\times 10^{-8}\\ \\mathrm{M}$。\n- 情况 C（饱和底物浓度）：$k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$，$k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$，$k_{2} = 5.0 \\times 10^{1}\\ \\mathrm{s}^{-1}$，$E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$，$[S] = 1.0 \\times 10^{-2}\\ \\mathrm{M}$。\n- 情况 D（高转换率）：$k_{1} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$，$k_{-1} = 1.0 \\times 10^{2}\\ \\mathrm{s}^{-1}$，$k_{2} = 1.0 \\times 10^{5}\\ \\mathrm{s}^{-1}$，$E_{T} = 1.0 \\times 10^{-7}\\ \\mathrm{M}$，$[S] = 1.0 \\times 10^{-4}\\ \\mathrm{M}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表，结果按测试用例 A、B、C、D 的顺序排列，每个用例内部按固定的参数顺序 $[S_{k_{1}}, S_{k_{-1}}, S_{k_{2}}, S_{E_{T}}, S_{[S]}]$ 排列。例如，输出应类似于 $[a_{1},a_{2},a_{3},a_{4},a_{5},b_{1},b_{2},\\dots,d_{5}]$，其中每个 $a_{i}, b_{i}, c_{i}, d_{i}$ 是表示相应灵敏度系数的十进制数。",
            "solution": "用户希望从基元反应机理和准稳态近似 (QSSA) 出发，推导酶促反应速率相对于所有系统参数的归一化灵敏度系数。\n\n### 反应速率表达式的推导\n\n该问题描述了一个基于质量作用机制的单底物酶促反应：\n$$ E + S \\xrightleftharpoons[k_{-1}]{k_{1}} ES \\xrightarrow{k_{2}} E + P $$\n其中 $[E]$、$[S]$、$[ES]$ 和 $[P]$ 分别是游离酶、底物、酶-底物复合物和产物的浓度。速率常数为 $k_1$、$k_{-1}$ 和 $k_2$。\n\n相关物种浓度的变化速率由以下常微分方程组给出：\n$$ \\frac{d[E]}{dt} = -k_1 [E][S] + (k_{-1} + k_2) [ES] $$\n$$ \\frac{d[S]}{dt} = -k_1 [E][S] + k_{-1} [ES] $$\n$$ \\frac{d[ES]}{dt} = k_1 [E][S] - (k_{-1} + k_2) [ES] $$\n产物生成速率 $v$ 由下式给出：\n$$ v = \\frac{d[P]}{dt} = k_2 [ES] $$\n总酶浓度 $E_T$ 是守恒的：\n$$ E_T = [E] + [ES] \\implies [E] = E_T - [ES] $$\n准稳态近似 (QSSA)，也称为 Briggs-Haldane 近似，假设中间体酶-底物复合物 $[ES]$ 的浓度变化远慢于底物和产物的浓度变化。因此，我们可以将其变化速率设为零：\n$$ \\frac{d[ES]}{dt} \\approx 0 $$\n将此近似应用于 $[ES]$ 的速率方程：\n$$ k_1 [E][S] - (k_{-1} + k_2) [ES] = 0 $$\n现在，我们将守恒定律中游离酶浓度 $[E]$ 的表达式代入此稳态方程：\n$$ k_1 (E_T - [ES])[S] - (k_{-1} + k_2) [ES] = 0 $$\n我们现在可以解这个代数方程，求出酶-底物复合物的稳态浓度 $[ES]$：\n$$ k_1 E_T [S] - k_1 [ES][S] - (k_{-1} + k_2) [ES] = 0 $$\n$$ k_1 E_T [S] = [ES] (k_1 [S] + k_{-1} + k_2) $$\n$$ [ES] = \\frac{k_1 E_T [S]}{k_{-1} + k_2 + k_1 [S]} $$\n最后，我们将 $[ES]$ 的这个表达式代入反应速率 $v = k_2 [ES]$ 的方程中：\n$$ v = \\frac{k_1 k_2 E_T [S]}{k_{-1} + k_2 + k_1 [S]} $$\n此表达式给出了反应速率 $v$ 作为基元速率常数 $k_1, k_{-1}, k_2$、总酶浓度 $E_T$ 和底物浓度 $[S]$ 的函数。这就是 Michaelis-Menten 速率定律，可以写成 $v = \\frac{V_{max}[S]}{K_M + [S]}$，其中最大速率为 $V_{max} = k_2 E_T$，而在 Briggs-Haldane 解释下的米氏常数为 $K_M = \\frac{k_{-1} + k_2}{k_1}$。\n\n### 归一化灵敏度系数的推导\n\n速率 $v$ 关于参数 $p$ 的归一化灵敏度系数定义为：\n$$ S_p = \\frac{\\partial \\ln v}{\\partial \\ln p} = \\frac{p}{v} \\frac{\\partial v}{\\partial p} $$\n这个无量纲量衡量了由 $p$ 的分数变化引起的 $v$ 的分数变化。我们将为每个参数 $p \\in \\{k_1, k_{-1}, k_2, E_T, [S]\\}$ 推导 $S_p$ 的解析表达式。一个便捷的方法是首先对速率表达式取自然对数：\n$$ \\ln v = \\ln(k_1 k_2 E_T [S]) - \\ln(k_{-1} + k_2 + k_1 [S]) $$\n$$ \\ln v = \\ln(k_1) + \\ln(k_2) + \\ln(E_T) + \\ln([S]) - \\ln(k_{-1} + k_2 + k_1 [S]) $$\n我们用 $D = k_{-1} + k_2 + k_1 [S]$ 表示公分母项。\n\n1.  **关于 $k_1$ 的灵敏度 ($S_{k_1}$):**\n    $$ S_{k_1} = k_1 \\frac{\\partial (\\ln v)}{\\partial k_1} = k_1 \\left( \\frac{1}{k_1} - \\frac{[S]}{k_{-1} + k_2 + k_1 [S]} \\right) = 1 - \\frac{k_1 [S]}{D} = \\frac{D - k_1 [S]}{D} $$\n    $$ S_{k_1} = \\frac{(k_{-1} + k_2 + k_1 [S]) - k_1 [S]}{D} = \\frac{k_{-1} + k_2}{D} $$\n\n2.  **关于 $k_{-1}$ 的灵敏度 ($S_{k_{-1}}$):**\n    $$ S_{k_{-1}} = k_{-1} \\frac{\\partial (\\ln v)}{\\partial k_{-1}} = k_{-1} \\left( 0 - \\frac{1}{k_{-1} + k_2 + k_1 [S]} \\right) = -\\frac{k_{-1}}{D} $$\n\n3.  **关于 $k_2$ 的灵敏度 ($S_{k_2}$):**\n    $$ S_{k_2} = k_2 \\frac{\\partial (\\ln v)}{\\partial k_2} = k_2 \\left( \\frac{1}{k_2} - \\frac{1}{k_{-1} + k_2 + k_1 [S]} \\right) = 1 - \\frac{k_2}{D} = \\frac{D - k_2}{D} $$\n    $$ S_{k_2} = \\frac{(k_{-1} + k_2 + k_1 [S]) - k_2}{D} = \\frac{k_{-1} + k_1 [S]}{D} $$\n\n4.  **关于 $E_T$ 的灵敏度 ($S_{E_T}$):**\n    由于 $v$ 与 $E_T$ 成正比，归一化灵敏度为 1。\n    $$ S_{E_T} = E_T \\frac{\\partial (\\ln v)}{\\partial E_T} = E_T \\left( \\frac{1}{E_T} \\right) = 1 $$\n\n5.  **关于 $[S]$ 的灵敏度 ($S_{[S]}$):**\n    $$ S_{[S]} = [S] \\frac{\\partial (\\ln v)}{\\partial [S]} = [S] \\left( \\frac{1}{[S]} - \\frac{k_1}{k_{-1} + k_2 + k_1 [S]} \\right) = 1 - \\frac{k_1 [S]}{D} = \\frac{D - k_1 [S]}{D} $$\n    $$ S_{[S]} = \\frac{(k_{-1} + k_2 + k_1 [S]) - k_1 [S]}{D} = \\frac{k_{-1} + k_2}{D} $$\n\n### 解析表达式总结\n\n五个归一化灵敏度系数为：\n设 $D = k_{-1} + k_2 + k_1 [S]$。\n$$ S_{k_1} = \\frac{k_{-1} + k_2}{D} $$\n$$ S_{k_{-1}} = \\frac{-k_{-1}}{D} $$\n$$ S_{k_2} = \\frac{k_{-1} + k_1 [S]}{D} $$\n$$ S_{E_T} = 1 $$\n$$ S_{[S]} = \\frac{k_{-1} + k_2}{D} $$\n一个重要的观察是，对于该模型，$S_{k_1} = S_{[S]}$。此外，动力学参数存在一个求和性质：\n$$ S_{k_1} + S_{k_{-1}} + S_{k_2} = \\frac{k_{-1} + k_2}{D} + \\frac{-k_{-1}}{D} + \\frac{k_{-1} + k_1 [S]}{D} = \\frac{k_{-1} + k_2 - k_{-1} + k_{-1} + k_1[S]}{D} = \\frac{k_{-1} + k_2 + k_1[S]}{D} = 1 $$\n这可作为推导的一致性检验。这些最终的解析表达式将在程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the normalized sensitivity coefficients for the Michaelis-Menten\n    reaction rate based on analytical derivations.\n    \"\"\"\n\n    # Test suite of parameter sets.\n    # Parameters are (k1, k_minus1, k2, E_T, S).\n    # Units: k1 in M^-1 s^-1, k_minus1 in s^-1, k2 in s^-1, E_T in M, S in M.\n    test_cases = [\n        # Case A (balanced regime)\n        (1.0e6, 1.0e2, 5.0e1, 1.0e-7, 1.0e-4),\n        # Case B (low substrate)\n        (1.0e6, 1.0e2, 5.0e1, 1.0e-7, 1.0e-8),\n        # Case C (saturating substrate)\n        (1.0e6, 1.0e2, 5.0e1, 1.0e-7, 1.0e-2),\n        # Case D (high turnover)\n        (1.0e6, 1.0e2, 1.0e5, 1.0e-7, 1.0e-4),\n    ]\n\n    all_results = []\n\n    def calculate_sensitivities(k1, k_minus1, k2, E_T, S):\n        \"\"\"\n        Calculates the vector of five normalized sensitivity coefficients\n        using the derived closed-form expressions.\n\n        Args:\n            k1 (float): Forward rate constant for ES formation.\n            k_minus1 (float): Reverse rate constant for ES dissociation.\n            k2 (float): Catalytic rate constant (turnover number).\n            E_T (float): Total enzyme concentration.\n            S (float): Substrate concentration.\n\n        Returns:\n            list: A list of the five sensitivity coefficients\n                  [S_k1, S_k_minus1, S_k2, S_ET, S_S].\n        \"\"\"\n        # Common denominator term from the derived expressions\n        # D = k_(-1) + k_2 + k_1 * [S]\n        D = k_minus1 + k2 + k1 * S\n\n        # S_k1 = (k_(-1) + k_2) / D\n        s_k1 = (k_minus1 + k2) / D\n\n        # S_k_minus1 = -k_(-1) / D\n        s_k_minus1 = -k_minus1 / D\n\n        # S_k2 = (k_(-1) + k_1 * [S]) / D\n        s_k2 = (k_minus1 + k1 * S) / D\n\n        # S_ET = 1\n        s_ET = 1.0\n\n        # S_S = (k_(-1) + k_2) / D\n        s_S = (k_minus1 + k2) / D\n        \n        return [s_k1, s_k_minus1, s_k2, s_ET, s_S]\n\n    for case in test_cases:\n        k1, k_minus1, k2, E_T, S = case\n        sensitivities = calculate_sensitivities(k1, k_minus1, k2, E_T, S)\n        all_results.extend(sensitivities)\n\n    # Format the final output string as a comma-separated list of numbers\n    # enclosed in square brackets.\n    # The str() conversion is sufficient as it provides high precision.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}