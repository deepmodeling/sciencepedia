{
    "hands_on_practices": [
        {
            "introduction": "We begin with the foundational case of a linear first-order ordinary differential equation, the simplest representation of processes like drug clearance or radioactive decay. This practice  is designed to guide you through the derivation of the Euler method's fundamental stability condition from first principles. Understanding this limit is non-negotiable for any modeler, as it provides a concrete guideline for selecting a step size $h$ that ensures the numerical solution behaves correctly and does not diverge nonsensically.",
            "id": "3912967",
            "problem": "Consider a single-compartment pharmacokinetic clearance model in biomedical systems modeling where the concentration $x(t)$ evolves according to the Ordinary Differential Equation (ODE) $\\dot{x}(t) = a(t)\\,x(t)$, with $a(t)  0$ for all $t$. You intend to integrate this ODE numerically using the explicit Euler method with a uniform time step $h  0$. Starting strictly from the definition of the explicit Euler method applied to a scalar linear dynamical system and fundamental notions of stability, derive a condition on the time step $h$ that ensures the numerical solution decays in magnitude asymptotically whenever the continuous-time system is asymptotically stable, i.e., when $a$ is a negative constant. Next, extend your derivation to the case where $a(t)$ is time-varying but remains negative, and explain precisely how the stability-limited step size changes in that case, distinguishing between the use of a uniform step $h$ and a time-varying step sequence $\\{h_n\\}$.\n\nFinally, suppose the elimination rate exhibits a circadian modulation modeled by\n$$\na(t) = -\\big(\\alpha + \\beta \\cos(\\omega t)\\big),\n$$\nwith $\\alpha = 1.7\\,\\mathrm{s}^{-1}$, $\\beta = 0.2\\,\\mathrm{s}^{-1}$, and angular frequency $\\omega = 5\\,\\mathrm{s}^{-1}$. Over the time interval $[0,10]\\,\\mathrm{s}$, determine the largest uniform explicit Euler step size $h_{\\max}$ that guarantees linear stability of the numerical solution for all $t$ in the interval. Express your final answer in seconds and round your result to four significant figures.",
            "solution": "The problem requires the derivation of the stability condition for the explicit Euler method applied to a linear first-order Ordinary Differential Equation (ODE), first for a constant coefficient and then for a time-varying coefficient. Finally, this condition must be applied to a specific case involving a periodic coefficient to find the maximum stable uniform time step.\n\nLet's begin by analyzing the general scalar linear ODE:\n$$\n\\dot{x}(t) = \\frac{dx}{dt} = a(t)x(t)\n$$\nThe explicit Euler method approximates the solution at discrete time steps $t_n = n h$, where $h$ is the time step, by using the first-order Taylor expansion:\n$$\nx(t_{n+1}) \\approx x(t_n) + h \\dot{x}(t_n)\n$$\nDenoting the numerical approximation of $x(t_n)$ as $x_n$, the update rule becomes:\n$$\nx_{n+1} = x_n + h f(t_n, x_n)\n$$\nFor the given ODE, $f(t_n, x_n) = a(t_n)x_n$. Thus, the explicit Euler scheme is:\n$$\nx_{n+1} = x_n + h a(t_n) x_n = (1 + h a(t_n)) x_n\n$$\n\n**Part 1: Constant Coefficient Case**\nFirst, consider the case where $a(t) = a$ is a negative constant. The continuous system is $\\dot{x} = ax$, which has the solution $x(t) = x(0) \\exp(at)$. Since $a  0$, the solution is asymptotically stable, meaning $x(t) \\to 0$ as $t \\to \\infty$.\n\nThe numerical scheme becomes:\n$$\nx_{n+1} = (1 + h a) x_n\n$$\nFor the numerical solution to also be asymptotically stable, its magnitude must decay at each step, i.e., $|x_{n+1}|  |x_n|$ for $x_n \\neq 0$. This requires the magnitude of the amplification factor, $G = \\frac{x_{n+1}}{x_n} = 1 + h a$, to be strictly less than $1$:\n$$\n|G|  1 \\implies |1 + h a|  1\n$$\nThis inequality can be expanded as:\n$$\n-1  1 + h a  1\n$$\nThe right-hand side of the inequality, $1 + h a  1$, simplifies to $h a  0$. Since we are given $h  0$ and $a  0$, this condition is always satisfied.\nThe left-hand side of the inequality, $-1  1 + h a$, provides the critical stability constraint:\n$$\n-2  h a\n$$\nSince $a$ is negative, dividing by $a$ reverses the inequality sign:\n$$\nh  -\\frac{2}{a}\n$$\nSince $a0$, $-a = |a|$, so the condition can also be written as $h  \\frac{2}{|a|}$. This is the condition on the time step $h$ that ensures the numerical solution for the constant-coefficient system decays asymptotically.\n\n**Part 2: Time-Varying Coefficient Case**\nNow, let's extend the analysis to the case where $a(t)$ is\ntime-varying but always negative ($a(t)  0$ for all $t$). The Euler update rule at step $n$ is:\n$$\nx_{n+1} = (1 + h a(t_n)) x_n\n$$\nThe amplification factor at this step is $G_n = 1 + h a(t_n)$. For the numerical solution's magnitude to decay monotonically, we require $|G_n|  1$ at every step $n$.\n$$\n|1 + h a(t_n)|  1\n$$\nAs before, since $h  0$ and $a(t_n)  0$, the condition $1 + h a(t_n)  1$ is always met. The non-trivial constraint comes from $1 + h a(t_n)  -1$, which yields:\n$$\nh a(t_n)  -2 \\implies h  -\\frac{2}{a(t_n)}\n$$\nThis result allows for two scenarios for step size selection:\n\n1.  **Time-varying step sequence $\\{h_n\\}$**: One can adapt the step size at each iteration. The stability condition is simply $h_n  -\\frac{2}{a(t_n)}$. This allows for larger steps when $|a(t_n)|$ is small and forces smaller steps when $|a(t_n)|$ is large.\n\n2.  **Uniform step size $h$**: If a constant step size $h$ is used for the entire integration interval, it must satisfy the stability constraint for all possible values of $a(t)$ encountered. This means $h$ must be smaller than the minimum possible value of the bound $-\\frac{2}{a(t)}$.\n    $$\n    h  \\min_{t} \\left(-\\frac{2}{a(t)}\\right)\n    $$\n    Since $a(t)$ is negative, minimizing $-\\frac{2}{a(t)}$ is equivalent to finding the value of $t$ that makes $a(t)$ as negative as possible, i.e., finding the minimum of $a(t)$ over the interval. Let $a_{\\min} = \\min_{t} a(t)$. The condition for a uniform step size becomes:\n    $$\n    h  -\\frac{2}{a_{\\min}} = \\frac{2}{-a_{\\min}} = \\frac{2}{\\max_{t} |a(t)|}\n    $$\n    This ensures stability for the \"stiffest\" part of the system dynamics, where the rate of change is most rapid.\n\n**Part 3: Specific Case and Calculation**\nThe problem provides a specific model for the elimination rate:\n$$\na(t) = -\\big(\\alpha + \\beta \\cos(\\omega t)\\big)\n$$\nwith parameters $\\alpha = 1.7\\,\\mathrm{s}^{-1}$, $\\beta = 0.2\\,\\mathrm{s}^{-1}$, and $\\omega = 5\\,\\mathrm{s}^{-1}$. We need to find the largest uniform step size $h_{\\max}$ that guarantees stability over the time interval $t \\in [0, 10]\\,\\mathrm{s}$.\n\nFollowing the derivation for a uniform step size, we must satisfy the condition $h  2 / \\max_{t \\in [0,10]} |a(t)|$.\nLet's find the maximum value of $|a(t)|$ on the specified interval.\n$$\n|a(t)| = |-\\big(\\alpha + \\beta \\cos(\\omega t)\\big)| = \\alpha + \\beta \\cos(\\omega t)\n$$\nThe condition $\\alpha  \\beta  0$ ensures that $\\alpha + \\beta \\cos(\\omega t)$ is always positive, so the absolute value is straightforward.\n\nTo maximize this function, we need to maximize the term $\\cos(\\omega t)$. The maximum value of the cosine function is $1$. This occurs when its argument is an integer multiple of $2\\pi$, i.e., $\\omega t = 2k\\pi$ for $k \\in \\mathbb{Z}$.\nWe must check if such a $t$ exists in the interval $[0, 10]\\,\\mathrm{s}$.\nWith $\\omega = 5\\,\\mathrm{s}^{-1}$, this means $5t = 2k\\pi$, or $t = \\frac{2k\\pi}{5}$.\nFor $k=0$, $t=0$, which is in the interval. Thus, the maximum value is attained.\n\nThe maximum value of $|a(t)|$ is:\n$$\n\\max_{t \\in [0,10]} |a(t)| = \\alpha + \\beta \\cdot \\max_{t \\in [0,10]} (\\cos(\\omega t)) = \\alpha + \\beta \\cdot 1 = \\alpha + \\beta\n$$\nThe stability condition for a uniform step size $h$ is therefore:\n$$\nh  \\frac{2}{\\alpha + \\beta}\n$$\nThe largest uniform step size, $h_{\\max}$, is the supremum of this range:\n$$\nh_{\\max} = \\frac{2}{\\alpha + \\beta}\n$$\nSubstituting the given values $\\alpha = 1.7\\,\\mathrm{s}^{-1}$ and $\\beta = 0.2\\,\\mathrm{s}^{-1}$:\n$$\nh_{\\max} = \\frac{2}{1.7 + 0.2} = \\frac{2}{1.9}\\,\\mathrm{s}\n$$\nNow, we calculate the numerical value and round to four significant figures:\n$$\nh_{\\max} = \\frac{2}{1.9} \\approx 1.05263157... \\,\\mathrm{s}\n$$\nRounding to four significant figures yields $1.053\\,\\mathrm{s}$.",
            "answer": "$$\\boxed{1.053}$$"
        },
        {
            "introduction": "Real biological systems are characterized by nonlinear feedback loops. This exercise  advances our analysis to a more realistic nonlinear model of autocrine signaling, a ubiquitous mechanism in cellular communication. Here, you will see how an otherwise stable equilibrium in the continuous biological system can be rendered unstable by the numerical method, producing artificial oscillations in a phenomenon known as a flip or period-doubling instability. This practice is crucial for learning to distinguish true system dynamics from numerical artifacts.",
            "id": "3913014",
            "problem": "A single-compartment model of an inhibitory autocrine cytokine in a cell culture is described by the ordinary differential equation (ODE)\n$$\n\\frac{dx}{dt} = f(x) = \\frac{s}{1 + \\left(\\frac{x}{K}\\right)^{n}} - c\\,x,\n$$\nwhere $x(t)$ is the cytokine concentration, $s$ is the maximal production rate, $K$ is the half-saturation concentration, $n$ is a Hill coefficient governing repression strength, and $c$ is the first-order clearance rate. Assume that parameters are chosen to set the equilibrium at the half-saturation point by taking $s = 2\\,c\\,K$, so that $x^{\\ast} = K$ satisfies $f(x^{\\ast}) = 0$. Consider the explicit Euler method for numerically integrating the ODE,\n$$\nx_{k+1} = x_{k} + h\\,f(x_{k}),\n$$\nwith constant time step $h  0$. Starting from the fundamental definition of a continuous-time equilibrium and linearization, and the discrete-time linear stability of an equilibrium, derive the local discrete-time stability multiplier for the Euler update near $x^{\\ast}$ and show the condition under which Euler destabilizes a continuous-time stable equilibrium when $h$ is too large. Define a flip (period-doubling) instability as the loss of stability that occurs when the discrete-time multiplier crosses $-1$, and determine the critical step size $h_{\\mathrm{flip}}$ at which this occurs.\n\nUsing the parameter values $c = 0.7$ $\\mathrm{hr}^{-1}$, $n = 4$, and $K = 5$ $\\mathrm{ng}\\,\\mathrm{mL}^{-1}$ with $s = 2\\,c\\,K$, compute the numerical value of $h_{\\mathrm{flip}}$. Round your answer to four significant figures and express it in hours.",
            "solution": "The problem is valid as it is a well-posed, scientifically-grounded exercise in the stability analysis of a numerical method applied to a standard biomedical system model. All necessary information is provided, and the problem is free of contradictions or ambiguities.\n\nThe single-compartment model is described by the ordinary differential equation (ODE):\n$$\n\\frac{dx}{dt} = f(x) = \\frac{s}{1 + \\left(\\frac{x}{K}\\right)^{n}} - c\\,x\n$$\nwhere $x(t)$ is the cytokine concentration, and $s$, $K$, $n$, and $c$ are positive constants. The parameters are constrained such that $s = 2\\,c\\,K$, which establishes an equilibrium point at $x^{\\ast} = K$. We can verify this by substituting $x = K$ and $s = 2\\,c\\,K$ into $f(x)$:\n$$\nf(K) = \\frac{2\\,c\\,K}{1 + \\left(\\frac{K}{K}\\right)^{n}} - c\\,K = \\frac{2\\,c\\,K}{1 + 1^{n}} - c\\,K = \\frac{2\\,c\\,K}{2} - c\\,K = c\\,K - c\\,K = 0\n$$\nThus, $x^{\\ast} = K$ is indeed an equilibrium point of the continuous-time system.\n\nFirst, we determine the stability of this equilibrium in the continuous-time system. The local stability of an equilibrium $x^{\\ast}$ is determined by the sign of the derivative $f'(x^{\\ast}) = \\frac{df}{dx}|_{x=x^{\\ast}}$. The equilibrium is stable if $f'(x^{\\ast})  0$. We compute the derivative of $f(x)$:\n$$\nf'(x) = \\frac{d}{dx} \\left[ s \\left(1 + \\left(\\frac{x}{K}\\right)^{n}\\right)^{-1} - c\\,x \\right]\n$$\nUsing the chain rule:\n$$\nf'(x) = -s \\left(1 + \\left(\\frac{x}{K}\\right)^{n}\\right)^{-2} \\cdot \\frac{d}{dx}\\left(\\frac{x}{K}\\right)^{n} - c\n$$\n$$\nf'(x) = -s \\left(1 + \\left(\\frac{x}{K}\\right)^{n}\\right)^{-2} \\cdot n \\left(\\frac{x}{K}\\right)^{n-1} \\cdot \\frac{1}{K} - c\n$$\nNow, we evaluate this derivative at the equilibrium point $x^{\\ast} = K$:\n$$\nf'(K) = -s \\left(1 + \\left(\\frac{K}{K}\\right)^{n}\\right)^{-2} \\cdot \\frac{n}{K} \\left(\\frac{K}{K}\\right)^{n-1} - c\n$$\n$$\nf'(K) = -s \\left(1 + 1\\right)^{-2} \\cdot \\frac{n}{K} \\left(1\\right)^{n-1} - c = -s (2)^{-2} \\frac{n}{K} - c = -\\frac{s\\,n}{4\\,K} - c\n$$\nSubstituting the given condition $s = 2\\,c\\,K$:\n$$\nf'(K) = -\\frac{(2\\,c\\,K)\\,n}{4\\,K} - c = -\\frac{2\\,c\\,n}{4} - c = -\\frac{c\\,n}{2} - c = -c\\left(\\frac{n}{2} + 1\\right)\n$$\nSince the parameters $c$ and $n$ are positive, $f'(K)$ is strictly negative. Therefore, the equilibrium $x^{\\ast}=K$ is locally stable in the continuous-time model.\n\nNext, we analyze the explicit Euler method for this ODE:\n$$\nx_{k+1} = x_{k} + h\\,f(x_{k})\n$$\nThis is a discrete-time dynamical system of the form $x_{k+1} = G(x_k)$, where the update function is $G(x) = x + h\\,f(x)$. The equilibrium point $x^{\\ast}$ of the ODE is a fixed point of this map, since $f(x^{\\ast})=0$ implies $G(x^{\\ast}) = x^{\\ast} + h \\cdot 0 = x^{\\ast}$.\n\nThe local stability of the fixed point $x^{\\ast}$ in the discrete-time system is determined by the local stability multiplier, $\\lambda$, which is the derivative of the update function evaluated at the fixed point:\n$$\n\\lambda = G'(x^{\\ast}) = \\frac{d}{dx}\\left[x + h\\,f(x)\\right]_{x=x^{\\ast}} = 1 + h\\,f'(x^{\\ast})\n$$\nThe fixed point is stable if and only if $|\\lambda|  1$, which translates to the condition $-1  \\lambda  1$.\nSubstituting the expression for $f'(K)$:\n$$\n\\lambda = 1 + h \\left[-c\\left(\\frac{n}{2} + 1\\right)\\right] = 1 - h\\,c\\left(\\frac{n}{2} + 1\\right)\n$$\nThe stability condition is:\n$$\n-1  1 - h\\,c\\left(\\frac{n}{2} + 1\\right)  1\n$$\nWe analyze the two inequalities separately. The right-hand inequality is:\n$$\n1 - h\\,c\\left(\\frac{n}{2} + 1\\right)  1 \\implies -h\\,c\\left(\\frac{n}{2} + 1\\right)  0\n$$\nSince $h0$, $c0$, and $n0$, the term $h\\,c\\left(\\frac{n}{2} + 1\\right)$ is always positive, so this inequality is always satisfied.\n\nThe left-hand inequality determines the stability boundary:\n$$\n-1  1 - h\\,c\\left(\\frac{n}{2} + 1\\right) \\implies h\\,c\\left(\\frac{n}{2} + 1\\right)  2\n$$\n$$\nh  \\frac{2}{c\\left(\\frac{n}{2} + 1\\right)}\n$$\nIf the step size $h$ exceeds this critical value, the multiplier $\\lambda$ becomes less than $-1$, and the numerically computed solution will exhibit growing oscillations around the equilibrium, even though the underlying continuous-time equilibrium is stable. This is the condition under which the Euler method destabilizes a stable equilibrium.\n\nA flip or period-doubling instability occurs at the precise point where stability is lost, which is when the multiplier $\\lambda$ crosses $-1$. The critical step size, $h_{\\mathrm{flip}}$, is the value of $h$ for which $\\lambda = -1$.\n$$\n1 - h_{\\mathrm{flip}}\\,c\\left(\\frac{n}{2} + 1\\right) = -1\n$$\nSolving for $h_{\\mathrm{flip}}$:\n$$\nh_{\\mathrm{flip}}\\,c\\left(\\frac{n}{2} + 1\\right) = 2\n$$\n$$\nh_{\\mathrm{flip}} = \\frac{2}{c\\left(\\frac{n}{2} + 1\\right)}\n$$\nThis is the analytical expression for the critical step size.\n\nFinally, we compute the numerical value of $h_{\\mathrm{flip}}$ using the given parameter values: $c = 0.7$ $\\mathrm{hr}^{-1}$ and $n = 4$. The value of $K$ is not needed for this calculation.\n$$\nh_{\\mathrm{flip}} = \\frac{2}{0.7 \\left(\\frac{4}{2} + 1\\right)} = \\frac{2}{0.7 \\left(2 + 1\\right)} = \\frac{2}{0.7 \\times 3} = \\frac{2}{2.1}\n$$\n$$\nh_{\\mathrm{flip}} = \\frac{20}{21} \\approx 0.95238095... \\, \\mathrm{hr}\n$$\nRounding the result to four significant figures, we get $0.9524$ hours.",
            "answer": "$$\n\\boxed{0.9524}\n$$"
        },
        {
            "introduction": "This final practice serves as a capstone, challenging you to apply the Euler method to a complete and practical biomedical problem: simulating drug concentration following a schedule of repeated bolus doses . This task requires not only implementing the core Euler step for the decay process but also handling the discrete \"events\" of drug administration. By comparing your numerical simulation against the known analytical solution, you will directly quantify the method's systematic error, or bias, and gain invaluable experience in building and validating a simulation for a hybrid continuous-discrete system.",
            "id": "3913071",
            "problem": "Consider a linear one-compartment pharmacokinetic model with first-order elimination, subjected to instantaneous bolus dosing at regularly spaced times. Let $C(t)$ denote the drug concentration in plasma, assumed to be spatially well-mixed. The mass balance for a one-compartment system with first-order elimination is $V \\,\\dfrac{dC}{dt} = - \\mathrm{CL}\\, C$, where $V$ is the volume of distribution and $\\mathrm{CL}$ is the clearance. Define the elimination rate constant $k = \\mathrm{CL}/V$. A bolus dose of size $D$ administered instantaneously at time $t_k = k \\,\\tau$ (for integer $k \\ge 0$) is modeled as an instantaneous jump in concentration: $C(t_k^+) = C(t_k^-) + D/V$. Between doses, the dynamics are governed by the ordinary differential equation (ODE): $\\dfrac{dC}{dt} = -k C$. All physical quantities are to be expressed in their standard units: dose $D$ in $\\mathrm{mg}$, volume $V$ in $\\mathrm{L}$, clearance $\\mathrm{CL}$ in $\\mathrm{L}\\,\\mathrm{h}^{-1}$, concentration $C$ in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$, time $t$ in $\\mathrm{h}$, dosing interval $\\tau$ in $\\mathrm{h}$, and step size $h$ in $\\mathrm{h}$.\n\nTask: Implement an explicit forward Euler numerical integrator for the ODE between dosing times, with the following event-handling requirement: if a dosing time $t_k$ falls strictly within a base step of size $h$, the step must be split so that one substep ends exactly at $t_k$, the instantaneous jump is applied, and the integration continues. Use a fixed base step size $h$ for the integrator. The repeated dosing schedule is a bolus dose at $t=0$ and every $\\tau$ thereafter.\n\nFor each parameter set in the test suite below:\n1. Simulate the system until it reaches steady state. Use the following criterion to choose the number of doses to simulate: choose the smallest integer $M$ such that $\\exp(-k \\,\\tau\\, M) \\le \\epsilon$, with $\\epsilon = 10^{-10}$, and simulate $M$ dosing intervals starting from $C(0^+) = D/V$. This criterion guarantees that the residual memory of the initial condition decays to a negligible level for a linear system.\n2. From the last dosing interval simulated, compute the Euler-approximated steady-state peak concentration (just after a dose) and steady-state trough concentration (just before the next dose). Denote these by $C_{\\mathrm{peak,\\,Euler}}$ and $C_{\\mathrm{trough,\\,Euler}}$, respectively, both in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$.\n3. Compute the corresponding exact continuous-time steady-state peak and trough concentrations, $C_{\\mathrm{peak,\\,exact}}$ and $C_{\\mathrm{trough,\\,exact}}$, for the same model with instantaneous boluses every $\\tau$, using an analytical calculation derived from the fundamental solution of the linear ODE with jumps. Express these in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$.\n4. Report the signed biases, defined as $\\mathrm{bias}_{\\mathrm{peak}} = C_{\\mathrm{peak,\\,Euler}} - C_{\\mathrm{peak,\\,exact}}$ and $\\mathrm{bias}_{\\mathrm{trough}} = C_{\\mathrm{trough,\\,Euler}} - C_{\\mathrm{trough,\\,exact}}$, in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$ for each parameter set.\n\nYour program must implement the above logic and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, aggregating the results for all test cases in order. For each test case, output the two floating-point numbers $[\\mathrm{bias}_{\\mathrm{peak}}, \\mathrm{bias}_{\\mathrm{trough}}]$ in sequence, flattened into a single list. All outputs must be expressed in $\\mathrm{mg}\\,\\mathrm{L}^{-1}$ as decimal numbers (no percentage signs).\n\nTest suite (five parameter sets), each specified as $(D, V, \\mathrm{CL}, \\tau, h)$:\n- Case A (happy path, fine resolution): $(1000, 50, 5, 12, 0.5)$ with $D=1000\\,\\mathrm{mg}$, $V=50\\,\\mathrm{L}$, $\\mathrm{CL}=5\\,\\mathrm{L}\\,\\mathrm{h}^{-1}$, $\\tau=12\\,\\mathrm{h}$, $h=0.5\\,\\mathrm{h}$.\n- Case B (coarser but aligned, $\\tau/h$ integer): $(1000, 50, 5, 12, 3)$ with $h=3\\,\\mathrm{h}$.\n- Case C (coarser and non-aligned, tests step splitting): $(1000, 50, 5, 8, 3)$ with $\\tau=8\\,\\mathrm{h}$, $h=3\\,\\mathrm{h}$.\n- Case D (very coarse with positive Euler per-step factor, tests large $h$ effects): $(1000, 50, 5, 24, 9.5)$ with $\\tau=24\\,\\mathrm{h}$, $h=9.5\\,\\mathrm{h}$.\n- Case E (single-step per dosing interval): $(1000, 50, 5, 6, 6)$ with $\\tau=6\\,\\mathrm{h}$, $h=6\\,\\mathrm{h}$.\n\nFinal output format requirement:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,\\dots,x_{10}]$ for the five cases, each contributing two numbers in order: peak bias then trough bias). All numbers must be floats representing $\\mathrm{mg}\\,\\mathrm{L}^{-1}$, in decimal notation.",
            "solution": "The user wants to analyze a linear one-compartment pharmacokinetic model with first-order elimination and repeated instantaneous bolus dosing. The task is to compare the steady-state peak and trough drug concentrations obtained from an analytical solution with those from a numerical simulation using the explicit forward Euler method. The biases between the numerical and analytical results are to be reported for several parameter sets.\n\nThe core of the problem involves two main parts: deriving the exact analytical solution and implementing a careful numerical simulation that handles the dosing events.\n\n**1. Analytical Steady-State Solution**\n\nThe system is described by the linear ordinary differential equation (ODE) between doses:\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\nwhere $k = \\mathrm{CL}/V$ is the elimination rate constant. The solution to this ODE is $C(t) = C_0 e^{-kt}$, where $C_0$ is the concentration at $t=0$ for the decay period.\n\nA bolus dose of size $D$ is administered every $\\tau$ hours. This introduces a periodic jump in concentration of magnitude $D/V$. Let $C_{\\mathrm{peak}, n}$ be the peak concentration immediately after the $n$-th dose, and $C_{\\mathrm{trough}, n}$ be the trough concentration immediately before the $n$-th dose.\n\nThe concentration decays over the dosing interval $\\tau$:\n$$\nC_{\\mathrm{trough}, n+1} = C_{\\mathrm{peak}, n} \\, e^{-k\\tau}\n$$\nImmediately after the decay, the next dose is administered:\n$$\nC_{\\mathrm{peak}, n+1} = C_{\\mathrm{trough}, n+1} + \\frac{D}{V} = C_{\\mathrm{peak}, n} \\, e^{-k\\tau} + \\frac{D}{V}\n$$\nThis is a linear recurrence relation for the peak concentrations. At steady state, the concentrations from one interval to the next are identical, so $C_{\\mathrm{peak}, n+1} = C_{\\mathrm{peak}, n} = C_{\\mathrm{peak,\\,exact}}$.\n$$\nC_{\\mathrm{peak,\\,exact}} = C_{\\mathrm{peak,\\,exact}} \\, e^{-k\\tau} + \\frac{D}{V}\n$$\nSolving for $C_{\\mathrm{peak,\\,exact}}$ gives the analytical steady-state peak concentration:\n$$\nC_{\\mathrm{peak,\\,exact}} \\left(1 - e^{-k\\tau}\\right) = \\frac{D}{V} \\implies C_{\\mathrm{peak,\\,exact}} = \\frac{D/V}{1 - e^{-k\\tau}}\n$$\nThe corresponding steady-state trough concentration is found by applying the decay over one interval:\n$$\nC_{\\mathrm{trough,\\,exact}} = C_{\\mathrm{peak,\\,exact}} \\, e^{-k\\tau}\n$$\n\n**2. Numerical Simulation using Forward Euler Method**\n\nThe forward Euler method is used to approximate the solution of the ODE. For a step size $\\Delta t$, the update rule is:\n$$\nC(t + \\Delta t) \\approx C(t) + \\Delta t \\left( \\frac{dC}{dt} \\right)\\bigg|_t = C(t) + \\Delta t (-k C(t)) = C(t) (1 - k \\Delta t)\n$$\nThe simulation protocol requires reaching a practical steady state. This is achieved by simulating a sufficient number of dosing intervals, $M$, until the effect of the initial condition $C(0)=0$ has vanished. The criterion is to choose the smallest integer $M$ such that $e^{-k\\tau M} \\le \\epsilon$, where $\\epsilon = 10^{-10}$. Taking the natural logarithm and rearranging gives:\n$$\n-k\\tau M \\le \\ln(\\epsilon) \\implies M \\ge \\frac{-\\ln(\\epsilon)}{k\\tau}\n$$\nSo, we choose $M = \\lceil \\frac{-\\ln(\\epsilon)}{k\\tau} \\rceil$.\n\nThe simulation is structured as a loop over $M$ dosing intervals. This design cleanly separates the continuous decay dynamics from the discrete dosing events.\n\nFor each interval $j \\in \\{0, 1, \\dots, M-1\\}$:\n1.  **Dosing Event:** The concentration at the beginning of the interval, $C_{\\mathrm{trough}}$, is increased by the bolus dose: $C_{\\mathrm{peak}} = C_{\\mathrm{trough}} + D/V$. If this is the last interval (i.e., $j = M-1$), this peak value is recorded as $C_{\\mathrm{peak,\\,Euler}}$.\n2.  **Decay Phase:** The decay over the interval of duration $\\tau$ is simulated. This is done by taking multiple Euler steps. To correctly handle the event timing as specified, a fixed base step size $h$ is used. For each step within the interval, the actual step size $\\Delta t$ is determined as the minimum of the base step size $h$ and the remaining time in the current dosing interval. That is, if the current local time within the interval is $t_{\\mathrm{local}}$, then $\\Delta t = \\min(h, \\tau - t_{\\mathrm{local}})$. This ensures that the simulation proceeds in steps of size $h$ but takes a final, smaller step to land exactly at the end of the interval, thus correctly implementing the specified step-splitting logic.\n3.  **Update:** After simulating the decay over the interval, the final concentration is the trough for the next interval.\n\nAfter the loop over $M$ intervals completes, the final concentration is the steady-state trough, $C_{\\mathrm{trough,\\,Euler}}$.\n\n**3. Bias Calculation**\n\nFinally, the signed biases are computed by subtracting the analytical values from the numerical approximations:\n$$\n\\mathrm{bias}_{\\mathrm{peak}} = C_{\\mathrm{peak,\\,Euler}} - C_{\\mathrm{peak,\\,exact}}\n$$\n$$\n\\mathrm{bias}_{\\mathrm{trough}} = C_{\\mathrm{trough,\\,Euler}} - C_{\\mathrm{trough,\\,exact}}\n$$\nAs the forward Euler method is a first-order method applied to a convex solution curve ($C''(t) = k^2 C(t)  0$), it is expected to underestimate the true concentration at each step. This leads to the prediction that both biases will be negative for the given stable test cases where $1-kh  0$. The implementation will compute these biases for each specified parameter set.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are required or permitted.\n\ndef solve():\n    \"\"\"\n    Main function to solve the pharmacokinetic modeling problem.\n    It iterates through test cases, runs simulations, and prints the results.\n    \"\"\"\n\n    test_cases = [\n        # (D, V, CL, tau, h)\n        (1000.0, 50.0, 5.0, 12.0, 0.5),   # Case A\n        (1000.0, 50.0, 5.0, 12.0, 3.0),   # Case B\n        (1000.0, 50.0, 5.0, 8.0, 3.0),    # Case C\n        (1000.0, 50.0, 5.0, 24.0, 9.5),   # Case D\n        (1000.0, 50.0, 5.0, 6.0, 6.0),    # Case E\n    ]\n\n    all_results = []\n    for case in test_cases:\n        D, V, CL, tau, h = case\n        \n        # Calculate constants\n        k = CL / V\n        dose_conc_jump = D / V\n        epsilon = 1e-10\n\n        # --- Part 1: Analytical Solution ---\n        # The denominator 1 - exp(-k*tau) is always  0 for k0, tau0.\n        C_peak_exact = dose_conc_jump / (1.0 - np.exp(-k * tau))\n        C_trough_exact = C_peak_exact * np.exp(-k * tau)\n\n        # --- Part 2: Numerical Simulation with Forward Euler ---\n        # Determine the number of dosing intervals to simulate to reach steady state\n        # The equation is M = -log(epsilon) / (k * tau)\n        M = int(np.ceil(-np.log(epsilon) / (k * tau)))\n\n        # Initialize simulation variables\n        C_current_trough = 0.0  # Concentration just before a dose\n        C_peak_euler = 0.0\n        \n        # Loop through M dosing intervals\n        for j in range(M):\n            # Apply dose to get the peak concentration for the current interval\n            C_peak_for_interval = C_current_trough + dose_conc_jump\n\n            # If this is the last interval (j = M-1), store the peak value\n            if j == M - 1:\n                C_peak_euler = C_peak_for_interval\n            \n            # Simulate the decay over the interval of duration tau\n            C_in_interval = C_peak_for_interval\n            t_local = 0.0\n            \n            # Use a small tolerance relative to tau to avoid infinite loops from float errors\n            while t_local  tau - 1e-9 * tau:\n                # Determine step size: min of base step h and remaining time in interval\n                dt = min(h, tau - t_local)\n                \n                # Apply Forward Euler step\n                C_in_interval = C_in_interval * (1.0 - k * dt)\n                \n                # Advance local time\n                t_local += dt\n\n            # Update the trough concentration for the next interval\n            C_current_trough = C_in_interval\n        \n        # The final trough concentration is the value at the end of the last interval\n        C_trough_euler = C_current_trough\n\n        # --- Part 3: Calculate Biases ---\n        bias_peak = C_peak_euler - C_peak_exact\n        bias_trough = C_trough_euler - C_trough_exact\n        \n        all_results.append(bias_peak)\n        all_results.append(bias_trough)\n\n    # Final print statement in the exact required format.\n    # Using a specific format string for floats to ensure decimal notation.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}