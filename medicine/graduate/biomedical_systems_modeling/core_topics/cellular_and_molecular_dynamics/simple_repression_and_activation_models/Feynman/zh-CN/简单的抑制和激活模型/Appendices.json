{
    "hands_on_practices": [
        {
            "introduction": "第一个实践是构建和理解转录调控的基石。我们将从最经典的简单抑制模型入手，在该模型中，一个抑制蛋白通过物理阻碍的方式阻止RNA聚合酶与启动子结合。通过定义系统的微观状态及其对应的统计权重，你将推导出“倍数变化”(fold-change)的表达式，这是量化抑制强度的关键指标。这项练习不仅能巩固热力学建模的基本原理，还将引导你得出一个关于半数最大抑制条件的深刻结论 。",
            "id": "3927112",
            "problem": "考虑一个细菌细胞中受单个阻遏蛋白调控的启动子。该启动子可以处于三种相互排斥的微观状态之一：空置、与核糖核酸聚合酶（RNAP）结合或与阻遏蛋白结合。假设采用以下生物物理框架：\n\n- 该系统在巨正则系综中建模，其中转录因子库的化学势固定，启动子微观状态被赋予与其玻尔兹曼因子成正比的统计权重。\n- 在无协同性、RNAP和阻遏蛋白各有单个结合位点，以及RNAP和阻遏蛋白的结合相互排斥的假设下，空置、RNAP结合和阻遏蛋白结合状态的统计权重分别为$1$、$p$和$r$，其中 $p \\equiv [P]/K_{P}$ 和 $r \\equiv [R]/K_{R}$ 是由RNAP和阻遏蛋白的浓度 $[P]$ 和 $[R]$ 及其解离常数 $K_{P}$ 和 $K_{R}$ 定义的无量纲参数。\n\n假设转录输出与RNAP结合到启动子的概率成正比。将在阻遏作用下表达的倍数变化定义为存在阻遏蛋白时RNAP结合概率与不存在阻遏蛋白时RNAP結合概率之比：\n$$f \\equiv \\frac{\\text{Probability of RNAP-bound with repressor}}{\\text{Probability of RNAP-bound without repressor}}.$$\n\n从上述建模假设和基本统计力学（状态概率等于其权重除以配分函数之和）出发，推导出$f$作为$p$和$r$的函数，然后施加半数最大阻遏条件$f = 0.5$，并求解所需的$r$（用$p$表示）。\n\n将最终答案表示为单个闭式解析表达式，无单位。无需四舍五入。",
            "solution": "用户提供了一个必须首先验证的问题陈述。\n\n### 步骤1：提取已知条件\n- 系统：一个受单个阻遏蛋白调控的启动子。\n- 微观状态：三个相互排斥的状态：空置、与RNAP结合、与阻遏蛋白结合。\n- 模型框架：巨正则系综，化学势固定。\n- 统计权重：\n  - 空置状态：$w_{\\text{empty}} = 1$\n  - RNAP结合状态：$w_{\\text{RNAP}} = p$，其中 $p \\equiv [P]/K_{P}$\n  - 阻遏蛋白结合状态：$w_{\\text{rep}} = r$，其中 $r \\equiv [R]/K_{R}$\n- 假设：无协同性，单个结合位点，RNAP和阻遏蛋白的结合相互排斥。\n- 转录输出的定义：与RNAP结合到启动子的概率成正比。\n- 倍数变化的定义：$f \\equiv \\frac{\\text{Probability of RNAP-bound with repressor}}{\\text{Probability of RNAP-bound without repressor}}$。\n- 任务：\n  1. 推导出$f$作为$p$和$r$的函数。\n  2. 施加条件$f = 0.5$。\n  3. 求解$r$（用$p$表示）。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了统计生物物理学中的典型简单阻遏模型。这是一个用于理解基因调控的基础、成熟的模型。在该领域中，使用巨正则系综、统计权重（玻尔兹曼因子）和配分函数是标准做法。所有前提都具有科学合理性。\n2.  **适定性**：该问题是适定的。它提供了所有必要的定义，并要求进行特定的推导和代数求解。步骤逻辑清晰，能导出一个唯一的、有意义的答案。\n3.  **客观性**：语言精确、定量，没有任何主观或模糊的术语。\n\n该问题没有任何缺陷。它不是科学上不合理、不可形式化、不完整、不切实际、不适定、微不足道或无法验证的。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供解答。\n\n### 推导\n该问题要求我们将统计力学原理应用于一个简单的基因调控模型。系统处于特定微观状态$i$的概率$P_i$由其统计权重$w_i$与配分函数$Z$之比给出，其中配分函数$Z$是所有可能微观状态的统计权重之和。\n$$P_i = \\frac{w_i}{Z}$$\n\n首先，我们考虑存在阻遏蛋白的系统。可能的微观状态是空置、RNAP结合和阻遏蛋白结合。其统计权重分别为$1$、$p$和$r$。配分函数$Z_{\\text{with\\_R}}$是这些权重之和：\n$$Z_{\\text{with\\_R}} = 1 + p + r$$\nRNAP与启动子结合的概率，我们记为$P(\\text{RNAP} | \\text{with\\_R})$，是RNAP结合状态的权重除以此配分函数：\n$$P(\\text{RNAP} | \\text{with\\_R}) = \\frac{p}{1 + p + r}$$\n\n接下来，我们考虑不存在阻遏蛋白的系统。不存在阻遏蛋白意味着其浓度为零，即$[R]=0$。这意味着无量纲参数$r \\equiv [R]/K_R$也为零：$r=0$。在这种情况下，阻遏蛋白结合状态是不可及的。可能的微观状态只有空置和RNAP结合。配分函数$Z_{\\text{without\\_R}}$为：\n$$Z_{\\text{without\\_R}} = 1 + p$$\n或者，也可以通过在通用配分函数$Z_{\\text{with\\_R}}$中令$r=0$得到此结果。在不存在阻遏蛋白的情况下RNAP结合的概率$P(\\text{RNAP} | \\text{without\\_R})$则为：\n$$P(\\text{RNAP} | \\text{without\\_R}) = \\frac{p}{1 + p}$$\n\n现在，我们可以使用其定义，即这两个概率之比，来计算倍数变化$f$：\n$$f = \\frac{P(\\text{RNAP} | \\text{with\\_R})}{P(\\text{RNAP} | \\text{without\\_R})} = \\frac{\\frac{p}{1 + p + r}}{\\frac{p}{1 + p}}$$\n通过约去公因子$p$并将分母取倒数，简化此表达式可得：\n$$f = \\frac{1 + p}{1 + p + r}$$\n这就是倍数变化$f$作为$p$和$r$的函数表达式。\n\n最后一步是施加半数最大阻遏条件，即$f = 0.5$或$f = \\frac{1}{2}$。我们将推导出的$f$的表达式设为该值，并求解$r$。\n$$\\frac{1 + p}{1 + p + r} = \\frac{1}{2}$$\n为求解$r$，我们可以进行交叉相乘：\n$$2(1 + p) = 1(1 + p + r)$$\n$$2 + 2p = 1 + p + r$$\n现在，我们通过从等式两边减去$(1+p)$来分離出$r$：\n$$r = (2 + 2p) - (1 + p)$$\n$$r = 2 - 1 + 2p - p$$\n$$r = 1 + p$$\n因此，为使倍数变化恰好为$0.5$，阻遏蛋白的无量纲浓度$r$必须等于$1 + p$。",
            "answer": "$$\\boxed{1 + p}$$"
        },
        {
            "introduction": "在抑制模型的基础上，这个实践将我们的视野扩展到其对应部分：简单激活，并要求你比较这两种基本的调控策略。你将把统计力学框架应用于一个涉及激活蛋白和RNA聚合酶之间协同结合的场景，并为两种调控架构推导倍数变化。此练习的核心在于分析系统在饱和状态下的行为——即当调控蛋白浓度非常高时——以理解抑制和激活的极限。这种比较分析  对于领会不同调控设计如何实现独特的功能性结果至关重要。",
            "id": "3927157",
            "problem": "考虑细菌细胞中单个基因启动子的两种经典转录调控架构：由阻断型阻遏蛋白引起的简单抑制，以及通过招募RNA聚合酶（RNA polymerase, RNAP）实现的简单激活。假设采用以下基于平衡占据和统计热力学的广泛使用的建模框架：转录速率与RNAP结合到启动子的概率成正比，在平衡状态下，每个启动子状态的概率与其统计权重成正比。每个特异性结合事件贡献一个等于无量纲活性的因子，该活性结合了调控蛋白的丰度及其与位点的平衡缔合。\n\n对于简单抑制（阻断），将启动子状态建模为：空、RNAP结合和阻遏蛋白结合，其中阻遏蛋白排斥RNAP的结合。对于简单激活（招募），将启动子状态建模为：空、仅RNAP结合、仅激活蛋白结合、以及RNAP与激活蛋白共同结合，其中RNAP与激活蛋白共同结合的状态相对于单个结合权重的乘积，具有一个额外的协同增强因子 $f>1$。令 $p$ 表示RNAP在启动子上结合的无量纲权重，$r$ 表示阻遏蛋白在操纵子上结合的无量纲权重，$a$ 表示激活蛋白在其位点上结合的无量纲权重。将 $f$ 视为一个固定的、无量纲的协同参数，它源于联合复合物中RNAP和激活蛋白之间的相互作用能。\n\n定义表达的倍数变化 $\\mathrm{fc}$ 为，在受调控的启动子中RNAP结合概率与相应的不受调控的启动子（即没有调控蛋白存在，对于抑制是 $r=0$，对于激活是 $a=0$）中RNAP结合概率之比，并保持 $p$ 固定。使用上述占据框架，并且不引入任何额外的状态或过程，从第一性原理出发推导每种架构下 $\\mathrm{fc}$ 的精确表达式，然后分析调控蛋白强占据其位点的饱和区域：对于抑制是 $r\\to\\infty$，对于激活是 $a\\to\\infty$。根据您的推导，确定以下关于极限行为的陈述中哪些是正确的。\n\nA. 在有限 $p$ 的简单抑制中，当 $r\\to\\infty$ 时，倍数变化服从 $\\mathrm{fc}_{\\mathrm{R}}\\sim (1+p)/r$，因此 $\\mathrm{fc}_{\\mathrm{R}}\\to 0$。\n\nB. 在有限 $p$ 和固定 $f>1$ 的简单激活中，当 $a\\to\\infty$ 时，倍数变化趋近于 $\\mathrm{fc}_{\\mathrm{A}}\\to f(1+p)/(1+fp)$。\n\nC. 在弱启动子 $p\\ll 1$ 的简单激活中，当 $a\\to\\infty$ 时的饱和增强简化为 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\approx f$。\n\nD. 对于非常强的启动子 $p\\gg 1$，在饱和极限下，抑制和激活都不能改变表达；具体来说，当 $r\\to\\infty$ 时 $\\mathrm{fc}_{\\mathrm{R}}\\to 1$ 且当 $a\\to\\infty$ 时 $\\mathrm{fc}_{\\mathrm{A}}\\to 1$。\n\nE. 在弱启动子 $p\\ll 1$ 的简单抑制中，对于所有 $r\\ge 0$，在有限 $r$ 下的倍数变化简化为 $\\mathrm{fc}_{\\mathrm{R}}\\approx 1/(1+r)$。\n\nF. 在固定的有限 $p>0$ 的简单激活中，如果 $f\\to\\infty$ 和 $a\\to\\infty$ 同时成立，那么最大增强将无界发散，即 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\to\\infty$。\n\n选择所有正确选项。",
            "solution": "我们从统计热力学占据模型开始。核心假设是：(i) 启动子存在于一组有限的互斥状态中，(ii) 一个状态的概率与其统计权重成正比，该权重等于结合因子的活性乘积再乘以任何相互作用因子，(iii) 转录速率与RNA聚合酶（RNAP）结合的概率成正比，因此倍数变化 $\\mathrm{fc}$ 是受调控和不受调控情况下RNAP结合概率的比值。\n\n简单抑制（阻断）。各个状态及其权重为：空，权重为 $1$；RNAP结合，权重为 $p$；阻遏蛋白结合，权重为 $r$。阻遏蛋白排斥RNAP，因此不存在RNAP与阻遏蛋白共同结合的状态。配分函数为\n$$\nZ_{\\mathrm{R}}=1+p+r.\n$$\n在有阻遏蛋白存在时，RNAP结合的概率是\n$$\n\\mathbb{P}_{\\mathrm{R}}(\\text{RNAP})=\\frac{p}{1+p+r}.\n$$\n相应的无调控启动子（无阻遏蛋白）的配分函数为 $Z_{0}=1+p$，RNAP占据率为\n$$\n\\mathbb{P}_{0}(\\text{RNAP})=\\frac{p}{1+p}.\n$$\n根据定义，抑制作用的表达倍数变化是\n$$\n\\mathrm{fc}_{\\mathrm{R}}=\\frac{\\mathbb{P}_{\\mathrm{R}}(\\text{RNAP})}{\\mathbb{P}_{0}(\\text{RNAP})}=\\frac{\\dfrac{p}{1+p+r}}{\\dfrac{p}{1+p}}=\\frac{1+p}{1+p+r}.\n$$\n抑制作用的饱和分析。在有限 $p$ 的情况下，当 $r\\to\\infty$ 时，我们有\n$$\n\\mathrm{fc}_{\\mathrm{R}}=\\frac{1+p}{1+p+r}\\sim \\frac{1+p}{r}\\to 0,\n$$\n因此，倍数变化与 $r$ 成反比衰减并趋于零。\n\n简单激活（招募）。各个状态及其权重为：空，权重为 $1$；仅RNAP结合，权重为 $p$；仅激活蛋白结合，权重为 $a$；RNAP与激活蛋白共同结合，权重为 $fpa$，其中 $f>1$ 是来自有利的RNAP-激活蛋白相互作用的协同因子。配分函数为\n$$\nZ_{\\mathrm{A}}=1+p+a+fpa.\n$$\n在有激活蛋白存在时，RNAP结合的概率是\n$$\n\\mathbb{P}_{\\mathrm{A}}(\\text{RNAP})=\\frac{p+fpa}{1+p+a+fpa}= \\frac{p(1+fa)}{1+p+a+fpa}.\n$$\n如前所述，无调控启动子（无激活蛋白）的配分函数为 $Z_{0}=1+p$，且 $\\mathbb{P}_{0}(\\text{RNAP})=p/(1+p)$。因此，激活作用的倍数变化是\n$$\n\\mathrm{fc}_{\\mathrm{A}}=\\frac{\\mathbb{P}_{\\mathrm{A}}(\\text{RNAP})}{\\mathbb{P}_{0}(\\text{RNAP})}\n=\\frac{\\dfrac{p(1+fa)}{1+p+a+fpa}}{\\dfrac{p}{1+p}}\n=\\frac{(1+p)(1+fa)}{1+p+a+fpa}.\n$$\n激活作用的饱和分析。在有限 $p$ 和固定 $f>1$ 的情况下，当 $a\\to\\infty$ 时，\n$$\n\\mathrm{fc}_{\\mathrm{A}}=\\frac{(1+p)(1+fa)}{1+p+a+fpa}\\xrightarrow[a\\to\\infty]{}\\frac{(1+p)fa}{a(1+fp)}=\\frac{f(1+p)}{1+fp}.\n$$\n这个极限值是通过饱和激活蛋白可达到的最大增强。它依赖于 $p$，并且界于 $1$ 和 $f$ 之间，从 $p\\ll 1$ 时的 $f$ 单调递减到 $p\\gg 1$ 时的 $1$：\n- 弱启动子，$p\\ll 1$: $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\approx f(1+0)/(1+0)=f$。\n- 强启动子，$p\\gg 1$: $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\approx f p/(f p)=1$。\n\n对抑制作用的弱启动子简化。对于 $p\\ll 1$ 和有限的 $r$，精确的抑制倍数变化简化为\n$$\n\\mathrm{fc}_{\\mathrm{R}}=\\frac{1+p}{1+p+r}\\approx \\frac{1}{1+r},\n$$\n这是在弱启动子极限下的常见形式。\n\n激活作用中的极端协同性极限。如果在固定的有限 $p>0$ 下，$f\\to\\infty$ 且 $a\\to\\infty$，饱和激活仍然是有限的：\n$$\n\\mathrm{fc}_{\\mathrm{A}}^{\\max}=\\frac{f(1+p)}{1+fp}\\xrightarrow[f\\to\\infty]{}\\frac{1+p}{p}=1+\\frac{1}{p},\n$$\n对于任何固定的有限 $p>0$，它都是有界的。\n\n逐项分析。\n\n选项A。该项陈述，对于有限 $p$ 的简单抑制，当 $r\\to\\infty$ 时，$\\mathrm{fc}_{\\mathrm{R}}\\sim (1+p)/r$，因此 $\\mathrm{fc}_{\\mathrm{R}}\\to 0$。从精确表达式 $\\mathrm{fc}_{\\mathrm{R}}=(1+p)/(1+p+r)$ 可知，大 $r$ 的渐近形式确实是 $(1+p)/r$，当 $r\\to\\infty$ 时，该值趋于零。结论：正确。\n\n选项B。该项陈述，对于有限 $p$ 和固定 $f>1$ 的简单激活，当 $a\\to\\infty$ 时，$\\mathrm{fc}_{\\mathrm{A}}\\to f(1+p)/(1+fp)$。这与上面推导出的饱和结果相符。结论：正确。\n\n选项C。该项陈述，对于弱启动子 $p\\ll 1$，当 $a\\to\\infty$ 时的饱和增强简化为 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\approx f$。从 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}=f(1+p)/(1+fp)$ 出发，取 $p\\ll 1$ 可得 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\approx f$。结论：正确。\n\n选项D。该项声称，对于非常强的启动子 $p\\gg 1$，在饱和极限下，抑制和激活都不能改变表达，其中当 $r\\to\\infty$ 时 $\\mathrm{fc}_{\\mathrm{R}}\\to 1$，当 $a\\to\\infty$ 时 $\\mathrm{fc}_{\\mathrm{A}}\\to 1$。虽然激活部分与 $p\\gg 1$ 极限下 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\approx 1$ 的结论一致，但抑制部分是错误的：对于任何 $p$（包括 $p\\gg 1$），当 $r\\to\\infty$ 时，$\\mathrm{fc}_{\\mathrm{R}}\\sim (1+p)/r\\to 0$，而不是 $1$。因此，这个组合陈述是不正确的。结论：不正确。\n\n选项E。该项陈述，在弱启动子 $p\\ll 1$ 的简单抑制中，对于所有 $r\\ge 0$，在有限 $r$ 下的倍数变化简化为 $\\mathrm{fc}_{\\mathrm{R}}\\approx 1/(1+r)$。从精确表达式 $\\mathrm{fc}_{\\mathrm{R}}=(1+p)/(1+p+r)$ 出发，取 $p\\ll 1$ 可以得出 $\\mathrm{fc}_{\\mathrm{R}}\\approx 1/(1+r)$，这对 $r$ 一致成立。结论：正确。\n\n选项F。该项声称，在固定的有限 $p>0$ 的简单激活中，如果 $f\\to\\infty$ 且 $a\\to\\infty$，则 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\to\\infty$。从在固定 $p>0$ 下当 $f\\to\\infty$ 时 $\\mathrm{fc}_{\\mathrm{A}}^{\\max}\\to (1+p)/p$ 的极限可知，最大增强保持有限。要使其发散，需要 $p\\to 0$ 同时发生。结论：不正确。",
            "answer": "$$\\boxed{ABCE}$$"
        },
        {
            "introduction": "这最后一个实践旨在弥合理论模型与实验现实之间的关键鸿沟，引导你完成将模型拟合到数据的全过程。你将从一个考虑了温度效应的简单抑制热力学模型出发，根据给定的实验测量噪声模型，构建一个似然函数。最终目标是推导出关键生物物理参数的最大似然估计量 (MLE)：即抑制蛋白的结合能 ($\\epsilon_R$) 及其细胞内的拷贝数 ($R$)。这项高级练习  展示了定量建模的真正威力——从可观测的宏观数据中推断出隐藏的微观属性，这是系统生物学中的一项核心任务。",
            "id": "3927125",
            "problem": "细菌中的一个转录单元由单一阻遏蛋白根据一个简单阻遏结构进行调控。该阻遏蛋白与脱氧核糖核酸（DNA）上的一个操纵子位点结合，其相对于非特异性DNA的序列特异性结合能记为 $\\epsilon_{R}$，细胞中有 $R$ 个相同的阻遏蛋白分子。令 $N_{\\mathrm{NS}}$ 为基因组中非特异性DNA结合位点的有效数量。假设系统处于热力学平衡状态，并使用标准的平衡统计力学描述，即使用玻尔兹曼权重进行结合描述，其中 $\\beta = 1/(k_{B}T)$，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n您在不同温度 $T_{j}$（对应 $\\beta_{j} = 1/(k_{B}T_{j})$）下进行了 $n$ 次独立实验，实验索引为 $j \\in \\{1,\\dots,n\\}$。在每次实验中，您测量了平均基因表达的倍数变化，其定义为存在阻遏蛋白时的平均表达与不存在阻遏蛋白时的平均表达之比。将测得的倍数变化记为 $x_{j}$，其值在 $(0,1)$ 之间。细胞内的阻遏蛋白丰度 $R$ 在所有实验中均相同且未知；结合能 $\\epsilon_{R}$ 也未知，但与温度 $T$ 无关。\n\n假设测量采用以下基于经验的噪声模型：以简单阻遏热力学占有模型预测的理论倍数变化 $f_{j}$ 为条件，随机变量 $\\frac{1 - x_{j}}{x_{j}}$ 服从对数正态分布，所有 $j$ 具有相同的已知对数方差 $s^{2}$，且各实验间相互独立。等价地，$y_{j} \\equiv \\ln\\!\\left(\\frac{1 - x_{j}}{x_{j}}\\right)$ 是独立的、具有相同已知方差 $s^{2}$ 的高斯随机变量。\n\n任务：\n- 从平衡结合和玻尔兹曼权重出发，并且不使用任何现成的基因调控公式，推导简单阻遏下的理论倍数变化 $f_{j}$，作为 $\\epsilon_{R}$、$R$、$N_{\\mathrm{NS}}$ 和 $\\beta_{j}$ 的函数。\n- 使用上述噪声模型，构建似然函数 $L(\\epsilon_{R}, R \\mid \\{x_{j}, \\beta_{j}\\}_{j=1}^{n})$。\n- 推导 $\\epsilon_{R}$ 和 $R$ 的闭式最大似然估计量，用观测值 $\\{x_{j}\\}_{j=1}^{n}$、已知值 $\\{\\beta_{j}\\}_{j=1}^{n}$ 和已知值 $N_{\\mathrm{NS}}$ 表示。您的最终表达式不应包含 $s^{2}$。将 $\\epsilon_{R}$ 以焦耳为单位表示，$R$ 表示为纯计数。\n\n仅提供解析表达式作为您的最终估计量。不要报告任何数值，也不要在最终表达式中包含单位。",
            "solution": "该问题要求对一个简单阻遏的基因调控模型进行三部分推导。首先，我们必须推导基因表达的理论倍数变化。其次，我们必须根据实验数据构建模型参数的似然函数。第三，我们必须为未知参数推导最大似然估计量（MLE）。\n\n### 第一部分：理论倍数变化的推导\n\n系统包含一个阻遏蛋白的特异性结合位点（操纵子）和DNA上的 $N_{\\mathrm{NS}}$ 个非特异性结合位点。细胞中有 $R$ 个阻遏蛋白分子。一个阻遏蛋白与特异性位点结合的能量相对于非特异性位点为 $\\epsilon_{R}$。系统在温度 $T_j$ 下处于热力学平衡，对应的逆温度参数为 $\\beta_j = 1/(k_B T_j)$。\n\n倍数变化 $f_j$ 是指存在阻遏蛋白时的平均基因表达与不存在阻遏蛋白时的平均基因表达之比。基因表达被假设为与启动子（及其相关的操纵子位点）未被阻遏蛋白占据的概率成正比，从而允许RNA聚合酶结合并启动转录。在没有阻遏蛋白的情况下，启动子总是自由的，因此表达量达到最大。因此，倍数变化等于操纵子位点未被占据的概率 $p_{\\text{free}}$。\n\n$$f_j = p_{\\text{free}}$$\n\n为了求出 $p_{\\text{free}}$，我们使用统计力学的原理。我们考虑操纵子两种可能状态的统计权重：被阻遏蛋白结合或自由。位点处于特定状态的概率与该状态的玻尔兹曼权重成正比。\n\n我们来确定操纵子被结合的概率 $p_{\\text{bound}}$ 与其自由的概率 $p_{\\text{free}}$ 之比。\n$$ \\frac{p_{\\text{bound}}}{p_{\\text{free}}} = \\frac{W_{\\text{bound}}}{W_{\\text{free}}} $$\n其中 $W_{\\text{bound}}$ 和 $W_{\\text{free}}$ 分别是操纵子处于结合态和自由态的统计权重。\n\n我们可以将自由态的权重设为参考值：$W_{\\text{free}} = 1$。\n\n结合态的权重 $W_{\\text{bound}}$ 是可用于结合的阻遏蛋白数量与结合能相关的玻尔兹曼因子的乘积。此模型中的一个标准简化是假设所有 $R$ 个阻遏蛋白都分布在DNA的某个位置，要么在单个特异性位点上，要么在 $N_{\\mathrm{NS}}$ 个非特异性位点中。可用于结合特异性位点的阻遏蛋白的有效浓度由每个非特异性位点上的阻遏蛋白数量决定，即 $\\frac{R}{N_{\\mathrm{NS}}}$。由于 $\\epsilon_{R}$ 是能量差，一个阻遏蛋白从非特异性位点移动到特异性位点的玻尔兹曼因子是 $\\exp(-\\beta_j \\epsilon_{R})$。\n\n因此，结合态的统计权重为：\n$$ W_{\\text{bound}} = \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R}) $$\n\n于是，概率之比为：\n$$ \\frac{p_{\\text{bound}}}{p_{\\text{free}}} = \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R}) $$\n\n由于 $p_{\\text{bound}} + p_{\\text{free}} = 1$，我们可以写成 $p_{\\text{bound}} = 1 - p_{\\text{free}}$。将此代入比例式中得到：\n$$ \\frac{1 - p_{\\text{free}}}{p_{\\text{free}}} = \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R}) $$\n\n求解 $p_{\\text{free}}$：\n$$ \\frac{1}{p_{\\text{free}}} - 1 = \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R}) $$\n$$ \\frac{1}{p_{\\text{free}}} = 1 + \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R}) $$\n$$ p_{\\text{free}} = \\frac{1}{1 + \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R})} $$\n\n因此，理论倍数变化 $f_j$ 为：\n$$ f_j = p_{\\text{free}} = \\frac{1}{1 + \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R})} $$\n\n### 第二部分：似然函数的构建\n\n问题为测量的倍数变化 $x_j$ 提供了一个噪声模型。变换后的变量 $y_j = \\ln\\left(\\frac{1 - x_j}{x_j}\\right)$ 是一个正态分布的随机变量，其方差 $s^2$ 已知，均值 $\\mu_j$ 依赖于理论倍数变化 $f_j$。\n\n均值 $\\mu_j$ 由理论上对应的量 $\\frac{1-f_j}{f_j}$ 的对数给出。我们来从已推导出的 $f_j$ 表达式计算这个理论量。\n$$ \\frac{1 - f_j}{f_j} = \\frac{1}{f_j} - 1 = \\left(1 + \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R})\\right) - 1 = \\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R}) $$\n\n$y_j$ 的均值因此为：\n$$ \\mu_j = E[y_j] = \\ln\\left(\\frac{1-f_j}{f_j}\\right) = \\ln\\left(\\frac{R}{N_{\\mathrm{NS}}} \\exp(-\\beta_j \\epsilon_{R})\\right) = \\ln\\left(\\frac{R}{N_{\\mathrm{NS}}}\\right) - \\beta_j \\epsilon_{R} $$\n\n观测数据点 $y_j$ 的模型为：\n$$ y_j \\sim \\mathcal{N}(\\mu_j, s^2) \\quad \\text{其中} \\quad \\mu_j = \\ln(R) - \\ln(N_{\\mathrm{NS}}) - \\epsilon_{R}\\beta_j $$\n每个 $y_j$ 是独立抽样的。单个观测值 $y_j$ 的概率密度函数为：\n$$ p(y_j \\mid \\epsilon_R, R) = \\frac{1}{\\sqrt{2\\pi s^2}} \\exp\\left( -\\frac{(y_j - \\mu_j)^2}{2s^2} \\right) = \\frac{1}{\\sqrt{2\\pi s^2}} \\exp\\left( -\\frac{(y_j - (\\ln(R/N_{\\mathrm{NS}}) - \\beta_j \\epsilon_R))^2}{2s^2} \\right) $$\n\n似然函数 $L(\\epsilon_R, R \\mid \\{x_j, \\beta_j\\})$ 是所有 $n$ 个独立观测的概率乘积。代入 $y_j = \\ln\\left(\\frac{1 - x_j}{x_j}\\right)$：\n$$ L(\\epsilon_R, R \\mid \\{x_j, \\beta_j\\}_{j=1}^{n}) = \\prod_{j=1}^{n} \\frac{1}{\\sqrt{2\\pi s^2}} \\exp\\left( -\\frac{\\left( \\ln\\left(\\frac{1 - x_j}{x_j}\\right) - \\ln\\left(\\frac{R}{N_{\\mathrm{NS}}}\\right) + \\beta_j \\epsilon_R \\right)^2}{2s^2} \\right) $$\n$$ L(\\epsilon_R, R \\mid \\{x_j, \\beta_j\\}_{j=1}^{n}) = (2\\pi s^2)^{-n/2} \\exp\\left( -\\frac{1}{2s^2} \\sum_{j=1}^{n} \\left( \\ln\\left(\\frac{1 - x_j}{x_j}\\right) - \\ln\\left(\\frac{R}{N_{\\mathrm{NS}}}\\right) + \\beta_j \\epsilon_R \\right)^2 \\right) $$\n\n### 第三部分：最大似然估计量的推导\n\n为了求出 $\\epsilon_R$ 和 $R$ 的最大似然估计量（MLEs），我们最大化似然函数 $L$。这等价于最大化对数似然函数 $\\ell = \\ln L$：\n$$ \\ell(\\epsilon_R, R) = -\\frac{n}{2}\\ln(2\\pi s^2) - \\frac{1}{2s^2} \\sum_{j=1}^{n} \\left( \\ln\\left(\\frac{1 - x_j}{x_j}\\right) - \\ln\\left(\\frac{R}{N_{\\mathrm{NS}}}\\right) + \\beta_j \\epsilon_R \\right)^2 $$\n\n最大化 $\\ell$ 等价于最小化残差平方和 $S(\\epsilon_R, R)$：\n$$ S(\\epsilon_R, R) = \\sum_{j=1}^{n} \\left( \\ln\\left(\\frac{1 - x_j}{x_j}\\right) - \\ln\\left(\\frac{R}{N_{\\mathrm{NS}}}\\right) + \\beta_j \\epsilon_R \\right)^2 $$\n\n我们定义 $y_j = \\ln\\left(\\frac{1-x_j}{x_j}\\right)$。$y_j$ 均值的模型是关于 $\\beta_j$ 的线性模型：\n$$ y_j = (\\ln(R) - \\ln(N_{\\mathrm{NS}})) - \\epsilon_R \\beta_j + \\text{误差}_j $$\n这是一个标准线性回归问题，形式为 $y_j = \\theta_0 + \\theta_1 \\beta_j$，参数为：\n$$ \\theta_0 = \\ln(R) - \\ln(N_{\\mathrm{NS}}) $$\n$$ \\theta_1 = -\\epsilon_R $$\n\n$\\theta_0$ 和 $\\theta_1$ 的最小二乘估计使 $S = \\sum_{j=1}^n (y_j - \\theta_0 - \\theta_1 \\beta_j)^2$ 最小化。解由线性回归的正规方程给出。令 $\\hat{\\theta}_0$ 和 $\\hat{\\theta}_1$ 为估计量。\n$$ \\hat{\\theta}_1 = \\frac{n \\sum_{j=1}^n y_j \\beta_j - (\\sum_{j=1}^n y_j)(\\sum_{j=1}^n \\beta_j)}{n \\sum_{j=1}^n \\beta_j^2 - (\\sum_{j=1}^n \\beta_j)^2} $$\n$$ \\hat{\\theta}_0 = \\bar{y} - \\hat{\\theta}_1 \\bar{\\beta} = \\frac{1}{n}\\sum_{j=1}^n y_j - \\hat{\\theta}_1 \\left(\\frac{1}{n}\\sum_{j=1}^n \\beta_j\\right) $$\n从正规方程的矩阵解中得到的 $\\hat{\\theta}_0$ 的更直接表达式是：\n$$ \\hat{\\theta}_0 = \\frac{(\\sum_{j=1}^n y_j)(\\sum_{j=1}^n \\beta_j^2) - (\\sum_{j=1}^n \\beta_j)(\\sum_{j=1}^n y_j \\beta_j)}{n \\sum_{j=1}^n \\beta_j^2 - (\\sum_{j=1}^n \\beta_j)^2} $$\n\n现在，我们求解估计量 $\\hat{\\epsilon}_R$ 和 $\\hat{R}$。\n从 $\\hat{\\theta}_1 = -\\hat{\\epsilon}_R$，我们得到 $\\epsilon_R$ 的估计量：\n$$ \\hat{\\epsilon}_R = -\\hat{\\theta}_1 = -\\frac{n \\sum_{j=1}^n y_j \\beta_j - (\\sum_{j=1}^n y_j)(\\sum_{j=1}^n \\beta_j)}{n \\sum_{j=1}^n \\beta_j^2 - (\\sum_{j=1}^n \\beta_j)^2} = \\frac{(\\sum_{j=1}^n y_j)(\\sum_{j=1}^n \\beta_j) - n \\sum_{j=1}^n y_j \\beta_j}{n \\sum_{j=1}^n \\beta_j^2 - (\\sum_{j=1}^n \\beta_j)^2} $$\n代回 $y_j = \\ln(\\frac{1-x_j}{x_j})$：\n$$ \\hat{\\epsilon}_R = \\frac{\\left(\\sum_{j=1}^n \\ln\\left(\\frac{1-x_j}{x_j}\\right)\\right)\\left(\\sum_{k=1}^n \\beta_k\\right) - n \\sum_{j=1}^n \\beta_j \\ln\\left(\\frac{1-x_j}{x_j}\\right)}{n \\sum_{j=1}^n \\beta_j^2 - \\left(\\sum_{j=1}^n \\beta_j\\right)^2} $$\n\n从 $\\hat{\\theta}_0 = \\ln(\\hat{R}) - \\ln(N_{\\mathrm{NS}})$，我们得到 $R$ 的估计量：\n$$ \\ln(\\hat{R}) = \\hat{\\theta}_0 + \\ln(N_{\\mathrm{NS}}) $$\n$$ \\hat{R} = \\exp(\\hat{\\theta}_0 + \\ln(N_{\\mathrm{NS}})) = N_{\\mathrm{NS}} \\exp(\\hat{\\theta}_0) $$\n代入 $\\hat{\\theta}_0$ 的表达式：\n$$ \\hat{R} = N_{\\mathrm{NS}} \\exp\\left( \\frac{(\\sum_{j=1}^n y_j)(\\sum_{j=1}^n \\beta_j^2) - (\\sum_{j=1}^n \\beta_j)(\\sum_{j=1}^n y_j \\beta_j)}{n \\sum_{j=1}^n \\beta_j^2 - (\\sum_{j=1}^n \\beta_j)^2} \\right) $$\n代回 $y_j = \\ln(\\frac{1-x_j}{x_j})$：\n$$ \\hat{R} = N_{\\mathrm{NS}} \\exp\\left( \\frac{\\left(\\sum_{j=1}^n \\ln\\left(\\frac{1-x_j}{x_j}\\right)\\right)\\left(\\sum_{k=1}^n \\beta_k^2\\right) - \\left(\\sum_{j=1}^n \\beta_j\\right)\\left(\\sum_{k=1}^n \\beta_k \\ln\\left(\\frac{1-x_k}{x_k}\\right)\\right)}{n \\sum_{j=1}^n \\beta_j^2 - \\left(\\sum_{j=1}^n \\beta_j\\right)^2} \\right) $$\n这些就是最大似然估计量的最终闭式表达式。根据要求，它们不依赖于噪声方差 $s^2$。$\\epsilon_R$ 的表达式带有能量单位（如果 $\\beta_j$ 的单位是 $J^{-1}$，则为焦耳），而 $R$ 是一个无量纲的计数。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\left(\\sum_{j=1}^n \\ln\\left(\\frac{1-x_j}{x_j}\\right)\\right)\\left(\\sum_{k=1}^n \\beta_k\\right) - n \\sum_{j=1}^n \\beta_j \\ln\\left(\\frac{1-x_j}{x_j}\\right)}{n \\sum_{j=1}^n \\beta_j^2 - \\left(\\sum_{j=1}^n \\beta_j\\right)^2} \\\\ N_{\\mathrm{NS}} \\exp\\left( \\frac{\\left(\\sum_{j=1}^n \\ln\\left(\\frac{1-x_j}{x_j}\\right)\\right)\\left(\\sum_{k=1}^n \\beta_k^2\\right) - \\left(\\sum_{j=1}^n \\beta_j\\right)\\left(\\sum_{k=1}^n \\beta_k \\ln\\left(\\frac{1-x_k}{x_k}\\right)\\right)}{n \\sum_{j=1}^n \\beta_j^2 - \\left(\\sum_{j=1}^n \\beta_j\\right)^2} \\right) \\end{pmatrix} } $$"
        }
    ]
}