{
    "hands_on_practices": [
        {
            "introduction": "细胞对外界信号的响应灵敏度通常源于受体层面。协同性(cooperativity)是理解信号响应如何呈现“开关”特性的关键概念，它描述了多位点蛋白上一个配体的结合如何影响其他位点的结合亲和力。这项练习旨在通过希尔系数($n_H$)这一核心指标来量化协同性，将配体结合的统计力学模型与这一广泛应用的经验测量联系起来。通过从微观模型中推导出希尔系数，您将深刻理解该参数的物理意义，以及它如何反映潜在的分子间相互作用。",
            "id": "3875044",
            "problem": "考虑一个细胞表面受体 $R$，它会二聚化并为信号配体 $L$ 提供两个相同的配体结合位点。该受体通过依赖于占据率的构象变化来调节下游激酶，使得受体处于活性信号状态的概率随其配体分数占据率 $\\theta(L)$（被占据位点的分数）的增加而增加。假设环境是充分混合的等温环境，且平衡结合遵循质量作用定律。设配体与未占据位点结合的微观解离常数为 $K_{d}$，并设有一个协同因子 $c>0$，它相对于独立结合情况调节双重占据状态的稳定性。具体来说，与单位点权重的乘积相比，两个配体结合的微观状态的统计权重被缩放了因子 $c$，这反映了第二次结合事件的构象稳定化（$c > 1$）或去稳定化（$c  1$）。\n\n在这些假设下，根据平衡统计力学为受体结合微观状态推导出的结合多项式为\n$$\nQ(L) \\;=\\; 1 \\;+\\; 2\\,\\frac{L}{K_{d}} \\;+\\; c\\,\\left(\\frac{L}{K_{d}}\\right)^{2},\n$$\n分数占据率 $\\theta(L)$ 定义为平衡时被占据位点的期望分数。\n\n仅使用上述物理设定和基本定义，完成以下任务：\n- 从第一性原理推导分数占据率 $\\theta(L)$。\n- 使用希尔系数的定义，即希尔图在半饱和点处的斜率，计算\n$$\nn_{H} \\;=\\; \\left.\\frac{d\\,\\ln\\!\\left(\\frac{\\theta}{1-\\theta}\\right)}{d\\,\\ln L}\\right|_{\\theta\\,=\\,0.5}.\n$$\n将你的最终答案表示为仅含协同因子 $c$ 的单个闭式解析表达式。无需四舍五入。希尔系数是无量纲的。此外，用文字解释你的结果的大小如何反映这个双位点受体系统中协同作用的强度和符号。",
            "solution": "该问题陈述经评估为**有效**。它在科学上基于平衡统计力学和生物物理化学的原理，特别是 Adair-Klotz 协同配体结合模型。该问题提法严谨，提供了所有必要的定义和一个一致的数学框架（$Q(L)$）来推导唯一的解。语言客观而精确。\n\n第一个任务是从第一性原理推导分数占据率 $\\theta(L)$。结合多项式，或称配分函数，$Q(L)$，是对所有可能的结合微观状态的统计权重求和。提供的多项式为：\n$$Q(L) = 1 + 2\\frac{L}{K_{d}} + c\\left(\\frac{L}{K_{d}}\\right)^{2}$$\n这里，项 $1$ 是未占据受体（$R$）的权重，项 $2\\frac{L}{K_{d}}$ 是两种可能的单占据状态（$RL$）的权重，项 $c\\left(\\frac{L}{K_{d}}\\right)^{2}$ 是双占据状态（$RL_2$）的权重。\n\n每个受体结合的平均配体数 $\\langle\\nu\\rangle$ 可以从结合多项式中通过统计力学的基本关系推导得出：\n$$\\langle\\nu\\rangle = L \\frac{d}{dL} \\ln(Q(L)) = \\frac{L}{Q(L)} \\frac{dQ(L)}{dL}$$\n首先，我们计算 $Q(L)$ 对配体浓度 $L$ 的导数：\n$$\\frac{dQ(L)}{dL} = \\frac{d}{dL} \\left( 1 + \\frac{2L}{K_d} + \\frac{cL^2}{K_d^2} \\right) = \\frac{2}{K_d} + \\frac{2cL}{K_d^2}$$\n将此代入 $\\langle\\nu\\rangle$ 的表达式中：\n$$\\langle\\nu\\rangle = \\frac{L}{1 + 2\\frac{L}{K_d} + c\\frac{L^2}{K_d^2}} \\left( \\frac{2}{K_d} + \\frac{2cL}{K_d^2} \\right) = \\frac{2\\frac{L}{K_d} + 2c\\frac{L^2}{K_d^2}}{1 + 2\\frac{L}{K_d} + c\\frac{L^2}{K_d^2}}$$\n分数占据率 $\\theta(L)$ 是平均结合配体数 $\\langle\\nu\\rangle$ 除以总结合位点数，对于这个二聚体受体，该值为 $N=2$。\n$$\\theta(L) = \\frac{\\langle\\nu\\rangle}{N} = \\frac{1}{2} \\left( \\frac{2\\frac{L}{K_d} + 2c\\frac{L^2}{K_d^2}}{1 + 2\\frac{L}{K_d} + c\\frac{L^2}{K_d^2}} \\right) = \\frac{\\frac{L}{K_d} + c\\left(\\frac{L}{K_d}\\right)^2}{1 + 2\\frac{L}{K_d} + c\\left(\\frac{L}{K_d}\\right)^2}$$\n这完成了任务的第一部分。\n\n第二个任务是计算在半饱和（$\\theta=0.5$）时的希尔系数 $n_H$。希尔系数定义为：\n$$n_H = \\frac{d \\ln(\\frac{\\theta}{1-\\theta})}{d \\ln L}$$\n我们定义一个归一化配体浓度 $x = L/K_d$。那么 $d \\ln L = d \\ln(xK_d) = d \\ln x$。$n_H$ 的表达式变为：\n$$n_H = \\frac{d \\ln(\\frac{\\theta}{1-\\theta})}{d \\ln x}$$\n首先，我们用 $x$ 来表示比率 $\\frac{\\theta}{1-\\theta}$。\n$$\\theta(x) = \\frac{x + cx^2}{1 + 2x + cx^2}$$\n$$1 - \\theta(x) = 1 - \\frac{x + cx^2}{1 + 2x + cx^2} = \\frac{(1 + 2x + cx^2) - (x + cx^2)}{1 + 2x + cx^2} = \\frac{1+x}{1 + 2x + cx^2}$$\n该比率为：\n$$\\frac{\\theta}{1-\\theta} = \\frac{x+cx^2}{1+x} = \\frac{x(1+cx)}{1+x}$$\n现在，我们取自然对数：\n$$\\ln\\left(\\frac{\\theta}{1-\\theta}\\right) = \\ln(x) + \\ln(1+cx) - \\ln(1+x)$$\n我们现在可以对 $\\ln x$ 进行微分：\n$$n_H(x) = \\frac{d}{d \\ln x} \\left[ \\ln(x) + \\ln(1+cx) - \\ln(1+x) \\right]$$\n使用链式法则 $\\frac{d f(x)}{d \\ln x} = x \\frac{d f(x)}{dx}$，我们计算每一项：\n$$n_H(x) = \\frac{d \\ln x}{d \\ln x} + \\frac{d \\ln(1+cx)}{d \\ln x} - \\frac{d \\ln(1+x)}{d \\ln x}$$\n$$n_H(x) = 1 + x \\frac{d}{dx}\\ln(1+cx) - x \\frac{d}{dx}\\ln(1+x)$$\n$$n_H(x) = 1 + x \\left(\\frac{c}{1+cx}\\right) - x \\left(\\frac{1}{1+x}\\right) = 1 + \\frac{cx}{1+cx} - \\frac{x}{1+x}$$\n这是希尔系数作为配体浓度函数的通用表达式。\n\n我们必须在半饱和点，即 $\\theta=0.5$ 处，计算这个表达式的值。我们找到满足这个条件的 $x$ 的值。\n$$\\theta(x) = 0.5 \\implies \\frac{x + cx^2}{1 + 2x + cx^2} = \\frac{1}{2}$$\n$$2(x + cx^2) = 1 + 2x + cx^2$$\n$$2x + 2cx^2 = 1 + 2x + cx^2$$\n$$2cx^2 - cx^2 = 1$$\n$$cx^2 = 1$$\n由于 $x = L/K_d > 0$ 且 $c > 0$，我们得到 $x = \\frac{1}{\\sqrt{c}}$。\n\n最后，我们将这个特定的 $x$ 值代入 $n_H(x)$ 的表达式中：\n$$n_H \\bigg|_{\\theta=0.5} = 1 + \\frac{c(\\frac{1}{\\sqrt{c}})}{1+c(\\frac{1}{\\sqrt{c}})} - \\frac{\\frac{1}{\\sqrt{c}}}{1+\\frac{1}{\\sqrt{c}}}$$\n$$n_H = 1 + \\frac{\\sqrt{c}}{1+\\sqrt{c}} - \\frac{\\frac{1}{\\sqrt{c}}}{\\frac{\\sqrt{c}+1}{\\sqrt{c}}}$$\n$$n_H = 1 + \\frac{\\sqrt{c}}{1+\\sqrt{c}} - \\frac{1}{1+\\sqrt{c}}$$\n将各项通分合并：\n$$n_H = \\frac{1+\\sqrt{c}}{1+\\sqrt{c}} + \\frac{\\sqrt{c}-1}{1+\\sqrt{c}} = \\frac{1+\\sqrt{c}+\\sqrt{c}-1}{1+\\sqrt{c}}$$\n$$n_H = \\frac{2\\sqrt{c}}{1+\\sqrt{c}}$$\n这是在半饱和点，以协同因子 $c$ 表示的希尔系数的最终闭式表达式。\n\n协同作用的大小和符号在此结果中得到了反映。希尔系数 $n_H$ 衡量剂量-反应曲线在其拐点处的陡峭程度，这是协同作用的一个关键指标。\n1.  对于**非协同结合**，结合事件是独立的，对应于 $c=1$。在这种情况下，$n_H = \\frac{2\\sqrt{1}}{1+\\sqrt{1}} = \\frac{2}{2} = 1$，这是独立、相同位点的预期值。\n2.  对于**正协同作用**，第一个配体的结合增强了对第二个配体的亲和力，因此 $c > 1$。这导致 $n_H > 1$。当 $c \\to \\infty$（无限强的协同作用）时，$n_H \\to \\frac{2\\sqrt{c}}{\\sqrt{c}} = 2$。因此，$1  n_H  2$。较大的 $n_H$ 值表示更强的正协同作用和更具开关特性的系统响应。上限 $2$ 反映了相互作用位点的总数。\n3.  对于**负协同作用**，第一个配体的结合降低了对第二个配体的亲和力，因此 $0  c  1$。这导致 $n_H  1$。当 $c \\to 0$（无限强的负协同作用，即第一个位点被占据后，第二个位点基本上无法结合）时，$n_H \\to 0$。因此，$0  n_H  1$。较小的 $n_H$ 值表示更强的负协同作用和更平缓的结合曲线，分布在更宽的配体浓度范围内。\n总之，$n_H$ 相对于 $1$ 的值直接报告了这个双位点系统中协同作用的性质和强度。",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{c}}{1+\\sqrt{c}}}\n$$"
        },
        {
            "introduction": "在理解了静态的输入-输出关系后，我们转向信号系统的时间演化。钙信号($\\mathrm{Ca}^{2+}$)是一个典型的动态过程，涉及多个细胞区室和复杂的离子流。这项练习将动态系统理论应用于一个简化的钙信号模型，要求您首先确定系统的稳态，然后通过线性化方法评估其稳定性。完成此练习将使您掌握判断信号通路是会稳定在静息水平还是会表现出更复杂行为（如振荡）的核心分析技能，这是系统生物学研究的基石。",
            "id": "3875085",
            "problem": "考虑一个简化的双室模型，用于描述细胞内钙离子（$\\mathrm{Ca}^{2+}$）的动力学，其中胞浆浓度为 $c(t)$，内质网（ER）腔内浓度为 $e(t)$。假设肌醇1,4,5-三磷酸（$\\text{IP}_3$）浓度恒定，使得有效的内质网到胞浆的释放与浓度差成线性关系。该模型包括具有希尔动力学（希尔系数 $n=2$）的肌浆/内质网 $\\mathrm{Ca}^{2+}$-ATP酶（SERCA）摄取、线性质膜挤出和恒定的基础内流。其控制常微分方程（ODEs）为：\n$$\n\\frac{dc}{dt} \\;=\\; k_{r}\\,(e - c)\\;-\\;J_{\\mathrm{SERCA}}(c)\\;-\\;k_{e}\\,c\\;+\\;s,\n$$\n$$\n\\frac{de}{dt} \\;=\\; \\gamma\\left[J_{\\mathrm{SERCA}}(c)\\;-\\;k_{r}\\,(e - c)\\right],\n$$\n其中 $J_{\\mathrm{SERCA}}(c)$ 是 SERCA 摄取通量，\n$$\nJ_{\\mathrm{SERCA}}(c) \\;=\\; V\\,\\frac{c^{2}}{K^{2} + c^{2}}.\n$$\n这里，$k_{r}$ 是有效的内质网释放速率（包含在恒定 $\\text{IP}_3$ 下的 IP$_3$ 受体开放概率和被动泄漏），$k_{e}$ 是质膜挤出速率，$s$ 是恒定的基础内流，$\\gamma$ 是内质网与胞浆的体积比。所有参数都不随时间变化。使用以下参数值（选择为生理上合理的）：\n$$\nk_{r} \\;=\\; 1\\ \\mathrm{s}^{-1},\\quad k_{e} \\;=\\; 0.5\\ \\mathrm{s}^{-1},\\quad V \\;=\\; 1\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1},\\quad K \\;=\\; 0.3\\ \\mu\\mathrm{M},\\quad s \\;=\\; 0.05\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1},\\quad \\gamma \\;=\\; 0.1.\n$$\n从区室间的质量守恒原理和上述通量的定义出发，完成以下任务：\n- 在恒定 $\\text{IP}_3$ 和给定动力学的条件下，推导稳态胞浆钙浓度 $c^{*}$。\n- 将系统在稳态点 $(c^{*}, e^{*})$ 附近进行线性化，并计算雅可比矩阵的特征值以评估局部稳定性。报告具有最大实部的特征值。\n将所有数值答案四舍五入到四位有效数字。$c^{*}$ 以微摩尔（$\\mu\\mathrm{M}$）表示，特征值以反秒（$\\mathrm{s}^{-1}$）表示。最终答案必须是一项计算，报告为一个包含两个数字的单一实体。",
            "solution": "该问题经评估有效。其科学基础是生化动力学和动力系统理论的既定原理，问题提法恰当，信息充分，可得到唯一解，并使用客观、正式的语言陈述。所有必需的参数和方程都已提供，所要求的任务（寻找稳态和进行线性稳定性分析）是数学生物学中的标准程序。\n\n分析分两部分进行：首先，计算稳態胞浆钙浓度 $c^{*}$；其次，将系统在该稳态点附近线性化，通过计算雅可比矩阵的特征值来确定其局部稳定性。\n\n### 第1部分：稳态分析\n\n该系统由以下常微分方程（ODEs）描述：\n$$\n\\frac{dc}{dt} = k_{r}(e - c) - V\\frac{c^{2}}{K^{2} + c^{2}} - k_{e}c + s\n$$\n$$\n\\frac{de}{dt} = \\gamma\\left[V\\frac{c^{2}}{K^{2} + c^{2}} - k_{r}(e - c)\\right]\n$$\n\n在稳态下，浓度是恒定的，所以时间导数为零。设稳态浓度为 $c^{*}$ 和 $e^{*}$。\n$$\n\\frac{dc}{dt} = 0 \\quad \\text{和} \\quad \\frac{de}{dt} = 0\n$$\n\n从第二个方程 $\\frac{de}{dt} = 0$ 可知：\n$$\n\\gamma\\left[V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} - k_{r}(e^{*} - c^{*})\\right] = 0\n$$\n由于体积比 $\\gamma$ 不为零（$\\gamma = 0.1$），括号中的项必须为零。这表示在稳态下，从胞浆到内质网（ER）的SERCA摄取通量等于从内质网到胞浆的释放通量。\n$$\nV\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} = k_{r}(e^{*} - c^{*})\n$$\n\n现在，我们将第一个方程 $\\frac{dc}{dt}$ 设为零：\n$$\nk_{r}(e^{*} - c^{*}) - V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} - k_{e}c^{*} + s = 0\n$$\n将第二个常微分方程的稳态条件的结果代入此方程，得到：\n$$\n\\left( V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} \\right) - \\left( V\\frac{(c^{*})^{2}}{K^{2} + (c^{*})^{2}} \\right) - k_{e}c^{*} + s = 0\n$$\n代表胞浆和内质网之间通量的项相互抵消，得到一个简单的关系式：\n$$\n-k_{e}c^{*} + s = 0\n$$\n这个结果表明，在稳态下，进入胞浆的$\\mathrm{Ca}^{2+}$基础内流（$s$）与跨质膜的$\\mathrm{Ca}^{2+}$挤出（$k_{e}c^{*}$）完全平衡。\n\n解出稳态胞浆浓度 $c^{*}$：\n$$\nc^{*} = \\frac{s}{k_{e}}\n$$\n使用所提供的参数值：\n$s = 0.05\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$k_{e} = 0.5\\ \\mathrm{s}^{-1}$\n$$\nc^{*} = \\frac{0.05\\ \\mu\\mathrm{M}\\,\\mathrm{s}^{-1}}{0.5\\ \\mathrm{s}^{-1}} = 0.1\\ \\mu\\mathrm{M}\n$$\n按要求四舍五入到四位有效数字，$c^{*} = 0.1000\\ \\mu\\mathrm{M}$。\n\n### 第2部分：线性稳定性分析\n\n为了评估稳态 $(c^{*}, e^{*})$ 的局部稳定性，我们通过计算在此不动点处求值的雅可比矩阵 $J$ 来将系统线性化。系统具有 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x})$ 的形式，其中 $\\mathbf{x} = \\begin{pmatrix} c \\\\ e \\end{pmatrix}$。雅可比矩阵是：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial F_c}{\\partial c}  \\frac{\\partial F_c}{\\partial e} \\\\ \\frac{\\partial F_e}{\\partial c}  \\frac{\\partial F_e}{\\partial e} \\end{pmatrix}\n$$\n其中 $F_c(c, e) = k_{r}(e - c) - V\\frac{c^{2}}{K^{2} + c^{2}} - k_{e}c + s$ 且 $F_e(c, e) = \\gamma(V\\frac{c^{2}}{K^{2} + c^{2}} - k_{r}(e - c))$。\n\n首先，我们计算偏导数：\n$\\frac{\\partial F_c}{\\partial c} = -k_{r} - \\frac{d}{dc}\\left(V\\frac{c^{2}}{K^{2} + c^{2}}\\right) - k_{e} = -k_{r} - V\\frac{2cK^{2}}{(K^{2} + c^{2})^{2}} - k_{e}$\n$\\frac{\\partial F_c}{\\partial e} = k_{r}$\n$\\frac{\\partial F_e}{\\partial c} = \\gamma\\left[\\frac{d}{dc}\\left(V\\frac{c^{2}}{K^{2} + c^{2}}\\right) - k_{r}(-1)\\right] = \\gamma\\left[V\\frac{2cK^{2}}{(K^{2} + c^{2})^{2}} + k_{r}\\right]$\n$\\frac{\\partial F_e}{\\partial e} = \\gamma(-k_{r}) = -\\gamma k_{r}$\n\n接下来，我们在稳态 $c^{*} = 0.1\\ \\mu\\mathrm{M}$ 处计算这些导数的值。计算导数本身不需要 $e^{*}$ 的值。\n让我们首先计算 SERCA 通量项在 $c^{*}$ 处的导数值：\n$$\nV\\frac{2c^{*}K^{2}}{(K^{2} + (c^{*})^{2})^{2}} = (1)\\frac{2(0.1)(0.3)^{2}}{((0.3)^{2} + (0.1)^{2})^{2}} = \\frac{2(0.1)(0.09)}{(0.09 + 0.01)^{2}} = \\frac{0.018}{(0.1)^{2}} = \\frac{0.018}{0.01} = 1.8\\ \\mathrm{s}^{-1}\n$$\n\n现在我们可以计算雅可比矩阵 $J$ 的元素：\n$J_{11} = \\frac{\\partial F_c}{\\partial c}\\Big|_{c^{*}} = -k_{r} - 1.8 - k_{e} = -1 - 1.8 - 0.5 = -3.3\\ \\mathrm{s}^{-1}$\n$J_{12} = \\frac{\\partial F_c}{\\partial e}\\Big|_{e^{*}} = k_{r} = 1\\ \\mathrm{s}^{-1}$\n$J_{21} = \\frac{\\partial F_e}{\\partial c}\\Big|_{c^{*}} = \\gamma(1.8 + k_{r}) = 0.1(1.8 + 1) = 0.28\\ \\mathrm{s}^{-1}$\n$J_{22} = \\frac{\\partial F_e}{\\partial e}\\Big|_{e^{*}} = -\\gamma k_{r} = -0.1(1) = -0.1\\ \\mathrm{s}^{-1}$\n\n稳态下的雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} -3.3  1 \\\\ 0.28  -0.1 \\end{pmatrix}\n$$\n该矩阵的特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根：\n$$\n\\begin{vmatrix} -3.3 - \\lambda  1 \\\\ 0.28  -0.1 - \\lambda \\end{vmatrix} = 0\n$$\n$$\n(-3.3 - \\lambda)(-0.1 - \\lambda) - (1)(0.28) = 0\n$$\n$$\n(\\lambda + 3.3)(\\lambda + 0.1) - 0.28 = 0\n$$\n$$\n\\lambda^{2} + 3.4\\lambda + 0.33 - 0.28 = 0\n$$\n$$\n\\lambda^{2} + 3.4\\lambda + 0.05 = 0\n$$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-3.4 \\pm \\sqrt{(3.4)^{2} - 4(1)(0.05)}}{2(1)} = \\frac{-3.4 \\pm \\sqrt{11.56 - 0.2}}{2} = \\frac{-3.4 \\pm \\sqrt{11.36}}{2}\n$$\n两个特征值是：\n$$\n\\lambda_1 = \\frac{-3.4 + \\sqrt{11.36}}{2} \\approx \\frac{-3.4 + 3.370460}{2} = \\frac{-0.029540}{2} \\approx -0.014770\\ \\mathrm{s}^{-1}\n$$\n$$\n\\lambda_2 = \\frac{-3.4 - \\sqrt{11.36}}{2} \\approx \\frac{-3.4 - 3.370460}{2} = \\frac{-6.770460}{2} \\approx -3.38523\\ \\mathrm{s}^{-1}\n$$\n两个特征值都是负实数，表明该稳態是一个稳定节点。题目要求的是具有最大实部的特征值，即 $\\lambda_1$。\n四舍五入到四位有效数字，该特征值为 $-0.01477\\ \\mathrm{s}^{-1}$。\n\n最终所要求的值是 $c^{*} = 0.1000\\ \\mu\\mathrm{M}$ 和具有最大实部的特征值 $\\lambda = -0.01477\\ \\mathrm{s}^{-1}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1000  -0.01477 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "许多信号通路表现出非线性行为，其中最引人注目的是双稳态(bistability)，它赋予细胞做出“全或无”决策的能力。正反馈回路是产生这种开关行为的常见网络基序。这项练习将通过分叉分析(bifurcation analysis)这一强大的计算工具来探索双稳态现象，要求您通过编程找出系统定性行为发生突变的关键参数阈值。这项高级的编程实践将理论与计算相结合，通过寻找分叉点，您将学会如何描绘非线性系统的行为图谱，并识别调控细胞决策的关键阈值。",
            "id": "3875043",
            "problem": "考虑一个激酶激活模块，其模型为一个单变量常微分方程 (ODE)，描述了无量纲的活性组分 $x \\in [0,1]$ 受无量纲输入 $u \\geq 0$ 的影响。该模块包含一个具有正反馈的饱和激活途径和一个饱和失活途径。其动力学由 ODE $dx/dt = F(x,u)$ 给出，其中 $F(x,u)$ 定义为激活速率与失活速率之差。激活速率为 $v_{\\mathrm{act}}(x,u) = k_a A(u,x) (1 - x)$，其中 $A(u,x) = \\dfrac{u + \\alpha x^n}{K_a + u + \\alpha x^n}$；失活速率为 $v_{\\mathrm{deact}}(x) = k_d \\dfrac{x}{K_d + x}$。所有变量和参数均为无量纲。因此，函数 $F(x,u)$ 为 $F(x,u) = k_a A(u,x) (1 - x) - k_d \\dfrac{x}{K_d + x}$。\n\n您的任务是通过数值延拓计算活性激酶组分 $x$ 相对于输入 $u$ 的稳态分岔图，并找出稳定性发生变化的临界输入值。在这个一维系统中，稳定性变化发生在鞍节点分岔处，可通过联立条件 $F(x,u) = 0$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u) = 0$ 来检测。您必须：\n- 从第一性原理出发，推导 $F(x,u)$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u)$ 的表达式，确保科学真实性和内部一致性。\n- 通过在指定范围内扫描 $u$，计算每个 $u$ 对应的稳态 $x$，并通过稳态处 $\\dfrac{\\partial F}{\\partial x}(x,u)$ 的符号来划分其稳定性，从而实现数值延拓。稳定稳态满足 $\\dfrac{\\partial F}{\\partial x}(x,u)  0$，不稳定稳态满足 $\\dfrac{\\partial F}{\\partial x}(x,u)  0$。\n- 通过联立求解系统 $F(x,u) = 0$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u) = 0$，找出发生鞍节点分岔的临界输入值 $u$。\n- 汇总每个测试用例的临界输入值，并按升序排列。\n\n所有计算都是无量纲的，不需要物理单位。不涉及角度。不得使用百分比，任何比例都必须以小数形式表示。\n\n以下参数集构成了测试套件。每个参数集指定 $(k_a, K_a, k_d, K_d, \\alpha, n, u_{\\max})$，其中 $u$ 的扫描范围为从 $u = 0$ 到 $u = u_{\\max}$：\n\n- 测试用例 $1$ (强正反馈，预期为双稳态): $k_a = 2.0$, $K_a = 0.5$, $k_d = 1.0$, $K_d = 0.1$, $\\alpha = 6.0$, $n = 4$, $u_{\\max} = 5.0$。\n- 测试用例 $2$ (弱反馈，预期为单稳态): $k_a = 2.0$, $K_a = 0.5$, $k_d = 1.0$, $K_d = 0.1$, $\\alpha = 0.2$, $n = 2$, $u_{\\max} = 5.0$。\n- 测试用例 $3$ (接近阈值，临界反馈): $k_a = 2.0$, $K_a = 0.5$, $k_d = 1.0$, $K_d = 0.1$, $\\alpha = 2.0$, $n = 3$, $u_{\\max} = 5.0$。\n\n您的程序必须：\n- 对于每个测试用例，在 $u \\in [0, u_{\\max}]$ 上执行数值延拓，计算所有满足 $F(x,u) = 0$ 的稳态 $x \\in [0,1]$，通过 $\\dfrac{\\partial F}{\\partial x}(x,u)$ 的符号确定其稳定性，并独立地将鞍节点分岔点定位为 $F(x,u) = 0$ 和 $\\dfrac{\\partial F}{\\partial x}(x,u) = 0$ 的解。\n- 为每个测试用例返回发生鞍节点分岔的临界输入值 $u$ 的列表。如果未找到鞍节点分岔，则为该测试用例返回一个空列表。\n- 将报告的每个临界输入值 $u$ 四舍五入到 $6$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，其中每个元素对应一个测试用例，其本身是一个由四舍五入后的临界输入值组成的列表。例如，输出应具有 $[L_1,L_2,L_3]$ 的形式，其中 $L_i$ 是测试用例 $i$ 的浮点数列表。\n\n通过以下方式确保科学真实性：\n- 仅使用已定义的 ODE 结构和饱和动力学作为基本基础。\n- 除了推导出的 $F$ 和 $\\dfrac{\\partial F}{\\partial x}$ 表达式外，不引入任何额外的快捷公式。\n- 遵守定义域约束 $x \\in [0,1]$ 和 $u \\geq 0$。\n\n该算法必须可在任何现代编程语言中实现和运行；您必须在指定环境中提供一个完整、可运行的程序，该程序能够完全按照描述计算所要求的输出。",
            "solution": "用户提供了一个有效的问题陈述。\n\n### 第一步：提取已知条件\n- **控制方程**: 无量纲活性激酶组分 $x(t) \\in [0,1]$ 的动力学由常微分方程 (ODE) 描述：\n  $$ \\frac{dx}{dt} = F(x,u) $$\n- **速率函数定义**: 函数 $F(x,u)$ 是激活速率 $v_{\\mathrm{act}}(x,u)$ 和失活速率 $v_{\\mathrm{deact}}(x)$ 之间的差：\n  $$ F(x,u) = v_{\\mathrm{act}}(x,u) - v_{\\mathrm{deact}}(x) $$\n- **激活速率**: 激活速率包含一个正反馈项：\n  $$ v_{\\mathrm{act}}(x,u) = k_a A(u,x) (1 - x) $$\n  其中 $A(u,x)$ 是一个饱和函数：\n  $$ A(u,x) = \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} $$\n- **失活速率**: 失活速率遵循类 Michaelis-Menten 动力学：\n  $$ v_{\\mathrm{deact}}(x) = k_d \\frac{x}{K_d + x} $$\n- **鞍节点分岔条件**: 当以下两个条件同时满足时，发生稳定性变化（鞍节点分岔）：\n  1.  稳态：$F(x,u) = 0$\n  2.  临界稳定性：$\\dfrac{\\partial F}{\\partial x}(x,u) = 0$\n- **稳定性判据**: 如果 $\\dfrac{\\partial F}{\\partial x}  0$，稳态是稳定的；如果 $\\dfrac{\\partial F}{\\partial x} > 0$，稳态是不稳定的。\n- **测试用例（参数集）**: 每个测试用例以元组 $(k_a, K_a, k_d, K_d, \\alpha, n, u_{\\max})$ 的形式给出。\n  -   用例 1: $(2.0, 0.5, 1.0, 0.1, 6.0, 4, 5.0)$\n  -   用例 2: $(2.0, 0.5, 1.0, 0.1, 0.2, 2, 5.0)$\n  -   用例 3: $(2.0, 0.5, 1.0, 0.1, 2.0, 3, 5.0)$\n- **任务**: 对每个测试用例，找出与鞍节点分岔对应的临界输入值 $u$。这些值必须四舍五入到 $6$ 位小数并按升序排列。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据、适定且客观。\n-   **科学依据**: 该模型使用了标准的动力学形式（类 Hill 正反馈，类 Michaelis-Menten 酶促反应），这些是模拟生化信号网络的基础。整体结构是双稳态开关的常见模体。\n-   **适定性**: 问题定义了一个清晰的数学任务：求解一个特定非线性方程组的解 $(x, u)$。所有参数和约束都已提供，使得问题可解。\n-   **客观性**: 问题以精确的数学术语陈述，没有主观或模糊的语言。\n\n问题是有效的。\n\n### 基于原理的设计与求解\n\n问题要求找到发生鞍节点分岔的临界输入值 $u$。这些是参数空间 $(x, u)$ 中的点，在这些点上系统的定性行为发生变化，特别是成对的稳态（一个稳定，一个不稳定）产生或湮灭。\n\n**1. 系统公式化**\n系统变化率的完整表达式为：\n$$ F(x,u) = k_a \\left( \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} \\right) (1 - x) - k_d \\frac{x}{K_d + x} $$\n鞍节点分岔通过求解以下关于变量 $(x, u)$ 的两个非线性方程组来确定：\n$$\n\\begin{cases}\nF(x,u) = 0 \\\\\n\\dfrac{\\partial F}{\\partial x}(x,u) = 0\n\\end{cases}\n$$\n\n**2. 雅可比项 $\\dfrac{\\partial F}{\\partial x}$ 的推导**\n为了构建第二个方程，我们必须计算 $F(x,u)$ 对 $x$ 的偏导数。我们可以写出 $\\dfrac{\\partial F}{\\partial x} = \\dfrac{\\partial v_{\\mathrm{act}}}{\\partial x} - \\dfrac{\\partial v_{\\mathrm{deact}}}{\\partial x}$。\n\n首先，我们推导 $\\dfrac{\\partial v_{\\mathrm{act}}}{\\partial x}$：\n令 $A(u,x) = \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n}$。对 $v_{\\mathrm{act}} = k_a A(u,x) (1-x)$ 使用乘法法则：\n$$ \\frac{\\partial v_{\\mathrm{act}}}{\\partial x} = k_a \\left[ \\frac{\\partial A}{\\partial x}(1-x) - A(u,x) \\right] $$\n现在，我们使用除法法则求 $\\dfrac{\\partial A}{\\partial x}$。令 $N(x) = u + \\alpha x^n$ 和 $D(x) = K_a + u + \\alpha x^n$。\n$$ \\frac{\\partial A}{\\partial x} = \\frac{(\\frac{dN}{dx})D(x) - N(x)(\\frac{dD}{dx})}{D(x)^2} $$\n分子和分母的导数相同：$\\frac{dN}{dx} = \\frac{dD}{dx} = n \\alpha x^{n-1}$。\n$$ \\frac{\\partial A}{\\partial x} = \\frac{(n \\alpha x^{n-1})(K_a + u + \\alpha x^n) - (u + \\alpha x^n)(n \\alpha x^{n-1})}{(K_a + u + \\alpha x^n)^2} = \\frac{n \\alpha K_a x^{n-1}}{(K_a + u + \\alpha x^n)^2} $$\n将此代回得到：\n$$ \\frac{\\partial v_{\\mathrm{act}}}{\\partial x} = k_a \\left[ \\frac{n \\alpha K_a x^{n-1}(1-x)}{(K_a + u + \\alpha x^n)^2} - \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} \\right] $$\n接下来，我们对 $v_{\\mathrm{deact}}(x) = k_d \\frac{x}{K_d + x}$ 使用除法法则推导 $\\dfrac{\\partial v_{\\mathrm{deact}}}{\\partial x}$：\n$$ \\frac{\\partial v_{\\mathrm{deact}}}{\\partial x} = k_d \\frac{1(K_d+x) - x(1)}{(K_d+x)^2} = \\frac{k_d K_d}{(K_d+x)^2} $$\n最后，合并各项得到雅可比的完整表达式：\n$$ \\frac{\\partial F}{\\partial x}(x,u) = k_a \\left[ \\frac{n \\alpha K_a x^{n-1}(1-x)}{(K_a + u + \\alpha x^n)^2} - \\frac{u + \\alpha x^n}{K_a + u + \\alpha x^n} \\right] - \\frac{k_d K_d}{(K_d+x)^2} $$\n\n**3. 数值求解策略**\n方程组 $F(x,u)=0$ 和 $\\frac{\\partial F}{\\partial x}(x,u)=0$ 对于解析解来说过于复杂。我们必须采用数值求根算法。实现将对每个测试用例遵循以下步骤：\n- 根据推导的表达式定义计算 $F(x,u)$ 和 $\\frac{\\partial F}{\\partial x}(x,u)$ 的 Python 函数。\n- 为数值求解器创建一个目标函数，该函数接受一个向量 $[x, u]$ 并返回 $[F(x,u), \\frac{\\partial F}{\\partial x}(x,u)]$ 的值。\n- 为了在指定域（$x \\in [0,1], u \\in [0, u_{max}]$）内找到所有的分岔点，我们将使用 `scipy.optimize.root` 函数。此函数需要一个初始猜测值。为确保找到所有解，我们将系统地在相关域上生成一个初始猜测值的网格，并对每个猜测值运行求解器。\n- 对求解器返回的每个解，我们进行验证检查：\n    1.  确认求解器已成功收敛。\n    2.  验证解 $(x_{sol}, u_{sol})$ 位于物理现实域内，即 $0 \\le x_{sol} \\le 1$ 和 $0 \\le u_{sol} \\le u_{\\max}$。\n    3.  检查解处的函数值确实接近于零，确认它是一个真根。\n- 收集所有有效且唯一的临界输入值 $u_{sol}$。使用数值容差检查唯一性，以避免存储来自不同初始猜测值的多个几乎相同的结果。\n- 收集到的每个测试用例的临界值按升序排序并按要求四舍五入到 $6$ 位小数。\n- 如果没有找到分岔点（如单稳态系统所预期的），则该用例返回一个空列表。\n\n这种系统化的方法确保了对给定参数集的所有鞍节点分岔点进行稳健而准确的确定。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Computes the critical input values for saddle-node bifurcations\n    in a kinase activation model for given parameter sets.\n    \"\"\"\n    test_cases = [\n        # (ka, Ka, kd, Kd, alpha, n, u_max)\n        (2.0, 0.5, 1.0, 0.1, 6.0, 4, 5.0),  # Case 1: Strong feedback\n        (2.0, 0.5, 1.0, 0.1, 0.2, 2, 5.0),  # Case 2: Weak feedback\n        (2.0, 0.5, 1.0, 0.1, 2.0, 3, 5.0),  # Case 3: Borderline feedback\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        ka, Ka, kd, Kd, alpha, n, u_max = params\n\n        def F(x, u, ka, Ka, kd, Kd, alpha, n):\n            \"\"\"Computes the rate function F(x, u).\"\"\"\n            x_c = np.clip(x, 0, 1)\n            term_act_num = u + alpha * x_c**n\n            term_act_den = Ka + u + alpha * x_c**n\n            \n            # Avoid division by zero if denominator is zero, though unlikely with K_a > 0\n            if term_act_den == 0: return 1e6\n            \n            v_act = ka * (term_act_num / term_act_den) * (1 - x_c)\n            \n            # Avoid division by zero at x = -K_d\n            if Kd + x_c == 0: return 1e6\n            v_deact = kd * (x_c / (Kd + x_c))\n            \n            return v_act - v_deact\n\n        def dFdx(x, u, ka, Ka, kd, Kd, alpha, n):\n            \"\"\"Computes the partial derivative dF/dx.\"\"\"\n            x_c = np.clip(x, 0, 1)\n\n            # Denominator for the activation term derivative part\n            act_denom = Ka + u + alpha * x_c**n\n            if act_denom == 0: return 1e6\n\n            # Denominator for the deactivation term derivative part\n            deact_denom = Kd + x_c\n            if deact_denom == 0: return 1e6\n\n            # d(v_act)/dx\n            term_dAdx = (n * alpha * Ka * x_c**(n - 1) * (1 - x_c)) / (act_denom**2)\n            term_A = (u + alpha * x_c**n) / act_denom\n            d_v_act_dx = ka * (term_dAdx - term_A)\n\n            # d(v_deact)/dx\n            d_v_deact_dx = kd * Kd / (deact_denom**2)\n            \n            return d_v_act_dx - d_v_deact_dx\n\n        def bifurcation_system(vars, ka, Ka, kd, Kd, alpha, n):\n            \"\"\"System of equations [F=0, dF/dx=0] for root finding.\"\"\"\n            x, u = vars\n            # Penalize solutions outside the valid domain\n            if not (0 = x = 1 and u >= 0):\n                return [1e6, 1e6]\n            \n            f_val = F(x, u, ka, Ka, kd, Kd, alpha, n)\n            dfdx_val = dFdx(x, u, ka, Ka, kd, Kd, alpha, n)\n            return [f_val, dfdx_val]\n\n        found_bifurcations_u = []\n        \n        # Grid search for initial guesses to find all roots\n        x_guesses = np.linspace(0.01, 0.99, 20)\n        u_guesses = np.linspace(0, u_max, 25)\n\n        for x0 in x_guesses:\n            for u0 in u_guesses:\n                initial_guess = [x0, u0]\n                sol = root(bifurcation_system, initial_guess, args=(ka, Ka, kd, Kd, alpha, n), method='hybr', tol=1e-9)\n\n                if sol.success:\n                    x_sol, u_sol = sol.x\n                    \n                    # Validate the solution\n                    if 0 = x_sol = 1 and 0 = u_sol = u_max:\n                        # Check if it's a true root\n                        residuals = bifurcation_system([x_sol, u_sol], ka, Ka, kd, Kd, alpha, n)\n                        if np.all(np.isclose(residuals, 0, atol=1e-7)):\n                            # Check for uniqueness before adding\n                            is_new = all(not np.isclose(u_sol, bf_u, atol=1e-5) for bf_u in found_bifurcations_u)\n                            if is_new:\n                                found_bifurcations_u.append(u_sol)\n        \n        # Sort and round the results for the current test case\n        rounded_bifurcations = sorted([round(u, 6) for u in found_bifurcations_u])\n        all_results.append(rounded_bifurcations)\n\n    # Format the final output string to precisely match the required format:\n    # a list of lists of floats, represented as a string with no spaces.\n    # e.g., [[0.1,0.2],[],[0.3]]\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}