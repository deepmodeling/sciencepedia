{
    "hands_on_practices": [
        {
            "introduction": "To truly master the modeling of calcium oscillations, we must first understand their fundamental structure. Many biological oscillators arise from the interaction of processes occurring on vastly different timescales, giving rise to so-called relaxation oscillations. This practice demystifies this behavior by guiding you through the analysis of a classic slow-fast system . By dissecting the system into its fast and slow components, you will identify the geometric structures that govern the dynamics and use this insight to derive an analytical approximation for the oscillation period.",
            "id": "3904790",
            "problem": "Consider a minimal dimensionless slow–fast model of intracellular calcium oscillations that captures fast release and slow inactivation dynamics near a cusp-type bifurcation of the fast subsystem. Let $c(t)$ denote a scaled cytosolic calcium fluctuation about a basal level and let $h(t)$ denote a slow inactivation variable representing the fraction of available Inositol 1,4,5-trisphosphate receptor (IP3R) channels. The model is\n$$\n\\frac{d c}{d t} \\;=\\; h \\;-\\; \\big(c^{3} - a\\,c\\big), \\qquad \\frac{d h}{d t} \\;=\\; -\\,\\varepsilon\\,c,\n$$\nwith parameters $a > 0$ and $0  \\varepsilon \\ll 1$. Assume $c$ and $h$ are dimensionless and the system evolves as a relaxation oscillator: $c$ undergoes fast jumps between two stable branches of the cubic nullcline of the fast subsystem, while $h$ drifts slowly.\n\nTasks:\n- Starting from the fast–slow decomposition and quasi-steady-state assumptions for singularly perturbed systems, identify the attracting slow branches of the cubic nullcline of the fast subsystem, and the fold points at which fast jumps occur.\n- Construct a composite matched-asymptotic description over one full oscillation period: two slow drifts along the stable branches linked by two fast jumps at the folds, with the fast jumps treated as instantaneous changes in $c$ at fixed $h$ to leading order.\n- Using slow passage integrals along the stable branches, derive a closed-form leading-order approximation of the oscillation period $T$ in terms of $a$ and $\\varepsilon$, neglecting the $O(1)$ durations of fast jumps compared to the $O(\\varepsilon^{-1})$ slow drifts.\n\nProvide the final expression for $T$ as a single analytic formula in $a$ and $\\varepsilon$. No numerical approximation or rounding is required. The answer must be a single expression.",
            "solution": "The problem provides a system of two coupled ordinary differential equations representing a simplified model for intracellular calcium oscillations. The system is given by:\n$$\n\\frac{d c}{d t} \\;=\\; h \\;-\\; (c^{3} - a\\,c)\n$$\n$$\n\\frac{d h}{d t} \\;=\\; -\\,\\varepsilon\\,c\n$$\nwhere $c(t)$ is the fast-evolving calcium concentration fluctuation and $h(t)$ is the slow-evolving inactivation variable. The parameters are given as $a>0$ and $0  \\varepsilon \\ll 1$. The smallness of $\\varepsilon$ establishes a separation of time scales, making this a singularly perturbed system.\n\nFirst, we validate the problem statement.\n**Step 1: Extract Givens**\n-   Differential equations: $\\frac{d c}{d t} = h - (c^{3} - a\\,c)$ and $\\frac{d h}{d t} = -\\,\\varepsilon\\,c$.\n-   Variables: $c(t)$ (fast variable), $h(t)$ (slow variable).\n-   Parameters: $a$ (a positive constant, $a>0$), $\\varepsilon$ (a small positive constant, $0  \\varepsilon \\ll 1$).\n-   Context: The system is a dimensionless slow-fast model of a relaxation oscillator.\n-   Tasks:\n    1.  Identify the attracting slow branches and fold points of the fast subsystem's nullcline.\n    2.  Construct a leading-order asymptotic description of the oscillation cycle.\n    3.  Derive a leading-order approximation for the oscillation period $T$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The model is a form of the FitzHugh-Nagumo system, a classic and fundamental model for excitable systems and relaxation oscillations in various biological contexts, including neuroscience and calcium dynamics. The analysis requested uses standard, well-established techniques from singular perturbation theory. The problem is scientifically sound.\n-   **Well-Posed:** The problem is mathematically well-defined. The system of equations, parameter constraints, and the objective (deriving the period) are all clearly stated. A unique, meaningful solution in the form of a leading-order approximation exists.\n-   **Objective:** The problem is stated in precise mathematical language, free from subjectivity or ambiguity.\n-   **All other criteria are met:** The problem is complete, consistent, realistic (as a minimal model), and non-trivial.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with a full solution.\n\n**Solution Derivation**\n\n**1. Fast-Slow Decomposition and Slow Manifold**\nThe variable $c$ is the fast variable as its time derivative, $\\frac{dc}{dt}$, is not multiplied by the small parameter $\\varepsilon$. The variable $h$ is the slow variable, as $\\frac{dh}{dt}$ is of order $O(\\varepsilon)$.\n\nThe quasi-steady-state assumption implies that the fast variable $c$ rapidly equilibrates to a value determined by the current state of the slow variable $h$. This equilibrium is found by setting the fast dynamics to zero, $\\frac{dc}{dt} = 0$. This defines the critical manifold, or slow manifold, $S$:\n$$\nh - (c^3 - ac) = 0 \\quad \\implies \\quad h = c^3 - ac\n$$\nThis is the cubic nullcline of the fast subsystem. The system's trajectory slowly evolves along the stable parts of this manifold.\n\n**2. Stability and Fold Points**\nThe stability of the slow manifold with respect to fast dynamics is determined by the sign of the partial derivative of the fast equation's right-hand side with respect to $c$. Let $f(c,h) = h - (c^3 - ac)$.\n$$\n\\frac{\\partial f}{\\partial c} = -(3c^2 - a) = a - 3c^2\n$$\n-   The manifold is attracting (stable) where $\\frac{\\partial f}{\\partial c}  0$, which means $a - 3c^2  0$, or $c^2 > \\frac{a}{3}$. This corresponds to the two outer branches of the cubic: $c  -\\sqrt{\\frac{a}{3}}$ and $c > \\sqrt{\\frac{a}{3}}$.\n-   The manifold is repelling (unstable) where $\\frac{\\partial f}{\\partial c} > 0$, i.e., $c^2  \\frac{a}{3}$. This is the middle branch: $-\\sqrt{\\frac{a}{3}}  c  \\sqrt{\\frac{a}{3}}$.\n\nThe fold points are the points where the stability changes, i.e., where $\\frac{\\partial f}{\\partial c} = 0$. This is equivalent to finding the extrema of the function $h(c) = c^3 - ac$ by setting $\\frac{dh}{dc} = 3c^2 - a = 0$.\nThe fold points occur at $c_{folds} = \\pm\\sqrt{\\frac{a}{3}}$.\nThe corresponding $h$ values are:\n-   At the upper fold point (local maximum of $h(c)$):\n    $c_{up} = -\\sqrt{\\frac{a}{3}}$.\n    $h_{max} = \\left(-\\sqrt{\\frac{a}{3}}\\right)^3 - a\\left(-\\sqrt{\\frac{a}{3}}\\right) = -\\frac{a}{3}\\sqrt{\\frac{a}{3}} + a\\sqrt{\\frac{a}{3}} = \\frac{2a}{3}\\sqrt{\\frac{a}{3}}$.\n-   At the lower fold point (local minimum of $h(c)$):\n    $c_{low} = +\\sqrt{\\frac{a}{3}}$.\n    $h_{min} = \\left(\\sqrt{\\frac{a}{3}}\\right)^3 - a\\left(\\sqrt{\\frac{a}{3}}\\right) = \\frac{a}{3}\\sqrt{\\frac{a}{3}} - a\\sqrt{\\frac{a}{3}} = -\\frac{2a}{3}\\sqrt{\\frac{a}{3}}$.\n\n**3. The Relaxation Oscillation Cycle**\nThe cycle consists of four segments; two slow drifts along the stable branches of $S$ and two fast jumps between them.\n1.  **Slow drift (right branch):** The system is on the stable branch with $c > \\sqrt{a/3}$. Here, $\\frac{dh}{dt} = -\\varepsilon c  0$, so $h$ slowly decreases. The trajectory drifts down this branch until it reaches the lower fold point $(c_{low}, h_{min})$.\n2.  **Fast jump (down):** At $(c_{low}, h_{min})$, the system leaves the manifold and jumps horizontally (at constant $h \\approx h_{min}$) to the other stable branch. The destination $c_{dest}$ is the other stable root of $h_{min} = c^3 - ac$. The equation $c^3 - ac - h_{min} = 0$ has a double root at $c = \\sqrt{a/3}$. Since the sum of the roots of this cubic is $0$, the destination root is $c_{dest} = -2\\sqrt{a/3}$.\n3.  **Slow drift (left branch):** The system is now on the stable branch with $c  -\\sqrt{a/3}$. On this branch, $\\frac{dh}{dt} = -\\varepsilon c > 0$, so $h$ slowly increases. The trajectory drifts up this branch until it reaches the upper fold point $(c_{up}, h_{max})$.\n4.  **Fast jump (up):** At $(c_{up}, h_{max})$, the system jumps horizontally (at constant $h \\approx h_{max}$) back to the right stable branch. The destination $c_{dest}$ is the other stable root of $h_{max} = c^3 - ac$. This equation has a double root at $c = -\\sqrt{a/3}$, so the destination is $c_{dest} = 2\\sqrt{a/3}$. This completes the cycle.\n\n**4. Calculation of the Period**\nThe total period $T$ is the sum of the durations of the two slow drift segments, $T = T_{1} + T_{2}$. The time spent on the fast jumps is of order $O(1)$ and is negligible compared to the slow drift times which are of order $O(\\varepsilon^{-1})$.\n\nDuring the slow phases, the system is on the slow manifold, so $h \\approx c^3 - ac$. Differentiating with respect to time $t$ gives $\\frac{dh}{dt} \\approx (3c^2 - a)\\frac{dc}{dt}$.\nSubstituting the slow dynamics $\\frac{dh}{dt} = -\\varepsilon c$, we get:\n$$\n-\\varepsilon c \\approx (3c^2 - a)\\frac{dc}{dt} \\implies \\frac{dc}{dt} \\approx \\frac{-\\varepsilon c}{3c^2 - a}\n$$\nWe can find the duration of each segment by integrating $dt = \\frac{1}{dc/dt}dc$.\n\n**Duration $T_1$ (right branch):**\nThe trajectory moves from $c \\approx 2\\sqrt{\\frac{a}{3}}$ to $c = \\sqrt{\\frac{a}{3}}$.\n$$\nT_1 = \\int_{2\\sqrt{a/3}}^{\\sqrt{a/3}} \\frac{3c^2 - a}{-\\varepsilon c} dc = \\frac{1}{\\varepsilon} \\int_{\\sqrt{a/3}}^{2\\sqrt{a/3}} \\frac{3c^2 - a}{c} dc = \\frac{1}{\\varepsilon} \\int_{\\sqrt{a/3}}^{2\\sqrt{a/3}} \\left(3c - \\frac{a}{c}\\right) dc\n$$\n$$\nT_1 = \\frac{1}{\\varepsilon} \\left[ \\frac{3}{2}c^2 - a\\ln(c) \\right]_{\\sqrt{a/3}}^{2\\sqrt{a/3}}\n$$\n$$\nT_1 = \\frac{1}{\\varepsilon} \\left[ \\left(\\frac{3}{2}\\left(2\\sqrt{\\frac{a}{3}}\\right)^2 - a\\ln\\left(2\\sqrt{\\frac{a}{3}}\\right)\\right) - \\left(\\frac{3}{2}\\left(\\sqrt{\\frac{a}{3}}\\right)^2 - a\\ln\\left(\\sqrt{\\frac{a}{3}}\\right)\\right) \\right]\n$$\n$$\nT_1 = \\frac{1}{\\varepsilon} \\left[ \\left(\\frac{3}{2}\\frac{4a}{3} - a\\ln\\left(2\\sqrt{\\frac{a}{3}}\\right)\\right) - \\left(\\frac{3}{2}\\frac{a}{3} - a\\ln\\left(\\sqrt{\\frac{a}{3}}\\right)\\right) \\right]\n$$\n$$\nT_1 = \\frac{1}{\\varepsilon} \\left[ \\left(2a - a\\ln(2) - a\\ln\\left(\\sqrt{\\frac{a}{3}}\\right)\\right) - \\left(\\frac{a}{2} - a\\ln\\left(\\sqrt{\\frac{a}{3}}\\right)\\right) \\right]\n$$\n$$\nT_1 = \\frac{a}{\\varepsilon} \\left( 2 - \\frac{1}{2} - \\ln(2) \\right) = \\frac{a}{\\varepsilon} \\left( \\frac{3}{2} - \\ln(2) \\right)\n$$\n\n**Duration $T_2$ (left branch):**\nThe trajectory moves from $c \\approx -2\\sqrt{\\frac{a}{3}}$ to $c = -\\sqrt{\\frac{a}{3}}$.\n$$\nT_2 = \\int_{-2\\sqrt{a/3}}^{-\\sqrt{a/3}} \\frac{3c^2 - a}{-\\varepsilon c} dc = -\\frac{1}{\\varepsilon} \\int_{-2\\sqrt{a/3}}^{-\\sqrt{a/3}} \\left(3c - \\frac{a}{c}\\right) dc\n$$\nLet $u = -c$, so $du = -dc$. The limits of integration for $u$ are from $2\\sqrt{\\frac{a}{3}}$ to $\\sqrt{\\frac{a}{3}}$.\n$$\nT_2 = -\\frac{1}{\\varepsilon} \\int_{2\\sqrt{a/3}}^{\\sqrt{a/3}} \\left(-3u + \\frac{a}{u}\\right)(-du) = \\frac{1}{\\varepsilon} \\int_{\\sqrt{a/3}}^{2\\sqrt{a/3}} \\left(3u - \\frac{a}{u}\\right) du\n$$\nThis integral is identical to the one for $T_1$. Therefore, $T_2 = T_1 = \\frac{a}{\\varepsilon} \\left( \\frac{3}{2} - \\ln(2) \\right)$.\n\n**Total Period $T$:**\nThe total period is the sum of the durations of the two slow passages.\n$$\nT = T_1 + T_2 = 2 \\times \\frac{a}{\\varepsilon} \\left( \\frac{3}{2} - \\ln(2) \\right) = \\frac{a}{\\varepsilon} \\left( 3 - 2\\ln(2) \\right)\n$$\nThis can also be written as $T = \\frac{a}{\\varepsilon} (3-\\ln(4))$.",
            "answer": "$$\n\\boxed{\\frac{a}{\\varepsilon}\\left(3 - 2\\ln(2)\\right)}\n$$"
        },
        {
            "introduction": "While smooth oscillations describe many phenomena, cellular signaling is often governed by sharp, threshold-activated events. This exercise tackles the crucial practical challenge of numerically simulating these 'piecewise-smooth' systems, where dynamics change abruptly when a variable crosses a certain value . You will explore and compare different numerical event detection strategies, gaining an appreciation for how errors in capturing the precise timing of these events can impact simulation accuracy.",
            "id": "3904743",
            "problem": "You are asked to design and analyze event detection for threshold crossing in a piecewise-smooth model of cytosolic calcium concentration dynamics. Consider a single-compartment cytosolic calcium concentration $c(t)$ governed by conservation of mass and flux balance, where fluxes are assumed to be lumped and well-mixed. The cytosol receives a constant inflow and loses calcium through effective linear extrusion, while a threshold-triggered release term adds calcium from an internal store only when cytosolic calcium exceeds a threshold. The model is defined by\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c + H\\!\\left(c - c_{\\mathrm{th}}\\right)\\,v_{\\mathrm{rel}}\\left(c_s - c\\right),\n$$\nwhere $J_{\\mathrm{in}}$ is the constant inflow (units: micromolar per second), $k_{\\mathrm{eff}}$ is the effective first-order extrusion rate constant (units: per second), $H$ is the Heaviside step function, $c_{\\mathrm{th}}$ is the threshold concentration (units: micromolar), $v_{\\mathrm{rel}}$ is the proportional release rate when channels open (units: per second), and $c_s$ is the store calcium concentration (units: micromolar), treated as constant over the short time scales of interest. The threshold event of interest is the first time $t^\\star$ such that $c(t^\\star) = c_{\\mathrm{th}}$ with an upward crossing, that is, $c(t)  c_{\\mathrm{th}}$ for $t  t^\\star$ and $c(t) \\ge c_{\\mathrm{th}}$ at $t^\\star$.\n\nBefore the threshold is reached, the release term is inactive and the dynamics are governed by the linear time-invariant ordinary differential equation\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c,\n$$\nwith solution\n$$\nc(t) = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t},\\quad c_{\\infty} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}},\n$$\nwhere $c_0$ is the initial cytosolic concentration at $t=0$. If an upward crossing occurs from below, the exact threshold crossing time $t^\\star$ satisfies\n$$\nc_{\\mathrm{th}} = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t^\\star},\n$$\nand thus is determined by solving for $t^\\star$ given admissible parameters.\n\nYour tasks are:\n1. Implement a fixed-step explicit Euler integrator for the pre-event dynamics (that is, while $c(t)  c_{\\mathrm{th}}$) using step size $h$ and compute the first discrete sample time $t_{n+1}$ at which $c_{n+1} \\ge c_{\\mathrm{th}}$. This is the naive event detection without any refinement within a step.\n2. Implement an in-step event detection that refines the crossing time within the step by linear interpolation between the last sample below the threshold and the first sample at or above the threshold. Specifically, if $c_n  c_{\\mathrm{th}} \\le c_{n+1}$, approximate the crossing time $t_{\\mathrm{lin}} = t_n + \\alpha h$ with $\\alpha = \\dfrac{c_{\\mathrm{th}} - c_n}{c_{n+1} - c_n}$.\n3. Derive and implement the exact threshold crossing time $t^\\star$ using the pre-event analytical solution. If $c_0 \\ge c_{\\mathrm{th}}$, define $t^\\star = 0$. If $c_{\\infty} \\le c_{\\mathrm{th}}$ and $c_0  c_{\\mathrm{th}}$, define that no crossing occurs in finite time.\n4. For each test case, compute three metrics: the absolute naive time error $|t_{n+1} - t^\\star|$ in seconds (rounded to six decimal places), the absolute refined time error $|t_{\\mathrm{lin}} - t^\\star|$ in seconds (rounded to six decimal places), and the naive overshoot amplitude $c_{n+1} - c_{\\mathrm{th}}$ in micromolar (rounded to six decimal places). If no crossing occurs in the simulation horizon or if $t^\\star$ is undefined due to $c_{\\infty} \\le c_{\\mathrm{th}}$, output $0.0$ for all three metrics. If $c_0 \\ge c_{\\mathrm{th}}$, output $0.0$ for all three metrics.\n\nFundamental base and physical modeling assumptions:\n- Flux balance applies under a well-mixed cytosolic compartment, yielding $\\dfrac{dc}{dt}$ equal to the sum of inflow and outflow terms.\n- The pre-event dynamics are governed by a stable linear time-invariant system with exact solution as provided.\n- Threshold-triggered release activates only after crossing and does not affect the pre-event trajectory.\n\nTest suite:\nUse the following five parameter sets, each expressed with physical units consistent with micromolar (for concentrations) and seconds (for time).\n- Case 1 (general upward crossing): $J_{\\mathrm{in}} = 0.06$ micromolar per second, $k_{\\mathrm{eff}} = 0.02$ per second, $c_{\\mathrm{th}} = 0.4$ micromolar, $c_0 = 0.05$ micromolar, $h = 0.2$ seconds, $t_{\\mathrm{end}} = 100$ seconds, $v_{\\mathrm{rel}} = 0.5$ per second, $c_s = 400$ micromolar.\n- Case 2 (near-threshold initial condition): $J_{\\mathrm{in}} = 0.06$ micromolar per second, $k_{\\mathrm{eff}} = 0.02$ per second, $c_{\\mathrm{th}} = 0.4$ micromolar, $c_0 = 0.399$ micromolar, $h = 0.5$ seconds, $t_{\\mathrm{end}} = 100$ seconds, $v_{\\mathrm{rel}} = 0.5$ per second, $c_s = 400$ micromolar.\n- Case 3 (no crossing, asymptotic to threshold from below): $J_{\\mathrm{in}} = 0.008$ micromolar per second, $k_{\\mathrm{eff}} = 0.02$ per second, $c_{\\mathrm{th}} = 0.4$ micromolar, $c_0 = 0.05$ micromolar, $h = 0.2$ seconds, $t_{\\mathrm{end}} = 100$ seconds, $v_{\\mathrm{rel}} = 0.5$ per second, $c_s = 400$ micromolar.\n- Case 4 (initially at threshold): $J_{\\mathrm{in}} = 0.06$ micromolar per second, $k_{\\mathrm{eff}} = 0.02$ per second, $c_{\\mathrm{th}} = 0.4$ micromolar, $c_0 = 0.4$ micromolar, $h = 0.1$ seconds, $t_{\\mathrm{end}} = 100$ seconds, $v_{\\mathrm{rel}} = 0.5$ per second, $c_s = 400$ micromolar.\n- Case 5 (coarse step crossing): $J_{\\mathrm{in}} = 0.8$ micromolar per second, $k_{\\mathrm{eff}} = 0.01$ per second, $c_{\\mathrm{th}} = 0.5$ micromolar, $c_0 = 0.05$ micromolar, $h = 1.0$ seconds, $t_{\\mathrm{end}} = 50$ seconds, $v_{\\mathrm{rel}} = 0.5$ per second, $c_s = 400$ micromolar.\n\nOutput specification:\n- Units: Report time errors in seconds and overshoot amplitudes in micromolar. Round each reported value to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain exactly fifteen numbers, grouped by case in the order: $[|t_{n+1} - t^\\star|_{\\mathrm{case\\ 1}}, |t_{\\mathrm{lin}} - t^\\star|_{\\mathrm{case\\ 1}}, \\mathrm{overshoot}_{\\mathrm{case\\ 1}}, |t_{n+1} - t^\\star|_{\\mathrm{case\\ 2}}, |t_{\\mathrm{lin}} - t^\\star|_{\\mathrm{case\\ 2}}, \\mathrm{overshoot}_{\\mathrm{case\\ 2}}, \\ldots, |t_{n+1} - t^\\star|_{\\mathrm{case\\ 5}}, |t_{\\mathrm{lin}} - t^\\star|_{\\mathrm{case\\ 5}}, \\mathrm{overshoot}_{\\mathrm{case\\ 5}}]$.",
            "solution": "We begin from flux balance in a well-mixed cytosolic compartment. Let $c(t)$ denote cytosolic free calcium concentration in micromolar, and consider inflow, outflow, and threshold-triggered release. Conservation dictates\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c + H\\!\\left(c - c_{\\mathrm{th}}\\right)\\,v_{\\mathrm{rel}}\\left(c_s - c\\right),\n$$\nwhere $J_{\\mathrm{in}}$ and $k_{\\mathrm{eff}}$ are constant parameters representing net constant inflow and linear extrusion. The Heaviside step function $H(\\cdot)$ encodes channel opening when the threshold $c_{\\mathrm{th}}$ is reached, introducing a piecewise-smooth vector field.\n\nThe event of interest is the first upward crossing of $c_{\\mathrm{th}}$. Before the event, channel release is inactive, and the dynamics reduce to the linear time-invariant ordinary differential equation\n$$\n\\frac{dc}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}\\,c.\n$$\nThis has exact solution\n$$\nc(t) = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t},\\quad c_{\\infty} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}},\n$$\nwhere $c_0$ is the initial concentration at $t=0$. The threshold crossing time $t^\\star$ is defined by $c(t^\\star) = c_{\\mathrm{th}}$ with an upward crossing. Setting the exact solution equal to $c_{\\mathrm{th}}$ gives\n$$\nc_{\\mathrm{th}} = c_{\\infty} + \\left(c_0 - c_{\\infty}\\right)e^{-k_{\\mathrm{eff}} t^\\star}.\n$$\nSolving for $t^\\star$ yields\n$$\ne^{-k_{\\mathrm{eff}} t^\\star} = \\frac{c_{\\mathrm{th}} - c_{\\infty}}{c_0 - c_{\\infty}},\n\\quad t^\\star = -\\frac{1}{k_{\\mathrm{eff}}}\\ln\\!\\left(\\frac{c_{\\mathrm{th}} - c_{\\infty}}{c_0 - c_{\\infty}}\\right).\n$$\nFor an upward crossing from below, we require $c_0  c_{\\mathrm{th}}  c_{\\infty}$, which ensures both numerator and denominator are negative with a positive ratio less than one, making $t^\\star$ positive. If $c_0 \\ge c_{\\mathrm{th}}$, then by definition the crossing time is $t^\\star = 0$. If $c_{\\infty} \\le c_{\\mathrm{th}}$ and $c_0  c_{\\mathrm{th}}$, then $c(t)$ is monotone increasing to $c_{\\infty}$ but never reaches $c_{\\mathrm{th}}$ in finite time; we declare no crossing occurs.\n\nTo analyze time discretization error near events, we examine a fixed-step explicit Euler method on the pre-event dynamics. For step size $h$, define\n$$\nc_{n+1} = c_n + h\\left(J_{\\mathrm{in}} - k_{\\mathrm{eff}} c_n\\right),\\quad t_{n+1} = t_n + h,\n$$\nwith $c_0$ given. The naive event detection declares the crossing at the first discrete time $t_{n+1}$ such that $c_{n+1} \\ge c_{\\mathrm{th}}$. This produces a time delay error because the actual crossing typically occurs between $t_n$ and $t_{n+1}$.\n\nA refined in-step event detection improves upon this by performing linear interpolation within the step. If $c_n  c_{\\mathrm{th}} \\le c_{n+1}$, define\n$$\n\\alpha = \\frac{c_{\\mathrm{th}} - c_n}{c_{n+1} - c_n},\\quad t_{\\mathrm{lin}} = t_n + \\alpha h.\n$$\nThis is a standard zero-crossing approximation using linear interpolation on the discrete solution sequence. While the pre-event dynamics are exactly exponential, linear interpolation provides a tractable in-step refinement that often dramatically reduces time detection error at modest computational cost.\n\nWe compare three quantities per test case:\n- The absolute naive time error $|t_{n+1} - t^\\star|$ in seconds.\n- The absolute refined time error $|t_{\\mathrm{lin}} - t^\\star|$ in seconds.\n- The naive overshoot amplitude $c_{n+1} - c_{\\mathrm{th}}$ in micromolar, which quantifies the amount by which the Euler method misses the threshold within the step.\n\nComputation algorithm:\n1. Given parameters $(J_{\\mathrm{in}}, k_{\\mathrm{eff}}, c_{\\mathrm{th}}, c_0, h, t_{\\mathrm{end}})$, compute $c_{\\infty} = J_{\\mathrm{in}}/k_{\\mathrm{eff}}$.\n2. Determine $t^\\star$ as follows:\n   - If $c_0 \\ge c_{\\mathrm{th}}$, set $t^\\star = 0$.\n   - Else if $c_{\\infty} \\le c_{\\mathrm{th}}$, set $t^\\star$ undefined and declare no crossing; output zeros for the metrics.\n   - Else compute $t^\\star = -\\dfrac{1}{k_{\\mathrm{eff}}}\\ln\\!\\left(\\dfrac{c_{\\mathrm{th}} - c_{\\infty}}{c_0 - c_{\\infty}}\\right)$.\n3. Perform fixed-step Euler iterations on the pre-event dynamics until either crossing is detected or $t_{\\mathrm{end}}$ is reached:\n   - Initialize $t=0$, $c=c_0$.\n   - If $c \\ge c_{\\mathrm{th}}$, immediately return zeros for the metrics (consistent with $t^\\star = 0$).\n   - Otherwise, iterate $c_{\\mathrm{new}} = c + h(J_{\\mathrm{in}} - k_{\\mathrm{eff}} c)$, $t_{\\mathrm{new}} = t + h$. If $c  c_{\\mathrm{th}} \\le c_{\\mathrm{new}}$, record naive event time $t_{n+1} = t_{\\mathrm{new}}$, overshoot $c_{\\mathrm{new}} - c_{\\mathrm{th}}$, and refined event time $t_{\\mathrm{lin}} = t + \\alpha h$ with $\\alpha = \\dfrac{c_{\\mathrm{th}} - c}{c_{\\mathrm{new}} - c}$.\n4. Compute errors $|t_{n+1} - t^\\star|$ and $|t_{\\mathrm{lin}} - t^\\star|$. If no crossing was found in-step and $t^\\star$ is undefined or beyond $t_{\\mathrm{end}}$, output zeros.\n\nScientific realism:\n- The parameters are in physically plausible ranges for micromolar concentrations and per-second rates.\n- The threshold-triggered term is inactive before crossing and does not affect pre-event dynamics, ensuring the exact $t^\\star$ formula applies.\n- Event handling uses linear interpolation within a step, a well-tested numerical practice.\n\nThe program implements the above algorithm, evaluates the five specified test cases, rounds each reported metric to six decimal places, and prints a single bracketed list of fifteen comma-separated numbers corresponding to the metrics in the order specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef exact_cross_time(c0, Jin, keff, cth):\n    \"\"\"\n    Compute the exact upward threshold crossing time for the pre-event dynamics:\n        dc/dt = Jin - keff * c\n    Returns:\n        t_star (float) if crossing occurs,\n        0.0 if c0 = cth (event at t=0),\n        None if no crossing occurs in finite time (c_infty = cth and c0  cth).\n    \"\"\"\n    c_inf = Jin / keff\n    if c0 = cth:\n        return 0.0\n    if c_inf = cth:\n        return None\n    num = cth - c_inf\n    den = c0 - c_inf\n    ratio = num / den\n    if ratio = 0:\n        # Should not happen for the upward crossing condition, but guard anyway.\n        return None\n    return -(1.0 / keff) * np.log(ratio)\n\ndef simulate_naive_and_linear(c0, Jin, keff, cth, h, t_end):\n    \"\"\"\n    Simulate pre-event dynamics using fixed-step explicit Euler until crossing.\n    Returns:\n        t_naive: naive event time (first sample at/above threshold), or None if not found.\n        t_linear: in-step linear interpolation event time, or None if not found.\n        overshoot: c_{n+1} - cth (=0 when crossing), or 0.0 if not found.\n    Edge cases:\n        If c0 = cth, return (0.0, 0.0, 0.0).\n    \"\"\"\n    t = 0.0\n    c = float(c0)\n    if c = cth:\n        return 0.0, 0.0, 0.0\n\n    n_steps = int(np.ceil(t_end / h))\n    for _ in range(n_steps):\n        # Pre-event Euler step (release term is inactive before crossing)\n        c_new = c + h * (Jin - keff * c)\n        t_new = t + h\n\n        if c  cth = c_new:\n            # Crossing occurred within this step\n            t_naive = t_new\n            # Linear interpolation fraction within the step\n            delta = c_new - c\n            if delta == 0.0:\n                alpha = 0.0\n            else:\n                alpha = (cth - c) / delta\n                # Clamp alpha to [0,1] for numerical safety\n                alpha = max(0.0, min(1.0, alpha))\n            t_linear = t + alpha * h\n            overshoot = c_new - cth\n            return t_naive, t_linear, overshoot\n\n        # Advance\n        t, c = t_new, c_new\n\n    # No crossing detected within t_end\n    return None, None, 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (J_in, k_eff, c_th, c0, h, t_end, v_rel, c_s)\n    test_cases = [\n        (0.06, 0.02, 0.4, 0.05, 0.2, 100.0, 0.5, 400.0),  # Case 1\n        (0.06, 0.02, 0.4, 0.399, 0.5, 100.0, 0.5, 400.0), # Case 2\n        (0.008, 0.02, 0.4, 0.05, 0.2, 100.0, 0.5, 400.0), # Case 3\n        (0.06, 0.02, 0.4, 0.4, 0.1, 100.0, 0.5, 400.0),   # Case 4\n        (0.8, 0.01, 0.5, 0.05, 1.0, 50.0, 0.5, 400.0),    # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        Jin, keff, cth, c0, h, t_end, v_rel, c_s = case\n\n        # Exact crossing time from analytical pre-threshold solution\n        t_star = exact_cross_time(c0, Jin, keff, cth)\n\n        # Naive and linear event detection on discrete Euler stepping\n        t_naive, t_linear, overshoot = simulate_naive_and_linear(c0, Jin, keff, cth, h, t_end)\n\n        # Compute errors based on rules\n        if t_star is None:\n            # No crossing in finite time: output zeros\n            naive_err = 0.0\n            linear_err = 0.0\n            overshoot_val = 0.0\n        else:\n            # If crossing exists (including t_star == 0)\n            if t_naive is None:\n                # No crossing detected within t_end despite t_star defined; treat as zeros\n                naive_err = 0.0\n                linear_err = 0.0\n                overshoot_val = 0.0\n            else:\n                naive_err = abs(t_naive - t_star)\n                linear_err = abs(t_linear - t_star) if t_linear is not None else abs(t_naive - t_star)\n                overshoot_val = max(0.0, overshoot)\n\n        # Round to six decimal places\n        naive_err = round(naive_err, 6)\n        linear_err = round(linear_err, 6)\n        overshoot_val = round(overshoot_val, 6)\n\n        results.extend([naive_err, linear_err, overshoot_val])\n\n    # Format output: single line, bracketed, comma-separated, no spaces.\n    # Ensure six decimal places formatting for consistency.\n    formatted = \"[\" + \",\".join(f\"{x:.6f}\" for x in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        },
        {
            "introduction": "Calcium signals are not confined to a single point; they propagate through the cell as waves, a process involving both chemical reactions and physical diffusion. This practice expands our scope from purely temporal models to spatiotemporal reaction-diffusion systems, which are essential for understanding calcium waves . You will address a critical issue in simulating these models: numerical stability, deriving the constraints that link physical parameters like diffusion coefficients and reaction rates to the maximum allowable time step in a simulation.",
            "id": "3904753",
            "problem": "Consider cytosolic calcium buffered by a single-site immobile buffer. Let $c(\\mathbf{x},t)$ denote the free calcium concentration and $b(\\mathbf{x},t)$ the bound buffer concentration. The free buffer is $f(\\mathbf{x},t) = B_T - b(\\mathbf{x},t)$, where $B_T$ is the spatially uniform total buffer. Calcium diffuses with diffusion coefficient $D_c$, while the buffer is immobile. Binding follows mass-action kinetics with forward rate constant $k_{\\mathrm{on}}$ and reverse rate constant $k_{\\mathrm{off}}$. The governing partial differential equations (PDEs) are\n$$\n\\frac{\\partial c}{\\partial t} = D_c \\nabla^2 c - k_{\\mathrm{on}}\\,c\\,f + k_{\\mathrm{off}}\\,b,\\qquad\n\\frac{\\partial b}{\\partial t} = k_{\\mathrm{on}}\\,c\\,f - k_{\\mathrm{off}}\\,b,\n$$\nwith $f = B_T - b$. Assume a spatially homogeneous steady state $(c^{\\ast},b^{\\ast})$ exists, with $f^{\\ast} = B_T - b^{\\ast}$.\n\nDiscretize space on a $d$-dimensional Cartesian grid with spacings $\\Delta x_1,\\dots,\\Delta x_d$, using the second-order central-difference Laplacian, and discretize time with the Forward Euler (FE) method of step size $\\Delta t$. You may assume periodic or sufficiently large domains so that a Fourier-mode analysis of linear stability is justified for interior points.\n\nStarting from fundamental modeling principles (Fick’s law of diffusion and mass-action kinetics) and linearizing the reaction terms about $(c^{\\ast},b^{\\ast})$, define the “fastest reaction rate” $k_{\\mathrm{fast}}$ as the magnitude of the most negative eigenvalue of the local $2\\times 2$ reaction Jacobian evaluated at $(c^{\\ast},b^{\\ast})$, and compute $k_{\\mathrm{fast}}$ explicitly in terms of $k_{\\mathrm{on}}$, $k_{\\mathrm{off}}$, $c^{\\ast}$, and $f^{\\ast}$.\n\nThen, by analyzing the linearized FE update for spatial Fourier modes and using only properties of the discrete Laplacian spectrum, derive a sufficient stability constraint for the explicit scheme that ensures linear stability for all spatial modes. Express the largest allowable time step $\\Delta t_{\\max}$ as a single closed-form analytic expression in terms of $k_{\\mathrm{fast}}$, $D_c$, $d$, and the grid spacings $\\Delta x_1,\\dots,\\Delta x_d$. Provide your final expression for $\\Delta t_{\\max}$ (no units required in the final expression). No numerical evaluation is required.",
            "solution": "The solution is derived in two main parts. First, the fastest reaction rate, $k_{\\mathrm{fast}}$, is calculated by linearizing the reaction kinetics. Second, the stability constraint for the Forward Euler numerical scheme, $\\Delta t_{\\max}$, is derived by analyzing the linearized system.\n\n**Part 1: Calculation of $k_{\\mathrm{fast}}$**\n\nThe reaction part of the system is described by the ODEs:\n$$\n\\frac{dc}{dt} = -k_{\\mathrm{on}}\\,c\\,(B_T - b) + k_{\\mathrm{off}}\\,b = R_c(c,b)\n$$\n$$\n\\frac{db}{dt} = k_{\\mathrm{on}}\\,c\\,(B_T - b) - k_{\\mathrm{off}}\\,b = R_b(c,b)\n$$\nLet the state vector be $\\mathbf{u} = \\begin{pmatrix} c \\\\ b \\end{pmatrix}$. The reaction vector is $\\mathbf{R}(\\mathbf{u}) = \\begin{pmatrix} R_c \\\\ R_b \\end{pmatrix}$. We linearize the reaction system by computing its Jacobian matrix, $J_R$, evaluated at the steady state $(c^{\\ast}, b^{\\ast})$. The free buffer concentration at steady state is $f^{\\ast} = B_T - b^{\\ast}$.\n\nThe partial derivatives are:\n$$\n\\frac{\\partial R_c}{\\partial c} = -k_{\\mathrm{on}}(B_T - b) = -k_{\\mathrm{on}}f\n$$\n$$\n\\frac{\\partial R_c}{\\partial b} = -k_{\\mathrm{on}}c(-1) + k_{\\mathrm{off}} = k_{\\mathrm{on}}c + k_{\\mathrm{off}}\n$$\nSince $R_b = -R_c$, we have $\\frac{\\partial R_b}{\\partial c} = -\\frac{\\partial R_c}{\\partial c} = k_{\\mathrm{on}}f$ and $\\frac{\\partial R_b}{\\partial b} = -\\frac{\\partial R_c}{\\partial b} = -(k_{\\mathrm{on}}c + k_{\\mathrm{off}})$.\n\nThe Jacobian matrix $J_R$ is:\n$$\nJ_R = \\begin{pmatrix} \\frac{\\partial R_c}{\\partial c}  \\frac{\\partial R_c}{\\partial b} \\\\ \\frac{\\partial R_b}{\\partial c}  \\frac{\\partial R_b}{\\partial b} \\end{pmatrix} = \\begin{pmatrix} -k_{\\mathrm{on}}f  k_{\\mathrm{on}}c + k_{\\mathrm{off}} \\\\ k_{\\mathrm{on}}f  -(k_{\\mathrm{on}}c + k_{\\mathrm{off}}) \\end{pmatrix}\n$$\nEvaluating at the steady state $(c^{\\ast}, b^{\\ast})$ where $f=f^{\\ast}$:\n$$\nJ_R^{\\ast} = \\begin{pmatrix} -k_{\\mathrm{on}}f^{\\ast}  k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}} \\\\ k_{\\mathrm{on}}f^{\\ast}  -(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) \\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$ of $J_R^{\\ast}$, we solve the characteristic equation $\\det(J_R^{\\ast} - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -k_{\\mathrm{on}}f^{\\ast} - \\lambda  k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}} \\\\ k_{\\mathrm{on}}f^{\\ast}  -(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-k_{\\mathrm{on}}f^{\\ast} - \\lambda)(- (k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) - \\lambda) - (k_{\\mathrm{on}}f^{\\ast})(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) = 0\n$$\nExpanding this gives:\n$$\n\\lambda^2 + \\lambda(k_{\\mathrm{on}}f^{\\ast} + k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) + k_{\\mathrm{on}}f^{\\ast}(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) - k_{\\mathrm{on}}f^{\\ast}(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) = 0\n$$\n$$\n\\lambda^2 + \\lambda(k_{\\mathrm{on}}f^{\\ast} + k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) = 0\n$$\n$$\n\\lambda \\left( \\lambda + (k_{\\mathrm{on}}(c^{\\ast} + f^{\\ast}) + k_{\\mathrm{off}}) \\right) = 0\n$$\nThe eigenvalues are $\\lambda_1 = 0$ and $\\lambda_2 = -(k_{\\mathrm{on}}(c^{\\ast} + f^{\\ast}) + k_{\\mathrm{off}})$. The zero eigenvalue reflects the conservation of total substance in the reaction subsystem (for every mole of free calcium that binds, one mole of bound buffer is created). The other eigenvalue is negative, representing the exponential relaxation to equilibrium.\n\nThe problem defines $k_{\\mathrm{fast}}$ as the magnitude of the most negative eigenvalue. Thus:\n$$\nk_{\\mathrm{fast}} = |\\lambda_2| = k_{\\mathrm{on}}(c^{\\ast} + f^{\\ast}) + k_{\\mathrm{off}}\n$$\n\n**Part 2: Derivation of the Stability Constraint $\\Delta t_{\\max}$**\n\nWe analyze the stability of the Forward Euler scheme applied to the linearized system. Let $\\delta c = c - c^{\\ast}$ and $\\delta b = b - b^{\\ast}$. The linearized PDE system is:\n$$\n\\frac{\\partial}{\\partial t} \\begin{pmatrix} \\delta c \\\\ \\delta b \\end{pmatrix} = \\begin{pmatrix} D_c \\nabla^2  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} \\delta c \\\\ \\delta b \\end{pmatrix} + J_R^{\\ast} \\begin{pmatrix} \\delta c \\\\ \\delta b \\end{pmatrix}\n$$\nWe perform a von Neumann stability analysis by considering a single Fourier mode $\\mathbf{u}_{\\mathbf{k}}(\\mathbf{x}, t) = \\hat{\\mathbf{u}}_\\mathbf{k}(t) e^{i\\mathbf{k} \\cdot \\mathbf{x}}$. For this mode, the second-order central-difference discrete Laplacian, $\\nabla_h^2$, acts as multiplication by its eigenvalue:\n$$\n\\Lambda_\\mathbf{k} = \\sum_{j=1}^{d} \\frac{2 \\cos(k_j \\Delta x_j) - 2}{(\\Delta x_j)^2} = -\\sum_{j=1}^{d} \\frac{4}{(\\Delta x_j)^2} \\sin^2\\left(\\frac{k_j \\Delta x_j}{2}\\right)\n$$\nThe ODE system for the amplitude $\\hat{\\mathbf{u}}_\\mathbf{k}$ of the mode with wavevector $\\mathbf{k}$ becomes:\n$$\n\\frac{d}{dt} \\hat{\\mathbf{u}}_\\mathbf{k} = M_{\\mathbf{k},h} \\hat{\\mathbf{u}}_\\mathbf{k}\n$$\nwhere $M_{\\mathbf{k},h}$ is the matrix for the semi-discretized system:\n$$\nM_{\\mathbf{k},h} = \\begin{pmatrix} D_c \\Lambda_\\mathbf{k}  0 \\\\ 0  0 \\end{pmatrix} + J_R^{\\ast} = \\begin{pmatrix} D_c \\Lambda_\\mathbf{k} - k_{\\mathrm{on}}f^{\\ast}  k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}} \\\\ k_{\\mathrm{on}}f^{\\ast}  -(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}) \\end{pmatrix}\n$$\nThe Forward Euler update for this mode is $\\hat{\\mathbf{u}}_\\mathbf{k}^{n+1} = (I + \\Delta t M_{\\mathbf{k},h}) \\hat{\\mathbf{u}}_\\mathbf{k}^n$. For linear stability, the eigenvalues $\\mu$ of the matrix $M_{\\mathbf{k},h}$ must satisfy $|1 + \\Delta t \\mu| \\le 1$. For systems with real, non-positive eigenvalues, this simplifies to $\\Delta t |\\mu_{\\max}| \\le 2$. A sufficient condition can be derived by bounding the spectral radius of $M_{\\mathbf{k},h}$ using the infinity norm, $\\rho(A) \\le \\|A\\|_\\infty$, which is the maximum absolute row sum.\n$$\n\\|M_{\\mathbf{k},h}\\|_\\infty = \\max(|D_c \\Lambda_\\mathbf{k} - k_{\\mathrm{on}}f^{\\ast}| + |k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}|, |k_{\\mathrm{on}}f^{\\ast}| + |-(k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}})|)\n$$\nSince all parameters are non-negative and $\\Lambda_\\mathbf{k} \\le 0$:\n$$\n\\|M_{\\mathbf{k},h}\\|_\\infty = \\max(-D_c \\Lambda_\\mathbf{k} + k_{\\mathrm{on}}f^{\\ast} + k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}}, k_{\\mathrm{on}}f^{\\ast} + k_{\\mathrm{on}}c^{\\ast} + k_{\\mathrm{off}})\n$$\n$$\n\\|M_{\\mathbf{k},h}\\|_\\infty = \\max(-D_c \\Lambda_\\mathbf{k} + k_{\\mathrm{fast}}, k_{\\mathrm{fast}}) = -D_c \\Lambda_\\mathbf{k} + k_{\\mathrm{fast}}\n$$\nTo get a stability constraint valid for all modes, we must use the maximum value of this bound over all $\\mathbf{k}$:\n$$\n\\max_{\\mathbf{k}} \\|M_{\\mathbf{k},h}\\|_\\infty = D_c (\\max_{\\mathbf{k}}(-\\Lambda_\\mathbf{k})) + k_{\\mathrm{fast}}\n$$\nThe maximum value of $-\\Lambda_\\mathbf{k}$ occurs for the highest frequency modes, where $\\sin^2(\\cdot) = 1$:\n$$\n\\max_{\\mathbf{k}}(-\\Lambda_\\mathbf{k}) = \\sum_{j=1}^{d} \\frac{4}{(\\Delta x_j)^2} = 4 \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}\n$$\nThe overall bound on the spectral radius of the operator is thus $4 D_c \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2} + k_{\\mathrm{fast}}$. The stability condition for Forward Euler requires:\n$$\n\\Delta t \\left( 4 D_c \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2} + k_{\\mathrm{fast}} \\right) \\le 2\n$$\nThe largest allowable time step $\\Delta t_{\\max}$ under this sufficient constraint is therefore:\n$$\n\\Delta t_{\\max} = \\frac{2}{k_{\\mathrm{fast}} + 4 D_c \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}}\n$$\nThis expression captures the constraints imposed by both the fastest reaction timescale (via $k_{\\mathrm{fast}}$) and the fastest diffusion timescale across the grid (via $D_c$ and $\\Delta x_j$).",
            "answer": "$$\\boxed{\\frac{2}{k_{\\mathrm{fast}} + 4 D_c \\sum_{j=1}^{d} \\frac{1}{(\\Delta x_j)^2}}}$$"
        }
    ]
}