{
    "hands_on_practices": [
        {
            "introduction": "要建立转录调控的定量模型，第一步是精确描述转录因子（TF）与DNA的物理相互作用。本练习将引导你运用统计力学的基本原理，为包含两个TF结合位点的启动子构建模型。通过这个过程，你将学会如何构建配分函数——这是所有平衡态热力学模型的基石——并理解协同性（cooperativity）如何影响TF在启动子上的总占据率，这是解释基因表达中常见的开关式响应的关键。",
            "id": "3908134",
            "problem": "考虑一个启动子，它具有两个不重叠的结合位点，用于结合单一类型的转录因子（TF）。该转录因子在细胞核中的体积浓度为 $c$。每个位点 $i \\in \\{1,2\\}$ 结合一个TF分子，在绝对温度 $T$ 下的标准解离常数为 $K_{i}$。令 $\\epsilon_{i}$ 表示位点 $i$ 的标准结合自由能，其中 $K_{i}$ 和 $\\epsilon_{i}$ 通过理想溶液约定相关联。假设TF表现为理想溶质，其化学势由 $\\mu = \\mu^{\\circ} + k_{B} T \\ln\\!\\left(\\frac{c}{c^{\\circ}}\\right)$ 给出，其中 $k_{B}$ 是玻尔兹曼常数，$c^{\\circ}$ 是标准浓度。记 $\\beta = 1/(k_{B} T)$。该启动子可以占据四种微观状态：两个位点均未结合、仅位点1结合、仅位点2结合或两个位点均结合。当两个位点都被占据时，它们之间的相互作用（耦合）自由能为 $\\epsilon_{12}$，其中 $\\epsilon_{12} = 0$ 表示独立性，$\\epsilon_{12} \\neq 0$ 表示弱协同性。\n\n从统计力学原理出发，即自由能为 $E$ 的微观状态的平衡概率与玻尔兹曼因子 $\\exp(-\\beta E)$ 成正比，推导这个双位点系统的结合多项式（配分函数），并用它来获得预期的总TF占据数。预期总TF占据数定义为两个位点上结合的TF分子数的平衡期望值。将您的最终结果表示为关于 $c$, $K_{1}$, $K_{2}$, $T$, 和 $\\epsilon_{12}$ 的闭合形式解析表达式，并通过引入无量纲协同因子 $\\omega = \\exp(-\\beta \\epsilon_{12})$ 对其进行简化。您的最终答案必须是一个单一的解析表达式。不需要进行数值计算。",
            "solution": "该系统有四种微观状态，区别在于哪些位点被占据。我们为每个状态分配一个自由能并计算其玻尔兹曼权重。我们使用化学势为 $\\mu$ 的巨正则系综视角来考虑溶液和启动子之间的TF分子交换。微观状态及其自由能如下：\n\n- 两个位点均未结合：$E_{0} = 0$（参考态）。\n- 仅位点1结合：$E_{1} = \\epsilon_{1} - \\mu$。\n- 仅位点2结合：$E_{2} = \\epsilon_{2} - \\mu$。\n- 两个位点均结合：$E_{12} = \\epsilon_{1} + \\epsilon_{2} + \\epsilon_{12} - 2 \\mu$。\n\n此处，$\\epsilon_{1}$ 和 $\\epsilon_{2}$ 是两个位点的标准结合自由能，$\\epsilon_{12}$ 描述了当两个位点都被占据时的相互作用。相关的玻尔兹曼权重为\n$$\nw_{0} = \\exp(-\\beta E_{0}) = 1,\n\\quad\nw_{1} = \\exp\\!\\big(-\\beta(\\epsilon_{1} - \\mu)\\big),\n$$\n$$\nw_{2} = \\exp(-\\beta E_{2}) = \\exp\\!\\big(-\\beta(\\epsilon_{2} - \\mu)\\big),\n\\quad\nw_{12} = \\exp(-\\beta E_{12}) = \\exp\\!\\big(-\\beta(\\epsilon_{1} + \\epsilon_{2} + \\epsilon_{12} - 2\\mu)\\big).\n$$\n\n配分函数（结合多项式）是这些权重的总和：\n$$\nZ = w_{0} + w_{1} + w_{2} + w_{12}.\n$$\n\n我们现在用实验可测量的量来表示这些权重。根据理想溶液约定，标准解离常数 $K_{i}$ 与标准结合自由能的关系为\n$$\nK_{i} = c^{\\circ} \\exp(\\beta \\epsilon_{i}),\n$$\n并且溶液中TF的化学势为\n$$\n\\mu = \\mu^{\\circ} + k_{B} T \\ln\\!\\left(\\frac{c}{c^{\\circ}}\\right).\n$$\n差值 $\\mu - \\mu^{\\circ} = k_{B} T \\ln(c/c^{\\circ})$ 意味着 $\\exp(\\beta \\mu) = \\exp(\\beta \\mu^{\\circ}) \\frac{c}{c^{\\circ}}$。合并标准态因子，可以得到与 $c/K_{i}$ 成正比的熟悉的结合权重。具体来说，\n$$\nw_{1} = \\exp\\!\\big(-\\beta(\\epsilon_{1} - \\mu)\\big) = \\exp(-\\beta \\epsilon_{1}) \\exp(\\beta \\mu) \n= \\frac{c}{c^{\\circ}} \\exp(-\\beta \\epsilon_{1}) \\exp(\\beta \\mu^{\\circ}).\n$$\n使用 $K_{1} = c^{\\circ} \\exp(\\beta \\epsilon_{1})$ 并在所有权重中一致地吸收公共标准态因子 $\\exp(\\beta \\mu^{\\circ})$，权重之比将变得与 $\\mu^{\\circ}$ 和 $c^{\\circ}$ 的选择无关，从而得到\n$$\n\\frac{w_{1}}{w_{0}} = \\frac{c}{K_{1}}, \n\\quad\n\\frac{w_{2}}{w_{0}} = \\frac{c}{K_{2}}.\n$$\n对于双重结合状态，\n$$\nw_{12} = \\exp\\!\\big(-\\beta(\\epsilon_{1} + \\epsilon_{2} + \\epsilon_{12} - 2\\mu)\\big)\n= \\exp(-\\beta \\epsilon_{1}) \\exp(-\\beta \\epsilon_{2}) \\exp(-\\beta \\epsilon_{12}) \\exp(2\\beta \\mu).\n$$\n仿照上述步骤，\n$$\n\\frac{w_{12}}{w_{0}} = \\exp(-\\beta \\epsilon_{12}) \\frac{c^{2}}{K_{1} K_{2}}.\n$$\n定义无量纲协同因子\n$$\n\\omega = \\exp(-\\beta \\epsilon_{12}).\n$$\n那么\n$$\nw_{0} = 1, \n\\quad\nw_{1} = \\frac{c}{K_{1}},\n\\quad\nw_{2} = \\frac{c}{K_{2}},\n\\quad\nw_{12} = \\omega \\frac{c^{2}}{K_{1} K_{2}}.\n$$\n因此，配分函数是\n$$\nZ = 1 + \\frac{c}{K_{1}} + \\frac{c}{K_{2}} + \\omega \\frac{c^{2}}{K_{1} K_{2}}.\n$$\n\n预期总TF占据数，定义为两个位点上结合的TF分子数的期望值，是每个状态的占据数除以 $Z$ 的加权平均值。各状态的占据数分别为0（均未结合）、1（仅位点1结合）、1（仅位点2结合）和2（均结合）。因此，\n$$\nN_{\\text{occ}}(c; K_{1}, K_{2}, \\omega) \n= \\frac{0 \\cdot w_{0} + 1 \\cdot w_{1} + 1 \\cdot w_{2} + 2 \\cdot w_{12}}{Z}\n= \\frac{\\frac{c}{K_{1}} + \\frac{c}{K_{2}} + 2 \\omega \\frac{c^{2}}{K_{1} K_{2}}}{1 + \\frac{c}{K_{1}} + \\frac{c}{K_{2}} + \\omega \\frac{c^{2}}{K_{1} K_{2}}}.\n$$\n\n关于独立性与弱协同性的讨论：独立性对应于 $\\epsilon_{12} = 0$，即 $\\omega = \\exp(-\\beta \\cdot 0) = 1$。在这种情况下，双重占据的权重可以分解为单个位点权重的乘积，配分函数简化为 $Z = 1 + \\frac{c}{K_{1}} + \\frac{c}{K_{2}} + \\frac{c^{2}}{K_{1} K_{2}}$。弱协同性对应于较小的 $|\\epsilon_{12}|$（即 $\\omega$ 略微偏离1）。正协同性意味着 $\\epsilon_{12}  0$，因此 $\\omega  1$，这会增加双重结合状态的概率，从而与独立情况相比，增加了 $N_{\\text{occ}}$，尤其是在中到高浓度 $c$ 的情况下。负协同性意味着 $\\epsilon_{12}  0$，因此 $\\omega  1$，这会减小双重结合的权重并降低 $N_{\\text{occ}}$。在低浓度极限 $c \\ll \\min(K_{1}, K_{2})$ 下，$N_{\\text{occ}} \\approx \\frac{c}{K_{1}} + \\frac{c}{K_{2}}$，在主导阶上与 $\\omega$ 无关，这反映了双重占据是罕见的。在高浓度极限 $c \\gg \\max(K_{1}, K_{2})$ 下，对于任何固定的 $\\omega  0$，$N_{\\text{occ}} \\to 2$，但当 $\\omega  1$ 时，趋于饱和的过程会加速，而当 $\\omega  1$ 时则会减速。\n\n因此，预期总TF占据数的闭合形式解析表达式为\n$$\nN_{\\text{occ}}(c; K_{1}, K_{2}, \\omega) \n= \\frac{\\frac{c}{K_{1}} + \\frac{c}{K_{2}} + 2 \\omega \\frac{c^{2}}{K_{1} K_{2}}}{1 + \\frac{c}{K_{1}} + \\frac{c}{K_{2}} + \\omega \\frac{c^{2}}{K_{1} K_{2}}},\n$$\n其中 $\\omega = \\exp(-\\beta \\epsilon_{12})$，并且当设置 $\\omega = 1$ 时恢复独立性情况。",
            "answer": "$$\\boxed{\\frac{\\frac{c}{K_{1}}+\\frac{c}{K_{2}}+2\\,\\omega\\,\\frac{c^{2}}{K_{1}K_{2}}}{1+\\frac{c}{K_{1}}+\\frac{c}{K_{2}}+\\omega\\,\\frac{c^{2}}{K_{1}K_{2}}}}$$"
        },
        {
            "introduction": "仅仅知道转录因子的结合情况还不够，我们的最终目标是预测基因的表达水平。这个练习将前一个练习中的结合模型向前推进了一步，它将TF的结合与RNA聚合酶（RNAP）的招募以及最终的转录输出联系起来，从而构建一个完整的输入-输出函数。本练习还将着重训练一个关键的建模技巧：无量纲化（non-dimensionalization），它能将复杂的模型简化，揭示出控制系统行为的核心无量纲参数组合，使你的模型更具普适性和洞察力。",
            "id": "3908138",
            "problem": "一个启动子受单一转录激活子调控，该激活子的结合会增加核糖核酸（RNA）聚合酶（RNAP）加载的概率。假设启动子状态遵循以下准平衡热力学模型，该模型广泛用于转录调控的建模：\n\n- 启动子有 $4$ 种互斥状态：空状态、仅激活子结合状态、仅RNAP结合状态和激活子-RNAP共结合状态。\n- 激活子以大小为 $n$ 的寡聚体形式结合到解离常数为 $K_d$ 的单个位点上，因此激活子占据的热力学权重与 $(c/K_d)^{n}$ 成正比，其中 $c$ 是游离激活子的浓度。\n- RNAP以一个有效的无量纲权重 $p$ 结合，该权重结合了RNAP浓度及其对启动子的解离常数。\n- 当激活子和RNAP同时结合时，存在一个由无量纲协同因子 $\\omega$ 参数化的稳定相互作用，该因子乘以共结合状态的权重。\n- 转录仅在RNAP结合时发生，起始速率为 $r$。信使RNA以一级速率 $\\gamma$ 降解/稀释，产生稳态活性 $f(c) = \\alpha \\, P_{\\mathrm{RNAP}}(c)$，其中 $\\alpha = r/\\gamma$，而 $P_{\\mathrm{RNAP}}(c)$ 是RNAP结合的概率。\n\n令 $f_{\\max} \\equiv \\lim_{c \\to \\infty} f(c)$ 表示在激活子饱和时的渐近最大活性。定义无量纲输入 $x = c/K_d$ 和无量纲输出 $y = f(c)/f_{\\max}$。\n\n从准平衡统计占据框架和激活子的质量作用结合出发，推导无量纲输入输出函数 $y(x)$ 的闭式表达式，该表达式仅用 $x$、$n$、$p$ 和 $\\omega$ 表示。在推导过程中，请指明决定 $y(x)$ 形状的关键独立无量纲群，并明确展示有量纲参数如何在 $y(x)$ 中被抵消。\n\n将最终答案表示为 $y(x)$ 的单一闭式表达式，用 $x$、$n$、$p$ 和 $\\omega$ 表示。不包括单位。无需四舍五入。",
            "solution": "推导始于将统计力学原理应用于激活子和RNA聚合酶（RNAP）与启动子的准平衡结合。该系统有四种互斥状态，启动子处于任何特定状态的概率与该状态的热力学权重成正比。\n\n让我们定义启动子四种状态中每一种相对于空状态的统计权重 $W$，空状态的权重被指定为 $1$。激活子的无量纲浓度为 $x = c/K_d$。\n\n1.  **空状态（仅启动子）：** 没有分子结合。\n    $$W_0 = 1$$\n2.  **激活子结合状态：** 激活子寡聚体已结合，但RNAP未结合。权重与 $(c/K_d)^n$ 成正比。\n    $$W_A = x^n$$\n3.  **RNAP结合状态：** RNAP已结合，但激活子未结合。权重由无量纲参数 $p$ 给出。\n    $$W_P = p$$\n4.  **激活子-RNAP共结合状态：** 激活子和RNAP同时结合。权重是各自结合权重的乘积，再乘以无量纲协同因子 $\\omega$。\n    $$W_{AP} = W_A \\cdot W_P \\cdot \\omega = x^n \\cdot p \\cdot \\omega$$\n\n配分函数 $Z(x)$ 是所有可能状态的统计权重之和。它作为计算概率的归一化常数。\n$$Z(x) = W_0 + W_A + W_P + W_{AP}$$\n$$Z(x) = 1 + x^n + p + p\\omega x^n$$\n我们可以按 $x$ 的幂次收集项：\n$$Z(x) = (1+p) + (1+p\\omega)x^n$$\n\n根据问题描述，转录仅在RNAP结合时发生。这对应于RNAP结合状态和共结合状态。RNAP结合的概率 $P_{\\mathrm{RNAP}}(x)$ 是这两种状态的权重之和除以配分函数。\n$$P_{\\mathrm{RNAP}}(x) = \\frac{W_P + W_{AP}}{Z(x)} = \\frac{p + p\\omega x^n}{(1+p) + (1+p\\omega)x^n}$$\n这可以因式分解为：\n$$P_{\\mathrm{RNAP}}(x) = \\frac{p(1 + \\omega x^n)}{(1+p) + (1+p\\omega)x^n}$$\n\n稳态转录活性由 $f(c) = \\alpha \\, P_{\\mathrm{RNAP}}(c)$ 给出，其中 $\\alpha = r/\\gamma$。用无量纲输入 $x$ 表示，即为 $f(x) = \\alpha \\, P_{\\mathrm{RNAP}}(x)$。\n\n接下来，我们必须找到渐近最大活性 $f_{\\max}$，它被定义为当 $c \\to \\infty$ 时 $f(c)$ 的极限。这等价于当 $x \\to \\infty$ 时 $f(x)$ 的极限。\n$$f_{\\max} = \\lim_{x \\to \\infty} f(x) = \\lim_{x \\to \\infty} \\left( \\alpha \\frac{p(1 + \\omega x^n)}{(1+p) + (1+p\\omega)x^n} \\right)$$\n为了计算极限，我们将分子和分母同除以 $x$ 的最高次幂，即 $x^n$。\n$$f_{\\max} = \\alpha \\lim_{x \\to \\infty} \\frac{p(\\frac{1}{x^n} + \\omega)}{(\\frac{1+p}{x^n}) + (1+p\\omega)}$$\n当 $x \\to \\infty$ 时，分母中包含 $x^n$ 的项趋于 $0$。\n$$f_{\\max} = \\alpha \\frac{p(0 + \\omega)}{0 + (1+p\\omega)} = \\alpha \\frac{p\\omega}{1+p\\omega}$$\n需要注意的是，如果 $\\omega=0$ 或 $p=0$，那么 $f_{\\max}=0$。该问题在 $\\omega  0$ 和 $p0$ 时具有物理意义。\n\n最后一步是推导无量纲输入输出函数 $y(x) = f(x)/f_{\\max}$。\n$$y(x) = \\frac{f(x)}{f_{\\max}} = \\frac{\\alpha \\, P_{\\mathrm{RNAP}}(x)}{\\alpha \\frac{p\\omega}{1+p\\omega}}$$\n有量纲常数 $\\alpha=r/\\gamma$ 被抵消，这表明归一化输出与转录和降解的绝对速率无关。\n$$y(x) = \\frac{\\frac{p(1 + \\omega x^n)}{(1+p) + (1+p\\omega)x^n}}{\\frac{p\\omega}{1+p\\omega}}$$\n假设 $p  0$，因子 $p$ 也被抵消：\n$$y(x) = \\frac{1 + \\omega x^n}{(1+p) + (1+p\\omega)x^n} \\cdot \\frac{1+p\\omega}{\\omega}$$\n该表达式给出了用 $x$、$n$、$p$ 和 $\\omega$ 表示的 $y(x)$。有量纲参数 $c$ 和 $K_d$ 包含在无量纲输入 $x$ 中，所有其他有量纲参数（$r, \\gamma$）都已被抵消。因此，输入输出曲线的形状仅由无量纲群 $n$、$p$ 和 $\\omega$ 决定。\n\n为了得到一个更优雅且更具洞察力的形式，我们可以简化这个表达式。让我们通过将分子乘以 $(1+p\\omega)$ 并将分母乘以 $\\omega$ 来处理这个分数。\n$$y(x) = \\frac{(1 + \\omega x^n)(1+p\\omega)}{\\omega((1+p) + (1+p\\omega)x^n)}$$\n现在，将这个较大分数的分子和分母同除以项 $\\omega(1+p\\omega)$。\n分子变为：\n$$\\frac{(1 + \\omega x^n)(1+p\\omega)}{\\omega(1+p\\omega)} = \\frac{1 + \\omega x^n}{\\omega} = x^n + \\frac{1}{\\omega}$$\n分母变为：\n$$\\frac{\\omega((1+p) + (1+p\\omega)x^n)}{\\omega(1+p\\omega)} = \\frac{(1+p) + (1+p\\omega)x^n}{1+p\\omega} = \\frac{1+p}{1+p\\omega} + \\frac{(1+p\\omega)x^n}{1+p\\omega} = x^n + \\frac{1+p}{1+p\\omega}$$\n结合这些结果，得到 $y(x)$ 的最终闭式表达式：\n$$y(x) = \\frac{x^n + \\frac{1}{\\omega}}{x^n + \\frac{1+p}{1+p\\omega}}$$\n这个表达式就是所求的输入输出函数，仅用无量纲输入 $x$ 和无量纲参数 $n$、$p$ 和 $\\omega$ 书写。",
            "answer": "$$\\boxed{\\frac{x^n + \\frac{1}{\\omega}}{x^n + \\frac{1+p}{1+p\\omega}}}$$"
        },
        {
            "introduction": "前面的模型描述了细胞群体的平均行为，然而在单个细胞内，基因表达本质上是随机的。这个高级练习将带你从确定性模型迈向随机模型，介绍基因表达研究中经典的“电报模型”（telegraph model）。通过求解该模型，你将能够推导出单个细胞中信使RNA（mRNA）分子数量的完整概率分布，这可以直接与现代单细胞测序数据进行比较，并探讨在参数推断中遇到的挑战与关键概念，例如参数的可识别性问题。",
            "id": "3908091",
            "problem": "考虑一个细胞同质群体中单个基因的双态启动子模型，其中启动子在非激活状态和激活状态之间切换。这些转换被建模为连续时间马尔可夫过程，具有以下生化速率：启动子以速率 $k_{\\text{on}}$ 从非激活状态切换到激活状态，并以速率 $k_{\\text{off}}$ 从激活状态切换回非激活状态。在激活状态下，该基因根据泊松过程以速率 $k_{\\text{tx}}$ 转录信使核糖核酸（mRNA）分子。每个mRNA分子遵循一级动力学，以速率 $\\gamma$ 独立降解。假设系统在恒定的环境条件下已达到稳态。\n\n您在稳态下从 $M$ 个独立细胞中收集单细胞mRNA计数的快照；将观察到的计数表示为 $\\{n_{i}\\}_{i=1}^{M}$，其中 $n_{i} \\in \\{0,1,2,\\dots\\}$。\n\n仅从上述定义以及泊松过程、指数寿命、点过程的叠加和稀疏化的标准性质出发，完成以下任务：\n\n1. 将转录爆发建模为启动子激活的序列。推导细胞中总mRNA计数的稳态分布。用闭合形式表达您的结果并确定分布族。将分布的参数确定为 $k_{\\text{on}}$、$k_{\\text{off}}$、$k_{\\text{tx}}$ 和 $\\gamma$ 的函数。\n\n2. 使用推导出的稳态分布，为观察到的数据写出似然函数 $L(k_{\\text{on}},k_{\\text{off}},k_{\\text{tx}},\\gamma \\,;\\, n_{1},\\dots,n_{M})$，假设细胞间相互独立。\n\n3. 概述参数 $\\left(k_{\\text{on}},k_{\\text{off}},k_{\\text{tx}},\\gamma\\right)$ 的最大似然估计程序，包括 (i) 一个强制正性约束的清晰的重参数化方法，(ii) 对数似然及其梯度的作用，(iii) 该模型中由快照计数产生的任何可识别性考虑，以及 (iv) 一种结合任何外部测量以解决不可识别性问题的原则性方法。\n\n请将您的最终似然函数以 $k_{\\text{on}}$、$k_{\\text{off}}$、$k_{\\text{tx}}$、$\\gamma$ 和 $\\{n_{i}\\}_{i=1}^{M}$ 的形式，表示为单个解析表达式。无需进行数值计算。",
            "solution": "**1. mRNA计数的稳态分布**\n\n在任何给定时间，细胞中mRNA分子数 $n$ 是转录和降解这两个随机过程的结果。转录速率不是恒定的，而是受启动子状态的调制，该状态在激活状态（速率 $k_{\\text{tx}}$）和非激活状态（速率 $0$）之间切换。每个mRNA分子一旦产生，其寿命独立且服从指数分布，均值为 $1/\\gamma$。\n\n在稳态下，mRNA分子数 $n$ 等同于在观察时刻仍然“存活”的、来自一个受调制泊松过程的到达数量。在时间 $t-\\tau$ 产生的mRNA分子存活到时间 $t$ 的概率为 $\\exp(-\\gamma \\tau)$。设 $S(t)$ 为启动子状态，其中 $S(t)=1$ 表示激活，$S(t)=0$ 表示非激活。瞬时转录速率为 $k_{\\text{tx}}S(t)$。时间 $t$ 的mRNA计数 $n$ 可以描述为一个泊松随机变量，其参数 $\\Lambda(t)$ 是过去转录历史的积分，并由存活概率加权：\n$$ \\Lambda(t) = \\int_{0}^{\\infty} k_{\\text{tx}} S(t-\\tau) \\exp(-\\gamma \\tau) d\\tau $$\n由于系统处于稳态， $n$ 的分布是恒定的。我们可以通过找到随机变量 $\\Lambda$ 的分布来表征这个分布。令 $x = \\gamma \\int_{0}^{\\infty} S(t-\\tau) \\exp(-\\gamma \\tau) d\\tau$。这个变量 $x$ 是启动子状态历史的指数加权移动平均。$x$ 的随机微分方程为 $dx/dt = \\gamma(S(t) - x)$。这是一个由电报噪声 $S(t)$ 驱动的Ornstein-Uhlenbeck过程。\n\n对于一个具有切换速率 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 的双态马尔可夫过程 $S(t)$，过滤过程 $x(t)$ 的稳态分布是在区间 $[0, 1]$ 上的一个贝塔分布：\n$$ x \\sim \\text{Beta}(a, b) \\quad \\text{其PDF为} \\quad f(x|a, b) = \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)} $$\n这个贝塔分布的参数由动力学速率的比值给出：\n$$ a = \\frac{k_{\\text{on}}}{\\gamma} \\quad \\text{和} \\quad b = \\frac{k_{\\text{off}}}{\\gamma} $$\n因此，mRNA计数 $n$ 是一个混合泊松变量，其中 $n \\sim \\text{Poisson}(\\lambda)$ 且速率参数 $\\lambda = \\frac{k_{\\text{tx}}}{\\gamma} x = \\beta x$，其中 $\\beta = k_{\\text{tx}}/\\gamma$。$n$ 的最终分布是一个**泊松-贝塔分布**。\n\n概率质量函数（PMF）$P(n)$ 是通过对 $x$ 的分布进行边缘化得到的：\n$$ P(n) = \\int_0^1 P(n|\\lambda=\\beta x) f(x|a,b) dx $$\n$$ P(n) = \\int_0^1 \\frac{(\\beta x)^n \\exp(-\\beta x)}{n!} \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)} dx $$\n其中 $B(a,b) = \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}$ 是贝塔函数。重新整理各项，我们得到：\n$$ P(n) = \\frac{\\beta^n}{n! B(a,b)} \\int_0^1 x^{n+a-1} (1-x)^{b-1} \\exp(-\\beta x) dx $$\n该积分是第一类合流超几何函数 ${}_1F_1(u;v;z)$ 的一种表示，也称为Kummer函数。PMF可以用闭合形式写为：\n$$ P(n) = \\frac{B(n+a, b)}{B(a,b)} \\frac{\\beta^n}{n!} {}_1F_1(n+a; n+a+b; -\\beta) $$\n使用Pochhammer符号的性质 $(q)_k = \\Gamma(q+k)/\\Gamma(q)$，这可以简化为：\n$$ P(n | a, b, \\beta) = \\frac{(a)_n}{(a+b)_n} \\frac{\\beta^n}{n!} {}_1F_1(a+n; a+b+n; -\\beta) $$\n其中参数是基础动力学速率的函数：\n- $a = k_{\\text{on}}/\\gamma$\n- $b = k_{\\text{off}}/\\gamma$\n- $\\beta = k_{\\text{tx}}/\\gamma$\n\n**2. 似然函数**\n\n观测数据由 $M$ 个独立的mRNA计数测量值 $\\{n_1, n_2, \\dots, n_M\\}$ 组成。模型参数 $\\theta = (k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma)$ 的似然函数 $L$ 是在给定参数下，观测到每个计数的概率的乘积。\n$$ L(\\theta \\,;\\, \\{n_i\\}_{i=1}^M) = \\prod_{i=1}^M P(n_i | \\theta) $$\n代入上面推导的PMF，并令 $a(\\theta) = k_{\\text{on}}/\\gamma$，$b(\\theta) = k_{\\text{off}}/\\gamma$ 和 $\\beta(\\theta) = k_{\\text{tx}}/\\gamma$：\n$$ L(k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma \\,;\\, \\{n_i\\}) = \\prod_{i=1}^M \\left[ \\frac{(a)_{n_i}}{(a+b)_{n_i}} \\frac{\\beta^{n_i}}{n_i!} {}_1F_1(a+n_i; a+b+n_i; -\\beta) \\right] $$\n这就是所求的似然函数。\n\n**3. 最大似然估计（MLE）程序**\n\nMLE的目标是找到使似然函数 $L(\\theta)$ 最大化的参数值 $\\hat{\\theta}$。\n\n**(i) 重参数化：**\n动力学速率 $k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma$ 必须是严格正数。为了在数值优化过程中强制执行此约束，标准做法是对它们进行重参数化。一个常见的选择是指数变换：\n$$ k_{\\text{on}} = \\exp(\\kappa_{\\text{on}}), \\quad k_{\\text{off}} = \\exp(\\kappa_{\\text{off}}), \\quad k_{\\text{tx}} = \\exp(\\kappa_{\\text{tx}}), \\quad \\gamma = \\exp(\\kappa_{\\gamma}) $$\n优化随后在新的参数 $\\kappa \\in \\mathbb{R}^4$ 上进行，这是一个无约束问题，更适合标准的基于梯度的算法。\n\n**(ii) 对数似然和梯度：**\n最大化似然 $L$ 等价于最大化对数似然 $\\mathcal{L} = \\ln(L)$，后者在数值上更稳定，在分析上更方便。\n$$ \\mathcal{L}(\\theta \\,;\\, \\{n_i\\}) = \\sum_{i=1}^M \\ln P(n_i | \\theta) $$\n$$ \\mathcal{L} = \\sum_{i=1}^M \\left[ \\sum_{j=0}^{n_i-1}\\ln(a+j) - \\sum_{j=0}^{n_i-1}\\ln(a+b+j) + n_i\\ln(\\beta) - \\ln(n_i!) + \\ln({}_1F_1(a+n_i; a+b+n_i; -\\beta)) \\right] $$\nMLE估计值 $\\hat{\\theta}$ 是通过求解 $\\nabla_{\\kappa} \\mathcal{L}(\\kappa) = 0$ 得到的。这通常需要使用数值优化方法（例如L-BFGS、Nelder-Mead），这些方法使用对数似然相对于 $\\kappa$ 参数的梯度。梯度使用链式法则计算，例如 $\\frac{\\partial \\mathcal{L}}{\\partial \\kappa_j} = \\frac{\\partial \\mathcalL}{\\partial k_j} \\frac{\\partial k_j}{\\partial \\kappa_j} = \\frac{\\partial \\mathcal{L}}{\\partial k_j} k_j$。这需要计算对数伽马函数（digamma函数）和合流超几何函数的导数。\n\n**(iii) 可识别性考虑：**\n似然函数完全由三个无量纲量 $a=k_{\\text{on}}/\\gamma$、$b=k_{\\text{off}}/\\gamma$ 和 $\\beta=k_{\\text{tx}}/\\gamma$ 参数化。这意味着，从单个稳态mRNA计数的快照中，人们只能识别这三个比率。四个基础动力学参数 $(k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma)$ 是不可唯一识别的。对于任何最优的比率集 $(\\hat{a}, \\hat{b}, \\hat{\\beta})$，任何形式为 $(C\\hat{a}, C\\hat{b}, C\\hat{\\beta}, C)$（其中 $C0$ 是任意常数）的参数集都会产生相同的似然。这种模糊性反映了一个事实，即稳态分布不包含关于系统动力学绝对时间尺度的信息，该时间尺度由 $\\gamma$ 设定。\n\n**(iv) 解决不可识别性问题：**\n为了唯一确定所有四个动力学速率，需要额外的实验信息来打破尺度模糊性。一个有原则的方法包括：\n- **独立测量一个速率：** 最常见的方法是独立测量其中一个速率。例如，mRNA降解速率 $\\gamma$ 可以通过用转录抑制剂（如Actinomycin D）处理细胞并量化mRNA随时间的衰减来测量。如果获得了 $\\gamma$ 的值，它可以在MLE程序中被固定，然后可以相对于其余三个参数 $k_{\\text{on}}$、$k_{\\text{off}}$ 和 $k_{\\text{tx}}$ 最大化似然，这些参数随后可以通过关系式 $k_{\\text{on}} = a \\gamma$、$k_{\\text{off}} = b \\gamma$ 和 $k_{\\text{tx}} = \\beta \\gamma$ 唯一确定。\n- **时间序列数据：** 或者，随时间测量单个细胞中的mRNA计数（活细胞成像）提供了有关系统时间相关性的信息。mRNA自相关函数的衰减率与 $\\gamma$ 和 $k_{\\text{on}}+k_{\\text{off}}$ 相关。这个附加信息为绝对时间尺度提供了一个约束，从而允许通过对稳态分布和时间相关数据的联合拟合来唯一识别所有四个参数。",
            "answer": "$$ \\boxed{ L(k_{\\text{on}},k_{\\text{off}},k_{\\text{tx}},\\gamma \\,;\\, \\{n_{i}\\}_{i=1}^{M}) = \\prod_{i=1}^{M} \\left[ \\frac{(\\frac{k_{\\text{on}}}{\\gamma})_{n_i}}{(\\frac{k_{\\text{on}}+k_{\\text{off}}}{\\gamma})_{n_i}} \\frac{(\\frac{k_{\\text{tx}}}{\\gamma})^{n_i}}{n_i!} {}_1F_1\\left(\\frac{k_{\\text{on}}}{\\gamma}+n_i; \\frac{k_{\\text{on}}+k_{\\text{off}}}{\\gamma}+n_i; -\\frac{k_{\\text{tx}}}{\\gamma}\\right) \\right] } $$"
        }
    ]
}