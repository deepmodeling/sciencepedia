{
    "hands_on_practices": [
        {
            "introduction": "热力学模型是理解基因表达如何被转录因子定量调控的基石。本练习将指导您从统计力学的第一性原理出发，构建这样一个基础模型。通过推导一个由单一激活子调控的启动子的无量纲输入-输出函数，您将学习如何运用配分函数计算状态概率，并了解协同样、饱和等概念是如何从该框架中自然产生的 。",
            "id": "3908138",
            "problem": "一个启动子受单个转录激活子调控，该激活子的结合会增加核糖核酸（RNA）聚合酶（RNAP）加载的概率。假设启动子状态遵循以下准平衡热力学模型，该模型广泛用于转录调控的建模：\n\n- 启动子有$4$种互斥状态：空状态、仅激活子结合状态、仅RNAP结合状态以及激活子-RNAP共结合状态。\n- 激活子以大小为$n$的寡聚体形式结合到单个位点上，其解离常数为$K_d$，因此激活子占据的热力学权重与$(c/K_d)^{n}$成正比，其中$c$是游离激活子的浓度。\n- RNAP以一个有效的无量纲权重$p$结合，该权重结合了RNAP浓度及其与启动子的解离常数。\n- 当激活子和RNAP同时结合时，存在一个由无量纲协同因子$\\omega$参数化的稳定化相互作用，该因子乘以共结合状态的权重。\n- 只有当RNAP结合时才会发生转录，起始速率为$r$。信使RNA以一级速率$\\gamma$降解/稀释，得到稳态活性$f(c) = \\alpha \\, P_{\\mathrm{RNAP}}(c)$，其中$\\alpha = r/\\gamma$，而$P_{\\mathrm{RNAP}}(c)$是RNAP结合的概率。\n\n令$f_{\\max} \\equiv \\lim_{c \\to \\infty} f(c)$表示在饱和激活子浓度下的渐近最大活性。定义无量纲输入$x = c/K_d$和无量纲输出$y = f(c)/f_{\\max}$。\n\n从准平衡统计占据框架和激活子的质量作用结合出发，推导无量纲输入-输出函数$y(x)$的闭式表达式，该表达式仅用$x$、$n$、$p$和$\\omega$表示。在推导过程中，指明决定$y(x)$形状的关键独立无量纲群，并明确展示有量纲参数如何在$y(x)$中被抵消。\n\n将您的最终答案表示为$y(x)$的单一闭式表达式，用$x$、$n$、$p$和$\\omega$表示。不包含单位。无需四舍五入。",
            "solution": "问题陈述描述了一个标准的转录调控热力学模型，其科学上合理、表述清晰且客观。它包含了进行严谨推导所需的所有信息。因此，该问题是有效的。\n\n推导从统计力学原理应用于激活子和RNA聚合酶（RNAP）与启动子的准平衡结合开始。系统有四种互斥状态，启动子处于任何特定状态的概率与该状态的热力学权重成正比。\n\n让我们定义相对于空状态的四种启动子状态的统计权重$W$，空状态的权重被赋值为$1$。激活子的无量纲浓度为$x = c/K_d$。\n\n1.  **空状态（仅启动子）：** 无分子结合。\n    $$W_0 = 1$$\n2.  **激活子结合状态：** 激活子寡聚体已结合，但RNAP未结合。权重由$(c/K_d)^n$给出。\n    $$W_A = x^n$$\n3.  **RNAP结合状态：** RNAP已结合，但激活子未结合。权重由无量纲参数$p$给出。\n    $$W_P = p$$\n4.  **激活子-RNAP共结合状态：** 激活子和RNAP同时结合。权重是各单独结合权重的乘积，再乘以无量纲协同因子$\\omega$。\n    $$W_{AP} = W_A \\cdot W_P \\cdot \\omega = x^n \\cdot p \\cdot \\omega$$\n\n配分函数$Z(x)$是所有可能状态的统计权重之和。它作为计算概率的归一化常数。\n$$Z(x) = W_0 + W_A + W_P + W_{AP}$$\n$$Z(x) = 1 + x^n + p + p\\omega x^n$$\n我们可以按$x$的幂次合并各项：\n$$Z(x) = (1+p) + (1+p\\omega)x^n$$\n\n根据问题，只有当RNAP结合时才会发生转录。这对应于RNAP结合状态和共结合状态。RNAP结合的概率$P_{\\mathrm{RNAP}}(x)$是这两种状态的权重之和除以配分函数。\n$$P_{\\mathrm{RNAP}}(x) = \\frac{W_P + W_{AP}}{Z(x)} = \\frac{p + p\\omega x^n}{(1+p) + (1+p\\omega)x^n}$$\n这可以因式分解为：\n$$P_{\\mathrm{RNAP}}(x) = \\frac{p(1 + \\omega x^n)}{(1+p) + (1+p\\omega)x^n}$$\n\n稳态转录活性由$f(c) = \\alpha \\, P_{\\mathrm{RNAP}}(c)$给出，其中$\\alpha = r/\\gamma$。用无量纲输入$x$表示，即为$f(x) = \\alpha \\, P_{\\mathrm{RNAP}}(x)$。\n\n接下来，我们必须找到渐近最大活性$f_{\\max}$，它被定义为$f(c)$在$c \\to \\infty$时的极限。这等价于$f(x)$在$x \\to \\infty$时的极限。\n$$f_{\\max} = \\lim_{x \\to \\infty} f(x) = \\lim_{x \\to \\infty} \\left( \\alpha \\frac{p(1 + \\omega x^n)}{(1+p) + (1+p\\omega)x^n} \\right)$$\n为求此极限，我们将分子和分母同除以$x$的最高次幂$x^n$。\n$$f_{\\max} = \\alpha \\lim_{x \\to \\infty} \\frac{p(\\frac{1}{x^n} + \\omega)}{(\\frac{1+p}{x^n}) + (1+p\\omega)}$$\n当$x \\to \\infty$时，分母中含有$x^n$的项趋于$0$。\n$$f_{\\max} = \\alpha \\frac{p(0 + \\omega)}{0 + (1+p\\omega)} = \\alpha \\frac{p\\omega}{1+p\\omega}$$\n需要注意的是，如果$\\omega=0$或$p=0$，则$f_{\\max}=0$。对于$\\omega > 0$和$p>0$，该问题具有物理意义。\n\n最后一步是推导无量纲输入-输出函数$y(x) = f(x)/f_{\\max}$。\n$$y(x) = \\frac{f(x)}{f_{\\max}} = \\frac{\\alpha \\, P_{\\mathrm{RNAP}}(x)}{\\alpha \\frac{p\\omega}{1+p\\omega}}$$\n有量纲常数$\\alpha=r/\\gamma$被抵消，这表明归一化输出与转录和降解的绝对速率无关。\n$$y(x) = \\frac{\\frac{p(1 + \\omega x^n)}{(1+p) + (1+p\\omega)x^n}}{\\frac{p\\omega}{1+p\\omega}}$$\n假设$p > 0$，因子$p$也被抵消：\n$$y(x) = \\frac{1 + \\omega x^n}{(1+p) + (1+p\\omega)x^n} \\cdot \\frac{1+p\\omega}{\\omega}$$\n该表达式给出了用$x$、$n$、$p$和$\\omega$表示的$y(x)$。有量纲参数$c$和$K_d$包含在无量纲输入$x$中，所有其他有量纲参数（$r, \\gamma$）都已抵消。因此，输入-输出曲线的形状完全由无量纲群$n$、$p$和$\\omega$决定。\n\n通过代数重排，该表达式可以简化为以下更具洞察力的形式：\n$$y(x) = \\frac{x^n + \\frac{1}{\\omega}}{x^n + \\frac{1+p}{1+p\\omega}}$$\n这个表达式就是所求的输入-输出函数，仅用无量纲输入$x$和无量纲参数$n$、$p$和$\\omega$表示。",
            "answer": "$$\\boxed{\\frac{x^n + \\frac{1}{\\omega}}{x^n + \\frac{1+p}{1+p\\omega}}}$$"
        },
        {
            "introduction": "建立数学模型只是第一步，接下来是将其与实验数据联系起来。本练习将深入探讨参数估计这一关键任务，以及其中常见的“懒惰性”（sloppiness）挑战，即现有数据无法唯一确定所有模型参数。通过分析一个简单基因调控模型的成本函数曲率，您将学习如何识别哪些参数组合被良好约束（“刚性”方向），哪些则约束不佳（“懒惰”方向），这是设计信息丰富的实验所必需的关键技能 。",
            "id": "3908118",
            "problem": "一个转录因子以快速平衡动力学方式与一个启动子结合，启动子占有率可以很好地用平衡结合分数 $h(x) = \\frac{x}{K + x}$ 近似，其中 $x$ 是转录因子浓度，$K$ 是解离常数。一个受调控基因的稳态信使核糖核酸 (mRNA) 水平被建模为 $y(x; \\theta_0, \\theta_1) = \\theta_0 + \\theta_1 h(x)$，其中 $\\theta_0$ 是基础表达水平，$\\theta_1$ 是激活幅度。假设每次测量都存在标准差为 $\\sigma$ 的加性、独立、同分布的高斯测量噪声。\n\n您在三种转录因子浓度 $x_1 = 1$、$x_2 = 10$ 和 $x_3 = 100$ (单位与 $K$ 相同)下收集数据，已知解离常数 $K = 10$。设噪声标准差为 $\\sigma = 1$。考虑最小二乘目标函数 $J(\\theta_0, \\theta_1) = \\frac{1}{2\\sigma^2}\\sum_{i=1}^{3}\\left(y_i - y(x_i;\\theta_0,\\theta_1)\\right)^2$，并在最佳拟合参数 $(\\theta_0^{\\ast}, \\theta_1^{\\ast})$ 周圍对该目标函数进行线性化，以研究局部参数景观。\n\n从平衡结合的第一性原理和高斯噪声下最小二乘目标函数的定义出发，构建 $J$ 在 $(\\theta_0^{\\ast}, \\theta_1^{\\ast})$ 周围的基于灵敏度的二阶近似，推导出相关的 $2 \\times 2$ 对称矩阵（其特征值量化了参数空间中的局部刚度和松弛度），并计算其两个特征值。将最大特征值与最小特征值的比率作为一个实数报告。将您的答案四舍五入到四位有效数字。最终答案不带单位。",
            "solution": "用户希望分析一个转录调控模型的参数景观。这将通过计算最小二乘目标函数的Hessian矩阵的特征值来完成。\n\n### 步骤1：问题验证\n\n**提取的已知条件：**\n-   启动子占有率模型：$h(x) = \\frac{x}{K + x}$\n-   稳态mRNA水平模型：$y(x; \\theta_0, \\theta_1) = \\theta_0 + \\theta_1 h(x)$\n-   待估计参数：$\\theta_0$（基础表达），$\\theta_1$（激活幅度）\n-   数据点（转录因子浓度）：$x_1 = 1, x_2 = 10, x_3 = 100$\n-   解离常数：$K = 10$（与 $x$ 的单位相同）\n-   测量噪声：标准差为 $\\sigma = 1$ 的加性、独立、同分布高斯噪声\n-   最小二乘目标函数：$J(\\theta_0, \\theta_1) = \\frac{1}{2\\sigma^2}\\sum_{i=1}^{3}\\left(y_i - y(x_i;\\theta_0,\\theta_1)\\right)^2$\n-   任务：构建 $J$ 在最佳拟合参数 $(\\theta_0^{\\ast}, \\theta_1^{\\ast})$ 周围的二阶近似，找到相关的 $2 \\times 2$ 对称矩阵，计算其特征值，并报告最大与最小特征值的比率。\n\n**使用提取的已知条件进行验证：**\n1.  **科学基础：** 该问题描述了一个标准的Michaelis-Menten或Hill-Langmuir结合模型，用于转录因子-启动子相互作用，这是分子生物学和系统生物学中一个基本且广泛使用的概念。启动子占有率与转录速率之间的线性关系是一个常见的简化假设。在高斯噪声假设下使用最小二乘目标函数对应于最大似然估计，这是一种标准的统计方法。该问题在科学上是合理的。\n2.  **适定性：** 所有必要的常数（$K$、$\\sigma$）和数据点（$x_i$）都已提供。模型定义清晰。任务具体：计算成本函数的Hessian矩阵及其特征值比率。由于模型在其参数上是线性的，Hessian矩阵是良定义的并且是常数，确保了答案的唯一性。该问题是适定的。\n3.  **客观性：** 问题使用精确的数学和科学术语陈述，没有歧义或主观论断。\n\n**结论：** 问题有效。将提供完整解答。\n\n### 步骤2：推导与求解\n\n问题要求我们分析最小二乘目标函数 $J(\\theta_0, \\theta_1)$ 在最佳拟合参数 $(\\theta_0^{\\ast}, \\theta_1^{\\ast})$ 周围的局部曲率。该曲率由 $J$ 的Hessian矩阵描述。\n\n设参数向量为 $\\vec{\\theta} = \\begin{pmatrix} \\theta_0 \\\\ \\theta_1 \\end{pmatrix}$。模型由 $y(x_i; \\vec{\\theta}) = \\theta_0 + \\theta_1 h(x_i)$ 给出。\n目标函数为：\n$$ J(\\vec{\\theta}) = \\frac{1}{2\\sigma^2}\\sum_{i=1}^{3}\\left(y_i - y(x_i;\\vec{\\theta})\\right)^2 $$\n$J(\\vec{\\theta})$ 在最小值点 $\\vec{\\theta}^{\\ast}$ 周围的二阶泰勒展开为：\n$$ J(\\vec{\\theta}) \\approx J(\\vec{\\theta}^{\\ast}) + \\nabla J(\\vec{\\theta}^{\\ast})^T (\\vec{\\theta} - \\vec{\\theta}^{\\ast}) + \\frac{1}{2} (\\vec{\\theta} - \\vec{\\theta}^{\\ast})^T \\mathbf{H} (\\vec{\\theta} - \\vec{\\theta}^{\\ast}) $$\n其中 $\\mathbf{H}$ 是在 $\\vec{\\theta}^{\\ast}$ 处计算的Hessian矩阵。根据最小值的定义，梯度 $\\nabla J(\\vec{\\theta}^{\\ast})$ 为零。因此，局部景观由Hessian矩阵 $\\mathbf{H}$ 表征，其元素为 $H_{jk} = \\frac{\\partial^2 J}{\\partial \\theta_j \\partial \\theta_k}$。\n\n我们来计算Hessian矩阵的元素。一阶偏导数为：\n$$ \\frac{\\partial J}{\\partial \\theta_j} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{3} (y_i - y(x_i;\\vec{\\theta})) \\left(-\\frac{\\partial y(x_i;\\vec{\\theta})}{\\partial \\theta_j}\\right) $$\n二阶偏导数（Hessian矩阵元素）为：\n$$ H_{jk} = \\frac{\\partial^2 J}{\\partial \\theta_k \\partial \\theta_j} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{3} \\left[ \\frac{\\partial y(x_i;\\vec{\\theta})}{\\partial \\theta_k} \\frac{\\partial y(x_i;\\vec{\\theta})}{\\partial \\theta_j} - (y_i - y(x_i;\\vec{\\theta})) \\frac{\\partial^2 y(x_i;\\vec{\\theta})}{\\partial \\theta_k \\partial \\theta_j} \\right] $$\n模型 $y(x; \\theta_0, \\theta_1) = \\theta_0 + \\theta_1 h(x)$ 在参数 $\\theta_0$ 和 $\\theta_1$ 上是线性的。因此，模型对参数的所有二阶偏导数均为零：\n$$ \\frac{\\partial^2 y}{\\partial \\theta_j \\partial \\theta_k} = 0 \\quad \\forall j,k \\in \\{0,1\\} $$\n因此，Hessian矩阵简化为：\n$$ H_{jk} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{3} \\frac{\\partial y(x_i;\\vec{\\theta})}{\\partial \\theta_j} \\frac{\\partial y(x_i;\\vec{\\theta})}{\\partial \\theta_k} $$\n请注意，此表达式与测量数据 $y_i$ 和具体的最佳拟合参数 $\\vec{\\theta}^{\\ast}$ 无关。\n\n这可以用灵敏度矩阵 $\\mathbf{S}$ 来表示，其元素为 $S_{ij} = \\frac{\\partial y(x_i)}{\\partial \\theta_j}$。Hessian矩阵则为 $\\mathbf{H} = \\frac{1}{\\sigma^2} \\mathbf{S}^T \\mathbf{S}$。\n\n首先，我们计算模型函数关于参数的偏导数：\n$$ \\frac{\\partial y}{\\partial \\theta_0} = 1 $$\n$$ \\frac{\\partial y}{\\partial \\theta_1} = h(x) = \\frac{x}{K+x} $$\n接下来，我们使用给定的三个浓度 $x_1=1$、$x_2=10$、$x_3=100$ 和 $K=10$ 来计算函数 $h(x)$ 的值：\n$$ h(x_1) = h(1) = \\frac{1}{10+1} = \\frac{1}{11} $$\n$$ h(x_2) = h(10) = \\frac{10}{10+10} = \\frac{10}{20} = \\frac{1}{2} $$\n$$ h(x_3) = h(100) = \\frac{100}{10+100} = \\frac{100}{110} = \\frac{10}{11} $$\n对于数据点 $(x_1, x_2, x_3)$，灵敏度矩阵 $\\mathbf{S}$ 是一个 $3 \\times 2$ 的矩阵：\n$$ \\mathbf{S} = \\begin{pmatrix} \\frac{\\partial y(x_1)}{\\partial \\theta_0} & \\frac{\\partial y(x_1)}{\\partial \\theta_1} \\\\ \\frac{\\partial y(x_2)}{\\partial \\theta_0} & \\frac{\\partial y(x_2)}{\\partial \\theta_1} \\\\ \\frac{\\partial y(x_3)}{\\partial \\theta_0} & \\frac{\\partial y(x_3)}{\\partial \\theta_1} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{1}{11} \\\\ 1 & \\frac{1}{2} \\\\ 1 & \\frac{10}{11} \\end{pmatrix} $$\n现在我们可以计算矩阵 $\\mathbf{S}^T \\mathbf{S}$：\n$$ \\mathbf{S}^T \\mathbf{S} = \\begin{pmatrix} 1 & 1 & 1 \\\\ \\frac{1}{11} & \\frac{1}{2} & \\frac{10}{11} \\end{pmatrix} \\begin{pmatrix} 1 & \\frac{1}{11} \\\\ 1 & \\frac{1}{2} \\\\ 1 & \\frac{10}{11} \\end{pmatrix} $$\n所得到的 $2 \\times 2$ 矩阵的元素为：\n$$ (\\mathbf{S}^T \\mathbf{S})_{11} = 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 = 3 $$\n$$ (\\mathbf{S}^T \\mathbf{S})_{12} = (\\mathbf{S}^T \\mathbf{S})_{21} = 1 \\cdot \\frac{1}{11} + 1 \\cdot \\frac{1}{2} + 1 \\cdot \\frac{10}{11} = \\frac{1+10}{11} + \\frac{1}{2} = 1 + \\frac{1}{2} = \\frac{3}{2} $$\n$$ (\\mathbf{S}^T \\mathbf{S})_{22} = \\left(\\frac{1}{11}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{10}{11}\\right)^2 = \\frac{1}{121} + \\frac{1}{4} + \\frac{100}{121} = \\frac{101}{121} + \\frac{1}{4} = \\frac{404 + 121}{484} = \\frac{525}{484} $$\n给定 $\\sigma = 1$，Hessian矩阵为 $\\mathbf{H} = \\frac{1}{1^2} \\mathbf{S}^T \\mathbf{S} = \\mathbf{S}^T \\mathbf{S}$：\n$$ \\mathbf{H} = \\begin{pmatrix} 3 & \\frac{3}{2} \\\\ \\frac{3}{2} & \\frac{525}{484} \\end{pmatrix} $$\n这就是所求的 $2 \\times 2$ 对称矩阵。为了求其特征值 $\\lambda$，我们求解特征方程 $\\det(\\mathbf{H} - \\lambda\\mathbf{I}) = 0$：\n$$ \\det \\begin{pmatrix} 3 - \\lambda & \\frac{3}{2} \\\\ \\frac{3}{2} & \\frac{525}{484} - \\lambda \\end{pmatrix} = 0 $$\n$$ (3 - \\lambda)\\left(\\frac{525}{484} - \\lambda\\right) - \\left(\\frac{3}{2}\\right)^2 = 0 $$\n$$ \\lambda^2 - \\left(3 + \\frac{525}{484}\\right)\\lambda + \\left(3 \\cdot \\frac{525}{484} - \\frac{9}{4}\\right) = 0 $$\n对于一个通用的 $2 \\times 2$ 对称矩阵 $\\begin{pmatrix} a & b \\\\ b & d \\end{pmatrix}$，其特征值 $\\lambda_{1,2}$ 由公式 $\\lambda = \\frac{(a+d) \\pm \\sqrt{(a-d)^2 + 4b^2}}{2}$ 给出。\n这里，$a=3$，$b=3/2$，$d=525/484$。\n矩阵的迹为 $\\text{Tr}(\\mathbf{H}) = a+d = 3 + \\frac{525}{484} = \\frac{1452+525}{484} = \\frac{1977}{484}$。\n我们计算平方根下的项：\n$$ (a-d)^2 + 4b^2 = \\left(3 - \\frac{525}{484}\\right)^2 + 4\\left(\\frac{3}{2}\\right)^2 = \\left(\\frac{1452 - 525}{484}\\right)^2 + 9 $$\n$$ = \\left(\\frac{927}{484}\\right)^2 + 9 = \\frac{859329}{234256} + \\frac{9 \\cdot 234256}{234256} = \\frac{859329 + 2108304}{234256} = \\frac{2967633}{234256} $$\n特征值为：\n$$ \\lambda_{1,2} = \\frac{\\frac{1977}{484} \\pm \\sqrt{\\frac{2967633}{234256}}}{2} = \\frac{\\frac{1977}{484} \\pm \\frac{\\sqrt{2967633}}{484}}{2} = \\frac{1977 \\pm \\sqrt{2967633}}{968} $$\n最大特征值为 $\\lambda_{\\text{max}} = \\frac{1977 + \\sqrt{2967633}}{968}$，最小特征值为 $\\lambda_{\\text{min}} = \\frac{1977 - \\sqrt{2967633}}{968}$。\n最大特征值与最小特征值的比率为：\n$$ R = \\frac{\\lambda_{\\text{max}}}{\\lambda_{\\text{min}}} = \\frac{\\frac{1977 + \\sqrt{2967633}}{968}}{\\frac{1977 - \\sqrt{2967633}}{968}} = \\frac{1977 + \\sqrt{2967633}}{1977 - \\sqrt{2967633}} $$\n现在，我们计算其数值：\n$$ \\sqrt{2967633} \\approx 1722.682033 $$\n$$ R \\approx \\frac{1977 + 1722.682033}{1977 - 1722.682033} = \\frac{3699.682033}{254.317967} \\approx 14.5473708 $$\n将结果四舍五入到四位有效数字，得到 $14.55$。",
            "answer": "$$\\boxed{14.55}$$"
        },
        {
            "introduction": "基因表达本质上是一个随机过程，导致了显著的细胞间差异。为了理解这一点，我们需要从确定性模型转向随机框架，例如转录爆发的“电报模型”。这项高级练习将挑战您推导单个细胞中信使核糖核酸（mRNA）计数的稳态分布，并构建似然函数，这是利用单细胞快照数据推断启动子转换、转录和降解速率的统计学基础 。",
            "id": "3908091",
            "problem": "考虑一个均质细胞群中单个基因的二态启动子模型，其中启动子在非激活态和激活态之间切换。这些转换被建模为一个连续时间马尔可夫过程，具有以下生物化学速率：启动子以速率 $k_{\\text{on}}$ 从非激活态切换到激活态，并以速率 $k_{\\text{off}}$ 从激活态切换回非激活态。在激活状态下，该基因根据泊松过程以速率 $k_{\\text{tx}}$ 转录信使核糖核酸 (mRNA) 分子。每个 mRNA 分子遵循一级动力学，以速率 $\\gamma$ 独立降解。假设系统在恒定的环境条件下已达到稳态。\n\n您在稳态下从 $M$ 个独立细胞中收集了单细胞 mRNA 计数的快照；将观察到的计数表示为 $\\{n_{i}\\}_{i=1}^{M}$，其中 $n_{i} \\in \\{0,1,2,\\dots\\}$。\n\n仅从上述定义以及泊松过程、指数寿命、点过程的叠加与稀疏化的标准性质出发，完成以下任务：\n\n1. 将转录爆发建模为启动子激活的序列。推导细胞中总 mRNA 计数的稳态分布。以闭合形式表示您的结果，并指明其所属的分布族。确定该分布的参数，将其表示为 $k_{\\text{on}}$、$k_{\\text{off}}$、$k_{\\text{tx}}$ 和 $\\gamma$ 的函数。\n\n2. 使用推导出的稳态分布，为观察到的数据写出似然函数 $L(k_{\\text{on}},k_{\\text{off}},k_{\\text{tx}},\\gamma \\,;\\, n_{1},\\dots,n_{M})$，假设细胞间相互独立。\n\n3. 概述参数 $\\left(k_{\\text{on}},k_{\\text{off}},k_{\\text{tx}},\\gamma\\right)$ 的最大似然估计程序，包括 (i) 一个强制正性约束的清晰的重新参数化方法，(ii) 对数似然及其梯度的作用，(iii) 由该模型中的快照计数引起的任何可辨识性考量，以及 (iv) 一种有原则的方法来整合任何可以解决不可辨识性问题的外部测量。\n\n以 $k_{\\text{on}}$、$k_{\\text{off}}$、$k_{\\text{tx}}$、$\\gamma$ 和 $\\{n_{i}\\}_{i=1}^{M}$ 的形式，将最终的似然函数表示为单个解析表达式。不需要进行数值计算。",
            "solution": "用户希望我解决这个问题。\n用户希望我执行以下操作：\n1. 首先，我必须验证问题陈述。\n2. 如果问题有效，我将提供完整的解决方案。\n3. 如果问题无效，我将解释其缺陷并终止。\n\n我解决此问题的计划如下：\n1. 我将首先验证问题。我将逐字提取所有给定的信息。然后，我将检查问题是否科学上合理、适定且客观。基于此，我将给出一个结论。\n2. 如果问题有效，我将继续逐步解决它。\n   - 对于第 1 部分，我将推导 mRNA 计数的稳态分布。我将把该系统建模为一个调制泊松过程，其中泊松过程的速率（转录）本身是一个由启动子状态控制的随机变量。我将证明这会导致一个泊松-贝塔复合分布，并使用合流超几何函数推导其概率质量函数 (PMF) 的闭合形式。\n   - 对于第 2 部分，我将构造似然函数。由于细胞是独立的，总似然是每个观察到的 mRNA 计数的单个概率（在第 1 部分中推导的 PMF）的乘积。\n   - 对于第 3 部分，我将概述最大似然估计 (MLE) 程序。我将讨论为强制正性而进行的重新参数化、使用对数似然进行优化、参数可辨识性的关键问题以及解决该问题的方法。\n3. 最后，我将提供最终答案，即似然函数，其格式化为 `\\boxed` 环境中的单个解析表达式。\n\n我将确保所有数学实体都按要求以 LaTeX 格式表示。\n\n**问题验证**\n\n**步骤 1：提取给定信息**\n- 启动子状态：非激活态，激活态。\n- 模型：用于启动子状态转换的连续时间马尔可夫过程。\n- 从非激活态到激活态的转换速率：$k_{\\text{on}}$。\n- 从激活态到非激活态的转换速率：$k_{\\text{off}}$。\n- 转录过程：当启动子处于激活态时，为速率为 $k_{\\text{tx}}$ 的泊松过程。当处于非激活态时，速率为 $0$。\n- mRNA 降解：独立的、速率为 $\\gamma$ 的一级动力学过程。\n- 系统条件：稳态。\n- 数据：来自 $M$ 个独立细胞的单细胞 mRNA 计数的快照，表示为 $\\{n_{i}\\}_{i=1}^{M}$。\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学合理性：** 该问题描述了基因表达的“电报模型”，这是随机系统生物学中的一个基石和经典模型。其组成部分——用于启动子的二态马尔可夫链、用于转录的泊松过程以及用于降解的一级衰变——都是用于模拟这些生物化学现象的标准且成熟的原则。该模型在科学上是合理的，并在文献中被广泛使用。\n- **适定性：** 该问题为特定的随机模型提供了一套完整的定义和参数，并要求进行一系列标准推导：稳态分布、似然函数以及估计程序的分析。这些问题在数学上是精确的，并且基于模型的前提，有唯一、明确的解。\n- **客观性：** 问题以精确、正式且无偏见的数学和科学语言陈述。它不含主观性或个人观点。\n\n**步骤 3：结论与行动**\n该问题是有效的。它是生物医学系统建模领域中一个适定、科学合理且客观的问题。我现在将继续提供完整的解决方案。\n\n**解法**\n\n**1. mRNA 计数的稳态分布**\n\n在任何给定时间，细胞中 mRNA 分子的数量 $n$ 是转录和降解这两个随机过程的结果。转录速率不是恒定的，而是受启动子状态的调制，该状态在激活态（速率 $k_{\\text{tx}}$）和非激活态（速率 $0$）之间切换。每个 mRNA 分子一旦产生，其寿命独立且服从指数分布，均值为 $1/\\gamma$。\n\n在稳态下，mRNA 分子数 $n$ 等同于在观测时刻仍然“存活”的、来自一个调制泊松过程的到达数量。在时间 $t-\\tau$ 产生的 mRNA 分子存活到时间 $t$ 的概率为 $\\exp(-\\gamma \\tau)$。设 $S(t)$ 为启动子状态，激活时 $S(t)=1$，非激活时 $S(t)=0$。瞬时转录速率为 $k_{\\text{tx}}S(t)$。时间 $t$ 的 mRNA 计数 $n$ 可以描述为一个泊松随机变量，其参数 $\\Lambda(t)$ 是过去转录历史的积分，并由存活概率加权：\n$$ \\Lambda(t) = \\int_{0}^{\\infty} k_{\\text{tx}} S(t-\\tau) \\exp(-\\gamma \\tau) d\\tau $$\n由于系统处于稳态， $n$ 的分布是恒定的。我们可以通过找到随机变量 $\\Lambda$ 的分布来描述这个分布。令 $x = \\gamma \\int_{0}^{\\infty} S(t-\\tau) \\exp(-\\gamma \\tau) d\\tau$。这个变量 $x$ 是启动子状态历史的指数加权移动平均。$x$ 的随机微分方程是 $dx/dt = \\gamma(S(t) - x)$。这是一个由电报噪声 $S(t)$ 驱动的 Ornstein-Uhlenbeck 过程。\n\n对于一个具有切换速率 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 的二态马尔可夫过程 $S(t)$，过滤后的过程 $x(t)$ 的稳态分布是在区间 $[0, 1]$ 上的贝塔分布：\n$$ x \\sim \\text{Beta}(a, b) \\quad \\text{其概率密度函数 (PDF) 为} \\quad f(x|a, b) = \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)} $$\n这个贝塔分布的参数由动力学速率的比值给出：\n$$ a = \\frac{k_{\\text{on}}}{\\gamma} \\quad \\text{和} \\quad b = \\frac{k_{\\text{off}}}{\\gamma} $$\n因此，mRNA 计数 $n$ 是一个混合泊松变量，其中 $n \\sim \\text{Poisson}(\\lambda)$，速率参数 $\\lambda = \\frac{k_{\\text{tx}}}{\\gamma} x = \\beta x$，且 $\\beta = k_{\\text{tx}}/\\gamma$。$n$ 的最终分布是一个 **泊松-贝塔分布**。\n\n通过对 $x$ 的分布进行边缘化，可以得到概率质量函数 (PMF) $P(n)$：\n$$ P(n) = \\int_0^1 P(n|\\lambda=\\beta x) f(x|a,b) dx $$\n$$ P(n) = \\int_0^1 \\frac{(\\beta x)^n \\exp(-\\beta x)}{n!} \\frac{x^{a-1}(1-x)^{b-1}}{B(a,b)} dx $$\n其中 $B(a,b) = \\frac{\\Gamma(a)\\Gamma(b)}{\\Gamma(a+b)}$ 是贝塔函数。整理这些项，我们得到：\n$$ P(n) = \\frac{\\beta^n}{n! B(a,b)} \\int_0^1 x^{n+a-1} (1-x)^{b-1} \\exp(-\\beta x) dx $$\n该积分是第一类合流超几何函数 ${}_1F_1(u;v;z)$ 的一种表示，也称为 Kummer 函数。PMF 可以用闭合形式写为：\n$$ P(n) = \\frac{B(n+a, b)}{B(a,b)} \\frac{\\beta^n}{n!} {}_1F_1(n+a; n+a+b; -\\beta) $$\n使用 Pochhammer 符号的性质 $(q)_k = \\Gamma(q+k)/\\Gamma(q)$，这可以简化为：\n$$ P(n | a, b, \\beta) = \\frac{(a)_n}{(a+b)_n} \\frac{\\beta^n}{n!} {}_1F_1(a+n; a+b+n; -\\beta) $$\n其中参数是基础动力学速率的函数：\n- $a = k_{\\text{on}}/\\gamma$\n- $b = k_{\\text{off}}/\\gamma$\n- $\\beta = k_{\\text{tx}}/\\gamma$\n\n**2. 似然函数**\n\n观察到的数据由 $M$ 个独立的 mRNA 计数测量值 $\\{n_1, n_2, \\dots, n_M\\}$ 组成。模型参数 $\\theta = (k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma)$ 的似然函数 $L$ 是在给定参数条件下观察到每个计数的概率的乘积。\n$$ L(\\theta \\,;\\, \\{n_i\\}_{i=1}^M) = \\prod_{i=1}^M P(n_i | \\theta) $$\n代入上面推导的 PMF，并令 $a(\\theta) = k_{\\text{on}}/\\gamma$、$b(\\theta) = k_{\\text{off}}/\\gamma$ 和 $\\beta(\\theta) = k_{\\text{tx}}/\\gamma$：\n$$ L(k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma \\,;\\, \\{n_i\\}) = \\prod_{i=1}^M \\left[ \\frac{(a)_{n_i}}{(a+b)_{n_i}} \\frac{\\beta^{n_i}}{n_i!} {}_1F_1(a+n_i; a+b+n_i; -\\beta) \\right] $$\n这就是所求的似然函数。\n\n**3. 最大似然估计 (MLE) 程序**\n\nMLE 的目标是找到使似然函数 $L(\\theta)$ 最大化的参数值 $\\hat{\\theta}$。\n\n**(i) 重新参数化：**\n动力学速率 $k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma$ 必须严格为正。为了在数值优化过程中强制执行此约束，标准做法是对其进行重新参数化。一种常见的选择是指数变换：\n$$ k_{\\text{on}} = \\exp(\\kappa_{\\text{on}}), \\quad k_{\\text{off}} = \\exp(\\kappa_{\\text{off}}), \\quad k_{\\text{tx}} = \\exp(\\kappa_{\\text{tx}}), \\quad \\gamma = \\exp(\\kappa_{\\gamma}) $$\n然后对新参数 $\\kappa \\in \\mathbb{R}^4$ 进行优化，这是一个无约束问题，更适合标准的基于梯度的算法。\n\n**(ii) 对数似然和梯度：**\n最大化似然函数 $L$ 等价于最大化对数似然函数 $\\mathcal{L} = \\ln(L)$，后者在数值上更稳定，在分析上更方便。\n$$ \\mathcal{L}(\\theta \\,;\\, \\{n_i\\}) = \\sum_{i=1}^M \\ln P(n_i | \\theta) $$\n$$ \\mathcal{L} = \\sum_{i=1}^M \\left[ \\sum_{j=0}^{n_i-1}\\ln(a+j) - \\sum_{j=0}^{n_i-1}\\ln(a+b+j) + n_i\\ln(\\beta) - \\ln(n_i!) + \\ln({}_1F_1(a+n_i; a+b+n_i; -\\beta)) \\right] $$\nMLE 估计值 $\\hat{\\theta}$ 通过求解 $\\nabla_{\\kappa} \\mathcal{L}(\\kappa) = 0$ 得到。这通常需要使用数值优化方法（例如 L-BFGS、Nelder-Mead），这些方法使用对数似然函数相对于 $\\kappa$ 参数的梯度。梯度是使用链式法则计算的，例如 $\\frac{\\partial \\mathcal{L}}{\\partial \\kappa_j} = \\frac{\\partial \\mathcal{L}}{\\partial k_j} \\frac{\\partial k_j}{\\partial \\kappa_j} = \\frac{\\partial \\mathcal{L}}{\\partial k_j} k_j$。这需要计算对数伽马函数（双伽马函数）的导数和合流超几何函数的导数。\n\n**(iii) 可辨识性考量：**\n似然函数完全由三个无量纲量 $a=k_{\\text{on}}/\\gamma$、$b=k_{\\text{off}}/\\gamma$ 和 $\\beta=k_{\\text{tx}}/\\gamma$ 参数化。这意味着从稳态 mRNA 计数的单个快照中，只能辨识这三个比率。底层的四个动力学参数 $(k_{\\text{on}}, k_{\\text{off}}, k_{\\text{tx}}, \\gamma)$ 并非唯一可辨识。对于任何最优比率集 $(\\hat{a}, \\hat{b}, \\hat{\\beta})$，任何形式为 $(C\\hat{a}, C\\hat{b}, C\\hat{\\beta}, C)$（其中 $C>0$ 为任意常数）的参数集都会产生相同的似然值。这种模糊性反映了稳态分布不包含有关系统动力学绝对时间尺度的信息，该时间尺度由 $\\gamma$ 设定。\n\n**(iv) 解决不可辨识性问题：**\n为了唯一确定所有四个动力学速率，需要额外的实验信息来打破尺度模糊性。一个有原则的实现方法包括：\n- **独立测量一个速率：** 最常见的方法是独立测量其中一个速率。例如，可以通过用转录抑制剂（如 Actinomycin D）处理细胞，并随时间量化 mRNA 的衰变来测量 mRNA 降解速率 $\\gamma$。如果获得了 $\\gamma$ 的值，可以在 MLE 程序中将其固定，然后相对于其余三个参数 $k_{\\text{on}}$、$k_{\\text{off}}$ 和 $k_{\\text{tx}}$ 最大化似然函数，这三个参数随后可以通过关系式 $k_{\\text{on}} = a \\gamma$、$k_{\\text{off}} = b \\gamma$ 和 $k_{\\text{tx}} = \\beta \\gamma$ 变得唯一可辨识。\n- **时间序列数据：** 另外，随时间测量单细胞中的 mRNA 计数（活细胞成像）可以提供关于系统时间相关性的信息。mRNA 自相关函数的衰减率与 $\\gamma$ 和 $k_{\\text{on}}+k_{\\text{off}}$ 相关。这些额外信息为绝对时间尺度提供了约束，从而可以通过对稳态分布和时间相关数据的联合拟合来唯一辨识所有四个参数。",
            "answer": "$$ \\boxed{ L(k_{\\text{on}},k_{\\text{off}},k_{\\text{tx}},\\gamma \\,;\\, \\{n_{i}\\}_{i=1}^{M}) = \\prod_{i=1}^{M} \\left[ \\frac{(\\frac{k_{\\text{on}}}{\\gamma})_{n_i}}{(\\frac{k_{\\text{on}}+k_{\\text{off}}}{\\gamma})_{n_i}} \\frac{(\\frac{k_{\\text{tx}}}{\\gamma})^{n_i}}{n_i!} {}_1F_1\\left(\\frac{k_{\\text{on}}}{\\gamma}+n_i; \\frac{k_{\\text{on}}+k_{\\text{off}}}{\\gamma}+n_i; -\\frac{k_{\\text{tx}}}{\\gamma}\\right) \\right] } $$"
        }
    ]
}