{
    "hands_on_practices": [
        {
            "introduction": "任何生化网络建模的第一步都是将其反应机理转化为精确的数学结构。化学计量矩阵（$S$）是一个核心工具，它系统地捕捉了每条反应对每个物种浓度的影响。这项练习  将为一个核心的MAPK双重磷酸化模块构建此矩阵，为后续更复杂的动态与控制分析奠定基础。",
            "id": "3901989",
            "problem": "考虑一个嵌入在丝裂原活化蛋白激酶 (MAPK) 级联中的细胞外信号调节激酶 (ERK) 分布式、序贯双磷酸化模块。ERK 被激酶 MAPK/ERK 激酶 (MEK, 记作 $K$) 磷酸化，并被一种磷酸酶 (记作 $P$) 去磷酸化。假设存在以下物种：未磷酸化的 ERK $E$、单磷酸化的 ERK $E_{p}$、双磷酸化的 ERK $E_{pp}$、游离激酶 $K$、游离磷酸酶 $P$，以及四种酶-底物复合物：$C_{1}$ (对于 $K\\!:\\!E$)、$C_{2}$ (对于 $K\\!:\\!E_{p}$) 、$D_{1}$ (对于 $P\\!:\\!E_{pp}$) 和 $D_{2}$ (对于 $P\\!:\\!E_{p}$)。该反应机制包括每个复合物的可逆结合，随后是不可逆催化：\n- $K + E \\xrightleftharpoons[k_{1r}]{k_{1f}} C_{1}$, $C_{1} \\xrightarrow{k_{1c}} K + E_{p}$,\n- $K + E_{p} \\xrightleftharpoons[k_{2r}]{k_{2f}} C_{2}$, $C_{2} \\xrightarrow{k_{2c}} K + E_{pp}$,\n- $P + E_{pp} \\xrightleftharpoons[k_{3r}]{k_{3f}} D_{1}$, $D_{1} \\xrightarrow{k_{3c}} P + E_{p}$,\n- $P + E_{p} \\xrightleftharpoons[k_{4r}]{k_{4f}} D_{2}$, $D_{2} \\xrightarrow{k_{4c}} P + E$.\n\n对每个基元步骤采用质量作用动力学。按以下顺序定义物种浓度向量\n$$\\mathbf{x} = \\begin{pmatrix} E \\\\ E_{p} \\\\ E_{pp} \\\\ K \\\\ P \\\\ C_{1} \\\\ C_{2} \\\\ D_{1} \\\\ D_{2} \\end{pmatrix},$$\n和反应速率向量\n$$\\mathbf{v} = \\begin{pmatrix}\nv_{1} \\\\ v_{2} \\\\ v_{3} \\\\ v_{4} \\\\ v_{5} \\\\ v_{6} \\\\ v_{7} \\\\ v_{8} \\\\ v_{9} \\\\ v_{10} \\\\ v_{11} \\\\ v_{12}\n\\end{pmatrix},$$\n对应于十二个基元反应，其顺序为：按照上文列出的复合物序列，依次为正向结合反应、逆向结合反应和催化反应。\n\n任务:\n1. 构建该网络的化学计量矩阵 $\\mathbf{S} \\in \\mathbb{R}^{9 \\times 12}$，其列对应于有序的反应，行对应于 $\\mathbf{x}$ 中的有序物种。\n2. 用物种浓度和正常数速率常数 $k_{1f}, k_{1r}, k_{1c}, k_{2f}, k_{2r}, k_{2c}, k_{3f}, k_{3r}, k_{3c}, k_{4f}, k_{4r}, k_{4c}$ 表示质量作用反应速率 $v_{i}$。\n3. 以紧凑形式 $\\dot{\\mathbf{x}} = \\mathbf{S}\\,\\mathbf{v}(\\mathbf{x})$ 写出从反应到物种导数的常微分方程映射，并明确地将每个分量 $\\dot{x}_{i}$ 通过化学计量矩阵的元素表示为反应速率 $v_{j}$ 的线性组合。\n4. 确定化学计量矩阵 $\\mathbf{S}$ 的秩。将秩作为最终答案提交。无需四舍五入。",
            "solution": "描述双磷酸化模块的问题陈述是系统生物学中的一种标准表示。它具有科学依据、是适定的、客观且内容完整，定义了所有必需的物种、反应和参数。因此，该问题被认为是有效的。\n\n解决方案按所要求的四个任务展开。\n\n### 1. 化学计量矩阵 $\\mathbf{S}$ 的构建\n\n化学计量矩阵 $\\mathbf{S}$ 将反应速率与物种动态联系起来。其元素 $\\mathbf{S}_{ij}$ 表示由于反应 $j$ 的单次发生，物种 $i$ 的分子数量的净变化。该矩阵将有 $9$ 行，对应于物种 $\\mathbf{x} = (E, E_{p}, E_{pp}, K, P, C_{1}, C_{2}, D_{1}, D_{2})^T$，以及 $12$ 列，对应于 $\\mathbf{v}$ 中的有序反应。\n\n反应如下：\n$v_1: K + E \\xrightarrow{k_{1f}} C_{1}$\n$v_2: C_{1} \\xrightarrow{k_{1r}} K + E$\n$v_3: C_{1} \\xrightarrow{k_{1c}} K + E_{p}$\n$v_4: K + E_{p} \\xrightarrow{k_{2f}} C_{2}$\n$v_5: C_{2} \\xrightarrow{k_{2r}} K + E_{p}$\n$v_6: C_{2} \\xrightarrow{k_{2c}} K + E_{pp}$\n$v_7: P + E_{pp} \\xrightarrow{k_{3f}} D_{1}$\n$v_8: D_{1} \\xrightarrow{k_{3r}} P + E_{pp}$\n$v_9: D_{1} \\xrightarrow{k_{3c}} P + E_{p}$\n$v_{10}: P + E_{p} \\xrightarrow{k_{4f}} D_{2}$\n$v_{11}: D_{2} \\xrightarrow{k_{4r}} P + E_{p}$\n$v_{12}: D_{2} \\xrightarrow{k_{4c}} P + E$\n\n基于每种物种的净变化，逐列构建矩阵：\n$$\n\\mathbf{S} = \\begin{pmatrix}\n-1  & 1  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 1 \\\\\n0  & 0  & 1  & -1  & 1  & 0  & 0  & 0  & 1  & -1  & 1  & 0 \\\\\n0  & 0  & 0  & 0  & 0  & 1  & -1  & 1  & 0  & 0  & 0  & 0 \\\\\n-1  & 1  & 1  & -1  & 1  & 1  & 0  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 0  & 0  & -1  & 1  & 1  & -1  & 1  & 1 \\\\\n1  & -1  & -1  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 1  & -1  & -1  & 0  & 0  & 0  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 0  & 0  & 1  & -1  & -1  & 0  & 0  & 0 \\\\\n0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 0  & 1  & -1  & -1\n\\end{pmatrix}\n$$\n\n### 2. 质量作用反应速率 $\\mathbf{v}(\\mathbf{x})$\n\n根据质量作用定律，基元反应的速率与反应物浓度的乘积成正比。反应速率向量 $\\mathbf{v}$ 的分量为：\n$v_{1}(\\mathbf{x}) = k_{1f} [K] [E] = k_{1f} x_{4} x_{1}$\n$v_{2}(\\mathbf{x}) = k_{1r} [C_{1}] = k_{1r} x_{6}$\n$v_{3}(\\mathbf{x}) = k_{1c} [C_{1}] = k_{1c} x_{6}$\n$v_{4}(\\mathbf{x}) = k_{2f} [K] [E_{p}] = k_{2f} x_{4} x_{2}$\n$v_{5}(\\mathbf{x}) = k_{2r} [C_{2}] = k_{2r} x_{7}$\n$v_{6}(\\mathbf{x}) = k_{2c} [C_{2}] = k_{2c} x_{7}$\n$v_{7}(\\mathbf{x}) = k_{3f} [P] [E_{pp}] = k_{3f} x_{5} x_{3}$\n$v_{8}(\\mathbf{x}) = k_{3r} [D_{1}] = k_{3r} x_{8}$\n$v_{9}(\\mathbf{x}) = k_{3c} [D_{1}] = k_{3c} x_{8}$\n$v_{10}(\\mathbf{x}) = k_{4f} [P] [E_{p}] = k_{4f} x_{5} x_{2}$\n$v_{11}(\\mathbf{x}) = k_{4r} [D_{2}] = k_{4r} x_{9}$\n$v_{12}(\\mathbf{x}) = k_{4c} [D_{2}] = k_{4c} x_{9}$\n\n### 3. 常微分方程组\n\n物种浓度向量 $\\mathbf{x}$ 的时间演化由常微分方程组 (ODEs) $\\dot{\\mathbf{x}} = \\mathbf{S}\\,\\mathbf{v}(\\mathbf{x})$ 给出。每个分量 $\\dot{x}_{i}$ 是生成物种 $i$ 的反应速率之和减去消耗物种 $i$ 的反应速率之和。具体来说，这是 $\\mathbf{S}$ 的第 $i$ 行与向量 $\\mathbf{v}$ 的点积：\n\n$\\dot{x}_{1} = \\frac{d[E]}{dt} = -v_{1} + v_{2} + v_{12}$\n$\\dot{x}_{2} = \\frac{d[E_{p}]}{dt} = v_{3} - v_{4} + v_{5} + v_{9} - v_{10} + v_{11}$\n$\\dot{x}_{3} = \\frac{d[E_{pp}]}{dt} = v_{6} - v_{7} + v_{8}$\n$\\dot{x}_{4} = \\frac{d[K]}{dt} = -v_{1} + v_{2} + v_{3} - v_{4} + v_{5} + v_{6}$\n$\\dot{x}_{5} = \\frac{d[P]}{dt} = -v_{7} + v_{8} + v_{9} - v_{10} + v_{11} + v_{12}$\n$\\dot{x}_{6} = \\frac{d[C_{1}]}{dt} = v_{1} - v_{2} - v_{3}$\n$\\dot{x}_{7} = \\frac{d[C_{2}]}{dt} = v_{4} - v_{5} - v_{6}$\n$\\dot{x}_{8} = \\frac{d[D_{1}]}{dt} = v_{7} - v_{8} - v_{9}$\n$\\dot{x}_{9} = \\frac{d[D_{2}]}{dt} = v_{10} - v_{11} - v_{12}$\n\n### 4. 化学计量矩阵 $\\mathbf{S}$ 的秩\n\n化学计量矩阵的秩，$\\text{rank}(\\mathbf{S})$，决定了系统中线性无关的动态变量的数量。它可以通过确定线性无关的行或列的数量来找到。\n\n**行相关性分析 (守恒定律):**\n由于组分守恒定律，$\\mathbf{S}$ 的行不是线性无关的。和为零向量的行线性组合表示一个守恒量。\n设 $\\mathbf{r}_i$ 为 $\\mathbf{S}$ 的第 $i$ 行。\n\n1.  **总 ERK 守恒**：所有形式的底物 ERK 的总量是守恒的。\n    $[E]_{tot} = [E] + [E_p] + [E_{pp}] + [C_1] + [C_2] + [D_1] + [D_2] = x_1+x_2+x_3+x_6+x_7+x_8+x_9$.\n    该和的时间导数为零：$\\sum_{i \\in \\{1,2,3,6,7,8,9\\}} \\dot{x}_i = 0$。\n    这意味着行之间存在线性相关性：$\\mathbf{r}_1 + \\mathbf{r}_2 + \\mathbf{r}_3 + \\mathbf{r}_6 + \\mathbf{r}_7 + \\mathbf{r}_8 + \\mathbf{r}_9 = \\mathbf{0}$。\n\n2.  **总激酶守恒**：激酶 MEK 的总量是守恒的。\n    $[K]_{tot} = [K] + [C_1] + [C_2] = x_4+x_6+x_7$.\n    时间导数为零：$\\dot{x}_4 + \\dot{x}_6 + \\dot{x}_7 = 0$。\n    这意味着第二个行相关性：$\\mathbf{r}_4 + \\mathbf{r}_6 + \\mathbf{r}_7 = \\mathbf{0}$。\n\n3.  **总磷酸酶守恒**：磷酸酶的总量是守恒的。\n    $[P]_{tot} = [P] + [D_1] + [D_2] = x_5+x_8+x_9$.\n    时间导数为零：$\\dot{x}_5 + \\dot{x}_8 + \\dot{x}_9 = 0$。\n    这意味着第三个行相关性：$\\mathbf{r}_5 + \\mathbf{r}_8 + \\mathbf{r}_9 = \\mathbf{0}$。\n\n这三个守恒定律在 $\\mathbf{S}$ 的左零空间中产生了三个线性无关的向量。在 $9$ 个行中存在至少 $3$ 个线性相关性，意味着 $\\mathbf{S}$ 的秩至多为 $9 - 3 = 6$。\n\n**列相关性分析 (反应向量相关性):**\n$\\mathbf{S}$ 的列，记作 $\\mathbf{c}_j$，表示每个反应的净变化。列之间的线性相关性对应于反应路径之间的关系。$\\mathbf{S}$ 的零空间的维数为 $n - \\text{rank}(\\mathbf{S})$，其中 $n=12$ 是反应的数量。\n\n1.  **可逆反应**：每个正向结合反应及其逆反应形成一个相关对。\n    $\\mathbf{c}_2 = -\\mathbf{c}_1$ (来自 $K+E \\leftrightarrow C_1$)\n    $\\mathbf{c}_5 = -\\mathbf{c}_4$ (来自 $K+E_p \\leftrightarrow C_2$)\n    $\\mathbf{c}_8 = -\\mathbf{c}_7$ (来自 $P+E_{pp} \\leftrightarrow D_1$)\n    $\\mathbf{c}_{11} = -\\mathbf{c}_{10}$ (来自 $P+E_p \\leftrightarrow D_2$)\n    这四个相关性意味着 $\\text{dim}(\\text{N}(\\mathbf{S})) \\ge 4$。\n\n2.  **反应循环**：该网络包含无效循环，其中底物被磷酸化，然后又被去磷酸化回到其原始状态。\n    - 循环 $E \\to E_p \\to E$：结合了催化 ($C_1 \\to K+E_p$) 和解离 ($C_1 \\to K+E$)，即反应 $v_3$。净反应 $E \\to E_p$ 与去磷酸化 $E_p \\to E$ ($v_{12}$) 相耦合。反应 $v_1, v_3, v_{10}, v_{12}$ 的组合揭示了一个相关性。我们可以验证 $\\mathbf{c}_1 + \\mathbf{c}_3 + \\mathbf{c}_{10} + \\mathbf{c}_{12} = \\mathbf{0}$。\n    - 循环 $E_p \\to E_{pp} \\to E_p$：类似地，反应 $v_4, v_6, v_7, v_9$ 形成一个循环。我们可以验证 $\\mathbf{c}_4 + \\mathbf{c}_6 + \\mathbf{c}_7 + \\mathbf{c}_9 = \\mathbf{0}$。\n\n我们已经在 $\\mathbf{S}$ 的零空间中确定了 $6$ 个线性无关的向量：\n$\\mathbf{v}_1 = (1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)^T$\n$\\mathbf{v}_2 = (0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0)^T$\n$\\mathbf{v}_3 = (0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0)^T$\n$\\mathbf{v}_4 = (0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0)^T$\n$\\mathbf{v}_5 = (1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1)^T$\n$\\mathbf{v}_6 = (0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0)^T$\n这些向量的线性无关性证实了零空间的维数，$\\text{dim}(\\text{N}(\\mathbf{S}))$，至少为 $6$。\n因此，$\\text{rank}(\\mathbf{S}) = 12 - \\text{dim}(\\text{N}(\\mathbf{S})) \\le 12 - 6 = 6$。\n\n由于行分析和列分析都得出 $\\text{rank}(\\mathbf{S}) \\le 6$，且更详细的分析表明没有进一步的相关性，我们可以得出结论，秩恰好为 $6$。这意味着这 $9$ 个物种的动态可以用一个由 $6$ 个独立微分方程组成的系统来描述，其余 $3$ 个物种的浓度由守恒定律确定。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "建立模型结构后，下一步是分析其动态行为，尤其是系统如何响应扰动。信号通路通常会达到一个稳态，通过线性化并分析雅可比矩阵的特征值，我们可以判断该稳态的局部稳定性。这项练习  旨在通过一个简化的ERK模块，让学生掌握这一分析动态系统响应的关键技术。",
            "id": "3902035",
            "problem": "考虑一个丝裂原活化蛋白激酶 (MAPK) 级联的细胞外信号调节激酶 (ERK) 分支的简化模块，其中 ERK 经历由活化的 MAPK/ERK 激酶 (MEK) 催化的两个分布式、序贯的磷酸化步骤，以及由 MAPK 磷酸酶 (MKP) 催化的两个去磷酸化步骤。令 $x_{1}$、$x_{2}$ 和 $x_{3}$ 分别表示未磷酸化 ERK、单磷酸化 ERK 和双磷酸化 ERK 的浓度。假设由于活化的 MEK 和 MKP 浓度恒定，动力学为伪一级动力学，因此磷酸化和去磷酸化步骤对底物浓度呈线性关系，其有效速率常数分别为 $a_{1}$、$a_{2}$、$d_{1}$ 和 $d_{2}$。该状态根据以下常微分方程演化\n$$\n\\frac{d x_{1}}{d t} \\;=\\; -a_{1} x_{1} \\;+\\; d_{1} x_{2}, \\quad\n\\frac{d x_{2}}{d t} \\;=\\; a_{1} x_{1} \\;-\\; a_{2} x_{2} \\;-\\; d_{1} x_{2} \\;+\\; d_{2} x_{3}, \\quad\n\\frac{d x_{3}}{d t} \\;=\\; a_{2} x_{2} \\;-\\; d_{2} x_{3}.\n$$\n假设 ERK 总浓度守恒，$x_{1}(t) + x_{2}(t) + x_{3}(t) = E_{\\mathrm{tot}}$，其中 $E_{\\mathrm{tot}}$ 为一个正常数。对于参数值 $a_{1} = 0.5\\,\\mathrm{min}^{-1}$，$a_{2} = 0.3\\,\\mathrm{min}^{-1}$，$d_{1} = 0.4\\,\\mathrm{min}^{-1}$，$d_{2} = 0.2\\,\\mathrm{min}^{-1}$ 和 $E_{\\mathrm{tot}} = 1.0\\,\\mu\\mathrm{M}$：\n\n- 推导由上述动力学和守恒定律所蕴含的稳态 $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}, x_{3}^{\\ast})$。\n- 在 $x^{\\ast}$ 附近对动力学进行线性化，以获得变分形式 $\\dot{\\delta x} = J(x^{\\ast})\\,\\delta x$，其中 $J(x^{\\ast})$ 是在 $x^{\\ast}$ 处求值的雅可比矩阵。\n- 计算 $J(x^{\\ast})$ 的特征值，以评估小扰动的局部稳定性。\n\n将每个特征值四舍五入至四位有效数字，并以 $\\mathrm{min}^{-1}$ 为单位表示最终数值。按求得的顺序，以单行矩阵的形式提供特征值。",
            "solution": "用户希望我分析一个模拟丝裂原活化蛋白激酶 (MAPK) 级联一部分的常微分方程 (ODE) 系统。该分析包括三个部分：\n1.  推导不同形式 ERK 的稳态浓度。\n2.  在此稳态附近对系统动力学进行线性化，以求得雅可比矩阵。\n3.  计算雅可比矩阵的特征值，以评估稳态的稳定性。\n\n### 步骤 1：问题验证\n\n首先，我将验证问题陈述。\n给定信息如下：\n- 状态变量：$x_{1}$、$x_{2}$、$x_{3}$ 代表浓度。\n- 常微分方程组：\n$$\n\\frac{d x_{1}}{d t} = -a_{1} x_{1} + d_{1} x_{2} \\\\\n\\frac{d x_{2}}{d t} = a_{1} x_{1} - (a_{2} + d_{1}) x_{2} + d_{2} x_{3} \\\\\n\\frac{d x_{3}}{d t} = a_{2} x_{2} - d_{2} x_{3}\n$$\n- 守恒定律：$x_{1}(t) + x_{2}(t) + x_{3}(t) = E_{\\mathrm{tot}}$。\n- 参数值：$a_{1} = 0.5\\,\\mathrm{min}^{-1}$、$a_{2} = 0.3\\,\\mathrm{min}^{-1}$、$d_{1} = 0.4\\,\\mathrm{min}^{-1}$、$d_{2} = 0.2\\,\\mathrm{min}^{-1}$ 和 $E_{\\mathrm{tot}} = 1.0\\,\\mu\\mathrm{M}$。\n\n为了检查内部一致性，我将三个常微分方程相加：\n$$\n\\frac{d}{dt}(x_{1} + x_{2} + x_{3}) = (-a_{1} x_{1} + d_{1} x_{2}) + (a_{1} x_{1} - (a_{2} + d_{1}) x_{2} + d_{2} x_{3}) + (a_{2} x_{2} - d_{2} x_{3})\n$$\n$$\n\\frac{d}{dt}(x_{1} + x_{2} + x_{3}) = (-a_{1} + a_{1})x_{1} + (d_{1} - a_{2} - d_{1} + a_{2})x_{2} + (d_{2} - d_{2})x_{3} = 0\n$$\n这表明总浓度 $x_{1} + x_{2} + x_{3}$ 是一个运动常数，这与给定的守恒定律一致。该模型是在伪一级动力学假设下的三态酶促循环的标准表示，具有科学依据。问题是适定的、客观的，并为求得唯一解提供了所有必要信息。因此，该问题有效。\n\n### 步骤 2：求解推导\n\n#### a. 稳态分析\n在稳态时，浓度是恒定的，因此它们的时间导数为零。令稳态浓度为 $x_{1}^{\\ast}$、$x_{2}^{\\ast}$ 和 $x_{3}^{\\ast}$。常微分方程组变为一个线性代数方程组：\n$$\n0 = -a_{1} x_{1}^{\\ast} + d_{1} x_{2}^{\\ast} \\quad (1) \\\\\n0 = a_{1} x_{1}^{\\ast} - (a_{2} + d_{1}) x_{2}^{\\ast} + d_{2} x_{3}^{\\ast} \\quad (2) \\\\\n0 = a_{2} x_{2}^{\\ast} - d_{2} x_{3}^{\\ast} \\quad (3)\n$$\n这三个方程是线性相关的（将它们相加得到 $0=0$）。我们使用方程 $(1)$ 和 $(3)$ 以及守恒定律：\n$$\nx_{1}^{\\ast} + x_{2}^{\\ast} + x_{3}^{\\ast} = E_{\\mathrm{tot}} \\quad (4)\n$$\n从方程 $(1)$，我们将 $x_{1}^{\\ast}$ 用 $x_{2}^{\\ast}$ 表示：\n$$\nx_{1}^{\\ast} = \\frac{d_{1}}{a_{1}} x_{2}^{\\ast}\n$$\n从方程 $(3)$，我们将 $x_{3}^{\\ast}$ 用 $x_{2}^{\\ast}$ 表示：\n$$\nx_{3}^{\\ast} = \\frac{a_{2}}{d_{2}} x_{2}^{\\ast}\n$$\n将这些表达式代入守恒定律 $(4)$：\n$$\n\\frac{d_{1}}{a_{1}} x_{2}^{\\ast} + x_{2}^{\\ast} + \\frac{a_{2}}{d_{2}} x_{2}^{\\ast} = E_{\\mathrm{tot}}\n$$\n提取公因子 $x_{2}^{\\ast}$：\n$$\nx_{2}^{\\ast} \\left( \\frac{d_{1}}{a_{1}} + 1 + \\frac{a_{2}}{d_{2}} \\right) = E_{\\mathrm{tot}}\n$$\n求解 $x_{2}^{\\ast}$：\n$$\nx_{2}^{\\ast} = \\frac{E_{\\mathrm{tot}}}{\\frac{d_{1}}{a_{1}} + 1 + \\frac{a_{2}}{d_{2}}}\n$$\n现在，我们代入给定的参数值：$a_{1} = 0.5$、$a_{2} = 0.3$、$d_{1} = 0.4$、$d_{2} = 0.2$ 和 $E_{\\mathrm{tot}} = 1.0$。\n$$\nx_{2}^{\\ast} = \\frac{1.0}{\\frac{0.4}{0.5} + 1 + \\frac{0.3}{0.2}} = \\frac{1.0}{0.8 + 1 + 1.5} = \\frac{1.0}{3.3} = \\frac{10}{33}\n$$\n现在我们求解 $x_{1}^{\\ast}$ 和 $x_{3}^{\\ast}$：\n$$\nx_{1}^{\\ast} = \\frac{0.4}{0.5} x_{2}^{\\ast} = 0.8 \\left(\\frac{10}{33}\\right) = \\frac{8}{33}\n$$\n$$\nx_{3}^{\\ast} = \\frac{0.3}{0.2} x_{2}^{\\ast} = 1.5 \\left(\\frac{10}{33}\\right) = \\frac{15}{33}\n$$\n稳态向量为 $x^{\\ast} = (x_{1}^{\\ast}, x_{2}^{\\ast}, x_{3}^{\\ast}) = (\\frac{8}{33}, \\frac{10}{33}, \\frac{15}{33}) \\,\\mu\\mathrm{M}$。\n\n#### b. 线性化与雅可比矩阵\n系统可描述为 $\\dot{\\mathbf{x}} = \\mathbf{f}(\\mathbf{x})$，其中 $\\mathbf{x} = [x_1, x_2, x_3]^T$。雅可比矩阵 $J$ 的元素为 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$。由于给定的常微分方程组是线性的，雅可比矩阵是常数矩阵，不依赖于状态 $x$。\n向量函数 $\\mathbf{f}(\\mathbf{x})$ 为：\n$$\n\\mathbf{f}(\\mathbf{x}) = \\begin{pmatrix} -a_{1} x_{1} + d_{1} x_{2} \\\\ a_{1} x_{1} - (a_{2} + d_{1}) x_{2} + d_{2} x_{3} \\\\ a_{2} x_{2} - d_{2} x_{3} \\end{pmatrix}\n$$\n雅可比矩阵 $J = J(x^{\\ast})$ 为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1}  \\frac{\\partial f_1}{\\partial x_2}  \\frac{\\partial f_1}{\\partial x_3} \\\\ \\frac{\\partial f_2}{\\partial x_1}  \\frac{\\partial f_2}{\\partial x_2}  \\frac{\\partial f_2}{\\partial x_3} \\\\ \\frac{\\partial f_3}{\\partial x_1}  \\frac{\\partial f_3}{\\partial x_2}  \\frac{\\partial f_3}{\\partial x_3} \\end{pmatrix} = \\begin{pmatrix} -a_1  d_1  0 \\\\ a_1  -(a_2 + d_1)  d_2 \\\\ 0  a_2  -d_2 \\end{pmatrix}\n$$\n代入速率常数的数值：\n$$\nJ = \\begin{pmatrix} -0.5  0.4  0 \\\\ 0.5  -(0.3 + 0.4)  0.2 \\\\ 0  0.3  -0.2 \\end{pmatrix} = \\begin{pmatrix} -0.5  0.4  0 \\\\ 0.5  -0.7  0.2 \\\\ 0  0.3  -0.2 \\end{pmatrix}\n$$\n\n#### c. 特征值计算\n雅可比矩阵 $J$ 的特征值 $\\lambda$ 是特征方程 $\\det(J - \\lambda I) = 0$ 的根，其中 $I$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -0.5 - \\lambda  0.4  0 \\\\ 0.5  -0.7 - \\lambda  0.2 \\\\ 0  0.3  -0.2 - \\lambda \\end{pmatrix} = 0\n$$\n我们沿第一行展开行列式：\n$$\n(-0.5 - \\lambda) \\begin{vmatrix} -0.7 - \\lambda  0.2 \\\\ 0.3  -0.2 - \\lambda \\end{vmatrix} - 0.4 \\begin{vmatrix} 0.5  0.2 \\\\ 0  -0.2 - \\lambda \\end{vmatrix} = 0\n$$\n$$\n(-0.5 - \\lambda) [(-0.7 - \\lambda)(-0.2 - \\lambda) - (0.2)(0.3)] - 0.4 [0.5(-0.2 - \\lambda) - 0] = 0\n$$\n$$\n-(\\lambda + 0.5) [(\\lambda + 0.7)(\\lambda + 0.2) - 0.06] + 0.2\\lambda + 0.04 = 0\n$$\n$$\n-(\\lambda + 0.5) [\\lambda^2 + 0.9\\lambda + 0.14 - 0.06] + 0.2\\lambda + 0.04 = 0\n$$\n$$\n-(\\lambda + 0.5) [\\lambda^2 + 0.9\\lambda + 0.08] + 0.2\\lambda + 0.04 = 0\n$$\n$$\n-[\\lambda^3 + 0.9\\lambda^2 + 0.08\\lambda + 0.5\\lambda^2 + 0.45\\lambda + 0.04] + 0.2\\lambda + 0.04 = 0\n$$\n$$\n-[\\lambda^3 + 1.4\\lambda^2 + 0.53\\lambda + 0.04] + 0.2\\lambda + 0.04 = 0\n$$\n$$\n-\\lambda^3 - 1.4\\lambda^2 - 0.53\\lambda - 0.04 + 0.2\\lambda + 0.04 = 0\n$$\n$$\n-\\lambda^3 - 1.4\\lambda^2 - 0.33\\lambda = 0\n$$\n乘以 $-1$ 并提取公因子 $\\lambda$：\n$$\n\\lambda(\\lambda^2 + 1.4\\lambda + 0.33) = 0\n$$\n立即可以找到一个特征值为 $\\lambda_1 = 0$。这个特征值反映了总蛋白浓度的守恒；改变总浓度的扰动不会被恢复。动力学被约束在由 $x_1+x_2+x_3=E_{\\mathrm{tot}}$ 定义的平面上。\n\n另外两个特征值是二次方程 $\\lambda^2 + 1.4\\lambda + 0.33 = 0$ 的根。使用二次公式，$\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{-1.4 \\pm \\sqrt{(1.4)^2 - 4(1)(0.33)}}{2(1)}\n$$\n$$\n\\lambda = \\frac{-1.4 \\pm \\sqrt{1.96 - 1.32}}{2} = \\frac{-1.4 \\pm \\sqrt{0.64}}{2} = \\frac{-1.4 \\pm 0.8}{2}\n$$\n这给出了剩下的两个特征值：\n$$\n\\lambda_2 = \\frac{-1.4 + 0.8}{2} = \\frac{-0.6}{2} = -0.3\n$$\n$$\n\\lambda_3 = \\frac{-1.4 - 0.8}{2} = \\frac{-2.2}{2} = -1.1\n$$\n特征值为 $\\lambda_1 = 0$、$\\lambda_2 = -0.3$ 和 $\\lambda_3 = -1.1$。两个非零特征值均为负，这表明稳态 $x^{\\ast}$ 对于保持总浓度不变的扰动是局部稳定的。任何此类扰动都会随时间衰减。\n\n问题要求将每个特征值四舍五入到四位有效数字。\n- $\\lambda_1 = 0$ 写作 $0.0000$。\n- $\\lambda_2 = -0.3$ 写作 $-0.3000$。\n- $\\lambda_3 = -1.1$ 写作 $-1.100$。\n\n按求得的顺序，特征值为 $0.0000\\,\\mathrm{min}^{-1}$、$-0.3000\\,\\mathrm{min}^{-1}$ 和 $-1.100\\,\\mathrm{min}^{-1}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.0000  -0.3000  -1.100 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实的生物系统必须在内部参数波动的情况下维持其功能的稳定性，这一特性被称为鲁棒性。这项练习  将模型扩展到一个更完整的三层MAPK级联，并采用更符合实际的米氏动力学。它旨在通过计算实践，量化系统输出（$E_{pp}$的稳态浓度）对关键酶促反应参数变化的敏感性，从而评估系统的参数鲁棒性，这是系统生物学中的一个核心议题。",
            "id": "3902027",
            "problem": "您的任务是使用源自酶动力学的常微分方程来建立一个三层丝裂原活化蛋白激酶 (MAPK) 级联反应的模型，然后在所有层级磷酸化反应的米氏常数 ($K_m$) 和最大速率 ($V_{\\max}$) 同时变化的情况下，量化稳态双磷酸化细胞外信号调节激酶 (ERK) 物种（表示为 $E_{pp}$）的参数稳健性。该级联反应包括以下层级：Raf（第 $1$ 层）、丝裂原活化蛋白激酶激酶（MAPKK，第 $2$ 层）和丝裂原活化蛋白激酶（MAPK，第 $3$ 层）。Raf 经历单次磷酸化，MAPKK 和 MAPK 经历双次磷酸化。\n\n基本原理：使用酶动力学的准稳态公式，将磷酸化和去磷酸化的速率写成米氏-门顿函数形式。对于底物为 $S$ 的反应，其速率定律为 $v = \\dfrac{V_{\\max} S}{K_m + S}$，其中 $V_{\\max} = k_{\\text{cat}} E_{\\text{enzyme}}$，$K_m$ 是米氏常数。假设每一层都遵循总蛋白守恒。\n\n定义物种如下：\n- Raf：未磷酸化的 $K$ 和磷酸化的 $K_p$，总蛋白为 $K_{\\text{tot}}$，满足 $K + K_p = K_{\\text{tot}}$。\n- MAPKK：未磷酸化的 $M$、单磷酸化的 $M_p$、双磷酸化的 $M_{pp}$，总蛋白为 $M_{\\text{tot}}$，满足 $M + M_p + M_{pp} = M_{\\text{tot}}$。\n- MAPK (ERK)：未磷酸化的 $E$、单磷酸化的 $E_p$、双磷酸化的 $E_{pp}$，总蛋白为 $E_{\\text{tot}}$，满足 $E + E_p + E_{pp} = E_{\\text{tot}}$。\n\n磷酸化反应：\n- Raf 磷酸化 $K \\to K_p$ 由刺激物 $S$ 驱动，其中 $V_{\\max,K}^{\\text{phos}} = b \\, v_{K}^{S} \\, S$ 且 $K_{m,K}^{\\text{phos}} = a \\, K_{m,K}^{\\text{phos,base}}$。\n- MAPKK 磷酸化步骤 $M \\to M_p$ 和 $M_p \\to M_{pp}$ 由 $K_p$ 驱动，其中 $V_{\\max,M1}^{\\text{phos}} = b \\, k_{M1} \\, K_p$，$K_{m,M1}^{\\text{phos}} = a \\, K_{m,M1}^{\\text{phos,base}}$，以及 $V_{\\max,M2}^{\\text{phos}} = b \\, k_{M2} \\, K_p$，$K_{m,M2}^{\\text{phos}} = a \\, K_{m,M2}^{\\text{phos,base}}$。\n- MAPK (ERK) 磷酸化步骤 $E \\to E_p$ 和 $E_p \\to E_{pp}$ 由 $M_{pp}$ 驱动，其中 $V_{\\max,E1}^{\\text{phos}} = b \\, k_{E1} \\, M_{pp}$，$K_{m,E1}^{\\text{phos}} = a \\, K_{m,E1}^{\\text{phos,base}}$，以及 $V_{\\max,E2}^{\\text{phos}} = b \\, k_{E2} \\, M_{pp}$，$K_{m,E2}^{\\text{phos}} = a \\, K_{m,E2}^{\\text{phos,base}}$。\n\n去磷酸化反应（参数固定，仅对 $V_{\\max}$ 进行层级特异性缩放）：\n- Raf 去磷酸化 $K_p \\to K$，其中 $V_{\\max,K}^{\\text{deph}} = \\sigma_K \\, V_{\\max,K}^{\\text{deph,base}}$ 且 $K_{m,K}^{\\text{deph}}$ 固定。\n- MAPKK 去磷酸化 $M_p \\to M$ 和 $M_{pp} \\to M_p$，其中 $V_{\\max,M1}^{\\text{deph}} = \\sigma_M \\, V_{\\max,M1}^{\\text{deph,base}}$，$V_{\\max,M2}^{\\text{deph}} = \\sigma_M \\, V_{\\max,M2}^{\\text{deph,base}}$，且 $K_{m,M1}^{\\text{deph}}$、$K_{m,M2}^{\\text{deph}}$ 固定。\n- MAPK 去磷酸化 $E_p \\to E$ 和 $E_{pp} \\to E_p$，其中 $V_{\\max,E1}^{\\text{deph}} = \\sigma_E \\, V_{\\max,E1}^{\\text{deph,base}}$，$V_{\\max,E2}^{\\text{deph}} = \\sigma_E \\, V_{\\max,E2}^{\\text{deph,base}}$，且 $K_{m,E1}^{\\text{deph}}$、$K_{m,E2}^{\\text{deph}}$ 固定。\n\n编写以下关于时间 $t$（单位：秒）的常微分方程，用于描述动态变量 $K_p$、$M_p$、$M_{pp}$、$E_p$、$E_{pp}$：\n- $K = K_{\\text{tot}} - K_p$, $M = M_{\\text{tot}} - M_p - M_{pp}$, $E = E_{\\text{tot}} - E_p - E_{pp}$。\n- Raf:\n$$\\dfrac{dK_p}{dt} = \\dfrac{V_{\\max,K}^{\\text{phos}}\\,K}{K_{m,K}^{\\text{phos}}+K} - \\dfrac{V_{\\max,K}^{\\text{deph}}\\,K_p}{K_{m,K}^{\\text{deph}} + K_p}.$$\n- MAPKK:\n$$\\dfrac{dM_p}{dt} = \\dfrac{V_{\\max,M1}^{\\text{phos}}\\,M}{K_{m,M1}^{\\text{phos}}+M} - \\dfrac{V_{\\max,M2}^{\\text{phos}}\\,M_p}{K_{m,M2}^{\\text{phos}}+M_p} - \\dfrac{V_{\\max,M1}^{\\text{deph}}\\,M_p}{K_{m,M1}^{\\text{deph}}+M_p} + \\dfrac{V_{\\max,M2}^{\\text{deph}}\\,M_{pp}}{K_{m,M2}^{\\text{deph}}+M_{pp}},$$\n$$\\dfrac{dM_{pp}}{dt} = \\dfrac{V_{\\max,M2}^{\\text{phos}}\\,M_p}{K_{m,M2}^{\\text{phos}}+M_p} - \\dfrac{V_{\\max,M2}^{\\text{deph}}\\,M_{pp}}{K_{m,M2}^{\\text{deph}}+M_{pp}}.$$\n- MAPK (ERK):\n$$\\dfrac{dE_p}{dt} = \\dfrac{V_{\\max,E1}^{\\text{phos}}\\,E}{K_{m,E1}^{\\text{phos}}+E} - \\dfrac{V_{\\max,E2}^{\\text{phos}}\\,E_p}{K_{m,E2}^{\\text{phos}}+E_p} - \\dfrac{V_{\\max,E1}^{\\text{deph}}\\,E_p}{K_{m,E1}^{\\text{deph}}+E_p} + \\dfrac{V_{\\max,E2}^{\\text{deph}}\\,E_{pp}}{K_{m,E2}^{\\text{deph}}+E_{pp}},$$\n$$\\dfrac{dE_{pp}}{dt} = \\dfrac{V_{\\max,E2}^{\\text{phos}}\\,E_p}{K_{m,E2}^{\\text{phos}}+E_p} - \\dfrac{V_{\\max,E2}^{\\text{deph}}\\,E_{pp}}{K_{m,E2}^{\\text{deph}}+E_{pp}}.$$\n\n参数和单位：\n- 总量：$K_{\\text{tot}} = 0.5\\,\\mu\\mathrm{M}$，$M_{\\text{tot}} = 1.0\\,\\mu\\mathrm{M}$，$E_{\\text{tot}} = 2.0\\,\\mu\\mathrm{M}$。\n- 每单位刺激物的 Raf 磷酸化能力：$v_{K}^{S} = 0.5\\,\\mu\\mathrm{M}/\\mathrm{s}$。\n- 催化常数：$k_{M1} = 2.0\\,\\mathrm{s}^{-1}$，$k_{M2} = 1.5\\,\\mathrm{s}^{-1}$，$k_{E1} = 4.0\\,\\mathrm{s}^{-1}$，$k_{E2} = 3.0\\,\\mathrm{s}^{-1}$。\n- 磷酸化反应的基准米氏常数：$K_{m,K}^{\\text{phos,base}} = 0.05\\,\\mu\\mathrm{M}$，$K_{m,M1}^{\\text{phos,base}} = 0.10\\,\\mu\\mathrm{M}$，$K_{m,M2}^{\\text{phos,base}} = 0.10\\,\\mu\\mathrm{M}$，$K_{m,E1}^{\\text{phos,base}} = 0.20\\,\\mu\\mathrm{M}$，$K_{m,E2}^{\\text{phos,base}} = 0.20\\,\\mu\\mathrm{M}$。\n- 基准去磷酸化参数：$V_{\\max,K}^{\\text{deph,base}} = 0.30\\,\\mu\\mathrm{M}/\\mathrm{s}$，$K_{m,K}^{\\text{deph}} = 0.05\\,\\mu\\mathrm{M}$；$V_{\\max,M1}^{\\text{deph,base}} = 0.50\\,\\mu\\mathrm{M}/\\mathrm{s}$，$K_{m,M1}^{\\text{deph}} = 0.05\\,\\mu\\mathrm{M}$；$V_{\\max,M2}^{\\text{deph,base}} = 0.40\\,\\mu\\mathrm{M}/\\mathrm{s}$，$K_{m,M2}^{\\text{deph}} = 0.05\\,\\mu\\mathrm{M}$；$V_{\\max,E1}^{\\text{deph,base}} = 0.80\\,\\mu\\mathrm{M}/\\mathrm{s}$，$K_{m,E1}^{\\text{deph}} = 0.10\\,\\mu\\mathrm{M}$；$V_{\\max,E2}^{\\text{deph,base}} = 0.50\\,\\mu\\mathrm{M}/\\mathrm{s}$，$K_{m,E2}^{\\text{deph}} = 0.10\\,\\mu\\mathrm{M}$。\n- 各层级的去磷酸化缩放因子：无量纲的 $\\sigma_K$、$\\sigma_M$、$\\sigma_E$ 乘以相应的 $V_{\\max}^{\\text{deph,base}}$。\n\n参数变化和稳健性度量：\n- 定义同时变化因子 $a$（用于所有层级磷酸化反应的 $K_m$）和 $b$（用于所有层级磷酸化反应的 $V_{\\max}$）。考虑网格 $\\mathcal{G} = \\{a \\in \\{0.5, 1.0, 2.0\\}\\} \\times \\{b \\in \\{0.5, 1.0, 2.0\\}\\}$。\n- 对于固定的 $S$、$\\sigma_K$、$\\sigma_M$、$\\sigma_E$，令 $E_{pp}(a,b)$ 为通过对常微分方程进行积分直至达到稳态而获得的 $E_{pp}$ 的稳态值（单位为 $\\mu\\mathrm{M}$）。\n- 令 $E_{pp}^{0} = E_{pp}(1.0, 1.0)$ 为基准稳态值。\n- 定义最坏情况下的绝对偏差 $\\Delta_{\\max} = \\max_{(a,b)\\in \\mathcal{G}} \\left| E_{pp}(a,b) - E_{pp}^{0} \\right|$。\n- 定义无量纲的参数稳健性度量 $R = \\max\\left(0, 1 - \\dfrac{\\Delta_{\\max}}{E_{\\text{tot}}}\\right)$。\n\n数值要求：\n- 时间单位使用秒，浓度单位使用 $\\mu\\mathrm{M}$。在足够长的时间范围内对常微分方程进行数值积分以达到稳态，确保在给定参数下解趋于平稳。\n- 将最终报告的稳健性值 $R$ 表示为无量纲的小数。\n\n测试套件：\n提供以下三种情景的稳健性结果（每种情景构成一个测试用例）：\n- 情况 $1$（理想路径）：$S = 0.5$，$\\sigma_K = 1.0$，$\\sigma_M = 1.0$，$\\sigma_E = 1.0$。\n- 情况 $2$（边界低刺激，ERK 去磷酸化作用更强）：$S = 0.1$，$\\sigma_K = 1.0$，$\\sigma_M = 1.0$，$\\sigma_E = 1.2$。\n- 情况 $3$（高刺激，下游去磷酸化作用更弱）：$S = 1.0$，$\\sigma_K = 1.0$，$\\sigma_M = 0.8$，$\\sigma_E = 0.7$。\n\n程序输出规范：\n您的程序应生成单行输出，其中包含情况 1、情况 2 和情况 3 的稳健性结果，按此顺序排列，形式为方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是相应情况下计算出的稳健性 $R$ 值，以小数形式表示。",
            "solution": "我们的目标是通过在一个三层级联反应中同时改变磷酸化反应的米氏常数 $K_m$ 和最大速率 $V_{\\max}$，来量化稳态双磷酸化丝裂原活化蛋白激酶 (MAPK)（表示为 $E_{pp}$）的参数稳健性。该方法基于准稳态酶动力学和质量守恒。\n\n原理和模型构建：\n1) 酶动力学基础：对于单底物酶催化反应，准稳态近似法得出米氏-门顿速率定律 $v = \\dfrac{V_{\\max} S}{K_m + S}$，其中 $V_{\\max} = k_{\\text{cat}} E_{\\text{enzyme}}$ 是最大速率，$K_m$ 是米氏常数。该公式已经过实验验证，并广泛用于细胞内生化反应建模，其适用条件是酶-底物复合物的动力学相对于底物浓度变化要快得多。\n\n2) 级联结构和守恒：该级联反应涉及 Raf ($K$,$K_p$)、MAPKK ($M$,$M_p$,$M_{pp}$) 和 MAPK ($E$,$E_p$,$E_{pp}$)。总浓度守恒：$K + K_p = K_{\\text{tot}}$，$M + M_p + M_{pp} = M_{\\text{tot}}$，$E + E_p + E_{pp} = E_{\\text{tot}}$。守恒定律通过用动态状态变量表示未磷酸化池来降低维度：$K = K_{\\text{tot}} - K_p$，$M = M_{\\text{tot}} - M_p - M_{pp}$，$E = E_{\\text{tot}} - E_p - E_{pp}$。\n\n3) 耦合的磷酸化-去磷酸化通量：\n- Raf 磷酸化 $K \\to K_p$ 由刺激物 $S$ 驱动，得到 $V_{\\max,K}^{\\text{phos}} = b \\, v_{K}^{S} \\, S$ 和 $K_{m,K}^{\\text{phos}} = a \\, K_{m,K}^{\\text{phos,base}}$。Raf 去磷酸化 $K_p \\to K$ 使用固定的 $K_{m,K}^{\\text{deph}}$ 和缩放的 $V_{\\max,K}^{\\text{deph}} = \\sigma_K \\, V_{\\max,K}^{\\text{deph,base}}$。\n- MAPKK 磷酸化步骤 $M \\to M_p$ 和 $M_p \\to M_{pp}$ 由 $K_p$ 催化。因此 $V_{\\max,M1}^{\\text{phos}} = b \\, k_{M1} \\, K_p$，$V_{\\max,M2}^{\\text{phos}} = b \\, k_{M2} \\, K_p$，其中 $K_{m,M1}^{\\text{phos}} = a \\, K_{m,M1}^{\\text{phos,base}}$，$K_{m,M2}^{\\text{phos}} = a \\, K_{m,M2}^{\\text{phos,base}}$。去磷酸化反应 $M_p \\to M$ 和 $M_{pp} \\to M_p$ 具有固定的 $K_m$ 和通过 $\\sigma_M$ 缩放的 $V_{\\max}$。\n- MAPK 磷酸化步骤 $E \\to E_p$ 和 $E_p \\to E_{pp}$ 由 $M_{pp}$ 催化，其中 $V_{\\max,E1}^{\\text{phos}} = b \\, k_{E1} \\, M_{pp}$，$V_{\\max,E2}^{\\text{phos}} = b \\, k_{E2} \\, M_{pp}$，以及 $K_{m,E1}^{\\text{phos}} = a \\, K_{m,E1}^{\\text{phos,base}}$，$K_{m,E2}^{\\text{phos}} = a \\, K_{m,E2}^{\\text{phos,base}}$。去磷酸化反应 $E_p \\to E$ 和 $E_{pp} \\to E_p$ 具有固定的 $K_m$ 和通过 $\\sigma_E$ 缩放的 $V_{\\max}$。\n\n4) 微分方程：结合以上内容，我们推导出以下系统：\n- 对于 Raf：\n$$\\dfrac{dK_p}{dt} = \\dfrac{(b \\, v_{K}^{S} \\, S)\\,(K_{\\text{tot}} - K_p)}{a \\, K_{m,K}^{\\text{phos,base}} + (K_{\\text{tot}} - K_p)} - \\dfrac{(\\sigma_K \\, V_{\\max,K}^{\\text{deph,base}})\\,K_p}{K_{m,K}^{\\text{deph}} + K_p}.$$\n- 对于 MAPKK：\n$$\\dfrac{dM_p}{dt} = \\dfrac{(b \\, k_{M1} \\, K_p)\\,(M_{\\text{tot}} - M_p - M_{pp})}{a \\, K_{m,M1}^{\\text{phos,base}} + (M_{\\text{tot}} - M_p - M_{pp})} - \\dfrac{(b \\, k_{M2} \\, K_p)\\,M_p}{a \\, K_{m,M2}^{\\text{phos,base}} + M_p} - \\dfrac{(\\sigma_M \\, V_{\\max,M1}^{\\text{deph,base}})\\,M_p}{K_{m,M1}^{\\text{deph}} + M_p} + \\dfrac{(\\sigma_M \\, V_{\\max,M2}^{\\text{deph,base}})\\,M_{pp}}{K_{m,M2}^{\\text{deph}} + M_{pp}},$$\n$$\\dfrac{dM_{pp}}{dt} = \\dfrac{(b \\, k_{M2} \\, K_p)\\,M_p}{a \\, K_{m,M2}^{\\text{phos,base}} + M_p} - \\dfrac{(\\sigma_M \\, V_{\\max,M2}^{\\text{deph,base}})\\,M_{pp}}{K_{m,M2}^{\\text{deph}} + M_{pp}}.$$\n- 对于 MAPK (ERK)：\n$$\\dfrac{dE_p}{dt} = \\dfrac{(b \\, k_{E1} \\, M_{pp})\\,(E_{\\text{tot}} - E_p - E_{pp})}{a \\, K_{m,E1}^{\\text{phos,base}} + (E_{\\text{tot}} - E_p - E_{pp})} - \\dfrac{(b \\, k_{E2} \\, M_{pp})\\,E_p}{a \\, K_{m,E2}^{\\text{phos,base}} + E_p} - \\dfrac{(\\sigma_E \\, V_{\\max,E1}^{\\text{deph,base}})\\,E_p}{K_{m,E1}^{\\text{deph}} + E_p} + \\dfrac{(\\sigma_E \\, V_{\\max,E2}^{\\text{deph,base}})\\,E_{pp}}{K_{m,E2}^{\\text{deph}} + E_{pp}},$$\n$$\\dfrac{dE_{pp}}{dt} = \\dfrac{(b \\, k_{E2} \\, M_{pp})\\,E_p}{a \\, K_{m,E2}^{\\text{phos,base}} + E_p} - \\dfrac{(\\sigma_E \\, V_{\\max,E2}^{\\text{deph,base}})\\,E_{pp}}{K_{m,E2}^{\\text{deph}} + E_{pp}}.$$\n\n5) 稳态和稳健性：对于固定的 $S$、$\\sigma_K$、$\\sigma_M$、$\\sigma_E$，稳态值 $E_{pp}(a,b)$ 是通过在足够长的时间范围内对常微分方程进行积分，直到时间导数变得可以忽略不计而获得的（此处，使用具有严格公差的固定时间范围来近似稳态）。将基准值 $E_{pp}^{0} = E_{pp}(1.0, 1.0)$ 与网格 $\\{0.5, 1.0, 2.0\\} \\times \\{0.5, 1.0, 2.0\\}$ 中的 $(a,b)$ 所对应的集合 $\\{E_{pp}(a,b)\\}$ 进行比较，以计算最坏情况下的偏差 $\\Delta_{\\max} = \\max |E_{pp}(a,b) - E_{pp}^{0}|$。稳健性度量 $R = \\max\\left(0, 1 - \\dfrac{\\Delta_{\\max}}{E_{\\text{tot}}}\\right)$ 量化了在参数变化下保留的总 ERK 池的比例（当偏差超过总池时，截断为 0 以避免负稳健性）。\n\n算法设计：\n- 初始化所有物种为未磷酸化状态：$K_p(0) = 0$，$M_p(0) = 0$，$M_{pp}(0) = 0$，$E_p(0) = 0$，$E_{pp}(0) = 0$。\n- 对于每个测试用例 $(S, \\sigma_K, \\sigma_M, \\sigma_E)$：\n  - 通过在 $a = 1.0, b = 1.0$ 的条件下积分常微分方程来计算 $E_{pp}^{0}$。\n  - 对于指定网格中的每个 $(a,b)$，积分常微分方程并记录 $E_{pp}(a,b)$。\n  - 计算 $\\Delta_{\\max}$，然后按上述定义计算 $R$。\n- 数值积分使用具有严格公差的刚性求解器来确保接近稳态；物种守恒和正通量公式促进了物理真实性。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Constants and base parameters (units indicated in comments)\nK_tot = 0.5  # uM\nM_tot = 1.0  # uM\nE_tot = 2.0  # uM\n\n# Stimulus-dependent Raf phosphorylation capacity per unit stimulus (uM/s per unit S)\nvK_per_S = 0.5  # uM/s\n\n# Catalytic rate constants (1/s)\nkM1 = 2.0\nkM2 = 1.5\nkE1 = 4.0\nkE2 = 3.0\n\n# Baseline Km for phosphorylation (uM)\nKmK_phos_base = 0.05\nKmM1_phos_base = 0.10\nKmM2_phos_base = 0.10\nKmE1_phos_base = 0.20\nKmE2_phos_base = 0.20\n\n# Baseline dephosphorylation Vmax (uM/s)\nVmaxK_deph_base = 0.30\nVmaxM1_deph_base = 0.50\nVmaxM2_deph_base = 0.40\nVmaxE1_deph_base = 0.80\nVmaxE2_deph_base = 0.50\n\n# Dephosphorylation Km (fixed, uM)\nKmK_deph = 0.05\nKmM1_deph = 0.05\nKmM2_deph = 0.05\nKmE1_deph = 0.10\nKmE2_deph = 0.10\n\n# Integration settings\nT_end = 2000.0  # seconds\nrtol = 1e-9\natol = 1e-12\n\n# Variation grid for a (Km scaling) and b (Vmax scaling for phosphorylation)\na_values = [0.5, 1.0, 2.0]\nb_values = [0.5, 1.0, 2.0]\n\ndef positive(x):\n    # Ensure non-negative concentrations for numerical stability\n    return 0.0 if x < 0.0 else x\n\ndef odes(t, y, params):\n    \"\"\"\n    y = [K_p, M_p, M_pp, E_p, E_pp]\n    params = dict containing S, sigma_K, sigma_M, sigma_E, a, b\n    \"\"\"\n    K_p, M_p, M_pp, E_p, E_pp = y\n    # Conserved species\n    K = positive(K_tot - K_p)\n    M = positive(M_tot - M_p - M_pp)\n    E = positive(E_tot - E_p - E_pp)\n\n    S = params['S']\n    sigma_K = params['sigma_K']\n    sigma_M = params['sigma_M']\n    sigma_E = params['sigma_E']\n    a = params['a']\n    b = params['b']\n\n    # Raf phosphorylation/dephosphorylation\n    VmaxK_phos = b * vK_per_S * S  # uM/s\n    KmK_phos = a * KmK_phos_base\n    vK_phos = VmaxK_phos * K / (KmK_phos + K) if (KmK_phos + K) > 0 else 0.0\n\n    VmaxK_deph = sigma_K * VmaxK_deph_base\n    vK_deph = VmaxK_deph * K_p / (KmK_deph + K_p) if (KmK_deph + K_p) > 0 else 0.0\n\n    dK_p = vK_phos - vK_deph\n\n    # MAPKK phosphorylation/dephosphorylation\n    VmaxM1_phos = b * kM1 * positive(K_p)  # uM/s\n    KmM1_phos = a * KmM1_phos_base\n    vM1_phos = VmaxM1_phos * M / (KmM1_phos + M) if (KmM1_phos + M) > 0 else 0.0\n\n    VmaxM2_phos = b * kM2 * positive(K_p)  # uM/s\n    KmM2_phos = a * KmM2_phos_base\n    vM2_phos = VmaxM2_phos * M_p / (KmM2_phos + M_p) if (KmM2_phos + M_p) > 0 else 0.0\n\n    VmaxM1_deph = sigma_M * VmaxM1_deph_base\n    wM1_deph = VmaxM1_deph * M_p / (KmM1_deph + M_p) if (KmM1_deph + M_p) > 0 else 0.0\n\n    VmaxM2_deph = sigma_M * VmaxM2_deph_base\n    wM2_deph = VmaxM2_deph * M_pp / (KmM2_deph + M_pp) if (KmM2_deph + M_pp) > 0 else 0.0\n\n    dM_p = vM1_phos - vM2_phos - wM1_deph + wM2_deph\n    dM_pp = vM2_phos - wM2_deph\n\n    # MAPK (ERK) phosphorylation/dephosphorylation\n    VmaxE1_phos = b * kE1 * positive(M_pp)  # uM/s\n    KmE1_phos = a * KmE1_phos_base\n    vE1_phos = VmaxE1_phos * E / (KmE1_phos + E) if (KmE1_phos + E) > 0 else 0.0\n\n    VmaxE2_phos = b * kE2 * positive(M_pp)  # uM/s\n    KmE2_phos = a * KmE2_phos_base\n    vE2_phos = VmaxE2_phos * E_p / (KmE2_phos + E_p) if (KmE2_phos + E_p) > 0 else 0.0\n\n    VmaxE1_deph = sigma_E * VmaxE1_deph_base\n    wE1_deph = VmaxE1_deph * E_p / (KmE1_deph + E_p) if (KmE1_deph + E_p) > 0 else 0.0\n\n    VmaxE2_deph = sigma_E * VmaxE2_deph_base\n    wE2_deph = VmaxE2_deph * E_pp / (KmE2_deph + E_pp) if (KmE2_deph + E_pp) > 0 else 0.0\n\n    dE_p = vE1_phos - vE2_phos - wE1_deph + wE2_deph\n    dE_pp = vE2_phos - wE2_deph\n\n    return [dK_p, dM_p, dM_pp, dE_p, dE_pp]\n\ndef integrate_to_steady(S, sigma_K, sigma_M, sigma_E, a, b):\n    # Initial conditions: all unphosphorylated\n    y0 = [0.0, 0.0, 0.0, 0.0, 0.0]\n    params = {'S': S, 'sigma_K': sigma_K, 'sigma_M': sigma_M, 'sigma_E': sigma_E, 'a': a, 'b': b}\n    # Integrate ODEs\n    sol = solve_ivp(\n        fun=lambda t, y: odes(t, y, params),\n        t_span=(0.0, T_end),\n        y0=y0,\n        method='BDF',\n        rtol=rtol,\n        atol=atol,\n        dense_output=False,\n        max_step=10.0\n    )\n    # Extract final E_pp\n    E_pp = sol.y[4, -1]\n    # Clip small negative numerical artifacts\n    if E_pp < 0.0:\n        E_pp = 0.0\n    return E_pp\n\ndef robustness_for_case(S, sigma_K, sigma_M, sigma_E):\n    # Baseline E_pp at a=1.0, b=1.0\n    Epp0 = integrate_to_steady(S, sigma_K, sigma_M, sigma_E, a=1.0, b=1.0)\n    # Evaluate deviations over the grid\n    delta_max = 0.0\n    for a in a_values:\n        for b in b_values:\n            Epp_ab = integrate_to_steady(S, sigma_K, sigma_M, sigma_E, a=a, b=b)\n            delta = abs(Epp_ab - Epp0)\n            if delta > delta_max:\n                delta_max = delta\n    # Robustness metric\n    R = max(0.0, 1.0 - (delta_max / E_tot))\n    return R\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: S=0.5, sigma_K=1.0, sigma_M=1.0, sigma_E=1.0\n        (0.5, 1.0, 1.0, 1.0),\n        # Case 2: S=0.1, sigma_K=1.0, sigma_M=1.0, sigma_E=1.2\n        (0.1, 1.0, 1.0, 1.2),\n        # Case 3: S=1.0, sigma_K=1.0, sigma_M=0.8, sigma_E=0.7\n        (1.0, 1.0, 0.8, 0.7),\n    ]\n\n    results = []\n    for (S, sigma_K, sigma_M, sigma_E) in test_cases:\n        R = robustness_for_case(S, sigma_K, sigma_M, sigma_E)\n        # For stable display, round moderately (not required, but ensures compact output)\n        results.append(float(f\"{R:.6f}\"))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```",
            "answer": "[0.915729,0.992683,0.932971]"
        }
    ]
}