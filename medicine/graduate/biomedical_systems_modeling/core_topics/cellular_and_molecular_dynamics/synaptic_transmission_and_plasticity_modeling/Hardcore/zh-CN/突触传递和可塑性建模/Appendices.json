{
    "hands_on_practices": [
        {
            "introduction": "突触传递的建模始于突触前末梢，这是神经递质释放的核心环节。本练习  深入探讨了神经递质释放的生物物理核心，将动作电位引发的短暂钙离子（$Ca^{2+}$）内流与突触囊泡的随机融合过程联系起来。通过从第一性原理出发进行推导，你将掌握如何将突触前活动量化为化学信号释放的期望值，这是理解突触传递效率的基础。",
            "id": "3933929",
            "problem": "在 $t=0$ 时，一个动作电位 (AP) 到达前瞬间，单个突触前末梢包含 $M$ 个锚定的突触囊泡。囊泡融合动力学被建模为一个两态马尔可夫过程，其中每个锚定的囊泡以一个随时间变化的速率 $k_{pf}(t)$ 转换到融合状态，该速率取决于细胞内游离钙离子浓度 $[\\mathrm{Ca}^{2+}](t)$。假设以下科学上标准且得到广泛支持的前提：\n\n- 囊泡融合过程是无记忆性的，并由介观化学动力学控制：单个锚定囊泡的瞬时融合风险率为 $k_{pf}(t)$，一旦融合，在观测窗口内不能再次融合。\n- 在观测窗口内，囊泡各自独立作用，其融合动力学互不影响。\n- 动作电位引起一个钙瞬变，该瞬变叠加在基础钙水平之上。具体来说，对于 $t \\ge 0$，钙离子浓度遵循 $[\\mathrm{Ca}^{2+}](t) = C_{b} + \\Delta C \\exp(-t/\\tau_{c})$，其中 $C_{b}  0$ 是基础钙离子浓度，$\\Delta C  0$ 是 $t=0$ 时动作电位引起的钙增量，$\\tau_{c}  0$ 是钙衰减时间常数。\n- 融合速率是一个不依赖于钙的基础项和一个依赖于钙的协同项之和：$k_{pf}(t) = k_{b} + k_{c}\\,[\\mathrm{Ca}^{2+}](t)^{m}$，其中 $k_{b} \\ge 0$ 和 $k_{c} \\ge 0$ 是速率常数，$m \\in \\mathbb{N}$ 是钙协同性（类希尔）指数。\n- 每次脉冲（动作电位）释放的测量窗口是有限区间 $[0, T]$，其中 $T  0$。\n\n所有参数均为正的常数，且单位一致：$k_{b}$ 的单位是 $\\mathrm{s}^{-1}$，$k_{c}$ 的单位是 $\\mathrm{s}^{-1}\\,\\mu\\mathrm{M}^{-m}$，$C_{b}$ 和 $\\Delta C$ 的单位是 $\\mu\\mathrm{M}$，$\\tau_{c}$ 和 $T$ 的单位是 $\\mathrm{s}$，$M$ 是一个无量纲的计数值。\n\n仅使用上述前提和时变马尔可夫过程的随机化学动力学第一性原理，推导该突触前末梢在 $[0,T]$ 时间内释放囊泡数量的期望值的闭式解析表达式。将您的最终答案表示为仅包含 $M$、$k_{b}$、$k_{c}$、$C_{b}$、$\\Delta C$、$\\tau_{c}$、$m$ 和 $T$ 的单个解析表达式。不要进行数值近似；无需四舍五入。释放囊泡的期望数量是一个无量纲量，因此最终表达式中不需要物理单位。",
            "solution": "用户要求基于一个特定的生物物理模型，推导在有限时间窗口内从单个突触前末梢释放的囊泡的期望数量。\n\n### 步骤 1：问题验证\n\n首先，必须对问题陈述的科学合理性、自洽性和可形式化性进行严格验证。\n\n#### 提取的已知条件：\n-   初始锚定囊泡数量：$M$\n-   囊泡融合模型：每个囊泡的两态 ($D \\to F$) 时变马尔可夫过程。\n-   囊泡融合独立且无记忆性的假设。\n-   $t \\ge 0$ 时的细胞内游离钙离子浓度：$[\\mathrm{Ca}^{2+}](t) = C_{b} + \\Delta C \\exp(-t/\\tau_{c})$。\n-   钙动力学参数：基础浓度 $C_{b}  0$，动作电位引起的增量 $\\Delta C  0$，衰减时间常数 $\\tau_{c}  0$。\n-   瞬时囊泡融合速率：$k_{pf}(t) = k_{b} + k_{c}\\,[\\mathrm{Ca}^{2+}](t)^{m}$。\n-   融合速率参数：基础速率常数 $k_{b} \\ge 0$，钙依赖性速率常数 $k_{c} \\ge 0$，整数钙协同性 $m \\in \\mathbb{N}$。\n-   观测时间区间：$[0, T]$，其中 $T  0$。\n-   所有参数均为常数且单位一致。\n\n#### 验证结论：\n该问题是 **有效的**。\n1.  **科学上成立：** 该模型是突触囊泡融合动力学的标准表示，是计算神经科学的基石之一。它将一级动力学方案与对钙离子浓度的非线性幂律依赖性相结合，这一点得到了实验证据的充分支持。\n2.  **适定性：** 该问题在数学上是适定的。它提供了所有必要的函数、参数和初始条件，以推导出一个唯一的、确定性的期望值表达式。协同性指数 $m$ 的整数性质确保了所需的积分可以解析求解。\n3.  **客观且完整：** 问题以精确、客观且无歧义的术语陈述。它是自洽的，没有矛盾或信息缺失。\n\n该问题满足一项有效科学探究的所有标准。我们现在可以进行求解。\n\n### 步骤 2：解的推导\n\n目标是求出在时间区间 $[0, T]$ 内释放的囊泡的期望数量，记为 $\\mathbb{E}[N_{rel}(T)]$。\n\n设 $P_{D}(t)$ 为单个囊泡在 $t=0$ 时初始锚定，并在时间 $t$ 仍然保持在锚定状态的概率。由于囊泡融合被建模为一级、无记忆性的过程，因此 $P_{D}(t)$ 的时间演化由以下主方程控制：\n$$ \\frac{dP_{D}(t)}{dt} = -k_{pf}(t) P_{D}(t) $$\n其中 $k_{pf}(t)$ 是随时间变化的融合速率。初始条件为 $P_{D}(0) = 1$，因为在 $t=0$ 时所有囊泡都处于锚定状态。\n\n这是一个线性一阶常微分方程。通过变量分离和积分法可以求得 $P_{D}(t)$ 的解：\n$$ \\int_{P_{D}(0)}^{P_{D}(T)} \\frac{dP_{D}}{P_{D}} = -\\int_{0}^{T} k_{pf}(t') dt' $$\n$$ \\ln\\left(\\frac{P_{D}(T)}{P_{D}(0)}\\right) = -\\int_{0}^{T} k_{pf}(t') dt' $$\n给定 $P_{D}(0)=1$，我们有：\n$$ P_{D}(T) = \\exp\\left(-\\int_{0}^{T} k_{pf}(t') dt'\\right) $$\n单个囊泡在时间 $T$ 前已经融合的概率，记为 $P_{F}(T)$，与 $P_{D}(T)$ 互补：\n$$ P_{F}(T) = 1 - P_{D}(T) $$\n问题陈述有 $M$ 个独立的囊泡。释放的囊泡总数 $N_{rel}(T)$ 是这 $M$ 个囊泡结果的总和。每个囊泡的融合可以被视为一个独立的伯努利试验，成功概率为 $P_{F}(T)$。因此，$N_{rel}(T)$ 服从二项分布，$N_{rel}(T) \\sim \\text{Binomial}(M, P_{F}(T))$。\n\n释放囊泡的期望数量是该二项分布的期望值，即 $M$ 乘以单次试验的成功概率：\n$$ \\mathbb{E}[N_{rel}(T)] = M \\cdot P_{F}(T) = M(1 - P_{D}(T)) $$\n$$ \\mathbb{E}[N_{rel}(T)] = M\\left(1 - \\exp\\left(-\\int_{0}^{T} k_{pf}(t') dt'\\right)\\right) $$\n问题的核心归结为计算融合速率 $k_{pf}(t)$ 在区间 $[0, T]$ 上的定积分。我们将此积分定义为累积风险函数 $\\Lambda(T)$：\n$$ \\Lambda(T) = \\int_{0}^{T} k_{pf}(t') dt' $$\n首先，我们代入 $k_{pf}(t)$ 和 $[\\mathrm{Ca}^{2+}](t)$ 的给定表达式：\n$$ k_{pf}(t) = k_{b} + k_{c} \\left( C_{b} + \\Delta C \\exp(-t/\\tau_{c}) \\right)^{m} $$\n现在我们计算该积分：\n$$ \\Lambda(T) = \\int_{0}^{T} \\left[ k_{b} + k_{c} \\left( C_{b} + \\Delta C \\exp(-t'/\\tau_{c}) \\right)^{m} \\right] dt' $$\n$$ \\Lambda(T) = \\int_{0}^{T} k_{b} dt' + k_{c} \\int_{0}^{T} \\left( C_{b} + \\Delta C \\exp(-t'/\\tau_{c}) \\right)^{m} dt' $$\n第一项很简单：$\\int_{0}^{T} k_{b} dt' = k_{b} T$。\n\n对于第二项，由于 $m$ 是一个正整数，我们使用二项式定理来展开被积函数：\n$$ \\left( a + b \\right)^m = \\sum_{j=0}^{m} \\binom{m}{j} a^{m-j} b^j $$\n令 $a = C_{b}$ 且 $b = \\Delta C \\exp(-t'/\\tau_{c})$。该积分变为：\n$$ \\int_{0}^{T} \\sum_{j=0}^{m} \\binom{m}{j} C_{b}^{m-j} \\left( \\Delta C \\exp(-t'/\\tau_{c}) \\right)^{j} dt' $$\n$$ = \\int_{0}^{T} \\sum_{j=0}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\exp(-j t'/\\tau_{c}) dt' $$\n我们可以交换求和与积分算子：\n$$ = \\sum_{j=0}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\int_{0}^{T} \\exp(-j t'/\\tau_{c}) dt' $$\n我们必须对从 $0$ 到 $m$ 的每个 $j$ 值计算积分 $\\int_{0}^{T} \\exp(-j t'/\\tau_{c}) dt'$。\n\n情况 1：$j=0$。指数项为 $\\exp(0) = 1$。\n$$ \\int_{0}^{T} 1 dt' = T $$\n$j=0$ 项对总和的贡献是 $\\binom{m}{0} C_{b}^{m-0} (\\Delta C)^{0} \\cdot T = C_{b}^{m} T$。\n\n情况 2：$j  0$。\n$$ \\int_{0}^{T} \\exp(-j t'/\\tau_{c}) dt' = \\left[ \\frac{\\exp(-j t'/\\tau_{c})}{-j/\\tau_{c}} \\right]_{0}^{T} = -\\frac{\\tau_{c}}{j} \\left( \\exp(-j T/\\tau_{c}) - \\exp(0) \\right) $$\n$$ = \\frac{\\tau_{c}}{j} \\left( 1 - \\exp(-j T/\\tau_{c}) \\right) $$\n结合这些结果，钙依赖部分的积分为：\n$$ \\int_{0}^{T} \\left( \\dots \\right)^{m} dt' = C_{b}^{m} T + \\sum_{j=1}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\frac{\\tau_{c}}{j} \\left( 1 - \\exp(-j T/\\tau_{c}) \\right) $$\n现在，我们组合成 $\\Lambda(T)$ 的完整表达式：\n$$ \\Lambda(T) = k_{b} T + k_{c} \\left[ C_{b}^{m} T + \\sum_{j=1}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\frac{\\tau_{c}}{j} \\left( 1 - \\exp(-j T/\\tau_{c}) \\right) \\right] $$\n这可以通过组合含有 $T$ 的项来重新排列：\n$$ \\Lambda(T) = (k_{b} + k_{c}C_{b}^{m})T + k_{c} \\sum_{j=1}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\frac{\\tau_{c}}{j} \\left( 1 - \\exp(-j T/\\tau_{c}) \\right) $$\n最后，我们将这个 $\\Lambda(T)$ 的表达式代回到释放囊泡期望数量的方程中：\n$$ \\mathbb{E}[N_{rel}(T)] = M \\left( 1 - \\exp(-\\Lambda(T)) \\right) $$\n最终得到的闭式解析表达式是：\n$$ \\mathbb{E}[N_{rel}(T)] = M \\left( 1 - \\exp\\left( -(k_{b} + k_{c}C_{b}^{m})T - k_{c} \\sum_{j=1}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\frac{\\tau_{c}}{j} \\left( 1 - \\exp(-j T/\\tau_{c}) \\right) \\right) \\right) $$\n这个表达式代表了最终答案，是按要求从第一性原理推导出来的。",
            "answer": "$$ \\boxed{M \\left( 1 - \\exp\\left( -\\left(k_{b} + k_{c}C_{b}^{m}\\right)T - k_{c} \\sum_{j=1}^{m} \\binom{m}{j} C_{b}^{m-j} (\\Delta C)^{j} \\frac{\\tau_{c}}{j} \\left( 1 - \\exp\\left(-\\frac{jT}{\\tau_{c}}\\right) \\right) \\right) \\right)} $$"
        },
        {
            "introduction": "当神经递质释放并与突触后受体结合后，会产生相应的突触后电流。本练习  将我们的视角转移到突触后神经元，介绍了一种关键的实验与分析技术——电压钳。通过分析电流-电压（$I$-$V$）关系，你将学会如何辨别如AMPA、NMDA和GABA$_{\\text{A}}$等关键受体类型的独特电生理学指纹，这对于理解神经环路的功能至关重要。",
            "id": "3933952",
            "problem": "在一个急性脑切片上，对一个皮层锥体神经元进行了全细胞电压钳实验，以研究突触传递。在不同的钳制电位下记录了诱发的突触后电流，串联电阻被补偿到百分之几以内，并且漏电流已被减去。外部镁离子维持在生理浓度，约为 $1\\,\\mathrm{mM}$。三种药理学条件分离出三种不同的突触组分，标记为数据集X、数据集Y和数据集Z。对于每个数据集，在几个钳制电位 $V_h$ 下测量了峰值突触电流，得到以下峰值（负电流表示正电荷内流）：\n\n- 数据集X：在 $V_h = -80\\,\\mathrm{mV}$ 时，峰值 $I = -400\\,\\mathrm{pA}$；在 $V_h = -40\\,\\mathrm{mV}$ 时，峰值 $I = -200\\,\\mathrm{pA}$；在 $V_h = 0\\,\\mathrm{mV}$ 时，峰值 $I = 0\\,\\mathrm{pA}$；在 $V_h = +40\\,\\mathrm{mV}$ 时，峰值 $I = +200\\,\\mathrm{pA}$。\n- 数据集Y：在 $V_h = -80\\,\\mathrm{mV}$ 时，峰值 $I = -50\\,\\mathrm{pA}$；在 $V_h = -70\\,\\mathrm{mV}$ 时，峰值 $I = -15\\,\\mathrm{pA}$；在 $V_h = -60\\,\\mathrm{mV}$ 时，峰值 $I = +15\\,\\mathrm{pA}$；在 $V_h = -40\\,\\mathrm{mV}$ 时，峰值 $I = +50\\,\\mathrm{pA}$。\n- 数据集Z：在 $V_h = -80\\,\\mathrm{mV}$ 时，峰值 $I = -20\\,\\mathrm{pA}$；在 $V_h = -40\\,\\mathrm{mV}$ 时，峰值 $I = -80\\,\\mathrm{pA}$；在 $V_h = 0\\,\\mathrm{mV}$ 时，峰值 $I = 0\\,\\mathrm{pA}$；在 $V_h = +40\\,\\mathrm{mV}$ 时，峰值 $I = +220\\,\\mathrm{pA}$。\n\n在相同的记录配置下进行的独立离子替换测量表明，在这些离子条件下，氯离子平衡电位 $E_{\\mathrm{Cl}} \\approx -65\\,\\mathrm{mV}$，非选择性谷氨酸能受体的有效阳离子反转电位接近 $E_{\\mathrm{cat}} \\approx 0\\,\\mathrm{mV}$。\n\n利用基于电导的突触建模和电化学驱动力的基本原理，确定钳制电位 $V_h$ 如何影响驱动力和所测电流的极性，并以此来解析哪个受体类别最可能介导每个数据集。然后评估以下陈述：\n\nA. 数据集X主要由alpha-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid (AMPA)受体介导；在 $V_h = -70\\,\\mathrm{mV}$ 时，其峰值电流是内向的。\n\nB. 数据集Y是谷氨酸能的，因为兴奋性突触后电流在负的 $V_h$ 下总是内向的，并且其在约 $-68\\,\\mathrm{mV}$ 的表观反转与抑制性特征相矛盾。\n\nC. 数据集Z主要由N-Methyl-D-Aspartate (NMDA)受体在生理浓度镁离子下介导；尽管其反转电位接近 $0\\,\\mathrm{mV}$，但由于镁离子阻断的解除，其有效峰值电导随去极化而增加。\n\nD. 对于在测试范围内峰值电导有效不依赖于电压的突触受体，峰值电流的符号取决于 $V_h$ 是小于还是大于测量的反转电位 $E_{\\mathrm{rev}}$：当 $V_h  E_{\\mathrm{rev}}$ 时电流是内向的，当 $V_h > E_{\\mathrm{rev}}$ 时电流是外向的。\n\nE. 如果改变细胞内氯离子，使 $E_{\\mathrm{Cl}}$ 从 $-65\\,\\mathrm{mV}$ 变为 $-50\\,\\mathrm{mV}$，那么在 $V_h = -55\\,\\mathrm{mV}$ 时，一个先前是外向的gamma-aminobutyric acid type A (GABA$_\\mathrm{A}$)电流会变为内向。\n\n选择所有正确的陈述。",
            "solution": "首先根据指定标准验证问题陈述。\n\n### 步骤1：提取已知条件\n- **实验：** 皮层锥体神经元上的全细胞电压钳实验。\n- **测量：** 在不同钳制电位 ($V_h$) 下的诱发突触后电流 (PSCs)。\n- **条件：** 串联电阻已补偿，漏电流已减除，外部镁离子 ($Mg^{2+}$) 浓度约为生理浓度 $1\\,\\mathrm{mM}$。\n- **数据集X：**\n  - 在 $V_h = -80\\,\\mathrm{mV}$ 时，峰值 $I = -400\\,\\mathrm{pA}$。\n  - 在 $V_h = -40\\,\\mathrm{mV}$ 时，峰值 $I = -200\\,\\mathrm{pA}$。\n  - 在 $V_h = 0\\,\\mathrm{mV}$ 时，峰值 $I = 0\\,\\mathrm{pA}$。\n  - 在 $V_h = +40\\,\\mathrm{mV}$ 时，峰值 $I = +200\\,\\mathrm{pA}$。\n- **数据集Y：**\n  - 在 $V_h = -80\\,\\mathrm{mV}$ 时，峰值 $I = -50\\,\\mathrm{pA}$。\n  - 在 $V_h = -70\\,\\mathrm{mV}$ 时，峰值 $I = -15\\,\\mathrm{pA}$。\n  - 在 $V_h = -60\\,\\mathrm{mV}$ 时，峰值 $I = +15\\,\\mathrm{pA}$。\n  - 在 $V_h = -40\\,\\mathrm{mV}$ 时，峰值 $I = +50\\,\\mathrm{pA}$。\n- **数据集Z：**\n  - 在 $V_h = -80\\,\\mathrm{mV}$ 时，峰值 $I = -20\\,\\mathrm{pA}$。\n  - 在 $V_h = -40\\,\\mathrm{mV}$ 时，峰值 $I = -80\\,\\mathrm{pA}$。\n  - 在 $V_h = 0\\,\\mathrm{mV}$ 时，峰值 $I = 0\\,\\mathrm{pA}$。\n  - 在 $V_h = +40\\,\\mathrm{mV}$ 时，峰值 $I = +220\\,\\mathrm{pA}$。\n- **离子电位：**\n  - 氯离子平衡电位 $E_{\\mathrm{Cl}} \\approx -65\\,\\mathrm{mV}$。\n  - 非选择性谷氨酸能受体的阳离子反转电位 $E_{\\mathrm{cat}} \\approx 0\\,\\mathrm{mV}$。\n- **惯例：** 负电流表示正电荷内流。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了一个标准的、控制良好的电生理学实验。所提供的数据，包括电压、电流和离子浓度，都在生理和实验的现实范围内。所涉及的概念——电压钳、突触后电流、反转电位、AMPA、NMDA和GABA受体，以及镁离子阻断——都是突触神经科学的基础。该问题具有科学依据，问题明确，且客观呈现。没有矛盾、缺失必要数据或不科学的前提。\n\n### 步骤3：结论与行动\n该问题是**有效的**。解决方案将通过分析每个数据集，然后评估给出的陈述来展开。\n\n### 推导与分析\n在电压钳实验中，控制突触电流 ($I_{syn}$) 的基本原理是欧姆定律的一种形式：\n$$I_{syn} = g_{syn}(V_h - E_{rev})$$\n其中 $g_{syn}$ 是突触电导，$V_h$ 是钳制电位，$E_{rev}$ 是通透通道的离子的反转电位。$(V_h - E_{rev})$ 项是电化学驱动力。反转电位 $E_{rev}$ 是净电流为零时的电位。根据所述惯例，负电流是内向的（例如，阳离子内流或阴离子外流），正电流是外向的（例如，阳离子外流或阴离子内流）。突触电导 $g_{syn}$ 本身可能依赖于电压。\n\n**数据集X的分析：**\n电流-电压 (I-V) 数据点为 $(-80\\,\\mathrm{mV}, -400\\,\\mathrm{pA})$、$(-40\\,\\mathrm{mV}, -200\\,\\mathrm{pA})$、$(0\\,\\mathrm{mV}, 0\\,\\mathrm{pA})$ 和 $(+40\\,\\mathrm{mV}, +200\\,\\mathrm{pA})$。\n直接观察到反转电位为 $E_{rev} = 0\\,\\mathrm{mV}$，这与给定的非选择性谷氨酸能受体的 $E_{\\mathrm{cat}}$ 相匹配。\n让我们计算电导 $g_X = I / (V_h - E_{rev})$：\n- 在 $V_h = -80\\,\\mathrm{mV}$ 时：$g_X = -400\\,\\mathrm{pA} / (-80\\,\\mathrm{mV} - 0\\,\\mathrm{mV}) = 5\\,\\mathrm{nS}$。\n- 在 $V_h = -40\\,\\mathrm{mV}$ 时：$g_X = -200\\,\\mathrm{pA} / (-40\\,\\mathrm{mV} - 0\\,\\mathrm{mV}) = 5\\,\\mathrm{nS}$。\n- 在 $V_h = +40\\,\\mathrm{mV}$ 时：$g_X = +200\\,\\mathrm{pA} / (+40\\,\\mathrm{mV} - 0\\,\\mathrm{mV}) = 5\\,\\mathrm{nS}$。\n电导是恒定的（$5\\,\\mathrm{nS}$），表明是一个线性的I-V关系。具有 $E_{rev} \\approx 0\\,\\mathrm{mV}$ 的线性I-V曲线是AMPA型谷氨酸受体的特征。因此，数据集X代表AMPA受体介导的电流。\n\n**数据集Y的分析：**\nI-V数据点为 $(-80\\,\\mathrm{mV}, -50\\,\\mathrm{pA})$、$(-70\\,\\mathrm{mV}, -15\\,\\mathrm{pA})$、$(-60\\,\\mathrm{mV}, +15\\,\\mathrm{pA})$ 和 $(-40\\,\\mathrm{mV}, +50\\,\\mathrm{pA})$。\n电流在 $V_h = -70\\,\\mathrm{mV}$ 和 $V_h = -60\\,\\mathrm{mV}$ 之间反转。我们可以通过在这两点之间进行线性插值来估计 $E_{rev}$：\n$$E_{rev} = V_1 + (V_2 - V_1) \\frac{-I_1}{I_2 - I_1} = -70\\,\\mathrm{mV} + (-60\\,\\mathrm{mV} - (-70\\,\\mathrm{mV})) \\frac{-(-15\\,\\mathrm{pA})}{15\\,\\mathrm{pA} - (-15\\,\\mathrm{pA})}$$\n$$E_{rev} = -70\\,\\mathrm{mV} + (10\\,\\mathrm{mV}) \\frac{15}{30} = -70\\,\\mathrm{mV} + 5\\,\\mathrm{mV} = -65\\,\\mathrm{mV}$$\n这个计算出的 $-65\\,\\mathrm{mV}$ 的反转电位与给定的氯离子平衡电位 $E_{\\mathrm{Cl}}$ 相匹配。在 $E_{\\mathrm{Cl}}$ 处反转的突触电流是GABA$_\\mathrm{A}$受体介导电流的特征，这是一种配体门控氯离子通道。在成熟的皮层中，这种电流通常是抑制性的。因此，数据集Y代表GABA$_\\mathrm{A}$受体介导的电流。\n\n**数据集Z的分析：**\nI-V数据点为 $(-80\\,\\mathrm{mV}, -20\\,\\mathrm{pA})$、$(-40\\,\\mathrm{mV}, -80\\,\\mathrm{pA})$、$(0\\,\\mathrm{mV}, 0\\,\\mathrm{pA})$ 和 $(+40\\,\\mathrm{mV}, +220\\,\\mathrm{pA})$。\n观察到反转电位为 $E_{rev} = 0\\,\\mathrm{mV}$，再次与 $E_{\\mathrm{cat}}$ 相匹配。这表明它是一个谷氨酸能受体。\n让我们计算有效电导 $g_Z = I / (V_h - E_{rev})$：\n- 在 $V_h = -80\\,\\mathrm{mV}$ 时：$g_Z = -20\\,\\mathrm{pA} / -80\\,\\mathrm{mV} = 0.25\\,\\mathrm{nS}$。\n- 在 $V_h = -40\\,\\mathrm{mV}$ 时：$g_Z = -80\\,\\mathrm{pA} / -40\\,\\mathrm{mV} = 2.0\\,\\mathrm{nS}$。\n- 在 $V_h = +40\\,\\mathrm{mV}$ 时：$g_Z = +220\\,\\mathrm{pA} / +40\\,\\mathrm{mV} = 5.5\\,\\mathrm{nS}$。\n有效电导不是恒定的；它随去极化显著增加。这是在生理水平的细胞外镁离子($Mg^{2+}$)存在下，NMDA受体介导电流的一个标志。$Mg^{2+}$离子在负膜电位下阻断通道孔，随着膜去极化，这种阻断被解除。由此产生的I-V曲线具有特征性的“J形”。因此，数据集Z代表NMDA受体介导的电流。\n\n### 逐项分析\n\n**A. 数据集X主要由alpha-amino-3-hydroxy-5-methyl-4-isoxazolepropionic acid (AMPA)受体介导；在 $V_h = -70\\,\\mathrm{mV}$ 时，其峰值电流是内向的。**\n- 陈述的第一部分将数据集X的受体确定为AMPA。如上所述，具有 $E_{rev} \\approx 0\\,\\mathrm{mV}$ 的线性I-V曲线是AMPA受体介导电流的定义性特征。这部分是正确的。\n- 第二部分预测了在 $V_h = -70\\,\\mathrm{mV}$ 时的电流方向。反转电位是 $E_{rev} = 0\\,\\mathrm{mV}$。由于 $V_h = -70\\,\\mathrm{mV}  E_{rev} = 0\\,\\mathrm{mV}$，驱动力 $(V_h - E_{rev})$ 为负。对于正电导，电流 $I = g_X(V_h-E_{rev})$ 将为负。按照惯例，负电流是内向的。预期的电流将是 $I = (5\\,\\mathrm{nS})(-70\\,\\mathrm{mV}) = -350\\,\\mathrm{pA}$，这是内向的。这部分也是正确的。\n- **结论：正确。**\n\n**B. 数据集Y是谷氨酸能的，因为兴奋性突触后电流在负的 $V_h$ 下总是内向的，并且其在约 $-68\\,\\mathrm{mV}$ 的表观反转与抑制性特征相矛盾。**\n- 该陈述声称数据集Y是谷氨酸能的。我们的分析表明其反转电位为 $E_{rev} \\approx E_{\\mathrm{Cl}} = -65\\,\\mathrm{mV}$，这是GABA能（抑制性）电流的特征。谷氨酸能电流在 $0\\,\\mathrm{mV}$ 附近反转。该主张不正确。\n- 所提供的理由是有缺陷的。首先，兴奋性电流是否为内向取决于 $V_h$ 相对于其 $E_{rev}$（接近 $0\\,\\mathrm{mV}$）的值，而不仅仅是 $V_h$ 为负。其次，声称在 $-68\\,\\mathrm{mV}$ 附近（我们的计算得出 $-65\\,\\mathrm{mV}$）的反转“与抑制性特征相矛盾”是事实性错误。对于一个动作电位阈值为（例如）$-55\\,\\mathrm{mV}$ 的神经元，一个在 $-65\\,\\mathrm{mV}$ 反转的突触电位会使膜超极化或“分流”，使其*更不容易*发放动作电位，这正是抑制的定义。\n- **结论：不正确。**\n\n**C. 数据集Z主要由N-Methyl-D-Aspartate (NMDA)受体在生理浓度镁离子下介导；尽管其反转电位接近 $0\\,\\mathrm{mV}$，但由于镁离子阻断的解除，其有效峰值电导随去极化而增加。**\n- 陈述的第一部分将数据集Z的受体确定为在生理浓度镁离子下的NMDA受体。我们的分析基于J形的I-V曲线和在 $1\\,\\mathrm{mM}$ 外部 $Mg^{2+}$ 存在下于 $0\\,\\mathrm{mV}$ 处的反转，证实了这一点。这是正确的。\n- 第二部分解释说，有效电导随去极化而增加是由于镁离子阻断的解除。我们对不同电位下 $g_Z$ 的计算（$-80\\,\\mathrm{mV}$ 时为 $0.25\\,\\mathrm{nS}$ vs $+40\\,\\mathrm{mV}$ 时为 $5.5\\,\\mathrm{nS}$）定量地证实了这一点。这是正确的生物物理机制。这部分是正确的。\n- 第三部分指出反转电位接近 $0\\,\\mathrm{mV}$。这一点由数据点 $(0\\,\\mathrm{mV}, 0\\,\\mathrm{pA})$ 证实。这部分是正确的。\n- 整个陈述是对数据的正确而完整的描述。\n- **结论：正确。**\n\n**D. 对于在测试范围内峰值电导有效不依赖于电压的突触受体，峰值电流的符号取决于 $V_h$ 是小于还是大于测量的反转电位 $E_{\\mathrm{rev}}$：当 $V_h  E_{\\mathrm{rev}}$ 时电流是内向的，当 $V_h > E_{\\mathrm{rev}}$ 时电流是外向的。**\n- 该陈述描述了关系式 $I_{syn} = g_{syn}(V_h - E_{rev})$，其中 $g_{syn}$ 是一个正常数。\n- 如果 $V_h  E_{\\mathrm{rev}}$，驱动力 $(V_h - E_{\\mathrm{rev}})$ 为负。因此电流 $I_{syn}$ 为负。根据问题的惯例，负电流是内向的。所以，“当 $V_h  E_{\\mathrm{rev}}$ 时电流是内向的”是正确的。\n- 如果 $V_h > E_{\\mathrm{rev}}$，驱动力 $(V_h - E_{\\mathrm{rev}})$ 为正。因此电流 $I_{syn}$ 为正。正电流是外向的。所以，“当 $V_h > E_{\\mathrm{rev}}$ 时电流是外向的”是正确的。\n- 该陈述是应用到离子通道的欧姆定律的正确形式化表达，使用了电流和驱动力的标准符号约定。\n- **结论：正确。**\n\n**E. 如果改变细胞内氯离子，使 $E_{\\mathrm{Cl}}$ 从 $-65\\,\\mathrm{mV}$ 变为 $-50\\,\\mathrm{mV}$，那么在 $V_h = -55\\,\\mathrm{mV}$ 时，一个先前是外向的gamma-aminobutyric acid type A (GABA$_\\mathrm{A}$)电流会变为内向。**\n- GABA$_\\mathrm{A}$电流由 $Cl^-$ 离子携带，所以其反转电位是 $E_{\\mathrm{Cl}}$。\n- **初始条件：** $E_{\\mathrm{Cl}} = -65\\,\\mathrm{mV}$，$V_h = -55\\,\\mathrm{mV}$。驱动力是 $V_h - E_{\\mathrm{Cl}} = (-55\\,\\mathrm{mV}) - (-65\\,\\mathrm{mV}) = +10\\,\\mathrm{mV}$。电流为正，即外向。陈述说电流“先前是外向的”，这是正确的。\n- **新条件：** $E_{\\mathrm{Cl}}$ 变为 $-50\\,\\mathrm{mV}$，$V_h = -55\\,\\mathrm{mV}$。现在的驱动力是 $V_h - E_{\\mathrm{Cl}} = (-55\\,\\mathrm{mV}) - (-50\\,\\mathrm{mV}) = -5\\,\\mathrm{mV}$。电流现在为负，即内向。陈述说电流“会变为内向”，这也是正确的。\n- 该陈述准确地预测了基于驱动力变化的电流方向变化。\n- **结论：正确。**",
            "answer": "$$\\boxed{ACDE}$$"
        },
        {
            "introduction": "突触并非一成不变，其连接强度会随着神经活动而改变，这一过程被认为是学习与记忆的细胞基础。本练习  引导你进入突触可塑性的领域，特别是经典的Bienenstock-Cooper-Munro（BCM）理论。你将通过编写数值模拟，探索突触权重如何根据突触前后神经元的发放率相关性进行演化，从而深入理解神经环路的自稳态与自适应调节机制。",
            "id": "3933906",
            "problem": "在一个基于速率的框架中，对连接突触前神经元和突触后神经元的单个突触进行建模。突触前放电速率表示为 $x(t)$（单位为 $\\mathrm{Hz}$），突触后放电速率表示为 $y(t)$（单位为 $\\mathrm{Hz}$）。突触效能（权重）表示为 $w(t)$，是无量纲的。权重被限制在固定边界 $w_{\\min} \\leq w(t) \\leq w_{\\max}$ 内，以反映生物物理的饱和极限。目标是根据 Bienenstock–Cooper–Munro (BCM) 学习准则计算突触权重更新，并探讨当 $w(t)$ 有界时突触权重的稳定性。\n\n将使用的基本建模假设和定义：\n- BCM 学习准则指出，突触修改的速率与突触前活动、突触后活动以及突触后活动与一个滑动活动阈值之间的带符号差值的乘积成正比。该准则必须通过一个与突触后活动的长期平均值相关联的滑动阈值来实例化。\n- 定义一个长期活动变量 $\\Theta(t)$（单位为 $\\mathrm{Hz}^2$），它通过时间常数为 $\\tau_{\\Theta}$（单位为 $\\mathrm{s}$）的一阶低通动力学来跟踪 $y(t)^2$ 随时间的缓慢平均值。瞬时滑动阈值为 $\\vartheta(t) = \\sqrt{\\Theta(t)}$（单位为 $\\mathrm{Hz}$），以确保 BCM 修改项中的单位一致性。\n- 使用显式欧拉时间离散化：如果 $t_k = k \\Delta t$，时间步长为 $\\Delta t$（单位为 $\\mathrm{s}$），则 $\\Theta$ 的一个时间步更新必须使用前向欧拉增量计算，权重更新必须类似地从 BCM 修改速率计算。每次权重更新后，通过裁剪强制执行 $w_{\\min} \\leq w \\leq w_{\\max}$。\n\n科学单位和数值实现细节：\n- 突触前速率 $x(t)$ 和突触后速率 $y(t)$ 的单位为 $\\mathrm{Hz}$。\n- 时间步长 $\\Delta t$ 和总仿真时间 $T$ 的单位为 $\\mathrm{s}$。\n- 学习率参数 $\\eta$ 的单位必须是 $\\mathrm{s}^{-1}\\cdot\\mathrm{Hz}^{-3}$，以使单位时间内的突触变化在量纲上保持一致。\n- 长期活动时间常数 $\\tau_{\\Theta}$ 的单位为 $\\mathrm{s}$。\n- 权重 $w(t)$ 是无量纲的。\n- $\\Theta(t)$ 的长期平均动力学必须实现为朝向 $y(t)^2$ 的一阶松弛；滑动阈值 $\\vartheta(t)$ 必须是 $\\sqrt{\\Theta(t)}$。\n\n稳定性评估：\n- 定义权重边界的数值容差 $\\,\\varepsilon_w$（无量纲）和最后一次权重增量的容差 $\\,\\varepsilon_{\\Delta w}$（无量纲）。在仿真结束时，如果 $w_{\\min} + \\varepsilon_w  w(T)  w_{\\max} - \\varepsilon_w$ 且最后一次实际权重变化的幅度小于 $\\varepsilon_{\\Delta w}$，则将权重分类为“内部稳定”(interior-stable)。同时报告最终权重是否实际上处于上界（$w(T) \\geq w_{\\max} - \\varepsilon_w$）或下界（$w(T) \\leq w_{\\min} + \\varepsilon_w$）。\n\n时间离散化和更新规则需要根据上述基本定义推导和实现（不使用任何预先提供的快捷公式）：\n- 在每个步骤 $t_k$ 使用前向欧拉更新来计算新的 $\\Theta$ 和新的 $w$。每次更新后通过裁剪来强制执行 $w$ 的边界。\n\n测试套件：\n实现程序以模拟以下情况，每种情况都带有科学上合理的参数，并返回稳定性和边界的分类。所有放电速率单位为 $\\mathrm{Hz}$，时间单位为 $\\mathrm{s}$，学习率单位为 $\\mathrm{s}^{-1}\\cdot\\mathrm{Hz}^{-3}$。对于每个测试，突触前活动 $x(t)$ 是恒定的，而突触后活动 $y(t)$ 是恒定的或如指示的分段恒定。\n1. 情况 1（理想情况，匹配恒定速率下的内部稳定性）：\n    - $x(t) \\equiv 10$, $y(t) \\equiv 10$.\n    - $w(0) = 0.2$, $w_{\\min} = 0.0$, $w_{\\max} = 1.0$.\n    - $\\Theta(0) = 0.0$.\n    - $\\eta = 10^{-5}$, $\\tau_{\\Theta} = 1.0$, $\\Delta t = 0.001$, $T = 10.0$.\n    - 容差: $\\varepsilon_w = 10^{-3}$, $\\varepsilon_{\\Delta w} = 10^{-6}$.\n2. 情况 2（强增强，可能达到上界饱和）：\n    - $x(t) \\equiv 20$, $y(t) \\equiv 30$.\n    - $w(0) = 0.8$, $w_{\\min} = 0.0$, $w_{\\max} = 1.0$.\n    - $\\Theta(0) = 0.0$.\n    - $\\eta = 10^{-5}$, $\\tau_{\\Theta} = 1.0$, $\\Delta t = 0.001$, $T = 10.0$.\n    - 容差: $\\varepsilon_w = 10^{-3}$, $\\varepsilon_{\\Delta w} = 10^{-6}$.\n3. 情况 3（初始高阈值下的抑制）：\n    - $x(t) \\equiv 12$, $y(t) \\equiv 2$.\n    - $w(0) = 0.5$, $w_{\\min} = 0.0$, $w_{\\max} = 1.0$.\n    - $\\Theta(0) = 400.0$ (因此初始 $\\vartheta(0) = 20$).\n    - $\\eta = 10^{-5}$, $\\tau_{\\Theta} = 2.0$, $\\Delta t = 0.001$, $T = 5.0$.\n    - 容差: $\\varepsilon_w = 10^{-3}$, $\\varepsilon_{\\Delta w} = 10^{-6}$.\n4. 情况 4（分段突触后活动；初始高活动后接低活动）：\n    - $x(t) \\equiv 10$, $y(t) = 25$ for $0 \\leq t  2.0$, and $y(t) = 5$ for $2.0 \\leq t \\leq 10.0$.\n    - $w(0) = 0.3$, $w_{\\min} = 0.0$, $w_{\\max} = 1.0$.\n    - $\\Theta(0) = 0.0$.\n    - $\\eta = 10^{-5}$, $\\tau_{\\Theta} = 1.0$, $\\Delta t = 0.001$, $T = 10.0$.\n    - 容差: $\\varepsilon_w = 10^{-3}$, $\\varepsilon_{\\Delta w} = 10^{-6}$.\n5. 情况 5（边界条件，从上界开始）：\n    - $x(t) \\equiv 8$, $y(t) \\equiv 8$.\n    - $w(0) = 1.0$, $w_{\\min} = 0.0$, $w_{\\max} = 1.0$.\n    - $\\Theta(0) = 0.0$.\n    - $\\eta = 10^{-5}$, $\\tau_{\\Theta} = 1.0$, $\\Delta t = 0.001$, $T = 3.0$.\n    - 容差: $\\varepsilon_w = 10^{-3}$, $\\varepsilon_{\\Delta w} = 10^{-6}$.\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是包含四个条目的列表，顺序为 $[w_{\\mathrm{final}}, \\text{interior\\_stable}, \\text{at\\_upper\\_bound}, \\text{at\\_lower\\_bound}]$，其中 $w_{\\mathrm{final}}$ 是一个四舍五入到六位小数的浮点数，三个布尔标志指示如上定义的稳定性分类。例如，输出格式必须与 $[[0.123456,\\text{True},\\text{False},\\text{False}],[\\dots],\\dots]$ 完全一样，程序不插入任何空格。",
            "solution": "所提出的问题是计算神经科学领域中一个有效且定义明确的任务，特别是在突触可塑性建模领域。它要求对 Bienenstock–Cooper–Munro (BCM) 学习规则进行数值模拟，该规则具有滑动阈值和受生物物理启发的权重边界。该问题具有科学依据、自成体系，并为一组特定的测试用例提供了所有参数。我们将首先根据所提供的原则建立连续时间数学模型，然后使用指定的前向欧拉方法推导离散时间更新方程，最后概述模拟和分析算法。\n\nBCM 模型的核心是类赫布原则，即突触变化取决于突触前和突触后活动的相关性，但有一个关键的修改：在突触抑制和增强之间转换的阈值不是固定的，而是根据突触后活动的近期历史而变化。\n\n首先，我们形式化控制微分方程。长期活动变量 $\\Theta(t)$ 被描述为突触后放电速率平方 $y(t)^2$ 的一阶低通滤波版本，时间常数为 $\\tau_{\\Theta}$。这对应于以下微分方程：\n$$\n\\frac{d\\Theta(t)}{dt} = \\frac{1}{\\tau_{\\Theta}} \\left( y(t)^2 - \\Theta(t) \\right)\n$$\n在这里，$\\Theta(t)$ 以特征时间 $\\tau_{\\Theta}$ 向目标值 $y(t)^2$ 松弛。瞬时滑动阈值 $\\vartheta(t)$ 定义为该变量的平方根，以保持与放电速率 $y(t)$ 的单位一致性：\n$$\n\\vartheta(t) = \\sqrt{\\Theta(t)}\n$$\n突触权重 $w(t)$ 的变化率由 BCM 规则给出：它与突触前速率 $x(t)$、突触后速率 $y(t)$ 以及突触后速率与滑动阈值之间的差值 $(y(t) - \\vartheta(t))$ 的乘积成正比。比例常数是学习率 $\\eta$。这给出了第二个微分方程：\n$$\n\\frac{dw(t)}{dt} = \\eta \\cdot x(t) \\cdot y(t) \\cdot \\left( y(t) - \\vartheta(t) \\right)\n$$\n我们来验证量纲一致性。权重 $w(t)$ 是无量纲的，所以 $\\frac{dw}{dt}$ 的单位是 $\\mathrm{s}^{-1}$。右侧的单位是 $(\\mathrm{s}^{-1} \\cdot \\mathrm{Hz}^{-3}) \\cdot (\\mathrm{Hz}) \\cdot (\\mathrm{Hz}) \\cdot (\\mathrm{Hz}) = \\mathrm{s}^{-1}$，这是一致的。\n\n接下来，我们使用时间步长为 $\\Delta t$ 的前向欧拉方法推导数值更新规则。对于一个通用的微分方程 $\\frac{dz}{dt} = f(z, t)$，前向欧拉更新是 $z_{k+1} = z_k + \\Delta t \\cdot f(z_k, t_k)$，其中 $z_k = z(t_k)$ 且 $t_k = k \\Delta t$。\n\n将此应用于 $\\Theta(t)$ 的方程，我们得到 $\\Theta_k$ 的更新规则：\n$$\n\\Theta_{k+1} = \\Theta_k + \\Delta t \\cdot \\frac{1}{\\tau_{\\Theta}} \\left( y_k^2 - \\Theta_k \\right)\n$$\n其中 $y_k = y(t_k)$。\n\n类似地，对于权重 $w(t)$，我们推导更新规则。首先，我们计算下一个时间步长的无约束权重，我们将其表示为 $w'_{k+1}$：\n$$\nw'_{k+1} = w_k + \\Delta t \\cdot \\eta \\cdot x_k \\cdot y_k \\cdot \\left( y_k - \\sqrt{\\Theta_k} \\right)\n$$\n这里，$x_k = x(t_k)$。如果 $\\Theta_k$ 由于浮点误差而变得略微为负，则会出现潜在的数值问题；在实现中，谨慎的做法是计算 $\\sqrt{\\max(0, \\Theta_k)}$。在计算出这个无约束值之后，我们必须通过裁剪来强制执行生物物理边界 $w_{\\min}$ 和 $w_{\\max}$：\n$$\nw_{k+1} = \\max(w_{\\min}, \\min(w_{\\max}, w'_{k+1}))\n$$\n这个更新然后裁剪的两步过程在仿真的每个时间步执行。\n\n总体模拟算法如下：\n1. 初始化状态变量 $w(0)$ 和 $\\Theta(0)$，以及仿真时间 $t=0$。\n2. 确定总步数，$N = \\lfloor T / \\Delta t \\rfloor$。\n3. 从 $k=0$ 迭代到 $N-1$：\n    a. 确定输入值 $x_k = x(k\\Delta t)$ 和 $y_k = y(k\\Delta t)$。对于情况 4，这涉及对当前时间 $t_k$ 的条件检查。\n    b. 计算当前滑动阈值 $\\vartheta_k = \\sqrt{\\max(0, \\Theta_k)}$。\n    c. 计算下一步的未裁剪权重：$w'_{k+1} = w_k + \\Delta t \\cdot \\eta \\cdot x_k \\cdot y_k \\cdot (y_k - \\vartheta_k)$。\n    d. 应用裁剪以找到下一步的最终权重：$w_{k+1} = \\text{clip}(w'_{k+1}, w_{\\min}, w_{\\max})$。\n    e. 存储此步骤中的实际权重变化：$\\Delta w_k = w_{k+1} - w_k$。\n    f. 更新长期活动变量：$\\Theta_{k+1} = \\Theta_k + (\\Delta t / \\tau_{\\Theta})(y_k^2 - \\Theta_k)$。\n    g. 下一次迭代的状态是 $(w_{k+1}, \\Theta_{k+1})$。\n\n循环完成后，在时间 $T$，我们得到最终权重 $w(T) = w_N$ 和最后一次实际权重变化 $\\Delta w_{N-1}$。然后我们根据给定的标准进行稳定性分类：\n- **内部稳定 (Interior-stable)：** 如果 $w_{\\min} + \\varepsilon_w  w(T)  w_{\\max} - \\varepsilon_w$ 且 $|\\Delta w_{N-1}|  \\varepsilon_{\\Delta w}$，则标志为 `True`。\n- **处于上界 (At upper bound)：** 如果 $w(T) \\geq w_{\\max} - \\varepsilon_w$，则标志为 `True`。\n- **处于下界 (At lower bound)：** 如果 $w(T) \\leq w_{\\min} + \\varepsilon_w$，则标志为 `True`。\n\n然后将此过程应用于问题陈述中指定的五个测试用例中的每一个。收集结果并将其格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates synaptic weight dynamics under the BCM rule for several test cases\n    and reports on the final weight and its stability.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path, interior stability with matched constant rates)\n        {\n            \"x_func\": lambda t: 10.0, \"y_func\": lambda t: 10.0,\n            \"w0\": 0.2, \"w_min\": 0.0, \"w_max\": 1.0,\n            \"Theta0\": 0.0, \"eta\": 1e-5, \"tau_Theta\": 1.0,\n            \"dt\": 0.001, \"T\": 10.0,\n            \"eps_w\": 1e-3, \"eps_dw\": 1e-6\n        },\n        # Case 2 (strong potentiation, likely upper-bound saturation)\n        {\n            \"x_func\": lambda t: 20.0, \"y_func\": lambda t: 30.0,\n            \"w0\": 0.8, \"w_min\": 0.0, \"w_max\": 1.0,\n            \"Theta0\": 0.0, \"eta\": 1e-5, \"tau_Theta\": 1.0,\n            \"dt\": 0.001, \"T\": 10.0,\n            \"eps_w\": 1e-3, \"eps_dw\": 1e-6\n        },\n        # Case 3 (depression under an initially high threshold)\n        {\n            \"x_func\": lambda t: 12.0, \"y_func\": lambda t: 2.0,\n            \"w0\": 0.5, \"w_min\": 0.0, \"w_max\": 1.0,\n            \"Theta0\": 400.0, \"eta\": 1e-5, \"tau_Theta\": 2.0,\n            \"dt\": 0.001, \"T\": 5.0,\n            \"eps_w\": 1e-3, \"eps_dw\": 1e-6\n        },\n        # Case 4 (piecewise postsynaptic activity)\n        {\n            \"x_func\": lambda t: 10.0, \"y_func\": lambda t: 25.0 if t  2.0 else 5.0,\n            \"w0\": 0.3, \"w_min\": 0.0, \"w_max\": 1.0,\n            \"Theta0\": 0.0, \"eta\": 1e-5, \"tau_Theta\": 1.0,\n            \"dt\": 0.001, \"T\": 10.0,\n            \"eps_w\": 1e-3, \"eps_dw\": 1e-6\n        },\n        # Case 5 (boundary condition, starting at the upper bound)\n        {\n            \"x_func\": lambda t: 8.0, \"y_func\": lambda t: 8.0,\n            \"w0\": 1.0, \"w_min\": 0.0, \"w_max\": 1.0,\n            \"Theta0\": 0.0, \"eta\": 1e-5, \"tau_Theta\": 1.0,\n            \"dt\": 0.001, \"T\": 3.0,\n            \"eps_w\": 1e-3, \"eps_dw\": 1e-6\n        },\n    ]\n\n    def run_bcm_simulation(params):\n        \"\"\"Runs a single BCM simulation for a given set of parameters.\"\"\"\n        w = params[\"w0\"]\n        Theta = params[\"Theta0\"]\n        dt = params[\"dt\"]\n        T = params[\"T\"]\n        \n        num_steps = int(round(T / dt))\n        last_dw = 0.0\n\n        for k in range(num_steps):\n            t = k * dt\n            \n            # Get current input values\n            x = params[\"x_func\"](t)\n            y = params[\"y_func\"](t)\n\n            # Calculate sliding threshold\n            # Use np.maximum to prevent domain error from floating point inaccuracies\n            theta_thresh = np.sqrt(np.maximum(0.0, Theta))\n\n            # Calculate weight update (Forward Euler)\n            dw_dt = params[\"eta\"] * x * y * (y - theta_thresh)\n            w_pre_clip = w + dw_dt * dt\n            \n            # Clip weight to bounds\n            w_new = np.clip(w_pre_clip, params[\"w_min\"], params[\"w_max\"])\n            \n            # Store actual last weight change\n            last_dw = w_new - w\n            w = w_new\n\n            # Update long-term activity variable (Forward Euler)\n            dTheta_dt = (1.0 / params[\"tau_Theta\"]) * (y**2 - Theta)\n            Theta = Theta + dTheta_dt * dt\n\n        # Stability analysis\n        w_final = w\n        w_min = params[\"w_min\"]\n        w_max = params[\"w_max\"]\n        eps_w = params[\"eps_w\"]\n        eps_dw = params[\"eps_dw\"]\n\n        is_interior_stable = (w_final > w_min + eps_w and \n                              w_final  w_max - eps_w and \n                              abs(last_dw)  eps_dw)\n        \n        is_at_upper_bound = w_final >= w_max - eps_w\n        is_at_lower_bound = w_final = w_min + eps_w\n\n        return [w_final, is_interior_stable, is_at_upper_bound, is_at_lower_bound]\n\n    results_as_strings = []\n    for case_params in test_cases:\n        result = run_bcm_simulation(case_params)\n        # Python's bool string is 'True'/'False' with capital first letter, which is what the example shows.\n        w_final_str = f\"{result[0]:.6f}\"\n        res_str = f\"[{w_final_str},{str(result[1])},{str(result[2])},{str(result[3])}]\"\n        results_as_strings.append(res_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_as_strings)}]\")\n\nsolve()\n\n```"
        }
    ]
}