{
    "hands_on_practices": [
        {
            "introduction": "在我们将细胞膜抽象为 RC 电路模型之前，首先必须从物理学的基本原理出发，理解膜电容的来源。这个练习将引导我们将细胞膜看作一个平行板电容器，并利用高斯定律和电容的定义，推导出膜电容与膜的几何尺寸及介电特性之间的关系。通过这项实践，我们不仅能巩固对基本电磁学理论的理解，还能将理论计算结果与生物物理实验中测得的典型膜电容值进行比较，从而深刻体会到生物系统建模中理论与现实的联系 。",
            "id": "3900803",
            "problem": "一块细胞膜片可以被建模为电阻-电容（RC）电路中的电容元件，其中双分子层在两个导电的离子溶液之间充当均匀的线性电介质。考虑一个面积为 $A$、厚度为 $d$、相对介电常数（介电常数）为 $\\epsilon_{r}$ 的平面膜片。假设以下生物物理上合理的条件：膜内部不含自由电荷，离子溶液为理想导体，并且膜片的几何形状满足 $A \\gg d^{2}$，从而使得边缘场在感兴趣的区域内可以忽略不计。\n\n从静电学的基本原理出发——即物质中的高斯定律和电容的定义——推导膜电容 $C$ 关于 $A$、$d$ 和 $\\epsilon_{r}$ 的表达式。然后，使用典型值 $\\epsilon_{r} \\approx 2$、$d \\approx 5\\,\\mathrm{nm}$ 和 $A = 10^{-5}\\,\\mathrm{cm}^2$，计算 $C$ 并将其与生物膜的经验比电容（约为 $1\\,\\mathrm{\\mu F/cm^2}$）进行比较。定义无量纲一致性度量\n$$R \\equiv \\frac{C}{A \\times (1\\,\\mathrm{\\mu F/cm^2})}$$\n并将 $R$ 作为最终答案报告。将 $C$ 以法拉为单位表示，所有中间计算使用国际单位制（SI），并将 $R$ 的最终值四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于静电学原理和标准生物物理模型，问题设定良好，目标明确，数据充分，并使用客观、明确的语言进行表述。给定的数值在生物物理上是合理的，任务涉及标准的推导和计算。\n\n解题过程按要求分为三个部分：首先，推导电容公式；其次，数值计算电容 $C$；最后，计算无量纲一致性度量 $R$。\n\n**第一部分：膜电容的推导**\n\n我们将细胞膜片建模为一个面积为 $A$、极板间距为 $d$ 的平行板电容器。导电极板（离子溶液）之间的空间充满了相对介电常数为 $\\epsilon_r$ 的均匀线性电介质（脂质双分子层）。电容 $C$ 定义为一个导体上的自由电荷量 $Q$ 的大小与两导体之间电势差 $|\\Delta V|$ 的大小之比：\n$$C \\equiv \\frac{Q}{|\\Delta V|}$$\n为了找到用几何和材料属性表示 $C$ 的表达式，我们必须建立 $Q$ 和 $|\\Delta V|$ 之间的关系。\n\n我们从电介质中电位移场 $\\vec{D}$ 的高斯定律开始：\n$$\\oint_S \\vec{D} \\cdot d\\vec{a} = Q_{\\text{free, encl}}$$\n其中 $Q_{\\text{free, encl}}$ 是高斯面 $S$ 包围的自由电荷。设极板平行于 $xy$ 平面。我们在电介质内部，紧邻上方导电极板下方，放置一个圆柱形高斯面，其顶盖面积为 $a$，底盖位于导体内部，那里的电场为零。根据对称性，电位移场 $\\vec{D}$ 是均匀的，且垂直于极板，指向 $z$ 方向（$\\vec{D} = D \\hat{k}$）。通过圆柱体侧壁的通量为零。通过底盖的通量为零，因为在理想导体内部 $\\vec{D} = 0$。积分的唯一非零贡献来自顶盖。\n因此，高斯定律简化为 $D \\cdot a = Q_{\\text{free, encl}}$。包围的自由电荷是极板面积 $a$ 上的电荷，即 $\\sigma a$，其中 $\\sigma = Q/A$ 是均匀的表面电荷密度。\n$$D a = \\sigma a \\implies D = \\sigma = \\frac{Q}{A}$$\n对于线性、各向同性的电介质，电位移 $\\vec{D}$ 与电场 $\\vec{E}$ 的关系为 $\\vec{D} = \\epsilon \\vec{E}$，其中 $\\epsilon$ 是材料的介电常数。介电常数由 $\\epsilon = \\epsilon_r \\epsilon_0$ 给出，其中 $\\epsilon_r$ 是相对介电常数，$\\epsilon_0$ 是真空介电常数。\n因此，电介质内部电场 $E$ 的大小为：\n$$E = \\frac{D}{\\epsilon_r \\epsilon_0} = \\frac{Q}{A \\epsilon_r \\epsilon_0}$$\n由于题目假设 $A \\gg d^2$，边缘场可以忽略不计，电场 $E$ 在整个电介质中是均匀的。极板间的电势差 $|\\Delta V|$ 通过对电场沿距离 $d$ 积分得到：\n$$|\\Delta V| = \\left| -\\int_{0}^{d} \\vec{E} \\cdot d\\vec{l} \\right| = E d$$\n代入 $E$ 的表达式：\n$$|\\Delta V| = \\frac{Qd}{A \\epsilon_r \\epsilon_0}$$\n最后，我们将这个 $|\\Delta V|$ 的表达式代回电容的定义中：\n$$C = \\frac{Q}{|\\Delta V|} = \\frac{Q}{\\frac{Qd}{A \\epsilon_r \\epsilon_0}}$$\n这就得到了膜片电容的期望表达式：\n$$C = \\frac{\\epsilon_r \\epsilon_0 A}{d}$$\n\n**第二部分：电容 $C$ 的数值计算**\n\n我们已知以下数值：\n-   相对介电常数：$\\epsilon_r = 2$\n-   膜厚度：$d = 5 \\, \\mathrm{nm}$\n-   膜片面积：$A = 10^{-5} \\, \\mathrm{cm^2}$\n\n我们使用真空介电常数的值，$\\epsilon_0 \\approx 8.854 \\times 10^{-12} \\, \\mathrm{F/m}$。\n为保持一致性，所有数值必须转换为国际单位制（SI）。\n$$d = 5 \\, \\mathrm{nm} = 5 \\times 10^{-9} \\, \\mathrm{m}$$\n$$A = 10^{-5} \\, \\mathrm{cm^2} = 10^{-5} \\times (10^{-2} \\, \\mathrm{m})^2 = 10^{-5} \\times 10^{-4} \\, \\mathrm{m^2} = 10^{-9} \\, \\mathrm{m^2}$$\n现在，我们将这些值代入推导出的 $C$ 的公式中：\n$$C = \\frac{(2) \\times (8.854 \\times 10^{-12} \\, \\mathrm{F/m}) \\times (10^{-9} \\, \\mathrm{m^2})}{5 \\times 10^{-9} \\, \\mathrm{m}}$$\n$$C = \\frac{2 \\times 8.854 \\times 10^{-12} \\times 10^{-9}}{5 \\times 10^{-9}} \\, \\mathrm{F}$$\n$$C = \\frac{17.708 \\times 10^{-21}}{5 \\times 10^{-9}} \\, \\mathrm{F}$$\n$$C = 3.5416 \\times 10^{-12} \\, \\mathrm{F}$$\n\n**第三部分：一致性度量 $R$ 的计算**\n\n无量纲一致性度量 $R$ 定义为：\n$$R \\equiv \\frac{C}{A \\times (1\\,\\mathrm{\\mu F/cm^2})}$$\n分母中的项代表了基于 $1\\,\\mathrm{\\mu F/cm^2}$ 的经验比电容所期望的电容值。我们来计算它的值。\n-   $A = 10^{-5}\\,\\mathrm{cm^2}$\n-   $1\\,\\mathrm{\\mu F/cm^2} = 1 \\times 10^{-6}\\,\\mathrm{F/cm^2}$\n\n分母的值为 $(10^{-5}\\,\\mathrm{cm^2}) \\times (1 \\times 10^{-6}\\,\\mathrm{F/cm^2}) = 1 \\times 10^{-11}\\,\\mathrm{F}$。\n\n现在我们可以使用在第二部分计算出的 $C$ 的值来计算 $R$：\n$$R = \\frac{3.5416 \\times 10^{-12} \\, \\mathrm{F}}{1 \\times 10^{-11} \\, \\mathrm{F}}$$\n$$R = 0.35416$$\n题目要求将 $R$ 的最终值四舍五入到四位有效数字。\n$$R \\approx 0.3542$$\n这个结果表明，使用给定的典型参数从简单的平行板模型计算出的电容大约是经验测量值的 $35\\%$。这种差异的产生是因为 $\\epsilon_r$ 和 $d$ 的值是近似值，并且真实的膜结构比均匀的电介质板更复杂。",
            "answer": "$$\\boxed{0.3542}$$"
        },
        {
            "introduction": "建立了细胞膜的 RC 并联电路模型后，下一个关键步骤是分析其动态响应特性。当细胞接收到振荡的电流输入时，例如来自突触的周期性活动，膜电压将如何响应？本练习通过引入复阻抗的概念，从数学上精确描述膜电压响应的幅度和相位与输入电流频率的关系，从而揭示细胞膜作为一个低通滤波器固有的功能 。理解这一特性对于认识神经元如何整合时间尺度上变化的信号至关重要。",
            "id": "3900816",
            "problem": "单室细胞膜被建模为一个并联电阻-电容 (RC) 电路，该电路由一个漏泄电导为 $g_{L}$ 的漏泄通路和一个膜电容 $C$ 组成。在小信号正弦激励下，电流 $i(t)$ 驱动产生电压响应 $v(t)$，该响应可以很好地用线性时不变动力学来近似。假设在角频率 $\\omega$ 下有一个正弦驱动电流 $i(t)$，并将复阻抗 $Z(\\omega)$ 定义为稳态下复电压与复电流之比。\n\n从两个并联元件的基本关系——即电容器电流定律 $i_{C}(t)=C\\,\\frac{dv}{dt}$ 和欧姆漏泄定律 $i_{L}(t)=g_{L}\\,v(t)$——出发，并对细胞膜应用基尔霍夫电流定律 (Kirchhoff’s current law)，推导出 $Z(\\omega)$，并由此推导出其幅值 $\\left|Z(\\omega)\\right|$ 和描述电压与电流关系的相位 $\\phi(\\omega)$。然后，在 $C=20\\,\\mathrm{pF}$ 和 $g_{L}=2\\,\\mathrm{nS}$ 的条件下，计算当 $\\omega=2\\pi\\times 100\\,\\mathrm{Hz}$ 时这些量的值。将阻抗幅值以兆欧为单位表示，相位以弧度为单位表示。将您的答案四舍五入至四位有效数字。\n\n最后，根据您的结果，简要评论在此模型中，相对于直流 (DC; $\\omega=0$) 响应，在 $\\omega=2\\pi\\times 100\\,\\mathrm{Hz}$ 时电压幅度的预期衰减。",
            "solution": "问题陈述被评估为有效，因为它具有科学依据、内容自洽且提法恰当。将细胞膜建模为并联 RC 电路是生物物理学和生物医学工程中的一个标准和基本概念。求解所需的所有参数和原理均已提供。\n\n我们首先对该并联电路应用基尔霍夫电流定律 (KCL)。注入的总电流 $i(t)$ 必须等于流经各个元件的电流之和：即漏泄通路（一个电导为 $g_L$ 的电阻）和膜电容 ($C$)。\n$$i(t) = i_{L}(t) + i_{C}(t)$$\n流经漏泄电导和电容器的电流分别由欧姆漏泄定律 $i_{L}(t) = g_{L}v(t)$ 和电容器电流定律 $i_{C}(t) = C\\frac{dv(t)}{dt}$ 给出。将这些代入 KCL 方程，得到描述膜电压 $v(t)$ 的一阶线性常微分控制方程：\n$$i(t) = g_{L}v(t) + C\\frac{dv(t)}{dt}$$\n为分析电路在特定角频率 $\\omega$ 下对正弦输入电流的响应，我们使用相量分析法转换到频域。我们将正弦电流和电压表示为复指数的实部：$i(t) = \\Re\\{\\tilde{I}e^{j\\omega t}\\}$ 和 $v(t) = \\Re\\{\\tilde{V}e^{j\\omega t}\\}$，其中 $\\tilde{I}$ 和 $\\tilde{V}$ 分别是电流和电压的复相量。在相量域中，时间导数 $\\frac{d}{dt}$ 变为乘以 $j\\omega$：$\\frac{d}{dt} \\to j\\omega$。\n\n将这些代入微分方程，得到：\n$$\\tilde{I} = g_{L}\\tilde{V} + C(j\\omega\\tilde{V})$$\n提出因子 $\\tilde{V}$：\n$$\\tilde{I} = (g_{L} + j\\omega C)\\tilde{V}$$\n复阻抗 $Z(\\omega)$ 定义为复电压相量与复电流相量之比：\n$$Z(\\omega) = \\frac{\\tilde{V}}{\\tilde{I}} = \\frac{1}{g_{L} + j\\omega C}$$\n为了求出幅值 $|Z(\\omega)|$ 和相位 $\\phi(\\omega)$，我们将 $Z(\\omega)$ 表示为极坐标形式。幅值是该复数的模：\n$$|Z(\\omega)| = \\left|\\frac{1}{g_{L} + j\\omega C}\\right| = \\frac{|1|}{|g_{L} + j\\omega C|} = \\frac{1}{\\sqrt{g_{L}^2 + (\\omega C)^2}}$$\n相位 $\\phi(\\omega)$ 是复数 $Z(\\omega)$ 的辐角：\n$$\\phi(\\omega) = \\arg(Z(\\omega)) = \\arg(1) - \\arg(g_{L} + j\\omega C) = 0 - \\arctan\\left(\\frac{\\omega C}{g_L}\\right)$$\n$$\\phi(\\omega) = -\\arctan\\left(\\frac{\\omega C}{g_L}\\right)$$\n负相位表明电压响应 $v(t)$ 滞后于驱动电流 $i(t)$。\n\n我们需要根据给定的参数计算幅值和相位：\n电容, $C = 20\\,\\mathrm{pF} = 20 \\times 10^{-12}\\,\\mathrm{F}$。\n漏泄电导, $g_{L} = 2\\,\\mathrm{nS} = 2 \\times 10^{-9}\\,\\mathrm{S}$。\n角频率, $\\omega = 2\\pi f = 2\\pi(100)\\,\\mathrm{rad/s} = 200\\pi\\,\\mathrm{rad/s}$。\n\n首先，我们计算 $\\omega C$ 这一项：\n$$\\omega C = (200\\pi\\,\\mathrm{rad/s})(20 \\times 10^{-12}\\,\\mathrm{F}) = 4000\\pi \\times 10^{-12}\\,\\mathrm{S} = 4\\pi \\times 10^{-9}\\,\\mathrm{S}$$\n现在，我们计算阻抗的幅值：\n$$|Z(\\omega)| = \\frac{1}{\\sqrt{(2 \\times 10^{-9}\\,\\mathrm{S})^2 + (4\\pi \\times 10^{-9}\\,\\mathrm{S})^2}} = \\frac{1}{\\sqrt{4 \\times 10^{-18} + 16\\pi^2 \\times 10^{-18}}\\,\\mathrm{S}}$$\n$$|Z(\\omega)| = \\frac{1}{10^{-9}\\sqrt{4 + 16\\pi^2}}\\,\\Omega = \\frac{10^9}{2\\sqrt{1 + 4\\pi^2}}\\,\\Omega$$\n为了以兆欧（$1\\,\\mathrm{M}\\Omega = 10^6\\,\\Omega$）为单位表示结果：\n$$|Z(\\omega)| = \\frac{10^3}{2\\sqrt{1 + 4\\pi^2}}\\,\\mathrm{M}\\Omega = \\frac{500}{\\sqrt{1 + 4\\pi^2}}\\,\\mathrm{M}\\Omega$$\n对此表达式进行数值计算：\n$$|Z(\\omega)| \\approx \\frac{500}{\\sqrt{1 + 4(9.8696044)}} \\approx \\frac{500}{\\sqrt{40.4784176}} \\approx \\frac{500}{6.362265} \\approx 78.58745\\,\\mathrm{M}\\Omega$$\n四舍五入到四位有效数字，幅值为 $78.59\\,\\mathrm{M}\\Omega$。\n\n接下来，我们计算以弧度为单位的相位：\n$$\\phi(\\omega) = -\\arctan\\left(\\frac{\\omega C}{g_L}\\right) = -\\arctan\\left(\\frac{4\\pi \\times 10^{-9}\\,\\mathrm{S}}{2 \\times 10^{-9}\\,\\mathrm{S}}\\right) = -\\arctan(2\\pi)$$\n对此表达式进行数值计算：\n$$\\phi(\\omega) \\approx -\\arctan(6.283185) \\approx -1.41296\\,\\mathrm{radians}$$\n四舍五入到四位有效数字，相位为 $-1.413\\,\\mathrm{radians}$。\n\n最后，我们评论在 $\\omega = 200\\pi\\,\\mathrm{rad/s}$ 时电压幅值相对于直流 (DC; $\\omega=0$) 响应的衰减情况。直流阻抗可以通过设置 $\\omega=0$ 得到：\n$$|Z(0)| = \\frac{1}{\\sqrt{g_{L}^2 + 0}} = \\frac{1}{g_L} = \\frac{1}{2 \\times 10^{-9}\\,\\mathrm{S}} = 0.5 \\times 10^9\\,\\Omega = 500\\,\\mathrm{M}\\Omega$$\n100 Hz 时的阻抗幅值与直流阻抗之比为：\n$$\\frac{|Z(200\\pi)|}{|Z(0)|} = \\frac{78.59\\,\\mathrm{M}\\Omega}{500\\,\\mathrm{M}\\Omega} \\approx 0.157$$\n这个结果显示出显著的衰减。在 100 Hz 的频率下，电压响应的幅值仅为相同幅值的直流电流所能产生的电压响应幅值的约 15.7%。这是细胞膜作为低通滤波器的典型行为：电容器为高频电流提供了一个低阻抗通路，将其从漏泄电阻分流，从而防止在膜两端产生大的电压。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n78.59 & -1.413\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论模型只有在能够解释和预测实验数据时才具有真正的科学价值。这个综合性练习将我们带入计算神经科学和系统生物学的核心实践：参数估计。我们将模拟一个经典的电生理学实验——向细胞注入阶跃电流并记录其电压响应——然后设计并实现一个算法，从带有噪声的模拟数据中反向推算出细胞膜的电容 $C$ 和漏电导 $g_L$ 。这项实践不仅要求我们求解模型的动力学方程，还涉及非线性最小二乘法和置信区间估计等关键数据分析技术，是连接理论与实验的桥梁。",
            "id": "3900790",
            "problem": "您正在将单个等电位细胞膜的被动电学行为建模为一个由外部电流驱动的电阻-电容电路。该膜遵循 Kirchhoff 电流定律，由此可得到一个耦合膜电压和外加电流的一阶常微分方程。您将设计并实现一种数据驱动的估算方法，使用非线性最小二乘法估算膜电容和漏电导，并通过费雪信息推导置信区间。\n\n从以下符合具体情境的基本原理出发：\n- 膜的 Kirchhoff 电流定律 (KCL) 指出，电容电流和漏电流之和等于外加电流。设 $V(t)$ 表示膜电位，$C$ 表示膜电容，$g_L$ 表示漏电导，$E_L$ 表示漏电逆转（静息）电位，$I(t)$ 表示外加刺激电流。KCL 给出以下控制性常微分方程：$C \\frac{dV}{dt} = -g_L \\left(V(t) - E_L\\right) + I(t)$。\n- 假设一个分段恒定的阶跃刺激 $I(t) = I_0$（对于 $t \\ge 0$），该值已知且固定，以及一个由刺激前实验指定的初始条件 $V(0) = V_0$。\n- 在离散时间点 $\\{t_i\\}_{i=1}^{N}$ 收集测量数据，数据带有加性高斯噪声：$y_i = V(t_i) + \\epsilon_i$，其中 $\\epsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0, \\sigma^2)$。\n\n您的任务：\n1. 从第一性原理出发，推导在恒定阶跃电流 $I_0$ 和初始条件 $V(0)=V_0$ 下，上述常微分方程在 $t \\ge 0$ 时的解析瞬态解 $V(t)$。解应以 $C$、$g_L$、$E_L$、$I_0$、$t$ 和 $V_0$ 表示。\n2. 推导在高斯噪声假设下构建费雪信息所需的灵敏度函数 $\\frac{\\partial V(t)}{\\partial C}$ 和 $\\frac{\\partial V(t)}{\\partial g_L}$。\n3. 假设 $E_L$ 和 $I_0$ 已知且固定，为从含噪测量值 $\\{(t_i,y_i)\\}$ 中估算 $C$ 和 $g_L$ 构建非线性最小二乘目标函数。\n4. 实现一个程序，该程序能够：\n   - 对于每个测试用例，通过使用已知的真实参数模拟 $V(t)$ 并添加已知方差 $\\sigma^2$ 的独立高斯噪声来合成含噪测量数据。\n   - 使用非线性最小二乘法从含噪数据中联合估算 $C$ 和 $g_L$，并对 $C$ 和 $g_L$ 强制执行具有物理意义的正值约束。\n   - 在每个采样时间点噪声为独立同分布、方差为 $\\sigma^2$ 的高斯噪声的假设下，使用在估计参数处求值的已推导灵敏度函数计算费雪信息矩阵 $\\mathcal{I}(C,g_L)$。使用 $\\mathcal{I}(C,g_L) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\nabla_\\theta V(t_i) \\nabla_\\theta V(t_i)^\\top$，其中 $\\theta = [C, g_L]^\\top$。\n   - 通过费雪信息矩阵的逆来近似参数协方差矩阵，并使用正态近似返回 $95\\%$ 置信区间：对于参数 $\\theta_j$，置信区间为 $\\theta_j \\pm z_{\\alpha/2}\\sqrt{\\operatorname{Var}(\\theta_j)}$，其中对于双边水平 $\\alpha = 0.05$，$z_{\\alpha/2} = 1.96$。\n\n物理单位和输出要求：\n- 电容 $C$ 以法拉 (F) 表示，电导 $g_L$ 以西门子 (S) 表示。电压以伏特 (V) 表示，电流以安培 (A) 表示，时间以秒 (s) 表示。\n- 最终的估计值和置信区间界限必须以这些国际单位制 (SI) 单位报告。\n- 此问题不涉及角度。\n- 最终的程序输出必须是单个行，包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，该列表必须按顺序汇总：$[C_{\\text{hat}}, g_{L,\\text{hat}}, C_{\\text{lower}}, C_{\\text{upper}}, g_{L,\\text{lower}}, g_{L,\\text{upper}}]$，所有值均为 SI 单位的浮点数。最后一行必须将所有测试用例的这些组合并成一个扁平列表。\n\n测试套件：\n为以下 $4$ 种科学上真实的情景实现估算器和置信区间计算。在所有情况下，使用 $V(0) = V_0 = E_L$ 和在 $t=0$ 时施加的恒定阶跃电流 $I(t) = I_0$。对于每种情况，在区间 $[0, T]$ 上以均匀间距 $\\Delta t$ 创建采样时间 $\\{t_i\\}$。\n\n- 情况 A (理想情况):\n  - $C_{\\text{true}} = 100 \\times 10^{-12}\\ \\mathrm{F}$，\n  - $g_{L,\\text{true}} = 10 \\times 10^{-9}\\ \\mathrm{S}$，\n  - $E_L = -70 \\times 10^{-3}\\ \\mathrm{V}$，\n  - $I_0 = 100 \\times 10^{-12}\\ \\mathrm{A}$，\n  - $\\Delta t = 0.1 \\times 10^{-3}\\ \\mathrm{s}$，\n  - $T = 0.1\\ \\mathrm{s}$，\n  - $\\sigma = 0.2 \\times 10^{-3}\\ \\mathrm{V}$。\n\n- 情况 B (小电容和较高噪声):\n  - $C_{\\text{true}} = 10 \\times 10^{-12}\\ \\mathrm{F}$，\n  - $g_{L,\\text{true}} = 5 \\times 10^{-9}\\ \\mathrm{S}$，\n  - $E_L = -65 \\times 10^{-3}\\ \\mathrm{V}$，\n  - $I_0 = 50 \\times 10^{-12}\\ \\mathrm{A}$，\n  - $\\Delta t = 0.05 \\times 10^{-3}\\ \\mathrm{s}$，\n  - $T = 0.04\\ \\mathrm{s}$，\n  - $\\sigma = 0.5 \\times 10^{-3}\\ \\mathrm{V}$。\n\n- 情况 C (负电流阶跃，较大时间常数):\n  - $C_{\\text{true}} = 300 \\times 10^{-12}\\ \\mathrm{F}$，\n  - $g_{L,\\text{true}} = 30 \\times 10^{-9}\\ \\mathrm{S}$，\n  - $E_L = -68 \\times 10^{-3}\\ \\mathrm{V}$，\n  - $I_0 = -50 \\times 10^{-12}\\ \\mathrm{A}$，\n  - $\\Delta t = 0.1 \\times 10^{-3}\\ \\mathrm{s}$，\n  - $T = 0.05\\ \\mathrm{s}$，\n  - $\\sigma = 0.1 \\times 10^{-3}\\ \\mathrm{V}$。\n\n- 情况 D (粗采样边界情况，较低振幅):\n  - $C_{\\text{true}} = 80 \\times 10^{-12}\\ \\mathrm{F}$，\n  - $g_{L,\\text{true}} = 20 \\times 10^{-9}\\ \\mathrm{S}$，\n  - $E_L = -70 \\times 10^{-3}\\ \\mathrm{V}$，\n  - $I_0 = 20 \\times 10^{-12}\\ \\mathrm{A}$，\n  - $\\Delta t = 1 \\times 10^{-3}\\ \\mathrm{s}$，\n  - $T = 0.02\\ \\mathrm{s}$，\n  - $\\sigma = 0.2 \\times 10^{-3}\\ \\mathrm{V}$。\n\n实现细节：\n- 您的程序必须完全按照上述规定生成合成数据集（不读取任何外部输入），对所有四种情况执行估算和置信区间计算，并按前面描述的精确单行格式打印结果。\n- 使用适用于约束优化的非线性最小二乘求解器，以确保所有测试用例的 $C > 0$ 和 $g_L > 0$。\n- 最终输出必须是单个行，包含所有测试用例的 SI 单位浮点值的扁平列表：$[C_{\\text{hat,A}}, g_{L,\\text{hat,A}}, C_{\\text{lower,A}}, C_{\\text{upper,A}}, g_{L,\\text{lower,A}}, g_{L,\\text{upper,A}}, C_{\\text{hat,B}}, \\dots, g_{L,\\text{upper,D}}]$。",
            "solution": "该问题是有效的。它在科学上基于细胞电生理学和电路理论的原理，作为一个标准的参数估计任务，其提法是适定的，并提供了一套完整且一致的信息和约束。所有参数和实验条件在物理上都是现实的。\n\n解决方案按要求分四个阶段进行：推导膜电压的解析形式，推导用于参数估计的灵敏度函数，构建优化问题，以及概述数值解的实现。\n\n### 1. 膜电压 $V(t)$ 的解析解\n\n膜电位 $V(t)$ 的控制性常微分方程 (ODE) 由 Kirchhoff 电流定律给出：\n$$C \\frac{dV}{dt} = -g_L \\left(V(t) - E_L\\right) + I(t)$$\n这里，$C$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏电逆转电位，$I(t)$ 是外加电流。\n\n对于在 $t=0$ 时施加的恒定阶跃电流 $I(t) = I_0$，该 ODE 变为：\n$$C \\frac{dV}{dt} + g_L V(t) = g_L E_L + I_0$$\n这是一个一阶线性非齐次 ODE。我们可以将其写成标准形式 $\\frac{dV}{dt} + P V(t) = Q$：\n$$\\frac{dV}{dt} + \\frac{g_L}{C} V(t) = \\frac{g_L E_L + I_0}{C}$$\n这类方程的解的形式为 $V(t) = V_{\\infty} + (V(0) - V_{\\infty}) e^{-t/\\tau}$，其中 $\\tau$ 是时间常数，$V_{\\infty}$ 是稳态电压。\n\n系统的时间常数由 $V(t)$ 项的系数确定：\n$$\\tau = \\frac{C}{g_L}$$\n稳态电压 $V_{\\infty}$ 通过设置 $\\frac{dV}{dt} = 0$ 找到：\n$$0 = -g_L (V_{\\infty} - E_L) + I_0 \\implies g_L V_{\\infty} = g_L E_L + I_0 \\implies V_{\\infty} = E_L + \\frac{I_0}{g_L}$$\n因此，对于初始条件 $V(0) = V_0$ 的通解是：\n$$V(t) = \\left(E_L + \\frac{I_0}{g_L}\\right) + \\left(V_0 - E_L - \\frac{I_0}{g_L}\\right) e^{-g_L t/C}$$\n问题指定所有测试用例的初始条件为 $V(0) = V_0 = E_L$。将此代入通解可以简化表达式：\n$$V(t) = \\left(E_L + \\frac{I_0}{g_L}\\right) + \\left(E_L - E_L - \\frac{I_0}{g_L}\\right) e^{-g_L t/C}$$\n$$V(t) = E_L + \\frac{I_0}{g_L} - \\frac{I_0}{g_L} e^{-g_L t/C}$$\n提出因子 $\\frac{I_0}{g_L}$ 得到最终的解析解：\n$$V(t) = E_L + \\frac{I_0}{g_L} \\left(1 - e^{-g_L t/C}\\right)$$\n\n### 2. 灵敏度函数的推导\n\n待估计的参数为 $\\theta = [C, g_L]^\\top$。灵敏度函数是模型电压 $V(t)$ 对这些参数的偏导数。这些导数是构建非线性最小二乘法中使用的雅可比矩阵以及计算费雪信息矩阵所必需的。\n\n**对电容 ($C$) 的灵敏度：**\n我们将 $V(t)$ 对 $C$ 求导，并将所有其他变量视为常数。\n$$\\frac{\\partial V(t)}{\\partial C} = \\frac{\\partial}{\\partial C} \\left[ E_L + \\frac{I_0}{g_L} \\left(1 - e^{-g_L t/C}\\right) \\right]$$\n$$= \\frac{I_0}{g_L} \\frac{\\partial}{\\partial C} \\left( -e^{-g_L t C^{-1}} \\right)$$\n使用链式法则，指数的导数为 $\\frac{\\partial}{\\partial C}(-g_L t C^{-1}) = -g_L t (-1)C^{-2} = \\frac{g_L t}{C^2}$：\n$$\\frac{\\partial V(t)}{\\partial C} = \\frac{I_0}{g_L} \\left( -e^{-g_L t/C} \\cdot \\left(\\frac{g_L t}{C^2}\\right) \\right)$$\n$$\\frac{\\partial V(t)}{\\partial C} = -\\frac{I_0 t}{C^2} e^{-g_L t/C}$$\n\n**对漏电导 ($g_L$) 的灵敏度：**\n我们将 $V(t)$ 对 $g_L$ 求导。首先展开 $V(t)$ 的表达式会很有帮助：\n$$V(t) = E_L + \\frac{I_0}{g_L} - \\frac{I_0}{g_L} e^{-g_L t/C}$$\n$$\\frac{\\partial V(t)}{\\partial g_L} = \\frac{\\partial}{\\partial g_L} \\left[ E_L + I_0 g_L^{-1} - I_0 g_L^{-1} e^{-g_L t/C} \\right]$$\n我们对第一项应用幂法则，对第二项应用乘积法则：\n$$\\frac{\\partial V(t)}{\\partial g_L} = -I_0 g_L^{-2} - I_0 \\left[ (-g_L^{-2}) e^{-g_L t/C} + g_L^{-1} \\left( e^{-g_L t/C} \\cdot \\left(-\\frac{t}{C}\\right) \\right) \\right]$$\n$$= -\\frac{I_0}{g_L^2} - \\left[ -\\frac{I_0}{g_L^2} e^{-g_L t/C} - \\frac{I_0 t}{g_L C} e^{-g_L t/C} \\right]$$\n$$= -\\frac{I_0}{g_L^2} + \\frac{I_0}{g_L^2} e^{-g_L t/C} + \\frac{I_0 t}{g_L C} e^{-g_L t/C}$$\n合并各项得到灵敏度的最终表达式：\n$$\\frac{\\partial V(t)}{\\partial g_L} = \\frac{I_0}{g_L^2} \\left( e^{-g_L t/C} - 1 \\right) + \\frac{I_0 t}{g_L C} e^{-g_L t/C}$$\n\n### 3. 非线性最小二乘目标函数\n\n目标是找到参数估计值 $\\hat{\\theta} = [\\hat{C}, \\hat{g}_L]^\\top$，使模型与含噪测量值 $\\{(t_i, y_i)\\}_{i=1}^{N}$ 最佳拟合。这通过最小化残差平方和 (SSR) 来实现。第 $i$ 个测量值的残差是观测值 $y_i$ 与模型预测值 $V(t_i; C, g_L)$ 之间的差：\n$$r_i(C, g_L) = y_i - V(t_i; C, g_L)$$\n目标函数 $S(C, g_L)$ 是这些残差的平方和：\n$$S(C, g_L) = \\sum_{i=1}^{N} r_i(C, g_L)^2 = \\sum_{i=1}^{N} \\left( y_i - \\left( E_L + \\frac{I_0}{g_L} \\left(1 - e^{-g_L t_i/C}\\right) \\right) \\right)^2$$\n参数估计值通过解决以下约束最小化问题找到：\n$$(\\hat{C}, \\hat{g}_L) = \\arg\\min_{C > 0, g_L > 0} S(C, g_L)$$\n正值约束 $C > 0$ 和 $g_L > 0$ 在物理上是必要的。\n\n### 4. 实现与置信区间计算\n\n数值实现将对每个测试用例执行以下步骤：\n1.  **合成数据**：生成时间向量 $\\{t_i\\}$，并使用推导的解析解和真实参数计算真实电压 $V(t_i)$。添加具有指定标准差 $\\sigma$ 的高斯噪声，以创建含噪测量值 $\\{y_i\\}$。\n2.  **估计参数**：使用一个约束非线性最小二乘求解器（`scipy.optimize.least_squares`）来找到最小化 SSR 的 $\\hat{C}$ 和 $\\hat{g}_L$ 的值。将步骤2中推导的解析雅可比矩阵提供给求解器，以提高准确性和收敛速度。参数的初始猜测值将从数据中推导，以确保鲁棒性。\n3.  **计算费雪信息矩阵 (FIM)**：在估计参数 $\\hat{\\theta} = [\\hat{C}, \\hat{g}_L]^\\top$ 处计算 FIM $\\mathcal{I}$。它由 $\\mathcal{I}(\\hat{\\theta}) = \\frac{1}{\\sigma^2} J^\\top J$ 给出，其中 $J$ 是模型输出相对于参数的雅可比矩阵，其元素为 $J_{ij} = \\frac{\\partial V(t_i)}{\\partial \\theta_j}|_{\\hat{\\theta}}$。\n4.  **计算置信区间**：估计值的协方差矩阵通过 FIM 的逆来近似：$\\operatorname{Cov}(\\hat{\\theta}) \\approx \\mathcal{I}^{-1}$。单个参数估计值的方差 $\\operatorname{Var}(\\hat{C})$ 和 $\\operatorname{Var}(\\hat{g}_L)$ 是该协方差矩阵的对角元素。每个参数的标准误差是其方差的平方根。然后使用正态近似计算参数 $\\hat{\\theta}_j$ 的 $95\\%$ 置信区间：\n    $$\\text{CI}_{95\\%} = \\hat{\\theta}_j \\pm 1.96 \\cdot \\sqrt{\\operatorname{Var}(\\hat{\\theta}_j)}$$\n此过程提供了点估计值 $(\\hat{C}, \\hat{g}_L)$ 及其不确定性的度量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Main function to run the parameter estimation and confidence interval\n    calculation for all test cases.\n    \"\"\"\n    # Set a random seed for reproducibility of synthetic data.\n    np.random.seed(42)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"C_true\": 100e-12, \"gL_true\": 10e-9, \"EL\": -70e-3, \"I0\": 100e-12,\n            \"dt\": 0.1e-3, \"T\": 0.1, \"sigma\": 0.2e-3\n        },\n        # Case B (small capacitance and higher noise)\n        {\n            \"C_true\": 10e-12, \"gL_true\": 5e-9, \"EL\": -65e-3, \"I0\": 50e-12,\n            \"dt\": 0.05e-3, \"T\": 0.04, \"sigma\": 0.5e-3\n        },\n        # Case C (negative current step, larger time constant)\n        {\n            \"C_true\": 300e-12, \"gL_true\": 30e-9, \"EL\": -68e-3, \"I0\": -50e-12,\n            \"dt\": 0.1e-3, \"T\": 0.05, \"sigma\": 0.1e-3\n        },\n        # Case D (coarse sampling boundary case, lower amplitude)\n        {\n            \"C_true\": 80e-12, \"gL_true\": 20e-9, \"EL\": -70e-3, \"I0\": 20e-12,\n            \"dt\": 1e-3, \"T\": 0.02, \"sigma\": 0.2e-3\n        }\n    ]\n\n    all_results = []\n\n    # Model voltage function\n    def model_v(t, C, gL, EL, I0):\n        # Handle gL -> 0 case to avoid division by zero and use L'Hopital's rule limit\n        if np.abs(gL) < 1e-15:\n            return EL + (I0 * t) / C\n        \n        # Handle C -> 0 case\n        if np.abs(C) < 1e-18:\n             v_inf = EL + I0 / gL\n             return np.full_like(t, v_inf)\n        \n        tau = C / gL\n        v_inf = EL + I0 / gL\n        # With V0=EL\n        return v_inf + (EL - v_inf) * np.exp(-t / tau)\n\n\n    # Residual function for least_squares\n    def residuals(params, t, y, EL, I0):\n        C, gL = params\n        return y - model_v(t, C, gL, EL, I0)\n\n    # Analytical Jacobian of the residuals\n    def jacobian(params, t, y, EL, I0):\n        C, gL = params\n        \n        # Guard against invalid parameter values passed by the solver\n        if C <= 0 or gL <= 0:\n            return np.full((len(t), 2), np.inf)\n\n        # Exponential term, common in both derivatives\n        exp_term = np.exp(-gL * t / C)\n\n        # Partial derivative of V with respect to C\n        dV_dC = - (I0 * t / C**2) * exp_term\n\n        # Partial derivative of V with respect to gL\n        # Handle gL -> 0 case for the derivative\n        if gL < 1e-15:\n            dV_dgL = (I0 * t**2 / (2 * C**2)) * exp_term # From Taylor expansion\n        else:\n            dV_dgL = (I0 / gL**2) * (exp_term - 1) + (I0 * t / (gL * C)) * exp_term\n        \n        # The jacobian of the residuals is the negative of the jacobian of the model\n        return -np.vstack((dV_dC, dV_dgL)).T\n\n    for case in test_cases:\n        C_true, gL_true, EL, I0, dt, T, sigma = case.values()\n        \n        t_eval = np.arange(0, T, dt)\n        if t_eval.size == 0: t_eval = np.array([0, T-dt]) # Ensure at least 2 points for coarse sampling\n            \n        V_true = model_v(t_eval, C_true, gL_true, EL, I0)\n        noise = np.random.normal(0, sigma, size=len(t_eval))\n        y_obs = V_true + noise\n\n        # --- Initial Guess Strategy ---\n        # Estimate steady state from last 20% of data\n        ss_idx = int(0.8 * len(y_obs))\n        V_ss_obs = np.mean(y_obs[ss_idx:]) if len(y_obs) > 5 else y_obs[-1]\n        \n        # Initial guess for gL\n        if np.abs(V_ss_obs - EL) < 1e-6:\n             gL_0 = 1e-9 # Fallback if denominator is zero\n        else:\n             gL_0 = I0 / (V_ss_obs - EL)\n        if gL_0 <= 0: gL_0 = 1e-9 # Ensure positivity\n        \n        # Initial guess for C from time constant\n        V_change_total = V_ss_obs - EL\n        if np.abs(V_change_total) < 1e-6:\n            tau_0 = T/4 # Fallback\n        else:\n            V_63_percent = EL + (1 - 1/np.e) * V_change_total\n            # Find time to reach 63%\n            if I0 > 0:\n                try:\n                    tau_idx = np.where(y_obs >= V_63_percent)[0][0]\n                    tau_0 = t_eval[tau_idx]\n                except IndexError:\n                    tau_0 = T/4 # Fallback if not reached\n            else: # I0 < 0\n                try:\n                    tau_idx = np.where(y_obs <= V_63_percent)[0][0]\n                    tau_0 = t_eval[tau_idx]\n                except IndexError:\n                    tau_0 = T/4 # Fallback\n        \n        C_0 = tau_0 * gL_0\n        if C_0 <= 0: C_0 = 1e-12 # Ensure positivity\n\n        initial_params = [C_0, gL_0]\n\n        # --- Nonlinear Least Squares Estimation ---\n        bounds = ((1e-15, 1e-12), (np.inf, np.inf)) # Strict positive bounds\n        \n        result = least_squares(\n            residuals,\n            initial_params,\n            jac=jacobian,\n            bounds=bounds,\n            args=(t_eval, y_obs, EL, I0),\n            method='trf'\n        )\n\n        C_hat, gL_hat = result.x\n\n        # --- Confidence Interval Calculation ---\n        # Get Jacobian of the model at the estimated parameters\n        # least_squares returns Jacobian of residuals, so we negate it.\n        J_V = -result.jac\n\n        # Fisher Information Matrix\n        FIM = (1 / sigma**2) * (J_V.T @ J_V)\n\n        try:\n            # Covariance matrix is the inverse of the FIM\n            cov_matrix = np.linalg.inv(FIM)\n            # Variances are the diagonal elements\n            param_variances = np.diag(cov_matrix)\n            \n            # Check for numerical issues (e.g., non-positive variance)\n            if np.any(param_variances < 0):\n                raise np.linalg.LinAlgError(\"Negative variance encountered.\")\n\n            # Standard errors\n            std_errors = np.sqrt(param_variances)\n            \n            # 95% CI (z_alpha/2 = 1.96)\n            z_score = 1.96\n            C_se, gL_se = std_errors\n            \n            C_lower = C_hat - z_score * C_se\n            C_upper = C_hat + z_score * C_se\n            gL_lower = gL_hat - z_score * gL_se\n            gL_upper = gL_hat + z_score * gL_se\n            \n        except np.linalg.LinAlgError:\n            # If FIM is singular or other errors, CIs are not well-defined\n            C_lower, C_upper, gL_lower, gL_upper = [np.nan] * 4\n\n        case_results = [C_hat, gL_hat, C_lower, C_upper, gL_lower, gL_upper]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}