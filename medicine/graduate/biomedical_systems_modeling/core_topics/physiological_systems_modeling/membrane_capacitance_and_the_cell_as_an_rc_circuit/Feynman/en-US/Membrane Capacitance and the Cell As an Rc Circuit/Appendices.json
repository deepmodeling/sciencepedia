{
    "hands_on_practices": [
        {
            "introduction": "This practice connects the abstract concept of capacitance to the physical structure of the cell membrane. By modeling the lipid bilayer as a parallel-plate capacitor, you will derive the capacitance from electrostatic first principles. This exercise  grounds the 'C' in the RC circuit model in tangible biophysical properties like membrane thickness and dielectric constant, providing a crucial link between cellular structure and electrical function.",
            "id": "3900803",
            "problem": "A cell membrane patch can be modeled as the capacitor element in a resistor-capacitor (RC) circuit, where the bilayer acts as a uniform, linear dielectric between two conducting ionic reservoirs. Consider a planar membrane patch of area $A$ with thickness $d$ and relative permittivity (dielectric constant) $\\epsilon_{r}$. Assume the following biophysically plausible conditions: the membrane interior contains no free charge, the ionic solutions act as perfect conductors, and the patch geometry satisfies $A \\gg d^{2}$ so that fringing fields are negligible over the area of interest.\n\nStarting from first principles of electrostatics—namely Gauss’s law in matter and the definition of capacitance—derive the expression for the membrane capacitance $C$ in terms of $A$, $d$, and $\\epsilon_{r}$. Then, using the typical values $\\epsilon_{r} \\approx 2$, $d \\approx 5\\,\\mathrm{nm}$, and $A = 10^{-5}\\,\\mathrm{cm^{2}}$, compute $C$ and compare it to the empirical specific capacitance of biomembranes, which is approximately $1\\,\\mathrm{\\mu F/cm^{2}}$. Define the dimensionless consistency metric\n$$R \\equiv \\frac{C}{A \\times (1\\,\\mathrm{\\mu F/cm^{2}})}$$\nand report $R$ as the final answer. Express $C$ in farads, use the International System of Units (SI) for all intermediate calculations, and round the final value of $R$ to four significant figures.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of electrostatics and standard biophysical modeling, well-posed with a clear objective and sufficient data, and formulated with objective, unambiguous language. The given values are biophysically plausible, and the task involves a standard derivation and calculation.\n\nThe solution proceeds in three parts as requested: first, the derivation of the capacitance formula; second, the numerical calculation of the capacitance $C$; and third, the calculation of the dimensionless consistency metric $R$.\n\n**Part 1: Derivation of Membrane Capacitance**\n\nWe model the cell membrane patch as a parallel-plate capacitor of area $A$ and plate separation $d$. The space between the conducting plates (ionic solutions) is filled with a uniform, linear dielectric material (the lipid bilayer) with relative permittivity $\\epsilon_r$. The capacitance $C$ is defined as the ratio of the magnitude of the free charge $Q$ on one conductor to the magnitude of the potential difference $|\\Delta V|$ between the conductors:\n$$C \\equiv \\frac{Q}{|\\Delta V|}$$\nTo find an expression for $C$ in terms of the geometric and material properties, we must relate $Q$ and $|\\Delta V|$.\n\nWe begin with Gauss's law for the electric displacement field $\\vec{D}$ in a dielectric medium:\n$$\\oint_S \\vec{D} \\cdot d\\vec{a} = Q_{\\text{free, encl}}$$\nwhere $Q_{\\text{free, encl}}$ is the free charge enclosed by the Gaussian surface $S$. Let the plates be oriented parallel to the $xy$-plane. We place a cylindrical Gaussian surface with its top cap of area $a$ inside the dielectric, just below the top conducting plate, and its bottom cap inside the conductor itself, where the electric field is zero. By symmetry, the electric displacement field $\\vec{D}$ is uniform and perpendicular to the plates, pointing in the $z$-direction ($\\vec{D} = D \\hat{k}$). The flux through the side walls of the cylinder is zero. The flux through the bottom cap is zero because $\\vec{D} = 0$ inside the perfect conductor. The only non-zero contribution to the integral is from the top cap.\nThus, Gauss's law simplifies to $D \\cdot a = Q_{\\text{free, encl}}$. The enclosed free charge is the charge on the area $a$ of the plate, which is $\\sigma a$, where $\\sigma = Q/A$ is the uniform surface charge density.\n$$D a = \\sigma a \\implies D = \\sigma = \\frac{Q}{A}$$\nFor a linear, isotropic dielectric, the electric displacement $\\vec{D}$ is related to the electric field $\\vec{E}$ by $\\vec{D} = \\epsilon \\vec{E}$, where $\\epsilon$ is the permittivity of the material. The permittivity is given by $\\epsilon = \\epsilon_r \\epsilon_0$, where $\\epsilon_r$ is the relative permittivity and $\\epsilon_0$ is the permittivity of free space.\nThus, the magnitude of the electric field $E$ inside the dielectric is:\n$$E = \\frac{D}{\\epsilon_r \\epsilon_0} = \\frac{Q}{A \\epsilon_r \\epsilon_0}$$\nSince the problem assumes $A \\gg d^2$, fringing fields are negligible, and the electric field $E$ is uniform throughout the dielectric. The potential difference $|\\Delta V|$ between the plates is found by integrating the electric field over the distance $d$:\n$$|\\Delta V| = \\left| -\\int_{0}^{d} \\vec{E} \\cdot d\\vec{l} \\right| = E d$$\nSubstituting the expression for $E$:\n$$|\\Delta V| = \\frac{Qd}{A \\epsilon_r \\epsilon_0}$$\nFinally, we substitute this expression for $|\\Delta V|$ back into the definition of capacitance:\n$$C = \\frac{Q}{|\\Delta V|} = \\frac{Q}{\\frac{Qd}{A \\epsilon_r \\epsilon_0}}$$\nThis gives the desired expression for the capacitance of the membrane patch:\n$$C = \\frac{\\epsilon_r \\epsilon_0 A}{d}$$\n\n**Part 2: Numerical Calculation of Capacitance $C$**\n\nWe are given the following values:\n-   Relative permittivity: $\\epsilon_r = 2$\n-   Membrane thickness: $d = 5 \\, \\mathrm{nm}$\n-   Patch area: $A = 10^{-5} \\, \\mathrm{cm^2}$\n\nWe use the value for the permittivity of free space, $\\epsilon_0 \\approx 8.854 \\times 10^{-12} \\, \\mathrm{F/m}$.\nFor consistency, all values must be converted to the International System of Units (SI).\n$$d = 5 \\, \\mathrm{nm} = 5 \\times 10^{-9} \\, \\mathrm{m}$$\n$$A = 10^{-5} \\, \\mathrm{cm^2} = 10^{-5} \\times (10^{-2} \\, \\mathrm{m})^2 = 10^{-5} \\times 10^{-4} \\, \\mathrm{m^2} = 10^{-9} \\, \\mathrm{m^2}$$\nNow, we substitute these values into the derived formula for $C$:\n$$C = \\frac{(2) \\times (8.854 \\times 10^{-12} \\, \\mathrm{F/m}) \\times (10^{-9} \\, \\mathrm{m^2})}{5 \\times 10^{-9} \\, \\mathrm{m}}$$\n$$C = \\frac{2 \\times 8.854 \\times 10^{-12} \\times 10^{-9}}{5 \\times 10^{-9}} \\, \\mathrm{F}$$\n$$C = \\frac{17.708 \\times 10^{-21}}{5 \\times 10^{-9}} \\, \\mathrm{F}$$\n$$C = 3.5416 \\times 10^{-12} \\, \\mathrm{F}$$\n\n**Part 3: Calculation of the Consistency Metric $R$**\n\nThe dimensionless consistency metric $R$ is defined as:\n$$R \\equiv \\frac{C}{A \\times (1\\,\\mathrm{\\mu F/cm^{2}})}$$\nThe term in the denominator represents the expected capacitance based on the empirical specific capacitance of $1\\,\\mathrm{\\mu F/cm^{2}}$. Let's calculate its value.\n-   $A = 10^{-5}\\,\\mathrm{cm^{2}}$\n-   $1\\,\\mathrm{\\mu F/cm^{2}} = 1 \\times 10^{-6}\\,\\mathrm{F/cm^{2}}$\n\nDenominator = $(10^{-5}\\,\\mathrm{cm^{2}}) \\times (1 \\times 10^{-6}\\,\\mathrm{F/cm^{2}}) = 1 \\times 10^{-11}\\,\\mathrm{F}$.\n\nNow we can calculate $R$ using the value of $C$ we computed in Part 2:\n$$R = \\frac{3.5416 \\times 10^{-12} \\, \\mathrm{F}}{1 \\times 10^{-11} \\, \\mathrm{F}}$$\n$$R = 0.35416$$\nThe problem requires the final value of $R$ to be rounded to four significant figures.\n$$R \\approx 0.3542$$\nThis result indicates that the capacitance calculated from the simple parallel-plate model with the given typical parameters is about $35\\%$ of the empirically measured value. The discrepancy arises because the values for $\\epsilon_r$ and $d$ are approximations, and the real membrane structure is more complex than a uniform dielectric slab.",
            "answer": "$$\\boxed{0.3542}$$"
        },
        {
            "introduction": "Having established the physical basis for capacitance, we now explore the dynamic behavior of the membrane when modeled as a complete RC circuit. This exercise introduces the powerful concept of complex impedance, $Z(\\omega)$, to analyze how the membrane responds to sinusoidal inputs of different frequencies. By calculating impedance magnitude and phase, you will uncover the membrane's fundamental role as a low-pass filter, a property that shapes all electrical signaling in the nervous system .",
            "id": "3900816",
            "problem": "A single-compartment cell membrane is modeled as a parallel Resistive–Capacitive (RC) circuit, consisting of a leak pathway with leak conductance $g_{L}$ and a membrane capacitance $C$. Under small-signal sinusoidal stimulation, a current $i(t)$ drives a voltage response $v(t)$ that is well approximated by linear time-invariant dynamics. Assume a sinusoidal drive $i(t)$ at angular frequency $\\omega$ and define the complex impedance $Z(\\omega)$ by the ratio of the complex voltage to complex current in steady state.\n\nStarting from fundamental relations for the two elements in parallel—namely, the capacitor current law $i_{C}(t)=C\\,\\frac{dv}{dt}$ and the ohmic leak law $i_{L}(t)=g_{L}\\,v(t)$—and applying Kirchhoff’s current law at the membrane, derive $Z(\\omega)$ and from it the magnitude $\\left|Z(\\omega)\\right|$ and the phase $\\phi(\\omega)$ that relates voltage to current. Then evaluate these at $\\omega=2\\pi\\times 100\\,\\mathrm{Hz}$ for $C=20\\,\\mathrm{pF}$ and $g_{L}=2\\,\\mathrm{nS}$. Express the impedance magnitude in megaohms and the phase in radians. Round your answer to four significant figures.\n\nFinally, based on your result, briefly comment on the expected attenuation of the voltage amplitude at $\\omega=2\\pi\\times 100\\,\\mathrm{Hz}$ relative to the direct current (DC; $\\omega=0$) response within this model.",
            "solution": "The problem statement is assessed to be valid as it is scientifically grounded, self-contained, and well-posed. The model of a cell membrane as a parallel RC circuit is a standard and fundamental concept in biophysics and biomedical engineering. All parameters and principles required for the solution are provided.\n\nWe begin by applying Kirchhoff’s current law (KCL) to the parallel circuit. The total current injected, $i(t)$, must equal the sum of the currents flowing through the individual components: the leak pathway (a resistor with conductance $g_L$) and the membrane capacitance ($C$).\n$$i(t) = i_{L}(t) + i_{C}(t)$$\nThe currents through the leak conductance and the capacitor are given by the ohmic leak law, $i_{L}(t) = g_{L}v(t)$, and the capacitor current law, $i_{C}(t) = C\\frac{dv(t)}{dt}$, respectively. Substituting these into the KCL equation yields the governing first-order linear ordinary differential equation for the membrane voltage $v(t)$:\n$$i(t) = g_{L}v(t) + C\\frac{dv(t)}{dt}$$\nTo analyze the circuit's response to a sinusoidal input current at a specific angular frequency $\\omega$, we transition to the frequency domain using phasor analysis. We represent the sinusoidal current and voltage as the real parts of complex exponentials: $i(t) = \\Re\\{\\tilde{I}e^{j\\omega t}\\}$ and $v(t) = \\Re\\{\\tilde{V}e^{j\\omega t}\\}$, where $\\tilde{I}$ and $\\tilde{V}$ are the complex phasors for current and voltage. The time derivative in the phasor domain becomes multiplication by $j\\omega$: $\\frac{d}{dt} \\to j\\omega$.\n\nSubstituting these into the differential equation gives:\n$$\\tilde{I} = g_{L}\\tilde{V} + C(j\\omega\\tilde{V})$$\nFactoring out $\\tilde{V}$:\n$$\\tilde{I} = (g_{L} + j\\omega C)\\tilde{V}$$\nThe complex impedance, $Z(\\omega)$, is defined as the ratio of the complex voltage phasor to the complex current phasor:\n$$Z(\\omega) = \\frac{\\tilde{V}}{\\tilde{I}} = \\frac{1}{g_{L} + j\\omega C}$$\nTo find the magnitude $|Z(\\omega)|$ and phase $\\phi(\\omega)$, we express $Z(\\omega)$ in polar form. The magnitude is the modulus of the complex number:\n$$|Z(\\omega)| = \\left|\\frac{1}{g_{L} + j\\omega C}\\right| = \\frac{|1|}{|g_{L} + j\\omega C|} = \\frac{1}{\\sqrt{g_{L}^2 + (\\omega C)^2}}$$\nThe phase $\\phi(\\omega)$ is the argument of the complex number $Z(\\omega)$:\n$$\\phi(\\omega) = \\arg(Z(\\omega)) = \\arg(1) - \\arg(g_{L} + j\\omega C) = 0 - \\arctan\\left(\\frac{\\omega C}{g_L}\\right)$$\n$$\\phi(\\omega) = -\\arctan\\left(\\frac{\\omega C}{g_L}\\right)$$\nThe negative phase indicates that the voltage response $v(t)$ lags behind the current drive $i(t)$.\n\nWe are asked to evaluate the magnitude and phase for the given parameters:\nCapacitance, $C = 20\\,\\mathrm{pF} = 20 \\times 10^{-12}\\,\\mathrm{F}$.\nLeak conductance, $g_{L} = 2\\,\\mathrm{nS} = 2 \\times 10^{-9}\\,\\mathrm{S}$.\nAngular frequency, $\\omega = 2\\pi f = 2\\pi(100)\\,\\mathrm{rad/s} = 200\\pi\\,\\mathrm{rad/s}$.\n\nFirst, we calculate the term $\\omega C$:\n$$\\omega C = (200\\pi\\,\\mathrm{rad/s})(20 \\times 10^{-12}\\,\\mathrm{F}) = 4000\\pi \\times 10^{-12}\\,\\mathrm{S} = 4\\pi \\times 10^{-9}\\,\\mathrm{S}$$\nNow, we compute the magnitude of the impedance:\n$$|Z(\\omega)| = \\frac{1}{\\sqrt{(2 \\times 10^{-9}\\,\\mathrm{S})^2 + (4\\pi \\times 10^{-9}\\,\\mathrm{S})^2}} = \\frac{1}{\\sqrt{4 \\times 10^{-18} + 16\\pi^2 \\times 10^{-18}}\\,\\mathrm{S}}$$\n$$|Z(\\omega)| = \\frac{1}{10^{-9}\\sqrt{4 + 16\\pi^2}}\\,\\Omega = \\frac{10^9}{2\\sqrt{1 + 4\\pi^2}}\\,\\Omega$$\nTo express the result in megaohms ($1\\,\\mathrm{M}\\Omega = 10^6\\,\\Omega$):\n$$|Z(\\omega)| = \\frac{10^3}{2\\sqrt{1 + 4\\pi^2}}\\,\\mathrm{M}\\Omega = \\frac{500}{\\sqrt{1 + 4\\pi^2}}\\,\\mathrm{M}\\Omega$$\nNumerically evaluating this expression:\n$$|Z(\\omega)| \\approx \\frac{500}{\\sqrt{1 + 4(9.8696044)}} \\approx \\frac{500}{\\sqrt{40.4784176}} \\approx \\frac{500}{6.362265} \\approx 78.58745\\,\\mathrm{M}\\Omega$$\nRounding to four significant figures, the magnitude is $78.59\\,\\mathrm{M}\\Omega$.\n\nNext, we compute the phase in radians:\n$$\\phi(\\omega) = -\\arctan\\left(\\frac{\\omega C}{g_L}\\right) = -\\arctan\\left(\\frac{4\\pi \\times 10^{-9}\\,\\mathrm{S}}{2 \\times 10^{-9}\\,\\mathrm{S}}\\right) = -\\arctan(2\\pi)$$\nNumerically evaluating this expression:\n$$\\phi(\\omega) \\approx -\\arctan(6.283185) \\approx -1.41296\\,\\mathrm{radians}$$\nRounding to four significant figures, the phase is $-1.413\\,\\mathrm{radians}$.\n\nFinally, we comment on the attenuation of the voltage amplitude at $\\omega = 200\\pi\\,\\mathrm{rad/s}$ relative to the direct current (DC; $\\omega=0$) response. The DC impedance is found by setting $\\omega=0$:\n$$|Z(0)| = \\frac{1}{\\sqrt{g_{L}^2 + 0}} = \\frac{1}{g_L} = \\frac{1}{2 \\times 10^{-9}\\,\\mathrm{S}} = 0.5 \\times 10^9\\,\\Omega = 500\\,\\mathrm{M}\\Omega$$\nThe ratio of the impedance magnitude at $100\\,\\mathrm{Hz}$ to the DC impedance is:\n$$\\frac{|Z(200\\pi)|}{|Z(0)|} = \\frac{78.59\\,\\mathrm{M}\\Omega}{500\\,\\mathrm{M}\\Omega} \\approx 0.157$$\nThis result shows significant attenuation. At a frequency of $100\\,\\mathrm{Hz}$, the amplitude of the voltage response is only about $15.7\\%$ of what it would be for a DC current of the same amplitude. This is a characteristic behavior of the cell membrane acting as a low-pass filter: the capacitor provides a low-impedance pathway for high-frequency currents, shunting them away from the leak resistance and thus preventing a large voltage from developing across the membrane.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n78.59 & -1.413\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The ultimate test of a model is its ability to explain experimental observations. This comprehensive practice challenges you to bridge theory and data by developing a method to estimate membrane capacitance $C$ and leak conductance $g_L$ from a noisy voltage recording . You will use the analytical solution of the RC circuit's step response and principles of statistical inference to not only fit the model but also to quantify the uncertainty in your estimates, a critical skill in quantitative biology.",
            "id": "3900790",
            "problem": "You are modeling the passive electrical behavior of a single isopotential cell membrane as a resistor-capacitor circuit driven by an external current. The membrane obeys Kirchhoff’s current law, which yields a first-order ordinary differential equation coupling the membrane voltage and applied current. You will design and implement a data-driven estimation method for membrane capacitance and leak conductance using nonlinear least squares, and derive confidence intervals via the Fisher information.\n\nStart from the following context-appropriate fundamental base:\n- Kirchhoff’s current law (KCL) for the membrane states that the sum of capacitive current and leak current equals the applied current. Let $V(t)$ denote the membrane potential, $C$ the membrane capacitance, $g_L$ the leak conductance, $E_L$ the leak reversal (resting) potential, and $I(t)$ the applied stimulus current. KCL gives the governing ordinary differential equation $C \\frac{dV}{dt} = -g_L \\left(V(t) - E_L\\right) + I(t)$.\n- Assume a piecewise constant step stimulus $I(t) = I_0$ for $t \\ge 0$, known and fixed, and an initial condition $V(0) = V_0$ specified by the experiment prior to stimulation.\n- Measurements are collected at discrete times $\\{t_i\\}_{i=1}^{N}$ with additive Gaussian noise: $y_i = V(t_i) + \\epsilon_i$, where $\\epsilon_i \\overset{\\text{i.i.d.}}{\\sim} \\mathcal{N}(0, \\sigma^2)$.\n\nYour tasks:\n1. Derive from first principles the analytical transient solution $V(t)$ for $t \\ge 0$ for the above ordinary differential equation under a constant step current $I_0$ and initial condition $V(0)=V_0$. Express the solution in terms of $C$, $g_L$, $E_L$, $I_0$, $t$, and $V_0$.\n2. Derive the sensitivity functions $\\frac{\\partial V(t)}{\\partial C}$ and $\\frac{\\partial V(t)}{\\partial g_L}$ needed to construct the Fisher information under the Gaussian noise assumption.\n3. Formulate the nonlinear least squares objective for estimating $C$ and $g_L$ from noisy measurements $\\{(t_i,y_i)\\}$, assuming $E_L$ and $I_0$ are known and fixed.\n4. Implement a program that:\n   - Synthesizes noisy measurements by simulating $V(t)$ with known ground-truth parameters for each test case and adding independent Gaussian noise with known variance $\\sigma^2$.\n   - Uses nonlinear least squares to estimate $C$ and $g_L$ jointly from the noisy data, enforcing physically meaningful positivity constraints on $C$ and $g_L$.\n   - Computes the Fisher information matrix $\\mathcal{I}(C,g_L)$ using the derived sensitivity functions evaluated at the estimated parameters, with the assumption of independent, identically distributed Gaussian noise of variance $\\sigma^2$ at each sample time. Use $\\mathcal{I}(C,g_L) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\nabla_\\theta V(t_i) \\nabla_\\theta V(t_i)^\\top$ with $\\theta = [C, g_L]^\\top$.\n   - Approximates the parameter covariance matrix by the inverse of the Fisher information matrix, and returns $95\\%$ confidence intervals using the normal approximation: for parameter $\\theta_j$, the confidence interval is $\\theta_j \\pm z_{\\alpha/2}\\sqrt{\\operatorname{Var}(\\theta_j)}$ with $z_{\\alpha/2} = 1.96$ for a two-sided level $\\alpha = 0.05$.\n\nPhysical units and output requirements:\n- Express capacitance $C$ in farads (F) and conductance $g_L$ in siemens (S). Express voltage in volts (V), current in amperes (A), time in seconds (s).\n- The final estimates and confidence interval bounds must be reported in these International System of Units (SI).\n- Angles are not involved in this problem.\n- The final program output must be a single line containing a comma-separated list enclosed in square brackets. The list must aggregate, in order, for each test case: $[C_{\\text{hat}}, g_{L,\\text{hat}}, C_{\\text{lower}}, C_{\\text{upper}}, g_{L,\\text{lower}}, g_{L,\\text{upper}}]$ with all values as floating-point numbers in SI units. The final line must concatenate these groups for all test cases into one flat list.\n\nTest suite:\nImplement the estimator and confidence interval computation for the following $4$ scientifically realistic scenarios. In all cases, use $V(0) = V_0 = E_L$ and a constant step $I(t) = I_0$ applied at $t = 0$. For each case, create sampling times $\\{t_i\\}$ over the interval $[0, T]$ with uniform spacing $\\Delta t$.\n\n- Case A (happy path):\n  - $C_{\\text{true}} = 100 \\times 10^{-12}\\ \\text{F}$,\n  - $g_{L,\\text{true}} = 10 \\times 10^{-9}\\ \\text{S}$,\n  - $E_L = -70 \\times 10^{-3}\\ \\text{V}$,\n  - $I_0 = 100 \\times 10^{-12}\\ \\text{A}$,\n  - $\\Delta t = 0.1 \\times 10^{-3}\\ \\text{s}$,\n  - $T = 0.1\\ \\text{s}$,\n  - $\\sigma = 0.2 \\times 10^{-3}\\ \\text{V}$.\n\n- Case B (small capacitance and higher noise):\n  - $C_{\\text{true}} = 10 \\times 10^{-12}\\ \\text{F}$,\n  - $g_{L,\\text{true}} = 5 \\times 10^{-9}\\ \\text{S}$,\n  - $E_L = -65 \\times 10^{-3}\\ \\text{V}$,\n  - $I_0 = 50 \\times 10^{-12}\\ \\text{A}$,\n  - $\\Delta t = 0.05 \\times 10^{-3}\\ \\text{s}$,\n  - $T = 0.04\\ \\text{s}$,\n  - $\\sigma = 0.5 \\times 10^{-3}\\ \\text{V}$.\n\n- Case C (negative current step, larger time constant):\n  - $C_{\\text{true}} = 300 \\times 10^{-12}\\ \\text{F}$,\n  - $g_{L,\\text{true}} = 30 \\times 10^{-9}\\ \\text{S}$,\n  - $E_L = -68 \\times 10^{-3}\\ \\text{V}$,\n  - $I_0 = -50 \\times 10^{-12}\\ \\text{A}$,\n  - $\\Delta t = 0.1 \\times 10^{-3}\\ \\text{s}$,\n  - $T = 0.05\\ \\text{s}$,\n  - $\\sigma = 0.1 \\times 10^{-3}\\ \\text{V}$.\n\n- Case D (coarse sampling boundary case, lower amplitude):\n  - $C_{\\text{true}} = 80 \\times 10^{-12}\\ \\text{F}$,\n  - $g_{L,\\text{true}} = 20 \\times 10^{-9}\\ \\text{S}$,\n  - $E_L = -70 \\times 10^{-3}\\ \\text{V}$,\n  - $I_0 = 20 \\times 10^{-12}\\ \\text{A}$,\n  - $\\Delta t = 1 \\times 10^{-3}\\ \\text{s}$,\n  - $T = 0.02\\ \\text{s}$,\n  - $\\sigma = 0.2 \\times 10^{-3}\\ \\text{V}$.\n\nImplementation details:\n- Your program must generate synthetic datasets exactly as specified above (do not read any external input), perform the estimation and confidence interval computation for all four cases, and print the results in the exact single-line format described earlier.\n- Use a nonlinear least squares solver suitable for constrained optimization to ensure $C > 0$ and $g_L > 0$ for all test cases.\n- The final output must be a single line containing the flattened list of floating-point values in SI units for all test cases: $[C_{\\text{hat,A}}, g_{L,\\text{hat,A}}, C_{\\text{lower,A}}, C_{\\text{upper,A}}, g_{L,\\text{lower,A}}, g_{L,\\text{upper,A}}, C_{\\text{hat,B}}, \\dots, g_{L,\\text{upper,D}}]$.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of cellular electrophysiology and circuit theory, well-posed as a standard parameter estimation task, and provides a complete and consistent set of information and constraints. All parameters and experimental conditions are physically realistic.\n\nThe solution proceeds in four stages as requested: deriving the analytical form of the membrane voltage, deriving the sensitivity functions for parameter estimation, formulating the optimization problem, and outlining the implementation of the numerical solution.\n\n### 1. Analytical Solution for Membrane Voltage $V(t)$\n\nThe governing ordinary differential equation (ODE) for the membrane potential $V(t)$ is given by Kirchhoff's current law:\n$$C \\frac{dV}{dt} = -g_L \\left(V(t) - E_L\\right) + I(t)$$\nHere, $C$ is the membrane capacitance, $g_L$ is the leak conductance, $E_L$ is the leak reversal potential, and $I(t)$ is the applied current.\n\nFor a constant step current $I(t) = I_0$ applied at $t=0$, the ODE becomes:\n$$C \\frac{dV}{dt} + g_L V(t) = g_L E_L + I_0$$\nThis is a first-order linear non-homogeneous ODE. We can write it in the standard form $\\frac{dV}{dt} + P V(t) = Q$:\n$$\\frac{dV}{dt} + \\frac{g_L}{C} V(t) = \\frac{g_L E_L + I_0}{C}$$\nThe solution to this type of equation is of the form $V(t) = V_{\\infty} + (V(0) - V_{\\infty}) e^{-t/\\tau}$, where $\\tau$ is the time constant and $V_{\\infty}$ is the steady-state voltage.\n\nThe time constant of the system is identified from the coefficient of the $V(t)$ term:\n$$\\tau = \\frac{C}{g_L}$$\nThe steady-state voltage $V_{\\infty}$ is found by setting $\\frac{dV}{dt} = 0$:\n$$0 = -g_L (V_{\\infty} - E_L) + I_0 \\implies g_L V_{\\infty} = g_L E_L + I_0 \\implies V_{\\infty} = E_L + \\frac{I_0}{g_L}$$\nThe general solution for an initial condition $V(0) = V_0$ is therefore:\n$$V(t) = \\left(E_L + \\frac{I_0}{g_L}\\right) + \\left(V_0 - E_L - \\frac{I_0}{g_L}\\right) e^{-g_L t/C}$$\nThe problem specifies the initial condition $V(0) = V_0 = E_L$ for all test cases. Substituting this into the general solution simplifies the expression:\n$$V(t) = \\left(E_L + \\frac{I_0}{g_L}\\right) + \\left(E_L - E_L - \\frac{I_0}{g_L}\\right) e^{-g_L t/C}$$\n$$V(t) = E_L + \\frac{I_0}{g_L} - \\frac{I_0}{g_L} e^{-g_L t/C}$$\nFactoring out the term $\\frac{I_0}{g_L}$ yields the final analytical solution:\n$$V(t) = E_L + \\frac{I_0}{g_L} \\left(1 - e^{-g_L t/C}\\right)$$\n\n### 2. Derivation of Sensitivity Functions\n\nThe parameters to be estimated are $\\theta = [C, g_L]^\\top$. The sensitivity functions are the partial derivatives of the model voltage $V(t)$ with respect to these parameters. These are required for constructing the Jacobian matrix used in nonlinear least squares and for calculating the Fisher Information Matrix.\n\n**Sensitivity with respect to Capacitance ($C$):**\nWe differentiate $V(t)$ with respect to $C$, treating all other variables as constants.\n$$\\frac{\\partial V(t)}{\\partial C} = \\frac{\\partial}{\\partial C} \\left[ E_L + \\frac{I_0}{g_L} \\left(1 - e^{-g_L t/C}\\right) \\right]$$\n$$= \\frac{I_0}{g_L} \\frac{\\partial}{\\partial C} \\left( -e^{-g_L t C^{-1}} \\right)$$\nUsing the chain rule, where the derivative of the exponent is $\\frac{\\partial}{\\partial C}(-g_L t C^{-1}) = -g_L t (-1)C^{-2} = \\frac{g_L t}{C^2}$:\n$$\\frac{\\partial V(t)}{\\partial C} = \\frac{I_0}{g_L} \\left( -e^{-g_L t/C} \\cdot \\left(\\frac{g_L t}{C^2}\\right) \\right)$$\n$$\\frac{\\partial V(t)}{\\partial C} = -\\frac{I_0 t}{C^2} e^{-g_L t/C}$$\n\n**Sensitivity with respect to Leak Conductance ($g_L$):**\nWe differentiate $V(t)$ with respect to $g_L$. It is helpful to first expand the expression for $V(t)$:\n$$V(t) = E_L + \\frac{I_0}{g_L} - \\frac{I_0}{g_L} e^{-g_L t/C}$$\n$$\\frac{\\partial V(t)}{\\partial g_L} = \\frac{\\partial}{\\partial g_L} \\left[ E_L + I_0 g_L^{-1} - I_0 g_L^{-1} e^{-g_L t/C} \\right]$$\nWe apply the power rule to the first term and the product rule to the second term:\n$$\\frac{\\partial V(t)}{\\partial g_L} = -I_0 g_L^{-2} - I_0 \\left[ (-g_L^{-2}) e^{-g_L t/C} + g_L^{-1} \\left( e^{-g_L t/C} \\cdot \\left(-\\frac{t}{C}\\right) \\right) \\right]$$\n$$= -\\frac{I_0}{g_L^2} - \\left[ -\\frac{I_0}{g_L^2} e^{-g_L t/C} - \\frac{I_0 t}{g_L C} e^{-g_L t/C} \\right]$$\n$$= -\\frac{I_0}{g_L^2} + \\frac{I_0}{g_L^2} e^{-g_L t/C} + \\frac{I_0 t}{g_L C} e^{-g_L t/C}$$\nFactoring terms gives the final expression for the sensitivity:\n$$\\frac{\\partial V(t)}{\\partial g_L} = \\frac{I_0}{g_L^2} \\left( e^{-g_L t/C} - 1 \\right) + \\frac{I_0 t}{g_L C} e^{-g_L t/C}$$\n\n### 3. Nonlinear Least Squares Objective Function\n\nThe goal is to find the parameter estimates $\\hat{\\theta} = [\\hat{C}, \\hat{g}_L]^\\top$ that best fit the model to the noisy measurements $\\{(t_i, y_i)\\}_{i=1}^{N}$. This is achieved by minimizing the sum of squared residuals (SSR). The residual for the $i$-th measurement is the difference between the observed value $y_i$ and the model's prediction $V(t_i; C, g_L)$:\n$$r_i(C, g_L) = y_i - V(t_i; C, g_L)$$\nThe objective function $S(C, g_L)$ is the sum of the squares of these residuals:\n$$S(C, g_L) = \\sum_{i=1}^{N} r_i(C, g_L)^2 = \\sum_{i=1}^{N} \\left( y_i - \\left( E_L + \\frac{I_0}{g_L} \\left(1 - e^{-g_L t_i/C}\\right) \\right) \\right)^2$$\nThe parameter estimates are found by solving the following constrained minimization problem:\n$$(\\hat{C}, \\hat{g}_L) = \\arg\\min_{C > 0, g_L > 0} S(C, g_L)$$\nThe positivity constraints $C > 0$ and $g_L > 0$ are physically necessary.\n\n### 4. Implementation and Confidence Interval Computation\n\nThe numerical implementation will perform the following steps for each test case:\n1.  **Synthesize Data**: Generate a time vector $\\{t_i\\}$ and compute the true voltage $V(t_i)$ using the derived analytical solution and the ground-truth parameters. Add Gaussian noise with the specified standard deviation $\\sigma$ to create the noisy measurements $\\{y_i\\}$.\n2.  **Estimate Parameters**: Use a constrained nonlinear least squares solver (`scipy.optimize.least_squares`) to find the values of $\\hat{C}$ and $\\hat{g}_L$ that minimize the SSR. The analytical Jacobians derived in step 2 will be provided to the solver to improve accuracy and convergence. Initial guesses for the parameters will be derived from the data to ensure robustness.\n3.  **Compute Fisher Information Matrix (FIM)**: The FIM, $\\mathcal{I}$, is calculated at the estimated parameters $\\hat{\\theta} = [\\hat{C}, \\hat{g}_L]^\\top$. It is given by $\\mathcal{I}(\\hat{\\theta}) = \\frac{1}{\\sigma^2} J^\\top J$, where $J$ is the Jacobian matrix of the model outputs with respect to the parameters, with elements $J_{ij} = \\frac{\\partial V(t_i)}{\\partial \\theta_j}|_{\\hat{\\theta}}$.\n4.  **Calculate Confidence Intervals**: The covariance matrix of the estimates is approximated by the inverse of the FIM: $\\operatorname{Cov}(\\hat{\\theta}) \\approx \\mathcal{I}^{-1}$. The variances of the individual parameter estimates, $\\operatorname{Var}(\\hat{C})$ and $\\operatorname{Var}(\\hat{g}_L)$, are the diagonal elements of this covariance matrix. The standard error for each parameter is the square root of its variance. The $95\\%$ confidence interval for a parameter $\\hat{\\theta}_j$ is then computed using the normal approximation:\n    $$\\text{CI}_{95\\%} = \\hat{\\theta}_j \\pm 1.96 \\cdot \\sqrt{\\operatorname{Var}(\\hat{\\theta}_j)}$$\nThis procedure provides the point estimates $(\\hat{C}, \\hat{g}_L)$ as well as a measure of their uncertainty.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Main function to run the parameter estimation and confidence interval\n    calculation for all test cases.\n    \"\"\"\n    # Set a random seed for reproducibility of synthetic data.\n    np.random.seed(42)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"C_true\": 100e-12, \"gL_true\": 10e-9, \"EL\": -70e-3, \"I0\": 100e-12,\n            \"dt\": 0.1e-3, \"T\": 0.1, \"sigma\": 0.2e-3\n        },\n        # Case B (small capacitance and higher noise)\n        {\n            \"C_true\": 10e-12, \"gL_true\": 5e-9, \"EL\": -65e-3, \"I0\": 50e-12,\n            \"dt\": 0.05e-3, \"T\": 0.04, \"sigma\": 0.5e-3\n        },\n        # Case C (negative current step, larger time constant)\n        {\n            \"C_true\": 300e-12, \"gL_true\": 30e-9, \"EL\": -68e-3, \"I0\": -50e-12,\n            \"dt\": 0.1e-3, \"T\": 0.05, \"sigma\": 0.1e-3\n        },\n        # Case D (coarse sampling boundary case, lower amplitude)\n        {\n            \"C_true\": 80e-12, \"gL_true\": 20e-9, \"EL\": -70e-3, \"I0\": 20e-12,\n            \"dt\": 1e-3, \"T\": 0.02, \"sigma\": 0.2e-3\n        }\n    ]\n\n    all_results = []\n\n    # Model voltage function\n    def model_v(t, C, gL, EL, I0):\n        # Handle gL -> 0 case to avoid division by zero and use L'Hopital's rule limit\n        if np.abs(gL) < 1e-15:\n            return EL + (I0 * t) / C\n        \n        # Handle C -> 0 case\n        if np.abs(C) < 1e-18:\n             v_inf = EL + I0 / gL\n             return np.full_like(t, v_inf)\n        \n        tau = C / gL\n        v_inf = EL + I0 / gL\n        # With V0=EL\n        return v_inf + (EL - v_inf) * np.exp(-t / tau)\n\n\n    # Residual function for least_squares\n    def residuals(params, t, y, EL, I0):\n        C, gL = params\n        return y - model_v(t, C, gL, EL, I0)\n\n    # Analytical Jacobian of the residuals\n    def jacobian(params, t, y, EL, I0):\n        C, gL = params\n        \n        # Guard against invalid parameter values passed by the solver\n        if C <= 0 or gL <= 0:\n            return np.full((len(t), 2), np.inf)\n\n        # Exponential term, common in both derivatives\n        exp_term = np.exp(-gL * t / C)\n\n        # Partial derivative of V with respect to C\n        dV_dC = - (I0 * t / C**2) * exp_term\n\n        # Partial derivative of V with respect to gL\n        # Handle gL -> 0 case for the derivative\n        if gL < 1e-15:\n            dV_dgL = (I0 * t**2 / (2 * C**2)) * exp_term # From Taylor expansion\n        else:\n            dV_dgL = (I0 / gL**2) * (exp_term - 1) + (I0 * t / (gL * C)) * exp_term\n        \n        # The jacobian of the residuals is the negative of the jacobian of the model\n        return -np.vstack((dV_dC, dV_dgL)).T\n\n    for case in test_cases:\n        C_true, gL_true, EL, I0, dt, T, sigma = case.values()\n        \n        t_eval = np.arange(0, T, dt)\n        if t_eval.size == 0: t_eval = np.array([0, T-dt]) # Ensure at least 2 points for coarse sampling\n            \n        V_true = model_v(t_eval, C_true, gL_true, EL, I0)\n        noise = np.random.normal(0, sigma, size=len(t_eval))\n        y_obs = V_true + noise\n\n        # --- Initial Guess Strategy ---\n        # Estimate steady state from last 20% of data\n        ss_idx = int(0.8 * len(y_obs))\n        V_ss_obs = np.mean(y_obs[ss_idx:]) if len(y_obs) > 5 else y_obs[-1]\n        \n        # Initial guess for gL\n        if np.abs(V_ss_obs - EL) < 1e-6:\n             gL_0 = 1e-9 # Fallback if denominator is zero\n        else:\n             gL_0 = I0 / (V_ss_obs - EL)\n        if gL_0 <= 0: gL_0 = 1e-9 # Ensure positivity\n        \n        # Initial guess for C from time constant\n        V_change_total = V_ss_obs - EL\n        if np.abs(V_change_total) < 1e-6:\n            tau_0 = T/4 # Fallback\n        else:\n            V_63_percent = EL + (1 - 1/np.e) * V_change_total\n            # Find time to reach 63%\n            if I0 > 0:\n                try:\n                    tau_idx = np.where(y_obs >= V_63_percent)[0][0]\n                    tau_0 = t_eval[tau_idx]\n                except IndexError:\n                    tau_0 = T/4 # Fallback if not reached\n            else: # I0 < 0\n                try:\n                    tau_idx = np.where(y_obs <= V_63_percent)[0][0]\n                    tau_0 = t_eval[tau_idx]\n                except IndexError:\n                    tau_0 = T/4 # Fallback\n        \n        C_0 = tau_0 * gL_0\n        if C_0 <= 0: C_0 = 1e-12 # Ensure positivity\n\n        initial_params = [C_0, gL_0]\n\n        # --- Nonlinear Least Squares Estimation ---\n        bounds = ((1e-15, 1e-12), (np.inf, np.inf)) # Strict positive bounds\n        \n        result = least_squares(\n            residuals,\n            initial_params,\n            jac=jacobian,\n            bounds=bounds,\n            args=(t_eval, y_obs, EL, I0),\n            method='trf'\n        )\n\n        C_hat, gL_hat = result.x\n\n        # --- Confidence Interval Calculation ---\n        # Get Jacobian of the model at the estimated parameters\n        # least_squares returns Jacobian of residuals, so we negate it.\n        J_V = -result.jac\n\n        # Fisher Information Matrix\n        FIM = (1 / sigma**2) * (J_V.T @ J_V)\n\n        try:\n            # Covariance matrix is the inverse of the FIM\n            cov_matrix = np.linalg.inv(FIM)\n            # Variances are the diagonal elements\n            param_variances = np.diag(cov_matrix)\n            \n            # Check for numerical issues (e.g., non-positive variance)\n            if np.any(param_variances < 0):\n                raise np.linalg.LinAlgError(\"Negative variance encountered.\")\n\n            # Standard errors\n            std_errors = np.sqrt(param_variances)\n            \n            # 95% CI (z_alpha/2 = 1.96)\n            z_score = 1.96\n            C_se, gL_se = std_errors\n            \n            C_lower = C_hat - z_score * C_se\n            C_upper = C_hat + z_score * C_se\n            gL_lower = gL_hat - z_score * gL_se\n            gL_upper = gL_hat + z_score * gL_se\n            \n        except np.linalg.LinAlgError:\n            # If FIM is singular or other errors, CIs are not well-defined\n            C_lower, C_upper, gL_lower, gL_upper = [np.nan] * 4\n\n        case_results = [C_hat, gL_hat, C_lower, C_upper, gL_lower, gL_upper]\n        all_results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}