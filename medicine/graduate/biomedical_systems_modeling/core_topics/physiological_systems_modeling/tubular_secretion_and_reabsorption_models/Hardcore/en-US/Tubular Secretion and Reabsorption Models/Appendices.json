{
    "hands_on_practices": [
        {
            "introduction": "This first exercise goes back to the fundamental building block of many physiological transport processes: the single carrier protein. By starting with the basic chemical reaction steps of binding and turnover, you will derive the renowned Michaelis-Menten equation, a cornerstone of enzyme and transport kinetics. This practice will sharpen your ability to connect microscopic mechanisms to macroscopic transport laws and provide a concrete understanding of key parameters like maximal transport capacity ($V_{\\max}$) and the half-saturation constant ($K_m$) .",
            "id": "3939756",
            "problem": "Consider a single-solute reabsorptive transporter embedded in the apical membrane of a proximal tubule epithelial cell. The transporter binds luminal solute and undergoes a catalytic turnover to move solute into the cell. The binding–turnover mechanism is modeled as\n$$\nT + S \\xrightleftharpoons[k_{-1}]{k_{1}} TS \\xrightarrow{k_{\\text{cat}}} T + P,\n$$\nwhere $T$ is the free transporter, $S$ is the solute in the lumen, $TS$ is the transporter–solute complex, $P$ is the product state (solute on the intracellular side), $k_{1}$ and $k_{-1}$ are the forward and reverse binding rate constants, and $k_{\\text{cat}}$ is the catalytic turnover rate. Let the total transporter concentration be $E_{T} = [T] + [TS]$. Assume the Briggs–Haldane quasi-steady state (QSS) for $[TS]$ and negligible product rebinding on the apical side so that the unidirectional uptake flux equals the catalytic flux $J = k_{\\text{cat}}[TS]$ per membrane area. Define the maximal areal uptake capacity $V_{\\max} = k_{\\text{cat}} E_{T}$ and the half-saturation constant $K_{m}$ by the standard single-substrate definitions arising from the QSS.\n\nStarting from the mass-action dynamics and the QSS assumption, derive the steady-state areal uptake flux $J$ as a function of the luminal solute concentration $C$ and the parameters $V_{\\max}$ and $K_{m}$. Then, for the specific case with $V_{\\max} = 1 \\, \\text{nmol s}^{-1} \\text{cm}^{-2}$, $K_{m} = 2 \\, \\text{mM}$, and luminal concentration $C = 4 \\, \\text{mM}$, compute:\n- the net uptake rate $J$ (express your answer in $\\text{nmol s}^{-1} \\text{cm}^{-2}$), and\n- the fractional saturation $f = J / V_{\\max}$.\n\nFor the purpose of assessment, define “near saturation” operationally as $f \\geq 0.9$. Round your numerical results to four significant figures.",
            "solution": "The problem is valid. It presents a standard exercise in transport kinetics, grounded in the scientifically established principles of the Michaelis-Menten model and the Briggs-Haldane quasi-steady-state approximation. All necessary information is provided, and the problem is well-posed and objective.\n\nThe solution proceeds in two parts. First, the general expression for the steady-state uptake flux $J$ is derived. Second, this expression is used to compute the required numerical values for the specific case provided.\n\n**Part 1: Derivation of the Steady-State Uptake Flux $J$**\n\nThe transport process is described by the reaction scheme:\n$$\nT + S \\xrightleftharpoons[k_{-1}]{k_{1}} TS \\xrightarrow{k_{\\text{cat}}} T + P\n$$\nThe rate of change of the transporter-solute complex concentration, $[TS]$, is given by the law of mass action:\n$$\n\\frac{d[TS]}{dt} = k_{1}[T][S] - k_{-1}[TS] - k_{\\text{cat}}[TS]\n$$\nThe problem specifies the use of the Briggs-Haldane quasi-steady-state (QSS) approximation, which assumes that the concentration of the intermediate complex $[TS]$ reaches a steady state very quickly, i.e., $\\frac{d[TS]}{dt} \\approx 0$. Applying this assumption gives:\n$$\nk_{1}[T][S] = (k_{-1} + k_{\\text{cat}})[TS]\n$$\nThe total concentration of transporter, $E_{T}$, is constant and given by the sum of the free and bound forms:\n$$\nE_{T} = [T] + [TS]\n$$\nThis allows us to express the concentration of free transporter, $[T]$, as:\n$$\n[T] = E_{T} - [TS]\n$$\nSubstituting this expression for $[T]$ into the QSS equation yields:\n$$\nk_{1}(E_{T} - [TS])[S] = (k_{-1} + k_{\\text{cat}})[TS]\n$$\nThe problem denotes the luminal solute concentration $[S]$ as $C$. Substituting $C$ for $[S]$ and rearranging the equation to solve for $[TS]$:\n$$\nk_{1}E_{T}C - k_{1}[TS]C = (k_{-1} + k_{\\text{cat}})[TS]\n$$\n$$\nk_{1}E_{T}C = [TS](k_{1}C + k_{-1} + k_{\\text{cat}})\n$$\n$$\n[TS] = \\frac{k_{1}E_{T}C}{k_{1}C + k_{-1} + k_{\\text{cat}}}\n$$\nTo simplify this expression into the standard form, we divide the numerator and the denominator by $k_{1}$:\n$$\n[TS] = \\frac{E_{T}C}{C + \\frac{k_{-1} + k_{\\text{cat}}}{k_{1}}}\n$$\nThe problem defines the half-saturation constant, $K_{m}$, according to the standard definition arising from the QSS (Briggs-Haldane) assumption, which is:\n$$\nK_{m} = \\frac{k_{-1} + k_{\\text{cat}}}{k_{1}}\n$$\nSubstituting $K_{m}$ into the expression for $[TS]$ gives:\n$$\n[TS] = \\frac{E_{T}C}{K_{m} + C}\n$$\nThe unidirectional uptake flux, $J$, is defined as the catalytic flux, $J = k_{\\text{cat}}[TS]$. Substituting the expression for $[TS]$:\n$$\nJ = k_{\\text{cat}} \\left( \\frac{E_{T}C}{K_{m} + C} \\right) = \\frac{k_{\\text{cat}}E_{T}C}{K_{m} + C}\n$$\nFinally, we use the definition of the maximal areal uptake capacity, $V_{\\max} = k_{\\text{cat}}E_{T}$. Substituting this into the equation for $J$ yields the final derived expression, known as the Michaelis-Menten equation:\n$$\nJ = \\frac{V_{\\max}C}{K_{m} + C}\n$$\n\n**Part 2: Numerical Calculation**\n\nThe problem provides the following specific values:\n- Maximal uptake capacity: $V_{\\max} = 1 \\, \\text{nmol s}^{-1} \\text{cm}^{-2}$\n- Half-saturation constant: $K_{m} = 2 \\, \\text{mM}$\n- Luminal concentration: $C = 4 \\, \\text{mM}$\n\nWe are asked to compute the net uptake rate $J$ and the fractional saturation $f = J / V_{\\max}$.\n\nFirst, we calculate the net uptake rate $J$. Note that the units for $K_{m}$ and $C$ (mM) are consistent and will cancel, leaving the units of $J$ to be determined by the units of $V_{\\max}$.\n$$\nJ = \\frac{V_{\\max}C}{K_{m} + C} = \\frac{(1 \\, \\text{nmol s}^{-1} \\text{cm}^{-2})(4 \\, \\text{mM})}{(2 \\, \\text{mM}) + (4 \\, \\text{mM})} = \\frac{4}{6} \\, \\text{nmol s}^{-1} \\text{cm}^{-2} = \\frac{2}{3} \\, \\text{nmol s}^{-1} \\text{cm}^{-2}\n$$\nThe problem requires the numerical result to be rounded to four significant figures.\n$$\nJ \\approx 0.66666... \\, \\text{nmol s}^{-1} \\text{cm}^{-2} \\approx 0.6667 \\, \\text{nmol s}^{-1} \\text{cm}^{-2}\n$$\nNext, we calculate the fractional saturation $f$.\n$$\nf = \\frac{J}{V_{\\max}}\n$$\nFrom the derived equation, we can also see that:\n$$\nf = \\frac{J}{V_{\\max}} = \\frac{V_{\\max}C / (K_{m} + C)}{V_{\\max}} = \\frac{C}{K_{m} + C}\n$$\nUsing the given values:\n$$\nf = \\frac{4 \\, \\text{mM}}{2 \\, \\text{mM} + 4 \\, \\text{mM}} = \\frac{4}{6} = \\frac{2}{3}\n$$\nRounding to four significant figures:\n$$\nf \\approx 0.66666... \\approx 0.6667\n$$\nThe fractional saturation is a dimensionless quantity. It indicates that the transporters are operating at approximately $66.67\\%$ of their maximum capacity under these conditions.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.6667  0.6667 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the kinetics of a single transporter, this problem scales up to the organ level by constructing a lumped-parameter model for glucose reabsorption in the kidney. You will apply the principles of mass balance, integrating glomerular filtration, saturable tubular transport, and peritubular backleak to analyze whole-kidney function. This exercise demonstrates how simple kinetic models can explain complex physiological phenomena, such as the renal threshold for glycosuria—the point at which glucose appears in the urine .",
            "id": "3939825",
            "problem": "A single-kidney lumped model for glucose handling is constructed under quasi-steady conditions by enforcing mass conservation between filtration, tubular reabsorption, and luminal loss. The Glomerular Filtration Rate (GFR) is denoted by $GFR$ (units: $\\mathrm{mL}/\\mathrm{min}$), plasma glucose concentration by $C_p$ (units: $\\mathrm{mg}/\\mathrm{mL}$), and the filtered glucose load by $GFR \\cdot C_p$ (units: $\\mathrm{mg}/\\mathrm{min}$). Sodium-Glucose Linked Transporter (SGLT) kinetics in aggregate are approximated by a single Michaelis–Menten uptake with maximal transport capacity $V_{\\max}$ (units: $\\mathrm{mg}/\\mathrm{min}$) and affinity $K_m$ (units: $\\mathrm{mg}/\\mathrm{mL}$), giving a tubular reabsorptive rate $V_{\\max} \\cdot \\frac{C_p}{K_m + C_p}$. Peritubular backleak from the interstitium into the lumen is modeled as a first-order clearance $C_{\\ell}$ (units: $\\mathrm{mL}/\\mathrm{min}$), producing a luminal loss term $C_{\\ell} \\cdot C_p$.\n\nStarting from these modeling assumptions and first principles of mass conservation, derive the general expressions for:\n- the fraction of the filtered glucose that is reabsorbed, $f(C_p)$, and\n- the renal threshold concentration for glycosuria, $C_{\\mathrm{th}}$, defined here as the smallest positive $C_p$ for which net urinary glucose excretion begins (i.e., net excretion transitions from zero to positive).\n\nThen, using the parameter values\n$$GFR = 120\\ \\mathrm{mL}/\\mathrm{min},\\quad C_p = 2.0\\ \\mathrm{mg}/\\mathrm{mL},\\quad V_{\\max} = 250\\ \\mathrm{mg}/\\mathrm{min},\\quad K_m = 0.40\\ \\mathrm{mg}/\\mathrm{mL},\\quad C_{\\ell} = 5.0\\ \\mathrm{mL}/\\mathrm{min},$$\ncompute the numerical values of $f(C_p)$ and $C_{\\mathrm{th}}$. Round both results to four significant figures. Express $C_{\\mathrm{th}}$ in $\\mathrm{mg}/\\mathrm{mL}$.\n\nReport the final pair of values in the order $\\big(f(C_p),\\,C_{\\mathrm{th}}\\big)$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The givens are:\n- Glomerular Filtration Rate: $GFR$\n- Plasma glucose concentration: $C_p$\n- Filtered glucose load: $GFR \\cdot C_p$\n- Tubular reabsorptive rate (Michaelis-Menten): $R_a = V_{\\max} \\cdot \\frac{C_p}{K_m + C_p}$\n- Maximal transport capacity: $V_{\\max}$\n- Affinity constant: $K_m$\n- Peritubular backleak clearance: $C_{\\ell}$\n- Luminal loss (backleak) term: $L_{\\ell} = C_{\\ell} \\cdot C_p$\n- Numerical values: $GFR = 120\\ \\mathrm{mL}/\\mathrm{min}$, $C_p = 2.0\\ \\mathrm{mg}/\\mathrm{mL}$ for the evaluation of $f(C_p)$, $V_{\\max} = 250\\ \\mathrm{mg}/\\mathrm{min}$, $K_m = 0.40\\ \\mathrm{mg}/\\mathrm{mL}$, $C_{\\ell} = 5.0\\ \\mathrm{mL}/\\mathrm{min}$.\n\nThe model is a standard simplified representation of renal glucose handling, employing mass balance and Michaelis-Menten kinetics. All terms are clearly defined, units are consistent, and the parameters are within plausible physiological ranges. The problem is therefore deemed valid.\n\nThe solution is derived from the principle of mass conservation for glucose in the renal tubule under quasi-steady conditions. The rate of urinary glucose excretion, $E_g$, is the difference between the mass of glucose entering the tubule per unit time (filtered load, $L_f$) and the net mass reabsorbed from the tubule per unit time ($R_{\\text{net}}$).\n\nThe filtered load is given as:\n$$L_f = GFR \\cdot C_p$$\n\nThe net reabsorption is the gross amount reabsorbed by SGLT transporters, $R_a$, minus the amount that leaks back into the lumen from the interstitium, $L_{\\ell}$.\nThe gross reabsorption rate is:\n$$R_a = V_{\\max} \\frac{C_p}{K_m + C_p}$$\nThe backleak rate is:\n$$L_{\\ell} = C_{\\ell} \\cdot C_p$$\nTherefore, the net reabsorption rate is:\n$$R_{\\text{net}} = R_a - L_{\\ell} = V_{\\max} \\frac{C_p}{K_m + C_p} - C_{\\ell} \\cdot C_p$$\n\nThe urinary excretion rate, $E_g$, is then:\n$$E_g = L_f - R_{\\text{net}} = (GFR \\cdot C_p) - \\left(V_{\\max} \\frac{C_p}{K_m + C_p} - C_{\\ell} \\cdot C_p\\right)$$\n$$E_g = (GFR + C_{\\ell}) C_p - V_{\\max} \\frac{C_p}{K_m + C_p}$$\n\n**1. Derivation of the fraction of reabsorbed filtered glucose, $f(C_p)$**\n\nThe fraction of the filtered glucose that is reabsorbed, $f(C_p)$, is the ratio of the net reabsorption rate to the filtered load:\n$$f(C_p) = \\frac{R_{\\text{net}}}{L_f} = \\frac{V_{\\max} \\frac{C_p}{K_m + C_p} - C_{\\ell} \\cdot C_p}{GFR \\cdot C_p}$$\nFor any positive plasma glucose concentration, $C_p  0$, we can simplify by dividing the numerator and denominator by $C_p$:\n$$f(C_p) = \\frac{\\frac{V_{\\max}}{K_m + C_p} - C_{\\ell}}{GFR}$$\nThis is the general expression for $f(C_p)$.\n\n**2. Derivation of the renal threshold concentration, $C_{\\mathrm{th}}$**\n\nThe renal threshold for glycosuria, $C_{\\mathrm{th}}$, is defined as the smallest positive plasma concentration $C_p$ at which net urinary glucose excretion begins. This corresponds to the point where the excretion rate $E_g$ transitions from being non-positive to positive. We find this threshold by setting $E_g = 0$.\n$$E_g = (GFR + C_{\\ell}) C_p - V_{\\max} \\frac{C_p}{K_m + C_p} = 0$$\nFactoring out $C_p$:\n$$C_p \\left[ (GFR + C_{\\ell}) - \\frac{V_{\\max}}{K_m + C_p} \\right] = 0$$\nThis equation has a trivial solution at $C_p = 0$. The non-trivial threshold $C_{\\mathrm{th}}  0$ is found by setting the term in the brackets to zero:\n$$(GFR + C_{\\ell}) - \\frac{V_{\\max}}{K_m + C_{\\mathrm{th}}} = 0$$\nSolving for $C_{\\mathrm{th}}$:\n$$GFR + C_{\\ell} = \\frac{V_{\\max}}{K_m + C_{\\mathrm{th}}}$$\n$$K_m + C_{\\mathrm{th}} = \\frac{V_{\\max}}{GFR + C_{\\ell}}$$\n$$C_{\\mathrm{th}} = \\frac{V_{\\max}}{GFR + C_{\\ell}} - K_m$$\nThis is the general expression for $C_{\\mathrm{th}}$. This formula is valid provided it yields a positive value; otherwise, the threshold is effectively $0$.\n\n**3. Numerical Computations**\n\nUsing the provided parameter values:\n$GFR = 120\\ \\mathrm{mL}/\\mathrm{min}$\n$V_{\\max} = 250\\ \\mathrm{mg}/\\mathrm{min}$\n$K_m = 0.40\\ \\mathrm{mg}/\\mathrm{mL}$\n$C_{\\ell} = 5.0\\ \\mathrm{mL}/\\mathrm{min}$\n\nFirst, we compute the value of $f(C_p)$ for $C_p = 2.0\\ \\mathrm{mg}/\\mathrm{mL}$:\n$$f(2.0) = \\frac{\\frac{250}{0.40 + 2.0} - 5.0}{120} = \\frac{\\frac{250}{2.4} - 5.0}{120}$$\n$$f(2.0) = \\frac{104.1666... - 5.0}{120} = \\frac{99.1666...}{120} = 0.826388...$$\nRounding to four significant figures, we get $f(2.0) = 0.8264$.\n\nNext, we compute the value of $C_{\\mathrm{th}}$:\n$$C_{\\mathrm{th}} = \\frac{250}{120 + 5.0} - 0.40 = \\frac{250}{125} - 0.40$$\n$$C_{\\mathrm{th}} = 2.0 - 0.40 = 1.6\\ \\mathrm{mg}/\\mathrm{mL}$$\nExpressed to four significant figures, this is $1.600 \\ \\mathrm{mg}/\\mathrm{mL}$.\n\nThe final pair of values is $(f(C_p), C_{\\mathrm{th}}) = (0.8264, 1.600)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8264  1.600\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Our final practice takes the leap from simplified lumped models to a more realistic distributed-parameter simulation of an entire nephron. By implementing a numerical integration scheme, you will model how solute concentration changes along the length of the tubule, accounting for segment-specific transport properties and fluid flow. This computational exercise showcases a powerful modern approach to renal modeling and provides insight into how the distinct contributions of the proximal tubule, loop of Henle, and distal nephron collectively determine overall solute handling .",
            "id": "3939777",
            "problem": "Consider a solute that undergoes active tubular reabsorption along a single nephron comprising four contiguous segments: proximal tubule (PT), loop of Henle (LH), distal tubule (DT), and collecting duct (CD). The solute concentration $C(x)$ along axial coordinate $x$ in each segment is governed by species mass conservation and saturable transport kinetics. Assume the following bases:\n\n- Species mass conservation in one-dimensional steady advection-reaction: for volumetric flow $Q(x)$ and luminal concentration $C(x)$, the axial mass flux $M(x)$ satisfies\n$$\n\\frac{d}{dx}\\left(M(x)\\right) = - \\mathcal{S}(x)\\, j(x),\n$$\nwhere $M(x) = \\gamma\\, Q(x)\\, C(x)$, $\\gamma = 10^{-3}$ converts $mM \\cdot nL$ into $nmol$, $\\mathcal{S}(x)$ is the epithelial surface per unit length (in $\\mathrm{mm}$), and $j(x)$ is the area-specific reabsorption flux density (in $\\text{nmol/(min}\\cdot\\text{mm}^2)$).\n\n- Saturable transport kinetics (Michaelis–Menten) with position-dependent maximal rate $V_{\\max}(x)$ and half-saturation constant $K_m(x)$:\n$$\nj(x) = V_{\\max}(x)\\, \\frac{C(x)}{K_m(x) + C(x)}.\n$$\n\n- Cylindrical geometry per segment $s \\in \\{\\mathrm{PT}, \\mathrm{LH}, \\mathrm{DT}, \\mathrm{CD}\\}$ with constant radius $r_s$ and length $L_s$, so the surface per unit length is\n$$\n\\mathcal{S}_s = 2\\pi r_s.\n$$\n\n- Volumetric flow $Q(x)$ is taken as exogenous and piecewise constant per segment: $Q(x) \\equiv Q_s$ for $x$ in segment $s$. Solute mass is continuous across segment boundaries; if $Q$ changes between segments, $C$ adjusts so that $M$ remains continuous.\n\nStarting from the above laws and definitions, derive a computational scheme that, given maps $V_{\\max}(x)$ and $K_m(x)$ (piecewise constant per segment), segment geometries $(L_s, r_s)$, and segmental flows $Q_s$, computes:\n1. The axial profile of $C(x)$ and $M(x)$ along the nephron by integrating\n$$\n\\frac{dM}{dx} = -\\mathcal{S}_s\\, V_{\\max,s}\\, \\frac{C}{K_{m,s} + C}, \\quad \\text{with} \\quad C = \\frac{M}{\\gamma Q_s},\n$$\nwithin each segment $s$ using a uniform step size $\\Delta x$.\n2. The segmental reabsorption amounts\n$$\nR_s = \\int_{0}^{L_s} \\mathcal{S}_s\\, V_{\\max,s}\\, \\frac{C(x)}{K_{m,s} + C(x)}\\, dx,\n$$\nand the segmental contribution fractions relative to the filtered solute load entering the PT:\n$$\n\\phi_s = \\frac{R_s}{M_{\\mathrm{in}}}, \\quad \\text{where} \\quad M_{\\mathrm{in}} = \\gamma Q_{\\mathrm{PT}} C_{\\mathrm{in}}.\n$$\n\nScientific and numerical assumptions:\n- Assume quasi-steady transport within each segment (time-invariant), constant $Q_s$ per segment, and continuity of solute mass across segment junctions.\n- If $M(x)$ would become negative due to reabsorption exceeding the available solute, clamp $M(x)$ at $0$ and terminate reabsorption thereafter.\n- Use a fixed-step explicit integration with $\\Delta x$ sufficiently small for numerical stability.\n\nYour task is to implement a complete program that performs the above computations for the specified test suite. All quantities must be handled in the units specified below, and the final program output must follow the required format.\n\nUnits:\n- $Q_s$ in $\\text{nL/min}$.\n- $C$ and $K_m$ in $\\text{mM}$.\n- $V_{\\max}$ in $\\text{nmol/(min}\\cdot\\text{mm}^2)$.\n- $r_s$ and $L_s$ in $\\text{mm}$.\n- $\\Delta x$ in $\\text{mm}$.\n- $R_s$ and $M_{\\mathrm{in}}$ in $\\text{nmol/min}$.\n- Segmental contribution $\\phi_s$ is unitless; express it as a decimal rounded to six decimal places, without a percentage sign.\n\nFixed geometry and kinetic maps for all test cases (piecewise constant per segment):\n- Segment lengths: $L_{\\mathrm{PT}} = 12$, $L_{\\mathrm{LH}} = 10$, $L_{\\mathrm{DT}} = 5$, $L_{\\mathrm{CD}} = 8$ (all in $\\text{mm}$).\n- Segment radii: $r_{\\mathrm{PT}} = 0.025$, $r_{\\mathrm{LH}} = 0.015$, $r_{\\mathrm{DT}} = 0.015$, $r_{\\mathrm{CD}} = 0.020$ (all in $\\text{mm}$).\n- Baseline $V_{\\max}$: $V_{\\max,\\mathrm{PT}} = 0.005$, $V_{\\max,\\mathrm{LH}} = 0.0005$, $V_{\\max,\\mathrm{DT}} = 0.001$, $V_{\\max,\\mathrm{CD}} = 0.0002$ (all in $\\text{nmol/(min}\\cdot\\text{mm}^2)$).\n- Baseline $K_m$: $K_{m,\\mathrm{PT}} = 2.0$, $K_{m,\\mathrm{LH}} = 4.0$, $K_{m,\\mathrm{DT}} = 3.0$, $K_{m,\\mathrm{CD}} = 5.0$ (all in $\\text{mM}$).\n- Integration step: $\\Delta x = 0.01$ (in $\\text{mm}$).\n- Conversion: $\\gamma = 10^{-3}$ (converting $mM\\cdot nL$ to $nmol$).\n\nTest suite:\nProvide four test cases, each defined by $(Q_{\\mathrm{PT}}, Q_{\\mathrm{LH}}, Q_{\\mathrm{DT}}, Q_{\\mathrm{CD}}, C_{\\mathrm{in}}, \\text{a } V_{\\max} \\text{ override})$:\n1. Baseline case (happy path): flows $Q_{\\mathrm{PT}} = 2.0$, $Q_{\\mathrm{LH}} = 1.2$, $Q_{\\mathrm{DT}} = 0.9$, $Q_{\\mathrm{CD}} = 0.8$ (in $\\text{nL/min}$), inlet concentration $C_{\\mathrm{in}} = 5.0$ (in $\\text{mM}$), no $V_{\\max}$ override (use baseline).\n2. Saturation challenge: same flows as case $1$, but $C_{\\mathrm{in}} = 50.0$ (in $\\text{mM}$), no $V_{\\max}$ override.\n3. No transport edge case: flows as in case $1$, $C_{\\mathrm{in}} = 5.0$ (in $\\text{mM}$), and $V_{\\max}$ overridden to $0$ in all segments.\n4. Low-flow boundary: flows $Q_{\\mathrm{PT}} = 0.1$, $Q_{\\mathrm{LH}} = 0.1$, $Q_{\\mathrm{DT}} = 0.1$, $Q_{\\mathrm{CD}} = 0.1$ (in $\\text{nL/min}$), $C_{\\mathrm{in}} = 5.0$ (in $\\text{mM}$), baseline $V_{\\max}$.\n\nProgram requirements:\n- Implement the explicit integration of $M(x)$ along each segment using the given $\\Delta x$, computing $C(x)$ from $M(x)$ and $Q_s$ and evaluating $j(x)$ via the Michaelis–Menten relation.\n- Enforce $M(x) \\ge 0$ by clamping if necessary; if $M$ reaches $0$ in any segment, downstream segments receive $M=0$.\n- For each test case, compute the segmental contribution list $\\left[\\phi_{\\mathrm{PT}}, \\phi_{\\mathrm{LH}}, \\phi_{\\mathrm{DT}}, \\phi_{\\mathrm{CD}}\\right]$.\n- Round each $\\phi_s$ to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is itself the bracketed, comma-separated list of the four segmental contributions for the corresponding test case. For example, a valid output for two test cases would look like $\\left[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4]\\right]$ with all entries as decimals. In this problem, print the four test-case results in the same nested bracket format and ensure there are no spaces in the printed string.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of mass transport and enzyme kinetics, well-posed as an initial value problem for a system of ordinary differential equations, and is stated objectively with all necessary parameters and conditions provided.\n\nThe core of the problem is to solve for the axial mass flux $M(x)$ of a solute along a model nephron. The rate of change of mass flux is given by the differential equation:\n$$\n\\frac{dM(x)}{dx} = - \\mathcal{S}(x)\\, j(x)\n$$\nwhere $\\mathcal{S}(x)$ is the epithelial surface area per unit length and $j(x)$ is the reabsorptive flux density. The problem states that within each segment $s \\in \\{\\mathrm{PT}, \\mathrm{LH}, \\mathrm{DT}, \\mathrm{CD}\\}$, the geometry and transport properties are constant. The surface area per unit length for a cylindrical tubule of radius $r_s$ is $\\mathcal{S}_s = 2\\pi r_s$. The flux $j(x)$ follows Michaelis-Menten kinetics:\n$$\nj(x) = V_{\\max,s}\\, \\frac{C(x)}{K_{m,s} + C(x)}\n$$\nThe luminal concentration $C(x)$ is related to the mass flux $M(x)$ and the constant segmental volumetric flow $Q_s$ by $M(x) = \\gamma Q_s C(x)$, where $\\gamma = 10^{-3}$ is a unit conversion factor. Thus, we can express concentration as $C(x) = M(x) / (\\gamma Q_s)$. Substituting this into the equation for $j(x)$ and then into the governing differential equation yields an ODE for $M(x)$ within each segment $s$:\n$$\n\\frac{dM}{dx} = - (2\\pi r_s) V_{\\max,s} \\frac{M/(\\gamma Q_s)}{K_{m,s} + M/(\\gamma Q_s)}\n$$\nSimplifying the fraction gives:\n$$\n\\frac{dM}{dx} = - (2\\pi r_s) V_{\\max,s} \\frac{M}{\\gamma Q_s K_{m,s} + M}\n$$\nThis first-order ordinary differential equation describes the evolution of the mass flux $M$ along the axial coordinate $x$ in a given segment $s$. To solve this numerically, we employ the explicit Forward Euler method with a fixed step size $\\Delta x$. For a step from position $x_i$ to $x_{i+1} = x_i + \\Delta x$, the mass flux $M_{i+1} = M(x_{i+1})$ is approximated as:\n$$\nM_{i+1} \\approx M_i + \\Delta x \\cdot \\left(\\frac{dM}{dx}\\right)_{x=x_i}\n$$\nSubstituting the expression for the derivative, the update rule for each step becomes:\n$$\nM_{i+1} = M_i - \\Delta x (2\\pi r_s) V_{\\max,s} \\frac{M_i}{\\gamma Q_s K_{m,s} + M_i}\n$$\nAn important constraint is that the mass flux cannot become negative. If at any step the calculated $M_{i+1}$ is less than $0$, it must be clamped to $0$. This means $M_{i+1} = \\max(0, M_{i+1})$. Once $M$ reaches $0$, it remains $0$ for all subsequent positions, as the reabsorption term becomes $0$.\n\nThe computational procedure for each test case is as follows:\n\n1.  **Initialization**: At the beginning of the proximal tubule (PT), $x=0$, the initial filtered load $M_{\\mathrm{in}}$ is calculated from the inlet concentration $C_{\\mathrm{in}}$ and the proximal tubule flow $Q_{\\mathrm{PT}}$:\n    $$\n    M_{\\mathrm{in}} = \\gamma Q_{\\mathrm{PT}} C_{\\mathrm{in}}\n    $$\n    This $M_{\\mathrm{in}}$ serves as the total solute load against which all reabsorption fractions are normalized. The mass flux entering the first segment (PT) is $M_{\\mathrm{in}}$.\n\n2.  **Segmental Integration**: We proceed sequentially through the four segments: PT, LH, DT, and CD. For each segment $s$:\n    a. The mass flux entering the segment, $M_{\\text{in},s}$, is the mass flux exiting the previous segment. For the PT, $M_{\\text{in},\\mathrm{PT}} = M_{\\mathrm{in}}$.\n    b. The segment has length $L_s$, so the number of integration steps is $N_s = \\lfloor L_s / \\Delta x \\rfloor$.\n    c. We iterate $N_s$ times using the Forward Euler update rule, starting with $M_0 = M_{\\text{in},s}$.\n    d. At each step $i$, we calculate $M_{i+1}$ and enforce the non-negativity constraint.\n    e. The final value of the mass flux after $N_s$ steps, $M_{\\text{out},s}$, becomes the input for the next segment.\n\n3.  **Calculation of Reabsorption and Fractions**:\n    a. The total amount of solute reabsorbed in segment $s$, denoted $R_s$, is the difference between the mass flux entering and exiting the segment:\n    $$\n    R_s = M_{\\text{in},s} - M_{\\text{out},s}\n    $$\n    b. The fractional contribution of segment $s$ to total reabsorption, relative to the initial filtered load, is:\n    $$\n    \\phi_s = \\frac{R_s}{M_{\\mathrm{in}}}\n    $$\n    This procedure is repeated for all four segments. The final result for one test case is the list of four fractional contributions $[\\phi_{\\mathrm{PT}}, \\phi_{\\mathrm{LH}}, \\phi_{\\mathrm{DT}}, \\phi_{\\mathrm{CD}}]$, with each value rounded to six decimal places. This entire computation is then repeated for each of the four test cases specified in the problem.",
            "answer": "[[0.565487,0.038144,0.040156,0.016393],[0.094248,0.009155,0.00693,0.00336],[0.0,0.0,0.0,0.0],[0.985915,0.014085,0.0,0.0]]"
        }
    ]
}