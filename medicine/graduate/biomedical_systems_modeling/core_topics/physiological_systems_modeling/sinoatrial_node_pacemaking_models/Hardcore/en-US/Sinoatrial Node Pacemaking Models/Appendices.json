{
    "hands_on_practices": [
        {
            "introduction": "The \"funny\" current, $I_\\mathrm{f}$, is a cornerstone of sinoatrial node automaticity, providing the slow, inward current that drives diastolic depolarization. Unlike channels permeable to a single ion species whose equilibrium is described by the Nernst potential, $I_\\mathrm{f}$ allows both sodium and potassium ions to pass. This exercise  challenges you to derive the reversal potential for such a mixed-cation current using the Goldman-Hodgkin-Katz (GHK) constant-field model, a fundamental tool in electrophysiology. By comparing the GHK result to an estimate from a simple linear approximation, you will gain a deeper appreciation for the nonlinear nature of ion channel behavior and the conditions under which simpler models may suffice.",
            "id": "3927785",
            "problem": "In sinoatrial node (SAN) pacemaking models, the hyperpolarization-activated cyclic nucleotide-gated channel-mediated current ($I_\\mathrm{f}$) is a mixed-cation current carried primarily by sodium ($\\mathrm{Na}^+$) and potassium ($\\mathrm{K}^+$). Consider a membrane patch where $I_\\mathrm{f}$ is the only permeant pathway for cations, and assume the following conditions: monovalent ions with valence $z=+1$, electroneutrality in the baths, independence of ion movement, and a constant electric field across the membrane (constant-field assumption). Use a first-principles derivation grounded in the Nernst–Planck electrodiffusion framework and the constant-field approximation to obtain the zero-net-current (reversal) potential for two monovalent cations with permeabilities $P_{\\mathrm{K}}$ and $P_{\\mathrm{Na}}$. Then numerically evaluate this reversal potential using the data below. Separately, approximate the $I-V$ relation of $I_\\mathrm{f}$ near a diastolic potential by a first-order Taylor expansion and estimate the reversal potential from this linearization. Finally, report the signed difference between the Goldman–Hodgkin–Katz-based reversal potential and the linearized estimate.\n\nGiven data:\n- Temperature $T = 310$ K, universal gas constant $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$, Faraday constant $F = 96485.33212$ C mol$^{-1}$.\n- Bath concentrations: $[\\mathrm{Na}]_{o} = 140$ mM, $[\\mathrm{Na}]_{i} = 10$ mM, $[\\mathrm{K}]_{o} = 5$ mM, $[\\mathrm{K}]_{i} = 140$ mM.\n- Relative permeability ratio: $P_{\\mathrm{Na}}/P_{\\mathrm{K}} = 0.4$.\n- Diastolic operating point: $V_{d} = -65$ mV, measured $I_\\mathrm{f}(V_{d}) = -0.50$ nA, and local slope conductance $G_\\mathrm{s} = 10.0$ nS. Assume the open probability is fixed over the small voltage range of interest.\n\nTasks:\n1. Starting from the Nernst–Planck flux and the constant-field assumption, derive the mixed-cation zero-current potential for two monovalent cations. Then compute the numerical value of this reversal potential.\n2. Using a first-order Taylor approximation of the current–voltage relation, $I(V) \\approx I(V_{d}) + G_\\mathrm{s}(V - V_{d})$, solve for the reversal potential of this linearized relation.\n3. Compute the signed difference $\\Delta E = E_{\\mathrm{rev,GHK}} - E_{\\mathrm{rev,lin}}$.\n\nExpress the final answer in mV. Round your answer to four significant figures.",
            "solution": "The problem is validated as follows.\n\n**Step 1: Extract Givens**\n- **Model**: Sinoatrial node (SAN) pacemaking model, hyperpolarization-activated current ($I_\\mathrm{f}$) is the only permeant pathway for cations.\n- **Assumptions**: Monovalent ions ($z=+1$), electroneutral baths, independence of ion movement, constant electric field.\n- **Ions**: Sodium ($\\mathrm{Na}^+$) and potassium ($\\mathrm{K}^+$).\n- **Physical Constants**: Temperature $T = 310$ K, universal gas constant $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$, Faraday constant $F = 96485.33212$ C mol$^{-1}$.\n- **Bath Concentrations**: $[\\mathrm{Na}]_{o} = 140$ mM, $[\\mathrm{Na}]_{i} = 10$ mM, $[\\mathrm{K}]_{o} = 5$ mM, $[\\mathrm{K}]_{i} = 140$ mM.\n- **Permeability**: Relative permeability ratio $P_{\\mathrm{Na}}/P_{\\mathrm{K}} = 0.4$.\n- **Linearization Point**: Diastolic operating point $V_{d} = -65$ mV, measured current $I_\\mathrm{f}(V_{d}) = -0.50$ nA, local slope conductance $G_\\mathrm{s} = 10.0$ nS.\n- **Tasks**:\n  1. Derive and compute the Goldman–Hodgkin–Katz (GHK) reversal potential, $E_{\\mathrm{rev,GHK}}$.\n  2. Compute the reversal potential from a linearized current-voltage relation, $E_{\\mathrm{rev,lin}}$.\n  3. Compute the signed difference $\\Delta E = E_{\\mathrm{rev,GHK}} - E_{\\mathrm{rev,lin}}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on the well-established Nernst–Planck electrodiffusion framework and the Goldman–Hodgkin–Katz (GHK) constant-field model, which are cornerstones of quantitative cell biology and electrophysiology. All concepts and parameters are standard in the field.\n- **Well-Posed**: The problem is clearly defined with three distinct, solvable tasks. The provided data are sufficient and consistent to find a unique solution for each task.\n- **Objective**: The language is precise and technical, free from subjectivity or ambiguity.\n- The problem satisfies all criteria for validity. It does not exhibit any of the listed flaws.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Task 1: Derivation and Calculation of the GHK Reversal Potential**\n\nThe derivation starts from the Nernst–Planck equation, which describes the flux density, $j_s$, of an ion species $s$ under the influence of both a concentration gradient and an electric field:\n$$\nj_s(x) = -D_s \\left( \\frac{dC_s(x)}{dx} + \\frac{z_s F}{RT} C_s(x) \\frac{d\\phi(x)}{dx} \\right)\n$$\nwhere $D_s$ is the diffusion coefficient, $C_s(x)$ is the concentration at position $x$ within the membrane, $z_s$ is the ion's valence, $\\phi(x)$ is the electric potential, $R$ is the gas constant, $T$ is the temperature, and $F$ is the Faraday constant.\n\nThe electric current density is $J_s = z_s F j_s$. For a monovalent cation ($z_s = +1$), this becomes:\n$$\nJ_s = -F D_s \\left( \\frac{dC_s}{dx} + \\frac{F}{RT} C_s \\frac{d\\phi}{dx} \\right)\n$$\nThe constant-field assumption implies the electric field, $E = -d\\phi/dx$, is constant across the membrane of thickness $L$. Thus, $d\\phi/dx = -V/L$, where $V = \\phi_{o} - \\phi_{i}$ is the membrane potential. Substituting this gives:\n$$\nJ_s = -F D_s \\left( \\frac{dC_s}{dx} - \\frac{F V}{RT L} C_s \\right)\n$$\nThis is a first-order linear ordinary differential equation for $C_s(x)$. In steady state, $J_s$ is constant with respect to $x$. Integrating this equation across the membrane (from $x=0$ to $x=L$) with boundary conditions $C_s(0) = [s]_i$ and $C_s(L) = [s]_o$ yields the Goldman-Hodgkin-Katz (GHK) current equation for a single cation species:\n$$\nJ_s = P_s \\frac{F^2 V}{RT} \\frac{[s]_i - [s]_o \\exp(-FV/RT)}{1 - \\exp(-FV/RT)}\n$$\nwhere the permeability $P_s$ is defined as $D_s/L$. Note that total current $I_s = A J_s$, where $A$ is the membrane area, but for finding the reversal potential where current is zero, the area term cancels.\n\nThe total current $I_{\\mathrm{f}}$ is the sum of the currents carried by $\\mathrm{Na}^+$ and $\\mathrm{K}^+$, so $I_{\\mathrm{f}} = I_{\\mathrm{Na}} + I_{\\mathrm{K}}$. The reversal potential, $V = E_{\\mathrm{rev,GHK}}$, is the potential at which the net current is zero: $I_{\\mathrm{Na}} + I_{\\mathrm{K}} = 0$.\n$$\nP_{\\mathrm{Na}} \\frac{F^2 V}{RT} \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o \\exp(-FV/RT)}{1 - \\exp(-FV/RT)} + P_{\\mathrm{K}} \\frac{F^2 V}{RT} \\frac{[\\mathrm{K}]_i - [\\mathrm{K}]_o \\exp(-FV/RT)}{1 - \\exp(-FV/RT)} = 0\n$$\nAssuming $V \\neq 0$, we can cancel the common pre-factor $\\frac{F^2 V}{RT (1 - \\exp(-FV/RT))}$. The case $V=0$ can be checked separately and does not satisfy the condition unless the Nernst potentials are also zero, which is not the case here.\n$$\nP_{\\mathrm{Na}} ([\\mathrm{Na}]_i - [\\mathrm{Na}]_o \\exp(-FV/RT)) + P_{\\mathrm{K}} ([\\mathrm{K}]_i - [\\mathrm{K}]_o \\exp(-FV/RT)) = 0\n$$\nRearranging to solve for $V = E_{\\mathrm{rev,GHK}}$:\n$$\nP_{\\mathrm{Na}}[\\mathrm{Na}]_i + P_{\\mathrm{K}}[\\mathrm{K}]_i = (P_{\\mathrm{Na}}[\\mathrm{Na}]_o + P_{\\mathrm{K}}[\\mathrm{K}]_o) \\exp(-FV/RT)\n$$\n$$\n\\exp(-FV/RT) = \\frac{P_{\\mathrm{Na}}[\\mathrm{Na}]_i + P_{\\mathrm{K}}[\\mathrm{K}]_i}{P_{\\mathrm{Na}}[\\mathrm{Na}]_o + P_{\\mathrm{K}}[\\mathrm{K}]_o}\n$$\nTaking the natural logarithm and solving for $V$:\n$$\nE_{\\mathrm{rev,GHK}} = \\frac{RT}{F} \\ln\\left( \\frac{P_{\\mathrm{Na}}[\\mathrm{Na}]_o + P_{\\mathrm{K}}[\\mathrm{K}]_o}{P_{\\mathrm{Na}}[\\mathrm{Na}]_i + P_{\\mathrm{K}}[\\mathrm{K}]_i} \\right)\n$$\nThis is the GHK voltage equation. We can divide the numerator and denominator of the argument of the logarithm by $P_{\\mathrm{K}}$:\n$$\nE_{\\mathrm{rev,GHK}} = \\frac{RT}{F} \\ln\\left( \\frac{(P_{\\mathrm{Na}}/P_{\\mathrm{K}})[\\mathrm{Na}]_o + [\\mathrm{K}]_o}{(P_{\\mathrm{Na}}/P_{\\mathrm{K}})[\\mathrm{Na}]_i + [\\mathrm{K}]_i} \\right)\n$$\nFirst, we calculate the thermal voltage term, $RT/F$:\n$$\n\\frac{RT}{F} = \\frac{(8.314462618 \\text{ J mol}^{-1} \\text{ K}^{-1})(310 \\text{ K})}{96485.33212 \\text{ C mol}^{-1}} \\approx 0.0267138 \\text{ V} = 26.7138 \\text{ mV}\n$$\nNow, substitute the given values into the equation:\n$$\nE_{\\mathrm{rev,GHK}} = (26.7138 \\text{ mV}) \\ln\\left( \\frac{(0.4)(140) + 5}{(0.4)(10) + 140} \\right)\n$$\n$$\nE_{\\mathrm{rev,GHK}} = (26.7138 \\text{ mV}) \\ln\\left( \\frac{56 + 5}{4 + 140} \\right) = (26.7138 \\text{ mV}) \\ln\\left( \\frac{61}{144} \\right)\n$$\n$$\nE_{\\mathrm{rev,GHK}} \\approx (26.7138 \\text{ mV}) \\times (-0.8589506) \\approx -22.9447 \\text{ mV}\n$$\n\n**Task 2: Reversal Potential from Linearized I-V Relation**\n\nThe problem provides a first-order Taylor approximation of the current-voltage relation around the diastolic potential $V_d$:\n$$\nI(V) \\approx I(V_{d}) + G_\\mathrm{s}(V - V_{d})\n$$\nThe reversal potential of this linearized model, $E_{\\mathrm{rev,lin}}$, is the voltage $V$ at which $I(V) = 0$.\n$$\n0 = I(V_{d}) + G_\\mathrm{s}(E_{\\mathrm{rev,lin}} - V_{d})\n$$\nSolving for $E_{\\mathrm{rev,lin}}$:\n$$\nG_\\mathrm{s}(E_{\\mathrm{rev,lin}} - V_{d}) = -I(V_{d})\n$$\n$$\nE_{\\mathrm{rev,lin}} = V_{d} - \\frac{I(V_{d})}{G_\\mathrm{s}}\n$$\nSubstituting the given numerical values:\n- $V_{d} = -65$ mV\n- $I(V_{d}) = -0.50$ nA\n- $G_\\mathrm{s} = 10.0$ nS\n\nFirst, calculate the voltage term $I(V_d)/G_s$:\n$$\n\\frac{I(V_{d})}{G_\\mathrm{s}} = \\frac{-0.50 \\text{ nA}}{10.0 \\text{ nS}} = \\frac{-0.50 \\times 10^{-9} \\text{ A}}{10.0 \\times 10^{-9} \\text{ S}} = -0.05 \\text{ V} = -50 \\text{ mV}\n$$\nNow, substitute this back into the equation for $E_\\mathrm{rev,lin}$:\n$$\nE_\\mathrm{rev,lin} = -65 \\text{ mV} - (-50 \\text{ mV}) = -65 \\text{ mV} + 50 \\text{ mV} = -15 \\text{ mV}\n$$\n\n**Task 3: Signed Difference**\n\nThe final task is to compute the signed difference $\\Delta E = E_{\\mathrm{rev,GHK}} - E_{\\mathrm{rev,lin}}$.\n$$\n\\Delta E = (-22.9447 \\text{ mV}) - (-15 \\text{ mV})\n$$\n$$\n\\Delta E = -22.9447 \\text{ mV} + 15 \\text{ mV} = -7.9447 \\text{ mV}\n$$\nRounding the result to four significant figures as requested:\n$$\n\\Delta E \\approx -7.945 \\text{ mV}\n$$\nThe negative sign indicates that the reversal potential predicted by the fundamental GHK model is more negative than the estimate obtained from a local linear approximation around a diastolic potential of $-65$ mV. This is expected, as the GHK current-voltage relationship is nonlinear (rectifying), not a simple straight line.",
            "answer": "$$\n\\boxed{-7.945}\n$$"
        },
        {
            "introduction": "Understanding the biophysics of a single current is the first step; the next is to see how it contributes to the behavior of the entire cell. This practice bridges that gap by asking you to build a computational model of a pacemaker cell whose rhythmic firing is driven by $I_\\mathrm{f}$. In this exercise , you will simulate the effects of the heart rate-lowering drug ivabradine, which specifically targets $I_\\mathrm{f}$. You will explore two distinct mechanisms of drug action—a simple reduction in channel conductance versus a more complex state-dependent block—to quantify their impact on the cell's spontaneous firing rate, providing a direct link between molecular pharmacology and systems-level physiology.",
            "id": "3927789",
            "problem": "You are asked to construct a self-contained computational experiment to quantify how the antiarrhythmic agent ivabradine alters the spontaneous pacing rate of a simplified sinoatrial (SA) node model by either reducing the maximal funny current conductance or by inducing a state-dependent channel block. The model must be derived from first principles and solved numerically. The final output must be a single line produced by your program containing the computed spontaneous rates, in Hertz, for a specified test suite of parameter sets.\n\nFundamental base and model assumptions:\n\n- The membrane is modeled as an ideal capacitor with capacitance $C_m$ subject to ionic currents, obeying the capacitor law $C_m \\, dV/dt = - I_{\\text{ion}}$. The membrane potential is $V$ in millivolts, time is $t$ in milliseconds. Spontaneous activity is represented by an integrate-and-fire idealization: when $V$ reaches a threshold $V_{\\text{th}}$, a spike is said to occur and $V$ is instantaneously reset to $V_{\\text{reset}}$ to start the next cycle.\n- The only voltage-dependent current explicitly modeled is the hyperpolarization-activated current ($I_\\mathrm{f}$), carried by Hyperpolarization-activated Cyclic Nucleotide-gated (HCN) channels, while all other currents are held fixed and aggregated into a constant background current $I_\\mathrm{bg}$.\n- The funny current is modeled in Hodgkin–Huxley form:\n  $$ I_\\mathrm{f} = \\bar{g}_\\mathrm{f} \\, f \\, (V - E_\\mathrm{f}), $$\n  where $\\bar{g}_\\mathrm{f}$ is the maximal $I_\\mathrm{f}$ conductance in nanosiemens, $E_\\mathrm{f}$ is the reversal potential in millivolts, and $f$ is the activation gate (dimensionless). The gate $f$ follows first-order kinetics:\n  $$ \\frac{df}{dt} = \\frac{f_{\\infty}(V) - f}{\\tau_f(V)}, \\quad f_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}}{k_f}\\right)}, $$\n  with $V_{1/2}$ the half-activation voltage and $k_f$ the slope factor. For simplicity, take $\\tau_f(V)$ constant.\n- Ivabradine action is modeled in two distinct ways, applied separately per test case:\n  1. Conductance scaling: a fractional reduction $\\alpha$ in the maximal conductance yields the effective conductance\n     $$ \\bar{g}_\\mathrm{f}^{\\text{eff}} = (1 - \\alpha) \\, \\bar{g}_\\mathrm{f}, \\quad \\alpha \\in [0,1]. $$\n  2. State-dependent block: channels transition into a drug-bound blocked state at a rate proportional to the open probability proxy $f$, with the blocked fraction $x$ following\n     $$ \\frac{dx}{dt} = k_{\\text{on}} \\, f \\, (1 - x) - k_{\\text{off}} \\, x, $$\n     giving an effective conductance\n     $$ \\bar{g}_\\mathrm{f}^{\\text{eff}} = \\bar{g}_\\mathrm{f} \\, (1 - x). $$\n  Here $k_{\\text{on}}$ and $k_{\\text{off}}$ are rate constants in inverse milliseconds. The drug is assumed not to alter $f_{\\infty}(V)$ or $\\tau_f(V)$ directly.\n- The full voltage dynamics under either ivabradine model is\n  $$ \\frac{dV}{dt} = -\\frac{I_\\mathrm{bg} + \\bar{g}_\\mathrm{f}^{\\text{eff}} \\, f \\, (V - E_\\mathrm{f})}{C_m}. $$\n\nAlgorithmic requirements:\n\n- Initialize $V(0) = V_{\\text{reset}}$, $f(0) = f_{\\infty}(V_{\\text{reset}})$, and $x(0) = 0$ for state-dependent block cases. Integrate the coupled ordinary differential equations forward in time using a fixed time step $\\Delta t$ and explicit update. When $V$ crosses $V_{\\text{th}}$, record the spike time, reset $V$ to $V_{\\text{reset}}$ immediately, and continue integrating. Compute the cycle length as the interspike interval between the second and third spikes if available; otherwise use the first and second spikes. If fewer than two spikes occur within the simulation horizon, return a spontaneous rate of $0.0$ Hertz.\n- The spontaneous rate is defined as the reciprocal of the cycle length in seconds:\n  $$ \\text{rate (Hz)} = \\frac{1000}{\\text{cycle length (ms)}}. $$\n\nUse the following fixed parameters across all test cases (units specified):\n\n- $C_m = 40$ pF (picofarads).\n- $\\bar{g}_\\mathrm{f} = 0.12$ nS (nanosiemens).\n- $E_\\mathrm{f} = -20$ mV (millivolts).\n- $I_\\mathrm{bg} = -0.8$ pA (picoamperes).\n- $V_{1/2} = -70$ mV, $k_f = 7$ mV.\n- $\\tau_f = 100$ ms (milliseconds).\n- $V_{\\text{th}} = -40$ mV, $V_{\\text{reset}} = -60$ mV.\n- Time step $\\Delta t = 0.05$ ms; maximum simulation time $T_{\\max} = 5000$ ms.\n\nTest suite:\n\nEach test case is a tuple of the form $(\\text{model}, p_1, p_2)$, where $\\text{model}$ is either the string \"scale\" or \"block\". For \"scale\", $p_1 = \\alpha$ is the fractional reduction and $p_2$ is ignored. For \"block\", $p_1 = k_{\\text{on}}$ and $p_2 = k_{\\text{off}}$.\n\nUse the following six test cases:\n\n1. $(\\text{\"scale\"}, 0.0, 0.0)$ baseline, no ivabradine (effective $\\bar{g}_\\mathrm{f}$ unchanged).\n2. $(\\text{\"scale\"}, 0.5, 0.0)$ moderate reduction in $\\bar{g}_\\mathrm{f}$.\n3. $(\\text{\"scale\"}, 1.0, 0.0)$ full elimination of $\\bar{g}_\\mathrm{f}$.\n4. $(\\text{\"block\"}, 0.002, 0.0005)$ slow-onset, partial block.\n5. $(\\text{\"block\"}, 0.02, 0.005)$ faster-onset, stronger block.\n6. $(\\text{\"block\"}, 0.0001, 0.01)$ negligible block (dominant unbinding).\n\nAnswer specification:\n\n- Your program must compute the spontaneous rate for each test case, in Hertz, rounded to three decimal places.\n- Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[1.234,2.345,3.456,4.567,5.678,6.789]\".",
            "solution": "The problem statement has been analyzed and is deemed valid. It is scientifically grounded in established principles of cellular electrophysiology, specifically the Hodgkin-Huxley formalism for ion channels and integrate-and-fire models for pacemaking. The problem is well-posed, providing a complete set of parameters, initial conditions, model equations, and a clear numerical C to produce a unique, computable result. All terms are defined objectively and unambiguously. The specified units are consistent.\n\n**1. Model Formulation**\n\nThe model describes the membrane potential $V$ of a simplified sinoatrial node cell. Its dynamics are governed by a system of ordinary differential equations (ODEs). The core principle is the capacitor law, which states that the rate of change of membrane potential is proportional to the total ionic current $I_{\\text{ion}}$ flowing across the membrane capacitance $C_m$.\n\nThe governing equation for the membrane potential $V$ (in mV) as a function of time $t$ (in ms) is:\n$$ \\frac{dV}{dt} = -\\frac{I_{\\text{ion}}}{C_m} $$\nThe total ionic current $I_{\\text{ion}}$ is the sum of a constant background current $I_\\mathrm{bg}$ and the voltage-dependent funny current $I_\\mathrm{f}$:\n$$ I_{\\text{ion}} = I_\\mathrm{bg} + I_\\mathrm{f} $$\nThe funny current $I_\\mathrm{f}$ is modeled as:\n$$ I_\\mathrm{f} = \\bar{g}_\\mathrm{f}^{\\text{eff}} \\, f \\, (V - E_\\mathrm{f}) $$\nwhere $\\bar{g}_\\mathrm{f}^{\\text{eff}}$ is the effective maximal conductance (in nS), $f$ is a dimensionless activation gate, and $E_\\mathrm{f}$ is the reversal potential (in mV). A negative current corresponds to a net inward flow of positive charge (depolarization). The equation for $dV/dt$ includes a negative sign in front of $I_{\\text{ion}}$, correctly translating a net inward current into a positive $dV/dt$. The units (pF, pA, nS, mV, ms) are dimensionally consistent as $\\text{pA}/\\text{pF} = (\\text{A}/\\text{F}) = \\text{V}/\\text{s}$, and $\\text{mV}/\\text{ms} = (10^{-3}\\text{V})/(10^{-3}\\text{s}) = \\text{V}/\\text{s}$.\n\nThe activation gate $f$ follows first-order kinetics:\n$$ \\frac{df}{dt} = \\frac{f_{\\infty}(V) - f}{\\tau_f} $$\nwhere $\\tau_f$ is a constant time constant (in ms) and $f_{\\infty}(V)$ is the voltage-dependent steady-state activation function:\n$$ f_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}}{k_f}\\right)} $$\nHere, $V_{1/2}$ is the half-activation voltage and $k_f$ is the slope factor.\n\n**2. Modeling Ivabradine Action**\n\nTwo separate models are used for the effect of ivabradine on $\\bar{g}_\\mathrm{f}^{\\text{eff}}$:\n\n- **Model 1: Conductance Scaling (\"scale\")**\nThis model assumes a simple fractional reduction $\\alpha$ of the maximal conductance $\\bar{g}_\\mathrm{f}$:\n$$ \\bar{g}_\\mathrm{f}^{\\text{eff}} = (1 - \\alpha) \\bar{g}_\\mathrm{f} $$\n\n- **Model 2: State-Dependent Block (\"block\")**\nThis model introduces a third state variable, $x$, representing the fraction of blocked channels. The dynamics of $x$ are given by:\n$$ \\frac{dx}{dt} = k_{\\text{on}} \\, f \\, (1 - x) - k_{\\text{off}} \\, x $$\nwhere $k_{\\text{on}}$ and $k_{\\text{off}}$ are the binding and unbinding rate constants (in ms$^{-1}$), respectively. The block is dependent on the open state of the channel, proxied by the activation variable $f$. The effective conductance is then:\n$$ \\bar{g}_\\mathrm{f}^{\\text{eff}} = \\bar{g}_\\mathrm{f} (1 - x) $$\n\n**3. Numerical Solution and Spontaneous Rate Calculation**\n\nThe system of coupled ODEs is solved numerically using the explicit (forward) Euler method with a fixed time step $\\Delta t$. Let $V_n$, $f_n$, and $x_n$ be the values at time step $n$. The values at step $n+1$ are computed as:\n$$ V_{n+1} = V_n + \\Delta t \\cdot \\left( -\\frac{I_\\mathrm{bg} + \\bar{g}_\\mathrm{f}^{\\text{eff}, n} \\, f_n \\, (V_n - E_\\mathrm{f})}{C_m} \\right) $$\n$$ f_{n+1} = f_n + \\Delta t \\cdot \\left( \\frac{f_{\\infty}(V_n) - f_n}{\\tau_f} \\right) $$\nFor the \"block\" model, we also compute:\n$$ x_{n+1} = x_n + \\Delta t \\cdot (k_{\\text{on}} f_n (1 - x_n) - k_{\\text{off}} x_n) $$\nNote that $\\bar{g}_\\mathrm{f}^{\\text{eff}, n}$ depends on the model: for \"scale\", it is constant; for \"block\", it is $\\bar{g}_\\mathrm{f}(1-x_n)$.\n\nThe simulation proceeds with the following logic:\n- **Initialization**: At $t=0$, $V(0)=V_{\\text{reset}}$, $f(0)=f_{\\infty}(V_{\\text{reset}})$, and $x(0)=0$.\n- **Integration and Spiking**: The system is integrated forward in time. In each time step, after updating the state variables, a check is performed: if $V_{n+1} \\geq V_{\\text{th}}$.\n- **Reset**: If the threshold is crossed, the current time $t_{n+1}$ is recorded as a spike time. The voltage is then instantaneously reset to $V=V_{\\text{reset}}$ before the next integration step begins. The gating variables $f$ and $x$ are not reset.\n- **Cycle Length and Rate**: The simulation runs for a maximum duration $T_{\\max}$. After the simulation, the list of recorded spike times is analyzed. The cycle length is the time difference between the third and second spikes. If only two spikes occurred, the difference between the second and first is used. The spontaneous rate in Hertz (Hz) is then $1000 / \\text{cycle length (ms)}$. If fewer than two spikes are detected, the rate is $0.0$ Hz.\n\nThe specific parameters for the model and simulation are:\n- $C_m = 40$ pF, $\\bar{g}_\\mathrm{f} = 0.12$ nS, $E_\\mathrm{f} = -20$ mV, $I_\\mathrm{bg} = -0.8$ pA.\n- $V_{1/2} = -70$ mV, $k_f = 7$ mV, $\\tau_f = 100$ ms.\n- $V_{\\text{th}} = -40$ mV, $V_{\\text{reset}} = -60$ mV.\n- $\\Delta t = 0.05$ ms, $T_{\\max} = 5000$ ms.\n\nThis computational experiment will be performed for each of the six test cases specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the sinoatrial node simulation for all test cases\n    and print the results in the specified format.\n    \"\"\"\n\n    # --- Test Suite ---\n    # Each case: (model_type, param1, param2)\n    # \"scale\": param1 = alpha, param2 is ignored\n    # \"block\": param1 = k_on, param2 = k_off\n    test_cases = [\n        (\"scale\", 0.0, 0.0),\n        (\"scale\", 0.5, 0.0),\n        (\"scale\", 1.0, 0.0),\n        (\"block\", 0.002, 0.0005),\n        (\"block\", 0.02, 0.005),\n        (\"block\", 0.0001, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        model, p1, p2 = case\n        rate = run_simulation(model, p1, p2)\n        results.append(rate)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\n\ndef run_simulation(model: str, p1: float, p2: float) -> float:\n    \"\"\"\n    Runs a single simulation for a given model and parameter set.\n\n    Args:\n        model: \"scale\" or \"block\".\n        p1: alpha for \"scale\", k_on for \"block\".\n        p2: ignored for \"scale\", k_off for \"block\".\n\n    Returns:\n        The calculated spontaneous rate in Hertz, rounded to 3 decimal places.\n    \"\"\"\n    # --- Fixed Model Parameters ---\n    # Units: V in mV, t in ms, C in pF, g in nS, I in pA\n    Cm = 40.0       # pF\n    g_f_bar = 0.12  # nS\n    E_f = -20.0     # mV\n    I_bg = -0.8     # pA\n    V_half = -70.0  # mV\n    k_f = 7.0       # mV\n    tau_f = 100.0   # ms\n    V_th = -40.0    # mV\n    V_reset = -60.0 # mV\n\n    # --- Simulation Parameters ---\n    dt = 0.05       # ms\n    T_max = 5000.0  # ms\n    num_steps = int(T_max / dt)\n    \n    # --- Helper function for f_infinity ---\n    def f_inf(V_val):\n        return 1.0 / (1.0 + np.exp((V_val - V_half) / k_f))\n\n    # --- Initial Conditions ---\n    V = V_reset\n    f = f_inf(V_reset)\n    x = 0.0  # Blocked fraction, only used in \"block\" model\n\n    spike_times = []\n\n    # --- Integration Loop ---\n    for i in range(num_steps):\n        current_time = i * dt\n        \n        # Determine effective conductance based on the model\n        if model == \"scale\":\n            alpha = p1\n            g_f_eff = (1 - alpha) * g_f_bar\n        elif model == \"block\":\n            g_f_eff = g_f_bar * (1 - x)\n        else: # Should not happen with given test cases\n            raise ValueError(f\"Unknown model type: {model}\")\n\n        # Calculate time derivatives using explicit Euler method\n        # dV/dt = -(I_bg + I_f) / Cm\n        # I_f = g_f_eff * f * (V - E_f)\n        dV_dt = -(I_bg + g_f_eff * f * (V - E_f)) / Cm\n        \n        # df/dt = (f_inf(V) - f) / tau_f\n        df_dt = (f_inf(V) - f) / tau_f\n        \n        # Update state variables\n        V += dV_dt * dt\n        f += df_dt * dt\n        \n        # Update blocked fraction if applicable\n        if model == \"block\":\n            k_on = p1\n            k_off = p2\n            dx_dt = k_on * f * (1.0 - x) - k_off * x\n            x += dx_dt * dt\n\n        # --- Spike detection and reset ---\n        if V >= V_th:\n            spike_times.append(current_time)\n            V = V_reset\n            # A more precise method could interpolate the exact crossing time,\n            # but for a small dt this is a reasonable approximation.\n    \n    # --- Calculate Spontaneous Rate ---\n    if len(spike_times)  2:\n        return 0.0\n    \n    if len(spike_times) >= 3:\n        # Use the interspike interval between the 2nd and 3rd spikes for stability\n        cycle_length_ms = spike_times[2] - spike_times[1]\n    else: # Exactly 2 spikes\n        # Use the first interspike interval\n        cycle_length_ms = spike_times[1] - spike_times[0]\n        \n    # Convert cycle length (ms) to rate (Hz)\n    rate_hz = 1000.0 / cycle_length_ms\n    \n    return round(rate_hz, 3)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A single pacemaker cell, no matter how robust, cannot drive the heartbeat alone; it must work in concert with its neighbors and successfully excite the surrounding atrial tissue. This presents a classic source-sink challenge, where the small sinoatrial node (the source) must provide enough electrical current to depolarize the large, passive atrial myocardium (the sink). This final exercise  guides you through a quantitative analysis of this crucial interface. Using a simplified but powerful model, you will determine the minimal conditions—in terms of the number of pacemaker cells or the strength of their electrical coupling—required to ensure the pacemaking signal reliably propagates to the rest of the heart.",
            "id": "3927796",
            "problem": "You are asked to formalize a minimal source–sink condition for action potential initiation in a simplified junction between a Sinoatrial Node (SAN) core and atrial tissue, and then compute the minimal SAN core size or per-cell coupling conductance needed to ensure reliable propagation given specified cellular properties. Your program must implement the derived formulas and produce results for a predefined test suite.\n\nAssumptions and modeling foundations:\n- Use Kirchhoff’s Current Law (KCL) and the capacitor equation as the starting point. The atrial tissue at the junction is modeled as a single isopotential membrane patch with capacitance $C_A$ and leak conductance $G_A$ to a resting potential $E_A$, both constant. The SAN core is modeled as $N$ identical source cells, each coupled to the atrial patch through a gap-junction conductance $g_{\\text{gap}}$ (per cell) that remains constant during the upstroke.\n- During the SAN upstroke phase, approximate the SAN source voltage as a constant clamped potential $V_S$ for a fixed available duration $T_{\\text{avail}}$. This is a first-order source approximation valid for assessing the minimal source–sink condition.\n- The atrial membrane must reach a specified voltage threshold $V_{\\text{th}}$ within the window $T_{\\text{avail}}$ to constitute reliable propagation out of the SAN core.\n- All potentials are in millivolts, but equations only use differences and dimensionless ratios, so potential units cancel in logarithms. Time appears through the ratio $C_A/G$, which has units of seconds when $C_A$ is in nanofarads and $G$ is in nanosiemens.\n\nGoverning equation:\n- Let $V_A(t)$ denote atrial membrane voltage. By KCL and the capacitor law, for $t \\ge 0$,\n$$\nC_A \\,\\frac{dV_A}{dt} = -G_A \\,(V_A - E_A) + N\\,g_{\\text{gap}} \\,(V_S - V_A).\n$$\nThis linear, time-invariant first-order system has the solution\n$$\nV_A(t) = V_{\\infty} - \\left(V_{\\infty} - V_{A0}\\right)\\,\\exp\\left(-\\frac{(G_A + N g_{\\text{gap}})}{C_A}\\,t\\right),\n$$\nwith $V_{A0} = V_A(0)$ and steady state\n$$\nV_{\\infty} = \\frac{G_A\\,E_A + N g_{\\text{gap}}\\,V_S}{G_A + N g_{\\text{gap}}}.\n$$\nThe time $t_{\\text{req}}$ required to reach the threshold $V_{\\text{th}}$ is therefore\n$$\nt_{\\text{req}}(N,g_{\\text{gap}}) = \\frac{C_A}{G_A + N g_{\\text{gap}}}\\,\\ln\\!\\left(\\frac{V_{\\infty} - V_{A0}}{V_{\\infty} - V_{\\text{th}}}\\right).\n$$\nA necessary condition is $V_{\\infty}  V_{\\text{th}}$; if this fails, reaching $V_{\\text{th}}$ is impossible. Reliable propagation is achieved if $t_{\\text{req}}(N,g_{\\text{gap}}) \\le T_{\\text{avail}}$ and $V_{\\infty}  V_{\\text{th}}$.\n\nComputational tasks:\n1) Given fixed per-cell coupling $g_{\\text{gap}}$, compute the minimal integer core size $N_{\\min}$ such that $t_{\\text{req}}(N_{\\min},g_{\\text{gap}}) \\le T_{\\text{avail}}$ and $V_{\\infty}(N_{\\min},g_{\\text{gap}})  V_{\\text{th}}$. If $V_S \\le V_{\\text{th}}$, declare the task infeasible and return $-1$.\n2) Given fixed integer core size $N_{\\text{fixed}}$, compute the minimal per-cell coupling conductance $g_{\\text{gap,min}}$ (in nanosiemens) satisfying $t_{\\text{req}}(N_{\\text{fixed}},g_{\\text{gap,min}}) \\le T_{\\text{avail}}$ and $V_{\\infty}(N_{\\text{fixed}},g_{\\text{gap,min}})  V_{\\text{th}}$. If $V_S \\le V_{\\text{th}}$, declare infeasible and return $-1$. Report $g_{\\text{gap,min}}$ rounded to three decimal places.\n\nUnits and angle conventions:\n- Use $C_A$ in nanofarads (nF), $G_A$ and $g_{\\text{gap}}$ in nanosiemens (nS), $V_S$, $E_A$, $V_{A0}$, and $V_{\\text{th}}$ in millivolts (mV), and $T_{\\text{avail}}$ in seconds (s). The computed $t_{\\text{req}}$ will be in seconds. No angles appear in this problem.\n\nTest suite:\nFor each case, your program must use the listed parameters and compute both $N_{\\min}$ and $g_{\\text{gap,min}}$ as specified above. In all cases, set $V_{A0}=E_A$.\n\n- Case A (general, reliable propagation expected):\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = 10$ mV, $g_{\\text{gap}} = 0.5$ nS, $T_{\\text{avail}} = 0.005$ s, $N_{\\text{fixed}} = 5$.\n\n- Case B (shorter available time, more stringent):\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = 10$ mV, $g_{\\text{gap}} = 0.5$ nS, $T_{\\text{avail}} = 0.001$ s, $N_{\\text{fixed}} = 5$.\n\n- Case C (weaker source, still above threshold):\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = -45$ mV, $g_{\\text{gap}} = 0.5$ nS, $T_{\\text{avail}} = 0.004$ s, $N_{\\text{fixed}} = 5$.\n\n- Case D (infeasible, source below threshold):\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = -60$ mV, $g_{\\text{gap}} = 1.0$ nS, $T_{\\text{avail}} = 0.010$ s, $N_{\\text{fixed}} = 5$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one case and is itself a two-element list of the form $[N_{\\min}, g_{\\text{gap,min}}]$. Use the integer $-1$ for infeasible values. For feasible $g_{\\text{gap,min}}$, round to three decimal places (in nS). For example, a valid output with two cases would look like: [[3,0.742],[7,0.115]].",
            "solution": "The problem requires the formalization and computation of minimal conditions for successful action potential propagation from a simplified Sinoatrial Node (SAN) core model to an atrial load. This is a classic source-sink problem in cardiac electrophysiology. We will first derive the necessary analytical conditions and then outline the numerical algorithms to compute the minimal source size ($N_{\\min}$) and minimal per-cell coupling conductance ($g_{\\text{gap,min}}$) for the provided test cases.\n\nThe state of the atrial membrane patch is described by its voltage $V_A(t)$, governed by the first-order linear ordinary differential equation:\n$$\nC_A \\,\\frac{dV_A}{dt} = -G_A \\,(V_A - E_A) + N\\,g_{\\text{gap}} \\,(V_S - V_A)\n$$\nwhere $C_A$ is the atrial capacitance, $G_A$ is the atrial leak conductance, $E_A$ is the atrial resting potential, $N$ is the number of SAN source cells, $g_{\\text{gap}}$ is the gap-junctional conductance per cell, and $V_S$ is the clamped voltage of the SAN source. The initial condition is given as $V_A(0) = V_{A0}$, which for all test cases is set to $E_A$.\n\nThe total conductance influencing the atrial patch is $G_{\\text{tot}} = G_A + N g_{\\text{gap}}$. Let the total coupling conductance from the SAN core be $G_c = N g_{\\text{gap}}$. The equation can be rewritten as:\n$$\nC_A \\,\\frac{dV_A}{dt} + (G_A + G_c) V_A = G_A E_A + G_c V_S\n$$\nThis ODE has the solution provided in the problem statement:\n$$\nV_A(t) = V_{\\infty} - \\left(V_{\\infty} - V_{A0}\\right)\\,\\exp\\left(-\\frac{G_A + G_c}{C_A}\\,t\\right)\n$$\nwhere the steady-state voltage $V_{\\infty}$ is:\n$$\nV_{\\infty} = \\frac{G_A E_A + G_c V_S}{G_A + G_c}\n$$\nReliable propagation requires the atrial voltage $V_A(t)$ to reach the threshold $V_{\\text{th}}$ within an available time window $T_{\\text{avail}}$. This imposes two fundamental constraints:\n\n1.  **Steady-State Condition:** The steady-state voltage $V_{\\infty}$ must be greater than the threshold $V_{\\text{th}}$. If $V_{\\infty} \\le V_{\\text{th}}$, the threshold can never be reached, as $V_A(t)$ approaches $V_{\\infty}$ monotonically from $V_{A0}$.\n    $$ V_{\\infty}  V_{\\text{th}} \\implies \\frac{G_A E_A + G_c V_S}{G_A + G_c}  V_{\\text{th}} $$\n    Assuming $G_A+G_c  0$, we rearrange to find the condition on $G_c$:\n    $$ G_A E_A + G_c V_S  V_{\\text{th}} (G_A + G_c) \\implies G_c (V_S - V_{\\text{th}})  G_A (V_{\\text{th}} - E_A) $$\n    Since $G_A  0$, $G_c  0$, and typically $V_{\\text{th}}  E_A$, the right-hand side is positive. For this inequality to hold, we must have $V_S - V_{\\text{th}}  0$, or $V_S  V_{\\text{th}}$. If $V_S \\le V_{\\text{th}}$, propagation is impossible, as stated in the problem. If $V_S  V_{\\text{th}}$, the condition gives a minimal required total coupling conductance, which we denote as $G_{c,\\text{crit}}$:\n    $$ G_c  G_A \\frac{V_{\\text{th}} - E_A}{V_S - V_{\\text{th}}} = G_{c,\\text{crit}} $$\n\n2.  **Temporal Condition:** The time required to reach the threshold, $t_{\\text{req}}$, must be less than or equal to the available time, $T_{\\text{avail}}$. The expression for $t_{\\text{req}}$ is obtained by solving $V_A(t_{\\text{req}}) = V_{\\text{th}}$ for $t_{\\text{req}}$:\n    $$ t_{\\text{req}}(G_c) = \\frac{C_A}{G_A + G_c}\\,\\ln\\!\\left(\\frac{V_{\\infty} - V_{A0}}{V_{\\infty} - V_{\\text{th}}}\\right) \\le T_{\\text{avail}} $$\n    Using $V_{A0} = E_A$ and the expressions for the voltage differences, the argument of the logarithm becomes:\n    $$ \\frac{V_{\\infty} - E_A}{V_{\\infty} - V_{\\text{th}}} = \\frac{G_c(V_S - E_A)}{G_c(V_S - V_{\\text{th}}) - G_A(V_{\\text{th}} - E_A)} $$\n    The denominator is positive if and only if $G_c  G_{c,\\text{crit}}$, which is the same as the steady-state condition. Thus, the temporal condition implicitly includes the steady-state one. The function $t_{\\text{req}}(G_c)$ is continuous and monotonically decreasing for $G_c  G_{c,\\text{crit}}$. This property ensures that for any $T_{\\text{avail}}  0$, there is a unique value $G_{c,\\text{min}}  G_{c,\\text{crit}}$ such that $t_{\\text{req}}(G_{c,\\text{min}}) = T_{\\text{avail}}$, and the inequality $t_{\\text{req}}(G_c) \\le T_{\\text{avail}}$ is satisfied for all $G_c \\ge G_{c,\\text{min}}$.\n\nOur goal is to find this minimal total coupling conductance, $G_{c,\\text{min}}$, which is the root of the following transcendental equation:\n$$\nH(G_c) = \\frac{C_A}{G_A + G_c}\\,\\ln\\!\\left(\\frac{G_c(V_S - E_A)}{G_c(V_S - V_{\\text{th}}) - G_A(V_{\\text{th}} - E_A)}\\right) - T_{\\text{avail}} = 0\n$$\n\n**Algorithmic Approach**\n\nFor each test case, we first perform a feasibility check. If $V_S \\le V_{\\text{th}}$, both tasks are designated as infeasible by returning $-1$. Otherwise, we proceed as follows:\n\n**Task 1: Compute Minimal Core Size ($N_{\\min}$)**\nGiven a fixed per-cell conductance $g_{\\text{gap}}$, we seek the smallest integer $N$ such that the propagation conditions are met. Since $N$ is a discrete integer, a direct iterative search is the most straightforward and robust method.\n1. Initialize cell count $N = 1$.\n2. In a loop, calculate the total coupling $G_c = N \\cdot g_{\\text{gap}}$.\n3. Check if $G_c  G_{c,\\text{crit}}$. If not, increment $N$ and continue, as the threshold is unreachable.\n4. If $G_c  G_{c,\\text{crit}}$, calculate $t_{\\text{req}}(G_c)$.\n5. If $t_{\\text{req}}(G_c) \\le T_{\\text{avail}}$, the current $N$ is the minimal required size, $N_{\\min}$. The loop terminates.\n6. If $t_{\\text{req}}(G_c)  T_{\\text{avail}}$, increment $N$ and repeat.\n\n**Task 2: Compute Minimal Coupling Conductance ($g_{\\text{gap,min}}$)**\nGiven a fixed core size $N_{\\text{fixed}}$, we need to find the minimal continuous value $g_{\\text{gap,min}}$ that ensures propagation. This is equivalent to finding the minimal total coupling conductance $G_{c,\\text{min}}$ and then calculating $g_{\\text{gap,min}} = G_{c,\\text{min}} / N_{\\text{fixed}}$.\n1. Find $G_{c,\\text{min}}$ by solving the equation $H(G_c) = 0$. Since $H(G_c)$ is monotonic, a numerical root-finding algorithm like Brent's method (`brentq` from SciPy) is highly effective.\n2. The search interval for the root finder can be established. The lower bound is $G_{c,\\text{crit}}$. An upper bound can be determined by finding a value $G_{c, \\text{upper}}$ for which $H(G_{c, \\text{upper}})  0$. An adaptively expanding search (e.g., doubling an initial guess) can find a suitable upper bound.\n3. Once the root $G_{c,\\text{min}}$ is found with sufficient precision, calculate $g_{\\text{gap,min}} = G_{c,\\text{min}} / N_{\\text{fixed}}$.\n4. The result is rounded to three decimal places as required.\n\nThis methodology provides a complete and rigorous solution to the problem by combining analytical derivations with appropriate numerical techniques.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the minimal SAN core size (N_min) and per-cell coupling \n    conductance (g_gap_min) for a set of test cases based on a simplified \n    source-sink model of cardiac action potential propagation.\n    \"\"\"\n\n    test_cases = [\n        # Case A (general, reliable propagation expected)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': 10.0, \n         'g_gap': 0.5, 'T_avail': 0.005, 'N_fixed': 5},\n        # Case B (shorter available time, more stringent)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': 10.0, \n         'g_gap': 0.5, 'T_avail': 0.001, 'N_fixed': 5},\n        # Case C (weaker source, still above threshold)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': -45.0, \n         'g_gap': 0.5, 'T_avail': 0.004, 'N_fixed': 5},\n        # Case D (infeasible, source below threshold)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': -60.0, \n         'g_gap': 1.0, 'T_avail': 0.010, 'N_fixed': 5},\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        C_A = params['C_A']\n        G_A = params['G_A']\n        E_A = params['E_A']\n        V_th = params['V_th']\n        V_S = params['V_S']\n        g_gap = params['g_gap']\n        T_avail = params['T_avail']\n        N_fixed = params['N_fixed']\n        V_A0 = E_A\n        \n        # Preliminiary check for feasibility\n        if V_S = V_th:\n            all_results.append([-1, -1.0])\n            continue\n\n        # --- Task 1: Find N_min ---\n        def calculate_t_req(N, g_gap_val):\n            G_c = N * g_gap_val\n            V_inf = (G_A * E_A + G_c * V_S) / (G_A + G_c)\n            \n            # Check steady-state condition\n            if V_inf = V_th:\n                return float('inf') # Threshold is unreachable\n\n            log_arg_num = V_inf - V_A0\n            log_arg_den = V_inf - V_th\n            \n            if log_arg_den = 0: # Should be covered by V_inf > V_th\n                return float('inf')\n\n            t_req = (C_A / (G_A + G_c)) * np.log(log_arg_num / log_arg_den)\n            return t_req\n\n        N_min = -1\n        # Iterative search for N_min\n        # A safety break is included, though not expected to be hit with valid params.\n        for n_test in range(1, 100000):\n            t_req_val = calculate_t_req(n_test, g_gap)\n            if t_req_val = T_avail:\n                N_min = n_test\n                break\n        \n        # --- Task 2: Find g_gap_min ---\n        def get_H_Gc(G_c):\n            # This function is H(G_c) = t_req(G_c) - T_avail, which we want to find the root of.\n            V_inf = (G_A * E_A + G_c * V_S) / (G_A + G_c)\n            log_arg_num = G_c * (V_S - E_A)\n            log_arg_den = G_c * (V_S - V_th) - G_A * (V_th - E_A)\n            \n            # log_arg_den must be positive\n            if log_arg_den = 0:\n                # Outside valid domain for root finding\n                return float('inf')\n\n            t_req = (C_A / (G_A + G_c)) * np.log(log_arg_num / log_arg_den)\n            return t_req - T_avail\n\n        # Lower bound for G_c from the steady-state condition\n        G_c_crit = G_A * (V_th - E_A) / (V_S - V_th)\n        \n        # We need a search interval [a, b] for brentq where h(a) > 0 and h(b)  0\n        # The lower bound 'a' is slightly above G_c_crit\n        a = G_c_crit * 1.000001\n        \n        # Check if a solution is possible\n        if get_H_Gc(a)  0: # This case is rare but means any Gc > G_c_crit works\n            G_c_min = a\n        else:\n            # Find an upper bound 'b' for the search\n            b = a * 2\n            max_iter = 20\n            iter_count = 0\n            while get_H_Gc(b) > 0 and iter_count  max_iter:\n                b *= 2\n                iter_count += 1\n            \n            try:\n                if iter_count  max_iter:\n                    G_c_min = brentq(get_H_Gc, a, b)\n                else: # Could not find a bracket\n                    G_c_min = -1 # Should not happen in this problem\n            except ValueError:\n                G_c_min = -1 # Should not happen\n\n        if G_c_min != -1:\n            g_gap_min = round(G_c_min / N_fixed, 3)\n        else:\n            g_gap_min = -1.0\n            \n        all_results.append([N_min, g_gap_min])\n\n    # Format the final output string\n    result_str = ','.join([f\"[{n},{g}]\" for n, g in all_results])\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```"
        }
    ]
}