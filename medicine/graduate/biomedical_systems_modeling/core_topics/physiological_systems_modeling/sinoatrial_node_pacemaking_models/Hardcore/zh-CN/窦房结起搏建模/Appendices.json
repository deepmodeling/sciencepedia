{
    "hands_on_practices": [
        {
            "introduction": "我们动手实践的第一步是深入理解驱动起搏活动的关键离子流的基本生物物理特性。Goldman-Hodgkin-Katz (GHK) 方程描述了离子浓度和膜通透性如何共同决定特定电流的逆转电位，这对于像“有趣”电流 ($I_f$) 这样的混合离子流尤其重要。这项练习  将我们的理解建立在基本物理原则之上，从电扩散理论出发进行具体计算，并通过与精确的非线性GHK模型进行比较，介绍了线性化这一重要概念及其局限性。",
            "id": "3927785",
            "problem": "在窦房结 (SAN) 起搏模型中，超极化激活的环核苷酸门控通道介导的电流 ($I_f$) 是一种混合阳离子电流，主要由钠 ($\\mathrm{Na}^+$) 和钾 ($\\mathrm{K}^+$) 承载。考虑一个膜片，其中 $I_f$ 是阳离子唯一的通透途径，并假设以下条件：化合价为 $z=+1$ 的单价离子，浴液中的电中性，离子运动的独立性，以及跨膜的恒定电场（恒定场假设）。使用基于 Nernst–Planck 电扩散框架和恒定场近似的第一性原理推导，获得两种渗透性分别为 $P_{\\mathrm{K}}$ 和 $P_{\\mathrm{Na}}$ 的单价阳离子的零净电流（反转）电位。然后使用以下数据数值计算该反转电位。另外，通过一阶泰勒展开来近似舒张期电位附近的 $I$–$V$ 关系，并从该线性化中估算反转电位。最后，报告基于 Goldman–Hodgkin–Katz 的反转电位与线性化估计值之间的带符号差值。\n\n给定数据：\n- 温度 $T = 310$ K，普适气体常数 $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$，法拉第常数 $F = 96485.33212$ C mol$^{-1}$。\n- 浴液浓度：$[\\mathrm{Na}]_{o} = 140$ mM，$[\\mathrm{Na}]_{i} = 10$ mM，$[\\mathrm{K}]_{o} = 5$ mM，$[\\mathrm{K}]_{i} = 140$ mM。\n- 相对渗透率比：$P_{\\mathrm{Na}}/P_{\\mathrm{K}} = 0.4$。\n- 舒张期工作点：$V_{d} = -65$ mV，测得的 $I_f(V_{d}) = -0.50$ nA，以及局部斜率电导 $G_{s} = 10.0$ nS。假设在所关注的小电压范围内，开放概率是固定的。\n\n任务：\n1. 从 Nernst-Planck 通量和恒定场假设出发，推导两种单价阳离子的混合阳离子零电流电位。然后计算该反转电位的数值。\n2. 使用电流-电压关系的一阶泰勒近似 $I(V) \\approx I(V_{d}) + G_{s}\\,(V - V_{d})$，求解此线性化关系的反转电位。\n3. 计算带符号差值 $\\Delta E = E_{\\mathrm{rev,GHK}} - E_{\\mathrm{rev,lin}}$。\n\n以 mV 为单位表示最终答案。将答案四舍五入到四位有效数字。",
            "solution": "问题验证如下。\n\n**步骤 1：提取给定信息**\n- **模型**：窦房结 (SAN) 起搏模型，超极化激活电流 ($I_f$) 是阳离子的唯一通透途径。\n- **假设**：单价离子 ($z=+1$)，浴液电中性，离子运动独立性，恒定电场。\n- **离子**：钠 ($\\mathrm{Na}^+$) 和钾 ($\\mathrm{K}^+$)。\n- **物理常数**：温度 $T = 310$ K，普适气体常数 $R = 8.314462618$ J mol$^{-1}$ K$^{-1}$，法拉第常数 $F = 96485.33212$ C mol$^{-1}$。\n- **浴液浓度**：$[\\mathrm{Na}]_{o} = 140$ mM，$[\\mathrm{Na}]_{i} = 10$ mM，$[\\mathrm{K}]_{o} = 5$ mM，$[\\mathrm{K}]_{i} = 140$ mM。\n- **渗透性**：相对渗透率比 $P_{\\mathrm{Na}}/P_{\\mathrm{K}} = 0.4$。\n- **线性化点**：舒张期工作点 $V_{d} = -65$ mV，测得电流 $I_f(V_{d}) = -0.50$ nA，局部斜率电导 $G_{s} = 10.0$ nS。\n- **任务**：\n  1. 推导并计算 Goldman–Hodgkin–Katz (GHK) 反转电位，$E_{\\mathrm{rev,GHK}}$。\n  2. 从线性化的电流-电压关系计算反转电位，$E_{\\mathrm{rev,lin}}$。\n  3. 计算带符号差值 $\\Delta E = E_{\\mathrm{rev,GHK}} - E_{\\mathrm{rev,lin}}$。\n\n**步骤 2：使用提取的给定信息进行验证**\n- **科学依据**：该问题基于成熟的 Nernst-Planck 电扩散框架和 Goldman-Hodgkin-Katz (GHK) 恒定场模型，这些是定量细胞生物学和电生理学的基石。所有概念和参数都是该领域的标准。\n- **提法明确**：该问题定义清晰，包含三个独立、可解的任务。所提供的数据充分且一致，足以求得每个任务的唯一解。\n- **客观性**：语言精确、专业，没有主观性或含糊不清之处。\n- 该问题满足所有有效性标准，没有表现出任何列出的缺陷。\n\n**步骤 3：结论与行动**\n该问题有效。将提供完整解答。\n\n**任务 1：GHK 反转电位的推导与计算**\n\n推导从 Nernst-Planck 方程开始，该方程描述了离子种类 $s$ 在浓度梯度和电场共同影响下的通量密度 $j_s$：\n$$\nj_s(x) = -D_s \\left( \\frac{dC_s(x)}{dx} + \\frac{z_s F}{RT} C_s(x) \\frac{d\\phi(x)}{dx} \\right)\n$$\n其中 $D_s$ 是扩散系数，$C_s(x)$ 是膜内位置 $x$ 处的浓度，$z_s$ 是离子的化合价，$\\phi(x)$ 是电位，$R$ 是气体常数，$T$ 是温度，$F$ 是法拉第常数。\n\n电流密度为 $J_s = z_s F j_s$。对于单价阳离子 ($z_s = +1$)，这变为：\n$$\nJ_s = -F D_s \\left( \\frac{dC_s}{dx} + \\frac{F}{RT} C_s \\frac{d\\phi}{dx} \\right)\n$$\n恒定场假设意味着电场 $E = -d\\phi/dx$ 在厚度为 $L$ 的膜上是恒定的。因此，$d\\phi/dx = -V/L$，其中 $V = \\phi_{o} - \\phi_{i}$ 是膜电位。代入可得：\n$$\nJ_s = -F D_s \\left( \\frac{dC_s}{dx} - \\frac{F V}{RT L} C_s \\right)\n$$\n这是关于 $C_s(x)$ 的一阶线性常微分方程。在稳态下，$J_s$ 相对于 $x$ 是常数。在边界条件 $C_s(0) = [s]_i$ 和 $C_s(L) = [s]_o$ 下，对该方程在膜上（从 $x=0$ 到 $x=L$）进行积分，得到单个阳离子种类的 Goldman-Hodgkin-Katz (GHK) 电流方程：\n$$\nJ_s = P_s \\frac{F^2 V}{RT} \\frac{[s]_i - [s]_o \\exp(-FV/RT)}{1 - \\exp(-FV/RT)}\n$$\n其中渗透性 $P_s$ 定义为 $D_s/L$。注意，总电流 $I_s = A J_s$，其中 $A$ 是膜面积，但在寻找电流为零的反转电位时，面积项会抵消。\n\n总电流 $I_{f}$ 是由 $\\mathrm{Na}^+$ 和 $\\mathrm{K}^+$ 承载的电流之和，因此 $I_{f} = I_{\\mathrm{Na}} + I_{\\mathrm{K}}$。反转电位 $V = E_{\\mathrm{rev,GHK}}$ 是净电流为零时的电位：$I_{\\mathrm{Na}} + I_{\\mathrm{K}} = 0$。\n$$\nP_{\\mathrm{Na}} \\frac{F^2 V}{RT} \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o \\exp(-FV/RT)}{1 - \\exp(-FV/RT)} + P_{\\mathrm{K}} \\frac{F^2 V}{RT} \\frac{[\\mathrm{K}]_i - [\\mathrm{K}]_o \\exp(-FV/RT)}{1 - \\exp(-FV/RT)} = 0\n$$\n假设 $V \\neq 0$，我们可以消去公因子 $\\frac{F^2 V}{RT (1 - \\exp(-FV/RT))}$。$V=0$ 的情况可以单独检查，除非能斯特电位也为零，否则不满足条件，而这里情况并非如此。\n$$\nP_{\\mathrm{Na}} ([\\mathrm{Na}]_i - [\\mathrm{Na}]_o \\exp(-FV/RT)) + P_{\\mathrm{K}} ([\\mathrm{K}]_i - [\\mathrm{K}]_o \\exp(-FV/RT)) = 0\n$$\n重新整理以求解 $V = E_{\\mathrm{rev,GHK}}$：\n$$\nP_{\\mathrm{Na}}[\\mathrm{Na}]_i + P_{\\mathrm{K}}[\\mathrm{K}]_i = (P_{\\mathrm{Na}}[\\mathrm{Na}]_o + P_{\\mathrm{K}}[\\mathrm{K}]_o) \\exp(-FV/RT)\n$$\n$$\n\\exp(-FV/RT) = \\frac{P_{\\mathrm{Na}}[\\mathrm{Na}]_i + P_{\\mathrm{K}}[\\mathrm{K}]_i}{P_{\\mathrm{Na}}[\\mathrm{Na}]_o + P_{\\mathrm{K}}[\\mathrm{K}]_o}\n$$\n取自然对数并求解 $V$：\n$$\nE_{\\mathrm{rev,GHK}} = \\frac{RT}{F} \\ln\\left( \\frac{P_{\\mathrm{Na}}[\\mathrm{Na}]_o + P_{\\mathrm{K}}[\\mathrm{K}]_o}{P_{\\mathrm{Na}}[\\mathrm{Na}]_i + P_{\\mathrm{K}}[\\mathrm{K}]_i} \\right)\n$$\n这是 GHK 电压方程。我们可以将对数参数的分子和分母同时除以 $P_{\\mathrm{K}}$：\n$$\nE_{\\mathrm{rev,GHK}} = \\frac{RT}{F} \\ln\\left( \\frac{(P_{\\mathrm{Na}}/P_{\\mathrm{K}})[\\mathrm{Na}]_o + [\\mathrm{K}]_o}{(P_{\\mathrm{Na}}/P_{\\mathrm{K}})[\\mathrm{Na}]_i + [\\mathrm{K}]_i} \\right)\n$$\n首先，我们计算热电压项 $RT/F$：\n$$\n\\frac{RT}{F} = \\frac{(8.314462618 \\text{ J mol}^{-1} \\text{ K}^{-1})(310 \\text{ K})}{96485.33212 \\text{ C mol}^{-1}} \\approx 0.0267138 \\text{ V} = 26.7138 \\text{ mV}\n$$\n现在，将给定值代入方程：\n$$\nE_{\\mathrm{rev,GHK}} = (26.7138 \\text{ mV}) \\ln\\left( \\frac{(0.4)(140) + 5}{(0.4)(10) + 140} \\right)\n$$\n$$\nE_{\\mathrm{rev,GHK}} = (26.7138 \\text{ mV}) \\ln\\left( \\frac{56 + 5}{4 + 140} \\right) = (26.7138 \\text{ mV}) \\ln\\left( \\frac{61}{144} \\right)\n$$\n$$\nE_{\\mathrm{rev,GHK}} \\approx (26.7138 \\text{ mV}) \\times (-0.8589506) \\approx -22.9447 \\text{ mV}\n$$\n\n**任务 2：从线性化 I-V 关系得到的反转电位**\n\n问题给出了围绕舒张期电位 $V_d$ 的电流-电压关系的一阶泰勒近似：\n$$\nI(V) \\approx I(V_{d}) + G_{s}(V - V_{d})\n$$\n这个线性化模型的反转电位 $E_{\\mathrm{rev,lin}}$ 是 $I(V) = 0$ 时的电压 $V$。\n$$\n0 = I(V_{d}) + G_{s}(E_{\\mathrm{rev,lin}} - V_{d})\n$$\n求解 $E_{\\mathrm{rev,lin}}$：\n$$\nG_{s}(E_{\\mathrm{rev,lin}} - V_{d}) = -I(V_{d})\n$$\n$$\nE_{\\mathrm{rev,lin}} = V_{d} - \\frac{I(V_{d})}{G_{s}}\n$$\n代入给定的数值：\n- $V_{d} = -65$ mV\n- $I(V_{d}) = -0.50$ nA\n- $G_{s} = 10.0$ nS\n\n首先，计算电压项 $I(V_d)/G_s$：\n$$\n\\frac{I(V_{d})}{G_{s}} = \\frac{-0.50 \\text{ nA}}{10.0 \\text{ nS}} = \\frac{-0.50 \\times 10^{-9} \\text{ A}}{10.0 \\times 10^{-9} \\text{ S}} = -0.05 \\text{ V} = -50 \\text{ mV}\n$$\n现在，将其代回 $E_{\\mathrm{rev,lin}}$ 的方程中：\n$$\nE_{\\mathrm{rev,lin}} = -65 \\text{ mV} - (-50 \\text{ mV}) = -65 \\text{ mV} + 50 \\text{ mV} = -15 \\text{ mV}\n$$\n\n**任务 3：带符号差值**\n\n最后一个任务是计算带符号差值 $\\Delta E = E_{\\mathrm{rev,GHK}} - E_{\\mathrm{rev,lin}}$。\n$$\n\\Delta E = (-22.9447 \\text{ mV}) - (-15 \\text{ mV})\n$$\n$$\n\\Delta E = -22.9447 \\text{ mV} + 15 \\text{ mV} = -7.9447 \\text{ mV}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\n\\Delta E \\approx -7.945 \\text{ mV}\n$$\n负号表示由基本的 GHK 模型预测的反转电位比从 $-65$ mV 舒张期电位附近的局部线性近似得到的估计值更负。这是预料之中的，因为 GHK 电流-电压关系是非线性的（整流），而不是一条简单的直线。",
            "answer": "$$\n\\boxed{-7.945}\n$$"
        },
        {
            "introduction": "在理解了关键电流的特性之后，我们现在将其置于一个简化的细胞模型中，以观察它如何促成细胞的核心功能——自主发放。起搏活动源于多种离子流的动态相互作用，它们共同为细胞膜电容充电和放电。通过在一个“整合-发放”框架中对有趣电流 ($I_f$) 进行建模，我们可以直接将其特性与起搏速率联系起来。这项实践  在分子层面的通道特性与细胞层面的行为之间建立了切实的联系，并探讨了如何对药物干预（如药物伊伐布雷定）进行建模并量化其对心率的影响，从而展示了这些模型的临床相关性。",
            "id": "3927789",
            "problem": "要求您构建一个独立的计算实验，以量化抗心律失常药物伊伐布雷定（ivabradine）如何通过降低最大“f-电流”（funny current）电导或通过诱导状态依赖性通道阻断来改变简化窦房（SA）节点模型的自发搏动速率。该模型必须从第一性原理推导并进行数值求解。最终输出必须是您的程序生成的单行文本，包含针对指定参数集测试套件计算出的自发速率（单位：赫兹）。\n\n基本和模型假设：\n\n- 膜被建模为一个理想电容器，电容为 $C_m$，受离子电流影响，遵循电容定律 $C_m \\, dV/dt = - I_{\\text{ion}}$。膜电位为 $V$，单位为毫伏（mV）；时间为 $t$，单位为毫秒（ms）。自发活动由一个“整合-发放”理想化模型表示：当 $V$ 达到阈值 $V_{\\text{th}}$ 时，称发生了一次峰电位，并且 $V$ 被瞬时重置为 $V_{\\text{reset}}$ 以开始下一个周期。\n- 唯一明确建模的电压依赖性电流是超极化激活电流（$I_f$），由超极化激活的环核苷酸门控（HCN）通道承载，而所有其他电流均保持不变并聚合为一个恒定的背景电流 $I_{\\text{bg}}$。\n- f-电流采用 Hodgkin–Huxley 形式建模：\n  $$ I_f = \\bar{g}_f \\, f \\, (V - E_f), $$\n  其中 $\\bar{g}_f$ 是最大 $I_f$ 电导，单位为纳西门子（nS）；$E_f$ 是反转电位，单位为毫伏（mV）；$f$ 是激活门（无量纲）。门 $f$ 遵循一级动力学：\n  $$ \\frac{df}{dt} = \\frac{f_{\\infty}(V) - f}{\\tau_f(V)}, \\quad f_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}}{k_f}\\right)}, $$\n  其中 $V_{1/2}$ 是半激活电压，$k_f$ 是斜率因子。为简化起见，设 $\\tau_f(V)$ 为常数。\n- 伊伐布雷定的作用通过两种不同的方式进行建模，每个测试用例分别应用其中一种：\n  1. 电导缩放：最大电导的分数性降低 $\\alpha$ 产生有效电导\n     $$ \\bar{g}_f^{\\text{eff}} = (1 - \\alpha) \\, \\bar{g}_f, \\quad \\alpha \\in [0,1]. $$\n  2. 状态依赖性阻断：通道以与开放概率代理 $f$ 成正比的速率转换到药物结合的阻断状态，阻断分数 $x$ 遵循\n     $$ \\frac{dx}{dt} = k_{\\text{on}} \\, f \\, (1 - x) - k_{\\text{off}} \\, x, $$\n     从而得到有效电导\n     $$ \\bar{g}_f^{\\text{eff}} = \\bar{g}_f \\, (1 - x). $$\n  此处，$k_{\\text{on}}$ 和 $k_{\\text{off}}$ 是速率常数，单位为ms$^{-1}$。假设药物不直接改变 $f_{\\infty}(V)$ 或 $\\tau_f(V)$。\n- 任一伊伐布雷定模型下的完整电压动力学为\n  $$ \\frac{dV}{dt} = -\\frac{I_{\\text{bg}} + \\bar{g}_f^{\\text{eff}} \\, f \\, (V - E_f)}{C_m}. $$\n\n算法要求：\n\n- 初始化 $V(0) = V_{\\text{reset}}$，$f(0) = f_{\\infty}(V_{\\text{reset}})$，对于状态依赖性阻断情况，初始化 $x(0) = 0$。使用固定时间步长 $\\Delta t$ 和显式更新方法对耦合常微分方程进行时间上的向前积分。当 $V$ 穿过 $V_{\\text{th}}$ 时，记录峰电位时间，立即将 $V$ 重置为 $V_{\\text{reset}}$，并继续积分。如果存在，则将周期长度计算为第二个和第三个峰电位之间的峰间期；否则，使用第一个和第二个峰电位之间的峰间期。如果在模拟时程内发生的峰电位少于两个，则返回 $0.0$ 赫兹的自发速率。\n- 自发速率定义为周期长度（以秒为单位）的倒数：\n  $$ \\text{rate (Hz)} = \\frac{1000}{\\text{cycle length (ms)}}. $$\n\n在所有测试用例中均使用以下固定参数（已指定单位）：\n\n- $C_m = 40$ pF（皮法）。\n- $\\bar{g}_f = 0.12$ nS（纳西门子）。\n- $E_f = -20$ mV（毫伏）。\n- $I_{\\text{bg}} = -0.8$ pA（皮安）。\n- $V_{1/2} = -70$ mV, $k_f = 7$ mV。\n- $\\tau_f = 100$ ms（毫秒）。\n- $V_{\\text{th}} = -40$ mV, $V_{\\text{reset}} = -60$ mV。\n- 时间步长 $\\Delta t = 0.05$ ms；最大模拟时间 $T_{\\max} = 5000$ ms。\n\n测试套件：\n\n每个测试用例是一个形式为 $(\\text{model}, p_1, p_2)$ 的元组，其中 $\\text{model}$ 是字符串 \"scale\" 或 \"block\"。对于 \"scale\"，$p_1 = \\alpha$ 是分数性降低，而 $p_2$ 被忽略。对于 \"block\"，$p_1 = k_{\\text{on}}$ 且 $p_2 = k_{\\text{off}}$。\n\n使用以下六个测试用例：\n\n1. $(\\text{\"scale\"}, 0.0, 0.0)$ 基线，无伊伐布雷定（有效 $\\bar{g}_f$ 不变）。\n2. $(\\text{\"scale\"}, 0.5, 0.0)$ 中度降低 $\\bar{g}_f$。\n3. $(\\text{\"scale\"}, 1.0, 0.0)$ 完全消除 $\\bar{g}_f$。\n4. $(\\text{\"block\"}, 0.002, 0.0005)$ 慢起始、部分阻断。\n5. $(\\text{\"block\"}, 0.02, 0.005)$ 快起始、更强阻断。\n6. $(\\text{\"block\"}, 0.0001, 0.01)$ 可忽略的阻断（解离占主导）。\n\n答案规范：\n\n- 您的程序必须计算每个测试用例的自发速率（单位：赫兹），并四舍五入到三位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如，\"[1.234,2.345,3.456,4.567,5.678,6.789]\"。",
            "solution": "问题陈述已经过分析，被认为是有效的。它在科学上基于细胞电生理学的既定原理，特别是离子通道的 Hodgkin-Huxley 范式和用于起搏的整合-发放模型。该问题是适定的，提供了一整套参数、初始条件、模型方程和一个清晰的数值求解任务，以产生唯一、可计算的结果。所有术语都得到了客观且明确的定义。指定的单位是量纲一致的。\n\n**1. 模型构建**\n\n该模型描述了一个简化的窦房结细胞的膜电位 $V$。其动力学由一个常微分方程（ODE）系统控制。核心原理是电容定律，该定律指出膜电位变化率与流过膜电容 $C_m$ 的总离子电流 $I_{\\text{ion}}$ 成正比。\n\n膜电位 $V$（单位 mV）随时间 $t$（单位 ms）变化的控制方程为：\n$$ \\frac{dV}{dt} = -\\frac{I_{\\text{ion}}}{C_m} $$\n总离子电流 $I_{\\text{ion}}$ 是恒定背景电流 $I_{\\text{bg}}$ 和电压依赖性 f-电流 $I_f$ 的总和：\n$$ I_{\\text{ion}} = I_{\\text{bg}} + I_f $$\nf-电流 $I_f$ 建模为：\n$$ I_f = \\bar{g}_f^{\\text{eff}} \\, f \\, (V - E_f) $$\n其中 $\\bar{g}_f^{\\text{eff}}$ 是有效最大电导（单位 nS），$f$ 是一个无量纲的激活门，$E_f$ 是反转电位（单位 mV）。负电流对应于正电荷的净内流（去极化）。$dV/dt$ 的方程在 $I_{\\text{ion}}$ 前包含一个负号，正确地将净内向电流转换为正的 $dV/dt$。单位（pF、pA、nS、mV、ms）在量纲上是一致的，因为 $\\text{pA}/\\text{pF} = (\\text{A}/\\text{F}) = \\text{V}/\\text{s}$，且 $\\text{mV}/\\text{ms} = (10^{-3}\\text{V})/(10^{-3}\\text{s}) = \\text{V}/\\text{s}$。\n\n激活门 $f$ 遵循一级动力学：\n$$ \\frac{df}{dt} = \\frac{f_{\\infty}(V) - f}{\\tau_f} $$\n其中 $\\tau_f$ 是一个恒定时间常数（单位 ms），$f_{\\infty}(V)$ 是电压依赖的稳态激活函数：\n$$ f_{\\infty}(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{1/2}}{k_f}\\right)} $$\n这里，$V_{1/2}$ 是半激活电压，$k_f$ 是斜率因子。\n\n**2. 伊伐布雷定作用建模**\n\n使用两种独立模型来模拟伊伐布雷定对 $\\bar{g}_f^{\\text{eff}}$ 的影响：\n\n- **模型1：电导缩放（\"scale\"）**\n此模型假设最大电导 $\\bar{g}_f$ 有一个简单的分数性降低 $\\alpha$：\n$$ \\bar{g}_f^{\\text{eff}} = (1 - \\alpha) \\bar{g}_f $$\n\n- **模型2：状态依赖性阻断（\"block\"）**\n此模型引入了第三个状态变量 $x$，代表被阻断通道的比例。$x$ 的动力学由下式给出：\n$$ \\frac{dx}{dt} = k_{\\text{on}} \\, f \\, (1 - x) - k_{\\text{off}} \\, x $$\n其中 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 分别是结合和解离速率常数（单位 ms$^{-1}$）。该阻断依赖于通道的开放状态，由激活变量 $f$ 作为代理。有效电导则为：\n$$ \\bar{g}_f^{\\text{eff}} = \\bar{g}_f (1 - x) $$\n\n**3. 数值解与自发速率计算**\n\n该耦合常微分方程组使用显式（前向）欧拉方法和固定时间步长 $\\Delta t$ 进行数值求解。令 $V_n$、$f_n$ 和 $x_n$ 为第 $n$ 个时间步的值。第 $n+1$ 步的值计算如下：\n$$ V_{n+1} = V_n + \\Delta t \\cdot \\left( -\\frac{I_{\\text{bg}} + \\bar{g}_f^{\\text{eff}, n} \\, f_n \\, (V_n - E_f)}{C_m} \\right) $$\n$$ f_{n+1} = f_n + \\Delta t \\cdot \\left( \\frac{f_{\\infty}(V_n) - f_n}{\\tau_f} \\right) $$\n对于 \"block\" 模型，我们还计算：\n$$ x_{n+1} = x_n + \\Delta t \\cdot (k_{\\text{on}} f_n (1 - x_n) - k_{\\text{off}} x_n) $$\n注意，$\\bar{g}_f^{\\text{eff}, n}$ 取决于具体模型：对于 \"scale\"，它是一个常数；对于 \"block\"，它是 $\\bar{g}_f(1-x_n)$。\n\n模拟按以下逻辑进行：\n- **初始化**：在 $t=0$ 时，$V(0)=V_{\\text{reset}}$，$f(0)=f_{\\infty}(V_{\\text{reset}})$，以及 $x(0)=0$。\n- **积分与峰电位发放**：系统随时间向前积分。在每个时间步中，更新状态变量后，进行检查：如果 $V_{n+1} \\geq V_{\\text{th}}$。\n- **重置**：如果超过阈值，当前时间 $t_{n+1}$ 被记录为一次峰电位时间。然后在开始下一个积分步之前，电压被瞬时重置为 $V=V_{\\text{reset}}$。门控变量 $f$ 和 $x$ 不被重置。\n- **周期长度与速率**：模拟运行最大持续时间 $T_{\\max}$。模拟结束后，分析记录的峰电位时间列表。周期长度是第三个和第二个峰电位之间的时间差。如果只发生了两次峰电位，则使用第二个和第一个之间的时间差。自发速率（单位赫兹，Hz）则为 $1000 / \\text{周期长度 (ms)}$。如果检测到的峰电位少于两个，则速率为 $0.0$ Hz。\n\n模型和模拟的具体参数如下：\n- $C_m = 40$ pF, $\\bar{g}_f = 0.12$ nS, $E_f = -20$ mV, $I_{\\text{bg}} = -0.8$ pA。\n- $V_{1/2} = -70$ mV, $k_f = 7$ mV, $\\tau_f = 100$ ms。\n- $V_{\\text{th}} = -40$ mV, $V_{\\text{reset}} = -60$ mV。\n- $\\Delta t = 0.05$ ms, $T_{\\max} = 5000$ ms。\n\n将针对问题陈述中指定的六个测试用例中的每一个执行此计算实验。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the sinoatrial node simulation for all test cases\n    and print the results in the specified format.\n    \"\"\"\n\n    # --- Test Suite ---\n    # Each case: (model_type, param1, param2)\n    # \"scale\": param1 = alpha, param2 is ignored\n    # \"block\": param1 = k_on, param2 = k_off\n    test_cases = [\n        (\"scale\", 0.0, 0.0),\n        (\"scale\", 0.5, 0.0),\n        (\"scale\", 1.0, 0.0),\n        (\"block\", 0.002, 0.0005),\n        (\"block\", 0.02, 0.005),\n        (\"block\", 0.0001, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        model, p1, p2 = case\n        rate = run_simulation(model, p1, p2)\n        results.append(rate)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\n\ndef run_simulation(model: str, p1: float, p2: float) -> float:\n    \"\"\"\n    Runs a single simulation for a given model and parameter set.\n\n    Args:\n        model: \"scale\" or \"block\".\n        p1: alpha for \"scale\", k_on for \"block\".\n        p2: ignored for \"scale\", k_off for \"block\".\n\n    Returns:\n        The calculated spontaneous rate in Hertz, rounded to 3 decimal places.\n    \"\"\"\n    # --- Fixed Model Parameters ---\n    # Units: V in mV, t in ms, C in pF, g in nS, I in pA\n    Cm = 40.0       # pF\n    g_f_bar = 0.12  # nS\n    E_f = -20.0     # mV\n    I_bg = -0.8     # pA\n    V_half = -70.0  # mV\n    k_f = 7.0       # mV\n    tau_f = 100.0   # ms\n    V_th = -40.0    # mV\n    V_reset = -60.0 # mV\n\n    # --- Simulation Parameters ---\n    dt = 0.05       # ms\n    T_max = 5000.0  # ms\n    num_steps = int(T_max / dt)\n    \n    # --- Helper function for f_infinity ---\n    def f_inf(V_val):\n        return 1.0 / (1.0 + np.exp((V_val - V_half) / k_f))\n\n    # --- Initial Conditions ---\n    V = V_reset\n    f = f_inf(V_reset)\n    x = 0.0  # Blocked fraction, only used in \"block\" model\n\n    spike_times = []\n\n    # --- Integration Loop ---\n    for i in range(num_steps):\n        current_time = i * dt\n        \n        # Determine effective conductance based on the model\n        if model == \"scale\":\n            alpha = p1\n            g_f_eff = (1 - alpha) * g_f_bar\n        elif model == \"block\":\n            g_f_eff = g_f_bar * (1 - x)\n        else: # Should not happen with given test cases\n            raise ValueError(f\"Unknown model type: {model}\")\n\n        # Calculate time derivatives using explicit Euler method\n        # dV/dt = -(I_bg + I_f) / Cm\n        # I_f = g_f_eff * f * (V - E_f)\n        dV_dt = -(I_bg + g_f_eff * f * (V - E_f)) / Cm\n        \n        # df/dt = (f_inf(V) - f) / tau_f\n        df_dt = (f_inf(V) - f) / tau_f\n        \n        # Update state variables\n        V += dV_dt * dt\n        f += df_dt * dt\n        \n        # Update blocked fraction if applicable\n        if model == \"block\":\n            k_on = p1\n            k_off = p2\n            dx_dt = k_on * f * (1.0 - x) - k_off * x\n            x += dx_dt * dt\n\n        # --- Spike detection and reset ---\n        if V >= V_th:\n            spike_times.append(current_time)\n            V = V_reset\n            # A more precise method could interpolate the exact crossing time,\n            # but for a small dt this is a reasonable approximation.\n    \n    # --- Calculate Spontaneous Rate ---\n    if len(spike_times)  2:\n        return 0.0\n    \n    if len(spike_times) >= 3:\n        # Use the interspike interval between the 2nd and 3rd spikes for stability\n        cycle_length_ms = spike_times[2] - spike_times[1]\n    else: # Exactly 2 spikes\n        # Use the first interspike interval\n        cycle_length_ms = spike_times[1] - spike_times[0]\n        \n    # Convert cycle length (ms) to rate (Hz)\n    if cycle_length_ms = 0:\n        return 0.0\n    rate_hz = 1000.0 / cycle_length_ms\n    \n    return round(rate_hz, 3)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "单个起搏细胞并非孤立存在。为了有效发挥作用，窦房结必须驱动周围的心脏组织。这项实践旨在解决这一组织层面的挑战。成功的电信号传播取决于“源”（起搏细胞）与它必须去极化的“汇”（周围组织）之间的电平衡。这种源-汇关系决定了信号传播的“安全因子”。这项练习  将我们的视角从单个细胞提升到多细胞组织层面。通过将源-汇问题形式化，它使我们能够量化心脏的天然起搏器成功启动一次心跳所需的最小条件（以起搏细胞簇的大小或耦合强度来衡量），这是理解正常功能和传导阻滞病理学的关键概念。",
            "id": "3927796",
            "problem": "要求您为一个简化的窦房结（SAN）核心与心房组织之间连接处的动作电位启动建立一个最小源-汇条件的形式化模型，然后计算在给定细胞属性下确保可靠传播所需的最小 SAN 核心大小或单位细胞耦合电导。您的程序必须实现所推导的公式，并为预定义的测试套件生成结果。\n\n假设与建模基础：\n- 以基尔霍夫电流定律（KCL）和电容器方程为出发点。连接处的心房组织被建模为一个单一的等电位膜片，其电容 $C_A$ 和漏电导 $G_A$（相对于静息电位 $E_A$）均为常数。SAN 核心被建模为 $N$ 个相同的源细胞，每个细胞通过一个间隙连接电导 $g_{\\text{gap}}$（单位细胞）与心房膜片耦合，该电导在上升相期间保持不变。\n- 在 SAN 上升相期间，将 SAN 源电压近似为一个在固定可用时长 $T_{\\text{avail}}$ 内的恒定钳制电位 $V_S$。这是一个用于评估最小源-汇条件的一阶源近似。\n- 心房膜必须在时间窗口 $T_{\\text{avail}}$ 内达到指定的电压阈值 $V_{\\text{th}}$，才能构成从 SAN 核心的可靠传播。\n- 所有电位单位为毫伏，但方程仅使用差值和无量纲比率，因此电位单位在对数中被抵消。时间通过比率 $C_A/G$ 出现，当 $C_A$ 以纳法为单位，$G$ 以纳西门子为单位时，其单位为秒。\n\n控制方程：\n- 令 $V_A(t)$ 表示心房膜电压。根据 KCL 和电容器定律，对于 $t \\ge 0$，\n$$\nC_A \\,\\frac{dV_A}{dt} = -G_A \\,(V_A - E_A) + N\\,g_{\\text{gap}} \\,(V_S - V_A).\n$$\n这个线性时不变一阶系统有解\n$$\nV_A(t) = V_{\\infty} - \\left(V_{\\infty} - V_{A0}\\right)\\,\\exp\\left(-\\frac{(G_A + N g_{\\text{gap}})}{C_A}\\,t\\right),\n$$\n其中 $V_{A0} = V_A(0)$，稳态为\n$$\nV_{\\infty} = \\frac{G_A\\,E_A + N g_{\\text{gap}}\\,V_S}{G_A + N g_{\\text{gap}}}.\n$$\n因此，达到阈值 $V_{\\text{th}}$ 所需的时间 $t_{\\text{req}}$ 为\n$$\nt_{\\text{req}}(N,g_{\\text{gap}}) = \\frac{C_A}{G_A + N g_{\\text{gap}}}\\,\\ln\\!\\left(\\frac{V_{\\infty} - V_{A0}}{V_{\\infty} - V_{\\text{th}}}\\right).\n$$\n一个必要条件是 $V_{\\infty}  V_{\\text{th}}$；如果不满足此条件，则无法达到 $V_{\\text{th}}$。如果 $t_{\\text{req}}(N,g_{\\text{gap}}) \\le T_{\\text{avail}}$ 且 $V_{\\infty}  V_{\\text{th}}$，则实现可靠传播。\n\n计算任务：\n1) 给定固定的单位细胞耦合 $g_{\\text{gap}}$，计算最小整数核心大小 $N_{\\min}$，使得 $t_{\\text{req}}(N_{\\min},g_{\\text{gap}}) \\le T_{\\text{avail}}$ 且 $V_{\\infty}(N_{\\min},g_{\\text{gap}})  V_{\\text{th}}$。如果 $V_S \\le V_{\\text{th}}$，则声明任务不可行并返回 $-1$。\n2) 给定固定的整数核心大小 $N_{\\text{fixed}}$，计算满足 $t_{\\text{req}}(N_{\\text{fixed}},g_{\\text{gap,min}}) \\le T_{\\text{avail}}$ 和 $V_{\\infty}(N_{\\text{fixed}},g_{\\text{gap,min}})  V_{\\text{th}}$ 的最小单位细胞耦合电导 $g_{\\text{gap,min}}$（单位为纳西门子）。如果 $V_S \\le V_{\\text{th}}$，则声明不可行并返回 $-1$。报告 $g_{\\text{gap,min}}$，四舍五入到三位小数。\n\n单位和角度约定：\n- 使用 $C_A$ 单位为纳法（nF），$G_A$ 和 $g_{\\text{gap}}$ 单位为纳西门子（nS），$V_S$、$E_A$、$V_{A0}$ 和 $V_{\\text{th}}$ 单位为毫伏（mV），$T_{\\text{avail}}$ 单位为秒（s）。计算出的 $t_{\\text{req}}$ 将以秒为单位。此问题不涉及角度。\n\n测试套件：\n对于每种情况，您的程序必须使用所列参数，并按上述规定计算 $N_{\\min}$ 和 $g_{\\text{gap,min}}$。在所有情况下，设置 $V_{A0}=E_A$。\n\n- 情况 A（一般情况，预期可靠传播）：\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = 10$ mV, $g_{\\text{gap}} = 0.5$ nS, $T_{\\text{avail}} = 0.005$ s, $N_{\\text{fixed}} = 5$。\n\n- 情况 B（可用时间更短，更严格）：\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = 10$ mV, $g_{\\text{gap}} = 0.5$ nS, $T_{\\text{avail}} = 0.001$ s, $N_{\\text{fixed}} = 5$。\n\n- 情况 C（源较弱，但仍高于阈值）：\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = -45$ mV, $g_{\\text{gap}} = 0.5$ nS, $T_{\\text{avail}} = 0.004$ s, $N_{\\text{fixed}} = 5$。\n\n- 情况 D（不可行，源低于阈值）：\n  - $C_A = 0.2$ nF, $G_A = 1.0$ nS, $E_A = -80$ mV, $V_{\\text{th}} = -55$ mV, $V_S = -60$ mV, $g_{\\text{gap}} = 1.0$ nS, $T_{\\text{avail}} = 0.010$ s, $N_{\\text{fixed}} = 5$。\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个元素对应一种情况，并且本身是一个形式为 $[N_{\\min}, g_{\\text{gap,min}}]$ 的双元素列表。对于不可行的值，使用整数 $-1$。对于可行的 $g_{\\text{gap,min}}$，四舍五入到三位小数（单位 nS）。例如，一个包含两种情况的有效输出看起来像：[[3,0.742],[7,0.115]]。",
            "solution": "该问题要求对简化窦房结（SAN）核心模型到心房负载的动作电位成功传播的最小条件进行形式化和计算。这是心脏电生理学中一个经典的源-汇问题。我们将首先推导必要的解析条件，然后概述数值算法，以计算所提供测试用例的最小源大小（$N_{\\min}$）和最小单位细胞耦合电导（$g_{\\text{gap,min}}$）。\n\n心房膜片的状态由其电压 $V_A(t)$ 描述，该电压受以下一阶线性常微分方程控制：\n$$\nC_A \\,\\frac{dV_A}{dt} = -G_A \\,(V_A - E_A) + N\\,g_{\\text{gap}} \\,(V_S - V_A)\n$$\n其中 $C_A$ 是心房电容，$G_A$ 是心房漏电导，$E_A$ 是心房静息电位，$N$ 是 SAN 源细胞的数量，$g_{\\text{gap}}$ 是单位细胞的间隙连接电导，$V_S$ 是 SAN 源的钳制电压。初始条件为 $V_A(0) = V_{A0}$，对于所有测试用例，该值均设为 $E_A$。\n\n影响心房膜片的总电导为 $G_{\\text{tot}} = G_A + N g_{\\text{gap}}$。令来自 SAN 核心的总耦合电导为 $G_c = N g_{\\text{gap}}$。该方程可以重写为：\n$$\nC_A \\,\\frac{dV_A}{dt} + (G_A + G_c) V_A = G_A E_A + G_c V_S\n$$\n该常微分方程的解在问题描述中已给出：\n$$\nV_A(t) = V_{\\infty} - \\left(V_{\\infty} - V_{A0}\\right)\\,\\exp\\left(-\\frac{G_A + G_c}{C_A}\\,t\\right)\n$$\n其中稳态电压 $V_{\\infty}$ 为：\n$$\nV_{\\infty} = \\frac{G_A E_A + G_c V_S}{G_A + G_c}\n$$\n可靠传播要求心房电压 $V_A(t)$ 在可用的时间窗口 $T_{\\text{avail}}$ 内达到阈值 $V_{\\text{th}}$。这带来了两个基本约束：\n\n1.  **稳态条件：** 稳态电压 $V_{\\infty}$ 必须大于阈值 $V_{\\text{th}}$。如果 $V_{\\infty} \\le V_{\\text{th}}$，则永远无法达到阈值，因为 $V_A(t)$ 从 $V_{A0}$ 单调地趋近于 $V_{\\infty}$。\n    $$ V_{\\infty}  V_{\\text{th}} \\implies \\frac{G_A E_A + G_c V_S}{G_A + G_c}  V_{\\text{th}} $$\n    假设 $G_A+G_c  0$，我们重新整理以找到对 $G_c$ 的条件：\n    $$ G_A E_A + G_c V_S  V_{\\text{th}} (G_A + G_c) \\implies G_c (V_S - V_{\\text{th}})  G_A (V_{\\text{th}} - E_A) $$\n    由于 $G_A  0$，$G_c  0$，且通常 $V_{\\text{th}}  E_A$，右侧为正。为使此不等式成立，必须有 $V_S - V_{\\text{th}}  0$，即 $V_S  V_{\\text{th}}$。如果 $V_S \\le V_{\\text{th}}$，如问题所述，传播是不可能的。如果 $V_S  V_{\\text{th}}$，该条件给出了一个所需的最小总耦合电导，我们记为 $G_{c,\\text{crit}}$：\n    $$ G_c  G_A \\frac{V_{\\text{th}} - E_A}{V_S - V_{\\text{th}}} = G_{c,\\text{crit}} $$\n\n2.  **时间条件：** 达到阈值所需的时间 $t_{\\text{req}}$ 必须小于或等于可用时间 $T_{\\text{avail}}$。$t_{\\text{req}}$ 的表达式通过解方程 $V_A(t_{\\text{req}}) = V_{\\text{th}}$ 得到：\n    $$ t_{\\text{req}}(G_c) = \\frac{C_A}{G_A + G_c}\\,\\ln\\!\\left(\\frac{V_{\\infty} - V_{A0}}{V_{\\infty} - V_{\\text{th}}}\\right) \\le T_{\\text{avail}} $$\n    使用 $V_{A0} = E_A$ 和电压差的表达式，对数的参数变为：\n    $$ \\frac{V_{\\infty} - E_A}{V_{\\infty} - V_{\\text{th}}} = \\frac{G_c(V_S - E_A)}{G_c(V_S - V_{\\text{th}}) - G_A(V_{\\text{th}} - E_A)} $$\n    分母为正的充要条件是 $G_c  G_{c,\\text{crit}}$，这与稳态条件相同。因此，时间条件隐含了稳态条件。函数 $t_{\\text{req}}(G_c)$ 对于 $G_c  G_{c,\\text{crit}}$ 是连续且单调递减的。此属性确保对于任何 $T_{\\text{avail}}  0$，存在一个唯一的 $G_{c,\\text{min}}  G_{c,\\text{crit}}$ 使得 $t_{\\text{req}}(G_{c,\\text{min}}) = T_{\\text{avail}}$，并且对于所有 $G_c \\ge G_{c,\\text{min}}$，不等式 $t_{\\text{req}}(G_c) \\le T_{\\text{avail}}$ 都成立。\n\n我们的目标是找到这个最小总耦合电导 $G_{c,\\text{min}}$，它是以下超越方程的根：\n$$\nH(G_c) = \\frac{C_A}{G_A + G_c}\\,\\ln\\!\\left(\\frac{G_c(V_S - E_A)}{G_c(V_S - V_{\\text{th}}) - G_A(V_{\\text{th}} - E_A)}\\right) - T_{\\text{avail}} = 0\n$$\n\n**算法方法**\n\n对于每个测试用例，我们首先进行可行性检查。如果 $V_S \\le V_{\\text{th}}$，则两个任务都通过返回 $-1$ 被指定为不可行。否则，我们按如下方式进行：\n\n**任务 1：计算最小核心大小（$N_{\\min}$）**\n给定固定的单位细胞电导 $g_{\\text{gap}}$，我们寻找满足传播条件的最小整数 $N$。由于 $N$ 是一个离散整数，直接迭代搜索是最直接和鲁棒的方法。\n1. 初始化细胞计数 $N = 1$。\n2. 在一个循环中，计算总耦合 $G_c = N \\cdot g_{\\text{gap}}$。\n3. 检查是否 $G_c  G_{c,\\text{crit}}$。如果不是，则增加 $N$ 并继续，因为阈值无法达到。\n4. 如果 $G_c  G_{c,\\text{crit}}$，则计算 $t_{\\text{req}}(G_c)$。\n5. 如果 $t_{\\text{req}}(G_c) \\le T_{\\text{avail}}$，则当前的 $N$ 就是所需的最小大小 $N_{\\min}$。循环终止。\n6. 如果 $t_{\\text{req}}(G_c)  T_{\\text{avail}}$，则增加 $N$ 并重复。\n\n**任务 2：计算最小耦合电导（$g_{\\text{gap,min}}$）**\n给定固定的核心大小 $N_{\\text{fixed}}$，我们需要找到确保传播的最小连续值 $g_{\\text{gap,min}}$。这等同于找到最小总耦合电导 $G_{c,\\text{min}}$，然后计算 $g_{\\text{gap,min}} = G_{c,\\text{min}} / N_{\\text{fixed}}$。\n1. 通过求解方程 $H(G_c) = 0$ 来找到 $G_{c,\\text{min}}$。由于 $H(G_c)$ 是单调的，像 Brent 方法（来自 SciPy 的 `brentq`）这样的数值求根算法非常有效。\n2. 可以确定求根器的搜索区间。下界是 $G_{c,\\text{crit}}$。可以通过找到一个值 $G_{c, \\text{upper}}$ 使得 $H(G_{c, \\text{upper}})  0$ 来确定上界。自适应扩展搜索（例如，将初始猜测值加倍）可以找到一个合适的上界。\n3. 一旦以足够的精度找到根 $G_{c,\\text{min}}$，计算 $g_{\\text{gap,min}} = G_{c,\\text{min}} / N_{\\text{fixed}}$。\n4. 结果按要求四舍五入到三位小数。\n\n此方法通过将解析推导与适当的数值技术相结合，为问题提供了完整而严谨的解决方案。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the minimal SAN core size (N_min) and per-cell coupling \n    conductance (g_gap_min) for a set of test cases based on a simplified \n    source-sink model of cardiac action potential propagation.\n    \"\"\"\n\n    test_cases = [\n        # Case A (general, reliable propagation expected)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': 10.0, \n         'g_gap': 0.5, 'T_avail': 0.005, 'N_fixed': 5},\n        # Case B (shorter available time, more stringent)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': 10.0, \n         'g_gap': 0.5, 'T_avail': 0.001, 'N_fixed': 5},\n        # Case C (weaker source, still above threshold)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': -45.0, \n         'g_gap': 0.5, 'T_avail': 0.004, 'N_fixed': 5},\n        # Case D (infeasible, source below threshold)\n        {'C_A': 0.2, 'G_A': 1.0, 'E_A': -80.0, 'V_th': -55.0, 'V_S': -60.0, \n         'g_gap': 1.0, 'T_avail': 0.010, 'N_fixed': 5},\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        C_A = params['C_A']\n        G_A = params['G_A']\n        E_A = params['E_A']\n        V_th = params['V_th']\n        V_S = params['V_S']\n        g_gap = params['g_gap']\n        T_avail = params['T_avail']\n        N_fixed = params['N_fixed']\n        V_A0 = E_A\n        \n        # Preliminiary check for feasibility\n        if V_S = V_th:\n            all_results.append([-1, -1.0])\n            continue\n\n        # --- Task 1: Find N_min ---\n        def calculate_t_req(N, g_gap_val):\n            if N = 0: return float('inf')\n            G_c = N * g_gap_val\n            V_inf = (G_A * E_A + G_c * V_S) / (G_A + G_c)\n            \n            # Check steady-state condition\n            if V_inf = V_th:\n                return float('inf') # Threshold is unreachable\n\n            log_arg_num = V_inf - V_A0\n            log_arg_den = V_inf - V_th\n            \n            if log_arg_den = 0: # Should be covered by V_inf > V_th\n                return float('inf')\n\n            t_req = (C_A / (G_A + G_c)) * np.log(log_arg_num / log_arg_den)\n            return t_req\n\n        N_min = -1\n        # Iterative search for N_min\n        for n_test in range(1, 100000):\n            t_req_val = calculate_t_req(n_test, g_gap)\n            if t_req_val = T_avail:\n                N_min = n_test\n                break\n        \n        # --- Task 2: Find g_gap_min ---\n        def get_H_Gc(G_c):\n            # This function is H(G_c) = t_req(G_c) - T_avail, which we want to find the root of.\n            V_inf = (G_A * E_A + G_c * V_S) / (G_A + G_c)\n            log_arg_num = G_c * (V_S - E_A)\n            log_arg_den = G_c * (V_S - V_th) - G_A * (V_th - E_A)\n            \n            # log_arg_den must be positive\n            if log_arg_den = 0:\n                return float('inf')\n\n            t_req = (C_A / (G_A + G_c)) * np.log(log_arg_num / log_arg_den)\n            return t_req - T_avail\n\n        # Lower bound for G_c from the steady-state condition\n        G_c_crit = G_A * (V_th - E_A) / (V_S - V_th)\n        \n        a = G_c_crit * 1.000001\n        \n        if get_H_Gc(a)  0:\n            G_c_min = a\n        else:\n            b = a * 2\n            max_iter = 20\n            iter_count = 0\n            while get_H_Gc(b) > 0 and iter_count  max_iter:\n                b *= 2\n                iter_count += 1\n            \n            try:\n                if iter_count  max_iter:\n                    G_c_min = brentq(get_H_Gc, a, b)\n                else: \n                    G_c_min = -1\n            except ValueError:\n                G_c_min = -1\n\n        if G_c_min != -1 and N_fixed > 0:\n            g_gap_min = round(G_c_min / N_fixed, 3)\n        else:\n            g_gap_min = -1.0\n            \n        all_results.append([N_min, g_gap_min])\n\n    # Format the final output string\n    result_str = ','.join([f\"[{n},{g}]\" for n, g in all_results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}