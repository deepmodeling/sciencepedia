{
    "hands_on_practices": [
        {
            "introduction": "生理死腔代表了高通气/灌注比值（$\\dot{V}/\\dot{Q}$）的极端情况，即肺单位虽有通气但无有效灌注。本练习通过应用经典的波尔方程，将可测量的气体分压（$P_{a,CO_2}$ 和 $P_{E,CO_2}$）与死腔分数（$V_D/V_T$）联系起来。这项实践是运用质量守恒原理来量化一种重要$\\dot{V}/\\dot{Q}$不匹配形式的基础训练。",
            "id": "3942478",
            "problem": "对一名处于稳态的受试者进行单次呼吸分析，以量化死腔容积相对于潮气量的分数。令$V_{T}$表示一次呼吸的潮气量，$V_{A}$表示参与二氧化碳交换的肺泡容积，$V_{D}$表示生理死腔容积。收集并分析混合呼出气，测量其二氧化碳分压，得到混合呼出气二氧化碳分压$P_{E,CO_{2}}$。同时测量的动脉血样本提供了动脉二氧化碳分压$P_{a,CO_{2}}$。假设在一次呼吸过程中组织中的二氧化碳储存量变化可忽略不计，理想气体定律适用于气相，因此气体成分与分压成正比，死腔气体不含二氧化碳（即解剖死腔加上不能有效清除二氧化碳的肺泡区域），并且肺泡气体中的二氧化碳与毛细血管末端血液达到平衡，因此在无扩散限制的稳态下，平均肺泡二氧化碳分压$P_{A,CO_{2}}$等于$P_{a,CO_{2}}$。利用一次呼吸过程中的二氧化碳守恒，推导死腔分数$V_{D}/V_{T}$关于$P_{a,CO_{2}}$和$P_{E,CO_{2}}$的表达式。然后，对于一个$P_{a,CO_{2}} = 5.3 \\,\\text{kPa}$和混合呼出气$P_{E,CO_{2}} = 3.7 \\,\\text{kPa}$的受试者，计算$V_{D}/V_{T}$。将你最终的$V_{D}/V_{T}$表示为一个无单位小数，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于呼吸生理学原理，提法明确，信息充分，可以得到唯一解，并且陈述客观。所提供的假设是推导生理死腔的Bohr方程的标准假设。\n\n推导从质量守恒原理开始，这里应用于一次呼出气中的二氧化碳（$CO_2$）体积。在单次潮气量$V_T$中呼出的$CO_2$总量是潮气量与混合呼出气$CO_2$分压$P_{E,CO_2}$的乘积。这个总呼出气是来自生理死腔$V_D$的气体和来自肺泡腔$V_A$的气体的混合物。\n\n潮气量被划分为这两个部分：\n$$V_T = V_A + V_D$$\n\n根据问题中理想气体定律适用的假设，给定体积中任何气体的量都与其分压成正比。因此，我们可以通过平衡总呼出气中的$CO_2$量与其各组成部分$CO_2$量的总和，来写出$CO_2$量的守恒方程。\n\n混合呼出气中$CO_2$的总量与$V_T \\times P_{E,CO_2}$成正比。\n源自死腔的气体被假定不含$CO_2$。因此，由死腔容积$V_D$贡献的$CO_2$量与$V_D \\times 0 = 0$成正比。\n源自肺泡腔的气体体积为$V_A$，其$CO_2$分压$P_{A,CO_2}$被假定与动脉血处于平衡状态。因此，根据问题陈述，$P_{A,CO_2} = P_{a,CO_2}$。由肺泡容积贡献的$CO_2$量与$V_A \\times P_{A,CO_2}$成正比。\n\n因此，守恒方程为：\n$$V_T \\cdot P_{E,CO_2} = (V_A \\cdot P_{A,CO_2}) + (V_D \\cdot 0)$$\n$$V_T \\cdot P_{E,CO_2} = V_A \\cdot P_{A,CO_2}$$\n\n我们可以将已知关系代入此方程。首先，用$P_{a,CO_2}$替换$P_{A,CO_2}$：\n$$V_T \\cdot P_{E,CO_2} = V_A \\cdot P_{a,CO_2}$$\n\n接下来，用潮气量$V_T$和死腔容积$V_D$表示肺泡容积$V_A$。从潮气量的划分可知，$V_A = V_T - V_D$。将此代入守恒方程得到：\n$$V_T \\cdot P_{E,CO_2} = (V_T - V_D) \\cdot P_{a,CO_2}$$\n\n为了推导死腔分数$\\frac{V_D}{V_T}$的表达式，我们对该方程进行代数重排。首先，展开右侧：\n$$V_T \\cdot P_{E,CO_2} = V_T \\cdot P_{a,CO_2} - V_D \\cdot P_{a,CO_2}$$\n\n分离出包含$V_D$的项：\n$$V_D \\cdot P_{a,CO_2} = V_T \\cdot P_{a,CO_2} - V_T \\cdot P_{E,CO_2}$$\n\n在右侧提取公因式$V_T$：\n$$V_D \\cdot P_{a,CO_2} = V_T (P_{a,CO_2} - P_{E,CO_2})$$\n\n最后，两边同时除以$V_T$和$P_{a,CO_2}$，得到死腔与潮气量之比的表达式：\n$$\\frac{V_D}{V_T} = \\frac{P_{a,CO_2} - P_{E,CO_2}}{P_{a,CO_2}}$$\n这就是所要求的表达式，称为Bohr方程。\n\n现在，我们根据给定的数据计算数值：$P_{a,CO_2} = 5.3 \\,\\text{kPa}$和$P_{E,CO_2} = 3.7 \\,\\text{kPa}$。\n$$\\frac{V_D}{V_T} = \\frac{5.3 - 3.7}{5.3}$$\n$$\\frac{V_D}{V_T} = \\frac{1.6}{5.3}$$\n$$\\frac{V_D}{V_T} \\approx 0.30188679...$$\n\n问题要求答案四舍五入到四位有效数字。\n$$\\frac{V_D}{V_T} \\approx 0.3019$$",
            "answer": "$$\\boxed{0.3019}$$"
        },
        {
            "introduction": "作为死腔概念的补充，本练习将探讨 $\\dot{V}/\\dot{Q}$ 谱的另一端：具有极低 $\\dot{V}/\\dot{Q}$ 比值的类分流单位。通过推导单个肺单位的 $\\dot{V}/\\dot{Q}$ 比值与其毛细血管末端氧分压（$P_{c'O_2}$）之间的关系，您将定量地理解这些单位如何将低氧合血混入动脉循环。这项实践有助于建立对 $\\dot{V}/\\dot{Q}$ 错配如何损害整体氧合作用的深刻认识。",
            "id": "3942460",
            "problem": "考虑一个在稳态下充分混合的肺泡-毛细血管单元，其肺泡通气量为 $\\dot{V}_{A}$，灌注量为 $\\dot{Q}$。将肺泡气体建模为大气压 $P_{B}$ 和饱和水蒸气压 $P_{H_{2}O}$ 下的理想混合气体，因此对于任何气体 $j$，其干气分压满足 $P_{A j} = F_{A j}\\,(P_{B}-P_{H_{2}O})$，其中 $F_{A j}$ 是肺泡干气分数。假设氧气跨肺泡-毛细血管膜的扩散瞬时达到平衡，因此毛细血管末端氧分压等于肺泡氧分压，即 $P_{c^{\\prime}O_{2}} = P_{A O_{2}}$。此外，为了分离通气-灌注比的影响，忽略血红蛋白的结合作用，并认为血液中的氧含量仅为溶解氧，其含量与压力呈线性关系 $C_{bO_{2}} = \\alpha_{b}\\,P_{O_{2}}$，其中 $\\alpha_{b}$ 是血液的氧溶解度，单位为毫升氧气（标准温度和压力下干燥状态，STPD）每毫升血液每毫米汞柱。\n\n仅从肺泡控制容积内氧气的稳态守恒（即通气流入减去流出等于血液的摄取量）出发，推导出一个关于 $P_{c^{\\prime}O_{2}}$ 的解析表达式，该表达式是无量纲通气-灌注比 $r = \\dot{V}_{A}/\\dot{Q}$、吸入气氧分压 $P_{I O_{2}}$、混合静脉血氧分压 $P_{v O_{2}}$、干气压力 $P_{B}-P_{H_{2}O}$ 和 $\\alpha_{b}$ 的函数。根据你的表达式，确定当 $r \\to 0$ 时 $P_{c^{\\prime}O_{2}}$ 的极限值，并从分流样行为的角度解释其生理学意义。\n\n然后，使用以下在海平面上符合生理现实的参数，对一个通气-灌注比为 $r = 0.01$ 的低通气单元，对你的表达式进行数值计算：\n- $P_{B} = 760$ mmHg，\n- $P_{H_{2}O} = 47$ mmHg，\n- 吸入气氧分数 $F_{I O_{2}} = 0.21$，因此 $P_{I O_{2}} = F_{I O_{2}}\\,(P_{B}-P_{H_{2}O})$，\n- 混合静脉血氧分压 $P_{v O_{2}} = 40$ mmHg，\n- 血液氧溶解度 $\\alpha_{b} = 3.1 \\times 10^{-5}$ mL O$_{2}$ (STPD) / (mL 血液 $\\cdot$ mmHg)。\n\n假设 $\\dot{V}_{A}$ 的单位是 mL STPD/分钟，$\\dot{Q}$ 的单位是 mL 血液/分钟，以使质量平衡在量纲上保持一致。报告计算出的 $r = 0.01$ 时的毛细血管末端氧分压 $P_{c^{\\prime}O_{2}}$（单位为 mmHg）。将答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于质量守恒和呼吸生理学原理，问题陈述清晰，提供了足够的信息以获得唯一解，并以客观、正式的语言呈现。我们可以继续进行求解。\n\n推导始于肺泡控制容积内氧气质量的稳态守恒原理。该原理指出，通过通气进入肺泡的氧气净速率必须等于流经肺泡毛细血管的血液摄取氧气的净速率。\n\n通过通气输送氧气的净速率是流入速率和流出速率之差。流入速率是肺泡通气量 $\\dot{V}_{A}$ 与吸入气氧分数 $F_{I O_{2}}$ 的乘积。流出速率是同一肺泡通气量 $\\dot{V}_{A}$ 与肺泡氧分数 $F_{A O_{2}}$ 的乘积。因此，进入控制容积的氧气净通气通量为 $\\dot{V}_{A} (F_{I O_{2}} - F_{A O_{2}})$。\n\n血液对氧气的摄取速率是血流量（灌注量）$\\dot{Q}$ 与离开毛细血管的血液（毛细血管末端血，$C_{c^{\\prime}O_2}$）和进入毛细血管的血液（混合静脉血，$C_{v O_2}$）之间氧含量的差值的乘积。此摄取速率为 $\\dot{Q}(C_{c^{\\prime}O_2} - C_{v O_2})$。\n\n在稳态下，将通气输送量与血液摄取量相等，得到质量平衡方程：\n$$\n\\dot{V}_{A} (F_{I O_{2}} - F_{A O_{2}}) = \\dot{Q} (C_{c^{\\prime}O_2} - C_{v O_2})\n$$\n问题提供了将气体分数和血液含量用分压表示的关系。\n对于任何气体 $j$，肺泡分压 $P_{A j}$ 与其干气分数 $F_{A j}$ 的关系为 $P_{A j} = F_{A j}(P_{B}-P_{H_{2}O})$。可以重新整理以表达分数：\n$$\nF_{A O_{2}} = \\frac{P_{A O_{2}}}{P_{B}-P_{H_{2}O}}\n$$\n同样，吸入气氧分数与吸入气分压的关系为 $F_{I O_{2}} = \\frac{P_{I O_{2}}}{P_{B}-P_{H_{2}O}}$。\n\n对于血液氧含量，问题指定了与分压的线性关系，忽略了血红蛋白的结合作用：$C_{bO_{2}} = \\alpha_{b} P_{O_{2}}$，其中 $\\alpha_{b}$ 是溶解度。因此：\n$$\nC_{c^{\\prime}O_{2}} = \\alpha_{b} P_{c^{\\prime}O_{2}}\n$$\n$$\nC_{v O_{2}} = \\alpha_{b} P_{v O_{2}}\n$$\n气体相和血液相之间的关键联系是瞬时扩散平衡的假设，即肺泡气体中的氧分压等于毛细血管末端血液中的氧分压：\n$$\nP_{A O_{2}} = P_{c^{\\prime}O_{2}}\n$$\n将这些表达式代入质量平衡方程：\n$$\n\\dot{V}_{A} \\left( \\frac{P_{I O_{2}}}{P_{B}-P_{H_{2}O}} - \\frac{P_{A O_{2}}}{P_{B}-P_{H_{2}O}} \\right) = \\dot{Q} (\\alpha_{b} P_{c^{\\prime}O_{2}} - \\alpha_{b} P_{v O_{2}})\n$$\n现在，我们用 $P_{c^{\\prime}O_{2}}$ 替换 $P_{A O_{2}}$ 并提出公因式：\n$$\n\\frac{\\dot{V}_{A}}{P_{B}-P_{H_{2}O}} (P_{I O_{2}} - P_{c^{\\prime}O_{2}}) = \\dot{Q} \\alpha_{b} (P_{c^{\\prime}O_{2}} - P_{v O_{2}})\n$$\n为了解出 $P_{c^{\\prime}O_{2}}$，我们引入无量纲的通气-灌注比 $r = \\dot{V}_{A}/\\dot{Q}$。方程两边同除以 $\\dot{Q}$：\n$$\n\\frac{r}{P_{B}-P_{H_{2}O}} (P_{I O_{2}} - P_{c^{\\prime}O_{2}}) = \\alpha_{b} (P_{c^{\\prime}O_{2}} - P_{v O_{2}})\n$$\n我们展开并重新整理各项以分离出 $P_{c^{\\prime}O_{2}}$：\n$$\n\\frac{r P_{I O_{2}}}{P_{B}-P_{H_{2}O}} - \\frac{r P_{c^{\\prime}O_{2}}}{P_{B}-P_{H_{2}O}} = \\alpha_{b} P_{c^{\\prime}O_{2}} - \\alpha_{b} P_{v O_{2}}\n$$\n$$\n\\frac{r P_{I O_{2}}}{P_{B}-P_{H_{2}O}} + \\alpha_{b} P_{v O_{2}} = P_{c^{\\prime}O_{2}} \\left( \\alpha_{b} + \\frac{r}{P_{B}-P_{H_{2}O}} \\right)\n$$\n解出 $P_{c^{\\prime}O_{2}}$ 得：\n$$\nP_{c^{\\prime}O_{2}} = \\frac{\\frac{r P_{I O_{2}}}{P_{B}-P_{H_{2}O}} + \\alpha_{b} P_{v O_{2}}}{\\alpha_{b} + \\frac{r}{P_{B}-P_{H_{2}O}}}\n$$\n为了得到一个更简洁的形式，我们将分子和分母同乘以 $(P_{B}-P_{H_{2}O})$：\n$$\nP_{c^{\\prime}O_{2}} = \\frac{r P_{I O_{2}} + \\alpha_{b} (P_{B}-P_{H_{2}O}) P_{v O_{2}}}{r + \\alpha_{b} (P_{B}-P_{H_{2}O})}\n$$\n这就是所要求的 $P_{c^{\\prime}O_{2}}$ 作为指定参数函数的解析表达式。\n\n接下来，我们分析当通气-灌注比 $r$ 趋近于零时的极限行为。\n$$\n\\lim_{r \\to 0} P_{c^{\\prime}O_{2}} = \\lim_{r \\to 0} \\frac{r P_{I O_{2}} + \\alpha_{b} (P_{B}-P_{H_{2}O}) P_{v O_{2}}}{r + \\alpha_{b} (P_{B}-P_{H_{2}O})} = \\frac{0 \\cdot P_{I O_{2}} + \\alpha_{b} (P_{B}-P_{H_{2}O}) P_{v O_{2}}}{0 + \\alpha_{b} (P_{B}-P_{H_{2}O})} = P_{v O_{2}}\n$$\n这个极限的生理学解释是，通气-灌注比 $r \\to 0$ 代表一种**分流**状态，即存在血流（$\\dot{Q} > 0$）但没有通气（$\\dot{V}_{A} \\to 0$）。在这样的单元中，带有分压 $P_{v O_{2}}$ 的混合静脉血流经毛细血管，但没有接触到任何新鲜的吸入气体。因此，该单元中的肺泡气体分压迅速与流入的混合静脉血的分压达到平衡。这导致 $P_{A O_{2}} = P_{v O_{2}}$。由于扩散平衡，毛细血管末端的分压也变得等于混合静脉血的分压，即 $P_{c^{\\prime}O_{2}} = P_{v O_{2}}$。没有气体交换发生，血液离开该单元时没有变化。\n\n最后，我们对一个通气-灌注比 $r=0.01$ 的低通气单元的 $P_{c^{\\prime}O_{2}}$ 表达式进行数值计算。给定的参数是：\n- $P_{B} = 760$ mmHg\n- $P_{H_{2}O} = 47$ mmHg\n- $F_{I O_{2}} = 0.21$\n- $P_{v O_{2}} = 40$ mmHg\n- $\\alpha_{b} = 3.1 \\times 10^{-5}$ mL O$_{2}$ (STPD) / (mL 血液 $\\cdot$ mmHg)\n\n首先，我们计算干气压力和吸入气氧分压：\n$$\nP_{B} - P_{H_{2}O} = 760 - 47 = 713 \\text{ mmHg}\n$$\n$$\nP_{I O_{2}} = F_{I O_{2}} (P_{B} - P_{H_{2}O}) = 0.21 \\times 713 = 149.73 \\text{ mmHg}\n$$\n现在我们将所有数值代入推导出的 $P_{c^{\\prime}O_{2}}$ 表达式中：\n$$\nP_{c^{\\prime}O_{2}} = \\frac{(0.01)(149.73) + (3.1 \\times 10^{-5})(713)(40)}{0.01 + (3.1 \\times 10^{-5})(713)}\n$$\n我们计算分子和分母中的各项：\n分子：\n$$\n(0.01)(149.73) = 1.4973\n$$\n$$\n(3.1 \\times 10^{-5})(713)(40) = 0.88412\n$$\n分子总和：$1.4973 + 0.88412 = 2.38142$\n分母：\n$$\n(3.1 \\times 10^{-5})(713) = 0.022103\n$$\n分母总和：$0.01 + 0.022103 = 0.032103$\n最后，我们计算比值：\n$$\nP_{c^{\\prime}O_{2}} = \\frac{2.38142}{0.032103} \\approx 74.18029 \\text{ mmHg}\n$$\n按照要求将此结果四舍五入到四位有效数字，我们得到 $74.18$ mmHg。",
            "answer": "$$\n\\boxed{74.18}\n$$"
        },
        {
            "introduction": "这项高级实践将您从分析单个肺单位或简单指标，提升到构建一个全面的肺部功能模型。您将通过编程实现一个计算模型，该模型通过对一个连续的、呈对数正态分布的 $\\dot{V}/\\dot{Q}$ 比值谱进行积分，来精确计算整体的动脉血氧含量 ($C_{aO_2}$)。这项实践展示了如何将微观隔室的行为整合成宏观系统级的预测，是现代定量生理学研究的核心方法之一。",
            "id": "3942501",
            "problem": "您正在使用通气-灌注比的灌注加权分布来模拟通气-灌注不均情况下的动脉血氧含量。考虑一个由连续的房室组成的肺模型，这些房室以通气-灌注比 $r = V_A/Q$ 为索引，其在 $r \\in (0,\\infty)$ 上遵循一个灌注加权的对数正态分布 $f(r;\\mu,\\sigma)$。动脉血氧含量 $C_{aO_2}$ 是毛细血管末端氧含量 $C_{cO_2}(r)$ 在此分布上的灌注加权平均值。\n\n使用以下基本原理和经过充分检验的公式来构建模型并计算 $C_{aO_2}$：\n\n1. 带有参数 $(\\mu,\\sigma)$ 的通气-灌注比的对数正态概率密度函数为\n$$\nf(r;\\mu,\\sigma) = \\frac{1}{r\\,\\sigma\\,\\sqrt{2\\pi}}\\exp\\left(-\\frac{(\\ln r - \\mu)^2}{2\\sigma^2}\\right),\n$$\n并且是灌注加权的。对于给定的灌注加权平均比值 $\\bar{r}$ 和不均一性 $\\sigma$，选择 $\\mu$ 使得 $\\mathbb{E}[r] = \\bar{r}$，即：\n$$\n\\mu = \\ln(\\bar{r}) - \\frac{\\sigma^2}{2}.\n$$\n\n2. 在比值为 $r$ 的房室中，稳态肺泡二氧化碳分压 $P_{A\\,CO_2}(r)$ 遵循质量平衡关系\n$$\nP_{A\\,CO_2}(r) = K \\frac{\\dot{V}_{CO_2}(r)}{V_A(r)},\n$$\n其中 $K = 863$ $\\mathrm{mmHg}$ 是标准转换常数，$\\dot{V}_{CO_2}(r)$ 是该房室的二氧化碳产生速率，$V_A(r)$ 是肺泡通气量。假设单位灌注量的代谢二氧化碳产生是均匀的，即 $\\dot{V}_{CO_2}(r) = \\nu\\,Q(r)$（其中 $\\nu > 0$ 为常数），并且根据 $r$ 的定义有 $V_A(r) = r\\,Q(r)$。在这些假设下，\n$$\nP_{A\\,CO_2}(r) = K\\,\\frac{\\nu}{r}.\n$$\n通过设定当 $r = 0.8$（一个典型的总体通气-灌注比）时 $P_{A\\,CO_2} = 40$ $\\mathrm{mmHg}$ 来校准 $\\nu$，即：\n$$\n\\nu = \\frac{40 \\cdot 0.8}{K}.\n$$\n\n3. 肺泡气体方程关联了肺泡中的氧气和二氧化碳：\n$$\nP_{A\\,O_2}(r) \\approx P_{I\\,O_2} - \\frac{P_{A\\,CO_2}(r)}{R},\n$$\n其中 $P_{I\\,O_2} = F_{I\\,O_2}\\,(P_B - P_{H_2O})$ 是吸入气氧分压，$F_{I\\,O_2}$ 是吸入氧分数，$P_B$ 是大气压，$P_{H_2O} = 47$ $\\mathrm{mmHg}$ 是体温下的水蒸气压，$R$ 是呼吸商（使用 $R = 0.8$）。通过取 $P_{A\\,O_2}(r) = \\max\\left(P_{I\\,O_2} - P_{A\\,CO_2}(r)/R, 0\\right)$ 来强制其为非负值。\n\n4. 毛细血管末端氧饱和度由 Hill 型氧解离曲线描述：\n$$\nS_{O_2}(r) = \\frac{P_{A\\,O_2}(r)^n}{P_{50}^n + P_{A\\,O_2}(r)^n},\n$$\n其中 $n$ 是 Hill 系数，$P_{50}$ 是 50%饱和度时的分压。在正常 pH 值下，使用 $n = 2.7$ 和 $P_{50} = 26.8$ $\\mathrm{mmHg}$。\n\n5. 毛细血管末端氧含量是与血红蛋白结合的氧和溶解氧的总和，\n$$\nC_{cO_2}(r) = 1.34\\,H_b\\,S_{O_2}(r) + \\alpha\\,P_{A\\,O_2}(r),\n$$\n其中血红蛋白浓度 $H_b$ 的单位为 $\\mathrm{g/dL}$，血红蛋白携氧能力为 $1.34$ $\\mathrm{mL\\,O_2/g}$，溶解氧溶解度为 $\\alpha = 0.003$ $\\mathrm{mL\\,O_2/(dL\\,mmHg)}$。取 $H_b = 15$ $\\mathrm{g/dL}$。\n\n6. 动脉血氧含量是在 $r$ 上的灌注加权期望：\n$$\nC_{aO_2} = \\int_{0}^{\\infty} C_{cO_2}(r)\\,f(r;\\mu,\\sigma)\\,dr.\n$$\n\n您的任务是实现一个程序，用两种方法计算 $C_{aO_2}$：\n- 对变换后的变量 $x = \\ln r$ 进行数值积分，因此\n$$\nC_{aO_2} = \\int_{-\\infty}^{\\infty} C_{cO_2}(e^{x})\\,\\frac{1}{\\sigma\\sqrt{2\\pi}}\\,\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)\\,dx,\n$$\n需认识到 $f(r)\\,dr$ 变成了 $x$ 中的正态密度乘以 $dx$。\n- 使用 $N$ 个区间进行离散近似，采用 $x = \\ln r$ 中正态分布的等概率分位数。令 $p_k = \\frac{k - 0.5}{N}$ (其中 $k = 1,\\dots,N$)，定义 $x_k = \\mu + \\sigma\\,\\Phi^{-1}(p_k)$ (其中 $\\Phi^{-1}$ 是标准正态分布的逆累积分布函数)，并设 $r_k = e^{x_k}$。通过简单平均值来近似 $C_{aO_2}$\n$$\n\\widehat{C}_{aO_2}^{(N)} = \\frac{1}{N}\\sum_{k=1}^{N} C_{cO_2}(r_k).\n$$\n通过取 $C_{aO_2} = C_{cO_2}(\\bar{r})$ 来处理 $\\sigma \\to 0$ 的极限情况。\n\n需使用的数值和物理常数：\n- $K = 863$ $\\mathrm{mmHg}$,\n- $R = 0.8$,\n- $P_{H_2O} = 47$ $\\mathrm{mmHg}$,\n- $P_B = 760$ $\\mathrm{mmHg}$,\n- $H_b = 15$ $\\mathrm{g/dL}$,\n- $\\alpha = 0.003$ $\\mathrm{mL\\,O_2/(dL\\,mmHg)}$,\n- $n = 2.7$,\n- $P_{50} = 26.8$ $\\mathrm{mmHg}$.\n\n$\\nu$ 的校准必须严格按照上述规定执行。所有氧含量必须以 $\\mathrm{mL\\,O_2/dL\\,blood}$ 为单位表示。\n\n测试套件：\n对于以下每一组参数，计算绝对差 $\\Delta = \\left|C_{aO_2}^{\\text{quadrature}} - \\widehat{C}_{aO_2}^{(N)}\\right|$（单位为 $\\mathrm{mL\\,O_2/dL\\,blood}$），确保科学上的合理性并覆盖边界和边缘情况：\n\n- 案例1（正常路径）：$F_{I\\,O_2} = 0.21$, $\\bar{r} = 0.8$, $\\sigma = 0.3$, $N = 50$。\n- 案例2（边界：无不均一性）：$F_{I\\,O_2} = 0.21$, $\\bar{r} = 0.8$, $\\sigma = 0$, $N = 50$。\n- 案例3（边缘：高度不均一性）：$F_{I\\,O_2} = 0.21$, $\\bar{r} = 0.8$, $\\sigma = 1.0$, $N = 50$。\n- 案例4（增加吸入氧）：$F_{I\\,O_2} = 0.50$, $\\bar{r} = 0.8$, $\\sigma = 0.3$, $N = 10$。\n- 案例5（平均通气-灌注比偏移）：$F_{I\\,O_2} = 0.21$, $\\bar{r} = 1.2$, $\\sigma = 0.3$, $N = 10$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含五个案例的结果，格式为方括号内由逗号分隔的列表。每个条目均表示 $\\Delta$（单位为 $\\mathrm{mL\\,O_2/dL\\,blood}$），并四舍五入到六位小数，例如：“[x1,x2,x3,x4,x5]”。",
            "solution": "该问题提出了一个在定量呼吸生理学领域中定义明确且有科学依据的任务。它要求在一个以通气-灌注（$\\dot{V}_A/\\dot{Q}$）不均一性为特征的肺模型中，实现并比较两种计算动脉血氧含量（$C_{aO_2}$）的数值方法。先验验证证实了该问题的严谨性，因为它基于已确立的生理学原理，提供了一整套内部一致的方程和参数，并提出了一个可形式化的、非平凡的计算挑战。我们将进行系统性的推导，并描述其计算实现。\n\n该模型是通过组合几个基本的生理学关系来构建的。最终我们感兴趣的量，$C_{aO_2}$，是一个聚合属性，通过对单个肺房室的行为在通气-灌注比（记为 $r$）的统计分布上进行积分而得到。\n\n**1. 模型组件和控制方程**\n\n为该模型规定了以下常数和参数：\n- 气体定律常数：$K = 863$ $\\mathrm{mmHg}$\n- 呼吸商：$R = 0.8$\n- 大气压：$P_B = 760$ $\\mathrm{mmHg}$\n- 体温下水蒸气压：$P_{H_2O} = 47$ $\\mathrm{mmHg}$\n- 血红蛋白浓度：$H_b = 15$ $\\mathrm{g/dL}$\n- 血红蛋白携氧能力：$1.34$ $\\mathrm{mL\\,O_2/g}$\n- 血液中氧溶解度：$\\alpha = 0.003$ $\\mathrm{mL\\,O_2/(dL\\,mmHg)}$\n- 氧饱和度的 Hill 方程系数：$n = 2.7$\n- 半饱和氧分压：$P_{50} = 26.8$ $\\mathrm{mmHg}$\n\n模型的核心是函数 $C_{cO_2}(r)$，它描述了离开一个具有给定通气-灌注比 $r$ 的肺房室的血液中的氧含量。该函数是几个子模型的复合：\n\n**a. 肺泡气体成分**\n\n首先，我们确定肺泡中的二氧化碳分压 $P_{A\\,CO_2}(r)$。假设单位灌注量的代谢 $CO_2$ 产生是均匀的，即 $\\dot{V}_{CO_2}(r) = \\nu\\,\\dot{Q}(r)$，则肺泡 $CO_2$ 由质量平衡方程给出：\n$$\nP_{A\\,CO_2}(r) = K \\frac{\\dot{V}_{CO_2}(r)}{\\dot{V}_A(r)} = K \\frac{\\nu\\,\\dot{Q}(r)}{r\\,\\dot{Q}(r)} = K\\frac{\\nu}{r}\n$$\n常数 $\\nu$ 通过设定一个典型比值 $r=0.8$ 的房室具有 $P_{A\\,CO_2}$ 为 $40$ $\\mathrm{mmHg}$ 来进行校准：\n$$\n40 = K\\frac{\\nu}{0.8} \\implies \\nu = \\frac{40 \\cdot 0.8}{K} = \\frac{32}{863}\n$$\n代入此值可得到 $P_{A\\,CO_2}(r)$ 的最终表达式：\n$$\nP_{A\\,CO_2}(r) = \\frac{32}{r} \\,\\mathrm{mmHg}\n$$\n接着，使用简化的肺泡气体方程来求得肺泡氧分压 $P_{A\\,O_2}(r)$。吸入气氧分压 $P_{I\\,O_2}$ 由 $P_{I\\,O_2} = F_{I\\,O_2}(P_B - P_{H_2O})$ 给出，其中 $F_{I\\,O_2}$ 是吸入氧分数。\n$$\nP_{A\\,O_2}(r) = P_{I\\,O_2} - \\frac{P_{A\\,CO_2}(r)}{R} = F_{I\\,O_2}(760 - 47) - \\frac{32/r}{0.8} = 713\\,F_{I\\,O_2} - \\frac{40}{r}\n$$\n为确保物理真实性，氧分压不能为负。因此，我们定义：\n$$\nP_{A\\,O_2}(r) = \\max\\left(713\\,F_{I\\,O_2} - \\frac{40}{r}, 0\\right)\n$$\n\n**b. 毛细血管末端氧含量**\n\n离开毛细血管的血液中的氧含量 $C_{cO_2}(r)$ 是与血红蛋白结合的氧和溶解在血浆中的氧的总和。与血红蛋白结合的部分取决于氧饱和度 $S_{O_2}(r)$，它使用计算出的 $P_{A\\,O_2}(r)$ 通过 Hill 方程建模：\n$$\nS_{O_2}(r) = \\frac{P_{A\\,O_2}(r)^n}{P_{50}^n + P_{A\\,O_2}(r)^n} = \\frac{P_{A\\,O_2}(r)^{2.7}}{26.8^{2.7} + P_{A\\,O_2}(r)^{2.7}}\n$$\n那么，总的毛细血管末端氧含量为：\n$$\nC_{cO_2}(r) = 1.34\\,H_b\\,S_{O_2}(r) + \\alpha\\,P_{A\\,O_2}(r) = 1.34 \\cdot 15 \\cdot S_{O_2}(r) + 0.003 \\cdot P_{A\\,O_2}(r)\n$$\n$$\nC_{cO_2}(r) = 20.1\\,S_{O_2}(r) + 0.003\\,P_{A\\,O_2}(r)\n$$\n这个复合函数 $C_{cO_2}(r)$ 封装了单个肺单位的生理行为。\n\n**2. 在 V/Q 分布上的聚合**\n\n动脉血氧含量 $C_{aO_2}$ 是整个肺部 $C_{cO_2}(r)$ 的灌注加权平均值。通气-灌注比的分布被建模为对数正态分布，这是一种标准且经过充分验证的方法。概率密度函数由下式给出：\n$$\nf(r;\\mu,\\sigma) = \\frac{1}{r\\,\\sigma\\,\\sqrt{2\\pi}}\\exp\\left(-\\frac{(\\ln r - \\mu)^2}{2\\sigma^2}\\right)\n$$\n参数 $\\mu$ 的选择是为了匹配给定的灌注加权平均比值 $\\bar{r}$：\n$$\n\\mu = \\ln(\\bar{r}) - \\frac{\\sigma^2}{2}\n$$\n动脉血氧含量是 $C_{cO_2}(r)$ 关于此分布的期望值：\n$$\nC_{aO_2} = \\int_{0}^{\\infty} C_{cO_2}(r)\\,f(r;\\mu,\\sigma)\\,dr\n$$\n对于均质肺的特殊情况，即 $\\sigma=0$，分布坍缩为在 $r=\\bar{r}$ 处的狄拉克(Dirac)δ函数。在这种情况下，$C_{aO_2} = C_{cO_2}(\\bar{r})$。\n\n**3. 数值计算方法**\n\n任务是使用两种不同的数值方案计算 $C_{aO_2}$，并求出其结果之间的绝对差 $\\Delta$。\n\n**方法1：数值积分**\n通过进行变量替换 $x = \\ln r$（因此 $r = e^x$ 且 $dr = r\\,dx = e^x dx$），$C_{aO_2}$ 的积分转换为关于标准正态概率密度函数的积分，这在计算上是有利的。\n$$\nC_{aO_2} = \\int_{-\\infty}^{\\infty} C_{cO_2}(e^{x})\\,\\frac{1}{\\sigma\\sqrt{2\\pi}}\\,\\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)\\,dx\n$$\n这个定积分，记为 $C_{aO_2}^{\\text{quadrature}}$，可以使用标准的数值积分程序（如 `scipy.integrate.quad`）高效而准确地计算。\n\n**方法2：基于分位数的离散近似**\n该方法用一个包含 $N$ 个房室的有限集合来近似连续的肺模型。这些房室的 V/Q 比值 $r_k$ 被选择来代表灌注分布的等概率区间。这是通过使用 $x = \\ln r$ 的底层正态分布的分位数来实现的。\n对于 $k = 1, \\dots, N$，我们定义：\n- 概率分位数：$p_k = \\frac{k - 0.5}{N}$\n- 对数转换后的 V/Q 比值：$x_k = \\mu + \\sigma\\,\\Phi^{-1}(p_k)$，其中 $\\Phi^{-1}$ 是标准正态分布 $\\mathcal{N}(0,1)$ 的逆累积分布函数(CDF)。\n- V/Q 比值：$r_k = e^{x_k}$\n动脉血氧含量随后通过这 $N$ 个房室的氧含量的简单算术平均值来近似：\n$$\n\\widehat{C}_{aO_2}^{(N)} = \\frac{1}{N}\\sum_{k=1}^{N} C_{cO_2}(r_k)\n$$\n这是一种蒙特卡洛积分的形式，其中样本是从逆 CDF 中确定性地抽取的。逆正态 CDF $\\Phi^{-1}$ 在 `scipy.special.ndtri` 中实现。\n\n**4. 最终计算**\n对于每个测试案例，我们计算 $C_{aO_2}^{\\text{quadrature}}$ 和 $\\widehat{C}_{aO_2}^{(N)}$ 并报告其绝对差：\n$$\n\\Delta = \\left|C_{aO_2}^{\\text{quadrature}} - \\widehat{C}_{aO_2}^{(N)}\\right|\n$$\n对于 $\\sigma=0$ 的边界情况，两种方法都得出相同的结果 $C_{cO_2}(\\bar{r})$，因此根据定义 $\\Delta = 0$。以下程序实现了这一逻辑。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Computes and compares arterial oxygen content using two numerical methods\n    for several test cases of ventilation-perfusion heterogeneity.\n    \"\"\"\n    # Define physical and model constants\n    K = 863.0  # mmHg\n    R = 0.8\n    P_B = 760.0  # mmHg\n    P_H2O = 47.0  # mmHg\n    H_b = 15.0  # g/dL\n    O2_CAP = 1.34  # mL O2/g Hb\n    ALPHA_O2 = 0.003  # mL O2/(dL*mmHg)\n    HILL_N = 2.7\n    P_50 = 26.8  # mmHg\n\n    # Calibrate nu based on reference condition\n    NU = (40.0 * 0.8) / K\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (F_I_O2, r_bar, sigma, N)\n        (0.21, 0.8, 0.3, 50),\n        (0.21, 0.8, 0.0, 50),\n        (0.21, 0.8, 1.0, 50),\n        (0.50, 0.8, 0.3, 10),\n        (0.21, 1.2, 0.3, 10),\n    ]\n\n    results = []\n    for F_I_O2, r_bar, sigma, N in test_cases:\n\n        # Define the composite function for end-capillary oxygen content C_cO2(r)\n        # This function depends on F_I_O2, so it's defined within the loop.\n        P_I_O2 = F_I_O2 * (P_B - P_H2O)\n        \n        def calculate_c_co2(r):\n            if r == 0:\n                # Handle the mathematical singularity and physiological limit\n                return 0.0\n\n            # 1. Alveolar CO2\n            P_A_CO2 = K * NU / r\n            \n            # 2. Alveolar O2 from Alveolar Gas Equation\n            P_A_O2 = P_I_O2 - P_A_CO2 / R\n            P_A_O2 = max(0.0, P_A_O2)\n\n            # 3. Oxygen Saturation (Hill Equation)\n            S_O2 = (P_A_O2**HILL_N) / (P_50**HILL_N + P_A_O2**HILL_N)\n            \n            # 4. Total Oxygen Content (Bound + Dissolved)\n            c_co2 = (O2_CAP * H_b * S_O2) + (ALPHA_O2 * P_A_O2)\n            \n            return c_co2\n\n        # Handle the special case of zero heterogeneity\n        if sigma == 0.0:\n            # Both methods converge to C_cO2(r_bar), so the difference is zero.\n            delta = 0.0\n            results.append(f\"{delta:.6f}\")\n            continue\n\n        # Calculate the log-normal distribution parameter mu\n        mu = np.log(r_bar) - (sigma**2) / 2.0\n\n        # Method 1: Numerical Quadrature\n        def integrand(x):\n            r = np.exp(x)\n            c_co2_val = calculate_c_co2(r)\n            # Normal PDF for x = ln(r)\n            pdf = (1 / (sigma * np.sqrt(2 * np.pi))) * np.exp(-((x - mu)**2) / (2 * sigma**2))\n            return c_co2_val * pdf\n        \n        # Integrate from -inf to +inf\n        c_ao2_quadrature, _ = integrate.quad(integrand, -np.inf, np.inf)\n\n        # Method 2: Discretized Quantile-Based Approximation\n        # Generate N equal-probability quantiles\n        p_k = (np.arange(1, N + 1) - 0.5) / N\n        \n        # Use inverse normal CDF (probit function) to find x_k values\n        # scipy.special.ndtri is the inverse CDF of the standard normal N(0,1)\n        x_k = mu + sigma * special.ndtri(p_k)\n        \n        # Convert log-ratios back to r-values\n        r_k = np.exp(x_k)\n        \n        # Calculate C_cO2 for each discrete compartment\n        c_co2_k_values = np.array([calculate_c_co2(r_val) for r_val in r_k])\n        \n        # Approximate C_aO2 as the simple average\n        c_ao2_discrete = np.mean(c_co2_k_values)\n        \n        # Calculate the absolute difference\n        delta = abs(c_ao2_quadrature - c_ao2_discrete)\n        results.append(f\"{delta:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solution\n# solve()\n```",
            "answer": "$$\\boxed{\\text{[0.000088,0.000000,0.013442,0.000378,0.000305]}}$$"
        }
    ]
}