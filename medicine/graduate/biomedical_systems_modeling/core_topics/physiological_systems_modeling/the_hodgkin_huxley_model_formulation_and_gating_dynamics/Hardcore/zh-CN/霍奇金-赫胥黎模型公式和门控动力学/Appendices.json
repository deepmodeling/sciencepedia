{
    "hands_on_practices": [
        {
            "introduction": "在深入研究 Hodgkin-Huxley 模型中复杂的离子通道动力学之前，我们首先要掌握神经元膜最基本的电学特性。细胞膜的核心功能之一是作为电容器，能够分离和储存电荷。本练习 () 通过一个理想化的场景——所有离子通道均被药理学方法阻断——来帮助你专注于这一基本原理，让你能够清晰地看到外加电流如何为膜电容充电，从而直接改变膜电位。",
            "id": "3937578",
            "problem": "考虑一个在Hodgkin–Huxley框架下建模的空间等电位神经元膜片，其中电压门控离子通道被药物阻断，因此没有离子电流流过。假设该膜片可以用单位面积的平行板电容器很好地描述，其单位面积电容为 $C_m$，并且唯一的跨膜电流是由电流钳电极施加的方形恒定电流密度 $I_{\\mathrm{app}}$。采用标准的生物物理符号约定，即正的施加电流密度流入细胞（去极化），并设膜电压为 $V(t)$，初始条件为 $V(0)$。\n\n基本依据：\n- 电荷守恒，具体体现为基尔霍夫电流定律（KCL）。对于单位面积的膜片，该定律指出电流总和为零。\n- 电容器的本构关系 $q = C V$ 及其微分形式 $i_C = C \\, dV/dt$。\n\n给定 $C_m = 1\\,\\mu\\mathrm{F/cm}^2$、$I_{\\mathrm{app}} = 5\\,\\mu\\mathrm{A/cm}^2$ 和 $V(0) = -65\\,\\mathrm{mV}$，并假设对于所有 $t$ 都有 $I_{\\mathrm{ion}}(t) = 0$（因为所有离子通道被完全阻断，离子电导有效为零，与门控变量无关），推导在 $t \\in [0, 2\\,\\mathrm{ms}]$ 范围内的膜电压 $V(t)$。\n\n将 $V(t)$ 的最终公式表示为以毫秒为单位的 $t$ 的函数，单位为毫伏。无需四舍五入。最终答案必须是单一的闭合形式解析表达式。",
            "solution": "用户提供的问题被评估为有效。它在科学上基于膜生物物理学的原理，是一个适定的一阶初值问题，并且陈述客观，提供了所有必要信息。\n\n膜电压 $V(t)$ 的推导源于电荷守恒基本原理，即基尔霍夫电流定律（KCL）在膜片上的应用。流过膜的总电流密度是电容电流密度 $I_C(t)$ 和离子电流密度 $I_{\\mathrm{ion}}(t)$ 的总和。这个总膜电流密度必须等于外部施加的电流密度 $I_{\\mathrm{app}}$。单位面积的控制方程为：\n$$I_{\\mathrm{app}} = I_C(t) + I_{\\mathrm{ion}}(t)$$\n\n问题陈述所有电压门控离子通道均被药物阻断，这意味着离子电导为零。因此，对于所有时间 $t$，总离子电流密度为零：\n$$I_{\\mathrm{ion}}(t) = 0$$\n\n在此条件下，KCL 方程简化为：\n$$I_{\\mathrm{app}} = I_C(t)$$\n\n问题还指明膜的行为类似于电容器，其电容电流密度的本构关系由下式给出：\n$$I_C(t) = C_m \\frac{dV(t)}{dt}$$\n其中 $C_m$ 是单位面积的膜电容，$V(t)$ 是膜电压。\n\n将电容电流关系代入简化的 KCL 方程，得到在此特定条件下控制膜电压动态的一阶常微分方程 (ODE)：\n$$I_{\\mathrm{app}} = C_m \\frac{dV(t)}{dt}$$\n\n施加的电流密度 $I_{\\mathrm{app}}$ 是一个恒定值。我们可以重新整理该 ODE 以求解 $V(t)$：\n$$\\frac{dV}{dt} = \\frac{I_{\\mathrm{app}}}{C_m}$$\n\n这是一个可分离的微分方程。我们对等式两边进行积分，时间从初始时刻 $t=0$ 到任意时刻 $t$。电压从其初始值 $V(0)$ 积分到时刻 $t$ 的值 $V(t)$：\n$$\\int_{V(0)}^{V(t)} dV' = \\int_{0}^{t} \\frac{I_{\\mathrm{app}}}{C_m} dt'$$\n\n由于 $I_{\\mathrm{app}}$ 和 $C_m$ 是常数，积分结果为：\n$$V(t) - V(0) = \\frac{I_{\\mathrm{app}}}{C_m} t$$\n\n求解 $V(t)$，我们得到膜电压的通解：\n$$V(t) = V(0) + \\left(\\frac{I_{\\mathrm{app}}}{C_m}\\right) t$$\n\n问题要求 $V(t)$ 的最终公式以毫伏 ($\\mathrm{mV}$) 为单位，作为时间 $t$（以毫秒 $\\mathrm{ms}$ 为单位）的函数。为实现这一点，我们代入给定值并进行单位分析。\n给定的参数是：\n- $C_m = 1\\,\\mu\\mathrm{F/cm}^2 = 1 \\times 10^{-6}\\,\\mathrm{F/cm}^2$\n- $I_{\\mathrm{app}} = 5\\,\\mu\\mathrm{A/cm}^2 = 5 \\times 10^{-6}\\,\\mathrm{A/cm}^2$\n- $V(0) = -65\\,\\mathrm{mV}$\n\n首先，我们计算比率 $\\frac{I_{\\mathrm{app}}}{C_m}$：\n$$\\frac{I_{\\mathrm{app}}}{C_m} = \\frac{5 \\times 10^{-6}\\,\\mathrm{A/cm}^2}{1 \\times 10^{-6}\\,\\mathrm{F/cm}^2} = 5\\,\\frac{\\mathrm{A}}{\\mathrm{F}}$$\n回顾安培 ($A = C/s$) 和法拉 ($F = C/V$) 的定义，该比率的单位变为：\n$$5\\,\\frac{\\mathrm{A}}{\\mathrm{F}} = 5\\,\\frac{\\mathrm{C/s}}{\\mathrm{C/V}} = 5\\,\\mathrm{V/s}$$\n因此，电压的变化率为 $5$ 伏特/秒。当 $V(t)$ 以伏特为单位，$t$ 以秒为单位时，方程为：\n$$V(t)|_{\\text{in V}} = (-65 \\times 10^{-3}\\,\\mathrm{V}) + (5\\,\\mathrm{V/s}) \\cdot t|_{\\text{in s}}$$\n\n为了将其转换为所需的单位（毫伏和毫秒），我们可以转换变化率：\n$$5\\,\\frac{\\mathrm{V}}{\\mathrm{s}} = 5\\,\\frac{10^3\\,\\mathrm{mV}}{10^3\\,\\mathrm{ms}} = 5\\,\\frac{\\mathrm{mV}}{\\mathrm{ms}}$$\n因此，电压变化率为 $5$ 毫伏/毫秒。现在让 $V$ 代表以 $\\mathrm{mV}$ 为单位的电压，$t$ 代表以 $\\mathrm{ms}$ 为单位的时间。在这些单位下的微分方程是：\n$$\\frac{dV}{dt} = 5\\,\\mathrm{mV/ms}$$\n用初始条件 $V(0) = -65\\,\\mathrm{mV}$ 对该方程进行积分，得到：\n$$V(t) = -65 + 5t$$\n其中 $V(t)$ 的单位是毫伏，$t$ 的单位是毫秒。这种线性关系表明，恒定的施加电流以恒定的速率为膜电容器充电，导致电压随时间线性增加。只要条件保持不变，该公式在指定区间 $t \\in [0, 2\\,\\mathrm{ms}]$ 及以后都有效。",
            "answer": "$$\\boxed{-65 + 5t}$$"
        },
        {
            "introduction": "掌握了膜的被动电容特性后，我们现在将注意力转向产生神经兴奋性的主动元件：电压门控离子通道。Hodgkin-Huxley 模型的核心在于其对钠离子 ($I_{Na}$) 和钾离子 ($I_{K}$) 电流的精确数学描述。本练习 () 要求你直接应用模型的门控动力学公式，通过给定的门控变量值 ($m, h, n$) 计算出在特定膜电位下的离子电流大小，从而加深对门控粒子如何协同控制离子流的理解。",
            "id": "3937565",
            "problem": "在经典的 Hodgkin–Huxley (HH) 可兴奋膜模型中，每种离子通道只有在其所有门控粒子都处于其容许（开放）状态时才会导通，并且假定门控粒子是独立作用的。对于钠通道，假设存在三个相同的激活门和一个失活门；对于钾通道，假设存在四个相同的激活门。对于一种离子，其膜电流密度与最大电导密度、通道的开放概率以及电化学驱动力成正比，这与欧姆传导一致。考虑一块膜片，其膜电位维持在 $V=0\\,\\mathrm{mV}$，并具有以下参数值：钠最大电导密度 $\\bar{g}_{Na}=120\\,\\mathrm{mS/cm}^{2}$，钠激活门控变量 $m=0.5$，钠失活门控变量 $h=0.6$，以及钠反转电位 $E_{Na}=50\\,\\mathrm{mV}$；钾最大电导密度 $\\bar{g}_{K}=36\\,\\mathrm{mS/cm}^{2}$，钾激活门控变量 $n=0.4$，以及钾反转电位 $E_{K}=-77\\,\\mathrm{mV}$。利用门的独立性以及上述 HH 机制性解释，推导在此膜电位下的钠和钾电流密度。然后，报告它们幅值的比率作为您的最终答案，\n$$R=\\frac{|I_{Na}|}{|I_{K}|}.$$\n将您的答案四舍五入至四位有效数字。在计算中间离子电流时，请以 $\\mathrm{mA/cm}^{2}$ 为单位表示。",
            "solution": "首先对问题进行验证，以确保其科学基础扎实、提法恰当且客观。\n\n**步骤 1：提取已知条件**\n- 模型：经典 Hodgkin–Huxley (HH) 公式。\n- 通道操作：所有门控粒子必须处于容许（开放）状态才能导通。\n- 门独立性：门控粒子独立作用。\n- 钠通道：$3$ 个相同的激活门（$m$-门），$1$ 个失活门（$h$-门）。\n- 钾通道：$4$ 个相同的激活门（$n$-门）。\n- 电流密度定律：$I_{ion} \\propto (\\text{maximal conductance density}) \\times (\\text{open probability}) \\times (\\text{electrochemical driving force})$。\n- 膜电位：$V = 0\\,\\mathrm{mV}$。\n- 钠最大电导密度：$\\bar{g}_{Na} = 120\\,\\mathrm{mS/cm}^{2}$。\n- 钠激活门控变量：$m = 0.5$。\n- 钠失活门控变量：$h = 0.6$。\n- 钠反转电位：$E_{Na} = 50\\,\\mathrm{mV}$。\n- 钾最大电导密度：$\\bar{g}_{K} = 36\\,\\mathrm{mS/cm}^{2}$。\n- 钾激活门控变量：$n = 0.4$。\n- 钾反转电位：$E_{K} = -77\\,\\mathrm{mV}$。\n- 要求输出：钠和钾电流密度幅值的比率，$R = \\frac{|I_{Na}|}{|I_{K}|}$，四舍五入到四位有效数字。\n- 中间单位：电流密度以 $\\mathrm{mA/cm}^{2}$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是 Hodgkin-Huxley 模型的标准应用，该模型是计算神经科学的基石。通道门控的描述、电流流动的欧姆性质以及给定的参数值都与经典公式和典型的生理数值相符。该问题是自包含的，为计算提供了所有必要的数据。定义清晰明确。该问题在科学上是合理的、提法恰当的、客观的且可形式化的。\n\n**步骤 3：结论和行动**\n问题有效。将提供完整的解答。\n\n**解题推导**\n\n在 Hodgkin-Huxley 模型中，特定离子种类的电流密度 $I_{ion}$ 由其电导密度 $g_{ion}$ 和其电化学驱动力 $(V - E_{ion})$ 的乘积给出：\n$$I_{ion} = g_{ion} (V - E_{ion})$$\n电导密度 $g_{ion}$ 是最大电导密度 $\\bar{g}_{ion}$ 乘以通道处于其开放、导通状态的概率 $P_{open}$：\n$$g_{ion} = \\bar{g}_{ion} P_{open}$$\n概率 $P_{open}$ 由通道门控粒子的状态决定。\n\n首先，我们推导钠电流密度 $I_{Na}$。\n问题指出，一个钠通道有 $3$ 个相同的激活门（$m$-门）和 $1$ 个失活门（$h$-门）。单个 $m$-门开放的概率由变量 $m$ 给出，单个 $h$-门开放的概率由变量 $h$ 给出。由于假定门是独立作用的，整个通道开放的概率 $P_{Na, open}$ 是其所有门处于容许状态的概率的乘积：\n$$P_{Na, open} = m \\cdot m \\cdot m \\cdot h = m^{3}h$$\n因此，钠电流密度 $I_{Na}$ 为：\n$$I_{Na} = \\bar{g}_{Na} m^{3} h (V - E_{Na})$$\n我们代入给定值：$\\bar{g}_{Na} = 120\\,\\mathrm{mS/cm}^{2}$，$m = 0.5$，$h = 0.6$，$V = 0\\,\\mathrm{mV}$，以及 $E_{Na} = 50\\,\\mathrm{mV}$。\n$$I_{Na} = (120\\,\\mathrm{mS/cm}^{2}) \\cdot (0.5)^{3} \\cdot (0.6) \\cdot (0\\,\\mathrm{mV} - 50\\,\\mathrm{mV})$$\n$$I_{Na} = (120\\,\\mathrm{mS/cm}^{2}) \\cdot (0.125) \\cdot (0.6) \\cdot (-50\\,\\mathrm{mV})$$\n$$I_{Na} = (120 \\cdot 0.125 \\cdot 0.6) \\cdot (-50) \\, \\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\n电导项为 $(120 \\cdot 0.075) = 9\\,\\mathrm{mS/cm}^{2}$。\n$$I_{Na} = (9\\,\\mathrm{mS/cm}^{2}) \\cdot (-50\\,\\mathrm{mV}) = -450\\,\\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\n单位 $\\mathrm{mS} \\cdot \\mathrm{mV}$ 等价于 $\\mu\\mathrm{A}$ ($10^{-3}\\,\\mathrm{S} \\cdot 10^{-3}\\,\\mathrm{V} = 10^{-6}\\,\\mathrm{A} = 1\\,\\mu\\mathrm{A}$)。\n因此，$I_{Na} = -450\\,\\mu\\mathrm{A/cm}^{2}$。\n根据对中间值的要求，我们将其转换为 $\\mathrm{mA/cm}^{2}$：\n$$I_{Na} = -450\\,\\mu\\mathrm{A/cm}^{2} \\times \\frac{1\\,\\mathrm{mA}}{1000\\,\\mu\\mathrm{A}} = -0.45\\,\\mathrm{mA/cm}^{2}$$\n\n接下来，我们推导钾电流密度 $I_{K}$。\n钾通道有 $4$ 个相同的激活门（$n$-门）。单个 $n$-门开放的概率由变量 $n$ 给出。整个通道开放的概率 $P_{K, open}$ 为：\n$$P_{K, open} = n \\cdot n \\cdot n \\cdot n = n^{4}$$\n因此，钾电流密度 $I_{K}$ 为：\n$$I_{K} = \\bar{g}_{K} n^{4} (V - E_{K})$$\n我们代入给定值：$\\bar{g}_{K} = 36\\,\\mathrm{mS/cm}^{2}$，$n = 0.4$，$V = 0\\,\\mathrm{mV}$，以及 $E_{K} = -77\\,\\mathrm{mV}$。\n$$I_{K} = (36\\,\\mathrm{mS/cm}^{2}) \\cdot (0.4)^{4} \\cdot (0\\,\\mathrm{mV} - (-77\\,\\mathrm{mV}))$$\n$$I_{K} = (36\\,\\mathrm{mS/cm}^{2}) \\cdot (0.0256) \\cdot (77\\,\\mathrm{mV})$$\n$$I_{K} = (36 \\cdot 0.0256) \\cdot (77) \\, \\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\n电导项为 $(36 \\cdot 0.0256) = 0.9216\\,\\mathrm{mS/cm}^{2}$。\n$$I_{K} = (0.9216\\,\\mathrm{mS/cm}^{2}) \\cdot (77\\,\\mathrm{mV}) = 70.9632\\,\\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\n这对应于 $I_{K} = 70.9632\\,\\mu\\mathrm{A/cm}^{2}$。\n以 $\\mathrm{mA/cm}^{2}$ 为单位，此值为：\n$$I_{K} = 70.9632\\,\\mu\\mathrm{A/cm}^{2} \\times \\frac{1\\,\\mathrm{mA}}{1000\\,\\mu\\mathrm{A}} = 0.0709632\\,\\mathrm{mA/cm}^{2}$$\n\n最后，我们计算这些电流密度幅值的比率 $R$。\n$$R = \\frac{|I_{Na}|}{|I_{K}|}$$\n使用单位为 $\\mu\\mathrm{A/cm}^{2}$ 的电流以避免中间舍入：\n$$|I_{Na}| = |-450\\,\\mu\\mathrm{A/cm}^{2}| = 450\\,\\mu\\mathrm{A/cm}^{2}$$\n$$|I_{K}| = |70.9632\\,\\mu\\mathrm{A/cm}^{2}| = 70.9632\\,\\mu\\mathrm{A/cm}^{2}$$\n$$R = \\frac{450}{70.9632} \\approx 6.34125036$$\n问题要求将答案四舍五入到四位有效数字。\n$$R \\approx 6.341$$",
            "answer": "$$\n\\boxed{6.341}\n$$"
        },
        {
            "introduction": "在分别探讨了膜的被动电容和主动离子电流之后，是时候将这些部分整合起来，解决一个核心的生理学问题：神经元在没有外部刺激时的稳定电压，即静息电位 ($V_{rest}$)。静息电位是一个平衡点，在该点上，所有跨膜电流（钠电流、钾电流和泄漏电流）的总和为零。本练习 () 将引导你通过数值方法求解这个非线性平衡方程，让你亲身体验如何运用 Hodgkin-Huxley 模型来预测神经元的基本生理状态，并理解计算工具在现代神经科学研究中的关键作用。",
            "id": "3937544",
            "problem": "生物医学系统建模的一个核心目标是确定由 Hodgkin–Huxley (HH) 模型控制的可兴奋膜的平衡态。该模型描述了通过电压门控通道和被动泄漏通路的离子电流。从膜片上的电荷守恒和基尔霍夫电流定律出发，膜遵循以下方程：$$C \\frac{dV}{dt} = -\\left(I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}} + I_{\\mathrm{ext}}\\right),$$ 其中 $C$ 是单位面积的膜电容，$V$ 是以 $\\mathrm{mV}$ 为单位的膜电位，$I_{\\mathrm{Na}}, I_{\\mathrm{K}}, I_{\\mathrm{L}}$ 是以 $\\mathrm{mA/cm}^2$ 为单位的钠、钾和泄漏电流密度，而 $I_{\\mathrm{ext}}$ 是以 $\\mathrm{mA/cm}^2$ 为单位的任何外部施加的电流密度。Hodgkin–Huxley (HH) 模型将离子电流表示为：$$I_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3 h\\, (V - E_{\\mathrm{Na}}),\\quad I_{\\mathrm{K}} = \\bar{g}_{\\mathrm{K}}\\, n^4\\, (V - E_{\\mathrm{K}}),\\quad I_{\\mathrm{L}} = g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}}),$$ 其中 $\\bar{g}_{\\mathrm{Na}}, \\bar{g}_{\\mathrm{K}}$ 和 $g_{\\mathrm{L}}$ 是以 $\\mathrm{mS/cm}^2$ 为单位的最大电导密度和泄漏电导密度，$E_{\\mathrm{Na}}, E_{\\mathrm{K}}, E_{\\mathrm{L}}$ 是以 $\\mathrm{mV}$ 为单位的相应反转电位，而 $m, h, n$ 是无量纲的门控变量，反映了处于允许状态的通道亚基的比例。门控变量遵循以下形式的一级动力学：$$\\frac{dx}{dt} = \\alpha_x(V)\\left(1 - x\\right) - \\beta_x(V)\\, x,\\quad x \\in \\{m,h,n\\},$$ 其中 $\\alpha_x(V)$ 和 $\\beta_x(V)$ 是以 $\\mathrm{ms}^{-1}$ 为单位的依赖于电压的正向和反向速率函数。在恒定电压 $V$ 的稳态下，门控变量平衡至：$$x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}.$$ 对于标准乌贼巨轴突，在基线温度下且无温度标度的情况下，经验确定的 HH 速率函数为：\n$$\\alpha_m(V) = 0.1\\,\\frac{V + 40}{1 - \\exp\\!\\left(-\\frac{V + 40}{10}\\right)},\\quad \\beta_m(V) = 4\\,\\exp\\!\\left(-\\frac{V + 65}{18}\\right),$$\n$$\\alpha_h(V) = 0.07\\,\\exp\\!\\left(-\\frac{V + 65}{20}\\right),\\quad \\beta_h(V) = \\frac{1}{\\exp\\!\\left(-\\frac{V + 35}{10}\\right) + 1},$$\n$$\\alpha_n(V) = 0.01\\,\\frac{V + 55}{1 - \\exp\\!\\left(-\\frac{V + 55}{10}\\right)},\\quad \\beta_n(V) = 0.125\\,\\exp\\!\\left(-\\frac{V + 65}{80}\\right),$$\n其中 $V$ 以 $\\mathrm{mV}$ 为单位，速率以 $\\mathrm{ms}^{-1}$ 为单位。静息膜电位 $V_{\\mathrm{rest}}$ 满足平衡条件 $\\frac{dV}{dt} = 0$ 和 $I_{\\mathrm{ext}} = 0$，这些条件与稳态门控假设 $x = x_{\\infty}(V)$ 一起，得出了标量非线性方程：$$F(V) \\equiv \\bar{g}_{\\mathrm{Na}}\\, m_{\\infty}(V)^3 h_{\\infty}(V)\\, (V - E_{\\mathrm{Na}}) + \\bar{g}_{\\mathrm{K}}\\, n_{\\infty}(V)^4\\, (V - E_{\\mathrm{K}}) + g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}}) = 0.$$\n\n任务：实现一个鲁棒的数值求根程序，通过求解 $F(V) = 0$ 来计算以 $\\mathrm{mV}$ 为单位的 $V_{\\mathrm{rest}}$。求解时使用上面定义的标准乌贼 $x_{\\infty}(V)$，并报告相应的 $m_{\\infty}(V_{\\mathrm{rest}})$、$h_{\\infty}(V_{\\mathrm{rest}})$ 和 $n_{\\infty}(V_{\\mathrm{rest}})$ 值。为确保在评估 $\\alpha_m(V)$ 和 $\\alpha_n(V)$ 时，当分母 $1 - \\exp(-y)$ 接近零的点附近的数值稳定性，应使用通过洛必达法则导出的适当极限值。\n\n您必须将此方法应用于以下电导和反转电位参数集的测试套件（所有电导单位为 $\\mathrm{mS/cm}^2$，电位单位为 $\\mathrm{mV}$），并假设所有情况下 $I_{\\mathrm{ext}} = 0$：\n\n- 案例1（理想路径，标准）：$\\bar{g}_{\\mathrm{Na}} = 120$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 0.3$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$。\n- 案例2（钠电导降低）：$\\bar{g}_{\\mathrm{Na}} = 100$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 0.3$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$。\n- 案例3（泄漏电导增加）：$\\bar{g}_{\\mathrm{Na}} = 120$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 1.0$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$。\n- 案例4（接近钠阻断边缘）：$\\bar{g}_{\\mathrm{Na}} = 1.0$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 0.3$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$。\n- 案例5（泄漏主导）：$\\bar{g}_{\\mathrm{Na}} = 120$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 10.0$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$。\n\n输出规格：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个案例贡献一个包含四个浮点数的内部列表，顺序为 $[V_{\\mathrm{rest}}, m_{\\infty}, h_{\\infty}, n_{\\infty}]$。$V_{\\mathrm{rest}}$ 以 $\\mathrm{mV}$ 表示，所有四个数字都四舍五入到六位小数。例如，总体输出格式必须完全如下：\n$$\\left[\\,[v_1, m_1, h_1, n_1], [v_2, m_2, h_2, n_2], \\dots \\,\\right],$$\n其中每个 $v_i$ 以 $\\mathrm{mV}$ 为单位，每个门控值为无量纲。不应打印任何额外文本。",
            "solution": "该问题要求计算由 Hodgkin-Huxley (HH) 模型描述的可兴奋膜片的静息膜电位 $V_{\\mathrm{rest}}$。静息电位是一个平衡态，此时跨膜的净电流为零。\n\n膜电位 $V$ 的控制方程由电荷守恒给出：\n$$C \\frac{dV}{dt} = -I_{\\mathrm{ion}}(V) - I_{\\mathrm{ext}}$$\n其中 $C$ 是膜电容，$I_{\\mathrm{ext}}$ 是外部施加的电流，$I_{\\mathrm{ion}}(V)$ 是总离子电流，即钠离子电流 ($I_{\\mathrm{Na}}$)、钾离子电流 ($I_{\\mathrm{K}}$) 和泄漏电流 ($I_{\\mathrm{L}}$) 的总和：\n$$I_{\\mathrm{ion}}(V) = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}$$\n各离子电流的模型如下：\n$$I_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3 h\\, (V - E_{\\mathrm{Na}})$$\n$$I_{\\mathrm{K}} = \\bar{g}_{\\mathrm{K}}\\, n^4\\, (V - E_{\\mathrm{K}})$$\n$$I_{\\mathrm{L}} = g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}})$$\n这里，$\\bar{g}_{\\mathrm{Na}}, \\bar{g}_{\\mathrm{K}}, g_{\\mathrm{L}}$ 是电导密度，$E_{\\mathrm{Na}}, E_{\\mathrm{K}}, E_{\\mathrm{L}}$ 是反转电位，$m, h, n$ 是无量纲的门控变量。\n\n静息电位 $V_{\\mathrm{rest}}$ 定义在平衡条件下，此时 $\\frac{dV}{dt} = 0$ 且 $I_{\\mathrm{ext}} = 0$。这意味着总离子电流必须为零：\n$$I_{\\mathrm{ion}}(V_{\\mathrm{rest}}) = 0$$\n此外，在恒定电压下，门控变量 $x \\in \\{m, h, n\\}$ 会松弛到其稳态值 $x_{\\infty}(V)$。每个门控变量的动力学由以下方程给出：\n$$\\frac{dx}{dt} = \\alpha_x(V)(1 - x) - \\beta_x(V)x$$\n令 $\\frac{dx}{dt} = 0$ 可得稳态值：\n$$x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}$$\n乌贼巨轴突的电压依赖性速率函数 $\\alpha_x(V)$ 和 $\\beta_x(V)$ 如下：\n$$\\alpha_m(V) = 0.1\\,\\frac{V + 40}{1 - \\exp\\!\\left(-\\frac{V + 40}{10}\\right)}$$\n$$\\beta_m(V) = 4\\,\\exp\\!\\left(-\\frac{V + 65}{18}\\right)$$\n$$\\alpha_h(V) = 0.07\\,\\exp\\!\\left(-\\frac{V + 65}{20}\\right)$$\n$$\\beta_h(V) = \\frac{1}{\\exp\\!\\left(-\\frac{V + 35}{10}\\right) + 1}$$\n$$\\alpha_n(V) = 0.01\\,\\frac{V + 55}{1 - \\exp\\!\\left(-\\frac{V + 55}{10}\\right)}$$\n$$\\beta_n(V) = 0.125\\,\\exp\\!\\left(-\\frac{V + 65}{80}\\right)$$\n任务是求解非线性标量方程 $F(V) = 0$ 的根 $V_{\\mathrm{rest}}$，其中：\n$$F(V) \\equiv \\bar{g}_{\\mathrm{Na}}\\, m_{\\infty}(V)^3 h_{\\infty}(V)\\, (V - E_{\\mathrm{Na}}) + \\bar{g}_{\\mathrm{K}}\\, n_{\\infty}(V)^4\\, (V - E_{\\mathrm{K}}) + g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}}) = 0$$\n\n实现的一个关键方面是处理 $\\alpha_m(V)$ 和 $\\alpha_n(V)$ 表达式中的可去奇点。当分母趋近于零时，会出现 $\\frac{0}{0}$ 型的不定式。我们使用洛必达法则来求这些点上的极限。\n\n对于 $\\alpha_m(V)$，当 $V \\to -40 \\text{ mV}$ 时：\n设 $u = V + 40$。表达式为 $0.1 \\frac{u}{1 - \\exp(-u/10)}$。对 $u$ 应用洛必达法则：\n$$ \\lim_{u \\to 0} 0.1 \\frac{\\frac{d}{du}(u)}{\\frac{d}{du}(1 - \\exp(-u/10))} = \\lim_{u \\to 0} 0.1 \\frac{1}{\\frac{1}{10}\\exp(-u/10)} = 0.1 \\times 10 = 1.0 $$\n因此，$\\alpha_m(-40) = 1.0 \\text{ ms}^{-1}$。\n\n对于 $\\alpha_n(V)$，当 $V \\to -55 \\text{ mV}$ 时：\n设 $w = V + 55$。表达式为 $0.01 \\frac{w}{1 - \\exp(-w/10)}$。对 $w$ 应用洛必达法则：\n$$ \\lim_{w \\to 0} 0.01 \\frac{\\frac{d}{dw}(w)}{\\frac{d}{dw}(1 - \\exp(-w/10))} = \\lim_{w \\to 0} 0.01 \\frac{1}{\\frac{1}{10}\\exp(-w/10)} = 0.01 \\times 10 = 0.1 $$\n因此，$\\alpha_n(-55) = 0.1 \\text{ ms}^{-1}$。\n在数值实现中，当电压接近奇异点时，使用这些极限值来确保稳定性和正确性。\n\n解是通过数值求根算法找到的。函数 $F(V)$ 是连续的。对于这类问题，诸如 Brent 方法之类的区间法是鲁棒的。我们需要提供一个区间 $[a, b]$，使得 $F(a)$ 和 $F(b)$ 符号相反。膜电位的生理范围提示了一个区间。对于给定的参数，静息电位通常比 $-50 \\text{ mV}$ 更负，但比钾反转电位 ($E_K = -77 \\text{ mV}$) 更正。对函数 $F(V)$ 的分析表明，当 $V$ 为大的负值时（例如 $V = -100 \\text{ mV}$），$F(V)$ 为负；当 $V$ 接近 $0 \\text{ mV}$ 时，$F(V)$ 为正。因此，区间 $[-100, 0]$ 是根 $V_{\\mathrm{rest}}$ 的一个合适的区间。\n\n总体步骤如下：\n1.  对于每组参数 $(\\bar{g}_{\\mathrm{Na}}, \\bar{g}_{\\mathrm{K}}, g_{\\mathrm{L}}, E_{\\mathrm{Na}}, E_{\\mathrm{K}}, E_{\\mathrm{L}})$：\n2.  定义函数 $f(V) = F(V; \\text{params})$，其中包含稳态门控变量函数 $m_{\\infty}(V), h_{\\infty}(V), n_{\\infty}(V)$，这些函数又使用了包括奇点特殊情况处理的速率函数。\n3.  使用 Brent 方法（实现为 `scipy.optimize.brentq`）在区间 $[-100, 0] \\text{ mV}$ 内找到 $f(V) = 0$ 的根 $V_{\\mathrm{rest}}$。\n4.  计算相应的稳态门控值 $m_{\\infty}(V_{\\mathrm{rest}}), h_{\\infty}(V_{\\mathrm{rest}}), n_{\\infty}(V_{\\mathrm{rest}})$。\n5.  存储元组 $(V_{\\mathrm{rest}}, m_{\\infty}, h_{\\infty}, n_{\\infty})$。\n6.  处理完所有测试案例后，将结果格式化为列表的列表，每个数字四舍五入到六位小数，并打印最终字符串。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef alpha_m(V):\n    \"\"\"\n    Rate function alpha_m for the Hodgkin-Huxley model.\n    Includes handling for the singularity at V = -40 mV.\n    \"\"\"\n    if np.abs(V + 40.0)  1e-6:\n        # L'Hôpital's rule limit\n        return 1.0\n    return 0.1 * (V + 40.0) / (1.0 - np.exp(-(V + 40.0) / 10.0))\n\ndef beta_m(V):\n    \"\"\"Rate function beta_m for the Hodgkin-Huxley model.\"\"\"\n    return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\ndef alpha_h(V):\n    \"\"\"Rate function alpha_h for the Hodgkin-Huxley model.\"\"\"\n    return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\ndef beta_h(V):\n    \"\"\"Rate function beta_h for the Hodgkin-Huxley model.\"\"\"\n    return 1.0 / (np.exp(-(V + 35.0) / 10.0) + 1.0)\n\ndef alpha_n(V):\n    \"\"\"\n    Rate function alpha_n for the Hodgkin-Huxley model.\n    Includes handling for the singularity at V = -55 mV.\n    \"\"\"\n    if np.abs(V + 55.0)  1e-6:\n        # L'Hôpital's rule limit\n        return 0.1\n    return 0.01 * (V + 55.0) / (1.0 - np.exp(-(V + 55.0) / 10.0))\n\ndef beta_n(V):\n    \"\"\"Rate function beta_n for the Hodgkin-Huxley model.\"\"\"\n    return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\ndef m_inf(V):\n    \"\"\"Steady-state activation for sodium channel.\"\"\"\n    return alpha_m(V) / (alpha_m(V) + beta_m(V))\n\ndef h_inf(V):\n    \"\"\"Steady-state inactivation for sodium channel.\"\"\"\n    return alpha_h(V) / (alpha_h(V) + beta_h(V))\n\ndef n_inf(V):\n    \"\"\"Steady-state activation for potassium channel.\"\"\"\n    return alpha_n(V) / (alpha_n(V) + beta_n(V))\n\ndef total_ionic_current(V, g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L):\n    \"\"\"\n    Calculates the total steady-state ionic current F(V) for a given voltage V\n    and model parameters.\n    \"\"\"\n    m = m_inf(V)\n    h = h_inf(V)\n    n = n_inf(V)\n\n    I_Na = g_Na_bar * (m**3) * h * (V - E_Na)\n    I_K = g_K_bar * (n**4) * (V - E_K)\n    I_L = g_L * (V - E_L)\n    \n    return I_Na + I_K + I_L\n\ndef solve():\n    \"\"\"\n    Main function to solve for resting potential and gating variables for each test case.\n    \"\"\"\n    test_cases = [\n        # (g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L)\n        (120.0, 36.0, 0.3, 50.0, -77.0, -54.4),   # Case 1 (canonical)\n        (100.0, 36.0, 0.3, 50.0, -77.0, -54.4),   # Case 2 (reduced sodium)\n        (120.0, 36.0, 1.0, 50.0, -77.0, -54.4),   # Case 3 (increased leak)\n        (1.0, 36.0, 0.3, 50.0, -77.0, -54.4),     # Case 4 (near sodium-block)\n        (120.0, 36.0, 10.0, 50.0, -77.0, -54.4),  # Case 5 (dominant leak)\n    ]\n\n    results = []\n    for params in test_cases:\n        g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L = params\n        \n        # Create a lambda function of V only for the root finder\n        f_to_solve = lambda V: total_ionic_current(V, g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L)\n        \n        # Find the root V_rest using Brent's method.\n        # A search interval of [-100, 0] mV is robust for these parameters.\n        v_rest = brentq(f_to_solve, -100.0, 0.0)\n        \n        # Calculate steady-state gating variables at steady-state voltage\n        m = m_inf(v_rest)\n        h = h_inf(v_rest)\n        n = n_inf(v_rest)\n        \n        results.append((v_rest, m, h, n))\n\n    # Format the output as a single string according to the problem specification\n    formatted_cases = [f\"[{v:.6f},{m:.6f},{h:.6f},{n:.6f}]\" for v, m, h, n in results]\n    final_output = f\"[{','.join(formatted_cases)}]\"\n    \n    # This print statement is for verification; the actual answer is the returned string.\n    # print(final_output)\n\n# The function call is commented out to prevent execution in non-interactive environments.\n# solve()\n```",
            "answer": "```\n[[-65.000003,0.052933,0.596121,0.317677],[-65.008915,0.052899,0.596014,0.317581],[-63.601550,0.057317,0.561439,0.334002],[-76.435759,0.027003,0.852955,0.203020],[-57.436979,0.076239,0.457816,0.399581]]\n```"
        }
    ]
}