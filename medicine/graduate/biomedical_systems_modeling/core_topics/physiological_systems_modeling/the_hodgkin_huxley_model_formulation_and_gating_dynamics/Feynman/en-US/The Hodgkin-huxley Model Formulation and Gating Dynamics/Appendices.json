{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complex world of voltage-gated ion channels, it is crucial to understand the passive electrical properties of the neuronal membrane. This first practice simplifies the system to its core component—the membrane capacitance—by considering a hypothetical scenario where all ionic currents are pharmacologically blocked . By calculating the voltage response to a constant current injection, you will explore the fundamental principle that $I_C = C_m dV/dt$ and see how a pure capacitor integrates current, providing a foundational building block for the full Hodgkin-Huxley model.",
            "id": "3937578",
            "problem": "Consider a spatially isopotential neuronal membrane patch modeled under the Hodgkin–Huxley framework, where voltage-gated ionic channels are pharmacologically blocked so that no ionic currents flow. Assume the membrane is well-described by a parallel-plate capacitance per unit area with area-specific capacitance $C_m$ and that the only transmembrane current is a square, constant applied current density $I_{\\mathrm{app}}$ delivered by a current-clamp electrode. Take the standard biophysical sign convention in which a positive applied current density enters the cell (depolarizing), and let the membrane voltage be $V(t)$ with initial condition $V(0)$.\n\nFundamental bases to use:\n- Conservation of charge embodied by Kirchhoff’s Current Law (KCL), which at the membrane per unit area states that the sum of currents equals zero.\n- The constitutive relation for a capacitor $q = C V$ and its differential form $i_C = C \\, dV/dt$.\n\nGiven $C_m = 1\\,\\mu\\mathrm{F/cm}^2$, $I_{\\mathrm{app}} = 5\\,\\mu\\mathrm{A/cm}^2$, and $V(0) = -65\\,\\mathrm{mV}$, and assuming $I_{\\mathrm{ion}}(t) = 0$ for all $t$ (because all ionic conductances are effectively zero due to complete channel block, independent of the gating variables), derive the membrane voltage $V(t)$ over $t \\in [0, 2\\,\\mathrm{ms}]$.\n\nExpress your final formula for $V(t)$ in millivolts as a function of $t$ in milliseconds. No rounding is required. The final answer must be a single closed-form analytic expression.",
            "solution": "The user-provided problem is evaluated as valid. It is scientifically grounded in the principles of membrane biophysics, is well-posed as a first-order initial value problem, and is stated objectively with all necessary information provided.\n\nThe derivation of the membrane voltage, $V(t)$, proceeds from the fundamental principle of conservation of charge, as expressed by Kirchhoff's Current Law (KCL) for a membrane patch. The total current density flowing across the membrane is the sum of the capacitive current density, $I_C(t)$, and the ionic current density, $I_{\\mathrm{ion}}(t)$. This total membrane current density must be equal to the externally applied current density, $I_{\\mathrm{app}}$. The governing equation per unit area is:\n$$I_{\\mathrm{app}} = I_C(t) + I_{\\mathrm{ion}}(t)$$\n\nThe problem states that all voltage-gated ionic channels are pharmacologically blocked, which implies that the ionic conductances are zero. Consequently, the total ionic current density is zero for all time $t$:\n$$I_{\\mathrm{ion}}(t) = 0$$\n\nUnder this condition, the KCL equation simplifies to:\n$$I_{\\mathrm{app}} = I_C(t)$$\n\nThe problem also specifies that the membrane behaves as a capacitor, with the constitutive relation for the capacitive current density given by:\n$$I_C(t) = C_m \\frac{dV(t)}{dt}$$\nwhere $C_m$ is the area-specific membrane capacitance and $V(t)$ is the membrane voltage.\n\nSubstituting the capacitive current relation into the simplified KCL equation yields the first-order ordinary differential equation (ODE) that governs the membrane voltage dynamics under these specific conditions:\n$$I_{\\mathrm{app}} = C_m \\frac{dV(t)}{dt}$$\n\nThe applied current density, $I_{\\mathrm{app}}$, is given as a constant value. We can rearrange the ODE to solve for $V(t)$:\n$$\\frac{dV}{dt} = \\frac{I_{\\mathrm{app}}}{C_m}$$\n\nThis is a separable differential equation. We integrate both sides with respect to time from the initial time $t=0$ to an arbitrary time $t$. The voltage is integrated from its initial value $V(0)$ to its value at time $t$, $V(t)$:\n$$\\int_{V(0)}^{V(t)} dV' = \\int_{0}^{t} \\frac{I_{\\mathrm{app}}}{C_m} dt'$$\n\nSince $I_{\\mathrm{app}}$ and $C_m$ are constants, the integration yields:\n$$V(t) - V(0) = \\frac{I_{\\mathrm{app}}}{C_m} t$$\n\nSolving for $V(t)$, we obtain the general solution for the membrane voltage:\n$$V(t) = V(0) + \\left(\\frac{I_{\\mathrm{app}}}{C_m}\\right) t$$\n\nThe problem requires the final formula for $V(t)$ to be expressed in millivolts ($\\mathrm{mV}$) as a function of time $t$ in milliseconds ($\\mathrm{ms}$). To accomplish this, we substitute the given values and perform a unit analysis.\nThe given parameters are:\n- $C_m = 1\\,\\mu\\mathrm{F/cm}^2 = 1 \\times 10^{-6}\\,\\mathrm{F/cm}^2$\n- $I_{\\mathrm{app}} = 5\\,\\mu\\mathrm{A/cm}^2 = 5 \\times 10^{-6}\\,\\mathrm{A/cm}^2$\n- $V(0) = -65\\,\\mathrm{mV}$\n\nFirst, we calculate the ratio $\\frac{I_{\\mathrm{app}}}{C_m}$:\n$$\\frac{I_{\\mathrm{app}}}{C_m} = \\frac{5 \\times 10^{-6}\\,\\mathrm{A/cm}^2}{1 \\times 10^{-6}\\,\\mathrm{F/cm}^2} = 5\\,\\frac{\\mathrm{A}}{\\mathrm{F}}$$\nRecalling the definitions of the Ampere ($A = C/s$) and Farad ($F = C/V$), the unit of this ratio becomes:\n$$5\\,\\frac{\\mathrm{A}}{\\mathrm{F}} = 5\\,\\frac{\\mathrm{C/s}}{\\mathrm{C/V}} = 5\\,\\mathrm{V/s}$$\nSo the rate of change of voltage is $5$ Volts per second. The equation for $V(t)$ in Volts and $t$ in seconds is:\n$$V(t)|_{\\text{in V}} = (-65 \\times 10^{-3}\\,\\mathrm{V}) + (5\\,\\mathrm{V/s}) \\cdot t|_{\\text{in s}}$$\n\nTo convert this to the desired units of millivolts and milliseconds, we can convert the rate of change:\n$$5\\,\\frac{\\mathrm{V}}{\\mathrm{s}} = 5\\,\\frac{10^3\\,\\mathrm{mV}}{10^3\\,\\mathrm{ms}} = 5\\,\\frac{\\mathrm{mV}}{\\mathrm{ms}}$$\nThus, the rate of voltage change is $5$ millivolts per millisecond. Let $V$ now represent the voltage in $\\mathrm{mV}$ and $t$ represent the time in $\\mathrm{ms}$. The differential equation in these units is:\n$$\\frac{dV}{dt} = 5\\,\\mathrm{mV/ms}$$\nIntegrating this equation with the initial condition $V(0) = -65\\,\\mathrm{mV}$ gives:\n$$V(t) = -65 + 5t$$\nwhere $V(t)$ is in millivolts and $t$ is in milliseconds. This linear relationship shows that the constant applied current charges the membrane capacitor at a constant rate, causing the voltage to increase linearly with time. This formula is valid for the specified interval $t \\in [0, 2\\,\\mathrm{ms}]$ and beyond, as long as the conditions hold.",
            "answer": "$$\\boxed{-65 + 5t}$$"
        },
        {
            "introduction": "Having established the role of membrane capacitance, we now introduce the active components that generate the neuron's electrical signals: the voltage-gated ionic currents. This exercise focuses on the core mathematical formulation of the sodium and potassium currents as described by Hodgkin and Huxley, where current is the product of conductance and driving force, $I_{ion} = g_{ion}(V - E_{ion})$ . By calculating these currents using the model's probabilistic gating structure (e.g., $g_{Na} = \\bar{g}_{Na} m^3 h$), you will gain hands-on practice applying the central equations of the model and understanding how gating determines the instantaneous flow of ions.",
            "id": "3937565",
            "problem": "In the canonical Hodgkin–Huxley (HH) formulation of excitable membranes, each ionic channel type conducts only when all of its gating particles are in their permissive (open) state, and the gating particles are assumed to act independently. For sodium channels, assume there are three identical activation gates and one inactivation gate; for potassium channels, assume there are four identical activation gates. The membrane current density for an ionic species is proportional to the maximal conductance density, the open probability of the channel, and the electrochemical driving force, consistent with ohmic conduction. Consider a patch of membrane held at membrane potential $V=0\\,\\mathrm{mV}$ with the following parameter values: sodium maximal conductance density $\\bar{g}_{Na}=120\\,\\mathrm{mS/cm}^{2}$, sodium activation gating variable $m=0.5$, sodium inactivation gating variable $h=0.6$, and sodium reversal potential $E_{Na}=50\\,\\mathrm{mV}$; potassium maximal conductance density $\\bar{g}_{K}=36\\,\\mathrm{mS/cm}^{2}$, potassium activation gating variable $n=0.4$, and potassium reversal potential $E_{K}=-77\\,\\mathrm{mV}$. Using the independence of gates and the HH mechanistic interpretation described above, derive the sodium and potassium current densities at this membrane potential. Then, report as your final answer the ratio of their magnitudes,\n$$R=\\frac{|I_{Na}|}{|I_{K}|}.$$\nRound your answer to four significant figures. When computing intermediate ionic currents, express them in $\\mathrm{mA/cm}^{2}$.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Model: Canonical Hodgkin–Huxley (HH) formulation.\n- Channel operation: All gating particles must be in the permissive (open) state for conduction.\n- Gate independence: Gating particles act independently.\n- Sodium channel: $3$ identical activation gates ($m$-gates), $1$ inactivation gate ($h$-gate).\n- Potassium channel: $4$ identical activation gates ($n$-gates).\n- Current density law: $I_{ion} \\propto (\\text{maximal conductance density}) \\times (\\text{open probability}) \\times (\\text{electrochemical driving force})$.\n- Membrane potential: $V = 0\\,\\mathrm{mV}$.\n- Sodium maximal conductance density: $\\bar{g}_{Na} = 120\\,\\mathrm{mS/cm}^{2}$.\n- Sodium activation gating variable: $m = 0.5$.\n- Sodium inactivation gating variable: $h = 0.6$.\n- Sodium reversal potential: $E_{Na} = 50\\,\\mathrm{mV}$.\n- Potassium maximal conductance density: $\\bar{g}_{K} = 36\\,\\mathrm{mS/cm}^{2}$.\n- Potassium activation gating variable: $n = 0.4$.\n- Potassium reversal potential: $E_{K} = -77\\,\\mathrm{mV}$.\n- Required output: The ratio of the magnitudes of the sodium and potassium current densities, $R = \\frac{|I_{Na}|}{|I_{K}|}$, rounded to four significant figures.\n- Intermediate units: Current densities in $\\mathrm{mA/cm}^{2}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard application of the Hodgkin-Huxley model, a cornerstone of computational neuroscience. The description of channel gating, the ohmic nature of current flow, and the given parameter values are all consistent with the canonical formulation and typical physiological values. The problem is self-contained, providing all necessary data for the calculation. The definitions are clear and unambiguous. The problem is scientifically sound, well-posed, objective, and formalizable.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe current density $I_{ion}$ for a specific ionic species in the Hodgkin-Huxley model is given by the product of its conductance density $g_{ion}$ and its electrochemical driving force $(V - E_{ion})$:\n$$I_{ion} = g_{ion} (V - E_{ion})$$\nThe conductance density $g_{ion}$ is the maximal conductance density $\\bar{g}_{ion}$ modulated by the probability that a channel is in its open, conducting state, $P_{open}$:\n$$g_{ion} = \\bar{g}_{ion} P_{open}$$\nThe probability $P_{open}$ is determined by the state of the channel's gating particles.\n\nFirst, we will derive the sodium current density, $I_{Na}$.\nThe problem states that a sodium channel has $3$ identical activation gates ($m$-gates) and $1$ inactivation gate ($h$-gate). The probability that a single $m$-gate is open is given by the variable $m$, and the probability that the $h$-gate is open is given by the variable $h$. Since the gates are assumed to act independently, the probability that the entire channel is open, $P_{Na, open}$, is the product of the probabilities of all its gates being in their permissive states:\n$$P_{Na, open} = m \\cdot m \\cdot m \\cdot h = m^{3}h$$\nThe sodium current density $I_{Na}$ is therefore:\n$$I_{Na} = \\bar{g}_{Na} m^{3} h (V - E_{Na})$$\nWe substitute the given values: $\\bar{g}_{Na} = 120\\,\\mathrm{mS/cm}^{2}$, $m = 0.5$, $h = 0.6$, $V = 0\\,\\mathrm{mV}$, and $E_{Na} = 50\\,\\mathrm{mV}$.\n$$I_{Na} = (120\\,\\mathrm{mS/cm}^{2}) \\cdot (0.5)^{3} \\cdot (0.6) \\cdot (0\\,\\mathrm{mV} - 50\\,\\mathrm{mV})$$\n$$I_{Na} = (120\\,\\mathrm{mS/cm}^{2}) \\cdot (0.125) \\cdot (0.6) \\cdot (-50\\,\\mathrm{mV})$$\n$$I_{Na} = (120 \\cdot 0.125 \\cdot 0.6) \\cdot (-50) \\, \\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\nThe conductance term is $(120 \\cdot 0.075) = 9\\,\\mathrm{mS/cm}^{2}$.\n$$I_{Na} = (9\\,\\mathrm{mS/cm}^{2}) \\cdot (-50\\,\\mathrm{mV}) = -450\\,\\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\nThe unit $\\mathrm{mS} \\cdot \\mathrm{mV}$ is equivalent to $\\mu\\mathrm{A}$ ($10^{-3}\\,\\mathrm{S} \\cdot 10^{-3}\\,\\mathrm{V} = 10^{-6}\\,\\mathrm{A} = 1\\,\\mu\\mathrm{A}$).\nThus, $I_{Na} = -450\\,\\mu\\mathrm{A/cm}^{2}$.\nAs requested for intermediate values, we convert this to $\\mathrm{mA/cm}^{2}$:\n$$I_{Na} = -450\\,\\mu\\mathrm{A/cm}^{2} \\times \\frac{1\\,\\mathrm{mA}}{1000\\,\\mu\\mathrm{A}} = -0.45\\,\\mathrm{mA/cm}^{2}$$\n\nNext, we derive the potassium current density, $I_{K}$.\nThe potassium channel has $4$ identical activation gates ($n$-gates). The probability that a single $n$-gate is open is given by the variable $n$. The probability that the entire channel is open, $P_{K, open}$, is:\n$$P_{K, open} = n \\cdot n \\cdot n \\cdot n = n^{4}$$\nThe potassium current density $I_{K}$ is therefore:\n$$I_{K} = \\bar{g}_{K} n^{4} (V - E_{K})$$\nWe substitute the given values: $\\bar{g}_{K} = 36\\,\\mathrm{mS/cm}^{2}$, $n = 0.4$, $V = 0\\,\\mathrm{mV}$, and $E_{K} = -77\\,\\mathrm{mV}$.\n$$I_{K} = (36\\,\\mathrm{mS/cm}^{2}) \\cdot (0.4)^{4} \\cdot (0\\,\\mathrm{mV} - (-77\\,\\mathrm{mV}))$$\n$$I_{K} = (36\\,\\mathrm{mS/cm}^{2}) \\cdot (0.0256) \\cdot (77\\,\\mathrm{mV})$$\n$$I_{K} = (36 \\cdot 0.0256) \\cdot (77) \\, \\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\nThe conductance term is $(36 \\cdot 0.0256) = 0.9216\\,\\mathrm{mS/cm}^{2}$.\n$$I_{K} = (0.9216\\,\\mathrm{mS/cm}^{2}) \\cdot (77\\,\\mathrm{mV}) = 70.9632\\,\\frac{\\mathrm{mS} \\cdot \\mathrm{mV}}{\\mathrm{cm}^{2}}$$\nThis corresponds to $I_{K} = 70.9632\\,\\mu\\mathrm{A/cm}^{2}$.\nIn $\\mathrm{mA/cm}^{2}$, this is:\n$$I_{K} = 70.9632\\,\\mu\\mathrm{A/cm}^{2} \\times \\frac{1\\,\\mathrm{mA}}{1000\\,\\mu\\mathrm{A}} = 0.0709632\\,\\mathrm{mA/cm}^{2}$$\n\nFinally, we compute the ratio $R$ of the magnitudes of these current densities.\n$$R = \\frac{|I_{Na}|}{|I_{K}|}$$\nUsing the currents in $\\mu\\mathrm{A/cm}^{2}$ to avoid intermediate rounding:\n$$|I_{Na}| = |-450\\,\\mu\\mathrm{A/cm}^{2}| = 450\\,\\mu\\mathrm{A/cm}^{2}$$\n$$|I_{K}| = |70.9632\\,\\mu\\mathrm{A/cm}^{2}| = 70.9632\\,\\mu\\mathrm{A/cm}^{2}$$\n$$R = \\frac{450}{70.9632} \\approx 6.34125036$$\nThe problem requires the answer to be rounded to four significant figures.\n$$R \\approx 6.341$$",
            "answer": "$$\n\\boxed{6.341}\n$$"
        },
        {
            "introduction": "This capstone exercise integrates the passive and active components to find a key physiological property of the neuron: its resting potential, $V_{rest}$. The resting potential is the equilibrium voltage where the net ionic current across the membrane is zero, a state that requires solving a complex, nonlinear equation because the conductances themselves are voltage-dependent . This practice transitions from analytical calculation to computational modeling, demonstrating how the dynamic interplay of multiple conductances establishes the stable equilibrium from which all electrical activity, including action potentials, originates.",
            "id": "3937544",
            "problem": "A central objective in biomedical systems modeling is to determine equilibrium states of excitable membranes governed by the Hodgkin–Huxley (HH) model, which describes ionic currents through voltage-gated channels and the passive leak pathway. Starting from the conservation of charge on a membrane patch and Kirchhoff’s current law, the membrane obeys $$C \\frac{dV}{dt} = I_{\\mathrm{ext}} - (I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}),$$ where $C$ is membrane capacitance per unit area, $V$ is the membrane potential in $\\mathrm{mV}$, $I_{\\mathrm{Na}}, I_{\\mathrm{K}}, I_{\\mathrm{L}}$ are the sodium, potassium, and leak current densities in $\\mathrm{mA/cm}^2$, and $I_{\\mathrm{ext}}$ is any externally applied current density in $\\mathrm{mA/cm}^2$. The Hodgkin–Huxley (HH) model expresses the ionic currents as $$I_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3 h\\, (V - E_{\\mathrm{Na}}),\\quad I_{\\mathrm{K}} = \\bar{g}_{\\mathrm{K}}\\, n^4\\, (V - E_{\\mathrm{K}}),\\quad I_{\\mathrm{L}} = g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}}),$$ where $\\bar{g}_{\\mathrm{Na}}, \\bar{g}_{\\mathrm{K}}$ and $g_{\\mathrm{L}}$ are the maximal and leak conductance densities in $\\mathrm{mS/cm}^2$, $E_{\\mathrm{Na}}, E_{\\mathrm{K}}, E_{\\mathrm{L}}$ are the corresponding reversal potentials in $\\mathrm{mV}$, and $m, h, n$ are dimensionless gating variables that reflect the fraction of channel subunits in the permissive state. The gating variables obey first-order kinetics of the form $$\\frac{dx}{dt} = \\alpha_x(V)\\left(1 - x\\right) - \\beta_x(V)\\, x,\\quad x \\in \\{m,h,n\\},$$ with voltage-dependent forward and backward rate functions $\\alpha_x(V)$ and $\\beta_x(V)$ in $\\mathrm{ms}^{-1}$. At steady state under constant $V$, the gating variables equilibrate to $$x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}.$$ For the standard squid giant axon at baseline temperature without temperature scaling, the empirically established HH rate functions are\n$$\\alpha_m(V) = 0.1\\,\\frac{V + 40}{1 - \\exp\\!\\left(-\\frac{V + 40}{10}\\right)},\\quad \\beta_m(V) = 4\\,\\exp\\!\\left(-\\frac{V + 65}{18}\\right),$$\n$$\\alpha_h(V) = 0.07\\,\\exp\\!\\left(-\\frac{V + 65}{20}\\right),\\quad \\beta_h(V) = \\frac{1}{\\exp\\!\\left(-\\frac{V + 35}{10}\\right) + 1},$$\n$$\\alpha_n(V) = 0.01\\,\\frac{V + 55}{1 - \\exp\\!\\left(-\\frac{V + 55}{10}\\right)},\\quad \\beta_n(V) = 0.125\\,\\exp\\!\\left(-\\frac{V + 65}{80}\\right),$$\nwith $V$ in $\\mathrm{mV}$ and rates in $\\mathrm{ms}^{-1}$. The resting membrane potential $V_{\\mathrm{rest}}$ satisfies the equilibrium conditions $\\frac{dV}{dt} = 0$ and $I_{\\mathrm{ext}} = 0$, which, together with the steady-state gating assumption $x = x_{\\infty}(V)$, yield the scalar nonlinear equation $$F(V) \\equiv \\bar{g}_{\\mathrm{Na}}\\, m_{\\infty}(V)^3 h_{\\infty}(V)\\, (V - E_{\\mathrm{Na}}) + \\bar{g}_{\\mathrm{K}}\\, n_{\\infty}(V)^4\\, (V - E_{\\mathrm{K}}) + g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}}) = 0.$$\n\nTask: Implement a robust numerical root-finding procedure to compute $V_{\\mathrm{rest}}$ in $\\mathrm{mV}$ by solving $F(V) = 0$ using the standard squid $x_{\\infty}(V)$ functions defined above, and report the corresponding $m_{\\infty}(V_{\\mathrm{rest}})$, $h_{\\infty}(V_{\\mathrm{rest}})$, and $n_{\\infty}(V_{\\mathrm{rest}})$ values. To ensure numerical stability when evaluating $\\alpha_m(V)$ and $\\alpha_n(V)$ near points where the denominator $1 - \\exp(-y)$ is close to zero, use the appropriate limiting value derived via L'Hôpital’s rule.\n\nYou must apply the method to the following test suite of conductance and reversal potential parameter sets (all conductances in $\\mathrm{mS/cm}^2$ and potentials in $\\mathrm{mV}$), assuming $I_{\\mathrm{ext}} = 0$ for all cases:\n\n- Case 1 (happy path, canonical): $\\bar{g}_{\\mathrm{Na}} = 120$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 0.3$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$.\n- Case 2 (reduced sodium conductance): $\\bar{g}_{\\mathrm{Na}} = 100$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 0.3$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$.\n- Case 3 (increased leak conductance): $\\bar{g}_{\\mathrm{Na}} = 120$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 1.0$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$.\n- Case 4 (near sodium-block edge): $\\bar{g}_{\\mathrm{Na}} = 1.0$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 0.3$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$.\n- Case 5 (dominant leak): $\\bar{g}_{\\mathrm{Na}} = 120$, $\\bar{g}_{\\mathrm{K}} = 36$, $g_{\\mathrm{L}} = 10.0$, $E_{\\mathrm{Na}} = 50$, $E_{\\mathrm{K}} = -77$, $E_{\\mathrm{L}} = -54.4$.\n\nOutput specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each case contributes one inner list of four floats in the order $[V_{\\mathrm{rest}}, m_{\\infty}, h_{\\infty}, n_{\\infty}]$. Express $V_{\\mathrm{rest}}$ in $\\mathrm{mV}$ and round all four numbers to six decimal places. For example, the overall output format must be exactly like\n$$\\left[\\,[v_1, m_1, h_1, n_1], [v_2, m_2, h_2, n_2], \\dots \\,\\right],$$\nwhere each $v_i$ is in $\\mathrm{mV}$ and each gating value is dimensionless. No additional text should be printed.",
            "solution": "The problem requires the computation of the resting membrane potential, $V_{\\mathrm{rest}}$, for a patch of excitable membrane described by the Hodgkin-Huxley (HH) model. The resting potential is an equilibrium state where the net current across the membrane is zero.\n\nThe governing equation for the membrane potential $V$ is given by the conservation of charge:\n$$C \\frac{dV}{dt} = I_{\\mathrm{ext}} - I_{\\mathrm{ion}}(V)$$\nwhere $C$ is the membrane capacitance, $I_{\\mathrm{ext}}$ is an externally applied current, and $I_{\\mathrm{ion}}(V)$ is the total ionic current, which is the sum of the sodium ($I_{\\mathrm{Na}}$), potassium ($I_{\\mathrm{K}}$), and leak ($I_{\\mathrm{L}}$) currents:\n$$I_{\\mathrm{ion}}(V) = I_{\\mathrm{Na}} + I_{\\mathrm{K}} + I_{\\mathrm{L}}$$\nThe individual ionic currents are modeled as:\n$$I_{\\mathrm{Na}} = \\bar{g}_{\\mathrm{Na}}\\, m^3 h\\, (V - E_{\\mathrm{Na}})$$\n$$I_{\\mathrm{K}} = \\bar{g}_{\\mathrm{K}}\\, n^4\\, (V - E_{\\mathrm{K}})$$\n$$I_{\\mathrm{L}} = g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}})$$\nHere, $\\bar{g}_{\\mathrm{Na}}, \\bar{g}_{\\mathrm{K}}, g_{\\mathrm{L}}$ are conductance densities, $E_{\\mathrm{Na}}, E_{\\mathrm{K}}, E_{\\mathrm{L}}$ are reversal potentials, and $m, h, n$ are dimensionless gating variables.\n\nThe resting potential $V_{\\mathrm{rest}}$ is defined under equilibrium conditions, where $\\frac{dV}{dt} = 0$ and $I_{\\mathrm{ext}} = 0$. This implies that the total ionic current must be zero:\n$$I_{\\mathrm{ion}}(V_{\\mathrm{rest}}) = 0$$\nFurthermore, at a constant voltage, the gating variables $x \\in \\{m, h, n\\}$ relax to their steady-state values, $x_{\\infty}(V)$. The dynamics of each gating variable are given by:\n$$\\frac{dx}{dt} = \\alpha_x(V)(1 - x) - \\beta_x(V)x$$\nSetting $\\frac{dx}{dt} = 0$ yields the steady-state value:\n$$x_{\\infty}(V) = \\frac{\\alpha_x(V)}{\\alpha_x(V) + \\beta_x(V)}$$\nThe voltage-dependent rate functions, $\\alpha_x(V)$ and $\\beta_x(V)$, for the squid giant axon are provided as:\n$$\\alpha_m(V) = 0.1\\,\\frac{V + 40}{1 - \\exp\\!\\left(-\\frac{V + 40}{10}\\right)}$$\n$$\\beta_m(V) = 4\\,\\exp\\!\\left(-\\frac{V + 65}{18}\\right)$$\n$$\\alpha_h(V) = 0.07\\,\\exp\\!\\left(-\\frac{V + 65}{20}\\right)$$\n$$\\beta_h(V) = \\frac{1}{\\exp\\!\\left(-\\frac{V + 35}{10}\\right) + 1}$$\n$$\\alpha_n(V) = 0.01\\,\\frac{V + 55}{1 - \\exp\\!\\left(-\\frac{V + 55}{10}\\right)}$$\n$$\\beta_n(V) = 0.125\\,\\exp\\!\\left(-\\frac{V + 65}{80}\\right)$$\nThe task is to find the root $V_{\\mathrm{rest}}$ of the nonlinear scalar equation $F(V) = 0$, where:\n$$F(V) \\equiv \\bar{g}_{\\mathrm{Na}}\\, m_{\\infty}(V)^3 h_{\\infty}(V)\\, (V - E_{\\mathrm{Na}}) + \\bar{g}_{\\mathrm{K}}\\, n_{\\infty}(V)^4\\, (V - E_{\\mathrm{K}}) + g_{\\mathrm{L}}\\, (V - E_{\\mathrm{L}}) = 0$$\n\nA critical aspect of the implementation is handling the removable singularities in the expressions for $\\alpha_m(V)$ and $\\alpha_n(V)$. These occur when the denominator approaches zero, leading to an indeterminate form of type $\\frac{0}{0}$. We use L'Hôpital’s rule to find the limits at these points.\n\nFor $\\alpha_m(V)$ as $V \\to -40 \\text{ mV}$:\nLet $u = V + 40$. The expression is $0.1 \\frac{u}{1 - \\exp(-u/10)}$. Applying L'Hôpital’s rule with respect to $u$:\n$$ \\lim_{u \\to 0} 0.1 \\frac{\\frac{d}{du}(u)}{\\frac{d}{du}(1 - \\exp(-u/10))} = \\lim_{u \\to 0} 0.1 \\frac{1}{\\frac{1}{10}\\exp(-u/10)} = 0.1 \\times 10 = 1.0 $$\nThus, $\\alpha_m(-40) = 1.0 \\text{ ms}^{-1}$.\n\nFor $\\alpha_n(V)$ as $V \\to -55 \\text{ mV}$:\nLet $w = V + 55$. The expression is $0.01 \\frac{w}{1 - \\exp(-w/10)}$. Applying L'Hôpital’s rule with respect to $w$:\n$$ \\lim_{w \\to 0} 0.01 \\frac{\\frac{d}{dw}(w)}{\\frac{d}{dw}(1 - \\exp(-w/10))} = \\lim_{w \\to 0} 0.01 \\frac{1}{\\frac{1}{10}\\exp(-w/10)} = 0.01 \\times 10 = 0.1 $$\nThus, $\\alpha_n(-55) = 0.1 \\text{ ms}^{-1}$.\nIn the numerical implementation, these limiting values are used when the voltage is close to the singular point to ensure stability and correctness.\n\nThe solution is found using a numerical root-finding algorithm. The function $F(V)$ is continuous. A bracketing method, such as Brent's method, is robust for this type of problem. We need to supply an interval $[a, b]$ where $F(a)$ and $F(b)$ have opposite signs. The physiological range of membrane potentials suggests an interval. For the given parameters, the resting potential is typically more negative than $-50 \\text{ mV}$ but more positive than the potassium reversal potential ($E_K = -77 \\text{ mV}$). An analysis of the function $F(V)$ reveals $F(V)$ is negative for large negative $V$ (e.g., $V = -100 \\text{ mV}$) and positive for $V$ near $0 \\text{ mV}$. Thus, the interval $[-100, 0]$ is a suitable bracket for the root $V_{\\mathrm{rest}}$.\n\nThe overall procedure is as follows:\n1.  For each set of parameters $(\\bar{g}_{\\mathrm{Na}}, \\bar{g}_{\\mathrm{K}}, g_{\\mathrm{L}}, E_{\\mathrm{Na}}, E_{\\mathrm{K}}, E_{\\mathrm{L}})$:\n2.  Define the function $f(V) = F(V; \\text{params})$ incorporating the steady-state gating variable functions $m_{\\infty}(V), h_{\\infty}(V), n_{\\infty}(V)$, which in turn use the rate functions including the special cases for singularities.\n3.  Use Brent's method (implemented as `scipy.optimize.brentq`) to find the root $V_{\\mathrm{rest}}$ of $f(V) = 0$ within the interval $[-100, 0] \\text{ mV}$.\n4.  Calculate the corresponding steady-state gating values $m_{\\infty}(V_{\\mathrm{rest}}), h_{\\infty}(V_{\\mathrm{rest}}), n_{\\infty}(V_{\\mathrm{rest}})$.\n5.  Store the tuple $(V_{\\mathrm{rest}}, m_{\\infty}, h_{\\infty}, n_{\\infty})$.\n6.  After processing all test cases, format the results as a list of lists, with each number rounded to six decimal places, and print the final string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef alpha_m(V):\n    \"\"\"\n    Rate function alpha_m for the Hodgkin-Huxley model.\n    Includes handling for the singularity at V = -40 mV.\n    \"\"\"\n    if np.abs(V + 40.0) < 1e-6:\n        # L'Hôpital's rule limit\n        return 1.0\n    return 0.1 * (V + 40.0) / (1.0 - np.exp(-(V + 40.0) / 10.0))\n\ndef beta_m(V):\n    \"\"\"Rate function beta_m for the Hodgkin-Huxley model.\"\"\"\n    return 4.0 * np.exp(-(V + 65.0) / 18.0)\n\ndef alpha_h(V):\n    \"\"\"Rate function alpha_h for the Hodgkin-Huxley model.\"\"\"\n    return 0.07 * np.exp(-(V + 65.0) / 20.0)\n\ndef beta_h(V):\n    \"\"\"Rate function beta_h for the Hodgkin-Huxley model.\"\"\"\n    return 1.0 / (np.exp(-(V + 35.0) / 10.0) + 1.0)\n\ndef alpha_n(V):\n    \"\"\"\n    Rate function alpha_n for the Hodgkin-Huxley model.\n    Includes handling for the singularity at V = -55 mV.\n    \"\"\"\n    if np.abs(V + 55.0) < 1e-6:\n        # L'Hôpital's rule limit\n        return 0.1\n    return 0.01 * (V + 55.0) / (1.0 - np.exp(-(V + 55.0) / 10.0))\n\ndef beta_n(V):\n    \"\"\"Rate function beta_n for the Hodgkin-Huxley model.\"\"\"\n    return 0.125 * np.exp(-(V + 65.0) / 80.0)\n\ndef m_inf(V):\n    \"\"\"Steady-state activation for sodium channel.\"\"\"\n    return alpha_m(V) / (alpha_m(V) + beta_m(V))\n\ndef h_inf(V):\n    \"\"\"Steady-state inactivation for sodium channel.\"\"\"\n    return alpha_h(V) / (alpha_h(V) + beta_h(V))\n\ndef n_inf(V):\n    \"\"\"Steady-state activation for potassium channel.\"\"\"\n    return alpha_n(V) / (alpha_n(V) + beta_n(V))\n\ndef total_ionic_current(V, g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L):\n    \"\"\"\n    Calculates the total steady-state ionic current F(V) for a given voltage V\n    and model parameters.\n    \"\"\"\n    m = m_inf(V)\n    h = h_inf(V)\n    n = n_inf(V)\n\n    I_Na = g_Na_bar * (m**3) * h * (V - E_Na)\n    I_K = g_K_bar * (n**4) * (V - E_K)\n    I_L = g_L * (V - E_L)\n    \n    return I_Na + I_K + I_L\n\ndef solve():\n    \"\"\"\n    Main function to solve for resting potential and gating variables for each test case.\n    \"\"\"\n    test_cases = [\n        # (g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L)\n        (120.0, 36.0, 0.3, 50.0, -77.0, -54.4),   # Case 1 (canonical)\n        (100.0, 36.0, 0.3, 50.0, -77.0, -54.4),   # Case 2 (reduced sodium)\n        (120.0, 36.0, 1.0, 50.0, -77.0, -54.4),   # Case 3 (increased leak)\n        (1.0, 36.0, 0.3, 50.0, -77.0, -54.4),     # Case 4 (near sodium-block)\n        (120.0, 36.0, 10.0, 50.0, -77.0, -54.4),  # Case 5 (dominant leak)\n    ]\n\n    results = []\n    for params in test_cases:\n        g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L = params\n        \n        # Create a lambda function of V only for the root finder\n        f_to_solve = lambda V: total_ionic_current(V, g_Na_bar, g_K_bar, g_L, E_Na, E_K, E_L)\n        \n        # Find the root V_rest using Brent's method.\n        # A search interval of [-100, 0] mV is robust for these parameters.\n        v_rest = brentq(f_to_solve, -100.0, 0.0)\n        \n        # Calculate steady-state gating variables at steady-state voltage\n        m = m_inf(v_rest)\n        h = h_inf(v_rest)\n        n = n_inf(v_rest)\n        \n        results.append((v_rest, m, h, n))\n\n    # Format the output as a single string according to the problem specification\n    formatted_cases = [f\"[{v:.6f},{m:.6f},{h:.6f},{n:.6f}]\" for v, m, h, n in results]\n    final_output = f\"[{','.join(formatted_cases)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}