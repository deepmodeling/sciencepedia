{
    "hands_on_practices": [
        {
            "introduction": "This first practice solidifies the fundamentals of the Goldman-Hodgkin-Katz (GHK) framework. You will derive the classic GHK voltage equation from the Nernst-Planck equation for a typical neuronal environment involving $\\mathrm{K}^+$, $\\mathrm{Na}^+$, and $\\mathrm{Cl}^-$ ions . This exercise also highlights a key, and sometimes overlooked, feature: the direct proportionality of the membrane potential to absolute temperature, connecting the theoretical model to tangible sources of experimental error.",
            "id": "2763570",
            "problem": "A single-compartment neuron at steady state is permeable to three monovalent ions, potassium $\\mathrm{K}^+$, sodium $\\mathrm{Na}^+$, and chloride $\\mathrm{Cl}^-$. Assume the constant-field (spatially uniform electric field) approximation, independent ion movement, and no active transport. The extracellular concentrations are $[\\mathrm{K}^+]_o = 5.0\\,\\text{mM}$, $[\\mathrm{Na}^+]_o = 145.0\\,\\text{mM}$, and $[\\mathrm{Cl}^-]_o = 110.0\\,\\text{mM}$; the intracellular concentrations are $[\\mathrm{K}^+]_i = 140.0\\,\\text{mM}$, $[\\mathrm{Na}^+]_i = 12.0\\,\\text{mM}$, and $[\\mathrm{Cl}^-]_i = 10.0\\,\\text{mM}$. The relative permeabilities are $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1.00 : 0.050 : 0.450$. Let the true physiological temperature be $T_{\\text{true}} = 310\\,\\text{K}$.\n\nStarting from the Nernst–Planck flux for each ion and enforcing zero net current at steady state under the constant-field assumption, derive the membrane potential $V_m$ as a function of $T$, the permeabilities $P_i$, and the intra- and extracellular concentrations. Using this result, derive an analytic expression for the bias\n$$\\Delta V \\equiv V_m(T_{\\text{used}}) - V_m(T_{\\text{true}})$$\nintroduced by erroneously using $T_{\\text{used}} = 295\\,\\text{K}$ in place of $T_{\\text{true}} = 310\\,\\text{K}$, holding all permeabilities and concentrations fixed.\n\nThen evaluate $\\Delta V$ numerically using $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ and $F = 96485.33212\\,\\text{C}\\,\\text{mol}^{-1}$. Express your final numerical answer for $\\Delta V$ in millivolts and round to four significant figures.\n\nFinally, briefly discuss whether a bias of this magnitude could be detected experimentally with modern whole-cell patch-clamp techniques, assuming typical low-noise conditions and appropriate filtering. Your discussion will not be graded for numerical accuracy but should be physically reasoned from first principles and typical instrument performance. The graded quantity is only the numerical value of $\\Delta V$.",
            "solution": "The problem posed is self-contained, scientifically grounded in established principles of biophysics, and well-posed. It is therefore valid, and a solution will be provided.\n\nThe problem requires the derivation of the membrane potential, $V_m$, from first principles, specifically the Nernst-Planck equation, under the constant-field assumption.\n\nThe Nernst-Planck equation describes the flux, $J_s$, of an ion species, $s$, across a membrane as a function of the concentration gradient and the electric field:\n$$ J_s(x) = -D_s \\left( \\frac{dC_s(x)}{dx} + \\frac{z_s F}{RT} C_s(x) \\frac{d\\phi(x)}{dx} \\right) $$\nHere, $D_s$ is the diffusion coefficient of ion $s$ within the membrane, $C_s(x)$ is its concentration at position $x$ across the membrane thickness, $z_s$ is its valence, $F$ is the Faraday constant, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\phi(x)$ is the electric potential.\n\nThe constant-field approximation assumes a uniform electric field, $E$, across the membrane of thickness $L$. Thus, the potential gradient is constant: $\\frac{d\\phi}{dx} = \\frac{\\phi_{in} - \\phi_{out}}{L} = \\frac{V_m}{L}$. The Nernst-Planck equation can then be integrated to yield an expression for the current carried by each ion.\n\nThe electric current density carried by ion $s$ is $I_s = z_s F J_s$. To derive the GHK voltage equation, we must find the voltage $V_m$ where the total current across the membrane is zero: $\\sum_s I_s = 0$.\nThe GHK current equation, derived from integrating the Nernst-Planck equation under the constant field assumption, gives the current for a single ionic species $s$ as:\n$$ I_s = P_s \\frac{(z_s F)^2 V_m}{RT} \\frac{[s]_i e^{z_s F V_m / RT} - [s]_o}{e^{z_s F V_m / RT} - 1} $$\nLet's define the dimensionless potential $u = \\frac{F V_m}{RT}$. The equation for the total current $I_{net} = I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}}$ becomes:\n$$ I_{net} = \\frac{F^2 V_m}{RT} \\sum_s P_s z_s^2 \\frac{[s]_i e^{z_s u} - [s]_o}{e^{z_s u} - 1} = 0 $$\nFor the system to be at a non-zero resting potential ($V_m \\neq 0$), the summation term must be zero. Let's analyze the terms for cations ($z=+1$) and anions ($z=-1$):\n- For cations ($\\mathrm{K}^+$, $\\mathrm{Na}^+$), $z_s = +1$ and $z_s^2 = 1$. The term is $P_s \\frac{[s]_i e^u - [s]_o}{e^u - 1}$.\n- For anions ($\\mathrm{Cl}^-$), $z_s = -1$ and $z_s^2 = 1$. The term is $P_{\\mathrm{Cl}} \\frac{[\\mathrm{Cl}]_i e^{-u} - [\\mathrm{Cl}]_o}{e^{-u} - 1}$.\n\nTo combine these terms, we can rewrite the anion term to have the same denominator, $e^u - 1$:\n$$ P_{\\mathrm{Cl}} \\frac{[\\mathrm{Cl}]_i e^{-u} - [\\mathrm{Cl}]_o}{e^{-u} - 1} = P_{\\mathrm{Cl}} \\frac{e^u([\\mathrm{Cl}]_i e^{-u} - [\\mathrm{Cl}]_o)}{e^u(e^{-u} - 1)} = P_{\\mathrm{Cl}} \\frac{[\\mathrm{Cl}]_i - [\\mathrm{Cl}]_o e^u}{1 - e^u} = P_{\\mathrm{Cl}} \\frac{[\\mathrm{Cl}]_o e^u - [\\mathrm{Cl}]_i}{e^u - 1} $$\nNow we set the sum of the numerators to zero:\n$$ P_{\\mathrm{K}}([ \\mathrm{K}^+ ]_i e^u - [ \\mathrm{K}^+ ]_o) + P_{\\mathrm{Na}}([ \\mathrm{Na}^+ ]_i e^u - [ \\mathrm{Na}^+ ]_o) + P_{\\mathrm{Cl}}([ \\mathrm{Cl}^- ]_o e^u - [ \\mathrm{Cl}^- ]_i) = 0 $$\nWe solve for $e^u$ by grouping terms:\n$$ e^u \\left( P_{\\mathrm{K}}[ \\mathrm{K}^+ ]_i + P_{\\mathrm{Na}}[ \\mathrm{Na}^+ ]_i + P_{\\mathrm{Cl}}[ \\mathrm{Cl}^- ]_o \\right) = P_{\\mathrm{K}}[ \\mathrm{K}^+ ]_o + P_{\\mathrm{Na}}[ \\mathrm{Na}^+ ]_o + P_{\\mathrm{Cl}}[ \\mathrm{Cl}^- ]_i $$\n$$ e^u = \\exp\\left(\\frac{F V_m}{RT}\\right) = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i}{P_{\\mathrm{K}}[\\mathrm{K}^+]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o} $$\nSolving for $V_m$ gives the Goldman-Hodgkin-Katz (GHK) voltage equation:\n$$ V_m(T) = \\frac{RT}{F} \\ln \\left( \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i}{P_{\\mathrm{K}}[\\mathrm{K}^+]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o} \\right) $$\nThis expression for $V_m$ is a function of temperature $T$, permeabilities $P_i$, and concentrations.\n\nNext, we derive the analytic expression for the bias $\\Delta V = V_m(T_{\\text{used}}) - V_m(T_{\\text{true}})$. The logarithmic term is independent of temperature as all concentrations and permeabilities are held fixed. Let this dimensionless ratio be defined as $Y$:\n$$ Y = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i}{P_{\\mathrm{K}}[\\mathrm{K}^+]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o} $$\nThen, $V_m(T) = \\frac{RT}{F} \\ln(Y)$. The bias is:\n$$ \\Delta V = V_m(T_{\\text{used}}) - V_m(T_{\\text{true}}) = \\frac{R T_{\\text{used}}}{F} \\ln(Y) - \\frac{R T_{\\text{true}}}{F} \\ln(Y) $$\n$$ \\Delta V = \\frac{R}{F} (T_{\\text{used}} - T_{\\text{true}}) \\ln(Y) $$\nThis is the required analytic expression for the bias.\n\nNow, we evaluate $\\Delta V$ numerically. The relative permeabilities are given as $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1.00 : 0.050 : 0.450$. We may use these values directly since they appear as a ratio in the expression for $Y$. Let $P_{\\mathrm{K}}=1.00$, $P_{\\mathrm{Na}}=0.050$, and $P_{\\mathrm{Cl}}=0.450$.\nThe given concentrations are:\n$[\\mathrm{K}^+]_o = 5.0\\,\\text{mM}$, $[\\mathrm{Na}^+]_o = 145.0\\,\\text{mM}$, $[\\mathrm{Cl}^-]_o = 110.0\\,\\text{mM}$\n$[\\mathrm{K}^+]_i = 140.0\\,\\text{mM}$, $[\\mathrm{Na}^+]_i = 12.0\\,\\text{mM}$, $[\\mathrm{Cl}^-]_i = 10.0\\,\\text{mM}$\n\nThe numerator of $Y$ is:\n$ (1.00)(5.0) + (0.050)(145.0) + (0.450)(10.0) = 5.0 + 7.25 + 4.5 = 16.75 $\nThe denominator of $Y$ is:\n$ (1.00)(140.0) + (0.050)(12.0) + (0.450)(110.0) = 140.0 + 0.6 + 49.5 = 190.1 $\nSo, $Y = \\frac{16.75}{190.1}$.\n\nThe temperatures are $T_{\\text{used}} = 295\\,\\text{K}$ and $T_{\\text{true}} = 310\\,\\text{K}$, so the temperature difference is $T_{\\text{used}} - T_{\\text{true}} = -15\\,\\text{K}$.\nUsing the given constants $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ and $F = 96485.33212\\,\\text{C}\\,\\text{mol}^{-1}$:\n$$ \\Delta V = \\left( \\frac{8.314462618}{96485.33212} \\right) (-15) \\ln\\left(\\frac{16.75}{190.1}\\right) $$\n$$ \\Delta V \\approx (8.61733 \\times 10^{-5} \\,\\text{V}\\,\\text{K}^{-1}) \\times (-15\\,\\text{K}) \\times (-2.429215) $$\n$$ \\Delta V \\approx 0.003139535\\,\\text{V} $$\nExpressed in millivolts, this is $\\Delta V \\approx 3.139535\\,\\text{mV}$. Rounding to four significant figures gives $3.140\\,\\text{mV}$.\n\nFinally, a brief discussion on experimental observability. A systematic membrane potential bias of $\\Delta V \\approx 3.14\\,\\text{mV}$ is substantial and easily detectable using modern whole-cell patch-clamp electrophysiology. Under typical low-noise recording conditions, the root-mean-square (RMS) noise of the membrane potential measurement is on the order of $100-200\\,\\mu\\text{V}$ (or $0.1-0.2\\,\\text{mV}$) after appropriate filtering. A systematic shift of over $3\\,\\text{mV}$ is more than an order of magnitude larger than this noise floor. Such a change in resting potential is physiologically significant and well within the resolution of standard experimental apparatus. An error of this size resulting from an incorrect temperature value would be a serious confound in any study of cellular electrophysiology.",
            "answer": "$$\\boxed{3.140}$$"
        },
        {
            "introduction": "Many crucial biological channels, such as the NMDA receptor, are permeable to multiple ions with different valences. This practice moves beyond the simplified GHK voltage formula to the more general GHK *current* model, which is essential for these complex cases . You will calculate the reversal potential for a channel permeable to both $\\mathrm{Na}^+$ and $\\mathrm{Ca}^{2+}$, a scenario that requires a numerical approach to find the voltage where the net ionic current is zero.",
            "id": "2763525",
            "problem": "You are asked to compute the reversal potential for a membrane channel permeable to calcium ions and sodium ions using a first-principles electrodiffusion model. Start from the steady-state Nernst–Planck description under the constant-field assumption, and enforce the zero net current condition across the membrane. Consider two ionic species: calcium with valence $z_{\\mathrm{Ca}}=+2$ and sodium with valence $z_{\\mathrm{Na}}=+1$. The absolute temperature is $T=310\\,\\mathrm{K}$, the gas constant is $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and the Faraday constant is $F=96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$. The extracellular and intracellular activities (approximated here by concentrations) are as follows: $[\\mathrm{Ca}]_o=2\\,\\mathrm{mM}$, $[\\mathrm{Ca}]_i=100\\,\\mathrm{nM}$, $[\\mathrm{Na}]_o=140\\,\\mathrm{mM}$, and $[\\mathrm{Na}]_i=12\\,\\mathrm{mM}$. Ensure that all concentrations are used in consistent units; convert nanomolar to millimolar as necessary. Let the permeability ratio be $r=P_{\\mathrm{Ca}}/P_{\\mathrm{Na}}$, where $P_{\\mathrm{Na}}>0$ is arbitrary because only the ratio matters at zero net current. The reversal potential $E_{\\mathrm{rev}}$ is defined as the membrane potential $V_m$ (inside relative to outside) at which the total ionic current equals zero.\n\nYour task is to:\n- Derive, from the steady-state Nernst–Planck equation under the constant-field assumption, the expression for the ionic current of species $i$ with valence $z_i$ and permeability $P_i$ across a membrane at potential $V_m$ as a function of $[\\mathrm{ion}]_i$, $[\\mathrm{ion}]_o$, $z_i$, $P_i$, $R$, $T$, and $F$.\n- Impose the zero net current condition for the two-ion system $\\{\\mathrm{Ca}^{2+},\\mathrm{Na}^+\\}$ and show that $E_{\\mathrm{rev}}$ is uniquely determined for given $r$ and concentrations, without using any pre-memorized shortcut formulas.\n- Implement a numerical root-finding algorithm to solve for $E_{\\mathrm{rev}}$ in volts by finding $V_m$ that makes the total current zero for the given $r$.\n- Express the final answers in millivolts, rounded to three decimal places.\n\nUse the following test suite of permeability ratios to evaluate your program:\n- $r=0$\n- $r=0.01$\n- $r=0.1$\n- $r=1$\n- $r=10$\n- $r=1000$\n\nAll other parameters are fixed as specified above. Your program should output the six reversal potentials corresponding to these six test cases in a single line as a comma-separated list of floating-point numbers (in $\\mathrm{mV}$, rounded to three decimal places) enclosed in square brackets, for example: $[\\dots]$.\n\nPhysical units requirement: Express the final membrane potentials in $\\mathrm{mV}$, rounded to three decimal places.\n\nAngle units are not applicable. Percentages are not applicable.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4,x_5,x_6]$), where each $x_k$ is a float in $\\mathrm{mV}$ rounded to three decimal places.",
            "solution": "The problem statement submitted for analysis is deemed valid. It is scientifically grounded, well-posed, and provides a complete and consistent set of parameters for a non-trivial problem in electrophysiology. It requires the derivation and application of fundamental principles, specifically the Nernst-Planck electrodiffusion model under the constant-field assumption.\n\nWe begin by deriving the current-voltage relationship for a single ionic species, which is the Goldman-Hodgkin-Katz (GHK) current equation. The starting point is the Nernst-Planck equation, which describes the flux $J_i(x)$ of an ionic species $i$ at position $x$ across the membrane:\n$$J_i(x) = -D_i \\left( \\frac{dC_i(x)}{dx} + \\frac{z_i F}{RT} C_i(x) \\frac{d\\phi(x)}{dx} \\right)$$\nHere, $D_i$ is the diffusion coefficient, $C_i(x)$ is the concentration, $z_i$ is the valence, $F$ is the Faraday constant, $R$ is the gas constant, $T$ is the absolute temperature, and $\\phi(x)$ is the electric potential.\n\nWe impose two key assumptions:\n1.  **Steady State**: The system is in a steady state, meaning the flux $J_i$ is constant for all $x$ within the membrane, i.e., $dJ_i/dx = 0$.\n2.  **Constant Field**: The electric field $E = -d\\phi/dx$ is constant across the membrane thickness $L$. If the potential difference across the membrane is $V_m = \\phi_{in} - \\phi_{out}$, then $E = -V_m/L$. Consequently, $d\\phi/dx = V_m/L$.\n\nSubstituting the constant field assumption into the Nernst-Planck equation yields a first-order linear ordinary differential equation for $C_i(x)$:\n$$\\frac{dC_i}{dx} + \\frac{z_i F V_m}{RT L} C_i(x) = -\\frac{J_i}{D_i}$$\nThis equation is solved subject to the boundary conditions at the outer ($x=0$) and inner ($x=L$) surfaces of the membrane: $C_i(0) = [i]_o$ and $C_i(L) = [i]_i$. The solution for the constant flux $J_i$ is:\n$$J_i = P_i \\frac{z_i F V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\nwhere the permeability $P_i$ is defined as $D_i/L$. The ionic current density $j_i$ is then $z_i F J_i$. The total current for a membrane area $A$ is $I_i = j_i A$. Customarily, permeability $P_i$ is defined to absorb geometric factors such that the current $I_i$ is written as:\n$$I_i(V_m) = P_i \\frac{z_i^2 F^2 V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\nThis is the GHK current equation. A positive current corresponds to a net outward flow of positive charge.\n\nThe reversal potential $E_{\\mathrm{rev}}$ is the membrane potential $V_m$ at which the total current across the membrane is zero. For the given system permeable to sodium ($\\mathrm{Na}^+$) and calcium ($\\mathrm{Ca}^{2+}$), this condition is:\n$$I_{\\mathrm{total}}(E_{\\mathrm{rev}}) = I_{\\mathrm{Na}}(E_{\\mathrm{rev}}) + I_{\\mathrm{Ca}}(E_{\\mathrm{rev}}) = 0$$\nFor a non-zero reversal potential ($E_{\\mathrm{rev}} \\ne 0$), the common factor $F^2 E_{\\mathrm{rev}} / RT$ can be divided out, yielding:\n$$P_{\\mathrm{Na}} z_{\\mathrm{Na}}^2 \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-z_{\\mathrm{Na}} u}}{1 - e^{-z_{\\mathrm{Na}} u}} + P_{\\mathrm{Ca}} z_{\\mathrm{Ca}}^2 \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-z_{\\mathrm{Ca}} u}}{1 - e^{-z_{\\mathrm{Ca}} u}} = 0$$\nwhere $u = F E_{\\mathrm{rev}} / (RT)$. Substituting the given valences $z_{\\mathrm{Na}}=+1$ and $z_{\\mathrm{Ca}}=+2$, and dividing by $P_{\\mathrm{Na}}$ (which is non-zero), we obtain an equation in terms of the permeability ratio $r = P_{\\mathrm{Ca}}/P_{\\mathrm{Na}}$:\n$$(1)^2 \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-u}}{1 - e^{-u}} + r (2)^2 \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-2u}}{1 - e^{-2u}} = 0$$\nThis is a transcendental equation for the unknown $u$, and thus for $E_{\\mathrm{rev}}$. Although the problem requires a numerical root-finding algorithm, it must be noted that this specific equation, due to the valences being $1$ and $2$, can be algebraically simplified. By letting $y = e^{-u}$ and using the identity $1-e^{-2u} = 1-y^2 = (1-y)(1+y)$, the equation transforms into a quadratic equation for $y$:\n$$([\\mathrm{Na}]_o + 4r[\\mathrm{Ca}]_o) y^2 + ([\\mathrm{Na}]_o - [\\mathrm{Na}]_i) y - ([\\mathrm{Na}]_i + 4r[\\mathrm{Ca}]_i) = 0$$\nSolving this provides an analytical solution for $E_{\\mathrm{rev}} = -\\frac{RT}{F}\\ln(y)$. This is the more elegant and direct method. However, to adhere to the problem's explicit instruction, we will proceed with a numerical root-finding approach. The analytical solution serves as an excellent means of verification.\n\nTo implement the numerical solution, we define a function $f(V_m, r)$ representing the sum of the GHK flux terms, whose root we seek:\n$$f(V_m, r) = \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-z_{\\mathrm{Na}} V_m F / RT}}{1 - e^{-z_{\\mathrm{Na}} V_m F / RT}} + 4r \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-z_{\\mathrm{Ca}} V_m F / RT}}{1 - e^{-z_{\\mathrm{Ca}} V_m F / RT}}$$\nThe parameters are given as:\n$T = 310\\,\\mathrm{K}$\n$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n$F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n$z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Ca}} = +2$\n$[\\mathrm{Na}]_o = 140\\,\\mathrm{mM}$, $[\\mathrm{Na}]_i = 12\\,\\mathrm{mM}$\n$[\\mathrm{Ca}]_o = 2\\,\\mathrm{mM}$, $[\\mathrm{Ca}]_i = 100\\,\\mathrm{nM} = 0.0001\\,\\mathrm{mM}$\n\nA robust numerical search requires bracketing the root. The reversal potential $E_{\\mathrm{rev}}$ is bounded by the Nernst potentials of the permeant ions. We calculate these boundaries:\n$$E_{\\mathrm{Na}} = \\frac{RT}{z_{\\mathrm{Na}}F} \\ln\\frac{[\\mathrm{Na}]_o}{[\\mathrm{Na}]_i} = \\frac{(8.314...)(310)}{(1)(96485...)} \\ln\\frac{140}{12} \\approx +65.623\\,\\mathrm{mV}$$\n$$E_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i} = \\frac{(8.314...)(310)}{(2)(96485...)} \\ln\\frac{2}{0.0001} \\approx +132.255\\,\\mathrm{mV}$$\nFor any permeability ratio $r \\geq 0$, the reversal potential $E_{\\mathrm{rev}}$ must lie in the interval $[E_{\\mathrm{Na}}, E_{\\mathrm{Ca}}]$. This provides a secure bracket for a root-finding algorithm such as the Brent-Dekker method (`brentq` in SciPy).\n\nThe algorithm proceeds as follows:\n1. Define the function $f(V_m, r)$ to be solved.\n2. For each given value of $r$ in the test suite $\\{0, 0.01, 0.1, 1, 10, 1000\\}$:\n   a. Handle the special case $r=0$, where $E_{\\mathrm{rev}} = E_{\\mathrm{Na}}$.\n   b. For $r > 0$, use `brentq` with the interval $[E_{\\mathrm{Na}}, E_{\\mathrm{Ca}}]$ (in Volts) to find the root $V_m = E_{\\mathrm{rev}}$.\n3. Convert the resulting potentials from Volts to Millivolts, round to three decimal places, and collect the results.\n\nThis procedure will yield the correct reversal potentials as requested.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the reversal potential for a membrane permeable to Na+ and Ca2+ ions\n    using the Goldman-Hodgkin-Katz (GHK) formalism.\n    The reversal potential is found numerically by solving I_total(V_m) = 0.\n    \"\"\"\n    # Physical Constants\n    R = 8.314462618  # Gas constant in J / (mol * K)\n    T = 310.0         # Absolute temperature in Kelvin\n    F = 96485.33212   # Faraday const in Coulombs / mol\n\n    # Ionic Concentrations in mM\n    conc_Na_o = 140.0 # Extracellular Sodium\n    conc_Na_i = 12.0  # Intracellular Sodium\n    conc_Ca_o = 2.0   # Extracellular Calcium\n    conc_Ca_i = 100.0e-6 # Intracellular Calcium (100 nM = 0.0001 mM)\n\n    # Ionic Valences\n    z_Na = 1.0\n    z_Ca = 2.0\n\n    # Test suite for permeability ratio r = P_Ca / P_Na\n    r_values = [0.0, 0.01, 0.1, 1.0, 10.0, 1000.0]\n\n    # Pre-calculate the thermal voltage term in Volts\n    RT_F = R * T / F\n\n    def get_reversal_potential(r: float, bracket: tuple) -> float:\n        \"\"\"\n        Calculates the reversal potential for a given permeability ratio r.\n        \n        Args:\n            r: The permeability ratio P_Ca / P_Na.\n            bracket: A tuple (a, b) providing an interval to search for the root.\n\n        Returns:\n            The reversal potential in Volts.\n        \"\"\"\n        \n        # The function to find the root of. This represents the sum of GHK fluxes.\n        # It is derived from the zero total current condition: I_Na + I_Ca = 0,\n        # after dividing out common non-zero terms.\n        def total_flux(V_m: float) -> float:\n            # Handle the singularity at V_m=0, though brentq is unlikely to evaluate\n            # exactly at zero if it's not the root.\n            if abs(V_m) < 1e-12:\n                # Based on the quadratic simplification, if V_m=0 (y=1), the LHS is\n                # (Na_o + 4r*Ca_o) + (Na_o - Na_i) - (Na_i + 4r*Ca_i)\n                # which is 2*(Na_o - Na_i) + 4r*(Ca_o - Ca_i), not generally zero.\n                # So V_m=0 is not a root, and we don't need special handling.\n                pass\n\n            term_Na = (conc_Na_i - conc_Na_o * np.exp(-z_Na * V_m / RT_F)) / \\\n                      (1 - np.exp(-z_Na * V_m / RT_F))\n            \n            term_Ca = 4 * r * (conc_Ca_i - conc_Ca_o * np.exp(-z_Ca * V_m / RT_F)) / \\\n                      (1 - np.exp(-z_Ca * V_m / RT_F))\n            \n            return term_Na + term_Ca\n\n        # The Brent-Dekker method is a robust root-finding algorithm.\n        E_rev_V = brentq(total_flux, bracket[0], bracket[1], xtol=1e-15, rtol=1e-15)\n        return E_rev_V\n\n    # Calculate Nernst potentials to define the search bracket for the root-finder.\n    # The reversal potential must lie between these two values.\n    E_Na_V = (RT_F / z_Na) * np.log(conc_Na_o / conc_Na_i)\n    E_Ca_V = (RT_F / z_Ca) * np.log(conc_Ca_o / conc_Ca_i)\n\n    # Ensure the bracket is ordered correctly for brentq, adding a small margin for safety.\n    search_bracket = (min(E_Na_V, E_Ca_V) - 0.01, max(E_Na_V, E_Ca_V) + 0.01)\n    \n    results = []\n    for r in r_values:\n        if r == 0.0:\n            # If the membrane is only permeable to Sodium, the reversal potential\n            # is the Nernst potential for Sodium.\n            E_rev_V = E_Na_V\n        else:\n            E_rev_V = get_reversal_potential(r, search_bracket)\n\n        # Convert result from Volts to Millivolts and round to 3 decimal places.\n        E_rev_mV = E_rev_V * 1000\n        results.append(round(E_rev_mV, 3))\n\n    # Print the final result in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The GHK model's cornerstone is the \"constant-field\" assumption, an idealization that simplifies the complex electrostatic environment within an ion channel. This advanced practice challenges you to explore what happens when this assumption is relaxed . By solving the Nernst-Planck equation for a defined non-constant electric field, you will gain hands-on experience with the powerful numerical techniques needed to model more physically realistic biophysical systems and develop a deeper appreciation for the GHK model's boundaries.",
            "id": "3937160",
            "problem": "Consider a one-dimensional membrane slab of thickness $L$ separating two well-stirred baths at positions $x=0$ (extracellular) and $x=L$ (intracellular). Three ionic species are present with valences $z_i \\in \\{+1,+1,-1\\}$ corresponding to potassium ($\\mathrm{K}^+$), sodium ($\\mathrm{Na}^+$), and chloride ($\\mathrm{Cl}^-$), respectively. The steady-state electrodiffusive flux $\\mathcal{J}_i$ of species $i$ across the slab follows the Nernst–Planck relation under isothermal conditions, where the electric field $E(x)$ is spatially varying. The baths are maintained at fixed concentrations $C_i(0)$ and $C_i(L)$, and the membrane exhibits species-specific diffusion coefficients $D_i$ that are uniform in space. Let $V(x)$ denote the electric potential, with transmembrane potential difference $\\Delta V = V(L) - V(0)$ assumed unknown. The electric field $E(x)$ is related to the potential by $E(x) = \\frac{dV}{dx}$, and is modeled as a departure from the constant field assumption via the profile\n$$\nE(x) = \\frac{\\Delta V}{L} \\left[1 + \\beta \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right],\n$$\nwhere $\\beta$ is a dimensionless parameter controlling the deviation magnitude. The unknown $\\Delta V$ must be determined from first principles by enforcing the zero net current condition at steady state. Throughout, use Faraday’s constant $F$, the universal gas constant $R$, and temperature $T$. Define the Goldman–Hodgkin–Katz (GHK) voltage equation acronym on first use as the Goldman–Hodgkin–Katz (GHK) voltage equation, but do not assume or use its closed-form result; instead, derive necessary relations from the Nernst–Planck framework.\n\nStarting only from the Nernst–Planck flux law and the stated field profile, formulate the boundary-value electrodiffusion problem, derive a computationally implementable expression for $\\mathcal{J}_i$ across the slab that is valid for the given non-constant field, and design an algorithm to find the unique $\\Delta V$ that yields zero net current. Express the final results for $\\Delta V$ in volts.\n\nYour program must compute $\\Delta V$ for each of the following test cases, and produce a single line of output containing a comma-separated list of the results enclosed in square brackets. Each result must be rounded to six decimal places and expressed in volts.\n\nConstants for all cases:\n- Thickness $L = 5 \\times 10^{-9}\\ \\text{m}$.\n- Temperature $T = 310\\ \\text{K}$.\n- Faraday’s constant $F = 96485\\ \\text{C}\\cdot\\text{mol}^{-1}$.\n- Universal gas constant $R = 8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$.\n- Valences $\\mathbf{z} = [1, 1, -1]$ for $[\\mathrm{K}^+, \\mathrm{Na}^+, \\mathrm{Cl}^-]$.\n- Species order is $[\\mathrm{K}^+, \\mathrm{Na}^+, \\mathrm{Cl}^-]$.\n- Concentrations are given in $\\text{mol}\\cdot\\text{m}^{-3}$; note that $1\\ \\text{mM} = 1\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n\nTest suite:\n1. Baseline constant-field case:\n   - Diffusion coefficients $\\mathbf{D} = [1.0 \\times 10^{-10},\\ 4.0 \\times 10^{-12},\\ 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$.\n   - Extracellular concentrations at $x=0$: $\\mathbf{C}(0) = [5,\\ 145,\\ 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n   - Intracellular concentrations at $x=L$: $\\mathbf{C}(L) = [140,\\ 12,\\ 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n   - Departure parameter $\\beta = 0$.\n\n2. Moderate departure from constant field:\n   - Same $\\mathbf{D}$ and concentrations as case $1$.\n   - $\\beta = 0.6$.\n\n3. Suppressed chloride mobility:\n   - Diffusion coefficients $\\mathbf{D} = [1.0 \\times 10^{-10},\\ 4.0 \\times 10^{-12},\\ 0.0]\\ \\text{m}^2\\cdot\\text{s}^{-1}$.\n   - Extracellular concentrations $\\mathbf{C}(0) = [5,\\ 145,\\ 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n   - Intracellular concentrations $\\mathbf{C}(L) = [140,\\ 12,\\ 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n   - $\\beta = 0.3$.\n\n4. Symmetric baths (near-zero potential expected):\n   - Diffusion coefficients $\\mathbf{D} = [1.0 \\times 10^{-10},\\ 4.0 \\times 10^{-12},\\ 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$.\n   - Extracellular concentrations $\\mathbf{C}(0) = [100,\\ 100,\\ 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n   - Intracellular concentrations $\\mathbf{C}(L) = [100,\\ 100,\\ 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$.\n   - $\\beta = 0.5$.\n\nRequirements:\n- Derive the electrodiffusion relations from first principles; do not invoke pre-derived forms of the Goldman–Hodgkin–Katz (GHK) voltage equation in the problem statement.\n- Enforce the zero net current condition $\\sum_i z_i \\mathcal{J}_i = 0$ to determine $\\Delta V$.\n- Your algorithm must be numerically stable for the above cases and must not assume a constant field except when $\\beta = 0$.\n- Final output: a single line containing $[\\Delta V_1,\\Delta V_2,\\Delta V_3,\\Delta V_4]$, where each $\\Delta V_k$ is in volts, rounded to six decimal places.",
            "solution": "The user wants a solution to a generalized electrodiffusion problem. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n- **System Geometry**: One-dimensional membrane slab of thickness $L = 5 \\times 10^{-9}\\ \\text{m}$. Extracellular bath at $x=0$, intracellular at $x=L$.\n- **Ionic Species**: Three species, Potassium ($\\mathrm{K}^+$), Sodium ($\\mathrm{Na}^+$), and Chloride ($\\mathrm{Cl}^-$).\n- **Valences**: $\\mathbf{z} = [z_{\\mathrm{K}^+}, z_{\\mathrm{Na}^+}, z_{\\mathrm{Cl}^-}] = [+1, +1, -1]$.\n- **Fundamental Law**: The steady-state electrodiffusive flux $\\mathcal{J}_i$ is governed by the Nernst–Planck relation: $\\mathcal{J}_i = -D_i \\left( \\frac{dC_i}{dx} + \\frac{z_i F}{RT} C_i E(x) \\right)$.\n- **Electric Field Model**: $E(x) = \\frac{\\Delta V}{L} \\left[1 + \\beta \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]$, where $\\Delta V = V(L) - V(0)$ is the unknown transmembrane potential.\n- **Zero Net Current Condition**: The system is at steady state with zero net current, i.e., $\\sum_i z_i \\mathcal{J}_i = 0$.\n- **Constants**:\n    - $L = 5 \\times 10^{-9}\\ \\text{m}$\n    - $T = 310\\ \\text{K}$\n    - $F = 96485\\ \\text{C}\\cdot\\text{mol}^{-1}$\n    - $R = 8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$\n- **Test Cases**:\n    1.  $\\mathbf{D} = [1.0 \\times 10^{-10}, 4.0 \\times 10^{-12}, 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$, $\\mathbf{C}(0) = [5, 145, 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$, $\\mathbf{C}(L) = [140, 12, 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$, $\\beta = 0$.\n    2.  Same as case 1, but with $\\beta = 0.6$.\n    3.  $\\mathbf{D} = [1.0 \\times 10^{-10}, 4.0 \\times 10^{-12}, 0.0]\\ \\text{m}^2\\cdot\\text{s}^{-1}$, $\\mathbf{C}(0) = [5, 145, 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$, $\\mathbf{C}(L) = [140, 12, 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$, $\\beta = 0.3$.\n    4.  $\\mathbf{D} = [1.0 \\times 10^{-10}, 4.0 \\times 10^{-12}, 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$, $\\mathbf{C}(0) = [100, 100, 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$, $\\mathbf{C}(L) = [100, 100, 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$, $\\beta = 0.5$.\n- **Task**: Derive an expression for $\\mathcal{J}_i$, design an algorithm to find $\\Delta V$ satisfying the zero net current condition, and compute $\\Delta V$ for the given test cases. Do not assume the Goldman-Hodgkin-Katz (GHK) voltage equation.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Nernst-Planck equation, a fundamental and well-established model for electrodiffusion. The proposed electric field is a mathematical generalization of the constant-field assumption used in the standard Goldman-Hodgkin-Katz (GHK) voltage equation. The model is consistent with the principles of electrostatics, as $\\int_0^L E(x) dx = \\Delta V$. The parameters are physiologically realistic. The problem is scientifically sound.\n- **Well-Posed**: The problem specifies all necessary physical parameters, boundary conditions for concentrations, and a constraint (zero net current) to determine the single unknown, $\\Delta V$. The function relating total current to $\\Delta V$ is expected to be monotonic, which ensures a unique solution exists. The problem is well-posed.\n- **Objective**: The problem is stated using precise, objective, and formal mathematical language. It is free from subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A principled solution will be developed.\n\n### Solution Derivation and Algorithm Design\nThe starting point is the one-dimensional, steady-state Nernst-Planck flux equation for an ionic species $i$:\n$$\n\\mathcal{J}_i = -D_i \\left( \\frac{dC_i(x)}{dx} + \\frac{z_i F}{RT} C_i(x) E(x) \\right)\n$$\nIn steady state, the flux $\\mathcal{J}_i$ must be constant for all $x \\in [0, L]$. The equation can be rearranged into a first-order linear ordinary differential equation for the concentration profile $C_i(x)$:\n$$\n\\frac{dC_i(x)}{dx} + \\left( \\frac{z_i F}{RT} E(x) \\right) C_i(x) = -\\frac{\\mathcal{J}_i}{D_i}\n$$\nThis equation can be solved using an integrating factor, $\\mu(x)$. Let the electric potential be $V(x)$, such that $E(x) = -\\frac{dV}{dx}$. However, the problem defines $E(x) = \\frac{dV}{dx}$, which implies flux is driven down the potential gradient. We will proceed with the problem's definition. The potential is found by integrating the electric field, assuming $V(0)=0$:\n$$\nV(x) = \\int_0^x E(s) ds = \\int_0^x \\frac{\\Delta V}{L} \\left[1 + \\beta \\sin\\left(\\frac{2\\pi s}{L}\\right)\\right] ds\n$$\n$$\nV(x) = \\frac{\\Delta V}{L} \\left[s - \\frac{\\beta L}{2\\pi} \\cos\\left(\\frac{2\\pi s}{L}\\right)\\right]_0^x = \\frac{\\Delta V}{L} \\left(x - \\frac{\\beta L}{2\\pi}\\cos\\left(\\frac{2\\pi x}{L}\\right) + \\frac{\\beta L}{2\\pi}\\right)\n$$\nNote that $V(L) = \\frac{\\Delta V}{L} (L - \\frac{\\beta L}{2\\pi} + \\frac{\\beta L}{2\\pi}) = \\Delta V$, which is consistent.\n\nLet's define a dimensionless potential energy term $\\phi_i(x) = \\frac{z_i F}{RT} V(x)$. The integrating factor is $\\mu(x) = e^{\\phi_i(x)}$. Multiplying the ODE by $\\mu(x)$ gives:\n$$\ne^{\\phi_i(x)} \\frac{dC_i(x)}{dx} + e^{\\phi_i(x)} \\left( \\frac{z_i F}{RT} E(x) \\right) C_i(x) = \\frac{d}{dx} \\left( C_i(x) e^{\\phi_i(x)} \\right) = -\\frac{\\mathcal{J}_i}{D_i} e^{\\phi_i(x)}\n$$\nWe integrate this expression across the membrane from $x=0$ to $x=L$:\n$$\n\\int_0^L \\frac{d}{dx} \\left( C_i(x) e^{\\phi_i(x)} \\right) dx = \\left[ C_i(x) e^{\\phi_i(x)} \\right]_0^L = -\\frac{\\mathcal{J}_i}{D_i} \\int_0^L e^{\\phi_i(x)} dx\n$$\nApplying the boundary values $C_i(0)$, $C_i(L)$, and noting that $\\phi_i(0)=0$ and $\\phi_i(L) = \\frac{z_i F \\Delta V}{RT}$, we get:\n$$\nC_i(L) e^{\\frac{z_i F \\Delta V}{RT}} - C_i(0) e^0 = -\\frac{\\mathcal{J}_i}{D_i} \\int_0^L e^{\\phi_i(x)} dx\n$$\nNow, we can isolate the flux $\\mathcal{J}_i$:\n$$\n\\mathcal{J}_i = D_i \\frac{C_i(0) - C_i(L) e^{\\frac{z_i F \\Delta V}{RT}}}{\\int_0^L \\exp\\left(\\frac{z_i F V(x)}{RT}\\right) dx}\n$$\nThis is a general expression for the flux of species $i$ given the potential profile $V(x)$. Let's introduce the dimensionless transmembrane potential $u = \\frac{F \\Delta V}{RT}$. The expression for $\\mathcal{J}_i$ becomes:\n$$\n\\mathcal{J}_i(\\Delta V) = D_i \\frac{C_i(0) - C_i(L) e^{z_i u}}{\\int_0^L \\exp\\left(z_i u \\left[ \\frac{x}{L} - \\frac{\\beta}{2\\pi}\\left(\\cos\\left(\\frac{2\\pi x}{L}\\right)-1\\right) \\right]\\right) dx}\n$$\nThe unknown membrane potential $\\Delta V$ is determined by the zero net current condition:\n$$\nI_{net}(\\Delta V) = \\sum_i z_i F \\mathcal{J}_i(\\Delta V) = 0 \\implies \\sum_i z_i \\mathcal{J}_i(\\Delta V) = 0\n$$\nWe must find the root $\\Delta V$ of the function $f(\\Delta V) = \\sum_i z_i \\mathcal{J}_i(\\Delta V)$.\n\n**Special Case: Constant Field ($\\beta = 0$)**\nWhen $\\beta=0$, the potential is linear: $V(x) = \\Delta V \\frac{x}{L}$. The integral in the denominator can be solved analytically:\n$$\n\\int_0^L e^{\\frac{z_i F \\Delta V}{RT} \\frac{x}{L}} dx = \\int_0^L e^{z_i u \\frac{x}{L}} dx = \\frac{L}{z_i u} \\left[ e^{z_i u \\frac{x}{L}} \\right]_0^L = \\frac{L}{z_i u} (e^{z_i u} - 1)\n$$\nSubstituting this into the flux expression gives the Goldman–Hodgkin–Katz (GHK) flux equation:\n$$\n\\mathcal{J}_i = D_i \\frac{C_i(0) - C_i(L)e^{z_i u}}{\\frac{L}{z_i u}(e^{z_i u} - 1)} = \\frac{D_i z_i u}{L} \\frac{C_i(0) - C_i(L)e^{z_i u}}{e^{z_i u} - 1}\n$$\nFor $u \\to 0$, L'Hôpital's rule gives $\\mathcal{J}_i \\to \\frac{D_i}{L}(C_i(0) - C_i(L))$, which is Fick's law of diffusion.\n\n**General Case ($\\beta \\neq 0$)**\nFor a non-zero $\\beta$, the integral in the denominator must be computed numerically.\n\n**Algorithm**\nThe problem reduces to finding the root of the non-linear function $f(\\Delta V) = \\sum_i z_i \\mathcal{J}_i(\\Delta V)$.\n1.  Define a function `total_current(delta_V)` that computes $f(\\Delta V)$.\n2.  Inside this function, calculate the dimensionless potential $u = \\frac{F \\Delta V}{RT}$.\n3.  For each ionic species $i$:\n    a. If $\\beta=0$, calculate $\\mathcal{J}_i$ using the analytical GHK flux equation. A numerically stable form should be used, especially for $u \\approx 0$.\n    b. If $\\beta \\neq 0$, calculate $\\mathcal{J}_i$ by first computing the denominator integral using a numerical quadrature method (e.g., `scipy.integrate.quad`). To maintain numerical stability for large $|u|$, the flux expression can be rearranged. For $z_i u > 0$, we can use $\\mathcal{J}_i = D_i \\frac{C_i(0)e^{-z_i u} - C_i(L)}{\\int_0^L \\exp(\\phi_i(x) - z_i u) dx}$ to prevent overflow. For $z_i u \\le 0$, the original form is stable.\n    c. Compute the current contribution $I_i = z_i \\mathcal{J}_i$.\n4.  The function returns the sum $\\sum_i I_i$.\n5.  Use a numerical root-finding algorithm, such as `scipy.optimize.brentq`, to find the $\\Delta V$ for which `total_current(delta_V)` is zero. A bracketing interval like $[-0.2, 0.2]$ Volts is appropriate, as typical resting potentials fall within this range.\n6.  Repeat this process for each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the transmembrane potential DeltaV under steady-state electrodiffusion\n    for several test cases with a generalized, non-constant electric field.\n    \"\"\"\n    \n    # Define physical constants\n    R = 8.314  # Universal gas constant in J/(mol*K)\n    F = 96485   # Faraday's constant in C/mol\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.0,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 4.5e-11]),\n            \"C_out\": np.array([5, 145, 110]),\n            \"C_in\": np.array([140, 12, 4])\n        },\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.6,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 4.5e-11]),\n            \"C_out\": np.array([5, 145, 110]),\n            \"C_in\": np.array([140, 12, 4])\n        },\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.3,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 0.0]),\n            \"C_out\": np.array([5, 145, 110]),\n            \"C_in\": np.array([140, 12, 4])\n        },\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.5,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 4.5e-11]),\n            \"C_out\": np.array([100, 100, 100]),\n            \"C_in\": np.array([100, 100, 100])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, T, beta = case[\"L\"], case[\"T\"], case[\"beta\"]\n        z_vec, D_vec = case[\"z\"], case[\"D\"]\n        C_out_vec, C_in_vec = case[\"C_out\"], case[\"C_in\"]\n        \n        RT_over_F = R * T / F\n\n        def total_current(delta_V):\n            \"\"\"\n            Calculates the total ionic current across the membrane for a given DeltaV.\n            The root of this function is the resting potential.\n            \"\"\"\n            u = delta_V / RT_over_F\n            net_current = 0.0\n\n            for i in range(len(z_vec)):\n                z_i, D_i, C_out, C_in = z_vec[i], D_vec[i], C_out_vec[i], C_in_vec[i]\n                \n                if D_i == 0.0:\n                    continue  # This species is impermeable, its flux is zero.\n                \n                val = z_i * u\n                flux = 0.0\n                \n                # Special case for beta=0 (constant field), use GHK flux equation\n                if beta == 0:\n                    if abs(val) < 1e-9:\n                        # Use L'Hopital's rule for val -> 0 (Fick's Law limit)\n                        flux = (D_i / L) * (C_out - C_in)\n                    else:\n                        # Numerically stable form of GHK flux equation\n                        flux = (D_i / L) * val * (C_out - C_in * np.exp(val)) / (np.expm1(val))\n                \n                # General case for beta != 0, requires numerical integration\n                else:\n                    def potential_exponent(x, z, u_val, b, l_val):\n                        term1 = x / l_val\n                        term2 = (b / (2.0 * np.pi)) * (np.cos(2.0 * np.pi * x / l_val) - 1.0)\n                        return z * u_val * (term1 - term2)\n\n                    if val > 0:\n                        # Numerically stable form for large positive val to avoid overflow\n                        # We divide numerator and denominator by exp(val), moving it into the integral argument\n                        def stable_integrand(x):\n                             exp_arg = potential_exponent(x, z_i, u, beta, L) - val\n                             return np.exp(exp_arg)\n                        integral_val, _ = quad(stable_integrand, 0, L)\n                        flux = D_i * (C_out * np.exp(-val) - C_in) / integral_val\n                    else: # val <= 0\n                        # Original form is stable for non-positive val\n                        def integrand(x):\n                            return np.exp(potential_exponent(x, z_i, u, beta, L))\n                        integral_val, _ = quad(integrand, 0, L)\n                        if integral_val == 0:\n                            # This should not happen with finite val, but for safety\n                            flux = np.inf if (C_out - C_in * np.exp(val)) != 0 else 0\n                        else:\n                            flux = D_i * (C_out - C_in * np.exp(val)) / integral_val\n                \n                net_current += z_i * flux\n                \n            return net_current\n\n        # Find the root of the total_current function within a plausible physiological range.\n        # The function is monotonic, so a bracketing root-finder is robust.\n        try:\n            delta_V_solution = brentq(total_current, -0.2, 0.2, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This can occur if total_current(-0.2) and total_current(0.2) have the same sign.\n            # For this problem, this may happen if the root is exactly 0.\n            if abs(total_current(0.0)) < 1e-9:\n                delta_V_solution = 0.0\n            else:\n                # If the bracket is wrong, expand it and try again.\n                delta_V_solution = brentq(total_current, -1.0, 1.0, xtol=1e-12, rtol=1e-12)\n        \n        results.append(f\"{delta_V_solution:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}