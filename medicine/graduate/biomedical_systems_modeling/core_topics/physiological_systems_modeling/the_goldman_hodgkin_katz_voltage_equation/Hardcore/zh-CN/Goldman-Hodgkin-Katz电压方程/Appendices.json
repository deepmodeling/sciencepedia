{
    "hands_on_practices": [
        {
            "introduction": "戈德曼-霍奇金-卡茨（GHK）电压方程是计算细胞静息膜电位的基石。本练习将通过一个包含多种单价离子的系统，来巩固该方程的推导过程，并探讨其对绝对温度这一关键实验参数的直接依赖性。通过计算一个小的温度误差所引入的电位偏差，你将对该模型的物理基础及其参数敏感性获得一个切实的理解。",
            "id": "2763570",
            "problem": "一个处于稳态的单室神经元对三种单价离子——钾离子 $\\mathrm{K}^+$、钠离子 $\\mathrm{Na}^+$ 和氯离子 $\\mathrm{Cl}^-$ 是可渗透的。假设满足恒定场（空间均匀电场）近似、离子独立运动且无主动转运。细胞外浓度为 $[\\mathrm{K}^+]_o = 5.0\\,\\text{mM}$、$[\\mathrm{Na}^+]_o = 145.0\\,\\text{mM}$ 和 $[\\mathrm{Cl}^-]_o = 110.0\\,\\text{mM}$；细胞内浓度为 $[\\mathrm{K}^+]_i = 140.0\\,\\text{mM}$、$[\\mathrm{Na}^+]_i = 12.0\\,\\text{mM}$ 和 $[\\mathrm{Cl}^-]_i = 10.0\\,\\text{mM}$。相对渗透率为 $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1.00 : 0.050 : 0.450$。设真实生理温度为 $T_{\\text{true}} = 310\\,\\text{K}$。\n\n从每种离子的能斯特-普朗克通量出发，在恒定场假设下施加稳态时净电流为零的条件，推导出膜电位 $V_m$ 作为温度 $T$、渗透率 $P_i$ 以及细胞内外浓度的函数。利用此结果，推导因错误地使用 $T_{\\text{used}} = 295\\,\\text{K}$ 代替 $T_{\\text{true}} = 310\\,\\text{K}$ 而引入的偏差的解析表达式\n$$\\Delta V \\equiv V_m(T_{\\text{used}}) - V_m(T_{\\text{true}})$$\n并保持所有渗透率和浓度不变。\n\n然后，使用 $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ 和 $F = 96485.33212\\,\\text{C}\\,\\text{mol}^{-1}$ 对 $\\Delta V$ 进行数值计算。将您最终的 $\\Delta V$ 数值答案以毫伏为单位表示，并四舍五入到四位有效数字。\n\n最后，简要讨论在典型的低噪声条件和适当滤波的情况下，使用现代全细胞膜片钳技术是否能在实验上检测到这种量级的偏差。您的讨论将不根据数值准确性评分，但应基于第一性原理和典型仪器性能进行物理推理。评分的量仅为 $\\Delta V$ 的数值。",
            "solution": "所提出的问题是自洽的，科学上基于已确立的生物物理学原理，并且是适定的。因此，该问题是有效的，并将提供解答。\n\n问题要求从第一性原理，特别是在恒定场假设下的能斯特-普朗克方程，推导膜电位 $V_m$。\n\n能斯特-普朗克方程描述了离子种类 $s$ 穿过膜的通量 $J_s$，其是浓度梯度和电场的函数：\n$$ J_s(x) = -D_s \\left( \\frac{dC_s(x)}{dx} + \\frac{z_s F}{RT} C_s(x) \\frac{d\\phi(x)}{dx} \\right) $$\n此处，$D_s$ 是离子 $s$ 在膜内的扩散系数，$C_s(x)$ 是其在膜厚度上位置 $x$ 处的浓度，$z_s$ 是其化合价，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$\\phi(x)$ 是电势。\n\n恒定场近似假设在厚度为 $L$ 的膜上存在一个均匀电场 $E$。因此，电势梯度是恒定的：$\\frac{d\\phi}{dx} = \\frac{\\phi_{in} - \\phi_{out}}{L} = \\frac{V_m}{L}$。能斯特-普朗克方程变为关于 $C_s(x)$ 的常微分方程：\n$$ J_s = -D_s \\left( \\frac{dC_s}{dx} + \\frac{z_s F V_m}{R T L} C_s \\right) $$\n该方程可以在边界条件 $C_s(0) = [s]_o$（细胞外浓度）和 $C_s(L) = [s]_i$（细胞内浓度）下，针对恒定通量 $J_s$ 求解。通量的解为：\n$$ J_s = -P_s \\frac{z_s F V_m}{RT} \\frac{[s]_i \\exp\\left(\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(\\frac{z_s F V_m}{RT}\\right) - 1} $$\n其中渗透率 $P_s$ 通过 $P_s \\equiv D_s/L$ 与扩散系数相关（假设分配系数为单位1）。\n\n由离子 $s$ 携带的电流密度为 $I_s = z_s F J_s$：\n$$ I_s = -P_s \\frac{(z_s F)^2 V_m}{RT} \\frac{[s]_i \\exp\\left(\\frac{z_s F V_m}{RT}\\right) - [s]_o}{\\exp\\left(\\frac{z_s F V_m}{RT}\\right) - 1} $$\n为方便起见，可以通过将分数的分子和分母同乘以 $\\exp\\left(-\\frac{z_s F V_m}{RT}\\right)$ 来重写此式：\n$$ I_s = P_s \\frac{(z_s F)^2 V_m}{RT} \\frac{[s]_o - [s]_i \\exp\\left(-\\frac{z_s F V_m}{RT}\\right)}{1 - \\exp\\left(-\\frac{z_s F V_m}{RT}\\right)} $$\n在稳态下，没有净电流穿过膜，因此所有离子电流的总和必须为零：$\\sum_s I_s = 0$。对于给定的离子 $\\mathrm{K}^+$、$\\mathrm{Na}^+$ 和 $\\mathrm{Cl}^-$，我们有：\n$$ I_{\\mathrm{K}} + I_{\\mathrm{Na}} + I_{\\mathrm{Cl}} = 0 $$\n这些离子是单价的，所以 $z_{\\mathrm{K}} = +1$，$z_{\\mathrm{Na}} = +1$，$z_{\\mathrm{Cl}} = -1$。令 $u = \\frac{F V_m}{RT}$。条件变为：\n$$ P_{\\mathrm{K}} \\frac{[ \\mathrm{K}^+ ]_o - [ \\mathrm{K}^+ ]_i e^u}{1 - e^u} + P_{\\mathrm{Na}} \\frac{[ \\mathrm{Na}^+ ]_o - [ \\mathrm{Na}^+ ]_i e^u}{1 - e^u} + P_{\\mathrm{Cl}} \\frac{[ \\mathrm{Cl}^- ]_o - [ \\mathrm{Cl}^- ]_i e^{-u}}{1 - e^{-u}} = 0 $$\n注意，公共因子 $\\frac{F^2 V_m}{RT}$ 已被消去，因为它不为零。$\\mathrm{Cl}^-$ 项可以重写，使其具有与阳离子项相同的分母：\n$$ \\frac{[ \\mathrm{Cl}^- ]_o - [ \\mathrm{Cl}^- ]_i e^{-u}}{1 - e^{-u}} = \\frac{e^u ([ \\mathrm{Cl}^- ]_o - [ \\mathrm{Cl}^- ]_i e^{-u})}{e^u (1 - e^{-u})} = \\frac{[ \\mathrm{Cl}^- ]_o e^u - [ \\mathrm{Cl}^- ]_i}{e^u - 1} = \\frac{[ \\mathrm{Cl}^- ]_i - [ \\mathrm{Cl}^- ]_o e^u}{1 - e^u} $$\n将此代回零电流方程，并消去公分母 $(1 - e^u)$，得到：\n$$ P_{\\mathrm{K}}([ \\mathrm{K}^+ ]_o - [ \\mathrm{K}^+ ]_i e^u) + P_{\\mathrm{Na}}([ \\mathrm{Na}^+ ]_o - [ \\mathrm{Na}^+ ]_i e^u) + P_{\\mathrm{Cl}}([ \\mathrm{Cl}^- ]_i - [ \\mathrm{Cl}^- ]_o e^u) = 0 $$\n我们通过组合项来求解 $e^u$：\n$$ P_{\\mathrm{K}}[ \\mathrm{K}^+ ]_o + P_{\\mathrm{Na}}[ \\mathrm{Na}^+ ]_o + P_{\\mathrm{Cl}}[ \\mathrm{Cl}^- ]_i = e^u \\left( P_{\\mathrm{K}}[ \\mathrm{K}^+ ]_i + P_{\\mathrm{Na}}[ \\mathrm{Na}^+ ]_i + P_{\\mathrm{Cl}}[ \\mathrm{Cl}^- ]_o \\right) $$\n$$ e^u = \\exp\\left(\\frac{F V_m}{RT}\\right) = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i}{P_{\\mathrm{K}}[\\mathrm{K}^+]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o} $$\n求解 $V_m$ 得到高盛-霍奇金-卡茨 (GHK) 电压方程：\n$$ V_m(T) = \\frac{RT}{F} \\ln \\left( \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i}{P_{\\mathrm{K}}[\\mathrm{K}^+]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o} \\right) $$\n这个 $V_m$ 的表达式是温度 $T$、渗透率 $P_i$ 和浓度的函数。\n\n接下来，我们推导偏差 $\\Delta V = V_m(T_{\\text{used}}) - V_m(T_{\\text{true}})$ 的解析表达式。由于所有浓度和渗透率都保持固定，对数项与温度无关。我们将这个无量纲比率定义为 $Y$：\n$$ Y = \\frac{P_{\\mathrm{K}}[\\mathrm{K}^+]_o + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_o + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_i}{P_{\\mathrm{K}}[\\mathrm{K}^+]_i + P_{\\mathrm{Na}}[\\mathrm{Na}^+]_i + P_{\\mathrm{Cl}}[\\mathrm{Cl}^-]_o} $$\n那么，$V_m(T) = \\frac{RT}{F} \\ln(Y)$。偏差为：\n$$ \\Delta V = V_m(T_{\\text{used}}) - V_m(T_{\\text{true}}) = \\frac{R T_{\\text{used}}}{F} \\ln(Y) - \\frac{R T_{\\text{true}}}{F} \\ln(Y) $$\n$$ \\Delta V = \\frac{R}{F} (T_{\\text{used}} - T_{\\text{true}}) \\ln(Y) $$\n这就是所要求的偏差的解析表达式。\n\n现在，我们对 $\\Delta V$ 进行数值计算。给定的相对渗透率为 $P_{\\mathrm{K}} : P_{\\mathrm{Na}} : P_{\\mathrm{Cl}} = 1.00 : 0.050 : 0.450$。我们可以直接使用这些值，因为它们在 $Y$ 的表达式中以比率形式出现。设 $P_{\\mathrm{K}}=1.00$，$P_{\\mathrm{Na}}=0.050$，$P_{\\mathrm{Cl}}=0.450$。\n给定的浓度为：\n$[\\mathrm{K}^+]_o = 5.0\\,\\text{mM}$, $[\\mathrm{Na}^+]_o = 145.0\\,\\text{mM}$, $[\\mathrm{Cl}^-]_o = 110.0\\,\\text{mM}$\n$[\\mathrm{K}^+]_i = 140.0\\,\\text{mM}$, $[\\mathrm{Na}^+]_i = 12.0\\,\\text{mM}$, $[\\mathrm{Cl}^-]_i = 10.0\\,\\text{mM}$\n\n$Y$ 的分子是：\n$ (1.00)(5.0) + (0.050)(145.0) + (0.450)(10.0) = 5.0 + 7.25 + 4.5 = 16.75 $\n$Y$ 的分母是：\n$ (1.00)(140.0) + (0.050)(12.0) + (0.450)(110.0) = 140.0 + 0.6 + 49.5 = 190.1 $\n所以，$Y = \\frac{16.75}{190.1}$。\n\n温度为 $T_{\\text{used}} = 295\\,\\text{K}$ 和 $T_{\\text{true}} = 310\\,\\text{K}$，因此温差为 $T_{\\text{used}} - T_{\\text{true}} = -15\\,\\text{K}$。\n使用给定的常数 $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ 和 $F = 96485.33212\\,\\text{C}\\,\\text{mol}^{-1}$：\n$$ \\Delta V = \\left( \\frac{8.314462618}{96485.33212} \\right) (-15) \\ln\\left(\\frac{16.75}{190.1}\\right) $$\n$$ \\Delta V \\approx (8.61733 \\times 10^{-5} \\,\\text{V}\\,\\text{K}^{-1}) \\times (-15\\,\\text{K}) \\times (-2.429215) $$\n$$ \\Delta V \\approx 0.003139535\\,\\text{V} $$\n以毫伏表示，即为 $\\Delta V \\approx 3.139535\\,\\text{mV}$。四舍五入到四位有效数字得到 $3.140\\,\\text{mV}$。\n\n最后，关于实验可观测性的简要讨论。$\\Delta V \\approx 3.14\\,\\text{mV}$ 的系统性膜电位偏差是相当大的，使用现代全细胞膜片钳电生理学技术很容易检测到。在典型的低噪声记录条件下，经过适当滤波后，膜电位测量的均方根 (RMS) 噪声在 $100-200\\,\\mu\\text{V}$（或 $0.1-0.2\\,\\text{mV}$）的量级。超过 $3\\,\\text{mV}$ 的系统性偏移比这个噪声基底大一个数量级以上。这种静息电位的变化具有生理学意义，并且完全在标准实验设备的分辨率之内。在任何细胞电生理学研究中，由不正确的温度值导致的如此大小的误差将是一个严重的混淆因素。",
            "answer": "$$\\boxed{3.140}$$"
        },
        {
            "introduction": "GHK电压方程虽然常用，但其更根本的威力体现在GHK电流方程中，尤其是在处理对混合价态离子（如$Na^{+}$和$Ca^{2+}$）通透的离子通道时。本练习将挑战你从能斯特-普朗克方程出发，推导电流-电压关系，并利用数值方法求解反转电位。这项技能对于模拟那些无法适用简化版GHK电压公式的生物通道至关重要。",
            "id": "2763525",
            "problem": "要求您使用第一性原理电扩散模型计算对钙离子和钠离子具有渗透性的膜通道的反转电位。请从恒定场假设下的稳态能斯特-普朗克描述出发，并施加跨膜净电流为零的条件。考虑两种离子：化合价为 $z_{\\mathrm{Ca}}=+2$ 的钙离子和化合价为 $z_{\\mathrm{Na}}=+1$ 的钠离子。绝对温度为 $T=310\\,\\mathrm{K}$，气体常数为 $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，法拉第常数为 $F=96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$。细胞外和细胞内的活度（此处近似为浓度）如下：$[\\mathrm{Ca}]_o=2\\,\\mathrm{mM}$，$[\\mathrm{Ca}]_i=100\\,\\mathrm{nM}$，$[\\mathrm{Na}]_o=140\\,\\mathrm{mM}$，以及 $[\\mathrm{Na}]_i=12\\,\\mathrm{mM}$。请确保所有浓度使用一致的单位；必要时将纳摩尔（nanomolar）转换为毫摩尔（millimolar）。设渗透性比值为 $r=P_{\\mathrm{Ca}}/P_{\\mathrm{Na}}$，其中 $P_{\\mathrm{Na}}>0$ 是任意的，因为在净电流为零时，只有比值有意义。反转电位 $E_{\\mathrm{rev}}$ 定义为总离子电流为零时的膜电位 $V_m$（内部相对于外部）。\n\n您的任务是：\n- 从恒定场假设下的稳态能斯特-普朗克方程出发，推导出化合价为 $z_i$、渗透性为 $P_i$ 的离子种类 $i$ 在膜电位为 $V_m$ 时跨膜离子电流的表达式，该表达式是 $[\\mathrm{ion}]_i$、$[\\mathrm{ion}]_o$、$z_i$、$P_i$、$R$、$T$ 和 $F$ 的函数。\n- 对双离子体系 $\\{\\mathrm{Ca}^{2+},\\mathrm{Na}^+\\}$ 施加净电流为零的条件，并证明对于给定的 $r$ 和浓度，$E_{\\mathrm{rev}}$ 是唯一确定的，过程中不使用任何预先记忆的简化公式。\n- 实现一个数值求根算法，通过找到使给定 $r$ 的总电流为零的 $V_m$ 来求解 $E_{\\mathrm{rev}}$（单位为伏特）。\n- 以毫伏为单位表示最终答案，并四舍五入到三位小数。\n\n使用以下渗透性比值测试套件来评估您的程序：\n- $r=0$\n- $r=0.01$\n- $r=0.1$\n- $r=1$\n- $r=10$\n- $r=1000$\n\n所有其他参数均按上文规定固定。您的程序应在一行中输出与这六个测试用例相对应的六个反转电位，形式为一个由方括号括起来的逗号分隔的浮点数列表（单位为 $\\mathrm{mV}$，四舍五入到三位小数），例如：$[\\dots]$。\n\n物理单位要求：以 $\\mathrm{mV}$ 为单位表示最终的膜电位，并四舍五入到三位小数。\n\n角度单位不适用。百分比不适用。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果（例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$），其中每个 $x_k$ 是一个以 $\\mathrm{mV}$ 为单位、四舍五入到三位小数的浮点数。",
            "solution": "提交分析的问题陈述被认为是有效的。它具有科学依据，问题定义明确，并为电生理学中的一个非平凡问题提供了一套完整且一致的参数。它要求推导和应用基本原理，特别是恒定场假设下的能斯特-普朗克电扩散模型。\n\n我们首先推导单一离子种类的电流-电压关系，即 Goldman-Hodgkin-Katz (GHK) 电流方程。起点是能斯特-普朗克方程，它描述了离子种类 $i$ 在跨膜位置 $x$ 处的通量 $J_i(x)$：\n$$J_i(x) = -D_i \\left( \\frac{dC_i(x)}{dx} + \\frac{z_i F}{RT} C_i(x) \\frac{d\\phi(x)}{dx} \\right)$$\n在这里，$D_i$ 是扩散系数，$C_i(x)$ 是浓度，$z_i$ 是化合价，$F$ 是法拉第常数，$R$ 是气体常数，$T$ 是绝对温度，而 $\\phi(x)$ 是电势。\n\n我们施加两个关键假设：\n1.  **稳态**：系统处于稳态，意味着通量 $J_i$ 在膜内所有位置 $x$ 处都是恒定的，即 $dJ_i/dx = 0$。\n2.  **恒定场**：电场 $E = -d\\phi/dx$ 在整个膜厚度 $L$ 上是恒定的。如果跨膜电位差为 $V_m = \\phi_{in} - \\phi_{out}$，则 $E = -V_m/L$。因此，$d\\phi/dx = V_m/L$。\n\n将恒定场假设代入能斯特-普朗克方程，得到一个关于 $C_i(x)$ 的一阶线性常微分方程：\n$$\\frac{dC_i}{dx} + \\frac{z_i F V_m}{RT L} C_i(x) = -\\frac{J_i}{D_i}$$\n该方程在膜外表面（$x=0$）和内表面（$x=L$）的边界条件 $C_i(0) = [i]_o$ 和 $C_i(L) = [i]_i$ 下求解。恒定通量 $J_i$ 的解为：\n$$J_i = P_i \\frac{z_i F V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\n其中渗透性 $P_i$ 定义为 $D_i/L$。离子电流密度 $j_i$ 继而为 $z_i F J_i$。对于面积为 $A$ 的膜，总电流为 $I_i = j_i A$。习惯上，渗透性 $P_i$ 的定义会吸收几何因子，使得电流 $I_i$ 可以写作：\n$$I_i(V_m) = P_i \\frac{z_i^2 F^2 V_m}{RT} \\frac{[i]_i - [i]_o e^{-z_i F V_m / (RT)}}{1 - e^{-z_i F V_m / (RT)}}$$\n这就是 GHK 电流方程。正电流对应正电荷的净向外流动。\n\n反转电位 $E_{\\mathrm{rev}}$ 是总跨膜电流为零时的膜电位 $V_m$。对于给定的对钠离子（$\\mathrm{Na}^+$）和钙离子（$\\mathrm{Ca}^{2+}$）具有渗透性的系统，此条件为：\n$$I_{\\mathrm{total}}(E_{\\mathrm{rev}}) = I_{\\mathrm{Na}}(E_{\\mathrm{rev}}) + I_{\\mathrm{Ca}}(E_{\\mathrm{rev}}) = 0$$\n对于非零反转电位（$E_{\\mathrm{rev}} \\ne 0$），公因子 $F^2 E_{\\mathrm{rev}} / RT$ 可以被约去，得到：\n$$P_{\\mathrm{Na}} z_{\\mathrm{Na}}^2 \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-z_{\\mathrm{Na}} u}}{1 - e^{-z_{\\mathrm{Na}} u}} + P_{\\mathrm{Ca}} z_{\\mathrm{Ca}}^2 \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-z_{\\mathrm{Ca}} u}}{1 - e^{-z_{\\mathrm{Ca}} u}} = 0$$\n其中 $u = F E_{\\mathrm{rev}} / (RT)$。代入给定的化合价 $z_{\\mathrm{Na}}=+1$ 和 $z_{\\mathrm{Ca}}=+2$，并除以 $P_{\\mathrm{Na}}$（非零），我们得到一个以渗透性比值 $r = P_{\\mathrm{Ca}}/P_{\\mathrm{Na}}$ 表示的方程：\n$$(1)^2 \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-u}}{1 - e^{-u}} + r (2)^2 \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-2u}}{1 - e^{-2u}} = 0$$\n这是一个关于未知数 $u$（并因此是关于 $E_{\\mathrm{rev}}$）的超越方程。尽管题目要求使用数值求根算法，但必须指出，由于化合价为1和2，这个特定方程可以进行代数简化。通过令 $y = e^{-u}$ 并使用恒等式 $1-e^{-2u} = 1-y^2 = (1-y)(1+y)$，该方程可转换为一个关于 $y$ 的二次方程：\n$$([\\mathrm{Na}]_o + 4r[\\mathrm{Ca}]_o) y^2 + ([\\mathrm{Na}]_o - [\\mathrm{Na}]_i) y - ([\\mathrm{Na}]_i + 4r[\\mathrm{Ca}]_i) = 0$$\n求解这个方程可以得到 $E_{\\mathrm{rev}} = -\\frac{RT}{F}\\ln(y)$ 的解析解。这是一种更优雅和直接的方法。然而，为遵守题目的明确指示，我们将采用数值求根方法。解析解可作为一种极好的验证手段。\n\n为实现数值解，我们定义一个函数 $f(V_m, r)$，它代表 GHK 通量项之和，我们将寻求该函数的根：\n$$f(V_m, r) = \\frac{[\\mathrm{Na}]_i - [\\mathrm{Na}]_o e^{-z_{\\mathrm{Na}} V_m F / RT}}{1 - e^{-z_{\\mathrm{Na}} V_m F / RT}} + 4r \\frac{[\\mathrm{Ca}]_i - [\\mathrm{Ca}]_o e^{-z_{\\mathrm{Ca}} V_m F / RT}}{1 - e^{-z_{\\mathrm{Ca}} V_m F / RT}}$$\n给定的参数如下：\n$T = 310\\,\\mathrm{K}$\n$R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n$F = 96485.33212\\,\\mathrm{C}\\,\\mathrm{mol}^{-1}$\n$z_{\\mathrm{Na}} = +1$, $z_{\\mathrm{Ca}} = +2$\n$[\\mathrm{Na}]_o = 140\\,\\mathrm{mM}$, $[\\mathrm{Na}]_i = 12\\,\\mathrm{mM}$\n$[\\mathrm{Ca}]_o = 2\\,\\mathrm{mM}$, $[\\mathrm{Ca}]_i = 100\\,\\mathrm{nM} = 0.0001\\,\\mathrm{mM}$\n\n一个稳健的数值搜索需要将根括定在一个区间内。反转电位 $E_{\\mathrm{rev}}$ 受限于可渗透离子的能斯特电位。我们计算这些边界：\n$$E_{\\mathrm{Na}} = \\frac{RT}{z_{\\mathrm{Na}}F} \\ln\\frac{[\\mathrm{Na}]_o}{[\\mathrm{Na}]_i} = \\frac{(8.314...)(310)}{(1)(96485...)} \\ln\\frac{140}{12} \\approx +65.623\\,\\mathrm{mV}$$\n$$E_{\\mathrm{Ca}} = \\frac{RT}{z_{\\mathrm{Ca}}F} \\ln\\frac{[\\mathrm{Ca}]_o}{[\\mathrm{Ca}]_i} = \\frac{(8.314...)(310)}{(2)(96485...)} \\ln\\frac{2}{0.0001} \\approx +132.255\\,\\mathrm{mV}$$\n对于任何渗透性比值 $r \\geq 0$，反转电位 $E_{\\mathrm{rev}}$ 必须位于区间 $[E_{\\mathrm{Na}}, E_{\\mathrm{Ca}}]$ 内。这为诸如 Brent-Dekker 方法（在 SciPy 中为 `brentq`）等求根算法提供了一个可靠的区间。\n\n算法流程如下：\n1. 定义待解函数 $f(V_m, r)$。\n2. 对于测试套件 $\\{0, 0.01, 0.1, 1, 10, 1000\\}$ 中的每个给定值 $r$：\n   a. 处理 $r=0$ 的特殊情况，此时 $E_{\\mathrm{rev}} = E_{\\mathrm{Na}}$。\n   b. 对于 $r > 0$，使用 `brentq` 并在区间 $[E_{\\mathrm{Na}}, E_{\\mathrm{Ca}}]$（单位为伏特）内寻找根 $V_m = E_{\\mathrm{rev}}$。\n3. 将得到的电位从伏特转换为毫伏，四舍五入到三位小数，并收集结果。\n\n此程序将按要求得出正确的反转电位。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the reversal potential for a membrane permeable to Na+ and Ca2+ ions\n    using the Goldman-Hodgkin-Katz (GHK) formalism.\n    The reversal potential is found numerically by solving I_total(V_m) = 0.\n    \"\"\"\n    # Physical Constants\n    R = 8.314462618  # Gas constant in J / (mol * K)\n    T = 310.0         # Absolute temperature in Kelvin\n    F = 96485.33212   # Faraday const in Coulombs / mol\n\n    # Ionic Concentrations in mM\n    conc_Na_o = 140.0 # Extracellular Sodium\n    conc_Na_i = 12.0  # Intracellular Sodium\n    conc_Ca_o = 2.0   # Extracellular Calcium\n    conc_Ca_i = 100.0e-6 # Intracellular Calcium (100 nM = 0.0001 mM)\n\n    # Ionic Valences\n    z_Na = 1.0\n    z_Ca = 2.0\n\n    # Test suite for permeability ratio r = P_Ca / P_Na\n    r_values = [0.0, 0.01, 0.1, 1.0, 10.0, 1000.0]\n\n    # Pre-calculate the thermal voltage term in Volts\n    RT_F = R * T / F\n\n    def get_reversal_potential(r: float, bracket: tuple) -> float:\n        \"\"\"\n        Calculates the reversal potential for a given permeability ratio r.\n        \n        Args:\n            r: The permeability ratio P_Ca / P_Na.\n            bracket: A tuple (a, b) providing an interval to search for the root.\n\n        Returns:\n            The reversal potential in Volts.\n        \"\"\"\n        \n        # The function to find the root of. This represents the sum of GHK fluxes.\n        # It is derived from the zero total current condition: I_Na + I_Ca = 0,\n        # after dividing out common non-zero terms.\n        def total_flux(V_m: float) -> float:\n            # Handle the singularity at V_m=0, though brentq is unlikely to evaluate\n            # exactly at zero if it's not the root.\n            if abs(V_m) < 1e-12:\n                # Based on the quadratic simplification, if V_m=0 (y=1), the LHS is\n                # (Na_o + 4r*Ca_o) + (Na_o - Na_i) - (Na_i + 4r*Ca_i)\n                # which is 2*(Na_o - Na_i) + 4r*(Ca_o - Ca_i), not generally zero.\n                # So V_m=0 is not a root, and we don't need special handling.\n                pass\n\n            term_Na = (conc_Na_i - conc_Na_o * np.exp(-z_Na * V_m / RT_F)) / \\\n                      (1 - np.exp(-z_Na * V_m / RT_F))\n            \n            term_Ca = 4 * r * (conc_Ca_i - conc_Ca_o * np.exp(-z_Ca * V_m / RT_F)) / \\\n                      (1 - np.exp(-z_Ca * V_m / RT_F))\n            \n            return term_Na + term_Ca\n\n        # The Brent-Dekker method is a robust root-finding algorithm.\n        E_rev_V = brentq(total_flux, bracket[0], bracket[1], xtol=1e-15, rtol=1e-15)\n        return E_rev_V\n\n    # Calculate Nernst potentials to define the search bracket for the root-finder.\n    # The reversal potential must lie between these two values.\n    E_Na_V = (RT_F / z_Na) * np.log(conc_Na_o / conc_Na_i)\n    E_Ca_V = (RT_F / z_Ca) * np.log(conc_Ca_o / conc_Ca_i)\n\n    # Ensure the bracket is ordered correctly for brentq, adding a small margin for safety.\n    search_bracket = (min(E_Na_V, E_Ca_V) - 0.01, max(E_Na_V, E_Ca_V) + 0.01)\n    \n    results = []\n    for r in r_values:\n        if r == 0.0:\n            # If the membrane is only permeable to Sodium, the reversal potential\n            # is the Nernst potential for Sodium.\n            E_rev_V = E_Na_V\n        else:\n            E_rev_V = get_reversal_potential(r, search_bracket)\n\n        # Convert result from Volts to Millivolts and round to 3 decimal places.\n        E_rev_mV = E_rev_V * 1000\n        results.append(round(E_rev_mV, 3))\n\n    # Print the final result in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "GHK模型的核心简化在于其“恒定场”假设，即假定电场在整个膜上是均匀的。这个高级练习将引导你突破这一限制，对一个空间变化的电场下的电扩散过程进行建模。通过为一个非恒定场推导离子通量并实现数值求解，你将理解如何将基础的能斯特-普朗克框架应用于更真实、更复杂的场景。",
            "id": "3937160",
            "problem": "考虑一个厚度为 $L$ 的一维膜片，它分隔了位于 $x=0$（胞外）和 $x=L$（胞内）的两个充分搅拌的浴液。存在三种离子，其化合价 $z_i \\in \\{+1,+1,-1\\}$ 分别对应钾离子（$\\mathrm{K}^+$）、钠离子（$\\mathrm{Na}^+$）和氯离子（$\\mathrm{Cl}^-$）。在等温条件下，离子种类 $i$ 穿过膜片的稳态电扩散通量 $\\mathcal{J}_i$ 遵循 Nernst–Planck 关系式，其中电场 $E(x)$ 是空间变化的。浴液的浓度 $C_i(0)$ 和 $C_i(L)$ 保持固定，并且膜对不同离子种类具有特定的、在空间上均匀的扩散系数 $D_i$。设 $V(x)$ 表示电势，跨膜电势差 $\\Delta V = V(L) - V(0)$ 假定为未知。电场 $E(x)$ 通过 $E(x) = \\frac{dV}{dx}$ 与电势相关，并通过以下剖面被建模为对恒定电场假设的一种偏离：\n$$\nE(x) = \\frac{\\Delta V}{L} \\left[1 + \\beta \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right],\n$$\n其中 $\\beta$ 是一个控制偏差幅度的无量纲参数。未知的 $\\Delta V$ 必须通过在稳态下强制执行零净电流条件，从第一性原理出发来确定。在整个过程中，使用法拉第常数 $F$、普适气体常数 $R$ 和温度 $T$。在首次使用时，应定义 Goldman–Hodgkin–Katz (GHK) 电压方程这一缩写，但不要假设或使用其闭合形式的结果；相反，应从 Nernst–Planck 框架中推导出必要的关系。\n\n仅从 Nernst–Planck 通量定律和给定的电场剖面出发，构建边值电扩散问题，推导一个对给定非恒定电场有效的、可计算实现的跨膜通量 $\\mathcal{J}_i$ 表达式，并设计一个算法来找到产生零净电流的唯一 $\\Delta V$。以伏特为单位表示 $\\Delta V$ 的最终结果。\n\n您的程序必须为以下每个测试用例计算 $\\Delta V$，并生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。每个结果必须四舍五入到六位小数，并以伏特表示。\n\n所有用例的常量：\n- 厚度 $L = 5 \\times 10^{-9}\\ \\text{m}$。\n- 温度 $T = 310\\ \\text{K}$。\n- 法拉第常数 $F = 96485\\ \\text{C}\\cdot\\text{mol}^{-1}$。\n- 普适气体常数 $R = 8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$。\n- 化合价 $\\mathbf{z} = [1, 1, -1]$，对应 $[\\mathrm{K}^+, \\mathrm{Na}^+, \\mathrm{Cl}^-]$。\n- 离子种类顺序为 $[\\mathrm{K}^+, \\mathrm{Na}^+, \\mathrm{Cl}^-]$。\n- 浓度单位为 $\\text{mol}\\cdot\\text{m}^{-3}$；请注意 $1\\ \\text{mM} = 1\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n\n测试套件：\n1. 基线恒定电场情况：\n   - 扩散系数 $\\mathbf{D} = [1.0 \\times 10^{-10},\\ 4.0 \\times 10^{-12},\\ 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$。\n   - $x=0$ 处的胞外浓度：$\\mathbf{C}(0) = [5,\\ 145,\\ 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n   - $x=L$ 处的胞内浓度：$\\mathbf{C}(L) = [140,\\ 12,\\ 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n   - 偏离参数 $\\beta = 0$。\n\n2. 与恒定电场的中度偏离：\n   - 与用例1相同的 $\\mathbf{D}$ 和浓度。\n   - $\\beta = 0.6$。\n\n3. 被抑制的氯离子迁移率：\n   - 扩散系数 $\\mathbf{D} = [1.0 \\times 10^{-10},\\ 4.0 \\times 10^{-12},\\ 0.0]\\ \\text{m}^2\\cdot\\text{s}^{-1}$。\n   - 胞外浓度 $\\mathbf{C}(0) = [5,\\ 145,\\ 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n   - 胞内浓度 $\\mathbf{C}(L) = [140,\\ 12,\\ 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n   - $\\beta = 0.3$。\n\n4. 对称浴液（预期电势接近于零）：\n   - 扩散系数 $\\mathbf{D} = [1.0 \\times 10^{-10},\\ 4.0 \\times 10^{-12},\\ 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$。\n   - 胞外浓度 $\\mathbf{C}(0) = [100,\\ 100,\\ 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n   - 胞内浓度 $\\mathbf{C}(L) = [100,\\ 100,\\ 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$。\n   - $\\beta = 0.5$。\n\n要求：\n- 从第一性原理推导电扩散关系；不要调用 Goldman–Hodgkin–Katz (GHK) 电压方程的任何预先推导出的形式。\n- 强制执行零净电流条件 $\\sum_i z_i \\mathcal{J}_i = 0$ 来确定 $\\Delta V$。\n- 您的算法对于上述情况必须是数值稳定的，并且除非 $\\beta = 0$，否则不得假设为恒定电场。\n- 最终输出：包含 $[\\Delta V_1,\\Delta V_2,\\Delta V_3,\\Delta V_4]$ 的单行文本，其中每个 $\\Delta V_k$ 以伏特为单位，并四舍五入到六位小数。",
            "solution": "用户需要一个广义电扩散问题的解决方案。我将首先验证问题陈述。\n\n### 第1步：提取已知条件\n- **系统几何**：一维膜片，厚度 $L = 5 \\times 10^{-9}\\ \\text{m}$。$x=0$ 处为胞外浴液，$x=L$ 处为胞内浴液。\n- **离子种类**：三种，钾离子（$\\mathrm{K}^+$）、钠离子（$\\mathrm{Na}^+$）和氯离子（$\\mathrm{Cl}^-$）。\n- **化合价**：$\\mathbf{z} = [z_{\\mathrm{K}^+}, z_{\\mathrm{Na}^+}, z_{\\mathrm{Cl}^-}] = [+1, +1, -1]$。\n- **基本定律**：稳态电扩散通量 $\\mathcal{J}_i$ 由 Nernst–Planck 关系式决定：$\\mathcal{J}_i = -D_i \\left( \\frac{dC_i}{dx} + \\frac{z_i F}{RT} C_i E(x) \\right)$。\n- **电场模型**：$E(x) = \\frac{\\Delta V}{L} \\left[1 + \\beta \\sin\\left(\\frac{2\\pi x}{L}\\right)\\right]$，其中 $\\Delta V = V(L) - V(0)$ 是未知的跨膜电势。\n- **零净电流条件**：系统处于稳态，净电流为零，即 $\\sum_i z_i \\mathcal{J}_i = 0$。\n- **常量**：\n    - $L = 5 \\times 10^{-9}\\ \\text{m}$\n    - $T = 310\\ \\text{K}$\n    - $F = 96485\\ \\text{C}\\cdot\\text{mol}^{-1}$\n    - $R = 8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$\n- **测试用例**：\n    1.  $\\mathbf{D} = [1.0 \\times 10^{-10}, 4.0 \\times 10^{-12}, 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$，$\\mathbf{C}(0) = [5, 145, 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$，$\\mathbf{C}(L) = [140, 12, 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$，$\\beta = 0$。\n    2.  与用例1相同，但 $\\beta = 0.6$。\n    3.  $\\mathbf{D} = [1.0 \\times 10^{-10}, 4.0 \\times 10^{-12}, 0.0]\\ \\text{m}^2\\cdot\\text{s}^{-1}$，$\\mathbf{C}(0) = [5, 145, 110]\\ \\text{mol}\\cdot\\text{m}^{-3}$，$\\mathbf{C}(L) = [140, 12, 4]\\ \\text{mol}\\cdot\\text{m}^{-3}$，$\\beta = 0.3$。\n    4.  $\\mathbf{D} = [1.0 \\times 10^{-10}, 4.0 \\times 10^{-12}, 4.5 \\times 10^{-11}]\\ \\text{m}^2\\cdot\\text{s}^{-1}$，$\\mathbf{C}(0) = [100, 100, 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$，$\\mathbf{C}(L) = [100, 100, 100]\\ \\text{mol}\\cdot\\text{m}^{-3}$，$\\beta = 0.5$。\n- **任务**：推导 $\\mathcal{J}_i$ 的表达式，设计一个算法来找到满足零净电流条件的 $\\Delta V$，并为给定的测试用例计算 $\\Delta V$。不假设 Goldman-Hodgkin-Katz (GHK) 电压方程。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于 Nernst-Planck 方程，这是一个用于电扩散的基础且成熟的模型。所提出的电场是标准 Goldman-Hodgkin-Katz (GHK) 电压方程中使用的恒定电场假设的数学推广。该模型与静电学原理一致，因为 $\\int_0^L E(x) dx = \\Delta V$。参数具有生理现实性。该问题在科学上是合理的。\n- **适定性**：该问题指定了所有必要的物理参数、浓度的边界条件，以及一个约束（零净电流）来确定唯一的未知数 $\\Delta V$。总电流与 $\\Delta V$ 的关系函数预期是单调的，这确保了唯一解的存在。该问题是适定的。\n- **客观性**：该问题使用精确、客观和形式化的数学语言陈述。它不包含主观性论断。\n\n### 第3步：结论与行动\n该问题有效。将制定一个基于第一性原理的解决方案。\n\n### 求解推导与算法设计\n起点是一维稳态 Nernst-Planck 离子种类 $i$ 的通量方程：\n$$\n\\mathcal{J}_i = -D_i \\left( \\frac{dC_i(x)}{dx} + \\frac{z_i F}{RT} C_i(x) E(x) \\right)\n$$\n在稳态下，对于所有 $x \\in [0, L]$，通量 $\\mathcal{J}_i$ 必须是常数。该方程可以重排为一个关于浓度剖面 $C_i(x)$ 的一阶线性常微分方程：\n$$\n\\frac{dC_i(x)}{dx} + \\left( \\frac{z_i F}{RT} E(x) \\right) C_i(x) = -\\frac{\\mathcal{J}_i}{D_i}\n$$\n这个方程可以用积分因子 $\\mu(x)$ 求解。设电势为 $V(x)$，使得 $E(x) = -\\frac{dV}{dx}$。然而，问题定义为 $E(x) = \\frac{dV}{dx}$，这意味着通量是沿着电势梯度下降的方向驱动的。我们将遵循问题的定义。通过对电场积分来找到电势，假设 $V(0)=0$：\n$$\nV(x) = \\int_0^x E(s) ds = \\int_0^x \\frac{\\Delta V}{L} \\left[1 + \\beta \\sin\\left(\\frac{2\\pi s}{L}\\right)\\right] ds\n$$\n$$\nV(x) = \\frac{\\Delta V}{L} \\left[s - \\frac{\\beta L}{2\\pi} \\cos\\left(\\frac{2\\pi s}{L}\\right)\\right]_0^x = \\frac{\\Delta V}{L} \\left(x - \\frac{\\beta L}{2\\pi}\\cos\\left(\\frac{2\\pi x}{L}\\right) + \\frac{\\beta L}{2\\pi}\\right)\n$$\n注意 $V(L) = \\frac{\\Delta V}{L} (L - \\frac{\\beta L}{2\\pi} + \\frac{\\beta L}{2\\pi}) = \\Delta V$，这是一致的。\n\n让我们定义一个无量纲势能项 $\\phi_i(x) = \\frac{z_i F}{RT} V(x)$。积分因子是 $\\mu(x) = e^{\\phi_i(x)}$。用 $\\mu(x)$ 乘以常微分方程得到：\n$$\ne^{\\phi_i(x)} \\frac{dC_i(x)}{dx} + e^{\\phi_i(x)} \\left( \\frac{z_i F}{RT} E(x) \\right) C_i(x) = \\frac{d}{dx} \\left( C_i(x) e^{\\phi_i(x)} \\right) = -\\frac{\\mathcal{J}_i}{D_i} e^{\\phi_i(x)}\n$$\n我们将此表达式从 $x=0$ 到 $x=L$ 在膜的两侧进行积分：\n$$\n\\int_0^L \\frac{d}{dx} \\left( C_i(x) e^{\\phi_i(x)} \\right) dx = \\left[ C_i(x) e^{\\phi_i(x)} \\right]_0^L = -\\frac{\\mathcal{J}_i}{D_i} \\int_0^L e^{\\phi_i(x)} dx\n$$\n应用边界值 $C_i(0)$、$C_i(L)$，并注意到 $\\phi_i(0)=0$ 和 $\\phi_i(L) = \\frac{z_i F \\Delta V}{RT}$，我们得到：\n$$\nC_i(L) e^{\\frac{z_i F \\Delta V}{RT}} - C_i(0) e^0 = -\\frac{\\mathcal{J}_i}{D_i} \\int_0^L e^{\\phi_i(x)} dx\n$$\n现在，我们可以分离出通量 $\\mathcal{J}_i$：\n$$\n\\mathcal{J}_i = D_i \\frac{C_i(0) - C_i(L) e^{\\frac{z_i F \\Delta V}{RT}}}{\\int_0^L \\exp\\left(\\frac{z_i F V(x)}{RT}\\right) dx}\n$$\n这是给定电势剖面 $V(x)$ 下离子种类 $i$ 通量的通用表达式。让我们引入无量纲跨膜电势 $u = \\frac{F \\Delta V}{RT}$。$\\mathcal{J}_i$ 的表达式变为：\n$$\n\\mathcal{J}_i(\\Delta V) = D_i \\frac{C_i(0) - C_i(L) e^{z_i u}}{\\int_0^L \\exp\\left(z_i u \\left[ \\frac{x}{L} - \\frac{\\beta}{2\\pi}\\left(\\cos\\left(\\frac{2\\pi x}{L}\\right)-1\\right) \\right]\\right) dx}\n$$\n未知的膜电势 $\\Delta V$ 由零净电流条件确定：\n$$\nI_{net}(\\Delta V) = \\sum_i z_i F \\mathcal{J}_i(\\Delta V) = 0 \\implies \\sum_i z_i \\mathcal{J}_i(\\Delta V) = 0\n$$\n我们必须找到函数 $f(\\Delta V) = \\sum_i z_i \\mathcal{J}_i(\\Delta V)$ 的根 $\\Delta V$。\n\n**特殊情况：恒定电场（$\\beta = 0$）**\n当 $\\beta=0$ 时，电势是线性的：$V(x) = \\Delta V \\frac{x}{L}$。分母中的积分可以解析求解：\n$$\n\\int_0^L e^{\\frac{z_i F \\Delta V}{RT} \\frac{x}{L}} dx = \\int_0^L e^{z_i u \\frac{x}{L}} dx = \\frac{L}{z_i u} \\left[ e^{z_i u \\frac{x}{L}} \\right]_0^L = \\frac{L}{z_i u} (e^{z_i u} - 1)\n$$\n将此代入通量表达式得到 Goldman–Hodgkin–Katz (GHK) 通量方程：\n$$\n\\mathcal{J}_i = D_i \\frac{C_i(0) - C_i(L)e^{z_i u}}{\\frac{L}{z_i u}(e^{z_i u} - 1)} = \\frac{D_i z_i u}{L} \\frac{C_i(0) - C_i(L)e^{z_i u}}{e^{z_i u} - 1}\n$$\n当 $u \\to 0$ 时，根据洛必达法则可得 $\\mathcal{J}_i \\to \\frac{D_i}{L}(C_i(0) - C_i(L))$，这即是菲克扩散定律。\n\n**一般情况（$\\beta \\neq 0$）**\n对于非零的 $\\beta$，分母中的积分必须进行数值计算。\n\n**算法**\n问题简化为找到非线性函数 $f(\\Delta V) = \\sum_i z_i \\mathcal{J}_i(\\Delta V)$ 的根。\n1.  定义一个函数 `total_current(delta_V)` 来计算 $f(\\Delta V)$。\n2.  在此函数内部，计算无量纲电势 $u = \\frac{F \\Delta V}{RT}$。\n3.  对于每种离子 $i$：\n    a. 如果 $\\beta=0$，使用解析的 GHK 通量方程计算 $\\mathcal{J}_i$。应使用数值稳定的形式，尤其是在 $u \\approx 0$ 时。\n    b. 如果 $\\beta \\neq 0$，首先使用数值求积方法（例如 `scipy.integrate.quad`）计算分母积分，从而计算 $\\mathcal{J}_i$。为了在大的 $|u|$ 值下保持数值稳定性，可以重新整理通量表达式。对于 $z_i u > 0$，我们可以使用 $\\mathcal{J}_i = D_i \\frac{C_i(0)e^{-z_i u} - C_i(L)}{\\int_0^L \\exp(\\phi_i(x) - z_i u) dx}$ 来防止溢出。对于 $z_i u \\le 0$，原始形式是稳定的。\n    c. 计算电流贡献 $I_i = z_i \\mathcal{J}_i$。\n4.  该函数返回总和 $\\sum_i I_i$。\n5.  使用数值求根算法，如 `scipy.optimize.brentq`，找到使 `total_current(delta_V)` 为零的 $\\Delta V$。一个像 $[-0.2, 0.2]$ 伏特的包围区间是合适的，因为典型的静息电势落在此范围内。\n6.  对问题陈述中提供的每个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the transmembrane potential DeltaV under steady-state electrodiffusion\n    for several test cases with a generalized, non-constant electric field.\n    \"\"\"\n    \n    # Define physical constants\n    R = 8.314  # Universal gas constant in J/(mol*K)\n    F = 96485   # Faraday's constant in C/mol\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.0,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 4.5e-11]),\n            \"C_out\": np.array([5, 145, 110]),\n            \"C_in\": np.array([140, 12, 4])\n        },\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.6,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 4.5e-11]),\n            \"C_out\": np.array([5, 145, 110]),\n            \"C_in\": np.array([140, 12, 4])\n        },\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.3,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 0.0]),\n            \"C_out\": np.array([5, 145, 110]),\n            \"C_in\": np.array([140, 12, 4])\n        },\n        {\n            \"L\": 5e-9, \"T\": 310, \"beta\": 0.5,\n            \"z\": np.array([1, 1, -1]),\n            \"D\": np.array([1.0e-10, 4.0e-12, 4.5e-11]),\n            \"C_out\": np.array([100, 100, 100]),\n            \"C_in\": np.array([100, 100, 100])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, T, beta = case[\"L\"], case[\"T\"], case[\"beta\"]\n        z_vec, D_vec = case[\"z\"], case[\"D\"]\n        C_out_vec, C_in_vec = case[\"C_out\"], case[\"C_in\"]\n        \n        RT_over_F = R * T / F\n\n        def total_current(delta_V):\n            \"\"\"\n            Calculates the total ionic current across the membrane for a given DeltaV.\n            The root of this function is the resting potential.\n            \"\"\"\n            u = delta_V / RT_over_F\n            net_current = 0.0\n\n            for i in range(len(z_vec)):\n                z_i, D_i, C_out, C_in = z_vec[i], D_vec[i], C_out_vec[i], C_in_vec[i]\n                \n                if D_i == 0.0:\n                    continue  # This species is impermeable, its flux is zero.\n                \n                val = z_i * u\n                flux = 0.0\n                \n                # Special case for beta=0 (constant field), use GHK flux equation\n                if beta == 0:\n                    if abs(val) < 1e-9:\n                        # Use L'Hopital's rule for val -> 0 (Fick's Law limit)\n                        flux = (D_i / L) * (C_out - C_in)\n                    else:\n                        # Numerically stable form of GHK flux equation\n                        flux = (D_i / L) * val * (C_out - C_in * np.exp(val)) / (np.expm1(val))\n                \n                # General case for beta != 0, requires numerical integration\n                else:\n                    def potential_exponent(x, z, u_val, b, l_val):\n                        term1 = x / l_val\n                        term2 = (b / (2.0 * np.pi)) * (np.cos(2.0 * np.pi * x / l_val) - 1.0)\n                        return z * u_val * (term1 - term2)\n\n                    if val > 0:\n                        # Numerically stable form for large positive val to avoid overflow\n                        # We divide numerator and denominator by exp(val), moving it into the integral argument\n                        def stable_integrand(x):\n                             exp_arg = potential_exponent(x, z_i, u, beta, L) - val\n                             return np.exp(exp_arg)\n                        integral_val, _ = quad(stable_integrand, 0, L)\n                        flux = D_i * (C_out * np.exp(-val) - C_in) / integral_val\n                    else: # val <= 0\n                        # Original form is stable for non-positive val\n                        def integrand(x):\n                            return np.exp(potential_exponent(x, z_i, u, beta, L))\n                        integral_val, _ = quad(integrand, 0, L)\n                        if integral_val == 0:\n                            # This should not happen with finite val, but for safety\n                            flux = np.inf if (C_out - C_in * np.exp(val)) != 0 else 0\n                        else:\n                            flux = D_i * (C_out - C_in * np.exp(val)) / integral_val\n                \n                net_current += z_i * flux\n                \n            return net_current\n\n        # Find the root of the total_current function within a plausible physiological range.\n        # The function is monotonic, so a bracketing root-finder is robust.\n        try:\n            delta_V_solution = brentq(total_current, -0.2, 0.2, xtol=1e-12, rtol=1e-12)\n        except ValueError:\n            # This can occur if total_current(-0.2) and total_current(0.2) have the same sign.\n            # For this problem, this may happen if the root is exactly 0.\n            if abs(total_current(0.0)) < 1e-9:\n                delta_V_solution = 0.0\n            else:\n                # If the bracket is wrong, expand it and try again.\n                delta_V_solution = brentq(total_current, -1.0, 1.0, xtol=1e-12, rtol=1e-12)\n        \n        results.append(f\"{delta_V_solution:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}