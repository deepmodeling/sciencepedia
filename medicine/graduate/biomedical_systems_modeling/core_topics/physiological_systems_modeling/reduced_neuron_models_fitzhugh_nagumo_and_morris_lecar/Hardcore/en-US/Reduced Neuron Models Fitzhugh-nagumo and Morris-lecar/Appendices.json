{
    "hands_on_practices": [
        {
            "introduction": "To understand the dynamics of a complex model like the FitzHugh-Nagumo neuron, a powerful first step is to analyze its behavior near equilibrium points. This process of local linearization is captured by the Jacobian matrix, which reveals how small perturbations evolve. In this exercise , you will derive this crucial matrix and interpret its entries to see how concepts like positive feedback and time-scale separation are encoded in the model's mathematical structure.",
            "id": "3924729",
            "problem": "Consider the nondimensional FitzHugh–Nagumo (FHN) model for a reduced neuron, with state variables membrane potential proxy $v$ and recovery variable $w$, driven by a constant input current $I$:\n$$\n\\frac{dv}{dt} \\;=\\; v \\;-\\;\\frac{v^{3}}{3} \\;-\\; w \\;+\\; I,\\qquad\n\\frac{dw}{dt} \\;=\\; \\varepsilon\\left(v \\;+\\; a \\;-\\; b\\,w\\right),\n$$\nwhere $\\varepsilon0$ sets the time-scale separation between the fast voltage subsystem and the slow recovery subsystem, and $a0$, $b0$ are parameters. Starting from the definition of the Jacobian of a vector field as the matrix of first partial derivatives of its right-hand side with respect to the state variables, do the following:\n\n(1) Derive the Jacobian matrix $J(v,w)$ of the FHN vector field at an arbitrary point $(v,w)$.\n\n(2) Explain how each entry of $J(v,w)$ encodes a local gain from one state to the instantaneous rate of change of the other, and how the smallness of $\\varepsilon$ relative to $1$ reflects time-scale separation in the local linearization.\n\n(3) Impose the parameter relation $I = a/b$ and verify that $(v^{\\ast},w^{\\ast}) = (0,\\,I)$ is an equilibrium of the system. Then evaluate the determinant of the Jacobian, $\\det J(v^{\\ast},w^{\\ast})$, at this equilibrium. \n\nProvide your final answer as a single closed-form analytic expression in terms of $\\varepsilon$ and $b$. No units are required for the final answer. If you choose to substitute numerical values, express your final number exactly; rounding is not required.",
            "solution": "The problem asks for the analysis of the FitzHugh-Nagumo (FHN) model, a system of two coupled ordinary differential equations. The analysis involves deriving the Jacobian matrix, interpreting its elements, and evaluating its determinant at a specific equilibrium point.\n\nThe state of the system is described by the vector $\\mathbf{x}(t) = \\begin{pmatrix} v(t) \\\\ w(t) \\end{pmatrix}$, where $v$ is the membrane potential proxy and $w$ is the recovery variable. The dynamics are governed by the vector field $\\mathbf{F}(v,w)$:\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x}) = \\begin{pmatrix} f(v,w) \\\\ g(v,w) \\end{pmatrix} = \\begin{pmatrix} v - \\frac{v^{3}}{3} - w + I \\\\ \\varepsilon(v + a - bw) \\end{pmatrix}\n$$\nThe parameters $\\varepsilon$, $a$, and $b$ are all positive constants.\n\n(1) Derivation of the Jacobian matrix $J(v,w)$.\n\nThe Jacobian matrix of the vector field $\\mathbf{F}$ is the matrix of all its first-order partial derivatives with respect to the state variables $v$ and $w$. By definition:\n$$\nJ(v,w) = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}} = \\begin{pmatrix} \\frac{\\partial f}{\\partial v}  \\frac{\\partial f}{\\partial w} \\\\ \\frac{\\partial g}{\\partial v}  \\frac{\\partial g}{\\partial w} \\end{pmatrix}\n$$\nWe compute each partial derivative from the given functions $f(v,w)$ and $g(v,w)$:\n- The partial derivative of $f(v,w) = v - \\frac{v^{3}}{3} - w + I$ with respect to $v$ is:\n$$\n\\frac{\\partial f}{\\partial v} = \\frac{\\partial}{\\partial v}\\left(v - \\frac{v^{3}}{3} - w + I\\right) = 1 - v^{2}\n$$\n- The partial derivative of $f(v,w)$ with respect to $w$ is:\n$$\n\\frac{\\partial f}{\\partial w} = \\frac{\\partial}{\\partial w}\\left(v - \\frac{v^{3}}{3} - w + I\\right) = -1\n$$\n- The partial derivative of $g(v,w) = \\varepsilon(v + a - bw)$ with respect to $v$ is:\n$$\n\\frac{\\partial g}{\\partial v} = \\frac{\\partial}{\\partial v}\\left(\\varepsilon v + \\varepsilon a - \\varepsilon bw\\right) = \\varepsilon\n$$\n- The partial derivative of $g(v,w)$ with respect to $w$ is:\n$$\n\\frac{\\partial g}{\\partial w} = \\frac{\\partial}{\\partial w}\\left(\\varepsilon v + \\varepsilon a - \\varepsilon bw\\right) = -\\varepsilon b\n$$\nAssembling these components, the Jacobian matrix of the FHN system at an arbitrary point $(v,w)$ is:\n$$\nJ(v,w) = \\begin{pmatrix} 1 - v^{2}  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix}\n$$\n\n(2) Interpretation of the Jacobian matrix and the time-scale separation parameter $\\varepsilon$.\n\nThe Jacobian matrix $J(v_0, w_0)$ at a point $(v_0, w_0)$ represents the best linear approximation of the nonlinear dynamics in the vicinity of that point. A small perturbation $(\\delta v, \\delta w)$ from $(v_0, w_0)$ evolves according to the linear system $\\frac{d}{dt}\\begin{pmatrix} \\delta v \\\\ \\delta w \\end{pmatrix} \\approx J(v_0, w_0) \\begin{pmatrix} \\delta v \\\\ \\delta w \\end{pmatrix}$. Each entry $J_{ij}$ of the Jacobian matrix represents the local \"gain\" or linear sensitivity of the rate of change of the $i$-th state variable to a small change in the $j$-th state variable.\n\n- $J_{11} = 1 - v^{2}$: This term describes the local effect of the potential $v$ on its own rate of change, $\\frac{dv}{dt}$. When $|v|  1$, $J_{11}  0$, indicating local self-excitation (positive feedback). When $|v|  1$, $J_{11}  0$, indicating local self-inhibition (negative feedback). This cubic nonlinearity is the source of the model's excitability.\n- $J_{12} = -1$: This term is the gain from the recovery variable $w$ to the rate of change of potential, $\\frac{dv}{dt}$. Its constant negative value signifies that $w$ always acts to decrease $v$, justifying its role as a \"recovery\" or \"inhibitory\" variable.\n- $J_{21} = \\varepsilon$: This term is the gain from the potential $v$ to the rate of change of the recovery variable, $\\frac{dw}{dt}$. Its positive value indicates that an increase in $v$ tends to increase $w$, representing an excitatory coupling from $v$ to $w$.\n- $J_{22} = -\\varepsilon b$: This term describes the local effect of $w$ on its own rate of change, $\\frac{dw}{dt}$. Since $\\varepsilon  0$ and $b  0$, this term is always negative, representing a self-inhibition or decay process for the recovery variable.\n\nThe parameter $\\varepsilon$ sets the time-scale for the dynamics of $w$. The problem states $\\varepsilon  0$ and notes it governs time-scale separation, which typically implies $\\varepsilon \\ll 1$. The entries of the Jacobian that determine the dynamics of $w$, namely $J_{21} = \\varepsilon$ and $J_{22} = -\\varepsilon b$, are both proportional to $\\varepsilon$. In the linearized system, this means that the rate of change of a perturbation $\\delta w$ is much smaller than the rate of change of a perturbation $\\delta v$. Specifically, $\\frac{d(\\delta w)}{dt} = \\varepsilon(\\delta v - b\\delta w)$, whereas $\\frac{d(\\delta v)}{dt} = (1 - v^2)\\delta v - \\delta w$. For $\\varepsilon \\ll 1$, the response of $w$ is much slower than the response of $v$, which is the essence of time-scale separation in the local dynamics.\n\n(3) Equilibrium analysis and determinant calculation.\n\nAn equilibrium point $(v^{\\ast}, w^{\\ast})$ is a point where the vector field is zero, i.e., $\\frac{dv}{dt} = 0$ and $\\frac{dw}{dt} = 0$.\n$$\nv^{\\ast} - \\frac{(v^{\\ast})^{3}}{3} - w^{\\ast} + I = 0\n$$\n$$\n\\varepsilon(v^{\\ast} + a - bw^{\\ast}) = 0\n$$\nThe problem asks to impose the parameter relation $I = a/b$ and verify that $(v^{\\ast}, w^{\\ast}) = (0, I)$ is an equilibrium. We substitute $v^{\\ast}=0$ and $w^{\\ast}=I$ into the two equilibrium equations.\n- For the first equation:\n$$\n(0) - \\frac{(0)^{3}}{3} - (I) + I = 0 - 0 - I + I = 0\n$$\nThis equation is satisfied.\n- For the second equation, since $\\varepsilon  0$, we need to check if $v^{\\ast} + a - bw^{\\ast} = 0$:\n$$\n(0) + a - b(I) = a - bI = 0\n$$\nThis equation is satisfied if and only if $a = bI$, or $I = a/b$. Since this is the imposed condition, the point $(v^{\\ast}, w^{\\ast}) = (0, I)$ is indeed an equilibrium of the system under this condition.\n\nNext, we evaluate the Jacobian at this equilibrium point $(v^{\\ast}, w^{\\ast}) = (0, I)$. We substitute $v=0$ and $w=I$ into the general expression for $J(v,w)$:\n$$\nJ(v^{\\ast}, w^{\\ast}) = J(0, I) = \\begin{pmatrix} 1 - (0)^{2}  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix} = \\begin{pmatrix} 1  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix}\n$$\nFinally, we compute the determinant of this matrix:\n$$\n\\det J(v^{\\ast}, w^{\\ast}) = \\det \\begin{pmatrix} 1  -1 \\\\ \\varepsilon  -\\varepsilon b \\end{pmatrix} = (1)(-\\varepsilon b) - (-1)(\\varepsilon)\n$$\n$$\n\\det J(v^{\\ast}, w^{\\ast}) = -\\varepsilon b + \\varepsilon = \\varepsilon(1-b)\n$$\nThe determinant of the Jacobian at the equilibrium point $(0, I)$ with the condition $I=a/b$ is $\\varepsilon(1-b)$. This expression is in terms of the required parameters $\\varepsilon$ and $b$.",
            "answer": "$$\\boxed{\\varepsilon(1-b)}$$"
        },
        {
            "introduction": "A neuron's transition from quiescence to repetitive spiking is not gradual; it is a dramatic shift in dynamics governed by a bifurcation. This exercise  delves into the saddle-node bifurcation, a common mechanism for the onset of firing in so-called Type I neurons. By analyzing the geometry of the model's nullclines, you will pinpoint the exact input current at which this critical transition occurs, gaining a deeper understanding of neuronal threshold phenomena.",
            "id": "3924768",
            "problem": "Consider the FitzHugh-Nagumo (FHN) reduced neuron model given by the coupled ordinary differential equations\n$$\n\\frac{dv}{dt} = v - \\frac{v^{3}}{3} - w + I, \\qquad \\frac{dw}{dt} = \\epsilon \\left(v + a - b w\\right),\n$$\nwhere $v$ is the membrane potential, $w$ is the recovery variable, $I$ is a dimensionless constant input current, and $\\epsilon$, $a$, and $b$ are fixed parameters with $\\epsilon  0$. At equilibrium, the nullclines satisfy\n$$\nw = v - \\frac{v^{3}}{3} + I, \\qquad w = \\frac{v + a}{b}.\n$$\nA saddle-node bifurcation of equilibria occurs when these nullclines are tangent to each other in the $(v,w)$ plane. Starting from the definitions of nullclines and the geometric condition for tangency, determine the positive value of the dimensionless input current $I$ at which the saddle-node bifurcation occurs for the parameter values $a = 0.3$ and $b = 2$. Then verify your result by showing that, at this same value of $I$, the discriminant of the cubic equilibrium equation in $v$ is zero. Round your final numerical answer to four significant figures. The current $I$ is dimensionless; do not include units.",
            "solution": "The user wants to find the positive value of the input current $I$ for which a saddle-node bifurcation occurs in the FitzHugh-Nagumo model and to verify this result.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- FitzHugh-Nagumo model equations:\n  $$ \\frac{dv}{dt} = v - \\frac{v^{3}}{3} - w + I $$\n  $$ \\frac{dw}{dt} = \\epsilon \\left(v + a - b w\\right) $$\n- Parameters: $\\epsilon  0$, $a = 0.3$, $b = 2$.\n- Nullcline equations at equilibrium:\n  1. $v$-nullcline: $w = v - \\frac{v^{3}}{3} + I$\n  2. $w$-nullcline: $w = \\frac{v + a}{b}$\n- Condition for saddle-node bifurcation: The nullclines are tangent to each other in the $(v,w)$ plane.\n- Task:\n  1. Determine the positive value of $I$ for the given parameters that causes this tangency.\n  2. Verify the result by showing the discriminant of the cubic equilibrium equation for $v$ is zero.\n  3. Round the final answer for $I$ to four significant figures.\n\n**1.2. Validate Using Extracted Givens**\n- **Scientifically Grounded**: The FitzHugh-Nagumo model is a canonical model in theoretical neuroscience. The analysis of its dynamics through nullclines, fixed points (equilibria), and bifurcations (like saddle-node) is a standard and fundamental technique in the study of dynamical systems. The problem is scientifically and mathematically sound.\n- **Well-Posed**: The problem is well-defined. It provides all necessary equations and parameter values. The condition for the bifurcation (tangency of nullclines) is a clear geometric and algebraic constraint that allows for a unique solution for the parameter $I$. The request for verification via a second standard method (the discriminant of the cubic) further reinforces that the problem is well-structured.\n- **Objective**: The problem is stated in precise mathematical language, free of any subjectivity or ambiguity.\n\n**1.3. Verdict and Action**\nThe problem is valid. I will proceed with providing a full solution.\n\n### Step 2: Solution\n\nA saddle-node bifurcation of equilibria occurs when the nullclines are tangent. This means that at the point of tangency, $(v_c, w_c)$, both the values of $w$ and the slopes $\\frac{dw}{dv}$ of the nullcline curves must be equal.\n\nThe two nullclines are given by:\n1. Cubic nullcline ($dv/dt = 0$): $w = v - \\frac{v^3}{3} + I$\n2. Linear nullcline ($dw/dt = 0$): $w = \\frac{v + a}{b}$\n\nFirst, we find the slopes by differentiating each expression for $w$ with respect to $v$:\n1. Slope of the cubic nullcline: $\\frac{dw}{dv} = \\frac{d}{dv} \\left(v - \\frac{v^3}{3} + I\\right) = 1 - v^2$\n2. Slope of the linear nullcline: $\\frac{dw}{dv} = \\frac{d}{dv} \\left(\\frac{v + a}{b}\\right) = \\frac{1}{b}$\n\nAt a point of tangency, $v_c$, these slopes must be equal:\n$$ 1 - v_c^2 = \\frac{1}{b} $$\nThe problem provides the parameter value $b=2$. Substituting this gives:\n$$ 1 - v_c^2 = \\frac{1}{2} $$\n$$ v_c^2 = 1 - \\frac{1}{2} = \\frac{1}{2} $$\nThis yields two possible values for the membrane potential at the bifurcation point:\n$$ v_c = \\pm \\frac{1}{\\sqrt{2}} $$\n\nNow we use the second condition for tangency: the $w$ values must also be equal at $v = v_c$.\n$$ v_c - \\frac{v_c^3}{3} + I = \\frac{v_c + a}{b} $$\nWe can rearrange this equation to solve for the input current $I$:\n$$ I = \\frac{v_c + a}{b} - v_c + \\frac{v_c^3}{3} $$\nWe are given $a = 0.3$ and $b = 2$. Let's examine the two possible cases for $v_c$.\n\nCase 1: $v_c = +\\frac{1}{\\sqrt{2}}$\n$$ I = \\frac{\\frac{1}{\\sqrt{2}} + 0.3}{2} - \\frac{1}{\\sqrt{2}} + \\frac{\\left(\\frac{1}{\\sqrt{2}}\\right)^3}{3} $$\n$$ I = \\frac{1}{2\\sqrt{2}} + 0.15 - \\frac{1}{\\sqrt{2}} + \\frac{1}{3 \\cdot 2\\sqrt{2}} = 0.15 + \\frac{1}{\\sqrt{2}}\\left(\\frac{1}{2} - 1 + \\frac{1}{6}\\right) $$\n$$ I = 0.15 + \\frac{1}{\\sqrt{2}}\\left(\\frac{3 - 6 + 1}{6}\\right) = 0.15 - \\frac{2}{6\\sqrt{2}} = 0.15 - \\frac{1}{3\\sqrt{2}} $$\nNumerically, $I \\approx 0.15 - \\frac{1}{4.2426} \\approx 0.15 - 0.2357 = -0.0857$. This is a negative value.\n\nCase 2: $v_c = -\\frac{1}{\\sqrt{2}}$\n$$ I = \\frac{-\\frac{1}{\\sqrt{2}} + 0.3}{2} - \\left(-\\frac{1}{\\sqrt{2}}\\right) + \\frac{\\left(-\\frac{1}{\\sqrt{2}}\\right)^3}{3} $$\n$$ I = -\\frac{1}{2\\sqrt{2}} + 0.15 + \\frac{1}{\\sqrt{2}} - \\frac{1}{3 \\cdot 2\\sqrt{2}} = 0.15 + \\frac{1}{\\sqrt{2}}\\left(-\\frac{1}{2} + 1 - \\frac{1}{6}\\right) $$\n$$ I = 0.15 + \\frac{1}{\\sqrt{2}}\\left(\\frac{-3 + 6 - 1}{6}\\right) = 0.15 + \\frac{2}{6\\sqrt{2}} = 0.15 + \\frac{1}{3\\sqrt{2}} $$\nNumerically, $I \\approx 0.15 + 0.2357 = 0.3857$. This is a positive value.\n\nThe problem asks for the positive value of $I$, which is $I = 0.15 + \\frac{1}{3\\sqrt{2}}$.\n\n### Verification using the Discriminant of the Cubic Equilibrium Equation\n\nThe equilibrium points of the system are the intersections of the nullclines. We find the equilibrium equation for $v$ by eliminating $w$:\n$$ v - \\frac{v^3}{3} + I = \\frac{v + a}{b} $$\nSubstituting the parameter values $a=0.3$ and $b=2$:\n$$ v - \\frac{v^3}{3} + I = \\frac{v + 0.3}{2} $$\nTo obtain a polynomial equation, we multiply by $6$:\n$$ 6v - 2v^3 + 6I = 3v + 0.9 $$\nRearranging into the standard form of a cubic equation ($Ax^3+Bx^2+Cx+D=0$):\n$$ 2v^3 - 3v - 6I + 0.9 = 0 $$\nTo use the standard discriminant formula for a depressed cubic ($x^3+px+q=0$), we divide by $2$:\n$$ v^3 - \\frac{3}{2}v + (0.45 - 3I) = 0 $$\nFor this equation, the coefficients are $p = -\\frac{3}{2}$ and $q = 0.45 - 3I$.\nA saddle-node bifurcation corresponds to the merging of two real roots, which occurs when the discriminant of the cubic equation is zero. The discriminant $\\Delta$ for $x^3+px+q=0$ is given by $\\Delta = -4p^3 - 27q^2$.\nSetting the discriminant to zero:\n$$ -4\\left(-\\frac{3}{2}\\right)^3 - 27(0.45 - 3I)^2 = 0 $$\n$$ -4\\left(-\\frac{27}{8}\\right) - 27(0.45 - 3I)^2 = 0 $$\n$$ \\frac{27}{2} - 27(0.45 - 3I)^2 = 0 $$\n$$ \\frac{1}{2} = (0.45 - 3I)^2 $$\nTaking the square root of both sides:\n$$ \\pm \\frac{1}{\\sqrt{2}} = 0.45 - 3I $$\nSolving for $I$:\n$$ 3I = 0.45 \\mp \\frac{1}{\\sqrt{2}} $$\n$$ I = \\frac{0.45}{3} \\mp \\frac{1}{3\\sqrt{2}} = 0.15 \\mp \\frac{1}{3\\sqrt{2}} $$\nThis yields the same two values for $I$ as the tangency method:\n$$ I_1 = 0.15 - \\frac{1}{3\\sqrt{2}} \\approx -0.0857 $$\n$$ I_2 = 0.15 + \\frac{1}{3\\sqrt{2}} \\approx 0.3857 $$\nThe problem asks to verify that the positive value of $I$ found earlier ($I = 0.15 + \\frac{1}{3\\sqrt{2}}$) makes the discriminant zero. Let's substitute this value into the expression for the discriminant:\nThe term inside the square in the discriminant expression was $(0.45 - 3I)$. Let's evaluate this with our positive $I$:\n$$ 0.45 - 3I = 0.45 - 3\\left(0.15 + \\frac{1}{3\\sqrt{2}}\\right) = 0.45 - \\left(0.45 + \\frac{1}{\\sqrt{2}}\\right) = -\\frac{1}{\\sqrt{2}} $$\nNow substitute this back into the discriminant equation:\n$$ \\Delta = \\frac{27}{2} - 27\\left(-\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{27}{2} - 27\\left(\\frac{1}{2}\\right) = 0 $$\nThe discriminant is indeed zero for this value of $I$. This verifies the result.\n\nThe required positive value of $I$ is:\n$$ I = 0.15 + \\frac{1}{3\\sqrt{2}} = 0.15 + \\frac{\\sqrt{2}}{6} \\approx 0.15 + \\frac{1.41421356}{6} \\approx 0.15 + 0.23570226 \\approx 0.38570226 $$\nRounding to four significant figures, we get $I = 0.3857$.",
            "answer": "$$ \\boxed{0.3857} $$"
        },
        {
            "introduction": "The frequency-current (F-I) curve is a neuron's fundamental input-output function, and understanding how its biophysical properties shape this curve is a central goal of computational neuroscience. This practice  moves to the more detailed Morris-Lecar model and uses numerical simulation to explore the role of the leak conductance, $g_L$. By implementing and running the model, you will directly observe how this parameter modulates firing rate gain through shunting inhibition, a key principle of neural computation.",
            "id": "3924732",
            "problem": "Consider a single-compartment conductance-based neuron model in which the membrane potential $V$ obeys the current-balance law of a spatially isopotential patch: the sum of capacitive current and ionic currents equals the externally injected current. The Morris–Lecar (ML) model describes the interplay of a fast regenerative calcium current and a slower restoring potassium current. In this problem, you will quantify how the leak conductance $g_L$ flattens or steepens the frequency–current (F–I) curve by numerical simulation, and interpret the outcome via effective shunting of regenerative inward currents.\n\nFundamental base:\n- The single-compartment current balance is $C \\,\\dfrac{dV}{dt} = I_{\\text{ext}} - I_L - I_{\\text{Ca}} - I_{\\text{K}}$, where $C$ is membrane capacitance, $I_{\\text{ext}}$ is injected current, $I_L$ is leak current, $I_{\\text{Ca}}$ is calcium current, and $I_{\\text{K}}$ is potassium current.\n- In the Morris–Lecar framework, $I_L = g_L \\,(V - E_L)$, $I_{\\text{Ca}} = g_{\\text{Ca}} \\, m_{\\infty}(V)\\,(V - E_{\\text{Ca}})$, $I_{\\text{K}} = g_{\\text{K}} \\, w \\,(V - E_{\\text{K}})$, and the gating variable $w$ follows first-order kinetics $ \\dfrac{dw}{dt} = \\phi \\,\\dfrac{w_{\\infty}(V) - w}{\\tau_w(V)}$.\n- The steady-state activation functions are $m_{\\infty}(V) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{V - V_1}{V_2}\\right)\\right)$ and $w_{\\infty}(V) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{V - V_3}{V_4}\\right)\\right)$, and the voltage-dependent time scale is $\\tau_w(V) = \\dfrac{1}{\\cosh\\left(\\dfrac{V - V_3}{2 V_4}\\right)}$.\n\nModel parameters (use these fixed values):\n- $C = 20$ in $\\mu\\mathrm{F}/\\mathrm{cm}^2$,\n- $g_{\\text{Ca}} = 4.4$ in $\\mathrm{mS}/\\mathrm{cm}^2$,\n- $g_{\\text{K}} = 8$ in $\\mathrm{mS}/\\mathrm{cm}^2$,\n- $E_{\\text{Ca}} = 120$ in $\\mathrm{mV}$,\n- $E_{\\text{K}} = -84$ in $\\mathrm{mV}$,\n- $E_L = -60$ in $\\mathrm{mV}$,\n- $V_1 = -1.2$ in $\\mathrm{mV}$,\n- $V_2 = 18$ in $\\mathrm{mV}$,\n- $V_3 = 2$ in $\\mathrm{mV}$,\n- $V_4 = 30$ in $\\mathrm{mV}$,\n- $\\phi = 0.04$ in $\\mathrm{ms}^{-1}$.\n\nSimulation setup and definitions:\n- Simulate the model for a total time $T_{\\text{total}} = 1000$ in $\\mathrm{ms}$ using a fixed-step fourth-order Runge–Kutta method with a constant step size $\\Delta t = 0.05$ in $\\mathrm{ms}$.\n- Use initial conditions $V(0) = -60$ in $\\mathrm{mV}$ and $w(0) = w_{\\infty}(V(0))$.\n- Apply a constant injected current $I_{\\text{ext}}$ (units $\\mu\\mathrm{A}/\\mathrm{cm}^2$).\n- Define spikes by upward crossings of a threshold $V_{\\text{th}} = 0$ in $\\mathrm{mV}$.\n- Compute the firing rate $f$ in $\\mathrm{Hz}$ as the number of spikes divided by the analysis window duration in seconds; use an analysis window starting at $t_{\\text{start}} = 300$ in $\\mathrm{ms}$ and ending at $T_{\\text{total}}$.\n- For each leak conductance $g_L$, compute the frequency–current slope $S$ in $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$ using a finite difference:\n$$\nS = \\frac{f(I_2) - f(I_1)}{I_2 - I_1},\n$$\nwhere $I_1$ and $I_2$ are two injected currents with $I_2  I_1$.\n\nTask:\n- Implement the above ML model and simulation protocol.\n- For a given pair $\\{I_1, I_2\\}$, compute $S$ for each specified $g_L$.\n- Return each $S$ as a float rounded to six decimal places, with units $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$ implicitly understood.\n\nTest suite:\n- Use the current pair $\\{I_1, I_2\\} = \\{90.0, 130.0\\}$ in $\\mu\\mathrm{A}/\\mathrm{cm}^2$ for all tests.\n- Evaluate four leak conductance cases:\n    1. Happy path: $g_L = 2.0$ in $\\mathrm{mS}/\\mathrm{cm}^2$.\n    2. Moderate leak increase: $g_L = 4.0$ in $\\mathrm{mS}/\\mathrm{cm}^2$.\n    3. Large leak: $g_L = 8.0$ in $\\mathrm{mS}/\\mathrm{cm}^2$.\n    4. Extreme leak (edge case): $g_L = 16.0$ in $\\mathrm{mS}/\\mathrm{cm}^2$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four slope results, in the order of the test suite above, as a comma-separated list enclosed in square brackets (for example, $\\left[ s_1, s_2, s_3, s_4 \\right]$).\n- Each entry must be a float rounded to six decimal places.\n- The units of the slopes are $\\mathrm{Hz}\\,/\\left(\\mu\\mathrm{A}/\\mathrm{cm}^2\\right)$.",
            "solution": "The problem requires the computation of the frequency-current (F-I) curve slope for the Morris-Lecar neuron model under different leak conductance values, $g_L$. This is achieved by numerical simulation. The solution involves implementing the model's dynamics, performing simulations using a specified numerical integration scheme, and analyzing the resulting spike trains to calculate firing rates.\n\nThe Morris-Lecar model is a two-dimensional system of coupled ordinary differential equations (ODEs) describing the evolution of the membrane potential, $V$ (in $\\mathrm{mV}$), and a potassium channel gating variable, $w$ (dimensionless). The equations are:\n$$\nC \\frac{dV}{dt} = I_{\\text{ext}} - I_L - I_{\\text{Ca}} - I_{\\text{K}}\n$$\n$$\n\\frac{dw}{dt} = \\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\nwhere $C$ is the membrane capacitance, $I_{\\text{ext}}$ is the externally injected current, and the ionic currents are given by:\n- Leak current: $I_L = g_L (V - E_L)$\n- Calcium current: $I_{\\text{Ca}} = g_{\\text{Ca}} m_{\\infty}(V) (V - E_{\\text{Ca}})$\n- Potassium current: $I_{\\text{K}} = g_{\\text{K}} w (V - E_{\\text{K}})$\n\nThe voltage-dependent steady-state activation functions ($m_{\\infty}(V)$, $w_{\\infty}(V)$) and the time scale for the $w$ variable ($\\tau_w(V)$) are defined as:\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_1}{V_2}\\right)\\right)\n$$\n$$\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right)\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\left(\\frac{V - V_3}{2 V_4}\\right)}\n$$\n\nThe fixed parameters for the model are specified as:\n- $C = 20 \\, \\mu\\mathrm{F}/\\mathrm{cm}^2$\n- $g_{\\text{Ca}} = 4.4 \\, \\mathrm{mS}/\\mathrm{cm}^2$\n- $g_{\\text{K}} = 8 \\, \\mathrm{mS}/\\mathrm{cm}^2$\n- $E_{\\text{Ca}} = 120 \\, \\mathrm{mV}$\n- $E_{\\text{K}} = -84 \\, \\mathrm{mV}$\n- $E_L = -60 \\, \\mathrm{mV}$\n- $V_1 = -1.2 \\, \\mathrm{mV}$\n- $V_2 = 18 \\, \\mathrm{mV}$\n- $V_3 = 2 \\, \\mathrm{mV}$\n- $V_4 = 30 \\, \\mathrm{mV}$\n- $\\phi = 0.04 \\, \\mathrm{ms}^{-1}$\n\nTo solve this system of ODEs, we employ the fourth-order Runge-Kutta (RK4) method with a fixed time step of $\\Delta t = 0.05$ ms. For a state vector $\\mathbf{y}_n = [V_n, w_n]^T$ at time $t_n$, the state at the next time step $t_{n+1} = t_n + \\Delta t$ is computed as:\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nwhere $\\mathbf{f}(\\mathbf{y}) = [dV/dt, dw/dt]^T$ and:\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\frac{1}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\frac{1}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\Delta t \\cdot \\mathbf{f}(\\mathbf{y}_n + \\mathbf{k}_3)\n\\end{aligned}\n$$\nEach simulation runs for a total duration of $T_{\\text{total}} = 1000$ ms, starting from the initial conditions $V(0) = -60$ mV and $w(0) = w_{\\infty}(V(0))$.\n\nFollowing each simulation, the firing rate $f$ is calculated. A spike is defined as an upward crossing of the membrane potential $V$ through a threshold of $V_{\\text{th}} = 0$ mV. The number of spikes, $N_{\\text{spikes}}$, is counted within an analysis window that starts at $t_{\\text{start}} = 300$ ms and ends at $T_{\\text{total}}$. This initial $300$ ms period is discarded to ensure that the analysis is performed on the neuron's steady-state response, after any initial transients have decayed. The firing rate in Hertz (Hz) is then:\n$$\nf = \\frac{N_{\\text{spikes}}}{(T_{\\text{total}} - t_{\\text{start}}) / 1000}\n$$\nThe denominator, $(1000 - 300)/1000 = 0.7$ s, is the duration of the analysis window in seconds.\n\nThe core task is to compute the slope $S$ of the F-I curve for four different values of the leak conductance $g_L$: $\\{2.0, 4.0, 8.0, 16.0\\}$ in $\\mathrm{mS}/\\mathrm{cm}^2$. For each $g_L$, two simulations are performed with injected currents $I_1 = 90.0 \\, \\mu\\mathrm{A}/\\mathrm{cm}^2$ and $I_2 = 130.0 \\, \\mu\\mathrm{A}/\\mathrm{cm}^2$ to obtain the corresponding firing rates $f(I_1)$ and $f(I_2)$. The slope $S$ is then calculated using a finite difference approximation:\n$$\nS = \\frac{f(I_2) - f(I_1)}{I_2 - I_1}\n$$\nThe final result for each $g_L$ is rounded to six decimal places. The entire procedure is implemented in a Python script.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation and calculation of F-I curve slopes\n    for the Morris-Lecar model.\n    \"\"\"\n\n    class MorrisLecarModel:\n        \"\"\"\n        Encapsulates the Morris-Lecar model parameters and differential equations.\n        \"\"\"\n        def __init__(self, g_L):\n            # Fixed parameters as specified in the problem\n            self.C = 20.0        # uF/cm^2\n            self.g_Ca = 4.4      # mS/cm^2\n            self.g_K = 8.0       # mS/cm^2\n            self.E_Ca = 120.0    # mV\n            self.E_K = -84.0     # mV\n            self.E_L = -60.0     # mV\n            self.V1 = -1.2       # mV\n            self.V2 = 18.0       # mV\n            self.V3 = 2.0        # mV\n            self.V4 = 30.0       # mV\n            self.phi = 0.04      # ms^-1\n            \n            # Variable parameter\n            self.g_L = g_L       # mS/cm^2\n            \n        def m_inf(self, V):\n            return 0.5 * (1.0 + np.tanh((V - self.V1) / self.V2))\n            \n        def w_inf(self, V):\n            return 0.5 * (1.0 + np.tanh((V - self.V3) / self.V4))\n            \n        def tau_w(self, V):\n            return 1.0 / np.cosh((V - self.V3) / (2.0 * self.V4))\n\n        def derivatives(self, state, I_ext):\n            \"\"\"\n            Computes the derivatives [dV/dt, dw/dt] for the Morris-Lecar model.\n            \n            Args:\n                state (np.array): Current state [V, w].\n                I_ext (float): External injected current.\n            \n            Returns:\n                np.array: The derivatives [dV/dt, dw/dt].\n            \"\"\"\n            V, w = state\n            \n            # Ionic currents\n            I_L = self.g_L * (V - self.E_L)\n            I_Ca = self.g_Ca * self.m_inf(V) * (V - self.E_Ca)\n            I_K = self.g_K * w * (V - self.E_K)\n            \n            # ODEs from current balance equation\n            dV_dt = (I_ext - I_L - I_Ca - I_K) / self.C\n            dw_dt = self.phi * (self.w_inf(V) - w) / self.tau_w(V)\n            \n            return np.array([dV_dt, dw_dt])\n\n    def run_simulation_and_get_rate(g_L, I_ext):\n        \"\"\"\n        Runs a simulation of the ML model and calculates the firing rate.\n\n        Args:\n            g_L (float): Leak conductance.\n            I_ext (float): External injected current.\n        \n        Returns:\n            float: The calculated firing rate in Hz.\n        \"\"\"\n        # Simulation parameters\n        dt = 0.05          # ms\n        T_total = 1000.0   # ms\n        t_start = 300.0    # ms\n        V_th = 0.0         # mV\n\n        model = MorrisLecarModel(g_L)\n        \n        num_steps = int(T_total / dt)\n        \n        # State variable arrays to store trajectory\n        V_trace = np.zeros(num_steps + 1)\n        w_trace = np.zeros(num_steps + 1)\n        \n        # Initial conditions\n        V_trace[0] = -60.0\n        w_trace[0] = model.w_inf(V_trace[0])\n        \n        # Simulation loop using fourth-order Runge-Kutta (RK4)\n        for i in range(num_steps):\n            state = np.array([V_trace[i], w_trace[i]])\n            \n            k1 = dt * model.derivatives(state, I_ext)\n            k2 = dt * model.derivatives(state + 0.5 * k1, I_ext)\n            k3 = dt * model.derivatives(state + 0.5 * k2, I_ext)\n            k4 = dt * model.derivatives(state + k3, I_ext)\n            \n            new_state = state + (k1 + 2 * k2 + 2 * k3 + k4) / 6.0\n            \n            V_trace[i+1] = new_state[0]\n            w_trace[i+1] = new_state[1]\n\n        # Spike counting within the analysis window\n        spike_count = 0\n        analysis_start_index = int(t_start / dt)\n        \n        for i in range(analysis_start_index, num_steps + 1):\n            if V_trace[i-1]  V_th and V_trace[i] = V_th:\n                spike_count += 1\n                \n        # Firing rate calculation\n        analysis_duration_s = (T_total - t_start) / 1000.0\n        firing_rate = spike_count / analysis_duration_s\n        \n        return firing_rate\n\n    # Test suite parameters from the problem statement\n    I1, I2 = 90.0, 130.0\n    g_L_cases = [2.0, 4.0, 8.0, 16.0]\n    \n    results = []\n    \n    # Loop through each test case for leak conductance\n    for g_L in g_L_cases:\n        # Calculate firing rate for the two current levels\n        f1 = run_simulation_and_get_rate(g_L=g_L, I_ext=I1)\n        f2 = run_simulation_and_get_rate(g_L=g_L, I_ext=I2)\n\n        # Calculate the F-I slope S using a finite difference\n        S = (f2 - f1) / (I2 - I1)\n            \n        results.append(round(S, 6))\n        \n    # Print the final output in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}