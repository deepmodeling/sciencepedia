{
    "hands_on_practices": [
        {
            "introduction": "Our first practical exercise establishes the foundational behavior of the two-element Windkessel model. By simulating the arterial pressure response to a simplified, periodic square-wave inflow, we can derive an analytical solution from first principles. This practice  is essential for understanding how the system's core parameters, peripheral resistance ($R$) and arterial compliance ($C$), govern the dynamics of pressure build-up and decay, ultimately determining the pulse pressure.",
            "id": "3938490",
            "problem": "Consider the two-element Windkessel model for arterial hemodynamics, consisting of a single linear compliance and a single linear peripheral resistance. Let $Q_{\\text{in}}(t)$ denote the inflow to the compliant reservoir (representing the proximal arterial tree), $P(t)$ the arterial pressure, $R$ the peripheral resistance, and $C$ the arterial compliance. The Windkessel dynamics follow conservation of mass (volume) and linear constitutive behavior:\n- Conservation of mass: $C \\,\\dfrac{dP}{dt} = Q_{\\text{in}}(t) - Q_{\\text{out}}(t)$,\n- Linear resistance: $Q_{\\text{out}}(t) = \\dfrac{P(t)}{R}$,\n- Linear compliance: $\\Delta V = C \\,\\Delta P$.\n\nFrom these statements, the governing ordinary differential equation (ODE) for $P(t)$ is fully determined. In this problem, $Q_{\\text{in}}(t)$ is a square wave over a cycle of duration $T$ seconds: it is a constant of amplitude $A$ (in $\\text{ml/s}$) for a duration $T_s$ seconds (systolic inflow) and zero for the remainder $T_d = T - T_s$ seconds (diastolic no inflow). Assume periodic steady state, meaning the pressure waveform is identical at the start of each cycle.\n\nYour task is to write a complete program that, for each specified parameter set, uses the principles above to compute the periodic steady-state waveform over one cycle and then returns the pulse pressure, defined as the difference between the maximum and minimum pressure within a cycle, i.e., $\\text{Pulse Pressure} = P_{\\max} - P_{\\min}$, expressed in $\\text{mmHg}$ and rounded to three decimal places.\n\nAll answers must be expressed in $\\text{mmHg}$. Use radians only if angles appear, but angles do not appear in this problem. The output for each test case must be a single floating-point number in $\\text{mmHg}$.\n\nTest suite:\n1. Happy path case (the thumbnail scenario): $A=80$ $\\text{ml/s}$, $T_s=0.3$ $\\text{s}$, $T=1.0$ $\\text{s}$, $R=1$ $\\text{mmHg·s/ml}$, $C=2$ $\\text{ml/mmHg}$.\n2. Zero inflow amplitude edge case: $A=0$ $\\text{ml/s}$, $T_s=0.3$ $\\text{s}$, $T=1.0$ $\\text{s}$, $R=1$ $\\text{mmHg·s/ml}$, $C=2$ $\\text{ml/mmHg}$.\n3. Full-cycle inflow boundary case: $A=80$ $\\text{ml/s}$, $T_s=1.0$ $\\text{s}$, $T=1.0$ $\\text{s}$, $R=1$ $\\text{mmHg·s/ml}$, $C=2$ $\\text{ml/mmHg}$.\n4. High compliance case: $A=80$ $\\text{ml/s}$, $T_s=0.3$ $\\text{s}$, $T=1.0$ $\\text{s}$, $R=1$ $\\text{mmHg·s/ml}$, $C=100$ $\\text{ml/mmHg}$.\n5. High resistance and low compliance case: $A=80$ $\\text{ml/s}$, $T_s=0.3$ $\\text{s}$, $T=1.0$ $\\text{s}$, $R=2$ $\\text{mmHg·s/ml}$, $C=0.5$ $\\text{ml/mmHg}$.\n6. Low resistance, moderate compliance case: $A=80$ $\\text{ml/s}$, $T_s=0.3$ $\\text{s}$, $T=1.0$ $\\text{s}$, $R=0.2$ $\\text{mmHg·s/ml}$, $C=1.0$ $\\text{ml/mmHg}$.\n\nYour program should produce a single line of output containing the pulse pressures for all test cases as a comma-separated list enclosed in square brackets (for example, $[x_1,x_2,\\dots,x_6]$), in the same order as listed above, with each value rounded to three decimal places and expressed in $\\text{mmHg}$.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. All necessary parameters and conditions for the two-element Windkessel model are provided, and the problem is free of contradictions or ambiguities. It represents a standard and formalizable problem in biomedical systems modeling. Therefore, the problem is deemed valid.\n\nThe solution proceeds by deriving an analytical expression for the pulse pressure based on the governing ordinary differential equation (ODE) of the two-element Windkessel model.\n\nThe model is described by the following equations:\n1.  Conservation of volume (mass): $C \\dfrac{dP(t)}{dt} = Q_{\\text{in}}(t) - Q_{\\text{out}}(t)$\n2.  Linear peripheral resistance: $Q_{\\text{out}}(t) = \\dfrac{P(t)}{R}$\n\nSubstituting the expression for $Q_{\\text{out}}(t)$ into the conservation equation yields the governing first-order linear ODE for pressure $P(t)$:\n$$C \\frac{dP(t)}{dt} = Q_{\\text{in}}(t) - \\frac{P(t)}{R}$$\nRearranging this into standard form gives:\n$$\\frac{dP(t)}{dt} + \\frac{1}{RC} P(t) = \\frac{1}{C} Q_{\\text{in}}(t)$$\nLet the time constant of the system be $\\tau = RC$. The ODE becomes:\n$$\\frac{dP(t)}{dt} + \\frac{1}{\\tau} P(t) = \\frac{1}{C} Q_{\\text{in}}(t)$$\nThe inflow $Q_{\\text{in}}(t)$ is a periodic square wave with period $T$:\n$$\nQ_{\\text{in}}(t) =\n\\begin{cases}\nA & \\text{for } 0 \\le t \\le T_s \\quad (\\text{systole}) \\\\\n0 & \\text{for } T_s < t \\le T \\quad (\\text{diastole})\n\\end{cases}\n$$\nWe must solve the ODE for each phase and connect the solutions using continuity and periodicity conditions.\n\n**1. Systolic Phase ($0 \\le t \\le T_s$)**\nDuring systole, the ODE is:\n$$\\frac{dP_s}{dt} + \\frac{1}{\\tau} P_s(t) = \\frac{A}{C}$$\nThe general solution is the sum of a particular solution and a homogeneous solution. The particular solution is a constant, $P_{s,p} = AR$. The homogeneous solution is $K_s e^{-t/\\tau}$. Thus, the general solution for systole is:\n$$P_s(t) = AR + K_s e^{-t/\\tau}$$\nThe constant $K_s$ can be determined from the pressure at the beginning of the cycle, $P(0)$.\n$$P_s(0) = P(0) = AR + K_s \\implies K_s = P(0) - AR$$\nSo, the pressure during systole is:\n$$P_s(t) = AR + (P(0) - AR)e^{-t/\\tau}$$\n\n**2. Diastolic Phase ($T_s < t \\le T$)**\nDuring diastole, $Q_{\\text{in}}(t) = 0$, and the ODE becomes homogeneous:\n$$\\frac{dP_d}{dt} + \\frac{1}{\\tau} P_d(t) = 0$$\nThe solution is a decaying exponential:\n$$P_d(t) = K_d e^{-t/\\tau}$$\nTo find $K_d$, we enforce continuity of pressure at the transition from systole to diastole, at $t=T_s$:\n$$P_d(T_s) = P_s(T_s)$$\nLet's define the solution for diastole in terms of the pressure at the start of diastole, $P(T_s)$:\n$$P_d(t) = P(T_s) e^{-(t-T_s)/\\tau}, \\quad \\text{for } t > T_s$$\nwhere $P(T_s)$ is the pressure at the end of systole, given by:\n$$P(T_s) = P_s(T_s) = AR + (P(0) - AR)e^{-T_s/\\tau}$$\n\n**3. Periodic Steady-State Condition**\nThe problem requires a periodic steady state, which means $P(T) = P(0)$. Using the diastolic solution at $t=T$:\n$$P(T) = P(T_s) e^{-(T-T_s)/\\tau}$$\nSubstituting $P(T) = P(0)$ gives a crucial relationship between the pressures at the start of systole and the start of diastole:\n$$P(0) = P(T_s) e^{-(T-T_s)/\\tau} \\quad \\text{or} \\quad P(T_s) = P(0) e^{(T-T_s)/\\tau}$$\n\n**4. Solving for Initial and Peak Pressures**\nWe have two expressions for $P(T_s)$. Equating them allows us to solve for $P(0)$:\n$$P(0) e^{(T-T_s)/\\tau} = AR(1-e^{-T_s/\\tau}) + P(0)e^{-T_s/\\tau}$$\n$$P(0) \\left( e^{(T-T_s)/\\tau} - e^{-T_s/\\tau} \\right) = AR(1-e^{-T_s/\\tau})$$\nMultiplying by $e^{T_s/\\tau}$:\n$$P(0) \\left( e^{T/\\tau} - 1 \\right) = AR(e^{T_s/\\tau}-1)$$\nThis yields the solution for the pressure at the beginning of the cycle:\n$$P(0) = AR \\frac{e^{T_s/\\tau} - 1}{e^{T/\\tau} - 1}$$\n\n**5. Derivation of Pulse Pressure**\nThe pulse pressure is defined as $P_{\\max} - P_{\\min}$.\nDuring systole, assuming a typical case where $P(0) < AR$, the pressure derivative $\\frac{dP_s}{dt} = \\frac{1}{C}(A-P_s/R)$ is positive, so pressure increases. The maximum pressure is reached at the end of systole, $P_{\\max} = P(T_s)$.\nDuring diastole, the pressure derivative $\\frac{dP_d}{dt} = -\\frac{P_d}{RC}$ is negative, so pressure decreases. The minimum pressure occurs at the end of the cycle, $P_{\\min} = P(T) = P(0)$.\nTherefore, the pulse pressure ($PP$) is:\n$$PP = P_{\\max} - P_{\\min} = P(T_s) - P(0)$$\nUsing the relationship $P(T_s) = P(0) e^{(T-T_s)/\\tau}$ derived from the periodicity condition:\n$$PP = P(0) e^{(T-T_s)/\\tau} - P(0) = P(0) \\left( e^{(T-T_s)/\\tau} - 1 \\right)$$\nSubstituting the expression we found for $P(0)$:\n$$PP = \\left( AR \\frac{e^{T_s/\\tau} - 1}{e^{T/\\tau} - 1} \\right) \\left( e^{(T-T_s)/\\tau} - 1 \\right)$$\nRearranging gives the final analytical formula for the pulse pressure, where $\\tau=RC$:\n$$PP = AR \\frac{\\left(e^{T_s/\\tau} - 1\\right)\\left(e^{(T-T_s)/\\tau} - 1\\right)}{e^{T/\\tau} - 1}$$\nThis formula will be implemented to solve for the given test cases. Special cases, such as $A=0$ or $T_s=T$, result in a pulse pressure of $0$, which is correctly handled by this formula. For $A=0$, the $AR$ term makes $PP=0$. For $T_s=T$, the term $e^{(T-T_s)/\\tau}-1 = e^0-1 = 0$, also making $PP=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_pulse_pressure(A, Ts, T, R, C):\n    \"\"\"\n    Calculates the pulse pressure for a two-element Windkessel model.\n\n    Args:\n        A (float): Inflow amplitude in ml/s.\n        Ts (float): Systolic duration in s.\n        T (float): Cardiac cycle duration in s.\n        R (float): Peripheral resistance in mmHg·s/ml.\n        C (float): Arterial compliance in ml/mmHg.\n\n    Returns:\n        float: The pulse pressure (P_max - P_min) in mmHg.\n    \"\"\"\n    # If inflow amplitude is zero or inflow is constant (T_s = T),\n    # the pressure is constant in steady state, so pulse pressure is zero.\n    if A == 0 or Ts == T:\n        return 0.0\n\n    # The time constant of the system\n    tau = R * C\n    \n    # If R or C is zero, tau would be zero, leading to division by zero.\n    # The problem constraints imply R > 0 and C > 0.\n    if tau == 0:\n        # This case implies infinite decay rate. Pressure would drop to 0 instantly.\n        # During systole, pressure would track AR. Pmax=AR, Pmin=0. PP=AR.\n        # Our formula has a 0/0 form. L'Hopital's rule would be needed.\n        # But this is not expected from problem data.\n        # For simplicity, returning AR as a limiting case.\n        return A * R\n\n    # Calculate the exponential terms from the derived formula for pulse pressure:\n    # PP = AR * ( (exp(Ts/tau) - 1) * (exp((T-Ts)/tau) - 1) ) / (exp(T/tau) - 1)\n    \n    exp_ts_tau = np.exp(Ts / tau)\n    exp_td_tau = np.exp((T - Ts) / tau)\n    exp_t_tau = np.exp(T / tau)\n\n    numerator = (exp_ts_tau - 1) * (exp_td_tau - 1)\n    denominator = exp_t_tau - 1\n\n    pulse_pressure = A * R * (numerator / denominator)\n    \n    return pulse_pressure\n\ndef solve():\n    \"\"\"\n    Runs the Windkessel model calculations for the suite of test cases\n    and prints the formatted results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (A, Ts, T, R, C)\n    test_cases = [\n        (80.0, 0.3, 1.0, 1.0, 2.0),      # 1. Happy path case\n        (0.0, 0.3, 1.0, 1.0, 2.0),       # 2. Zero inflow amplitude edge case\n        (80.0, 1.0, 1.0, 1.0, 2.0),      # 3. Full-cycle inflow boundary case\n        (80.0, 0.3, 1.0, 1.0, 100.0),    # 4. High compliance case\n        (80.0, 0.3, 1.0, 2.0, 0.5),      # 5. High resistance and low compliance case\n        (80.0, 0.3, 1.0, 0.2, 1.0),      # 6. Low resistance, moderate compliance case\n    ]\n\n    results = []\n    for case in test_cases:\n        A, Ts, T, R, C = case\n        pp = calculate_pulse_pressure(A, Ts, T, R, C)\n        results.append(pp)\n\n    # Format results to three decimal places as required.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real cardiac outflow is a smooth, continuous pulse, not a square wave. This next practice moves toward greater physiological realism by modeling the inflow as a sinusoidal pulse. You will solve the same governing differential equation for this more complex input and face the challenge of determining the peak pressure , which requires finding the root of a transcendental equation. This exercise hones skills in handling continuous forcing functions and analyzing the transient response of a dynamic system.",
            "id": "3938498",
            "problem": "A two-element arterial Windkessel model comprises a single resistance and a single compliance connected in parallel. Using conservation of mass and linear constitutive relationships, the inflow is decomposed as a sum of the flow into the compliant storage and the flow through the resistor. The fundamental base is the conservation of volume flow and the linear definitions of resistance and compliance. Specifically, the governing relationships are: $Q_{\\text{in}}(t) = Q_C(t) + Q_R(t)$, $Q_C(t) = C \\, \\frac{dP(t)}{dt}$, and $Q_R(t) = \\frac{P(t) - P_{\\text{out}}}{R}$, where $P_{\\text{out}}$ is the downstream reference pressure. In this problem, set $P_{\\text{out}} = 0$ as the reference and $P(0) = 0$ as the initial condition. The inflow is given by $Q_{\\text{in}}(t) = Q_0 \\sin\\!\\left(\\frac{\\pi t}{T}\\right)$ for $0 \\le t \\le T$ and $Q_{\\text{in}}(t) = 0$ for $t > T$. The angle of the sine argument is in radians.\n\nYour task is to derive, from the stated fundamental base only, the ordinary differential equation (ODE) for $P(t)$ and obtain its closed-form solution for $0 \\le t \\le T$ and for $t > T$. Then, implement the resulting expression algorithmically and use it to compute specific quantitative outputs.\n\nExpress all pressure values in millimeters of mercury (mmHg), and round all reported numeric results to $6$ decimal places.\n\nImplement a program that, for each test case below, computes and returns three quantities:\n- the maximum value of $P(t)$ over $t \\in [0, 2T]$,\n- the value of $P(t)$ at $t = T$,\n- the value of $P(t)$ at $t = 2T$.\n\nUse the following test suite of parameter values, each specified in scientifically consistent units:\n1. $Q_0 = 200$ (ml/s), $T = 0.3$ (s), $R = 1$ (mmHg·s/ml), $C = 2$ (ml/mmHg).\n2. $Q_0 = 200$ (ml/s), $T = 0.3$ (s), $R = 1$ (mmHg·s/ml), $C = 0.5$ (ml/mmHg).\n3. $Q_0 = 200$ (ml/s), $T = 0.3$ (s), $R = 0.5$ (mmHg·s/ml), $C = 2$ (ml/mmHg).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by test case and by the three quantities within each case. That is, for test case $k$ with results $(\\text{peak}, P(T), P(2T))$, the overall output should be $[\\text{peak}_1, P_1(T), P_1(2T), \\text{peak}_2, P_2(T), P_2(2T), \\text{peak}_3, P_3(T), P_3(2T)]$, with each number rounded to $6$ decimal places and expressed in mmHg.",
            "solution": "The user has provided a problem statement that requires both a theoretical derivation and an algorithmic implementation based on the two-element Windkessel model of arterial blood pressure.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe fundamental governing relationships provided are:\n1.  Conservation of flow: $Q_{\\text{in}}(t) = Q_C(t) + Q_R(t)$\n2.  Constitutive relation for compliance: $Q_C(t) = C \\, \\frac{dP(t)}{dt}$\n3.  Constitutive relation for resistance: $Q_R(t) = \\frac{P(t) - P_{\\text{out}}}{R}$\n\nThe problem specifies the following conditions and inputs:\n-   Downstream reference pressure: $P_{\\text{out}} = 0$\n-   Initial condition: $P(0) = 0$\n-   Inflow function:\n    -   $Q_{\\text{in}}(t) = Q_0 \\sin\\!\\left(\\frac{\\pi t}{T}\\right)$ for $0 \\le t \\le T$\n    -   $Q_{\\text{in}}(t) = 0$ for $t > T$\n\nThe required outputs for each test case are:\n-   The maximum value of $P(t)$ over the interval $t \\in [0, 2T]$.\n-   The value of $P(t)$ at $t = T$.\n-   The value of $P(t)$ at $t = 2T$.\n\nThe test cases are:\n1.  $Q_0 = 200$ ml/s, $T = 0.3$ s, $R = 1$ mmHg·s/ml, $C = 2$ ml/mmHg.\n2.  $Q_0 = 200$ ml/s, $T = 0.3$ s, $R = 1$ mmHg·s/ml, $C = 0.5$ ml/mmHg.\n3.  $Q_0 = 200$ ml/s, $T = 0.3$ s, $R = 0.5$ mmHg·s/ml, $C = 2$ ml/mmHg.\n\nAll numerical results are to be rounded to $6$ decimal places.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem uses the Windkessel model, a standard and simplified but scientifically valid model in hemodynamics and biomedical engineering. The governing equations are based on fundamental principles of conservation of mass (or volume, for an incompressible fluid) and linear constitutive laws analogous to Ohm's law and the capacitor equation in electrical circuits. The model is scientifically sound.\n2.  **Well-Posed:** The problem defines a first-order linear ordinary differential equation with a piecewise-defined forcing function and a specified initial condition. This constitutes a well-posed initial value problem, for which a unique and stable solution exists.\n3.  **Objective:** The problem is stated in precise, quantitative terms. All parameters, variables, and objectives are clearly and unambiguously defined.\n4.  **Self-Contained and Consistent:** All necessary information (equations, conditions, parameters) is provided. The units are consistent: $R$ [mmHg·s/ml] and $C$ [ml/mmHg] result in a time constant $\\tau=RC$ with units of seconds [s], which is consistent with the time variable $t$. The term $Q_0 R$ correctly yields units of pressure [mmHg]. There are no contradictions.\n5.  **No Other Flaws:** The problem is not trivial, metaphorical, or outside the scope of scientific verifiability.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. A complete solution will be provided.\n\n### Theoretical Derivation and Solution\n\n**1. Derivation of the Governing Ordinary Differential Equation (ODE)**\n\nWe begin with the provided fundamental relationships:\n$Q_{\\text{in}}(t) = Q_C(t) + Q_R(t)$\n$Q_C(t) = C \\frac{dP(t)}{dt}$\n$Q_R(t) = \\frac{P(t) - P_{\\text{out}}}{R}$\n\nSubstituting the expressions for $Q_C(t)$ and $Q_R(t)$ into the conservation of flow equation gives:\n$$Q_{\\text{in}}(t) = C \\frac{dP(t)}{dt} + \\frac{P(t) - P_{\\text{out}}}{R}$$\nThe problem specifies $P_{\\text{out}} = 0$. The equation simplifies to:\n$$Q_{\\text{in}}(t) = C \\frac{dP(t)}{dt} + \\frac{P(t)}{R}$$\nRearranging this into the standard form for a first-order linear ODE, we get:\n$$\\frac{dP(t)}{dt} + \\frac{1}{RC}P(t) = \\frac{1}{C}Q_{\\text{in}}(t)$$\nLet us define the Windkessel time constant $\\tau = RC$. The ODE becomes:\n$$\\frac{dP(t)}{dt} + \\frac{1}{\\tau}P(t) = \\frac{1}{C}Q_{\\text{in}}(t)$$\n\nThe solution is determined in two phases corresponding to the definition of $Q_{\\text{in}}(t)$.\n\n**2. Phase 1: Solution for $0 \\le t \\le T$ (Systole)**\n\nDuring this interval, the inflow is $Q_{\\text{in}}(t) = Q_0 \\sin(\\omega t)$, where $\\omega = \\frac{\\pi}{T}$. The ODE is:\n$$\\frac{dP(t)}{dt} + \\frac{1}{\\tau}P(t) = \\frac{Q_0}{C}\\sin(\\omega t)$$\nThis is a non-homogeneous linear ODE. The general solution $P_1(t)$ is the sum of the homogeneous solution $P_h(t)$ and a particular solution $P_p(t)$.\n\nThe homogeneous equation is $\\frac{dP_h}{dt} + \\frac{1}{\\tau}P_h(t) = 0$, which has the solution $P_h(t) = A e^{-t/\\tau}$.\n\nFor the particular solution, we use the method of undetermined coefficients, assuming a solution of the form $P_p(t) = B\\sin(\\omega t) + D\\cos(\\omega t)$. Substituting this into the ODE yields:\n$$ (B\\omega\\cos(\\omega t) - D\\omega\\sin(\\omega t)) + \\frac{1}{\\tau}(B\\sin(\\omega t) + D\\cos(\\omega t)) = \\frac{Q_0}{C}\\sin(\\omega t) $$\nEquating coefficients of $\\sin(\\omega t)$ and $\\cos(\\omega t)$:\n-   $\\cos(\\omega t): B\\omega + \\frac{D}{\\tau} = 0 \\implies D = -B\\omega\\tau$\n-   $\\sin(\\omega t): -D\\omega + \\frac{B}{\\tau} = \\frac{Q_0}{C}$\n\nSubstituting the expression for $D$ into the second equation:\n$$ -(-B\\omega\\tau)\\omega + \\frac{B}{\\tau} = \\frac{Q_0}{C} \\implies B(\\omega^2\\tau^2 + 1) = \\frac{Q_0\\tau}{C} $$\n$$ B = \\frac{Q_0\\tau}{C(1+\\omega^2\\tau^2)} = \\frac{Q_0 RC}{C(1+(\\omega RC)^2)} = \\frac{Q_0 R}{1+(\\omega RC)^2} $$\n$$ D = -B\\omega\\tau = -\\frac{Q_0 R}{1+(\\omega RC)^2} (\\omega RC) = -\\frac{Q_0 R \\omega \\tau}{1+(\\omega\\tau)^2} $$\nThe general solution for phase 1 is:\n$$ P_1(t) = A e^{-t/\\tau} + \\frac{Q_0 R}{1+(\\omega\\tau)^2} \\sin(\\omega t) - \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2} \\cos(\\omega t) $$\nWe apply the initial condition $P(0)=0$:\n$$ 0 = A - \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2} \\implies A = \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2} $$\nSubstituting $A$ back, the final solution for $0 \\le t \\le T$ is:\n$$ P_1(t) = \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2} e^{-t/\\tau} + \\frac{Q_0 R}{1+(\\omega\\tau)^2}\\left( \\sin(\\omega t) - \\omega\\tau \\cos(\\omega t) \\right) $$\nThis can be written more compactly as:\n$$ P_1(t) = \\frac{Q_0 R}{1+(\\omega\\tau)^2} \\left( \\omega\\tau e^{-t/\\tau} + \\sin(\\omega t) - \\omega\\tau \\cos(\\omega t) \\right) $$\n\n**3. Phase 2: Solution for $t > T$ (Diastole)**\n\nDuring this interval, $Q_{\\text{in}}(t) = 0$. The ODE becomes homogeneous:\n$$\\frac{dP(t)}{dt} + \\frac{1}{\\tau}P(t) = 0$$\nThe solution $P_2(t)$ is a simple exponential decay:\n$$ P_2(t) = K e^{-t/\\tau} $$\nThe constant $K$ is determined by enforcing continuity of pressure at $t=T$, i.e., $P_2(T) = P_1(T)$. First, we calculate $P_1(T)$:\n$$ P_1(T) = P_1(t)|_{t=T} = \\frac{Q_0 R}{1+(\\omega\\tau)^2} \\left( \\omega\\tau e^{-T/\\tau} + \\sin(\\omega T) - \\omega\\tau \\cos(\\omega T) \\right) $$\nSince $\\omega T = \\pi$, we have $\\sin(\\pi) = 0$ and $\\cos(\\pi) = -1$.\n$$ P_1(T) = \\frac{Q_0 R}{1+(\\omega\\tau)^2} \\left( \\omega\\tau e^{-T/\\tau} - \\omega\\tau(-1) \\right) = \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2} \\left( 1 + e^{-T/\\tau} \\right) $$\nNow, we set $P_2(T) = P_1(T)$:\n$$ K e^{-T/\\tau} = P_1(T) \\implies K = P_1(T) e^{T/\\tau} $$\nSubstituting $K$ into the expression for $P_2(t)$:\n$$ P_2(t) = \\left( P_1(T) e^{T/\\tau} \\right) e^{-t/\\tau} = P_1(T) e^{-(t-T)/\\tau} $$\nSo, the solution for $t > T$ is an exponential decay starting from the pressure value at $t=T$.\n\n**4. Calculation of Required Quantities**\n\n-   **Value of $P(t)$ at $t=T$**: This is $P_1(T)$ as derived above.\n    $$ P(T) = \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2} \\left( 1 + e^{-T/\\tau} \\right) $$\n-   **Value of $P(t)$ at $t=2T$**: We use the solution for Phase 2, $P_2(t)$, with $t=2T$.\n    $$ P(2T) = P_1(T) e^{-(2T-T)/\\tau} = P_1(T) e^{-T/\\tau} $$\n-   **Maximum value of $P(t)$ over $[0, 2T]$**:\n    For $t > T$, the pressure $P_2(t)$ is a strictly decreasing function. Therefore, the maximum pressure over the full interval $[0, 2T]$ must occur within the systole interval $[0, T]$. To find the time of peak pressure, $t_{peak}$, we set the derivative $\\frac{dP_1(t)}{dt}$ to zero. From the original ODE:\n    $$ \\frac{dP_1(t)}{dt} = \\frac{1}{C}Q_{\\text{in}}(t) - \\frac{1}{\\tau}P_1(t) = 0 \\implies P_1(t_{peak}) = R Q_{\\text{in}}(t_{peak}) $$\n    Substituting the full expression for $P_1(t_{peak})$ and $Q_{\\text{in}}(t_{peak})$ into this condition leads to a transcendental equation for $t_{peak}$:\n    $$ \\frac{Q_0 R}{1+(\\omega\\tau)^2} \\left( \\omega\\tau e^{-t_{peak}/\\tau} + \\sin(\\omega t_{peak}) - \\omega\\tau \\cos(\\omega t_{peak}) \\right) = R Q_0 \\sin(\\omega t_{peak}) $$\n    After simplification, this becomes:\n    $$ e^{-t_{peak}/\\tau} = \\cos(\\omega t_{peak}) + \\omega\\tau \\sin(\\omega t_{peak}) $$\n    This equation must be solved numerically for $t_{peak}$ in the interval $(0, T]$. Note that $t=0$ is a trivial solution corresponding to a local minimum, as $P(0)=0$. Once $t_{peak}$ is found, the maximum pressure, $P_{max}$, can be calculated most simply using the condition derived from the derivative:\n    $$ P_{max} = P_1(t_{peak}) = R Q_{\\text{in}}(t_{peak}) = R Q_0 \\sin(\\omega t_{peak}) $$\n\n**Summary of a-priori algorithm**\nFor each given set of parameters $(Q_0, T, R, C)$:\n1.  Compute the constants $\\tau = RC$ and $\\omega = \\pi/T$.\n2.  Numerically solve the equation $f(t) = \\cos(\\omega t) + \\omega\\tau \\sin(\\omega t) - e^{-t/\\tau} = 0$ for its root $t_{peak}$ in the interval $(0, T]$.\n3.  Calculate the maximum pressure: $P_{max} = R Q_0 \\sin(\\omega t_{peak})$.\n4.  Calculate the pressure at time $T$: $P_T = \\frac{Q_0 R \\omega\\tau}{1+(\\omega\\tau)^2}(1 + e^{-T/\\tau})$.\n5.  Calculate the pressure at time $2T$: $P_{2T} = P_T e^{-T/\\tau}$.\n6.  Round the three results ($P_{max}, P_T, P_{2T}$) to $6$ decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the two-element Windkessel model problem for a given set of test cases.\n\n    The function implements the closed-form analytical solutions for arterial pressure\n    P(t) derived from the model's governing differential equation.\n    \n    The pressure P(t) is described by:\n    - Phase 1 (0 <= t <= T): A non-homogeneous ODE solution with sinusoidal input.\n    - Phase 2 (t > T): A homogeneous ODE solution representing exponential decay.\n    \n    The algorithm computes three specific quantities for each test case:\n    1. P_max: The maximum pressure over [0, 2T]. This requires numerically\n       finding the time of peak pressure (t_peak) by solving a transcendental\n       equation, and then calculating P(t_peak).\n    2. P(T): The pressure at the end of the systolic phase.\n    3. P(2T): The pressure at time 2T, during the diastolic decay.\n    \"\"\"\n    \n    # Test cases: (Q0, T, R, C)\n    # Q0: ml/s\n    # T: s\n    # R: mmHg*s/ml\n    # C: ml/mmHg\n    test_cases = [\n        (200.0, 0.3, 1.0, 2.0),\n        (200.0, 0.3, 1.0, 0.5),\n        (200.0, 0.3, 0.5, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Q0, T, R, C = case\n\n        # Calculate model constants\n        tau = R * C  # Windkessel time constant (s)\n        omega = np.pi / T  # Angular frequency of inflow (rad/s)\n        w_tau = omega * tau\n\n        # --- Calculate Maximum Pressure (P_max) ---\n        \n        # The peak pressure occurs at t_peak where dP/dt = 0.\n        # This leads to the transcendental equation for t_peak:\n        # exp(-t/tau) = cos(omega*t) + omega*tau*sin(omega*t)\n        # We find the root of h(t) = 0 to get t_peak.\n        def h(t):\n            return np.cos(omega * t) + w_tau * np.sin(omega * t) - np.exp(-t / tau)\n\n        # The root must be in (0, T]. We search in a small offset from 0\n        # to avoid the trivial root at t=0, which is a local minimum.\n        try:\n            t_peak = brentq(h, 1e-9, T)\n        except ValueError:\n            # If h(T) has the same sign as h(1e-9), the peak might be exactly at T.\n            # However, h(T) = -1 - exp(-T/tau) which is always negative.\n            # h(t->0+) is positive. So a root must exist. This is a safeguard.\n            t_peak = T\n\n        # At the peak, P(t_peak) simplifies to R * Q_in(t_peak)\n        p_max = R * Q0 * np.sin(omega * t_peak)\n\n        # --- Calculate Pressure at t=T (p_T) ---\n        # P(T) = (Q0 * R * w_tau / (1 + w_tau^2)) * (1 + exp(-T/tau))\n        p_T_numerator = Q0 * R * w_tau * (1 + np.exp(-T / tau))\n        p_T_denominator = 1 + w_tau**2\n        p_T = p_T_numerator / p_T_denominator\n        \n        # --- Calculate Pressure at t=2T (p_2T) ---\n        # P(2T) = P(T) * exp(-T/tau)\n        p_2T = p_T * np.exp(-T / tau)\n\n        # Append rounded results to the list\n        results.extend([\n            round(p_max, 6),\n            round(p_T, 6),\n            round(p_2T, 6)\n        ])\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "While the two-element model explains the general shape of the pressure waveform, it fails to capture higher-frequency details like the dicrotic notch. This advanced practice demonstrates a core principle of model development: identifying a model's limitations and strategically adding complexity to improve its fidelity. By introducing a three-element Windkessel model, which includes a characteristic impedance ($Z_0$), you will investigate how this added component allows the model to better represent the sharp pressure fluctuations associated with aortic valve closure .",
            "id": "3938519",
            "problem": "A flow-driven derivation and simulation problem on the Windkessel representation of arterial blood pressure. Consider a lumped-parameter arterial segment modeled either as a two-element Windkessel (a peripheral resistance and a compliance in parallel) or as a three-element Windkessel (a proximal characteristic impedance in series with the parallel combination of a peripheral resistance and a compliance). Use the following foundational laws as the starting point: conservation of mass and the linear hydraulic relation between pressure and flow analogous to Ohm’s law. Specifically, for a compliant chamber with pressure $p(t)$ and compliance $C$ subject to an inflow $q_{\\text{in}}(t)$ and an outflow $q_{\\text{out}}(t)$, conservation of mass states $C \\,\\dfrac{dp}{dt} = q_{\\text{in}}(t) - q_{\\text{out}}(t)$. The linear hydraulic relation for a resistor of value $R$ states $p = R\\,q$ across that resistor, where $p$ is the pressure drop and $q$ is the flow through it, with the downstream reference pressure taken as zero.\n\nYou are given a physiologically plausible inflow waveform $q_{\\text{in}}(t)$ consisting of a systolic component and a brief negative impulse intended to mimic the dicrotic notch event associated with aortic valve closure:\n- The systolic component is a half-sine of peak $Q_{\\max}$ over the interval $t \\in [0, T_s]$, specifically $q_{\\text{sys}}(t) = Q_{\\max}\\,\\sin\\!\\left(\\pi t/T_s\\right)$ for $0 \\le t \\le T_s$ and $q_{\\text{sys}}(t) = 0$ otherwise.\n- The notch component is a negative Gaussian impulse centered at time $t_n$ with standard deviation $\\sigma$ and peak magnitude $A_{\\text{imp}}$, specifically $q_{\\text{notch}}(t) = -A_{\\text{imp}} \\exp\\!\\left(-\\dfrac{(t - t_n)^2}{2 \\sigma^2}\\right)$.\n- The total inflow is $q_{\\text{in}}(t) = q_{\\text{sys}}(t) + q_{\\text{notch}}(t)$.\n\nModel the two systems as follows, starting from the above base and definitions, without assuming any further shortcut formulas:\n- Two-element Windkessel: A peripheral resistance $R$ in parallel with a compliance $C$. Let $p_a(t)$ denote the arterial pressure across the compliance. The outflow is $q_{\\text{out}}(t) = \\dfrac{p_a(t)}{R}$. The observed pressure at the inlet equals $p_{\\text{in,2}}(t) = p_a(t)$.\n- Three-element Windkessel (Resistive–Compliant–Resistive (RCR)): A proximal characteristic impedance $Z_0$ in series with a parallel network of the same $R$ and $C$. The same mass balance governs $p_a(t)$, and the observed inlet pressure is $p_{\\text{in,3}}(t) = p_a(t) + Z_0\\,q_{\\text{in}}(t)$.\n\nImplement a time-domain simulator that numerically integrates the ordinary differential equation for $p_a(t)$ under the given $q_{\\text{in}}(t)$ using a fixed time step $\\Delta t$ from $t=0$ to $t=T_{\\text{end}}$, with initial condition $p_a(0) = p_0$. All physical units must be consistent: pressure in millimeters of mercury (mmHg), time in seconds (s), flow in milliliters per second (mL/s), resistance and characteristic impedance in $\\text{mmHg}\\cdot\\text{s}/\\text{mL}$, and compliance in $\\text{mL}/\\text{mmHg}$.\n\nDefine the dicrotic notch amplitude in an observed inlet pressure trace $p_{\\text{obs}}(t)$ as follows. Let the notch analysis window be $[t_n - \\Delta_1, t_n + \\Delta_2]$ with pre-notch baseline subwindow $[t_n - \\Delta_1, t_n - \\delta]$ and post-notch search subwindow $[t_n, t_n + \\Delta_2]$, where $\\Delta_1 > \\delta > 0$ and $\\Delta_2 > 0$. Let $p_{\\text{base}}$ be the average of $p_{\\text{obs}}(t)$ over $[t_n - \\Delta_1, t_n - \\delta]$, and let $p_{\\min}$ be the minimum of $p_{\\text{obs}}(t)$ over $[t_n, t_n + \\Delta_2]$. The notch amplitude is $A_{\\text{notch}} = p_{\\text{base}} - p_{\\min}$, expressed in millimeters of mercury (mmHg). You must compute $A_{\\text{notch,2}}$ from $p_{\\text{in,2}}(t)$ and $A_{\\text{notch,3}}$ from $p_{\\text{in,3}}(t)$.\n\nYour task is to:\n1. Derive the governing ordinary differential equation from the stated foundational laws for $p_a(t)$ under the given $q_{\\text{in}}(t)$, for both the two-element and three-element systems.\n2. Implement a numerical simulator that computes $p_{\\text{in,2}}(t)$ and $p_{\\text{in,3}}(t)$ and then evaluates $A_{\\text{notch,2}}$ and $A_{\\text{notch,3}}$ for a set of test cases.\n3. For each test case, produce one scalar result as specified below. You must express any pressure amplitude in millimeters of mercury (mmHg), rounded to six decimal places. Any inequality check must be returned as a boolean.\n\nUse the following fixed simulation and analysis settings unless overridden in a specific test case: time step $\\Delta t = 10^{-4}\\,\\text{s}$, end time $T_{\\text{end}} = 1.0\\,\\text{s}$, initial pressure $p_0 = 80.0\\,\\text{mmHg}$, systolic duration $T_s = 0.3\\,\\text{s}$, notch center time $t_n = 0.31\\,\\text{s}$, pre-notch window parameters $\\Delta_1 = 0.015\\,\\text{s}$ and $\\delta = 0.005\\,\\text{s}$, and post-notch window parameter $\\Delta_2 = 0.020\\,\\text{s}$.\n\nUse the following test suite. Each test case specifies $(R, C, Z_0, Q_{\\max}, A_{\\text{imp}}, \\sigma)$ in consistent units as described above:\n- Test case $1$ (boundary consistency when $Z_0 = 0$): $(1.2, 1.5, 0.0, 300.0, 20.0, 0.004)$. Output the absolute difference $|A_{\\text{notch,3}} - A_{\\text{notch,2}}|$ in mmHg, rounded to six decimal places.\n- Test case $2$ (basic enhancement by three-element): $(1.2, 1.5, 0.15, 300.0, 20.0, 0.004)$. Output a boolean for the inequality $A_{\\text{notch,3}} > A_{\\text{notch,2}}$.\n- Test case $3$ (scaling with impulse magnitude): Compute two scenarios with identical $(R, C, Z_0, Q_{\\max}, \\sigma)$ equal to $(1.2, 1.5, 0.15, 300.0, 0.004)$ but different $A_{\\text{imp}}$ values $20.0$ and $40.0$. Output a boolean for the inequality $\\left(A_{\\text{notch,3}} - A_{\\text{notch,2}}\\right)\\big|_{A_{\\text{imp}}=40.0} > \\left(A_{\\text{notch,3}} - A_{\\text{notch,2}}\\right)\\big|_{A_{\\text{imp}}=20.0}$.\n- Test case $4$ (scaling with proximal characteristic impedance): Compute two scenarios with identical $(R, C, Q_{\\max}, A_{\\text{imp}}, \\sigma)$ equal to $(1.2, 1.5, 300.0, 25.0, 0.004)$ but different $Z_0$ values $0.05$ and $0.20$. Output a boolean for the inequality $\\left(A_{\\text{notch,3}} - A_{\\text{notch,2}}\\right)\\big|_{Z_0=0.20} > \\left(A_{\\text{notch,3}} - A_{\\text{notch,2}}\\right)\\big|_{Z_0=0.05}$.\n- Test case $5$ (sensitivity to notch duration): Compute two scenarios with identical $(R, C, Z_0, Q_{\\max}, A_{\\text{imp}})$ equal to $(1.2, 1.5, 0.15, 300.0, 30.0)$ but different $\\sigma$ values $0.002$ and $0.008$. Output a boolean for the inequality $\\left(A_{\\text{notch,3}} - A_{\\text{notch,2}}\\right)\\big|_{\\sigma=0.002} > \\left(A_{\\text{notch,3}} - A_{\\text{notch,2}}\\right)\\big|_{\\sigma=0.008}$.\n\nYour program should produce a single line of output containing the results for tests $1$ through $5$ as a comma-separated list enclosed in square brackets, in order: $[r_1,r_2,r_3,r_4,r_5]$, where $r_1$ is a float in millimeters of mercury (mmHg) rounded to six decimal places, and $r_2$ through $r_5$ are booleans.",
            "solution": "The problem requires the derivation of the governing ordinary differential equation (ODE) for arterial pressure in two- and three-element Windkessel models, followed by a numerical simulation to analyze the dicrotic notch characteristics under a specified inflow waveform. The derivation and simulation procedure are detailed below.\n\n### I. Derivation of the Governing Differential Equation\n\nThe problem provides the foundational laws for a lumped-parameter hydraulic circuit. The conservation of mass for a compliant element is given by:\n$$\nC \\frac{dp_a(t)}{dt} = q_{\\text{in}}(t) - q_{\\text{out}}(t)\n$$\nwhere $p_a(t)$ is the pressure across the compliance $C$, $q_{\\text{in}}(t)$ is the inflow, and $q_{\\text{out}}(t)$ is the outflow.\n\nThe hydraulic equivalent of Ohm's law for a resistor $R$ with a downstream pressure of zero is:\n$$\np_a(t) = R \\cdot q_{\\text{out}}(t)\n$$\nThis relation is valid because the peripheral resistance $R$ is in parallel with the compliance $C$, meaning the pressure drop across both elements is the same, $p_a(t)$.\n\nFrom Ohm's law, we can express the outflow $q_{\\text{out}}(t)$ as:\n$$\nq_{\\text{out}}(t) = \\frac{p_a(t)}{R}\n$$\n\nSubstituting this expression for $q_{\\text{out}}(t)$ into the conservation of mass equation yields:\n$$\nC \\frac{dp_a(t)}{dt} = q_{\\text{in}}(t) - \\frac{p_a(t)}{R}\n$$\n\nTo obtain the standard form of a first-order linear ODE, we rearrange the terms:\n$$\n\\frac{dp_a(t)}{dt} + \\frac{1}{RC} p_a(t) = \\frac{1}{C} q_{\\text{in}}(t)\n$$\n\nThis ODE governs the pressure $p_a(t)$ in the compliant element. It is crucial to note that this equation is identical for both the two-element and three-element Windkessel models as specified. The distinction between the models lies in the definition of the *observed* inlet pressure.\n\nThe inflow $q_{\\text{in}}(t)$ is the sum of a systolic component $q_{\\text{sys}}(t)$ and a notch component $q_{\\text{notch}}(t)$:\n$$\nq_{\\text{in}}(t) = q_{\\text{sys}}(t) + q_{\\text{notch}}(t)\n$$\nwhere\n$$\nq_{\\text{sys}}(t) = \n\\begin{cases} \nQ_{\\max}\\sin\\left(\\frac{\\pi t}{T_s}\\right) & \\text{for } 0 \\le t \\le T_s \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nand\n$$\nq_{\\text{notch}}(t) = -A_{\\text{imp}} \\exp\\left(-\\frac{(t - t_n)^2}{2 \\sigma^2}\\right)\n$$\n\nThe observed inlet pressures for the two models are:\n-   **Two-element model**: The inlet pressure is simply the pressure across the parallel RC circuit.\n    $$\n    p_{\\text{in,2}}(t) = p_a(t)\n    $$\n-   **Three-element model**: The inlet pressure is the sum of the pressure across the parallel RC circuit and the pressure drop across the proximal characteristic impedance $Z_0$.\n    $$\n    p_{\\text{in,3}}(t) = p_a(t) + Z_0 \\cdot q_{\\text{in}}(t)\n    $$\n\n### II. Numerical Simulation and Analysis\n\nThe problem is an initial value problem, with the ODE for $p_a(t)$ and the initial condition $p_a(0) = p_0$. We will solve this numerically using the forward Euler method, consistent with the specified fixed time step $\\Delta t$.\n\nThe derivative $\\frac{dp_a}{dt}$ can be written as:\n$$\n\\frac{dp_a}{dt} = f(t, p_a) = \\frac{1}{C} q_{\\text{in}}(t) - \\frac{1}{RC} p_a(t)\n$$\n\nThe forward Euler update rule for a time step from $t_i$ to $t_{i+1} = t_i + \\Delta t$ is:\n$$\np_a(t_{i+1}) \\approx p_a(t_i) + \\Delta t \\cdot f(t_i, p_a(t_i))\n$$\nSubstituting the expression for $f(t_i, p_a(t_i))$, we get the discrete-time update equation:\n$$\np_a(t_{i+1}) = p_a(t_i) + \\Delta t \\left( \\frac{1}{C} q_{\\text{in}}(t_i) - \\frac{1}{RC} p_a(t_i) \\right)\n$$\nThis can be rearranged for computational efficiency:\n$$\np_a(t_{i+1}) = p_a(t_i) \\left(1 - \\frac{\\Delta t}{RC}\\right) + \\frac{\\Delta t}{C} q_{\\text{in}}(t_i)\n$$\n\nThe simulation proceeds as follows:\n1.  Discretize the time axis from $t=0$ to $t=T_{\\text{end}}$ with a step of $\\Delta t$. Let the time points be $t_i = i \\cdot \\Delta t$.\n2.  Pre-compute the inflow vector $q_{\\text{in}}(t_i)$ for all time points $t_i$.\n3.  Initialize the pressure vector $p_a$ with $p_a(t_0=0) = p_0$.\n4.  Iteratively compute $p_a(t_{i+1})$ for $i=0, 1, 2, \\dots$ using the Euler update rule until the end of the time interval.\n5.  Once the time series for $p_a(t)$ is computed, calculate the observed pressure traces $p_{\\text{in,2}}(t)$ and $p_{\\text{in,3}}(t)$ using their respective definitions.\n\n### III. Dicrotic Notch Amplitude Calculation\n\nThe dicrotic notch amplitude, $A_{\\text{notch}}$, is calculated from an observed pressure trace $p_{\\text{obs}}(t)$ (which will be either $p_{\\text{in,2}}(t)$ or $p_{\\text{in,3}}(t)$).\n1.  Define the pre-notch baseline window as $[t_n - \\Delta_1, t_n - \\delta]$. The baseline pressure, $p_{\\text{base}}$, is the average of $p_{\\text{obs}}(t)$ within this window.\n2.  Define the post-notch search window as $[t_n, t_n + \\Delta_2]$. The minimum pressure, $p_{\\min}$, is the minimum value of $p_{\\text{obs}}(t)$ within this window.\n3.  The notch amplitude is the difference: $A_{\\text{notch}} = p_{\\text{base}} - p_{\\min}$.\n\nThis entire procedure—simulation and analysis—is encapsulated in a function that takes the model and simulation parameters as input. This function is then called for each of the five test cases to compute the specified results.\n\nFor Test Case $1$, where $Z_0=0.0$, we expect $p_{\\text{in,3}}(t) = p_a(t) + 0.0 \\cdot q_{\\text{in}}(t) = p_a(t) = p_{\\text{in,2}}(t)$. Consequently, their notch amplitudes $A_{\\text{notch,3}}$ and $A_{\\text{notch,2}}$ must be identical, and their absolute difference should be zero (or a value very close to zero due to finite floating-point precision). This serves as a validation of the implementation logic.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Windkessel model simulations for all test cases.\n    \"\"\"\n\n    def simulate_and_analyze(R, C, Z0, Q_max, A_imp, sigma):\n        \"\"\"\n        Performs a single simulation run for given parameters and calculates notch amplitudes.\n\n        Args:\n            R (float): Peripheral resistance (mmHg*s/mL).\n            C (float): Arterial compliance (mL/mmHg).\n            Z0 (float): Characteristic impedance (mmHg*s/mL).\n            Q_max (float): Peak systolic flow (mL/s).\n            A_imp (float): Peak magnitude of the negative notch impulse (mL/s).\n            sigma (float): Standard deviation of the Gaussian notch impulse (s).\n\n        Returns:\n            tuple[float, float]: A tuple containing the notch amplitudes for the 2-element\n                                 and 3-element models (A_notch_2, A_notch_3).\n        \"\"\"\n        # Fixed simulation and analysis parameters\n        dt = 1e-4          # s\n        T_end = 1.0        # s\n        p0 = 80.0          # mmHg\n        Ts = 0.3           # s\n        tn = 0.31          # s\n        delta1 = 0.015     # s\n        delta_ = 0.005     # s\n        delta2 = 0.020     # s\n\n        # Time vector\n        t = np.arange(0, T_end, dt)\n        num_steps = len(t)\n\n        # Inflow q_in(t) calculation\n        q_sys = np.zeros(num_steps)\n        systolic_indices = t <= Ts\n        q_sys[systolic_indices] = Q_max * np.sin(np.pi * t[systolic_indices] / Ts)\n        q_notch = -A_imp * np.exp(-((t - tn)**2) / (2 * sigma**2))\n        q_in = q_sys + q_notch\n\n        # Numerical integration using Forward Euler method\n        pa = np.zeros(num_steps)\n        pa[0] = p0\n\n        # Pre-calculate constants for the loop\n        # pa[i+1] = pa[i] * (1 - dt/(R*C)) + (dt/C) * q_in[i]\n        euler_coeff_p = 1 - dt / (R * C)\n        euler_coeff_q = dt / C\n        \n        for i in range(num_steps - 1):\n            pa[i+1] = pa[i] * euler_coeff_p + euler_coeff_q * q_in[i]\n\n        # Calculate observed pressures for 2-element and 3-element models\n        p_in2 = pa\n        p_in3 = pa + Z0 * q_in\n\n        # Function to calculate notch amplitude\n        def calculate_notch_amplitude(p_obs):\n            # Find indices for analysis windows\n            idx_tn = np.searchsorted(t, tn)\n            idx_pre_start = np.searchsorted(t, tn - delta1)\n            idx_pre_end = np.searchsorted(t, tn - delta_)\n            idx_post_end = np.searchsorted(t, tn + delta2)\n\n            # Calculate p_base and p_min\n            p_base = np.mean(p_obs[idx_pre_start : idx_pre_end])\n            p_min = np.min(p_obs[idx_tn : idx_post_end])\n            \n            return p_base - p_min\n\n        A_notch_2 = calculate_notch_amplitude(p_in2)\n        A_notch_3 = calculate_notch_amplitude(p_in3)\n\n        return A_notch_2, A_notch_3\n\n    results = []\n\n    # Test Case 1: Boundary consistency when Z0 = 0\n    R, C, Z0, Q_max, A_imp, sigma = (1.2, 1.5, 0.0, 300.0, 20.0, 0.004)\n    A2, A3 = simulate_and_analyze(R, C, Z0, Q_max, A_imp, sigma)\n    results.append(round(abs(A3 - A2), 6))\n\n    # Test Case 2: Basic enhancement by three-element model\n    R, C, Z0, Q_max, A_imp, sigma = (1.2, 1.5, 0.15, 300.0, 20.0, 0.004)\n    A2, A3 = simulate_and_analyze(R, C, Z0, Q_max, A_imp, sigma)\n    results.append(A3 > A2)\n    \n    # Test Case 3: Scaling with impulse magnitude\n    R, C, Z0, Q_max, sigma = (1.2, 1.5, 0.15, 300.0, 0.004)\n    A_imp_1, A_imp_2 = 20.0, 40.0\n    A2_1, A3_1 = simulate_and_analyze(R, C, Z0, Q_max, A_imp_1, sigma)\n    A2_2, A3_2 = simulate_and_analyze(R, C, Z0, Q_max, A_imp_2, sigma)\n    diff_1 = A3_1 - A2_1\n    diff_2 = A3_2 - A2_2\n    results.append(diff_2 > diff_1)\n\n    # Test Case 4: Scaling with proximal characteristic impedance\n    R, C, Q_max, A_imp, sigma = (1.2, 1.5, 300.0, 25.0, 0.004)\n    Z0_1, Z0_2 = 0.05, 0.20\n    A2_1, A3_1 = simulate_and_analyze(R, C, Z0_1, Q_max, A_imp, sigma)\n    A2_2, A3_2 = simulate_and_analyze(R, C, Z0_2, Q_max, A_imp, sigma)\n    diff_1 = A3_1 - A2_1\n    diff_2 = A3_2 - A2_2\n    results.append(diff_2 > diff_1)\n\n    # Test Case 5: Sensitivity to notch duration\n    R, C, Z0, Q_max, A_imp = (1.2, 1.5, 0.15, 300.0, 30.0)\n    sigma_1, sigma_2 = 0.002, 0.008\n    A2_1, A3_1 = simulate_and_analyze(R, C, Z0, Q_max, A_imp, sigma_1) # sigma = 0.002\n    A2_2, A3_2 = simulate_and_analyze(R, C, Z0, Q_max, A_imp, sigma_2) # sigma = 0.008\n    diff_1 = A3_1 - A2_1\n    diff_2 = A3_2 - A2_2\n    results.append(diff_1 > diff_2) # inequality is (A_3-A_2)|sigma=0.002 > (A_3-A_2)|sigma=0.008\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}