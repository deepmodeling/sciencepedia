{
    "hands_on_practices": [
        {
            "introduction": "掌握一个数学模型的精髓，不仅仅是记忆其方程，更在于能够分析、求解和模拟它。一个有效理解复杂模型的方法，是在简化的、可控的条件下进行分析。本练习通过设定胰岛素水平恒定，将最小模型简化，使我们能够专注于葡萄糖自身动态，从而推导出葡萄糖衰减的精确解析解。通过这个过程，你将能深刻理解模型参数 $p_1$（葡萄糖有效性）的生理意义，并为更复杂的分析打下坚实的基础。",
            "id": "3937932",
            "problem": "一名受试者接受正常血糖-基础胰岛素钳夹技术，因此血浆胰岛素在所有 $t \\ge 0$ 的时间内都维持在基础水平 $I(t)=I_{b}$。在时间 $t=0$ 时，血浆葡萄糖浓度 $G(t)$ 因一次小剂量推注而受到扰动，使其升高至高于基础血糖 $G_{b}$ 的 $G(0)=G_{b}+\\Delta G$ 水平，此后在 $t>0$ 的时间内没有外源葡萄糖输入，即 $u_{G}(t)=0$。假设其动态遵循 Bergman 葡萄糖-胰岛素调节最小模型，其中胰岛素作用室 $X(t)$ 和葡萄糖 $G(t)$ 满足以下质量平衡方程\n$$\\frac{dX}{dt}=-p_{2}X+p_{3}\\big(I(t)-I_{b}\\big), \\quad X(0)=0,$$\n$$\\frac{dG}{dt}=-\\big(p_{1}+X(t)\\big)\\big(G(t)-G_{b}\\big)+u_{G}(t),$$\n其中参数 $p_{1}>0$、$p_{2}>0$ 和 $p_{3}>0$ 严格为正。基于这些假设，并从该最小模型所体现的质量平衡和一级动力学出发，推导 $t \\ge 0$ 时 $G(t)$ 的闭式解，然后确定葡萄糖衰减的半衰期 $T_{1/2}$，半衰期定义为满足 $G(T_{1/2})-G_{b}=\\frac{1}{2}\\Delta G$ 的时间 $T_{1/2}>0$。将 $T_{1/2}$ 以分钟为单位，用 $p_{1}$ 的符号表示，并以解析表达式的形式提供最终答案。不需要数值，也无需四舍五入。",
            "solution": "用户提供了一个关于在特定实验条件下 Bergman 葡萄糖-胰岛素调节最小模型的问题。第一步是验证问题陈述。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n-   **模型方程**:\n    $$ \\frac{dX}{dt}=-p_{2}X+p_{3}\\big(I(t)-I_{b}\\big) $$\n    $$ \\frac{dG}{dt}=-\\big(p_{1}+X(t)\\big)\\big(G(t)-G_{b}\\big)+u_{G}(t) $$\n-   **参数**: $p_{1}>0$, $p_{2}>0$, $p_{3}>0$。\n-   **初始条件**: $X(0)=0$, $G(0)=G_{b}+\\Delta G$。\n-   **强迫函数**:\n    -   正常血糖-基础胰岛素钳夹: $I(t)=I_{b}$ for $t \\ge 0$。\n    -   外源葡萄糖输入: $u_{G}(t)=0$ for $t > 0$。\n-   **定义**: $G(t)$ 是血浆葡萄糖，$G_b$ 是基础血糖，$I(t)$ 是血浆胰岛素，$I_b$ 是基础胰岛素，$X(t)$ 是胰岛素作用，$\\Delta G$ 是葡萄糖扰动。\n-   **目标**:\n    1.  推导 $t \\ge 0$ 时 $G(t)$ 的闭式解。\n    2.  确定葡萄糖衰减的半衰期 $T_{1/2}$，其定义为 $G(T_{1/2})-G_{b}=\\frac{1}{2}\\Delta G$。\n    3.  用 $p_{1}$ 的符号表示 $T_{1/2}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它使用了定量内分泌学的基石——广为接受的 Bergman 最小模型。实验设置，即带有初始葡萄糖推注的正常血糖钳夹，在生理上是合理的，在数学上是明确定义的。这个问题是适定的，提供了一个带有一阶常微分方程组、充分的初始条件和指定的强迫函数，从而保证了解的唯一性。语言客观而精确。参数被约束为正，这与其生理意义一致。该问题是自洽的，不存在矛盾。这项任务是求解常微分方程组的一个标准练习，既不平凡也不适定。\n\n**步骤 3：结论与行动**\n问题有效。将推导解答。\n\n**解的推导**\n\n该方程组描述了胰岛素作用 $X(t)$ 和血浆葡萄糖浓度 $G(t)$ 的动态。我们将依次求解这些方程。\n\n首先，我们求解胰岛素作用 $X(t)$。其控制方程为：\n$$ \\frac{dX}{dt}=-p_{2}X+p_{3}\\big(I(t)-I_{b}\\big) $$\n问题陈述，应用了正常血糖-基础胰岛素钳夹技术，这意味着血浆胰岛素浓度在所有 $t \\ge 0$ 的时间内都恒定在其基础水平，即 $I(t)=I_{b}$。将此条件代入 $X(t)$ 的方程中，得到：\n$$ \\frac{dX}{dt}=-p_{2}X+p_{3}\\big(I_{b}-I_{b}\\big) $$\n$$ \\frac{dX}{dt}=-p_{2}X $$\n这是一个一阶线性齐次常微分方程。其通解形式为 $X(t) = C \\exp(-p_{2}t)$，其中 $C$ 是一个积分常数。我们使用初始条件 $X(0)=0$ 来确定 $C$：\n$$ X(0) = C \\exp(-p_{2} \\cdot 0) = C \\cdot 1 = C $$\n给定 $X(0)=0$，我们有 $C=0$。因此，胰岛素作用的解为：\n$$ X(t) = 0 \\quad \\text{for all } t \\ge 0 $$\n这个结果表明，由于胰岛素水平没有偏离其基础值，因此没有刺激导致胰岛素作用在远端室中累积。\n\n接下来，我们求解血浆葡萄糖浓度 $G(t)$。其控制方程为：\n$$ \\frac{dG}{dt}=-\\big(p_{1}+X(t)\\big)\\big(G(t)-G_{b}\\big)+u_{G}(t) $$\n对于 $t > 0$，我们代入已知函数 $X(t)=0$ 和 $u_{G}(t)=0$：\n$$ \\frac{dG}{dt}=-\\big(p_{1}+0\\big)\\big(G(t)-G_{b}\\big)+0 $$\n$$ \\frac{dG}{dt}=-p_{1}\\big(G(t)-G_{b}\\big) $$\n为了简化求解过程，我们定义一个新变量 $g(t)$，表示葡萄糖与其基础水平的偏差：\n$$ g(t) = G(t) - G_{b} $$\n由于 $G_b$ 是一个常数，$g(t)$ 对时间的导数为 $\\frac{dg}{dt} = \\frac{dG}{dt}$。将 $g(t)$ 及其导数代入 $G(t)$ 的方程中，得到：\n$$ \\frac{dg}{dt} = -p_{1} g(t) $$\n这又是一个一阶线性齐次常微分方程。其通解为 $g(t) = A \\exp(-p_{1}t)$，其中 $A$ 是积分常数。我们使用葡萄糖的初始条件来确定 $A$。在 $t=0$ 时：\n$$ g(0) = G(0) - G_{b} $$\n问题陈述 $G(0)=G_{b}+\\Delta G$，所以：\n$$ g(0) = (G_{b}+\\Delta G) - G_b = \\Delta G $$\n使用 $g(t)$ 的这个初始条件：\n$$ g(0) = A \\exp(-p_{1} \\cdot 0) = A \\cdot 1 = A $$\n因此，$A = \\Delta G$。葡萄糖偏差的解为：\n$$ g(t) = \\Delta G \\exp(-p_{1}t) $$\n最后，我们代回原式以求得 $G(t)$ 的闭式解：\n$$ G(t) = g(t) + G_{b} = G_{b} + \\Delta G \\exp(-p_{1}t) $$\n这就是 $t \\ge 0$ 时 $G(t)$ 的完整解。\n\n最后一项任务是确定葡萄糖衰减的半衰期 $T_{1/2}$。半衰期由条件 $G(T_{1/2})-G_{b}=\\frac{1}{2}\\Delta G$ 定义。使用我们的变量 $g(t)=G(t)-G_b$，该条件变为：\n$$ g(T_{1/2}) = \\frac{1}{2}\\Delta G $$\n我们代入我们推导出的 $g(t)$ 表达式：\n$$ \\Delta G \\exp(-p_{1}T_{1/2}) = \\frac{1}{2}\\Delta G $$\n假设初始扰动非零，即 $\\Delta G \\neq 0$，我们可以将两边同除以 $\\Delta G$：\n$$ \\exp(-p_{1}T_{1/2}) = \\frac{1}{2} $$\n为了求解 $T_{1/2}$，我们对两边取自然对数：\n$$ \\ln\\big(\\exp(-p_{1}T_{1/2})\\big) = \\ln\\left(\\frac{1}{2}\\right) $$\n$$ -p_{1}T_{1/2} = -\\ln(2) $$\n两边乘以 $-1$ 并除以 $p_{1}$（$p_{1}$ 严格为正），我们得到半衰期的表达式：\n$$ T_{1/2} = \\frac{\\ln(2)}{p_{1}} $$\n在 Bergman 最小模型中，参数 $p_{1}$ 的单位是时间的倒数（例如，$\\text{min}^{-1}$），因此 $T_{1/2}$ 的表达式按要求正确地得出了时间单位（例如，分钟）。该半衰期仅由葡萄糖有效性参数 $p_1$ 决定，因为实验中的钳夹条件消除了任何动态胰岛素作用。\n\n两个所需的解析表达式是 $G(t)$ 的解和 $T_{1/2}$ 的公式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nG_{b} + \\Delta G \\exp(-p_{1}t) \\\\ \\frac{\\ln(2)}{p_{1}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "生理系统，如葡萄糖调节，通常围绕一个稳态（如空腹状态）运行。由于最小模型本质上是非线性的，直接求解非常困难，因此在稳态点附近进行线性化是分析其动态行为的核心技术。本练习将指导你推导系统在基础平衡点附近的雅可比矩阵，该矩阵描述了系统的局部动态特性。通过分析其特征值，你可以判断系统是否稳定，这直接关联到生理学中至关重要的“内稳态”概念。",
            "id": "3937941",
            "problem": "考虑描述葡萄糖浓度和胰岛素作用的葡萄糖-胰岛素调节最小模型的经典双态子系统。令 $G(t)$ 表示血浆葡萄糖浓度，$X(t)$ 表示胰岛素对葡萄糖处置的作用。公认的基础葡萄糖浓度为 $G_{b}$，公认的基础胰岛素浓度为 $I_{b}$。模型参数 $p_{1}$、$p_{2}$ 和 $p_{3}$ 是正的且不随时间变化。在没有外源葡萄糖输入且胰岛素处于基础水平时，葡萄糖动力学和胰岛素作用动力学满足以下广泛使用的关系：\n$$\\frac{dG}{dt} = -\\left(p_{1} + X\\right)G + p_{1} G_{b},$$\n$$\\frac{dX}{dt} = -p_{2} X + p_{3}\\left(I - I_{b}\\right),$$\n其中 $I(t)$ 表示血浆胰岛素浓度。定义葡萄糖偏差变量 $\\tilde{G}(t) \\equiv G(t) - G_{b}$。在基础平衡状态下，取 $I(t) = I_{b}$ 并假设没有外源葡萄糖输入。仅使用这些基本关系和偏差变量的定义，推导状态向量 $\\left(\\tilde{G}, X\\right)$ 的自治动力学，确定基础平衡点 $\\left(\\tilde{G}, X\\right)$，并计算在该基础平衡点处得到的 $\\left(\\tilde{G}, X\\right)$ 动力学的雅可比矩阵。然后，根据参数 $p_{1}$ 和 $p_{2}$ 讨论该雅可比矩阵的特征值，包括它们的符号以及对局部稳定性的任何影响。将您的最终答案表示为在基础平衡点处计算的符号雅可比矩阵。不要为任何参数代入数值。",
            "solution": "该问题要求分析葡萄糖-胰岛素调节最小模型的一个双态子系统。分析过程包括转换状态变量，找到转换后系统的平衡点，计算该平衡点处的雅可比矩阵，并讨论其特征值以及对系统稳定性的影响。\n\n给定的系统动力学为：\n$$ \\frac{dG}{dt} = -\\left(p_{1} + X\\right)G + p_{1} G_{b} $$\n$$ \\frac{dX}{dt} = -p_{2} X + p_{3}\\left(I - I_{b}\\right) $$\n其中 $G(t)$ 是血浆葡萄糖浓度，$X(t)$ 是胰岛素作用，$I(t)$ 是血浆胰岛素浓度，$p_{1}, p_{2}, p_{3}, G_{b}, I_{b}$ 是正常数。\n\n首先，我们推导状态向量 $(\\tilde{G}, X)$ 的动力学，其中 $\\tilde{G}(t)$ 是葡萄糖相对于基础水平的偏差，定义为 $\\tilde{G}(t) \\equiv G(t) - G_{b}$。根据该定义，我们有 $G(t) = \\tilde{G}(t) + G_{b}$。由于 $G_{b}$ 是一个常数，$\\tilde{G}(t)$ 的时间导数为 $\\frac{d\\tilde{G}}{dt} = \\frac{dG}{dt}$。\n\n我们将 $G(t) = \\tilde{G}(t) + G_{b}$ 代入第一个微分方程：\n$$ \\frac{d\\tilde{G}}{dt} = -\\left(p_{1} + X\\right)\\left(\\tilde{G} + G_{b}\\right) + p_{1} G_{b} $$\n展开右侧的项得到：\n$$ \\frac{d\\tilde{G}}{dt} = -p_{1}\\tilde{G} - p_{1}G_{b} - X\\tilde{G} - XG_{b} + p_{1} G_{b} $$\n项 $-p_{1}G_{b}$ 和 $+p_{1}G_{b}$ 相互抵消，得到：\n$$ \\frac{d\\tilde{G}}{dt} = -p_{1}\\tilde{G} - X\\tilde{G} - XG_{b} $$\n这可以写成：\n$$ \\frac{d\\tilde{G}}{dt} = -(p_{1} + X)\\tilde{G} - G_{b}X $$\n这是我们转换后系统的第一个方程。\n\n对于第二个方程，我们考虑系统处于基础平衡状态，此时胰岛素浓度处于其基础水平 $I(t) = I_{b}$。将此代入 $\\frac{dX}{dt}$ 的方程中：\n$$ \\frac{dX}{dt} = -p_{2} X + p_{3}\\left(I_{b} - I_{b}\\right) $$\n$$ \\frac{dX}{dt} = -p_{2} X $$\n这是我们转换后系统的第二个方程。\n\n因此，状态向量 $(\\tilde{G}, X)$ 的自治微分方程组为：\n$$ \\frac{d\\tilde{G}}{dt} = f_1(\\tilde{G}, X) = -(p_{1} + X)\\tilde{G} - G_{b}X $$\n$$ \\frac{dX}{dt} = f_2(\\tilde{G}, X) = -p_{2} X $$\n\n接下来，我们通过将时间导数设为零来确定基础平衡点 $(\\tilde{G}_{eq}, X_{eq})$：\n$$ \\frac{d\\tilde{G}}{dt} = 0 $$\n$$ \\frac{dX}{dt} = 0 $$\n由第二个方程 $0 = -p_{2} X_{eq}$ 可知，由于参数 $p_{2}$ 是正的，这意味着 $X_{eq} = 0$。\n将 $X_{eq} = 0$ 代入第一个方程：\n$$ 0 = -(p_{1} + 0)\\tilde{G}_{eq} - G_{b}(0) $$\n$$ 0 = -p_{1}\\tilde{G}_{eq} $$\n由于参数 $p_{1}$ 是正的，这意味着 $\\tilde{G}_{eq} = 0$。\n因此，$(\\tilde{G}, X)$ 动力学的基础平衡点是 $(0, 0)$。这对应于葡萄糖处于其基础水平（$G = G_b$）且胰岛素作用处于其基础水平（$X=0$）的状态。\n\n现在，我们计算系统的雅可比矩阵 $J$，其定义为：\n$$ J = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial \\tilde{G}} & \\frac{\\partial f_1}{\\partial X} \\\\ \\frac{\\partial f_2}{\\partial \\tilde{G}} & \\frac{\\partial f_2}{\\partial X} \\end{pmatrix} $$\n我们从 $f_1(\\tilde{G}, X) = -p_{1}\\tilde{G} - X\\tilde{G} - G_{b}X$ 和 $f_2(\\tilde{G}, X) = -p_{2}X$ 计算必要的偏导数：\n$$ \\frac{\\partial f_1}{\\partial \\tilde{G}} = -p_{1} - X $$\n$$ \\frac{\\partial f_1}{\\partial X} = -\\tilde{G} - G_{b} $$\n$$ \\frac{\\partial f_2}{\\partial \\tilde{G}} = 0 $$\n$$ \\frac{\\partial f_2}{\\partial X} = -p_{2} $$\n雅可比矩阵为：\n$$ J(\\tilde{G}, X) = \\begin{pmatrix} -p_{1} - X & -\\tilde{G} - G_{b} \\\\ 0 & -p_{2} \\end{pmatrix} $$\n最后一步是在基础平衡点 $(\\tilde{G}_{eq}, X_{eq}) = (0, 0)$ 处计算该雅可比矩阵：\n$$ J(0, 0) = \\begin{pmatrix} -p_{1} - 0 & -0 - G_{b} \\\\ 0 & -p_{2} \\end{pmatrix} = \\begin{pmatrix} -p_{1} & -G_{b} \\\\ 0 & -p_{2} \\end{pmatrix} $$\n这是在基础平衡点处线性化系统的雅可比矩阵。\n\n最后，我们讨论该雅可比矩阵的特征值及其对局部稳定性的影响。该雅可比矩阵是一个上三角矩阵。三角矩阵的特征值是其对角线上的元素。因此，特征值为：\n$$ \\lambda_1 = -p_{1} $$\n$$ \\lambda_2 = -p_{2} $$\n问题陈述指明参数 $p_{1}$ 和 $p_{2}$ 是正的。因此，两个特征值 $\\lambda_1$ 和 $\\lambda_2$ 都是严格的负实数。\n根据线性稳定性分析，如果在平衡点计算的雅可比矩阵的所有特征值都具有负实部，则该平衡点是局部渐近稳定的。由于 $\\lambda_1  0$ 和 $\\lambda_2  0$，基础平衡点 $(0, 0)$ 是一个稳定节点。这意味着对于任何偏离此平衡点的微小扰动，系统都会随着时间的推移自然地返回到基础状态。这一数学结果与生理学上的稳态原理是一致的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -p_1  -G_b \\\\ 0  -p_2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在面对真实世界中复杂的输入（如随时间变化的胰岛素水平）时，解析解往往遥不可及，数值模拟便成为不可或缺的工具。本练习旨在培养你构建可靠模拟的核心技能。你将为胰岛素作用子系统推导一个在分段恒定输入下的“精确离散化”更新法则，并将其与经典的“前向欧拉法”进行比较。通过这个过程，你将亲身体会到不同数值方法的精度和稳定性差异，这对于任何依赖计算建模的研究者来说都是宝贵的实践经验。",
            "id": "3937936",
            "problem": "考虑葡萄糖-胰岛素调节最小模型中的胰岛素作用室，它描述了胰岛素介导的葡萄糖摄取的动力学。该室变量用 $X(t)$ 表示，代表胰岛素对葡萄糖处置的作用，其单位为 $1/\\text{min}$。该室一个广泛接受的表示方法是一个一阶线性常微分方程（ODE），其具有恒定的衰减率和一个强迫项，该强迫项与血浆胰岛素浓度 $I(t)$ 相对于其基础水平 $I_b$ 的偏差成正比：\n$$\n\\frac{dX(t)}{dt} = -p_2\\,X(t) + p_3\\left(I(t) - I_b\\right),\n$$\n其中 $p_2$ 的单位是 $1/\\text{min}$，$p_3$ 的单位是 $1/(\\text{min}^2\\cdot\\text{microU}/\\text{mL})$。假设 $I(t)$ 在一系列长度为 $\\Delta_k = t_{k+1} - t_k$ 的区间 $[t_k, t_{k+1})$ 构成的网格上是分段恒定的，在每个区间上的值为 $I_k$。设初始条件为 $X(0) = X_0$。\n\n任务1. 从线性时不变ODE的基本定义和积分因子法出发，当 $I(t)$ 在 $[t_k, t_{k+1})$ 上为常数时，推导将 $X$ 从 $t_k$ 推进到 $t_{k+1}$ 的精确离散时间映射。具体来说，推导一个形如下式的映射\n$$\nX_{k+1} = \\alpha_k\\,X_k + \\beta_k\\,\\left(I_k - I_b\\right),\n$$\n用 $p_2$、$p_3$ 和 $\\Delta_k$ 表示 $\\alpha_k$ 和 $\\beta_k$。不要使用任何快捷公式；从该ODE出发，并应用第一性原理进行推导。\n\n任务2. 在具有分段恒定 $I_k$ 的同一个网格 $\\{t_k\\}$ 上，实现两种模拟方案：\n- 任务1中推导的精确离散化方法。\n- 针对该ODE的前向Euler方法：\n$$\nX_{k+1}^{\\text{Euler}} = X_k + \\Delta_k\\left(-p_2\\,X_k + p_3\\left(I_k - I_b\\right)\\right).\n$$\n\n任务3. 对于下面测试套件中的每一组参数，在从 $k=0$ 到 $k=N-1$ 的所有区间上模拟 $X$，并计算在网格点 $\\{t_{k+1}\\}_{k=0}^{N-1}$ 上，精确离散化序列 $\\{X_k\\}$ 与前向Euler序列 $\\{X_k^{\\text{Euler}}\\}$ 之间的均方根（RMS）绝对误差：\n$$\n\\text{RMS error} = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1}\\left(X_{k+1}^{\\text{Euler}} - X_{k+1}\\right)^2}.\n$$\n将RMS误差以 $1/\\text{min}$ 为单位表示为一个浮点数。\n\n测试套件。使用以下科学上合理的参数集和每个区间内分段恒定的胰岛素曲线。在所有情况下，$X_0 = 0$ $1/\\text{min}$。\n\n- 情况A（理想路径）：\n  - $p_2 = 0.02$ $1/\\text{min}$, $p_3 = 5\\times 10^{-4}$ $1/(\\text{min}^2\\cdot\\text{microU}/\\text{mL})$, $I_b = 15$ $\\text{microU}/\\text{mL}$。\n  - 均匀网格：$N=12$ 个区间，对所有 $k$ 都有 $\\Delta_k = 5$ $\\text{min}$（总计 $60$ $\\text{min}$）。\n  - 胰岛素曲线：对于 $k=0,1,2,3,4,5$（前 $30$ $\\text{min}$），$I_k = 60$ $\\text{microU}/\\text{mL}$；对于 $k=6,7,8,9,10,11$，$I_k = 15$ $\\text{microU}/\\text{mL}$。\n\n- 情况B（小步长边界情况）：\n  - $p_2 = 0.1$ $1/\\text{min}$, $p_3 = 10^{-3}$ $1/(\\text{min}^2\\cdot\\text{microU}/\\text{mL})$, $I_b = 10$ $\\text{microU}/\\text{mL}$。\n  - 均匀网格：$N=160$ 个区间，对所有 $k$ 都有 $\\Delta_k = 0.25$ $\\text{min}$（总计 $40$ $\\text{min}$）。\n  - 胰岛素曲线：对于 $k=0,1,\\dots,39$（前 $10$ $\\text{min}$），$I_k = 30$ $\\text{microU}/\\text{mL}$；对于 $k=40,41,\\dots,159$，$I_k = 10$ $\\text{microU}/\\text{mL}$。\n\n- 情况C（刚性衰减和粗糙步长）：\n  - $p_2 = 0.5$ $1/\\text{min}$, $p_3 = 2\\times 10^{-3}$ $1/(\\text{min}^2\\cdot\\text{microU}/\\text{mL})$, $I_b = 15$ $\\text{microU}/\\text{mL}$。\n  - 均匀网格：$N=6$ 个区间，对所有 $k$ 都有 $\\Delta_k = 10$ $\\text{min}$（总计 $60$ $\\text{min}$）。\n  - 胰岛素曲线：对于 $k=0,1$（前 $20$ $\\text{min}$），$I_k = 100$ $\\text{microU}/\\text{mL}$；对于 $k=2,3,4,5$，$I_k = 15$ $\\text{microU}/\\text{mL}$。\n\n- 情况D（仅基础胰岛素）：\n  - $p_2 = 0.05$ $1/\\text{min}$, $p_3 = 8\\times 10^{-4}$ $1/(\\text{min}^2\\cdot\\text{microU}/\\text{mL})$, $I_b = 12$ $\\text{microU}/\\text{mL}$。\n  - 均匀网格：$N=12$ 个区间，对所有 $k$ 都有 $\\Delta_k = 5$ $\\text{min}$（总计 $60$ $\\text{min}$）。\n  - 胰岛素曲线：对所有 $k=0,1,\\dots,11$，$I_k = 12$ $\\text{microU}/\\text{mL}$。\n\n最终输出格式。你的程序应生成单行输出，其中包含四种情况 A、B、C、D 的RMS误差，按 A、B、C、D 的顺序排列，形式为方括号括起来的逗号分隔列表（例如，“[x_A,x_B,x_C,x_D]”）。每个条目必须是以 $1/\\text{min}$ 为单位的浮点数。",
            "solution": "我们从胰岛素作用室ODE开始\n$$\n\\frac{dX(t)}{dt} = -p_2\\,X(t) + p_3\\left(I(t) - I_b\\right),\n$$\n其中 $p_2 > 0$，并且 $I(t)$ 在长度为 $\\Delta_k = t_{k+1} - t_k$ 的区间 $[t_k, t_{k+1})$ 上是分段恒定的。在每个区间上，$I(t) = I_k$ 是一个常数，该ODE变成一个具有恒定系数和恒定输入的线性时不变ODE：\n$$\n\\frac{dX(t)}{dt} + p_2\\,X(t) = p_3\\left(I_k - I_b\\right).\n$$\n\n为了推导精确的离散时间映射，我们使用积分因子法。这个线性ODE的积分因子是 $e^{p_2 t}$。方程两边同乘以积分因子得到\n$$\ne^{p_2 t}\\frac{dX(t)}{dt} + p_2 e^{p_2 t} X(t) = p_3\\left(I_k - I_b\\right) e^{p_2 t}.\n$$\n认识到左边是 $e^{p_2 t} X(t)$ 的导数，我们写作\n$$\n\\frac{d}{dt}\\left(e^{p_2 t} X(t)\\right) = p_3\\left(I_k - I_b\\right) e^{p_2 t}.\n$$\n从 $t_k$ 到 $t_{k+1} = t_k + \\Delta_k$ 进行积分，并记 $X_k = X(t_k)$ 和 $X_{k+1} = X(t_{k+1})$，我们得到\n$$\ne^{p_2 t_{k+1}} X_{k+1} - e^{p_2 t_k} X_k = p_3\\left(I_k - I_b\\right) \\int_{t_k}^{t_{k+1}} e^{p_2 s}\\,ds.\n$$\n计算该积分：\n$$\n\\int_{t_k}^{t_{k+1}} e^{p_2 s}\\,ds = \\frac{1}{p_2}\\left(e^{p_2 t_{k+1}} - e^{p_2 t_k}\\right).\n$$\n代入：\n$$\ne^{p_2 t_{k+1}} X_{k+1} - e^{p_2 t_k} X_k = \\frac{p_3}{p_2}\\left(I_k - I_b\\right)\\left(e^{p_2 t_{k+1}} - e^{p_2 t_k}\\right).\n$$\n两边同除以 $e^{p_2 t_{k+1}}$：\n$$\nX_{k+1} - e^{-p_2 \\Delta_k} X_k = \\frac{p_3}{p_2}\\left(I_k - I_b\\right)\\left(1 - e^{-p_2 \\Delta_k}\\right).\n$$\n因此，精确的离散时间映射为\n$$\nX_{k+1} = \\alpha_k\\,X_k + \\beta_k\\,\\left(I_k - I_b\\right),\n$$\n其中\n$$\n\\alpha_k = e^{-p_2 \\Delta_k}, \\qquad \\beta_k = \\frac{p_3}{p_2}\\left(1 - e^{-p_2 \\Delta_k}\\right).\n$$\n对于每个具有恒定 $I_k$ 的区间，此映射在网格点上是精确的。\n\n对于前向Euler方法，我们在每个区间上应用显式时间步进公式：\n$$\nX_{k+1}^{\\text{Euler}} = X_k + \\Delta_k \\left(-p_2\\,X_k + p_3\\left(I_k - I_b\\right)\\right) = \\left(1 - p_2 \\Delta_k\\right) X_k + \\Delta_k p_3 \\left(I_k - I_b\\right).\n$$\nEuler方法是一种一阶精度格式，对于标量线性衰减项 $-p_2 X$，其相对于齐次部分的稳定性要求是 $|1 - p_2 \\Delta_k|  1$，即 $0  p_2 \\Delta_k  2$。当 $p_2 \\Delta_k$ 很大时，Euler方法可能会产生振荡或发散行为，而精确离散化方法则保持稳定，因为对于 $p_2 > 0$，$e^{-p_2 \\Delta_k}$ 的幅值总是有界于1。\n\n**算法设计**：\n- 给定 $(p_2, p_3, I_b, X_0)$、长度网格 $\\{\\Delta_k\\}$ 和胰岛素值 $\\{I_k\\}$，使用 $X_{k+1} = e^{-p_2 \\Delta_k} X_k + \\frac{p_3}{p_2}\\left(1 - e^{-p_2 \\Delta_k}\\right)\\left(I_k - I_b\\right)$ 计算精确序列 $\\{X_k\\}$。\n- 独立地使用 $X_{k+1}^{\\text{Euler}} = \\left(1 - p_2 \\Delta_k\\right) X_k + \\Delta_k p_3 \\left(I_k - I_b\\right)$ 计算前向Euler序列 $\\{X_{k+1}^{\\text{Euler}}\\}$。\n- 计算所有步骤的均方根（RMS）绝对误差：\n$$\n\\text{RMS error} = \\sqrt{\\frac{1}{N}\\sum_{k=0}^{N-1}\\left(X_{k+1}^{\\text{Euler}} - X_{k+1}\\right)^2}.\n$$\n该误差的单位是 $1/\\text{min}$。\n\n**测试套件分析**：\n- 情况A使用适中的 $p_2$ 和区间长度，因此Euler误差是中等的，精确离散化提供了明显的改进。\n- 情况B使用非常小的 $\\Delta_k$，所以Euler误差应该很小；精确离散化在网格点上达到机器精度的一致性。\n- 情况C使用大的 $p_2$ 和粗糙的 $\\Delta_k$，使得 $p_2 \\Delta_k \\gg 2$，因此Euler方法可能不稳定，导致较大误差，而精确离散化则表现良好。\n- 情况D全程使用基础胰岛素，因此强迫项消失。精确解简化为纯指数衰减 $X_{k+1} = e^{-p_2 \\Delta_k} X_k$，而Euler方法提供线性化衰减；它们的差异量化了无输入时的离散化误差。\n\n最终程序精确地实现了这些计算，并以要求的格式打印出单行结果，其中包含情况A、B、C和D的四个浮点RMS误差值，每个值的单位都是 $1/\\text{min}$。",
            "answer": "```python\nimport numpy as np\n\ndef exact_discretization_sequence(p2, p3, Ib, X0, deltas, I_values):\n    \"\"\"\n    Compute X_k using the exact discretization for dX/dt = -p2 X + p3 (I - Ib),\n    with piecewise-constant I over each interval [t_k, t_{k+1}).\n    \"\"\"\n    N = len(deltas)\n    X = np.zeros(N + 1, dtype=float)\n    X[0] = X0\n    for k in range(N):\n        delta = deltas[k]\n        Ik = I_values[k]\n        alpha = np.exp(-p2 * delta)\n        beta = (p3 / p2) * (1.0 - alpha)\n        X[k + 1] = alpha * X[k] + beta * (Ik - Ib)\n    return X\n\ndef euler_sequence(p2, p3, Ib, X0, deltas, I_values):\n    \"\"\"\n    Compute X_k using forward Euler for the same ODE and piecewise-constant I.\n    \"\"\"\n    N = len(deltas)\n    X = np.zeros(N + 1, dtype=float)\n    X[0] = X0\n    for k in range(N):\n        delta = deltas[k]\n        Ik = I_values[k]\n        X[k + 1] = (1.0 - p2 * delta) * X[k] + delta * p3 * (Ik - Ib)\n    return X\n\ndef rms_error(sequence_a, sequence_b):\n    \"\"\"\n    Compute RMS error over steps k=0..N-1 comparing the values at k+1.\n    Both sequences are length N+1; compare entries 1..N.\n    \"\"\"\n    diff = sequence_a[1:] - sequence_b[1:]\n    return float(np.sqrt(np.mean(diff * diff)))\n\ndef case_A():\n    # Parameters\n    p2 = 0.02  # 1/min\n    p3 = 5e-4  # 1/(min^2 * microU/mL)\n    Ib = 15.0  # microU/mL\n    X0 = 0.0   # 1/min\n    N = 12\n    delta = 5.0  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([60.0]*6 + [15.0]*6, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef case_B():\n    p2 = 0.1   # 1/min\n    p3 = 1e-3  # 1/(min^2 * microU/mL)\n    Ib = 10.0  # microU/mL\n    X0 = 0.0   # 1/min\n    N = 160\n    delta = 0.25  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([30.0]*40 + [10.0]*120, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef case_C():\n    p2 = 0.5    # 1/min\n    p3 = 2e-3   # 1/(min^2 * microU/mL)\n    Ib = 15.0   # microU/mL\n    X0 = 0.0    # 1/min\n    N = 6\n    delta = 10.0  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([100.0]*2 + [15.0]*4, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef case_D():\n    p2 = 0.05   # 1/min\n    p3 = 8e-4   # 1/(min^2 * microU/mL)\n    Ib = 12.0   # microU/mL\n    X0 = 0.0    # 1/min\n    N = 12\n    delta = 5.0  # min\n    deltas = np.full(N, delta, dtype=float)\n    I_values = np.array([12.0]*N, dtype=float)\n    return p2, p3, Ib, X0, deltas, I_values\n\ndef solve():\n    test_cases = [case_A(), case_B(), case_C(), case_D()]\n    results = []\n    for (p2, p3, Ib, X0, deltas, I_values) in test_cases:\n        X_exact = exact_discretization_sequence(p2, p3, Ib, X0, deltas, I_values)\n        X_euler = euler_sequence(p2, p3, Ib, X0, deltas, I_values)\n        err = rms_error(X_euler, X_exact)\n        results.append(err)\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}