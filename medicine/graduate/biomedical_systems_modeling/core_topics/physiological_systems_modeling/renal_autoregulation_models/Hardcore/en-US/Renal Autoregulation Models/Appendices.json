{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in analyzing any dynamic physiological model is to determine its equilibrium, or steady-state, operating point. This practice  provides a foundational exercise in finding this equilibrium for a simplified model of tubuloglomerular feedback (TGF). By setting the rate of change of afferent arteriolar resistance to zero, you will solve for the resistance at which the constrictor drive from the macula densa is perfectly balanced by the arteriole's mechanical response.",
            "id": "3925078",
            "problem": "In renal autoregulation, afferent arteriolar resistance, denoted by $R_{a}$, is modulated by tubuloglomerular feedback (TGF) to stabilize glomerular filtration. Consider a simplified lumped-parameter model in which the macula densa transduction of a vasoregulatory mediator $N$ into a constrictor drive is described by an inhibitory Hill function $f(N)$, and the arteriolar mechanical response to a constrictor drive is approximated locally by a linear mapping $g(R_{a})$. Specifically, suppose\n$$f(N) = \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}$$\nwith $k>0$, $N_{50}>0$, and $h>0$, and\n$$g(R_{a}) = \\beta \\left(R_{a} - R_{a0}\\right)$$\nwith $\\beta>0$ and $R_{a0}>0$, where $R_{a0}$ is the basal afferent arteriolar resistance. Assume the closed-loop dynamics are first-order, given by\n$$\\frac{dR_{a}}{dt} = \\gamma \\left[f(N) - g(R_{a})\\right],$$\nwith $\\gamma>0$, reflecting a proportional relaxation to the balance between transduction and mechanical response.\n\nUsing only the steady-state principle that at equilibrium the time derivative is zero, derive the equilibrium afferent arteriolar resistance $R_{a}^{*}$ in terms of $N$, $k$, $N_{50}$, $h$, $\\beta$, and $R_{a0}$. Then, evaluate $R_{a}^{*}$ numerically for the parameter values $N = 200\\,\\mathrm{nM}$, $k = 9\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$, $N_{50} = 300\\,\\mathrm{nM}$, $h = 3$, $\\beta = 0.45$ (dimensionless), and $R_{a0} = 8\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$. Express the final resistance in $\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$ and round your answer to four significant figures. Define any acronyms on first use, including Tubuloglomerular Feedback (TGF) if mentioned.",
            "solution": "The problem asks for the derivation of the equilibrium afferent arteriolar resistance, $R_{a}^{*}$, and its numerical evaluation based on a simplified first-order model of renal autoregulation. The model describes the dynamics of afferent arteriolar resistance, $R_{a}$, as a function of a vasoregulatory mediator concentration, $N$. The regulation is mediated by Tubuloglomerular Feedback (TGF), a key mechanism for stabilizing glomerular hemodynamics.\n\nThe dynamical system is described by the first-order ordinary differential equation:\n$$\n\\frac{dR_{a}}{dt} = \\gamma \\left[f(N) - g(R_{a})\\right]\n$$\nwhere $\\gamma > 0$ is a rate constant. The function $f(N)$ represents the constrictor drive from the macula densa, given by an inhibitory Hill function:\n$$\nf(N) = \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}\n$$\nThe function $g(R_{a})$ represents the arteriolar mechanical response, modeled as a linear mapping:\n$$\ng(R_{a}) = \\beta \\left(R_{a} - R_{a0}\\right)\n$$\nHere, $k$, $N_{50}$, $h$, $\\beta$, and $R_{a0}$ are positive constants.\n\nTo find the equilibrium afferent arteriolar resistance, denoted by $R_{a}^{*}$, we apply the steady-state principle. At equilibrium, the system's state variables are constant over time. Therefore, the time derivative of the resistance must be zero:\n$$\n\\frac{dR_{a}}{dt} = 0\n$$\nSubstituting this condition into the dynamical equation yields:\n$$\n\\gamma \\left[f(N) - g(R_{a}^{*})\\right] = 0\n$$\nSince the problem states that $\\gamma > 0$, the term in the brackets must be zero for the equation to hold:\n$$\nf(N) - g(R_{a}^{*}) = 0\n$$\nThis implies that at equilibrium, the constrictor drive is perfectly balanced by the mechanical response:\n$$\ng(R_{a}^{*}) = f(N)\n$$\nNow, we substitute the specific forms of the functions $f(N)$ and $g(R_{a})$ into this equilibrium condition:\n$$\n\\beta \\left(R_{a}^{*} - R_{a0}\\right) = \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}\n$$\nOur goal is to solve this algebraic equation for $R_{a}^{*}$. We can proceed with the following algebraic steps. First, divide both sides by $\\beta$ (since $\\beta > 0$):\n$$\nR_{a}^{*} - R_{a0} = \\frac{1}{\\beta} \\frac{k}{1 + \\left(\\frac{N}{N_{50}}\\right)^{h}}\n$$\nNext, isolate $R_{a}^{*}$ by adding the basal resistance $R_{a0}$ to both sides of the equation:\n$$\nR_{a}^{*} = R_{a0} + \\frac{k}{\\beta \\left[1 + \\left(\\frac{N}{N_{50}}\\right)^{h}\\right]}\n$$\nThis is the symbolic expression for the equilibrium afferent arteriolar resistance $R_{a}^{*}$ in terms of the given parameters.\n\nThe second part of the task is to evaluate $R_{a}^{*}$ numerically using the provided parameter values:\n$N = 200\\,\\mathrm{nM}$\n$k = 9\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$\n$N_{50} = 300\\,\\mathrm{nM}$\n$h = 3$\n$\\beta = 0.45$ (dimensionless)\n$R_{a0} = 8\\,\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$\n\nWe substitute these values into the derived expression for $R_{a}^{*}$. First, let's evaluate the term within the Hill function:\n$$\n\\frac{N}{N_{50}} = \\frac{200}{300} = \\frac{2}{3}\n$$\nNext, we raise this ratio to the power of the Hill coefficient $h = 3$:\n$$\n\\left(\\frac{N}{N_{50}}\\right)^{h} = \\left(\\frac{2}{3}\\right)^{3} = \\frac{2^3}{3^3} = \\frac{8}{27}\n$$\nNow, we can compute the denominator of the fractional term:\n$$\n1 + \\left(\\frac{N}{N_{50}}\\right)^{h} = 1 + \\frac{8}{27} = \\frac{27}{27} + \\frac{8}{27} = \\frac{35}{27}\n$$\nLet's substitute this back into the expression for $R_{a}^{*}$:\n$$\nR_{a}^{*} = R_{a0} + \\frac{k}{\\beta \\left(\\frac{35}{27}\\right)}\n$$\nPlugging in the values for $R_{a0}$, $k$, and $\\beta$:\n$$\nR_{a}^{*} = 8 + \\frac{9}{0.45 \\left(\\frac{35}{27}\\right)}\n$$\nWe can simplify the denominator. Note that $0.45 = \\frac{45}{100} = \\frac{9}{20}$.\n$$\n0.45 \\left(\\frac{35}{27}\\right) = \\frac{9}{20} \\times \\frac{35}{27} = \\frac{1}{20} \\times \\frac{35}{3} = \\frac{35}{60} = \\frac{7}{12}\n$$\nSo, the fractional term becomes:\n$$\n\\frac{9}{\\frac{7}{12}} = 9 \\times \\frac{12}{7} = \\frac{108}{7}\n$$\nFinally, we add $R_{a0}$ to this result:\n$$\nR_{a}^{*} = 8 + \\frac{108}{7}\n$$\nTo combine these terms, we find a common denominator:\n$$\nR_{a}^{*} = \\frac{8 \\times 7}{7} + \\frac{108}{7} = \\frac{56 + 108}{7} = \\frac{164}{7}\n$$\nNow we compute the numerical value and round it to four significant figures as requested.\n$$\nR_{a}^{*} = \\frac{164}{7} \\approx 23.4285714...\n$$\nRounding to four significant figures gives $23.43$. The units for the resistance are $\\mathrm{mmHg}\\cdot\\mathrm{min}\\cdot\\mathrm{mL}^{-1}$, consistent with the units of $R_{a0}$ and the term we added to it.",
            "answer": "$$\\boxed{23.43}$$"
        },
        {
            "introduction": "While steady-state analysis tells us the system's baseline, it doesn't describe how the system responds to dynamic changes, such as fluctuations in blood pressure. This exercise  introduces the powerful technique of small-signal linearization to approximate the system's behavior around its equilibrium. You will derive the transfer function relating renal blood flow to arterial pressure, a key tool for understanding how effectively the autoregulatory mechanism buffers the kidney from pressure disturbances.",
            "id": "3925106",
            "problem": "Consider a lumped-parameter model of Renal Blood Flow (RBF) autoregulation in which the afferent arteriolar resistance responds dynamically to sensed tubular flow. The renal vasculature is represented by an afferent arteriolar resistance $R_a$ in series with a downstream resistance $R_d$ (representing post-glomerular and venous segments). Arterial pressure is $P_a$ and venous pressure is $P_v$ (treated as constant). The volumetric flow $Q$ satisfies the hemodynamic relation that flow equals pressure drop divided by total resistance. The afferent arteriolar resistance evolves according to a first-order relaxation toward a nonlinear target set by tubuloglomerular feedback. Specifically, the governing equations are\n$$\nQ \\;=\\; \\frac{P_a - P_v}{R_a + R_d},\n$$\n$$\n\\frac{d R_a}{dt} \\;=\\; \\frac{1}{\\tau}\\Big(R_a^{\\ast}(Q) - R_a\\Big),\n$$\n$$\nR_a^{\\ast}(Q) \\;=\\; R_{a0}\\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big],\n$$\nwhere $R_{a0} \\gt 0$ is the steady-state afferent resistance at the operating point, $Q_0 \\gt 0$ is the steady-state flow, $\\tau \\gt 0$ is the resistance adaptation time constant, and $\\alpha \\gt 0$, $\\beta \\gt 0$ characterize the sensitivity and saturation of tubuloglomerular feedback. Assume the system is linearized about the equilibrium $(P_{a0}, Q_0, R_{a0})$ that satisfies $Q_0 = (P_{a0} - P_v)/(R_{a0} + R_d)$ and $R_a^{\\ast}(Q_0) = R_{a0}$.\n\nStarting from these equations and treating $P_a$ as the input, perform a small-signal linearization around the equilibrium to obtain the transfer function $G(s)$ from the arterial pressure perturbation to the flow perturbation, that is $G(s) = \\tilde{Q}(s)/\\tilde{P}_a(s)$, where tildes denote small deviations from the equilibrium. Then, compute the low-frequency gain $G(0)$ in closed form.\n\nExpress the low-frequency gain in analytic form using the symbols $R_{a0}$, $R_d$, $Q_0$, $\\alpha$, and $\\beta$. The quantity $G(0)$ has physical units of volume per time per pressure; if you later choose to numerically evaluate your expression, express the gain in $\\mathrm{mL}\\,\\mathrm{s}^{-1}\\,\\mathrm{mmHg}^{-1}$. Do not include units inside your boxed final answer.",
            "solution": "The problem requires the derivation of the low-frequency gain of a linearized model of renal autoregulation. The system's behavior is described by a set of coupled algebraic and differential equations. The process involves linearizing these equations around a specified equilibrium point, deriving the transfer function from arterial pressure to renal blood flow, and then evaluating this transfer function at zero frequency.\n\nFirst, we define the equilibrium state of the system by the variables $(P_{a0}, Q_0, R_{a0})$. The perturbations around this equilibrium are defined as:\n$P_a(t) = P_{a0} + \\tilde{P}_a(t)$\n$Q(t) = Q_0 + \\tilde{Q}(t)$\n$R_a(t) = R_{a0} + \\tilde{R}_a(t)$\n\nThe provided equations are:\n1. Hemodynamics: $Q = \\frac{P_a - P_v}{R_a + R_d}$\n2. Resistance dynamics: $\\frac{dR_a}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q) - R_a\\Big)$\n3. Feedback function: $R_a^{\\ast}(Q) = R_{a0}\\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big]$\n\nThe equilibrium is defined by the conditions $Q_0 = \\frac{P_{a0} - P_v}{R_{a0} + R_d}$ and $R_a^{\\ast}(Q_0) = R_{a0}$.\n\nWe proceed by linearizing each equation for small perturbations.\n\n**Linearization of the Hemodynamic Equation**\n\nWe linearize the equation $Q = \\frac{P_a - P_v}{R_a + R_d}$ around the equilibrium point. We can use a first-order multivariate Taylor series expansion for $Q(P_a, R_a)$:\n$\\tilde{Q} \\approx \\frac{\\partial Q}{\\partial P_a}\\bigg|_{(P_{a0}, R_{a0})} \\tilde{P}_a + \\frac{\\partial Q}{\\partial R_a}\\bigg|_{(P_{a0}, R_{a0})} \\tilde{R}_a$\n\nThe partial derivatives are:\n$\\frac{\\partial Q}{\\partial P_a} = \\frac{1}{R_a + R_d}$. At equilibrium, this is $\\frac{1}{R_{a0} + R_d}$.\n$\\frac{\\partial Q}{\\partial R_a} = -\\frac{P_a - P_v}{(R_a + R_d)^2} = -\\frac{Q}{R_a + R_d}$. At equilibrium, this is $-\\frac{Q_0}{R_{a0} + R_d}$.\n\nSubstituting these into the Taylor expansion gives the first linearized equation:\n$$\n\\tilde{Q} = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a - \\frac{Q_0}{R_{a0} + R_d} \\tilde{R}_a\n$$\n\n**Linearization of the Resistance Dynamics**\n\nWe substitute the perturbation variables into the differential equation:\n$\\frac{d(R_{a0} + \\tilde{R}_a)}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q_0 + \\tilde{Q}) - (R_{a0} + \\tilde{R}_a)\\Big)$\nSince $R_{a0}$ is a constant, its derivative is zero:\n$\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q_0 + \\tilde{Q}) - R_{a0} - \\tilde{R}_a\\Big)$\n\nNext, we linearize the feedback function $R_a^{\\ast}(Q)$ around $Q_0$:\n$R_a^{\\ast}(Q_0 + \\tilde{Q}) \\approx R_a^{\\ast}(Q_0) + \\frac{dR_a^{\\ast}}{dQ}\\bigg|_{Q=Q_0} \\tilde{Q}$\nWe know from the problem statement that $R_a^{\\ast}(Q_0) = R_{a0}$. We compute the derivative:\n$\\frac{dR_a^{\\ast}}{dQ} = R_{a0} \\frac{d}{dQ} \\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big] = R_{a0} \\alpha \\beta \\text{sech}^2\\big(\\beta(Q - Q_0)\\big)$\nEvaluating at $Q=Q_0$:\n$\\frac{dR_a^{\\ast}}{dQ}\\bigg|_{Q=Q_0} = R_{a0} \\alpha \\beta \\text{sech}^2(0) = R_{a0} \\alpha \\beta$\nLet us define the feedback gain $K_{TGF} = R_{a0} \\alpha \\beta$.\nThe linearized feedback function is:\n$R_a^{\\ast}(Q_0 + \\tilde{Q}) \\approx R_{a0} + K_{TGF} \\tilde{Q}$\n\nSubstituting this into the dynamic equation for $\\tilde{R}_a$:\n$\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} \\Big((R_{a0} + K_{TGF} \\tilde{Q}) - R_{a0} - \\tilde{R}_a\\Big)$\nThis simplifies to the second linearized equation:\n$$\n\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} (K_{TGF} \\tilde{Q} - \\tilde{R}_a)\n$$\n\n**Derivation of the Transfer Function**\n\nTo find the transfer function $G(s) = \\tilde{Q}(s)/\\tilde{P}_a(s)$, we apply the Laplace transform to the two linearized equations, assuming zero initial conditions for the perturbations. Let $\\tilde{Q}(s)$, $\\tilde{P}_a(s)$, and $\\tilde{R}_a(s)$ be the Laplace transforms of $\\tilde{Q}(t)$, $\\tilde{P}_a(t)$, and $\\tilde{R}_a(t)$, respectively.\n\nThe transformed equations are:\n1. $\\tilde{Q}(s) = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s) - \\frac{Q_0}{R_{a0} + R_d} \\tilde{R}_a(s)$\n2. $s \\tilde{R}_a(s) = \\frac{1}{\\tau} (K_{TGF} \\tilde{Q}(s) - \\tilde{R}_a(s))$\n\nFrom equation (2), we solve for $\\tilde{R}_a(s)$ in terms of $\\tilde{Q}(s)$:\n$s \\tilde{R}_a(s) + \\frac{1}{\\tau} \\tilde{R}_a(s) = \\frac{K_{TGF}}{\\tau} \\tilde{Q}(s)$\n$\\tilde{R}_a(s) \\left(s + \\frac{1}{\\tau}\\right) = \\frac{K_{TGF}}{\\tau} \\tilde{Q}(s)$\n$\\tilde{R}_a(s) = \\frac{K_{TGF}/\\tau}{s + 1/\\tau} \\tilde{Q}(s) = \\frac{K_{TGF}}{1 + \\tau s} \\tilde{Q}(s)$\n\nNow we substitute this expression for $\\tilde{R}_a(s)$ into equation (1):\n$\\tilde{Q}(s) = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s) - \\frac{Q_0}{R_{a0} + R_d} \\left( \\frac{K_{TGF}}{1 + \\tau s} \\tilde{Q}(s) \\right)$\n\nWe group the terms with $\\tilde{Q}(s)$:\n$\\tilde{Q}(s) \\left[ 1 + \\frac{Q_0 K_{TGF}}{(R_{a0} + R_d)(1 + \\tau s)} \\right] = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s)$\n\nNow we solve for the transfer function $G(s) = \\frac{\\tilde{Q}(s)}{\\tilde{P}_a(s)}$:\n$G(s) = \\frac{\\frac{1}{R_{a0} + R_d}}{1 + \\frac{Q_0 K_{TGF}}{(R_{a0} + R_d)(1 + \\tau s)}}$\nTo simplify, we multiply the numerator and denominator by $(R_{a0} + R_d)(1 + \\tau s)$:\n$G(s) = \\frac{1 + \\tau s}{(R_{a0} + R_d)(1 + \\tau s) + Q_0 K_{TGF}}$\n\nSubstituting back $K_{TGF} = R_{a0} \\alpha \\beta$:\n$$\nG(s) = \\frac{1 + \\tau s}{(R_{a0} + R_d)(1 + \\tau s) + Q_0 R_{a0} \\alpha \\beta}\n$$\n\n**Calculation of the Low-Frequency Gain**\n\nThe low-frequency gain, denoted as $G(0)$, is the value of the transfer function at $s=0$. This represents the steady-state response of the output (flow perturbation) to a step change in the input (pressure perturbation).\nWe set $s=0$ in the expression for $G(s)$:\n$G(0) = \\frac{1 + \\tau(0)}{(R_{a0} + R_d)(1 + \\tau(0)) + Q_0 R_{a0} \\alpha \\beta}$\n$G(0) = \\frac{1}{(R_{a0} + R_d)(1) + Q_0 R_{a0} \\alpha \\beta}$\n\nThe final expression for the low-frequency gain is:\n$$\nG(0) = \\frac{1}{R_{a0} + R_d + Q_0 R_{a0} \\alpha \\beta}\n$$\nThis expression is in the required analytic form, using the specified symbols. The denominator represents the total effective resistance of the vasculature in the presence of tubuloglomerular feedback at steady state. The term $Q_0 R_{a0} \\alpha \\beta$ reflects the additional \"resistance\" contributed by the active feedback mechanism, which acts to stabilize flow.",
            "answer": "$$\n\\boxed{\\frac{1}{R_{a0} + R_d + Q_0 R_{a0} \\alpha \\beta}}\n$$"
        },
        {
            "introduction": "Renal autoregulation exemplifies a classic engineering trade-off: strong feedback enhances performance but can compromise stability, especially when time delays are present in the loop. In this computational practice , you will use control theory concepts like the sensitivity function and gain margin to explore this trade-off. By analyzing a model that includes both myogenic and TGF mechanisms with inherent delays, you will see quantitatively how increasing feedback gain improves disturbance rejection at low frequencies but can reduce the system's stability margin, pushing it towards oscillations.",
            "id": "3925090",
            "problem": "Consider a linearized small-signal model of renal autoregulation where the afferent arteriole and feedback sensing constitute a single-input single-output loop driven by disturbances in arterial pressure. The two dominant physiological mechanisms are the myogenic response and the tubuloglomerular feedback (TGF). The myogenic response modulates afferent arteriolar resistance in response to transmural pressure changes, and the tubuloglomerular feedback (TGF) modulates afferent tone based on macula densa sensing of distal tubular flow. For small perturbations around a steady operating point, model the open-loop plant as a cascade of first-order elements and a pure time delay to capture transport and signaling latencies:\n- A first-order lag for the myogenic response with break frequency $\\omega_{\\mathrm{m}}$ in $\\mathrm{rad/s}$.\n- A first-order lag for the tubuloglomerular feedback with break frequency $\\omega_{\\mathrm{tgf}}$ in $\\mathrm{rad/s}$.\n- A single zero with break frequency $\\omega_{\\mathrm{z}}$ in $\\mathrm{rad/s}$ representing the net direct flow-dependence in the sensing path.\n- A pure time delay $\\tau_{\\mathrm{d}}$ in $\\mathrm{s}$ representing transport and signaling delay.\nLet the dimensionless steady-state gain of the plant be $G_{\\mathrm{p}}$. Let the dimensionless feedback gain be $K$. Denote the Laplace variable by $s$ with the frequency axis $s = j \\omega$, where angles are measured in radians.\n\nUse the following standard building blocks to construct the open-loop transfer function:\n- First-order lag block $B(s)$ has the form $B(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{b}}}$ with break frequency $\\omega_{\\mathrm{b}}$.\n- Single zero block $Z(s)$ has the form $Z(s) = 1 + s/\\omega_{\\mathrm{z}}$.\n- Pure time delay $D(s)$ has the form $D(s) = e^{- s \\tau_{\\mathrm{d}}}$.\nCompose these elements to obtain the open-loop plant $P(s)$ and then the open-loop loop transfer function $L(s) = K \\, P(s)$.\n\nDefine the sensitivity function $S(s)$ for disturbance rejection as $S(s) = \\dfrac{1}{1 + L(s)}$. Low-frequency disturbance rejection quality is indicated by the magnitude $\\left| S(j \\omega) \\right|$ at small $\\omega$, in particular at $\\omega = 0$.\n\nDefine the gain margin using the Nyquist plot of $L(s)$ as follows. Let $\\omega_{\\mathrm{pc}}$ be any phase-crossover frequency satisfying $\\arg\\!\\left( L(j \\omega_{\\mathrm{pc}}) \\right) = - \\pi$ (angles in radians). If such an $\\omega_{\\mathrm{pc}}$ exists, the gain margin is $GM = \\dfrac{1}{\\left| L(j \\omega_{\\mathrm{pc}}) \\right|}$; if no phase crossover exists over the considered frequency range, set $GM$ to $+\\infty$. Assume the open-loop plant $P(s)$ has zero right-half-plane poles. Use the Nyquist stability criterion to determine closed-loop stability by computing the winding number of the Nyquist plot of $L(s)$ around the point $-1$ in the complex plane; zero encirclements imply closed-loop stability, nonzero encirclements imply closed-loop instability.\n\nYour task is to implement a program that, for each specified test case, constructs $L(s)$ from the provided parameters, computes the low-frequency sensitivity magnitude $\\left| S(j 0) \\right|$, computes the gain margin $GM$ from the Nyquist plot based on the phase-crossover definition above, and determines closed-loop stability using the Nyquist encirclement criterion. All frequencies must be treated in $\\mathrm{rad/s}$ and the time delay in $\\mathrm{s}$. The output for each test case must be a list with three elements: the float $\\left| S(j 0) \\right|$ rounded to $6$ decimal places, the float $GM$ rounded to $6$ decimal places (or $+\\infty$ if no phase crossover exists), and a boolean indicating closed-loop stability, in that order. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[ [a,b,c],[d,e,f] \\right]$).\n\nUse the following test suite (each tuple of parameters is ordered as $(G_{\\mathrm{p}}, \\omega_{\\mathrm{m}}, \\omega_{\\mathrm{tgf}}, \\omega_{\\mathrm{z}}, \\tau_{\\mathrm{d}}, K)$):\n- Test case $1$ (general case with moderate delay and moderate gain): $(1.0, 0.7, 0.05, 0.02, 6.0, 2.0)$.\n- Test case $2$ (increased gain to probe margin reduction): $(1.0, 0.7, 0.05, 0.02, 6.0, 8.0)$.\n- Test case $3$ (edge case: zero delay yields no phase crossover over practical band): $(1.0, 0.5, 0.05, 0.01, 0.0, 20.0)$.\n- Test case $4$ (large delay and significant gain to induce oscillatory tendency): $(1.2, 0.5, 0.04, 0.01, 20.0, 5.0)$.\n\nScientific realism constraints:\n- The break frequencies $\\omega_{\\mathrm{m}}$ and $\\omega_{\\mathrm{tgf}}$ reflect the characteristic response rates of the myogenic mechanism and tubuloglomerular feedback (TGF), respectively.\n- The delay $\\tau_{\\mathrm{d}}$ aggregates transport and signaling latencies in the feedback loop.\n\nAngle units must be radians. Express all computed magnitudes as dimensionless floats. The final output must be exactly one line containing the comma-separated Python list representation of the per-test-case results, enclosed in square brackets.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in control theory applied to a standard biomedical model, is well-posed with sufficient data and clear objectives, and is free of contradictions or ambiguities.\n\nHerein, a step-by-step derivation of the solution is provided.\n\n### 1. Model Formulation\nThe problem describes a single-input single-output (SISO) feedback loop for renal autoregulation. The open-loop plant transfer function, $P(s)$, is a cascade of several elements. Based on the provided building blocks, $P(s)$ is constructed as follows:\n- Myogenic response lag: $B_{\\mathrm{m}}(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{m}}}$\n- Tubuloglomerular feedback (TGF) lag: $B_{\\mathrm{tgf}}(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{tgf}}}$\n- Sensing path zero: $Z(s) = 1 + s/\\omega_{\\mathrm{z}}$\n- Pure time delay: $D(s) = e^{-s \\tau_{\\mathrm{d}}}$\n- Steady-state plant gain: $G_{\\mathrm{p}}$\n\nThe complete plant transfer function $P(s)$ is the product of these components:\n$$ P(s) = G_{\\mathrm{p}} \\cdot B_{\\mathrm{m}}(s) \\cdot B_{\\mathrm{tgf}}(s) \\cdot Z(s) \\cdot D(s) = G_{\\mathrm{p}} \\frac{1 + s/\\omega_{\\mathrm{z}}}{(1 + s/\\omega_{\\mathrm{m}})(1 + s/\\omega_{\\mathrm{tgf}})} e^{-s \\tau_{\\mathrm{d}}} $$\nThe open-loop loop transfer function, $L(s)$, includes the feedback gain $K$:\n$$ L(s) = K \\cdot P(s) = K G_{\\mathrm{p}} \\frac{1 + s/\\omega_{\\mathrm{z}}}{(1 + s/\\omega_{\\mathrm{m}})(1 + s/\\omega_{\\mathrm{tgf}})} e^{-s \\tau_{\\mathrm{d}}} $$\n\n### 2. Low-Frequency Sensitivity Magnitude\nThe sensitivity function $S(s)$ is defined as $S(s) = \\dfrac{1}{1 + L(s)}$. It quantifies the system's ability to reject disturbances. The low-frequency disturbance rejection is evaluated at $\\omega = 0$, which corresponds to $s = j\\omega = 0$.\n\nFirst, we find the DC gain of the loop transfer function, $L(j0)$:\n$$ L(j0) = K G_{\\mathrm{p}} \\frac{1 + j0/\\omega_{\\mathrm{z}}}{(1 + j0/\\omega_{\\mathrm{m}})(1 + j0/\\omega_{\\mathrm{tgf}})} e^{-j0 \\cdot \\tau_{\\mathrm{d}}} = K G_{\\mathrm{p}} \\frac{1}{1 \\cdot 1} e^{0} = K G_{\\mathrm{p}} $$\nThe sensitivity at $s=0$ is then:\n$$ S(j0) = \\frac{1}{1 + L(j0)} = \\frac{1}{1 + K G_{\\mathrm{p}}} $$\nSince the parameters $K$ and $G_{\\mathrm{p}}$ are positive real numbers for the given test cases, the magnitude is simply:\n$$ |S(j0)| = \\frac{1}{1 + K G_{\\mathrm{p}}} $$\n\n### 3. Gain Margin (GM)\nThe gain margin is determined from the Nyquist plot of $L(j\\omega)$. It requires finding the phase-crossover frequency, $\\omega_{\\mathrm{pc}}$, which is any frequency where the phase of $L(j\\omega)$ is exactly $-\\pi$ radians (or $-180^{\\circ}$).\nThe phase of $L(j\\omega)$, denoted $\\arg(L(j\\omega))$, is the sum of the phases of its components:\n$$ \\arg(L(j\\omega)) = \\arg(K G_{\\mathrm{p}}) + \\arg(1 + j\\omega/\\omega_{\\mathrm{z}}) - \\arg(1 + j\\omega/\\omega_{\\mathrm{m}}) - \\arg(1 + j\\omega/\\omega_{\\mathrm{tgf}}) + \\arg(e^{-j\\omega\\tau_{\\mathrm{d}}}) $$\nGiven that $K G_{\\mathrm{p}} > 0$, its phase is $0$. The phase of a complex number $1 + jx$ is $\\arctan(x)$, and the phase of $e^{-j\\theta}$ is $-\\theta$. Therefore:\n$$ \\arg(L(j\\omega)) = \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{z}}}\\right) - \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{m}}}\\right) - \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{tgf}}}\\right) - \\omega \\tau_{\\mathrm{d}} $$\nThe phase-crossover frequency $\\omega_{\\mathrm{pc}}$ is a positive root of the transcendental equation:\n$$ \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{z}}}\\right) - \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{m}}}\\right) - \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{tgf}}}\\right) - \\omega_{\\mathrm{pc}} \\tau_{\\mathrm{d}} = -\\pi $$\nThis equation is solved numerically. A numerical root-finding algorithm, such as the Brent-Dekker method (`brentq`), is suitable. We search for a root $\\omega_{\\mathrm{pc}} > 0$.\n- If no such positive root exists, there is no phase crossover. This occurs, for instance, if $\\tau_{\\mathrm{d}}=0$, as the combined phase of the rational part of the transfer function is bounded between $0$ and $-\\pi/2$. In this case, the gain margin $GM$ is defined as $+\\infty$.\n- If a root $\\omega_{\\mathrm{pc}}$ is found, we then calculate the magnitude $|L(j\\omega_{\\mathrm{pc}})|$:\n$$ |L(j\\omega_{\\mathrm{pc}})| = K G_{\\mathrm{p}} \\frac{|1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{z}}|}{|1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{m}}||1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{tgf}}|} |e^{-j\\omega_{\\mathrm{pc}}\\tau_{\\mathrm{d}}|} $$\n$$ |L(j\\omega_{\\mathrm{pc}})| = K G_{\\mathrm{p}} \\frac{\\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{z}})^2}}{\\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{m}})^2} \\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{tgf}})^2}} $$\nThe gain margin is then the reciprocal of this magnitude:\n$$ GM = \\frac{1}{|L(j\\omega_{\\mathrm{pc}})|} $$\n\n### 4. Closed-Loop Stability\nThe Nyquist stability criterion is used to determine closed-loop stability. The problem states that the open-loop plant $P(s)$ has no poles in the right-half of the complex plane ($P=0$). Consequently, for the closed-loop system to be stable, the Nyquist plot of the loop transfer function $L(j\\omega)$ must not encircle the critical point $-1+j0$ ($N=0$).\n\nFor this class of system (stable open-loop plant), stability can be inferred from the gain margin:\n- If no phase crossover exists ($GM=+\\infty$), the Nyquist plot does not cross the negative real axis to the left of the origin, thus it cannot encircle $-1$. The system is stable.\n- If a phase crossover exists, the system is stable if and only if the gain at that crossover is less than one: $|L(j\\omega_{\\mathrm{pc}})| < 1$. This is equivalent to a gain margin $GM > 1$.\n- If $GM \\le 1$, the system is unstable or marginally stable. The problem requests a boolean output, so we classify $GM \\le 1$ as unstable.\n\nThus, stability is determined by the condition: `stable = (GM > 1) or (GM is infinite)`.\n\n### Algorithmic Implementation\nThe overall algorithm for each test case is:\n1.  Read the parameters $(G_{\\mathrm{p}}, \\omega_{\\mathrm{m}}, \\omega_{\\mathrm{tgf}}, \\omega_{\\mathrm{z}}, \\tau_{\\mathrm{d}}, K)$.\n2.  Calculate $|S(j0)| = 1 / (1 + K G_{\\mathrm{p}})$.\n3.  Define the phase function $\\Phi(\\omega) = \\arctan(\\omega/\\omega_{\\mathrm{z}}) - \\arctan(\\omega/\\omega_{\\mathrm{m}}) - \\arctan(\\omega/\\omega_{\\mathrm{tgf}}) - \\omega\\tau_{\\mathrm{d}} + \\pi$.\n4.  If $\\tau_{\\mathrm{d}} = 0$, set $GM = +\\infty$.\n5.  If $\\tau_{\\mathrm{d}} > 0$, use a numerical solver to find the smallest positive root $\\omega_{\\mathrm{pc}}$ of $\\Phi(\\omega)=0$. If no root is found in a reasonable frequency range, set $GM = +\\infty$. Otherwise, calculate $|L(j\\omega_{\\mathrm{pc}})|$ and set $GM = 1 / |L(j\\omega_{\\mathrm{pc}})|$.\n6.  Determine stability: `is_stable = (GM > 1.0 or GM is infinite)`.\n7.  Collect the results: $[|S(j0)|, GM, \\text{is\\_stable}]$, ensuring floats are rounded to $6$ decimal places.\n\nThis procedure will be applied to all test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the renal autoregulation control problem for a given set of test cases.\n    \"\"\"\n\n    # Test cases: (Gp, wm, wtgf, wz, td, K)\n    test_cases = [\n        (1.0, 0.7, 0.05, 0.02, 6.0, 2.0),\n        (1.0, 0.7, 0.05, 0.02, 6.0, 8.0),\n        (1.0, 0.5, 0.05, 0.01, 0.0, 20.0),\n        (1.2, 0.5, 0.04, 0.01, 20.0, 5.0),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Gp, wm, wtgf, wz, td, K = case\n\n        # 1. Calculate low-frequency sensitivity magnitude |S(j0)|\n        L_dc = K * Gp\n        s_at_0 = 1.0 / (1.0 + L_dc)\n\n        # 2. Calculate Gain Margin (GM)\n        # The phase of L(jw) must equal -pi.\n        # arg(L) = atan(w/wz) - atan(w/wm) - atan(w/wtgf) - w*td\n        # We need to find the root of phase_equation(w) = 0\n        def phase_equation(w):\n            if w <= 0:\n                # Avoid division by zero and handle limit. Phase is 0 at w=0.\n                return np.pi\n            return np.arctan(w / wz) - np.arctan(w / wm) - np.arctan(w / wtgf) - w * td + np.pi\n\n        gm = np.inf\n        w_pc = None\n\n        # A phase crossover can only occur if the time delay td is positive.\n        # If td=0, the phase asymptotically approaches -pi/2 rad.\n        if td > 0:\n            try:\n                # Search for the phase-crossover frequency w_pc in a reasonable range.\n                # The phase equation starts at +pi for w->0 and becomes negative for large w.\n                # A bracket [a, b] where f(a) * f(b) < 0 is required for brentq.\n                search_bracket = [1e-9, 100.0]\n                w_pc = brentq(phase_equation, search_bracket[0], search_bracket[1])\n            except ValueError:\n                # brentq raises ValueError if no root is found in the bracket\n                w_pc = None\n\n        if w_pc is not None:\n            # Calculate magnitude at phase crossover frequency w_pc\n            mag_at_w_pc = (K * Gp *\n                           np.sqrt(1 + (w_pc / wz)**2) /\n                           (np.sqrt(1 + (w_pc / wm)**2) * np.sqrt(1 + (w_pc / wtgf)**2)))\n\n            if mag_at_w_pc > 0:\n                gm = 1.0 / mag_at_w_pc\n\n        # 3. Determine closed-loop stability\n        # For a stable open-loop plant, stability requires GM > 1.\n        is_stable = (gm > 1.0) or np.isinf(gm)\n\n        # 4. Format results\n        s_at_0_rounded = round(s_at_0, 6)\n        \n        if np.isinf(gm):\n            gm_rounded = gm\n        else:\n            gm_rounded = round(gm, 6)\n        \n        all_results.append([s_at_0_rounded, gm_rounded, is_stable])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list includes spaces, which matches the visual example in the prompt.\n    # The instruction `[{','.join(map(str, results))}]` is interpreted as applying str() to each sublist.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}