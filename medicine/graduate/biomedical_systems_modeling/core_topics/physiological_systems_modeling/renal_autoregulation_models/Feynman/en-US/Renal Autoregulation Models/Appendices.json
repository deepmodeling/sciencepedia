{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp renal autoregulation, we must be able to quantify its effectiveness. This first practice provides an analytical foundation by modeling the steady-state relationship between arterial pressure and glomerular blood flow. By deriving the sensitivity of flow to pressure, you will see precisely how the feedback gains of the myogenic and tubuloglomerular feedback (TGF) mechanisms contribute to the characteristic plateau of the autoregulatory curve . This exercise sharpens your skills in implicit differentiation and provides a clear link between model parameters and physiological function.",
            "id": "3925051",
            "problem": "Renal autoregulation maintains a near-constant glomerular blood flow against changes in arterial pressure by combining a fast myogenic response in the afferent arteriole and a slower Tubuloglomerular Feedback (TGF) response mediated by the macula densa. Consider a steady-state, two-loop model based on the hydraulic analog that treats the renal microvasculature as a series resistance. Let $P$ denote the arterial pressure at the afferent inlet and let $P_{v}$ denote the fixed downstream pressure lumped to include postglomerular and capsular pressures. Let $Q$ denote the steady glomerular blood flow. Let the total resistance be the sum of an afferent component $R_{a}$ and a lumped postglomerular component $R_{p0}$, which is assumed constant over the operating range of interest. The steady relation between pressure and flow is taken as $Q = (P - P_{v})/(R_{a} + R_{p0})$. At a baseline operating point $(P_{0},Q_{0},R_{a0})$, these quantities satisfy $Q_{0} = (P_{0} - P_{v})/(R_{a0} + R_{p0})$.\n\nAssume that around $(P_{0},Q_{0})$, the afferent resistance $R_{a}$ depends on pressure and tubular flow (taken proportional to $Q$ at steady state) through the combined action of myogenic and Tubuloglomerular Feedback (TGF) mechanisms. For sufficiently small perturbations, model this dependence by a first-order linearization\n$$\nR_{a}(P,Q) \\approx R_{a0} + a_{m}\\,(P - P_{0}) + a_{t}\\,(Q - Q_{0}),\n$$\nwhere $a_{m} = \\left.\\partial R_{a}/\\partial P\\right|_{(P_{0},Q_{0})} \\gt 0$ summarizes the static myogenic gain and $a_{t} = \\left.\\partial R_{a}/\\partial Q\\right|_{(P_{0},Q_{0})} \\gt 0$ summarizes the static TGF gain (including the proportionality between macula densa flow and $Q$). Treat $a_{m}$ and $a_{t}$ as constants over the linearization range.\n\nUsing only the stated physical base (the hydraulic analog $Q = (P - P_{v})/(R_{a}+R_{p0})$ and linearization), derive the exact small-signal sensitivity $\\partial Q/\\partial P$ evaluated at $(P_{0},Q_{0})$ for this two-loop autoregulatory model. Express your final result solely in terms of $Q_{0}$, $R_{a0}$, $R_{p0}$, $a_{m}$, and $a_{t}$ as a single closed-form analytic expression. Do not compute any numerical values. State only the final expression for $\\partial Q/\\partial P$.",
            "solution": "The problem requires the derivation of the small-signal sensitivity of glomerular blood flow to arterial pressure, $\\frac{\\partial Q}{\\partial P}$, evaluated at a baseline operating point $(P_{0},Q_{0},R_{a0})$. The model is described by a system of two coupled steady-state equations.\n\nThe first equation is the hydraulic analog for blood flow through the renal microvasculature, treated as a series of resistances:\n$$\nQ = \\frac{P - P_{v}}{R_{a} + R_{p0}}\n$$\nwhere $P$ is the arterial pressure, $Q$ is the glomerular blood flow, $R_{a}$ is the afferent arteriolar resistance, $P_{v}$ is the fixed downstream pressure, and $R_{p0}$ is the constant postglomerular resistance. For easier differentiation, this can be rearranged as:\n$$\nQ(R_{a} + R_{p0}) = P - P_{v} \\quad (*).\n$$\n\nThe second equation models the dependence of the afferent resistance $R_{a}$ on pressure $P$ and flow $Q$ via the myogenic and Tubuloglomerular Feedback (TGF) mechanisms. This relationship is given as a first-order linearization around the operating point $(P_{0}, Q_{0})$:\n$$\nR_{a}(P,Q) = R_{a0} + a_{m}(P - P_{0}) + a_{t}(Q - Q_{0}) \\quad (**).\n$$\nHere, $a_{m} = \\left.\\frac{\\partial R_{a}}{\\partial P}\\right|_{(P_{0},Q_{0})}$ and $a_{t} = \\left.\\frac{\\partial R_{a}}{\\partial Q}\\right|_{(P_{0},Q_{0})}$ are the constant static gains of the myogenic and TGF responses, respectively.\n\nOur goal is to find $\\frac{\\partial Q}{\\partial P}$. Since $Q$ and $R_{a}$ are functions of $P$ (and $Q$ itself), we must use implicit differentiation. We differentiate equation $(*)$ with respect to $P$. Applying the product rule to the left-hand side, and noting that $P_{v}$ and $R_{p0}$ are constants, we get:\n$$\n\\frac{\\partial}{\\partial P}[Q(R_{a} + R_{p0})] = \\frac{\\partial}{\\partial P}[P - P_{v}]\n$$\n$$\n\\frac{\\partial Q}{\\partial P}(R_{a} + R_{p0}) + Q \\left(\\frac{\\partial R_{a}}{\\partial P} + \\frac{\\partial R_{p0}}{\\partial P}\\right) = 1 - 0\n$$\n$$\n\\frac{\\partial Q}{\\partial P}(R_{a} + R_{p0}) + Q \\frac{\\partial R_{a}}{\\partial P} = 1.\n$$\nThis equation contains the term $\\frac{\\partial R_{a}}{\\partial P}$, which we must determine. We find this by differentiating the linearized resistance equation $(**)$ with respect to $P$. Note that $R_{a0}$, $P_{0}$, $Q_{0}$, $a_{m}$, and $a_{t}$ are constants.\n$$\n\\frac{\\partial R_{a}}{\\partial P} = \\frac{\\partial}{\\partial P}[R_{a0} + a_{m}(P - P_{0}) + a_{t}(Q - Q_{0})]\n$$\n$$\n\\frac{\\partial R_{a}}{\\partial P} = a_{m} \\frac{\\partial P}{\\partial P} + a_{t} \\frac{\\partial Q}{\\partial P}\n$$\n$$\n\\frac{\\partial R_{a}}{\\partial P} = a_{m} + a_{t} \\frac{\\partial Q}{\\partial P}.\n$$\nNow, we substitute this expression for $\\frac{\\partial R_{a}}{\\partial P}$ back into the differentiated hydraulic equation:\n$$\n\\frac{\\partial Q}{\\partial P}(R_{a} + R_{p0}) + Q \\left(a_{m} + a_{t} \\frac{\\partial Q}{\\partial P}\\right) = 1.\n$$\nWe are asked to evaluate this sensitivity at the specific operating point $(P_{0}, Q_{0}, R_{a0})$. At this point, the variables $P$, $Q$, and $R_{a}$ take on the values $P_{0}$, $Q_{0}$, and $R_{a0}$ respectively. Let the sensitivity at this point be denoted by $\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0}$. Substituting these values, we have:\n$$\n\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0} (R_{a0} + R_{p0}) + Q_{0} \\left(a_{m} + a_{t} \\left.\\frac{\\partial Q}{\\partial P}\\right|_{0}\\right) = 1.\n$$\nNow, we solve this algebraic equation for $\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0}$. First, we distribute the $Q_{0}$ term:\n$$\n\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0} (R_{a0} + R_{p0}) + Q_{0} a_{m} + Q_{0} a_{t} \\left.\\frac{\\partial Q}{\\partial P}\\right|_{0} = 1.\n$$\nNext, we group the terms containing $\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0}$:\n$$\n\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0} (R_{a0} + R_{p0} + Q_{0} a_{t}) = 1 - Q_{0} a_{m}.\n$$\nFinally, we isolate the sensitivity $\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0}$ by dividing both sides by the term in the parenthesis:\n$$\n\\left.\\frac{\\partial Q}{\\partial P}\\right|_{0} = \\frac{1 - Q_{0} a_{m}}{R_{a0} + R_{p0} + Q_{0} a_{t}}.\n$$\nThis expression gives the small-signal sensitivity of glomerular flow with respect to arterial pressure, evaluated at the operating point, solely in terms of the required parameters $Q_{0}$, $R_{a0}$, $R_{p0}$, $a_{m}$, and $a_{t}$.",
            "answer": "$$\\boxed{\\frac{1 - Q_{0} a_{m}}{R_{a0} + R_{p0} + Q_{0} a_{t}}}$$"
        },
        {
            "introduction": "While steady-state analysis is crucial, physiological systems are inherently dynamic. This exercise transitions from static equilibrium to the dynamic response of renal blood flow to pressure fluctuations. You will practice the essential technique of linearizing a nonlinear model around an operating point to derive a transfer function . This process transforms a complex differential equation into a more manageable algebraic form in the frequency domain, opening the door to powerful control theory methods for analyzing system behavior.",
            "id": "3925106",
            "problem": "Consider a lumped-parameter model of Renal Blood Flow (RBF) autoregulation in which the afferent arteriolar resistance responds dynamically to sensed tubular flow. The renal vasculature is represented by an afferent arteriolar resistance $R_a$ in series with a downstream resistance $R_d$ (representing post-glomerular and venous segments). Arterial pressure is $P_a$ and venous pressure is $P_v$ (treated as constant). The volumetric flow $Q$ satisfies the hemodynamic relation that flow equals pressure drop divided by total resistance. The afferent arteriolar resistance evolves according to a first-order relaxation toward a nonlinear target set by tubuloglomerular feedback. Specifically, the governing equations are\n$$\nQ \\;=\\; \\frac{P_a - P_v}{R_a + R_d},\n$$\n$$\n\\frac{d R_a}{dt} \\;=\\; \\frac{1}{\\tau}\\Big(R_a^{\\ast}(Q) - R_a\\Big),\n$$\n$$\nR_a^{\\ast}(Q) \\;=\\; R_{a0}\\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big],\n$$\nwhere $R_{a0} \\gt 0$ is the steady-state afferent resistance at the operating point, $Q_0 \\gt 0$ is the steady-state flow, $\\tau \\gt 0$ is the resistance adaptation time constant, and $\\alpha \\gt 0$, $\\beta \\gt 0$ characterize the sensitivity and saturation of tubuloglomerular feedback. Assume the system is linearized about the equilibrium $(P_{a0}, Q_0, R_{a0})$ that satisfies $Q_0 = (P_{a0} - P_v)/(R_{a0} + R_d)$ and $R_a^{\\ast}(Q_0) = R_{a0}$.\n\nStarting from these equations and treating $P_a$ as the input, perform a small-signal linearization around the equilibrium to obtain the transfer function $G(s)$ from the arterial pressure perturbation to the flow perturbation, that is $G(s) = \\tilde{Q}(s)/\\tilde{P}_a(s)$, where tildes denote small deviations from the equilibrium. Then, compute the low-frequency gain $G(0)$ in closed form.\n\nExpress the low-frequency gain in analytic form using the symbols $R_{a0}$, $R_d$, $Q_0$, $\\alpha$, and $\\beta$. The quantity $G(0)$ has physical units of volume per time per pressure; if you later choose to numerically evaluate your expression, express the gain in $\\mathrm{mL}\\,\\mathrm{s}^{-1}\\,\\mathrm{mmHg}^{-1}$. Do not include units inside your boxed final answer.",
            "solution": "The problem requires the derivation of the low-frequency gain of a linearized model of renal autoregulation. The system's behavior is described by a set of coupled algebraic and differential equations. The process involves linearizing these equations around a specified equilibrium point, deriving the transfer function from arterial pressure to renal blood flow, and then evaluating this transfer function at zero frequency.\n\nFirst, we define the equilibrium state of the system by the variables $(P_{a0}, Q_0, R_{a0})$. The perturbations around this equilibrium are defined as:\n$P_a(t) = P_{a0} + \\tilde{P}_a(t)$\n$Q(t) = Q_0 + \\tilde{Q}(t)$\n$R_a(t) = R_{a0} + \\tilde{R}_a(t)$\n\nThe provided equations are:\n1. Hemodynamics: $Q = \\frac{P_a - P_v}{R_a + R_d}$\n2. Resistance dynamics: $\\frac{dR_a}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q) - R_a\\Big)$\n3. Feedback function: $R_a^{\\ast}(Q) = R_{a0}\\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big]$\n\nThe equilibrium is defined by the conditions $Q_0 = \\frac{P_{a0} - P_v}{R_{a0} + R_d}$ and $R_a^{\\ast}(Q_0) = R_{a0}$.\n\nWe proceed by linearizing each equation for small perturbations.\n\n**Linearization of the Hemodynamic Equation**\n\nWe linearize the equation $Q = \\frac{P_a - P_v}{R_a + R_d}$ around the equilibrium point. We can use a first-order multivariate Taylor series expansion for $Q(P_a, R_a)$:\n$\\tilde{Q} \\approx \\frac{\\partial Q}{\\partial P_a}\\bigg|_{(P_{a0}, R_{a0})} \\tilde{P}_a + \\frac{\\partial Q}{\\partial R_a}\\bigg|_{(P_{a0}, R_{a0})} \\tilde{R}_a$\n\nThe partial derivatives are:\n$\\frac{\\partial Q}{\\partial P_a} = \\frac{1}{R_a + R_d}$. At equilibrium, this is $\\frac{1}{R_{a0} + R_d}$.\n$\\frac{\\partial Q}{\\partial R_a} = -\\frac{P_a - P_v}{(R_a + R_d)^2} = -\\frac{Q}{R_a + R_d}$. At equilibrium, this is $-\\frac{Q_0}{R_{a0} + R_d}$.\n\nSubstituting these into the Taylor expansion gives the first linearized equation:\n$$\n\\tilde{Q} = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a - \\frac{Q_0}{R_{a0} + R_d} \\tilde{R}_a\n$$\n\n**Linearization of the Resistance Dynamics**\n\nWe substitute the perturbation variables into the differential equation:\n$\\frac{d(R_{a0} + \\tilde{R}_a)}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q_0 + \\tilde{Q}) - (R_{a0} + \\tilde{R}_a)\\Big)$\nSince $R_{a0}$ is a constant, its derivative is zero:\n$\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} \\Big(R_a^{\\ast}(Q_0 + \\tilde{Q}) - R_{a0} - \\tilde{R}_a\\Big)$\n\nNext, we linearize the feedback function $R_a^{\\ast}(Q)$ around $Q_0$:\n$R_a^{\\ast}(Q_0 + \\tilde{Q}) \\approx R_a^{\\ast}(Q_0) + \\frac{dR_a^{\\ast}}{dQ}\\bigg|_{Q=Q_0} \\tilde{Q}$\nWe know from the problem statement that $R_a^{\\ast}(Q_0) = R_{a0}$. We compute the derivative:\n$\\frac{dR_a^{\\ast}}{dQ} = R_{a0} \\frac{d}{dQ} \\Big[1 + \\alpha \\tanh\\big(\\beta (Q - Q_0)\\big)\\Big] = R_{a0} \\alpha \\beta \\text{sech}^2\\big(\\beta(Q - Q_0)\\big)$\nEvaluating at $Q=Q_0$:\n$\\frac{dR_a^{\\ast}}{dQ}\\bigg|_{Q=Q_0} = R_{a0} \\alpha \\beta \\text{sech}^2(0) = R_{a0} \\alpha \\beta$\nLet us define the feedback gain $K_{TGF} = R_{a0} \\alpha \\beta$.\nThe linearized feedback function is:\n$R_a^{\\ast}(Q_0 + \\tilde{Q}) \\approx R_{a0} + K_{TGF} \\tilde{Q}$\n\nSubstituting this into the dynamic equation for $\\tilde{R}_a$:\n$\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} \\Big((R_{a0} + K_{TGF} \\tilde{Q}) - R_{a0} - \\tilde{R}_a\\Big)$\nThis simplifies to the second linearized equation:\n$$\n\\frac{d\\tilde{R}_a}{dt} = \\frac{1}{\\tau} (K_{TGF} \\tilde{Q} - \\tilde{R}_a)\n$$\n\n**Derivation of the Transfer Function**\n\nTo find the transfer function $G(s) = \\tilde{Q}(s)/\\tilde{P}_a(s)$, we apply the Laplace transform to the two linearized equations, assuming zero initial conditions for the perturbations. Let $\\tilde{Q}(s)$, $\\tilde{P}_a(s)$, and $\\tilde{R}_a(s)$ be the Laplace transforms of $\\tilde{Q}(t)$, $\\tilde{P}_a(t)$, and $\\tilde{R}_a(t)$, respectively.\n\nThe transformed equations are:\n1. $\\tilde{Q}(s) = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s) - \\frac{Q_0}{R_{a0} + R_d} \\tilde{R}_a(s)$\n2. $s \\tilde{R}_a(s) = \\frac{1}{\\tau} (K_{TGF} \\tilde{Q}(s) - \\tilde{R}_a(s))$\n\nFrom equation (2), we solve for $\\tilde{R}_a(s)$ in terms of $\\tilde{Q}(s)$:\n$s \\tilde{R}_a(s) + \\frac{1}{\\tau} \\tilde{R}_a(s) = \\frac{K_{TGF}}{\\tau} \\tilde{Q}(s)$\n$\\tilde{R}_a(s) \\left(s + \\frac{1}{\\tau}\\right) = \\frac{K_{TGF}}{\\tau} \\tilde{Q}(s)$\n$\\tilde{R}_a(s) = \\frac{K_{TGF}/\\tau}{s + 1/\\tau} \\tilde{Q}(s) = \\frac{K_{TGF}}{1 + \\tau s} \\tilde{Q}(s)$\n\nNow we substitute this expression for $\\tilde{R}_a(s)$ into equation (1):\n$\\tilde{Q}(s) = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s) - \\frac{Q_0}{R_{a0} + R_d} \\left( \\frac{K_{TGF}}{1 + \\tau s} \\tilde{Q}(s) \\right)$\n\nWe group the terms with $\\tilde{Q}(s)$:\n$\\tilde{Q}(s) \\left[ 1 + \\frac{Q_0 K_{TGF}}{(R_{a0} + R_d)(1 + \\tau s)} \\right] = \\frac{1}{R_{a0} + R_d} \\tilde{P}_a(s)$\n\nNow we solve for the transfer function $G(s) = \\frac{\\tilde{Q}(s)}{\\tilde{P}_a(s)}$:\n$G(s) = \\frac{\\frac{1}{R_{a0} + R_d}}{1 + \\frac{Q_0 K_{TGF}}{(R_{a0} + R_d)(1 + \\tau s)}}$\nTo simplify, we multiply the numerator and denominator by $(R_{a0} + R_d)(1 + \\tau s)$:\n$G(s) = \\frac{1 + \\tau s}{(R_{a0} + R_d)(1 + \\tau s) + Q_0 K_{TGF}}$\n\nSubstituting back $K_{TGF} = R_{a0} \\alpha \\beta$:\n$$\nG(s) = \\frac{1 + \\tau s}{(R_{a0} + R_d)(1 + \\tau s) + Q_0 R_{a0} \\alpha \\beta}\n$$\n\n**Calculation of the Low-Frequency Gain**\n\nThe low-frequency gain, denoted as $G(0)$, is the value of the transfer function at $s=0$. This represents the steady-state response of the output (flow perturbation) to a step change in the input (pressure perturbation).\nWe set $s=0$ in the expression for $G(s)$:\n$G(0) = \\frac{1 + \\tau(0)}{(R_{a0} + R_d)(1 + \\tau(0)) + Q_0 R_{a0} \\alpha \\beta}$\n$G(0) = \\frac{1}{(R_{a0} + R_d)(1) + Q_0 R_{a0} \\alpha \\beta}$\n\nThe final expression for the low-frequency gain is:\n$$\nG(0) = \\frac{1}{R_{a0} + R_d + Q_0 R_{a0} \\alpha \\beta}\n$$\nThis expression is in the required analytic form, using the specified symbols. The denominator represents the total effective resistance of the vasculature in the presence of tubuloglomerular feedback at steady state. The term $Q_0 R_{a0} \\alpha \\beta$ reflects the additional \"resistance\" contributed by the active feedback mechanism, which acts to stabilize flow.",
            "answer": "$$\n\\boxed{\\frac{1}{R_{a0} + R_d + Q_0 R_{a0} \\alpha \\beta}}\n$$"
        },
        {
            "introduction": "Feedback is a double-edged sword: it enables robust regulation but can also introduce instability and oscillations. This final practice moves from analytical derivation to computational simulation to explore this critical trade-off. By implementing a model that includes both myogenic and TGF dynamics along with inherent biological delays, you will use tools like the Nyquist plot to assess system stability . This hands-on coding exercise demonstrates how increasing feedback gain enhances disturbance rejection at the cost of reducing the stability margin, a fundamental principle in the design of any feedback control system.",
            "id": "3925090",
            "problem": "Consider a linearized small-signal model of renal autoregulation where the afferent arteriole and feedback sensing constitute a single-input single-output loop driven by disturbances in arterial pressure. The two dominant physiological mechanisms are the myogenic response and the tubuloglomerular feedback (TGF). The myogenic response modulates afferent arteriolar resistance in response to transmural pressure changes, and the tubuloglomerular feedback (TGF) modulates afferent tone based on macula densa sensing of distal tubular flow. For small perturbations around a steady operating point, model the open-loop plant as a cascade of first-order elements and a pure time delay to capture transport and signaling latencies:\n- A first-order lag for the myogenic response with break frequency $\\omega_{\\mathrm{m}}$ in $\\mathrm{rad/s}$.\n- A first-order lag for the tubuloglomerular feedback with break frequency $\\omega_{\\mathrm{tgf}}$ in $\\mathrm{rad/s}$.\n- A single zero with break frequency $\\omega_{\\mathrm{z}}$ in $\\mathrm{rad/s}$ representing the net direct flow-dependence in the sensing path.\n- A pure time delay $\\tau_{\\mathrm{d}}$ in $\\mathrm{s}$ representing transport and signaling delay.\nLet the dimensionless steady-state gain of the plant be $G_{\\mathrm{p}}$. Let the dimensionless feedback gain be $K$. Denote the Laplace variable by $s$ with the frequency axis $s = j \\omega$, where angles are measured in radians.\n\nUse the following standard building blocks to construct the open-loop transfer function:\n- First-order lag block $B(s)$ has the form $B(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{b}}}$ with break frequency $\\omega_{\\mathrm{b}}$.\n- Single zero block $Z(s)$ has the form $Z(s) = 1 + s/\\omega_{\\mathrm{z}}$.\n- Pure time delay $D(s)$ has the form $D(s) = e^{- s \\tau_{\\mathrm{d}}}$.\nCompose these elements to obtain the open-loop plant $P(s)$ and then the open-loop loop transfer function $L(s) = K \\, P(s)$.\n\nDefine the sensitivity function $S(s)$ for disturbance rejection as $S(s) = \\dfrac{1}{1 + L(s)}$. Low-frequency disturbance rejection quality is indicated by the magnitude $\\left| S(j \\omega) \\right|$ at small $\\omega$, in particular at $\\omega = 0$.\n\nDefine the gain margin using the Nyquist plot of $L(s)$ as follows. Let $\\omega_{\\mathrm{pc}}$ be any phase-crossover frequency satisfying $\\arg\\!\\left( L(j \\omega_{\\mathrm{pc}}) \\right) = - \\pi$ (angles in radians). If such an $\\omega_{\\mathrm{pc}}$ exists, the gain margin is $GM = \\dfrac{1}{\\left| L(j \\omega_{\\mathrm{pc}}) \\right|}$; if no phase crossover exists over the considered frequency range, set $GM$ to $+\\infty$. Assume the open-loop plant $P(s)$ has zero right-half-plane poles. Use the Nyquist stability criterion to determine closed-loop stability by computing the winding number of the Nyquist plot of $L(s)$ around the point $-1$ in the complex plane; zero encirclements imply closed-loop stability, nonzero encirclements imply closed-loop instability.\n\nYour task is to implement a program that, for each specified test case, constructs $L(s)$ from the provided parameters, computes the low-frequency sensitivity magnitude $\\left| S(j 0) \\right|$, computes the gain margin $GM$ from the Nyquist plot based on the phase-crossover definition above, and determines closed-loop stability using the Nyquist encirclement criterion. All frequencies must be treated in $\\mathrm{rad/s}$ and the time delay in $\\mathrm{s}$. The output for each test case must be a list with three elements: the float $\\left| S(j 0) \\right|$ rounded to $6$ decimal places, the float $GM$ rounded to $6$ decimal places (or $+\\infty$ if no phase crossover exists), and a boolean indicating closed-loop stability, in that order. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[ [a,b,c],[d,e,f] \\right]$).\n\nUse the following test suite (each tuple of parameters is ordered as $(G_{\\mathrm{p}}, \\omega_{\\mathrm{m}}, \\omega_{\\mathrm{tgf}}, \\omega_{\\mathrm{z}}, \\tau_{\\mathrm{d}}, K)$):\n- Test case $1$ (general case with moderate delay and moderate gain): $(1.0, 0.7, 0.05, 0.02, 6.0, 2.0)$.\n- Test case $2$ (increased gain to probe margin reduction): $(1.0, 0.7, 0.05, 0.02, 6.0, 8.0)$.\n- Test case $3$ (edge case: zero delay yields no phase crossover over practical band): $(1.0, 0.5, 0.05, 0.01, 0.0, 20.0)$.\n- Test case $4$ (large delay and significant gain to induce oscillatory tendency): $(1.2, 0.5, 0.04, 0.01, 20.0, 5.0)$.\n\nScientific realism constraints:\n- The break frequencies $\\omega_{\\mathrm{m}}$ and $\\omega_{\\mathrm{tgf}}$ reflect the characteristic response rates of the myogenic mechanism and tubuloglomerular feedback (TGF), respectively.\n- The delay $\\tau_{\\mathrm{d}}$ aggregates transport and signaling latencies in the feedback loop.\n\nAngle units must be radians. Express all computed magnitudes as dimensionless floats. The final output must be exactly one line containing the comma-separated Python list representation of the per-test-case results, enclosed in square brackets. Round all specified floats to $6$ decimal places before printing.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in control theory applied to a standard biomedical model, is well-posed with sufficient data and clear objectives, and is free of contradictions or ambiguities.\n\nHerein, a step-by-step derivation of the solution is provided.\n\n### 1. Model Formulation\nThe problem describes a single-input single-output (SISO) feedback loop for renal autoregulation. The open-loop plant transfer function, $P(s)$, is a cascade of several elements. Based on the provided building blocks, $P(s)$ is constructed as follows:\n- Myogenic response lag: $B_{\\mathrm{m}}(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{m}}}$\n- Tubuloglomerular feedback (TGF) lag: $B_{\\mathrm{tgf}}(s) = \\dfrac{1}{1 + s/\\omega_{\\mathrm{tgf}}}$\n- Sensing path zero: $Z(s) = 1 + s/\\omega_{\\mathrm{z}}$\n- Pure time delay: $D(s) = e^{-s \\tau_{\\mathrm{d}}}$\n- Steady-state plant gain: $G_{\\mathrm{p}}$\n\nThe complete plant transfer function $P(s)$ is the product of these components:\n$$ P(s) = G_{\\mathrm{p}} \\cdot B_{\\mathrm{m}}(s) \\cdot B_{\\mathrm{tgf}}(s) \\cdot Z(s) \\cdot D(s) = G_{\\mathrm{p}} \\frac{1 + s/\\omega_{\\mathrm{z}}}{(1 + s/\\omega_{\\mathrm{m}})(1 + s/\\omega_{\\mathrm{tgf}})} e^{-s \\tau_{\\mathrm{d}}} $$\nThe open-loop loop transfer function, $L(s)$, includes the feedback gain $K$:\n$$ L(s) = K \\cdot P(s) = K G_{\\mathrm{p}} \\frac{1 + s/\\omega_{\\mathrm{z}}}{(1 + s/\\omega_{\\mathrm{m}})(1 + s/\\omega_{\\mathrm{tgf}})} e^{-s \\tau_{\\mathrm{d}}} $$\n\n### 2. Low-Frequency Sensitivity Magnitude\nThe sensitivity function $S(s)$ is defined as $S(s) = \\dfrac{1}{1 + L(s)}$. It quantifies the system's ability to reject disturbances. The low-frequency disturbance rejection is evaluated at $\\omega = 0$, which corresponds to $s = j\\omega = 0$.\n\nFirst, we find the DC gain of the loop transfer function, $L(j0)$:\n$$ L(j0) = K G_{\\mathrm{p}} \\frac{1 + j0/\\omega_{\\mathrm{z}}}{(1 + j0/\\omega_{\\mathrm{m}})(1 + j0/\\omega_{\\mathrm{tgf}})} e^{-j0 \\cdot \\tau_{\\mathrm{d}}} = K G_{\\mathrm{p}} \\frac{1}{1 \\cdot 1} e^{0} = K G_{\\mathrm{p}} $$\nThe sensitivity at $s=0$ is then:\n$$ S(j0) = \\frac{1}{1 + L(j0)} = \\frac{1}{1 + K G_{\\mathrm{p}}} $$\nSince the parameters $K$ and $G_{\\mathrm{p}}$ are positive real numbers for the given test cases, the magnitude is simply:\n$$ |S(j0)| = \\frac{1}{1 + K G_{\\mathrm{p}}} $$\n\n### 3. Gain Margin (GM)\nThe gain margin is determined from the Nyquist plot of $L(j\\omega)$. It requires finding the phase-crossover frequency, $\\omega_{\\mathrm{pc}}$, which is any frequency where the phase of $L(j\\omega)$ is exactly $-\\pi$ radians (or $-180^{\\circ}$).\nThe phase of $L(j\\omega)$, denoted $\\arg(L(j\\omega))$, is the sum of the phases of its components:\n$$ \\arg(L(j\\omega)) = \\arg(K G_{\\mathrm{p}}) + \\arg(1 + j\\omega/\\omega_{\\mathrm{z}}) - \\arg(1 + j\\omega/\\omega_{\\mathrm{m}}) - \\arg(1 + j\\omega/\\omega_{\\mathrm{tgf}}) + \\arg(e^{-j\\omega\\tau_{\\mathrm{d}}}) $$\nGiven that $K G_{\\mathrm{p}} > 0$, its phase is $0$. The phase of a complex number $1 + jx$ is $\\arctan(x)$, and the phase of $e^{-j\\theta}$ is $-\\theta$. Therefore:\n$$ \\arg(L(j\\omega)) = \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{z}}}\\right) - \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{m}}}\\right) - \\arctan\\left(\\frac{\\omega}{\\omega_{\\mathrm{tgf}}}\\right) - \\omega \\tau_{\\mathrm{d}} $$\nThe phase-crossover frequency $\\omega_{\\mathrm{pc}}$ is a positive root of the transcendental equation:\n$$ \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{z}}}\\right) - \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{m}}}\\right) - \\arctan\\left(\\frac{\\omega_{\\mathrm{pc}}}{\\omega_{\\mathrm{tgf}}}\\right) - \\omega_{\\mathrm{pc}} \\tau_{\\mathrm{d}} = -\\pi $$\nThis equation is solved numerically. A numerical root-finding algorithm, such as the Brent-Dekker method (`brentq`), is suitable. We search for a root $\\omega_{\\mathrm{pc}} > 0$.\n- If no such positive root exists, there is no phase crossover. This occurs, for instance, if $\\tau_{\\mathrm{d}}=0$, as the combined phase of the rational part of the transfer function is bounded between $0$ and $-\\pi/2$. In this case, the gain margin $GM$ is defined as $+\\infty$.\n- If a root $\\omega_{\\mathrm{pc}}$ is found, we then calculate the magnitude $|L(j\\omega_{\\mathrm{pc}})|$:\n$$ |L(j\\omega_{\\mathrm{pc}})| = K G_{\\mathrm{p}} \\frac{|1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{z}}|}{|1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{m}}||1 + j\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{tgf}}|} |e^{-j\\omega_{\\mathrm{pc}}\\tau_{\\mathrm{d}}|} $$\n$$ |L(j\\omega_{\\mathrm{pc}})| = K G_{\\mathrm{p}} \\frac{\\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{z}})^2}}{\\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{m}})^2} \\sqrt{1 + (\\omega_{\\mathrm{pc}}/\\omega_{\\mathrm{tgf}})^2}} $$\nThe gain margin is then the reciprocal of this magnitude:\n$$ GM = \\frac{1}{|L(j\\omega_{\\mathrm{pc}})|} $$\n\n### 4. Closed-Loop Stability\nThe Nyquist stability criterion is used to determine closed-loop stability. The problem states that the open-loop plant $P(s)$ has no poles in the right-half of the complex plane ($P=0$). Consequently, for the closed-loop system to be stable, the Nyquist plot of the loop transfer function $L(j\\omega)$ must not encircle the critical point $-1+j0$ ($N=0$).\n\nFor this class of system (stable open-loop plant), stability can be inferred from the gain margin:\n- If no phase crossover exists ($GM=+\\infty$), the Nyquist plot does not cross the negative real axis to the left of the origin, thus it cannot encircle $-1$. The system is stable.\n- If a phase crossover exists, the system is stable if and only if the gain at that crossover is less than one: $|L(j\\omega_{\\mathrm{pc}})| < 1$. This is equivalent to a gain margin $GM > 1$.\n- If $GM \\le 1$, the system is unstable or marginally stable. The problem requests a boolean output, so we classify $GM \\le 1$ as unstable.\n\nThus, stability is determined by the condition: `stable = (GM > 1) or (GM is infinite)`.\n\n### Algorithmic Implementation\nThe overall algorithm for each test case is:\n1.  Read the parameters $(G_{\\mathrm{p}}, \\omega_{\\mathrm{m}}, \\omega_{\\mathrm{tgf}}, \\omega_{\\mathrm{z}}, \\tau_{\\mathrm{d}}, K)$.\n2.  Calculate $|S(j0)| = 1 / (1 + K G_{\\mathrm{p}})$.\n3.  Define the phase function $\\Phi(\\omega) = \\arctan(\\omega/\\omega_{\\mathrm{z}}) - \\arctan(\\omega/\\omega_{\\mathrm{m}}) - \\arctan(\\omega/\\omega_{\\mathrm{tgf}}) - \\omega\\tau_{\\mathrm{d}} + \\pi$.\n4.  If $\\tau_{\\mathrm{d}} = 0$, set $GM = +\\infty$.\n5.  If $\\tau_{\\mathrm{d}} > 0$, use a numerical solver to find the smallest positive root $\\omega_{\\mathrm{pc}}$ of $\\Phi(\\omega)=0$. If no root is found in a reasonable frequency range, set $GM = +\\infty$. Otherwise, calculate $|L(j\\omega_{\\mathrm{pc}})|$ and set $GM = 1 / |L(j\\omega_{\\mathrm{pc}})|$.\n6.  Determine stability: `is_stable = (GM > 1.0 or GM is infinite)`.\n7.  Collect the results: $[|S(j0)|, GM, \\text{is\\_stable}]$, ensuring floats are rounded to $6$ decimal places.\n\nThis procedure will be applied to all test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the renal autoregulation control problem for a given set of test cases.\n    \"\"\"\n\n    # Test cases: (Gp, wm, wtgf, wz, td, K)\n    test_cases = [\n        (1.0, 0.7, 0.05, 0.02, 6.0, 2.0),\n        (1.0, 0.7, 0.05, 0.02, 6.0, 8.0),\n        (1.0, 0.5, 0.05, 0.01, 0.0, 20.0),\n        (1.2, 0.5, 0.04, 0.01, 20.0, 5.0),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        Gp, wm, wtgf, wz, td, K = case\n\n        # 1. Calculate low-frequency sensitivity magnitude |S(j0)|\n        L_dc = K * Gp\n        s_at_0 = 1.0 / (1.0 + L_dc)\n\n        # 2. Calculate Gain Margin (GM)\n        # The phase of L(jw) must equal -pi.\n        # arg(L) = atan(w/wz) - atan(w/wm) - atan(w/wtgf) - w*td\n        # We need to find the root of phase_equation(w) = 0\n        def phase_equation(w):\n            if w <= 0:\n                # Avoid division by zero and handle limit. Phase is 0 at w=0.\n                return np.pi\n            return np.arctan(w / wz) - np.arctan(w / wm) - np.arctan(w / wtgf) - w * td + np.pi\n\n        gm = np.inf\n        w_pc = None\n\n        # A phase crossover can only occur if the time delay td is positive.\n        # If td=0, the phase asymptotically approaches -pi/2 rad.\n        if td > 0:\n            try:\n                # Search for the phase-crossover frequency w_pc in a reasonable range.\n                # The phase equation starts at +pi for w->0 and becomes negative for large w.\n                # A bracket [a, b] where f(a) * f(b) < 0 is required for brentq.\n                search_bracket = [1e-9, 100.0]\n                w_pc = brentq(phase_equation, search_bracket[0], search_bracket[1])\n            except ValueError:\n                # brentq raises ValueError if no root is found in the bracket\n                w_pc = None\n\n        if w_pc is not None:\n            # Calculate magnitude at phase crossover frequency w_pc\n            mag_at_w_pc = (K * Gp *\n                           np.sqrt(1 + (w_pc / wz)**2) /\n                           (np.sqrt(1 + (w_pc / wm)**2) * np.sqrt(1 + (w_pc / wtgf)**2)))\n\n            if mag_at_w_pc > 0:\n                gm = 1.0 / mag_at_w_pc\n\n        # 3. Determine closed-loop stability\n        # For a stable open-loop plant, stability requires GM > 1.\n        is_stable = (gm > 1.0) or np.isinf(gm)\n\n        # 4. Format results\n        s_at_0_rounded = round(s_at_0, 6)\n        \n        if np.isinf(gm):\n            gm_rounded = gm\n        else:\n            gm_rounded = round(gm, 6)\n        \n        all_results.append([s_at_0_rounded, gm_rounded, is_stable])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list includes spaces, which matches the visual example in the prompt.\n    # The instruction `[{','.join(map(str, results))}]` is interpreted as applying str() to each sublist.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}