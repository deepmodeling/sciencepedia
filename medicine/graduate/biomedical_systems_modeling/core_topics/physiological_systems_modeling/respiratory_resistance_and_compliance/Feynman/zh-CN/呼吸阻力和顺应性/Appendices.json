{
    "hands_on_practices": [
        {
            "introduction": "呼吸系统最简单而实用的模型可以类比为一个单室电阻-电容 ($RC$) 电路。本练习将通过将此模型应用于基础生理过程——被动呼气，来巩固对该模型的理解。我们的目标是直接从模型的控制方程中计算内在呼气末正压 ($PEEPi$)，这是机械通气中的一个关键参数，从而将抽象模型与可量化的临床结果联系起来。",
            "id": "3925450",
            "problem": "使用单室肺模型来表示具有恒定线性气道阻力和肺顺应性的被动呼气过程。设 $V(t)$ 表示在呼气过程中，时间 $t$ 时高于弹性平衡（功能残气量）的肺泡容积。气道阻力 $R$ 由阻力压降关系 $\\Delta p_{\\mathrm{R}} = R\\,\\dot{V}$ 定义，其中 $\\dot{V} = dV/dt$ 是容积流量（流入肺部时为正）。肺顺应性 $C$ 由 $V = C\\,p_{\\mathrm{el}}$ 定义，其中 $p_{\\mathrm{el}}$ 是弹性回缩压力，肺弹性 $E$ 为 $E = 1/C$。假设气道开口处施加的外部呼气末正压为零，呼气期间无呼吸肌压力，声门开放，且惯性可忽略不计。\n\n从这些定义和基本压力平衡出发，推导 $V(t)$ 的主控初值问题，并求解该问题以确定高于弹性平衡的呼气末容积 $V(T_e)$ 和呼气末的内源性呼气末正压 (PEEPi)，此处定义为 $t = T_e$ 时的肺泡弹性回缩压力。使用以下参数值：$R = 15\\ \\mathrm{cmH_2O\\cdot s/L}$，$C = 0.08\\ \\mathrm{L/cmH_2O}$，高于弹性平衡的潮气量 $V_T = 0.6\\ \\mathrm{L}$（因此在被动呼气开始时 $V(0) = V_T$），以及呼气时间 $T_e = 1\\ \\mathrm{s}$。\n\n将您的数值结果四舍五入至四位有效数字。呼气末容积以升为单位，PEEPi以厘米水柱为单位。将您的最终答案以二元行矩阵 $\\big(V(T_e),\\ \\mathrm{PEEPi}\\big)$ 的形式报告。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**步骤1：提取已知条件**\n- 模型：用于被动呼气的单室肺模型。\n- 变量：$V(t)$ 是高于弹性平衡的肺泡容积，$\\dot{V} = dV/dt$ 是容积流量（流入为正）。\n- 定义：气道阻力 $R$ 来自 $\\Delta p_{\\mathrm{R}} = R\\,\\dot{V}$。肺顺应性 $C$ 来自 $V = C\\,p_{\\mathrm{el}}$，其中 $p_{\\mathrm{el}}$ 是弹性回缩压力。肺弹性是 $E = 1/C$。\n- 假设：施加的外部呼气末正压为零（$p_{\\text{ao}} = 0$），无呼吸肌压力（$p_{\\text{mus}} = 0$），声门开放，且惯性可忽略不计。\n- 初始条件：$V(0) = V_T = 0.6\\ \\mathrm{L}$。\n- 参数：$R = 15\\ \\mathrm{cmH_2O\\cdot s/L}$，$C = 0.08\\ \\mathrm{L/cmH_2O}$，呼气时间 $T_e = 1\\ \\mathrm{s}$。\n- 要求输出：呼气末容积 $V(T_e)$ 和内源性PEEP (PEEPi)，其中 PEEPi 定义为 $p_{\\mathrm{el}}(T_e)$。\n- 四舍五入：结果需四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据、适定且客观。它描述了一个标准的一阶线性呼吸力学模型，这是生物医学工程和生理学中的一个基本概念。所有定义、参数和条件都得到了明确陈述，并且是一致的、生理学上合理的。该问题是自洽的，没有任何说明中列出的使其无效的缺陷。\n\n**步骤3：结论与行动**\n该问题有效。将推导解答。\n\n**主控方程的推导**\n被动呼气过程由肺的弹性回缩压力 $p_{\\mathrm{el}}$ 驱动。这个压力将空气排出肺部，其能量被气道的阻力特性所耗散。根据所述假设，系统中没有其他压力作用（即，肌肉压力 $p_{\\text{mus}} = 0$ 和气道开口压力 $p_{\\text{ao}} = 0$）。\n\n呼吸系统的压力平衡方程可以写为：\n$$p_{\\mathrm{el}} + p_{\\mathrm{R}} = 0$$\n其中 $p_{\\mathrm{R}}$ 是由阻力引起的压降。弹性回缩压力由顺应性的定义 $V = C\\,p_{\\mathrm{el}}$ 给出，可以重新整理为：\n$$p_{\\mathrm{el}} = \\frac{V}{C}$$\n阻力压降与气流方向相反。在呼气期间，肺容积 $V(t)$ 减小，因此容积变化率 $\\dot{V} = dV/dt$ 为负。气流是向外的。由阻力引起的压降与向外流速成正比。向外流速是 $-\\dot{V}$。因此，阻力上的压降是 $R(-\\dot{V})$。给定的关系 $\\Delta p_{\\mathrm{R}} = R\\dot{V}$ 在这种情况下可以解释为 $p_R = R\\dot{V}$，代表相对于肺泡压力的压力损失。\n\n将 $p_{\\mathrm{el}}$ 和 $p_{\\mathrm{R}}$ 的表达式代入压力平衡方程：\n$$\\frac{V}{C} + R\\,\\frac{dV}{dt} = 0$$\n这是一个一阶线性齐次常微分方程 (ODE)。它可以整理成标准形式：\n$$\\frac{dV}{dt} = -\\frac{1}{RC}V$$\n\n**初值问题的求解**\n乘积 $RC$ 是呼吸系统的时间常数，用 $\\tau$ 表示。\n$$\\tau = RC$$\n因此，ODE 为 $\\frac{dV}{dt} = -\\frac{1}{\\tau}V$。该方程的通解是：\n$$V(t) = A \\exp\\left(-\\frac{t}{\\tau}\\right)$$\n其中 $A$ 是一个积分常数。我们使用问题中给出的初始条件来确定 $A$：在呼气开始时（$t=0$），高于弹性平衡的容积是潮气量，$V(0) = V_T$。\n$$V(0) = V_T = A \\exp\\left(-\\frac{0}{\\tau}\\right) = A \\cdot 1 = A$$\n因此，被动呼气期间容积 $V(t)$ 的特解是：\n$$V(t) = V_T \\exp\\left(-\\frac{t}{RC}\\right)$$\n\n**数值计算**\n首先，我们使用给定的参数值计算时间常数 $\\tau$：\n$$R = 15\\ \\mathrm{cmH_2O\\cdot s/L}$$\n$$C = 0.08\\ \\mathrm{L/cmH_2O}$$\n$$\\tau = RC = (15\\ \\mathrm{cmH_2O\\cdot s/L}) \\times (0.08\\ \\mathrm{L/cmH_2O}) = 1.2\\ \\mathrm{s}$$\n初始容积为 $V_T = 0.6\\ \\mathrm{L}$。呼气时间为 $T_e = 1\\ \\mathrm{s}$。\n\n呼气末容积 $V(T_e)$ 是在 $t = T_e = 1\\ \\mathrm{s}$ 时剩余的容积：\n$$V(T_e) = V(1) = V_T \\exp\\left(-\\frac{T_e}{\\tau}\\right) = 0.6 \\exp\\left(-\\frac{1}{1.2}\\right)$$\n$$V(T_e) = 0.6 \\exp\\left(-\\frac{5}{6}\\right) \\approx 0.6 \\times 0.4345982 \\approx 0.2607589\\ \\mathrm{L}$$\n四舍五入到四位有效数字，呼气末容积为：\n$$V(T_e) \\approx 0.2608\\ \\mathrm{L}$$\n\n接下来，我们计算内源性呼气末正压 (PEEPi)。问题将其定义为呼气末的肺泡弹性回缩压力，$p_{\\mathrm{el}}(T_e)$。\n$$\\mathrm{PEEPi} = p_{\\mathrm{el}}(T_e) = \\frac{V(T_e)}{C}$$\n为了获得更高的精度，使用 $V(T_e)$ 的未四舍五入值：\n$$\\mathrm{PEEPi} = \\frac{0.2607589\\ \\mathrm{L}}{0.08\\ \\mathrm{L/cmH_2O}} \\approx 3.2594865\\ \\mathrm{cmH_2O}$$\n四舍五入到四位有效数字，PEEPi 为：\n$$\\mathrm{PEEPi} \\approx 3.259\\ \\mathrm{cmH_2O}$$\n\n最终答案是数值对 $(V(T_e), \\mathrm{PEEPi})$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2608 & 3.259\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在 $RC$ 模型的基础上，本练习将从描述压力和容积，转向分析呼吸所需的能量。我们将探讨气流的*模式*（而不仅仅是总体积）如何影响克服阻力所做的功。这个练习揭示了机械通气中的一个关键原则：不同的通气模式（如恒定流量与恒定压力）具有不同的能量成本，为优化患者支持提供了深刻见解。",
            "id": "3925418",
            "problem": "一个单室肺模型由一个线性气道阻力和一个线性弹性腔室串联组成。相对于呼气末基线的气道压力是阻力分量和弹性分量之和。阻力压降与流量成正比，弹性回缩压力与容积成正比。假设如下：\n\n- 阻力元件的阻力为 $R$（单位为 $\\mathrm{cm\\ H_2O\\,s\\,L^{-1}}$），弹性元件的顺应性为 $C$（单位为 $\\mathrm{L\\,cm^{-1}\\,H_2O}$），弹性阻力为 $E = 1/C$。\n- 潮气吸入从零容积开始，经过吸气时间 $T_I$ 后，在容积达到 $V_T$ 时结束。\n- 传递到每个元件的功率是其压力和瞬时流量的乘积，而机械功是功率对时间的积分。\n\n两种吸气模式在相同的 $T_I$ 内输送相同的 $V_T$：\n\n- 情况 A（恒流充气）：$ \\dot{V}(t) = V_T/T_I $，其中 $0 \\le t \\le T_I$。\n- 情况 B（压力控制减速流充气）：在气道上施加一个恒定的驱动压力，产生一个时间常数为 $\\tau = R C$ 的一阶阻力-顺应性（RC）响应，其解为 $V(t) = V_{\\infty}\\left(1 - \\exp(-t/\\tau)\\right)$，其中 $0 \\le t \\le T_I$。选择的驱动压力使得 $V(T_I) = V_T$。\n\n将阻力功 $W_{\\mathrm{res}}$ 定义为阻力功率对时间的积分，将弹性功 $W_{\\mathrm{el}}$ 定义为吸气末储存的弹性能。阻力功分数为\n$$\nf_{\\mathrm{res}} = \\frac{W_{\\mathrm{res}}}{W_{\\mathrm{res}} + W_{\\mathrm{el}}}.\n$$\n\n仅从阻力元件的线性压力-流量关系、弹性腔室的线性压力-容积关系以及功率和功的定义出发，为每种情况推导出 $f_{\\mathrm{res}}$，作为无量纲吸气持续时间 $x = T_I/\\tau$ 的简化函数。将最终答案表示为一对用 $x$ 表示的闭合形式符号表达式 $\\big(f_{\\mathrm{res}}^{\\mathrm{const}}(x),\\ f_{\\mathrm{res}}^{\\mathrm{decel}}(x)\\big)$。不需要进行数值计算或四舍五入，最终答案中不应包含单位。",
            "solution": "该问题是适定的，有科学依据，并包含了得到唯一解所需的所有信息。我们首先根据所提供的第一性原理推导阻力功和弹性功的表达式。\n\n阻力压力由 $P_{\\mathrm{res}}(t) = R \\dot{V}(t)$ 给出，弹性压力为 $P_{\\mathrm{el}}(t) = \\frac{1}{C} V(t)$。传递到元件的功率是压力和流量的乘积，功是功率对时间的积分。总吸气时间为 $T_I$。\n\n阻力功 $W_{\\mathrm{res}}$ 是在吸气期间由阻力元件耗散的功。其计算公式为：\n$$\nW_{\\mathrm{res}} = \\int_0^{T_I} P_{\\mathrm{res}}(t) \\dot{V}(t) \\, dt = \\int_0^{T_I} (R \\dot{V}(t)) \\dot{V}(t) \\, dt = R \\int_0^{T_I} [\\dot{V}(t)]^2 \\, dt\n$$\n该表达式取决于具体的流量曲线 $\\dot{V}(t)$。\n\n弹性功 $W_{\\mathrm{el}}$ 是在吸气末，当容积为 $V_T$ 时，储存在弹性元件中的势能。这个功是克服弹性回缩压力所做的功。\n$$\nW_{\\mathrm{el}} = \\int_0^{T_I} P_{\\mathrm{el}}(t) \\dot{V}(t) \\, dt = \\int_0^{T_I} \\frac{V(t)}{C} \\dot{V}(t) \\, dt\n$$\n我们可以将积分变量从时间 $t$ 更改为容积 $V$。由于 $dV = \\dot{V}(t) \\, dt$，并且容积从 $V(0)=0$ 变化到 $V(T_I)=V_T$，积分变为：\n$$\nW_{\\mathrm{el}} = \\int_0^{V_T} \\frac{V}{C} \\, dV = \\frac{1}{C} \\left[ \\frac{V^2}{2} \\right]_0^{V_T} = \\frac{V_T^2}{2C}\n$$\n这个重要的结果表明，吸气末储存的弹性功仅取决于最终潮气量 $V_T$ 和顺应性 $C$，而与具体的充气模式无关。\n\n现在，我们为指定的两种情况计算阻力功分数 $f_{\\mathrm{res}} = \\frac{W_{\\mathrm{res}}}{W_{\\mathrm{res}} + W_{\\mathrm{el}}}$。\n\n**情况 A：恒流充气**\n\n对于这种情况，流量在吸气时间 $T_I$ 内是恒定的：\n$$\n\\dot{V}(t) = \\frac{V_T}{T_I}, \\quad 0 \\le t \\le T_I\n$$\n我们计算阻力功 $W_{\\mathrm{res}}^{\\mathrm{const}}$：\n$$\nW_{\\mathrm{res}}^{\\mathrm{const}} = R \\int_0^{T_I} \\left(\\frac{V_T}{T_I}\\right)^2 \\, dt = R \\frac{V_T^2}{T_I^2} \\int_0^{T_I} dt = R \\frac{V_T^2}{T_I^2} T_I = \\frac{R V_T^2}{T_I}\n$$\n弹性功为 $W_{\\mathrm{el}} = \\frac{V_T^2}{2C}$。恒流充气的阻力功分数 $f_{\\mathrm{res}}^{\\mathrm{const}}$ 为：\n$$\nf_{\\mathrm{res}}^{\\mathrm{const}} = \\frac{W_{\\mathrm{res}}^{\\mathrm{const}}}{W_{\\mathrm{res}}^{\\mathrm{const}} + W_{\\mathrm{el}}} = \\frac{\\frac{R V_T^2}{T_I}}{\\frac{R V_T^2}{T_I} + \\frac{V_T^2}{2C}}\n$$\n我们可以从分子和分母中消去 $V_T^2$ 项：\n$$\nf_{\\mathrm{res}}^{\\mathrm{const}} = \\frac{\\frac{R}{T_I}}{\\frac{R}{T_I} + \\frac{1}{2C}} = \\frac{R/T_I}{\\frac{2RC + T_I}{2CT_I}} = \\frac{R}{T_I} \\frac{2CT_I}{2RC + T_I} = \\frac{2RC}{2RC + T_I}\n$$\n题目要求我们用无量纲时间 $x = T_I/\\tau$ 来表示这个结果，其中 $\\tau = RC$。代入 $T_I = x\\tau = xRC$：\n$$\nf_{\\mathrm{res}}^{\\mathrm{const}}(x) = \\frac{2RC}{2RC + xRC} = \\frac{2RC}{RC(2+x)} = \\frac{2}{2+x}\n$$\n\n**情况 B：压力控制减速流充气**\n\n容积遵循一阶响应：$V(t) = V_{\\infty}(1 - \\exp(-t/\\tau))$。条件 $V(T_I) = V_T$ 意味着：\n$$\nV_T = V_{\\infty}(1 - \\exp(-T_I/\\tau)) \\implies V_{\\infty} = \\frac{V_T}{1 - \\exp(-T_I/\\tau)}\n$$\n瞬时流量 $\\dot{V}(t)$ 是 $V(t)$ 对时间的导数：\n$$\n\\dot{V}(t) = \\frac{d}{dt} \\left[ V_{\\infty}(1 - \\exp(-t/\\tau)) \\right] = \\frac{V_{\\infty}}{\\tau} \\exp(-t/\\tau)\n$$\n现在，我们计算阻力功 $W_{\\mathrm{res}}^{\\mathrm{decel}}$：\n$$\nW_{\\mathrm{res}}^{\\mathrm{decel}} = R \\int_0^{T_I} [\\dot{V}(t)]^2 \\, dt = R \\int_0^{T_I} \\left(\\frac{V_{\\infty}}{\\tau} \\exp(-t/\\tau)\\right)^2 \\, dt = R \\frac{V_{\\infty}^2}{\\tau^2} \\int_0^{T_I} \\exp(-2t/\\tau) \\, dt\n$$\n积分计算结果为：\n$$\n\\int_0^{T_I} \\exp(-2t/\\tau) \\, dt = \\left[ \\frac{\\exp(-2t/\\tau)}{-2/\\tau} \\right]_0^{T_I} = -\\frac{\\tau}{2} (\\exp(-2T_I/\\tau) - 1) = \\frac{\\tau}{2} (1 - \\exp(-2T_I/\\tau))\n$$\n将此结果代回 $W_{\\mathrm{res}}^{\\mathrm{decel}}$ 的表达式中：\n$$\nW_{\\mathrm{res}}^{\\mathrm{decel}} = R \\frac{V_{\\infty}^2}{\\tau^2} \\frac{\\tau}{2} (1 - \\exp(-2T_I/\\tau)) = \\frac{R V_{\\infty}^2}{2\\tau} (1 - \\exp(-2T_I/\\tau))\n$$\n使用 $\\tau = RC$，我们得到 $R/\\tau = 1/C$。\n$$\nW_{\\mathrm{res}}^{\\mathrm{decel}} = \\frac{V_{\\infty}^2}{2C} (1 - \\exp(-2T_I/\\tau))\n$$\n现在，我们代入 $V_{\\infty}$ 的表达式：\n$$\nW_{\\mathrm{res}}^{\\mathrm{decel}} = \\frac{1}{2C} \\left( \\frac{V_T}{1 - \\exp(-T_I/\\tau)} \\right)^2 (1 - \\exp(-2T_I/\\tau))\n$$\n使用恒等式 $1 - a^2 = (1-a)(1+a)$，我们可以写出 $1 - \\exp(-2T_I/\\tau) = (1 - \\exp(-T_I/\\tau))(1 + \\exp(-T_I/\\tau))$。这简化了功的表达式：\n$$\nW_{\\mathrm{res}}^{\\mathrm{decel}} = \\frac{V_T^2}{2C} \\frac{(1 - \\exp(-T_I/\\tau))(1 + \\exp(-T_I/\\tau))}{(1 - \\exp(-T_I/\\tau))^2} = \\frac{V_T^2}{2C} \\frac{1 + \\exp(-T_I/\\tau)}{1 - \\exp(-T_I/\\tau)}\n$$\n弹性功仍然是 $W_{\\mathrm{el}} = \\frac{V_T^2}{2C}$。减速流充气的阻力功分数 $f_{\\mathrm{res}}^{\\mathrm{decel}}$ 为：\n$$\nf_{\\mathrm{res}}^{\\mathrm{decel}} = \\frac{W_{\\mathrm{res}}^{\\mathrm{decel}}}{W_{\\mathrm{res}}^{\\mathrm{decel}} + W_{\\mathrm{el}}} = \\frac{\\frac{V_T^2}{2C} \\frac{1 + \\exp(-T_I/\\tau)}{1 - \\exp(-T_I/\\tau)}}{\\frac{V_T^2}{2C} \\frac{1 + \\exp(-T_I/\\tau)}{1 - \\exp(-T_I/\\tau)} + \\frac{V_T^2}{2C}}\n$$\n我们消去公因式 $\\frac{V_T^2}{2C}$：\n$$\nf_{\\mathrm{res}}^{\\mathrm{decel}} = \\frac{\\frac{1 + \\exp(-T_I/\\tau)}{1 - \\exp(-T_I/\\tau)}}{ \\frac{1 + \\exp(-T_I/\\tau)}{1 - \\exp(-T_I/\\tau)} + 1}\n$$\n分子和分母同乘以 $1 - \\exp(-T_I/\\tau)$：\n$$\nf_{\\mathrm{res}}^{\\mathrm{decel}} = \\frac{1 + \\exp(-T_I/\\tau)}{(1 + \\exp(-T_I/\\tau)) + (1 - \\exp(-T_I/\\tau))} = \\frac{1 + \\exp(-T_I/\\tau)}{2}\n$$\n最后，我们用 $x = T_I/\\tau$ 来表示这个结果：\n$$\nf_{\\mathrm{res}}^{\\mathrm{decel}}(x) = \\frac{1 + \\exp(-x)}{2}\n$$\n阻力功分数的一对表达式是 $(f_{\\mathrm{res}}^{\\mathrm{const}}(x), f_{\\mathrm{res}}^{\\mathrm{decel}}(x))$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{2+x} & \\frac{1+\\exp(-x)}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "真实的肺部并非均匀一致。最后的这个练习将引入复杂性，从单室模型转向双室模型，用以表示导致力学特性存在区域差异的肺部疾病（不均一性）。该任务涉及使用状态空间表示法来构建这个更复杂的系统，并分析其数值模拟的稳定性，旨在训练现代生理学计算建模所需的基本技能。",
            "id": "3925380",
            "problem": "考虑一个双室肺模型，该模型包含两个并联的肺泡室，每个肺泡室通过各自的气道阻力连接到一个共同的口腔压力。该系统使用线性阻力和顺应性元件进行建模。设室 $i$ 的气道阻力为 $R_i$，顺应性为 $C_i$，其中 $i \\in \\{1,2\\}$。使用以下基本原理：\n\n- 体积守恒：$dV_i/dt = q_i$，其中 $V_i$ 是肺泡体积，$q_i$ 是流入该室的气道流量。\n- 线性电阻关系（类似于流体流动的欧姆定律）：$q_i = (P_m - P_{A,i})/R_i$，其中 $P_m$ 是口腔压力，$P_{A,i}$ 是室 $i$ 的肺泡压力。\n- 线性顺应性定义：$C_i = dV_i/dP_{A,i}$，对于围绕参考点的小信号线性化，等效于 $V_i = C_i P_{A,i}$。\n\n基于这些原理，通过选择肺泡压力作为状态 $x = [P_{A,1}, P_{A,2}]^\\top$ 和口腔压力作为输入 $u = P_m(t)$，推导一个状态空间模型。将连续时间线性时不变状态空间方程表示为 $dx/dt = A x + B u$ 的形式，并用物理参数识别系统矩阵 $A$ 和输入矩阵 $B$。定义室 $i$ 的时间常数 $\\tau_i$（其中 $i \\in \\{1,2\\}$），并展示它们与 $R_i$ 和 $C_i$ 的关系。\n\n接下来，对齐次系统（为进行稳定性分析，将输入 $u$ 恒置为零）实施后向（隐式）Euler 时间离散化，时间步长 $h > 0$。齐次系统的隐式 Euler 更新可写为 $x_{k+1} = \\Phi(h) x_k$。推导离散时间状态转移矩阵 $\\Phi(h)$，用连续时间系统矩阵 $A$ 和时间步长 $h$ 表示。\n\n分析隐式 Euler 格式的数值稳定性，将其作为时间步长相对于最小室时间常数的函数。定义最小时间常数为 $\\tau_{\\min} = \\min(\\tau_1, \\tau_2)$。对于每组指定的参数和时间步长，计算离散时间状态转移矩阵的谱半径 $\\rho(\\Phi(h))$，并报告该格式在该时间步长下是否数值稳定。使用离散时间齐次系统数值稳定的充要条件是 $\\rho(\\Phi(h)) < 1$。所有谱半径值均为无量纲浮点数；稳定性标志为布尔值。\n\n物理量必须使用国际单位制 (SI)。使用帕斯卡 ($\\mathrm{Pa}$) 作为压力 $P$ 的单位，升 ($\\mathrm{L}$) 作为体积 $V$ 的单位，帕斯卡·秒/升 ($\\mathrm{Pa \\cdot s / L}$) 作为阻力 $R$ 的单位，升/帕斯卡 ($\\mathrm{L / Pa}$) 作为顺应性 $C$ 的单位，秒 ($\\mathrm{s}$) 作为时间的单位。将最终的谱半径表示为四舍五入到 $6$ 位小数的浮点数。不涉及角度。布尔值必须输出为字面标记 $True$ 或 $False$。\n\n实现一个程序，该程序构建 $A$ 和 $\\Phi(h)$，并为以下测试套件计算谱半径和稳定性标志。对于每种情况，使用四个时间步长，定义为 $h = \\alpha \\, \\tau_{\\min}$，其中 $\\alpha \\in \\{0.05, 1, 5, 50\\}$：\n\n- 情况 $1$：$R_1 = 150\\,\\mathrm{Pa \\cdot s / L}$，$C_1 = 0.003\\,\\mathrm{L/Pa}$，$R_2 = 80\\,\\mathrm{Pa \\cdot s / L}$，$C_2 = 0.002\\,\\mathrm{L/Pa}$。\n- 情况 $2$：$R_1 = 100\\,\\mathrm{Pa \\cdot s / L}$，$C_1 = 0.002\\,\\mathrm{L/Pa}$，$R_2 = 50\\,\\mathrm{Pa \\cdot s / L}$，$C_2 = 0.004\\,\\mathrm{L/Pa}$。\n- 情况 $3$：$R_1 = 20\\,\\mathrm{Pa \\cdot s / L}$，$C_1 = 0.0005\\,\\mathrm{L/Pa}$，$R_2 = 200\\,\\mathrm{Pa \\cdot s / L}$，$C_2 = 0.01\\,\\mathrm{L/Pa}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个结果必须是一个包含两个条目的列表：谱半径（四舍五入到 $6$ 位小数）和稳定性标志。结果应按情况（$1$ 到 $3$）排序，在每种情况下按 $\\alpha$ 值升序（$0.05$, $1$, $5$, $50$）排序，总共 $12$ 个结果。例如，输出结构为 $[[\\rho_1,flag_1],[\\rho_2,flag_2],\\dots,[\\rho_{12},flag_{12}]]$。",
            "solution": "在尝试任何解决方案之前，需对问题进行验证。\n\n**步骤 1：提取已知条件**\n- **模型**：具有两个并联肺泡室的双室肺模型。\n- **元件**：每个室 $i \\in \\{1,2\\}$ 的线性阻力 $R_i$ 和顺应性 $C_i$。\n- **基本原理**：\n    1. 体积守恒：$dV_i/dt = q_i$，其中 $V_i$ 是肺泡体积，$q_i$ 是气道流量。\n    2. 线性电阻关系：$q_i = (P_m - P_{A,i})/R_i$，其中 $P_m$ 是口腔压力，$P_{A,i}$ 是肺泡压力。\n    3. 线性顺应性定义：$C_i = dV_i/dP_{A,i}$，这意味着 $V_i = C_i P_{A,i}$。\n- **状态空间模型**：\n    - 状态：$x = [P_{A,1}, P_{A,2}]^\\top$。\n    - 输入：$u = P_m(t)$。\n    - 形式：$dx/dt = A x + B u$。\n- **离散化**：\n    - 方法：后向（隐式）Euler。\n    - 系统：齐次系统 ($u=0$)。\n    - 时间步长：$h > 0$。\n    - 更新规则：$x_{k+1} = \\Phi(h) x_k$。\n- **稳定性分析**：\n    - 判据：数值稳定的充要条件是谱半径 $\\rho(\\Phi(h)) < 1$。\n    - 用于分析的时间步长：$h = \\alpha \\, \\tau_{\\min}$，其中 $\\alpha \\in \\{0.05, 1, 5, 50\\}$，且 $\\tau_{\\min} = \\min(\\tau_1, \\tau_2)$。\n- **单位**：按规定使用国际单位制（$P$ 单位 $\\mathrm{Pa}$，$V$ 单位 $\\mathrm{L}$，$R$ 单位 $\\mathrm{Pa \\cdot s / L}$，$C$ 单位 $\\mathrm{L / Pa}$，时间单位 $\\mathrm{s}$）。\n- **输出格式**：谱半径为四舍五入到 $6$ 位小数的浮点数，稳定性为布尔值 ($True$/$False$)。\n- **测试用例**：\n    - 情况 $1$：$R_1 = 150\\,\\mathrm{Pa \\cdot s / L}$，$C_1 = 0.003\\,\\mathrm{L/Pa}$，$R_2 = 80\\,\\mathrm{Pa \\cdot s / L}$，$C_2 = 0.002\\,\\mathrm{L/Pa}$。\n    - 情况 $2$：$R_1 = 100\\,\\mathrm{Pa \\cdot s / L}$，$C_1 = 0.002\\,\\mathrm{L/Pa}$，$R_2 = 50\\,\\mathrm{Pa \\cdot s / L}$，$C_2 = 0.004\\,\\mathrm{L/Pa}$。\n    - 情况 $3$：$R_1 = 20\\,\\mathrm{Pa \\cdot s / L}$，$C_1 = 0.0005\\,\\mathrm{L/Pa}$，$R_2 = 200\\,\\mathrm{Pa \\cdot s / L}$，$C_2 = 0.01\\,\\mathrm{L/Pa}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个标准的、广泛使用的线性双室肺模型，这是呼吸系统力学建模的基石。其控制方程基于流体动力学（压力-流量关系）和力学（顺应性）的基本原理，类似于电路中的 RC 电路。所有原理都具有科学合理性。\n- **适定性**：问题定义清晰。它要求推导状态空间模型、进行离散化，并对指定参数进行稳定性分析。其结构确保了每一步都存在唯一且有意义的解。\n- **客观性**：问题使用精确、正式的语言和定量数据陈述，没有主观性或模糊性。\n- **完整性与一致性**：所有必要的参数（$R_i$, $C_i$）、模型和方法（状态空间、后向 Euler）都已指定。没有矛盾之处。单位一致。所提供的阻力和顺应性数据在合理的生理范围内。\n\n**步骤 3：结论与行动**\n问题是有效的。这是一个生物医学系统建模和数值分析领域中的适定、有科学依据的问题。可以开始求解过程。\n\n**连续时间状态空间模型的推导**\n目标是为状态变量 $P_{A,1}$ 和 $P_{A,2}$ 推导一组一阶微分方程。我们从每个室 $i \\in \\{1,2\\}$ 的既定原理开始。\n\n体积守恒定律表明 $dV_i/dt = q_i$。代入线性电阻关系 $q_i = (P_m - P_{A,i})/R_i$ 可得：\n$$ \\frac{dV_i}{dt} = \\frac{P_m(t) - P_{A,i}}{R_i} $$\n根据线性顺应性的定义，$V_i = C_i P_{A,i}$。对时间 $t$ 求导，并假设顺应性 $C_i$ 是一个常数参数，我们得到：\n$$ \\frac{dV_i}{dt} = C_i \\frac{dP_{A,i}}{dt} $$\n将 $dV_i/dt$ 的两个表达式相等：\n$$ C_i \\frac{dP_{A,i}}{dt} = \\frac{P_m(t) - P_{A,i}}{R_i} $$\n重新整理以分离状态变量 $P_{A,i}$ 的导数：\n$$ \\frac{dP_{A,i}}{dt} = -\\frac{1}{R_i C_i} P_{A,i} + \\frac{1}{R_i C_i} P_m(t) $$\n该方程是一阶线性常微分方程的形式。乘积 $R_i C_i$ 的单位是 $(\\mathrm{Pa \\cdot s / L}) \\cdot (\\mathrm{L / Pa}) = \\mathrm{s}$，即时间。我们定义室 $i$ 的时间常数为 $\\tau_i = R_i C_i$。方程变为：\n$$ \\frac{dP_{A,i}}{dt} = -\\frac{1}{\\tau_i} P_{A,i} + \\frac{1}{\\tau_i} P_m(t) $$\n这两个室不直接相互耦合，只与共同的输入 $P_m(t)$ 耦合。现在我们可以将方程组写成矩阵形式 $dx/dt = A x + B u$，其中 $x = [P_{A,1}, P_{A,2}]^\\top$，$u = P_m(t)$：\n$$ \\frac{d}{dt} \\begin{pmatrix} P_{A,1} \\\\ P_{A,2} \\end{pmatrix} = \\begin{pmatrix} -1/\\tau_1  0 \\\\ 0  -1/\\tau_2 \\end{pmatrix} \\begin{pmatrix} P_{A,1} \\\\ P_{A,2} \\end{pmatrix} + \\begin{pmatrix} 1/\\tau_1 \\\\ 1/\\tau_2 \\end{pmatrix} P_m(t) $$\n由此，系统矩阵 $A$ 和输入矩阵 $B$ 可确定为：\n$$ A = \\begin{pmatrix} -1/\\tau_1  0 \\\\ 0  -1/\\tau_2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1/\\tau_1 \\\\ 1/\\tau_2 \\end{pmatrix} $$\n其中 $\\tau_1 = R_1 C_1$ 且 $\\tau_2 = R_2 C_2$。\n\n**离散化与稳定性分析**\n我们需要使用后向（隐式）Euler 方法分析齐次系统 $dx/dt = Ax$。\n在时间步 $k+1$ 处，后向 Euler 对导数的近似为：\n$$ \\frac{x_{k+1} - x_k}{h} = \\dot{x}_{k+1} $$\n其中 $x_k$ 是时间 $t_k = k h$ 时的状态。对于我们的系统，$\\dot{x}_{k+1} = A x_{k+1}$。将此代入近似式：\n$$ \\frac{x_{k+1} - x_k}{h} = A x_{k+1} $$\n我们求解 $x_{k+1}$：\n$$ x_{k+1} - x_k = h A x_{k+1} $$\n$$ x_{k+1} - h A x_{k+1} = x_k $$\n$$ (I - h A) x_{k+1} = x_k $$\n$$ x_{k+1} = (I - h A)^{-1} x_k $$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。将其与指定形式 $x_{k+1} = \\Phi(h) x_k$ 进行比较，我们确定离散时间状态转移矩阵为：\n$$ \\Phi(h) = (I - h A)^{-1} $$\n该离散时间系统的数值稳定性要求 $\\Phi(h)$ 的谱半径小于 $1$，即 $\\rho(\\Phi(h)) < 1$。谱半径是 $\\Phi(h)$ 的特征值的最大绝对值。\n\n$A$ 的特征值是其对角线元素，$\\lambda_{A,1} = -1/\\tau_1$ 和 $\\lambda_{A,2} = -1/\\tau_2$。\n$\\Phi(h) = (I - h A)^{-1}$ 的特征值与 $A$ 的特征值相关。如果 $\\lambda_A$ 是 $A$ 的一个特征值，那么 $(1 - h \\lambda_A)$ 是 $(I - h A)$ 的一个特征值，而 $1/(1 - h \\lambda_A)$ 是 $(I - h A)^{-1}$ 的一个特征值。因此，$\\Phi(h)$ 的特征值是：\n$$ \\lambda_{\\Phi,1} = \\frac{1}{1 - h(-1/\\tau_1)} = \\frac{1}{1 + h/\\tau_1} $$\n$$ \\lambda_{\\Phi,2} = \\frac{1}{1 - h(-1/\\tau_2)} = \\frac{1}{1 + h/\\tau_2} $$\n由于 $h > 0$ 且物理参数保证 $\\tau_i > 0$，两个特征值都是正实数。谱半径是这些特征值的最大值：\n$$ \\rho(\\Phi(h)) = \\max \\left( \\frac{1}{1 + h/\\tau_1}, \\frac{1}{1 + h/\\tau_2} \\right) $$\n对于 $\\tau > 0, h > 0$，函数 $f(\\tau) = 1/(1+h/\\tau)$ 是一个关于 $\\tau$ 的严格递增函数。因此，在 $\\tau_{\\max} = \\max(\\tau_1, \\tau_2)$ 处达到最大值。\n$$ \\rho(\\Phi(h)) = \\frac{1}{1 + h/\\tau_{\\max}} $$\n为了保证稳定性，我们要求 $\\rho(\\Phi(h)) < 1$。由于 $h > 0$ 且 $\\tau_{\\max} > 0$，项 $h/\\tau_{\\max}$ 为正。因此，分母 $(1 + h/\\tau_{\\max})$ 总是大于 $1$。所以，对于任何正时间步长 $h$，$\\rho(\\Phi(h))$ 总是小于 $1$。这表明后向 Euler 方法对于此系统是无条件稳定的。对于每个测试用例，稳定性标志都将是 $True$。\n\n**计算流程**\n对于每个测试用例 $(R_1, C_1, R_2, C_2)$：\n1.  计算时间常数：$\\tau_1 = R_1 C_1$ 和 $\\tau_2 = R_2 C_2$。\n2.  确定最小和最大时间常数：$\\tau_{\\min} = \\min(\\tau_1, \\tau_2)$ 和 $\\tau_{\\max} = \\max(\\tau_1, \\tau_2)$。\n3.  对于每个乘数 $\\alpha \\in \\{0.05, 1, 5, 50\\}$：\n    a.  计算时间步长：$h = \\alpha \\cdot \\tau_{\\min}$。\n    b.  使用推导出的公式计算谱半径：$\\rho = 1 / (1 + h/\\tau_{\\max})$。\n    c.  检查稳定性条件：由于 $\\rho < 1$，稳定性为 $True$。\n    d.  将 $\\rho$ 四舍五入到 $6$ 位小数，并记录该对 $[\\rho, \\text{stability}]$。\n将实施此流程以生成最终结果。",
            "answer": "[[0.982532,True],[0.737705,True],[0.360000,True],[0.053254,True],[0.952381,True],[0.500000,True],[0.166667,True],[0.019608,True],[0.999750,True],[0.995025,True],[0.975610,True],[0.800000,True]]"
        }
    ]
}