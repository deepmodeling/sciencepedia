{
    "hands_on_practices": [
        {
            "introduction": "Windkessel模型最基本的应用是建立平均压力和平均流量之间的关系。本练习将引导你从模型的控制微分方程出发，推导出计算体循环血管阻力（SVR）的经典公式。这一过程不仅连接了动态模型与稳态的临床应用，更关键地揭示了为何对脉动动态至关重要的顺应性（$C$）参数，在计算平均值关系时会被消去 。",
            "id": "3907093",
            "problem": "考虑一个使用双元件Windkessel表示法的体循环集总参数模型，该模型包含一个顺应性和一个外周阻力。设动脉室的顺应性为$C$，平均动脉压为$P_a$；静脉室的平均静脉压为$P_v$。心脏提供周期性的血流输入，平均心输出量为$Q$。假设在多个心动周期内处于周期性稳态，因此顺应性元件的平均容积不随时间漂移。仅从顺应性元件的质量守恒和通过等效电阻网络的粘性流的本构行为出发，推导$P_a$、$P_v$、$Q$与体循环血管阻力$R$之间的平均关系，并利用该关系式和以下生理学上合理的数据计算$R$：$P_a = 95$ $\\mathrm{mmHg}$，$P_v = 5$ $\\mathrm{mmHg}$，以及$Q = 5$ $\\mathrm{L/min}$。将阻力以$\\mathrm{mmHg\\cdot min/L}$为单位表示，并将数值结果四舍五入至四位有效数字。在获得数值后，简要评论其大小对于静息状态下的成年人是否生理学上合理，并阐述顺应性如何影响平均行为与搏动行为，过程中不使用任何快捷公式。",
            "solution": "在进行解答之前，首先对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **模型**：双元件Windkessel体循环模型。\n-   **元件**：动脉顺应性$C$，体循环血管阻力$R$。\n-   **变量**：平均动脉压$P_a$，平均静脉压$P_v$，平均心输出量$Q$。\n-   **条件**：周期性稳态，意味着在一个心动周期内，顺应性元件的平均容积是恒定的。\n-   **推导要求**：从第一性原理（质量守恒和流动的本构行为）推导$P_a$、$P_v$、$Q$和$R$之间的平均关系。\n-   **数值数据**：$P_a = 95 \\ \\mathrm{mmHg}$，$P_v = 5 \\ \\mathrm{mmHg}$，$Q = 5 \\ \\mathrm{L/min}$。\n-   **任务**：计算$R$（单位为$\\mathrm{mmHg\\cdot min/L}$），并四舍五入至四位有效数字。\n-   **评述**：讨论结果的生理学合理性，以及顺应性在平均行为与搏动行为中的作用，不使用快捷公式。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **有科学依据**：问题基于Windkessel模型，这是心血管流体动力学中一个基础且被科学界接受的简化模型。质量守恒原理和阻力的本构定律（欧姆定律的类比）是物理学和工程学中的基本原理。该问题是科学合理的。\n-   **适定的**：问题定义清晰。它要求推导一个特定关系式，并使用所给数据进行后续计算。已知条件的数量足以确定唯一的未知数$R$。其结构能够导出一个唯一、稳定且有意义的解。\n-   **客观的**：问题使用精确、无歧义的科学术语陈述。所提供的生理数值是标准且客观的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它有科学依据、适定、客观，并且没有可辨别的缺陷。将提供完整的解答。\n\n### 平均关系的推导\n\n双元件Windkessel模型将体循环动脉系统简化为一个顺应性腔室（代表主动脉和大动脉的弹性）和一个阻力元件（代表小动脉和微动脉的总外周阻力）。\n\n$1$. **质量守恒**：顺应性动脉室中血容量$V(t)$的变化率等于从心脏流入的血流速率$q_{in}(t)$减去流向外周的血流速率$q_{out}(t)$。假设血液是不可压缩的，该原理可表示为：\n$$ \\frac{dV(t)}{dt} = q_{in}(t) - q_{out}(t) $$\n\n$2$. **本构关系**：\n-   **顺应性**：动脉室的顺应性$C$将容积的变化与动脉压$p_a(t)$的变化联系起来。根据定义，$C = \\frac{dV}{dp_a}$。假设为线性顺应性，我们可以写出$V(t) = C \\cdot p_a(t) + V_{u}$，其中$V_{u}$是未受压容积。对时间求导得到：\n    $$ \\frac{dV(t)}{dt} = C \\frac{dp_a(t)}{dt} $$\n-   **阻力**：通过体循环血管阻力$R$的血流是由动脉压$p_a(t)$和平均静脉压$P_v$之间的压力差驱动的。该关系类似于欧姆定律：\n    $$ q_{out}(t) = \\frac{p_a(t) - P_v}{R} $$\n    此处，$P_v$为给定的平均静脉压，并被视为阻力下游的一个恒定参考压力。\n\n$3$. **控制微分方程**：将本构关系代入质量守恒方程，得到该模型的控制微分方程：\n$$ C \\frac{dp_a(t)}{dt} = q_{in}(t) - \\frac{p_a(t) - P_v}{R} $$\n\n$4$. **在一个心动周期内取平均**：问题要求的是*平均*量之间的关系。我们可以通过对控制方程在一个周期为$T$的完整心动周期内取时间平均来找到这个关系。令$\\langle f(t) \\rangle = \\frac{1}{T}\\int_0^T f(t) dt$表示时间平均算子。\n$$ \\left\\langle C \\frac{dp_a(t)}{dt} \\right\\rangle = \\left\\langle q_{in}(t) \\right\\rangle - \\left\\langle \\frac{p_a(t) - P_v}{R} \\right\\rangle $$\n让我们逐项计算：\n-   左侧项涉及一个导数的平均值。因为系统处于周期性稳态，一个周期结束时的压力必须与开始时相同，即$p_a(T) = p_a(0)$。\n    $$ \\left\\langle C \\frac{dp_a(t)}{dt} \\right\\rangle = \\frac{C}{T} \\int_0^T \\frac{dp_a(t)}{dt} dt = \\frac{C}{T} [p_a(T) - p_a(0)] = 0 $$\n-   右侧第一项是平均流入速率，根据定义，它就是平均心输出量$Q$。\n    $$ \\langle q_{in}(t) \\rangle = Q $$\n-   右侧第二项是平均流出量。由于$R$和$P_v$是常数：\n    $$ \\left\\langle \\frac{p_a(t) - P_v}{R} \\right\\rangle = \\frac{1}{R} \\left( \\langle p_a(t) \\rangle - \\langle P_v \\rangle \\right) = \\frac{P_a - P_v}{R} $$\n    其中$P_a = \\langle p_a(t) \\rangle$是平均动脉压。\n\n$5$. **最终的平均关系**：将这些结果代回平均化后的方程得到：\n$$ 0 = Q - \\frac{P_a - P_v}{R} $$\n这可以重新整理得到所求的平均关系，它是整个回路的欧姆定律的液压类比：\n$$ Q = \\frac{P_a - P_v}{R} $$\n由此，我们可以将体循环血管阻力$R$表示为：\n$$ R = \\frac{P_a - P_v}{Q} $$\n\n### 体循环血管阻力的计算\n\n使用提供的生理数据：\n-   $P_a = 95 \\ \\mathrm{mmHg}$\n-   $P_v = 5 \\ \\mathrm{mmHg}$\n-   $Q = 5 \\ \\mathrm{L/min}$\n\n将这些值代入推导出的$R$的公式：\n$$ R = \\frac{95 \\ \\mathrm{mmHg} - 5 \\ \\mathrm{mmHg}}{5 \\ \\mathrm{L/min}} = \\frac{90 \\ \\mathrm{mmHg}}{5 \\ \\mathrm{L/min}} = 18 \\ \\frac{\\mathrm{mmHg \\cdot min}}{\\mathrm{L}} $$\n问题要求结果四舍五入至四位有效数字。\n$$ R = 18.00 \\ \\frac{\\mathrm{mmHg \\cdot min}}{\\mathrm{L}} $$\n\n### 关于合理性及顺应性作用的评述\n\n计算出的体循环血管阻力值为$R = 18.00 \\ \\mathrm{mmHg\\cdot min/L}$。这个单位也被称为伍德单位或外周阻力单位（PRU）。对于一个静息状态下的健康成年人，体循环血管阻力的典型值在$15-20 \\ \\mathrm{mmHg\\cdot min/L}$的范围内。因此，计算出的$18.00 \\ \\mathrm{mmHg\\cdot min/L}$这个值完全在生理学上合理的范围内。\n\n平均关系式$R = (P_a - P_v)/Q$的推导揭示了一个关键的概念点：顺应性$C$并未出现在最终的表达式中。这不是一个疏忽，而是该模型稳态行为的一个基本特征。顺应性项$C \\frac{dp_a(t)}{dt}$在一个完整的周期循环内积分为零，因为在周期性稳态下，顺应性动脉中存储容积的净变化为零。顺应性元件作为一个临时存储缓冲器，在收缩期（心输出超过外周流出时）吸收容积，在舒张期（心输出停止但外周流出继续时）释放容积。这一作用不影响整个周期内的*平均*流量，平均流量完全由平均压力梯度和阻力决定。\n\n相比之下，顺应性对于描述系统的*搏动*行为是绝对必要的。动脉系统的时间常数为$\\tau = RC$。这个时间常数决定了舒张期压力的指数衰减以及压力波形$p_a(t)$的整体形状。较大的顺应性（动脉弹性更好）会导致较大的时间常数，这使得动脉能更好地容纳心脏射出的每搏输出量，从而降低收缩压峰值并提高舒张压谷值。对于给定的平均压力和心输出量，这会导致较小的脉压差（$P_{systolic} - P_{diastolic}$）。相反，在动脉硬化等情况下，动脉壁变硬，顺应性降低，脉压差会显著增加。\n\n总之，阻力$R$是*平均*压力和*平均*流量之间关系的主要决定因素。顺应性$C$是搏动性血流与由此产生的搏动性压力之间关系的主要决定因素，它有效地塑造了压力波形并决定了脉压差。本题正确地引导了推导过程，表明对于平均流量分析，可以忽略顺应性，而对于搏动分析，顺应性是不可或缺的。",
            "answer": "$$\\boxed{18.00}$$"
        },
        {
            "introduction": "在分析了系统的稳态行为之后，我们现在来探讨其动态特性。本练习聚焦于心脏不射血的舒张期，此时动脉系统如同一个放电的RC电路。通过求解该阶段模型的常微分方程，你将能定量分析系统的时间常数 $\\tau = RC$，它决定了动脉压呈指数衰减的速率，并揭示了阻力和顺应性如何共同塑造压力波形 。",
            "id": "3907071",
            "problem": "考虑舒张期全身动脉树的双元件 Windkessel 模型，其中全身血管阻力 (SVR) 被建模为电阻为 $R$ 的单个电阻器，总动脉顺应性被建模为顺应性为 $C$ 的单个电容器。假设静脉压 $P_{v}$ 是恒定的，并且在舒张期没有来自心脏的血流流入。令 $P(t)$ 表示动脉压，令 $V(t)$ 表示动脉血容量。使用质量守恒和线性本构关系，建立关于 $P(t)$ 的控制常微分方程，并针对任意初始条件 $P(0)=P_{0}$ 求解该方程。\n\n给定 $R=18\\,\\mathrm{mmHg\\cdot min/L}$，$C=1.5\\,\\mathrm{mL/mmHg}$，$P_{0}=100\\,\\mathrm{mmHg}$，以及 $P_{v}=5\\,\\mathrm{mmHg}$，计算时间常数 $\\tau$（以秒为单位）和舒张压 $P(1\\,\\mathrm{s})$。将两个数值结果四舍五入至四位有效数字。时间常数以 $\\mathrm{s}$ 表示，压力以 $\\mathrm{mmHg}$ 表示。",
            "solution": "本问题需经过验证。\n\n### 步骤 1：提取已知条件\n- **模型：** 舒张期全身动脉树的双元件 Windkessel 模型。\n- **系统组件：**\n  - 全身血管阻力 (SVR) 是一个电阻为 $R$ 的电阻器。\n  - 总动脉顺应性是一个顺应性为 $C$ 的电容器。\n- **条件：**\n  - 静脉压恒定，记为 $P_{v}$。\n  - 舒张期无心脏血流流入。\n- **变量：**\n  - 动脉压为 $P(t)$。\n  - 动脉血容量为 $V(t)$。\n- **初始条件：**\n  - $P(0) = P_{0}$。\n- **数值数据：**\n  - $R = 18\\,\\mathrm{mmHg\\cdot min/L}$\n  - $C = 1.5\\,\\mathrm{mL/mmHg}$\n  - $P_{0} = 100\\,\\mathrm{mmHg}$\n  - $P_{v} = 5\\,\\mathrm{mmHg}$\n- **要求计算：**\n  - $P(t)$ 的控制常微分方程 (ODE)。\n  - 在给定初始条件下 ODE 的解。\n  - 时间常数 $\\tau$（以秒为单位），四舍五入至四位有效数字。\n  - 舒张压 $P(1\\,\\mathrm{s})$（以 $\\mathrm{mmHg}$ 为单位），四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 双元件 Windkessel 模型是心血管生理学和生物医学工程中一个基本且广泛使用的简化模型，用于描述动脉系统中的压力和血流关系。阻力和顺应性的概念是流体动力学中的标准概念，并可与电路类比。该问题具有科学合理性。\n2.  **适定性：** 问题要求推导并求解一个具有给定初始条件的一阶线性常微分方程。这构成了一个适定的初值问题，保证有唯一且稳定的解。所有必要的参数均已提供。\n3.  **客观性：** 问题的陈述是精确、客观和定量的。没有模糊不清或主观性的语言。\n4.  **一致性与真实性：** 所提供的 $R$、$C$、$P_0$ 和 $P_v$ 的数值对于人体心血管系统是生理上合理的。单位是一致的，尽管计算时需要进行转换，这是这类问题的标准部分。乘积 $RC$ 正确地得到了时间单位。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、适定、客观且内部一致。现在开始求解过程。\n\n### 控制常微分方程的建立\n该模型考虑舒张期的动脉系统，此时没有来自心脏的血流流入。因此，动脉血容量的变化率 $\\frac{dV}{dt}$ 等于通过全身脉管系统的流出率 $Q_{out}$ 的负值。\n$$\n\\frac{dV}{dt} = -Q_{out}(t)\n$$\n流出量 $Q_{out}(t)$ 由动脉压 $P(t)$ 和静脉压 $P_v$ 之间跨越全身血管阻力 $R$ 的压力差驱动。这个关系类似于欧姆定律：\n$$\nQ_{out}(t) = \\frac{P(t) - P_v}{R}\n$$\n总动脉顺应性 $C$ 将动脉血容量的变化与动脉压的变化联系起来。假设为线性关系（恒定顺应性），我们有：\n$$\nC = \\frac{dV}{dP}\n$$\n使用链式法则，我们可以将血容量随时间的变化率表示为：\n$$\n\\frac{dV}{dt} = \\frac{dV}{dP} \\frac{dP}{dt} = C \\frac{dP}{dt}\n$$\n令 $\\frac{dV}{dt}$ 的两个表达式相等，我们得到控制微分方程：\n$$\nC \\frac{dP}{dt} = - \\frac{P(t) - P_v}{R}\n$$\n这可以重排为一阶线性常微分方程的标准形式：\n$$\nRC \\frac{dP}{dt} + P(t) = P_v\n$$\n\n### 常微分方程的求解\n方程 $RC \\frac{dP}{dt} + P(t) = P_v$ 是一个非齐次一阶线性常微分方程。令时间常数为 $\\tau = RC$。方程变为：\n$$\n\\tau \\frac{dP}{dt} + P(t) = P_v\n$$\n为了求解此方程，我们可以定义一个新变量 $P'(t) = P(t) - P_v$。那么，$\\frac{dP'}{dt} = \\frac{dP}{dt}$。将这些代入常微分方程得到：\n$$\n\\tau \\frac{dP'}{dt} + (P'(t) + P_v) = P_v\n$$\n$$\n\\tau \\frac{dP'}{dt} + P'(t) = 0\n$$\n这是一个可分离的齐次方程：\n$$\n\\frac{dP'}{P'} = -\\frac{1}{\\tau} dt\n$$\n对两边积分得到：\n$$\n\\ln|P'(t)| = -\\frac{t}{\\tau} + K\n$$\n其中 $K$ 是积分常数。对两边取指数：\n$$\n|P'(t)| = \\exp(K) \\exp(-t/\\tau)\n$$\n令 $A = \\pm \\exp(K)$ 为任意常数，我们有：\n$$\nP'(t) = A \\exp(-t/\\tau)\n$$\n将 $P'(t) = P(t) - P_v$ 代回：\n$$\nP(t) - P_v = A \\exp(-t/\\tau)\n$$\n$$\nP(t) = P_v + A \\exp(-t/\\tau)\n$$\n为了求出常数 $A$，我们应用初始条件 $P(0) = P_0$：\n$$\nP(0) = P_v + A \\exp(0) = P_v + A\n$$\n$$\nP_0 = P_v + A \\implies A = P_0 - P_v\n$$\n因此，动脉压 $P(t)$ 的特解为：\n$$\nP(t) = P_v + (P_0 - P_v) \\exp\\left(-\\frac{t}{RC}\\right)\n$$\n\n### 数值计算\n首先，我们必须确保所有单位一致。我们将使用秒（$\\mathrm{s}$）、毫米汞柱（$\\mathrm{mmHg}$）和毫升（$\\mathrm{mL}$）。\n\n给定的阻力为 $R = 18\\,\\mathrm{mmHg\\cdot min/L}$。我们将其转换为所需单位：\n$$\nR = 18 \\frac{\\mathrm{mmHg} \\cdot \\mathrm{min}}{\\mathrm{L}} \\times \\left(\\frac{60\\,\\mathrm{s}}{1\\,\\mathrm{min}}\\right) \\times \\left(\\frac{1\\,\\mathrm{L}}{1000\\,\\mathrm{mL}}\\right) = \\frac{18 \\times 60}{1000} \\frac{\\mathrm{mmHg} \\cdot \\mathrm{s}}{\\mathrm{mL}} = 1.08 \\frac{\\mathrm{mmHg} \\cdot \\mathrm{s}}{\\mathrm{mL}}\n$$\n给定的顺应性为 $C = 1.5\\,\\mathrm{mL/mmHg}$。\n\n**1. 计算时间常数 $\\tau$**\n时间常数为 $\\tau = RC$。\n$$\n\\tau = \\left(1.08 \\frac{\\mathrm{mmHg} \\cdot \\mathrm{s}}{\\mathrm{mL}}\\right) \\times \\left(1.5 \\frac{\\mathrm{mL}}{\\mathrm{mmHg}}\\right) = 1.62\\,\\mathrm{s}\n$$\n四舍五入至四位有效数字，时间常数为 $\\tau = 1.620\\,\\mathrm{s}$。\n\n**2. 计算舒张压 $P(1\\,\\mathrm{s})$**\n我们使用推导出的 $P(t)$ 解以及给定的数值进行计算：\n- $t = 1\\,\\mathrm{s}$\n- $\\tau = 1.62\\,\\mathrm{s}$\n- $P_0 = 100\\,\\mathrm{mmHg}$\n- $P_v = 5\\,\\mathrm{mmHg}$\n\n$$\nP(1\\,\\mathrm{s}) = P_v + (P_0 - P_v) \\exp\\left(-\\frac{1}{\\tau}\\right)\n$$\n$$\nP(1\\,\\mathrm{s}) = 5 + (100 - 5) \\exp\\left(-\\frac{1}{1.62}\\right)\n$$\n$$\nP(1\\,\\mathrm{s}) = 5 + 95 \\exp\\left(-0.61728395...\\right)\n$$\n$$\nP(1\\,\\mathrm{s}) = 5 + 95 \\times (0.53940800...)\n$$\n$$\nP(1\\,\\mathrm{s}) = 5 + 51.24376...\n$$\n$$\nP(1\\,\\mathrm{s}) = 56.24376...\\,\\mathrm{mmHg}\n$$\n将结果四舍五入至四位有效数字，我们得到：\n$$\nP(1\\,\\mathrm{s}) = 56.24\\,\\mathrm{mmHg}\n$$\n所需的数值结果是时间常数 $\\tau = 1.620\\,\\mathrm{s}$ 和压力 $P(1\\,\\mathrm{s}) = 56.24\\,\\mathrm{mmHg}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.620 & 56.24\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然解析解能提供深刻的物理洞见，但其应用通常局限于简化场景。为了模拟具有真实复杂输入的循环系统，数值方法是必不可少的。这个高级练习将引导你实现并分析两种基本的数值方法——显式和隐式欧拉法——来求解Windkessel模型。它将使你直面数值稳定性的关键概念，并理解为何在计算模拟中，方法的选择对于获得可靠结果至关重要 。",
            "id": "3907055",
            "problem": "考虑一个用于全身血管阻力和动脉顺应性的生物医学系统建模中的体循环动脉室双元件阻力-顺应性 (RC) 模型（经典Windkessel模型的一个版本）。该动脉室被建模为一个具有压力 $P(t)$ 的顺应性储库，由来自心脏的流入量 $Q_{\\text{in}}(t)$ 驱动，并通过代表全身血管阻力的阻性负载产生流出量 $Q_{\\text{out}}(t)$。使用以下基本依据：\n\n- 顺应性定义：$C = \\dfrac{dV}{dP}$，其中 $C$ 是动脉顺应性，$V$ 是动脉容积。\n- 容积守恒：$\\dfrac{dV}{dt} = Q_{\\text{in}}(t) - Q_{\\text{out}}(t)$。\n- 阻性流出（类欧姆定律的血流定律）：$Q_{\\text{out}}(t) = \\dfrac{P(t)}{R}$，其中 $R$ 是全身血管阻力。\n\n基于这些依据，可以通过消除 $V(t)$ 并直接用 $P(t)$、$R$、$C$ 和 $Q_{\\text{in}}(t)$ 来表达动态，从而推导出关于 $P(t)$ 的常微分方程 (ODE)。\n\n任务 A. 仅从上述基本依据出发，不引入任何额外的简化公式，推导出控制 $P(t)$ 的线性标量ODE，该方程是关于 $R$、$C$ 和 $Q_{\\text{in}}(t)$ 的函数。将你的结果表示为 $\\dfrac{dP}{dt} = f(P,t)$ 的形式，其中 $f$ 在 $P$ 中是仿射的，并依赖于 $R$、$C$ 和 $Q_{\\text{in}}(t)$。\n\n任务 B. 考虑一个固定的时间步长 $\\Delta t > 0$ 和一个均匀网格 $t_n = n\\,\\Delta t$。使用在 $t_{n+1}$ 处对 $\\dfrac{dP}{dt}$ 的后向差分近似，推导 $P_{n+1}$ 的隐式欧拉（也称为后向欧拉）时间步进更新。通过代数方法求解 $P_{n+1}$，将其表示为 $P_n$、$R$、$C$、$\\Delta t$ 和 $Q_{\\text{in}}(t_{n+1})$ 的闭式解。\n\n任务 C. 作为对比，使用在 $t_n$ 处对 $\\dfrac{dP}{dt}$ 的前向差分近似，推导 $P_{n+1}$ 的显式欧拉时间步进更新，并将更新写成 $P_n$、$R$、$C$、$\\Delta t$ 和 $Q_{\\text{in}}(t_n)$ 的形式。\n\n任务 D. 关注零流入 $Q_{\\text{in}}(t) \\equiv 0$ 的齐次情况。对于在任务 B 和 C 中推导的两种方案，计算在齐次更新中将 $P_n$ 映射到 $P_{n+1}$ 的单步放大因子 $g$。使用 $g$ 的大小来评估以下意义上的数值稳定性：将此线性标量递推的数值稳定性定义为齐次放大的非扩张性，即 $|g| \\le 1$。使用你推导出的 $g$ 的表达式，确定隐式欧拉方案是否无条件稳定（即，对于所有 $\\Delta t > 0$ 和所有 $R > 0$、$C > 0$ 都是稳定的），并确定使显式欧拉方案在上述意义上保持稳定的最大时间步长 $\\Delta t_{\\max}$。\n\n任务 E. 在一个程序中实现隐式欧拉和显式欧拉更新。对于给定的 $R$、$C$ 和 $\\Delta t$，该程序将：\n- 计算每种方案的齐次放大因子 $g$。\n- 返回 $|g_{\\text{imp}}|$、$|g_{\\text{exp}}|$ 的值，一个布尔值指示每种方案在 $|g| \\le 1$ 标准下是否稳定，以及由你的推导得出的最大稳定显式欧拉时间步长 $\\Delta t_{\\max}$。\n\n必须一致地使用物理单位：阻力 $R$ 以 $\\text{mmHg}\\cdot\\text{s}/\\text{mL}$ 表示，顺应性 $C$ 以 $\\text{mL}/\\text{mmHg}$ 表示，压力 $P$ 以 $\\text{mmHg}$ 表示，流量 $Q$ 以 $\\text{mL}/\\text{s}$ 表示，时间量（包括 $\\Delta t$ 和 $\\Delta t_{\\max}$）以秒 (s) 表示。输出中的所有数值答案必须是纯数字，以指定单位表示，不附加单位符号。\n\n测试套件。你的程序必须评估以下参数集，每个作为一个独立的测试用例：\n1. $R = 1.0\\,\\text{mmHg}\\cdot\\text{s}/\\text{mL}$, $C = 1.5\\,\\text{mL}/\\text{mmHg}$, $\\Delta t = 1.0\\,\\text{s}$。\n2. $R = 1.0\\,\\text{mmHg}\\cdot\\text{s}/\\text{mL}$, $C = 1.0\\,\\text{mL}/\\text{mmHg}$, $\\Delta t = 2.0\\,\\text{s}$。\n3. $R = 0.1\\,\\text{mmHg}\\cdot\\text{s}/\\text{mL}$, $C = 0.05\\,\\text{mL}/\\text{mmHg}$, $\\Delta t = 0.5\\,\\text{s}$。\n4. $R = 2.0\\,\\text{mmHg}\\cdot\\text{s}/\\text{mL}$, $C = 3.0\\,\\text{mL}/\\text{mmHg}$, $\\Delta t = 10.0\\,\\text{s}$。\n5. $R = 1.0\\,\\text{mmHg}\\cdot\\text{s}/\\text{mL}$, $C = 1.0\\,\\text{mL}/\\text{mmHg}$, $\\Delta t = 1000.0\\,\\text{s}$。\n\n最终输出格式。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个测试用例贡献一个形如 $[|g_{\\text{imp}}|, |g_{\\text{exp}}|, \\text{stable}_{\\text{imp}}, \\text{stable}_{\\text{exp}}, \\Delta t_{\\max}]$ 的列表。例如，总输出应看起来像 $[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$。所有浮点数量（在适用时）必须以秒表示，并在程序中四舍五入到六位小数。所有布尔值必须返回为 $True$ 或 $False$（首字母大写）。",
            "solution": "此问题要求对用于体循环动脉的二元件阻力-顺应性 (RC) Windkessel 模型进行推导、离散化和稳定性分析。解决方案首先推导控制性常微分方程 (ODE)，然后使用隐式和显式欧拉方法对其进行离散化，最后分析这些方案的数值稳定性。\n\n**任务 A：控制性常微分方程 (ODE) 的推导**\n\n推导从提供的三个基本依据开始：\n1.  顺应性定义：$C = \\dfrac{dV}{dP}$，其中 $C$ 是动脉顺应性，$V$ 是动脉容积，$P$ 是动脉压力。\n2.  容积守恒：$\\dfrac{dV}{dt} = Q_{\\text{in}}(t) - Q_{\\text{out}}(t)$，其中 $Q_{\\text{in}}(t)$ 是流入量，$Q_{\\text{out}}(t)$ 是流出量。\n3.  阻性流出：$Q_{\\text{out}}(t) = \\dfrac{P(t)}{R}$，其中 $R$ 是全身血管阻力。\n\n我们的目标是找到一个关于 $P(t)$ 的ODE。第一步是将容积变化率 $\\dfrac{dV}{dt}$ 与压力变化率 $\\dfrac{dP}{dt}$ 联系起来。假设顺应性 $C$ 是一个常数参数，可以使用顺应性定义来写出微分之间的关系 $dV = C \\, dP$。应用关于时间 $t$ 的链式法则求导可得：\n$$\n\\dfrac{dV}{dt} = \\dfrac{dV}{dP} \\dfrac{dP}{dt}\n$$\n代入顺应性的定义 $C = \\dfrac{dV}{dP}$，我们得到：\n$$\n\\dfrac{dV}{dt} = C \\dfrac{dP}{dt}\n$$\n现在，我们将这个 $\\dfrac{dV}{dt}$ 的表达式代入容积守恒方程：\n$$\nC \\dfrac{dP}{dt} = Q_{\\text{in}}(t) - Q_{\\text{out}}(t)\n$$\n接下来，我们使用阻性流出定律替换流出项 $Q_{\\text{out}}(t)$：\n$$\nC \\dfrac{dP}{dt} = Q_{\\text{in}}(t) - \\dfrac{P(t)}{R}\n$$\n最后，为了得到标准形式 $\\dfrac{dP}{dt} = f(P,t)$，我们两边除以 $C$：\n$$\n\\dfrac{dP}{dt} = -\\dfrac{1}{RC}P(t) + \\dfrac{1}{C}Q_{\\text{in}}(t)\n$$\n这就是所要求的控制 $P(t)$ 的线性标量ODE。函数 $f(P, t) = -\\dfrac{1}{RC}P(t) + \\dfrac{1}{C}Q_{\\text{in}}(t)$ 是 $P(t)$ 的一个仿射函数。项 $RC$ 是系统的时间常数，通常用 $\\tau$ 表示。\n\n**任务 B：隐式欧拉方案的推导**\n\n隐式（或后向）欧拉方法通过在下一个时间步 $t_{n+1} = (n+1)\\Delta t$ 近似导数来离散化ODE。导数 $\\dfrac{dP}{dt}$ 由后向差分近似：\n$$\n\\left. \\dfrac{dP}{dt} \\right|_{t=t_{n+1}} \\approx \\dfrac{P(t_{n+1}) - P(t_n)}{\\Delta t} = \\dfrac{P_{n+1} - P_n}{\\Delta t}\n$$\n我们同样在时间 $t_{n+1}$ 处计算ODE的右侧：\n$$\n\\dfrac{P_{n+1} - P_n}{\\Delta t} = -\\dfrac{1}{RC}P_{n+1} + \\dfrac{1}{C}Q_{\\text{in}}(t_{n+1})\n$$\n为了找到更新规则，我们必须解这个方程以求得 $P_{n+1}$。我们首先将所有包含 $P_{n+1}$ 的项归到一边：\n$$\n\\dfrac{P_{n+1}}{\\Delta t} + \\dfrac{1}{RC}P_{n+1} = \\dfrac{P_n}{\\Delta t} + \\dfrac{1}{C}Q_{\\text{in}}(t_{n+1})\n$$\n提出 $P_{n+1}$：\n$$\nP_{n+1} \\left( \\dfrac{1}{\\Delta t} + \\dfrac{1}{RC} \\right) = \\dfrac{P_n}{\\Delta t} + \\dfrac{1}{C}Q_{\\text{in}}(t_{n+1})\n$$\n为括号中的项找到公分母：\n$$\nP_{n+1} \\left( \\dfrac{RC + \\Delta t}{RC \\Delta t} \\right) = \\dfrac{P_n}{\\Delta t} + \\dfrac{1}{C}Q_{\\text{in}}(t_{n+1})\n$$\n最后，分离出 $P_{n+1}$ 得到闭式更新：\n$$\nP_{n+1} = \\left( \\dfrac{RC \\Delta t}{RC + \\Delta t} \\right) \\left( \\dfrac{P_n}{\\Delta t} + \\dfrac{1}{C}Q_{\\text{in}}(t_{n+1}) \\right)\n$$\n$$\nP_{n+1} = \\dfrac{RC}{RC + \\Delta t} P_n + \\dfrac{R \\Delta t}{RC + \\Delta t} Q_{\\text{in}}(t_{n+1})\n$$\n\n**任务 C：显式欧拉方案的推导**\n\n显式（或前向）欧拉方法通过在当前时间步 $t_n = n\\Delta t$ 近似导数来离散化ODE。导数由前向差分近似：\n$$\n\\left. \\dfrac{dP}{dt} \\right|_{t=t_n} \\approx \\dfrac{P(t_{n+1}) - P(t_n)}{\\Delta t} = \\dfrac{P_{n+1} - P_n}{\\Delta t}\n$$\n我们在时间 $t_n$ 处计算ODE的右侧：\n$$\n\\dfrac{P_{n+1} - P_n}{\\Delta t} = -\\dfrac{1}{RC}P_n + \\dfrac{1}{C}Q_{\\text{in}}(t_n)\n$$\n求解 $P_{n+1}$ 很直接，因为它没有出现在右侧：\n$$\nP_{n+1} = P_n + \\Delta t \\left( -\\dfrac{1}{RC}P_n + \\dfrac{1}{C}Q_{\\text{in}}(t_n) \\right)\n$$\n将与 $P_n$ 相关的项组合在一起，得到最终的更新规则：\n$$\nP_{n+1} = \\left( 1 - \\dfrac{\\Delta t}{RC} \\right) P_n + \\dfrac{\\Delta t}{C} Q_{\\text{in}}(t_n)\n$$\n\n**任务 D：数值稳定性分析**\n\n我们在齐次情况下分析稳定性，即 $Q_{\\text{in}}(t) \\equiv 0$。更新规则简化为 $P_{n+1} = g P_n$ 形式的线性递推，其中 $g$ 是单步放大因子。如果 $|g| \\le 1$，则该方案被定义为稳定的。\n\n对于**隐式欧拉方案**，齐次更新为：\n$$\nP_{n+1} = \\dfrac{RC}{RC + \\Delta t} P_n\n$$\n因此，放大因子是：\n$$\ng_{\\text{imp}} = \\dfrac{RC}{RC + \\Delta t} = \\dfrac{1}{1 + \\frac{\\Delta t}{RC}}\n$$\n鉴于 $R > 0$、$C > 0$ 和 $\\Delta t > 0$，项 $\\dfrac{\\Delta t}{RC}$ 严格为正。因此，分母 $1 + \\dfrac{\\Delta t}{RC}$ 总是大于 $1$。这意味着 $0  < g_{\\text{imp}}  < 1$。由于 $|g_{\\text{imp}}| = g_{\\text{imp}}$，稳定性条件 $|g_{\\text{imp}}| \\le 1$ 对于任何有效的参数选择总是满足的。因此，隐式欧拉方案是**无条件稳定**的。\n\n对于**显式欧拉方案**，齐次更新为：\n$$\nP_{n+1} = \\left( 1 - \\dfrac{\\Delta t}{RC} \\right) P_n\n$$\n放大因子是：\n$$\ng_{\\text{exp}} = 1 - \\dfrac{\\Delta t}{RC}\n$$\n稳定性条件是 $|g_{\\text{exp}}| \\le 1$，这等同于：\n$$\n\\left| 1 - \\dfrac{\\Delta t}{RC} \\right| \\le 1\n$$\n这个不等式等价于一对不等式：\n$$\n-1 \\le 1 - \\dfrac{\\Delta t}{RC} \\le 1\n$$\n分析右侧：$1 - \\dfrac{\\Delta t}{RC} \\le 1 \\implies -\\dfrac{\\Delta t}{RC} \\le 0$，这总是成立的，因为 $R, C, \\Delta t$ 都是正的。\n分析左侧：$-1 \\le 1 - \\dfrac{\\Delta t}{RC} \\implies \\dfrac{\\Delta t}{RC} \\le 2$。\n这给出了对时间步长的稳定性约束：\n$$\n\\Delta t \\le 2RC\n$$\n因此，显式欧拉方案是**条件稳定**的。使该方案保持稳定的最大时间步长 $\\Delta t_{\\max}$ 是：\n$$\n\\Delta t_{\\max} = 2RC\n$$\n\n**任务 E：计算实现**\n\n程序将为一系列测试用例实现上述推导出的公式。对于每组给定的参数 $(R, C, \\Delta t)$，程序计算：\n1.  隐式放大因子的绝对值：$|g_{\\text{imp}}| = \\left| \\dfrac{RC}{RC + \\Delta t} \\right|$。如推导所示，这即是 $\\dfrac{RC}{RC + \\Delta t}$。\n2.  显式放大因子的绝对值：$|g_{\\text{exp}}| = \\left| 1 - \\dfrac{\\Delta t}{RC} \\right|$。\n3.  隐式方案的稳定性 $\\text{stable}_{\\text{imp}}$，这总是 $True$。\n4.  显式方案的稳定性 $\\text{stable}_{\\text{exp}}$，通过检查 $\\Delta t \\le 2RC$ 来确定。\n5.  显式方案的最大稳定时间步长 $\\Delta t_{\\max} = 2RC$。\n所有浮点结果在输出时四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Windkessel model stability problem for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (R, C, dt).\n    test_cases = [\n        (1.0, 1.5, 1.0),    # R, C, delta_t for case 1\n        (1.0, 1.0, 2.0),    # Case 2\n        (0.1, 0.05, 0.5),   # Case 3\n        (2.0, 3.0, 10.0),   # Case 4\n        (1.0, 1.0, 1000.0)  # Case 5\n    ]\n\n    results = []\n    for R, C, dt in test_cases:\n        # As per the problem statement, R, C, and dt are strictly positive.\n        # Calculate the time constant tau = RC\n        time_constant = R * C\n\n        # Implicit Euler Scheme Analysis\n        # Amplification factor g_imp = RC / (RC + dt)\n        g_imp = time_constant / (time_constant + dt)\n        abs_g_imp = abs(g_imp)\n        # Stability condition |g_imp| = 1. As derived, this is always true for positive R, C, dt.\n        stable_imp = abs_g_imp = 1.0\n\n        # Explicit Euler Scheme Analysis\n        # Amplification factor g_exp = 1 - dt / RC\n        g_exp = 1.0 - dt / time_constant\n        abs_g_exp = abs(g_exp)\n        # Stability condition dt = 2*R*C\n        dt_max = 2.0 * time_constant\n        stable_exp = dt = dt_max\n\n        # Append results for the current test case, rounded as required.\n        # Floats are rounded to 6 decimal places. Booleans are native True/False.\n        results.append([\n            round(abs_g_imp, 6),\n            round(abs_g_exp, 6),\n            stable_imp,\n            stable_exp,\n            round(dt_max, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    # The str() of a list automatically includes brackets and correct spacing.\n    # The ','.join creates the comma-separated list of these string representations.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}