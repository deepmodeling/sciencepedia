{
    "hands_on_practices": [
        {
            "introduction": "我们将从FitzHugh-Nagumo模型入手，这是一个虽简化却功能强大的神经元兴奋性数学表示。分析任何动力系统的第一步都是找到其稳态，即不动点。本练习旨在提供确定零斜线（即电压或恢复变量停止变化的曲线）的基础实践，并通过寻找零斜线的交点来定位系统的不动点 ()。这是理解系统行为的几何基础。",
            "id": "3918609",
            "problem": "考虑描述神经元兴奋性的二维FitzHugh–Nagumo (FHN)模型，由以下常微分方程组给出\n$$\n\\dot{V} = V - \\frac{V^{3}}{3} - w + I, \\qquad \\dot{w} = \\epsilon\\left(V + a - b\\,w\\right),\n$$\n其中$V$是无量纲的膜电位替代变量，$w$是无量纲的恢复变量，$a$, $b$, $\\epsilon$和$I$是无量纲参数，且$b>0$，$ \\epsilon>0$。在相平面分析中，零斜线（nullcline）定义为$(V,w)$中使得某个时间导数为零的点集，而定点（fixed point）定义为使得两个时间导数都为零的点$(V^{\\ast}, w^{\\ast})$。\n\n根据这些定义和给定的方程组：\n- 推导$(V,w)$平面中两条零斜线的显式解析方程。\n- 使用参数值$a = 0$，$b = 1$，$\\epsilon = 0.08$和$I = \\frac{1}{3}$，通过精确求解两条零斜线的交点来计算所有定点。\n\n将最终答案表示为有序对$(V^{\\ast}, w^{\\ast})$的精确形式（无四舍五入）。最终答案必须是单个解析表达式。",
            "solution": "该问题要求推导FitzHugh–Nagumo (FHN)模型的零斜线方程，并在一组特定参数下计算其定点。FHN模型由以下常微分方程组给出：\n$$\n\\dot{V} = V - \\frac{V^{3}}{3} - w + I\n$$\n$$\n\\dot{w} = \\epsilon\\left(V + a - b\\,w\\right)\n$$\n其中$V$和$w$是状态变量，$a$，$b$，$\\epsilon$和$I$是参数。\n\n首先，我们验证问题陈述的有效性。\n给定的系统是标准的FitzHugh–Nagumo模型。零斜线和定点的定义在动力系统理论中是标准的。所有必需的参数（$a = 0$，$b = 1$，$\\epsilon = 0.08$，$I = \\frac{1}{3}$）都已提供，并且其值与约束条件（$b>0$，$\\epsilon>0$）一致。该问题具有科学依据，提法恰当且客观。它不违反任何无效性标准。因此，该问题被认为是有效的，我们可以继续进行求解。\n\n零斜线是相平面上使某个时间导数为零的曲线。我们将推导$V$-零斜线（其中$\\dot{V}=0$）和$w$-零斜线（其中$\\dot{w}=0$）的方程。\n\n为求$V$-零斜线，我们令$\\dot{V} = 0$：\n$$\nV - \\frac{V^{3}}{3} - w + I = 0\n$$\n将变量$w$用$V$表示，我们得到$V$-零斜线的显式解析方程：\n$$\nw = V - \\frac{V^{3}}{3} + I\n$$\n该方程描述了$(V,w)$平面上的一条三次曲线。\n\n为求$w$-零斜线，我们令$\\dot{w} = 0$：\n$$\n\\epsilon\\left(V + a - b\\,w\\right) = 0\n$$\n鉴于参数$\\epsilon > 0$，该方程简化为：\n$$\nV + a - b\\,w = 0\n$$\n将$w$用$V$表示，我们得到$w$-零斜线的显式解析方程：\n$$\nw = \\frac{V + a}{b}\n$$\n由于$a$和$b$是常数，该方程描述了$(V,w)$平面上的一条直线。\n\n定点，记为$(V^{\\ast}, w^{\\ast})$，是两个时间导数同时为零的点。几何上，定点是$V$-零斜线和$w$-零斜线的交点。为了求出定点的坐标，我们将$w$的两个表达式设为相等：\n$$\nV^{\\ast} - \\frac{(V^{\\ast})^{3}}{3} + I = \\frac{V^{\\ast} + a}{b}\n$$\n该方程使我们能够求解定点的$V$坐标$V^{\\ast}$。\n\n我们给定的特定参数值为$a = 0$，$b = 1$和$I = \\frac{1}{3}$。参数$\\epsilon = 0.08$影响定点的稳定性，但不影响其位置，因此本次计算不需要它。将给定值代入交点方程：\n$$\nV^{\\ast} - \\frac{(V^{\\ast})^{3}}{3} + \\frac{1}{3} = \\frac{V^{\\ast} + 0}{1}\n$$\n简化方程：\n$$\nV^{\\ast} - \\frac{(V^{\\ast})^{3}}{3} + \\frac{1}{3} = V^{\\ast}\n$$\n两边减去$V^{\\ast}$得到：\n$$\n-\\frac{(V^{\\ast})^{3}}{3} + \\frac{1}{3} = 0\n$$\n将整个方程乘以$3$得到：\n$$\n-(V^{\\ast})^{3} + 1 = 0\n$$\n$$\n(V^{\\ast})^{3} = 1\n$$\n由于状态变量$V$（膜电位替代变量）和$w$（恢复变量）代表物理量，我们关心的是实数解。方程$(V^{\\ast})^{3} = 1$的唯一实数解是：\n$$\nV^{\\ast} = 1\n$$\n现在，我们通过将$V^{\\ast} = 1$代入任意一个零斜线方程来求出相应的$w$坐标$w^{\\ast}$。使用较简单的$w$-零斜线的线性方程：\n$$\nw^{\\ast} = \\frac{V^{\\ast} + a}{b} = \\frac{1 + 0}{1} = 1\n$$\n为了验证，我们也可以使用$V$-零斜线的方程：\n$$\nw^{\\ast} = V^{\\ast} - \\frac{(V^{\\ast})^{3}}{3} + I = 1 - \\frac{1^{3}}{3} + \\frac{1}{3} = 1 - \\frac{1}{3} + \\frac{1}{3} = 1\n$$\n两次计算得到相同的结果，证实了我们的解。\n因此，对于给定的参数，该系统有一个唯一的实数定点。该定点的坐标是$(V^{\\ast}, w^{\\ast}) = (1, 1)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基础之后，我们将从抽象的FHN模型转向更具生物物理真实感的Morris-Lecar模型。神经元并非静止不动，它们在响应输入时可以表现出微小的、有阻尼的振荡。本练习将演示如何通过在不动点处进行线性化（计算雅可比矩阵）来揭示这些隐藏的动力学 ()。通过计算特征值，我们可以预测这些亚阈值振荡的固有频率，这是决定神经元如何响应节律性输入的一个关键特征。",
            "id": "3918593",
            "problem": "考虑二维 Morris–Lecar (ML) 电导为基础的神经元模型，采用 Rinzel–Ermentrout 形式，描述膜电压和钾激活的动力学：\n$$\nC\\,\\frac{dV}{dt} \\;=\\; I_{\\text{app}} \\;-\\; g_{L}\\,(V - V_{L}) \\;-\\; g_{\\text{Ca}}\\,m_{\\infty}(V)\\,(V - V_{\\text{Ca}}) \\;-\\; g_{K}\\,w\\,(V - V_{K}),\n$$\n$$\n\\frac{dw}{dt} \\;=\\; \\phi\\,\\Lambda(V)\\,\\bigl(w_{\\infty}(V) - w\\bigr),\n$$\n其中，$V$ 是膜电位，$w$ 是钾激活变量，$C$ 是膜电容，$I_{\\text{app}}$ 是外加电流，$g_{L}$、$g_{\\text{Ca}}$ 和 $g_{K}$ 分别是漏电导、钙电导和钾电导，其反转电位分别为 $V_{L}$、$V_{\\text{Ca}}$ 和 $V_{K}$。稳态激活函数 $m_{\\infty}(V)$ 和 $w_{\\infty}(V)$ 是 $V$ 的 S 型函数，而 $\\Lambda(V)$ 是一个正函数，用于设定 $w$ 的局部弛豫速率。该模型的静息平衡点 $(V^{*}, w^{*})$ 满足 $w^{*} = w_{\\infty}(V^{*})$ 和 $I_{\\text{app}} - g_{L}\\,(V^{*} - V_{L}) - g_{\\text{Ca}}\\,m_{\\infty}(V^{*})\\,(V^{*} - V_{\\text{Ca}}) - g_{K}\\,w^{*}\\,(V^{*} - V_{K})=0$。\n\n将 ML 动力学在静息平衡点 $(V^{*}, w^{*})$ 附近线性化，得到线性化系统 $\\frac{d}{dt}\\begin{pmatrix}\\delta V \\\\ \\delta w\\end{pmatrix} = A \\begin{pmatrix}\\delta V \\\\ \\delta w\\end{pmatrix}$ 的雅可比矩阵 $A$。使用以下科学上一致的参数集和平衡量，这些量是通过在静息电位 $V^{*}$ 下的电压钳表征获得的：\n\n- $C = 20\\,\\mu\\text{F}/\\text{cm}^{2}$, $g_{L} = 2\\,\\text{mS}/\\text{cm}^{2}$, $g_{\\text{Ca}} = 4\\,\\text{mS}/\\text{cm}^{2}$, $g_{K} = 8\\,\\text{mS}/\\text{cm}^{2}$。\n- $V_{L} = -60\\,\\text{mV}$, $V_{\\text{Ca}} = 120\\,\\text{mV}$, $V_{K} = -84\\,\\text{mV}$。\n- $V^{*} = -54\\,\\text{mV}$, $w^{*} = w_{\\infty}(V^{*}) = 0.40$, $m_{\\infty}(V^{*}) = 0.10$。\n- 在 $V^{*}$ 处的局部斜率：$m_{\\infty}'(V^{*}) = 0.005\\,\\text{mV}^{-1}$, $w_{\\infty}'(V^{*}) = 0.012\\,\\text{mV}^{-1}$。\n- $\\Lambda(V^{*}) = 1.5$ 且 $\\phi = 0.04\\,\\text{ms}^{-1}$。\n\n根据线性系统的第一性原理，亚阈值振荡的自然角频率 $\\omega_{0}$ 由 $A$ 的复数特征值的虚部给出（单位为弧度/毫秒）。利用在 $(V^{*}, w^{*})$ 处获得的雅可比矩阵项，仅使用上面列出的量，显式计算 $\\omega_{0}$。将您的答案四舍五入到四位有效数字。最终结果以 rad/ms 表示。",
            "solution": "该问题要求计算 Morris-Lecar 神经元模型中亚阈值振荡的自然角频率，这基于在给定静息平衡点附近的线性化。微分方程组为：\n$$\n\\frac{dV}{dt} = f(V,w) = \\frac{1}{C}\\bigl( I_{\\text{app}} - g_{L}(V - V_{L}) - g_{\\text{Ca}}m_{\\infty}(V)(V - V_{\\text{Ca}}) - g_{K}w(V - V_{K}) \\bigr)\n$$\n$$\n\\frac{dw}{dt} = g(V,w) = \\phi\\,\\Lambda(V)\\bigl(w_{\\infty}(V) - w\\bigr)\n$$\n在平衡点 $(V^{*}, w^{*})$ 附近的小扰动 $(\\delta V, \\delta w)$ 的动力学由线性化系统 $\\frac{d}{dt}\\begin{pmatrix}\\delta V \\\\ \\delta w\\end{pmatrix} = A \\begin{pmatrix}\\delta V \\\\ \\delta w\\end{pmatrix}$ 描述，其中 $A$ 是在平衡点处求值的雅可比矩阵：\n$$\nA = \\begin{pmatrix}\n\\frac{\\partial f}{\\partial V} & \\frac{\\partial f}{\\partial w} \\\\\n\\frac{\\partial g}{\\partial V} & \\frac{\\partial g}{\\partial w}\n\\end{pmatrix}_{\\Big| (V^{*}, w^{*})}\n$$\n我们首先以符号方式计算偏导数。让我们用 $a_{ij}$ 表示雅可比矩阵的元素。\n\n元素 $a_{11}$ 是 $\\frac{\\partial f}{\\partial V}$。常数项 $I_{\\text{app}}$ 的导数为零。\n$$\na_{11} = \\frac{\\partial f}{\\partial V}\\Big|_{(V^{*}, w^{*})} = \\frac{1}{C}\\frac{\\partial}{\\partial V}\\Big|_{(V^{*}, w^{*})} \\bigl[-g_{L}(V - V_{L}) - g_{\\text{Ca}}m_{\\infty}(V)(V - V_{\\text{Ca}}) - g_{K}w(V - V_{K})\\bigr]\n$$\n对钙电流项使用乘法法则，我们得到：\n$$\na_{11} = \\frac{1}{C} \\bigl[ -g_{L} - g_{\\text{Ca}}(m'_{\\infty}(V^{*})(V^{*} - V_{\\text{Ca}}) + m_{\\infty}(V^{*})) - g_{K}w^{*} \\bigr]\n$$\n元素 $a_{12}$ 是 $\\frac{\\partial f}{\\partial w}$：\n$$\na_{12} = \\frac{\\partial f}{\\partial w}\\Big|_{(V^{*}, w^{*})} = \\frac{1}{C}\\frac{\\partial}{\\partial w}\\Big|_{(V^{*}, w^{*})} \\bigl[ -g_{K}w(V - V_{K}) \\bigr] = -\\frac{g_{K}}{C}(V^{*} - V_{K})\n$$\n元素 $a_{21}$ 是 $\\frac{\\partial g}{\\partial V}$：\n$$\na_{21} = \\frac{\\partial g}{\\partial V}\\Big|_{(V^{*}, w^{*})} = \\frac{\\partial}{\\partial V}\\Big|_{(V^{*}, w^{*})} \\bigl[ \\phi\\,\\Lambda(V)(w_{\\infty}(V) - w) \\bigr] = \\phi \\bigl[ \\Lambda'(V^{*})(w_{\\infty}(V^{*}) - w^{*}) + \\Lambda(V^{*})w'_{\\infty}(V^{*}) \\bigr]\n$$\n在平衡点处，$w^{*} = w_{\\infty}(V^{*})$，因此第一项消失。\n$$\na_{21} = \\phi\\,\\Lambda(V^{*})\\,w'_{\\infty}(V^{*})\n$$\n元素 $a_{22}$ 是 $\\frac{\\partial g}{\\partial w}$：\n$$\na_{22} = \\frac{\\partial g}{\\partial w}\\Big|_{(V^{*}, w^{*})} = \\frac{\\partial}{\\partial w}\\Big|_{(V^{*}, w^{*})} \\bigl[ \\phi\\,\\Lambda(V)(w_{\\infty}(V) - w) \\bigr] = -\\phi\\,\\Lambda(V^{*})\n$$\n现在，我们将提供的数值代入这些表达式中。参数的单位是一致的（电流密度单位为 $\\mu\\text{A}/\\text{cm}^2$，电位单位为 $\\text{mV}$，电容密度单位为 $\\mu\\text{F}/\\text{cm}^2$，电导密度单位为 $\\text{mS}/\\text{cm}^2$，时间单位为 $\\text{ms}$），因此我们可以用这些数字进行计算。得到的雅可比矩阵项的单位将与变化率一致，即包含 $\\text{ms}^{-1}$。\n\n给定值：$C = 20$, $g_{L} = 2$, $g_{\\text{Ca}} = 4$, $g_{K} = 8$, $V_{\\text{Ca}} = 120$, $V_{K} = -84$, $V^{*} = -54$, $w^{*} = 0.40$, $m_{\\infty}(V^{*}) = 0.10$, $m'_{\\infty}(V^{*}) = 0.005$, $w'_{\\infty}(V^{*}) = 0.012$, $\\Lambda(V^{*}) = 1.5$, $\\phi = 0.04$。\n\n计算 $a_{11}$：\n$$\na_{11} = \\frac{1}{20} \\bigl[ -2 - 4(0.005(-54 - 120) + 0.10) - 8(0.40) \\bigr]\n$$\n$$\na_{11} = \\frac{1}{20} \\bigl[ -2 - 4(0.005(-174) + 0.10) - 3.2 \\bigr]\n$$\n$$\na_{11} = \\frac{1}{20} \\bigl[ -2 - 4(-0.87 + 0.10) - 3.2 \\bigr]\n$$\n$$\na_{11} = \\frac{1}{20} \\bigl[ -2 - 4(-0.77) - 3.2 \\bigr] = \\frac{1}{20} \\bigl[ -2 + 3.08 - 3.2 \\bigr] = \\frac{-2.12}{20} = -0.106\n$$\n计算 $a_{12}$：\n$$\na_{12} = -\\frac{8}{20}(-54 - (-84)) = -0.4(-54 + 84) = -0.4(30) = -12\n$$\n计算 $a_{21}$：\n$$\na_{21} = (0.04)(1.5)(0.012) = 0.06 \\times 0.012 = 0.00072\n$$\n计算 $a_{22}$：\n$$\na_{22} = -(0.04)(1.5) = -0.06\n$$\n雅可比矩阵为：\n$$\nA = \\begin{pmatrix} -0.106 & -12 \\\\ 0.00072 & -0.06 \\end{pmatrix}\n$$\n$A$ 的特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根，即 $\\lambda^2 - \\text{Tr}(A)\\lambda + \\det(A) = 0$。\n$A$ 的迹为：\n$$\n\\text{Tr}(A) = a_{11} + a_{22} = -0.106 + (-0.06) = -0.166\n$$\n$A$ 的行列式为：\n$$\n\\det(A) = a_{11}a_{22} - a_{12}a_{21} = (-0.106)(-0.06) - (-12)(0.00072)\n$$\n$$\n\\det(A) = 0.00636 + 0.00864 = 0.015\n$$\n特征方程为 $\\lambda^2 - (-0.166)\\lambda + 0.015 = 0$，或：\n$$\n\\lambda^2 + 0.166\\lambda + 0.015 = 0\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解该方程（其中 $a=1$, $b=0.166$, $c=0.015$）：\n$$\n\\lambda = \\frac{-0.166 \\pm \\sqrt{(0.166)^2 - 4(1)(0.015)}}{2}\n$$\n$$\n\\lambda = \\frac{-0.166 \\pm \\sqrt{0.027556 - 0.06}}{2} = \\frac{-0.166 \\pm \\sqrt{-0.032444}}{2}\n$$\n判别式为负，表示存在共轭复数特征值，这对应于振荡行为。\n$$\n\\lambda = \\frac{-0.166 \\pm i\\sqrt{0.032444}}{2} = -0.083 \\pm i \\frac{\\sqrt{0.032444}}{2}\n$$\n问题将自然角频率 $\\omega_0$ 定义为特征值的虚部。$\\lambda$ 的单位是 $\\text{ms}^{-1}$，对于频率来说，这等同于 $\\text{rad}/\\text{ms}$。\n$$\n\\omega_0 = \\text{Im}(\\lambda) = \\frac{\\sqrt{0.032444}}{2} \\approx \\frac{0.18012218}{2} \\approx 0.09006109\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\omega_0 \\approx 0.09006\n$$\n单位是 $\\text{rad}/\\text{ms}$。",
            "answer": "$$\\boxed{0.09006}$$"
        },
        {
            "introduction": "这项高级实践旨在弥合理论分析与实际研究之间的鸿沟。它将指导您设计一个数值算法，对一个基于电导的神经元模型进行完整的相平面分析 ()。这项任务涉及以计算方式寻找零斜线和平衡点，对稳定性进行数值分类，并模拟轨迹以检测尖峰放电——这是现代计算神经科学的核心工作流程。此练习将所有先前的概念整合到一个强大的、可复用的计算工具中。",
            "id": "3918605",
            "problem": "考虑一个二维的基于电导的神经元模型，该模型具有一个膜电位变量 $V$ (单位为 $\\mathrm{mV}$) 和一个恢复变量 $w$ (无量纲)。该模型由以下常微分方程组定义\n$$\nC\\,\\frac{dV}{dt} = f(V,w) = -g_L\\,(V - E_L) - g_{\\mathrm{Ca}}\\,m_{\\infty}(V)\\,(V - E_{\\mathrm{Ca}}) - g_K\\,w\\,(V - E_K) + I_{\\mathrm{app}},\n$$\n$$\n\\frac{dw}{dt} = g(V,w) = \\phi\\,\\frac{w_{\\infty}(V) - w}{\\tau_w(V)},\n$$\n其中 $C$ 是膜电容，$g_L$ 是泄漏电导，$E_L$ 是泄漏反转电位，$g_{\\mathrm{Ca}}$ 是钙离子电导，$E_{\\mathrm{Ca}}$ 是钙离子反转电位，$g_K$ 是钾离子电导，$E_K$ 是钾离子反转电位，$\\phi$ 是一个动力学缩放因子，$I_{\\mathrm{app}}$ 是外加电流。稳态激活函数和时间常数由下式给出\n$$\nm_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_1}{V_2}\\right)\\right), \\quad\nw_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right),\n$$\n$$\n\\tau_w(V) = \\frac{1}{\\cosh\\left(\\frac{V - V_3}{2 V_4}\\right)}.\n$$\n这些选择在简化的基于电导的神经元模型中被广泛使用，并且根据参数的不同，可以支持兴奋性行为和振荡行为。\n\n你的任务是设计并实现一个数值算法，在相平面 $(V,w)$ 中通过计算零斜线、确定平衡点、通过雅可比矩阵对其稳定性进行分类以及模拟轨迹以检测锋电位，来分析神经元的兴奋性。按以下步骤进行：\n\n1. 定义向量场 $(\\dot{V}, \\dot{w}) = (f(V,w)/C, g(V,w))$，并解释零斜线是如何从定义 $f(V,w) = 0$ 和 $g(V,w) = 0$ 中产生的。\n2. 在一个能够捕捉典型神经元活动的范围（具体为 $V \\in [-80, 60]$ $\\mathrm{mV}$）上为 $V$ 构建一个均匀网格，并计算 $w$-零斜线 $g(V,w)=0$，这会得到 $w = w_{\\infty}(V)$。\n3. 通过求解 $f(V, w_{\\infty}(V)) = 0$ 来计算 $V$-零斜线，在网格上使用稳健的区间法求解 $V$。识别出函数变号的所有区间，并在每个区间内应用求根程序来找到 $V^\\star$；设 $w^\\star = w_{\\infty}(V^\\star)$。\n4. 将集合 $(V^\\star, w^\\star)$ 视为候选平衡点。对于每一个平衡点，通过中心有限差分法数值近似计算雅可比矩阵\n$$\nJ(V^\\star, w^\\star) = \\begin{bmatrix}\n\\frac{\\partial (f/C)}{\\partial V} & \\frac{\\partial (f/C)}{\\partial w} \\\\\n\\frac{\\partial g}{\\partial V} & \\frac{\\partial g}{\\partial w}\n\\end{bmatrix}\n$$\n并通过特征值实部的符号对其稳定性进行分类。使用以下整数代码进行分类：$0$ 代表稳定（两个特征值的实部均为负），$1$ 代表鞍点（一个特征值有正实部，另一个为负实部），$2$ 代表不稳定结点或焦点（至少一个特征值有正实部，且不是鞍点）。\n5. 从一个受扰动的平衡点初始条件 $(V(0), w(0)) = (V^\\star + \\Delta V, w^\\star)$（其中 $\\Delta V = 5$ $\\mathrm{mV}$）开始模拟轨迹，持续时间为 $300$ $\\mathrm{ms}$，并通过检查 $V(t)$ 在模拟过程中的任何时刻是否超过阈值 $V_{\\mathrm{th}} = -20$ $\\mathrm{mV}$ 来定量检测兴奋性。报告一个布尔值，指示是否发生了锋电位。\n\n物理单位：$V$ 的单位必须是 $\\mathrm{mV}$，时间 $t$ 的单位必须是 $\\mathrm{ms}$。门控变量 $w$ 是无量纲的。报告平衡点电压时，以 $\\mathrm{mV}$ 为单位，并四舍五入到三位小数。锋电位检测阈值以 $\\mathrm{mV}$ 为单位指定。\n\n实现上述算法，并将其应用于以下参数集测试套件。每个测试用例以参数元组 $(C, g_L, E_L, g_{\\mathrm{Ca}}, E_{\\mathrm{Ca}}, g_K, E_K, \\phi, V_1, V_2, V_3, V_4, I_{\\mathrm{app}})$ 的形式给出：\n\n- 测试用例1（典型的可兴奋静息态；理想路径）：$(20, 2, -60, 4.4, 120, 8, -84, 0.04, -1.2, 18, 2, 30, 50)$。\n- 测试用例2（强驱动；可能产生锋电位）：$(20, 2, -60, 4.4, 120, 8, -84, 0.04, -1.2, 18, 2, 30, 200)$。\n- 测试用例3（边界条件；无钙离子电流）：$(20, 2, -60, 0, 120, 8, -84, 0.04, -1.2, 18, 2, 30, 50)$。\n\n对于每个测试用例，你的程序应计算：\n- 在指定的 $V$ 范围内找到的平衡点的整数数量，\n- 找到的第一个平衡点的平衡电压 $V^\\star$，单位为 $\\mathrm{mV}$，四舍五入到三位小数（如果未找到，则输出 $\\mathrm{NaN}$），\n- 找到的第一个平衡点的稳定性代码（如上定义）（如果未找到，则输出 $-1$），\n- 一个布尔值，指示在指定的扰动下是否发生了锋电位。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且是 $[n_{\\mathrm{eq}}, V^\\star, \\text{stability\\_code}, \\text{spiked}]$ 形式的列表。例如，格式必须类似于 $[[1,-58.123,0,False],[1,-22.345,2,True],[1,-55.012,0,False]]$，逗号后没有空格。",
            "solution": "用户提供的问题是计算神经科学领域中一个适定且有科学依据的任务，要求对一个基于电导的神经元模型进行相平面分析。所有必要的参数和方程都已提供，目标也已明确定义。该问题是有效的。\n\n解决方案将遵循问题陈述中概述的系统化方法进行开发。\n\n### 1. 模型定义与零斜线\n\n该动力学系统描述了膜电位 $V$ 和恢复变量 $w$ 的演化：\n$$\n\\frac{dV}{dt} = \\frac{1}{C} f(V,w) = \\frac{1}{C} \\left( -g_L(V - E_L) - g_{\\mathrm{Ca}}m_{\\infty}(V)(V - E_{\\mathrm{Ca}}) - g_K w (V - E_K) + I_{\\mathrm{app}} \\right)\n$$\n$$\n\\frac{dw}{dt} = g(V,w) = \\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)}\n$$\n该系统可以写成向量形式 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x})$，其中 $\\mathbf{x} = [V, w]^T$。\n\n零斜线是相平面中的曲线，在这些曲线上，某个状态变量的变化率为零。\n- **$V$-零斜线**是点集 $(V,w)$，其中 $\\frac{dV}{dt} = 0$，这意味着 $f(V,w) = 0$。在这条曲线上，轨迹必须垂直移动（即，只有变量 $w$ 在变化）。\n- **$w$-零斜线**是点集 $(V,w)$，其中 $\\frac{dw}{dt} = 0$，这意味着 $g(V,w) = 0$。在这条曲线上，轨迹必须水平移动（即，只有变量 $V$ 在变化）。\n\n系统的平衡点（或不动点）是点 $(V^\\star, w^\\star)$，在这些点上两个变化率都为零，即零斜线的交点。\n\n### 2. 零斜线的计算\n通过设置 $g(V,w) = 0$ 来找到 $w$-零斜线：\n$$\n\\phi \\frac{w_{\\infty}(V) - w}{\\tau_w(V)} = 0\n$$\n由于缩放因子 $\\phi$ 非零且时间常数 $\\tau_w(V)$ 严格为正，该方程可简化为：\n$$\nw = w_{\\infty}(V) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{V - V_3}{V_4}\\right)\\right)\n$$\n这为 $(V,w)$ 平面中的 $w$-零斜线提供了一条显式的S形曲线。\n\n### 3. 寻找平衡点\n平衡点 $(V^\\star, w^\\star)$ 必须同时满足 $f(V^\\star, w^\\star)=0$ 和 $w^\\star = w_{\\infty}(V^\\star)$。我们可以将 $w$-零斜线的表达式代入 $V$-零斜线方程中，以找到平衡点的电压坐标 $V^\\star$：\n$$\nF(V) \\equiv f(V, w_{\\infty}(V)) = -g_L(V - E_L) - g_{\\mathrm{Ca}}m_{\\infty}(V)(V - E_{\\mathrm{Ca}}) - g_K w_{\\infty}(V)(V - E_K) + I_{\\mathrm{app}} = 0\n$$\n这个一维函数 $F(V)$ 的根即为 $V^\\star$ 的值。为了找到这些根，我们将实现指定的数值步骤：\n1.  在区间 $[-80, 60]$ 上创建一个均匀的 $V$ 值网格。\n2.  我们扫描网格，寻找 $F(V)$ 变号的相邻点 $(V_i, V_{i+1})$，即 $F(V_i) \\cdot F(V_{i+1}) < 0$。根据介值定理，每个这样的区间 $[V_i, V_{i+1}]$ 都保证至少包含一个根。\n3.  在每个识别出的区间内，应用二分法求根算法以高精度定位根 $V^\\star$。\n4.  对于每个根 $V^\\star$，计算相应的平衡恢复变量 $w^\\star = w_{\\infty}(V^\\star)$。\n\n问题要求分析“找到的第一个平衡点”。我们将其解释为具有代数上最小电压坐标 $V^\\star$ 的平衡点。\n\n### 4. 稳定性分类\n平衡点 $(V^\\star, w^\\star)$ 的稳定性由在该点计算的雅可比矩阵 $J$ 的特征值决定。\n$$\nJ(V^\\star, w^\\star) = \\begin{bmatrix}\n\\frac{\\partial (f/C)}{\\partial V} & \\frac{\\partial (f/C)}{\\partial w} \\\\\n\\frac{\\partial g}{\\partial V} & \\frac{\\partial g}{\\partial w}\n\\end{bmatrix}_{|(V^\\star, w^\\star)}\n$$\n按照指示，偏导数将使用一个小的步长 $h$ 通过二阶中心有限差分格式进行数值近似：\n$$\n\\frac{\\partial F}{\\partial x}(x_0) \\approx \\frac{F(x_0+h) - F(x_0-h)}{2h}\n$$\n因此，雅可比矩阵的四个元素是：\n- $J_{11} = \\frac{f(V^\\star+h, w^\\star) - f(V^\\star-h, w^\\star)}{2hC}$\n- $J_{12} = \\frac{f(V^\\star, w^\\star+h) - f(V^\\star, w^\\star-h)}{2hC}$\n- $J_{21} = \\frac{g(V^\\star+h, w^\\star) - g(V^\\star-h, w^\\star)}{2h}$\n- $J_{22} = \\frac{g(V^\\star, w^\\star+h) - g(V^\\star, w^\\star-h)}{2h}$\n\n计算出雅可比矩阵 $J$ 后，计算其特征值 $\\lambda_1, \\lambda_2$。根据给定的整数代码，基于这些特征值的实部对稳定性进行分类：\n- **代码 0 (稳定):** 如果 $\\text{Re}(\\lambda_1) < 0$ 且 $\\text{Re}(\\lambda_2) < 0$。该平衡点是一个吸引子。\n- **代码 1 (鞍点):** 如果特征值的实部符号相反，即 $\\text{Re}(\\lambda_1) \\cdot \\text{Re}(\\lambda_2) < 0$。该平衡点是不稳定的。\n- **代码 2 (不稳定):** 适用于平衡点既不稳定也非鞍点的所有其他情况。这通常包括不稳定的结点或焦点，其中 $\\text{Re}(\\lambda_1) > 0$ 且 $\\text{Re}(\\lambda_2) > 0$，或者对于复共轭对，$\\text{Re}(\\lambda_1, \\lambda_2) > 0$。\n\n### 5. 轨迹模拟与锋电位检测\n为了测试兴奋性，我们从一个轻微扰动第一个发现的平衡点的初始条件开始模拟系统的轨迹：\n$$\n(V(0), w(0)) = (V^\\star + \\Delta V, w^\\star), \\quad \\text{with } \\Delta V = 5 \\, \\mathrm{mV}\n$$\n该常微分方程组（ODE）在一个 $300 \\, \\mathrm{ms}$ 的时间间隔内进行积分。为此，使用了一个稳健的自适应步长求解器 `scipy.integrate.solve_ivp`，以确保准确性和效率。\n\n模拟之后，如果轨迹中任意点的膜电位 $V(t)$ 超过了预定义的阈值 $V_{\\mathrm{th}} = -20 \\, \\mathrm{mV}$，则检测到一个锋电位。我们检查是否 $\\max_{t} V(t) > V_{\\mathrm{th}}$ 并将结果报告为布尔值。如果未找到平衡点，则无法执行此模拟，我们报告没有发生锋电位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the phase-plane analysis for the given test cases.\n    \"\"\"\n\n    # --- Model Functions ---\n\n    def m_inf(V, V1, V2):\n        return 0.5 * (1.0 + np.tanh((V - V1) / V2))\n\n    def w_inf(V, V3, V4):\n        return 0.5 * (1.0 + np.tanh((V - V3) / V4))\n\n    def tau_w(V, V3, V4):\n        # Add a small epsilon to avoid division by zero if cosh is too large,\n        # although with standard float64 precision this is very unlikely for the given V range.\n        return 1.0 / (np.cosh((V - V3) / (2.0 * V4)) + 1e-12)\n\n    def f_current(V, w, params):\n        C, g_L, E_L, g_Ca, E_Ca, g_K, E_K, phi, V1, V2, V3, V4, I_app = params\n        i_L = g_L * (V - E_L)\n        i_Ca = g_Ca * m_inf(V, V1, V2) * (V - E_Ca)\n        i_K = g_K * w * (V - E_K)\n        return I_app - i_L - i_Ca - i_K\n\n    def g_recovery(V, w, params):\n        C, g_L, E_L, g_Ca, E_Ca, g_K, E_K, phi, V1, V2, V3, V4, I_app = params\n        return phi * (w_inf(V, V3, V4) - w) / tau_w(V, V3, V4)\n\n    # --- Numerical Methods ---\n\n    def bisection(func, a, b, tol=1e-9, max_iter=100):\n        fa, fb = func(a), func(b)\n        if fa * fb >= 0:\n            return None\n        for _ in range(max_iter):\n            c = (a + b) / 2.0\n            fc = func(c)\n            if np.abs(fc) < tol or (b - a) / 2.0 < tol:\n                return c\n            if fa * fc < 0:\n                b = c\n            else:\n                a = c\n                fa = fc\n        return (a + b) / 2.0\n\n    def find_equilibria(params, V_range, n_points=2000):\n        V_grid = np.linspace(V_range[0], V_range[1], n_points)\n        \n        C, g_L, E_L, g_Ca, E_Ca, g_K, E_K, phi, V1, V2, V3, V4, I_app = params\n        F_V = lambda V: f_current(V, w_inf(V, V3, V4), params)\n\n        roots = []\n        y = F_V(V_grid)\n        for i in range(n_points - 1):\n            if y[i] * y[i+1] < 0:\n                root = bisection(F_V, V_grid[i], V_grid[i+1])\n                if root is not None:\n                    roots.append(root)\n        return sorted(roots)\n\n    def compute_jacobian(V_star, w_star, params, h=1e-5):\n        C = params[0]\n        J11 = (f_current(V_star + h, w_star, params) - f_current(V_star - h, w_star, params)) / (2.0 * h * C)\n        J12 = (f_current(V_star, w_star + h, params) - f_current(V_star, w_star - h, params)) / (2.0 * h * C)\n        J21 = (g_recovery(V_star + h, w_star, params) - g_recovery(V_star - h, w_star, params)) / (2.0 * h)\n        J22 = (g_recovery(V_star, w_star + h, params) - g_recovery(V_star, w_star - h, params)) / (2.0 * h)\n        return np.array([[J11, J12], [J21, J22]])\n\n    def classify_stability(J):\n        eigenvalues = np.linalg.eigvals(J)\n        real_parts = np.real(eigenvalues)\n        if np.all(real_parts < 0):\n            return 0  # Stable\n        elif real_parts[0] * real_parts[1] < 0:\n            return 1  # Saddle\n        else:\n            return 2  # Unstable\n\n    def simulate_and_detect_spike(V_star, w_star, params, V_th, V_pert, t_end):\n        C = params[0]\n        V0 = V_star + V_pert\n        w0 = w_star\n        \n        def ode_system(t, y):\n            V, w = y\n            dVdt = f_current(V, w, params) / C\n            dwdt = g_recovery(V, w, params)\n            return [dVdt, dwdt]\n\n        sol = solve_ivp(ode_system, [0, t_end], [V0, w0], dense_output=True, max_step=1.0)\n        \n        if np.any(sol.y[0] > V_th):\n            return True\n        return False\n\n    # --- Test Cases and Main Loop ---\n\n    test_cases = [\n        # (C, g_L, E_L, g_Ca, E_Ca, g_K, E_K, phi, V1, V2, V3, V4, I_app)\n        (20, 2, -60, 4.4, 120, 8, -84, 0.04, -1.2, 18, 2, 30, 50),\n        (20, 2, -60, 4.4, 120, 8, -84, 0.04, -1.2, 18, 2, 30, 200),\n        (20, 2, -60, 0, 120, 8, -84, 0.04, -1.2, 18, 2, 30, 50),\n    ]\n\n    V_range = [-80.0, 60.0]\n    V_th = -20.0\n    V_pert = 5.0\n    t_end = 300.0\n    \n    final_results = []\n\n    for params in test_cases:\n        V3, V4 = params[10], params[11]\n\n        equilibria_V = find_equilibria(params, V_range)\n        n_eq = len(equilibria_V)\n\n        if n_eq > 0:\n            V_star = equilibria_V[0]  # First equilibrium (lowest voltage)\n            w_star = w_inf(V_star, V3, V4)\n\n            J = compute_jacobian(V_star, w_star, params)\n            stability_code = classify_stability(J)\n\n            spiked = simulate_and_detect_spike(V_star, w_star, params, V_th, V_pert, t_end)\n            \n            V_star_str = f\"{V_star:.3f}\"\n            spiked_str = \"True\" if spiked else \"False\"\n        else:\n            n_eq = 0\n            V_star_str = \"NaN\"\n            stability_code = -1\n            spiked_str = \"False\"\n        \n        case_result = f\"[{n_eq},{V_star_str},{stability_code},{spiked_str}]\"\n        final_results.append(case_result)\n\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```"
        }
    ]
}