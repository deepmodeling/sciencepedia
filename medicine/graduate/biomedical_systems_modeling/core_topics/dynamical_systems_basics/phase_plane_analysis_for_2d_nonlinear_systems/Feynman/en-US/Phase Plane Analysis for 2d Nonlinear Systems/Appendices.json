{
    "hands_on_practices": [
        {
            "introduction": "The first step in understanding any dynamical system is to identify its steady states, or equilibria, and determine their stability. This exercise guides you through the fundamental workflow of phase plane analysis using a classic host-pathogen model. By finding the equilibrium points and linearizing the system around them , you will practice computing the Jacobian matrix, a cornerstone tool for predicting whether small perturbations from a steady state will grow or decay.",
            "id": "3918212",
            "problem": "A host–pathogen interaction can be modeled in biomedical systems modeling by the coupled nonlinear Ordinary Differential Equation (ODE) system\n$$\n\\dot{x} = x(1 - x) - x y, \\quad \\dot{y} = \\beta x y - \\delta y,\n$$\nwhere $x$ denotes a dimensionless host cell density subject to saturating growth and pathogen-mediated loss, $y$ denotes a dimensionless pathogen load, $\\beta$ is a positive interaction coefficient representing pathogen proliferation per host contact, and $\\delta$ is a positive pathogen clearance rate. The biologically relevant phase plane is the quadrant $x \\ge 0$, $y \\ge 0$. Use only fundamental definitions: an equilibrium satisfies $\\dot{x} = 0$ and $\\dot{y} = 0$, the Jacobian matrix $J(x,y)$ is the matrix of first partial derivatives of the vector field with respect to the state variables, and the linearized system about an equilibrium $(x^{\\ast}, y^{\\ast})$ is obtained by the first-order Taylor expansion of the vector field in the deviation variables $(u, v) = (x - x^{\\ast}, y - y^{\\ast})$.\n\nTasks:\n- Identify all equilibria in the biologically relevant quadrant.\n- Compute the Jacobian matrix $J(x,y)$.\n- Evaluate $J(x,y)$ at each equilibrium and write the corresponding linearized system in terms of $(u, v)$ near each equilibrium.\n\nAnswer specification:\n- As your final reported quantity, provide the determinant of the Jacobian matrix evaluated at the endemic equilibrium $(x^{\\ast}, y^{\\ast}) = \\left(\\frac{\\delta}{\\beta},\\, 1 - \\frac{\\delta}{\\beta}\\right)$ in simplest symbolic form as an analytic expression in terms of $\\beta$ and $\\delta$. No rounding is required. Express your final answer symbolically; do not include units.",
            "solution": "The problem statement is rigorously validated and found to be valid. It is scientifically grounded, well-posed, objective, and self-contained, presenting a standard problem in the phase plane analysis of nonlinear dynamical systems used in biomedical modeling. All provided information is consistent and sufficient to proceed with a solution.\n\nThe system of nonlinear Ordinary Differential Equations (ODEs) is given by:\n$$\n\\dot{x} = x(1 - x) - x y \\equiv f(x, y)\n$$\n$$\n\\dot{y} = \\beta x y - \\delta y \\equiv g(x, y)\n$$\nwhere $x, y \\ge 0$ and the parameters $\\beta, \\delta$ are positive constants.\n\n**1. Identification of Equilibria**\n\nEquilibria $(x^{\\ast}, y^{\\ast})$ are points where the rates of change are zero, i.e., $\\dot{x} = 0$ and $\\dot{y} = 0$.\n$$\nx^{\\ast}(1 - x^{\\ast} - y^{\\ast}) = 0\n$$\n$$\ny^{\\ast}(\\beta x^{\\ast} - \\delta) = 0\n$$\nFrom the first equation, we have either $x^{\\ast} = 0$ or $1 - x^{\\ast} - y^{\\ast} = 0$. From the second equation, we have either $y^{\\ast} = 0$ or $\\beta x^{\\ast} - \\delta = 0$. We analyze the possible combinations:\n\nCase 1: $x^{\\ast} = 0$. The first equation is satisfied. The second equation becomes $y^{\\ast}(0 - \\delta) = -\\delta y^{\\ast} = 0$. Since $\\delta  0$, this implies $y^{\\ast} = 0$. This gives the trivial equilibrium:\n$$\nE_1 = (0, 0)\n$$\n\nCase 2: $y^{\\ast} = 0$. The second equation is satisfied. The first equation becomes $x^{\\ast}(1 - x^{\\ast}) = 0$. This yields $x^{\\ast} = 0$ (which leads back to $E_1$) or $x^{\\ast} = 1$. This gives the disease-free equilibrium:\n$$\nE_2 = (1, 0)\n$$\n\nCase 3: $x^{\\ast} \\neq 0$ and $y^{\\ast} \\neq 0$. For this, we must satisfy $1 - x^{\\ast} - y^{\\ast} = 0$ and $\\beta x^{\\ast} - \\delta = 0$. The second condition gives $x^{\\ast} = \\frac{\\delta}{\\beta}$. Substituting this into the first condition gives $1 - \\frac{\\delta}{\\beta} - y^{\\ast} = 0$, which yields $y^{\\ast} = 1 - \\frac{\\delta}{\\beta}$. This gives the endemic equilibrium:\n$$\nE_3 = \\left(\\frac{\\delta}{\\beta}, 1 - \\frac{\\delta}{\\beta}\\right)\n$$\nFor this equilibrium to be in the biologically relevant quadrant with $x^{\\ast}  0$ and $y^{\\ast}  0$, we require $1 - \\frac{\\delta}{\\beta}  0$, or $\\beta  \\delta$.\n\n**2. Computation of the Jacobian Matrix**\n\nThe Jacobian matrix $J(x, y)$ is the matrix of first partial derivatives of the vector field $(f(x,y), g(x,y))$:\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\ \\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y} \\end{pmatrix}\n$$\nThe partial derivatives are:\n$\\frac{\\partial f}{\\partial x} = \\frac{\\partial}{\\partial x}(x - x^2 - xy) = 1 - 2x - y$\n$\\frac{\\partial f}{\\partial y} = \\frac{\\partial}{\\partial y}(x - x^2 - xy) = -x$\n$\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x}(\\beta xy - \\delta y) = \\beta y$\n$\\frac{\\partial g}{\\partial y} = \\frac{\\partial}{\\partial y}(\\beta xy - \\delta y) = \\beta x - \\delta$\n\nSo, the Jacobian matrix is:\n$$\nJ(x, y) = \\begin{pmatrix} 1 - 2x - y  -x \\\\ \\beta y  \\beta x - \\delta \\end{pmatrix}\n$$\n\n**3. Linearization at Each Equilibrium**\n\nThe linearized system in terms of deviations $(u, v) = (x - x^{\\ast}, y - y^{\\ast})$ is given by $\\begin{pmatrix} \\dot{u} \\\\ \\dot{v} \\end{pmatrix} = J(x^{\\ast}, y^{\\ast}) \\begin{pmatrix} u \\\\ v \\end{pmatrix}$.\n\nAt $E_1 = (0, 0)$:\n$J(0, 0) = \\begin{pmatrix} 1 - 0 - 0  0 \\\\ \\beta(0)  \\beta(0) - \\delta \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  -\\delta \\end{pmatrix}$.\nThe linearized system is $\\dot{u} = u$ and $\\dot{v} = -\\delta v$.\n\nAt $E_2 = (1, 0)$:\n$J(1, 0) = \\begin{pmatrix} 1 - 2(1) - 0  -1 \\\\ \\beta(0)  \\beta(1) - \\delta \\end{pmatrix} = \\begin{pmatrix} -1  -1 \\\\ 0  \\beta - \\delta \\end{pmatrix}$.\nThe linearized system is $\\dot{u} = -u - v$ and $\\dot{v} = (\\beta - \\delta)v$.\n\nAt $E_3 = \\left(\\frac{\\delta}{\\beta}, 1 - \\frac{\\delta}{\\beta}\\right)$:\nLet $(x^{\\ast}, y^{\\ast}) = \\left(\\frac{\\delta}{\\beta}, 1 - \\frac{\\delta}{\\beta}\\right)$. We evaluate the components of the Jacobian:\n$J_{11} = 1 - 2x^{\\ast} - y^{\\ast} = 1 - 2\\left(\\frac{\\delta}{\\beta}\\right) - \\left(1 - \\frac{\\delta}{\\beta}\\right) = 1 - \\frac{2\\delta}{\\beta} - 1 + \\frac{\\delta}{\\beta} = -\\frac{\\delta}{\\beta}$\n$J_{12} = -x^{\\ast} = -\\frac{\\delta}{\\beta}$\n$J_{21} = \\beta y^{\\ast} = \\beta\\left(1 - \\frac{\\delta}{\\beta}\\right) = \\beta - \\delta$\n$J_{22} = \\beta x^{\\ast} - \\delta = \\beta\\left(\\frac{\\delta}{\\beta}\\right) - \\delta = \\delta - \\delta = 0$\nSo, the Jacobian at the endemic equilibrium is:\n$$\nJ\\left(\\frac{\\delta}{\\beta}, 1 - \\frac{\\delta}{\\beta}\\right) = \\begin{pmatrix} -\\frac{\\delta}{\\beta}  -\\frac{\\delta}{\\beta} \\\\ \\beta - \\delta  0 \\end{pmatrix}\n$$\nThe linearized system is $\\dot{u} = -\\frac{\\delta}{\\beta}u - \\frac{\\delta}{\\beta}v$ and $\\dot{v} = (\\beta - \\delta)u$.\n\n**Final Calculation: Determinant of the Jacobian at the Endemic Equilibrium**\n\nThe problem asks for the determinant of the Jacobian matrix evaluated at the endemic equilibrium $(x^{\\ast}, y^{\\ast}) = \\left(\\frac{\\delta}{\\beta}, 1 - \\frac{\\delta}{\\beta}\\right)$.\n$$\n\\det\\left(J(x^{\\ast}, y^{\\ast})\\right) = \\det \\begin{pmatrix} -\\frac{\\delta}{\\beta}  -\\frac{\\delta}{\\beta} \\\\ \\beta - \\delta  0 \\end{pmatrix}\n$$\nUsing the formula for the determinant of a $2 \\times 2$ matrix, $\\det \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix} = ad - bc$:\n$$\n\\det\\left(J(x^{\\ast}, y^{\\ast})\\right) = \\left(-\\frac{\\delta}{\\beta}\\right)(0) - \\left(-\\frac{\\delta}{\\beta}\\right)(\\beta - \\delta)\n$$\n$$\n\\det\\left(J(x^{\\ast}, y^{\\ast})\\right) = 0 + \\frac{\\delta}{\\beta}(\\beta - \\delta)\n$$\n$$\n\\det\\left(J(x^{\\ast}, y^{\\ast})\\right) = \\frac{\\delta}{\\beta}\\beta - \\frac{\\delta}{\\beta}\\delta = \\delta - \\frac{\\delta^2}{\\beta}\n$$\nThis is the final symbolic expression in its simplest form.",
            "answer": "$$\n\\boxed{\\delta - \\frac{\\delta^2}{\\beta}}\n$$"
        },
        {
            "introduction": "Linearization is a powerful tool, but it fails when an equilibrium is nonhyperbolic, leaving its stability undecided. This practice explores such a scenario, using a model of a biochemical oscillator to demonstrate how to resolve the ambiguity . You will transform the system into polar coordinates to uncover the true nonlinear dynamics, a crucial skill for analyzing systems near a Hopf bifurcation where oscillatory behavior emerges.",
            "id": "3918233",
            "problem": "Consider a reduced, nondimensional, two-dimensional Ordinary Differential Equation (ODE) model of a biochemical genetic oscillator near a Hopf bifurcation equilibrium, where the state vector is $\\mathbf{x}(t) = (x(t), y(t))$ and the time derivative is denoted by $\\dot{\\mathbf{x}} = \\frac{d\\mathbf{x}}{dt}$. The model is\n$$\n\\begin{aligned}\n\\dot{x} = -y - x\\left(x^{2} + y^{2}\\right), \\\\\n\\dot{y} = x - y\\left(x^{2} + y^{2}\\right),\n\\end{aligned}\n$$\nwhich captures a linear rotational component and a nonlinear amplitude-dependent damping consistent with near-Hopf normal form behavior in polar coordinates. The equilibrium at the origin $(x,y)=(0,0)$ represents a steady biochemical state. \n\nUsing phase plane analysis, proceed as follows:\n1. Starting from the definition of linearization via the Jacobian matrix $D\\mathbf{f}(\\mathbf{x})$ evaluated at the equilibrium, compute $D\\mathbf{f}(0,0)$ and its eigenvalues. Interpret the classification of the equilibrium for the linearized system and explain why linearization fails to determine whether the nonlinear equilibrium is a center or a focus.\n2. To resolve the actual nonlinear behavior, introduce polar coordinates via $x = r\\cos\\theta$ and $y = r\\sin\\theta$, with $r \\ge 0$ and $\\theta \\in \\mathbb{R}$. Use the chain rule and the definitions $r = \\sqrt{x^{2}+y^{2}}$ and $\\theta = \\arctan\\!\\left(\\frac{y}{x}\\right)$ to derive explicit expressions for $\\dot{r}$ and $\\dot{\\theta}$ in terms of $r$ and $\\theta$ for $r0$. Carefully justify every step from first principles and simplify your expressions to depend on $r$ only where possible.\n3. Based on your derivation, determine the small-amplitude behavior near $r=0$ and state whether trajectories spiral in or out. You may use a Lyapunov energy-like function $V(r) = \\frac{1}{2}r^{2}$ if needed to formalize your conclusion on stability.\n\nYour final reported answer must be the exact closed-form analytical expression for $\\dot{r}$ as a function of $r$ obtained from this model. No numerical approximation is required.",
            "solution": "We begin by analyzing the given nonlinear system:\n$$\n\\begin{aligned}\n\\dot{x} = -y - x\\left(x^{2} + y^{2}\\right), \\\\\n\\dot{y} = x - y\\left(x^{2} + y^{2}\\right).\n\\end{aligned}\n$$\nThe equilibrium at the origin is found by setting $\\dot{x}=\\dot{y}=0$, which is satisfied by $(x,y)=(0,0)$.\n\nStep 1: Linearization via the Jacobian and why it fails to classify centers.\nThe Jacobian matrix $D\\mathbf{f}(x,y)$ is defined by\n$$\nD\\mathbf{f}(x,y) = \n\\begin{pmatrix}\n\\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial y} \\\\\n\\frac{\\partial \\dot{y}}{\\partial x}  \\frac{\\partial \\dot{y}}{\\partial y}\n\\end{pmatrix}.\n$$\nCompute the partial derivatives. Let $r^{2} = x^{2}+y^{2}$ for brevity. For $\\dot{x} = -y - x r^{2}$,\n$$\n\\frac{\\partial \\dot{x}}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(-y - x r^{2}\\right) = -\\frac{\\partial y}{\\partial x} - \\left(r^{2} + x\\cdot 2x\\right) = 0 - \\left(x^{2} + y^{2} + 2x^{2}\\right) = -\\left(3x^{2} + y^{2}\\right),\n$$\n$$\n\\frac{\\partial \\dot{x}}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(-y - x r^{2}\\right) = -1 - x\\cdot 2y = -1 - 2xy.\n$$\nFor $\\dot{y} = x - y r^{2}$,\n$$\n\\frac{\\partial \\dot{y}}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(x - y r^{2}\\right) = 1 - y\\cdot 2x = 1 - 2xy,\n$$\n$$\n\\frac{\\partial \\dot{y}}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(x - y r^{2}\\right) = 0 - \\left(r^{2} + y\\cdot 2y\\right) = -\\left(x^{2} + 3y^{2}\\right).\n$$\nEvaluated at $(x,y)=(0,0)$, the Jacobian becomes\n$$\nD\\mathbf{f}(0,0) = \n\\begin{pmatrix}\n0  -1 \\\\\n1  0\n\\end{pmatrix}.\n$$\nThe eigenvalues $\\lambda$ of this matrix satisfy\n$$\n\\det\\!\\left(\n\\begin{pmatrix}\n0  -1 \\\\\n1  0\n\\end{pmatrix}\n- \\lambda \n\\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix}\n\\right) \n= \\det\n\\begin{pmatrix}\n-\\lambda  -1 \\\\\n1  -\\lambda\n\\end{pmatrix}\n= \\lambda^{2} + 1 = 0,\n$$\nso $\\lambda = \\pm i$. The linearized system is a pure rotation with closed circular orbits, classically classified as a linear center. However, the presence of purely imaginary eigenvalues means the equilibrium is nonhyperbolic, and thus the Hartman–Grobman theorem does not guarantee topological equivalence between the nonlinear and linear dynamics near the equilibrium. Consequently, linearization fails to determine whether the nonlinear system has a center (closed orbits) or a focus (spiraling in/out).\n\nStep 2: Polar coordinate transformation and derivation of $\\dot{r}$ and $\\dot{\\theta}$.\nIntroduce polar coordinates by $x = r\\cos\\theta$ and $y = r\\sin\\theta$, where $r = \\sqrt{x^{2}+y^{2}}$ and $\\theta = \\arctan\\!\\left(\\frac{y}{x}\\right)$. We use the chain rule to compute $\\dot{r}$ and $\\dot{\\theta}$ directly from $(\\dot{x},\\dot{y})$.\n\nFor $r = \\sqrt{x^{2}+y^{2}}$, the time derivative is\n$$\n\\dot{r} = \\frac{d}{dt}\\left(\\sqrt{x^{2}+y^{2}}\\right) = \\frac{1}{2}(x^{2}+y^{2})^{-1/2}\\cdot 2\\left(x\\dot{x} + y\\dot{y}\\right) = \\frac{x\\dot{x} + y\\dot{y}}{r},\n$$\nvalid for $r0$, and extended continuously by $\\dot{r}(0)=0$ at $r=0$.\n\nSimilarly, using the identity for angular velocity,\n$$\n\\dot{\\theta} = \\frac{x\\dot{y} - y\\dot{x}}{r^{2}},\n$$\nvalid for $r0$, which follows from differentiating $x=r\\cos\\theta$ and $y=r\\sin\\theta$ and solving the linear system for $\\dot{r}$ and $\\dot{\\theta}$.\n\nCompute $x\\dot{x} + y\\dot{y}$ using the given dynamics:\n$$\nx\\dot{x} + y\\dot{y} = x\\left(-y - x r^{2}\\right) + y\\left(x - y r^{2}\\right) = -xy - x^{2}r^{2} + xy - y^{2}r^{2} = -\\left(x^{2}+y^{2}\\right)r^{2} = -r^{2}\\cdot r^{2} = -r^{4}.\n$$\nThus,\n$$\n\\dot{r} = \\frac{-r^{4}}{r} = -r^{3} \\quad \\text{for } r0,\n$$\nand by continuity $\\dot{r} = -r^{3}$ also at $r=0$.\n\nNext, compute $x\\dot{y} - y\\dot{x}$:\n$$\nx\\dot{y} - y\\dot{x} = x\\left(x - y r^{2}\\right) - y\\left(-y - x r^{2}\\right) = x^{2} - xyr^{2} + y^{2} + xyr^{2} = x^{2} + y^{2} = r^{2}.\n$$\nTherefore,\n$$\n\\dot{\\theta} = \\frac{r^{2}}{r^{2}} = 1 \\quad \\text{for } r0,\n$$\nand $\\dot{\\theta}$ remains well-defined as the angular velocity approaches $1$ for small $r$.\n\nWe have derived exact expressions:\n$$\n\\dot{r} = -r^{3}, \\qquad \\dot{\\theta} = 1.\n$$\n\nStep 3: Small-amplitude behavior and stability.\nNear $r=0$, the radial dynamics $\\dot{r} = -r^{3}$ implies that for any $r0$, $\\dot{r}0$, so trajectories monotonically decrease in radius while rotating at approximately constant angular velocity $\\dot{\\theta} = 1$. This is the hallmark of a stable focus (spiral sink). To formalize stability, define $V(r) = \\frac{1}{2}r^{2}$, which is positive definite for $r\\neq 0$. Its time derivative is\n$$\n\\dot{V} = \\frac{d}{dt}\\left(\\frac{1}{2}r^{2}\\right) = r\\dot{r} = r\\left(-r^{3}\\right) = -r^{4} \\le 0,\n$$\nwith equality only at $r=0$. Hence, $V$ is a strict Lyapunov function showing that the origin is asymptotically stable. This demonstrates how linearization indicates a center in the linear approximation but fails to classify the nonlinear equilibrium, which is in fact a stable focus due to the cubic amplitude damping. The decisive quantity is the exact radial dynamics $\\dot{r}$, which we have computed.\n\nThe requested final answer is the exact analytic expression for $\\dot{r}$ as a function of $r$, namely $\\dot{r} = -r^{3}$.",
            "answer": "$$\\boxed{-r^{3}}$$"
        },
        {
            "introduction": "Many biomedical systems, from neurons to cardiac cells, exhibit stable oscillations known as limit cycles, which cannot be analyzed by studying equilibria alone. This computational exercise introduces the Poincaré map, a powerful technique for studying the stability of periodic orbits by reducing the continuous flow to a discrete map . By numerically implementing this method for the Van der Pol oscillator, you will gain hands-on experience with tools essential for understanding rhythmic biological phenomena.",
            "id": "3918241",
            "problem": "Consider the planar autonomous Ordinary Differential Equation (ODE) system used as a canonical model for relaxation oscillations in biomedical systems such as cardiac rhythm and neural activity, the Van der Pol oscillator:\n$$\n\\begin{cases}\n\\dot{x} = y,\\\\\n\\dot{y} = \\mu (1 - x^2)\\,y - x,\n\\end{cases}\n$$\nwhere $\\mu  0$ is a dimensionless parameter that controls nonlinearity and timescale separation. For each specified value of $\\mu$, assume the existence of a unique attracting limit cycle.\n\nYour tasks are to construct a Poincaré map using a transverse section, compute its derivative at the fixed point corresponding to the limit cycle, and assess stability via the nontrivial Floquet multiplier. All steps must be executed numerically in a program, following these precise instructions.\n\n1. Define the Poincaré section $\\Sigma$ as the vertical line $x = 0$ with crossings in the increasing $x$ direction (i.e., $x$ crosses $0$ with $\\dot{x}  0$). A point $(x,y)$ lies on $\\Sigma$ if and only if $x = 0$ and $y  0$.\n2. For a given $\\mu$, numerically integrate the system from a reasonable initial condition until the solution approaches the attracting limit cycle. Detect successive crossings of $\\Sigma$ and estimate the period $T$ of the limit cycle as the difference between the last two crossing times. Let $y^\\star$ denote the $y$-coordinate of the state on $\\Sigma$ at the last detected crossing, which is a fixed point of the Poincaré return map.\n3. Define the Poincaré return map $P$ near the fixed point as follows: given an initial section value $y_0$ at $(x,y) = (0,y_0)$, integrate forward until the next return to $\\Sigma$ with increasing $x$, and define $P(y_0)$ to be the $y$-value at that return. Numerically approximate the derivative $P'(y^\\star)$ using a symmetric finite difference with a perturbation\n$$\n\\delta = 10^{-4}\\,\\max\\{1, |y^\\star|\\}.\n$$\nTo avoid immediate event detection at $t=0$, initialize the perturbed states at $(x,y) = (-\\epsilon,\\, y^\\star \\pm \\delta)$ with $\\epsilon = 10^{-6}$ and integrate forward to the next crossing. Compute\n$$\nP'(y^\\star) \\approx \\frac{P(y^\\star + \\delta) - P(y^\\star - \\delta)}{2\\delta}.\n$$\n4. Independently compute the nontrivial Floquet multiplier using the divergence formula specific to planar autonomous systems. The vector field is $f(x,y) = (y,\\, \\mu (1-x^2)y - x)$ with divergence\n$$\n\\nabla\\cdot f(x,y) = \\frac{\\partial f_1}{\\partial x} + \\frac{\\partial f_2}{\\partial y} = 0 + \\mu(1 - x^2).\n$$\nLet $z(t) = (x(t), y(t))$ be the limit cycle trajectory parameterized by time with period $T$ starting from $(0, y^\\star)$. Numerically evaluate the integral\n$$\nI = \\int_0^T \\nabla \\cdot f(z(t))\\, dt = \\int_0^T \\mu \\big(1 - x(t)^2\\big)\\, dt,\n$$\nand set the multiplier estimate\n$$\n\\Lambda_{\\mathrm{div}} = e^{I}.\n$$\n5. Decide stability via the Floquet multiplier: the limit cycle is stable if and only if the magnitude of the nontrivial Floquet multiplier is strictly less than $1$, i.e., $|\\Lambda|  1$. Use the derivative $P'(y^\\star)$ of the Poincaré map as the primary estimate of the nontrivial Floquet multiplier, and report stability based on this estimate.\n6. Numerical constraints and units:\n   - All variables are dimensionless.\n   - Use radians for any internally computed angles if applicable (no explicit angles are required here).\n   - All numerical integrations must be accurate enough to consistently resolve crossings and return maps; use event detection for the section $x = 0$ with increasing $x$.\n\nTest Suite:\n- Use the following parameter values for the test suite: $\\mu \\in \\{0.5, 1.5, 3.0\\}$.\n- For each $\\mu$, your program must:\n  - Estimate $P'(y^\\star)$ via symmetric finite differences as specified.\n  - Estimate $\\Lambda_{\\mathrm{div}}$ via the divergence integral along one period.\n  - Compute the absolute difference $\\left|P'(y^\\star) - \\Lambda_{\\mathrm{div}}\\right|$.\n  - Determine stability as a boolean using the criterion $|P'(y^\\star)|  1$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$).\n- Each $\\text{result}_k$ must be a list of the form $[\\mu, P'(y^\\star), \\Lambda_{\\mathrm{div}}, |P'(y^\\star) - \\Lambda_{\\mathrm{div}}|, \\text{stable}]$ where $\\mu$, $P'(y^\\star)$, $\\Lambda_{\\mathrm{div}}$, and $|P'(y^\\star) - \\Lambda_{\\mathrm{div}}|$ are floating point numbers and $\\text{stable}$ is a boolean.\n- All floating point numbers should be rounded to six decimal places in the output.",
            "solution": "The problem presented is a valid and well-posed numerical exercise in dynamical systems theory. It requires the analysis of the Van der Pol oscillator, a canonical model for relaxation oscillations. The tasks involve numerically locating a limit cycle, determining its stability by calculating the derivative of its Poincaré map, and verifying this result using the integral of the vector field's divergence along the cycle, which is related to the Floquet multipliers via Liouville's formula. All aspects of the problem are scientifically grounded, mathematically consistent, and computationally feasible.\n\nThe methodology for solving this problem involves several distinct numerical steps. We will implement these steps for each specified value of the parameter $\\mu$.\n\nFirst, we define the system of ordinary differential equations (ODEs) for the Van der Pol oscillator:\n$$\n\\begin{cases}\n\\dot{x} = y \\\\\n\\dot{y} = \\mu (1 - x^2)y - x\n\\end{cases}\n$$\nwhere $z(t) = (x(t), y(t))$ is the state vector and $\\mu  0$ is a parameter.\n\nThe core of the analysis relies on the concept of a Poincaré map, which reduces the study of a continuous-time periodic orbit to a discrete-time map. The Poincaré section $\\Sigma$ is defined as the positive $y$-axis, i.e., points $(x,y)$ where $x=0$ and $y0$. A crossing is registered when the trajectory passes through $x=0$ with $\\dot{x} = y  0$.\n\nThe overall algorithm proceeds as follows:\n\n1.  **Locating the Limit Cycle and its Fixed Point**: For a given $\\mu$, we begin by numerically integrating the ODE system from an arbitrary initial condition, such as $(x_0, y_0) = (1, 1)$, for a sufficiently long duration. Since the Van der Pol oscillator possesses a unique attracting limit cycle for $\\mu0$, any trajectory (except one starting at the unstable fixed point at the origin) will converge to it. We use a numerical integrator with event detection capabilities, specifically `scipy.integrate.solve_ivp`, to find the times of successive crossings of the section $\\Sigma$. The difference between the last two crossing times, $t_{n-1}$ and $t_n$, provides an accurate estimate of the limit cycle's period, $T = t_n - t_{n-1}$. The state at the final crossing time, $(0, y^\\star)$, gives the $y$-coordinate of the fixed point of the Poincaré return map.\n\n2.  **Computing the Poincaré Map Derivative $P'(y^\\star)$**: The stability of the limit cycle is determined by the magnitude of the derivative of the Poincaré map, $P'(y^\\star)$, at the fixed point $y^\\star$. A value $|P'(y^\\star)|  1$ indicates a stable limit cycle. We approximate this derivative using a second-order symmetric finite difference formula:\n    $$\n    P'(y^\\star) \\approx \\frac{P(y^\\star + \\delta) - P(y^\\star - \\delta)}{2\\delta}\n    $$\n    The perturbation $\\delta$ is chosen as $\\delta = 10^{-4} \\max\\{1, |y^\\star|\\}$. To evaluate $P(y^\\star \\pm \\delta)$, we must find the next return to $\\Sigma$ starting from a perturbed point on the section. A subtle but critical detail is to avoid starting the integration exactly on the section ($x=0$), as this would trigger the event detector at $t=0$. Instead, we start from initial conditions $(x,y) = (-\\epsilon, y^\\star \\pm \\delta)$, where $\\epsilon = 10^{-6}$ is a small negative offset. We integrate forward in time from each of these two initial conditions until the trajectory next crosses $\\Sigma$. The $y$-coordinates at these return points are the values $P(y^\\star + \\delta)$ and $P(y^\\star - \\delta)$.\n\n3.  **Computing the Floquet Multiplier via Divergence $\\Lambda_{\\mathrm{div}}$**: An independent method to calculate the nontrivial Floquet multiplier comes from Liouville's formula. For a 2D autonomous system, the nontrivial multiplier $\\Lambda$ for a periodic orbit of period $T$ is given by:\n    $$\n    \\Lambda = \\exp\\left(\\int_0^T \\nabla \\cdot f(z(t)) \\, dt\\right)\n    $$\n    where $f(z(t))$ is the vector field evaluated along the limit cycle trajectory $z(t)$. The divergence of the Van der Pol vector field $f(x,y) = (y, \\mu(1-x^2)y - x)$ is:\n    $$\n    \\nabla \\cdot f = \\frac{\\partial}{\\partial x}(y) + \\frac{\\partial}{\\partial y}(\\mu(1-x^2)y - x) = \\mu(1 - x^2)\n    $$\n    To accurately compute the integral $I = \\int_0^T \\mu(1 - x(t)^2) dt$, we augment the original ODE system with a third variable representing the accumulated value of the integral:\n    $$\n    \\begin{cases}\n    \\dot{x} = y \\\\\n    \\dot{y} = \\mu (1 - x^2)y - x \\\\\n    \\dot{I} = \\mu (1 - x^2)\n    \\end{cases}\n    $$\n    We integrate this 3D system over one full period $T$, starting from the initial condition $(x_0, y_0, I_0) = (0, y^\\star, 0)$. The value of the third state variable at time $T$ is the desired integral $I$. The multiplier is then $\\Lambda_{\\mathrm{div}} = e^I$. This approach is generally more accurate than post-processing a stored trajectory. In theory, $P'(y^\\star) = \\Lambda_{\\mathrm{div}}$, so their numerical difference provides a consistency check on our calculations.\n\n4.  **Stability and Output**: Finally, we determine the stability of the limit cycle by checking if $|P'(y^\\star)|  1$. The computed values for each $\\mu$—$P'(y^\\star)$, $\\Lambda_{\\mathrm{div}}$, their absolute difference, and the stability boolean—are collected and formatted to six decimal places for floating-point numbers, as specified.\n\nThis comprehensive numerical procedure robustly analyzes the stability of the Van der Pol oscillator's limit cycle, adhering to the principles of dynamical systems theory.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the final result.\n    \"\"\"\n\n    def vdp(t, z, mu):\n        \"\"\"Van der Pol oscillator ODE system.\"\"\"\n        x, y = z\n        return [y, mu * (1 - x**2) * y - x]\n\n    def vdp_augmented(t, z_aug, mu):\n        \"\"\"Augmented Van der Pol system for divergence integral.\"\"\"\n        x, y, _ = z_aug\n        dxdt = y\n        dydt = mu * (1 - x**2) * y - x\n        dIdt = mu * (1 - x**2)\n        return [dxdt, dydt, dIdt]\n\n    def poincare_section(t, z, mu):\n        \"\"\"Event function for Poincaré section at x=0.\"\"\"\n        return z[0]\n\n    def analyze_mu(mu):\n        \"\"\"\n        Performs the full analysis for a given parameter mu.\n\n        Returns:\n            list: A list containing [mu, P'(y*), Lambda_div, |P'(y*)-Lambda_div|, stable].\n        \"\"\"\n        # Set high accuracy for the ODE solver\n        rtol = 1e-9\n        atol = 1e-12\n\n        # Step 1: Settle onto the limit cycle and find the fixed point y_star and period T.\n        poincare_section.terminal = False\n        poincare_section.direction = 1\n        \n        t_span_settle = [0, 200]\n        z0 = [1.0, 1.0] # Initial condition away from the origin\n        \n        sol_settle = solve_ivp(\n            vdp, t_span_settle, z0, args=(mu,),\n            events=poincare_section, dense_output=True,\n            rtol=rtol, atol=atol\n        )\n        \n        t_crossings = sol_settle.t_events[0]\n        if len(t_crossings)  2:\n            raise RuntimeError(f\"Could not find at least two Poincaré section crossings for mu={mu}\")\n            \n        T = t_crossings[-1] - t_crossings[-2]\n        y_star = sol_settle.sol(t_crossings[-1])[1]\n\n        # Step 2: Compute derivative of Poincaré map P'(y_star)\n        delta = 1e-4 * max(1.0, abs(y_star))\n        epsilon = 1e-6\n        y_plus = y_star + delta\n        y_minus = y_star - delta\n        \n        poincare_section.terminal = True\n        t_span_return = [0, 2 * T]\n\n        # Integrate for y_plus\n        sol_plus = solve_ivp(\n            vdp, t_span_return, [-epsilon, y_plus], args=(mu,),\n            events=poincare_section, rtol=rtol, atol=atol\n        )\n        if not sol_plus.t_events or len(sol_plus.t_events[0]) == 0:\n            raise RuntimeError(f\"No return to Poincaré section for y+ perturbation, mu={mu}\")\n        P_y_plus = sol_plus.y_events[0][0][1]\n\n        # Integrate for y_minus\n        sol_minus = solve_ivp(\n            vdp, t_span_return, [-epsilon, y_minus], args=(mu,),\n            events=poincare_section, rtol=rtol, atol=atol\n        )\n        if not sol_minus.t_events or len(sol_minus.t_events[0]) == 0:\n            raise RuntimeError(f\"No return to Poincaré section for y- perturbation, mu={mu}\")\n        P_y_minus = sol_minus.y_events[0][0][1]\n        \n        P_prime = (P_y_plus - P_y_minus) / (2 * delta)\n\n        # Step 3: Compute Floquet multiplier via divergence formula\n        z0_aug = [0, y_star, 0]\n        t_span_period = [0, T]\n        \n        sol_aug = solve_ivp(\n            vdp_augmented, t_span_period, z0_aug, args=(mu,),\n            dense_output=False,\n            rtol=rtol, atol=atol\n        )\n        \n        I_integral = sol_aug.y[2, -1]\n        Lambda_div = np.exp(I_integral)\n\n        # Step 4: Final calculations\n        diff = abs(P_prime - Lambda_div)\n        is_stable = abs(P_prime)  1.0\n        \n        return [float(mu), P_prime, Lambda_div, diff, is_stable]\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.5, 1.5, 3.0]\n    \n    results = []\n    for mu in test_cases:\n        result = analyze_mu(mu)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = []\n    for res in results:\n        # Format [mu, P'(y*), Lambda_div, |P'(y*) - Lambda_div|, stable]\n        mu_str = f\"{res[0]:.1f}\"\n        p_prime_str = f\"{res[1]:.6f}\"\n        lambda_div_str = f\"{res[2]:.6f}\"\n        diff_str = f\"{res[3]:.6f}\"\n        stable_str = 'True' if res[4] else 'False'\n        \n        formatted_results.append(f\"[{mu_str},{p_prime_str},{lambda_div_str},{diff_str},{stable_str}]\")\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}