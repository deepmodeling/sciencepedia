{
    "hands_on_practices": [
        {
            "introduction": "在辨识一个系统之前，我们必须首先为其选择一个合适的数学表示。本练习聚焦于线性时不变 (LTI) 系统的两种核心描述方式——频域中的传递函数和时域中的常微分方程——之间的转换关系 。通过推导这一关系，您将加深对系统动态行为基本原理的理解，并探索保证模型物理合理性与稳定性的必要条件。",
            "id": "3935362",
            "problem": "一位生物医学工程师正在辨识一个生理子系统的连续时间线性时不变 (LTI) 近似模型。该模型关联了稳定工作点附近的输入信号 $u(t)$（例如，血管活性药物输注速率）和输出信号 $y(t)$（例如，平均动脉压偏差）。估计的传递函数具有以下实系数有理形式：\n$$\nH(s) \\equiv \\frac{Y(s)}{U(s)} = \\frac{b_{0}+b_{1}s+\\cdots+b_{m}s^{m}}{a_{0}+a_{1}s+\\cdots+a_{n}s^{n}},\n$$\n其中 $Y(s)$ 和 $U(s)$ 表示 $t \\ge 0$ 时 $y(t)$ 和 $u(t)$ 的单边拉普拉斯变换，$m \\le n$ 是非负整数。假设初始条件为零，且模型是因果的。\n\n仅使用基本定义和拉普拉斯变换的性质，完成以下任务：\n\n1. 推导由 $H(s)$ 蕴含的、关联 $y(t)$ 和 $u(t)$ 的时域常微分方程 (ODE)。\n2. 从第一性原理出发，陈述确保 $H(s)$ 对一个物理上合理的生物医学子系统同时具有有界输入有界输出 (BIBO) 稳定性和正常性的最小约束条件，这些约束条件应施加于模型结构和参数 $\\{a_{k}\\}_{k=0}^{n}$ 及 $\\{b_{k}\\}_{k=0}^{m}$。你可以假设要求渐近稳定性（所有极点严格位于开放的左半复平面），且参数为实数。\n3. 为了进行参数辨识，通常通过将分子和分母同除以 $a_{n}$ 来将分母的最高阶系数归一化为1，从而使特征多项式成为首一多项式。假设强制执行此归一化，并通过在模型设计时选择 $m \\le n-1$ 来结构性地强制执行严格正常性（即，通过将分子阶数固定在分母阶数之下，而不是施加系数不等式）。在这些假设下，计算为保证辨识出的模型的渐近稳定性，对剩余的自由多项式系数施加的必要且充分的独立标量不等式约束的最小数量。\n\n只需报告第 3 项要求的数量作为你的最终答案，表示为 $n$ 的函数。不要包含任何单位。如果你的答案是符号形式，请以闭合形式提供。无需四舍五入。",
            "solution": "该问题陈述已经过验证，被认为是科学上可靠、提法明确、客观且自洽的。它提出了一个应用于生物医学建模的线性系统理论中的标准问题，没有可辨别的瑕疵。\n\n该问题要求完成三个不同的项目。我们将逐一解答。\n\n1. 时域常微分方程 (ODE) 的推导。\n\n给定的传递函数为\n$$\nH(s) = \\frac{Y(s)}{U(s)} = \\frac{B(s)}{A(s)} = \\frac{b_{0}+b_{1}s+\\cdots+b_{m}s^{m}}{a_{0}+a_{1}s+\\cdots+a_{n}s^{n}}\n$$\n其中 $Y(s)$ 是输出 $y(t)$ 的拉普拉斯变换，$U(s)$ 是输入 $u(t)$ 的拉普拉斯变换。我们可以将这个代数关系重新整理为：\n$$\nA(s) Y(s) = B(s) U(s)\n$$\n代入 $A(s)$ 和 $B(s)$ 的多项式形式，我们得到：\n$$\n\\left(\\sum_{k=0}^{n} a_{k}s^{k}\\right) Y(s) = \\left(\\sum_{k=0}^{m} b_{k}s^{k}\\right) U(s)\n$$\n该方程关联了复频域中变换后的信号。为了找到对应的时域微分方程，我们对两边应用拉普拉斯逆变换。在零初始条件（即，对于所有需要的导数 $k$，$y^{(k)}(0)=0$ 和 $u^{(k)}(0)=0$）的假设下，单边拉普拉斯变换的一个关键性质是微分性质：\n$$\n\\mathcal{L}\\left\\{\\frac{d^{k}f(t)}{dt^{k}}\\right\\} = s^{k}F(s)\n$$\n应用拉普拉斯逆变换 $\\mathcal{L}^{-1}$ 并利用其线性性质，我们将每一项 $s^{k}F(s)$ 变换回时域，得到 $\\frac{d^{k}f(t)}{dt^{k}}$。\n$$\n\\mathcal{L}^{-1}\\left\\{\\left(\\sum_{k=0}^{n} a_{k}s^{k}\\right) Y(s)\\right\\} = \\mathcal{L}^{-1}\\left\\{\\left(\\sum_{k=0}^{m} b_{k}s^{k}\\right) U(s)\\right\\}\n$$\n$$\n\\sum_{k=0}^{n} a_{k} \\mathcal{L}^{-1}\\left\\{s^{k} Y(s)\\right\\} = \\sum_{k=0}^{m} b_{k} \\mathcal{L}^{-1}\\left\\{s^{k} U(s)\\right\\}\n$$\n这就得出了线性常系数常微分方程：\n$$\na_{n}\\frac{d^{n}y(t)}{dt^{n}} + a_{n-1}\\frac{d^{n-1}y(t)}{dt^{n-1}} + \\cdots + a_{1}\\frac{dy(t)}{dt} + a_{0}y(t) = b_{m}\\frac{d^{m}u(t)}{dt^{m}} + \\cdots + b_{1}\\frac{du(t)}{dt} + b_{0}u(t)\n$$\n这就是关联输出 $y(t)$ 和输入 $u(t)$ 的 ODE。\n\n2. BIBO 稳定性和正常性的最小约束。\n\n对于一个物理系统，其传递函数 $H(s)$ 有两个基本的结构约束：正常性和稳定性。\n\n正常性：一个有理传递函数 $H(s)$ 是正常的，如果其分子多项式的阶数 $m$ 小于或等于分母多项式的阶数 $n$，即 $m \\le n$。如果 $m  n$，则它是严格正常的。正常性是物理可实现性的一个必要条件。一个非正常系统（$m>n$）的增益 $|H(j\\omega)|$ 会在频率 $\\omega \\to \\infty$ 时趋于无穷。这样的系统对于高频信号会像一个理想微分器一样工作，对有限且快速变化的输入产生无限的输出，这在物理上是不可能的。所讨论的生物医学子系统必须至少是正常的，因此模型结构的最小约束是 $m \\le n$。这个问题已在题干中作为前提陈述。\n\n有界输入有界输出 (BIBO) 稳定性：对于一个因果线性时不变 (LTI) 系统，其 BIBO 稳定性得到保证的充要条件是其传递函数 $H(s)$ 的所有极点都位于复平面的开放左半平面。极点是特征方程的根，该方程由分母多项式置零给出：\n$$\nA(s) = a_{0}+a_{1}s+\\cdots+a_{n}s^{n} = 0\n$$\n问题指明要求渐近稳定性，这意味着所有极点的实部都必须严格为负。所有根的实部都严格为负的多项式被称为 Hurwitz 多项式。确保 $A(s)$ 是一个 Hurwitz 多项式的对实系数 $\\{a_{k}\\}_{k=0}^{n}$ 的约束由 Routh-Hurwitz 稳定性判据给出。假设我们将最高阶系数 $a_n$ 归一化为正（如有必要，可以通过将 $H(s)$ 的分子和分母同乘以 $-1$ 来实现，这不失一般性），Routh-Hurwitz 判据提供了一组充要条件。要求的主要条件是 Routh 表第一列中的所有元素（它们是系数 $\\{a_{k}\\}$ 的函数）都必须为正。由此得出的一个必要（但对 $n>2$ 不充分）条件是所有系数 $a_k$（对于 $k = 0, \\dots, n$）都必须为正。完整的约束集在代数上很复杂，但它构成了从系数判断稳定性的明确检验。\n\n3. 稳定性的最小独立不等式约束数量的计数。\n\n我们被要求计算对自由多项式系数 $\\{a_{0}, a_{1}, \\ldots, a_{n-1}\\}$ 施加的、为保证渐近稳定性所必要且充分的独立标量不等式约束的最小数量。这里的假设是特征多项式是首一的（$a_{n}=1$）且系统是严格正常的（$m \\le n-1$）。\n\n特征多项式为 $A(s) = s^{n} + a_{n-1}s^{n-1} + \\cdots + a_{1}s + a_{0}$。渐近稳定性要求 $A(s)=0$ 的所有 $n$ 个根都位于开放的左半复平面。其充要条件由 Routh-Hurwitz 稳定性判据给出。此判据等价于要求与 $A(s)$ 相关联的 Hurwitz 矩阵的所有顺序主子式都为正。\n\n$A(s)$ 的 $n \\times n$ Hurwitz 矩阵由下式给出：\n$$\n\\mathbf{H} = \\begin{pmatrix}\na_{n-1}  a_{n-3}  a_{n-5}  \\dots  \\dots  0 \\\\\na_n  a_{n-2}  a_{n-4}  \\dots  \\dots  0 \\\\\n0  a_{n-1}  a_{n-3}  \\dots  \\dots  0 \\\\\n0  a_n  a_{n-2}  \\dots  \\dots  0 \\\\\n\\vdots    \\ddots    \\vdots \\\\\n0  0  0  \\dots  a_1  0 \\\\\n0  0  0  \\dots  a_2  a_0\n\\end{pmatrix}\n$$\n其中 $a_n=1$，且下标超出范围 $[0, n]$ 的系数为零。令 $\\Delta_k$ 为 $\\mathbf{H}$ 的第 $k$ 个顺序主子式（左上角 $k \\times k$ 子矩阵的行列式）。稳定性的条件是：\n$$\n\\Delta_{1} > 0, \\quad \\Delta_{2} > 0, \\quad \\ldots, \\quad \\Delta_{n} > 0\n$$\n这给出了一组 $n$ 个不等式。我们来考察它们：\n-   $\\Delta_{1} = a_{n-1}$。条件是 $a_{n-1} > 0$。\n-   $\\Delta_{2} = \\det \\begin{pmatrix} a_{n-1}  a_{n-3} \\\\ 1  a_{n-2} \\end{pmatrix} = a_{n-1}a_{n-2} - a_{n-3}$。条件是 $a_{n-1}a_{n-2} - a_{n-3} > 0$。\n-   ...\n-   $\\Delta_{n} = a_0 \\Delta_{n-1}$。条件 $\\Delta_{n} > 0$ 与先前的要求 $\\Delta_{n-1} > 0$ 相结合，简化为 $a_0 > 0$。\n\n因此，渐近稳定性的完整充要条件集由以下 $n$ 个不等式定义：\n$$\n\\Delta_{k}(\\{a_0, \\dots, a_{n-1}\\}) > 0 \\quad \\text{对于 } k = 1, 2, \\ldots, n\n$$\n每个 $\\Delta_k$ 都是系数 $\\{a_0, \\ldots, a_{n-1}\\}$ 的多项式函数。这 $n$ 个不等式在这些系数的 $n$ 维参数空间中定义了稳定域。这个区域是一个开集，其边界由一个或多个不等式变为等式（即 $\\Delta_k = 0$）的超曲面构成。放松这 $n$ 个约束中的任何一个都将允许包含非渐近稳定系统（即，极点位于虚轴上或右半平面的系统）。例如，$\\Delta_n = 0$（如果 $\\Delta_{n-1} \\neq 0$ 则意味着 $a_0=0$）对应于原点处的一个极点，而对于偶数 $n$，$\\Delta_{n-1}=0$ 对应于虚轴上的一对极点。\n因此，给定的这 $n$ 个不等式集是无冗余且最小的。在给定系数上，没有更小的标量不等式集能够定义整个稳定域。\n\n因此，独立标量不等式约束的最小数量等于这些行列式的数量，即 $n$。",
            "answer": "$$\n\\boxed{n}\n$$"
        },
        {
            "introduction": "确定模型结构后，下一步便是从实验数据中估计其未知参数。本练习将引导您推导高斯-牛顿算法，这是一种在参数估计中广泛应用的强大优化方法 。深入理解其工作原理，对于有效应用该算法并解决实践中可能遇到的收敛性问题至关重要。",
            "id": "3935343",
            "problem": "考虑一个源于肌肉组织双室氧气输运模型参数估计的非线性反问题，其中在采样时间的测量静脉氧浓度由一个可微正向映射 $f:\\mathbb{R}^{p}\\to\\mathbb{R}^{m}$ 建模，该映射依赖于未知参数向量 $\\theta\\in\\mathbb{R}^{p}$。数据向量为 $y\\in\\mathbb{R}^{m}$，残差定义为 $r(\\theta)=y-f(\\theta)$。目标是一个非线性最小二乘准则 $\\phi(\\theta)=\\frac{1}{2}\\|r(\\theta)\\|_{2}^{2}$。\n\n仅从残差 $r(\\theta)$、目标函数 $\\phi(\\theta)$ 以及可微映射的一阶泰勒展开的定义出发，推导通过最小化当前迭代点 $\\theta^{(k)}$ 附近的线性化残差的范数而得到的更新方向。具体而言：\n\n1. 对 $r(\\theta)$ 在 $\\theta^{(k)}$ 处进行一阶泰勒展开，以雅可比矩阵 $J(\\theta^{(k)})\\in\\mathbb{R}^{m\\times p}$（即 $r$ 在 $\\theta^{(k)}$ 处的雅可比矩阵）和增量 $\\Delta\\theta$ 来表示 $r(\\theta^{(k)}+\\Delta\\theta)$ 的近似值。\n2. 建立由该近似产生的关于 $\\Delta\\theta$ 的线性化最小二乘问题，并推导此问题的正规方程组。\n3. 求解正规方程组，得到增量 $\\Delta\\theta^{(k)}$ 作为 $J(\\theta^{(k)})$ 和 $r(\\theta^{(k)})$ 函数的闭式表达式。\n4. 在适用于生物医学系统辨识的以下假设下，分析所得迭代方案在 $\\phi(\\theta)$ 的局部极小值点 $\\theta^{\\star}$ 邻域内的局部收敛性：$r$ 在 $\\theta^{\\star}$ 的一个凸邻域内二阶连续可微，雅可比矩阵 $J(\\theta)$ 在该邻域内利普希茨连续，且 $J(\\theta^{\\star})$ 列满秩。确定在 $r(\\theta^{\\star})=0$ 和 $r(\\theta^{\\star})\\neq 0$ 两种情况下的定性收敛速度，并分别说明收敛速度为二次和线性的条件。\n\n你的最终答案必须是第3部分中得到的增量 $\\Delta\\theta^{(k)}$ 的单一解析表达式。不需要进行数值计算，也不需要单位。最终答案中不要包含等号。如果你引入任何新的缩写，请在首次使用时写出全称（例如，近红外光谱（NIRS））。",
            "solution": "该问题要求推导一个非线性最小二乘问题的更新步，并分析所得算法的局部收敛性质。该问题是适定的，在生物医学系统辨识领域有科学依据，并且在数学上是一致的。我们开始推导。\n\n目标是最小化函数 $\\phi(\\theta) = \\frac{1}{2}\\|r(\\theta)\\|_{2}^{2}$，其中 $r(\\theta) = y - f(\\theta)$ 是残差向量。这里，$\\theta \\in \\mathbb{R}^{p}$ 是参数向量，$y \\in \\mathbb{R}^{m}$ 是数据向量，$f:\\mathbb{R}^{p} \\to \\mathbb{R}^{m}$ 是正向映射。我们寻求一种迭代方法来找到 $\\phi(\\theta)$ 的一个局部极小值。该方法通过相继求解问题的线性化版本来构建。设 $\\theta^{(k)}$ 是最优参数向量的当前估计值。我们寻找一个增量 $\\Delta\\theta$，使得 $\\theta^{(k+1)} = \\theta^{(k)} + \\Delta\\theta$ 是一个更好的估计。\n\n**1. 残差的一阶泰勒展开**\n\n残差函数 $r(\\theta)$ 是一个从 $\\mathbb{R}^{p}$ 到 $\\mathbb{R}^{m}$ 的可微映射。我们可以使用一阶泰勒展开来近似当前迭代点 $\\theta^{(k)}$ 附近的 $r(\\theta)$。对于一个小的增量 $\\Delta\\theta$，在新点 $\\theta^{(k)} + \\Delta\\theta$ 处的残差近似为：\n$$r(\\theta^{(k)} + \\Delta\\theta) \\approx r(\\theta^{(k)}) + J_r(\\theta^{(k)}) \\Delta\\theta$$\n其中 $J_r(\\theta^{(k)}) \\in \\mathbb{R}^{m \\times p}$ 是残差函数 $r$ 在 $\\theta^{(k)}$ 处求值的雅可比矩阵。问题描述中为此雅可比矩阵提供了符号 $J(\\theta^{(k)})$。该矩阵的元素由 $(J_r(\\theta))_{ij} = \\frac{\\partial r_i}{\\partial \\theta_j}$ 给出。\n由于 $r(\\theta) = y - f(\\theta)$ 且数据向量 $y$ 关于 $\\theta$ 是常数，因此 $r$ 的雅可比矩阵是 $f$ 的雅可比矩阵的负数：\n$$J(\\theta) \\equiv J_r(\\theta) = \\frac{\\partial r}{\\partial \\theta} = - \\frac{\\partial f}{\\partial \\theta}$$\n让我们记 $r_k = r(\\theta^{(k)})$ 和 $J_k = J(\\theta^{(k)})$。那么线性化残差为：\n$$\\tilde{r}(\\Delta\\theta) = r_k + J_k \\Delta\\theta$$\n\n**2. 线性化最小二乘问题与正规方程组**\n\n高斯-牛顿法（Gauss-Newton method）的核心思想是找到一个增量 $\\Delta\\theta$，使其最小化该线性化残差 $\\tilde{r}(\\Delta\\theta)$ 的范数的平方。这将原始的非线性最小二乘问题转化为一系列线性最小二乘问题。线性化问题的目标是：\n$$\\min_{\\Delta\\theta} \\frac{1}{2} \\|\\tilde{r}(\\Delta\\theta)\\|_2^2 = \\min_{\\Delta\\theta} \\frac{1}{2} \\|r_k + J_k \\Delta\\theta\\|_2^2$$\n设 $\\Psi(\\Delta\\theta) = \\frac{1}{2} \\|r_k + J_k \\Delta\\theta\\|_2^2$。我们可以展开范数的平方：\n$$\\Psi(\\Delta\\theta) = \\frac{1}{2} (r_k + J_k \\Delta\\theta)^T (r_k + J_k \\Delta\\theta)$$\n$$\\Psi(\\Delta\\theta) = \\frac{1}{2} (r_k^T r_k + r_k^T J_k \\Delta\\theta + (\\Delta\\theta)^T J_k^T r_k + (\\Delta\\theta)^T J_k^T J_k \\Delta\\theta)$$\n由于 $r_k^T J_k \\Delta\\theta$ 是一个标量，它等于其转置 $(\\Delta\\theta)^T J_k^T r_k$。因此，我们有：\n$$\\Psi(\\Delta\\theta) = \\frac{1}{2} (r_k^T r_k + 2 r_k^T J_k \\Delta\\theta + (\\Delta\\theta)^T J_k^T J_k \\Delta\\theta)$$\n这是关于 $\\Delta\\theta$ 的一个二次函数。为了找到最小值，我们将 $\\Psi(\\Delta\\theta)$ 对 $\\Delta\\theta$ 求导，并令梯度为零。使用标准的矩阵微积分法则：\n$$\\nabla_{\\Delta\\theta} \\Psi(\\Delta\\theta) = \\frac{1}{2} (0 + 2 J_k^T r_k + 2 J_k^T J_k \\Delta\\theta) = J_k^T r_k + J_k^T J_k \\Delta\\theta$$\n将梯度设为零，$\\nabla_{\\Delta\\theta} \\Psi(\\Delta\\theta) = 0$，得到线性最小二乘问题的**正规方程组**：\n$$J_k^T J_k \\Delta\\theta = -J_k^T r_k$$\n\n**3. 增量 $\\Delta\\theta^{(k)}$ 的解**\n\n正规方程组构成了关于 $\\Delta\\theta$ 的 $p$ 个未知分量的 $p$ 元线性方程组。矩阵 $J_k^T J_k$ 是一个 $p \\times p$ 的对称矩阵。如果该矩阵可逆，这当且仅当雅可比矩阵 $J_k$ 列满秩（秩为 $p$）时成立，我们可以通过左乘其逆矩阵来求解 $\\Delta\\theta$：\n$$(J_k^T J_k)^{-1} (J_k^T J_k) \\Delta\\theta = -(J_k^T J_k)^{-1} J_k^T r_k$$\n这给出了在第 $k$ 次迭代时更新方向 $\\Delta\\theta^{(k)}$ 的闭式表达式：\n$$\\Delta\\theta^{(k)} = -(J(\\theta^{(k)})^T J(\\theta^{(k)}))^{-1} J(\\theta^{(k)})^T r(\\theta^{(k)})$$\n\n**4. 局部收敛性分析**\n\n所得的迭代方案是高斯-牛顿算法：$\\theta^{(k+1)} = \\theta^{(k)} + \\Delta\\theta^{(k)}$。我们现在分析其在 $\\phi(\\theta)$ 的一个局部极小值点 $\\theta^{\\star}$ 邻域内的局部收敛性。$\\theta^{\\star}$ 是局部极小值点的一个必要条件是 $\\phi(\\theta)$ 的梯度在 $\\theta^{\\star}$ 处为零。$\\phi(\\theta) = \\frac{1}{2}r(\\theta)^T r(\\theta)$ 的梯度是 $\\nabla \\phi(\\theta) = J(\\theta)^T r(\\theta)$。因此，在解处有 $J(\\theta^{\\star})^T r(\\theta^{\\star}) = 0$。\n\n迭代方法的收敛速度取决于它与牛顿法（Newton's method）的关系。用于最小化 $\\phi(\\theta)$ 的牛顿法将使用更新 $\\Delta\\theta_N = -H_{\\phi}(\\theta)^{-1} \\nabla\\phi(\\theta)$，其中 $H_{\\phi}(\\theta)$ 是 $\\phi(\\theta)$ 的海森矩阵。该海森矩阵为：\n$$H_{\\phi}(\\theta) = \\frac{\\partial}{\\partial \\theta} (J(\\theta)^T r(\\theta)) = J(\\theta)^T J(\\theta) + \\sum_{i=1}^{m} r_i(\\theta) H_{r_i}(\\theta)$$\n其中 $r_i(\\theta)$ 是残差向量的第 $i$ 个分量，$H_{r_i}(\\theta)$ 是 $r_i(\\theta)$ 的海森矩阵。\n\n比较高斯-牛顿更新与牛顿更新，我们发现高斯-牛顿法通过项 $J(\\theta)^T J(\\theta)$ 来近似真实的海森矩阵 $H_{\\phi}(\\theta)$，忽略了涉及残差分量及其海森矩阵之和的第二项。此近似的有效性决定了收敛速度。假设是 $r$ 二阶连续可微，$J(\\theta)$ 利普希茨连续，且 $J(\\theta^\\star)$ 列满秩。$J(\\theta^\\star)$ 的满秩确保了 $J(\\theta^{\\star})^T J(\\theta^{\\star})$ 是正定的，并且根据连续性，对于足够接近 $\\theta^{\\star}$ 的 $\\theta^{(k)}$，$J(\\theta^{(k)})^T J(\\theta^{(k)})$ 是可逆的。\n\n**情况1：零残差问题 ($r(\\theta^{\\star}) = 0$)**\n如果模型能够完美拟合数据，那么在解处有 $r(\\theta^{\\star}) = 0$。在这种情况下，真实海森矩阵中的第二项在解处为零：\n$$H_{\\phi}(\\theta^{\\star}) = J(\\theta^{\\star})^T J(\\theta^{\\star}) + \\sum_{i=1}^{m} 0 \\cdot H_{r_i}(\\theta^{\\star}) = J(\\theta^{\\star})^T J(\\theta^{\\star})$$\n海森矩阵的高斯-牛顿近似在解处变得精确。对于接近 $\\theta^{\\star}$ 的 $\\theta^{(k)}$，$r(\\theta^{(k)})$ 将很小，因此被忽略的项 $\\sum r_i(\\theta^{(k)}) H_{r_i}(\\theta^{(k)})$ 也很小。高斯-牛顿法渐近地等同于牛顿法。在给定的假设下，牛顿法表现出局部**二次收敛**。也就是说，对于足够接近 $\\theta^{\\star}$ 的 $\\theta^{(k)}$，误差 $\\|\\theta^{(k+1)} - \\theta^{\\star}\\|$ 与 $\\|\\theta^{(k)} - \\theta^{\\star}\\|^2$ 成正比。\n\n**情况2：非零残差问题 ($r(\\theta^{\\star}) \\neq 0$)**\n在许多实际场景中，尤其是在处理含噪声的生物医学数据时，模型无法完美拟合数据，导致极小值点的残差非零，$r(\\theta^{\\star}) \\neq 0$。在这种情况下，海森矩阵中的第二项 $\\sum_{i=1}^{m} r_i(\\theta^{\\star}) H_{r_i}(\\theta^{\\star})$ 通常不为零。高斯-牛顿海森矩阵 $J(\\theta)^T J(\\theta)$ 即使在解处也是对真实海森矩阵 $H_{\\phi}(\\theta)$ 的一个不完全近似。该方法不再等同于牛顿法。可以证明，迭代映射 $g(\\theta) = \\theta + \\Delta\\theta(\\theta)$ 在不动点 $\\theta^{\\star}$ 处的雅可比矩阵非零。如果该雅可比矩阵的谱半径小于1（如果海森矩阵被忽略的部分与 $J(\\theta^{\\star})^T J(\\theta^{\\star})$ 相比不是太大，则该条件成立），迭代将会收敛。然而，由于迭代映射的雅可比矩阵非零，收敛是**线性**的。线性收敛的速度取决于残差 $r_i(\\theta^{\\star})$ 的大小和模型的非线性程度（由海森矩阵 $H_{r_i}$ 体现）。对于小残差或近似线性的模型，收敛速度可能很快。对于大残差和高度非线性的模型，收敛可能很慢或失败。",
            "answer": "$$\\boxed{-(J(\\theta^{(k)})^T J(\\theta^{(k)}))^{-1} J(\\theta^{(k)})^T r(\\theta^{(k)})}$$"
        },
        {
            "introduction": "建模工作流的最后一个关键步骤是模型验证，即检验所辨识的模型是否准确地描述了系统行为。本实践练习通过一个具体的编程任务，向您展示如何利用残差分析来诊断模型存在的设定误差 。通过检验模型的预测误差（残差）是否表现为随机白噪声，我们可以评估模型的优劣，或为模型的进一步改进指明方向。",
            "id": "3935335",
            "problem": "您将执行一项心血管残差时间序列分析任务，该任务在离散时间系统辨识的模型验证背景下进行。假设一个线性的、因果的、离散时间的模型被拟合到测量的心血管信号（例如，以毫米汞柱为单位的动脉压），并用 $e_t = y_t - \\hat{y}_t$ 表示残差序列，其中 $y_t$ 是测量输出，$\\hat{y}_t$ 是在离散时间 $t$ 的单步预测值。在线性系统的正确模型设定和标准假设下，残差应该是一个离散时间、宽平稳、零均值、具有恒定方差的独立白噪声过程的实现。您的任务是基于基本定义和推断性检验来实施残差诊断，以检测与此理想情况的偏差。\n\n从以下基本基础开始：\n- 残差序列 $e_t$ 定义为测量输出与模型预测之差，即 $e_t = y_t - \\hat{y}_t$。\n- 在模型设定正确的原假设下，残差构成一个零均值、独立同分布且方差恒定的序列。平稳性意味着自协方差 $\\gamma_k = \\mathbb{E}[(e_t - \\mu)(e_{t-k} - \\mu)]$ 仅取决于滞后 $k$，其中 $\\mu = \\mathbb{E}[e_t]$。\n- 自相关函数定义为 $\\rho_k = \\gamma_k/\\gamma_0$（滞后为 $k$），其中 $\\gamma_0$ 是方差。\n- Ljung–Box 综合统计量聚合了多个滞后的信息，以检验 $\\rho_1 = \\rho_2 = \\dots = \\rho_h = 0$ 的联合假设。\n\n实现一个程序，对测试套件中的每个残差时间序列执行以下操作：\n1. 使用基于 $e_t$ 的样本均值和样本方差的典型估计器，计算截至指定最大滞后 $h$ 的样本自相关函数。\n2. 在白噪声原假设的大样本 $\\chi^2$ 近似下，计算最大滞后 $h$ 处的 Ljung–Box 综合统计量及其相关的 $p$ 值。\n3. 结合两种诊断方法，判断残差是否表明模型设定错误：\n   - 基于 Ljung–Box $p$ 值与显著性水平 $\\alpha$ 进行比较的联合检验决策。\n   - 基于任何样本自相关幅值是否超过其从标准正态近似导出的大样本置信区间的边缘诊断。\n4. 对于每个测试用例，输出一个三元组，包括 Ljung–Box 统计量、相关的 $p$ 值和一个布尔检测决策，其中如果检测到模型设定错误，则布尔值为真，否则为假。所有报告值均为无量纲值。\n\n使用以下科学上合理、自洽的残差生成测试套件，该套件模拟了不同的心血管建模情境。在每种情况下，残差以毫米汞柱为单位指定，但诊断结果是无量纲的。设显著性水平为 $\\alpha = 0.05$，并将最大滞后定义为 $h = \\min(20, \\lfloor n/4 \\rfloor)$，其中 $n$ 是残差序列的样本量。对于近似的单滞后置信区间，使用双侧标准正态分位数 $z_{0.975}$。\n\n测试套件（每个案例提供生成残差所需的所有参数）：\n- 案例 1（设定良好，独立噪声）：$n = 512$，残差为均值为零、标准差为 $\\sigma = 5$ $\\mathrm{mmHg}$ 的独立高斯分布，随机种子 $12345$。\n- 案例 2（通过一阶自回归导致模型设定错误）：$n = 512$，残差遵循自回归过程 $e_t = \\phi e_{t-1} + \\epsilon_t$，其中 $\\phi = 0.6$，$\\epsilon_t$ 为均值为零、标准差为 $\\sigma = 5$ $\\mathrm{mmHg}$ 的独立高斯分布，随机种子 $54321$。\n- 案例 3（通过振荡分量导致模型设定错误，例如呼吸性窦性心律不齐）：$n = 500$，采样频率 $f_s = 10$ $\\mathrm{Hz}$，残差 $e_t = A \\sin(2\\pi f_0 t/f_s) + \\epsilon_t$，其中振幅 $A = 3$ $\\mathrm{mmHg}$，频率 $f_0 = 0.25$ $\\mathrm{Hz}$，$\\epsilon_t$ 为均值为零、标准差为 $\\sigma = 2$ $\\mathrm{mmHg}$ 的独立高斯分布，随机种子 $24680$。\n- 案例 4（小样本模型设定错误）：$n = 40$，自回归残差 $e_t = \\phi e_{t-1} + \\epsilon_t$，其中 $\\phi = 0.4$，$\\epsilon_t$ 为均值为零、标准差为 $\\sigma = 5$ $\\mathrm{mmHg}$ 的独立高斯分布，随机种子 $11111$。\n- 案例 5（临界弱相关）：$n = 200$，自回归残差 $e_t = \\phi e_{t-1} + \\epsilon_t$，其中 $\\phi = 0.2$，$\\epsilon_t$ 为均值为零、标准差为 $\\sigma = 5$ $\\mathrm{mmHg}$ 的独立高斯分布，随机种子 $22222$。\n\n对每个测试用例，计算：\n- 样本自相关序列 $\\{r_k\\}_{k=1}^h$。\n- 滞后 $h$ 处的 Ljung–Box 统计量及其在原假设下的 $p$ 值。\n- 一个检测决策，如果 Ljung–Box $p$ 值小于 $\\alpha$ 或任何 $|r_k|$ 超过近似的大样本界限 $z_{0.975}/\\sqrt{n}$，则为真，否则为假。\n\n您的程序应生成一行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个包含三个值的列表，顺序为 $[Q, p, decision]$。例如，输出格式必须类似于 $[[Q_1,p_1,\\mathrm{decision}_1],[Q_2,p_2,\\mathrm{decision}_2],\\dots]$，所有数值均以标准十进制表示法打印，布尔值则为 true 或 false。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于时间序列分析和系统辨识的原理，问题阐述清晰，提供了所有必要信息，并且没有歧义或矛盾。\n\n任务是对五个不同的时间序列进行残差诊断，以评估一个假设的基础模型是否存在设定错误。核心原则是，如果一个线性模型被正确设定，残差 $e_t = y_t - \\hat{y}_t$ 应构成一个零均值白噪声过程。与这种理想情况的偏差，例如显著的自相关，表明模型未能捕捉到系统的全部动态。我们将实施两种标准的统计检验来检测此类偏差：用于联合自相关的 Ljung–Box 综合检验和针对单个自相关系数的边缘检验。\n\n首先，我们按规定生成五个残差序列。对于每个长度为 $n$ 的序列，分析的最大滞后设置为 $h = \\min(20, \\lfloor n/4 \\rfloor)$。\n\n-   **案例 1（设定良好，独立噪声）**：$n=512$， $h=20$。残差 $e_t$ 是一个包含 512 个来自正态分布 $\\mathcal{N}(0, 5^2)$ 的独立同分布（i.i.d.）随机变量的序列。这代表了模型被正确设定的原假设（$H_0$）情景。\n-   **案例 2（通过自回归导致模型设定错误）**：$n=512$， $h=20$。残差遵循一阶自回归（AR(1)）过程 $e_t = 0.6 e_{t-1} + \\epsilon_t$，其中 $\\epsilon_t \\sim \\mathcal{N}(0, 5^2)$。非零系数 $\\phi=0.6$ 引入了序列相关性，这应被检测为模型设定错误。\n-   **案例 3（通过振荡分量导致模型设定错误）**：$n=500$， $h=20$。残差由 $e_t = 3 \\sin(2\\pi (0.25) t/10) + \\epsilon_t$ 生成，其中 $\\epsilon_t \\sim \\mathcal{N}(0, 2^2)$。这模拟了一个未建模的周期性分量，例如影响心血管信号的呼吸性窦性心律不齐，这将在自相关函数中表现为周期性模式。\n-   **案例 4（小样本模型设定错误）**：$n=40$， $h=10$。这是另一个 AR(1) 过程，$e_t = 0.4 e_{t-1} + \\epsilon_t$，但样本量非常小。此案例测试了在不理想的小样本条件下诊断方法的功效。\n-   **案例 5（临界弱相关）**：$n=200$， $h=20$。这个 AR(1) 案例，$e_t = 0.2 e_{t-1} + \\epsilon_t$，具有弱相关系数 $\\phi=0.2$。它测试了诊断方法对细微模型设定错误的敏感性。\n\n对于每个生成的序列 $\\{e_t\\}_{t=1}^n$，我们执行以下计算：\n\n1.  **样本自相关函数 (ACF)**：分析的基础是样本 ACF，表示为 $\\{r_k\\}$。它是真实自相关函数 $\\rho_k = \\mathrm{Corr}(e_t, e_{t-k})$ 的估计。计算过程如下：\n    -   计算样本均值：$\\bar{e} = \\frac{1}{n} \\sum_{t=1}^{n} e_t$。\n    -   计算滞后 $k$ 的样本自协方差：$\\hat{\\gamma}_k = \\frac{1}{n} \\sum_{t=k+1}^{n} (e_t - \\bar{e})(e_{t-k} - \\bar{e})$，对于 $k = 0, 1, \\dots, h$。$\\hat{\\gamma}_0$ 项是样本方差。\n    -   计算滞后 $k$ 的样本自相关：$r_k = \\frac{\\hat{\\gamma}_k}{\\hat{\\gamma}_0}$。\n\n2.  **边缘显著性检验**：在残差是白噪声的原假设下，对于滞后 $k>0$，样本自相关 $r_k$ 近似服从均值为 0、方差为 $1/n$ 的正态分布。因此，我们可以单独检验每个 $r_k$ 的显著性。在显著性水平 $\\alpha=0.05$ 下的双侧检验，如果 $|r_k|$ 超过一个临界值，则拒绝 $H_0$。该值源自标准正态分布分位数 $z_{1-\\alpha/2}$。对于 $\\alpha=0.05$，临界值为 $z_{0.975} \\approx 1.96$。如果对于任何 $k \\in \\{1, \\dots, h\\}$：\n    $$ |r_k| > \\frac{z_{0.975}}{\\sqrt{n}} $$\n    则标记为模型设定错误。\n\n3.  **Ljung–Box 综合检验**：该检验提供了对截至滞后 $h$ 的自相关的单一、联合评估。原假设是 $H_0: \\rho_1 = \\rho_2 = \\dots = \\rho_h = 0$。Ljung–Box 统计量 $Q$ 定义为：\n    $$ Q = n(n+2) \\sum_{k=1}^{h} \\frac{r_k^2}{n-k} $$\n    在 $H_0$ 下，$Q$ 近似服从自由度为 $h$ 的卡方分布，记作 $\\chi^2(h)$。$p$ 值是观察到至少与计算出的 $Q$ 一样极端的统计量的概率，即 $p = P(\\chi^2(h) \\geq Q)$。一个小的 $p$ 值（小于显著性水平 $\\alpha=0.05$）提供了反对原假设的证据，表明至少有一个 $\\rho_k$ 不为零。\n\n4.  **组合决策**：关于模型设定错误的最终决策是一个布尔值（`true`/`false`）。如果 Ljung-Box 检验显著或至少有一个单独的自相关系数显著，则检测到模型设定错误。也就是说，如果满足以下条件，决策为 `true`：\n    $$ (p\\text{-值}  0.05) \\quad \\lor \\quad (\\exists k \\in \\{1, \\dots, h\\} \\text{ s.t. } |r_k| > z_{0.975}/\\sqrt{n}) $$\n    否则，决策为 `false`。\n\n此程序被系统地应用于五个测试用例中的每一个，并报告最终的 Ljung-Box 统计量（$Q$）、其 $p$ 值和最终的布尔决策。该实现使用 `numpy` 进行数值运算和时间序列生成，使用 `scipy.stats` 访问计算 $p$ 值和临界值所需的 $\\chi^2$ 分布和正态分布的累积分布函数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef generate_residuals(case_params):\n    \"\"\"Generates a residual time series based on the specified case parameters.\"\"\"\n    n, case_type, params, seed = case_params\n    rng = np.random.default_rng(seed)\n\n    if case_type == 'iid_gaussian':\n        sigma = params['sigma']\n        e = rng.normal(loc=0.0, scale=sigma, size=n)\n    elif case_type == 'ar1':\n        phi, sigma = params['phi'], params['sigma']\n        epsilon = rng.normal(loc=0.0, scale=sigma, size=n)\n        e = np.zeros(n)\n        e[0] = epsilon[0]\n        for t in range(1, n):\n            e[t] = phi * e[t-1] + epsilon[t]\n    elif case_type == 'sinusoid':\n        A, f0, fs, sigma = params['A'], params['f0'], params['fs'], params['sigma']\n        t_vec = np.arange(n)\n        epsilon = rng.normal(loc=0.0, scale=sigma, size=n)\n        e = A * np.sin(2 * np.pi * f0 * t_vec / fs) + epsilon\n    \n    return e\n\ndef perform_residual_diagnostics(e, alpha=0.05):\n    \"\"\"\n    Performs residual diagnostics on a time series e.\n    Returns the Ljung-Box statistic, its p-value, and a boolean decision.\n    \"\"\"\n    n = len(e)\n    h = min(20, n // 4)\n\n    # Compute sample mean\n    mean_e = np.mean(e)\n\n    # Compute sample autocovariances and autocorrelations\n    # Use a direct, formula-based implementation for clarity\n    centered_e = e - mean_e\n    acov = np.zeros(h + 1)\n    for k in range(h + 1):\n        acov[k] = np.dot(centered_e[k:], centered_e[:n-k]) / n\n    \n    # Avoid division by zero if variance is zero (highly unlikely for these cases)\n    if acov[0] == 0:\n        return [np.nan, np.nan, True]\n\n    acorr = acov / acov[0]\n    r_k = acorr[1:] # We need r_1, ..., r_h\n\n    # --- Ljung-Box Test ---\n    k_vals = np.arange(1, h + 1)\n    lb_stat = n * (n + 2) * np.sum(r_k**2 / (n - k_vals))\n    \n    # p-value from chi-squared distribution with h degrees of freedom\n    p_value = stats.chi2.sf(lb_stat, h)\n    \n    decision_ljung_box = p_value  alpha\n\n    # --- Individual Lag Test ---\n    z_crit = stats.norm.ppf(1 - alpha / 2)\n    conf_bound = z_crit / np.sqrt(n)\n    decision_individual_lags = np.any(np.abs(r_k) > conf_bound)\n\n    # --- Combined Decision ---\n    final_decision = decision_ljung_box or decision_individual_lags\n    \n    return [lb_stat, p_value, final_decision]\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n, type, params, seed)\n        (512, 'iid_gaussian', {'sigma': 5.0}, 12345),\n        (512, 'ar1', {'phi': 0.6, 'sigma': 5.0}, 54321),\n        (500, 'sinusoid', {'A': 3.0, 'f0': 0.25, 'fs': 10.0, 'sigma': 2.0}, 24680),\n        (40, 'ar1', {'phi': 0.4, 'sigma': 5.0}, 11111),\n        (200, 'ar1', {'phi': 0.2, 'sigma': 5.0}, 22222)\n    ]\n\n    all_results = []\n    for case_params in test_cases:\n        residuals = generate_residuals(case_params)\n        result_triplet = perform_residual_diagnostics(residuals, alpha=0.05)\n        all_results.append(result_triplet)\n\n    # Format the output as specified in the problem statement\n    formatted_results = []\n    for res in all_results:\n        q_val_str = str(res[0])\n        p_val_str = str(res[1])\n        # The problem requires lowercase boolean strings 'true' or 'false'\n        decision_str = str(res[2]).lower()\n        formatted_results.append(f\"[{q_val_str},{p_val_str},{decision_str}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}