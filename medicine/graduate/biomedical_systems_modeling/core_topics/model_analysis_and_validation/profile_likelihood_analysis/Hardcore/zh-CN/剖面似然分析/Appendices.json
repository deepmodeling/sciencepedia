{
    "hands_on_practices": [
        {
            "introduction": "我们如何利用剖面似然来严格证明模型参数何时无法从现有数据中唯一确定？这是最基本的问题。本练习通过一个简单的指数衰减模型，引导读者从第一性原理出发，分析性地推导出剖面似然函数，从而揭示结构不可辨识性的本质，并找出唯一可辨识的参数组合 。这个练习为后续所有更复杂的分析奠定了概念基石。",
            "id": "3922495",
            "problem": "考虑一个标量常微分方程 (ODE) $\\dot{x}(t)=-k\\,x(t)$，它描述了房室模型中生物标志物浓度的衰减过程，其中未知参数为 $k>0$ 和 $x_0=x(0)$。假设在时间 $t>0$ 进行了一次单点测量，建模为 $y=x(t)+\\varepsilon$，其中 $\\varepsilon$ 是均值为零、方差为 $\\sigma^{2}$ 的高斯噪声，$y$ 是观测到的数据点。使用轮廓似然分析作为实用可辨识性的框架，按以下步骤进行：\n\n1. 从第一性原理（ODE的解和测量模型的高斯似然）出发，推导出对数似然函数 $\\ell(k,x_0\\mid y)$。\n2. 通过对 $\\ell(k,x_0\\mid y)$ 关于 $x_0$ 进行最大化，定义 $k$ 的轮廓对数似然，并分析其对 $k$ 的依赖性。解释为什么从单次观测中无法联合辨识 $k$ 和 $x_0$。\n3. 找出一个可从单次测量中辨识的重新参数化的形式（一个依赖于 $k$、$x_0$ 和 $t$ 的一维参数），并用这个重新参数化的形式重写似然函数，以证明其可辨识性。\n\n将最终答案表示为可辨识的、重新参数化后的参数关于 $k$、$x_0$ 和 $t$ 的显式闭式解析表达式。无需四舍五入，表达式中不应包含物理单位。",
            "solution": "首先将对问题陈述的科学性和结构完整性进行验证。\n\n### 第1步：提取已知条件\n- **控制方程**: 系统由标量常微分方程 (ODE) $\\dot{x}(t)=-k\\,x(t)$ 描述。\n- **参数**: 未知参数为速率常数 $k>0$ 和初始条件 $x_0=x(0)$。\n- **测量模型**: 在时间 $t>0$ 进行单次测量 $y$。该测量的模型为 $y=x(t)+\\varepsilon$。\n- **噪声模型**: 测量噪声 $\\varepsilon$ 是一个来自零均值高斯分布的随机变量，其方差为已知的 $\\sigma^2$，即 $\\varepsilon \\sim N(0, \\sigma^2)$。\n- **目标**: 使用轮廓似然分析来研究参数的可辨识性，并找到一个可辨识的重新参数化形式。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学基础**: 该问题描述了一个一级动力学衰减过程，这是药代动力学、化学反应工程和核物理等领域中一个基础且普遍存在的模型。假设加性高斯噪声的测量模型，是实验数据统计建模中一种标准且广为接受的方法。使用轮廓似然进行可辨识性分析是系统生物学及相关领域中一种严谨且标准的技术。这些前提在科学上和数学上都是合理的。\n2.  **适定性**: 该问题结构为一个引导式推导。它要求推导对数似然函数，使用轮廓似然进行可辨识性分析，并确定一个重新参数化的形式。这种结构能够根据给定数据，得出一个关于系统可辨识性的明确且有意义的结论。所有必要信息（$\\dot{x}(t)$, $x(0)$, $y$, 噪声特性）均已提供。\n3.  **客观性**: 问题陈述使用了精确、无歧义的数学和统计语言。没有主观或基于观点的条款。\n\n### 第3步：结论与行动\n该问题是有效的。它具有科学基础，是适定的，并且是客观的。它为展示参数估计中的实用和结构不可辨识性概念提供了一个标准场景。我现在将开始解答。\n\n### 第1部分：对数似然函数的推导\n第一步是求解该ODE，以找到状态变量 $x(t)$ 的显式表达式。该ODE为 $\\dot{x}(t) = -k\\,x(t)$，这是一个线性的、一阶的、齐次的、具有常系数的微分方程。可以通过分离变量法求解：\n$$ \\frac{dx}{x} = -k\\,dt $$\n两边积分得到：\n$$ \\int \\frac{1}{x}\\,dx = \\int -k\\,dt $$\n$$ \\ln|x| = -kt + C_1 $$\n其中 $C_1$ 是积分常数。对两边取指数得到：\n$$ |x(t)| = \\exp(-kt + C_1) = \\exp(C_1)\\exp(-kt) $$\n由于生物标志物浓度 $x(t)$ 通常是非负的，并且给定 $x_0 = x(0) > 0$ 和 $k>0$，对于所有 $t \\ge 0$，$x(t)$ 将保持正值。因此我们可以去掉绝对值。令 $A = \\exp(C_1)$。通解为：\n$$ x(t) = A\\exp(-kt) $$\n使用初始条件 $x(0) = x_0$，我们求出 $A$：\n$$ x(0) = A\\exp(-k \\cdot 0) = A \\implies A = x_0 $$\n因此，该ODE的解为：\n$$ x(t) = x_0\\exp(-kt) $$\n测量模型为 $y=x(t)+\\varepsilon$，其中 $\\varepsilon \\sim N(0, \\sigma^2)$。这意味着观测值 $y$ 是一个从高斯分布中抽取的随机变量，其均值为 $\\mu = x(t) = x_0\\exp(-kt)$，方差为 $\\sigma^2$。在参数 $k$ 和 $x_0$ 的条件下，$y$ 的概率密度函数 (PDF) 即为似然函数 $L(k, x_0 \\mid y)$：\n$$ L(k, x_0 \\mid y) = p(y \\mid k, x_0, \\sigma, t) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - x_0\\exp(-kt))^2}{2\\sigma^2}\\right) $$\n对数似然函数 $\\ell(k, x_0 \\mid y)$ 是似然函数的自然对数：\n$$ \\ell(k, x_0 \\mid y) = \\ln(L(k, x_0 \\mid y)) = \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right) - \\frac{(y - x_0\\exp(-kt))^2}{2\\sigma^2} $$\n$$ \\ell(k, x_0 \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - x_0\\exp(-kt))^2 $$\n这就是我们所求的、关于两个未知参数 $(k, x_0)$ 的对数似然函数。\n\n### 第2部分：轮廓对数似然与可辨识性分析\n参数 $k$ 的轮廓对数似然，记为 $\\ell_{\\text{prof}}(k \\mid y)$，其定义为：对于每个固定的 $k$ 值，将完整的对数似然函数对另一个参数 $x_0$ 进行最大化：\n$$ \\ell_{\\text{prof}}(k \\mid y) = \\max_{x_0} \\ell(k, x_0 \\mid y) = \\max_{x_0} \\left[ -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - x_0\\exp(-kt))^2 \\right] $$\n为了使该表达式关于 $x_0$ 最大化，我们必须最小化平方误差项 $(y - x_0\\exp(-kt))^2$。由于该项是一个非负的二次项，其最小值为0。当以下条件满足时，达到最小值：\n$$ y - x_0\\exp(-kt) = 0 $$\n求解 $x_0$ 得到在给定 $k$ 的情况下使似然最大化的 $x_0$ 值，我们将其记为 $\\hat{x}_0(k)$：\n$$ \\hat{x}_0(k) = y\\exp(kt) $$\n将这个 $x_0$ 的表达式代回到对数似然函数中，得到 $k$ 的轮廓对数似然：\n$$ \\ell_{\\text{prof}}(k \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - (y\\exp(kt))\\exp(-kt))^2 $$\n$$ \\ell_{\\text{prof}}(k \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - y)^2 = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) $$\n轮廓对数似然 $\\ell_{\\text{prof}}(k \\mid y)$ 是一个常数，完全不依赖于参数 $k$。一个平坦的轮廓似然表明数据没有提供任何信息来区分 $k$ 的不同可能值。只要 $x_0$ 根据关系式 $\\hat{x}_0(k) = y\\exp(kt)$ 进行选择，任何 $k>0$ 的值都是等可能的。这意味着不存在一个唯一的参数对 $(\\hat{k}, \\hat{x}_0)$ 来最大化似然函数。相反，在 $(k, x_0)$ 参数空间中，存在一整条由 $x_0\\exp(-kt) = y$ 定义的参数对曲线，沿着这条曲线，似然函数达到最大值且保持不变。这是结构不可辨识性的标志。参数 $k$ 和 $x_0$ 无法从单个数据点中被联合辨识。\n\n### 第3部分：可辨识的重新参数化\n不可辨识性的产生是因为两个参数 $k$ 和 $x_0$ 组合成了一个决定模型预测的单一量。数据仅约束了模型在特定测量时间 $t$ 的输出值，即 $x(t)$。\n让我们定义一个新的单一参数 $\\theta$，作为这个复合量：\n$$ \\theta = x(t) = x_0\\exp(-kt) $$\n这个新参数 $\\theta$ 是原始参数 $k$ 和 $x_0$ 以及已知实验时间 $t$ 的函数。我们可以将模型预测简单地重写为 $\\theta$。\n现在，对数似然函数可以表示为这个单一参数 $\\theta$ 的形式：\n$$ \\ell(\\theta \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(y - \\theta)^2}{2\\sigma^2} $$\n这是从单个样本 $y$ 估计高斯分布均值 $\\theta$ 的对数似然函数。该函数是关于 $\\theta$ 的一个开口向下的抛物线，具有唯一的最大值。通过将关于 $\\theta$ 的导数设为零，可以找到最大似然估计值 $\\hat{\\theta}$：\n$$ \\frac{d\\ell}{d\\theta} = -\\frac{2(y-\\theta)(-1)}{2\\sigma^2} = \\frac{y-\\theta}{\\sigma^2} = 0 \\implies \\hat{\\theta} = y $$\n由于关于 $\\theta$ 的对数似然函数有一个明确定义的唯一最大值，因此参数 $\\theta$ 是可辨识的。数据 $y$ 允许我们估计 $\\theta$。虽然我们无法解开 $k$ 和 $x_0$ 的各自的值，但我们可以唯一地确定组合 $\\theta = x_0\\exp(-kt)$ 的值。\n因此，可辨识的重新参数化后的参数是 $\\theta$，其用原始参数和时间表示的表达式为 $x_0\\exp(-kt)$。",
            "answer": "$$\\boxed{x_0 \\exp(-kt)}$$"
        },
        {
            "introduction": "在理解了不可辨识性的基本概念之后，本练习将探讨统计学视角（似然函数曲面）与系统论视角（灵敏度分析）之间更深层次的联系。通过分析一个两个参数不可辨识的简单药代动力学模型，我们将展示参数空间中高似然度的“山脊”如何直接对应于模型灵敏度矩阵的零空间 。这个实践突显了剖面似然如何为参数间的相互依赖性提供一种直观的几何解释。",
            "id": "3922503",
            "problem": "考虑一个药代动力学线性房室模型，其中一个被测量的房室有两个独立的一级消除途径：一个是以速率常数 $k_{10}$ 进行的消除途径，另一个是以速率常数 $k_{12}$ 通向一个未测量分布途径的途径。被测量房室的状态 $x(t)$ 遵循常微分方程 (ODE) $dx/dt = -(k_{10}+k_{12}) x(t)$，其已知初始条件为 $x(0) = x_0 > 0$。在采样时间 $t_i$（$i = 1,\\dots,n$）的测量值由 $y_i = x(t_i) + \\epsilon_i$ 给出，其中测量误差 $\\epsilon_i$ 是独立同分布的高斯随机变量，均值为零，已知方差为 $\\sigma^2$。假设 $x_0$ 和 $\\sigma$ 是已知常数。参数向量为 $\\theta = (k_{10},k_{12})$，其两个分量均为非负。因此，模型输出 $x(t)$ 由和 $k_{10}+k_{12}$ 决定。\n\n使用高斯测量噪声下的似然和剖面似然（定义为在关注参数受约束条件下的最大化似然）的基本定义，以及灵敏度矩阵（模型输出相对于参数的雅可比矩阵）的定义，分析在固定常数 $c \\ge 0$ 的约束条件 $k_{10}+k_{12} = c$ 下 $(k_{10},k_{12})$ 的联合剖面结构，并将该脊及其几何形状与灵敏度矩阵的零空间联系起来。基于此分析，以下哪个陈述是正确的？\n\nA. 对于任何固定的 $c$，在约束 $k_{10}+k_{12}=c$ 下，$(k_{10},k_{12})$ 的联合剖面等于净速率为 $c$ 的单参数模型的似然，对于直线 $k_{10}+k_{12}=c$ 上的所有 $(k_{10},k_{12})$ 来说是恒定的，并且灵敏度矩阵的零空间是 $(1,-1)$ 的生成空间，该空间与该直线相切。\n\nB. 由于对称性，联合剖面在 $k_{10}=k_{12}=c/2$ 处达到唯一最大值，并且由于两个参数都影响输出，灵敏度矩阵的零空间是平凡的。\n\nC. 因为只有和 $k_{10}+k_{12}$ 有影响，所以联合剖面对所有 $c$ 都是恒定的，并且灵敏度矩阵的零空间是 $(1,1)$ 的生成空间。\n\nD. 脊 $k_{10}+k_{12}=c$ 在参数空间中是弯曲的，灵敏度矩阵的零空间对应于该脊的法向量 $(1,1)$。",
            "solution": "用户希望我根据一套严格的规则来验证问题陈述，如果有效，则解决它。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **系统：**一个药代动力学线性房室模型。\n*   **状态方程：**单个被测量房室的状态 $x(t)$ 遵循常微分方程 (ODE) $dx/dt = -(k_{10}+k_{12}) x(t)$。\n*   **初始条件：**$x(0) = x_0 > 0$，其中 $x_0$ 是一个已知常数。\n*   **参数：**参数向量为 $\\theta = (k_{10}, k_{12})$，其中 $k_{10} \\ge 0$ 是一级消除速率常数，而 $k_{12} \\ge 0$ 是一级分布速率常数。\n*   **测量模型：**在采样时间 $t_i$（$i = 1,\\dots,n$）的测量值由 $y_i = x(t_i) + \\epsilon_i$ 给出。\n*   **测量误差：**误差 $\\epsilon_i$ 是独立同分布 (i.i.d.) 的高斯随机变量，均值为 $0$，已知方差为 $\\sigma^2$。常数 $\\sigma$ 是已知的。\n*   **核心依赖关系：**模型输出 $x(t)$ 由和 $k_{10}+k_{12}$ 决定。\n*   **分析任务：**在固定常数 $c \\ge 0$ 的约束条件 $k_{10}+k_{12} = c$ 下，分析 $(k_{10},k_{12})$ 的联合剖面结构。将该脊及其几何形状与灵敏度矩阵的零空间联系起来。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据：**该问题描述了一个带有多条平行一级消除途径的标准单房室模型。这是药代动力学和系统生物学中一个基础且广泛使用的模型。该 ODE 具有物理意义，测量噪声的统计模型也是标准的。该设置在科学上是合理的。\n2.  **适定性：**该 ODE 及其初始条件构成了一个适定的初值问题。问题要求使用标准工具（似然、灵敏度分析）来分析模型的结构特性（可辨识性），这是系统建模中一个明确定义的任务。该问题并非要求找到 $\\theta$ 的唯一估计值，而是要描述为何无法找到。\n3.  **客观性：**该问题以精确、客观的数学和科学语言陈述。它没有歧义和主观论断。\n4.  **完整性与一致性：**所有必要的组成部分都已提供：动态模型、测量模型、统计假设以及参数和变量的定义。内部没有矛盾。\n5.  **合理性：**该模型是对生物现实的简化，但是一个用于教学和分析的标准、合理且计算上易于处理的表示方法。\n\n**步骤 3：结论与行动**\n\n问题陈述是有效的。这是一个关于经典系统生物学模型中结构不可辨识性的适定问题。我现在将进行求解推导。\n\n### 求解推导\n\n**1. 模型解**\n该问题由线性常微分方程描述：\n$$ \\frac{dx}{dt} = -(k_{10}+k_{12}) x(t) $$\n初始条件为 $x(0) = x_0$。这是一个可分离的一阶 ODE。令 $k_{sum} = k_{10}+k_{12}$。方程变为 $dx/dt = -k_{sum} x$。解为：\n$$ x(t) = x(0) e^{-k_{sum} t} = x_0 e^{-(k_{10}+k_{12})t} $$\n正如问题中所正确陈述的，在任何时间 $t$，模型输出 $x(t)$ 仅通过其和 $k_{sum} = k_{10}+k_{12}$ 依赖于参数 $k_{10}$ 和 $k_{12}$。这是一个经典的结构不可辨识性案例：仅从 $x(t)$ 的测量值中，不可能唯一确定 $k_{10}$ 和 $k_{12}$ 的各自值。\n\n**2. 似然函数分析**\n测量值为 $y_i = x(t_i) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。给定参数向量 $\\theta = (k_{10}, k_{12})$，观测到数据向量 $Y = (y_1, \\dots, y_n)$ 的似然为：\n$$ L(\\theta|Y) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - x(t_i; \\theta))^2}{2\\sigma^2}\\right) $$\n最大化此似然等价于最小化残差平方和（或成本函数）$J(\\theta)$：\n$$ J(\\theta) = \\sum_{i=1}^n (y_i - x(t_i; \\theta))^2 = \\sum_{i=1}^n (y_i - x_0 e^{-(k_{10}+k_{12})t_i})^2 $$\n由于成本函数 $J(\\theta)$ 仅依赖于和 $k_{sum} = k_{10}+k_{12}$，因此似然函数 $L(\\theta|Y)$ 也仅依赖于此和。\n\n现在，考虑对于某个固定常数 $c \\ge 0$ 的约束条件 $k_{10}+k_{12} = c$。对于参数空间中位于这条直线上的任何参数对 $(k_{10}, k_{12})$，其和总是 $c$。因此，对于所有这样的参数对，模型输出 $x(t_i) = x_0 e^{-c t_i}$ 的值是相同的。因此，对于所有满足 $k_{10}+k_{12}=c$ 的 $(k_{10}, k_{12})$，似然函数 $L(k_{10}, k_{12}|Y)$ 的值是恒定的。这个恒定值恰好是在 $k_{sum}=c$ 处评估的、具有单个参数 $k_{sum}$ 的重参数化模型的似然。\n\n**3. 灵敏度矩阵分析**\n灵敏度矩阵 $S$ 是模型输出向量关于参数向量的雅可比矩阵。模型输出为 $(x(t_1), \\dots, x(t_n))$。参数为 $\\theta = (k_{10}, k_{12})^T$。灵敏度矩阵的元素为 $S_{ij} = \\frac{\\partial x(t_i)}{\\partial \\theta_j}$。\n\n偏导数为：\n$$ \\frac{\\partial x(t)}{\\partial k_{10}} = \\frac{\\partial}{\\partial k_{10}} \\left( x_0 e^{-(k_{10}+k_{12})t} \\right) = -t x_0 e^{-(k_{10}+k_{12})t} = -t x(t) $$\n$$ \\frac{\\partial x(t)}{\\partial k_{12}} = \\frac{\\partial}{\\partial k_{12}} \\left( x_0 e^{-(k_{10}+k_{12})t} \\right) = -t x_0 e^{-(k_{10}+k_{12})t} = -t x(t) $$\n这两个导数是相同的。灵敏度矩阵 $S$ 的维度是 $n \\times 2$，其两列是相同的：\n$$ S = \\begin{pmatrix}\n-t_1 x(t_1)  -t_1 x(t_1) \\\\\n-t_2 x(t_2)  -t_2 x(t_2) \\\\\n\\vdots  \\vdots \\\\\n-t_n x(t_n)  -t_n x(t_n)\n\\end{pmatrix} $$\n$S$ 的列是线性相关的，这证实了结构的不可辨识性。\n\n**4. 灵敏度矩阵的零空间**\n$S$ 的零空间由所有满足 $Sv=0$ 的向量 $v = (v_1, v_2)^T$ 组成。设 $S$ 的第一列用向量 $s_1$ 表示。则 $S = [s_1, s_1]$。\n$$ Sv = s_1 v_1 + s_1 v_2 = s_1 (v_1 + v_2) $$\n对于 $Sv = 0$，我们必须有 $v_1 + v_2 = 0$，假设 $s_1$ 不是零向量（这要求至少有一个 $t_i \\neq 0$）。这意味着 $v_1 = -v_2$。零空间中的任何向量都必须是 $(k, -k)^T$ 的形式，其中 $k$ 是某个标量。因此，零空间是由向量 $(1, -1)^T$ 生成的一维子空间：\n$$ \\text{Null}(S) = \\text{span}\\left\\{ \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\right\\} $$\n\n**5. 几何解释**\n等似然脊是由 $k_{10}+k_{12}=c$ 定义的直线。这样一条直线的方向向量可以通过考虑沿该直线的位移来找到，例如从点 $(k_{10}, k_{12})$ 到 $(k_{10}+\\delta, k_{12}-\\delta)$。因此，方向向量与 $(1, -1)$ 成比例。\n因此，来自灵敏度矩阵零空间的向量 $(1,-1)^T$ 是等似然线的切向量。这是一个基本结果：灵敏度矩阵的零空间定义了参数空间中的方向，沿着这些方向，模型输出对参数变化是局部不敏感的。在这个线性模型中，这种不敏感性不仅是局部的，而且是全局的。\n\n### 逐项分析\n\n**A. 对于任何固定的 c，在约束 k10+k12=c 下，(k10,k12) 的联合剖面等于净速率为 c 的单参数模型的似然，对于直线 k10+k12=c 上的所有 (k10,k12) 来说是恒定的，并且灵敏度矩阵的零空间是 (1,-1) 的生成空间，该空间与该直线相切。**\n此陈述包含四个论断：\n1.  在约束 $k_{10}+k_{12}=c$ 下的似然等于速率为 $c$ 的单参数模型的似然。如第 2 节所示，这是正确的。\n2.  似然在直线 $k_{10}+k_{12}=c$ 上是恒定的。如第 2 节所示，这是正确的。\n3.  灵敏度矩阵的零空间是 $(1, -1)$ 的生成空间。如第 4 节推导，这是正确的。\n4.  向量 $(1, -1)$ 与直线 $k_{10}+k_{12}=c$ 相切。如第 5 节所示，这是正确的。\n所有论断都是正确的。\n**结论：正确。**\n\n**B. 由于对称性，联合剖面在 k10=k12=c/2 处达到唯一最大值，并且灵敏度矩阵的零空间是平凡的，因为两个参数都影响输出。**\n似然函数沿着直线 $k_{10}+k_{12}=c$ (对于 $k_{10}, k_{12} \\ge 0$) 是恒定的，所以在这条直线上没有唯一最大值。如第 4 节所示，灵敏度矩阵的零空间是非平凡的。\n**结论：不正确。**\n\n**C. 联合剖面对所有 c 都是恒定的，因为只有和 k10+k12 有影响，并且灵敏度矩阵的零空间是 (1,1) 的生成空间。**\n似然对于*固定*的 $c$ 是恒定的，但它随 $c$ 的变化而变化。会存在一个使似然最大化的最优 $c$ 值。零空间由 $(1, -1)$ 生成，而不是 $(1, 1)$。向量 $(1, 1)$ 与等似然线垂直。\n**结论：不正确。**\n\n**D. 脊 k10+k12=c 在参数空间中是弯曲的，灵敏度矩阵的零空间对应于该脊的法向量 (1,1)。**\n方程 $k_{10}+k_{12}=c$ 在 $(k_{10}, k_{12})$ 参数空间中定义了一条直线，而不是一条曲线。零空间向量 $(1,-1)$ 与这条直线相切，而不是垂直于它。法向量是 $(1, 1)$。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "从解析示例转向真实世界的挑战，最后一个练习将为一个复杂的非线性系统生物学模型——基因拨动开关——勾勒出计算剖面似然的完整工作流程。本问题探讨了该过程的实际操作细节，从寻找初始的最大似然估计，到实现一个能够处理参数约束和潜在收敛问题的稳健迭代优化过程 。它为将剖面似然分析应用于前沿研究问题提供了实用的操作指南。",
            "id": "3922540",
            "problem": "考虑一个由以下常微分方程组 (ODE) 控制的、具有状态变量 $x_{1}(t)$ 和 $x_{2}(t)$ 的双蛋白基因开关模型：\n$$\n\\frac{d x_{1}}{d t} = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{2}}\\right)^{n_{2}}} - \\beta_{1} x_{1}, \\qquad\n\\frac{d x_{2}}{d t} = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{1}}\\right)^{n_{1}}} - \\beta_{2} x_{2},\n$$\n其参数向量为 $\\theta = (\\alpha_{1}, \\alpha_{2}, \\beta_{1}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$，其中所有速率和亲和参数均为正实数，Hill系数 $n_{1}$ 和 $n_{2}$ 也为正实数。假设在时间点 $t_{i}$ 观测到 $x_{j}(t)$ 的测量值 $y_{i,j}$（$j \\in \\{1,2\\}$），其服从加性高斯测量噪声模型：\n$$\ny_{i,j} = x_{j}(t_{i}; \\theta) + \\varepsilon_{i,j}, \\quad \\varepsilon_{i,j} \\sim \\mathcal{N}(0, \\sigma_{j}^{2}) \\text{ 在 } i \\text{ 和 } j \\text{ 上独立同分布},\n$$\n其中方差 $\\sigma_{j}^{2} > 0$ 已知。似然函数 $L(\\theta)$ 由高斯测量模型得出，负对数似然与加权残差平方和成正比。\n\n将感兴趣的参数 $\\psi = \\beta_{1}$ 的剖面似然定义为\n$$\nL_{p}(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda),\n$$\n其中 $\\lambda$ 汇集了讨厌参数 $\\lambda = (\\alpha_{1}, \\alpha_{2}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$。目标是使用基于ODE模型评估的数值优化方法，在一系列 $\\psi$ 值上计算 $L_{p}(\\psi)$。\n\n从基于高斯噪声的似然推断基础出发，哪个选项正确地概述了一个科学上合理且实践中稳健的程序，用于计算 $\\psi = \\beta_{1}$ 的剖面似然，该程序包括初始化、在每个 $\\psi$ 值下的优化以及对不收敛情况的处理？\n\nA. 通过在 $\\theta$ 上最小化负对数似然来初始化，计算无约束最大似然估计 (MLE) $\\hat{\\theta}$，此过程需要精确的ODE求解和经过验证的收敛性（例如，梯度范数小且满足 Karush–Kuhn–Tucker (KKT) 条件）。为 $\\psi = \\beta_{1}$ 选择一个网格 $\\{\\psi_{k}\\}$，其范围应在生物学上合理，可根据 $\\hat{\\theta}$ 和先验知识推断得出（例如，保证正值的边界）。对于每个 $\\psi_{k}$，通过在变换空间中进行操作（例如，对 $\\log \\alpha_{1}, \\log \\alpha_{2}, \\log \\beta_{2}, \\log K_{1}, \\log K_{2}, \\log n_{1}, \\log n_{2}$ 进行优化以强制保证正值）并使用前一个 $\\psi_{k-1}$ 的解作为热启动（路径延拓），来求解满足正值约束的约束优化问题 $ \\min_{\\lambda} \\; -\\log L(\\psi_{k}, \\lambda) $。在每一步中，确保ODE解的数值稳健性（使用自适应容差，必要时使用刚性求解器），通过KKT条件验证收敛性，并记录 $L_{p}(\\psi_{k})$。如果出现不收敛（例如，积分失败或优化器停滞），则升级策略，采用多起点方法（例如，拉丁超立方采样）、切换算法（例如，切换到信赖域或序列二次规划方法）、调整容差，并拒绝不可行解；在所有起点中选择最佳解。在整个网格上计算完 $L_{p}(\\psi_{k})$ 后，可以选择性地在 $L_{p}$ 表现出急剧变化的区域细化网格，并使用似然比渐近理论来解释 $\\psi$ 的置信集。\n\nB. 直接从 $L(\\psi, \\lambda)$ 中积分掉讨厌参数 $\\lambda$，以获得高斯噪声下的闭式边际似然 $L(\\psi)$，因为高斯积分总能得到解析表达式。在任意 $\\psi$ 处初始化，对每个 $\\psi$ 解析地计算 $L(\\psi)$ 而无需数值优化，如果积分发散，则舍弃该 $\\psi$ 值。\n\nC. 计算一次 $\\hat{\\theta}$。对于每个 $\\psi_{k}$，将所有讨厌参数固定在 $\\hat{\\theta}$ 中相应的分量上（即不重新优化），并直接评估 $L(\\psi_{k}, \\hat{\\lambda})$。如果似然函数在 $\\psi$ 上表现出非光滑性，则通过样条拟合对其进行平滑处理。如果在某个 $\\psi_{k}$ 处发生ODE积分失败，则跳过这些点，并从相邻点进行插值。\n\nD. 对 $\\theta$ 设置高斯先验，并使用马尔可夫链蒙特卡洛 (MCMC) 方法从后验分布中采样。通过MCMC样本估计的 $\\psi$ 的边际后验来近似剖面似然 $L_{p}(\\psi)$。通过从先验分布中抽样来进行初始化；如果链不收敛，则更积极地对样本进行稀疏化处理。\n\nE. 对于每个 $\\psi_{k}$，围绕 $\\hat{\\theta}$ 线性化ODE模型，以获得输出对参数的线性回归，然后以闭式形式计算 $\\lambda$ 的最小二乘解。用 $\\hat{\\theta}$ 初始化，如果线性化产生负参数，则将它们投影到正象限。如果出现不收敛，则减小 $\\psi$ 的步长，直到线性最小二乘残差单调递减。",
            "solution": "用户要求对问题陈述进行批判性验证，然后详细推导解决方案，并评估所有提供的选项。\n\n### 问题验证\n\n**第一步：提取已知条件**\n\n-   **模型：** 一个由两个常微分方程(ODE)组成的系统描述的基因开关模型：\n    $$\n    \\frac{d x_{1}}{d t} = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{2}}\\right)^{n_{2}}} - \\beta_{1} x_{1}\n    $$\n    $$\n    \\frac{d x_{2}}{d t} = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{1}}\\right)^{n_{1}}} - \\beta_{2} x_{2}\n    $$\n-   **状态变量：** $x_{1}(t)$，$x_{2}(t)$ 代表蛋白质浓度。\n-   **参数向量：** $\\theta = (\\alpha_{1}, \\alpha_{2}, \\beta_{1}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$。\n-   **参数约束：** 所有参数均为正实数。\n-   **数据模型：** 观测值 $y_{i,j}$ 由 $y_{i,j} = x_{j}(t_{i}; \\theta) + \\varepsilon_{i,j}$ 给出。\n-   **噪声模型：** 测量误差 $\\varepsilon_{i,j}$ 独立同分布，服从高斯分布 $\\mathcal{N}(0, \\sigma_{j}^{2})$。\n-   **已知量：** 测量误差方差 $\\sigma_{j}^{2}$ 已知且为正。\n-   **统计框架：** 基于似然的推断，其中负对数似然与加权残差平方和成正比。\n-   **感兴趣的参数：** $\\psi = \\beta_{1}$。\n-   **讨厌参数：** $\\lambda = (\\alpha_{1}, \\alpha_{2}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$。\n-   **剖面似然定义：** $L_{p}(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda)$。\n-   **目标：** 确定计算 $L_{p}(\\psi)$ 的科学且实用的正确程序。\n\n**第二步：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题具有科学依据。基因开关是系统生物学中的一个典型模型，其通过耦合ODE进行的数学表述是标准的。加性高斯噪声的假设是许多生物学背景下测量误差的常见且适当的模型。剖面似然分析是一种成熟且功能强大的频率派统计方法，用于此类模型中的参数可辨识性分析和置信区间估计。问题设置完全符合生物医学系统建模的标准实践。\n-   **适定性：** 该问题是适定的。它要求描述一个计算过程，以计算一个定义明确的数学量，即剖面似然函数。函数 $L_p(\\psi)$ 是通过上确界算子定义的，并且存在一个计算或近似它的程序是一个有效的问题。尽管在数值上具有挑战性，但该计算是一项明确定义的任务。\n-   **客观性：** 该问题使用精确的数学和统计术语进行了客观陈述。像“科学上合理且实践中稳健”这样的短语指的是数值分析和统计计算中已建立的最佳实践，而非主观偏好。\n\n**第三步：结论与行动**\n\n问题陈述是有效的。它科学合理、适定且客观。它提出了一个关于系统生物学中计算方法学的相关且非平凡的问题。因此，将推导一个完整的解决方案。\n\n### 解决方案推导\n\n目标是计算 $\\psi = \\beta_{1}$ 的剖面似然，其定义为 $L_{p}(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda)$。在实践中，处理负对数似然更方便且数值上更稳定。负对数似然函数，在忽略常数项的情况下，由加权平方和目标函数给出：\n$$\nJ(\\theta) = -\\log L(\\theta) \\propto \\frac{1}{2} \\sum_{j=1}^{2} \\frac{1}{\\sigma_j^2} \\sum_{i} (y_{i,j} - x_{j}(t_{i}; \\theta))^2\n$$\n那么，$\\psi$ 的剖面负对数似然定义为：\n$$\n\\text{pl}(\\psi) = \\inf_{\\lambda} J(\\psi, \\lambda)\n$$\n计算在一系列 $\\psi$ 值上的函数 $\\text{pl}(\\psi)$ 涉及求解一系列约束优化问题。一个稳健且科学合理的程序包括几个关键阶段：\n\n1.  **全局优化 (MLE)：** 第一步是找到负对数似然在整个参数空间 $\\theta$ 上的全局最小值。这会得到最大似然估计 (MLE) $\\hat{\\theta} = (\\hat{\\psi}, \\hat{\\lambda})$。\n    $$\n    \\hat{\\theta} = \\arg\\min_{\\theta} J(\\theta)\n    $$\n    由于ODE的非线性性质，这是一个非凸优化问题。因此，需要一个全局搜索策略（例如，多起点局部优化、模拟退火、进化算法），然后进行精确的局部优化（例如，信赖域、Levenberg-Marquardt）。局部搜索的收敛性必须经过严格验证（例如，检查约束优化的 Karush-Kuhn–Tucker (KKT) 条件，或无约束优化的小梯度范数）。\n\n2.  **网格定义:** 为感兴趣的参数定义一个值的网格 $\\{\\psi_k\\}$。该网格应以MLE $\\hat{\\psi}$ 为中心，并向两个方向扩展，以覆盖用于构建置信区间的感兴趣区域。\n\n3.  **迭代约束优化:** 对于网格上的每个 $\\psi_k$，固定感兴趣的参数 $\\psi = \\psi_k$，并关于讨厌参数 $\\lambda$ 最小化负对数似然。\n    $$\n    \\hat{\\lambda}(\\psi_k) = \\arg\\min_{\\lambda} J(\\psi_k, \\lambda)\n    $$\n    约束条件是 $\\lambda$ 中的所有参数都为正。该优化的结果给出了剖面负对数似然曲线上的一个点：$\\text{pl}(\\psi_k) = J(\\psi_k, \\hat{\\lambda}(\\psi_k))$。\n\n4.  **实践实现细节：**\n    -   **约束处理：** 参数的正值约束至关重要。一种标准、稳健的方法是在变换空间中执行优化，例如，通过对参数的对数进行优化。如果 $\\lambda_j$ 是 $\\lambda$ 中的一个参数，我们定义 $\\eta_j = \\log(\\lambda_j)$ 并对无约束变量 $\\eta_j$ 进行优化。\n    -   **热启动（路径延拓）：** 对于给定的 $\\psi_k$ 的优化，可以用为前一个网格点找到的最优讨厌参数 $\\hat{\\lambda}(\\psi_{k-1})$ 来初始化。这种“热启动”显著提高了计算效率和成功率，因为 $\\hat{\\lambda}(\\psi)$ 通常是 $\\psi$ 的一个连续函数。\n    -   **数值稳健性：** 目标函数 $J(\\theta)$ 的每次评估都需要数值求解ODE系统。这必须使用稳健的求解器来完成，例如专为刚性系统设计的求解器（如 `LSODA`、`radau`），并使用适当的自适应误差容差。\n    -   **处理不收敛：** 在给定 $\\psi_k$ 处的优化可能会失败。一个稳健的流程必须处理这些失败。这包括尝试多个优化起点（多起点）、切换到不同的优化算法，或调整求解器/优化器的容差。如果在详尽尝试后仍找不到解，该点可能会被标记为不可行或具有非常高的似然成本。对于给定的 $\\psi_k$，保留所有尝试中找到的最佳值。\n\n5.  **解释:** 计算完剖面后，使用似然比检验确定置信区间。$\\psi$ 的 $(1-\\alpha)$ 置信集由所有满足以下条件的 $\\psi$ 值给出：\n    $$\n    2(\\text{pl}(\\psi) - J(\\hat{\\theta})) \\le \\chi^2_{1, 1-\\alpha}\n    $$\n    其中 $\\chi^2_{1, 1-\\alpha}$ 是自由度为1的卡方分布的 $(1-\\alpha)$-分位数。\n\n这种全面的方法确保了结果的准确性、稳健性和正确解释。\n\n### 逐项分析选项\n\n**A. 通过在 $\\theta$ 上最小化负对数似然来初始化，计算无约束最大似然估计 (MLE) $\\hat{\\theta}$，此过程需要精确的ODE求解和经过验证的收敛性（例如，梯度范数小且满足 Karush–Kuhn–Tucker (KKT) 条件）。为 $\\psi = \\beta_{1}$ 选择一个网格 $\\{\\psi_{k}\\}$，其范围应在生物学上合理，可根据 $\\hat{\\theta}$ 和先验知识推断得出（例如，保证正值的边界）。对于每个 $\\psi_{k}$，通过在变换空间中进行操作（例如，对 $\\log \\alpha_{1}, \\log \\alpha_{2}, \\log \\beta_{2}, \\log K_{1}, \\log K_{2}, \\log n_{1}, \\log n_{2}$ 进行优化以强制保证正值）并使用前一个 $\\psi_{k-1}$ 的解作为热启动（路径延拓），来求解满足正值约束的约束优化问题 $ \\min_{\\lambda} \\; -\\log L(\\psi_{k}, \\lambda) $。在每一步中，确保ODE解的数值稳健性（使用自适应容差，必要时使用刚性求解器），通过KKT条件验证收敛性，并记录 $L_{p}(\\psi_{k})$。如果出现不收敛（例如，积分失败或优化器停滞），则升级策略，采用多起点方法（例如，拉丁超立方采样）、切换算法（例如，切换到信赖域或序列二次规划方法）、调整容差，并拒绝不可行解；在所有起点中选择最佳解。在整个网格上计算完 $L_{p}(\\psi_{k})$ 后，可以选择性地在 $L_{p}$ 表现出急剧变化的区域细化网格，并使用似然比渐近理论来解释 $\\psi$ 的置信集。**\n这个选项完全符合先验推导出的程序。它正确地指出了需要初始的MLE、迭代优化问题的定义，以及处理约束（对数变换）、提高效率（热启动）、确保数值稳健性（刚性求解器、收敛性检查）和管理失败（多起点策略）的最新技术。它以解释结果的正确方法结束。\n**结论：正确**\n\n**B. 直接从 $L(\\psi, \\lambda)$ 中积分掉讨厌参数 $\\lambda$，以获得高斯噪声下的闭式边际似然 $L(\\psi)$，因为高斯积分总能得到解析表达式。在任意 $\\psi$ 处初始化，对每个 $\\psi$ 解析地计算 $L(\\psi)$ 而无需数值优化，如果积分发散，则舍弃该 $\\psi$ 值。**\n这个选项有根本性的错误。它混淆了基于优化（频率派概念）的剖面似然和基于积分（贝叶斯概念）的边际似然。此外，它错误地声称可以得到解析解。参数 $\\lambda$ 通过ODE解非线性地进入似然函数。因此，积分 $\\int L(\\psi, \\lambda) d\\lambda$ 不是一个简单的高斯积分，没有闭式解。\n**结论：不正确**\n\n**C. 计算一次 $\\hat{\\theta}$。对于每个 $\\psi_{k}$，将所有讨厌参数固定在 $\\hat{\\theta}$ 中相应的分量上（即不重新优化），并直接评估 $L(\\psi_{k}, \\hat{\\lambda})$。如果似然函数在 $\\psi$ 上表现出非光滑性，则通过样条拟合对其进行平滑处理。如果在某个 $\\psi_{k}$ 处发生ODE积分失败，则跳过这些点，并从相邻点进行插值。**\n这个选项曲解了剖面似然的定义。它计算的是似然曲面的一个一维“切片”，而不是其脊的投影。核心定义 $L_p(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda)$ 要求对每个 $\\psi_k$ 重新优化 $\\lambda$。将 $\\lambda$ 固定在 $\\hat{\\lambda}$ 忽略了参数之间的相关性，并将严重低估真实的不确定性，导致人为地缩窄置信区间。\n**结论：不正确**\n\n**D. 对 $\\theta$ 设置高斯先验，并使用马尔可夫链蒙特卡洛 (MCMC) 方法从后验分布中采样。通过MCMC样本估计的 $\\psi$ 的边际后验来近似剖面似然 $L_{p}(\\psi)$。通过从先验分布中抽样来进行初始化；如果链不收敛，则更积极地对样本进行稀疏化处理。**\n这个选项描述的是贝叶斯分析，而不是所要求的频率派剖面似然分析。剖面似然和边际后验分布是概念上不同的实体。虽然在某些无信息先验下它们可能渐近等价，但它们并不相同，不能用一个来代替另一个来回答关于计算剖面似然的问题。此外，对MCMC样本进行稀疏化处理并不能解决不收敛的问题。\n**结论：不正确**\n\n**E. 对于每个 $\\psi_{k}$，围绕 $\\hat{\\theta}$ 线性化ODE模型，以获得输出对参数的线性回归，然后以闭式形式计算 $\\lambda$ 的最小二乘解。用 $\\hat{\\theta}$ 初始化，如果线性化产生负参数，则将它们投影到正象限。如果出现不收敛，则减小 $\\psi$ 的步长，直到线性最小二乘残差单调递减。**\n这个选项建议对一个高度非线性的模型使用线性近似。这种近似只在线性化点（$\\hat{\\theta}$）的一个非常小的邻域内有效。在一系列广泛的 $\\psi_k$ 值上使用它不是一个有效或稳健的程序。它为了所谓的计算增益而牺牲了准确性，而这种增益并无保证。将参数投影到正象限是一种粗糙的约束处理方法。这个程序没有计算原始非线性模型的真实剖面似然。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}