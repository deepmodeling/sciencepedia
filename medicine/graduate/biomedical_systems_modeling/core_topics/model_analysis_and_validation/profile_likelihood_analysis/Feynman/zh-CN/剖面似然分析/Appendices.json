{
    "hands_on_practices": [
        {
            "introduction": "理论知识需要通过实践来巩固。本练习将通过一个基本的一阶动力学模型，引导您动手推导和分析参数的可辨识性问题。您将运用剖面似然法，亲眼见证当数据不足时，似然函数如何揭示参数之间的模糊性，并学习如何通过重参数化来解决这一核心问题。",
            "id": "3922495",
            "problem": "考虑标量常微分方程 (ODE) $\\dot{x}(t)=-k\\,x(t)$，其中未知参数 $k>0$ 和 $x_0=x(0)$ 控制着房室模型中生物标志物浓度的衰减。假设在时间 $t>0$ 时有一次测量，其模型为 $y=x(t)+\\varepsilon$，其中 $\\varepsilon$ 是均值为零、方差为 $\\sigma^{2}$ 的高斯噪声，$y$ 是观测到的数据点。使用剖面似然分析作为实际可辨识性的框架，按以下步骤进行：\n\n1. 从第一性原理（ODE的解和测量模型的高斯似然）出发，推导对数似然函数 $\\ell(k,x_0\\mid y)$。\n2. 通过对 $x_0$ 最大化 $\\ell(k,x_0\\mid y)$ 来定义 $k$ 的剖面对数似然，并分析其对 $k$ 的依赖性。解释为什么从单次观测中无法联合辨识 $k$ 和 $x_0$。\n3. 找出一个可以从单次测量中辨识的重参数化（一个关于 $k$、$x_0$ 和 $t$ 的一维参数函数），并用这个重参数化重写似然函数，以证明其可辨识性。\n\n将最终答案表示为可辨识的重参数化参数关于 $k$、$x_0$ 和 $t$ 的显式闭式解析表达式。表达式中不要求四舍五入，也不应包含物理单位。",
            "solution": "首先将验证问题陈述的科学性和结构完整性。\n\n### 第1步：提取已知条件\n- **控制方程**：系统由标量常微分方程 (ODE) $\\dot{x}(t)=-k\\,x(t)$ 描述。\n- **参数**：未知参数为速率常数 $k>0$ 和初始条件 $x_0=x(0)$。\n- **测量模型**：在时间 $t>0$ 时进行一次测量 $y$。该测量的模型为 $y=x(t)+\\varepsilon$。\n- **噪声模型**：测量噪声 $\\varepsilon$ 是一个来自均值为零、方差为 $\\sigma^2$ 的高斯分布的随机变量，即 $\\varepsilon \\sim N(0, \\sigma^2)$。\n- **目标**：使用剖面似然分析来研究参数的可辨识性，并找到一个可辨识的重参数化。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了一个一阶动力学衰减过程，这是药代动力学、化学反应工程和核物理等领域中一个基础且普遍存在的模型。假设加性高斯噪声的测量模型，是实验数据统计建模中一种标准且广为接受的方法。使用剖面似然进行可辨识性分析是系统生物学及相关领域中一种严谨的标准技术。这些前提在科学上和数学上都是合理的。\n2.  **适定性**：该问题被构建为一个引导性推导。它要求推导对数似然、使用剖面似然进行可辨识性分析以及确定重参数化。这种结构能够从给定的数据中得出关于系统可辨识性的明确且有意义的结论。所有必要信息（$\\dot{x}(t)$, $x(0)$, $y$, 噪声特性）都已提供。\n3.  **客观性**：问题使用精确、无歧义的数学和统计语言陈述。没有主观或基于观点的条款。\n\n### 第3步：结论与行动\n该问题是有效的。它具有科学依据，是适定的，并且是客观的。它为展示参数估计中实际和结构不可辨识性的概念提供了一个标准场景。我现在将开始解答。\n\n### 第1部分：对数似然函数的推导\n第一步是求解该ODE，以找到状态变量 $x(t)$ 的显式表达式。该ODE为 $\\dot{x}(t) = -k\\,x(t)$，它是一个线性、一阶、齐次、常系数微分方程。可以通过分离变量法求解：\n$$ \\frac{dx}{x} = -k\\,dt $$\n两边积分得到：\n$$ \\int \\frac{1}{x}\\,dx = \\int -k\\,dt $$\n$$ \\ln|x| = -kt + C_1 $$\n其中 $C_1$ 是积分常数。两边取指数可得：\n$$ |x(t)| = \\exp(-kt + C_1) = \\exp(C_1)\\exp(-kt) $$\n由于生物标志物浓度 $x(t)$ 通常是非负的，并且给定 $x_0 = x(0) > 0$ 和 $k>0$，对于所有 $t \\ge 0$，$x(t)$ 将保持正值。因此我们可以去掉绝对值。令 $A = \\exp(C_1)$。通解为：\n$$ x(t) = A\\exp(-kt) $$\n使用初始条件 $x(0) = x_0$，我们求得 $A$：\n$$ x(0) = A\\exp(-k \\cdot 0) = A \\implies A = x_0 $$\n因此，该ODE的解为：\n$$ x(t) = x_0\\exp(-kt) $$\n测量模型为 $y=x(t)+\\varepsilon$，其中 $\\varepsilon \\sim N(0, \\sigma^2)$。这意味着观测值 $y$ 是一个从均值为 $\\mu = x(t) = x_0\\exp(-kt)$、方差为 $\\sigma^2$ 的高斯分布中抽取的随机变量。给定参数 $k$ 和 $x_0$ 时 $y$ 的概率密度函数 (PDF) 就是似然函数 $L(k, x_0 \\mid y)$：\n$$ L(k, x_0 \\mid y) = p(y \\mid k, x_0, \\sigma, t) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - x_0\\exp(-kt))^2}{2\\sigma^2}\\right) $$\n对数似然函数 $\\ell(k, x_0 \\mid y)$ 是似然函数的自然对数：\n$$ \\ell(k, x_0 \\mid y) = \\ln(L(k, x_0 \\mid y)) = \\ln\\left(\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\right) - \\frac{(y - x_0\\exp(-kt))^2}{2\\sigma^2} $$\n$$ \\ell(k, x_0 \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - x_0\\exp(-kt))^2 $$\n这就是所求的关于两个未知参数 $(k, x_0)$ 的对数似然函数。\n\n### 第2部分：剖面对数似然与可辨识性分析\n参数 $k$ 的剖面对数似然（表示为 $\\ell_{\\text{prof}}(k \\mid y)$）定义为，对于每个固定的 $k$ 值，通过对另一个参数 $x_0$ 进行最大化来得到完整的对数似然函数：\n$$ \\ell_{\\text{prof}}(k \\mid y) = \\max_{x_0} \\ell(k, x_0 \\mid y) = \\max_{x_0} \\left[ -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - x_0\\exp(-kt))^2 \\right] $$\n为了对 $x_0$ 最大化此表达式，我们必须最小化平方误差项 $(y - x_0\\exp(-kt))^2$。由于该项是一个非负的二次项，其最小值为0。当以下条件满足时，达到该最小值：\n$$ y - x_0\\exp(-kt) = 0 $$\n求解 $x_0$ 可得到在给定 $k$ 的情况下使似然最大化的 $x_0$ 值，我们将其表示为 $\\hat{x}_0(k)$：\n$$ \\hat{x}_0(k) = y\\exp(kt) $$\n将此 $x_0$ 的表达式代回对数似然函数，得到 $k$ 的剖面对数似然：\n$$ \\ell_{\\text{prof}}(k \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - (y\\exp(kt))\\exp(-kt))^2 $$\n$$ \\ell_{\\text{prof}}(k \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}(y - y)^2 = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) $$\n剖面对数似然 $\\ell_{\\text{prof}}(k \\mid y)$ 是一个常数，完全独立于参数 $k$。平坦的剖面似然表明数据没有提供任何信息来区分 $k$ 的不同可能值。任何 $k>0$ 的值都具有相同的可能性，只要根据关系 $\\hat{x}_0(k) = y\\exp(kt)$ 来选择 $x_0$ 即可。这意味着不存在唯一的参数对 $(\\hat{k}, \\hat{x}_0)$ 来最大化似然函数。相反，在 $(k, x_0)$ 参数空间中，存在一条由 $x_0\\exp(-kt) = y$ 定义的参数对曲线，在该曲线上似然函数达到最大值且保持不变。这是结构不可辨识性的标志。参数 $k$ 和 $x_0$ 无法从单个数据点联合辨识。\n\n### 第3部分：可辨识的重参数化\n不可辨识性之所以出现，是因为两个参数 $k$ 和 $x_0$ 组合成了一个决定模型预测的单一量。数据仅约束了模型在特定测量时间 $t$ 的输出值，即 $x(t)$。\n让我们定义一个新的单一参数 $\\theta$ 作为这个复合量：\n$$ \\theta = x(t) = x_0\\exp(-kt) $$\n这个新参数 $\\theta$ 是原始参数 $k$ 和 $x_0$ 以及已知的实验时间 $t$ 的函数。我们可以将模型预测简单地重写为 $\\theta$。\n现在，对数似然函数可以用这个单一参数 $\\theta$ 来表示：\n$$ \\ell(\\theta \\mid y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^2) - \\frac{(y - \\theta)^2}{2\\sigma^2} $$\n这是从单个样本 $y$ 估计高斯分布均值 $\\theta$ 的对数似然。该函数是关于 $\\theta$ 的一个开口向下的抛物线，具有唯一的最大值。最大似然估计 $\\hat{\\theta}$ 可通过将关于 $\\theta$ 的导数设为零来求得：\n$$ \\frac{d\\ell}{d\\theta} = -\\frac{2(y-\\theta)(-1)}{2\\sigma^2} = \\frac{y-\\theta}{\\sigma^2} = 0 \\implies \\hat{\\theta} = y $$\n由于 $\\theta$ 的对数似然函数有一个明确定义的唯一最大值，因此参数 $\\theta$ 是可辨识的。数据 $y$ 允许我们估计 $\\theta$。虽然我们无法解开 $k$ 和 $x_0$ 的各自取值，但我们可以唯一地确定组合 $\\theta = x_0\\exp(-kt)$ 的值。\n因此，可辨识的重参数化参数是 $\\theta$，其关于原始参数和时间的表达式为 $x_0\\exp(-kt)$。",
            "answer": "$$\\boxed{x_0 \\exp(-kt)}$$"
        },
        {
            "introduction": "在掌握了剖面似然的基本概念后，我们来探讨一个更深层次的联系。本练习将一个典型的药代动力学模型作为案例，引导您将似然函数曲面的几何特征（例如恒定似然值的“山脊”）与灵敏度矩阵的代数性质（即零空间）联系起来。通过这个实践，您将理解结构不可辨识性在几何和代数上的双重体现，从而深化对模型结构的洞察。",
            "id": "3922503",
            "problem": "考虑一个药代动力学线性房室模型，其中一个被测量的房室有两个独立的一级消除途径：一个是以速率常数 $k_{10}$ 进行消除，另一个是以速率常数 $k_{12}$ 进入未测量的分布途径。被测量房室的状态 $x(t)$ 根据常微分方程 (ODE) $dx/dt = -(k_{10}+k_{12}) x(t)$ 演化，其初始条件已知为 $x(0) = x_0 > 0$。在采样时间 $t_i$（$i = 1,\\dots,n$）进行测量，测量值由 $y_i = x(t_i) + \\epsilon_i$ 给出，其中测量误差 $\\epsilon_i$ 是独立同分布的高斯随机变量，均值为零，方差已知为 $\\sigma^2$。假设 $x_0$ 和 $\\sigma$ 是已知常数。参数向量为 $\\theta = (k_{10},k_{12})$，其两个分量均为非负。因此，模型输出 $x(t)$ 由和 $k_{10}+k_{12}$ 决定。\n\n使用高斯测量噪声下的似然和剖面似然（定义为在感兴趣参数的约束下最大化的似然）的基本定义，以及灵敏度矩阵（模型输出相对于参数的雅可比矩阵）的定义，分析当 $(k_{10},k_{12})$ 被约束在脊 $k_{10}+k_{12} = c$（对于固定的常数 $c \\ge 0$）上时的联合剖面结构，并将此脊及其几何形状与灵敏度矩阵的零空间联系起来。根据此分析，以下哪个陈述是正确的？\n\nA. 对于任何固定的 $c$，在约束 $k_{10}+k_{12}=c$ 下 $(k_{10},k_{12})$ 的联合剖面等于净速率为 $c$ 的单参数模型的似然，对于直线 $k_{10}+k_{12}=c$ 上的所有 $(k_{10},k_{12})$ 来说是恒定的，并且灵敏度矩阵的零空间是 $(1,-1)$ 的张成空间，该向量与该直线相切。\n\nB. 通过对称性，联合剖面在 $k_{10}=k_{12}=c/2$ 处达到唯一最大值，并且由于两个参数都影响输出，灵敏度矩阵的零空间是平凡的。\n\nC. 由于只有和 $k_{10}+k_{12}$ 有影响，联合剖面对所有 $c$ 都是恒定的，并且灵敏度矩阵的零空间是 $(1,1)$ 的张成空间。\n\nD. 脊 $k_{10}+k_{12}=c$ 在参数空间中是弯曲的，并且灵敏度矩阵的零空间对应于该脊的法向量 $(1,1)$。",
            "solution": "用户希望我根据一套严格的规则来验证问题陈述，如果问题有效，则解决它。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **系统：** 一个药代动力学线性房室模型。\n*   **状态方程：** 单个被测量房室的状态 $x(t)$ 根据常微分方程 (ODE) $dx/dt = -(k_{10}+k_{12}) x(t)$ 演化。\n*   **初始条件：** $x(0) = x_0 > 0$，其中 $x_0$ 是已知常数。\n*   **参数：** 参数向量为 $\\theta = (k_{10}, k_{12})$，其中 $k_{10} \\ge 0$ 是一级消除速率常数，$k_{12} \\ge 0$ 是一级分布速率常数。\n*   **测量模型：** 在采样时间 $t_i$（$i = 1,\\dots,n$）进行测量，测量值由 $y_i = x(t_i) + \\epsilon_i$ 给出。\n*   **测量误差：** 误差 $\\epsilon_i$ 是独立同分布 (i.i.d.) 的高斯随机变量，均值为 $0$，方差已知为 $\\sigma^2$。常数 $\\sigma$ 已知。\n*   **核心依赖关系：** 模型输出 $x(t)$ 由和 $k_{10}+k_{12}$ 决定。\n*   **分析任务：** 分析当 $(k_{10},k_{12})$ 被约束在脊 $k_{10}+k_{12} = c$（对于固定的常数 $c \\ge 0$）上时的联合剖面结构。将此脊及其几何形状与灵敏度矩阵的零空间联系起来。\n\n**第2步：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 该问题描述了一个标准的单房室模型，具有并行的一级消除途径。这是药代动力学和系统生物学中一个基础且广泛使用的模型。ODE 具有物理意义，测量噪声的统计模型是标准的。该设置在科学上是合理的。\n2.  **适定性：** 该 ODE 及其初始条件构成了一个适定的初值问题。问题要求使用标准工具（似然、灵敏度分析）分析模型的结构特性（可辨识性），这是系统建模中一个明确定义的任务。该问题并非要求找到 $\\theta$ 的唯一估计值，而是要描述为什么找不到唯一估计值。\n3.  **客观性：** 问题以精确、客观的数学和科学语言陈述。它没有歧义和主观断言。\n4.  **完整性和一致性：** 提供了所有必要组成部分：动态模型、测量模型、统计假设以及参数和变量的定义。没有内部矛盾。\n5.  **合理性：** 该模型是对生物现实的简化，但是一个用于教学和分析的标准、合理且计算上易于处理的表示。\n\n**第3步：结论与行动**\n\n问题陈述是有效的。这是一个关于经典系统生物学模型中结构不可辨识性的适定问题。我现在将进行求解推导。\n\n### 求解推导\n\n**1. 模型解**\n问题由线性常微分方程描述：\n$$ \\frac{dx}{dt} = -(k_{10}+k_{12}) x(t) $$\n初始条件为 $x(0) = x_0$。这是一个可分离的一阶 ODE。令 $k_{sum} = k_{10}+k_{12}$。方程变为 $dx/dt = -k_{sum} x$。解为：\n$$ x(t) = x(0) e^{-k_{sum} t} = x_0 e^{-(k_{10}+k_{12})t} $$\n正如问题中所正确陈述的，在任何时间 $t$，模型输出 $x(t)$ 仅通过其和 $k_{sum} = k_{10}+k_{12}$ 依赖于参数 $k_{10}$ 和 $k_{12}$。这是一个结构不可辨识性的经典案例：仅从 $x(t)$ 的测量值中无法唯一确定 $k_{10}$ 和 $k_{12}$ 的各自值。\n\n**2. 似然函数分析**\n测量值为 $y_i = x(t_i) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。给定参数向量 $\\theta = (k_{10}, k_{12})$，观测到数据向量 $Y = (y_1, \\dots, y_n)$ 的似然为：\n$$ L(\\theta|Y) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - x(t_i; \\theta))^2}{2\\sigma^2}\\right) $$\n最大化该似然等价于最小化残差平方和（或代价函数）$J(\\theta)$：\n$$ J(\\theta) = \\sum_{i=1}^n (y_i - x(t_i; \\theta))^2 = \\sum_{i=1}^n (y_i - x_0 e^{-(k_{10}+k_{12})t_i})^2 $$\n由于代价函数 $J(\\theta)$ 仅依赖于和 $k_{sum} = k_{10}+k_{12}$，似然函数 $L(\\theta|Y)$ 也仅依赖于这个和。\n\n现在，考虑约束 $k_{10}+k_{12} = c$，其中 $c \\ge 0$ 是某个固定常数。对于参数空间中位于这条直线上的任何参数对 $(k_{10}, k_{12})$，其和总是 $c$。因此，模型输出值 $x(t_i) = x_0 e^{-c t_i}$ 对于所有这样的参数对都是相同的。因此，似然函数 $L(k_{10}, k_{12}|Y)$ 的值对于所有满足 $k_{10}+k_{12}=c$ 的 $(k_{10}, k_{12})$ 都是恒定的。这个恒定值恰好是重新参数化的、具有单一参数 $k_{sum}$ 的模型在 $k_{sum}=c$ 处的似然值。\n\n**3. 灵敏度矩阵分析**\n灵敏度矩阵 $S$ 是模型输出向量相对于参数向量的雅可比矩阵。模型输出为 $(x(t_1), \\dots, x(t_n))$。参数为 $\\theta = (k_{10}, k_{12})^T$。灵敏度矩阵的元素为 $S_{ij} = \\frac{\\partial x(t_i)}{\\partial \\theta_j}$。\n\n偏导数为：\n$$ \\frac{\\partial x(t)}{\\partial k_{10}} = \\frac{\\partial}{\\partial k_{10}} \\left( x_0 e^{-(k_{10}+k_{12})t} \\right) = -t x_0 e^{-(k_{10}+k_{12})t} = -t x(t) $$\n$$ \\frac{\\partial x(t)}{\\partial k_{12}} = \\frac{\\partial}{\\partial k_{12}} \\left( x_0 e^{-(k_{10}+k_{12})t} \\right) = -t x_0 e^{-(k_{10}+k_{12})t} = -t x(t) $$\n这两个偏导数是相同的。灵敏度矩阵 $S$ 的维度是 $n \\times 2$，其两列是相同的：\n$$ S = \\begin{pmatrix}\n-t_1 x(t_1)  -t_1 x(t_1) \\\\\n-t_2 x(t_2)  -t_2 x(t_2) \\\\\n\\vdots  \\vdots \\\\\n-t_n x(t_n)  -t_n x(t_n)\n\\end{pmatrix} $$\n$S$ 的列是线性相关的，这证实了结构的不可辨识性。\n\n**4. 灵敏度矩阵的零空间**\n$S$ 的零空间由所有满足 $Sv=0$ 的向量 $v = (v_1, v_2)^T$ 组成。设 $S$ 的第一列表示为向量 $s_1$。则 $S = [s_1, s_1]$。\n$$ Sv = s_1 v_1 + s_1 v_2 = s_1 (v_1 + v_2) $$\n为使 $Sv = 0$，我们必须有 $v_1 + v_2 = 0$，假设 $s_1$ 不是零向量（这要求至少有一个 $t_i \\neq 0$）。这意味着 $v_1 = -v_2$。零空间中的任何向量都必须是 $(k, -k)^T$ 的形式，其中 $k$ 是某个标量。因此，零空间是由向量 $(1, -1)^T$ 张成的一维子空间：\n$$ \\text{Null}(S) = \\text{span}\\left\\{ \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\right\\} $$\n\n**5. 几何解释**\n等似然脊是由 $k_{10}+k_{12}=c$ 定义的直线。这些直线的方向向量可以通过考虑沿线的位移找到，例如从点 $(k_{10}, k_{12})$ 到 $(k_{10}+\\delta, k_{12}-\\delta)$。因此，方向向量与 $(1, -1)$ 成比例。\n来自灵敏度矩阵零空间的向量 $(1,-1)^T$ 因此是等似然线的切向量。这是一个基本结果：灵敏度矩阵的零空间定义了参数空间中的方向，沿着这些方向，模型输出对参数变化是局部不敏感的。在这个线性模型中，这种不敏感性不仅是局部的，而且是全局的。\n\n### 逐项分析\n\n**A. 对于任何固定的 c，在约束 k10+k12=c 下 (k10,k12) 的联合剖面等于净速率为 c 的单参数模型的似然，对于直线 k10+k12=c 上的所有 (k10,k12) 来说是恒定的，并且灵敏度矩阵的零空间是 (1,-1) 的张成空间，该向量与该直线相切。**\n该陈述提出了四个主张：\n1.  在约束 $k_{10}+k_{12}=c$ 下的似然等于速率为 $c$ 的单参数模型的似然。这在第2节中已证明是正确的。\n2.  在直线 $k_{10}+k_{12}=c$ 上似然是恒定的。这在第2节中已证明是正确的。\n3.  灵敏度矩阵的零空间是 $(1, -1)$ 的张成空间。这在第4节中已推导是正确的。\n4.  向量 $(1, -1)$ 与直线 $k_{10}+k_{12}=c$ 相切。这在第5节中已证明是正确的。\n所有主张都正确。\n**结论：正确。**\n\n**B. 通过对称性，联合剖面在 k10=k12=c/2 处达到唯一最大值，并且由于两个参数都影响输出，灵敏度矩阵的零空间是平凡的。**\n似然沿直线 $k_{10}+k_{12}=c$（对于 $k_{10}, k_{12} \\ge 0$）是恒定的，因此在这条直线上没有唯一最大值。灵敏度矩阵的零空间是非平凡的，如第4节所示。\n**结论：不正确。**\n\n**C. 由于只有和 k10+k12 有影响，联合剖面对所有 c 都是恒定的，并且灵敏度矩阵的零空间是 (1,1) 的张成空间。**\n对于一个*固定*的 $c$，似然是恒定的，但它会随 $c$ 的变化而变化。会有一个最优的 $c$ 值使似然最大化。零空间是由 $(1, -1)$ 张成的，而不是 $(1, 1)$。向量 $(1, 1)$ 与等似然线垂直。\n**结论：不正确。**\n\n**D. 脊 k10+k12=c 在参数空间中是弯曲的，并且灵敏度矩阵的零空间对应于该脊的法向量 (1,1)。**\n方程 $k_{10}+k_{12}=c$ 在 $(k_{10}, k_{12})$ 参数空间中定义了一条直线，而不是曲线。零空间向量 $(1,-1)$ 与该直线相切，而不是垂直于它。法向量是 $(1, 1)$。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "从简单的解析模型转向复杂的、非线性的真实世界系统（如基因开关网络）时，计算剖面似然成为一个巨大的挑战。本练习旨在模拟这一真实研究场景，促使您思考并设计一个稳健、高效的计算流程。它不仅是对理论知识的检验，更是对您将统计方法应用于复杂生物系统建模所需的实际操作能力的全面演练。",
            "id": "3922540",
            "problem": "考虑一个由以下常微分方程（ODE）系统控制的两种蛋白质的基因双稳態开关模型，其状态变量为 $x_{1}(t)$ 和 $x_{2}(t)$：\n$$\n\\frac{d x_{1}}{d t} = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{2}}\\right)^{n_{2}}} - \\beta_{1} x_{1}, \\qquad\n\\frac{d x_{2}}{d t} = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{1}}\\right)^{n_{1}}} - \\beta_{2} x_{2},\n$$\n其参数向量为 $\\theta = (\\alpha_{1}, \\alpha_{2}, \\beta_{1}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$，其中所有速率和亲和力参数均为正实数，希尔系数 $n_{1}$ 和 $n_{2}$ 也为正实数。假设在时间点 $t_{i}$ 观测到 $x_{j}(t)$ 的测量值 $y_{i,j}$，其中 $j \\in \\{1,2\\}$，并伴有加性高斯测量噪声，其模型为\n$$\ny_{i,j} = x_{j}(t_{i}; \\theta) + \\varepsilon_{i,j}, \\quad \\varepsilon_{i,j} \\sim \\mathcal{N}(0, \\sigma_{j}^{2}) \\text{ 在 } i \\text{ 和 } j \\text{ 上独立同分布},\n$$\n其中方差 $\\sigma_{j}^{2} > 0$ 已知。似然函数 $L(\\theta)$ 由高斯测量模型得出，负对数似然与加权残差平方和成正比。\n\n定义感兴趣的参数 $\\psi = \\beta_{1}$ 的剖面似然为\n$$\nL_{p}(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda),\n$$\n其中 $\\lambda$ 包含了讨厌参数 $\\lambda = (\\alpha_{1}, \\alpha_{2}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$。我们的目标是在一系列 $\\psi$ 值上，使用基于ODE模型评估的数值优化方法来计算 $L_{p}(\\psi)$。\n\n从基于高斯噪声的似然推断基础出发，哪个选项正确地概述了一个科学上合理且实践上稳健的程序，用于计算 $\\psi = \\beta_{1}$ 的剖面似然，包括初始化、在每个 $\\psi$ 值处的优化，以及处理不收敛情况？\n\nA. 通过最小化关于 $\\theta$ 的负对数似然函数，并使用精确的ODE求解和经过验证的收敛性（例如，小梯度范数和满足Karush–Kuhn–Tucker (KKT) 条件），来初始化并计算无约束最大似然估计（MLE）$\\hat{\\theta}$。为 $\\psi = \\beta_{1}$ 选择一个网格 $\\{\\psi_{k}\\}$，该网格应在根据 $\\hat{\\theta}$ 和先验知识推断出的生物学上合理的范围内（例如，确保正性的界限）。对于每个 $\\psi_{k}$，通过在变换空间中进行操作（例如，对 $\\log \\alpha_{1}$, $\\log \\alpha_{2}$, $\\log \\beta_{2}$, $\\log K_{1}$, $\\log K_{2}$, $\\log n_{1}$, $\\log n_{2}$进行优化以强制实现正性），并使用上一个 $\\psi_{k-1}$ 的解作为热启动（路径跟踪），求解满足正性约束的约束优化问题\n$$\n\\min_{\\lambda} \\; -\\log L(\\psi_{k}, \\lambda)\n$$\n在每一步中，确保ODE解的数值稳健性（如使用自适应容差、必要时使用刚性求解器），通过KKT条件验证收敛性，并记录 $L_{p}(\\psi_{k})$。如果不收敛（例如，积分失败或优化器停滞），则升级采用多起点策略（例如，拉丁超立方采样）、切换算法（例如，切换到信赖域或序列二次规划）、调整容差，并拒绝不可行解；在所有起点中选择最佳解。在计算完整个网格上的 $L_{p}(\\psi_{k})$ 后，可选择性地在 $L_{p}$ 表现出陡峭变化的区域细化网格，并使用似然比渐近理论来解释 $\\psi$ 的置信集。\n\nB. 直接从 $L(\\psi, \\lambda)$ 中对讨厌参数 $\\lambda$ 进行积分，以获得一个闭式边际似然 $L(\\psi)$，因为高斯积分总能产生解析表达式。在任意 $\\psi$ 值处初始化，对每个 $\\psi$ 解析地计算 $L(\\psi)$ 而无需数值优化，如果积分发散，则丢弃该 $\\psi$ 值。\n\nC. 计算一次 $\\hat{\\theta}$。对于每个 $\\psi_{k}$，将所有讨厌参数固定在它们在 $\\hat{\\theta}$ 中的分量值上（即不重新优化），并直接评估 $L(\\psi_{k}, \\hat{\\lambda})$。如果似然函数在 $\\psi$ 上表现出非光滑性，则通过样条拟合对其进行平滑处理。如果在某个 $\\psi_{k}$ 处发生ODE积分失败，则跳过这些点并从相邻点进行插值。\n\nD. 对 $\\theta$ 设置高斯先验，并使用马尔可夫链蒙特卡洛（MCMC）方法对后验分布进行采样。通过从MCMC样本中估计的 $\\psi$ 的边际后驗来近似剖面似然 $L_{p}(\\psi)$。通过从先验分布中抽取样本进行初始化；如果链不收敛，则更积极地对样本进行稀疏化处理。\n\nE. 对于每个 $\\psi_{k}$，围绕 $\\hat{\\theta}$ 将ODE模型线性化，以获得输出对参数的线性回归，然后以闭式形式计算 $\\lambda$ 的最小二乘解。用 $\\hat{\\theta}$ 初始化，如果线性化产生负参数，则将它们投影到正象限上。如果不收敛，则减小 $\\psi$ 的步长，直到线性最小二乘残差单调递减。",
            "solution": "用户要求对问题陈述进行严格验证，然后详细推导解决方案并评估所有提供的选项。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- **模型：**一个基因双稳态开关模型，由一个包含两个常微分方程（ODE）的系统描述：\n  $$\n  \\frac{d x_{1}}{d t} = \\frac{\\alpha_{1}}{1 + \\left(\\frac{x_{2}}{K_{2}}\\right)^{n_{2}}} - \\beta_{1} x_{1}\n  $$\n  $$\n  \\frac{d x_{2}}{d t} = \\frac{\\alpha_{2}}{1 + \\left(\\frac{x_{1}}{K_{1}}\\right)^{n_{1}}} - \\beta_{2} x_{2}\n  $$\n- **状态变量：** $x_{1}(t)$，$x_{2}(t)$ 代表蛋白质浓度。\n- **参数向量：** $\\theta = (\\alpha_{1}, \\alpha_{2}, \\beta_{1}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$。\n- **参数约束：** 所有参数均为正实数。\n- **数据模型：** 观测值 $y_{i,j}$ 由 $y_{i,j} = x_{j}(t_{i}; \\theta) + \\varepsilon_{i,j}$ 给出。\n- **噪声模型：** 测量误差 $\\varepsilon_{i,j}$ 独立同分布，服从高斯分布 $\\mathcal{N}(0, \\sigma_{j}^{2})$。\n- **已知量：** 测量误差方差 $\\sigma_{j}^{2}$ 是已知的正数。\n- **统计框架：** 基于似然的推断，其中负对数似然与加权残差平方和成正比。\n- **感兴趣的参数：** $\\psi = \\beta_{1}$。\n- **讨厌参数：** $\\lambda = (\\alpha_{1}, \\alpha_{2}, \\beta_{2}, K_{1}, K_{2}, n_{1}, n_{2})$。\n- **剖面似然定义：** $L_{p}(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda)$。\n- **目标：** 确定计算 $L_{p}(\\psi)$ 的科学且实践上正确的程序。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题具有科学依据。基因双稳态开关是系统生物学中的一个经典模型，其通过耦合ODE进行的数学表述是标准的。加性高斯噪声的假设在许多生物学背景下是常见且合适的测量误差模型。剖面似然分析是一种成熟且强大的频率学派统计方法，用于此类模型中的参数可辨識性分析和置信区间估计。问题设置完全符合生物医学系统建模的标准实践。\n- **适定性：** 问题是适定的。它要求描述一个计算程序来计算一个明确定义的数学量，即剖面似然函数。函数 $L_p(\\psi)$ 是通过上确界算子定义的，询问是否存在一个计算或近似它的程序是一个有效的问题。尽管在数值上具有挑战性，但计算本身是一项明确定义的任务。\n- **客观性：** 问题使用精确的数学和统计术语进行了客观陈述。“科学上合理且实践上稳健”等短语指的是数值分析和统计计算中已建立的最佳实践，而非主观偏好。\n\n**第3步：结论与行动**\n\n问题陈述是有效的。它在科学上合理、适定且客观。它提出了一个关于系统生物学计算方法学的相关且 nontrivial 的问题。因此，将推导一个完整的解决方案。\n\n### 解法推导\n\n目标是计算感兴趣参数 $\\psi = \\beta_{1}$ 的剖面似然，定义为 $L_{p}(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda)$。在实践中，处理负对数似然更为方便且数值上更稳定。忽略常数项，负对数似然函数由加权平方和目标函数给出：\n$$\nJ(\\theta) = -\\log L(\\theta) \\propto \\frac{1}{2} \\sum_{j=1}^{2} \\frac{1}{\\sigma_j^2} \\sum_{i} (y_{i,j} - x_{j}(t_{i}; \\theta))^2\n$$\n然后，$\\psi$ 的剖面负对数似然定义为：\n$$\n\\text{pl}(\\psi) = \\inf_{\\lambda} J(\\psi, \\lambda)\n$$\n为一系列 $\\psi$ 值计算函数 $\\text{pl}(\\psi)$ 涉及求解一系列约束优化问题。一个稳健且科学合理的程序包括以下几个关键阶段：\n\n1.  **全局优化 (MLE):** 第一步是在整个参数空间 $\\theta$ 上找到负对数似然的全局最小值。这会得到最大似然估计 (MLE) $\\hat{\\theta} = (\\hat{\\psi}, \\hat{\\lambda})$。\n    $$\n    \\hat{\\theta} = \\arg\\min_{\\theta} J(\\theta)\n    $$\n    由于ODE的非线性特性，这是一个非凸优化问题。因此，需要一个全局搜索策略（例如，多起点局部优化、模拟退火、演化算法），然后进行精确的局部优化（例如，信赖域法、Levenberg-Marquardt法）。局部搜索的收敛性必须得到严格验证（例如，检查约束优化的Karush-Kuhn-Tucker (KKT) 条件，或无约束优化的小梯度范数）。\n\n2.  **网格定义：** 为感兴趣的参数定义一个值的网格 $\\{\\psi_k\\}$。该网格应以MLE $\\hat{\\psi}$ 为中心，并向两个方向扩展，以覆盖用于置信区间构建的感兴趣区域。\n\n3.  **迭代约束优化：** 对于网格上的每个 $\\psi_k$，固定感兴趣的参数 $\\psi = \\psi_k$，然后关于讨厌参数 $\\lambda$ 最小化负对数似然。\n    $$\n    \\hat{\\lambda}(\\psi_k) = \\arg\\min_{\\lambda} J(\\psi_k, \\lambda)\n    $$\n    同时满足 $\\lambda$ 中所有参数为正的约束。此优化的结果给出了剖面负对数似然曲线上的一个点：$\\text{pl}(\\psi_k) = J(\\psi_k, \\hat{\\lambda}(\\psi_k))$。\n\n4.  **具体实施细节：**\n    - **约束处理：** 参数的正性约束至关重要。一种标准、稳健的方法是在变换空间中执行优化，例如，对参数的对数进行优化。如果 $\\lambda_j$ 是 $\\lambda$ 中的一个参数，我们定义 $\\eta_j = \\log(\\lambda_j)$ 并对无约束变量 $\\eta_j$ 进行优化。\n    - **热启动（路径跟踪）：** 对于给定 $\\psi_k$ 的优化，可以用为前一个网格点找到的最优讨厌参数 $\\hat{\\lambda}(\\psi_{k-1})$ 来初始化。这种“热启动”显著提高了计算效率和成功率，因为 $\\hat{\\lambda}(\\psi)$ 通常是 $\\psi$ 的连续函数。\n    - **数值稳健性：** 目标函数 $J(\\theta)$ 的每次评估都需要数值求解ODE系统。这必须使用稳健的求解器完成，例如那些为刚性系统设计的求解器（如 `LSODA`, `radau`），并使用适当的自适应误差容限。\n    - **处理不收敛情况：** 在给定 $\\psi_k$ 处的优化可能会失败。一个稳健的流程必须能处理这些失败。这包括尝试多个优化起点（多起点）、切换到不同的优化算法或调整求解器/优化器的容差。如果在详尽尝试后仍找不到解，该点可以被标记为不可行或具有非常高的似然成本。对于给定的 $\\psi_k$，保留所有尝试中找到的最佳值。\n\n5.  **解释：** 计算剖面后，使用似然比检验来确定置信区间。$\\psi$ 的 $(1-\\alpha)$ 置信集由所有满足以下条件的 $\\psi$ 值给出：\n    $$\n    2(\\text{pl}(\\psi) - J(\\hat{\\theta})) \\le \\chi^2_{1, 1-\\alpha}\n    $$\n    其中 $\\chi^2_{1, 1-\\alpha}$ 是自由度为1的卡方分布的 $(1-\\alpha)$-分位数。\n\n这种全面的方法确保了结果的准确性、稳健性和正确解释。\n\n### 逐项分析\n\n**A. 通过最小化关于 $\\theta$ 的负对数似然函数，并使用精确的ODE求解和经过验证的收敛性（例如，小梯度范数和满足Karush–Kuhn–Tucker (KKT) 条件），来初始化并计算无约束最大似然估计（MLE）$\\hat{\\theta}$。为 $\\psi = \\beta_{1}$ 选择一个网格 $\\{\\psi_{k}\\}$，该网格应在根据 $\\hat{\\theta}$ 和先验知识推断出的生物学上合理的范围内（例如，确保正性的界限）。对于每个 $\\psi_{k}$，通过在变换空间中进行操作（例如，对 $\\log \\alpha_{1}$, $\\log \\alpha_{2}$, $\\log \\beta_{2}$, $\\log K_{1}$, $\\log K_{2}$, $\\log n_{1}$, $\\log n_{2}$进行优化以强制实现正性），并使用上一个 $\\psi_{k-1}$ 的解作为热启动（路径跟踪），求解满足正性约束的约束优化问题 $\\min_{\\lambda} \\; -\\log L(\\psi_{k}, \\lambda)$。在每一步中，确保ODE解的数值稳健性（如使用自适应容差、必要时使用刚性求解器），通过KKT条件验证收敛性，并记录 $L_{p}(\\psi_{k})$。如果不收敛（例如，积分失败或优化器停滞），则升级采用多起点策略（例如，拉丁超立方采样）、切换算法（例如，切换到信赖域或序列二次规划）、调整容差，并拒绝不可行解；在所有起点中选择最佳解。在计算完整个网格上的 $L_{p}(\\psi_{k})$ 后，可选择性地在 $L_{p}$ 表现出陡峭变化的区域细化网格，并使用似然比渐近理论来解释 $\\psi$ 的置信集。**\n这个选项与先验推导的程序完全一致。它正确地指出了需要一个初始MLE、迭代优化问题的定义，以及处理约束（对数变换）、提高效率（热启动）、确保数值稳健性（刚性求解器、收敛性检查）和管理失败（多起点策略）的最新技术。它最后以解释结果的正确方法结尾。\n**结论：正确**\n\n**B. 直接从 $L(\\psi, \\lambda)$ 中对讨厌参数 $\\lambda$ 进行积分，以获得一个闭式边际似然 $L(\\psi)$，因为高斯积分总能产生解析表达式。在任意 $\\psi$ 值处初始化，对每个 $\\psi$ 解析地计算 $L(\\psi)$ 而无需数值优化，如果积分发散，则丢棄该 $\\psi$ 值。**\n这个选项存在根本性错误。它混淆了基于优化（频率学派概念）的剖面似然与基于积分（贝叶斯概念）的边际似然。此外，它错误地声称解析解是可能的。参数 $\\lambda$ 通过ODE解 $x_j(t; \\theta)$ 非线性地进入似然函数。因此，积分 $\\int L(\\psi, \\lambda) d\\lambda$ 不是一个简单的高斯积分，没有闭式解。\n**结论：错误**\n\n**C. 计算一次 $\\hat{\\theta}$。对于每个 $\\psi_{k}$，将所有讨厌参数固定在它们在 $\\hat{\\theta}$ 中的分量值上（即不重新优化），并直接评估 $L(\\psi_{k}, \\hat{\\lambda})$。如果似然函数在 $\\psi$ 上表现出非光滑性，则通过样条拟合对其进行平滑处理。如果在某个 $\\psi_{k}$ 处发生ODE积分失败，则跳过这些点并从相邻点进行插值。**\n这个选项错误地陈述了剖面似然的定义。它计算的是似然曲面的一个一维“切片”，而不是其脊的投影。核心定义 $L_p(\\psi) = \\sup_{\\lambda} L(\\psi, \\lambda)$ 要求对每个 $\\psi_k$ 重新优化 $\\lambda$。将 $\\lambda$ 固定在 $\\hat{\\lambda}$ 会忽略参数之间的相关性，并将极大地低估真实的不确定性，导致人为地过窄的置信区间。\n**结论：错误**\n\n**D. 对 $\\theta$ 设置高斯先验，并使用马尔可夫链蒙特卡洛（MCMC-n）方法对后验分布进行采样。通过从MCMC样本中估计的 $\\psi$ 的边际后验来近似剖面似然 $L_{p}(\\psi)$。通过从先验分布中抽取样本进行初始化；如果链不收敛，则更积极地对样本进行稀疏化处理。**\n这个选项描述的是贝叶斯分析，而非所要求的频率学派剖面似然分析。剖面似然和边际后验分布是概念上不同的实体。虽然在某些无信息先验下它们可能渐近等价，但它们并不相同，不能用一个替代另一个来回答关于计算剖面似然的问题。此外，对MCMC样本进行稀疏化处理并不能解决不收敛的问题。\n**结论：错误**\n\n**E. 对于每个 $\\psi_{k}$，围绕 $\\hat{\\theta}$ 将ODE模型线性化，以获得输出对参数的线性回归，然后以闭式形式计算 $\\lambda$ 的最小二乘解。用 $\\hat{\\theta}$ 初始化，如果线性化产生负参数，则将它们投影到正象限上。如果不收敛，则减小 $\\psi$ 的步长，直到线性最小二乘残差单调递减。**\n这个选项建议对一个高度非线性的模型使用线性近似。这种近似仅在线性化点（$\\hat{\\theta}$）的一个非常小的邻域内有效。在广泛的 $\\psi_k$ 值上使用它不是一个有效或稳健的程序。它为了一个不确定的计算增益而牺牲了准确性。将参数投影到正象限是处理约束的一种粗糙方法。此程序不计算原始非线性模型的真实剖面似然。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}