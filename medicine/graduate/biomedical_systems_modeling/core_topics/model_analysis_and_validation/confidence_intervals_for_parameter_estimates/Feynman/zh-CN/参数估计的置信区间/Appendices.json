{
    "hands_on_practices": [
        {
            "introduction": "本练习为构建置信区间奠定了基础，它将探索基于最大似然估计量（MLE）的渐近正态性的基本工具——沃尔德（Wald）区间。通过一个具体的指数分布模型，我们将推导参数的沃尔德区间，并更进一步探讨一个关键的实用技术：参数重整化。我们将看到一个简单的对数变换如何显著改善区间的性能，这对于处理必须为正的参数（如速率常数）至关重要。",
            "id": "3878457",
            "problem": "一个用于受体内化的生物医学系统模型假定，内吞事件的等待时间是独立同分布的指数随机变量，其速率常数为 $k$ (单位为 $\\text{min}^{-1}$)。具体来说，观测到的时间 $\\{t_{i}\\}_{i=1}^{n}$ 被建模为来自一个分布的独立样本，该分布的概率密度函数为 $f(t \\mid k) = k \\exp(-k t)$ (当 $t \\ge 0$ 时)。速率常数 $k$ 量化了这些事件的平均频率，且为正数。\n\n从似然、最大似然估计(MLE)和费雪信息的基本定义出发，按以下步骤进行：\n- 在指数模型下，推导 $k$ 的最大似然估计 $\\hat{k}$ 以及关于 $k$ 的总费雪信息 $I(k)$。\n- 利用最大似然估计的渐近正态性和费雪信息，构建 $k$ 的一个双边 Wald 区间，其名义置信水平为 $1 - \\alpha$（取 $\\alpha = 0.05$ 并使用标准正态分位数 $z_{0.975} \\approx 1.96$）。\n- 考虑重参数化 $\\phi = g(k) = \\ln(k)$。通过得分函数的链式法则推导 $\\phi$ 的费雪信息 $I_{\\phi}(\\phi)$，并构建相应的 $\\phi$ 的双边 Wald 区间，置信水平相同。然后通过逆变换 $k = \\exp(\\phi)$ 将此区间映射回原始参数 $k$，从而得到一个变换回去的 $k$ 的区间。\n- 解释重参数化如何影响 Wald 区间，并讨论 Wald 区间在非线性变换下是否具有不变性，使用上述推导来支持你的论证。\n\n对于具体数据集 $n = 40$ 且 $\\sum_{i=1}^{n} t_{i} = S = 200$ 分钟，进行数值计算：\n1. 直接对 $k$ 构建的 $95\\%$ 双边 Wald 区间的端点。\n2. 对 $\\phi$ 构建的 $95\\%$ 双边 Wald 区间经由 $k = \\exp(\\phi)$ 映射回 $k$ 的端点。\n\n将所有四个端点四舍五入到四位有效数字。以 $\\text{min}^{-1}$ 为单位表示 $k$ 的最终数值端点。按照 $\\big[$k 的下端点（直接法），k 的上端点（直接法），k 的下端点（变换后），k 的上端点（变换后）$\\big]$ 的顺序，将这四个数报告在一个单行矩阵中。",
            "solution": "这个问题在统计推断中提供了一个完整、自洽且有科学依据的场景。解决问题所需的所有定义和数据都已给出，并且问题遵循了最大似然估计和置信区间构建的既定原则。该问题提法恰当且客观。因此，该问题是有效的。\n我们首先推导速率常数 $k$ 的最大似然估计(MLE)和费雪信息。对于来自速率为 $k$ 的指数分布的 $n$ 个独立同分布观测值 $\\{t_{i}\\}_{i=1}^{n}$，其似然函数为：\n$$L(k \\mid \\{t_{i}\\}) = \\prod_{i=1}^{n} f(t_i \\mid k) = \\prod_{i=1}^{n} k \\exp(-k t_i) = k^n \\exp\\left(-k \\sum_{i=1}^{n} t_i\\right)$$\n对数似然函数 $\\ell(k)$ 为：\n$$\\ell(k) = \\ln L(k \\mid \\{t_{i}\\}) = n \\ln(k) - k \\sum_{i=1}^{n} t_i$$\n为了求得最大似然估计 $\\hat{k}$，我们计算得分函数（$\\ell(k)$ 对 $k$ 的一阶导数）并令其为零：\n$$\\frac{d\\ell}{dk} = \\frac{n}{k} - \\sum_{i=1}^{n} t_i = 0$$\n解出 $k$ 得到最大似然估计：\n$$\\hat{k} = \\frac{n}{\\sum_{i=1}^{n} t_i} = \\frac{1}{\\bar{t}}$$\n其中 $\\bar{t}$ 是观测时间的样本均值。\n\n接下来，我们推导费雪信息。对数似然的二阶导数是：\n$$\\frac{d^2\\ell}{dk^2} = -\\frac{n}{k^2}$$\n整个样本大小为 $n$ 的费雪信息 $I(k)$ 是二阶导数的负期望：\n$$I(k) = -E\\left[\\frac{d^2\\ell}{dk^2}\\right] = -E\\left[-\\frac{n}{k^2}\\right] = \\frac{n}{k^2}$$\n注意，由于二阶导数不依赖于数据 $\\{t_i\\}$，其期望就是该量本身。这既是观测费雪信息，也是期望费雪信息。\n\n现在，我们构建 $k$ 的双边 Wald 区间。Wald 区间基于最大似然估计的渐近正态性，该性质表明，对于大样本 $n$，$\\hat{k}$ 近似服从均值为 $k$、方差为 $I(k)^{-1}$ 的正态分布。通过将 $\\hat{k}$ 代入 $k$ 来估计方差，得到估计的标准误 $\\text{SE}(\\hat{k})$：\n$$\\text{SE}(\\hat{k}) = \\sqrt{I(\\hat{k})^{-1}} = \\sqrt{\\frac{\\hat{k}^2}{n}} = \\frac{\\hat{k}}{\\sqrt{n}}$$\n$k$ 的 $(1-\\alpha)$ Wald 置信区间由下式给出：\n$$CI_k = \\hat{k} \\pm z_{1-\\alpha/2} \\cdot \\text{SE}(\\hat{k}) = \\hat{k} \\pm z_{1-\\alpha/2} \\frac{\\hat{k}}{\\sqrt{n}}$$\n\n接下来，我们考虑重参数化 $\\phi = g(k) = \\ln(k)$。根据最大似然估计的不变性，$\\phi$ 的最大似然估计为 $\\hat{\\phi} = g(\\hat{k}) = \\ln(\\hat{k})$。$\\phi$ 的费雪信息，记为 $I_{\\phi}(\\phi)$，可以使用变换公式求得：\n$$I_{\\phi}(\\phi) = I(k) \\left(\\frac{dk}{d\\phi}\\right)^2$$\n逆变换为 $k = \\exp(\\phi)$，因此导数为 $\\frac{dk}{d\\phi} = \\exp(\\phi) = k$。将此代入 $I_{\\phi}(\\phi)$ 的公式中：\n$$I_{\\phi}(\\phi) = \\left(\\frac{n}{k^2}\\right) \\cdot (k)^2 = n$$\n$\\phi$ 的费雪信息是一个常数 $n$。这意味着 $\\hat{\\phi}$ 的渐近方差也是一个常数：$Var(\\hat{\\phi}) \\approx I_{\\phi}(\\phi)^{-1} = \\frac{1}{n}$。$\\hat{\\phi}$ 的标准误是：\n$$\\text{SE}(\\hat{\\phi}) = \\frac{1}{\\sqrt{n}}$$\n$\\phi$ 的 $(1-\\alpha)$ Wald 置信区间为：\n$$CI_{\\phi} = \\hat{\\phi} \\pm z_{1-\\alpha/2} \\cdot \\text{SE}(\\hat{\\phi}) = \\hat{\\phi} \\pm \\frac{z_{1-\\alpha/2}}{\\sqrt{n}}$$\n设此区间的下界和上界分别为 $\\phi_L$ 和 $\\phi_U$。为了得到 $k$ 的置信区间，我们将逆变换 $k = \\exp(\\phi)$ 应用于这些界限：\n$$CI_{k, \\text{transformed}} = [\\exp(\\phi_L), \\exp(\\phi_U)] = \\left[\\exp\\left(\\hat{\\phi} - \\frac{z_{1-\\alpha/2}}{\\sqrt{n}}\\right), \\exp\\left(\\hat{\\phi} + \\frac{z_{1-\\alpha/2}}{\\sqrt{n}}\\right)\\right]$$\n代入 $\\hat{\\phi} = \\ln(\\hat{k})$：\n$$CI_{k, \\text{transformed}} = \\left[\\exp\\left(\\ln(\\hat{k})\\right) \\exp\\left(-\\frac{z_{1-\\alpha/2}}{\\sqrt{n}}\\right), \\exp\\left(\\ln(\\hat{k})\\right) \\exp\\left(\\frac{z_{1-\\alpha/2}}{\\sqrt{n}}\\right)\\right] = \\left[\\hat{k} \\exp\\left(-\\frac{z_{1-\\alpha/2}}{\\sqrt{n}}\\right), \\hat{k} \\exp\\left(\\frac{z_{1-\\alpha/2}}{\\sqrt{n}}\\right)\\right]$$\n\nWald 区间过程在非线性重参数化下不具有不变性。这可以通过比较我们推导出的两个区间来证明。第一个区间 $CI_k$ 在线性尺度上关于 $\\hat{k}$ 对称。第二个区间 $CI_{k, \\text{transformed}}$ 关于 $\\hat{k}$ 不对称（它在对数尺度上是对称的）。对于速率参数，通常首选变换 $\\phi = \\ln(k)$，因为它将参数空间从 $(0, \\infty)$ 变换到 $(-\\infty, \\infty)$。通过对 $\\phi$ 的区间进行逆变换得到的 $k$ 的置信区间，保证只包含正值，这与速率常数的定义是一致的。原则上，直接对 $k$ 构建的区间可能会产生负的下界，这在物理上是无意义的。对数变换通常也起到方差稳定变换的作用，提高了用于构建区间的正态近似的准确性。\n\n最后，我们计算给定数据集的数值：$n=40$，$\\sum_{i=1}^{n} t_i = S = 200$ 分钟，$\\alpha=0.05$ 以及 $z_{0.975} = 1.96$。\n首先，计算 $k$ 的最大似然估计：\n$$\\hat{k} = \\frac{n}{S} = \\frac{40}{200} = 0.2 \\, \\text{min}^{-1}$$\n\n1. 直接对 $k$ 构建的 $95\\%$ Wald 区间的端点：\n区间为 $\\hat{k} \\pm z_{0.975} \\frac{\\hat{k}}{\\sqrt{n}}$。\n$$0.2 \\pm 1.96 \\times \\frac{0.2}{\\sqrt{40}} = 0.2 \\pm 1.96 \\times \\frac{0.2}{6.324555...} = 0.2 \\pm 0.0619806...$$\n下端点：$0.2 - 0.0619806... = 0.138019... \\approx 0.1380$\n上端点：$0.2 + 0.0619806... = 0.2619806... \\approx 0.2620$\n\n2. 对 $\\phi$ 构建的 $95\\%$ Wald 区间映射回 $k$ 的端点：\n区间为 $\\left[ \\hat{k} \\exp\\left(-\\frac{z_{0.975}}{\\sqrt{n}}\\right), \\hat{k} \\exp\\left(\\frac{z_{0.975}}{\\sqrt{n}}\\right) \\right]$。\n指数项为 $\\frac{1.96}{\\sqrt{40}} \\approx 0.309903...$\n下端点：$0.2 \\times \\exp(-0.309903...) = 0.2 \\times 0.73352... = 0.146704... \\approx 0.1467$\n上端点：$0.2 \\times \\exp(0.309903...) = 0.2 \\times 1.36329... = 0.272658... \\approx 0.2727$\n\n四个端点，四舍五入到四位有效数字，分别为 $0.1380$、$0.2620$、$0.1467$ 和 $0.2727$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1380  0.2620  0.1467  0.2727\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基础知识之后，本练习将我们带入一个更贴近现实的场景：一个通过非线性最小二乘法拟合数据的动态模型。我们将处理一个常见情况，即测量误差的方差是未知的，这要求我们论证并使用学生$t$分布来构建一个有效的置信区间。这个问题将抽象的统计理论与生物医学系统建模的日常实践联系起来。",
            "id": "3878488",
            "problem": "一个药代动力学单室静脉推注模型通过常微分方程(ODE) $dC/dt = -k\\,C$ 描述血浆药物浓度动态，其中 $k$ 是一级消除速率常数，$C(t)$ 是在时间 $t$ 的血浆药物浓度。其解析解为 $C(t) = C_{0}\\,\\exp(-k\\,t)$，其中 $C_{0}$ 是推注给药后的初始浓度。假设在时间点 $\\{t_{i}\\}_{i=1}^{n}$ 观测到的 $n$ 个不同血浆药物浓度 $\\{y_{i}\\}_{i=1}^{n}$ 由模型 $y_{i} = C_{0}\\,\\exp(-k\\,t_{i}) + \\varepsilon_{i}$ 描述，其中测量误差 $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$ 是独立同分布的。您通过最小化关于 $\\theta = (k, C_{0})^{\\top}$ 的误差平方和(SSE) $S(\\theta) = \\sum_{i=1}^{n} \\left(y_{i} - C_{0}\\,\\exp(-k\\,t_{i})\\right)^{2}$ 来拟合非线性最小二乘估计量，并获得 Gauss–Newton 解 $\\hat{\\theta} = (\\hat{k}, \\hat{C}_{0})^{\\top}$。\n\n在解处，模型预测值对参数的偏导数所构成的雅可比矩阵 $J(\\hat{\\theta})$ 有 $p=2$ 列。在 Gauss–Newton 近似下，使用局部线性化来表征 $\\hat{\\theta}$ 的不确定性。设 $n=30$，并假设在 $\\hat{\\theta}$ 处计算出以下量：\n- 误差平方和(SSE)为 $S(\\hat{\\theta}) = 0.84$。\n- 矩阵 $\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}$ 的 $(1,1)$ 元素是 $\\left[\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}\\right]_{11} = 2.0 \\times 10^{-3}$。\n- 估计的消除速率常数为 $\\hat{k} = 0.35$ $\\mathrm{h}^{-1}$。\n\n从独立高斯误差、非线性最小二乘设置和 Gauss–Newton 局部线性化的假设出发，推导 $k$ 在置信水平 $0.95$ 下的双侧置信区间，并论证使用具有适当自由度(DoF)的 Student’s $t$ 分布的合理性。明确解释自由度的来源以及为什么使用 $t$ 分布（而不是正态分布）。\n\n然后，使用所提供的量计算推导出的 $k$ 的置信区间的数值端点。将您的端点四舍五入到四位有效数字。最终端点以 $\\mathrm{h}^{-1}$ 为单位表示。",
            "solution": "首先通过提取给定信息并评估其科学有效性和完整性来验证问题。\n\n### 第一步：提取已知条件\n- 模型常微分方程：$dC/dt = -k\\,C$\n- 解析解：$C(t) = C_{0}\\,\\exp(-k\\,t)$\n- 观测值的统计模型：$y_{i} = C_{0}\\,\\exp(-k\\,t_{i}) + \\varepsilon_{i}$，其中 $i=1, \\dots, n$\n- 误差分布：$\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$，独立同分布。\n- 参数向量：$\\theta = (k, C_{0})^{\\top}$\n- 参数数量：$p=2$\n- 非线性最小二乘的目标函数：$S(\\theta) = \\sum_{i=1}^{n} \\left(y_{i} - C_{0}\\,\\exp(-k\\,t_{i})\\right)^{2}$\n- 估计量：$\\hat{\\theta} = (\\hat{k}, \\hat{C}_{0})^{\\top}$，$S(\\theta)$ 的最小化子。\n- 观测数量：$n=30$\n- 解处的误差平方和：$S(\\hat{\\theta}) = 0.84$\n- 近似 Hessian 矩阵的逆的元素：$\\left[\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}\\right]_{11} = 2.0 \\times 10^{-3}$\n- 估计的消除速率常数：$\\hat{k} = 0.35 \\, \\mathrm{h}^{-1}$\n- 期望置信水平：$0.95$\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个标准的单室静脉推注药代动力学模型。控制常微分方程、其解以及带有高斯误差假设的非线性最小二乘估计框架，是生物医学系统建模和统计参数估计中的基本且正确的概念。Gauss-Newton 方法的使用以及由此得到的参数协方差矩阵的近似，是非线性回归分析中的标准做法。所有前提都具有科学合理性。\n- **适定性**：该问题是适定的。它要求推导和计算特定参数 $k$ 的置信区间。所有必要的数值（$n$、$p$、$S(\\hat{\\theta})$、$\\hat{k}$ 以及用于标准误计算的相关矩阵元素）和置信水平均已提供。存在唯一解。\n- **客观性**：该问题以精确、客观和技术性的语言陈述，没有歧义或主观内容。\n- **完整性**：该问题是自包含的，为求解提供了足够的信息。\n- **其他缺陷**：该问题不是无关紧要、同义反复或不适定的。它代表了统计理论在科学背景下的一个标准但概念上重要的应用。\n\n### 第三步：结论与行动\n问题有效。将提供详细解答。\n\n### 解的推导与计算\n\n目标是推导和计算参数 $k$ 的 $95\\%$ 置信区间。在非线性最小二乘法中，假设误差 $\\varepsilon_{i}$ 独立同分布于 $\\mathcal{N}(0,\\sigma^{2})$，那么对于大的 $n$，参数估计量 $\\hat{\\theta}$ 近似服从正态分布，其均值等于真实参数向量 $\\theta$，协方差矩阵由 $\\text{Cov}(\\hat{\\theta}) \\approx \\sigma^{2} \\left(J(\\theta)^{\\top}J(\\theta)\\right)^{-1}$ 给出。雅可比矩阵 $J(\\theta)$ 是一个 $n \\times p$ 矩阵，其元素是模型函数对参数的偏导数，在真实参数值处计算。在实践中，我们在估计值 $\\hat{\\theta}$ 处计算 $J$。\n\n单个参数估计值 $\\hat{k}$ 的方差是该协方差矩阵的第一个对角元素：\n$$ \\text{Var}(\\hat{k}) \\approx \\sigma^{2} \\left[\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}\\right]_{11} $$\n真实的误差方差 $\\sigma^{2}$ 通常是未知的，必须从数据中估计。$\\sigma^{2}$ 的无偏估计量是均方误差(MSE)，记为 $s^{2}$：\n$$ s^{2} = \\frac{S(\\hat{\\theta})}{n-p} = \\frac{\\text{SSE}}{\\text{DoF}} $$\n分母 $n-p$ 代表误差的自由度(DoF)。这是因为我们从 $n$ 个独立的数据点开始，但用它们来估计 $p$ 个参数。这 $p$ 个参数的估计对残差施加了 $p$ 个约束，为误差方差的估计留下了 $n-p$ 个自由度。在本问题中，$n=30$ 且 $p=2$（对于 $k$ 和 $C_0$），所以自由度是 $30 - 2 = 28$。\n\n用估计值 $s^{2}$ 代替真实方差 $\\sigma^{2}$，我们得到 $\\hat{k}$ 的估计方差：\n$$ \\widehat{\\text{Var}}(\\hat{k}) = s^{2} \\left[\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}\\right]_{11} $$\n估计值 $\\hat{k}$ 的标准误是这个估计方差的平方根：\n$$ \\text{se}(\\hat{k}) = \\sqrt{\\widehat{\\text{Var}}(\\hat{k})} = \\sqrt{s^{2} \\left[\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}\\right]_{11}} $$\n现在，我们论证使用 Student's $t$ 分布的合理性。考虑枢轴量：\n$$ T = \\frac{\\hat{k} - k}{\\text{se}(\\hat{k})} $$\n如果真实方差 $\\sigma^{2}$ 已知，则量 $(\\hat{k}-k)/\\sqrt{\\text{Var}(\\hat{k})}$ 将近似为一个标准正态变量, $Z \\sim \\mathcal{N}(0,1)$。然而，因为我们使用了估计值 $s^2$，我们引入了额外的不确定性。统计理论指出，量 $\\frac{(n-p)s^{2}}{\\sigma^{2}}$ 服从自由度为 $n-p$ 的卡方($\\chi^{2}$)分布。\n\n让我们重写枢轴量 $T$：\n$$ T = \\frac{\\hat{k} - k}{\\sqrt{s^{2} \\left[\\left(J^{\\top}J\\right)^{-1}\\right]_{11}}} = \\frac{\\frac{\\hat{k} - k}{\\sigma\\sqrt{\\left[\\left(J^{\\top}J\\right)^{-1}\\right]_{11}}}}{\\sqrt{\\frac{s^{2}}{\\sigma^{2}}}} = \\frac{Z}{\\sqrt{\\frac{(n-p)s^{2}/\\sigma^{2}}{n-p}}} $$\n分子 $Z$ 是（近似）一个标准正态随机变量。分母中平方根内的项是一个自由度为 $n-p$ 的 $\\chi^{2}$ 分布随机变量除以其自由度。根据定义，由一个标准正态变量与一个独立的、除以其自由度的 $\\chi^{2}$ 变量的平方根之比构成的随机变量，服从具有相同自由度的 Student's $t$ 分布。\n因此，$T = \\frac{\\hat{k} - k}{\\text{se}(\\hat{k})}$ 服从自由度为 $n-p = 28$ 的 $t$ 分布。这就是为什么使用 $t$ 分布而不是正态分布的原因：它正确地考虑了因从数据中估计 $\\sigma^{2}$ 而引入的额外不确定性。\n\n$k$ 在置信水平 $1-\\alpha$ 下的双侧置信区间构造如下：\n$$ \\hat{k} \\pm t_{\\alpha/2, n-p} \\times \\text{se}(\\hat{k}) $$\n其中 $t_{\\alpha/2, n-p}$ 是来自 $t$ 分布的临界值，它使得上尾面积为 $\\alpha/2$。对于 $95\\%$ 的置信水平，$1-\\alpha = 0.95$，所以 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。\n\n现在我们计算数值。\n1.  自由度 (DoF)：$n-p = 30-2 = 28$。\n2.  估计的误差方差：$s^{2} = \\frac{S(\\hat{\\theta})}{n-p} = \\frac{0.84}{28} = 0.03$。\n3.  $\\hat{k}$ 的标准误：\n    $$ \\text{se}(\\hat{k}) = \\sqrt{s^{2} \\left[\\left(J(\\hat{\\theta})^{\\top}J(\\hat{\\theta})\\right)^{-1}\\right]_{11}} = \\sqrt{0.03 \\times (2.0 \\times 10^{-3})} = \\sqrt{6.0 \\times 10^{-5}} $$\n    $$ \\text{se}(\\hat{k}) \\approx 0.0077459667 $$\n4.  临界 $t$ 值：对于 $95\\%$ 的置信区间和 $28$ 个自由度，临界值为 $t_{0.025, 28}$。根据标准统计表或软件，$t_{0.025, 28} = 2.0484$。\n5.  误差范围 (ME)：\n    $$ \\text{ME} = t_{0.025, 28} \\times \\text{se}(\\hat{k}) = 2.0484 \\times 0.0077459667 \\approx 0.0158673 $$\n6.  置信区间 (CI)：\n    $$ \\text{CI} = \\hat{k} \\pm \\text{ME} = 0.35 \\pm 0.0158673 $$\n    -   下界：$0.35 - 0.0158673 = 0.3341327$\n    -   上界：$0.35 + 0.0158673 = 0.3658673$\n\n按要求将端点四舍五入到四位有效数字：\n-   下界：$0.3341$\n-   上界：$0.3659$\n\n消除速率常数 $k$ 的 $95\\%$ 置信区间为 $(0.3341, 0.3659) \\, \\mathrm{h}^{-1}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3341  0.3659\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这个练习展示了统计建模理论的预测能力。我们不再仅仅是被动地分析一个给定的数据集，而是将利用我们一直在构建的置信区间的基础——费雪信息（Fisher Information）——来主动地确定收集数据的最佳时间点，以便以尽可能高的精度估计参数。这个练习将我们的思维从数据分析提升到战略性的实验设计层面。",
            "id": "3878401",
            "problem": "一个生物分子药代动力学系统由单室静脉推注模型描述。血浆药物浓度 $x(t)$ 服从常微分方程 $dx/dt = -k\\,x$，初始条件已知为 $x(0) = x_{0} > 0$，其中消除速率常数 $k > 0$ 是一个未知的标量参数。在 $t=0$ 之后没有给药或输入。在设计时间点 $t_{1},\\dots,t_{n}$ 收集浓度测量值 $y_{i}$，测量过程带有独立的加性噪声：$y_{i} = x(t_{i}) + \\varepsilon_{i}$，其中 $\\varepsilon_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$ 且 $\\sigma^{2} > 0$ 已知。设计基于一个标称参数值 $k_{0} > 0$。\n\n使用灵敏度方程框架和最大似然估计的标准正则性条件，完成以下任务：\n\n1. 通过构建并求解与 $dx/dt = -k\\,x$ 和 $x(0)=x_{0}$ 一致的灵敏度微分方程，推导灵敏度 $s(t) = \\partial x(t)/\\partial k$。\n\n2. 使用推导出的灵敏度和 $y_{i}$ 的统计模型，推导在标称值 $k_{0}$ 处计算的关于 $k$ 的期望费雪信息，该信息是设计时间点 $t_{1},\\dots,t_{n}$、初始条件 $x_{0}$ 和噪声方差 $\\sigma^{2}$ 的函数。\n\n3. 以最大似然估计量为中心的关于 $k$ 的大样本沃尔德（以 Abraham Wald 命名）置信区间的宽度，与在 $k_{0}$ 处计算的期望费雪信息的逆的平方根成正比。在固定预算下，允许进行恰好 $n$ 次测量，并且每次测量的成本相同且与时间无关，您可以在同一时间点进行多次测量。确定一组时间点 $t_{1},\\dots,t_{n} \\in [0,\\infty)$ 以最小化沃尔德置信区间的宽度，并提供所有测量都应在其上进行的单个最佳采样时间 $t^{*}$ 的解析表达式。\n\n以小时为单位表示最终的最佳采样时间 $t^{*}$。您无需计算数值。",
            "solution": "该问题被评估为有效，因为它在科学上基于药代动力学建模和估算理论，问题设定良好、客观，并包含符号解所需的所有必要信息。解题过程按要求分为三部分。\n\n### 第一部分：灵敏度方程的推导\n\n该系统由血浆药物浓度 $x(t)$ 的常微分方程（ODE）描述：\n$$\n\\frac{dx}{dt} = -k x(t)\n$$\n初始条件为 $x(0) = x_0$。这是一个一阶线性齐次常微分方程，可以通过分离变量法求解。\n$$\n\\frac{dx}{x} = -k dt\n$$\n两边积分得到 $\\ln(x(t)) = -kt + C$，其中 $C$ 是积分常数。取指数得到 $x(t) = \\exp(-kt + C) = A\\exp(-kt)$，其中 $A = \\exp(C)$。应用初始条件 $x(0) = x_0$，我们得到 $A = x_0$。因此，该常微分方程的解为：\n$$\nx(t) = x_0 \\exp(-kt)\n$$\n状态 $x(t)$ 相对于参数 $k$ 的灵敏度定义为 $s(t) = \\frac{\\partial x(t)}{\\partial k}$。为了找到控制 $s(t)$ 的微分方程，我们将主常微分方程对 $k$ 求导：\n$$\n\\frac{\\partial}{\\partial k}\\left(\\frac{dx}{dt}\\right) = \\frac{\\partial}{\\partial k}(-k x)\n$$\n假设有足够的正则性，我们可以交换微分的顺序：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial x}{\\partial k}\\right) = -\\frac{\\partial}{\\partial k}(k) \\cdot x - k \\cdot \\frac{\\partial x}{\\partial k}\n$$\n代入 $s(t) = \\frac{\\partial x}{\\partial k}$ 并注意到 $\\frac{\\partial k}{\\partial k} = 1$，我们得到灵敏度常微分方程：\n$$\n\\frac{ds}{dt} = -x(t) - k s(t)\n$$\n灵敏度的初始条件 $s(0)$ 是通过将 $x(t)$ 的初始条件对 $k$ 求导得到的。由于 $x(0) = x_0$ 是一个给定的常数，不依赖于 $k$，我们有：\n$$\ns(0) = \\frac{\\partial x(0)}{\\partial k} = \\frac{\\partial x_0}{\\partial k} = 0\n$$\n现在我们求解灵敏度常微分方程 $\\frac{ds}{dt} + k s(t) = -x(t)$，初始条件为 $s(0) = 0$。代入 $x(t)$ 的表达式：\n$$\n\\frac{ds}{dt} + k s(t) = -x_0 \\exp(-kt)\n$$\n这是一个一阶线性非齐次常微分方程。我们使用积分因子 $I(t) = \\exp\\left(\\int k dt\\right) = \\exp(kt)$。将常微分方程乘以 $I(t)$：\n$$\n\\exp(kt)\\frac{ds}{dt} + k \\exp(kt) s(t) = -x_0 \\exp(-kt)\\exp(kt)\n$$\n左边是乘积 $s(t)I(t)$ 的导数：\n$$\n\\frac{d}{dt}\\left(s(t)\\exp(kt)\\right) = -x_0\n$$\n两边对 $t$ 积分：\n$$\ns(t)\\exp(kt) = \\int -x_0 dt = -x_0 t + C'\n$$\n其中 $C'$ 是积分常数。求解 $s(t)$：\n$$\ns(t) = (-x_0 t + C')\\exp(-kt)\n$$\n应用初始条件 $s(0) = 0$：\n$$\n0 = (-x_0 \\cdot 0 + C')\\exp(-k \\cdot 0) \\implies C' = 0\n$$\n因此，灵敏度为：\n$$\ns(t) = -x_0 t \\exp(-kt)\n$$\n\n### 第二部分：期望费雪信息的推导\n\n测量模型为 $y_i = x(t_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 是独立同分布的噪声项。对于这种带有加性高斯噪声的模型，来自一组 $n$ 次测量的参数 $k$ 的期望费雪信息由每次测量的信息之和给出。对于在时间 $t_i$ 的单次测量 $y_i$，费雪信息为：\n$$\nF_i(k) = \\frac{1}{\\sigma^2} \\left( \\frac{\\partial x(t_i)}{\\partial k} \\right)^2\n$$\n由于测量是独立的，总期望费雪信息是各项之和：\n$$\nF = \\sum_{i=1}^{n} F_i(k) = \\sum_{i=1}^{n} \\frac{1}{\\sigma^2} \\left( \\frac{\\partial x(t_i)}{\\partial k} \\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} [s(t_i)]^2\n$$\n代入推导出的灵敏度表达式 $s(t) = -x_0 t \\exp(-kt)$：\n$$\n[s(t_i)]^2 = (-x_0 t_i \\exp(-kt_i))^2 = x_0^2 t_i^2 \\exp(-2kt_i)\n$$\n总费雪信息作为 $k$ 的函数是：\n$$\nF(k) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} x_0^2 t_i^2 \\exp(-2kt_i) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{n} t_i^2 \\exp(-2kt_i)\n$$\n问题要求在标称参数值 $k_0$ 处计算该值。\n$$\nF(k_0) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{n} t_i^2 \\exp(-2k_0 t_i)\n$$\n这就是关于 $k$ 的期望费雪信息，表示为设计时间点 $t_1, \\dots, t_n$、初始条件 $x_0$ 和噪声方差 $\\sigma^2$ 的函数。\n\n### 第三部分：最佳采样时间\n\n关于 $k$ 的大样本沃尔德置信区间的宽度与期望费雪信息的逆的平方根成正比，即，宽度 $\\propto \\sqrt{1/F(k_0)}$。因此，最小化置信区间宽度等价于最大化费雪信息 $F(k_0)$。优化问题是选择测量时间 $t_i \\geq 0$（对于 $i=1, \\dots, n$）以最大化：\n$$\nF(k_0) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{n} t_i^2 \\exp(-2k_0 t_i)\n$$\n最大化 $F(k_0)$ 等价于最大化和 $\\sum_{i=1}^{n} t_i^2 \\exp(-2k_0 t_i)$，因为 $\\frac{x_0^2}{\\sigma^2}$ 是一个正常数。我们定义函数 $f(t) = t^2 \\exp(-2k_0 t)$。我们需要最大化 $\\sum_{i=1}^{n} f(t_i)$。\n由于对于 $t \\geq 0$ 有 $f(t) \\geq 0$，当每一项 $f(t_i)$ 都被单独最大化时，和也就被最大化。这意味着所有的采样时间 $t_i$ 都应该选择为在定义域 $t \\in [0, \\infty)$ 上使 $f(t)$ 最大化的那一个时间点 $t^*$。\n\n为了找到 $f(t)$ 的最大值，我们计算它关于 $t$ 的导数，并令其为零。\n$$\nf'(t) = \\frac{d}{dt} \\left( t^2 \\exp(-2k_0 t) \\right)\n$$\n使用乘法法则 $(uv)' = u'v + uv'$：\n$$\nf'(t) = (2t)\\exp(-2k_0 t) + t^2(-2k_0)\\exp(-2k_0 t)\n$$\n$$\nf'(t) = (2t - 2k_0 t^2)\\exp(-2k_0 t) = 2t(1 - k_0 t)\\exp(-2k_0 t)\n$$\n我们令 $f'(t) = 0$ 来寻找临界点。由于对所有 $t$ 都有 $\\exp(-2k_0 t) > 0$，解由以下方程给出：\n$$\n2t(1 - k_0 t) = 0\n$$\n这得出了两个临界点：$t=0$ 和 $t = \\frac{1}{k_0}$。\n\n我们现在必须确定这些点中哪一个对应于 $[0, \\infty)$ 上的全局最大值。\n- 在 $t=0$ 处：$f(0) = 0^2 \\exp(0) = 0$。\n- 在 $t=\\frac{1}{k_0}$ 处：$f\\left(\\frac{1}{k_0}\\right) = \\left(\\frac{1}{k_0}\\right)^2 \\exp\\left(-2k_0 \\frac{1}{k_0}\\right) = \\frac{1}{k_0^2} \\exp(-2)$。\n- 当 $t \\to \\infty$ 时：$f(t) = t^2 \\exp(-2k_0 t) \\to 0$，因为指数衰减主导了多项式增长。\n\n由于 $k_0 > 0$，我们有 $f\\left(\\frac{1}{k_0}\\right) = \\frac{\\exp(-2)}{k_0^2} > 0$。比较这些值，函数 $f(t)$ 在 $t = \\frac{1}{k_0}$ 处达到其全局最大值。\n\n因此，为了最大化费雪信息，所有 $n$ 次测量都应在这个单一的最佳时间点进行。最佳采样时间 $t^*$ 为：\n$$\nt^* = \\frac{1}{k_0}\n$$\n问题陈述暗示，如果 $k_0$ 的单位是小时的倒数，那么 $t^*$ 的单位将是小时。",
            "answer": "$$\n\\boxed{\\frac{1}{k_0}}\n$$"
        }
    ]
}