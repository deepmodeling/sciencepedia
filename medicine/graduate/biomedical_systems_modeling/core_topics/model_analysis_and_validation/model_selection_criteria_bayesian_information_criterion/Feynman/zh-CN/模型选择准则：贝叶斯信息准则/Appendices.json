{
    "hands_on_practices": [
        {
            "introduction": "贝叶斯信息准则（BIC）通过一个取决于自由参数数量 $k$ 的项来惩罚模型的复杂性。在具有共享参数和约束的复杂生物医学系统中，正确确定 $k$ 是一个关键且不容忽视的步骤。本练习将检验您在一个真实的多组织模型中仔细计算有效自由度的能力，这是正确应用 BIC 的一项基本技能。",
            "id": "3903943",
            "problem": "在用于示踪剂动力学生物医学系统建模的多组织非线性回归中，您需要联合拟合来自 $T = 5$ 个组织的数据，组织索引为 $t \\in \\{1,2,3,4,5\\}$。对于每个组织，您观察到的时间进程测量值被建模为 $y_{t,i} = f(t_{t,i}; \\boldsymbol{\\theta}_g, \\boldsymbol{\\phi}_t) + \\varepsilon_{t,i}$，其中 $f(\\cdot)$ 是一个非线性机理模型，此处无需其精确形式。联合拟合是根据以下具有科学动机的结构，通过最大似然法进行的：\n- 存在一个长度为 $4$ 的全局动力学参数向量 $\\boldsymbol{\\theta}_g$，它在所有组织间共享，代表共同的转运和酶促速率。这 $4$ 个全局动力学参数中的一个已通过外部校准实验先验固定，并且在此次拟合中不进行重新估计。\n- 每个组织都有一个振幅参数 $A_t$，该参数被约束以表示一个分数贡献，约束条件为 $\\sum_{t=1}^{5} A_t = 1$。\n- 每个组织都有一个有效延迟参数，但由于共享的血管通路，组织 $1$ 和 $2$ 共享一个共同的延迟（记作 $\\tau_{12}$），而组织 $3$、$4$ 和 $5$ 各自拥有独立的延迟（$\\tau_3$、$\\tau_4$、$\\tau_5$）。这些延迟之间没有额外的约束。\n- 驱动组织 $t$ 中 $f(\\cdot)$ 的状态的初始条件是未知的。您没有估计 $5$ 个不相关的初始条件，而是施加了一个简约的线性协变量结构 $x_{0,t} = x_0 + \\delta q_t$，其中 $q_t$ 是已知的、不同的组织水平协变量，而 $(x_0, \\delta)$ 是所有组织共享的参数。\n- 测量噪声被建模为具有组织特异性方差的独立高斯分布：$\\varepsilon_{t,i} \\sim \\mathcal{N}(0,\\sigma_t^2)$。然而，成像方案的对称性意味着 $\\sigma_4^2 = \\sigma_5^2$，而 $\\sigma_1^2$、$\\sigma_2^2$ 和 $\\sigma_3^2$ 则各不相同且互不相关。\n- 一个共享的基线趋势 $b_0 + b_1 g(t)$（其中 $g(\\cdot)$ 是已知的标量函数）被添加在 $f(\\cdot)$ 内部，并由所有组织通用的两个系数 $(b_0,b_1)$ 参数化。\n\n模型的所有其他方面都已完全指定和已知。当使用贝叶斯信息准则 (BIC) 将此模型与其他备选模型进行比较时，您必须提供参数数量 $k$，即在上述约束条件下，为这 $5$ 个组织计算的联合似然中出现的自由、可估计参数的数量。\n\n对于这个模型，哪个 $k$ 值是正确的？\n\nA. $k = 17$\n\nB. $k = 19$\n\nC. $k = 20$\n\nD. $k = 23$\n\nE. $k = 15$",
            "solution": "该问题要求确定一个多组织非线性回归模型的联合最大似然拟合中自由、可估计参数的总数，记为 $k$。$k$ 的值对于计算贝叶斯信息准则 (BIC)至关重要，其定义为 $\\text{BIC} = -2 \\ln(\\hat{L}) + k \\ln(N)$，其中 $\\hat{L}$ 是最大化似然值， $N$ 是观测总数。任务是根据提供的模型结构和约束来计算 $k$。我们将通过系统地列举模型每个组成部分的参数来进行。\n\n1.  **全局动力学参数 ($\\boldsymbol{\\theta}_g$):**\n    问题陈述，存在一个长度为 $4$ 的全局动力学参数向量 $\\boldsymbol{\\theta}_g$。这些参数在所有 $T=5$ 个组织间共享。然而，这 $4$ 个参数中的一个被指定为通过外部实验先验固定。因此，它不在此拟合过程中被估计。该组的自由参数数量是总数减去固定参数的数量。\n    动力学参数数量 = $4 - 1 = 3$。\n\n2.  **振幅参数 ($A_t$):**\n    $5$ 个组织中的每一个都有一个振幅参数 $A_t$。这得到一组 $5$ 个参数 $\\{A_1, A_2, A_3, A_4, A_5\\}$。这些参数受到线性约束 $\\sum_{t=1}^{5} A_t = 1$ 的限制。对一组 $n$ 个参数施加一个线性约束会使自由参数的数量减少 $1$。一旦估计了其中 $4$ 个振幅，第五个就由该约束确定（例如，$A_5 = 1 - \\sum_{t=1}^{4} A_t$）。\n    自由振幅参数数量 = $5 - 1 = 4$。\n\n3.  **延迟参数 ($\\tau_t$):**\n    延迟参数的结构被明确定义。组织 $1$ 和 $2$ 共享一个共同的延迟，我们记为 $\\tau_{12}$。组织 $3$、$4$ 和 $5$ 各有其独立的延迟，记为 $\\tau_3$、$\\tau_4$ 和 $\\tau_5$。这些延迟之间没有提到其他约束。需要估计的参数集是 $\\{\\tau_{12}, \\tau_3, \\tau_4, \\tau_5\\}$。\n    自由延迟参数数量 = $1 + 1 + 1 + 1 = 4$。\n\n4.  **初始条件参数 ($x_{0,t}$):**\n    初始条件不是为每个组织独立估计的。相反，它们通过一个“简约的线性协变量结构”来建模：$x_{0,t} = x_0 + \\delta q_t$。组织水平的协变量 $q_t$ 是已知值。需要估计的参数是截距 $x_0$ 和斜率 $\\delta$，它们在所有组织间共享。\n    自由初始条件参数数量 = $2$ (即 $x_0$ 和 $\\delta$)。\n\n5.  **测量噪声方差参数 ($\\sigma_t^2$):**\n    测量噪声被建模为具有组织特异性方差 $\\sigma_t^2$ 的独立高斯分布。对于 $5$ 个组织，这通常意味着有 $5$ 个参数：$\\{\\sigma_1^2, \\sigma_2^2, \\sigma_3^2, \\sigma_4^2, \\sigma_5^2\\}$。然而，给出了一个对称性约束：$\\sigma_4^2 = \\sigma_5^2$。这意味着一个单一参数代表了组织 $4$ 和组织 $5$ 的方差。其他方差 $\\sigma_1^2$、$\\sigma_2^2$ 和 $\\sigma_3^2$ 是独立的。因此，需要估计的独立方差参数集是 $\\{\\sigma_1^2, \\sigma_2^2, \\sigma_3^2, \\sigma_{4,5}^2\\}$，其中 $\\sigma_{4,5}^2$ 是组织 $4$ 和 $5$ 的共同方差。\n    自由方差参数数量 = $1 + 1 + 1 + 1 = 4$。\n\n6.  **基线趋势参数 ($b_0, b_1$):**\n    一个共享的基线趋势，由函数 $b_0 + b_1 g(t)$ 描述，被包含在模型中。函数 $g(\\cdot)$ 是已知的。需要估计的参数是系数 $b_0$ 和 $b_1$。这些参数在所有组织间是通用的。\n    自由基线参数数量 = $2$。\n\n**总参数数量 ($k$):**\n为了找到自由参数的总数 $k$，我们将每个类别的计数相加：\n$$ k = (\\text{动力学}) + (\\text{振幅}) + (\\text{延迟}) + (\\text{初始条件}) + (\\text{方差}) + (\\text{基线}) $$\n$$ k = 3 + 4 + 4 + 2 + 4 + 2 $$\n$$ k = 19 $$\n\n该模型的自由、可估计参数总数为 $19$。\n\n现在，我们评估给定的选项。\n\nA. $k = 17$: **不正确**。这个值小于推导出的计数 $19$。导致 $17$ 的错误可能包括，例如，错误地只计算了 $2$ 个噪声方差参数而不是 $4$ 个。\n\nB. $k = 19$: **正确**。该值与系统推导出的自由参数总数相匹配。\n\nC. $k = 20$: **不正确**。这个值可能是由于未能正确考虑振幅参数的约束而得到的。如果将所有 $5$ 个振幅都算作自由参数，总数将是 $3 + 5 + 4 + 2 + 4 + 2 = 20$。这忽略了 $\\sum A_t = 1$ 这个约束会减少一个自由度的事实。\n\nD. $k = 23$: **不正确**。这个值明显高于正确计数。它很可能源于多个计数错误。例如，如果忽略振幅约束（增加 $1$ 个参数），并且也忽略了初始条件的简约结构，而是计算了 $5$ 个独立的初始条件（增加 $5 - 2 = 3$ 个参数），那么总数将是 $19 + 1 + 3 = 23$。这表明未能正确解释模型的约束和简约结构。\n\nE. $k = 15$: **不正确**。这个计数太低。它可能是由于错误地施加了额外的约束而产生的。例如，假设所有 $5$ 个延迟都是共享的（即只有 $1$ 个延迟参数，减少了 $3$ 个），并且只估计单个初始条件参数 $x_0$（减少了 $1$ 个），将导致 $19 - 3 - 1 = 15$。这与模型参数化的明确描述相矛盾。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "除了简单地计算参数数量，计算 BIC 还需要找到给定模型下数据的最大化对数似然。本练习提供了一个动手实践的机会，为一个泊松广义线性模型计算 BIC，这是一种分析神经元放电计数数据的常用工具。您将从模型的概率质量函数和给定的参数估计出发，将似然的统计基础与最终的 BIC 值联系起来。",
            "id": "3903998",
            "problem": "一位系统神经科学家使用广义线性模型 (GLM) 对单个神经元在 $10\\,\\text{ms}$ 时间窗内记录的脉冲计数进行建模，该模型采用泊松观测模型和标准对数连接函数。协变量是刺激幅度 $s_i \\in \\mathbb{R}$ 和一个二元指示变量 $h_i \\in \\{0,1\\}$，后者表示紧邻的前一个时间窗内是否发生了脉冲。对于第 $i$ 次观测，线性预测器为 $x_i^{\\top}\\beta = \\beta_0 + \\beta_1 s_i + \\beta_2 h_i$，泊松计数的条件均值为 $\\mu_i$。\n\n记录了十二个独立的观测值 $(s_i, h_i, y_i)$，如下所示：\n$(s_1, h_1, y_1) = (0.1, 0, 0)$,\n$(s_2, h_2, y_2) = (0.3, 0, 0)$,\n$(s_3, h_3, y_3) = (0.5, 0, 1)$,\n$(s_4, h_4, y_4) = (0.7, 0, 1)$,\n$(s_5, h_5, y_5) = (0.9, 0, 1)$,\n$(s_6, h_6, y_6) = (0.2, 1, 0)$,\n$(s_7, h_7, y_7) = (0.4, 1, 0)$,\n$(s_8, h_8, y_8) = (0.6, 1, 1)$,\n$(s_9, h_9, y_9) = (0.8, 1, 1)$,\n$(s_{10}, h_{10}, y_{10}) = (1.0, 1, 2)$,\n$(s_{11}, h_{11}, y_{11}) = (0.0, 0, 0)$,\n$(s_{12}, h_{12}, y_{12}) = (0.5, 1, 1)$.\n\n最大似然拟合得到的系数估计值为 $\\hat{\\beta} = (\\beta_0, \\beta_1, \\beta_2)$，其中 $\\beta_0 = -2.5$，$\\beta_1 = 1.2$ 和 $\\beta_2 = -0.6$。从第一性原理出发，使用泊松概率质量函数和 GLM 标准对数连接函数，推导在拟合模型下观测数据的最大化似然值 $\\hat{L}$。然后，使用 $n = 12$ 个观测值和等于估计系数数量的自由参数个数，计算该拟合模型的贝叶斯信息准则 (BIC)。\n\n在整个计算过程中使用自然对数。将最终的 BIC 值表示为一个无量纲实数。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算一个拟合了神经元脉冲计数数据的广义线性模型 (GLM) 的贝叶斯信息准则 (BIC)。这首先需要根据给定的模型和估计的参数，推导出数据的最大化对数似然。\n\n模型的第一性原理如下。观测到的时间窗 $i$ 内的脉冲计数 $y_i$ 假定服从均值为 $\\mu_i$ 的泊松分布。其概率质量函数 (PMF) 为：\n$$ P(y_i | \\mu_i) = \\frac{\\mu_i^{y_i} \\exp(-\\mu_i)}{y_i!} $$\n该模型是一个带有标准对数连接函数的 GLM，它将均值 $\\mu_i$ 与线性预测器 $\\eta_i$ 联系起来：\n$$ \\ln(\\mu_i) = \\eta_i $$\n这意味着 $\\mu_i = \\exp(\\eta_i)$。线性预测器是协变量 $s_i$ 和 $h_i$ 的函数：\n$$ \\eta_i = x_i^{\\top}\\beta = \\beta_0 + \\beta_1 s_i + \\beta_2 h_i $$\n对于一组 $n$ 个独立观测值，总似然 $L$ 是各个概率的乘积，$L = \\prod_{i=1}^{n} P(y_i|\\mu_i)$。处理对数似然 $\\ln(L)$ 更为方便：\n$$ \\ln(L) = \\sum_{i=1}^{n} \\ln(P(y_i|\\mu_i)) = \\sum_{i=1}^{n} \\left( y_i \\ln(\\mu_i) - \\mu_i - \\ln(y_i!) \\right) $$\n代入 GLM 方程，对数似然成为参数向量 $\\beta$ 的函数：\n$$ \\ln(L(\\beta)) = \\sum_{i=1}^{n} \\left( y_i (x_i^{\\top}\\beta) - \\exp(x_i^{\\top}\\beta) - \\ln(y_i!) \\right) $$\n问题提供了系数的最大似然估计 (MLE)，$\\hat{\\beta} = (\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_2)^{\\top}$，其中 $\\hat{\\beta}_0 = -2.5$，$\\hat{\\beta}_1 = 1.2$，且 $\\hat{\\beta}_2 = -0.6$。最大化对数似然，记作 $\\ln(\\hat{L})$，是通过将这些估计值代入对数似然函数得到的。设 $\\hat{\\eta}_i = x_i^{\\top}\\hat{\\beta}$ 为第 $i$ 次观测的估计线性预测器，$\\hat{\\mu}_i = \\exp(\\hat{\\eta}_i)$ 为估计的均值。\n$$ \\ln(\\hat{L}) = \\sum_{i=1}^{n} \\left( y_i \\hat{\\eta}_i - \\hat{\\mu}_i - \\ln(y_i!) \\right) $$\n我们有 $n=12$ 个观测值。现在我们为每个观测 $i=1, \\dots, 12$ 计算 $\\hat{\\eta}_i$：\n$y = (0, 0, 1, 1, 1, 0, 0, 1, 1, 2, 0, 1)$。\n1.  $(s_1, h_1) = (0.1, 0) \\implies \\hat{\\eta}_1 = -2.5 + 1.2(0.1) - 0.6(0) = -2.38$\n2.  $(s_2, h_2) = (0.3, 0) \\implies \\hat{\\eta}_2 = -2.5 + 1.2(0.3) - 0.6(0) = -2.14$\n3.  $(s_3, h_3) = (0.5, 0) \\implies \\hat{\\eta}_3 = -2.5 + 1.2(0.5) - 0.6(0) = -1.90$\n4.  $(s_4, h_4) = (0.7, 0) \\implies \\hat{\\eta}_4 = -2.5 + 1.2(0.7) - 0.6(0) = -1.66$\n5.  $(s_5, h_5) = (0.9, 0) \\implies \\hat{\\eta}_5 = -2.5 + 1.2(0.9) - 0.6(0) = -1.42$\n6.  $(s_6, h_6) = (0.2, 1) \\implies \\hat{\\eta}_6 = -2.5 + 1.2(0.2) - 0.6(1) = -2.86$\n7.  $(s_7, h_7) = (0.4, 1) \\implies \\hat{\\eta}_7 = -2.5 + 1.2(0.4) - 0.6(1) = -2.62$\n8.  $(s_8, h_8) = (0.6, 1) \\implies \\hat{\\eta}_8 = -2.5 + 1.2(0.6) - 0.6(1) = -2.38$\n9.  $(s_9, h_9) = (0.8, 1) \\implies \\hat{\\eta}_9 = -2.5 + 1.2(0.8) - 0.6(1) = -2.14$\n10. $(s_{10}, h_{10}) = (1.0, 1) \\implies \\hat{\\eta}_{10} = -2.5 + 1.2(1.0) - 0.6(1) = -1.90$\n11. $(s_{11}, h_{11}) = (0.0, 0) \\implies \\hat{\\eta}_{11} = -2.5 + 1.2(0.0) - 0.6(0) = -2.50$\n12. $(s_{12}, h_{12}) = (0.5, 1) \\implies \\hat{\\eta}_{12} = -2.5 + 1.2(0.5) - 0.6(1) = -2.50$\n\n接下来，我们计算 $\\ln(\\hat{L})$ 求和式中的三个部分：\n第一部分是 $\\sum_{i=1}^{12} y_i \\hat{\\eta}_i$：\n$$ \\sum y_i \\hat{\\eta}_i = (0)\\hat{\\eta}_1 + (0)\\hat{\\eta}_2 + (1)(-1.90) + (1)(-1.66) + (1)(-1.42) + (0)\\hat{\\eta}_6 + (0)\\hat{\\eta}_7 + (1)(-2.38) + (1)(-2.14) + (2)(-1.90) + (0)\\hat{\\eta}_{11} + (1)(-2.50) $$\n$$ \\sum y_i \\hat{\\eta}_i = -1.90 - 1.66 - 1.42 - 2.38 - 2.14 - 3.80 - 2.50 = -15.80 $$\n第二部分是 $\\sum_{i=1}^{12} \\hat{\\mu}_i = \\sum_{i=1}^{12} \\exp(\\hat{\\eta}_i)$：\n$$ \\sum \\hat{\\mu}_i = \\exp(-2.38) + \\exp(-2.14) + \\exp(-1.90) + \\exp(-1.66) + \\exp(-1.42) + \\exp(-2.86) + \\exp(-2.62) + \\exp(-2.38) + \\exp(-2.14) + \\exp(-1.90) + \\exp(-2.50) + \\exp(-2.50) $$\n$$ \\sum \\hat{\\mu}_i \\approx 0.09255 + 0.11766 + 0.14957 + 0.18992 + 0.24171 + 0.05727 + 0.07280 + 0.09255 + 0.11766 + 0.14957 + 0.08208 + 0.08208 \\approx 1.44542 $$\n第三部分是 $\\sum_{i=1}^{12} \\ln(y_i!)$。由于 $\\ln(0!) = \\ln(1) = 0$，我们只需要考虑 $y_i > 0$ 的情况。唯一 $y_i > 1$ 的值是 $y_{10}=2$。\n$$ \\sum \\ln(y_i!) = \\ln(y_{10}!) = \\ln(2!) = \\ln(2) \\approx 0.69315 $$\n现在，我们组合这些部分来求得 $\\ln(\\hat{L})$：\n$$ \\ln(\\hat{L}) = \\sum y_i \\hat{\\eta}_i - \\sum \\hat{\\mu}_i - \\sum \\ln(y_i!) \\approx -15.80 - 1.44542 - 0.69315 = -17.93857 $$\n贝叶斯信息准则 (BIC) 定义为：\n$$ \\text{BIC} = k \\ln(n) - 2 \\ln(\\hat{L}) $$\n其中 $n$ 是观测值的数量，$k$ 是模型中自由参数的数量。\n在本问题中，$n=12$。模型有 $k=3$ 个自由参数，即系数 $\\beta_0, \\beta_1, \\beta_2$。\n代入数值：\n$$ \\text{BIC} = 3 \\ln(12) - 2(-17.93857) $$\n使用 $\\ln(12) \\approx 2.48491$：\n$$ \\text{BIC} \\approx 3(2.48491) + 2(17.93857) = 7.45473 + 35.87714 \\approx 43.33187 $$\n将结果四舍五入到四位有效数字，我们得到 $43.33$。",
            "answer": "$$\\boxed{43.33}$$"
        },
        {
            "introduction": "BIC 的一个关键特征是其惩罚项 $k \\ln(n)$，它会随着样本量 $n$ 的增加而增大。本练习通过比较两个嵌套的高斯线性模型来探讨这一特性的实际影响。通过为一个固定数据集计算 BIC，然后分析其渐近行为，您将对样本量如何影响 BIC 在更简单和更复杂模型之间的选择获得更深刻的直觉。",
            "id": "4928639",
            "problem": "一位生物统计学家正在比较两个用于连续生物标志物 $Y$ 的嵌套高斯线性回归模型。这两个模型都基于独立高斯误差和未知方差的标准假设。模型 $\\mathcal{M}_{0}$ 包含一个截距项、年龄和性别（因此其均值结构有 $p_{0}=3$ 个回归参数），而模型 $\\mathcal{M}_{1}$ 在 $\\mathcal{M}_{0}$ 的基础上增加了治疗和一个年龄与治疗的交互作用（因此其均值结构有 $p_{1}=5$ 个回归参数）。两个模型都包含一个单一的残差方差参数。\n\n在一项有 $n=180$ 名独立参与者的研究中，通过普通最小二乘拟合后，模型 $\\mathcal{M}_{0}$ 的残差平方和为 $\\mathrm{RSS}_{0}=162.0$，模型 $\\mathcal{M}_{1}$ 的残差平方和为 $\\mathrm{RSS}_{1}=155.0$。\n\n(a) 仅使用高斯似然的基本原理和贝叶斯信息准则 (BIC) 的定义，计算每个模型的 BIC。设模型 $\\mathcal{M}_{j}$ 的自由参数总数为 $k_{j}=p_{j}+1$（包括截距项在内的 $p_{j}$ 个回归系数，加上残差方差）。报告两个 BIC 值，并四舍五入到四位有效数字。\n\n(b) 现在考虑通过从相同的数据生成过程中重复抽样来增加样本量。假设随着 $n$ 的增长，每个观测的残差平方和趋于稳定，使得 $\\mathrm{RSS}_{0}\\approx n r_{0}$ 和 $\\mathrm{RSS}_{1}\\approx n r_{1}$，其中常数 $r_{0}=0.90$ 和 $r_{1}=0.86$。令 $\\Delta k = k_{1}-k_{0}$。从基本原理出发，推导出一个精确的闭式表达式（如果需要，可以引入特殊函数），用于计算最小样本量 $n_{\\ast}$，使得对于所有 $n \\ge n_{\\ast}$，$\\mathcal{M}_{1}$ 的 BIC 严格小于 $\\mathcal{M}_{0}$ 的 BIC。用 $r_{0}$、$r_{1}$ 和 $\\Delta k$ 表示 $n_{\\ast}$，然后将您的表达式代入上述数值。\n\n将 (a) 部分中的任何中间数值 BIC 值四舍五入到四位有效数字。对于最终交付成果，请提供 (b) 部分中 $n_{\\ast}$ 的精确解析表达式；不要对表达式进行近似或四舍五入。最终答案必须是单一的闭式解析表达式。",
            "solution": "我们从具有独立误差的高斯线性模型开始。在模型 $\\mathcal{M}_{j}$下，我们假定\n$$\nY \\sim \\mathcal{N}\\!\\left(X_{j}\\beta_{j},\\,\\sigma^{2} I_{n}\\right),\n$$\n其中有 $k_{j}$ 个自由参数，包括 $p_{j}$ 个回归系数（含截距项）和残差方差 $\\sigma^{2}$。对于方差未知的线性回归，其最大化高斯对数似然是通过将最大似然估计量 $\\hat{\\beta}_{j}$ 和 $\\hat{\\sigma}^{2}_{j}=\\mathrm{RSS}_{j}/n$ 代入对数似然函数得到的。得到的最大化对数似然为\n$$\n\\hat{\\ell}_{j}\n\\,=\\, -\\frac{n}{2}\\left[\\ln(2\\pi) + 1 + \\ln\\!\\left(\\frac{\\mathrm{RSS}_{j}}{n}\\right)\\right].\n$$\n贝叶斯信息准则 (BIC) 定义为\n$$\n\\mathrm{BIC}_{j} \\,=\\, -2\\,\\hat{\\ell}_{j} \\;+\\; k_{j}\\,\\ln n\n\\,=\\, n\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{\\mathrm{RSS}_{j}}{n}\\right)\\right] \\;+\\; k_{j}\\,\\ln n.\n$$\n(a) 部分。对于模型 $\\mathcal{M}_{0}$，我们有 $p_{0}=3$，因此 $k_{0}=p_{0}+1=4$。对于模型 $\\mathcal{M}_{1}$，$p_{1}=5$，因此 $k_{1}=p_1+1=6$。当 $n=180$，$\\mathrm{RSS}_{0}=162.0$，$\\mathrm{RSS}_{1}=155.0$ 时，计算\n$$\n\\ln n \\,=\\, \\ln(180),\n\\quad\n\\frac{\\mathrm{RSS}_{0}}{n} \\,=\\, \\frac{162.0}{180} \\,=\\, 0.90,\n\\quad\n\\frac{\\mathrm{RSS}_{1}}{n} \\,=\\, \\frac{155.0}{180} \\,=\\, \\frac{31}{36}.\n$$\n我们计算\n$$\n-2\\,\\hat{\\ell}_{0}\n= n\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{\\mathrm{RSS}_{0}}{n}\\right)\\right]\n= 180\\left[\\ln(2\\pi)+1+\\ln(0.90)\\right],\n$$\n和\n$$\n-2\\,\\hat{\\ell}_{1}\n= 180\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{31}{36}\\right)\\right].\n$$\n那么\n$$\n\\mathrm{BIC}_{0}\n= -2\\,\\hat{\\ell}_{0} + k_{0}\\ln n\n= 180\\left[\\ln(2\\pi)+1+\\ln(0.90)\\right] + 4\\,\\ln(180),\n$$\n$$\n\\mathrm{BIC}_{1}\n= -2\\,\\hat{\\ell}_{1} + k_{1}\\ln n\n= 180\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{31}{36}\\right)\\right] + 6\\,\\ln(180).\n$$\n数值上，\n$$\n\\ln(2\\pi)\\approx 1.837877,\\quad\n\\ln(180)\\approx 5.192957,\\quad\n\\ln(0.90)\\approx -0.105361,\\quad\n\\ln\\!\\left(\\frac{31}{36}\\right)\\approx -0.149532.\n$$\n因此，\n$$\n-2\\,\\hat{\\ell}_{0}\\approx 180\\left[1.837877+1-0.105361\\right]\\approx 491.853,\n$$\n$$\n\\mathrm{BIC}_{0}\\approx 491.853 + 4\\times 5.192957 \\approx 512.625,\n$$\n和\n$$\n-2\\,\\hat{\\ell}_{1}\\approx 180\\left[1.837877+1-0.149532\\right]\\approx 483.902,\n$$\n$$\n\\mathrm{BIC}_{1}\\approx 483.902 + 6\\times 5.192957 \\approx 515.060.\n$$\n四舍五入到四位有效数字，$\\mathrm{BIC}_{0}\\approx 512.6$ 且 $\\mathrm{BIC}_{1}\\approx 515.1$。因此，对于 $n=180$ 的情况，贝叶斯信息准则更倾向于选择更简单的模型 $\\mathcal{M}_{0}$。\n\n(b) 部分。我们希望找到最小的样本量 $n_*$ 使得对于所有 $n \\ge n_*$，$\\mathrm{BIC}_{1}(n)  \\mathrm{BIC}_{0}(n)$。这等价于找到不等式 $\\Delta \\mathrm{BIC}(n) = \\mathrm{BIC}_{1}(n) - \\mathrm{BIC}_{0}(n)  0$ 的解。利用 BIC 的定义和渐近假设 $\\mathrm{RSS}_{j} \\approx n r_j$，我们可以写出 $\\Delta \\mathrm{BIC}(n)$ 的表达式。许多项会在相减时抵消：\n$$\n\\begin{aligned}\n\\Delta \\mathrm{BIC}(n) = \\left( n\\left[\\ln(2\\pi)+1+\\ln(r_1)\\right] + k_1 \\ln n \\right) - \\left( n\\left[\\ln(2\\pi)+1+\\ln(r_0)\\right] + k_0 \\ln n \\right) \\\\\n= n(\\ln(r_1) - \\ln(r_0)) + (k_1 - k_0)\\ln n \\\\\n= n \\ln\\left(\\frac{r_1}{r_0}\\right) + \\Delta k \\ln n\n\\end{aligned}\n$$\n其中 $\\Delta k = k_1 - k_0 = 6 - 4 = 2$。我们要求解的是 $\\Delta \\mathrm{BIC}(n) = 0$ 的根，以找到偏好发生变化的临界点。\n$$\nn \\ln\\left(\\frac{r_1}{r_0}\\right) + \\Delta k \\ln n = 0\n$$\n令 $c = \\ln(r_1/r_0)$。方程变为 $cn + \\Delta k \\ln n = 0$。这是一个关于 $n$ 的超越方程，可以用朗伯 W 函数 (Lambert W function) 求解。为了将其转换为标准形式 $z e^z = K$，我们进行如下代数变换：\n$$\n\\frac{c}{\\Delta k} n = -\\ln n \\implies e^{\\frac{c}{\\Delta k} n} = e^{-\\ln n} = \\frac{1}{n} \\implies n e^{\\frac{c}{\\Delta k} n} = 1\n$$\n令 $z = \\frac{c}{\\Delta k} n$。那么 $n = \\frac{\\Delta k}{c} z$。代入上式：\n$$\n\\left(\\frac{\\Delta k}{c} z\\right) e^z = 1 \\implies z e^z = \\frac{c}{\\Delta k}\n$$\n因此，$z$ 的解由朗伯 W 函数给出：$z = W\\left(\\frac{c}{\\Delta k}\\right)$。代入 $n$ 的表达式：\n$$\nn_* = \\frac{\\Delta k}{c} z = \\frac{\\Delta k}{c} W\\left(\\frac{c}{\\Delta k}\\right) = \\frac{\\Delta k}{\\ln(r_1/r_0)} W\\left(\\frac{\\ln(r_1/r_0)}{\\Delta k}\\right)\n$$\n我们代入数值：$r_1/r_0 = 0.86/0.90 = 43/45$。朗伯 W 函数的参数 $\\frac{c}{\\Delta k} = \\frac{\\ln(43/45)}{2} \\approx -0.0227$。这个值在 $(-1/e, 0)$ 区间内，因此存在两个实数解，$W_0$ 和 $W_{-1}$。函数 $f(n) = n \\ln(r_1/r_0) + \\Delta k \\ln n$ 从 $n \\to 0^+$ 时的 $-\\infty$ 开始，增加到一个最大值，然后再次减少到 $-\\infty$。因此，它会两次穿过零点。我们感兴趣的是较大的那个根，因为对于所有大于该根的 $n$，$\\Delta \\mathrm{BIC}$ 将是负的（即 $\\mathcal{M}_1$ 更优）。较大的根对应于 $W_{-1}$ 分支。因此，临界样本量 $n_*$ 的精确表达式是：\n$$\nn_* = \\frac{2}{\\ln(43/45)} W_{-1}\\left(\\frac{\\ln(43/45)}{2}\\right)\n$$\n这与要求解的表达式相匹配。",
            "answer": "$$\\boxed{\\frac{2}{\\ln\\!\\left(\\frac{43}{45}\\right)}\\,W_{-1}\\!\\left(\\frac{\\ln\\!\\left(\\frac{43}{45}\\right)}{2}\\right)}$$"
        }
    ]
}