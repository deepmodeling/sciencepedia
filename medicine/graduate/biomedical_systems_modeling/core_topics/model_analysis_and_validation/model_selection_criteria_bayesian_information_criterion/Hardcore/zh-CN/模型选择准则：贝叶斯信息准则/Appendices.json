{
    "hands_on_practices": [
        {
            "introduction": "在应用贝叶斯信息准则（BIC）之前，我们必须掌握关键的第一步：确定模型的自由参数数量 $k$。在具有共享参数和复杂约束的生物医学模型中，这并非总是直截了当。本练习  将引导您剖析一个真实的多组织模型，以准确计算其自由度，这是任何模型选择任务中的一项基本技能。",
            "id": "3903943",
            "problem": "在用于示踪剂动力学生物医学系统建模的多组织非线性回归中，您需要联合拟合来自 $T = 5$ 个组织（索引为 $t \\in \\{1,2,3,4,5\\}$）的数据。对于每个组织，您观察到的时程测量值被建模为 $y_{t,i} = f(t_{t,i}; \\boldsymbol{\\theta}_g, \\boldsymbol{\\phi}_t) + \\varepsilon_{t,i}$，其中 $f(\\cdot)$ 是一个非线性机理模型，此处不需要其精确形式。联合拟合是在以下具有科学动机的结构下通过最大似然法进行的：\n- 有一个长度为 $4$ 的全局动力学参数向量 $\\boldsymbol{\\theta}_g$，该向量在所有组织间共享，代表共同的转运和酶促速率。这 $4$ 个全局动力学参数中的一个已通过外部校准实验先验固定，在本次拟合中不进行重新估计。\n- 每个组织都有一个幅度参数 $A_t$，该参数被约束以表示分数贡献，约束条件为 $\\sum_{t=1}^{5} A_t = 1$。\n- 每个组织都有一个有效延迟参数，但由于共享的血管通路，组织 $1$ 和 $2$ 共享一个共同的延迟（记为 $\\tau_{12}$），而组织 $3$、$4$ 和 $5$ 各自拥有其独立的延迟（$\\tau_3$、$\\tau_4$、$\\tau_5$）。这些延迟之间没有额外的约束。\n- 组织 $t$ 中驱动 $f(\\cdot)$ 的状态的初始条件是未知的。您没有估计 $5$ 个不相关的初始条件，而是施加了一个简约的线性协变量结构 $x_{0,t} = x_0 + \\delta q_t$，其中 $q_t$ 是已知的、不同的组织水平协变量，而 $(x_0,\\delta)$ 是所有组织共享的参数。\n- 测量噪声被建模为具有组织特异性方差的独立高斯分布：$\\varepsilon_{t,i} \\sim \\mathcal{N}(0,\\sigma_t^2)$。然而，成像方案的对称性意味着 $\\sigma_4^2 = \\sigma_5^2$，而 $\\sigma_1^2$、$\\sigma_2^2$ 和 $\\sigma_3^2$ 均彼此独立且不相关。\n- 一个共享的基线趋势 $b_0 + b_1 g(t)$（其中 $g(\\cdot)$ 是已知的标量函数）被添加在 $f(\\cdot)$ 内部，并由两个在所有组织间通用的系数 $(b_0,b_1)$ 参数化。\n\n模型的所有其他方面都是完全指定和已知的。当使用贝叶斯信息准则 (BIC) 将此模型与其他备选模型进行比较时，您必须提供参数数量 $k$，即在给定约束条件下，出现在 $5$ 个组织的联合似然中的自由、可估计参数的数量。\n\n对于该模型，哪个 $k$ 值是正确的？\n\nA. $k = 17$\n\nB. $k = 19$\n\nC. $k = 20$\n\nD. $k = 23$\n\nE. $k = 15$",
            "solution": "该问题要求确定一个多组织非线性回归模型的联合最大似然拟合中自由、可估计参数的总数，记为 $k$。$k$ 的值对于计算贝叶斯信息准则 (BIC) 至关重要，其定义为 $\\text{BIC} = -2 \\ln(\\hat{L}) + k \\ln(N)$，其中 $\\hat{L}$ 是最大化似然值，而 $N$ 是观测总数。任务是根据所提供的模型结构和约束来计算 $k$。我们将通过系统地枚举模型每个组成部分的参数来进行。\n\n1.  **全局动力学参数 ($\\boldsymbol{\\theta}_g$):**\n    问题陈述，有一个长度为 $4$ 的全局动力学参数向量 $\\boldsymbol{\\theta}_g$。这些参数在所有 $T=5$ 个组织间共享。然而，这 $4$ 个参数中的一个被指定为通过外部实验先验固定的。因此，它在本次拟合过程中不被估计。该组的自由参数数量是总数减去固定参数的数量。\n    动力学参数数量 = $4 - 1 = 3$。\n\n2.  **幅度参数 ($A_t$):**\n    $5$ 个组织中的每一个都有一个幅度参数 $A_t$。这给出了一个包含 $5$ 个参数的集合 $\\{A_1, A_2, A_3, A_4, A_5\\}$。这些参数受到线性约束 $\\sum_{t=1}^{5} A_t = 1$ 的限制。对一组 $n$ 个参数施加一个线性约束会使自由参数的数量减少 $1$。一旦估计了其中 $4$ 个幅度，第五个就由该约束确定（例如，$A_5 = 1 - \\sum_{t=1}^{4} A_t$）。\n    自由幅度参数数量 = $5 - 1 = 4$。\n\n3.  **延迟参数 ($\\tau_t$):**\n    延迟参数的结构有明确定义。组织 $1$ 和 $2$ 共享一个共同的延迟，我们记为 $\\tau_{12}$。组织 $3$、$4$ 和 $5$ 各自有其独立的延迟，记为 $\\tau_3$、$\\tau_4$ 和 $\\tau_5$。这些延迟之间没有提及其他约束。要估计的参数集是 $\\{\\tau_{12}, \\tau_3, \\tau_4, \\tau_5\\}$。\n    自由延迟参数数量 = $1 + 1 + 1 + 1 = 4$。\n\n4.  **初始条件参数 ($x_{0,t}$):**\n    初始条件不是为每个组织独立估计的。相反，它们由一个“简约的线性协变量结构”建模：$x_{0,t} = x_0 + \\delta q_t$。组织水平的协变量 $q_t$ 是已知值。要估计的参数是截距 $x_0$ 和斜率 $\\delta$，它们在所有组织间共享。\n    自由初始条件参数数量 = $2$ (即 $x_0$ 和 $\\delta$)。\n\n5.  **测量噪声方差参数 ($\\sigma_t^2$):**\n    测量噪声被建模为具有组织特异性方差 $\\sigma_t^2$ 的独立高斯分布。对于 $5$ 个组织，这通常意味着有 $5$ 个参数：$\\{\\sigma_1^2, \\sigma_2^2, \\sigma_3^2, \\sigma_4^2, \\sigma_5^2\\}$。然而，有一个给定的对称性约束：$\\sigma_4^2 = \\sigma_5^2$。这意味着一个参数同时代表组织 $4$ 和组织 $5$ 的方差。其他方差 $\\sigma_1^2$、$\\sigma_2^2$ 和 $\\sigma_3^2$ 是独立的。因此，要估计的唯一方差参数集是 $\\{\\sigma_1^2, \\sigma_2^2, \\sigma_3^2, \\sigma_{4,5}^2\\}$，其中 $\\sigma_{4,5}^2$ 是组织 $4$ 和 $5$ 的共同方差。\n    自由方差参数数量 = $1 + 1 + 1 + 1 = 4$。\n\n6.  **基线趋势参数 ($b_0, b_1$):**\n    一个由函数 $b_0 + b_1 g(t)$ 描述的共享基线趋势被包含在模型中。函数 $g(\\cdot)$ 是已知的。要估计的参数是系数 $b_0$ 和 $b_1$。这些参数在所有组织间是通用的。\n    自由基线参数数量 = $2$。\n\n**参数总数 ($k$):**\n为了找到自由参数的总数 $k$，我们将每个类别的计数相加：\n$$ k = (\\text{动力学}) + (\\text{幅度}) + (\\text{延迟}) + (\\text{初始条件}) + (\\text{方差}) + (\\text{基线}) $$\n$$ k = 3 + 4 + 4 + 2 + 4 + 2 $$\n$$ k = 19 $$\n\n该模型的自由、可估计参数总数为 $19$。\n\n现在，我们评估给出的选项。\n\nA. $k = 17$: **错误**。该值小于推导出的数量 $19$。导致 $17$ 的错误可能涉及，例如，错误地只计算了 $2$ 个噪声方差参数而不是 $4$ 个。\n\nB. $k = 19$: **正确**。该值与系统推导出的自由参数总数相符。\n\nC. $k = 20$: **错误**。这个值可能是由于未能考虑幅度参数的约束而得到的。如果将所有 $5$ 个幅度都算作自由参数，总数将是 $3 + 5 + 4 + 2 + 4 + 2 = 20$。这忽略了 $\\sum A_t = 1$ 会减少一个自由度的事实。\n\nD. $k = 23$: **错误**。该值显著高于正确计数。它很可能由多重计数错误导致。例如，如果忽略幅度约束（增加 $1$ 个参数），并且也忽略了初始条件的简约结构，而是计算 $5$ 个独立的初始条件（增加 $5 - 2 = 3$ 个参数），则总数将为 $19 + 1 + 3 = 23$。这表明未能正确理解模型的约束和简约结构。\n\nE. $k = 15$: **错误**。这个计数太低了。它可能源于错误地施加了额外的约束。例如，假设所有 $5$ 个延迟都是共享的（即只有 $1$ 个延迟参数，减少了 $3$ 个），并且只估计一个初始条件参数 $x_0$（减少了 $1$ 个），将导致 $19 - 3 - 1 = 15$。这与模型参数化的明确描述相矛盾。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "贝叶斯信息准则（BIC）旨在平衡模型的拟合优度与复杂度，而这种平衡关系受样本量的动态影响。本练习  通过比较两个嵌套的线性模型，深入探讨了 BIC 的这一核心动态。您将推导随着样本量的增加，更复杂的模型在何种条件下会变得更优，从而加深对 BIC 关键理论特性——模型选择一致性的理解。",
            "id": "4928639",
            "problem": "一位生物统计学家正在比较两个用于连续生物标志物 $Y$ 的嵌套高斯线性回归模型。这些模型基于独立高斯误差和未知方差的标准假设。模型 $\\mathcal{M}_{0}$ 包含一个截距、年龄和性别（因此均值结构有 $p_{0}=3$ 个回归参数），而模型 $\\mathcal{M}_{1}$ 在 $\\mathcal{M}_{0}$ 的基础上增加了治疗和一个年龄与治疗的交互作用（因此均值结构有 $p_{1}=5$ 个回归参数）。两个模型都包含一个单一的残差方差参数。\n\n在一项有 $n=180$ 名独立参与者的研究中，经过普通最小二乘拟合后，$\\mathcal{M}_{0}$ 的残差平方和为 $\\mathrm{RSS}_{0}=162.0$，$\\mathcal{M}_{1}$ 的残差平方和为 $\\mathrm{RSS}_{1}=155.0$。\n\n(a) 仅使用高斯似然的第一性原理和贝叶斯信息准则（BIC）的定义，计算每个模型的 BIC，其中模型 $\\mathcal{M}_{j}$ 的自由参数总数为 $k_{j}=p_{j}+1$（包括截距在内的 $p_{j}$ 个回归系数，加上残差方差）。报告两个 BIC 值，四舍五入到四位有效数字。\n\n(b) 现在考虑通过从相同的数据生成过程中重复抽样来增加样本量。假设当 $n$ 增大时，每个观测的残差平方和趋于稳定，使得 $\\mathrm{RSS}_{0}\\approx n r_{0}$ 和 $\\mathrm{RSS}_{1}\\approx n r_{1}$，其中常数 $r_{0}=0.90$ 和 $r_{1}=0.86$。令 $\\Delta k = k_{1}-k_{0}$。从第一性原理出发，推导出一个精确的闭式表达式（如果需要，可以引入特殊函数），用于计算最小样本量 $n_{\\ast}$，使得对于所有 $n \\ge n_{\\ast}$，$\\mathcal{M}_{1}$ 的 BIC 严格小于 $\\mathcal{M}_{0}$ 的 BIC。用 $r_{0}$、$r_{1}$ 和 $\\Delta k$ 表示 $n_{\\ast}$，然后将你的表达式具体化为上述数值。\n\n将 (a) 部分中的任何中间 BIC 数值四舍五入到四位有效数字。对于最终交付成果，请提供 (b) 部分中 $n_{\\ast}$ 的精确解析表达式；不要对表达式进行近似或四舍五入。最终答案必须是单一的闭式解析表达式。",
            "solution": "我们从具有独立误差的高斯线性模型开始。在模型 $\\mathcal{M}_{j}$ 下，我们假定\n$$\nY \\sim \\mathcal{N}\\!\\left(X_{j}\\beta_{j},\\,\\sigma^{2} I_{n}\\right),\n$$\n其中有 $k_{j}$ 个自由参数，包括 $p_{j}$ 个回归系数（含截距）和残差方差 $\\sigma^{2}$。对于未知方差的线性回归，最大化高斯对数似然是通过将最大似然估计量 $\\hat{\\beta}_{j}$ 和 $\\hat{\\sigma}^{2}_{j}=\\mathrm{RSS}_{j}/n$ 代入对数似然函数得到的。由此得到的最大化对数似然为\n$$\n\\hat{\\ell}_{j}\n\\,=\\, -\\frac{n}{2}\\left[\\ln(2\\pi) + 1 + \\ln\\!\\left(\\frac{\\mathrm{RSS}_{j}}{n}\\right)\\right].\n$$\n贝叶斯信息准则 (BIC) 定义为\n$$\n\\mathrm{BIC}_{j} \\,=\\, -2\\,\\hat{\\ell}_{j} \\;+\\; k_{j}\\,\\ln n\n\\,=\\, n\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{\\mathrm{RSS}_{j}}{n}\\right)\\right] \\;+\\; k_{j}\\,\\ln n.\n$$\n(a) 部分。对于 $\\mathcal{M}_{0}$，我们有 $p_{0}=3$，因此 $k_{0}=p_{0}+1=4$。对于 $\\mathcal{M}_{1}$，$p_{1}=5$，因此 $k_{1}=6$。给定 $n=180$，$\\mathrm{RSS}_{0}=162.0$ 和 $\\mathrm{RSS}_{1}=155.0$，计算\n$$\n\\ln n \\,=\\, \\ln(180),\n\\quad\n\\frac{\\mathrm{RSS}_{0}}{n} \\,=\\, \\frac{162.0}{180} \\,=\\, 0.90,\n\\quad\n\\frac{\\mathrm{RSS}_{1}}{n} \\,=\\, \\frac{155.0}{180} \\,=\\, \\frac{31}{36}.\n$$\n我们计算\n$$\n-2\\,\\hat{\\ell}_{0}\n= n\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{\\mathrm{RSS}_{0}}{n}\\right)\\right]\n= 180\\left[\\ln(2\\pi)+1+\\ln(0.90)\\right],\n$$\n和\n$$\n-2\\,\\hat{\\ell}_{1}\n= 180\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{31}{36}\\right)\\right].\n$$\n那么\n$$\n\\mathrm{BIC}_{0}\n= -2\\,\\hat{\\ell}_{0} + k_{0}\\ln n\n= 180\\left[\\ln(2\\pi)+1+\\ln(0.90)\\right] + 4\\,\\ln(180),\n$$\n$$\n\\mathrm{BIC}_{1}\n= -2\\,\\hat{\\ell}_{1} + k_{1}\\ln n\n= 180\\left[\\ln(2\\pi)+1+\\ln\\!\\left(\\frac{31}{36}\\right)\\right] + 6\\,\\ln(180).\n$$\n数值上，\n$$\n\\ln(2\\pi)\\approx 1.8378770664,\\quad\n\\ln(180)\\approx 5.1929568509,\\quad\n\\ln(0.90)\\approx -0.1053605157,\\quad\n\\ln\\!\\left(\\frac{31}{36}\\right)\\approx -0.1495317340.\n$$\n因此，\n$$\n-2\\,\\hat{\\ell}_{0}\\approx 180\\left[1.8378770664+1-0.1053605157\\right]\\approx 491.8529791,\n$$\n$$\n\\mathrm{BIC}_{0}\\approx 491.8529791 + 4\\times 5.1929568509 \\approx 512.6248065,\n$$\n以及\n$$\n-2\\,\\hat{\\ell}_{1}\\approx 180\\left[1.8378770664+1-0.1495317340\\right]\\approx 483.9021598,\n$$\n$$\n\\mathrm{BIC}_{1}\\approx 483.9021598 + 6\\times 5.1929568509 \\approx 515.0599009.\n$$\n四舍五入到四位有效数字，$\\mathrm{BIC}_{0}\\approx 512.6$ 且 $\\mathrm{BIC}_{1}\\approx 515.1$。因此，对于 $n=180$ 的情况，贝叶斯信息准则更倾向于更简单的模型 $\\mathcal{M}_{0}$。\n\n(b) 部分。对于大样本 $n$，在所述的稳定化条件下，记 $\\mathrm{RSS}_{0}\\approx n r_{0}$ 和 $\\mathrm{RSS}_{1}\\approx n r_{1}$，其中常数 $r_{0}=0.90$ 和 $r_{1}=0.86$。BIC 的差异得以简化，因为加法常数 $n\\left[\\ln(2\\pi)+1\\right]$ 在模型之间被抵消了：\n$$\n\\Delta \\mathrm{BIC}(n)\n= \\mathrm{BIC}_{1}-\\mathrm{BIC}_{0}\n= n\\left[\\ln\\!\\left(\\frac{\\mathrm{RSS}_{1}}{n}\\right) - \\ln\\!\\left(\\frac{\\mathrm{RSS}_{0}}{n}\\right)\\right] + (k_{1}-k_{0})\\ln n\n\\approx n\\ln\\!\\left(\\frac{r_{1}}{r_{0}}\\right) + \\Delta k\\,\\ln n,\n$$\n其中 $\\Delta k = k_{1}-k_{0} = (p_{1}+1)-(p_{0}+1) = p_{1}-p_{0}$。使得 $\\mathrm{BIC}_{1}=\\mathrm{BIC}_{0}$ 的阈值 $n_{\\ast}$ 是以下方程的解：\n$$\nn\\,\\ln\\!\\left(\\frac{r_{1}}{r_{0}}\\right) + \\Delta k\\,\\ln n = 0.\n$$\n这是一个关于 $n$ 的超越方程，它的解可以用朗伯 W 函数 (Lambert W function) 给出，该函数定义为 $z = W(z) e^{W(z)}$。令 $a = \\ln(r_1/r_0)$，方程变为 $an + \\Delta k \\ln n = 0$。进行变量替换，令 $n = 1/x$，我们得到 $a/x + \\Delta k \\ln(1/x) = 0$，即 $a/x - \\Delta k \\ln x = 0$，或 $a/\\Delta k = x \\ln x$。进一步替换 $x = e^y$，得到 $a/\\Delta k = e^y y$。因此，$y = W(a/\\Delta k)$。逆向替换，我们得到 $x = e^y = e^{W(a/\\Delta k)}$，最终 $n = 1/x = e^{-W(a/\\Delta k)}$。\n因为 $r_1  r_0$，$a  0$，所以朗伯函数的参数 $a/\\Delta k$ 是负数。对于 $a/\\Delta k \\in [-1/e, 0)$，存在两个实数解，对应于 $W$ 函数的主分支 $W_0$ 和次分支 $W_{-1}$。函数 $\\Delta \\mathrm{BIC}(n)$ 从 $n \\to 0^+$ 时的 $-\\infty$ 开始，上升到一个正的最大值，然后再次下降到 $-\\infty$。因此，$\\Delta \\mathrm{BIC}(n)  0$ 的区域是 $(0, n_0) \\cup (n_1, \\infty)$，其中 $n_0$ 和 $n_1$ 是两个根。问题要求找到一个 $n_\\ast$ 使得对于所有 $n \\ge n_\\ast$，$\\mathcal{M}_1$ 都被偏好，这对应于较大的根 $n_1 = e^{-W_{-1}(a/\\Delta k)}$。\n在我们的问题中，$a = \\ln(0.86/0.90) = \\ln(43/45)$ 且 $\\Delta k=2$。因此，阈值样本量为 $n_\\ast = \\exp(-W_{-1}(\\ln(43/45)/2))$。",
            "answer": "$$\\boxed{\\exp\\left(-W_{-1}\\left(\\frac{\\ln(43/45)}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "在现代生物医学研究中，我们常处理“特征比样本多”($p > n$)的高维数据集。像 LASSO 这样的正则化方法对于构建稀疏模型至关重要，但这引入了需要仔细选择的调整参数 $\\lambda$。本练习  作为一个综合项目，将指导您实现一个完整的模型选择流程，使用 BIC 作为客观标准来为 LASSO 模型选择最佳的正则化强度。",
            "id": "3904016",
            "problem": "您的任务是实现一个独立的程序，在生物医学系统建模的背景下，使用贝叶斯信息准则 (BIC) 对稀疏线性模型进行模型选择。考虑一个带有高斯噪声的标准线性模型，其中观测响应向量为 $y \\in \\mathbb{R}^n$，设计矩阵为 $X \\in \\mathbb{R}^{n \\times p}$。假设数据生成过程为 $y = X \\beta^\\star + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_n)$，方差 $\\sigma^2$ 未知。您将拟合最小绝对收缩和选择算子 (LASSO) 惩罚的线性回归，并通过最小化贝叶斯信息准则 (BIC) 来选择正则化参数 $\\lambda$。\n\n您的实现必须遵循以下原则和步骤：\n\n- 从高斯线性模型的最大似然公式和贝叶斯信息准则 (BIC) 的定义出发，其中 BIC 使用最大化的高斯对数似然和等于非零回归系数数量的自由度来计算。不要假设任何预先推导的简化表达式；您的方法必须从这些基本定义进行逻辑推导。\n- 通过坐标下降法实现 LASSO，以计算正则化路径上的解。使用一条包含 $L$ 个从 $\\lambda_{\\max}$ 到一个小的分数 $\\lambda_{\\min} = \\alpha \\lambda_{\\max}$ 的对数间隔的 $\\lambda$ 值路径，其中 $\\lambda_{\\max}$ 是使得最小化器中所有系数均为零的最小值。为保证计算稳定性，对路径上的连续拟合进行热启动。\n- 在拟合之前对预测变量进行标准化并对响应进行中心化：$X$ 的每一列都必须中心化至零均值并缩放至单位标准差，$y$ 必须中心化至零均值。截距项不作惩罚；由于使用了中心化，拟合过程中的截距为 $0$。\n- 对于路径上的每个拟合模型，使用最大化的高斯对数似然计算 BIC，并将自由度定义为非零系数的数量（不包括截距，因中心化处理，截距为 $0$）。\n- 选择使 BIC 最小化的 $\\lambda$。如果在机器精度范围内，多个 $\\lambda$ 值产生数值上无法区分的 BIC 值，则选择其中最大的 $\\lambda$。\n\n算法约束和数值细节：\n\n- 使用带有软阈值更新的坐标下降法。实现一个收敛准则，该准则基于系数更新的最大绝对变化量小于一个容差 $\\tau$。\n- 在计算自由度时，使用一个绝对阈值 $\\delta$ 来判断一个系数是否被视为非零。该阈值必须为正，并且相对于机器精度要小。\n- 在为 BIC 计算最大化的高斯对数似然时，通过在任何对数函数内部根据需要添加一个小的正数常量 $\\epsilon$ 来防止退化的残差平方和，以保持数值稳定性。\n- 您不得使用任何外部数据集。使用提供的种子确定性地生成合成数据集。\n\n测试套件和数据生成：\n\n对于每个测试用例，按所述生成 $X$ 和 $y$。使用以下用例，所有用例都具有固定的系数振幅 $A$，非零系数位于最小的 $k$ 个索引处（即索引 $0$ 到 $k-1$），并具有交替符号 $+A,-A,+A,\\dots$：\n\n- 案例 1 (独立特征，中等维度)：$n=120$，$p=30$，$k=5$，$\\sigma=1.0$，$\\rho=0.0$，$A=2.5$，种子 $7$。\n- 案例 2 (零模型边缘情况)：$n=80$，$p=40$，$k=0$，$\\sigma=1.0$，$\\rho=0.0$，$A=2.0$，种子 $13$。\n- 案例 3 (高维，$p>n$)：$n=30$，$p=60$，$k=3$，$\\sigma=0.5$，$\\rho=0.0$，$A=2.0$，种子 $42$。\n- 案例 4 (预测变量的相关块)：$n=100$，$p=50$，$k=4$，$\\sigma=0.8$，$\\rho=0.8$，$A=2.0$，种子 $11$。通过 $X_{:,j} = \\rho g + \\sqrt{1-\\rho^2} \\,\\varepsilon_j$（对于 $j \\in \\{0,\\dots,m-1\\}$）构建前 $m=\\min(10,p)$ 个具有相关性 $\\rho$ 的列，其中 $g \\in \\mathbb{R}^n$ 在该块内共享，$\\varepsilon_j$ 是独立的标准正态向量。其余列是独立的标准正态分布。\n\n对于所有情况，使用 $\\eta \\sim \\mathcal{N}(0, I_n)$ 构建 $y = X \\beta^\\star + \\sigma \\eta$。使用正则化路径长度 $L=60$，路径比率 $\\alpha=10^{-3}$，坐标下降容差 $\\tau=10^{-6}$，非零阈值 $\\delta=10^{-8}$，以及对数保护值 $\\epsilon=10^{-12}$。\n\n最终输出格式：\n\n- 您的程序必须生成单行输出，其中包含 4 个测试用例中各自选择的 $\\lambda$ 值，四舍五入到 6 位小数，形式为用方括号括起来的逗号分隔列表（例如：$[0.123456,0.234567,0.345678,0.456789]$）。\n- 输出中不允许有任何额外的文本或行。",
            "solution": "用户提供的问题陈述已经过分析，并被确定为有效。它有科学依据、定义明确、客观，并包含足够的信息来推导出一个唯一的、可验证的解决方案。\n\n该问题要求为稀疏线性回归实现一个模型选择过程。任务的核心是沿着正则化路径拟合一系列 LASSO 惩罚的线性模型，并使用贝叶斯信息准则 (BIC) 选择最优模型。该实现必须从第一性原理推导，特别是最大化的高斯对数似然，并且必须采用坐标下降算法来拟合 LASSO 模型。\n\n以下是完整解决方案的逐步推导。\n\n### 1. 统计模型与数据预处理\n\n基础模型是设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 和响应向量 $y \\in \\mathbb{R}^n$ 之间的一个线性关系，该关系被高斯噪声所干扰：\n$$\ny = X \\beta^\\star + \\varepsilon, \\quad \\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I_n)\n$$\n其中 $\\beta^\\star \\in \\mathbb{R}^p$ 是真实的稀疏系数向量，$\\sigma^2$ 是未知的噪声方差。\n\n根据问题规范，我们首先对数据进行预处理。通过减去其均值来中心化响应向量 $y$：\n$$\ny_c = y - \\bar{y}\n$$\n设计矩阵的每个预测变量列 $X_j$（对于 $j=1, \\dots, p$）都被标准化，使其均值为 $0$，标准差为 $1$。这通过以下方式实现：\n$$\nX_{s,j} = \\frac{X_j - \\bar{X}_j}{s_j}\n$$\n其中 $\\bar{X}_j$ 是列 $j$ 的均值，其标准差 $s_j$ 计算为 $s_j = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n (X_{ij} - \\bar{X}_j)^2}$。这种标准化确保了 $\\frac{1}{n} \\sum_{i=1}^n X_{s,ij}^2 = 1$。对于中心化数据，截距项为零，因此不包含在惩罚回归中。\n\n### 2. 通过坐标下降法进行 LASSO 回归\n\nLASSO 方法通过最小化一个惩罚最小二乘目标函数来估计系数 $\\beta$。对于标准化的预测变量和中心化的响应，目标函数为：\n$$\n\\hat{\\beta}(\\lambda) = \\arg\\min_{\\beta \\in \\mathbb{R}^p} \\left\\{ \\frac{1}{2n} \\|y_c - X_s \\beta\\|_2^2 + \\lambda \\|\\beta\\|_1 \\right\\}\n$$\n其中 $\\lambda \\ge 0$ 是控制解的稀疏性的正则化参数，$\\|\\beta\\|_1 = \\sum_{j=1}^p |\\beta_j|$ 是系数向量的 $\\ell_1$ 范数。\n\n我们使用坐标下降法来解决这个优化问题。该算法迭代地更新每个系数 $\\beta_j$，同时保持所有其他系数 $\\beta_k$ ($k \\neq j$) 固定。$\\beta_j$ 的更新规则是通过仅对 $\\beta_j$ 最小化目标函数来找到的。这个单变量问题有一个由软阈值算子 $S_{\\lambda}(\\cdot)$ 给出的闭式解：\n$$\n\\beta_j^{\\text{new}} \\leftarrow S_{\\lambda}(\\rho_j)\n$$\n其中\n$$\nS_{\\lambda}(z) = \\text{sign}(z) \\max(|z| - \\lambda, 0)\n$$\n$\\rho_j$ 是偏残差上的简单最小二乘系数估计。考虑到我们的数据标准化 ($X_{s,j}^T X_{s,j} = n$)，$\\rho_j$ 可以被高效地计算为：\n$$\n\\rho_j = \\frac{1}{n} X_{s,j}^T (y_c - \\sum_{k \\neq j} X_{s,k} \\beta_k^{\\text{old}}) = \\frac{1}{n} X_{s,j}^T (y_c - X_s \\beta^{\\text{old}}) + \\beta_j^{\\text{old}}\n$$\n我们重复地遍历所有系数 $j=1, \\dots, p$，直到任何系数在两次迭代之间的最大绝对变化小于一个容差 $\\tau$。\n\n### 3. 正则化路径\n\n我们为一系列 $L$ 个正则化参数计算 LASSO 解，从最大值 $\\lambda_{\\max}$ 到 $\\lambda_{\\min}$。\n- $\\lambda_{\\max}$ 是使得估计的系数向量 $\\hat{\\beta}(\\lambda)$ 完全为零的最小 $\\lambda$ 值。根据 Karush-Kuhn-Tucker (KKT) 最优性条件，这发生在 $\\lambda$ 等于预测变量与响应之间的最大绝对相关性时：\n$$\n\\lambda_{\\max} = \\max_{j} \\left| \\frac{1}{n} X_{s,j}^T y_c \\right|\n$$\n- 路径在 $\\lambda_{\\min} = \\alpha \\lambda_{\\max}$ 处结束，其中 $\\alpha=10^{-3}$。\n- 这 $L=60$ 个 $\\lambda$ 值在 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 之间呈对数间隔分布。\n解是从 $\\lambda_{\\max}$到 $\\lambda_{\\min}$ 顺序计算的，将前一个 $\\lambda$ 的解用作坐标下降算法的“热启动”。这提高了计算效率。\n\n### 4. 使用贝叶斯信息准则 (BIC) 进行模型选择\n\n对于路径上的每个拟合模型 $\\hat{\\beta}(\\lambda)$，我们计算其 BIC 值以评估其质量。BIC 定义为：\n$$\n\\text{BIC} = d_{\\lambda} \\ln(n) - 2 \\mathcal{L}_{\\max}\n$$\n其中 $n$ 是样本数量，$d_{\\lambda}$ 是模型的有效自由度，$\\mathcal{L}_{\\max}$ 是最大化的对数似然。\n\n高斯对数似然函数为：\n$$\n\\mathcal{L}(\\beta, \\sigma^2) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^2) - \\frac{1}{2\\sigma^2} \\|y_c - X_s\\beta\\|^2\n$$\n对于给定的 LASSO 解 $\\hat{\\beta}(\\lambda)$，该似然通过其最大似然估计 (MLE) 对 $\\sigma^2$ 进行最大化：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n} \\|y_c - X_s\\hat{\\beta}(\\lambda)\\|^2 = \\frac{\\text{RSS}_{\\lambda}}{n}\n$$\n其中 $\\text{RSS}_{\\lambda}$ 是参数为 $\\lambda$ 的模型的残差平方和。将 $\\hat{\\sigma}^2$ 代回对数似然函数，得到最大化后的值：\n$$\n\\mathcal{L}_{\\max} = -\\frac{n}{2}\\left( \\ln(2\\pi) + \\ln\\left(\\frac{\\text{RSS}_{\\lambda}}{n}\\right) + 1 \\right)\n$$\n将此代入 BIC 公式：\n$$\n\\text{BIC}(\\lambda) = d_{\\lambda} \\ln(n) + n \\left( \\ln(2\\pi) + \\ln\\left(\\frac{\\text{RSS}_{\\lambda}}{n}\\right) + 1 \\right)\n$$\n为了模型比较，可以在所有模型中保持不变的项（即不依赖于 $\\lambda$ 的项）可以被省略。这得到了更常见的计算形式：\n$$\n\\text{BIC}(\\lambda) \\propto d_{\\lambda} \\ln(n) + n \\ln\\left(\\frac{\\text{RSS}_{\\lambda}}{n}\\right)\n$$\n对于 LASSO 模型，自由度 $d_{\\lambda}$ 是非零系数的数量：\n$$\nd_{\\lambda} = \\sum_{j=1}^{p} \\mathbb{I}(|\\hat{\\beta}_j(\\lambda)| > \\delta)\n$$\n其中 $\\delta=10^{-8}$ 是一个小的正阈值，用于处理浮点不精确性。为保证数值稳定性，对数计算为 $n(\\ln(\\text{RSS}_{\\lambda} + \\epsilon) - \\ln(n))$，其中 $\\epsilon=10^{-12}$ 是一个小的保护值。\n\n最优正则化参数 $\\lambda^\\star$ 是使 BIC 最小化的那个。如果多个 $\\lambda$ 值产生最小的 BIC，则选择其中最大的 $\\lambda$ 值，这对应于最佳候选项中最简约的模型。\n\n### 5. 合成数据生成\n\n该程序在四个按规定生成的合成数据集上进行测试：\n- 构建一个真实的系数向量 $\\beta^\\star$，其前 $k$ 个分量非零，振幅为 $A$，符号交替。\n- 设计矩阵 $X$ 从一个多元正态分布生成。对于案例 1-3，预测变量是独立的。对于案例 4，一个块的预测变量是相关的。\n- 响应 $y$ 生成为 $y = X\\beta^\\star + \\sigma\\eta$，其中 $\\eta$ 是一个标准正态噪声向量。\n- 每个案例都为随机数生成器使用一个确定性种子，以确保可复现性。\n\n最终输出是为四个测试用例中的每一个选择的 $\\lambda^\\star$。",
            "answer": "[0.087786,0.347719,0.111867,0.063255]"
        }
    ]
}