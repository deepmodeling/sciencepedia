{
    "hands_on_practices": [
        {
            "introduction": "模型参数的估计始于一个根本性问题：模型结构本身是否允许唯一解的存在？本练习  将通过一个极简的生物标志物清除模型，来探讨结构不可辨识性的核心概念。你将亲手揭示一种精确的“尺度对称性”——即不同的参数组合可以产生完全相同的输出，从而深入理解为何某些参数在本质上是无法区分的，并学会辨识出模型中可唯一确定的参数组合。",
            "id": "3902575",
            "problem": "考虑一个血液循环中生物标志物的最小清除模型，其中生物标志物浓度用 $x(t)$ 表示，其演变遵循一阶常微分方程 $dx/dt = -k\\,x$，且无外部输入。方程中，$k>0$ 为未知的清除率。测量输出是传感器读数 $y(t)$，它通过一个未知的测量增益 $s>0$ 与浓度成线性比例，即 $y(t) = s\\,x(t)$。初始浓度 $x(0) = x_{0}>0$ 是未知的。假设对所有 $t \\geq 0$ 的 $y(t)$ 进行理想、连续的测量，且模型-传感器系统是无误差的。\n\n您必须从结构可辨识性的基本定义出发——即，如果不同的参数值不会对所有 $t$ 产生相同的输出 $y(t)$，则一个参数（或参数组合）是结构可辨识的——通过构建一个精确对称性来分析此模型中 $k$、$s$ 和 $x_{0}$ 的可辨识性。该对称性将一个参数元组映射到另一个，同时保持所有 $t \\geq 0$ 的输出轨迹 $y(t)$ 不变。请利用此对称性来确定结构可辨识的最大不变量参数组合。\n\n接下来，考虑一个校准情景，其中测量增益 $s$ 被固定为一个已知的常数 $s^{\\star}>0$。请展示此校准如何打破精确对称性，并根据可观测量 $y(0)$ 和已知量 $s^{\\star}$ 推导出唯一可辨识的初始浓度 $x_{0}$。您的推理必须从给定的模型方程和结构可辨识性定义开始，并且必须对每一步进行论证，不得借助任何预设结果的快捷公式。\n\n请将您的最终答案表示为未校准模型在精确对称性下结构可辨识的参数组合的单一闭式解析表达式。",
            "solution": "分析始于模型的数学定义。状态变量，即生物标志物浓度 $x(t)$，由以下一阶常微分方程所描述：\n$$ \\frac{dx}{dt} = -k\\,x(t) $$\n其中初始条件 $x(0) = x_0 > 0$ 和清除率 $k > 0$ 均为未知。测量输出 $y(t)$ 通过一个未知增益 $s > 0$ 与状态变量呈线性缩放关系：\n$$ y(t) = s\\,x(t) $$\n此未校准模型的参数向量为 $\\theta = (k, s, x_0)$。\n\n首先，我们必须求出状态变量 $x(t)$ 的解析解。该微分方程是可分离的：\n$$ \\frac{dx}{x} = -k\\,dt $$\n对两边从时间 $0$到 $t$ 进行积分，得到：\n$$ \\int_{x(0)}^{x(t)} \\frac{d\\xi}{\\xi} = \\int_0^t -k\\,d\\tau $$\n$$ \\ln(x(t)) - \\ln(x(0)) = -k\\,t $$\n$$ \\ln\\left(\\frac{x(t)}{x(0)}\\right) = -k\\,t $$\n给定 $x(0) = x_0$，我们求解 $x(t)$：\n$$ x(t) = x_0 \\exp(-k\\,t) $$\n\n接下来，我们将可测量的输出 $y(t)$ 表示为时间和模型参数的函数：\n$$ y(t) = s\\,x(t) = s \\left(x_0 \\exp(-k\\,t)\\right) = (s\\,x_0) \\exp(-k\\,t) $$\n该表达式代表了在给定参数向量 $\\theta = (k, s, x_0)$ 下系统的完整输出轨迹。\n\n为了评估结构可辨识性，我们使用所给的定义：如果不同的参数值导致不同的输出，则参数是结构可辨识的。反之，如果存在至少两个不同的参数向量 $\\theta = (k, s, x_0)$ 和 $\\tilde{\\theta} = (\\tilde{k}, \\tilde{s}, \\tilde{x}_0)$，使得 $\\theta \\neq \\tilde{\\theta}$ 但对应的输出 $y(t; \\theta)$ 和 $y(t; \\tilde{\\theta})$ 对所有 $t \\geq 0$ 都相同，则模型是结构不可辨识的。我们令输出相等，以找到这种等价性成立的条件：\n$$ y(t; \\theta) = y(t; \\tilde{\\theta}) \\quad \\forall t \\ge 0 $$\n$$ (s\\,x_0) \\exp(-k\\,t) = (\\tilde{s}\\,\\tilde{x}_0) \\exp(-\\tilde{k}\\,t) $$\n\n为使此等式对所有 $t \\ge 0$ 成立，等式两边的时间函数必须完全相同。一个指数衰减函数 $A \\exp(-\\lambda t)$ 由其初始值 $A$ 和其衰减率 $\\lambda$ 唯一确定。因此，我们必须令相应部分相等：\n1.  衰减率必须相等：$k = \\tilde{k}$。\n2.  指前因子（输出的初始值）必须相等：$s\\,x_0 = \\tilde{s}\\,\\tilde{x}_0$。\n\n从条件 (1) 可知，在任何两个产生相同输出的参数向量中，参数 $k$ 必须相同。这意味着 $k$ 可以从输出数据中唯一确定（例如，从 $\\ln(y(t))$ 对 $t$ 的曲线斜率中确定），因此是结构可辨识的。\n\n然而，条件 (2) 揭示了一种模糊性。等式 $s\\,x_0 = \\tilde{s}\\,\\tilde{x}_0$ 并不要求 $s=\\tilde{s}$ 且 $x_0=\\tilde{x}_0$。这使得模型中存在一个精确对称性。设 $\\alpha$ 为任意正常数，$\\alpha > 0$。我们可以如下定义一个从参数集 $(s, x_0)$到另一个参数集 $(\\tilde{s}, \\tilde{x}_0)$的变换：\n$$ \\tilde{s} = \\alpha s $$\n$$ \\tilde{x}_0 = \\frac{1}{\\alpha} x_0 $$\n如果我们选择任何 $\\alpha \\neq 1$，得到的参数向量 $\\tilde{\\theta} = (k, \\alpha s, x_0/\\alpha)$ 就与 $\\theta = (k, s, x_0)$ 不同。然而，这个新向量会产生完全相同的输出，因为 $\\tilde{k}=k$，并且乘积 $\\tilde{s}\\,\\tilde{x}_0 = (\\alpha s)(\\frac{1}{\\alpha} x_0) = s\\,x_0$ 在该变换下保持不变。这证明了有无数对 $(s, x_0)$ 可以解释同一组数据，意味着 $s$ 和 $x_0$ 单独而言不是结构可辨识的。\n\n分析表明，虽然 $s$ 和 $x_0$ 不可辨识，但它们的乘积 $s\\,x_0$ 是可辨识的。可以从理想数据中唯一确定的量是 $k$ 和组合参数 $P = s\\,x_0$。表达式 $s\\,x_0$ 代表了在所描述的对称性下的最大不变量参数组合，因为正是这个乘积在使得单个参数不可辨识的变换下保持不变。\n\n现在，我们分析校准情景，其中测量增益 $s$ 被固定为一个已知值 $s^{\\star} > 0$。此时，未知参数仅为 $(k, x_0)$。输出方程为：\n$$ y(t) = s^{\\star}\\,x_0 \\exp(-k\\,t) $$\n我们重复可辨识性检验。假设两个参数向量 $(k, x_0)$ 和 $(\\tilde{k}, \\tilde{x}_0)$ 产生相同的输出：\n$$ s^{\\star}\\,x_0 \\exp(-k\\,t) = s^{\\star}\\,\\tilde{x}_0 \\exp(-\\tilde{k}\\,t) $$\n由于 $s^{\\star}$ 是一个已知的非零常数，我们可以用它除以等式两边：\n$$ x_0 \\exp(-k\\,t) = \\tilde{x}_0 \\exp(-\\tilde{k}\\,t) $$\n为使此等式对所有 $t \\geq 0$ 成立，我们必须有 $k=\\tilde{k}$ 和 $x_0=\\tilde{x}_0$。这意味着参数向量是唯一确定的。关于 $s$ 的先验知识打破了缩放对称性，使得 $k$ 和 $x_0$ 都变得结构可辨识。$x_0$ 的唯一可辨识值可以从可观测量中推导出来。在 $t=0$ 时，输出为 $y(0)=s^{\\star}x_0 \\exp(0) = s^{\\star}x_0$。由于 $y(0)$ 是可测量的且 $s^{\\star}$ 是已知的，因此 $x_0$ 由下式给出：\n$$ x_0 = \\frac{y(0)}{s^{\\star}} $$\n这证实了校准使得 $x_0$ 变得可辨识。\n\n问题要求给出从未校准模型的对称性中得到的单一结构可辨识的参数组合。这个组合就是保持不变的乘积，即 $s\\,x_0$。",
            "answer": "$$\n\\boxed{s x_{0}}\n$$"
        },
        {
            "introduction": "结构可辨识性处理的是理想的、无噪声的情形，而实际建模则必须面对测量噪声和有限采样的现实。本练习  旨在通过引入作为量化“实践可辨识性”核心工具的费雪信息矩阵 (Fisher Information Matrix, FIM)，来弥合理论与实践之间的鸿沟。通过为一个标准药代动力学模型推导 FIM，你将学会实验设计（如采样时间）和数据质量是如何直接影响参数估计的置信度的。",
            "id": "3902479",
            "problem": "考虑药代动力学中常用的单室静脉推注模型，其分布容积 $V$ 和一级消除速率常数 $k$ 未知。在时间 $t=0$ 瞬时给予已知剂量 $D$，当 $t \\ge 0$ 时血浆药物浓度为\n$$\nC(t) \\;=\\; \\frac{D}{V}\\,\\exp(-k\\,t).\n$$\n您在采样时间 $\\{t_m\\}_{m=1}^{M}$ 收集了 $M$ 个离散测量值 $\\{y_m\\}_{m=1}^{M}$，其模型为\n$$\ny_m \\;=\\; C(t_m) \\;+\\; \\varepsilon_m,\n$$\n其中 $\\varepsilon_m$ 是独立同分布的高斯随机变量，均值为零，方差为 $\\sigma^2$，即 $\\varepsilon_m \\sim \\mathcal{N}(0,\\sigma^2)$。\n\n仅使用统计估计理论和系统建模的基本定义，按以下步骤进行：\n- 首先，从输入-输出关系 $u(t) \\mapsto C(t)$ 评估参数矢量 $\\theta = (V,k)$ 的结构可辨识性，其中 $u(t)$ 是 $t=0$ 时的推注剂量，且在离散时间点进行理想、无噪声的观测 $C(t)$。您的推理应基于输入-输出映射的可逆性，而非借助数值算法。\n- 接下来，从独立高斯测量噪声的费雪信息矩阵 (FIM) 的定义出发，\n$$\n[\\mathcal{I}(\\theta)]_{ij} \\;=\\; \\mathbb{E}\\!\\left[-\\,\\frac{\\partial^2}{\\partial \\theta_i \\,\\partial \\theta_j}\\,\\ln L(y_1,\\ldots,y_M \\mid \\theta)\\right],\n$$\n推导出关于 $\\theta=(V,k)$ 的 $2 \\times 2$ 费雪信息矩阵 $\\mathcal{I}(\\theta)$，用 $D$, $V$, $k$, $\\sigma$ 和采样时间 $\\{t_m\\}_{m=1}^{M}$ 表示。\n- 以闭合形式计算行列式 $\\det\\big(\\mathcal{I}(\\theta)\\big)$，并解释其大小如何反映实际可辨识性。\n- 使用您的表达式，确定在何种采样时间 $\\{t_m\\}_{m=1}^{M}$ 和噪声水平 $\\sigma$ 的条件下，$\\mathcal{I}(\\theta)$ 会在接近奇异或条件数过大的意义上变得病态。从灵敏度矢量的几何形状以及在适当权重下采样时间的分散程度来阐述这些条件。\n\n您的最终答案应该是 $\\det\\big(\\mathcal{I}(\\theta)\\big)$ 作为 $D$, $V$, $k$, $\\sigma$ 和 $\\{t_m\\}_{m=1}^{M}$ 的函数的闭合形式解析表达式。无需四舍五入。在最终的方框答案中不要包含单位。",
            "solution": "问题陈述经评估为有效。它在科学上基于药代动力学建模和统计估计理论的原理。问题定义良好，提供了执行所要求的推导和分析所需的所有定义和数据。其语言客观精确，设置自洽且逻辑一致。因此，我将提供一个完整的解答。\n\n问题要求进行四个不同的分析：评估结构可辨识性、推导费雪信息矩阵 (FIM)、计算其行列式，以及解释导致其病态的条件。\n\n首先，我们评估参数矢量 $\\theta = (V, k)$ 的结构可辨识性。结构可辨识性关注的是在给定理想、无噪声的模型输出随时间变化的观测值下，参数值的唯一性。模型输出由函数 $C(t, \\theta) = \\frac{D}{V}\\,\\exp(-k\\,t)$ 给出。要使参数矢量 $\\theta$ 具有结构可辨识性，如果两个参数矢量 $\\theta_1 = (V_1, k_1)$ 和 $\\theta_2 = (V_2, k_2)$ 在所有观测时间 $t \\ge 0$ 产生相同的输出，那么必须有 $\\theta_1 = \\theta_2$。\n我们假设 $C(t, \\theta_1) = C(t, \\theta_2)$ 对观测窗口内的所有 $t$ 成立。\n$$\n\\frac{D}{V_1}\\,\\exp(-k_1\\,t) = \\frac{D}{V_2}\\,\\exp(-k_2\\,t)\n$$\n假设剂量 $D$ 非零，我们可以两边同除以 $D$：\n$$\n\\frac{1}{V_1}\\,\\exp(-k_1\\,t) = \\frac{1}{V_2}\\,\\exp(-k_2\\,t)\n$$\n此等式必须对所有 $t \\ge 0$ 成立。我们在 $t=0$ 时对其求值：\n$$\n\\frac{1}{V_1}\\,\\exp(0) = \\frac{1}{V_2}\\,\\exp(0) \\implies \\frac{1}{V_1} = \\frac{1}{V_2}\n$$\n这直接意味着 $V_1 = V_2$。由于 $V_1 = V_2$，我们可以将其代回原方程，简化为：\n$$\n\\exp(-k_1\\,t) = \\exp(-k_2\\,t)\n$$\n对两边取自然对数，得到：\n$$\n-k_1\\,t = -k_2\\,t\n$$\n对于任意时间 $t > 0$，我们可以两边同除以 $-t$ 得到 $k_1 = k_2$。因此，$C(t, \\theta_1) = C(t, \\theta_2)$ 对所有 $t \\ge 0$ 成立的条件意味着 $(V_1, k_1) = (V_2, k_2)$。所以，参数 $V$ 和 $k$ 从 $C(t)$ 的无噪声测量值中是结构可辨识的。\n\n接下来，我们推导 $2 \\times 2$ 的费雪信息矩阵 (FIM) $\\mathcal{I}(\\theta)$。问题陈述中指出，测量值 $y_m$ 受到独立同分布 (i.i.d.) 的高斯噪声 $\\varepsilon_m \\sim \\mathcal{N}(0,\\sigma^2)$ 的干扰。对于 $M$ 个这样的测量值，其对数似然函数为：\n$$\n\\ln L(y_1,\\ldots,y_M \\mid \\theta) = \\sum_{m=1}^{M} \\ln \\left( \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_m - C(t_m, \\theta))^2}{2\\sigma^2}\\right) \\right)\n$$\n$$\n\\ln L = -\\frac{M}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{m=1}^{M} (y_m - C(t_m, \\theta))^2\n$$\nFIM 元素 $[\\mathcal{I}(\\theta)]_{ij}$ 定义为 $\\mathbb{E}\\!\\left[-\\,\\frac{\\partial^2}{\\partial \\theta_i \\,\\partial \\theta_j}\\,\\ln L\\right]$。我们来计算这些导数。关于参数 $\\theta_i$ 的一阶偏导数为：\n$$\n\\frac{\\partial \\ln L}{\\partial \\theta_i} = -\\frac{1}{2\\sigma^2} \\sum_{m=1}^{M} 2(y_m - C(t_m, \\theta)) \\left(-\\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_i}\\right) = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} (y_m - C(t_m, \\theta)) \\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_i}\n$$\n关于 $\\theta_j$ 的二阶偏导数为：\n$$\n\\frac{\\partial^2 \\ln L}{\\partial \\theta_i \\partial \\theta_j} = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\left[ -\\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_j} \\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_i} + (y_m - C(t_m, \\theta)) \\frac{\\partial^2 C(t_m, \\theta)}{\\partial \\theta_i \\partial \\theta_j} \\right]\n$$\n取期望 $\\mathbb{E}[\\cdot]$，我们利用 $\\mathbb{E}[y_m] = C(t_m, \\theta)$，这意味着 $\\mathbb{E}[y_m - C(t_m, \\theta)] = 0$。求和中的第二项消失。\n$$\n\\mathbb{E}\\left[\\frac{\\partial^2 \\ln L}{\\partial \\theta_i \\partial \\theta_j}\\right] = -\\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_i} \\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_j}\n$$\n因此，FIM 元素简化为：\n$$\n[\\mathcal{I}(\\theta)]_{ij} = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_i} \\frac{\\partial C(t_m, \\theta)}{\\partial \\theta_j}\n$$\n参数为 $\\theta_1 = V$ 和 $\\theta_2 = k$。我们必须计算灵敏度函数（$C(t)$ 关于 $V$ 和 $k$ 的偏导数）：\n$$\n\\frac{\\partial C(t)}{\\partial V} = \\frac{\\partial}{\\partial V} \\left(\\frac{D}{V} \\exp(-kt)\\right) = -\\frac{D}{V^2} \\exp(-kt)\n$$\n$$\n\\frac{\\partial C(t)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left(\\frac{D}{V} \\exp(-kt)\\right) = \\frac{D}{V} \\exp(-kt)(-t) = -t \\frac{D}{V} \\exp(-kt)\n$$\n现在我们构建 FIM 的元素，$\\mathcal{I}(\\theta) = \\begin{pmatrix} \\mathcal{I}_{VV} & \\mathcal{I}_{VK} \\\\ \\mathcal{I}_{KV} & \\mathcal{I}_{KK} \\end{pmatrix}$：\n$$\n\\mathcal{I}_{VV} = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\left( \\frac{\\partial C(t_m)}{\\partial V} \\right)^2 = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\left( -\\frac{D}{V^2} \\exp(-kt_m) \\right)^2 = \\frac{D^2}{\\sigma^2 V^4} \\sum_{m=1}^{M} \\exp(-2kt_m)\n$$\n$$\n\\mathcal{I}_{KK} = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\left( \\frac{\\partial C(t_m)}{\\partial k} \\right)^2 = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\left( -t_m \\frac{D}{V} \\exp(-kt_m) \\right)^2 = \\frac{D^2}{\\sigma^2 V^2} \\sum_{m=1}^{M} t_m^2 \\exp(-2kt_m)\n$$\n$$\n\\mathcal{I}_{VK} = \\mathcal{I}_{KV} = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\frac{\\partial C(t_m)}{\\partial V} \\frac{\\partial C(t_m)}{\\partial k} = \\frac{1}{\\sigma^2} \\sum_{m=1}^{M} \\left(-\\frac{D}{V^2} \\exp(-kt_m)\\right) \\left(-t_m \\frac{D}{V} \\exp(-kt_m)\\right) = \\frac{D^2}{\\sigma^2 V^3} \\sum_{m=1}^{M} t_m \\exp(-2kt_m)\n$$\n第三，我们计算 $\\mathcal{I}(\\theta)$ 的行列式。\n$$\n\\det\\big(\\mathcal{I}(\\theta)\\big) = \\mathcal{I}_{VV} \\mathcal{I}_{KK} - \\mathcal{I}_{VK}^2\n$$\n$$\n\\det\\big(\\mathcal{I}(\\theta)\\big) = \\left(\\frac{D^2}{\\sigma^2 V^4} \\sum_{m=1}^{M} \\exp(-2kt_m)\\right) \\left(\\frac{D^2}{\\sigma^2 V^2} \\sum_{m=1}^{M} t_m^2 \\exp(-2kt_m)\\right) - \\left(\\frac{D^2}{\\sigma^2 V^3} \\sum_{m=1}^{M} t_m \\exp(-2kt_m)\\right)^2\n$$\n$$\n\\det\\big(\\mathcal{I}(\\theta)\\big) = \\frac{D^4}{\\sigma^4 V^6} \\left[ \\left(\\sum_{m=1}^{M} \\exp(-2kt_m)\\right) \\left(\\sum_{m=1}^{M} t_m^2 \\exp(-2kt_m)\\right) \\right] - \\frac{D^4}{\\sigma^4 V^6} \\left( \\sum_{m=1}^{M} t_m \\exp(-2kt_m) \\right)^2\n$$\n提取公因式，得到行列式的最终表达式：\n$$\n\\det\\big(\\mathcal{I}(\\theta)\\big) = \\frac{D^4}{\\sigma^4 V^6} \\left[ \\left(\\sum_{m=1}^{M} \\exp(-2kt_m)\\right) \\left(\\sum_{m=1}^{M} t_m^2 \\exp(-2kt_m)\\right) - \\left(\\sum_{m=1}^{M} t_m \\exp(-2kt_m)\\right)^2 \\right]\n$$\n此行列式的大小是实际可辨识性的度量。克拉美-罗下界指出，任何无偏估计量 $\\hat{\\theta}$ 的协方差矩阵都受 FIM 的逆的限制，即 $\\text{Cov}(\\hat{\\theta}) \\ge \\mathcal{I}(\\theta)^{-1}$。参数的置信椭球的体积与 $1/\\sqrt{\\det(\\mathcal{I}(\\theta))}$ 成反比。较大的行列式意味着较小的逆矩阵，参数估计的方差界限更小，置信区域也更小。因此，大的 $\\det(\\mathcal{I}(\\theta))$ 对应于良好的实际可辨识性。\n\n最后，我们分析使 $\\mathcal{I}(\\theta)$ 变得病态的条件。病态意味着矩阵接近奇异，即其行列式接近于零。根据柯西-施瓦茨不等式，该行列式表达式是非负的。当且仅当两个灵敏度矢量 $\\vec{s}_V = (\\ldots, \\frac{\\partial C(t_m)}{\\partial V}, \\ldots)$ 和 $\\vec{s}_k = (\\ldots, \\frac{\\partial C(t_m)}{\\partial k}, \\ldots)$ 线性相关时，行列式为零。这种情况发生于 $\\vec{s}_k = c \\cdot \\vec{s}_V$ 对某个标量常数 $c$ 成立时。\n$$\n-t_m \\frac{D}{V} \\exp(-kt_m) = c \\left( -\\frac{D}{V^2} \\exp(-kt_m) \\right) \\implies t_m \\frac{1}{V} = c \\frac{1}{V^2} \\implies t_m = \\frac{c}{V}\n$$\n这必须对所有 $m$ 成立。这只在所有采样时间都相同，即对所有 $m=1, \\ldots, M$ 都有 $t_m = t_{const}$ 时才可能。在这种情况下，测量值无法提供信息来区分衰减速率和初始浓度，参数不具有实际可辨识性。此时 FIM 是精确奇异的。\n更一般地，如果采样时间 $\\{t_m\\}$ 选择不当，FIM 会变得病态（接近奇异，条件数大）。行列式括号中的项，$\\left(\\sum w_m\\right) \\left(\\sum t_m^2 w_m\\right) - \\left(\\sum t_m w_m\\right)^2$（其中权重 $w_m = \\exp(-2kt_m)$），与采样时间的加权方差成正比。病态在以下情况出现：\n1.  采样时间 $\\{t_m\\}$ 非常密集地聚集在一起。这使得时间的加权方差非常小，因此 $\\det(\\mathcal{I}(\\theta)) \\approx 0$。灵敏度矢量变得几乎共线。\n2.  采样时间选择在信息量不足的区域。如果所有 $t_m \\gg 1/k$，那么对所有 $m$ 都有 $\\exp(-kt_m) \\approx 0$。FIM 的所有元素都接近于零，导致行列式接近于零和可辨识性差。\n噪声水平 $\\sigma$ 也影响实际可辨识性。行列式中的 $1/\\sigma^4$ 项表明，随着噪声方差 $\\sigma^2$ 的增加，$\\det(\\mathcal{I}(\\theta))$ 会迅速减小。高噪声水平会降低信息质量，从而恶化实际可辨识性。然而，$\\sigma$ 是整个矩阵的标量乘数，因此它不影响矩阵的条件数，条件数仅取决于特征值的比率。病态（高条件数）的主要原因是糟糕的实验设计，即采样时间 $\\{t_m\\}$ 的选择。",
            "answer": "$$\n\\boxed{\\frac{D^4}{\\sigma^4 V^6} \\left[ \\left(\\sum_{m=1}^{M} \\exp(-2kt_m)\\right) \\left(\\sum_{m=1}^{M} t_m^2 \\exp(-2kt_m)\\right) - \\left(\\sum_{m=1}^{M} t_m \\exp(-2kt_m)\\right)^2 \\right]}\n$$"
        },
        {
            "introduction": "实践可辨识性不佳并非绝路；它通常可以通过更智能的实验策略来解决。这个高级实践练习  将让你从分析者转变为设计者，要求你实现一个序贯实验设计算法。你将运用后验方差最小化的原则，迭代地选择信息量最大的采样时间点，从而主动提升参数估计的确定性，并展示如何“拯救”一个起初实践上不可辨识的模型。",
            "id": "3902459",
            "problem": "考虑一个单室静脉推注药代动力学（PK）模型，其中血浆浓度 $C(t)$ 随时间 $t \\ge 0$ 的演变遵循常微分方程 $dC/dt = - (CL/V) \\, C(t)$，初始条件为 $C(0^+) = D/V$。这里，$CL$ 表示清除率，$V$ 表示分布容积，$D$ 表示给药剂量。浓度的精确解为 $C(t; \\theta) = \\frac{D}{V} \\exp\\!\\left(-\\frac{CL}{V} t \\right)$，其中参数向量为 $\\theta = [CL, V]^\\top$。假设观测模型为 $y_i = C(t_i; \\theta_{\\text{true}}) + \\varepsilon_i$，其中测量噪声 $\\varepsilon_i$ 是独立同分布的，并遵循均值为 $0$、方差为 $\\sigma_y^2$ 的正态分布。单位如下：$CL$ 为 $\\mathrm{L/h}$，$V$ 为 $\\mathrm{L}$，$D$ 为 $\\mathrm{mg}$，$C$ 和 $y$ 为 $\\mathrm{mg/L}$，$t$ 为 $\\mathrm{h}$。\n\n结构可辨识性关注的是，在连续时间内的无噪声观测 $C(t)$ 是否能唯一确定参数 $CL$ 和 $V$。实际可辨识性关注的是，在离散采样时间的有限含噪数据下，参数是否能够以足够小的不确定性被可靠地估计。本问题要求您设计并实现一个序列实验设计程序，该程序基于后验方差缩减来选择额外的采样时间，以改善给定 PK 模型中参数的实际可辨识性。\n\n您需要使用以下基础和定义：\n- 将 $\\theta$ 的先验视为多元正态分布 $\\mathcal{N}(\\mu_0, \\Sigma_0)$，其中 $\\mu_0 \\in \\mathbb{R}^2$ 且 $\\Sigma_0 \\in \\mathbb{R}^{2 \\times 2}$ 是对称正定矩阵。\n- 在每个采样时间 $t$，通过围绕当前后验均值 $\\mu$ 进行一阶线性化来局部逼近观测模型，从而获得一个仿射测量模型，其雅可比矩阵为 $J(t; \\mu) = \\nabla_{\\theta} C(t; \\theta)\\rvert_{\\theta=\\mu} \\in \\mathbb{R}^{1 \\times 2}$。\n- 使用高斯条件化法则，在线性化模型和高斯噪声的假设下，根据单个标量观测推导后验均值和协方差的更新。并以此为基础构建一个序列设计方案，在该方案中，选择下一个采样时间以最大化后验协方差的预期缩减量（例如，通过最小化后验迹）。\n- 定义一个实际可辨识性准则，要求两个参数的相对后验标准差不大于阈值 $r_{\\mathrm{thr}}$，并且 $CL$ 和 $V$ 之间的绝对后验相关性不大于阈值 $\\rho_{\\mathrm{thr}}$。具体而言，设 $\\Sigma$ 为最终后验协方差；$CL$ 的相对后验标准差为 $\\sqrt{\\Sigma_{11}} / |\\mu_{CL}|$，$V$ 的相对后验标准差为 $\\sqrt{\\Sigma_{22}} / |\\mu_V|$，后验相关性为 $\\Sigma_{12} / \\sqrt{\\Sigma_{11} \\Sigma_{22}}$。\n\n实现一个程序，该程序：\n1. 使用指定的先验 $\\mathcal{N}(\\mu_0, \\Sigma_0)$、真实参数 $\\theta_{\\text{true}}$、剂量 $D$、测量噪声标准差 $\\sigma_y$ 和一组初始采样时间 $\\{t_i\\}$ 进行初始化。\n2. 同化从真实模型生成的带有独立正态噪声的初始数据，通过序列高斯更新获得初始后验。\n3. 对给定数量的额外样本 $k$ 执行序列实验设计，方法是从一个固定的候选集中选择下一个采样时间，以最大化后验协方差的预期缩减量（使用线性化高斯更新来计算候选时间的预期后验协方差）。\n4. 选定每个时间后，从带噪声的真实模型中模拟实际观测，并使用线性化高斯条件化法则更新后验。\n5. 返回一个布尔值，该值指示序列设计是否恢复了实际可辨识性。恢复的定义是：最终后验满足可辨识性阈值，而初始后验不满足。\n\n使用以下参数集测试套件来评估问题的不同方面。对于每种情况，使用指定的参数、初始设计和序列设计配置，并计算所需的布尔值。程序必须打印单行输出，其中包含一个方括号括起来的逗号分隔列表，按以下给出的顺序为每种情况提供一个布尔值。\n\n测试套件：\n- 情况 A（初始设计不佳、中等噪声的一般情况）：\n    - 真实参数：$CL = 1.2\\,\\mathrm{L/h}$，$V = 8.0\\,\\mathrm{L}$。\n    - 剂量：$D = 100\\,\\mathrm{mg}$。\n    - 先验均值：$\\mu_0 = [0.8, 12.0]^\\top$。\n    - 先验协方差：$\\Sigma_0$ 的对角线标准差为 $s_{CL} = 0.6$、$s_V = 6.0$，相关系数为 $c = 0.8$，即 $$\\Sigma_0 = \\begin{bmatrix} s_{CL}^2 & c s_{CL} s_V \\\\ c s_{CL} s_V & s_V^2 \\end{bmatrix}.$$\n    - 测量噪声：$\\sigma_y = 0.05\\,\\mathrm{mg/L}$。\n    - 初始采样时间（小时）：$[0.2, 0.4, 0.6]$。\n    - 序列设计的候选时间（小时）：$[0.25, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 12.0, 16.0, 24.0]$。\n    - 序列添加次数：$k = 6$。\n- 情况 B（高噪声的边界情况）：\n    - 真实参数：$CL = 1.0\\,\\mathrm{L/h}$，$V = 10.0\\,\\mathrm{L}$。\n    - 剂量：$D = 100\\,\\mathrm{mg}$。\n    - 先验均值：$\\mu_0 = [1.5, 7.0]^\\top$。\n    - 先验协方差：对角线标准差为 $s_{CL} = 0.7$、$s_V = 5.0$，相关系数为 $c = 0.9$，$$\\Sigma_0 = \\begin{bmatrix} s_{CL}^2 & c s_{CL} s_V \\\\ c s_{CL} s_V & s_V^2 \\end{bmatrix}.$$\n    - 测量噪声：$\\sigma_y = 0.20\\,\\mathrm{mg/L}$。\n    - 初始采样时间（小时）：$[0.2, 0.3, 0.4]$。\n    - 候选时间（小时）：同情况 A。\n    - 序列添加次数：$k = 6$。\n- 情况 C（初始设计良好的边缘情况）：\n    - 真实参数：$CL = 1.0\\,\\mathrm{L/h}$，$V = 10.0\\,\\mathrm{L}$。\n    - 剂量：$D = 100\\,\\mathrm{mg}$。\n    - 先验均值：$\\mu_0 = [0.9, 9.5]^\\top$。\n    - 先验协方差：对角线标准差为 $s_{CL} = 0.5$、$s_V = 4.5$，相关系数为 $c = 0.7$，$$\\Sigma_0 = \\begin{bmatrix} s_{CL}^2 & c s_{CL} s_V \\\\ c s_{CL} s_V & s_V^2 \\end{bmatrix}.$$\n    - 测量噪声：$\\sigma_y = 0.05\\,\\mathrm{mg/L}$。\n    - 初始采样时间（小时）：$[0.25, 2.0, 8.0, 16.0]$。\n    - 候选时间（小时）：同情况 A。\n    - 序列添加次数：$k = 2$。\n\n所有情况均使用的可辨识性阈值：\n- 相对后验标准差阈值：$r_{\\mathrm{thr}} = 0.50$。\n- 绝对后验相关性阈值：$\\rho_{\\mathrm{thr}} = 0.85$。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表的结果（例如 $[result\\_A,result\\_B,result\\_C]$），其中每个条目都是一个布尔值，指示序列设计是否为相应情况恢复了实际可辨识性。由于输出仅包含布尔值，因此输出中不需要单位。",
            "solution": "用户提供的问题已经过分析，并被认为是有效的。它在药代动力学和统计系统辨识方面具有科学依据，问题设定良好，目标明确，数据充分，其结构旨在以一种非平凡的方式测试实际可辨识性的核心概念。解决方案将通过开发和实现所要求的序列实验设计算法来展开。\n\n这个问题的核心在于为药代动力学（PK）模型序列化地减少参数估计中的不确定性。我们使用概率分布来建模关于参数 $\\theta = [CL, V]^\\top$ 的知识。最初，这是一个先验分布，题目告知其为多元正态分布 $\\theta \\sim \\mathcal{N}(\\mu_0, \\Sigma_0)$。随着我们收集数据，我们将此分布更新为后验分布，该后验分布又成为下一个数据点的先验。实验设计的目标是选择信息量最大的未来测量时间，即能够最大程度减少不确定性（后验分布的“离散程度”）的时间。\n\n首先，让我们定义所需的数学组件。血浆中的药物浓度由单室模型解给出：\n$$ C(t; \\theta) = \\frac{D}{V} \\exp\\!\\left(-\\frac{CL}{V} t \\right) $$\n其中 $\\theta = [CL, V]^\\top$ 是我们希望估计的参数向量。我们在时间 $t_i$ 的观测是含噪声的：$y_i = C(t_i; \\theta_{\\text{true}}) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma_y^2)$。\n\n问题指定使用线性化高斯更新法则，这是扩展卡尔曼滤波器（Extended Kalman Filter, EKF）的一种形式。假设关于参数的当前信念由后验 $\\mathcal{N}(\\mu, \\Sigma)$ 概括。为了在时间 $t$ 融合一个新的测量值 $y$，我们首先围绕当前均值估计 $\\mu$ 对模型 $C(t; \\theta)$ 进行线性化：\n$$ C(t; \\theta) \\approx C(t; \\mu) + J(t; \\mu) (\\theta - \\mu) $$\n其中 $J(t; \\mu)$ 是在 $\\theta = \\mu$ 处求值的灵敏度雅可比矩阵：\n$$ J(t; \\mu) = \\nabla_{\\theta} C(t; \\theta)\\rvert_{\\theta=\\mu} = \\left[ \\frac{\\partial C}{\\partial CL}\\bigg|_{\\mu}, \\frac{\\partial C}{\\partial V}\\bigg|_{\\mu} \\right] $$\n偏导数是：\n$$ \\frac{\\partial C}{\\partial CL} = \\frac{D}{V} \\left( -\\frac{t}{V} \\right) \\exp\\left(-\\frac{CL}{V} t\\right) = -\\frac{Dt}{V^2} \\exp\\left(-\\frac{CL}{V} t\\right) $$\n$$ \\frac{\\partial C}{\\partial V} = D \\frac{\\partial}{\\partial V}\\left( V^{-1} \\exp(-CL \\cdot t \\cdot V^{-1}) \\right) = D \\left( -V^{-2}\\exp(\\dots) + V^{-1} \\exp(\\dots) \\cdot (CL \\cdot t \\cdot V^{-2}) \\right) = \\frac{D}{V^2}\\left(\\frac{CL \\cdot t}{V} - 1\\right)\\exp\\left(-\\frac{CL}{V} t\\right) $$\n\n有了此线性化模型，给定时间 $t$ 的测量值 $y$，后验均值和协方差的更新方程遵循高斯分布的标准贝叶斯条件化规则（也称为 Kalman 更新方程）：\n设当前先验为 $\\mathcal{N}(\\mu_{\\text{prior}}, \\Sigma_{\\text{prior}})$。\n1.  **计算雅可比矩阵**：$H = J(t; \\mu_{\\text{prior}})$。\n2.  **计算新息协方差**：$S = H \\Sigma_{\\text{prior}} H^\\top + \\sigma_y^2$。由于 $H$ 是 $1 \\times 2$ 矩阵，$\\Sigma_{\\text{prior}}$ 是 $2 \\times 2$ 矩阵，因此 $S$ 是一个标量。\n3.  **计算 Kalman 增益**：$K = \\Sigma_{\\text{prior}} H^\\top S^{-1}$。这是一个 $2 \\times 1$ 向量。\n4.  **计算新息**：$\\nu = y - C(t; \\mu_{\\text{prior}})$。这是预测误差。\n5.  **更新均值**：$\\mu_{\\text{post}} = \\mu_{\\text{prior}} + K \\nu$。\n6.  **更新协方差**：$\\Sigma_{\\text{post}} = (I - K H) \\Sigma_{\\text{prior}}$。\n\n序列实验设计过程涉及从一组候选时间 $\\mathcal{T}_{\\text{cand}}$ 中选择下一个采样时间 $t^*$。其目标是进行“最佳”的测量。问题将“最佳”定义为最大化后验协方差的预期缩减量，具体而言，是通过最小化后验协方差矩阵的迹。这被称为 A-最优性。\n\n后验协方差更新公式，$\\Sigma_{\\text{post}} = (I - K H) \\Sigma_{\\text{prior}}$，可以重写为：\n$$ \\Sigma_{\\text{post}}(t) = \\Sigma_{\\text{prior}} - \\Sigma_{\\text{prior}} H(t)^\\top (H(t) \\Sigma_{\\text{prior}} H(t)^\\top + \\sigma_y^2)^{-1} H(t) \\Sigma_{\\text{prior}} $$\n这个后验协方差的表达式依赖于采样时间 $t$ 的选择（通过 $H(t)$），但值得注意的是，它不依赖于实际（未来）的测量值 $y$。因此，我们可以在进行测量之前，为任何候选时间 $t \\in \\mathcal{T}_{\\text{cand}}$ 计算预期后验协方差。设计准则即为：\n$$ t^* = \\arg\\min_{t \\in \\mathcal{T}_{\\text{cand}}} \\text{trace}(\\Sigma_{\\text{post}}(t)) $$\n由于 $\\text{trace}(\\Sigma_{\\text{prior}})$ 相对于 $t$ 是一个常数，这等价于最大化被减项的迹，该项代表协方差的缩减量。\n\n每个测试用例的完整算法如下：\n1.  用先验均值 $\\mu_0$ 和协方差 $\\Sigma_0$ 初始化参数分布。\n2.  对于初始采样集中的每个时间点，使用真实参数 $\\theta_{\\text{true}}$ 模拟一个含噪声的测量。使用上述高斯条件化法则序列化地更新均值和协方差。\n3.  处理完所有初始样本后，检查得到的后验分布是否满足实际可辨识性准则：\n    *   $\\frac{\\sqrt{\\Sigma_{11}}}{|\\mu_{CL}|} \\le r_{\\mathrm{thr}} = 0.50$\n    *   $\\frac{\\sqrt{\\Sigma_{22}}}{|\\mu_{V}|} \\le r_{\\mathrm{thr}} = 0.50$\n    *   $\\frac{|\\Sigma_{12}|}{\\sqrt{\\Sigma_{11}\\Sigma_{22}}} \\le \\rho_{\\mathrm{thr}} = 0.85$\n    将结果存储为 `initial_identifiable`。\n4.  对指定数量的额外样本 $k$ 执行一个循环。在每次迭代中：\n    a. 对于所提供集合中的每个候选时间，计算预期后验协方差及其迹。\n    b. 选择使该迹最小化的时间 $t^*$。\n    c. 使用 $\\theta_{\\text{true}}$ 在 $t^*$ 处模拟一个新的含噪声观测。\n    d. 使用这个新观测更新当前的后验均值和协方差。\n5.  循环结束后，根据相同的可辨识性准则检查最终的后验分布。将结果存储为 `final_identifiable`。\n6.  该测试用例的结果是表达式 `(not initial_identifiable) AND final_identifiable` 的布尔值。这捕捉了实际可辨识性最初不存在，但通过序列设计过程得以实现的条件。为了噪声生成的可复现性，使用了固定的随机种子。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the sequential design problem.\n    \"\"\"\n    # Use a fixed random seed for reproducibility of noise generation.\n    np.random.seed(0)\n\n    # Identifiability thresholds, constant across all cases.\n    r_thr = 0.50\n    rho_thr = 0.85\n\n    # --- Helper Functions ---\n\n    def concentration(t, cl, v, d):\n        \"\"\"Calculates drug concentration C(t) for the 1-compartment model.\"\"\"\n        if v == 0:\n            return np.inf\n        # To prevent overflow with large negative exponents\n        if v  1e-9: return 0.0\n        arg = -(cl / v) * t\n        if arg  -700:\n            return 0.0\n        return (d / v) * np.exp(arg)\n\n    def jacobian(t, cl, v, d):\n        \"\"\"Calculates the Jacobian of C(t) with respect to parameters [CL, V].\"\"\"\n        if v == 0:\n            return np.array([[0.0, 0.0]])\n        \n        # To prevent overflow with large negative exponents\n        if v  1e-9: return np.array([[0.0, 0.0]])\n        arg = -(cl / v) * t\n        if arg  -700:\n            term = 0.0\n        else:\n            term = np.exp(arg)\n\n        dC_dCL = -(d * t / v**2) * term\n        dC_dV = (d / v**2) * term * (-1.0 + (cl * t) / v)\n        \n        return np.array([[dC_dCL, dC_dV]])\n\n    def update(mu, Sigma, t, y, d, sigma_y):\n        \"\"\"Performs a single Bayesian update (Kalman-like).\"\"\"\n        cl_mu, v_mu = mu\n        H = jacobian(t, cl_mu, v_mu, d)\n        \n        y_pred = concentration(t, cl_mu, v_mu, d)\n        innovation = y - y_pred\n        \n        # S is a 1x1 matrix (scalar)\n        S = H @ Sigma @ H.T + sigma_y**2\n        if S[0, 0] == 0: # Failsafe for numerical instability\n            return mu, Sigma\n\n        S_inv = 1.0 / S[0, 0]\n        \n        # K is a 2x1 matrix\n        K = Sigma @ H.T * S_inv\n        \n        # Update state and covariance\n        mu_new = mu + K.flatten() * innovation\n        Sigma_new = (np.eye(2) - K @ H) @ Sigma\n        \n        return mu_new, Sigma_new\n\n    def check_identifiability(mu, Sigma, r_thr, rho_thr):\n        \"\"\"Checks if the posterior meets the practical identifiability criteria.\"\"\"\n        mu_cl, mu_v = mu\n        \n        # Handle potential numerical issues leading to non-positive variance\n        if Sigma[0, 0]  0 or Sigma[1, 1]  0:\n            return False\n\n        std_devs = np.sqrt(np.diag(Sigma))\n        s_cl, s_v = std_devs\n        \n        if abs(mu_cl) == 0 or abs(mu_v) == 0 or s_cl == 0 or s_v == 0:\n            return False\n\n        rstd_cl = s_cl / abs(mu_cl)\n        rstd_v = s_v / abs(mu_v)\n        \n        corr = Sigma[0, 1] / (s_cl * s_v)\n        \n        return (rstd_cl = r_thr) and (rstd_v = r_thr) and (abs(corr) = rho_thr)\n\n    def run_case(case_params):\n        \"\"\"Executes the full simulation for a single test case.\"\"\"\n        (cl_true, v_true), d, mu0, Sigma0, sigma_y, t_initial, t_cand, k_add = case_params\n\n        # --- Initial Data Assimilation ---\n        mu, Sigma = mu0.copy(), Sigma0.copy()\n        for t in t_initial:\n            y_obs = concentration(t, cl_true, v_true, d) + np.random.normal(0, sigma_y)\n            mu, Sigma = update(mu, Sigma, t, y_obs, d, sigma_y)\n        \n        initial_identifiable = check_identifiability(mu, Sigma, r_thr, rho_thr)\n\n        # --- Sequential Design ---\n        for _ in range(k_add):\n            best_t = -1\n            min_trace = np.inf\n\n            for t_c in t_cand:\n                H_c = jacobian(t_c, mu[0], mu[1], d)\n                S_c = H_c @ Sigma @ H_c.T + sigma_y**2\n                \n                if S_c[0, 0] == 0:\n                    continue\n\n                K_c = Sigma @ H_c.T / S_c[0, 0]\n                Sigma_post_c = (np.eye(2) - K_c @ H_c) @ Sigma\n                trace_post = np.trace(Sigma_post_c)\n\n                if trace_post  min_trace:\n                    min_trace = trace_post\n                    best_t = t_c\n\n            if best_t == -1: # No valid candidate time found\n                break\n\n            # Simulate observation at the chosen time and update\n            y_new = concentration(best_t, cl_true, v_true, d) + np.random.normal(0, sigma_y)\n            mu, Sigma = update(mu, Sigma, best_t, y_new, d, sigma_y)\n\n        final_identifiable = check_identifiability(mu, Sigma, r_thr, rho_thr)\n\n        return (not initial_identifiable) and final_identifiable\n\n    # --- Test Suite Definition ---\n\n    cand_times = [0.25, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 12.0, 16.0, 24.0]\n\n    # Case A\n    s_cl_A, s_v_A, c_A = 0.6, 6.0, 0.8\n    Sigma0_A = np.array([\n        [s_cl_A**2, c_A * s_cl_A * s_v_A],\n        [c_A * s_cl_A * s_v_A, s_v_A**2]\n    ])\n    case_A = (\n        (1.2, 8.0), 100.0, np.array([0.8, 12.0]), Sigma0_A, 0.05,\n        [0.2, 0.4, 0.6], cand_times, 6\n    )\n\n    # Case B\n    s_cl_B, s_v_B, c_B = 0.7, 5.0, 0.9\n    Sigma0_B = np.array([\n        [s_cl_B**2, c_B * s_cl_B * s_v_B],\n        [c_B * s_cl_B * s_v_B, s_v_B**2]\n    ])\n    case_B = (\n        (1.0, 10.0), 100.0, np.array([1.5, 7.0]), Sigma0_B, 0.20,\n        [0.2, 0.3, 0.4], cand_times, 6\n    )\n\n    # Case C\n    s_cl_C, s_v_C, c_C = 0.5, 4.5, 0.7\n    Sigma0_C = np.array([\n        [s_cl_C**2, c_C * s_cl_C * s_v_C],\n        [c_C * s_cl_C * s_v_C, s_v_C**2]\n    ])\n    case_C = (\n        (1.0, 10.0), 100.0, np.array([0.9, 9.5]), Sigma0_C, 0.05,\n        [0.25, 2.0, 8.0, 16.0], cand_times, 2\n    )\n\n    test_cases = [case_A, case_B, case_C]\n    results = [run_case(case) for case in test_cases]\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}