{
    "hands_on_practices": [
        {
            "introduction": "To build a strong foundation, our first practice involves applying the core principles of continuum mechanics to a non-Newtonian fluid from the ground up. This exercise requires you to derive the shear stress in a simple shear flow for a fluid described by the Carreau-Yasuda model. By working directly from the definitions of the rate-of-strain tensor and the effective shear rate, you will solidify your understanding of how these abstract concepts translate into concrete, physically meaningful calculations and see directly how shear-thinning behavior manifests .",
            "id": "3911168",
            "problem": "A suspension of red blood cells in plasma is modeled as an incompressible generalized Newtonian fluid with a shear-rate dependent apparent viscosity. Consider steady simple shear flow in a rectangular microchannel segment with velocity field $\\mathbf{u} = (\\dot{\\gamma}\\,y, 0, 0)$, where $\\dot{\\gamma} > 0$ is a constant engineering shear rate. The deviatoric Cauchy stress for a generalized Newtonian fluid is defined by $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$, where $\\mathbf{D} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}}\\right)$ is the rate-of-strain tensor and $\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$ is the second-invariant-based shear-rate magnitude. The apparent viscosity follows a Carreau–Yasuda model\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) \\;=\\; \\eta_{\\infty} \\;+\\; \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\,\\Big[1 + \\big(\\lambda\\,\\dot{\\gamma}_{\\text{eff}}\\big)^{a}\\Big]^{\\frac{n-1}{a}}\\,,\n$$\nwith parameter values $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$, $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$, $\\lambda = 3.313\\,\\text{s}$, $a = 2$, and $n = 0.3568$. Take $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$. \n\nStarting from the definitions above (no additional constitutive shortcuts), derive the expression for the shear stress component $\\tau_{xy}$ in terms of $\\eta(\\dot{\\gamma}_{\\text{eff}})$ and $\\dot{\\gamma}$ under this simple shear. Compute the numerical value of $\\tau_{xy}$ for the Carreau–Yasuda fluid in Pascals. For comparison, also compute the Newtonian shear stress with constant viscosity equal to $\\eta_{\\infty}$ in Pascals. Finally, report the nondimensional ratio\n$$\nR \\;=\\; \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian with }\\eta=\\eta_{\\infty}\\text{)}}}\\,.\n$$\nRound the final reported ratio $R$ to four significant figures. Express the shear stresses in Pascals.",
            "solution": "The problem is validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Velocity field: $\\mathbf{u} = (\\dot{\\gamma}\\,y, 0, 0)$ with $\\dot{\\gamma} > 0$.\n- Deviatoric Cauchy stress: $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$.\n- Rate-of-strain tensor definition: $\\mathbf{D} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}}\\right)$.\n- Effective shear rate definition: $\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$.\n- Carreau–Yasuda apparent viscosity model:\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) \\;=\\; \\eta_{\\infty} \\;+\\; \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\,\\Big[1 + \\big(\\lambda\\,\\dot{\\gamma}_{\\text{eff}}\\big)^{a}\\Big]^{\\frac{n-1}{a}}\n$$\n- Parameter values:\n  - $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$ (zero-shear viscosity)\n  - $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$ (infinite-shear viscosity)\n  - $\\lambda = 3.313\\,\\text{s}$ (relaxation time)\n  - $a = 2$ (model parameter)\n  - $n = 0.3568$ (power-law index)\n- Engineering shear rate: $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$.\n- Task:\n  1. Derive the expression for $\\tau_{xy}$ in terms of $\\eta(\\dot{\\gamma}_{\\text{eff}})$ and $\\dot{\\gamma}$.\n  2. Compute the numerical value of $\\tau_{xy}$ for the Carreau–Yasuda fluid in Pascals.\n  3. Compute the Newtonian shear stress with constant viscosity $\\eta = \\eta_{\\infty}$ in Pascals.\n  4. Report the nondimensional ratio $R = \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian with }\\eta=\\eta_{\\infty}\\text{)}}}$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem uses the concept of a generalized Newtonian fluid and the Carreau–Yasuda model, which are standard and well-established in non-Newtonian fluid mechanics and hemorheology. The physical setup (simple shear flow) is a fundamental case study. All concepts are based on established principles of continuum mechanics.\n- **Well-Posed:** The problem statement provides all necessary definitions, equations, and parameter values to uniquely determine the quantities of interest. The tasks are specific and lead to a single numerical answer for the ratio $R$.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased scientific language. There are no subjective elements.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe analysis begins with the given velocity field for steady simple shear flow, $\\mathbf{u} = (u_x, u_y, u_z) = (\\dot{\\gamma}y, 0, 0)$.\n\nFirst, we compute the velocity gradient tensor, $\\nabla\\mathbf{u}$:\n$$\n\\nabla\\mathbf{u} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x} & \\frac{\\partial u_x}{\\partial y} & \\frac{\\partial u_x}{\\partial z} \\\\ \\frac{\\partial u_y}{\\partial x} & \\frac{\\partial u_y}{\\partial y} & \\frac{\\partial u_y}{\\partial z} \\\\ \\frac{\\partial u_z}{\\partial x} & \\frac{\\partial u_z}{\\partial y} & \\frac{\\partial u_z}{\\partial z} \\end{pmatrix} = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nNext, we find the rate-of-strain tensor, $\\mathbf{D} = \\frac{1}{2}(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^{\\mathsf{T}})$:\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ \\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\dot{\\gamma}}{2} & 0 \\\\ \\frac{\\dot{\\gamma}}{2} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe only non-zero components are $D_{xy} = D_{yx} = \\frac{\\dot{\\gamma}}{2}$.\n\nNow, we compute the effective shear rate, $\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$. The double-dot product $\\mathbf{D}:\\mathbf{D}$ is the sum of the squares of the tensor components:\n$$\n\\mathbf{D}:\\mathbf{D} = \\sum_{i,j} D_{ij} D_{ij} = D_{xy}^2 + D_{yx}^2 = \\left(\\frac{\\dot{\\gamma}}{2}\\right)^2 + \\left(\\frac{\\dot{\\gamma}}{2}\\right)^2 = 2 \\left(\\frac{\\dot{\\gamma}^2}{4}\\right) = \\frac{\\dot{\\gamma}^2}{2}\n$$\nSubstituting this into the definition for $\\dot{\\gamma}_{\\text{eff}}$:\n$$\n\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2 \\left(\\frac{\\dot{\\gamma}^2}{2}\\right)} = \\sqrt{\\dot{\\gamma}^2} = |\\dot{\\gamma}|\n$$\nSince the problem states $\\dot{\\gamma} > 0$, we have $\\dot{\\gamma}_{\\text{eff}} = \\dot{\\gamma}$.\n\nThe deviatoric Cauchy stress tensor is given by $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$. We are interested in the shear stress component $\\tau_{xy}$. In component form, the relation is $\\tau_{ij} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,D_{ij}$.\nFor the $xy$-component:\n$$\n\\tau_{xy} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,D_{xy} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\left(\\frac{\\dot{\\gamma}}{2}\\right) = \\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\dot{\\gamma}\n$$\nSince $\\dot{\\gamma}_{\\text{eff}} = \\dot{\\gamma}$ for this flow, the expression can also be written as $\\tau_{xy} = \\eta(\\dot{\\gamma})\\,\\dot{\\gamma}$. This completes the first part of the task.\n\nNext, we compute the numerical values. The shear rate is $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$, so $\\dot{\\gamma}_{\\text{eff}} = 100\\,\\text{s}^{-1}$.\nWe calculate the apparent viscosity using the Carreau–Yasuda model:\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) = \\eta_{\\infty} + (\\eta_{0} - \\eta_{\\infty})\\,\\Big[1 + (\\lambda\\,\\dot{\\gamma}_{\\text{eff}})^{a}\\Big]^{\\frac{n-1}{a}}\n$$\nSubstituting the given parameter values:\n- $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$\n- $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$\n- $\\lambda = 3.313\\,\\text{s}$\n- $a = 2$\n- $n = 0.3568$\n- $\\dot{\\gamma}_{\\text{eff}} = 100\\,\\text{s}^{-1}$\n\nThe term $\\lambda\\,\\dot{\\gamma}_{\\text{eff}} = (3.313\\,\\text{s})(100\\,\\text{s}^{-1}) = 331.3$.\nThe exponent is $\\frac{n-1}{a} = \\frac{0.3568 - 1}{2} = \\frac{-0.6432}{2} = -0.3216$.\nThe viscosity is:\n$$\n\\eta(100) = 0.00345 + (0.056 - 0.00345)\\,\\Big[1 + (331.3)^{2}\\Big]^{-0.3216}\n$$\n$$\n\\eta(100) = 0.00345 + (0.05255)\\,\\Big[1 + 109759.69\\Big]^{-0.3216}\n$$\n$$\n\\eta(100) = 0.00345 + (0.05255)\\,\\Big[109760.69\\Big]^{-0.3216}\n$$\nCalculating the term in the brackets:\n$$\n[109760.69]^{-0.3216} \\approx 0.02390553\n$$\nSo, the apparent viscosity is:\n$$\n\\eta(100) \\approx 0.00345 + (0.05255)(0.02390553) \\approx 0.00345 + 0.00125623 \\approx 0.00470623\\,\\text{Pa}\\cdot\\text{s}\n$$\nThe shear stress for the Carreau–Yasuda fluid is:\n$$\n\\tau_{xy}^{\\text{(Carreau–Yasuda)}} = \\eta(100)\\,\\dot{\\gamma} \\approx (0.00470623\\,\\text{Pa}\\cdot\\text{s}) (100\\,\\text{s}^{-1}) \\approx 0.470623\\,\\text{Pa}\n$$\nFor comparison, we compute the shear stress for a Newtonian fluid with constant viscosity $\\eta = \\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$.\n$$\n\\tau_{xy}^{\\text{(Newtonian)}} = \\eta_{\\infty}\\,\\dot{\\gamma} = (0.00345\\,\\text{Pa}\\cdot\\text{s}) (100\\,\\text{s}^{-1}) = 0.345\\,\\text{Pa}\n$$\nFinally, we compute the nondimensional ratio $R$:\n$$\nR = \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian)}}} \\approx \\frac{0.470623}{0.345} \\approx 1.3641246\n$$\nRounding to four significant figures, as requested, we get $R = 1.364$.",
            "answer": "$$\n\\boxed{1.364}\n$$"
        },
        {
            "introduction": "A key feature of blood rheology is its yield stress, but ideal yield-stress models like the Herschel-Bulkley present mathematical and computational challenges, such as an infinite apparent viscosity at zero shear. This practice confronts this issue directly by guiding you through the process of model regularization, a critical technique in advanced fluid dynamics. You will analyze the singularity in the basic Herschel-Bulkley model and then derive a well-behaved, regularized version that is more suitable for numerical simulations, learning how to ensure your models are both physically representative and computationally stable .",
            "id": "3911122",
            "problem": "A research-grade blood analog is modeled as a generalized Newtonian fluid with a shear stress–shear rate relation appropriate for whole blood in steady simple shear. The shear stress $\\tau$ and the scalar shear rate $\\dot{\\gamma}$ satisfy the generalized Newtonian relation $\\tau=\\eta(\\dot{\\gamma})\\,\\dot{\\gamma}$, where $\\eta(\\dot{\\gamma})$ is the apparent viscosity. For a Herschel–Bulkley model, once yielded, the constitutive stress model in simple shear is the sum of a yield contribution and a shear-dependent viscous contribution, with parameters: a yield stress $\\tau_{y}>0$, a consistency $K>0$, and a flow index $n>0$.\n\nTasks:\n- Starting from the above base, derive the apparent viscosity $\\eta_{\\text{HB}}(\\dot{\\gamma})$ implied by the Herschel–Bulkley model in simple shear and characterize its leading-order behavior as $\\dot{\\gamma}\\to 0^{+}$.\n- Introduce a Papanastasiou-type regularization of the yield contribution by replacing the yield stress term with a smooth function of the form $\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)$, where $m>0$ is a regularization time constant, while leaving the shear-dependent viscous term unchanged. Derive the corresponding apparent viscosity $\\eta_{\\text{P}}(\\dot{\\gamma})$ and its limit as $\\dot{\\gamma}\\to 0^{+}$ for general $n$.\n- To remove the low-shear divergence of the shear-thinning term frequently encountered in blood-like fluids with $0<n<1$, consider a second regularization at the level of the apparent viscosity by replacing the power-law factor with a bounded surrogate, namely use\n$$\n\\eta_{\\text{reg}}(\\dot{\\gamma}) \\equiv \\frac{\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)}{\\dot{\\gamma}} \\;+\\; K\\left(\\dot{\\gamma}^{2}+\\varepsilon^{2}\\right)^{\\frac{n-1}{2}},\n$$\nwhere $\\varepsilon>0$ is a small regularization shear-rate scale. Let $\\eta_{0}>0$ denote a prescribed target zero-shear apparent viscosity, defined as the limit of $\\eta_{\\text{reg}}(\\dot{\\gamma})$ as $\\dot{\\gamma}\\to 0^{+}$. Determine, in closed form, the value of the regularization time constant $m$ required to achieve this target. Express your final answer for $m$ in seconds ($\\mathrm{s}$).\n\nAnswer form requirement:\n- Provide your final answer as a single closed-form analytic expression for $m$ in terms of $\\eta_{0}$, $\\tau_{y}$, $K$, $n$, and $\\varepsilon$. Do not include any units in the final boxed answer. No numerical evaluation or rounding is required.",
            "solution": "The problem asks for a sequence of derivations related to non-Newtonian fluid models, culminating in an expression for a regularization parameter. We will address each task in the order presented.\n\nFirst, we analyze the standard Herschel–Bulkley model. The constitutive equation for simple shear, valid for shear rates $\\dot{\\gamma}>0$ where the material has yielded, is given by:\n$$\n\\tau = \\tau_{y} + K\\dot{\\gamma}^{n}\n$$\nHere, $\\tau$ is the shear stress, $\\dot{\\gamma}$ is the scalar shear rate, $\\tau_{y}$ is the yield stress, $K$ is the consistency index, and $n$ is the flow behavior index. The parameters are constrained as $\\tau_y > 0$, $K > 0$, and $n > 0$.\n\nThe generalized Newtonian relation defines the apparent viscosity $\\eta(\\dot{\\gamma})$ as $\\tau = \\eta(\\dot{\\gamma})\\dot{\\gamma}$. For the Herschel–Bulkley model, the apparent viscosity $\\eta_{\\text{HB}}(\\dot{\\gamma})$ is therefore:\n$$\n\\eta_{\\text{HB}}(\\dot{\\gamma}) = \\frac{\\tau}{\\dot{\\gamma}} = \\frac{\\tau_{y} + K\\dot{\\gamma}^{n}}{\\dot{\\gamma}} = \\frac{\\tau_{y}}{\\dot{\\gamma}} + K\\dot{\\gamma}^{n-1}\n$$\nTo characterize its leading-order behavior as $\\dot{\\gamma}\\to 0^{+}$, we examine the terms in the expression for $\\eta_{\\text{HB}}(\\dot{\\gamma})$. As $\\dot{\\gamma}$ approaches $0$ from the positive side, the first term $\\frac{\\tau_{y}}{\\dot{\\gamma}}$ approaches $+\\infty$ since $\\tau_y>0$. The behavior of the second term, $K\\dot{\\gamma}^{n-1}$, depends on $n$. If $0<n<1$, it also diverges to $+\\infty$. If $n=1$, it is a constant $K$. If $n>1$, it approaches $0$. Regardless of the value of $n$, the term $\\frac{\\tau_{y}}{\\dot{\\gamma}}$ is the dominant contribution to the singularity. Thus, the leading-order behavior is:\n$$\n\\eta_{\\text{HB}}(\\dot{\\gamma}) \\sim \\frac{\\tau_{y}}{\\dot{\\gamma}} \\quad \\text{as} \\quad \\dot{\\gamma}\\to 0^{+}\n$$\nThis infinite viscosity at zero shear rate is characteristic of an ideal yield-stress fluid, but poses numerical and analytical challenges.\n\nSecond, we consider a Papanastasiou-type regularization. The yield stress term $\\tau_y$ is replaced by a smooth function $\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)$, where $m>0$ is a regularization parameter. The regularized stress model becomes:\n$$\n\\tau_{\\text{P}} = \\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right) + K\\dot{\\gamma}^{n}\n$$\nThe corresponding apparent viscosity, $\\eta_{\\text{P}}(\\dot{\\gamma})$, is:\n$$\n\\eta_{\\text{P}}(\\dot{\\gamma}) = \\frac{\\tau_{\\text{P}}}{\\dot{\\gamma}} = \\frac{\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)}{\\dot{\\gamma}} + K\\dot{\\gamma}^{n-1}\n$$\nWe must find the limit of $\\eta_{\\text{P}}(\\dot{\\gamma})$ as $\\dot{\\gamma}\\to 0^{+}$. We evaluate the limit of each term. For the first term, we can use L'Hôpital's rule as it is of the indeterminate form $\\frac{0}{0}$:\n$$\n\\lim_{\\dot{\\gamma}\\to 0^{+}} \\frac{\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)}{\\dot{\\gamma}} = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\frac{\\frac{d}{d\\dot{\\gamma}}\\left[\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)\\right]}{\\frac{d}{d\\dot{\\gamma}}[\\dot{\\gamma}]} = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\frac{\\tau_{y}\\left(m\\exp(-m\\,\\dot{\\gamma})\\right)}{1} = m\\tau_{y}\n$$\nThe limit of the second term is $\\lim_{\\dot{\\gamma}\\to 0^{+}} K\\dot{\\gamma}^{n-1}$, which, as discussed, is $+\\infty$ for $0<n<1$ (a common case for blood), $K$ for $n=1$, and $0$ for $n>1$. Thus, for the physically relevant case of shear-thinning blood analogs ($0<n<1$), the apparent viscosity $\\eta_{\\text{P}}(\\dot{\\gamma})$ still diverges as $\\dot{\\gamma}\\to 0^{+}$, due to the power-law term.\n\nThird, we address the final regularized model and determine the parameter $m$. A second regularization is introduced for the viscous part, resulting in the apparent viscosity expression:\n$$\n\\eta_{\\text{reg}}(\\dot{\\gamma}) \\equiv \\frac{\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)}{\\dot{\\gamma}} \\;+\\; K\\left(\\dot{\\gamma}^{2}+\\varepsilon^{2}\\right)^{\\frac{n-1}{2}}\n$$\nwhere $\\varepsilon>0$ is a small shear-rate scale that bounds the contribution from the power-law term at low shear rates. A target zero-shear viscosity, $\\eta_{0}>0$, is defined as the limit of this regularized apparent viscosity as $\\dot{\\gamma}\\to 0^{+}$:\n$$\n\\eta_{0} = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\eta_{\\text{reg}}(\\dot{\\gamma})\n$$\nWe compute this limit by summing the limits of the individual terms:\n$$\n\\eta_{0} = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left[ \\frac{\\tau_{y}\\left(1-\\exp(-m\\,\\dot{\\gamma})\\right)}{\\dot{\\gamma}} \\right] + \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left[ K\\left(\\dot{\\gamma}^{2}+\\varepsilon^{2}\\right)^{\\frac{n-1}{2}} \\right]\n$$\nFrom our previous calculation, the limit of the first term is $m\\tau_{y}$. For the second term, we substitute $\\dot{\\gamma}=0$:\n$$\n\\lim_{\\dot{\\gamma}\\to 0^{+}} K\\left(\\dot{\\gamma}^{2}+\\varepsilon^{2}\\right)^{\\frac{n-1}{2}} = K\\left(0^{2}+\\varepsilon^{2}\\right)^{\\frac{n-1}{2}} = K\\left(\\varepsilon^{2}\\right)^{\\frac{n-1}{2}} = K\\varepsilon^{n-1}\n$$\nsince $\\varepsilon>0$. Combining these results, we obtain the relationship for the zero-shear viscosity:\n$$\n\\eta_{0} = m\\tau_{y} + K\\varepsilon^{n-1}\n$$\nThe problem requires us to solve for the regularization time constant $m$. Rearranging the equation to isolate $m$:\n$$\nm\\tau_{y} = \\eta_{0} - K\\varepsilon^{n-1}\n$$\nSince $\\tau_{y}>0$, we can divide by it to obtain the final expression for $m$:\n$$\nm = \\frac{\\eta_{0} - K\\varepsilon^{n-1}}{\\tau_{y}}\n$$\nThis closed-form expression gives the value of $m$ required to achieve the prescribed target zero-shear viscosity $\\eta_{0}$ for the given rheological model and its parameters.",
            "answer": "$$\n\\boxed{\\frac{\\eta_{0} - K\\varepsilon^{n-1}}{\\tau_{y}}}\n$$"
        },
        {
            "introduction": "In practical applications, we often have multiple competing models but limited experimental data. This advanced computational exercise bridges the gap between theoretical models and real-world data by tasking you with a fundamental challenge in scientific modeling: model selection. You will implement several common rheological models, fit them to synthetic blood rheometry data, and use powerful statistical tools—the Akaike and Bayesian Information Criteria (AIC and BIC)—to objectively determine which model provides the best balance of accuracy and simplicity. This practice develops an essential skill for any researcher working with data-driven models .",
            "id": "3911118",
            "problem": "You are given the task of implementing an information-theoretic model selection program to compare three non-Newtonian blood rheology models fitted to the same shear rheometry datasets. The base definitions are as follows: for an incompressible fluid under steady simple shear, the shear stress is denoted by $\\tau$ and the shear rate by $\\dot{\\gamma}$, and the apparent viscosity is defined by $\\mu = \\tau / \\dot{\\gamma}$. Whole blood exhibits shear-thinning behavior, meaning $\\mu(\\dot{\\gamma})$ decreases with increasing $\\dot{\\gamma}$. Three widely used constitutive models for $\\mu(\\dot{\\gamma})$ are considered:\n\n- The Cross model: $\\mu(\\dot{\\gamma}; \\theta_{\\text{Cross}})$ with parameters $\\theta_{\\text{Cross}}$,\n- The Sisko model: $\\mu(\\dot{\\gamma}; \\theta_{\\text{Sisko}})$ with parameters $\\theta_{\\text{Sisko}}$,\n- The Carreau–Yasuda model: $\\mu(\\dot{\\gamma}; \\theta_{\\text{CY}})$ with parameters $\\theta_{\\text{CY}}$.\n\nAll models take as input the shear rate $\\dot{\\gamma}$ in $\\text{s}^{-1}$ and return viscosity $\\mu$ in Pascal-second (Pa·s). Each dataset consists of pairs $(\\dot{\\gamma}_i, \\mu_i)$ with measurement errors on $\\mu_i$ that are independent and Gaussian with unknown variance. You must use maximum likelihood estimation under the Gaussian error assumption to fit each model to each dataset, and then implement a model selection criterion based on information theory to rank the models for each dataset. You must implement both Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC), starting from the Gaussian likelihood, without introducing any external heuristics.\n\nThe models’ functional forms to be implemented are specified as follows, with parameters constrained to physiologically plausible ranges (all parameters strictly positive, and shear-thinning exponents in $(0,1)$ where applicable):\n\n- Cross model parameterization:\n  $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, m) = \\mu_{\\infty} + \\frac{\\Delta}{1 + (\\lambda \\dot{\\gamma})^{m}},$$\n  with parameters $\\mu_{\\infty} > 0$, $\\Delta > 0$, $\\lambda > 0$, $m > 0$, and interpreted physical meanings: $\\mu_{\\infty}$ is the infinite-shear viscosity, $\\Delta = \\mu_{0} - \\mu_{\\infty}$ is the difference between zero-shear and infinite-shear viscosities, $\\lambda$ is a time-scale, and $m$ is a shape exponent.\n\n- Sisko model:\n  $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, K, n) = \\mu_{\\infty} + K \\dot{\\gamma}^{n - 1},$$\n  with parameters $\\mu_{\\infty} > 0$, $K > 0$, $n \\in (0,1)$ for shear-thinning.\n\n- Carreau–Yasuda model parameterization:\n  $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, a, n) = \\mu_{\\infty} + \\Delta \\left(1 + (\\lambda \\dot{\\gamma})^{a}\\right)^{\\frac{n - 1}{a}},$$\n  with parameters $\\mu_{\\infty} > 0$, $\\Delta > 0$, $\\lambda > 0$, $a > 0$, $n \\in (0,1)$.\n\nYou must assume an independent Gaussian noise model on $\\mu$ with unknown variance and use maximum likelihood estimation to obtain parameter estimates and the maximized log-likelihood for each fitted model. Then compute AIC and BIC, using the number of free parameters as the model complexity, and include the unknown noise variance as an additional parameter.\n\nYour program must implement the following test suite by generating three synthetic datasets using the specified “true” parameters, shear rate grids, and Gaussian noise levels. Use the specified random seeds for reproducibility. The shear rate $\\dot{\\gamma}$ must be reported in $\\text{s}^{-1}$ and viscosity $\\mu$ in $\\text{Pa}\\cdot\\text{s}$; however, the final output consists only of integers with no physical units.\n\n- Test case $1$ (general shear-thinning, “happy path”; Carreau–Yasuda is true):\n  - True parameters: $\\mu_{\\infty} = 0.0035$, $\\Delta = 0.0565$, $\\lambda = 1.2$, $a = 2.0$, $n = 0.25$.\n  - Shear rate grid: $\\dot{\\gamma}_i$ log-spaced from $0.1$ to $1000$ with $20$ points.\n  - Gaussian noise: standard deviation $\\sigma = 0.0002$ $\\text{Pa}\\cdot\\text{s}$ added to $\\mu$.\n  - Random seed: $42$.\n\n- Test case $2$ (low-shear emphasis, boundary; Cross is true):\n  - True parameters: $\\mu_{\\infty} = 0.0040$, $\\Delta = 0.0760$, $\\lambda = 0.8$, $m = 1.0$.\n  - Shear rate grid: $\\dot{\\gamma}_i$ log-spaced from $0.01$ to $10$ with $20$ points.\n  - Gaussian noise: standard deviation $\\sigma = 0.0003$ $\\text{Pa}\\cdot\\text{s}$.\n  - Random seed: $43$.\n\n- Test case $3$ (small sample and higher noise, edge; Sisko is true):\n  - True parameters: $\\mu_{\\infty} = 0.0030$, $K = 0.0200$, $n = 0.70$.\n  - Shear rate grid: $\\dot{\\gamma}_i$ log-spaced from $1$ to $1000$ with $12$ points.\n  - Gaussian noise: standard deviation $\\sigma = 0.0004$ $\\text{Pa}\\cdot\\text{s}$.\n  - Random seed: $44$.\n\nFor each dataset, fit all three models to the noisy observations using maximum likelihood under the independent Gaussian noise assumption, compute the maximized log-likelihood, compute the Akaike Information Criterion and Bayesian Information Criterion using the number of estimated parameters equal to the number in the rheology model plus the noise variance, and select the best model under each criterion (the smallest criterion value). Index the models as Cross $= 0$, Sisko $= 1$, Carreau–Yasuda $= 2$.\n\nFinal output format requirement: Your program should produce a single line of output containing a list of lists, one inner list per test case, where each inner list contains exactly two integers $[i_{\\text{AIC}}, i_{\\text{BIC}}]$ giving the selected model indices under Akaike Information Criterion and Bayesian Information Criterion, respectively. The output must be printed exactly as a Python list representation, for example, $[[0,2],[1,1],[2,2]]$.",
            "solution": "We begin from the base definition of apparent viscosity under simple shear, $\\mu = \\tau / \\dot{\\gamma}$, where $\\tau$ is the shear stress and $\\dot{\\gamma}$ is the shear rate. For whole blood, the viscosity depends on shear rate, and phenomenological models are used to represent $\\mu(\\dot{\\gamma})$ under steady shear. We consider three well-tested models.\n\nModel definitions:\n1. Cross model. We parameterize the model in terms of $\\mu_{\\infty}$ and $\\Delta = \\mu_{0} - \\mu_{\\infty}$ to maintain the constraint $\\mu_{0} \\ge \\mu_{\\infty}$. The model is\n   $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, m) = \\mu_{\\infty} + \\frac{\\Delta}{1 + (\\lambda \\dot{\\gamma})^{m}},$$\n   where $\\mu_{\\infty} > 0$, $\\Delta > 0$, $\\lambda > 0$, $m > 0$.\n\n2. Sisko model:\n   $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, K, n) = \\mu_{\\infty} + K \\dot{\\gamma}^{n - 1},$$\n   with $\\mu_{\\infty} > 0$, $K > 0$, and $n \\in (0,1)$ for shear-thinning behavior.\n\n3. Carreau–Yasuda model, with the parameterization using $\\Delta = \\mu_{0} - \\mu_{\\infty}$:\n   $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, a, n) = \\mu_{\\infty} + \\Delta \\left(1 + (\\lambda \\dot{\\gamma})^{a}\\right)^{\\frac{n - 1}{a}},$$\n   with $\\mu_{\\infty} > 0$, $\\Delta > 0$, $\\lambda > 0$, $a > 0$, and $n \\in (0,1)$.\n\nLikelihood and maximum likelihood estimation:\nWe assume independent Gaussian measurement noise on viscosity with unknown variance $\\sigma^{2}$:\n$$\\mu_{i}^{\\text{obs}} = \\mu(\\dot{\\gamma}_{i}; \\theta) + \\varepsilon_{i}, \\quad \\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2}), \\quad i = 1, \\ldots, n.$$\nThe likelihood function for a given parameter vector $\\theta$ and variance $\\sigma^{2}$ is\n$$L(\\theta, \\sigma^{2} \\mid \\mu^{\\text{obs}}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi \\sigma^{2}}} \\exp\\left( -\\frac{[\\mu_{i}^{\\text{obs}} - \\mu(\\dot{\\gamma}_{i}; \\theta)]^{2}}{2 \\sigma^{2}} \\right).$$\nThe corresponding log-likelihood is\n$$\\ell(\\theta, \\sigma^{2}) = -\\frac{n}{2}\\ln(2\\pi \\sigma^{2}) - \\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{n} [\\mu_{i}^{\\text{obs}} - \\mu(\\dot{\\gamma}_{i}; \\theta)]^{2}.$$\nDefine the residual sum of squares\n$$\\mathrm{RSS}(\\theta) = \\sum_{i=1}^{n} [\\mu_{i}^{\\text{obs}} - \\mu(\\dot{\\gamma}_{i}; \\theta)]^{2}.$$\nFor fixed $\\theta$, the maximum likelihood estimator of $\\sigma^{2}$ is\n$$\\hat{\\sigma}^{2}(\\theta) = \\frac{\\mathrm{RSS}(\\theta)}{n}.$$\nAt the joint maximum with respect to $\\theta$ and $\\sigma^{2}$, let $\\hat{\\theta}$ minimize $\\mathrm{RSS}(\\theta)$ (nonlinear least squares). Substituting $\\hat{\\sigma}^{2} = \\mathrm{RSS}(\\hat{\\theta}) / n$ into $\\ell$ yields the maximized log-likelihood:\n$$\\ell(\\hat{\\theta}, \\hat{\\sigma}^{2}) = -\\frac{n}{2} \\left[ \\ln(2\\pi) + 1 + \\ln\\left( \\frac{\\mathrm{RSS}(\\hat{\\theta})}{n} \\right) \\right].$$\n\nInformation criteria:\nAkaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) penalize the maximized log-likelihood by model complexity. If $k_{\\text{model}}$ is the number of parameters in the rheology model, and including $\\sigma^{2}$ as an additional estimated parameter, the total number of parameters is\n$$k = k_{\\text{model}} + 1.$$\nThen\n$$\\mathrm{AIC} = 2k - 2 \\ell(\\hat{\\theta}, \\hat{\\sigma}^{2}), \\quad \\mathrm{BIC} = k \\ln(n) - 2 \\ell(\\hat{\\theta}, \\hat{\\sigma}^{2}).$$\nLower values indicate a better trade-off between goodness-of-fit and parsimony.\n\nAlgorithmic design:\n1. For each dataset, generate $\\dot{\\gamma}_{i}$ and $\\mu_{i}^{\\text{obs}}$ by sampling the specified “true” model at the given parameters and adding independent Gaussian noise with the given standard deviation. Units are $\\dot{\\gamma}$ in $\\text{s}^{-1}$ and $\\mu$ in $\\text{Pa}\\cdot\\text{s}$.\n2. For each candidate model (Cross, Sisko, Carreau–Yasuda), fit parameters by minimizing $\\mathrm{RSS}(\\theta)$ using nonlinear least squares, with bounds that enforce physiological plausibility ($\\mu_{\\infty} > 0$, $\\Delta > 0$, $\\lambda > 0$, $m > 0$, $a > 0$, $K > 0$, and $n \\in (0,1)$). This is equivalent to maximum likelihood under the Gaussian error model.\n3. Compute $\\mathrm{RSS}(\\hat{\\theta})$ for the fitted parameters, the sample size $n$, and then compute $\\ell(\\hat{\\theta}, \\hat{\\sigma}^{2})$ using the expression above.\n4. Compute $\\mathrm{AIC}$ and $\\mathrm{BIC}$ using $k = k_{\\text{model}} + 1$, with $k_{\\text{Cross}} = 5$, $k_{\\text{Sisko}} = 4$, and $k_{\\text{CY}} = 6$.\n5. Select the best model under AIC and BIC respectively (the one with minimal criterion value). Index the models as Cross $= 0$, Sisko $= 1$, Carreau–Yasuda $= 2$.\n6. Aggregate the selections for the three datasets into a single list of lists in the prescribed output format.\n\nNumerical considerations:\n- Use bounded nonlinear least squares to avoid non-physical parameter regions.\n- Initialize parameters near typical blood viscosities, for example, $\\mu_{\\infty} \\approx 0.0035$, $\\Delta \\approx 0.05$, $\\lambda \\approx 1$, $m \\approx 2$, $a \\approx 2$, $n \\approx 0.3$, $K \\approx 0.01$.\n- Guard against $\\mathrm{RSS}$ values numerically approaching zero by adding a small positive floor inside logarithms.\n- Ensure reproducibility by fixing the random seeds as specified for each test case.\n\nThe program will compute, for each of the three datasets described, the indices of the selected models under Akaike Information Criterion and Bayesian Information Criterion, and print the final result as a single Python list of three inner lists: $[[i_{\\text{AIC},1}, i_{\\text{BIC},1}], [i_{\\text{AIC},2}, i_{\\text{BIC},2}], [i_{\\text{AIC},3}, i_{\\text{BIC},3}]]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\n# Model index mapping:\n# 0 -> Cross\n# 1 -> Sisko\n# 2 -> Carreau-Yasuda\n\ndef cross_viscosity(gamma, mu_inf, delta, lam, m):\n    # Cross model: mu = mu_inf + delta / (1 + (lam * gamma)^m)\n    return mu_inf + delta / (1.0 + (lam * gamma) ** m)\n\ndef sisko_viscosity(gamma, mu_inf, K, n):\n    # Sisko model: mu = mu_inf + K * gamma^(n - 1)\n    return mu_inf + K * gamma ** (n - 1.0)\n\ndef carreau_yasuda_viscosity(gamma, mu_inf, delta, lam, a, n):\n    # Carreau-Yasuda model: mu = mu_inf + delta * (1 + (lam * gamma)^a)^((n - 1)/a)\n    return mu_inf + delta * (1.0 + (lam * gamma) ** a) ** ((n - 1.0) / a)\n\ndef fit_model(model_name, gamma, mu_obs):\n    \"\"\"\n    Fit the specified model to data using bounded nonlinear least squares.\n    Returns (rss, lnL_hat, k_total) where k_total includes 1 for unknown noise variance.\n    \"\"\"\n    n = len(gamma)\n    # Bounds and initial guesses chosen for physiological plausibility.\n    if model_name == 'Cross':\n        # params: mu_inf, delta, lam, m\n        lb = np.array([0.001, 0.001, 0.01, 0.5])\n        ub = np.array([0.02, 0.2, 10.0, 4.0])\n        p0 = np.array([0.0035, 0.05, 1.0, 2.0])\n        model_func = cross_viscosity\n        k_model = 4\n    elif model_name == 'Sisko':\n        # params: mu_inf, K, n\n        lb = np.array([0.001, 1e-4, 0.1])\n        ub = np.array([0.02, 0.1, 1.0])\n        p0 = np.array([0.0035, 0.01, 0.3])\n        model_func = sisko_viscosity\n        k_model = 3\n    elif model_name == 'Carreau-Yasuda':\n        # params: mu_inf, delta, lam, a, n\n        lb = np.array([0.001, 0.001, 0.01, 0.5, 0.1])\n        ub = np.array([0.02, 0.2, 10.0, 4.0, 1.0])\n        p0 = np.array([0.0035, 0.05, 1.0, 2.0, 0.3])\n        model_func = carreau_yasuda_viscosity\n        k_model = 5\n    else:\n        raise ValueError(\"Unknown model name\")\n\n    # Curve fitting with bounds; increase max function evaluations for robustness.\n    try:\n        popt, _ = curve_fit(model_func, gamma, mu_obs, p0=p0, bounds=(lb, ub), maxfev=20000)\n        mu_fit = model_func(gamma, *popt)\n    except Exception:\n        # In rare case of fitting failure, fallback to initial parameters.\n        mu_fit = model_func(gamma, *p0)\n\n    residuals = mu_obs - mu_fit\n    rss = np.sum(residuals ** 2)\n    # Guard against numerical zero RSS\n    rss = max(rss, 1e-20)\n    lnL_hat = - (n / 2.0) * (np.log(2.0 * np.pi) + 1.0 + np.log(rss / n))\n    k_total = k_model + 1  # include sigma^2\n    return rss, lnL_hat, k_total\n\ndef aic(lnL_hat, k_total):\n    return 2.0 * k_total - 2.0 * lnL_hat\n\ndef bic(lnL_hat, k_total, n):\n    return k_total * np.log(n) - 2.0 * lnL_hat\n\ndef generate_dataset(test_id):\n    \"\"\"\n    Generate synthetic dataset according to the problem's test suite.\n    Returns (gamma, mu_obs)\n    \"\"\"\n    if test_id == 1:\n        # Carreau–Yasuda true parameters\n        mu_inf = 0.0035\n        delta = 0.0565\n        lam = 1.2\n        a = 2.0\n        n = 0.25\n        np.random.seed(42)\n        gamma = np.logspace(np.log10(0.1), np.log10(1000.0), 20)\n        mu_true = carreau_yasuda_viscosity(gamma, mu_inf, delta, lam, a, n)\n        noise_sigma = 0.0002\n    elif test_id == 2:\n        # Cross true parameters\n        mu_inf = 0.0040\n        delta = 0.0760\n        lam = 0.8\n        m = 1.0\n        np.random.seed(43)\n        gamma = np.logspace(np.log10(0.01), np.log10(10.0), 20)\n        mu_true = cross_viscosity(gamma, mu_inf, delta, lam, m)\n        noise_sigma = 0.0003\n    elif test_id == 3:\n        # Sisko true parameters\n        mu_inf = 0.0030\n        K = 0.0200\n        n = 0.70\n        np.random.seed(44)\n        gamma = np.logspace(np.log10(1.0), np.log10(1000.0), 12)\n        mu_true = sisko_viscosity(gamma, mu_inf, K, n)\n        noise_sigma = 0.0004\n    else:\n        raise ValueError(\"Unknown test_id\")\n\n    noise = np.random.normal(loc=0.0, scale=noise_sigma, size=gamma.shape)\n    mu_obs = mu_true + noise\n    # Ensure positivity of viscosity\n    mu_obs = np.clip(mu_obs, 1e-6, None)\n    return gamma, mu_obs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [1, 2, 3]\n\n    results = []\n    for case in test_cases:\n        gamma, mu_obs = generate_dataset(case)\n        n = len(gamma)\n\n        # Fit all models\n        rss_cross, lnL_cross, k_cross = fit_model('Cross', gamma, mu_obs)\n        rss_sisko, lnL_sisko, k_sisko = fit_model('Sisko', gamma, mu_obs)\n        rss_cy, lnL_cy, k_cy = fit_model('Carreau-Yasuda', gamma, mu_obs)\n\n        # Compute AIC and BIC\n        aic_vals = [\n            aic(lnL_cross, k_cross),\n            aic(lnL_sisko, k_sisko),\n            aic(lnL_cy, k_cy)\n        ]\n        bic_vals = [\n            bic(lnL_cross, k_cross, n),\n            bic(lnL_sisko, k_sisko, n),\n            bic(lnL_cy, k_cy, n)\n        ]\n\n        # Select best model indices (0: Cross, 1: Sisko, 2: Carreau–Yasuda)\n        best_aic_idx = int(np.argmin(aic_vals))\n        best_bic_idx = int(np.argmin(bic_vals))\n\n        results.append([best_aic_idx, best_bic_idx])\n\n    # Final print statement in the exact required format.\n    # Print as a Python list of lists: e.g., [[0,2],[1,1],[2,2]]\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}