{
    "hands_on_practices": [
        {
            "introduction": "本练习是广义牛顿流体概念的一项基础应用。通过分析一个简单的剪切流场景，您将运用Carreau-Yasuda模型直接计算剪切应力，从而巩固您对剪切速率依赖性粘度函数如何定量决定流体力学响应的理解。这项实践将抽象的本构方程与具体的、可计算的物理量联系起来。",
            "id": "3911168",
            "problem": "血浆中红细胞的悬浮液被建模为一种不可压缩的广义牛顿流体，其表观粘度依赖于剪切速率。考虑一个矩形微通道段内的稳态简单剪切流，其速度场为 $\\mathbf{u} = (\\dot{\\gamma}\\,y, 0, 0)$，其中 $\\dot{\\gamma}  0$ 是一个恒定的工程剪切速率。广义牛顿流体的偏柯西应力定义为 $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$，其中 $\\mathbf{D} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$ 是应变率张量，$\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$ 是基于第二不变量的剪切速率大小。表观粘度遵循Carreau–Yasuda模型\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) \\;=\\; \\eta_{\\infty} \\;+\\; \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\,\\Big[1 + \\big(\\lambda\\,\\dot{\\gamma}_{\\text{eff}}\\big)^{a}\\Big]^{\\frac{n-1}{a}}\\,,\n$$\n参数值为 $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$，$\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$，$\\lambda = 3.313\\,\\text{s}$，$a = 2$，以及 $n = 0.3568$。取 $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$。\n\n从上述定义出发（不使用额外的本构捷径），推导在此简单剪切条件下，剪切应力分量 $\\tau_{xy}$ 用 $\\eta(\\dot{\\gamma}_{\\text{eff}})$ 和 $\\dot{\\gamma}$ 表示的表达式。计算Carreau–Yasuda流体的 $\\tau_{xy}$ 的数值，单位为帕斯卡。作为对比，也计算恒定粘度等于 $\\eta_{\\infty}$ 时的牛顿剪切应力，单位为帕斯卡。最后，报告无量纲比率\n$$\nR \\;=\\; \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian with }\\eta=\\eta_{\\infty}\\text{)}}}\\,.\n$$\n将最终报告的比率 $R$ 四舍五入到四位有效数字。剪切应力以帕斯卡表示。",
            "solution": "该问题已根据指定标准进行验证。\n\n### 步骤1：提取已知条件\n- 速度场：$\\mathbf{u} = (\\dot{\\gamma}\\,y, 0, 0)$，其中 $\\dot{\\gamma}  0$。\n- 偏柯西应力：$\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$。\n- 应变率张量定义：$\\mathbf{D} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$。\n- 有效剪切速率定义：$\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$。\n- Carreau–Yasuda表观粘度模型：\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) \\;=\\; \\eta_{\\infty} \\;+\\; \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\,\\Big[1 + \\big(\\lambda\\,\\dot{\\gamma}_{\\text{eff}}\\big)^{a}\\Big]^{\\frac{n-1}{a}}\n$$\n- 参数值：\n  - $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$ (零剪切粘度)\n  - $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$ (无穷剪切粘度)\n  - $\\lambda = 3.313\\,\\text{s}$ (弛豫时间)\n  - $a = 2$ (模型参数)\n  - $n = 0.3568$ (幂律指数)\n- 工程剪切速率：$\\dot{\\gamma} = 100\\,\\text{s}^{-1}$。\n- 任务：\n  1. 推导 $\\tau_{xy}$ 用 $\\eta(\\dot{\\gamma}_{\\text{eff}})$ 和 $\\dot{\\gamma}$ 表示的表达式。\n  2. 计算Carreau–Yasuda流体的 $\\tau_{xy}$ 的数值，单位为帕斯卡。\n  3. 计算恒定粘度 $\\eta = \\eta_{\\infty}$ 时的牛顿剪切应力，单位为帕斯卡。\n  4. 报告无量纲比率 $R = \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian with }\\eta=\\eta_{\\infty}\\text{)}}}$, 四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题使用了广义牛顿流体和Carreau–Yasuda模型的概念，这些在非牛顿流体力学和血液流变学中是标准且成熟的概念。物理设置（简单剪切流）是一个基础案例研究。所有概念都基于已建立的连续介质力学原理。\n- **适定性：** 问题陈述提供了所有必要的定义、方程和参数值，以唯一确定所求量。任务是具体的，并导向比率 $R$ 的单一数值答案。\n- **客观性：** 问题以精确、定量和无偏的科学语言陈述。没有主观因素。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答推导\n\n分析始于给定的稳态简单剪切流的速度场，$\\mathbf{u} = (u_x, u_y, u_z) = (\\dot{\\gamma}y, 0, 0)$。\n\n首先，我们计算速度梯度张量 $\\nabla\\mathbf{u}$：\n$$\n\\nabla\\mathbf{u} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y}  \\frac{\\partial u_x}{\\partial z} \\\\ \\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y}  \\frac{\\partial u_y}{\\partial z} \\\\ \\frac{\\partial u_z}{\\partial x}  \\frac{\\partial u_z}{\\partial y}  \\frac{\\partial u_z}{\\partial z} \\end{pmatrix} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n接着，我们求应变率张量 $\\mathbf{D} = \\frac{1}{2}(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^{\\mathsf{T}})$：\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\dot{\\gamma}}{2}  0 \\\\ \\frac{\\dot{\\gamma}}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n唯一非零的分量是 $D_{xy} = D_{yx} = \\frac{\\dot{\\gamma}}{2}$。\n\n现在，我们计算有效剪切速率 $\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2\\,\\mathbf{D}:\\mathbf{D}}$。双点积 $\\mathbf{D}:\\mathbf{D}$ 是张量各分量平方的和：\n$$\n\\mathbf{D}:\\mathbf{D} = \\sum_{i,j} D_{ij} D_{ij} = D_{xy}^2 + D_{yx}^2 = \\left(\\frac{\\dot{\\gamma}}{2}\\right)^2 + \\left(\\frac{\\dot{\\gamma}}{2}\\right)^2 = 2 \\left(\\frac{\\dot{\\gamma}^2}{4}\\right) = \\frac{\\dot{\\gamma}^2}{2}\n$$\n将此代入 $\\dot{\\gamma}_{\\text{eff}}$ 的定义中：\n$$\n\\dot{\\gamma}_{\\text{eff}} = \\sqrt{2 \\left(\\frac{\\dot{\\gamma}^2}{2}\\right)} = \\sqrt{\\dot{\\gamma}^2} = |\\dot{\\gamma}|\n$$\n由于问题说明 $\\dot{\\gamma}  0$，我们得到 $\\dot{\\gamma}_{\\text{eff}} = \\dot{\\gamma}$。\n\n偏柯西应力张量由 $\\boldsymbol{\\tau} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\mathbf{D}$ 给出。我们关心的是剪切应力分量 $\\tau_{xy}$。用分量形式表示，该关系为 $\\tau_{ij} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,D_{ij}$。\n对于 $xy$-分量：\n$$\n\\tau_{xy} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,D_{xy} = 2\\,\\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\left(\\frac{\\dot{\\gamma}}{2}\\right) = \\eta(\\dot{\\gamma}_{\\text{eff}})\\,\\dot{\\gamma}\n$$\n由于对于此流动 $\\dot{\\gamma}_{\\text{eff}} = \\dot{\\gamma}$，该表达式也可以写为 $\\tau_{xy} = \\eta(\\dot{\\gamma})\\,\\dot{\\gamma}$。这完成了任务的第一部分。\n\n接下来，我们计算数值。剪切速率为 $\\dot{\\gamma} = 100\\,\\text{s}^{-1}$，所以 $\\dot{\\gamma}_{\\text{eff}} = 100\\,\\text{s}^{-1}$。\n我们使用Carreau–Yasuda模型计算表观粘度：\n$$\n\\eta(\\dot{\\gamma}_{\\text{eff}}) = \\eta_{\\infty} + (\\eta_{0} - \\eta_{\\infty})\\,\\Big[1 + (\\lambda\\,\\dot{\\gamma}_{\\text{eff}})^{a}\\Big]^{\\frac{n-1}{a}}\n$$\n代入给定的参数值：\n- $\\eta_{0} = 0.056\\,\\text{Pa}\\cdot\\text{s}$\n- $\\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$\n- $\\lambda = 3.313\\,\\text{s}$\n- $a = 2$\n- $n = 0.3568$\n- $\\dot{\\gamma}_{\\text{eff}} = 100\\,\\text{s}^{-1}$\n\n项 $\\lambda\\,\\dot{\\gamma}_{\\text{eff}} = (3.313\\,\\text{s})(100\\,\\text{s}^{-1}) = 331.3$。\n指数为 $\\frac{n-1}{a} = \\frac{0.3568 - 1}{2} = \\frac{-0.6432}{2} = -0.3216$。\n粘度为：\n$$\n\\eta(100) = 0.00345 + (0.056 - 0.00345)\\,\\Big[1 + (331.3)^{2}\\Big]^{-0.3216}\n$$\n$$\n\\eta(100) = 0.00345 + (0.05255)\\,\\Big[1 + 109759.69\\Big]^{-0.3216}\n$$\n$$\n\\eta(100) = 0.00345 + (0.05255)\\,\\Big[109760.69\\Big]^{-0.3216}\n$$\n计算括号中的项：\n$$\n[109760.69]^{-0.3216} \\approx 0.02390553\n$$\n所以，表观粘度为：\n$$\n\\eta(100) \\approx 0.00345 + (0.05255)(0.02390553) \\approx 0.00345 + 0.00125623 \\approx 0.00470623\\,\\text{Pa}\\cdot\\text{s}\n$$\nCarreau–Yasuda流体的剪切应力为：\n$$\n\\tau_{xy}^{\\text{(Carreau–Yasuda)}} = \\eta(100)\\,\\dot{\\gamma} \\approx (0.00470623\\,\\text{Pa}\\cdot\\text{s}) (100\\,\\text{s}^{-1}) \\approx 0.470623\\,\\text{Pa}\n$$\n作为对比，我们计算恒定粘度 $\\eta = \\eta_{\\infty} = 0.00345\\,\\text{Pa}\\cdot\\text{s}$ 的牛顿流体的剪切应力。\n$$\n\\tau_{xy}^{\\text{(Newtonian)}} = \\eta_{\\infty}\\,\\dot{\\gamma} = (0.00345\\,\\text{Pa}\\cdot\\text{s}) (100\\,\\text{s}^{-1}) = 0.345\\,\\text{Pa}\n$$\n最后，我们计算无量纲比率 $R$：\n$$\nR = \\frac{\\tau_{xy}^{\\text{(Carreau–Yasuda)}}}{\\tau_{xy}^{\\text{(Newtonian)}}} \\approx \\frac{0.470623}{0.345} \\approx 1.3641246\n$$\n按要求四舍五入到四位有效数字，我们得到 $R = 1.364$。",
            "answer": "$$\n\\boxed{1.364}\n$$"
        },
        {
            "introduction": "血液流变学的一个关键特征是其屈服应力，即引发流动所需的最小应力。然而，不同的数学模型在描述这一现象时存在重要的概念和实践差异。本练习将引导您比较两种理想屈服应力模型（Casson和Herschel-Bulkley）与一种正则化模型（Papanastasiou）在低剪切速率下的行为，揭示正则化如何影响在接近零流动条件下对应力的预测。",
            "id": "3911152",
            "problem": "将处于生理温度的人体血液样本置于剪切速率趋近于零的均匀简剪切作用下。考虑三种广为接受的非牛顿本构描述：Casson模型、Herschel–Bulkley模型和 Papanastasiou 正则化 Herschel–Bulkley 模型。“低剪切应力平台”定义为极限 $ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) $，其中 $ \\tau $ 是剪切应力，$ \\dot{\\gamma} $ 是剪切速率。使用一组在 $37\\,^{\\circ}\\text{C}$ 且红细胞比容接近 $45\\,\\%$ 的典型人体血液参数：\n- Casson模型参数：屈服应力 $\\tau_{y,C} = 0.010 \\, \\text{Pa}$，Casson粘度参数 $\\eta_{C} = 3.5 \\times 10^{-3} \\, \\text{Pa} \\cdot \\text{s}$。\n- Herschel–Bulkley模型参数：屈服应力 $\\tau_{y,HB} = 0.010 \\, \\text{Pa}$，稠度系数 $K = 1.40 \\times 10^{-2} \\, \\text{Pa} \\cdot \\text{s}^n$，流动指数 $n = 0.70$。\n- Papanastasiou正则化Herschel–Bulkley模型参数：$\\tau_{y,P} = 0.010 \\, \\text{Pa}$，$K = 1.40 \\times 10^{-2} \\, \\text{Pa} \\cdot \\text{s}^n$，$n = 0.70$，正则化参数 $m = 100 \\, \\text{s}$。\n\n从每种模型的剪切应力和剪切速率的本构定义出发，推导三种模型各自的低剪切应力平台，并利用上述参数计算其数值。将每个平台应力以帕斯卡（Pa）为单位表示。将您的答案四舍五入至四位有效数字。以行矩阵的形式给出您的最终答案，各项排序为：Casson、Herschel–Bulkley、Papanastasiou。",
            "solution": "该问题要求推导并计算应用于人体血液的三种非牛顿流体模型的“低剪切应力平台”。低剪切应力平台被明确定义为当剪切速率 $ \\dot{\\gamma} $ 从正方向趋近于零时，剪切应力 $ \\tau $ 的极限：$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) $。\n\n验证过程确认了该问题具有科学依据、提法恰当且信息完整。所提供的模型是血液流变学中的标准模型，参数符合实际，且目标在数学上是精确的。因此，我们可以开始求解。\n\n对于每种模型，我们将陈述关联 $ \\tau $ 和 $ \\dot{\\gamma} $ 的本构方程，然后计算指定的极限。\n\n1.  **Casson模型**\n    对于剪切速率 $ \\dot{\\gamma}  0 $，屈服应力流体的Casson模型由以下关系式定义：\n    $$ \\sqrt{\\tau} = \\sqrt{\\tau_{y,C}} + \\sqrt{\\eta_{C} \\dot{\\gamma}} $$\n    其中 $ \\tau_{y,C} $ 是屈服应力，$ \\eta_{C} $ 是Casson粘度参数。当应力低于屈服应力时，即 $\\tau \\le \\tau_{y,C}$，流体不流动，即 $ \\dot{\\gamma} = 0 $。为求得函数 $ \\tau(\\dot{\\gamma}) $，我们将方程两边平方：\n    $$ \\tau(\\dot{\\gamma}) = \\left( \\sqrt{\\tau_{y,C}} + \\sqrt{\\eta_{C} \\dot{\\gamma}} \\right)^2 = \\tau_{y,C} + 2\\sqrt{\\tau_{y,C}\\eta_{C}\\dot{\\gamma}} + \\eta_{C}\\dot{\\gamma} $$\n    该表达式在 $ \\dot{\\gamma}  0 $ 时有效。现在，我们计算当 $ \\dot{\\gamma} \\to 0^{+} $ 时的极限：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left( \\tau_{y,C} + 2\\sqrt{\\tau_{y,C}\\eta_{C}\\dot{\\gamma}} + \\eta_{C}\\dot{\\gamma} \\right) $$\n    当 $ \\dot{\\gamma} $ 趋近于 $ 0 $ 时，$ 2\\sqrt{\\tau_{y,C}\\eta_{C}\\dot{\\gamma}} $ 项和 $ \\eta_{C}\\dot{\\gamma} $ 项均趋近于 $ 0 $。因此，极限为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\tau_{y,C} + 0 + 0 = \\tau_{y,C} $$\n    低剪切应力平台即为屈服应力本身。使用给定参数 $\\tau_{y,C} = 0.010 \\, \\text{Pa}$，并四舍五入至四位有效数字，其值为 $0.01000 \\, \\text{Pa}$。\n\n2.  **Herschel–Bulkley模型**\n    Herschel–Bulkley模型是另一种屈服应力模型，对于 $ \\dot{\\gamma}  0 $，其定义为：\n    $$ \\tau(\\dot{\\gamma}) = \\tau_{y,HB} + K \\dot{\\gamma}^{n} $$\n    其中 $ \\tau_{y,HB} $ 是屈服应力，$ K $ 是稠度系数，$ n $ 是流动行为指数。当 $\\tau \\le \\tau_{y,HB}$ 时，我们有 $ \\dot{\\gamma} = 0 $。我们计算该函数在 $ \\dot{\\gamma} \\to 0^{+} $ 时的极限：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left( \\tau_{y,HB} + K \\dot{\\gamma}^{n} \\right) $$\n    鉴于流动指数 $ n = 0.70  0 $，当 $ \\dot{\\gamma} \\to 0^{+} $ 时，$ \\dot{\\gamma}^{n} $ 项趋近于 $ 0 $。因此，极限为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\tau_{y,HB} + K(0) = \\tau_{y,HB} $$\n    与Casson模型类似，Herschel–Bulkley模型的低剪切应力平台即为其屈服应力。使用给定参数 $\\tau_{y,HB} = 0.010 \\, \\text{Pa}$，并四舍五入至四位有效数字，其值为 $0.01000 \\, \\text{Pa}$。\n\n3.  **Papanastasiou正则化Herschel–Bulkley模型**\n    Papanastasiou模型对Herschel–Bulkley模型进行正则化，以创建一个适用于所有剪切速率（包括 $ \\dot{\\gamma}=0 $）的单一、连续的应力表达式。这是通过使用一个指数函数来修正屈服应力项实现的。其本构方程为：\n    $$ \\tau(\\dot{\\gamma}) = \\tau_{y,P} \\left[ 1 - \\exp(-m\\dot{\\gamma}) \\right] + K \\dot{\\gamma}^{n} $$\n    其中 $ m $ 是正则化参数。与前两种模型不同，该方程在 $ \\dot{\\gamma}=0 $ 处有定义且连续。我们计算当 $ \\dot{\\gamma} \\to 0^{+} $ 时的极限：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = \\lim_{\\dot{\\gamma}\\to 0^{+}} \\left( \\tau_{y,P} \\left[ 1 - \\exp(-m\\dot{\\gamma}) \\right] + K \\dot{\\gamma}^{n} \\right) $$\n    我们可以分别计算每一项的极限。\n    对于第一项，当 $ \\dot{\\gamma} \\to 0^{+} $ 时，指数 $ -m\\dot{\\gamma} \\to 0 $。因此，$ \\exp(-m\\dot{\\gamma}) \\to \\exp(0) = 1 $。第一项变为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau_{y,P} \\left[ 1 - \\exp(-m\\dot{\\gamma}) \\right] = \\tau_{y,P} \\left[ 1 - 1 \\right] = 0 $$\n    对于第二项，由于 $ n=0.70  0 $，我们有：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} K \\dot{\\gamma}^{n} = K (0)^{n} = 0 $$\n    综合以上结果，总极限为：\n    $$ \\lim_{\\dot{\\gamma}\\to 0^{+}} \\tau(\\dot{\\gamma}) = 0 + 0 = 0 $$\n    通过消除 $ \\dot{\\gamma}=0 $ 处的不连续性，正则化使得模型在计算上更加稳定，并导致在剪切速率为零时的应力为零。因此，根据极限的定义，低剪切应力平台恰好为 $ 0 $。\n    其数值为 $0 \\, \\text{Pa}$。表示为四位有效数字，即为 $0.0000 \\, \\text{Pa}$。\n\n最终计算值为：\n- Casson：$0.01000 \\, \\text{Pa}$\n- Herschel–Bulkley：$0.01000 \\, \\text{Pa}$\n- Papanastasiou：$0.0000 \\, \\text{Pa}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.01000  0.01000  0.0000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际应用中，研究人员常常面临实验数据，并需要选择最合适的流变模型。这项计算实践模拟了这一真实场景，要求您将几个常见的非牛顿模型拟合到合成数据上。通过使用赤池信息准则（AIC）和贝叶斯信息准则（BIC）等统计工具来实施和比较模型，您将培养在模型选择和验证方面的基本技能。",
            "id": "3911118",
            "problem": "您的任务是实现一个基于信息论的模型选择程序，用以比较三个拟合于相同剪切流变测量数据集的非牛顿血液流变学模型。基本定义如下：对于稳态简单剪切下的不可压缩流体，剪切应力表示为 $\\tau$，剪切速率表示为 $\\dot{\\gamma}$，表观粘度定义为 $\\mu = \\tau / \\dot{\\gamma}$。全血表现出剪切稀化行为，即 $\\mu(\\dot{\\gamma})$ 随 $\\dot{\\gamma}$ 的增加而减小。我们考虑三种广泛使用的 $\\mu(\\dot{\\gamma})$ 本构模型：\n\n- Cross 模型：$\\mu(\\dot{\\gamma}; \\theta_{\\text{Cross}})$，其参数为 $\\theta_{\\text{Cross}}$，\n- Sisko 模型：$\\mu(\\dot{\\gamma}; \\theta_{\\text{Sisko}})$，其参数为 $\\theta_{\\text{Sisko}}$，\n- Carreau–Yasuda 模型：$\\mu(\\dot{\\gamma}; \\theta_{\\text{CY}})$，其参数为 $\\theta_{\\text{CY}}$。\n\n所有模型都以剪切速率 $\\dot{\\gamma}$（单位为 $\\text{s}^{-1}$）作为输入，并返回粘度 $\\mu$（单位为帕斯卡-秒，$\\text{Pa}\\cdot\\text{s}$）。每个数据集由数据对 $(\\dot{\\gamma}_i, \\mu_i)$ 组成，其中 $\\mu_i$ 上的测量误差是独立的、服从未知方差的高斯分布。您必须在高斯误差假设下，使用最大似然估计将每个模型拟合到每个数据集，然后实现一个基于信息论的模型选择准则，对每个数据集的模型进行排序。您必须从高斯似然出发，同时实现赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC)，且不引入任何外部启发式方法。\n\n待实现的模型函数形式规定如下，其参数被约束在生理学上合理的范围内（所有参数严格为正，适用的剪切稀化指数在 $(0,1)$ 区间内）：\n\n- Cross 模型参数化：\n  $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, m) = \\mu_{\\infty} + \\frac{\\Delta}{1 + (\\lambda \\dot{\\gamma})^{m}},$$\n  参数为 $\\mu_{\\infty}  0$, $\\Delta  0$, $\\lambda  0$, $m  0$，其物理解释为：$\\mu_{\\infty}$ 是无穷剪切粘度，$\\Delta = \\mu_{0} - \\mu_{\\infty}$ 是零剪切粘度与无穷剪切粘度之差，$\\lambda$ 是一个时间尺度，而 $m$ 是一个形状指数。\n\n- Sisko 模型：\n  $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, K, n) = \\mu_{\\infty} + K \\dot{\\gamma}^{n - 1},$$\n  参数为 $\\mu_{\\infty}  0$, $K  0$, $n \\in (0,1)$ 以描述剪切稀化。\n\n- Carreau–Yasuda 模型参数化：\n  $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, a, n) = \\mu_{\\infty} + \\Delta \\left(1 + (\\lambda \\dot{\\gamma})^{a}\\right)^{\\frac{n - 1}{a}},$$\n  参数为 $\\mu_{\\infty}  0$, $\\Delta  0$, $\\lambda  0$, $a  0$, $n \\in (0,1)$。\n\n您必须假设 $\\mu$ 上存在一个具有未知方差的独立高斯噪声模型，并使用最大似然估计来为每个拟合模型获取参数估计值和最大化对数似然值。然后，使用自由参数的数量作为模型复杂度来计算 AIC 和 BIC，并将未知的噪声方差作为一个额外的参数包括在内。\n\n您的程序必须通过使用指定的“真实”参数、剪切速率网格和高斯噪声水平生成三个合成数据集，来实现以下测试套件。为保证可复现性，请使用指定的随机种子。剪切速率 $\\dot{\\gamma}$ 必须以 $\\text{s}^{-1}$ 为单位报告，粘度 $\\mu$ 以 $\\text{Pa}\\cdot\\text{s}$ 为单位报告；然而，最终输出仅包含没有物理单位的整数。\n\n- 测试用例 $1$（一般剪切稀化，“理想路径”；真实模型为 Carreau–Yasuda）：\n  - 真实参数：$\\mu_{\\infty} = 0.0035$，$\\Delta = 0.0565$，$\\lambda = 1.2$，$a = 2.0$，$n = 0.25$。\n  - 剪切速率网格：$\\dot{\\gamma}_i$ 在 $0.1$ 到 $1000$ 之间对数等分，共 $20$ 个点。\n  - 高斯噪声：在 $\\mu$ 上添加标准差为 $\\sigma = 0.0002 \\, \\text{Pa}\\cdot\\text{s}$ 的噪声。\n  - 随机种子：$42$。\n\n- 测试用例 $2$（低剪切强调，边界情况；真实模型为 Cross）：\n  - 真实参数：$\\mu_{\\infty} = 0.0040$，$\\Delta = 0.0760$，$\\lambda = 0.8$，$m = 1.0$。\n  - 剪切速率网格：$\\dot{\\gamma}_i$ 在 $0.01$ 到 $10$ 之间对数等分，共 $20$ 个点。\n  - 高斯噪声：标准差 $\\sigma = 0.0003 \\, \\text{Pa}\\cdot\\text{s}$。\n  - 随机种子：$43$。\n\n- 测试用例 $3$（小样本和较高噪声，边缘情况；真实模型为 Sisko）：\n  - 真实参数：$\\mu_{\\infty} = 0.0030$，$K = 0.0200$，$n = 0.70$。\n  - 剪切速率网格：$\\dot{\\gamma}_i$ 在 $1$ 到 $1000$ 之间对数等分，共 $12$ 个点。\n  - 高斯噪声：标准差 $\\sigma = 0.0004 \\, \\text{Pa}\\cdot\\text{s}$。\n  - 随机种子：$44$。\n\n对于每个数据集，在高斯独立噪声假设下，使用最大似然法将所有三个模型拟合到带噪观测值，计算最大化对数似然值，使用等于流变模型参数数量加上噪声方差的估计参数总数来计算赤池信息准则和贝叶斯信息准则，并根据每个准则（选择最小值）选出最佳模型。将模型索引为 Cross $= 0$，Sisko $= 1$，Carreau–Yasuda $= 2$。\n\n最终输出格式要求：您的程序应生成单行输出，包含一个列表的列表，每个内部列表对应一个测试用例，其中每个内部列表精确包含两个整数 $[i_{\\text{AIC}}, i_{\\text{BIC}}]$，分别给出在赤池信息准则和贝叶斯信息准则下选出的模型索引。输出必须严格按照 Python 列表的表示法打印，例如 $[[0,2],[1,1],[2,2]]$。",
            "solution": "我们从简单剪切下表观粘度的基本定义开始，$\\mu = \\tau / \\dot{\\gamma}$，其中 $\\tau$ 是剪切应力，$\\dot{\\gamma}$ 是剪切速率。对于全血，粘度依赖于剪切速率，我们使用唯象模型来表示稳态剪切下的 $\\mu(\\dot{\\gamma})$。我们考虑三种经过充分检验的模型。\n\n模型定义：\n1. Cross 模型。我们使用 $\\mu_{\\infty}$ 和 $\\Delta = \\mu_{0} - \\mu_{\\infty}$ 对模型进行参数化，以维持约束 $\\mu_{0} \\ge \\mu_{\\infty}$。该模型为\n   $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, m) = \\mu_{\\infty} + \\frac{\\Delta}{1 + (\\lambda \\dot{\\gamma})^{m}},$$\n   其中 $\\mu_{\\infty}  0$，$\\Delta  0$，$\\lambda  0$，$m  0$。\n\n2. Sisko 模型：\n   $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, K, n) = \\mu_{\\infty} + K \\dot{\\gamma}^{n - 1},$$\n   其中 $\\mu_{\\infty}  0$，$K  0$，且 $n \\in (0,1)$ 以描述剪切稀化行为。\n\n3. Carreau–Yasuda 模型，使用 $\\Delta = \\mu_{0} - \\mu_{\\infty}$ 进行参数化：\n   $$\\mu(\\dot{\\gamma}; \\mu_{\\infty}, \\Delta, \\lambda, a, n) = \\mu_{\\infty} + \\Delta \\left(1 + (\\lambda \\dot{\\gamma})^{a}\\right)^{\\frac{n - 1}{a}},$$\n   其中 $\\mu_{\\infty}  0$，$\\Delta  0$，$\\lambda  0$，$a  0$，且 $n \\in (0,1)$。\n\n似然与最大似然估计：\n我们假设粘度上存在独立的、具有未知方差 $\\sigma^{2}$ 的高斯测量噪声：\n$$\\mu_{i}^{\\text{obs}} = \\mu(\\dot{\\gamma}_{i}; \\theta) + \\varepsilon_{i}, \\quad \\varepsilon_{i} \\sim \\mathcal{N}(0, \\sigma^{2}), \\quad i = 1, \\ldots, n.$$\n对于给定的参数矢量 $\\theta$ 和方差 $\\sigma^{2}$，似然函数为\n$$L(\\theta, \\sigma^{2} \\mid \\mu^{\\text{obs}}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi \\sigma^{2}}} \\exp\\left( -\\frac{[\\mu_{i}^{\\text{obs}} - \\mu(\\dot{\\gamma}_{i}; \\theta)]^{2}}{2 \\sigma^{2}} \\right).$$\n对应的对数似然为\n$$\\ell(\\theta, \\sigma^{2}) = -\\frac{n}{2}\\ln(2\\pi \\sigma^{2}) - \\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{n} [\\mu_{i}^{\\text{obs}} - \\mu(\\dot{\\gamma}_{i}; \\theta)]^{2}.$$\n定义残差平方和\n$$\\mathrm{RSS}(\\theta) = \\sum_{i=1}^{n} [\\mu_{i}^{\\text{obs}} - \\mu(\\dot{\\gamma}_{i}; \\theta)]^{2}.$$\n对于固定的 $\\theta$，$\\sigma^{2}$ 的最大似然估计量是\n$$\\hat{\\sigma}^{2}(\\theta) = \\frac{\\mathrm{RSS}(\\theta)}{n}.$$\n在关于 $\\theta$ 和 $\\sigma^{2}$ 的联合最大值处，令 $\\hat{\\theta}$ 是使 $\\mathrm{RSS}(\\theta)$ 最小化的值（非线性最小二乘法）。将 $\\hat{\\sigma}^{2} = \\mathrm{RSS}(\\hat{\\theta}) / n$ 代入 $\\ell$ 中，得到最大化对数似然值：\n$$\\ell(\\hat{\\theta}, \\hat{\\sigma}^{2}) = -\\frac{n}{2} \\left[ \\ln(2\\pi) + 1 + \\ln\\left( \\frac{\\mathrm{RSS}(\\hat{\\theta})}{n} \\right) \\right].$$\n\n信息准则：\n赤池信息准则 (AIC) 和贝叶斯信息准则 (BIC) 通过模型复杂度对最大化对数似然值进行惩罚。如果 $k_{\\text{model}}$ 是流变模型中的参数数量，并将 $\\sigma^{2}$ 作为一个额外的待估参数，则总参数数量为\n$$k = k_{\\text{model}} + 1.$$\n那么\n$$\\mathrm{AIC} = 2k - 2 \\ell(\\hat{\\theta}, \\hat{\\sigma}^{2}), \\quad \\mathrm{BIC} = k \\ln(n) - 2 \\ell(\\hat{\\theta}, \\hat{\\sigma}^{2}).$$\n较小的值表示在拟合优度和简约性之间有更好的权衡。\n\n算法设计：\n1. 对每个数据集，通过在给定参数下对指定的“真实”模型进行采样，并添加具有给定标准差的独立高斯噪声，来生成 $\\dot{\\gamma}_{i}$ 和 $\\mu_{i}^{\\text{obs}}$。$\\dot{\\gamma}$ 的单位是 $\\text{s}^{-1}$，$\\mu$ 的单位是 $\\text{Pa}\\cdot\\text{s}$。\n2. 对每个候选模型（Cross、Sisko、Carreau–Yasuda），使用有界非线性最小二乘法，通过最小化 $\\mathrm{RSS}(\\theta)$ 来拟合参数，这些界限强制了生理学上的合理性（$\\mu_{\\infty}  0$, $\\Delta  0$, $\\lambda  0$, $m  0$, $a  0$, $K  0$, 且 $n \\in (0,1)$）。这等价于高斯误差模型下的最大似然估计。\n3. 计算拟合参数的 $\\mathrm{RSS}(\\hat{\\theta})$、样本大小 $n$，然后使用上述表达式计算 $\\ell(\\hat{\\theta}, \\hat{\\sigma}^{2})$。\n4. 使用 $k = k_{\\text{model}} + 1$ 计算 $\\mathrm{AIC}$ 和 $\\mathrm{BIC}$，其中 Cross 模型的总参数为 $k_{\\text{total, Cross}} = 5$、Sisko 模型的总参数为 $k_{\\text{total, Sisko}} = 4$ 和 Carreau–Yasuda 模型的总参数为 $k_{\\text{total, CY}} = 6$。\n5. 分别在 AIC 和 BIC 准则下选择最佳模型（即准则值最小的模型）。将模型索引为 Cross $= 0$，Sisko $= 1$，Carreau–Yasuda $= 2$。\n6. 将三个数据集的选择结果聚合到一个列表的列表中，并遵循规定的输出格式。\n\n数值计算注意事项：\n- 使用有界非线性最小二乘法以避免非物理的参数区域。\n- 在典型的血液粘度值附近初始化参数，例如 $\\mu_{\\infty} \\approx 0.0035$, $\\Delta \\approx 0.05$, $\\lambda \\approx 1$, $m \\approx 2$, $a \\approx 2$, $n \\approx 0.3$, $K \\approx 0.01$。\n- 通过在对数函数内部添加一个小的正数下限，来防止 $\\mathrm{RSS}$ 值在数值上接近于零。\n- 通过为每个测试用例固定指定的随机种子来确保可复现性。\n\n程序将为所描述的三个数据集中的每一个，计算在赤池信息准则和贝叶斯信息准则下选定模型的索引，并将最终结果打印为包含三个内部列表的单个 Python 列表：$[[i_{\\text{AIC},1}, i_{\\text{BIC},1}], [i_{\\text{AIC},2}, i_{\\text{BIC},2}], [i_{\\text{AIC},3}, i_{\\text{BIC},3}]]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\n# Model index mapping:\n# 0 - Cross\n# 1 - Sisko\n# 2 - Carreau-Yasuda\n\ndef cross_viscosity(gamma, mu_inf, delta, lam, m):\n    # Cross model: mu = mu_inf + delta / (1 + (lam * gamma)^m)\n    return mu_inf + delta / (1.0 + (lam * gamma) ** m)\n\ndef sisko_viscosity(gamma, mu_inf, K, n):\n    # Sisko model: mu = mu_inf + K * gamma^(n - 1)\n    return mu_inf + K * gamma ** (n - 1.0)\n\ndef carreau_yasuda_viscosity(gamma, mu_inf, delta, lam, a, n):\n    # Carreau-Yasuda model: mu = mu_inf + delta * (1 + (lam * gamma)^a)^((n - 1)/a)\n    return mu_inf + delta * (1.0 + (lam * gamma) ** a) ** ((n - 1.0) / a)\n\ndef fit_model(model_name, gamma, mu_obs):\n    \"\"\"\n    Fit the specified model to data using bounded nonlinear least squares.\n    Returns (rss, lnL_hat, k_total) where k_total includes 1 for unknown noise variance.\n    \"\"\"\n    n = len(gamma)\n    # Bounds and initial guesses chosen for physiological plausibility.\n    if model_name == 'Cross':\n        # params: mu_inf, delta, lam, m\n        lb = np.array([0.001, 0.001, 0.01, 0.5])\n        ub = np.array([0.02, 0.2, 10.0, 4.0])\n        p0 = np.array([0.0035, 0.05, 1.0, 2.0])\n        model_func = cross_viscosity\n        k_model = 4\n    elif model_name == 'Sisko':\n        # params: mu_inf, K, n\n        lb = np.array([0.001, 1e-4, 0.1])\n        ub = np.array([0.02, 0.1, 1.0])\n        p0 = np.array([0.0035, 0.01, 0.3])\n        model_func = sisko_viscosity\n        k_model = 3\n    elif model_name == 'Carreau-Yasuda':\n        # params: mu_inf, delta, lam, a, n\n        lb = np.array([0.001, 0.001, 0.01, 0.5, 0.1])\n        ub = np.array([0.02, 0.2, 10.0, 4.0, 1.0])\n        p0 = np.array([0.0035, 0.05, 1.0, 2.0, 0.3])\n        model_func = carreau_yasuda_viscosity\n        k_model = 5\n    else:\n        raise ValueError(\"Unknown model name\")\n\n    # Curve fitting with bounds; increase max function evaluations for robustness.\n    try:\n        popt, _ = curve_fit(model_func, gamma, mu_obs, p0=p0, bounds=(lb, ub), maxfev=20000)\n        mu_fit = model_func(gamma, *popt)\n    except Exception:\n        # In rare case of fitting failure, fallback to initial parameters.\n        mu_fit = model_func(gamma, *p0)\n\n    residuals = mu_obs - mu_fit\n    rss = np.sum(residuals ** 2)\n    # Guard against numerical zero RSS\n    rss = max(rss, 1e-20)\n    lnL_hat = - (n / 2.0) * (np.log(2.0 * np.pi) + 1.0 + np.log(rss / n))\n    k_total = k_model + 1  # include sigma^2\n    return rss, lnL_hat, k_total\n\ndef aic(lnL_hat, k_total):\n    return 2.0 * k_total - 2.0 * lnL_hat\n\ndef bic(lnL_hat, k_total, n):\n    return k_total * np.log(n) - 2.0 * lnL_hat\n\ndef generate_dataset(test_id):\n    \"\"\"\n    Generate synthetic dataset according to the problem's test suite.\n    Returns (gamma, mu_obs)\n    \"\"\"\n    if test_id == 1:\n        # Carreau–Yasuda true parameters\n        mu_inf = 0.0035\n        delta = 0.0565\n        lam = 1.2\n        a = 2.0\n        n = 0.25\n        np.random.seed(42)\n        gamma = np.logspace(np.log10(0.1), np.log10(1000.0), 20)\n        mu_true = carreau_yasuda_viscosity(gamma, mu_inf, delta, lam, a, n)\n        noise_sigma = 0.0002\n    elif test_id == 2:\n        # Cross true parameters\n        mu_inf = 0.0040\n        delta = 0.0760\n        lam = 0.8\n        m = 1.0\n        np.random.seed(43)\n        gamma = np.logspace(np.log10(0.01), np.log10(10.0), 20)\n        mu_true = cross_viscosity(gamma, mu_inf, delta, lam, m)\n        noise_sigma = 0.0003\n    elif test_id == 3:\n        # Sisko true parameters\n        mu_inf = 0.0030\n        K = 0.0200\n        n = 0.70\n        np.random.seed(44)\n        gamma = np.logspace(np.log10(1.0), np.log10(1000.0), 12)\n        mu_true = sisko_viscosity(gamma, mu_inf, K, n)\n        noise_sigma = 0.0004\n    else:\n        raise ValueError(\"Unknown test_id\")\n\n    noise = np.random.normal(loc=0.0, scale=noise_sigma, size=gamma.shape)\n    mu_obs = mu_true + noise\n    # Ensure positivity of viscosity\n    mu_obs = np.clip(mu_obs, 1e-6, None)\n    return gamma, mu_obs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [1, 2, 3]\n\n    results = []\n    for case in test_cases:\n        gamma, mu_obs = generate_dataset(case)\n        n = len(gamma)\n\n        # Fit all models\n        rss_cross, lnL_cross, k_cross = fit_model('Cross', gamma, mu_obs)\n        rss_sisko, lnL_sisko, k_sisko = fit_model('Sisko', gamma, mu_obs)\n        rss_cy, lnL_cy, k_cy = fit_model('Carreau-Yasuda', gamma, mu_obs)\n\n        # Compute AIC and BIC\n        aic_vals = [\n            aic(lnL_cross, k_cross),\n            aic(lnL_sisko, k_sisko),\n            aic(lnL_cy, k_cy)\n        ]\n        bic_vals = [\n            bic(lnL_cross, k_cross, n),\n            bic(lnL_sisko, k_sisko, n),\n            bic(lnL_cy, k_cy, n)\n        ]\n\n        # Select best model indices (0: Cross, 1: Sisko, 2: Carreau–Yasuda)\n        best_aic_idx = int(np.argmin(aic_vals))\n        best_bic_idx = int(np.argmin(bic_vals))\n\n        results.append([best_aic_idx, best_bic_idx])\n\n    # Final print statement in the exact required format.\n    # Print as a Python list of lists: e.g., [[0,2],[1,1],[2,2]]\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}