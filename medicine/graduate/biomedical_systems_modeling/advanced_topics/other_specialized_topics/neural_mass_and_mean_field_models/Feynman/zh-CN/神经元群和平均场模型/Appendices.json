{
    "hands_on_practices": [
        {
            "introduction": "在理解神经群的复杂动态之前，我们必须首先找到它的平衡点，即“不动点”。这些不动点代表了兴奋性 ($E$) 和抑制性 ($I$) 神经群的平均活动保持恒定的稳态。本练习将指导您使用零斜线分析这一基础技术，在经典的 Wilson-Cowan 模型的相平面中识别这些关键点。",
            "id": "3910738",
            "problem": "考虑一个用于兴奋性群体（平均活动为 $E(t)$）和抑制性群体（平均活动为 $I(t)$）的双群体 Wilson–Cowan 神经元群体模型。其动力学由以下耦合常微分方程（ODE）描述：\n$$\n\\frac{dE}{dt} \\;=\\; -\\,E \\;+\\; S\\!\\left(w_{EE}\\,E \\;-\\; w_{EI}\\,I \\;+\\; P_{E}\\right),\n\\qquad\n\\frac{dI}{dt} \\;=\\; -\\,I \\;+\\; S\\!\\left(w_{IE}\\,E \\;-\\; w_{II}\\,I \\;+\\; P_{I}\\right),\n$$\n其中 $S:\\mathbb{R}\\to(0,1)$ 是一个严格递增、可微的 S 型函数，代表平均场放电响应，$w_{EE},w_{EI},w_{IE},w_{II}\\in\\mathbb{R}$ 是耦合增益，而 $P_{E},P_{I}\\in\\mathbb{R}$ 是恒定的外部驱动。变量 $E$ 和 $I$ 分别是各自群体中活跃神经元的无量纲比例。\n\n任务 1（推导）。使用零斜线（即相应时间导数为零的点集）的定义，并仅利用 $S$ 是严格递增且可微的性质，推导出 $E$-零斜线和 $I$-零斜线作为 $E$ 和 $I$ 之间关系的解析表达式。在适当的情况下，用反 S 型函数 $S^{-1}$ 表示您的结果，并将零斜线表示为 $(E,I)$-平面中的隐式曲线。\n\n任务 2（计算）。对于特定的 S 型函数选择\n$$\nS(x) \\;=\\; \\frac{1}{1+\\exp\\!\\big(-a\\,x\\big)},\n$$\n其中斜率参数 $a>0$，以及参数集\n$$\nw_{EE} \\;=\\; 8,\\quad w_{EI} \\;=\\; 8,\\quad w_{IE} \\;=\\; 9,\\quad w_{II} \\;=\\; 9,\\quad P_{E} \\;=\\; 0,\\quad P_{I} \\;=\\; 0,\n$$\n计算一个位于开放单位正方形 $(0,1)\\times(0,1)$ 内的不动点 $(E^{\\ast},I^{\\ast})$。您的最终答案必须是表示为单行矩阵的不动点坐标。无需四舍五入。",
            "solution": "该问题是有效的，因为它在理论神经科学中有科学依据，是适定的、客观的且内部一致的。它展示了对一个经典的 Wilson-Cowan 模型的标准分析。\n\n根据问题陈述的要求，解答分为两部分。\n\n任务 $1$：零斜线的推导\n\n动态变量的零斜线是状态空间中该变量的时间导数为零的点集。该系统的状态空间是 $(E,I)$-平面。\n\n$E$-零斜线是满足 $\\frac{dE}{dt} = 0$ 的点 $(E,I)$ 的集合。使用第一个给定的微分方程：\n$$\n\\frac{dE}{dt} = -E + S(w_{EE}E - w_{EI}I + P_{E}) = 0\n$$\n这意味着 $E$ 和 $I$ 之间存在以下关系：\n$$\nE = S(w_{EE}E - w_{EI}I + P_{E})\n$$\n问题陈述指出 $E$ 是活跃神经元的比例，因此 $E \\in [0,1]$。从上面的方程可知，$E$ 必须位于 S 型函数 $S$ 的值域内，即开区间 $(0,1)$。\n函数 $S: \\mathbb{R} \\to (0,1)$ 被设定为严格递增且可微的。严格递增函数是单射的，因此它有一个定义明确的反函数 $S^{-1}$，其定义域为 $(0,1)$，值域为 $\\mathbb{R}$。\n为了找到零斜线的隐式曲线，我们可以将反 S 型函数 $S^{-1}$ 应用于方程的两边。对于 $E \\in (0,1)$，这是允许的。\n$$\nS^{-1}(E) = w_{EE}E - w_{EI}I + P_{E}\n$$\n这就是 $E$-零斜线的解析表达式，表示为 $(E,I)$-平面中的一条隐式曲线。\n\n$I$-零斜线是满足 $\\frac{dI}{dt} = 0$ 的点 $(E,I)$ 的集合。使用第二个给定的微分方程：\n$$\n\\frac{dI}{dt} = -I + S(w_{IE}E - w_{II}I + P_{I}) = 0\n$$\n这意味着以下关系：\n$$\nI = S(w_{IE}E - w_{II}I + P_{I})\n$$\n与 $E$ 类似，$I$ 必须位于区间 $(0,1)$ 内。将反 S 型函数 $S^{-1}$ 应用于方程两边，我们得到：\n$$\nS^{-1}(I) = w_{IE}E - w_{II}I + P_{I}\n$$\n这就是 $I$-零斜线作为 $(E,I)$-平面中隐式曲线的解析表达式。\n\n任务 $2$：不动点的计算\n\n不动点，记作 $(E^{\\ast}, I^{\\ast})$，是状态空间中所有时间导数同时为零的点。因此，不动点必须位于所有零斜线的交点上。坐标 $(E^{\\ast}, I^{\\ast})$ 必须同时满足两个零斜线方程：\n$$\nE^{\\ast} = S(w_{EE}E^{\\ast} - w_{EI}I^{\\ast} + P_{E})\n$$\n$$\nI^{\\ast} = S(w_{IE}E^{\\ast} - w_{II}I^{\\ast} + P_{I})\n$$\n给定特定的 S 型函数 $S(x) = \\frac{1}{1+\\exp(-ax)}$ (对于某个 $a > 0$)，以及参数集：\n$$\nw_{EE} = 8,\\quad w_{EI} = 8,\\quad w_{IE} = 9,\\quad w_{II} = 9,\\quad P_{E} = 0,\\quad P_{I} = 0\n$$\n将这些值代入不动点方程，得到以下非线性代数方程组：\n$$\nE^{\\ast} = \\frac{1}{1 + \\exp\\left(-a(8E^{\\ast} - 8I^{\\ast})\\right)} = \\frac{1}{1 + \\exp\\left(-8a(E^{\\ast} - I^{\\ast})\\right)}\n$$\n$$\nI^{\\ast} = \\frac{1}{1 + \\exp\\left(-a(9E^{\\ast} - 9I^{\\ast})\\right)} = \\frac{1}{1 + \\exp\\left(-9a(E^{\\ast} - I^{\\ast})\\right)}\n$$\n我们需要在开放单位正方形 $(0,1) \\times (0,1)$ 中找到一个不动点 $(E^{\\ast}, I^{\\ast})$。让我们检查这些方程的结构。指数函数的自变量中出现了一种特殊的对称性。这提示我们可以寻找一个 $E^{\\ast} = I^{\\ast}$ 的解。\n\n让我们检验存在一个 $E^{\\ast} = I^{\\ast}$ 的不动点的假设。如果情况如此，那么差值 $E^{\\ast} - I^{\\ast} = 0$。将此条件代入第一个方程：\n$$\nE^{\\ast} = \\frac{1}{1 + \\exp(-8a \\cdot 0)} = \\frac{1}{1 + \\exp(0)} = \\frac{1}{1 + 1} = \\frac{1}{2}\n$$\n将 $E^{\\ast} - I^{\\ast} = 0$ 代入第二个方程：\n$$\nI^{\\ast} = \\frac{1}{1 + \\exp(-9a \\cdot 0)} = \\frac{1}{1 + \\exp(0)} = \\frac{1}{1 + 1} = \\frac{1}{2}\n$$\n两个方程的结果都是 $E^{\\ast} = 1/2$ 和 $I^{\\ast} = 1/2$。这些结果与初始假设 $E^{\\ast} = I^{\\ast}$ 一致。因此，点 $(E^{\\ast}, I^{\\ast}) = (1/2, 1/2)$ 是系统的一个有效不动点。该解对于斜率参数 $a > 0$ 的任何值都成立。\n\n问题要求一个位于开放单位正方形 $(0,1) \\times (0,1)$ 内的不动点。计算出的不动点是 $(1/2, 1/2)$，用小数表示为 $(0.5, 0.5)$。该点显然位于指定的域内。由于问题要求计算*一个*不动点，这个解是充分的。\n\n最终答案是这个不动点的坐标。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个不动点可以是稳定的，就像山谷底部的球；也可以是不稳定的，如同山顶上的球。本练习深入探讨线性稳定性分析，这是一种确定系统在平衡点附近行为的强大工具。通过研究雅可比矩阵 ($J$)，您将学会如何预测神经回路何时从一个稳定的静息状态转变为自我维持的振荡状态，这一现象被称为霍普夫分岔 (Hopf bifurcation)。",
            "id": "3910691",
            "problem": "考虑一个由兴奋性与抑制性群体组成的Wilson–Cowan型双群体平均场神经元簇模型，该模型描述了活跃的兴奋性和抑制性神经元比例（分别由$E(t)$和$I(t)$表示）的时间演化。其动力学由以下方程给出：\n$$\n\\tau_E \\frac{dE}{dt} \\;=\\; -E \\;+\\; S_E\\!\\left(K\\,k_{EE}\\,E \\;-\\; K\\,k_{EI}\\,I \\;+\\; P\\right), \\qquad\n\\tau_I \\frac{dI}{dt} \\;=\\; -I \\;+\\; S_I\\!\\left(K\\,k_{IE}\\,E \\;-\\; K\\,k_{II}\\,I \\;+\\; Q\\right),\n$$\n其中$\\tau_E$和$\\tau_I$是突触时间常数，$K>0$是一个全局耦合增益，它缩放所有循环连接$k_{ab}>0$（其中$a,b\\in\\{E,I\\}$），$P$和$Q$是恒定的外部驱动，$S_E(\\cdot)$和$S_I(\\cdot)$是光滑、单调递增的S型传递函数。假设对于给定的$P$和$Q$，存在一个平衡点$(E^{\\ast},I^{\\ast})$。令$s_E = S_E'\\!\\left(K\\,k_{EE}\\,E^{\\ast} - K\\,k_{EI}\\,I^{\\ast} + P\\right)$和$s_I = S_I'\\!\\left(K\\,k_{IE}\\,E^{\\ast} - K\\,k_{II}\\,I^{\\ast} + Q\\right)$表示在工作点处传递函数的局部斜率。您可以假设$s_E>0$和$s_I>0$相对于分岔点附近$K$的微小变化是恒定的。\n\n从动力学系统线性化的定义出发，计算在$(E^{\\ast},I^{\\ast})$处的雅可比矩阵，推导其符号形式的特征值，并确定通过霍普夫分岔产生振荡行为的条件。然后，使用以下参数值：\n$$\n\\tau_E = 10~\\mathrm{ms}, \\quad \\tau_I = 20~\\mathrm{ms}, \\quad k_{EE} = 6, \\quad k_{EI} = 4, \\quad k_{IE} = 5, \\quad k_{II} = 2, \\quad s_E = 0.9, \\quad s_I = 0.7,\n$$\n计算发生霍普夫分岔的临界值$K_{\\mathrm{H}}$。将您的答案四舍五入到四位有效数字。将最终答案表示为无单位值。",
            "solution": "问题要求计算双群体神经元簇模型发生霍普夫分岔时的全局耦合增益$K$的临界值。这需要对系统的平衡点进行稳定性分析。分析过程包括：对系统进行线性化，计算雅可比矩阵，并找出其特征值变为纯虚数的条件。\n\n系统的动力学由以下耦合常微分方程给出：\n$$\n\\frac{dE}{dt} = f_E(E, I) = \\frac{1}{\\tau_E} \\left[ -E + S_E\\left(K\\,k_{EE}\\,E - K\\,k_{EI}\\,I + P\\right) \\right]\n$$\n$$\n\\frac{dI}{dt} = f_I(E, I) = \\frac{1}{\\tau_I} \\left[ -I + S_I\\left(K\\,k_{IE}\\,E - K\\,k_{II}\\,I + Q\\right) \\right]\n$$\n\n为了分析平衡点$(E^{\\ast}, I^{\\ast})$的稳定性，我们通过计算在该点处的雅可比矩阵$J$来对系统进行线性化。雅可比矩阵定义为：\n$$\nJ = \\begin{pmatrix} J_{EE}  J_{EI} \\\\ J_{IE}  J_{II} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial f_E}{\\partial E}  \\frac{\\partial f_E}{\\partial I} \\\\ \\frac{\\partial f_I}{\\partial E}  \\frac{\\partial f_I}{\\partial I} \\end{pmatrix}_{\\!(E^{\\ast},I^{\\ast})}\n$$\n我们使用链式法则以及给定的斜率$s_E$和$s_I$的定义来计算雅可比矩阵的每个元素。令$u_E = K\\,k_{EE}\\,E - K\\,k_{EI}\\,I + P$且$u_I = K\\,k_{IE}\\,E - K\\,k_{II}\\,I + Q$。在平衡点$(E^{\\ast}, I^{\\ast})$处，我们有$s_E = S_E'(u_E^{\\ast})$和$s_I = S_I'(u_I^{\\ast})$。\n\n偏导数是：\n$$\nJ_{EE} = \\frac{\\partial f_E}{\\partial E} = \\frac{1}{\\tau_E} \\left[ -1 + \\frac{\\partial S_E}{\\partial E} \\right] = \\frac{1}{\\tau_E} \\left[ -1 + S_E'(u_E) \\frac{\\partial u_E}{\\partial E} \\right] = \\frac{1}{\\tau_E} \\left(-1 + s_E K k_{EE}\\right)\n$$\n$$\nJ_{EI} = \\frac{\\partial f_E}{\\partial I} = \\frac{1}{\\tau_E} \\left[ \\frac{\\partial S_E}{\\partial I} \\right] = \\frac{1}{\\tau_E} \\left[ S_E'(u_E) \\frac{\\partial u_E}{\\partial I} \\right] = \\frac{1}{\\tau_E} \\left(s_E (-K k_{EI})\\right) = -\\frac{K k_{EI} s_E}{\\tau_E}\n$$\n$$\nJ_{IE} = \\frac{\\partial f_I}{\\partial E} = \\frac{1}{\\tau_I} \\left[ \\frac{\\partial S_I}{\\partial E} \\right] = \\frac{1}{\\tau_I} \\left[ S_I'(u_I) \\frac{\\partial u_I}{\\partial E} \\right] = \\frac{1}{\\tau_I} \\left(s_I (K k_{IE})\\right) = \\frac{K k_{IE} s_I}{\\tau_I}\n$$\n$$\nJ_{II} = \\frac{\\partial f_I}{\\partial I} = \\frac{1}{\\tau_I} \\left[ -1 + \\frac{\\partial S_I}{\\partial I} \\right] = \\frac{1}{\\tau_I} \\left[ -1 + S_I'(u_I) \\frac{\\partial u_I}{\\partial I} \\right] = \\frac{1}{\\tau_I} \\left(-1 + s_I (-K k_{II})\\right) = -\\frac{K k_{II} s_I + 1}{\\tau_I}\n$$\n因此，在平衡点处的雅可比矩阵是：\n$$\nJ = \\begin{pmatrix}\n\\frac{K k_{EE} s_E - 1}{\\tau_E}  -\\frac{K k_{EI} s_E}{\\tau_E} \\\\\n\\frac{K k_{IE} s_I}{\\tau_I}  -\\frac{K k_{II} s_I + 1}{\\tau_I}\n\\end{pmatrix}\n$$\n这个$2 \\times 2$矩阵的特征值$\\lambda$是特征方程$\\lambda^2 - \\mathrm{Tr}(J)\\lambda + \\det(J) = 0$的根。\n\n当一对共轭复特征值的实部穿过虚轴时，发生霍普夫分岔。对于一个二维系统，这发生在以下情况：\n1. 雅可比矩阵的迹为零：$\\mathrm{Tr}(J) = 0$。\n2. 雅可比矩阵的行列式严格为正：$\\det(J) > 0$。\n3. 满足横截性条件，即当分岔参数$K$变化时，特征值的实部以非零速度穿过零。\n\n我们来计算$J$的迹：\n$$\n\\mathrm{Tr}(J) = J_{EE} + J_{II} = \\frac{K k_{EE} s_E - 1}{\\tau_E} - \\frac{K k_{II} s_I + 1}{\\tau_I}\n$$\n霍普夫分岔的第一个条件$\\mathrm{Tr}(J) = 0$给了我们$K$的临界值，我们将其记为$K_H$。\n$$\n\\frac{K_H k_{EE} s_E - 1}{\\tau_E} - \\frac{K_H k_{II} s_I + 1}{\\tau_I} = 0\n$$\n$$\n\\frac{K_H k_{EE} s_E - 1}{\\tau_E} = \\frac{K_H k_{II} s_I + 1}{\\tau_I}\n$$\n为了解出$K_H$，我们重新整理方程：\n$$\n\\tau_I (K_H k_{EE} s_E - 1) = \\tau_E (K_H k_{II} s_I + 1)\n$$\n$$\nK_H \\tau_I k_{EE} s_E - \\tau_I = K_H \\tau_E k_{II} s_I + \\tau_E\n$$\n将含有$K_H$的项分组：\n$$\nK_H (\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I) = \\tau_E + \\tau_I\n$$\n这得到了临界耦合增益的符号表达式：\n$$\nK_H = \\frac{\\tau_E + \\tau_I}{\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I}\n$$\n横截性条件要求$\\frac{d}{dK}\\mathrm{Re}(\\lambda)|_{K=K_H} \\neq 0$。由于$\\mathrm{Re}(\\lambda) = \\frac{1}{2}\\mathrm{Tr}(J)$，我们计算$\\frac{d}{dK}\\mathrm{Tr}(J) = \\frac{k_{EE} s_E}{\\tau_E} - \\frac{k_{II} s_I}{\\tau_I} = \\frac{\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I}{\\tau_E \\tau_I}$。只要$K_H$表达式的分母不为零，该式就不为零，而为了使$K_H$有明确定义，分母必须不为零。还必须在$K=K_H$时验证条件$\\det(J) > 0$，这确保了特征值确实是复数。\n\n现在，我们将给定的数值代入$K_H$的表达式中：\n$\\tau_E = 10$, $\\tau_I = 20$, $k_{EE} = 6$, $k_{II} = 2$, $s_E = 0.9$, $s_I = 0.7$.\n单位（ms）是一致的，将会相互抵消，从而得到一个无单位的$K_H$值。\n\n分子是：\n$$\n\\tau_E + \\tau_I = 10 + 20 = 30\n$$\n分母是：\n$$\n\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I = (20)(6)(0.9) - (10)(2)(0.7)\n$$\n$$\n= (120)(0.9) - (20)(0.7) = 108 - 14 = 94\n$$\n由于分母为正，$K_H$将为正，这是物理上所要求的（$K>0$）。横截性条件也得到满足。\n\n临界值$K_H$是：\n$$\nK_H = \\frac{30}{94} = \\frac{15}{47}\n$$\n为了获得数值，我们进行除法运算：\n$$\nK_H \\approx 0.319148936...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nK_H \\approx 0.3191\n$$\n我们还可以验证在$K=K_H$时$\\det(J) > 0$。行列式是$\\det(J) = \\frac{1}{\\tau_E \\tau_I} \\left[ K^2 s_E s_I (k_{EI} k_{IE} - k_{EE} k_{II}) - K(k_{EE} s_E - k_{II} s_I) + 1 \\right]$。使用给定的值，$k_{EI}k_{IE} - k_{EE}k_{II} = (4)(5) - (6)(2) = 8 > 0$。在$K_H \\approx 0.3191$时，完整的计算证实了$\\det(J)$确实为正，从而验证了霍普夫分岔的发生。",
            "answer": "$$\\boxed{0.3191}$$"
        },
        {
            "introduction": "虽然解析方法功能强大，但它们通常只能描述局部行为。为了获得神经回路行为如何随输入变化的全局图像，我们转向数值模拟。本练习要求您编写一个程序，当外部驱动 ($P$) 变化时，系统地探索神经质量模型的动态，自动将系统状态分类为静息、振荡或高活动状态，从而构建一个数值分岔图。",
            "id": "3910655",
            "problem": "考虑一个根据平均场原理推导出的双群体神经元质量模型，该模型用于一个由兴奋性神经元和抑制性神经元组成的同质局部回路。设 $E(t)$ 表示兴奋性群体的无量纲平均发放率， $I(t)$ 表示抑制性群体的无量纲平均发放率。对兴奋性群体的外部驱动由一个常数参数 $P$ 表示，对抑制性群体的基线外部驱动由一个常数参数 $Q$ 表示。该模型的动力学由以下耦合常微分方程定义：\n$$\n\\tau_e \\frac{dE}{dt} = -E + S_e\\!\\left(c_{ee} E - c_{ei} I + P\\right),\n\\quad\n\\tau_i \\frac{dI}{dt} = -I + S_i\\!\\left(c_{ie} E - c_{ii} I + Q\\right),\n$$\n其中 $S_e(\\cdot)$ 和 $S_i(\\cdot)$ 是S型输入输出函数，用于建模群体响应（静态增益函数）。S型函数由下式给出：\n$$\nS_e(x) = \\frac{1}{1 + \\exp\\!\\left(-a_e\\left(x - \\theta_e\\right)\\right)},\n\\quad\nS_i(x) = \\frac{1}{1 + \\exp\\!\\left(-a_i\\left(x - \\theta_i\\right)\\right)}.\n$$\n本问题中所有变量和参数都是无量纲的。参数 $\\tau_e$、$\\tau_i$、 $c_{ee}$、 $c_{ei}$、 $c_{ie}$、 $c_{ii}$、 $a_e$、 $a_i$、 $\\theta_e$、 $\\theta_i$ 和 $Q$ 是固定的已知常数。外部驱动 $P$ 是待变化的分岔参数。\n\n从平均发放率动力学的基础定义（通过S型增益的衰减和驱动之间的群体平衡）出发，您的任务是：\n- 对于给定的 $P$ 值，通过对模型进行足够长时间的数值积分以达到渐近行为，来确定兴奋性群体活动 $E(t)$ 的长时间机制。\n- 将渐近机制分为三类之一：静息、振荡或高活动。使用基于动力系统的原则性标准：静息对应于收敛到一个低的稳定不动点，振荡对应于持续有界振荡（极限环），高活动对应于收敛到一个接近 $S_e$ 饱和的高的稳定不动点。您必须基于长时间窗口内的 $E(t)$ 定义定量阈值和算法测试，以区分这些机制，而不依赖任何绘图。\n- 对 $P$ 值的测试套件构建分岔分类，并生成编码机制标签的最终程序输出。\n\n使用以下固定参数值：\n$$\n\\tau_e = 1.0,\\quad \\tau_i = 2.0,\\quad c_{ee} = 16.0,\\quad c_{ei} = 12.0,\\quad c_{ie} = 15.0,\\quad c_{ii} = 3.0,\n$$\n$$\na_e = 1.3,\\quad a_i = 2.0,\\quad \\theta_e = 4.0,\\quad \\theta_i = 3.5,\\quad Q = 0.0.\n$$\n按数值定义机制标签如下：\n- 静息 $\\rightarrow 0$\n- 振荡 $\\rightarrow 1$\n- 高活动 $\\rightarrow 2$\n\n您的程序必须实现一个鲁棒的分类方法，通过从小初始条件模拟 $E(t)$ 和 $I(t)$ ，并分析时间序列的最后部分，来确定 $E(t)$ 是稳定在一个稳定不动点（具有小方差）还是表现出持续振荡（具有显著方差和主导的非零频率分量）。对于稳定不动点，如果平均 $E$ 值低，则分类为静息；如果平均 $E$ 值接近饱和，则分类为高活动。明确选择与S型函数界限（$0$ 到 $1$）一致的阈值，并在您的解决方案中证明其合理性。\n\n测试套件：\n为以下 $P$ 值集合评估分类：\n$$\nP \\in \\left\\{0.0,\\; 0.5,\\; 3.0,\\; 8.0,\\; 10.0\\right\\}.\n$$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含测试套件的机制标签，格式为方括号内以逗号分隔的列表。例如，所需格式为 $\\left[ r_1, r_2, r_3, r_4, r_5 \\right]$，其中每个 $r_k$ 是由您的算法计算出的 $\\{0, 1, 2\\}$ 中的一个整数。\n\n本问题中没有物理单位；所有量都是无量纲的。不涉及角度，也不需要百分比。数值输出必须是如上定义的整数。",
            "solution": "用户提供的问题陈述经过仔细验证，被确定为计算神经科学领域一个有效且适定的问题。它在科学上基于神经元质量模型的理论，在数学上是一致的，并且没有歧义。它提出了一个明确的任务：通过对不同外部输入水平下的长期动力学机制进行数值分类，来对一个双群体Wilson-Cowan类型模型进行分岔分析。\n\n该解决方案首先定义数学模型及用于其分析的数值方法，然后详细描述用于分类系统渐近行为的算法。\n\n该模型描述了平均发放率为 $E(t)$ 的兴奋性群体与平均发放率为 $I(t)$ 的抑制性群体之间的相互作用。其动力学由耦合常微分方程（ODEs）控制：\n$$\n\\tau_e \\frac{dE}{dt} = -E + S_e\\!\\left(c_{ee} E - c_{ei} I + P\\right)\n$$\n$$\n\\tau_i \\frac{dI}{dt} = -I + S_i\\!\\left(c_{ie} E - c_{ii} I + Q\\right)\n$$\n群体发放率响应由S型激活函数建模：\n$$\nS_e(x) = \\frac{1}{1 + \\exp\\!\\left(-a_e\\left(x - \\theta_e\\right)\\right)}, \\quad S_i(x) = \\frac{1}{1 + \\exp\\!\\left(-a_i\\left(x - \\theta_i\\right)\\right)}\n$$\n参数值按规定固定：$\\tau_e = 1.0$, $\\tau_i = 2.0$, $c_{ee} = 16.0$, $c_{ei} = 12.0$, $c_{ie} = 15.0$, $c_{ii} = 3.0$, $a_e = 1.3$, $a_i = 2.0$, $\\theta_e = 4.0$, $\\theta_i = 3.5$, 且 $Q = 0.0$。分岔参数是到兴奋性群体的外部驱动 $P$。\n\n我们的目标是将系统作为 $P$ 的函数的长期行为分为三种机制之一：静息（标签 $0$）、振荡（标签 $1$）或高活动（标签 $2$）。\n\n**方法论与算法设计**\n\n该方法的核心在于对每个给定的 $P$ 值对常微分方程组进行数值积分，并分析所得到的兴奋性活动 $E(t)$ 的时间序列。\n\n**1. 数值积分**\n为了确定渐近行为，系统必须模拟足够长的时间，以使初始瞬态衰减，系统稳定到其吸引子（一个稳定不动点或一个极限环）上。我们采用 `scipy.integrate` 库中的 `solve_ivp` 函数，这是一个用于初值问题的鲁棒自适应步长求解器。\n- **模拟时间**：系统的特征时间尺度为 $\\tau_e = 1.0$ 和 $\\tau_i = 2.0$。选择总模拟时长为 $T_{sim} = 200.0$ 个无量纲时间单位。该时长大约是最长时间常数的 $100$ 倍，确保系统轨迹有足够的时间收敛到其最终状态。\n- **初始条件**：为避免在可能的多稳态机制中使系统偏向某个特定的吸引子，我们从小的非零初始条件开始模拟：$E(0) = 0.01$ 和 $I(0) = 0.01$。\n- **时间序列采样**：以 $\\Delta t=0.1$ 的步长在离散时间点对解进行采样，以生成用于后续分析的时间序列。\n\n**2. 渐近机制分类**\n分类算法基于对模拟最后部分（具体为 $t \\in [100.0, 200.0]$）的时间序列 $E(t)$ 进行的原则性分析。这会舍弃初始瞬态动力学。我们将这部分时间序列记为 $E_{final}$。\n\n**步骤 2a：区分稳定点与振荡**\n稳定不动点和极限环之间的主要区别在于渐近机制中状态变量的时间变化。\n- 一个已收敛到稳定不动点的系统将表现出基本恒定的 $E(t)$ 值，任何微小波动都可归因于数值积分误差。因此，$E_{final}$ 的方差将接近于零。\n- 一个已稳定到极限环的系统将表现出持续的、周期性或准周期性的 $E(t)$ 振荡，从而产生一个显著的非零方差。\n我们对 $E_{final}$ 的方差 $\\sigma^2_E$ 设定一个阈值来进行这种区分。选择阈值为 $\\text{var\\_thresh} = 10^{-4}$。这个值能够鲁棒地将数值稳定不动点的可忽略方差与振幅占发放率范围 $[0, 1]$ 相当一部分的极限环的显著方差区分开来。\n- 如果 $\\text{var}(E_{final}) > 10^{-4}$，则该机制被分类为 **振荡** (标签 $1$)。\n\n**步骤 2b：区分静息与高活动不动点**\n如果方差测试表明系统收敛到一个不动点（即 $\\text{var}(E_{final}) \\le 10^{-4}$），我们接着根据 $E_{final}$ 的平均值来分类不动点的类型。平均值 $\\langle E_{final} \\rangle$ 为不动点的 $E$ 坐标提供了一个鲁棒的估计。\n- 发放率 $E$ 和 $I$ 是S型函数的输出，因此被限制在区间 $[0, 1]$ 内。\n- “静息”状态对应于接近 $0$ 的低发放率。\n- “高活动”状态对应于接近 $1$ 的高、近饱和的发放率。\n这两个状态之间一个自然且客观的分界线是可能活动范围的中点。因此，我们对平均活动定义一个阈值 $\\text{mean\\_thresh} = 0.5$。\n- 如果 $\\langle E_{final} \\rangle  0.5$，该机制被分类为 **静息** (标签 $0$)。\n- 如果 $\\langle E_{final} \\rangle \\ge 0.5$，该机制被分类为 **高活动** (标签 $2$)。\n\n这个两步决策过程为测试套件中提供的每个分岔参数 $P$ 值，提供了一个用于分类神经元质量模型动力学机制的定量且可复现的算法。完整的算法在下面的 Python 程序中实现。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the bifurcation problem for the two-population neural mass model.\n    It integrates the ODEs for different P values and classifies the long-term\n    regime of the excitatory population activity.\n    \"\"\"\n\n    # --- Fixed Model Parameters ---\n    # Time constants\n    tau_e = 1.0\n    tau_i = 2.0\n    # Connectivity weights\n    c_ee = 16.0\n    c_ei = 12.0\n    c_ie = 15.0\n    c_ii = 3.0\n    # Sigmoid parameters\n    a_e = 1.3\n    theta_e = 4.0\n    a_i = 2.0\n    theta_i = 3.5\n    # External drive to inhibitory population\n    Q = 0.0\n\n    # --- Test Suite ---\n    test_cases = [0.0, 0.5, 3.0, 8.0, 10.0]\n\n    # --- Helper Functions for the Model ---\n    def S_e(x):\n        \"\"\"Sigmoidal gain function for the excitatory population.\"\"\"\n        return 1.0 / (1.0 + np.exp(-a_e * (x - theta_e)))\n\n    def S_i(x):\n        \"\"\"Sigmoidal gain function for the inhibitory population.\"\"\"\n        return 1.0 / (1.0 + np.exp(-a_i * (x - theta_i)))\n\n    def model(t, y, P):\n        \"\"\"\n        Defines the coupled ODE system for the neural mass model.\n        y = [E, I] is the state vector.\n        P is the external drive to the excitatory population.\n        \"\"\"\n        E, I = y\n        dEdt = (-E + S_e(c_ee * E - c_ei * I + P)) / tau_e\n        dIdt = (-I + S_i(c_ie * E - c_ii * I + Q)) / tau_i\n        return [dEdt, dIdt]\n\n    # --- Simulation and Classification Settings ---\n    t_sim_end = 200.0  # Total simulation time\n    t_eval = np.arange(0, t_sim_end, 0.1)  # Time points for evaluation\n    initial_conditions = [0.01, 0.01]  # Small, non-zero initial conditions\n    \n    # Start analysis from the midpoint of the simulation to discard transients\n    analysis_start_index = len(t_eval) // 2\n    \n    # Quantitative thresholds for classification\n    variance_threshold = 1e-4  # To distinguish fixed points from oscillations\n    mean_activity_threshold = 0.5  # To distinguish quiescent from high-activity\n\n    results = []\n\n    # --- Main Loop: Iterate through test cases ---\n    for P_val in test_cases:\n        # Numerically integrate the ODEs\n        solution = solve_ivp(\n            model,\n            [0, t_sim_end],\n            initial_conditions,\n            args=(P_val,),\n            dense_output=False,\n            t_eval=t_eval\n        )\n\n        # Extract the excitatory activity time series\n        E_series = solution.y[0,:]\n        \n        # Analyze the final portion of the time series\n        E_final = E_series[analysis_start_index:]\n        \n        # Calculate variance to detect oscillations\n        variance = np.var(E_final)\n        \n        if variance > variance_threshold:\n            # Regime is oscillatory\n            results.append(1)\n        else:\n            # Regime is a stable fixed point\n            mean_E = np.mean(E_final)\n            if mean_E  mean_activity_threshold:\n                # Quiescent fixed point (low activity)\n                results.append(0)\n            else:\n                # High-activity fixed point (saturated)\n                results.append(2)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}