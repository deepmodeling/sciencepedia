{
    "hands_on_practices": [
        {
            "introduction": "Understanding the behavior of any dynamical system begins with identifying its equilibrium states. This practice introduces the fundamental technique of nullcline analysis for a classic Wilson–Cowan neural mass model . By finding the curves in the state space where the activity of each neural population ceases to change, you will learn to geometrically and algebraically locate the system's fixed points, which represent its potential steady states.",
            "id": "3910738",
            "problem": "Consider a two-population Wilson–Cowan neural mass model for an excitatory population with mean activity $E(t)$ and an inhibitory population with mean activity $I(t)$. The dynamics are described by the coupled ordinary differential equations (ODEs)\n$$\n\\frac{dE}{dt} \\;=\\; -\\,E \\;+\\; S\\!\\left(w_{EE}\\,E \\;-\\; w_{EI}\\,I \\;+\\; P_{E}\\right),\n\\qquad\n\\frac{dI}{dt} \\;=\\; -\\,I \\;+\\; S\\!\\left(w_{IE}\\,E \\;-\\; w_{II}\\,I \\;+\\; P_{I}\\right),\n$$\nwhere $S:\\mathbb{R}\\to(0,1)$ is a strictly increasing, differentiable sigmoid function representing the mean-field firing response, $w_{EE},w_{EI},w_{IE},w_{II}\\in\\mathbb{R}$ are coupling gains, and $P_{E},P_{I}\\in\\mathbb{R}$ are constant external drives. The variables $E$ and $I$ are dimensionless fractions of neurons active in their respective populations.\n\nTask 1 (derivation). Using the definition of nullclines as the sets where the corresponding time derivative is zero and using only the properties that $S$ is strictly increasing and differentiable, derive analytic expressions for the $E$-nullcline and $I$-nullcline as relations between $E$ and $I$. Express your result in terms of the inverse sigmoid $S^{-1}$ wherever appropriate, and present the nullclines as implicit curves in the $(E,I)$-plane.\n\nTask 2 (calculation). For the specific choice of sigmoid\n$$\nS(x) \\;=\\; \\frac{1}{1+\\exp\\!\\big(-a\\,x\\big)},\n$$\nwith slope parameter $a>0$, and the parameter set\n$$\nw_{EE} \\;=\\; 8,\\quad w_{EI} \\;=\\; 8,\\quad w_{IE} \\;=\\; 9,\\quad w_{II} \\;=\\; 9,\\quad P_{E} \\;=\\; 0,\\quad P_{I} \\;=\\; 0,\n$$\ncompute a fixed point $(E^{\\ast},I^{\\ast})$ lying in the open unit square $(0,1)\\times(0,1)$. Your final answer must be the fixed point coordinates given as a single row matrix. No rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in theoretical neuroscience, well-posed, objective, and internally consistent. It presents a standard analysis of a canonical Wilson-Cowan model.\n\nThe solution is divided into two parts as requested by the problem statement.\n\nTask $1$: Derivation of nullclines\n\nA nullcline for a dynamic variable is the set of points in the state space where the time derivative of that variable is zero. The state space for this system is the $(E,I)$-plane.\n\nThe $E$-nullcline is the set of points $(E,I)$ where $\\frac{dE}{dt} = 0$. Using the first given differential equation:\n$$\n\\frac{dE}{dt} = -E + S(w_{EE}E - w_{EI}I + P_{E}) = 0\n$$\nThis implies a relationship between $E$ and $I$:\n$$\nE = S(w_{EE}E - w_{EI}I + P_{E})\n$$\nThe problem states that $E$ is a fraction of active neurons, so $E \\in [0,1]$. From the equation above, $E$ must lie in the range of the sigmoid function $S$, which is the open interval $(0,1)$.\nThe function $S: \\mathbb{R} \\to (0,1)$ is given as strictly increasing and differentiable. A strictly increasing function is injective, so it has a well-defined inverse function $S^{-1}$ with domain $(0,1)$ and range $\\mathbb{R}$.\nTo find the implicit curve for the nullcline, we can apply the inverse sigmoid function $S^{-1}$ to both sides of the equation. This is permissible for $E \\in (0,1)$.\n$$\nS^{-1}(E) = w_{EE}E - w_{EI}I + P_{E}\n$$\nThis is the analytic expression for the $E$-nullcline, representing an implicit curve in the $(E,I)$-plane.\n\nThe $I$-nullcline is the set of points $(E,I)$ where $\\frac{dI}{dt} = 0$. Using the second given differential equation:\n$$\n\\frac{dI}{dt} = -I + S(w_{IE}E - w_{II}I + P_{I}) = 0\n$$\nThis implies the relationship:\n$$\nI = S(w_{IE}E - w_{II}I + P_{I})\n$$\nSimilar to $E$, $I$ must lie in the interval $(0,1)$. Applying the inverse sigmoid function $S^{-1}$ to both sides, we get:\n$$\nS^{-1}(I) = w_{IE}E - w_{II}I + P_{I}\n$$\nThis is the analytic expression for the $I$-nullcline as an implicit curve in the $(E,I)$-plane.\n\nTask $2$: Calculation of a fixed point\n\nA fixed point, denoted $(E^{\\ast}, I^{\\ast})$, is a point in the state space where all time derivatives are simultaneously zero. Therefore, a fixed point must lie at an intersection of all nullclines. The coordinates $(E^{\\ast}, I^{\\ast})$ must satisfy both nullcline equations simultaneously:\n$$\nE^{\\ast} = S(w_{EE}E^{\\ast} - w_{EI}I^{\\ast} + P_{E})\n$$\n$$\nI^{\\ast} = S(w_{IE}E^{\\ast} - w_{II}I^{\\ast} + P_{I})\n$$\nWe are given the specific sigmoid function $S(x) = \\frac{1}{1+\\exp(-ax)}$ for some $a > 0$, and the parameter set:\n$$\nw_{EE} = 8,\\quad w_{EI} = 8,\\quad w_{IE} = 9,\\quad w_{II} = 9,\\quad P_{E} = 0,\\quad P_{I} = 0\n$$\nSubstituting these values into the fixed-point equations yields the following system of nonlinear algebraic equations:\n$$\nE^{\\ast} = \\frac{1}{1 + \\exp\\left(-a(8E^{\\ast} - 8I^{\\ast})\\right)} = \\frac{1}{1 + \\exp\\left(-8a(E^{\\ast} - I^{\\ast})\\right)}\n$$\n$$\nI^{\\ast} = \\frac{1}{1 + \\exp\\left(-a(9E^{\\ast} - 9I^{\\ast})\\right)} = \\frac{1}{1 + \\exp\\left(-9a(E^{\\ast} - I^{\\ast})\\right)}\n$$\nWe are asked to find a fixed point $(E^{\\ast}, I^{\\ast})$ in the open unit square $(0,1) \\times (0,1)$. Let's inspect the structure of these equations. A particular symmetry arises in the arguments of the exponential functions. This suggests searching for a solution where $E^{\\ast} = I^{\\ast}$.\n\nLet us test the hypothesis that there is a fixed point with $E^{\\ast} = I^{\\ast}$. If this is the case, then the difference $E^{\\ast} - I^{\\ast} = 0$. Substituting this condition into the first equation:\n$$\nE^{\\ast} = \\frac{1}{1 + \\exp(-8a \\cdot 0)} = \\frac{1}{1 + \\exp(0)} = \\frac{1}{1 + 1} = \\frac{1}{2}\n$$\nSubstituting $E^{\\ast} - I^{\\ast} = 0$ into the second equation:\n$$\nI^{\\ast} = \\frac{1}{1 + \\exp(-9a \\cdot 0)} = \\frac{1}{1 + \\exp(0)} = \\frac{1}{1 + 1} = \\frac{1}{2}\n$$\nThe results from both equations are $E^{\\ast} = 1/2$ and $I^{\\ast} = 1/2$. These results are consistent with the initial hypothesis that $E^{\\ast} = I^{\\ast}$. Thus, the point $(E^{\\ast}, I^{\\ast}) = (1/2, 1/2)$ is a valid fixed point of the system. This solution holds for any value of the slope parameter $a > 0$.\n\nThe problem requires a fixed point in the open unit square $(0,1) \\times (0,1)$. The calculated fixed point is $(1/2, 1/2)$, which is $(0.5, 0.5)$ in decimal notation. This point clearly lies within the specified domain. Since the problem asks for the computation of *a* fixed point, this solution is sufficient.\n\nThe final answer is the coordinates of this fixed point.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once a system's fixed points are located, the next crucial step is to determine their stability and understand how they change as model parameters are varied. This exercise delves into linear stability analysis to predict the onset of oscillatory behavior through a Hopf bifurcation . Mastering this technique is essential for understanding how neural mass models can generate the rhythmic activity that is characteristic of many brain signals, such as EEG rhythms.",
            "id": "3910691",
            "problem": "Consider a two-population mean-field neural mass model of excitatory and inhibitory populations of the Wilson–Cowan type, describing the temporal evolution of the fractions of active excitatory and inhibitory neurons, denoted by $E(t)$ and $I(t)$, respectively. The dynamics are given by\n$$\n\\tau_E \\frac{dE}{dt} \\;=\\; -E \\;+\\; S_E\\!\\left(K\\,k_{EE}\\,E \\;-\\; K\\,k_{EI}\\,I \\;+\\; P\\right), \\qquad\n\\tau_I \\frac{dI}{dt} \\;=\\; -I \\;+\\; S_I\\!\\left(K\\,k_{IE}\\,E \\;-\\; K\\,k_{II}\\,I \\;+\\; Q\\right),\n$$\nwhere $\\tau_E$ and $\\tau_I$ are synaptic time constants, $K>0$ is a global coupling gain that scales all recurrent connections $k_{ab}>0$ (with $a,b\\in\\{E,I\\}$), $P$ and $Q$ are constant external drives, and $S_E(\\cdot)$ and $S_I(\\cdot)$ are smooth, monotonically increasing sigmoidal transfer functions. Assume there is an equilibrium $(E^{\\ast},I^{\\ast})$ for the given $P$ and $Q$. Let $s_E = S_E'\\!\\left(K\\,k_{EE}\\,E^{\\ast} - K\\,k_{EI}\\,I^{\\ast} + P\\right)$ and $s_I = S_I'\\!\\left(K\\,k_{IE}\\,E^{\\ast} - K\\,k_{II}\\,I^{\\ast} + Q\\right)$ denote the local slopes of the transfer functions at the operating point. You may assume $s_E>0$ and $s_I>0$ are constant with respect to small changes in $K$ around the bifurcation.\n\nStarting from the definitions of linearization of dynamical systems, compute the Jacobian at $(E^{\\ast},I^{\\ast})$, derive its eigenvalues symbolically, and determine the condition for oscillatory behavior to arise via a Hopf bifurcation. Then, using the parameter values\n$$\n\\tau_E = 10~\\mathrm{ms}, \\quad \\tau_I = 20~\\mathrm{ms}, \\quad k_{EE} = 6, \\quad k_{EI} = 4, \\quad k_{IE} = 5, \\quad k_{II} = 2, \\quad s_E = 0.9, \\quad s_I = 0.7,\n$$\ncompute the critical value $K_{\\mathrm{H}}$ at which a Hopf bifurcation occurs. Round your answer to four significant figures. Express the final answer as a unitless value.",
            "solution": "The problem asks for the critical value of the global coupling gain $K$ at which a two-population neural mass model undergoes a Hopf bifurcation. This requires a stability analysis of the system's equilibrium point. The analysis proceeds by linearizing the system, computing the Jacobian matrix, and finding the condition under which its eigenvalues become purely imaginary.\n\nThe dynamics of the system are given by the coupled ordinary differential equations:\n$$\n\\frac{dE}{dt} = f_E(E, I) = \\frac{1}{\\tau_E} \\left[ -E + S_E\\left(K\\,k_{EE}\\,E - K\\,k_{EI}\\,I + P\\right) \\right]\n$$\n$$\n\\frac{dI}{dt} = f_I(E, I) = \\frac{1}{\\tau_I} \\left[ -I + S_I\\left(K\\,k_{IE}\\,E - K\\,k_{II}\\,I + Q\\right) \\right]\n$$\n\nTo analyze the stability of an equilibrium point $(E^{\\ast}, I^{\\ast})$, we linearize the system by computing the Jacobian matrix $J$ evaluated at this point. The Jacobian matrix is defined as:\n$$\nJ = \\begin{pmatrix} J_{EE} & J_{EI} \\\\ J_{IE} & J_{II} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial f_E}{\\partial E} & \\frac{\\partial f_E}{\\partial I} \\\\ \\frac{\\partial f_I}{\\partial E} & \\frac{\\partial f_I}{\\partial I} \\end{pmatrix}_{\\!(E^{\\ast},I^{\\ast})}\n$$\nWe compute each element of the Jacobian using the chain rule and the given definitions of the slopes $s_E$ and $s_I$. Let $u_E = K\\,k_{EE}\\,E - K\\,k_{EI}\\,I + P$ and $u_I = K\\,k_{IE}\\,E - K\\,k_{II}\\,I + Q$. At the equilibrium $(E^{\\ast}, I^{\\ast})$, we have $s_E = S_E'(u_E^{\\ast})$ and $s_I = S_I'(u_I^{\\ast})$.\n\nThe partial derivatives are:\n$$\nJ_{EE} = \\frac{\\partial f_E}{\\partial E} = \\frac{1}{\\tau_E} \\left[ -1 + \\frac{\\partial S_E}{\\partial E} \\right] = \\frac{1}{\\tau_E} \\left[ -1 + S_E'(u_E) \\frac{\\partial u_E}{\\partial E} \\right] = \\frac{1}{\\tau_E} \\left(-1 + s_E K k_{EE}\\right)\n$$\n$$\nJ_{EI} = \\frac{\\partial f_E}{\\partial I} = \\frac{1}{\\tau_E} \\left[ \\frac{\\partial S_E}{\\partial I} \\right] = \\frac{1}{\\tau_E} \\left[ S_E'(u_E) \\frac{\\partial u_E}{\\partial I} \\right] = \\frac{1}{\\tau_E} \\left(s_E (-K k_{EI})\\right) = -\\frac{K k_{EI} s_E}{\\tau_E}\n$$\n$$\nJ_{IE} = \\frac{\\partial f_I}{\\partial E} = \\frac{1}{\\tau_I} \\left[ \\frac{\\partial S_I}{\\partial E} \\right] = \\frac{1}{\\tau_I} \\left[ S_I'(u_I) \\frac{\\partial u_I}{\\partial E} \\right] = \\frac{1}{\\tau_I} \\left(s_I (K k_{IE})\\right) = \\frac{K k_{IE} s_I}{\\tau_I}\n$$\n$$\nJ_{II} = \\frac{\\partial f_I}{\\partial I} = \\frac{1}{\\tau_I} \\left[ -1 + \\frac{\\partial S_I}{\\partial I} \\right] = \\frac{1}{\\tau_I} \\left[ -1 + S_I'(u_I) \\frac{\\partial u_I}{\\partial I} \\right] = \\frac{1}{\\tau_I} \\left(-1 + s_I (-K k_{II})\\right) = -\\frac{K k_{II} s_I + 1}{\\tau_I}\n$$\nSo the Jacobian matrix at the equilibrium is:\n$$\nJ = \\begin{pmatrix}\n\\frac{K k_{EE} s_E - 1}{\\tau_E} & -\\frac{K k_{EI} s_E}{\\tau_E} \\\\\n\\frac{K k_{IE} s_I}{\\tau_I} & -\\frac{K k_{II} s_I + 1}{\\tau_I}\n\\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of this $2 \\times 2$ matrix are the roots of the characteristic equation $\\lambda^2 - \\mathrm{Tr}(J)\\lambda + \\det(J) = 0$.\n\nA Hopf bifurcation occurs when the real parts of a pair of complex conjugate eigenvalues cross the imaginary axis. For a $2$-dimensional system, this happens when:\n$1$. The trace of the Jacobian is zero: $\\mathrm{Tr}(J) = 0$.\n$2$. The determinant of the Jacobian is strictly positive: $\\det(J) > 0$.\n$3$. A transversality condition is met, meaning the real part of the eigenvalues crosses zero with non-zero speed as the bifurcation parameter $K$ is varied.\n\nLet's compute the trace of $J$:\n$$\n\\mathrm{Tr}(J) = J_{EE} + J_{II} = \\frac{K k_{EE} s_E - 1}{\\tau_E} - \\frac{K k_{II} s_I + 1}{\\tau_I}\n$$\nThe first condition for the Hopf bifurcation, $\\mathrm{Tr}(J) = 0$, gives us the critical value of $K$, which we denote $K_H$.\n$$\n\\frac{K_H k_{EE} s_E - 1}{\\tau_E} - \\frac{K_H k_{II} s_I + 1}{\\tau_I} = 0\n$$\n$$\n\\frac{K_H k_{EE} s_E - 1}{\\tau_E} = \\frac{K_H k_{II} s_I + 1}{\\tau_I}\n$$\nTo solve for $K_H$, we rearrange the equation:\n$$\n\\tau_I (K_H k_{EE} s_E - 1) = \\tau_E (K_H k_{II} s_I + 1)\n$$\n$$\nK_H \\tau_I k_{EE} s_E - \\tau_I = K_H \\tau_E k_{II} s_I + \\tau_E\n$$\nGrouping terms with $K_H$:\n$$\nK_H (\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I) = \\tau_E + \\tau_I\n$$\nThis yields the symbolic expression for the critical coupling gain:\n$$\nK_H = \\frac{\\tau_E + \\tau_I}{\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I}\n$$\nThe transversality condition requires $\\frac{d}{dK}\\mathrm{Re}(\\lambda)|_{K=K_H} \\neq 0$. Since $\\mathrm{Re}(\\lambda) = \\frac{1}{2}\\mathrm{Tr}(J)$, we compute $\\frac{d}{dK}\\mathrm{Tr}(J) = \\frac{k_{EE} s_E}{\\tau_E} - \\frac{k_{II} s_I}{\\tau_I} = \\frac{\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I}{\\tau_E \\tau_I}$. This is non-zero as long as the denominator of the expression for $K_H$ is non-zero, which must be true for $K_H$ to be well-defined. The condition $\\det(J) > 0$ must also be verified at $K=K_H$, which ensures the eigenvalues are indeed complex.\n\nNow, we substitute the given numerical values into the expression for $K_H$:\n$\\tau_E = 10$, $\\tau_I = 20$, $k_{EE} = 6$, $k_{II} = 2$, $s_E = 0.9$, $s_I = 0.7$.\nThe units (ms) are consistent and will cancel out, yielding a unitless value for $K_H$.\n\nThe numerator is:\n$$\n\\tau_E + \\tau_I = 10 + 20 = 30\n$$\nThe denominator is:\n$$\n\\tau_I k_{EE} s_E - \\tau_E k_{II} s_I = (20)(6)(0.9) - (10)(2)(0.7)\n$$\n$$\n= (120)(0.9) - (20)(0.7) = 108 - 14 = 94\n$$\nSince the denominator is positive, $K_H$ will be positive, which is physically required ($K>0$). The transversality condition is also satisfied.\n\nThe critical value $K_H$ is:\n$$\nK_H = \\frac{30}{94} = \\frac{15}{47}\n$$\nTo obtain the numerical value, we perform the division:\n$$\nK_H \\approx 0.319148936...\n$$\nRounding to four significant figures, we get:\n$$\nK_H \\approx 0.3191\n$$\nWe can also verify that $\\det(J) > 0$ at $K=K_H$. The determinant is $\\det(J) = \\frac{1}{\\tau_E \\tau_I} \\left[ K^2 s_E s_I (k_{EI} k_{IE} - k_{EE} k_{II}) - K(k_{EE} s_E - k_{II} s_I) + 1 \\right]$. Using the given values, $k_{EI}k_{IE} - k_{EE}k_{II} = (4)(5) - (6)(2) = 8 > 0$. At $K_H \\approx 0.3191$, a full calculation confirms that $\\det(J)$ is indeed positive, thus validating the Hopf bifurcation.",
            "answer": "$$\\boxed{0.3191}$$"
        },
        {
            "introduction": "Analytical methods provide deep insights but are often limited to local behavior; to understand a model's full behavioral repertoire, we turn to numerical simulation. This practice challenges you to computationally map the landscape of a neural mass model's dynamics by constructing a bifurcation diagram . You will implement the model, simulate its response to varying inputs, and develop an algorithm to classify its long-term behavior, thereby bridging the gap between theoretical analysis and practical computational neuroscience.",
            "id": "3910655",
            "problem": "Consider a two-population neural mass model derived from mean-field principles for a homogeneous local circuit of excitatory and inhibitory neurons. Let $E(t)$ denote the dimensionless mean firing rate of the excitatory population and $I(t)$ denote the dimensionless mean firing rate of the inhibitory population. The external drive to the excitatory population is represented by a constant parameter $P$, and the baseline external drive to the inhibitory population is represented by a constant parameter $Q$. The model dynamics are defined by the following coupled ordinary differential equations:\n$$\n\\tau_e \\frac{dE}{dt} = -E + S_e\\!\\left(c_{ee} E - c_{ei} I + P\\right),\n\\quad\n\\tau_i \\frac{dI}{dt} = -I + S_i\\!\\left(c_{ie} E - c_{ii} I + Q\\right),\n$$\nwhere $S_e(\\cdot)$ and $S_i(\\cdot)$ are sigmoidal input-output functions modeling the population response (static gain functions). The sigmoids are given by:\n$$\nS_e(x) = \\frac{1}{1 + \\exp\\!\\left(-a_e\\left(x - \\theta_e\\right)\\right)},\n\\quad\nS_i(x) = \\frac{1}{1 + \\exp\\!\\left(-a_i\\left(x - \\theta_i\\right)\\right)}.\n$$\nAll variables and parameters in this problem are dimensionless. The parameters $\\tau_e$, $\\tau_i$, $c_{ee}$, $c_{ei}$, $c_{ie}$, $c_{ii}$, $a_e$, $a_i$, $\\theta_e$, $\\theta_i$, and $Q$ are fixed and known constants. The external drive $P$ is the bifurcation parameter to be varied.\n\nStarting from the foundational definition of mean firing rate dynamics (population balance between decay and drive through a sigmoidal gain), your task is to:\n- Determine the long-time regime of the excitatory population activity $E(t)$ for given values of $P$ by numerically integrating the model over sufficient time to reach asymptotic behavior.\n- Classify the asymptotic regime into one of three categories: quiescent, oscillatory, or high-activity. Use principled criteria grounded in dynamical systems: quiescent corresponds to convergence to a low stable fixed point, oscillatory corresponds to sustained bounded oscillations (limit cycle), and high-activity corresponds to convergence to a high stable fixed point near saturation of $S_e$. You must define quantitative thresholds and algorithmic tests based on $E(t)$ over a long-time window to distinguish these regimes without relying on any plots.\n- Construct the bifurcation classification across the test suite of $P$ values and produce the final program output that encodes the regime labels.\n\nUse the following fixed parameter values:\n$$\n\\tau_e = 1.0,\\quad \\tau_i = 2.0,\\quad c_{ee} = 16.0,\\quad c_{ei} = 12.0,\\quad c_{ie} = 15.0,\\quad c_{ii} = 3.0,\n$$\n$$\na_e = 1.3,\\quad a_i = 2.0,\\quad \\theta_e = 4.0,\\quad \\theta_i = 3.5,\\quad Q = 0.0.\n$$\nDefine the regime labels numerically as:\n- Quiescent $\\rightarrow 0$,\n- Oscillatory $\\rightarrow 1$,\n- High-activity $\\rightarrow 2$.\n\nYour program must implement a robust classification method by simulating $E(t)$ and $I(t)$ from small initial conditions and analyzing the last portion of the time series to determine whether $E(t)$ settles to a stable fixed point (with small variance) or exhibits sustained oscillations (with significant variance and a dominant nonzero frequency component). For stable fixed points, classify as quiescent if the mean $E$ is low, and high-activity if the mean $E$ is near saturation. Explicitly choose thresholds consistent with the sigmoidal bounds ($0$ to $1$) and justify them in your solution.\n\nTest Suite:\nEvaluate the classification for the following set of $P$ values:\n$$\nP \\in \\left\\{0.0,\\; 0.5,\\; 3.0,\\; 8.0,\\; 10.0\\right\\}.\n$$\n\nFinal Output Format:\nYour program should produce a single line of output containing the regime labels for the test suite, as a comma-separated list enclosed in square brackets. For example, the required format is $\\left[ r_1, r_2, r_3, r_4, r_5 \\right]$ where each $r_k$ is an integer in $\\{0, 1, 2\\}$ computed by your algorithm.\n\nThere are no physical units in this problem; all quantities are dimensionless. Angles do not appear, and no percentages are required. The numerical outputs must be integers as defined above.",
            "solution": "The user-provided problem statement has been meticulously validated and is determined to be a valid, well-posed problem in computational neuroscience. It is scientifically grounded in the theory of neural mass models, mathematically consistent, and free of ambiguity. It presents a clear task: to perform a bifurcation analysis of a two-population Wilson-Cowan-type model by numerically classifying its long-term dynamical regime for different levels of external input.\n\nThe solution proceeds by first defining the mathematical model and the numerical methodology for its analysis, followed by a detailed description of the algorithm used to classify the system's asymptotic behavior.\n\nThe model describes the interaction between an excitatory population with mean firing rate $E(t)$ and an inhibitory population with mean firing rate $I(t)$. The dynamics are governed by the coupled ordinary differential equations (ODEs):\n$$\n\\tau_e \\frac{dE}{dt} = -E + S_e\\!\\left(c_{ee} E - c_{ei} I + P\\right)\n$$\n$$\n\\tau_i \\frac{dI}{dt} = -I + S_i\\!\\left(c_{ie} E - c_{ii} I + Q\\right)\n$$\nThe population firing-rate responses are modeled by the sigmoidal activation functions:\n$$\nS_e(x) = \\frac{1}{1 + \\exp\\!\\left(-a_e\\left(x - \\theta_e\\right)\\right)}, \\quad S_i(x) = \\frac{1}{1 + \\exp\\!\\left(-a_i\\left(x - \\theta_i\\right)\\right)}\n$$\nThe parameter values are fixed as specified: $\\tau_e = 1.0$, $\\tau_i = 2.0$, $c_{ee} = 16.0$, $c_{ei} = 12.0$, $c_{ie} = 15.0$, $c_{ii} = 3.0$, $a_e = 1.3$, $a_i = 2.0$, $\\theta_e = 4.0$, $\\theta_i = 3.5$, and $Q = 0.0$. The bifurcation parameter is the external drive to the excitatory population, $P$.\n\nOur objective is to classify the system's long-term behavior as a function of $P$ into one of three regimes: quiescent (label $0$), oscillatory (label $1$), or high-activity (label $2$).\n\n**Methodology and Algorithm Design**\n\nThe core of the method involves numerically integrating the system of ODEs for each given value of $P$ and analyzing the resulting time series for the excitatory activity, $E(t)$.\n\n**1. Numerical Integration**\nTo determine the asymptotic behavior, the system must be simulated for a sufficiently long duration to allow initial transients to decay and the system to settle onto its attractor (a stable fixed point or a limit cycle). We employ the `solve_ivp` function from the `scipy.integrate` library, a robust adaptive step-size solver for initial value problems.\n- **Simulation Time**: The characteristic time scales of the system are $\\tau_e = 1.0$ and $\\tau_i = 2.0$. A total simulation duration of $T_{sim} = 200.0$ dimensionless time units is chosen. This duration is approximately $100$ times the longest time constant, ensuring that the system's trajectory has ample time to converge to its final state.\n- **Initial Conditions**: To avoid biasing the system towards a particular attractor in a potentially multistable regime, we start the simulation from small, non-zero initial conditions: $E(0) = 0.01$ and $I(0) = 0.01$.\n- **Time Series Sampling**: The solution is sampled at discrete time points with a step of $\\Delta t=0.1$ to generate a time series for subsequent analysis.\n\n**2. Asymptotic Regime Classification**\nThe classification algorithm is based on a principled analysis of the time series $E(t)$ over the final portion of the simulation, specifically for $t \\in [100.0, 200.0]$. This discards the initial transient dynamics. Let this segment of the time series be denoted as $E_{final}$.\n\n**Step 2a: Differentiating Stable Points from Oscillations**\nThe primary distinction between a stable fixed point and a limit cycle is the temporal variation of the state variables in the asymptotic regime.\n- A system that has converged to a stable fixed point will exhibit an essentially constant value of $E(t)$, with any minor fluctuations being attributable to numerical integration error. Consequently, the variance of $E_{final}$ will be close to zero.\n- A system that has settled into a limit cycle will exhibit sustained, periodic or quasi-periodic oscillations in $E(t)$, resulting in a significant, non-zero variance.\nWe establish a threshold on the variance of $E_{final}$, $\\sigma^2_E$, to make this distinction. A threshold of $\\text{var\\_thresh} = 10^{-4}$ is chosen. This value robustly separates the negligible variance of a numerically stable fixed point from the substantial variance of a limit cycle whose amplitude is a considerable fraction of the firing rate's range $[0, 1]$.\n- If $\\text{var}(E_{final}) > 10^{-4}$, the regime is classified as **Oscillatory** (label $1$).\n\n**Step 2b: Differentiating Quiescent from High-Activity Fixed Points**\nIf the variance test indicates convergence to a fixed point (i.e., $\\text{var}(E_{final}) \\le 10^{-4}$), we proceed to classify the type of fixed point based on the mean value of $E_{final}$. The mean, $\\langle E_{final} \\rangle$, provides a robust estimate of the fixed point's $E$-coordinate.\n- The firing rates $E$ and $I$ are outputs of sigmoid functions and are thus bounded within the interval $[0, 1]$.\n- A \"quiescent\" state corresponds to a low firing rate, near $0$.\n- A \"high-activity\" state corresponds to a high, near-saturating firing rate, near $1$.\nA natural and objective dividing line between these two states is the midpoint of the possible activity range. We therefore define a threshold on the mean activity, $\\text{mean\\_thresh} = 0.5$.\n- If $\\langle E_{final} \\rangle < 0.5$, the regime is classified as **Quiescent** (label $0$).\n- If $\\langle E_{final} \\rangle \\ge 0.5$, the regime is classified as **High-activity** (label $2$).\n\nThis two-step decision process provides a quantitative and reproducible algorithm for classifying the dynamical regime of the neural mass model for each value of the bifurcation parameter $P$ provided in the test suite. The complete algorithm is implemented in the Python program below.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the bifurcation problem for the two-population neural mass model.\n    It integrates the ODEs for different P values and classifies the long-term\n    regime of the excitatory population activity.\n    \"\"\"\n\n    # --- Fixed Model Parameters ---\n    # Time constants\n    tau_e = 1.0\n    tau_i = 2.0\n    # Connectivity weights\n    c_ee = 16.0\n    c_ei = 12.0\n    c_ie = 15.0\n    c_ii = 3.0\n    # Sigmoid parameters\n    a_e = 1.3\n    theta_e = 4.0\n    a_i = 2.0\n    theta_i = 3.5\n    # External drive to inhibitory population\n    Q = 0.0\n\n    # --- Test Suite ---\n    test_cases = [0.0, 0.5, 3.0, 8.0, 10.0]\n\n    # --- Helper Functions for the Model ---\n    def S_e(x):\n        \"\"\"Sigmoidal gain function for the excitatory population.\"\"\"\n        return 1.0 / (1.0 + np.exp(-a_e * (x - theta_e)))\n\n    def S_i(x):\n        \"\"\"Sigmoidal gain function for the inhibitory population.\"\"\"\n        return 1.0 / (1.0 + np.exp(-a_i * (x - theta_i)))\n\n    def model(t, y, P):\n        \"\"\"\n        Defines the coupled ODE system for the neural mass model.\n        y = [E, I] is the state vector.\n        P is the external drive to the excitatory population.\n        \"\"\"\n        E, I = y\n        dEdt = (-E + S_e(c_ee * E - c_ei * I + P)) / tau_e\n        dIdt = (-I + S_i(c_ie * E - c_ii * I + Q)) / tau_i\n        return [dEdt, dIdt]\n\n    # --- Simulation and Classification Settings ---\n    t_sim_end = 200.0  # Total simulation time\n    t_eval = np.arange(0, t_sim_end, 0.1)  # Time points for evaluation\n    initial_conditions = [0.01, 0.01]  # Small, non-zero initial conditions\n    \n    # Start analysis from the midpoint of the simulation to discard transients\n    analysis_start_index = len(t_eval) // 2\n    \n    # Quantitative thresholds for classification\n    variance_threshold = 1e-4  # To distinguish fixed points from oscillations\n    mean_activity_threshold = 0.5  # To distinguish quiescent from high-activity\n\n    results = []\n\n    # --- Main Loop: Iterate through test cases ---\n    for P_val in test_cases:\n        # Numerically integrate the ODEs\n        solution = solve_ivp(\n            model,\n            [0, t_sim_end],\n            initial_conditions,\n            args=(P_val,),\n            dense_output=False,\n            t_eval=t_eval\n        )\n\n        # Extract the excitatory activity time series\n        E_series = solution.y[0,:]\n        \n        # Analyze the final portion of the time series\n        E_final = E_series[analysis_start_index:]\n        \n        # Calculate variance to detect oscillations\n        variance = np.var(E_final)\n        \n        if variance > variance_threshold:\n            # Regime is oscillatory\n            results.append(1)\n        else:\n            # Regime is a stable fixed point\n            mean_E = np.mean(E_final)\n            if mean_E  mean_activity_threshold:\n                # Quiescent fixed point (low activity)\n                results.append(0)\n            else:\n                # High-activity fixed point (saturated)\n                results.append(2)\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}