{
    "hands_on_practices": [
        {
            "introduction": "神经元活动是混合动力学系统的一个经典例子，其中连续的膜电位变化与离散的脉冲发放和重置事件交织在一起。漏电积分-发放（Leaky integrate-and-fire）模型通过一个简单的电阻-电容（$RC$）电路来捕捉这种行为，当电位达到阈值时触发一个瞬时重置。这项实践将指导您从该混合模型的定义出发，通过分析推导出神经元的稳态发放频率，从而将系统的混合结构与一个关键的生物学可观测量联系起来。",
            "id": "3892038",
            "problem": "考虑一个混合漏放电神经元模型，该模型结合了连续的阈下膜动态、离散的脉冲发放和重置事件，以及一个代表绝对不应期的固定停留时间。其连续的阈下动态通过电阻-电容 (RC) 膜方程进行建模。在没有突触噪声且输入电流恒定的情况下，该方程可以写成一个常微分方程 (ODE)：$$\\tau_{m}\\,\\frac{dV}{dt} = -\\big(V - V_{\\mathrm{rest}}\\big) + R_{m}\\,I,$$ 其中，$V$ 是膜电位，$V_{\\mathrm{rest}}$ 是静息电位，$\\tau_{m}$ 是膜时间常数，$R_{m}$ 是膜电阻，$I$ 是恒定输入电流。当连续轨迹达到脉冲阈值 $V_{\\mathrm{th}}$ 时，会触发一个离散事件：膜电位根据 $V \\leftarrow V_{\\mathrm{reset}}$ 瞬时重置，系统进入一个持续时间为 $\\tau_{\\mathrm{ref}}$ 的绝对不应期停留状态，在此期间连续状态不发生演化，也不能产生脉冲。\n\n假设输入恒定且参数选择满足持续发放脉冲的条件，即 $V_{\\infty} \\equiv V_{\\mathrm{rest}} + R_{m} I > V_{\\mathrm{th}}$。从基本的 RC 定律和上述混合事件/重置机制出发，通过计算平均脉冲间隔（即从 $V_{\\mathrm{reset}}$ 到 $V_{\\mathrm{th}}$ 的跨阈时间与不应期停留时间 $\\tau_{\\mathrm{ref}}$ 之和）来推导稳态发放率。使用以下参数值：$$\\tau_{m} = 20\\,\\mathrm{ms},\\quad R_{m} = 100\\,\\mathrm{M}\\Omega,\\quad I = 0.5\\,\\mathrm{nA},\\quad V_{\\mathrm{rest}} = -65\\,\\mathrm{mV},\\quad V_{\\mathrm{reset}} = -65\\,\\mathrm{mV},\\quad V_{\\mathrm{th}} = -50\\,\\mathrm{mV},\\quad \\tau_{\\mathrm{ref}} = 2\\,\\mathrm{ms}.$$ 以 $\\mathrm{Hz}$ 为单位表示最终的发放率，并将您的答案四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于计算神经科学的既定原理，特别是漏放电 (LIF) 模型。它在数学上是适定的，提供了一个清晰的常微分方程 (ODE)、一个离散的重置机制和一套完整的参数。持续发放脉冲的条件 $V_{\\infty}  V_{\\mathrm{th}}$ 被给定参数满足，确保了有意义解的存在。该问题是客观的，不含任何歧义。\n\n任务是推导混合漏放电神经元的稳态发放率 $f$。发放率是平均脉冲间隔 $ISI$ 的倒数，即 $f = 1/ISI$。问题将 $ISI$ 定义为两个时间段之和：膜电位从重置值上升到阈值所需的时间（我们称之为 $t_{\\mathrm{reach}}$）和绝对不应期 $\\tau_{\\mathrm{ref}}$。\n$$ISI = t_{\\mathrm{reach}} + \\tau_{\\mathrm{ref}}$$\n\n首先，我们必须求解 $t_{\\mathrm{reach}}$。这是由所给 ODE 控制的膜电位 $V$ 连续演化的持续时间：\n$$\\tau_{m}\\,\\frac{dV}{dt} = -\\big(V - V_{\\mathrm{rest}}\\big) + R_{m}\\,I$$\n为了求解这个一阶线性 ODE，我们将其重排为标准形式。我们定义稳态电压 $V_{\\infty}$ 为在没有阈值的情况下 $V$ 将趋近的值：\n$$V_{\\infty} \\equiv V_{\\mathrm{rest}} + R_{m}\\,I$$\n将此定义代入 ODE 中，得到：\n$$\\tau_{m}\\,\\frac{dV}{dt} = -(V - V_{\\infty})$$\n该方程可通过分离变量法求解：\n$$\\frac{dV}{V - V_{\\infty}} = -\\frac{dt}{\\tau_{m}}$$\n对等式两边进行积分，积分区间从积分周期的开始（时间 $t=0$，电压 $V(0) = V_{\\mathrm{reset}}$）到稍后的时间 $t$（电压 $V(t)$），得到：\n$$\\int_{V_{\\mathrm{reset}}}^{V(t)} \\frac{dV'}{V' - V_{\\infty}} = \\int_{0}^{t} -\\frac{dt'}{\\tau_{m}}$$\n$$\\left[ \\ln|V' - V_{\\infty}| \\right]_{V_{\\mathrm{reset}}}^{V(t)} = -\\frac{t}{\\tau_{m}}$$\n$$\\ln|V(t) - V_{\\infty}| - \\ln|V_{\\mathrm{reset}} - V_{\\infty}| = -\\frac{t}{\\tau_{m}}$$\n$$\\ln\\left( \\frac{|V(t) - V_{\\infty}|}{|V_{\\mathrm{reset}} - V_{\\infty}|} \\right) = -\\frac{t}{\\tau_{m}}$$\n在条件 $V_{\\mathrm{rest}} + R_{m}\\,I  V_{\\mathrm{th}}$ 下，并从 $V_{\\mathrm{reset}} \\le V_{\\mathrm{th}}$ 开始，电压 $V(t)$ 在向阈值演化时将始终小于 $V_{\\infty}$。因此，绝对值符号内的项 $V(t) - V_{\\infty}$ 和 $V_{\\mathrm{reset}} - V_{\\infty}$ 均为负数。因此，我们可以写成：\n$$\\ln\\left( \\frac{V_{\\infty} - V(t)}{V_{\\infty} - V_{\\mathrm{reset}}} \\right) = -\\frac{t}{\\tau_{m}}$$\n对两边取指数并重新整理，得到 $V(t)$ 的解：\n$$\\frac{V_{\\infty} - V(t)}{V_{\\infty} - V_{\\mathrm{reset}}} = \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)$$\n$$V_{\\infty} - V(t) = (V_{\\infty} - V_{\\mathrm{reset}}) \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)$$\n$$V(t) = V_{\\infty} - (V_{\\infty} - V_{\\mathrm{reset}}) \\exp\\left(-\\frac{t}{\\tau_{m}}\\right)$$\n这等价于更常见的形式 $V(t) = V_{\\infty} + (V_{\\mathrm{reset}} - V_{\\infty}) \\exp(-t/\\tau_m)$。\n\n现在我们求解 $t_{\\mathrm{reach}}$，即 $V(t) = V_{\\mathrm{th}}$ 时的时间 $t$。\n$$V_{\\mathrm{th}} = V_{\\infty} + (V_{\\mathrm{reset}} - V_{\\infty}) \\exp\\left(-\\frac{t_{\\mathrm{reach}}}{\\tau_{m}}\\right)$$\n$$V_{\\mathrm{th}} - V_{\\infty} = (V_{\\mathrm{reset}} - V_{\\infty}) \\exp\\left(-\\frac{t_{\\mathrm{reach}}}{\\tau_{m}}\\right)$$\n$$\\exp\\left(-\\frac{t_{\\mathrm{reach}}}{\\tau_{m}}\\right) = \\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_{\\mathrm{reset}} - V_{\\infty}}$$\n对两边取自然对数：\n$$-\\frac{t_{\\mathrm{reach}}}{\\tau_{m}} = \\ln\\left(\\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_{\\mathrm{reset}} - V_{\\infty}}\\right)$$\n$$t_{\\mathrm{reach}} = -\\tau_{m} \\ln\\left(\\frac{V_{\\mathrm{th}} - V_{\\infty}}{V_{\\mathrm{reset}} - V_{\\infty}}\\right)$$\n使用对数恒等式 $-\\ln(a/b) = \\ln(b/a)$，我们可以将其写成对数参数大于 $1$ 的形式，以确保时间为正值：\n$$t_{\\mathrm{reach}} = \\tau_{m} \\ln\\left(\\frac{V_{\\mathrm{reset}} - V_{\\infty}}{V_{\\mathrm{th}} - V_{\\infty}}\\right)$$\n\n现在我们代入所给的参数值。保持单位一致至关重要（例如，伏特、安培、欧姆、秒）。\n$\\tau_{m} = 20\\,\\mathrm{ms} = 20 \\times 10^{-3}\\,\\mathrm{s}$\n$R_{m} = 100\\,\\mathrm{M}\\Omega = 100 \\times 10^{6}\\,\\Omega$\n$I = 0.5\\,\\mathrm{nA} = 0.5 \\times 10^{-9}\\,\\mathrm{A}$\n$V_{\\mathrm{rest}} = -65\\,\\mathrm{mV} = -0.065\\,\\mathrm{V}$\n$V_{\\mathrm{reset}} = -65\\,\\mathrm{mV} = -0.065\\,\\mathrm{V}$\n$V_{\\mathrm{th}} = -50\\,\\mathrm{mV} = -0.050\\,\\mathrm{V}$\n$\\tau_{\\mathrm{ref}} = 2\\,\\mathrm{ms} = 2 \\times 10^{-3}\\,\\mathrm{s}$\n\n首先，我们计算 $V_{\\infty}$：\n$$R_{m}\\,I = (100 \\times 10^{6}\\,\\Omega) \\times (0.5 \\times 10^{-9}\\,\\mathrm{A}) = 50 \\times 10^{-3}\\,\\mathrm{V} = 50\\,\\mathrm{mV}$$\n$$V_{\\infty} = V_{\\mathrm{rest}} + R_{m}\\,I = -65\\,\\mathrm{mV} + 50\\,\\mathrm{mV} = -15\\,\\mathrm{mV}$$\n\n接下来，我们计算 $t_{\\mathrm{reach}}$：\n$$t_{\\mathrm{reach}} = (20\\,\\mathrm{ms}) \\times \\ln\\left(\\frac{V_{\\mathrm{reset}} - V_{\\infty}}{V_{\\mathrm{th}} - V_{\\infty}}\\right)$$\n$$t_{\\mathrm{reach}} = (20\\,\\mathrm{ms}) \\times \\ln\\left(\\frac{-65\\,\\mathrm{mV} - (-15\\,\\mathrm{mV})}{-50\\,\\mathrm{mV} - (-15\\,\\mathrm{mV})}\\right)$$\n$$t_{\\mathrm{reach}} = (20\\,\\mathrm{ms}) \\times \\ln\\left(\\frac{-50}{-35}\\right) = (20\\,\\mathrm{ms}) \\times \\ln\\left(\\frac{10}{7}\\right)$$\n$$t_{\\mathrm{reach}} \\approx (20\\,\\mathrm{ms}) \\times 0.356675 \\approx 7.1335\\,\\mathrm{ms}$$\n\n现在，我们计算总的脉冲间隔 $ISI$：\n$$ISI = t_{\\mathrm{reach}} + \\tau_{\\mathrm{ref}} \\approx 7.1335\\,\\mathrm{ms} + 2\\,\\mathrm{ms} = 9.1335\\,\\mathrm{ms}$$\n以秒为单位，$ISI \\approx 9.1335 \\times 10^{-3}\\,\\mathrm{s}$。\n\n最后，我们计算以赫兹 ($\\mathrm{Hz}$) 为单位的发放率 $f$，即 $s^{-1}$：\n$$f = \\frac{1}{ISI} \\approx \\frac{1}{9.1335 \\times 10^{-3}\\,\\mathrm{s}} \\approx 109.486\\,\\mathrm{Hz}$$\n\n按要求四舍五入到四位有效数字，我们得到：\n$$f \\approx 109.5\\,\\mathrm{Hz}$$\n发放率的最终解析表达式是：\n$$f = \\left[ \\tau_{\\mathrm{ref}} + \\tau_{m} \\ln\\left(\\frac{V_{\\mathrm{reset}} - V_{\\mathrm{rest}} - R_m I}{V_{\\mathrm{th}} - V_{\\mathrm{rest}} - R_m I}\\right) \\right]^{-1}$$",
            "answer": "$$\\boxed{109.5}$$"
        },
        {
            "introduction": "生物过程，尤其是基因表达，本质上是随机的，导致分子数量在细胞内产生波动。本练习从确定性模型过渡到随机-确定性混合模型，引入线性噪声近似（Linear Noise Approximation, LNA）这一强大工具来量化这些内在噪声。您将应用 LNA 来分析一个两阶段基因表达模型，推导蛋白质数量波动的稳态方差，从而深入理解细胞噪声的来源和特性。",
            "id": "3892040",
            "problem": "考虑一个单细胞基因表达的混合动力学模型，其中离散的启动子转换相对于转录和翻译是快速的，且分子拷贝数的涨落通过连续随机近似进行建模。启动子在激活态和失活态之间切换，其常数速率分别为 $\\alpha$（失活到激活）和 $\\beta$（激活到失活）。在时间尺度分离的假设下，启动子处于激活态的时间分数由其稳态均值 $s^{\\ast} = \\alpha/(\\alpha+\\beta)$ 近似，信使核糖核酸 (mRNA) 和蛋白质的平均分子数（分别表示为 $m$ 和 $p$）的连续动力学遵循由以下公式给出的确定性漂移：\n$$\n\\frac{dm}{dt} = k_{m} s^{\\ast} - \\gamma_{m} m, \n\\qquad\n\\frac{dp}{dt} = k_{p} m - \\gamma_{p} p,\n$$\n其中 $k_{m}$ 是转录速率（条件是启动子处于激活态），$\\gamma_{m}$ 是 mRNA 降解速率，$k_{p}$ 是翻译速率，$\\gamma_{p}$ 是蛋白质降解速率。其潜在的离散反应事件为：\n- 转录：$\\varnothing \\rightarrow m$，倾向为 $a_{1}(x) = k_{m} s^{\\ast}$，\n- mRNA 降解：$m \\rightarrow \\varnothing$，倾向为 $a_{2}(x) = \\gamma_{m} m$，\n- 翻译：$m \\rightarrow m + p$，倾向为 $a_{3}(x) = k_{p} m$，\n- 蛋白质降解：$p \\rightarrow \\varnothing$，倾向为 $a_{4}(x) = \\gamma_{p} p$，\n其中 $x = (m,p)^{\\top}$。\n\n假设线性噪声近似 (LNA) 有效，并且围绕唯一稳定平衡点的涨落可以很好地由一个针对 $(m,p)$ 的高斯 Ornstein–Uhlenbeck 过程近似。令 $x^{\\ast} = (m^{\\ast},p^{\\ast})^{\\top}$ 表示该平衡点。使用反应网络的随机表述的第一性原理，推导蛋白质涨落的稳态方差 $\\sigma_{pp}$（即 $(m,p)$ 的稳态协方差矩阵的 $(2,2)$ 元素）作为关于参数 $\\alpha$、$\\beta$、$k_{m}$、$k_{p}$、$\\gamma_{m}$ 和 $\\gamma_{p}$ 的闭式解析表达式。\n\n将你的最终答案表示为符号表达式。不要提供数值计算，也不要附加单位。",
            "solution": "用户希望使用线性噪声近似 (LNA) 方法，针对给定的基因表达混合模型，求解蛋白质涨落的稳态方差 $\\sigma_{pp}$。\n\n### 第一步：提取已知条件\n- **状态变量**：$m$ (mRNA 数量)，$p$ (蛋白质数量)。状态向量 $x = (m, p)^{\\top}$。\n- **参数**：\n  - 启动子转换速率：$\\alpha$ (失活到激活)，$\\beta$ (激活到失活)。\n  - 转录速率（启动子激活时）：$k_m$。\n  - mRNA 降解速率：$\\gamma_m$。\n  - 翻译速率：$k_p$。\n  - 蛋白质降解速率：$\\gamma_p$。\n- **派生量**：启动子处于激活态的稳态时间分数：$s^{\\ast} = \\frac{\\alpha}{\\alpha+\\beta}$。\n- **确定性动力学**：\n  $$ \\frac{dm}{dt} = k_{m} s^{\\ast} - \\gamma_{m} m $$\n  $$ \\frac{dp}{dt} = k_{p} m - \\gamma_{p} p $$\n- **随机反应方案**：令 $x=(m,p)$。\n  - R1: $\\varnothing \\rightarrow m$，倾向 $a_{1}(x) = k_{m} s^{\\ast}$，化学计量向量 $v_1 = (1, 0)^{\\top}$。\n  - R2: $m \\rightarrow \\varnothing$，倾向 $a_{2}(x) = \\gamma_{m} m$，化学计量向量 $v_2 = (-1, 0)^{\\top}$。\n  - R3: $m \\rightarrow m + p$，倾向 $a_{3}(x) = k_{p} m$，化学计量向量 $v_3 = (0, 1)^{\\top}$。\n  - R4: $p \\rightarrow \\varnothing$，倾向 $a_{4}(x) = \\gamma_{p} p$，化学计量向量 $v_4 = (0, -1)^{\\top}$。\n- **目标**：推导稳态方差 $\\sigma_{pp}$，即 $(m,p)$ 的稳态协方差矩阵的 $(2,2)$ 元素。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是将线性噪声近似 (LNA) 应用于一个成熟的基因表达两阶段模型的标准应用。\n- **科学依据**：该模型是随机基因表达理论的基石。LNA 是在大系统规模假设下，从化学主方程推导出的一个严谨且被广泛接受的方法。\n- **适定性**：确定性系统有一个唯一的、全局稳定的不动点。LNA 框架为求解稳态协方差矩阵提供了一条清晰的路径，前提是系统是稳定的，而本系统确实是稳定的。\n- **目标**：问题以精确的数学术语陈述，没有歧义或主观论断。\n- **完整性**：所有必需的参数、速率和反应定义都已提供。\n\n### 第三步：结论与行动\n问题有效。我将继续进行求解。\n\n### 稳态蛋白质方差的推导\n\n线性噪声近似 (LNA) 描述了围绕一个稳定确定性平衡点 $x^{\\ast}$ 的涨落 $\\eta(t) = x(t) - x^{\\ast}$ 的动力学。涨落遵循一个 Ornstein-Uhlenbeck 过程，其协方差矩阵 $C(t) = \\langle \\eta(t) \\eta(t)^{\\top} \\rangle$ 根据 Lyapunov 方程演化：\n$$ \\frac{dC}{dt} = J C(t) + C(t) J^{\\top} + D $$\n在稳态下，$\\frac{dC}{dt} = 0$，稳态协方差矩阵 $C_{ss}$ 满足代数 Lyapunov 方程：\n$$ J C_{ss} + C_{ss} J^{\\top} + D = 0 $$\n我们的目标是求出 $C_{ss}$ 的 (2,2) 元素，我们将其记为 $\\sigma_{pp}$。\n\n**1. 确定确定性平衡点 $x^{\\ast} = (m^{\\ast}, p^{\\ast})^{\\top}$**\n我们将确定性方程的时间导数设为零：\n$k_{m} s^{\\ast} - \\gamma_{m} m^{\\ast} = 0 \\implies m^{\\ast} = \\frac{k_{m} s^{\\ast}}{\\gamma_{m}}$\n$k_{p} m^{\\ast} - \\gamma_{p} p^{\\ast} = 0 \\implies p^{\\ast} = \\frac{k_{p} m^{\\ast}}{\\gamma_{p}}$\n将 $m^{\\ast}$ 的表达式代入 $p^{\\ast}$ 的方程中：\n$p^{\\ast} = \\frac{k_{p}}{\\gamma_{p}} \\left( \\frac{k_{m} s^{\\ast}}{\\gamma_{m}} \\right) = \\frac{k_{p} k_{m} s^{\\ast}}{\\gamma_{p} \\gamma_{m}}$.\n\n**2. 计算雅可比矩阵 $J$**\n设确定性速率向量为 $f(x) = (f_m, f_p)^{\\top} = (k_m s^{\\ast} - \\gamma_m m, k_p m - \\gamma_p p)^{\\top}$。雅可比矩阵 $J$ 由在 $x^{\\ast}$ 处求值的 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$ 给出。\n$J_{11} = \\frac{\\partial f_m}{\\partial m} = -\\gamma_m$\n$J_{12} = \\frac{\\partial f_m}{\\partial p} = 0$\n$J_{21} = \\frac{\\partial f_p}{\\partial m} = k_p$\n$J_{22} = \\frac{\\partial f_p}{\\partial p} = -\\gamma_p$\n雅可比矩阵是常数，不依赖于平衡点：\n$$ J = \\begin{pmatrix} -\\gamma_m  0 \\\\ k_p  -\\gamma_p \\end{pmatrix} $$\n\n**3. 计算扩散矩阵 $D$**\n扩散矩阵 $D$ 由 $D = \\sum_{j} v_j v_j^{\\top} a_j(x^{\\ast})$ 给出，其中 $v_j$ 是化学计量向量，$a_j(x^{\\ast})$ 是在平衡点 $x^{\\ast}$ 处求值的倾向。\n平衡点处的倾向为：\n$a_1(x^{\\ast}) = k_m s^{\\ast}$\n$a_2(x^{\\ast}) = \\gamma_m m^{\\ast} = \\gamma_m \\left(\\frac{k_m s^{\\ast}}{\\gamma_m}\\right) = k_m s^{\\ast}$\n$a_3(x^{\\ast}) = k_p m^{\\ast}$\n$a_4(x^{\\ast}) = \\gamma_p p^{\\ast} = \\gamma_p \\left(\\frac{k_p m^{\\ast}}{\\gamma_p}\\right) = k_p m^{\\ast}$\n$D$ 的分量为：\n$D_{11} = (1)^2 a_1(x^{\\ast}) + (-1)^2 a_2(x^{\\ast}) = k_m s^{\\ast} + k_m s^{\\ast} = 2k_m s^{\\ast}$\n$D_{22} = (1)^2 a_3(x^{\\ast}) + (-1)^2 a_4(x^{\\ast}) = k_p m^{\\ast} + k_p m^{\\ast} = 2k_p m^{\\ast}$\n$D_{12} = D_{21} = 0$，因为没有单个反应同时影响 $m$ 和 $p$。\n因此，扩散矩阵为：\n$$ D = \\begin{pmatrix} 2k_m s^{\\ast}  0 \\\\ 0  2k_p m^{\\ast} \\end{pmatrix} $$\n\n**4. 求解代数 Lyapunov 方程**\n设 $C_{ss} = \\begin{pmatrix} \\sigma_{mm}  \\sigma_{mp} \\\\ \\sigma_{mp}  \\sigma_{pp} \\end{pmatrix}$。方程 $J C_{ss} + C_{ss} J^{\\top} + D = 0$ 变为：\n$$ \\begin{pmatrix} -\\gamma_m  0 \\\\ k_p  -\\gamma_p \\end{pmatrix} \\begin{pmatrix} \\sigma_{mm}  \\sigma_{mp} \\\\ \\sigma_{mp}  \\sigma_{pp} \\end{pmatrix} + \\begin{pmatrix} \\sigma_{mm}  \\sigma_{mp} \\\\ \\sigma_{mp}  \\sigma_{pp} \\end{pmatrix} \\begin{pmatrix} -\\gamma_m  k_p \\\\ 0  -\\gamma_p \\end{pmatrix} + \\begin{pmatrix} D_{11}  0 \\\\ 0  D_{22} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} $$\n展开此矩阵方程，得到一个关于 $C_{ss}$ 元素的线性方程组：\n$$ \\begin{pmatrix} -2\\gamma_m \\sigma_{mm}  k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} \\\\ k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp}  2k_p \\sigma_{mp} - 2\\gamma_p \\sigma_{pp} \\end{pmatrix} + \\begin{pmatrix} D_{11}  0 \\\\ 0  D_{22} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} $$\n从矩阵元素中，我们得到：\n(1,1): $-2\\gamma_m \\sigma_{mm} + D_{11} = 0 \\implies \\sigma_{mm} = \\frac{D_{11}}{2\\gamma_m} = \\frac{2k_m s^{\\ast}}{2\\gamma_m} = \\frac{k_m s^{\\ast}}{\\gamma_m} = m^{\\ast}$。\n(1,2): $k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} = 0 \\implies \\sigma_{mp} = \\frac{k_p \\sigma_{mm}}{\\gamma_m+\\gamma_p} = \\frac{k_p m^{\\ast}}{\\gamma_m+\\gamma_p}$。\n(2,2): $2k_p \\sigma_{mp} - 2\\gamma_p \\sigma_{pp} + D_{22} = 0 \\implies \\sigma_{pp} = \\frac{k_p \\sigma_{mp}}{\\gamma_p} + \\frac{D_{22}}{2\\gamma_p}$。\n\n现在，我们代入 $\\sigma_{mp}$ 和 $D_{22}$ 的表达式来求解 $\\sigma_{pp}$：\n$$ \\sigma_{pp} = \\frac{k_p}{\\gamma_p} \\left( \\frac{k_p m^{\\ast}}{\\gamma_m+\\gamma_p} \\right) + \\frac{2k_p m^{\\ast}}{2\\gamma_p} $$\n$$ \\sigma_{pp} = \\frac{k_p^2 m^{\\ast}}{\\gamma_p(\\gamma_m+\\gamma_p)} + \\frac{k_p m^{\\ast}}{\\gamma_p} $$\n注意到 $p^{\\ast} = \\frac{k_p m^{\\ast}}{\\gamma_p}$，我们可以简化：\n$$ \\sigma_{pp} = \\frac{k_p}{\\gamma_m+\\gamma_p} \\left(\\frac{k_p m^{\\ast}}{\\gamma_p}\\right) + p^{\\ast} = p^{\\ast} \\frac{k_p}{\\gamma_m+\\gamma_p} + p^{\\ast} $$\n将 $p^{\\ast}$ 因子提出：\n$$ \\sigma_{pp} = p^{\\ast} \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right) $$\n最后，代入 $p^{\\ast} = \\frac{k_p k_m s^{\\ast}}{\\gamma_p \\gamma_m}$ 和 $s^{\\ast} = \\frac{\\alpha}{\\alpha+\\beta}$ 的表达式：\n$$ \\sigma_{pp} = \\left(\\frac{k_p k_m}{\\gamma_p \\gamma_m} \\frac{\\alpha}{\\alpha+\\beta}\\right) \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right) $$\n为了得到单个表达式，我们将括号内的项合并：\n$$ 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} = \\frac{\\gamma_m+\\gamma_p+k_p}{\\gamma_m+\\gamma_p} $$\n将其代回，得到稳态蛋白质方差的最终表达式：\n$$ \\sigma_{pp} = \\left(\\frac{k_p k_m}{\\gamma_p \\gamma_m} \\frac{\\alpha}{\\alpha+\\beta}\\right) \\left(\\frac{\\gamma_m+\\gamma_p+k_p}{\\gamma_m+\\gamma_p}\\right) $$\n$$ \\sigma_{pp} = \\frac{\\alpha k_m k_p (\\gamma_m + \\gamma_p + k_p)}{(\\alpha+\\beta)\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} $$\n这就是以基本模型参数表示的蛋白质涨落稳态方差的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\alpha k_m k_p (\\gamma_m + \\gamma_p + k_p)}{(\\alpha+\\beta)\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}}$$"
        },
        {
            "introduction": "现代生物医学系统通常涉及基于实时数据的闭环控制，这是混合动力学模型的另一个重要应用领域。本实践模拟一个用于1型糖尿病管理的“人工胰腺”，这是一个基于事件触发的控制系统，它将连续的葡萄糖-胰岛素动力学与由带噪声的测量值触发的离散胰岛素推注相结合。通过将这一混合模型转化为具体的计算机模拟，您将亲身体验在现实（带噪声）条件下设计和评估闭环控制策略所面临的挑战和考虑因素。",
            "id": "3892153",
            "problem": "考虑一个患有1型糖尿病的人的闭环葡萄糖调节，该调节被建模为一个混合动力系统，该系统将连续的葡萄糖-胰岛素动力学与由带噪声的葡萄糖测量驱动的事件触发的胰岛素推注相结合。连续时间状态是状态对 $(G(t), I(t))$，其中 $G(t)$ 是血浆葡萄糖浓度（单位为 $\\mathrm{mg/dL}$），$I(t)$ 是一个有效的皮下胰岛素室（单位为 $\\mathrm{mU}$）。基线葡萄糖设定值为 $G_b$（单位为 $\\mathrm{mg/dL}$）。连续动力学遵循常用于最小模型的一阶质量平衡和药代动力学：\n$$\n\\frac{dG}{dt} = -k_g \\left(G(t) - G_b\\right) - S_I\\, I(t)\\, \\left(G(t) - G_b\\right) + d(t),\n$$\n$$\n\\frac{dI}{dt} = -k_i\\, I(t) + u_{\\mathrm{basal}},\n$$\n其中，$k_g$（单位为 $\\mathrm{min^{-1}}$）是葡萄糖清除率，$S_I$（单位为 $\\mathrm{(mU\\cdot min)^{-1}}$）是胰岛素敏感性，$k_i$（单位为 $\\mathrm{min^{-1}}$）是胰岛素衰变率，$u_{\\mathrm{basal}}$（单位为 $\\mathrm{mU/min}$）是基础胰岛素输注率，$d(t)$（单位为 $\\mathrm{mg/dL\\cdot min}$）是外源性葡萄糖扰动（在本问题中假设 $d(t) = 0$）。测量的葡萄糖 $y(t)$ 受到加性测量噪声的影响，\n$$\ny(t) = G(t) + \\varepsilon(t),\n$$\n其中 $\\varepsilon(t)$ 是一个零均值随机变量，在离散的仿真步骤中独立采样，并满足方差为 $\\sigma^2$（单位为 $\\mathrm{(mg/dL)^2}$）的高斯分布 $\\varepsilon(t) \\sim \\mathcal{N}(0,\\sigma^2)$。使用保护和重置定义事件触发的推注控制如下。保护函数为\n$$\n\\gamma(t) = y(t) - \\theta,\n$$\n其中阈值为 $\\theta$（单位为 $\\mathrm{mg/dL}$）。每当 $\\gamma(t)$ 从负值跨越到非负值，并且自上次事件以来已经过最小事件间驻留时间 $\\tau$（单位为 $\\mathrm{min}$）时，就会发生一个事件。在事件时间 $t_k$，重置映射施加一个大小为 $B$（单位为 $\\mathrm{mU}$）的胰岛素推注，\n$$\nG(t_k^+) = G(t_k^-), \\quad I(t_k^+) = I(t_k^-) + B,\n$$\n然后从 $(G(t_k^+), I(t_k^+))$ 恢复连续演化。假设在时间步长为 $h$（单位为 $\\mathrm{min}$）的分段常数采样，并在此网格上使用前向 Euler 方案近似连续动力学。\n\n任务。从这些基本定义出发，推导一个由保护和重置指定的事件触发控制器，并使用 Lyapunov 风格的论证分析存在测量噪声时的闭环稳定性，解释为什么有界的事件间时间和有界的推注大小可以导致 $G(t)$ 在 $G_b$ 附近均方有界。然后实现一个基于仿真的测试来操作性地评估稳定性：对于给定的参数集，仿真持续时间 $T$ 分钟，计算最后 $T/2$ 分钟内 $G(t)$ 的样本均值 $\\mu$ 和样本方差 $v$，如果满足以下条件，则宣布闭环“稳定”：\n$$\n\\left|\\mu - G_b\\right| \\leq \\epsilon_\\mu \\quad \\text{and} \\quad v \\leq v_{\\max},\n$$\n其中指定的容差为 $\\epsilon_\\mu$（单位为 $\\mathrm{mg/dL}$）和 $v_{\\max}$（单位为 $\\mathrm{(mg/dL)^2}$）。仅使用随机测量值 $y(t)$ 来触发事件；状态更新必须使用无噪声的 $G(t)$ 和 $I(t)$。始终假设 $u_{\\mathrm{basal}} = 0$ 且 $d(t) = 0$。\n\n实现细节。使用步长为 $h$ 的前向 Euler 法来积分连续动力学。在每个离散步骤 $t_n = n h$，独立生成 $\\varepsilon_n \\sim \\mathcal{N}(0,\\sigma^2)$，设置 $y_n = G_n + \\varepsilon_n$，并应用带驻留时间约束 $\\tau$ 的保护和重置；在任何重置后，继续积分。为每个测试用例提供一个整数种子来初始化随机数生成器，以确保可复现性。初始条件为 $G(0) = G_0$（单位为 $\\mathrm{mg/dL}$）和 $I(0) = I_0$（单位为 $\\mathrm{mU}$）。仿真持续时间为 $T$ 分钟，步长为 $h$，产生 $N = T/h$ 个步骤。\n\n单位。所有葡萄糖量必须以 $\\mathrm{mg/dL}$ 为单位，时间以 $\\mathrm{min}$ 为单位，胰岛素单位以 $\\mathrm{mU}$ 为单位。为每个测试用例报告稳定性的布尔决策。不使用角度。不使用百分比。\n\n测试套件。实现程序以评估以下四个参数集，这些参数集探索了不同的情况，包括“理想路径”、高噪声情况、小推注情况和无噪声边界情况。在每种情况下，使用容差 $\\epsilon_\\mu = 5$ $\\mathrm{mg/dL}$ 和 $v_{\\max} = 400$ $\\mathrm{(mg/dL)^2}$。\n\n- 情况1（理想路径）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 180$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 140$ $\\mathrm{mg/dL}$，$B = 30$ $\\mathrm{mU}$，$\\sigma = 5$ $\\mathrm{mg/dL}$，$\\tau = 20$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，seed $= 1$。\n\n- 情况2（高噪声，频繁事件）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 130$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 110$ $\\mathrm{mg/dL}$，$B = 50$ $\\mathrm{mU}$，$\\sigma = 30$ $\\mathrm{mg/dL}$，$\\tau = 5$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，seed $= 2$。\n\n- 情况3（小推注）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 160$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 140$ $\\mathrm{mg/dL}$，$B = 5$ $\\mathrm{mU}$，$\\sigma = 5$ $\\mathrm{mg/dL}$，$\\tau = 20$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，seed $= 3$。\n\n- 情况4（无噪声边界）：$k_g = 0.01$ $\\mathrm{min^{-1}}$，$S_I = 5\\times 10^{-4}$ $\\mathrm{(mU\\cdot min)^{-1}}$，$k_i = 0.05$ $\\mathrm{min^{-1}}$，$G_b = 100$ $\\mathrm{mg/dL}$，$G_0 = 150$ $\\mathrm{mg/dL}$，$I_0 = 0$ $\\mathrm{mU}$，$\\theta = 120$ $\\mathrm{mg/dL}$，$B = 20$ $\\mathrm{mU}$，$\\sigma = 0$ $\\mathrm{mg/dL}$，$\\tau = 20$ $\\mathrm{min}$，$T = 360$ $\\mathrm{min}$，$h = 0.5$ $\\mathrm{min}$，seed $= 4$。\n\n输出规范。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}\\right]$），其中每个 $\\mathrm{result}$ 是一个布尔值，指示在上述操作标准下，相应测试用例的闭环是否稳定。",
            "solution": "问题陈述已经过验证并被认为是有效的。它在科学上基于生物医学系统建模的既定原则，特别是葡萄糖调节的药代动力学和药效动力学。该问题定义良好，提供了所有必要的参数、初始条件和清晰、客观的任务。它没有歧义、矛盾和事实错误。\n\n### 理论框架\n\n#### 1. 混合动力模型\n\n该系统将闭环葡萄糖控制描述为一个混合自动机。状态为 $\\mathbf{x}(t) = [G(t), I(t)]^T$，其中 $G(t)$ 是血浆葡萄糖浓度（单位为 $\\mathrm{mg/dL}$），$I(t)$ 是有效的皮下胰岛素浓度（单位为 $\\mathrm{mU}$）。该模型包括两个主要部分：连续演化（流）和离散事件（跳跃）。\n\n**连续动力学（流）：**在事件之间，状态根据一组常微分方程（ODE）演化。鉴于问题约束基础胰岛素输注 $u_{\\mathrm{basal}} = 0$ 和葡萄糖扰动 $d(t) = 0$，动力学为：\n$$\n\\frac{dG}{dt} = -k_g \\left(G(t) - G_b\\right) - S_I\\, I(t)\\, \\left(G(t) - G_b\\right)\n$$\n$$\n\\frac{dI}{dt} = -k_i\\, I(t)\n$$\n此处，$k_g$ 是不依赖胰岛素的葡萄糖清除率，$S_I$ 是胰岛素敏感性，$k_i$ 是胰岛素清除率，$G_b$ 是基础葡萄糖设定点。这些方程描述了葡萄糖如何自然地返回到基线，以及这个过程如何被胰岛素加速，而胰岛素本身会随时间衰减。\n\n**离散动力学（跳跃）：**系统状态在特定的事件时间 $t_k$ 发生瞬时改变。这些事件由基于带噪声的葡萄糖测量 $y(t) = G(t) + \\varepsilon(t)$ 的控制器触发，其中 $\\varepsilon(t) \\sim \\mathcal{N}(0, \\sigma^2)$。如果满足以下所有三个条件，则发生一个事件：\n1.  **保护条件：**带噪声的测量值 $y(t)$ 从下方跨越阈值 $\\theta$。也就是说，保护函数 $\\gamma(t) = y(t) - \\theta$ 变为非负，而此前是负值。\n2.  **驻留时间约束：**自上一个事件 $t_{k-1}$ 以来已过去最小时间 $\\tau$，即 $t_k - t_{k-1} \\ge \\tau$。\n3.  **重置映射：**在事件时间 $t_k$，施加一个大小为 $B$ 的胰岛素推注。状态重置如下：\n    $$\n    G(t_k^+) = G(t_k^-)\n    $$\n    $$\n    I(t_k^+) = I(t_k^-) + B\n    $$\n其中 $t_k^-$ 和 $t_k^+$ 分别表示事件发生前和发生后的瞬间。\n\n#### 2. 通过 Lyapunov 风格的论证进行稳定性分析\n\n任务要求论证为什么这种控制策略可以导致 $G(t)$ 在其设定点 $G_b$ 附近的均方有界性。让我们将葡萄糖与设定点的偏差定义为 $g(t) = G(t) - G_b$。该子系统的一个简单 Lyapunov 函数候选是 $V(g) = \\frac{1}{2}g^2$。在连续流阶段，$V$ 的时间导数为：\n$$\n\\dot{V} = \\frac{dV}{dg}\\frac{dg}{dt} = g \\cdot \\left[ -k_g g - S_I I(t) g \\right] = -(k_g + S_I I(t)) g^2\n$$\n由于 $k_g  0$，$S_I  0$，并且 $I(t) \\ge 0$（胰岛素浓度不能为负），因此项 $(k_g + S_I I(t))$ 严格为正。因此，$\\dot{V} \\le 0$。如果 $g \\neq 0$，则该导数严格为负，这表明在事件之间，葡萄糖水平 $G(t)$ 总是被驱动向设定点 $G_b$。系统的流动力学是内在稳定的。\n\n离散事件（推注注射）作为一种校正控制动作。当 $y(t) = G(t) + \\varepsilon(t) \\ge \\theta$ 时触发推注，这通常发生在 $G(t)$ 显著高于 $G_b$ 时。推注 $B$ 会导致 $I(t)$ 瞬间增加，这使得项 $S_I I(t)$ 变大，从而使 $\\dot{V}$ 更负，加速了 $G(t)$ 返回到 $G_b$。\n\n在有噪声存在下的稳定性可以如下理解：\n*   **有界输入：**推注大小 $B$ 是有限的。这可以防止单次可能错误的测量注入无限量的胰岛素，从而导致严重的低血糖。系统不会因单个事件而失稳。\n*   **驻留时间：**最小事件间时间 $\\tau$ 可以防止推注频率过高（这种现象在混合系统中称为 Zeno 行为，在糖尿病护理中称为“胰岛素叠加”）。这限制了在任何有限时期内注入的胰岛素总量，确保 $I(t)$ 保持有界，并为系统在施用下一次推注前对前一次推注做出反应提供了时间。\n*   **噪声效应：**零均值的测量噪声 $\\varepsilon(t)$ 可能导致过早触发（当一个正的 $\\varepsilon(t)$ 即使在 $G(t)  \\theta$ 时也将 $y(t)$ 推高到 $\\theta$ 以上）和错过触发（当一个负的 $\\varepsilon(t)$ 即使在 $G(t) \\ge \\theta$ 时也使 $y(t)$ 保持在 $\\theta$ 以下）。虽然单个触发可能不是最优的，但噪声的零均值特性意味着没有系统性偏差。随着时间的推移，控制器的行为平均而言是校正性的。\n*   **均方有界性：**稳定的连续动力学与有界的、非 Zeno 的、校正性的离散控制器相结合，意味着状态轨迹被“困”在平衡点 $(G_b, 0)$ 周围的某个区域内。噪声引入了随机扰动，导致状态波动。然而，由于恢复力（连续的和离散的）随着状态远离设定点而増长，这些波动的方差保持有限。这就是均方有界性的本质。这个有界区域的大小（以及方差 $v$）将取决于噪声方差 $\\sigma^2$ 和控制器参数（$\\theta, B, \\tau$）。\n\n#### 3. 数值实现\n\n为了测试这个模型，我们使用固定时间步长 $h$ 的前向 Euler 方法实现了一个离散时间仿真。\n\n**离散化：**令 $t_n = n h$，则 $G_n \\approx G(t_n)$ 且 $I_n \\approx I(t_n)$。常微分方程的 Euler 近似为：\n$$\nG_{n+1} = G_n + h \\cdot \\left[ -k_g(G_n - G_b) - S_I I_{\\mathrm{eff},n} (G_n - G_b) \\right]\n$$\n$$\nI_{n+1} = I_{\\mathrm{eff},n} + h \\cdot \\left[ -k_i I_{\\mathrm{eff},n} \\right] = I_{\\mathrm{eff},n}(1 - h k_i)\n$$\n其中 $I_{\\mathrm{eff},n}$ 是区间 $[t_n, t_{n+1}]$ 开始时的有效胰岛素水平。\n\n**仿真算法：**\n1.  初始化状态变量 $G_0, I_0$，仿真时间 $t=0$，并将 `last_event_time` 初始化为一个足够小的值（例如 $-\\infty$）以允许初始事件发生。初始化一个 `y_prev` 变量以检测阈值穿越。\n2.  对于从 $0$ 到 $N-1 = T/h - 1$ 的每个时间步 $n$：\n    a. 令 $t_n = n \\cdot h$。\n    b. 生成一个测量噪声样本 $\\varepsilon_n \\sim \\mathcal{N}(0, \\sigma^2)$。\n    c. 计算带噪声的测量值 $y_n = G_n + \\varepsilon_n$。\n    d. 检查事件触发：条件是 (`y_n >= \\theta`)、(`y_{prev}  \\theta`) 和 (`t_n - \\text{last\\_event\\_time} \\ge \\tau`)。`y_{prev}  \\theta` 条件将“从负值穿越”的要求离散化。\n    e. 定义当前步骤的有效胰岛素，$I_{\\mathrm{eff},n} = I_n$。\n    f. 如果触发事件，应用重置映射：更新 $I_{\\mathrm{eff},n} \\leftarrow I_{\\mathrm{eff},n} + B$ 并记录事件时间：$\\text{last\\_event\\_time} = t_n$。\n    g. 为下一次迭代更新 `y_prev = y_n`。\n    h. 使用 $G_n$ 和（可能已更新的）$I_{\\mathrm{eff},n}$ 的 Euler 公式，计算下一个时间步的状态 $G_{n+1}$ 和 $I_{n+1}$。\n3.  仿真完成后，收集仿真后半段的葡萄糖历史 $G(t)$，即对于 $t \\in [T/2, T]$。\n4.  计算所收集数据的样本均值 $\\mu$ 和样本方差 $v$（使用 Bessel 校正，ddof=1）。\n5.  应用操作稳定性测试：如果 $|\\mu - G_b| \\leq \\epsilon_\\mu$ 且 $v \\leq v_{\\max}$，则系统被宣告为“稳定”。对于此问题，$\\epsilon_\\mu = 5 \\, \\mathrm{mg/dL}$ 且 $v_{\\max} = 400 \\, (\\mathrm{mg/dL})^2$。",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(params):\n    \"\"\"\n    Runs a single simulation of the hybrid glucose-insulin model.\n    \"\"\"\n    # Unpack parameters\n    k_g = params[\"k_g\"]\n    S_I = params[\"S_I\"]\n    k_i = params[\"k_i\"]\n    G_b = params[\"G_b\"]\n    G_0 = params[\"G_0\"]\n    I_0 = params[\"I_0\"]\n    theta = params[\"theta\"]\n    B = params[\"B\"]\n    sigma = params[\"sigma\"]\n    tau = params[\"tau\"]\n    T = params[\"T\"]\n    h = params[\"h\"]\n    seed = params[\"seed\"]\n    epsilon_mu = params[\"epsilon_mu\"]\n    v_max = params[\"v_max\"]\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(seed)\n\n    # Simulation setup\n    num_steps = int(T / h)\n    G = np.zeros(num_steps + 1)\n    I = np.zeros(num_steps + 1)\n\n    # Initial conditions\n    G[0] = G_0\n    I[0] = I_0\n\n    last_event_time = -np.inf\n    # Initialize y_prev to ensure a trigger can occur at t=0 if y_0 = theta\n    y_prev = -np.inf \n\n    # Simulation loop\n    for n in range(num_steps):\n        t_n = n * h\n        G_n = G[n]\n        I_n = I[n]\n\n        # Generate noisy measurement\n        epsilon_n = rng.normal(0.0, sigma)\n        y_n = G_n + epsilon_n\n\n        # Event trigger logic\n        # 1. Guard check: y_n = theta\n        # 2. Crossing condition: y_prev  theta\n        # 3. Dwell-time constraint: t_n - last_event_time = tau\n        is_event_triggered = (y_n >= theta) and (y_prev  theta) and (t_n - last_event_time >= tau)\n        \n        # Store current y_n for the next iteration's crossing check\n        y_prev = y_n\n\n        # The effective insulin for the current step's dynamics\n        I_eff_n = I_n\n        if is_event_triggered:\n            I_eff_n += B\n            last_event_time = t_n\n\n        # Forward Euler step for continuous dynamics\n        # Note: u_basal and d(t) are zero as per problem statement\n        dG_dt = -k_g * (G_n - G_b) - S_I * I_eff_n * (G_n - G_b)\n        dI_dt = -k_i * I_eff_n\n\n        G[n + 1] = G_n + h * dG_dt\n        # The Euler step for insulin starts from the post-bolus value\n        I[n + 1] = I_eff_n + h * dI_dt\n\n    # Stability assessment over the last T/2 minutes\n    analysis_start_index = int(num_steps / 2)\n    G_analysis_slice = G[analysis_start_index:]\n    \n    mu = np.mean(G_analysis_slice)\n    # Use ddof=1 for sample variance as is standard\n    v = np.var(G_analysis_slice, ddof=1)\n    \n    is_stable = (abs(mu - G_b) = epsilon_mu) and (v = v_max)\n    \n    return is_stable\n\ndef solve():\n    \"\"\"\n    Defines test cases and runs the simulation for each to determine stability.\n    \"\"\"\n    common_tolerances = {\n        \"epsilon_mu\": 5.0,     # mg/dL\n        \"v_max\": 400.0       # (mg/dL)^2\n    }\n\n    test_cases = [\n        # Case 1 (happy path)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 180, \"I_0\": 0,\n         \"theta\": 140, \"B\": 30, \"sigma\": 5, \"tau\": 20, \"T\": 360, \"h\": 0.5, \"seed\": 1, **common_tolerances},\n        # Case 2 (high noise, frequent events)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 130, \"I_0\": 0,\n         \"theta\": 110, \"B\": 50, \"sigma\": 30, \"tau\": 5, \"T\": 360, \"h\": 0.5, \"seed\": 2, **common_tolerances},\n        # Case 3 (small bolus)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 160, \"I_0\": 0,\n         \"theta\": 140, \"B\": 5, \"sigma\": 5, \"tau\": 20, \"T\": 360, \"h\": 0.5, \"seed\": 3, **common_tolerances},\n        # Case 4 (noise-free boundary)\n        {\"k_g\": 0.01, \"S_I\": 5e-4, \"k_i\": 0.05, \"G_b\": 100, \"G_0\": 150, \"I_0\": 0,\n         \"theta\": 120, \"B\": 20, \"sigma\": 0, \"tau\": 20, \"T\": 360, \"h\": 0.5, \"seed\": 4, **common_tolerances}\n    ]\n\n    results = []\n    for params in test_cases:\n        is_stable = run_simulation(params)\n        results.append(is_stable)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}