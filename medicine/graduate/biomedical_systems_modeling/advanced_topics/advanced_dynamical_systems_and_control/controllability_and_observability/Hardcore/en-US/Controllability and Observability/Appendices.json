{
    "hands_on_practices": [
        {
            "introduction": "The ability to influence a biological system, such as a gene network, with an external input like a drug is a fundamental goal in biomedicine. For linear time-invariant (LTI) models, this concept is formalized as controllability, which can be rigorously assessed using the Kalman rank condition. This first exercise provides a direct application of this test to a linearized two-gene signaling module, building a foundational skill for analyzing the potential of any therapeutic intervention. ",
            "id": "4364519",
            "problem": "A two-gene signaling module in a cellular pathway is linearized around a homeostatic equilibrium to study small-signal regulation by an external control input representing a drug infusion. The linearized state-space model is a Single-Input Linear Time-Invariant (LTI) system given by $\\dot{x}(t)=A x(t)+B u(t)$, where $x(t) \\in \\mathbb{R}^{2}$ are deviations of gene activities from steady state and $u(t) \\in \\mathbb{R}$ is the control input. The matrices are\n$$\nA=\\begin{bmatrix}0 & 1 \\\\ -2 & -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\nUsing only foundational definitions of controllability for Linear Time-Invariant systems, compute the rank of the controllability matrix associated with $\\left(A,B\\right)$ and conclude whether the linearized gene module is controllable in the small-signal sense about the equilibrium. Report your final answer as the rank of the controllability matrix $\\operatorname{rank}(\\mathcal{C})$ as a single integer with no units. No rounding is required.",
            "solution": "The problem asks for an assessment of the controllability of a linearized two-gene signaling module described by a Linear Time-Invariant (LTI) state-space model. The model is given by the equation $\\dot{x}(t)=A x(t)+B u(t)$, where the state dimension is $n=2$. The provided matrices are:\n$$\nA=\\begin{bmatrix}0 & 1 \\\\ -2 & -3\\end{bmatrix},\\qquad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\n$$\nThe controllability of an LTI system is determined by the rank of its controllability matrix, denoted as $\\mathcal{C}$. For a system of dimension $n$, the controllability matrix is constructed as:\n$$\n\\mathcal{C} = \\begin{bmatrix} B & AB & A^2B & \\cdots & A^{n-1}B \\end{bmatrix}\n$$\nThe system is controllable if and only if the controllability matrix $\\mathcal{C}$ has full rank, which means $\\operatorname{rank}(\\mathcal{C}) = n$. This is known as the Kalman rank condition for controllability.\n\nFor the given system, the state dimension is $n=2$. Therefore, the controllability matrix is given by:\n$$\n\\mathcal{C} = \\begin{bmatrix} B & AB \\end{bmatrix}\n$$\nThe first column of $\\mathcal{C}$ is the input matrix $B$ itself:\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\nThe second column of $\\mathcal{C}$ is the product of the state matrix $A$ and the input matrix $B$. We compute this product:\n$$\nAB = \\begin{bmatrix}0 & 1 \\\\ -2 & -3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\end{bmatrix}\n$$\nNow, we can construct the controllability matrix $\\mathcal{C}$ by concatenating the column vectors $B$ and $AB$:\n$$\n\\mathcal{C} = \\begin{bmatrix} 0 & 1 \\\\ 1 & -3 \\end{bmatrix}\n$$\nTo determine the rank of the $2 \\times 2$ matrix $\\mathcal{C}$, we can compute its determinant. A square matrix has full rank if and only if its determinant is non-zero.\n$$\n\\det(\\mathcal{C}) = (0)(-3) - (1)(1) = 0 - 1 = -1\n$$\nSince $\\det(\\mathcal{C}) = -1 \\neq 0$, the columns of the matrix $\\mathcal{C}$ are linearly independent. For a $2 \\times 2$ matrix, this means it has a rank of $2$.\n$$\n\\operatorname{rank}(\\mathcal{C}) = 2\n$$\nAccording to the Kalman rank condition, the system is controllable if $\\operatorname{rank}(\\mathcal{C})$ is equal to the dimension of the state space, $n$. In this case, we have found that $\\operatorname{rank}(\\mathcal{C}) = 2$, and the state dimension is $n=2$. Since $\\operatorname{rank}(\\mathcal{C}) = n$, the system is completely controllable. This implies that it is possible to steer the state of the linearized gene module from any initial state to any desired final state in finite time using an appropriate control input $u(t)$.\n\nThe problem asks for the rank of the controllability matrix, which we have computed to be $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While the Kalman rank test applies to a given state-space model, the choice of the model itself is paramount. An input-output transfer function can have multiple state-space realizations, not all of which are 'minimal'. This exercise explores the critical relationship between pole-zero cancellations in a transfer function and the controllability and observability of its state-space representation, revealing why a higher-order model is not always better and how internal system dynamics can be hidden from the input or output. ",
            "id": "1706947",
            "problem": "Consider a single-input, single-output (SISO) Linear Time-Invariant (LTI) system. The relationship between the Laplace transform of the input, $U(s)$, and the Laplace transform of the output, $Y(s)$, is given by the transfer function:\n$$G(s) = \\frac{Y(s)}{U(s)} = \\frac{s + 1}{s^2 + 3s + 2}$$\nA control engineer aims to implement this system using a two-dimensional state-space model of the form:\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\n$$ y(t) = C \\mathbf{x}(t) + D u(t) $$\nwhere $\\mathbf{x}(t)$ is the 2x1 state vector, $A$ is a 2x2 matrix, $B$ is a 2x1 matrix, $C$ is a 1x2 matrix, and we can assume the scalar $D=0$.\n\nWhich of the following statements is necessarily true for *any* valid two-dimensional state-space realization of this transfer function?\n\nA. The realization is always controllable and always observable.\n\nB. The realization is always controllable, but might be unobservable.\n\nC. The realization is always observable, but might be uncontrollable.\n\nD. The realization must be either uncontrollable, or unobservable, or both.\n\nE. Whether the realization is controllable or observable depends entirely on the chosen state variables, and it is possible to find a realization that is both controllable and observable.",
            "solution": "We start from the given transfer function\n$$G(s)=\\frac{Y(s)}{U(s)}=\\frac{s+1}{s^{2}+3s+2}.$$\nFactor the denominator:\n$$s^{2}+3s+2=(s+1)(s+2),$$\nso\n$$G(s)=\\frac{s+1}{(s+1)(s+2)}=\\frac{1}{s+2}.$$\nTherefore, the transfer function reduces to a first-order strictly proper form, and its McMillan degree is\n$$n_{\\min}=1.$$\n\nAny state-space realization $(A,B,C,D)$ with $D=0$ satisfies\n$$G(s)=C(sI-A)^{-1}B.$$\nFundamental realization theory states:\n- A realization is minimal if and only if it is both controllable and observable.\n- The minimal dimension of any realization equals the McMillan degree of $G(s)$.\n\nSince $n_{\\min}=1$, any two-dimensional realization is necessarily non-minimal. Hence, by the minimality criterion, it cannot be both controllable and observable. Equivalently, every such two-dimensional realization must be either uncontrollable, or unobservable, or both.\n\nThus, among the options, the statement that is necessarily true for any valid two-dimensional realization is that it must be either uncontrollable, or unobservable, or both.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "Controllability is not always a robust, binary property; it can be fragile. A system that is 'structurally controllable' based on its network wiring may lose this property due to precise, and often unexpected, numerical cancellations among its parameters. This advanced practice delves into this critical distinction within the context of an insulin signaling model, demonstrating how to identify such parameter-specific failures and highlighting the profound implications for the robustness of biomedical control strategies. ",
            "id": "3879501",
            "problem": "Consider a linear time-invariant (LTI) state-space model obtained by linearizing a three-node insulin signaling cascade around a physiological equilibrium in a controlled glucose infusion experiment. The three states are: receptor occupancy $x_1$, downstream kinase activity $x_2$, and glucose uptake rate $x_3$. The input $u(t)$ is the insulin infusion rate administered intravenously. The linearized dynamics are given by\n$$\n\\dot{x} = A x + B u,\n$$\nwith\n$$\nA =\n\\begin{pmatrix}\n- a & 0 & t \\\\\np & - b & 0 \\\\\nr & q & - c\n\\end{pmatrix},\n\\qquad\nB =\n\\begin{pmatrix}\nu \\\\\n0 \\\\\n0\n\\end{pmatrix},\n$$\nwhere $a$, $b$, $c$ are positive clearance rates ($a,b,c>0$), and $p$, $q$, $r$, $t$ are coupling gains satisfying $p,q,t>0$ and $r \\in \\mathbb{R}$ (the sign of $r$ depends on whether the direct effect of receptor occupancy on glucose uptake reinforces or counteracts the kinase-mediated path). The infusion gain $u>0$ scales the input channel at the receptor. All entries of $A$ have units of $\\mathrm{min}^{-1}$, and $B$ has units $\\mathrm{min}^{-1}$ per unit input. The nonzero pattern of the directed graph associated with $(A,B)$ exhibits a path from the input node to each state via arcs $x_1 \\to x_2$ at rate $p$, $x_2 \\to x_3$ at rate $q$, and a direct arc $x_1 \\to x_3$ at rate $r$, with feedback $x_3 \\to x_1$ at rate $t$.\n\nStarting from the foundational definition of controllability for LTI systems, derive an analytic expression for the determinant of the controllability matrix in terms of the parameters $a$, $b$, $c$, $p$, $q$, $r$, $t$, and $u$, and use it to identify the specific value $r^{\\star}$ that makes the system uncontrollable even though the nonzero pattern implies structural controllability.\n\nThen, with the numerically plausible parameter choices\n$$\na = 0.8,\\quad b = 0.3,\\quad c = 0.5,\\quad p = 0.2,\\quad q = 0.25,\\quad t = 0.1,\\quad u = 1.0,\n$$\ncompute the unique value $r^{\\star}$ (in $\\mathrm{min}^{-1}$) at which controllability is lost due to cancellation, and briefly discuss the robustness implications of operating near $r^{\\star}$ for data-driven controller design in this biomedical context. Express your final numerical answer for $r^{\\star}$ in $\\mathrm{min}^{-1}$, and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of the condition under which a given linear time-invariant (LTI) biomedical system loses controllability, and to compute a specific parameter value that causes this loss.\n\nFirst, we validate the problem statement.\nThe given LTI system is described by the state-space equation $\\dot{x} = A x + B u$, where $x \\in \\mathbb{R}^3$ is the state vector, $u \\in \\mathbb{R}$ is the control input, and the matrices $A$ and $B$ are:\n$$\nA =\n\\begin{pmatrix}\n- a & 0 & t \\\\\np & - b & 0 \\\\\nr & q & - c\n\\end{pmatrix},\n\\qquad\nB =\n\\begin{pmatrix}\nu \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\nThe parameters are subject to the constraints $a, b, c > 0$, $p, q, t > 0$, and $u > 0$, with $r \\in \\mathbb{R}$. Numerical values are provided for a specific calculation: $a = 0.8$, $b = 0.3$, $c = 0.5$, $p = 0.2$, $q = 0.25$, $t = 0.1$, $u = 1.0$. All these quantities are clearly defined, and their physical interpretations (clearance rates, coupling gains) are consistent with biomedical systems modeling. The problem is scientifically grounded, well-posed, and contains no contradictions. The task is a standard exercise in linear control theory. The problem is therefore deemed valid.\n\nWe proceed with the solution. The foundational definition of controllability for an LTI system states that the system is controllable if, for any initial state $x(0)$ and any final state $x_f$, there exists a control input $u(t)$ over a finite time interval $[0, t_f]$ that steers the state from $x(0)$ to $x_f$. For LTI systems, this is equivalent to the Kalman rank condition, which states that the controllability matrix $\\mathcal{C}$ must have full rank. The state dimension is $n=3$ and the input dimension is $m=1$. The controllability matrix is given by:\n$$\n\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}\n$$\nFor this $3 \\times 3$ matrix, full rank (rank $3$) is equivalent to its determinant being non-zero. The system is controllable if and only if $\\det(\\mathcal{C}) \\neq 0$. The system becomes uncontrollable when $\\det(\\mathcal{C}) = 0$.\n\nWe now construct the controllability matrix $\\mathcal{C}$ by computing its columns.\nThe first column is the matrix $B$:\n$$\nB = \\begin{pmatrix} u \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe second column is the product $AB$:\n$$\nAB = \\begin{pmatrix} -a & 0 & t \\\\ p & -b & 0 \\\\ r & q & -c \\end{pmatrix} \\begin{pmatrix} u \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -au \\\\ pu \\\\ ru \\end{pmatrix}\n$$\nThe third column is $A^2B = A(AB)$:\n$$\nA^2B = \\begin{pmatrix} -a & 0 & t \\\\ p & -b & 0 \\\\ r & q & -c \\end{pmatrix} \\begin{pmatrix} -au \\\\ pu \\\\ ru \\end{pmatrix} = \\begin{pmatrix} (-a)(-au) + (0)(pu) + (t)(ru) \\\\ (p)(-au) + (-b)(pu) + (0)(ru) \\\\ (r)(-au) + (q)(pu) + (-c)(ru) \\end{pmatrix} = \\begin{pmatrix} (a^2 + tr)u \\\\ (-ap - bp)u \\\\ (-ar + pq - cr)u \\end{pmatrix} = u \\begin{pmatrix} a^2 + tr \\\\ -(a+b)p \\\\ pq - (a+c)r \\end{pmatrix}\n$$\nNow, we assemble the controllability matrix $\\mathcal{C}$:\n$$\n\\mathcal{C} = \\begin{pmatrix} u & -au & (a^2+tr)u \\\\ 0 & pu & -(a+b)pu \\\\ 0 & ru & (pq - (a+c)r)u \\end{pmatrix}\n$$\nNext, we compute the determinant of $\\mathcal{C}$. We can factor $u$ from each of the three columns:\n$$\n\\det(\\mathcal{C}) = u^3 \\det \\begin{pmatrix} 1 & -a & a^2+tr \\\\ 0 & p & -(a+b)p \\\\ 0 & r & pq - (a+c)r \\end{pmatrix}\n$$\nUsing cofactor expansion along the first column, the determinant is:\n$$\n\\det(\\mathcal{C}) = u^3 \\cdot 1 \\cdot \\det \\begin{pmatrix} p & -(a+b)p \\\\ r & pq - (a+c)r \\end{pmatrix}\n$$\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p(pq - (a+c)r) - r(-(a+b)p) \\right)\n$$\nExpanding and simplifying the expression inside the parentheses:\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p^2q - p(a+c)r + pr(a+b) \\right)\n$$\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p^2q - apr - cpr + apr + bpr \\right)\n$$\n$$\n\\det(\\mathcal{C}) = u^3 \\left( p^2q + (b-c)pr \\right)\n$$\nThis can be factored further to yield the final analytic expression for the determinant:\n$$\n\\det(\\mathcal{C}) = u^3 p \\left( pq + (b-c)r \\right)\n$$\nThe system becomes uncontrollable when $\\det(\\mathcal{C}) = 0$. Given the problem constraints that $u > 0$ and $p > 0$, the term $u^3p$ is non-zero. Therefore, the condition for uncontrollability is:\n$$\npq + (b-c)r = 0\n$$\nWe solve this equation for $r$ to find the specific value $r^\\star$ that causes this loss of controllability. Assuming $b \\neq c$:\n$$\n(b-c)r = -pq\n$$\n$$\nr^\\star = -\\frac{pq}{b-c} = \\frac{pq}{c-b}\n$$\nThis is the value of $r$ for which a specific numerical cancellation occurs, making the system uncontrollable despite its structure (as indicated by the directed graph) suggesting controllability for generic parameter values. This is a failure of controllability, not structural controllability.\n\nNext, we compute the numerical value of $r^\\star$ using the provided parameters: $p = 0.2$, $q = 0.25$, $b = 0.3$, and $c = 0.5$.\n$$\nr^\\star = \\frac{(0.2)(0.25)}{0.5 - 0.3} = \\frac{0.05}{0.2} = 0.25\n$$\nThe units for all entries in matrix $A$, including $r$, are given as $\\mathrm{min}^{-1}$. So, $r^\\star = 0.25 \\, \\mathrm{min}^{-1}$. Rounding to four significant figures as requested, we get $r^\\star = 0.2500 \\, \\mathrm{min}^{-1}$.\n\nFinally, we discuss the robustness implications. The loss of controllability at $r = r^\\star$ is a result of a precise mathematical cancellation. In a real-world biomedical context, system parameters are never known with infinite precision. They are estimated from noisy data and are subject to biological variability. If the true value of the parameter $r$ for a patient is close to $r^\\star$, the system will be \"nearly uncontrollable\". This is because the determinant of the controllability matrix, $\\det(\\mathcal{C})$, becomes very small, indicating that the controllable subspace is close to collapsing.\n\nNear-uncontrollability has severe implications for controller design.\n$1$. **High Control Effort**: Attempting to steer the system state in \"difficult\" directions (those nearly outside the controllable subspace) would require excessively large control inputs, i.e., high insulin infusion rates, which can be dangerous for the patient (e.g., causing hypoglycemia).\n$2$. **Model Identification and Data-Driven Design**: If a system is operated near an uncontrollable point, the input-output data collected might lack the necessary richness to accurately identify the system dynamics. The effects of the input on certain state combinations would be attenuated, leading to poorly conditioned estimation problems and inaccurate models. A controller designed based on such a flawed, data-driven model would likely be non-robust and perform poorly, potentially becoming unstable with small variations in patient parameters.\n$3$. **Sensitivity**: The performance and stability of a controller can become extremely sensitive to parameter errors when the system is nearly uncontrollable. A controller designed for an estimated $r$ might fail if the patient's true $r$ is slightly different and closer to $r^\\star$.\nTherefore, operating a biomedical control system, such as an artificial pancreas, near a point of uncontrollability is extremely non-robust and poses significant risks. It is a critical consideration in model-based or data-driven design to assess the system's \"distance\" from uncontrollability to ensure safety and efficacy.",
            "answer": "$$\n\\boxed{0.2500}\n$$"
        }
    ]
}