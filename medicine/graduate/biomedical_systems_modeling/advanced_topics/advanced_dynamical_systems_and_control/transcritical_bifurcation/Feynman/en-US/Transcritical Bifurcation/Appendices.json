{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing a system with a potential bifurcation is to identify the critical parameter value where the qualitative change in dynamics occurs. This exercise provides fundamental practice in finding this threshold . By analyzing a model of an enzyme in a synthetic biological circuit, you will calculate the specific concentration of an inhibitor that triggers a transcritical bifurcation, grounding the abstract mathematical condition in a tangible biomedical context.",
            "id": "1724859",
            "problem": "The dynamics of the concentration of an enzyme, $y(t)$, in a synthetic biological circuit can be modeled by the following first-order nonlinear differential equation:\n$$ \\frac{dy}{dt} = (k_p - k_d - \\beta c)y - \\frac{k_p}{Y_{max}} y^2 $$\nIn this model, the concentration of an externally applied inhibitor molecule, $c$, acts as a control parameter for the system. The system exhibits a transcritical bifurcation at the trivial fixed point $y=0$ as the parameter $c$ is varied.\n\nThe parameters of the system have been experimentally determined as:\n- Maximal autocatalytic production rate constant, $k_p = 0.52 \\text{ min}^{-1}$.\n- Natural enzyme degradation rate constant, $k_d = 0.11 \\text{ min}^{-1}$.\n- Inhibitor effectiveness constant, $\\beta = 0.075 \\text{ L} \\cdot \\mu\\text{mol}^{-1} \\cdot \\text{min}^{-1}$.\n- Enzyme saturation concentration, $Y_{max} = 15 \\text{ }\\mu\\text{M}$.\n\nBoth $y$ and $c$ are measured in micromoles per liter ($\\mu\\text{M}$).\n\nDetermine the critical value of the inhibitor concentration, $c_{crit}$, at which the system undergoes a transcritical bifurcation at the equilibrium point $y=0$. Express your answer in units of micromoles per liter ($\\mu\\text{M}$) and round your final answer to three significant figures.",
            "solution": "We are given the differential equation\n$$\n\\frac{dy}{dt} = \\left(k_{p} - k_{d} - \\beta c\\right)y - \\frac{k_{p}}{Y_{\\max}}y^{2}.\n$$\nEquilibria satisfy\n$$\n0 = \\left(k_{p} - k_{d} - \\beta c\\right)y - \\frac{k_{p}}{Y_{\\max}}y^{2}\n= y\\left[\\left(k_{p} - k_{d} - \\beta c\\right) - \\frac{k_{p}}{Y_{\\max}}y\\right].\n$$\nThus the fixed points are\n$$\ny_{1}=0,\\qquad y_{2}=\\frac{Y_{\\max}}{k_{p}}\\left(k_{p} - k_{d} - \\beta c\\right).\n$$\nA transcritical bifurcation at $y=0$ occurs when the linearization at $y=0$ changes stability and the nontrivial equilibrium collides with $y=0$. The Jacobian (derivative of the right-hand side with respect to $y$) is\n$$\nf_{y}(y;c)=\\left(k_{p} - k_{d} - \\beta c\\right) - 2\\frac{k_{p}}{Y_{\\max}}y,\n$$\nso at $y=0$,\n$$\nf_{y}(0;c)=k_{p} - k_{d} - \\beta c.\n$$\nThe bifurcation occurs when $f_{y}(0;c)=0$, which gives the critical inhibitor concentration\n$$\nc_{\\text{crit}}=\\frac{k_{p} - k_{d}}{\\beta}.\n$$\nSubstituting the given parameter values,\n$$\nc_{\\text{crit}}=\\frac{0.52 - 0.11}{0.075}=\\frac{0.41}{0.075}=\\frac{82}{15}\\approx 5.466\\overline{6}.\n$$\nRounding to three significant figures yields $5.47$ in micromolar units, as requested.",
            "answer": "$$\\boxed{5.47}$$"
        },
        {
            "introduction": "A transcritical bifurcation is fundamentally characterized by the exchange of stability between a trivial and a non-trivial fixed point. This practice is designed to make this core concept concrete by having you analyze the system's behavior on both sides of the bifurcation point . You will determine the stable equilibrium for a population dynamics model under different environmental conditions, directly observing how the system's long-term fate switches as the control parameter crosses the critical value.",
            "id": "1724904",
            "problem": "A simplified one-dimensional model for the population dynamics of a certain species in a controlled environment is described by the differential equation:\n$$ \\frac{dx}{dt} = r x + \\alpha x^2 $$\nwhere $x(t)$ is a dimensionless measure of the population density, $t$ is time, $r$ is a tunable control parameter related to the net growth rate, and $\\alpha$ is a constant modeling interaction effects between individuals. For a particular species under study, the interaction parameter is empirically found to be $\\alpha = 5$.\n\nThe system's long-term behavior depends critically on the value of the control parameter $r$. An experiment is conducted under two different conditions. In the first trial, the control parameter is set to $r_1 = -2.5$. In the second trial, it is set to $r_2 = 2.5$. For each trial, the population is observed to settle to a stable equilibrium value (a stable fixed point).\n\nCalculate the sum of the stable fixed points corresponding to the two trials ($r = r_1$ and $r = r_2$). Express your final answer as a decimal rounded to two significant figures.",
            "solution": "We analyze fixed points and their stability for the autonomous ODE $ \\frac{dx}{dt} = f(x) = r x + \\alpha x^{2} $ with $\\alpha=5$.\n\nFixed points satisfy $f(x^{*})=0$:\n$$\nr x^{*} + \\alpha (x^{*})^{2} = 0 \\;\\;\\Longrightarrow\\;\\; x^{*}\\in\\{0,\\; -\\tfrac{r}{\\alpha}\\}.\n$$\nStability is determined by the linearization $f'(x)=r+2\\alpha x$; a fixed point $x^{*}$ is stable if $f'(x^{*})0$.\n\nTrial 1: $r=r_{1}=-2.5$. Fixed points: $x^{*}=0$ and $x^{*}=-r_{1}/\\alpha = -(-2.5)/5 = 0.5$.\n- At $x^{*}=0$: $f'(0)=r_{1}=-2.50$ hence stable.\n- At $x^{*}=0.5$: $f'(0.5)=r_{1}+2\\alpha(0.5)= -2.5 + 2\\cdot 5 \\cdot 0.5 = -2.5+5=2.50$ hence unstable.\nThus the stable fixed point is $0$.\n\nTrial 2: $r=r_{2}=2.5$. Fixed points: $x^{*}=0$ and $x^{*}=-r_{2}/\\alpha = -2.5/5 = -0.5$.\n- At $x^{*}=0$: $f'(0)=r_{2}=2.50$ hence unstable.\n- At $x^{*}=-0.5$: $f'(-0.5)=r_{2}+2\\alpha(-0.5)= 2.5 + 2\\cdot 5 \\cdot (-0.5)=2.5-5=-2.50$ hence stable.\nThus the stable fixed point is $-0.5$.\n\nThe sum of the stable fixed points from the two trials is $0 + (-0.5) = -0.5$. Rounded to two significant figures, this is $-0.50$.",
            "answer": "$$\\boxed{-0.50}$$"
        },
        {
            "introduction": "In modern biomedical research, models are often too complex for full analytical solution and are explored through computer simulation. This advanced practice bridges the gap between bifurcation theory and computational science by testing the formal mathematical conditions for a bifurcation using only numerical data . You will learn to estimate key derivatives from a 'black box' simulator to verify the nondegeneracy conditions for a transcritical bifurcation, a powerful technique for model validation in a research setting.",
            "id": "3939176",
            "problem": "Consider a one-dimensional ordinary differential equation modeling homeostatic cell density in a well-mixed compartment, where the state $x$ denotes a dimensionless cell density and the parameter $\\mu$ denotes the net proliferation drive, with a quadratic saturation arising from contact inhibition. The dynamics are given by the initial value problem $\\frac{dx}{dt} = f(x,\\mu;k)$, where $f$ is smooth in a neighborhood of $(x,\\mu)=(0,0)$ and is specified in simulation form by an explicit Euler step over a small time increment $\\Delta t$: starting from $x(0)=x_0$, produce $x(\\Delta t)=x_0 + \\Delta t\\, f(x_0,\\mu;k)$. Assume $k$ is a nonnegative real parameter capturing the strength of self-limitation.\n\nIn biomedical systems modeling, a transcritical bifurcation occurs when two equilibrium branches intersect and exchange stability. The nondegeneracy conditions for a generic transcritical bifurcation at $(x,\\mu)=(0,0)$ require that $f_{x\\mu}(0,0)\\neq 0$ and $f_{xx}(0,0)\\neq 0$, where subscripts denote partial derivatives. Your task is to develop a numerical method that, given only simulated short-time data from the explicit Euler step described above, estimates $f_{x\\mu}(0,0)$ and $f_{xx}(0,0)$ and then uses these estimates to test the transcritical nondegeneracy conditions.\n\nStarting from core definitions in calculus and dynamical systems, implement an algorithm that:\n- Estimates the right-hand side $f(x,\\mu;k)$ at specified $(x,\\mu)$ by simulating one explicit Euler step of size $\\Delta t$ from $x(0)=x$ and computing the finite difference $(x(\\Delta t)-x)/\\Delta t$.\n- Uses finite differencing around $(x,\\mu)=(0,0)$ with small symmetric perturbations $h_x$ and $h_\\mu$ to numerically approximate $f_{x\\mu}(0,0)$ and $f_{xx}(0,0)$ from the estimated values of $f(x,\\mu;k)$ at the perturbed points.\n- Declares the transcritical nondegeneracy test as satisfied if both $|f_{x\\mu}(0,0)|\\epsilon$ and $|f_{xx}(0,0)|\\epsilon$, for a specified tolerance $\\epsilon0$.\n\nUse the following test suite of parameter sets $(k,h_x,h_\\mu,\\Delta t,\\epsilon)$:\n- Case $1$: $k=1.0$, $h_x=10^{-4}$, $h_\\mu=10^{-4}$, $\\Delta t=10^{-6}$, $\\epsilon=10^{-6}$.\n- Case $2$: $k=0.0$, $h_x=10^{-4}$, $h_\\mu=10^{-4}$, $\\Delta t=10^{-6}$, $\\epsilon=10^{-6}$.\n- Case $3$: $k=2.5$, $h_x=5\\times 10^{-5}$, $h_\\mu=2\\times 10^{-4}$, $\\Delta t=5\\times 10^{-7}$, $\\epsilon=10^{-6}$.\n- Case $4$: $k=10^{-12}$, $h_x=10^{-4}$, $h_\\mu=10^{-4}$, $\\Delta t=10^{-6}$, $\\epsilon=10^{-6}$.\n\nAssume the biomedical simulatorâ€™s underlying $f$ is consistent with contact-limited proliferation, specifically $f(x,\\mu;k)=\\mu x - k x^2$ in a neighborhood of the origin, but you must not use this closed-form to compute derivatives; you must estimate $f$ from the simulated data as described.\n\nYour program must produce, for each test case, a list of three values: the numerical estimates of $f_{x\\mu}(0,0)$ and $f_{xx}(0,0)$ as floating-point numbers, followed by a boolean indicating whether the transcritical nondegeneracy test is satisfied under the tolerance $\\epsilon$. Aggregate the results for all test cases into a single line of output containing a comma-separated list enclosed in square brackets, for example, $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$, where each $a_i$ and $b_i$ are floats and each $c_i$ is a boolean. No physical units are required for the output, and angles are not involved. The final output format must be exactly one line as specified.",
            "solution": "The problem requires the numerical verification of the nondegeneracy conditions for a transcritical bifurcation at the origin $(x, \\mu) = (0, 0)$ for a dynamical system described by the ordinary differential equation $\\frac{dx}{dt} = f(x,\\mu;k)$. The nondegeneracy conditions are given by $f_{x\\mu}(0,0) \\neq 0$ and $f_{xx}(0,0) \\neq 0$, where subscripts denote partial derivatives. The function $f$ itself is not given in a closed form for analysis; instead, it must be estimated from a simulated explicit Euler step.\n\nThe algorithmic approach comprises three main stages: first, defining a numerical estimator for the function $f(x, \\mu; k)$; second, using this estimator within finite difference formulas to approximate the partial derivatives $f_{xx}(0,0)$ and $f_{x\\mu}(0,0)$; and third, applying a tolerance $\\epsilon$ to the magnitudes of these estimated derivatives to test the nondegeneracy conditions.\n\nThe first stage is the estimation of the function $f(x,\\mu;k)$. The problem provides access to the system's dynamics through a simulator that performs a single explicit Euler step. For an initial condition $x(0) = x_0$, the state at time $\\Delta t$ is given by:\n$$ x(\\Delta t) = x_0 + \\Delta t \\cdot f(x_0, \\mu; k) $$\nBy algebraically rearranging this equation, we can construct an estimator for the function $f$ at the point $(x_0, \\mu)$:\n$$ \\hat{f}(x_0, \\mu; k) = \\frac{x(\\Delta t) - x_0}{\\Delta t} $$\nThe problem specifies that the underlying dynamics, used by the simulator, follow the model $f(x,\\mu;k) = \\mu x - k x^2$. While our algorithm must not use this analytical form to compute derivatives, we must use it to define the simulator. Substituting this into the Euler step gives:\n$$ x(\\Delta t) = x_0 + \\Delta t (\\mu x_0 - k x_0^2) $$\nThis function represents the simulation oracle from which we estimate $f$.\n\nThe second stage is the numerical approximation of partial derivatives. We employ central finite difference formulas to estimate the second-order and mixed partial derivatives at the bifurcation point $(x, \\mu) = (0, 0)$, using small symmetric perturbations $h_x$ and $h_\\mu$. The approximation of $f_{xx}(0,0)$ uses the three-point central difference formula:\n$$ f_{xx}(0,0) \\approx \\frac{\\hat{f}(h_x, 0; k) - 2\\hat{f}(0, 0; k) + \\hat{f}(-h_x, 0; k)}{h_x^2} $$\nThe required function values are obtained through our estimator $\\hat{f}$: $\\hat{f}(h_x, 0; k)$ is computed by simulating from $x(0) = h_x$ with $\\mu=0$; $\\hat{f}(0, 0; k)$ is computed from $x(0) = 0$ with $\\mu=0$; and $\\hat{f}(-h_x, 0; k)$ is computed from $x(0) = -h_x$ with $\\mu=0$. The approximation of $f_{x\\mu}(0,0)$ uses the four-point central difference formula:\n$$ f_{x\\mu}(0,0) \\approx \\frac{\\hat{f}(h_x, h_\\mu; k) - \\hat{f}(h_x, -h_\\mu; k) - \\hat{f}(-h_x, h_\\mu; k) + \\hat{f}(-h_x, -h_\\mu; k)}{4 h_x h_\\mu} $$\nThis requires four evaluations of our function estimator $\\hat{f}$ at the corners of a small rectangle centered at the origin in the $(x, \\mu)$ plane. For instance, $\\hat{f}(h_x, h_\\mu; k)$ is computed by simulating from the initial condition $x(0) = h_x$ with the parameter value $\\mu = h_\\mu$.\n\nThe third and final stage is the nondegeneracy test. With the numerical estimates for the derivatives, denoted $\\hat{f}_{xx}(0,0)$ and $\\hat{f}_{x\\mu}(0,0)$, the nondegeneracy conditions are tested against a given positive tolerance $\\epsilon$. The test is declared satisfied if and only if both of the following inequalities hold:\n$$ |\\hat{f}_{xx}(0,0)|  \\epsilon \\quad \\text{and} \\quad |\\hat{f}_{x\\mu}(0,0)|  \\epsilon $$\nThis procedure is then applied to each of the provided test cases. For the given underlying function $f(x, \\mu; k) = \\mu x - k x^2$, the true derivatives are $f_{xx}(0,0) = -2k$ and $f_{x\\mu}(0,0) = 1$. Our numerical estimates should be exceptionally close to these analytical values because the finite difference formulas are exact for polynomials of low degree. The test for nondegeneracy effectively becomes a check on whether $|-2k|  \\epsilon$ and $|1|  \\epsilon$. Given $\\epsilon$ is small (e.g., $10^{-6}$), the second condition is practically always met, and the test hinges on whether the parameter $k$ is sufficiently large in magnitude.",
            "answer": "```python\nimport numpy as np\n\ndef _hidden_simulator_step(x0, mu, k, dt):\n    \"\"\"\n    This function represents the \"black box\" biomedical simulator.\n    It computes x(t+dt) from x(t) using one explicit Euler step.\n    The problem specifies the underlying ODE is dx/dt = mu*x - k*x**2.\n    The algorithm must treat this as an oracle and not use its internal formula\n    to compute analytical derivatives.\n    \"\"\"\n    f_val = mu * x0 - k * x0**2\n    return x0 + dt * f_val\n\ndef estimate_f(x0, mu, k, dt):\n    \"\"\"\n    Estimates f(x0, mu; k) by simulating one explicit Euler step of size dt\n    from x(0)=x0 and computing the finite difference (x(dt)-x0)/dt,\n    as required by the problem statement.\n    \"\"\"\n    x_at_dt = _hidden_simulator_step(x0, mu, k, dt)\n    f_estimate = (x_at_dt - x0) / dt\n    return f_estimate\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and produce the final output.\n    \"\"\"\n    # Test suite of parameter sets (k, h_x, h_mu, dt, epsilon)\n    test_cases = [\n        # Case 1: k=1.0, h_x=10^-4, h_mu=10^-4, dt=10^-6, epsilon=10^-6\n        (1.0, 1e-4, 1e-4, 1e-6, 1e-6),\n        # Case 2: k=0.0, h_x=10^-4, h_mu=10^-4, dt=10^-6, epsilon=10^-6\n        (0.0, 1e-4, 1e-4, 1e-6, 1e-6),\n        # Case 3: k=2.5, h_x=5x10^-5, h_mu=2x10^-4, dt=5x10^-7, epsilon=10^-6\n        (2.5, 5e-5, 2e-4, 5e-7, 1e-6),\n        # Case 4: k=10^-12, h_x=10^-4, h_mu=10^-4, dt=10^-6, epsilon=10^-6\n        (1e-12, 1e-4, 1e-4, 1e-6, 1e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        k, h_x, h_mu, dt, epsilon = case\n\n        # Estimate f_xx(0,0) using a central difference formula.\n        # This requires three calls to the f-estimator.\n        f_plus_x = estimate_f(h_x, 0.0, k, dt)\n        f_zero = estimate_f(0.0, 0.0, k, dt)\n        f_minus_x = estimate_f(-h_x, 0.0, k, dt)\n        est_f_xx = (f_plus_x - 2.0 * f_zero + f_minus_x) / (h_x**2)\n\n        # Estimate f_xmu(0,0) using a central difference formula.\n        # This requires four calls to the f-estimator.\n        f_pp = estimate_f(h_x, h_mu, k, dt)   # Point (+h_x, +h_mu)\n        f_pm = estimate_f(h_x, -h_mu, k, dt)  # Point (+h_x, -h_mu)\n        f_mp = estimate_f(-h_x, h_mu, k, dt)  # Point (-h_x, +h_mu)\n        f_mm = estimate_f(-h_x, -h_mu, k, dt) # Point (-h_x, -h_mu)\n        est_f_xmu = (f_pp - f_pm - f_mp + f_mm) / (4.0 * h_x * h_mu)\n\n        # Perform the transcritical nondegeneracy test.\n        is_nondegenerate = abs(est_f_xmu) > epsilon and abs(est_f_xx) > epsilon\n\n        results.append([est_f_xmu, est_f_xx, is_nondegenerate])\n\n    # Format the final output string exactly as specified: [[...],[...],...]\n    # Using str() on a list of lists creates the required formatting.\n    # Capitalized True/False from Python's str() is the standard representation.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}