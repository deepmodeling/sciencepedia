{
    "hands_on_practices": [
        {
            "introduction": "我们从同步现象最核心的构建模块开始：两个耦合振荡器的相互作用。许多生物系统，从发出同步闪光的萤火虫到心脏中协调搏动的起搏细胞，都可以被简化为成对的振荡单元。通过分析相位差的演化，我们可以从根本上理解它们是如何实现节律锁定的 。这个练习将通过求解描述两个振荡器相位差的阿德勒方程 (Adler equation)，帮助你掌握寻找平衡点和判断其稳定性的基本分析技能。",
            "id": "3934528",
            "problem": "考虑一对弱耦合的自持生物振子（例如，两个相互作用的昼夜节律神经元），其相位为 $\\theta_{1}(t)$ 和 $\\theta_{2}(t)$，自然角频率为 $\\omega_{1}$ 和 $\\omega_{2}$。在弱耦合条件下，通过标准的相位约化和平均化方法，相位差 $\\phi(t) \\equiv \\theta_{1}(t) - \\theta_{2}(t)$ 的演化遵循如下简化的Adler–Kuramoto型动力学方程：\n$$\n\\dot{\\phi} = \\Delta \\omega - K \\sin\\phi,\n$$\n其中 $\\Delta \\omega \\equiv \\omega_{1} - \\omega_{2}$，$K > 0$ 代表由相互作用函数和耦合强度产生的有效耦合增益。请仅使用稳态和基于平衡点邻域泰勒展开的线性稳定性定义，从第一性原理出发，推导一般稳态相位差及其稳定性（用 $\\Delta \\omega$ 和 $K$ 表示），并确定存在稳定锁相平衡的条件。然后，对于参数值 $\\Delta \\omega = 0.8$ 弧度/秒和 $K = 1.2$ 弧度/秒，计算稳定的稳态相位差 $\\phi^{\\ast}$（以弧度为单位）。根据 $\\phi^{\\ast}$ 和 $\\Delta \\omega$ 的符号，说明在锁相状态下哪个振子领先。最终的相位差以弧度表示，并将答案四舍五入到四位有效数字。最终的答案必须以弧度报告。在最终的方框答案中不要包含单位。",
            "solution": "用户提供了一个问题陈述，在给出解答之前需要对其进行验证。\n\n### 步骤1：提取已知条件\n- **模型：** 一对弱耦合的自持生物振子。\n- **变量：** 振子相位 $\\theta_{1}(t)$ 和 $\\theta_{2}(t)$。自然角频率 $\\omega_{1}$ 和 $\\omega_{2}$。\n- **相位差：** $\\phi(t) \\equiv \\theta_{1}(t) - \\theta_{2}(t)$。\n- **动力学方程：** $\\dot{\\phi} = \\Delta \\omega - K \\sin\\phi$。\n- **定义：** 频率失谐 $\\Delta \\omega \\equiv \\omega_{1} - \\omega_{2}$。有效耦合增益 $K > 0$。\n- **任务1：** 从第一性原理（泰勒展开）推导一般稳态相位差及其稳定性。\n- **任务2：** 确定存在稳定锁相平衡的条件。\n- **任务3：** 对于参数值 $\\Delta \\omega = 0.8$ 弧度/秒和 $K = 1.2$ 弧度/秒，计算稳定的稳态相位差 $\\phi^{\\ast}$。\n- **任务4：** 说明在锁相状态下哪个振子领先。\n- **输出格式：** $\\phi^{\\ast}$ 的最终答案必须以弧度为单位，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于Adler方程，这是一个用于描述相同步的典范模型，由相位约化技术应用于耦合振子得出。这是物理学、工程学和数学生物学（例如，模拟昼夜节律神经元、心脏起搏细胞）中一个标准且完善的模型。该模型具有科学合理性，是该领域的基础。\n2.  **适定性：** 该问题是适定的。它给出了一个一阶常微分方程，并要求分析其不动点的位置和稳定性，这是一个标准的分析过程。所提供的参数允许存在一个唯一的稳定解。\n3.  **客观性：** 语言是技术性的、精确的，并且没有任何主观或基于观点的陈述。\n4.  **不完整或矛盾的设置：** 该问题是自洽的。所有必需的变量、定义和控制方程都已提供。没有矛盾之处。\n5.  **不切实际或不可行：** 该模型是一种理想化，但在科学上是合理的且被广泛使用。参数值在物理上是合理的。\n6.  **不适定或结构不良：** 该问题要求进行标准的平衡点和稳定性分析，这会得到一个唯一且有意义的解。所用术语是非线性动力学领域的标准术语。\n\n### 步骤3：结论与行动\n该问题有效。这是一个标准的、适定的生物医学系统建模问题，具有科学依据且客观。现在开始求解过程。\n\n两个振子之间相位差 $\\phi(t)$ 的控制动力学方程为：\n$$\n\\dot{\\phi} = \\Delta \\omega - K \\sin\\phi\n$$\n其中 $\\Delta \\omega = \\omega_{1} - \\omega_{2}$ 是自然频率之差，$K > 0$ 是耦合增益。\n\n**稳态平衡点及其稳定性的推导**\n\n稳态或平衡态对应于锁相状态，此时相位差 $\\phi$ 随时间保持恒定。当其时间导数为零时，即 $\\dot{\\phi} = 0$，满足此条件。设 $\\phi^{\\ast}$ 表示一个稳态值。将控制方程的右侧设为零，得到：\n$$\n\\Delta \\omega - K \\sin\\phi^{\\ast} = 0\n$$\n解出 $\\sin \\phi^{\\ast}$，我们得到：\n$$\n\\sin \\phi^{\\ast} = \\frac{\\Delta \\omega}{K}\n$$\n为了使 $\\phi^{\\ast}$ 存在实数解，正弦函数的值必须在其取值范围 $[-1, 1]$ 内。这对参数施加了以下条件：\n$$\n\\left| \\frac{\\Delta \\omega}{K} \\right| \\le 1 \\quad \\text{或等价地,} \\quad |\\Delta \\omega| \\le K\n$$\n这是实现锁相的条件。当满足此条件时，在任何长度为 $2\\pi$ 的区间内（例如 $[-\\pi, \\pi)$），存在两个不同的平衡解族。它们是：\n$$\n\\phi^{\\ast}_1 = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)\n$$\n$$\n\\phi^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)\n$$\n为了确定这些平衡点的稳定性，我们进行线性稳定性分析。将微分方程的右侧表示为函数 $f(\\phi) = \\Delta \\omega - K \\sin\\phi$。平衡点 $\\phi^{\\ast}$ 的稳定性由导数 $f'(\\phi) = \\frac{df}{d\\phi}$ 在 $\\phi^{\\ast}$ 处的值的符号决定。当 $f'(\\phi^{\\ast})  0$ 时，平衡点是局部稳定的，因为小的微扰会衰减。当 $f'(\\phi^{\\ast}) > 0$ 时，平衡点是不稳定的，因为微扰会增长。\n\n首先，我们计算 $f(\\phi)$ 的导数：\n$$\nf'(\\phi) = \\frac{d}{d\\phi} (\\Delta \\omega - K \\sin\\phi) = -K \\cos\\phi\n$$\n接下来，我们在平衡点处计算该导数的值。为此，我们需要 $\\cos \\phi^{\\ast}$ 的值。使用三角恒等式 $\\cos^2 \\phi^{\\ast} + \\sin^2 \\phi^{\\ast} = 1$ 和平衡条件 $\\sin \\phi^{\\ast} = \\frac{\\Delta \\omega}{K}$，我们发现：\n$$\n\\cos^2 \\phi^{\\ast} = 1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2 \\implies \\cos \\phi^{\\ast} = \\pm \\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\n这在 $|\\Delta \\omega|  K$ 时有效。\n\n对于第一个平衡点，$\\phi^{\\ast}_1 = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$：\n反正弦函数主值的范围是 $[-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$。对于此范围内的任何角度，其对应的余弦值都是非负的。因此，我们必须取正根：\n$$\n\\cos \\phi^{\\ast}_1 = +\\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\n其稳定性由以下表达式的符号给出：\n$$\nf'(\\phi^{\\ast}_1) = -K \\cos \\phi^{\\ast}_1 = -K \\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\n因为 $K > 0$ 且平方根项非负，我们有 $f'(\\phi^{\\ast}_1) \\le 0$。如果 $|\\Delta \\omega|  K$，则 $f'(\\phi^{\\ast}_1)  0$，这表示平衡点 $\\phi^{\\ast}_1$ 是**稳定的**。这就是稳定的锁相状态。\n\n对于第二个平衡点，$\\phi^{\\ast}_2 = \\pi - \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$：\n设 $\\alpha = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$。那么 $\\phi^{\\ast}_2 = \\pi - \\alpha$。使用恒等式 $\\cos(\\pi - \\alpha) = -\\cos(\\alpha)$，并知道 $\\cos(\\alpha) \\ge 0$，我们发现 $\\cos(\\phi^{\\ast}_2) \\le 0$。因此，我们必须取负根：\n$$\n\\cos \\phi^{\\ast}_2 = -\\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\n其稳定性由以下表达式的符号给出：\n$$\nf'(\\phi^{\\ast}_2) = -K \\cos \\phi^{\\ast}_2 = -K \\left(-\\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\\right) = +K \\sqrt{1 - \\left(\\frac{\\Delta \\omega}{K}\\right)^2}\n$$\n因为 $K > 0$，我们有 $f'(\\phi^{\\ast}_2) \\ge 0$。如果 $|\\Delta \\omega|  K$，则 $f'(\\phi^{\\ast}_2) > 0$，这表示平衡点 $\\phi^{\\ast}_2$ 是**不稳定的**。\n\n因此，存在稳定锁相平衡的条件是 $|\\Delta \\omega| \\le K$。稳定的稳态相位差是 $\\phi^{\\ast} = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right)$。\n\n**针对特定参数的计算**\n\n我们给定的参数值为 $\\Delta \\omega = 0.8$ 弧度/秒和 $K = 1.2$ 弧度/秒。\n我们首先验证锁相条件：\n$$\n|\\Delta \\omega| = |0.8| = 0.8\n$$\n$$\nK = 1.2\n$$\n由于 $0.8 \\le 1.2$，满足条件 $|\\Delta \\omega| \\le K$，因此存在一个稳定的锁相平衡。\n\n稳定的稳态相位差 $\\phi^{\\ast}$ 使用为稳定平衡点推导的公式计算：\n$$\n\\phi^{\\ast} = \\arcsin\\left(\\frac{\\Delta \\omega}{K}\\right) = \\arcsin\\left(\\frac{0.8}{1.2}\\right) = \\arcsin\\left(\\frac{2}{3}\\right)\n$$\n计算数值（以弧度为单位）并四舍五入到四位有效数字：\n$$\n\\phi^{\\ast} \\approx \\arcsin(0.6666...) \\approx 0.729727656... \\text{ 弧度}\n$$\n$$\n\\phi^{\\ast} \\approx 0.7297 \\text{ 弧度}\n$$\n\n**判断哪个振子领先**\n\n相位差定义为 $\\phi(t) = \\theta_{1}(t) - \\theta_{2}(t)$，频率差为 $\\Delta \\omega = \\omega_{1} - \\omega_{2} = 0.8 > 0$。这意味着振子1的自然频率高于振子2（$\\omega_1 > \\omega_2$）。在锁相状态下，稳定的相位差为 $\\phi^{\\ast} \\approx 0.7297$ 弧度。由于 $\\phi^{\\ast}$ 是正数，这意味着 $\\theta_{1} - \\theta_{2} > 0$，或 $\\theta_{1} > \\theta_{2}$。按照惯例，这意味着振子1领先于振子2。频率较快的振子领先于频率较慢的振子，而相位差 $\\phi^{\\ast}$ 量化了这种领先程度。",
            "answer": "$$\n\\boxed{0.7297}\n$$"
        },
        {
            "introduction": "在理解了两个振荡器的相互作用之后，我们自然会问：当成千上万个振荡器（例如大脑中一个神经元集群）相互作用时，会发生什么？藏本模型 (Kuramoto model) 为我们提供了一个优雅的平均场框架来研究这种集体行为。这个练习将引导你推导同步相变的临界指数 ，这是一个源于统计物理学的强大概念。通过这个过程，你将深入理解宏观有序（同步）是如何从微观相互作用中涌现的，以及系统内异质性（即固有频率的分布）如何影响这一集体现象。",
            "id": "3934483",
            "problem": "一个由 $N$ 个弱耦合生物相位振子（例如，视交叉上核神经元或心肌起搏细胞）组成的种群，在连续极限下由平均场 Kuramoto 方程建模：\n$$\n\\frac{d\\theta_{i}}{dt} \\;=\\; \\omega_{i} \\;+\\; \\frac{K}{N}\\sum_{j=1}^{N}\\sin\\!\\big(\\theta_{j}-\\theta_{i}\\big),\n$$\n其中 $\\theta_{i}$ 是振子 $i$ 的相位，$\\omega_{i}$ 是其内禀频率，独立地从一个对称的单峰概率密度 $g(\\omega)$ 中抽取，$K$ 是全局耦合强度。定义宏观序参量 $r$ 和平均相位 $\\psi$ 为：\n$$\nre^{i\\psi} \\;=\\; \\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{j}}.\n$$\n在刚好超过宏观相位相干起始点的稳态部分同步状态下，有限比例的振子变为频率锁定，而其余的则发生漂移。仅从 Kuramoto 模型、$r$ 的定义以及关于锁定和漂移子种群的第一性原理连续统推理出发，推导当耦合强度 $K$ 超过临界耦合强度 $K_{c}$ 时序参量 $r$ 的主导标度行为。考虑以下两种生物学上合理的频率分布：\n- 洛伦兹（柯西）分布 $g_{L}(\\omega)=\\dfrac{\\Delta}{\\pi\\left(\\Delta^{2}+\\omega^{2}\\right)}$，其半高宽为 $\\Delta0$。\n- 具有紧支集的对称三角分布，$g_{T}(\\omega)=\\dfrac{1}{\\gamma}\\left(1-\\dfrac{|\\omega|}{\\gamma}\\right)$ 当 $|\\omega|\\le\\gamma$ 时成立，而当 $|\\omega|\\gamma$ 时 $g_{T}(\\omega)=0$，其中 $\\gamma0$。\n\n设渐近标度行为定义为当 $K\\downarrow K_{c}^{+}$ 时，$r \\sim C \\left(K-K_{c}\\right)^{\\beta}$，其中 $C$ 是一个正常数，其值可能取决于 $g(\\omega)$ 的具体细节，但不影响指数。通过模型的显式推导，确定每种情况下的临界指数 $\\beta$。将您的最终答案表示为一个行矩阵 $(\\beta_{L}\\;\\\\;\\beta_{T})$，其中 $\\beta_{L}$ 对应于 $g_{L}$，$\\beta_{T}$ 对应于 $g_{T}$。无需四舍五入；指数是无量纲的。",
            "solution": "问题要求解出描述 Kuramoto 模型中序参量 $r$ 在临界耦合 $K_c$ 附近行为的临界指数 $\\beta$，其中 $r \\sim C(K-K_c)^\\beta$。必须对两种不同的内禀频率分布 $g(\\omega)$ 进行推导。\n\n出发点是 $N$ 个振子的 Kuramoto 模型：\n$$\n\\frac{d\\theta_{i}}{dt} = \\omega_{i} + \\frac{K}{N}\\sum_{j=1}^{N}\\sin(\\theta_{j}-\\theta_{i})\n$$\n在连续极限（$N\\to\\infty$）下，宏观序参量 $r$ 和平均相位 $\\psi$ 定义为：\n$$\nre^{i\\psi} = \\lim_{N\\to\\infty}\\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{j}}\n$$\n我们可以用序参量重写耦合项：\n$$\n\\frac{K}{N}\\sum_{j=1}^{N}\\sin(\\theta_{j}-\\theta_{i}) = \\frac{K}{N}\\text{Im}\\left[\\sum_{j=1}^{N}e^{i(\\theta_{j}-\\theta_{i})}\\right] = \\text{Im}\\left[Ke^{-i\\theta_{i}}\\left(\\frac{1}{N}\\sum_{j=1}^{N}e^{i\\theta_{j}}\\right)\\right]\n$$\n在连续极限下，这变为 $\\text{Im}[K e^{-i\\theta_i} r e^{i\\psi}] = Kr\\sin(\\psi-\\theta_i)$。因此，来自连续体的单个振子的运动方程为：\n$$\n\\frac{d\\theta}{dt} = \\omega + Kr\\sin(\\psi-\\theta)\n$$\n在一个稳态同步状态下，平均相位可能以一个恒定的集体频率旋转，即 $\\psi(t) = \\Omega t$。通过转换到以此频率旋转的坐标系，并注意到对于以 $\\omega=0$ 为中心的对称分布 $g(\\omega)$，我们有 $\\Omega=0$，并且可以不失一般性地设 $\\psi=0$。序参量 $r$ 变为一个实数且不随时间变化的量。具有内禀频率 $\\omega$ 的振子的动力学由以下方程决定：\n$$\n\\frac{d\\theta}{dt} = \\omega - Kr\\sin(\\theta)\n$$\n在这个稳态下，振子分为两组。\n1. **锁相振子**：这些振子具有恒定的相位，$\\frac{d\\theta}{dt}=0$。这要求 $\\omega = Kr\\sin(\\theta)$，这仅在 $|\\omega| \\le Kr$ 时才可能。稳定的锁相相位为 $\\theta_{\\text{locked}} = \\arcsin(\\frac{\\omega}{Kr})$，选择此相位使得 $\\cos(\\theta_{\\text{locked}})0$。\n2. **漂移振子**：这些振子的 $|\\omega|Kr$。它们的相位 $\\theta(t)$ 持续增加或减少。\n\n由于我们设定 $\\psi=0$，序参量 $r$ 是 $\\cos(\\theta)$ 的种群平均值。\n$$\nr = \\langle \\cos(\\theta) \\rangle = \\int_{-\\infty}^{\\infty} \\langle \\cos(\\theta) \\rangle_{\\omega} g(\\omega) d\\omega\n$$\n其中 $\\langle \\cos(\\theta) \\rangle_{\\omega}$ 是频率为 $\\omega$ 的振子的时间平均值。\n对于锁相振子，$\\langle \\cos(\\theta) \\rangle_{\\omega} = \\cos(\\theta_{\\text{locked}}) = \\sqrt{1-\\sin^2(\\theta_{\\text{locked}})} = \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2}$。\n对于漂移振子，其相位在 $[0, 2\\pi)$ 上持续循环，它们对 $e^{i\\theta}$ 的时间平均的贡献为零。因此，当 $|\\omega|Kr$ 时，$\\langle \\cos(\\theta) \\rangle_{\\omega}=0$。\n这导致了序参量 $r$ 的自洽方程：\n$$\nr = \\int_{-Kr}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} g(\\omega) d\\omega\n$$\n当耦合强度 $K$ 超过临界值 $K_c$ 时，同步开始（$r0$）。我们分析此方程在 $r \\to 0^{+}$ 时的行为以找到标度关系。该行为取决于 $g(\\omega)$ 在 $\\omega=0$ 附近的性质。\n\n**情况 1：洛伦兹分布**\n\n分布为 $g_{L}(\\omega)=\\dfrac{\\Delta}{\\pi\\left(\\Delta^{2}+\\omega^{2}\\right)}$。该函数在 $\\omega=0$ 处是解析的（无穷次可微）。我们可以使用在 $\\omega=0$ 附近的泰勒级数展开：\n$$\ng_{L}(\\omega) = \\frac{\\Delta}{\\pi\\Delta^2}\\left(1+\\frac{\\omega^2}{\\Delta^2}\\right)^{-1} = \\frac{1}{\\pi\\Delta}\\left(1 - \\frac{\\omega^2}{\\Delta^2} + O(\\omega^4)\\right)\n$$\n与一般形式 $g(\\omega) = g(0) + \\frac{g''(0)}{2}\\omega^2 + \\dots$ 比较，我们确定：\n$$\ng_{L}(0) = \\frac{1}{\\pi\\Delta}, \\quad g_{L}''(0) = -\\frac{2}{\\pi\\Delta^3}\n$$\n由于 $g_L''(0)  0$，该分布在 $\\omega=0$ 处是单峰的。我们将展开式代入自洽方程。让我们进行变量替换 $\\omega = Krx$，因此 $d\\omega = Kr\\,dx$。\n$$\nr = \\int_{-1}^{1} \\sqrt{1-x^2} \\, g_{L}(Krx) \\, (Kr\\,dx)\n$$\n$$\nr = Kr \\int_{-1}^{1} \\sqrt{1-x^2} \\left[ g_L(0) + \\frac{g_L''(0)}{2} (Krx)^2 + O(r^4) \\right] dx\n$$\n被积函数是 $x$ 的偶函数。我们使用标准定积分：\n$\\int_{-1}^{1} \\sqrt{1-x^2} dx = \\frac{\\pi}{2}$ （单位半圆的面积）。\n$\\int_{-1}^{1} x^2\\sqrt{1-x^2} dx = \\frac{\\pi}{8}$。\n$$\nr = Kr \\left( g_L(0) \\frac{\\pi}{2} + \\frac{g_L''(0)}{2} K^2 r^2 \\frac{\\pi}{8} + \\dots \\right)\n$$\n对于非平凡解 $r0$，我们可以两边同除以 $r$：\n$$\n1 = K \\frac{\\pi g_L(0)}{2} + K^3 r^2 \\frac{\\pi g_L''(0)}{16} + O(r^4)\n$$\n临界耦合 $K_{c,L}$ 在极限 $r \\to 0$ 下求得：$1 = K_{c,L} \\frac{\\pi g_L(0)}{2}$，这给出 $K_{c,L} = \\frac{2}{\\pi g_L(0)} = \\frac{2}{\\pi(1/\\pi\\Delta)} = 2\\Delta$。\n现在令 $K = K_{c,L} + \\delta K$，其中 $\\delta K  0$ 是一个小数：\n$$\n1 = \\frac{K_{c,L}+\\delta K}{K_{c,L}} + K^3 r^2 \\frac{\\pi g_L''(0)}{16} \\approx 1 + \\frac{\\delta K}{K_{c,L}} + K_{c,L}^3 r^2 \\frac{\\pi g_L''(0)}{16}\n$$\n$$\n0 = \\frac{\\delta K}{K_{c,L}} + K_{c,L}^3 r^2 \\frac{\\pi g_L''(0)}{16}\n$$\n$$\nr^2 = -\\frac{16 \\, \\delta K}{K_{c,L}^4 \\, \\pi \\, g_L''(0)}\n$$\n由于 $g_L''(0)  0$ 且 $\\delta K = K-K_{c,L} > 0$，所以 $r^2$ 是正的。标度关系为 $r^2 \\propto (K-K_{c,L})$。因此，序参量的标度行为是：\n$$\nr \\propto (K-K_{c,L})^{1/2}\n$$\n洛伦兹情况下的临界指数为 $\\beta_L = \\frac{1}{2}$。\n\n**情况 2：对称三角分布**\n\n分布为 $g_{T}(\\omega)=\\dfrac{1}{\\gamma}\\left(1-\\dfrac{|\\omega|}{\\gamma}\\right)$，当 $|\\omega|\\le\\gamma$ 时。由于绝对值项 $|\\omega|$ 的存在，该函数在 $\\omega=0$ 处不解析。它的一阶导数在 $\\omega=0$ 处不连续，其二阶导数在标准意义下未定义。因此上面使用的泰勒展开是无效的。我们必须直接在自洽积分中使用小 $\\omega$ 下的 $g_T(\\omega)$ 的形式。对于小的 $r$，积分区间 $[-Kr, Kr]$ 很小，因此我们可以使用 $g_T(\\omega) = \\frac{1}{\\gamma} - \\frac{|\\omega|}{\\gamma^2}$。\n$$\nr = \\int_{-Kr}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} \\left(\\frac{1}{\\gamma} - \\frac{|\\omega|}{\\gamma^2}\\right) d\\omega\n$$\n被积函数是 $\\omega$ 的偶函数，所以我们可以从 $0$ 积分到 $Kr$ 并乘以 $2$：\n$$\nr = 2 \\int_{0}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} \\left(\\frac{1}{\\gamma} - \\frac{\\omega}{\\gamma^2}\\right) d\\omega\n$$\n$$\nr = \\frac{2}{\\gamma} \\int_{0}^{Kr} \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} d\\omega - \\frac{2}{\\gamma^2} \\int_{0}^{Kr} \\omega \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} d\\omega\n$$\n我们计算这两个积分。\n第一个积分是半径为 $Kr$ 的四分之一圆的面积：$\\int_{0}^{Kr} \\sqrt{1 - (\\omega/Kr)^2} d\\omega = \\frac{\\pi (Kr)^2}{4} \\frac{1}{Kr} = \\frac{\\pi Kr}{4}$。\n对于第二个积分，令 $u = 1 - (\\omega/Kr)^2$，则 $du = -2\\omega/(Kr)^2 d\\omega$。\n$$\n\\int_0^{Kr} \\omega \\sqrt{1 - \\left(\\frac{\\omega}{Kr}\\right)^2} d\\omega = \\int_1^0 \\sqrt{u} \\left(-\\frac{(Kr)^2}{2} du\\right) = \\frac{(Kr)^2}{2} \\int_0^1 u^{1/2} du = \\frac{(Kr)^2}{2} \\left[\\frac{2}{3}u^{3/2}\\right]_0^1 = \\frac{(Kr)^2}{3}\n$$\n将这些结果代回关于 $r$ 的方程：\n$$\nr = \\frac{2}{\\gamma} \\left( \\frac{\\pi K r}{4} \\right) - \\frac{2}{\\gamma^2} \\left( \\frac{K^2 r^2}{3} \\right) = \\frac{\\pi K r}{2\\gamma} - \\frac{2 K^2 r^2}{3\\gamma^2}\n$$\n对于 $r>0$，我们两边同除以 $r$：\n$$\n1 = \\frac{\\pi K}{2\\gamma} - \\frac{2 K^2 r}{3\\gamma^2}\n$$\n临界耦合 $K_{c,T}$ 在 $r \\to 0$ 时求得，给出 $1 = \\frac{\\pi K_{c,T}}{2\\gamma}$，所以 $K_{c,T} = \\frac{2\\gamma}{\\pi}$。\n令 $K=K_{c,T}+\\delta K$ 并将 $K_{c,T}$ 代回方程：\n$$\n1 = \\frac{K_{c,T}+\\delta K}{K_{c,T}} - \\frac{2 (K_{c,T}+\\delta K)^2 r}{3\\gamma^2} \\approx 1 + \\frac{\\delta K}{K_{c,T}} - \\frac{2 K_{c,T}^2 r}{3\\gamma^2}\n$$\n$$\n0 = \\frac{\\delta K}{K_{c,T}} - \\frac{2 K_{c,T}^2 r}{3\\gamma^2}\n$$\n解出 $r$：\n$$\nr = \\frac{3\\gamma^2}{2 K_{c,T}^3} \\delta K = \\left(\\frac{3\\gamma^2}{2 \\left(\\frac{2\\gamma}{\\pi}\\right)^3}\\right) (K-K_{c,T}) = \\frac{3\\pi^3}{16\\gamma}(K-K_{c,T})\n$$\n标度关系是线性的，$r \\propto (K-K_{c,T})$。\n三角分布情况下的临界指数是 $\\beta_T = 1$。\n\n这两个指数是 $\\beta_L = 1/2$ 和 $\\beta_T = 1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论模型最终需要与真实的生物过程联系起来，而昼夜节律的“时差”恢复就是一个绝佳的例子。当我们的内部生物钟面对外部环境（如光照周期）的突然变化时，它需要时间来重新同步。这个实践练习将理论付诸于计算，要求你通过编程来模拟一个振荡器在经历相位突变（模拟跨时区飞行）后的重新夹带过程 。你将学习如何将模型的抽象参数（如耦合强度和固有周期）与具体的、可测量的生物学结果（如恢复所需的天数）联系起来，从而真正体会到耦合振荡器模型在解决实际生物医学问题中的应用价值。",
            "id": "3934554",
            "problem": "考虑一个在弱耦合极限下通过相位约简建模的单一昼夜节律振荡器。该生物体的内部振荡器具有内禀角频率 $\\omega$（单位为 $\\mathrm{rad}/\\mathrm{h}$），并受到具有角频率 $\\Omega$（单位为 $\\mathrm{rad}/\\mathrm{h}$）的周期性光暗循环（zeitgeber，授时因子）的驱动。在相位响应的正弦一次谐波近似下，受驱动的内部振荡器的相位动力学由以下标量相位方程给出\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\omega \\;+\\; K \\,\\sin\\!\\big(\\phi_Z(t) \\;-\\; \\theta(t)\\big),\n$$\n其中 $\\theta(t)$ 是内部相位，$\\phi_Z(t)$ 是授时因子相位，$K$（单位为 $\\mathrm{rad}/\\mathrm{h}$）是耦合强度。假设在 $t  0$ 时，授时因子相位为 $\\phi_Z(t) = \\Omega t$，而在 $t = 0$ 时发生突然的时区转换，使得在 $t \\ge 0$ 时，授时因子相位变为 $\\phi_Z(t) = \\Omega t + \\Delta$，其中 $\\Delta$（单位为 $\\mathrm{rad}$）是对应于指定小时数偏移的阶跃变化。阶跃变化 $\\Delta$ 通过 $\\Delta = \\Omega \\, s$ 与小时数偏移 $s$（单位为 $\\mathrm{h}$）相关。\n\n定义相位差 $\\psi(t) = \\phi_Z(t) - \\theta(t)$，以 $\\mathrm{rad}$ 表示。转换后的授时同步稳态相位差是一个常数 $\\psi^\\star$，它在 $\\psi$ 为常数时满足模型的动力学。到达授时同步的瞬态恢复过程按如下方式量化：从 $t=0^{-}$ 时的转换前授时同步状态开始，恢复时间 $T_{\\text{rec}}$（单位为 $\\mathrm{h}$）是满足 $|\\operatorname{wrap}(\\psi(t) - \\psi^\\star)| \\le \\varepsilon$ 的最小 $t \\ge 0$，并且此条件在此后至少连续保持 $T_{\\text{hold}}$ 小时。函数 $\\operatorname{wrap}(\\cdot)$ 将任意角度映射到主分支 $(-\\pi,\\pi]$，即 $\\operatorname{wrap}(x) = \\operatorname{mod}(x+\\pi, 2\\pi) - \\pi$。文中角度单位均为弧度，时间单位为小时。\n\n你的任务是：\n- 基于转换前的授时同步状态和阶跃变化 $\\Delta$，建立 $t=0^{+}$ 时的初始条件。\n- 使用给定模型所隐含的 $t \\ge 0$ 时的相位差动力学，将 $\\psi(t)$ 随时间向前演化。\n- 确定与转换后授时同步状态对应的 $\\psi^\\star$，并根据上述准则评估恢复时间 $T_{\\text{rec}}$。\n- 如果系统在给定参数下无法实现授时同步，或者在指定的最大模拟时间 $T_{\\max}$ 内无法确定 $T_{\\text{rec}}$，则恢复时间返回一个哨兵值 $-1.00$（单位为小时），并返回一个布尔值，指示在可用的模拟窗口内未实现恢复。\n\n以小时表示恢复时间，四舍五入到两位小数。所有角度计算均使用弧度。\n\n测试套件和参数集：\n对每个测试用例，使用以下参数。所有角度量均以弧度为单位，时间以小时为单位。\n\n- 案例 $1$（典型强耦合，大相位提前）：\n    - $\\Omega = \\dfrac{2\\pi}{24}$，\n    - $\\omega = \\dfrac{2\\pi}{24.3}$，\n    - $K = 0.07$，\n    - 小时偏移 $s = +8$，\n    - 容差 $\\varepsilon = 0.05$，\n    - 保持时间 $T_{\\text{hold}} = 48$，\n    - 最大模拟时间 $T_{\\max} = 300$。\n\n- 案例 $2$（授时同步阈值处的临界耦合，大相位延迟）：\n    - $\\Omega = \\dfrac{2\\pi}{24}$，\n    - $\\omega = \\dfrac{2\\pi}{23.5}$，\n    - $K = |\\Omega - \\omega|$，\n    - 小时偏移 $s = -6$，\n    - 容差 $\\varepsilon = 0.05$，\n    - 保持时间 $T_{\\text{hold}} = 72$，\n    - 最大模拟时间 $T_{\\max} = 600$。\n\n- 案例 $3$（近阈值弱耦合，小相位提前）：\n    - $\\Omega = \\dfrac{2\\pi}{24}$，\n    - $\\omega = \\dfrac{2\\pi}{24.6}$，\n    - $K = |\\Omega - \\omega| + 0.001$，\n    - 小时偏移 $s = +1$，\n    - 容差 $\\varepsilon = 0.05$，\n    - 保持时间 $T_{\\text{hold}} = 48$，\n    - 最大模拟时间 $T_{\\max} = 500$。\n\n程序要求：\n- 为每个测试用例独立地实现模型和恢复时间估计。\n- 使用数值积分器来演化在 $t \\in [0, T_{\\max}]$ 区间内的相位差 $\\psi(t)$。\n- $\\psi(0^{+})$ 的初始条件必须与 $t=0^{-}$ 时的授时同步前状态以及 $t=0$ 时的瞬时跳变 $\\Delta = \\Omega s$ 相一致。\n- 如果模型的参数不允许授时同步，或者在 $T_{\\max}$ 内恢复条件未能满足至少 $T_{\\text{hold}}$ 小时，则输出恢复时间为 $-1.00$ 并标记为未实现恢复。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身也是一个包含两个元素的列表：恢复时间（浮点数，单位为小时，四舍五入到两位小数）和一个布尔值，指示是否在 $T_{\\max}$ 内实现了恢复。例如，输出必须如下所示：\n$$\n[\\,[T_1,\\;B_1],\\,[T_2,\\;B_2],\\,[T_3,\\;B_3]\\,],\n$$\n其中 $T_i$ 是恢复时间（单位为小时，四舍五入到两位小数），$B_i$ 是一个布尔值。",
            "solution": "该问题要求计算一个经历了类似于时差反应的突然相位偏移的昼夜节律振荡器模型的恢复时间。分析过程分为三个主要步骤：首先，推导相位差的控制方程；其次，确定稳定的授时同步状态和偏移后的初始条件；第三，对该方程进行数值求解并应用指定的恢复准则。\n\n内部振荡器相位 $\\theta(t)$ 的动力学由 Adler 方程给出：\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\omega \\;+\\; K \\,\\sin\\!\\big(\\phi_Z(t) \\;-\\; \\theta(t)\\big)\n$$\n其中 $\\omega$ 是内禀角频率，$\\Omega$ 是授时因子的角频率，$K$ 是耦合强度，$\\phi_Z(t)$ 是授时因子相位。\n\n**1. 相位差的动力学**\n\n我们定义相位差为 $\\psi(t) = \\phi_Z(t) - \\theta(t)$。为了找到其控制方程，我们计算它的时间导数：\n$$\n\\frac{d\\psi}{dt} = \\frac{d\\phi_Z}{dt} - \\frac{d\\theta}{dt}\n$$\n对于 $t \\ge 0$，授时因子相位为 $\\phi_Z(t) = \\Omega t + \\Delta$，因此其导数为 $\\frac{d\\phi_Z}{dt} = \\Omega$。将给定的 $\\frac{d\\theta}{dt}$ 方程和 $\\psi(t)$ 的定义代入，我们得到：\n$$\n\\frac{d\\psi}{dt} = \\Omega - \\left( \\omega + K \\sin(\\psi(t)) \\right)\n$$\n令 $\\Delta\\omega = \\Omega - \\omega$ 为频率失谐，则对于 $t \\ge 0$，相位差的动力学由以下自治常微分方程 (ODE) 描述：\n$$\n\\frac{d\\psi}{dt} = \\Delta\\omega - K \\sin(\\psi)\n$$\n\n**2. 授时同步和稳态分析**\n\n当内部振荡器与外部授时因子同步时，便发生授时同步，此时相位差为常数，即 $\\psi(t) = \\psi^\\star$。要实现这一点，$\\frac{d\\psi}{dt}$ 必须为零。\n$$\n0 = \\Delta\\omega - K \\sin(\\psi^\\star) \\implies \\sin(\\psi^\\star) = \\frac{\\Delta\\omega}{K}\n$$\n$\\psi^\\star$ 的实数解仅在 $|\\frac{\\Delta\\omega}{K}| \\le 1$ 时存在，这是授时同步的必要条件。如果 $K  |\\Delta\\omega|$，振荡器无法锁定到授时因子的频率，其相位将持续漂移（相位滑动）。\n\n假设授时同步是可能的且 $K0$，则通常有两个 $\\psi^\\star$ 的解。为了找到稳定的解，我们分析不动点的稳定性。令 $f(\\psi) = \\Delta\\omega - K \\sin(\\psi)$。如果 $f'(\\psi^\\star)  0$，则不动点 $\\psi^\\star$ 是稳定的。其导数为 $f'(\\psi) = -K \\cos(\\psi)$。为保证稳定性，我们需要 $-K \\cos(\\psi^\\star)  0$，对于 $K0$，这简化为 $\\cos(\\psi^\\star)  0$。此条件在第一和第四象限的角度上得到满足，即 $\\psi^\\star \\in (-\\pi/2, \\pi/2)$。\n\narcsin 函数的主值会给出一个在 $[-\\pi/2, \\pi/2]$ 范围内的结果，这满足稳定性条件。因此，唯一的稳定授时同步相位差是：\n$$\n\\psi^\\star = \\arcsin\\left(\\frac{\\Omega - \\omega}{K}\\right)\n$$\n\n**3. 恢复动力学的初始条件**\n\n假设系统在 $t  0$ 时处于稳定的授时同步状态。控制动力学是相同的，因此在 $t=0^-$ 时的转换前相位差为 $\\psi(0^-) = \\psi^\\star$。根据定义，$\\psi(0^-) = \\phi_Z(0^-) - \\theta(0^-)$。由于当 $t0$ 时 $\\phi_Z(t) = \\Omega t$，我们有 $\\phi_Z(0^-) = 0$。因此，$\\psi^\\star = 0 - \\theta(0^-)$，这意味着 $\\theta(0^-) = -\\psi^\\star$。\n\n内部相位 $\\theta(t)$ 是一个状态变量，不能瞬时改变。因此，$\\theta(0^+) = \\theta(0^-) = -\\psi^\\star$。在 $t=0$ 时，授时因子相位经历一个阶跃变化 $\\Delta = \\Omega s$，所以 $\\phi_Z(0^+) = \\Omega(0) + \\Delta = \\Delta$。在 $t=0^+$ 时，转换后动力学的初始相位差为：\n$$\n\\psi(0^+) = \\phi_Z(0^+) - \\theta(0^+) = \\Delta - (-\\psi^\\star) = \\Delta + \\psi^\\star\n$$\n代入 $\\Delta$ 和 $\\psi^\\star$ 的表达式，我们用于数值积分的初始条件是：\n$$\n\\psi_0 = \\psi(0) = \\Omega s + \\arcsin\\left(\\frac{\\Omega - \\omega}{K}\\right)\n$$\n\n**4. 数值解和恢复时间评估**\n\n问题现在简化为求解以下初值问题：\n$$\n\\frac{d\\psi}{dt} = \\Delta\\omega - K \\sin(\\psi), \\quad \\psi(0) = \\psi_0\n$$\n从 $t=0$ 到 $t=T_{\\max}$。我们使用一个数值 ODE 求解器，例如 SciPy 中的 `scipy.integrate.solve_ivp`，来获得轨迹 $\\psi(t)$。\n\n恢复时间 $T_{\\text{rec}}$ 是误差 $|\\operatorname{wrap}(\\psi(t) - \\psi^\\star)|$ 降至容差 $\\varepsilon$ 以下并在此后连续保持 $T_{\\text{hold}}$ 时长的最小时间 $t \\ge 0$。函数 $\\operatorname{wrap}(x)$ 将角度 $x$ 映射到区间 $(-\\pi, \\pi]$。\n\n寻找 $T_{\\text{rec}}$ 的算法如下：\n1.  对于给定的参数集，首先检查授时同步条件 $K \\ge |\\Omega - \\omega|$。如果不满足，则恢复是不可能的，我们返回 $T_{\\text{rec}} = -1.00$。\n2.  计算稳定状态 $\\psi^\\star$ 和初始条件 $\\psi_0$。\n3.  在区间 $[0, T_{\\max}]$ 上对 $\\psi(t)$ 的 ODE 进行数值积分。\n4.  在此区间上创建一个细粒度时间网格。在网格的每个点上，评估误差 $|\\operatorname{wrap}(\\psi(t) - \\psi^\\star)|$ 并确定其是否在容差 $\\varepsilon$ 内。\n5.  在此网格中搜索首次满足容差条件的时刻 $t_i$。\n6.  验证在随后的区间 $[t_i, t_i + T_{\\text{hold}}]$ 内的所有时间点上条件是否都成立。\n7.  如果保持条件得到满足，则 $T_{\\text{rec}} = t_i$。\n8.  如果不满足，则从违反容差的点继续搜索，寻找下一个进入容差带的时刻。\n9.  如果在模拟窗口 $[0, T_{\\max}]$ 内没有找到这样的时间，则表示未实现恢复，我们返回 $T_{\\text{rec}} = -1.00$。\n\n案例2是一个特殊的临界情况，其中 $K = |\\Omega - \\omega|$，这使系统处于鞍结分岔点。接近稳态的过程是代数级慢（$1/t$ 标度），而非指数级慢。因此可以预见，系统将无法在指定的 $T_{\\max}$ 内满足恢复准则。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the recovery time of a circadian oscillator model after a phase shift.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (typical strong coupling, large advance)\n        {\n            \"Omega\": 2 * np.pi / 24,\n            \"omega\": 2 * np.pi / 24.3,\n            \"K\": 0.07,\n            \"s\": 8,\n            \"epsilon\": 0.05,\n            \"T_hold\": 48,\n            \"T_max\": 300,\n        },\n        # Case 2 (borderline coupling at the entrainment threshold, large delay)\n        {\n            \"Omega\": 2 * np.pi / 24,\n            \"omega\": 2 * np.pi / 23.5,\n            \"K\": abs(2 * np.pi / 24 - 2 * np.pi / 23.5),\n            \"s\": -6,\n            \"epsilon\": 0.05,\n            \"T_hold\": 72,\n            \"T_max\": 600,\n        },\n        # Case 3 (near-threshold weak coupling, small advance)\n        {\n            \"Omega\": 2 * np.pi / 24,\n            \"omega\": 2 * np.pi / 24.6,\n            \"K\": abs(2 * np.pi / 24 - 2 * np.pi / 24.6) + 0.001,\n            \"s\": 1,\n            \"epsilon\": 0.05,\n            \"T_hold\": 48,\n            \"T_max\": 500,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        T_rec, recovered = calculate_recovery_time(**params)\n        results.append([round(T_rec, 2), recovered])\n\n    # Format the output exactly as required\n    print(str(results).replace(\" \", \"\"))\n\ndef wrap_angle(x):\n    \"\"\"Wraps an angle to the principal branch (-pi, pi].\"\"\"\n    return (x + np.pi) % (2 * np.pi) - np.pi\n\ndef calculate_recovery_time(Omega, omega, K, s, epsilon, T_hold, T_max):\n    \"\"\"\n    Solves the model and calculates the recovery time for a single test case.\n    \"\"\"\n    delta_omega = Omega - omega\n\n    # Step 1: Check for entrainment possibility\n    if K  abs(delta_omega):\n        return -1.0, False\n\n    # Step 2: Calculate steady state and initial condition\n    psi_star = np.arcsin(delta_omega / K)\n    delta_phase = Omega * s\n    psi_0 = delta_phase + psi_star\n\n    # Step 3: Define and integrate the ODE\n    def phase_model(t, y):\n        return delta_omega - K * np.sin(y)\n\n    sol = solve_ivp(\n        phase_model,\n        (0, T_max),\n        [psi_0],\n        dense_output=True,\n        method='RK45'\n    )\n\n    # Step 4: Analyze solution to find recovery time\n    dt = 0.1  # Time step for checking the condition\n    t_eval = np.arange(0, T_max, dt)\n    psi_t = sol.sol(t_eval)[0]\n\n    error = np.abs(wrap_angle(psi_t - psi_star))\n    is_in_tolerance = error = epsilon\n    \n    hold_steps = int(np.ceil(T_hold / dt))\n\n    is_searching = True\n    search_start_idx = 0\n    \n    while is_searching and search_start_idx  len(t_eval):\n        # Find the next entry into the tolerance zone\n        potential_entries = np.where(is_in_tolerance[search_start_idx:])[0]\n        if len(potential_entries) == 0:\n            # No more entries into tolerance zone\n            is_searching = False\n            continue\n            \n        entry_idx = search_start_idx + potential_entries[0]\n        \n        # Check if the T_hold window fits within the simulation time\n        if entry_idx + hold_steps >= len(t_eval):\n            is_searching = False\n            continue\n\n        # Check if the condition holds for the entire T_hold duration\n        hold_window = is_in_tolerance[entry_idx : entry_idx + hold_steps + 1]\n        \n        if np.all(hold_window):\n            # Recovery found\n            recovery_time = t_eval[entry_idx]\n            return recovery_time, True\n        else:\n            # Did not hold, find where it failed and start search from there\n            first_fail_in_window = np.where(~hold_window)[0][0]\n            search_start_idx = entry_idx + first_fail_in_window\n\n    # If loop completes without finding a valid recovery period\n    return -1.0, False\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}