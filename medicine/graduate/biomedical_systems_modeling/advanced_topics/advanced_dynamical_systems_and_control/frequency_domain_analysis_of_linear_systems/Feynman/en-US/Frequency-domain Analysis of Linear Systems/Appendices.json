{
    "hands_on_practices": [
        {
            "introduction": "A fundamental skill in biomedical systems modeling is translating a physical system into a mathematical framework amenable to analysis. This first practice focuses on deriving the transfer function $H(s)$ from a differential equation that models the mechanical behavior of viscoelastic tissue. By analyzing the poles of this transfer function , you will assess the system's Bounded-Input Bounded-Output (BIBO) stability, a critical property that determines if the system's response will remain finite for any finite input.",
            "id": "3887533",
            "problem": "A viscoelastic segment of soft tissue in a controlled indentation experiment is modeled as a lumped linear system driven by an externally applied force. The mechanical configuration consists of a Kelvin–Voigt element (a spring of stiffness $k$ in parallel with a dashpot of viscosity $\\eta$) attached to a rigid base, with an effective inertial mass $m$ representing local tissue inertia due to surrounding fluid–structure interaction. Let the input be the applied force $F(t)$ and the output be the indentation displacement $x(t)$ measured by a laser triangulation sensor. Under small-strain assumptions and linear constitutive behavior, the governing dynamics reduce to a second-order linear differential equation\n$$\nm\\,\\ddot{x}(t) + \\eta\\,\\dot{x}(t) + k\\,x(t) = F(t),\n$$\nwith $m > 0$, $\\eta > 0$, and $k > 0$. Assume the system is linear time-invariant (LTI) and initially at rest, so $x(0^{-}) = 0$ and $\\dot{x}(0^{-}) = 0$.\n\nStarting from the definition of the bilateral Laplace transform and the linear differential equation above, construct the transfer function $H(s)$ from $F(t)$ to $x(t)$, where $H(s) = X(s)/F(s)$ and $s$ is the complex Laplace variable. Then, analyze the pole locations of $H(s)$ and the Region of Convergence (ROC) for the bilateral Laplace transform of the impulse response to assess stability in the sense of Bounded-Input Bounded-Output (BIBO) stability. Explicitly identify conditions on $(m,\\eta,k)$ that guarantee all poles lie in the left-half of the complex plane and state the corresponding ROC for a causal impulse response.\n\nProvide your reasoning in full, beginning from fundamental laws and core definitions (Newton’s second law, linear viscoelastic constitutive relations, and the definition of the Laplace transform). Do not use shortcut formulas; carry out the derivation carefully. For submission, report only the final symbolic expression for the transfer function $H(s)$ as your answer. No numerical evaluation is required.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It provides a complete and consistent set of givens for a standard problem in linear systems analysis applied to a biomedical model. The task is to derive and analyze the system's transfer function from first principles.\n\nThe system dynamics are described by a second-order linear time-invariant (LTI) ordinary differential equation with constant coefficients:\n$$\nm\\,\\ddot{x}(t) + \\eta\\,\\dot{x}(t) + k\\,x(t) = F(t)\n$$\nwhere $m$, $\\eta$, and $k$ are positive real constants representing mass, viscosity, and stiffness, respectively. The input is the force $F(t)$ and the output is the displacement $x(t)$. The system is assumed to be initially at rest, meaning the initial conditions at time $t=0^{-}$ are $x(0^{-}) = 0$ and $\\dot{x}(0^{-}) = 0$.\n\nThe transfer function $H(s)$ is defined as the ratio of the Laplace transform of the output, $X(s)$, to the Laplace transform of the input, $F(s)$, assuming zero initial conditions. We begin with the definition of the bilateral Laplace transform for a general function $g(t)$:\n$$\nG(s) = \\mathcal{L}\\{g(t)\\} = \\int_{-\\infty}^{\\infty} g(t) \\exp(-st) \\, dt\n$$\nwhere $s = \\sigma + j\\omega$ is the complex frequency variable.\n\nTo find the transfer function, we apply the Laplace transform to both sides of the governing differential equation. By the linearity property of the Laplace transform, we have:\n$$\n\\mathcal{L}\\{m\\,\\ddot{x}(t) + \\eta\\,\\dot{x}(t) + k\\,x(t)\\} = \\mathcal{L}\\{F(t)\\}\n$$\n$$\nm\\,\\mathcal{L}\\{\\ddot{x}(t)\\} + \\eta\\,\\mathcal{L}\\{\\dot{x}(t)\\} + k\\,\\mathcal{L}\\{x(t)\\} = F(s)\n$$\nWe now use the differentiation property of the bilateral Laplace transform. For the first derivative, the property is:\n$$\n\\mathcal{L}\\{\\dot{x}(t)\\} = s X(s) - x(0^{-})\n$$\nFor the second derivative, we apply the property twice:\n$$\n\\mathcal{L}\\{\\ddot{x}(t)\\} = s\\,\\mathcal{L}\\{\\dot{x}(t)\\} - \\dot{x}(0^{-}) = s(s X(s) - x(0^{-})) - \\dot{x}(0^{-}) = s^{2} X(s) - s x(0^{-}) - \\dot{x}(0^{-})\n$$\nThe problem states that the system is initially at rest, which implies $x(0^{-}) = 0$ and $\\dot{x}(0^{-}) = 0$. Substituting these zero initial conditions into the expressions for the transformed derivatives simplifies them to:\n$$\n\\mathcal{L}\\{\\dot{x}(t)\\} = s X(s)\n$$\n$$\n\\mathcal{L}\\{\\ddot{x}(t)\\} = s^{2} X(s)\n$$\nSubstituting these back into the transformed differential equation yields:\n$$\nm(s^{2} X(s)) + \\eta(s X(s)) + k(X(s)) = F(s)\n$$\nWe can factor out $X(s)$ on the left-hand side:\n$$\nX(s) (m s^{2} + \\eta s + k) = F(s)\n$$\nThe transfer function $H(s)$ is the ratio $X(s)/F(s)$. Solving for this ratio gives:\n$$\nH(s) = \\frac{X(s)}{F(s)} = \\frac{1}{m s^{2} + \\eta s + k}\n$$\nThis is the transfer function of the system.\n\nNext, we analyze the pole locations to assess Bounded-Input Bounded-Output (BIBO) stability. The poles of $H(s)$ are the roots of the denominator polynomial, also known as the characteristic equation:\n$$\nm s^{2} + \\eta s + k = 0\n$$\nUsing the quadratic formula, the poles $s_{1,2}$ are given by:\n$$\ns_{1,2} = \\frac{-\\eta \\pm \\sqrt{\\eta^{2} - 4mk}}{2m}\n$$\nWe can separate the real and imaginary parts of this expression:\n$$\ns_{1,2} = -\\frac{\\eta}{2m} \\pm \\frac{\\sqrt{\\eta^{2} - 4mk}}{2m}\n$$\nA continuous-time LTI system is BIBO stable if and only if all of its poles lie in the open left-half of the complex plane (LHP), which means the real part of every pole must be strictly negative. Let's analyze the real part of $s_{1,2}$.\nWe are given that $m > 0$, $\\eta > 0$, and $k > 0$.\n\nCase 1: Overdamped or critically damped system ($\\eta^{2} - 4mk \\geq 0$).\nIn this case, the square root term is real, and the poles $s_1$ and $s_2$ are both real and distinct (or equal). The poles are:\n$$\ns_1 = -\\frac{\\eta}{2m} + \\frac{\\sqrt{\\eta^{2} - 4mk}}{2m} \\quad \\text{and} \\quad s_2 = -\\frac{\\eta}{2m} - \\frac{\\sqrt{\\eta^{2} - 4mk}}{2m}\n$$\nSince $\\eta > 0$ and $m > 0$, the term $-\\eta/(2m)$ is strictly negative. For $s_2$, we are subtracting a non-negative term, so $s_2$ is clearly negative. For $s_1$, we must verify that it is also negative. We need to show that $\\eta/(2m) > \\sqrt{\\eta^2 - 4mk}/(2m)$, which is equivalent to showing $\\eta > \\sqrt{\\eta^2 - 4mk}$. Squaring both sides (which is valid as both are non-negative) gives $\\eta^2 > \\eta^2 - 4mk$, which simplifies to $0 > -4mk$, or $4mk > 0$. Since $m > 0$ and $k > 0$, this inequality is always true. Thus, both poles $s_1$ and $s_2$ are strictly negative real numbers.\n\nCase 2: Underdamped system ($\\eta^{2} - 4mk < 0$).\nIn this case, the term inside the square root is negative, and the poles are a complex conjugate pair. We can write:\n$$\ns_{1,2} = -\\frac{\\eta}{2m} \\pm j \\frac{\\sqrt{4mk - \\eta^{2}}}{2m}\n$$\nThe real part of both poles is $\\text{Re}\\{s_{1,2}\\} = -\\frac{\\eta}{2m}$.\nSince we are given that $m > 0$ and $\\eta > 0$, the real part is strictly negative.\n\nIn both cases, the real parts of all poles are strictly negative. Therefore, the conditions for all poles to lie in the LHP are precisely the given physical constraints: $m > 0$, $\\eta > 0$, and $k > 0$. The system is inherently BIBO stable.\n\nFinally, we determine the Region of Convergence (ROC) for the impulse response $h(t) = \\mathcal{L}^{-1}\\{H(s)\\}$. The physical system described by the differential equation is causal, meaning its impulse response $h(t)$ is zero for $t < 0$. For a causal LTI system, the ROC of its transfer function $H(s)$ is a right-half plane located to the right of the rightmost pole. The ROC is given by $\\text{Re}\\{s\\} > \\max(\\text{Re}\\{s_1\\}, \\text{Re}\\{s_2\\})$. As established, the real parts of the poles are:\n- If $\\eta^2 - 4mk \\geq 0$: $\\text{Re}\\{s_1\\} = -\\frac{\\eta}{2m} + \\frac{\\sqrt{\\eta^{2} - 4mk}}{2m}$ and $\\text{Re}\\{s_2\\} = -\\frac{\\eta}{2m} - \\frac{\\sqrt{\\eta^{2} - 4mk}}{2m}$. The rightmost pole is $s_1$.\n- If $\\eta^2 - 4mk < 0$: $\\text{Re}\\{s_1\\} = \\text{Re}\\{s_2\\} = -\\frac{\\eta}{2m}$.\n\nIn the first case, we have $\\text{Re}\\{s_1\\} = -\\frac{\\eta - \\sqrt{\\eta^2 - 4mk}}{2m}$, which is a negative value. In the second case, the real part is $-\\frac{\\eta}{2m}$. In all scenarios, the real parts of the poles are negative. Let's denote the rightmost pole as $p_{max}$. The ROC is $\\text{Re}\\{s\\} > \\text{Re}\\{p_{max}\\}$. Since $\\text{Re}\\{p_{max}\\} < 0$, the ROC always includes the imaginary axis ($\\text{Re}\\{s\\} = 0$), which is consistent with the system being BIBO stable. The specific boundary of the ROC is $\\text{Re}\\{s\\} > \\frac{-\\eta + \\sqrt{\\eta^{2} - 4mk}}{2m}$ if $\\eta^2 \\geq 4mk$, and $\\text{Re}\\{s\\} > -\\frac{\\eta}{2m}$ if $\\eta^2 < 4mk$.\n\nThe problem asks for the symbolic expression for the transfer function $H(s)$ as the final answer.",
            "answer": "$$\n\\boxed{\\frac{1}{m s^{2} + \\eta s + k}}\n$$"
        },
        {
            "introduction": "Once a system's effect on a signal is characterized by a transfer function, a common engineering goal is to invert this effect to recover the original, uncorrupted input. This process, known as deconvolution, is fraught with practical challenges. This exercise  delves into the critical issue of noise amplification that arises from direct frequency-domain inversion, particularly for non-minimum-phase systems, providing insight into why naive deconvolution can often worsen, rather than improve, signal quality.",
            "id": "3887491",
            "problem": "A biomedical instrument designed to measure a physiological input signal is well-approximated as a Linear Time-Invariant (LTI) system with impulse response $h(t)$ and frequency response $H(s)$, where $s$ denotes complex frequency. The measured signal is modeled as $m(t) = (h * x)(t) + n(t)$, where $x(t)$ is the true input, $*$ denotes convolution, and $n(t)$ is additive sensor noise. Consider performing exact frequency-domain deconvolution by forming an estimate $y(t)$ of $x(t)$ via $Y(j\\omega) = M(j\\omega)/H(j\\omega)$, i.e., applying the inverse frequency response $G(j\\omega) = 1/H(j\\omega)$ to the measurement spectrum.\n\nSuppose the instrument’s frequency response is rational and strictly proper with one non-minimum-phase zero:\n$$\nH(s) = \\frac{s - a}{(s + b)(s + c)},\n$$\nwhere $a > 0$, $b > 0$, and $c > 0$ are real constants in radians per second. The noise $n(t)$ is wide-sense stationary with bilateral band-limited white Power Spectral Density (PSD) $S_{n}(\\omega) = S_{0}$ for $|\\omega| \\leq \\Omega$ and $S_{n}(\\omega) = 0$ otherwise, where $S_{0} > 0$ and $\\Omega > 0$ are constants.\n\nUsing only foundational definitions for LTI systems, convolution, Fourier transforms, and the relationship between filtering and PSDs, provide a principled explanation for why exact inversion of such a non-minimum-phase system amplifies high-frequency noise. Then, starting from first principles and without invoking pre-derived “shortcut” formulas, derive an analytic expression for the expected noise-power gain\n$$\nG_{n} \\equiv \\frac{\\text{output noise power after inversion}}{\\text{input noise power}}\n$$\nin terms of $a$, $b$, $c$, and $\\Omega$. Finally, evaluate $G_{n}$ numerically for the parameter values $a = 20$ rad/s, $b = 5$ rad/s, $c = 20$ rad/s, and $\\Omega = 50$ rad/s. Express the final result as a dimensionless ratio and round your answer to four significant figures.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution without contradictions. We may therefore proceed with the solution.\n\nThe problem asks for three items: a principled explanation for high-frequency noise amplification, a derivation of the noise-power gain $G_n$, and a numerical evaluation of this gain for specific parameters.\n\nFirst, we will provide the explanation for noise amplification. The measurement is given by $m(t) = (h * x)(t) + n(t)$, where $x(t)$ is the true signal, $h(t)$ is the system's impulse response, and $n(t)$ is additive noise. In the frequency domain, this relationship is $M(j\\omega) = H(j\\omega)X(j\\omega) + N(j\\omega)$.\n\nExact deconvolution attempts to recover $x(t)$ by applying an inverse filter $G(j\\omega) = 1/H(j\\omega)$ to the measurement spectrum $M(j\\omega)$. The estimated signal spectrum $Y(j\\omega)$ is:\n$$\nY(j\\omega) = G(j\\omega)M(j\\omega) = \\frac{1}{H(j\\omega)} \\left( H(j\\omega)X(j\\omega) + N(j\\omega) \\right) = X(j\\omega) + \\frac{N(j\\omega)}{H(j\\omega)}\n$$\nThe output $y(t)$ is the sum of the true signal $x(t)$ and an output noise term $y_n(t)$, whose spectrum is $Y_n(j\\omega) = N(j\\omega)/H(j\\omega) = G(j\\omega)N(j\\omega)$. The output noise $y_n(t)$ is the result of filtering the input noise $n(t)$ with the inverse filter $G(j\\omega)$.\n\nThe Power Spectral Density (PSD) of the output noise, $S_{y_n}(\\omega)$, is related to the input noise PSD, $S_n(\\omega)$, by:\n$$\nS_{y_n}(\\omega) = |G(j\\omega)|^2 S_n(\\omega) = \\frac{S_n(\\omega)}{|H(j\\omega)|^2}\n$$\nThe system's frequency response is given as $H(s) = \\frac{s - a}{(s + b)(s + c)}$ with $a, b, c > 0$. The magnitude squared of the frequency response is:\n$$\n|H(j\\omega)|^2 = \\left| \\frac{j\\omega - a}{(j\\omega + b)(j\\omega + c)} \\right|^2 = \\frac{|j\\omega - a|^2}{|j\\omega + b|^2 |j\\omega + c|^2} = \\frac{\\omega^2 + a^2}{(\\omega^2 + b^2)(\\omega^2 + c^2)}\n$$\nThe magnitude squared of the inverse filter's frequency response is therefore:\n$$\n|G(j\\omega)|^2 = \\frac{1}{|H(j\\omega)|^2} = \\frac{(\\omega^2 + b^2)(\\omega^2 + c^2)}{\\omega^2 + a^2}\n$$\nFor high frequencies, i.e., as $\\omega \\to \\infty$, the behavior of $|G(j\\omega)|^2$ is determined by the highest powers of $\\omega$:\n$$\n|G(j\\omega)|^2 \\approx \\frac{(\\omega^2)(\\omega^2)}{\\omega^2} = \\omega^2\n$$\nThis implies that $|G(j\\omega)|$ grows linearly with $\\omega$ for large $\\omega$. The inverse filter acts as a high-pass filter with an amplifying gain that increases without bound as frequency increases. Consequently, any high-frequency content present in the input noise $n(t)$ will be significantly amplified in the output noise $y_n(t)$. This is the fundamental reason for noise amplification during the inversion of this strictly proper system. The non-minimum-phase zero at $s=a$ influences the exact form of the inverse filter, but the high-frequency amplification is fundamentally because the original system $H(s)$ is strictly proper (degree of denominator $>$ degree of numerator), causing $|H(j\\omega)| \\to 0$ as $\\omega \\to \\infty$, and thus $|G(j\\omega)| \\to \\infty$.\n\nNext, we derive the analytic expression for the noise-power gain $G_n$.\n$$\nG_{n} = \\frac{\\text{output noise power}}{\\text{input noise power}} = \\frac{P_{out}}{P_{in}}\n$$\nThe input noise power $P_{in}$ is found by integrating the input noise PSD $S_n(\\omega)$ over all frequencies, divided by $2\\pi$.\n$$\nP_{in} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_n(\\omega) \\, d\\omega = \\frac{1}{2\\pi} \\int_{-\\Omega}^{\\Omega} S_0 \\, d\\omega = \\frac{S_0}{2\\pi} [\\omega]_{-\\Omega}^{\\Omega} = \\frac{S_0}{2\\pi} (\\Omega - (-\\Omega)) = \\frac{S_0 \\Omega}{\\pi}\n$$\nThe output noise power $P_{out}$ is found by integrating the output noise PSD $S_{y_n}(\\omega)$.\n$$\nP_{out} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S_{y_n}(\\omega) \\, d\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |G(j\\omega)|^2 S_n(\\omega) \\, d\\omega\n$$\nSince $S_n(\\omega) = 0$ for $|\\omega| > \\Omega$, the integral is restricted to the interval $[-\\Omega, \\Omega]$.\n$$\nP_{out} = \\frac{1}{2\\pi} \\int_{-\\Omega}^{\\Omega} \\frac{(\\omega^2 + b^2)(\\omega^2 + c^2)}{\\omega^2 + a^2} S_0 \\, d\\omega\n$$\nThe integrand is an even function of $\\omega$, so we can write:\n$$\nP_{out} = \\frac{S_0}{\\pi} \\int_{0}^{\\Omega} \\frac{(\\omega^2 + b^2)(\\omega^2 + c^2)}{\\omega^2 + a^2} \\, d\\omega\n$$\nTo evaluate the integral, we perform polynomial long division on the rational function of $\\omega^2$. Let $u = \\omega^2$.\n$$\n\\frac{(u + b^2)(u + c^2)}{u + a^2} = \\frac{u^2 + (b^2 + c^2)u + b^2c^2}{u + a^2}\n$$\nDivision yields:\n$$\n\\frac{u^2 + (b^2 + c^2)u + b^2c^2}{u + a^2} = u + (b^2 + c^2 - a^2) + \\frac{b^2c^2 - a^2(b^2 + c^2 - a^2)}{u + a^2}\n$$\nThe remainder can be factored: $b^2c^2 - a^2b^2 - a^2c^2 + a^4 = (b^2 - a^2)(c^2 - a^2)$.\nSubstituting back $u = \\omega^2$, our integrand becomes:\n$$\n\\omega^2 + (b^2 + c^2 - a^2) + \\frac{(b^2 - a^2)(c^2 - a^2)}{\\omega^2 + a^2}\n$$\nNow we integrate this expression from $0$ to $\\Omega$:\n$$\n\\int_{0}^{\\Omega} \\left( \\omega^2 + (b^2 + c^2 - a^2) + \\frac{(b^2 - a^2)(c^2 - a^2)}{\\omega^2 + a^2} \\right) d\\omega\n$$\n$$\n= \\left[ \\frac{\\omega^3}{3} \\right]_0^\\Omega + \\left[ (b^2 + c^2 - a^2)\\omega \\right]_0^\\Omega + (b^2 - a^2)(c^2 - a^2) \\int_{0}^{\\Omega} \\frac{1}{\\omega^2 + a^2} \\, d\\omega\n$$\n$$\n= \\frac{\\Omega^3}{3} + (b^2 + c^2 - a^2)\\Omega + (b^2 - a^2)(c^2 - a^2) \\left[ \\frac{1}{a} \\arctan\\left(\\frac{\\omega}{a}\\right) \\right]_0^\\Omega\n$$\n$$\n= \\frac{\\Omega^3}{3} + (b^2 + c^2 - a^2)\\Omega + \\frac{(b^2 - a^2)(c^2 - a^2)}{a} \\arctan\\left(\\frac{\\Omega}{a}\\right)\n$$\nSubstituting this result back into the expression for $P_{out}$:\n$$\nP_{out} = \\frac{S_0}{\\pi} \\left[ \\frac{\\Omega^3}{3} + (b^2 + c^2 - a^2)\\Omega + \\frac{(b^2 - a^2)(c^2 - a^2)}{a} \\arctan\\left(\\frac{\\Omega}{a}\\right) \\right]\n$$\nFinally, we compute the noise-power gain $G_n = P_{out} / P_{in}$:\n$$\nG_n = \\frac{\\frac{S_0}{\\pi} \\left[ \\frac{\\Omega^3}{3} + (b^2 + c^2 - a^2)\\Omega + \\frac{(b^2 - a^2)(c^2 - a^2)}{a} \\arctan\\left(\\frac{\\Omega}{a}\\right) \\right]}{\\frac{S_0 \\Omega}{\\pi}}\n$$\n$$\nG_n = \\frac{1}{\\Omega} \\left[ \\frac{\\Omega^3}{3} + (b^2 + c^2 - a^2)\\Omega + \\frac{(b^2 - a^2)(c^2 - a^2)}{a} \\arctan\\left(\\frac{\\Omega}{a}\\right) \\right]\n$$\n$$\nG_n = \\frac{\\Omega^2}{3} + (b^2 + c^2 - a^2) + \\frac{(b^2 - a^2)(c^2 - a^2)}{a\\Omega} \\arctan\\left(\\frac{\\Omega}{a}\\right)\n$$\nThis is the required analytic expression for the noise-power gain.\n\nLastly, we evaluate $G_n$ for the given parameter values: $a = 20$ rad/s, $b = 5$ rad/s, $c = 20$ rad/s, and $\\Omega = 50$ rad/s.\nWe calculate the necessary terms:\n$$\na^2 = 20^2 = 400\n$$\n$$\nb^2 = 5^2 = 25\n$$\n$$\nc^2 = 20^2 = 400\n$$\n$$\n\\Omega^2 = 50^2 = 2500\n$$\nA key simplification arises because $a=c$, which means $c^2 - a^2 = 400 - 400 = 0$. This causes the third term in the expression for $G_n$ to become zero.\n$$\nG_n = \\frac{2500}{3} + (25 + 400 - 400) + \\frac{(25 - 400)(400 - 400)}{(20)(50)} \\arctan\\left(\\frac{50}{20}\\right)\n$$\n$$\nG_n = \\frac{2500}{3} + 25 + 0\n$$\n$$\nG_n = \\frac{2500}{3} + \\frac{75}{3} = \\frac{2575}{3}\n$$\nAs a decimal, this is $858.333...$. Rounding to four significant figures gives $858.3$.",
            "answer": "$$\\boxed{858.3}$$"
        },
        {
            "introduction": "Theoretical models often exist in continuous time, but real-world biomedical signals are acquired as discrete-time samples. This practice bridges the gap by exploring the properties of the Discrete Fourier Transform (DFT), the workhorse for frequency analysis of digital data. By analyzing a sampled ECG segment , you will investigate fundamental concepts like frequency resolution and spectral leakage, which are essential for accurately interpreting the frequency content of any finite-length data set.",
            "id": "3887511",
            "problem": "An Electrocardiogram (ECG) segment is uniformly sampled at a rate $f_{s} = 512$ Hz, producing $N = 1024$ samples. Consider the Discrete-Time Fourier Transform (DTFT) of an underlying infinite-length discrete-time ECG sequence and the Discrete Fourier Transform (DFT) of the observed finite-length segment. Using only first principles of sampling and the definitions of the DTFT and DFT, derive the frequency-bin spacing for the $N$-point DFT in physical frequency (Hz) and compute the resulting frequency resolution $\\Delta f$ for this ECG segment. Express your final frequency resolution in Hz and round your answer to four significant figures.\n\nThen, still grounded in first principles, discuss and justify the origin of spectral leakage in the DFT when the segment contains a sinusoidal component whose number of cycles within the observation window is non-integer (for instance, a component at $f_{0} = 1.1$ Hz over the given segment), and explain how the finite-time windowing of the ECG signal modifies the DTFT and is sampled by the DFT. In your discussion, connect the DFT-domain multiplication to circular convolution in the time domain and explain how this relates to the use of zero-padding when implementing linear filtering via DFT-based methods. Your derivation and discussion must begin from core definitions and properties (uniform sampling, DTFT, DFT, and linear time-invariant system convolution) without invoking pre-derived shortcut formulas.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and complete. It presents a standard set of tasks in introductory digital signal processing, based on established first principles. The provided data are consistent and realistic for the given context of ECG analysis. Therefore, the problem is deemed valid and a full solution can be constructed.\n\nThe solution is presented in three parts as requested by the problem: first, the derivation of the frequency resolution; second, the discussion of spectral leakage; and third, the connection between DFT-based multiplication, convolution, and zero-padding.\n\n**Part 1: Derivation and Calculation of Frequency Resolution**\n\nWe begin from first principles. Let a continuous-time signal be denoted by $x_c(t)$. Uniform sampling at a rate of $f_s$ Hz yields a discrete-time sequence $x[n]$. The time interval between consecutive samples, the sampling period, is $T_s = \\frac{1}{f_s}$. The discrete-time sequence is thus given by $x[n] = x_c(n T_s)$.\n\nThe problem states that a segment of $N$ samples is observed. The total duration of this observation window is $T = N T_s = \\frac{N}{f_s}$.\n\nThe Discrete-Time Fourier Transform (DTFT) of an infinite-length discrete-time sequence $x[n]$ is defined as:\n$$X(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} x[n] e^{-j\\omega n}$$\nHere, $\\omega$ is the normalized discrete-time angular frequency in units of radians per sample. It is a continuous variable. The DTFT is periodic with a period of $2\\pi$.\n\nThe Discrete Fourier Transform (DFT) is defined for a finite-length sequence of length $N$. For the observed segment $x[n]$ where $n=0, 1, \\dots, N-1$, the $N$-point DFT, denoted $X[k]$, is given by:\n$$X[k] = \\sum_{n=0}^{N-1} x[n] e^{-j \\frac{2\\pi nk}{N}}, \\quad k = 0, 1, \\dots, N-1$$\nThe DFT provides a discrete set of frequency-domain samples. By comparing the exponents of the DTFT and DFT definitions, we can see that the DFT, $X[k]$, samples the DTFT of the finite-length (windowed) signal at $N$ specific discrete frequencies. These discrete angular frequencies are:\n$$\\omega_k = \\frac{2\\pi k}{N}, \\quad k = 0, 1, \\dots, N-1$$\nTo relate this discrete-time angular frequency $\\omega$ back to the physical frequency $f$ in Hertz (Hz), we use the relationship established by the sampling process. A sinusoid with physical frequency $f$ is $x_c(t) = \\cos(2\\pi f t)$. After sampling at $t = nT_s$, the discrete-time signal is $x[n] = \\cos(2\\pi f n T_s) = \\cos(\\omega n)$. Therefore, the relationship is:\n$$\\omega = 2\\pi f T_s = \\frac{2\\pi f}{f_s}$$\nNow, we can find the physical frequency $f_k$ that corresponds to the $k$-th bin of the DFT by substituting this relationship into the expression for $\\omega_k$:\n$$\\frac{2\\pi f_k}{f_s} = \\frac{2\\pi k}{N}$$\nSolving for $f_k$, we get the physical frequency of the $k$-th DFT bin:\n$$f_k = k \\left( \\frac{f_s}{N} \\right)$$\nThe frequency-bin spacing, also known as the frequency resolution $\\Delta f$, is the difference in frequency between adjacent bins. We can calculate this as $\\Delta f = f_{k+1} - f_k$:\n$$\\Delta f = (k+1) \\frac{f_s}{N} - k \\frac{f_s}{N} = \\frac{f_s}{N}$$\nThis fundamental result shows that the frequency resolution of an $N$-point DFT is the sampling rate divided by the number of samples. This is equivalent to the reciprocal of the observation window duration, $\\Delta f = \\frac{1}{T}$.\n\nUsing the given values, $f_s = 512$ Hz and $N = 1024$ samples:\n$$\\Delta f = \\frac{512 \\text{ Hz}}{1024} = 0.5 \\text{ Hz}$$\nRounding to four significant figures as required gives $0.5000$ Hz.\n\n**Part 2: Origin of Spectral Leakage**\n\nThe DFT implicitly analyzes the signal as if the $N$-point segment were one period of an infinitely repeating periodic signal. The DFT's basis functions are complex sinusoids with frequencies that are integer multiples of the fundamental frequency resolution, $\\Delta f = f_s/N$. These are the frequencies $f_k = k \\Delta f$.\n\nSpectral leakage occurs when the input signal contains a frequency component that is not an integer multiple of this fundamental frequency. Consider an underlying signal containing a sinusoid at frequency $f_0$.\nThe number of cycles of this sinusoid within the observation window of duration $T = N/f_s$ is given by $f_0 \\times T = f_0 \\frac{N}{f_s}$.\n\nIf this product is an integer, say $m$, then $f_0 = m \\frac{f_s}{N} = m \\Delta f$. This means the signal frequency $f_0$ perfectly aligns with the frequency of the $m$-th DFT basis function. In this case, all the energy of this sinusoid is captured in the single DFT bin $X[m]$ (and $X[N-m]$ for a real signal), and all other bins are zero (in the absence of other frequencies and noise). There is no leakage.\n\nHowever, if the number of cycles is non-integer, as in the example $f_0 = 1.1$ Hz where the number of cycles is $1.1 \\times (1024/512) = 2.2$, the signal frequency $f_0$ does not align with any DFT basis function. The signal is not periodic over the duration of the window.\n\nTo understand the consequence from first principles, we must analyze the effect of observing a finite segment. The observed $N$-point segment, $x[n]$, can be modeled as the true, potentially infinite-length signal, $x_{true}[n]$, multiplied by a rectangular window function, $w[n]$:\n$$x[n] = x_{true}[n] \\cdot w[n]$$\nwhere $w[n] = 1$ for $n=0, 1, \\dots, N-1$ and $w[n] = 0$ otherwise.\n\nThe convolution theorem states that multiplication in the time domain corresponds to circular convolution in the frequency domain. For the DTFT, this is linear convolution:\n$$X(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} X_{true}(e^{j\\theta}) W(e^{j(\\omega-\\theta)}) d\\theta$$\nwhere $X(e^{j\\omega})$, $X_{true}(e^{j\\omega})$, and $W(e^{j\\omega})$ are the DTFTs of $x[n]$, $x_{true}[n]$, and $w[n]$, respectively.\n\nIf the true signal is a pure sinusoid, $x_{true}[n] = A \\cos(\\omega_0 n + \\phi)$, its DTFT, $X_{true}(e^{j\\omega})$, consists of two Dirac delta functions at frequencies $\\pm \\omega_0$. The DTFT of the rectangular window, $W(e^{j\\omega})$, is the periodic sinc function (or Dirichlet kernel):\n$$W(e^{j\\omega}) = \\sum_{n=0}^{N-1} e^{-j\\omega n} = e^{-j\\omega(N-1)/2} \\frac{\\sin(N\\omega/2)}{\\sin(\\omega/2)}$$\nThis function has a main lobe centered at $\\omega=0$ and decaying side lobes.\nThe convolution of the delta functions with this sinc function results in the DTFT of the windowed signal, $X(e^{j\\omega})$, being two sinc functions centered at $\\pm \\omega_0$.\n\nThe DFT, $X[k]$, is simply a sampling of this continuous spectrum $X(e^{j\\omega})$ at the discrete frequencies $\\omega_k = 2\\pi k/N$. When $f_0$ (and thus $\\omega_0$) is not an integer multiple of the frequency resolution, the peak of the sinc function does not fall exactly on a DFT bin. Instead, the DFT samples the main lobe and, crucially, the side lobes of the sinc function. The energy from the single sinusoid is thus spread or \"leaked\" across many adjacent DFT bins, an effect known as spectral leakage.\n\n**Part 3: DFT, Convolution, and Zero-Padding**\n\nThe DFT convolution property states that element-wise multiplication of two $N$-point DFTs, $Y[k] = H[k]X[k]$, corresponds not to linear convolution, but to $N$-point circular convolution of their respective time-domain sequences:\n$$y[n] = \\text{IDFT}\\{H[k]X[k]\\} = \\sum_{m=0}^{N-1} x[m]h[(n-m) \\pmod N] = x[n] \\circledast h[n]$$\nThe modulo-$N$ operation on the time index is the source of the \"circular\" or \"wrap-around\" behavior.\n\nIn linear time-invariant (LTI) systems analysis, the desired operation is linear convolution:\n$$y_{lin}[n] = x[n] * h[n] = \\sum_{m=-\\infty}^{\\infty} x[m]h[n-m]$$\nIf the input sequence $x[n]$ has length $L$ and the system's impulse response $h[n]$ has length $M$, their linear convolution $y_{lin}[n]$ results in a sequence of length $L+M-1$.\n\nIf we simply take the $N$-point DFTs of $x[n]$ and $h[n]$ (assuming $N$ is the longer of $L$ and $M$), multiply them, and take the inverse DFT, the resulting circular convolution will be corrupted by time-domain aliasing. The tail of the linear convolution result (samples for $n \\ge N$) will wrap around and add to the beginning of the sequence.\n\nTo make the result of DFT-based multiplication equivalent to linear convolution, we must prevent this wrap-around aliasing. This is achieved by making the DFT length, say $N_{pad}$, long enough to fully contain the entire output of the linear convolution. The required length is $N_{pad} \\ge L+M-1$.\n\nThe procedure, known as \"fast convolution,\" is as follows:\n1.  Take the finite-length sequences $x[n]$ (length $L$) and $h[n]$ (length $M$).\n2.  Append zeros to both sequences to create new sequences, $x_{pad}[n]$ and $h_{pad}[n]$, both of length $N_{pad} \\ge L+M-1$. This process is called zero-padding.\n3.  Compute the $N_{pad}$-point DFTs of the padded sequences, $X_{pad}[k]$ and $H_{pad}[k]$.\n4.  Multiply them in the frequency domain: $Y_{pad}[k] = X_{pad}[k] H_{pad}[k]$.\n5.  Compute the $N_{pad}$-point inverse DFT of $Y_{pad}[k]$ to obtain $y_{pad}[n]$.\n\nThe resulting sequence $y_{pad}[n]$ will be identical to the true linear convolution $y_{lin}[n]$ for its first $L+M-1$ points, followed by zeros. By choosing a sufficiently large transform length via zero-padding, we ensure that the circular convolution inherent to the DFT framework produces the same result as linear convolution, thereby enabling efficient implementation of LTI filtering using FFT algorithms.",
            "answer": "$$\\boxed{0.5000}$$"
        }
    ]
}