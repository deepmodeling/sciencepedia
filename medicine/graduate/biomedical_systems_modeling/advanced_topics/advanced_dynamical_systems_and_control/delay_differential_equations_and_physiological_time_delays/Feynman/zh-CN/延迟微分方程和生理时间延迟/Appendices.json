{
    "hands_on_practices": [
        {
            "introduction": "理解生理节律的一个基本出发点是分析具有时滞的线性反馈回路。即使是最简单的负反馈系统，当时滞超过某个临界值时，也可能从稳定的稳态转变为持续的振荡。这个练习将引导您完成对一个简化的葡萄糖调控模型的稳定性分析，该模型由一个线性时滞微分方程（DDE）描述。通过这个实践，您将掌握使用特征方程来确定Hopf分岔发生的临界时滞的核心技术，并将抽象的数学结果与可观察到的生理现象（如血糖的超日节律）联系起来。",
            "id": "3881494",
            "problem": "一个基于生理学的血糖浓度 $G(t)$ 的质量平衡描述将 $G(t)$ 的变化率视为葡萄糖生成与清除之间的差值。在空腹或近稳态条件下，葡萄糖的生成主要由肝脏输出调节，而其清除则源于组织的摄取，这种摄取既有非胰岛素介导的，也有胰岛素介导的。在基础稳态 $G^{\\ast}$ 和 $I^{\\ast}$ 附近进行线性化，并将胰岛素对葡萄糖摄取的延迟作用聚合为一个等效项，可以写出一个关于偏差 $\\Delta G(t) = G(t) - G^{\\ast}$ 的最小负反馈模型，其形式为一阶延迟微分方程 (DDE)：\n$$\n\\frac{d \\Delta G(t)}{dt} = -a \\,\\Delta G(t) - b \\,\\Delta G(t-\\tau),\n$$\n其中 $a>0$ 代表非胰岛素介导的葡萄糖处置和快速肝脏稳定作用的等效速率常数，$b>0$ 代表胰岛素介导的葡萄糖处置的等效增益，而 $\\tau>0$ 是反映胰岛素分泌、肝脏处理、转运、受体结合以及细胞内信号动力学的生理延迟。当 $\\tau$ 增大，稳态通过霍普夫分岔失去稳定性时，$\\Delta G(t)$ 中便会出现持续振荡。\n\n从上述质量平衡和反馈原理出发，不使用任何未给出的快捷公式，通过分析线性化DDE的特征根，推导振荡开始的条件。获得出现纯虚特征根时的最小正临界延迟 $\\tau_{\\mathrm{crit}}$ 的显式解析表达式，该表达式应以 $a$ 和 $b$ 表示。然后，使用生理上合理的参数值 $a = 0.03 \\,\\text{min}^{-1}$ 和 $b = 0.075 \\,\\text{min}^{-1}$，计算 $\\tau_{\\mathrm{crit}}$ 的数值。答案以分钟为单位表示，并四舍五入到四位有效数字。\n\n为了与人体观测结果相联系，假设连续血糖监测 (CGM) 的测量数据显示，在空腹条件下存在周期在 $80$ 到 $150$ 分钟之间的超日节律振荡。根据你的推导，简要评估所选 $(a,b)$ 参数下失稳开始时的理论振荡周期是否在观测到的超日节律范围内，但最终的数值答案只需报告计算出的 $\\tau_{\\mathrm{crit}}$。",
            "solution": "问题要求推导临界时间延迟 $\\tau_{\\mathrm{crit}}$，在该延迟下，一个葡萄糖动力学的线性化模型会经历一次霍普夫分岔，从而导致振荡的开始。该模型由以下一阶延迟微分方程 (DDE) 给出：\n$$\n\\frac{d \\Delta G(t)}{dt} = -a \\,\\Delta G(t) - b \\,\\Delta G(t-\\tau)\n$$\n其中 $\\Delta G(t)$ 是偏离稳态血糖浓度的偏差，参数 $a$、$b$ 和 $\\tau$ 均为正实数。\n\n为了分析稳态 $\\Delta G(t) = 0$ 的稳定性，我们研究与该DDE相关联的特征方程的根。我们寻找形如 $\\Delta G(t) = C \\exp(\\lambda t)$ 的解，其中 $C$ 是一个常数，$\\lambda$ 是一个复数。将此拟设代入DDE中：\n$$\n\\frac{d}{dt} \\left(C \\exp(\\lambda t)\\right) = -a \\left(C \\exp(\\lambda t)\\right) - b \\left(C \\exp(\\lambda(t-\\tau))\\right)\n$$\n对左侧求导并提取公因式，我们得到：\n$$\n\\lambda C \\exp(\\lambda t) = -a C \\exp(\\lambda t) - b C \\exp(\\lambda t) \\exp(-\\lambda \\tau)\n$$\n假设存在非平凡解（$C \\neq 0$），我们可以将整个方程除以 $C \\exp(\\lambda t)$，得到关于特征值 $\\lambda$ 的特征方程：\n$$\n\\lambda = -a - b \\exp(-\\lambda \\tau)\n$$\n整理后得到标准形式：\n$$\n\\lambda + a + b \\exp(-\\lambda \\tau) = 0\n$$\n稳态 $\\Delta G(t) = 0$ 是稳定的，当且仅当所有特征根 $\\lambda$ 的实部都为负（$\\text{Re}(\\lambda)  0$）。持续振荡的开始，即霍普夫分岔，发生在一对共轭复根穿过虚轴时。在这个分岔点，根的形式为 $\\lambda = \\pm i\\omega_c$，其中 $\\omega_c$ 是一个实的、非零的角频率（$\\omega_c > 0$）。\n\n我们将 $\\lambda = i\\omega_c$ 代入特征方程：\n$$\ni\\omega_c + a + b \\exp(-i\\omega_c \\tau) = 0\n$$\n使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$，我们可以写出：\n$$\ni\\omega_c + a + b(\\cos(\\omega_c \\tau) - i\\sin(\\omega_c \\tau)) = 0\n$$\n为使此方程成立，表达式的实部和虚部必须同时为零。我们将实部项和虚部项分组：\n$$\n(a + b \\cos(\\omega_c \\tau)) + i(\\omega_c - b \\sin(\\omega_c \\tau)) = 0\n$$\n这就得到了一个包含两个方程的方程组：\n1. 实部：$a + b \\cos(\\omega_c \\tau) = 0 \\implies \\cos(\\omega_c \\tau) = -\\frac{a}{b}$\n2. 虚部：$\\omega_c - b \\sin(\\omega_c \\tau) = 0 \\implies \\sin(\\omega_c \\tau) = \\frac{\\omega_c}{b}$\n\n为了求解 $\\omega_c$，我们使用基本三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$，其中 $\\theta = \\omega_c \\tau$：\n$$\n\\left(-\\frac{a}{b}\\right)^2 + \\left(\\frac{\\omega_c}{b}\\right)^2 = 1\n$$\n$$\n\\frac{a^2}{b^2} + \\frac{\\omega_c^2}{b^2} = 1\n$$\n两边乘以 $b^2$，得到 $a^2 + \\omega_c^2 = b^2$。现在我们可以解出 $\\omega_c^2$：\n$$\n\\omega_c^2 = b^2 - a^2\n$$\n为了使振荡解存在（$\\omega_c$ 必须是实的且非零），我们必须有 $\\omega_c^2 > 0$，这意味着 $b^2 > a^2$。由于给定的 $a$ 和 $b$ 都是正数，该条件简化为 $b > a$。因此，分岔点的振荡频率为：\n$$\n\\omega_c = \\sqrt{b^2 - a^2}\n$$\n现在我们来求临界延迟 $\\tau_{\\mathrm{crit}}$。我们有两个关于角 $\\omega_c \\tau$ 的条件。由于 $a > 0$，$b > 0$ 且 $\\omega_c > 0$，我们有 $\\cos(\\omega_c \\tau) = -a/b  0$ 和 $\\sin(\\omega_c \\tau) = \\omega_c/b > 0$。这两个条件意味着角 $\\omega_c \\tau$ 必须位于第二象限。\n\n从 $\\cos(\\omega_c \\tau) = -a/b$ 可知，$\\omega_c \\tau$ 的可能值由下式给出：\n$$\n\\omega_c \\tau = \\arccos\\left(-\\frac{a}{b}\\right) + 2k\\pi\n$$\n其中 $k$ 为任意整数。$\\arccos$ 函数返回一个在 $[0, \\pi]$ 区间内的值。由于其参数 $-a/b$ 介于 $-1$ 和 $0$ 之间（因为 $b>a$），主值 $\\arccos(-a/b)$ 位于 $(\\pi/2, \\pi]$ 区间内，这正好将其置于第二象限。满足此条件的最小正延迟 $\\tau$ 对应于 $k=0$ 的情况。这个最小延迟就是临界延迟 $\\tau_{\\mathrm{crit}}$。\n$$\n\\omega_c \\tau_{\\mathrm{crit}} = \\arccos\\left(-\\frac{a}{b}\\right)\n$$\n解出 $\\tau_{\\mathrm{crit}}$ 并代入 $\\omega_c$ 的表达式，我们得到其显式解析表达式：\n$$\n\\tau_{\\mathrm{crit}} = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{a}{b}\\right) = \\frac{1}{\\sqrt{b^2 - a^2}} \\arccos\\left(-\\frac{a}{b}\\right)\n$$\n现在，我们使用给定的参数 $a = 0.03 \\,\\text{min}^{-1}$ 和 $b = 0.075 \\,\\text{min}^{-1}$ 来计算 $\\tau_{\\mathrm{crit}}$ 的数值。首先，检查振荡条件：$b = 0.075 > a = 0.03$，因此条件满足。\n\n振荡频率 $\\omega_c$ 为：\n$$\n\\omega_c = \\sqrt{(0.075)^2 - (0.03)^2} = \\sqrt{0.005625 - 0.0009} = \\sqrt{0.004725} \\,\\text{min}^{-1}\n$$\narccosine 函数的自变量为：\n$$\n-\\frac{a}{b} = -\\frac{0.03}{0.075} = -0.4\n$$\n现在，我们可以计算 $\\tau_{\\mathrm{crit}}$：\n$$\n\\tau_{\\mathrm{crit}} = \\frac{1}{\\sqrt{0.004725}} \\arccos(-0.4) \\approx \\frac{1}{0.068738635} \\times 1.98231317 \\approx 28.84158 \\,\\text{min}\n$$\n将结果四舍五入到四位有效数字，得到 $\\tau_{\\mathrm{crit}} = 28.84 \\,\\text{min}$。\n\n对于所要求的简要评估，失稳开始时的振荡周期为 $T = 2\\pi/\\omega_c$。\n$$\nT = \\frac{2\\pi}{\\sqrt{0.004725}} \\approx \\frac{2\\pi}{0.068738635} \\approx 91.41 \\,\\text{min}\n$$\n这个约 91 分钟的理论周期位于观测到的生理超日节律范围（80 到 150 分钟）之内，这表明该最小模型尽管简单，却捕捉到了葡萄糖动力学的一个相关时间尺度。",
            "answer": "$$\\boxed{28.84}$$"
        },
        {
            "introduction": "在真实的生理系统中，反馈机制通常是高度非线性的。在上一个练习的基础上，本实践将难度提升至一个更符合实际的非线性模型——一个经典的红细胞生成（hematopoiesis）模型。您将首先学习如何求解非线性代数方程以确定系统的平衡点，然后通过在平衡点附近进行线性化来评估其局部稳定性。这个练习不仅强化了您对时滞诱导振荡的分析能力，还展示了如何将这些技术应用于更复杂的场景，揭示时滞如何破坏系统的稳态，从而可能导致周期性疾病的发生。",
            "id": "3881476",
            "problem": "在造血作用中，循环中的成熟红细胞（RBC）与祖细胞增殖之间的延迟负反馈可以通过标量延迟微分方程来建模\n$$\n\\frac{dx(t)}{dt} \\;=\\; \\beta\\,\\frac{x(t-\\tau)}{1 + x(t-\\tau)^{n}} \\;-\\; \\gamma\\,x(t),\n$$\n其中 $x(t)$ 是成熟红细胞的浓度，$\\beta$ 是最大有效生成率，$\\gamma$ 是一阶清除率，$n$ 是反馈的协同性，$\\tau$ 是成熟延迟时间。\n\n从延迟微分方程的平衡点和线性化的定义出发，并使用指数解的标准拟设来获得特征方程，完成以下任务：\n\n- 确定所有平衡点 $x^{\\ast}$。\n- 分析正平衡点 $x^{\\ast}  0$ 的局部渐近稳定性（作为 $\\tau$ 的函数），并推导通过Hopf分岔（即一对共轭特征根穿过虚轴时）产生振荡的条件。\n- 对于具体参数值 $\\beta = 3\\,\\text{day}^{-1}$，$\\gamma = 1\\,\\text{day}^{-1}$ 和 $n = 4$，计算发生Hopf分岔的最小正临界延迟 $\\tau_{c}$。\n\n以天为单位表示最终延迟，并将答案四舍五入到 $4$ 位有效数字。最终答案必须是单个实数值。",
            "solution": "该问题要求分析一个模拟造血作用的延迟微分方程（DDE），具体来说，是为其求出平衡点，分析正平衡点的稳定性，并为一组给定参数计算发生Hopf分岔的临界时间延迟 $\\tau_c$。\n\n控制DDE为：\n$$\n\\frac{dx(t)}{dt} \\;=\\; \\beta\\,\\frac{x(t-\\tau)}{1 + x(t-\\tau)^{n}} \\;-\\; \\gamma\\,x(t)\n$$\n其中 $x(t)$ 是成熟红细胞的浓度，$\\beta$ 是最大生成率，$\\gamma$ 是清除率，$n$ 是反馈的协同性，$\\tau$ 是成熟延迟。\n\n**步骤1：确定平衡点**\n\n平衡点，记为 $x^{\\ast}$，是DDE的常数解。我们通过设置 $\\frac{dx(t)}{dt} = 0$ 和 $x(t) = x(t-\\tau) = x^{\\ast}$ 来找到它们：\n$$\n0 \\;=\\; \\beta\\,\\frac{x^{\\ast}}{1 + (x^{\\ast})^{n}} \\;-\\; \\gamma\\,x^{\\ast}\n$$\n该方程可以重排为：\n$$\nx^{\\ast} \\left( \\frac{\\beta}{1 + (x^{\\ast})^{n}} - \\gamma \\right) = 0\n$$\n这给出了两个可能的平衡点：\n1.  平凡平衡点：$x_1^{\\ast} = 0$。\n2.  正平衡点，通过将括号中的项设为零得到：\n    $$\n    \\frac{\\beta}{1 + (x^{\\ast})^{n}} - \\gamma = 0 \\quad \\implies \\quad 1 + (x^{\\ast})^{n} = \\frac{\\beta}{\\gamma}\n    $$\n    这得到正平衡点的值 $x_2^{\\ast}$：\n    $$\n    (x_2^{\\ast})^{n} = \\frac{\\beta}{\\gamma} - 1 \\quad \\implies \\quad x_2^{\\ast} = \\left(\\frac{\\beta}{\\gamma} - 1\\right)^{1/n}\n    $$\n    当且仅当 $\\frac{\\beta}{\\gamma} > 1$ 时，存在正实数平衡点。\n\n**步骤2：线性化与稳定性分析**\n\n我们分析正平衡点 $x^{\\ast} = x_2^{\\ast}$ 的局部渐近稳定性。我们将DDE的右侧定义为函数 $F(x(t), x(t-\\tau))$：\n$$\nF(x(t), x(t-\\tau)) = \\beta\\,\\frac{x(t-\\tau)}{1 + x(t-\\tau)^{n}} \\;-\\; \\gamma\\,x(t)\n$$\n令 $x(t) = x^{\\ast} + y(t)$，其中 $y(t)$ 是一个小扰动。$y(t)$的线性化方程为：\n$$\n\\frac{dy(t)}{dt} = \\frac{\\partial F}{\\partial x(t)}\\bigg|_{x^{\\ast}} y(t) + \\frac{\\partial F}{\\partial x(t-\\tau)}\\bigg|_{x^{\\ast}} y(t-\\tau)\n$$\n在平衡点 $(x^{\\ast}, x^{\\ast})$ 处计算的偏导数为：\n$$\n\\frac{\\partial F}{\\partial x(t)}\\bigg|_{x^{\\ast}} = -\\gamma\n$$\n$$\n\\frac{\\partial F}{\\partial x(t-\\tau)}\\bigg|_{x^{\\ast}} = \\beta \\frac{d}{dx}\\left(\\frac{x}{1+x^n}\\right)\\bigg|_{x=x^{\\ast}} = \\beta \\frac{(1+(x^{\\ast})^n) \\cdot 1 - x^{\\ast} \\cdot n(x^{\\ast})^{n-1}}{(1+(x^{\\ast})^n)^2} = \\beta \\frac{1-(n-1)(x^{\\ast})^n}{(1+(x^{\\ast})^n)^2}\n$$\n我们记 $A = -\\gamma$ 和 $B = \\beta \\frac{1-(n-1)(x^{\\ast})^n}{(1+(x^{\\ast})^n)^2}$。线性化方程为：\n$$\n\\frac{dy(t)}{dt} = A y(t) + B y(t-\\tau)\n$$\n我们可以利用平衡点条件 $1+(x^{\\ast})^n = \\beta/\\gamma$ 来简化 $B$：\n$$\nB = \\beta \\frac{1-(n-1)(\\beta/\\gamma - 1)}{(\\beta/\\gamma)^2} = \\frac{\\gamma^2}{\\beta^2}\\beta \\left(1 - (n-1)\\frac{\\beta}{\\gamma} + n-1\\right) = \\frac{\\gamma^2}{\\beta}\\left(n - (n-1)\\frac{\\beta}{\\gamma}\\right) = \\frac{\\gamma}{\\beta}\\left(n\\gamma - (n-1)\\beta\\right)\n$$\n线性化方程变为 $\\frac{dy(t)}{dt} = -\\gamma y(t) + B y(t-\\tau)$。\n\n**步骤3：特征方程与Hopf分岔**\n\n为了找到特征方程，我们寻求形如 $y(t) = C e^{\\lambda t}$ 的指数解。将其代入线性化方程得到：\n$$\n\\lambda C e^{\\lambda t} = -\\gamma C e^{\\lambda t} + B C e^{\\lambda(t-\\tau)}\n$$\n两边同除以 $C e^{\\lambda t}$，我们得到关于特征值 $\\lambda$ 的特征方程：\n$$\n\\lambda = -\\gamma + B e^{-\\lambda \\tau} \\quad \\implies \\quad \\lambda + \\gamma = B e^{-\\lambda \\tau}\n$$\n当一对复共轭根 $\\lambda = \\sigma \\pm i\\omega$ 穿过虚轴时，发生Hopf分岔。在分岔点，实部为零，即 $\\sigma=0$，因此我们寻找纯虚根 $\\lambda = i\\omega$，其中 $\\omega \\in \\mathbb{R}$ 且 $\\omega > 0$。\n将 $\\lambda = i\\omega$ 代入特征方程：\n$$\ni\\omega + \\gamma = B e^{-i\\omega\\tau} = B(\\cos(\\omega\\tau) - i\\sin(\\omega\\tau))\n$$\n我们将此方程分为实部和虚部：\n\\begin{align*}\n\\text{实部: }  \\gamma = B \\cos(\\omega\\tau) \\\\\n\\text{虚部: }  \\omega = -B \\sin(\\omega\\tau)\n\\end{align*}\n为了存在非平凡解，$B$ 必须不为零。为了产生振荡，我们通常需要负反馈，所以我们预期 $B0$。在这种情况下，$\\cos(\\omega\\tau) = \\gamma/B  0$ 且 $\\sin(\\omega\\tau) = -\\omega/B > 0$，这使得角 $\\omega\\tau$ 位于第二象限。\n\n我们可以通过将两个方程平方并相加来求解 $\\omega$：\n$$\n\\gamma^2 + \\omega^2 = (B \\cos(\\omega\\tau))^2 + (-B \\sin(\\omega\\tau))^2 = B^2 (\\cos^2(\\omega\\tau) + \\sin^2(\\omega\\tau)) = B^2\n$$\n这给出了分岔点的振荡频率：\n$$\n\\omega^2 = B^2 - \\gamma^2 \\quad \\implies \\quad \\omega = \\sqrt{B^2 - \\gamma^2}\n$$\n对于实频率 $\\omega > 0$，我们必须有 $|B| > \\gamma$。\n\n临界延迟 $\\tau$ 可以从这两个方程的比值中求得：\n$$\n\\tan(\\omega\\tau) = \\frac{\\sin(\\omega\\tau)}{\\cos(\\omega\\tau)} = \\frac{-\\omega/B}{\\gamma/B} = -\\frac{\\omega}{\\gamma}\n$$\n由于我们确定了 $\\omega\\tau$ 在第二象限，$\\tau$ 的解由以下公式给出：\n$$\n\\omega\\tau_k = \\arccos\\left(\\frac{\\gamma}{B}\\right) + 2k\\pi, \\quad k=0, 1, 2, \\dots\n$$\n最小的正临界延迟 $\\tau_c$ 对应于 $k=0$：\n$$\n\\tau_c = \\frac{1}{\\omega} \\arccos\\left(\\frac{\\gamma}{B}\\right)\n$$\n\n**步骤4：使用具体参数进行计算**\n\n现在我们应用给定的值：$\\beta = 3\\,\\text{day}^{-1}$，$\\gamma = 1\\,\\text{day}^{-1}$ 和 $n = 4$。\n\n首先，我们求出正平衡点 $x^{\\ast}$：\n$$\n(x^{\\ast})^4 = \\frac{3}{1} - 1 = 2 \\quad \\implies \\quad x^{\\ast} = 2^{1/4}\n$$\n接下来，我们计算系数 $B$：\n$$\nB = \\beta \\frac{1-(n-1)(x^{\\ast})^n}{(1+(x^{\\ast})^n)^2} = 3 \\cdot \\frac{1-(4-1)(2)}{(1+2)^2} = 3 \\cdot \\frac{1-6}{9} = 3 \\cdot \\left(-\\frac{5}{9}\\right) = -\\frac{5}{3} \\, \\text{day}^{-1}\n$$\n当 $B = -5/3$ 和 $\\gamma=1$ 时，我们可以检查分岔的条件：$|B| = 5/3 > 1 = \\gamma$。该条件得到满足。\n\n现在，我们计算振荡频率 $\\omega$：\n$$\n\\omega = \\sqrt{B^2 - \\gamma^2} = \\sqrt{\\left(-\\frac{5}{3}\\right)^2 - 1^2} = \\sqrt{\\frac{25}{9} - 1} = \\sqrt{\\frac{16}{9}} = \\frac{4}{3} \\, \\text{day}^{-1}\n$$\n最后，我们计算最小正临界延迟 $\\tau_c$：\n$$\n\\tau_c = \\frac{1}{\\omega} \\arccos\\left(\\frac{\\gamma}{B}\\right) = \\frac{1}{4/3} \\arccos\\left(\\frac{1}{-5/3}\\right) = \\frac{3}{4} \\arccos\\left(-\\frac{3}{5}\\right)\n$$\n使用计算器计算反余弦函数的值（以弧度为单位）：\n$$\n\\arccos\\left(-\\frac{3}{5}\\right) \\approx 2.2142974\n$$\n$$\n\\tau_c = \\frac{3}{4} \\times 2.2142974 \\approx 1.660723 \\, \\text{days}\n$$\n将结果四舍五入到 $4$ 位有效数字，我们得到：\n$$\n\\tau_c \\approx 1.661 \\, \\text{days}\n$$",
            "answer": "$$\\boxed{1.661}$$"
        },
        {
            "introduction": "除了振荡，非线性反馈系统还表现出另一种关键行为：多稳态性（bistability），即系统可以存在多个稳定的平衡状态，这对于细胞决策和生物记忆等过程至关重要。本实践将您的技能从纯粹的解析计算转向计算探索，要求您分析一个具有S型正反馈的DDE模型。您需要通过编写数值程序来寻找所有平衡点、判断其稳定性，并通过动态仿真来近似描绘不同稳定状态的吸引盆（basins of attraction）。这项练习完美地将理论与实践相结合，让您深入了解系统的全局动态行为，而不仅仅是局部稳定性。",
            "id": "3881514",
            "problem": "考虑一个标量延迟微分方程（DDE）模型，该模型用于描述具有 S 型反馈和线性清除的自激活生化物质，这是生理调节和基因电路建模中的一个标准抽象。设 $x(t)$ 表示该物质在时间 $t$（单位为秒）时的浓度，经无量纲化处理后 $x(t)$ 为无单位量。其动力学由以下方程给出\n$$\n\\frac{dx}{dt}(t) = p + b\\,H\\big(x(t-\\tau)\\big) - a\\,x(t),\n$$\n其中 $p \\ge 0$ 是基础生产速率，$b \\ge 0$ 是最大正反馈强度，$a > 0$ 是一阶清除速率，$\\tau \\ge 0$ 是生理时间延迟。S 型激活函数 $H(\\cdot)$ 是 Hill 函数\n$$\nH(x) = \\frac{x^n}{K^n + x^n},\n$$\n其中 $n \\ge 1$ 是 Hill 系数，$K > 0$ 是激活阈值。除时间 $t$（单位为秒）外，所有参数都是无量纲的，但本问题中的输出应被视为无量纲的数值。\n\n任务：\n1. 从平衡点的定义出发，证明平衡点 $x^\\ast$ 满足代数方程\n$$\na\\,x^\\ast = p + b\\,H(x^\\ast),\n$$\n并解释为什么延迟 $\\tau$ 不会出现在平衡条件中。然后，从 DDE 在平衡点 $x^\\ast$ 附近的线性化出发，推导出标量特征方程\n$$\n\\lambda + a - b\\,H'(x^\\ast)\\,e^{-\\lambda \\tau} = 0,\n$$\n并用它来获得一个仅依赖于 $a$ 和 $b\\,H'(x^\\ast)$ 而不依赖于 $\\tau$ 的局部稳定性的充分必要判据。\n\n2. 实现一个数值程序，通过求解 $a\\,x = p + b\\,H(x)$ 来找到给定参数下的所有平衡点 $x^\\ast \\ge 0$。在 $x \\in [0, x_{\\max}]$ 上使用稳健的区间法，其中 $x_{\\max}$ 足够大以包含所有交点，并应用二分法在函数变号的区间内定位根。将平衡点按升序排序。\n\n3. 对于每个平衡点 $x^\\ast$，计算 $c^\\ast = b\\,H'(x^\\ast)$，其中\n$$\nH'(x) = \\frac{n\\,K^n\\,x^{n-1}}{\\big(K^n + x^n\\big)^2},\n$$\n并将 $x^\\ast$ 分类为局部渐近稳定当且仅当 $c^\\ast  a$；否则将其分类为不稳定。基于此分类，确定系统是否表现出双稳态（两个或更多个稳定平衡点）。\n\n4. 为了在常数历史函数的子空间内近似吸引盆，从多个常数历史初始化 $x(t) \\equiv x_0$（对于 $t \\in [-\\tau,0]$）开始模拟 DDE，使用步进法显式欧拉格式，并对延迟项进行线性插值。使用固定的步长和足够长的模拟时域 $T$ 以使其稳定下来。对于每个初始条件 $x_0$，通过将最终状态 $x(T)$ 分配给排序后的平衡点列表中最近的稳定平衡点来确定吸引子。如果不存在稳定平衡点，则返回吸引子索引 $-1$。\n\n5. 对于以下参数集和初始条件的测试套件，执行上述完整的分析和模拟。使用 $x_{\\max} = \\max\\{10\\,K,\\,2\\,(p+b)/a\\}$ 进行区间划分，使用至少 10000 个点的均匀网格进行符号变化检测，欧拉步长为 $\\Delta t = 0.01$ 秒，模拟时域为 $T = 100$ 秒。对于每个案例，报告：\n   - 找到的不同平衡点的整数数量，\n   - 局部稳定平衡点的整数数量，\n   - 如果存在两个或更多稳定平衡点，则双稳态标志为 $1$，否则为 $0$，\n   - 平衡点值的列表，四舍五入到六位小数，\n   - 每个初始历史的吸引子索引列表（整数），按给定顺序排列，其中索引是排序后平衡点列表中的 0-based 位置，-1 表示没有稳定的吸引子。\n\n测试套件：\n- 案例 1：$a=0.3$, $b=6.0$, $p=0.5$, $K=1.0$, $n=10$, $\\tau=2.0$, 初始常数 $[0.1,\\,0.4,\\,0.8,\\,1.2,\\,2.5,\\,5.0]$。\n- 案例 2：$a=2.0$, $b=1.5$, $p=0.1$, $K=1.0$, $n=4$, $\\tau=0.5$, 初始常数 $[0.05,\\,0.2,\\,0.5,\\,1.0,\\,2.0]$。\n- 案例 3：$a=0.5$, $b=2.0$, $p=0.1$, $K=1.0$, $n=6$, $\\tau=1.0$, 初始常数 $[0.05,\\,0.2,\\,0.5,\\,1.0,\\,2.0]$。\n- 案例 4：$a=0.8$, $b=4.0$, $p=0.15$, $K=1.2$, $n=5$, $\\tau=5.0$, 初始常数 $[0.1,\\,0.6,\\,1.2,\\,1.8,\\,3.0]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个案例的结果，格式为由逗号分隔、并用方括号括起来的每个案例的结果列表。每个案例的结果列表必须采用格式\n$$\n[\\text{num\\_eq},\\,\\text{num\\_stable},\\,\\text{bistable\\_flag},\\,\\text{equilibria\\_rounded},\\,\\text{attractor\\_indices}],\n$$\n其中 $\\text{equilibria\\_rounded}$ 是浮点数列表，$\\text{attractor\\_indices}$ 是允许-1的整数列表。例如，程序应打印类似\n$$\n\\big[\\,[2,1,0,[0.123456,1.234567],[0,0,0,0]],\\,\\ldots\\,\\big],\n$$\n的内容，其中的实际值由您的计算确定。",
            "solution": "我们从第一性原理开始。延迟微分方程的平衡点 $x^\\ast$ 被定义为一个常数解 $x(t) \\equiv x^\\ast$ (对于所有 $t \\in \\mathbb{R}$)，使得对所有 $t$ 都有 $\\frac{dx}{dt}(t) = 0$。将 $x(t) \\equiv x^\\ast$ 和 $x(t-\\tau) \\equiv x^\\ast$ 代入给定的 DDE，\n$$\n\\frac{dx}{dt}(t) = p + b\\,H\\big(x(t-\\tau)\\big) - a\\,x(t),\n$$\n我们得到代数平衡条件\n$$\n0 = p + b\\,H(x^\\ast) - a\\,x^\\ast \\quad \\Leftrightarrow \\quad a\\,x^\\ast = p + b\\,H(x^\\ast).\n$$\n延迟 $\\tau$ 不会进入这个平衡条件，因为在平衡状态下，状态是恒定的，所以对所有 $t$ 都有 $x(t-\\tau) = x(t) = x^\\ast$，这使得延迟项与当前项都等于同一个常数。\n\n为了评估局部稳定性，我们在平衡点 $x^\\ast$ 附近进行线性化。设 $x(t) = x^\\ast + \\eta(t)$，其中 $\\eta(t)$ 是一个小扰动。使用 $H(\\cdot)$ 在 $x^\\ast$ 附近的一阶泰勒展开，\n$$\nH\\big(x^\\ast + \\eta(t-\\tau)\\big) \\approx H(x^\\ast) + H'(x^\\ast)\\,\\eta(t-\\tau),\n$$\n并代入 DDE，同时注意平衡条件会消去常数项，我们得到线性化的 DDE\n$$\n\\eta'(t) = -a\\,\\eta(t) + b\\,H'(x^\\ast)\\,\\eta(t-\\tau).\n$$\n寻找指数解 $\\eta(t) = e^{\\lambda t}$ 会得到特征方程\n$$\n\\lambda + a - b\\,H'(x^\\ast)\\,e^{-\\lambda \\tau} = 0.\n$$\n为简洁起见，记作 $c^\\ast = b\\,H'(x^\\ast)$。标量延迟线性 DDE\n$$\n\\eta'(t) = -a\\,\\eta(t) + c^\\ast\\,\\eta(t-\\tau)\n$$\n有一个众所周知的稳定性分类。对于 $a>0$ 和 $c^\\ast \\ge 0$，平衡点对于所有 $\\tau \\ge 0$ 是局部渐近稳定的，当且仅当 $c^\\ast  a$。如果 $c^\\ast > a$，系统存在一个正实数特征根，因此对于任何 $\\tau \\ge 0$ 都是不稳定的。如果 $c^\\ast = a$，系统在 $\\tau$ 增大时可以通过霍普夫分岔变得不稳定，但严格的渐近稳定性条件是 $c^\\ast  a$。因此，一个不依赖于 $\\tau$ 的局部渐近稳定性的充分必要判据是\n$$\n\\text{稳定} \\iff c^\\ast = b\\,H'(x^\\ast)  a,\n$$\n它仅依赖于 $a$ 和 $b\\,H'(x^\\ast)$。\n\n对于 $n>1$，Hill 函数 $H(x) = \\frac{x^n}{K^n+x^n}$ 是递增的 S 型函数，其导数\n$$\nH'(x) = \\frac{n\\,K^n\\,x^{n-1}}{(K^n + x^n)^2}\n$$\n是单峰的。平衡条件 $a\\,x = p + b\\,H(x)$ 将一条直线与一个有界、递增的 S 型函数相等。对于足够大的 $n$ 和 $b$，S 型函数的斜率在中心区域超过直线的斜率，导致差值函数 $f(x) = a\\,x - p - b\\,H(x)$ 有两个临界点（一个局部极大值和一个局部极小值）和最多三个与零的交点。这对应于中间的一个不稳定平衡点（其中 $c^\\ast$ 较大）和在较低及较高浓度下的两个稳定平衡点（其中 $c^\\ast$ 较小）。这就产生了双稳态：由一个不稳定平衡点分隔开的两个吸引盆。\n\n算法设计：\n- 平衡点计算：定义 $f(x) = a\\,x - p - b\\,H(x)$。选择 $x_{\\max} = \\max\\{10K,\\,2(p+b)/a\\}$ 以确保线性项超过饱和的右侧项。在 $[0, x_{\\max}]$ 的密集网格上对 $f(x)$ 进行采样。识别 $f(x)$ 变号的子区间。在每个区间内应用二分法寻找根。将不同的根按升序排序，并通过一个小的容差过滤重复的根。\n- 稳定性分类：对于每个平衡点 $x^\\ast$，计算 $c^\\ast = b\\,H'(x^\\ast)$。如果 $c^\\ast  a$，则声明 $x^\\ast$ 是稳定的，否则是不稳定的。\n- 吸引盆的 DDE 模拟：对于 $[-\\tau, 0]$ 上的每个初始常数历史 $x(t) \\equiv x_0$，使用步长为 $\\Delta t$ 的步进法欧拉格式模拟\n$$\nx'(t) = p + b\\,H\\big(x(t-\\tau)\\big) - a\\,x(t)\n$$\n，并对 $x(t-\\tau)$ 进行线性插值。对于 $t-\\tau \\le 0$，设 $x(t-\\tau) = x_0$。对于 $t > 0$，记录 $(t, x(t))$ 以便对延迟值进行插值。积分到时域 $T$。通过选择最接近 $x(T)$ 的稳定平衡点来分配吸引子索引；如果没有稳定平衡点，则分配 -1。\n- 输出：对于每个案例，输出列表 $[\\text{num\\_eq},\\,\\text{num\\_stable},\\,\\text{bistable\\_flag},\\,\\text{equilibria\\_rounded},\\,\\text{attractor\\_indices}]$，并按规定将所有案例聚合为打印在单行上的一个列表。\n\n数值程序实现了这些步骤，遵循指定的测试套件，并生成所需的单行输出。",
            "answer": "[[3,2,1,[0.263884,0.840610,21.666667],[0,0,2,2,2,2]],[1,1,0,[0.084478],[0,0,0,0,0]],[3,2,1,[0.207865,0.706780,4.195156],[0,0,2,2,2]],[3,2,1,[0.205934,1.053787,5.186641],[0,0,2,2,2]]]"
        }
    ]
}