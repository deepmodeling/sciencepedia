{
    "hands_on_practices": [
        {
            "introduction": "任何基因回路的建模都始于对最基本单元的理解。本练习将引导你为组成型基因表达（即持续“开启”的基因）建立一个数学模型，并通过求解常微分方程（ODE）来计算其信使核糖核酸（mRNA）和蛋白质在细胞内的稳态浓度()。这项基础实践旨在巩固质量平衡原理，并让你直观地感受转录、翻译、降解和稀释等核心过程如何共同决定分子水平的最终产出。",
            "id": "3888639",
            "problem": "在细胞质充分混合和细胞指数生长的假设下，对一个细菌细胞系中的组成型单基因表达盒在群体平均浓度水平上进行建模。令 $m(t)$ 表示信使核糖核酸 (mRNA) 的浓度，令 $p(t)$ 表示蛋白质的浓度。该系统遵循一个基本原理，即对于每种物质，其浓度变化率等于生成速率减去损失速率。假设：\n- 转录以恒定的零级速率 $k_{\\text{tx}}$ （每个基因拷贝）产生 mRNA，单位为纳摩尔/分钟。\n- 翻译以一级速率 $k_{\\text{tl}} m(t)$ 产生蛋白质，其中 $k_{\\text{tl}}$ 的单位为 /分钟，$m(t)$ 是 mRNA 浓度。\n- mRNA 通过速率为 $\\gamma_m m(t)$ 的一级生化降解和比生长速率为 $\\mu$ 的细胞指数生长稀释而被移除；mRNA 的净一级损失速率为 $(\\gamma_m + \\mu) m(t)$。\n- 蛋白质通过速率为 $\\gamma_p p(t)$ 的一级生化降解和因生长而稀释而被移除；蛋白质的净一级损失速率为 $(\\gamma_p + \\mu) p(t)$。\n\n仅使用质量平衡和一级动力学作为建模基础，推导 $m(t)$ 和 $p(t)$ 的确定性常微分方程，然后计算在参数值 $k_{\\text{tx}} = 1$ nM min$^{-1}$，$k_{\\text{tl}} = 0.1$ min$^{-1}$，$\\gamma_m = 0.2$ min$^{-1}$，$\\gamma_p = 0.01$ min$^{-1}$ 和 $\\mu = 0.02$ min$^{-1}$ 下的唯一稳态浓度 $m^{\\ast}$ 和 $p^{\\ast}$。请用纳摩尔 (nM) 表示最终的数值答案，并将每个数值四舍五入到四位有效数字。将最终结果以单行向量 $\\big[m^{\\ast} \\;\\; p^{\\ast}\\big]$ 的形式报告。",
            "solution": "问题陈述经评估有效。其科学上基于生化动力学原理，提法恰当，有唯一且稳定的解，并以客观、明确的语言表述。所有必需的参数均已提供，其数值在物理上是合理的。因此，我们可以继续进行求解。\n\nmRNA 浓度 $m(t)$ 和蛋白质浓度 $p(t)$ 的动力学由常微分方程 (ODE) 决定，这些方程是根据质量平衡原理推导出来的。该原理指出，物质浓度的变化率等于其生成速率之和减去其损失速率之和。\n\n首先，我们建立 mRNA 浓度 $m(t)$ 的常微分方程。\nmRNA 的生成被描述为一个速率为 $k_{\\text{tx}}$ 的恒定零级过程。\nmRNA 的损失通过两个一级过程发生：速率常数为 $\\gamma_m$ 的酶促降解和比生长速率为 $\\mu$ 的细胞生长引起的稀释。因此，总损失速率为 $(\\gamma_m + \\mu)m(t)$。\n综合这些项，得到 $m(t)$ 的常微分方程为：\n$$\n\\frac{dm}{dt} = \\text{production} - \\text{loss} = k_{\\text{tx}} - (\\gamma_m + \\mu)m(t)\n$$\n\n接下来，我们建立蛋白质浓度 $p(t)$ 的常微分方程。\n蛋白质的生成（翻译）是一个一级过程，依赖于 mRNA 浓度，发生速率为 $k_{\\text{tl}}m(t)$。\n蛋白质的损失与 mRNA 类似，通过速率常数为 $\\gamma_p$ 的酶促降解和速率为 $\\mu$ 的细胞生长引起的稀释而发生。蛋白质的总损失速率为 $(\\gamma_p + \\mu)p(t)$。\n综合这些项，得到 $p(t)$ 的常微分方程为：\n$$\n\\frac{dp}{dt} = \\text{production} - \\text{loss} = k_{\\text{tl}}m(t) - (\\gamma_p + \\mu)p(t)\n$$\n\n问题要求计算唯一的稳态浓度，记为 $m^{\\ast}$ 和 $p^{\\ast}$。在稳态时，浓度不再随时间变化，这意味着它们的时间导数等于零。\n$$\n\\frac{dm}{dt} = 0 \\quad \\text{and} \\quad \\frac{dp}{dt} = 0\n$$\n\n将第一个常微分方程设为零，可以解出稳态 mRNA 浓度 $m^{\\ast}$：\n$$\n0 = k_{\\text{tx}} - (\\gamma_m + \\mu)m^{\\ast}\n$$\n$$\n(\\gamma_m + \\mu)m^{\\ast} = k_{\\text{tx}}\n$$\n$$\nm^{\\ast} = \\frac{k_{\\text{tx}}}{\\gamma_m + \\mu}\n$$\n\n类似地，将第二个常微分方程设为零，并用 $m^{\\ast}$ 替代 $m(t)$，可以解出稳态蛋白质浓度 $p^{\\ast}$：\n$$\n0 = k_{\\text{tl}}m^{\\ast} - (\\gamma_p + \\mu)p^{\\ast}\n$$\n$$\n(\\gamma_p + \\mu)p^{\\ast} = k_{\\text{tl}}m^{\\ast}\n$$\n$$\np^{\\ast} = \\frac{k_{\\text{tl}}m^{\\ast}}{\\gamma_p + \\mu}\n$$\n将 $m^{\\ast}$ 的表达式代入 $p^{\\ast}$ 的方程，我们得到一个完整的符号解：\n$$\np^{\\ast} = \\frac{k_{\\text{tl}}}{\\gamma_p + \\mu} \\left( \\frac{k_{\\text{tx}}}{\\gamma_m + \\mu} \\right) = \\frac{k_{\\text{tx}} k_{\\text{tl}}}{(\\gamma_m + \\mu)(\\gamma_p + \\mu)}\n$$\n\n现在，我们代入指定的数值参数值：\n$k_{\\text{tx}} = 1 \\text{ nM min}^{-1}$\n$k_{\\text{tl}} = 0.1 \\text{ min}^{-1}$\n$\\gamma_m = 0.2 \\text{ min}^{-1}$\n$\\gamma_p = 0.01 \\text{ min}^{-1}$\n$\\mu = 0.02 \\text{ min}^{-1}$\n\n首先，我们计算有效的一级损失速率常数：\nmRNA 的有效损失速率为 $\\gamma_m + \\mu = 0.2 \\text{ min}^{-1} + 0.02 \\text{ min}^{-1} = 0.22 \\text{ min}^{-1}$。\n蛋白质的有效损失速率为 $\\gamma_p + \\mu = 0.01 \\text{ min}^{-1} + 0.02 \\text{ min}^{-1} = 0.03 \\text{ min}^{-1}$。\n\n现在我们可以计算 $m^{\\ast}$ 的数值：\n$$\nm^{\\ast} = \\frac{k_{\\text{tx}}}{\\gamma_m + \\mu} = \\frac{1 \\text{ nM min}^{-1}}{0.22 \\text{ min}^{-1}} \\approx 4.54545... \\text{ nM}\n$$\n四舍五入到四位有效数字，我们得到 $m^{\\ast} = 4.545 \\text{ nM}$。\n\n接下来，我们计算 $p^{\\ast}$ 的数值：\n$$\np^{\\ast} = \\frac{k_{\\text{tx}} k_{\\text{tl}}}{(\\gamma_m + \\mu)(\\gamma_p + \\mu)} = \\frac{(1 \\text{ nM min}^{-1})(0.1 \\text{ min}^{-1})}{(0.22 \\text{ min}^{-1})(0.03 \\text{ min}^{-1})} = \\frac{0.1}{0.0066} \\text{ nM} \\approx 15.151515... \\text{ nM}\n$$\n四舍五入到四位有效数字，我们得到 $p^{\\ast} = 15.15 \\text{ nM}$。\n\n最终结果要求以单行向量 $[m^{\\ast} \\;\\; p^{\\ast}]$ 的形式报告。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.545  15.15\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "合成生物学的一个核心目标是构建具有特定功能的基因回路，例如实现细胞记忆或决策。基因开关是实现双稳态（即系统可以在两种稳定状态之间切换）的经典设计，是构建更复杂逻辑功能的基础()。通过这个练习，你将运用零增长线分析和线性稳定性理论，从根本上理解一个非线性系统是如何产生多重稳态的，并确定导致这种行为出现的关键参数阈值。",
            "id": "3888581",
            "problem": "一个合成开关由两个基因组成，这两个基因以匹配的参数和希尔型抑制方式相互抑制。考虑以下无量纲化的对称模型\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x,\\qquad \\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y,\n$$\n其中 $x$ 和 $y$ 表示无量纲的蛋白质浓度，$n$ 是希尔系数，$\\alpha0$ 是无量纲的最大合成速率。假设 $n=2$。仅从平衡点（$dx/dt=0$, $dy/dt=0$）、零斜线（$dx/dt=0$ 或 $dy/dt=0$ 的集合）以及通过在平衡点处求值的雅可比矩阵确定的线性稳定性的定义出发，使用零斜线几何和线性化方法来确定平衡点的数量和稳定性如何依赖于 $\\alpha$，并计算由于零斜线相切导致平衡点数量变化的 $\\alpha$ 的精确临界值。你的推导必须基于这些基础，不得使用任何快捷公式。\n\n将你的最终答案以行矩阵的形式报告，按顺序包含以下条目：\n- $N_{}$，$\\alpha$ 略小于临界值时的平衡点数量；\n- $N_{}$，$\\alpha$ 略大于临界值时的平衡点数量；\n- $S_{}$，$\\alpha$ 略大于临界值时的线性稳定平衡点数量；\n- $U_{}$，$\\alpha$ 略大于临界值时的鞍点型平衡点数量；\n- $\\alpha_{\\text{crit}}$，零斜线相切时的精确临界参数值。\n\n提供精确值，不要四舍五入。最终答案中不需要单位。按要求使用 LaTeX 的 $\\texttt{pmatrix}$ 环境将最终答案表示为单个行矩阵。",
            "solution": "本题要求分析一个合成基因开关模型的平衡点的数量和稳定性。分析必须基于零斜线几何和线性稳定性理论。\n\n无量纲化的常微分方程组如下：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{n}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{n}} - y\n$$\n其中希尔系数指定为 $n=2$。该系统变为：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1 + y^{2}} - x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1 + x^{2}} - y\n$$\n其中 $x$ 和 $y$ 是无量纲的蛋白质浓度且必须为非负，$\\alpha  0$。\n\n平衡点，或称稳态，是指浓度不随时间变化的點 $(x^*, y^*)$。这发生在两个时间导数均为零时：\n$$\n\\frac{dx}{dt} = 0 \\implies x^* = \\frac{\\alpha}{1 + (y^*)^{2}}\n$$\n$$\n\\frac{dy}{dt} = 0 \\implies y^* = \\frac{\\alpha}{1 + (x^*)^{2}}\n$$\n这些方程定义了系统的零斜线。$x$-零斜线是 $\\frac{dx}{dt}=0$ 的点集，由曲线 $x = \\frac{\\alpha}{1+y^2}$ 给出。$y$-零斜线是 $\\frac{dy}{dt}=0$ 的点集，由曲线 $y = \\frac{\\alpha}{1+x^2}$ 给出。平衡点是这两条零斜线的交点。\n\n该系统关于变量 $x$ 和 $y$ 的交换是对称的。这意味着如果 $(x^*, y^*)$ 是一个平衡点，那么 $(y^*, x^*)$ 也是。这种对称性保证了至少有一个平衡点必须位于对称线 $y=x$ 上。\n为了找到这样一个对称平衡点，我们在其中一个零斜线方程中设 $y=x$：\n$$\nx = \\frac{\\alpha}{1 + x^2}\n$$\n整理后得到一个关于对称平衡点浓度 $x$ 的三次方程：\n$$\nx(1 + x^2) = \\alpha \\implies x^3 + x - \\alpha = 0\n$$\n令 $f(x) = x^3 + x - \\alpha$。其导数为 $f'(x) = 3x^2 + 1$。因为 $x$ 代表浓度，$x$ 是实数，因此 $x^2 \\ge 0$。所以，对于所有实数 $x$，$f'(x)  0$。这意味着 $f(x)$ 是一个严格单调递增的函数。一个严格单调函数最多只能穿过横轴一次。此外，由于 $f(0) = -\\alpha  0$ 且 $\\lim_{x\\to\\infty} f(x) = \\infty$，必须存在且仅存在一个正实根，我们将其记为 $x_s$。因此，对于任何 $\\alpha  0$，都存在一个唯一的对称平衡点 $(x_s, x_s)$。\n\n当零斜线的相交模式发生质的变化时，平衡点的数量会发生改变。对于这个对称系统，这发生在两条零斜线彼此相切时。由于对称性，这种相切必然发生在对称线 $y=x$ 上，即在对称平衡点处。在相切点 $(x_c, y_c)$（其中 $x_c=y_c$）处，两条零斜线曲线的斜率必须相等。\n\n$y$-零斜线 $y(x) = \\frac{\\alpha}{1+x^2}$ 的斜率由其导数给出：\n$$\n\\frac{dy}{dx} = -\\frac{2\\alpha x}{(1+x^2)^2}\n$$\n$x$-零斜线 $x(y) = \\frac{\\alpha}{1+y^2}$ 是 $y$-零斜线关于直线 $y=x$ 的反射。它在 $(x,y)$ 平面上的斜率是 $(\\frac{dx}{dy})^{-1}$。在直线 $y=x$ 上的某一点，如果 $y$-零斜线的斜率是某个值 $m$，那么 $x$-零斜线的斜率将是 $1/m$。对于相切，我们可能会期望 $m = 1/m \\implies m = \\pm 1$。然而，这不是条件。在对称线 $y=x$ 之外产生或消失不动点（叉式分岔）的条件是，零斜线 $y(x)$ 在对称不动点处的斜率必须等于对称线垂线的斜率，即 $-1$。\n\n因此，相切的临界条件是在对称平衡点 $(x_c, x_c)$ 处 $\\frac{dy}{dx} = -1$。\n$$\n-\\frac{2\\alpha x_c}{(1+x_c^2)^2} = -1 \\implies 2\\alpha x_c = (1+x_c^2)^2\n$$\n这给出了一个关联临界参数 $\\alpha_{\\text{crit}}$ 和相应临界平衡浓度 $x_c$ 的方程。第二个方程是平衡条件本身，在临界点处求值：\n$$\n\\alpha_{\\text{crit}} = x_c(1+x_c^2)\n$$\n将 $\\alpha_{\\text{crit}}$ 的这个表达式代入相切条件中：\n$$\n2 [x_c(1+x_c^2)] x_c = (1+x_c^2)^2\n$$\n$$\n2x_c^2(1+x_c^2) = (1+x_c^2)^2\n$$\n由于 $x_c  0$，项 $(1+x_c^2)$ 非零，所以我们可以用它来除：\n$$\n2x_c^2 = 1+x_c^2 \\implies x_c^2 = 1\n$$\n由于浓度是非负的，我们取正根，$x_c=1$。\n将 $x_c=1$ 代回 $\\alpha_{\\text{crit}}$ 的方程中：\n$$\n\\alpha_{\\text{crit}} = 1 \\cdot (1+1^2) = 2\n$$\n所以，$\\alpha$ 的临界值是 $\\alpha_{\\text{crit}} = 2$。\n\n对于 $\\alpha  \\alpha_{\\text{crit}} = 2$，$y$-零斜线在对称平衡点处斜率的绝对值小于 $1$。零斜线仅相交一次。因此，有 $1$ 个平衡点。我们将此数量记为 $N_{}=1$。\n对于 $\\alpha  \\alpha_{\\text{crit}} = 2$，斜率的绝对值大于 $1$。这导致零斜线在直线 $y=x$ 的两侧额外相交于两点。因此，有 $3$ 个平衡点。我们将此数量记为 $N_{}=3$。\n\n接下来，我们使用系统的雅可比矩阵在每个平衡点处求值来分析这些平衡点的线性稳定性。雅可比矩阵 $J$ 是：\n$$\nJ(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1+y^2}-x)  \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1+y^2}-x) \\\\ \\frac{\\partial}{\\partial x}(\\frac{\\alpha}{1+x^2}-y)  \\frac{\\partial}{\\partial y}(\\frac{\\alpha}{1+x^2}-y) \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{2\\alpha y}{(1+y^2)^2} \\\\ -\\frac{2\\alpha x}{(1+x^2)^2}  -1 \\end{pmatrix}\n$$\n如果雅可比矩阵在该点求值后的所有特征值都具有负实部，则该平衡点是线性稳定的。如果迹 $\\text{tr}(J)  0$ 且行列式 $\\det(J)  0$，则可以保证这一点。\n\n我们来分析 $\\alpha  \\alpha_{\\text{crit}} = 2$ 时的稳定性。\n首先，考虑对称平衡点 $(x_s, x_s)$。这里，$x_s^3 + x_s - \\alpha = 0$。由于 $\\alpha  2$ 且函数 $f(x)=x^3+x$ 是递增的，所以 $x_s  1$。\n在 $(x_s, x_s)$ 处，雅可比矩阵为：\n$$\nJ(x_s, x_s) = \\begin{pmatrix} -1  -\\frac{2\\alpha x_s}{(1+x_s^2)^2} \\\\ -\\frac{2\\alpha x_s}{(1+x_s^2)^2}  -1 \\end{pmatrix}\n$$\n迹为 $\\text{tr}(J) = -2  0$。\n行列式为 $\\det(J) = 1 - \\left(\\frac{2\\alpha x_s}{(1+x_s^2)^2}\\right)^2$。\n使用平衡条件 $\\alpha = x_s(1+x_s^2)$，我们可以重写非对角线项的绝对值：\n$$\n\\left|\\frac{2\\alpha x_s}{(1+x_s^2)^2}\\right| = \\frac{2x_s(1+x_s^2)x_s}{(1+x_s^2)^2} = \\frac{2x_s^2}{1+x_s^2}\n$$\n由于 $x_s  1$，我们有 $x_s^2  1$。令 $u=x_s^2  1$。那么 $\\frac{2u}{1+u}  1$ 因为 $2u  1+u \\iff u1$。\n因此，非对角线项的绝对值大于 $1$。\n这意味着 $\\det(J) = 1 - (\\frac{2x_s^2}{1+x_s^2})^2  0$。\n一个行列式为负的平衡点有一个正特征值和一个负特征值，这对应于一个鞍点。鞍点是不稳定的。因此，对于 $\\alpha  2$，有 $1$ 个鞍点型平衡点，$U_{} = 1$。\n\n现在，考虑两个非对称平衡点 $(x_a, y_a)$ 和 $(y_a, x_a)$，它们存在于 $\\alpha  2$ 的情况。\n在非对称点 $(x_a, y_a)$ 处，雅可比矩阵的迹同样是 $\\text{tr}(J) = -2  0$。\n行列式为：\n$$\n\\det(J) = 1 - \\left(-\\frac{2\\alpha y_a}{(1+y_a^2)^2}\\right)\\left(-\\frac{2\\alpha x_a}{(1+x_a^2)^2}\\right) = 1 - \\frac{4\\alpha^2 x_a y_a}{(1+x_a^2)^2(1+y_a^2)^2}\n$$\n使用平衡条件 $y_a = \\frac{\\alpha}{1+x_a^2}$ 和 $x_a = \\frac{\\alpha}{1+y_a^2}$：\n$$\n\\det(J) = 1 - \\frac{4 (y_a(1+x_a^2)) (x_a(1+y_a^2)) x_a y_a}{(1+x_a^2)^2(1+y_a^2)^2} = 1 - \\frac{4x_a^2 y_a^2}{(1+x_a^2)(1+y_a^2)}\n$$\n非对称平衡点是通过超临界叉式分岔产生的，在该分岔中，对称平衡点失去稳定性。分支出来的两个新平衡点是稳定的。这意味着对于这些点，$\\det(J)  0$。\n为了确认，当复合映射 $\\phi(x) = \\frac{\\alpha}{1+(\\alpha/(1+x^2))^2}$ 在对称不动点处的斜率为 $1$ 时，发生分岔。对于新出现的稳定不动点，其斜率必须小于 $1$。斜率为 $\\phi'(x) = g'(g(x))g'(x)$，其中 $g(x) = \\frac{\\alpha}{1+x^2}$。在非对称不动点 $(x_a, y_a)$ 处，$y_a=g(x_a)$，所以 $\\phi'(x_a) = g'(y_a)g'(x_a)$。\n雅可比矩阵在 $(x_a,y_a)$ 处的行列式可以证明为 $1-\\phi'(x_a)$。由于对于新出现的稳定分支，$\\phi'(x_a)  1$，我们有 $\\det(J)  0$。\n在 $\\text{tr}(J) = -2  0$ 和 $\\det(J)  0$ 的条件下，特征值具有负实部。因此，这两个非对称平衡点是线性稳定的。稳定平衡点的数量是 $S_{} = 2$。\n\n总结结果：\n- 对于 $\\alpha  \\alpha_{\\text{crit}}$，平衡点数量 $N_{} = 1$。\n- 对于 $\\alpha  \\alpha_{\\text{crit}}$，平衡点数量 $N_{} = 3$。\n- 对于 $\\alpha  \\alpha_{\\text{crit}}$，稳定平衡点数量 $S_{} = 2$。\n- 对于 $\\alpha  \\alpha_{\\text{crit}}$，鞍点平衡点数量 $U_{} = 1$。\n- 临界值为 $\\alpha_{\\text{crit}} = 2$。\n\n最终答案由这五个值按指定顺序组成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  3  2  1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的细胞环境中，合成基因回路并非孤立运行，它们会消耗宿主细胞的共享资源（如核糖体），从而产生“负担”并影响细胞健康与回路性能。因此，优秀的电路设计必须在最大化产出的同时管理这种负担()。这项练习将你置于一个真实的工程设计场景中，要求你构建并求解一个优化问题，以在保证细胞健康（通过维持足够的游离核糖体水平）的前提下，通过合理分配启动子和核糖体结合位点（RBS）的强度来最大化目标蛋白的产量。",
            "id": "3888577",
            "problem": "您需要为一个合成多基因回路构建并求解一个优化问题。在该问题中，通过分配启动子强度和核糖体结合位点强度来最大化蛋白质产出，同时确保细胞负荷（以游离核糖体衡量）保持在指定的阈值以下。该场景建模如下。\n\n基于分子生物学中心法则和细胞内标准资源分配的基本建模假设：\n- 转录以与启动子强度成正比的速率产生信使核糖核酸 (mRNA)。对于基因索引 $i \\in \\{1,\\dots,N\\}$，mRNA 的生产速率为 $m_i = \\alpha \\, p_i$，其中 $p_i$ 是启动子强度，$\\alpha$ 是每个基因的比例常数。\n- 翻译起始取决于核糖体结合位点 (RBS) 强度和游离核糖体池。对于基因 $i$，核糖体负载由一个关于游离核糖体的类米氏-孟顿项建模：基因 $i$ 贡献的核糖体负载为 $L_i = m_i \\, r_i \\, \\dfrac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$，其中 $r_i$ 是 RBS 强度，$R_{\\mathrm{free}}$ 是可用于起始的游离核糖体浓度，$K_R$ 是核糖体结合的有效米氏常数。\n- 总核糖体遵守一个守恒约束：$R_{\\mathrm{free}} = R_{\\mathrm{tot}} - \\sum_{i=1}^{N} L_i$，其中 $R_{\\mathrm{tot}}$ 是总核糖体浓度。\n- 回路的瞬时产出速率（总蛋白质生产速率）为 $Y = \\gamma \\sum_{i=1}^{N} L_i$，其中 $\\gamma$ 是一个平均延伸-产出比例常数。\n\n设计变量和约束：\n- 设计变量是启动子强度 $\\{p_i\\}_{i=1}^{N}$ 和核糖体结合位点强度 $\\{r_i\\}_{i=1}^{N}$。\n- 对每个基因 $i$ 施加下界和上界：$p_{\\min} \\le p_i \\le p_{\\max}$ 和 $r_{\\min} \\le r_i \\le r_{\\max}$。\n- 负荷约束以最小游离核糖体阈值的形式施加：$R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$，其中 $R_{\\mathrm{thr}}$ 是指定的。\n- 所有量均为无量纲的速率或浓度，不需要物理单位。\n\n目标：\n- 在约束条件下，对 $\\{p_i\\}$ 和 $\\{r_i\\}$ 的所有可行分配，最大化 $Y$。\n\n您的程序必须计算以下每个测试用例的 $Y$ 的最优值。如果在下界 $p_{\\min}$ 和 $r_{\\min}$ 下不存在满足 $R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$ 的可行分配，您的程序必须为该测试用例输出值 $-1.0$。否则，将最优的 $Y$ 作为十进制数输出。最终输出必须是单行，包含一个由方括号括起来的逗号分隔的结果列表。\n\n测试套件（每个测试用例是一个元组 $(N,\\alpha,\\gamma,R_{\\mathrm{tot}},K_R,p_{\\min},p_{\\max},r_{\\min},r_{\\max},R_{\\mathrm{thr}})$）：\n- 用例 1：$(\\;10,\\;1.0,\\;2.0,\\;100.0,\\;10.0,\\;0.0,\\;5.0,\\;0.0,\\;5.0,\\;20.0\\;)$\n- 用例 2：$(\\;5,\\;1.0,\\;1.0,\\;30.0,\\;5.0,\\;1.0,\\;3.0,\\;2.0,\\;4.0,\\;28.0\\;)$\n- 用例 3：$(\\;3,\\;1.0,\\;1.5,\\;100.0,\\;10.0,\\;0.0,\\;1.0,\\;0.0,\\;1.0,\\;20.0\\;)$\n- 用例 4：$(\\;1,\\;0.5,\\;3.0,\\;10.0,\\;2.0,\\;0.0,\\;3.0,\\;0.0,\\;3.0,\\;5.0\\;)$\n- 用例 5：$(\\;4,\\;0.7,\\;2.5,\\;50.0,\\;5.0,\\;0.0,\\;2.0,\\;0.0,\\;3.0,\\;50.0\\;)$\n\n输出规范：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的结果列表（例如，$[\\;y_1,y_2,y_3,y_4,y_5\\;]$，其中每个 $y_k$ 是一个十进制数或 $-1.0$）。\n- 不使用角度；不使用百分比；数值答案以十进制形式报告。",
            "solution": "用户提供了一个与合成基因回路设计相关的约束优化问题。第一步是验证问题陈述。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n问题提供了以下模型、变量、约束和目标：\n- **模型方程：**\n    - mRNA 生产速率：对每个基因 $i \\in \\{1,\\dots,N\\}$，$m_i = \\alpha \\, p_i$。\n    - 每个基因的核糖体负载：$L_i = m_i \\, r_i \\, \\dfrac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$。\n    - 核糖体守恒：$R_{\\mathrm{free}} = R_{\\mathrm{tot}} - \\sum_{i=1}^{N} L_i$。\n    - 总蛋白质产出速率：$Y = \\gamma \\sum_{i=1}^{N} L_i$。\n- **设计变量：**\n    - 启动子强度 $\\{p_i\\}_{i=1}^{N}$。\n    - 核糖体结合位点 (RBS) 强度 $\\{r_i\\}_{i=1}^{N}$。\n- **约束：**\n    - 变量边界：对所有 $i$，$p_{\\min} \\le p_i \\le p_{\\max}$ 和 $r_{\\min} \\le r_i \\le r_{\\max}$。\n    - 负荷约束：$R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$。\n- **目标：** 最大化总产出 $Y$。\n- **测试数据：** 一套包含五个测试用例的套件，为参数 $(N, \\alpha, \\gamma, R_{\\mathrm{tot}}, K_R, p_{\\min}, p_{\\max}, r_{\\min}, r_{\\max}, R_{\\mathrm{thr}})$ 提供了具体值。\n- **特殊条件：** 如果不存在可行分配，该用例的输出应为 $-1.0$。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学依据：** 该模型使用了在系统生物学和合成生物学文献中常见的基因表达和资源竞争（细胞负荷）的简化但标准的公式。核糖体的守恒和类 Michaelis–Menten 饱和动力学是此背景下已确立的原则。该问题是一个资源感知回路设计问题的现实（尽管是简化的）表示。\n- **适定性：** 该问题是一个定义明确的非线性约束优化问题。目标函数（$Y$）明确陈述，所有约束在数学上都是精确的。可以确定 $Y$ 的最大值的存在性和唯一性。\n- **客观性：** 语言是形式化和定量的，没有任何主观或基于意见的陈述。\n- **完整性与一致性：** 该问题是自洽的。为每个测试用例提供了解决问题所需的所有必要参数。给定的方程和约束之间没有矛盾。\n\n**第3步：结论与行动**\n\n该问题是**有效的**。这是一个适定的、具有科学相关性的优化问题。我现在将着手构建并实施解决方案。\n\n### 基于原理的设计与求解\n\n目标是最大化总蛋白质生产速率 $Y$。令 $L_{\\mathrm{tot}} = \\sum_{i=1}^{N} L_i$ 为总核糖体负载。目标函数可以写成 $Y = \\gamma L_{\\mathrm{tot}}$。由于 $\\gamma$ 是一个正常数，最大化 $Y$ 等同于最大化 $L_{\\mathrm{tot}}$。\n\n我们可以用设计变量来表示 $L_{\\mathrm{tot}}$。\n$L_{\\mathrm{tot}} = \\sum_{i=1}^{N} m_i r_i \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}} = \\sum_{i=1}^{N} (\\alpha p_i) r_i \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}} = \\alpha \\left(\\sum_{i=1}^{N} p_i r_i\\right) \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$。\n\n我们定义一个复合变量 $S = \\sum_{i=1}^{N} p_i r_i$，它代表了回路的总“强度”。$L_{\\mathrm{tot}}$ 的表达式变为：\n$L_{\\mathrm{tot}} = \\alpha S \\frac{R_{\\mathrm{free}}}{K_R + R_{\\mathrm{free}}}$。\n\n使用核糖体守恒定律 $R_{\\mathrm{free}} = R_{\\mathrm{tot}} - L_{\\mathrm{tot}}$，我们可以代入 $R_{\\mathrm{free}}$ 以获得一个仅含 $L_{\\mathrm{tot}}$ 和 $S$ 的方程：\n$L_{\\mathrm{tot}} = \\alpha S \\frac{R_{\\mathrm{tot}} - L_{\\mathrm{tot}}}{K_R + R_{\\mathrm{tot}} - L_{\\mathrm{tot}}}$。\n\n重新整理后得到一个关于 $L_{\\mathrm{tot}}$ 的二次方程：\n$L_{\\mathrm{tot}}(K_R + R_{\\mathrm{tot}} - L_{\\mathrm{tot}}) = \\alpha S (R_{\\mathrm{tot}} - L_{\\mathrm{tot}})$\n$L_{\\mathrm{tot}}^2 - (K_R + R_{\\mathrm{tot}} + \\alpha S)L_{\\mathrm{tot}} + \\alpha S R_{\\mathrm{tot}} = 0$。\n\n使用二次公式求解 $L_{\\mathrm{tot}}$ 会得到两个根。物理上有意义的解是当 $S \\to 0$ 时趋近于 $0$ 的那个解：\n$L_{\\mathrm{tot}}(S) = \\frac{(K_R + R_{\\mathrm{tot}} + \\alpha S) - \\sqrt{(K_R + R_{\\mathrm{tot}} + \\alpha S)^2 - 4 \\alpha S R_{\\mathrm{tot}}}}{2}$。\n\n通过对 $S$ 求 $L_{\\mathrm{tot}}$ 的导数，可以证明 $L_{\\mathrm{tot}}(S)$ 是 $S$ 的单调递增函数。因此，最大化 $L_{\\mathrm{tot}}$ 等同于最大化 $S$。\n\n现在优化问题被重新表述为：在给定约束条件下，最大化 $S = \\sum_{i=1}^{N} p_i r_i$。\n为了最大化乘积之和 $\\sum p_i r_i$，我们应该为每个 $p_i$ 和 $r_i$ 选择可能的最大值，即对所有 $i$ 都有 $p_i = p_{\\max}$ 和 $r_i = r_{\\max}$。令这个最大可能强度为 $S_{\\max} = N \\cdot p_{\\max} \\cdot r_{\\max}$。\n\n然而，这受到负荷要求的约束：$R_{\\mathrm{free}} \\ge R_{\\mathrm{thr}}$，这转化为 $R_{\\mathrm{tot}} - L_{\\mathrm{tot}} \\ge R_{\\mathrm{thr}}$，或 $L_{\\mathrm{tot}} \\le R_{\\mathrm{tot}} - R_{\\mathrm{thr}}$。令 $L_{\\mathrm{max\\_allowed}} = R_{\\mathrm{tot}} - R_{\\mathrm{thr}}$。\n\n求解策略如下：\n1.  首先，检查可行性。可能的最小电路强度是 $S_{\\min} = N \\cdot p_{\\min} \\cdot r_{\\min}$。计算在此最小强度下的核糖体负载 $L_{\\mathrm{tot}}(S_{\\min})$。如果这个最小负载已经违反了负荷约束，即 $L_{\\mathrm{tot}}(S_{\\min})  L_{\\mathrm{max\\_allowed}}$，那么就不存在可行解。在这种情况下，输出为 $-1.0$。\n\n2.  如果最小表达是可行的，我们确定可实现的最大产出。计算在最大可能电路强度下的负载 $L_{\\mathrm{tot}}(S_{\\max})$。\n    -   如果 $L_{\\mathrm{tot}}(S_{\\max}) \\le L_{\\mathrm{max\\_allowed}}$，系统不受负荷限制。最优策略是对所有基因使用最大可能强度（$p_i=p_{\\max}, r_i=r_{\\max}$）。最优负载为 $L_{\\mathrm{opt}} = L_{\\mathrm{tot}}(S_{\\max})$，最大产出为 $Y_{\\mathrm{opt}} = \\gamma L_{\\mathrm{opt}}$。\n    -   如果 $L_{\\mathrm{tot}}(S_{\\max})  L_{\\mathrm{max\\_allowed}}$，系统受负荷限制。当电路恰好在负荷阈值上运行时，达到最大产出，这意味着核糖体负载被限制在其允许的最大值 $L_{\\mathrm{opt}} = L_{\\mathrm{max\\_allowed}}$。可以找到一个介于 $S_{\\min}$ 和 $S_{\\max}$ 之间的电路强度 $S$ 来实现这个负载。那么最大产出为 $Y_{\\mathrm{opt}} = \\gamma L_{\\mathrm{opt}} = \\gamma(R_{\\mathrm{tot}} - R_{\\mathrm{thr}})$。\n\n该逻辑为解决任何给定参数集下的问题提供了一个完整的算法。",
            "answer": "[160.0, -1.0, 4.3414811161, 10.3429355646, 0.0]"
        }
    ]
}