{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习旨在将生物化学反应转化为数学框架。你将学习如何手动构建化学计量矩阵（$S$），并利用其零空间的维度来确定网络在稳态（$S \\boldsymbol{v} = \\boldsymbol{0}$）下的内在灵活性，这是分析任何代谢系统的关键第一步。",
            "id": "3901613",
            "problem": "给定一个涉及糖酵解和发酵步骤的胞质子网络，其化学计量系数已明确给出。化学计量矩阵 $S$ 根据质量平衡定义 $\\frac{d\\boldsymbol{x}}{dt} = S \\boldsymbol{v}$ 将反应通量映射到代谢物积累速率，其中 $\\boldsymbol{x}$ 是代谢物浓度向量，$\\boldsymbol{v}$ 是反应通量向量。在一个没有交换通量的均质、封闭室中，稳态意味着 $\\frac{d\\boldsymbol{x}}{dt} = \\boldsymbol{0}$。\n\n对 $S$ 的行使用以下代谢物顺序：\n- $\\mathrm{PEP}$ (磷酸烯醇式丙酮酸),\n- $\\mathrm{Pyruvate}$ (丙酮酸),\n- $\\mathrm{Lactate}$ (乳酸),\n- $\\mathrm{NAD}^{+}$ (氧化型烟酰胺腺嘌呤二核苷酸),\n- $\\mathrm{NADH}$ (还原型烟酰胺腺嘌呤二核苷酸),\n- $\\mathrm{ATP}$ (三磷酸腺苷),\n- $\\mathrm{ADP}$ (二磷酸腺苷),\n- $\\mathrm{Pi}$ (无机磷酸盐),\n- $\\mathrm{H}^{+}$ (氢离子)。\n\n反应列（按 $R_{1}$ 到 $R_{5}$ 的顺序）由以下化学上合理的反应定义，并标明了化学计量系数。使用符号约定，反应物带有负的化学计量项，生成物带有正的化学计量项。\n- $R_{1}$: $\\mathrm{PEP} + \\mathrm{ADP} \\to \\mathrm{Pyruvate} + \\mathrm{ATP}$。\n- $R_{2}$: $\\mathrm{Pyruvate} + \\mathrm{NADH} + \\mathrm{H}^{+} \\to \\mathrm{Lactate} + \\mathrm{NAD}^{+}$。\n- $R_{3}$: $\\mathrm{ATP} \\to \\mathrm{ADP} + \\mathrm{Pi} + \\mathrm{H}^{+}$ (水是充足的且不被追踪)。\n- $R_{4}$: $\\mathrm{ADP} + \\mathrm{Pi} + \\mathrm{H}^{+} \\to \\mathrm{ATP}$。\n- $R_{5}$: $\\mathrm{Lactate} + \\mathrm{NAD}^{+} \\to \\mathrm{Pyruvate} + \\mathrm{NADH} + \\mathrm{H}^{+}$。\n\n任务：\n1. 通过将上述代谢物顺序作为行，并根据反应定义用相应的带符号的化学计量系数填充每一列 $R_{j}$，来构建化学计量矩阵 $S$。\n2. 对于每一列，通过明确检查所有反应物都具有负项而所有生成物都具有正项来验证符号约定。\n3. 使用质量平衡定义和封闭系统的稳态假设，确定与此网络一致的反应通量向量中的独立自由度数。将此数值报告为单个整数。最终答案无需四舍五入或单位。",
            "solution": "该问题要求确定稳态下代谢网络中的独立自由度数。这个量等价于化学计量矩阵 $S$ 的零空间的维度。分析过程分为两个主要步骤：首先，根据提供的反应定义构建矩阵 $S$；其次，计算其零空间的维度。\n\n该系统由质量平衡方程 $\\frac{d\\boldsymbol{x}}{dt} = S \\boldsymbol{v}$ 描述，其中 $\\boldsymbol{x}$ 是代谢物浓度向量，$\\boldsymbol{v}$ 是反应通量向量。在稳态下，代谢物的浓度是恒定的，所以 $\\frac{d\\boldsymbol{x}}{dt} = \\boldsymbol{0}$。这导出了线性方程组 $S \\boldsymbol{v} = \\boldsymbol{0}$。通量向量 $\\boldsymbol{v}$ 中的独立自由度数是满足该方程的线性无关向量 $\\boldsymbol{v}$ 的数量，这正是 $S$ 的零空间的维度，记为 $\\text{dim}(\\text{Null}(S))$。\n\n**步骤 1：构建化学计量矩阵 $S$**\n\n矩阵 $S$ 的维度为 $m \\times n$，其中 $m=9$ 是代谢物的数量， $n=5$ 是反应的数量。行对应于指定顺序的代谢物：$\\mathrm{PEP}$、$\\mathrm{Pyruvate}$、$\\mathrm{Lactate}$、$\\mathrm{NAD}^{+}$、$\\mathrm{NADH}$、$\\mathrm{ATP}$、$\\mathrm{ADP}$、$\\mathrm{Pi}$、$\\mathrm{H}^{+}$。列对应于反应 $R_1$ 到 $R_5$。矩阵的条目是化学计量系数，反应物被赋予负号，生成物被赋予正号。\n\n反应 $R_1$: $\\mathrm{PEP} + \\mathrm{ADP} \\to \\mathrm{Pyruvate} + \\mathrm{ATP}$\n$R_1$ 的列向量是通过为反应物（$\\mathrm{PEP}$、$\\mathrm{ADP}$）分配系数 $-1$ 和为生成物（$\\mathrm{Pyruvate}$、$\\mathrm{ATP}$）分配系数 $+1$ 来构建的。所有其他代谢物系数均为 $0$。\n$$ \\boldsymbol{s}_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n反应 $R_2$: $\\mathrm{Pyruvate} + \\mathrm{NADH} + \\mathrm{H}^{+} \\to \\mathrm{Lactate} + \\mathrm{NAD}^{+}$\n反应物（$\\mathrm{Pyruvate}$、$\\mathrm{NADH}$、$\\mathrm{H}^{+}$）获得系数 $-1$，生成物（$\\mathrm{Lactate}$、$\\mathrm{NAD}^{+}$）获得系数 $+1$。\n$$ \\boldsymbol{s}_2 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ 1 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix} $$\n\n反应 $R_3$: $\\mathrm{ATP} \\to \\mathrm{ADP} + \\mathrm{Pi} + \\mathrm{H}^{+}$\n反应物（$\\mathrm{ATP}$）获得系数 $-1$，生成物（$\\mathrm{ADP}$、$\\mathrm{Pi}$、$\\mathrm{H}^{+}$）获得系数 $+1$。\n$$ \\boldsymbol{s}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\n\n反应 $R_4$: $\\mathrm{ADP} + \\mathrm{Pi} + \\mathrm{H}^{+} \\to \\mathrm{ATP}$\n这是 $R_3$ 的逆反应。反应物（$\\mathrm{ADP}$、$\\mathrm{Pi}$、$\\mathrm{H}^{+}$）获得系数 $-1$，生成物（$\\mathrm{ATP}$）获得系数 $+1$。\n$$ \\boldsymbol{s}_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ -1 \\\\ -1 \\\\ -1 \\end{pmatrix} $$\n\n反应 $R_5$: $\\mathrm{Lactate} + \\mathrm{NAD}^{+} \\to \\mathrm{Pyruvate} + \\mathrm{NADH} + \\mathrm{H}^{+}$\n与 $R_2$ 不同，该反应将 $\\mathrm{H}^{+}$ 指定为生成物。反应物（$\\mathrm{Lactate}$、$\\mathrm{NAD}^{+}$）获得系数 $-1$，生成物（$\\mathrm{Pyruvate}$、$\\mathrm{NADH}$、$\\mathrm{H}^{+}$）获得系数 $+1$。\n$$ \\boldsymbol{s}_5 = \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\\\ -1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n\n结合这些列向量，完整的化学计量矩阵 $S$ 为：\n$$ S = \\begin{pmatrix} -1 & 0 & 0 & 0 & 0 \\\\ 1 & -1 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 & -1 \\\\ 0 & 1 & 0 & 0 & -1 \\\\ 0 & -1 & 0 & 0 & 1 \\\\ 1 & 0 & -1 & 1 & 0 \\\\ -1 & 0 & 1 & -1 & 0 \\\\ 0 & 0 & 1 & -1 & 0 \\\\ 0 & -1 & 1 & -1 & 1 \\end{pmatrix} $$\n在构建过程中，已对每一列的符号约定进行了验证。\n\n**步骤 2：确定自由度**\n\n自由度数为 $\\text{dim}(\\text{Null}(S))$。根据秩-零度定理，对于一个有 $n$ 列的矩阵 $S$，我们有：\n$$ \\text{dim}(\\text{Null}(S)) + \\text{rank}(S) = n $$\n这里，$n=5$（反应数）。因此，自由度数为 $5 - \\text{rank}(S)$。我们必须确定 $S$ 的秩，即线性无关列的数量。\n\n让我们检查 $S$ 的列是否存在线性相关性。\n比较列 $\\boldsymbol{s}_3$ 和 $\\boldsymbol{s}_4$：\n$$ \\boldsymbol{s}_3 + \\boldsymbol{s}_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ -1 \\\\ -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n因此，$\\boldsymbol{s}_3 + \\boldsymbol{s}_4 = \\boldsymbol{0}$，这意味着它们是线性相关的。反应 $R_4$ 是 $R_3$ 的精确逆反应。\n\n比较列 $\\boldsymbol{s}_2$ 和 $\\boldsymbol{s}_5$：\n$$ \\boldsymbol{s}_2 + \\boldsymbol{s}_5 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ 1 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\\\ -1 \\\\ -1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n因此，$\\boldsymbol{s}_2 + \\boldsymbol{s}_5 = \\boldsymbol{0}$，表明存在另一个线性相关性。反应 $R_5$ 在化学计量上是 $R_2$ 的逆反应。\n\n由于这两个相关性，五个列向量的集合 $\\{\\boldsymbol{s}_1, \\boldsymbol{s}_2, \\boldsymbol{s}_3, \\boldsymbol{s}_4, \\boldsymbol{s}_5\\}$ 与集合 $\\{\\boldsymbol{s}_1, \\boldsymbol{s}_2, \\boldsymbol{s}_3\\}$ 张成相同的空间。$S$ 的秩是这个较小集合中线性无关向量的数量。为了检查它们的独立性，我们求解方程 $c_1 \\boldsymbol{s}_1 + c_2 \\boldsymbol{s}_2 + c_3 \\boldsymbol{s}_3 = \\boldsymbol{0}$ 以得到标量 $c_1, c_2, c_3$。\n\n将其写成矩阵形式：\n$$ \\begin{pmatrix} -1 & 0 & 0 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & -1 & 0 \\\\ 1 & 0 & -1 \\\\ -1 & 0 & 1 \\\\ 0 & 0 & 1 \\\\ 0 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n从第一行（对应于 $\\mathrm{PEP}$），我们得到 $-1 \\cdot c_1 + 0 \\cdot c_2 + 0 \\cdot c_3 = 0$，这意味着 $c_1 = 0$。\n将 $c_1 = 0$ 代入系统，第二行（对于 $\\mathrm{Pyruvate}$）给出 $0 - 1 \\cdot c_2 + 0 \\cdot c_3 = 0$，这意味着 $c_2 = 0$。\n将 $c_1=0$ 和 $c_2=0$ 代入系统，第八行（对于 $\\mathrm{Pi}$）给出 $0 \\cdot c_1 + 0 \\cdot c_2 + 1 \\cdot c_3 = 0$，这意味着 $c_3 = 0$。\n\n因为唯一的解是 $c_1 = c_2 = c_3 = 0$，所以向量 $\\boldsymbol{s}_1, \\boldsymbol{s}_2, \\boldsymbol{s}_3$ 是线性无关的。因此，矩阵 $S$ 的秩为 $3$。\n$$ \\text{rank}(S) = 3 $$\n\n现在，使用秩-零度定理，我们可以找到零空间的维度：\n$$ \\text{dim}(\\text{Null}(S)) = n - \\text{rank}(S) = 5 - 3 = 2 $$\n反应通量向量中的独立自由度数为 $2$。这对应于两个独立的途径或循环，它们可以在稳态下携带净通量。在这种情况下，它们对应于可逆反应对 $(R_2, R_5)$ 和 $(R_3, R_4)$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "在理解了化学计量矩阵的结构之后，本练习将重点转向寻找一个具体的、具有生物学意义的解。你将为一个小型网络计算一个满足 $S\\boldsymbol{v} = \\boldsymbol{0}$ 和不可逆性约束的稳态通量向量 $\\boldsymbol{v}$，并将其解读为一个功能性的代谢途径，从而在抽象的线性代数与细胞功能之间建立起坚实的联系。",
            "id": "3901625",
            "problem": "考虑一个最小的内代谢网络，该网络仅由三个胞内代謝物 $X_1$、$X_2$ 和 $X_3$ 组成，它们通过三个不可逆反应 $R_1$、$R_2$ 和 $R_3$ 连接，化学计量如下：\n- $R_1$：$3 X_1 \\rightarrow 2 X_2$，\n- $R_2$：$X_2 \\rightarrow 3 X_3$，\n- $R_3$：$2 X_3 \\rightarrow X_1$。\n\n假设系统处于稳态胞内平衡，与环境沒有物质交换（所有通量均为内部通量），且反应均沿正向不可逆。化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$ 的行按 $(X_1, X_2, X_3)$ 排序，列按 $(R_1, R_2, R_3)$ 排序，其元素根据标准符号约定定义（消耗为负，生产为正）：\n$$\nS \\;=\\;\n\\begin{pmatrix}\n-3 & 0 & 1 \\\\\n2 & -1 & 0 \\\\\n0 & 3 & -2\n\\end{pmatrix}.\n$$\n设通量向量为 $v = (v_1, v_2, v_3)^{\\top}$，其中每个 $v_i$ 表示反应 $R_i$ 的速率，单位为毫摩尔每克干重每小时 (mmol per grams dry weight per hour, mmol/(gDW\\cdot h))。在稳态下，胞内质量守恒要求平衡关系 $S v = 0$，不可逆性要求 $v_i \\geq 0$ (其中 $i \\in \\{1,2,3\\}$)。\n\n从稳态下的胞内质量守恒原理和化学计量矩阵的定义出发，计算一个满足 $S v = 0$ 和 $v_i \\geq 0$ 的非平凡通量向量 $v$。报告其原始正整数通量向量，定义为缩放到最小正整数的正向不可逆零空间向量。最终通量以 mmol/(gDW\\cdot h) 为单位表示。本问题无需四舍五入。最后，根据稳态代谢物守恒平衡以及该通量模式实现的内部途径的定性结构，解释所得的内部途径，并在首次使用时引用基本通量模式 (Elementary Flux Mode, EFM) 的概念。",
            "solution": "用户提供了一个关于代谢网络化学计量学的问题。第一步是验证问题陈述。\n\n### 步骤1：提取已知条件\n- **代谢物：** 三种胞内代谢物，记为 $X_1$、$X_2$ 和 $X_3$。\n- **反应：** 三个不可逆反应 $R_1$、$R_2$ 和 $R_3$。\n- **反应化学计量：**\n  - $R_1$：$3 X_1 \\rightarrow 2 X_2$\n  - $R_2$：$X_2 \\rightarrow 3 X_3$\n  - $R_3$：$2 X_3 \\rightarrow X_1$\n- **系统条件：**\n  - 稳态胞内平衡。\n  - 与环境无物质交换（封闭系统）。\n  - 所有反应均沿正向不可逆。\n- **化学计量矩阵 ($S$)：**\n$$ S = \\begin{pmatrix} -3 & 0 & 1 \\\\ 2 & -1 & 0 \\\\ 0 & 3 & -2 \\end{pmatrix} $$\n  行对应代谢物 $(X_1, X_2, X_3)$，列对应反应 $(R_1, R_2, R_3)$。\n- **通量向量 ($v$)：** $v = (v_1, v_2, v_3)^{\\top}$，其中 $v_i$ 是反应 $R_i$ 的速率。\n- **约束条件：**\n  - 稳态质量平衡：$S v = 0$。\n  - 不可逆性：$v_i \\geq 0$ (其中 $i \\in \\{1, 2, 3\\}$)。\n- **目标：**\n  1. 计算一个满足给定约束的非平凡通量向量 $v$。\n  2. 将结果报告为原始正整数通量向量（缩放到最小正整数）。\n  3. 解释所得内部途径，包括代谢物平衡及其结构，并引用基本通量模式 (EFM) 的概念。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地基于化学反应网络中的质量守恒原理，这是系统生物学、生物化学和化学工程中的一个基本概念。使用化学计量矩阵和通量向量的表述是代谢通量分析的标准方法。\n- **适定性：** 这是一个适定问题。它提供了所有必要的信息：化学计量矩阵 $S$ 和对通量向量 $v$ 的约束。它要求在 $S$ 的零空间中找到一个同时满足非负约束的向量。“原始正整数”形式的要求确保了答案的唯一性。\n- **客观性：** 该问题使用精确、客观的数学语言陈述。它不含任何主观性或观点。\n- **完整性与一致性：** 该问题是自洽的，所提供的信息内部一致。化学计量矩阵 $S$ 正确地表示了给定的反应方程式。\n- **其他标准：** 该问题不违反任何其他验证标准。它是其领域内一个标准的、可形式化的、非平凡的问题。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 求解过程\n问题的核心是找到一个非平凡向量 $v = (v_1, v_2, v_3)^{\\top}$，它满足稳态质量平衡方程 $S v = 0$ 和不可逆性约束 $v_i \\geq 0$。\n\n矩阵方程 $S v = 0$ 为：\n$$\n\\begin{pmatrix}\n-3 & 0 & 1 \\\\\n2 & -1 & 0 \\\\\n0 & 3 & -2\n\\end{pmatrix}\n\\begin{pmatrix}\nv_1 \\\\\nv_2 \\\\\nv_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这展开为一个包含三个线性齐次方程的方程组：\n1. $-3v_1 + v_3 = 0$\n2. $2v_1 - v_2 = 0$\n3. $3v_2 - 2v_3 = 0$\n\n从方程(1)中，我们可以用 $v_1$ 表示 $v_3$：\n$$ v_3 = 3v_1 $$\n从方程(2)中，我们可以用 $v_1$ 表示 $v_2$：\n$$ v_2 = 2v_1 $$\n现在，我们必须验证这些关系是否与方程(3)一致。我们将 $v_2$ 和 $v_3$ 的表达式代入方程(3)：\n$$ 3(2v_1) - 2(3v_1) = 6v_1 - 6v_1 = 0 $$\n第三个方程得到满足，证实了该方程组是一致的并且有非平凡解。矩阵 $S$ 的秩为 $2$，由于有 $3$ 个变量，零空间的维数为 $3 - 2 = 1$。解构成一个一维向量空间。\n\n我们可以用一个自由参数（例如 $t = v_1$）来表示通量向量 $v$：\n$$ v = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} t \\\\ 2t \\\\ 3t \\end{pmatrix} = t \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n其中 $t$ 是任意实数。\n\n问题包含了对所有 $i$ 的不可逆性约束 $v_i \\geq 0$：\n- $v_1 = t \\geq 0$\n- $v_2 = 2t \\geq 0$\n- $v_3 = 3t \\geq 0$\n当且仅当 $t \\geq 0$ 时，所有三个约束都得到满足。\n\n题目要求一个非平凡解，这意味着 $v \\neq 0$。这要求 $t > 0$。\n问题要求“原始正整数通量向量”，即零空间的基向量，其分量被缩放为可能的最小正整数。我们找到的基向量是 $(1, 2, 3)^{\\top}$。由于 $1$、$2$ 和 $3$ 已经是满足该比例的最小正整数，这就是我们所求的向量。这对应于将参数 $t$ 设为 $1$。\n原始正整数通量向量是：\n$$ v = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n根据规定，单位是 mmol/(gDW$\\cdot$h)。\n\n### 解释\n得到的通量向量 $v = (1, 2, 3)^{\\top}$ 描述了细胞内的一条功能性途径，其中反应 $R_1$、$R_2$ 和 $R_3$ 以 $1:2:3$ 的相对速率运行。\n\n该通量向量是**基本通量模式 (Elementary Flux Mode, EFM)** 的一个例子。一个 EFM 是一个可以在稳态下运行的最小、不可分解的反应集合。计算出的向量 $v$ 具有 EFM 的定义属性：\n1.  **稳态：** 向量 $v$ 位于 $S$ 的零空间中，因此 $S v = 0$。我们可以为每种代谢物明确地验证质量平衡：\n    - 对于 $X_1$：来自 $R_3$ 的生成速率为 $1 \\times v_3 = 1 \\times 3 = 3$。被 $R_1$ 消耗的速率为 $3 \\times v_1 = 3 \\times 1 = 3$。净变化为 $3 - 3 = 0$。\n    - 对于 $X_2$：来自 $R_1$ 的生成速率为 $2 \\times v_1 = 2 \\times 1 = 2$。被 $R_2$ 消耗的速率为 $1 \\times v_2 = 1 \\times 2 = 2$。净变化为 $2 - 2 = 0$。\n    - 对于 $X_3$：来自 $R_2$ 的生成速率为 $3 \\times v_2 = 3 \\times 2 = 6$。被 $R_3$ 消耗的速率为 $2 \\times v_3 = 2 \\times 3 = 6$。净变化为 $6 - 6 = 0$。\n    所有代谢物的平衡都成立。\n2.  **不可逆性：** $v = (1, 2, 3)^{\\top}$ 的所有分量均为正，满足条件 $v_i \\geq 0$。\n3.  **不可分解性（基本性）：** EFM 不能被分解为更简单的途径。我们的通量向量的支持集是所有参与反应的集合 $\\{R_1, R_2, R_3\\}$。如果我们试图通过将其通量设为零（例如，设 $v_1=0$）来移除其中任何一个反应，稳态条件会迫使所有其他通量也变为零（$v_2 = 2v_1 = 0$, $v_3 = 3v_1 = 0$）。这证实了该途径是最小且不可分解的。\n\n该内部途径的定性结构是一个**封闭的代谢循环**。该途径将 $X_1$ 转化为 $X_2$（通过 $R_1$），然后将 $X_2$ 转化为 $X_3$（通过 $R_2$），最后将 $X_3$ 转化回 $X_1$（通过 $R_3$）。该循环的总净反应为 $0 \\rightarrow 0$。在生物学背景下，这样一个孤立运行、不与其他过程（如ATP水解或生物质生成）耦合的循环，通常被称为“无效循环”，因为它在没有净输入或输出的情况下持续循环质量，可能会耗散能量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "这项高级实践将探索化学计量分析中一个强大的对偶概念：守恒部分。通过编写程序来寻找满足 $S^T\\boldsymbol{y} = \\boldsymbol{0}$ 的向量 $\\boldsymbol{y}$，你将学习如何通过计算识别那些总量守恒的代谢物池，这是模型验证和降维的一个关键原则。",
            "id": "3901582",
            "problem": "考虑一个封闭的生化反应网络，该网络由化学计量矩阵 $S \\in \\mathbb{Z}^{m \\times n}$ 建模，其条目记录了每次反应事件中各代谢物的净分子变化。令 $x(t) \\in \\mathbb{R}^{m}$ 表示代谢物量，$v(t) \\in \\mathbb{R}^{n}$ 表示反应速率。该动态模型由基本质量平衡关系 $d x / d t = S v$ 给出。一个保守基团池是代谢物量的一个不变线性组合，由一个系数向量 $y \\in \\mathbb{R}^{m}$ 表征，使得标量 $y^{T} x(t)$ 在网络动力学下对所有允许的 $v(t)$ 保持恒定。根据第一性原理，不变性的定义要求对所有 $v$ 都有 $d / d t (y^{T} x) = y^{T} S v = 0$，这当且仅当 $S^{T} y = 0$ 时成立。因此，基团守恒定律恰好是 $S^{T}$ 的核（kernel）中的向量，记为 $\\ker(S^{T})$。\n\n您的任务是设计并实现一个程序，给定几个整数化学计量矩阵 $S$，为向量空间 $\\ker(S^{T})$ 计算一个规范基，将每个基向量的分量解释为保守基团池的组成系数，并为每个测试用例返回这些系数的最小整数列表。计算必须从核的基本线性代数定义出发，通过对 $S^{T}$ 进行精确的有理数行化简（Gauss–Jordan 消元法），而不是通过数值近似，以便能够唯一地确定整数归一化的池组成。\n\n要求：\n\n1. 对于每个给定的 $S$，构造 $A = S^{T}$ 并通过计算 $A$ 的简化行阶梯形矩阵 (RREF) 在有理数上求解 $A y = 0$。通过为每个自由变量赋单位值并求解主元变量来参数化解，从而获得一个由有理数条目组成的 $\\ker(S^{T})$ 的基 $\\{ y^{(1)}, \\dots, y^{(k)} \\}$。\n\n2. 对于每个有理基向量 $y^{(i)}$，通过以下步骤生成一个整数归一化的组成向量：\n   - 乘以分母的最小公倍数以获得整数条目。\n   - 除以绝对值整数条目的最大公约数以获得最小整数向量。\n   - 如有必要，翻转符号，使第一个非零条目为正，以固定一个规范方向。\n   - 按字典序对基向量进行排序，以提供一个用于输出的确定性规范基表示。\n\n3. 将每个整数向量的分量解释为按代谢物顺序排列的保守基团池组成系数；也就是说，第 $j$ 个分量给出了该池中代谢物 $j$ 的整数系数。当 $\\ker(S^{T})$ 为零子空间时，输出一个空列表。\n\n4. 测试套件。使用以下三个代表封闭子系统的科学上现实的化学计量矩阵：\n   - 正常情况（腺苷三磷酸、腺苷二磷酸、腺苷一磷酸之间的腺苷酸守恒）：\n     $$\n     S_{1} = \\begin{bmatrix}\n     -1 & 0 & 0 \\\\\n     1 & -1 & 1 \\\\\n     0 & 1 & -1\n     \\end{bmatrix}.\n     $$\n     该网络在腺苷酸之间进行相互转换，而没有腺苷酸基团的净损失；预期的保守池在三种代谢物中具有相等的权重。\n   - 边界情况（子系统中没有守恒）：\n     $$\n     S_{2} = \\begin{bmatrix}\n     -1 & 0 \\\\\n     1 & -1\n     \\end{bmatrix}.\n     $$\n     该子系统具有满行秩且没有非平凡的左核，这意味着所列代谢物之间没有非平凡的基团守恒。\n   - 边缘情况（死端代谢物和总量池守恒）：\n     $$\n     S_{3} = \\begin{bmatrix}\n     -1 \\\\\n     1 \\\\\n     0\n     \\end{bmatrix}.\n     $$\n     在这里，代谢物 $3$ 不参与任何反应，而代谢物 $1$ 和 $2$ 的总量在单一的相互转换反应下是守恒的。\n\n5. 最终输出格式。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，其中每个结果本身是一个整数向量列表，代表相应测试用例的 $\\ker(S^{T})$ 的规范基，按代谢物顺序排列。例如，输出应具有形式\n   $$\n   [\\text{basis}_{S_{1}},\\text{basis}_{S_{2}},\\text{basis}_{S_{3}}],\n   $$\n   其中每个 $\\text{basis}_{S_{i}}$ 是一个整数列表的列表。不涉及物理单位，角度也不适用。\n\n该程序必须是自包含的，不需要任何输入，并且必须严格遵守指定的最终输出格式。",
            "solution": "该问题要求为给定化学计量矩阵 $S$ 的左零空间计算一个规范整数基。这个空间记为 $\\ker(S^T)$，对应于生化反应网络中的保守基团池集合。如果总数量 $y^T x(t)$ 随时间保持恒定，其中 $x(t) \\in \\mathbb{R}^m$ 是代谢物浓度向量，则向量 $y \\in \\mathbb{R}^m$ 代表一个保守基团。这个不变性条件 $\\frac{d}{dt}(y^T x) = 0$ 转化为线性代数条件 $y^T S = 0$，或等价地 $S^T y = 0$。我们的任务是找到所有满足此条件的线性无关向量 $y$，并以规范整数形式表示它们。\n\n解决方案通过一系列离散、形式化的步骤进行：(1) 使用精确有理数算术求解齐次线性方程组 $S^T y = 0$，(2) 为解空间（核）提取一个基，以及 (3) 将此基归一化为规范整数表示。\n\n**1. 理论基础：求解 $A y = 0$**\n\n对于每个给定的化学计量矩阵 $S \\in \\mathbb{Z}^{m \\times n}$，我们定义矩阵 $A = S^T \\in \\mathbb{Z}^{n \\times m}$。问题现在是找到 $A$ 的零空间（核），即所有满足 $A y = 0$ 的向量 $y \\in \\mathbb{R}^m$。用于此目的的标准且确切的方法是 Gauss-Jordan 消元法，该方法可以避免数值不稳定性并提供精确解。通过将 $A$ 转换为其简化行阶梯形矩阵 (RREF)，我们获得一个等价但更简单的线性方程组，从中可以直接读出零空间的基。\n\n问题坚持使用精确有理数算术至关重要。浮点运算会引入近似误差，使得无法唯一地恢复定义保守基团池的最小整数系数。因此，所有计算都必须在有理数域 $\\mathbb{Q}$ 上执行。\n\n**2. 算法设计**\n\n总体算法如下：\n\n**步骤 A：计算简化行阶梯形矩阵 (RREF)**\n给定矩阵 $A = S^T$，我们使用 Gauss-Jordan 消元法计算其 RREF。矩阵元素被视为有理数以确保精度。该算法通过迭代列，在每列中识别一个主元元素，并使用行操作在主元位置创建一个前导 $1$，并在该主元所在列的其他位置创建 $0$。\n1.  初始化主元行索引 $p_{row}$ 为 $0$。从 $0$ 到 $m-1$ 遍历每一列 $j$。\n2.  在列 $j$ 中，于行 $p_{row}$ 或其下方找到一个非零项。如果存在于行 $i$，则交换行 $i$ 和 $p_{row}$。\n3.  如果不存在这样的非零项，则列 $j$ 是自由列；继续下一列。\n4.  通过将新的主元行（行 $p_{row}$）除以主元元素的值来将其归一化，使主元成为 $1$。\n5.  通过从其他行中减去主元行的适当倍数，来消除列 $j$ 中的所有其他非零项。\n6.  增加 $p_{row}$。如果 $p_{row}$ 达到总行数，算法终止。\n\n**步骤 B：提取核的基**\n$A$ 的 RREF 允许对解空间进行参数化。\n1.  识别主元列（包含某行的前导 $1$ 的列）和自由列（所有其他列）。$\\ker(A)$ 的维度等于自由列的数量。\n2.  如果没有自由列，则核是平凡子空间 $\\{0\\}$，其基为空集。\n3.  对于每个自由列 $j$，构造一个基向量 $y^{(j)}$。将其初始化为大小为 $m$ 的零向量。将其第 $j$ 个分量设置为 $1$。$y^{(j)}$ 中对应于其他自由列的分量设置为 $0$。\n4.  主元变量分量的值由 RREF 矩阵中的条目确定。对于每个主元在列 $p_i$ 的主元行 $i$，基向量 $y^{(j)}$ 的第 $p_i$ 个分量由 RREF 中位置 $(i, j)$ 处条目的负值给出。\n\n此过程生成一组跨越 $\\ker(A)$ 的线性无关向量。\n\n**步骤 C：规范整数归一化**\n每个有理基向量必须转换为唯一的、规范的整数表示。对于每个有理向量 $y^{(i)}$：\n1.  **清除分母**：找到其所有分母的最小公倍数 (LCM)。将整个向量乘以这个 LCM，以获得一个具有整数条目的向量。\n2.  **求最小整数**：计算所有非零整数分量绝对值的最大公约数 (GCD)。将向量除以这个 GCD。\n3.  **固定方向**：检查所得向量的第一个非零元素。如果为负，则将整个向量乘以 $-1$。这确保了规范的符号。\n\n**步骤 D：最终基的组装**\n然后，将得到的归一化整数基向量列表按字典序排序。这确保了对于任何给定的输入矩阵 $S$，最终输出都是确定性的和规范的。\n\n**3. 应用于测试用例**\n\n让我们将此过程应用于所提供的矩阵。\n\n**情况 1：$S_1$**\n$S_1 = \\begin{bmatrix} -1 & 0 & 0 \\\\ 1 & -1 & 1 \\\\ 0 & 1 & -1 \\end{bmatrix}$。我们构造 $A = S_1^T = \\begin{bmatrix} -1 & 1 & 0 \\\\ 0 & -1 & 1 \\\\ 0 & 1 & -1 \\end{bmatrix}$。\n$A$ 的 RREF 是 $\\begin{bmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ 0 & 0 & 0 \\end{bmatrix}$。\n方程组为 $y_1 - y_3 = 0$ 和 $y_2 - y_3 = 0$。\n主元变量是 $y_1$ 和 $y_2$；自由变量是 $y_3$。\n设置自由变量 $y_3 = 1$ 得到 $y_1 = 1$ 和 $y_2 = 1$。\n单个基向量是 $y^{(1)} = (1, 1, 1)^T$。此向量已经是最小正整数形式。规范基为 $\\{[1, 1, 1]\\}$。这对应于总腺苷酸池的守恒：$[\\mathrm{ATP}] + [\\mathrm{ADP}] + [\\mathrm{AMP}] = \\text{常数}$。\n\n**情况 2：$S_2$**\n$S_2 = \\begin{bmatrix} -1 & 0 \\\\ 1 & -1 \\end{bmatrix}$。我们构造 $A = S_2^T = \\begin{bmatrix} -1 & 1 \\\\ 0 & -1 \\end{bmatrix}$。\n$A$ 的 RREF 是单位矩阵 $I_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$。\n方程组为 $y_1 = 0$ 和 $y_2 = 0$。\n没有自由变量。唯一的解是平凡解 $y = (0, 0)^T$。\n核为 $\\{0\\}$，因此其基为空集。\n\n**情况 3：$S_3$**\n$S_3 = \\begin{bmatrix} -1 \\\\ 1 \\\\ 0 \\end{bmatrix}$。我们构造 $A = S_3^T = \\begin{bmatrix} -1 & 1 & 0 \\end{bmatrix}$。\n$A$ 的 RREF 是 $\\begin{bmatrix} 1 & -1 & 0 \\end{bmatrix}$。\n方程组为 $y_1 - y_2 = 0$。\n主元变量是 $y_1$；自由变量是 $y_2$ 和 $y_3$。核的维度是 $2$。\n1.  令 $y_2=1, y_3=0$。则 $y_1 = y_2 = 1$。基向量是 $y^{(1)} = (1, 1, 0)^T$。\n2.  令 $y_2=0, y_3=1$。则 $y_1 = y_2 = 0$。基向量是 $y^{(2)} = (0, 0, 1)^T$。\n两个向量 $[1, 1, 0]$ 和 $[0, 0, 1]$ 都已经是规范整数形式。\n按字典序排序，$[0, 0, 1]$ 在 $[1, 1, 0]$ 之前。\n规范基为 $\\{[0, 0, 1], [1, 1, 0]\\}$。这些对应于代谢物 $M_3$（不参与任何反应）的守恒以及 $M_1$ 和 $M_2$ 总量池的守恒。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom fractions import Fraction\nfrom math import gcd\nfrom functools import reduce\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the computation of canonical bases\n    for the left null spaces of the test case stoichiometric matrices.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    test_cases = [\n        np.array([[-1, 0, 0], [1, -1, 1], [0, 1, -1]]),\n        np.array([[-1, 0], [1, -1]]),\n        np.array([[-1], [1], [0]])\n    ]\n\n    results = []\n    for s_matrix in test_cases:\n        basis = compute_canonical_basis(s_matrix)\n        results.append(basis)\n\n    # The final print statement must match the specified output format exactly.\n    # The standard string representation of Python lists includes spaces,\n    # which is consistent with the behavior of the template f-string.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_canonical_basis(s_matrix):\n    \"\"\"\n    Computes the canonical integer basis for the left null space (ker(S.T))\n    of a given stoichiometric matrix S.\n\n    Args:\n        s_matrix (np.ndarray): The integer stoichiometric matrix.\n\n    Returns:\n        list: A list of lists of integers representing the canonical basis.\n              An empty list if the kernel is trivial.\n    \"\"\"\n    if s_matrix.size == 0:\n        return []\n    \n    # 1. Construct A = S.T and convert to rational numbers.\n    a_matrix = s_matrix.T\n    rows, cols = a_matrix.shape\n    a_frac = np.array([[Fraction(x) for x in row] for row in a_matrix], dtype=object)\n\n    # 2. Compute the Reduced Row Echelon Form (RREF).\n    rref_matrix = rref(a_frac)\n\n    # 3. Extract a rational basis from the RREF.\n    rational_basis = extract_basis_from_rref(rref_matrix)\n\n    if not rational_basis:\n        return []\n\n    # 4. Normalize each basis vector to its canonical integer form.\n    integer_basis = [normalize_vector(vec) for vec in rational_basis]\n\n    # 5. Sort the basis vectors lexicographically for a canonical representation.\n    integer_basis.sort()\n\n    return integer_basis\n\ndef rref(matrix):\n    \"\"\"\n    Computes the Reduced Row Echelon Form of a matrix with rational entries.\n\n    Args:\n        matrix (np.ndarray): A 2D numpy array of Fraction objects.\n\n    Returns:\n        np.ndarray: The RREF of the input matrix.\n    \"\"\"\n    mat = matrix.copy()\n    rows, cols = mat.shape\n    pivot_row = 0\n    for j in range(cols): # Iterate through columns\n        if pivot_row >= rows:\n            break\n        \n        # Find a row with a non-zero entry in the current column\n        i = pivot_row\n        while mat[i, j] == 0:\n            i += 1\n            if i == rows:\n                i = -1 # Sentinel for all-zero column below pivot\n                break\n        \n        if i != -1:\n            # Swap the found row with the pivot row\n            mat[[i, pivot_row]] = mat[[pivot_row, i]]\n            \n            # Normalize the pivot row\n            pivot_val = mat[pivot_row, j]\n            if pivot_val != 1:\n                mat[pivot_row, :] /= pivot_val\n            \n            # Eliminate other entries in the pivot column\n            for i_other in range(rows):\n                if i_other != pivot_row:\n                    factor = mat[i_other, j]\n                    mat[i_other, :] -= factor * mat[pivot_row, :]\n            \n            pivot_row += 1\n            \n    return mat\n\ndef extract_basis_from_rref(rref_matrix):\n    \"\"\"\n    Extracts a basis for the null space from a matrix in RREF.\n\n    Args:\n        rref_matrix (np.ndarray): A matrix in RREF with Fraction entries.\n\n    Returns:\n        list: A list of rational basis vectors (each a list of Fractions).\n    \"\"\"\n    rows, cols = rref_matrix.shape\n    pivot_cols = []\n    # Identify pivot columns\n    for r in range(rows):\n        for c in range(cols):\n            if rref_matrix[r, c] == 1:\n                pivot_cols.append(c)\n                break # Move to the next row\n\n    all_cols = set(range(cols))\n    free_cols = sorted(list(all_cols - set(pivot_cols)))\n\n    if not free_cols:\n        return []\n\n    basis = []\n    for free_col in free_cols:\n        vec = [Fraction(0)] * cols\n        vec[free_col] = Fraction(1)\n        \n        # Solve for pivot variables\n        for r, piv_col in enumerate(pivot_cols):\n             vec[piv_col] = -rref_matrix[r, free_col]\n\n        basis.append(vec)\n        \n    return basis\n\ndef normalize_vector(vec):\n    \"\"\"\n    Normalizes a rational vector to its canonical integer form.\n    - Clears denominators.\n    - Divides by GCD of absolute values.\n    - Ensures the first non-zero element is positive.\n\n    Args:\n        vec (list): A list of Fraction objects representing a vector.\n\n    Returns:\n        list: The canonical integer vector as a list of ints.\n    \"\"\"\n    # Helper for LCM of two numbers\n    def lcm(a, b):\n        if a == 0 or b == 0: return 0\n        return abs(a * b) // gcd(a, b) if a != 0 and b != 0 else 0\n\n    # 1. Clear denominators\n    denominators = [f.denominator for f in vec]\n    common_multiple = reduce(lcm, [d for d in denominators if d != 0], 1)\n    \n    int_vec = [int(f * common_multiple) for f in vec]\n    \n    # 2. Find minimal integers by dividing by GCD\n    abs_vals = [abs(x) for x in int_vec if x != 0]\n    if not abs_vals:\n        return [0] * len(vec)\n    \n    common_divisor = reduce(gcd, abs_vals)\n    minimal_vec = [x // common_divisor for x in int_vec]\n    \n    # 3. Fix orientation\n    first_nonzero_idx = next((i for i, x in enumerate(minimal_vec) if x != 0), -1)\n    if first_nonzero_idx != -1 and minimal_vec[first_nonzero_idx] < 0:\n        minimal_vec = [-x for x in minimal_vec]\n        \n    return minimal_vec\n\n# Execute the solution process.\nsolve()\n```"
        }
    ]
}