{
    "hands_on_practices": [
        {
            "introduction": "通量平衡分析（FBA）的一个核心假设是，代谢网络是一个与环境交换物质的开放系统。本练习将通过构建一个极简的封闭网络来探讨为何这个假设是必要的 。通过证明这样一个系统在稳态下唯一可能的解是所有通量都为零，我们将从根本上理解为何必须引入交换或需求反应来模拟细胞的生长和维持。",
            "id": "3879143",
            "problem": "考虑一个封闭的胞内网络在稳态下的基于约束的建模，该网络没有交换、摄取、分泌或需求反应。在通量平衡分析（FBA）下，质量平衡约束写作 $S v = 0$，其中 $S \\in \\mathbb{R}^{m \\times n}$ 是包含 $m$ 种内部代谢物和 $n$ 个反应的化学计量矩阵，$v \\in \\mathbb{R}^{n}$ 是受标准可行性边界和方向性约束的反应通量向量。\n\n构建一个包含 $m = 3$ 种内部代谢物 $\\{X, Y, Z\\}$ 和 $n = 2$ 个由异构化反应给出的内部反应的最小、科学上合理的封闭网络：\n- $R_{1}$: $X \\rightarrow Y$,\n- $R_{2}$: $Y \\rightarrow Z$.\n\n按照代谢物顺序 $(X, Y, Z)$ 和反应顺序 $(R_{1}, R_{2})$ 写出该网络的化学计量矩阵 $S$。仅使用FBA稳态定义 $S v = 0$ 和线性代数推理，确定在可行性边界 $0 \\leq v_{i} \\leq \\infty$（其中 $i \\in \\{1, 2\\}$）下满足稳态方程的唯一通量向量 $v$，并严谨地解释为什么在没有交换或需求反应的情况下，该网络只存在零通量向量（即，为什么没有非平凡的内部通量）。在您的解释中，论证在此类无环封闭网络中为获得非零稳态通量而添加交换或需求反应的必要性。使用LaTeX的 $\\texttt{pmatrix}$ 环境将最终的通量向量答案表示为行向量。无需单位，也无需四舍五入。",
            "solution": "该问题要求在通量平衡分析（FBA）的稳态假设下，分析一个最小的、封闭的代谢网络。FBA的核心原理是，对于一个处于稳态的系统，每种内部代谢物的浓度保持不变。这由质量平衡方程 $S v = 0$ 表示，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。\n\n首先，我们为给定网络构建化学计量矩阵 $S \\in \\mathbb{R}^{3 \\times 2}$。$S$ 的行对应于代谢物，顺序为 $(X, Y, Z)$；$S$ 的列对应于反应，顺序为 $(R_{1}, R_{2})$。\n\n这些反应是：\n1.  $R_{1}$: $1X \\rightarrow 1Y$\n2.  $R_{2}$: $1Y \\rightarrow 1Z$\n\n矩阵的元素 $S_{ij}$ 表示代谢物 $i$ 在反应 $j$ 中的化学计量系数。按照惯例，反应物具有负系数，产物具有正系数。\n\n对于反应 $R_{1}$，消耗一摩尔代谢物 $X$（$-1$），生成一摩尔代谢物 $Y$（$+1$）。代谢物 $Z$ 不参与（$0$）。这给出了 $S$ 的第一列：\n$$\nv_{R_1} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n\n对于反应 $R_{2}$，消耗一摩尔代谢物 $Y$（$-1$），生成一摩尔代谢物 $Z$（$+1$）。代谢物 $X$ 不参与（$0$）。这给出了 $S$ 的第二列：\n$$\nv_{R_2} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n\n合并这两列，化学计量矩阵 $S$ 为：\n$$\nS = \\begin{pmatrix} -1  0 \\\\ 1  -1 \\\\ 0  1 \\end{pmatrix}\n$$\n\n接下来，我们应用稳态约束 $S v = 0$，其中 $v = \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix}$ 分别是反应 $R_{1}$ 和 $R_{2}$ 的通量向量。这个矩阵方程对应于一个线性方程组：\n$$\n\\begin{pmatrix} -1  0 \\\\ 1  -1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n\n写出方程组，每个方程对应一种代谢物的质量平衡：\n1.  对于代谢物 $X$：$-1 \\cdot v_{1} + 0 \\cdot v_{2} = 0 \\implies -v_{1} = 0 \\implies v_{1} = 0$。\n2.  对于代谢物 $Y$：$1 \\cdot v_{1} - 1 \\cdot v_{2} = 0 \\implies v_{1} - v_{2} = 0$。\n3.  对于代谢物 $Z$：$0 \\cdot v_{1} + 1 \\cdot v_{2} = 0 \\implies v_{2} = 0$。\n\n从第一个方程，我们得到 $v_{1} = 0$。从第三个方程，我们得到 $v_{2} = 0$。将这些值代入第二个方程，得到 $0 - 0 = 0$，这是相容的。因此，该线性方程组的唯一解是 $v_{1} = 0$ 和 $v_{2} = 0$。这个解满足给定的可行性边界 $0 \\leq v_{i} \\leq \\infty$。因此，唯一的稳态通量向量是零向量，$v = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n为了用线性代数严谨地解释这个结果，我们分析矩阵 $S$ 的零空间（或核）。根据定义，所有有效的稳态通量向量的集合就是 $S$ 的零空间。零空间的维度，即零度，决定了网络可以支持的独立通量分布的数量。\n\n$S$ 的列是向量 $c_1 = \\begin{pmatrix} -1  1  0 \\end{pmatrix}^T$ 和 $c_2 = \\begin{pmatrix} 0  -1  1 \\end{pmatrix}^T$。为了确定它们是否线性无关，我们寻求方程 $k_{1}c_{1} + k_{2}c_{2} = 0$ 的非平凡解。这给出了方程组：\n$$\n-k_{1} = 0 \\\\\nk_{1} - k_{2} = 0 \\\\\nk_{2} = 0\n$$\n唯一的解是 $k_{1} = 0$ 和 $k_{2} = 0$。由于使列的线性组合等于零向量的唯一方式是平凡组合，因此这些列是线性无关的。矩阵的秩是其列空间的维度，等于线性无关列的数量。因此，$S$ 的秩是 $\\text{rank}(S) = 2$。\n\n根据秩-零度定理，对于矩阵 $S \\in \\mathbb{R}^{m \\times n}$，我们有 $\\text{rank}(S) + \\text{nullity}(S) = n$，其中 $n$ 是列数（反应数）。在我们的例子中，$n=2$。代入我们求得的秩：\n$$\n2 + \\text{nullity}(S) = 2\n$$\n这意味着 $\\text{nullity}(S) = 0$。维度为 $0$ 的零空间只包含一个元素：零向量。因此，满足 $S v = 0$ 的唯一通量向量是 $v = 0$。\n\n这个结果的物理解释是，在一个封闭且无环的网络中，稳态下不可能存在持续的、非零的通量。代谢物 $X$ 被反应 $R_{1}$ 消耗，但由于系统是封闭的，没有反应或外部来源产生 $X$。为了使 $X$ 的浓度保持恒定（稳态），其净生成速率必须为零。这要求消耗它的反应的通量 $v_{1}$ 为零。同样地，代谢物 $Z$ 由反应 $R_{2}$ 产生，但没有反应或外部汇消耗它。为了使 $Z$ 的浓度保持恒定，它不能积累，这意味着产生它的反应的通量 $v_{2}$ 也必须为零。\n\n为了获得非零的稳态通量，必须满足每种代谢物的质量平衡。这只有在通过添加交换反应来“打开”系统时才可能实现。例如，一个 $X$ 的源反应（例如 $R_{in}: \\emptyset \\rightarrow X$）和一个 $Z$ 的汇反应或需求反应（例如 $R_{out}: Z \\rightarrow \\emptyset$）会将 $X$ 和 $Z$ 的质量平衡方程分别修改为 $v_{in} - v_{1} = 0$ 和 $v_{2} - v_{out} = 0$。内部代谢物 $Y$ 的平衡方程仍然是 $v_{1} - v_{2} = 0$。这个新系统允许一个非平凡解 $v_{1} = v_{2} = v_{in} = v_{out}$。非零的流入量（$v_{in}  0$）可以沿通路传播并流出（$v_{out}  0$），同时为所有内部代谢物保持完美平衡，从而在具有非零内部通量的情况下满足稳态条件。因此，在一个无环网络中，交换反应是维持非零稳态通量的必要条件。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了开放系统的重要性之后，下一步是将真实的实验数据融入到我们的模型中，从而对其进行约束。本练习提供了一个将宏观实验测量值（例如，葡萄糖浓度变化和耗氧速率）转化为FBA模型所需的特定通量边界的实践指南 。这个过程是连接实验室数据和计算机模拟的关键一步，确保了模型预测的生理相关性。",
            "id": "3879151",
            "problem": "一个混合均匀的革兰氏阴性菌好氧分批发酵培养物通过基于约束的分析进行建模。在一个短时间间隔内，测量了胞外浓度，尾气系统报告了耗氧速率。假设体积恒定，并且在该时间间隔内，系统对于胞内代谢物近似处于准稳态。使用以下数据和约定来计算交换通量的边界，并为通量平衡分析（FBA）建立线性优化问题。\n\n数据和约定：\n- 时间间隔为 $\\Delta t = 15$ 分钟，即 $\\Delta t = 0.25$ 小时。\n- 在 $\\Delta t$ 时间内，测得的胞外葡萄糖浓度下降值为 $\\Delta C_{\\text{glc}} = 1.2$ g/L。\n- D-葡萄糖的分子量为 $M_{\\text{glc}} = 180.156$ g/mol。\n- 在同一时间间隔内，生物量干重浓度从 $X(t_0) = 2.4$ gDW/L 增加到 $X(t_1) = 2.7$ gDW/L。\n- 在该时间间隔内，尾气分析报告的体积耗氧速率为 $r_{\\text{O}_2} = 36$ mmol/L/h。\n- 交换通量遵循符号约定：摄取为负，分泌为正。将葡萄糖交换通量记为 $v_{\\text{EX\\_glc}}$，氧气交换通量记为 $v_{\\text{EX\\_o2}}$，单位均为 mmol gDW$^{-1}$ h$^{-1}$。\n- 摄取通量的边界指定为 $v_{\\text{EX\\_glc}} \\in [\\text{LB}_{\\text{glc}}, 0]$ 和 $v_{\\text{EX\\_o2}} \\in [\\text{LB}_{\\text{o2}}, 0]$，其中 $\\text{LB}_{\\text{glc}}$ 和 $\\text{LB}_{\\text{o2}}$ 是根据数据计算出的下界。\n- 胞内网络由化学计量矩阵 $S$ 和通量向量 $v$ 表示，其中包括 $v_{\\text{EX\\_glc}}$、$v_{\\text{EX\\_o2}}$、生物量合成通量 $v_{\\text{Biomass}}$ 以及其他胞内反应通量。在准稳态下，胞内质量平衡要求 $S v = 0$。\n- FBA 的目标是在质量平衡和通量边界的约束下，最大化 $v_{\\text{Biomass}}$，其中不可逆性通过为不可逆的胞内反应设置零下界来强制执行。\n\n任务：\n1. 根据质量守恒的基本原理和比摄取速率的定义，计算与单位 mmol gDW$^{-1}$ h$^{-1}$ 一致的下界 $\\text{LB}_{\\text{glc}}$ 和 $\\text{LB}_{\\text{o2}}$。\n2. 使用这些边界，建立在线性规划问题，该问题在 $S v = 0$ 和通量边界的约束下最大化 $v_{\\text{Biomass}}$，并明确指出决策变量、等式约束以及应用于 $v_{\\text{EX\\_glc}}$ 和 $v_{\\text{EX\\_o2}}$ 的边界约束。\n\n将每个边界四舍五入至四位有效数字。以有序对 $(\\text{LB}_{\\text{glc}}, \\text{LB}_{\\text{o2}})$ 的形式报告最终数值答案，且报告的有序对中不包含单位。所有中间推理都必须遵守上述符号约定。",
            "solution": "### 步骤 1：提取已知条件\n- 时间间隔：$\\Delta t = 15$ 分钟，即 $\\Delta t = 0.25$ 小时。\n- 测得的胞外葡萄糖浓度下降值：$\\Delta C_{\\text{glc}} = 1.2$ g/L。\n- D-葡萄糖的分子量：$M_{\\text{glc}} = 180.156$ g/mol。\n- 初始生物量干重浓度：$X(t_0) = 2.4$ gDW/L。\n- 最终生物量干重浓度：$X(t_1) = 2.7$ gDW/L。\n- 体积耗氧速率：$r_{\\text{O}_2} = 36$ mmol/L/h。\n- 交换通量符号约定：摄取为负，分泌为正。\n- 葡萄糖交换通量变量：$v_{\\text{EX\\_glc}}$，单位为 mmol gDW$^{-1}$ h$^{-1}$。\n- 氧气交换通量变量：$v_{\\text{EX\\_o2}}$，单位为 mmol gDW$^{-1}$ h$^{-1}$。\n- 摄取通量的边界：$v_{\\text{EX\\_glc}} \\in [\\text{LB}_{\\text{glc}}, 0]$ 和 $v_{\\text{EX\\_o2}} \\in [\\text{LB}_{\\text{o2}}, 0]$。\n- 胞内网络表示为：在准稳态下 $S v = 0$。\n- 目标：在质量平衡和通量边界的约束下，最大化生物量合成通量 $v_{\\text{Biomass}}$。不可逆的胞内反应的下界为零。\n\n### 解答\n\n按照要求，解答分为两部分呈现：通量边界的计算和线性规划的构建。\n\n#### 第一部分：通量边界的计算\n底物消耗或产物生成的比速率 $q_s$（单位为 mmol gDW$^{-1}$ h$^{-1}$）是根据体积速率 $r_s$（单位为 mmol L$^{-1}$ h$^{-1}$）和生物量浓度 $X$（单位为 gDW L$^{-1}$）使用以下原理计算的：\n$$q_s = \\frac{r_s}{X}$$\n由于生物量浓度在时间间隔 $\\Delta t$ 内发生变化，因此使用时间平均生物量浓度 $\\bar{X}$ 进行此计算是合适的。\n平均生物量浓度为：\n$$\\bar{X} = \\frac{X(t_0) + X(t_1)}{2} = \\frac{2.4 \\text{ gDW/L} + 2.7 \\text{ gDW/L}}{2} = 2.55 \\text{ gDW/L}$$\n\n**1. 葡萄糖通量的下界 ($\\text{LB}_{\\text{glc}}$)**\n\n首先，我们计算葡萄糖消耗的体积速率。在 $\\Delta t = 0.25$ 小时内减少 $\\Delta C_{\\text{glc}} = 1.2$ g/L 对应的体积消耗速率为：\n$$r_{\\text{glc,vol}} = \\frac{\\Delta C_{\\text{glc}}}{\\Delta t} = \\frac{1.2 \\text{ g/L}}{0.25 \\text{ h}} = 4.8 \\text{ g L}^{-1} \\text{ h}^{-1}$$\n接下来，我们使用葡萄糖的分子量 $M_{\\text{glc}} = 180.156$ g/mol 将该速率的单位从 g L$^{-1}$ h$^{-1}$ 转换为 mmol L$^{-1}$ h$^{-1}$：\n$$r_{\\text{glc,mol}} = \\frac{r_{\\text{glc,vol}}}{M_{\\text{glc}}} = \\frac{4.8 \\text{ g L}^{-1} \\text{ h}^{-1}}{180.156 \\text{ g mol}^{-1}} \\approx 0.026644 \\text{ mol L}^{-1} \\text{ h}^{-1}$$\n从 mol 转换为 mmol：\n$$r_{\\text{glc,mol}} = 0.026644 \\text{ mol L}^{-1} \\text{ h}^{-1} \\times 1000 \\text{ mmol mol}^{-1} \\approx 26.644 \\text{ mmol L}^{-1} \\text{ h}^{-1}$$\n现在，我们通过将体积速率除以平均生物量浓度 $\\bar{X}$ 来计算葡萄糖比摄取速率 $q_{\\text{glc}}$：\n$$q_{\\text{glc}} = \\frac{r_{\\text{glc,mol}}}{\\bar{X}} = \\frac{26.644 \\text{ mmol L}^{-1} \\text{ h}^{-1}}{2.55 \\text{ gDW L}^{-1}} \\approx 10.4489 \\text{ mmol gDW}^{-1} \\text{ h}^{-1}$$\n根据问题的符号约定，摄取通量为负。因此，测得的葡萄糖交换通量为：\n$$v_{\\text{EX\\_glc}} = -q_{\\text{glc}} \\approx -10.4489 \\text{ mmol gDW}^{-1} \\text{ h}^{-1}$$\n问题将此通量的允许范围定义为 $v_{\\text{EX\\_glc}} \\in [\\text{LB}_{\\text{glc}}, 0]$。因此，下界 $\\text{LB}_{\\text{glc}}$ 是通量的最小可能值，对应于测得的摄取速率。四舍五入到四位有效数字：\n$$\\text{LB}_{\\text{glc}} = -10.45$$\n\n**2. 氧气通量的下界 ($\\text{LB}_{\\text{o2}}$)**\n\n给定的体积耗氧速率为 $r_{\\text{O}_2} = 36$ mmol L$^{-1}$ h$^{-1}$。我们通过除以平均生物量浓度 $\\bar{X}$ 来计算氧气比摄取速率 $q_{\\text{O}_2}$：\n$$q_{\\text{O}_2} = \\frac{r_{\\text{O}_2}}{\\bar{X}} = \\frac{36 \\text{ mmol L}^{-1} \\text{ h}^{-1}}{2.55 \\text{ gDW L}^{-1}} \\approx 14.1176 \\text{ mmol gDW}^{-1} \\text{ h}^{-1}$$\n应用摄取通量的符号约定（负值）：\n$$v_{\\text{EX\\_o2}} = -q_{\\text{O}_2} \\approx -14.1176 \\text{ mmol gDW}^{-1} \\text{ h}^{-1}$$\n问题将此通量的允许范围定义为 $v_{\\text{EX\\_o2}} \\in [\\text{LB}_{\\text{o2}}, 0]$。下界 $\\text{LB}_{\\text{o2}}$ 是测得的摄取速率。四舍五入到四位有效数字：\n$$\\text{LB}_{\\text{o2}} = -14.12$$\n\n#### 第二部分：线性规划的构建\n通量平衡分析问题被构建为一个线性规划（LP）问题。\n\n**决策变量：**\n决策变量是代谢网络中所有反应的通量，由通量向量 $v = [v_1, v_2, ..., v_n]^T$ 表示。该向量包括胞内通量、生物量合成通量 $v_{\\text{Biomass}}$ 以及交换通量（如 $v_{\\text{EX\\_glc}}$ 和 $v_{\\text{EX\\_o2}}$）。\n\n**目标函数：**\n目标是最大化生物量生成的比速率 $v_{\\text{Biomass}}$。这可以写成：\n$$\\text{Maximize } Z = v_{\\text{Biomass}}$$\n在向量表示法中，如果 $c$ 是一个在对应于 $v_{\\text{Biomass}}$ 的位置为 $1$、其他位置为 $0$ 的向量，则目标是 $\\text{Maximize } c^T v$。\n\n**约束条件：**\n该优化受两种类型的约束：\n\n1.  **等式约束（质量平衡）：** 对胞内代谢物的准稳态假设意味着每种内部代谢物的净生成量为零。这表示为一个线性方程组：\n    $$S v = 0$$\n    其中 $S$ 是一个 $m \\times n$ 的化学计量矩阵，代表 $m$ 种内部代谢物和 $n$ 个反应。\n\n2.  **不等式约束（通量边界）：** 每个通量 $v_j$ 都受到一个下界（$lb_j$）和一个上界（$ub_j$）的约束：\n    $$lb_j \\le v_j \\le ub_j \\quad \\text{for } j = 1, ..., n$$\n    根据问题陈述和计算出的值：\n    -   **葡萄糖交换通量：** 该通量受到测得的摄取速率的约束。\n        $$-10.45 \\le v_{\\text{EX\\_glc}} \\le 0$$\n    -   **氧气交换通量：** 该通量受到测得的摄取速率的约束。\n        $$-14.12 \\le v_{\\text{EX\\_o2}} \\le 0$$\n    -   **生物量合成通量：** 生物量生成是一个不可逆过程，因此其通量必须为非负。\n        $$v_{\\text{Biomass}} \\ge 0$$\n        通常，上界不受约束（或设置为一个很大的数），即 $0 \\le v_{\\text{Biomass}} \\le \\infty$。\n    -   **不可逆胞内反应：** 对于任何不可逆通量 $v_j$（除指定的摄取通量外），其约束为：\n        $$v_j \\ge 0$$\n        上界通常是一个很大的数，代表最大催化能力，即 $0 \\le v_j \\le v_{\\text{max}}$。\n    -   **可逆胞内反应：** 对于任何可逆通量 $v_j$，其边界通常设置为允许正向和反向反应：\n        $$-\\infty \\le v_j \\le \\infty$$ （在实践中为一个大的对称范围，如 $[-1000, 1000]$）。\n\n总之，完整的线性规划问题是：\n$$\n\\begin{align*}\n\\text{Maximize }  v_{\\text{Biomass}} \\\\\n\\text{subject to }  S v = 0 \\\\\n                     -10.45 \\le v_{\\text{EX\\_glc}} \\le 0 \\\\\n                     -14.12 \\le v_{\\text{EX\\_o2}} \\le 0 \\\\\n                     lb_j \\le v_j \\le ub_j \\quad \\text{for all other fluxes } v_j\n\\end{align*}\n$$\n其中，具体的边界 $lb_j$ 和 $ub_j$ 是根据热力学可逆性和其他可用数据定义的。",
            "answer": "$$\n\\boxed{(-10.45, -14.12)}\n$$"
        },
        {
            "introduction": "一个构建良好且经过实验数据约束的FBA模型，可以成为探索生物学问题的强大工具。本练习将演示FBA的一个经典应用：通过模拟基因敲除实验来预测反应的必需性 。通过系统地模拟单个或多个反应的“失活”，我们可以识别出对细胞生长至关重要的单个反应以及“合成致死”的反应组合，这为代谢工程和药物靶点发现提供了重要的理论指导。",
            "id": "3879160",
            "problem": "给定一个小型且科学上合理的代谢网络，要求您使用基于约束的分析方法——流通平衡分析（FBA），来确定反应的必需性并识别合成致死对。您必须使用的基本原理是生化网络的稳态质量平衡，以及线性约束和线性优化。\n\n该网络包含 $4$ 种代谢物和 $6$ 个不可逆反应。代谢物为 $A$、$B$、$C$ 和 $D$。反应如下：\n- $R_1$: $\\rightarrow A$ (摄取/来源),\n- $R_2$: $A \\rightarrow B$,\n- $R_3$: $B \\rightarrow C$,\n- $R_4$: $A \\rightarrow D$,\n- $R_5$: $D \\rightarrow C$,\n- $R_6$: $C \\rightarrow$ 生物质（“生物质”是 $C$ 的一个伪消耗汇，不作为代谢物显式包含）。\n\n设化学计量矩阵为\n$$\nS = \\begin{bmatrix}\n+1  -1  0  -1  0  0 \\\\\n0  +1  -1  0  0  0 \\\\\n0  0  +1  0  +1  -1 \\\\\n0  0  0  +1  -1  0\n\\end{bmatrix},\n$$\n其中行对应于代谢物 $\\{A,B,C,D\\}$，列对应于反应 $\\{R_1,R_2,R_3,R_4,R_5,R_6\\}$。\n\n流通平衡分析（FBA）假设系统处于稳态，\n$$\nS \\, v = 0,\n$$\n其中 $v \\in \\mathbb{R}^6$ 是通量向量。所有反应都是不可逆的，其下界为 $0$，上界根据每个测试用例指定。目标是最大化生长，定义为通过生物质消耗反应的通量，\n$$\n\\max_{v} \\; v_6,\n$$\n约束条件为 $S v = 0$ 和通量边界。\n\n通量单位必须视为毫摩尔/克干重/小时（“mmol/gDW/h”）。基线最优生长通量 $v_6$ 的值应四舍五入到三位小数。\n\n反应索引必须是零基的：$R_1 \\mapsto 0$，$R_2 \\mapsto 1$，$R_3 \\mapsto 2$，$R_4 \\mapsto 3$，$R_5 \\mapsto 4$，$R_6 \\mapsto 5$。\n\n需要实现的定义：\n- 如果敲除一个反应 $i$（强制 $v_i = 0$）导致最优目标值减小到小于一个小的阈值 $\\varepsilon$，即敲除后 $\\max v_6 \\lt \\varepsilon$，则该反应是“必需的”。使用 $\\varepsilon = 10^{-9}$。\n- 如果反应 $i$ 和 $j$ 都不是单独必需的，但同时敲除它们（强制 $v_i = 0$ 和 $v_j = 0$）导致最优目标值减小到小于 $\\varepsilon$，即 $\\max v_6 \\lt \\varepsilon$，则这对反应 $(i,j)$ 是“合成致死的”。\n- 为了关注内部通路的冗余性，仅在候选集 $\\{1,2,3,4\\}$（即反应 $R_2$ 到 $R_5$）中计算合成致死对，并且仅当基线最优生长大于或等于 $\\varepsilon$ 时进行计算。如果基线最优生长小于 $\\varepsilon$，则必需反应列表和合成致死对列表均返回空列表。\n\n物理和数值细节：\n- 所有通量边界的单位均为“mmol/gDW/h”。\n- 除非测试用例另有修改，否则内部反应（$R_2$ 到 $R_6$）的下界为 $0$，上界为 $1000$。\n- 摄取反应 $R_1$ 的下界为 $0$，上界由每个测试用例提供。\n\n您的程序必须使用正确的线性规划（LP）方法求解一系列线性规划问题，以计算基线生长、单反应敲除的影响以及指定候选集中双反应敲除的影响。根据需要重复求解LP问题。\n\n测试套件：\n- 情况1（正常路径）：$R_1$ 上界 $10$，$R_3$ 上界 $1000$，$R_5$ 上界 $1000$。\n- 情况2（容量受限的分支）：$R_1$ 上界 $10$，$R_3$ 上界 $2$，$R_5$ 上界 $2$。\n- 情况3（无底物）：$R_1$ 上界 $0$，$R_3$ 上界 $1000$，$R_5$ 上界 $1000$。\n\n输出规范：\n- 对于每个测试用例，计算：\n  1. 必需反应的列表，以零基索引表示。\n  2. 合成致死对的列表，以包含两个零基索引的列表表示，顺序不限。\n  3. 基线最优生长通量 $v_6$，单位为“mmol/gDW/h”，四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为类似JSON的列表，不含空格。每个用例的结果必须是 $[E,P,G]$ 形式的列表，其中 $E$ 是整数列表（必需反应索引），$P$ 是包含两个整数的列表的列表（合成致死对），$G$ 是四舍五入后的浮点数基线生长值。例如，输出格式为\n$$\n[[E_1,P_1,G_1],[E_2,P_2,G_2],[E_3,P_3,G_3]],\n$$\n字符串中任何地方都不能有空格。",
            "solution": "该问题的解决思路是首先分析网络的结构，然后针对每种情况系统地应用通量平衡分析（FBA）。\n\n**1. 网络结构分析**\n根据化学计量矩阵 $S$，我们可以推导出通量之间的关系。使用0-基索引 ($v_0$ 到 $v_5$):\n- 代谢物A: $v_0 - v_1 - v_3 = 0 \\implies v_0 = v_1 + v_3$\n- 代谢物B: $v_1 - v_2 = 0 \\implies v_1 = v_2$\n- 代谢物C: $v_2 + v_4 - v_5 = 0 \\implies v_5 = v_2 + v_4$ (目标通量)\n- 代谢物D: $v_3 - v_4 = 0 \\implies v_3 = v_4$\n\n综合这些方程，我们得到 $v_0 = v_2 + v_4$ 并且 $v_5 = v_2 + v_4$。因此，最大生长通量 $v_5$ 等于总底物摄取通量 $v_0$。该网络有两个平行的通路将底物转化为生物质前体C：通路1 ($R_2 \\to R_3$，通量为 $v_1=v_2$) 和通路2 ($R_4 \\to R_5$，通量为 $v_3=v_4$)。总生长受限于总摄取 $v_0$ 以及两条通路各自的容量。\n\n**2. 测试用例分析**\n\n**情况1：正常路径**\n- **边界**: $v_0 \\le 10$, $v_2 \\le 1000$, $v_4 \\le 1000$。\n- **基线生长**: 两条通路的容量（1000）远大于摄取量（10）。因此，最大生长由摄取决定：$G = v_5 = v_0 = 10.0$ mmol/gDW/h。\n- **必需性**:\n    - 敲除 $R_1(v_0)$ 或 $R_6(v_5)$ 会直接导致生长为0，因此反应0和5是必需的。\n    - 敲除通路1的任一反应（$R_2$ 或 $R_3$，索引1或2），通路2仍可承载全部通量（$v_4 = v_0 = 10$），生长不变。因此1和2不是必需的。\n    - 同理，敲除通路2的任一反应（$R_4$ 或 $R_5$，索引3或4），通路1可承载全部通量，生长不变。因此3和4不是必需的。\n    - **必需反应列表 $E_1$**: `[0, 5]`。\n- **合成致死**:\n    - 候选对的索引为 $\\{1, 2, 3, 4\\}$。当且仅当同时敲除两个平行通路时，生长才会停止。这需要从通路1（反应1或2）和通路2（反应3或4）中各敲除一个反应。\n    - 因此，合成致死对是 $(1,3), (1,4), (2,3), (2,4)$。\n    - **合成致死对列表 $P_1$**: `[[1,3],[1,4],[2,3],[2,4]]`。\n- **结果**: `[[0,5],[[1,3],[1,4],[2,3],[2,4]],10.000]`\n\n**情况2：容量受限的分支**\n- **边界**: $v_0 \\le 10$, $v_2 \\le 2$, $v_4 \\le 2$。\n- **基线生长**: 总摄取 $v_0$ 可达10，但被两条通路的总容量限制。最大生长为 $G = v_5 = v_2 + v_4 = 2 + 2 = 4.0$ mmol/gDW/h。\n- **必需性**: 逻辑与情况1相同。单独敲除任一通路只会使生长减少（降至2.0），但不会降至0。因此，只有反应0和5是必需的。\n    - **必需反应列表 $E_2$**: `[0, 5]`。\n- **合成致死**: 逻辑与情况1完全相同。\n    - **合成致死对列表 $P_2$**: `[[1,3],[1,4],[2,3],[2,4]]`。\n- **结果**: `[[0,5],[[1,3],[1,4],[2,3],[2,4]],4.000]`\n\n**情况3：无底物**\n- **边界**: $v_0 \\le 0$。\n- **基线生长**: 由于没有底物摄入，最大生长 $G = v_5 = v_0 = 0.0$。\n- **必需性与合成致死**: 根据问题定义，如果基线生长小于阈值 $\\varepsilon$，则必需反应和合成致死对列表均为空。\n- **结果**: `[[],[],0.000]`\n\n将所有情况的结果组合，即可得到最终的输出字符串。",
            "answer": "[[[0,5],[[1,3],[1,4],[2,3],[2,4]],10.000],[[0,5],[[1,3],[1,4],[2,3],[2,4]],4.000],[[],[],0.000]]"
        }
    ]
}