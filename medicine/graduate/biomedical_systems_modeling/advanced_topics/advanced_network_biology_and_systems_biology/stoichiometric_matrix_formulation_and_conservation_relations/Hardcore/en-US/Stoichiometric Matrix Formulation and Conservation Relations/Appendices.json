{
    "hands_on_practices": [
        {
            "introduction": "The first step in modeling any biochemical network is translating its reaction scheme into a precise mathematical structure. This exercise provides foundational practice in constructing a stoichiometric matrix $S$ from a simple receptor-ligand binding system. By performing this task, you will solidify your understanding of how the matrix dimensions relate to the system's components and, more importantly, how a core property of the matrix—its rank—directly reveals the number of independent conservation laws governing the system .",
            "id": "3933023",
            "problem": "Consider a well-mixed single-compartment receptor–ligand binding system in biomedical systems modeling with $3$ chemical species and $2$ reactions. The species are free receptor $R$, free ligand $L$, and receptor–ligand complex $C$. The reactions are written as separate forward and reverse steps:\n$$(1)\\; R + L \\rightarrow C,\\quad (2)\\; C \\rightarrow R + L.$$\nUse the standard mass-balance representation that the time derivative of the species concentrations is given by the stoichiometric matrix multiplying the reaction rate vector, namely $d\\mathbf{x}/dt = S\\,\\mathbf{v}$, where $\\mathbf{x} = (x_R, x_L, x_C)^{\\mathsf{T}}$ and $\\mathbf{v} = (v_1, v_2)^{\\mathsf{T}}$ collects the reaction rates. Assume a closed system (no inflow, outflow, synthesis, or degradation) and homogeneous mixing.\n\nTasks:\n- Construct the stoichiometric matrix $S$ for the ordering of species $(R,L,C)$ and reactions $(1,2)$ specified above.\n- Verify the dimensions of $S$, $\\mathbf{x}$, and $\\mathbf{v}$ are consistent under matrix multiplication.\n- Starting from the fundamental mass-balance and linear conservation definitions, deduce the number of linearly independent conservation relations (moieties) in this closed system. You may use the criterion that a vector $\\mathbf{c}$ defines a conserved quantity if $d(\\mathbf{c}^{\\mathsf{T}}\\mathbf{x})/dt = 0$ for all admissible reaction rate vectors.\n- Briefly explain, using equations grounded in the mass-balance framework, how reversible reactions may be represented either by separate columns in $S$ (as above) or by a single column coupled to a signed net rate, and how these choices affect constraints on $\\mathbf{v}$ (e.g., nonnegativity versus allowing signed rates).\n\nReport as your final answer only the number of independent conservation relations. No rounding is required, and no units are needed for the reported number.",
            "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and objective. It represents a standard textbook problem in systems biology and chemical kinetics. We may therefore proceed with a full solution.\n\nThe system involves $m=3$ species and $r=2$ reactions. The species concentrations are collected in the vector $\\mathbf{x} = \\begin{pmatrix} x_R  x_L  x_C \\end{pmatrix}^{\\mathsf{T}}$, where $x_R$, $x_L$, and $x_C$ are the concentrations of free receptor, free ligand, and receptor-ligand complex, respectively. The reaction rates are collected in the vector $\\mathbf{v} = \\begin{pmatrix} v_1  v_2 \\end{pmatrix}^{\\mathsf{T}}$. The system dynamics are governed by the mass-balance equation:\n$$\n\\frac{d\\mathbf{x}}{dt} = S\\,\\mathbf{v}\n$$\n\nFirst, we construct the stoichiometric matrix $S$. This is an $m \\times r$ matrix, which in this case is a $3 \\times 2$ matrix. Each column of $S$ represents a reaction, and each row represents a species. The entry $S_{ij}$ is the stoichiometric coefficient of species $i$ in reaction $j$. A positive coefficient indicates production, and a negative coefficient indicates consumption.\n\nThe reactions are:\n$$(1)\\; R + L \\rightarrow C$$\n$$(2)\\; C \\rightarrow R + L$$\n\nFor Reaction (1), one unit of $R$ is consumed (coefficient $-1$), one unit of $L$ is consumed (coefficient $-1$), and one unit of $C$ is produced (coefficient $+1$). This gives the first column of $S$.\n$$\n\\mathbf{s}_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\nFor Reaction (2), one unit of $C$ is consumed (coefficient $-1$), one unit of $R$ is produced (coefficient $+1$), and one unit of $L$ is produced (coefficient $+1$). This gives the second column of $S$.\n$$\n\\mathbf{s}_2 = \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix}\n$$\nCombining these columns, the stoichiometric matrix $S$ is:\n$$\nS = \\begin{pmatrix} -1  1 \\\\ -1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\n\nNext, we verify the consistency of the dimensions in the governing equation $d\\mathbf{x}/dt = S\\,\\mathbf{v}$.\n- The species vector $\\mathbf{x}$ is a $3 \\times 1$ column vector. Its time derivative $d\\mathbf{x}/dt$ must also be a $3 \\times 1$ column vector.\n- The stoichiometric matrix $S$ is a $3 \\times 2$ matrix.\n- The reaction rate vector $\\mathbf{v}$ is a $2 \\times 1$ column vector.\nThe product $S\\,\\mathbf{v}$ has dimensions $(3 \\times 2) \\times (2 \\times 1)$, which results in a $3 \\times 1$ vector. The dimensions are consistent, as both sides of the equation are $3 \\times 1$ vectors.\n\nNow, we deduce the number of linearly independent conservation relations. A conservation relation is a linear combination of species concentrations that remains constant over time. Let such a conserved quantity be $q = \\mathbf{c}^{\\mathsf{T}}\\mathbf{x}$, where $\\mathbf{c}$ is a constant vector of coefficients. For $q$ to be conserved, its time derivative must be zero:\n$$\n\\frac{dq}{dt} = \\frac{d}{dt}(\\mathbf{c}^{\\mathsf{T}}\\mathbf{x}) = \\mathbf{c}^{\\mathsf{T}}\\frac{d\\mathbf{x}}{dt} = 0\n$$\nSubstituting the governing equation, we get:\n$$\n\\mathbf{c}^{\\mathsf{T}}(S\\,\\mathbf{v}) = (\\mathbf{c}^{\\mathsf{T}}S)\\,\\mathbf{v} = 0\n$$\nThis condition must hold for any valid reaction rate vector $\\mathbf{v}$. The rates of elementary reactions are non-negative, but they can otherwise take any value depending on the species concentrations. For the equality to hold for all admissible $\\mathbf{v}$, the vector term multiplying $\\mathbf{v}$ must be the zero vector. Therefore, $\\mathbf{c}$ must satisfy:\n$$\n\\mathbf{c}^{\\mathsf{T}}S = \\mathbf{0}^{\\mathsf{T}}\n$$\nThis equation means that the vector $\\mathbf{c}$ must belong to the left null space of the stoichiometric matrix $S$. The number of linearly independent conservation relations is therefore equal to the dimension of the left null space of $S$, denoted $\\text{dim}(\\text{null}(S^{\\mathsf{T}}))$.\n\nAccording to the rank-nullity theorem, for a matrix $S$ with $m$ rows, the dimension of its left null space is given by:\n$$\n\\text{dim}(\\text{null}(S^{\\mathsf{T}})) = m - \\text{rank}(S)\n$$\nHere, $m=3$ is the number of species. We need to find the rank of $S$. The rank is the number of linearly independent columns (or rows).\n$$\nS = \\begin{pmatrix} -1  1 \\\\ -1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\nThe second column is equal to $-1$ times the first column. Thus, the two columns are linearly dependent. The rank of the matrix is therefore $1$.\n\nThe number of linearly independent conservation relations is:\n$$\n\\text{dim}(\\text{null}(S^{\\mathsf{T}})) = 3 - \\text{rank}(S) = 3 - 1 = 2\n$$\nThere are $2$ independent conservation relations in this system.\n\nWe can find the basis vectors for the left null space to identify these conserved quantities. Let $\\mathbf{c} = \\begin{pmatrix} c_R  c_L  c_C \\end{pmatrix}^{\\mathsf{T}}$. The condition $\\mathbf{c}^{\\mathsf{T}}S = \\mathbf{0}^{\\mathsf{T}}$ is equivalent to $S^{\\mathsf{T}}\\mathbf{c} = \\mathbf{0}$:\n$$\nS^{\\mathsf{T}} = \\begin{pmatrix} -1  -1  1 \\\\ 1  1  -1 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -1  -1  1 \\\\ 1  1  -1 \\end{pmatrix} \\begin{pmatrix} c_R \\\\ c_L \\\\ c_C \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the single independent equation $-c_R - c_L + c_C = 0$, or $c_C = c_R + c_L$. A general solution for $\\mathbf{c}$ can be written as:\n$$\n\\mathbf{c} = \\begin{pmatrix} c_R \\\\ c_L \\\\ c_R + c_L \\end{pmatrix} = c_R \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} + c_L \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\nA basis for the left null space is given by the two vectors $\\mathbf{c}_1 = \\begin{pmatrix} 1  0  1 \\end{pmatrix}^{\\mathsf{T}}$ and $\\mathbf{c}_2 = \\begin{pmatrix} 0  1  1 \\end{pmatrix}^{\\mathsf{T}}$. These correspond to the conserved quantities (moieties):\n1. $q_1 = \\mathbf{c}_1^{\\mathsf{T}}\\mathbf{x} = 1 \\cdot x_R + 0 \\cdot x_L + 1 \\cdot x_C = x_R + x_C$. This is the total concentration of receptor, $R_{total}$.\n2. $q_2 = \\mathbf{c}_2^{\\mathsf{T}}\\mathbf{x} = 0 \\cdot x_R + 1 \\cdot x_L + 1 \\cdot x_C = x_L + x_C$. This is the total concentration of ligand, $L_{total}$.\nThe fact that the total amounts of receptor and ligand are conserved is expected for a closed system with only binding and unbinding reactions.\n\nFinally, we address the representation of reversible reactions.\nThe given problem uses separate columns in $S$ for the forward and reverse steps of the reversible reaction $R+L \\rightleftharpoons C$. The rate equation is $d\\mathbf{x}/dt = S\\mathbf{v} = \\mathbf{s}_1 v_1 + \\mathbf{s}_2 v_2$. A fundamental physical constraint is that elementary reaction rates are non-negative, so we must have $v_1 \\geq 0$ and $v_2 \\geq 0$.\n\nAlternatively, one can represent the net reaction with a single stoichiometric column and a net reaction rate. Since the reverse reaction's stoichiometry is the negative of the forward one, $\\mathbf{s}_2 = -\\mathbf{s}_1$, we can write:\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{s}_1 v_1 + (-\\mathbf{s}_1) v_2 = \\mathbf{s}_1 (v_1 - v_2)\n$$\nHere, we can define a new stoichiometric matrix $S_{\\text{net}} = \\mathbf{s}_1 = \\begin{pmatrix} -1  -1  1 \\end{pmatrix}^{\\mathsf{T}}$ (a single column) and a scalar net rate $v_{\\text{net}} = v_1 - v_2$. The dynamics are then written as $d\\mathbf{x}/dt = S_{\\text{net}}v_{\\text{net}}$. The crucial difference lies in the constraint on the rate. Since $v_1 \\geq 0$ and $v_2 \\geq 0$, the net rate $v_{\\text{net}}$ can be positive, negative, or zero. In this \"net reaction\" formulation, the rate is a signed quantity, whereas in the \"separate reactions\" formulation, the rates are non-negative, and the directionality of the net flux arises from the competition between them. Both representations are mathematically equivalent but have different implications for numerical implementation and the interpretation of the rate vector $\\mathbf{v}$.\n\nThe final answer requested is the number of independent conservation relations. As calculated above, this number is $2$.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "While determining the number of conservation laws is a crucial first step, the real biological insight comes from identifying exactly which quantities are conserved. This practice moves from counting laws to finding them by computing a basis for the left null space of the stoichiometric matrix, $\\ker(S^{\\top})$. Working with a model of a phosphorylation cycle, you will connect the abstract vectors from this basis to tangible biochemical \"moieties,\" such as the total substrate or the total adenosine phosphate pool, whose amounts are invariant .",
            "id": "3933039",
            "problem": "A phosphorylation cycle for a substrate in a closed, well-mixed compartment is modeled with species adenosine triphosphate (ATP), adenosine diphosphate (ADP), inorganic phosphate (Pi), unphosphorylated substrate $X$, and phosphorylated substrate $X\\text{-}P$. Water is assumed buffered and not explicitly modeled. The reactions are:\n- $R_{1}$: $X + \\text{ATP} \\rightarrow X\\text{-}P + \\text{ADP}$,\n- $R_{2}$: $X\\text{-}P \\rightarrow X + \\text{Pi}$,\n- $R_{3}$: $\\text{ATP} \\rightarrow \\text{ADP} + \\text{Pi}$.\n\nLet the species ordering be $\\left(X,\\;X\\text{-}P,\\;\\text{ATP},\\;\\text{ADP},\\;\\text{Pi}\\right)$ and the reaction ordering be $\\left(R_{1},\\;R_{2},\\;R_{3}\\right)$. The stoichiometric matrix $S \\in \\mathbb{R}^{5 \\times 3}$ is defined by the net stoichiometric changes of each species per reaction:\n$$\nS \\;=\\;\n\\begin{pmatrix}\n-1  1  0 \\\\\n\\phantom{-}1  -1  0 \\\\\n-1  0  -1 \\\\\n\\phantom{-}1  0  \\phantom{-}1 \\\\\n\\phantom{-}0  \\phantom{-}1  \\phantom{-}1\n\\end{pmatrix}.\n$$\nAssume the species concentration vector $x(t) \\in \\mathbb{R}^{5}_{\\ge 0}$ evolves according to the species balance ordinary differential equation (ODE) $dx/dt = S\\,v(x)$ for some reaction rate vector $v(x) \\in \\mathbb{R}^{3}$.\n\nUsing only the foundational definitions of the stoichiometric matrix, conservation relations, and linear algebra, do the following:\n- Compute, by explicit row-reduction, a basis for the left null space $\\ker(S^{\\top})$.\n- Interpret each basis vector as a conserved moiety, stated in biochemical terms in the given species ordering.\n- As your final numeric answer, report the number of independent conservation relations. Express the final numeric answer as a unitless integer. No rounding is required.",
            "solution": "The problem asks for a basis of the left null space of the given stoichiometric matrix $S$, an interpretation of the resulting conservation laws, and the total number of such independent laws. A conservation relation is described by a vector $c$ whose dot product with the species concentration vector $x(t)$ is constant over time. This condition, $\\frac{d}{dt}(c^{\\top}x) = 0$, combined with the system's governing equation $\\frac{dx}{dt} = S v(x)$, implies that $c^{\\top}S v(x) = 0$. For this to hold for any arbitrary reaction kinetics $v(x)$, the vector $c$ must be in the left null space of $S$, i.e., $c^{\\top}S = 0^{\\top}$, which is equivalent to $S^{\\top}c = 0$. We must therefore find a basis for the null space of $S^{\\top}$, denoted $\\ker(S^{\\top})$.\n\nThe given stoichiometric matrix $S \\in \\mathbb{R}^{5 \\times 3}$ is:\n$$\nS \\;=\\;\n\\begin{pmatrix}\n-1  1  0 \\\\\n\\phantom{-}1  -1  0 \\\\\n-1  0  -1 \\\\\n\\phantom{-}1  0  \\phantom{-}1 \\\\\n\\phantom{-}0  \\phantom{-}1  \\phantom{-}1\n\\end{pmatrix}\n$$\nThe transpose of this matrix, $S^{\\top} \\in \\mathbb{R}^{3 \\times 5}$, is:\n$$\nS^{\\top} \\;=\\;\n\\begin{pmatrix}\n-1  1  -1  1  0 \\\\\n\\phantom{-}1  -1  0  0  1 \\\\\n\\phantom{-}0  0  -1  1  1\n\\end{pmatrix}\n$$\nTo find the null space of $S^{\\top}$, we solve the system of linear equations $S^{\\top}c = 0$ where $c = (c_1, c_2, c_3, c_4, c_5)^{\\top}$. We perform Gaussian elimination on $S^{\\top}$ to bring it to its reduced row echelon form (RREF).\n\nThe row-reduction process is as follows:\n$$\n\\begin{pmatrix}\n-1  1  -1  1  0 \\\\\n\\phantom{-}1  -1  0  0  1 \\\\\n\\phantom{-}0  0  -1  1  1\n\\end{pmatrix}\n\\xrightarrow{R_1 \\to -R_1}\n\\begin{pmatrix}\n1  -1  1  -1  0 \\\\\n1  -1  0  0  1 \\\\\n0  \\phantom{-}0  -1  1  1\n\\end{pmatrix}\n$$\n$$\n\\xrightarrow{R_2 \\to R_2 - R_1}\n\\begin{pmatrix}\n1  -1  1  -1  0 \\\\\n0  \\phantom{-}0  -1  1  1 \\\\\n0  \\phantom{-}0  -1  1  1\n\\end{pmatrix}\n\\xrightarrow{R_3 \\to R_3 - R_2}\n\\begin{pmatrix}\n1  -1  1  -1  0 \\\\\n0  \\phantom{-}0  -1  1  1 \\\\\n0  \\phantom{-}0  0  0  0\n\\end{pmatrix}\n$$\nTo obtain the RREF, we continue:\n$$\n\\xrightarrow{R_2 \\to -R_2}\n\\begin{pmatrix}\n1  -1  1  -1  0 \\\\\n0  \\phantom{-}0  1  -1  -1 \\\\\n0  \\phantom{-}0  0  0  0\n\\end{pmatrix}\n\\xrightarrow{R_1 \\to R_1 - R_2}\n\\begin{pmatrix}\n1  -1  0  0  1 \\\\\n0  \\phantom{-}0  1  -1  -1 \\\\\n0  \\phantom{-}0  0  0  0\n\\end{pmatrix}\n$$\nThis final matrix is the RREF of $S^{\\top}$. From the RREF, we can write the equivalent system of equations:\n$$\nc_1 - c_2 + c_5 = 0 \\\\\nc_3 - c_4 - c_5 = 0\n$$\nThe leading $1$s are in columns $1$ and $3$, so the pivot variables are $c_1$ and $c_3$. The other variables, $c_2$, $c_4$, and $c_5$, are free variables. We express the pivot variables in terms of the free variables:\n$$\nc_1 = c_2 - c_5 \\\\\nc_3 = c_4 + c_5\n$$\nThe general solution vector $c \\in \\ker(S^{\\top})$ is:\n$$\nc = \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\\\ c_4 \\\\ c_5 \\end{pmatrix} = \\begin{pmatrix} c_2 - c_5 \\\\ c_2 \\\\ c_4 + c_5 \\\\ c_4 \\\\ c_5 \\end{pmatrix}\n$$\nWe can express $c$ as a linear combination of vectors by setting each free variable to $1$ and the others to $0$:\n$$\nc = c_2 \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + c_4 \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} + c_5 \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nA basis for $\\ker(S^{\\top})$ is the set of these three linearly independent vectors:\n$$\n\\mathcal{B} = \\left\\{ b_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, b_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, b_3 = \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}\n$$\nThe number of independent conservation relations is the dimension of this basis, which is $3$.\n\nNext, we interpret each basis vector as a conserved moiety. The species ordering is $\\left(X,\\;X\\text{-}P,\\;\\text{ATP},\\;\\text{ADP},\\;\\text{Pi}\\right)$.\n\nFor the basis vector $b_1 = (1, 1, 0, 0, 0)^{\\top}$, the conservation law is $b_1^{\\top}x(t) = \\text{constant}$:\n$$ (1)[X] + (1)[X\\text{-}P] + (0)[\\text{ATP}] + (0)[\\text{ADP}] + (0)[\\text{Pi}] = C_1 $$\nThis gives the relation $[X] + [X\\text{-}P] = C_1$. This moiety represents the total concentration of the substrate, which is conserved because the reactions only interconvert the unphosphorylated ($X$) and phosphorylated ($X\\text{-}P$) forms.\n\nFor the basis vector $b_2 = (0, 0, 1, 1, 0)^{\\top}$, the conservation law is $b_2^{\\top}x(t) = \\text{constant}$:\n$$ (0)[X] + (0)[X\\text{-}P] + (1)[\\text{ATP}] + (1)[\\text{ADP}] + (0)[\\text{Pi}] = C_2 $$\nThis gives the relation $[\\text{ATP}] + [\\text{ADP}] = C_2$. This moiety represents the conservation of the total adenosine pool. The reactions interconvert $\\text{ATP}$ and $\\text{ADP}$ but do not change the total number of adenosine-containing molecules.\n\nFor the basis vector $b_3 = (-1, 0, 1, 0, 1)^{\\top}$, the conservation law is $b_3^{\\top}x(t) = \\text{constant}$:\n$$ (-1)[X] + (0)[X\\text{-}P] + (1)[\\text{ATP}] + (0)[\\text{ADP}] + (1)[\\text{Pi}] = C_3 $$\nThis gives the relation $[\\text{ATP}] + [\\text{Pi}] - [X] = C_3$. This is a stoichiometric constraint that couples the phosphate and substrate pools. It indicates that the quantity $([\\text{ATP}] + [\\text{Pi}])$ changes in tandem with $[X]$ across all reactions, such that their difference remains constant.\n\nThe number of independent conservation relations is the dimension of the left null space of $S$, which we found to be $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "As models grow in complexity to represent realistic biological pathways, the risk of introducing errors in their formulation increases. This advanced practice demonstrates how the principles of stoichiometry serve as a powerful tool for model validation. By constructing a stoichiometric matrix for a simplified glycolysis network, you will use fundamental conservation laws—such as the conservation of atoms and charge—to programmatically verify the chemical and physical consistency of the model, a critical quality-control step in systems biology .",
            "id": "3933005",
            "problem": "You are tasked with constructing and analyzing the stoichiometric matrix for a simplified glycolysis network used in biomedical systems modeling. The formulation must respect conservation relations derived from chemical element counts and electrical charge. Begin from the standard dynamical representation of a reaction network, where the time evolution of metabolite concentrations is given by $ \\frac{d\\mathbf{x}}{dt} = S \\mathbf{v} $, with $ S \\in \\mathbb{R}^{m \\times r} $ the stoichiometric matrix for $ m $ metabolites and $ r $ reactions, and $ \\mathbf{v} \\in \\mathbb{R}^{r} $ the vector of reaction rates. The conservation relations correspond to vectors in the left nullspace of $ S $, i.e., any $ \\boldsymbol{\\ell} \\in \\mathbb{R}^{m} $ such that $ S^{\\mathsf{T}} \\boldsymbol{\\ell} = \\mathbf{0} $ implies $ \\boldsymbol{\\ell}^{\\mathsf{T}} \\mathbf{x}(t) = \\text{constant} $ along trajectories permitted by the network.\n\nConstruct $ S $ for the following species set and reaction list, ensuring conservation of total carbon atoms, total phosphorus atoms, and net electrical charge. Additionally, verify conservation of the nicotinamide adenine dinucleotide (NAD) pool and the adenylate pool. For clarity, each metabolite is characterized by its carbon count, phosphorus count, and net charge. Use these counts to define moiety-conservation vectors.\n\nSpecies list (each item shows name, carbon atoms $C$, phosphorus atoms $P$, and net charge $Q$):\n- Glucose (Glc): $C = 6$, $P = 0$, $Q = 0$.\n- Glucose-6-phosphate (G6P): $C = 6$, $P = 1$, $Q = -2$.\n- Fructose-6-phosphate (F6P): $C = 6$, $P = 1$, $Q = -2$.\n- Fructose-1,6-bisphosphate (FBP): $C = 6$, $P = 2$, $Q = -4$.\n- Glyceraldehyde-3-phosphate (GAP): $C = 3$, $P = 1$, $Q = -2$.\n- Dihydroxyacetone phosphate (DHAP): $C = 3$, $P = 1$, $Q = -2$.\n- 1,3-bisphosphoglycerate (BPG13): $C = 3$, $P = 2$, $Q = -4$.\n- 3-phosphoglycerate (PG3): $C = 3$, $P = 1$, $Q = -3$.\n- 2-phosphoglycerate (PG2): $C = 3$, $P = 1$, $Q = -3$.\n- Phosphoenolpyruvate (PEP): $C = 3$, $P = 1$, $Q = -3$.\n- Pyruvate (Pyr): $C = 3$, $P = 0$, $Q = -1$.\n- Lactate (Lac): $C = 3$, $P = 0$, $Q = -1$.\n- Adenosine triphosphate (ATP): $C = 0$, $P = 3$, $Q = -4$.\n- Adenosine diphosphate (ADP): $C = 0$, $P = 2$, $Q = -3$.\n- Inorganic phosphate (Pi): $C = 0$, $P = 1$, $Q = -2$.\n- Nicotinamide adenine dinucleotide oxidized form (NAD$^+$): $C = 0$, $P = 0$, $Q = +1$.\n- Nicotinamide adenine dinucleotide reduced form (NADH): $C = 0$, $P = 0$, $Q = 0$.\n- Water ($\\text{H}_2\\text{O}$): $C = 0$, $P = 0$, $Q = 0$.\n- Proton (H$^+$): $C = 0$, $P = 0$, $Q = +1$.\n\nDefine the following reaction set with stoichiometric coefficients (reactants have negative coefficients, products have positive coefficients):\n- Hexokinase (HK): Glc $(-1)$, ATP $(-1)$, G6P $(+1)$, ADP $(+1)$, H$^+$ $(+1)$.\n- Phosphoglucose isomerase (PGI): G6P $(-1)$, F6P $(+1)$.\n- Phosphofructokinase (PFK): F6P $(-1)$, ATP $(-1)$, FBP $(+1)$, ADP $(+1)$, H$^+$ $(+1)$.\n- Aldolase: FBP $(-1)$, GAP $(+1)$, DHAP $(+1)$.\n- Triose phosphate isomerase (TPI): DHAP $(-1)$, GAP $(+1)$.\n- Glyceraldehyde-3-phosphate dehydrogenase (GAPDH): GAP $(-1)$, Pi $(-1)$, NAD$^+$ $(-1)$, BPG13 $(+1)$, NADH $(+1)$, H$^+$ $(+1)$.\n- Phosphoglycerate kinase (PGK): BPG13 $(-1)$, ADP $(-1)$, PG3 $(+1)$, ATP $(+1)$.\n- Phosphoglycerate mutase (PGM): PG3 $(-1)$, PG2 $(+1)$.\n- Enolase: PG2 $(-1)$, PEP $(+1)$, $\\text{H}_2\\text{O}$ $(+1)$.\n- Pyruvate kinase (PK): PEP $(-1)$, ADP $(-1)$, H$^+$ $(-1)$, Pyr $(+1)$, ATP $(+1)$.\n- Lactate dehydrogenase (LDH): Pyr $(-1)$, NADH $(-1)$, H$^+$ $(-1)$, Lac $(+1)$, NAD$^+$ $(+1)$.\n\nConstruct $ S $ for this species and reaction set. Define the moiety vectors $ \\mathbf{c} $ (carbon atoms), $ \\mathbf{p} $ (phosphorus atoms), $ \\mathbf{q} $ (net charge), $ \\mathbf{n} $ (NAD pool with entries $1$ for NAD$^+$ and NADH, $0$ otherwise), and $ \\mathbf{a} $ (adenylate pool with entries $1$ for ATP and ADP, $0$ otherwise). Verify conservation by checking $ S^{\\mathsf{T}} \\mathbf{c} = \\mathbf{0} $, $ S^{\\mathsf{T}} \\mathbf{p} = \\mathbf{0} $, $ S^{\\mathsf{T}} \\mathbf{q} = \\mathbf{0} $, $ S^{\\mathsf{T}} \\mathbf{n} = \\mathbf{0} $, and $ S^{\\mathsf{T}} \\mathbf{a} = \\mathbf{0} $.\n\nIn addition to the baseline network, evaluate the impact of deliberately introduced imbalances to test the robustness of conservation detection:\n- Case A (baseline): Use the reaction set as defined above.\n- Case B (charge-imbalanced): Modify HK by removing H$^+$, i.e., Glc $(-1)$, ATP $(-1)$, G6P $(+1)$, ADP $(+1)$.\n- Case C (phosphorus- and charge-imbalanced): Modify GAPDH by removing Pi, i.e., GAP $(-1)$, NAD$^+$ $(-1)$, BPG13 $(+1)$, NADH $(+1)$, H$^+$ $(+1)$.\n- Case D (adenylate-, phosphorus-, and charge-imbalanced): Modify PK by removing ADP, i.e., PEP $(-1)$, H$^+$ $(-1)$, Pyr $(+1)$, ATP $(+1)$.\n\nFor each case, compute:\n- A boolean for charge conservation $b_q$ defined by whether $ \\lVert S^{\\mathsf{T}} \\mathbf{q} \\rVert_\\infty $ is exactly zero.\n- A boolean for carbon conservation $b_c$ defined by whether $ \\lVert S^{\\mathsf{T}} \\mathbf{c} \\rVert_\\infty $ is exactly zero.\n- A boolean for phosphorus conservation $b_p$ defined by whether $ \\lVert S^{\\mathsf{T}} \\mathbf{p} \\rVert_\\infty $ is exactly zero.\n- A boolean for NAD pool conservation $b_n$ defined by whether $ \\lVert S^{\\mathsf{T}} \\mathbf{n} \\rVert_\\infty $ is exactly zero.\n- A boolean for adenylate pool conservation $b_a$ defined by whether $ \\lVert S^{\\mathsf{T}} \\mathbf{a} \\rVert_\\infty $ is exactly zero.\n- The rank of $ S $ as an integer.\n- The dimension of the left nullspace of $ S $ as the integer $ m - \\operatorname{rank}(S) $.\n- The dimension of the right nullspace of $ S $ as the integer $ r - \\operatorname{rank}(S) $.\n\nNo physical units are needed for this task. Your program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, where each case’s result is itself a comma-separated list in square brackets of the form $[b_q,b_c,b_p,b_n,b_a,\\operatorname{rank},m-\\operatorname{rank},r-\\operatorname{rank}]$. For example, the final output format is $[[\\dots],[\\dots],[\\dots],[\\dots]]$ without any spaces.",
            "solution": "The problem requires the construction and analysis of the stoichiometric matrix $S$ for a simplified model of glycolysis. This analysis is central to understanding the structural properties of metabolic networks, particularly their conservation relations. The network's dynamics are described by the ordinary differential equation $\\frac{d\\mathbf{x}}{dt} = S \\mathbf{v}$, where $\\mathbf{x} \\in \\mathbb{R}^{m}$ is the vector of metabolite concentrations, $\\mathbf{v} \\in \\mathbb{R}^{r}$ is the vector of reaction rates (fluxes), and $S \\in \\mathbb{R}^{m \\times r}$ is the stoichiometric matrix for $m$ species and $r$ reactions. A conservation law is represented by a vector $\\boldsymbol{\\ell} \\in \\mathbb{R}^{m}$ in the left nullspace of $S$, meaning it satisfies the condition $S^{\\mathsf{T}} \\boldsymbol{\\ell} = \\mathbf{0}$. This implies that the total quantity $\\boldsymbol{\\ell}^{\\mathsf{T}} \\mathbf{x}(t)$ remains constant over time.\n\nFirst, we define the ordered sets of species and reactions to establish a consistent structure for the matrix and vectors. The system consists of $m=19$ species and $r=11$ reactions.\n\nThe ordered species vector is $\\mathbf{x} = (x_{\\text{Glc}}, x_{\\text{G6P}}, x_{\\text{F6P}}, x_{\\text{FBP}}, x_{\\text{GAP}}, x_{\\text{DHAP}}, x_{\\text{BPG13}}, x_{\\text{PG3}}, x_{\\text{PG2}}, x_{\\text{PEP}}, x_{\\text{Pyr}}, x_{\\text{Lac}}, x_{\\text{ATP}}, x_{\\text{ADP}}, x_{\\text{Pi}}, x_{\\text{NAD}^+}, x_{\\text{NADH}}, x_{\\text{H}_2\\text{O}}, x_{\\text{H}^+})^{\\mathsf{T}}$.\n\nThe ordered reaction flux vector is $\\mathbf{v} = (v_{\\text{HK}}, v_{\\text{PGI}}, v_{\\text{PFK}}, v_{\\text{Aldolase}}, v_{\\text{TPI}}, v_{\\text{GAPDH}}, v_{\\text{PGK}}, v_{\\text{PGM}}, v_{\\text{Enolase}}, v_{\\text{PK}}, v_{\\text{LDH}})^{\\mathsf{T}}$.\n\nBased on the provided properties for each species, we construct the five moiety vectors that represent the quantities to be tested for conservation. These are vectors in $\\mathbb{R}^{19}$:\n- Carbon conservation vector $\\mathbf{c}$: The $i$-th entry is the number of carbon atoms in species $i$.\n$\\mathbf{c}^{\\mathsf{T}} = [6, 6, 6, 6, 3, 3, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0]$.\n- Phosphorus conservation vector $\\mathbf{p}$: The $i$-th entry is the number of phosphorus atoms in species $i$.\n$\\mathbf{p}^{\\mathsf{T}} = [0, 1, 1, 2, 1, 1, 2, 1, 1, 1, 0, 0, 3, 2, 1, 0, 0, 0, 0]$.\n- Charge conservation vector $\\mathbf{q}$: The $i$-th entry is the net electrical charge of species $i$.\n$\\mathbf{q}^{\\mathsf{T}} = [0, -2, -2, -4, -2, -2, -4, -3, -3, -3, -1, -1, -4, -3, -2, 1, 0, 0, 1]$.\n- NAD pool vector $\\mathbf{n}$: The $i$-th entry is $1$ if species $i$ is $\\text{NAD}^+$ or $\\text{NADH}$, and $0$ otherwise.\n$\\mathbf{n}^{\\mathsf{T}} = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0]$.\n- Adenylate pool vector $\\mathbf{a}$: The $i$-th entry is $1$ if species $i$ is $\\text{ATP}$ or $\\text{ADP}$, and $0$ otherwise.\n$\\mathbf{a}^{\\mathsf{T}} = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0]$.\n\nFor each of the four cases, we construct the corresponding $19 \\times 11$ stoichiometric matrix $S$ where the element $S_{ij}$ is the stoichiometric coefficient of species $i$ in reaction $j$. We then perform the required calculations.\n\nCase A (Baseline): The matrix $S_A$ is constructed using the reaction stoichiometries as provided. For each reaction $j$, we check if the net change in a conserved quantity is zero. For example, for carbon conservation in reaction $j$, we compute $(\\mathbf{s}_j)^{\\mathsf{T}} \\mathbf{c}$, where $\\mathbf{s}_j$ is the $j$-th column of $S_A$. If this is zero for all $j=1, \\dots, 11$, then $S_A^{\\mathsf{T}} \\mathbf{c} = \\mathbf{0}$ and carbon is conserved. All five properties (carbon, phosphorus, charge, NAD pool, adenylate pool) are found to be conserved. The boolean flags are $b_q=\\text{True}$, $b_c=\\text{True}$, $b_p=\\text{True}$, $b_n=\\text{True}$, $b_a=\\text{True}$. The rank of $S_A$ is computed to be $\\operatorname{rank}(S_A)=11$. The dimension of the left nullspace is $m - \\operatorname{rank}(S_A) = 19 - 11 = 8$. The dimension of the right nullspace is $r - \\operatorname{rank}(S_A) = 11 - 11 = 0$.\n\nCase B (charge-imbalanced): The Hexokinase (HK) reaction is modified by removing the product $\\text{H}^+$. This alters the first column of the stoichiometric matrix, $S_B$. The change in charge for the HK reaction is now $\\Delta Q = Q_{\\text{G6P}} + Q_{\\text{ADP}} - Q_{\\text{Glc}} - Q_{\\text{ATP}} = (-2) + (-3) - (0) - (-4) = -1 \\neq 0$. Thus, charge is not conserved. All other conservation properties for this reaction, and all properties for other reactions, remain balanced. The results are $b_q=\\text{False}$, $b_c=\\text{True}$, $b_p=\\text{True}$, $b_n=\\text{True}$, $b_a=\\text{True}$. The matrix $S_B$ remains full-rank, $\\operatorname{rank}(S_B)=11$, so the nullspace dimensions are unchanged: $8$ and $0$.\n\nCase C (phosphorus- and charge-imbalanced): The Glyceraldehyde-3-phosphate dehydrogenase (GAPDH) reaction is modified by removing the reactant $\\text{Pi}$. This alters the sixth column of the matrix, $S_C$. The change in phosphorus is $\\Delta P = P_{\\text{BPG13}} + \\dots - P_{\\text{GAP}} - \\dots = 2 - 1 = 1 \\neq 0$. The change in charge is $\\Delta Q = Q_{\\text{BPG13}} + Q_{\\text{NADH}} + Q_{\\text{H}^+} - Q_{\\text{GAP}} - Q_{\\text{NAD}^+} = (-4) + (0) + 1 - (-2) - (1) = -2 \\neq 0$. Carbon and the NAD/adenylate pools are unaffected. The results are $b_q=\\text{False}$, $b_c=\\text{True}$, $b_p=\\text{False}$, $b_n=\\text{True}$, $b_a=\\text{True}$. The rank of $S_C$ is found to be $11$, with nullspace dimensions $8$ and $0$.\n\nCase D (adenylate-, phosphorus-, and charge-imbalanced): The Pyruvate kinase (PK) reaction is modified by removing the reactant $\\text{ADP}$. This alters the tenth column of the matrix, $S_D$. The adenylate pool is no longer balanced: $\\Delta a = a_{\\text{ATP}} - \\dots = 1 \\neq 0$. The change in phosphorus is $\\Delta P = P_{\\text{Pyr}} + P_{\\text{ATP}} - P_{\\text{PEP}} - \\dots = 0 + 3 - 1 = 2 \\neq 0$. The change in charge is $\\Delta Q = Q_{\\text{Pyr}} + Q_{\\text{ATP}} - Q_{\\text{PEP}} - Q_{\\text{H}^+} = (-1) + (-4) - (-3) - 1 = -3 \\neq 0$. The results are $b_q=\\text{False}$, $b_c=\\text{True}$, $b_p=\\text{False}$, $b_n=\\text{True}$, $b_a=\\text{False}$. The rank of $S_D$ is $11$, with nullspace dimensions $8$ and $0$.\n\nThe analysis confirms that the mathematical framework of stoichiometric matrices and their nullspaces provides a robust method for automatically verifying fundamental conservation laws in a complex biochemical network and for pinpointing the source of any imbalances.",
            "answer": "[[True,True,True,True,True,11,8,0],[False,True,True,True,True,11,8,0],[False,True,False,True,True,11,8,0],[False,True,False,True,False,11,8,0]]"
        }
    ]
}