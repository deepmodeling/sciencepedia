{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex derivations or simulations, it's essential to have a firm grasp of the physical quantities involved in the bidomain and monodomain models. This practice focuses on dimensional analysis, a fundamental skill that ensures the mathematical model is physically consistent. By working through the units and performing a sample calculation, you will gain an intuitive understanding of how microscopic properties like membrane capacitance ($C_m$) and surface-to-volume ratio ($\\beta$) scale up to create the macroscopic current sources that drive cardiac electrophysiology .",
            "id": "3872430",
            "problem": "In the bidomain and monodomain formulations for cardiac tissue, the tissue-level intracellular and extracellular current densities are modeled as continuum fields, and the transmembrane dynamics appear as volumetric source terms in the governing partial differential equations (PDEs). Starting from conservation of electric charge and the definition of flux divergence in a continuum, determine the units of the transmembrane current density per membrane area $I_{m}$, the membrane capacitance per membrane area $C_{m}$, the transmembrane potential $V_{m}$, and the membrane surface-area-to-volume ratio $\\beta$ such that both the resistive source term $\\beta I_{m}$ and the capacitive source term $\\beta C_{m} \\frac{\\partial V_m}{\\partial t}$ have units of amperes per cubic meter.\n\nThen, using the following physiologically plausible parameter values,\n- $C_{m} = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$,\n- $\\beta = 1400\\,\\mathrm{cm}^{-1}$,\n- $\\frac{\\partial V_m}{\\partial t} = 200\\,\\mathrm{V}/\\mathrm{s}$,\ncompute the magnitude of the capacitive volumetric source term $\\beta C_{m} \\frac{\\partial V_m}{\\partial t}$ and report its value in $\\mathrm{A}/\\mathrm{m}^{3}$. Round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- The resistive source term is $\\beta I_{m}$.\n- The capacitive source term is $\\beta C_{m} \\frac{\\partial V_m}{\\partial t}$.\n- The required units for both source terms are amperes per cubic meter ($\\mathrm{A}/\\mathrm{m}^{3}$).\n- $I_{m}$ is the transmembrane current density per membrane area.\n- $C_{m}$ is the membrane capacitance per membrane area.\n- $V_{m}$ is the transmembrane potential.\n- $\\beta$ is the membrane surface-area-to-volume ratio.\n- Parameter values for calculation:\n  - $C_{m} = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$\n  - $\\beta = 1400\\,\\mathrm{cm}^{-1}$\n  - $\\frac{\\partial V_m}{\\partial t} = 200\\,\\mathrm{V}/\\mathrm{s}$\n- The final numerical answer must be in $\\mathrm{A}/\\mathrm{m}^{3}$ and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established bidomain and monodomain theories of cardiac electrophysiology, which are standard models in the field. The quantities defined ($\\beta$, $I_m$, $C_m$, $V_m$) and their relationships are fundamental to these models. The given parameter values are physiologically plausible. The problem is well-posed, consisting of a dimensional analysis task and a direct calculation, both of which have unique solutions. The language is objective and precise. The problem is self-contained and free from contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe problem consists of two parts. The first is a dimensional analysis to determine the units of the individual quantities. The second is a numerical calculation of the capacitive source term.\n\n### Part 1: Dimensional Analysis\n\nLet $[X]$ denote the physical units of a quantity $X$. We are given that the volumetric source terms have units of amperes per cubic meter.\n$$[\\beta I_{m}] = \\frac{\\mathrm{A}}{\\mathrm{m}^{3}}$$\n$$[\\beta C_{m} \\frac{\\partial V_m}{\\partial t}] = \\frac{\\mathrm{A}}{\\mathrm{m}^{3}}$$\n\nFirst, we determine the units of $\\beta$, the membrane surface-area-to-volume ratio. In SI units, area is measured in square meters ($\\mathrm{m}^{2}$) and volume in cubic meters ($\\mathrm{m}^{3}$).\n$$[\\beta] = \\frac{[\\text{Area}]}{[\\text{Volume}]} = \\frac{\\mathrm{m}^{2}}{\\mathrm{m}^{3}} = \\mathrm{m}^{-1}$$\n\nNext, we find the units of the transmembrane potential, $V_{m}$. As a potential, its standard unit is the Volt ($\\mathrm{V}$).\n$$[V_{m}] = \\mathrm{V}$$\n\nNow, we can determine the units of the transmembrane current density, $I_{m}$, using the resistive source term.\n$$[\\beta] [I_{m}] = \\frac{\\mathrm{A}}{\\mathrm{m}^{3}}$$\n$$[\\mathrm{m}^{-1}] [I_{m}] = \\mathrm{A}\\,\\mathrm{m}^{-3}$$\nSolving for $[I_{m}]$:\n$$[I_{m}] = \\frac{\\mathrm{A}\\,\\mathrm{m}^{-3}}{\\mathrm{m}^{-1}} = \\mathrm{A}\\,\\mathrm{m}^{-2}$$\nThis is consistent with the definition of $I_{m}$ as a current density per membrane area (current per area).\n\nFinally, we determine the units of the membrane capacitance per area, $C_{m}$, using the capacitive source term. First, we establish the units of the time derivative of the transmembrane potential, $\\frac{\\partial V_m}{\\partial t}$.\n$$\\left[\\frac{\\partial V_{m}}{\\partial t}\\right] = \\frac{[V_{m}]}{[t]} = \\frac{\\mathrm{V}}{\\mathrm{s}}$$\nNow we use the full capacitive term expression:\n$$[\\beta] [C_{m}] \\left[\\frac{\\partial V_{m}}{\\partial t}\\right] = \\frac{\\mathrm{A}}{\\mathrm{m}^{3}}$$\n$$[\\mathrm{m}^{-1}] [C_{m}] \\left[\\mathrm{V}\\,\\mathrm{s}^{-1}\\right] = \\mathrm{A}\\,\\mathrm{m}^{-3}$$\nSolving for $[C_{m}]$:\n$$[C_{m}] = \\frac{\\mathrm{A}\\,\\mathrm{m}^{-3}}{\\mathrm{m}^{-1}\\,\\mathrm{V}\\,\\mathrm{s}^{-1}} = \\mathrm{A}\\,\\mathrm{s}\\,\\mathrm{V}^{-1}\\,\\mathrm{m}^{-2}$$\nWe recall the definitions of the Farad (unit of capacitance) and the Ampere (unit of current). Capacitance is charge per voltage, $1\\,\\mathrm{F} = 1\\,\\mathrm{C}/\\mathrm{V}$. Current is charge per time, $1\\,\\mathrm{A} = 1\\,\\mathrm{C}/\\mathrm{s}$, which implies $1\\,\\mathrm{C} = 1\\,\\mathrm{A} \\cdot \\mathrm{s}$. Substituting this into the expression for $[C_{m}]$:\n$$[C_{m}] = (\\mathrm{A}\\,\\mathrm{s})\\,\\mathrm{V}^{-1}\\,\\mathrm{m}^{-2} = \\mathrm{C}\\,\\mathrm{V}^{-1}\\,\\mathrm{m}^{-2} = \\mathrm{F}\\,\\mathrm{m}^{-2}$$\nThis is consistent with the definition of $C_{m}$ as a capacitance per membrane area.\n\nIn summary, the units are:\n- $[\\beta] = \\mathrm{m}^{-1}$\n- $[V_{m}] = \\mathrm{V}$\n- $[I_{m}] = \\mathrm{A}\\,\\mathrm{m}^{-2}$\n- $[C_{m}] = \\mathrm{F}\\,\\mathrm{m}^{-2}$\n\n### Part 2: Numerical Calculation\n\nWe are asked to compute the magnitude of the capacitive volumetric source term, $S_{cap} = \\beta C_m \\frac{\\partial V_m}{\\partial t}$.\nThe given parameter values are:\n- $C_{m} = 1.0\\,\\mu\\mathrm{F}/\\mathrm{cm}^{2}$\n- $\\beta = 1400\\,\\mathrm{cm}^{-1}$\n- $\\frac{\\partial V_{m}}{\\partial t} = 200\\,\\mathrm{V}/\\mathrm{s}$\n\nTo obtain a result in $\\mathrm{A}/\\mathrm{m}^{3}$, we must convert the parameters to SI units (meters, farads, volts, seconds).\n\nThe conversion for $\\beta$:\n$$1\\,\\mathrm{cm} = 10^{-2}\\,\\mathrm{m} \\implies 1\\,\\mathrm{cm}^{-1} = (10^{-2})^{-1}\\,\\mathrm{m}^{-1} = 10^{2}\\,\\mathrm{m}^{-1}$$\n$$\\beta = 1400\\,\\mathrm{cm}^{-1} = 1400 \\times 10^{2}\\,\\mathrm{m}^{-1} = 1.4 \\times 10^{3} \\times 10^{2}\\,\\mathrm{m}^{-1} = 1.4 \\times 10^{5}\\,\\mathrm{m}^{-1}$$\n\nThe conversion for $C_{m}$:\n$$1\\,\\mu\\mathrm{F} = 10^{-6}\\,\\mathrm{F}$$\n$$1\\,\\mathrm{cm}^{2} = (10^{-2}\\,\\mathrm{m})^{2} = 10^{-4}\\,\\mathrm{m}^{2}$$\n$$C_{m} = 1.0\\,\\frac{\\mu\\mathrm{F}}{\\mathrm{cm}^{2}} = 1.0 \\times \\frac{10^{-6}\\,\\mathrm{F}}{10^{-4}\\,\\mathrm{m}^{2}} = 1.0 \\times 10^{-2}\\,\\mathrm{F}\\,\\mathrm{m}^{-2}$$\n\nThe rate of change of voltage is already in SI units:\n$$\\frac{\\partial V_{m}}{\\partial t} = 200\\,\\mathrm{V}\\,\\mathrm{s}^{-1}$$\n\nNow, we compute the product:\n$$S_{cap} = \\beta \\, C_{m} \\, \\frac{\\partial V_{m}}{\\partial t}$$\n$$S_{cap} = (1.4 \\times 10^{5}\\,\\mathrm{m}^{-1}) \\times (1.0 \\times 10^{-2}\\,\\mathrm{F}\\,\\mathrm{m}^{-2}) \\times (200\\,\\mathrm{V}\\,\\mathrm{s}^{-1})$$\n$$S_{cap} = (1.4 \\times 1.0 \\times 200) \\times 10^{5-2} \\, \\frac{\\mathrm{F} \\cdot \\mathrm{V}}{\\mathrm{m}^{3} \\cdot \\mathrm{s}}$$\n$$S_{cap} = 280 \\times 10^{3} \\, \\frac{\\mathrm{A} \\cdot \\mathrm{s} \\cdot \\mathrm{V}^{-1} \\cdot \\mathrm{V}}{\\mathrm{m}^{3} \\cdot \\mathrm{s}} = 2.8 \\times 10^{5} \\, \\frac{\\mathrm{A}}{\\mathrm{m}^{3}}$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$S_{cap} = 2.800 \\times 10^{5} \\, \\mathrm{A}\\,\\mathrm{m}^{-3}$$",
            "answer": "$$\n\\boxed{2.800 \\times 10^5}\n$$"
        },
        {
            "introduction": "A key emergent property of cardiac tissue is the stable propagation of the action potential, and the monodomain model provides a powerful framework for understanding the factors that determine its speed. This practice uses concepts from reaction-diffusion theory to analyze traveling wave solutions. By linearizing the complex ionic currents at the wave's leading edge, you will derive a direct relationship between the conduction velocity and the tissue's effective diffusive and reactive properties .",
            "id": "3872389",
            "problem": "Consider a one-dimensional monodomain reaction–diffusion description of cardiac tissue given by the partial differential equation (PDE)\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2} V}{\\partial x^{2}} \\;+\\; F(V),\n$$\nwhere $V(x,t)$ is the transmembrane potential, $D>0$ is the (isotropic) effective diffusion coefficient arising from the intracellular–extracellular coupling in the monodomain reduction, and $F(V)$ represents the net reaction term due to ionic currents per unit membrane capacitance. Assume the leading edge of an excitation front invading tissue near the resting potential $V_{r}$ can be locally approximated by a linear growth law\n$$\nF(V) \\;\\approx\\; \\alpha\\,(V - V_{r}),\n$$\nwith $\\alpha>0$ representing an effective linear growth rate during the upstroke regime of the front. To ensure physical boundedness of the excited state, you may assume that $F(V)$ contains higher-order saturation terms that are negligible in the leading edge but render the fully excited state finite (for example, a cubic saturation that does not affect the linear growth at small amplitudes).\n\nUsing only first-principles reasoning based on:\n- linearization around the resting state to characterize the leading-edge dynamics, and\n- eikonal-type arguments for planar wavefronts in excitable media,\n\nderive an analytical expression for the approximate planar conduction velocity $c$ (normal front speed) in terms of $D$ and $\\alpha$. Your derivation must start from the PDE above and justify all approximations that connect the microscopic linear growth and diffusion to a macroscopic front speed for a planar wave with zero curvature. Express the final answer as a single closed-form expression involving only $D$ and $\\alpha$; no numerical evaluation or rounding is required. State any additional assumptions you use to connect the linearized leading-edge dynamics to the existence of a coherent traveling front.",
            "solution": "We begin from the monodomain reaction–diffusion PDE\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2} V}{\\partial x^{2}} \\;+\\; F(V),\n$$\nwhere $F(V)$ encodes ionic current effects per unit membrane capacitance and $D$ is the effective diffusion coefficient due to ohmic conduction in the monodomain limit. We consider the dynamics near the leading edge of an excitation front invading tissue that is initially near the resting potential $V_{r}$. Let $u(x,t) := V(x,t) - V_{r}$ denote the deviation from rest. By assumption, the reaction term is well approximated near the leading edge by a linear growth law\n$$\nF(V) \\;\\approx\\; \\alpha\\,(V - V_{r}) \\;=\\; \\alpha\\,u,\n$$\nwith $\\alpha>0$ capturing the net excitatory slope (an effective positive growth rate) during the upstroke, arising from the linearization of ionic currents in the regime where depolarizing currents dominate. Substituting $u$ yields the linearized PDE at the leading edge:\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; D\\,\\frac{\\partial^{2} u}{\\partial x^{2}} \\;+\\; \\alpha\\,u.\n$$\n\nTo ensure a physically consistent traveling-wave solution with bounded excited states behind the front, we assume that $F(V)$ contains nonlinear saturation terms (for example, a negative cubic term) that are negligible at small $u$ but limit the amplitude as $u$ grows. This assumption is standard in excitable media and reaction–diffusion systems and does not affect the determination of the front speed for so-called pulled fronts, for which the asymptotic speed is set by the linearized dynamics at the leading edge.\n\nWe now seek a planar traveling front solution with position coordinate $\\xi := x - c t$, where $c>0$ is the normal conduction velocity. In the leading edge, where $u$ is small, we linearize and look for exponential modes of the form\n$$\nu(x,t) \\;=\\; \\exp\\!\\big(\\lambda\\,\\xi\\big) \\;=\\; \\exp\\!\\big(\\lambda (x - c t)\\big),\n$$\nwith $\\lambda<0$ ensuring decay ahead of the front ($\\xi \\to +\\infty$). Substituting into the linearized PDE gives\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -c\\,\\lambda\\,\\exp(\\lambda \\xi), \\qquad\n\\frac{\\partial^{2} u}{\\partial x^{2}} \\;=\\; \\lambda^{2}\\,\\exp(\\lambda \\xi).\n$$\nThus the dispersion relation between $\\lambda$ and $c$ is\n$$\n-c\\,\\lambda \\;=\\; D\\,\\lambda^{2} \\;+\\; \\alpha \\quad\\Longrightarrow\\quad D\\,\\lambda^{2} \\;+\\; c\\,\\lambda \\;+\\; \\alpha \\;=\\; 0.\n$$\nTo realize a coherent pulled front, the solution must select a value of $c$ for which there exists an exponentially decaying mode ahead of the front. The speed selected by the linear leading-edge dynamics is the minimal speed for which such decaying modes exist, which is determined by the occurrence of a double root (marginal stability) in the quadratic dispersion relation. Specifically, the discriminant must vanish:\n$$\n\\Delta \\;=\\; c^{2} \\;-\\; 4 D \\alpha \\;=\\; 0.\n$$\nSolving for $c$ gives\n$$\nc \\;=\\; 2\\,\\sqrt{D\\,\\alpha}.\n$$\n\nThis result can be justified by the following first-principles considerations:\n- The linearization determines the exponential rate of growth $\\alpha$ at the leading edge, which is the mechanism by which small perturbations amplify to form the front.\n- Diffusion smooths spatial gradients with characteristic length scale set by the inverse of $|\\lambda|$, which balances growth against diffusion.\n- The pulled-front selection principle states that the asymptotic front speed is set by the marginally stable mode in the leading edge, corresponding to the double root of the dispersion relation.\n\nIn the language of eikonal arguments for excitable media, the normal front speed for a planar wave (zero curvature) equals the one-dimensional speed selected by the leading-edge dynamics. When curvature is present, the eikonal–curvature relation modifies the speed to $c_{n} \\approx c_{0} - D\\,\\kappa$, where $c_{0}$ is the planar speed and $\\kappa$ is the local curvature, but for a planar front $\\kappa=0$, so $c_{n} = c_{0}$. Thus the eikonal framework is consistent with taking the planar speed equal to the one-dimensional pulled-front speed computed above.\n\nTherefore, under the stated assumptions, the approximate relation between conduction velocity and the diffusion coefficient and linear growth rate is\n$$\nc \\;\\approx\\; 2\\,\\sqrt{D\\,\\alpha}.\n$$\n\nAssumptions used:\n- The net reaction term $F(V)$ has a positive linear growth coefficient $\\alpha$ in the leading edge during the upstroke, ensuring local amplification of small deviations.\n- Saturation terms in $F(V)$ render the excited state bounded but are negligible in the leading edge; the asymptotic speed is determined by the linearized dynamics (pulled-front selection).\n- The front is planar (zero curvature), so eikonal–curvature corrections vanish and the planar speed equals the one-dimensional pulled-front speed.",
            "answer": "$$\\boxed{2\\,\\sqrt{D\\,\\alpha}}$$"
        },
        {
            "introduction": "To solve the bidomain equations for realistic, complex scenarios, we must turn to numerical methods like the Finite Element Method (FEM). This exercise guides you through the critical first step: deriving the semi-discrete weak formulation of the bidomain system. This process transforms the continuous partial differential equations into a system of matrix equations that can be solved computationally, forming the backbone of virtually all modern bidomain simulation software .",
            "id": "3872383",
            "problem": "Consider a bounded, Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\in \\{2,3\\}$ representing cardiac tissue, and let the intracellular and extracellular conductivity tensors be $\\boldsymbol{\\sigma}_{i}(\\mathbf{x})$ and $\\boldsymbol{\\sigma}_{e}(\\mathbf{x})$, respectively, where each is symmetric and uniformly positive definite on $\\Omega$. Let $V_{m}(\\mathbf{x},t)$ denote the transmembrane potential and $\\phi_{e}(\\mathbf{x},t)$ the extracellular potential, related to the intracellular potential by $\\phi_{i} = V_{m} + \\phi_{e}$. Assume zero-flux boundary conditions $\\,\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i} \\nabla \\phi_{i} = 0\\,$ and $\\,\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{e} \\nabla \\phi_{e} = 0\\,$ on $\\partial \\Omega$. The bidomain equations in $(V_{m},\\phi_{e})$ form are given by charge conservation and Ohm’s law: intracellular current density $\\mathbf{i}_{i} = -\\boldsymbol{\\sigma}_{i}\\nabla \\phi_{i}$, extracellular current density $\\mathbf{i}_{e} = -\\boldsymbol{\\sigma}_{e}\\nabla \\phi_{e}$, membrane ionic current density $I_{\\text{ion}}(V_{m},\\mathbf{w})$ (with $\\mathbf{w}$ denoting hidden state variables), membrane capacitance $C_{m}$, and surface-to-volume ratio $\\beta$. Consider a transmembrane stimulus $I_{\\text{app}}(\\mathbf{x},t)$ entering the $V_{m}$ equation. The resulting Partial Differential Equation (PDE) system reads\n$$\n\\beta C_m \\frac{\\partial V_m}{\\partial t} + \\beta\\,I_{\\text{ion}}(V_{m},\\mathbf{w}) - \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla V_{m}\\right) - \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}\\right) = I_{\\text{app}},\n$$\n$$\n\\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla V_{m}\\right) + \\nabla \\cdot \\!\\left((\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e}\\right) = 0,\n$$\nwith homogeneous Neumann boundary conditions implied by the physical no-flux assumptions.\n\nLet $\\mathcal{T}_{h}$ be a conforming simplicial mesh of $\\Omega$, and let $V_{h}$ be the standard $H^{1}$-conforming Finite Element Method (FEM) space of continuous, piecewise linear functions on $\\mathcal{T}_{h}$ with nodal basis $\\{N_{j}\\}_{j=1}^{n}$. Seek $V_{m}^{h}(\\mathbf{x},t) = \\sum_{j=1}^{n} V_{j}(t)\\,N_{j}(\\mathbf{x})$ and $\\phi_{e}^{h}(\\mathbf{x},t) = \\sum_{j=1}^{n} \\Phi_{j}(t)\\,N_{j}(\\mathbf{x})$ in $V_{h}$ for both unknowns (same space and basis). Using the Galerkin method, construct the semi-discrete system (space discretized, time continuous) by testing with arbitrary $v_{h},w_{h} \\in V_{h}$, integrating by parts, and using the homogeneous Neumann boundary conditions to eliminate boundary terms. Define the assembled matrices and vectors:\n- the mass matrix $M \\in \\mathbb{R}^{n \\times n}$, $M_{ij} = \\int_{\\Omega} N_{i}N_{j}\\,d\\mathbf{x}$,\n- the intracellular stiffness matrix $K_{i} \\in \\mathbb{R}^{n \\times n}$, $(K_{i})_{ij} = \\int_{\\Omega} \\nabla N_{i}\\cdot \\boldsymbol{\\sigma}_{i}\\nabla N_{j}\\,d\\mathbf{x}$,\n- the extracellular stiffness matrix $K_{e} \\in \\mathbb{R}^{n \\times n}$, $(K_{e})_{ij} = \\int_{\\Omega} \\nabla N_{i}\\cdot \\boldsymbol{\\sigma}_{e}\\nabla N_{j}\\,d\\mathbf{x}$,\n- the ionic vector $\\mathbf{F}(\\mathbf{V}) \\in \\mathbb{R}^{n}$, with $F_{i}(\\mathbf{V}) = \\int_{\\Omega} N_{i}\\,I_{\\text{ion}}\\!\\left(\\sum_{j=1}^{n} V_{j}N_{j},\\mathbf{w}\\right)d\\mathbf{x}$,\n- the stimulus vector $\\mathbf{P} \\in \\mathbb{R}^{n}$, $P_{i} = \\int_{\\Omega} N_{i}\\,I_{\\text{app}}\\,d\\mathbf{x}$,\nand denote the coefficient vectors by $\\mathbf{V}(t) = (V_{1}(t),\\dots,V_{n}(t))^{\\top}$ and $\\boldsymbol{\\Phi}(t) = (\\Phi_{1}(t),\\dots,\\Phi_{n}(t))^{\\top}$. Write the resulting semi-discrete matrix system compactly in block form. Your final answer must be the single, closed-form analytic block-matrix expression for the semi-discrete system, with all quantities defined above. No numerical evaluation is required.",
            "solution": "The problem is to derive the semi-discrete finite element approximation of the bidomain equations of cardiac electrophysiology. The problem is valid as it is scientifically grounded in established biophysical models, mathematically well-posed, and all terms and conditions are specified precisely and consistently.\n\nThe continuous problem is given by the following system of partial differential equations for the transmembrane potential $V_{m}(\\mathbf{x},t)$ and the extracellular potential $\\phi_{e}(\\mathbf{x},t)$ in a domain $\\Omega$:\n$$\n\\beta C_m \\frac{\\partial V_m}{\\partial t} + \\beta\\,I_{\\text{ion}}(V_{m},\\mathbf{w}) - \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla V_{m}\\right) - \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}\\right) = I_{\\text{app}} \\quad (\\text{Eq. 1})\n$$\n$$\n\\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla V_{m}\\right) + \\nabla \\cdot \\!\\left((\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e}\\right) = 0 \\quad (\\text{Eq. 2})\n$$\nThe system is subject to homogeneous Neumann boundary conditions for the intracellular and extracellular potentials, derived from the physical assumption of an electrically insulating boundary: $\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i} \\nabla \\phi_{i} = 0$ and $\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{e} \\nabla \\phi_{e} = 0$, where $\\phi_i = V_m + \\phi_e$.\n\nWe seek approximate solutions $V_{m}^{h}(\\mathbf{x},t)$ and $\\phi_{e}^{h}(\\mathbf{x},t)$ in the finite-dimensional function space $V_h$. The Galerkin method is employed, where the PDEs are tested against arbitrary functions from the same space $V_h$. Let $v_h, w_h \\in V_h$ be arbitrary test functions.\n\nFirst, we derive the weak form of Eq. 1. We multiply by a test function $v_h \\in V_h$ and integrate over the domain $\\Omega$:\n$$\n\\int_{\\Omega} v_h (\\beta C_m \\frac{\\partial V_m}{\\partial t} + \\beta\\,I_{\\text{ion}}) \\,d\\mathbf{x} - \\int_{\\Omega} v_h \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla V_{m}\\right) \\,d\\mathbf{x} - \\int_{\\Omega} v_h \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}\\right) \\,d\\mathbf{x} = \\int_{\\Omega} v_h I_{\\text{app}} \\,d\\mathbf{x}\n$$\nWe apply integration by parts (Green's first identity) to the divergence terms: $\\int_{\\Omega} u \\nabla \\cdot \\mathbf{F} \\,d\\mathbf{x} = -\\int_{\\Omega} \\nabla u \\cdot \\mathbf{F} \\,d\\mathbf{x} + \\int_{\\partial\\Omega} u (\\mathbf{F} \\cdot \\mathbf{n}) \\,dS$.\nThe second and third terms on the left-hand side become:\n$$\n\\int_{\\Omega} \\nabla v_h \\cdot (\\boldsymbol{\\sigma}_{i}\\nabla V_{m}) \\,d\\mathbf{x} - \\int_{\\partial \\Omega} v_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla V_{m}) \\,dS + \\int_{\\Omega} \\nabla v_h \\cdot (\\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}) \\,d\\mathbf{x} - \\int_{\\partial \\Omega} v_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}) \\,dS\n$$\nCombining the boundary integrals yields $-\\int_{\\partial \\Omega} v_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla V_{m} + \\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}) \\,dS = -\\int_{\\partial \\Omega} v_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla(V_m+\\phi_e)) \\,dS = -\\int_{\\partial \\Omega} v_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla\\phi_i) \\,dS$. This term is zero due to the given boundary condition $\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i} \\nabla \\phi_{i} = 0$.\nThe weak form of Eq. 1 is thus:\n$$\n\\int_{\\Omega} v_h (\\beta C_{m} \\frac{\\partial V_m}{\\partial t} + \\beta\\,I_{\\text{ion}}) \\,d\\mathbf{x} + \\int_{\\Omega} \\nabla v_h \\cdot (\\boldsymbol{\\sigma}_{i}\\nabla V_{m}) \\,d\\mathbf{x} + \\int_{\\Omega} \\nabla v_h \\cdot (\\boldsymbol{\\sigma}_{i}\\nabla \\phi_{e}) \\,d\\mathbf{x} = \\int_{\\Omega} v_h I_{\\text{app}} \\,d\\mathbf{x}\n$$\n\nNext, we derive the weak form of Eq. 2. We multiply by a test function $w_h \\in V_h$ and integrate over $\\Omega$:\n$$\n\\int_{\\Omega} w_h \\nabla \\cdot \\!\\left(\\boldsymbol{\\sigma}_{i}\\nabla V_{m}\\right) d\\mathbf{x} + \\int_{\\Omega} w_h \\nabla \\cdot \\!\\left((\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e}\\right) d\\mathbf{x} = 0\n$$\nApplying integration by parts gives:\n$$\n-\\int_{\\Omega} \\nabla w_h \\cdot (\\boldsymbol{\\sigma}_{i}\\nabla V_{m}) \\,d\\mathbf{x} + \\int_{\\partial\\Omega} w_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla V_{m})\\,dS - \\int_{\\Omega} \\nabla w_h \\cdot ((\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e}) \\,d\\mathbf{x} + \\int_{\\partial\\Omega} w_h (\\mathbf{n} \\cdot (\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e})\\,dS = 0\n$$\nThe combined boundary integral is $\\int_{\\partial\\Omega} w_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla V_{m} + \\mathbf{n} \\cdot (\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e}) \\,dS = \\int_{\\partial\\Omega} w_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla (V_m+\\phi_e) + \\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{e}\\nabla \\phi_{e}) \\,dS = \\int_{\\partial\\Omega} w_h (\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla \\phi_i + \\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{e}\\nabla \\phi_e) \\,dS$. This vanishes due to the two boundary conditions $\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{i}\\nabla \\phi_{i} = 0$ and $\\mathbf{n} \\cdot \\boldsymbol{\\sigma}_{e}\\nabla \\phi_{e} = 0$.\nThe weak form of Eq. 2 (after multiplying by $-1$) is:\n$$\n\\int_{\\Omega} \\nabla w_h \\cdot (\\boldsymbol{\\sigma}_{i}\\nabla V_{m}) \\,d\\mathbf{x} + \\int_{\\Omega} \\nabla w_h \\cdot ((\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e})\\nabla \\phi_{e}) \\,d\\mathbf{x} = 0\n$$\n\nNow we introduce the finite element approximations $V_{m}^{h}(\\mathbf{x},t) = \\sum_{j=1}^{n} V_{j}(t)\\,N_{j}(\\mathbf{x})$ and $\\phi_{e}^{h}(\\mathbf{x},t) = \\sum_{j=1}^{n} \\Phi_{j}(t)\\,N_{j}(\\mathbf{x})$, where $\\{N_j\\}_{j=1}^n$ is the nodal basis of $V_h$. The test functions are chosen to be the basis functions themselves, $v_h = N_i$ and $w_h = N_i$ for each $i \\in \\{1,\\dots,n\\}$.\n\nFor the first equation, substituting the expansions gives:\n$$\n\\beta C_{m} \\int_{\\Omega} N_i \\sum_j \\frac{d V_j}{dt} N_j \\,d\\mathbf{x} + \\beta \\int_{\\Omega} N_i I_{\\text{ion}} \\,d\\mathbf{x} + \\int_{\\Omega} \\nabla N_i \\cdot \\boldsymbol{\\sigma}_{i} \\sum_j V_j \\nabla N_j \\,d\\mathbf{x} + \\int_{\\Omega} \\nabla N_i \\cdot \\boldsymbol{\\sigma}_{i} \\sum_j \\Phi_j \\nabla N_j \\,d\\mathbf{x} = \\int_{\\Omega} N_i I_{\\text{app}} \\,d\\mathbf{x}\n$$\nBy linearity of the integral, we exchange summation and integration and use the provided definitions:\n$$\n\\beta C_{m} \\sum_j M_{ij} \\frac{d V_j}{dt} + \\beta F_i(\\mathbf{V}) + \\sum_j (K_i)_{ij} V_j + \\sum_j (K_i)_{ij} \\Phi_j = P_i\n$$\nIn matrix-vector form, this is:\n$$\n\\beta C_m M \\frac{d\\mathbf{V}}{dt} + \\beta \\mathbf{F}(\\mathbf{V}) + K_i \\mathbf{V} + K_i \\boldsymbol{\\Phi} = \\mathbf{P}\n$$\n\nFor the second equation, substituting the expansions gives:\n$$\n\\int_{\\Omega} \\nabla N_i \\cdot \\boldsymbol{\\sigma}_{i} \\sum_j V_j \\nabla N_j \\,d\\mathbf{x} + \\int_{\\Omega} \\nabla N_i \\cdot (\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e}) \\sum_j \\Phi_j \\nabla N_j \\,d\\mathbf{x} = 0\n$$\n$$\n\\sum_j \\left(\\int_{\\Omega} \\nabla N_i \\cdot \\boldsymbol{\\sigma}_{i} \\nabla N_j \\,d\\mathbf{x}\\right) V_j + \\sum_j \\left(\\int_{\\Omega} \\nabla N_i \\cdot (\\boldsymbol{\\sigma}_{i}+\\boldsymbol{\\sigma}_{e}) \\nabla N_j \\,d\\mathbf{x}\\right) \\Phi_j = 0\n$$\nUsing the definitions for $K_i$ and $K_e$:\n$$\n\\sum_j (K_i)_{ij} V_j + \\sum_j ((K_i)_{ij} + (K_e)_{ij}) \\Phi_j = 0\n$$\nIn matrix-vector form, this is:\n$$\nK_i \\mathbf{V} + (K_i + K_e)\\boldsymbol{\\Phi} = \\mathbf{0}\n$$\n\nCombining the two matrix equations results in a system of differential-algebraic equations (DAEs). We can write this system in a compact block matrix form by defining the unknown vector as $\\begin{pmatrix} \\mathbf{V} \\\\ \\boldsymbol{\\Phi} \\end{pmatrix}$. The first equation involves the time derivative of $\\mathbf{V}$ but not $\\boldsymbol{\\Phi}$. The second equation is purely algebraic.\nThe resulting system is:\n$$\n\\begin{pmatrix} \\beta C_m M & 0 \\\\ 0 & 0 \\end{pmatrix} \\frac{d}{dt}\\begin{pmatrix} \\mathbf{V} \\\\ \\boldsymbol{\\Phi} \\end{pmatrix} + \\begin{pmatrix} K_i & K_i \\\\ K_i & K_i + K_e \\end{pmatrix} \\begin{pmatrix} \\mathbf{V} \\\\ \\boldsymbol{\\Phi} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{P} - \\beta \\mathbf{F}(\\mathbf{V}) \\\\ \\mathbf{0} \\end{pmatrix}\n$$\nThis is the required semi-discrete block matrix system representation of the bidomain equations.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\beta C_{m} M & 0 \\\\ 0 & 0 \\end{pmatrix} \\frac{d}{dt}\\begin{pmatrix} \\mathbf{V} \\\\ \\boldsymbol{\\Phi} \\end{pmatrix} + \\begin{pmatrix} K_{i} & K_{i} \\\\ K_{i} & K_{i} + K_{e} \\end{pmatrix} \\begin{pmatrix} \\mathbf{V} \\\\ \\boldsymbol{\\Phi} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{P} - \\beta \\mathbf{F}(\\mathbf{V}) \\\\ \\mathbf{0} \\end{pmatrix}\n}\n$$"
        }
    ]
}