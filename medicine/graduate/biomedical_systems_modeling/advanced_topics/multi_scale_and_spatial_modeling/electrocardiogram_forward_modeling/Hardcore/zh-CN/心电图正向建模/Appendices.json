{
    "hands_on_practices": [
        {
            "introduction": "本练习引入了强大的互易定理和导联场概念，为计算心电图导联电压提供了一种优雅的替代方法。互易定理允许我们通过考虑导联对心脏源的“灵敏度”（即导联场）来确定导联电压，而不是直接计算心脏源产生的电位。通过将此方法  应用于半空间导体中的偶极子源，您将获得使用格林函数的实践经验，并对导联位置如何决定记录到的心电图信号形成更深刻、更直观的理解。",
            "id": "3883395",
            "problem": "一个均匀、各向同性的躯干容积导体被建模为上半空间 $\\{(x,y,z) \\in \\mathbb{R}^{3} : z > 0\\}$，其电导率 $\\sigma$ 为常数。身体表面被建模为平面 $z=0$。考虑一个单极心电图 (ECG) 导联，其实现方式为：在一个以原点为中心、半径为 $a$ 的圆形电极片上均匀注入总电流 $I=1$ 安培，并通过一个半径在 $a$ 和 $R$ 之间的远端同心环带上均匀地引出返回电流，其中 $R \\to \\infty$。假设在圆形磁盘 $\\{x^{2}+y^{2} \\le a^{2}, z=0\\}$ 上的电流密度是均匀的，等于 $j_{0} = I/(\\pi a^{2})$，并且在 $R \\to \\infty$ 的极限情况下，平面的其余部分是绝缘的。\n\n在躯干内部，施加的心脏源被建模为一个点电流偶极子，其矩为 $\\mathbf{p} = p\\,\\hat{\\mathbf{z}}$（大小为 $p$，方向沿正 $z$ 轴），位于 $\\mathbf{x}_{0} = (0,0,d)$，其中 $d>0$。设 $u_{L}(\\mathbf{x})$ 为导联场电位，在 $z>0$ 内满足 $\\nabla \\cdot (\\sigma \\nabla u_{L}) = 0$，并在 $z=0$ 上满足 Neumann 边界条件 $-\\sigma \\,\\partial u_{L}/\\partial n = j_{n}$，其中 $j_{n}$ 是对应于所述电极配置的法向电流密度（在磁盘上为 $j_{n}=j_{0}$，在 $R \\to \\infty$ 的极限下在其他地方为零）。使用容积导体的互易定理和上半空间的适当格林函数，将由偶极子源测得的导联电压 $V$ 表示为由电极通量 $j_{n}$ 加权的格林函数的边界积分，并为此配置计算 $V$ 的闭式解。\n\n您的推导必须从无源区的控制场方程 $\\mathbf{J} = -\\sigma \\nabla u$ 和 $\\nabla \\cdot \\mathbf{J} = 0$ 开始，并使用连接导联电压与导联场的互易关系。您可以援引镜像法来构建半空间的 Neumann 格林函数。假设当 $R \\to \\infty$ 时，返回环带的贡献消失。\n\n请提供 $V$ 关于 $a$、$d$、$\\sigma$ 和 $p$ 的单一闭式解析表达式作为最终结果。以伏特为单位表示 $V$。不需要进行数值代入，也无需四舍五入。",
            "solution": "该问题要求解在一个均匀、各向同性的半空间导体中，由一个点电流偶极子源引起的、由单极心电图导联测得的电压 $V$。解将使用互易原理推导得出。\n\n心脏源是一个点电流偶极子，其矩为 $\\mathbf{p} = p\\,\\hat{\\mathbf{z}}$，位于导体中（占据 $z>0$ 区域）的 $\\mathbf{x}_{0} = (0,0,d)$ 处。这样一个源的施加电流密度为 $\\mathbf{J}_{i}(\\mathbf{x}) = \\mathbf{p}\\,\\delta(\\mathbf{x} - \\mathbf{x}_{0})$，其中 $\\delta(\\cdot)$ 是三维狄拉克 (Dirac) delta 函数。\n\n容积导体的互易定理将导联测得的电压 $V$ 与施加的电流源 $\\mathbf{J}_i$ 和导联场电位 $u_L$ 联系起来。导联场电位 $u_L$ 是指当导联电极被电流激励时，导体中会存在的电位。对于偶极子源，互易定理简化为：\n$$V = \\mathbf{p} \\cdot \\nabla u_{L}(\\mathbf{x}_{0})$$\n为了求得 $V$，我们必须首先确定导联场电位 $u_{L}(\\mathbf{x})$，然后计算其在源位置 $\\mathbf{x}_{0}$ 处的梯度。\n\n由于激励电流施加在边界上，导联场电位 $u_L$ 在无源导体区域内由拉普拉斯方程 (Laplace's equation) 控制：\n$$\\nabla^2 u_{L}(\\mathbf{x}) = 0 \\quad \\text{for } z > 0$$\n在表面 $z=0$ 上的边界条件由注入的电流密度 $j_n$ 给出。问题陈述为 $-\\sigma \\,\\partial u_{L}/\\partial n = j_{n}$。在边界 $z=0$ 处，从导体区域 $z>0$ 指出的外法线为 $\\hat{\\mathbf{n}} = -\\hat{\\mathbf{z}}$。因此，边界条件是：\n$$-\\sigma \\frac{\\partial u_{L}}{\\partial (-z)} = \\sigma \\frac{\\partial u_{L}}{\\partial z} = j_{n}(x,y)$$\n电流密度 $j_n$ 在一个半径为 $a$ 的圆形区域上是均匀的，在其他地方为零，因为返回电流在无穷远处。总注入电流为 $I=1$ 安培，所以电流密度为 $j_0 = I/(\\pi a^2) = 1/(\\pi a^2)$。\n$$j_{n}(x,y) = \\begin{cases} \\frac{1}{\\pi a^2}  \\text{if } x^2+y^2 \\le a^2 \\\\ 0  \\text{if } x^2+y^2 > a^2 \\end{cases}$$\n这个 Neumann 边界值问题的解可以用适当的格林函数来构建。在体积中一点 $\\mathbf{x}$ 处，由边界上 $\\mathbf{x}'$ 处的表面电流密度 $j_n(\\mathbf{x}')$ 产生的电位 $u_L(\\mathbf{x})$ 由下式给出：\n$$u_{L}(\\mathbf{x}) = \\int_{z'=0} \\frac{j_n(\\mathbf{x}')}{\\sigma} G_N(\\mathbf{x}, \\mathbf{x}') \\, dx' dy'$$\n其中 $G_N(\\mathbf{x}, \\mathbf{x}')$ 是半空间的 Neumann 格林函数，它在 $z>0$ 中满足 $\\nabla^2 G_N = -\\delta(\\mathbf{x}-\\mathbf{x}')$ 并在 $z'=0$ 上满足 $\\partial G_N / \\partial z' = 0$。对于位于 $\\mathbf{x}'=(x',y',z')$ 的源，使用镜像法，我们在 $\\mathbf{x}'_{image}=(x',y',-z')$ 处放置一个同号的镜像源。当源点 $\\mathbf{x}'$ 位于边界上（$z'=0$）时，源和镜像重合，得到：\n$$G_N(\\mathbf{x}, (x',y',0)) = 2 \\times G_{\\text{free-space}} = 2 \\times \\frac{1}{4\\pi |\\mathbf{x} - \\mathbf{x}'|} = \\frac{1}{2\\pi \\sqrt{(x-x')^2 + (y-y')^2 + z^2}}$$\n将此式和 $j_n$ 代入 $u_L$ 的积分中：\n$$u_{L}(\\mathbf{x}) = \\int_{x'^2+y'^2 \\le a^2} \\frac{1/(\\pi a^2)}{\\sigma} \\frac{1}{2\\pi \\sqrt{(x-x')^2 + (y-y')^2 + z^2}} \\, dx' dy'$$\n$$u_{L}(\\mathbf{x}) = \\frac{1}{2\\pi^2 a^2 \\sigma} \\int_{x'^2+y'^2 \\le a^2} \\frac{dx' dy'}{\\sqrt{(x-x')^2 + (y-y')^2 + z^2}}$$\n接下来，我们计算梯度 $\\nabla u_L(\\mathbf{x})$ 并在 $\\mathbf{x}_0 = (0,0,d)$ 处求值。我们可以在积分号下进行微分：\n$$\\nabla u_{L}(\\mathbf{x}) = -\\frac{1}{2\\pi^2 a^2 \\sigma} \\int_{x'^2+y'^2 \\le a^2} \\frac{(x-x', y-y', z)}{\\left( (x-x')^2 + (y-y')^2 + z^2 \\right)^{3/2}} \\, dx' dy'$$\n在 $\\mathbf{x}_0 = (0,0,d)$ 处求值：\n$$\\nabla u_{L}(\\mathbf{x}_0) = -\\frac{1}{2\\pi^2 a^2 \\sigma} \\int_{x'^2+y'^2 \\le a^2} \\frac{(-x', -y', d)}{\\left( x'^2 + y'^2 + d^2 \\right)^{3/2}} \\, dx' dy'$$\n由于积分域的圆对称性，其 $x$ 和 $y$ 分量的积分（被积函数分别是关于 $x'$ 和 $y'$ 的奇函数）为零。唯一非零的分量是沿 $z$ 轴的：\n$$\\frac{\\partial u_{L}}{\\partial z}\\bigg|_{\\mathbf{x}_0} = -\\frac{1}{2\\pi^2 a^2 \\sigma} \\int_{x'^2+y'^2 \\le a^2} \\frac{d}{\\left( x'^2 + y'^2 + d^2 \\right)^{3/2}} \\, dx' dy'$$\n为了计算这个积分，我们对积分变量切换到极坐标：$x' = r' \\cos\\theta'$, $y' = r' \\sin\\theta'$, $dx' dy' = r' dr' d\\theta'$。\n$$\\frac{\\partial u_{L}}{\\partial z}\\bigg|_{\\mathbf{x}_0} = -\\frac{d}{2\\pi^2 a^2 \\sigma} \\int_0^{2\\pi} \\int_0^a \\frac{r' dr' d\\theta'}{(r'^2 + d^2)^{3/2}}$$\n对 $\\theta'$ 的积分得到 $2\\pi$：\n$$\\frac{\\partial u_{L}}{\\partial z}\\bigg|_{\\mathbf{x}_0} = -\\frac{2\\pi d}{2\\pi^2 a^2 \\sigma} \\int_0^a \\frac{r'}{(r'^2 + d^2)^{3/2}} dr' = -\\frac{d}{\\pi a^2 \\sigma} \\int_0^a \\frac{r'}{(r'^2 + d^2)^{3/2}} dr'$$\n剩下的积分可以通过换元法 $u = r'^2+d^2$，$du = 2r' dr'$ 求解：\n$$\\int_0^a \\frac{r' dr'}{(r'^2+d^2)^{3/2}} = \\frac{1}{2} \\int_{d^2}^{a^2+d^2} u^{-3/2} du = \\frac{1}{2} \\left[ -2u^{-1/2} \\right]_{d^2}^{a^2+d^2} = \\left[ -\\frac{1}{\\sqrt{u}} \\right]_{d^2}^{a^2+d^2} = -\\frac{1}{\\sqrt{a^2+d^2}} + \\frac{1}{\\sqrt{d^2}} = \\frac{1}{d} - \\frac{1}{\\sqrt{a^2+d^2}}$$\n将此结果代回，得到梯度分量：\n$$\\frac{\\partial u_{L}}{\\partial z}\\bigg|_{\\mathbf{x}_0} = -\\frac{d}{\\pi a^2 \\sigma} \\left( \\frac{1}{d} - \\frac{1}{\\sqrt{a^2+d^2}} \\right) = -\\frac{1}{\\pi a^2 \\sigma} \\left( 1 - \\frac{d}{\\sqrt{a^2+d^2}} \\right)$$\n因此，在偶极子位置的梯度向量是 $\\nabla u_{L}(\\mathbf{x}_0) = \\left(0, 0, -\\frac{1}{\\pi a^2 \\sigma} \\left( 1 - \\frac{d}{\\sqrt{a^2+d^2}} \\right) \\right)$。\n\n最后，我们使用互易关系求得测量的电压 $V$：\n$$V = \\mathbf{p} \\cdot \\nabla u_{L}(\\mathbf{x}_{0}) = (0,0,p) \\cdot \\left(0, 0, -\\frac{1}{\\pi a^2 \\sigma} \\left( 1 - \\frac{d}{\\sqrt{a^2+d^2}} \\right) \\right)$$\n$$V = -\\frac{p}{\\pi a^2 \\sigma} \\left( 1 - \\frac{d}{\\sqrt{a^2+d^2}} \\right) = \\frac{p}{\\pi a^2 \\sigma} \\left( \\frac{d}{\\sqrt{a^2+d^2}} - 1 \\right)$$\n这是测量导联电压的闭式表达式。",
            "answer": "$$\n\\boxed{\n\\frac{p}{\\pi a^2 \\sigma} \\left( \\frac{d}{\\sqrt{a^2 + d^2}} - 1 \\right)\n}\n$$"
        },
        {
            "introduction": "最后的这项实践练习旨在弥合理想化理论模型与心电图测量的实际情况之间的差距。我们将研究躯干表面的数学边界条件选择——比较一个完全绝缘的躯干（诺伊曼条件）与一个包含有限电极接触阻抗的更真实模型（罗宾条件）——如何影响最终的心电图导联振幅。这个问题  将解析推导与计算实现相结合，让您对体表-电极界面的建模假设如何影响仿真准确性有一个定量的认识。",
            "id": "3883450",
            "problem": "您的任务是推导并实现一个心电图（ECG）正向模型，以定量比较在均匀球形躯干上使用 Neumann 与 Robin 边界条件计算出的表面导联振幅。模型假设如下。躯干由一个半径为 $R$、电导率为 $\\sigma$ 的均匀球体表示，其中心包含一个大小为 $p$、沿 $z$ 轴方向的电流偶极子。在准静态传导极限下，电势 $\\phi(\\mathbf{r})$ 服从以下椭圆偏微分方程\n$$\n\\nabla \\cdot \\left(\\sigma \\nabla \\phi(\\mathbf{r})\\right) = - \\nabla \\cdot \\mathbf{J}_s(\\mathbf{r}),\n$$\n其中源电流密度是一个点偶极子，由下式给出\n$$\n\\mathbf{J}_s(\\mathbf{r}) = \\mathbf{p} \\,\\delta(\\mathbf{r}),\n\\quad\n\\mathbf{p} = p\\,\\hat{\\mathbf{z}}.\n$$\n必须考虑球形表面 $r=R$ 处的两种边界模型：\n1. Neumann（绝缘外部介质）：\n$$\n\\sigma \\,\\frac{\\partial \\phi}{\\partial n}\\bigg|_{r=R} = 0.\n$$\n2. Robin（通过有限接触阻抗与远处参考点形成均匀分流）：\n$$\n\\sigma \\,\\frac{\\partial \\phi}{\\partial n}\\bigg|_{r=R} + \\kappa\\,\\phi(R,\\theta) = 0,\n\\quad\n\\kappa = \\frac{1}{Z_c\\,4\\pi R^2}.\n$$\nRobin 系数 $\\kappa$ 代表一个空间均匀的表面导纳密度，其值等于总分流导纳 $1/Z_c$ 分布在球形面积 $4\\pi R^2$ 上，因此 $\\kappa$ 的单位是 $\\text{S}/\\text{m}^2$，并使得 $\\sigma \\,\\partial \\phi/\\partial n + \\kappa\\,\\phi$ 的单位为 $\\text{A}/\\text{m}^2$。这个理想化的边界捕捉了有限接触阻抗的影响，而无需指定电极片。角度是相对于偶极子轴测量的。\n\n仅使用电准静态学和球谐函数中的第一性原理和经过充分检验的事实，为中心偶极子推导两种边界模型下的表面电势 $\\phi(R,\\theta)$，然后推导导联振幅，其定义为两个位于极角 $\\theta_1$ 和 $\\theta_2$ 的表面点之间的电压差：\n$$\n\\Delta V = \\phi(R,\\theta_1) - \\phi(R,\\theta_2).\n$$\n以伏特（$\\text{V}$）表示导联振幅。然后计算 Robin 和 Neumann 导联振幅之间的百分比差异\n$$\n\\delta = \\frac{\\Delta V_{\\text{Robin}} - \\Delta V_{\\text{Neumann}}}{\\Delta V_{\\text{Neumann}}},\n$$\n并以小数形式报告 $\\delta$（例如，$0.123$ 表示 $12.3\\%$），不带百分号。\n\n您的程序必须使用 $Z_c = 1\\,\\text{k}\\Omega$ 并实现您推导的公式，为以下测试套件计算 $\\delta$。角度单位为弧度，半径单位为米，电导率单位为 S/m，偶极矩单位为 A·m：\n\n- 测试用例 1：$R = 0.15\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$， $p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0$，$\\theta_2 = \\pi$。\n- 测试用例 2：$R = 0.15\\,\\text{m}$，$\\sigma = 0.05\\,\\text{S}/\\text{m}$， $p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = \\pi/3$，$\\theta_2 = 2\\pi/3$。\n- 测试用例 3：$R = 0.10\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$， $p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = \\pi/4$，$\\theta_2 = 3\\pi/4$。\n- 测试用例 4：$R = 0.15\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$， $p = 1.0\\times 10^{-6}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0.49\\pi$，$\\theta_2 = 0.51\\pi$。\n- 测试用例 5：$R = 0.20\\,\\text{m}$，$\\sigma = 0.25\\,\\text{S}/\\text{m}$， $p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0$，$\\theta_2 = \\pi$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，$[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$）。每个 $\\delta_i$ 必须打印为四舍五入到六位小数的浮点数。",
            "solution": "在电导率为 $\\sigma$ 的均匀介质中，电势 $\\phi$ 的控制方程是：\n$$\n\\nabla \\cdot (\\sigma \\nabla \\phi) = -\\nabla \\cdot \\mathbf{J}_s\n$$\n由于 $\\sigma$ 是一个常数标量，这简化为泊松方程：\n$$\n\\sigma \\nabla^2 \\phi = -\\nabla \\cdot \\mathbf{J}_s\n$$\n源项是位于原点的电流偶极子，$\\mathbf{J}_s(\\mathbf{r}) = \\mathbf{p} \\delta(\\mathbf{r})$。其散度为 $\\nabla \\cdot \\mathbf{J}_s = \\mathbf{p} \\cdot \\nabla\\delta(\\mathbf{r})$。方程变为：\n$$\n\\nabla^2 \\phi = -\\frac{1}{\\sigma} \\mathbf{p} \\cdot \\nabla\\delta(\\mathbf{r})\n$$\n在无限均匀介质中，位于原点的电流偶极子 $\\mathbf{p}$ 的电势是该方程的特解：\n$$\n\\phi_{\\text{source}}(r, \\theta) = \\frac{\\mathbf{p} \\cdot \\mathbf{r}}{4\\pi\\sigma r^3} = \\frac{p r \\cos\\theta}{4\\pi\\sigma r^3} = \\frac{p \\cos\\theta}{4\\pi\\sigma r^2}\n$$\n在球坐标系中，当 $\\mathbf{p}$ 沿 $z$ 轴时，此解仅依赖于 $r$ 和极角 $\\theta$。球体内部的总电势是此源电势与一个在原点处正则的拉普拉斯方程（$\\nabla^2\\phi=0$）解的和。这个反作用电势解释了边界效应。\n\n由于问题的方位对称性以及源对 $\\cos\\theta$ 的依赖性（其对应于勒让德多项式 $P_1(\\cos\\theta)$），球体内部的通解可以写成：\n$$\n\\phi(r, \\theta) = \\left( \\frac{p}{4\\pi\\sigma} r^{-2} + A r \\right) P_1(\\cos\\theta) = \\left( \\frac{p}{4\\pi\\sigma r^2} + A r \\right) \\cos\\theta\n$$\n这里，$A$ 是一个待定系数，由边界条件确定。一个相加常数项（$l=0$）也是可能的，但在 Robin 情况下它会消失，并且对于 Neumann 情况下计算的电势差无关紧要，所以我们可以省略它。\n\n径向导数为：\n$$\n\\frac{\\partial \\phi}{\\partial r} = \\left( -2 \\frac{p}{4\\pi\\sigma r^3} + A \\right) \\cos\\theta\n$$\n我们在表面 $r=R$ 处应用边界条件。向外的法向导数是 $\\frac{\\partial}{\\partial n} = \\frac{\\partial}{\\partial r}$。\n\n**1. Neumann 边界条件**\n条件是 $\\sigma \\frac{\\partial \\phi}{\\partial r}\\big|_{r=R} = 0$。\n$$\n\\sigma \\left( -2 \\frac{p}{4\\pi\\sigma R^3} + A_N \\right) \\cos\\theta = 0\n$$\n为了让此式对所有 $\\theta$ 成立，括号内的项必须为零。\n$$\nA_N = \\frac{2p}{4\\pi\\sigma R^3}\n$$\n将 $A_N$ 代入 $\\phi(r,\\theta)$ 的表达式并在 $r=R$ 处求值：\n$$\n\\phi_N(R, \\theta) = \\left( \\frac{p}{4\\pi\\sigma R^2} + \\frac{2p}{4\\pi\\sigma R^3} R \\right) \\cos\\theta = \\frac{3p}{4\\pi\\sigma R^2} \\cos\\theta\n$$\n\n**2. Robin 边界条件**\n条件是 $\\sigma \\frac{\\partial \\phi}{\\partial r}\\big|_{r=R} + \\kappa \\phi(R, \\theta) = 0$。\n$$\n\\sigma \\left( -2 \\frac{p}{4\\pi\\sigma R^3} + A_R \\right) \\cos\\theta + \\kappa \\left( \\frac{p}{4\\pi\\sigma R^2} + A_R R \\right) \\cos\\theta = 0\n$$\n同样，$\\cos\\theta$ 的系数必须为零。\n$$\n\\sigma \\left( -2 \\frac{p}{4\\pi\\sigma R^3} + A_R \\right) + \\kappa \\left( \\frac{p}{4\\pi\\sigma R^2} + A_R R \\right) = 0\n$$\n$$\n-\\frac{2p}{4\\pi R^3} + \\sigma A_R + \\frac{\\kappa p}{4\\pi\\sigma R^2} + \\kappa A_R R = 0\n$$\n求解 $A_R$：\n$$\nA_R (\\sigma + \\kappa R) = \\frac{2p}{4\\pi R^3} - \\frac{\\kappa p}{4\\pi\\sigma R^2} = \\frac{p}{4\\pi\\sigma R^3} (2\\sigma - \\kappa R)\n$$\n$$\nA_R = \\frac{p}{4\\pi\\sigma R^3} \\frac{2\\sigma - \\kappa R}{\\sigma + \\kappa R}\n$$\n将 $A_R$ 代入 $r=R$ 处的电势：\n$$\n\\phi_R(R, \\theta) = \\left( \\frac{p}{4\\pi\\sigma R^2} + A_R R \\right) \\cos\\theta = \\frac{p}{4\\pi\\sigma R^2} \\left( 1 + \\frac{2\\sigma - \\kappa R}{\\sigma + \\kappa R} \\right) \\cos\\theta\n$$\n简化括号内的项：\n$$\n1 + \\frac{2\\sigma - \\kappa R}{\\sigma + \\kappa R} = \\frac{\\sigma + \\kappa R + 2\\sigma - \\kappa R}{\\sigma + \\kappa R} = \\frac{3\\sigma}{\\sigma + \\kappa R}\n$$\n所以，Robin 情况下的表面电势为：\n$$\n\\phi_R(R, \\theta) = \\frac{p}{4\\pi\\sigma R^2} \\frac{3\\sigma}{\\sigma + \\kappa R} \\cos\\theta = \\frac{3p}{4\\pi R^2 (\\sigma + \\kappa R)} \\cos\\theta\n$$\n\n**3. 导联振幅和相对差异**\nNeumann 情况下的导联振幅是：\n$$\n\\Delta V_N = \\phi_N(R, \\theta_1) - \\phi_N(R, \\theta_2) = \\frac{3p}{4\\pi\\sigma R^2} (\\cos\\theta_1 - \\cos\\theta_2)\n$$\nRobin 情况下的导联振幅是：\n$$\n\\Delta V_R = \\phi_R(R, \\theta_1) - \\phi_R(R, \\theta_2) = \\frac{3p}{4\\pi R^2 (\\sigma + \\kappa R)} (\\cos\\theta_1 - \\cos\\theta_2)\n$$\n相对差异 $\\delta$ 定义为：\n$$\n\\delta = \\frac{\\Delta V_R - \\Delta V_N}{\\Delta V_N} = \\frac{\\Delta V_R}{\\Delta V_N} - 1\n$$\n取比值：\n$$\n\\frac{\\Delta V_R}{\\Delta V_N} = \\frac{\\frac{3p}{4\\pi R^2 (\\sigma + \\kappa R)} (\\cos\\theta_1 - \\cos\\theta_2)}{\\frac{3p}{4\\pi\\sigma R^2} (\\cos\\theta_1 - \\cos\\theta_2)} = \\frac{\\sigma}{\\sigma + \\kappa R}\n$$\n这个优雅的简化表明，该比值与偶极矩 $p$ 和电极位置 $\\theta_1, \\theta_2$ 无关（只要 $\\cos\\theta_1 \\neq \\cos\\theta_2$）。\n现在，我们求 $\\delta$：\n$$\n\\delta = \\frac{\\sigma}{\\sigma + \\kappa R} - 1 = \\frac{\\sigma - (\\sigma + \\kappa R)}{\\sigma + \\kappa R} = \\frac{-\\kappa R}{\\sigma + \\kappa R}\n$$\n最后，我们代入 $\\kappa = \\frac{1}{Z_c 4\\pi R^2}$ 的定义：\n$$\n\\delta = \\frac{-\\left(\\frac{1}{Z_c 4\\pi R^2}\\right) R}{\\sigma + \\left(\\frac{1}{Z_c 4\\pi R^2}\\right) R} = \\frac{-\\frac{1}{4\\pi Z_c R}}{\\sigma + \\frac{1}{4\\pi Z_c R}}\n$$\n为了进一步简化，我们将分子和分母乘以 $4\\pi Z_c R$：\n$$\n\\delta = \\frac{-1}{4\\pi \\sigma Z_c R + 1}\n$$\n这是需要实现的最终公式。参数 $p$、$\\theta_1$ 和 $\\theta_2$ 对于计算 $\\delta$ 来说是无关的，尽管它们是定义导联电压本身所必需的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an ECG forward model to compare surface lead amplitudes\n    computed with Neumann versus Robin boundary conditions for a homogeneous\n    spherical torso. The relative difference is calculated for a suite of test cases.\n    \"\"\"\n    \n    # The relative difference, delta, is given by the derived formula:\n    # delta = -1 / (4 * pi * sigma * Z_c * R + 1)\n    # where all parameters are in SI units.\n    \n    # Constant parameter from the problem statement\n    Z_c = 1000.0  # Contact impedance in Ohms (1 kOhm)\n\n    # Test cases from the problem statement.\n    # Each tuple contains: (R in m, sigma in S/m)\n    # The other parameters (p, theta1, theta2) are not needed for calculating delta.\n    test_cases = [\n        (0.15, 0.20),  # Test case 1\n        (0.15, 0.05),  # Test case 2\n        (0.10, 0.20),  # Test case 3\n        (0.15, 0.20),  # Test case 4\n        (0.20, 0.25),  # Test case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        R, sigma = case\n        \n        # Calculate the denominator of the derived formula for delta.\n        # The term 4*pi*sigma*Z_c*R is dimensionless.\n        denominator = 4 * np.pi * sigma * Z_c * R + 1\n        \n        # Calculate delta\n        delta = -1.0 / denominator\n        \n        # Round the result to six decimal places as required.\n        results.append(round(delta, 6))\n\n    # Format the final output as a comma-separated list in square brackets.\n    # The map(str, ...) ensures each number is converted to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver function.\nsolve()\n```"
        }
    ]
}