{
    "hands_on_practices": [
        {
            "introduction": "这个实践将作为我们理解的基础，它引入了均匀球体这一最简洁且重要的躯干模型。我们将重点探讨边界条件——即躯干如何与其外部环境相互作用——这一基本建模决策的重要性。通过该练习 ，您将定量比较经典的绝缘（Neumann）边界与更符合实际的阻抗（Robin）边界，从而揭示这一选择如何影响预测的心电信号。",
            "id": "3883450",
            "problem": "您的任务是推导并实现一个心电图 (ECG) 正向模型，以定量比较在均匀球形躯干上使用诺伊曼 (Neumann) 与罗宾 (Robin) 边界条件计算出的表面导联振幅。模型假设如下。躯干由一个半径为 $R$、电导率为 $\\sigma$ 的均匀球体表示，其中心包含一个大小为 $p$ 的电流偶极子，并沿 $z$ 轴方向。在准静态传导极限下，电势 $\\phi(\\mathbf{r})$ 服从以下椭圆偏微分方程\n$$\n\\nabla \\cdot \\left(\\sigma \\nabla \\phi(\\mathbf{r})\\right) = - \\nabla \\cdot \\mathbf{J}_s(\\mathbf{r}),\n$$\n其中源电流密度是一个点偶极子，由下式给出\n$$\n\\mathbf{J}_s(\\mathbf{r}) = \\mathbf{p} \\,\\delta(\\mathbf{r}),\n\\quad\n\\mathbf{p} = p\\,\\hat{\\mathbf{z}}.\n$$\n必须考虑在球形表面 $r=R$ 处的两种边界模型：\n1. 诺伊曼 (Neumann)（绝缘外部介质）：\n$$\n\\sigma \\,\\frac{\\partial \\phi}{\\partial n}\\bigg|_{r=R} = 0.\n$$\n2. 罗宾 (Robin)（通过有限接触阻抗与远处参考点均匀分流）：\n$$\n\\sigma \\,\\frac{\\partial \\phi}{\\partial n}\\bigg|_{r=R} + \\kappa\\,\\phi(R,\\theta) = 0,\n\\quad\n\\kappa = \\frac{1}{Z_c\\,4\\pi R^2}.\n$$\n罗宾系数 $\\kappa$ 代表一个空间上均匀的表面导纳密度，等于分布在球形面积 $4\\pi R^2$ 上的总分流导纳 $1/Z_c$，因此 $\\kappa$ 的单位是 $\\text{S}/\\text{m}^2$，并使得 $\\sigma \\,\\frac{\\partial \\phi}{\\partial n} + \\kappa\\,\\phi$ 的单位为 $\\text{A}/\\text{m}^2$。这种理想化的边界捕捉了有限接触阻抗的影响，而无需规定电极片的位置。角度是相对于偶极子轴测量的。\n\n仅使用第一性原理以及电准静态学和球谐函数中经过充分检验的事实，推导中心偶极子在两种边界模型下的表面电势 $\\phi(R,\\theta)$，然后推导导联振幅，其定义为两个位于极角 $\\theta_1$ 和 $\\theta_2$ 的表面点之间的电压差：\n$$\n\\Delta V = \\phi(R,\\theta_1) - \\phi(R,\\theta_2).\n$$\n将导联振幅以伏特 ($\\text{V}$) 表示。然后计算罗宾和诺伊曼导联振幅之间的百分比差异为\n$$\n\\delta = \\frac{\\Delta V_{\\text{Robin}} - \\Delta V_{\\text{Neumann}}}{\\Delta V_{\\text{Neumann}}},\n$$\n并将 $\\delta$ 以小数形式报告（例如，$0.123$ 表示 $12.3\\%$），不带百分号。\n\n您的程序必须使用 $Z_c = 1\\,\\text{k}\\Omega$ 并实现您推导的公式，为以下测试套件计算 $\\delta$。角度单位为弧度 ($\\text{radians}$)，半径单位为米 ($\\text{m}$)，电导率单位为西门子/米 ($\\text{S}/\\text{m}$)，偶极矩单位为安培·米 ($\\text{A}\\cdot\\text{m}$)：\n\n- 测试用例 1：$R = 0.15\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0$，$\\theta_2 = \\pi$。\n- 测试用例 2：$R = 0.15\\,\\text{m}$，$\\sigma = 0.05\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = \\pi/3$，$\\theta_2 = 2\\pi/3$。\n- 测试用例 3：$R = 0.10\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = \\pi/4$，$\\theta_2 = 3\\pi/4$。\n- 测试用例 4：$R = 0.15\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-6}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0.49\\pi$，$\\theta_2 = 0.51\\pi$。\n- 测试用例 5：$R = 0.20\\,\\text{m}$，$\\sigma = 0.25\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0$，$\\theta_2 = \\pi$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$）。每个 $\\delta_i$ 必须打印为四舍五入到六位小数的浮点数。",
            "solution": "用户要求推导并实现一个 ECG 正向模型，以比较诺伊曼和罗宾边界条件下的导联振幅。\n\n### **问题陈述验证**\n\n首先，我将验证问题陈述。\n\n**第 1 步：提取已知条件**\n- **控制方程：** 在电导率为 $\\sigma$ 的均匀球形躯干内，电势 $\\phi(\\mathbf{r})$ 由 $\\nabla \\cdot \\left(\\sigma \\nabla \\phi(\\mathbf{r})\\right) = - \\nabla \\cdot \\mathbf{J}_s(\\mathbf{r})$ 控制。\n- **源项：** 源电流密度是位于原点的点偶极子，$\\mathbf{J}_s(\\mathbf{r}) = \\mathbf{p} \\,\\delta(\\mathbf{r})$，其中偶极矩为 $\\mathbf{p} = p\\,\\hat{\\mathbf{z}}$。\n- **域：** 半径为 $R$ 的均匀球体。\n- **边界条件 1 (Neumann)：** 在 $r=R$ 处，$\\sigma \\,\\frac{\\partial \\phi}{\\partial n}\\bigg|_{r=R} = 0$。\n- **边界条件 2 (Robin)：** 在 $r=R$ 处，$\\sigma \\,\\frac{\\partial \\phi}{\\partial n}\\bigg|_{r=R} + \\kappa\\,\\phi(R,\\theta) = 0$。\n- **罗宾系数：** $\\kappa = \\frac{1}{Z_c\\,4\\pi R^2}$。\n- **导联振幅：** $\\Delta V = \\phi(R,\\theta_1) - \\phi(R,\\theta_2)$。\n- **相对差异：** $\\delta = \\frac{\\Delta V_{\\text{Robin}} - \\Delta V_{\\text{Neumann}}}{\\Delta V_{\\text{Neumann}}}$。\n- **测试用例的常数和参数：**\n  - $Z_c = 1\\,\\text{k}\\Omega = 1000\\,\\Omega$。\n  - 测试用例 1：$R = 0.15\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0$，$\\theta_2 = \\pi$。\n  - 测试用例 2：$R = 0.15\\,\\text{m}$，$\\sigma = 0.05\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = \\pi/3$，$\\theta_2 = 2\\pi/3$。\n  - 测试用例 3：$R = 0.10\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = \\pi/4$，$\\theta_2 = 3\\pi/4$。\n  - 测试用例 4：$R = 0.15\\,\\text{m}$，$\\sigma = 0.20\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-6}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0.49\\pi$，$\\theta_2 = 0.51\\pi$。\n  - 测试用例 5：$R = 0.20\\,\\text{m}$，$\\sigma = 0.25\\,\\text{S}/\\text{m}$，$p = 1.0\\times 10^{-5}\\,\\text{A}\\cdot\\text{m}$，$\\theta_1 = 0$，$\\theta_2 = \\pi$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于麦克斯韦方程组的准静态近似，特别是静电学的泊松方程，这是处理像 ECG 这样的低频生物电现象的标准方法。电流偶极子是心脏的标准（尽管简化了）源模型。诺伊曼（孤立躯干）和罗宾（分流躯干）边界条件在物理上都有意义，在数学上也是标准的。该问题在科学上是合理的。\n- **适定性：** 该问题描述了一个在有界域上的线性椭圆偏微分方程（泊松方程），具有明确的源项和边界条件（诺伊曼和罗宾）。这类问题通常是适定的，在相差一个加性常数的情况下会产生唯一解。由于关注的量是电势差，这个常数会抵消掉，从而确保一个唯一且有意义的解。\n- **客观性：** 问题以精确、客观和数学化的语言陈述。\n- **完整性和一致性：** 提供了所有必需的参数和定义。没有矛盾之处。单位是一致的。\n- **真实性：** 对于简化模型而言，躯干半径、电导率和偶极矩的数值在公认的生理范围内。接触阻抗 $Z_c$ 也是一个实际的值。\n- **其他缺陷：** 问题并非微不足道、不适定或隐喻性的。它要求基于基本原理进行特定的推导和计算。\n\n**第 3 步：结论与行动**\n问题是有效的。我将继续进行推导和求解。\n\n### **表面电势和相对差异的推导**\n\n在电导率为 $\\sigma$ 的均匀介质中，电势 $\\phi$ 的控制方程为：\n$$\n\\nabla \\cdot (\\sigma \\nabla \\phi) = -\\nabla \\cdot \\mathbf{J}_s\n$$\n由于 $\\sigma$ 是一个常数标量，这可以简化为泊松方程：\n$$\n\\sigma \\nabla^2 \\phi = -\\nabla \\cdot \\mathbf{J}_s\n$$\n源项是位于原点的电流偶极子，$\\mathbf{J}_s(\\mathbf{r}) = \\mathbf{p} \\delta(\\mathbf{r})$。其散度为 $\\nabla \\cdot \\mathbf{J}_s = \\mathbf{p} \\cdot \\nabla\\delta(\\mathbf{r})$。方程变为：\n$$\n\\nabla^2 \\phi = -\\frac{1}{\\sigma} \\mathbf{p} \\cdot \\nabla\\delta(\\mathbf{r})\n$$\n在无限均匀介质中，位于原点的电流偶极子 $\\mathbf{p}$ 的电势是此方程的特解：\n$$\n\\phi_{\\text{source}}(r, \\theta) = \\frac{\\mathbf{p} \\cdot \\mathbf{r}}{4\\pi\\sigma r^3} = \\frac{p r \\cos\\theta}{4\\pi\\sigma r^3} = \\frac{p \\cos\\theta}{4\\pi\\sigma r^2}\n$$\n在球坐标系中，当 $\\mathbf{p}$ 沿着 $z$ 轴时，这仅取决于 $r$ 和极角 $\\theta$。球体内部的总电势是该源电势与在原点处正则的拉普拉斯方程（$\\nabla^2\\phi=0$）解的和。这个反应电势解释了边界效应。\n\n由于问题的方位对称性以及源的 $\\cos\\theta$ 依赖性（对应于勒让德多项式 $P_1(\\cos\\theta)$），球体内部的通解可以写为：\n$$\n\\phi(r, \\theta) = \\left( \\frac{p}{4\\pi\\sigma} r^{-2} + A r \\right) P_1(\\cos\\theta) = \\left( \\frac{p}{4\\pi\\sigma r^2} + A r \\right) \\cos\\theta\n$$\n这里，$A$ 是一个待定系数，由边界条件确定。一个附加的常数项（$l=0$）也是可能的，但它在罗宾情况下为零，并且与诺伊曼情况下计算的电势差无关，因此我们可以忽略它。\n\n径向导数为：\n$$\n\\frac{\\partial \\phi}{\\partial r} = \\left( -2 \\frac{p}{4\\pi\\sigma r^3} + A \\right) \\cos\\theta\n$$\n我们在表面 $r=R$ 处应用边界条件。向外的法向导数为 $\\frac{\\partial}{\\partial n} = \\frac{\\partial}{\\partial r}$。\n\n**1. 诺伊曼边界条件**\n条件是 $\\sigma \\frac{\\partial \\phi}{\\partial r}\\big|_{r=R} = 0$。\n$$\n\\sigma \\left( -2 \\frac{p}{4\\pi\\sigma R^3} + A_N \\right) \\cos\\theta = 0\n$$\n为使此式对所有 $\\theta$ 成立，括号中的项必须为零。\n$$\nA_N = \\frac{2p}{4\\pi\\sigma R^3}\n$$\n将 $A_N$ 代入 $\\phi(r,\\theta)$ 的表达式并在 $r=R$ 处求值：\n$$\n\\phi_N(R, \\theta) = \\left( \\frac{p}{4\\pi\\sigma R^2} + \\frac{2p}{4\\pi\\sigma R^3} R \\right) \\cos\\theta = \\frac{3p}{4\\pi\\sigma R^2} \\cos\\theta\n$$\n\n**2. 罗宾边界条件**\n条件是 $\\sigma \\frac{\\partial \\phi}{\\partial r}\\big|_{r=R} + \\kappa \\phi(R, \\theta) = 0$。\n$$\n\\sigma \\left( -2 \\frac{p}{4\\pi\\sigma R^3} + A_R \\right) \\cos\\theta + \\kappa \\left( \\frac{p}{4\\pi\\sigma R^2} + A_R R \\right) \\cos\\theta = 0\n$$\n同样，$\\cos\\theta$ 的系数必须为零。\n$$\n\\sigma \\left( -2 \\frac{p}{4\\pi\\sigma R^3} + A_R \\right) + \\kappa \\left( \\frac{p}{4\\pi\\sigma R^2} + A_R R \\right) = 0\n$$\n$$\n-\\frac{2p}{4\\pi R^3} + \\sigma A_R + \\frac{\\kappa p}{4\\pi\\sigma R^2} + \\kappa A_R R = 0\n$$\n求解 $A_R$：\n$$\nA_R (\\sigma + \\kappa R) = \\frac{2p}{4\\pi R^3} - \\frac{\\kappa p}{4\\pi\\sigma R^2} = \\frac{p}{4\\pi\\sigma R^3} (2\\sigma - \\kappa R)\n$$\n$$\nA_R = \\frac{p}{4\\pi\\sigma R^3} \\frac{2\\sigma - \\kappa R}{\\sigma + \\kappa R}\n$$\n将 $A_R$ 代入 $r=R$ 处的电势：\n$$\n\\phi_R(R, \\theta) = \\left( \\frac{p}{4\\pi\\sigma R^2} + A_R R \\right) \\cos\\theta = \\frac{p}{4\\pi\\sigma R^2} \\left( 1 + \\frac{2\\sigma - \\kappa R}{\\sigma + \\kappa R} \\right) \\cos\\theta\n$$\n简化括号中的项：\n$$\n1 + \\frac{2\\sigma - \\kappa R}{\\sigma + \\kappa R} = \\frac{\\sigma + \\kappa R + 2\\sigma - \\kappa R}{\\sigma + \\kappa R} = \\frac{3\\sigma}{\\sigma + \\kappa R}\n$$\n因此，罗宾情况下的表面电势为：\n$$\n\\phi_R(R, \\theta) = \\frac{p}{4\\pi\\sigma R^2} \\frac{3\\sigma}{\\sigma + \\kappa R} \\cos\\theta = \\frac{3p}{4\\pi R^2 (\\sigma + \\kappa R)} \\cos\\theta\n$$\n\n**3. 导联振幅和相对差异**\n诺伊曼情况下的导联振幅为：\n$$\n\\Delta V_N = \\phi_N(R, \\theta_1) - \\phi_N(R, \\theta_2) = \\frac{3p}{4\\pi\\sigma R^2} (\\cos\\theta_1 - \\cos\\theta_2)\n$$\n罗宾情况下的导联振幅为：\n$$\n\\Delta V_R = \\phi_R(R, \\theta_1) - \\phi_R(R, \\theta_2) = \\frac{3p}{4\\pi R^2 (\\sigma + \\kappa R)} (\\cos\\theta_1 - \\cos\\theta_2)\n$$\n相对差异 $\\delta$ 定义为：\n$$\n\\delta = \\frac{\\Delta V_R - \\Delta V_N}{\\Delta V_N} = \\frac{\\Delta V_R}{\\Delta V_N} - 1\n$$\n计算比率：\n$$\n\\frac{\\Delta V_R}{\\Delta V_N} = \\frac{\\frac{3p}{4\\pi R^2 (\\sigma + \\kappa R)} (\\cos\\theta_1 - \\cos\\theta_2)}{\\frac{3p}{4\\pi\\sigma R^2} (\\cos\\theta_1 - \\cos\\theta_2)} = \\frac{\\sigma}{\\sigma + \\kappa R}\n$$\n这个简洁的简化表明，该比率与偶极矩 $p$ 和电极位置 $\\theta_1, \\theta_2$ 无关（前提是 $\\cos\\theta_1 \\neq \\cos\\theta_2$）。\n现在，我们求 $\\delta$：\n$$\n\\delta = \\frac{\\sigma}{\\sigma + \\kappa R} - 1 = \\frac{\\sigma - (\\sigma + \\kappa R)}{\\sigma + \\kappa R} = \\frac{-\\kappa R}{\\sigma + \\kappa R}\n$$\n最后，我们代入 $\\kappa = \\frac{1}{Z_c 4\\pi R^2}$ 的定义：\n$$\n\\delta = \\frac{-\\left(\\frac{1}{Z_c 4\\pi R^2}\\right) R}{\\sigma + \\left(\\frac{1}{Z_c 4\\pi R^2}\\right) R} = \\frac{-\\frac{1}{4\\pi Z_c R}}{\\sigma + \\frac{1}{4\\pi Z_c R}}\n$$\n为进一步简化，我们将分子和分母同乘以 $4\\pi Z_c R$：\n$$\n\\delta = \\frac{-1}{4\\pi \\sigma Z_c R + 1}\n$$\n这就是要实现的最终公式。参数 $p$、$\\theta_1$ 和 $\\theta_2$ 对于计算 $\\delta$ 而言是无关的，尽管它们对于定义导联电压本身是必需的。\n\n### **数值实现计划**\nPython 代码将遍历五个测试用例。对于每个用例，它将使用给定的 $R$ 和 $\\sigma$ 值，以及常数 $Z_c = 1000\\,\\Omega$，利用推导出的公式计算 $\\delta$。结果将四舍五入到六位小数，并以指定格式打印。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an ECG forward model to compare surface lead amplitudes\n    computed with Neumann versus Robin boundary conditions for a homogeneous\n    spherical torso. The relative difference is calculated for a suite of test cases.\n    \"\"\"\n    \n    # The relative difference, delta, is given by the derived formula:\n    # delta = -1 / (4 * pi * sigma * Z_c * R + 1)\n    # where all parameters are in SI units.\n    \n    # Constant parameter from the problem statement\n    Z_c = 1000.0  # Contact impedance in Ohms (1 kOhm)\n\n    # Test cases from the problem statement.\n    # Each tuple contains: (R in m, sigma in S/m)\n    # The other parameters (p, theta1, theta2) are not needed for calculating delta.\n    test_cases = [\n        (0.15, 0.20),  # Test case 1\n        (0.15, 0.05),  # Test case 2\n        (0.10, 0.20),  # Test case 3\n        (0.15, 0.20),  # Test case 4\n        (0.20, 0.25),  # Test case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        R, sigma = case\n        \n        # Calculate the denominator of the derived formula for delta.\n        # The term 4*pi*sigma*Z_c*R is dimensionless.\n        denominator = 4 * np.pi * sigma * Z_c * R + 1\n        \n        # Calculate delta\n        delta = -1.0 / denominator\n        \n        # Round the result to six decimal places as required.\n        results.append(round(delta, 6))\n\n    # Format the final output as a comma-separated list in square brackets.\n    # The map(str, ...) ensures each number is converted to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver function.\nsolve()\n```"
        },
        {
            "introduction": "在第一个实践的基础上，我们将认识到真实的躯干并非均匀介质。本练习引入了一个更具解剖学真实性的多层球体模型，用以模拟具有不同电导率的组织（如心脏、肺部和躯干肌肉）。通过推导此分层结构中的电势 ，您将深入理解低电导率组织（例如肺部）如何衰减和重塑在体表测量到的心电信号。",
            "id": "3883439",
            "problem": "考虑麦克斯韦方程组准静态机制下的心电图（ECG）正问题，其中，导电介质中的电势 $\\Phi(\\mathbf{r})$ 满足 $\\nabla \\cdot (\\sigma(\\mathbf{r}) \\nabla \\Phi(\\mathbf{r})) = \\nabla \\cdot \\mathbf{J}_{p}(\\mathbf{r})$，式中 $\\mathbf{J}_{p}$ 为外加源电流密度。将躯干建模为一个同心的三层球形导体：一个代表心脏的内球，半径为 $a_{1}$，电导率为 $\\sigma_{1}$；一个代表肺部的球壳，范围为 $a_{1}  r  a_{2}$，电导率为 $\\sigma_{2}$；以及一个代表躯干的外球壳，范围为 $a_{2}  r  a_{3}$，电导率为 $\\sigma_{3}$。假设外边界 $r = a_{3}$ 是绝缘的，即 $\\frac{\\partial \\Phi}{\\partial r} \\bigg|_{r=a_3} = 0$。心脏源被建模为一个位于几何中心 $r = 0$ 的点电流偶极子，其矩为 $\\mathbf{p} = p \\,\\hat{\\mathbf{z}}$。\n\n从上述控制方程出发，在球坐标系下使用分离变量法，利用勒让德多项式展开，推导与轴对称性一致的各层电势的解析表达式。在 $r = a_{1}$ 和 $r = a_{2}$ 处施加电势连续性和法向电流连续性的条件，以及在 $r = a_{3}$ 处的绝缘边界条件，以获得外表面 $r = a_{3}$ 上的电势，并用模型参数 $p$, $a_{1}$, $a_{2}$, $a_{3}$, $\\sigma_{1}$, $\\sigma_{2}$ 和 $\\sigma_{3}$ 来表示。然后，将由肺壳引起的衰减因子定义为：三层模型在 $r = a_{3}$ 处的表面电势幅值，与不含肺壳的其他方面均相同的两层模型（即，半径为 $a_{1}$、电导率为 $\\sigma_{1}$ 的心脏直接嵌入在范围为 $a_{1}  r  a_{3}$、电导率为 $\\sigma_{3}$ 的躯干壳中，且在 $r = a_{3}$ 处具有相同的绝缘边界）的表面电势幅值之比。\n\n将衰减因子的最终答案表示为由 $a_{1}$, $a_{2}$, $a_{3}$, $\\sigma_{1}$, $\\sigma_{2}$ 和 $\\sigma_{3}$ 构成的单个闭式解析表达式。衰减因子是无量纲的，不需要单位。不要提供任何数值计算，也无需四舍五入。",
            "solution": "### 问题验证\n\n**第 1 步：提取已知条件**\n\n*   **控制方程**：$\\nabla \\cdot (\\sigma(\\mathbf{r}) \\nabla \\Phi(\\mathbf{r})) = \\nabla \\cdot \\mathbf{J}_{p}(\\mathbf{r})$\n*   **源**：来自位于原点 ($r=0$) 的点电流偶极子（其矩为 $\\mathbf{p} = p \\,\\hat{\\mathbf{z}}$）的外加电流密度 $\\mathbf{J}_{p}$。\n*   **三层模型几何结构**：\n    *   第 1 层（心脏）：$0 \\le r  a_1$，电导率 $\\sigma_1$。\n    *   第 2 层（肺部）：$a_1  r  a_2$，电导率 $\\sigma_2$。\n    *   第 3 层（躯干）：$a_2  r  a_3$，电导率 $\\sigma_3$。\n*   **两层模型几何结构（用于比较）**：\n    *   第 1 层（心脏）：$0 \\le r  a_1$，电导率 $\\sigma_1$。\n    *   第 2 层（躯干）：$a_1  r  a_3$，电导率 $\\sigma_3$。\n*   **外边界条件**：在 $r=a_3$ 处绝缘，即 $\\frac{\\partial \\Phi}{\\partial r} \\big|_{r=a_{3}} = 0$。\n*   **界面条件**：\n    *   电势连续性：$\\Phi$ 在 $r=a_1$ 和 $r=a_2$ 处连续。\n    *   法向电流密度连续性：$\\sigma \\nabla \\Phi$ 的法向分量在 $r=a_1$ 和 $r=a_2$ 处连续。\n*   **定义**：衰减因子是三层模型在表面 ($r=a_3$) 的电势幅值与两层模型在该处电势幅值之比。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n*   **科学依据（关键）**：该问题在根本上是合理的。控制方程是准静态极限下生物电现象的标准方程。同心球模型虽然是一种简化，却是心电学中用于解析研究的经典且广泛使用的模型。电流偶极子是心脏活动的标准源模型。\n*   **适定的**：该问题是一个二阶椭圆偏微分方程的适定边值问题。源、边界条件和界面条件都已指定，确保了唯一解的存在。\n*   **客观性（关键）**：问题陈述使用了精确的数学和物理语言，没有歧义或主观论断。\n*   **缺陷检查表**：该问题没有违反任何无效性标准。它在科学上是合理的、可形式化的、完整的、可行的、适定的、非平凡的且可验证的。\n\n**第 3 步：结论与行动**\n\n问题是**有效的**。我将继续进行解的推导。\n\n###\n### 衰减因子的推导\n\n控制方程为 $\\nabla \\cdot (\\sigma(\\mathbf{r}) \\nabla \\Phi(\\mathbf{r})) = \\nabla \\cdot \\mathbf{J}_{p}(\\mathbf{r})$。源是位于原点的点电流偶极子，$\\mathbf{J}_{p}(\\mathbf{r}) = \\mathbf{p} \\delta(\\mathbf{r})$，其中 $\\delta(\\mathbf{r})$ 是狄拉克 delta 函数。方程右侧是 $\\nabla \\cdot (\\mathbf{p} \\delta(\\mathbf{r}))$。这个源项可以通过考虑偶极子在电导率为 $\\sigma_1$ 的无限均匀介质中的一次电势来引入。该一次电势为 $\\Phi_{p}(r, \\theta) = \\frac{1}{4\\pi\\sigma_1} \\frac{\\mathbf{p} \\cdot \\mathbf{r}}{r^3} = \\frac{p \\cos\\theta}{4\\pi\\sigma_1 r^2}$。\n\n在任何电导率 $\\sigma$ 恒定且无源的区域，控制方程简化为拉普拉斯方程，$\\nabla^2 \\Phi = 0$。\n由于偶极子源 $\\mathbf{p} = p \\hat{\\mathbf{z}}$ 的轴对称性，电势 $\\Phi$ 将只依赖于 $r$ 和 $\\theta$。在球坐标系中，具有轴对称性的拉普拉斯方程的通解由勒让德多项式展开给出，$\\Phi(r, \\theta) = \\sum_{l=0}^{\\infty} (A_l r^l + B_l r^{-(l+1)}) P_l(\\cos\\theta)$。偶极子源项对应于 $l=1$ 模式，因为 $P_1(\\cos\\theta) = \\cos\\theta$。因此，所有 $l \\neq 1$ 的系数都为零。在中间步骤中，我们可以省略求和符号和 $P_1(\\cos\\theta)$ 因子，因为它是所有项的公因子。\n\n**第 1 部分：三层模型**\n\n各层中的电势可以写为：\n1.  区域 $1$ ($0 \\le r  a_1$, 电导率 $\\sigma_1$):\n    $\\Phi_1(r) = S \\sigma_1^{-1} r^{-2} + A_1 r$。这里 $S = p/(4\\pi)$ 是偶极子源强度因子。$A_1 r$ 项是二次电势，它在原点必须是正则的。\n2.  区域 $2$ ($a_1  r  a_2$, 电导率 $\\sigma_2$):\n    $\\Phi_2(r) = B_2 r + C_2 r^{-2}$。\n3.  区域 $3$ ($a_2  r  a_3$, 电导率 $\\sigma_3$):\n    $\\Phi_3(r) = B_3 r + C_3 r^{-2}$。\n\n五个未知系数 ($A_1, B_2, C_2, B_3, C_3$) 由边界和界面条件确定：\n1.  $\\Phi_1(a_1) = \\Phi_2(a_1) \\implies S\\sigma_1^{-1} a_1^{-2} + A_1 a_1 = B_2 a_1 + C_2 a_1^{-2}$\n2.  $\\sigma_1 \\Phi'_1(a_1) = \\sigma_2 \\Phi'_2(a_1) \\implies \\sigma_1(-2S\\sigma_1^{-1}a_1^{-3} + A_1) = \\sigma_2(B_2 - 2C_2 a_1^{-3})$\n3.  $\\Phi_2(a_2) = \\Phi_3(a_2) \\implies B_2 a_2 + C_2 a_2^{-2} = B_3 a_2 + C_3 a_2^{-2}$\n4.  $\\sigma_2 \\Phi'_2(a_2) = \\sigma_3 \\Phi'_3(a_2) \\implies \\sigma_2(B_2 - 2C_2 a_2^{-3}) = \\sigma_3(B_3 - 2C_3 a_2^{-3})$\n5.  $\\Phi'_3(a_3) = 0 \\implies B_3 - 2C_3 a_3^{-3} = 0 \\implies B_3 = 2C_3 a_3^{-3}$\n\n我们的目标是外表面的电势幅值，$V_{3L} = \\Phi_3(a_3)$。使用条件 5，我们得到 $V_{3L} = B_3 a_3 + C_3 a_3^{-2} = (2C_3 a_3^{-3}) a_3 + C_3 a_3^{-2} = 3C_3 a_3^{-2}$。我们需要求解 $C_3$。\n这个由五个线性方程组成的方程组可以求解出 $C_3$。该过程涉及系统地消去其他系数。我们首先使用条件 3、4、5 将 $B_2$ 和 $C_2$ 用 $C_3$ 表示。然后使用条件 1 将 $A_1$ 用 $B_2, C_2$ 表示。最后，将所有内容代入条件 2，得到一个关于 $C_3$ 的方程。或者，我们可以从条件 1 和 2 中消去 $A_1$。将条件 1 乘以 $\\sigma_1 a_1^{-1}$ 并减去条件 2，得到：\n$\\sigma_1(S\\sigma_1^{-1}a_1^{-3} + A_1) - \\sigma_1(-2S\\sigma_1^{-1}a_1^{-3} + A_1) = \\sigma_1 a_1^{-1}(B_2 a_1 + C_2 a_1^{-2}) - \\sigma_2(B_2 - 2C_2 a_1^{-3})$\n$3S a_1^{-3} = (\\sigma_1 - \\sigma_2)B_2 + (\\sigma_1 + 2\\sigma_2)C_2 a_1^{-3}$\n$3S = (\\sigma_1 - \\sigma_2)B_2 a_1^3 + (\\sigma_1 + 2\\sigma_2)C_2$\n\n求解关于 $B_2$ 和 $C_2$ 的子系统，用 $C_3$ 表示（根据条件 3、4、5），得到：\n$C_2 = C_3 \\frac{(\\sigma_2+2\\sigma_3) + 2(\\sigma_2-\\sigma_3)(a_2/a_3)^3}{3\\sigma_2}$\n$B_2 = C_3 \\frac{2(2\\sigma_2+\\sigma_3)a_3^{-3} + 2(\\sigma_2-\\sigma_3)a_2^{-3}}{3\\sigma_2}$\n\n将这些代入关于 $3S$ 的方程并求解 $C_3$，得到：\n$C_3 = \\frac{9S\\sigma_2}{D_{3L}}$\n其中分母 $D_{3L}$ 是：\n$D_{3L} = (\\sigma_1 + 2\\sigma_2)(\\sigma_2 + 2\\sigma_3) + 2\\left(\\frac{a_1}{a_2}\\right)^3 (\\sigma_1 - \\sigma_2)(\\sigma_2 - \\sigma_3) + 2\\left(\\frac{a_2}{a_3}\\right)^3 (\\sigma_1 + 2\\sigma_2)(\\sigma_2 - \\sigma_3) + 2\\left(\\frac{a_1}{a_3}\\right)^3 (\\sigma_1 - \\sigma_2)(2\\sigma_2 + \\sigma_3)$.\n表面电势幅值为 $V_{3L} = 3C_3 a_3^{-2} = \\frac{27S\\sigma_2 a_3^{-2}}{D_{3L}}$。\n\n**第 2 部分：两层模型**\n\n该模型是三层模型中第 2 层缺失的特例，可以通过设置 $a_2=a_1$ 或设置 $\\sigma_2 = \\sigma_3$ 并忽略 $a_2$ 来建模。直接推导更安全。\n1.  区域 $1$ ($0 \\le r  a_1$, 电导率 $\\sigma_1$):\n    $\\Phi_1(r) = S \\sigma_1^{-1} r^{-2} + A'_1 r$\n2.  区域 $2'$ ($a_1  r  a_3$, 电导率 $\\sigma_3$):\n    $\\Phi'_2(r) = B'_3 r + C'_3 r^{-2}$\n\n三个条件是：\n1.  $\\Phi_1(a_1) = \\Phi'_2(a_1) \\implies S\\sigma_1^{-1} a_1^{-2} + A'_1 a_1 = B'_3 a_1 + C'_3 a_1^{-2}$\n2.  $\\sigma_1 \\Phi'_1(a_1) = \\sigma_3 \\Phi'_2(a_1) \\implies \\sigma_1(-2S\\sigma_1^{-1}a_1^{-3} + A'_1) = \\sigma_3(B'_3 - 2C'_3 a_1^{-3})$\n3.  $\\Phi'_2(a_3) = 0 \\implies B'_3 - 2C'_3 a_3^{-3} = 0 \\implies B'_3 = 2C'_3 a_3^{-3}$\n\n表面电势幅值为 $V_{2L} = \\Phi'_2(a_3) = B'_3 a_3 + C'_3 a_3^{-2} = 3C'_3 a_3^{-2}$。我们求解 $C'_3$。\n从条件 1 和 2 中消去 $A'_1$，得到：\n$3S a_1^{-3} = (\\sigma_1 - \\sigma_3)B'_3 + (\\sigma_1+2\\sigma_3)C'_3 a_1^{-3}$\n代入 $B'_3 = 2C'_3 a_3^{-3}$ (条件 3)：\n$3S a_1^{-3} = (\\sigma_1 - \\sigma_3)(2C'_3 a_3^{-3}) + (\\sigma_1+2\\sigma_3)C'_3 a_1^{-3}$\n$3S = C'_3 \\left( 2(\\sigma_1 - \\sigma_3)\\left(\\frac{a_1}{a_3}\\right)^3 + (\\sigma_1+2\\sigma_3) \\right)$\n因此，$C'_3 = \\frac{3S}{D_{2L}}$，其中 $D_{2L} = (\\sigma_1+2\\sigma_3) + 2(\\sigma_1-\\sigma_3)\\left(\\frac{a_1}{a_3}\\right)^3$。\n表面电势幅值为 $V_{2L} = 3C'_3 a_3^{-2} = \\frac{9S a_3^{-2}}{D_{2L}}$。\n\n**第 3 部分：衰减因子**\n\n衰减因子 $\\mathcal{A}$ 是两个表面电势幅值之比：\n$\\mathcal{A} = \\frac{V_{3L}}{V_{2L}} = \\frac{27S\\sigma_2 a_3^{-2}/D_{3L}}{9S a_3^{-2}/D_{2L}} = \\frac{3\\sigma_2 D_{2L}}{D_{3L}}$.\n代入 $D_{2L}$ 和 $D_{3L}$ 的表达式：\n$\\mathcal{A} = \\frac{3\\sigma_2 \\left[ (\\sigma_1 + 2\\sigma_3) + 2(\\sigma_1 - \\sigma_3) \\left(\\frac{a_1}{a_3}\\right)^3 \\right]}{(\\sigma_1 + 2\\sigma_2)(\\sigma_2 + 2\\sigma_3) + 2\\left(\\frac{a_1}{a_2}\\right)^3 (\\sigma_1 - \\sigma_2)(\\sigma_2 - \\sigma_3) + 2\\left(\\frac{a_2}{a_3}\\right)^3 (\\sigma_1 + 2\\sigma_2)(\\sigma_2 - \\sigma_3) + 2\\left(\\frac{a_1}{a_3}\\right)^3 (\\sigma_1 - \\sigma_2)(2\\sigma_2 + \\sigma_3)}$\n这就是衰减因子的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\n\\frac{3\\sigma_2 \\left[ (\\sigma_1 + 2\\sigma_3) + 2(\\sigma_1 - \\sigma_3) \\left(\\frac{a_1}{a_3}\\right)^3 \\right]}{(\\sigma_1 + 2\\sigma_2)(\\sigma_2 + 2\\sigma_3) + 2\\left(\\frac{a_1}{a_2}\\right)^3 (\\sigma_1 - \\sigma_2)(\\sigma_2 - \\sigma_3) + 2\\left(\\frac{a_2}{a_3}\\right)^3 (\\sigma_1 + 2\\sigma_2)(\\sigma_2 - \\sigma_3) + 2\\left(\\frac{a_1}{a_3}\\right)^3 (\\sigma_1 - \\sigma_2)(2\\sigma_2 + \\sigma_3)}\n}\n$$"
        },
        {
            "introduction": "最后一个实践旨在培养对模型核心假设的批判性思维。前面的模型将生物组织处理为纯电阻性介质，但这是一种近似。本练习通过建立一个同时包含电阻和电容特性的生物界面模型来挑战这一假设 ，让您能够定量评估频率依赖性电容效应的重要性，并理解在何种情况下简化为纯电阻模型是合理的。",
            "id": "3883391",
            "problem": "在心电图（ECG）的正向建模中，心脏-躯干界面通常被近似为一个纯电阻性边界。为了评估忽略该界面上电容耦合所引入的定量误差，我们考虑一个空间上均匀的界面，该界面被建模为一个并联电阻-电容（RC）网络，其特征是单位面积比电阻 $R_{s}$（单位：$\\Omega \\cdot \\text{cm}^{2}$）和单位面积比电容 $C'$（单位：$\\text{F}/\\text{cm}^{2}$）。假设存在一个均匀的界面面积 $A$，跨膜电位通过该界面驱动电流进入躯干容积导体。\n\n从电阻和电容的复阻抗和导纳的基本定义以及集总元件与几何面积的缩放关系出发，推导在正弦驱动频率 $f$ 下，电容支路阻抗幅值与电阻支路阻抗幅值之比 $\\rho$ 的一个与面积无关的表达式。然后，在 $f = 50\\,\\text{Hz}$，$R_{s} = 1\\,\\text{k}\\Omega \\cdot \\text{cm}^{2}$ 和 $C' = 1\\,\\mu\\text{F}/\\text{cm}^{2}$ 的条件下，计算该比值。\n\n- 仅使用阻抗的基本关系和角频率的定义。\n- 将 $\\rho$ 的最终数值表示为一个无量纲数。\n- 将您的答案四舍五入到 4 位有效数字。",
            "solution": "该问题要求为心脏-躯干界面的并联RC电路模型推导电容性阻抗幅值与电阻性阻抗幅值之比的一个与面积无关的表达式，然后对该比值进行数值计算。\n\n首先，我们形式化集总电路元件（总电阻 $R$ 和总电容 $C$）与给定的特定属性（单位面积比电阻 $R_s$ 和单位面积比电容 $C'$）之间的关系。该界面具有均匀的面积 $A$。\n\n对于电阻性介质，总电阻 $R$ 与电流流过的面积 $A$ 成反比。与比电阻 $R_s$（单位为 $\\Omega\\cdot\\text{cm}^{2}$）的关系是：\n$$R = \\frac{R_s}{A}$$\n\n对于平面电容器，总电容 $C$ 与面积 $A$ 成正比。与比电容 $C'$（单位为 $\\text{F}/\\text{cm}^{2}$）的关系是：\n$$C = C' \\cdot A$$\n\n该界面被建模为一个并联RC网络。电阻支路的阻抗 $Z_R$ 就是其电阻：\n$$Z_R = R = \\frac{R_s}{A}$$\n\n对于角频率为 $\\omega$ 的正弦信号，电容支路的阻抗 $Z_C$ 由下式给出：\n$$Z_C = \\frac{1}{j\\omega C}$$\n其中 $j$ 是虚数单位。角频率 $\\omega$ 与驱动频率 $f$ 的关系为 $\\omega = 2\\pi f$。将 $\\omega$ 和 $C$ 的表达式代入 $Z_C$ 的方程：\n$$Z_C = \\frac{1}{j(2\\pi f)(C' A)}$$\n\n问题要求的是电容性阻抗的*幅值*与电阻性阻抗的*幅值*之比 $\\rho$。\n\n电阻性阻抗的幅值为：\n$$|Z_R| = \\left| \\frac{R_s}{A} \\right| = \\frac{R_s}{A}$$\n因为 $R_s$ 和 $A$ 都是正实数。\n\n电容性阻抗的幅值为：\n$$|Z_C| = \\left| \\frac{1}{j(2\\pi f)(C' A)} \\right| = \\frac{|1|}{|j| \\cdot |2\\pi f C' A|} = \\frac{1}{1 \\cdot (2\\pi f C' A)} = \\frac{1}{2\\pi f C' A}$$\n因为 $|j|=1$ 且分母中的所有其他量都是正实数。\n\n那么，比值 $\\rho$ 为：\n$$\\rho = \\frac{|Z_C|}{|Z_R|} = \\frac{\\frac{1}{2\\pi f C' A}}{\\frac{R_s}{A}}$$\n\n为简化起见，我们将分子乘以分母的倒数：\n$$\\rho = \\frac{1}{2\\pi f C' A} \\cdot \\frac{A}{R_s}$$\n面积 $A$ 被约去，得到所需的与面积无关的表达式：\n$$\\rho = \\frac{1}{2\\pi f C' R_s}$$\n\n接下来，我们用给定的数值计算这个表达式：\n$f = 50\\,\\text{Hz}$\n$R_s = 1\\,\\text{k}\\Omega\\cdot\\text{cm}^{2} = 1 \\times 10^3\\,\\Omega\\cdot\\text{cm}^{2}$\n$C' = 1\\,\\mu\\text{F}/\\text{cm}^{2} = 1 \\times 10^{-6}\\,\\text{F}/\\text{cm}^{2}$\n\n将这些值代入 $\\rho$ 的表达式中：\n$$\\rho = \\frac{1}{2\\pi (50) (1 \\times 10^{-6}) (1 \\times 10^3)}$$\n单位组合为 $(\\text{Hz}) \\cdot (\\text{F}/\\text{cm}^2) \\cdot (\\Omega\\cdot\\text{cm}^2) = (\\text{s}^{-1}) \\cdot (\\text{F}\\cdot\\Omega) = (\\text{s}^{-1})\\cdot(\\text{s}) = 1$，因此 $\\rho$ 按要求是无量纲的。\n\n进行数值计算：\n$$\\rho = \\frac{1}{100\\pi \\times 10^{-3}} = \\frac{1}{0.1\\pi} = \\frac{10}{\\pi}$$\n\n现在我们计算最终值并四舍五入到 $4$ 位有效数字：\n$$\\rho \\approx 3.18309886...$$\n四舍五入后得到：\n$$\\rho \\approx 3.183$$",
            "answer": "$$\\boxed{3.183}$$"
        }
    ]
}