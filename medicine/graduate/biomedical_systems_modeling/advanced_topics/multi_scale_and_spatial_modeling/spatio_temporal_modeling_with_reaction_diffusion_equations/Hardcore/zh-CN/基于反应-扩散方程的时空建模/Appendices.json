{
    "hands_on_practices": [
        {
            "introduction": "反应扩散方程不仅描述了浓度的宏观变化，也与单个粒子的微观随机运动深刻相关。这项练习将理论与实践相结合，首先从扩散方程的第一性原理出发，推导出粒子运动的关键统计量——均方位移（Mean-Squared Displacement, MSD）。接着，它将这一理论应用于一种重要的生物实验技术——荧光漂白恢复（FRAP），向你展示如何利用这些基本原理从真实的实验数据中提取出关键的生物物理参数，如扩散系数。",
            "id": "3928991",
            "problem": "考虑一个均匀、各向同性的介质，其中一个荧光标记的生物分子以恒定的扩散系数 $D$进行扩散。在 $n$ 维空间中，浓度场 $c(x,t)$ 在无限域上遵循菲克第二定律（热方程）$\\partial c / \\partial t = D \\nabla^{2} c$演化，其物理上允许的初始条件为点源 $c(x,0) = \\delta(x)$ 并且在无穷远处通量为零。\n\nA部分：从这些基本原理出发，推导扩散分子的均方位移 $\\langle |x|^{2} \\rangle(t)$ 作为时间 $t$ 和空间维度 $n$ 的函数。您的推导必须从控制方程和适当的初始条件开始，并通过求得基本解并计算 $\\langle |x|^{2} \\rangle(t) = \\int_{\\mathbb{R}^{n}} |x|^{2} G(x,t) \\,\\mathrm{d}x$ 来进行，其中 $G(x,t)$ 是热方程的格林函数。\n\nB部分：在一个二维的光漂白后荧光恢复（FRAP）实验中，假设在时间 $t=0$ 时，半径为 $r_{0}$ 的圆形区域发生瞬时、完全的漂白，漂白前的归一化浓度为 $|x|  r_{0}$ 时 $c(x,0)=0$，$|x| \\ge r_{0}$ 时 $c(x,0)=1$。在同样的纯扩散假设下，推导中心浓度恢复的解析表达式 $c(0,t)$，并根据漂白半径 $r_{0}$ 和由 $c(0,t_{1/2}) = \\tfrac{1}{2}$ 定义的半恢复时间 $t_{1/2}$，得到扩散系数 $D$ 的闭合形式表达式。\n\n数值计算：使用您推导的表达式，计算当 $r_{0} = 10\\,\\mu\\mathrm{m}$ 和 $t_{1/2} = 4.00\\,\\mathrm{s}$ 时的扩散系数。将最终数值答案四舍五入至四位有效数字。以 $\\mu\\mathrm{m}^{2}/\\mathrm{s}$ 为单位表示最终的扩散系数。",
            "solution": "用户提供了一个关于扩散的多部分问题，我已验证该问题在科学上是合理的、适定的，并包含获得唯一解所需的所有信息。我将进行完整的推导。\n\n该问题分为两部分。A部分要求推导从点源扩散的粒子的均方位移（MSD）。B部分将扩散理论应用于光漂白后荧光恢复（FRAP）实验以确定扩散系数。\n\n**A部分：均方位移的推导**\n\n浓度场 $c(x,t)$ 的演化由 $n$ 维空间中的菲克第二定律决定：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^{2} c\n$$\n问题指定了对应于原点处点源的初始条件，由狄拉克δ函数表示：$c(x,0) = \\delta(x)$。带有此初始条件的偏微分方程的解是格林函数，或称基本解，$G(x,t)$。\n\n首先，我们通过对空间变量 $x$ 应用傅里叶变换来求 $G(x,t)$。令 $\\hat{c}(k,t) = \\mathcal{F}[c(x,t)] = \\int_{\\mathbb{R}^n} c(x,t) \\exp(-i k \\cdot x) d^n x$。该偏微分方程变换为一个关于时间的常微分方程：\n$$\n\\frac{d\\hat{c}}{dt} = -D|k|^2 \\hat{c}(k,t)\n$$\n初始条件的傅里叶变换是 $\\hat{c}(k,0) = \\mathcal{F}[\\delta(x)] = 1$。此常微分方程的解是：\n$$\n\\hat{c}(k,t) = \\exp(-D|k|^2 t)\n$$\n这是傅里叶空间中的格林函数，$\\hat{G}(k,t)$。为了求得 $G(x,t)$，我们进行傅里叶逆变换：\n$$\nG(x,t) = \\mathcal{F}^{-1}[\\hat{G}(k,t)] = \\frac{1}{(2\\pi)^n} \\int_{\\mathbb{R}^n} \\exp(-D|k|^2 t) \\exp(i k \\cdot x) d^n k\n$$\n该积分为 $n$ 个一维高斯积分的乘积：\n$$\nG(x,t) = \\frac{1}{(2\\pi)^n} \\prod_{j=1}^{n} \\int_{-\\infty}^{\\infty} \\exp(-D t k_j^2 + i k_j x_j) dk_j\n$$\n使用标准高斯积分恒等式 $\\int_{-\\infty}^{\\infty} \\exp(-a z^2 + bz) dz = \\sqrt{\\frac{\\pi}{a}} \\exp(\\frac{b^2}{4a})$，其中 $a = Dt$ 且 $b = ix_j$：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-D t k_j^2 + i k_j x_j) dk_j = \\sqrt{\\frac{\\pi}{Dt}} \\exp\\left(\\frac{(ix_j)^2}{4Dt}\\right) = \\sqrt{\\frac{\\pi}{Dt}} \\exp\\left(-\\frac{x_j^2}{4Dt}\\right)\n$$\n将此结果代回 $G(x,t)$ 的表达式中：\n$$\nG(x,t) = \\frac{1}{(2\\pi)^n} \\left(\\frac{\\pi}{Dt}\\right)^{n/2} \\exp\\left(-\\frac{\\sum_{j=1}^n x_j^2}{4Dt}\\right) = \\frac{1}{(4\\pi Dt)^{n/2}} \\exp\\left(-\\frac{|x|^2}{4Dt}\\right)\n$$\n这是 $n$ 维扩散方程的基本解。\n\n接下来，我们按照问题的要求计算均方位移 $\\langle |x|^2 \\rangle(t)$：\n$$\n\\langle |x|^2 \\rangle(t) = \\int_{\\mathbb{R}^n} |x|^2 G(x,t) d^n x = \\frac{1}{(4\\pi Dt)^{n/2}} \\int_{\\mathbb{R}^n} |x|^2 \\exp\\left(-\\frac{|x|^2}{4Dt}\\right) d^n x\n$$\n为了计算这个积分，我们转换到超球坐标。令 $r = |x|$。体积元为 $d^n x = r^{n-1} dr d\\Omega_{n-1}$，其中 $d\\Omega_{n-1}$ 是单位 $(n-1)$ 维球面的面元。对 $d\\Omega_{n-1}$ 的积分得到总立体角，即 $(n-1)$ 维球面的表面积，$S_{n-1} = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}$，其中 $\\Gamma$ 是伽马函数。\n$$\n\\langle |x|^2 \\rangle(t) = \\frac{S_{n-1}}{(4\\pi Dt)^{n/2}} \\int_0^\\infty r^2 \\cdot r^{n-1} \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)(4\\pi Dt)^{n/2}} \\int_0^\\infty r^{n+1} \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr\n$$\n剩余的积分是标准形式，可以使用恒等式 $\\int_0^\\infty z^m \\exp(-az^2) dz = \\frac{\\Gamma((m+1)/2)}{2a^{(m+1)/2}}$ 求解。这里，$m=n+1$ 且 $a = \\frac{1}{4Dt}$。\n$$\n\\int_0^\\infty r^{n+1} \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr = \\frac{\\Gamma((n+2)/2)}{2(1/(4Dt))^{(n+2)/2}} = \\frac{\\Gamma(n/2 + 1)}{2} (4Dt)^{n/2+1}\n$$\n使用性质 $\\Gamma(z+1)=z\\Gamma(z)$，我们有 $\\Gamma(n/2+1) = \\frac{n}{2}\\Gamma(n/2)$。\n$$\n\\text{积分} = \\frac{(n/2)\\Gamma(n/2)}{2} (4Dt)^{n/2} (4Dt) = \\frac{n}{4} \\Gamma(n/2) (4Dt)^{n/2} (4Dt)\n$$\n将此结果代回 $\\langle |x|^2 \\rangle(t)$ 的表达式中：\n$$\n\\langle |x|^2 \\rangle(t) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)(4\\pi Dt)^{n/2}} \\left[ \\frac{n}{4} \\Gamma(n/2) (4Dt)^{n/2} (4Dt) \\right]\n$$\n我们消去项：$\\Gamma(n/2)$ 和 $(4Dt)^{n/2}$。注意 $(4\\pi Dt)^{n/2} = 4^{n/2}\\pi^{n/2}(Dt)^{n/2}$。\n$$\n\\langle |x|^2 \\rangle(t) = \\frac{2\\pi^{n/2}}{4^{n/2}\\pi^{n/2}(Dt)^{n/2}} \\left[ \\frac{n}{4} (4Dt)^{n/2} (4Dt) \\right] = \\frac{2}{4^{n/2}} \\frac{n}{4} 4^{n/2} (4Dt) = \\frac{n}{2} (4Dt)\n$$\n$$\n\\langle |x|^2 \\rangle(t) = 2nDt\n$$\n这就是著名的关于点源扩散的爱因斯坦关系式。\n\n**B部分：FRAP分析与D的计算**\n\n问题的这一部分考虑一个二维系统 ($n=2$)。初始条件是一个均匀的圆形漂白区域：当 $|x|  r_0$ 时 $c(x,0) = 0$，当 $|x| \\ge r_0$ 时 $c(x,0) = 1$。我们需要求出漂白区域中心的浓度 $c(0,t)$。\n\n解由初始条件与二维格林函数的卷积给出：\n$$\nc(x,t) = \\int_{\\mathbb{R}^2} G(x-x', t) c(x', 0) d^2 x'\n$$\n对于 $n=2$，格林函数为 $G(x,t) = \\frac{1}{4\\pi Dt} \\exp\\left(-\\frac{|x|^2}{4Dt}\\right)$。\n我们计算中心点 $x=0$ 的浓度：\n$$\nc(0,t) = \\int_{\\mathbb{R}^2} G(-x', t) c(x', 0) d^2 x' = \\int_{\\mathbb{R}^2} \\frac{1}{4\\pi Dt} \\exp\\left(-\\frac{|x'|^2}{4Dt}\\right) c(x', 0) d^2 x'\n$$\n由于 $c(x',0)$ 仅在 $|x'| \\ge r_0$ 时非零，积分被限制在该区域内：\n$$\nc(0,t) = \\frac{1}{4\\pi Dt} \\int_{|x'| \\ge r_0} \\exp\\left(-\\frac{|x'|^2}{4Dt}\\right) d^2 x'\n$$\n我们转换到极坐标 $(r,\\theta)$，其中 $r = |x'|$。面积元为 $d^2 x' = rdrd\\theta$。\n$$\nc(0,t) = \\frac{1}{4\\pi Dt} \\int_0^{2\\pi} d\\theta \\int_{r_0}^\\infty r \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr = \\frac{2\\pi}{4\\pi Dt} \\int_{r_0}^\\infty r \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr\n$$\n$$\nc(0,t) = \\frac{1}{2Dt} \\int_{r_0}^\\infty r \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr\n$$\n为求解该积分，我们使用换元法，令 $u = \\frac{r^2}{4Dt}$，因此 $du = \\frac{2rdr}{4Dt} = \\frac{rdr}{2Dt}$。积分上下限变为 $u_{lower} = \\frac{r_0^2}{4Dt}$ 和 $u_{upper} = \\infty$。\n$$\nc(0,t) = \\int_{r_0^2/(4Dt)}^\\infty \\exp(-u) du = [-\\exp(-u)]_{r_0^2/(4Dt)}^\\infty = 0 - \\left(-\\exp\\left(-\\frac{r_0^2}{4Dt}\\right)\\right)\n$$\n$$\nc(0,t) = \\exp\\left(-\\frac{r_0^2}{4Dt}\\right)\n$$\n这就是中心浓度恢复的表达式。\n\n接下来，我们使用半恢复时间 $t_{1/2}$ 的定义，即 $c(0, t_{1/2}) = \\frac{1}{2}$ 时的时间。\n$$\n\\frac{1}{2} = \\exp\\left(-\\frac{r_0^2}{4Dt_{1/2}}\\right)\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) = -\\frac{r_0^2}{4Dt_{1/2}}\n$$\n$$\n\\ln(2) = \\frac{r_0^2}{4Dt_{1/2}}\n$$\n求解扩散系数 $D$：\n$$\nD = \\frac{r_0^2}{4 t_{1/2} \\ln(2)}\n$$\n\n**数值计算**\n\n给定 $r_0 = 10\\,\\mu\\mathrm{m}$ 和 $t_{1/2} = 4.00\\,\\mathrm{s}$。\n将这些值代入 $D$ 的表达式中：\n$$\nD = \\frac{(10\\,\\mu\\mathrm{m})^2}{4 \\cdot (4.00\\,\\mathrm{s}) \\cdot \\ln(2)} = \\frac{100\\,\\mu\\mathrm{m}^2}{16.00\\,\\mathrm{s} \\cdot \\ln(2)}\n$$\n使用值 $\\ln(2) \\approx 0.693147...$：\n$$\nD = \\frac{100}{16.00 \\times 0.693147...} \\frac{\\mu\\mathrm{m}^2}{\\mathrm{s}} \\approx \\frac{100}{11.09035...} \\frac{\\mu\\mathrm{m}^2}{\\mathrm{s}} \\approx 9.01684... \\frac{\\mu\\mathrm{m}^2}{\\mathrm{s}}\n$$\n按照要求，将结果四舍五入至四位有效数字：\n$$\nD \\approx 9.017\\,\\mu\\mathrm{m}^2/\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{9.017 \\times 10^0}\n$$"
        },
        {
            "introduction": "对于复杂的生物系统，反应扩散方程的解析解往往难以获得，因此数值方法成为不可或缺的研究工具。然而，不恰当的数值离散化可能会导致非物理的结果，例如负浓度。本练习将引导你亲手实现并对比两种基本的数值格式——朴素的显式欧拉法和稳健的隐式欧拉法，通过编码实践，你将深刻理解数值稳定性对于保证解的物理意义（如非负性）的至关重要性。",
            "id": "3929058",
            "problem": "考虑一个一维反应-扩散模型，用于描述一个由偏微分方程控制的非负生物化学浓度场 $u(x,t)$\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - k u\n$$\n在空间区间 $x \\in [0,L]$ 上，具有零通量（Neumann）边界条件和非负初始条件。这里，$D \\ge 0$ 是扩散系数，$k \\ge 0$ 是一阶反应衰变率。在抛物型偏微分方程领域，一个经过充分检验的事实是连续问题保持非负性：如果 $u(x,0) \\ge 0$ 且边界条件为零通量，则对于所有 $t \\ge 0$ 都有 $u(x,t) \\ge 0$。\n\n你的任务是在间距为 $h = L/(N-1)$ 的均匀网格上，推导、实现并测试两种时间步进离散化方法：\n- 一种朴素显式方法（时间上使用前向欧拉法，空间上使用中心差分）。\n- 一种保正性方法（时间上使用后向欧拉法，空间上使用相同的中心差分算子）。\n\n从 Fick 定律和质量守恒出发，推导显式方法可能违反非负性的条件，并解释为什么隐式方法对于任意时间步长都能保持非负性。在 $x=0$ 和 $x=L$ 处的有限差分离散中，使用镜像虚点来施加零通量边界条件。\n\n实现要求：\n- 使用包含 $N$ 个点的均匀网格，并在二阶空间导数的离散化中通过镜像反射来强制施加零通量边界。\n- 将 $u(x,0)$ 初始化为一个非负的光滑凸起：\n$$\nu(x,0) = \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\sigma^2}\\right),\n$$\n其中 $\\sigma = 0.1L$。\n- 在每个时间步，检测是否有任何网格值变为负数（严格小于 $-10^{-12}$ 的值即视为负数）。\n- 对于隐式方法，在每个步骤中使用稀疏直接求解器精确求解线性系统。\n\n测试套件：\n为以下四组参数集实现模拟。对于每种情况，使用下述指定的时间步长 $\\Delta t$ 在总时间 $T$ 内进行模拟。所有情况均使用 $L=1$ 和 $N=101$。\n\n1. 情况 A（扩散和反应，预期显式方法不稳定）：\n   - $D = 1.0$, $k = 0.5$, $T = 0.01$, $\\Delta t = 0.001$。\n\n2. 情况 B（纯扩散，预期显式方法不稳定）：\n   - $D = 0.1$, $k = 0.0$, $T = 0.05$, $\\Delta t = 0.005$。\n\n3. 情况 C（纯反应衰减，当 $\\Delta t > 1/k$ 时预期显式方法不稳定）：\n   - $D = 0.0$, $k = 5.0$, $T = 1.0$, $\\Delta t = 0.5$。\n\n4. 情况 D（显式方法处于保正性边界条件下）：\n   - $D = 1.0$, $k = 0.0$, $T = 0.001$，$\\Delta t$ 精确选择在显式保正性阈值上\n   $$\n   \\Delta t = \\frac{1}{\\frac{2D}{h^2} + k}.\n   $$\n\n输出规范：\n- 对于四种情况中的每一种，运行两种方法并报告一对布尔值 $[b_{\\text{explicit}}, b_{\\text{implicit}}]$，其中每个布尔值为真当且仅当该方法在时间积分过程中出现了任何负值（使用严格阈值 $-10^{-12}$）。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。因此，输出必须是一个包含四个双元素列表的列表，每个测试用例一个，例如\n`[[true,false],[true,false],[true,false],[false,false]]`。\n输出中不需要物理单位，因为报告的值是布尔值。请确保你的实现是科学上现实且数值上自洽的，并且除了从控制方程和边界条件推导出的公式外，不要使用任何快捷公式。",
            "solution": "控制偏微分方程为\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - k u,\n$$\n其中 $D \\ge 0$，$k \\ge 0$，且边界条件为零通量 $\\frac{\\partial u}{\\partial x}(0,t) = 0$ 和 $\\frac{\\partial u}{\\partial x}(L,t) = 0$。对于非负初始数据 $u(x,0) \\ge 0$，抛物型方程的极值原理表明连续解在所有 $t \\ge 0$ 时都保持 $u(x,t) \\ge 0$。\n\n我们在均匀网格 $x_i = i h$ 上对空间进行离散化，其中 $h = L/(N-1)$，索引为 $i = 0,1,\\dots,N-1$。二阶导数由中心差分算子近似\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2},\n$$\n并使用镜像虚点来强制施加零通量边界。对于 $i=0$，镜像法强制 $u_{-1} = u_1$，因此\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_0 \\approx \\frac{u_{1} - 2 u_0 + u_{-1}}{h^2} = \\frac{2 u_1 - 2 u_0}{h^2}.\n$$\n类似地，对于 $i=N-1$，镜像法得到 $u_{N} = u_{N-2}$，\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{N-1} \\approx \\frac{2 u_{N-2} - 2 u_{N-1}}{h^2}.\n$$\n\n显式方法（时间上使用前向欧拉法）：\n根据第一性原理，前向欧拉法应用以下时间更新\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left( D \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i^n - k u_i^n \\right),\n$$\n对于内部节点，这得到\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left( D \\frac{u_{i+1}^n - 2 u_i^n + u_{i-1}^n}{h^2} - k u_i^n \\right).\n$$\n定义无量纲参数 $r = \\frac{D \\Delta t}{h^2}$ 和 $s = k \\Delta t$。显式更新可以写成当前值和相邻值的线性组合：\n$$\nu_i^{n+1} = (1 - 2 r - s) u_i^n + r u_{i-1}^n + r u_{i+1}^n,\n$$\n在边界处\n$$\nu_0^{n+1} = (1 - 2 r - s) u_0^n + 2 r u_1^n, \\quad\nu_{N-1}^{n+1} = (1 - 2 r - s) u_{N-1}^n + 2 r u_{N-2}^n.\n$$\n对于非负的 $u^n$，显式方法保持非负性的一个充分条件是凸组合中的所有系数都为非负。这要求\n$$\nr \\ge 0 \\quad \\text{and} \\quad 1 - 2 r - s \\ge 0 \\quad \\Longleftrightarrow \\quad \\Delta t \\le \\frac{1}{\\frac{2D}{h^2} + k}.\n$$\n当此条件被违反时，自身权重 $1 - 2 r - s$ 变为负数，即使所有 $u^n$ 都是非负的，更新也可能产生 $u_i^{n+1}  0$。这就是朴素显式离散化方法可能违反保正性的机制。\n\n隐式方法（时间上使用后向欧拉法）：\n后向欧拉法根据以下方式进行更新\n$$\nu^{n+1} - \\Delta t \\left(D \\frac{\\partial^2 u^{n+1}}{\\partial x^2} - k u^{n+1}\\right) = u^n,\n$$\n这可以写成一个线性系统\n$$\n\\left( \\mathbf{I} + s \\mathbf{I} - r \\mathbf{L} \\right) \\mathbf{u}^{n+1} = \\mathbf{u}^n,\n$$\n其中 $\\mathbf{L}$ 是带有镜像 Neumann 边界的离散拉普拉斯算子。$\\mathbf{L}$ 的结构是三对角的，内部节点的主对角线元素为 $-2/h^2$，次对角线元素为 $1/h^2$，而由于镜像，边界相邻的次对角线元素为 $2/h^2$：\n$$\n\\mathbf{L} =\n\\begin{bmatrix}\n-2/h^2  2/h^2  0  \\cdots  0 \\\\\n1/h^2  -2/h^2  1/h^2  \\ddots  \\vdots \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots  \\ddots  1/h^2  -2/h^2  1/h^2 \\\\\n0  \\cdots  0  2/h^2  -2/h^2\n\\end{bmatrix}.\n$$\n因此，系统矩阵\n$$\n\\mathbf{M} = \\mathbf{I} + s \\mathbf{I} - r \\mathbf{L}\n$$\n具有严格正的对角线元素和非正的次对角线元素，并且对于 $r \\ge 0, s \\ge 0$ 是严格对角占优的。这类矩阵是单调矩阵，特别是 M-矩阵。M-矩阵的一个基本性质是 $\\mathbf{M}^{-1} \\ge 0$（分量形式）。因此，对于非负的 $\\mathbf{u}^n$，更新\n$$\n\\mathbf{u}^{n+1} = \\mathbf{M}^{-1} \\mathbf{u}^n\n$$\n对于任何 $\\Delta t > 0$ 都满足 $\\mathbf{u}^{n+1} \\ge 0$。因此，后向欧拉法无条件地保持非负性。\n\n算法设计：\n- 用 $N$ 个点离散化域 $[0,L]$ 并计算 $h = L/(N-1)$。\n- 使用指定的光滑凸起剖面从 $u(x,0)$ 初始化 $\\mathbf{u}^0$。\n- 显式方法：在每个时间步，计算带有镜像边界的离散拉普拉斯算子以得到 $(\\partial^2 u/\\partial x^2)^n$，并通过前向欧拉法更新 $\\mathbf{u}^{n+1}$。通过检查是否 $\\min_i u_i^{n+1}  -10^{-12}$ 来追踪负值。\n- 隐式方法：构建编码了带有镜像边界的离散拉普拉斯算子的稀疏三对角矩阵 $\\mathbf{L}$。在每个时间步，构建 $\\mathbf{M} = \\mathbf{I} + s \\mathbf{I} - r \\mathbf{L}$ 并使用稀疏直接求解器求解 $\\mathbf{M} \\mathbf{u}^{n+1} = \\mathbf{u}^n$。如上检查负值。\n\n测试套件原理：\n- 情况 A 结合了扩散和衰减，相对于 $h$ 有一个大的 $\\Delta t$，确保了 $1 - 2 r - s  0$，使得显式方法很可能出现负值；后向欧拉法保持非负。\n- 情况 B 隔离了扩散，并使用了一个不稳定的显式 $\\Delta t$；后向欧拉法无论如何都保持正值。\n- 情况 C 隔离了反应衰减，并使用 $\\Delta t > 1/k$，对于显式方法会产生负的 $u^{n+1} = (1 - k \\Delta t) u^n$，而后向欧拉法给出 $u^{n+1} = \\frac{u^n}{1 + k \\Delta t} \\ge 0$。\n- 情况 D 将 $\\Delta t$ 精确设置在显式保正性阈值上，因此显式格式成为一个非负凸组合，从而产生非负性；后向欧拉法也是非负的。\n\n程序实现了这些步骤，并为每种情况返回一对布尔值 $[b_{\\text{explicit}}, b_{\\text{implicit}}]$，指示在各自方法的模拟过程中是否观察到任何负值。",
            "answer": "[[true,false],[true,false],[true,false],[false,false]]"
        },
        {
            "introduction": "在模拟包含多个相互作用过程（如反应与扩散）的复杂系统时，算子分裂法是一种极其强大和高效的策略，它将复杂问题分解为一系列更简单的子问题来求解。这项高级练习将指导你实现一种一阶算子分裂格式，并深入分析其核心误差来源——即反应算子与扩散算子之间的不对易性（commutativity）。通过推导和数值验证这个“对易子误差”，你将不仅学会一种高级数值技术，更将洞悉其精度和局限性的内在机理。",
            "id": "3928994",
            "problem": "考虑一个描述周期性域上扩散和反应的生化物质的一维偏微分方程 (PDE)，由下式给出：$$\\partial_t u(x,t) = D\\,\\partial_{xx} u(x,t) + f\\big(u(x,t)\\big),$$ 其中 $u(x,t)$ 是无量纲浓度场，$D$ 是无量纲扩散系数，$f(u)$ 是无量纲反应项。空间域为 $x \\in [0,L]$，具有周期性边界条件，并且本问题中的所有量均为无量纲。待实现的算子分裂格式为一阶李分裂 (Lie splitting)，其中反应和扩散子问题按指定顺序在大小为 $\\Delta t$ 的单个时间步长上演进。扩散子步骤应使用快速傅里叶变换 (FFT) 精确求解，而反应子步骤应在可能的情况下通过对常微分方程进行逐点积分来精确求解。\n\n仅使用以下经过充分检验的基本事实作为基础：菲克第二定律控制扩散，因此扩散算子为 $L(u) = D\\,\\partial_{xx}u$；反应动力学是局部的，因此反应向量场为 $N(u) = f(u)$；对于周期性域，傅里叶模态是拉普拉斯算子的特征函数，这允许在傅里叶空间中精确地推进扩散子步骤。\n\n任务：\n1. 实现两种顺序的一阶李算子分裂格式：先反应后扩散和先扩散后反应，每种都在一个时间步长 $\\Delta t$ 上进行。使用 FFT 在傅里叶空间中精确实现扩散子步骤，即每个波数为 $k$ 的傅里叶模态乘以 $\\exp\\!\\big(-D\\,k^2\\,\\Delta t\\big)$。当 $f(u)$ 是线性或逻辑斯谛函数时，使用精确解逐点实现反应子步骤。\n2. 为了分析 $\\Delta t$ 的一阶分裂误差，计算应用于相同初始条件 $u_0(x)$ 的两种李分裂顺序之间的差异，定义为 $$d(\\Delta t) = \\big(\\mathrm{Diffusion}_{\\Delta t} \\circ \\mathrm{Reaction}_{\\Delta t}\\big)u_0 - \\big(\\mathrm{Reaction}_{\\Delta t} \\circ \\mathrm{Diffusion}_{\\Delta t}\\big)u_0.$$ 这个量可以在不需要未分裂的精确演化的情况下，分离出局部误差中的主导对易子贡献。\n3. 使用基于算子原理的分析，推导当 $\\Delta t \\to 0$ 时 $d(\\Delta t)$ 的主阶表达式，并确定一维标量场的对易子的解析形式。实现这个解析主阶项，并用它来数值评估一阶分裂误差。\n\n数值规格：\n- 域长度：$L = 1$。\n- 空间网格：具有 $N_x$ 个点的均匀网格，间距为 $\\Delta x = L/N_x$。\n- 波数：使用 FFT 约定，角波数由 $k = 2\\pi\\,\\mathrm{fftfreq}(N_x,\\Delta x)$ 给出。\n- 周期性网格上的离散 $L^2$ 范数：对于网格函数 $v$，定义 $$\\|v\\|_2 = \\sqrt{\\Delta x\\,\\sum_{j=0}^{N_x-1} v_j^2}.$$\n\n测试套件和要求的输出：\n您必须处理以下三个测试案例，并产生三个标量输出，以量化一阶分裂误差的不同方面。在所有情况下，取 $L = 1$ 并报告无单位（无量纲）的结果。\n\n- 测试案例 A（基准线性反应）：\n  - 参数：$D = 0.05$，$f(u) = \\alpha\\,u$，其中 $\\alpha = 0.3$，$N_x = 1024$，$\\Delta t = 10^{-3}$。\n  - 初始条件：$u_0(x) = \\sin(2\\pi x)$。\n  - 输出：$$E_A = \\frac{\\|d(\\Delta t)\\|_2}{\\Delta t^2}.$$\n\n- 测试案例 B（光滑非线性逻辑斯谛反应）：\n  - 参数：$D = 0.02$，$f(u) = k\\,u\\,(1-u)$，其中 $k = 5$，$N_x = 1024$，$\\Delta t = 10^{-3}$。\n  - 初始条件：$u_0(x) = 0.2 + 0.1\\,\\sin(2\\pi x)$。\n  - 输出：令 $C(u_0)$ 表示您在任务 3 中推导的、在 $u_0(x)$ 处求值的解析对易子项。报告测量差异与其解析主阶近似之间的相对差异：$$E_B = \\frac{\\big\\|d(\\Delta t) - \\Delta t^2\\,C(u_0)\\big\\|_2}{\\big\\|\\Delta t^2\\,C(u_0)\\big\\|_2}.$$\n\n- 测试案例 C（逻辑斯谛反应下梯度更陡的边缘案例）：\n  - 参数：$D = 0.02$，$f(u) = k\\,u\\,(1-u)$，其中 $k = 5$，$N_x = 1024$，$\\Delta t = 10^{-3}$。\n  - 初始条件：$u_0(x) = 0.5 + 0.45\\,\\tanh\\!\\big(10\\,\\sin(6\\pi x)\\big)$。\n  - 输出：报告从 $d(\\Delta t)$ 测量的对易子系数与从 $C(u_0)$ 得到的解析系数之间的比率：$$R_C = \\frac{\\|d(\\Delta t)\\|_2/\\Delta t^2}{\\|C(u_0)\\|_2}.$$\n\n最终输出格式：\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3]”）。这三个条目必须是按顺序为测试案例 A、B 和 C 计算的浮点数 $E_A$、$E_B$ 和 $R_C$。",
            "solution": "该问题要求对一维反应扩散方程的一阶李算子分裂方法进行分析。该分析涉及数值实现和对因反应算子与扩散算子不可交换而产生的主阶误差项的理论推导。\n\n控制偏微分方程 (PDE) 为：\n$$\n\\partial_t u(x,t) = D\\,\\partial_{xx} u(x,t) + f\\big(u(x,t)\\big)\n$$\n该方程可以形式上写为 $\\partial_t u = (\\mathcal{D} + \\mathcal{R})u$，其中 $\\mathcal{D}u = D\\,\\partial_{xx}u$ 是线性扩散算子，$\\mathcal{R}(u) = f(u)$ 是非线性反应算子。\n\n待比较的两种一阶李分裂格式是：\n1.  先反应后扩散 ($S_{RD}$): 首先，在反应动力学下演进解，然后将结果在扩散动力学下演进。\n    $$u_1(x) = \\Phi_{\\mathcal{R}}^{\\Delta t}(u_0(x))$$\n    $$u_{RD}(x) = \\Phi_{\\mathcal{D}}^{\\Delta t}(u_1(x)) = (\\Phi_{\\mathcal{D}}^{\\Delta t} \\circ \\Phi_{\\mathcal{R}}^{\\Delta t})(u_0(x))$$\n2.  先扩散后反应 ($S_{DR}$): 首先，在扩散动力学下演进解，然后将结果在反应动力学下演进。\n    $$u_2(x) = \\Phi_{\\mathcal{D}}^{\\Delta t}(u_0(x))$$\n    $$u_{DR}(x) = \\Phi_{\\mathcal{R}}^{\\Delta t}(u_2(x)) = (\\Phi_{\\mathcal{R}}^{\\Delta t} \\circ \\Phi_{\\mathcal{D}}^{\\Delta t})(u_0(x))$$\n\n这里，$\\Phi_{\\mathcal{D}}^{\\Delta t}$ 和 $\\Phi_{\\mathcal{R}}^{\\Delta t}$ 分别代表扩散和反应子问题在时间步长 $\\Delta t$ 上的精确流算子。问题将这两种格式之间的差异定义为：\n$$\nd(\\Delta t) = \\big(\\mathrm{Diffusion}_{\\Delta t} \\circ \\mathrm{Reaction}_{\\Delta t}\\big)u_0 - \\big(\\mathrm{Reaction}_{\\Delta t} \\circ \\mathrm{Diffusion}_{\\Delta t}\\big)u_0\n$$\n根据复合运算的顺序，这对应于 $d(\\Delta t) = u_{RD} - u_{DR}$。\n\n### 任务3：解析对易子项的推导\n为了确定当 $\\Delta t \\to 0$ 时 $d(\\Delta t)$ 的主阶行为，我们对每种格式进行泰勒级数展开。令 $u_0 = u(x,0)$。\n\n反应步骤由常微分方程 $\\frac{du}{dt} = f(u)$ 控制。将其解在 $\\Delta t$ 中展开至二阶：\n$$\n\\Phi_{\\mathcal{R}}^{\\Delta t}(u_0) = u_0 + \\Delta t f(u_0) + \\frac{(\\Delta t)^2}{2} \\frac{d}{dt}f(u) \\bigg|_{t=0} + O\\big((\\Delta t)^3\\big)\n$$\n使用链式法则，有 $\\frac{d}{dt}f(u) = f'(u)\\frac{du}{dt} = f'(u)f(u)$。因此，\n$$\n\\Phi_{\\mathcal{R}}^{\\Delta t}(u_0) = u_0 + \\Delta t f(u_0) + \\frac{(\\Delta t)^2}{2} f'(u_0)f(u_0) + O\\big((\\Delta t)^3\\big)\n$$\n\n扩散步骤是线性的，$\\frac{du}{dt} = \\mathcal{D}u$，其流算子为 $\\Phi_{\\mathcal{D}}^{\\Delta t} = \\exp(\\Delta t \\mathcal{D})$。其级数展开为：\n$$\n\\Phi_{\\mathcal{D}}^{\\Delta t}(v) = \\big(I + \\Delta t \\mathcal{D} + \\frac{(\\Delta t)^2}{2}\\mathcal{D}^2 + \\dots\\big)v\n$$\n\n现在我们展开这两种格式：\n\n**1. 先反应后扩散 ($S_{RD}u_0 = u_{RD}$):**\n令 $u_1 = \\Phi_{\\mathcal{R}}^{\\Delta t}(u_0)$。则 $u_{RD} = \\Phi_{\\mathcal{D}}^{\\Delta t}(u_1)$。\n$$\nu_{RD} = \\big(I + \\Delta t \\mathcal{D} + \\frac{(\\Delta t)^2}{2}\\mathcal{D}^2 + \\dots\\big) \\bigg( u_0 + \\Delta t f(u_0) + \\frac{(\\Delta t)^2}{2} f'(u_0)f(u_0) + \\dots \\bigg)\n$$\n展开并保留至 $(\\Delta t)^2$ 阶的项：\n$$\nu_{RD} = u_0 + \\Delta t(\\mathcal{D}u_0 + f(u_0)) + (\\Delta t)^2 \\bigg( \\frac{1}{2}\\mathcal{D}^2 u_0 + \\mathcal{D}f(u_0) + \\frac{1}{2}f'(u_0)f(u_0) \\bigg) + O\\big((\\Delta t)^3\\big)\n$$\n\n**2. 先扩散后反应 ($S_{DR}u_0 = u_{DR}$):**\n令 $u_2 = \\Phi_{\\mathcal{D}}^{\\Delta t}(u_0) = u_0 + \\Delta t \\mathcal{D}u_0 + \\frac{(\\Delta t)^2}{2}\\mathcal{D}^2 u_0 + \\dots$。则 $u_{DR} = \\Phi_{\\mathcal{R}}^{\\Delta t}(u_2)$。\n$$\nu_{DR} = u_2 + \\Delta t f(u_2) + \\frac{(\\Delta t)^2}{2} f'(u_2)f(u_2) + O\\big((\\Delta t)^3\\big)\n$$\n我们必须将 $f(u_2)$ 和 $f'(u_2)f(u_2)$ 在 $u_0$ 周围展开。\n$f(u_2) \\approx f(u_0) + f'(u_0)(u_2 - u_0) = f(u_0) + f'(u_0)\\big(\\Delta t \\mathcal{D}u_0 + O((\\Delta t)^2)\\big)$。\n$f'(u_2)f(u_2) \\approx f'(u_0)f(u_0) + O(\\Delta t)$。\n将这些代入 $u_{DR}$ 的展开式中：\n$$\nu_{DR} \\approx \\bigg( u_0 + \\Delta t \\mathcal{D}u_0 + \\frac{(\\Delta t)^2}{2}\\mathcal{D}^2 u_0 \\bigg) + \\Delta t \\bigg( f(u_0) + \\Delta t f'(u_0)\\mathcal{D}u_0 \\bigg) + \\frac{(\\Delta t)^2}{2} f'(u_0)f(u_0) + O\\big((\\Delta t)^3\\big)\n$$\n$$\nu_{DR} = u_0 + \\Delta t(\\mathcal{D}u_0 + f(u_0)) + (\\Delta t)^2 \\bigg( \\frac{1}{2}\\mathcal{D}^2 u_0 + f'(u_0)\\mathcal{D}u_0 + \\frac{1}{2}f'(u_0)f(u_0) \\bigg) + O\\big((\\Delta t)^3\\big)\n$$\n\n**差异与对易子：**\n将两个表达式相减，我们发现 1 阶和 $\\Delta t$ 阶的项相互抵消，$\\frac{1}{2}\\mathcal{D}^2 u_0$ 和 $\\frac{1}{2}f'(u_0)f(u_0)$ 项也同样抵消。\n$$\nd(\\Delta t) = u_{RD} - u_{DR} = (\\Delta t)^2 \\big( \\mathcal{D}f(u_0) - f'(u_0)\\mathcal{D}u_0 \\big) + O\\big((\\Delta t)^3\\big)\n$$\n问题要求找到解析对易子项 $C(u_0)$，使得 $d(\\Delta t) \\approx (\\Delta t)^2 C(u_0)$。因此，\n$$\nC(u_0) = \\mathcal{D}f(u_0) - f'(u_0)\\mathcal{D}u_0\n$$\n让我们找出 $C(u_0)$ 的显式形式。当 $\\mathcal{D} = D\\partial_{xx}$ 时：\n$$\nC(u_0) = D\\,\\partial_{xx}\\big(f(u_0)\\big) - f'(u_0)\\big(D\\,\\partial_{xx}u_0\\big)\n$$\n对第一项使用链式法则：$\\partial_x f(u_0) = f'(u_0)\\partial_x u_0$。\n$$\n\\partial_{xx}f(u_0) = \\partial_x \\big(f'(u_0)\\partial_x u_0\\big) = f''(u_0)(\\partial_x u_0)^2 + f'(u_0)\\partial_{xx} u_0\n$$\n将此代入 $C(u_0)$ 的表达式中：\n$$\nC(u_0) = D\\big[ f''(u_0)(\\partial_x u_0)^2 + f'(u_0)\\partial_{xx} u_0 \\big] - D\\,f'(u_0)\\partial_{xx}u_0\n$$\n包含 $\\partial_{xx}u_0$ 的项相互抵消，得到对易子项的最终紧凑表达式：\n$$\nC(u_0) = D\\,f''(u_0)\\,(\\partial_x u_0)^2\n$$\n\n### 任务1和2：数值实现\n实现过程如下：\n1.  **空间离散化**：在域 $[0, L]$ 上使用包含 $N_x$ 个点的均匀网格，间距为 $\\Delta x = L/N_x$。空间坐标为 $x_j = j \\Delta x$，其中 $j=0, \\dots, N_x-1$。\n2.  **扩散子步骤**：扩散方程 $\\partial_t u = D\\partial_{xx}u$ 在傅里叶空间中求解。初始状态 $u(x,0)$ 使用快速傅里叶变换 (FFT) 进行转换。然后，每个傅里叶模态 $\\hat{u}(k)$ 通过乘以因子 $\\exp(-D k^2 \\Delta t)$ 进行精确演化，其中 $k$ 是角波数。结果通过逆 FFT 转换回实空间。波数由 $k = 2\\pi\\,\\mathrm{fftfreq}(N_x, \\Delta x)$ 给出。\n3.  **反应子步骤**：常微分方程 $\\frac{du}{dt} = f(u)$ 在每个网格点上逐点求解。问题要求使用精确解。\n    -   对于线性反应 $f(u) = \\alpha u$，解为 $u(\\Delta t) = u(0)e^{\\alpha \\Delta t}$。\n    -   对于逻辑斯谛反应 $f(u) = k u(1-u)$，解为 $u(\\Delta t) = \\frac{u(0)e^{k\\Delta t}}{1 - u(0) + u(0)e^{k\\Delta t}}$。\n4.  **对易子计算**：解析项 $C(u_0) = D\\,f''(u_0)\\,(\\partial_x u_0)^2$ 进行数值计算。导数 $\\partial_x u_0$ 通过谱方法计算，即 $\\partial_x u_0 = \\mathrm{IFFT}\\big(i k \\cdot \\mathrm{FFT}(u_0)\\big)$，以与扩散求解器保持一致。反应项的二阶导数 $f''(u_0)$ 逐点计算。\n5.  **范数计算**：使用指定的离散 $L^2$ 范数 $\\|v\\|_2 = \\sqrt{\\Delta x \\sum_{j=0}^{N_x-1} v_j^2}$ 来计算每个测试案例所需的标量输出。\n\n### 测试案例分析\n-   **案例A（线性反应）**：$f(u) = \\alpha u$。此处，$f'(u) = \\alpha$ 且 $f''(u) = 0$。因此，解析对易子项为 $C(u_0) = 0$。这意味着扩散和反应算子是可交换的。两种分裂格式 $S_{RD}$ 和 $S_{DR}$ 应产生在浮点精度内相同的结果，使得 $d(\\Delta t)$ 小到可以忽略不计。输出 $E_A = \\|d(\\Delta t)\\|_2/\\Delta t^2$ 预计将接近于零。\n-   **案例B（非线性反应）**：对于逻辑斯谛反应 $f(u) = ku(1-u)$，我们有 $f''(u) = -2k$。对易子项非零：$C(u_0) = -2kD(\\partial_x u_0)^2$。输出 $E_B$ 衡量了数值计算出的差异 $d(\\Delta t)$ 与其主阶近似 $(\\Delta t)^2 C(u_0)$ 之间的相对误差。由于 $d(\\Delta t) = (\\Delta t)^2 C(u_0) + O((\\Delta t)^3)$，对于给定的 $\\Delta t=10^{-3}$，该比率应为 $O(\\Delta t)$ 阶，因此应该很小。\n-   **案例C（陡峭梯度）**：此案例使用相同的非线性反应，但初始条件更复杂，具有更陡峭的空间特征。这测试了主阶近似的鲁棒性。输出 $R_C$ 是“测量”的对易子系数的范数 $\\|d(\\Delta t)\\|_2/\\Delta t^2$ 与解析对易子系数的范数 $\\|C(u_0)\\|_2$ 之间的比率。接近 1 的值表明，即使对于具有挑战性的初始数据，解析公式也能准确预测分裂差异的大小。",
            "answer": "[0.00000000,0.00062867,0.99999966]"
        }
    ]
}