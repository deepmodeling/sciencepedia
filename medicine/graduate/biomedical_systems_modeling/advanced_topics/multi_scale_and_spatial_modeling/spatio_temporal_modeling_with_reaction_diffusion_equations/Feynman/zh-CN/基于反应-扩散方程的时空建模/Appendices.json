{
    "hands_on_practices": [
        {
            "introduction": "这项练习旨在连接抽象的扩散方程及其实际物理表现。您将从偏微分方程（PDE）出发，直接推导均方位移（mean-squared displacement），这是衡量随机运动的关键统计量。然后，您将把这一理解应用于一种常见的生物物理技术——光漂白后荧光恢复（FRAP），了解如何在实验室中测量扩散系数。",
            "id": "3928991",
            "problem": "考虑一个均匀各向同性的介质，其中一个荧光标记的生物分子进行扩散，其扩散系数 $D$ 为常数。$n$ 维空间中的浓度场 $c(x,t)$ 在无穷域上遵循菲克第二定律（热方程）$\\partial c / \\partial t = D \\nabla^{2} c$ 进行演化，其物理上允许的初始条件为点源 $c(x,0) = \\delta(x)$，且在无穷远处通量为零。\n\nA部分：从这些基本原理出发，推导扩散分子的均方位移 $\\langle |x|^{2} \\rangle(t)$ 作为时间 $t$ 和空间维度 $n$ 的函数。您的推导必须从控制方程和适当的初始条件开始，通过求得基本解并计算 $\\langle |x|^{2} \\rangle(t) = \\int_{\\mathbb{R}^{n}} |x|^{2} G(x,t) \\,\\mathrm{d}x$ 来进行，其中 $G(x,t)$ 是热方程的格林函数。\n\nB部分：在二维光漂白后荧光恢复 (FRAP) 实验中，假设在时间 $t=0$ 时，一个半径为 $r_{0}$ 的圆盘区域被瞬时、完全漂白，其漂白前的归一化浓度为：当 $|x|  r_0$ 时，$c(x,0)=0$；当 $|x| \\ge r_0$ 时，$c(x,0)=1$。在仅考虑扩散的相同假设下，推导中心点浓度恢复的解析表达式 $c(0,t)$，并根据漂白半径 $r_{0}$ 和由 $c(0,t_{1/2}) = \\tfrac{1}{2}$ 定义的半恢复时间 $t_{1/2}$，得到扩散系数 $D$ 的闭式表达式。\n\n数值计算：使用您推导的表达式，计算当 $r_{0} = 10\\,\\mu\\mathrm{m}$ 和 $t_{1/2} = 4.00\\,\\mathrm{s}$ 时的扩散系数。将最终数值答案四舍五入至四位有效数字。最终的扩散系数以 $\\mu\\mathrm{m}^{2}/\\mathrm{s}$ 为单位表示。",
            "solution": "用户提供了一个关于扩散的多部分问题，我已验证其科学上合理、问题明确，并包含得出唯一解所需的所有信息。我将进行完整的推导。\n\n问题分为两部分。A部分要求推导从点源扩散的粒子的均方位移 (MSD)。B部分将扩散理论应用于光漂白后荧光恢复 (FRAP) 实验以确定扩散系数。\n\n**A部分：均方位移的推导**\n\n浓度场 $c(x,t)$ 的演化由 $n$ 维空间中的菲克第二定律决定：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^{2} c\n$$\n问题指定了对应于原点处点源的初始条件，由狄拉克δ函数表示：$c(x,0) = \\delta(x)$。带有此初始条件的偏微分方程的解是格林函数，或称基本解，$G(x,t)$。\n\n首先，我们通过对空间变量 $x$ 应用傅里叶变换来求 $G(x,t)$。令 $\\hat{c}(k,t) = \\mathcal{F}[c(x,t)] = \\int_{\\mathbb{R}^n} c(x,t) \\exp(-i k \\cdot x) d^n x$。该偏微分方程变换为一个关于时间的常微分方程：\n$$\n\\frac{d\\hat{c}}{dt} = -D|k|^2 \\hat{c}(k,t)\n$$\n初始条件的傅里叶变换为 $\\hat{c}(k,0) = \\mathcal{F}[\\delta(x)] = 1$。此常微分方程的解为：\n$$\n\\hat{c}(k,t) = \\exp(-D|k|^2 t)\n$$\n这是傅里叶空间中的格林函数，$\\hat{G}(k,t)$。为了求得 $G(x,t)$，我们进行傅里叶逆变换：\n$$\nG(x,t) = \\mathcal{F}^{-1}[\\hat{G}(k,t)] = \\frac{1}{(2\\pi)^n} \\int_{\\mathbb{R}^n} \\exp(-D|k|^2 t) \\exp(i k \\cdot x) d^n k\n$$\n该积分为 $n$ 个一维高斯积分的乘积：\n$$\nG(x,t) = \\frac{1}{(2\\pi)^n} \\prod_{j=1}^{n} \\int_{-\\infty}^{\\infty} \\exp(-D t k_j^2 + i k_j x_j) dk_j\n$$\n使用标准高斯积分恒等式 $\\int_{-\\infty}^{\\infty} \\exp(-a z^2 + bz) dz = \\sqrt{\\frac{\\pi}{a}} \\exp(\\frac{b^2}{4a})$，其中 $a = Dt$ 且 $b = ix_j$：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-D t k_j^2 + i k_j x_j) dk_j = \\sqrt{\\frac{\\pi}{Dt}} \\exp\\left(\\frac{(ix_j)^2}{4Dt}\\right) = \\sqrt{\\frac{\\pi}{Dt}} \\exp\\left(-\\frac{x_j^2}{4Dt}\\right)\n$$\n将此结果代回 $G(x,t)$ 的表达式中：\n$$\nG(x,t) = \\frac{1}{(2\\pi)^n} \\left(\\frac{\\pi}{Dt}\\right)^{n/2} \\exp\\left(-\\frac{\\sum_{j=1}^n x_j^2}{4Dt}\\right) = \\frac{1}{(4\\pi Dt)^{n/2}} \\exp\\left(-\\frac{|x|^2}{4Dt}\\right)\n$$\n这就是 $n$ 维扩散方程的基本解。\n\n接下来，我们按照问题的要求计算均方位移 $\\langle |x|^2 \\rangle(t)$：\n$$\n\\langle |x|^2 \\rangle(t) = \\int_{\\mathbb{R}^n} |x|^2 G(x,t) d^n x = \\frac{1}{(4\\pi Dt)^{n/2}} \\int_{\\mathbb{R}^n} |x|^2 \\exp\\left(-\\frac{|x|^2}{4Dt}\\right) d^n x\n$$\n为计算此积分，我们转换到超球坐标系。令 $r = |x|$。体积元为 $d^n x = r^{n-1} dr d\\Omega_{n-1}$，其中 $d\\Omega_{n-1}$ 是单位 $(n-1)$ 球面的面元。对 $d\\Omega_{n-1}$ 的积分得到总立体角，即 $(n-1)$ 球面的表面积 $S_{n-1} = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}$，其中 $\\Gamma$ 是伽马函数。\n$$\n\\langle |x|^2 \\rangle(t) = \\frac{S_{n-1}}{(4\\pi Dt)^{n/2}} \\int_0^\\infty r^2 \\cdot r^{n-1} \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)(4\\pi Dt)^{n/2}} \\int_0^\\infty r^{n+1} \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr\n$$\n剩下的积分是标准形式，可以使用恒等式 $\\int_0^\\infty z^m \\exp(-az^2) dz = \\frac{\\Gamma((m+1)/2)}{2a^{(m+1)/2}}$ 求解。这里，$m=n+1$ 且 $a = \\frac{1}{4Dt}$。\n$$\n\\int_0^\\infty r^{n+1} \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr = \\frac{\\Gamma((n+2)/2)}{2(1/(4Dt))^{(n+2)/2}} = \\frac{\\Gamma(n/2 + 1)}{2} (4Dt)^{n/2+1}\n$$\n利用性质 $\\Gamma(z+1)=z\\Gamma(z)$，我们有 $\\Gamma(n/2+1) = \\frac{n}{2}\\Gamma(n/2)$。\n$$\n\\text{Integral} = \\frac{(n/2)\\Gamma(n/2)}{2} (4Dt)^{n/2} (4Dt) = \\frac{n}{4} \\Gamma(n/2) (4Dt)^{n/2} (4Dt)\n$$\n将此结果代回 $\\langle |x|^2 \\rangle(t)$ 的表达式中：\n$$\n\\langle |x|^2 \\rangle(t) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)(4\\pi Dt)^{n/2}} \\left[ \\frac{n}{4} \\Gamma(n/2) (4Dt)^{n/2} (4Dt) \\right]\n$$\n我们消去项：$\\Gamma(n/2)$ 和 $(4Dt)^{n/2}$。注意 $(4\\pi Dt)^{n/2} = 4^{n/2}\\pi^{n/2}(Dt)^{n/2}$。\n$$\n\\langle |x|^2 \\rangle(t) = \\frac{2\\pi^{n/2}}{4^{n/2}\\pi^{n/2}(Dt)^{n/2}} \\left[ \\frac{n}{4} (4Dt)^{n/2} (4Dt) \\right] = \\frac{2}{4^{n/2}} \\frac{n}{4} 4^{n/2} (4Dt) = \\frac{n}{2} (4Dt)\n$$\n$$\n\\langle |x|^2 \\rangle(t) = 2nDt\n$$\n这就是著名的关于点源扩散的爱因斯坦关系式。\n\n**B部分：FRAP分析与D的计算**\n\n问题的这一部分考虑一个二维系统 ($n=2$)。初始条件是一个均匀的圆形漂白斑：当 $|x|  r_0$ 时 $c(x,0) = 0$，当 $|x| \\ge r_0$ 时 $c(x,0) = 1$。我们需要求出漂白斑中心的浓度 $c(0,t)$。\n\n解由初始条件与二维格林函数的卷积给出：\n$$\nc(x,t) = \\int_{\\mathbb{R}^2} G(x-x', t) c(x', 0) d^2 x'\n$$\n对于 $n=2$，格林函数为 $G(x,t) = \\frac{1}{4\\pi Dt} \\exp\\left(-\\frac{|x|^2}{4Dt}\\right)$。\n我们计算中心点 $x=0$ 处的浓度：\n$$\nc(0,t) = \\int_{\\mathbb{R}^2} G(-x', t) c(x', 0) d^2 x' = \\int_{\\mathbb{R}^2} \\frac{1}{4\\pi Dt} \\exp\\left(-\\frac{|x'|^2}{4Dt}\\right) c(x', 0) d^2 x'\n$$\n由于只有在 $|x'| \\ge r_0$ 时 $c(x',0)$ 才非零，积分被限制在该定义域上：\n$$\nc(0,t) = \\frac{1}{4\\pi Dt} \\int_{|x'| \\ge r_0} \\exp\\left(-\\frac{|x'|^2}{4Dt}\\right) d^2 x'\n$$\n我们转换到极坐标系 $(r,\\theta)$，其中 $r = |x'|$。面积元为 $d^2 x' = rdrd\\theta$。\n$$\nc(0,t) = \\frac{1}{4\\pi Dt} \\int_0^{2\\pi} d\\theta \\int_{r_0}^\\infty r \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr = \\frac{2\\pi}{4\\pi Dt} \\int_{r_0}^\\infty r \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr\n$$\n$$\nc(0,t) = \\frac{1}{2Dt} \\int_{r_0}^\\infty r \\exp\\left(-\\frac{r^2}{4Dt}\\right) dr\n$$\n为了解此积分，我们使用换元法，令 $u = \\frac{r^2}{4Dt}$，因此 $du = \\frac{2rdr}{4Dt} = \\frac{rdr}{2Dt}$。积分上下限变为 $u_{lower} = \\frac{r_0^2}{4Dt}$ 和 $u_{upper} = \\infty$。\n$$\nc(0,t) = \\int_{r_0^2/(4Dt)}^\\infty \\exp(-u) du = [-\\exp(-u)]_{r_0^2/(4Dt)}^\\infty = 0 - \\left(-\\exp\\left(-\\frac{r_0^2}{4Dt}\\right)\\right)\n$$\n$$\nc(0,t) = \\exp\\left(-\\frac{r_0^2}{4Dt}\\right)\n$$\n这就是中心浓度恢复的表达式。\n\n接下来，我们使用半恢复时间 $t_{1/2}$ 的定义，即 $c(0, t_{1/2}) = \\frac{1}{2}$ 时的时间。\n$$\n\\frac{1}{2} = \\exp\\left(-\\frac{r_0^2}{4Dt_{1/2}}\\right)\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) = -\\frac{r_0^2}{4Dt_{1/2}}\n$$\n$$\n\\ln(2) = \\frac{r_0^2}{4Dt_{1/2}}\n$$\n求解扩散系数 $D$：\n$$\nD = \\frac{r_0^2}{4 t_{1/2} \\ln(2)}\n$$\n\n**数值计算**\n\n给定 $r_0 = 10\\,\\mu\\mathrm{m}$ 和 $t_{1/2} = 4.00\\,\\mathrm{s}$。\n将这些值代入 $D$ 的表达式中：\n$$\nD = \\frac{(10\\,\\mu\\mathrm{m})^2}{4 \\cdot (4.00\\,\\mathrm{s}) \\cdot \\ln(2)} = \\frac{100\\,\\mu\\mathrm{m}^2}{16.00\\,\\mathrm{s} \\cdot \\ln(2)}\n$$\n使用数值 $\\ln(2) \\approx 0.693147...$：\n$$\nD = \\frac{100}{16.00 \\times 0.693147...} \\frac{\\mu\\mathrm{m}^2}{\\mathrm{s}} \\approx \\frac{100}{11.09035...} \\frac{\\mu\\mathrm{m}^2}{\\mathrm{s}} \\approx 9.01684... \\frac{\\mu\\mathrm{m}^2}{\\mathrm{s}}\n$$\n按照要求，将结果四舍五入至四位有效数字：\n$$\nD \\approx 9.017\\,\\mu\\mathrm{m}^2/\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{9.017 \\times 10^0}\n$$"
        },
        {
            "introduction": "与无限空间中的扩散不同，大多数生物过程发生在细胞或组织等有限环境中。本练习将探讨不通透边界如何影响扩散分子的行为。通过在有限的正方形区域内求解扩散方程，您将发现空间模态及其特征衰减率的概念，这对于理解模式形成至关重要。",
            "id": "3929096",
            "problem": "一个信号分子被均匀地释放到一个边长为 $L$ 的薄方形组织切片中，随后进行被动扩散，无反应也无外部源。由于周围有屏障，组织边界是不可渗透的，因此跨越边界的净通量为零。浓度场 $c(x,y,t)$ 遵循质量守恒和菲克定律，两者共同得出了偏微分方程 (PDE) $ \\partial c/\\partial t = D \\nabla^2 c $，其中 $ (x,y) \\in (0,L) \\times (0,L) $ 且 $ t > 0 $，$D$ 是扩散系数。边界条件是方形区域的每条边上的法向通量为零。\n\n从质量守恒和菲克定律出发，使用分离变量法来构建并求解在方形域上具有零通量边界的空间特征值问题。然后将空间特征值与扩散模式的时间衰减率联系起来。确定浓度扰动的最慢非零时间衰减率（即所有非恒定模式中的最小正衰减率），并以 $D$ 和 $L$ 的解析表达式表示。\n\n以 $ \\mathrm{s}^{-1} $ 为单位表示你的最终答案。如果得到符号表达式，请勿四舍五入。",
            "solution": "该问题的分析始于质量输运的基本原理。对于一个浓度为 $c(\\mathbf{r}, t)$ 的物种，在由表面 $\\partial V$ 包围的任意控制体积 $V$ 内，其质量守恒的积分形式表示为：\n$$\n\\frac{d}{dt} \\int_V c \\, dV = - \\oint_{\\partial V} \\mathbf{J} \\cdot \\mathbf{\\hat{n}} \\, dA\n$$\n其中 $\\mathbf{J}$ 是质量通量矢量，$\\mathbf{\\hat{n}}$ 是表面元 $dA$ 的外向单位法向量。通过对面积分应用散度定理 $\\oint_{\\partial V} \\mathbf{J} \\cdot \\mathbf{\\hat{n}} \\, dA = \\int_V (\\nabla \\cdot \\mathbf{J}) \\, dV$，并将时间导数移到体积分内部，我们得到：\n$$\n\\int_V \\frac{\\partial c}{\\partial t} \\, dV = - \\int_V (\\nabla \\cdot \\mathbf{J}) \\, dV\n$$\n由于此关系必须对任意控制体积 $V$ 成立，因此被积函数必须相等，从而得到连续性方程的微分形式：\n$$\n\\frac{\\partial c}{\\partial t} = - \\nabla \\cdot \\mathbf{J}\n$$\n问题陈述分子进行被动扩散，这由菲克第一定律描述。该定律假设通量与浓度梯度的负值成正比：\n$$\n\\mathbf{J} = -D \\nabla c\n$$\n其中 $D$ 是扩散系数，假定为一个常数标量。将菲克定律代入连续性方程，得到：\n$$\n\\frac{\\partial c}{\\partial t} = - \\nabla \\cdot (-D \\nabla c) = \\nabla \\cdot (D \\nabla c)\n$$\n由于 $D$ 是常数，它可以从散度算子中提出，得到扩散方程，如问题陈述中所给出的：\n$$\n\\frac{\\partial c}{\\partial t} = D \\nabla^2 c\n$$\n区域是一个方形 $(x,y) \\in [0,L] \\times [0,L]$。边界条件指明边界是不可渗透的，意味着没有净通量穿过它们。这表示为在所有边界上 $\\mathbf{J} \\cdot \\mathbf{\\hat{n}} = 0$。使用 $\\mathbf{J} = -D \\nabla c$，这变为 $-D (\\nabla c \\cdot \\mathbf{\\hat{n}}) = 0$。由于 $D \\ne 0$，该条件等价于浓度的法向导数为零，即 $\\frac{\\partial c}{\\partial n} = \\nabla c \\cdot \\mathbf{\\hat{n}} = 0$。对于方形域，这产生了以下四个诺伊曼边界条件：\n1. 在 $x=0$ 处：$\\frac{\\partial c}{\\partial x}(0, y, t) = 0$ 对于 $y \\in (0,L)$\n2. 在 $x=L$ 处：$\\frac{\\partial c}{\\partial x}(L, y, t) = 0$ 对于 $y \\in (0,L)$\n3. 在 $y=0$ 处：$\\frac{\\partial c}{\\partial y}(x, 0, t) = 0$ 对于 $x \\in (0,L)$\n4. 在 $y=L$ 处：$\\frac{\\partial c}{\\partial y}(x, L, t) = 0$ 对于 $x \\in (0,L)$\n\n为求解该偏微分方程，我们采用分离变量法。我们寻求形式为 $c(x,y,t) = S(x,y)T(t)$ 的解。将其代入扩散方程得到：\n$$\nS(x,y) \\frac{dT(t)}{dt} = D T(t) \\nabla^2 S(x,y)\n$$\n两边同除以 $D S(x,y)T(t)$，分离变量：\n$$\n\\frac{1}{D T(t)} \\frac{dT(t)}{dt} = \\frac{\\nabla^2 S(x,y)}{S(x,y)}\n$$\n左边仅是 $t$ 的函数，而右边仅是 $x$ 和 $y$ 的函数。要使它们对所有 $(x,y,t)$ 都相等，它们必须都等于一个常数。我们把这个分离常数记为 $-\\lambda$。这产生了两个常微分方程：\n时间方程：$\\frac{dT}{dt} = -\\lambda D T$\n空间方程：$\\nabla^2 S + \\lambda S = 0$（亥姆霍兹方程）\n\n时间方程的解为 $T(t) = T(0) \\exp(-\\lambda D t)$。项 $\\gamma = \\lambda D$ 是给定模式的时间衰减率。对于一个封闭系统中浓度不会无限增长的物理现实解，我们期望 $\\lambda \\ge 0$。\n\n空间部分是一个二维特征值问题。我们在方形域上用相应的诺伊曼边界条件求解 $S(x,y)$ 的亥姆霍兹方程：\n$\\frac{\\partial S}{\\partial x}(0,y) = 0$，$\\frac{\\partial S}{\\partial x}(L,y) = 0$，$\\frac{\\partial S}{\\partial y}(x,0) = 0$，$\\frac{\\partial S}{\\partial y}(x,L) = 0$。\n我们再次对空间函数应用分离变量法，设 $S(x,y) = X(x)Y(y)$。代入亥姆霍兹方程：\n$$\nY(y)\\frac{d^2X(x)}{dx^2} + X(x)\\frac{d^2Y(y)}{dy^2} + \\lambda X(x)Y(y) = 0\n$$\n两边同除以 $X(x)Y(y)$ 得到：\n$$\n\\frac{1}{X(x)}\\frac{d^2X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2Y}{dy^2} + \\lambda = 0\n$$\n我们可以将其重新排列为 $\\frac{1}{X}\\frac{d^2X}{dx^2} = -\\lambda - \\frac{1}{Y}\\frac{d^2Y}{dy^2}$。左边只依赖于 $x$，右边只依赖于 $y$。因此，两边都必须等于一个常数，我们将其记为 $-k_x^2$。这给出了两个一维特征值问题：\n1. $\\frac{d^2X}{dx^2} + k_x^2 X = 0$，边界条件为 $X'(0)=0$ 和 $X'(L)=0$。\n2. $\\frac{d^2Y}{dy^2} + k_y^2 Y = 0$，边界条件为 $Y'(0)=0$ 和 $Y'(L)=0$，其中 $k_y^2 = \\lambda - k_x^2$。\n\n让我们求解 $X(x)$。$X'' + k_x^2 X = 0$ 的通解是 $X(x) = A \\cos(k_x x) + B \\sin(k_x x)$。其导数为 $X'(x) = -A k_x \\sin(k_x x) + B k_x \\cos(k_x x)$。\n应用在 $x=0$ 处的边界条件：$X'(0) = B k_x = 0$。如果 $k_x \\neq 0$，则 $B=0$。\n解变为 $X(x) = A \\cos(k_x x)$。应用在 $x=L$ 处的边界条件：$X'(L) = -A k_x \\sin(k_x L) = 0$。对于非平凡解（$A \\ne 0, k_x \\ne 0$），我们必须有 $\\sin(k_x L) = 0$。这意味着 $k_x L = n\\pi$，其中 $n \\in \\{1, 2, 3, \\dots\\}$。因此，$k_x = \\frac{n\\pi}{L}$。\n我们还必须考虑 $k_x=0$ 的情况。方程变为 $X''=0$，解为 $X(x) = C_1 x + C_2$。边界条件 $X'(0)=0$ 和 $X'(L)=0$ 都得出 $C_1=0$。因此 $X(x) = C_2$（一个常数）是一个有效的特征函数。这种情况对应于公式 $k_x = \\frac{n\\pi}{L}$ 中的 $n=0$。因此，特征函数为 $X_n(x) = \\cos(\\frac{n\\pi x}{L})$，其中 $n \\in \\{0, 1, 2, \\dots\\}$。\n\n$Y(y)$ 的问题形式上是相同的。特征函数为 $Y_m(y) = \\cos(\\frac{m\\pi y}{L})$，相应的特征值为 $k_y^2 = (\\frac{m\\pi}{L})^2$，其中 $m \\in \\{0, 1, 2, \\dots\\}$。\n\n空间特征值 $\\lambda$ 由和 $\\lambda_{nm} = k_x^2 + k_y^2$ 给出：\n$$\n\\lambda_{nm} = \\left(\\frac{n\\pi}{L}\\right)^2 + \\left(\\frac{m\\pi}{L}\\right)^2 = \\frac{\\pi^2}{L^2}(n^2 + m^2)\n$$\n其中 $n$ 和 $m$ 是非负整数。每一对 $(n,m)$ 定义了一个空间模式 $S_{nm}(x,y) = \\cos(\\frac{n\\pi x}{L})\\cos(\\frac{m\\pi y}{L})$，其对应的时间衰减率为 $\\gamma_{nm} = D \\lambda_{nm} = \\frac{D\\pi^2}{L^2}(n^2+m^2)$。\n\n问题要求的是扰动的最慢非零时间衰减率。“扰动”一词指的是与平均浓度的任何非恒定空间变化。\n让我们分析一下衰减率：\n模式 $(n,m) = (0,0)$ 给出 $\\lambda_{00} = 0$ 和衰减率 $\\gamma_{00}=0$。相应的特征函数 $S_{00}(x,y)=1$ 代表空间上均匀的浓度。这是直流分量或稳态平均浓度，在一个封闭系统中随时间守恒，因此不会衰减。\n任何偏离这种均匀状态的情况都是 $(n,m) \\neq (0,0)$ 模式的叠加。这些是“非恒定模式”或扰动。我们需要找到 $\\gamma_{nm}$ 的最小正值。这等同于找到非负整数 $n,m$（不全为零）的 $n^2+m^2$ 的最小值。\n对于整数 $n, m \\ge 0$ 的可能值：\n- 如果 $(n,m) = (0,0)$，则 $n^2+m^2=0$。这给出 $\\gamma_{00}=0$。\n- 如果一个索引是 $1$ 而另一个是 $0$，例如 $(n,m)=(1,0)$ 或 $(0,1)$，则 $n^2+m^2 = 1^2+0^2 = 1$。\n- 如果 $(n,m) = (1,1)$，则 $n^2+m^2=1^2+1^2=2$。\n- 如果一个索引是 $2$ 而另一个是 $0$，例如 $(n,m)=(2,0)$ 或 $(0,2)$，则 $n^2+m^2=2^2+0^2=4$。\n\n$n^2+m^2$ 的最小非零值为 $1$。这发生在模式 $(n,m)=(1,0)$ 和 $(n,m)=(0,1)$ 时。这些是基本的衰减模式。\n因此，最慢的非零时间衰减率是：\n$$\n\\gamma_{\\text{min, non-zero}} = \\frac{D\\pi^2}{L^2}(1) = \\frac{D\\pi^2}{L^2}\n$$\n这个速率对应于在域内能容纳的最长波长扰动的衰减，具体来说是 $\\cos(\\pi x/L)$ 和 $\\cos(\\pi y/L)$。",
            "answer": "$$\\boxed{\\frac{D\\pi^{2}}{L^{2}}}$$"
        },
        {
            "introduction": "虽然解析解具有深刻的洞察力，但大多数现实世界中的反应-扩散问题都需要数值方法。这项练习深入探讨了模拟的一个关键方面：确保数值解遵守基本的物理约束，例如浓度的非负性。您将比较一种简单的显式方法和一种更稳健的隐式方法，学习有关数值稳定性以及如何设计物理上合理的计算格式。",
            "id": "3929058",
            "problem": "考虑一个一维反应扩散模型，用于描述一个非负生化浓度场 $u(x,t)$，该场由以下偏微分方程控制\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - k u\n$$\n在空间区间 $x \\in [0,L]$ 上，具有零通量（Neumann）边界条件和非负初始条件。这里，$D \\ge 0$ 是扩散系数，$k \\ge 0$ 是一阶反应衰变率。在抛物型偏微分方程中，一个经过充分检验的事实是，连续问题保持非负性：如果 $u(x,0) \\ge 0$ 且边界条件为零通量，则对于所有 $t \\ge 0$，都有 $u(x,t) \\ge 0$。\n\n您的任务是，在一个间距为 $h = L/(N-1)$ 的均匀网格上，推导、实现和测试两种时间步进离散化方法：\n- 一种朴素的显式方法（时间上采用前向欧拉法，空间上采用中心差分法）。\n- 一种保正性方法（时间上采用后向欧拉法，空间上采用相同的中心差分算子）。\n\n从菲克定律和质量守恒出发，推导出显式方法在何种条件下会违反非负性，并解释为何隐式方法对于任意时间步长都能保持非负性。使用镜像虚点在 $x=0$ 和 $x=L$ 处的有限差分离散化中施加零通量边界条件。\n\n实现要求：\n- 使用一个包含 $N$ 个点的均匀网格，并在二阶空间导数的离散化中通过镜像反射来施加零通量边界。\n- 将 $u(x,0)$ 初始化为一个非负的光滑凸起：\n$$\nu(x,0) = \\exp\\!\\left(-\\frac{(x - L/2)^2}{2 \\sigma^2}\\right),\n$$\n其中 $\\sigma = 0.1L$。\n- 对于每个时间步，检测是否有任何网格值变为负数（严格小于 $-10^{-12}$ 的容差即视为负数）。\n- 对于隐式方法，在每一步都使用稀疏直接求解器精确求解线性系统。\n\n测试套件：\n为以下四组参数集实现模拟。对于每种情况，使用如下所述的指定时间步长 $\\Delta t$ 在总时间 $T$ 内进行模拟。所有情况均使用 $L=1$ 和 $N=101$。\n\n1. 情况 A（扩散和反应，预计显式方法不稳定）：\n   - $D = 1.0$, $k = 0.5$, $T = 0.01$, $\\Delta t = 0.001$。\n\n2. 情况 B（纯扩散，预计显式方法不稳定）：\n   - $D = 0.1$, $k = 0.0$, $T = 0.05$, $\\Delta t = 0.005$。\n\n3. 情况 C（纯反应衰变，当 $\\Delta t > 1/k$ 时预计显式方法不稳定）：\n   - $D = 0.0$, $k = 5.0$, $T = 1.0$, $\\Delta t = 0.5$。\n\n4. 情况 D（显式方法处于保正性边界条件下）：\n   - $D = 1.0$, $k = 0.0$, $T = 0.001$，$\\Delta t$ 精确选择在显式保正性阈值处\n   $$\n   \\Delta t = \\frac{1}{\\frac{2D}{h^2} + k}.\n   $$\n\n输出规范：\n- 对于四种情况中的每一种，运行两种方法并报告一对布尔值 $[b_{\\text{explicit}}, b_{\\text{implicit}}]$，其中每个布尔值为真当且仅当该方法的时间积分过程中出现了任何负值（使用严格阈值 $-10^{-12}$）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。因此，输出必须是一个包含四个双元素列表的列表，每个测试用例一个，例如\n$$\n\\texttt{[[true,false],[true,false],[true,false],[false,false]]}.\n$$\n输出中不需要物理单位，因为报告的值是布尔值。确保您的实现是科学上真实且数值上自洽的，并且除了从控制方程和边界条件推导出的公式外，不要使用任何快捷公式。",
            "solution": "控制偏微分方程为\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} - k u,\n$$\n其中 $D \\ge 0$，$k \\ge 0$，且零通量边界条件为 $\\frac{\\partial u}{\\partial x}(0,t) = 0$ 和 $\\frac{\\partial u}{\\partial x}(L,t) = 0$。对于非负初始数据 $u(x,0) \\ge 0$，抛物型方程的极值原理表明，连续解在所有 $t \\ge 0$ 时都保持 $u(x,t) \\ge 0$。\n\n我们在均匀网格 $x_i = i h$ 上对空间进行离散化，其中 $h = L/(N-1)$，索引为 $i = 0,1,\\dots,N-1$。二阶导数由中心差分算子近似\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2},\n$$\n并使用镜像虚点来施加零通量边界。对于 $i=0$，镜像法强制 $u_{-1} = u_1$，因此\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_0 \\approx \\frac{u_{1} - 2 u_0 + u_{-1}}{h^2} = \\frac{2 u_1 - 2 u_0}{h^2}.\n$$\n类似地，对于 $i=N-1$，镜像法给出 $u_{N} = u_{N-2}$，\n$$\n\\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{N-1} \\approx \\frac{2 u_{N-2} - 2 u_{N-1}}{h^2}.\n$$\n\n显式方法（时间上采用前向欧拉法）：\n根据第一性原理，前向欧拉法应用以下时间更新\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left( D \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i^n - k u_i^n \\right),\n$$\n对于内部节点，这得到\n$$\nu_i^{n+1} = u_i^n + \\Delta t \\left( D \\frac{u_{i+1}^n - 2 u_i^n + u_{i-1}^n}{h^2} - k u_i^n \\right).\n$$\n定义无量纲参数 $r = \\frac{D \\Delta t}{h^2}$ 和 $s = k \\Delta t$。显式更新可以写成当前值和相邻值的线性组合：\n$$\nu_i^{n+1} = (1 - 2 r - s) u_i^n + r u_{i-1}^n + r u_{i+1}^n,\n$$\n在边界处则为\n$$\nu_0^{n+1} = (1 - 2 r - s) u_0^n + 2 r u_1^n, \\quad\nu_{N-1}^{n+1} = (1 - 2 r - s) u_{N-1}^n + 2 r u_{N-2}^n.\n$$\n显式方法对非负的 $u^n$ 保持非负性的一个充分条件是，凸组合中的所有系数都为非负。这要求\n$r \\ge 0$ 和 $1 - 2 r - s \\ge 0$，这等价于\n$$\n\\Delta t \\le \\frac{1}{\\frac{2D}{h^2} + k}.\n$$\n当这个条件被违反时，自身权重 $1 - 2 r - s$ 会变为负数，即使所有 $u^n$ 都是非负的，更新也可能产生 $u_i^{n+1}  0$。这就是朴素显式离散化可能违反保正性的机制。\n\n隐式方法（时间上采用后向欧拉法）：\n后向欧拉法根据以下方式更新\n$$\nu^{n+1} - \\Delta t \\left(D \\frac{\\partial^2 u^{n+1}}{\\partial x^2} - k u^{n+1}\\right) = u^n,\n$$\n这可以写成一个线性系统\n$$\n\\left( \\mathbf{I} + s \\mathbf{I} - r \\mathbf{L} \\right) \\mathbf{u}^{n+1} = \\mathbf{u}^n,\n$$\n其中 $\\mathbf{L}$ 是带有镜像 Neumann 边界的离散拉普拉斯算子。$\\mathbf{L}$ 的结构是三对角的，对于内部节点，主对角线元素为 $-2/h^2$，次对角线元素为 $1/h^2$，而由于镜像，与边界相邻的次对角线元素为 $2/h^2$：\n$$\n\\mathbf{L} =\n\\begin{bmatrix}\n-2/h^2  2/h^2  0  \\cdots  0 \\\\\n1/h^2  -2/h^2  1/h^2  \\ddots  \\vdots \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n\\vdots  \\ddots  1/h^2  -2/h^2  1/h^2 \\\\\n0  \\cdots  0  2/h^2  -2/h^2\n\\end{bmatrix}.\n$$\n因此，系统矩阵\n$$\n\\mathbf{M} = \\mathbf{I} + s \\mathbf{I} - r \\mathbf{L}\n$$\n具有严格正的对角线元素和非正的次对角线元素，并且对于 $r \\ge 0, s \\ge 0$ 是严格对角占优的。这类矩阵是单调矩阵，特别是 $M$-矩阵。$M$-矩阵的一个基本性质是其逆矩阵 $\\mathbf{M}^{-1}$ 的所有元素都非负，即 $\\mathbf{M}^{-1} \\ge 0$。因此，对于非负的 $\\mathbf{u}^n$，更新\n$$\n\\mathbf{u}^{n+1} = \\mathbf{M}^{-1} \\mathbf{u}^n\n$$\n对于任何 $\\Delta t > 0$ 都满足 $\\mathbf{u}^{n+1} \\ge 0$。因此，后向欧拉法无条件地保持非负性。\n\n算法设计：\n- 用 $N$ 个点离散化域 $[0,L]$ 并计算 $h = L/(N-1)$。\n- 使用指定的光滑凸起剖面从 $u(x,0)$ 初始化 $\\mathbf{u}^0$。\n- 显式方法：在每个时间步，计算带有镜像边界的离散拉普拉斯算子以得到 $(\\partial^2 u/\\partial x^2)^n$，并通过前向欧拉法更新 $\\mathbf{u}^{n+1}$。通过检查是否 $\\min_i u_i^{n+1}  -10^{-12}$ 来跟踪负值。\n- 隐式方法：构建稀疏三对角矩阵 $\\mathbf{L}$，该矩阵编码了带有镜像边界的离散拉普拉斯算子。在每个时间步，形成矩阵 $\\mathbf{M} = \\mathbf{I} + s \\mathbf{I} - r \\mathbf{L}$，并使用稀疏直接求解器求解 $\\mathbf{M} \\mathbf{u}^{n+1} = \\mathbf{u}^n$。如上所述检查负值。\n\n测试套件原理：\n- 情况 A 结合了扩散和衰变，以及一个相对于 $h$ 较大的 $\\Delta t$，确保了 $1 - 2 r - s  0$，使得显式方法很可能出现负值；而后向欧拉法保持非负。\n- 情况 B 隔离了扩散项，并使用一个不稳定的显式 $\\Delta t$；而后向欧拉法无论如何都保持正值。\n- 情况 C 隔离了反应衰变项，并使用 $\\Delta t > 1/k$，这使得显式方法的更新 $u^{n+1} = (1 - k \\Delta t) u^n$ 变为负值，而后向欧拉法给出 $u^{n+1} = \\frac{u^n}{1 + k \\Delta t} \\ge 0$。\n- 情况 D 将 $\\Delta t$ 精确设置在显式保正性阈值上，因此显式格式成为一个非负的凸组合，从而产生非负性；后向欧拉法也是非负的。\n\n程序实现了这些步骤，并为每种情况返回一对布尔值 $[b_{\\text{explicit}}, b_{\\text{implicit}}]$，指示在相应方法的模拟过程中是否观察到任何负值。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags, identity\nfrom scipy.sparse.linalg import spsolve\n\ndef initial_condition(L, N):\n    x = np.linspace(0.0, L, N)\n    sigma = 0.1 * L\n    u0 = np.exp(-((x - L/2.0)**2) / (2.0 * sigma**2))\n    return u0\n\ndef laplacian_neumann(u, h):\n    # Discrete Laplacian with mirrored Neumann boundaries\n    N = len(u)\n    lap = np.zeros_like(u)\n    if N == 1:\n        # Degenerate domain: second derivative zero\n        lap[0] = 0.0\n        return lap\n    lap[1:-1] = (u[2:] - 2.0*u[1:-1] + u[:-2]) / (h**2)\n    lap[0] = (2.0*u[1] - 2.0*u[0]) / (h**2)\n    lap[-1] = (2.0*u[-2] - 2.0*u[-1]) / (h**2)\n    return lap\n\ndef build_L_matrix(N, h):\n    # Build sparse Laplacian with mirrored Neumann boundaries on [0,L]\n    main = np.full(N, -2.0 / (h**2))\n    upper = np.full(N-1, 1.0 / (h**2))\n    lower = np.full(N-1, 1.0 / (h**2))\n    # Adjust for mirrored boundaries: off-diagonal is doubled at boundary adjacency\n    upper[0] = 2.0 / (h**2)      # L[0,1] = 2/h^2\n    lower[-1] = 2.0 / (h**2)     # L[N-1,N-2] = 2/h^2\n    L = diags([lower, main, upper], offsets=[-1, 0, 1], shape=(N, N), format='csc')\n    return L\n\ndef simulate_explicit(D, k, L, N, dt, T, tol=-1e-12):\n    h = L / (N - 1)\n    u = initial_condition(L, N)\n    steps = int(np.round(T / dt))\n    negative_detected = False\n    for _ in range(steps):\n        lap = laplacian_neumann(u, h)\n        u = u + dt * (D * lap - k * u)\n        if np.min(u)  tol:\n            negative_detected = True\n            # Continue running to mimic full simulation; but flag remains set\n    return negative_detected\n\ndef simulate_implicit(D, k, L, N, dt, T, tol=-1e-12):\n    h = L / (N - 1)\n    u = initial_condition(L, N)\n    steps = int(np.round(T / dt))\n    # Build matrices once; M changes with dt but remains constant across steps\n    Lmat = build_L_matrix(N, h)\n    r = D * dt / (h**2)  # used only in forming M consistently with L definition\n    # Form M = I + s I - r L; note r defined as D*dt/h^2 but we directly use D*dt with L entries already contain 1/h^2\n    I = identity(N, format='csc')\n    M = I + (k * dt) * I - (D * dt) * Lmat\n    negative_detected = False\n    for _ in range(steps):\n        u = spsolve(M, u)\n        if np.min(u)  tol:\n            negative_detected = True\n    return negative_detected\n\ndef solve():\n    # Define common domain parameters\n    L = 1.0\n    N = 101\n\n    # Compute h for threshold calculation in Case D\n    h = L / (N - 1)\n\n    test_cases = [\n        # (D, k, T, dt, dt_is_threshold_flag)\n        (1.0, 0.5, 0.01, 0.001, False),     # Case A\n        (0.1, 0.0, 0.05, 0.005, False),     # Case B\n        (0.0, 5.0, 1.0, 0.5, False),        # Case C\n        (1.0, 0.0, 0.001, None, True),      # Case D: dt at threshold\n    ]\n\n    results = []\n    for D, k, T, dt, use_threshold in test_cases:\n        if use_threshold:\n            dt = 1.0 / (2.0 * D / (h**2) + k if (D > 0 or k > 0) else np.inf)\n        # Explicit (naive)\n        neg_explicit = simulate_explicit(D, k, L, N, dt, T)\n        # Implicit (positivity-preserving)\n        neg_implicit = simulate_implicit(D, k, L, N, dt, T)\n        results.append([neg_explicit, neg_implicit])\n\n    # Final print in exact required format.\n    # Convert booleans to lowercase strings to match JSON-like true/false\n    formatted = []\n    for pair in results:\n        formatted.append(f\"[{str(pair[0]).lower()},{str(pair[1]).lower()}]\")\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}