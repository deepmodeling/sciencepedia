{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of fluid-structure interaction is accurately modeling the mechanical state of the structure. For arteries, this begins with understanding the stress distribution within the wall due to blood pressure. This exercise  guides you through deriving the classic Lamé solution for a thick-walled cylinder and comparing it to the simpler thin-wall approximation, allowing you to quantify the error introduced by this common simplification and appreciate when it is valid.",
            "id": "3887138",
            "problem": "A long arterial segment is idealized as a thick-walled, circular cylinder undergoing axisymmetric pressurization, representative of Fluid-Structure Interaction (FSI) in vasculature. The lumen pressure is uniform and equal to $p_{i}$, and the external tissue pressure is $p_{o}=0$ (gauge). The wall is homogeneous, isotropic, linearly elastic, and experiences small strains; axial end effects are neglected so the state is axisymmetric and quasi-static. Let the inner radius be $R_{i}$ and the outer radius be $R_{o}$. The thickness ratio is defined as $\\lambda = R_{o}/R_{i}$.\n\nStarting from fundamental mechanical balance and admissible stress functions, derive the Lame stress distribution $(\\sigma_{r}(r), \\sigma_{\\theta}(r))$ for the pressurized thick-walled cylinder in terms of $p_{i}$, $p_{o}$, $R_{i}$, and $R_{o}$, and then evaluate the exact circumferential (hoop) stress at the inner wall, $\\sigma_{\\theta}(R_{i})$. Next, consider the classical thin-wall membrane approximation with circumferential stress taken as uniform through the thickness, computed from force balance using the mean radius $R_{m} = (R_{i}+R_{o})/2$ and thickness $t = R_{o}-R_{i}$, namely $\\sigma_{\\theta}^{\\text{thin}} = p_{i} R_{m}/t$. Define the relative error in predicting the inner-wall circumferential stress by\n$$\ne(\\lambda) = \\frac{\\sigma_{\\theta}^{\\text{thin}} - \\sigma_{\\theta}(R_{i})}{\\sigma_{\\theta}(R_{i})}.\n$$\nFor a vessel with thickness ratio $\\lambda = 1.3$ and external pressure $p_{o}=0$, compute $e(\\lambda)$ as a decimal. Round your final answer to four significant figures. No units are required for $e(\\lambda)$.",
            "solution": "The problem statement is physically and mathematically sound. All necessary parameters for the derivation and computation are provided. The problem is a classic exercise in solid mechanics, and the specified parameters are within a physiologically plausible range. The problem is valid.\n\nThe goal is to derive the Lamé stress distribution, find the hoop stress at the inner wall $\\sigma_{\\theta}(R_{i})$, derive the thin-wall approximation $\\sigma_{\\theta}^{\\text{thin}}$, and compute the relative error $e(\\lambda)$ for $\\lambda = 1.3$.\n\n**1. Lamé Solution for a Thick-Walled Cylinder**\n\nFor an axisymmetric, pressurized cylinder, the general solution for the radial stress $\\sigma_r$ and circumferential (hoop) stress $\\sigma_\\theta$ is given by:\n$$\n\\sigma_r(r) = A - \\frac{B}{r^2}\n$$\n$$\n\\sigma_\\theta(r) = A + \\frac{B}{r^2}\n$$\nwhere $A$ and $B$ are constants determined by the boundary conditions. The boundary conditions are the pressures acting on the inner and outer surfaces. By convention, compressive stress is negative.\n$$\n\\sigma_r(r=R_i) = -p_i\n$$\n$$\n\\sigma_r(r=R_o) = -p_o\n$$\nGiven in the problem, $p_o=0$. So, $\\sigma_r(R_o) = 0$.\n\nApplying the boundary conditions:\n1. At $r=R_o$: $0 = A - \\frac{B}{R_o^2} \\implies A = \\frac{B}{R_o^2}$\n2. At $r=R_i$: $-p_i = A - \\frac{B}{R_i^2}$\n\nSubstitute $A$ from (1) into (2):\n$$\n-p_i = \\frac{B}{R_o^2} - \\frac{B}{R_i^2} = B \\left( \\frac{1}{R_o^2} - \\frac{1}{R_i^2} \\right) = B \\frac{R_i^2 - R_o^2}{R_i^2 R_o^2}\n$$\nSolving for $B$:\n$$\nB = -p_i \\frac{R_i^2 R_o^2}{R_i^2 - R_o^2} = p_i \\frac{R_i^2 R_o^2}{R_o^2 - R_i^2}\n$$\nNow solve for $A$:\n$$\nA = \\frac{B}{R_o^2} = p_i \\frac{R_i^2}{R_o^2 - R_i^2}\n$$\n\nThe exact circumferential stress at the inner wall, $\\sigma_{\\theta}(R_{i})$, is:\n$$\n\\sigma_{\\theta}(R_{i}) = A + \\frac{B}{R_i^2} = p_i \\frac{R_i^2}{R_o^2 - R_i^2} + \\frac{1}{R_i^2} \\left( p_i \\frac{R_i^2 R_o^2}{R_o^2 - R_i^2} \\right) = p_i \\frac{R_i^2 + R_o^2}{R_o^2 - R_i^2}\n$$\nThis is the required exact stress.\n\n**2. Thin-Wall Approximation**\n\nThe thin-wall approximation using the mean radius $R_m = (R_i+R_o)/2$ and thickness $t = R_o-R_i$ is given by:\n$$\n\\sigma_{\\theta}^{\\text{thin}} = \\frac{p_i R_m}{t} = \\frac{p_i (R_i+R_o)/2}{R_o-R_i}\n$$\n\n**3. Relative Error Calculation**\n\nWe need to compute the relative error $e(\\lambda) = (\\sigma_{\\theta}^{\\text{thin}} - \\sigma_{\\theta}(R_{i})) / \\sigma_{\\theta}(R_{i})$. First, we express both stresses in terms of the thickness ratio $\\lambda = R_o/R_i$.\n$$\n\\sigma_{\\theta}(R_{i}) = p_i \\frac{R_o^2 + R_i^2}{R_o^2 - R_i^2} = p_i \\frac{(R_o/R_i)^2 + 1}{(R_o/R_i)^2 - 1} = p_i \\frac{\\lambda^2 + 1}{\\lambda^2 - 1}\n$$\n$$\n\\sigma_{\\theta}^{\\text{thin}} = \\frac{p_i (R_i+R_o)/2}{R_o-R_i} = \\frac{p_i (1+R_o/R_i)/2}{(R_o/R_i)-1} = \\frac{p_i (1+\\lambda)}{2(\\lambda-1)}\n$$\nNow, we formulate the error $e(\\lambda)$:\n$$\ne(\\lambda) = \\frac{\\sigma_{\\theta}^{\\text{thin}}}{\\sigma_{\\theta}(R_{i})} - 1 = \\frac{\\frac{p_i (1+\\lambda)}{2(\\lambda-1)}}{p_i \\frac{\\lambda^2 + 1}{\\lambda^2 - 1}} - 1 = \\frac{1+\\lambda}{2(\\lambda-1)} \\cdot \\frac{\\lambda^2-1}{\\lambda^2+1} - 1\n$$\nSince $\\lambda^2 - 1 = (\\lambda-1)(\\lambda+1)$, this simplifies to:\n$$\ne(\\lambda) = \\frac{(1+\\lambda)(\\lambda-1)(\\lambda+1)}{2(\\lambda-1)(\\lambda^2+1)} - 1 = \\frac{(\\lambda+1)^2}{2(\\lambda^2+1)} - 1 = \\frac{\\lambda^2+2\\lambda+1 - 2(\\lambda^2+1)}{2(\\lambda^2+1)}\n$$\n$$\ne(\\lambda) = \\frac{\\lambda^2+2\\lambda+1 - 2\\lambda^2-2}{2(\\lambda^2+1)} = \\frac{-\\lambda^2+2\\lambda-1}{2(\\lambda^2+1)} = -\\frac{(\\lambda-1)^2}{2(\\lambda^2+1)}\n$$\nThis is the symbolic expression for the relative error.\n\n**4. Numerical Computation**\n\nSubstitute $\\lambda = 1.3$:\n$$\ne(1.3) = -\\frac{(1.3-1)^2}{2(1.3^2+1)} = -\\frac{0.3^2}{2(1.69+1)} = -\\frac{0.09}{2(2.69)} = -\\frac{0.09}{5.38} \\approx -0.0167286245...\n$$\nRounding to four significant figures, the result is $-0.01673$.\nThe negative sign indicates that the thin-wall approximation, using the mean radius, underestimates the peak hoop stress at the inner wall.\n\nFinal result for $e(\\lambda)$ is $-0.01673$.",
            "answer": "$$\n\\boxed{-0.01673}\n$$"
        },
        {
            "introduction": "Having examined the vessel wall, we now turn to the fluid dynamics within. The complex, curved geometry of the vasculature gives rise to important flow phenomena not seen in straight pipes. This practice  focuses on calculating the Dean number, a critical dimensionless parameter used to predict the strength of secondary flows in curved arteries, and assessing their significant impact on wall shear stress patterns.",
            "id": "3887095",
            "problem": "A straight-to-curved carotid artery model is approximated as a steady, incompressible, laminar, Newtonian flow of blood through a circular tube of internal radius $a$ that follows an arc of constant centerline curvature $\\kappa$. The blood has density $\\rho$ and dynamic viscosity $\\mu$. The volumetric flow rate is $Q$. Using only fundamental definitions of kinematics, the Reynolds number, and the standard dimensionless group for curved-pipe inertia–curvature interaction, compute the Dean number for this artery segment. Then briefly assess, in words, whether secondary flows are likely to influence wall shear stress (wall shear stress (WSS) denotes the tangential stress exerted by the fluid on the wall). Use the data:\n- $a = 3 \\,\\mathrm{mm}$,\n- $\\kappa = 50 \\,\\mathrm{m^{-1}}$,\n- $Q = 4 \\,\\mathrm{mL\\cdot s^{-1}}$,\n- $\\rho = 1060 \\,\\mathrm{kg\\cdot m^{-3}}$,\n- $\\mu = 3.5 \\,\\mathrm{mPa\\cdot s}$.\n\nExpress the Dean number as a pure number (dimensionless). Round your answer to three significant figures.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of fluid dynamics, specifically biofluid mechanics concerning blood flow in arteries. The problem is well-posed, providing all necessary data for a unique solution. The provided values for blood density, viscosity, flow rate, artery radius, and curvature are physiologically realistic. The terminology is objective and precise.\n\nThe task is to compute the Dean number, $De$, for the specified carotid artery segment and to assess the influence of secondary flows on wall shear stress.\n\nThe Dean number is the standard dimensionless group that characterizes the strength of secondary flows in a curved pipe. It is defined as the product of the Reynolds number, $Re$, and the square root of the curvature ratio, $\\delta$.\n$$\nDe = Re \\sqrt{\\delta}\n$$\n\nFirst, we define the Reynolds number, $Re$, for flow in a pipe of hydraulic diameter $D$.\n$$\nRe = \\frac{\\rho V D}{\\mu}\n$$\nHere, $\\rho$ is the fluid density, $V$ is the average flow velocity, and $\\mu$ is the dynamic viscosity. For a circular tube of internal radius $a$, the hydraulic diameter is $D = 2a$. The Reynolds number is therefore:\n$$\nRe = \\frac{\\rho V (2a)}{\\mu}\n$$\n\nThe average velocity $V$ is related to the volumetric flow rate $Q$ and the cross-sectional area of the tube $A = \\pi a^2$ by the fundamental kinematic definition:\n$$\nV = \\frac{Q}{A} = \\frac{Q}{\\pi a^2}\n$$\nSubstituting this expression for $V$ into the Reynolds number equation gives:\n$$\nRe = \\frac{\\rho \\left(\\frac{Q}{\\pi a^2}\\right) (2a)}{\\mu} = \\frac{2\\rho Q}{\\pi a \\mu}\n$$\n\nNext, we define the curvature ratio, $\\delta$. This is the ratio of the pipe's internal radius $a$ to its centerline radius of curvature $R_c$.\n$$\n\\delta = \\frac{a}{R_c}\n$$\nThe problem provides the centerline curvature $\\kappa$, which is the reciprocal of the radius of curvature, $\\kappa = \\frac{1}{R_c}$. Therefore, we can express the curvature ratio as:\n$$\n\\delta = a\\kappa\n$$\n\nNow we assemble the complete expression for the Dean number by substituting the expressions for $Re$ and $\\delta$:\n$$\nDe = \\left( \\frac{2\\rho Q}{\\pi a \\mu} \\right) \\sqrt{a\\kappa}\n$$\nThis is the final symbolic expression for the Dean number based on the given parameters.\n\nThe problem provides the following data:\n- Internal radius: $a = 3 \\,\\mathrm{mm}$\n- Centerline curvature: $\\kappa = 50 \\,\\mathrm{m^{-1}}$\n- Volumetric flow rate: $Q = 4 \\,\\mathrm{mL\\cdot s^{-1}}$\n- Blood density: $\\rho = 1060 \\,\\mathrm{kg\\cdot m^{-3}}$\n- Blood dynamic viscosity: $\\mu = 3.5 \\,\\mathrm{mPa\\cdot s}$\n\nBefore calculation, all values must be converted to a consistent system of units, the SI system (meters, kilograms, seconds).\n- $a = 3 \\,\\mathrm{mm} = 3 \\times 10^{-3} \\,\\mathrm{m}$\n- $\\kappa = 50 \\,\\mathrm{m^{-1}}$ (already in SI units)\n- $Q = 4 \\,\\mathrm{mL\\cdot s^{-1}} = 4 \\,\\mathrm{cm^3 \\cdot s^{-1}} = 4 \\times (10^{-2})^3 \\,\\mathrm{m^3 \\cdot s^{-1}} = 4 \\times 10^{-6} \\,\\mathrm{m^3 \\cdot s^{-1}}$\n- $\\rho = 1060 \\,\\mathrm{kg\\cdot m^{-3}}$ (already in SI units)\n- $\\mu = 3.5 \\,\\mathrm{mPa\\cdot s} = 3.5 \\times 10^{-3} \\,\\mathrm{Pa\\cdot s} = 3.5 \\times 10^{-3} \\,\\mathrm{kg \\cdot m^{-1} \\cdot s^{-1}}$\n\nWe can now substitute these numerical values into the symbolic expression for $De$:\n$$\nDe = \\frac{2(1060)(4 \\times 10^{-6})}{\\pi (3 \\times 10^{-3})(3.5 \\times 10^{-3})} \\sqrt{(3 \\times 10^{-3})(50)}\n$$\nLet's simplify the terms:\n$$\nDe = \\frac{8480 \\times 10^{-6}}{\\pi (10.5 \\times 10^{-6})} \\sqrt{0.15}\n$$\nThe factor of $10^{-6}$ in the numerator and denominator cancels out.\n$$\nDe = \\frac{8480}{10.5\\pi} \\sqrt{0.15}\n$$\nNow, we compute the numerical value:\n$$\nDe \\approx \\frac{8480}{32.9867} \\times 0.387298\n$$\n$$\nDe \\approx 257.073 \\times 0.387298\n$$\n$$\nDe \\approx 99.554\n$$\nRounding the result to three significant figures as requested, we get $De = 99.6$.\n\nThe second part of the task is to assess whether secondary flows are likely to influence wall shear stress (WSS). The Dean number quantifies the strength of these secondary motions (Dean vortices) relative to the primary axial flow. A common empirical threshold is that for $De > 40$, secondary flows become significant and substantially alter the flow field from the simple parabolic profile of Poiseuille flow in a straight pipe.\n\nOur calculated value is $De \\approx 99.6$, which is well above this threshold of $40$. Therefore, secondary flows are certainly strong enough to have a major influence on the distribution of wall shear stress. In a curved pipe, secondary flows transport high-momentum fluid from the center of the pipe towards the outer wall of the bend. This skews the axial velocity profile, shifting the point of maximum velocity from the centerline towards the outer wall. As WSS is proportional to the velocity gradient at the wall ($\\tau_w = \\mu \\frac{\\partial u}{\\partial n}|_{wall}$), this redistribution of momentum results in a non-uniform WSS distribution around the circumference of the artery. Specifically, the WSS will be significantly higher on the outer wall of the curve and lower on the inner wall compared to the values that would be found in a straight pipe with the same flow rate. This phenomenon is of great clinical interest, as low and oscillating WSS on the inner wall of arterial curvatures is often implicated in the development of atherosclerotic plaques.\n\nIn conclusion, secondary flows are very likely to influence the wall shear stress in this carotid artery model, leading to its significant spatial variation.",
            "answer": "$$\n\\boxed{99.6}\n$$"
        },
        {
            "introduction": "Building on the principles of fluid and solid mechanics, we can create integrated models of the cardiovascular system. Lumped-parameter models, such as the Windkessel model, are powerful tools for simulating the dynamic interplay between pressure, flow, and vascular compliance. In this computational exercise , you will implement and compare a simple resistive outlet with a more sophisticated three-element Windkessel model, directly observing how capturing arterial compliance affects the predicted aortic pressure waveform.",
            "id": "3887040",
            "problem": "Consider a lumped-parameter representation of Fluid-Structure Interaction (FSI), modeling the aortic root as a compliant chamber connected to an outlet boundary condition. The structural compliance of the aortic root wall is represented by a constant aortic compliance $C_a$ such that small changes in volume $V$ and pressure $P$ satisfy $dV = C_a \\, dP$. Conservation of mass in the chamber states that $dV/dt = Q_{\\text{in}} - Q_{\\text{out}}$, where $Q_{\\text{in}}(t)$ is a prescribed inflow waveform and $Q_{\\text{out}}(t)$ is determined by the outlet boundary condition. Combining these gives the governing relation for the aortic root pressure:\n$$\nC_a \\frac{dP}{dt} = Q_{\\text{in}}(t) - Q_{\\text{out}}(t).\n$$\n\nYou will compare two outlet boundary condition models under the same inflow waveform:\n\n1. A resistance-only outlet, characterized by a single resistance $R_{\\text{out}}$, for which\n$$\nQ_{\\text{out}}(t) = \\frac{P(t)}{R_{\\text{out}}}.\n$$\n\n2. A three-element Windkessel (Resistance–Compliance–Resistance, often denoted RCR). This model has a proximal resistance $R_p$ in series with a parallel combination of a distal compliance $C_d$ and a distal resistance $R_d$. Let $P_d(t)$ denote the pressure across the distal parallel network. The constitutive and conservation relations for the RCR model are:\n$$\nQ_p(t) = \\frac{P(t) - P_d(t)}{R_p}, \\quad Q_d(t) = \\frac{P_d(t)}{R_d}, \\quad Q_c(t) = C_d \\frac{dP_d}{dt},\n$$\nwith the parallel-network conservation\n$$\nQ_p(t) = Q_d(t) + Q_c(t),\n$$\nwhich yields the distal pressure dynamics\n$$\n\\frac{dP_d}{dt} = \\frac{1}{C_d} \\left( \\frac{P(t) - P_d(t)}{R_p} - \\frac{P_d(t)}{R_d} \\right).\n$$\nFor the chamber, $Q_{\\text{out}}(t) = Q_p(t)$ in the RCR case, and the chamber pressure evolves as\n$$\nC_a \\frac{dP}{dt} = Q_{\\text{in}}(t) - \\frac{P(t) - P_d(t)}{R_p}.\n$$\n\nThe inflow waveform $Q_{\\text{in}}(t)$ is defined over a heart period $T$ with systolic ejection duration $t_s$ starting at time offset $t_0$ each cycle. With stroke volume $\\text{SV}$ per beat, use a half-sine ejection profile such that\n$$\nQ_{\\text{in}}(t) =\n\\begin{cases}\nQ_0 \\sin\\!\\left( \\pi \\frac{t - k T - t_0}{t_s} \\right),  \\text{for } t \\in [k T + t_0, k T + t_0 + t_s] \\text{ for integer } k \\ge 0, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nwhere $Q_0$ is chosen to satisfy $\\int_{t_0}^{t_0 + t_s} Q_{\\text{in}}(t) \\, dt = \\text{SV}$. This yields\n$$\nQ_0 = \\text{SV} \\cdot \\frac{\\pi}{2 t_s}.\n$$\n\nAssume the following:\n- The initial aortic root pressure is $P(0) = P_0$ and the distal pressure is $P_d(0) = P_0$, representing a consistent initial state.\n- Units and constants:\n  - Pressures $P$ and $P_d$ are computed internally in Pascals (Pa) and must be reported in millimeters of mercury (mmHg).\n  - The conversion is $1 \\text{ mmHg} = 133.322387415 \\text{ Pa}$.\n  - Flows $Q$ are in $\\text{m}^3/\\text{s}$, resistances $R$ are in $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$, and compliances $C$ are in $\\text{m}^3/\\text{Pa}$.\n- Integrate the ordinary differential equations using a fixed time step explicit method over a simulation interval of $2 T$ seconds.\n\nYour task is to write a complete program that, for each specified test case, simulates the system under both outlet models, computes and returns the following metrics:\n- The peak (maximum over time) aortic root pressure for the resistance-only outlet, in mmHg, rounded to two decimal places.\n- The peak aortic root pressure for the three-element Windkessel outlet, in mmHg, rounded to two decimal places.\n- The difference defined as (Windkessel peak minus resistance-only peak), in mmHg, rounded to two decimal places.\n\nUse the same inflow waveform and initial conditions for both outlet models in each test case.\n\nExpress all returned pressures in mmHg, rounded to two decimal places.\n\nSimulation parameters common to all tests:\n- $T = 1.0$ seconds,\n- $t_0 = 0.05$ seconds,\n- $t_s = 0.30$ seconds,\n- $\\text{SV} = 80 \\times 10^{-6}$ $\\text{m}^3$,\n- $P_0 = 80$ mmHg,\n- Time step $\\Delta t = 0.0001$ seconds,\n- Total simulation time $2T = 2.0$ seconds.\n\nTest suite (four parameter sets):\n1. Baseline vascular properties:\n   - $C_a = 1.0 \\times 10^{-8}$ $\\text{m}^3/\\text{Pa}$,\n   - $R_{\\text{out}} = 1.20 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_p = 1.50 \\times 10^{7}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_d = 1.05 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $C_d = 1.20 \\times 10^{-8}$ $\\text{m}^3/\\text{Pa}$.\n2. High aortic compliance:\n   - $C_a = 2.0 \\times 10^{-8}$ $\\text{m}^3/\\text{Pa}$,\n   - $R_{\\text{out}} = 1.20 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_p = 1.50 \\times 10^{7}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_d = 1.05 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $C_d = 1.20 \\times 10^{-8}$ $\\text{m}^3/\\text{Pa}$.\n3. Low aortic compliance with reduced distal compliance:\n   - $C_a = 5.0 \\times 10^{-9}$ $\\text{m}^3/\\text{Pa}$,\n   - $R_{\\text{out}} = 1.20 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_p = 1.50 \\times 10^{7}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_d = 1.05 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $C_d = 8.00 \\times 10^{-9}$ $\\text{m}^3/\\text{Pa}$.\n4. Elevated proximal resistance:\n   - $C_a = 1.0 \\times 10^{-8}$ $\\text{m}^3/\\text{Pa}$,\n   - $R_{\\text{out}} = 1.20 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_p = 5.00 \\times 10^{7}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $R_d = 1.05 \\times 10^{8}$ $\\text{Pa}\\cdot\\text{s}/\\text{m}^3$,\n   - $C_d = 1.20 \\times 10^{-8}$ $\\text{m}^3/\\text{Pa}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a three-element list of the form $[\\text{peak}_{\\text{R-only}}, \\text{peak}_{\\text{RCR}}, \\Delta]$, for example:\n$[[p_1^{\\text{R-only}}, p_1^{\\text{RCR}}, \\Delta_1],[p_2^{\\text{R-only}}, p_2^{\\text{RCR}}, \\Delta_2],[p_3^{\\text{R-only}}, p_3^{\\text{RCR}}, \\Delta_3],[p_4^{\\text{R-only}}, p_4^{\\text{RCR}}, \\Delta_4]]$,\nwith each $p$ and $\\Delta$ expressed in mmHg, rounded to two decimal places.",
            "solution": "The problem is computationally valid and well-posed. It requires the numerical integration of ordinary differential equations (ODEs) that model a simplified cardiovascular system. All parameters, equations, initial conditions, and output requirements are clearly specified.\n\n**Methodology**\n\nThe core of the problem is to solve systems of first-order ODEs over a specified time interval. A fixed-step explicit numerical method is specified, for which the Forward Euler method is the simplest and most appropriate choice given the context.\n\n**1. Governing Equations**\n\nLet $P(t)$ be the aortic root pressure and $P_d(t)$ be the distal pressure in the RCR model. The systems of ODEs are:\n\n**Model 1: Resistance-Only Outlet**\nA single ODE for $P(t)$:\n$$\n\\frac{dP}{dt} = \\frac{1}{C_a} \\left( Q_{\\text{in}}(t) - \\frac{P(t)}{R_{\\text{out}}} \\right)\n$$\n\n**Model 2: Three-Element Windkessel (RCR) Outlet**\nA coupled system of two ODEs for $P(t)$ and $P_d(t)$:\n$$\n\\frac{dP}{dt} = \\frac{1}{C_a} \\left( Q_{\\text{in}}(t) - \\frac{P(t) - P_d(t)}{R_p} \\right)\n$$\n$$\n\\frac{dP_d}{dt} = \\frac{1}{C_d} \\left( \\frac{P(t) - P_d(t)}{R_p} - \\frac{P_d(t)}{R_d} \\right)\n$$\n\n**2. Numerical Discretization (Forward Euler)**\n\nWe discretize time with a step size $\\Delta t$. Let $P^n$ denote the pressure at time step $n$. The Forward Euler update scheme approximates the derivative as $\\frac{dP}{dt} \\approx \\frac{P^{n+1} - P^n}{\\Delta t}$.\n\n**Model 1 Update Equation:**\n$$\nP^{n+1} = P^n + \\Delta t \\cdot \\frac{1}{C_a} \\left( Q_{\\text{in}}^n - \\frac{P^n}{R_{\\text{out}}} \\right)\n$$\n\n**Model 2 Update Equations:**\nThe two equations are solved simultaneously at each time step:\n$$\nP^{n+1} = P^n + \\Delta t \\cdot \\frac{1}{C_a} \\left( Q_{\\text{in}}^n - \\frac{P^n - P_d^n}{R_p} \\right)\n$$\n$$\nP_d^{n+1} = P_d^n + \\Delta t \\cdot \\frac{1}{C_d} \\left( \\frac{P^n - P_d^n}{R_p} - \\frac{P_d^n}{R_d} \\right)\n$$\n\n**3. Implementation Details**\n\n*   **Unit Conversion:** All calculations are performed in base SI units (Pascals, m$^3$/s, etc.). The initial pressure $P_0=80$ mmHg must be converted to Pascals before the simulation begins. Final peak pressures, calculated in Pascals, must be converted back to mmHg for reporting. The conversion factor is $1 \\text{ mmHg} = 133.322387415 \\text{ Pa}$.\n*   **Inflow Waveform:** The time-varying inflow $Q_{\\text{in}}(t)$ is pre-calculated for all time steps to avoid repeated calculations within the loop. The formula for $Q_{\\text{in}}(t)$ uses the modulo operator (`%`) to handle multiple cardiac cycles.\n*   **Simulation Loop:** A loop iterates from $t=0$ to the total simulation time ($2T$) with step size $\\Delta t$.\n    *   Inside the loop, for each model, the pressure(s) at step $n+1$ are calculated from the values at step $n$ using the update equations.\n    *   This process generates a time-series array of pressure values for each model.\n*   **Metrics Calculation:** After the simulation loop completes, the maximum value (peak pressure) is found in the resulting pressure array for each model.\n*   **Final Output:** The peak pressures are converted to mmHg, the difference is calculated, and the results for each test case are rounded to two decimal places and formatted into the specified list-of-lists string format. The simulation is run for two cardiac cycles to ensure any initial transients have settled and a representative peak pressure is captured from the second cycle (though taking the max over the whole duration is robust enough).",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates aortic root pressure using two outlet models (Resistance-only and RCR)\n    and computes peak pressures for several test cases.\n    \"\"\"\n\n    # --- 1. Define Common Simulation Parameters and Constants ---\n    \n    # Conversion factor from mmHg to Pascals\n    PA_PER_MMHG = 133.322387415\n\n    # Time parameters\n    T = 1.0          # Heart period [s]\n    t0 = 0.05        # Systolic ejection start time [s]\n    ts = 0.30        # Systolic ejection duration [s]\n    dt = 0.0001      # Time step [s]\n    sim_time_total = 2.0 * T # Total simulation duration [s]\n\n    # Inflow parameters\n    SV = 80.0e-6     # Stroke volume [m^3]\n    Q0 = SV * np.pi / (2 * ts) # Peak inflow rate [m^3/s]\n\n    # Initial condition\n    P0_mmhg = 80.0\n    P0_pa = P0_mmhg * PA_PER_MMHG\n\n    # Test suite: (Ca, R_out, Rp, Rd, Cd) for each case\n    test_cases = [\n        # 1. Baseline\n        (1.0e-8, 1.20e8, 1.50e7, 1.05e8, 1.20e-8),\n        # 2. High aortic compliance\n        (2.0e-8, 1.20e8, 1.50e7, 1.05e8, 1.20e-8),\n        # 3. Low aortic compliance, reduced distal compliance\n        (5.0e-9, 1.20e8, 1.50e7, 1.05e8, 8.00e-9),\n        # 4. Elevated proximal resistance\n        (1.0e-8, 1.20e8, 5.00e7, 1.05e8, 1.20e-8),\n    ]\n\n    # --- 2. Pre-compute Time Vector and Inflow Waveform ---\n\n    # Create the time vector for the simulation\n    t_vec = np.arange(0, sim_time_total + dt, dt)\n    num_steps = len(t_vec)\n\n    # Generate the inflow Q_in(t) for all time steps\n    q_in_vec = np.zeros(num_steps)\n    for i, t in enumerate(t_vec):\n        t_cycle = t % T\n        if t0 = t_cycle  (t0 + ts):\n            q_in_vec[i] = Q0 * np.sin(np.pi * (t_cycle - t0) / ts)\n\n    # --- 3. Iterate Through Test Cases and Simulate ---\n    \n    all_results_formatted = []\n\n    for case in test_cases:\n        Ca, R_out, Rp, Rd, Cd = case\n\n        # --- 3a. Resistance-Only (R-only) Model Simulation ---\n        \n        P_r_only = np.zeros(num_steps)\n        P_r_only[0] = P0_pa\n\n        for i in range(num_steps - 1):\n            # dP/dt = (Q_in - P/R_out) / Ca\n            dPdt_r = (q_in_vec[i] - P_r_only[i] / R_out) / Ca\n            P_r_only[i+1] = P_r_only[i] + dt * dPdt_r\n        \n        peak_r_only_pa = np.max(P_r_only)\n        peak_r_only_mmhg = peak_r_only_pa / PA_PER_MMHG\n        \n        # --- 3b. Three-Element Windkessel (RCR) Model Simulation ---\n        \n        P_rcr = np.zeros(num_steps)\n        Pd_rcr = np.zeros(num_steps)\n        P_rcr[0] = P0_pa\n        Pd_rcr[0] = P0_pa\n\n        for i in range(num_steps - 1):\n            # Proximal flow Qp = (P - Pd) / Rp\n            Qp = (P_rcr[i] - Pd_rcr[i]) / Rp\n            \n            # Aortic root pressure ODE: dP/dt = (Q_in - Qp) / Ca\n            dPdt_rcr = (q_in_vec[i] - Qp) / Ca\n            \n            # Distal network pressure ODE: dPd/dt = (Qp - Pd/Rd) / Cd\n            dPddt_rcr = (Qp - Pd_rcr[i] / Rd) / Cd\n\n            # Forward Euler update\n            P_rcr[i+1] = P_rcr[i] + dt * dPdt_rcr\n            Pd_rcr[i+1] = Pd_rcr[i] + dt * dPddt_rcr\n\n        peak_rcr_pa = np.max(P_rcr)\n        peak_rcr_mmhg = peak_rcr_pa / PA_PER_MMHG\n\n        # --- 3c. Calculate Metrics and Format Results ---\n        \n        diff_mmhg = peak_rcr_mmhg - peak_r_only_mmhg\n        \n        # Format the results for the current case to two decimal places\n        formatted_case_result = (\n            f\"[{round(peak_r_only_mmhg, 2):.2f},\"\n            f\"{round(peak_rcr_mmhg, 2):.2f},\"\n            f\"{round(diff_mmhg, 2):.2f}]\"\n        )\n        all_results_formatted.append(formatted_case_result)\n\n    # --- 4. Final Output ---\n    \n    # Join all formatted case results into a single string\n    final_output = f\"[{','.join(all_results_formatted)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}