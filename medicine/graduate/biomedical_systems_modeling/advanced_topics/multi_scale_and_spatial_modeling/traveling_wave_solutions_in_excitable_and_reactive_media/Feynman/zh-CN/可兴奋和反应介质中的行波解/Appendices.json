{
    "hands_on_practices": [
        {
            "introduction": "行波能够传播之前，介质本身必须具备合适的局部动力学特性。本练习将作为理解反应扩散系统的基础，通过分析一个系统的反应项（即无扩散的情况），来探索其系统的核心行为。你将通过对一个典型的激活-抑制模型的分析，学习如何将系统划分为单稳态、双稳态和可兴奋三种机制，这些是后续理解不同类型行波的基础。",
            "id": "3939539",
            "problem": "考虑一个与心脏或神经组织相关的可兴奋介质的巴克利型激活子-抑制子模型，其中包含快激活子场 $u(x,t)$ 和慢抑制子场 $v(x,t)$：\n$$\n\\partial_t u \\;=\\; \\frac{1}{\\varepsilon}\\,u\\,(1-u)\\,(u-a)\\;-\\;v\\;+\\;D_u\\,\\nabla^2 u,\\qquad\n\\partial_t v \\;=\\; u\\;-\\;b\\,v\\;+\\;D_v\\,\\nabla^2 v,\n$$\n其中 $0  \\varepsilon \\ll 1$ 是快慢时间尺度比，$a\\in(0,1)$ 是可兴奋性阈值参数，$b0$ 设定了抑制子的恢复过程，而 $D_u\\ge 0$，$D_v\\ge 0$ 是扩散系数。假设空间均匀平衡点用于对局部动力学进行分类。单稳态、双稳态和可兴奋状态的概念由反应子系统（即 $D_u=D_v=0$）的空间均匀平衡点的数量和稳定性定义：单稳态指存在唯一的稳定平衡点，双稳态指存在两个由一个不稳定平衡点隔开的稳定平衡点，而可兴奋状态指一种单稳态，其具有快慢阈值非线性，在重新引入扩散后可以支持行波脉冲。\n\n仅从平衡点的核心定义、雅可比线性化以及平面系统的线性稳定性出发，完成以下任务：\n\n- 识别具有最小激活子值的空间均匀静息态，并计算反应子系统在该静息态的雅可比矩阵。\n- 确定反应子系统具有一个平衡点与三个平衡点的参数条件，并利用线性稳定性来区分单稳态与双稳态。明确说明界定可兴奋状态的条件。\n- 作为最终答案，报告在 $(a,b,\\varepsilon)$ 空间中，鞍结分岔产生或湮灭反应子系统的两个非平凡平衡点时的余维一边界的闭式解析表达式，该边界分隔了单稳态可兴奋状态与双稳态。\n\n无需进行数值计算。将最终答案表示为关于 $a$ 和 $b$ 的临界值 $\\varepsilon_c(a,b)$ 的单个解析表达式。不要包含单位。",
            "solution": "问题要求分析巴克利型激活子-抑制子模型的空间均匀动力学，并推导分隔单稳态和双稳态的分岔边界。分析从反应子系统开始，其中扩散系数设为零（$D_u = 0$，$D_v = 0$）。\n\n反应子系统由以下常微分方程组控制：\n$$\n\\frac{du}{dt} = \\frac{1}{\\varepsilon}u(1-u)(u-a) - v \\equiv f(u,v)\n$$\n$$\n\\frac{dv}{dt} = u - bv \\equiv g(u,v)\n$$\n空间均匀平衡点，或称不动点 $(u^*, v^*)$，是系统不随时间变化的状态，即 $\\frac{du}{dt}=0$ 和 $\\frac{dv}{dt}=0$。这些条件定义了系统的零斜线。\n\n$v$-零斜线由 $\\frac{dv}{dt}=0$ 得到：\n$$\nu - bv = 0 \\implies v = \\frac{u}{b}\n$$\n这是一条通过原点、斜率为正值 $1/b$ 的直线。\n\n$u$-零斜线由 $\\frac{du}{dt}=0$ 得到：\n$$\n\\frac{1}{\\varepsilon}u(1-u)(u-a) - v = 0 \\implies v = \\frac{1}{\\varepsilon}u(1-u)(u-a)\n$$\n这是一个关于 $u$ 的三次函数，其根为 $u=0$、$u=a$ 和 $u=1$。由于 $0  a  1$，该三次函数具有特征性的“N”形。\n\n平衡点是这两条零斜线的交点。为求平衡点的 $u$ 坐标，我们将 $v$ 的两个表达式设为相等：\n$$\n\\frac{u}{b} = \\frac{1}{\\varepsilon}u(1-u)(u-a)\n$$\n该方程可以重写为：\n$$\nu \\left( \\frac{1}{b} - \\frac{1}{\\varepsilon}(1-u)(u-a) \\right) = 0\n$$\n一个直接的解是 $u=0$。将此代入 $v$-零斜线方程 $v=u/b$，得到 $v=0$。因此，$(u,v)=(0,0)$ 始终是系统的一个平衡点。这对应于具有最小激活子值的静息态。\n\n第一个任务是计算反应子系统在该静息态的雅可比矩阵。雅可比矩阵 $J(u,v)$ 由下式给出：\n$$\nJ(u,v) = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix}\n$$\n各偏导数为：\n$$\n\\frac{\\partial f}{\\partial u} = \\frac{d}{du}\\left[\\frac{1}{\\varepsilon}(-u^3 + (1+a)u^2 - au)\\right] = \\frac{1}{\\varepsilon}(-3u^2 + 2(1+a)u - a)\n$$\n$$\n\\frac{\\partial f}{\\partial v} = -1\n$$\n$$\n\\frac{\\partial g}{\\partial u} = 1\n$$\n$$\n\\frac{\\partial g}{\\partial v} = -b\n$$\n计算在平衡点 $(0,0)$ 处的雅可比矩阵：\n$$\nJ(0,0) = \\begin{pmatrix} \\frac{1}{\\varepsilon}(-a)  -1 \\\\ 1  -b \\end{pmatrix} = \\begin{pmatrix} -\\frac{a}{\\varepsilon}  -1 \\\\ 1  -b \\end{pmatrix}\n$$\n为确认这是一个稳定的静息态，我们分析其线性稳定性。雅可比矩阵的迹 ($\\tau$) 和行列式 ($\\Delta$) 分别为：\n$$\n\\tau = \\text{Tr}(J(0,0)) = -\\frac{a}{\\varepsilon} - b\n$$\n$$\n\\Delta = \\det(J(0,0)) = \\left(-\\frac{a}{\\varepsilon}\\right)(-b) - (-1)(1) = \\frac{ab}{\\varepsilon} + 1\n$$\n给定参数约束 $a>0$，$b>0$ 和 $\\varepsilon>0$，迹恒为负 ($\\tau  0$)，行列式恒为正 ($\\Delta > 0$)。这些条件保证了 $(0,0)$ 处的平衡点始终是稳定的（稳定节点或稳定焦点）。\n\n接下来，我们处理第二个任务：确定存在一个平衡点与三个平衡点的条件。其余的平衡点可从平衡方程的另一个因子中求得：\n$$\n\\frac{1}{b} = \\frac{1}{\\varepsilon}(1-u)(u-a) \\implies \\frac{\\varepsilon}{b} = -u^2 + (1+a)u - a\n$$\n将其整理成标准二次方程形式，得到：\n$$\nu^2 - (1+a)u + \\left(a + \\frac{\\varepsilon}{b}\\right) = 0\n$$\n该二次方程关于 $u$ 的实数解的个数由其判别式 $D$ 的符号决定：\n$$\nD = (-(1+a))^2 - 4(1)\\left(a + \\frac{\\varepsilon}{b}\\right) = (1+a)^2 - 4a - \\frac{4\\varepsilon}{b} = 1 + 2a + a^2 - 4a - \\frac{4\\varepsilon}{b}\n$$\n$$\nD = (1-a)^2 - \\frac{4\\varepsilon}{b}\n$$\n根据 $D$ 的符号，有三种情况：\n1.  如果 $D>0$，即 $(1-a)^2  \\frac{4\\varepsilon}{b}$，方程有两个不同的正实根。加上 $u=0$ 这个根，系统共有三个平衡点。这对应于**双稳态**，其中系统有两个稳定平衡点（最低的在 $(0,0)$，以及最高的那个）被一个不稳定（鞍点）平衡点所分隔。\n2.  如果 $D0$，即 $(1-a)^2  \\frac{4\\varepsilon}{b}$，除了 $u=0$ 之外，方程没有其他实数根。系统只有一个平衡点 $(0,0)$。这是**单稳态**。\n3.  如果 $D=0$，即 $(1-a)^2 = \\frac{4\\varepsilon}{b}$，对于 $u \\ne 0$ 有一个二重实根。这是临界情况，对应于鞍结分岔。\n\n**可兴奋状态**一词指的是单稳态情况，其中底层的快慢动力学和N形零斜线可以在受到超阈值扰动时产生大的瞬态偏移（脉冲），然后返回到单一的稳定静息态。因此，可兴奋状态的条件与单稳态的条件相同：\n$$\n(1-a)^2  \\frac{4\\varepsilon}{b} \\quad \\text{或等价地} \\quad \\varepsilon  \\frac{b(1-a)^2}{4}\n$$\n\n最后，第三个任务是求出在 $(a,b,\\varepsilon)$ 空间中分隔单稳态（可兴奋）和双稳态的余维一边界的闭式解析表达式。这个边界正是两个非平凡平衡点产生或湮灭的分岔点。这发生在判别式 $D$ 为零时：\n$$\nD = (1-a)^2 - \\frac{4\\varepsilon}{b} = 0\n$$\n对该方程求解 $\\varepsilon$ 的临界值，记为 $\\varepsilon_c(a,b)$，即可得到鞍结分岔边界的表达式：\n$$\n\\varepsilon_c(a,b) = \\frac{b(1-a)^2}{4}\n$$\n该表达式定义了参数空间 $(a,b,\\varepsilon)$ 中的一个曲面，它将只有一个平衡点的区域（单稳态/可兴奋）与有三个平衡点的区域（双稳态）分隔开来。",
            "answer": "$$\\boxed{\\frac{b(1-a)^2}{4}}$$"
        },
        {
            "introduction": "在理解了局部动力学之后，我们引入扩散并观察行波的形成。一个基本问题是：波的传播速度有多快，方向是怎样的？本练习将指导你完成一个经典的推导，从而找到波速的表达式，并揭示它如何依赖于系统稳定态之间的“势”差。这个过程不仅展示了数学技巧，更深刻地揭示了波传播方向是由系统从亚稳态向更稳定状态演化的趋势所决定的。",
            "id": "3939546",
            "problem": "考虑一个用于描述心脏组织中归一化跨膜电位的一维反应介质模型，该模型由偏微分方程 (PDE) $u_{t} = D\\,u_{xx} + f(u)$ 给出，其中 $D  0$ 是扩散系数，$f(u)$ 是一个双稳态反应项，其平衡态位于 $u = 0$ 和 $u = 1$。假设一个行进波前解 $u(x,t) = U(z)$，该解是单调递减的，并连接 $U(-\\infty) = 1$ 和 $U(\\infty) = 0$。使用行进坐标 $z = x - \\frac{c}{D}\\,t$，其中 $c$ 是一个待确定的常数参数。\n\n仅从该偏微分方程、行波 ansatz、标准微积分恒等式以及当 $z \\to \\pm \\infty$ 时 $U(z)$ 的边界行为出发，推导参数 $c$ 的解析表达式，该表达式应以包含 $U$ 的空间积分以及 $f(u)$ 在 $u = 0$ 和 $u = 1$ 之间的有符号面积来表示。然后，解释 $c$ 的符号是如何由稳定平衡点之间由 $F(u) = \\int_{0}^{u} f(s)\\,ds$ 定义的势能不平衡所决定的。\n\n为了将推导建立在具体的生物医学动力学基础上，设反应项为三次动力学 $f(u) = k\\,u\\,(u - a)\\,(1 - u)$，其中 $0  a  1$ 且 $k  0$ 是一个速率常数。显式地计算积分 $\\int_{0}^{1} f(u)\\,du$（用 $a$ 和 $k$ 表示），并提供 $c$ 关于 $D$、$k$、$a$ 和 $\\int_{-\\infty}^{\\infty} (U'(z))^{2}\\,dz$ 的最终解析表达式。无需进行数值评估。明确说明 $c$ 的符号如何依赖于 $a$。\n\n你的最终答案必须是 $c$ 的一个单一闭式解析表达式。不要在你的最终方框答案中包含任何单位。",
            "solution": "我们从给定的偏微分方程 (PDE) 开始：\n$$u_{t} = D\\,u_{xx} + f(u)$$\n我们寻求一个形式为 $u(x,t) = U(z)$ 的行波解，其中行进坐标为 $z = x - \\frac{c}{D} t$。我们使用链式法则计算 $u$ 对 $t$ 和 $x$ 的偏导数：\n$$u_t = \\frac{dU}{dz}\\frac{\\partial z}{\\partial t} = U'(z)\\left(-\\frac{c}{D}\\right) = -\\frac{c}{D}U'$$\n$$u_x = \\frac{dU}{dz}\\frac{\\partial z}{\\partial x} = U'(z)(1) = U'$$\n$$u_{xx} = \\frac{d}{dx}(U') = \\frac{dU'}{dz}\\frac{\\partial z}{\\partial x} = U''(z)(1) = U''$$\n将这些表达式代入 PDE，得到关于波形 $U(z)$ 的常微分方程 (ODE)：\n$$-\\frac{c}{D}U' = D U'' + f(U)$$\n整理各项，我们得到：\n$$D U'' + \\frac{c}{D} U' + f(U) = 0$$\n为了找到参数 $c$ 的表达式，我们将整个 ODE 乘以 $U'(z)$：\n$$D U'(z)U''(z) + \\frac{c}{D} (U'(z))^2 + f(U(z))U'(z) = 0$$\n我们可以将其中两项表示为关于 $z$ 的全导数：\n$$U'(z)U''(z) = \\frac{1}{2}\\frac{d}{dz}\\left((U'(z))^2\\right)$$\n$$f(U(z))U'(z) = \\frac{d}{dz}\\left(F(U(z))\\right)$$\n其中 $F(u) = \\int_{0}^{u}f(s)\\,ds$ 是势。于是 ODE 变为：\n$$\\frac{D}{2}\\frac{d}{dz}\\left((U'(z))^2\\right) + \\frac{c}{D}(U'(z))^2 + \\frac{d}{dz}\\left(F(U(z))\\right) = 0$$\n现在，我们将此方程对 $z$ 从 $-\\infty$ 到 $\\infty$ 积分：\n$$\\int_{-\\infty}^{\\infty} \\left( \\frac{D}{2}\\frac{d}{dz}\\left((U')^2\\right) + \\frac{c}{D}(U')^2 + \\frac{d}{dz}\\left(F(U)\\right) \\right) dz = 0$$\n根据积分的线性性质，这等于：\n$$\\frac{D}{2}\\int_{-\\infty}^{\\infty}\\frac{d}{dz}\\left((U')^2\\right)dz + \\frac{c}{D}\\int_{-\\infty}^{\\infty}(U')^2 dz + \\int_{-\\infty}^{\\infty}\\frac{d}{dz}\\left(F(U)\\right)dz = 0$$\n第一项和第三项可以使用微积分基本定理进行求值。我们使用波形 $U(z)$ 的边界条件：$U(-\\infty) = 1$ 和 $U(\\infty) = 0$。由于波形在无穷远处趋于常数值，其导数必须趋于零：$U'(-\\infty) = 0$ 和 $U'(\\infty) = 0$。\n第一项是：\n$$\\frac{D}{2}\\left[(U'(z))^2\\right]_{-\\infty}^{\\infty} = \\frac{D}{2}\\left((U'(\\infty))^2 - (U'(-\\infty))^2\\right) = \\frac{D}{2}(0 - 0) = 0$$\n第三项是：\n$$\\left[F(U(z))\\right]_{-\\infty}^{\\infty} = F(U(\\infty)) - F(U(-\\infty)) = F(0) - F(1)$$\n根据 $F(u)$ 的定义，我们有 $F(0) = \\int_{0}^{0}f(s)ds = 0$。所以该项变为 $-F(1) = -\\int_{0}^{1}f(u)du$。\n将这些结果代回积分后的方程中，得到：\n$$0 + \\frac{c}{D}\\int_{-\\infty}^{\\infty}(U'(z))^2 dz - \\int_{0}^{1}f(u)du = 0$$\n解出 $c$，我们得到通用的解析表达式：\n$$c = D \\frac{\\int_{0}^{1}f(u)du}{\\int_{-\\infty}^{\\infty}(U'(z))^2 dz}$$\n该表达式将波速参数 $c$ 与反应项的积分以及一个涉及波前形状的积分联系起来。$c$ 的符号决定了传播方向。由于 $D > 0$ 且波前是非平凡的（单调递减），$U'(z)$ 不恒为零，这意味着 $\\int_{-\\infty}^{\\infty}(U'(z))^2 dz > 0$。因此，$c$ 的符号完全由分子的符号决定：\n$$\\text{sign}(c) = \\text{sign}\\left(\\int_{0}^{1}f(u)du\\right)$$\n回顾 $\\int_{0}^{1}f(u)du = F(1) - F(0) = F(1)$， $c$ 的符号由 $F(1)$ 的符号决定。该项代表了两个稳定平衡态 $u=1$ 和 $u=0$ 之间的势 $F(u)$ 的差异。行波代表系统从一个较不稳定的状态过渡到一个更稳定的状态。\n-   如果 $F(1) > F(0) = 0$，则状态 $u=1$ 更稳定。$u=1$ 的区域扩张，侵入 $u=0$ 的区域。对于给定的波前 $U(-\\infty)=1$ 和 $U(\\infty)=0$，这对应于沿正 $x$ 方向的传播，因此波速 $v=c/D$ 为正，意味着 $c>0$。\n-   如果 $F(1)  F(0) = 0$，则状态 $u=0$ 更稳定。$u=0$ 的区域扩张。这对应于沿负 $x$ 方向的传播，因此 $v  0$ 且 $c  0$。\n-   如果 $F(1) = 0$，则两个状态同样稳定，波前是静止的 ($c=0$)。\n\n现在，我们将此应用于特定的三次动力学 $f(u) = k\\,u\\,(u - a)\\,(1 - u)$，其中 $k>0$ 且 $0  a  1$。首先，我们计算分子中的积分：\n$$\\int_{0}^{1} f(u) du = \\int_{0}^{1} k\\,u\\,(u - a)\\,(1 - u) du$$\n展开多项式：\n$$f(u) = k(u^2 - au)(1 - u) = k(u^2 - u^3 - au + au^2) = k(-u^3 + (1+a)u^2 - au)$$\n现在我们积分：\n$$\\int_{0}^{1} k(-u^3 + (1+a)u^2 - au) du = k \\left[ -\\frac{u^4}{4} + (1+a)\\frac{u^3}{3} - a\\frac{u^2}{2} \\right]_{0}^{1}$$\n$$= k \\left( -\\frac{1}{4} + \\frac{1+a}{3} - \\frac{a}{2} - 0 \\right)$$\n$$= k \\left( \\frac{-3 + 4(1+a) - 6a}{12} \\right) = k \\left( \\frac{-3 + 4 + 4a - 6a}{12} \\right) = k \\left( \\frac{1 - 2a}{12} \\right)$$\n所以，$\\int_{0}^{1}f(u)du = \\frac{k(1-2a)}{12}$。\n最后，我们将此结果代入我们关于 $c$ 的表达式中：\n$$c = D \\frac{\\frac{k(1-2a)}{12}}{\\int_{-\\infty}^{\\infty}(U'(z))^2 dz} = \\frac{Dk(1-2a)}{12\\int_{-\\infty}^{\\infty}(U'(z))^2 dz}$$\n$c$ 的符号由项 $(1 - 2a)$ 的符号决定，因为所有其他因子（$D$、$k$、$12$ 和积分）都是正的。\n-   如果 $a  1/2$，则 $1 - 2a > 0$，所以 $c > 0$。\n-   如果 $a > 1/2$，则 $1 - 2a  0$，所以 $c  0$。\n-   如果 $a = 1/2$，则 $1 - 2a = 0$，所以 $c = 0$。这对应于势相等的情况，$F(1)=0$。\n\n所要求的 $c$ 的最终表达式是：\n$$c = \\frac{Dk(1-2a)}{12\\int_{-\\infty}^{\\infty}(U'(z))^2 dz}$$",
            "answer": "$$\\boxed{\\frac{Dk(1-2a)}{12\\int_{-\\infty}^{\\infty} (U'(z))^{2}\\,dz}}$$"
        },
        {
            "introduction": "理论模型为了方便，通常使用连续的偏微分方程来描述生物组织。然而，像心脏这样的组织实际上是由离散的细胞构成的。本计算练习旨在探索这种离散性带来的重要后果。通过亲手建立并比较一个连续模型和一个离散模型，你将能够识别出连续近似失效的情境，并观察到在某些参数下波的传播会失败——这对于建立符合实际的生物医学模型至关重要。",
            "id": "3939467",
            "problem": "考虑一个一维空间中的可兴奋介质，其在连续尺度上由一个源于 Fick 扩散定律和守恒平衡的反应-扩散(RD)方程描述。令 $u(x,t)$ 表示一个无量纲的激活场，代表膜兴奋，其动力学由以下方程控制\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + f(u),\n$$\n其中 $D$ 是一个非负扩散系数，$f(u)$ 是一个模拟局部激活的反应项。假设采用广泛使用的三次非线性形式\n$$\nf(u) = u(u-a)(1-u),\n$$\n其中 $a \\in (0,1)$ 是参数化兴奋性的参数。在离散的细胞晶格尺度上，将同一介质建模为具有最近邻扩散耦合的相同单元链。令 $u_i(t)$ 表示晶格位置 $i$ 处的激活子，并令 $g$ 为非负耦合强度。该离散系统为\n$$\n\\frac{d u_i}{dt} = g\\left(u_{i+1} - 2 u_i + u_{i-1}\\right) + f(u_i).\n$$\n在两个模型的右边界处施加零通量(Neumann)边界条件。在连续模型中，使用零梯度条件 $\\frac{\\partial u}{\\partial x}(L,t)=0$。在离散模型中，通过反射邻居点在最后一个位置 $i=N_d-1$ 处施加一个等效的离散零通量条件：$u_{N_d}(t) = u_{N_d-2}(t)$。用左边界附近的局部刺激来初始化两个模型：对于 $x \\in [0,w]$，设置 $u(x,0)=1$，否则设置 $u(x,0)=0$；类似地，对于空间位置 $x_i$ 位于 $[0,w]$ 内的晶格点，设置 $u_i(0)=1$，其他地方则设置 $u_i(0)=0$。此处 $L$ 是域长度，$w$ 是刺激宽度。\n\n您的任务是编写一个程序，对于一组指定的参数，数值比较一个向右传播的行波在离散晶格及其连续RD近似模型中，是否成功传播到域的远端。对两个模型都使用显式前向欧拉时间步进方案，并用空间中心差分处理扩散项。为保证数值稳定性，选择满足显式方案标准稳定性判据的时间步长：在离散模型中，使用满足 $\\Delta t_{\\text{disc}} \\le c_{\\text{disc}} \\frac{h_d^2}{g}$ 的时间步长 $\\Delta t_{\\text{disc}}$；在连续模型中，使用满足 $\\Delta t_{\\text{cont}} \\le c_{\\text{cont}} \\frac{h_c^2}{D}$ 的时间步长 $\\Delta t_{\\text{cont}}$，其中 $h_d$ 和 $h_c$ 分别是离散和连续空间步长，而 $c_{\\text{disc}}$ 和 $c_{\\text{cont}}$ 是严格小于 $0.5$ 的正安全因子。在两个模型中，每次更新后将 $u$ 的值限制在 $[0,1]$ 范围内。在比较模型时，将离散耦合 $g$ 视为连续扩散系数 $D$，即每次测试都设置 $D=g$。\n\n波传播成功的定义如下：如果在最终时间 $T$ 时，最右边界的激活子超过阈值 $u_{\\text{thr}}$，则认为波是成功的。具体来说，在连续模型中检查 $u(L,T) \\ge u_{\\text{thr}}$，在离散模型中检查 $u_{N_d-1}(T) \\ge u_{\\text{thr}}$。对于每个测试用例，报告一个布尔值对 $[d,c]$，其中如果离散晶格模型成功，则 $d$ 为 $\\text{True}$，否则为 $\\text{False}$；如果连续RD模型成功，则 $c$ 为 $\\text{True}$，否则为 $\\text{False}$。\n\n实现以下无量纲的数值配置：\n- 域长度 $L = 50$。\n- 离散晶格间距 $h_d = 1$，得到 $N_d = \\lfloor L/h_d \\rfloor + 1$ 个晶格点。\n- 连续网格间距 $h_c = 0.25$，得到 $N_c = \\lfloor L/h_c \\rfloor + 1$ 个网格点。\n- 刺激宽度 $w = 5$。\n- 阈值 $u_{\\text{thr}} = 0.7$。\n- 最终时间 $T = 120$。\n- 用于稳定性的安全因子 $c_{\\text{disc}} = 0.45$ 和 $c_{\\text{cont}} = 0.45$。\n\n您的程序必须在相同的初始条件和边界条件下实现这两个模型，将它们数值演化到时间 $T$，并按上述定义评估成功与否。\n\n测试套件：\n为以下参数集 $(a,g)$ 提供结果，这些参数用离散耦合 $g$ 和兴奋性参数 $a$ 表示，其中连续扩散系数设置为 $D=g$：\n- 情况 1：$a = 0.45$，$g = 0.05$。\n- 情况 2：$a = 0.45$，$g = 0.5$。\n- 情况 3：$a = 0.55$，$g = 0.5$。\n- 情况 4：$a = 0.495$，$g = 0.05$。\n- 情况 5：$a = 0.30$，$g = 0.02$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每一项是对应一个测试用例的双元素列表 $[d,c]$。例如，输出格式必须类似于 $[[d_1,c_1],[d_2,c_2],\\dots]$，其中每个 $d_k$ 和 $c_k$ 为 $\\text{True}$ 或 $\\text{False}$。输出是无量纲的；不需要物理单位。不出现角度。不出现百分比。",
            "solution": "该任务要求开发一个程序，对一维可兴奋介质中的两种波传播模型进行数值模拟和比较：一个连续的反应-扩散(RD)模型和一个离散的晶格模型。对于给定的几组参数，最终输出是一个布尔值对的列表，指示行波在每个模型中是否成功传播到域的末端。\n\n该解决方案通过为每个模型创建独立的数值求解器来实现，然后对每个指定的测试用例执行它们。\n\n### 1. 连续反应-扩散(RD)模型\n\n连续模型由偏微分方程(PDE)描述：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + f(u)\n$$\n其中三次反应项为 $f(u) = u(u-a)(1-u)$。我们通过对空间和时间进行离散化来数值求解此方程。\n\n**空间离散化**：我们将长度为 $L$ 的空间域离散为 $N_c = \\lfloor L/h_c \\rfloor + 1$ 个网格点，索引为 $j=0, 1, \\dots, N_c-1$。二阶空间导数使用中心差分格式进行近似：\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x_j} \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h_c^2}\n$$\n\n**时间离散化**：使用显式前向欧拉方法进行时间步进：\n$$\nu_j^{n+1} = u_j^n + \\Delta t_{\\text{cont}} \\left( D \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{h_c^2} + f(u_j^n) \\right)\n$$\n\n**边界条件**：在左右两个边界（$j=0$ 和 $j=N_c-1$）均施加零通量（诺伊曼）边界条件。这通过引入满足 $u_{-1} = u_1$ 和 $u_{N_c} = u_{N_c-2}$ 的“虚拟点”来实现。\n\n### 2. 离散晶格模型\n\n离散模型是一个耦合常微分方程(ODE)组：\n$$\n\\frac{d u_i}{dt} = g\\left(u_{i+1} - 2 u_i + u_{i-1}\\right) + f(u_i)\n$$\n对于 $N_d = \\lfloor L/h_d \\rfloor + 1$ 个晶格点，索引为 $i=0, 1, \\dots, N_d-1$。\n\n**时间离散化**：同样应用前向欧拉方法：\n$$\nu_i^{n+1} = u_i^n + \\Delta t_{\\text{disc}} \\left( g(u_{i+1}^n - 2u_i^n + u_{i-1}^n) + f(u_i^n) \\right)\n$$\n\n**边界条件**：\n- 右边界（$i=N_d-1$）的边界条件明确给出为 $u_{N_d} = u_{N_d-2}$。\n- 左边界（$i=0$）假设采用对称的零通量条件，即 $u_{-1}=u_1$。\n\n### 3. 数值实现细节\n\n**稳定性**：为保证数值稳定性，两个模型的时间步长均根据问题中给出的标准选取：$\\Delta t = c \\frac{h^2}{\\text{coeff}}$，其中 `coeff` 是扩散/耦合常数（$D$ 或 $g$），$c$ 是一个安全因子（$0.45$）。\n\n**算法流程**：\n1. 对于每个测试用例 $(a, g)$，设置连续扩散系数 $D=g$。\n2. **离散模型模拟**：\n   a. 初始化参数并计算点数 $N_d$ 和时间步长 $\\Delta t_{\\text{disc}}$。\n   b. 根据刺激宽度 $w$ 设置初始状态数组。\n   c. 在时间上进行循环，根据欧拉公式和边界条件更新所有 $u_i$。\n   d. 每次更新后，将 $u$ 的值裁剪到区间 $[0,1]$ 内。\n   e. 模拟结束后，检查最右侧点的激活值是否超过阈值，并存储布尔结果。\n3. **连续模型模拟**：\n   a. 初始化参数并计算网格点数 $N_c$ 和时间步长 $\\Delta t_{\\text{cont}}$。\n   b. 设置初始状态数组。\n   c. 实施时间循环，应用离散化的PDE更新规则和诺伊曼边界条件。\n   d. 裁剪 $u$ 的值。\n   e. 模拟结束后，检查最右侧点的激活值并存储布尔结果。\n4. 收集所有测试用例的布尔结果对 $[d, c]$，并按指定格式输出。\n\n此过程被封装在一个使用 `numpy` 库进行高效数组操作的 Python 脚本中。",
            "answer": "```python\nimport numpy as np\n\ndef run_discrete_model(param_a, param_g, L, w, u_thr, T, c_disc, h_d):\n    \"\"\"\n    Simulates the discrete lattice model.\n    \"\"\"\n    N_d = int(L / h_d) + 1\n    \n    if param_g = 1e-9:\n        # No coupling, wave cannot propagate.\n        return False\n    \n    dt = c_disc * (h_d**2) / param_g\n    n_steps = int(T / dt)\n\n    if n_steps == 0:\n        return False # Not enough time to evolve\n\n    # Initial condition\n    u = np.zeros(N_d)\n    x_coords = np.arange(N_d) * h_d\n    u[x_coords = w] = 1.0\n\n    # Reaction function\n    def f(u_vec, a):\n        return u_vec * (u_vec - a) * (1.0 - u_vec)\n\n    # Time evolution using Forward Euler\n    for _ in range(n_steps):\n        u_old = u.copy()\n        f_u = f(u_old, param_a)\n\n        # Interior points (vectorized)\n        laplacian = u_old[2:] - 2 * u_old[1:-1] + u_old[:-2]\n        u[1:-1] = u_old[1:-1] + dt * (param_g * laplacian + f_u[1:-1])\n\n        # Boundary conditions (zero-flux)\n        # Left boundary i=0: Assumed zero-flux, u_{-1} = u_{1}\n        laplacian_0 = 2 * (u_old[1] - u_old[0])\n        u[0] = u_old[0] + dt * (param_g * laplacian_0 + f_u[0])\n\n        # Right boundary i=N_d-1: Using given rule u_{N_d} = u_{N_d-2}\n        laplacian_end = 2 * (u_old[N_d - 2] - u_old[N_d - 1])\n        u[N_d - 1] = u_old[N_d - 1] + dt * (param_g * laplacian_end + f_u[N_d - 1])\n        \n        # Clip values to [0, 1]\n        np.clip(u, 0.0, 1.0, out=u)\n\n    # Check for success\n    return u[N_d - 1] = u_thr\n\ndef run_continuum_model(param_a, D, L, w, u_thr, T, c_cont, h_c):\n    \"\"\"\n    Simulates the continuum Reaction-Diffusion model.\n    \"\"\"\n    N_c = int(L / h_c) + 1\n    \n    if D = 1e-9:\n        # No diffusion, wave cannot propagate.\n        return False\n        \n    dt = c_cont * (h_c**2) / D\n    n_steps = int(T / dt)\n\n    if n_steps == 0:\n        return False # Not enough time to evolve\n\n    # Initial condition\n    u = np.zeros(N_c)\n    x_coords = np.arange(N_c) * h_c\n    u[x_coords = w] = 1.0\n\n    # Reaction function\n    def f(u_vec, a):\n        return u_vec * (u_vec - a) * (1.0 - u_vec)\n\n    # Time evolution using Forward Euler\n    h_c_sq = h_c**2\n    for _ in range(n_steps):\n        u_old = u.copy()\n        f_u = f(u_old, param_a)\n\n        # Interior points (vectorized)\n        laplacian = (u_old[2:] - 2 * u_old[1:-1] + u_old[:-2]) / h_c_sq\n        u[1:-1] = u_old[1:-1] + dt * (D * laplacian + f_u[1:-1])\n\n        # Boundary conditions (zero-flux, ∂u/∂x=0) implemented with ghost points\n        # Left boundary j=0: u_{-1} = u_{1}\n        laplacian_0 = 2 * (u_old[1] - u_old[0]) / h_c_sq\n        u[0] = u_old[0] + dt * (D * laplacian_0 + f_u[0])\n        \n        # Right boundary j=N_c-1: u_{N_c} = u_{N_c-2}\n        laplacian_end = 2 * (u_old[N_c - 2] - u_old[N_c - 1]) / h_c_sq\n        u[N_c - 1] = u_old[N_c - 1] + dt * (D * laplacian_end + f_u[N_c - 1])\n        \n        # Clip values to [0, 1]\n        np.clip(u, 0.0, 1.0, out=u)\n\n    # Check for success\n    return u[N_c - 1] = u_thr\n\ndef solve():\n    # Define problem constants from the statement\n    L = 50.0\n    w = 5.0\n    u_thr = 0.7\n    T = 120.0\n    c_disc = 0.45\n    c_cont = 0.45\n    h_d = 1.0\n    h_c = 0.25\n\n    # Test cases: (a, g)\n    test_cases = [\n        (0.45, 0.05),\n        (0.45, 0.5),\n        (0.55, 0.5),\n        (0.495, 0.05),\n        (0.30, 0.02),\n    ]\n\n    results = []\n    for a, g in test_cases:\n        # Run discrete model simulation\n        d_success = run_discrete_model(a, g, L, w, u_thr, T, c_disc, h_d)\n        \n        # Run continuum model simulation (D=g)\n        c_success = run_continuum_model(a, g, L, w, u_thr, T, c_cont, h_c)\n        \n        results.append([d_success, c_success])\n    \n    # Format the final output string to be exactly [[d1,c1],[d2,c2],...]\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}