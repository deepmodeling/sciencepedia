{
    "hands_on_practices": [
        {
            "introduction": "The behavior of a traveling wave is fundamentally dictated by the local reaction kinetics of the medium. Before we can analyze spatial patterns, we must first understand the non-spatial system by setting diffusion to zero. This practice guides you through the analysis of the Barkley model, a cornerstone for studying excitable media, by classifying its dynamics based on its equilibria and their stability, which lays the groundwork for defining monostable, bistable, and excitable regimes. ",
            "id": "3939539",
            "problem": "Consider a Barkley-type activator-inhibitor model for excitable media relevant to cardiac or neural tissue, with fast activator field $u(x,t)$ and slow inhibitor field $v(x,t)$:\n$$\n\\partial_t u \\;=\\; \\frac{1}{\\varepsilon}\\,u\\,(1-u)\\,(u-a)\\;-\\;v\\;+\\;D_u\\,\\nabla^2 u,\\qquad\n\\partial_t v \\;=\\; u\\;-\\;b\\,v\\;+\\;D_v\\,\\nabla^2 v,\n$$\nwhere $0\\varepsilon\\ll 1$ is a fast-slow time-scale ratio, $a\\in(0,1)$ is the excitability threshold parameter, $b0$ sets inhibitor recovery, and $D_u\\ge 0$, $D_v\\ge 0$ are diffusion coefficients. Assume spatially uniform equilibria for classification of local kinetics. The notions of monostable, bistable, and excitable regimes are defined by the number and stability of spatially uniform equilibria of the reaction subsystem (i.e., with $D_u=D_v=0$): monostable means a unique stable equilibrium, bistable means two stable equilibria separated by an unstable equilibrium, and excitable refers to a monostable regime with a fast-slow threshold nonlinearity that can support traveling pulses once diffusion is reinstated.\n\nStarting only from core definitions of equilibria, Jacobian linearization, and linear stability for planar systems, do the following:\n\n- Identify the spatially uniform rest state with the smallest activator value and compute the Jacobian matrix of the reaction subsystem at this rest state.\n- Determine the parameter conditions under which the reaction subsystem has one equilibrium versus three equilibria, and use linear stability to distinguish monostable versus bistable regimes. Explicitly state the condition that delineates the excitable regime.\n- Report, as your final answer, the closed-form analytic expression of the codimension-one boundary in the $(a,b,\\varepsilon)$-space at which a saddle-node bifurcation creates or annihilates the two nontrivial equilibria of the reaction subsystem, thereby separating the monostable excitable regime from the bistable regime.\n\nNo numerical evaluation is required. Express your final answer as a single analytic expression in terms of $a$ and $b$ for the critical value $\\varepsilon_c(a,b)$. Do not include units.",
            "solution": "The problem asks for an analysis of the spatially uniform dynamics of a Barkley-type activator-inhibitor model and the derivation of the bifurcation boundary separating monostable and bistable regimes. The analysis begins with the reaction subsystem, where the diffusion coefficients are set to zero ($D_u = 0$, $D_v = 0$).\n\nThe reaction subsystem is governed by the following system of ordinary differential equations:\n$$\n\\frac{du}{dt} = \\frac{1}{\\varepsilon}u(1-u)(u-a) - v \\equiv f(u,v)\n$$\n$$\n\\frac{dv}{dt} = u - bv \\equiv g(u,v)\n$$\nSpatially uniform equilibria, or fixed points $(u^*, v^*)$, are states where the system does not change in time, i.e., $\\frac{du}{dt}=0$ and $\\frac{dv}{dt}=0$. These conditions define the nullclines of the system.\n\nThe $v$-nullcline is found from $\\frac{dv}{dt}=0$:\n$$\nu - bv = 0 \\implies v = \\frac{u}{b}\n$$\nThis is a straight line passing through the origin with a positive slope $1/b$.\n\nThe $u$-nullcline is found from $\\frac{du}{dt}=0$:\n$$\n\\frac{1}{\\varepsilon}u(1-u)(u-a) - v = 0 \\implies v = \\frac{1}{\\varepsilon}u(1-u)(u-a)\n$$\nThis is a cubic function of $u$ with roots at $u=0$, $u=a$, and $u=1$. Since $0  a  1$, this cubic function has the characteristic \"N\"-shape.\n\nThe equilibria are the intersection points of these two nullclines. To find the $u$-coordinates of the equilibria, we set the expressions for $v$ equal to each other:\n$$\n\\frac{u}{b} = \\frac{1}{\\varepsilon}u(1-u)(u-a)\n$$\nThis equation can be rewritten as:\n$$\nu \\left( \\frac{1}{b} - \\frac{1}{\\varepsilon}(1-u)(u-a) \\right) = 0\n$$\nOne immediate solution is $u=0$. Substituting this into the $v$-nullcline equation, $v=u/b$, gives $v=0$. Thus, $(u,v)=(0,0)$ is always an equilibrium of the system. This corresponds to the rest state with the smallest activator value.\n\nThe first task is to compute the Jacobian matrix of the reaction subsystem at this rest state. The Jacobian matrix $J(u,v)$ is given by:\n$$\nJ(u,v) = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial f}{\\partial u} = \\frac{d}{du}\\left[\\frac{1}{\\varepsilon}(-u^3 + (1+a)u^2 - au)\\right] = \\frac{1}{\\varepsilon}(-3u^2 + 2(1+a)u - a)\n$$\n$$\n\\frac{\\partial f}{\\partial v} = -1\n$$\n$$\n\\frac{\\partial g}{\\partial u} = 1\n$$\n$$\n\\frac{\\partial g}{\\partial v} = -b\n$$\nEvaluating the Jacobian at the equilibrium point $(0,0)$:\n$$\nJ(0,0) = \\begin{pmatrix} \\frac{1}{\\varepsilon}(-a)  -1 \\\\ 1  -b \\end{pmatrix} = \\begin{pmatrix} -\\frac{a}{\\varepsilon}  -1 \\\\ 1  -b \\end{pmatrix}\n$$\nTo confirm that this is a stable rest state, we analyze its linear stability. The trace ($\\tau$) and determinant ($\\Delta$) of the Jacobian are:\n$$\n\\tau = \\text{Tr}(J(0,0)) = -\\frac{a}{\\varepsilon} - b\n$$\n$$\n\\Delta = \\det(J(0,0)) = \\left(-\\frac{a}{\\varepsilon}\\right)(-b) - (-1)(1) = \\frac{ab}{\\varepsilon} + 1\n$$\nGiven the parameter constraints $a0$, $b0$, and $\\varepsilon0$, the trace is always negative ($\\tau0$) and the determinant is always positive ($\\Delta0$). These conditions guarantee that the equilibrium at $(0,0)$ is always stable (a stable node or a stable focus).\n\nNext, we address the second task: determining the conditions for one versus three equilibria. The remaining equilibria are found from the other factor of the equilibrium equation:\n$$\n\\frac{1}{b} = \\frac{1}{\\varepsilon}(1-u)(u-a) \\implies \\frac{\\varepsilon}{b} = -u^2 + (1+a)u - a\n$$\nRearranging this into a standard quadratic form gives:\n$$\nu^2 - (1+a)u + \\left(a + \\frac{\\varepsilon}{b}\\right) = 0\n$$\nThe number of real solutions for $u$ is determined by the sign of the discriminant, $D$, of this quadratic equation:\n$$\nD = (-(1+a))^2 - 4(1)\\left(a + \\frac{\\varepsilon}{b}\\right) = (1+a)^2 - 4a - \\frac{4\\varepsilon}{b} = 1 + 2a + a^2 - 4a - \\frac{4\\varepsilon}{b}\n$$\n$$\nD = (1-a)^2 - \\frac{4\\varepsilon}{b}\n$$\nThere are three cases based on the sign of $D$:\n1.  If $D0$, i.e., $(1-a)^2  \\frac{4\\varepsilon}{b}$, there are two distinct real positive roots for $u$. Including the $u=0$ root, the system has a total of three equilibria. This corresponds to the **bistable regime**, where the system has two stable equilibria (the lowest one at $(0,0)$ and the highest one) separated by an unstable (saddle) equilibrium.\n2.  If $D0$, i.e., $(1-a)^2  \\frac{4\\varepsilon}{b}$, there are no real roots for $u$ other than $u=0$. The system has only one equilibrium, $(0,0)$. This is the **monostable regime**.\n3.  If $D=0$, i.e., $(1-a)^2 = \\frac{4\\varepsilon}{b}$, there is one real root of multiplicity two for $u \\ne 0$. This is the borderline case, corresponding to a saddle-node bifurcation.\n\nThe term **excitable regime** refers to the monostable case where the underlying fast-slow dynamics and N-shaped nullcline can produce a large transient excursion (a pulse) in response to a superthreshold perturbation, before returning to the single stable rest state. Thus, the condition for the excitable regime is the same as for the monostable regime:\n$$\n(1-a)^2  \\frac{4\\varepsilon}{b} \\quad \\text{or equivalently} \\quad \\varepsilon  \\frac{b(1-a)^2}{4}\n$$\n\nFinally, the third task is to find the closed-form analytic expression for the codimension-one boundary in $(a,b,\\varepsilon)$-space that separates the monostable (excitable) and bistable regimes. This boundary is precisely the bifurcation point where the two nontrivial equilibria are created or annihilated. This occurs when the discriminant $D$ is zero:\n$$\nD = (1-a)^2 - \\frac{4\\varepsilon}{b} = 0\n$$\nSolving this equation for the critical value of $\\varepsilon$, denoted as $\\varepsilon_c(a,b)$, gives the expression for the saddle-node bifurcation boundary:\n$$\n\\varepsilon_c(a,b) = \\frac{b(1-a)^2}{4}\n$$\nThis expression defines the surface in the parameter space $(a,b,\\varepsilon)$ that separates the region with one equilibrium (monostable/excitable) from the region with three equilibria (bistable).",
            "answer": "$$\\boxed{\\frac{b(1-a)^2}{4}}$$"
        },
        {
            "introduction": "Having established the local properties of a reactive medium, we can now investigate how these properties govern the propagation of a traveling front. This exercise focuses on a bistable system and challenges you to derive one of the most fundamental results in reaction-diffusion theory: an expression for the wave speed. By completing this derivation, you will uncover the elegant relationship between the front's velocity and the potential energy difference between the two stable states of the medium. ",
            "id": "3939546",
            "problem": "Consider a one-dimensional reactive medium model for a normalized transmembrane potential in cardiac tissue given by the partial differential equation (PDE) $u_{t} = D\\,u_{xx} + f(u)$, where $D  0$ is the diffusion coefficient and $f(u)$ is a bistable reaction term with equilibrium states at $u = 0$ and $u = 1$. Assume a traveling front solution $u(x,t) = U(z)$ that is monotone decreasing and connects $U(-\\infty) = 1$ to $U(\\infty) = 0$. Use the traveling coordinate $z = x - \\frac{c}{D}\\,t$, where $c$ is a constant parameter to be determined.\n\nStarting only from the PDE, the traveling-wave ansatz, standard calculus identities, and the boundary behavior of $U(z)$ as $z \\to \\pm \\infty$, derive an analytical expression for the parameter $c$ in terms of spatial integrals involving $U$ and the signed area under $f(u)$ between $u = 0$ and $u = 1$. Then, explain how the sign of $c$ is determined by the imbalance in the potential defined by $F(u) = \\int_{0}^{u} f(s)\\,ds$ between the stable equilibria.\n\nTo ground the derivation in a concrete biomedical kinetics, take the reaction term to be the cubic kinetics $f(u) = k\\,u\\,(u - a)\\,(1 - u)$, where $0  a  1$ and $k  0$ is a rate constant. Compute the integral $\\int_{0}^{1} f(u)\\,du$ explicitly in terms of $a$ and $k$, and provide the final analytical expression for $c$ in terms of $D$, $k$, $a$, and $\\int_{-\\infty}^{\\infty} (U'(z))^{2}\\,dz$. No numerical evaluation is required. State clearly how the sign of $c$ depends on $a$.\n\nYour final answer must be a single closed-form analytical expression for $c$. Do not include any units in your final boxed answer.",
            "solution": "We begin with the given partial differential equation (PDE):\n$$u_{t} = D\\,u_{xx} + f(u)$$\nWe seek a traveling wave solution of the form $u(x,t) = U(z)$, where the traveling coordinate is $z = x - \\frac{c}{D} t$. We compute the partial derivatives of $u$ with respect to $t$ and $x$ using the chain rule:\n$$u_t = \\frac{dU}{dz}\\frac{\\partial z}{\\partial t} = U'(z)\\left(-\\frac{c}{D}\\right) = -\\frac{c}{D}U'$$\n$$u_x = \\frac{dU}{dz}\\frac{\\partial z}{\\partial x} = U'(z)(1) = U'$$\n$$u_{xx} = \\frac{d}{dx}(U') = \\frac{dU'}{dz}\\frac{\\partial z}{\\partial x} = U''(z)(1) = U''$$\nSubstituting these expressions into the PDE yields an ordinary differential equation (ODE) for the wave profile $U(z)$:\n$$-\\frac{c}{D}U' = D U'' + f(U)$$\nRearranging the terms, we get:\n$$D U'' + \\frac{c}{D} U' + f(U) = 0$$\nTo find an expression for the parameter $c$, we multiply this entire ODE by $U'(z)$:\n$$D U'(z)U''(z) + \\frac{c}{D} (U'(z))^2 + f(U(z))U'(z) = 0$$\nWe can express two of the terms as exact derivatives with respect to $z$:\n$$U'(z)U''(z) = \\frac{1}{2}\\frac{d}{dz}\\left((U'(z))^2\\right)$$\n$$f(U(z))U'(z) = \\frac{d}{dz}\\left(F(U(z))\\right)$$\nwhere $F(u) = \\int_{0}^{u}f(s)\\,ds$ is the potential. The ODE then becomes:\n$$\\frac{D}{2}\\frac{d}{dz}\\left((U'(z))^2\\right) + \\frac{c}{D}(U'(z))^2 + \\frac{d}{dz}\\left(F(U(z))\\right) = 0$$\nNow, we integrate this equation with respect to $z$ from $-\\infty$ to $\\infty$:\n$$\\int_{-\\infty}^{\\infty} \\left( \\frac{D}{2}\\frac{d}{dz}\\left((U')^2\\right) + \\frac{c}{D}(U')^2 + \\frac{d}{dz}\\left(F(U)\\right) \\right) dz = 0$$\nBy the linearity of integration, this is:\n$$\\frac{D}{2}\\int_{-\\infty}^{\\infty}\\frac{d}{dz}\\left((U')^2\\right)dz + \\frac{c}{D}\\int_{-\\infty}^{\\infty}(U')^2 dz + \\int_{-\\infty}^{\\infty}\\frac{d}{dz}\\left(F(U)\\right)dz = 0$$\nThe first and third terms can be evaluated using the Fundamental Theorem of Calculus. We use the boundary conditions for the profile $U(z)$: $U(-\\infty) = 1$ and $U(\\infty) = 0$. Since the profile approaches constant values at infinity, its derivative must approach zero: $U'(-\\infty) = 0$ and $U'(\\infty) = 0$.\nThe first term is:\n$$\\frac{D}{2}\\left[(U'(z))^2\\right]_{-\\infty}^{\\infty} = \\frac{D}{2}\\left((U'(\\infty))^2 - (U'(-\\infty))^2\\right) = \\frac{D}{2}(0 - 0) = 0$$\nThe third term is:\n$$\\left[F(U(z))\\right]_{-\\infty}^{\\infty} = F(U(\\infty)) - F(U(-\\infty)) = F(0) - F(1)$$\nFrom the definition of $F(u)$, we have $F(0) = \\int_{0}^{0}f(s)ds = 0$. So the term becomes $-F(1) = -\\int_{0}^{1}f(u)du$.\nSubstituting these results back into the integrated equation gives:\n$$0 + \\frac{c}{D}\\int_{-\\infty}^{\\infty}(U'(z))^2 dz - \\int_{0}^{1}f(u)du = 0$$\nSolving for $c$, we obtain the general analytical expression:\n$$c = D \\frac{\\int_{0}^{1}f(u)du}{\\int_{-\\infty}^{\\infty}(U'(z))^2 dz}$$\nThis expression relates the wave speed parameter $c$ to an integral of the reaction term and an integral involving the shape of the wave front.\nThe sign of $c$ determines the direction of propagation. Since $D  0$ and the front is non-trivial (monotone decreasing), $U'(z)$ is not identically zero, meaning $\\int_{-\\infty}^{\\infty}(U'(z))^2 dz  0$. Therefore, the sign of $c$ is determined entirely by the sign of the numerator:\n$$\\text{sign}(c) = \\text{sign}\\left(\\int_{0}^{1}f(u)du\\right)$$\nRecalling that $\\int_{0}^{1}f(u)du = F(1) - F(0) = F(1)$, the sign of $c$ is determined by the sign of $F(1)$. This term represents the difference in the potential $F(u)$ between the two stable equilibrium states $u=1$ and $u=0$. The traveling wave represents the system transitioning from a less stable state to a more stable state. The more stable state has a higher value of the potential $F(u)$.\n-   If $F(1)  F(0) = 0$, the state $u=1$ is more stable. The region where $u=1$ expands, invading the region where $u=0$. For the given front with $U(-\\infty)=1$ and $U(\\infty)=0$, this corresponds to propagation in the positive $x$ direction, so the wave speed $v=c/D$ is positive, implying $c0$.\n-   If $F(1)  F(0) = 0$, the state $u=0$ is more stable. The region where $u=0$ expands. This corresponds to propagation in the negative $x$ direction, so $v  0$ and $c  0$.\n-   If $F(1) = 0$, the two states are equally stable, and the front is stationary ($c=0$).\n\nNow, we apply this to the specific cubic kinetics $f(u) = k\\,u\\,(u - a)\\,(1 - u)$, with $k0$ and $0  a  1$. First, we compute the integral in the numerator:\n$$\\int_{0}^{1} f(u) du = \\int_{0}^{1} k\\,u\\,(u - a)\\,(1 - u) du$$\nExpanding the polynomial:\n$$f(u) = k(u^2 - au)(1 - u) = k(u^2 - u^3 - au + au^2) = k(-u^3 + (1+a)u^2 - au)$$\nNow we integrate:\n$$\\int_{0}^{1} k(-u^3 + (1+a)u^2 - au) du = k \\left[ -\\frac{u^4}{4} + (1+a)\\frac{u^3}{3} - a\\frac{u^2}{2} \\right]_{0}^{1}$$\n$$= k \\left( -\\frac{1}{4} + \\frac{1+a}{3} - \\frac{a}{2} - 0 \\right)$$\n$$= k \\left( \\frac{-3 + 4(1+a) - 6a}{12} \\right) = k \\left( \\frac{-3 + 4 + 4a - 6a}{12} \\right) = k \\left( \\frac{1 - 2a}{12} \\right)$$\nSo, $\\int_{0}^{1}f(u)du = \\frac{k(1-2a)}{12}$.\nFinally, we substitute this result into our expression for $c$:\n$$c = D \\frac{\\frac{k(1-2a)}{12}}{\\int_{-\\infty}^{\\infty}(U'(z))^2 dz} = \\frac{Dk(1-2a)}{12\\int_{-\\infty}^{\\infty}(U'(z))^2 dz}$$\nThe sign of $c$ is determined by the sign of the term $(1 - 2a)$, since all other factors ($D$, $k$, $12$, and the integral) are positive.\n-   If $a  1/2$, then $1 - 2a  0$, so $c  0$.\n-   If $a  1/2$, then $1 - 2a  0$, so $c  0$.\n-   If $a = 1/2$, then $1 - 2a = 0$, so $c = 0$. This corresponds to the case of equal potential, $F(1)=0$.\n\nThe final expression for $c$ as requested is:\n$$c = \\frac{Dk(1-2a)}{12\\int_{-\\infty}^{\\infty}(U'(z))^2 dz}$$",
            "answer": "$$\\boxed{\\frac{Dk(1-2a)}{12\\int_{-\\infty}^{\\infty} (U'(z))^{2}\\,dz}}$$"
        },
        {
            "introduction": "Analytical models often treat biological tissue as a continuous medium, but at the cellular level, it is fundamentally discrete. This computational exercise allows you to explore the profound consequences of this distinction by implementing and comparing a continuum reaction-diffusion equation with its discrete lattice counterpart. You will investigate the phenomenon of propagation failure—a critical behavior where discreteness can halt a wave that would otherwise propagate in a continuum model, revealing the limitations of continuum approximations. ",
            "id": "3939467",
            "problem": "Consider an excitable medium in one spatial dimension described at the continuum scale by a Reaction–Diffusion (RD) equation derived from Fick's law of diffusion and a conservation balance. Let $u(x,t)$ denote a dimensionless activator field representing membrane excitation, with dynamics governed by\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + f(u),\n$$\nwhere $D$ is a nonnegative diffusion coefficient and $f(u)$ is a reaction term modeling local activation. Assume the widely used cubic nonlinearity\n$$\nf(u) = u(u-a)(1-u),\n$$\nwhere $a \\in (0,1)$ parameterizes excitability. At the discrete, cell-lattice scale, model the same medium as a chain of identical units with nearest-neighbor diffusive coupling. Let $u_i(t)$ denote the activator at lattice site $i$, and let $g$ be the nonnegative coupling strength. The discrete system is\n$$\n\\frac{d u_i}{dt} = g\\left(u_{i+1} - 2 u_i + u_{i-1}\\right) + f(u_i).\n$$\nImpose zero-flux (Neumann) boundary conditions at the right boundary in both models. In the continuum model, use the zero-gradient condition $\\frac{\\partial u}{\\partial x}(L,t)=0$. In the discrete model, enforce an equivalent discrete zero-flux condition at the last site $i=N_d-1$ by reflecting the neighbor: $u_{N_d}(t) = u_{N_d-2}(t)$. Initialize both models with a localized stimulus near the left boundary: set $u(x,0)=1$ for $x \\in [0,w]$ and $u(x,0)=0$ otherwise, and analogously set $u_i(0)=1$ for lattice sites whose spatial positions $x_i$ lie in $[0,w]$ and $u_i(0)=0$ elsewhere. Here $L$ is the domain length and $w$ is the stimulus width.\n\nYour task is to write a program that, for a specified set of parameters, numerically compares whether a rightward traveling wave successfully propagates to the far end of the domain in both the discrete lattice and its continuum RD approximation. Use explicit forward Euler time stepping schemes for both models with spatial central differences for diffusion. For numerical stability, choose time steps that satisfy the standard stability criteria for explicit schemes: in the discrete model, use a time step $\\Delta t_{\\text{disc}}$ satisfying $\\Delta t_{\\text{disc}} \\le c_{\\text{disc}} \\frac{h_d^2}{g}$, and in the continuum model, use a time step $\\Delta t_{\\text{cont}}$ satisfying $\\Delta t_{\\text{cont}} \\le c_{\\text{cont}} \\frac{h_c^2}{D}$, where $h_d$ and $h_c$ are the discrete and continuum spatial spacings, respectively, and $c_{\\text{disc}}$ and $c_{\\text{cont}}$ are positive safety factors strictly less than $0.5$. In both models, clip $u$ to remain in $[0,1]$ after each update. Treat the discrete coupling $g$ as the continuum diffusion $D$ when comparing models, i.e., set $D=g$ for each test.\n\nDefine wave success as follows: a wave is deemed successful if the activator at the far right boundary exceeds a threshold $u_{\\text{thr}}$ by the final time $T$. Concretely, check $u(L,T) \\ge u_{\\text{thr}}$ in the continuum model and $u_{N_d-1}(T) \\ge u_{\\text{thr}}$ in the discrete model. Report, for each test case, a pair of booleans $[d,c]$, where $d$ is $\\text{True}$ if the discrete lattice exhibits success and $\\text{False}$ otherwise, and $c$ is $\\text{True}$ if the continuum RD exhibits success and $\\text{False}$ otherwise.\n\nImplement the following numerical configuration, which is dimensionless:\n- Domain length $L = 50$.\n- Discrete lattice spacing $h_d = 1$, giving $N_d = \\lfloor L/h_d \\rfloor + 1$ lattice sites.\n- Continuum grid spacing $h_c = 0.25$, giving $N_c = \\lfloor L/h_c \\rfloor + 1$ grid points.\n- Stimulus width $w = 5$.\n- Threshold $u_{\\text{thr}} = 0.7$.\n- Final time $T = 120$.\n- Safety factors $c_{\\text{disc}} = 0.45$ and $c_{\\text{cont}} = 0.45$ for stability.\n\nYour program must implement both models under the same initial conditions and boundary conditions, numerically evolve them to time $T$, and evaluate success as defined above.\n\nTest suite:\nProvide results for the following parameter sets $(a,g)$, expressed in the discrete coupling $g$ and the excitability parameter $a$, with the continuum diffusion set to $D=g$:\n- Case $1$: $a = 0.45$, $g = 0.05$.\n- Case $2$: $a = 0.45$, $g = 0.5$.\n- Case $3$: $a = 0.55$, $g = 0.5$.\n- Case $4$: $a = 0.495$, $g = 0.05$.\n- Case $5$: $a = 0.30$, $g = 0.02$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is the two-element list $[d,c]$ for one test case. For example, the output format must be like $[[d_1,c_1],[d_2,c_2],\\dots]$ where each $d_k$ and $c_k$ is either $\\text{True}$ or $\\text{False}$. The output is dimensionless; no physical units are required. Angles do not appear. Percentages do not appear.",
            "solution": "### 1. Continuum Reaction-Diffusion (RD) Model\n\nThe continuum model is described by the partial differential equation (PDE):\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + f(u)\n$$\nwith the cubic reaction term $f(u) = u(u-a)(1-u)$. To solve this equation numerically, we discretize both space and time.\n\n**Spatial Discretization**: The spatial domain of length $L$ is discretized into $N_c = \\lfloor L/h_c \\rfloor + 1$ grid points, indexed by $j=0, 1, \\dots, N_c-1$. The spatial step size is $h_c$, and the position of each grid point is $x_j = j \\cdot h_c$. The second spatial derivative (Laplacian) at an interior point $x_j$ is approximated using a second-order central difference scheme:\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x_j} \\approx \\frac{u(x_{j+1}, t) - 2u(x_j, t) + u(x_{j-1}, t)}{h_c^2} = \\frac{u_{j+1} - 2u_j + u_{j-1}}{h_c^2}\n$$\nwhere $u_j(t) \\equiv u(x_j, t)$.\n\n**Temporal Discretization**: The time derivative is discretized using the explicit forward Euler method with a time step $\\Delta t_{\\text{cont}}$:\n$$\n\\frac{\\partial u}{\\partial t}\\bigg|_{t_n} \\approx \\frac{u(x, t_{n+1}) - u(x, t_n)}{\\Delta t_{\\text{cont}}}\n$$\nCombining these discretizations yields the full update rule for an interior grid point $j$:\n$$\nu_j^{n+1} = u_j^n + \\Delta t_{\\text{cont}} \\left( D \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{h_c^2} + f(u_j^n) \\right)\n$$\nwhere $u_j^n \\equiv u(x_j, t_n)$.\n\n**Boundary and Initial Conditions**:\n- The initial condition $u(x,0)=1$ for $x \\in [0,w]$ is implemented by setting $u_j^0=1$ for all $j$ where $x_j \\le w$.\n- The zero-flux (Neumann) boundary condition, $\\frac{\\partial u}{\\partial x} = 0$, is required at the right boundary $x=L$ ($j=N_c-1$). While not explicitly stated for the left boundary, a zero-flux condition at $x=0$ ($j=0$) is the standard and physically consistent choice for this problem setup. These are implemented using ghost points.\n  - At the left boundary ($j=0$), $\\frac{\\partial u}{\\partial x} \\approx \\frac{u_1 - u_{-1}}{2h_c} = 0 \\implies u_{-1} = u_1$. The Laplacian term becomes $D \\frac{2(u_1-u_0)}{h_c^2}$.\n  - At the right boundary ($j=N_c-1$), $\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{N_c} - u_{N_c-2}}{2h_c} = 0 \\implies u_{N_c} = u_{N_c-2}$. The Laplacian term becomes $D \\frac{2(u_{N_c-2}-u_{N_c-1})}{h_c^2}$.\n\n### 2. Discrete Lattice Model\n\nThe discrete model is a system of coupled ordinary differential equations (ODEs):\n$$\n\\frac{d u_i}{dt} = g\\left(u_{i+1} - 2 u_i + u_{i-1}\\right) + f(u_i)\n$$\nfor $N_d = \\lfloor L/h_d \\rfloor + 1$ lattice sites, indexed by $i=0, 1, \\dots, N_d-1$. The spatial term is already in a discrete (finite difference) form.\n\n**Temporal Discretization**: We apply the forward Euler method with time step $\\Delta t_{\\text{disc}}$:\n$$\nu_i^{n+1} = u_i^n + \\Delta t_{\\text{disc}} \\left( g(u_{i+1}^n - 2u_i^n + u_{i-1}^n) + f(u_i^n) \\right)\n$$\n\n**Boundary and Initial Conditions**:\n- The initial condition is analogous to the continuum case: $u_i^0=1$ for sites where $x_i = i \\cdot h_d \\le w$.\n- The right boundary condition at $i=N_d-1$ is explicitly given as a reflection: $u_{N_d} = u_{N_d-2}$. This makes the update for the diffusive part $g(u_{N_d-2} - 2u_{N_d-1} + u_{N_d-2}) = 2g(u_{N_d-2} - u_{N_d-1})$.\n- A symmetric zero-flux condition is assumed at the left boundary $i=0$, yielding a ghost point $u_{-1}=u_1$, and a diffusive term of $2g(u_1 - u_0)$.\n\n### 3. Numerical Implementation\n\n**Stability**: For both models, the explicit forward Euler scheme is conditionally stable. The problem specifies using a time step satisfying $\\Delta t \\le c \\frac{h^2}{\\text{coeff}}$, where $\\text{coeff}$ is the diffusion/coupling constant ($D$ or $g$) and $c  0.5$ is a safety factor. The implementation uses the largest stable time step by setting $\\Delta t = c \\frac{h^2}{\\text{coeff}}$ with the given safety factors $c_{\\text{cont}} = c_{\\text{disc}} = 0.45$.\n\n**Algorithm**:\n1. For each test case $(a, g)$, set the continuum diffusion coefficient $D=g$.\n2. **Discrete Simulation**:\n   a. Initialize parameters: $L=50, w=5, u_{\\text{thr}}=0.7, T=120, h_d=1, c_{\\text{disc}}=0.45$.\n   b. Calculate the number of sites $N_d$ and time step $\\Delta t_{\\text{disc}}$.\n   c. Set up the initial state array $u$ of size $N_d$.\n   d. Loop for a total time of $T$, in each step updating all $u_i$ according to the Euler formula, including the specific boundary condition rules.\n   e. After each full update, clip all values of $u$ to the interval $[0,1]$.\n   f. After the simulation, check if $u_{N_d-1} \\ge u_{\\text{thr}}$. Store the boolean result.\n3. **Continuum Simulation**:\n   a. Initialize parameters: $L=50, w=5, u_{\\text{thr}}=0.7, T=120, h_c=0.25, c_{\\text{cont}}=0.45$.\n   b. Calculate the number of grid points $N_c$ and time step $\\Delta t_{\\text{cont}}$.\n   c. Set up the initial state array $u$ of size $N_c$.\n   d. Loop for a total time of $T$, applying the discretized PDE update rule, with ghost-point-based Neumann conditions at the boundaries.\n   e. After each full update, clip all values of $u$ to the interval $[0,1]$.\n   f. After the simulation, check if $u_{N_c-1} \\ge u_{\\text{thr}}$. Store the boolean result.\n4. Collect the pair of boolean results $[d, c]$ for the discrete and continuum models, respectively.\n5. After processing all test cases, format the collected results into the specified string format.",
            "answer": "```python\nimport numpy as np\n\ndef run_discrete_model(param_a, param_g, L, w, u_thr, T, c_disc, h_d):\n    \"\"\"\n    Simulates the discrete lattice model.\n    \"\"\"\n    N_d = int(L / h_d) + 1\n    \n    # Handle g=0 case to avoid division by zero. If g is very small, dt can be very large.\n    if param_g = 1e-9:\n        # No coupling, wave cannot propagate.\n        return False\n    \n    dt = c_disc * (h_d**2) / param_g\n    n_steps = int(T / dt)\n\n    if n_steps == 0:\n        return False # Not enough time to evolve\n\n    # Initial condition\n    u = np.zeros(N_d)\n    x_coords = np.arange(N_d) * h_d\n    u[x_coords = w] = 1.0\n\n    # Reaction function\n    def f(u_vec, a):\n        return u_vec * (u_vec - a) * (1.0 - u_vec)\n\n    # Time evolution using Forward Euler\n    for _ in range(n_steps):\n        u_old = u.copy()\n        f_u = f(u_old, param_a)\n\n        # Interior points (vectorized)\n        laplacian = u_old[2:] - 2 * u_old[1:-1] + u_old[:-2]\n        u[1:-1] = u_old[1:-1] + dt * (param_g * laplacian + f_u[1:-1])\n\n        # Boundary conditions (zero-flux)\n        # Left boundary i=0: Assumed zero-flux, u_{-1} = u_{1}\n        laplacian_0 = 2 * (u_old[1] - u_old[0])\n        u[0] = u_old[0] + dt * (param_g * laplacian_0 + f_u[0])\n\n        # Right boundary i=N_d-1: Using given rule u_{N_d} = u_{N_d-2}\n        laplacian_end = 2 * (u_old[N_d - 2] - u_old[N_d - 1])\n        u[N_d - 1] = u_old[N_d - 1] + dt * (param_g * laplacian_end + f_u[N_d - 1])\n        \n        # Clip values to [0, 1]\n        np.clip(u, 0.0, 1.0, out=u)\n\n    # Check for success\n    return u[N_d - 1] = u_thr\n\ndef run_continuum_model(param_a, D, L, w, u_thr, T, c_cont, h_c):\n    \"\"\"\n    Simulates the continuum Reaction-Diffusion model.\n    \"\"\"\n    N_c = int(L / h_c) + 1\n    \n    if D = 1e-9:\n        # No diffusion, wave cannot propagate.\n        return False\n        \n    dt = c_cont * (h_c**2) / D\n    n_steps = int(T / dt)\n\n    if n_steps == 0:\n        return False # Not enough time to evolve\n\n    # Initial condition\n    u = np.zeros(N_c)\n    x_coords = np.arange(N_c) * h_c\n    u[x_coords = w] = 1.0\n\n    # Reaction function\n    def f(u_vec, a):\n        return u_vec * (u_vec - a) * (1.0 - u_vec)\n\n    # Time evolution using Forward Euler\n    h_c_sq = h_c**2\n    for _ in range(n_steps):\n        u_old = u.copy()\n        f_u = f(u_old, param_a)\n\n        # Interior points (vectorized)\n        laplacian = (u_old[2:] - 2 * u_old[1:-1] + u_old[:-2]) / h_c_sq\n        u[1:-1] = u_old[1:-1] + dt * (D * laplacian + f_u[1:-1])\n\n        # Boundary conditions (zero-flux, ∂u/∂x=0) implemented with ghost points\n        # Left boundary j=0: u_{-1} = u_{1}\n        laplacian_0 = 2 * (u_old[1] - u_old[0]) / h_c_sq\n        u[0] = u_old[0] + dt * (D * laplacian_0 + f_u[0])\n        \n        # Right boundary j=N_c-1: u_{N_c} = u_{N_c-2}\n        laplacian_end = 2 * (u_old[N_c - 2] - u_old[N_c - 1]) / h_c_sq\n        u[N_c - 1] = u_old[N_c - 1] + dt * (D * laplacian_end + f_u[N_c - 1])\n        \n        # Clip values to [0, 1]\n        np.clip(u, 0.0, 1.0, out=u)\n\n    # Check for success\n    return u[N_c - 1] = u_thr\n\ndef solve():\n    # Define problem constants from the statement\n    L = 50.0\n    w = 5.0\n    u_thr = 0.7\n    T = 120.0\n    c_disc = 0.45\n    c_cont = 0.45\n    h_d = 1.0\n    h_c = 0.25\n\n    # Test cases: (a, g)\n    test_cases = [\n        (0.45, 0.05),\n        (0.45, 0.5),\n        (0.55, 0.5),\n        (0.495, 0.05),\n        (0.30, 0.02),\n    ]\n\n    results = []\n    for a, g in test_cases:\n        # Run discrete model simulation\n        d_success = run_discrete_model(a, g, L, w, u_thr, T, c_disc, h_d)\n        \n        # Run continuum model simulation (D=g)\n        c_success = run_continuum_model(a, g, L, w, u_thr, T, c_cont, h_c)\n        \n        results.append([d_success, c_success])\n    \n    # Format the final output string to be exactly [[d1,c1],[d2,c2],...]\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}