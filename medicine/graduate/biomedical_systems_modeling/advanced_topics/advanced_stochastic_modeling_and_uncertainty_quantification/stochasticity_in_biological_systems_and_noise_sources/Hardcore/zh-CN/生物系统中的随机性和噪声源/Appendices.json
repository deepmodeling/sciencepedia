{
    "hands_on_practices": [
        {
            "introduction": "要理解生物系统中的随机性，最核心的模型之一是描述单个分子种类随机生成和降解的生灭过程。本练习将引导你使用化学主方程（Chemical Master Equation, CME）这一基本框架，来精确描述分子数量概率分布的动态演化。通过推导这个系统的稳态解 ，你将亲手揭示内在噪音的起源，并理解其统计特性（如泊松分布）是如何由基本的反应速率决定的。",
            "id": "3932684",
            "problem": "考虑一个混合均匀的单细胞中，某种单一胞内分子经历组成性合成和一级降解。令 $N(t)$ 表示在时间 $t$ 的分子拷贝数。该系统被建模为一个连续时间马尔可夫过程（生灭过程），包含以下基元反应：一个以恒定倾向 $k$（单位：分子/分钟）使拷贝数增加一的合成反应，以及一个以倾向 $\\gamma N(t)$（单位：每分钟乘以分子数）使拷贝数减少一的降解反应。假设该系统是遍历的，并达到唯一的稳态分布。从该生灭过程的化学主方程（CME）出发，推导其稳态分布。然后，计算在稳态下的均值 $\\mathbb{E}[N]$、方差 $\\mathrm{Var}[N]$以及定义为 $\\mathrm{CV} = \\sqrt{\\mathrm{Var}[N]}/\\mathbb{E}[N]$ 的变异系数。使用参数值 $k = 20\\ \\text{分子/分钟}$ 和 $\\gamma = 1\\ \\text{分钟}^{-1}$。将均值以分子为单位表示，方差以分子的平方为单位表示，变异系数表示为无量纲量。无需四舍五入；请提供精确值。",
            "solution": "该问题描述了一个细胞中单一物种的分子数 $N(t)$ 的生灭过程。该过程包括两个基元反应：\n1. 合成（生）：$\\emptyset \\xrightarrow{k} \\text{分子}$，具有恒定的倾向（速率）$k$。此反应使分子数从 $n$ 增加到 $n+1$。\n2. 降解（灭）：$\\text{分子} \\xrightarrow{\\gamma} \\emptyset$，倾向为 $\\gamma n$，其中 $n$ 是当前的分子数。此反应使分子数从 $n$ 减少到 $n-1$。\n\n令 $P(n, t)$ 为系统在时间 $t$ 拥有 $n$ 个分子的概率。该概率分布的时间演化由化学主方程（CME）控制。对于整数分子数 $n \\ge 0$，CME是一组耦合常微分方程：\n$$\n\\frac{d P(n, t)}{d t} = (\\text{流入状态 } n \\text{ 的通量}) - (\\text{流出状态 } n \\text{ 的通量})\n$$\n流入状态 $n$ 的通量来自状态 $n-1$ 的合成和状态 $n+1$ 的降解。流出状态 $n$ 的通量去往状态 $n+1$ 的合成和状态 $n-1$ 的降解。\n对于 $n \\ge 1$，CME为：\n$$\n\\frac{d P(n, t)}{d t} = k P(n-1, t) + \\gamma (n+1) P(n+1, t) - (k + \\gamma n) P(n, t)\n$$\n对于边界情况 $n=0$，从不存在的状态 $n=-1$ 进行合成是不可能的，从状态 $n=0$ 进行降解也是不可能的。因此，对于 $n=0$ 的CME为：\n$$\n\\frac{d P(0, t)}{d t} = \\gamma (1) P(1, t) - k P(0, t)\n$$\n问题指出，系统达到唯一的稳态分布。在稳态时，概率分布不随时间变化，因此对所有 $n$ 都有 $\\frac{d P(n, t)}{d t} = 0$。令 $P_n$ 表示稳态概率 $P(n, t \\to \\infty)$。稳态CME方程为：\n$$\n0 = k P_{n-1} + \\gamma (n+1) P_{n+1} - (k + \\gamma n) P_n \\quad \\text{对于 } n \\ge 1\n$$\n$$\n0 = \\gamma P_1 - k P_0 \\quad \\text{对于 } n=0\n$$\n对于一维生灭过程，稳态由细致平衡原理表征，即任何两个相邻状态之间的净概率通量为零。也就是说，从状态 $n$ 到 $n+1$ 的通量必须等于从状态 $n+1$ 到 $n$ 的通量：\n$$\n\\text{通量}(n \\to n+1) = \\text{通量}(n+1 \\to n)\n$$\n$$\nk P_n = \\gamma (n+1) P_{n+1} \\quad \\text{对所有 } n \\ge 0\n$$\n这个单一的递推关系满足两个稳态CME方程。由此，我们推导出 $P_{n+1}$ 关于 $P_n$ 的关系：\n$$\nP_{n+1} = \\frac{k}{\\gamma(n+1)} P_n\n$$\n让我们定义参数 $\\alpha = k/\\gamma$。该递推关系变为：\n$$\nP_{n+1} = \\frac{\\alpha}{n+1} P_n\n$$\n我们可以通过迭代来解这个递推关系：\n对于 $n=1$：$P_1 = \\frac{\\alpha}{1} P_0$\n对于 $n=2$：$P_2 = \\frac{\\alpha}{2} P_1 = \\frac{\\alpha}{2} \\left(\\frac{\\alpha}{1} P_0\\right) = \\frac{\\alpha^2}{2 \\cdot 1} P_0 = \\frac{\\alpha^2}{2!} P_0$\n对于 $n=3$：$P_3 = \\frac{\\alpha}{3} P_2 = \\frac{\\alpha}{3} \\left(\\frac{\\alpha^2}{2!} P_0\\right) = \\frac{\\alpha^3}{3!} P_0$\n通过归纳法，通解为：\n$$\nP_n = \\frac{\\alpha^n}{n!} P_0\n$$\n为了求出常数 $P_0$，我们使用归一化条件，即所有概率之和必须为1：\n$$\n\\sum_{n=0}^{\\infty} P_n = 1\n$$\n$$\n\\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{n!} P_0 = P_0 \\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{n!} = 1\n$$\n该和是指数函数的泰勒级数展开，$\\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{n!} = \\exp(\\alpha)$。\n$$\nP_0 \\exp(\\alpha) = 1 \\implies P_0 = \\exp(-\\alpha)\n$$\n将此代回 $P_n$ 的表达式，我们得到稳态分布：\n$$\nP_n = \\frac{\\alpha^n \\exp(-\\alpha)}{n!}\n$$\n这是参数为 $\\alpha = k/\\gamma$ 的泊松分布的概率质量函数。\n\n现在，我们计算稳态下的所需统计矩。\n分子数的均值（期望值）$\\mathbb{E}[N]$ 为：\n$$\n\\mathbb{E}[N] = \\sum_{n=0}^{\\infty} n P_n = \\sum_{n=1}^{\\infty} n \\frac{\\alpha^n \\exp(-\\alpha)}{n!} = \\exp(-\\alpha) \\sum_{n=1}^{\\infty} \\frac{\\alpha^n}{(n-1)!}\n$$\n令 $m = n-1$。该和变为：\n$$\n\\mathbb{E}[N] = \\exp(-\\alpha) \\sum_{m=0}^{\\infty} \\frac{\\alpha^{m+1}}{m!} = \\alpha \\exp(-\\alpha) \\sum_{m=0}^{\\infty} \\frac{\\alpha^m}{m!} = \\alpha \\exp(-\\alpha) \\exp(\\alpha) = \\alpha\n$$\n因此，均值为 $\\mathbb{E}[N] = \\alpha = k/\\gamma$。\n\n方差为 $\\mathrm{Var}[N] = \\mathbb{E}[N^2] - (\\mathbb{E}[N])^2$。我们首先计算二阶阶乘矩 $\\mathbb{E}[N(N-1)]$：\n$$\n\\mathbb{E}[N(N-1)] = \\sum_{n=0}^{\\infty} n(n-1) P_n = \\sum_{n=2}^{\\infty} n(n-1) \\frac{\\alpha^n \\exp(-\\alpha)}{n!} = \\exp(-\\alpha) \\sum_{n=2}^{\\infty} \\frac{\\alpha^n}{(n-2)!}\n$$\n令 $m = n-2$。该和变为：\n$$\n\\mathbb{E}[N(N-1)] = \\exp(-\\alpha) \\sum_{m=0}^{\\infty} \\frac{\\alpha^{m+2}}{m!} = \\alpha^2 \\exp(-\\alpha) \\sum_{m=0}^{\\infty} \\frac{\\alpha^m}{m!} = \\alpha^2 \\exp(-\\alpha) \\exp(\\alpha) = \\alpha^2\n$$\n二阶矩 $\\mathbb{E}[N^2]$ 与阶乘矩的关系为 $\\mathbb{E}[N^2] = \\mathbb{E}[N(N-1) + N] = \\mathbb{E}[N(N-1)] + \\mathbb{E}[N]$。\n$$\n\\mathbb{E}[N^2] = \\alpha^2 + \\alpha\n$$\n现在，我们可以计算方差：\n$$\n\\mathrm{Var}[N] = \\mathbb{E}[N^2] - (\\mathbb{E}[N])^2 = (\\alpha^2 + \\alpha) - (\\alpha)^2 = \\alpha\n$$\n因此，方差为 $\\mathrm{Var}[N] = \\alpha = k/\\gamma$。\n\n变异系数 $\\mathrm{CV}$ 定义为标准差与均值的比值：\n$$\n\\mathrm{CV} = \\frac{\\sqrt{\\mathrm{Var}[N]}}{\\mathbb{E}[N]} = \\frac{\\sqrt{\\alpha}}{\\alpha} = \\frac{1}{\\sqrt{\\alpha}}\n$$\n\n最后，我们代入给定的参数值：$k = 20\\ \\text{分子/分钟}$ 和 $\\gamma = 1\\ \\text{分钟}^{-1}$。\n参数 $\\alpha$ 为：\n$$\n\\alpha = \\frac{k}{\\gamma} = \\frac{20}{1} = 20\n$$\n分子数的均值为：\n$$\n\\mathbb{E}[N] = \\alpha = 20\\ \\text{分子}\n$$\n分子数的方差为：\n$$\n\\mathrm{Var}[N] = \\alpha = 20\\ \\text{分子}^2\n$$\n变异系数为：\n$$\n\\mathrm{CV} = \\frac{1}{\\sqrt{\\alpha}} = \\frac{1}{\\sqrt{20}} = \\frac{1}{\\sqrt{4 \\times 5}} = \\frac{1}{2\\sqrt{5}} = \\frac{\\sqrt{5}}{10}\n$$\n此量为无量纲量。问题要求提供精确值，我们已经提供了。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 20 & 20 & \\frac{\\sqrt{5}}{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管化学主方程（CME）是精确的，但它对于复杂系统往往难以求解。化学朗之万方程（Chemical Langevin Equation, CLE）为我们提供了一个强大的连续随机近似方法。在本练习中，你将应用随机分析中的核心工具——伊藤引理（Itô's lemma），来推导分子数量均值和方差随时间演化的动力学方程 。这项实践将展示如何从离散的概率主方程过渡到连续的随机微分方程（SDE）框架，从而能够在不求解完整概率分布的情况下分析系统的关键统计矩。",
            "id": "3932700",
            "problem": "一个具有恒定出生倾向和线性死亡倾向的单物种生灭反应网络，可以用化学朗之万方程（CLE）来近似。这是一个由标准维纳过程（SWP）驱动的随机微分方程。考虑一个由CLE控制的分子数变量 $X(t)$\n$$\ndX(t) = \\left(k - \\gamma X(t)\\right)\\,dt + \\sqrt{k + \\gamma X(t)}\\,dW_{t},\n$$\n其中 $k>0$ 是出生速率常数，$\\gamma>0$ 是死亡速率常数，$W_{t}$ 是SWP。扩散项 $\\sqrt{k + \\gamma X(t)}$ 反映了由出生和死亡反应倾向之和产生的散粒噪声，这与反应网络的扩散近似一致。\n\n从方差的定义 $\\mathrm{Var}(X(t)) = \\mathbb{E}[X(t)^{2}] - \\left(\\mathbb{E}[X(t)]\\right)^{2}$ 和应用于CLE的二次可微检验函数 $f(X)$ 的伊藤积分出发，推导控制一阶矩 $\\mathbb{E}[X(t)]$ 和方差 $\\mathrm{Var}(X(t))$ 时间演化的耦合常微分方程。您的推导必须从伊藤引理的一般形式开始，并通过选择适当的函数 $f(X)$ 来进行，不得引用任何预先计算的矩方程或闭合近似。\n\n将您的最终答案表示为一个单行矩阵，其第一个元素是 $\\frac{d}{dt}\\mathbb{E}[X(t)]$ 的表达式，第二个元素是 $\\frac{d}{dt}\\mathrm{Var}(X(t))$ 的表达式。不需要进行数值计算。不需要单位。最终答案中不要包含任何等号或额外的评注。",
            "solution": "该问题要求推导分子数变量 $X(t)$ 的一阶矩 $\\mathbb{E}[X(t)]$ 和方差 $\\mathrm{Var}(X(t))$ 时间演化的耦合常微分方程（ODEs）。$X(t)$ 的动力学由化学朗之万方程（CLE）控制，这是一种特定类型的伊藤随机微分方程（SDE）。\n\n给定的SDE是：\n$$\ndX(t) = \\left(k - \\gamma X(t)\\right)\\,dt + \\sqrt{k + \\gamma X(t)}\\,dW_{t}\n$$\n该SDE具有一般形式 $dX(t) = a(X,t)dt + b(X,t)dW_t$，其中漂移系数为 $a(X,t) = k - \\gamma X(t)$，扩散系数为 $b(X,t) = \\sqrt{k + \\gamma X(t)}$。注意 $b(X,t)^2 = k + \\gamma X(t)$。常数 $k$ 和 $\\gamma$ 均为正数。\n\n推导依赖于伊藤引理。对于一个没有显式时间依赖的二次可微检验函数 $f(X)$，伊藤引理指出微分 $df(X(t))$ 由下式给出：\n$$\ndf(X(t)) = \\left( a(X,t) \\frac{df}{dX} + \\frac{1}{2} b(X,t)^2 \\frac{d^2f}{dX^2} \\right) dt + b(X,t) \\frac{df}{dX} dW_t\n$$\n为了找到矩的ODEs，我们将此引理应用于 $f(X)$ 的特定选择，然后取期望。伊藤积分的一个关键性质是，对于一个合适的非预见过程 $\\phi(t)$，其期望 $\\mathbb{E}\\left[\\int_0^t \\phi(s) dW_s\\right] = 0$。\n\n**1. 一阶矩 $\\mathbb{E}[X(t)]$ 的ODE推导**\n\n令检验函数为 $f(X) = X$。其导数为：\n$$\n\\frac{df}{dX} = 1, \\quad \\frac{d^2f}{dX^2} = 0\n$$\n将这些以及 $a(X,t)$ 和 $b(X,t)^2$ 的表达式代入伊藤引理，得到：\n$$\ndX(t) = \\left( (k - \\gamma X(t)) \\cdot 1 + \\frac{1}{2} (k + \\gamma X(t)) \\cdot 0 \\right) dt + \\sqrt{k + \\gamma X(t)} \\cdot 1 \\cdot dW_t\n$$\n$$\ndX(t) = (k - \\gamma X(t)) dt + \\sqrt{k + \\gamma X(t)} dW_t\n$$\n这就恢复了原始的SDE。为了获得均值的动力学，我们对该方程取期望。其从 $t=0$ 到 $t$ 的积分形式为：\n$$\n\\mathbb{E}[X(t) - X(0)] = \\mathbb{E}\\left[ \\int_0^t (k - \\gamma X(s)) ds \\right] + \\mathbb{E}\\left[ \\int_0^t \\sqrt{k + \\gamma X(s)} dW_s \\right]\n$$\n利用期望的线性和伊藤积分的零均值性质，我们得到：\n$$\n\\mathbb{E}[X(t)] - \\mathbb{E}[X(0)] = \\int_0^t \\mathbb{E}[k - \\gamma X(s)] ds = \\int_0^t (k - \\gamma \\mathbb{E}[X(s)]) ds\n$$\n根据微积分基本定理，对两边关于 $t$ 求导，得到均值的ODE：\n$$\n\\frac{d}{dt}\\mathbb{E}[X(t)] = k - \\gamma \\mathbb{E}[X(t)]\n$$\n\n**2. 方差 $\\mathrm{Var}(X(t))$ 的ODE推导**\n\n方差定义为 $\\mathrm{Var}(X(t)) = \\mathbb{E}[X(t)^2] - (\\mathbb{E}[X(t)])^2$。为了求其时间演化，我们首先需要二阶矩 $\\mathbb{E}[X(t)^2]$ 的ODE。\n\n令检验函数为 $f(X) = X^2$。其导数为：\n$$\n\\frac{df}{dX} = 2X, \\quad \\frac{d^2f}{dX^2} = 2\n$$\n代入伊藤引理：\n$$\nd(X(t)^2) = \\left( (k - \\gamma X(t)) \\cdot (2X(t)) + \\frac{1}{2} (k + \\gamma X(t)) \\cdot 2 \\right) dt + \\sqrt{k + \\gamma X(t)} \\cdot (2X(t)) \\cdot dW_t\n$$\n$$\nd(X(t)^2) = (2kX(t) - 2\\gamma X(t)^2 + k + \\gamma X(t)) dt + 2X(t)\\sqrt{k + \\gamma X(t)} dW_t\n$$\n对其积分形式取期望：\n$$\n\\mathbb{E}[X(t)^2 - X(0)^2] = \\mathbb{E}\\left[ \\int_0^t (2kX(s) - 2\\gamma X(s)^2 + k + \\gamma X(s)) ds \\right] + \\mathbb{E}\\left[ \\int_0^t 2X(s)\\sqrt{k + \\gamma X(s)} dW_s \\right]\n$$\n随机积分的期望为零。应用期望的线性性：\n$$\n\\mathbb{E}[X(t)^2] - \\mathbb{E}[X(0)^2] = \\int_0^t ( (2k+\\gamma)\\mathbb{E}[X(s)] - 2\\gamma \\mathbb{E}[X(s)^2] + k ) ds\n$$\n对 $t$ 求导，得到二阶矩的ODE：\n$$\n\\frac{d}{dt}\\mathbb{E}[X(t)^2] = k + (2k+\\gamma)\\mathbb{E}[X(t)] - 2\\gamma \\mathbb{E}[X(t)^2]\n$$\n现在我们可以用链式法则求出方差 $\\mathrm{Var}(X(t))$ 的导数：\n$$\n\\frac{d}{dt}\\mathrm{Var}(X(t)) = \\frac{d}{dt}\\left( \\mathbb{E}[X(t)^2] - (\\mathbb{E}[X(t)])^2 \\right) = \\frac{d}{dt}\\mathbb{E}[X(t)^2] - 2\\mathbb{E}[X(t)] \\frac{d}{dt}\\mathbb{E}[X(t)]\n$$\n代入已推导出的关于一阶矩和二阶矩导数的表达式：\n$$\n\\frac{d}{dt}\\mathrm{Var}(X(t)) = \\left( k + (2k+\\gamma)\\mathbb{E}[X(t)] - 2\\gamma \\mathbb{E}[X(t)^2] \\right) - 2\\mathbb{E}[X(t)] \\left( k - \\gamma \\mathbb{E}[X(t)] \\right)\n$$\n展开各项：\n$$\n\\frac{d}{dt}\\mathrm{Var}(X(t)) = k + 2k\\mathbb{E}[X(t)] + \\gamma\\mathbb{E}[X(t)] - 2\\gamma \\mathbb{E}[X(t)^2] - 2k\\mathbb{E}[X(t)] + 2\\gamma (\\mathbb{E}[X(t)])^2\n$$\n项 $2k\\mathbb{E}[X(t)]$ 相消，剩下：\n$$\n\\frac{d}{dt}\\mathrm{Var}(X(t)) = k + \\gamma\\mathbb{E}[X(t)] - 2\\gamma \\mathbb{E}[X(t)^2] + 2\\gamma (\\mathbb{E}[X(t)])^2\n$$\n从后两项中提出因子 $-2\\gamma$：\n$$\n\\frac{d}{dt}\\mathrm{Var}(X(t)) = k + \\gamma\\mathbb{E}[X(t)] - 2\\gamma \\left( \\mathbb{E}[X(t)^2] - (\\mathbb{E}[X(t)])^2 \\right)\n$$\n注意到括号中的项是方差的定义 $\\mathrm{Var}(X(t))$，我们得到方差的最终ODE：\n$$\n\\frac{d}{dt}\\mathrm{Var}(X(t)) = k + \\gamma\\mathbb{E}[X(t)] - 2\\gamma \\mathrm{Var}(X(t))\n$$\n得到的两个ODE为均值和方差构成了一个封闭的耦合线性系统。所要求的导数表达式为：\n对于一阶矩：$k - \\gamma \\mathbb{E}[X(t)]$\n对于方差：$k + \\gamma\\mathbb{E}[X(t)] - 2\\gamma \\mathrm{Var}(X(t))$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} k - \\gamma \\mathbb{E}[X(t)] & k + \\gamma \\mathbb{E}[X(t)] - 2\\gamma \\mathrm{Var}(X(t)) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当解析方法（无论是精确解还是近似解）都不可行时，我们通常采用计算机模拟的手段。随机模拟算法（Stochastic Simulation Algorithm, SSA），也称为 Gillespie 算法，提供了一种在数值上精确模拟随机生化反应网络的方法。本练习将带你探究 SSA 算法的概率论核心 ：从系统的总反应倾向性（total propensity）出发，推导下一次反应发生的等待时间的概率分布。理解这一推导过程，是掌握 SSA 为何能精确模拟 CME 所描述过程的关键，同时也能让你洞察模拟效率如何依赖于系统规模和反应速率。",
            "id": "3932668",
            "problem": "考虑一个充分混合的随机生化反应网络，其中包含 $N$ 种分子和 $M$ 个反应，这些反应发生在一个大小（例如，体积）为 $\\Omega>0$ 的隔室中。令时间 $t$ 的状态为 $\\boldsymbol{X}(t)=\\boldsymbol{x}\\in\\mathbb{N}^{N}$。对于反应 $j\\in\\{1,\\dots,M\\}$，令 $a_{j}(\\boldsymbol{x})$ 表示其在状态 $\\boldsymbol{x}$ 下的倾向（propensity），并定义总倾向为 $a_{0}(\\boldsymbol{x})=\\sum_{j=1}^{M}a_{j}(\\boldsymbol{x})$。假设采用标准的充分混合连续时间马尔可夫跳跃过程模型：在条件 $\\boldsymbol{X}(t)=\\boldsymbol{x}$ 下，于无穷小区间 $\\mathrm{d}t$ 内，反应 $j$ 在 $[t,t+\\mathrm{d}t)$ 内发生的概率为 $a_{j}(\\boldsymbol{x})\\,\\mathrm{d}t+o(\\mathrm{d}t)$，而发生一次以上反应的概率为 $o(\\mathrm{d}t)$。随机模拟算法 (SSA) 使用从当前状态 $\\boldsymbol{x}$ 到下一次反应发生的事件间等待时间 $\\tau$。\n\n任务 1. 从上述定义以及连续时间马尔可夫跳跃过程（其风险在跳跃之间是状态依赖但分段恒定的）的生存和风险基本性质出发，推导在给定 $\\boldsymbol{X}(t)=\\boldsymbol{x}$ 的条件下，到下一次反应发生的等待时间 $\\tau$ 的概率密度，并以 $a_{0}(\\boldsymbol{x})$ 的函数形式计算其期望值 $\\mathbb{E}[\\tau\\mid \\boldsymbol{X}(t)=\\boldsymbol{x}]$ 的闭合形式解。\n\n任务 2. 现在，引入常用于连接介观随机动力学与宏观浓度的密度依赖尺度变换：假设存在函数 $\\lambda_{j}:\\mathbb{R}_{+}^{N}\\to\\mathbb{R}_{+}$，$j\\in\\{1,\\dots,M\\}$，使得对于任何状态 $\\boldsymbol{x}$，倾向满足 $a_{j}(\\boldsymbol{x})=\\Omega\\,\\lambda_{j}(\\boldsymbol{x}/\\Omega)$。令浓度向量为 $\\boldsymbol{\\phi}=\\boldsymbol{x}/\\Omega$，并将其视为在 $\\Omega$ 变化时固定不变。使用此尺度变换，将 $\\mathbb{E}[\\tau\\mid \\boldsymbol{\\phi},\\Omega]$ 完全用 $\\Omega$ 和函数 $\\lambda_{j}(\\boldsymbol{\\phi})$ 表示。明确说明 $\\mathbb{E}[\\tau\\mid \\boldsymbol{\\phi},\\Omega]$ 如何依赖于 $\\Omega$。\n\n你的最终答案必须是 $\\mathbb{E}[\\tau\\mid \\boldsymbol{\\phi},\\Omega]$ 的一个单一闭合形式解析表达式，用 $\\Omega$ 和 $\\{\\lambda_{j}(\\boldsymbol{\\phi})\\}_{j=1}^{M}$ 表示。最终答案中不应包含任何单位或任何文字说明。如果在推导过程中引入了任何近似，请在解答中明确说明其理由。本题无需进行数值四舍五入。",
            "solution": "该问题提法清晰且科学上合理，其基础是应用于随机化学动力学的连续时间马尔可夫跳跃过程的基本原理。我们将进行严谨的推导。\n\n该问题分为两个任务。首先，我们推导等待时间的概率分布及其期望。其次，我们应用一个特定的尺度变换定律来分析系统大小的依赖性。\n\n任务1：等待时间分布及其期望的推导。\n令系统在时间 $t$ 处于状态 $\\boldsymbol{X}(t)=\\boldsymbol{x}$。状态 $\\boldsymbol{x}$ 是一个 $N$ 维非负整数向量，$\\boldsymbol{x} \\in \\mathbb{N}^{N}$。系统保持此状态直到有反应发生。到下一个反应事件发生的时间是一个随机变量，我们记为 $\\tau$。我们需要求出在给定当前状态 $\\boldsymbol{x}$ 的条件下 $\\tau$ 的概率密度函数 (PDF) 及其期望值 $\\mathbb{E}[\\tau \\mid \\boldsymbol{X}(t)=\\boldsymbol{x}]$。\n\n任何反应可能发生的总速率是各个反应倾向之和，$a_0(\\boldsymbol{x}) = \\sum_{j=1}^{M} a_j(\\boldsymbol{x})$。根据问题陈述，在无穷小时间间隔 $[t, t+\\mathrm{d}t)$ 内发生任意单个反应的概率是 $a_0(\\boldsymbol{x})\\mathrm{d}t + o(\\mathrm{d}t)$。由于在等待期间状态 $\\boldsymbol{x}$ 是恒定的，总倾向 $a_0(\\boldsymbol{x})$ 充当一个恒定的风险率。\n\n令 $S(\\tau' \\mid \\boldsymbol{x}) = P(\\tau > \\tau' \\mid \\boldsymbol{X}(t)=\\boldsymbol{x})$ 为生存函数，即到时间 $t+\\tau'$ 仍未发生反应的概率。\n在区间 $[t, t+\\tau'+\\mathrm{d}t')$ 内没有事件发生的概率可以表示为在 $[t, t+\\tau')$ 内没有事件发生的概率乘以在随后的区间 $[t+\\tau', t+\\tau'+\\mathrm{d}t')$ 内没有事件发生的概率。根据马尔可夫性质，这两个事件是独立的。\n在 $[t+\\tau', t+\\tau'+\\mathrm{d}t')$ 内没有反应发生的概率是 $1 - a_0(\\boldsymbol{x})\\mathrm{d}t' + o(\\mathrm{d}t')$。\n因此，我们可以写出：\n$$\nP(\\tau > \\tau'+\\mathrm{d}t' \\mid \\boldsymbol{x}) = P(\\tau > \\tau' \\mid \\boldsymbol{x}) \\times P(\\text{no event in } [t+\\tau', t+\\tau'+\\mathrm{d}t') \\mid \\boldsymbol{x})\n$$\n用生存函数表示：\n$$\nS(\\tau'+\\mathrm{d}t' \\mid \\boldsymbol{x}) = S(\\tau' \\mid \\boldsymbol{x}) (1 - a_0(\\boldsymbol{x})\\mathrm{d}t')\n$$\n整理后得到：\n$$\nS(\\tau'+\\mathrm{d}t' \\mid \\boldsymbol{x}) - S(\\tau' \\mid \\boldsymbol{x}) = -a_0(\\boldsymbol{x}) S(\\tau' \\mid \\boldsymbol{x}) \\mathrm{d}t'\n$$\n两边同除以 $\\mathrm{d}t'$ 并取 $\\mathrm{d}t' \\to 0$ 的极限，得到生存函数的微分方程：\n$$\n\\frac{\\mathrm{d}S(\\tau' \\mid \\boldsymbol{x})}{\\mathrm{d}\\tau'} = -a_0(\\boldsymbol{x}) S(\\tau' \\mid \\boldsymbol{x})\n$$\n这是一个一阶线性常微分方程。初始条件是生存时间超过 0 的概率为 1，即 $S(0 \\mid \\boldsymbol{x}) = 1$。其解为：\n$$\nS(\\tau' \\mid \\boldsymbol{x}) = \\exp(-a_0(\\boldsymbol{x})\\tau')\n$$\n概率密度函数 $p(\\tau' \\mid \\boldsymbol{x})$ 与生存函数的关系是 $p(\\tau' \\mid \\boldsymbol{x}) = -\\frac{\\mathrm{d}S(\\tau' \\mid \\boldsymbol{x})}{\\mathrm{d}\\tau'}$。对生存函数求导，我们得到：\n$$\np(\\tau' \\mid \\boldsymbol{x}) = - \\frac{\\mathrm{d}}{\\mathrm{d}\\tau'} \\exp(-a_0(\\boldsymbol{x})\\tau') = -(-a_0(\\boldsymbol{x})) \\exp(-a_0(\\boldsymbol{x})\\tau') = a_0(\\boldsymbol{x}) \\exp(-a_0(\\boldsymbol{x})\\tau')\n$$\n这是速率参数为 $a_0(\\boldsymbol{x})$ 的指数分布的概率密度函数。\n\n具有此概率密度函数的随机变量的期望值可以通过积分求得：\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{X}(t)=\\boldsymbol{x}] = \\int_0^\\infty \\tau' p(\\tau' \\mid \\boldsymbol{x}) \\mathrm{d}\\tau' = \\int_0^\\infty \\tau' a_0(\\boldsymbol{x}) \\exp(-a_0(\\boldsymbol{x})\\tau') \\mathrm{d}\\tau'\n$$\n这是一个标准积分。使用分部积分法，令 $u = \\tau'$ 且 $\\mathrm{d}v = a_0(\\boldsymbol{x}) \\exp(-a_0(\\boldsymbol{x})\\tau') \\mathrm{d}\\tau'$，我们得到 $\\mathrm{d}u = \\mathrm{d}\\tau'$ 和 $v = -\\exp(-a_0(\\boldsymbol{x})\\tau')$。\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{X}(t)=\\boldsymbol{x}] = \\left[-\\tau' \\exp(-a_0(\\boldsymbol{x})\\tau')\\right]_0^\\infty - \\int_0^\\infty (-\\exp(-a_0(\\boldsymbol{x})\\tau')) \\mathrm{d}\\tau'\n$$\n第一项在两个极限处的值都为 0 (因为当 $c>0$ 时，$\\lim_{\\tau'\\to\\infty} \\tau'\\exp(-c\\tau')=0$)。该积分变为：\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{X}(t)=\\boldsymbol{x}] = \\int_0^\\infty \\exp(-a_0(\\boldsymbol{x})\\tau') \\mathrm{d}\\tau' = \\left[-\\frac{1}{a_0(\\boldsymbol{x})} \\exp(-a_0(\\boldsymbol{x})\\tau')\\right]_0^\\infty\n$$\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{X}(t)=\\boldsymbol{x}] = -\\frac{1}{a_0(\\boldsymbol{x})} (0 - 1) = \\frac{1}{a_0(\\boldsymbol{x})}\n$$\n任务 1 完成。到下一次反应的期望等待时间是总倾向的倒数。\n\n任务2：密度依赖尺度变换的应用。\n我们已知倾向的尺度变换关系：$a_j(\\boldsymbol{x}) = \\Omega \\lambda_j(\\boldsymbol{x}/\\Omega)$，其中 $\\Omega$ 是系统大小，$\\boldsymbol{\\phi} = \\boldsymbol{x}/\\Omega$ 是浓度向量。我们需要将新定义的条件期望 $\\mathbb{E}[\\tau \\mid \\boldsymbol{\\phi}, \\Omega]$ 完全用 $\\Omega$ 和函数 $\\{\\lambda_j(\\boldsymbol{\\phi})\\}_{j=1}^M$ 来表示。\n\n条件 $(\\boldsymbol{\\phi}, \\Omega)$ 等价于条件 $\\boldsymbol{x}$，因为 $\\boldsymbol{x} = \\Omega \\boldsymbol{\\phi}$。因此，我们可以使用任务 1 的结果：\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{\\phi}, \\Omega] = \\mathbb{E}[\\tau \\mid \\boldsymbol{X}(t)=\\boldsymbol{x}] = \\frac{1}{a_0(\\boldsymbol{x})}\n$$\n现在，我们使用给定的尺度变换定律来表示 $a_0(\\boldsymbol{x})$。总倾向为：\n$$\na_0(\\boldsymbol{x}) = \\sum_{j=1}^{M} a_j(\\boldsymbol{x})\n$$\n代入每个 $a_j(\\boldsymbol{x})$ 的尺度变换关系：\n$$\na_0(\\boldsymbol{x}) = \\sum_{j=1}^{M} \\Omega \\lambda_j(\\boldsymbol{x}/\\Omega)\n$$\n我们可以提出常数系统大小 $\\Omega$：\n$$\na_0(\\boldsymbol{x}) = \\Omega \\sum_{j=1}^{M} \\lambda_j(\\boldsymbol{x}/\\Omega)\n$$\n代入浓度向量的定义 $\\boldsymbol{\\phi} = \\boldsymbol{x}/\\Omega$：\n$$\na_0(\\boldsymbol{x}) = \\Omega \\sum_{j=1}^{M} \\lambda_j(\\boldsymbol{\\phi})\n$$\n总和 $\\sum_{j=1}^{M} \\lambda_j(\\boldsymbol{\\phi})$ 代表宏观总反应速率，我们可以将其记为 $\\lambda_0(\\boldsymbol{\\phi})$。\n现在我们将 $a_0(\\boldsymbol{x})$ 的这个表达式代回到期望等待时间的公式中：\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{\\phi}, \\Omega] = \\frac{1}{\\Omega \\sum_{j=1}^{M} \\lambda_j(\\boldsymbol{\\phi})}\n$$\n这就是最终的表达式。\n\n根据这个结果，我们可以明确说明期望等待时间对系统大小 $\\Omega$ 的依赖性。对于一个固定的浓度向量 $\\boldsymbol{\\phi}$，量 $\\sum_{j=1}^{M} \\lambda_j(\\boldsymbol{\\phi})$ 是一个常数。因此，期望等待时间与系统大小成反比：\n$$\n\\mathbb{E}[\\tau \\mid \\boldsymbol{\\phi}, \\Omega] \\propto \\frac{1}{\\Omega}\n$$\n这种关系是将随机动力学与确定性速率方程联系起来的一个关键概念。当系统大小 $\\Omega$ 趋于无穷大（热力学极限）时，反应事件之间的期望时间趋于 0。这意味着反应以越来越高的频率发生，导致浓度的连续、确定性演化，这种演化由常微分方程描述。",
            "answer": "$$\n\\boxed{\\frac{1}{\\Omega \\sum_{j=1}^{M} \\lambda_{j}(\\boldsymbol{\\phi})}}\n$$"
        }
    ]
}