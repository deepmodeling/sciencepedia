{
    "hands_on_practices": [
        {
            "introduction": "为了真正理解随机性的离子通道门控，我们必须能够对其进行模拟。Gillespie随机模拟算法 (SSA) 为模拟化学反应系统的时间演化提供了一种精确的方法，它非常适合用于模拟独立的离子通道群体。本练习  将引导您理解SSA的核心逻辑，帮助您掌握如何确定下一个通道门控事件将*何时*发生以及它将是*哪种*事件，这为任何关于通道噪声的计算研究奠定了基础。",
            "id": "3931884",
            "problem": "考虑一个由 $N$ 个相同的、独立的两态离子通道组成的群体，每个通道要么处于闭合状态 $C$，要么处于开放状态 $O$。在电压钳条件下，膜电位 $V$ 在通道门控事件之间保持恒定。处于状态 $C$ 的通道以电压依赖性速率 $k_{CO}(V)$ 转换到状态 $O$，而处于状态 $O$ 的通道以电压依赖性速率 $k_{OC}(V)$ 转换到状态 $C$。在时间 $t$，用 $n_C(t)$ 表示闭合通道的数量，用 $n_O(t)$ 表示开放通道的数量，其中 $n_C(t) + n_O(t) = N$。假设对于钳制电压 $V$，$k_{CO}(V)$ 和 $k_{OC}(V)$ 是有限且为正的，并且通道是独立门控的。\n\n从具有无记忆转换的连续时间马尔可夫过程和通道独立性的定义出发，推导下一次门控事件的等待时间分布，以及选择下一次事件的身份和类型的规则。使用这些推导来描述Gillespie随机模拟算法（SSA）在所述电压钳假设下如何应用于该系统。\n\n哪个选项最好且最完整地描述了Gillespie SSA用于该系统的事件时间分布和事件选择过程？\n\nA. 在电压钳下，在每个事件间隔内将 $k_{CO}(V)$ 和 $k_{OC}(V)$ 视为常数。到下一个事件的等待时间 $\\tau$ 服从指数分布，其速率为 $a_0 = n_C(t)\\,k_{CO}(V) + n_O(t)\\,k_{OC}(V)$。下一个事件是 $C \\to O$ 开放的概率为 $n_C(t)\\,k_{CO}(V)/a_0$，是 $O \\to C$ 关闭的概率为 $n_O(t)\\,k_{OC}(V)/a_0$；具体的通道在相应的状态类别内均匀随机选择。SSA的步骤是：计算 $a_0$，从 $\\mathrm{Exponential}(a_0)$ 分布中抽取 $\\tau$，通过按比例抽样倾向性来抽取事件类型，更新 $n_C(t)$ 和 $n_O(t)$ 以及时间 $t \\leftarrow t + \\tau$，然后重复。\n\nB. 因为有 $N$ 个通道，等待时间 $\\tau$ 服从伽马分布，其形状参数为 $N$，速率参数为 $k_{CO}(V) + k_{OC}(V)$；下一个事件的身份在开放和关闭之间以相等的概率选择，然后具体的通道在所有通道中均匀随机选择。\n\nC. 等待时间 $\\tau$ 服从指数分布，其速率为 $\\max\\{k_{CO}(V),\\,k_{OC}(V)\\}$，与 $n_C(t)$ 和 $n_O(t)$ 无关；事件的类型由较大的速率决定，具体的通道是速率最快的那个。\n\nD. 因为 $k_{CO}(V)$ 和 $k_{OC}(V)$ 依赖于膜电位，等待时间密度为 $f(\\tau) = a_0(V(t+\\tau))\\,\\exp\\!\\big(-\\int_0^\\tau a_0(V(t+s))\\,ds\\big)$，其中 $a_0(V) = n_C(t)\\,k_{CO}(V) + n_O(t)\\,k_{OC}(V)$，事件类型通过在实现的 $\\tau$ 时刻对 $n_C(t)\\,k_{CO}(V(t+\\tau))$ 和 $n_O(t)\\,k_{OC}(V(t+\\tau))$进行归一化来选择。\n\nE. 等待时间 $\\tau$ 服从指数分布，其速率为 $a_0 = n_C(t)\\,k_{CO}(V) + n_O(t)\\,k_{OC}(V)$，但下一个事件是开放的概率为 $k_{CO}(V)/(k_{CO}(V) + k_{OC}(V))$，是关闭的概率为 $k_{OC}(V)/(k_{CO}(V) + k_{OC}(V))$，与 $n_C(t)$ 和 $n_O(t)$ 无关。",
            "solution": "我们从每个通道的门控由具有无记忆转换的连续时间马尔可夫过程描述这一原理出发。在电压钳下，膜电位 $V$ 在事件之间保持恒定，因此速率 $k_{CO}(V)$ 和 $k_{OC}(V)$ 在任何事件间隔内都是常数。通道的独立性意味着，在时间 $t$，有 $n_C(t)$ 个独立的指数时钟，每个时钟的速率为 $k_{CO}(V)$，对应潜在的开放；还有 $n_O(t)$ 个独立的指数时钟，每个时钟的速率为 $k_{OC}(V)$，对应潜在的关闭。\n\n对于等待时间分布，我们使用生存概率法。令 $\\tau$ 表示到下一个事件的等待时间。根据独立性和指数生存特性，在区间 $[t, t+\\tau)$ 内没有 $C \\to O$ 转换发生的概率是 $\\exp\\!\\big(-n_C(t)\\,k_{CO}(V)\\,\\tau\\big)$。同样地，在 $[t, t+\\tau)$ 内没有 $O \\to C$ 转换发生的概率是 $\\exp\\!\\big(-n_O(t)\\,k_{OC}(V)\\,\\tau\\big)$。两种类型的事件都没有发生的概率是两者的乘积\n$$\nP(\\text{no event in }[t,t+\\tau)) \\;=\\; \\exp\\!\\big(-n_C(t)\\,k_{CO}(V)\\,\\tau\\big)\\,\\exp\\!\\big(-n_O(t)\\,k_{OC}(V)\\,\\tau\\big)\n\\;=\\; \\exp\\!\\big(-a_0\\,\\tau\\big),\n$$\n其中\n$$\na_0 \\;=\\; n_C(t)\\,k_{CO}(V) \\;+\\; n_O(t)\\,k_{OC}(V).\n$$\n因此，等待时间 $\\tau$ 服从速率为 $a_0$ 的指数分布。相应的密度为\n$$\nf(\\tau) \\;=\\; a_0\\,\\exp\\!\\big(-a_0\\,\\tau\\big), \\quad \\tau \\ge 0.\n$$\n接下来，我们推导事件选择概率。在所有 $n_C(t)+n_O(t)$ 个独立指数时钟中，最小值来自 $C \\to O$ 时钟集合的概率，等于该集合贡献的总速率除以总速率 $a_0$，这是竞争指数分布的一个标准属性。更正式地说，对于速率为 $\\{\\lambda_i\\}_{i=1}^m$ 的独立指数时钟，最早发生的事件由时钟 $j$ 引起的概率是 $\\lambda_j / \\sum_{i=1}^m \\lambda_i$。按反应类别分组，下一个事件是开放的概率是\n$$\nP(\\text{next is }C\\to O) \\;=\\; \\frac{n_C(t)\\,k_{CO}(V)}{a_0},\n$$\n下一个事件是关闭的概率是\n$$\nP(\\text{next is }O\\to C) \\;=\\; \\frac{n_O(t)\\,k_{OC}(V)}{a_0}.\n$$\n在给定事件类型的条件下，具体通道的身份在相应状态类别的通道中是均匀分布的，因为在电压钳下，一个类别内的所有通道都具有相同的速率。\n\n这些结果直接导出了在电压钳下该系统的Gillespie随机模拟算法（SSA）：\n- 计算每个反应类别的倾向性：$a_{CO} = n_C(t)\\,k_{CO}(V)$ 和 $a_{OC} = n_O(t)\\,k_{OC}(V)$，以及它们的总和 $a_0 = a_{CO} + a_{OC}$。\n- 从速率为 $a_0$ 的指数分布中抽取等待时间 $\\tau$，例如 $\\tau = -\\frac{1}{a_0}\\ln(u_1)$，其中 $u_1 \\sim \\mathrm{Uniform}(0,1)$。\n- 使用 $u_2 \\sim \\mathrm{Uniform}(0,1)$ 抽取事件类型：如果 $u_2  a_{CO}/a_0$，选择一个 $C \\to O$ 开放事件；否则选择一个 $O \\to C$ 关闭事件。\n- 从相应的状态类别中均匀随机选择一个具体通道，更新其状态，并更新计数 $n_C(t)$ 和 $n_O(t)$ 以及时间 $t \\leftarrow t + \\tau$。\n- 在电压钳下，$V$ 保持不变；重复以上步骤。\n\n逐项分析选项：\n- 选项 A：这完全符合在所述电压钳假设下的推导。它正确地给出了 $\\tau \\sim \\mathrm{Exponential}(a_0)$，其中 $a_0 = n_C(t)\\,k_{CO}(V) + n_O(t)\\,k_{OC}(V)$，正确的事件选择概率，以及标准的SSA步骤。结论：正确。\n- 选项 B：这断言等待时间为形状为 $N$ 的伽马（爱尔朗）分布，这是一个常见的误解。在 $N$ 个独立的指数时钟中，第一个事件发生的时间服从速率为总和的指数分布，而不是形状为 $N$ 的伽马分布。它也错误地为开放与关闭分配了相等的概率，忽略了 $n_C(t)$、$n_O(t)$ 和速率。结论：不正确。\n- 选项 C：这使用 $\\max\\{k_{CO}(V), k_{OC}(V)\\}$ 作为速率，忽略了通道数量和独立风险的累加性。下一个事件可以来自任一类别，总风险是总和，而不是最大值。它还错误地将事件类型确定性地与较大的速率挂钩，并将身份与“最快”的通道挂钩，这不符合竞争指数分布的工作方式。结论：不正确。\n- 选项 D：这描述了一个具有时变风险 $a_0(V(t+\\tau))$ 的非齐次泊松过程，并基于 $V(t+\\tau)$ 进行选择。在电压钳下，$V$ 在事件之间是恒定的，因此速率是恒定的，风险不是时变的。虽然当 $V$ 在事件之间连续演化时，这种形式可能是相关的，但它与问题中陈述的电压钳假设相矛盾。结论：在当前设置下不正确。\n- 选项 E：这个选项正确地得到了速率为 $a_0$ 的指数等待时间，但随后分配的事件选择概率忽略了通道数 $n_C(t)$ 和 $n_O(t)$，仅使用了单通道速率。正确的概率必须包括多重性因子 $n_C(t)$ 和 $n_O(t)$。结论：不正确。\n\n因此，在问题的假设下，选项A是正确和完整的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在学会模拟通道行为之后，生物物理学家的一个关键任务是执行逆向操作：从实验数据中估计模型参数。最大似然估计 (MLE) 是一个强大的统计学框架，用于寻找使观测数据出现概率最高的参数值。在这项练习  中，您将从一系列开放时间数据中推导通道关闭速率的最大似然估计，这是膜片钳分析中的一项基本技能。您还将计算克拉默-拉奥下界 (Cramér-Rao lower bound)，它为您估计的精度设定了一个理论上的极限。",
            "id": "3931900",
            "problem": "考虑一个单电压钳离子通道，其模型为一个具有开放（$O$）和关闭（$C$）两种状态的二态连续时间马尔可夫链（CTMC）。从开放到关闭的转换是一个速率恒为 $k_{OC}$ 的泊松过程，而从关闭到开放的转换速率恒为 $k_{CO}$。在固定电压和温度的稳态条件下，假设每个开放期都以一个 $O \\to C$ 转换结束，该转换在给定开放期开始的条件下是无记忆的。因此，开放停留时间 $\\tau$ 服从指数概率密度函数，该函数仅由关闭速率 $k_{OC}$ 决定。\n\n您从理想检测（无漏检短事件，无滤波失真）条件下单个通道的长时间记录中，获得了 $N$ 个独立的开放停留时间 $\\{\\tau_k\\}_{k=1}^{N}$。从泊松转换的等待时间的指数定律以及记录的开放停留时间的独立性出发，完成以下任务：\n\n1. 将观测样本 $\\{\\tau_k\\}_{k=1}^{N}$ 的似然函数写成 $k_{OC}$ 的函数，并推导出 $k_{OC}$ 的最大似然估计量。\n2. 使用基于对数似然函数负二阶导数期望的费雪信息 $I(k_{OC})$ 的定义，推导出 $k_{OC}$ 的任何无偏估计量方差的克拉默-拉奥下界（CRLB）。\n\n将您的最终结果表示为最大似然估计 $\\hat{k}_{OC}$ 和克拉默-拉奥下界的闭式解析表达式，用 $N$、$\\{\\tau_k\\}$ 和 $k_{OC}$ 表示。将这两个表达式一起作为您的最终答案。",
            "solution": "该问题要求进行与指数过程参数估计相关的两项推导：速率参数的最大似然估计量（MLE），以及该参数任何无偏估计量方差的克拉默-拉奥下界（CRLB）。\n\n首先，我们建立单个开放停留时间 $\\tau$ 的概率密度函数（PDF）。问题陈述，从开放状态 $O$ 到关闭状态 $C$ 的转换以恒定速率 $k_{OC}$ 发生。这意味着离子通道在转换到关闭状态之前停留在开放状态的时长是一个服从指数分布的随机变量。$\\tau$ 的概率密度函数（以速率 $k_{OC}$ 为参数）是：\n$$p(\\tau | k_{OC}) = k_{OC} \\exp(-k_{OC} \\tau), \\quad \\text{for } \\tau \\ge 0$$\n\n第一部分：最大似然估计量（$\\hat{k}_{OC}$）的推导\n\n我们给定了一个包含 $N$ 个独立同分布（i.i.d.）的开放停留时间的样本 $\\{\\tau_k\\}_{k=1}^{N}$。似然函数 $L(k_{OC})$ 是观测到这个特定样本的联合概率。由于观测值的独立性，似然函数是各个概率密度函数的乘积：\n$$L(k_{OC} | \\{\\tau_k\\}_{k=1}^{N}) = \\prod_{k=1}^{N} p(\\tau_k | k_{OC}) = \\prod_{k=1}^{N} \\left( k_{OC} \\exp(-k_{OC} \\tau_k) \\right)$$\n$$L(k_{OC}) = k_{OC}^{N} \\exp\\left(-k_{OC} \\sum_{k=1}^{N} \\tau_k\\right)$$\n\n为了找到使该函数最大化的 $k_{OC}$ 值，标准做法是最大化似然函数的自然对数，即对数似然函数 $\\mathcal{L}(k_{OC})$。这将乘积转换为求和，从而简化了数学计算。\n$$\\mathcal{L}(k_{OC}) = \\ln(L(k_{OC})) = \\ln\\left(k_{OC}^{N} \\exp\\left(-k_{OC} \\sum_{k=1}^{N} \\tau_k\\right)\\right)$$\n$$\\mathcal{L}(k_{OC}) = \\ln(k_{OC}^{N}) + \\ln\\left(\\exp\\left(-k_{OC} \\sum_{k=1}^{N} \\tau_k\\right)\\right)$$\n$$\\mathcal{L}(k_{OC}) = N \\ln(k_{OC}) - k_{OC} \\sum_{k=1}^{N} \\tau_k$$\n\n为了求最大值，我们计算对数似然函数关于 $k_{OC}$ 的一阶导数，并将其设为零。所得结果 $\\hat{k}_{OC}$ 即为最大似然估计值。\n$$\\frac{\\partial \\mathcal{L}(k_{OC})}{\\partial k_{OC}} = \\frac{\\partial}{\\partial k_{OC}} \\left( N \\ln(k_{OC}) - k_{OC} \\sum_{k=1}^{N} \\tau_k \\right) = \\frac{N}{k_{OC}} - \\sum_{k=1}^{N} \\tau_k$$\n将导数设为零：\n$$\\frac{N}{\\hat{k}_{OC}} - \\sum_{k=1}^{N} \\tau_k = 0$$\n求解 $\\hat{k}_{OC}$：\n$$\\frac{N}{\\hat{k}_{OC}} = \\sum_{k=1}^{N} \\tau_k$$\n$$\\hat{k}_{OC} = \\frac{N}{\\sum_{k=1}^{N} \\tau_k}$$\n这就是速率参数 $k_{OC}$ 的最大似然估计量。它是观测停留时间样本均值的倒数。\n\n为了验证这是一个最大值，我们检查二阶导数：\n$$\\frac{\\partial^2 \\mathcal{L}(k_{OC})}{\\partial k_{OC}^2} = \\frac{\\partial}{\\partial k_{OC}} \\left( \\frac{N}{k_{OC}} - \\sum_{k=1}^{N} \\tau_k \\right) = -\\frac{N}{k_{OC}^2}$$\n由于 $N  0$ 且 $k_{OC}^2  0$，二阶导数恒为负，这证实了对数似然函数是凹函数，我们的解确实是一个最大值。\n\n第二部分：克拉默-拉奥下界（CRLB）的推导\n\nCRLB 为任何无偏估计量的方差设定了一个下限。它被定义为费雪信息 $I(k_{OC})$ 的倒数。问题给出的费雪信息定义为：\n$$I(k_{OC}) = -E\\left[ \\frac{\\partial^2 \\mathcal{L}(k_{OC})}{\\partial k_{OC}^2} \\right]$$\n其中 $E[\\cdot]$ 表示期望算子。\n\n我们已经计算了对数似然函数的二阶导数：\n$$\\frac{\\partial^2 \\mathcal{L}(k_{OC})}{\\partial k_{OC}^2} = -\\frac{N}{k_{OC}^2}$$\n这个表达式相对于随机变量 $\\{\\tau_k\\}$ 是一个常数，因此其期望就是表达式本身：\n$$E\\left[ -\\frac{N}{k_{OC}^2} \\right] = -\\frac{N}{k_{OC}^2}$$\n将此代入费雪信息的公式中：\n$$I(k_{OC}) = - \\left( -\\frac{N}{k_{OC}^2} \\right) = \\frac{N}{k_{OC}^2}$$\n克拉默-拉奥下界是费雪信息的倒数：\n$$\\text{CRLB} = \\frac{1}{I(k_{OC})}$$\n$$\\text{CRLB} = \\frac{1}{N/k_{OC}^2} = \\frac{k_{OC}^2}{N}$$\n这是 $k_{OC}$ 的任何无偏估计量方差的理论下界。\n最终结果是最大似然估计量 $\\hat{k}_{OC}$ 和克拉默-拉奥下界 CRLB 的表达式。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{N}{\\sum_{k=1}^{N} \\tau_k} \\\\ \\frac{k_{OC}^{2}}{N} \\end{pmatrix}}$$"
        }
    ]
}