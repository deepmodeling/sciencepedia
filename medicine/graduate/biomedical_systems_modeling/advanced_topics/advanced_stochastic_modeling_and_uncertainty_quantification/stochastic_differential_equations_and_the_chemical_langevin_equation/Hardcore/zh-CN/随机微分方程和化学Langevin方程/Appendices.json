{
    "hands_on_practices": [
        {
            "introduction": "在生物化学系统建模中，我们常常需要在离散的分子数（$N$）和连续的浓度（$[X]$）这两种描述方式之间切换。虽然转换速率方程的确定性部分很简单，但化学朗之万方程（CLE）中的随机项随系统体积 $\\Omega$ 的缩放关系却并非无足轻重。这项练习  将指导您完成正确转换CLE噪声项的关键过程，揭示其与系统大小的根本依赖关系。",
            "id": "1517670",
            "problem": "在随机化学动力学的研究中，化学朗之万方程 (Chemical Langevin Equation, CLE) 为离散的随机模拟算法提供了一个连续近似。对于一个包含 $S$ 个化学物种、发生 $M$ 个反应的系统，其分子数的状态向量 $\\mathbf{N}(t) = (N_1(t), \\dots, N_S(t))$ 的演化遵循以下方程：\n\n$$dN_i(t) = \\sum_{j=1}^{M} \\nu_{ij} a_j(\\mathbf{N}(t)) dt + \\sum_{j=1}^{M} \\nu_{ij} \\sqrt{a_j(\\mathbf{N}(t))} dW_j(t)$$\n\n此处，$\\nu_{ij}$ 是物种 $i$ 的分子数因单次反应 $j$ 事件而发生的变化，$a_j(\\mathbf{N})$ 是反应 $j$ 的倾向函数，$dW_j(t)$ 是独立的维纳过程增量。\n\n考虑一个在体积为 $\\Omega$ 的恒定、充分混合的隔室中发生的简单二聚反应：\n$$2X \\xrightarrow{k} Y$$\n微观速率常数为 $k$。此反应的倾向函数由 $a(N_X) = \\frac{k}{2}N_X(N_X-1)$ 给出，其中 $N_X$ 是物种 $X$ 的分子数。为解决此问题，我们假设分子数很大，从而可以使用近似 $a(N_X) \\approx \\frac{k}{2}N_X^2$。\n\n在宏观化学动力学中，同一个反应用浓度来描述，我们将其表示为 $x(t) = N_X(t)/\\Omega$。其确定性速率方程为 $\\frac{dx}{dt} = -2k_c x^2$，其中 $k_c$ 是宏观速率常数。\n\n通过将分子数 $N_X(t)$ 的化学朗之万方程转换为关于浓度 $x(t)$ 的方程，您将得到一个形式如下的新的朗之万方程：\n$$dx = f(x, k_c) dt + g(x, \\Omega, k_c) dW(t)$$\n其中 $dW(t)$ 是与该二聚反应相关的单个维纳过程。\n\n请确定描述浓度朗之万方程中噪声项的函数 $g(x, \\Omega, k_c)$。您的答案应为一个以 $x$、$\\Omega$ 和 $k_c$ 表示的表达式。",
            "solution": "我们考虑单个反应 $2X \\to Y$，对于物种 $X$，其化学计量变化为 $\\nu_{X}=-2$，在大分子数近似下，其倾向函数为 $a(N_{X}) \\approx \\frac{k}{2}N_{X}^{2}$。$N_{X}(t)$ 的化学朗之万方程 (CLE) 为\n$$\ndN_{X}(t) \\;=\\; \\nu_{X}\\,a(N_{X})\\,dt \\;+\\; \\nu_{X}\\,\\sqrt{a(N_{X})}\\,dW(t)\n\\;=\\; -2\\,a(N_{X})\\,dt \\;-\\;2\\,\\sqrt{a(N_{X})}\\,dW(t).\n$$\n定义浓度 $x(t)=N_{X}(t)/\\Omega$。由于 $x$ 是 $N_{X}$ 的线性函数，我们有\n$$\ndx \\;=\\; \\frac{1}{\\Omega}\\,dN_{X} \\;=\\; -\\frac{2}{\\Omega}\\,a(N_{X})\\,dt \\;-\\;\\frac{2}{\\Omega}\\,\\sqrt{a(N_{X})}\\,dW(t).\n$$\n使用 $N_{X}=\\Omega x$ 和 $a(N_{X}) \\approx \\frac{k}{2}(\\Omega x)^{2}=\\frac{k}{2}\\Omega^{2}x^{2}$，上式变为\n$$\ndx \\;=\\; -k\\,\\Omega\\,x^{2}\\,dt \\;-\\;2\\,x\\,\\sqrt{\\frac{k}{2}}\\,dW(t).\n$$\n为用宏观速率常数 $k_{c}$ 表示结果，我们将确定性漂移项与宏观速率方程 $\\frac{dx}{dt}=-2k_{c}x^{2}$ 进行匹配。从 $-k\\,\\Omega\\,x^{2}=-2k_{c}x^{2}$，我们得到\n$$\nk_{c} \\;=\\; \\frac{k\\,\\Omega}{2}, \\qquad \\text{所以} \\qquad \\frac{k}{2} \\;=\\; \\frac{k_{c}}{\\Omega}.\n$$\n将此代入噪声系数可得\n$$\ng(x,\\Omega,k_{c}) \\;=\\; -2\\,x\\,\\sqrt{\\frac{k}{2}} \\;=\\; -2\\,x\\,\\sqrt{\\frac{k_{c}}{\\Omega}}.\n$$\n由于浓度 $x \\ge 0$，因此不需要绝对值。这就是浓度朗之万方程 $dx=f(x,k_{c})\\,dt+g(x,\\Omega,k_{c})\\,dW(t)$ 中的噪声振幅。",
            "answer": "$$\\boxed{-2\\,x\\,\\sqrt{\\frac{k_{c}}{\\Omega}}}$$"
        },
        {
            "introduction": "在推导出化学朗之万方程之后，下一步通常是数值模拟其行为。对于具有状态依赖性噪声（这是大多数化学系统的标志）的随机微分方程，米尔斯坦（Milstein）方法是一种强大的工具，它改进了基本的欧拉-丸山（Euler-Maruyama）格式，提供了更高阶的精度。这项综合练习  将带您走过整个工作流程：从为一个生灭过程推导CLE及其特定的米尔斯坦校正项，到从零开始实现一个完整的数值模拟。",
            "id": "3931632",
            "problem": "考虑一个在生物医学系统建模中广泛用于表示生物分子的组成性合成和一级降解的单物种生灭反应网络。该网络包含两个反应，其化学计量和倾向如下：\n- 产生：$\\varnothing \\rightarrow X$，倾向为 $a_1(x) = k_p$。\n- 降解：$X \\rightarrow \\varnothing$，倾向为 $a_2(x) = k_d x$。\n从具有倾向和化学计量的标准随机反应框架出发，化学朗之万方程（CLE）为分子数量 $X_t$（单位：分子）产生一个标量 Itô 随机微分方程（SDE），形式如下：\n$$\ndX_t = f(X_t)\\,dt + \\Gamma(X_t)\\,dW_t,\n$$\n其中 $f(x)$ 是确定性漂移，$\\Gamma(x)$ 是由反应散粒噪声引起的噪声振幅。假设 $k_p$ 的单位是“分子/秒”，$k_d$ 的单位是“1/秒”，时间单位是秒，分子数量被视为连续实数值（单位：分子）。请实现一个用于乘性噪声的强一阶 Milstein 时间步进方法，该方法明确包含涉及状态导数 $\\partial_x \\Gamma(x)$ 的校正项。\n\n你的任务：\n1) 仅使用化学计量定义以及倾向与 CLE 之间的标准联系，从第一性原理出发，推导该网络中漂移 $f(x)$ 和噪声振幅 $\\Gamma(x)$ 的表达式。\n2) 计算 $\\partial_x \\Gamma(x)$ 并获得在单个时间步长 $\\Delta t$ 中乘以二次变分项的 Milstein 校正系数。\n3) 实现一个程序，使用 Milstein 格式为一系列独立高斯增量模拟 CLE。令 $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ 由一个固定的、可复现的伪随机数生成器生成。用种子 $1729$ 初始化伪随机数生成器，然后按顺序抽取所有测试用例消耗的所有高斯增量，不要在测试用例之间重置种子。\n4) 对于下方的每个测试用例，从初始条件 $X_0$ 开始，以步长 $\\Delta t$ 运行模拟 $N$ 步，并输出最终值 $X_{N}$（单位：分子），格式为浮点数，精确到小数点后六位。\n\n重要实现细节：\n- 使用针对标量乘性噪声的 Milstein 更新方法，并为此系统使用精确的 $\\partial_x \\Gamma(x)$。\n- 使用双精度算术。\n- 将增量生成为 $\\Delta W_n = \\sqrt{\\Delta t}\\,Z_n$，其中 $Z_n \\sim \\mathcal{N}(0,1)$。\n- 除了 Milstein 方法本身得出的结果外，不要引入额外的正性校正或边界条件；状态 $X_n$ 可以取实数值，并代表对分子计数的连续近似。\n\n测试套件（所有参数均采用 SI 一致单位）：\n- 用例 A（正常路径）：$k_p = 50$, $k_d = 0.1$, $X_0 = 400$, $\\Delta t = 0.01$, $N = 100$。\n- 用例 B（低噪声，慢动态）：$k_p = 0.5$, $k_d = 0.001$, $X_0 = 500$, $\\Delta t = 0.1$, $N = 10$。\n- 用例 C（接近零的初始条件）：$k_p = 5$, $k_d = 2$, $X_0 = 0$, $\\Delta t = 0.001$, $N = 1000$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个方括号内的逗号分隔列表（例如，“[xA,xB,xC]”），每个条目是对应测试用例的最终分子数量，四舍五入到小数点后六位（输出字符串中不含单位）。不要打印任何其他文本。",
            "solution": "问题陈述具有科学依据、提法恰当，并包含了进行下一步所需的所有信息。它描述了一个由化学朗之万方程（CLE）建模的生灭过程，将使用 Milstein 方法进行数值求解。参数和条件在物理上和数学上都是一致的。\n\n### 1. 化学朗之万方程的推导\n\n该问题描述了一个具有状态变量 $X$ 的单物种反应网络，其中 $X$ 代表分子数。该网络包含两个反应通道：\n1.  **产生：** $\\varnothing \\stackrel{k_p}{\\longrightarrow} X$。该反应的倾向（或速率）是常数，$a_1(x) = k_p$。此反应发生后 $X$ 的变化为 $\\nu_1 = +1$。\n2.  **降解：** $X \\stackrel{k_d}{\\longrightarrow} \\varnothing$。该反应的倾向与分子数成正比，$a_2(x) = k_d x$。$X$ 的变化为 $\\nu_2 = -1$。\n\n对于一个有 $M$ 个反应通道的系统，化学朗之万方程（CLE）的一般形式是在状态空间连续且倾向在小时间间隔 $\\Delta t$ 内不发生显著变化的假设下，从化学主方程推导出来的。对于一个标量系统，在无穷小时间间隔 $dt$ 内的变化 $dX_t$ 由下式给出：\n$$\ndX_t = \\left( \\sum_{j=1}^{M} \\nu_j a_j(X_t) \\right) dt + \\sum_{j=1}^{M} \\nu_j \\sqrt{a_j(X_t)} dW_{j,t}\n$$\n其中 $dW_{j,t}$ 是独立的维纳过程。整个随机过程可以由单个有效的维纳过程 $dW_t$ 来表示，从而得到标准的 Itô SDE 形式：\n$$\ndX_t = f(X_t) dt + \\Gamma(X_t) dW_t\n$$\n\n漂移项 $f(x)$ 代表确定性变化率，是化学计量变化乘以其各自倾向的总和。\n$$\nf(x) = \\sum_{j=1}^{2} \\nu_j a_j(x) = (\\nu_1 \\cdot a_1(x)) + (\\nu_2 \\cdot a_2(x)) = (+1 \\cdot k_p) + (-1 \\cdot k_d x)\n$$\n因此，漂移项为：\n$$\nf(x) = k_p - k_d x\n$$\n\n噪声振幅 $\\Gamma(x)$ 捕捉了离散反应事件引起的随机波动。随机项的方差必须保持不变。独立噪声项之和的方差是它们方差的和。$\\Gamma(X_t) dW_t$ 的方差是 $\\Gamma(X_t)^2 dt$。这必须等于原始和的方差：\n$$\n\\text{Var}\\left( \\sum_{j=1}^{2} \\nu_j \\sqrt{a_j(X_t)} dW_{j,t} \\right) = \\sum_{j=1}^{2} \\nu_j^2 a_j(X_t) dt\n$$\n因此，我们有：\n$$\n\\Gamma(x)^2 = \\sum_{j=1}^{2} \\nu_j^2 a_j(x) = (\\nu_1^2 \\cdot a_1(x)) + (\\nu_2^2 \\cdot a_2(x)) = ((+1)^2 \\cdot k_p) + ((-1)^2 \\cdot k_d x)\n$$\n这可以简化为：\n$$\n\\Gamma(x)^2 = k_p + k_d x\n$$\n取振幅的正平方根，我们得到：\n$$\n\\Gamma(x) = \\sqrt{k_p + k_d x}\n$$\n综合这些结果，该生灭过程的特定 CLE 为：\n$$\ndX_t = (k_p - k_d X_t) dt + \\sqrt{k_p + k_d X_t} dW_t\n$$\n该方程是一种平方根扩散过程，也称为 Cox-Ingersoll-Ross (CIR) 过程。\n\n### 2. Milstein 数值格式\n\nMilstein 方法是一种求解 SDE 的强一阶数值格式，它通过包含一个校正项来考虑噪声振幅随状态的变化，从而在强 0.5 阶的 Euler-Maruyama 格式基础上进行了改进。对于一个标量 Itô SDE $dX_t = f(X_t) dt + \\Gamma(X_t) dW_t$，其离散更新规则为：\n$$\nX_{n+1} = X_n + f(X_n) \\Delta t + \\Gamma(X_n) \\Delta W_n + \\frac{1}{2} \\Gamma(X_n) \\frac{\\partial \\Gamma}{\\partial x}(X_n) \\left( (\\Delta W_n)^2 - \\Delta t \\right)\n$$\n其中 $\\Delta W_n = W_{t_{n+1}} - W_{t_n}$ 是一个来自均值为 0、方差为 $\\Delta t$ 的正态分布的随机增量。\n\n要实现这一点，我们必须计算噪声振幅 $\\Gamma(x)$ 对 $x$ 的导数：\n$$\n\\Gamma(x) = (k_p + k_d x)^{1/2}\n$$\n使用链式法则：\n$$\n\\frac{\\partial \\Gamma}{\\partial x}(x) = \\frac{1}{2} (k_p + k_d x)^{-1/2} \\cdot \\frac{d}{dx}(k_p + k_d x) = \\frac{1}{2} (k_p + k_d x)^{-1/2} \\cdot k_d\n$$\n$$\n\\frac{\\partial \\Gamma}{\\partial x}(x) = \\frac{k_d}{2 \\sqrt{k_p + k_d x}}\n$$\n现在，我们可以计算 Milstein 校正项的系数 $\\frac{1}{2} \\Gamma(x) \\frac{\\partial \\Gamma}{\\partial x}(x)$：\n$$\n\\frac{1}{2} \\Gamma(x) \\frac{\\partial \\Gamma}{\\partial x}(x) = \\frac{1}{2} \\left( \\sqrt{k_p + k_d x} \\right) \\left( \\frac{k_d}{2 \\sqrt{k_p + k_d x}} \\right)\n$$\n$\\sqrt{k_p + k_d x}$ 项相互抵消，留下一个非常简单的常数：\n$$\n\\frac{1}{2} \\Gamma(x) \\frac{\\partial \\Gamma}{\\partial x}(x) = \\frac{k_d}{4}\n$$\n将推导出的各项代入 Milstein 更新规则，我们得到了此问题的具体算法：\n$$\nX_{n+1} = X_n + (k_p - k_d X_n) \\Delta t + \\sqrt{k_p + k_d X_n} \\Delta W_n + \\frac{k_d}{4} \\left( (\\Delta W_n)^2 - \\Delta t \\right)\n$$\n此方程将用于模拟 $X_t$ 的轨迹。\n\n### 3. 算法设计与实现\n\n模拟将针对三个测试用例进行。一个关键要求是使用单个伪随机数生成器，只设定一次种子，为所有测试用例顺序生成全部高斯增量。\n\n算法流程如下：\n1.  为所有测试用例定义参数：$(k_p, k_d, X_0, \\Delta t, N)$。\n2.  计算所有测试用例所需的总模拟步数。\n3.  使用指定的种子 $1729$ 初始化一个伪随机数生成器（RNG）。\n4.  在单次调用 RNG 时生成所有所需的标准正态变量 $Z_n \\sim \\mathcal{N}(0,1)$。这确保了可复现性和顺序使用。\n5.  遍历每个测试用例：\n    a. 使用其初始条件 $X_0$ 初始化状态变量 $X$。\n    b. 对于当前测试用例中的 $N$ 步中的每一步：\n        i. 从预生成的数组中检索下一个标准正态变量 $Z_n$。\n        ii. 计算维纳增量：$\\Delta W_n = \\sqrt{\\Delta t} \\cdot Z_n$。\n        iii. 评估漂移 $f(X_n) = k_p - k_d X_n$。\n        iv. 评估噪声振幅 $\\Gamma(X_n) = \\sqrt{k_p + k_d X_n}$。没有为 $X_n$ 添加显式的正性约束，但平方根的参数必须为非负，以使模拟保持在实数域内。问题的参数设置使得这预计不会成为一个问题。\n        v. 应用上面推导出的 Milstein 更新规则来计算 $X_{n+1}$。\n    c. 经过 $N$ 步后，$X$ 的最终值就是该测试用例的结果。\n6.  将每个最终值四舍五入到小数点后六位。\n7.  按照指定格式，将结果格式化为方括号内的一个逗号分隔字符串。\n\n所有计算都使用双精度浮点运算（在 Python 中为 `numpy.float64`）以保持数值精度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a birth-death process using the Chemical Langevin Equation\n    and the Milstein method for three test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (kp, kd, X0, dt, N_steps)\n    test_cases = [\n        # Case A: happy path\n        (50.0, 0.1, 400.0, 0.01, 100),\n        # Case B: low-noise, slow dynamics\n        (0.5, 0.001, 500.0, 0.1, 10),\n        # Case C: near-zero initial condition\n        (5.0, 2.0, 0.0, 0.001, 1000),\n    ]\n\n    # Calculate total number of random increments needed for all simulations.\n    total_steps = sum(case[4] for case in test_cases)\n\n    # Initialize the pseudo-random number generator with the specified seed.\n    # Generate all standard normal variates (Z ~ N(0,1)) in a single batch\n    # to ensure they are consumed sequentially across test cases.\n    # Use double-precision floating-point numbers.\n    rng = np.random.default_rng(seed=1729)\n    all_z_variates = rng.standard_normal(size=total_steps, dtype=np.float64)\n\n    results = []\n    z_cursor = 0\n\n    # Process each test case.\n    for case in test_cases:\n        kp, kd, x0, dt, n_steps = case\n\n        # Assign the state variable, ensuring it is a float.\n        x = float(x0)\n        \n        # Pre-calculate constants for the loop.\n        sqrt_dt = np.sqrt(dt)\n        milstein_coeff = kd / 4.0\n\n        # Get the slice of random variates for this specific case.\n        z_case_variates = all_z_variates[z_cursor : z_cursor + n_steps]\n        z_cursor += n_steps\n\n        # Run the Milstein simulation for N steps.\n        for i in range(n_steps):\n            # Wiener increment dW ~ N(0, dt)\n            dw = sqrt_dt * z_case_variates[i]\n\n            # Drift term\n            f_x = kp - kd * x\n            \n            # Diffusion term. The argument of the sqrt must be non-negative.\n            # The problem parameters are chosen to make this a rare event,\n            # but for numerical stability, we handle it.\n            arg_sqrt = kp + kd * x\n            if arg_sqrt  0.0:\n                # If X ventures into a region where the SDE is ill-defined\n                # for real numbers, the simulation path becomes invalid.\n                # In a robust solver, one might use reflection or absorption,\n                # but per instructions, we do not add such corrections.\n                # We set gamma_x to 0 to prevent a domain error and let the\n                # drift term dominate.\n                gamma_x = 0.0\n            else:\n                gamma_x = np.sqrt(arg_sqrt)\n\n            # Milstein update equation:\n            # X_t+1 = X_t + f(X_t)dt + G(X_t)dW + (1/2)G(X_t)G'(X_t)(dW^2-dt)\n            # where (1/2)G(X_t)G'(X_t) simplifies to kd/4.\n            x = x + f_x * dt + gamma_x * dw + milstein_coeff * (dw**2 - dt)\n        \n        # Format the final result to exactly six decimal places.\n        results.append(f\"{x:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "作为离散过程的连续近似，化学朗之万方程有时会产生非物理性的结果，例如负的分子数，尤其是在分子数为零的边界附近。临时性的修补可能会引入人为误差，因此严谨的方法对于建立稳健的模型至关重要。这项练习  深入探讨了施加边界条件的规范数学机制，将反射边界和吸收边界的严格定义与常见但有缺陷的数值启发式方法进行了对比。",
            "id": "3294864",
            "problem": "考虑一个均匀混合区室中的单物种随机反应系统。$X$ 物种的分子通过一个倾向为 $a_{+}(x)$ 的零级反应 $\\varnothing \\to X$ 生成，并通过一个倾向为 $a_{-}(x)$ 的一级反应 $X \\to \\varnothing$ 降解，其中 $x$ 表示分子数，在该近似中被视为连续状态变量。化学主方程 (Chemical Master Equation, CME) 控制着整数分子数上概率的精确离散时间演化。化学朗之万方程 (Chemical Langevin Equation, CLE) 是一个连续状态的随机微分方程近似，它是通过调用反应计数过程的中心极限定理行为得到的，从而用高斯近似取代了跳跃噪声。众所周知，无约束的 CLE 轨迹在 $x=0$ 附近可以取到负值，这对于分子数来说是非物理的。\n\n从这些建模基础以及随机过程理论和偏微分方程的基本定义出发，分析在边界 $x=0$ 处的非负性问题，并确定下列哪些陈述正确且严谨地说明了如何在该处施加反射或吸收边界条件以防止出现负值。假设倾向函数的形式为 $a_{+}(x)=k_{+}$ 和 $a_{-}(x)=k_{-} x$，其中 $k_{+}0$ 且 $k_{-}0$。在这里，化学朗之万方程 (CLE) 被理解为一个一维 Itô 随机微分方程 (SDE)，其关联的前向 Kolmogorov 方程是福克-普朗克方程 (Fokker–Planck Equation, FPE)。选择所有正确的陈述。\n\nA. CLE 在 $x=0$ 处的反射边界可以通过求解在 $[0,\\infty)$ 上的 Skorokhod 反射问题来施加：引入一个适应的、非递减的过程 $L_{t}^{0}$，满足 $L_{0}^{0}=0$，且仅在 $X_{t}=0$ 时增加，并将无约束的 CLE 替换为\n$$\ndX_{t}=\\mu(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}+dL_{t}^{0},\\quad X_{t}\\ge 0,\\quad \\int_{0}^{t}\\mathbf{1}_{\\{X_{s}0\\}}\\,dL_{s}^{0}=0,\n$$\n其中 $\\mu(x)$ 和 $\\sigma(x)$ 是 CLE 的漂移系数和扩散系数，而 $W_{t}$ 是一个标准维纳过程。\n\nB. CLE 在 $x=0$ 处的吸收边界可以通过在首次到达时间 $\\tau_{0}=\\inf\\{t\\ge 0:X_{t}=0\\}$ 停止过程，并对所有 $t\\ge \\tau_{0}$ 设 $X_{t}=0$ 来施加。也就是说，在 $[0,\\tau_{0})$ 上求解无约束的 CLE，然后将状态保持在 0。\n\nC. 在半直线 $x0$ 上的 CLE 对应的福克-普朗克方程中，通过狄利克雷边界条件 $p(0,t)=0$（对于 $t0$）来实现 $x=0$ 处的吸收边界，其中 $p(x,t)$ 是在 $(0,\\infty)$ 上的概率密度，通过 $x=0$ 的概率损失等于向外的概率通量 $-J(0,t)$。\n\nD. 在半直线 $x0$ 上的 CLE 对应的福克-普朗克方程中，通过零通量（诺伊曼型）边界条件 $J(0,t)=0$ 来实现 $x=0$ 处的反射边界，其中概率通量为\n$$\nJ(x,t)=\\mu(x)\\,p(x,t)-\\frac{1}{2}\\,\\partial_{x}\\!\\big(\\sigma^{2}(x)\\,p(x,t)\\big).\n$$\n\nE. 一个计算上方便的、在数学上等价于反射的修正是，在每个时间步后通过用 $\\max\\{X_{t},0\\}$ 替换 $X_{t}$ 将状态投影回半直线；这种投影保持了在 $x=0$ 处正确的福克-普朗克边界通量。\n\nF. 对于状态依赖的扩散，在 $x=0$ 处进行反射的一个简单方法是，每当 $X_{t}$ 接近 0 时，翻转噪声增量的符号，即当 $X_{t}\\approx 0$ 时使用 $dX_{t}=\\mu(X_{t})\\,dt-\\sigma(X_{t})\\,dW_{t}$，这会产生一条反射的 CLE 轨迹，而无需辅助过程。",
            "solution": "在尝试求解之前，对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知条件\n-   **系统：** 一个均匀混合区室中的单物种随机反应系统。\n-   **物种：** $X$。\n-   **反应：**\n    1.  零级生成：$\\varnothing \\to X$。\n    2.  一级降解：$X \\to \\varnothing$。\n-   **状态变量：** $x$，$X$ 物种的分子数，被视为连续变量。\n-   **倾向函数：**\n    -   生成：$a_{+}(x)=k_{+}$，其中 $k_{+}0$。\n    -   降解：$a_{-}(x)=k_{-} x$，其中 $k_{-}0$。\n-   **模型：** 化学朗之万方程 (CLE)，一个 Itô 随机微分方程 (SDE)，它是化学主方程 (CME) 的近似。\n-   **关联的偏微分方程 (PDE)：** 福克-普朗克方程 (FPE)。\n-   **核心问题：** 无约束的 CLE 会产生非物理的负值 $x$。任务是分析指定如何在 $x=0$ 处施加反射或吸收边界条件以确保非负性的陈述。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了一个基本的生灭过程，这是随机化学动力学的基石。化学朗之万方程是计算系统生物学中一种标准的、成熟的近似方法。其轨迹变为负值以及需要边界条件的问题是该领域的核心和被广泛研究的课题。所有概念（SDE、FPE、边界条件）都是严格定义的数学对象。该问题在科学和数学上是合理的。\n2.  **良定性：** 任务是评估关于特定随机过程边界条件的几个形式化数学陈述的正确性。这是一个定义明确的问题，可以根据已建立的理论确定一组正确答案。\n3.  **客观性：** 该问题以数学和物理学的精确技术语言陈述。这些选项是可以根据随机过程理论的原理进行客观验证的形式化陈述。\n\n该问题没有任何验证标准中列出的缺陷（例如，事实不成立、含糊不清、自相矛盾）。问题设定是自洽的，足以进行分析。\n\n### 步骤 3：结论与行动\n问题陈述是**有效的**。将推导解答。\n\n### 分析\n首先，我们为给定系统构建无约束的化学朗之万方程 (CLE)。反应是 $R_1: \\varnothing \\xrightarrow{k_+} X$ 和 $R_2: X \\xrightarrow{k_-} \\varnothing$。状态向量只是标量 $x$。化学计量向量，它指定了每次反应中 $x$ 的变化，是 $S = (+1, -1)$。倾向函数向量是 $a(x) = (a_+(x), a_-(x)) = (k_+, k_- x)$。\n\nCLE 的一般形式是一个 Itô SDE：\n$$ dX_t = \\mu(X_t) dt + \\sigma(X_t) dW_t $$\n其中 $dW_t$ 是一个标准维纳过程。漂移系数 $\\mu(x)$ 和扩散系数 $\\sigma(x)$ 由下式给出：\n$$ \\mu(x) = \\sum_j S_j a_j(x) = (1)(k_+) + (-1)(k_- x) = k_+ - k_- x $$\n$$ \\sigma^2(x) = \\sum_j S_j^2 a_j(x) = (1)^2(k_+) + (-1)^2(k_- x) = k_+ + k_- x $$\n因此，该系统的无约束 CLE 是：\n$$ dX_t = (k_+ - k_- X_t) dt + \\sqrt{k_+ + k_- X_t} dW_t $$\n扩散项包含状态变量 $X_t$，突显了噪声是状态依赖的。如果没有约束，维纳过程的增量可以将 $X_t$ 驱动到负值，这对于粒子数来说是物理上无意义的。这使得在 $x=0$ 处施加边界条件成为必要。\n\n概率密度 $p(x,t)$ 对应的福克-普朗克方程 (FPE) 是：\n$$ \\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} J(x,t) $$\n其中 $J(x,t)$ 是概率通量：\n$$ J(x,t) = \\mu(x)p(x,t) - \\frac{1}{2} \\frac{\\partial}{\\partial x} \\left( \\sigma^2(x)p(x,t) \\right) $$\n\n我们现在根据标准的随机过程理论评估每个陈述。\n\n**A. CLE 在 $x=0$ 处的反射边界可以通过求解在 $[0,\\infty)$ 上的 Skorokhod 反射问题来施加：引入一个适应的、非递减的过程 $L_{t}^{0}$，满足 $L_{0}^{0}=0$，且仅在 $X_{t}=0$ 时增加，并将无约束的 CLE 替换为**\n$$\ndX_{t}=\\mu(X_{t})\\,dt+\\sigma(X_{t})\\,dW_{t}+dL_{t}^{0},\\quad X_{t}\\ge 0,\\quad \\int_{0}^{t}\\mathbf{1}_{\\{X_{s}0\\}}\\,dL_{s}^{0}=0,\n$$\n**其中 $\\mu(x)$ 和 $\\sigma(x)$ 是 CLE 的漂移系数和扩散系数，而 $W_{t}$ 是一个标准维纳过程。**\n\n这个陈述描述了在带边界的域上构造反射 Itô 过程的规范方法。该方程是一个反射随机微分方程 (RSDE)。$L_t^0$ 项是一个连续的、非递减的过程，表示将过程 $X_t$ 保持在区域 $[0, \\infty)$ 内所需的累积“推力”。条件 $\\int_{0}^{t}\\mathbf{1}_{\\{X_{s}0\\}}\\,dL_{s}^{0}=0$ 在数学上强制这个推力仅在过程位于边界上时施加，即当 $X_t = 0$ 时。这是从 Skorokhod 问题导出的反射 SDE 的精确和正确的表述。\n\n**结论：正确。**\n\n**B. CLE 在 $x=0$ 处的吸收边界可以通过在首次到达时间 $\\tau_{0}=\\inf\\{t\\ge 0:X_{t}=0\\}$ 停止过程，并对所有 $t\\ge \\tau_{0}$ 设 $X_{t}=0$ 来施加。也就是说，在 $[0,\\tau_{0})$ 上求解无约束的 CLE，然后将状态保持在 0。**\n\n这个陈述给出了随机过程吸收边界的定义。首次到达时间 $\\tau_0$ 标记了过程到达边界 $x=0$ 的时刻。通过在此时停止过程的演化并将其状态固定在吸收点，可以正确地实现吸收边界。过程自由演化直到碰到边界，此时它被“吸收”并无限期地保持在那里。这是与吸收相对应的停止过程的标准定义。\n\n**结论：正确。**\n\n**C. 在半直线 $x0$ 上的 CLE 对应的福克-普朗克方程中，通过狄利克雷边界条件 $p(0,t)=0$（对于 $t0$）来实现 $x=0$ 处的吸收边界，其中 $p(x,t)$ 是在 $(0,\\infty)$ 上的概率密度，通过 $x=0$ 的概率损失等于向外的概率通量 $-J(0,t)$。**\n\n对于 FPE，在 $x=0$ 处的吸收边界意味着任何到达边界的概率质量都会从感兴趣的区域 $(0,\\infty)$ 中被移除。这是通过将边界处的概率密度设置为零来实现的，即狄利克雷条件：$p(0,t)=0$。在区域 $(0, \\infty)$ 内总概率 $P(t) = \\int_0^\\infty p(x,t) dx$ 的变化率由散度定理给出：\n$$ \\frac{d P(t)}{dt} = \\int_0^\\infty \\frac{\\partial p}{\\partial t} dx = \\int_0^\\infty \\left( -\\frac{\\partial J}{\\partial x} \\right) dx = -[J(x,t)]_{x=0}^{x=\\infty} = J(0,t) - J(\\infty,t) $$\n假设物理上合理的条件，即无穷远处的通量为零，$J(\\infty,t)=0$，我们得到 $\\frac{d P(t)}{dt} = J(0,t)$。这意味着区域内概率的变化率等于在边界处进入的通量。因此，从区域中*损失*的概率率为 $-J(0,t)$。该陈述完全正确。\n\n**结论：正确。**\n\n**D. 在半直线 $x0$ 上的 CLE 对应的福克-普朗克方程中，通过零通量（诺伊曼型）边界条件 $J(0,t)=0$ 来实现 $x=0$ 处的反射边界，其中概率通量为**\n$$\nJ(x,t)=\\mu(x)\\,p(x,t)-\\frac{1}{2}\\,\\partial_{x}\\!\\big(\\sigma^{2}(x)\\,p(x,t)\\big).\n$$\n反射边界防止任何概率离开区域 $[0, \\infty)$。这意味着穿过边界的净概率通量在所有时间都必须为零，即 $J(0,t)=0$。这个条件保证了总概率的守恒。所提供的概率通量 $J(x,t)$ 的公式是对应于 FPE 的通用 Itô 过程的正确表达式。由于通量表达式涉及 $p(x,t)$ 的空间导数，该条件是一个诺伊曼型边界条件。该陈述准确地描述了反射边界的 FPE 实现。\n\n**结论：正确。**\n\n**E. 一个计算上方便的、在数学上等价于反射的修正是，在每个时间步后通过用 $\\max\\{X_{t},0\\}$ 替换 $X_{t}$ 将状态投影回半直线；这种投影保持了在 $x=0$ 处正确的福克-普朗克边界通量。**\n\n这描述了一种常见的数值启发式方法。在离散时间步长中，如果 $X_{t+\\Delta t}$ 变为负数，它被重置为 0。这个过程在数学上*不等同于*一个真正的反射。如 A 和 D 中定义的真正反射，意味着边界处的零通量条件，这通常导致在边界处非零的平滑概率密度。投影方法导致轨迹“粘”在边界上，在 $x=0$ 处精确地造成概率质量的人为积累。这更类似于“粘性”边界，并且违反了定义反射的零通量条件 $J(0,t)=0$。因此，数学上等价的说法是错误的。\n\n**结论：不正确。**\n\n**F. 对于状态依赖的扩散，在 $x=0$ 处进行反射的一个简单方法是，每当 $X_{t}$ 接近 0 时，翻转噪声增量的符号，即当 $X_{t}\\approx 0$ 时使用 $dX_{t}=\\mu(X_{t})\\,dt-\\sigma(X_{t})\\,dW_{t}$，这会产生一条反射的 CLE 轨迹，而无需辅助过程。**\n\n这个陈述提出了另一种临时的数值修正方法。虽然这个想法受到标准布朗运动反射原理的启发（其中 $|W_t|$ 的法定律对应于一个反射过程），但这个原理不能简单地推广到具有状态依赖的漂移和扩散系数的一般 SDE。将 SDE 更改为 $dX_t = \\mu(X_t)dt - \\sigma(X_t)dW_t$ 不是一个边界条件；它完全定义了一个不同的随机过程。这种修改通常不会产生一个其概率密度函数满足带有正确反射边界条件 $J(0,t)=0$ 的 FPE 的过程。反射的严谨方法是选项 A 中提出的 Skorokhod 构造。所提出的启发式方法在数学上对于在这种情况下生成真正的反射过程是不合理的。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{ABCD}$$"
        }
    ]
}