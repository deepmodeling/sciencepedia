{
    "hands_on_practices": [
        {
            "introduction": "我们对不确定性量化和传播的实践探索始于一个看似简单但极具启发性的问题。我们将使用区间算术来估计一个药代动力学模型输出的不确定性，这种方法直观易懂。然而，这个练习  的核心目的在于揭示一个常见的陷阱：当模型中的多个部分依赖于同一个不确定参数时，忽略这种依赖性会导致对不确定性的严重高估。",
            "id": "3941594",
            "problem": "使用单受试者线性药代动力学模型来量化同一药物两次独立静脉推注给药后的暴露量。在线性药代动力学中，静脉推注的血浆浓度-时间曲线下面积 (AUC) 由公式 $ \\mathrm{AUC} = \\mathrm{Dose}/\\mathrm{CL} $ 给出，其中 $ \\mathrm{CL} $ 是系统清除率。假设同一受试者接受两次推注剂量，$ D_{1} = 100\\,\\mathrm{mg} $ 和 $ D_{2} = 150\\,\\mathrm{mg} $，两次给药间隔时间足够长，以确保两次的药代动力学过程相互独立。该受试者的真实清除率 $ \\mathrm{CL} $ 在两次给药中保持恒定，但对建模者而言存在认知不确定性，仅知其位于区间 $ \\mathrm{CL} \\in [3.0,\\,5.0]\\,\\mathrm{L\\,h^{-1}} $ 内。\n\n将暴露比率 $ R $ 定义为两次给药的 AUC 之比：\n$$\nR = \\frac{\\mathrm{AUC}_{1}}{\\mathrm{AUC}_{2}} = \\frac{D_{1}/\\mathrm{CL}}{D_{2}/\\mathrm{CL}}.\n$$\n\n要求您在对共享不确定参数 $ \\mathrm{CL} $ 的两种处理方法下，分析 $ R $ 中的不确定性传播：\n- 正确的相关性处理方法，该方法承认分子和分母中出现的是同一个 $ \\mathrm{CL} $。\n- 一种朴素的区间算法处理方法，该方法忽略了相关性，将分子中的 $ \\mathrm{CL} $ 和分母中的 $ \\mathrm{CL} $ 视为两个独立的、均在 $ [3.0,\\,5.0]\\,\\mathrm{L\\,h^{-1}} $ 范围内变化的量。\n\n根据第一性原理，确定在相关性处理方法下 $ R $ 的精确值域，以及将 $ \\mathrm{CL} $ 的两次出现视为独立处理时得到的朴素区间界限。然后，计算 $ R $ 的朴素区间界限的宽度。\n\n将最终宽度表示为一个纯数（无量纲），并将您的答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个关于药代动力学模型中不确定性传播的问题。第一步是验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **药代动力学模型**：单受试者，线性药代动力学。\n- **剂量-AUC 关系**：对于静脉推注，$ \\mathrm{AUC} = \\mathrm{Dose}/\\mathrm{CL} $。\n- **剂量 1**：$ D_{1} = 100\\,\\mathrm{mg} $。\n- **剂量 2**：$ D_{2} = 150\\,\\mathrm{mg} $。\n- **清除率 ($ \\mathrm{CL} $)**：对受试者是恒定的，但存在认知不确定性。\n- **清除率的不确定性区间**：$ \\mathrm{CL} \\in [3.0,\\,5.0]\\,\\mathrm{L\\,h^{-1}} $。\n- **暴露比率 ($ R $) 的定义**：\n$$\nR = \\frac{\\mathrm{AUC}_{1}}{\\mathrm{AUC}_{2}} = \\frac{D_{1}/\\mathrm{CL}}{D_{2}/\\mathrm{CL}}\n$$\n- **任务**：\n  1. 在对 $ \\mathrm{CL} $ 进行正确的相关性处理下，确定 $ R $ 的精确值域。\n  2. 将 $ \\mathrm{CL} $ 的两次出现视为独立，确定 $ R $ 的朴素区间界限。\n  3. 计算 $ R $ 的朴素区间界限的宽度。\n  4. 将最终宽度表示为纯数，并四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题使用了药代动力学中的一个标准、有效的模型 ($ \\mathrm{AUC} = \\mathrm{Dose}/\\mathrm{CL} $)。对认知不确定参数进行不确定性传播分析是生物医学系统建模和工程中的一个基本课题。该问题具有科学合理性。\n- **适定性**：问题定义清晰，包含所有必要数据（$ D_1 $，$ D_2 $，$ \\mathrm{CL} $ 的区间）和明确的目标。相关和独立参数处理之间的区别是不确定性分析中的一个标准概念，并且任务导向一个唯一、有意义的解。\n- **客观性**：问题以精确、客观和定量的方式陈述。\n- **其他缺陷**：该问题没有表现出任何列出的缺陷。它不是不完整的、矛盾的、不切实际的或不适定的。它提出了一个在不确定性量化中概念上重要且不平凡的问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供完整的解答。\n\n### 求解推导\n该问题要求在关于共享参数 $ \\mathrm{CL} $ 的两种不同假设下，分析暴露比率 $ R $ 的不确定性。\n\n**1. 相关性处理（正确分析）**\n\n暴露比率 $ R $ 定义为：\n$$\nR = \\frac{\\mathrm{AUC}_{1}}{\\mathrm{AUC}_{2}}\n$$\n代入 $ \\mathrm{AUC} $ 的公式，我们得到：\n$$\nR = \\frac{D_{1}/\\mathrm{CL}}{D_{2}/\\mathrm{CL}}\n$$\n在这种处理方法中，我们认识到参数 $ \\mathrm{CL} $ 在分子和分母中是同一个物理量。受试者的清除率在两次给药之间没有变化。由于问题指定 $ \\mathrm{CL} \\in [3.0, 5.0] $，$ \\mathrm{CL} $ 是严格为正的，因此我们可以通过乘以 $ \\frac{\\mathrm{CL}}{\\mathrm{CL}} = 1 $ 来简化表达式：\n$$\nR = \\left(\\frac{D_{1}}{\\mathrm{CL}}\\right) \\left(\\frac{\\mathrm{CL}}{D_{2}}\\right) = \\frac{D_{1}}{D_{2}}\n$$\n参数 $ \\mathrm{CL} $ 在代数上被消掉了。因此，$ R $ 的值与 $ \\mathrm{CL} $ 的值无关。$ \\mathrm{CL} $ 的不确定性不会传播到 $ R $。我们可以使用给定的剂量计算出 $ R $ 的确切值：\n$$\nR = \\frac{D_{1}}{D_{2}} = \\frac{100\\,\\mathrm{mg}}{150\\,\\mathrm{mg}} = \\frac{100}{150} = \\frac{2}{3}\n$$\n在正确的相关性处理下，$ R $ 的值域是一个单点，$\\{ \\frac{2}{3} \\}$。\n\n**2. 朴素区间算法处理（不正确分析）**\n\n这种方法错误地忽略了子表达式对同一参数 $ \\mathrm{CL} $ 的依赖性。它将分子表达式中的 $ \\mathrm{CL} $ 和分母表达式中的 $ \\mathrm{CL} $ 视为两个独立的变量，我们称之为 $ \\mathrm{CL}_{num} $ 和 $ \\mathrm{CL}_{den} $，两者都在区间 $ [3.0,\\,5.0] $ 内变化。\n\n在这种朴素假设下，$ R $ 的表达式，记为 $ R_{\\text{naive}} $，变为：\n$$\nR_{\\text{naive}} = \\frac{D_{1}/\\mathrm{CL}_{num}}{D_{2}/\\mathrm{CL}_{den}} = \\frac{D_{1}}{D_{2}} \\cdot \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}}\n$$\n为了找到 $ R_{\\text{naive}} $ 的区间界限，我们应用区间算法的规则。$ R_{\\text{naive}} $ 的区间由 $ [\\min(R_{\\text{naive}}), \\max(R_{\\text{naive}})] $ 给出。\n\n项 $ \\frac{D_{1}}{D_{2}} $ 是一个常数 $ \\frac{2}{3} $。我们需要找到比率 $ \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}} $ 的区间。\n\n当比率 $ \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}} $ 最小时，$ R_{\\text{naive}} $ 的值最小。这发生在分子 $ \\mathrm{CL}_{den} $ 取其最小值，而分母 $ \\mathrm{CL}_{num} $ 取其最大值时。\n$$\n\\min(R_{\\text{naive}}) = \\frac{D_{1}}{D_{2}} \\cdot \\frac{\\min(\\mathrm{CL}_{den})}{\\max(\\mathrm{CL}_{num})} = \\frac{100}{150} \\cdot \\frac{3.0}{5.0} = \\frac{2}{3} \\cdot \\frac{3}{5} = \\frac{2}{5}\n$$\n\n当比率 $ \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}} $ 最大时，$ R_{\\text{naive}} $ 的值最大。这发生在分子 $ \\mathrm{CL}_{den} $ 取其最大值，而分母 $ \\mathrm{CL}_{num} $ 取其最小值时。\n$$\n\\max(R_{\\text{naive}}) = \\frac{D_{1}}{D_{2}} \\cdot \\frac{\\max(\\mathrm{CL}_{den})}{\\min(\\mathrm{CL}_{num})} = \\frac{100}{150} \\cdot \\frac{5.0}{3.0} = \\frac{2}{3} \\cdot \\frac{5}{3} = \\frac{10}{9}\n$$\n因此，$ R $ 的朴素区间界限是 $ [\\frac{2}{5}, \\frac{10}{9}] $。\n\n**3. 计算朴素区间界限的宽度**\n\n区间 $ [a, b] $ 的宽度由 $ b - a $ 给出。$ R $ 的朴素区间的宽度为：\n$$\n\\text{Width} = \\max(R_{\\text{naive}}) - \\min(R_{\\text{naive}}) = \\frac{10}{9} - \\frac{2}{5}\n$$\n为了进行分数减法，我们找到一个公分母，即 $ 9 \\times 5 = 45 $。\n$$\n\\text{Width} = \\frac{10 \\cdot 5}{9 \\cdot 5} - \\frac{2 \\cdot 9}{5 \\cdot 9} = \\frac{50}{45} - \\frac{18}{45} = \\frac{50 - 18}{45} = \\frac{32}{45}\n$$\n问题要求将此结果表示为一个纯数，并四舍五入到四位有效数字。\n$$\n\\text{Width} = \\frac{32}{45} \\approx 0.711111...\n$$\n四舍五入到四位有效数字，我们得到 $ 0.7111 $。这个非零宽度代表了因忽略子表达式对共享参数 $ \\mathrm{CL} $ 的依赖性而引入的伪不确定性。",
            "answer": "$$\n\\boxed{0.7111}\n$$"
        },
        {
            "introduction": "在理解了简单区间传播的局限性后，我们转向一种更精确的局部方法：灵敏度分析。通过推导和求解灵敏度常微分方程，我们可以量化模型输出相对于其参数的瞬时变化率。这项实践  将使您能够精确识别哪些参数对模型的动态行为影响最大，这是模型校准和实验设计的关键一步。",
            "id": "3941531",
            "problem": "考虑一个用于生物医学系统建模的参数动态系统，由常微分方程 (ODE) $ \\frac{d x}{d t} = f(x,\\theta,t) $ 定义，其中状态为 $ x(t) \\in \\mathbb{R}^{n} $，参数为 $ \\theta \\in \\mathbb{R} $，右端函数 $ f:\\mathbb{R}^{n} \\times \\mathbb{R} \\times \\mathbb{R} \\to \\mathbb{R}^{n} $ 足够光滑。定义参数敏感度 $ s(t) = \\frac{\\partial x(t)}{\\partial \\theta} $。从可微性的定义和多元函数的链式法则出发，推导控制 $ s(t) $ 的常微分方程，该方程将 $ \\frac{d}{dt}\\left( \\frac{\\partial x}{\\partial \\theta} \\right) $ 用 $ \\frac{\\partial f}{\\partial x} $、$ \\frac{\\partial f}{\\partial \\theta} $ 和 $ \\frac{\\partial x}{\\partial \\theta} $ 表示，并给出通过 $ \\frac{\\partial x(0)}{\\partial \\theta} $ 表示的敏感度初始条件。\n\n然后，将您推导出的敏感度常微分方程应用于一个具有一级吸收和一级消除的单室血管外给药药代动力学模型。系统状态为胃肠道中的药物量 $ A_{g}(t) $ 和中央室中的药物量 $ A_{c}(t) $。该模型为\n$$\n\\frac{d A_{g}}{d t} = - k_{a} A_{g}, \\qquad \\frac{d A_{c}}{d t} = k_{a} A_{g} - k_{e} A_{c},\n$$\n初始条件为 $ A_{g}(0) = D $ 和 $ A_{c}(0) = 0 $，其中 $ D $ 是口服给药剂量，$ k_{a} $ 是一级吸收速率常数，$ k_{e} $ 是一级消除速率常数。血浆浓度为 $ C(t) = \\frac{A_{c}(t)}{V} $，其中 $ V $ 是表观分布容积。\n\n将 $ \\theta = k_{e} $ 视为不确定参数，并使用敏感度常微分方程计算在时间 $ t $ 时浓度相对于 $ k_{e} $ 的参数敏感度，即 $ \\frac{\\partial C(t)}{\\partial k_{e}} $。在 $ t = 6 $ 小时，使用参数值 $ D = 100\\,\\mathrm{mg} $、$ k_{a} = 1\\,\\text{小时}^{-1} $、$ k_{e} = 0.15\\,\\text{小时}^{-1} $ 和 $ V = 50\\,\\mathrm{L} $ 计算该敏感度的值。将您的最终数值答案以毫克·小时/升 (mg·hour/L) 表示，并将答案四舍五入到四位有效数字。",
            "solution": "这个问题分为两部分：首先，对敏感度常微分方程进行一般性推导；其次，将此结果应用于一个特定的药代动力学模型。\n\n**第一部分：敏感度常微分方程的推导**\n\n我们给定一个由常微分方程 (ODE) 描述的参数动态系统：\n$$\n\\frac{d x}{d t} = f(x, \\theta, t)\n$$\n其中 $x(t) \\in \\mathbb{R}^{n}$ 是状态向量，$\\theta \\in \\mathbb{R}$ 是一个标量参数，$t$ 是时间。函数 $f$ 假定为足够光滑。\n\n状态关于参数 $\\theta$ 的参数敏感度定义为：\n$$\ns(t) = \\frac{\\partial x(t)}{\\partial \\theta}\n$$\n我们的目标是找到控制 $s(t)$ 演化的常微分方程。我们首先对 $s(t)$ 关于时间 $t$ 求导：\n$$\n\\frac{d s}{d t} = \\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial \\theta} \\right)\n$$\n由于状态 $x$ 是 $t$ 和 $\\theta$ 的函数，并且我们假设有足够的光滑性（即二阶偏导数连续），我们可以应用 Clairaut 定理来交换微分顺序：\n$$\n\\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial \\theta} \\right) = \\frac{\\partial}{\\partial \\theta} \\left( \\frac{d x}{d t} \\right)\n$$\n现在，我们代入系统动力学的定义，$\\frac{d x}{d t} = f(x(t, \\theta), \\theta, t)$：\n$$\n\\frac{d s}{d t} = \\frac{\\partial}{\\partial \\theta} f(x(t, \\theta), \\theta, t)\n$$\n函数 $f$ 对参数 $\\theta$ 的依赖有两种方式：显式地作为第二个参数，以及通过状态向量 $x(t, \\theta)$（它是 $\\theta$ 的函数）隐式地依赖。我们必须应用多元链式法则来计算 $f$ 对 $\\theta$ 的全导数：\n$$\n\\frac{\\partial f}{\\partial \\theta} (\\text{全导数}) = \\frac{\\partial f}{\\partial x} \\frac{\\partial x}{\\partial \\theta} + \\frac{\\partial f}{\\partial \\theta} (\\text{显式})\n$$\n在这个表达式中：\n- $\\frac{\\partial f}{\\partial x}$ 是向量函数 $f$ 关于状态向量 $x$ 的雅可比矩阵。其分量为 $(\\frac{\\partial f}{\\partial x})_{ij} = \\frac{\\partial f_i}{\\partial x_j}$。\n- $\\frac{\\partial x}{\\partial \\theta}$ 根据定义是敏感度向量 $s(t)$。\n- $\\frac{\\partial f}{\\partial \\theta}$ 是函数 $f$ 对其第二个参数的偏导数，同时保持其他参数 $x$ 和 $t$ 不变。\n\n将这些项代回，我们得到敏感度常微分方程：\n$$\n\\frac{d s}{d t} = \\frac{\\partial f}{\\partial x} s(t) + \\frac{\\partial f}{\\partial \\theta}\n$$\n该常微分方程的初始条件是通过在 $t=0$ 时计算敏感度的定义得到的：\n$$\ns(0) = \\left. \\frac{\\partial x(t)}{\\partial \\theta} \\right|_{t=0} = \\frac{\\partial x(0)}{\\partial \\theta}\n$$\n如果初始状态 $x(0)$ 与参数 $\\theta$ 无关，则该初始条件为 $s(0) = 0$。\n\n**第二部分：在药代动力学模型上的应用**\n\n药代动力学模型由以下方程给出：\n$$\n\\frac{d A_{g}}{d t} = - k_{a} A_{g}\n$$\n$$\n\\frac{d A_{c}}{d t} = k_{a} A_{g} - k_{e} A_{c}\n$$\n状态向量为 $x(t) = \\begin{pmatrix} A_{g}(t) \\\\ A_{c}(t) \\end{pmatrix}$。不确定参数为 $\\theta = k_{e}$。该系统可以写成 $\\frac{dx}{dt} = f(x, k_{e})$ 的形式，其中：\n$$\nf(x, k_{e}) = \\begin{pmatrix} -k_{a} A_{g} \\\\ k_{a} A_{g} - k_{e} A_{c} \\end{pmatrix}\n$$\n敏感度向量为 $s(t) = \\frac{\\partial x}{\\partial k_{e}} = \\begin{pmatrix} \\frac{\\partial A_{g}}{\\partial k_{e}} \\\\ \\frac{\\partial A_{c}}{\\partial k_{e}} \\end{pmatrix} = \\begin{pmatrix} s_{g}(t) \\\\ s_{c}(t) \\end{pmatrix}$。\n\n为了建立敏感度常微分方程，我们计算所需的偏导数：\n雅可比矩阵 $\\frac{\\partial f}{\\partial x}$：\n$$\n\\frac{\\partial f}{\\partial x} = \\begin{pmatrix} \\frac{\\partial}{\\partial A_{g}}(-k_{a} A_{g})  \\frac{\\partial}{\\partial A_{c}}(-k_{a} A_{g}) \\\\ \\frac{\\partial}{\\partial A_{g}}(k_{a} A_{g} - k_{e} A_{c})  \\frac{\\partial}{\\partial A_{c}}(k_{a} A_{g} - k_{e} A_{c}) \\end{pmatrix} = \\begin{pmatrix} -k_{a}  0 \\\\ k_{a}  -k_{e} \\end{pmatrix}\n$$\n关于参数的偏导数 $\\frac{\\partial f}{\\partial k_{e}}$：\n$$\n\\frac{\\partial f}{\\partial k_{e}} = \\begin{pmatrix} \\frac{\\partial}{\\partial k_{e}}(-k_{a} A_{g}) \\\\ \\frac{\\partial}{\\partial k_{e}}(k_{a} A_{g} - k_{e} A_{c}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -A_{c} \\end{pmatrix}\n$$\n敏感度常微分方程组为 $\\frac{ds}{dt} = \\frac{\\partial f}{\\partial x} s + \\frac{\\partial f}{\\partial k_{e}}$：\n$$\n\\begin{pmatrix} \\frac{d s_{g}}{d t} \\\\ \\frac{d s_{c}}{d t} \\end{pmatrix} = \\begin{pmatrix} -k_{a}  0 \\\\ k_{a}  -k_{e} \\end{pmatrix} \\begin{pmatrix} s_{g} \\\\ s_{c} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -A_{c}(t) \\end{pmatrix}\n$$\n这得到两个耦合的常微分方程：\n1. $\\frac{d s_{g}}{d t} = -k_{a} s_{g}$\n2. $\\frac{d s_{c}}{d t} = k_{a} s_{g} - k_{e} s_{c} - A_{c}(t)$\n\n状态的初始条件是 $A_{g}(0) = D$ 和 $A_{c}(0) = 0$。由于这些初始条件与 $k_{e}$ 无关，敏感度的初始条件为：\n$s_{g}(0) = \\frac{\\partial A_{g}(0)}{\\partial k_{e}} = \\frac{\\partial D}{\\partial k_{e}} = 0$\n$s_{c}(0) = \\frac{\\partial A_{c}(0)}{\\partial k_{e}} = \\frac{\\partial 0}{\\partial k_{e}} = 0$\n\n求解第一个敏感度常微分方程，其初始条件为 $s_{g}(0)=0$，得到对所有 $t$ 都有 $s_{g}(t)=0$。这是预料之中的，因为 $A_{g}(t) = D \\exp(-k_a t)$ 的解不依赖于 $k_e$。\n第二个敏感度常微分方程简化为：\n$$\n\\frac{d s_{c}}{d t} = -k_{e} s_{c} - A_{c}(t) \\quad \\text{或} \\quad \\frac{d s_{c}}{d t} + k_{e} s_{c} = -A_{c}(t)\n$$\n为了解这个方程，我们首先需要 $A_{c}(t)$ 的解。$A_{c}(t)$ 的常微分方程是 $\\frac{d A_{c}}{d t} = k_{a} A_{g} - k_{e} A_{c} = k_{a} D \\exp(-k_{a} t) - k_{e} A_{c}$。这是一个初始条件为 $A_c(0)=0$ 的一阶线性常微分方程。对于 $k_a \\neq k_e$，解为：\n$$\nA_{c}(t) = \\frac{k_{a} D}{k_{a} - k_{e}} (\\exp(-k_{e} t) - \\exp(-k_{a} t))\n$$\n现在我们求解 $s_c(t)$。该常微分方程为 $\\frac{d s_{c}}{d t} + k_{e} s_{c} = -\\frac{k_{a} D}{k_{a} - k_{e}} (\\exp(-k_{e} t) - \\exp(-k_{a} t))$。使用积分因子 $I(t) = \\exp(\\int k_e dt) = \\exp(k_e t)$，我们得到：\n$$\n\\frac{d}{dt}(s_c(t) \\exp(k_e t)) = -\\frac{k_{a} D}{k_{a} - k_{e}} (1 - \\exp((k_e - k_a)t))\n$$\n从 $0$ 到 $t$ 积分，并使用 $s_c(0)=0$：\n$$\ns_c(t) \\exp(k_e t) = -\\frac{k_{a} D}{k_{a} - k_{e}} \\left[ \\tau - \\frac{\\exp((k_e - k_a)\\tau)}{k_e - k_a} \\right]_0^t\n$$\n$$\ns_c(t) \\exp(k_e t) = -\\frac{k_{a} D}{k_{a} - k_{e}} \\left( t - \\frac{\\exp((k_e - k_a)t)}{k_e - k_a} - \\left( 0 - \\frac{1}{k_e - k_a} \\right) \\right)\n$$\n$$\ns_c(t) \\exp(k_e t) = \\frac{k_{a} D}{(k_{a} - k_{e})^2} (1 - \\exp((k_e - k_a)t)) - \\frac{k_{a} D t}{k_{a} - k_{e}}\n$$\n乘以 $\\exp(-k_e t)$：\n$$\ns_c(t) = \\frac{k_{a} D}{(k_{a} - k_{e})^2} (\\exp(-k_{e} t) - \\exp(-k_{a} t)) - \\frac{k_{a} D t}{k_{a} - k_{e}} \\exp(-k_{e} t)\n$$\n我们感兴趣的量是浓度 $C(t) = \\frac{A_{c}(t)}{V}$ 的敏感度。\n$$\n\\frac{\\partial C(t)}{\\partial k_{e}} = \\frac{1}{V} \\frac{\\partial A_{c}(t)}{\\partial k_{e}} = \\frac{s_c(t)}{V}\n$$\n$$\n\\frac{\\partial C(t)}{\\partial k_{e}} = \\frac{1}{V} \\left[ \\frac{k_{a} D}{(k_{a} - k_{e})^2} (\\exp(-k_{e} t) - \\exp(-k_{a} t)) - \\frac{k_{a} D t}{k_{a} - k_{e}} \\exp(-k_{e} t) \\right]\n$$\n现在我们代入给定的数值：$D=100\\,\\mathrm{mg}$，$k_a=1\\,\\text{小时}^{-1}$，$k_e=0.15\\,\\text{小时}^{-1}$，$V=50\\,\\mathrm{L}$，以及 $t=6$ 小时。\n$$\nk_{a} - k_{e} = 1 - 0.15 = 0.85 \\text{ 小时}^{-1}\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) = \\frac{1}{50} \\left[ \\frac{1 \\cdot 100}{(0.85)^2} (\\exp(-0.15 \\cdot 6) - \\exp(-1 \\cdot 6)) - \\frac{1 \\cdot 100 \\cdot 6}{0.85} \\exp(-0.15 \\cdot 6) \\right]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) = \\frac{1}{50} \\left[ \\frac{100}{0.7225} (\\exp(-0.9) - \\exp(-6)) - \\frac{600}{0.85} \\exp(-0.9) \\right]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ 138.4083 (0.406570 - 0.002479) - 705.8824 (0.406570) ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ 138.4083 (0.404091) - 287.0003 ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ 55.9392 - 287.0003 ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ -231.0611 ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx -4.621222 \\text{mg} \\cdot \\text{小时/L}\n$$\n四舍五入到四位有效数字，结果是 $-4.621$。",
            "answer": "$$\n\\boxed{-4.621}\n$$"
        },
        {
            "introduction": "最后的练习将我们带入不确定性量化的核心——完整的贝叶斯推断框架。我们将不再仅仅传播固定的不确定性区间或计算局部导数，而是从数据中学习一个未知参数（例如细胞事件发生率 $ \\lambda $）的完整后验概率分布。这项实践  演示了贝叶斯分析的整个流程：从构建先验和似然，到推导后验分布，最终利用该后验分布来预测未来事件的不确定性。",
            "id": "3941467",
            "problem": "一个研究团队正在对单个胰腺 β 细胞中的自发胞吐事件进行建模。在每个长度为 $t$ 分钟的观测窗口内，记录胞吐事件的数量。该团队假设这是一个具有未知事件速率 $\\lambda$（事件/分钟）的平稳泊松过程，因此在窗口 $i$ 中观测到的计数 $y_i$ 被建模为服从均值为 $\\lambda t$ 的泊松定律的独立同分布。该团队希望仅使用基本原理（泊松似然的定义和贝叶斯定理）对 $\\lambda$ 进行贝叶斯不确定性量化，并对未来的计数进行不确定性传播。\n\n您的任务是，从这些基本定义出发，完成以下工作：\n\n- 为泊松率参数 $\\lambda$ 构建一个适用于此场景的共轭先验族，并从共轭性和生物医学背景下超参数的可解释性两方面证明其选择的合理性。\n- 在观测到 $n$ 个独立窗口的计数 $\\{y_1,\\dots,y_n\\}$（每个窗口时长为 $t$ 分钟）后，推导 $\\lambda$ 的后验分布。\n- 推导在未来一个时长为 $t^{\\star}$ 分钟的观测窗口中计数的单步向前验后预测分布，并以闭式形式表示其概率质量函数。\n- 从有效先验信息的角度，定性解释 $\\lambda$ 的后验方差如何依赖于先验超参数和观测数据。\n\n答案规格：\n- 您的最终答案必须是给定 $n$ 个观测值后 $\\lambda$ 的后验方差的精确闭式解析表达式，用先验超参数 $a_0$ 和 $b_0$、公共窗口长度 $t$、窗口数 $n$ 以及总计数 $\\sum_{i=1}^{n} y_i$ 来表示。请勿代入数值。\n- 不要在最终答案框内包含单位；请以符号形式表示方差。",
            "solution": "根据指定的协议解析和验证问题陈述。\n\n### 第 1 步：提取给定信息\n-   观测窗口长度：$t$ 分钟。\n-   窗口 $i$ 中的胞吐事件数：$y_i$。\n-   计数模型：$y_i \\sim \\text{Poisson}(\\lambda t)$，对于 $i=1, \\dots, n$ 是独立同分布的。\n-   未知参数：$\\lambda$（事件速率，单位：事件/分钟）。\n-   任务 1：为 $\\lambda$ 构建一个共轭先验并证明其选择的合理性。\n-   任务 2：给定观测值 $\\{y_1, \\dots, y_n\\}$，推导 $\\lambda$ 的后验分布。\n-   任务 3：推导在未来一个时长为 $t^{\\star}$ 的窗口中计数的单步向前验后预测分布。\n-   任务 4：定性解释 $\\lambda$ 的后验方差对先验超参数和数据的依赖关系。\n-   最终答案要求：提供 $\\lambda$ 的后验方差的闭式表达式，记为 $\\text{Var}(\\lambda | y_1, \\dots, y_n)$。\n\n### 第 2 步：使用提取的给定信息进行验证\n该问题具有科学依据、是良定的且客观的。\n-   **科学依据**：使用泊松过程对事件计数进行建模是许多科学领域（包括生物医学研究）中的一种标准和基础的技术。使用带有共轭先验的贝叶斯推断是一种数学上严谨且被广泛接受的不确定性量化方法。该问题基于可靠的统计学和数学原理。\n-   **良定性**：问题规定得很明确。它提供了一个统计模型，并要求在贝叶斯框架内进行标准推导（先验指定、后验推导、预测分布推导以及后验矩的解释）。这些任务会导出一个唯一且有意义的解。\n-   **客观性**：问题以精确、正式的语言陈述，没有歧义、主观性或非科学性的论断。\n\n该问题未表现出无效标准列表中列出的任何缺陷。这是一个应用于生物医学背景的标准、定义明确的贝叶斯统计问题。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。将提供完整的解决方案。\n\n### 求解推导\n\n解决方案通过处理问题陈述中概述的四个任务来进行。\n\n**任务 1：$\\lambda$ 的共轭先验**\n\n首先，我们写出观测数据的似然函数。对于单个观测窗口 $i$，计数 $y_i$ 的概率质量函数（PMF）由泊松分布给出：\n$$P(y_i|\\lambda) = \\frac{(\\lambda t)^{y_i} \\exp(-\\lambda t)}{y_i!}$$\n由于 $n$ 个观测值 $\\{y_1, \\dots, y_n\\}$ 是独立同分布的，总似然函数 $L(\\lambda | y_1, \\dots, y_n)$ 是各个 PMF 的乘积：\n$$L(\\lambda | y_1, \\dots, y_n) = \\prod_{i=1}^{n} P(y_i|\\lambda) = \\prod_{i=1}^{n} \\frac{(\\lambda t)^{y_i} \\exp(-\\lambda t)}{y_i!}$$\n$$= \\frac{(t)^{\\sum_{i=1}^{n} y_i}}{\\prod_{i=1}^{n} y_i!} (\\lambda)^{\\sum_{i=1}^{n} y_i} \\exp(-n \\lambda t)$$\n为了找到共轭先验，我们只需要似然核，也就是依赖于 $\\lambda$ 的部分：\n$$L(\\lambda | y_1, \\dots, y_n) \\propto \\lambda^{\\sum_{i=1}^{n} y_i} \\exp(-n t \\lambda)$$\n这个核的形式是 $\\lambda^{k} \\exp(-c \\lambda)$，这是伽马分布的特征。如果一个概率分布作为似然函数的先验分布时，得到的后验分布与先验分布属于同一族，则该分布是共轭先验。因此，泊松率参数 $\\lambda$ 的共轭先验是伽马分布。\n\n我们将 $\\lambda$ 的先验定义为形状参数为 $a_0$、率参数为 $b_0$ 的伽马分布：\n$$p(\\lambda) = \\text{Gamma}(\\lambda | a_0, b_0) = \\frac{b_0^{a_0}}{\\Gamma(a_0)} \\lambda^{a_0-1} \\exp(-b_0 \\lambda)$$\n其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n*   **选择的理由：**\n    1.  **共轭性**：如下一步所示，对泊松率参数使用伽马先验会得到伽马后验。这种被称为共轭性的性质在计算上很方便，因为它为后验提供了闭式解析表达式，避免了使用像 MCMC 这样的数值积分方法。\n    2.  **可解释性**：超参数 $a_0$ 和 $b_0$ 在这个生物医学背景下有明确的解释。它们可以被认为是代表了等同于在总计 $b_0$ 分钟的观测时间内观测到 $a_0$ 个事件的先验信息。先验平均速率是 $E[\\lambda] = a_0/b_0$，先验方差是 $\\text{Var}(\\lambda) = a_0/b_0^2$。相对于 $a_0$ 而言，较大的 $b_0$ 代表了关于 $\\lambda$ 值的强烈先验信念（低方差）。这使得研究人员能够正式地将来自先前研究或既有文献的知识纳入模型。\n\n**任务 2：$\\lambda$ 的后验分布**\n\n根据贝叶斯定理，后验分布 $p(\\lambda | y_1, \\dots, y_n)$ 正比于似然与先验的乘积：\n$$p(\\lambda | y_1, \\dots, y_n) \\propto L(\\lambda | y_1, \\dots, y_n) \\times p(\\lambda)$$\n$$p(\\lambda | y_1, \\dots, y_n) \\propto \\left( \\lambda^{\\sum_{i=1}^{n} y_i} \\exp(-n t \\lambda) \\right) \\times \\left( \\lambda^{a_0-1} \\exp(-b_0 \\lambda) \\right)$$\n合并包含 $\\lambda$ 的项：\n$$p(\\lambda | y_1, \\dots, y_n) \\propto \\lambda^{(\\sum_{i=1}^{n} y_i) + a_0 - 1} \\exp(-(nt + b_0)\\lambda)$$\n这是一个伽马分布的核。我们可以识别出更新后的（后验）超参数，我们称之为 $a_n$ 和 $b_n$：\n$$a_n = a_0 + \\sum_{i=1}^{n} y_i$$\n$$b_n = b_0 + nt$$\n因此，$\\lambda$ 的后验分布是一个伽马分布：\n$$p(\\lambda | y_1, \\dots, y_n) = \\text{Gamma}(\\lambda | a_n, b_n) = \\text{Gamma}\\left(\\lambda \\bigg| a_0 + \\sum_{i=1}^{n} y_i, b_0 + nt\\right)$$\n后验均值是 $E[\\lambda | y_1, \\dots, y_n] = a_n/b_n$，后验方差是 $\\text{Var}(\\lambda | y_1, \\dots, y_n) = a_n/b_n^2$。\n\n**任务 3：验后预测分布**\n\n验后预测分布给出了在给定先前数据的情况下，一个新观测值 $y_{\\text{new}}$ 的概率。新观测来自一个时长为 $t^{\\star}$ 的窗口，所以其似然是 $p(y_{\\text{new}}|\\lambda) = \\text{Poisson}(y_{\\text{new}}|\\lambda t^{\\star})$。我们通过对该似然和 $\\lambda$ 的后验分布的乘积在 $\\lambda$ 的所有可能值上进行边缘化，来找到验后预测 PMF：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\int_{0}^{\\infty} p(y_{\\text{new}}|\\lambda) p(\\lambda|y_1, \\dots, y_n) d\\lambda$$\n代入各自的函数：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\int_{0}^{\\infty} \\left[ \\frac{(\\lambda t^{\\star})^{y_{\\text{new}}} \\exp(-\\lambda t^{\\star})}{y_{\\text{new}}!} \\right] \\left[ \\frac{b_n^{a_n}}{\\Gamma(a_n)} \\lambda^{a_n-1} \\exp(-b_n \\lambda) \\right] d\\lambda$$\n我们将不依赖于 $\\lambda$ 的项移到积分外：\n$$= \\frac{(t^{\\star})^{y_{\\text{new}}} b_n^{a_n}}{y_{\\text{new}}! \\Gamma(a_n)} \\int_{0}^{\\infty} \\lambda^{y_{\\text{new}}} \\exp(-\\lambda t^{\\star}) \\lambda^{a_n-1} \\exp(-b_n \\lambda) d\\lambda$$\n$$= \\frac{(t^{\\star})^{y_{\\text{new}}} b_n^{a_n}}{y_{\\text{new}}! \\Gamma(a_n)} \\int_{0}^{\\infty} \\lambda^{a_n + y_{\\text{new}} - 1} \\exp(-(b_n + t^{\\star})\\lambda) d\\lambda$$\n该积分是一个伽马分布 $\\text{Gamma}(a_n + y_{\\text{new}}, b_n + t^{\\star})$ 在其定义域上积分的核。该积分的值为 $\\frac{\\Gamma(a_n + y_{\\text{new}})}{(b_n + t^{\\star})^{a_n + y_{\\text{new}}}}$。\n将其代回：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\frac{(t^{\\star})^{y_{\\text{new}}} b_n^{a_n}}{y_{\\text{new}}! \\Gamma(a_n)} \\frac{\\Gamma(a_n + y_{\\text{new}})}{(b_n + t^{\\star})^{a_n + y_{\\text{new}}}}$$\n重新整理各项：\n$$= \\frac{\\Gamma(a_n + y_{\\text{new}})}{\\Gamma(y_{\\text{new}}+1) \\Gamma(a_n)} \\left(\\frac{b_n}{b_n + t^{\\star}}\\right)^{a_n} \\left(\\frac{t^{\\star}}{b_n + t^{\\star}}\\right)^{y_{\\text{new}}}$$\n这里我们使用了 $y_{\\text{new}}! = \\Gamma(y_{\\text{new}}+1)$。项 $\\frac{\\Gamma(a_n + y_{\\text{new}})}{\\Gamma(y_{\\text{new}}+1) \\Gamma(a_n)}$ 是二项式系数 $\\binom{a_n+y_{\\text{new}}-1}{y_{\\text{new}}}$ 的定义。\n这是负二项分布的 PMF。设 $r = a_n$ 和 $p = \\frac{b_n}{b_n + t^{\\star}}$。其 PMF 为：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\binom{y_{\\text{new}} + r - 1}{y_{\\text{new}}} p^r (1-p)^{y_{\\text{new}}}$$\n所以，$y_{\\text{new}}$ 的验后预测分布是一个负二项分布，$y_{\\text{new}}|y_1, \\dots, y_n \\sim \\text{NB}(r, p)$，其参数为：\n$$r = a_n = a_0 + \\sum_{i=1}^{n} y_i$$\n$$p = \\frac{b_n}{b_n + t^{\\star}} = \\frac{b_0 + nt}{b_0 + nt + t^{\\star}}$$\n\n**任务 4：后验方差的定性解释**\n\n$\\lambda$ 的后验方差由后验分布 $\\text{Gamma}(\\lambda | a_n, b_n)$ 的方差给出，即：\n$$\\text{Var}(\\lambda | y_1, \\dots, y_n) = \\frac{a_n}{b_n^2} = \\frac{a_0 + \\sum_{i=1}^{n} y_i}{(b_0 + nt)^2}$$\n-   **对先验超参数（$a_0$, $b_0$）的依赖**：超参数 $a_0$ 和 $b_0$ 代表了来自先验实验的有效信息。增加 $a_0$（先验事件计数）会增加分子，倾向于增加方差。增加 $b_0$（先验观测时间）会以平方的方式增加分母，从而显著减小方差。因此，一个信息量更大的先验（更大的 $b_0$）会导致更小的后验方差，因为先验信念的权重更大，限制了 $\\lambda$ 的可能取值。\n-   **对观测数据（$n$, $\\sum y_i$）的依赖**：观测数据通过窗口数 $n$ 和总计数 $\\sum_{i=1}^{n} y_i$ 对后验产生贡献。\n    -   随着观测数 $n$ 的增加，总数据观测时间 $nt$ 也增加。这一项以平方的形式出现在分母中，即 $(b_0 + nt)^2$。总计数 $\\sum y_i$ 预计会随 $n$ 线性增长（大约为 $n \\lambda t$）。分母以 $n^2$ 的速度增长，而分子以 $n$ 的速度增长。分母的平方增长占主导地位，导致后验方差随着 $n$ 的增加而减小。这反映了数据越多，对参数的确定性就越高（方差越小）的原则。\n    -   对于固定的观测数 $n$，更大的总计数 $\\sum y_i$ 意味着对速率 $\\lambda$ 的估计更高。这个更大的总计数增加了分子 $a_n$，从而增加了后验方差。这可能看起来有些反直觉，但这是伽马分布的一个性质，其中方差（$a/b^2$）与均值（$a/b$）除以率参数（$b$）成正比。对于固定的暴露时间（$b_n$），一个具有更高平均速率的过程自然具有更高的绝对不确定性（方差）。",
            "answer": "$$\\boxed{\\frac{a_0 + \\sum_{i=1}^{n} y_i}{(b_0 + nt)^2}}$$"
        }
    ]
}