{
    "hands_on_practices": [
        {
            "introduction": "在不确定性量化中，区间算术提供了一种看似简单的方法来传播参数的不确定性。然而，这种方法常常忽略了表达式中同一参数多次出现所导致的依赖性，可能会得出过于保守甚至错误的结论。本练习  通过一个药代动力学模型中的反例，清晰地揭示了这一“依赖问题”，并量化了天真应用区间算术所引入的伪不确定性，强调了在不确定性传播中仔细分析模型结构的重要性。",
            "id": "3941594",
            "problem": "一个单一个体线性药代动力学模型被用来量化同一种药物两次独立静脉快速推注给药后的暴露量。在线性药代动力学中，静脉快速推注的血浆药物浓度-时间曲线下面积 (AUC) 由公式 $ \\mathrm{AUC} = \\mathrm{Dose}/\\mathrm{CL} $ 给出，其中 $ \\mathrm{CL} $ 是系统清除率。假设同一个体接受两次快速推注给药，剂量分别为 $ D_{1} = 100\\,\\mathrm{mg} $ 和 $ D_{2} = 150\\,\\mathrm{mg} $，两次给药间隔时间足够长，因此两次的药代动力学过程相互独立。该个体的真实清除率 $ \\mathrm{CL} $ 在两次给药期间是恒定的，但对建模者而言存在认知不确定性，仅知其位于区间 $ \\mathrm{CL} \\in [3.0,\\,5.0]\\,\\mathrm{L\\,h^{-1}} $ 内。\n\n将暴露量比率 $ R $ 定义为两次给药的AUC之比：\n$$\nR = \\frac{\\mathrm{AUC}_{1}}{\\mathrm{AUC}_{2}} = \\frac{D_{1}/\\mathrm{CL}}{D_{2}/\\mathrm{CL}}.\n$$\n\n要求您在对共享不确定参数 $ \\mathrm{CL} $ 的两种处理方式下，分析 $ R $ 的不确定性传播：\n- 正确的相依性处理方法，该方法承认同一个 $ \\mathrm{CL} $ 同时出现在分子和分母中。\n- 朴素的区间算法处理方法，该方法忽略了相依性，并将分子中的 $ \\mathrm{CL} $ 和分母中的 $ \\mathrm{CL} $ 视为两个独立的、都在 $ [3.0,\\,5.0]\\,\\mathrm{L\\,h^{-1}} $ 范围内变化的量。\n\n从第一性原理出发，确定在相依性处理下 $ R $ 的精确像集，以及将 $ \\mathrm{CL} $ 的两次出现视为独立时得到的朴素区间界限。然后，计算 $ R $ 的朴素区间界限的宽度。\n\n将最终的宽度表示为一个纯数（无量纲），并将您的答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个关于药代动力学模型中不确定性传播的问题。第一步是验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **药代动力学模型**：单一个体，线性药代动力学。\n- **剂量-AUC关系**：对于静脉快速推注，$ \\mathrm{AUC} = \\mathrm{Dose}/\\mathrm{CL} $。\n- **剂量1**：$ D_{1} = 100\\,\\mathrm{mg} $。\n- **剂量2**：$ D_{2} = 150\\,\\mathrm{mg} $。\n- **清除率 ($ \\mathrm{CL} $)**：对该个体是恒定的，但存在认知不确定性。\n- **清除率的不确定性区间**：$ \\mathrm{CL} \\in [3.0,\\,5.0]\\,\\mathrm{L\\,h^{-1}} $。\n- **暴露量比率 ($ R $) 的定义**：\n$$\nR = \\frac{\\mathrm{AUC}_{1}}{\\mathrm{AUC}_{2}} = \\frac{D_{1}/\\mathrm{CL}}{D_{2}/\\mathrm{CL}}\n$$\n- **任务**：\n  1. 在对 $ \\mathrm{CL} $ 进行正确的相依性处理下，确定 $ R $ 的精确像集。\n  2. 在将 $ \\mathrm{CL} $ 的两次出现视为独立的情况下，确定 $ R $ 的朴素区间界限。\n  3. 计算 $ R $ 的朴素区间界限的宽度。\n  4. 将最终宽度表示为一个纯数，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学性**：该问题使用了药代动力学中的一个标准、有效的模型 ($ \\mathrm{AUC} = \\mathrm{Dose}/\\mathrm{CL} $)。分析认知不确定参数的不确定性传播是生物医学系统建模和工程中的一个基本课题。该问题是科学合理的。\n- **适定性**：该问题定义清晰，包含所有必要数据（$ D_1 $，$ D_2 $，$ \\mathrm{CL} $ 的区间）和明确的目标。相依与独立参数处理之间的区别是不确定性分析中的一个标准概念，并且任务导向一个唯一且有意义的解。\n- **客观性**：问题以精确、客观和定量的方式陈述。\n- **其他缺陷**：该问题没有表现出任何列出的缺陷。它不是不完整的、矛盾的、不切实际的或不适定的。它提出了一个在不确定性量化中概念上重要且非平凡的问题。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整的解答。\n\n### 解题推导\n该问题要求在关于共享参数 $ \\mathrm{CL} $ 的两种不同假设下，分析暴露量比率 $ R $ 的不确定性。\n\n**1. 相依性处理（正确分析）**\n\n暴露量比率 $ R $ 定义为：\n$$\nR = \\frac{\\mathrm{AUC}_{1}}{\\mathrm{AUC}_{2}}\n$$\n代入 $ \\mathrm{AUC} $ 的公式，我们得到：\n$$\nR = \\frac{D_{1}/\\mathrm{CL}}{D_{2}/\\mathrm{CL}}\n$$\n在这种处理方法中，我们认识到参数 $ \\mathrm{CL} $ 在分子和分母中是同一个物理量。该个体的清除率在两次给药之间没有改变。由于问题指定 $ \\mathrm{CL} \\in [3.0, 5.0] $，$ \\mathrm{CL} $ 是严格为正的，因此我们可以通过乘以 $ \\frac{\\mathrm{CL}}{\\mathrm{CL}} = 1 $ 来化简表达式：\n$$\nR = \\left(\\frac{D_{1}}{\\mathrm{CL}}\\right) \\left(\\frac{\\mathrm{CL}}{D_{2}}\\right) = \\frac{D_{1}}{D_{2}}\n$$\n参数 $ \\mathrm{CL} $ 在代数上被消去。因此，$ R $ 的值与 $ \\mathrm{CL} $ 的值无关。$ \\mathrm{CL} $ 的不确定性不会传播到 $ R $。我们可以使用给定的剂量计算出 $ R $ 的精确值：\n$$\nR = \\frac{D_{1}}{D_{2}} = \\frac{100\\,\\mathrm{mg}}{150\\,\\mathrm{mg}} = \\frac{100}{150} = \\frac{2}{3}\n$$\n在正确的相依性处理下，$ R $ 的像集是一个单点，即 $\\{ \\frac{2}{3} \\}$。\n\n**2. 朴素区间算法处理（不正确分析）**\n\n这种方法错误地忽略了子表达式对同一参数 $ \\mathrm{CL} $ 的相依性。它将分子表达式中的 $ \\mathrm{CL} $ 和分母表达式中的 $ \\mathrm{CL} $ 视为两个独立的变量，我们称之为 $ \\mathrm{CL}_{num} $ 和 $ \\mathrm{CL}_{den} $，它们都在区间 $ [3.0,\\,5.0] $ 内变化。\n\n在这个朴素假设下，$ R $ 的表达式（记作 $ R_{\\text{naive}} $）变为：\n$$\nR_{\\text{naive}} = \\frac{D_{1}/\\mathrm{CL}_{num}}{D_{2}/\\mathrm{CL}_{den}} = \\frac{D_{1}}{D_{2}} \\cdot \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}}\n$$\n为了找到 $ R_{\\text{naive}} $ 的区间界限，我们应用区间算法的规则。$ R_{\\text{naive}} $ 的区间由 $ [\\min(R_{\\text{naive}}), \\max(R_{\\text{naive}})] $ 给出。\n\n项 $ \\frac{D_{1}}{D_{2}} $ 是一个常数 $ \\frac{2}{3} $。我们需要找到比率 $ \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}} $ 的区间。\n\n$ R_{\\text{naive}} $ 的最小值出现在比率 $ \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}} $ 被最小化时。这发生在分子 $ \\mathrm{CL}_{den} $ 取其最小值，而分母 $ \\mathrm{CL}_{num} $ 取其最大值时。\n$$\n\\min(R_{\\text{naive}}) = \\frac{D_{1}}{D_{2}} \\cdot \\frac{\\min(\\mathrm{CL}_{den})}{\\max(\\mathrm{CL}_{num})} = \\frac{100}{150} \\cdot \\frac{3.0}{5.0} = \\frac{2}{3} \\cdot \\frac{3}{5} = \\frac{2}{5}\n$$\n\n$ R_{\\text{naive}} $ 的最大值出现在比率 $ \\frac{\\mathrm{CL}_{den}}{\\mathrm{CL}_{num}} $ 被最大化时。这发生在分子 $ \\mathrm{CL}_{den} $ 取其最大值，而分母 $ \\mathrm{CL}_{num} $ 取其最小值时。\n$$\n\\max(R_{\\text{naive}}) = \\frac{D_{1}}{D_{2}} \\cdot \\frac{\\max(\\mathrm{CL}_{den})}{\\min(\\mathrm{CL}_{num})} = \\frac{100}{150} \\cdot \\frac{5.0}{3.0} = \\frac{2}{3} \\cdot \\frac{5}{3} = \\frac{10}{9}\n$$\n因此，$ R $ 的朴素区间界限是 $ [\\frac{2}{5}, \\frac{10}{9}] $。\n\n**3. 计算朴素区间界限的宽度**\n\n区间 $ [a, b] $ 的宽度由 $ b - a $ 给出。$ R $ 的朴素区间的宽度为：\n$$\n\\text{Width} = \\max(R_{\\text{naive}}) - \\min(R_{\\text{naive}}) = \\frac{10}{9} - \\frac{2}{5}\n$$\n为了进行分数减法，我们找到一个公分母，即 $ 9 \\times 5 = 45 $。\n$$\n\\text{Width} = \\frac{10 \\cdot 5}{9 \\cdot 5} - \\frac{2 \\cdot 9}{5 \\cdot 9} = \\frac{50}{45} - \\frac{18}{45} = \\frac{50 - 18}{45} = \\frac{32}{45}\n$$\n问题要求将此结果表示为一个纯数，并四舍五入到四位有效数字。\n$$\n\\text{Width} = \\frac{32}{45} \\approx 0.711111...\n$$\n四舍五入到四位有效数字，我们得到 $ 0.7111 $。这个非零宽度代表了因忽略子表达式对共享参数 $ \\mathrm{CL} $ 的相依性而引入的虚假不确定性。",
            "answer": "$$\n\\boxed{0.7111}\n$$"
        },
        {
            "introduction": "在展示了忽略参数依赖性的风险之后，我们转向一种更强大的局部方法：灵敏度分析。通过推导和求解灵敏度常微分方程（ODE），我们可以精确地量化模型输出对参数微小变化的响应，这对于参数估计、模型可辨识性分析和实验设计至关重要。本练习  将从第一性原理出发推导灵敏度方程，并将其应用于一个实际的药代动力学模型，让学生亲手计算浓度曲线对药物消除速率常数的灵敏度。",
            "id": "3941531",
            "problem": "考虑一个用于生物医学系统建模的参数化动力系统，由常微分方程（ODE）$ \\frac{d x}{d t} = f(x,\\theta,t) $ 定义，其中状态为 $ x(t) \\in \\mathbb{R}^{n} $，参数为 $ \\theta \\in \\mathbb{R} $，右端函数 $ f:\\mathbb{R}^{n} \\times \\mathbb{R} \\times \\mathbb{R} \\to \\mathbb{R}^{n} $ 足够光滑。定义参数灵敏度 $ s(t) = \\frac{\\partial x(t)}{\\partial \\theta} $。从可微性和多元函数链式法则的定义出发，推导控制 $ s(t) $ 的常微分方程，该方程用 $ \\frac{\\partial f}{\\partial x} $、$ \\frac{\\partial f}{\\partial \\theta} $ 和 $ \\frac{\\partial x}{\\partial \\theta} $ 来表示 $ \\frac{d}{dt}\\left( \\frac{\\partial x}{\\partial \\theta} \\right) $，并给出通过 $ \\frac{\\partial x(0)}{\\partial \\theta} $ 表示的灵敏度初始条件。\n\n然后，将您推导出的灵敏度常微分方程应用于一个具有一级吸收和一级消除的单室血管外药代动力学模型。系统状态为胃肠道中的药物量 $ A_{g}(t) $ 和中央室中的药物量 $ A_{c}(t) $。该模型为\n$$\n\\frac{d A_{g}}{d t} = - k_{a} A_{g}, \\qquad \\frac{d A_{c}}{d t} = k_{a} A_{g} - k_{e} A_{c},\n$$\n初始条件为 $ A_{g}(0) = D $ 和 $ A_{c}(0) = 0 $，其中 $ D $ 是口服给药剂量，$ k_{a} $ 是一级吸收速率常数，而 $ k_{e} $ 是一级消除速率常数。血浆浓度为 $ C(t) = \\frac{A_{c}(t)}{V} $，其中 $ V $ 是表观分布容积。\n\n将 $ \\theta = k_{e} $ 视为不确定参数，并使用灵敏度常微分方程计算浓度在时间 $ t $ 对 $ k_{e} $ 的参数灵敏度，即 $ \\frac{\\partial C(t)}{\\partial k_{e}} $。在 $ t = 6 $ 小时，使用参数值 $ D = 100 $ mg、$ k_{a} = 1 $ 小时$^{-1}$、$ k_{e} = 0.15 $ 小时$^{-1}$ 和 $ V = 50 $ L，计算该灵敏度。将最终数值答案以毫克-小时/升（mg·hour/L）为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "问题分为两部分：首先，对灵敏度常微分方程进行一般性推导；其次，将此结果应用于一个特定的药代动力学模型。\n\n**第1部分：灵敏度ODE的推导**\n\n给定一个由常微分方程（ODE）描述的参数化动力系统：\n$$\n\\frac{d x}{d t} = f(x, \\theta, t)\n$$\n其中 $x(t) \\in \\mathbb{R}^{n}$ 是状态向量，$\\theta \\in \\mathbb{R}$ 是一个标量参数，$t$ 是时间。假设函数 $f$ 足够光滑。\n\n状态关于参数 $\\theta$ 的参数灵敏度定义为：\n$$\ns(t) = \\frac{\\partial x(t)}{\\partial \\theta}\n$$\n我们的目标是找到控制 $s(t)$ 演化的常微分方程。我们首先将 $s(t)$ 对时间 $t$ 求导：\n$$\n\\frac{d s}{d t} = \\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial \\theta} \\right)\n$$\n由于状态 $x$ 是 $t$ 和 $\\theta$ 的函数，并且我们假设了足够的平滑性（即二阶偏导数连续），我们可以应用克莱罗定理（Clairaut's theorem）来交换求导顺序：\n$$\n\\frac{d}{dt} \\left( \\frac{\\partial x}{\\partial \\theta} \\right) = \\frac{\\partial}{\\partial \\theta} \\left( \\frac{d x}{d t} \\right)\n$$\n现在，我们代入系统动力学的定义 $\\frac{d x}{d t} = f(x(t, \\theta), \\theta, t)$：\n$$\n\\frac{d s}{d t} = \\frac{\\partial}{\\partial \\theta} f(x(t, \\theta), \\theta, t)\n$$\n函数 $f$ 以两种方式依赖于参数 $\\theta$：显式地作为第二个参数，以及隐式地通过作为 $\\theta$ 函数的状态向量 $x(t, \\theta)$。我们必须应用多元链式法则来计算 $f$ 相对于 $\\theta$ 的全导数：\n$$\n\\frac{\\partial f}{\\partial \\theta} (\\text{全导数}) = \\frac{\\partial f}{\\partial x} \\frac{\\partial x}{\\partial \\theta} + \\frac{\\partial f}{\\partial \\theta} (\\text{显式})\n$$\n在此表达式中：\n- $\\frac{\\partial f}{\\partial x}$ 是向量函数 $f$ 相对于状态向量 $x$ 的雅可比矩阵。其分量为 $(\\frac{\\partial f}{\\partial x})_{ij} = \\frac{\\partial f_i}{\\partial x_j}$。\n- $\\frac{\\partial x}{\\partial \\theta}$ 根据定义是灵敏度向量 $s(t)$。\n- $\\frac{\\partial f}{\\partial \\theta}$ 是函数 $f$ 相对于其第二个参数的偏导数，保持其他参数 $x$ 和 $t$ 不变。\n\n将这些项代回，我们得到灵敏度常微分方程：\n$$\n\\frac{d s}{d t} = \\frac{\\partial f}{\\partial x} s(t) + \\frac{\\partial f}{\\partial \\theta}\n$$\n该常微分方程的初始条件通过在 $t=0$ 处评估灵敏度的定义得到：\n$$\ns(0) = \\left. \\frac{\\partial x(t)}{\\partial \\theta} \\right|_{t=0} = \\frac{\\partial x(0)}{\\partial \\theta}\n$$\n如果初始状态 $x(0)$ 与参数 $\\theta$ 无关，则此初始条件为 $s(0) = 0$。\n\n**第2部分：在药代动力学模型中的应用**\n\n药代动力学模型由下式给出：\n$$\n\\frac{d A_{g}}{d t} = - k_{a} A_{g}\n$$\n$$\n\\frac{d A_{c}}{d t} = k_{a} A_{g} - k_{e} A_{c}\n$$\n状态向量为 $x(t) = \\begin{pmatrix} A_{g}(t) \\\\ A_{c}(t) \\end{pmatrix}$。不确定参数是 $\\theta = k_{e}$。该系统可以写成 $\\frac{dx}{dt} = f(x, k_{e})$ 的形式，其中：\n$$\nf(x, k_{e}) = \\begin{pmatrix} -k_{a} A_{g} \\\\ k_{a} A_{g} - k_{e} A_{c} \\end{pmatrix}\n$$\n灵敏度向量是 $s(t) = \\frac{\\partial x}{\\partial k_{e}} = \\begin{pmatrix} \\frac{\\partial A_{g}}{\\partial k_{e}} \\\\ \\frac{\\partial A_{c}}{\\partial k_{e}} \\end{pmatrix} = \\begin{pmatrix} s_{g}(t) \\\\ s_{c}(t) \\end{pmatrix}$。\n\n为了建立灵敏度常微分方程，我们计算所需的偏导数：\n雅可比矩阵 $\\frac{\\partial f}{\\partial x}$：\n$$\n\\frac{\\partial f}{\\partial x} = \\begin{pmatrix} \\frac{\\partial}{\\partial A_{g}}(-k_{a} A_{g}) & \\frac{\\partial}{\\partial A_{c}}(-k_{a} A_{g}) \\\\ \\frac{\\partial}{\\partial A_{g}}(k_{a} A_{g} - k_{e} A_{c}) & \\frac{\\partial}{\\partial A_{c}}(k_{a} A_{g} - k_{e} A_{c}) \\end{pmatrix} = \\begin{pmatrix} -k_{a} & 0 \\\\ k_{a} & -k_{e} \\end{pmatrix}\n$$\n关于参数的偏导数 $\\frac{\\partial f}{\\partial k_{e}}$：\n$$\n\\frac{\\partial f}{\\partial k_{e}} = \\begin{pmatrix} \\frac{\\partial}{\\partial k_{e}}(-k_{a} A_{g}) \\\\ \\frac{\\partial}{\\partial k_{e}}(k_{a} A_{g} - k_{e} A_{c}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -A_{c} \\end{pmatrix}\n$$\n灵敏度常微分方程组为 $\\frac{ds}{dt} = \\frac{\\partial f}{\\partial x} s + \\frac{\\partial f}{\\partial k_{e}}$：\n$$\n\\begin{pmatrix} \\frac{d s_{g}}{d t} \\\\ \\frac{d s_{c}}{d t} \\end{pmatrix} = \\begin{pmatrix} -k_{a} & 0 \\\\ k_{a} & -k_{e} \\end{pmatrix} \\begin{pmatrix} s_{g} \\\\ s_{c} \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -A_{c}(t) \\end{pmatrix}\n$$\n这得到两个耦合的常微分方程：\n1. $\\frac{d s_{g}}{d t} = -k_{a} s_{g}$\n2. $\\frac{d s_{c}}{d t} = k_{a} s_{g} - k_{e} s_{c} - A_{c}(t)$\n\n状态的初始条件是 $A_{g}(0) = D$ 和 $A_{c}(0) = 0$。由于这些初始条件与 $k_{e}$ 无关，灵敏度的初始条件是：\n$s_{g}(0) = \\frac{\\partial A_{g}(0)}{\\partial k_{e}} = \\frac{\\partial D}{\\partial k_{e}} = 0$\n$s_{c}(0) = \\frac{\\partial A_{c}(0)}{\\partial k_{e}} = \\frac{\\partial 0}{\\partial k_{e}} = 0$\n\n解第一个灵敏度常微分方程，初始条件为 $s_{g}(0)=0$，得到对所有 $t$ 都有 $s_{g}(t)=0$。这是预料之中的，因为 $A_{g}(t) = D \\exp(-k_a t)$ 的解不依赖于 $k_e$。\n第二个灵敏度常微分方程简化为：\n$$\n\\frac{d s_{c}}{d t} = -k_{e} s_{c} - A_{c}(t) \\quad \\text{或} \\quad \\frac{d s_{c}}{d t} + k_{e} s_{c} = -A_{c}(t)\n$$\n为了解这个方程，我们首先需要 $A_{c}(t)$ 的解。$A_{c}(t)$ 的常微分方程是 $\\frac{d A_{c}}{d t} = k_{a} A_{g} - k_{e} A_{c} = k_{a} D \\exp(-k_{a} t) - k_{e} A_{c}$。这是一个初始条件为 $A_c(0)=0$ 的一阶线性常微分方程。对于 $k_a \\neq k_e$，解为：\n$$\nA_{c}(t) = \\frac{k_{a} D}{k_{a} - k_{e}} (\\exp(-k_{e} t) - \\exp(-k_{a} t))\n$$\n现在我们求解 $s_c(t)$。该常微分方程是 $\\frac{d s_{c}}{d t} + k_{e} s_{c} = -\\frac{k_{a} D}{k_{a} - k_{e}} (\\exp(-k_{e} t) - \\exp(-k_{a} t))$。使用积分因子 $I(t) = \\exp(\\int k_e dt) = \\exp(k_e t)$，我们得到：\n$$\n\\frac{d}{dt}(s_c(t) \\exp(k_e t)) = -\\frac{k_{a} D}{k_{a} - k_{e}} (1 - \\exp((k_e - k_a)t))\n$$\n从 0 到 $t$ 积分，并使用 $s_c(0)=0$：\n$$\ns_c(t) \\exp(k_e t) = -\\frac{k_{a} D}{k_{a} - k_{e}} \\left[ \\tau - \\frac{\\exp((k_e - k_a)\\tau)}{k_e - k_a} \\right]_0^t\n$$\n$$\ns_c(t) \\exp(k_e t) = -\\frac{k_{a} D}{k_{a} - k_{e}} \\left( t - \\frac{\\exp((k_e - k_a)t)}{k_e - k_a} - \\left( 0 - \\frac{1}{k_e - k_a} \\right) \\right)\n$$\n$$\ns_c(t) \\exp(k_e t) = \\frac{k_{a} D}{(k_{a} - k_{e})^2} (1 - \\exp((k_e - k_a)t)) - \\frac{k_{a} D t}{k_{a} - k_{e}}\n$$\n乘以 $\\exp(-k_e t)$：\n$$\ns_c(t) = \\frac{k_{a} D}{(k_{a} - k_{e})^2} (\\exp(-k_{e} t) - \\exp(-k_{a} t)) - \\frac{k_{a} D t}{k_{a} - k_{e}} \\exp(-k_{e} t)\n$$\n我们关心的量是浓度 $C(t) = \\frac{A_{c}(t)}{V}$ 的灵敏度。\n$$\n\\frac{\\partial C(t)}{\\partial k_{e}} = \\frac{1}{V} \\frac{\\partial A_{c}(t)}{\\partial k_{e}} = \\frac{s_c(t)}{V}\n$$\n$$\n\\frac{\\partial C(t)}{\\partial k_{e}} = \\frac{1}{V} \\left[ \\frac{k_{a} D}{(k_{a} - k_{e})^2} (\\exp(-k_{e} t) - \\exp(-k_{a} t)) - \\frac{k_{a} D t}{k_{a} - k_{e}} \\exp(-k_{e} t) \\right]\n$$\n现在我们代入给定的数值：$D=100$ mg，$k_a=1$ 小时$^{-1}$，$k_e=0.15$ 小时$^{-1}$，$V=50$ L，以及 $t=6$ 小时。\n$$\nk_{a} - k_{e} = 1 - 0.15 = 0.85 \\text{ 小时}^{-1}\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) = \\frac{1}{50} \\left[ \\frac{1 \\cdot 100}{(0.85)^2} (\\exp(-0.15 \\cdot 6) - \\exp(-1 \\cdot 6)) - \\frac{1 \\cdot 100 \\cdot 6}{0.85} \\exp(-0.15 \\cdot 6) \\right]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) = \\frac{1}{50} \\left[ \\frac{100}{0.7225} (\\exp(-0.9) - \\exp(-6)) - \\frac{600}{0.85} \\exp(-0.9) \\right]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ 138.4083 (0.406570 - 0.002479) - 705.8824 (0.406570) ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ 138.4083 (0.404091) - 287.0003 ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ 55.9392 - 287.0003 ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx \\frac{1}{50} [ -231.0611 ]\n$$\n$$\n\\frac{\\partial C}{\\partial k_{e}}(t=6) \\approx -4.621222 \\text{ mg} \\cdot \\text{hour/L}\n$$\n四舍五入到四位有效数字，结果是 $-4.621$。",
            "answer": "$$\n\\boxed{-4.621}\n$$"
        },
        {
            "introduction": "最后，我们从局部分析扩展到一个全局的、完整的概率框架——贝叶斯推断。当先验分布与似然函数在数学形式上“共轭”时，我们可以解析地推导出后验分布，从而清晰地展示贝叶斯学习的全过程。本练习  引导学生为一个描述细胞事件的泊松过程模型构建共轭先验，并推导后验分布与预测分布，从而深刻理解先验信息与观测数据如何共同决定我们对未知参数不确定性的最终量化。",
            "id": "3941467",
            "problem": "一个研究团队正在对单个胰腺β细胞中的自发性胞吐事件进行建模。在每个长度为 $t$ 分钟的观察窗口内，研究团队会记录胞吐事件的数量。该团队假设这是一个平稳泊松过程，其事件发生率 $\\lambda$（事件/分钟）未知，因此在窗口 $i$ 中观测到的计数 $y_i$ 被建模为独立同分布，服从均值为 $\\lambda t$ 的泊松分布。该团队希望仅使用基本原理——即泊松似然的定义和贝叶斯定理——来对 $\\lambda$ 进行贝叶斯不确定性量化，并对未来计数进行不确定性传播。\n\n您的任务是，从这些基本定义出发，完成以下工作：\n\n- 为泊松率参数 $\\lambda$ 构建一个适用于此情景的共轭先验族，并从共轭性以及超参数在生物医学背景下的可解释性两方面证明其选择的合理性。\n- 在观测到 $n$ 个独立窗口的计数 $\\{y_1,\\dots,y_n\\}$（每个窗口持续时间为 $t$ 分钟）后，推导 $\\lambda$ 的后验分布。\n- 推导在一个持续时间为 $t^{\\star}$ 分钟的未来观察窗口中计数的单步后验预测分布，并以闭合形式表示其概率质量函数。\n- 从有效先验信息的角度，定性解释 $\\lambda$ 的后验方差如何依赖于先验超参数和观测数据。\n\n答案规格：\n- 您的最终答案必须是在给定 $n$ 个观测值的情况下 $\\lambda$ 后验方差的精确闭合形式解析表达式，该表达式需用先验超参数 $a_0$ 和 $b_0$、公共窗口长度 $t$、窗口数量 $n$ 以及总计数 $\\sum_{i=1}^{n} y_i$ 来表示。请勿代入数值。\n- 不要在最终答案框内包含单位；请以符号形式表示方差。",
            "solution": "已根据指定协议解析并验证问题陈述。\n\n### 第1步：提取已知信息\n-   观察窗口长度：$t$ 分钟。\n-   窗口 $i$ 中的胞吐事件数量：$y_i$。\n-   计数模型：$y_i \\sim \\text{Poisson}(\\lambda t)$，对于 $i=1, \\dots, n$ 独立同分布。\n-   未知参数：$\\lambda$（事件发生率，单位：事件/分钟）。\n-   任务1：为 $\\lambda$ 构建共轭先验并证明其选择的合理性。\n-   任务2：根据观测值 $\\{y_1, \\dots, y_n\\}$ 推导 $\\lambda$ 的后验分布。\n-   任务3：推导在持续时间为 $t^{\\star}$ 的未来窗口中计数的单步后验预测分布。\n-   任务4：定性解释 $\\lambda$ 的后验方差对先验超参数和数据的依赖关系。\n-   最终答案要求：提供 $\\lambda$ 的后验方差的闭合形式表达式，记为 $\\text{Var}(\\lambda | y_1, \\dots, y_n)$。\n\n### 第2步：使用提取的已知信息进行验证\n该问题具有科学依据、是良定的且客观的。\n-   **科学依据**：使用泊松过程对事件计数进行建模是许多科学领域（包括生物医学研究）中的一项标准和基础技术。使用带有共轭先验的贝叶斯推断是一种数学上严谨且被广泛接受的不确定性量化方法。该问题基于可靠的统计学和数学原理。\n-   **良定性**：问题规定清晰。它提供了一个统计模型，并要求在贝叶斯框架内进行标准推导（先验设定、后验推导、预测分布推导以及后验矩的解释）。这些任务会导出一个唯一且有意义的解。\n-   **客观性**：问题以精确、正式的语言陈述，没有歧义、主观性或非科学性论断。\n\n该问题未表现出失效标准中列出的任何缺陷。这是一个应用于生物医学背景的标准、定义明确的贝叶斯统计学问题。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解题推导\n\n解题过程将按问题陈述中概述的四个任务进行。\n\n**任务1：$\\lambda$的共轭先验**\n\n首先，我们写出观测数据的似然函数。对于单个观察窗口 $i$，计数 $y_i$ 的概率质量函数 (PMF) 由泊松分布给出：\n$$P(y_i|\\lambda) = \\frac{(\\lambda t)^{y_i} \\exp(-\\lambda t)}{y_i!}$$\n由于 $n$ 个观测值 $\\{y_1, \\dots, y_n\\}$ 是独立同分布的，总似然函数 $L(\\lambda | y_1, \\dots, y_n)$ 是各个 PMF 的乘积：\n$$L(\\lambda | y_1, \\dots, y_n) = \\prod_{i=1}^{n} P(y_i|\\lambda) = \\prod_{i=1}^{n} \\frac{(\\lambda t)^{y_i} \\exp(-\\lambda t)}{y_i!}$$\n$$= \\frac{(t)^{\\sum_{i=1}^{n} y_i}}{\\prod_{i=1}^{n} y_i!} (\\lambda)^{\\sum_{i=1}^{n} y_i} \\exp(-n \\lambda t)$$\n为了找到共轭先验，我们只需要似然函数的核心部分，也就是依赖于 $\\lambda$ 的部分：\n$$L(\\lambda | y_1, \\dots, y_n) \\propto \\lambda^{\\sum_{i=1}^{n} y_i} \\exp(-n t \\lambda)$$\n这个核心部分具有 $\\lambda^{k} \\exp(-c \\lambda)$ 的形式，这是伽马分布的特征。如果一个概率分布作为某个似然函数的先验分布时，所得到的后验分布与先验分布属于同一族分布，那么这个概率分布就是该似然函数的共轭先验。因此，泊松率参数 $\\lambda$ 的共轭先验是伽马分布。\n\n我们将 $\\lambda$ 的先验定义为形状参数为 $a_0$、率参数为 $b_0$ 的伽马分布：\n$$p(\\lambda) = \\text{Gamma}(\\lambda | a_0, b_0) = \\frac{b_0^{a_0}}{\\Gamma(a_0)} \\lambda^{a_0-1} \\exp(-b_0 \\lambda)$$\n其中 $\\Gamma(\\cdot)$ 是伽马函数。\n\n*   **选择的理由：**\n    1.  **共轭性**：正如下一步将要展示的，对泊松率参数使用伽马先验会得到一个伽马后验。这个性质，即共轭性，在计算上非常方便，因为它能为后验分布提供一个闭合形式的解析表达式，从而避免了使用像 MCMC 这样的数值积分方法。\n    2.  **可解释性**：在此生物医学背景下，超参数 $a_0$ 和 $b_0$ 有着清晰的解释。它们可以被看作是代表了等效于在总计 $b_0$ 分钟的观察时间内观测到 $a_0$ 个事件的先验信息。先验均值率为 $E[\\lambda] = a_0/b_0$，先验方差为 $\\text{Var}(\\lambda) = a_0/b_0^2$。相对于 $a_0$ 而言，一个较大的 $b_0$ 代表了对 $\\lambda$ 值有很强的先验信念（低方差）。这使得研究人员能够正式地将来自先前研究或既有文献的知识整合进来。\n\n**任务2：$\\lambda$的后验分布**\n\n根据贝叶斯定理，后验分布 $p(\\lambda | y_1, \\dots, y_n)$ 正比于似然函数与先验分布的乘积：\n$$p(\\lambda | y_1, \\dots, y_n) \\propto L(\\lambda | y_1, \\dots, y_n) \\times p(\\lambda)$$\n$$p(\\lambda | y_1, \\dots, y_n) \\propto \\left( \\lambda^{\\sum_{i=1}^{n} y_i} \\exp(-n t \\lambda) \\right) \\times \\left( \\lambda^{a_0-1} \\exp(-b_0 \\lambda) \\right)$$\n合并包含 $\\lambda$ 的项：\n$$p(\\lambda | y_1, \\dots, y_n) \\propto \\lambda^{(\\sum_{i=1}^{n} y_i) + a_0 - 1} \\exp(-(nt + b_0)\\lambda)$$\n这是伽马分布的核心。我们可以确定更新后（后验）的超参数，我们称之为 $a_n$ 和 $b_n$：\n$$a_n = a_0 + \\sum_{i=1}^{n} y_i$$\n$$b_n = b_0 + nt$$\n因此，$\\lambda$ 的后验分布是一个伽马分布：\n$$p(\\lambda | y_1, \\dots, y_n) = \\text{Gamma}(\\lambda | a_n, b_n) = \\text{Gamma}\\left(\\lambda \\bigg| a_0 + \\sum_{i=1}^{n} y_i, b_0 + nt\\right)$$\n后验均值为 $E[\\lambda | y_1, \\dots, y_n] = a_n/b_n$，后验方差为 $\\text{Var}(\\lambda | y_1, \\dots, y_n) = a_n/b_n^2$。\n\n**任务3：后验预测分布**\n\n后验预测分布给出了在给定先前数据的情况下，新观测值 $y_{\\text{new}}$ 的概率。新的观测来自一个持续时间为 $t^{\\star}$ 的窗口，因此其似然是 $p(y_{\\text{new}}|\\lambda) = \\text{Poisson}(y_{\\text{new}}|\\lambda t^{\\star})$。我们通过将此似然与 $\\lambda$ 的后验分布的乘积对所有可能的 $\\lambda$ 值进行边缘化，来求得后验预测 PMF：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\int_{0}^{\\infty} p(y_{\\text{new}}|\\lambda) p(\\lambda|y_1, \\dots, y_n) d\\lambda$$\n代入各自的函数：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\int_{0}^{\\infty} \\left[ \\frac{(\\lambda t^{\\star})^{y_{\\text{new}}} \\exp(-\\lambda t^{\\star})}{y_{\\text{new}}!} \\right] \\left[ \\frac{b_n^{a_n}}{\\Gamma(a_n)} \\lambda^{a_n-1} \\exp(-b_n \\lambda) \\right] d\\lambda$$\n我们将不依赖于 $\\lambda$ 的项移到积分符号外：\n$$= \\frac{(t^{\\star})^{y_{\\text{new}}} b_n^{a_n}}{y_{\\text{new}}! \\Gamma(a_n)} \\int_{0}^{\\infty} \\lambda^{y_{\\text{new}}} \\exp(-\\lambda t^{\\star}) \\lambda^{a_n-1} \\exp(-b_n \\lambda) d\\lambda$$\n$$= \\frac{(t^{\\star})^{y_{\\text{new}}} b_n^{a_n}}{y_{\\text{new}}! \\Gamma(a_n)} \\int_{0}^{\\infty} \\lambda^{a_n + y_{\\text{new}} - 1} \\exp(-(b_n + t^{\\star})\\lambda) d\\lambda$$\n该积分是一个伽马分布 $\\text{Gamma}(a_n + y_{\\text{new}}, b_n + t^{\\star})$ 的核心在其定义域上的积分。这个积分的值是 $\\frac{\\Gamma(a_n + y_{\\text{new}})}{(b_n + t^{\\star})^{a_n + y_{\\text{new}}}}$。\n将此结果代回：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\frac{(t^{\\star})^{y_{\\text{new}}} b_n^{a_n}}{y_{\\text{new}}! \\Gamma(a_n)} \\frac{\\Gamma(a_n + y_{\\text{new}})}{(b_n + t^{\\star})^{a_n + y_{\\text{new}}}}$$\n重新整理各项：\n$$= \\frac{\\Gamma(a_n + y_{\\text{new}})}{\\Gamma(y_{\\text{new}}+1) \\Gamma(a_n)} \\left(\\frac{b_n}{b_n + t^{\\star}}\\right)^{a_n} \\left(\\frac{t^{\\star}}{b_n + t^{\\star}}\\right)^{y_{\\text{new}}}$$\n这里我们使用了 $y_{\\text{new}}! = \\Gamma(y_{\\text{new}}+1)$。项 $\\frac{\\Gamma(a_n + y_{\\text{new}})}{\\Gamma(y_{\\text{new}}+1) \\Gamma(a_n)}$ 是二项式系数 $\\binom{a_n+y_{\\text{new}}-1}{y_{\\text{new}}}$ 的定义。\n这是负二项分布的 PMF。令 $r = a_n$ 且 $p = \\frac{b_n}{b_n + t^{\\star}}$。其 PMF 为：\n$$p(y_{\\text{new}}|y_1, \\dots, y_n) = \\binom{y_{\\text{new}} + r - 1}{y_{\\text{new}}} p^r (1-p)^{y_{\\text{new}}}$$\n所以，$y_{\\text{new}}$ 的后验预测分布是负二项分布，$y_{\\text{new}}|y_1, \\dots, y_n \\sim \\text{NB}(r, p)$，其参数为：\n$$r = a_n = a_0 + \\sum_{i=1}^{n} y_i$$\n$$p = \\frac{b_n}{b_n + t^{\\star}} = \\frac{b_0 + nt}{b_0 + nt + t^{\\star}}$$\n\n**任务4：后验方差的定性解释**\n\n$\\lambda$ 的后验方差由后验分布 $\\text{Gamma}(\\lambda | a_n, b_n)$ 的方差给出，即：\n$$\\text{Var}(\\lambda | y_1, \\dots, y_n) = \\frac{a_n}{b_n^2} = \\frac{a_0 + \\sum_{i=1}^{n} y_i}{(b_0 + nt)^2}$$\n-   **对先验超参数（$a_0$, $b_0$）的依赖性**：超参数 $a_0$ 和 $b_0$ 代表了来自先验实验的有效信息。$a_0$（先验事件计数）的增加会使分子增大，从而倾向于增大方差。$b_0$（先验观察时间）的增加会使分母呈平方增长，从而显著减小方差。因此，一个信息更丰富的先验（即更大的 $b_0$）会导致更小的后验方差，因为先验信念的权重更大，从而限制了 $\\lambda$ 的可能取值。\n-   **对观测数据（$n$, $\\sum y_i$）的依赖性**：观测数据通过窗口数量 $n$ 和总计数 $\\sum_{i=1}^{n} y_i$ 对后验产生影响。\n    -   随着观测数量 $n$ 的增加，总数据观察时间 $nt$ 也随之增加。由于分母是 $(b_0 + nt)^2$，它随 $n^2$ 增长。而分子中的总计数 $\\sum y_i$ 预期仅随 $n$ 线性增长（约为 $n \\lambda t$）。分母的二次增长起主导作用，导致后验方差随着 $n$ 的增加而减小。这反映了“更多数据能带来对参数更高的确定性（更小的方差）”这一原理。\n    -   对于固定的观测数量 $n$，更大的总计数 $\\sum y_i$ 意味着对率 $\\lambda$ 的估计值更高。这个更大的总计数会增加分子 $a_n$，从而增大了后验方差。这可能看起来违反直觉，但这是伽马分布的一个性质，其方差（$a/b^2$）与均值（$a/b$）除以率参数（$b$）成正比。对于固定的总观察时间（$b_n$），一个具有更高平均率的过程自然具有更高的绝对不确定性（方差）。",
            "answer": "$$\\boxed{\\frac{a_0 + \\sum_{i=1}^{n} y_i}{(b_0 + nt)^2}}$$"
        }
    ]
}