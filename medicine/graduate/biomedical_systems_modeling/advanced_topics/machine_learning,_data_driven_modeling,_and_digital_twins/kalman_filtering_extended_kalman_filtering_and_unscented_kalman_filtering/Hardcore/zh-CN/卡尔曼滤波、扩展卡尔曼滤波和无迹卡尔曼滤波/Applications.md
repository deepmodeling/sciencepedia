## 应用与跨学科连接

### 引言

在前几章中，我们已经系统地探讨了卡尔曼滤波（KF）、扩展卡尔曼滤波（EKF）和无迹卡尔曼滤波（UKF）的基本原理与数学机制。这些强大的工具为在不确定性下进行动态状态估计提供了统一的贝叶斯框架。然而，理论的价值最终体现在其解决实际问题的能力上。本章的宗旨是搭建理论与实践之间的桥梁，展示这些滤波算法如何在多样化的真实世界和跨学科背景下得到应用，特别是在[生物医学系统建模](@entry_id:1121641)这一复杂而重要的领域。

我们将不再重复核心的滤波方程，而是聚焦于如何将这些原理应用于具体问题。我们将从构建生物医学系统的[状态空间模型](@entry_id:137993)这一基础步骤开始，探索如何将生理学或药理学知识转化为滤波器可以理解的数学语言。随后，我们将深入探讨如何处理现实世界中普遍存在的复杂性，例如多源噪声、传感器伪影、[信号延迟](@entry_id:261518)和外部控制输入。最后，我们将介绍一些高级估计策略，包括用于模型个性化的在线参数估计，以及当系统呈现出强[非线性](@entry_id:637147)或非高斯特性时，为何以及如何超越卡尔曼滤波家族，转向更通用的[粒子滤波](@entry_id:140084)方法。通过这些应用案例，您将深刻理解卡尔曼滤波不仅是一套抽象的数学工具，更是解决从可穿戴健康监测到流行病学预测等广泛科学与工程挑战的基石。

### 构建生物医学系统的状态空间模型

将一个动态系统适配于卡尔曼滤波框架的第一步，也是至关重要的一步，是将其描述为[状态空间](@entry_id:160914)形式。这包括定义状态向量 $x_k$、系统动态函数 $f(\cdot)$、测量函数 $h(\cdot)$，以及[过程噪声和测量噪声](@entry_id:165587)的统计特性。在生物医学领域，这一过程通常始于对系统背后生理或物理过程的基本原理的理解，例如[质量平衡](@entry_id:181721)、[反应动力学](@entry_id:150220)或电路定律。

一个构建状态空间模型的经典例子是药代动力学（Pharmacokinetics, PK）中的[二室模型](@entry_id:897326)。该模型描述了药物在中央室（如血浆）和外周室（如组织）之间的分布和消除过程。假设药物通过静脉注射进入中央室，[状态向量](@entry_id:154607) $x(t) = [x_1(t), x_2(t)]^T$ 分别代表中央室和外周室的药物量。基于[一级动力学](@entry_id:183701)假设，药物从中央室到外周室的转运速率为 $k_{12}x_1(t)$，从外周室返回中央室的速率为 $k_{21}x_2(t)$，药物从中央室的消除速率为 $k_{10}x_1(t)$。通过对每个室应用质量平衡原理（即物质变化率等于流入率减去流出率），我们可以推导出如下的连续时间线性[状态空间方程](@entry_id:266994)：
$$
\dot{\mathbf{x}}(t) = A \, \mathbf{x}(t) + B \, u(t), \quad y(t) = C \, \mathbf{x}(t) + v(t)
$$
其中 $u(t)$ 是给药速率，$y(t)$ 是测量的中央室药物浓度。状态矩阵 $A$ 描述了内部的转运和消除动力学，输入矩阵 $B$ 将外部输入映射到相应的状态，输出矩阵 $C$ 则将状态量（药物量）转换为测量量（浓度）。对于上述系统，这些矩阵分别为：
$$
A = \begin{bmatrix} - (k_{10} + k_{12}) & k_{21} \\ k_{12} & - k_{21} \end{bmatrix}, \quad B = \begin{bmatrix} 1 \\ 0 \end{bmatrix}, \quad C = \begin{bmatrix} \frac{1}{V_{1}} & 0 \end{bmatrix}
$$
其中 $V_1$ 是中央室的表观分布容积。这个例子清晰地展示了如何从物理原理出发，构建一个可供标准卡尔曼滤波使用的线性模型 。

然而，大多数生物系统本质上是高度[非线性](@entry_id:637147)的。例如，经典的伯格曼葡萄糖-胰岛素最小模型（Bergman minimal model）就包含了[非线性](@entry_id:637147)项。该模型使用一个三维状态向量 $x(t) = [G(t), X(t), I(t)]^T$ 来描述血浆葡萄糖浓度 $G(t)$、远程室[胰岛素](@entry_id:150981)作用 $X(t)$ 和血浆胰岛素浓度 $I(t)$ 的动态。其微分方程组中包含了诸如 $-X(t)G(t)$ 这样的[双线性](@entry_id:146819)项，它代表了由胰岛素介导的葡萄糖吸收，这是系统[非线性](@entry_id:637147)的核心来源。为了应用EKF或UKF，我们必须将这些连续时间的[非线性常微分方程](@entry_id:142950)（ODEs）离散化，以得到[非线性](@entry_id:637147)状态转移函数 $x_{k+1} = f(x_k, u_k) + w_k$。一种常见的方法是使用[前向欧拉法](@entry_id:141238)，将状态在 $k$ 时刻的导[数乘](@entry_id:155971)以时间步长 $\Delta t$ 作为状态的增量。对于最小模型，这会产生如下形式的离散时间动态方程：
$$
\begin{aligned}
G_{k+1} = G_k + \Delta t\left[-S_G\left(G_k - G_b\right) - X_k G_k + M_k\right] \\
X_{k+1} = X_k + \Delta t\left[-p_2 X_k + p_3\left(I_k - I_b\right)\right] \\
I_{k+1} = I_k + \Delta t\left[-n\left(I_k - I_b\right) + u_k\right]
\end{aligned}
$$
其中 $M_k$ 和 $u_k$ 分别是外源葡萄糖摄入和[胰岛素](@entry_id:150981)输注的输入。这里的测量通常是连续[血糖监测](@entry_id:905748)（CGM）设备提供的葡萄糖浓度，因此测量函数是线性的 $h(x_k) = G_k$。这个例子展示了从[非线性](@entry_id:637147)生理模型到适用于EKF/UKF的离散时间函数 $f(\cdot)$ 和 $h(\cdot)$ 的推导过程 。

测量过程本身也可能是[非线性](@entry_id:637147)的。在药效动力学（Pharmacodynamics, PD）中，药物在效应室的浓度 $x_{1,k}$ 与其产生的生理效应（如镇静深度）之间的关系通常由饱和的[S型曲线](@entry_id:139002)描述，例如[Michaelis-Menten](@entry_id:145978)或[Emax模型](@entry_id:925872)。假设测量的效应 $y_k$ 是由效应室浓度 $x_{1,k}$ 和一个缓慢变化的基线偏移 $x_{2,k}$ 共同决定的，则测量函数可能是：
$$
h(x_k) = \frac{E_{\max} x_{1,k}}{EC_{50} + x_{1,k}} + x_{2,k}
$$
其中 $E_{\max}$ 是最大效应，$EC_{50}$ 是产生半数最大效应时的浓度。在EKF中，我们需要在每次更新时对这个[非线性](@entry_id:637147)函数进行线性化，即计算其关于状态向量 $x_k = [x_{1,k}, x_{2,k}]^T$ 的[雅可比矩阵](@entry_id:178326) $H_k = \frac{\partial h}{\partial x}$。通过求偏导，我们可以得到用于EKF更新的测量[雅可比矩阵](@entry_id:178326)，它量化了在当前预测状态下，输出对状态各分量的局部敏感性 。

### 应对现实世界中的复杂性：噪声、伪影与延迟

将理论模型应用于现实[世界时](@entry_id:275204)，我们必须面对各种非理想因素。一个设计良好的滤波器不仅能处理标准的[高斯白噪声](@entry_id:749762)，还能通过巧妙的建模策略来应对更复杂的挑战，如结构化噪声、传感器伪影、控制输入和[数据传输](@entry_id:276754)延迟。

#### 编码先验知识与不确定性

滤波器的性能在很大程度上取决于其初始化，特别是初始状态的[先验分布](@entry_id:141376) $x_0 \sim \mathcal{N}(\mu_0, P_0)$。这个先验并不仅仅是一个数学构造，它编码了我们在获得任何特定于个体的数据之前，对系统初始状态的所有临床或生理学知识。例如，在估计一个病人的基线血糖[稳态](@entry_id:139253)时，[状态向量](@entry_id:154607)可能包含空腹血糖 $G_0$ 和[胰岛素敏感性](@entry_id:897480) $S_{I0}$。此时，$\mu_0$ 可以是来[自相似](@entry_id:274241)人群（队列）的平均值，而[协方差矩阵](@entry_id:139155) $P_0$ 则量化了初始不确定性。$P_0$ 的对角线元素（方差）代表了我们对每个生理参数先验值的不确定程度，例如 $P_{0,11}$ 表示空腹血糖在人群中的变异性。一个较大的 $P_{0,11}$ 值意味着我们对先验均值 $\mu_G$ 的信心较低，这将导致滤波器在接收到第一个血糖测量值 $y_0$ 时，更多地依赖该测量值来修正估计。反之，一个过小的 $P_{0,11}$（即过度自信的先验）则可能导致滤波器“固执己见”，忽略与先验模型显著偏离的早期测量数据，从而延缓了对个体真实生理状况的识别。

更有趣的是，$P_0$ 的非对角[线元](@entry_id:196833)素（协方差）代表了不同[状态变量](@entry_id:138790)之间的生理关联。例如，空腹血糖和[胰岛素敏感性](@entry_id:897480)之间可能存在负相关关系。通过在 $P_0$ 中设定一个非零的协方差项 $P_{0,12}$，我们就能利用这种关联。即使我们只测量了血糖（一个状态分量），卡尔曼增益的结构也会利用这个协方差，使得对血糖的测量更新能够同时修正对未直接测量的[胰岛素敏感性](@entry_id:897480)的估计。这是多变量滤波相比于一系列独立单变量滤波的强大之处 。

#### 建模与分离噪声源

正确地识别和建模系统中的噪声源是[滤波器设计](@entry_id:266363)的核心挑战之一，这直接关系到[过程噪声协方差](@entry_id:186358) $Q$ 和测量[噪声协方差](@entry_id:1128754) $R$ 的设定。$Q$ 描述了状态演化模型 $x_{k+1}=f(x_k, u_k)+w_k$ 的不确定性，代表了真实生理过程与我们简化的数学模型之间的偏差。$R$ 则描述了测量过程 $y_k=h(x_k)+v_k$ 的不确定性，通常来源于传感器本身的物理限制。

以可穿戴光电容积脉搏波（[PPG](@entry_id:898778)）传感器为例，它会受到多种噪声的干扰。高频的、无时间相关的热噪声或电子噪声直接叠加在测量信号上，这完美符合[测量噪声](@entry_id:275238) $v_k$ 的定义，其方差应被包含在 $R$ 中。然而，其他类型的干扰则更为复杂。例如，缓慢的传感器漂移（由温度或[组织灌注](@entry_id:908653)变化引起）是一种具有时间相关性的偏差，它在当前时刻的值与前一时刻高度相关。将其简单地归入 $v_k$ 会违反测量噪声是“白色”的（即时间上不相关）基本假设。一个更强大和原则性的方法是**状态增强**（state augmentation）。我们可以将这个漂移 $b_k$ 视为一个新的、未直接观测的[状态变量](@entry_id:138790)，并为其建立一个动态模型，最常见的模型是随机游走（random walk）：$b_{k+1} = b_k + \eta_k$，其中 $\eta_k$ 是一个方差很小的[过程噪声](@entry_id:270644)。这个新的状态被加入到原始[状态向量](@entry_id:154607)中，其动态的不确定性（即 $\eta_k$ 的方差）则被纳入增广后的[过程噪声协方差](@entry_id:186358)矩阵 $Q$ 中。测量方程也相应地修改为 $y_k = h(x_k) + b_k + v_k$。通过这种方式，滤波器能够主动地跟踪并估计这个时变的漂移，从而将其从生理信号中分离出来 。

同样的技术可以用来处理与外部可测量因素相关的结构化伪影，例如[运动伪影](@entry_id:1128203)。在[PPG](@entry_id:898778)信号中，手腕的运动会产生与真实脉搏无关的信号成分。如果我们同时有一个加速度计来测量运动强度 $\alpha_k$，就可以将[运动伪影](@entry_id:1128203)建模为加速度的函数。一个复杂的模型可能会将伪影表示为 $c_k^T \phi(\alpha_k)$，其中 $\phi(\alpha_k)$ 是加速度信号的基函数，而 $c_k$ 是一个缓慢变化的系数向量。这个系数向量 $c_k$ 也可以被增广到[状态向量](@entry_id:154607)中，并用[随机游走模型](@entry_id:180803)来描述其缓慢的变化。这样，滤波器就能利用加速度计的数据，[在线学习](@entry_id:637955)并减去运动伪影的贡献。这种将有色或结构化的噪声源通过状态增强引入系统动态模型的方法，是区分并处理不同类型不确定性的核心策略，远比简单地增大 $R$ 值要有效得多 。

#### 处理系统中的控制输入与延迟

许多生物医学应用，如闭环药物输送或[人工胰腺](@entry_id:912865)，都涉及对系统施加已知的控制输入 $u_k$。在卡尔曼滤波框架中，已知的、确定性的控制输入被直接整合到状态预测步骤中。对于[线性系统](@entry_id:147850) $x_{k+1} = A x_k + B u_k + w_k$，状态均值的预测为 $\hat{x}_{k+1|k} = A \hat{x}_{k|k} + B u_k$。重要的是，由于 $u_k$ 是已知的确定性量，它不会给系统增加任何不确定性。因此，状态协方差的预测方程 $P_{k+1|k} = A P_{k|k} A^T + Q$ 与没有控制输入时完全相同。同样，在测量更新步骤中，控制输入会影响预测的测量值 $\hat{y}_{k|k-1} = C \hat{x}_{k|k-1} + D u_k$（如果存在直接馈通项 $D$），从而影响新息（innovation）的计算，但它不会改变[卡尔曼增益](@entry_id:145800) $K_k$，因为增益仅由协方差决定。对于[非线性](@entry_id:637147)的EKF和UKF，确定性输入 $u_k$ 同样作为已知参数参与状态和测量的预测，而不会直接增加协方差。这个特性使得滤波器能够精确地将控制动作的效果从系统的随机动态中分离出来 。

另一个常见的现实挑战是[数据传输](@entry_id:276754)延迟。例如，一个可穿戴[脉搏血氧仪](@entry_id:202030)的读数可能因为信号处理和无线传输，在时刻 $t$ 才报告出对应于时刻 $t-d$ 的生理状态的测量值 $y_t = h(x_{t-d}) + v_t$，其中 $d$ 是一个已知的固定延迟。处理这种延迟的一个有效方法也是状态增强。我们可以构造一个包含了当前状态以及过去 $d$ 个状态的增广向量 $z_t = [x_t, x_{t-1}, \ldots, x_{t-d}]^T$。这个增广状态的动态可以通过一个简单的“[移位寄存器](@entry_id:754780)”结构来描述。这样，延迟的测量 $y_t$ 就变成了对增广状态 $z_t$ 的一个直接（无延迟）的测量，因为它直接关联于 $z_t$ 的最后一个分量 $x_{t-d}$。然后就可以对这个增广系统应用标准的卡尔曼滤波。

当数据不仅有固定延迟，还可能[乱序](@entry_id:147540)到达时，情况会更复杂。例如，在时刻 $k=4$ 时，我们收到了一个时间戳为 $j=2$ 的“过时”测量值 $y_2$。直接丢弃这个信息是浪费的。一个称为“[乱序](@entry_id:147540)测量更新”（Out-of-Sequence Measurement, OOSM）的算法可以在不重新处理从 $j$ 到 $k$ 的所有数据的情况下，将 $y_2$ 的信息一致地融合到当前时刻 $k$ 的状态估计中。其核心思想是利用状态 $x_k$ 和 $x_j$ 之间的互协方差 $P_{k,j} = \text{Cov}(x_k, x_j)$。通过这个互协方差，在时刻 $j$ 的新息（$y_2$ 与其预测值之差）可以被正确地“传播”到时刻 $k$，从而更新 $\hat{x}_{k|k}$ 和 $P_{k|k}$。这种方法对于构建能够处理不完美通信网络的稳健远程监控系统至关重要 。

### 高级估计策略与跨学科应用

随着模型变得更加复杂，我们需要的估计策略也必须相应升级。这包括处理模型参数本身的不确定性，根据实时数据自适应地调整滤波器，以及当系统的非高斯特性变得不可忽略时，采用更先进的滤波方法。

#### 联合状态与参数估计

在许多应用中，我们不仅对系统的动态状态感兴趣，还希望能够识别模型中的未知参数，以实现模型的个性化。例如，在药物治疗中，不同病人的[药代动力学参数](@entry_id:917544)（如消除速率 $k_e$）可能存在巨大差异。在线估计这些参数对于实现[个体化给药](@entry_id:904575)至关重要。

一种强大的技术是**联合估计**（joint estimation），它通过状态增强将未知参数也视为状态变量。我们将参数（如 $k_e$ 和 $k_{12}$）加入到状态向量中，并假设它们是常数或随时间缓慢漂移。对于缓慢漂移的参数，我们为其赋予一个[随机游走模型](@entry_id:180803)，例如 $\theta_{k+1} = \theta_k + w_{\theta,k}$，其中 $w_{\theta,k}$ 是一个方差很小的[过程噪声](@entry_id:270644)。这个小的[过程噪声](@entry_id:270644)确保了参数的协方差不会衰减到零，使得滤波器能够持续地根据新的测量数据来更新参数估计。由于参数的引入通常会使系统模型变为[非线性](@entry_id:637147)（例如，PK模型中的项 $(k_e + k_{12})a_1$），我们通常需要使用EKF或UKF对这个增广系统进行滤波。

然而，联合[参数估计](@entry_id:139349)的成功并非没有前提。一个关键的概念是**[可辨识性](@entry_id:194150)**（identifiability）。我们必须能够从可用的输入-输出数据中唯一地确定参数的值。这通常要求输入信号具有足够的“激励性”（persistent excitation），以激发系统所有相关的动态模式。例如，在PK模型中，如果药物输注速率 $u(t)$ 恒定，系统最终会达到[稳态](@entry_id:139253)。在[稳态](@entry_id:139253)下，测量到的血药浓度可能只依赖于参数的一个组合（如只依赖于 $k_e$），而无法区分 $k_e$ 和 $k_{12}$ 的各自贡献。只有在动态变化的输入下，通过观察系统响应的瞬态行为，才有可能将它们分开。形式上，可辨识性与增广系统的局部能观性矩阵是否满秩有关 。

当状态和参数的动态存在明显的时间尺度分离时（例如，生理状态变化快，而模型参数漂移非常慢），将它们耦合在一个大的增广滤波器中可能不是最高效或最稳健的选择。**双重滤波**（dual filtering）提供了一种替代方案。它采用两个相互耦合的滤波器：一个状态滤波器，用于在给定当前[参数估计](@entry_id:139349)的条件下估计快速变化的状态；一个参数滤波器，用于利用状态滤波器的输出（通常是测量残差），在更长的时间尺度上更新缓慢变化的参数。这种[解耦](@entry_id:160890)结构可以降低计算复杂度，提高[数值稳定性](@entry_id:175146)，并允许为[参数估计](@entry_id:139349)整合更长时间的数据，从而获得更平滑、方差更小的参数轨迹 [@problem_id: 3922760]。

#### [自适应滤波](@entry_id:185698)与调优

在许多实际应用中，[过程噪声](@entry_id:270644) $Q$ 和测量噪声 $R$ 的强度并不是恒定不变的。例如，在利用[PPG](@entry_id:898778)信号进行[心率](@entry_id:151170)监测时，当用户从静坐变为慢跑时，两个关键因素会发生变化：首先，由于运动伪影，[PPG](@entry_id:898778)传感器的[测量噪声](@entry_id:275238)会显著增加；其次，[心率](@entry_id:151170)本身的动态变化会更剧烈，我们用于描述[心率](@entry_id:151170)变化的简单模型（如随机游走或[一阶系统](@entry_id:147467)）的误差也会增大，即[模型非线性](@entry_id:899461)效应或[未建模动态](@entry_id:264781)的影响增强。

如果继续使用为静止状态优化的固定 $Q$ 和 $R$，滤波器性能会急剧下降。在慢跑时，一个固定的、较小的 $R$ 值会导致滤波器过度信任充满噪声的[PPG](@entry_id:898778)测量，使[心率](@entry_id:151170)估计变得非常不稳定。相反，如果使用一个为慢跑设计的、较大的 $R$ 值，那么在静止时，滤波器又会变得过于保守，对真实[心率](@entry_id:151170)的细微变化反应迟钝。

一个更优的策略是实现**[自适应滤波](@entry_id:185698)**（adaptive filtering），即根据实时情境信息在线调整 $Q_k$ 和 $R_k$。我们可以利用设备上的其他传感器（如加速度计）来获取运动强度的代理指标 $a_k$。然后，将测量[噪声协方差](@entry_id:1128754) $R_k$ 建模为 $a_k$ 的一个单调递增函数，实现当运动加剧时，自动降低对[PPG](@entry_id:898778)测量的信任度。类似地，[过程噪声协方差](@entry_id:186358) $Q_k$ 也需要调整。在剧烈运动期间，描述[心率](@entry_id:151170)动态的函数 $f(\cdot)$ 的[局部线性化](@entry_id:169489)误差会增大，因此应增大 $Q_k$ 来补偿这一额外的模型不确定性。这种自适应调优的最终目标是确保滤波器的**一致性**（consistency），即滤波器产生的残差（新息）序列的统计特性应与其理论协方差 $S_k = H_k P_{k|k-1} H_k^T + R_k$ 相匹配。通过分析归一化新息平方（NIS）等统计量，可以系统地验证和迭代优化 $Q_k$ 和 $R_k$ 的自适应策略 [@problem_id: 3895388]。

#### 超越[高斯假设](@entry_id:170316)：[非线性](@entry_id:637147)与非高斯模型

卡尔曼滤波家族（KF, EKF, UKF）的一个共同基础是，它们都将后验[概率密度函数](@entry_id:140610) $p(x_k|y_{1:k})$ 表示为或近似为一个高斯分布。这个假设在许多情况下是合理且有效的。然而，当系统具有强[非线性](@entry_id:637147)或其噪声统计显著偏离高斯分布时，这个假设就会被打破，导致滤波器性能下降甚至失效。

一个典型的例子是当测量[似然函数](@entry_id:921601) $p(y_k|x_k)$ 本身是多峰的。假设一个[生物传感器](@entry_id:182252)由于某种物理对称性，其输出 $y_k$ 可能以等概率对应于真实状态 $x_k$ 的 $+ax_k$ 或 $-ax_k$。这种情况下，给定一个测量值 $y_k$，真实状态 $x_k$ 可能在 $y_k/a$ 附近，也可能在 $-y_k/a$ 附近。这导致了双峰的[似然函数](@entry_id:921601)。当这个双峰似然与一个单峰的[高斯先验](@entry_id:749752)分布相乘时，得到的后验分布 $p(x_k|y_k)$ 通常也是双峰的。EKF、UKF或EnKF这类基于[高斯假设](@entry_id:170316)的滤波器，其结构决定了它们只能输出一个单峰的高斯分布。它们会尝试用一个高斯分布去“拟合”这个双峰的真实后验，结果通常是取两个峰值的[加权平均值](@entry_id:894528)作为均值，并用一个较大的方差来覆盖整个区域。这不仅丢失了关于多峰结构的关键信息，而且得到的均值可能位于两个峰之间的低概率区域，是一个非常糟糕的点估计 [@problem_id: 3917016]。

另一个挑战来自非高斯测量模型，这在生物和医学数据中很常见。例如，在利用每周报告的病例数来实时追踪传染病（如[SEIR模型](@entry_id:276875)）的传播时，病例数 $y_t$ 本质上是计数数据。将其建模为泊松分布 $y_t | x_t \sim \text{Poisson}(\rho \kappa I_t)$ 通常比高斯模型更为恰当，尤其是在病例数较少时，[泊松分布](@entry_id:147769)的偏斜和离散特性会非常显著。在这种情况下，后验分布也将是非高斯的。

面对这些挑战，我们需要一种能够表示任意形状概率分布的工具。**粒子滤波**（Particle Filter, PF）或称顺序[蒙特卡洛](@entry_id:144354)（Sequential [Monte Carlo](@entry_id:144354), SMC）方法应运而生。粒子滤波的核心思想是用一组带权重的随机样本（称为“粒子”）来近似表示[后验分布](@entry_id:145605)：$p(x_k|y_{1:k}) \approx \sum_{i=1}^M w_k^{(i)} \delta(x_k - x_k^{(i)})$。由于这种表示是非参数的，它原则上可以逼近任何形状的分布，包括多峰、偏斜或其他复杂形式。在每个时间步，粒子根据系统动态模型进行传播，然后根据测量[似然函数](@entry_id:921601)重新计算权重——那些能够更好解释观测数据的粒子会获得更高的权重。通过这种方式，粒子云能够自然地移动并聚集在后验概率高的区域，从而有效捕捉非[高斯和](@entry_id:196588)多峰的特性。

然而，[粒子滤波](@entry_id:140084)的强大能力也伴随着巨大的计算代价。其性能严重依赖于粒子数量 $M$。为了有效探索[状态空间](@entry_id:160914)，所需粒子数量会随着[状态向量](@entry_id:154607)维度 $d$ 的增加而急剧增长，这一现象被称为“[维度灾难](@entry_id:143920)”（curse of dimensionality）。对于高维系统，如包含许多参数的[流行病学模型](@entry_id:916471)，标准[粒子滤波](@entry_id:140084)可能会因样本枯竭（weight degeneracy）而失效，使得EKF或UKF尽[管存](@entry_id:1127299)在理论局限，但在计算上仍是更可行的选择。因此，在EKF/UKF和PF之间的选择，是在[高斯近似](@entry_id:636047)的偏差与高昂计算成本之间的权衡 [@problem_id: 4990229] [@problem_id: 4214317]。