{
    "hands_on_practices": [
        {
            "introduction": "The electrical activity of the heart originates at the cellular level. This first practice invites you to build and simulate a single-cell electrophysiology model, which forms the fundamental electrical component of any cardiac digital twin . By implementing the system of differential equations that govern ion channel dynamics, you will compute the action potential and investigate its sensitivity to key parameters, a core task in personalizing models and predicting responses to therapies.",
            "id": "3917274",
            "problem": "You are tasked with implementing a minimal, biophysically consistent single-cell membrane model for a patient-specific cardiac digital twin to compute the action potential duration at ninety percent repolarization (APD90) and to examine sensitivity to conductance changes of the Rapid Delayed Rectifier Potassium Current (IKr) and the L-type Calcium Current (ICaL). The model is to be based on first principles of current balance and gating kinetics, with all quantities expressed in consistent units. You must produce numerical outputs in milliseconds (ms), rounded to one decimal place, and aggregate the results of all test cases into a single list printed on one line.\n\nFundamental base:\n- The membrane voltage dynamics are governed by the current balance equation for a lumped capacitive membrane,\n$$C_m \\frac{dV}{dt} = -\\left(I_{CaL} + I_{Kr} + I_\\text{leak}\\right) + I_\\text{stim}(t),$$\nwhere $V$ is the membrane voltage in millivolts (mV), $t$ is time in milliseconds (ms), $C_m$ is the membrane capacitance in microfarads per square centimeter ($\\mu\\text{F}/\\text{cm}^2$), $I_{CaL}$ is the L-type calcium current in microamperes per square centimeter ($\\mu\\text{A}/\\text{cm}^2$), $I_{Kr}$ is the rapid delayed rectifier potassium current in $\\mu\\text{A}/\\text{cm}^2$, $I_\\text{leak}$ is a linear leak current in $\\mu\\text{A}/\\text{cm}^2$, and $I_\\text{stim}(t)$ is an externally applied stimulus current in $\\mu\\text{A}/\\text{cm}^2$.\n\n- Currents follow Ohm’s law with reversal potentials,\n$$I_{CaL} = G_{CaL}\\,d\\,h\\,\\left(V - E_{Ca}\\right), \\quad I_{Kr} = G_{Kr}\\,x_r\\,\\left(V - E_K\\right), \\quad I_\\text{leak} = G_\\text{leak}\\,\\left(V - E_\\text{leak}\\right),$$\nwhere $G_{CaL}$, $G_{Kr}$, and $G_\\text{leak}$ are conductances in millisiemens per square centimeter ($\\text{mS}/\\text{cm}^2$), $E_{Ca}$ and $E_K$ are reversal potentials in mV, $E_\\text{leak}$ is a leak reversal potential in mV, and $d$, $h$, and $x_r$ are gating variables in the unitless interval $[0,1]$.\n\n- Gating variables evolve according to first-order kinetics toward steady-state values with time constants:\n$$\\frac{dd}{dt} = \\frac{d_\\infty(V) - d}{\\tau_d(V)}, \\quad \\frac{dh}{dt} = \\frac{h_\\infty(V) - h}{\\tau_h(V)}, \\quad \\frac{dx_r}{dt} = \\frac{x_{r,\\infty}(V) - x_r}{\\tau_{xr}(V)}.$$\n\n- The steady-state (infinite time) gating values and time constants are defined by well-tested sigmoidal functions:\n$$d_\\infty(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{d,1/2}}{k_d}\\right)}, \\quad h_\\infty(V) = \\frac{1}{1 + \\exp\\left(\\frac{V - V_{h,1/2}}{k_h}\\right)}, \\quad x_{r,\\infty}(V) = \\frac{1}{1 + \\exp\\left(-\\frac{V - V_{xr,1/2}}{k_{xr}}\\right)},$$\n$$\\tau_d(V) = \\tau_{d,0} + \\frac{\\tau_{d,1}}{1 + \\exp\\left(-\\frac{V - V_{td}}{k_{td}}\\right)}, \\quad \\tau_h(V) = \\tau_{h,0}, \\quad \\tau_{xr}(V) = \\tau_{xr,0}.$$\n\n- Use the following fixed parameters that are physiologically plausible for ventricular myocardium:\n$$C_m = 1.0 \\ \\mu\\text{F}/\\text{cm}^2, \\quad E_{Ca} = 60 \\ \\text{mV}, \\quad E_K = -90 \\ \\text{mV}, \\quad E_\\text{leak} = -60 \\ \\text{mV}, \\quad G_\\text{leak} = 0.02 \\ \\text{mS}/\\text{cm}^2.$$\nGating parameters:\n$$V_{d,1/2} = -10 \\ \\text{mV}, \\quad k_d = 6 \\ \\text{mV}, \\quad \\tau_{d,0} = 2 \\ \\text{ms}, \\quad \\tau_{d,1} = 10 \\ \\text{ms}, \\quad V_{td} = -10 \\ \\text{mV}, \\quad k_{td} = 5 \\ \\text{mV},$$\n$$V_{h,1/2} = -30 \\ \\text{mV}, \\quad k_h = 6 \\ \\text{mV}, \\quad \\tau_{h,0} = 40 \\ \\text{ms},$$\n$$V_{xr,1/2} = -20 \\ \\text{mV}, \\quad k_{xr} = 7 \\ \\text{mV}, \\quad \\tau_{xr,0} = 100 \\ \\text{ms}.$$\n\n- External stimulus current to initiate a single action potential:\n$$I_\\text{stim}(t) = \\begin{cases}\nI_0 & \\text{if } t \\in [t_\\text{start}, t_\\text{end}],\\\\\n0 & \\text{otherwise},\n\\end{cases}$$\nwith $I_0 = 2.5 \\ \\mu\\text{A}/\\text{cm}^2$, $t_\\text{start} = 1.0 \\ \\text{ms}$, $t_\\text{end} = 3.0 \\ \\text{ms}$. The initial conditions are $V(0) = -80 \\ \\text{mV}$ and $d(0) = d_\\infty(-80 \\ \\text{mV})$, $h(0) = h_\\infty(-80 \\ \\text{mV})$, $x_r(0) = x_{r,\\infty}(-80 \\ \\text{mV})$.\n\nDefinition of APD90:\n- Let $V_\\text{rest}$ be the resting potential estimated as the average of $V(t)$ over $t \\in [0, 0.8] \\ \\text{ms}$.\n- Let $V_\\text{peak}$ be the maximum of $V(t)$ over the simulation window.\n- Define the action potential amplitude $A = V_\\text{peak} - V_\\text{rest}$.\n- If $A < 20 \\ \\text{mV}$, consider that no action potential is elicited and define $\\text{APD90} = 0.0 \\ \\text{ms}$.\n- Otherwise, define $V_{50} = V_\\text{rest} + 0.5 A$ and $V_{90} = V_\\text{rest} + 0.1 A$.\n- Let $t_\\text{up}$ be the first time on the upstroke when $V(t)$ crosses $V_{50}$ from below, and $t_{90}$ be the first time after $V_\\text{peak}$ when $V(t)$ crosses $V_{90}$ from above. Then\n$$\\text{APD90} = t_{90} - t_\\text{up}.$$\nUse linear interpolation between adjacent time samples to estimate crossing times.\n\nNumerical specification:\n- Simulate for $t \\in [0, 400] \\ \\text{ms}$ using a numerically stable solver for ordinary differential equations and a time resolution fine enough to resolve the crossings. All internal computations and outputs must be in milliseconds (ms) and millivolts (mV).\n- Express the final APD90 values in ms, each rounded to one decimal place.\n\nTest suite:\nEvaluate the model under five conductance configurations to assess sensitivity:\n1. Baseline: $(G_{Kr}, G_{CaL}) = (0.12, 0.10)$ in $\\text{mS}/\\text{cm}^2$.\n2. Reduced rapid delayed rectifier potassium conductance: $(G_{Kr}, G_{CaL}) = (0.06, 0.10)$.\n3. Increased L-type calcium conductance: $(G_{Kr}, G_{CaL}) = (0.12, 0.13)$.\n4. Increased rapid delayed rectifier potassium conductance: $(G_{Kr}, G_{CaL}) = (0.20, 0.10)$.\n5. Reduced L-type calcium conductance: $(G_{Kr}, G_{CaL}) = (0.12, 0.07)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the APD90 results for the five test cases as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each result is a float in ms rounded to one decimal place.",
            "solution": "The problem presented is a valid, well-posed initial value problem in the domain of computational cardiac electrophysiology. It is scientifically grounded in the Hodgkin-Huxley formalism for modeling ion channel dynamics and is self-contained, providing all necessary equations, parameters, initial conditions, and analysis procedures. The units are internally consistent, and the task is objective and computationally tractable. We may therefore proceed with a full solution.\n\nThe core of this problem is to simulate the time evolution of a cardiac cell's membrane voltage, $V(t)$, which is governed by the principle of charge conservation across the cell membrane. This principle is expressed as a first-order ordinary differential equation (ODE):\n$$C_m \\frac{dV}{dt} = -I_\\text{total} + I_\\text{stim}(t)$$\nHere, $C_m$ is the membrane capacitance per unit area, and the rate of change of voltage, $dV/dt$, is proportional to the net current flowing across the membrane. The total ionic current, $I_\\text{total}$, is the sum of contributions from different ion channels and pumps. In this simplified model, we consider three primary currents: the L-type calcium current ($I_{CaL}$), the rapid delayed rectifier potassium current ($I_{Kr}$), and a passive leak current ($I_\\text{leak}$).\n$$I_\\text{total} = I_{CaL} + I_{Kr} + I_\\text{leak}$$\nThe external stimulus current, $I_\\text{stim}(t)$, is a brief, externally applied current designed to perturb the cell from its resting state and trigger an action potential.\n\nEach ionic current is modeled using an Ohmic relationship, where the current is the product of a conductance ($G$) and a driving force ($V - E_{ion}$):\n$$I_{ion} = G_{ion} \\cdot (\\text{gating variables}) \\cdot (V - E_{ion})$$\nThe driving force is the difference between the membrane voltage $V$ and the Nernst equilibrium potential $E_{ion}$ for that specific ion. The conductance of voltage-gated channels is not constant; it depends on the conformational state of channel proteins, represented by unitless gating variables, which we denote here as $d$, $h$, and $x_r$.\n\nThe specific currents are:\n1.  $I_{CaL} = G_{CaL}\\,d\\,h\\,(V - E_{Ca})$: This calcium current is responsible for the characteristic plateau phase of the cardiac action potential. It is controlled by an activation gate, $d$, and an inactivation gate, $h$.\n2.  $I_{Kr} = G_{Kr}\\,x_r\\,(V - E_K)$: This potassium current is a primary driver of membrane repolarization, returning the voltage to its resting level. It is controlled by an activation gate, $x_r$.\n3.  $I_\\text{leak} = G_\\text{leak}\\,(V - E_\\text{leak})$: This is a time-independent-gating, linear background current that helps stabilize the resting membrane potential.\n\nThe dynamics of the gating variables are themselves described by first-order ODEs, representing transitions between permissive (open) and non-permissive (closed/inactivated) states:\n$$\\frac{dy}{dt} = \\frac{y_\\infty(V) - y}{\\tau_y(V)}$$\nwhere $y$ represents a generic gating variable ($d$, $h$, or $x_r$). The variable $y$ relaxes towards a voltage-dependent steady-state value, $y_\\infty(V)$, with a characteristic voltage-dependent (or constant) time constant, $\\tau_y(V)$. The steady-state activation/inactivation functions ($d_\\infty, h_\\infty, x_{r,\\infty}$) are typically sigmoidal, reflecting the cooperative nature of channel opening and closing in response to voltage changes.\n\nThis formulation results in a system of four coupled, first-order, non-linear ODEs for the state vector $\\mathbf{y}(t) = [V(t), d(t), h(t), x_r(t)]^T$:\n$$\n\\begin{cases}\n\\frac{dV}{dt} = \\frac{1}{C_m} \\left[ - (G_{CaL}\\,d\\,h\\,(V - E_{Ca}) + G_{Kr}\\,x_r\\,(V - E_K) + G_\\text{leak}\\,(V - E_\\text{leak})) + I_\\text{stim}(t) \\right] \\\\\n\\frac{dd}{dt} = \\frac{d_\\infty(V) - d}{\\tau_d(V)} \\\\\n\\frac{dh}{dt} = \\frac{h_\\infty(V) - h}{\\tau_h(V)} \\\\\n\\frac{dx_r}{dt} = \\frac{x_{r,\\infty}(V) - x_r}{\\tau_{xr}(V)}\n\\end{cases}\n$$\nGiven the initial conditions at $t=0$, this system must be solved numerically. We will employ an advanced adaptive ODE solver, such as the `Radau` method available in `scipy.integrate.solve_ivp`, which is well-suited for potentially stiff systems common in electrophysiology. The solver will be configured to produce a dense output, allowing for accurate evaluation of the solution at any time point.\n\nFollowing the simulation from $t=0$ to $t=400$ ms, we will analyze the resulting voltage trajectory $V(t)$ to calculate the Action Potential Duration at $90\\%$ repolarization (APD90). This metric quantifies the duration of the action potential. The calculation proceeds as specified:\n1.  Determine the resting potential, $V_\\text{rest}$, from the initial pre-stimulus phase.\n2.  Find the peak voltage, $V_\\text{peak}$.\n3.  Calculate the action potential amplitude, $A = V_\\text{peak} - V_\\text{rest}$. If $A < 20$ mV, no AP is fired, and APD90 is $0.0$.\n4.  Identify the depolarization time, $t_\\text{up}$, as the moment the voltage on the upstroke crosses $V_\\text{rest} + 0.5A$.\n5.  Identify the repolarization time, $t_{90}$, as the moment the voltage on the downstroke (after the peak) crosses $V_\\text{rest} + 0.1A$.\n6.  APD90 is then computed as $t_{90} - t_\\text{up}$.\nLinear interpolation will be used to find the precise crossing times between the discrete time steps of the numerical solution.\n\nThis entire procedure—simulation and analysis—is performed for each of the five specified pairs of conductances $(G_{Kr}, G_{CaL})$ to systematically assess the model's sensitivity to these two critical parameters. The results are then aggregated and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the cardiac cell model problem: simulates action potentials for\n    different conductance values and calculates APD90.\n    \"\"\"\n    # Fixed parameters as defined in the problem\n    params = {\n        'C_m': 1.0,      # uF/cm^2\n        'E_Ca': 60.0,    # mV\n        'E_K': -90.0,    # mV\n        'E_leak': -60.0, # mV\n        'G_leak': 0.02,  # mS/cm^2\n        # Gating parameters\n        'V_d_half': -10.0, 'k_d': 6.0,\n        'tau_d0': 2.0, 'tau_d1': 10.0, 'V_td': -10.0, 'k_td': 5.0,\n        'V_h_half': -30.0, 'k_h': 6.0, 'tau_h0': 40.0,\n        'V_xr_half': -20.0, 'k_xr': 7.0, 'tau_xr0': 100.0,\n        # Stimulus parameters\n        'I0': 2.5,       # uA/cm^2\n        't_start': 1.0,  # ms\n        't_end': 3.0,    # ms\n    }\n\n    test_cases = [\n        (0.12, 0.10), # Baseline\n        (0.06, 0.10), # Reduced IKr\n        (0.12, 0.13), # Increased ICaL\n        (0.20, 0.10), # Increased IKr\n        (0.12, 0.07), # Reduced ICaL\n    ]\n\n    results = []\n    \n    for G_Kr, G_CaL in test_cases:\n        \n        # Define steady-state and time constant functions\n        def d_inf(V): return 1.0 / (1.0 + np.exp(-(V - params['V_d_half']) / params['k_d']))\n        def h_inf(V): return 1.0 / (1.0 + np.exp((V - params['V_h_half']) / params['k_h']))\n        def xr_inf(V): return 1.0 / (1.0 + np.exp(-(V - params['V_xr_half']) / params['k_xr']))\n        \n        def tau_d(V): return params['tau_d0'] + params['tau_d1'] / (1.0 + np.exp(-(V - params['V_td']) / params['k_td']))\n        def tau_h(V): return params['tau_h0']\n        def tau_xr(V): return params['tau_xr0']\n        \n        # Define the ODE system\n        def model(t, y):\n            V, d, h, xr = y\n            \n            # Stimulus current\n            I_stim = params['I0'] if params['t_start'] <= t <= params['t_end'] else 0.0\n            \n            # Ionic currents\n            I_CaL = G_CaL * d * h * (V - params['E_Ca'])\n            I_Kr = G_Kr * xr * (V - params['E_K'])\n            I_leak = params['G_leak'] * (V - params['E_leak'])\n            \n            # Derivatives\n            dV_dt = (-I_CaL - I_Kr - I_leak + I_stim) / params['C_m']\n            dd_dt = (d_inf(V) - d) / tau_d(V)\n            dh_dt = (h_inf(V) - h) / tau_h(V)\n            dxr_dt = (xr_inf(V) - xr) / tau_xr(V)\n            \n            return [dV_dt, dd_dt, dh_dt, dxr_dt]\n\n        # Initial conditions\n        V0 = -80.0\n        y0 = [V0, d_inf(V0), h_inf(V0), xr_inf(V0)]\n        \n        # Simulation time span\n        t_span = [0, 400]\n        \n        # Solve the ODE system\n        sol = solve_ivp(\n            model, \n            t_span, \n            y0, \n            method='Radau', \n            dense_output=True, \n            atol=1e-8, \n            rtol=1e-8\n        )\n        \n        # Evaluate solution on a fine time grid\n        t_eval = np.linspace(t_span[0], t_span[1], 4001) # 0.1 ms resolution\n        V_eval = sol.sol(t_eval)[0]\n        \n        # Calculate APD90\n        # 1. V_rest\n        rest_mask = t_eval <= 0.8\n        V_rest = np.mean(V_eval[rest_mask])\n        \n        # 2. V_peak\n        peak_idx = np.argmax(V_eval)\n        V_peak = V_eval[peak_idx]\n        t_peak = t_eval[peak_idx]\n        \n        # 3. Amplitude and check for AP\n        A = V_peak - V_rest\n        if A < 20.0:\n            results.append(0.0)\n            continue\n            \n        # 4. Thresholds\n        V_50 = V_rest + 0.5 * A\n        V_90 = V_rest + 0.1 * A\n        \n        # Helper for linear interpolation\n        def find_crossing(t_data, V_data, threshold, direction):\n            for i in range(1, len(V_data)):\n                v1, v2 = V_data[i-1], V_data[i]\n                t1, t2 = t_data[i-1], t_data[i]\n                if direction == 'up' and v1 < threshold <= v2:\n                    return t1 + (t2 - t1) * (threshold - v1) / (v2 - v1)\n                if direction == 'down' and v1 > threshold >= v2:\n                    return t1 + (t2 - t1) * (threshold - v1) / (v2 - v1)\n            return None # Should not happen if AP is valid\n            \n        # 5. Find t_up\n        upstroke_mask = t_eval <= t_peak\n        t_up = find_crossing(t_eval[upstroke_mask], V_eval[upstroke_mask], V_50, 'up')\n        \n        # 6. Find t_90\n        downstroke_mask = t_eval >= t_peak\n        t_90 = find_crossing(t_eval[downstroke_mask], V_eval[downstroke_mask], V_90, 'down')\n\n        if t_up is None or t_90 is None:\n            apd90 = 0.0 # Could happen in edge cases\n        else:\n            apd90 = t_90 - t_up\n        \n        results.append(round(apd90, 1))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A cardiac digital twin must also capture the heart's primary mechanical function: pumping blood by generating pressure. This exercise explores the fundamental relationship between left ventricular pressure, wall stress, and geometry using the Law of Laplace . Applying this principle to a simplified model allows you to derive a key biomechanical equation and critically evaluate the assumptions that underpin many foundational models in cardiac mechanics.",
            "id": "3917320",
            "problem": "A patient-specific cardiac digital twin of the left ventricle (LV) is constructed using Magnetic Resonance Imaging (MRI) and Computed Tomography (CT) to obtain anatomy and a finite element (FE) electromechanical model to predict stress. At peak systole, the endocardial surface in a mid-ventricular short-axis slice is approximately spherical with principal radii of curvature both equal to $R$, and transmural gradients of circumferential Cauchy stress are modest. The FE model reports a midwall circumferential Cauchy stress $\\sigma_{\\theta}$ and the imaging-derived wall thickness is $h$. Treat the LV wall locally as a thin membrane whose in-surface isotropic tension $T$ is related to the midwall circumferential Cauchy stress by $T \\approx \\sigma_{\\theta} h$. Starting from static mechanical equilibrium and curvature-based force balance for a thin curved membrane, derive an expression for the internal pressure $P$ in terms of $T$ and the principal curvatures for the spherical case, then compute $P$ using the following patient-specific values: $R = 25\\ \\mathrm{mm}$, $h = 10\\ \\mathrm{mm}$, and $\\sigma_{\\theta} = 20\\ \\mathrm{kPa}$. Express the final pressure in kilopascals and round your answer to four significant figures. Briefly justify the modeling assumptions and, in your derivation and reasoning, identify key limitations of the thin-wall approximation when compared to thick-wall models for cardiac mechanics. Do not provide qualitative commentary in the final answer; the final answer must be the single computed value.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **System:** A patient-specific cardiac digital twin of the left ventricle (LV).\n- **Geometry:** At peak systole, the endocardial surface is modeled as a sphere.\n- **Principal Radii of Curvature:** Both are equal to $R$.\n- **Wall Thickness:** $h$.\n- **Midwall Circumferential Cauchy Stress:** $\\sigma_{\\theta}$.\n- **Approximation:** The LV wall is treated as a thin membrane.\n- **In-surface Isotropic Tension:** $T \\approx \\sigma_{\\theta} h$.\n- **Governing Principle:** Static mechanical equilibrium and curvature-based force balance for a thin curved membrane.\n- **Patient-Specific Values:**\n  - $R = 25\\ \\mathrm{mm}$\n  - $h = 10\\ \\mathrm{mm}$\n  - $\\sigma_{\\theta} = 20\\ \\mathrm{kPa}$\n- **Objective:**\n  1. Derive an expression for the internal pressure $P$ in terms of $T$ and principal curvatures.\n  2. Compute $P$ using the given values.\n- **Output Format:** Express the final pressure in kilopascals, rounded to four significant figures.\n- **Additional Requirement:** Justify modeling assumptions and identify limitations of the thin-wall approximation.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is based on the Young-Laplace equation, a fundamental principle of mechanics used to describe the pressure difference across a curved interface or membrane. Its application to a simplified model of the left ventricle is a standard and well-established approach in biomechanics. The variables and their relationships are physically meaningful.\n- **Well-Posedness:** The problem provides all necessary parameters ($R$, $h$, $\\sigma_{\\theta}$), a constitutive relation ($T \\approx \\sigma_{\\theta} h$), and a clear physical law to apply. It leads to a unique solution.\n- **Objectivity:** The problem is stated in precise, objective language without subjective claims.\n- **Analysis of Potential Flaws:** The problem instructs the use of a thin-wall approximation. The provided data give a thickness-to-radius ratio of $h/R = 10\\ \\mathrm{mm} / 25\\ \\mathrm{mm} = 0.4$. This value is significantly larger than the typical threshold for thin-wall validity (e.g., $h/R < 0.1$). However, the problem explicitly requires identifying the limitations of this approximation. This is a standard pedagogical method: applying a simplified model to a regime where it is not strictly valid to highlight its limitations. Therefore, this does not render the problem invalid but rather makes the critique of the model a central part of the task.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\nThe physics of a thin, curved membrane in static equilibrium under a pressure differential is described by the Young-Laplace equation. This equation establishes a balance between the outward force due to the internal pressure $P$ and the inward-pulling force resulting from the membrane tension $T$ acting along a curved surface. For a general curved surface with two principal curvatures, $\\kappa_1$ and $\\kappa_2$, the equation is:\n$$\nP = T (\\kappa_1 + \\kappa_2)\n$$\nThis assumes the tension $T$ is isotropic, meaning it is the same in all directions within the membrane surface, which is consistent with the problem's setup.\n\nThe problem states that the left ventricle's endocardial surface is modeled as a sphere of radius $R$. For a sphere, the surface is uniformly curved in all directions. The two principal curvatures are identical and equal to the reciprocal of the sphere's radius:\n$$\n\\kappa_1 = \\kappa_2 = \\frac{1}{R}\n$$\nSubstituting these curvatures into the general Young-Laplace equation gives the specific form for a spherical membrane:\n$$\nP = T \\left(\\frac{1}{R} + \\frac{1}{R}\\right) = \\frac{2T}{R}\n$$\nThis is the required expression for the pressure $P$ in terms of the tension $T$ and the principal curvatures (implicitly via $R$).\n\nThe problem provides an approximation relating the 2D membrane tension $T$ to the 3D wall stress. The tension $T$ (force per unit length) is approximated by the midwall circumferential Cauchy stress $\\sigma_{\\theta}$ (force per unit area) multiplied by the wall thickness $h$:\n$$\nT \\approx \\sigma_{\\theta} h\n$$\nThis approximation is the link between the continuum mechanics of a thick wall and the simplified mechanics of an idealized membrane.\n\nSubstituting this expression for $T$ into the spherical Laplace equation yields the final formula for the pressure $P$ in terms of the given model parameters:\n$$\nP \\approx \\frac{2(\\sigma_{\\theta} h)}{R}\n$$\nWe can now proceed with the numerical calculation using the patient-specific values:\n- $R = 25\\ \\mathrm{mm}$\n- $h = 10\\ \\mathrm{mm}$\n- $\\sigma_{\\theta} = 20\\ \\mathrm{kPa}$\n\nThe units of length ($\\mathrm{mm}$ for $h$ and $R$) will cancel, leaving the pressure $P$ in the same units as the stress $\\sigma_{\\theta}$, which is kilopascals ($\\mathrm{kPa}$).\n$$\nP = \\frac{2 \\times (20\\ \\mathrm{kPa}) \\times (10\\ \\mathrm{mm})}{25\\ \\mathrm{mm}} = \\frac{400}{25}\\ \\mathrm{kPa} = 16\\ \\mathrm{kPa}\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is exactly $16$, which can be written as $16.00$.\n\nA critical aspect of this problem is the justification and critique of the thin-wall approximation.\n\n**Justification of Modeling Assumptions:**\nThe simplification of the LV to a thin spherical shell is a first-order model that provides a direct algebraic link between pressure, geometry, and wall stress. It is computationally inexpensive and offers basic insight into cardiac function, for example, how pressure generation relates to wall thickening and changes in radius during the cardiac cycle. The assumption that transmural stress gradients are \"modest\" provides a rationale for using a single midwall stress value, $\\sigma_{\\theta}$, as representative of the entire wall thickness, which is a prerequisite for the approximation $T \\approx \\sigma_{\\theta} h$.\n\n**Limitations of the Thin-Wall Approximation:**\nIn reality, the heart wall is a thick structure. The primary limitations of the thin-wall model, particularly in this case, stem from a violation of its underlying geometric assumption.\n1.  **Thickness-to-Radius Ratio:** The thin-wall assumption is valid when the wall thickness is much smaller than the radius of curvature ($h \\ll R$). A common engineering rule of thumb is $h/R < 0.1$. In this problem, $h/R = 10/25 = 0.4$, which is large. This indicates that the thin-wall model is being applied outside its range of accuracy, and its predictions should be viewed with caution.\n2.  **Transmural Stress Gradients:** A thick-walled structure under pressure experiences significant stress gradients. For a thick sphere, the circumferential stress $\\sigma_{\\theta}$ is maximum at the inner surface (endocardium) and minimum at the outer surface (epicardium). The thin-wall model, by using a single value for stress, completely neglects this variation. This is a major limitation, as the peak stress at the endocardium is often a critical factor in cardiac pathophysiology (e.g., subendocardial ischemia).\n3.  **Radial Stress:** Thick-wall theory correctly models the radial stress, $\\sigma_r$, which varies from $-P$ at the endocardium to near zero at the epicardium. The thin-wall assumption is equivalent to assuming that radial stress is negligible compared to circumferential stress ($\\sigma_r \\ll \\sigma_{\\theta}$), which is not true throughout the wall thickness.\n4.  **Geometric Simplification:** The model uses a single radius $R$. In a thick wall, the radius of curvature varies from the endocardium to the epicardium. Thick-wall models integrate through the thickness to account for this.\n\nIn summary, while the thin-wall model provides a simple and useful conceptual framework, a more accurate analysis of the LV would require a thick-wall model (e.g., based on Lame's equations for a thick sphere) that properly accounts for the large $h/R$ ratio and the resulting transmural stress distributions.",
            "answer": "$$\n\\boxed{16.00}\n$$"
        },
        {
            "introduction": "The most sophisticated digital twins capture the intricate coupling between different physical domains. This final practice delves into the important phenomenon of mechano-electric feedback, where the mechanical state of a cardiac cell influences its electrical behavior . By augmenting a cell model with a stretch-activated current, you will investigate how mechanical load can alter the action potential duration, providing a hands-on introduction to multi-physics modeling.",
            "id": "3917266",
            "problem": "A single-cell patient-specific cardiac digital twin models mechano-electric feedback by including a stretch-activated current in the membrane equation. Consider a paced excitable membrane described by the current balance and a phenomenological recovery variable based on fundamental charge conservation. The starting point is the membrane equation expressing conservation of charge on a capacitor: $$C_m \\frac{dV}{dt} = -\\left(I_{\\text{ion}}(V,w) + I_{\\text{SAC}}(V,\\lambda)\\right) + I_{\\text{stim}}(t),$$ where $C_m$ is membrane capacitance, $V$ is transmembrane potential, $w$ is a recovery variable capturing slow ionic processes, $I_{\\text{ion}}$ represents the net ionic current of the excitable membrane, $I_{\\text{SAC}}$ is the stretch-activated current, $I_{\\text{stim}}(t)$ is an external pacing stimulus, and $\\lambda$ is a dimensionless preload (stretch ratio). Use the following well-tested excitable membrane equations to instantiate $I_{\\text{ion}}$ and the recovery dynamics (a two-variable FitzHugh–Nagumo-type model tuned to cardiac excitability): \n$$\\frac{dV}{dt} = \\frac{1}{C_m}\\left(V - \\frac{V^3}{3} - w + I_{\\text{stim}}(t) - I_{\\text{SAC}}(V,\\lambda)\\right),$$\n$$\\frac{dw}{dt} = \\frac{1}{\\tau}\\left(V + a - b\\,w\\right),$$\nwith parameters $a$, $b$, $\\tau$, $C_m$ chosen to yield physiologically plausible action potential durations. Model the stretch-activated current as a nonselective cation current with Ohmic conductance gated by preload:\n$$I_{\\text{SAC}}(V,\\lambda) = g_{\\text{SAC}}(\\lambda)\\,\\left(V - E_{\\text{SAC}}\\right),\\quad g_{\\text{SAC}}(\\lambda) = g_{\\max}\\,\\min\\left(1,\\max\\left(0,\\frac{\\lambda - 1}{\\Delta}\\right)\\right),$$\nwhere $E_{\\text{SAC}}$ is the reversal potential of the stretch-activated channel, $g_{\\max}$ is the maximum conductance at high stretch, and $\\Delta$ sets the stretch sensitivity window. The external stimulus is a periodic square pulse of amplitude $I_0$ and duration $d$ delivered every basic cycle length $\\text{CL}$:\n$$I_{\\text{stim}}(t) = \\begin{cases}\nI_0, & \\text{if } (t \\bmod \\text{CL}) \\in [0,d),\\\\\n0, & \\text{otherwise}.\n\\end{cases}$$\nDefine action potential duration (APD) for a beat as the time interval during which $V$ exceeds a threshold $V_{\\text{th}}$ between the upstroke crossing and the subsequent downstroke crossing within that beat. For a paced steady state, define diastolic interval (DI) by $DI = \\text{CL} - \\text{APD}$. Mechano-electric feedback via $I_{\\text{SAC}}$ under increased preload $\\lambda > 1$ is expected to alter $\\text{APD}$ and therefore shift the $\\text{APD}$ restitution curve.\n\nImplement a program that, for each test case, simulates repeated pacing until steady state and then computes the steady-state $\\text{APD}$ under baseline preload $\\lambda_{\\text{base}} = 1$ (no stretch activation) and under increased preload $\\lambda_{\\text{inc}} > 1$ (with stretch activation). Quantify the restitution shift at the given basic cycle length by the scalar difference:\n$$\\Delta \\text{APD} = \\text{APD}(\\lambda_{\\text{inc}}) - \\text{APD}(\\lambda_{\\text{base}}),$$\nexpressed in milliseconds (ms), rounded to three decimal places.\n\nUse the following scientifically plausible parameter values in all simulations unless otherwise specified: $C_m = 1$ (dimensionless scaling), $a = 0.7$, $b = 0.8$, $\\tau = 12$, $E_{\\text{SAC}} = 1.0$ (dimensionless membrane potential corresponding to a depolarizing reversal relative to the plateau in this scaled model), $g_{\\max} = 0.02$, $\\Delta = 0.1$, $I_0 = 0.8$, $d = 1\\,\\mathrm{ms}$, $V_{\\text{th}} = 0.0$. Use a fixed-step numerical integrator with time step $dt = 0.05\\,\\mathrm{ms}$. Simulate $N = 40$ beats, and compute the $\\text{APD}$ of the last captured beat. If a paced beat fails to capture (no threshold crossing), assign $\\text{APD} = 0$ for that beat.\n\nThe test suite you must implement consists of the following input parameter sets $(\\text{CL}, \\lambda_{\\text{inc}})$, with $\\text{CL}$ in milliseconds and $\\lambda_{\\text{inc}}$ dimensionless:\n- Case $1$ (happy path): $(\\text{CL} = 600\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.08)$.\n- Case $2$ (rate-dependent): $(\\text{CL} = 400\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.08)$.\n- Case $3$ (near refractory boundary): $(\\text{CL} = 200\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.08)$.\n- Case $4$ (no preload change control): $(\\text{CL} = 500\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.00)$.\n- Case $5$ (stronger preload): $(\\text{CL} = 300\\,\\mathrm{ms}, \\lambda_{\\text{inc}} = 1.12)$.\n\nFor each case, compute $\\Delta \\text{APD}$ in $\\mathrm{ms}$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases given (e.g., $[\\Delta \\text{APD}_1,\\Delta \\text{APD}_2,\\Delta \\text{APD}_3,\\Delta \\text{APD}_4,\\Delta \\text{APD}_5]$), with each entry rounded to three decimal places and expressed in $\\mathrm{ms}$ as a decimal number.",
            "solution": "The problem is valid as it presents a scientifically grounded, well-posed, and objective task in computational cardiac electrophysiology. It provides a complete set of model equations, parameters, and simulation protocols, allowing for a unique and verifiable solution.\n\nThe problem requires the simulation of a patient-specific single-cell cardiac model to quantify the effect of mechano-electric feedback on action potential duration (APD). The model is a FitzHugh-Nagumo-type system, which describes the evolution of the transmembrane potential $V$ and a recovery variable $w$. The system is augmented with a stretch-activated current $I_{\\text{SAC}}$, which models the mechanical influence (preload $\\lambda$) on the cell's electrical activity.\n\nThe governing ordinary differential equations (ODEs) are:\n$$\n\\frac{dV}{dt} = \\frac{1}{C_m}\\left(V - \\frac{V^3}{3} - w + I_{\\text{stim}}(t) - I_{\\text{SAC}}(V,\\lambda)\\right)\n$$\n$$\n\\frac{dw}{dt} = \\frac{1}{\\tau}\\left(V + a - b\\,w\\right)\n$$\n\nThe stretch-activated current $I_{\\text{SAC}}$ and its conductance $g_{\\text{SAC}}$ are defined as:\n$$\nI_{\\text{SAC}}(V,\\lambda) = g_{\\text{SAC}}(\\lambda)\\,\\left(V - E_{\\text{SAC}}\\right)\n$$\n$$\ng_{\\text{SAC}}(\\lambda) = g_{\\max}\\,\\min\\left(1,\\max\\left(0,\\frac{\\lambda - 1}{\\Delta}\\right)\\right)\n$$\nThis formulation indicates that the stretch-activated current is zero for no preload ($\\lambda \\le 1$) and increases linearly with stretch $\\lambda$ in the range $[1, 1+\\Delta]$, saturating at a maximum conductance $g_{\\max}$ for $\\lambda > 1+\\Delta$. The current is inward (depolarizing) when $V < E_{\\text{SAC}}$ and outward (repolarizing) when $V > E_{\\text{SAC}}$. Given that $E_{\\text{SAC}} = 1.0$ is near the typical action potential plateau voltage in this model, $I_{\\text{SAC}}$ is expected to be primarily an inward current during repolarization, thereby prolonging the APD.\n\nThe external stimulus $I_{\\text{stim}}(t)$ is a train of square pulses with amplitude $I_0$, duration $d$, and period equal to the basic cycle length $\\text{CL}$.\n\nTo solve this system, we employ a numerical integration scheme. As specified, a fixed-step forward Euler method with a time step of $dt = 0.05\\,\\mathrm{ms}$ is used. For a state $(V_n, w_n)$ at time $t_n$, the state at the next time step $t_{n+1} = t_n + dt$ is approximated as:\n$$\nV_{n+1} = V_n + dt \\cdot \\frac{1}{C_m}\\left(V_n - \\frac{V_n^3}{3} - w_n + I_{\\text{stim}}(t_n) - g_{\\text{SAC}}(\\lambda)\\left(V_n - E_{\\text{SAC}}\\right)\\right)\n$$\n$$\nw_{n+1} = w_n + dt \\cdot \\frac{1}{\\tau}\\left(V_n + a - b\\,w_n\\right)\n$$\nThe simulation is initialized with $(V, w) = (0, 0)$ and run for $N=40$ beats to ensure the system reaches a periodic steady state, where the dynamics of each beat are nearly identical.\n\nThe Action Potential Duration (APD) is calculated for the final ($40$-th) beat. It is defined as the time interval during which the membrane potential $V$ exceeds the threshold $V_{\\text{th}} = 0.0$. We identify the time of the upstroke ($t_{\\text{up}}$), when $V$ first crosses $V_{\\text{th}}$ from below, and the time of the subsequent downstroke ($t_{\\text{down}}$), when $V$ crosses $V_{\\text{th}}$ from above. The APD is then $t_{\\text{down}} - t_{\\text{up}}$. If no upstroke occurs, indicating a failed stimulation (no capture), the APD is assigned a value of $0$.\n\nFor each test case, specified by $(\\text{CL}, \\lambda_{\\text{inc}})$, the following procedure is executed:\n1.  A simulation is performed with the baseline preload $\\lambda = \\lambda_{\\text{base}} = 1.0$. At this preload, $g_{\\text{SAC}}(\\lambda_{\\text{base}})$ is zero, so $I_{\\text{SAC}} = 0$. The APD of the final beat is computed, yielding $\\text{APD}(\\lambda_{\\text{base}})$.\n2.  A second simulation is performed with the increased preload $\\lambda = \\lambda_{\\text{inc}}$. The APD of the final beat is computed, yielding $\\text{APD}(\\lambda_{\\text{inc}})$.\n3.  The change in APD, $\\Delta \\text{APD}$, is calculated as the difference: $\\Delta \\text{APD} = \\text{APD}(\\lambda_{\\text{inc}}) - \\text{APD}(\\lambda_{\\text{base}})$.\n4.  The result is rounded to three decimal places as required.\n\nThis entire process is repeated for all five test cases provided. The code implements this logic in a structured manner, with a dedicated function to perform the simulation and extract the APD for a given set of parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the change in Action Potential Duration (APD) due to\n    mechano-electric feedback for several pacing and preload conditions.\n    \"\"\"\n\n    # Define model and simulation parameters from the problem statement.\n    params = {\n        'Cm': 1.0,         # Membrane capacitance (dimensionless)\n        'a': 0.7,          # FHN model parameter\n        'b': 0.8,          # FHN model parameter\n        'tau': 12.0,       # Recovery variable time constant (ms)\n        'E_SAC': 1.0,      # Reversal potential for SAC (dimensionless V)\n        'g_max': 0.02,     # Max conductance for SAC (dimensionless)\n        'Delta': 0.1,      # Stretch sensitivity window for SAC\n        'I0': 0.8,         # Stimulus amplitude (dimensionless)\n        'd': 1.0,          # Stimulus duration (ms)\n        'V_th': 0.0,       # APD threshold (dimensionless V)\n        'dt': 0.05,        # Time step for numerical integration (ms)\n        'N': 40,           # Number of beats to simulate\n        'lambda_base': 1.0 # Baseline preload (no stretch)\n    }\n\n    # Define the test cases (CL in ms, lambda_inc dimensionless).\n    test_cases = [\n        (600.0, 1.08),  # Case 1: happy path\n        (400.0, 1.08),  # Case 2: rate-dependent\n        (200.0, 1.08),  # Case 3: near refractory boundary\n        (500.0, 1.00),  # Case 4: no preload change control\n        (300.0, 1.12),  # Case 5: stronger preload\n    ]\n\n    results = []\n    for case in test_cases:\n        CL, lambda_inc = case\n\n        # Calculate APD for baseline preload.\n        apd_base = simulate_and_get_apd(CL, params['lambda_base'], params)\n        \n        # Calculate APD for increased preload.\n        apd_inc = simulate_and_get_apd(CL, lambda_inc, params)\n\n        # Calculate the difference in APD.\n        delta_apd = apd_inc - apd_base\n        results.append(round(delta_apd, 3))\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef simulate_and_get_apd(CL, lambda_val, params):\n    \"\"\"\n    Simulates the cardiac cell model for a given cycle length (CL) and\n    preload (lambda_val), and computes the APD of the last beat.\n\n    Args:\n        CL (float): Basic Cycle Length in ms.\n        lambda_val (float): Preload value (dimensionless).\n        params (dict): Dictionary of model and simulation parameters.\n\n    Returns:\n        float: The calculated Action Potential Duration (APD) in ms.\n    \"\"\"\n    # Unpack parameters for convenience.\n    Cm, a, b, tau = params['Cm'], params['a'], params['b'], params['tau']\n    g_max, Delta, E_SAC = params['g_max'], params['Delta'], params['E_SAC']\n    I0, d, V_th = params['I0'], params['d'], params['V_th']\n    dt, N = params['dt'], params['N']\n\n    # Calculate stretch-activated conductance g_SAC.\n    g_sac_factor = (lambda_val - 1.0) / Delta\n    g_sac = g_max * min(1.0, max(0.0, g_sac_factor))\n\n    # Simulation setup.\n    total_time = N * CL\n    num_steps = int(round(total_time / dt))\n    last_beat_start_step = int(round((N - 1) * CL / dt))\n    \n    # Initial conditions for V and w.\n    V, w = 0.0, 0.0\n    \n    v_trace_last_beat = []\n\n    # Main simulation loop using forward Euler integration.\n    for i in range(num_steps):\n        t = i * dt\n        \n        # Determine stimulus current.\n        I_stim = I0 if (t % CL) < d else 0.0\n        \n        # Calculate stretch-activated current.\n        I_sac = g_sac * (V - E_SAC)\n        \n        # FitzHugh-Nagumo ODEs.\n        dV_dt = (1.0 / Cm) * (V - (V**3) / 3.0 - w + I_stim - I_sac)\n        dw_dt = (1.0 / tau) * (V + a - b * w)\n        \n        # Update state variables.\n        V += dt * dV_dt\n        w += dt * dw_dt\n        \n        # Store voltage trace for the last beat.\n        if i >= last_beat_start_step:\n            v_trace_last_beat.append(V)\n\n    # Calculate APD from the stored trace of the last beat.\n    upstroke_idx, downstroke_idx = -1, -1\n    \n    # Find the first upstroke.\n    for i in range(1, len(v_trace_last_beat)):\n        if v_trace_last_beat[i-1] < V_th and v_trace_last_beat[i] >= V_th:\n            if upstroke_idx == -1:\n                upstroke_idx = i\n                break\n\n    # If an upstroke was found, find the subsequent downstroke.\n    if upstroke_idx != -1:\n        for i in range(upstroke_idx + 1, len(v_trace_last_beat)):\n            if v_trace_last_beat[i-1] >= V_th and v_trace_last_beat[i] < V_th:\n                downstroke_idx = i\n                break\n    \n    # Compute APD. If capture failed, APD is 0.\n    if upstroke_idx == -1 or downstroke_idx == -1:\n        return 0.0\n    else:\n        apd = (downstroke_idx - upstroke_idx) * dt\n        return apd\n\nsolve()\n```"
        }
    ]
}