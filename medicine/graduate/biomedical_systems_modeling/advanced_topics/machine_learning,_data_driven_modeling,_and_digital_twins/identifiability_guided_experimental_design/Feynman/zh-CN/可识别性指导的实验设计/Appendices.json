{
    "hands_on_practices": [
        {
            "introduction": "在设计一个能提供信息的实验之前，我们必须首先确保模型参数在理论上是可辨识的。本练习从一个简单的线性单室模型入手，介绍了结构不可辨识性的核心概念，揭示了模型方程中隐藏的对称性如何阻碍我们区分单个参数。通过解决这个问题 ，您将学会如何通过重新参数化来发现并解决这些根本性的辨识性问题，为后续的实验设计奠定坚实的基础。",
            "id": "3892821",
            "problem": "考虑一个单室生物医学系统，该系统由已知输入驱动，并通过其状态进行观测。系统动力学由常微分方程 $\\dot{x}(t) = -\\alpha \\beta \\, x(t) + u(t)$ 给出，输出为 $y(t) = x(t)$，其中 $x(t)$ 表示一个可测量的状态（例如，生物标志物浓度），$u(t)$ 是一个已知的可控输入（例如，输注速率），$\\alpha$ 和 $\\beta$ 是表征动力学的未知正常数。假设初始条件为 $x(0) = 0$，且实验者可以选择 $u(t)$。\n\n从结构可辨识性（在无噪声条件下，从理想输入输出数据到参数映射的唯一性）的标准定义和参数空间中的不变性变换概念出发，完成以下任务：\n\n1. 使用输入输出不变性的第一性原理，证明参数空间中存在一个连续对称性，使得所引起的变换在所有容许输入 $u(t)$ 和初始条件下都使输入输出行为保持不变。确定该类变换及其在参数空间中的无穷小生成元。\n\n2. 构建一个可辨识的重参数化 $\\gamma$，以消除由对称性引起的不可辨识方向，并用 $\\gamma$ 重写模型。\n\n3. 提出一个可辨识性引导的实验设计，选择一个恒定输入 $u(t) = U$（对于 $t \\geq 0$），并利用重参数化模型的解来证明参数 $\\gamma$ 可以通过对输出 $y(t)$ 的单次稳态测量来辨识。推导 $\\gamma$ 关于输入幅值 $U$ 和测量的稳态输出 $x_{\\infty} = \\lim_{t \\to \\infty} x(t)$ 的闭式表达式。\n\n以 $\\gamma$ 关于 $U$ 和 $x_{\\infty}$ 的符号表达式形式给出最终答案。将参数的单位表示为倒数秒 (s$^{-1}$)。不需要数值近似。",
            "solution": "首先验证问题，以确保其科学上合理、内容完整且提法恰当。\n\n**步骤1：提取已知条件**\n- 系统动力学：$\\dot{x}(t) = -\\alpha \\beta \\, x(t) + u(t)$\n- 输出：$y(t) = x(t)$\n- 状态：$x(t)$，可测量\n- 输入：$u(t)$，已知且可控\n- 参数：$\\alpha > 0$, $\\beta > 0$，均为未知\n- 初始条件：$x(0) = 0$\n- 第3部分的实验条件：恒定输入 $u(t) = U$（对于 $t \\geq 0$）\n- 第3部分的测量：稳态输出 $x_{\\infty} = \\lim_{t \\to \\infty} x(t)$\n\n**步骤2：使用提取的已知条件进行验证**\n该问题描述了一个单室线性时不变（LTI）系统，这是生物医学工程和药代动力学中一个基础且广泛使用的模型。结构可辨识性、不变性变换和无穷小生成元的概念是分析此类系统的标准、严谨的数学工具。任务定义清晰，逻辑上顺序递进，不包含矛盾或缺失的信息。该问题具有科学依据，提法恰当且客观。\n\n**步骤3：结论与行动**\n问题有效。下面提供完整解答。\n\n**第1部分：不变性变换与无穷小生成元**\n\n结构可辨识性关注的是在给定模型结构和理想输入输出数据下参数的唯一性。缺乏结构可辨识性意味着存在不同的参数集，它们对所有容许输入产生相同的输入输出行为。这可以通过寻找参数空间中使模型输出保持不变的变换来形式化。\n\n系统由输入输出方程描述：\n$$\n\\dot{y}(t) = -\\alpha \\beta \\, y(t) + u(t)\n$$\n初始条件为 $y(0) = 0$，因为 $y(t) = x(t)$。\n\n令 $\\mathbf{p} = (\\alpha, \\beta)$ 为参数向量。我们寻找一个变换 $\\mathbf{p} \\to \\mathbf{p}' = (\\alpha', \\beta')$，使得输入输出关系得以保持。这意味着对于相同的输入 $u(t)$ 和初始条件，两组参数 $\\mathbf{p}$ 和 $\\mathbf{p}'$ 的输出 $y(t)$ 必须相同。为了使微分方程保持不变，其系数必须相同。\n$$\n-\\alpha \\beta \\, y(t) = -\\alpha' \\beta' \\, y(t)\n$$\n这必须对任何轨迹 $y(t)$ 都成立，因此要求系数相等：\n$$\n\\alpha \\beta = \\alpha' \\beta'\n$$\n这个方程定义了不变性。任何保持乘积 $\\alpha \\beta$ 不变的变换都将使系统的输入输出行为保持不变。我们可以定义一个由标量 $s \\in \\mathbb{R}^+$ 参数化的单参数连续变换群，如下所示：\n$$\n\\alpha' = s \\alpha\n$$\n$$\n\\beta' = \\frac{1}{s} \\beta\n$$\n在此变换下，乘积是不变的：$\\alpha' \\beta' = (s\\alpha)(\\frac{1}{s}\\beta) = \\alpha\\beta$。这证明了参数空间中存在一个连续对称性。\n\n该变换群的无穷小生成元是参数空间中的一个向量场，它指向单位元（$s=1$ 处）变换的方向。它通过计算变换对群参数 $s$ 的导数，并在 $s=1$ 处求值得到。\n设变换为 $\\Phi_s(\\alpha, \\beta) = (s\\alpha, s^{-1}\\beta)$。生成元 $V$ 为：\n$$\nV = \\left. \\frac{d}{ds} \\Phi_s(\\alpha, \\beta) \\right|_{s=1} = \\left. \\frac{d}{ds} \\left( s\\alpha, \\frac{1}{s}\\beta \\right) \\right|_{s=1}\n$$\n向量场的分量为：\n$$\nV_\\alpha = \\left. \\frac{d}{ds}(s\\alpha) \\right|_{s=1} = \\alpha\n$$\n$$\nV_\\beta = \\left. \\frac{d}{ds}\\left(\\frac{1}{s}\\beta\\right) \\right|_{s=1} = \\left. -\\frac{1}{s^2}\\beta \\right|_{s=1} = -\\beta\n$$\n因此，无穷小生成元是向量场 $V = (\\alpha, -\\beta)$。用算子形式表示为 $V = \\alpha \\frac{\\partial}{\\partial\\alpha} - \\beta \\frac{\\partial}{\\partial\\beta}$。该生成元定义了参数空间中的一个方向，沿此方向改变参数不会改变可观测的输出，这正是结构不可辨识性的根源。\n\n**第2部分：可辨识的重参数化**\n\n第1部分的分析表明，我们无法独立确定 $\\alpha$ 和 $\\beta$。我们只能确定在已识别的对称变换下保持不变的量。一个不变量 $I(\\alpha, \\beta)$ 是指其沿着生成元的方向导数为零的量，即 $V(I) = 0$。\n我们来检验乘积 $\\alpha\\beta$：\n$$\nV(\\alpha\\beta) = \\left(\\alpha \\frac{\\partial}{\\partial\\alpha} - \\beta \\frac{\\partial}{\\partial\\beta}\\right) (\\alpha\\beta) = \\alpha \\frac{\\partial(\\alpha\\beta)}{\\partial\\alpha} - \\beta \\frac{\\partial(\\alpha\\beta)}{\\partial\\beta} = \\alpha(\\beta) - \\beta(\\alpha) = 0\n$$\n由于李导数为零，乘积 $\\alpha\\beta$ 是该对称群的一个不变量。这是模型方程中出现的 $\\alpha$ 和 $\\beta$ 的唯一组合，也是可以从输入输出数据中唯一辨识的量。\n\n因此，我们可以通过将新参数 $\\gamma$ 定义为此不变量组合来构建一个可辨识的重参数化：\n$$\n\\gamma = \\alpha \\beta\n$$\n将此代入原始模型方程，得到重参数化模型：\n$$\n\\dot{x}(t) = -\\gamma x(t) + u(t)\n$$\n其中 $y(t) = x(t)$ 且 $x(0)=0$。该模型现在只有一个参数 $\\gamma$。为确认其可辨识性，假设两个不同的参数值 $\\gamma_1$ 和 $\\gamma_2$ 对所有输入 $u(t)$ 产生相同的输出 $y(t)$。那么我们必然有：\n$$\n-\\gamma_1 y(t) + u(t) = -\\gamma_2 y(t) + u(t) \\implies (\\gamma_2 - \\gamma_1) y(t) = 0\n$$\n由于这对任何容许输入 $u(t)$ 都必须成立，我们可以选择一个能产生非平凡输出 $y(t) \\neq 0$ 的输入。这就迫使 $\\gamma_2 - \\gamma_1 = 0$，即 $\\gamma_1 = \\gamma_2$。因此，$\\gamma$ 是结构可辨识的。\n\n**第3部分：可辨识性引导的实验设计**\n\n问题要求设计一个实验来确定 $\\gamma$。我们采纳建议，使用一个恒定输入 $u(t) = U$（对于 $t \\geq 0$），其中 $U$ 是一个已知常数。重参数化模型变为：\n$$\n\\dot{x}(t) = -\\gamma x(t) + U\n$$\n这是一个一阶线性常微分方程。我们可以使用积分因子法或通过寻找齐次解和特解来求解它。通解的形式为 $x(t) = x_h(t) + x_p(t)$。齐次方程 $\\dot{x}_h(t) + \\gamma x_h(t) = 0$ 的解是 $x_h(t) = C e^{-\\gamma t}$。对于特解，我们可以假设一个常数解 $x_p(t) = K$，代入方程得到 $0 = -\\gamma K + U$，所以 $K = U/\\gamma$。\n完整解为：\n$$\nx(t) = C e^{-\\gamma t} + \\frac{U}{\\gamma}\n$$\n使用初始条件 $x(0)=0$：\n$$\n0 = C e^0 + \\frac{U}{\\gamma} \\implies C = -\\frac{U}{\\gamma}\n$$\n将 $C$ 代回解中，得到状态轨迹：\n$$\nx(t) = \\frac{U}{\\gamma} (1 - e^{-\\gamma t})\n$$\n问题建议测量输出的稳态值 $x_{\\infty}$。我们可以通过取 $t \\to \\infty$ 的极限来计算它。因为 $\\alpha > 0$ 且 $\\beta > 0$，所以有 $\\gamma = \\alpha\\beta > 0$。因此，指数项衰减至零：\n$$\nx_{\\infty} = \\lim_{t \\to \\infty} x(t) = \\lim_{t \\to \\infty} \\frac{U}{\\gamma} (1 - e^{-\\gamma t}) = \\frac{U}{\\gamma} (1 - 0) = \\frac{U}{\\gamma}\n$$\n这个简单的代数关系 $x_{\\infty} = \\frac{U}{\\gamma}$，将可辨识参数 $\\gamma$ 与已知的输入幅值 $U$ 和可测量的稳态输出 $x_{\\infty}$ 联系起来。这证明了所提出的实验设计的合理性：施加一个恒定输入并测量所产生的稳态浓度，足以确定该系统唯一的可辨识参数。\n\n为了找到 $\\gamma$ 的表达式，我们只需重新整理方程：\n$$\n\\gamma = \\frac{U}{x_{\\infty}}\n$$\n这提供了 $\\gamma$ 关于实验控制量和测量量的闭式表达式。关于单位，如果 $x$ 是浓度（例如 mol/L），$u$ 是浓度变化率（例如 mol/L/s），那么从方程 $\\dot{x} = -\\gamma x + u$ 进行量纲分析可知，$\\gamma$ 的单位必须是时间的倒数（例如 s$^{-1}$）。这与推导出的表达式 $\\gamma = U/x_{\\infty}$ 一致，其单位为 $(\\text{浓度}/\\text{时间}) / \\text{浓度} = 1/\\text{时间}$。",
            "answer": "$$\n\\boxed{\\frac{U}{x_{\\infty}}}\n$$"
        },
        {
            "introduction": "即使一个模型在结构上是可辨识的，现实世界中的测量噪声仍可能使参数估计变得困难，尤其是当参数之间存在相关性时。本练习  引入了Fisher信息矩阵（FIM）这一强大工具，用以量化参数估计的不确定性，并帮助我们理解参数相关性如何在似然函数景观中形成难以区分的“山脊”。通过为一个经典的指数衰减模型计算渐近相关系数，您将获得一个衡量这种实际可辨识性挑战的具体指标。",
            "id": "3892885",
            "problem": "考虑一个血浆中生物标志物浓度的单室静脉推注模型，其中在时间 $t$ 测得的浓度由参数函数 $y(t;\\theta) = A \\exp(-k t)$ 描述，参数为 $\\theta = (A,k)$。假设测量噪声是独立同分布的高斯噪声，其方差为 $\\sigma^{2}$，因此，对于 $N$ 个测量值 $\\{(t_{i},y_{i})\\}_{i=1}^{N}$，其负对数似然函数为\n$$\n\\ell(\\theta) = \\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{N} \\left(y_{i} - A \\exp(-k t_{i})\\right)^{2} + \\text{constant}.\n$$\n令 $\\hat{\\theta} = (\\hat{A},\\hat{k})$ 为最大似然估计（MLE），其中 $\\hat{A} > 0$。在大样本情况下并满足正则性条件时，$\\ell(\\theta)$ 在 $\\hat{\\theta}$ 处的Hessian矩阵可以很好地由Fisher信息矩阵（FIM）近似，记作 $F(\\hat{\\theta})$，其元素由下式给出\n$$\nF_{mn}(\\hat{\\theta}) = \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{N} \\frac{\\partial y(t_{i};\\theta)}{\\partial \\theta_{m}} \\bigg|_{\\theta=\\hat{\\theta}} \\cdot \\frac{\\partial y(t_{i};\\theta)}{\\partial \\theta_{n}} \\bigg|_{\\theta=\\hat{\\theta}}.\n$$\n从这些定义出发，仅使用指数函数和矩阵代数的基本性质，分析参数之间的相关性如何通过 $F(\\hat{\\theta})$ 的特征结构在似然函数中表现为“脊”状。然后，计算由Fisher信息矩阵的逆 $F(\\hat{\\theta})^{-1}$ 所隐含的 $A$ 和 $k$ 之间的渐近相关系数，并将其表示为仅含 $\\{t_{i}\\}_{i=1}^{N}$ 和 $\\hat{k}$ 的单一闭式解析表达式。\n\n您的最终答案必须是 $F(\\hat{\\theta})^{-1}$ 所隐含的 $A$ 和 $k$ 之间相关系数 $\\rho_{A,k}$ 的单一闭式解析表达式。不需要进行数值计算。最终答案中不应包含任何单位。如果可能，请进行简化并给出简化后的形式。不要进行任何四舍五入；请提供精确表达式。",
            "solution": "用户希望我验证问题陈述，如果有效，则提供完整的解决方案。\n\n### 步骤1：提取给定信息\n-   **模型函数：** $y(t;\\theta) = A \\exp(-k t)$\n-   **参数：** $\\theta = (A,k)$\n-   **测量噪声：** 独立同分布的高斯噪声，方差为 $\\sigma^{2}$。\n-   **负对数似然函数：** $\\ell(\\theta) = \\frac{1}{2\\sigma^{2}} \\sum_{i=1}^{N} \\left(y_{i} - A \\exp(-k t_{i})\\right)^{2} + \\text{constant}$\n-   **最大似然估计（MLE）：** $\\hat{\\theta} = (\\hat{A},\\hat{k})$，条件为 $\\hat{A} > 0$。\n-   **Fisher信息矩阵（FIM）定义：** $F_{mn}(\\hat{\\theta}) = \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{N} \\frac{\\partial y(t_{i};\\theta)}{\\partial \\theta_{m}} \\bigg|_{\\theta=\\hat{\\theta}} \\cdot \\frac{\\partial y(t_{i};\\theta)}{\\partial \\theta_{n}} \\bigg|_{\\theta=\\hat{\\theta}}$\n-   **前提：** $\\ell(\\theta)$ 在 $\\hat{\\theta}$ 处的Hessian矩阵可由FIM $F(\\hat{\\theta})$ 很好地近似。\n-   **目标：**\n    1.  分析参数相关性如何通过 $F(\\hat{\\theta})$ 的特征结构在似然函数中表现为“脊”状。\n    2.  计算由Fisher信息矩阵的逆 $F(\\hat{\\theta})^{-1}$ 所隐含的 $A$ 和 $k$ 之间的渐近相关系数 $\\rho_{A,k}$。\n    3.  将 $\\rho_{A,k}$ 表示为仅含 $\\{t_{i}\\}_{i=1}^{N}$ 和 $\\hat{k}$ 的单一闭式解析表达式。\n\n### 步骤2：使用提取的信息进行验证\n根据指定标准对问题进行验证。\n-   **科学依据：** 该问题牢固地植根于标准的药代动力学建模和统计估计理论。单室指数衰减模型是药理学的基础。对高斯噪声使用负对数似然、Fisher信息矩阵，以及其与参数协方差矩阵的联系（通过Cramér-Rao下界），都是统计学和系统辨识中的既定原则。该问题在科学上是合理的。\n-   **适定性：** 问题陈述清晰，提供了推导唯一解析解所需的所有定义和背景。目标明确且可实现。\n-   **客观性：** 问题使用精确、无歧义的数学和统计语言表述，不含任何主观或基于观点的内容。\n\n该问题不存在任何列出的缺陷（例如，科学上不合理、不完整、有歧义）。这是生物医学系统建模特定领域内一个定义明确的理论问题。\n\n### 步骤3：结论与行动\n该问题是**有效的**。现在开始求解过程。\n\n该问题要求通过Fisher信息矩阵（FIM）分析参数相关性，并为给定模型推导具体的相关系数。\n\n首先，我们分析FIM、似然曲面和参数相关性之间的关系。FIM $F(\\hat{\\theta})$ 近似了负对数似然函数在最大似然估计点 $\\hat{\\theta}$ 处的Hessian矩阵。Hessian矩阵描述了该曲面的曲率。在大样本极限下，FIM的逆矩阵 $F(\\hat{\\theta})^{-1}$ 提供了参数估计协方差矩阵 $Cov(\\hat{\\theta})$ 的一个近似。\n\n负对数似然曲面在其最小值附近的二次近似的等值集是由 $(\\theta - \\hat{\\theta})^T F(\\hat{\\theta}) (\\theta - \\hat{\\theta}) = c$ 定义的椭球，其中 $c$ 是一个常数。$F(\\hat{\\theta})$ 的特征向量指向这些椭球的主轴方向，而相应的特征值与这些轴长的平方成反比。一个小的特征值表示一个长轴，这对应于似然景观中的一个“脊”或一个“浅谷”。沿着这个脊移动只会导致似然值的微小变化，这意味着沿此方向的许多不同参数组合对数据的拟合程度几乎相同。如果与这个小特征值对应的特征向量与任何参数轴都不对齐，则意味着可以在不显著降低拟合优度的前提下改变参数的特定组合，这就是高参数相关性的定义。归一化的FIM（或协方差矩阵）中一个大的非对角元素表明了这种不对齐，从而意味着高相关性。\n\n现在，我们着手计算给定模型的FIM。参数为 $\\theta_1 = A$ 和 $\\theta_2 = k$。模型为 $y(t_i; A, k) = A \\exp(-k t_i)$。我们必须首先计算 $y$ 对每个参数的偏导数，并在MLE $\\hat{\\theta} = (\\hat{A}, \\hat{k})$ 处求值。\n\n关于 $A$ 的偏导数是：\n$$\n\\frac{\\partial y(t_i; \\theta)}{\\partial A} \\bigg|_{\\theta=\\hat{\\theta}} = \\exp(-\\hat{k} t_i)\n$$\n\n关于 $k$ 的偏导数是：\n$$\n\\frac{\\partial y(t_i; \\theta)}{\\partial k} \\bigg|_{\\theta=\\hat{\\theta}} = - \\hat{A} t_i \\exp(-\\hat{k} t_i)\n$$\n\n使用FIM的定义，我们构造 $2 \\times 2$ 矩阵 $F(\\hat{\\theta})$。我们将其简记为 $F$。\n\n元素 $F_{11}$ (或 $F_{AA}$) 是：\n$$\nF_{11} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( \\frac{\\partial y_i}{\\partial A} \\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} (\\exp(-\\hat{k} t_i))^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\exp(-2 \\hat{k} t_i)\n$$\n\n非对角元素 $F_{12}$ 和 $F_{21}$ (或 $F_{Ak}$ 和 $F_{kA}$) 相等：\n$$\nF_{12} = F_{21} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( \\frac{\\partial y_i}{\\partial A} \\right) \\left( \\frac{\\partial y_i}{\\partial k} \\right) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( \\exp(-\\hat{k} t_i) \\right) \\left( - \\hat{A} t_i \\exp(-\\hat{k} t_i) \\right) = -\\frac{\\hat{A}}{\\sigma^2} \\sum_{i=1}^{N} t_i \\exp(-2 \\hat{k} t_i)\n$$\n\n元素 $F_{22}$ (或 $F_{kk}$) 是：\n$$\nF_{22} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( \\frac{\\partial y_i}{\\partial k} \\right)^2 = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( - \\hat{A} t_i \\exp(-\\hat{k} t_i) \\right)^2 = \\frac{\\hat{A}^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2 \\hat{k} t_i)\n$$\n\n为了简化表达式，我们定义以下和：\n$$\nS_0 = \\sum_{i=1}^{N} \\exp(-2 \\hat{k} t_i)\n$$\n$$\nS_1 = \\sum_{i=1}^{N} t_i \\exp(-2 \\hat{k} t_i)\n$$\n$$\nS_2 = \\sum_{i=1}^{N} t_i^2 \\exp(-2 \\hat{k} t_i)\n$$\n现在FIM可以写成：\n$$\nF = \\frac{1}{\\sigma^2} \\begin{pmatrix} S_0  & -\\hat{A} S_1 \\\\ -\\hat{A} S_1 & \\hat{A}^2 S_2 \\end{pmatrix}\n$$\n估计量 $\\hat{A}$ 和 $\\hat{k}$ 之间的渐近相关系数 $\\rho_{A,k}$ 由一个将其与一个双参数问题的FIM分量相关联的公式给出：\n$$\n\\rho_{A,k} = \\frac{-F_{12}}{\\sqrt{F_{11} F_{22}}}\n$$\n将我们计算出的FIM分量代入此公式：\n$$\n\\rho_{A,k} = \\frac{- \\left( -\\frac{\\hat{A}}{\\sigma^2} S_1 \\right)}{\\sqrt{\\left( \\frac{1}{\\sigma^2} S_0 \\right) \\left( \\frac{\\hat{A}^2}{\\sigma^2} S_2 \\right)}}\n$$\n$$\n\\rho_{A,k} = \\frac{\\frac{\\hat{A} S_1}{\\sigma^2}}{\\sqrt{\\frac{\\hat{A}^2 S_0 S_2}{\\sigma^4}}}\n$$\n$$\n\\rho_{A,k} = \\frac{\\frac{\\hat{A} S_1}{\\sigma^2}}{\\frac{\\hat{A} \\sqrt{S_0 S_2}}{\\sigma^2}}\n$$\n项 $\\hat{A}$ 和 $\\sigma^2$ 消去，得到：\n$$\n\\rho_{A,k} = \\frac{S_1}{\\sqrt{S_0 S_2}}\n$$\n最后，我们将 $S_0$、$S_1$ 和 $S_2$ 的定义代回此表达式，以获得以 $\\{t_i\\}_{i=1}^N$ 和 $\\hat{k}$ 表示的最终闭式解。\n$$\n\\rho_{A,k} = \\frac{\\sum_{i=1}^{N} t_i \\exp(-2 \\hat{k} t_i)}{\\sqrt{\\left( \\sum_{i=1}^{N} \\exp(-2 \\hat{k} t_i) \\right) \\left( \\sum_{i=1}^{N} t_i^2 \\exp(-2 \\hat{k} t_i) \\right)}}\n$$\n根据柯西-施瓦茨不等式，$(S_1)^2 \\le S_0 S_2$，这确保了 $|\\rho_{A,k}| \\le 1$，符合相关系数的要求。由于对于时程实验 $t_i > 0$，且对于衰减过程 $\\hat{k}$ 预计为正，因此和 $S_0, S_1, S_2$ 均为正值，故相关系数 $\\rho_{A,k}$ 为正。这意味着 $A$ 的估计值的增加往往伴随着 $k$ 的估计值的增加。",
            "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} t_i \\exp(-2 \\hat{k} t_i)}{\\sqrt{\\left(\\sum_{i=1}^{N} \\exp(-2 \\hat{k} t_i)\\right) \\left(\\sum_{i=1}^{N} t_i^{2} \\exp(-2 \\hat{k} t_i)\\right)}}}$$"
        },
        {
            "introduction": "本章的压轴练习将前面的理论知识付诸实践。在理解了结构可辨识性以及如何使用Fisher信息矩阵（FIM）量化实际可辨识性之后，我们现在可以主动运用这些知识来指导实验设计。这项计算任务  要求您实现一个基于FIM的最优设计策略，通过比较不同实验输入信号（例如阶跃、斜坡和正弦输入）对酶动力学参数估计信息量的影响，从而选出能够最大化D-最优性准则的实验方案。",
            "id": "3892890",
            "problem": "考虑一个用于描述底物动力学和测量的单态酶动力学模型，该模型由以下常微分方程和输出关系定义\n$$\\dot{S}(t) = -\\frac{V_{\\max} S(t)}{K_M + S(t)} + u(t), \\quad y(t) = S(t),$$\n其中 $S(t)$ 是底物浓度，$V_{\\max}$ 是最大反应速率，$K_M$ 是 Michaelis 常数，$u(t)$ 是一个代表底物注入速率的可控输入。真实参数为 $\\theta = [V_{\\max}, K_M]^{\\top}$。假设存在方差为 $\\sigma^2$ 的附加零均值高斯测量噪声，因此观测值为 $y_{\\text{obs}}(t) = y(t) + \\varepsilon(t)$，其中 $\\varepsilon(t)$ 是方差为 $\\sigma^2$ 且在时间上独立的高斯噪声。目标是在固定的幅值预算下比较三种输入族 $u(t)$，并选择能产生最大费雪信息矩阵 (FIM) 行列式的输入族，该行列式定义了 D-最优性。\n\n使用以下基本依据：\n- 对于具有方差为 $\\sigma^2$ 的独立高斯噪声的连续观测标量输出，参数 $\\theta$ 的费雪信息矩阵 (FIM) 由下式给出\n$$\\mathcal{I}(\\theta) = \\int_{0}^{T} \\frac{1}{\\sigma^2} \\left(\\frac{\\partial y(t)}{\\partial \\theta}\\right)\\left(\\frac{\\partial y(t)}{\\partial \\theta}\\right)^{\\top} \\, dt,$$\n其中 $\\frac{\\partial y(t)}{\\partial \\theta}$ 是输出关于参数 $\\theta$ 的灵敏度。\n- 对于依赖于状态的输出，其灵敏度动力学可由链式法则推导：若 $\\dot{S}(t) = f(S(t), \\theta, t)$ 且 $y(t) = S(t)$，则对于每个参数 $\\theta_i$，灵敏度 $z_i(t) = \\frac{\\partial S(t)}{\\partial \\theta_i}$ 遵循以下演化规律：\n$$\\dot{z}_i(t) = \\frac{\\partial f}{\\partial S}(S(t), \\theta, t) \\, z_i(t) + \\frac{\\partial f}{\\partial \\theta_i}(S(t), \\theta, t), \\quad z_i(0) = 0,$$\n前提是初始条件 $S(0)$ 不依赖于 $\\theta$。\n\n您必须为以下三种输入族计算预期信息和 D-最优性：\n- 阶跃：$$u_{\\text{step}}(t) = A,$$\n- 斜坡：$$u_{\\text{ramp}}(t) = A \\frac{t}{T},$$\n- 正弦：$$u_{\\text{sin}}(t) = A \\sin(\\omega t),$$\n其中 $A$ 是一个固定幅值，单位为 mol/(L·s)；$T$ 是实验持续时间，单位为秒；$\\omega$ 是角频率，单位为弧度/秒。\n\n物理单位：\n- $S(t)$ 单位为 mol/L,\n- $V_{\\max}$ 单位为 mol/(L·s),\n- $K_M$ 单位为 mol/L,\n- $u(t)$ 单位为 mol/(L·s),\n- $t$ 单位为 s,\n- $\\omega$ 单位为 radians/s,\n- $\\sigma^2$ 单位为 (mol/L)$^2$。\n\n角度单位说明：$\\omega$ 以弧度/秒为单位提供，且必须按此单位使用。\n\n您的程序必须对每个测试用例，使用灵敏度方程计算连续时间 FIM，然后计算 FIM 的行列式作为 D-最优性。为公平起见，在给定的测试用例中，对三种输入使用相同的幅值 $A$。选择使行列式最大化的输入族；如果出现平局（行列式在数值精度范围内相等），则根据映射关系（阶跃 $\\to 0$，斜坡 $\\to 1$，正弦 $\\to 2$）选择最小的索引。\n\n需遵守的设计细节：\n- 使用酶动力学模型所蕴含的灵敏度动力学：\n$$f(S,\\theta,t) = -\\frac{V_{\\max} S}{K_M + S} + u(t).$$\n- 灵敏度传播所需的雅可比矩阵为\n$$\\frac{\\partial f}{\\partial S} = -\\frac{V_{\\max} K_M}{(K_M + S)^2}, \\quad \\frac{\\partial f}{\\partial V_{\\max}} = -\\frac{S}{K_M + S}, \\quad \\frac{\\partial f}{\\partial K_M} = \\frac{V_{\\max} S}{(K_M + S)^2}.$$\n- 费雪信息矩阵的被积函数由 $y(t)=S(t)$ 关于 $\\theta$ 的灵敏度（即向量 $\\left[z_{V_{\\max}}(t), z_{K_M}(t)\\right]^{\\top}$）构成，因此其行列式为\n$$\\det(\\mathcal{I}(\\theta)) = \\det\\left(\\int_{0}^{T} \\frac{1}{\\sigma^2}\n\\begin{bmatrix}\nz_{V_{\\max}}(t)^2 & z_{V_{\\max}}(t) z_{K_M}(t) \\\\\nz_{V_{\\max}}(t) z_{K_M}(t) & z_{K_M}(t)^2\n\\end{bmatrix} dt \\right).$$\n\n测试套件：\n为以下三个测试用例提供结果，每个用例指定为一个元组 $(V_{\\max}, K_M, S_0, T, \\sigma, A, \\omega)$，单位如上定义。\n1. 案例 1 (中等动力学；长持续时间；低噪声): $(1.0\\times 10^{-3}, 5.0\\times 10^{-4}, 1.0\\times 10^{-3}, 200, 1.0\\times 10^{-6}, 2.0\\times 10^{-4}, 0.05)$。\n2. 案例 2 (近饱和状态；短持续时间；中等噪声): $(1.0\\times 10^{-2}, 1.0\\times 10^{-5}, 5.0\\times 10^{-5}, 50, 5.0\\times 10^{-6}, 1.0\\times 10^{-4}, 0.5)$。\n3. 案例 3 (慢动力学；长持续时间；中等噪声): $(5.0\\times 10^{-5}, 1.0\\times 10^{-3}, 1.0\\times 10^{-3}, 500, 2.0\\times 10^{-6}, 1.0\\times 10^{-5}, 0.02)$。\n\n算法要求：\n- 对由状态 $S(t)$ 和灵敏度状态 $\\left[z_{V_{\\max}}(t), z_{K_M}(t)\\right]$ 组成的增广系统进行积分，时间从 $t=0$ 到 $t=T$，初始条件为 $S(0)=S_0$ 和 $z_{V_{\\max}}(0)=z_{K_M}(0)=0$。\n- 通过对矩阵元素的常微分方程进行积分来连续累积 FIM\n$$\\dot{J}_{11}(t) = \\frac{1}{\\sigma^2} z_{V_{\\max}}(t)^2, \\quad \\dot{J}_{12}(t) = \\frac{1}{\\sigma^2} z_{V_{\\max}}(t) z_{K_M}(t), \\quad \\dot{J}_{22}(t) = \\frac{1}{\\sigma^2} z_{K_M}(t)^2,$$\n其中 $J_{11}(0)=J_{12}(0)=J_{22}(0)=0$，并计算 $\\det(\\mathcal{I}(\\theta)) = J_{11}(T) J_{22}(T) - \\left(J_{12}(T)\\right)^2$。\n- 当 $K_M + S(t)$ 很小时，通过避免除以零来确保数值稳定性；在计算雅可比矩阵时，将 $K_M + S(t)$ 视为有一个小的正数常量作为下界。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[0,1,2]$），列表中的每个条目都是集合 $\\{0,1,2\\}$ 中的一个整数，表示在相应测试用例中使 D-最优性最大化的输入族索引（阶跃 $=0$，斜坡 $=1$，正弦 $=2$）。不应打印任何附加文本。角度必须是弧度，所有物理量必须使用其指定单位。输出必须只有一行。",
            "solution": "该问题要求对酶动力学实验中的三种不同输入刺激进行比较分析，目标是选择能够提供关于模型参数 $\\theta = [V_{\\max}, K_M]^{\\top}$ 最多信息的输入。信息度量是 D-最优性准则，它对应于费雪信息矩阵 (FIM) 的行列式 $\\det(\\mathcal{I}(\\theta))$。该分析将通过数值求解一个描述系统动力学、参数灵敏度以及 FIM 分量演化的常微分方程组 (ODE) 来进行。\n\n问题的核心在于 Michaelis-Menten 酶动力学模型，其中底物浓度 $S(t)$ 的变化率由下式给出：\n$$\n\\dot{S}(t) = f(S(t), \\theta, t) = -\\frac{V_{\\max} S(t)}{K_M + S(t)} + u(t)\n$$\n此处，$S(t)$ 是底物浓度，$V_{\\max}$ 是最大反应速率，$K_M$ 是 Michaelis 常数，$u(t)$ 是外部控制的底物注入速率。测量输出是底物浓度本身，$y(t) = S(t)$，并受到附加高斯噪声的影响。\n\n对于具有恒定方差 $\\sigma^2$ 的独立高斯噪声的连续观测标量输出，费雪信息矩阵可以量化实验数据提供关于参数 $\\theta$ 的信息量。它由以下积分定义：\n$$\n\\mathcal{I}(\\theta) = \\int_{0}^{T} \\frac{1}{\\sigma^2} \\left(\\frac{\\partial y(t)}{\\partial \\theta}\\right)\\left(\\frac{\\partial y(t)}{\\partial \\theta}\\right)^{\\top} \\, dt\n$$\n其中 $T$ 是实验的持续时间，$\\frac{\\partial y(t)}{\\partial \\theta}$ 是输出关于参数的灵敏度向量。由于 $y(t) = S(t)$，输出灵敏度与状态灵敏度相同，记为 $z_i(t) = \\frac{\\partial S(t)}{\\partial \\theta_i}$。\n\n为了计算 FIM，我们必须首先确定灵敏度函数 $z_{V_{\\max}}(t)$ 和 $z_{K_M}(t)$。这些函数通过求解灵敏度方程得到，而灵敏度方程是通过对状态方程关于每个参数求导得出的。其一般形式为：\n$$\n\\dot{z}_i(t) = \\frac{\\partial f}{\\partial S}(S(t), \\theta, t) \\, z_i(t) + \\frac{\\partial f}{\\partial \\theta_i}(S(t), \\theta, t)\n$$\n初始条件为 $z_i(0) = 0$，因为初始状态 $S(0)$ 被假定为已知且不依赖于 $\\theta$。对于我们的特定模型，所需的偏导数为：\n$$\n\\frac{\\partial f}{\\partial S} = -\\frac{V_{\\max} K_M}{(K_M + S)^2}, \\quad \\frac{\\partial f}{\\partial V_{\\max}} = -\\frac{S}{K_M + S}, \\quad \\frac{\\partial f}{\\partial K_M} = \\frac{V_{\\max} S}{(K_M + S)^2}\n$$\n这就得到了一个关于灵敏度 $z_{V_{\\max}}(t)$ 和 $z_{K_M}(t)$ 的两个耦合常微分方程组。\n\n该问题通过构建并求解一个增广常微分方程组来进行计算。这是必要的，因为灵敏度方程依赖于状态 $S(t)$，而 FIM 的计算需要对灵敏度的函数进行积分。该增广系统包含 6 个状态：主状态 $S(t)$，两个灵敏度 $z_{V_{\\max}}(t)$ 和 $z_{K_M}(t)$，以及对称 FIM 的三个唯一元素，我们将其记为 $J_{11}(t)$、$J_{12}(t)$ 和 $J_{22}(t)$。每个 FIM 分量的常微分方程都从 FIM 的定义中导出，例如，$J_{11}(T) = \\int_{0}^{T} \\frac{1}{\\sigma^2} (z_{V_{\\max}}(t))^2 dt$ 意味着 $\\dot{J}_{11}(t) = \\frac{1}{\\sigma^2} (z_{V_{\\max}}(t))^2$。\n\n完整的六个常微分方程的增广系统如下：\n1. $\\dot{S}(t) = -\\frac{V_{\\max} S(t)}{K_M + S(t)} + u(t)$\n2. $\\dot{z}_{V_{\\max}}(t) = \\left(-\\frac{V_{\\max} K_M}{(K_M + S(t))^2}\\right) z_{V_{\\max}}(t) - \\frac{S(t)}{K_M + S(t)}$\n3. $\\dot{z}_{K_M}(t) = \\left(-\\frac{V_{\\max} K_M}{(K_M + S(t))^2}\\right) z_{K_M}(t) + \\frac{V_{\\max} S(t)}{(K_M + S(t))^2}$\n4. $\\dot{J}_{11}(t) = \\frac{1}{\\sigma^2} (z_{V_{\\max}}(t))^2$\n5. $\\dot{J}_{12}(t) = \\frac{1}{\\sigma^2} z_{V_{\\max}}(t) z_{K_M}(t)$\n6. $\\dot{J}_{22}(t) = \\frac{1}{\\sigma^2} (z_{K_M}(t))^2$\n\n该系统在 $t=0$ 时的初始条件为：\n$$\nS(0) = S_0, \\quad z_{V_{\\max}}(0) = 0, \\quad z_{K_M}(0) = 0, \\quad J_{11}(0) = 0, \\quad J_{12}(0) = 0, \\quad J_{22}(0) = 0\n$$\n\n每个测试用例的计算流程如下：\n对于三种输入族（$u_{\\text{step}}$、$u_{\\text{ramp}}$、$u_{\\text{sin}}$）中的每一种，增广 ODE 系统在区间 $[0, T]$ 上进行数值积分。数值积分使用标准求解器（如 Runge-Kutta 方法）执行。在计算过程中，向分母项 $K_M + S(t)$ 添加一个小的正数常量，以防止数值不稳定，特别是当 $S(t)$ 由于数值误差接近 $-K_M$ 时，尽管物理浓度必须为非负值。\n\n积分得到最终时间 $T$ 时的 FIM 分量值：$\\mathcal{I}_{11} = J_{11}(T)$、$\\mathcal{I}_{12} = J_{12}(T)$ 和 $\\mathcal{I}_{22} = J_{22}(T)$。然后，D-最优性准则通过计算 FIM 的行列式得出：\n$$\n\\det(\\mathcal{I}(\\theta)) = \\mathcal{I}_{11} \\mathcal{I}_{22} - (\\mathcal{I}_{12})^2\n$$\n最后，对于每个测试用例，比较得到的三个行列式。产生最大行列式的输入函数被确定为最优选择。索引映射为：阶跃 $\\to 0$、斜坡 $\\to 1$、正弦 $\\to 2$。如果出现平局，则选择索引最小的输入。对所有给定的测试用例重复此整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the optimal experimental design problem for the given test cases.\n    \"\"\"\n    \n    # Test cases: (V_max, K_M, S0, T, sigma, A, omega)\n    test_cases = [\n        (1.0e-3, 5.0e-4, 1.0e-3, 200, 1.0e-6, 2.0e-4, 0.05),\n        (1.0e-2, 1.0e-5, 5.0e-5, 50, 5.0e-6, 1.0e-4, 0.5),\n        (5.0e-5, 1.0e-3, 1.0e-3, 500, 2.0e-6, 1.0e-5, 0.02)\n    ]\n    \n    input_families = ['step', 'ramp', 'sin']\n    results = []\n\n    for case_params in test_cases:\n        V_max, K_M, S0, T, sigma, A, omega = case_params\n        determinants = []\n\n        for input_type in input_families:\n            \n            def ode_system(t, y, V_max, K_M, sigma, A, T, omega, input_type):\n                S, z_Vmax, z_KM, J11, J12, J22 = y\n                \n                # Select input u(t)\n                if input_type == 'step':\n                    u = A\n                elif input_type == 'ramp':\n                    u = A * t / T\n                elif input_type == 'sin':\n                    u = A * np.sin(omega * t)\n                else:\n                    u = 0.0\n\n                # Numerical stability for denominator\n                denom = K_M + S\n                # Safeguard against division by small numbers. S should be non-negative.\n                if denom  1e-12:\n                    denom = 1e-12\n                \n                denom_sq = denom**2\n                \n                # State equation\n                dS_dt = -V_max * S / denom + u\n\n                # Sensitivity equations\n                df_dS = -V_max * K_M / denom_sq\n                df_dVmax = -S / denom\n                df_dKM = V_max * S / denom_sq\n                \n                dz_Vmax_dt = df_dS * z_Vmax + df_dVmax\n                dz_KM_dt = df_dS * z_KM + df_dKM\n\n                # FIM component equations\n                sigma_sq = sigma**2\n                dJ11_dt = z_Vmax**2 / sigma_sq\n                dJ12_dt = z_Vmax * z_KM / sigma_sq\n                dJ22_dt = z_KM**2 / sigma_sq\n\n                return [dS_dt, dz_Vmax_dt, dz_KM_dt, dJ11_dt, dJ12_dt, dJ22_dt]\n\n            y0 = [S0, 0, 0, 0, 0, 0]\n            \n            sol = solve_ivp(\n                fun=ode_system,\n                t_span=[0, T],\n                y0=y0,\n                args=(V_max, K_M, sigma, A, T, omega, input_type),\n                method='RK45', \n                rtol=1e-6, \n                atol=1e-9\n            )\n            \n            # Extract final FIM components\n            final_values = sol.y[:, -1]\n            J11_T = final_values[3]\n            J12_T = final_values[4]\n            J22_T = final_values[5]\n            \n            # Calculate determinant of FIM\n            det_fim = J11_T * J22_T - J12_T**2\n            determinants.append(det_fim)\n\n        # Find index of the input family that maximizes the determinant\n        # np.argmax returns the index of the first occurrence of the maximum,\n        # which satisfies the tie-breaking rule (smallest index wins).\n        best_index = np.argmax(determinants)\n        results.append(best_index)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}