{
    "hands_on_practices": [
        {
            "introduction": "心律失常通常源于细胞层面的异常电信号。本练习提供了一个动手计算，旨在帮助您理解一个亚阈值事件——延迟后除极（DAD）——如何跨越阈值并触发一次非预期的动作电位，从而构成触发性心律失常的基础。这项实践将加深您对离子电流、膜电容和细胞兴奋性之间关键联系的理解。",
            "id": "3905441",
            "problem": "考虑一个单室心室肌细胞模型，其中延迟后除极（DAD）完全由钠钙交换体（NCX）驱动。假设跨膜区域被建模为一个单位面积电容为 $C_{m}$ 的电容器，并且在任何触发动作电位（AP）之前，在 DAD 的时间尺度上，其他离子电流可以忽略不计。对于 $t \\ge 0$，由NCX介导的DAD电流密度由 $i_{\\mathrm{NCX}}(t) = -I_{0}\\,\\exp(-t/\\tau)$ 给出，其中按照惯例，内向电流为负。静息膜电位为 $V_{\\mathrm{rest}}$，阈电位为 $V_{\\mathrm{th}}$，AP峰值电位为 $V_{\\mathrm{peak}}$。\n\n使用的基本原理：\n- 由电流密度 $i(t)$ 输送的单位面积总电荷为 $q = \\int_{0}^{\\infty} i(t)\\,dt$。\n- 对于电容性膜，单位面积电荷与电压变化之间的关系为 $q = C_{m}\\,\\Delta V$。\n\n将膜电位从 $V_{\\mathrm{rest}}$ 移动到 $V_{\\mathrm{th}}$ 所需的单位面积阈值电荷定义为 $q_{\\mathrm{th}} = C_{m}\\,(V_{\\mathrm{th}} - V_{\\mathrm{rest}})$。设由NCX输送的内向电荷的大小为 $|q_{\\mathrm{NCX}}|$。如果 $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$，则发生一次触发搏动。如果发生触发搏动，则将其振幅定义为 $A = V_{\\mathrm{peak}} - V_{\\mathrm{rest}}$。如果没有发生触发搏动，则定义 $A = \\Delta V_{\\mathrm{DAD}}$，其中 $\\Delta V_{\\mathrm{DAD}} = |q_{\\mathrm{NCX}}|/C_{m}$ 是仅由DAD电流引起的除极。\n\n使用以下参数值：\n- $I_{0} = 0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}$,\n- $\\tau = 80\\,\\mathrm{ms}$,\n- $C_{m} = 1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$,\n- $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$,\n- $V_{\\mathrm{th}} = -65\\,\\mathrm{mV}$,\n- $V_{\\mathrm{peak}} = +30\\,\\mathrm{mV}$.\n\n通过对NCX电流进行时间积分，将得到的电荷与阈值电荷进行比较，并为 $A$ 选择合适的表达式，来计算如上定义的振幅 $A$。以毫伏为单位表示最终答案。无需进行精确算术之外的舍入。",
            "solution": "问题陈述经评估有效。它以心脏电生理学和膜生物物理学原理为科学依据，提出了一个简化但连贯的延迟后除极（DAD）模型。该问题是适定、客观且自洽的，提供了所有必要的参数、定义以及通往唯一解的清晰逻辑路径。所提供的数值在生理上是合理的。\n\n目标是计算由NCX驱动的DAD引起的电压响应的振幅 $A$。$A$ 的定义是条件性的，取决于DAD是否足够大以触发一个完整的动作电位。第一步是确定由钠钙交换体电流 $i_{\\mathrm{NCX}}(t)$ 输送的单位面积总电荷 $q_{\\mathrm{NCX}}$。\n\n电流密度对于 $t \\ge 0$ 给出为 $i_{\\mathrm{NCX}}(t) = -I_{0}\\,\\exp(-t/\\tau)$。单位面积总电荷通过对此电流密度进行全时积分得到。\n$$q_{\\mathrm{NCX}} = \\int_{0}^{\\infty} i_{\\mathrm{NCX}}(t)\\,dt = \\int_{0}^{\\infty} -I_{0}\\,\\exp(-t/\\tau)\\,dt$$\n我们可以提出常数 $-I_{0}$：\n$$q_{\\mathrm{NCX}} = -I_{0} \\int_{0}^{\\infty} \\exp(-t/\\tau)\\,dt$$\n指数函数的积分是：\n$$q_{\\mathrm{NCX}} = -I_{0} \\left[ -\\tau\\,\\exp(-t/\\tau) \\right]_{0}^{\\infty}$$\n在积分极限处计算表达式的值：\n$$q_{\\mathrm{NCX}} = -I_{0} \\left( \\lim_{t\\to\\infty} (-\\tau\\,\\exp(-t/\\tau)) - (-\\tau\\,\\exp(-0/\\tau)) \\right)$$\n$$q_{\\mathrm{NCX}} = -I_{0} \\left( 0 - (-\\tau \\cdot 1) \\right) = -I_{0}\\tau$$\n这个内向电荷的大小是 $|q_{\\mathrm{NCX}}| = I_{0}\\tau$。现在我们可以代入给定的参数值：$I_{0} = 0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}$ 和 $\\tau = 80\\,\\mathrm{ms}$。保持单位一致至关重要。我们将毫秒转换为秒：$80\\,\\mathrm{ms} = 80 \\times 10^{-3}\\,\\mathrm{s}$。\n$$|q_{\\mathrm{NCX}}| = (0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}) \\times (80\\,\\mathrm{ms}) = (0.30 \\times 10^{-6}\\,\\mathrm{A}\\,\\mathrm{cm}^{-2}) \\times (80 \\times 10^{-3}\\,\\mathrm{s})$$\n$$|q_{\\mathrm{NCX}}| = 24 \\times 10^{-9}\\,\\mathrm{A}\\cdot\\mathrm{s}\\,\\mathrm{cm}^{-2} = 24 \\times 10^{-9}\\,\\mathrm{C}\\,\\mathrm{cm}^{-2} = 0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$$\n\n下一步是计算将膜电位从静息电位 $V_{\\mathrm{rest}}$ 除极至阈电位 $V_{\\mathrm{th}}$ 所需的单位面积阈值电荷 $q_{\\mathrm{th}}$。问题将其定义为 $q_{\\mathrm{th}} = C_{m}(V_{\\mathrm{th}} - V_{\\mathrm{rest}})$。\n给定的参数是 $C_{m} = 1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$，$V_{\\mathrm{th}} = -65\\,\\mathrm{mV}$，和 $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$。\n首先，计算所需的电压变化：\n$$\\Delta V = V_{\\mathrm{th}} - V_{\\mathrm{rest}} = (-65\\,\\mathrm{mV}) - (-85\\,\\mathrm{mV}) = 20\\,\\mathrm{mV}$$\n现在，计算 $q_{\\mathrm{th}}$。我们必须再次通过将毫伏转换为伏特来确保单位一致性：$20\\,\\mathrm{mV} = 20 \\times 10^{-3}\\,\\mathrm{V}$。法拉是库仑每伏特，$\\mathrm{F} = \\mathrm{C}/\\mathrm{V}$。\n$$q_{\\mathrm{th}} = (1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}) \\times (20\\,\\mathrm{mV}) = (1.0 \\times 10^{-6}\\,\\mathrm{F}\\,\\mathrm{cm}^{-2}) \\times (20 \\times 10^{-3}\\,\\mathrm{V})$$\n$$q_{\\mathrm{th}} = 20 \\times 10^{-9}\\,\\mathrm{F}\\cdot\\mathrm{V}\\,\\mathrm{cm}^{-2} = 20 \\times 10^{-9}\\,\\mathrm{C}\\,\\mathrm{cm}^{-2} = 0.020\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$$\n\n现在我们必须比较 $|q_{\\mathrm{NCX}}|$ 和 $q_{\\mathrm{th}}$ 以确定是否发生触发搏动。触发搏动的条件是 $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$。\n我们得到 $|q_{\\mathrm{NCX}}| = 0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$ 和 $q_{\\mathrm{th}} = 0.020\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$。\n由于 $0.024 > 0.020$，条件 $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$ 得到满足。\n因此，发生一次触发搏动。\n\n根据问题定义，如果发生触发搏动，振幅由 $A = V_{\\mathrm{peak}} - V_{\\mathrm{rest}}$ 给出。\n使用所提供的值 $V_{\\mathrm{peak}} = +30\\,\\mathrm{mV}$ 和 $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$：\n$$A = (+30\\,\\mathrm{mV}) - (-85\\,\\mathrm{mV}) = 30\\,\\mathrm{mV} + 85\\,\\mathrm{mV} = 115\\,\\mathrm{mV}$$\n如果触发搏动的条件未被满足（即，如果 $|q_{\\mathrm{NCX}}|  q_{\\mathrm{th}}$），振幅将会是亚阈值除极 $\\Delta V_{\\mathrm{DAD}} = |q_{\\mathrm{NCX}}|/C_m = (0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2})/(1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}) = 24\\,\\mathrm{mV}$。然而，由于超过了阈值，再生性动作电位被触发，其振幅由峰值电位和静息电位决定。\n\n最终计算出的振幅是 $115\\,\\mathrm{mV}$。",
            "answer": "$$\\boxed{115}$$"
        },
        {
            "introduction": "从单个细胞层面，我们转向组织层面。一个异常信号要维持心律失常，就必须在组织中传导，但有时传导会受阻。本练习将探讨“源-汇失配”这一关键概念，它决定了电波能否成功通过复杂的心脏几何结构。通过模拟电波通过狭窄峡部的传导，您将推导出传导阻滞的条件，这是形成折返性心律失常的关键要素。",
            "id": "3905454",
            "problem": "一个厚度为 $t$ 的二维心脏组织板，其上游通过一个半径为 $a$、长度为 $L$ 的圆柱形峡部相连，动作电位波前以恒定速度 $c$ 通过该峡部传播到组织板中。该组织由单域模型描述，其各向同性体电导率为 $\\sigma$（单位 S/m），单位面积膜电容为 $C_{m}$（单位 F/m$^{2}$），膜面积-体积比为 $\\chi$（单位 m$^{-1}$）。假设在快速去极化（上升相）阶段，离子电流密度主要由起触发作用的快速内向电流主导，而扩散源-汇平衡决定了传播是否能成功通过几何异质性区域。您可以将峡部下游的去极化需求建模为，在上升相期间，需要将特征下游体积 $V_{\\text{down}}$ 内的跨膜电位提高 $\\Delta V$，并将源建模为在同一时间间隔内通过峡部输送的扩散轴向电流。组织板相对于峡部较宽，因此波前在离开峡部后会发生平面内发散；将必须达到阈值附近的下游体积近似为一个半径为 $\\lambda$（电紧张长度）的半圆形圆盘沿厚度 $t$ 拉伸而成，因此 $V_{\\text{down}} = \\tfrac{1}{2}\\pi \\lambda^{2} t$。峡部的横截面积为 $A_{i} = \\pi a^{2}$。\n\n仅从单域方程、膜电容和面积-体积比的定义、电荷守恒、细胞内介质的欧姆定律以及稳定传播波前的运动学出发，通过将上升相期间通过峡部输送的扩散源电荷与去极化下游体积所需的电容电荷相等，推导出成功向下游传播的条件。由此，获得传播到组织板中所需的最小峡部直径 $D^{\\ast} = 2a^{\\ast}$ 的显式表达式。\n\n使用以下生理学上合理的参数值：$\\sigma = 0.20$ S/m, $C_{m} = 1.0 \\times 10^{-2}$ F/m$^{2}$, $\\chi = 1.4 \\times 10^{5}$ m$^{-1}$, $c = 0.40$ m/s, $t = 1.5 \\times 10^{-3}$ m, and $\\lambda = 1.0 \\times 10^{-3}$ m。将最终的 $D^{\\ast}$ 以毫米为单位表示，并将您的答案四舍五入到三位有效数字。通过参考对组织厚度和几何发散的依赖性，定性解释为什么该标准预测在窄峡部中会发生传导阻滞，而在宽束中能成功传播。",
            "solution": "出发点是单域方程\n$$\n\\chi C_{m} \\frac{\\partial V}{\\partial t} \\;=\\; \\nabla \\cdot \\left( \\sigma \\nabla V \\right) \\;-\\; I_{\\text{ion}},\n$$\n其中 $\\chi$ 是膜面积-体积比，$C_{m}$ 是单位面积膜电容，$\\sigma$ 是体电导率，$V$ 是跨膜电位，$I_{\\text{ion}}$ 是单位体积的离子电流密度。在快速上升相期间，跨越几何瓶颈的传播成功与否由源-汇平衡决定：源是通过峡部输送的扩散轴向电流，汇是必须充电至阈值的下游组织体积的电容需求。\n\n将下游体积 $V_{\\text{down}}$ 的电位升高 $\\Delta V$ 所需的电容电荷由下式给出\n$$\nQ_{\\text{req}} \\;=\\; \\left(\\chi C_{m} V_{\\text{down}}\\right)\\,\\Delta V,\n$$\n因为 $\\chi C_{m}$ 是单位体积的膜电容，而 $\\Delta V$ 是电压增量。\n\n在源侧，沿峡部的轴向扩散电流密度由欧姆定律给出：\n$$\nJ_{x} \\;=\\; -\\,\\sigma\\,\\frac{\\partial V}{\\partial x}.\n$$\n对于一个以速度 $c$ 在 $+x$ 方向稳定传播的波前，行波的运动学关系 $V(x,t) = \\hat{V}(x - ct)$ 意味着\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; -\\,c\\,\\frac{\\partial V}{\\partial x}\n\\quad\\Longrightarrow\\quad\n\\frac{\\partial V}{\\partial x} \\;=\\; -\\,\\frac{1}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\n因此，轴向电流密度变为\n$$\nJ_{x} \\;=\\; -\\,\\sigma\\left(-\\,\\frac{1}{c}\\,\\frac{\\partial V}{\\partial t}\\right)\n\\;=\\; \\frac{\\sigma}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\n通过峡部横截面 $A_{i}$ 的总轴向电流是\n$$\nI_{\\text{src}} \\;=\\; A_{i}\\,J_{x} \\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\n在上升相时间间隔内（在此期间电位上升 $\\Delta V$）积分，得到总的输送电荷：\n$$\nQ_{\\text{del}} \\;=\\; \\int I_{\\text{src}}\\,dt \\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\int \\frac{\\partial V}{\\partial t}\\,dt\n\\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\Delta V.\n$$\n向下游体积传播的安全因子是比率\n$$\n\\text{SF} \\;=\\; \\frac{Q_{\\text{del}}}{Q_{\\text{req}}}\n\\;=\\; \\frac{A_{i}\\,\\dfrac{\\sigma}{c}\\,\\Delta V}{\\left(\\chi C_{m} V_{\\text{down}}\\right)\\,\\Delta V}\n\\;=\\; \\frac{\\sigma\\,A_{i}}{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}.\n$$\n成功传播的最低要求是 $\\text{SF} \\geq 1$，这得出了临界横截面积\n$$\nA_{i}^{\\ast} \\;=\\; \\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\sigma}.\n$$\n对于半径为 $a$ 的圆柱形峡部，$A_{i} = \\pi a^{2}$，所以临界半径是\n$$\na^{\\ast} \\;=\\; \\sqrt{\\frac{A_{i}^{\\ast}}{\\pi}}\n\\;=\\; \\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\pi\\,\\sigma}},\n$$\n临界直径是\n$$\nD^{\\ast} \\;=\\; 2a^{\\ast} \\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\pi\\,\\sigma}}.\n$$\n\n对于给定的几何形状，下游体积近似为一个半径为 $\\lambda$ 的半圆形圆盘沿厚度 $t$ 拉伸而成：\n$$\nV_{\\text{down}} \\;=\\; \\frac{1}{2}\\,\\pi\\,\\lambda^{2}\\,t.\n$$\n将此代入 $D^{\\ast}$ 的表达式中，得到\n$$\nD^{\\ast} \\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}}{\\pi\\,\\sigma}\\,\\left(\\frac{1}{2}\\,\\pi\\,\\lambda^{2}\\,t\\right)}\n\\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,\\lambda^{2}\\,t}{2\\,\\sigma}}.\n$$\n\n现在代入数值（在最后一步之前保留符号推理）：$\\sigma = 0.20$ S/m, $C_{m} = 1.0 \\times 10^{-2}$ F/m$^{2}$, $\\chi = 1.4 \\times 10^{5}$ m$^{-1}$, $c = 0.40$ m/s, $t = 1.5 \\times 10^{-3}$ m, $\\lambda = 1.0 \\times 10^{-3}$ m。\n\n首先计算 $V_{\\text{down}}$：\n$$\nV_{\\text{down}} \\;=\\; \\frac{1}{2}\\,\\pi\\,(1.0 \\times 10^{-3})^{2}\\,(1.5 \\times 10^{-3})\n\\;=\\; \\frac{1}{2}\\,\\pi\\,(1.0 \\times 10^{-6})\\,(1.5 \\times 10^{-3})\n\\;=\\; 0.75\\,\\pi \\times 10^{-9}\\ \\text{m}^{3}.\n$$\n计算 $A_{i}^{\\ast}$：\n$$\nA_{i}^{\\ast} \\;=\\; \\frac{(0.40)\\,(1.4 \\times 10^{5})\\,(1.0 \\times 10^{-2})\\,(0.75\\,\\pi \\times 10^{-9})}{0.20}\n\\;=\\; \\frac{(0.40)\\,(1.4 \\times 10^{3})\\,(0.75\\,\\pi \\times 10^{-9})}{0.20}\n\\;=\\; \\frac{420\\,\\pi \\times 10^{-9}}{0.20}\n\\;=\\; 6.59734 \\times 10^{-6}\\ \\text{m}^{2},\n$$\n其中中间的简化使用了 $(0.40)\\times(1.4 \\times 10^{3})\\times 0.75 = 420$。临界半径是\n$$\na^{\\ast} \\;=\\; \\sqrt{\\frac{A_{i}^{\\ast}}{\\pi}}\n\\;=\\; \\sqrt{\\frac{6.59734 \\times 10^{-6}}{\\pi}}\n\\;=\\; \\sqrt{2.10000 \\times 10^{-6}}\\ \\text{m}\n\\;=\\; 1.449 \\times 10^{-3}\\ \\text{m},\n$$\n所以临界直径是\n$$\nD^{\\ast} \\;=\\; 2\\,a^{\\ast} \\;=\\; 2.898 \\times 10^{-3}\\ \\text{m} \\;=\\; 2.898\\ \\text{mm}.\n$$\n四舍五入到三位有效数字，得到 $2.90$ mm。\n\n定性解释：临界直径与 $D^{\\ast} \\propto \\sqrt{\\lambda^{2} t}$ 成比例，并随厚度 $t$ 和电紧张长度 $\\lambda$ 的增加而增加，这两者都增大了下游的电容汇。它随着电导率 $\\sigma$ 的增高而减小，并随着波速 $c$ 和 $\\chi C_{m}$ 的增加而增加，分别反映了源强度和电容需求。窄峡部（小 $D$）提供的扩散电荷不足以去极化宽组织板中的大发散体积，预测会发生传导阻滞。相比之下，在宽束中，波前发散较小，有效 $V_{\\text{down}}$ 更接近于一个柱体 $A_{\\text{bundle}}\\lambda$（小于半圆形圆盘），汇减小了，同样的源就足够了，预测能成功传播。",
            "answer": "$$\\boxed{2.90}$$"
        },
        {
            "introduction": "最后，我们将理论与计算实践联系起来。精确模拟我们讨论的复杂电波需要审慎的数值方法。本练习深入探讨了计算网格的空间分辨率（以 $\\Delta x$ 表示）与模拟传导速度准确性之间的重要关系。您将学会量化数值误差，并确定必要的网格尺寸，以确保您的仿真结果在物理上是可靠的。",
            "id": "3905459",
            "problem": "一维心肌组织束在激发波前附近通过单域方程（monodomain equation）底层的反应-扩散平衡进行建模，其中扩散率为 $D$ 的扩散项和特征时间尺度为 $\\tau_{\\text{up}}$ 的快速离子上冲过程占主导地位。假设波前的前沿在空间上近似呈指数形式，并在快速上冲期间增长，其特征长度尺度 $\\ell$ 通过匹配扩散和反应时间尺度得到，使得 $\\ell$ 的尺度与 $\\sqrt{D \\tau_{\\text{up}}}$ 成比例。空间离散化在步长为 $\\Delta x$ 的均匀网格上使用二阶中心差分近似来计算拉普拉斯算子。\n\n仅使用以下基本依据：\n- 一维扩散算子为 $\\partial_{xx}$，其在步长为 $\\Delta x$ 的均匀网格上的二阶中心差分近似为 $[u(x+\\Delta x) - 2u(x) + u(x-\\Delta x)]/\\Delta x^2$。\n- 波前的前沿近似可以用指数剖面 $u(x) = \\mathrm{e}^{x/\\ell}$ 在相对于波前宽度的短距离上表示，而离子上冲时间尺度 $\\tau_{\\text{up}}$ 表征了波前的反应时间。\n- 特征长度尺度 $\\ell$ 满足扩散和反应时间尺度的平衡，导致 $\\ell \\sim \\sqrt{D \\tau_{\\text{up}}}$。\n- 通过量纲分析，传导速度以平方根比例依赖于扩散算子的有效强度：一个将扩散强度乘以某个因子的扰动，会将传导速度乘以该因子的平方根。\n\n任务：\n1. 推导一个以无量纲网格比 $s = \\Delta x/\\ell$ 表示的表达式，该表达式定量地描述了当二阶中心差分近似作用于指数前沿剖面 $u(x) = \\mathrm{e}^{x/\\ell}$ 时，对扩散算子引入的数值扰动。然后，在传导速度与有效扩散强度的平方根成比例的假设下，推导由此产生的传导速度相对误差作为 $s$ 的函数。将相对传导速度误差表示为小数（而非百分比），并且除非明确调用适当的极限，否则不要假设 $s$ 很小。\n2. 实现一个程序，对于每个测试用例，计算特征长度 $\\ell$（单位：厘米）、网格比 $s$、相对传导速度误差（无量纲）、传导速度比（无量纲，定义为数值传导速度除以真实传导速度），以及保证相对传导速度误差不超过指定目标误差 $\\varepsilon_{\\text{target}}$ 的最大网格步长 $\\Delta x_{\\max}$（单位：厘米）。\n3. 为确定 $\\Delta x_{\\max}$，求解由导出的相对传导速度误差等于 $\\varepsilon_{\\text{target}}$ 的等式所定义的 $s_{\\max}$，然后设置 $\\Delta x_{\\max} = s_{\\max} \\ell$。确保你的 $s_{\\max}$ 求解器是稳健的，并且不依赖于特殊情况的公式，除非有推导证明。\n\n物理单位和报告要求：\n- 所有长度量以厘米（cm）报告。\n- 所有时间量以毫秒（ms）报告。\n- 将传导速度比和相对误差报告为无量纲的小数。\n- 所有测试用例的目标误差为 $\\varepsilon_{\\text{target}} = 0.03$。\n\n测试套件：\n使用以下六个测试用例，每个用例以 $(D,\\tau_{\\text{up}},\\Delta x)$ 形式给出，其中 $D$ 的单位为 cm$^2$/ms，$\\tau_{\\text{up}}$ 的单位为 ms，$\\Delta x$ 的单位为 cm：\n- 用例 A: $(0.001, 0.8, 0.01)$。\n- 用例 B: $(0.001, 0.8, 0.001)$。\n- 用例 C: $(0.001, 0.8, 0.03)$。\n- 用例 D: $(0.001, 0.4, 0.01)$。\n- 用例 E: $(0.001, 2.0, 0.01)$。\n- 用例 F: $(0.0005, 0.8, 0.01)$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例的结果，表示为一个包含五个浮点数的列表，顺序为 $[\\ell, s, \\text{relative\\_error}, \\text{velocity\\_ratio}, \\Delta x_{\\max}]$。最后一行必须看起来像一个不含空格的列表的列表，例如，“[[...],[...],[...],[...],[...],[...]]”。",
            "solution": "该问题已经过验证，并被确定为计算生物物理学领域中一个有效、独立且具有科学依据的问题。该问题是适定的、客观的，没有明显缺陷。因此，我们可以着手提供完整的解决方案。\n\n问题要求我们分析在模拟心肌组织中的电波前时，使用二阶中心差分近似扩散算子所引入的数值误差。该分析取决于波前前沿的指数近似。\n\n首先，我们将推导数值扩散算子和解析扩散算子之间的定量关系。其次，我们将利用此关系推导计算出的传导速度的相对误差。第三，我们将构建用于确定在给定目标误差下最大允许网格尺寸 $\\Delta x_{\\max}$ 的方法。\n\n### 第1部分：相对传导速度误差的推导\n\n问题的核心在于比较解析扩散算子 $D \\partial_{xx}$ 与其数值近似 $D \\nabla^2_{\\text{num}}$ 在指定的前沿剖面 $u(x) = \\mathrm{e}^{x/\\ell}$ 上的作用。\n\n解析扩散项由下式给出：\n$$ D \\frac{\\partial^2 u}{\\partial x^2} = D \\frac{\\partial^2}{\\partial x^2} (\\mathrm{e}^{x/\\ell}) = D \\left( \\frac{1}{\\ell^2} \\mathrm{e}^{x/\\ell} \\right) = \\frac{D}{\\ell^2} u(x) $$\n在连续情况下，有效扩散强度是 $u(x)$ 的系数，即 $D/\\ell^2$。\n\n使用二阶中心差分格式对拉普拉斯算子的数值近似为：\n$$ \\nabla^2_{\\text{num}} u(x) = \\frac{u(x+\\Delta x) - 2u(x) + u(x-\\Delta x)}{\\Delta x^2} $$\n代入剖面 $u(x) = \\mathrm{e}^{x/\\ell}$：\n$$ \\nabla^2_{\\text{num}} u(x) = \\frac{\\mathrm{e}^{(x+\\Delta x)/\\ell} - 2\\mathrm{e}^{x/\\ell} + \\mathrm{e}^{(x-\\Delta x)/\\ell}}{\\Delta x^2} $$\n提出因子 $\\mathrm{e}^{x/\\ell} = u(x)$：\n$$ \\nabla^2_{\\text{num}} u(x) = \\frac{u(x)}{\\Delta x^2} \\left( \\mathrm{e}^{\\Delta x/\\ell} - 2 + \\mathrm{e}^{-\\Delta x/\\ell} \\right) $$\n使用恒等式 $2\\cosh(z) = \\mathrm{e}^z + \\mathrm{e}^{-z}$，括号中的项变为 $2\\cosh(\\Delta x/\\ell) - 2$。\n$$ \\nabla^2_{\\text{num}} u(x) = \\frac{2u(x)}{\\Delta x^2} \\left( \\cosh(\\Delta x/\\ell) - 1 \\right) $$\n因此，数值扩散项为：\n$$ D \\nabla^2_{\\text{num}} u(x) = \\frac{2D}{\\Delta x^2} \\left( \\cosh(\\Delta x/\\ell) - 1 \\right) u(x) $$\n为了找到数值扰动，我们将数值算子表示为解析算子作用的一个因子 $\\kappa$：\n$$ D \\nabla^2_{\\text{num}} u(x) = \\kappa \\left( D \\frac{\\partial^2 u}{\\partial x^2} \\right) = \\kappa \\frac{D}{\\ell^2} u(x) $$\n通过比较数值项的两个表达式，我们求解扰动因子 $\\kappa$：\n$$ \\frac{2D}{\\Delta x^2} \\left( \\cosh(\\Delta x/\\ell) - 1 \\right) u(x) = \\kappa \\frac{D}{\\ell^2} u(x) $$\n$$ \\kappa = \\frac{\\ell^2}{\\Delta x^2} \\cdot 2 \\left( \\cosh(\\Delta x/\\ell) - 1 \\right) $$\n引入无量纲网格比 $s = \\Delta x/\\ell$，上式简化为：\n$$ \\kappa(s) = \\frac{2(\\cosh(s) - 1)}{s^2} $$\n问题指出，传导速度 $\\theta$ 与有效扩散强度的平方根成比例。因此，数值速度 $\\theta_{\\text{num}}$ 与真实速度 $\\theta_{\\text{true}}$ 之比为：\n$$ \\frac{\\theta_{\\text{num}}}{\\theta_{\\text{true}}} = \\sqrt{\\frac{\\text{Numerical Diffusion Strength}}{\\text{True Diffusion Strength}}} = \\sqrt{\\frac{\\kappa(s) (D/\\ell^2)}{D/\\ell^2}} = \\sqrt{\\kappa(s)} $$\n这个比率就是数值传导速度比。传导速度的相对误差 $\\varepsilon_v$ 定义为：\n$$ \\varepsilon_v = \\frac{\\theta_{\\text{num}} - \\theta_{\\text{true}}}{\\theta_{\\text{true}}} = \\frac{\\theta_{\\text{num}}}{\\theta_{\\text{true}}} - 1 = \\sqrt{\\kappa(s)} - 1 $$\n代入 $\\kappa(s)$ 的表达式：\n$$ \\varepsilon_v(s) = \\sqrt{\\frac{2(\\cosh(s) - 1)}{s^2}} - 1 $$\n对于小 $s$，这个表达式在数值上是不稳定的。我们可以使用恒等式 $\\cosh(s) - 1 = 2\\sinh^2(s/2)$ 将其重新表述：\n$$ \\varepsilon_v(s) = \\sqrt{\\frac{2(2\\sinh^2(s/2))}{s^2}} - 1 = \\sqrt{\\frac{4\\sinh^2(s/2)}{s^2}} - 1 = \\left| \\frac{2\\sinh(s/2)}{s} \\right| - 1 $$\n由于我们考虑 $s  0$，这可以简化为一个数值稳定的形式：\n$$ \\varepsilon_v(s) = \\frac{\\sinh(s/2)}{s/2} - 1 $$\n这就是相对传导速度误差的最终表达式。对于小 $s$ 的泰勒级数展开 $\\varepsilon_v(s) = (1 + \\frac{(s/2)^2}{3!} + \\dots) - 1 \\approx \\frac{s^2}{24}$ 表明，误差是正的（数值速度被高估）并且是 $s$ 的二阶。\n\n### 第2部分：最大网格步长 $\\Delta x_{\\max}$ 的确定\n\n为了找到保证相对误差不超过 $\\varepsilon_{\\text{target}}$ 的最大网格步长 $\\Delta x_{\\max}$，我们必须找到满足以下等式的最大无量纲网格比 $s_{\\max}$：\n$$ \\varepsilon_v(s_{\\max}) = \\varepsilon_{\\text{target}} $$\n代入我们推导的 $\\varepsilon_v(s)$ 表达式：\n$$ \\frac{\\sinh(s_{\\max}/2)}{s_{\\max}/2} - 1 = \\varepsilon_{\\text{target}} $$\n令 $z = s_{\\max}/2$ 和 $k = 1 + \\varepsilon_{\\text{target}}$。方程变为：\n$$ \\sinh(z) = k \\cdot z $$\n这是一个关于 $z$（并因此关于 $s_{\\max}$）的超越方程，没有闭式解。我们必须对其进行数值求解。给定 $\\varepsilon_{\\text{target}} = 0.03$，我们有 $k = 1.03$。我们寻求函数 $f(z) = \\sinh(z) - 1.03z$ 的非零根。像布伦特方法（Brent method）这样的数值求根算法对于这项任务是合适且稳健的。\n\n一旦 $s_{\\max}$ 的值被确定（对于固定的 $\\varepsilon_{\\text{target}}$，它是一个常数），对于给定的一组参数 $(D, \\tau_{\\text{up}})$，最大物理网格步长可以通过以下方式计算：\n$$ \\Delta x_{\\max} = s_{\\max} \\cdot \\ell $$\n其中 $\\ell = \\sqrt{D \\tau_{\\text{up}}}$。\n\n### 计算总结\n\n对于每个具有参数 $(D, \\tau_{\\text{up}}, \\Delta x)$ 的测试用例：\n1.  计算特征长度尺度 $\\ell = \\sqrt{D \\tau_{\\text{up}}}$。\n2.  计算无量纲网格比 $s = \\Delta x / \\ell$。\n3.  计算相对速度误差 $\\varepsilon_v = \\frac{\\sinh(s/2)}{s/2} - 1$。对于 $s=0$ 的情况，误差为 $0$。\n4.  计算传导速度比 $\\frac{\\theta_{\\text{num}}}{\\theta_{\\text{true}}} = \\varepsilon_v + 1$。\n5.  计算最大允许网格步长 $\\Delta x_{\\max} = s_{\\max} \\cdot \\ell$，其中 $s_{\\max}$ 是 $\\frac{\\sinh(s/2)}{s/2} - 1 = \\varepsilon_{\\text{target}}$ 的预先计算好的正根。对于 $\\varepsilon_{\\text{target}} = 0.03$，此根必须通过数值方法找到。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the cardiac wavefront numerical error problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (D [cm^2/ms], tau_up [ms], Delta_x [cm])\n    test_cases = [\n        (0.001, 0.8, 0.01),   # Case A\n        (0.001, 0.8, 0.001),  # Case B\n        (0.001, 0.8, 0.03),   # Case C\n        (0.001, 0.4, 0.01),   # Case D\n        (0.001, 2.0, 0.01),   # Case E\n        (0.0005, 0.8, 0.01),  # Case F\n    ]\n\n    # Target relative error for determining dx_max\n    epsilon_target = 0.03\n\n    # --- Part 1: Determine the universal constant s_max ---\n    # We need to solve for s in the equation: sinh(s/2)/(s/2) - 1 = epsilon_target\n    # This is equivalent to finding the root of f(s) = sinh(s/2)/(s/2) - (1 + epsilon_target) = 0\n    k = 1.0 + epsilon_target\n    def error_func_for_s_max(s):\n        # Using the formulation sinh(z) - k*z = 0 with z = s/2.\n        # This is more stable for root finding than the ratio form.\n        if s == 0:\n            return 0.0\n        z = s / 2.0\n        # Target function: sinh(z) - k*z\n        return np.sinh(z) - k * z\n\n    # We need to find the non-zero root.\n    # From Taylor expansion, an initial guess is s^2/24 ~ 0.03 = s ~ sqrt(0.72) ~ 0.85\n    # Let's bracket the root. f(0.1) is negative, f(2.0) is positive.\n    try:\n        # Use a robust bracketing root-finding method (Brent's method)\n        sol = optimize.root_scalar(error_func_for_s_max, bracket=[0.1, 2.0], method='brentq')\n        s_max = sol.root\n    except (ValueError, RuntimeError) as e:\n        # Fallback or error handling in case root finding fails\n        print(f\"Error finding root for s_max: {e}\")\n        return\n\n    # --- Part 2: Process each test case ---\n    results = []\n    for D, tau_up, delta_x in test_cases:\n        # 1. Calculate characteristic length l (in cm)\n        # D [cm^2/ms], tau_up [ms] - l [cm]\n        l_char = np.sqrt(D * tau_up)\n\n        # 2. Calculate dimensionless mesh ratio s\n        # delta_x [cm], l_char [cm] - s [dimensionless]\n        s_ratio = delta_x / l_char\n\n        # 3. Calculate relative conduction velocity error (dimensionless)\n        # This uses the numerically stable formula: sinh(s/2)/(s/2) - 1\n        if s_ratio == 0:\n            relative_error = 0.0\n        else:\n            z = s_ratio / 2.0\n            relative_error = np.sinh(z) / z - 1.0\n\n        # 4. Calculate conduction velocity ratio (dimensionless)\n        velocity_ratio = 1.0 + relative_error\n\n        # 5. Calculate the largest mesh step dx_max (in cm)\n        dx_max = s_max * l_char\n        \n        # Store results for this case\n        case_results = [l_char, s_ratio, relative_error, velocity_ratio, dx_max]\n        results.append(case_results)\n\n    # --- Part 3: Format and print the final output ---\n    # The final output must be a single line, a list of lists, with no spaces.\n    # Convert each inner list of floats to a comma-separated string repr\n    # Then join these strings with commas and enclose in brackets.\n    output_str = \"[\" + \",\".join([\"[\" + \",\".join([f\"{val:.8f}\" for val in res]) + \"]\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}