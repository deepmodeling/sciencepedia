{
    "hands_on_practices": [
        {
            "introduction": "心律失常可源于细胞层面的异常冲动形成，而延迟后除极 (Delayed afterdepolarizations, DADs) 是其中一个关键机制。本练习将 DAD 建模为一个瞬态内向电流，并探讨其触发完整动作电位的阈值条件，这可以归结为利用细胞膜电容进行的基本电荷平衡计算。通过解决这个问题 ()，学生将对亚细胞事件（如钙处理异常导致的钠钙交换电流）如何转化为潜在的致心律失常细胞事件获得定量的理解。",
            "id": "3905441",
            "problem": "考虑一个单室心室肌细胞模型，其中延迟后除极 (DAD) 完全由钠钙交换体 (NCX) 驱动。假设跨膜区域被建模为一个电容器，其单位面积电容为 $C_{m}$，并且在任何触发性动作电位 (AP) 之前，其他离子电流在DAD的时间尺度上可以忽略不计。对于 $t \\ge 0$，NCX介导的DAD电流密度由 $i_{\\mathrm{NCX}}(t) = -I_{0}\\,\\exp(-t/\\tau)$ 给出，按照惯例，内向电流为负。静息膜电位为 $V_{\\mathrm{rest}}$，阈电位为 $V_{\\mathrm{th}}$，AP峰电位为 $V_{\\mathrm{peak}}$。\n\n使用的基本原理：\n- 由电流密度 $i(t)$ 输送的单位面积总电荷为 $q = \\int_{0}^{\\infty} i(t)\\,dt$。\n- 对于电容性膜，单位面积电荷与电压变化之间的关系为 $q = C_{m}\\,\\Delta V$。\n\n定义将膜电位从 $V_{\\mathrm{rest}}$ 移动到 $V_{\\mathrm{th}}$ 所需的单位面积阈值电荷为 $q_{\\mathrm{th}} = C_{m}\\,(V_{\\mathrm{th}} - V_{\\mathrm{rest}})$。设内向NCX输送的电荷大小为 $|q_{\\mathrm{NCX}}|$。如果 $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$，则发生触发性搏动。如果发生触发性搏动，定义其振幅为 $A = V_{\\mathrm{peak}} - V_{\\mathrm{rest}}$。如果没有发生触发性搏动，定义 $A = \\Delta V_{\\mathrm{DAD}}$，其中 $\\Delta V_{\\mathrm{DAD}} = |q_{\\mathrm{NCX}}|/C_{m}$ 是仅由DAD电流引起的去极化。\n\n使用以下参数值：\n- $I_{0} = 0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}$，\n- $\\tau = 80\\,\\mathrm{ms}$，\n- $C_{m} = 1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$，\n- $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$，\n- $V_{\\mathrm{th}} = -65\\,\\mathrm{mV}$，\n- $V_{\\mathrm{peak}} = +30\\,\\mathrm{mV}$。\n\n通过对NCX电流随时间积分，将所得电荷与阈值电荷进行比较，并选择 $A$ 的适当表达式，计算如上定义的振幅 $A$。最终答案以毫伏表示。无需进行精确算术之外的舍入。",
            "solution": "问题陈述被评估为有效。它在心脏电生理学和膜生物物理学原理上具有科学依据，提出了一个简化但连贯的延迟后除极 (DAD) 模型。该问题定义明确、客观且自洽，提供了所有必要的参数、定义以及通向唯一解的清晰逻辑路径。所提供的值在生理上是合理的。\n\n目标是计算由NCX驱动的DAD所引起的电压响应的振幅 $A$。$A$ 的定义是条件性的，取决于DAD是否足够大以触发一个完整的动作电位。第一步是确定由钠钙交换体电流 $i_{\\mathrm{NCX}}(t)$ 输送的单位面积总电荷 $q_{\\mathrm{NCX}}$。\n\n电流密度由 $i_{\\mathrm{NCX}}(t) = -I_{0}\\,\\exp(-t/\\tau)$ 给出（对于 $t \\ge 0$）。通过对该电流密度在所有时间上积分，可以得到单位面积的总电荷。\n$$q_{\\mathrm{NCX}} = \\int_{0}^{\\infty} i_{\\mathrm{NCX}}(t)\\,dt = \\int_{0}^{\\infty} -I_{0}\\,\\exp(-t/\\tau)\\,dt$$\n我们可以提出常数 $-I_{0}$：\n$$q_{\\mathrm{NCX}} = -I_{0} \\int_{0}^{\\infty} \\exp(-t/\\tau)\\,dt$$\n指数函数的积分为：\n$$q_{\\mathrm{NCX}} = -I_{0} \\left[ -\\tau\\,\\exp(-t/\\tau) \\right]_{0}^{\\infty}$$\n在积分限处计算表达式：\n$$q_{\\mathrm{NCX}} = -I_{0} \\left( \\lim_{t\\to\\infty} (-\\tau\\,\\exp(-t/\\tau)) - (-\\tau\\,\\exp(-0/\\tau)) \\right)$$\n$$q_{\\mathrm{NCX}} = -I_{0} \\left( 0 - (-\\tau \\cdot 1) \\right) = -I_{0}\\tau$$\n这个内向电荷的大小为 $|q_{\\mathrm{NCX}}| = I_{0}\\tau$。现在我们可以代入给定的参数值：$I_{0} = 0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}$ 和 $\\tau = 80\\,\\mathrm{ms}$。保持单位一致至关重要。我们将毫秒转换为秒：$80\\,\\mathrm{ms} = 80 \\times 10^{-3}\\,\\mathrm{s}$。\n$$|q_{\\mathrm{NCX}}| = (0.30\\,\\mu\\mathrm{A}\\,\\mathrm{cm}^{-2}) \\times (80\\,\\mathrm{ms}) = (0.30 \\times 10^{-6}\\,\\mathrm{A}\\,\\mathrm{cm}^{-2}) \\times (80 \\times 10^{-3}\\,\\mathrm{s})$$\n$$|q_{\\mathrm{NCX}}| = 24 \\times 10^{-9}\\,\\mathrm{A}\\cdot\\mathrm{s}\\,\\mathrm{cm}^{-2} = 24 \\times 10^{-9}\\,\\mathrm{C}\\,\\mathrm{cm}^{-2} = 0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$$\n\n下一步是计算将膜从静息电位 $V_{\\mathrm{rest}}$ 去极化到阈电位 $V_{\\mathrm{th}}$ 所需的单位面积阈值电荷 $q_{\\mathrm{th}}$。问题将其定义为 $q_{\\mathrm{th}} = C_{m}(V_{\\mathrm{th}} - V_{\\mathrm{rest}})$。\n给定的参数为 $C_{m} = 1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}$，$V_{\\mathrm{th}} = -65\\,\\mathrm{mV}$，以及 $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$。\n首先，计算所需的电压变化：\n$$\\Delta V = V_{\\mathrm{th}} - V_{\\mathrm{rest}} = (-65\\,\\mathrm{mV}) - (-85\\,\\mathrm{mV}) = 20\\,\\mathrm{mV}$$\n现在，计算 $q_{\\mathrm{th}}$。我们必须再次通过将毫伏转换为伏特来确保单位一致性：$20\\,\\mathrm{mV} = 20 \\times 10^{-3}\\,\\mathrm{V}$。法拉是库仑每伏特，$\\mathrm{F} = \\mathrm{C}/\\mathrm{V}$。\n$$q_{\\mathrm{th}} = (1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}) \\times (20\\,\\mathrm{mV}) = (1.0 \\times 10^{-6}\\,\\mathrm{F}\\,\\mathrm{cm}^{-2}) \\times (20 \\times 10^{-3}\\,\\mathrm{V})$$\n$$q_{\\mathrm{th}} = 20 \\times 10^{-9}\\,\\mathrm{F}\\cdot\\mathrm{V}\\,\\mathrm{cm}^{-2} = 20 \\times 10^{-9}\\,\\mathrm{C}\\,\\mathrm{cm}^{-2} = 0.020\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$$\n\n现在我们必须比较 $|q_{\\mathrm{NCX}}|$ 和 $q_{\\mathrm{th}}$ 来确定是否发生触发性搏动。触发性搏动的条件是 $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$。\n我们发现 $|q_{\\mathrm{NCX}}| = 0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$ 和 $q_{\\mathrm{th}} = 0.020\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2}$。\n由于 $0.024 > 0.020$，条件 $|q_{\\mathrm{NCX}}| \\ge q_{\\mathrm{th}}$ 得到满足。\n因此，发生触发性搏动。\n\n根据问题定义，如果发生触发性搏动，振幅由 $A = V_{\\mathrm{peak}} - V_{\\mathrm{rest}}$ 给出。\n使用所提供的值 $V_{\\mathrm{peak}} = +30\\,\\mathrm{mV}$ 和 $V_{\\mathrm{rest}} = -85\\,\\mathrm{mV}$：\n$$A = (+30\\,\\mathrm{mV}) - (-85\\,\\mathrm{mV}) = 30\\,\\mathrm{mV} + 85\\,\\mathrm{mV} = 115\\,\\mathrm{mV}$$\n如果触发性搏动的条件未被满足（即，如果 $|q_{\\mathrm{NCX}}|  q_{\\mathrm{th}}$），振幅将会是亚阈值去极化 $\\Delta V_{\\mathrm{DAD}} = |q_{\\mathrm{NCX}}|/C_m = (0.024\\,\\mu\\mathrm{C}\\,\\mathrm{cm}^{-2})/(1.0\\,\\mu\\mathrm{F}\\,\\mathrm{cm}^{-2}) = 24\\,\\mathrm{mV}$。然而，由于超过了阈值，再生性动作电位被触发，其振幅由峰电位和静息电位决定。\n\n最终计算出的振幅为 $115\\,\\mathrm{mV}$。",
            "answer": "$$\\boxed{115}$$"
        },
        {
            "introduction": "为了使心律失常得以维持，电激动波前必须成功传导，然而传导过程可能会失败，尤其是在组织几何结构发生变化的部位。本练习探讨了“源-汇失配” (source-sink mismatch) 这一控制传导安全性的基本原理，要求通过平衡“源”（前进的波前）提供的电流与“汇”（下游组织）的电容负载，来推导成功传导的条件。这个问题 () 提供了一个具体的例子，说明了组织几何结构（例如，从一个狭窄的峡部扩展到一个宽阔的组织片）如何成为传导阻滞的部位，而传导阻滞是形成折返环路的关键因素。",
            "id": "3905454",
            "problem": "一个厚度为 $t$ 的二维心脏组织板，其上游通过一个半径为 $a$、长度为 $L$ 的圆柱形峡部相连。一个动作电位波前以恒定速度 $c$ 通过该峡部传播到组织板中。该组织由单域模型描述，其各向同性体积电导率为 $\\sigma$ (单位 S/m)，单位面积膜电容为 $C_{m}$ (单位 F/m$^{2}$)，膜面积-体积比为 $\\chi$ (单位 m$^{-1}$)。假设在快速去极化（升支）阶段，离子电流密度主要由起触发作用的快速内向电流主导，而扩散源-汇平衡决定了传播能否成功跨越几何异质性。您可以将峡部下游的去极化需求建模为在升支期间将下游特征体积 $V_{\\text{down}}$ 内的跨膜电位提高 $\\Delta V$ 的需要，并将源建模为在同一时间间隔内通过峡部传递的扩散轴向电流。组织板相对于峡部较宽，因此波前离开峡部后在平面内发散；将必须被带到阈值附近的下游体积近似为一个半径为 $\\lambda$（电紧张延伸范围）的半圆形圆盘沿厚度 $t$ 拉伸而成，因此 $V_{\\text{down}} = \\tfrac{1}{2}\\pi \\lambda^{2} t$。峡部的横截面积为 $A_{i} = \\pi a^{2}$。\n\n仅从单域方程、膜电容和面积-体积比的定义、电荷守恒定律、细胞内介质的欧姆定律以及稳态传播波前的运动学出发，通过将升支期间通过峡部传递的扩散源电荷与去极化下游体积所需的电容性电荷相等，推导出下游成功传播的条件。由此，求出传播到组织板中所需的最小峡部直径 $D^{\\ast} = 2a^{\\ast}$ 的显式表达式。\n\n使用以下符合生理学的参数值：$\\sigma = 0.20$ S/m, $C_{m} = 1.0 \\times 10^{-2}$ F/m$^{2}$, $\\chi = 1.4 \\times 10^{5}$ m$^{-1}$, $c = 0.40$ m/s, $t = 1.5 \\times 10^{-3}$ m, 以及 $\\lambda = 1.0 \\times 10^{-3}$ m。将最终的 $D^{\\ast}$ 以毫米为单位表示，并将您的答案四舍五入到三位有效数字。通过参考对组织厚度和几何发散的依赖性，定性解释为什么该标准预测在狭窄峡部中会发生传导阻滞，而在宽束中会成功传播。",
            "solution": "出发点是单域方程\n$$\n\\chi C_{m} \\frac{\\partial V}{\\partial t} \\;=\\; \\nabla \\cdot \\left( \\sigma \\nabla V \\right) \\;-\\; I_{\\text{ion}},\n$$\n其中 $\\chi$ 是膜面积-体积比，$C_{m}$ 是单位面积膜电容，$\\sigma$ 是体积电导率，$V$ 是跨膜电位，$I_{\\text{ion}}$ 是单位体积的离子电流密度。在快速升支期间，跨越几何瓶颈的传播成功与否由源-汇平衡决定：源是通过峡部可传递的扩散轴向电流，汇是必须被充电至阈值的下游组织体积的电容需求。\n\n将下游体积 $V_{\\text{down}}$ 的电位升高 $\\Delta V$ 所需的电容性电荷由下式给出\n$$\nQ_{\\text{req}} \\;=\\; \\left(\\chi C_{m} V_{\\text{down}}\\right)\\,\\Delta V,\n$$\n因为 $\\chi C_{m}$ 是单位体积的膜电容，而 $\\Delta V$ 是电压增量。\n\n在源一侧，沿峡部的轴向扩散电流密度由欧姆定律给出：\n$$\nJ_{x} \\;=\\; -\\,\\sigma\\,\\frac{\\partial V}{\\partial x}.\n$$\n对于一个以速度 $c$ 在 $+x$ 方向上传播的稳态波前，行波的运动学关系 $V(x,t) = \\hat{V}(x - ct)$ 意味着\n$$\n\\frac{\\partial V}{\\partial t} \\;=\\; -\\,c\\,\\frac{\\partial V}{\\partial x}\n\\quad\\Longrightarrow\\quad\n\\frac{\\partial V}{\\partial x} \\;=\\; -\\,\\frac{1}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\n因此，轴向电流密度变为\n$$\nJ_{x} \\;=\\; -\\,\\sigma\\left(-\\,\\frac{1}{c}\\,\\frac{\\partial V}{\\partial t}\\right)\n\\;=\\; \\frac{\\sigma}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\n通过峡部横截面 $A_{i}$ 的总轴向电流是\n$$\nI_{\\text{src}} \\;=\\; A_{i}\\,J_{x} \\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\frac{\\partial V}{\\partial t}.\n$$\n对升支时间间隔（在此期间电位上升 $\\Delta V$）进行积分，得到总传递电荷：\n$$\nQ_{\\text{del}} \\;=\\; \\int I_{\\text{src}}\\,dt \\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\int \\frac{\\partial V}{\\partial t}\\,dt\n\\;=\\; A_{i}\\,\\frac{\\sigma}{c}\\,\\Delta V.\n$$\n向下游体积传播的安全因子是比率\n$$\n\\text{SF} \\;=\\; \\frac{Q_{\\text{del}}}{Q_{\\text{req}}}\n\\;=\\; \\frac{A_{i}\\,\\dfrac{\\sigma}{c}\\,\\Delta V}{\\left(\\chi C_{m} V_{\\text{down}}\\right)\\,\\Delta V}\n\\;=\\; \\frac{\\sigma\\,A_{i}}{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}.\n$$\n成功传播的最低要求是 $\\text{SF} \\geq 1$，这得出了临界横截面积\n$$\nA_{i}^{\\ast} \\;=\\; \\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\sigma}.\n$$\n对于半径为 $a$ 的圆柱形峡部，$A_{i} = \\pi a^{2}$，所以临界半径是\n$$\na^{\\ast} \\;=\\; \\sqrt{\\frac{A_{i}^{\\ast}}{\\pi}}\n\\;=\\; \\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\pi\\,\\sigma}},\n$$\n临界直径是\n$$\nD^{\\ast} \\;=\\; 2a^{\\ast} \\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,V_{\\text{down}}}{\\pi\\,\\sigma}}.\n$$\n\n对于给定的几何形状，下游体积近似为一个半径为 $\\lambda$ 的半圆形圆盘沿厚度 $t$ 拉伸而成：\n$$\nV_{\\text{down}} \\;=\\; \\frac{1}{2}\\,\\pi\\,\\lambda^{2}\\,t.\n$$\n将此代入 $D^{\\ast}$ 的表达式中，得到\n$$\nD^{\\ast} \\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}}{\\pi\\,\\sigma}\\,\\left(\\frac{1}{2}\\,\\pi\\,\\lambda^{2}\\,t\\right)}\n\\;=\\; 2\\,\\sqrt{\\frac{c\\,\\chi\\,C_{m}\\,\\lambda^{2}\\,t}{2\\,\\sigma}}.\n$$\n\n现在代入数值（在最后一步之前保留符号推理）：$\\sigma = 0.20$ S/m, $C_{m} = 1.0 \\times 10^{-2}$ F/m$^{2}$, $\\chi = 1.4 \\times 10^{5}$ m$^{-1}$, $c = 0.40$ m/s, $t = 1.5 \\times 10^{-3}$ m, $\\lambda = 1.0 \\times 10^{-3}$ m。\n\n首先计算 $V_{\\text{down}}$：\n$$\nV_{\\text{down}} \\;=\\; \\frac{1}{2}\\,\\pi\\,(1.0 \\times 10^{-3})^{2}\\,(1.5 \\times 10^{-3})\n\\;=\\; \\frac{1}{2}\\,\\pi\\,(1.0 \\times 10^{-6})\\,(1.5 \\times 10^{-3})\n\\;=\\; 0.75\\,\\pi \\times 10^{-9}\\ \\text{m}^{3}.\n$$\n计算 $A_{i}^{\\ast}$：\n$$\nA_{i}^{\\ast} \\;=\\; \\frac{(0.40)\\,(1.4 \\times 10^{5})\\,(1.0 \\times 10^{-2})\\,(0.75\\,\\pi \\times 10^{-9})}{0.20}\n\\;=\\; \\frac{(0.40)\\,(1.4 \\times 10^{3})\\,(0.75\\,\\pi \\times 10^{-9})}{0.20}\n\\;=\\; \\frac{420\\,\\pi \\times 10^{-9}}{0.20}\n\\;=\\; 6.59734 \\times 10^{-6}\\ \\text{m}^{2},\n$$\n其中中间简化使用了 $(0.40)\\times(1.4 \\times 10^{3})\\times 0.75 = 420$。临界半径是\n$$\na^{\\ast} \\;=\\; \\sqrt{\\frac{A_{i}^{\\ast}}{\\pi}}\n\\;=\\; \\sqrt{\\frac{6.59734 \\times 10^{-6}}{\\pi}}\n\\;=\\; \\sqrt{2.10000 \\times 10^{-6}}\\ \\text{m}\n\\;=\\; 1.449 \\times 10^{-3}\\ \\text{m},\n$$\n所以临界直径是\n$$\nD^{\\ast} \\;=\\; 2\\,a^{\\ast} \\;=\\; 2.898 \\times 10^{-3}\\ \\text{m} \\;=\\; 2.898\\ \\text{mm}.\n$$\n四舍五入到三位有效数字，得到 $2.90$ mm。\n\n定性解释：临界直径与 $D^{\\ast} \\propto \\sqrt{\\lambda^{2} t}$ 成比例，并随厚度 $t$ 和电紧张延伸范围 $\\lambda$ 的增加而增加，这两者都增大了下游的电容性汇。它随着电导率 $\\sigma$ 的增高而减小，并随着波速 $c$ 和 $\\chi C_{m}$ 的增加而增加，这分别反映了源强度和电容需求。狭窄的峡部（小 $D$）提供的扩散电荷不足以去极化宽组织板中的大发散体积，从而预测发生传导阻滞。相比之下，在宽束内，波前发散较小，有效 $V_{\\text{down}}$ 更接近于一个柱体 $A_{\\text{bundle}}\\lambda$（小于半圆形圆盘），汇减小，同样的源就足够了，从而预测成功传播。",
            "answer": "$$\\boxed{2.90}$$"
        },
        {
            "introduction": "折返 (Reentry) 是威胁生命的心律失常（如心室颤动）的主要机制，通常表现为螺旋波 (spiral waves) 或涡卷波 (scroll waves)。理解这些转子 (rotors) 的动力学对于建模和治疗这类心律失常至关重要。本练习提供了一个运动学模型，用于确定各向异性组织中螺旋波转子的特性，如其旋转周期和核心大小，通过平衡波前围绕未兴奋核心的传播时间与组织的有效不应期来求解。这个动手实践 () 阐明了传导速度各向异性和不应期等基本组织特性如何相互作用，共同决定一个稳定折返环路的特征，从而将细胞层面的参数与器官层面的心律失常动力学联系起来。",
            "id": "3905471",
            "problem": "要求您设计并实现一个程序，通过平衡核心周围的路径长度与局部波前速度，计算心肌组织中螺旋波（转子）的旋转周期和核心几何形状，并分析有效不应期（ERP）和传导各向异性如何调节核心尺寸和转子频率。背景是受反应-扩散动力学控制的均匀二维可兴奋组织，其中可兴奋介质支持螺旋波。推导必须从适用于生物医学系统建模和心脏电生理学的基本原理开始。\n\n使用的基本原理和假设：\n- 从将可兴奋组织中的波前传播解释为一个其局部法向速度取决于组织属性的波前开始。在具有传导各向异性的空间均匀组织中，由于各向异性扩散张量的存在，局部传导速度取决于方向。设主纤维方向为纵向轴，速度为 $v_{\\ell}$，横向速度为 $v_{t}$。\n- 有效不应期（ERP）是组织在激活后恢复可兴奋性所需的最短时间 $T_{\\min}$。对于持续性折返，围绕核心的总传播时间 $T$ 必须满足 $T \\ge \\text{ERP}$。在持续旋转的临界（平衡）情况下，强制执行等式 $T = \\text{ERP}$。\n- 在各向异性介质中，由于速度的方向依赖性，转子核心形成近似椭圆的轨迹。在本问题中，将核心轨迹建模为一个椭圆，其半轴为 $a$（与纵向方向对齐）和 $b$（与横向方向对齐），并假设纵横比由传导速度之比设定，即 $a/b = r$，其中 $r = v_{\\ell}/v_{t}$。设 $s$ 为一个标量尺度因子，使得 $a = r s$ 且 $b = s$。\n- 旋转周期 $T$ 等于局部路径长度元除以沿路径的局部切向传导速度的积分：\n$$\nT = \\int_{0}^{2\\pi} \\frac{ds(\\theta)}{v(\\phi(\\theta))}.\n$$\n此处 $\\theta$ 参数化椭圆，$ds(\\theta)$ 是微分弧长，$v(\\phi(\\theta))$ 是在与纵向轴成 $\\phi(\\theta)$ 角的切线方向上的局部传导速度。\n- 由 $x(\\theta) = a \\cos\\theta$，$y(\\theta) = b \\sin\\theta$ 参数化的椭圆的弧长元为\n$$\nds(\\theta) = \\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}\\, d\\theta = s \\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}\\, d\\theta.\n$$\n- 在主传导速度为 $v_{\\ell}$ 和 $v_{t}$ 的各向异性介质中，沿与纵向轴成 $\\phi$ 角的单位向量的方向相关速度 $v(\\phi)$ 由对角度量关系建模\n$$\n\\frac{1}{v(\\phi)^{2}} = \\frac{\\cos^{2}\\phi}{v_{\\ell}^{2}} + \\frac{\\sin^{2}\\phi}{v_{t}^{2}},\n$$\n这与各向异性介质中的传播一致，其中速度取决于在主轴上的投影。椭圆的单位切线方向是\n$$\n\\hat{\\mathbf{t}}(\\theta) = \\frac{(-a\\sin\\theta,\\; b\\cos\\theta)}{\\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}},\n$$\n因此 $\\cos\\phi(\\theta) = \\hat{t}_{x}(\\theta)$ 且 $\\sin\\phi(\\theta) = \\hat{t}_{y}(\\theta)$。\n\n任务：\n1. 以积分形式推导总旋转时间 $T(s)$ 的表达式\n$$\nT(s) = s \\int_{0}^{2\\pi} \\frac{\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}{v(\\phi(\\theta))}\\, d\\theta,\n$$\n其中 $r = v_{\\ell}/v_{t}$ 且 $a = r s$, $b = s$。证明 $T(s)$ 与 $s$ 呈线性关系。\n2. 施加临界折返平衡条件 $T(s^{\\star}) = \\text{ERP}$ 并求解尺度 $s^{\\star}$，然后计算半轴 $a^{\\star} = r s^{\\star}$ 和 $b^{\\star} = s^{\\star}$。\n3. 报告每个测试用例的旋转周期 $T$（秒）、转子频率 $f = 1/T$（赫兹）以及核心半轴 $a$ 和 $b$（米）。\n\n物理单位：\n- 传导速度 $v_{\\ell}$ 和 $v_{t}$ 必须以米/秒 (m/s) 提供。\n- 有效不应期 $\\text{ERP}$ 必须以秒 (s) 提供。\n- 半轴 $a$ 和 $b$ 必须以米 (m) 报告。\n- 转子周期 $T$ 必须以秒 (s) 报告，转子频率 $f$ 必须以赫兹 (Hz) 报告。\n\n角度单位：\n- 所有角度量（例如，参数 $\\theta$）均以弧度为单位。\n\n答案规格和数值要求：\n- 使用数值积分法评估定义 $T(s)$ 的积分；任何一致的基于黎曼和的方法都是可接受的。\n- 将报告的每个浮点数四舍五入到六位小数。\n- 对于每个测试用例，按顺序 $[T, f, a, b]$ 输出四个浮点数。\n\n测试套件：\n- 案例1（各向同性基线）：$v_{\\ell} = 0.6$ m/s，$v_{t} = 0.6$ m/s，$\\text{ERP} = 0.25$ s。\n- 案例2（中度各向异性）：$v_{\\ell} = 0.8$ m/s，$v_{t} = 0.4$ m/s，$\\text{ERP} = 0.25$ s。\n- 案例3（短不应期）：$v_{\\ell} = 0.6$ m/s，$v_{t} = 0.3$ m/s，$\\text{ERP} = 0.12$ s。\n- 案例4（强各向异性）：$v_{\\ell} = 1.0$ m/s，$v_{t} = 0.2$ m/s，$\\text{ERP} = 0.30$ s。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的所有浮点数结果，按用例顺序平铺成一个逗号分隔的列表，四舍五入到六位小数，并用方括号括起来。例如，格式为 $[T_{1}, f_{1}, a_{1}, b_{1}, T_{2}, f_{2}, a_{2}, b_{2}, T_{3}, f_{3}, a_{3}, b_{3}, T_{4}, f_{4}, a_{4}, b_{4}]$。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上植根于心脏电生理学和反应-扩散系统的原理，在数学上是适定的、客观的，并包含了推导唯一解所需的所有必要信息。\n\n该问题要求推导和计算二维各向异性可兴奋介质中螺旋波转子的属性。解决方案首先推导旋转周期 $T$ 的解析表达式，然后使用给定的平衡条件确定转子核心的几何形状，最后将这些结果应用于指定的测试用例。\n\n### 步骤1：推导转子周期 $T(s)$\n\n起点是围绕闭合路径的传播时间 $T$ 的通用公式，即微分弧长 $ds$ 除以局部传播速度 $v$ 的积分：\n$$\nT = \\oint \\frac{ds}{v}\n$$\n问题为椭圆核心轨迹提供了一个参数化表示，以及相关的弧长元 $ds(\\theta)$ 和方向相关速度 $v(\\phi(\\theta))$ 的表达式。转子周期 $T$ 作为尺度参数 $s$ 的函数由下式给出：\n$$\nT(s) = s \\int_{0}^{2\\pi} \\frac{\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}{v(\\phi(\\theta))}\\, d\\theta\n$$\n其中 $r = v_{\\ell}/v_{t}$ 是各向异性比率，$v_{\\ell}$ 和 $v_{t}$ 分别是纵向和横向传导速度，$\\theta$ 是椭圆角参数。我们的首要任务是计算被积函数。\n\n与纵向轴成 $\\phi$ 角的局部传导速度 $v(\\phi)$ 由以下关系式给出：\n$$\n\\frac{1}{v(\\phi)^{2}} = \\frac{\\cos^{2}\\phi}{v_{\\ell}^{2}} + \\frac{\\sin^{2}\\phi}{v_{t}^{2}}\n$$\n角 $\\phi(\\theta)$ 对应于椭圆在参数 $\\theta$ 处的切向量方向。椭圆路径为 $(x(\\theta), y(\\theta)) = (a\\cos\\theta, b\\sin\\theta)$，其中 $a=rs$ 且 $b=s$。未归一化的切向量是 $(x'(\\theta), y'(\\theta)) = (-a\\sin\\theta, b\\cos\\theta)$。单位切向量 $\\hat{\\mathbf{t}}(\\theta)$ 提供了分量 $\\cos\\phi(\\theta)$ 和 $\\sin\\phi(\\theta)$：\n$$\n\\cos\\phi(\\theta) = \\frac{-a\\sin\\theta}{\\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}}\n$$\n$$\n\\sin\\phi(\\theta) = \\frac{b\\cos\\theta}{\\sqrt{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}}\n$$\n将这些代入 $1/v(\\phi)^2$ 的表达式中：\n$$\n\\frac{1}{v(\\phi(\\theta))^{2}} = \\frac{1}{v_{\\ell}^{2}} \\left( \\frac{a^{2}\\sin^{2}\\theta}{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta} \\right) + \\frac{1}{v_{t}^{2}} \\left( \\frac{b^{2}\\cos^{2}\\theta}{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta} \\right)\n$$\n$$\n\\frac{1}{v(\\phi(\\theta))^{2}} = \\frac{a^{2}\\sin^{2}\\theta/v_{\\ell}^{2} + b^{2}\\cos^{2}\\theta/v_{t}^{2}}{a^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta}\n$$\n现在，我们代入 $a = rs$，$b = s$ 以及 $v_{t} = v_{\\ell}/r$：\n$$\n\\frac{a^{2}}{v_{\\ell}^{2}} = \\frac{(rs)^{2}}{v_{\\ell}^{2}} = \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\n$$\n$$\n\\frac{b^{2}}{v_{t}^{2}} = \\frac{s^{2}}{(v_{\\ell}/r)^{2}} = \\frac{s^{2}r^{2}}{v_{\\ell}^{2}}\n$$\n$1/v(\\phi(\\theta))^2$ 表达式的分子变为：\n$$\n\\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\\sin^{2}\\theta + \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\\cos^{2}\\theta = \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}(\\sin^{2}\\theta + \\cos^{2}\\theta) = \\frac{r^{2}s^{2}}{v_{\\ell}^{2}}\n$$\n分母是：\n$$\na^{2}\\sin^{2}\\theta + b^{2}\\cos^{2}\\theta = (rs)^{2}\\sin^{2}\\theta + s^{2}\\cos^{2}\\theta = s^{2}(r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta)\n$$\n将它们合并，我们得到：\n$$\n\\frac{1}{v(\\phi(\\theta))^{2}} = \\frac{r^{2}s^{2}/v_{\\ell}^{2}}{s^{2}(r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta)} = \\frac{r^{2}}{v_{\\ell}^{2}(r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta)}\n$$\n取平方根得到速度倒数的表达式：\n$$\n\\frac{1}{v(\\phi(\\theta))} = \\frac{r}{v_{\\ell}\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}\n$$\n现在，我们可以计算 $T(s)$ 的被积函数。被积函数是该项与弧长定义中的项的乘积：\n$$\n\\text{被积函数} = \\frac{\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}}{v(\\phi(\\theta))} = \\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta} \\cdot \\left( \\frac{r}{v_{\\ell}\\sqrt{r^{2}\\sin^{2}\\theta + \\cos^{2}\\theta}} \\right) = \\frac{r}{v_{\\ell}}\n$$\n被积函数简化为一个常数。这个优美的结果表明，对于这个特定的椭圆路径，弧长的几何复杂性被传播速度的几何依赖性完美地平衡了。因此，问题中提到的数值积分要求因这一解析简化而变得不再必要。\n\n周期 $T(s)$ 的积分变为：\n$$\nT(s) = s \\int_{0}^{2\\pi} \\frac{r}{v_{\\ell}} \\, d\\theta = s \\frac{r}{v_{\\ell}} [\\theta]_{0}^{2\\pi} = s \\frac{2\\pi r}{v_{\\ell}}\n$$\n该表达式表明 $T(s)$ 确实与尺度因子 $s$ 呈线性关系，比例常数为 $K = 2\\pi r / v_{\\ell}$。\n\n### 步骤2：求解核心几何形状\n问题陈述指出，对于处于稳定性边缘的持续转子，其旋转周期必须等于有效不应期（ERP）：\n$$\nT(s^{\\star}) = \\text{ERP}\n$$\n其中 $s^{\\star}$ 是满足此条件的特定尺度因子。\n$$\ns^{\\star} \\frac{2\\pi r}{v_{\\ell}} = \\text{ERP}\n$$\n求解 $s^{\\star}$：\n$$\ns^{\\star} = \\text{ERP} \\cdot \\frac{v_{\\ell}}{2\\pi r}\n$$\n代入 $r = v_{\\ell}/v_t$：\n$$\ns^{\\star} = \\text{ERP} \\cdot \\frac{v_{\\ell}}{2\\pi (v_{\\ell}/v_t)} = \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi}\n$$\n这就给出了尺度因子 $s^{\\star}$。现在可以确定椭圆核心的半轴 $a^{\\star}$ 和 $b^{\\star}$：\n短半轴是：\n$$\nb^{\\star} = s^{\\star} = \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi}\n$$\n长半轴是：\n$$\na^{\\star} = r s^{\\star} = \\frac{v_{\\ell}}{v_{t}} \\cdot \\left( \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi} \\right) = \\frac{\\text{ERP} \\cdot v_{\\ell}}{2\\pi}\n$$\n\n### 步骤3：测试用例计算\n对于每个测试用例，我们都给定了 $v_{\\ell}$、$v_{t}$ 和 $\\text{ERP}$。现在我们可以计算所需的量。\n1.  **旋转周期 ($T$)**：根据临界稳定性条件，周期就是 ERP。$T = \\text{ERP}$。\n2.  **转子频率 ($f$)**：频率是周期的倒数。$f = 1/T = 1/\\text{ERP}$。\n3.  **核心半轴 ($a, b$)**：使用推导出的公式计算半轴：\n    $$\n    a = \\frac{\\text{ERP} \\cdot v_{\\ell}}{2\\pi}\n    $$\n    $$\n    b = \\frac{\\text{ERP} \\cdot v_{t}}{2\\pi}\n    $$\n这些公式将被实现以计算所提供测试套件的结果。所有数值结果将按要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for spiral wave rotor properties based on a kinematic model in anisotropic tissue.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (v_l, v_t, ERP)\n    # v_l: longitudinal velocity (m/s)\n    # v_t: transverse velocity (m/s)\n    # ERP: effective refractory period (s)\n    test_cases = [\n        (0.6, 0.6, 0.25),  # Case 1 (isotropic baseline)\n        (0.8, 0.4, 0.25),  # Case 2 (moderate anisotropy)\n        (0.6, 0.3, 0.12),  # Case 3 (short refractory period)\n        (1.0, 0.2, 0.30),  # Case 4 (strong anisotropy)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        v_l, v_t, erp = case\n        \n        # 1. Calculate the rotation period T and frequency f.\n        # At the marginal stability condition for sustained reentry, the rotation period\n        # T is equal to the Effective Refractory Period (ERP).\n        # T is in seconds (s).\n        T = erp\n        \n        # The frequency f is the reciprocal of the period T.\n        # f is in hertz (Hz).\n        f = 1.0 / T\n        \n        # 2. Calculate the core semiaxes a and b.\n        # The derivation shows that the semiaxes are given by:\n        # a = (ERP * v_l) / (2 * pi)\n        # b = (ERP * v_t) / (2 * pi)\n        # a and b are in meters (m).\n        \n        a = (erp * v_l) / (2 * np.pi)\n        b = (erp * v_t) / (2 * np.pi)\n        \n        # 3. Round results to six decimal places as required.\n        T_rounded = round(T, 6)\n        f_rounded = round(f, 6)\n        a_rounded = round(a, 6)\n        b_rounded = round(b, 6)\n        \n        # Append the four calculated values for the current case to the results list.\n        results.extend([T_rounded, f_rounded, a_rounded, b_rounded])\n\n    # Final print statement in the exact required format.\n    # Example format: [T1,f1,a1,b1,T2,f2,a2,b2,...]\n    # The map(str, ...) converts each float to a string for joining.\n    # The \"g\" format specifier is used to avoid trailing zeros for whole numbers like 4.0\n    # but the problem asks for floats, so a direct str() conversion of the rounded\n    # floats is appropriate. Let's ensure format consistency. The requirement to\n    # round to 6 places implies a fixed-point representation might be desired.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}