{
    "hands_on_practices": [
        {
            "introduction": "A primary goal of agent-based modeling is to understand how macroscopic patterns emerge from the simple, local rules governing individual agents. This first practice establishes one of the most fundamental links of this kind: the connection between a discrete random walk and continuous diffusion. By deriving the effective diffusion coefficient from first principles, you will gain insight into how to parameterize and validate continuum models based on observed microscopic agent behavior.",
            "id": "3870843",
            "problem": "An Agent-Based Model (ABM) of immune cell patrolling is implemented on a two-dimensional square lattice to represent a thin tissue section of the tumor microenvironment. A single cytotoxic T lymphocyte (CTL) agent starts at the origin and, at each discrete time increment $\\,\\Delta t\\,$, moves exactly one lattice step of length $\\,h\\,$ to one of the four nearest-neighbor sites with equal probability. The environment is homogeneous and isotropic, and there are no external cues (no chemotaxis), so the walk is unbiased. The agent’s position at time $\\,t\\,$ is modeled as the cumulative sum of its independent, identically distributed lattice displacements.\n\nStarting from first principles appropriate to biomedical systems modeling and stochastic processes, justify the passage from the discrete-time, discrete-space unbiased random walk to a continuous-space, continuous-time description for the probability density $\\,p(x,y,t)\\,$ of the agent’s position. From this continuum description and the definition of the diffusion coefficient for isotropic spreading in two spatial dimensions, derive the effective diffusion coefficient $\\,D\\,$ as a function of the lattice step size $\\,h\\,$ and the time step $\\,\\Delta t\\,$.\n\nYour final answer must be a single, closed-form symbolic expression for $\\,D\\,$ in terms of $\\,h\\,$ and $\\,\\Delta t\\,$. Do not substitute numerical values. If $\\,h\\,$ is measured in micrometers and $\\,\\Delta t\\,$ in seconds, express the diffusion coefficient in micrometer squared per second. No rounding is required.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, and objective. It describes a standard physical model—a discrete random walk—and asks for a rigorous derivation of its continuum limit, a fundamental procedure in statistical physics and its applications in biology. All necessary parameters are provided, and there are no contradictions or ambiguities. The problem is valid.\n\nThe problem asks for the justification of the passage from a discrete-time, discrete-space random walk to a continuous diffusion equation, and the subsequent derivation of the effective diffusion coefficient, $D$.\n\nLet the position of the cytotoxic T lymphocyte (CTL) agent on the two-dimensional square lattice be given by coordinates $(x, y)$, which are integer multiples of the lattice step size, $h$. Let $P(x, y, t)$ be the probability of finding the agent at site $(x, y)$ at time $t$, where time is a multiple of the discrete time increment, $\\Delta t$.\n\nThe agent's movement is a discrete-time Markov process. At each time step $t$, the agent at $(x, y)$ moves to one of its four nearest neighbors $(x+h, y)$, $(x-h, y)$, $(x, y+h)$, or $(x, y-h)$ with equal probability of $\\frac{1}{4}$. The probability of being at site $(x, y)$ at time $t + \\Delta t$ depends on the probabilities of being at the neighboring sites at time $t$. This relationship is described by the master equation for the process:\n$$P(x, y, t + \\Delta t) = \\frac{1}{4} \\left[ P(x-h, y, t) + P(x+h, y, t) + P(x, y-h, t) + P(x, y+h, t) \\right]$$\n\nTo justify and perform the passage to a continuous description, we assume that $P(x, y, t)$ can be approximated by a smooth, twice-differentiable probability density function, $p(x, y, t)$. This assumption is valid on spatial and temporal scales much larger than the elementary step size $h$ and time step $\\Delta t$, respectively. We analyze the master equation by performing a Taylor series expansion of the function $p(x, y, t)$ around the point $(x, y, t)$.\n\nThe left-hand side of the master equation is expanded in time:\n$$p(x, y, t + \\Delta t) = p(x, y, t) + \\frac{\\partial p}{\\partial t} \\Delta t + O((\\Delta t)^2)$$\n\nThe terms on the right-hand side are expanded in space around $(x, y)$:\n$$p(x \\pm h, y, t) = p(x, y, t) \\pm h \\frac{\\partial p}{\\partial x} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial x^2} \\pm \\frac{h^3}{6} \\frac{\\partial^3 p}{\\partial x^3} + O(h^4)$$\n$$p(x, y \\pm h, t) = p(x, y, t) \\pm h \\frac{\\partial p}{\\partial y} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial y^2} \\pm \\frac{h^3}{6} \\frac{\\partial^3 p}{\\partial y^3} + O(h^4)$$\n\nSubstituting these expansions into the right-hand side of the master equation:\n$$ \\frac{1}{4} \\left[ (p - h \\frac{\\partial p}{\\partial x} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial x^2}) + (p + h \\frac{\\partial p}{\\partial x} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial x^2}) + (p - h \\frac{\\partial p}{\\partial y} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial y^2}) + (p + h \\frac{\\partial p}{\\partial y} + \\frac{h^2}{2} \\frac{\\partial^2 p}{\\partial y^2}) \\right] + \\dots $$\nwhere we have truncated terms of order $h^3$ and higher. Due to the symmetry of the walk, the first-order derivative terms (and all odd-order terms) cancel upon summation:\n$$ \\frac{1}{4} \\left[ 4p(x,y,t) + h^2 \\left( \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} \\right) \\right] + O(h^4) = p(x,y,t) + \\frac{h^2}{4} \\nabla^2 p(x,y,t) + O(h^4) $$\nwhere $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the Laplacian operator in two dimensions.\n\nNow we equate the expanded left-hand side and right-hand side:\n$$ p(x, y, t) + \\frac{\\partial p}{\\partial t} \\Delta t + O((\\Delta t)^2) = p(x, y, t) + \\frac{h^2}{4} \\nabla^2 p(x,y,t) + O(h^4) $$\n\nSubtracting $p(x, y, t)$ from both sides gives:\n$$ \\frac{\\partial p}{\\partial t} \\Delta t + O((\\Delta t)^2) = \\frac{h^2}{4} \\nabla^2 p + O(h^4) $$\n\nDividing by $\\Delta t$:\n$$ \\frac{\\partial p}{\\partial t} + O(\\Delta t) = \\frac{h^2}{4\\Delta t} \\nabla^2 p + O\\left(\\frac{h^4}{\\Delta t}\\right) $$\n\nThe passage from the discrete master equation to a continuous partial differential equation is justified in the diffusive limit, where $\\Delta t \\to 0$ and $h \\to 0$ simultaneously, such that the ratio $\\frac{h^2}{\\Delta t}$ remains finite and non-zero. In this limit, the higher-order terms $O(\\Delta t)$ and $O(\\frac{h^4}{\\Delta t})$ vanish. This yields the continuum equation:\n$$ \\frac{\\partial p}{\\partial t} = \\left( \\frac{h^2}{4\\Delta t} \\right) \\nabla^2 p $$\n\nThis equation has the form of the standard isotropic diffusion equation (also known as Fick's second law) in two dimensions:\n$$ \\frac{\\partial p}{\\partial t} = D \\nabla^2 p $$\nwhere $D$ is the effective diffusion coefficient.\n\nBy comparing the derived equation with the standard form, we can identify a direct expression for the diffusion coefficient $D$:\n$$ D = \\frac{h^2}{4\\Delta t} $$\nThis expression gives the effective diffusion coefficient for an agent performing an unbiased random walk on a two-dimensional square lattice with step size $h$ and time step $\\Delta t$.\n\nThe units of $D$ are determined by the units of $h$ and $\\Delta t$. If $h$ is measured in micrometers ($\\mu m$) and $\\Delta t$ is in seconds ($s$), then the units of $D$ are $(\\mu m)^2 / s$, or $\\mu m^2 s^{-1}$, which is a standard unit for diffusion coefficients in cell biology.",
            "answer": "$$\\boxed{\\frac{h^2}{4 \\Delta t}}$$"
        },
        {
            "introduction": "Interactions between agents drive the dynamics of most complex biological systems, from immune surveillance to disease transmission. Before we can model the consequences of these interactions, we must first quantify how often they occur. This exercise provides a foundational method for calculating the expected number of agent-agent encounters in a spatially random environment, linking key model parameters like agent density and interaction radius to a critical emergent property.",
            "id": "3870809",
            "problem": "Consider a two-dimensional ($2$-D) off-lattice Agent-Based Model (ABM) of immune effector cells surveying a tumor monolayer. At each discrete time step, assume the instantaneous positions of all agents are distributed as a homogeneous Poisson point process on the plane with intensity $\\rho$ (agents per unit area), reflecting motility-driven spatial randomness and the absence of spatial correlation at the scale of interest. A binary \"contact\" is recorded for a focal agent whenever another agent lies within an interaction radius $r$ of the focal agent's position at that time step. Assume the focal agent is located at least a distance $r$ from any boundary so that edge effects are negligible, and that self-contact is excluded. Using only fundamental properties of the homogeneous Poisson point process and standard definitions, derive a closed-form analytic expression, in terms of $\\rho$ and $r$, for the expected number of agent-agent contacts observed by this focal agent in a single time step. Express your final answer as an exact analytic expression. The expected number of contacts is a dimensionless quantity; no rounding is required.",
            "solution": "The problem asks for the derivation of the expected number of agent-agent contacts for a focal agent in a single, discrete time step. The agent positions are modeled as a homogeneous Poisson point process.\n\nLet the set of agent positions on the two-dimensional plane, $\\mathbb{R}^{2}$, be a realization of a homogeneous Poisson point process, denoted by $\\Phi$, with a constant intensity $\\rho$. The intensity $\\rho$ represents the average number of agents per unit area.\n\nA \"contact\" event for a focal agent is defined by the presence of at least one other agent within a circular region of radius $r$ centered on the focal agent. We are tasked with finding the expected number of such contacts, which is equivalent to finding the expected number of other agents within this circular region.\n\nDue to the stationarity (or spatial homogeneity) of the Poisson point process, the statistical properties of the process are invariant under translation. This allows us to place the focal agent at any convenient location without loss of generality. We choose the origin, $(0,0)$, as the position of our focal agent.\n\nThe problem specifies that self-contact is excluded. This is a critical detail. We are interested in the number of agents from the process $\\Phi$ that fall within the interaction region, given that our focal agent (which is itself a point of $\\Phi$) is at the origin. A fundamental property of a stationary Poisson point process, a consequence of the Slivnyak-Mecke theorem, states that conditioning on a point of the process existing at the origin does not change the distribution of the remaining points. Therefore, the positions of all *other* agents still constitute a homogeneous Poisson point process with the same intensity $\\rho$.\n\nThe region of interaction around the focal agent at the origin is an open disk of radius $r$, which we denote as $D_r$. The area of this disk, $A(D_r)$, is given by:\n$$A(D_r) = \\pi r^{2}$$\nThe problem states that we can neglect edge effects, which justifies our use of a complete disk on the infinite plane $\\mathbb{R}^{2}$.\n\nLet $N_c$ be the random variable representing the number of contacts for the focal agent. This is precisely the number of other agents located within the disk $D_r$. For a homogeneous Poisson point process with intensity $\\rho$, the number of points in any bounded region $B \\subset \\mathbb{R}^{2}$, let's call this count $N(B)$, follows a Poisson distribution. The expected value (mean) of this distribution is given by the product of the intensity and the area of the region:\n$$E[N(B)] = \\rho \\cdot \\text{Area}(B)$$\n\nApplying this property to our problem, the number of contacts $N_c$ is the number of points from the process of \"other agents\" (which has intensity $\\rho$) that fall into the region $D_r$. The expected number of contacts, $E[N_c]$, is therefore:\n$$E[N_c] = \\rho \\cdot A(D_r)$$\nSubstituting the expression for the area of the disk, we obtain the final expression:\n$$E[N_c] = \\rho \\pi r^{2}$$\nThis expression is a closed-form analytic result in terms of the given parameters $\\rho$ and $r$. The dimensional consistency is confirmed as $\\rho$ has dimensions of $[\\text{length}]^{-2}$ and $r^{2}$ has dimensions of $[\\text{length}]^{2}$, resulting in a dimensionless quantity for the expected number of contacts, as required by the problem statement.",
            "answer": "$$\\boxed{\\rho \\pi r^{2}}$$"
        },
        {
            "introduction": "The dynamics of cell populations, such as the initial growth of a tumor or the clonal expansion of lymphocytes, are inherently stochastic processes where survival is not guaranteed. This practice introduces the Galton-Watson branching process, a powerful framework for analyzing the fate of a population originating from a single founder. By calculating the ultimate probability of extinction, you will learn to assess a population's viability based on the probabilistic outcomes of individual cell division and death.",
            "id": "3870840",
            "problem": "In an Agent-Based Model (ABM; Agent-Based Model) of a proliferating tumor cell clone, each agent represents a single viable tumor cell. At the end of each cell cycle, an agent is replaced by a random number of viable daughters according to the following biologically plausible outcomes, assumed independent and identically distributed across agents and generations:\n- Apoptosis produces no viable daughters with probability $p_0$.\n- Asymmetric division (for example, one viable daughter retained and one non-viable outcome) produces one viable daughter with probability $p_1$.\n- Symmetric division produces two viable daughters with probability $p_2$.\nAssume there are no other outcomes, so $p_0 + p_1 + p_2 = 1$. The initial population consists of a single viable cell.\n\nLet $K$ denote the number of viable daughters produced by a single cell at the end of its cycle, and let the offspring generating function $f(s)$ be defined by $f(s) = \\mathbb{E}[s^{K}]$ for $s \\in [0,1]$. Using only the core definition of the offspring generating function and the independence structure of the Galton–Watson branching process, derive the expression that determines the extinction probability $q$ of the clone starting from one initial cell, and then compute $q$ for each of the following parameter sets:\n- Set A: $p_0 = 0.55$, $p_1 = 0.25$, $p_2 = 0.20$.\n- Set B: $p_0 = 0.20$, $p_1 = 0.15$, $p_2 = 0.65$.\n\nExpress your final answer as a row matrix in the order (Set A, Set B). If any value is an exact rational number, present it in exact fractional form; otherwise, present the exact algebraic value. No rounding is required. The extinction probability is dimensionless; do not include units.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It provides a complete and consistent setup for a standard problem in the theory of branching processes, which is a common tool in biomedical systems modeling. The problem is therefore deemed valid.\n\nThe model described is a Galton-Watson branching process. Let $Z_n$ be the number of viable tumor cells in generation $n$, with the initial condition $Z_0=1$. The number of offspring (viable daughters) $K$ produced by a single cell is a random variable with the following probability distribution:\n$$\n\\mathbb{P}(K=k) =\n\\begin{cases}\np_0  \\text{for } k=0 \\\\\np_1  \\text{for } k=1 \\\\\np_2  \\text{for } k=2 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe problem requires the use of the offspring generating function $f(s)$, defined as $f(s) = \\mathbb{E}[s^{K}]$. Using the definition of expected value for a discrete random variable, we have:\n$$\nf(s) = \\sum_{k=0}^{\\infty} \\mathbb{P}(K=k)s^k = p_0 s^0 + p_1 s^1 + p_2 s^2 = p_0 + p_1s + p_2s^2\n$$\nThe problem asks for the derivation of the expression that determines the extinction probability, $q$. The extinction probability is defined as $q = \\mathbb{P}(\\text{extinction} | Z_0=1)$. The event of \"extinction\" means that the population size becomes $0$ at some generation. Let $q_n = \\mathbb{P}(Z_n=0 | Z_0=1)$ be the probability that the population is extinct by generation $n$. The sequence $\\{q_n\\}_{n \\ge 0}$ is non-decreasing and bounded above by $1$, so its limit $q = \\lim_{n \\to \\infty} q_n$ exists and is the extinction probability.\n\nThe population $Z_{n+1}$ is the sum of the offspring of the $Z_n$ individuals in the previous generation. The population is extinct at generation $n+1$ if and only if all offspring lineages from the single initial cell have died out by generation $n+1$. This is equivalent to saying that for each of the $K$ offspring of the initial cell, its own sub-branching process (which is statistically identical to the original process) goes extinct within $n$ generations. Due to the independence of these sub-processes, we can write a recurrence relation for $q_{n+1}$ in terms of $q_n$:\n$$\nq_{n+1} = \\mathbb{P}(Z_{n+1}=0) = \\sum_{k=0}^{2} \\mathbb{P}(Z_{n+1}=0|K=k)\\mathbb{P}(K=k) = \\sum_{k=0}^{2} (q_n)^k p_k\n$$\nThis gives $q_{n+1} = p_0(q_n)^0 + p_1(q_n)^1 + p_2(q_n)^2 = f(q_n)$. Taking the limit as $n \\to \\infty$, and using the continuity of the polynomial function $f(s)$, we find that $q$ must be a fixed point of $f(s)$:\n$$\nq = f(q)\n$$\nTherefore, the extinction probability $q$ is a solution to the equation $s = f(s)$. Substituting the expression for $f(s)$, we get:\n$$\ns = p_0 + p_1s + p_2s^2\n$$\nThis can be rearranged into a standard quadratic equation:\n$$\np_2s^2 + (p_1-1)s + p_0 = 0\n$$\nWe are given the constraint $p_0+p_1+p_2=1$, which implies $p_1-1 = -p_0-p_2$. Substituting this into the quadratic equation gives:\n$$\np_2s^2 - (p_0+p_2)s + p_0 = 0\n$$\nWe can observe that $s=1$ is a root: $p_2(1)^2 - (p_0+p_2)(1) + p_0 = p_2 - p_0 - p_2 + p_0 = 0$. Since $s=1$ is a root, $(s-1)$ must be a factor of the quadratic polynomial. Factoring the polynomial yields:\n$$\n(s-1)(p_2s - p_0) = 0\n$$\nThe two roots of the equation $s=f(s)$ are therefore $s=1$ and $s = \\frac{p_0}{p_2}$ (if $p_2 \\ne 0$). If $p_2=0$, the equation is linear and the only root is $s=1$.\n\nA fundamental theorem of branching processes states that the extinction probability $q$ is the smallest non-negative root of the equation $s=f(s)$. Thus, we must choose the smaller of the two roots, $1$ and $\\frac{p_0}{p_2}$. The probabilities $p_0$ and $p_2$ are non-negative, so the root $\\frac{p_0}{p_2}$ is non-negative. Therefore, the extinction probability is given by:\n$$\nq = \\min\\left(1, \\frac{p_0}{p_2}\\right)\n$$\nThis result is tied to the mean number of offspring, $\\mu = \\mathbb{E}[K] = f'(1) = p_1 + 2p_2$. If $\\mu \\le 1$, extinction is certain ($q=1$). If $\\mu  1$, there is a positive probability of survival, so $q  1$. The condition $\\mu  1$ is equivalent to $p_1+2p_2  1 = p_0+p_1+p_2$, which simplifies to $p_2  p_0$, or $\\frac{p_0}{p_2}  1$. Thus, the derived expression for $q$ is consistent with the general theory.\n\nNow we compute $q$ for the two given parameter sets.\n\n**Set A:** $p_0 = 0.55$, $p_1 = 0.25$, $p_2 = 0.20$.\nFirst, we compute the ratio $\\frac{p_0}{p_2}$:\n$$\n\\frac{p_0}{p_2} = \\frac{0.55}{0.20} = \\frac{55}{20} = \\frac{11}{4}\n$$\nThe extinction probability $q_A$ is the minimum of $1$ and $\\frac{11}{4}$:\n$$\nq_A = \\min\\left(1, \\frac{11}{4}\\right) = 1\n$$\nAlternatively, the mean number of offspring is $\\mu_A = p_1 + 2p_2 = 0.25 + 2(0.20) = 0.25 + 0.40 = 0.65$. Since $\\mu_A \\le 1$, the extinction probability is $1$.\n\n**Set B:** $p_0 = 0.20$, $p_1 = 0.15$, $p_2 = 0.65$.\nFirst, we compute the ratio $\\frac{p_0}{p_2}$:\n$$\n\\frac{p_0}{p_2} = \\frac{0.20}{0.65} = \\frac{20}{65} = \\frac{4}{13}\n$$\nThe extinction probability $q_B$ is the minimum of $1$ and $\\frac{4}{13}$:\n$$\nq_B = \\min\\left(1, \\frac{4}{13}\\right) = \\frac{4}{13}\n$$\nAlternatively, the mean number of offspring is $\\mu_B = p_1 + 2p_2 = 0.15 + 2(0.65) = 0.15 + 1.30 = 1.45$. Since $\\mu_B  1$, the extinction probability is less than $1$, confirming that $q_B = \\frac{4}{13}$ is the correct root.\n\nThe final answer is a row matrix of the extinction probabilities for Set A and Set B.\nFor Set A, $q_A = 1$.\nFor Set B, $q_B = \\frac{4}{13}$.\nThe final answer is presented in the required matrix format.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{4}{13} \\end{pmatrix}}\n$$"
        }
    ]
}