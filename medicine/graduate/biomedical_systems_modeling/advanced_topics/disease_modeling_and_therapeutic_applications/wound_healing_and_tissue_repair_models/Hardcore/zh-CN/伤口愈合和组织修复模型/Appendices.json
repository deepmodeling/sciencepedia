{
    "hands_on_practices": [
        {
            "introduction": "细胞对生长因子等信号的响应，其起点是分子层面的受体-配体结合过程。解离常数 $K_d$ 是量化这种相互作用亲和力的核心参数，它决定了信号通路的灵敏度。本练习将引导你通过分析经典的平衡结合实验数据，来估算血小板衍生生长因子（PDGF）与其受体结合的 $K_d$ 值，这是为更复杂的细胞信号模型进行参数化的基础技能 。",
            "id": "3944714",
            "problem": "在伤口愈合过程中，成纤维细胞的趋化和增殖是由受体介导的信号传导驱动的，该信号传导在血小板衍生生长因子 (PDGF) 与其细胞表面受体结合时启动。考虑一种单一细胞类型，其受体与配体之间存在一对一的可逆结合，可用反应 $R + L \\rightleftharpoons RL$ 来建模，其中 $R$ 表示游离受体，$L$ 表示游离配体，$RL$ 表示受体-配体复合物。假设与下游响应相比，结合平衡的建立速度很快，且每个受体只有一个非相互作用的结合位点。每个细胞的总受体数量 $R_{\\text{tot}}$ 经独立测量为每个细胞 $9.0 \\times 10^{4}$ 个分子。\n\n在温度 $37^{\\circ}\\text{C}$ 下，对每个细胞平均结合受体数 $RL(c)$ 作为 PDGF 浓度 $c$ (单位为 nM) 的函数的平衡测量，得到了以下数据：\n- 当 $c = 0.5\\,\\text{nM}$ 时，$RL = 1.80 \\times 10^{4}$ 个分子/细胞。\n- 当 $c = 1.0\\,\\text{nM}$ 时，$RL = 3.00 \\times 10^{4}$ 个分子/细胞。\n- 当 $c = 2.0\\,\\text{nM}$ 时，$RL = 4.50 \\times 10^{4}$ 个分子/细胞。\n- 当 $c = 5.0\\,\\text{nM}$ 时，$RL = 6.43 \\times 10^{4}$ 个分子/细胞。\n- 当 $c = 10.0\\,\\text{nM}$ 时，$RL = 7.50 \\times 10^{4}$ 个分子/细胞。\n\n从反应 $R + L \\rightleftharpoons RL$ 的基本质量作用定律描述出发，并结合平衡解离常数 $K_{d}$ 以微观速率常数表示的定义，推导出连接 $R_{\\text{free}}$、$RL$ 和 $c$ 的平衡结合关系。使用此关系和所提供的平衡结合数据，估算 PDGF-受体结合的解离常数 $K_{d}$。然后，通过将受体占有率与信号饱和度联系起来，论证在成纤维细胞响应的常微分方程 (ODE) 模型中，$K_{d}$ 如何进入形如 $S(c) = S_{\\max} \\, c/(K_{d} + c)$ 的下游有效信号项。\n\n报告估算出的 $K_{d}$ 值，四舍五入至三位有效数字。最终的 $K_{d}$ 值以 nM 为单位表示。",
            "solution": "问题陈述描述了一个经典的单位点、可逆的配体-受体结合平衡，这是药理学和细胞信号传导中的一个基本概念。该问题具有科学依据、提法明确且客观。它提供了充分且一致的数据来进行求解。给定的 $37^{\\circ}\\text{C}$ 温度确定了生理背景，但不直接进入计算，因为解离常数 $K_{d}$ 是在这些特定的等温条件下定义的。\n\n首先，我们推导平衡结合关系。反应式如下：\n$$R + L \\rightleftharpoons RL$$\n其中 $R$ 代表游离受体，$L$ 代表游离配体，$RL$ 代表受体-配体复合物。根据质量作用定律，复合物形成的正向速率与游离受体和游离配体的浓度乘积成正比，即 $k_{\\text{on}}[R][L]$，而复合物解离的逆向速率与复合物的浓度成正比，即 $k_{\\text{off}}[RL]$。在平衡状态下，这两个速率相等：\n$$k_{\\text{on}}[R][L] = k_{\\text{off}}[RL]$$\n平衡解离常数 $K_{d}$ 定义为解离速率常数与结合速率常数之比：\n$$K_{d} = \\frac{k_{\\text{off}}}{k_{\\text{on}}} = \\frac{[R][L]}{[RL]}$$\n在本问题中，受体物质的浓度以每个细胞的分子数给出，这与其在细胞表面的有效浓度成正比。配体浓度以摩尔浓度 $c$ 给出。设 $R_{\\text{free}}$ 表示每个细胞的游离受体数，$RL$ 表示每个细胞的结合受体数。游离配体浓度为 $c$。因此，连接这些量的平衡关系是：\n$$K_{d} = \\frac{R_{\\text{free}} \\cdot c}{RL}$$\n这就是所要求的基本关系。为了便于数据分析，我们用每个细胞的总受体数 $R_{\\text{tot}}$ 来表示它。受体总数是守恒的：\n$$R_{\\text{tot}} = R_{\\text{free}} + RL$$\n将 $R_{\\text{free}} = R_{\\text{tot}} - RL$ 代入 $K_{d}$ 的表达式中：\n$$K_{d} = \\frac{(R_{\\text{tot}} - RL) \\cdot c}{RL}$$\n这个方程可以重排，以表达结合受体数 $RL$ 作为配体浓度 $c$ 的函数：\n$$K_{d} \\cdot RL = (R_{\\text{tot}} - RL)c$$\n$$K_{d} \\cdot RL = R_{\\text{tot}} \\cdot c - RL \\cdot c$$\n$$RL \\cdot (K_{d} + c) = R_{\\text{tot}} \\cdot c$$\n$$RL(c) = \\frac{R_{\\text{tot}} \\cdot c}{K_{d} + c}$$\n这是 Langmuir 结合等温线，即配体浓度与受体占有率之间的双曲线关系。\n\n接下来，我们使用提供的实验数据来估算 $K_{d}$ 的值。给定每个细胞的总受体数 $R_{\\text{tot}} = 9.0 \\times 10^{4}$。我们可以重排结合方程来求解 $K_{d}$：\n$$K_{d} = \\frac{(R_{\\text{tot}} - RL) \\cdot c}{RL} = \\left(\\frac{R_{\\text{tot}}}{RL} - 1\\right)c$$\n现在我们可以为每个数据点计算 $K_{d}$。\n\n1.  对于 $c = 0.5\\,\\text{nM}$ 和 $RL = 1.80 \\times 10^{4}$：\n    $$K_{d} = \\left(\\frac{9.0 \\times 10^{4}}{1.80 \\times 10^{4}} - 1\\right) \\cdot 0.5 = (5.0 - 1) \\cdot 0.5 = 4.0 \\cdot 0.5 = 2.0\\,\\text{nM}$$\n2.  对于 $c = 1.0\\,\\text{nM}$ 和 $RL = 3.00 \\times 10^{4}$：\n    $$K_{d} = \\left(\\frac{9.0 \\times 10^{4}}{3.00 \\times 10^{4}} - 1\\right) \\cdot 1.0 = (3.0 - 1) \\cdot 1.0 = 2.0 \\cdot 1.0 = 2.0\\,\\text{nM}$$\n3.  对于 $c = 2.0\\,\\text{nM}$ 和 $RL = 4.50 \\times 10^{4}$：\n    $$K_{d} = \\left(\\frac{9.0 \\times 10^{4}}{4.50 \\times 10^{4}} - 1\\right) \\cdot 2.0 = (2.0 - 1) \\cdot 2.0 = 1.0 \\cdot 2.0 = 2.0\\,\\text{nM}$$\n4.  对于 $c = 5.0\\,\\text{nM}$ 和 $RL = 6.43 \\times 10^{4}$：\n    $$K_{d} = \\left(\\frac{9.0 \\times 10^{4}}{6.43 \\times 10^{4}} - 1\\right) \\cdot 5.0 \\approx (1.3997 - 1) \\cdot 5.0 = 0.3997 \\cdot 5.0 \\approx 1.9985\\,\\text{nM}$$\n5.  对于 $c = 10.0\\,\\text{nM}$ 和 $RL = 7.50 \\times 10^{4}$：\n    $$K_{d} = \\left(\\frac{9.0 \\times 10^{4}}{7.50 \\times 10^{4}} - 1\\right) \\cdot 10.0 = (1.2 - 1) \\cdot 10.0 = 0.2 \\cdot 10.0 = 2.0\\,\\text{nM}$$\n\n所有数据点的计算都得出了高度一致的 $K_{d}$ 值，大约为 $2.0\\,\\text{nM}$。第四个数据点的微小偏差可归因于输入数据的精度。一种替代的图形方法，如 Scatchard 图 (Scatchard plot)（$\\frac{RL}{c}$ 对 $RL$ 作图），将显示这些点位于一条斜率为 $-\\frac{1}{K_{d}}$ 的直线上，从而证实这一结果。鉴于数据的一致性，简单的平均就足够了，得出解离常数的估计值为 $K_{d} = 2.00\\,\\text{nM}$，当表示为三位有效数字时。\n\n最后，我们论证下游有效信号项 $S(c) = S_{\\max} \\, c/(K_{d} + c)$ 的形式。在信号转导建模中，一个常见且基本的假设是，下游生物学响应的强度 $S(c)$ 与被占据的受体数量 $RL(c)$ 成正比。这假设每个受体-配体复合物对总信号的贡献是相等且独立的。\n在数学上，这种正比关系可以写成：\n$$S(c) = k_{s} \\cdot RL(c)$$\n其中 $k_{s}$ 是一个信号转导常数。\n代入推导出的 $RL(c)$ 表达式：\n$$S(c) = k_{s} \\left( \\frac{R_{\\text{tot}} \\cdot c}{K_{d} + c} \\right)$$\n当配体浓度达到饱和时（$c \\to \\infty$），达到最大可能信号 $S_{\\max}$，这会导致最大可能数量的受体被结合（$RL \\to R_{\\text{tot}}$）。因此，最大信号为：\n$$S_{\\max} = \\lim_{c\\to\\infty} S(c) = k_{s} \\cdot R_{\\text{tot}}$$\n在 $S(c)$ 的表达式中用 $S_{\\max}$ 替换 $k_{s} \\cdot R_{\\text{tot}}$，我们得到所要求的信号项：\n$$S(c) = S_{\\max} \\left( \\frac{c}{K_{d} + c} \\right)$$\n这种形式显示了初始结合事件的参数（$K_{d}$）如何直接传播到下游响应的函数形式中。在这里，解离常数 $K_{d}$ 扮演了半数有效浓度 (EC50) 的角色。也就是说，当配体浓度 $c$ 等于 $K_{d}$ 时，信号 $S(c)$ 恰好是其最大值的一半：\n$$S(K_{d}) = S_{\\max} \\left( \\frac{K_{d}}{K_{d} + K_{d}} \\right) = S_{\\max} \\left( \\frac{K_{d}}{2K_{d}} \\right) = \\frac{1}{2} S_{\\max}$$\n因此，$K_{d}$ 决定了细胞响应对配体浓度的敏感性。较低的 $K_{d}$ 意味着更高的结合亲和力，以及细胞对低浓度配体更为敏感的响应。",
            "answer": "$$\\boxed{2.00}$$"
        },
        {
            "introduction": "组织修复的实现依赖于细胞的集体行为，特别是细胞片的迁移和增殖。反应-扩散-平流方程，如经典的Fisher-KPP模型，为描述这些过程提供了强大的数学框架。本练习的核心任务是，利用伤口边缘推进的数学模型，从模拟的延时成像数据中反向推断出角质形成细胞的迁移速度和增殖速率，这个过程被称为模型校准或参数估计 。",
            "id": "3944653",
            "problem": "你的任务是基于角质形成细胞片层的迁移和增殖，从反应-平流-扩散的第一性原理出发，建立并校准一个一维伤口边缘模型。伤口前沿被定义为角质形成细胞密度场中一个传播的等值线。从以下基础模型出发，推导前沿传播定律，并通过最小化观测与模拟的伤口边缘轨迹之间的失配来估计参数。\n\n基本原理和定义：\n- 设 $u(x,t)$ 表示沿一维坐标 $x$ 随时间 $t$ 变化的角质形成细胞密度。\n- 控制性平衡方程是一个反应-平流-扩散方程，\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\,v\\,\\frac{\\partial u}{\\partial x} \\;+\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; r\\,u\\left(1-\\frac{u}{K}\\right),\n$$\n其中 $v$ 是由集体平流引起的片层迁移速度，$D$ 是描述随机运动的有效扩散系数，$r$ 是增殖率，$K$ 是承载能力。初始伤口边缘在时间 $t=0$ 时位于位置 $x=X_0$。\n\n- 伤口边缘轨迹 $X(t)$ 在操作上定义为 $u(x,t)$ 的某个选定等值线的位置，并且在 Fisher–Kolmogorov–Petrovsky–Piskunov 行波的标准条件下，前沿会趋近于一个恒速传播机制。\n\n任务概述：\n1. 从给定的平衡定律和反应-平流-扩散系统中的行波概念出发，推导一个形式如下的恒速前沿传播定律：\n$$\nX_{\\text{sim}}(t) \\;=\\; X_0 \\;+\\; c(v,r,D)\\,t,\n$$\n其中 $c(v,r,D)$ 是依赖于 $v$、$r$ 和 $D$ 的渐近波速。\n2. 使用推导出的恒速定律，通过最小化模拟与观测到的前沿位置之间的平方误差和，来估计迁移速度 $v$（单位为 $\\mu\\text{m}/\\text{h}$）和增殖率 $r$（单位为 $\\text{h}^{-1}$）。每个测试案例包含两个实验：\n   - 抑制剂实验：在此实验中，增殖被阻断，因此有效增殖率近似为零（在模拟中设置 $r=0$）。\n   - 正常实验：在此实验中，迁移和增殖共同对前沿速度产生贡献。\n\n3. 对于每个具有观测时间 $\\{t_i\\}$ 和前沿位置 $\\{X^{\\text{obs}}_i\\}$ 的实验，定义最小二乘目标函数：\n$$\nJ(\\theta) \\;=\\; \\sum_i \\left[ X_0 + c(\\theta)\\,t_i - X^{\\text{obs}}_i \\right]^2,\n$$\n其中 $\\theta$ 表示该实验的相关参数。对于抑制剂实验，$\\theta=\\{v\\}$；对于正常实验，在推导的传播定律中，$\\theta=\\{v,r\\}$。仅使用抑制剂实验来估计 $v$，然后结合先前估计的 $v$ 使用正常实验来估计 $r$。\n\n科学真实性要求：\n- 使用给定的反应-平流-扩散框架和行波推理来获得恒速定律。不要假设或引入与此基础无关的不切实际或特定的动力学。\n- 伤口边缘位置必须以微米（$\\mu\\text{m}$）为单位进行模拟，时间以小时（$\\text{h}$）为单位，$v$ 的单位为 $\\mu\\text{m}/\\text{h}$，$r$ 的单位为 $\\text{h}^{-1}$，$D$ 的单位为 $\\mu\\text{m}^2/\\text{h}$。\n\n测试套件：\n为以下三个测试案例校准参数。对于每个案例，使用提供的初始位置 $X_0$、扩散系数 $D$、观测时间以及抑制剂实验和正常实验的观测前沿位置。你的程序必须通过使用你推导的恒速传播定律对所述的最小二乘目标函数进行最小化，来计算每个案例的估计值 $v$ 和 $r$。\n\n- 案例1（一般情况，迁移和增殖共同作用）：\n  - $X_0 = 0\\ \\mu\\text{m}$，$D = 250\\ \\mu\\text{m}^2/\\text{h}$。\n  - 观测时间（小时）：$[0,\\,12,\\,24,\\,36,\\,48]$。\n  - 抑制剂实验观测位置（$\\mu\\text{m}$）：$[0.0,\\,119.5,\\,240.3,\\,360.2,\\,480.8]$。\n  - 正常实验观测位置（$\\mu\\text{m}$）：$[0.0,\\,196.0,\\,392.2,\\,587.9,\\,784.0]$。\n\n- 案例2（边界条件，增殖可忽略不计）：\n  - $X_0 = 0\\ \\mu\\text{m}$，$D = 200\\ \\mu\\text{m}^2/\\text{h}$。\n  - 观测时间（小时）：$[0,\\,12,\\,24,\\,36,\\,48]$。\n  - 抑制剂实验观测位置（$\\mu\\text{m}$）：$[0.0,\\,95.5,\\,192.1,\\,288.3,\\,384.0]$。\n  - 正常实验观测位置（$\\mu\\text{m}$）：$[0.0,\\,95.2,\\,191.9,\\,288.1,\\,384.1]$。\n\n- 案例3（边缘案例，增殖贡献高且有非零初始偏移）：\n  - $X_0 = 100\\ \\mu\\text{m}$，$D = 150\\ \\mu\\text{m}^2/\\text{h}$。\n  - 观测时间（小时）：$[0,\\,24,\\,48,\\,72]$。\n  - 抑制剂实验观测位置（$\\mu\\text{m}$）：$[100.0,\\,219.6,\\,340.2,\\,460.1]$。\n  - 正常实验观测位置（$\\mu\\text{m}$）：$[100.0,\\,395.9,\\,692.5,\\,988.7]$。\n\n算法说明：\n- 推导恒速定律，并对每个数据集的随时间线性变化的轨迹实施最小二乘法最小化。对于抑制剂实验，从 $X^{\\text{obs}}(t)-X_0$ 对 $t$ 的斜率估计 $v$。对于正常实验，从 $X^{\\text{obs}}(t)-X_0$ 对 $t$ 的斜率估计总前沿速度，然后使用你推导的 $c$、$v$、$r$ 和 $D$ 之间的关系求解 $r$，确保 $r\\ge 0$ 和物理一致性。\n\n答案单位和输出：\n- 以 $\\mu\\text{m}/\\text{h}$ 报告 $v$，以 $\\text{h}^{-1}$ 报告 $r$。\n- 将报告的每个数字四舍五入到四位小数。\n- 你的程序应生成单行输出，包含三个案例的六个结果，顺序为 $[v_1, r_1, v_2, r_2, v_3, r_3]$，格式为用方括号括起来的逗号分隔列表（例如，$[v_1,r_1,v_2,r_2,v_3,r_3]$）。不应打印单位或任何附加文本，仅打印数值列表。\n\n你的最终答案必须是一个完整的、可运行的程序，该程序不读取任何输入，且仅使用上面提供的数据。",
            "solution": "我们从角质形成细胞密度 $u(x,t)$ 的反应-平流-扩散模型开始，\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\,v\\,\\frac{\\partial u}{\\partial x} \\;+\\; D\\,\\frac{\\partial^2 u}{\\partial x^2} \\;+\\; r\\,u\\left(1-\\frac{u}{K}\\right),\n$$\n其中 $v$ 是集体迁移速度，$D$ 是有效扩散系数，$r$ 是增殖率，$K$ 是承载能力。这是一个带有平流项的标准 Fisher–Kolmogorov–Petrovsky–Piskunov (Fisher–KPP) 型方程。\n\n基于原理的前沿速度推导：\n- 扩散项 $D\\,\\partial_x^2 u$ 和逻辑增殖项 $r\\,u(1-u/K)$ 构成了经典的 Fisher–KPP 动力学，它产生连接伤口内部（$u$ 值低）到汇合单层细胞（接近 $K$）的行波解，其最小波速由反应和扩散决定。\n- 平流项 $-v\\,\\partial_x u$ 代表细胞片层的均匀漂移。在一个随片层移动的参考系中，该项对波速的贡献是线性的。\n- 对于没有平流的 Fisher–KPP 方程，在假设前沿由线性化生长项 $r\\,u$ 和扩散 $D$ 控制的情况下，其最小行波速度已经确定为 $c_0 = 2\\sqrt{D\\,r}$。\n- 当加入速度为 $v$ 的均匀平流时，实验室参考系中的行波速度变成平流漂移速度和 Fisher–KPP 传播速度之和。因此，渐近前沿速度为\n$$\nc(v,r,D) \\;=\\; v \\;+\\; 2\\sqrt{D\\,r}.\n$$\n\n这是通过变换到速度为 $v$ 的共动参考系推导出来的，在该参考系中方程简化为标准的 Fisher–KPP 形式，然后再变换回实验室参考系。在这种恒速机制下，伤口边缘位置遵循一个随时间线性变化的轨迹，\n$$\nX_{\\text{sim}}(t) \\;=\\; X_0 \\;+\\; c(v,r,D)\\,t \\;=\\; X_0 \\;+\\; \\left(v + 2\\sqrt{D\\,r}\\right)\\,t.\n$$\n\n通过最小二乘法进行参数估计：\n- 对于一个有观测数据 $\\{(t_i, X^{\\text{obs}}_i)\\}$ 和已知 $X_0$ 的实验，恒速模型的最小二乘目标函数为\n$$\nJ(\\theta) \\;=\\; \\sum_i \\left[ X_0 + c(\\theta)\\,t_i - X^{\\text{obs}}_i \\right]^2.\n$$\n- 在抑制剂实验中，增殖被阻断，因此取 $r=0$ 且 $c=v$。对于\n$$\nJ_{\\text{inh}}(v) \\;=\\; \\sum_i \\left[ X_0 + v\\,t_i - X^{\\text{obs}}_i \\right]^2\n$$\n关于 $v$ 的最小化，可以通过线性最小二乘法获得：定义 $y_i = X^{\\text{obs}}_i - X_0$，并对 $y_i$ 关于 $t_i$ 进行回归。最优的 $v$ 是\n$$\n\\hat{v} \\;=\\; \\frac{\\sum_i t_i\\,y_i}{\\sum_i t_i^2}.\n$$\n- 在正常实验中，迁移和增殖都有贡献。定义 $y_i = X^{\\text{obs}}_i - X_0$ 并通过下式估计总速度 $\\hat{c}$：\n$$\n\\hat{c} \\;=\\; \\frac{\\sum_i t_i\\,y_i}{\\sum_i t_i^2}.\n$$\n给定从抑制剂数据集中得到的 $\\hat{v}$ 和已知的 $D$，从 $c = v + 2\\sqrt{D\\,r}$ 中求解 $r$：\n$$\n\\sqrt{D\\,r} \\;=\\; \\frac{\\hat{c} - \\hat{v}}{2}, \\quad r \\;=\\; \\frac{(\\hat{c}-\\hat{v})^2}{4\\,D}.\n$$\n- 物理一致性要求 $\\hat{c} \\ge \\hat{v}$；如果 $\\hat{c} \\le \\hat{v}$，则设置 $\\hat{r} = 0$，因为非负的 $r$ 不可能将速度降低到 $v$ 以下。\n\n每个案例的算法：\n1. 使用抑制剂实验的观测数据，计算 $y_i = X^{\\text{obs}}_i - X_0$，然后计算 $\\hat{v} = \\left(\\sum_i t_i y_i\\right)/\\left(\\sum_i t_i^2\\right)$。\n2. 使用正常实验的观测数据，计算 $y_i = X^{\\text{obs}}_i - X_0$，然后计算 $\\hat{c} = \\left(\\sum_i t_i y_i\\right)/\\left(\\sum_i t_i^2\\right)$。\n3. 计算 $\\hat{r} = \\max\\left(0,\\; \\frac{(\\hat{c}-\\hat{v})^2}{4D}\\right)$。\n\n单位和四舍五入：\n- $\\hat{v}$ 以微米每小时（$\\mu\\text{m}/\\text{h}$）报告，$\\hat{r}$ 以每小时（$\\text{h}^{-1}$）报告。\n- 将每个值四舍五入到四位小数以供输出。\n\n应用于提供的测试套件：\n- 案例1：抑制剂实验的斜率得出 $\\hat{v}$ 接近 $10\\ \\mu\\text{m}/\\text{h}$。正常实验的斜率得出 $\\hat{c}$ 约等于 $16.33\\ \\mu\\text{m}/\\text{h}$。当 $D=250\\ \\mu\\text{m}^2/\\text{h}$ 时，$\\hat{r}$ 接近 $0.040\\ \\text{h}^{-1}$。\n- 案例2：两个斜率都约等于 $8\\ \\mu\\text{m}/\\text{h}$；由于正常实验的速度不超过抑制剂实验的速度，设置 $\\hat{r}=0$。\n- 案例3：抑制剂实验的斜率得出 $\\hat{v}$ 接近 $5\\ \\mu\\text{m}/\\text{h}$。正常实验的斜率得出 $\\hat{c}$ 接近 $12.34\\ \\mu\\text{m}/\\text{h}$。当 $D=150\\ \\mu\\text{m}^2/\\text{h}$ 时，$\\hat{r}$ 接近 $0.090\\ \\text{h}^{-1}$。\n\n程序精确地实现了这些计算，使用了提供的数据，并按 $[v_1, r_1, v_2, r_2, v_3, r_3]$ 的顺序，将六个四舍五入后的值打印为单个用方括号括起来的逗号分隔列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_speed(times, positions, X0):\n    \"\"\"\n    Estimate constant speed c from linear least squares of y vs t,\n    where y = positions - X0.\n    \"\"\"\n    t = np.array(times, dtype=float)\n    y = np.array(positions, dtype=float) - float(X0)\n    # Least squares slope for model y = c * t\n    denom = np.dot(t, t)\n    # Avoid division by zero if all times are zero (not the case here)\n    c_hat = float(np.dot(t, y) / denom) if denom > 0 else 0.0\n    return c_hat\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: dict with X0, D, times, inhibitor positions, normal positions.\n    test_cases = [\n        {\n            \"X0\": 0.0,\n            \"D\": 250.0,\n            \"times\": [0, 12, 24, 36, 48],\n            \"inh_positions\": [0.0, 119.5, 240.3, 360.2, 480.8],\n            \"norm_positions\": [0.0, 196.0, 392.2, 587.9, 784.0],\n        },\n        {\n            \"X0\": 0.0,\n            \"D\": 200.0,\n            \"times\": [0, 12, 24, 36, 48],\n            \"inh_positions\": [0.0, 95.5, 192.1, 288.3, 384.0],\n            \"norm_positions\": [0.0, 95.2, 191.9, 288.1, 384.1],\n        },\n        {\n            \"X0\": 100.0,\n            \"D\": 150.0,\n            \"times\": [0, 24, 48, 72],\n            \"inh_positions\": [100.0, 219.6, 340.2, 460.1],\n            \"norm_positions\": [100.0, 395.9, 692.5, 988.7],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        X0 = case[\"X0\"]\n        D = case[\"D\"]\n        times = case[\"times\"]\n\n        # Estimate v from inhibitor dataset (r ~ 0 -> c = v)\n        v_hat = estimate_speed(times, case[\"inh_positions\"], X0)\n\n        # Estimate total speed c from normal dataset\n        c_hat = estimate_speed(times, case[\"norm_positions\"], X0)\n\n        # Compute r_hat from c = v + 2 * sqrt(D * r)\n        # Enforce physical consistency: if c_hat = v_hat, set r_hat = 0\n        if c_hat = v_hat:\n            r_hat = 0.0\n        else:\n            diff = c_hat - v_hat\n            r_hat = (diff * diff) / (4.0 * D)\n\n        # Round to four decimals as required\n        v_out = round(v_hat, 4)\n        r_out = round(r_hat, 4)\n\n        results.extend([v_out, r_out])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个经过校准的数学模型不仅能解释现有数据，更能成为一个强大的“虚拟实验室”，用于预测和情景分析。Fisher-KPP反应扩散方程是模拟上皮组织动态的基石模型。本练习将指导你从零开始建立并实现一个上皮伤口愈合的数值模拟，用它来探究高血糖等病理条件如何延缓伤口闭合，并定量分解不同生理损伤（如细胞迁移能力下降与增殖减缓）的相对贡献 。",
            "id": "3944713",
            "problem": "要求您从第一性原理出发，构建一个一维上皮伤口愈合模型，该模型能够捕捉细胞片层迁移和细胞增殖的动态过程，然后利用该模型量化高血糖引起的迁移和增殖损伤如何增加伤口闭合时间。该模型必须源自细胞密度的守恒定律，并结合物理上合理的迁移本构定律和经过充分检验的增殖定律。然后，实施并模拟该模型，以计算不同情景下的闭合时间，并将高血糖条件下闭合时间的增加分解为迁移受损与增殖减少的相对贡献。\n\n使用以下基本原理：\n\n- 上皮细胞密度的质量守恒：如果 $E(x,t)$ 表示上皮细胞密度，则 $ \\frac{\\partial E}{\\partial t} = - \\frac{\\partial J}{\\partial x} + S(E) $，其中 $J$ 是细胞通量，$S(E)$ 是由增殖产生的源项。\n- 菲克迁移（菲克定律）：$ J = - D \\frac{\\partial E}{\\partial x} $，其中 $D$ 是有效迁移率（扩散）系数。\n- 逻辑斯谛增殖：$ S(E) = r E \\left( 1 - \\frac{E}{K} \\right) $，其中 $r$ 是增殖率，$K$ 是环境承载能力（最大密度）。\n\n高血糖通过对迁移率和增殖率进行乘法折减来建模，因此在高血糖条件下，有效参数变为 $ D_{\\text{hyp}} = \\alpha_D D $ 和 $ r_{\\text{hyp}} = \\alpha_r r $，其中 $ 0  \\alpha_D \\le 1 $ 和 $ 0  \\alpha_r \\le 1 $。\n\n基于这些原理，推导控制 $E(x,t)$ 在具有无通量边界的有限域上的一维偏微分方程（PDE）：\n$$\n\\frac{\\partial E}{\\partial t} = D \\frac{\\partial^2 E}{\\partial x^2} + r E \\left(1 - \\frac{E}{K}\\right),\n$$\n以及经高血糖修正的方程：\n$$\n\\frac{\\partial E}{\\partial t} = \\alpha_D D \\frac{\\partial^2 E}{\\partial x^2} + \\alpha_r r E \\left(1 - \\frac{E}{K}\\right).\n$$\n\n将伤口定义为一个初始为空的区域，宽度为 $W$，中心位于 $x=0$，即对于 $|x| \\le W/2$，$E(x,0) = 0$；对于 $|x|  W/2$，$E(x,0) = K$。在域边缘施加零通量（诺伊曼）边界条件，以使边界处的净细胞通量为零。将闭合时间 $T$ 定义为伤口中心上皮密度达到预定闭合阈值 $E(0,t) \\ge \\theta K$ 的最早时间 $t$，其中 $0  \\theta  1$。\n\n您必须：\n\n1. 为该偏微分方程实现一个稳定的显式有限差分格式，使用空间步长 $ \\Delta x $ 和时间步长 $ \\Delta t $，并采用无通量边界条件。确保每次模拟都遵循扩散稳定性准则 $ \\Delta t \\le \\frac{\\Delta x^2}{2 D_{\\text{eff}}} $，其中 $D_{\\text{eff}}$ 是该次模拟中使用的迁移系数。\n2. 对每个测试用例，模拟四种情景以计算以小时为单位的闭合时间：基线 $(D,r)$、仅迁移受损 $(\\alpha_D D, r)$、仅增殖减少 $(D, \\alpha_r r)$ 和高血糖（两种损伤并存） $(\\alpha_D D, \\alpha_r r)$，闭合阈值为 $ \\theta K $。\n3. 如果在模拟时限 $T_{\\max}$ 结束时仍未闭合，则将闭合时间报告为 $T_{\\max}$，并附上一个表示未闭合的相应标志。\n4. 使用双因素夏普利式分解，量化迁移受损与增殖减少对高血糖条件下闭合时间总增加量的相对贡献（以小数表示）。设 $T_{\\text{base}}$ 表示基线闭合时间，$T_{D}$ 表示仅迁移受损的闭合时间，$T_{r}$ 表示仅增殖减少的闭合时间，$T_{\\text{hyp}}$ 表示高血糖条件下的闭合时间。定义总增加量 $ \\Delta T = T_{\\text{hyp}} - T_{\\text{base}} $。将夏普利贡献定义为：\n$$\n\\phi_{\\text{mig}} = \\frac{1}{2}\\left[ (T_{D} - T_{\\text{base}}) + (T_{\\text{hyp}} - T_{r}) \\right], \\quad\n\\phi_{\\text{pro}} = \\frac{1}{2}\\left[ (T_{r} - T_{\\text{base}}) + (T_{\\text{hyp}} - T_{D}) \\right].\n$$\n然后报告相对贡献 $ c_{\\text{mig}} = \\frac{\\phi_{\\text{mig}}}{\\Delta T} $ 和 $ c_{\\text{pro}} = \\frac{\\phi_{\\text{pro}}}{\\Delta T} $。如果 $ \\Delta T \\le 0 $，则设 $ c_{\\text{mig}} = 0 $ 和 $ c_{\\text{pro}} = 0 $。\n5. 所有闭合时间以小时表示，贡献以小数表示。\n\n模拟单位约定：\n- 空间单位：毫米 (mm)。\n- 时间单位：小时 (h)。\n- 扩散系数单位：平方毫米/小时 (mm$^2$/h)。\n- 增殖率单位：每小时 (h$^{-1}$)。\n- 上皮密度 $E$ 和环境承载能力 $K$ 是无量纲的。\n\n测试套件：\n为以下四个参数集提供结果。对于每个用例，您必须使用指定的 $ \\Delta x $、$ \\Delta t $ 和 $ T_{\\max} $，并按指定格式生成输出。\n\n- 测试用例 1（正常路径）：\n  - 域长度 $L = 20$ mm，伤口宽度 $W = 2$ mm。\n  - 扩散系数 $D = 0.05$ mm$^2$/h，增殖率 $r = 0.02$ h$^{-1}$，环境承载能力 $K = 1$。\n  - 闭合阈值分数 $ \\theta = 0.90 $。\n  - 高血糖乘数 $ \\alpha_D = 0.60 $，$ \\alpha_r = 0.50 $。\n  - 离散化 $ \\Delta x = 0.10$ mm，$ \\Delta t = 0.04$ h，模拟时限 $ T_{\\max} = 200$ h。\n\n- 测试用例 2（迁移限制重点）：\n  - 域长度 $L = 20$ mm，伤口宽度 $W = 3$ mm。\n  - 扩散系数 $D = 0.01$ mm$^2$/h，增殖率 $r = 0.03$ h$^{-1}$，环境承载能力 $K = 1$。\n  - 闭合阈值分数 $ \\theta = 0.90 $。\n  - 高血糖乘数 $ \\alpha_D = 0.30 $，$ \\alpha_r = 0.90 $。\n  - 离散化 $ \\Delta x = 0.10$ mm，$ \\Delta t = 0.04$ h，模拟时限 $ T_{\\max} = 300$ h。\n\n- 测试用例 3（增殖限制重点）：\n  - 域长度 $L = 20$ mm，伤口宽度 $W = 2$ mm。\n  - 扩散系数 $D = 0.08$ mm$^2$/h，增殖率 $r = 0.005$ h$^{-1}$，环境承载能力 $K = 1$。\n  - 闭合阈值分数 $ \\theta = 0.90 $。\n  - 高血糖乘数 $ \\alpha_D = 0.90 $，$ \\alpha_r = 0.40 $。\n  - 离散化 $ \\Delta x = 0.10$ mm，$ \\Delta t = 0.04$ h，模拟时限 $ T_{\\max} = 400$ h。\n\n- 测试用例 4（边缘情况，可能在时限内未闭合）：\n  - 域长度 $L = 20$ mm，伤口宽度 $W = 6$ mm。\n  - 扩散系数 $D = 0.03$ mm$^2$/h，增殖率 $r = 0.004$ h$^{-1}$，环境承载能力 $K = 1$。\n  - 闭合阈值分数 $ \\theta = 0.90 $。\n  - 高血糖乘数 $ \\alpha_D = 0.50 $，$ \\alpha_r = 0.50 $。\n  - 离散化 $ \\Delta x = 0.10$ mm，$ \\Delta t = 0.04$ h，模拟时限 $ T_{\\max} = 500$ h。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。列表中的每个元素对应一个测试用例，并且本身是一个包含十个元素的列表，顺序如下：\n$[T_{\\text{base}}, T_{D}, T_{r}, T_{\\text{hyp}}, c_{\\text{mig}}, c_{\\text{pro}}, \\text{flag}_{\\text{base}}, \\text{flag}_{D}, \\text{flag}_{r}, \\text{flag}_{\\text{hyp}}]$，\n其中闭合时间以小时为单位，是浮点数；贡献是小数，是浮点数；标志是整数，如果闭合发生在 $T_{\\max}$ 之前，则值为 $1$，否则为 $0$。例如，输出应类似于：\n$[[T_{\\text{base}},T_{D},T_{r},T_{\\text{hyp}},c_{\\text{mig}},c_{\\text{pro}},\\text{flag}_{\\text{base}},\\text{flag}_{D},\\text{flag}_{r},\\text{flag}_{\\text{hyp}}],\\ldots]$。",
            "solution": "该问题具有科学依据，提法明确，并为一项关于伤口愈合模型的数值模拟研究提供了完整的规范。所有必需的参数、方程和条件都已明确定义。其基础模型是 Fisher-Kolmogorov-Petrovsky-Piskunov (FKPP) 方程，这是一个在数学生物学中广泛使用的典型反应扩散模型。参数值和模拟设置在物理上是现实的，在计算上是可行的。数值格式的稳定性准则已被指定，并且给定的参数满足该准则。通过夏普利分解进行的分析是在多因素系统中归因效应的一种明确定义的方法。因此，该问题被认为是有效的。\n\n求解过程分三个阶段进行：首先，推导并离散化控制偏微分方程（PDE）；其次，实施数值模拟以找出各种条件下的伤口闭合时间；第三，分析这些闭合时间以量化细胞迁移受损和增殖受损的相对贡献。\n\n**1. 控制方程与离散化**\n\n该模型基于上皮细胞密度 $E(x,t)$ 的守恒定律，该定律指出，某一点细胞密度的变化率是净细胞迁移（通量）和局部细胞增殖（源）之和。\n$$\n\\frac{\\partial E}{\\partial t} = - \\frac{\\partial J}{\\partial x} + S(E)\n$$\n细胞迁移被建模为一个菲克扩散过程，其中细胞通量 $J$ 与细胞密度的负梯度成正比：\n$$\nJ = - D \\frac{\\partial E}{\\partial x}\n$$\n这里，$D$ 是有效迁移率或扩散系数。细胞增殖由逻辑斯谛增长模型描述，其中细胞以速率 $r$ 增殖，直至达到最大承载能力密度 $K$：\n$$\nS(E) = r E \\left( 1 - \\frac{E}{K} \\right)\n$$\n将 $J$ 和 $S(E)$ 的表达式代入守恒定律，得到控制偏微分方程，即 FKPP 方程的一种形式：\n$$\n\\frac{\\partial E}{\\partial t} = D \\frac{\\partial^2 E}{\\partial x^2} + r E \\left(1 - \\frac{E}{K}\\right)\n$$\n为了数值求解该方程，我们采用显式有限差分法。长度为 $L$ 的空间域被离散化为一个点网格 $x_i = i \\Delta x$，时间被离散化为步长 $t_n = n \\Delta t$。令 $E_i^n$ 表示在位置 $x_i$ 和时间 $t_n$ 的密度。偏导数使用有限差分进行近似：时间导数使用向前差分，空间导数使用二阶中心差分。\n\n$$\n\\frac{\\partial E}{\\partial t} \\bigg|_{i,n} \\approx \\frac{E_i^{n+1} - E_i^n}{\\Delta t}\n$$\n$$\n\\frac{\\partial^2 E}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{E_{i+1}^n - 2E_i^n + E_{i-1}^n}{\\Delta x^2}\n$$\n将这些近似值代入偏微分方程并整理 $E_i^{n+1}$，得到内部网格点的显式更新规则：\n$$\nE_i^{n+1} = E_i^n + \\Delta t \\left[ D \\left( \\frac{E_{i+1}^n - 2E_i^n + E_{i-1}^n}{\\Delta x^2} \\right) + r E_i^n \\left(1 - \\frac{E_i^n}{K}\\right) \\right]\n$$\n只要时间步长 $\\Delta t$ 满足扩散稳定性准则 $\\Delta t \\le \\frac{(\\Delta x)^2}{2D}$，该格式就是稳定的。问题中的参数被选择来遵循此条件。\n\n**2. 边界条件与初始条件**\n\n模拟在长度为 $L$ 的有限域上进行，我们将其定义为从 $x = -L/2$ 到 $x = L/2$。问题指定了在域边缘处的零通量（诺伊曼）边界条件，意味着在 $x = \\pm L/2$ 处 $\\frac{\\partial E}{\\partial x} = 0$。对于中心差分格式，此条件通过使用“虚拟点”来实现。对于边界 $x_0 = -L/2$，我们引入一个虚拟点 $E_{-1}$ 并强制执行条件 $\\frac{E_1 - E_{-1}}{2\\Delta x} = 0$，这意味着 $E_{-1} = E_1$。在 $i=0$ 处的拉普拉斯项变为：\n$$\n\\frac{\\partial^2 E}{\\partial x^2} \\bigg|_{0,n} \\approx \\frac{E_{1}^n - 2E_0^n + E_{-1}^n}{\\Delta x^2} = \\frac{2(E_{1}^n - E_0^n)}{\\Delta x^2}\n$$\n一个对称的公式适用于右边界 $x_{N_x-1} = L/2$。\n\n初始条件指定了一个宽度为 $W$、中心在 $x=0$ 的伤口，其中细胞密度为零，周围是处于承载能力密度 $K$ 的健康组织。\n$$\nE(x,0) = \\begin{cases} 0  \\text{for } |x| \\le W/2 \\\\ K  \\text{for } |x|  W/2 \\end{cases}\n$$\n模拟通过从 $t=0$ 开始迭代更新规则，直到最大时间 $T_{\\max}$。在每个时间步，检查伤口中心的细胞密度 $E(0,t)$ 是否满足闭合准则 $E(0,t) \\ge \\theta K$。首次满足此条件的时间被记录为闭合时间 $T$。如果在 $T_{\\max}$ 之前未满足条件，则闭合时间报告为 $T_{\\max}$，并设置相关标志为 $0$。\n\n**3. 高血糖模型与贡献分析**\n\n高血糖通过将基线迁移系数 $D$ 和增殖率 $r$ 分别乘以乘法因子 $\\alpha_D$ 和 $\\alpha_r$ 来建模，其中 $0  \\alpha_D, \\alpha_r \\le 1$。每个测试用例运行四个独立的模拟：\n1.  **基线：** $(D, r)$，得到闭合时间 $T_{\\text{base}}$。\n2.  **迁移受损：** $(\\alpha_D D, r)$，得到闭合时间 $T_D$。\n3.  **增殖减少：** $(D, \\alpha_r r)$，得到闭合时间 $T_r$。\n4.  **高血糖（两种损伤并存）：** $(\\alpha_D D, \\alpha_r r)$，得到闭合时间 $T_{\\text{hyp}}$。\n\n由高血糖引起的闭合时间总增加量为 $\\Delta T = T_{\\text{hyp}} - T_{\\text{base}}$。为了将此增加量分解为两种损伤的贡献，我们使用夏普利式公式。迁移受损的贡献 $\\phi_{\\text{mig}}$ 是其在两种情境下边际效应的平均值：当增殖正常时，以及当增殖减少时。\n$$\n\\phi_{\\text{mig}} = \\frac{1}{2}\\left[ (T_{D} - T_{\\text{base}}) + (T_{\\text{hyp}} - T_{r}) \\right]\n$$\n类似地，增殖减少的贡献 $\\phi_{\\text{pro}}$ 是：\n$$\n\\phi_{\\text{pro}} = \\frac{1}{2}\\left[ (T_{r} - T_{\\text{base}}) + (T_{\\text{hyp}} - T_{D}) \\right]\n$$\n这些贡献之和恰好等于总增加量，即 $\\phi_{\\text{mig}} + \\phi_{\\text{pro}} = \\Delta T$。相对贡献则为 $c_{\\text{mig}} = \\phi_{\\text{mig}} / \\Delta T$ 和 $c_{\\text{pro}} = \\phi_{\\text{pro}} / \\Delta T$。如果 $\\Delta T \\le 0$，则两个相对贡献都定义为 $0$。最终的实现封装了这整个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_single_simulation(L, W, K, theta, D_eff, r_eff, dx, dt, t_max):\n    \"\"\"\n    Simulates the 1D reaction-diffusion model for wound healing.\n    \"\"\"\n    # Spatial grid setup\n    nx = int(round(L / dx)) + 1\n    x_coords = np.linspace(-L / 2.0, L / 2.0, nx)\n    center_idx = (nx - 1) // 2\n\n    # Initial condition: wound of width W centered at x=0\n    E_current = np.full(nx, K, dtype=np.float64)\n    E_current[np.abs(x_coords) = W / 2.0] = 0.0\n\n    E_next = np.empty_like(E_current)\n\n    # Simulation parameters\n    closure_threshold = theta * K\n    num_steps = int(round(t_max / dt))\n    \n    # Pre-calculate constants for update rule\n    c_diff = D_eff * dt / (dx**2)\n    c_react = dt * r_eff\n\n    for i in range(num_steps + 1):\n        t_current = i * dt\n        \n        # Check for closure at the beginning of the time step\n        if E_current[center_idx] >= closure_threshold:\n            return t_current, 1\n\n        # If it's the last step, no need to calculate the next state\n        if i == num_steps:\n            break\n\n        # Calculate E_next based on E_current\n        # Interior points update\n        laplacian_interior = E_current[2:] - 2*E_current[1:-1] + E_current[:-2]\n        reaction_interior = E_current[1:-1] * (1.0 - E_current[1:-1] / K)\n        E_next[1:-1] = E_current[1:-1] + c_diff * laplacian_interior + c_react * reaction_interior\n        \n        # Boundary at i=0 (left, x=-L/2)\n        laplacian_0 = 2.0 * (E_current[1] - E_current[0])\n        reaction_0 = E_current[0] * (1.0 - E_current[0] / K)\n        E_next[0] = E_current[0] + c_diff * laplacian_0 + c_react * reaction_0\n\n        # Boundary at i=nx-1 (right, x=L/2)\n        laplacian_end = 2.0 * (E_current[-2] - E_current[-1])\n        reaction_end = E_current[-1] * (1.0 - E_current[-1] / K)\n        E_next[-1] = E_current[-1] + c_diff * laplacian_end + c_react * reaction_end\n        \n        # Swap buffers for the next iteration\n        E_current, E_next = E_next, E_current\n\n    # If loop completes without closure\n    return t_max, 0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 20.0, \"W\": 2.0, \"D\": 0.05, \"r\": 0.02, \"K\": 1.0,\n            \"theta\": 0.90, \"alpha_D\": 0.60, \"alpha_r\": 0.50,\n            \"dx\": 0.10, \"dt\": 0.04, \"t_max\": 200.0,\n        },\n        {\n            \"L\": 20.0, \"W\": 3.0, \"D\": 0.01, \"r\": 0.03, \"K\": 1.0,\n            \"theta\": 0.90, \"alpha_D\": 0.30, \"alpha_r\": 0.90,\n            \"dx\": 0.10, \"dt\": 0.04, \"t_max\": 300.0,\n        },\n        {\n            \"L\": 20.0, \"W\": 2.0, \"D\": 0.08, \"r\": 0.005, \"K\": 1.0,\n            \"theta\": 0.90, \"alpha_D\": 0.90, \"alpha_r\": 0.40,\n            \"dx\": 0.10, \"dt\": 0.04, \"t_max\": 400.0,\n        },\n        {\n            \"L\": 20.0, \"W\": 6.0, \"D\": 0.03, \"r\": 0.004, \"K\": 1.0,\n            \"theta\": 0.90, \"alpha_D\": 0.50, \"alpha_r\": 0.50,\n            \"dx\": 0.10, \"dt\": 0.04, \"t_max\": 500.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        p = params # shorthand\n        \n        # Scenario 1: Baseline\n        T_base, flag_base = run_single_simulation(\n            p[\"L\"], p[\"W\"], p[\"K\"], p[\"theta\"], p[\"D\"], p[\"r\"],\n            p[\"dx\"], p[\"dt\"], p[\"t_max\"]\n        )\n\n        # Scenario 2: Migration-impaired only\n        T_D, flag_D = run_single_simulation(\n            p[\"L\"], p[\"W\"], p[\"K\"], p[\"theta\"], p[\"alpha_D\"] * p[\"D\"], p[\"r\"],\n            p[\"dx\"], p[\"dt\"], p[\"t_max\"]\n        )\n\n        # Scenario 3: Proliferation-reduced only\n        T_r, flag_r = run_single_simulation(\n            p[\"L\"], p[\"W\"], p[\"K\"], p[\"theta\"], p[\"D\"], p[\"alpha_r\"] * p[\"r\"],\n            p[\"dx\"], p[\"dt\"], p[\"t_max\"]\n        )\n        \n        # Scenario 4: Hyperglycemia (both impaired)\n        T_hyp, flag_hyp = run_single_simulation(\n            p[\"L\"], p[\"W\"], p[\"K\"], p[\"theta\"], p[\"alpha_D\"] * p[\"D\"], p[\"alpha_r\"] * p[\"r\"],\n            p[\"dx\"], p[\"dt\"], p[\"t_max\"]\n        )\n\n        # Calculate Shapley contributions\n        delta_T = T_hyp - T_base\n        \n        if delta_T > 0:\n            phi_mig = 0.5 * ((T_D - T_base) + (T_hyp - T_r))\n            phi_pro = 0.5 * ((T_r - T_base) + (T_hyp - T_D))\n            c_mig = phi_mig / delta_T\n            c_pro = phi_pro / delta_T\n        else:\n            c_mig = 0.0\n            c_pro = 0.0\n            \n        case_results = [\n            T_base, T_D, T_r, T_hyp,\n            c_mig, c_pro,\n            flag_base, flag_D, flag_r, flag_hyp\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Convert each sublist to a string representation, then join them.\n    results_str = [str(res) for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}