{
    "hands_on_practices": [
        {
            "introduction": "生物学中的数学模型通常由描述核心过程（如种群增长）的基本模块构建而成。第一个实践练习将引导你从一个第一性原理的假设出发，推导出著名的Gompertz增长定律：即肿瘤的比增长率随时间呈指数衰减。这个练习将锻炼你将生物学假设转化为可解的常微分方程组的技能，为构建更复杂的模型奠定关键基础。",
            "id": "3940435",
            "problem": "一个嵌入在免疫活性微环境中的实体瘤，由于资源竞争和免疫介导的细胞毒性，其净增殖速率随时间变化。设 $T(t)$ 表示时间 $t$ 时的存活肿瘤细胞数量（或其体积代理），并将比增长速率定义为 $g(t) = \\frac{1}{T(t)}\\frac{dT(t)}{dt}$。假设免疫和资源限制导致比增长速率随时间指数衰减，遵循常微分方程 (ODE) $\\frac{dg(t)}{dt} = -\\gamma\\, g(t)$，其中 $\\gamma  0$。假设初始条件 $T(0) = T_{0}  0$ 和 $g(0) = g_{0}  0$ 是已知的。\n\n从比增长速率的定义和给定的关于 $g(t)$ 的常微分方程出发，推导一个用 $t$、$T_{0}$、$g_{0}$ 和 $\\gamma$ 表示的 $T(t)$ 的闭式表达式。你的推导应仅依赖于所给的定义和常微分方程。识别并解释 $T(t)$ 的长时间极限，将其视为由免疫约束所塑造的涌现承载能力。不要调用任何预先打包的增长定律形式。\n\n以符号形式给出 $T(t)$ 的单个显式表达式作为最终答案。不需要进行数值计算或四舍五入。",
            "solution": "用户提供了一个生物医学系统建模问题，具体涉及肿瘤-免疫相互作用。任务是推导肿瘤细胞群体 $T(t)$ 的闭式表达式，并解释其长期行为。\n\n### 问题验证\n\n**第一步：提取已知条件**\n-   时间 $t$ 时的存活肿瘤细胞数量表示为 $T(t)$。\n-   比增长速率定义为 $g(t) = \\frac{1}{T(t)}\\frac{dT(t)}{dt}$。\n-   比增长速率遵循常微分方程 (ODE)：$\\frac{dg(t)}{dt} = -\\gamma\\, g(t)$，其中 $\\gamma  0$。\n-   初始条件为：$T(0) = T_{0}  0$ 和 $g(0) = g_{0}  0$。\n\n**第二步：使用提取的已知条件进行验证**\n根据验证标准评估该问题：\n-   **科学依据**：该模型是受限增长的经典现象学描述，称为冈珀茨模型。比增长速率呈指数衰减的前提是在资源和免疫压力下对肿瘤动力学进行建模的标准假设。在数学生物学的背景下，该模型是科学有效的。\n-   **适定性**：该问题建立了一个包含两个初始条件的两个一阶常微分方程组。这是一个适定的初值问题，存在唯一、稳定的解。\n-   **客观性**：该问题以精确的数学和科学语言陈述，不含主观论断。\n-   **完整性和一致性**：提供了所有必要的方程、变量、常数和初始条件。不存在矛盾。\n-   **非平凡性**：求解过程需要对两个耦合的常微分方程进行序贯积分，这是微分方程中的一个标准但非平凡的练习。\n\n**第三步：结论与行动**\n该问题在数学上可靠，有科学依据，且是适定的，因此有效。将继续进行求解过程。\n\n### 解的推导\n\n推导过程分两个阶段进行。首先，我们求解比增长速率 $g(t)$。其次，我们利用这个结果来求解肿瘤细胞数量 $T(t)$。\n\n**第一阶段：求解比增长速率 $g(t)$**\n\n给定关于 $g(t)$ 的一阶线性齐次常微分方程：\n$$\n\\frac{dg(t)}{dt} = -\\gamma\\, g(t)\n$$\n这个方程可以通过分离变量法求解。对于 $g(t) \\neq 0$：\n$$\n\\frac{1}{g(t)} dg(t) = -\\gamma\\, dt\n$$\n对两边从初始时间 $t=0$ 到任意时间 $t$ 进行积分：\n$$\n\\int_{g(0)}^{g(t)} \\frac{1}{g'} dg' = \\int_{0}^{t} -\\gamma\\, d\\tau\n$$\n$$\n[\\ln|g'|]_{g(0)}^{g(t)} = [-\\gamma\\, \\tau]_{0}^{t}\n$$\n由于 $g(0)=g_0  0$ 且 $g(t)$ 必须是连续的，所以 $g(t)$ 对所有 $t$ 都保持为正。因此，我们可以去掉绝对值符号。\n$$\n\\ln(g(t)) - \\ln(g(0)) = -\\gamma\\, t\n$$\n代入初始条件 $g(0) = g_{0}$：\n$$\n\\ln(g(t)) = \\ln(g_{0}) - \\gamma\\, t\n$$\n对两边取指数以求解 $g(t)$：\n$$\ng(t) = \\exp(\\ln(g_{0}) - \\gamma\\, t) = \\exp(\\ln(g_{0})) \\exp(-\\gamma\\, t)\n$$\n$$\ng(t) = g_{0} \\exp(-\\gamma\\, t)\n$$\n这个表达式表明，比增长速率从其初始值 $g_{0}$ 开始以衰减常数 $\\gamma$ 进行指数衰减。\n\n**第二阶段：求解肿瘤细胞数量 $T(t)$**\n\n现在我们使用比增长速率的定义，代入我们新求得的 $g(t)$ 表达式：\n$$\n\\frac{1}{T(t)}\\frac{dT(t)}{dt} = g(t) = g_{0} \\exp(-\\gamma\\, t)\n$$\n这可以改写为：\n$$\n\\frac{d}{dt}(\\ln(T(t))) = g_{0} \\exp(-\\gamma\\, t)\n$$\n为了求 $\\ln(T(t))$，我们对两边关于时间 $t$ 从 $0$ 到 $t$ 进行积分：\n$$\n\\int_{0}^{t} \\frac{d}{d\\tau}(\\ln(T(\\tau))) d\\tau = \\int_{0}^{t} g_{0} \\exp(-\\gamma\\, \\tau) d\\tau\n$$\n$$\n[\\ln(T(\\tau))]_{0}^{t} = g_{0} \\left[ -\\frac{1}{\\gamma} \\exp(-\\gamma\\, \\tau) \\right]_{0}^{t}\n$$\n$$\n\\ln(T(t)) - \\ln(T(0)) = -\\frac{g_{0}}{\\gamma} (\\exp(-\\gamma\\, t) - \\exp(0))\n$$\n$$\n\\ln(T(t)) - \\ln(T(0)) = -\\frac{g_{0}}{\\gamma} (\\exp(-\\gamma\\, t) - 1)\n$$\n$$\n\\ln(T(t)) - \\ln(T(0)) = \\frac{g_{0}}{\\gamma} (1 - \\exp(-\\gamma\\, t))\n$$\n现在，代入初始条件 $T(0) = T_{0}$：\n$$\n\\ln(T(t)) = \\ln(T_{0}) + \\frac{g_{0}}{\\gamma} (1 - \\exp(-\\gamma\\, t))\n$$\n为了得到 $T(t)$ 的最终闭式表达式，我们对两边取指数：\n$$\nT(t) = \\exp\\left( \\ln(T_{0}) + \\frac{g_{0}}{\\gamma} (1 - \\exp(-\\gamma\\, t)) \\right)\n$$\n$$\nT(t) = \\exp(\\ln(T_{0})) \\exp\\left( \\frac{g_{0}}{\\gamma} (1 - \\exp(-\\gamma\\, t)) \\right)\n$$\n$$\nT(t) = T_{0} \\exp\\left( \\frac{g_{0}}{\\gamma} (1 - \\exp(-\\gamma\\, t)) \\right)\n$$\n这就是肿瘤细胞群体随时间变化的闭式表达式。\n\n### 长时间极限的解释\n\n问题要求识别并解释 $T(t)$ 的长时间极限作为一个涌现的承载能力。我们计算 $T(t)$ 当 $t \\to \\infty$ 时的极限：\n$$\n\\lim_{t \\to \\infty} T(t) = \\lim_{t \\to \\infty} T_{0} \\exp\\left( \\frac{g_{0}}{\\gamma} (1 - \\exp(-\\gamma\\, t)) \\right)\n$$\n由于 $\\gamma  0$，当 $t \\to \\infty$ 时，项 $\\exp(-\\gamma\\, t)$ 趋近于 $0$。\n$$\n\\lim_{t \\to \\infty} T(t) = T_{0} \\exp\\left( \\frac{g_{0}}{\\gamma} (1 - 0) \\right) = T_{0} \\exp\\left( \\frac{g_{0}}{\\gamma} \\right)\n$$\n这个有限的非零极限代表了最大可持续的肿瘤大小，也就是系统的承载能力，通常用 $K$ 表示。因此，涌现的承载能力是：\n$$\nK = T_{0} \\exp\\left(\\frac{g_{0}}{\\gamma}\\right)\n$$\n这个承载能力不是一个预定义的参数，而是从初始条件（$T_0$, $g_0$）和动态约束参数（$\\gamma$）中涌现出来的。它代表了这样一种平衡状态：指数衰减的比增长速率已经变得小到可以忽略不计，而肿瘤群体由于来自免疫系统和资源限制的持续压力已达到平台期。\n\n最终答案是推导出的 $T(t)$ 的闭式表达式。",
            "answer": "$$\n\\boxed{T_{0} \\exp\\left(\\frac{g_{0}}{\\gamma}\\left(1 - \\exp(-\\gamma t)\\right)\\right)}\n$$"
        },
        {
            "introduction": "在建模过程中，选择何种数学函数来表征一个生物学过程是一项至关重要的决定，它深刻影响着模型的预测结果。本练习  将挑战你在一项关键应用背景——免疫监视——中，比较两种最常见的肿瘤增长模型：Logistic模型和Gompertz模型。通过分析当肿瘤体积趋于零时它们截然不同的数学行为，你将揭示为何一个模型预测了免疫系统清除肿瘤的可能性，而另一个则暗示这无法实现，从而凸显了审视模型底层假设的重要性。",
            "id": "3940471",
            "problem": "考虑一个在种群水平上通过耦合常微分方程（ODEs）建模的肿瘤-免疫相互作用系统。令 $T(t)$ 表示肿瘤负荷，$E(t)$ 表示效应免疫细胞。肿瘤动力学模型如下：\n$$\n\\frac{dT}{dt} \\;=\\; f(T) \\;-\\; k\\,E\\,T,\n$$\n其中 $k0$ 是人均免疫介导的杀伤率，$f(T)$ 是肿瘤净增长项。比较两种公认的生长定律：\n- 逻辑斯谛（Logistic）：$f(T) \\;=\\; r\\,T\\left(1-\\frac{T}{K}\\right)$，其中内禀增长率 $r0$，环境承载力 $K0$。\n- Gompertz：$f(T) \\;=\\; r\\,T\\,\\ln\\!\\left(\\frac{K}{T}\\right)$，具有相同的 $r0$ 和 $K0$。\n\n假设效应细胞动力学包含一个抗原非依赖性的来源和衰减，因此对于足够小的肿瘤负荷 $T$，抗原驱动的刺激可以忽略不计，$E(t)$ 保持在基线水平 $E_0 := s/\\mu$ 附近，其中 $s0$ 是来源项，$\\mu0$ 是衰减率。因此，为了评估在小 $T$ 处的局部行为，您可以将 $E \\approx E_0$ 视为常数。此时，人均肿瘤净增长率为 $f(T)/T - kE_0$。\n\n关于 $T=0$ 附近的定性动力学，以下哪些陈述是正确的？\n\nA. 在逻辑斯谛增长模型下，无肿瘤状态 $T=0$ 是局部渐近稳定的，当且仅当 $kE_0r$。\n\nB. 在 Gompertz 增长模型下，任何有限的 $E_0$ 都不能使 $T=0$ 局部渐近稳定；对于任何有限的 $kE_0$，都存在一个 $\\varepsilon0$，使得对于所有 $T\\in(0,\\varepsilon)$，人均肿瘤净增长率 $r\\ln(K/T)-kE_0$ 为正。\n\nC. 在逻辑斯谛增长模型下，$T=0$ 稳定的条件是 $kE_0rK$。\n\nD. 在 Gompertz 增长模型下，如果 $kE_0r\\ln K$，$T=0$ 是局部渐近稳定的。\n\nE. 对于逻辑斯谛和 Gompertz 增长模型，小 $T$ 时的免疫清除阈值仅取决于 $K$ 而不取决于 $r$。",
            "solution": "该问题要求分析由常微分方程（ODE）控制的肿瘤种群 $T(t)$ 的无肿瘤平衡态 $T=0$ 的局部渐近稳定性：\n$$\n\\frac{dT}{dt} = f(T) - kET\n$$\n在小肿瘤负荷的假设下，效应免疫细胞种群 $E(t)$ 近似为一个恒定的基线值 $E_0  0$。该 ODE 简化为一个一维系统：\n$$\n\\frac{dT}{dt} = g(T) := f(T) - kE_0T\n$$\n无肿瘤状态 $T=0$ 是该系统的一个不动点，因为对于两种提出的生长定律，都有 $f(0)=0$，因此 $g(0) = f(0) - kE_0(0) = 0$。\n\n对于 $T \\ge 0$ 的种群模型，不动点 $T=0$ 是局部渐近稳定的，如果对于足够小的邻域 $(0, \\delta)$ 内的任何初始条件，解 $T(t)$ 在 $t \\to \\infty$ 时都趋近于 0。这要求在某个区间 $(0, \\varepsilon)$（其中 $\\varepsilon  0$）内的所有 $T$ 都满足 $\\frac{dT}{dt}  0$。\n我们可以将该 ODE 重写为：\n$$\n\\frac{dT}{dt} = T \\left( \\frac{f(T)}{T} - kE_0 \\right)\n$$\n对于 $T  0$，$\\frac{dT}{dt}$ 的符号由人均净增长率 $\\frac{f(T)}{T} - kE_0$ 的符号决定。为了使 $T=0$ 局部稳定，这个量在某个区间 $(0, \\varepsilon)$ 内的所有 $T$ 值下都必须为负。如果人均净增长率在 $T \\to 0^+$ 时的极限为负，则该条件得到满足。\n\n### 逻辑斯谛增长分析\n对于逻辑斯谛增长，肿瘤净增长项为 $f(T) = rT\\left(1-\\frac{T}{K}\\right)$，其中 $r  0$ 且 $K  0$。\n人均增长率为 $\\frac{f(T)}{T} = r\\left(1-\\frac{T}{K}\\right)$。\n人均净增长率为 $r\\left(1-\\frac{T}{K}\\right) - kE_0$。\n\n为了评估 $T=0$ 处的稳定性，我们考察当 $T \\to 0^+$ 时的极限：\n$$\n\\lim_{T \\to 0^+} \\left[ r\\left(1-\\frac{T}{K}\\right) - kE_0 \\right] = r(1 - 0) - kE_0 = r - kE_0\n$$\n要使 $T=0$ 局部渐近稳定，这个极限必须为负：\n$$\nr - kE_0  0 \\quad \\iff \\quad kE_0  r\n$$\n如果这个条件成立，根据连续性，存在一个 $\\varepsilon  0$，使得对于所有 $T \\in (0, \\varepsilon)$，人均净增长率都为负，导致 $\\frac{dT}{dt}  0$ 并确保小肿瘤被清除。\n这也可以通过线性化来证实。右侧函数 $g(T) = rT - \\frac{r}{K}T^2 - kE_0T$ 的导数是 $g'(T) = r - \\frac{2r}{K}T - kE_0$。在 $T=0$ 处，我们有 $g'(0) = r - kE_0$。局部渐近稳定的条件是 $g'(0)  0$，这得出 $kE_0  r$。\n\n### Gompertz 增长分析\n对于 Gompertz 增长，肿瘤净增长项为 $f(T) = rT\\ln\\left(\\frac{K}{T}\\right)$，其中 $r  0$ 且 $K  0$。该模型定义在 $T \\in (0, K)$ 上。\n人均增长率为 $\\frac{f(T)}{T} = r\\ln\\left(\\frac{K}{T}\\right)$。\n人均净增长率为 $r\\ln\\left(\\frac{K}{T}\\right) - kE_0$。\n\n为了评估 $T=0$ 处的稳定性，我们考察当 $T \\to 0^+$ 时的极限：\n$$\n\\lim_{T \\to 0^+} \\left[ r\\ln\\left(\\frac{K}{T}\\right) - kE_0 \\right]\n$$\n当 $T \\to 0^+$ 时，项 $\\frac{K}{T} \\to +\\infty$，因此 $\\ln\\left(\\frac{K}{T}\\right) \\to +\\infty$。因为 $r  0$，项 $r\\ln\\left(\\frac{K}{T}\\right)$ 发散到正无穷。项 $kE_0$ 是一个有限常数。\n因此，\n$$\n\\lim_{T \\to 0^+} \\left[ r\\ln\\left(\\frac{K}{T}\\right) - kE_0 \\right] = +\\infty\n$$\n这意味着对于任何有限的参数值 $r, K, k, E_0$，只要 $T  0$ 足够小，人均净增长率就将为正。这意味着在某个区间 $(0, \\varepsilon)$ 内的 $T$ 满足 $\\frac{dT}{dt}  0$。因此，任何无穷小的肿瘤负荷都会增长，在该模型中，无肿瘤状态 $T=0$ 在 Gompertz 增长下总是不稳定的。没有任何有限的免疫应答 $kE_0$ 能够使该平衡点稳定。\n\n### 选项评估\n\n**A. 在逻辑斯谛增长模型下，无肿瘤状态 $T=0$ 是局部渐近稳定的，当且仅当 $kE_0r$。**\n我们对逻辑斯谛模型的分析得出的结论是，$T=0$ 局部渐近稳定的条件恰好是 $kE_0  r$。该陈述与我们的发现一致。\n**结论：正确。**\n\n**B. 在 Gompertz 增长模型下，任何有限的 $E_0$ 都不能使 $T=0$ 局部渐近稳定；对于任何有限的 $kE_0$，都存在一个 $\\varepsilon0$，使得对于所有 $T\\in(0,\\varepsilon)$，人均肿瘤净增长率 $r\\ln(K/T)-kE_0$ 为正。**\n我们对 Gompertz 模型的分析表明，当 $T \\to 0^+$ 时，人均净增长率趋向于 $+\\infty$。这意味着对于任何有限的 $kE_0$ 都是不稳定的。陈述的第二部分为这种不稳定性提供了数学原因。为了证实，我们求解不等式 $r\\ln(K/T) - kE_0  0$ 关于 $T$ 的解。\n$$\nr\\ln(K/T)  kE_0 \\implies \\ln(K/T)  \\frac{kE_0}{r} \\implies \\frac{K}{T}  e^{kE_0/r} \\implies T  K e^{-kE_0/r}\n$$\n由于 $K, r, k, E_0$ 都是正常数，我们可以定义 $\\varepsilon = K e^{-kE_0/r}$，这是一个正数。对于任何 $T \\in (0, \\varepsilon)$，人均净增长率都是正的。因此，该陈述是对动力学的精确和准确描述。\n**结论：正确。**\n\n**C. 在逻辑斯谛增长模型下，$T=0$ 稳定的条件是 $kE_0rK$。**\n我们对逻辑斯谛增长的分析得出的条件是 $kE_0  r$。此选项中陈述的条件 $kE_0  rK$ 不同且不正确。环境承载力 $K$ 影响的是高肿瘤负荷时的动力学，而不是 $T=0$ 处的初始稳定性。\n**结论：不正确。**\n\n**D. 在 Gompertz 增长模型下，如果 $kE_0r\\ln K$，$T=0$ 是局部渐近稳定的。**\n我们对 Gompertz 模型的分析表明，对于任何有限的 $kE_0$，$T=0$ 都绝不会是局部渐近稳定的。在无穷小肿瘤大小时，人均增长率是无界的。该陈述与 Gompertz 模型在此背景下的这一基本性质相矛盾。\n**结论：不正确。**\n\n**E. 对于逻辑斯谛和 Gompertz 增长模型，小 $T$ 时的免疫清除阈值仅取决于 $K$ 而不取决于 $r$。**\n“免疫清除阈值”指的是免疫系统强度（$kE_0$）清除小肿瘤所需满足的条件。\n- 对于逻辑斯谛增长，该阈值为 $kE_0  r$。此条件取决于 $r$，而不取决于 $K$。\n- 对于 Gompertz 增长，不存在有限的阈值；在此模型中，清除无穷小的肿瘤是不可能的。\n该陈述对于逻辑斯谛情况是错误的，对于 Gompertz 情况则没有明确定义。因此，整个陈述是不正确的。\n**结论：不正确。**",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "将解析理论与计算应用相结合是现代生物医学系统建模的标志。最后一个实践  提供了一个分析肿瘤-免疫相互作用模型的完整工作流程，从理论推导到代码实现。你将首先通过解析方法确定免疫系统维持无肿瘤状态的条件，然后量化该状态对免疫杀伤率这一具有重要治疗意义的参数的敏感性。",
            "id": "3940449",
            "problem": "考虑一个双群体肿瘤-免疫相互作用模型，其中肿瘤细胞群体与效应免疫细胞相互作用。设 $T(t)$ 表示时间 $t$ 时的肿瘤细胞数量， $E(t)$ 表示时间 $t$ 时的效应免疫细胞数量。假设肿瘤细胞的增长遵循逻辑斯谛动力学，其承载能力为 $K$，内禀增长率为 $r$，且免疫介导的肿瘤细胞杀伤是双线性的，系数为 $\\kappa$。效应免疫细胞以恒定速率 $s$ 供给，以速率 $d$ 衰减，并经历具有饱和响应的抗原刺激增殖。该模型由以下常微分方程组给出：\n$$\n\\frac{dT}{dt} = r\\,T\\left(1 - \\frac{T}{K}\\right) - \\kappa\\,E\\,T,\n$$\n$$\n\\frac{dE}{dt} = s + \\frac{p\\,T\\,E}{h + T} - d\\,E,\n$$\n其中 $r0$ 的单位是 day$^{-1}$，$K0$ 的单位是细胞数，$\\kappa0$ 的单位是 cell$^{-1}$day$^{-1}$，$s0$ 的单位是 细胞/天，$d0$ 的单位是 day$^{-1}$，$p0$ 的单位是 day$^{-1}$，$h0$ 的单位是细胞数。假设所有参数均为严格正值，时间单位为天。\n\n根据动力系统的第一性原理，一个平衡点的局部稳定性由在该平衡点处求值的雅可比矩阵的特征值决定。无肿瘤平衡点出现在 $T^\\ast = 0$ 处，以及由免疫方程中的稳态平衡所设定的免疫水平 $E^\\ast$。基于以下基本事实进行推导：\n- 在平衡点附近对光滑动力系统进行线性化，会得到一个雅可比矩阵，其特征值决定了局部稳定性（特征值的实部为负意味着线性渐近稳定）。\n- 雅可比矩阵由系统方程右侧对状态变量的偏导数构成，并在平衡点处求值。\n仅使用这些基础，推导出无肿瘤平衡点处的雅可比矩阵，并根据参数确定其局部稳定性的条件。然后，使用局部敏感性的定义，推导与肿瘤动力学相关的主导特征值相对于 $\\kappa$ 的敏感性，以及一个无量纲的归一化敏感性指数。通过检查主导特征值的实部是否为负来明确说明无肿瘤平衡点是否为严格稳定；将特征值恰好为零的边界情况视为不稳定。\n\n敏感性分析目标和输出：\n- 关注量是在 $T^\\ast = 0$ 附近与肿瘤动力学相关的主导特征值的实部，单位为 day$^{-1}$。\n- 计算局部敏感性 $\\frac{\\partial \\lambda}{\\partial \\kappa}$ 和归一化的无量纲敏感性指数 $S_{\\mathrm{rel}} = \\left(\\frac{\\kappa}{|\\lambda|}\\right)\\frac{\\partial \\lambda}{\\partial \\kappa}$。为避免在归一化时当 $|\\lambda|=0$ 出现除以零的情况，在分母中使用一个小的正则化项 $\\varepsilon = 10^{-12}$ day$^{-1}$，并将 $S_{\\mathrm{rel}}$ 计算为 $-\\frac{\\kappa\\,E^\\ast}{|\\lambda| + \\varepsilon}$。\n- 将稳定性判定报告为一个布尔值，将单位为 day$^{-1}$ 的特征值四舍五入到六位小数，并将归一化敏感性指数四舍五入到六位小数。\n\n使用的参数范围是现实且科学上合理的：\n- 设定 $r \\in [0.01, 0.1]$ day$^{-1}$，$K \\in [10^9, 10^{12}]$ 细胞数，以及 $\\kappa \\in [10^{-12}, 10^{-9}]$ cell$^{-1}$day$^{-1}$。\n- 使用固定的免疫参数 $s$, $d$, $p$, 和 $h$，这些参数在没有肿瘤的情况下能产生一个合理的效应细胞水平 $E^\\ast$。为具体起见，使用 $s = 10^7$ 细胞/天，$d = 0.1$ day$^{-1}$，$p = 0.2$ day$^{-1}$，和 $h = 10^6$ 细胞数。\n\n您的程序必须实现基于推导的公式，并评估以下参数集测试套件，这些测试套件共同探讨了典型情况、边界条件、不稳定区域以及与承载能力 $K$ 的独立性：\n- 测试用例 1：$r = 0.05$ day$^{-1}$，$K = 1\\times 10^{11}$ 细胞数，$\\kappa = 1\\times 10^{-9}$ cell$^{-1}$day$^{-1}$，$s = 1\\times 10^7$ 细胞/天，$d = 0.1$ day$^{-1}$，$p = 0.2$ day$^{-1}$，$h = 1\\times 10^6$ 细胞数。\n- 测试用例 2（边界）：$r = 0.05$ day$^{-1}$，$K = 1\\times 10^{9}$ 细胞数，$\\kappa = 5\\times 10^{-10}$ cell$^{-1}$day$^{-1}$，$s = 1\\times 10^7$ 细胞/天，$d = 0.1$ day$^{-1}$，$p = 0.2$ day$^{-1}$，$h = 1\\times 10^6$ 细胞数。\n- 测试用例 3：$r = 0.05$ day$^{-1}$，$K = 1\\times 10^{12}$ 细胞数，$\\kappa = 1\\times 10^{-10}$ cell$^{-1}$day$^{-1}$，$s = 1\\times 10^7$ 细胞/天，$d = 0.1$ day$^{-1}$，$p = 0.2$ day$^{-1}$，$h = 1\\times 10^6$ 细胞数。\n- 测试用例 4：$r = 0.1$ day$^{-1}$，$K = 1\\times 10^{12}$ 细胞数，$\\kappa = 5\\times 10^{-10}$ cell$^{-1}$day$^{-1}$，$s = 1\\times 10^7$ 细胞/天，$d = 0.1$ day$^{-1}$，$p = 0.2$ day$^{-1}$，$h = 1\\times 10^6$ 细胞数。\n- 测试用例 5：$r = 0.01$ day$^{-1}$，$K = 1\\times 10^{10}$ 细胞数，$\\kappa = 1\\times 10^{-9}$ cell$^{-1}$day$^{-1}$，$s = 1\\times 10^7$ 细胞/天，$d = 0.1$ day$^{-1}$，$p = 0.2$ day$^{-1}$，$h = 1\\times 10^6$ 细胞数。\n\n对于每个测试用例，计算并返回：\n- 一个布尔值，指示无肿瘤平衡点是否严格稳定。\n- 与肿瘤动力学相关的主导特征值，单位为 day$^{-1}$，四舍五入到六位小数。\n- 归一化敏感性指数 $S_{\\mathrm{rel}}$，四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个测试用例的结果本身都是一个按所述顺序排列的列表，例如：$[[\\text{布尔值}, \\text{浮点数}, \\text{浮点数}], [\\text{布尔值}, \\text{浮点数}, \\text{浮点数}], \\dots]$。浮点数必须表示为：特征值的单位为 day$^{-1}$，归一化敏感性为无量纲，每个都四舍五入到六位小数。不应打印其他任何文本。",
            "solution": "该问题具有科学依据，提法恰当且客观。它提出了一个来自数学生物学的标准肿瘤-免疫相互作用模型，并要求基于动力系统理论的第一性原理，对一个平衡点进行经典的稳定性和敏感性分析。模型、参数和任务都定义清晰，不包含不一致之处或谬误。因此，我们可以进行完整求解。\n\n分析按以下四个连续步骤进行：\n1.  确定无肿瘤平衡点。\n2.  通过计算雅可比矩阵，对该平衡点周围的系统动力学进行线性化。\n3.  确定雅可比矩阵的特征值以评估局部稳定性。\n4.  推导相关特征值相对于肿瘤杀伤率参数 $\\kappa$ 的敏感性。\n\n设常微分方程组由函数 $f(T, E)$ 和 $g(T, E)$ 定义：\n$$\n\\frac{dT}{dt} = f(T, E) = r\\,T\\left(1 - \\frac{T}{K}\\right) - \\kappa\\,E\\,T\n$$\n$$\n\\frac{dE}{dt} = g(T, E) = s + \\frac{p\\,T\\,E}{h + T} - d\\,E\n$$\n\n**1. 无肿瘤平衡点 (TFE)**\n无肿瘤平衡点由条件 $T^\\ast = 0$ 定义。为了找到相应的效应细胞稳态水平 $E^\\ast$，我们在第二个方程中设置 $\\frac{dE}{dt} = 0$ 和 $T=T^\\ast=0$：\n$$\n\\frac{dE}{dt} \\bigg|_{T=0} = s + \\frac{p\\,(0)\\,E}{h + 0} - d\\,E = 0\n$$\n$$\ns - d\\,E = 0\n$$\n这给出了在没有肿瘤时平衡状态下的效应细胞群体：\n$$\nE^\\ast = \\frac{s}{d}\n$$\n因此，无肿瘤平衡点为 $(T^\\ast, E^\\ast) = (0, s/d)$。\n\n**2. TFE 处的雅可比矩阵**\n为了分析局部稳定性，我们通过计算雅可比矩阵 $J$ 来对系统进行线性化，该矩阵由 $f(T, E)$ 和 $g(T, E)$ 对 $T$ 和 $E$ 的偏导数组成。\n$$\nJ(T, E) = \\begin{pmatrix} \\frac{\\partial f}{\\partial T}  \\frac{\\partial f}{\\partial E} \\\\ \\frac{\\partial g}{\\partial T}  \\frac{\\partial g}{\\partial E} \\end{pmatrix}\n$$\n偏导数如下：\n$$\n\\frac{\\partial f}{\\partial T} = r\\left(1 - \\frac{T}{K}\\right) + rT\\left(-\\frac{1}{K}\\right) - \\kappa E = r - \\frac{2rT}{K} - \\kappa E\n$$\n$$\n\\frac{\\partial f}{\\partial E} = -\\kappa T\n$$\n$$\n\\frac{\\partial g}{\\partial T} = \\frac{(pE)(h+T) - (pTE)(1)}{(h+T)^2} = \\frac{pEh}{(h+T)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial E} = \\frac{pT}{h+T} - d\n$$\n接下来，我们在 TFE $(T^\\ast, E^\\ast) = (0, s/d)$ 处计算该矩阵的值：\n$$\nJ(0, s/d) = \\begin{pmatrix} r - \\frac{2r(0)}{K} - \\kappa (\\frac{s}{d})  -\\kappa (0) \\\\ \\frac{p(s/d)h}{(h+0)^2}  \\frac{p(0)}{h+0} - d \\end{pmatrix}\n$$\n简化该表达式可得到 TFE 处的雅可比矩阵：\n$$\nJ_{\\text{TFE}} = \\begin{pmatrix} r - \\kappa \\frac{s}{d}  0 \\\\ \\frac{ps}{dh}  -d \\end{pmatrix}\n$$\n\n**3. 特征值和稳定性条件**\n雅可比矩阵的特征值 $\\lambda$ 决定了平衡点的稳定性。由于 $J_{\\text{TFE}}$ 是一个下三角矩阵，其特征值就是其对角线上的元素：\n$$\n\\lambda_1 = r - \\kappa \\frac{s}{d}\n$$\n$$\n\\lambda_2 = -d\n$$\n问题要求分析“与肿瘤动力学相关的主导特征值”，即 $\\lambda_1$，因为它源于 $\\frac{\\partial f}{\\partial T}$ 项，并控制着肿瘤群体 $T$ 在 $T=0$ 附近的初始增长或衰减。我们将这个特征值表示为 $\\lambda$。\n$$\n\\lambda = r - \\kappa \\frac{s}{d}\n$$\n要使 TFE 局部渐近稳定，所有特征值的实部都必须严格为负。已知 $d  0$，所以 $\\lambda_2 = -d$ 始终是负实数。因此，稳定性完全由 $\\lambda$ 的符号决定。\n严格稳定性的条件是 $\\lambda  0$:\n$$\nr - \\kappa \\frac{s}{d}  0 \\implies r  \\kappa \\frac{s}{d}\n$$\n如果 $r - \\kappa \\frac{s}{d} \\ge 0$，则平衡点不稳定。问题指定边界情况 $\\lambda=0$ 被认为是不稳定的。\n\n**4. 敏感性分析**\n我们被要求找到 $\\lambda$ 相对于 $\\kappa$ 的局部敏感性，以及归一化的敏感性指数。\n我们关注的特征值是 $\\lambda = r - \\kappa \\frac{s}{d}$。\n\n局部敏感性是 $\\lambda$ 对 $\\kappa$ 的偏导数：\n$$\n\\frac{\\partial \\lambda}{\\partial \\kappa} = \\frac{\\partial}{\\partial \\kappa} \\left(r - \\kappa \\frac{s}{d}\\right) = -\\frac{s}{d}\n$$\n回想一下 $E^\\ast = s/d$，因此敏感性就是 $-E^\\ast$。\n\n归一化敏感性指数 $S_{\\mathrm{rel}}$ 定义为 $S_{\\mathrm{rel}} = \\left(\\frac{\\kappa}{|\\lambda|}\\right)\\frac{\\partial \\lambda}{\\partial \\kappa}$。代入我们推导出的敏感性：\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{|\\lambda|} \\left(-\\frac{s}{d}\\right) = -\\frac{\\kappa (s/d)}{|\\lambda|} = -\\frac{\\kappa E^\\ast}{|\\lambda|}\n$$\n问题提供了一个正则化公式用于计算，以避免在 $\\lambda = 0$ 时出现除以零的情况：\n$$\nS_{\\mathrm{rel}} = -\\frac{\\kappa E^\\ast}{|\\lambda| + \\varepsilon}\n$$\n其中 $\\varepsilon = 10^{-12} \\text{ day}^{-1}$。这个公式将直接被实现。\n\n请注意，参数 $K$、$p$ 和 $h$ 并未出现在 TFE 处的特征值表达式或 $\\lambda$ 的敏感性表达式中。这是预料之中的，因为涉及 $K$ 的项是 $T^2$ 阶的，而涉及 $p$ 和 $h$ 的项都乘以 $T$，在 $T=0$ 处的线性化中，所有这些项都变为零或无关紧要。\n\n**计算公式总结：**\n对于每个具有参数 $(r, K, \\kappa)$ 和固定参数 $(s, d, p, h)$ 的测试用例：\n1.  计算免疫平衡点：$E^\\ast = s/d$。\n2.  计算主导特征值：$\\lambda = r - \\kappa E^\\ast$。\n3.  确定稳定性：当且仅当 $\\lambda  0$ 时，TFE 是稳定的。\n4.  计算归一化敏感性：$S_{\\mathrm{rel}} = -\\frac{\\kappa E^\\ast}{|\\lambda| + \\varepsilon}$，其中 $\\varepsilon = 10^{-12}$。\n5.  将结果报告为 `[stability_boolean, rounded_lambda, rounded_S_rel]`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the tumor-immune interaction stability and sensitivity analysis problem.\n\n    The function implements the derived analytical formulas for the stability of\n    the tumor-free equilibrium (TFE) and the sensitivity of the governing\n    eigenvalue.\n    - The TFE is at (T*, E*) = (0, s/d).\n    - The eigenvalue associated with tumor dynamics is lambda = r - kappa * s/d.\n    - The TFE is strictly stable if lambda  0.\n    - The normalized sensitivity is S_rel = -(kappa * E*) / (|lambda| + epsilon).\n    \"\"\"\n\n    # Fixed immune parameters and regularization constant\n    s = 1.0e7  # cells/day\n    d = 0.1    # day^-1\n    p = 0.2    # day^-1 (unused in this specific analysis)\n    h = 1.0e6  # cells (unused in this specific analysis)\n    epsilon = 1.0e-12  # day^-1\n\n    # Test cases: (r, K, kappa)\n    # K, p, h are included for completeness but not used in the TFE stability calcs.\n    test_cases = [\n        # r (day^-1), K (cells), kappa (cell^-1*day^-1)\n        (0.05, 1.0e11, 1.0e-9),  # Test case 1\n        (0.05, 1.0e9, 5.0e-10),  # Test case 2 (boundary)\n        (0.05, 1.0e12, 1.0e-10), # Test case 3\n        (0.1, 1.0e12, 5.0e-10),  # Test case 4\n        (0.01, 1.0e10, 1.0e-9),  # Test case 5\n    ]\n\n    results = []\n    \n    # Calculate the equilibrium effector cell level (constant across cases)\n    E_star = s / d\n\n    for case in test_cases:\n        r, K, kappa = case\n\n        # 1. Calculate the dominant eigenvalue lambda\n        lambda_val = r - kappa * E_star\n\n        # 2. Determine stability (strictly stable if lambda  0)\n        is_stable = lambda_val  0\n\n        # 3. Calculate the normalized sensitivity index with regularization\n        # S_rel = -(kappa * (s/d)) / (|lambda| + epsilon)\n        S_rel = -(kappa * E_star) / (abs(lambda_val) + epsilon)\n\n        # 4. Format the results as specified\n        # Round floats to six decimal places\n        rounded_lambda = round(lambda_val, 6)\n        rounded_S_rel = round(S_rel, 6)\n        \n        # In Python, round(0.0, 6) is 0.0, which str() formats as '0.0'.\n        # To handle the large number in the boundary case, no special\n        # formatting is needed beyond the standard round and str.\n        if rounded_lambda == 0.0:\n            rounded_lambda = 0.0 # Ensures -0.0 is not possible after rounding\n            \n        result_tuple = [is_stable, rounded_lambda, rounded_S_rel]\n        results.append(result_tuple)\n\n    # 5. Final print statement in the exact required format\n    # The string representation of a list of lists matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}