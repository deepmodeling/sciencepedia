{
    "hands_on_practices": [
        {
            "introduction": "Complex biological models often contain numerous parameters, which can obscure the core mechanisms and make analysis cumbersome. This exercise introduces the powerful technique of non-dimensionalization to simplify a model of pathogen-immune interaction by systematically rescaling its variables. By choosing characteristic scales based on dominant physical or biological processes, you will learn to reduce the number of free parameters and derive key dimensionless groups that govern the system's behavior, providing deeper insight into its fundamental dynamics. ",
            "id": "3893326",
            "problem": "Consider the following mechanistic model of pathogen, effector cell, and cytokine dynamics formulated as a system of ordinary differential equations (ODEs). A pathogen population $P(t)$ grows logistically and is cleared by an effector population $E(t)$. Effector cells proliferate in response to antigen and cytokine stimulation and die at a constant per-capita rate. A cytokine $C(t)$ is produced by effector cells and decays rapidly. The model is\n$$\n\\frac{dP}{dt} \\;=\\; r\\,P\\left(1-\\frac{P}{K}\\right) \\;-\\; \\kappa\\,E\\,P,\n$$\n$$\n\\frac{dE}{dt} \\;=\\; \\alpha\\,\\frac{P}{P+\\theta}\\,\\frac{C}{C+\\gamma}\\,E \\;-\\; \\delta\\,E,\n$$\n$$\n\\frac{dC}{dt} \\;=\\; \\sigma\\,E \\;-\\; \\mu\\,C,\n$$\nwhere $r$ is the intrinsic pathogen growth rate, $K$ is the pathogen carrying capacity, $\\kappa$ is the pathogen clearance efficacy per effector, $\\alpha$ is the maximal antigen-driven effector proliferation rate, $\\theta$ is the half-saturation constant for antigenic stimulation, $\\gamma$ is the half-saturation constant for cytokine-mediated costimulation, $\\delta$ is the effector death rate, $\\sigma$ is the cytokine production rate per effector, and $\\mu$ is the cytokine decay rate. All parameters are positive and biologically plausible.\n\nYour tasks are:\n- Starting from core definitions of nondimensionalization and dominant balance, choose characteristic scales for time, pathogen, effector, and cytokine such that the parameter space is reduced and leading-order balances are explicitly revealed. Specifically:\n  - Let the characteristic time scale be set by the intrinsic pathogen growth, i.e., choose $t_{0}$ such that $t_{0}^{-1}$ equals the intrinsic growth rate.\n  - Let the characteristic pathogen scale be set by the carrying capacity.\n  - Determine the effector and cytokine scales by balancing the dominant terms in their respective production and loss processes when pathogen and effector are at their characteristic scales.\n- Introduce the dimensionless variables and parameters that result, and write the nondimensional ODEs.\n- Identify a small, dimensionless parameter that captures the separation of the fast cytokine decay time scale relative to the pathogen growth time scale, under the realistic assumption that cytokine turnover is much faster than pathogen population change.\n- Using dominant-balance reasoning, interpret the singularly perturbed structure that emerges in the cytokine equation and state the associated quasi-steady relation at leading order.\n\nProvide, as your final answer, the single closed-form analytic expression of the small parameter defined above, written explicitly in terms of the original dimensional parameters. Do not include units in the final boxed answer. If you introduce any acronyms, spell them out on first use (for example, ordinary differential equation (ODE)).",
            "solution": "The problem requires the nondimensionalization of a given system of ordinary differential equations (ODEs), the identification of a key small parameter, and the interpretation of the resulting singularly perturbed structure.\n\nThe system of ODEs is:\n$$\n\\frac{dP}{dt} \\;=\\; r\\,P\\left(1-\\frac{P}{K}\\right) \\;-\\; \\kappa\\,E\\,P\n$$\n$$\n\\frac{dE}{dt} \\;=\\; \\alpha\\,\\frac{P}{P+\\theta}\\,\\frac{C}{C+\\gamma}\\,E \\;-\\; \\delta\\,E\n$$\n$$\n\\frac{dC}{dt} \\;=\\; \\sigma\\,E \\;-\\; \\mu\\,C\n$$\n\nOur first task is to choose characteristic scales for time ($t$), pathogen population ($P$), effector cell population ($E$), and cytokine concentration ($C$). Let these scales be denoted $t_0$, $P_0$, $E_0$, and $C_0$ respectively. We introduce the dimensionless variables $\\tau$, $p$, $e$, and $c$ such that:\n$$\nt = t_0 \\tau, \\quad P = P_0 p, \\quad E = E_0 e, \\quad C = C_0 c\n$$\n\nThe problem specifies the scales for time and pathogen population:\n1.  The characteristic time scale $t_0$ is set by the intrinsic pathogen growth rate $r$. This means $t_0 = 1/r$.\n2.  The characteristic pathogen scale $P_0$ is set by the carrying capacity $K$. This means $P_0 = K$.\n\nNext, we determine the scales for the effector cells, $E_0$, and cytokine, $C_0$, by applying the principle of dominant balance to the governing equations.\n\nTo determine $E_0$, we examine the pathogen equation. The two terms on the right-hand side represent pathogen growth and clearance by effector cells. A meaningful dynamic interaction occurs when these two processes are of comparable magnitude. We therefore balance the intrinsic growth term, $rP$, with the clearance term, $\\kappa EP$, at their characteristic scales ($P \\sim P_0$, $E \\sim E_0$).\n$$\nr P_0 \\sim \\kappa E_0 P_0\n$$\nSolving for $E_0$, we find:\n$$\nE_0 = \\frac{r}{\\kappa}\n$$\nThis choice ensures that the dimensionless coefficient of the clearance term will be of order unity.\n\nTo determine $C_0$, we examine the cytokine equation. The two terms on the right-hand side represent cytokine production by effector cells and cytokine decay. A dominant balance here implies that production and decay rates are of the same order of magnitude when the variables are at their characteristic scales ($E \\sim E_0$, $C \\sim C_0$).\n$$\n\\sigma E_0 \\sim \\mu C_0\n$$\nSubstituting the expression for $E_0=r/\\kappa$ and solving for $C_0$, we obtain:\n$$\nC_0 = \\frac{\\sigma E_0}{\\mu} = \\frac{\\sigma r}{\\mu \\kappa}\n$$\nThis choice is equivalent to making a quasi-steady-state assumption for the cytokine dynamics at the scaling level, which is consistent with the problem's premise that cytokine turnover is rapid.\n\nThe complete set of scaling relations is:\n$$\nt = \\frac{1}{r}\\tau, \\quad P = Kp, \\quad E = \\frac{r}{\\kappa}e, \\quad C = \\frac{\\sigma r}{\\mu \\kappa}c\n$$\n\nNow we transform the original ODEs into their dimensionless form. The derivatives transform as:\n$$\n\\frac{d}{dt} = \\frac{d}{d(t_0 \\tau)} = \\frac{1}{t_0}\\frac{d}{d\\tau} = r\\frac{d}{d\\tau}\n$$\nSo, $\\frac{dP}{dt} = K r \\frac{dp}{d\\tau}$, $\\frac{dE}{dt} = \\frac{r^2}{\\kappa} \\frac{de}{d\\tau}$, and $\\frac{dC}{dt} = \\frac{\\sigma r^2}{\\mu \\kappa} \\frac{dc}{d\\tau}$.\n\nSubstituting these into the original ODEs:\n\n1.  Pathogen equation:\n$$\nK r \\frac{dp}{d\\tau} = r(Kp)\\left(1 - \\frac{Kp}{K}\\right) - \\kappa\\left(\\frac{r}{\\kappa}e\\right)(Kp)\n$$\n$$\nK r \\frac{dp}{d\\tau} = rKp(1-p) - rKep\n$$\nDividing the entire equation by $Kr$ yields the dimensionless pathogen equation:\n$$\n\\frac{dp}{d\\tau} = p(1-p) - ep\n$$\n\n2.  Effector equation:\n$$\n\\frac{r^2}{\\kappa} \\frac{de}{d\\tau} = \\alpha \\frac{Kp}{Kp+\\theta} \\frac{\\frac{\\sigma r}{\\mu \\kappa}c}{\\frac{\\sigma r}{\\mu \\kappa}c + \\gamma} \\left(\\frac{r}{\\kappa}e\\right) - \\delta\\left(\\frac{r}{\\kappa}e\\right)\n$$\nDividing by $r/\\kappa$:\n$$\nr \\frac{de}{d\\tau} = \\alpha \\frac{p}{p+\\theta/K} \\frac{c}{c+\\gamma/(\\frac{\\sigma r}{\\mu \\kappa})} e - \\delta e\n$$\nDividing by $r$:\n$$\n\\frac{de}{d\\tau} = \\left( \\frac{\\alpha}{r} \\frac{p}{p+\\theta/K} \\frac{c}{c + \\frac{\\gamma \\mu \\kappa}{\\sigma r}} - \\frac{\\delta}{r} \\right) e\n$$\nWe define the following dimensionless parameters:\n$\\beta_1 = \\frac{\\alpha}{r}$, the ratio of maximal effector proliferation to pathogen growth rate.\n$\\hat{\\theta} = \\frac{\\theta}{K}$, the dimensionless antigen saturation constant.\n$\\hat{\\gamma} = \\frac{\\gamma \\mu \\kappa}{\\sigma r}$, the dimensionless cytokine saturation constant.\n$\\beta_2 = \\frac{\\delta}{r}$, the ratio of the effector death rate to the pathogen growth rate.\nThe dimensionless effector equation is:\n$$\n\\frac{de}{d\\tau} = \\left( \\beta_1 \\frac{p}{p+\\hat{\\theta}} \\frac{c}{c+\\hat{\\gamma}} - \\beta_2 \\right) e\n$$\n\n3.  Cytokine equation:\n$$\n\\frac{\\sigma r^2}{\\mu \\kappa} \\frac{dc}{d\\tau} = \\sigma\\left(\\frac{r}{\\kappa}e\\right) - \\mu\\left(\\frac{\\sigma r}{\\mu \\kappa}c\\right)\n$$\n$$\n\\frac{\\sigma r^2}{\\mu \\kappa} \\frac{dc}{d\\tau} = \\frac{\\sigma r}{\\kappa}e - \\frac{\\sigma r}{\\kappa}c = \\frac{\\sigma r}{\\kappa}(e-c)\n$$\nDividing by $\\frac{\\sigma r}{\\kappa}$:\n$$\n\\frac{r}{\\mu}\\frac{dc}{d\\tau} = e-c\n$$\n\nThe final nondimensional system is:\n$$\n\\frac{dp}{d\\tau} = p(1-p) - ep\n$$\n$$\n\\frac{de}{d\\tau} = \\left( \\beta_1 \\frac{p}{p+\\hat{\\theta}} \\frac{c}{c+\\hat{\\gamma}} - \\beta_2 \\right) e\n$$\n$$\n\\frac{r}{\\mu}\\frac{dc}{d\\tau} = e-c\n$$\n\nThe third task is to identify a small parameter related to time scale separation. The characteristic time for pathogen growth is $t_{pathogen} \\sim 1/r$. The characteristic time for cytokine decay is $t_{cytokine} \\sim 1/\\mu$. The problem states that cytokine turnover is much faster than pathogen population change, which means $t_{cytokine} \\ll t_{pathogen}$, or $1/\\mu \\ll 1/r$. This implies $r/\\mu \\ll 1$.\n\nIn our dimensionless cytokine equation, we have the term $\\frac{r}{\\mu}$. Let us define this dimensionless parameter as $\\epsilon$:\n$$\n\\epsilon = \\frac{r}{\\mu}\n$$\nThe equation becomes $\\epsilon \\frac{dc}{d\\tau} = e-c$. Since $r/\\mu \\ll 1$, we have $\\epsilon \\ll 1$.\n\nThe final task is to interpret the singularly perturbed structure. The equation $\\epsilon \\frac{dc}{d\\tau} = e-c$ is a classic example of a singularly perturbed ODE, where the small parameter $\\epsilon$ multiplies the derivative. This indicates a separation of time scales: the variable $c$ evolves on a fast time scale of order $\\epsilon$, while $p$ and $e$ evolve on a slow time scale of order $1$.\n\nUsing dominant-balance reasoning for the slow time scale, we can approximate the dynamics by considering the limit $\\epsilon \\to 0$. This is known as a quasi-steady-state approximation. Setting $\\epsilon=0$ in the cytokine equation gives:\n$$\n0 = e - c\n$$\nThis implies the leading-order quasi-steady relation:\n$$\nc(\\tau) \\approx e(\\tau)\n$$\nThis means that on the time scale of pathogen and effector dynamics, the dimensionless cytokine concentration rapidly equilibrates and tracks the dimensionless effector cell population. The small parameter that quantifies this time scale separation is $\\epsilon = r/\\mu$.",
            "answer": "$$\\boxed{\\frac{r}{\\mu}}$$"
        },
        {
            "introduction": "A central question for any model of infection is predicting the conditions under which the immune system can successfully clear a pathogen. This practice guides you through a stability analysis of a bacteria-phagocyte interaction model to determine the critical threshold for infection control. You will apply the mathematical technique of linearization to evaluate the stability of the bacteria-free equilibrium, revealing how system parameters must be balanced to ensure effective clearance while preventing runaway inflammation. ",
            "id": "3893282",
            "problem": "Consider an acute bacterial infection at a localized tissue site modeled by the interaction between bacteria and activated phagocytes. Let $B(t)$ denote the bacterial load and $P(t)$ denote the density of activated phagocytes at the site. The following model reflects core biophysical and physiological principles: mass-action killing of bacteria by phagocytes, intrinsic bacterial growth constrained by a carrying capacity, baseline phagocyte influx from circulation, bacteria-triggered recruitment, linear phagocyte loss, and a locally linearized autocatalytic cytokine-driven amplification of phagocyte recruitment near baseline:\n$$\n\\frac{dB}{dt} \\;=\\; \\gamma\\,B\\left(1-\\frac{B}{K}\\right) \\;-\\; \\kappa\\,P\\,B,\n$$\n$$\n\\frac{dP}{dt} \\;=\\; \\lambda \\;+\\; \\rho\\,B \\;-\\; \\delta\\,P \\;+\\; \\sigma\\,P,\n$$\nwhere all parameters are nonnegative: $\\gamma$ is the maximal bacterial per-capita growth rate, $K$ is the bacterial carrying capacity, $\\kappa$ is the phagocyte-mediated killing rate constant, $\\lambda$ is the baseline phagocyte influx, $\\rho$ is the bacteria-triggered recruitment coefficient, $\\delta$ is the phagocyte loss rate, and $\\sigma$ is the local linearized coefficient describing cytokine-mediated autocatalytic amplification of phagocyte recruitment near baseline. Assume initial infections satisfy $B(0)\\ll K$ so that local stability of the bacteria-free state determines early clearance versus invasion.\n\nStarting from fundamental definitions of local (linear) stability for dynamical systems, analyze the bacteria-free equilibrium and derive, in closed form, the minimal baseline recruitment rate $\\lambda^{\\dagger}$ that ensures local bacterial clearance while simultaneously avoiding runaway inflammation. For the purpose of this problem, interpret runaway inflammation as the loss of stability of the phagocyte-only subsystem at $B=0$ (that is, net phagocyte growth when bacteria are absent), and interpret bacterial clearance as local asymptotic stability of the bacteria-free equilibrium.\n\nGive your final answer as the closed-form expression for $\\lambda^{\\dagger}$ in terms of the model parameters. Report $\\lambda^{\\dagger}$ in the same units as $\\lambda$ (for example, cells per second if $\\lambda$ is given in cells per second). Do not report any inequalities; report only the single expression for $\\lambda^{\\dagger}$. No rounding is required.",
            "solution": "The user wants to find the minimal baseline phagocyte recruitment rate, denoted as $\\lambda^{\\dagger}$, that ensures two conditions are met for the given system of differential equations:\n$$\n\\frac{dB}{dt} \\;=\\; \\gamma\\,B\\left(1-\\frac{B}{K}\\right) \\;-\\; \\kappa\\,P\\,B\n$$\n$$\n\\frac{dP}{dt} \\;=\\; \\lambda \\;+\\; \\rho\\,B \\;-\\; \\delta\\,P \\;+\\; \\sigma\\,P\n$$\nThe two conditions are:\n1.  **Avoiding runaway inflammation**: This is defined as the stability of the phagocyte-only subsystem at $B=0$.\n2.  **Local bacterial clearance**: This is defined as the local asymptotic stability of the bacteria-free equilibrium.\n\nFirst, we analyze the condition of \"avoiding runaway inflammation.\" This pertains to the dynamics of phagocytes in the absence of bacteria, i.e., when $B(t)=0$. The equation for the phagocyte density $P(t)$ becomes:\n$$\n\\frac{dP}{dt} = \\lambda - \\delta P + \\sigma P = \\lambda - (\\delta - \\sigma)P\n$$\nThis is a one-dimensional linear ordinary differential equation. An equilibrium exists at $P_0^* = \\frac{\\lambda}{\\delta - \\sigma}$, provided $\\delta \\neq \\sigma$. The stability of this equilibrium is determined by the coefficient of the $P$ term. Let $f(P) = \\lambda - (\\delta - \\sigma)P$. The system is stable if $\\frac{df}{dP}  0$. Here, $\\frac{df}{dP} = -(\\delta - \\sigma)$.\nFor stability, we require $-(\\delta - \\sigma)  0$, which simplifies to $\\delta - \\sigma > 0$, or $\\delta > \\sigma$. If this condition is not met (i.e., $\\delta \\le \\sigma$), the phagocyte population $P(t)$ would grow without bound, which corresponds to the \"runaway inflammation\" described in the problem. Therefore, to avoid runaway inflammation, the parameters of the system must satisfy the inequality $\\delta > \\sigma$. This condition also ensures that the equilibrium phagocyte level $P_0^*$ is positive, as $\\lambda$ is non-negative.\n\nNext, we analyze the condition of \"local bacterial clearance,\" which requires the bacteria-free equilibrium of the full system to be locally asymptotically stable. An equilibrium point $(B^*, P^*)$ is a solution to $\\frac{dB}{dt}=0$ and $\\frac{dP}{dt}=0$. The bacteria-free equilibrium corresponds to $B^*=0$.\nSubstituting $B^*=0$ into the system of equations yields:\n$$\n\\gamma(0)\\left(1-\\frac{0}{K}\\right) - \\kappa P^* (0) = 0\n$$\n$$\n\\lambda + \\rho(0) - \\delta P^* + \\sigma P^* = 0\n$$\nThe first equation is trivially satisfied ($0=0$). The second equation gives:\n$$\n\\lambda - (\\delta - \\sigma)P^* = 0 \\implies P^* = \\frac{\\lambda}{\\delta - \\sigma}\n$$\nThus, the bacteria-free equilibrium point is $E_0 = (B^*, P^*) = \\left(0, \\frac{\\lambda}{\\delta - \\sigma}\\right)$. As established before, for this equilibrium to be physically meaningful and for the phagocyte-only subsystem to be stable, we must have $\\delta > \\sigma$.\n\nTo determine the local stability of $E_0$, we compute the Jacobian matrix $J$ of the system, evaluated at this point. The general form of the Jacobian matrix is:\n$$\nJ(B, P) = \\begin{pmatrix} \\frac{\\partial}{\\partial B}\\frac{dB}{dt}  \\frac{\\partial}{\\partial P}\\frac{dB}{dt} \\\\ \\frac{\\partial}{\\partial B}\\frac{dP}{dt}  \\frac{\\partial}{\\partial P}\\frac{dP}{dt} \\end{pmatrix}\n$$\nThe component functions are $F_1(B, P) = \\gamma B - \\frac{\\gamma}{K}B^2 - \\kappa PB$ and $F_2(B, P) = \\lambda + \\rho B - (\\delta-\\sigma)P$. The partial derivatives are:\n$$\n\\frac{\\partial F_1}{\\partial B} = \\gamma - \\frac{2\\gamma}{K}B - \\kappa P\n$$\n$$\n\\frac{\\partial F_1}{\\partial P} = -\\kappa B\n$$\n$$\n\\frac{\\partial F_2}{\\partial B} = \\rho\n$$\n$$\n\\frac{\\partial F_2}{\\partial P} = -(\\delta - \\sigma)\n$$\nNow, we evaluate the Jacobian at the bacteria-free equilibrium $E_0 = \\left(0, \\frac{\\lambda}{\\delta - \\sigma}\\right)$:\n$$\nJ(E_0) = \\begin{pmatrix} \\gamma - \\frac{2\\gamma}{K}(0) - \\kappa \\left(\\frac{\\lambda}{\\delta - \\sigma}\\right)  -\\kappa (0) \\\\ \\rho  -(\\delta - \\sigma) \\end{pmatrix} = \\begin{pmatrix} \\gamma - \\frac{\\kappa \\lambda}{\\delta - \\sigma}  0 \\\\ \\rho  -(\\delta - \\sigma) \\end{pmatrix}\n$$\nThe eigenvalues, $\\mu$, of a triangular matrix are its diagonal entries. Therefore, the eigenvalues of $J(E_0)$ are:\n$$\n\\mu_1 = \\gamma - \\frac{\\kappa \\lambda}{\\delta - \\sigma}\n$$\n$$\n\\mu_2 = -(\\delta - \\sigma)\n$$\nFor the equilibrium $E_0$ to be locally asymptotically stable, all eigenvalues must have negative real parts. Since all parameters are real, this means both eigenvalues must be negative.\n1.  $\\mu_2  0 \\implies -(\\delta - \\sigma)  0 \\implies \\delta > \\sigma$. This is the same condition we found for avoiding runaway inflammation. It is a necessary structural property of the system for bacterial clearance to be possible.\n2.  $\\mu_1  0 \\implies \\gamma - \\frac{\\kappa \\lambda}{\\delta - \\sigma}  0$.\n\nThis second condition ensures that small bacterial perturbations will decay, leading to clearance. We can solve this inequality for $\\lambda$:\n$$\n\\gamma  \\frac{\\kappa \\lambda}{\\delta - \\sigma}\n$$\nSince we must have $\\delta > \\sigma$, the term $\\delta - \\sigma$ is positive. The parameters $\\kappa$ and $\\lambda$ are non-negative. For a non-trivial system, $\\kappa0$. We can multiply both sides by $\\frac{\\delta - \\sigma}{\\kappa}$ without changing the direction of the inequality:\n$$\n\\frac{\\gamma(\\delta - \\sigma)}{\\kappa}  \\lambda\n$$\nThis inequality defines the condition on the baseline recruitment rate $\\lambda$ that guarantees local bacterial clearance, given that runaway inflammation is avoided ($\\delta > \\sigma$). The problem asks for the minimal baseline recruitment rate, $\\lambda^{\\dagger}$, that ensures clearance. This corresponds to the threshold value at the boundary of the stability region. Thus, $\\lambda^{\\dagger}$ is the value of $\\lambda$ that makes the inequality an equality.\n$$\n\\lambda^{\\dagger} = \\frac{\\gamma(\\delta - \\sigma)}{\\kappa}\n$$\nFor any $\\lambda > \\lambda^{\\dagger}$, the bacteria-free equilibrium is stable, leading to clearance. At $\\lambda = \\lambda^{\\dagger}$, a transcritical bifurcation occurs where the stability of the bacteria-free state is lost. Therefore, $\\lambda^{\\dagger}$ represents the minimum required rate.",
            "answer": "$$\\boxed{\\frac{\\gamma(\\delta - \\sigma)}{\\kappa}}$$"
        },
        {
            "introduction": "A major goal of biomedical modeling is to design and optimize therapeutic interventions. This hands-on exercise bridges theory and application by tasking you with finding an optimal dosing strategy for an immune checkpoint inhibitor. You will implement a coupled pharmacokinetic/pharmacodynamic (PK/PD) model to simulate the effect of a drug on T cell exhaustion and reinvigoration, learning how to search for a dosing regimen that maximizes therapeutic benefit while adhering to a critical safety constraint. ",
            "id": "3893271",
            "problem": "Consider the coupling of a one-compartment pharmacokinetics (PK) model of a checkpoint inhibitor with pharmacodynamics (PD) of T cell exhaustion and reinvigoration. Start from the following fundamental bases: (i) mass balance in a well-mixed compartment, which implies that the rate of change of drug amount equals inputs minus outputs, and for first-order elimination in a compartment of fixed volume, the concentration decays exponentially; and (ii) population dynamics for T cells under homeostatic proliferation with logistic limitation, death, exhaustion conversion, and drug-induced reinvigoration. You will formalize the system in purely mathematical terms and compute discrete dosing strategies that maximize restoration of functional effector T cells without violating an overshoot safety bound.\n\nModel assumptions and definitions:\n\n- Pharmacokinetics (PK): Let $C(t)$ be the plasma concentration of the checkpoint inhibitor in $\\mathrm{mg/L}$ in a one-compartment model with clearance $CL$ in $\\mathrm{L/day}$ and volume of distribution $V$ in $\\mathrm{L}$. The elimination rate constant is $k_e = CL/V$ in $\\mathrm{day^{-1}}$. Between bolus doses at times $t_i$, the concentration obeys\n$$\\frac{dC}{dt} = -k_e C,$$\nand an instantaneous bolus dose of magnitude $D$ in $\\mathrm{mg}$ at time $t_i$ increases concentration by $\\Delta C = D/V$.\n\n- Pharmacodynamics (PD): Let $E(t)$ denote the functional effector T cell population in $\\mathrm{cells/\\mu L}$, and $X(t)$ denote exhausted T cells in $\\mathrm{cells/\\mu L}$. Effector cells proliferate logistically with intrinsic rate $r_E$ in $\\mathrm{day^{-1}}$ and carrying capacity $K$ in $\\mathrm{cells/\\mu L}$, die at rate $d_E$ in $\\mathrm{day^{-1}}$, and convert to exhaustion at baseline rate $k_{\\mathrm{exh}}$ in $\\mathrm{day^{-1}}$ modulated by checkpoint inhibition. Exhausted cells die at rate $d_X$ in $\\mathrm{day^{-1}}$ and can be reinvigorated to effector state at rate $k_{\\mathrm{rev}}$ in $\\mathrm{day^{-1}}$ modulated by checkpoint inhibition. The drug effect is represented by an $E_{\\max}$ model\n$$I(C) = E_{\\max} \\frac{C}{EC_{50} + C},$$\nwhere $E_{\\max} \\in [0,1]$ is the maximal inhibitory effect and $EC_{50}$ in $\\mathrm{mg/L}$ is the concentration for half-maximal effect. The exhaustion conversion rate is reduced to $k_{\\mathrm{exh}} (1 - I(C))$, and reinvigoration becomes $k_{\\mathrm{rev}} I(C)$. The coupled ordinary differential equations are\n$$\\frac{dE}{dt} = r_E E \\left(1 - \\frac{E+X}{K}\\right) - d_E E - k_{\\mathrm{exh}} (1 - I(C)) E + k_{\\mathrm{rev}} I(C) X,$$\n$$\\frac{dX}{dt} = k_{\\mathrm{exh}} (1 - I(C)) E - d_X X - k_{\\mathrm{rev}} I(C) X.$$\n\n- Initial conditions: At $t=0$, let $C(0) = 0$, $E(0) = E_0$, and $X(0) = X_0$.\n\n- Dosing schedule: Consider a discrete dosing protocol with $N$ identical bolus doses of magnitude $D$ in $\\mathrm{mg}$ given at times $t \\in \\{0, \\tau, 2\\tau, \\dots, (N-1)\\tau\\}$, where $\\tau$ in $\\mathrm{day}$ is the inter-dose interval. For this problem, you will search over a finite candidate set of $(D, \\tau)$ schedules.\n\n- Objective and constraint: For a fixed horizon $T_h$ in $\\mathrm{day}$, define the restoration objective as the time integral of effector cells above baseline,\n$$J(D,\\tau) = \\int_{0}^{T_h} \\max(E(t) - E_0, 0)\\, dt.$$\nDefine an overshoot safety bound $E_{\\mathrm{upper}}$ in $\\mathrm{cells/\\mu L}$. A schedule $(D,\\tau)$ is admissible if $\\max_{t \\in [0,T_h]} E(t) \\le E_{\\mathrm{upper}}$. The goal is to choose $(D,\\tau)$ that maximizes $J(D,\\tau)$ subject to admissibility. If multiple schedules achieve the same maximal objective, prefer the one with the smallest $D$. If no admissible schedule exists in the candidate set, return an indicator of infeasibility.\n\nAlgorithmic requirements:\n\n- Implement piecewise numerical integration of the coupled system with instantaneous bolus updates to $C(t)$ at dosing times, using a standard initial value problem solver.\n- Evaluate the objective $J(D,\\tau)$ using numerical quadrature based on the solverâ€™s output.\n- Enforce the overshoot constraint by checking the maximum of $E(t)$ over the trajectory.\n- Search over the finite candidate set of doses $D$ and intervals $\\tau$ given in each test case.\n\nPhysical and numerical units:\n\n- Express doses $D$ in $\\mathrm{mg}$, inter-dose intervals $\\tau$ in $\\mathrm{day}$, concentrations $C$ in $\\mathrm{mg/L}$, time in $\\mathrm{day}$, and T cell counts in $\\mathrm{cells/\\mu L}$.\n\nAngle units are not applicable. If any quantity must be expressed as a fraction, use decimal form.\n\nTest suite and parameter values:\n\nFor each test case $i$, all parameters are provided and scientifically plausible for immune checkpoint inhibitor therapy and T cell dynamics. Your program must process the following four test cases:\n\n- Case $1$ (moderate clearance, moderate potency, typical dynamics, happy path):\n    - $CL = 0.3$ $\\mathrm{L/day}$, $V = 3.0$ $\\mathrm{L}$, $EC_{50} = 0.5$ $\\mathrm{mg/L}$, $E_{\\max} = 0.8$,\n    - $K = 1000.0$ $\\mathrm{cells/\\mu L}$, $r_E = 0.05$ $\\mathrm{day^{-1}}$, $d_E = 0.02$ $\\mathrm{day^{-1}}$, $d_X = 0.03$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{exh}} = 0.04$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{rev}} = 0.06$ $\\mathrm{day^{-1}}$,\n    - $E_0 = 200.0$ $\\mathrm{cells/\\mu L}$, $X_0 = 300.0$ $\\mathrm{cells/\\mu L}$,\n    - $E_{\\mathrm{upper}} = 800.0$ $\\mathrm{cells/\\mu L}$, $T_h = 30.0$ $\\mathrm{day}$, $N = 3$ doses,\n    - Candidate $D \\in \\{0, 50, 100, 150, 200\\}$ $\\mathrm{mg}$, candidate $\\tau \\in \\{7, 14\\}$ $\\mathrm{day}$.\n\n- Case $2$ (high clearance, tighter safety bound, tests need for shorter interval):\n    - $CL = 0.9$ $\\mathrm{L/day}$, $V = 3.0$ $\\mathrm{L}$, $EC_{50} = 0.5$ $\\mathrm{mg/L}$, $E_{\\max} = 0.8$,\n    - $K = 1000.0$ $\\mathrm{cells/\\mu L}$, $r_E = 0.05$ $\\mathrm{day^{-1}}$, $d_E = 0.02$ $\\mathrm{day^{-1}}$, $d_X = 0.03$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{exh}} = 0.04$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{rev}} = 0.06$ $\\mathrm{day^{-1}}$,\n    - $E_0 = 200.0$ $\\mathrm{cells/\\mu L}$, $X_0 = 300.0$ $\\mathrm{cells/\\mu L}$,\n    - $E_{\\mathrm{upper}} = 750.0$ $\\mathrm{cells/\\mu L}$, $T_h = 30.0$ $\\mathrm{day}$, $N = 3$ doses,\n    - Candidate $D \\in \\{0, 50, 100, 150, 200\\}$ $\\mathrm{mg}$, candidate $\\tau \\in \\{7, 14\\}$ $\\mathrm{day}$.\n\n- Case $3$ (high potency, risk of overshoot):\n    - $CL = 0.3$ $\\mathrm{L/day}$, $V = 3.0$ $\\mathrm{L}$, $EC_{50} = 0.1$ $\\mathrm{mg/L}$, $E_{\\max} = 1.0$,\n    - $K = 1000.0$ $\\mathrm{cells/\\mu L}$, $r_E = 0.05$ $\\mathrm{day^{-1}}$, $d_E = 0.02$ $\\mathrm{day^{-1}}$, $d_X = 0.03$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{exh}} = 0.04$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{rev}} = 0.06$ $\\mathrm{day^{-1}}$,\n    - $E_0 = 200.0$ $\\mathrm{cells/\\mu L}$, $X_0 = 300.0$ $\\mathrm{cells/\\mu L}$,\n    - $E_{\\mathrm{upper}} = 700.0$ $\\mathrm{cells/\\mu L}$, $T_h = 30.0$ $\\mathrm{day}$, $N = 3$ doses,\n    - Candidate $D \\in \\{0, 50, 100, 150, 200\\}$ $\\mathrm{mg}$, candidate $\\tau \\in \\{7, 14\\}$ $\\mathrm{day}$.\n\n- Case $4$ (low reinvigoration efficacy, tests preference for minimal dosing):\n    - $CL = 0.3$ $\\mathrm{L/day}$, $V = 3.0$ $\\mathrm{L}$, $EC_{50} = 0.5$ $\\mathrm{mg/L}$, $E_{\\max} = 0.8$,\n    - $K = 1000.0$ $\\mathrm{cells/\\mu L}$, $r_E = 0.05$ $\\mathrm{day^{-1}}$, $d_E = 0.02$ $\\mathrm{day^{-1}}$, $d_X = 0.03$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{exh}} = 0.04$ $\\mathrm{day^{-1}}$, $k_{\\mathrm{rev}} = 0.0$ $\\mathrm{day^{-1}}$,\n    - $E_0 = 200.0$ $\\mathrm{cells/\\mu L}$, $X_0 = 300.0$ $\\mathrm{cells/\\mu L}$,\n    - $E_{\\mathrm{upper}} = 900.0$ $\\mathrm{cells/\\mu L}$, $T_h = 30.0$ $\\mathrm{day}$, $N = 3$ doses,\n    - Candidate $D \\in \\{0, 50, 100, 150, 200\\}$ $\\mathrm{mg}$, candidate $\\tau \\in \\{7, 14\\}$ $\\mathrm{day}$.\n\nFinal output format requirement:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element in this list corresponds to one test case and must itself be a list of two integers $[D_{\\mathrm{best}}, \\tau_{\\mathrm{best}}]$ reporting the optimal dose magnitude in $\\mathrm{mg}$ and the optimal inter-dose interval in $\\mathrm{day}$ for that case. If no admissible schedule exists in the candidate set, output the list $[-1, -1]$ for that case. For example, the output format must look like\n$$[[D_1,\\tau_1],[D_2,\\tau_2],[D_3,\\tau_3],[D_4,\\tau_4]].$$",
            "solution": "The user wants to solve an optimization problem for a pharmacokinetics/pharmacodynamics (PK/PD) model of T cell response to checkpoint inhibitor therapy. The solution requires numerical simulation of a system of ordinary differential equations (ODEs) and a search over a discrete set of dosing strategies.\n\n### Step 1: Extract Givens\nThe problem provides a coupled PK/PD model defined by a system of three ODEs for drug concentration $C(t)$, functional effector T cell population $E(t)$, and exhausted T cell population $X(t)$.\n\n**Pharmacokinetics (PK):**\n- State variable: $C(t)$ [$\\mathrm{mg/L}$]\n- Model: One-compartment model with first-order elimination.\n- ODE (between doses): $\\frac{dC}{dt} = -k_e C$\n- Elimination rate constant: $k_e = CL/V$ [$\\mathrm{day^{-1}}$]\n- Parameters: Clearance $CL$ [$\\mathrm{L/day}$], Volume of distribution $V$ [$\\mathrm{L}$]\n- Dosing: Instantaneous bolus dose $D$ [$\\mathrm{mg}$] at time $t_i$ causes concentration change $\\Delta C = D/V$.\n\n**Pharmacodynamics (PD):**\n- State variables: $E(t)$ [$\\mathrm{cells/\\mu L}$], $X(t)$ [$\\mathrm{cells/\\mu L}$]\n- Drug effect model: $I(C) = E_{\\max} \\frac{C}{EC_{50} + C}$\n- Parameters: Maximal effect $E_{\\max}$ (dimensionless), half-maximal concentration $EC_{50}$ [$\\mathrm{mg/L}$]\n- Coupled ODEs:\n$$ \\frac{dE}{dt} = r_E E \\left(1 - \\frac{E+X}{K}\\right) - d_E E - k_{\\mathrm{exh}} (1 - I(C)) E + k_{\\mathrm{rev}} I(C) X $$\n$$ \\frac{dX}{dt} = k_{\\mathrm{exh}} (1 - I(C)) E - d_X X - k_{\\mathrm{rev}} I(C) X $$\n- Parameters:\n    - $r_E$: Intrinsic proliferation rate of effector cells [$\\mathrm{day^{-1}}$]\n    - $K$: Carrying capacity [$\\mathrm{cells/\\mu L}$]\n    - $d_E$: Death rate of effector cells [$\\mathrm{day^{-1}}$]\n    - $d_X$: Death rate of exhausted cells [$\\mathrm{day^{-1}}$]\n    - $k_{\\mathrm{exh}}$: Baseline exhaustion conversion rate [$\\mathrm{day^{-1}}$]\n    - $k_{\\mathrm{rev}}$: Baseline reinvigoration rate [$\\mathrm{day^{-1}}$]\n\n**Simulation Setup:**\n- Initial conditions at $t=0$: $C(0) = 0$, $E(0) = E_0$, $X(0) = X_0$.\n- Dosing schedule: $N$ identical bolus doses of magnitude $D$ [$\\mathrm{mg}$] at times $t \\in \\{0, \\tau, 2\\tau, \\dots, (N-1)\\tau\\}$.\n- Time horizon: $T_h$ [$\\mathrm{day}$].\n\n**Optimization Problem:**\n- Objective function: Maximize restoration $J(D,\\tau) = \\int_{0}^{T_h} \\max(E(t) - E_0, 0)\\, dt$.\n- Constraint: Admissibility requires $\\max_{t \\in [0,T_h]} E(t) \\le E_{\\mathrm{upper}}$.\n- Search space: A finite candidate set of $(D, \\tau)$ pairs for each test case.\n- Tie-breaking rule: If multiple schedules yield the same maximal $J$, prefer the one with the smallest $D$.\n- Infeasibility: If no admissible schedule exists, return $[-1, -1]$.\n\n**Test Cases:** The problem provides four distinct test cases, each with a full set of parameter values and candidate schedules.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The model is a standard and well-accepted formulation in quantitative systems pharmacology. It combines a one-compartment PK model with a population dynamics model for immune cells, using established forms like first-order elimination, logistic growth, and the $E_{\\max}$ model for drug effect. All components are based on fundamental principles of mass balance and population dynamics. The model is scientifically sound for its intended purpose.\n- **Well-Posed:** The system of ODEs is defined with smooth (analytic) right-hand side functions, which guarantees the existence and uniqueness of a solution for given initial conditions. The optimization task is a search over a finite, discrete set of candidate schedules. For each candidate, the objective function and constraint are well-defined. Therefore, an optimal solution within the candidate set is guaranteed to exist, or it can be proven that no admissible solution exists. The problem is well-posed.\n- **Objective:** The problem is described using precise mathematical notation and unambiguous technical language. All parameters, variables, and objectives are clearly defined. It is free of subjective or opinion-based claims.\n- **Completeness and Consistency:** All necessary parameters ($CL$, $V$, $E_{\\max}$, $EC_{50}$, T cell dynamic rates, initial conditions, $N$, $T_h$, $E_{\\mathrm{upper}}$) and candidate schedules are provided for each test case. The units are consistent throughout the model definition.\n- **Other Flaws:** The problem does not exhibit any other flaws such as being unrealistic (within the context of mathematical modeling), ill-structured, trivial, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-defined computational problem in biomedical systems modeling. I will proceed with formulating and implementing the solution.\n\n### Principle-Based Design\nThe solution is designed around the core task of simulating the system's trajectory for each candidate dosing schedule, and then evaluating its performance against the specified objective and constraint.\n\n1.  **System Representation**: The state of the system is represented by a vector $\\mathbf{y}(t) = [C(t), E(t), X(t)]^T$. The dynamics are governed by the provided system of three coupled ODEs. The parameters for the ODEs are specific to each test case.\n\n2.  **Piecewise Numerical Integration**: The dosing protocol involves instantaneous changes (jumps) in the state variable $C(t)$ at discrete time points $t_k = k \\tau$. This requires a piecewise integration strategy. The simulation horizon $[0, T_h]$ is broken into segments, with endpoints defined by the dosing times and the final time $T_h$.\n    - The simulation proceeds sequentially from one segment to the next.\n    - At the beginning of each segment starting at a dosing time $t_k$, the concentration is instantaneously increased: $C(t_k^+) = C(t_k^-) + D/V$.\n    - A numerical ODE solver, specifically `scipy.integrate.solve_ivp` from the `scipy` library, is used to integrate the system over each continuous segment. This function is suitable for initial value problems and employs adaptive step-sizing to ensure accuracy and efficiency.\n    - The solutions from each segment are concatenated to form the complete trajectory over the entire time horizon $[0, T_h]$.\n\n3.  **Evaluation of Schedules**: After simulating a full trajectory for a given schedule $(D, \\tau)$:\n    - **Constraint Check**: The constraint $\\max_{t \\in [0,T_h]} E(t) \\le E_{\\mathrm{upper}}$ is checked by finding the maximum value of the computed $E(t)$ trajectory. If the constraint is violated, the schedule is deemed inadmissible.\n    - **Objective Calculation**: If the schedule is admissible, the objective function $J(D,\\tau) = \\int_{0}^{T_h} \\max(E(t) - E_0, 0)\\, dt$ is calculated. This is achieved by numerical quadrature. The trapezoidal rule, implemented by `numpy.trapz`, is applied to the function values $\\max(E(t_j) - E_0, 0)$ evaluated at the time points $t_j$ from the numerical solution.\n\n4.  **Optimization via Search**: The optimal schedule is found by performing an exhaustive search over the finite, discrete set of candidate pairs $(D, \\tau)$ provided for each test case.\n    - For each case, we initialize a \"best\" schedule tracker with a state indicating no admissible solution has been found yet (e.g., objective $J = -1.0$, schedule $[-1, -1]$).\n    - We iterate through all candidate schedules. For each one, we perform the simulation and evaluation steps.\n    - If a schedule is admissible, its objective value $J$ is compared to the best value found so far. The \"best\" schedule is updated if the new schedule has a strictly higher $J$, or if it has an equal $J$ but a smaller dose $D$, in accordance with the problem's tie-breaking rule.\n    - After checking all candidates, the final stored \"best\" schedule is the solution for the test case.\n\nThis structured approach ensures that each candidate schedule is rigorously evaluated according to the model's dynamics and the problem's criteria, leading to the identification of the optimal strategy.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the PK/PD optimization problem for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"CL\": 0.3, \"V\": 3.0, \"EC50\": 0.5, \"Emax\": 0.8,\n            \"K\": 1000.0, \"rE\": 0.05, \"dE\": 0.02, \"dX\": 0.03, \"k_exh\": 0.04, \"k_rev\": 0.06,\n            \"E0\": 200.0, \"X0\": 300.0,\n            \"Eupper\": 800.0, \"Th\": 30.0, \"N\": 3,\n            \"candidate_D\": [0, 50, 100, 150, 200], \"candidate_tau\": [7, 14],\n        },\n        {\n            \"CL\": 0.9, \"V\": 3.0, \"EC50\": 0.5, \"Emax\": 0.8,\n            \"K\": 1000.0, \"rE\": 0.05, \"dE\": 0.02, \"dX\": 0.03, \"k_exh\": 0.04, \"k_rev\": 0.06,\n            \"E0\": 200.0, \"X0\": 300.0,\n            \"Eupper\": 750.0, \"Th\": 30.0, \"N\": 3,\n            \"candidate_D\": [0, 50, 100, 150, 200], \"candidate_tau\": [7, 14],\n        },\n        {\n            \"CL\": 0.3, \"V\": 3.0, \"EC50\": 0.1, \"Emax\": 1.0,\n            \"K\": 1000.0, \"rE\": 0.05, \"dE\": 0.02, \"dX\": 0.03, \"k_exh\": 0.04, \"k_rev\": 0.06,\n            \"E0\": 200.0, \"X0\": 300.0,\n            \"Eupper\": 700.0, \"Th\": 30.0, \"N\": 3,\n            \"candidate_D\": [0, 50, 100, 150, 200], \"candidate_tau\": [7, 14],    \n        },\n        {\n            \"CL\": 0.3, \"V\": 3.0, \"EC50\": 0.5, \"Emax\": 0.8,\n            \"K\": 1000.0, \"rE\": 0.05, \"dE\": 0.02, \"dX\": 0.03, \"k_exh\": 0.04, \"k_rev\": 0.0,\n            \"E0\": 200.0, \"X0\": 300.0,\n            \"Eupper\": 900.0, \"Th\": 30.0, \"N\": 3,\n            \"candidate_D\": [0, 50, 100, 150, 200], \"candidate_tau\": [7, 14],\n        }\n    ]\n\n    final_results = []\n\n    for params in test_cases:\n        p = params # Use a shorthand for easier access\n        \n        # Define the ODE system as a nested function to capture parameters\n        def ode_system(t, y, k_e, EC50, Emax, K, rE, dE, dX, k_exh, k_rev):\n            C, E, X = y\n            \n            # Avoid division by zero or negative values for E and X\n            E = max(E, 0)\n            X = max(X, 0)\n\n            # Drug effect\n            I_C = Emax * C / (EC50 + C)\n            \n            # ODEs\n            dCdt = -k_e * C\n            dEdt = rE * E * (1 - (E + X) / K) - dE * E - k_exh * (1 - I_C) * E + k_rev * I_C * X\n            dXdt = k_exh * (1 - I_C) * E - dX * X - k_rev * I_C * X\n            \n            return [dCdt, dEdt, dXdt]\n\n        best_J = -1.0\n        best_schedule = [-1, -1]\n\n        k_e = p['CL'] / p['V']\n        ode_args = (k_e, p['EC50'], p['Emax'], p['K'], p['rE'], p['dE'], p['dX'], p['k_exh'], p['k_rev'])\n        \n        for tau in p['candidate_tau']:\n            for D in p['candidate_D']:\n                \n                # --- Piecewise Simulation ---\n                y0 = np.array([0.0, p['E0'], p['X0']])\n                t_current = 0.0\n                y_current = y0.copy()\n                \n                dose_times = {i * tau for i in range(p['N'])}\n                # Define integration stop points: dosing times and final horizon time\n                time_stops = sorted(list(dose_times | {0, p['Th']}))\n                \n                ts_pieces, ys_pieces = [], []\n                \n                for t_stop in time_stops:\n                    if t_stop = t_current:\n                        continue\n                        \n                    # Apply dose at the beginning of the interval\n                    if t_current in dose_times:\n                        y_current[0] += D / p['V']\n\n                    # Integrate over the segment\n                    sol = solve_ivp(\n                        fun=ode_system, \n                        t_span=[t_current, t_stop], \n                        y0=y_current,\n                        args=ode_args,\n                        rtol=1e-6, atol=1e-6, # Standard tolerances for accuracy\n                        method='RK45'\n                    )\n                    \n                    ts_pieces.append(sol.t)\n                    ys_pieces.append(sol.y)\n                    \n                    y_current = sol.y[:, -1]\n                    t_current = t_stop\n                \n                # Stitch the solution pieces together, removing duplicate time points\n                if not ts_pieces: \n                    # This case happens if Th=0, not applicable here, but good practice\n                    t_traj, y_traj = np.array([0.0]), np.array([y0]).T\n                else:\n                    t_traj = np.concatenate([pc if i == 0 else pc[1:] for i, pc in enumerate(ts_pieces)])\n                    y_traj = np.concatenate([pc if i == 0 else pc[:, 1:] for i, pc in enumerate(ys_pieces)], axis=1)\n\n                E_traj = y_traj[1, :]\n\n                # --- Evaluation and Optimization ---\n                # Check overshoot constraint\n                max_E = np.max(E_traj)\n                is_admissible = max_E = p['Eupper']\n\n                if is_admissible:\n                    # Calculate objective function J\n                    integrand = np.maximum(E_traj - p['E0'], 0)\n                    J = np.trapz(integrand, t_traj)\n                    \n                    # Update best schedule based on maximization and tie-breaking rule\n                    # The first admissible schedule will always satisfy J  best_J (since best_J starts at -1)\n                    if J  best_J or (np.isclose(J, best_J) and D  best_schedule[0]):\n                        best_J = J\n                        best_schedule = [int(D), int(tau)]\n        \n        final_results.append(best_schedule)\n        \n    print(f\"{final_results}\")\n\nsolve()\n```"
        }
    ]
}