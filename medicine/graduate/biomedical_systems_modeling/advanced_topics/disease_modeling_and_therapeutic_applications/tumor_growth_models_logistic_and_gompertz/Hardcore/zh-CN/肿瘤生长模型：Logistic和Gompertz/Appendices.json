{
    "hands_on_practices": [
        {
            "introduction": "逻辑斯谛（Logistic）和贡珀兹（Gompertz）模型都是描述受限生长的重要工具，但它们对生长速率如何随种群规模变化做了不同的假设。本练习将引导你从两个模型的基本定义出发，计算并比较在相同参数下的初始生长速率。通过这个实践，你将亲身体会到两种模型在预测肿瘤早期生长阶段时的根本性差异。",
            "id": "3940073",
            "problem": "一个体外肿瘤球体被监测，其活细胞总数被建模为时间 $t$ 的可微函数，记作 $N(t)$，其中 $N(t) \\in (0,\\infty)$。瞬时人均增长率定义为 $g(N) = \\frac{1}{N}\\frac{dN}{dt}$，其中 $\\frac{dN}{dt}$ 的单位是细胞/天，$g(N)$ 的单位是天$^{-1}$。考虑两种基于生物医学系统建模中广泛使用的增长定律的经典建模假设：(i) 在逻辑斯谛动态模型下，人均增长率 $g(N)$ 随种群大小 $N$ 线性减小，并满足边界条件 $g(0)=r$ 和 $g(K)=0$，其中 $r0$ 是内禀增长率常数，$K0$ 是环境承载力；(ii) 在贡珀兹动态模型下，人均增长率 $g(N)$ 与比率 $K/N$ 的对数成比例下降，这与经验性的贡珀兹定律（相对增长随规模在对数尺度上减小）一致，比例常数为 $r0$ 且 $g(K)=0$。从这些定义和边界条件出发，推导两种模型对应的 $\\frac{dN}{dt}$ 表达式，然后在给定 $r = 0.05$ 天$^{-1}$，$K = 10^{4}$ 细胞，以及 $N(0) = 10^{2}$ 细胞的条件下，计算两种模型的初始增长率 $\\left.\\frac{dN}{dt}\\right|_{t=0}$。使用自然对数 $\\ln(\\cdot)$。\n\n将你计算出的两个值按 $\\big($贡珀兹初始增长率, 逻辑斯谛初始增长率$\\big)$ 的顺序以单行矩阵的形式报告。两个值都以细胞/天为单位表示，并各自四舍五入到五位有效数字。最后，简要说明哪个初始增长率更大，并基于 $g(N)$ 的函数形式给出一个有理有据的解释，但不要将此定性比较包含在最终的数值答案中。",
            "solution": "问题要求推导和评估一个肿瘤球体在两种不同增长模型（逻辑斯谛和贡珀兹）下的初始增长率。活细胞数量由函数 $N(t)$ 表示，瞬时人均增长率定义为 $g(N) = \\frac{1}{N}\\frac{dN}{dt}$。因此，细胞种群的增长率由常微分方程 $\\frac{dN}{dt} = N \\cdot g(N)$ 描述。\n\n首先，我们分析逻辑斯谛模型。问题陈述人均增长率（我们记作 $g_L(N)$）随种群大小 $N$ 线性减小。这可以表示为 $g_L(N) = a - bN$，其中 $a$ 和 $b$ 是常数。给定的边界条件是 $g_L(0) = r$ 和 $g_L(K) = 0$，其中 $r  0$ 是内禀增长率常数，$K  0$ 是环境承载力。\n由第一个条件，$g_L(0) = a - b(0) = a = r$。\n由第二个条件，$g_L(K) = r - bK = 0$，这意味着 $b = \\frac{r}{K}$。\n因此，逻辑斯谛模型下的人均增长率为：\n$$ g_L(N) = r - \\frac{r}{K}N = r\\left(1 - \\frac{N}{K}\\right) $$\n对应的总细胞数微分方程是：\n$$ \\frac{dN}{dt} = N \\cdot g_L(N) = rN\\left(1 - \\frac{N}{K}\\right) $$\n我们被要求使用给定的参数计算初始增长率 $\\left.\\frac{dN}{dt}\\right|_{t=0}$：$r = 0.05$ 天$^{-1}$，$K = 10^{4}$ 细胞，以及 $N(0) = 10^{2}$ 细胞。初始增长率在 $N = N(0)$ 处计算：\n$$ \\left.\\frac{dN}{dt}\\right|_{t=0, \\text{Logistic}} = r N(0) \\left(1 - \\frac{N(0)}{K}\\right) $$\n代入数值：\n$$ \\left.\\frac{dN}{dt}\\right|_{t=0, \\text{Logistic}} = (0.05) \\cdot (10^2) \\left(1 - \\frac{10^2}{10^4}\\right) = 5 \\left(1 - 10^{-2}\\right) = 5 (1 - 0.01) = 5(0.99) = 4.95 \\, \\text{细胞/天} $$\n按要求，我们将此值四舍五入到五位有效数字，得到 $4.9500$ 细胞/天。\n\n接下来，我们分析贡珀兹模型。问题陈述人均增长率 $g_G(N)$ 与比率 $K/N$ 的对数成比例下降，比例常数为 $r$。这可以表示为：\n$$ g_G(N) = r \\ln\\left(\\frac{K}{N}\\right) $$\n此形式与边界条件 $g_G(K) = r \\ln(K/K) = r \\ln(1) = 0$ 一致。\n贡珀兹模型下的增长微分方程为：\n$$ \\frac{dN}{dt} = N \\cdot g_G(N) = rN \\ln\\left(\\frac{K}{N}\\right) $$\n我们使用相同的参数在 $N=N(0)$ 处计算初始增长率：\n$$ \\left.\\frac{dN}{dt}\\right|_{t=0, \\text{Gompertz}} = r N(0) \\ln\\left(\\frac{K}{N(0)}\\right) $$\n代入数值：\n$$ \\left.\\frac{dN}{dt}\\right|_{t=0, \\text{Gompertz}} = (0.05) \\cdot (10^2) \\ln\\left(\\frac{10^4}{10^2}\\right) = 5 \\ln(100) \\, \\text{细胞/天} $$\n使用自然对数，$\\ln(100) \\approx 4.605170186$。\n$$ \\left.\\frac{dN}{dt}\\right|_{t=0, \\text{Gompertz}} \\approx 5 \\times 4.605170186 = 23.02585093 \\, \\text{细胞/天} $$\n将此值四舍五入到五位有效数字，得到 $23.026$ 细胞/天。\n\n最后，我们对两个初始增长率进行有理有据的比较。计算出的贡珀兹模型的初始增长率（$23.026$ 细胞/天）远大于逻辑斯谛模型的初始增长率（$4.9500$ 细胞/天）。这种差异是两种模型的人均增长函数 $g_G(N)$ 和 $g_L(N)$ 的基本数学结构直接导致的结果。初始增长率为 $\\frac{dN}{dt}|_{t=0} = N(0) g(N(0))$。由于 $N(0)$ 在两种情况下是相同的，因此比较简化为比较 $g_G(N(0))$ 和 $g_L(N(0))$。\n这等价于比较 $r \\ln\\left(\\frac{K}{N(0)}\\right)$ 和 $r\\left(1 - \\frac{N(0)}{K}\\right)$。由于 $r0$，我们可以比较 $\\ln\\left(\\frac{K}{N(0)}\\right)$ 和 $1 - \\frac{N(0)}{K}$。\n令 $x = \\frac{N(0)}{K}$。由于 $0  N(0)  K$，我们有 $x \\in (0, 1)$。比较是在 $\\ln(1/x) = -\\ln(x)$ 和 $1-x$ 之间进行。著名的数学不等式 $-\\ln(x)  1-x$ 对所有 $x \\in (0, 1)$ 都成立。这可以通过分析函数 $\\phi(x) = -\\ln(x) - (1-x)$ 来证明。其导数为 $\\phi'(x) = -1/x + 1 = (x-1)/x$，对于 $x \\in (0, 1)$，该导数为负。由于 $\\phi(1)=0$ 且 $\\phi(x)$ 在 $(0,1)$ 上是严格递减的，因此对于所有 $x \\in (0,1)$，有 $\\phi(x)  0$。\n这个不等式表明，对于任何给定的 $r$ 和任何小于环境承载力 $K$ 的种群大小 $N$，贡珀兹模型预测的人均增长率总是大于逻辑斯谛模型预测的人均增长率。当初始种群相对于环境承载力较小时，这种差异尤其明显，就像本例中 $N(0)/K = 0.01$ 的情况一样，导致贡珀兹模型具有更快的初始增长阶段。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 23.026  4.9500 \\end{pmatrix}} $$"
        },
        {
            "introduction": "在了解了初始生长速率的差异后，一个自然的问题是：这两种模型的预测在整个生长过程中是如何演变的？本练习将带你进行更深入的分析，要求你推导出逻辑斯谛和贡珀兹模型的完整解析解 $N(t)$。通过构建并分析这两个解的比值，你将能够精确地理解它们的预测轨迹在何时发散、何时收敛，从而全面掌握它们之间的动态关系。",
            "id": "3940110",
            "problem": "一个肿瘤细胞群体通过两种经典的生长定律进行建模，这些定律基于对密度依赖性增殖的唯象观察：一种是逻辑斯谛模型，其人均生长速率随种群大小线性减小；另一种是Gompertz模型，其人均生长速率随种群大小对数减小。令 $N(t)$ 表示时间 $t$ 时的肿瘤细胞数量，初始条件为 $N(0) = N_{0}$，内禀增长率为 $r  0$，环境承载力为 $K  0$。假设 $0  N_{0}  K$。\n\n从人均生长速率的核心定义出发，即逻辑斯谛模型的常微分方程 (ODE) 为 $dN/dt = r\\,N\\left(1 - N/K\\right)$，Gompertz模型的常微分方程 (ODE) 为 $dN/dt = r\\,N\\,\\ln\\!\\left(K/N\\right)$，推导满足共同初始条件 $N(0)=N_{0}$ 和参数 $(r,K)$ 的精确解 $N_{\\text{log}}(t)$ 和 $N_{\\text{gom}}(t)$。\n\n然后，利用这些精确解，计算比率 $N_{\\text{log}}(t)/N_{\\text{gom}}(t)$ 作为 $t$、$r$、$K$ 和 $N_{0}$ 的函数的闭式表达式。最后，基于对所得函数形式的第一性原理分析，对在满足 $0  N_{0}  K$ 的固定参数下，该比率如何随 $t$ 变化进行定性讨论，包括其在 $t \\to 0$ 和 $t \\to \\infty$ 时的极限值，以及它是否具有任何内部极值。\n\n将你的最终答案表示为关于 $t$、$r$、$K$ 和 $N_{0}$ 的单个闭式解析表达式。该比率为无量纲；不需要单位。不需要四舍五入。",
            "solution": "该问题要求推导逻辑斯谛和Gompertz生长模型的解，计算这些解的比率，并对该比率随时间变化的行为进行定性分析。\n\n首先，我们处理逻辑斯谛模型。其控制性常微分方程 (ODE) 如下：\n$$\n\\frac{dN}{dt} = rN\\left(1 - \\frac{N}{K}\\right)\n$$\n这是一个可分离的一阶常微分方程。我们可以重排各项以分离变量 $N$ 和 $t$：\n$$\n\\frac{dN}{N\\left(1 - \\frac{N}{K}\\right)} = r \\, dt\n$$\n为了对左侧进行积分，我们使用部分分式分解。我们将分数重写为 $\\frac{K}{N(K-N)}$。\n$$\n\\frac{K}{N(K-N)} = \\frac{A}{N} + \\frac{B}{K-N}\n$$\n求解系数 $A$ 和 $B$，我们得到 $A=1$ 和 $B=1$。因此，方程变为：\n$$\n\\int \\left(\\frac{1}{N} + \\frac{1}{K-N}\\right) dN = \\int r \\, dt\n$$\n对两边积分得到：\n$$\n\\ln|N| - \\ln|K-N| = rt + C\n$$\n考虑到约束条件 $0  N_{0}  K$，种群 $N(t)$ 将保持在 $(0, K)$ 范围内，因此我们可以去掉绝对值符号。\n$$\n\\ln\\left(\\frac{N}{K-N}\\right) = rt + C\n$$\n我们使用初始条件 $N(0) = N_{0}$ 来确定积分常数 $C$：\n$$\n\\ln\\left(\\frac{N_{0}}{K-N_{0}}\\right) = r(0) + C \\implies C = \\ln\\left(\\frac{N_{0}}{K-N_{0}}\\right)\n$$\n将 $C$ 代回方程中得到：\n$$\n\\ln\\left(\\frac{N}{K-N}\\right) = rt + \\ln\\left(\\frac{N_{0}}{K-N_{0}}\\right)\n$$\n为了求解 $N(t)$，我们首先对两边取指数：\n$$\n\\frac{N}{K-N} = \\frac{N_{0}}{K-N_{0}} \\exp(rt)\n$$\n整理以分离出 $N(t)$：\n$$\nN(K-N_{0}) = (K-N)N_{0}\\exp(rt)\n$$\n$$\nN(K-N_{0}) + N N_{0}\\exp(rt) = K N_{0}\\exp(rt)\n$$\n$$\nN\\left(K-N_{0} + N_{0}\\exp(rt)\\right) = K N_{0}\\exp(rt)\n$$\n$$\nN(t) = \\frac{K N_{0}\\exp(rt)}{K-N_{0} + N_{0}\\exp(rt)}\n$$\n将分子和分母同除以 $N_{0}\\exp(rt)$，我们得到逻辑斯谛解的标准形式，记为 $N_{\\text{log}}(t)$：\n$$\nN_{\\text{log}}(t) = \\frac{K}{1 + \\left(\\frac{K-N_{0}}{N_{0}}\\right)\\exp(-rt)} = \\frac{K}{1 + \\left(\\frac{K}{N_{0}}-1\\right)\\exp(-rt)}\n$$\n\n接下来，我们推导Gompertz模型的解。其常微分方程为：\n$$\n\\frac{dN}{dt} = r N \\ln\\left(\\frac{K}{N}\\right)\n$$\n这同样是一个可分离的常微分方程。我们将其重排为：\n$$\n\\frac{dN}{N \\ln(K/N)} = r \\, dt\n$$\n为了对左侧积分，我们使用换元法，令 $u = \\ln(K/N) = \\ln(K) - \\ln(N)$。其微分为 $du = -\\frac{1}{N}dN$。积分变为：\n$$\n\\int -\\frac{du}{u} = \\int r \\, dt\n$$\n对两边积分得到：\n$$\n-\\ln|u| = rt + C'\n$$\n因为 $0  N  K$，所以 $K/N > 1$，因此 $u = \\ln(K/N) > 0$。我们可以去掉绝对值符号。\n$$\n-\\ln\\left(\\ln\\left(\\frac{K}{N}\\right)\\right) = rt + C'\n$$\n使用初始条件 $N(0) = N_{0}$ 来求解 $C'$：\n$$\nC' = -\\ln\\left(\\ln\\left(\\frac{K}{N_{0}}\\right)\\right)\n$$\n将 $C'$ 代回：\n$$\n-\\ln\\left(\\ln\\left(\\frac{K}{N}\\right)\\right) = rt - \\ln\\left(\\ln\\left(\\frac{K}{N_{0}}\\right)\\right)\n$$\n$$\n\\ln\\left(\\ln\\left(\\frac{K}{N_{0}}\\right)\\right) - \\ln\\left(\\ln\\left(\\frac{K}{N}\\right)\\right) = rt\n$$\n$$\n\\ln\\left(\\frac{\\ln(K/N_{0})}{\\ln(K/N)}\\right) = rt\n$$\n对两边取指数：\n$$\n\\frac{\\ln(K/N_{0})}{\\ln(K/N)} = \\exp(rt)\n$$\n求解 $\\ln(K/N)$：\n$$\n\\ln\\left(\\frac{K}{N}\\right) = \\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\n$$\n再次取指数以求解 $N(t)$，我们将其记为 $N_{\\text{gom}}(t)$：\n$$\n\\frac{K}{N} = \\exp\\left(\\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\\right)\n$$\n$$\nN_{\\text{gom}}(t) = K \\exp\\left(-\\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\\right)\n$$\n\n现在我们计算比率 $R(t) = N_{\\text{log}}(t) / N_{\\text{gom}}(t)$：\n$$\nR(t) = \\frac{N_{\\text{log}}(t)}{N_{\\text{gom}}(t)} = \\frac{\\frac{K}{1 + \\left(\\frac{K}{N_{0}}-1\\right)\\exp(-rt)}}{K \\exp\\left(-\\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\\right)}\n$$\n简化表达式，我们得到：\n$$\nR(t) = \\frac{1}{\\left(1 + \\left(\\frac{K}{N_{0}}-1\\right)\\exp(-rt)\\right) \\exp\\left(-\\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\\right)}\n$$\n通过将分母中的指数项移到分子，可以将其重写为更紧凑的形式：\n$$\nR(t) = \\frac{\\exp\\left(\\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\\right)}{1 + \\left(\\frac{K}{N_{0}}-1\\right)\\exp(-rt)}\n$$\n这就是所要求的比率的闭式表达式。\n\n最后，我们对该比率的行为进行定性讨论。\n1.  当 $t \\to 0$ 时的行为：当 $t \\to 0$ 时，$\\exp(-rt) \\to 1$。比率变为：\n    $$\n    R(0) = \\frac{\\exp\\left(\\ln\\left(\\frac{K}{N_{0}}\\right) \\cdot 1\\right)}{1 + \\left(\\frac{K}{N_{0}}-1\\right) \\cdot 1} = \\frac{K/N_{0}}{K/N_{0}} = 1\n    $$\n    这是符合预期的，因为两个模型都从相同的初始条件 $N_{0}$ 开始。\n\n2.  当 $t \\to \\infty$ 时的行为：当 $t \\to \\infty$ 时，$\\exp(-rt) \\to 0$（因为 $r > 0$）。比率变为：\n    $$\n    \\lim_{t\\to\\infty} R(t) = \\frac{\\exp\\left(\\ln\\left(\\frac{K}{N_{0}}\\right) \\cdot 0\\right)}{1 + \\left(\\frac{K}{N_{0}}-1\\right) \\cdot 0} = \\frac{\\exp(0)}{1} = 1\n    $$\n    这也是符合预期的，因为两个种群都趋向于相同的环境承载力 $K$。\n\n3.  当 $t \\in (0, \\infty)$ 时的行为：为了理解在这两个极限之间的行为，我们比较人均生长速率：\n    *   逻辑斯谛模型：$g_{\\text{log}}(N) = \\frac{1}{N}\\frac{dN}{dt} = r(1 - N/K)$。\n    *   Gompertz模型：$g_{\\text{gom}}(N) = \\frac{1}{N}\\frac{dN}{dt} = r\\ln(K/N)$。\n    令 $x = N/K$。对于定义域 $0  N  K$，我们有 $0  x  1$。我们比较 $g_{\\text{log}} = r(1-x)$ 和 $g_{\\text{gom}} = r\\ln(1/x) = -r\\ln(x)$。一个已知的数学不等式是，对于 $x \\in (0, 1)$，有 $\\ln(x)  x-1$。因此，$-\\ln(x) > 1-x$。这意味着对于所有的 $N \\in (0, K)$，都有 $g_{\\text{gom}}(N) > g_{\\text{log}}(N)$。\n    由于对于任何小于环境承载力的给定种群规模，Gompertz模型的人均生长速率严格大于逻辑斯谛模型的人均生长速率，因此从相同的初始值 $N_{0}$ 出发，Gompertz种群 $N_{\\text{gom}}(t)$ 的增长将总是快于逻辑斯谛种群 $N_{\\text{log}}(t)$。\n    因此，对于所有 $t > 0$，我们必然有 $N_{\\text{gom}}(t) > N_{\\text{log}}(t)$。这意味着它们的比率 $R(t) = N_{\\text{log}}(t) / N_{\\text{gom}}(t)$ 对于所有 $t \\in (0, \\infty)$ 都将小于1。\n    总之，比率 $R(t)$ 从值1开始，在某个 $t > 0$ 时减小到一个最小值，然后随着 $t \\to \\infty$ 渐近地增加回到1。这意味着至少存在一个内部极值（一个最小值）。",
            "answer": "$$\n\\boxed{\\frac{\\exp\\left(\\ln\\left(\\frac{K}{N_{0}}\\right) \\exp(-rt)\\right)}{1 + \\left(\\frac{K}{N_{0}} - 1\\right) \\exp(-rt)}}\n$$"
        },
        {
            "introduction": "理论分析揭示了模型间的差异，但在实际研究中，我们如何设计实验来最有效地验证哪个模型更符合真实数据呢？本练习将理论与实践相结合，介绍系统生物学中的一个核心概念——优化实验设计。你将学习如何通过最大化模型预测间的Kullback-Leibler散度，来算法化地确定最佳的实验采样时间点，从而以最高效的方式区分竞争的生长模型假说。",
            "id": "3940093",
            "problem": "您的任务是进行算法实验设计，以在加性高斯测量噪声下区分两种确定性肿瘤生长模型。这两种模型由常微分方程定义，这些方程编码了人均增长率法则：logistic 模型假设人均增长率随体积大小呈线性下降，而 Gompertz 模型假设人均增长率随体积大小的对数呈线性下降。令 $V(t)$ 表示时间 $t$ 时的肿瘤体积，单位为 $\\mathrm{mm}^3$。logistic 模型由微分方程 $dV/dt = r\\,V\\,(1 - V/K)$ 定义，初始条件为 $V(0) = V_0$，其中 $r$ 是内在增长率，单位为 $\\mathrm{day}^{-1}$，$K$ 是环境承载能力，单位为 $\\mathrm{mm}^3$。Gompertz 模型由微分方程 $dV/dt = r\\,V\\,\\ln(K/V)$ 定义，具有相同的初始条件 $V(0) = V_0$，其中 $r$ 和 $K$ 的解释与前者相同。观测数据在采样时间 $t_i$（$i = 1,\\dots,M$）进行采集，测量得到的体积被建模为 $Y_i = V(t_i) + \\varepsilon_i$，其中 $\\varepsilon_i$ 是独立的，服从 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 分布，$\\sigma$ 已知，单位为 $\\mathrm{mm}^3$。\n\n您的任务是通过选择 $M$ 个采样时间 $t_i$（单位为天）来设计一个实验，并遵循以下约束：每个 $t_i$ 必须位于 $t_{\\min}$ 和 $T$（含两端）之间的候选时间均匀网格上，网格步长为 $g$（即 $t \\in \\{t_{\\min}, t_{\\min}+g, t_{\\min}+2g,\\dots,T\\}$）；并且这些时间点必须满足最小间隔约束，即对所有 $i$ 都有 $t_{i+1} - t_i \\ge \\Delta$，其中 $\\Delta$ 的单位是天。目标是最大化从 logistic 数据生成模型到 Gompertz 竞争模型的期望 Kullback–Leibler 散度 (KLD)，该散度在选定的时间点 $(t_1,\\dots,t_M)$ 对观测向量 $(Y_1,\\dots,Y_M)$ 进行评估。对于给定的时间集合，期望 Kullback–Leibler 散度定义为（在 logistic 数据生成模型和高斯噪声下）在这些时间点上比较 logistic 和 Gompertz 预测分布的对数似然比的期望。\n\n从上述微分方程定义和高斯噪声模型出发，推导出期望 Kullback–Leibler 散度作为 $(t_1,\\dots,t_M)$ 和参数 $(V_0,K,r,\\sigma)$ 的函数，然后设计一个算法，在给定 $(V_0,K,r,\\sigma)$ 和 $(M,T,\\Delta,g,t_{\\min})$ 的情况下，选择网格上的 $M$ 个采样时间，以在满足间隔约束的条件下最大化期望 KLD。该算法必须输出所选时间，单位为天。\n\n您的程序必须实现推导出的算法，并为以下每个测试用例计算最优采样时间。对于每个用例，请报告所选时间的列表（单位为天），结果为浮点数并四舍五入到三位小数。\n\n测试套件：\n- 用例 1（一般情况）：$V_0 = 50\\,\\mathrm{mm}^3$, $K = 1500\\,\\mathrm{mm}^3$, $r = 0.08\\,\\mathrm{day}^{-1}$, $\\sigma = 40\\,\\mathrm{mm}^3$, $M = 6$, $T = 60\\,\\mathrm{days}$, $\\Delta = 5\\,\\mathrm{days}$, $g = 1\\,\\mathrm{day}$, $t_{\\min} = 0\\,\\mathrm{days}$。\n- 用例 2（单样本边界）：$V_0 = 10\\,\\mathrm{mm}^3$, $K = 1000\\,\\mathrm{mm}^3$, $r = 0.2\\,\\mathrm{day}^{-1}$, $\\sigma = 10\\,\\mathrm{mm}^3$, $M = 1$, $T = 40\\,\\mathrm{days}$, $\\Delta = 0\\,\\mathrm{days}$, $g = 0.5\\,\\mathrm{day}$, $t_{\\min} = 0\\,\\mathrm{days}$。\n- 用例 3（接近承载能力的初始条件边缘情况）：$V_0 = 950\\,\\mathrm{mm}^3$, $K = 1000\\,\\mathrm{mm}^3$, $r = 0.1\\,\\mathrm{day}^{-1}$, $\\sigma = 20\\,\\mathrm{mm}^3$, $M = 3$, $T = 20\\,\\mathrm{days}$, $\\Delta = 2\\,\\mathrm{days}$, $g = 1\\,\\mathrm{day}$, $t_{\\min} = 0\\,\\mathrm{days}$。\n- 用例 4（大间隔约束）：$V_0 = 100\\,\\mathrm{mm}^3$, $K = 1200\\,\\mathrm{mm}^3$, $r = 0.07\\,\\mathrm{day}^{-1}$, $\\sigma = 30\\,\\mathrm{mm}^3$, $M = 4$, $T = 60\\,\\mathrm{days}$, $\\Delta = 15\\,\\mathrm{days}$, $g = 1\\,\\mathrm{day}$, $t_{\\min} = 0\\,\\mathrm{days}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是对应一个用例的所选时间列表，按测试用例的顺序排列（例如， $[\\,[t_{1,1},\\dots,t_{1,M}],\\,[t_{2,1},\\dots,t_{2,M}],\\,[t_{3,1},\\dots,t_{3,M}],\\,[t_{4,1},\\dots,t_{4,M}]\\,]$）。所有时间都必须以天为单位表示，并四舍五入到三位小数。",
            "solution": "该问题具有科学依据、良定且客观。它基于标准的肿瘤生长模型和用于模型区分的既定最优实验设计原则。所有参数和约束都已明确定义，使得该问题是可解的。\n\n### 1. 目标函数的理论推导\n\n任务是最大化从数据生成的 logistic 模型到竞争的 Gompertz 模型的期望 Kullback-Leibler 散度 (KLD)。令 logistic 和 Gompertz 生长模型分别表示为 $L$ 和 $G$。它们在时间 $t$ 预测的肿瘤体积为 $V_L(t)$ 和 $V_G(t)$。\n\n在一组 $M$ 个采样时间 $\\mathbf{t} = (t_1, \\dots, t_M)$ 的测量过程会产生观测值 $Y = (Y_1, \\dots, Y_M)$，其中 $Y_i = V(t_i) + \\varepsilon_i$。噪声项 $\\varepsilon_i$ 是独立同分布的，服从 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n在给定模型（例如 $L$）下，观测值 $Y_i$ 的预测分布是一个以模型预测值为中心的正态分布：$p(Y_i | t_i, L) = \\mathcal{N}(Y_i; V_L(t_i), \\sigma^2)$。由于噪声项的独立性，整个数据向量 $Y$ 的似然是各个似然的乘积：\n$$ p(Y|\\mathbf{t},L) = \\prod_{i=1}^M \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(Y_i - V_L(t_i))^2}{2\\sigma^2}\\right) $$\n对于 Gompertz 模型 $p(Y|\\mathbf{t},G)$，也存在类似的表达式，只需用 $V_G(t_i)$ 替换 $V_L(t_i)$。\n\nKLD 是对数似然比的期望，其中期望是关于真实数据生成分布（此处假设为 logistic 模型）计算的。\n$$ D_{KL}(\\mathbf{t}) = \\mathbb{E}_{Y \\sim p(Y|\\mathbf{t},L)} \\left[ \\log\\frac{p(Y|\\mathbf{t},L)}{p(Y|\\mathbf{t},G)} \\right] $$\n\n对数似然比为：\n$$ \\log\\frac{p(Y|\\mathbf{t},L)}{p(Y|\\mathbf{t},G)} = \\log p(Y|\\mathbf{t},L) - \\log p(Y|\\mathbf{t},G) $$\n$$ = \\left( -\\frac{M}{2}\\log(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^M (Y_i - V_L(t_i))^2 \\right) - \\left( -\\frac{M}{2}\\log(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^M (Y_i - V_G(t_i))^2 \\right) $$\n$$ = \\frac{1}{2\\sigma^2} \\sum_{i=1}^M \\left[ (Y_i - V_G(t_i))^2 - (Y_i - V_L(t_i))^2 \\right] $$\n\n现在，对 $p(Y|\\mathbf{t},L)$ 求期望。在此分布下，$Y_i = V_L(t_i) + \\varepsilon_i$，因此 $\\mathbb{E}[Y_i] = V_L(t_i)$。\n对于和中的第二项：\n$$ \\mathbb{E}_L[(Y_i - V_L(t_i))^2] = \\mathbb{E}_L[\\varepsilon_i^2] = \\sigma^2 $$\n对于第一项：\n$$ \\mathbb{E}_L[(Y_i - V_G(t_i))^2] = \\mathbb{E}_L[((V_L(t_i) - V_G(t_i)) + \\varepsilon_i)^2] $$\n$$ = (V_L(t_i) - V_G(t_i))^2 + 2(V_L(t_i) - V_G(t_i))\\mathbb{E}_L[\\varepsilon_i] + \\mathbb{E}_L[\\varepsilon_i^2] $$\n由于 $\\mathbb{E}_L[\\varepsilon_i] = 0$：\n$$ = (V_L(t_i) - V_G(t_i))^2 + \\sigma^2 $$\n将这些期望代回 $D_{KL}(\\mathbf{t})$ 的表达式中：\n$$ D_{KL}(\\mathbf{t}) = \\frac{1}{2\\sigma^2} \\sum_{i=1}^M \\left[ ((V_L(t_i) - V_G(t_i))^2 + \\sigma^2) - \\sigma^2 \\right] $$\n$$ D_{KL}(\\mathbf{t}) = \\frac{1}{2\\sigma^2} \\sum_{i=1}^M (V_L(t_i) - V_G(t_i))^2 $$\n为了最大化 KLD，我们可以忽略正常数因子 $1/(2\\sigma^2)$，转而最大化模型预测值之间平方差的和。令 $d(t) = (V_L(t) - V_G(t))^2$。目标是找到时间集合 $\\{t_1, \\dots, t_M\\}$，在满足给定约束的条件下，最大化 $\\sum_{i=1}^M d(t_i)$。\n\n两个常微分方程在初始条件 $V(0)=V_0$ 下的解析解是：\n- **Logistic 模型：** $V_L(t) = \\frac{K}{1 + \\left(\\frac{K}{V_0} - 1\\right) e^{-rt}}$\n- **Gompertz 模型：** $V_G(t) = K \\left(\\frac{V_0}{K}\\right)^{\\exp(-rt)}$\n\n### 2. 最优时间选择的算法设计\n\n问题是从离散候选网格 $\\mathcal{T}_{\\text{cand}} = \\{t_{\\min}, t_{\\min}+g, \\dots, T\\}$ 中选择 $M$ 个时间点 $\\{t_1, \\dots, t_M\\}$，使得 $t_{i+1} - t_i \\ge \\Delta$，以最大化 $\\sum_{i=1}^M d(t_i)$。这是一个组合优化问题，可以使用动态规划高效解决。\n\n设排序后的候选时间为 $\\tau_0, \\tau_1, \\dots, \\tau_{N-1}$。令 $d_j = d(\\tau_j)$ 为选择时间 $\\tau_j$ 的得分。\n\n我们定义一个 DP 状态 `dp[k][i]` 为：从前 $i+1$ 个可用候选时间 $\\{\\tau_0, \\dots, \\tau_i\\}$ 中精确选择 $k+1$ 个测量时间，并强制将 $\\tau_i$ 作为第 $(k+1)$ 个时间点所获得的最大可能得分。索引是从 0 开始的：$k \\in \\{0, \\dots, M-1\\}$ 且 $i \\in \\{0, \\dots, N-1\\}$。我们还使用一个 `path[k][i]` 表来存储前一个所选时间点的索引，以便重建最优时间集。\n\n**DP 算法：**\n1.  **初始化**：\n    - 生成包含 $N$ 个候选时间的数组 `cand_times`。\n    - 为每个候选时间 $\\tau_i$ 计算得分 $d_i$，形成数组 `d_values`。\n    - 初始化 DP 表 `dp[M][N]` 和路径表 `path[M][N]`。\n    - 对于选择一个测量点的基本情况 ($k=0$)：\n      对于所有 $i \\in \\{0, \\dots, N-1\\}$，`dp[0][i] = d_values[i]`。\n      `path[0][i] = -1`。\n\n2.  **迭代**：\n    - 对于从 $1$ 到 $M-1$ 的 $k$（代表选择第 $(k+1)$ 个时间点）：\n        - 我们遍历这次第 $k+1$ 次测量的所有可能候选时间 $\\tau_i$，其中 $i \\in \\{k, \\dots, N-1\\}$。\n        - 对于每个 $\\tau_i$，我们需要找到满足间隔约束 $\\tau_i - \\tau_j \\ge \\Delta$ 的最佳前一个测量时间 $\\tau_j$。得分为 $d_i + \\text{dp}[k-1][j]$。\n        - 我们寻找在所有有效的前置时间中使 `dp[k-1][j]` 最大化的索引 $j$。这个搜索可以被优化。随着 $i$ 的增加，有效 $j$ 的集合会扩大。我们可以在遍历 $i$ 的同时，维护上一层（`dp[k-1]`）得分的动态最大值。\n        - 令 `running_max` 存储目前为止找到的、满足间隔约束的 `dp[k-1]` 中的最大得分，`best_j_idx` 是产生该最大值的索引。\n        - 递推关系为：`dp[k][i] = d_values[i] + running_max`。\n        - `path[k][i]` 存储 `best_j_idx`。\n\n    这会得到一个 $O(MN)$ 算法，因为对于 $M$ 个层级中的每一级，我们都会对 $N$ 个候选时间进行单次遍历。\n\n3.  **结果提取与回溯**：\n    - 填充 DP 表后，最大总得分是 DP 表最后一行的最大值，即 $\\max_{i} \\{\\text{dp}[M-1][i]\\}$。\n    - 令 `last_idx` 为找到该最大值的索引 $i$。这对应于最后一个最优测量时间 $\\tau_{\\text{last\\_idx}}$。\n    - 从 `path[M-1][last_idx]` 开始，我们通过 `path` 表进行回溯，以找到其他 $M-1$ 个最优时间的索引。\n    - 将索引序列反转，以生成最终排序好的最优时间列表。\n\n该算法保证在给定模型和约束条件下找到全局最优的采样时间集。",
            "answer": "[[27.000,32.000,37.000,42.000,47.000,52.000],[20.000],[0.000,2.000,4.000],[0.000,15.000,30.000,45.000]]"
        }
    ]
}