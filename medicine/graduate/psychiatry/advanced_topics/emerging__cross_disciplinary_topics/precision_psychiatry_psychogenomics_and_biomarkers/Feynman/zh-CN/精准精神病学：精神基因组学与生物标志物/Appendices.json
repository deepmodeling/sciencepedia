{
    "hands_on_practices": [
        {
            "introduction": "在基因组学研究中，我们经常同时进行成千上万次假设检验，这带来了“多重检验”的挑战。为了区分真实信号和随机噪音，我们必须调整统计显著性的标准。然而，并非所有研究的目标都完全相同，因此选择合适的统计学校正方法至关重要。本练习旨在挑战您理解控制族系误差率（FWER）和控制错误发现率（FDR）这两种策略在理念与实践上的差异，并将这种理解应用于精准精神病学领域的实际研究场景中。",
            "id": "4743168",
            "problem": "一个精准精神病学联盟正在计划两项分析。首先，一项发现阶段的全基因组关联研究（Genome-Wide Association Study, GWAS），涉及 $m=1{,}000{,}000$ 个单核苷酸多态性（Single Nucleotide Polymorphisms, SNPs），旨在识别与抗抑郁药治疗反应相关的变异。其次，一个包含 $m=20$ 个蛋白质组生物标志物的组合，旨在用于抗精神病药物治疗反应的即时临床分层。该团队必须在两种多重检验误差控制策略之间做出选择，每种策略都由一个基础的误差概念定义：族系误差率（Family-Wise Error Rate, FWER），即在整个检验族中至少发生一个I型错误的概率；以及错误发现率（False Discovery Rate, FDR），即在所有声明的发现中所占的假阳性比例的期望值。从基本原理出发，单个检验的I型错误是拒绝一个真实的原假设的概率；当检验多个假设时，控制总体风险必须反映出目标是最小化任何假阳性的机会（FWER控制），还是允许在发现中存在一个受控比例的假阳性（FDR控制）。控制FWER的Bonferroni方法使用概率的并集界，而控制FDR的Benjamini–Hochberg方法通过逐步选择发现来适应观测到的$p$-值的分布。\n\n哪些陈述正确地区分了这两种方法，并指出了在精准精神病学中各自更受青睐的应用场景？\n\nA. 通过Bonferroni方法进行族系误差率控制最适用于旨在用于即时临床决策的 $m=20$ 的蛋白质组学标志物组合，因为它限定了在整个组合中做出至少一个假阳性的概率，在检验之间存在任意依赖性的情况下仍然有效，并且与控制错误发现率的程序相比，在高维环境中往往会降低统计功效。\n\nB. Benjamini–Hochberg错误发现率控制最适用于 $m=1{,}000{,}000$ 个单核苷酸多态性的全基因组关联研究的发现阶段，因为它限定了在声明为显著的变异中错误发现的期望比例，并且在全局原假设下，它控制了任何发现的概率。\n\nC. 随着检验数量 $m$ 变得非常大，族系误差率控制下的每个检验的阈值变得更加严格，这通常会降低全基因组筛选中的功效；相比之下，错误发现率程序会随着越来越小的$p$-值的排名增加而提高拒绝阈值，从而适应信噪比结构，并通常在发现研究中以相同的总体误差目标产生更多的真实发现。\n\nD. Bonferroni校正要求$p$-值独立才有效，而Benjamini–Hochberg在检验之间存在任意依赖性的情况下仍然有效。\n\nE. 错误发现率控制在期望上消除了假阳性，这使得它在任何假阳性都不可接受的生物标志物组合的临床部署中更可取。\n\nF. 当检验族中所有原假设都为真时，在Benjamini–Hochberg程序下，错误发现率等于族系误差率。",
            "solution": "用户要求对问题陈述进行批判性验证，然后提供详细的解决方案和对所有选项的评估。\n\n### 第1步：提取已知信息\n\n-   **分析1（发现阶段）：** 全基因组关联研究（GWAS）\n    -   检验数量：$m = 1,000,000$ 个单核苷酸多态性（SNPs）\n    -   目标：识别与抗抑郁药治疗反应相关的变异。\n-   **分析2（临床应用）：** 蛋白质组生物标志物组合\n    -   检验数量：$m = 20$\n    -   目标：对抗精神病药物治疗反应进行即时临床分层。\n-   **误差控制定义：**\n    -   **族系误差率（FWER）：** 在整个检验族中至少发生一个I型错误的概率。\n    -   **错误发现率（FDR）：** 在所有声明的发现中所占的假阳性比例的期望值。\n    -   **I型错误（单个检验）：** 拒绝一个真实的原假设的概率。\n-   **控制程序定义：**\n    -   **Bonferroni方法：** 使用概率的并集界来控制FWER。\n    -   **Benjamini–Hochberg (BH)方法：** 通过逐步选择发现来适应观测到的$p$-值的分布，从而控制FDR。\n-   **问题：** 哪些陈述正确地区分了这两种方法，并指出了在精准精神病学中各自更受青睐的应用场景？\n\n### 第2步：使用提取的已知信息进行验证\n\n-   **科学基础：** 问题陈述具有科学依据。GWAS、蛋白质组学、FWER、FDR、Bonferroni校正和Benjamini-Hochberg程序都是生物统计学、基因组学及其在精准精神病学应用中的标准、明确定义的概念。所提出的情景（大规模发现研究 vs. 小规模临床组合）是现实的，并代表了多重检验校正中的一个经典权衡。\n-   **适定性：** 问题是适定的。它提供了清晰的定义和两个不同的情景。问题要求在这些情景下评估比较和对比这两种方法的陈述，这是一个可以基于已建立的统计理论解决的问题。\n-   **客观性：** 语言是客观、技术性的，没有偏见。它定义了术语，并要求正确应用这些定义。\n-   **其他缺陷：**\n    -   该问题没有违反任何基本的科学或数学原理。\n    -   它与指定的主题*精准精神病学：精神基因组学和生物标志物*直接相关。\n    -   设置是完整的且内部一致。\n    -   参数（GWAS的$m=1,000,000$，标志物组合的$m=20$）是现实的。\n    -   问题结构良好，并允许一组唯一的正确答案。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。开始进行解答。\n\n### 推导与逐项分析\n\n问题的核心在于理解FWER控制和FDR控制之间的权衡。FWER是一个严格的标准，旨在最小化做出任何一个假阳性声明的概率。FDR是一个较为宽松的标准，旨在控制所有阳性声明中假阳性声明的比例。两者之间的选择取决于研究的目标和对不同类型错误的容忍度。\n\n**A. 通过Bonferroni方法进行族系误差率控制最适用于旨在用于即时临床决策的 $m=20$ 的蛋白质组学标志物组合，因为它限定了在整个组合中做出至少一个假阳性的概率，在检验之间存在任意依赖性的情况下仍然有效，并且与控制错误发现率的程序相比，在高维环境中往往会降低统计功效。**\n\n-   **情景适宜性：** 对于一个用于“即时临床决策”的小型组合（$m=20$），假阳性的后果可能非常严重（例如，开出不正确或有害的治疗方案）。因此，控制FWER——即做出*任何*假阳性的概率——是首要考虑。这使得FWER控制非常适宜。\n-   **定义：** FWER“限定了做出至少一个假阳性的概率”这一陈述是FWER的正确定义。\n-   **有效性：** Bonferroni校正将单个显著性阈值设置为 $\\alpha/m$。其有效性源于布尔不等式（Boole's inequality）：对于一组事件 $E_1, \\dots, E_m$（此处指错误拒绝），$P(\\cup_{i=1}^m E_i) \\le \\sum_{i=1}^m P(E_i)$。这个不等式在事件之间存在任何依赖结构的情况下都成立。因此，通过Bonferroni控制FWER确实在任意依赖性下都有效。\n-   **功效：** FWER控制比FDR控制更保守。通过施加更严格的显著性标准，它内在地降低了统计功效（检测真实效应的能力），这种现象在高维设置（大 $m$）中尤其明显。这部分陈述也是正确的。\n\n该陈述的所有组成部分在统计上和情景上都是正确的。\n结论：**正确**\n\n**B. Benjamini–Hochberg错误发现率控制最适用于 $m=1{,}000{,}000$ 个单核苷酸多态性的全基因组关联研究的发现阶段，因为它限定了在声明为显著的变异中错误发现的期望比例，并且在全局原假设下，它控制了任何发现的概率。**\n\n-   **情景适宜性：** 一个包含 $m=1,000,000$ 次检验的GWAS是一个“发现阶段”的研究。其目标是生成一个有希望的候选SNPs列表以供后续验证。坚持FWER控制将导致一个极其严格的单次检验阈值（例如，$0.05/1,000,000 = 5 \\times 10^{-8}$），从而导致功效非常低，并可能错过许多真实的关联。在这种情况下，接受一个受控的假发现*比例*（FDR）以换取更高的功效，是标准且最适宜的策略。\n-   **定义：** FDR“限定了在声明为显著的变异中错误发现的期望比例”这一陈述是FDR的正确定义，形式上为 $E[V/R|R0] \\le \\alpha$，其中 $V$ 是假发现的数量，$R$ 是总发现的数量。\n-   **全局原假设属性：** 在全局原假设下，所有 $m$ 个原假设都为真。在这种情况下，任何发现（$R0$）根据定义都是一个假发现，因此 $V=R$。FDR是 $E[V/R|R0]P(R0) = E[1|R0]P(R0) = P(R0)$。FWER是做出至少一个假发现的概率，即 $P(V \\ge 1) = P(R \\ge 1) = P(R0)$。因此，在全局原假设下，FDR = FWER。如果BH程序在水平 $\\alpha$ 控制FDR，那么在这种特定情景下，它也必须在水平 $\\alpha$ 控制FWER。该陈述是正确的。\n\n该陈述的所有组成部分在统计上和情景上都是正确的。\n结论：**正确**\n\n**C. 随着检验数量 $m$ 变得非常大，族系误差率控制下的每个检验的阈值变得更加严格，这通常会降低全基因组筛选中的功效；相比之下，错误发现率程序会随着越来越小的$p$-值的排名增加而提高拒绝阈值，从而适应信噪比结构，并通常在发现研究中以相同的总体误差目标产生更多的真实发现。**\n\n-   **FWER行为：** 对于Bonferroni FWER控制，单个检验的显著性水平是 $\\alpha_{Bonf} = \\alpha / m$。当 $m \\to \\infty$ 时，$\\alpha_{Bonf} \\to 0$。这是一个日益严格的阈值，会降低功效。这部分是正确的。\n-   **FDR行为：** Benjamini-Hochberg程序涉及将$p$-值排序 $p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。然后找到最大的整数 $k$ 使得 $p_{(k)} \\le \\frac{k}{m}\\alpha$。对于第 $i$ 个排序的$p$-值的阈值是 $\\frac{i}{m}\\alpha$。这个阈值不是固定的；它“随着越来越小的$p$-值的排名增加而提高”，这是一个准确的描述。这种自适应性使得当存在许多真实信号（许多小的$p$-值）时，该程序比FWER控制更具功效，使其在发现研究中更优越。这部分也是正确的。\n\n该陈述准确地对比了FWER和FDR控制方法在高维设置中的行为。\n结论：**正确**\n\n**D. Bonferroni校正要求$p$-值独立才有效，而Benjamini–Hochberg在检验之间存在任意依赖性的情况下仍然有效。**\n\n-   **Bonferroni：** 正如在选项A的分析中解释的，Bonferroni校正依赖于布尔不等式，该不等式对任何事件集都成立，无论它们是独立的还是相关的。因此，Bonferroni并*不*要求独立性。第一部分是错误的。\n-   **Benjamini-Hochberg：** 最初的BH程序被证明在独立检验和表现出特定形式正相关性（正回归依赖性，Positive Regression Dependency, PRDS）的检验下可以控制FDR。它*不*保证在任意依赖结构下控制FDR。由Benjamini和Yekutieli提出的另一种方法（BY方法）可以在任意依赖性下控制FDR，但比标准的BH方法更保守。第二部分是错误的。\n\n该陈述中的两个主张在事实上都是不正确的。\n结论：**不正确**\n\n**E. 错误发现率控制在期望上消除了假阳性，这使得它在任何假阳性都不可接受的生物标志物组合的临床部署中更可取。**\n\n-   **FDR解释：** FDR控制并*不*“在期望上消除假阳性”。它控制的是在所有声明的阳性中假阳性的*期望比例*。假阳性的期望*数量* $E[V]$ 并非为零。例如，在FDR为$5\\%$且有$100$个发现的情况下，我们预计其中有$5$个是假的。该陈述是对FDR的严重错误描述。\n-   **情景应用：** 逻辑是颠倒的。“任何假阳性都不可接受”的情景恰恰是需要更严格的FWER控制的场合，而不是更宽松的FDR控制。\n\n该陈述基于一个有缺陷的前提，并得出了错误的结论。\n结论：**不正确**\n\n**F. 当检验族中所有原假设都为真时，在Benjamini–Hochberg程序下，错误发现率等于族系误差率。**\n\n-   **数学分析：** 假设全局原假设为真，即所有 $m$ 个单个原假设都为真。\n    -   FWER是犯一个或多个I型错误（假阳性）的概率。$FWER = P(V \\ge 1)$，其中 $V$ 是假阳性的数量。\n    -   FDR定义为 $FDR = E[V/R]$，其中 $R$ 是拒绝（发现）的数量。一个更精确的定义是 $FDR = E[V/R | R0]P(R0)$。\n    -   在全局原假设下，任何拒绝都是假阳性，所以 $V = R$。\n    -   因此，只要 $R0$，$V/R = 1$。\n    -   FDR变为 $FDR = E[1 | R0]P(R0) = P(R0)$。\n    -   因为 $V=R$，FWER是 $FWER = P(R \\ge 1) = P(R  0)$。\n    -   因此，在全局原假设下，$FDR = FWER$。\n-   任何在全局原假设下以水平 $\\alpha$ 控制FDR的程序，也必须以水平 $\\alpha$ 控制FWER。BH程序就是这样一种程序。该陈述是FDR的一个已知且正确的性质。\n\n该陈述在数学上是正确的。\n结论：**正确**",
            "answer": "$$\\boxed{ABCF}$$"
        },
        {
            "introduction": "在确定了适合研究目标的统计框架后，下一步便是将其应用于真实数据。本练习将以上一个练习中讨论的错误发现率（FDR）为基础，通过一个在生物标志物研究中常见的任务，带您进行一次动手实践。您将需要计算效应大小（对数倍数变化），并应用Benjamini-Hochberg程序从一组候选基因中识别出统计上显著的基因，同时有效控制FDR 。这个过程是从原始信号中筛选出有意义的生物标志物的关键一步。",
            "id": "4743128",
            "problem": "一项精准精神病学领域的联合研究整合了精神基因组学测量数据和源自血液的信使核糖核酸（mRNA）生物标志物，旨在识别与重度抑郁症（MDD）相关的转录特征。假设在 $n_{\\text{cases}} = 8$ 名 MDD 病例和 $n_{\\text{controls}} = 8$ 名匹配的对照者中测量了血清素转运蛋白基因 SLC6A4 的标准化转录本丰度（单位为任意单位，经文库大小和组成标准化后，样本间可比）。病例组的值为 $[5.1, 4.8, 5.7, 6.0, 4.9, 5.3, 5.6, 5.0]$，对照组的值为 $[3.8, 4.1, 3.9, 4.2, 3.7, 3.8, 4.0, 3.9]$。将这些值视为稳态表达的独立测量，这与分子生物学的中心法则和标准转录组学定量方法一致。令 $\\bar{x}_{\\text{cases}}$ 和 $\\bar{x}_{\\text{controls}}$ 分别表示病例组和对照组中 SLC6A4 的样本均值。\n\n另外，一个差异表达分析流程基于适当的、基于模型的统计数据，为 $m = 10$ 个候选 MDD 生物标志物基因（包括 SLC6A4）生成了基因水平的假设检验 $p$ 值。这十个基因及其对应的原始 $p$ 值为：\nSLC6A4: $0.0042$; FKBP5: $0.0018$; BDNF: $0.010$; NR3C1: $0.040$; COMT: $0.070$; MAOA: $0.090$; CACNA1C: $0.020$; HTR2A: $0.030$; DRD2: $0.050$; CRH: $0.060$。\n\n从样本均值、对数和错误发现率（FDR）的基本定义出发，完成以下任务：\n- 计算 SLC6A4 的差异表达对数倍数变化 $\\log_{2}\\!\\left(\\frac{\\bar{x}_{\\text{cases}}}{\\bar{x}_{\\text{controls}}}\\right)$。\n- 使用 Benjamini–Hochberg FDR 程序校正这十个原始 $p$ 值以获得 $q$ 值，然后找出与 SLC6A4 对应的 $q$ 值。\n\n仅报告 SLC6A4 的 Benjamini–Hochberg $q$ 值作为最终答案。将最终答案四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "我们首先将所需的计算形式化。设 SLC6A4 的病例组值为 $\\{x_{1}^{\\text{cases}}, \\dots, x_{8}^{\\text{cases}}\\}$，对照组值为 $\\{x_{1}^{\\text{controls}}, \\dots, x_{8}^{\\text{controls}}\\}$。样本均值为\n$$\n\\bar{x}_{\\text{cases}} = \\frac{1}{8} \\sum_{i=1}^{8} x_{i}^{\\text{cases}}, \\quad\n\\bar{x}_{\\text{controls}} = \\frac{1}{8} \\sum_{i=1}^{8} x_{i}^{\\text{controls}}.\n$$\n对数倍数变化定义为\n$$\n\\log_{2}\\!\\left(\\frac{\\bar{x}_{\\text{cases}}}{\\bar{x}_{\\text{controls}}}\\right) = \\frac{\\ln\\!\\left(\\bar{x}_{\\text{cases}}/\\bar{x}_{\\text{controls}}\\right)}{\\ln(2)}.\n$$\n\n对于多重假设检验，错误发现率（FDR）是在被拒绝的假设中假阳性所占的期望比例。Benjamini–Hochberg (BH) 程序通过将原始 $p$ 值按升序排列 $p_{(1)} \\le p_{(2)} \\le \\cdots \\le p_{(m)}$，然后计算校正后的值，将 FDR 控制在期望的水平\n$$\nq_{(i)} = \\min\\!\\left( \\frac{m}{i} \\, p_{(i)}, \\, q_{(i+1)} \\right),\n$$\n其中 $q_{(m)} = p_{(m)}$，以确保单调性 $q_{(1)} \\le q_{(2)} \\le \\cdots \\le q_{(m)}$。给定基因的 $q$ 值是映射回其原始标签的 BH 校正值。\n\n步骤 1：计算 SLC6A4 的 $\\bar{x}_{\\text{cases}}$ 和 $\\bar{x}_{\\text{controls}}$。\n病例组的值为 $[5.1, 4.8, 5.7, 6.0, 4.9, 5.3, 5.6, 5.0]$。求和，\n$$\n5.1 + 4.8 = 9.9, \\quad 9.9 + 5.7 = 15.6, \\quad 15.6 + 6.0 = 21.6, \\quad 21.6 + 4.9 = 26.5,\n$$\n$$\n26.5 + 5.3 = 31.8, \\quad 31.8 + 5.6 = 37.4, \\quad 37.4 + 5.0 = 42.4.\n$$\n因此，\n$$\n\\bar{x}_{\\text{cases}} = \\frac{42.4}{8} = 5.3.\n$$\n对照组的值为 $[3.8, 4.1, 3.9, 4.2, 3.7, 3.8, 4.0, 3.9]$。求和，\n$$\n3.8 + 4.1 = 7.9, \\quad 7.9 + 3.9 = 11.8, \\quad 11.8 + 4.2 = 16.0, \\quad 16.0 + 3.7 = 19.7,\n$$\n$$\n19.7 + 3.8 = 23.5, \\quad 23.5 + 4.0 = 27.5, \\quad 27.5 + 3.9 = 31.4.\n$$\n因此，\n$$\n\\bar{x}_{\\text{controls}} = \\frac{31.4}{8} = 3.925.\n$$\n因此，均值之比为\n$$\n\\frac{\\bar{x}_{\\text{cases}}}{\\bar{x}_{\\text{controls}}} = \\frac{5.3}{3.925} = \\frac{5300}{3925} = \\frac{212}{157}.\n$$\n对数倍数变化为\n$$\n\\log_{2}\\!\\left(\\frac{\\bar{x}_{\\text{cases}}}{\\bar{x}_{\\text{controls}}}\\right) = \\log_{2}\\!\\left(\\frac{212}{157}\\right) = \\frac{\\ln(212/157)}{\\ln(2)}.\n$$\n直观地看，$\\frac{212}{157} \\approx 1.350955$，因此对数倍数变化是正的，表明病例组的表达水平高于对照组。\n\n步骤 2：应用 Benjamini–Hochberg 程序获得 $q$ 值，并找出 SLC6A4 的 $q$ 值。\n我们有 $m = 10$ 个原始 $p$ 值：\n$$\n\\text{SLC6A4}: 0.0042; \\quad \\text{FKBP5}: 0.0018; \\quad \\text{BDNF}: 0.010; \\quad \\text{NR3C1}: 0.040; \\quad \\text{COMT}: 0.070;\n$$\n$$\n\\text{MAOA}: 0.090; \\quad \\text{CACNA1C}: 0.020; \\quad \\text{HTR2A}: 0.030; \\quad \\text{DRD2}: 0.050; \\quad \\text{CRH}: 0.060.\n$$\n将它们按升序排列：\n$$\np_{(1)} = 0.0018, \\quad p_{(2)} = 0.0042, \\quad p_{(3)} = 0.010, \\quad p_{(4)} = 0.020, \\quad p_{(5)} = 0.030,\n$$\n$$\np_{(6)} = 0.040, \\quad p_{(7)} = 0.050, \\quad p_{(8)} = 0.060, \\quad p_{(9)} = 0.070, \\quad p_{(10)} = 0.090.\n$$\n计算初始 BH 校正值 $\\tilde{q}_{(i)} = \\frac{m}{i} p_{(i)}$：\n$$\n\\tilde{q}_{(1)} = \\frac{10}{1} \\cdot 0.0018 = 0.018, \\quad \\tilde{q}_{(2)} = \\frac{10}{2} \\cdot 0.0042 = 0.021,\n$$\n$$\n\\tilde{q}_{(3)} = \\frac{10}{3} \\cdot 0.010 \\approx 0.033333\\ldots,\n$$\n$$\n\\tilde{q}_{(4)} = \\frac{10}{4} \\cdot 0.020 = 0.050, \\quad \\tilde{q}_{(5)} = \\frac{10}{5} \\cdot 0.030 = 0.060,\n$$\n$$\n\\tilde{q}_{(6)} = \\frac{10}{6} \\cdot 0.040 \\approx 0.066666\\ldots, \\quad \\tilde{q}_{(7)} = \\frac{10}{7} \\cdot 0.050 \\approx 0.071428\\ldots,\n$$\n$$\n\\tilde{q}_{(8)} = \\frac{10}{8} \\cdot 0.060 = 0.075, \\quad \\tilde{q}_{(9)} = \\frac{10}{9} \\cdot 0.070 \\approx 0.077777\\ldots,\n$$\n$$\n\\tilde{q}_{(10)} = \\frac{10}{10} \\cdot 0.090 = 0.090.\n$$\n现在通过设置来强制执行单调性\n$$\nq_{(10)} = \\tilde{q}_{(10)} = 0.090,\n$$\n并且对于 $i = 9, 8, \\dots, 1$，\n$$\nq_{(i)} = \\min\\!\\left( \\tilde{q}_{(i)}, \\, q_{(i+1)} \\right).\n$$\n因为上面计算出的序列 $\\tilde{q}_{(i)}$ 已经是非递减的，我们得到\n$$\nq_{(1)} = 0.018, \\quad q_{(2)} = 0.021, \\quad q_{(3)} \\approx 0.033333\\ldots, \\quad q_{(4)} = 0.050, \\quad q_{(5)} = 0.060,\n$$\n$$\nq_{(6)} \\approx 0.066666\\ldots, \\quad q_{(7)} \\approx 0.071428\\ldots, \\quad q_{(8)} = 0.075, \\quad q_{(9)} \\approx 0.077777\\ldots, \\quad q_{(10)} = 0.090.\n$$\n映射回基因标签。SLC6A4 对应于 $p = 0.0042$，这是第二小的值，即 $p_{(2)}$。因此，SLC6A4 的 BH $q$ 值为\n$$\nq_{\\text{SLC6A4}} = q_{(2)} = 0.021.\n$$\n\n四舍五入到四位有效数字，$q_{\\text{SLC6A4}} = 0.02100$。",
            "answer": "$$\\boxed{0.02100}$$"
        },
        {
            "introduction": "精准精神病学的最终目标是将基因组信息转化为临床应用价值，以改善患者的预后。本练习将展示如何使用源自全基因组关联研究（GWAS）的强效生物标志物——多基因风险评分（PRS），来预测患者的长期临床结局。您将应用生存分析和Cox比例风险模型的基本原理，来量化遗传风险如何对疾病复发的可能性进行分层，从而将基因组数据与患者的病程轨迹直接联系起来。",
            "id": "4743145",
            "problem": "一个研究团队正在使用多基因风险评分 (PRS) 四分位数来研究重度抑郁症患者的复发风险。该团队应用 Cox 比例风险模型和 Kaplan–Meier (KM) 估计，按 PRS 四分位数对生存曲线进行分层。假设复发的基线风险随时间恒定，这与指数生存模型一致，并且队列在各个四分位数中均匀分布。使用以下有科学依据的基础和假设，计算在固定时间范围内各四分位数的累积发生率。\n\n基本原理：\n- 风险函数 $h(t)$ 定义了在时间 $t$ 的瞬时事件率。\n- 累积风险为 $\\Lambda(t) = \\int_{0}^{t} h(u)\\,du$。\n- 生存函数为 $S(t) = \\exp\\!\\big(-\\Lambda(t)\\big)$。\n- 在 Cox 比例风险模型中，特定组的风险为 $h_{g}(t) = \\theta_{g}\\,h_{0}(t)$，其中 $h_{0}(t)$ 是基线风险，$\\theta_{g}$ 是组 $g$ 的风险比 (HR)。\n- 累积发生率函数为 $F(t) = 1 - S(t)$。\n- Kaplan–Meier (KM) 估计量是 $S(t)$ 的一个非参数估计量；当真实风险恒定且删失是独立的时，KM 和指数模型在期望上彼此一致。\n\n情景与参数：\n- 定义了四个 PRS 四分位数 $Q_{1}, Q_{2}, Q_{3}, Q_{4}$，各组比例相等，即 $p_{1} = p_{2} = p_{3} = p_{4} = \\frac{1}{4}$。\n- 最低 PRS 四分位数 $Q_{1}$ 的基线风险是恒定的：$h_{0}(t) = \\lambda$，其中 $\\lambda = 5.0 \\times 10^{-2}$ 每月。\n- 根据使用 PRS 四分位数指标拟合的 Cox 模型，相对于 $Q_{1}$ 的估计风险比 (HRs) 分别为 $\\theta_{1} = 1.00$、$\\theta_{2} = 1.35$、$\\theta_{3} = 1.75$ 和 $\\theta_{4} = 2.40$。\n- 考虑的时间范围为 $T = 12$ 个月。\n\n任务：\n- 使用比例风险框架和指数生存基础，计算在 $g \\in \\{1,2,3,4\\}$ 时各四分位数特定的累积发生率 $F_{g}(T)$，然后计算在时间 $T$ 时所有四分位数的总体累积发生率 $F_{\\text{overall}}(T) = \\sum_{g=1}^{4} p_{g}\\,F_{g}(T)$。\n- 以小数形式表示最终答案。\n- 将最终答案四舍五入到四位有效数字。",
            "solution": "我们从风险、累积风险和生存的定义开始。在 Cox 比例风险模型下，组 $g$ 的风险函数为 $h_{g}(t) = \\theta_{g}\\,h_{0}(t)$，其中 $h_{0}(t)$ 是基线风险，$\\theta_{g}$ 是组 $g$ 的风险比 (HR)。组 $g$ 在时间 $t$ 之前的累积风险为\n$$\n\\Lambda_{g}(t) = \\int_{0}^{t} h_{g}(u)\\,du = \\int_{0}^{t} \\theta_{g}\\,h_{0}(u)\\,du = \\theta_{g}\\,\\Lambda_{0}(t),\n$$\n其中 $\\Lambda_{0}(t) = \\int_{0}^{t} h_{0}(u)\\,du$ 是基线累积风险。\n\n生存函数为 $S_{g}(t) = \\exp\\!\\big(-\\Lambda_{g}(t)\\big) = \\exp\\!\\big(-\\theta_{g}\\,\\Lambda_{0}(t)\\big)$，累积发生率为 $F_{g}(t) = 1 - S_{g}(t) = 1 - \\exp\\!\\big(-\\theta_{g}\\,\\Lambda_{0}(t)\\big)$。\n\n因为基线风险是恒定的 $h_{0}(t) = \\lambda$，所以基线累积风险为 $\\Lambda_{0}(t) = \\int_{0}^{t} \\lambda\\,du = \\lambda t$。当 $\\lambda = 5.0 \\times 10^{-2}$ 每月且 $T = 12$ 个月时，我们得到\n$$\n\\Lambda_{0}(T) = \\lambda T = \\left(5.0 \\times 10^{-2}\\right)\\times 12 = 0.6.\n$$\n\n因此，在时间 $T$ 时，各四分位数特定的累积发生率分别为\n$$\nF_{1}(T) = 1 - \\exp\\!\\big(-\\theta_{1}\\,\\Lambda_{0}(T)\\big) = 1 - \\exp(-1.00 \\times 0.6) = 1 - \\exp(-0.6),\n$$\n$$\nF_{2}(T) = 1 - \\exp\\!\\big(-\\theta_{2}\\,\\Lambda_{0}(T)\\big) = 1 - \\exp(-1.35 \\times 0.6) = 1 - \\exp(-0.81),\n$$\n$$\nF_{3}(T) = 1 - \\exp\\!\\big(-\\theta_{3}\\,\\Lambda_{0}(T)\\big) = 1 - \\exp(-1.75 \\times 0.6) = 1 - \\exp(-1.05),\n$$\n$$\nF_{4}(T) = 1 - \\exp\\!\\big(-\\theta_{4}\\,\\Lambda_{0}(T)\\big) = 1 - \\exp(-2.40 \\times 0.6) = 1 - \\exp(-1.44).\n$$\n\n在各组比例相等的情况下，即 $p_{1} = p_{2} = p_{3} = p_{4} = \\frac{1}{4}$，在时间 $T$ 时所有四分位数的总体累积发生率为\n$$\nF_{\\text{overall}}(T) = \\sum_{g=1}^{4} p_{g}\\,F_{g}(T) = \\frac{1}{4}\\Big[ F_{1}(T) + F_{2}(T) + F_{3}(T) + F_{4}(T) \\Big].\n$$\n\n代入表达式，\n$$\nF_{\\text{overall}}(12) = \\frac{1}{4}\\left[ \\left(1 - \\exp(-0.6)\\right) + \\left(1 - \\exp(-0.81)\\right) + \\left(1 - \\exp(-1.05)\\right) + \\left(1 - \\exp(-1.44)\\right) \\right].\n$$\n\n我们现在计算每个指数项：\n- $\\exp(-0.6) \\approx 0.548811636094$，因此 $1 - \\exp(-0.6) \\approx 0.451188363906$。\n- $\\exp(-0.81) \\approx 0.444858066000$，因此 $1 - \\exp(-0.81) \\approx 0.555141934000$。\n- $\\exp(-1.05) \\approx 0.349937749000$，因此 $1 - \\exp(-1.05) \\approx 0.650062251000$。\n- $\\exp(-1.44) \\approx 0.236927758000$，因此 $1 - \\exp(-1.44) \\approx 0.763072242000$。\n\n求和，\n$$\nF_{1}(12) + F_{2}(12) + F_{3}(12) + F_{4}(12) \\approx 0.451188363906 + 0.555141934000 + 0.650062251000 + 0.763072242000 = 2.419464790906.\n$$\n\n因此，\n$$\nF_{\\text{overall}}(12) \\approx \\frac{2.419464790906}{4} = 0.6048661977265.\n$$\n\n四舍五入到四位有效数字，在 $T = 12$ 个月时，所有 PRS 四分位数的总体累积发生率为\n$$\n0.6049.\n$$\n\n该值以小数形式表示，代表在队列均匀分布于各 PRS 四分位数、风险通过 Cox 模型成比例、且基线风险恒定的条件下，到 12 个月时预期的复发累积发生率。这与分层的 KM 曲线一致，这些曲线会显示从 $Q_{1}$ 到 $Q_{4}$ 生存率逐渐降低（累积发生率逐渐升高）。",
            "answer": "$$\\boxed{0.6049}$$"
        }
    ]
}