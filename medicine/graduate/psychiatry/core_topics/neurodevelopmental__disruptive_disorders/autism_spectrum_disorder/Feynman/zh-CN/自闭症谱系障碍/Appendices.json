{
    "hands_on_practices": [
        {
            "introduction": "自闭症谱系障碍（ASD）具有很强的遗传基础，而理解这一点是掌握其病因学的关键。双生子研究是量化遗传和环境因素对复杂性状（如ASD）影响的经典方法。本练习  将指导您使用 Falconer 公式，从同卵（MZ）和异卵（DZ）双生子的同病率数据中推导出广义遗传度（$H^2$）的估计值。通过这个计算，您将亲身体验如何将流行病学数据转化为对遗传贡献的具体衡量，并深入理解该估计值背后所依赖的关键假设，例如等环境假说。",
            "id": "4690919",
            "problem": "一项基于人群的自闭症谱系障碍 (ASD) 双生子登记研究报告称，同卵 (MZ) 双生子对的先证者同病率为 $r_{MZ} = 0.77$，异卵 (DZ) 双生子对的先证者同病率为 $r_{DZ} = 0.31$。假设 ASD 遵循标准的易感性-阈值模型，总方差为单位1，并满足经典双生子设计的假设：等环境假设、关于易感性的随机交配，以及 MZ 和 DZ 双生子的相关性近似于易感性的相关性。从方差分解为加性遗传方差 ($A$)、显性遗传方差 ($D$)、共同环境方差 ($C$) 和非共同环境方差 ($E$) 出发，并限定于 $ACE$ 模型（即，假设 $D = 0$），完成以下任务：\n\n1. 仅使用定义和 $ACE$ 模型的约束，推导出一个用 $r_{MZ}$ 和 $r_{DZ}$ 表示的广义遗传力 $H^{2}$ 的估计量。\n\n2. 根据给定的 $r_{MZ} = 0.77$ 和 $r_{DZ} = 0.31$ 计算 ASD 的 $H^{2}$ 的数值估计。\n\n3. 在 $ACE$ 框架内，简要解释该估计值对 ASD 易感性的家族风险和环境贡献意味着什么，并指出任何关于 $C$ 相对于 $D$ 的合理性的诊断迹象。\n\n将您最终的 $H^{2}$ 数值答案表示为一个无单位的分数，并将您的最终估计值四舍五入到三位有效数字。",
            "solution": "在易感性-阈值框架下的经典双生子设计将总表型方差表示为 $A + D + C + E = 1$。双生子之间的易感性相关性反映了由于遗传和共同环境因素，双生子所共享的方差比例。在一般的 $ADCE$ 表示下，预期的相关性为\n$$\nr_{MZ} = A + D + C, \\quad r_{DZ} = \\tfrac{1}{2}A + \\tfrac{1}{4}D + C.\n$$\n在 $ACE$ 模型中，我们令 $D = 0$，得到\n$$\nr_{MZ} = A + C, \\quad r_{DZ} = \\tfrac{1}{2}A + C.\n$$\n广义遗传力定义为可归因于总遗传效应的方差比例，在 $ACE$ 模型中，这等于加性部分，因此 $H^{2} = A$。\n\n为了推导用 $r_{MZ}$ 和 $r_{DZ}$ 表示的 $H^{2}$ 的估计量，从 MZ 方程中减去 DZ 方程：\n$$\nr_{MZ} - r_{DZ} = (A + C) - \\left(\\tfrac{1}{2}A + C\\right) = \\tfrac{1}{2}A.\n$$\n两边同乘以 $2$ 得出\n$$\nA = 2(r_{MZ} - r_{DZ}).\n$$\n由于在 $ACE$ 模型中 $H^{2} = A$，因此在这些假设下，广义遗传力的 Falconer 估计量是\n$$\nH^{2} = 2(r_{MZ} - r_{DZ}).\n$$\n\n我们现在使用给定的相关性计算数值：\n$$\nH^{2} = 2(0.77 - 0.31) = 2(0.46) = 0.92.\n$$\n四舍五入到三位有效数字得到 $0.920$。\n\n在 $ACE$ 框架内的解释：$H^{2} \\approx 0.92$ 的估计值表明，在等环境假设下，并将同病率视为易感性相关性，ASD 易感性的大部分变异都可归因于遗传因素。在 $ACE$ 模型中，也可以推导出共同环境分量，使用 $C = r_{MZ} - A = r_{MZ} - 2(r_{MZ} - r_{DZ}) = 2r_{DZ} - r_{MZ}$。使用当前值，$C = 2(0.31) - 0.77 = -0.15$，这作为一个方差分量是不可接受的。这种模式（$r_{MZ} > 2r_{DZ}$）是一个诊断迹象，表明 $ACE$ 模型对于这些数据是错误设定的，而一个允许显性遗传效应（$ADE$）的模型可能更合适。在 $ADE$ 模型下，广义遗传力等于 $r_{MZ}$，即 $0.77$，而共同环境则可以忽略不计。无论选择哪种模型，非共同环境 ($E$) 仍然是必需的，用以解释残余方差以及 $r_{MZ}  1$ 的观察结果，这表明环境和特异性因素仍然对个体易感性有重要贡献。",
            "answer": "$$\\boxed{0.920}$$"
        },
        {
            "introduction": "在临床实践中，诊断过程很少是教科书式的直接明了，尤其是在评估智力正常、可能已发展出“伪装”或“掩饰”（masking/camouflaging）策略的成年人时。本案例研究  提供了一个真实的诊断挑战，要求您整合来自不同来源的冲突信息：直接观察（ADOS-2）、存在信息局限性的回顾性访谈（ADI-R）以及第三方佐证材料（学校记录）。这项练习旨在磨练您的临床推理能力，教您如何批判性地评估评估工具的信度和效度，并最终在复杂的数据中做出科学上最站得住脚的诊断决策。",
            "id": "4690897",
            "problem": "一名22岁的大学生因自闭症谱系障碍（ASD）评估而被转诊。该学生报告了终生的感觉敏感（例如，厌恶巨大噪音和某些织物纹理）、强烈而局限的兴趣（例如，火车时刻表和天气模式）、对常规的强烈偏好，以及在社交互动后明显的社交疲惫。该学生描述了通过记忆社交脚本来学习“伪装”，这改善了表面的社交功能，但感觉非常费力。在学业上，该学生表现良好，估计全量表智商（IQ）约为110。\n\n在使用《自闭症诊断观察量表第二版》（ADOS-2）模块4进行标准化观察期间，总算法得分为11分，超过了已公布的自闭症谱系类别7分的临界值。检查者注意到其相互性对话有限、非语言沟通行为减少（例如，非典型的眼神接触、有限的面部表情）、难以将手势与言语相结合，以及若干局限性和重复性行为（RRBs），包括坚持常规和局限的兴趣。\n\n对该学生的养母进行了《自闭症诊断访谈量表-修订版》（ADI-R）的访谈，她从该学生13岁起成为其主要照顾者。ADI-R的算法结果在各个领域均低于阈值：社交互动分量表为8分（临界值为10分），沟通分量表为6分（临界值为8分），局限性和重复性行为分量表为2分（临界值为3分）。养母报告称对该学生早期童年行为的了解有限。可获得的1至3年级的学校记录记载了其在相互性游戏方面持续存在困难、同伴友谊有限、专注于公交地图、老师注意到其在兴奋时偶尔会拍手，以及抗拒日程改变。此前没有ASD诊断史。该学生共病社交焦虑障碍（16岁时诊断）和注意力缺陷/多动障碍（ADHD）（混合表现型，9岁时诊断）。无语言延迟史；据报告运动里程碑正常。\n\n以《精神疾病诊断与统计手册第五版文本修订版》（DSM-5-TR）的标准为基础，并认识到ADOS-2（对当前行为进行结构化的直接观察）和ADI-R（基于照顾者的发育史）的不同测量特性，请找出ADOS-2和ADI-R结果之间差异的最科学合理的解释，并做出最恰当的诊断决定。选择唯一的最佳选项。\n\nA. ADOS-2分数升高很可能是由当前的焦虑状态驱动的，这夸大了社交困难；ADI-R的阈值对早期发育具有决定性意义，由于其结果低于临界值，故可排除ASD。恰当的诊断是社交焦虑障碍，无ASD。\n\nB. 这种差异的最佳解释是信息提供者的局限性和发育过程中的“伪装”，其中ADOS-2捕捉到了当前的核心缺陷和RRBs，而由于照顾者知识和回忆有限，ADI-R低估了早期迹象。辅助的学校记录证实了早期出现的社交沟通缺陷和RRBs；因此，最科学合理的诊断是自闭症谱系障碍（ASD），需要1级支持，并带有适当的说明（无智力损害；共病ADHD和社交焦虑障碍）。\n\nC. 因为ADI-R结果低于阈值——尤其是在RRBs方面——早期出现的局限性兴趣并未得到证实；恰当的诊断是社交（语用）沟通障碍（SCD），因为当前的RRBs不满足对发育性RRBs的要求。\n\nD. 这种不一致的特征表明是“晚发型ASD”，即自闭症在青春期或成年期出现；尽管ADI-R结果不符，但仅凭ADOS-2就足以进行诊断，正确的诊断是成人发病型ASD，无需参考早期发育情况。",
            "solution": "在分析之前，对问题陈述进行验证。\n\n### 步骤1：提取已知信息\n\n-   **对象**：一名22岁的大学生。\n-   **自我报告史**：终生的感觉敏感、强烈而局限的兴趣（火车时刻表、天气模式）、偏好常规、社交疲惫，以及通过记忆社交脚本进行“伪装”。\n-   **认知概况**：学业表现良好；估计全量表智商（IQ）约为110。\n-   **观察数据（ADOS-2，模块4）**：总算法得分为11分，超过自闭症谱系类别7分的临界值。检查者记录包括：相互性对话有限、非语言沟通减少（非典型眼神接触、面部表情有限）、难以将手势与言语结合，以及存在局限性和重复性行为（RRBs），如坚持常规和局限的兴趣。\n-   **访谈数据（ADI-R）**：\n    -   信息提供者：养母，从对象13岁起成为其主要照顾者。\n    -   信息提供者局限性：“对早期童年行为的了解有限”。\n    -   算法分数：社交互动分量表8分（临界值10分），沟通分量表6分（临界值8分），RRB分量表2分（临界值3分）。所有分数均低于诊断阈值。\n-   **辅助数据（学校记录，1-3年级）**：记录了持续的相互性游戏困难、同伴友谊有限、专注于公交地图、偶尔拍手，以及抗拒日程改变。\n-   **共病与发育史**：社交焦虑障碍（16岁诊断）、ADHD混合表现型（9岁诊断）、无语言延迟史、运动里程碑正常。\n-   **诊断框架**：《精神疾病诊断与统计手册第五版文本修订版》（DSM-5-TR）。\n-   **目标**：确定ADOS-2/ADI-R结果差异的最科学合理的解释，并做出最恰当的诊断决定。\n\n### 步骤2：使用提取的已知信息进行验证\n\n该问题陈述是一个结构良好的临床案例，在精神病学和临床心理学领域具有科学依据。\n-   **有科学依据（关键）**：该问题使用了标准的、经过验证的诊断工具（ADOS-2, ADI-R）和当前权威的诊断手册（DSM-5-TR）。临床表现，包括“伪装”等概念以及直接观察与历史报告之间的差异，在关于自闭症谱系障碍（ASD）的科学文献中非常真实且有充分记载，尤其是在智力正常或高于平均水平的个体中。\n-   **提问明确**：该问题的结构旨在测试面对矛盾数据点时的临床推理能力。它并非信息不足；相反，它包含了一个解决明显矛盾所必需的关键信息（信息提供者的知识有限）。通过整合所有提供的信息，可以得出一个独特且站得住脚的诊断结论。\n-   **客观（关键）**：对症状、行为和测试分数的描述均采用客观的临床语言，没有主观偏见。\n\n该问题没有违反任何无效标准。ADOS-2和ADI-R分数之间的差异不是问题设置中的缺陷；它是需要解决的核心诊断挑战，反映了成人ASD评估中常见的现实世界复杂性。\n\n### 步骤3：结论与行动\n\n该问题是**有效的**。将进行全面分析。\n\n### 基于原则的推导\n\n诊断过程必须遵循DSM-5-TR中关于自闭症谱系障碍(299.00 (F84.0))的标准。\n\n1.  **标准A：在社交沟通和社交互动方面存在持续性缺陷。**\n    -   学生自我报告的社交疲惫和需要“伪装”表明存在潜在缺陷。\n    -   ADOS-2是一项对当前功能的直接、结构化观察，其得分11分（显著高于7分的临界值），并且定性观察到相互性有限、非典型非语言行为以及手势整合不佳。这为当前存在满足标准A的缺陷提供了有力证据。\n    -   早期的学校记录记载了“持续的相互性游戏困难”和“同伴友谊有限”，从而确定这些缺陷在早期发育阶段就已存在。\n\n2.  **标准B：局限、重复的行为、兴趣或活动模式（RRBs）。**\n    -   DSM-5-TR要求至少满足四种RRB类型中的两种。\n    -   该学生的表现包括：\n        -   (B1) 刻板或重复的运动动作：早期学校记录中提到的“偶尔拍手”。\n        -   (B2) 坚持同一性，僵化地遵守常规：自我报告“强烈偏好常规”，ADOS-2记录“坚持常规”，学校记录“抗拒日程改变”。\n        -   (B3) 高度局限、固定的兴趣：自我报告对“火车时刻表和天气模式”的强烈兴趣，学校记录“专注于公交地图”。\n        -   (B4) 对感觉输入的过度或过低反应：自我报告“终生的感觉敏感（例如，厌恶巨大噪音和某些织物纹理）”。\n    -   多种形式的RRBs在当前和早期发育阶段都从多个来源（自我报告、ADOS-2、学校记录）得到证实。标准B明确得到满足。\n\n3.  **标准C：症状必须在早期发育阶段就已存在。**\n    -   这是本案例诊断难题的核心。ADI-R是评估早期发育的关键工具，其结果低于阈值。然而，问题明确指出信息提供者（从13岁起的养母）“对早期童年行为的了解有限”。对一个不充分了解相关发育时期（通常是4-5岁）的信息提供者进行的ADI-R，其有效性极低，不能用来排除发育性障碍。\n    -   相比之下，来自1至3年级的辅助学校记录为满足标准A和标准B的行为在早期发育阶段的存在提供了客观的第三方文件。这一证据有效地推翻了不可靠的、阴性的ADI-R数据。\n\n4.  **标准D（临床上显著的损害）和E（不能更好地由智力残疾解释）。**\n    -   需要评估、共病社交焦虑障碍和ADHD，以及报告的社交疲惫表明存在损害。110的IQ排除了智力残疾作为解释。\n\n5.  **综合分析差异**：ADOS-2和ADI-R之间的差异最好解释为ADI-R信息提供者对于所需发育时期的信息不可靠。ADOS-2捕捉到了学生当前ASD特征的表现，这些特征在结构化的评估环境中通常较少被伪装。学生自我报告的“伪装”和“掩饰”是一个公认的现象，解释了具有正常智力的ASD个体如何能够（尽管非常费力地）发挥功能。学校记录提供了满足标准C所必需的历史证据。因此，ASD的诊断得到了有力支持。鉴于学生有能力上大学，“需要支持”（1级）的说明是恰当的。诊断还必须包括关于智力功能和共病的说明。\n\n### 逐项分析\n\n**A. ADOS-2分数升高很可能是由当前的焦虑状态驱动的，这夸大了社交困难；ADI-R的阈值对早期发育具有决定性意义，由于其结果低于临界值，故可排除ASD。恰当的诊断是社交焦虑障碍，无ASD。**\n-   **分析**：这个选项存在缺陷。它错误地假设社交焦虑完全解释了在ADOS-2上观察到的特定缺陷组合（例如，局限的兴趣、非典型的非语言沟通）。最关键的是，它错误地将低于阈值的ADI-R视为排除早期发病的“决定性”证据，完全无视了信息提供者对患者早期童年了解有限这一明确而决定性的警告。提供早期症状直接证据的辅助学校记录被忽略了。\n-   **结论**：不正确。\n\n**B. 这种差异的最佳解释是信息提供者的局限性和发育过程中的“伪装”，其中ADOS-2捕捉到了当前的核心缺陷和RRBs，而由于照顾者知识和回忆有限，ADI-R低估了早期迹象。辅助的学校记录证实了早期出现的社交沟通缺陷和RRBs；因此，最科学合理的诊断是自闭症谱系障碍（ASD），需要1级支持，并带有适当的说明（无智力损害；共病ADHD和社交焦虑障碍）。**\n-   **分析**：这个结论正确地综合了所有可用的数据。它为不一致的测试结果提供了最科学合理的解释——将低的ADI-R分数归因于信息提供者的局限性。它认识到ADOS-2在观察当前行为方面的价值，并恰当地使用辅助学校记录来建立DSM-5-TR标准C所要求的发育史。所提出的诊断，包括支持水平和说明，与案例表现和DSM-5-TR指南完全一致。\n-   **结论**：正确。\n\n**C. 因为ADI-R结果低于阈值——尤其是在RRBs方面——早期出现的局限性兴趣并未得到证实；恰当的诊断是社交（语用）沟通障碍（SCD），因为当前的RRBs不满足对发育性RRBs的要求。**\n-   **分析**：这个选项在两方面都是不正确的。首先，它再次不恰当地将无效的ADI-R结果置于有效的学校记录之上，而后者确实证实了早期出现的RRBs（例如，“专注于公交地图”、“拍手”）。其次，如果ASD的标准曾被满足，则明确排除了SCD的诊断。该对象明确表现出当前和历史上有显著RRBs（标准B）的证据，这排除了SCD作为可能诊断的可能性。\n-   **结论**：不正确。\n\n**D. 这种不一致的特征表明是“晚发型ASD”，即自闭症在青春期或成年期出现；尽管ADI-R结果不符，但仅凭ADOS-2就足以进行诊断，正确的诊断是成人发病型ASD，无需参考早期发育情况。**\n-   **分析**：这个选项在科学上是站不住脚的。“晚发型ASD”或“成人发病型ASD”在DSM-5-TR或更广泛的科学共识中都不是公认的诊断类别。DSM-5-TR明确规定症状必须起源于早期发育阶段（标准C），即使它们在生命的后期变得更具损害性。这个选项虚构了一个诊断，并错误地陈述了ASD的一个核心诊断标准。\n-   **结论**：不正确。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "现代精神病学研究越来越多地使用计算模型来精确地阐释症状背后的认知与神经机制。预测编码（predictive processing）理论是解释ASD核心症状（特别是感知异常和对可预测性的坚持）的主流框架之一。这项动手实践  将让您通过编写代码，构建一个基于贝叶斯推理的简化感知模型。您将有机会亲自操作，通过调整“感觉信息精度”（sensory precision）等关键参数，来模拟这些改变如何影响后验信念，并最终导致“坚持同一性”（insistence on sameness）等行为的出现，从而直观地连接起大脑的计算原理与临床可观察到的行为。",
            "id": "4690957",
            "problem": "您的任务是构建一个简约而有原则的贝叶斯感知推断模拟，该模拟旨在捕捉自闭症谱系障碍 (ASD) 的一个核心提议：增强的感官精确度会改变后验信念，并可能导致坚持同一性的行为。该模型需建立在第一性原理和经过充分检验的事实之上，不使用捷径。请使用以下约束条件。\n\n科学背景与基础：在关于自闭症谱系障碍 (ASD) 的预测性加工理论中，有一种假设认为，增强的感官精确度会放大感官证据相对于先验信念的影响。您将通过从贝叶斯定理和一个用于一维感知任务的简单高斯生成模型出发，来对此进行形式化。我们考虑两个相互竞争的假设：某一时刻的环境刺激与一个已学习的模板相同，记为 $H_s$（“相同”），或者不同，记为 $H_d$（“不同”）。观测值是当前刺激与模板之间沿单一感知维度测量的实值差异 $y$。生成模型必须假设具有已知均值和方差的高斯似然，以及一个在假设上的伯努利先验，其中 $H_s$ 的参数为 $\\pi$。为了操作化感官精确度，在应用贝叶斯定理之前，通过对似然项进行指数运算，使用一个精确度参数 $\\lambda$ 来缩放似然函数的影响。这种加权方法反映了贝叶斯认知模型中一种被广泛接受的精确度加权推断方法。\n\n需使用的核心定义与假设：\n- 使用贝叶斯定理和标准高斯概率密度函数。不要引入任何非高斯形式。\n- 两个假设都具有高斯似然，方差同为 $\\sigma^2$ 但均值不同：$H_s$ 的均值为 $\\mu_s$，$H_d$ 的均值为 $\\mu_d$。\n- $H_s$ 的先验概率为 $\\pi$，因此 $H_d$ 的先验概率为 $1 - \\pi$。\n- 在应用贝叶斯定理之前，通过以 $\\lambda$ 为指数对似然进行缩放来体现感官精确度，从而在 $\\lambda$ 较大时，增加感官证据对后验概率的相对影响。\n\n行为预测规则：将“坚持同一性”行为定义为对 $H_s$ 后验概率的一个阈值化决策。如果 $H_s$ 的后验概率严格低于阈值 $\\theta$，则预测出现坚持同一性的行为（布尔值输出为 $True$）；否则预测没有坚持行为（布尔值输出为 $False$）。该规则模拟了当对同一性的信念变得过低时所产生的纠正行为。\n\n您的任务：\n- 实现一个程序，对于下面测试套件中的每个测试用例，使用上述精确度加权的贝叶斯更新计算 $H_s$ 的后验概率，然后应用阈值规则来预测布尔行为。\n- 本任务不涉及物理单位。\n- 本任务不涉及角度。\n- 不得使用百分比；所有概率必须表示为 $[0,1]$ 区间内的小数。\n\n使用的高斯组件：\n- 对于均值为 $\\mu$、标准差为 $\\sigma$ 的实数观测值 $y$，其高斯概率密度函数定义为\n$$\n\\mathcal{N}(y; \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\!\\left(-\\frac{(y - \\mu)^2}{2\\sigma^2}\\right).\n$$\n\n精确度加权更新要求：\n- 在通过贝叶斯定理与先验结合之前，通过将每个假设的似然提升到 $\\lambda$ 次方来应用精确度加权。您必须从基本的贝叶斯定理出发，并仔细地引入加权；不要假设或导入任何预先推导好的目标公式。\n\n决策规则：\n- 如果 $H_s$ 的后验概率严格小于 $\\theta$，则预测为坚持同一性行为。\n\n测试套件：\n对于每个测试用例，参数以元组 $(\\pi, \\mu_s, \\mu_d, \\sigma, y, \\lambda, \\theta)$ 的形式给出，所有标量均为实数。使用以下测试用例以确保覆盖典型、边界和边缘条件：\n- 用例 1：$(0.7, 0.0, 2.0, 1.0, 0.2, 1.0, 0.5)$\n- 用例 2：$(0.7, 0.0, 2.0, 1.0, 1.2, 3.0, 0.5)$\n- 用例 3：$(0.7, 0.0, 2.0, 1.0, 1.2, 0.0, 0.5)$\n- 用例 4：$(0.7, 0.0, 2.0, 1.0, 4.0, 1.0, 0.5)$\n- 用例 5：$(0.4, 0.0, 2.0, 1.0, 0.1, 5.0, 0.5)$\n- 用例 6：$(0.95, 0.0, 2.0, 1.0, 1.2, 1.0, 0.9)$\n- 用例 7：$(0.95, 0.0, 2.0, 1.0, 1.2, 3.0, 0.9)$\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个方括号括起来的、以逗号分隔的结果列表，结果顺序与上面列出的测试用例顺序一致。每个元素必须是对应测试用例的布尔决策（$True$ 或 $False$），例如 $[True,False,True]$。",
            "solution": "该问题是有效的，因为它在科学上基于计算精神病学，并且是适定的，提供了所有必要的参数和定义，且内部一致。它提出了一个清晰、可形式化的任务。我们现在开始解决。\n\n这个问题的核心是在一个由感官精确度参数 $\\lambda$ 修改的贝叶斯框架内，根据感官观测值 $y$ 计算假设 $H_s$（“相同”）的后验概率。然后将这个后验概率 $P(H_s|y)$ 与阈值 $\\theta$ 进行比较，以确定行为预测。\n\n该贝叶斯模型涉及两个互斥且穷尽的假设：$H_s$（刺激与模板相同）和 $H_d$（刺激不同）。\n\n先验概率给出如下：\n$$ P(H_s) = \\pi $$\n$$ P(H_d) = 1 - \\pi $$\n\n在每个假设下，观测到差异 $y$ 的似然由高斯概率密度函数 $\\mathcal{N}(y; \\mu, \\sigma^2)$ 给出：\n$$ P(y|H_s) = \\mathcal{N}(y; \\mu_s, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\!\\left(-\\frac{(y - \\mu_s)^2}{2\\sigma^2}\\right) $$\n$$ P(y|H_d) = \\mathcal{N}(y; \\mu_d, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\!\\left(-\\frac{(y - \\mu_d)^2}{2\\sigma^2}\\right) $$\n\n根据贝叶斯定理，$H_s$ 的后验概率为：\n$$ P(H_s|y) = \\frac{P(y|H_s) P(H_s)}{P(y)} = \\frac{P(y|H_s) P(H_s)}{P(y|H_s) P(H_s) + P(y|H_d) P(H_d)} $$\n\n问题对标准贝叶斯推断引入了一个关键修改：似然的影响由感官精确度参数 $\\lambda$ 进行缩放。这是通过在将似然函数与先验结合之前，将其提升到 $\\lambda$ 次方来实现的。让我们将精确度加权的后验表示为 $P(H_s|y, \\lambda)$。公式变为：\n$$ P(H_s|y, \\lambda) = \\frac{[P(y|H_s)]^\\lambda P(H_s)}{[P(y|H_s)]^\\lambda P(H_s) + [P(y|H_d)]^\\lambda P(H_d)} $$\n\n现在，我们将高斯形式代入似然：\n$$ [P(y|H_s)]^\\lambda = \\left[ \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\!\\left(-\\frac{(y - \\mu_s)^2}{2\\sigma^2}\\right) \\right]^\\lambda = \\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\right)^{\\!\\lambda} \\exp\\!\\left(-\\frac{\\lambda(y - \\mu_s)^2}{2\\sigma^2}\\right) $$\n$$ [P(y|H_d)]^\\lambda = \\left[ \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\exp\\!\\left(-\\frac{(y - \\mu_d)^2}{2\\sigma^2}\\right) \\right]^\\lambda = \\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\right)^{\\!\\lambda} \\exp\\!\\left(-\\frac{\\lambda(y - \\mu_d)^2}{2\\sigma^2}\\right) $$\n高斯的归一化常数 $(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma})^\\lambda$ 是后验概率表达式中分子和分母的公共因子。因此，它被消掉了，从而简化了计算：\n$$ P(H_s|y, \\lambda) = \\frac{\\pi \\exp\\!\\left(-\\frac{\\lambda(y - \\mu_s)^2}{2\\sigma^2}\\right)}{\\pi \\exp\\!\\left(-\\frac{\\lambda(y - \\mu_s)^2}{2\\sigma^2}\\right) + (1-\\pi) \\exp\\!\\left(-\\frac{\\lambda(y - \\mu_d)^2}{2\\sigma^2}\\right)} $$\n这个形式是正确的，但由于指数函数的性质，它可能在数值上不稳定。一个更稳健的公式可以通过处理对数几率来导出。$H_s$ 相对于 $H_d$ 的后验几率由似然比（提升到 $\\lambda$ 次方）和先验几率的乘积给出：\n$$ \\frac{P(H_s|y, \\lambda)}{P(H_d|y, \\lambda)} = \\left(\\frac{P(y|H_s)}{P(y|H_d)}\\right)^{\\!\\lambda} \\frac{P(H_s)}{P(H_d)} $$\n使用 $H_d$ 相对于 $H_s$ 的对数后验几率通常更方便：\n$$ \\log\\left(\\frac{P(H_d|y, \\lambda)}{P(H_s|y, \\lambda)}\\right) = \\log\\left(\\frac{P(H_d)}{P(H_s)}\\right) + \\lambda \\log\\left(\\frac{P(y|H_d)}{P(y|H_s)}\\right) $$\n我们称此项为 $A$。$A$ 是支持 $H_d$ 的对数后验几率。\n第一项是对数先验几率：$\\log(\\frac{1-\\pi}{\\pi})$。\n第二项是精确度加权的对数似然比。似然的比值简化为：\n$$ \\frac{P(y|H_d)}{P(y|H_s)} = \\frac{\\exp\\!\\left(-\\frac{(y - \\mu_d)^2}{2\\sigma^2}\\right)}{\\exp\\!\\left(-\\frac{(y - \\mu_s)^2}{2\\sigma^2}\\right)} = \\exp\\left(\\frac{(y - \\mu_s)^2 - (y - \\mu_d)^2}{2\\sigma^2}\\right) $$\n取对数得到对数似然比：\n$$ \\log\\left(\\frac{P(y|H_d)}{P(y|H_s)}\\right) = \\frac{(y - \\mu_s)^2 - (y - \\mu_d)^2}{2\\sigma^2} = \\frac{(y^2 - 2y\\mu_s + \\mu_s^2) - (y^2 - 2y\\mu_d + \\mu_d^2)}{2\\sigma^2} = \\frac{2y(\\mu_d - \\mu_s) + \\mu_s^2 - \\mu_d^2}{2\\sigma^2} $$\n因此，$A$ 的完整表达式为：\n$$ A = \\log\\left(\\frac{1-\\pi}{\\pi}\\right) + \\frac{\\lambda}{2\\sigma^2} \\left[ 2y(\\mu_d - \\mu_s) + \\mu_s^2 - \\mu_d^2 \\right] $$\n后验概率 $P(H_s|y, \\lambda)$ 可以使用 logistic (sigmoid) 函数从对数几率 $A$ 中恢复。由于 $A = \\log(P(H_d|y, \\lambda)/P(H_s|y, \\lambda))$，我们有 $\\exp(A) = P(H_d|y, \\lambda)/P(H_s|y, \\lambda)$。利用 $P(H_s|y, \\lambda) + P(H_d|y, \\lambda) = 1$ 这一事实，我们可以解出 $P(H_s|y, \\lambda)$：\n$$ P(H_s|y, \\lambda) = \\frac{1}{1 + \\exp(A)} $$\n这是一个用于计算所需后验概率的数值稳定表达式。\n\n最后一步是应用行为预测规则：“坚持同一性”行为在 $H_s$ 的后验概率严格小于阈值 $\\theta$ 时发生。因此，对于每个测试用例，我们计算 $P(H_s|y, \\lambda)$ 并确定布尔输出为：\n$$ \\text{行为} = (P(H_s|y, \\lambda)  \\theta) $$\n\n一个重要的边缘情况是当 $\\lambda=0$ 时。在这种情况下，数据对后验信念没有影响。乘以 $\\lambda$ 的项变为零，因此 $A = \\log(\\frac{1-\\pi}{\\pi})$。后验概率变为 $P(H_s|y, \\lambda=0) = \\frac{1}{1 + \\exp(\\log(\\frac{1-\\pi}{\\pi}))} = \\frac{1}{1 + \\frac{1-\\pi}{\\pi}} = \\pi$。正如预期的那样，后验正确地退化为先验。我们推导的公式自然地处理了这种情况。\n\n每个测试用例 $(\\pi, \\mu_s, \\mu_d, \\sigma, y, \\lambda, \\theta)$ 的算法如下：\n1. 使用上面推导的公式计算对数后验几率 $A$。\n2. 计算后验概率 $P_s = P(H_s|y, \\lambda) = 1 / (1 + \\exp(A))$。\n3. 将 $P_s$ 与阈值 $\\theta$ 进行比较，得到布尔决策：$P_s  \\theta$。\n这个过程将为所有提供的测试用例实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the boolean behavior prediction for a series of test cases\n    based on a precision-weighted Bayesian inference model.\n    \"\"\"\n\n    # Test cases are provided as tuples of (pi, mu_s, mu_d, sigma, y, lambda, theta)\n    test_cases = [\n        # Case 1: Standard precision, evidence supports H_s\n        (0.7, 0.0, 2.0, 1.0, 0.2, 1.0, 0.5),\n        # Case 2: High precision, ambiguous evidence drives posterior below threshold\n        (0.7, 0.0, 2.0, 1.0, 1.2, 3.0, 0.5),\n        # Case 3: Zero precision, posterior equals prior\n        (0.7, 0.0, 2.0, 1.0, 1.2, 0.0, 0.5),\n        # Case 4: Evidence strongly against H_s\n        (0.7, 0.0, 2.0, 1.0, 4.0, 1.0, 0.5),\n        # Case 5: High precision and strong evidence for H_s overcomes opposing prior\n        (0.4, 0.0, 2.0, 1.0, 0.1, 5.0, 0.5),\n        # Case 6: Strong prior, ambiguous evidence, high threshold\n        (0.95, 0.0, 2.0, 1.0, 1.2, 1.0, 0.9),\n        # Case 7: Same as Case 6, but high precision amplifies evidence, pushing posterior below threshold\n        (0.95, 0.0, 2.0, 1.0, 1.2, 3.0, 0.9),\n    ]\n\n    results = []\n    for case in test_cases:\n        pi, mu_s, mu_d, sigma, y, lam, theta = case\n        \n        # Calculate the log posterior odds of H_d vs H_s, denoted as A.\n        # A = log( (1-pi)/pi ) + lambda * log( P(y|H_d) / P(y|H_s) )\n        \n        # Log prior odds term for H_d vs H_s\n        # Note: The problem givens ensure 0  pi  1, so np.log is safe.\n        log_prior_odds = np.log((1 - pi) / pi)\n\n        # Precision-weighted log likelihood ratio term for H_d vs H_s\n        # log_llr = (lambda / (2*sigma^2)) * [ 2*y*(mu_d - mu_s) + mu_s^2 - mu_d^2 ]\n        log_likelihood_ratio_term = (lam / (2 * sigma**2)) * \\\n                                    (2 * y * (mu_d - mu_s) + mu_s**2 - mu_d**2)\n\n        # Total log posterior odds A\n        A = log_prior_odds + log_likelihood_ratio_term\n\n        # Calculate the posterior probability of H_s using the logistic function\n        # P(H_s | y, lambda) = 1 / (1 + exp(A))\n        posterior_s = 1 / (1 + np.exp(A))\n        \n        # Apply the decision rule: predict insistence on sameness if P(H_s|y)  theta\n        decision = posterior_s  theta\n        results.append(decision)\n\n    # Format the final output as a comma-separated list of booleans in square brackets.\n    # The map(str, ...) converts Python booleans (True, False) to their string representations.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}