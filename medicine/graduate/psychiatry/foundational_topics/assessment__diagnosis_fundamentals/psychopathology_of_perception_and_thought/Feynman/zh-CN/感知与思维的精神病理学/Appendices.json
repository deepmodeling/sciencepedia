{
    "hands_on_practices": [
        {
            "introduction": "在精神病理学中，知觉体验的异常是核心议题之一。信号检测理论 (Signal Detection Theory, SDT) 提供了一个强大的数学框架，用以剖析感知过程，帮助我们精确区分个体对刺激的真实敏感度（$d'$）与他们的报告倾向或反应偏差（$c$）。本练习  将指导你从基本的实验数据（击中率和虚报率）出发，推导并计算这些关键参数，这是一项在研究和高级临床评估中评估知觉障碍的基本技能。",
            "id": "4749342",
            "problem": "一个研究团队正在对精神病临床高危个体使用听觉信号检测范式，研究与精神病学中感知与思维的精神病理学相关的知觉决策偏差。根据信号检测论 (SDT)，对于无信号（噪声）和有信号（低语的情感词）的内部响应，采用等方差高斯分布进行建模。具体来说，噪声分布建模为 $X_N \\sim \\mathcal{N}(0,1)$，信号分布建模为 $X_S \\sim \\mathcal{N}(d',1)$，其中 $d'$ 以标准差为单位量化了两个分布之间的分离程度。决策规则是：当内部响应在公共标准化决策轴上超过一个固定标准 $k$ 时，报告“信号存在”。\n\n定义击中率 $H$ 为 $H = \\mathbb{P}(X_S \\geq k)$，虚报率 $F$ 为 $F = \\mathbb{P}(X_N \\geq k)$。令 $\\Phi(\\cdot)$ 表示标准正态分布的累积分布函数，其反函数为 $Z(\\cdot)$，即 $Z(p) = \\Phi^{-1}(p)$，它将概率 $p$ 映射到其对应的 z-分数。\n\n从这些定义和上述等方差高斯假设出发，推导$d'$和偏差度量$c$的表达式，其中$c$定义为决策标准相对于两个分布均值中点的位移（即$c = k - \\frac{d'}{2}$），并仅用$Z(H)$和$Z(F)$表示。然后，使用经验观察到的击中率 $H = 0.7$ 和虚报率 $F = 0.4$，计算$d'$和$c$的数值。\n\n将$d'$和$c$的值均四舍五入到四位有效数字。将最终答案表示为一个无单位的双元素行向量 $\\big[d' \\;\\; c\\big]$。",
            "solution": "用户提供的问题已经过验证，被认为是科学上合理、定义明确且客观的。这是信号检测论 (SDT) 的一个标准应用，没有任何使其无效的缺陷。因此，我们可以着手求解。\n\n问题要求根据击中率$H$和虚报率$F$推导敏感性$d'$和偏差$c$的表达式，然后进行数值计算。内部响应由两个等方差高斯分布建模：\n1. 仅噪声：$X_N \\sim \\mathcal{N}(\\mu_N=0, \\sigma^2=1)$\n2. 信号加噪声：$X_S \\sim \\mathcal{N}(\\mu_S=d', \\sigma^2=1)$\n\n如果内部响应$x$超过标准$k$，则给出“信号存在”的响应。\n\n首先，我们将建立可观察率（$H$和$F$）与模型参数（$d'$和$k$）之间的关系。令 $\\Phi(z) = \\mathbb{P}(Z \\leq z)$ 为标准正态分布 $Z \\sim \\mathcal{N}(0,1)$ 的累积分布函数 (CDF)，并令 $Z(p) = \\Phi^{-1}(p)$ 为其反函数，即分位数函数。\n\n虚报率$F$是在只有噪声存在时报告信号的概率：\n$$F = \\mathbb{P}(X_N \\geq k)$$\n由于 $X_N$ 服从标准正态分布，我们可以写出：\n$$F = \\mathbb{P}(Z \\geq k) = 1 - \\mathbb{P}(Z  k) = 1 - \\Phi(k)$$\n对 $\\Phi(k)$ 进行整理可得：\n$$\\Phi(k) = 1 - F$$\n对两边应用标准正态分布的反函数 $Z(\\cdot)$，得到标准$k$的表达式：\n$$k = Z(1 - F)$$\n利用标准正态分布的对称性，即 $Z(1-p) = -Z(p)$，我们可以写出：\n$$k = -Z(F)$$\n\n击中率$H$是在信号存在时正确报告信号的概率：\n$$H = \\mathbb{P}(X_S \\geq k)$$\n$X_S$ 的分布是 $\\mathcal{N}(d', 1)$。为了使用标准正态分布的累积分布函数，我们通过减去其均值（$d'$）并除以其标准差（$1$）来标准化该变量：\n$$H = \\mathbb{P}\\left(\\frac{X_S-d'}{1} \\geq \\frac{k-d'}{1}\\right) = \\mathbb{P}\\left(Z \\geq k-d'\\right)$$\n与 $F$ 的推导类似，这可以用累积分布函数表示：\n$$H = 1 - \\Phi(k-d')$$\n对 $\\Phi(k-d')$ 进行整理可得：\n$$\\Phi(k-d') = 1 - H$$\n对两边应用标准正态分布的反函数 $Z(\\cdot)$，得到：\n$$k - d' = Z(1 - H)$$\n利用对称性 $Z(1-p) = -Z(p)$，我们有：\n$$k - d' = -Z(H)$$\n\n现在我们有一个包含两个未知数$k$和$d'$的方程组：\n1. $k = -Z(F)$\n2. $k - d' = -Z(H)$\n\n为了推导$d'$的表达式，我们将第一个方程代入第二个方程：\n$$-Z(F) - d' = -Z(H)$$\n解出$d'$得到所需的表达式：\n$$d' = Z(H) - Z(F)$$\n\n接下来，我们推导偏差度量$c$的表达式，其定义为$c = k - \\frac{d'}{2}$。我们代入已推导出的$k$和$d'$的表达式：\n$$c = \\left(-Z(F)\\right) - \\frac{1}{2}\\left(Z(H) - Z(F)\\right)$$\n分配 $-\\frac{1}{2}$ 项：\n$$c = -Z(F) - \\frac{1}{2}Z(H) + \\frac{1}{2}Z(F)$$\n合并含有 $Z(F)$ 的项：\n$$c = -\\frac{1}{2}Z(H) - \\frac{1}{2}Z(F)$$\n提出因子 $-\\frac{1}{2}$ 得到$c$的最终表达式：\n$$c = -\\frac{1}{2}\\left(Z(H) + Z(F)\\right)$$\n\n现在，我们使用经验观察到的率$H = 0.7$和$F = 0.4$来计算$d'$和$c$的数值。我们需要与这些概率相对应的 z-分数：\n- $Z(H) = Z(0.7) = \\Phi^{-1}(0.7)$\n- $Z(F) = Z(0.4) = \\Phi^{-1}(0.4)$\n\n使用标准正态分布表或计算工具，我们得到以下值：\n$$Z(0.7) \\approx 0.5244005$$\n$$Z(0.4) \\approx -0.2533471$$\n\n现在我们可以计算$d'$：\n$$d' = Z(0.7) - Z(0.4) \\approx 0.5244005 - (-0.2533471)$$\n$$d' \\approx 0.5244005 + 0.2533471 = 0.7777476$$\n四舍五入到四位有效数字，我们得到 $d' \\approx 0.7777$。\n\n接下来，我们计算$c$：\n$$c = -\\frac{1}{2}(Z(0.7) + Z(0.4)) \\approx -\\frac{1}{2}(0.5244005 + (-0.2533471))$$\n$$c \\approx -\\frac{1}{2}(0.5244005 - 0.2533471) = -\\frac{1}{2}(0.2710534)$$\n$$c \\approx -0.1355267$$\n四舍五入到四位有效数字，我们得到 $c \\approx -0.1355$。\n\n观察者的敏感性$d'$约为 $0.7777$，响应偏差$c$约为 $-0.1355$。$c$的负值表示一个宽松的响应偏差，意味着标准设置在中性点 $\\frac{d'}{2}$ 的左侧，导致更多的“信号存在”响应。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7777  -0.1355\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "思维障碍，特别是妄想的形成，是精神病学的中心议题。一个有影响力的理论认为，某些妄想可能源于有偏差的概率推理过程，即基于不充分的证据就草率地得出结论，这种现象被称为“急于下结论”（Jumping to Conclusions, JTC）。本练习  将经典的“珠子任务”置于贝叶斯概率框架下，要求你分析一个临床案例，这不仅需要你计算证据的客观权重，还需要你解释患者行为背后的认知偏差，并理解其在精神病理学中的意义。",
            "id": "4749248",
            "problem": "一名临床医生采用标准的珠子任务来评估概率推理能力。实验呈现两个罐子，并进行有放回抽样：R罐含有$60\\%$的红珠子和$40\\%$的蓝珠子，B罐含有$40\\%$的红珠子和$60\\%$的蓝珠子。患者被告知每个罐子的先验概率均为$0.5$。第一次抽取时，获得了一颗红珠子。患者立即判断来源罐是R罐，并给出$90\\%$的置信度评分。\n\n仅使用基础概率定义和经过充分检验的原则，选出最能准确描述此行为的正确定量指标和临床解释的选项，这些指标包括：一次抽取后的后验概率、贝叶斯因子（BF）、对数似然比（LLR）、决策所需抽取次数（DTD）、观察到的行为所隐含的最小决策阈值、主观置信度与规范后验概率之间的任何校准差距，以及在与精神病相关的思维精神病理学中“草率结论”（JTC）的临床意义。\n\n选择最佳选项：\n\nA. 抽取一颗红珠子后的后验概率为$0.6$，支持R罐相对于B罐的贝叶斯因子（BF）为$1.5$，对数似然比（LLR）为$\\ln(1.5)\\approx 0.405$，决策所需抽取次数（DTD）为$1$，与该行为一致的最小决策阈值为$T\\le 0.6$；$0.9$的置信度评分产生$0.3$的过度自信（校准不准）差距。在临床上，这反映了“草率结论”（JTC）和一种宽松的接受阈值，后者与精神分裂症谱系中对妄想观念的易感性相关；这表明认知干预应以概率推理和信息收集为目标，并且这并不表示存在原发性的感知异常。\n\nB. 抽取一颗红珠子后的后验概率为$0.75$，BF为$3.0$，LLR为$\\ln(3)\\approx 1.098$，DTD为$1$，阈值为$T\\ge 0.75$；$0.9$的置信度评分校准良好。在临床上，这反映了保守的证据收集行为，这种行为更多见于强迫性检查而非精神病性观念。\n\nC. 因为证据极少，后验概率必须保持在$0.5$附近，任何立即做出的决策最好被理解为异常的感觉知觉而非推理；因此，珠子任务主要测量的是感知扭曲，它预测幻觉严重程度的能力要强于预测妄想信念的能力。\n\nD. 后验概率等于$0.6$，BF等于$1.5$，但DTD为$1$表示与精神病无关的冲动性；“草率结论”与妄想信念无关，且以概率推理为目标的干预没有证据表明有益。",
            "solution": "首先必须评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n\n- 有两个罐子，R罐和B罐。\n- R罐含有$60\\%$的红珠子和$40\\%$的蓝珠子。从R罐中抽到红珠子的概率是$P(\\text{Red} | \\text{Jar R}) = 0.6$。\n- B罐含有$40\\%$的红珠子和$60\\%$的蓝珠子。从B罐中抽到红珠子的概率是$P(\\text{Red} | \\text{Jar B}) = 0.4$。\n- 抽样是有放回的。\n- 选择任一罐子的先验概率相等：$P(\\text{Jar R}) = P(\\text{Jar B}) = 0.5$。\n- 观察到一个事实：第一次抽到的是红珠子。\n- 记录下患者的反应：\n    - 患者在第一次抽取后立即判断来源罐是R罐。\n    - 患者对此决策的置信度评分为$90\\%$（即$0.9$）。\n- 任务是根据定量指标和临床解释来评估一组选项。\n\n### 步骤2：使用提取的已知条件进行验证\n\n- **科学依据**：该问题基于概率论的基本原理——贝叶斯定理。“珠子任务”是计算精神病学和心理学中用于量化概率推理的标准且广泛使用的实验范式。“草率结论”（JTC）的概念及其与宽松接受阈值、妄想观念和精神分裂症谱系的关联，是精神病理学中一个已有充分研究和广泛建立的课题。该问题牢固地植根于既定的科学和临床原则。\n- **适定性**：该问题提供了计算所需后验概率及相关指标的所有必要信息（先验和似然）。问题明确，要求根据所提供的数据进行计算和解释。对于概率计算，存在一个唯一的、稳定的、有意义的解。\n- **客观性**：该问题使用精确、客观的数学和临床术语进行陈述。问题设置中没有主观或基于观点的论断。\n\n问题陈述没有违反任何无效标准。它是科学上合理的、适定的和客观的。这是一个可形式化的问题，与思维精神病理学直接相关。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。将推导完整的解决方案。\n\n### 定量指标的推导\n\n设$H_R$为罐子是R罐的假设，设$H_B$为罐子是B罐的假设。设$E$为抽到红珠子的证据。\n\n已知条件可以形式化为：\n- 先验概率：$P(H_R) = 0.5$, $P(H_B) = 0.5$。\n- 似然：$P(E | H_R) = 0.6$, $P(E | H_B) = 0.4$。\n\n**1. 后验概率**\n我们使用贝叶斯定理计算后验概率 $P(H_R | E)$：\n$$ P(H_R | E) = \\frac{P(E | H_R) P(H_R)}{P(E)} $$\n首先，我们使用全概率定律计算证据的边缘概率 $P(E)$：\n$$ P(E) = P(E | H_R) P(H_R) + P(E | H_B) P(H_B) $$\n$$ P(E) = (0.6)(0.5) + (0.4)(0.5) = 0.3 + 0.2 = 0.5 $$\n现在，我们可以计算后验概率：\n$$ P(H_R | E) = \\frac{(0.6)(0.5)}{0.5} = 0.6 $$\n在给定一次红色抽取的条件下，罐子是R罐的规范（正确）后验概率是$0.6$。\n\n**2. 贝叶斯因子 (BF)**\n贝叶斯因子是两个竞争假设下证据的似然之比。支持$H_R$相对于$H_B$的BF为：\n$$ BF_{RB} = \\frac{P(E | H_R)}{P(E | H_B)} = \\frac{0.6}{0.4} = 1.5 $$\n这意味着如果罐子是R罐，出现这个证据（一颗红珠子）的可能性是罐子为B罐时的$1.5$倍。\n\n**3. 对数似然比 (LLR)**\nLLR是贝叶斯因子的自然对数：\n$$ LLR = \\ln(BF_{RB}) = \\ln(1.5) \\approx 0.405 $$\nLLR表示在对数尺度上证据的权重。\n\n**4. 决策所需抽取次数 (DTD)**\n患者在仅观察到一颗珠子后就做出了决定。因此，DTD为$1$。\n\n**5. 最小决策阈值**\n患者决定选择R罐。对于一个理性主体，当一个假设的后验概率超过某个阈值$T$时，就会做出决策。由于决策是在后验概率达到$P(H_R | E) = 0.6$时做出的，因此患者的行为与一个决策阈值$T \\le 0.6$是一致的。这被认为是一个“宽松的”阈值，因为决策是基于相对较弱的证据做出的。\n\n**6. 校准差距（过度自信）**\n校准差距是患者的主观置信度与规范后验概率之间的差异。\n- 主观置信度：$0.9$\n- 规范后验概率：$0.6$\n- 校准差距 = 主观置信度 - 规范后验概率 = $0.9 - 0.6 = 0.3$。\n由于主观置信度显著高于基于证据的客观概率，这表现出一种过度自信或校准不佳的状态。\n\n**7. 临床解释**\n- **草率结论 (JTC)**：极低的DTD（$1$）和在弱证据（后验概率为$0.6$）基础上做出决策时的高度自信（$90\\%$）相结合，是JTC这种认知偏差的标志。\n- **与精神病理学的关联**：在精神病的背景下，JTC与妄想有很强的关联，并被认为是精神分裂症谱系的一个认知易感性标志。它反映了在信念更新和证据整合方面的偏差，这些是思维精神病理学的核心方面。\n- **治疗目标**：作为一种推理偏差，JTC是认知干预（如元认知训练MCT）的一个可行目标，这些干预旨在让患者更加意识到自己的认知偏差，并鼓励更保守、基于证据的推理。\n- **与感知的区别**：该任务评估的是关于概率的高阶推理，而非初级的感觉知觉。假设患者能正确感知珠子的颜色；错误在于赋予这条证据的权重以及随后的信念形成过程。\n\n### 逐项分析\n\n**A. 抽取一颗红珠子后的后验概率为$0.6$，支持R罐相对于B罐的贝叶斯因子（BF）为$1.5$，对数似然比（LLR）为$\\ln(1.5)\\approx 0.405$，决策所需抽取次数（DTD）为$1$，与该行为一致的最小决策阈值为$T\\le 0.6$；$0.9$的置信度评分产生$0.3$的过度自信（校准不准）差距。在临床上，这反映了“草率结论”（JTC）和一种宽松的接受阈值，后者与精神分裂症谱系中对妄想观念的易感性相关；这表明认知干预应以概率推理和信息收集为目标，并且这并不表示存在原发性的感知异常。**\n\n- **定量指标**：后验概率（$0.6$）、BF（$1.5$）、LLR（$\\approx 0.405$）、DTD（$1$）、决策阈值（$T \\le 0.6$）和校准差距（$0.3$）都计算正确。\n- **临床解释**：该解释正确地指出了JTC、宽松的接受阈值、与妄想观念的联系、作为治疗目标的角色，以及与感知缺陷的区别。这与该领域的科学共识完全一致。\n- **结论**：**正确**。\n\n**B. 抽取一颗红珠子后的后验概率为$0.75$，BF为$3.0$，LLR为$\\ln(3)\\approx 1.098$，DTD为$1$，阈值为$T\\ge 0.75$；$0.9$的置信度评分校准良好。在临床上，这反映了保守的证据收集行为，这种行为更多见于强迫性检查而非精神病性观念。**\n\n- **定量指标**：后验概率被错误地陈述为$0.75$而不是$0.6$。BF被错误地陈述为$3.0$而不是$1.5$。因此LLR也是错误的。将置信度评分解释为“校准良好”是错误的。\n- **临床解释**：将该行为解释为“保守的证据收集”与JTC所代表的含义正好相反。\n- **结论**：**错误**。\n\n**C. 因为证据极少，后验概率必须保持在$0.5$附近，任何立即做出的决策最好被理解为异常的感觉知觉而非推理；因此，珠子任务主要测量的是感知扭曲，它预测幻觉严重程度的能力要强于预测妄想信念的能力。**\n\n- **定量指标**：声称后验概率“必须保持在$0.5$附近”是不精确且不正确的。它可以被精确计算出来，并且已经计算出为$0.6$。虽然$0.6$离$0.5$不远，但贝叶斯定理提供的是一个精确的更新，而不是一个模糊的近似。\n- **临床解释**：其核心论点，即这是一个“异常感觉知觉”的错误，是根本错误的。珠子任务是概率推理（一种思维过程）的典型测试。JTC与妄想（思维内容障碍）之间的联系，远比其与幻觉（知觉障碍）的联系更强、更直接。\n- **结论**：**错误**。\n\n**D. 后验概率等于$0.6$，BF等于$1.5$，但DTD为$1$表示与精神病无关的冲动性；“草率结论”与妄想信念无关，且以概率推理为目标的干预没有证据表明有益。**\n\n- **定量指标**：后验概率（$0.6$）和BF（$1.5$）是正确的。\n- **临床解释**：临床方面的论断在事实上是不正确的。声称JTC“与精神病无关”和“与妄想信念无关”与大量且一致的科学文献相矛盾。同样，声称以概率推理为目标的干预“没有证据表明有益”也是错误的；多种针对精神病的认知疗法正是这样做的，并且有已证实的证据基础。\n- **结论**：**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "形式思维障碍涉及思维的结构和流程，常常表现为言语的紊乱和缺乏连贯性。传统上，对此类障碍的评估依赖于主观的临床印象，但现代计算语言学为我们提供了客观、可量化的工具。本练习  介绍了一种前沿方法，即使用词嵌入向量来捕捉句子的语义，并通过计算连续句子向量之间的余弦相似度来量化思维的连贯性。这项实践挑战你将复杂的临床概念转化为可操作的算法，让你亲身体验如何运用计算方法来构建精神病理学的客观生物标记。",
            "id": "4749168",
            "problem": "你的任务是形式化一个局部语义连贯性的量化指标，作为思维障碍与正常思维流的代理指标，其理论基础是知觉与思维的精神病理学。其基本依据是，精神病学背景下的思维紊乱表现为思维切线、思维脱轨以及连续话语间局部语义连贯性的降低。在计算层面上，一种经过充分测试的表示方法将句子映射到固定维度的数值嵌入；局部语义连贯性可以通过连续句子的嵌入向量之间的余弦相似度来操作化。你必须从向量几何的核心定义出发，构建连贯性指数和基于阈值的分类器。\n\n定义：\n- 对于$\\mathbb{R}^d$中的任意两个非零向量$\\mathbf{u}$和$\\mathbf{v}$，余弦相似度定义为\n$$\n\\mathrm{cos\\_sim}(\\mathbf{u},\\mathbf{v}) \\equiv \\frac{\\mathbf{u}\\cdot \\mathbf{v}}{\\|\\mathbf{u}\\|_2 \\, \\|\\mathbf{v}\\|_2}.\n$$\n如果$\\|\\mathbf{u}\\|_2 = 0$或$\\|\\mathbf{v}\\|_2 = 0$，则该向量对不贡献有效的相似度，必须从平均计算中排除。\n- 对于一个包含$n$个句子嵌入的序列$\\mathbf{s}_1,\\mathbf{s}_2,\\ldots,\\mathbf{s}_n$，定义有效连续对的数量为$m$，连贯性指数为\n$$\nCI \\equiv \n\\begin{cases}\n\\frac{1}{m} \\sum_{i=1}^{n-1} \\mathrm{cos\\_sim}(\\mathbf{s}_i,\\mathbf{s}_{i+1}) \\;\\;\\text{over all valid pairs,}   \\text{if } m0,\\\\\n0,   \\text{if } m=0. \n\\end{cases}\n$$\n当$m=0$时，$CI=0$的约定反映了由于缺少有效比较而无法建立跨转换的局部连贯性。\n- 分类规则：对于一个阈值$T \\in [-1,1]$，如果$CI  T$，则分类器将序列归类为思维障碍（标签 1）；否则，归类为正常（标签 0）。\n\n你的任务是：\n1. **确定最优阈值 $T$**：使用给定的四个训练序列（$S\\_N1, S\\_D1, S\\_N2, S\\_D2$）及其标签，找到最优分类阈值$T$。最优阈值$T$是在训练集上最大化平衡准确率（Balanced Accuracy, $BA = \\frac{1}{2}(TPR + TNR)$）的阈值。如果多个阈值都能得到相同的最大$BA$，则选择其中最小的那个$T$。将你的答案四舍五入到六位小数。\n2. **对测试数据进行分类**：使用步骤1中确定的最优阈值$T$，对给定的四个测试序列（$T1, T2, T3, T4$）进行分类。\n\n将最终答案格式化为六个元素的列表：`[optimal_T, class_T1, class_T2, class_T3, class_T4]`，其中`optimal_T`是你计算出的阈值，$class\\_Tx$是序列$Tx$的分类标签（$0$或$1$）。\n\n**训练数据**：\n- $S\\_N1$（标签 $0$）：$\\big[[1,1,0,0,0],[1.1,0.9,0.1,0,0],[0.9,1.05,-0.05,0,0],[1,1,0,0,0]\\big]$\n- $S\\_D1$（标签 $1$）：$\\big[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0]\\big]$\n- $S\\_N2$（标签 $0$）：$\\big[[0,0,1,1,0],[0,0.1,1,0.9,0.05],[0,-0.05,1.05,1.1,-0.02],[0,0,1,1,0]\\big]$\n- $S\\_D2$（标签 $1$）：$\\big[[1,0,0,0,0],[-1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0]\\big]$\n\n**测试数据**：\n- $T1$：$\\big[[0,1,1,0,0],[0,0.9,1.1,-0.05,0],[0,1.05,0.95,0.02,0],[0,0.98,1.02,-0.01,0]\\big]$\n- $T2$：$\\big[[1,0,0,0,0],[0,0,-1,0,0],[0,1,0,0,0],[0,0,0,1,0]\\big]$\n- $T3$：$\\big[[1,2,3,4,5]\\big]$\n- $T4$：$\\big[[0,0,0,0,0],[1,1,0,0,0],[0,0,0,0,0],[1,-1,0,0,0]\\big]$",
            "solution": "问题陈述已经过评估，并被确定为有效。它在科学上基于计算语言学和精神病学的既定原则，定义明确，数据充分，表述客观。所有术语都得到了正式定义，计算任务的结构可以产生唯一且可验证的解决方案。该问题没有说明中列出的导致无效的缺陷。因此，我们可以着手解决。\n\n解决方案是一个多步骤的过程：\n1.  为四个训练序列中的每一个计算连贯性指数（$CI$）。\n2.  通过在训练集上最大化平衡准确率（$BA$）来确定最优分类阈值$T$。\n3.  为四个测试序列中的每一个计算$CI$，并使用确定的阈值$T$对它们进行分类。\n\n所有向量运算都在$\\mathbb{R}^5$中执行。\n\n**第一步：训练集的连贯性指数（$CI$）计算**\n\n连贯性指数（$CI$）是连续有效句子的嵌入之间的平均余弦相似度。如果一对向量$(\\mathbf{s}_i, \\mathbf{s}_{i+1})$中两个向量的L2范数都不为零，则该对向量是有效的。\n\n余弦相似度为 $\\mathrm{cos\\_sim}(\\mathbf{u},\\mathbf{v}) = \\frac{\\mathbf{u}\\cdot \\mathbf{v}}{\\|\\mathbf{u}\\|_2 \\, \\|\\mathbf{v}\\|_2}$。\n\n1.  **序列 $S\\_N1$（标签 $0$，正常）**：\n    $\\mathbf{s}_1 = [1,1,0,0,0]$, $\\mathbf{s}_2 = [1.1,0.9,0.1,0,0]$, $\\mathbf{s}_3 = [0.9,1.05,-0.05,0,0]$, $\\mathbf{s}_4 = [1,1,0,0,0]$.\n    所有向量都是非零的。共有$m=3$个有效对。\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_1, \\mathbf{s}_2) = \\frac{1(1.1) + 1(0.9)}{\\sqrt{1^2+1^2}\\sqrt{1.1^2+0.9^2+0.1^2}} = \\frac{2}{\\sqrt{2}\\sqrt{2.03}} = \\frac{2}{\\sqrt{4.06}} \\approx 0.992523$\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_2, \\mathbf{s}_3) = \\frac{1.1(0.9) + 0.9(1.05) + 0.1(-0.05)}{\\sqrt{2.03}\\sqrt{0.9^2+1.05^2+(-0.05)^2}} = \\frac{1.93}{\\sqrt{2.03}\\sqrt{1.915}} = \\frac{1.93}{\\sqrt{3.88745}} \\approx 0.978749$\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_3, \\mathbf{s}_4) = \\frac{0.9(1) + 1.05(1)}{\\sqrt{1.915}\\sqrt{2}} = \\frac{1.95}{\\sqrt{3.83}} \\approx 0.996425$\n    -   $CI(S\\_N1) = \\frac{1}{3}(0.992523 + 0.978749 + 0.996425) \\approx 0.989232$\n\n2.  **序列 $S\\_D1$（标签 $1$，思维障碍）**：\n    $\\mathbf{s}_1 = [1,0,0,0,0]$, $\\mathbf{s}_2 = [0,1,0,0,0]$, $\\mathbf{s}_3 = [0,0,1,0,0]$, $\\mathbf{s}_4 = [0,0,0,1,0]$.\n    所有向量都是非零单位向量。所有连续对都是正交的。\n    -   对于 $i=1, 2, 3$，$\\mathbf{s}_i \\cdot \\mathbf{s}_{i+1} = 0$。\n    -   对于所有对，$\\mathrm{cos\\_sim}(\\mathbf{s}_i, \\mathbf{s}_{i+1}) = 0$。\n    -   $CI(S\\_D1) = \\frac{1}{3}(0 + 0 + 0) = 0$\n\n3.  **序列 $S\\_N2$（标签 $0$，正常）**：\n    $\\mathbf{s}_1 = [0,0,1,1,0]$, $\\mathbf{s}_2 = [0,0.1,1,0.9,0.05]$, $\\mathbf{s}_3 = [0,-0.05,1.05,1.1,-0.02]$, $\\mathbf{s}_4 = [0,0,1,1,0]$.\n    所有向量都是非零的。共有$m=3$个有效对。\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_1, \\mathbf{s}_2) = \\frac{1(1) + 1(0.9)}{\\sqrt{2}\\sqrt{0.1^2+1^2+0.9^2+0.05^2}} = \\frac{1.9}{\\sqrt{2}\\sqrt{1.8225}} = \\frac{1.9}{1.35\\sqrt{2}} \\approx 0.995221$\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_2, \\mathbf{s}_3) = \\frac{0.1(-0.05) + 1(1.05) + 0.9(1.1) + 0.05(-0.02)}{\\sqrt{1.8225}\\sqrt{(-0.05)^2+1.05^2+1.1^2+(-0.02)^2}} = \\frac{2.034}{\\sqrt{1.8225}\\sqrt{2.3154}} \\approx 0.990145$\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_3, \\mathbf{s}_4) = \\frac{1.05(1) + 1.1(1)}{\\sqrt{2.3154}\\sqrt{2}} = \\frac{2.15}{\\sqrt{4.6308}} \\approx 0.999052$\n    -   $CI(S\\_N2) = \\frac{1}{3}(0.995221 + 0.990145 + 0.999052) \\approx 0.994806$\n\n4.  **序列 $S\\_D2$（标签 $1$，思维障碍）**：\n    $\\mathbf{s}_1 = [1,0,0,0,0]$, $\\mathbf{s}_2 = [-1,0,0,0,0]$, $\\mathbf{s}_3 = [0,1,0,0,0]$, $\\mathbf{s}_4 = [0,0,1,0,0]$.\n    所有向量都是非零的。共有$m=3$个有效对。\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_1, \\mathbf{s}_2) = -1$（向量是反平行的）。\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_2, \\mathbf{s}_3) = 0$（向量是正交的）。\n    -   $\\mathrm{cos\\_sim}(\\mathbf{s}_3, \\mathbf{s}_4) = 0$（向量是正交的）。\n    -   $CI(S\\_D2) = \\frac{1}{3}(-1 + 0 + 0) = -1/3 \\approx -0.333333$\n\n**第二步：最优阈值确定**\n\n我们有以下（$CI$，标签）对的训练集：\n$\\{ (-0.333333, 1), (0, 1), (0.989232, 0), (0.994806, 0) \\}$。\n有$P=2$个正例（思维障碍，标签$1$）样本和$N=2$个负例（正常，标签$0$）样本。\n排序后的唯一$CI$值为 $v_1 = -1/3$, $v_2 = 0$, $v_3 \\approx 0.989232$, $v_4 \\approx 0.994806$。\n候选阈值是连续排序的唯一值之间的中点，加上$-1$和$1$。\n-   $T_1 = -1$\n-   $T_2 = (v_1 + v_2) / 2 = (-1/3 + 0)/2 = -1/6 \\approx -0.166667$\n-   $T_3 = (v_2 + v_3) / 2 = (0 + 0.989232)/2 \\approx 0.494616$\n-   $T_4 = (v_3 + v_4) / 2 = (0.989232 + 0.994806)/2 \\approx 0.992019$\n-   $T_5 = 1$\n\n我们为每个候选$T$评估平衡准确率$BA(T) = \\frac{1}{2}(\\mathrm{TPR}(T) + \\mathrm{TNR}(T))$。如果一个序列的$CI  T$，则它被分类为思维障碍（1）。\n\n-   对于 $T = -0.166667$：\n    -   预测：$CI(S\\_D2)  T \\implies 1$；$CI(S\\_D1) \\not T \\implies 0$；$CI(S\\_N1) \\not T \\implies 0$；$CI(S\\_N2) \\not T \\implies 0$。\n    -   TP=1, FN=1, TN=2, FP=0。TPR = $1/2 = 0.5$。TNR = $2/2 = 1.0$。\n    -   $BA = 0.5 \\times (0.5 + 1.0) = 0.75$。\n\n-   对于 $T = 0.494616$：\n    -   预测：$CI(S\\_D2)  T \\implies 1$；$CI(S\\_D1)  T \\implies 1$；$CI(S\\_N1) \\not T \\implies 0$；$CI(S\\_N2) \\not T \\implies 0$。\n    -   TP=2, FN=0, TN=2, FP=0。TPR = $2/2 = 1.0$。TNR = $2/2 = 1.0$。\n    -   $BA = 0.5 \\times (1.0 + 1.0) = 1.0$。\n\n-   对于 $T = 0.992019$：\n    -   预测：$CI(S\\_D2)  T \\implies 1$；$CI(S\\_D1)  T \\implies 1$；$CI(S\\_N1)  T \\implies 1$；$CI(S\\_N2) \\not T \\implies 0$。\n    -   TP=2, FN=0, TN=1, FP=1。TPR = $2/2 = 1.0$。TNR = $1/2 = 0.5$。\n    -   $BA = 0.5 \\times (1.0 + 0.5) = 0.75$。\n\n最大$BA$为$1.0$，该值由阈值$T \\approx 0.494616$唯一实现。因此，这是我们选择的阈值。\n\n**第三步：测试序列分类**\n\n我们现在为每个测试序列计算$CI$，并使用$T \\approx 0.494616$对其进行分类。\n\n1.  **测试序列 $T1$**：\n    序列：$\\big[[0,1,1,0,0],[0,0.9,1.1,-0.05,0],[0,1.05,0.95,0.02,0],[0,0.98,1.02,-0.01,0]\\big]$。\n    这些向量与$S\\_N1$和$S\\_N2$相似，表明具有高连贯性。\n    -   $\\mathrm{cos\\_sim}_1 \\approx 0.993884$\n    -   $\\mathrm{cos\\_sim}_2 \\approx 0.989211$\n    -   $\\mathrm{cos\\_sim}_3 \\approx 0.997204$\n    -   $CI(T1) = \\frac{1}{3}(0.993884 + 0.989211 + 0.997204) \\approx 0.993433$。\n    -   由于$CI(T1) \\approx 0.993433 \\not 0.494616$，分类为$0$（正常）。\n\n2.  **测试序列 $T2$**：\n    序列：$\\big[[1,0,0,0,0],[0,0,-1,0,0],[0,1,0,0,0],[0,0,0,1,0]\\big]$。\n    -   所有连续向量对都是正交的。\n    -   对于所有对，$\\mathrm{cos\\_sim}(\\mathbf{s}_i, \\mathbf{s}_{i+1}) = 0$。\n    -   $CI(T2) = 0$。\n    -   由于$CI(T2) = 0  0.494616$，分类为$1$（思维障碍）。\n\n3.  **测试序列 $T3$**：\n    序列：$\\big[[1,2,3,4,5]\\big]$。\n    -   该序列只有$n=1$个句子。连续对的数量为$n-1=0$。\n    -   有效对的数量为$m=0$。\n    -   根据定义，如果$m=0$，则$CI=0$。\n    -   由于$CI(T3) = 0  0.494616$，分类为$1$（思维障碍）。\n\n4.  **测试序列 $T4$**：\n    序列：$\\big[[0,0,0,0,0],[1,1,0,0,0],[0,0,0,0,0],[1,-1,0,0,0]\\big]$。\n    -   对 1: $(\\mathbf{s}_1, \\mathbf{s}_2)$。$\\mathbf{s}_1$是一个零向量，所以这对是无效的。\n    -   对 2: $(\\mathbf{s}_2, \\mathbf{s}_3)$。$\\mathbf{s}_3$是一个零向量，所以这对是无效的。\n    -   对 3: $(\\mathbf{s}_3, \\mathbf{s}_4)$。$\\mathbf{s}_3$是一个零向量，所以这对是无效的。\n    -   有效对的数量为$m=0$。\n    -   根据定义，如果$m=0$，则$CI=0$。\n    -   由于$CI(T4) = 0  0.494616$，分类为$1$（思维障碍）。\n\n**最终结果总结**\n-   最优阈值 $T \\approx 0.494616$\n-   $T1$ 的分类：$0$\n-   $T2$ 的分类：$1$\n-   $T3$ 的分类：$1$\n-   $T4$ 的分类：$1$\n\n最终输出将以指定格式列出这些值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the quantitative index of local semantic coherence, determines\n    an optimal classification threshold, and classifies test sequences.\n    \"\"\"\n\n    # Data specification\n    # Training sequences with labels (0: normal, 1: disordered)\n    train_data = {\n        'S_N1': (np.array([[1,1,0,0,0], [1.1,0.9,0.1,0,0], [0.9,1.05,-0.05,0,0], [1,1,0,0,0]]), 0),\n        'S_D1': (np.array([[1,0,0,0,0], [0,1,0,0,0], [0,0,1,0,0], [0,0,0,1,0]]), 1),\n        'S_N2': (np.array([[0,0,1,1,0], [0,0.1,1,0.9,0.05], [0,-0.05,1.05,1.1,-0.02], [0,0,1,1,0]]), 0),\n        'S_D2': (np.array([[1,0,0,0,0], [-1,0,0,0,0], [0,1,0,0,0], [0,0,1,0,0]]), 1)\n    }\n\n    # Test sequences\n    test_data = {\n        'T1': np.array([[0,1,1,0,0], [0,0.9,1.1,-0.05,0], [0,1.05,0.95,0.02,0], [0,0.98,1.02,-0.01,0]]),\n        'T2': np.array([[1,0,0,0,0], [0,0,-1,0,0], [0,1,0,0,0], [0,0,0,1,0]]),\n        'T3': np.array([[1,2,3,4,5]]),\n        'T4': np.array([[0,0,0,0,0], [1,1,0,0,0], [0,0,0,0,0], [1,-1,0,0,0]])\n    }\n\n    def calculate_ci(sequence):\n        \"\"\"\n        Calculates the Coherence Index (CI) for a sequence of sentence embeddings.\n        \"\"\"\n        if sequence.shape[0] == 1:\n            return 0.0\n\n        similarities = []\n        \n        for i in range(sequence.shape[0] - 1):\n            s_i = sequence[i]\n            s_i_plus_1 = sequence[i+1]\n            \n            norm_s_i = np.linalg.norm(s_i)\n            norm_s_i_plus_1 = np.linalg.norm(s_i_plus_1)\n\n            if norm_s_i == 0 or norm_s_i_plus_1 == 0:\n                continue\n\n            dot_product = np.dot(s_i, s_i_plus_1)\n            cos_sim = dot_product / (norm_s_i * norm_s_i_plus_1)\n            similarities.append(cos_sim)\n\n        if not similarities:\n            return 0.0\n        \n        return np.mean(similarities)\n\n    # Step 1: Compute CI for all training sequences\n    train_cis = []\n    train_labels = []\n    for name, (data, label) in train_data.items():\n        ci = calculate_ci(data)\n        train_cis.append(ci)\n        train_labels.append(label)\n\n    # Step 2: Determine the optimal threshold T\n    unique_sorted_cis = sorted(list(set(train_cis)))\n    \n    candidate_thresholds = set([-1.0, 1.0])\n    for i in range(len(unique_sorted_cis) - 1):\n        midpoint = (unique_sorted_cis[i] + unique_sorted_cis[i+1]) / 2\n        candidate_thresholds.add(midpoint)\n    \n    best_t_list = []\n    max_ba = -np.inf\n\n    pos_samples = sum(1 for label in train_labels if label == 1)\n    neg_samples = sum(1 for label in train_labels if label == 0)\n\n    for t_cand in sorted(list(candidate_thresholds)):\n        predictions = [1 if ci  t_cand else 0 for ci in train_cis]\n        \n        tp = sum(1 for i in range(len(train_labels)) if train_labels[i] == 1 and predictions[i] == 1)\n        tn = sum(1 for i in range(len(train_labels)) if train_labels[i] == 0 and predictions[i] == 0)\n        \n        tpr = tp / pos_samples if pos_samples  0 else 0.0\n        tnr = tn / neg_samples if neg_samples  0 else 0.0\n        \n        ba = 0.5 * (tpr + tnr)\n\n        if ba  max_ba:\n            max_ba = ba\n            best_t_list = [t_cand]\n        elif ba == max_ba:\n            best_t_list.append(t_cand)\n\n    # Among thresholds with max BA, choose the smallest T\n    optimal_t = min(best_t_list)\n\n    # Step 3: Compute CI for test sequences and classify\n    test_classifications = []\n    for name in ['T1', 'T2', 'T3', 'T4']:\n        data = test_data[name]\n        ci = calculate_ci(data)\n        classification = 1 if ci  optimal_t else 0\n        test_classifications.append(classification)\n\n    # Final output formatting\n    c1, c2, c3, c4 = test_classifications\n    print(f\"[{optimal_t:.6f},{c1},{c2},{c3},{c4}]\")\n\nsolve()\n```"
        }
    ]
}