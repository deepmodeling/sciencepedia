{
    "hands_on_practices": [
        {
            "introduction": "任何精神科分类系统的基石都在于其可靠性——即不同临床医生在应用相同标准时能否达成一致。科恩卡帕系数（Cohen's kappa, $\\kappa$）是衡量观察者间信度（inter-rater reliability）的关键指标，因为它不仅计算一致性比例，还校正了偶然达成一致的可能性。本练习将引导你从基本原理出发，计算$\\kappa$系数，从而掌握评估诊断分类系统一致性的核心技能。",
            "id": "4698074",
            "problem": "在《精神疾病诊断与统计手册》(DSM) 和《国际疾病分类》(ICD) 的诊断一致性背景下，评分者间信度提供了一个定量评估，衡量临床医生将病例分类为诸如疾病存在与否等类别的稳定性。假设有两名精神科医生根据标准化准则，独立地对$n=100$名成人门诊患者的单一疾病进行评估，判断其为存在或不存在。他们的联合分类构成一个$2\\times 2$的表格，其格子计数分别表示为$a$、$b$、$c$和$d$，其中$a$是两名评分者都评定为“存在”的病例数，$b$是评分者A评定为“存在”而评分者B评定为“不存在”的病例数，$c$是评分者A评定为“不存在”而评分者B评定为“存在”的病例数，$d$是两名评分者都评定为“不存在”的病例数。在这个经验数据集中，计数分别为$a=40$、$b=10$、$c=5$和$d=45$。\n\n从适用于精神科分类中信度评估的基本原则出发：\n- 将观察到的一致性视为两个可用类别上的一致性评分的比例，仅使用联合表中的信息。\n- 将偶然情况下的预期一致性视为由评分者边际分类赋值的独立性所预测的一致性，仅使用联合表的边际总数中的信息。\n\n基于这些基础，推导一个用于二元分类的机会校正后的一致性指数（Cohen’s $\\kappa$），并为给定数据计算其值。将$\\kappa$的最终值表示为精确的小数形式。无需四舍五入。",
            "solution": "该问题是有效的。它是一个来自心理计量学领域的具有科学依据、提法恰当、客观且完整的题目陈述。心理计量学是定量心理学的一个分支，与所述的精神科背景直接相关。推导和计算Cohen's Kappa（$\\kappa$）所需的所有必要数据和定义均已提供。\n\n目标是推导并计算Cohen's Kappa，一个机会校正后的评分者间一致性指数。该指数的通用公式为：\n$$ \\kappa = \\frac{P_o - P_e}{1 - P_e} $$\n其中$P_o$是观察到的一致性比例，$P_e$是偶然预期的一致性比例。我们将根据题目陈述中指定的基本原则来推导每个组成部分。\n\n数据以一个$2 \\times 2$列联表的形式呈现，其中行代表评分者A的评分，列代表评分者B的评分。格子分别表示为$a$、$b$、$c$和$d$。\n- $a$：评分者A“存在”，评分者B“存在”\n- $b$：评分者A“存在”，评分者B“不存在”\n- $c$：评分者A“不存在”，评分者B“存在”\n- $d$：评分者A“不存在”，评分者B“不存在”\n\n给定的计数为$a=40$、$b=10$、$c=5$和$d=45$。被评估的总受试者人数为$n = a+b+c+d = 40+10+5+45=100$。\n\n首先，我们计算观察到的一致性比例$P_o$。问题将其定义为一致性评分的比例。当两名评分者意见一致时，即为一致，这对应于格子$a$（均评为“存在”）和格子$d$（均评为“不存在”）中的情况。一致的总数是这两个格子中计数的总和。该比例是此总和除以总受试者人数$n$。\n$$ P_o = \\frac{a+d}{n} $$\n代入给定值：\n$$ P_o = \\frac{40+45}{100} = \\frac{85}{100} = 0.85 $$\n\n接下来，我们计算偶然情况下的预期一致性比例$P_e$。问题指明，这是基于评分者边际分类赋值之间统计独立性的假设。我们必须首先确定每个评分者和每个类别的边际总数。\n评分者A评定为“存在”的边际总数为$N_{A,P} = a+b$。\n评分者A评定为“不存在”的边际总数为$N_{A,A} = c+d$。\n评分者B评定为“存在”的边际总数为$N_{B,P} = a+c$。\n评分者B评定为“不存在”的边际总数为$N_{B,A} = b+d$。\n\n每个评分者在每个类别中的评分比例如下：\n评分者A评为“存在”的比例：$p_{A,P} = \\frac{a+b}{n} = \\frac{40+10}{100} = \\frac{50}{100} = 0.5$\n评分者A评为“不存在”的比例：$p_{A,A} = \\frac{c+d}{n} = \\frac{5+45}{100} = \\frac{50}{100} = 0.5$\n评分者B评为“存在”的比例：$p_{B,P} = \\frac{a+c}{n} = \\frac{40+5}{100} = \\frac{45}{100} = 0.45$\n评分者B评为“不存在”的比例：$p_{B,A} = \\frac{b+d}{n} = \\frac{10+45}{100} = \\frac{55}{100} = 0.55$\n\n在独立性假设下，两个事件的联合概率是它们各自概率的乘积。偶然预期的一致性比例$P_e$是两种一致性类型（均为“存在”，均为“不存在”）偶然发生的概率之和。\n两名评分者偶然一致评定为“存在”的概率是$p_{A,P} \\times p_{B,P}$。\n两名评分者偶然一致评定为“不存在”的概率是$p_{A,A} \\times p_{B,A}$。\n因此，总的预期一致性比例为：\n$$ P_e = (p_{A,P} \\times p_{B,P}) + (p_{A,A} \\times p_{B,A}) $$\n用格子计数表示：\n$$ P_e = \\left(\\frac{a+b}{n}\\right)\\left(\\frac{a+c}{n}\\right) + \\left(\\frac{c+d}{n}\\right)\\left(\\frac{b+d}{n}\\right) $$\n代入计算出的比例：\n$$ P_e = (0.5 \\times 0.45) + (0.5 \\times 0.55) $$\n$$ P_e = 0.225 + 0.275 = 0.50 $$\n\n最后，我们使用Cohen's Kappa的公式，代入计算出的$P_o$和$P_e$的值。分子$P_o - P_e$表示观察到的一致性水平超出偶然预期的部分。分母$1 - P_e$表示可能实现的超出偶然预期的最大一致性。\n$$ \\kappa = \\frac{P_o - P_e}{1 - P_e} $$\n代入$P_o = 0.85$和$P_e = 0.50$：\n$$ \\kappa = \\frac{0.85 - 0.50}{1 - 0.50} = \\frac{0.35}{0.50} $$\n$$ \\kappa = 0.7 $$\n此数据集的Cohen's Kappa值恰好为$0.7$。",
            "answer": "$$\n\\boxed{0.7}\n$$"
        },
        {
            "introduction": "一个可靠的诊断工具未必在临床上总是有用，其价值取决于它在特定人群中的预测能力。阳性预测值（PPV）和阴性预测值（NPV）是衡量这种临床效用的关键指标，它们揭示了一个阳性或阴性结果在现实世界中真正意味着什么。本练习将通过贝叶斯定理，演示一个诊断工具的敏感度（sensitivity）和特异度（specificity）如何与疾病的患病率（prevalence）相互作用，共同决定其预测能力，帮助你深入理解诊断测试的内在属性与其实际应用价值之间的区别。",
            "id": "4698111",
            "problem": "一项旨在根据《精神疾病诊断与统计手册》（DSM）对重度抑郁症进行分类的结构化诊断访谈，正与金标准的临床医生诊断进行对比评估。\n\n在一个社区门诊精神科环境中，接受筛查的人群中重度抑郁症的患病率为 $0.10$。在区分病例与非病例时，该访谈显示的灵敏度为 $0.85$，特异度为 $0.90$。\n\n仅使用核心定义和贝叶斯定理，推导该访谈在此环境下的阳性预测值（PPV）和阴性预测值（NPV）。然后，根据您推导出的值，解释在该人群中用于确诊与排除重度抑郁症的临床意义，并根据计算出的概率以及灵敏度、特异度和患病率的已知特性进行明确论证。\n\n将PPV和NPV以小数形式报告，保留四位有效数字。不允许使用百分号。您的最终数值答案必须按PPV、NPV的顺序包含这两个值。",
            "solution": "首先验证问题，以确保其科学合理、提法明确且客观。\n\n### 步骤1：提取已知条件\n-   重度抑郁症（MDD）的患病率：$P(\\text{MDD}) = 0.10$\n-   诊断访谈的灵敏度：$\\text{灵敏度} = 0.85$\n-   诊断访谈的特异度：$\\text{特异度} = 0.90$\n-   任务：推导阳性预测值（PPV）和阴性预测值（NPV）。\n-   方法：仅使用核心定义和贝叶斯定理。\n-   任务：解释用于确诊与排除MDD的临床意义。\n-   报告格式：小数，保留四位有效数字，顺序为PPV、NPV。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，使用了流行病学和生物统计学中标准且明确定义的概念（患病率、灵敏度、特异度、PPV、NPV、贝叶斯定理）。所提供的值对于诊断筛查工具而言是切合实际的。该问题是自洽的，为所需计算提供了所有必要信息。语言精确客观。任务提法明确，可得出一个唯一且有意义的解。未发现任何缺陷。\n\n### 步骤3：结论与行动\n该问题被认定为有效。将提供一个完整的、有理有据的解答。\n\n### 推导与计算\n\n设 $D$ 为个体患有重度抑郁症的事件。\n设 $D^c$ 为个体未患有重度抑郁症的事件。\n设 $T^+$ 为诊断访谈结果为阳性的事件。\n设 $T^-$ 为诊断访谈结果为阴性的事件。\n\n根据问题陈述，我们将给定信息形式化为概率：\n1.  MDD的患病率是患有该疾病的先验概率：\n    $$ P(D) = 0.10 $$\n    由此，未患该病的概率为：\n    $$ P(D^c) = 1 - P(D) = 1 - 0.10 = 0.90 $$\n\n2.  灵敏度是指在个体患有该疾病的情况下，测试结果为阳性的概率。这是真阳性率。\n    $$ \\text{Sensitivity} = P(T^+ | D) = 0.85 $$\n\n3.  特异度是指在个体未患有该疾病的情况下，测试结果为阴性的概率。这是真阴性率。\n    $$ \\text{Specificity} = P(T^- | D^c) = 0.90 $$\n\n从灵敏度和特异度，我们还可以推导出假阴性率和假阳性率：\n-   假阴性率是在存在该疾病的情况下，测试结果为阴性的概率：\n    $$ P(T^- | D) = 1 - P(T^+ | D) = 1 - 0.85 = 0.15 $$\n-   假阳性率是在不存在该疾病的情况下，测试结果为阳性的概率：\n    $$ P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - 0.90 = 0.10 $$\n\n**阳性预测值 (PPV)**\n\nPPV 是在测试结果为阳性的情况下，个体患有该疾病的概率，即 $P(D | T^+)$。我们使用贝叶斯定理来推导这个值：\n$$ \\text{PPV} = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)} $$\n分母 $P(T^+)$ 是测试结果为阳性的总概率。它通过全概率公式计算得出，即对患病和未患病个体测试结果为阳性的概率求和：\n$$ P(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c) $$\n将此代入PPV的表达式中：\n$$ \\text{PPV} = \\frac{P(T^+ | D) P(D)}{P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)} $$\n现在，我们代入数值：\n$$ \\text{PPV} = \\frac{(0.85)(0.10)}{(0.85)(0.10) + (0.10)(0.90)} = \\frac{0.085}{0.085 + 0.090} = \\frac{0.085}{0.175} $$\n$$ \\text{PPV} \\approx 0.48571428... $$\n保留四位有效数字，我们得到 $\\text{PPV} = 0.4857$。\n\n**阴性预测值 (NPV)**\n\nNPV 是在测试结果为阴性的情况下，个体未患有该疾病的概率，即 $P(D^c | T^-)$。我们再次使用贝叶斯定理：\n$$ \\text{NPV} = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)} $$\n分母 $P(T^-)$ 是测试结果为阴性的总概率，通过全概率公式计算得出：\n$$ P(T^-) = P(T^- | D) P(D) + P(T^- | D^c) P(D^c) $$\n将此代入NPV的表达式中：\n$$ \\text{NPV} = \\frac{P(T^- | D^c) P(D^c)}{P(T^- | D) P(D) + P(T^- | D^c) P(D^c)} $$\n现在，我们代入数值：\n$$ \\text{NPV} = \\frac{(0.90)(0.90)}{(0.15)(0.10) + (0.90)(0.90)} = \\frac{0.81}{0.015 + 0.81} = \\frac{0.81}{0.825} $$\n$$ \\text{NPV} \\approx 0.98181818... $$\n保留四位有效数字，我们得到 $\\text{NPV} = 0.9818$。\n\n**临床意义**\n\n1.  **PPV对确诊的意义：** 计算出的阳性预测值为 $\\text{PPV} = 0.4857$。这意味着，在使用该结构化访谈测试呈阳性的个体中，只有约 $48.6\\%$ 的人真正患有重度抑郁症。假阳性的概率为 $1 - \\text{PPV} = 1 - 0.4857 = 0.5143$，约为 $51.4\\%$。低于 $0.50$ 的PPV是较低的，表明阳性测试结果更可能是假阳性而非真阳性。因此，该访谈对于“确诊”（确认）MDD诊断是一个效果不佳的工具。一个阳性结果将患病可能性从基线患病率 $10\\%$ 显著提高到验后概率 $48.6\\%$，但这不足以作为最终诊断。它应促使进行更全面的临床评估，而不应被视为对该疾病的确认。这个结果是一个典型的例子，说明了即使灵敏度和特异度良好，受试人群中的低患病率也会限制PPV。\n\n2.  **NPV对排除的意义：** 计算出的阴性预测值为 $\\text{NPV} = 0.9818$。这意味着，在测试呈阴性的个体中，他们确实没有患重度抑郁症的概率约为 $98.2\\%$。假阴性（即尽管测试结果为阴性，但该人患有MDD）的概率非常低，为 $1 - \\text{NPV} = 1 - 0.9818 = 0.0182$，约为 $1.8\\%$。如此高的NPV提供了强有力的证据。因此，该访谈是“排除”MDD的绝佳工具。临床医生可以高度确信结果为阴性的患者没有患该疾病，这使其成为一种有效的筛查工具，可以在很大一部分被筛查人群中减少进行更进一步、更耗费资源的 精神科 评估的需求。\n\n总而言之，在这种低患病率的环境中，该诊断访谈对于有把握地排除MDD非常有效，但对于确诊则效果不佳。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4857  0.9818 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在评估了分类系统的信度和效度之后，我们必须审视其内部结构。精神科的分类诊断（如DSM或ICD中的诊断）常常将症状表现迥异的个体归于同一诊断标签下，这便是诊断异质性（diagnostic heterogeneity）问题。本练习通过一个简洁的组合数学模型，让你能够量化在“$n$个症状中满足$k$个”的诊断规则下，究竟存在多少种不同的症状组合可以获得相同的诊断，从而深刻揭示分类诊断背后隐藏的巨大异质性。",
            "id": "4698095",
            "problem": "像《精神疾病诊断与统计手册》(DSM) 这样的分类诊断系统可以被建模为对一组有限标准的阈值规则：如果一个病人满足了 $n$ 个可能标准中的至少 $k$ 个，那么就做出诊断。考虑在一个假设的分类系统下的广泛性焦虑障碍，该系统有 $n=6$ 个标准和一个阈值 $k=3$。假设存在以下生成模型：每个标准被每个个体独立地满足，其特定于标准的满足概率为 $p_{1},\\dots,p_{6}$，且对于所有 $j\\in\\{1,\\dots,6\\}$ 都满足 $0  p_j  1$。在一个无限大的受试者队列中，所有被诊断的个体中，期望有多少种不同的症状组合？您的最终答案应为一个整数，并对诊断异质性的引申意义进行简要解释。",
            "solution": "该问题要求在一个分类诊断模型下，计算无限大队列中被诊断个体中不同症状组合的期望数量。\n\n首先，我们必须将所给的定义形式化。症状组合是个体所满足的标准的集合。对于 $n$ 个可能的标准，一个组合可以表示为所有标准索引集合 $\\{1, 2, \\dots, n\\}$ 的一个子集 $S$。所有可能的不同症状组合的总数是该集合的子集数量，即 $2^n$。\n\n问题陈述，每个标准 $j$ 被独立满足的概率为 $p_j$，其中 $0  p_j  1$。在单个个体中观察到特定症状组合 $S$ 的概率由满足 $S$ 中标准和不满足 $S$ 外标准的概率之积给出：\n$$ P(S) = \\left(\\prod_{j \\in S} p_j\\right) \\left(\\prod_{j' \\notin S} (1-p_{j'})\\right) $$\n给定条件 $0  p_j  1$ 对所有 $j \\in \\{1, \\dots, n\\}$ 成立， $p_j$ 和 $1-p_j$ 都是严格为正的。因此，任何组合 $S$ 的概率 $P(S)$ 都是正数之积，这意味着对于所有 $2^n$ 种可能的组合，都有 $P(S)  0$。\n\n如果满足的标准数量至少为 $k$，则做出诊断。一个症状组合 $S$ 的大小是其基数 $|S|$。因此，如果 $|S| \\ge k$，则组合 $S$ 会得到诊断。令 $\\mathcal{D}$ 为所有此类“被诊断组合”的集合：\n$$ \\mathcal{D} = \\{S \\subseteq \\{1, \\dots, n\\} \\mid |S| \\ge k\\} $$\n\n问题要求在队列规模为 $N$ 且 $N \\to \\infty$ 的极限下，从集合 $\\mathcal{D}$ 中观察到的不同症状组合的期望数量。设 $N_S$ 为规模为 $N$ 的队列中具有组合 $S$ 的个体数量。被诊断的不同组合的数量为 $\\sum_{S \\in \\mathcal{D}} \\mathbb{I}(N_S \\ge 1)$，其中 $\\mathbb{I}(\\cdot)$ 是指示函数。\n\n在规模为 $N$ 的队列中，被诊断的不同组合的期望数量（我们称之为 $E_N$）是：\n$$ E_N = E\\left[\\sum_{S \\in \\mathcal{D}} \\mathbb{I}(N_S \\ge 1)\\right] $$\n根据期望的线性性质，我们可以写出：\n$$ E_N = \\sum_{S \\in \\mathcal{D}} E[\\mathbb{I}(N_S \\ge 1)] = \\sum_{S \\in \\mathcal{D}} P(N_S \\ge 1) $$\n对于任何给定的组合 $S$，在规模为 $N$ 的队列中，个体数量 $N_S$ 服从二项分布 $B(N, P(S))$。观察到组合 $S$ 至少一次的概率是：\n$$ P(N_S \\ge 1) = 1 - P(N_S = 0) = 1 - (1-P(S))^N $$\n将此代入 $E_N$ 的表达式中：\n$$ E_N = \\sum_{S \\in \\mathcal{D}} \\left(1 - (1-P(S))^N\\right) $$\n我们需要求解当 $N \\to \\infty$ 时的极限：\n$$ E_{distinct} = \\lim_{N \\to \\infty} E_N = \\lim_{N \\to \\infty} \\sum_{S \\in \\mathcal{D}} \\left(1 - (1-P(S))^N\\right) $$\n由于求和是基于有限集 $\\mathcal{D}$，我们可以交换极限和求和的顺序：\n$$ E_{distinct} = \\sum_{S \\in \\mathcal{D}} \\lim_{N \\to \\infty} \\left(1 - (1-P(S))^N\\right) $$\n对于每个 $S \\in \\mathcal{D}$，我们已经确定其概率 $P(S)$ 严格大于 $0$ 且严格小于 $1$。令 $p_S = P(S)$。极限项变为：\n$$ \\lim_{N \\to \\infty} (1 - p_S)^N $$\n因为 $0  p_S  1$，所以 $0  1 - p_S  1$。这个范围内的数，其无限大次幂趋近于 $0$。因此：\n$$ \\lim_{N \\to \\infty} (1 - p_S)^N = 0 $$\n所以，对于每个组合 $S \\in \\mathcal{D}$：\n$$ \\lim_{N \\to \\infty} \\left(1 - (1-P(S))^N\\right) = 1 - 0 = 1 $$\n这意味着，在一个任意大的队列中，每个可能的被诊断组合都期望被观察到。因此，被诊断的不同组合的期望数量就是对 $\\mathcal{D}$ 中每个组合求和 $1$：\n$$ E_{distinct} = \\sum_{S \\in \\mathcal{D}} 1 = |\\mathcal{D}| $$\n问题因此简化为一个组合问题：计算满足诊断标准的症状组合的数量，即从一个包含 $n$ 个标准的集合中，选出大小至少为 $k$ 的子集的数量。这个数由二项式系数的和给出：\n$$ |\\mathcal{D}| = \\sum_{m=k}^{n} \\binom{n}{m} $$\n给定 $n=6$ 和 $k=3$。我们需要计算：\n$$ |\\mathcal{D}| = \\sum_{m=3}^{6} \\binom{6}{m} = \\binom{6}{3} + \\binom{6}{4} + \\binom{6}{5} + \\binom{6}{6} $$\n计算每个二项式系数：\n$\\binom{6}{3} = \\frac{6!}{3!(6-3)!} = \\frac{6 \\times 5 \\times 4}{3 \\times 2 \\times 1} = 20$\n$\\binom{6}{4} = \\frac{6!}{4!(6-4)!} = \\frac{6 \\times 5}{2 \\times 1} = 15$\n$\\binom{6}{5} = \\frac{6!}{5!(6-5)!} = \\frac{6}{1} = 6$\n$\\binom{6}{6} = \\frac{6!}{6!(6-6)!} = 1$\n\n将这些值相加：\n$$ |\\mathcal{D}| = 20 + 15 + 6 + 1 = 42 $$\n被诊断个体中不同症状组合的期望数量是 $42$。\n\n这一结果对诊断异质性的引申意义是深远的。数字 $42$ 量化了在该模型下，所有导致相同“广泛性焦虑障碍”诊断的不同症状组合的数量。至关重要的是，只要标准的满足概率 $p_j$ 是非平凡的（即不为0或1），这个数字就完全由诊断规则的组合结构（即 $n$ 和 $k$ 的值）决定，而与具体的概率 $p_j$ 无关。这意味着，无论单个症状是常见还是罕见，获得诊断的路径数量都保持不变。这种现象——同一诊断可以包含症状集可能完全不重叠的个体（例如，组合 $\\{1,2,3\\}$ 和 $\\{4,5,6\\}$ 都会被诊断，但没有任何共同症状）——是诊断类别内部异质性的一个主要来源。这个形式化的结果突显了分类诊断系统的一个根本性局限，并为了解为何带有相同精神病学标签的个体可能表现出截然不同的临床表现提供了定量基础，而这一点反过来又使研究和治疗计划变得复杂。",
            "answer": "$$\\boxed{42}$$"
        }
    ]
}