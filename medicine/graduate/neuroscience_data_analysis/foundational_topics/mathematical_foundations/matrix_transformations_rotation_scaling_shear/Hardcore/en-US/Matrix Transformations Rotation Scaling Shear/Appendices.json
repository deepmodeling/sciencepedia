{
    "hands_on_practices": [
        {
            "introduction": "In neuroscience data analysis, aligning datasets from different sessions or subjects is a common preprocessing step that often relies on rigid transformations—rotations and translations—to preserve the underlying geometry. This first exercise  provides a hands-on opportunity to connect the algebraic definition of an orthogonal matrix, $A^{\\top}A = I$, to the essential geometric property of distance preservation. Mastering this connection is a cornerstone for understanding and validating image registration techniques.",
            "id": "4177142",
            "problem": "In the alignment of two-dimensional ($2$-D) retinotopic field maps across sessions in Functional Magnetic Resonance Imaging (fMRI) or Electrocorticography (ECoG) analysis, an affine transformation is used to register neuronal response coordinates. Let the affine map be defined by $T(x)=A x + b$, where\n$$\nA=\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}, \\quad b=\\begin{pmatrix}3 \\\\ -2\\end{pmatrix}.\n$$\nConsider the neuron centroid at\n$$\nx^{\\ast}=\\begin{pmatrix}-0.8 \\\\ 2.3\\end{pmatrix}.\n$$\nFirst, compute the mapped coordinate $T(x^{\\ast})$. Then, using only foundational definitions (affine transformation, Euclidean norm, inner product, and orthogonal matrix), derive a rigorous criterion to decide whether the linear part $A$ preserves all Euclidean distances and therefore constitutes a rigid transformation when combined with any translation. Finally, to quantitatively summarize the rigidity decision, compute the scalar deviation-from-rigidity index\n$$\n\\Delta=\\|A^{\\top}A - I\\|_{F},\n$$\nwhere $\\|\\,\\cdot\\,\\|_{F}$ denotes the Frobenius norm and $I$ is the identity matrix. Report $\\Delta$ as your final answer. If your computed value is numerical, report it exactly (no rounding is required).",
            "solution": "We begin from the foundational definitions relevant to affine registration in neuroscience data analysis. An affine transformation in $\\mathbb{R}^{2}$ is a mapping of the form $T(x)=A x + b$, with $A \\in \\mathbb{R}^{2 \\times 2}$ and $b \\in \\mathbb{R}^{2}$. The Euclidean norm of a vector $z \\in \\mathbb{R}^{2}$ is $\\|z\\|=\\sqrt{z^{\\top}z}$, and the Frobenius norm of a matrix $M \\in \\mathbb{R}^{2 \\times 2}$ is $\\|M\\|_{F}=\\sqrt{\\sum_{i=1}^{2}\\sum_{j=1}^{2} M_{ij}^{2}}$. A linear map preserves all Euclidean distances if and only if it preserves the Euclidean norm for all vectors, which equivalently is an orthogonal linear transformation characterized by $A^{\\top}A=I$.\n\nStep $1$: Compute the mapped coordinate $T(x^{\\ast})$. With\n$$\nA=\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}, \\quad b=\\begin{pmatrix}3 \\\\ -2\\end{pmatrix}, \\quad x^{\\ast}=\\begin{pmatrix}-0.8 \\\\ 2.3\\end{pmatrix},\n$$\nwe have\n$$\nA x^{\\ast}=\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}\\begin{pmatrix}-0.8 \\\\ 2.3\\end{pmatrix}=\\begin{pmatrix}-2.3 \\\\ -0.8\\end{pmatrix},\n$$\nand thus\n$$\nT(x^{\\ast})=A x^{\\ast}+b=\\begin{pmatrix}-2.3 \\\\ -0.8\\end{pmatrix}+\\begin{pmatrix}3 \\\\ -2\\end{pmatrix}=\\begin{pmatrix}0.7 \\\\ -2.8\\end{pmatrix}.\n$$\n\nStep $2$: Derive the rigidity criterion from first principles. A transformation $T(x)=A x + b$ is rigid (distance-preserving) if for all pairs $x_{1}, x_{2} \\in \\mathbb{R}^{2}$,\n$$\n\\|T(x_{1})-T(x_{2})\\|=\\|x_{1}-x_{2}\\|.\n$$\nBecause translation by $b$ cancels when taking differences, this reduces to the requirement that for all $z \\in \\mathbb{R}^{2}$,\n$$\n\\|A z\\|=\\|z\\|.\n$$\nUsing the definition of the Euclidean norm, this condition is\n$$\n\\sqrt{(A z)^{\\top}(A z)}=\\sqrt{z^{\\top}z} \\quad \\text{for all } z,\n$$\nwhich, after squaring both sides (preserving equivalence because norms are nonnegative), becomes\n$$\nz^{\\top}A^{\\top}A z=z^{\\top}z \\quad \\text{for all } z.\n$$\nBy the polarization identity and the characterization of quadratic forms, the above holds for all $z$ if and only if\n$$\nA^{\\top}A=I,\n$$\nwhich is precisely the definition of $A$ being an orthogonal matrix. Therefore, the necessary and sufficient criterion for rigidity of the linear part $A$ is $A^{\\top}A=I$.\n\nStep $3$: Compute the deviation-from-rigidity index $\\Delta=\\|A^{\\top}A - I\\|_{F}$. We compute\n$$\nA^{\\top}=\\begin{pmatrix}0 & 1 \\\\ -1 & 0\\end{pmatrix}, \\quad A^{\\top}A=\\begin{pmatrix}0 & 1 \\\\ -1 & 0\\end{pmatrix}\\begin{pmatrix}0 & -1 \\\\ 1 & 0\\end{pmatrix}=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}=I.\n$$\nHence\n$$\nA^{\\top}A - I=\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}-\\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}=\\begin{pmatrix}0 & 0 \\\\ 0 & 0\\end{pmatrix}.\n$$\nThe Frobenius norm of the zero matrix is\n$$\n\\|A^{\\top}A - I\\|_{F}=\\sqrt{0^{2}+0^{2}+0^{2}+0^{2}}=0.\n$$\n\nConclusion: The mapped coordinate is $T(x^{\\ast})=\\begin{pmatrix}0.7 \\\\ -2.8\\end{pmatrix}$, the linear part $A$ is orthogonal, and the deviation-from-rigidity index is $\\Delta=0$, indicating a perfectly rigid transformation (a pure rotation) combined with a translation.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Not all transformations encountered in data analysis are rigid; shear transformations, for instance, can arise from instrumental artifacts like scanner drift and distort shapes in a non-uniform way. This practice  delves into the unique spectral structure of a shear matrix, contrasting it sharply with the properties of rotations. By deriving its Jordan normal form from first principles, you will uncover why shear is fundamentally non-diagonalizable, gaining a deeper appreciation for the mathematical distinctions between different classes of linear transformations.",
            "id": "4177175",
            "problem": "A two-dimensional slice of a calcium imaging plane obtained via two-photon microscopy (2PM) is post-processed to correct for line-by-line drift. A prevalent artifact is a horizontal shear induced by the scanning trajectory: each row is shifted by an amount that is proportional to its vertical coordinate. In a canonical basis, this preprocessing step is modeled by a linear transformation acting on planar coordinates $x$ and $y$ via\n$$\n\\begin{pmatrix}\nx' \\\\ y'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & \\alpha \\\\\n0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nx \\\\ y\n\\end{pmatrix},\n$$\nwhere $\\alpha \\neq 0$ is a dimensionless shear parameter estimated from the data. Treating the transformation as a linear operator on $\\mathbb{R}^{2}$, analyze its spectral structure using only the definitions of eigenvalues, eigenvectors, generalized eigenvectors, and the Jordan normal form.\n\nStarting from the definitions:\n- An eigenvalue $\\lambda$ of a linear operator $A$ satisfies $\\det(A - \\lambda I) = 0$, and a corresponding eigenvector $v \\neq \\mathbf{0}$ satisfies $(A - \\lambda I)v = \\mathbf{0}$.\n- A generalized eigenvector $w$ of rank $2$ satisfies $(A - \\lambda I)w = v$, where $v$ is an eigenvector.\n- The Jordan normal form of $A$ is a block-diagonal matrix with Jordan blocks corresponding to each eigenvalue, obtained via a similarity transformation $A = P J P^{-1}$ where the columns of $P$ form chains of generalized eigenvectors.\n\nFor the shear matrix\n$$\nS(\\alpha) = \\begin{pmatrix} 1 & \\alpha \\\\ 0 & 1 \\end{pmatrix},\n$$\ndemonstrate whether the eigenbasis is defective and compute the Jordan normal form $J$ explicitly. Construct a valid chain of generalized eigenvectors and exhibit a similarity matrix $P$ such that $S(\\alpha) = P J P^{-1}$, verifying the decomposition from first principles. As your final answer, report the Jordan normal form matrix $J$ as a single analytic expression. No rounding is required, and no units are involved. Express any angles, if they appear, in radians.",
            "solution": "The problem requires an analysis of the spectral structure of the horizontal shear matrix $S(\\alpha) = \\begin{pmatrix} 1 & \\alpha \\\\ 0 & 1 \\end{pmatrix}$ for $\\alpha \\neq 0$, culminating in its Jordan normal form. The analysis will proceed from the fundamental definitions of eigenvalues and eigenvectors.\n\nFirst, we find the eigenvalues of $S(\\alpha)$ by solving the characteristic equation $\\det(S(\\alpha) - \\lambda I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det\\left( \\begin{pmatrix} 1 & \\alpha \\\\ 0 & 1 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) = \\det \\begin{pmatrix} 1-\\lambda & \\alpha \\\\ 0 & 1-\\lambda \\end{pmatrix} = 0\n$$\nThe determinant is $(1-\\lambda)^2 - (\\alpha)(0) = (1-\\lambda)^2$.\nSetting this to zero yields $(1-\\lambda)^2 = 0$, which has a single solution $\\lambda = 1$. This eigenvalue has an algebraic multiplicity of $2$.\n\nNext, we find the eigenvectors corresponding to the eigenvalue $\\lambda = 1$ by solving the equation $(S(\\alpha) - \\lambda I)v = \\mathbf{0}$ for a non-zero vector $v = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix}$.\n$$\n(S(\\alpha) - 1 \\cdot I)v = \\begin{pmatrix} 1-1 & \\alpha \\\\ 0 & 1-1 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis matrix-vector equation corresponds to the linear system:\n$$\n\\begin{cases}\n0 \\cdot v_x + \\alpha \\cdot v_y = 0 \\\\\n0 \\cdot v_x + 0 \\cdot v_y = 0\n\\end{cases}\n$$\nThe second equation is trivial ($0=0$). The first equation is $\\alpha v_y = 0$. Since the problem statement specifies that $\\alpha \\neq 0$, we must have $v_y = 0$. The component $v_x$ is a free variable. Thus, any eigenvector must be of the form $v = \\begin{pmatrix} k \\\\ 0 \\end{pmatrix}$ for some scalar $k \\neq 0$.\nThe eigenspace associated with $\\lambda=1$ is the set of all vectors of this form, which is spanned by the single vector $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The dimension of this eigenspace is $1$, which means the geometric multiplicity of the eigenvalue $\\lambda=1$ is $1$.\n\nThe algebraic multiplicity of $\\lambda=1$ is $2$, while its geometric multiplicity is $1$. Since the geometric multiplicity is less than the algebraic multiplicity, there is no basis of eigenvectors for $\\mathbb{R}^2$. Therefore, the matrix $S(\\alpha)$ is defective and is not diagonalizable.\n\nSince $S(\\alpha)$ is a $2 \\times 2$ matrix with one eigenvalue $\\lambda=1$ of algebraic multiplicity $2$ and geometric multiplicity $1$, its Jordan normal form $J$ must consist of a single Jordan block of size $2$ corresponding to $\\lambda=1$. This block has the form $\\begin{pmatrix} \\lambda & 1 \\\\ 0 & \\lambda \\end{pmatrix}$.\nThus, the Jordan normal form of $S(\\alpha)$ is:\n$$\nJ = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}\n$$\nTo find the similarity transformation $S(\\alpha) = P J P^{-1}$, we must construct the matrix $P$ from a chain of generalized eigenvectors. Let the chain be $\\{v_1, v_2\\}$, where $v_1$ is an eigenvector and $v_2$ is a generalized eigenvector of rank $2$. These vectors are defined by the relations:\n$$\n(S(\\alpha) - I) v_1 = \\mathbf{0}\n$$\n$$\n(S(\\alpha) - I) v_2 = v_1\n$$\nWe need to find a vector $v_2$ that is not an eigenvector itself, but whose image under the transformation $(S(\\alpha)-I)$ is an eigenvector. A generalized eigenvector $v_2$ belongs to the null space of $(S(\\alpha)-I)^2$ but not to the null space of $(S(\\alpha)-I)$.\nFirst, we compute $(S(\\alpha)-I)^2$:\n$$\n(S(\\alpha)-I)^2 = \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nSince $(S(\\alpha)-I)^2$ is the zero matrix, its null space is the entire space $\\mathbb{R}^2$. We can choose any vector $v_2$ that is not an eigenvector (i.e., not a multiple of $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$). A simple choice is $v_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\nNow, we find $v_1$ using the chain definition:\n$$\nv_1 = (S(\\alpha) - I) v_2 = \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}\n$$\nThis vector $v_1 = \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}$ is indeed a valid eigenvector, as it is a non-zero multiple of $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\nThe chain of generalized eigenvectors is $\\{v_1, v_2\\} = \\left\\{ \\begin{pmatrix} \\alpha \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right\\}$.\n\nThe similarity matrix $P$ is formed by taking these chain vectors as its columns, in order:\n$$\nP = \\begin{pmatrix} v_1 & v_2 \\end{pmatrix} = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nTo verify the decomposition $S(\\alpha) = P J P^{-1}$, we first compute the inverse of $P$. Since $P$ is a diagonal matrix, its inverse is straightforward:\n$$\nP^{-1} = \\begin{pmatrix} \\frac{1}{\\alpha} & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nNow we compute the product $P J P^{-1}$:\n$$\nP J P^{-1} = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\alpha} & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nFirst, multiply $P$ and $J$:\n$$\nP J = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (\\alpha)(1) + (0)(0) & (\\alpha)(1) + (0)(1) \\\\ (0)(1) + (1)(0) & (0)(1) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} \\alpha & \\alpha \\\\ 0 & 1 \\end{pmatrix}\n$$\nNow, right-multiply by $P^{-1}$:\n$$\n(P J) P^{-1} = \\begin{pmatrix} \\alpha & \\alpha \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\alpha} & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (\\alpha)(\\frac{1}{\\alpha}) + (\\alpha)(0) & (\\alpha)(0) + (\\alpha)(1) \\\\ (0)(\\frac{1}{\\alpha}) + (1)(0) & (0)(0) + (1)(1) \\end{pmatrix} = \\begin{pmatrix} 1 & \\alpha \\\\ 0 & 1 \\end{pmatrix}\n$$\nThis resulting matrix is indeed $S(\\alpha)$, which verifies the decomposition. The spectral analysis is complete, and the Jordan normal form $J$ has been explicitly computed and verified.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 \\\\\n0 & 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from static 2D analysis to dynamic 3D data, such as head motion estimates in fMRI, introduces new challenges, chief among them the need to smoothly interpolate between orientations over time without introducing non-rigid artifacts. This advanced practice  introduces quaternions as a powerful representation for 3D rotations and explores geodesic interpolation on the unit 3-sphere ($\\mathbb{S}^{3}$). Deriving the spherical linear interpolation (slerp) formula will equip you with a principled tool for temporal smoothing, which is essential for the robust analysis of motion-corrupted time-series data.",
            "id": "4177172",
            "problem": "A common challenge in functional Magnetic Resonance Imaging (fMRI) motion correction is to temporally smooth estimated head orientations without introducing non-rigid artifacts such as scaling or shear. Consider the three-dimensional rotation group $\\mathrm{SO}(3)$ and its double cover by the unit quaternions, identified with the three-sphere $\\mathbb{S}^{3} \\subset \\mathbb{R}^{4}$. A unit quaternion $q = (q_{w}, q_{x}, q_{y}, q_{z})$ represents a rotation, and the antipodal identification $q \\sim -q$ accounts for the double cover of $\\mathrm{SO}(3)$. The intrinsic geometric notion of shortest-path interpolation on $\\mathbb{S}^{3}$ (the geodesic with respect to the standard round metric induced by the Euclidean inner product on $\\mathbb{R}^{4}$) yields a constant-speed path along a great circle connecting two unit quaternions, providing a principled way to interpolate rotations without inducing scaling or shear when converted to rotation matrices.\n\nStarting from the following foundational facts:\n- Rotations in three dimensions form the special orthogonal group $\\mathrm{SO}(3)$, and any rotation can be represented by a unit quaternion $q \\in \\mathbb{S}^{3}$ with the equivalence $q \\sim -q$.\n- The geodesics on $\\mathbb{S}^{3}$ under the standard Riemannian metric are great circles, and the shortest path between two non-antipodal points is the unique great-circle arc with constant speed.\n- The inner product in $\\mathbb{R}^{4}$, given by $\\langle q_{0}, q_{1} \\rangle = q_{0w} q_{1w} + q_{0x} q_{1x} + q_{0y} q_{1y} + q_{0z} q_{1z}$, determines the angle between unit quaternions by $\\Omega = \\arccos(\\langle q_{0}, q_{1} \\rangle)$.\n\nDerive the expression for the unique constant-speed shortest-path interpolant on $\\mathbb{S}^{3}$ between two unit quaternions $q_{0}$ and $q_{1}$, and then evaluate it in the following neuroscientific motion-correction scenario: let $q_{0} = (1, 0, 0, 0)$ (the identity rotation) and let $q_{1}$ be the unit quaternion representing a rotation by angle $\\pi/2$ radians about the $z$-axis. Compute the interpolated quaternion at fraction $t = \\frac{1}{3}$ of the path length along the shortest geodesic. Express your final answer as the quaternion components $(q_{w}, q_{x}, q_{y}, q_{z})$ in exact closed form, without numerical rounding.\n\nIn your derivation, justify why this geodesic interpolation avoids scaling and shear when applied as a rotation matrix to volumetric data, and explain briefly how such interpolation supports temporal smoothing of head motion estimates in fMRI. The final answer must be a single analytic expression for the interpolated quaternion, written as a row matrix using the $\\texttt{pmatrix}$ environment. Angles are to be treated in radians throughout.",
            "solution": "The solution process consists of four parts:\n1.  Derivation of the general formula for constant-speed shortest-path interpolation between two unit quaternions on the three-sphere $\\mathbb{S}^3$.\n2.  Justification of why this interpolation method preserves rigidity (i.e., avoids scaling and shear).\n3.  Explanation of the method's application in temporal smoothing of fMRI motion parameters.\n4.  Application of the derived formula to the specific case given in the problem.\n\n**1. Derivation of the Geodesic Interpolant (SLERP)**\n\nLet $q_0$ and $q_1$ be two distinct, non-antipodal unit quaternions in $\\mathbb{R}^4$. As vectors, they lie on the unit three-sphere, $\\mathbb{S}^3$. The shortest path between them on the sphere is the shorter arc of the great circle that passes through them. This great circle lies in the two-dimensional plane spanned by the vectors $q_0$ and $q_1$.\n\nThe angle $\\Omega$ between these two vectors is given by their inner product:\n$$ \\Omega = \\arccos(\\langle q_0, q_1 \\rangle) $$\nSince $q_0$ and $q_1$ are unit quaternions, $\\|q_0\\|=1$ and $\\|q_1\\|=1$. For the shortest path, we can ensure $\\Omega \\in [0, \\pi)$ by replacing $q_1$ with $-q_1$ if $\\langle q_0, q_1 \\rangle < 0$, since $q_1$ and $-q_1$ represent the same rotation. We assume this has been done, so $\\Omega \\in [0, \\pi/2]$.\n\nAny point $q(t)$ on the great circle arc can be expressed as a linear combination of an orthonormal basis for the plane containing the arc. We can choose $q_0$ as the first basis vector. The second basis vector, which we will call $u$, must be a unit vector in the plane spanned by $\\{q_0, q_1\\}$ and orthogonal to $q_0$. We can construct such a vector using the Gram-Schmidt process. Let $v = q_1 - \\langle q_1, q_0 \\rangle q_0$. This vector $v$ is orthogonal to $q_0$. Its squared norm is:\n$$ \\|v\\|^2 = \\langle q_1 - \\langle q_1, q_0 \\rangle q_0, q_1 - \\langle q_1, q_0 \\rangle q_0 \\rangle = \\|q_1\\|^2 - 2\\langle q_1, q_0 \\rangle^2 + \\langle q_1, q_0 \\rangle^2 \\|q_0\\|^2 $$\nSince $\\|q_0\\|=\\|q_1\\|=1$ and $\\langle q_0, q_1 \\rangle = \\cos(\\Omega)$, we have:\n$$ \\|v\\|^2 = 1 - 2\\cos^2(\\Omega) + \\cos^2(\\Omega) = 1 - \\cos^2(\\Omega) = \\sin^2(\\Omega) $$\nThus, $\\|v\\| = \\sin(\\Omega)$ (since $\\Omega \\in [0, \\pi)$, $\\sin(\\Omega) \\ge 0$). The unit vector is $u = \\frac{v}{\\|v\\|} = \\frac{q_1 - \\cos(\\Omega)q_0}{\\sin(\\Omega)}$.\n\nThe set $\\{q_0, u\\}$ forms an orthonormal basis for the plane. A constant-speed interpolation corresponds to traversing the arc at a constant angular velocity. To reach fraction $t$ of the path from $q_0$ to $q_1$, we must traverse an angle of $t\\Omega$ from $q_0$. In the basis $\\{q_0, u\\}$, this is a simple 2D rotation:\n$$ q(t) = \\cos(t\\Omega) q_0 + \\sin(t\\Omega) u $$\nSubstituting the expression for $u$:\n$$ q(t) = \\cos(t\\Omega) q_0 + \\sin(t\\Omega) \\left( \\frac{q_1 - \\cos(\\Omega)q_0}{\\sin(\\Omega)} \\right) $$\nGrouping the terms for $q_0$ and $q_1$:\n$$ q(t) = \\left( \\cos(t\\Omega) - \\frac{\\sin(t\\Omega)\\cos(\\Omega)}{\\sin(\\Omega)} \\right) q_0 + \\left( \\frac{\\sin(t\\Omega)}{\\sin(\\Omega)} \\right) q_1 $$\nUsing the trigonometric identity $\\sin(A-B) = \\sin(A)\\cos(B) - \\cos(A)\\sin(B)$, the coefficient of $q_0$ can be simplified:\n$$ \\frac{\\sin(\\Omega)\\cos(t\\Omega) - \\cos(\\Omega)\\sin(t\\Omega)}{\\sin(\\Omega)} = \\frac{\\sin(\\Omega - t\\Omega)}{\\sin(\\Omega)} = \\frac{\\sin((1-t)\\Omega)}{\\sin(\\Omega)} $$\nThis yields the Spherical Linear Interpolation (SLERP) formula:\n$$ q(t) = \\frac{\\sin((1-t)\\Omega)}{\\sin(\\Omega)} q_0 + \\frac{\\sin(t\\Omega)}{\\sin(\\Omega)} q_1 $$\nThis formula defines the unique constant-speed shortest-path interpolant for $t \\in [0, 1]$.\n\n**2. Justification for Avoiding Scaling and Shear**\n\nA transformation matrix represents a pure rotation if and only if it belongs to the special orthogonal group $\\mathrm{SO}(3)$. These matrices are orthogonal ($R^T R = I$) with determinant $+1$. A key property is that they preserve lengths and angles, hence they are rigid-body transformations without scaling or shear.\n\nAny unit quaternion $q$ corresponds to a rotation matrix in $\\mathrm{SO}(3)$. Therefore, to show that the interpolated transformation is always a pure rotation, we only need to show that the interpolated quaternion $q(t)$ is a unit quaternion for all $t \\in [0, 1]$.\n\nUsing the expression $q(t) = \\cos(t\\Omega) q_0 + \\sin(t\\Omega) u$ and the fact that $\\{q_0, u\\}$ is an orthonormal basis, we compute the squared norm of $q(t)$:\n$$ \\|q(t)\\|^2 = \\langle \\cos(t\\Omega) q_0 + \\sin(t\\Omega) u, \\cos(t\\Omega) q_0 + \\sin(t\\Omega) u \\rangle $$\n$$ \\|q(t)\\|^2 = \\cos^2(t\\Omega) \\langle q_0, q_0 \\rangle + \\sin^2(t\\Omega) \\langle u, u \\rangle + 2\\cos(t\\Omega)\\sin(t\\Omega)\\langle q_0, u \\rangle $$\nSince $\\langle q_0, q_0 \\rangle = \\|q_0\\|^2 = 1$, $\\langle u, u \\rangle = \\|u\\|^2 = 1$, and $\\langle q_0, u \\rangle = 0$:\n$$ \\|q(t)\\|^2 = \\cos^2(t\\Omega) \\cdot 1 + \\sin^2(t\\Omega) \\cdot 1 + 0 = 1 $$\nSince $\\|q(t)\\|=1$ for all $t \\in [0, 1]$, the interpolated quaternion is always a unit quaternion. It therefore always represents a pure rotation in $\\mathrm{SO}(3)$, guaranteeing that the interpolation does not introduce non-rigid artifacts like scaling or shear.\n\n**3. Application in fMRI Motion Smoothing**\n\nIn fMRI analysis, head motion during scanning is a significant source of artifacts. Motion correction algorithms estimate the rigid-body transformation (3D rotation and 3D translation) required to align each brain volume to a reference volume. This results in a time series of rotation parameters, one for each acquired volume. This series can be noisy or contain physiologically implausible jumps, either due to estimation errors or jerky subject movements.\n\nTemporal smoothing of these parameters is desirable. However, naively filtering or averaging common rotation representations like Euler angles or rotation matrices is problematic. Euler angles suffer from gimbal lock and non-uniform representation of the rotation space. Averaging rotation matrices does not generally yield a valid rotation matrix.\n\nBy representing the rotations as unit quaternions, we move the problem to the manifold $\\mathbb{S}^3$. Smoothing or interpolation can then be performed using the intrinsic geometry of this space. SLERP provides the principled way to find an intermediate rotation between two given rotations. For temporal filtering (e.g., a moving average), this concept is extended to find the geometric mean of multiple quaternions. This process ensures the entire smoothed trajectory of head orientations consists of valid rotations, corresponding to a smooth, physically-plausible path in the space of all possible head orientations.\n\n**4. Specific Calculation**\n\nWe are asked to find the interpolated quaternion at $t = \\frac{1}{3}$ between $q_0 = (1, 0, 0, 0)$ and $q_1$, which represents a rotation by $\\theta = \\pi/2$ about the $z$-axis.\n\nFirst, we determine $q_1$. For a rotation by angle $\\theta$ about a unit axis $\\mathbf{u}=(u_x, u_y, u_z)$, the corresponding unit quaternion is $q = (\\cos(\\theta/2), u_x \\sin(\\theta/2), u_y \\sin(\\theta/2), u_z \\sin(\\theta/2))$.\nHere, $\\theta = \\pi/2$ and $\\mathbf{u}=(0, 0, 1)$. Thus, $\\theta/2 = \\pi/4$.\n$$ q_1 = (\\cos(\\pi/4), 0 \\cdot \\sin(\\pi/4), 0 \\cdot \\sin(\\pi/4), 1 \\cdot \\sin(\\pi/4)) = (\\frac{\\sqrt{2}}{2}, 0, 0, \\frac{\\sqrt{2}}{2}) $$\n\nNext, we compute the angle $\\Omega$ between $q_0$ and $q_1$:\n$$ \\langle q_0, q_1 \\rangle = (1)(\\frac{\\sqrt{2}}{2}) + (0)(0) + (0)(0) + (0)(\\frac{\\sqrt{2}}{2}) = \\frac{\\sqrt{2}}{2} $$\n$$ \\Omega = \\arccos(\\frac{\\sqrt{2}}{2}) = \\frac{\\pi}{4} $$\n\nNow, we use the SLERP formula with $t = \\frac{1}{3}$:\n$$ q(\\frac{1}{3}) = \\frac{\\sin((1-\\frac{1}{3})\\frac{\\pi}{4})}{\\sin(\\frac{\\pi}{4})} q_0 + \\frac{\\sin(\\frac{1}{3}\\frac{\\pi}{4})}{\\sin(\\frac{\\pi}{4})} q_1 $$\n$$ q(\\frac{1}{3}) = \\frac{\\sin(\\frac{2}{3} \\frac{\\pi}{4})}{\\sin(\\frac{\\pi}{4})} q_0 + \\frac{\\sin(\\frac{\\pi}{12})}{\\sin(\\frac{\\pi}{4})} q_1 = \\frac{\\sin(\\frac{\\pi}{6})}{\\sin(\\frac{\\pi}{4})} q_0 + \\frac{\\sin(\\frac{\\pi}{12})}{\\sin(\\frac{\\pi}{4})} q_1 $$\n\nWe need the values for the sine functions:\n- $\\sin(\\pi/6) = \\frac{1}{2}$\n- $\\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n- $\\sin(\\pi/12) = \\sin(15^\\circ) = \\sin(45^\\circ - 30^\\circ) = \\sin(45^\\circ)\\cos(30^\\circ) - \\cos(45^\\circ)\\sin(30^\\circ) = \\frac{\\sqrt{2}}{2}\\frac{\\sqrt{3}}{2} - \\frac{\\sqrt{2}}{2}\\frac{1}{2} = \\frac{\\sqrt{6}-\\sqrt{2}}{4}$\n\nNow compute the coefficients:\n- Coefficient for $q_0$: $\\frac{\\sin(\\pi/6)}{\\sin(\\pi/4)} = \\frac{1/2}{\\sqrt{2}/2} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}$\n- Coefficient for $q_1$: $\\frac{\\sin(\\pi/12)}{\\sin(\\pi/4)} = \\frac{(\\sqrt{6}-\\sqrt{2})/4}{\\sqrt{2}/2} = \\frac{\\sqrt{6}-\\sqrt{2}}{2\\sqrt{2}} = \\frac{\\sqrt{2}(\\sqrt{3}-1)}{2\\sqrt{2}} = \\frac{\\sqrt{3}-1}{2}$\n\nFinally, we compute the interpolated quaternion $q(\\frac{1}{3})$:\n$$ q(\\frac{1}{3}) = \\frac{\\sqrt{2}}{2} (1, 0, 0, 0) + \\frac{\\sqrt{3}-1}{2} (\\frac{\\sqrt{2}}{2}, 0, 0, \\frac{\\sqrt{2}}{2}) $$\nThe components are:\n- $q_w = \\frac{\\sqrt{2}}{2} \\cdot 1 + \\frac{\\sqrt{3}-1}{2} \\cdot \\frac{\\sqrt{2}}{2} = \\frac{\\sqrt{2}}{2} + \\frac{\\sqrt{6}-\\sqrt{2}}{4} = \\frac{2\\sqrt{2} + \\sqrt{6}-\\sqrt{2}}{4} = \\frac{\\sqrt{6}+\\sqrt{2}}{4}$\n- $q_x = \\frac{\\sqrt{2}}{2} \\cdot 0 + \\frac{\\sqrt{3}-1}{2} \\cdot 0 = 0$\n- $q_y = \\frac{\\sqrt{2}}{2} \\cdot 0 + \\frac{\\sqrt{3}-1}{2} \\cdot 0 = 0$\n- $q_z = \\frac{\\sqrt{2}}{2} \\cdot 0 + \\frac{\\sqrt{3}-1}{2} \\cdot \\frac{\\sqrt{2}}{2} = \\frac{\\sqrt{6}-\\sqrt{2}}{4}$\n\nThe interpolated quaternion is $(\\frac{\\sqrt{6}+\\sqrt{2}}{4}, 0, 0, \\frac{\\sqrt{6}-\\sqrt{2}}{4})$. This corresponds to a rotation by angle $t\\theta = \\frac{1}{3} \\frac{\\pi}{2} = \\frac{\\pi}{6}$ about the $z$-axis, as $\\cos(\\pi/12) = \\frac{\\sqrt{6}+\\sqrt{2}}{4}$ and $\\sin(\\pi/12) = \\frac{\\sqrt{6}-\\sqrt{2}}{4}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{6}+\\sqrt{2}}{4} & 0 & 0 & \\frac{\\sqrt{6}-\\sqrt{2}}{4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}