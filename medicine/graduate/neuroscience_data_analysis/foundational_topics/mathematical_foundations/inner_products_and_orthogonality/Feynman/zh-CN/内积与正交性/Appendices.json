{
    "hands_on_practices": [
        {
            "introduction": "几何中的正交投影概念不仅适用于我们熟悉的向量空间，也可以推广到函数和信号。这个练习将指导您如何将一个简单的线性函数 $f(x)=x$ 投影到一个由正弦和余弦函数张成的子空间上。这个过程本质上是傅里叶分析的核心思想，是分析神经振荡（如EEG或LFP数据）等时间序列信号的基本工具。",
            "id": "2403755",
            "problem": "在计算工程中，通常通过将信号投影到低维函数空间来近似信号。令 $f(x)=x$，$x \\in [-\\pi,\\pi]$，其中 $x$ 以弧度为单位。考虑由 $\\{\\cos(x),\\sin(x)\\}$ 张成的函数空间，其上装备了在 $[-\\pi,\\pi]$ 上平方可积函数的标准内积，定义为\n$$\n\\langle g,h\\rangle = \\int_{-\\pi}^{\\pi} g(x)\\,h(x)\\,dx.\n$$\n从内积空间的核心定义以及向量到子空间的正交投影出发，确定系数 $a$ 和 $b$，使得函数 $p(x)=a\\cos(x)+b\\sin(x)$ 是 $f(x)$ 到由 $\\{\\cos(x),\\sin(x)\\}$ 张成的空间上的正交投影。您的推导应仅依赖于内积的性质、正交性以及函数在适用情况下的奇偶性。请提供 $a$ 和 $b$ 的精确值（不要四舍五入），并以有序对 $(a,b)$ 的形式报告您的最终答案。",
            "solution": "问题是确定函数 $p(x) = a\\cos(x) + b\\sin(x)$ 的系数 $a$ 和 $b$，使得 $p(x)$ 是 $f(x) = x$ 在区间 $[-\\pi, \\pi]$ 上到由函数集 $\\{\\cos(x), \\sin(x)\\}$ 张成的子空间的正交投影。内积定义为 $\\langle g, h \\rangle = \\int_{-\\pi}^{\\pi} g(x)h(x)\\,dx$。\n\n首先对问题陈述进行验证。\n已知条件：\n1.  待投影函数：$f(x) = x$，$x \\in [-\\pi, \\pi]$。\n2.  子空间基：$\\{\\cos(x), \\sin(x)\\}$。\n3.  投影形式：$p(x) = a\\cos(x) + b\\sin(x)$。\n4.  内积：$\\langle g,h\\rangle = \\int_{-\\pi}^{\\pi} g(x)\\,h(x)\\,dx$。\n\n根据标准进行验证：\n该问题具有科学依据，是傅里叶分析和线性代数在函数空间中的标准应用。该问题是适定的，因为向量（函数）在具有确定内积的有限维子空间上的投影是唯一的。该问题是客观的，用精确的数学定义陈述，没有歧义。该问题是完整的，包含了所有必要信息。因此，问题有效，可以推导出解。\n\n一个函数 $f(x)$ 到由一组基函数 $\\{v_1(x), v_2(x), \\dots, v_n(x)\\}$ 张成的子空间上的正交投影 $p(x)$ 由 $p(x) = \\sum_{k=1}^{n} c_k v_k(x)$ 给出。如果基是正交的，则系数 $c_k$ 的计算公式为 $c_k = \\frac{\\langle f, v_k \\rangle}{\\langle v_k, v_k \\rangle}$。\n\n在我们的情况下，基函数是 $v_1(x) = \\cos(x)$ 和 $v_2(x) = \\sin(x)$。首先，我们必须验证这组基相对于给定的内积是否正交。我们计算基函数的内积：\n$$\n\\langle \\cos(x), \\sin(x) \\rangle = \\int_{-\\pi}^{\\pi} \\cos(x) \\sin(x) \\,dx\n$$\n被积函数 $\\cos(x)\\sin(x)$ 是一个奇函数，因为它是偶函数 $\\cos(x)$ 和奇函数 $\\sin(x)$ 的乘积。奇函数在对称区间如 $[-\\pi, \\pi]$ 上的积分为零。\n$$\n\\langle \\cos(x), \\sin(x) \\rangle = 0\n$$\n因此，基 $\\{\\cos(x), \\sin(x)\\}$ 是正交的。\n\n因此，投影 $p(x) = a\\cos(x) + b\\sin(x)$ 的系数 $a$ 和 $b$ 由以下公式给出：\n$$\na = \\frac{\\langle f(x), \\cos(x) \\rangle}{\\langle \\cos(x), \\cos(x) \\rangle} = \\frac{\\int_{-\\pi}^{\\pi} x \\cos(x) \\,dx}{\\int_{-\\pi}^{\\pi} \\cos^2(x) \\,dx}\n$$\n$$\nb = \\frac{\\langle f(x), \\sin(x) \\rangle}{\\langle \\sin(x), \\sin(x) \\rangle} = \\frac{\\int_{-\\pi}^{\\pi} x \\sin(x) \\,dx}{\\int_{-\\pi}^{\\pi} \\sin^2(x) \\,dx}\n$$\n\n我们计算系数 $a$ 的分子：\n$$\n\\langle f(x), \\cos(x) \\rangle = \\int_{-\\pi}^{\\pi} x \\cos(x) \\,dx\n$$\n被积函数 $x\\cos(x)$ 是一个奇函数，是奇函数 $f(x)=x$ 和偶函数 $\\cos(x)$ 的乘积。这个奇函数在对称区间 $[-\\pi, \\pi]$ 上的积分为零。\n$$\n\\int_{-\\pi}^{\\pi} x \\cos(x) \\,dx = 0\n$$\n因此，系数 $a$ 为 $0$。\n\n接下来，我们计算系数 $b$ 的分子：\n$$\n\\langle f(x), \\sin(x) \\rangle = \\int_{-\\pi}^{\\pi} x \\sin(x) \\,dx\n$$\n被积函数 $x\\sin(x)$ 是一个偶函数，因为它是两个奇函数 $f(x)=x$ 和 $\\sin(x)$ 的乘积。它在 $[-\\pi, \\pi]$ 上的积分不一定为零。我们使用分部积分法 $\\int u \\,dv = uv - \\int v \\,du$。令 $u = x$ 且 $dv = \\sin(x)dx$。则 $du = dx$ 且 $v = -\\cos(x)$。\n$$\n\\int x \\sin(x) \\,dx = x(-\\cos(x)) - \\int (-\\cos(x)) \\,dx = -x\\cos(x) + \\sin(x)\n$$\n计算定积分：\n$$\n\\int_{-\\pi}^{\\pi} x \\sin(x) \\,dx = [-x\\cos(x) + \\sin(x)]_{-\\pi}^{\\pi}\n$$\n$$\n= (-\\pi\\cos(\\pi) + \\sin(\\pi)) - (-(-\\pi)\\cos(-\\pi) + \\sin(-\\pi))\n$$\n因为 $\\cos(\\pi) = -1$，$\\cos(-\\pi) = -1$，且 $\\sin(\\pi) = \\sin(-\\pi) = 0$：\n$$\n= (-\\pi(-1) + 0) - (\\pi(-1) + 0) = \\pi - (-\\pi) = 2\\pi\n$$\n\n现在，我们必须计算分母，即基函数的范数的平方。\n对于 $\\langle \\cos(x), \\cos(x) \\rangle$：\n$$\n\\int_{-\\pi}^{\\pi} \\cos^2(x) \\,dx = \\int_{-\\pi}^{\\pi} \\frac{1 + \\cos(2x)}{2} \\,dx = \\frac{1}{2} \\left[ x + \\frac{\\sin(2x)}{2} \\right]_{-\\pi}^{\\pi}\n$$\n$$\n= \\frac{1}{2} \\left[ \\left(\\pi + \\frac{\\sin(2\\pi)}{2}\\right) - \\left(-\\pi + \\frac{\\sin(-2\\pi)}{2}\\right) \\right] = \\frac{1}{2} (\\pi - (-\\pi)) = \\pi\n$$\n对于 $\\langle \\sin(x), \\sin(x) \\rangle$：\n$$\n\\int_{-\\pi}^{\\pi} \\sin^2(x) \\,dx = \\int_{-\\pi}^{\\pi} \\frac{1 - \\cos(2x)}{2} \\,dx = \\frac{1}{2} \\left[ x - \\frac{\\sin(2x)}{2} \\right]_{-\\pi}^{\\pi}\n$$\n$$\n= \\frac{1}{2} \\left[ \\left(\\pi - \\frac{\\sin(2\\pi)}{2}\\right) - \\left(-\\pi - \\frac{\\sin(-2\\pi)}{2}\\right) \\right] = \\frac{1}{2} (\\pi - (-\\pi)) = \\pi\n$$\n\n最后，我们组合系数 $a$ 和 $b$：\n$$\na = \\frac{0}{\\pi} = 0\n$$\n$$\nb = \\frac{2\\pi}{\\pi} = 2\n$$\n系数为 $a=0$ 和 $b=2$。问题要求有序对 $(a,b)$。",
            "answer": "$$\n\\boxed{(0, 2)}\n$$"
        },
        {
            "introduction": "在处理真实的神经科学数据时，我们必须认识到并非所有测量都同等可靠，噪声的存在会影响我们的分析。本练习引入了加权内积的概念，它通过考虑数据的噪声协方差来调整空间的几何结构。您将在这个加权空间中对fMRI实验的设计矩阵进行格拉姆-施密特（Gram-Schmidt）正交化，并由此发现正交化如何极大地简化回归系数的计算，揭示其在通用线性模型（GLM）分析中的实用价值。",
            "id": "4170518",
            "problem": "一个具有四个重复时间的短块设计功能性磁共振成像 (fMRI) 时间序列，通过广义线性模型 (GLM) 进行建模。其中，观测到的血氧水平依赖 (BOLD) 信号表示为描述任务事件的三个回归量和一个无关效应的线性组合。设回归量为列向量\n$$\n\\mathbf{r}_{1} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad\n\\mathbf{r}_{2} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{r}_{3} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix}.\n$$\n经验上发现，神经噪声在时间上是独立的但具有异方差性，其协方差矩阵为\n$$\n\\mathbf{C} = \\operatorname{diag}(1, 2, 2, 1).\n$$\n考虑由 $\\mathbf{C}^{-1}$ 诱导的加权内积，\n$$\n\\langle \\mathbf{u}, \\mathbf{v} \\rangle_{\\mathbf{C}} = \\mathbf{u}^{\\top} \\mathbf{C}^{-1} \\mathbf{v},\n$$\n该内积是正定的，因此在 $\\mathbb{R}^{4}$ 上定义了一个有效的内积。该区块观测到的 BOLD 向量为\n$$\n\\mathbf{y} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n\n仅使用内积、正交投影和内积空间上的格拉姆-施密特标准正交化的核心定义，完成以下任务：\n\n1. 对集合 $\\{\\mathbf{r}_{1}, \\mathbf{r}_{2}, \\mathbf{r}_{3}\\}$ 关于内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 进行格拉姆-施密特标准正交化，以产生一个张成相同子空间的标准正交集 $\\{\\mathbf{q}_{1}, \\mathbf{q}_{2}, \\mathbf{q}_{3}\\}$。\n2. 从协方差为 $\\mathbf{C}$ 的 GLM 的加权最小二乘目标的定义出发，推导为什么当设计列在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下是标准正交时，系数估计值可以直接通过与 $\\mathbf{y}$ 的内积得到。\n3. 对于观测数据 $\\mathbf{y}$，计算与标准正交设计 $\\mathbf{Q} = [\\mathbf{q}_{1}\\ \\mathbf{q}_{2}\\ \\mathbf{q}_{3}]$ 对应的系数向量。\n\n将最终的系数向量以精确值的形式表示为单个行向量。无需四舍五入，最终表达式中不应包含任何物理单位。",
            "solution": "我们首先回顾基本定义。给定一个对称正定矩阵 $\\mathbf{C}$，双线性形式 $\\langle \\mathbf{u}, \\mathbf{v} \\rangle_{\\mathbf{C}} = \\mathbf{u}^{\\top} \\mathbf{C}^{-1} \\mathbf{v}$ 在 $\\mathbb{R}^{n}$ 上定义了一个内积，其范数为 $\\|\\mathbf{u}\\|_{\\mathbf{C}} = \\sqrt{\\langle \\mathbf{u}, \\mathbf{u} \\rangle_{\\mathbf{C}}}$。关于此内积的子空间正交投影的特点是在范数 $\\|\\cdot\\|_{\\mathbf{C}}$ 下最小化残差的范数平方。\n\n内积空间中的格拉姆-施密特过程如下：对于一组线性无关的向量 $\\{\\mathbf{r}_{1}, \\mathbf{r}_{2}, \\mathbf{r}_{3}\\}$，定义\n$$\n\\mathbf{q}_{1} = \\frac{\\mathbf{r}_{1}}{\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}}}, \\quad\n\\mathbf{u}_{2} = \\mathbf{r}_{2} - \\langle \\mathbf{r}_{2}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\mathbf{q}_{1}, \\quad\n\\mathbf{q}_{2} = \\frac{\\mathbf{u}_{2}}{\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}}}, \\quad\n\\mathbf{u}_{3} = \\mathbf{r}_{3} - \\langle \\mathbf{r}_{3}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\mathbf{q}_{1} - \\langle \\mathbf{r}_{3}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} \\mathbf{q}_{2}, \\quad\n\\mathbf{q}_{3} = \\frac{\\mathbf{u}_{3}}{\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}}}.\n$$\n这就在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下产生了一个标准正交集 $\\{\\mathbf{q}_{1}, \\mathbf{q}_{2}, \\mathbf{q}_{3}\\}$。\n\n我们一步步地计算。首先，注意到\n$$\n\\mathbf{C}^{-1} = \\operatorname{diag}\\!\\left(1, \\frac{1}{2}, \\frac{1}{2}, 1\\right).\n$$\n计算 $\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}}^{2}$：\n$$\n\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}}^{2} = \\mathbf{r}_{1}^{\\top} \\mathbf{C}^{-1} \\mathbf{r}_{1} = 1 \\cdot 1 \\cdot 1 + 2 \\cdot 2 \\cdot \\frac{1}{2} + 0 \\cdot 0 \\cdot \\frac{1}{2} + 1 \\cdot 1 \\cdot 1 = 1 + 2 + 0 + 1 = 4.\n$$\n因此 $\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}} = 2$ 且\n$$\n\\mathbf{q}_{1} = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix}.\n$$\n接下来，\n$$\n\\langle \\mathbf{r}_{2}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} = \\mathbf{r}_{2}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{1} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}^{\\top} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = \\frac{1}{2}.\n$$\n因此\n$$\n\\mathbf{u}_{2} = \\mathbf{r}_{2} - \\frac{1}{2} \\mathbf{q}_{1} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{4} \\\\ \\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{4} \\end{pmatrix}.\n$$\n计算其范数：\n$$\n\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}}^{2} = \\left(-\\frac{1}{4}\\right)^{2} \\cdot 1 + \\left(\\frac{1}{2}\\right)^{2} \\cdot \\frac{1}{2} + 1^{2} \\cdot \\frac{1}{2} + \\left(-\\frac{1}{4}\\right)^{2} \\cdot 1 = \\frac{1}{16} + \\frac{1}{8} + \\frac{1}{2} + \\frac{1}{16} = \\frac{3}{4}.\n$$\n从而 $\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}} = \\frac{\\sqrt{3}}{2}$ 且\n$$\n\\mathbf{q}_{2} = \\frac{\\mathbf{u}_{2}}{\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}}} = \\frac{2}{\\sqrt{3}} \\begin{pmatrix} -\\frac{1}{4} \\\\ \\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2 \\sqrt{3}} \\\\ \\frac{1}{\\sqrt{3}} \\\\ \\frac{2}{\\sqrt{3}} \\\\ -\\frac{1}{2 \\sqrt{3}} \\end{pmatrix}.\n$$\n继续处理 $\\mathbf{r}_{3}$。首先，\n$$\n\\langle \\mathbf{r}_{3}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} = \\mathbf{r}_{3}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix}^{\\top} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = 1,\n$$\n所以\n$$\n\\mathbf{v} = \\mathbf{r}_{3} - \\langle \\mathbf{r}_{3}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\mathbf{q}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -1 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}.\n$$\n检查剩余的投影系数：\n$$\n\\langle \\mathbf{v}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} = \\mathbf{v}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{2} = \\begin{pmatrix} \\frac{1}{2} \\\\ -1 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}^{\\top} \\begin{pmatrix} -\\frac{1}{2 \\sqrt{3}} \\\\ \\frac{1}{2 \\sqrt{3}} \\\\ \\frac{1}{\\sqrt{3}} \\\\ -\\frac{1}{2 \\sqrt{3}} \\end{pmatrix} = 0.\n$$\n因此 $\\mathbf{u}_{3} = \\mathbf{v}$。其范数为\n$$\n\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}}^{2} = \\left(\\frac{1}{2}\\right)^{2} \\cdot 1 + (-1)^{2} \\cdot \\frac{1}{2} + 1^{2} \\cdot \\frac{1}{2} + \\left(\\frac{1}{2}\\right)^{2} \\cdot 1 = \\frac{1}{4} + \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{4} = \\frac{3}{2},\n$$\n所以 $\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}} = \\sqrt{\\frac{3}{2}}$ 且\n$$\n\\mathbf{q}_{3} = \\frac{\\mathbf{u}_{3}}{\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}}} = \\sqrt{\\frac{2}{3}} \\begin{pmatrix} \\frac{1}{2} \\\\ -1 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\\\ -\\sqrt{\\frac{2}{3}} \\\\ \\sqrt{\\frac{2}{3}} \\\\ \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\end{pmatrix}.\n$$\n根据构造，$\\{\\mathbf{q}_{1}, \\mathbf{q}_{2}, \\mathbf{q}_{3}\\}$ 在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下是标准正交的。\n\n我们现在来论证系数简化的合理性。对于协方差为 $\\mathbf{C}$ 的 GLM，其加权最小二乘 (WLS) 准则是最小化\n$$\nJ(\\boldsymbol{\\beta}) = \\|\\mathbf{y} - \\mathbf{X} \\boldsymbol{\\beta}\\|_{\\mathbf{C}}^{2} = (\\mathbf{y} - \\mathbf{X} \\boldsymbol{\\beta})^{\\top} \\mathbf{C}^{-1} (\\mathbf{y} - \\mathbf{X} \\boldsymbol{\\beta}),\n$$\n其中 $\\mathbf{X} = [\\mathbf{r}_{1}\\ \\mathbf{r}_{2}\\ \\mathbf{r}_{3}]$。设 $\\mathbf{Q} = [\\mathbf{q}_{1}\\ \\mathbf{q}_{2}\\ \\mathbf{q}_{3}]$ 是在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下同一列空间的标准正交基。该张成空间中的任何向量都可以唯一地表示为 $\\sum_{i=1}^{3} \\alpha_{i} \\mathbf{q}_{i}$，而 $\\mathbf{y}$ 在该张成空间上的正交投影为\n$$\n\\mathbf{P}_{\\mathcal{S}} \\mathbf{y} = \\sum_{i=1}^{3} \\langle \\mathbf{y}, \\mathbf{q}_{i} \\rangle_{\\mathbf{C}} \\mathbf{q}_{i},\n$$\n因为标准正交性意味着坐标 $\\alpha_{i}$ 恰好是内积 $\\langle \\mathbf{y}, \\mathbf{q}_{i} \\rangle_{\\mathbf{C}}$。因此，当设计列在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下是标准正交时，在 $\\mathbf{Q}$ 基下的系数向量为\n$$\n\\boldsymbol{\\beta}_{\\mathbf{Q}} = \\begin{pmatrix} \\langle \\mathbf{y}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\\\ \\langle \\mathbf{y}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} \\\\ \\langle \\mathbf{y}, \\mathbf{q}_{3} \\rangle_{\\mathbf{C}} \\end{pmatrix}.\n$$\n\n我们现在显式地计算这些内积。首先，\n$$\n\\langle \\mathbf{y}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} = \\mathbf{y}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{1} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}^{\\top} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = 2 \\cdot \\frac{1}{2} + 1 \\cdot \\frac{1}{2} + 0 \\cdot 0 + 1 \\cdot \\frac{1}{2} = 2.\n$$\n其次，\n$$\n\\langle \\mathbf{y}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} = \\mathbf{y}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{2} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}^{\\top} \\begin{pmatrix} -\\frac{1}{2 \\sqrt{3}} \\\\ \\frac{1}{2 \\sqrt{3}} \\\\ \\frac{1}{\\sqrt{3}} \\\\ -\\frac{1}{2 \\sqrt{3}} \\end{pmatrix} = -\\frac{1}{\\sqrt{3}} + \\frac{1}{2 \\sqrt{3}} + 0 - \\frac{1}{2 \\sqrt{3}} = -\\frac{1}{\\sqrt{3}}.\n$$\n第三，\n$$\n\\langle \\mathbf{y}, \\mathbf{q}_{3} \\rangle_{\\mathbf{C}} = \\mathbf{y}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{3} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}^{\\top} \\begin{pmatrix} \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\\\ -\\frac{1}{2} \\sqrt{\\frac{2}{3}} \\\\ \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\\\ \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\end{pmatrix} = \\sqrt{\\frac{2}{3}} \\left(1 - \\frac{1}{2} + 0 + \\frac{1}{2}\\right) = \\sqrt{\\frac{2}{3}}.\n$$\n\n因此，对于标准正交设计 $\\mathbf{Q}$ 的系数向量是\n$$\n\\boldsymbol{\\beta}_{\\mathbf{Q}} = \\begin{pmatrix} 2  -\\frac{1}{\\sqrt{3}}  \\sqrt{\\frac{2}{3}} \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 2  -\\frac{1}{\\sqrt{3}}  \\sqrt{\\frac{2}{3}} \\end{pmatrix}}$$"
        },
        {
            "introduction": "选择正确的内积对于从神经数据中得出准确的科学结论至关重要，错误的几何视角可能导致误导性的解释。这个练习通过一个神经群体反应的例子，鲜明地对比了标准欧几里得内积和马氏（Mahalanobis）内积的分析结果。通过亲手计算，您将理解为什么在存在结构性噪声时，马氏内积能够揭示神经表征之间真实的几何关系，而欧几里得内积则可能掩盖真相。",
            "id": "4170532",
            "problem": "一位系统神经科学家正在比较一个小神经元集群中，两种条件下与刺激锁定的群体响应方向。每种条件由2个同时记录的神经元的试验平均响应向量来概括：条件 $A$ 的平均向量为 $\\mathbf{r}_{A} = \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix}$；条件 $B$ 的平均向量为 $\\mathbf{r}_{B} = \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix}$。在多次试验中，残差变异性（噪声）可以很好地近似为零均值高斯分布，其协方差矩阵为 $\\mathbf{S} = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}$，该矩阵是使用多次重复独立于均值进行估计的。\n\n分析师希望量化由 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 张成的一维子空间之间的对齐程度。他们首先使用欧几里得内积，然后使用由逆协方差矩阵导出的马哈拉诺比斯内积来校正分析。\n\n仅使用以下标准基础：\n- $\\mathbb{R}^{n}$ 上的内积是一个双线性、对称、正定的映射 $\\langle \\cdot, \\cdot \\rangle$。它导出一个范数 $\\|\\mathbf{x}\\| = \\sqrt{\\langle \\mathbf{x}, \\mathbf{x} \\rangle}$。\n- 在内积空间中，两个非零向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 之间的夹角 $\\theta$ 定义为 $\\cos(\\theta) = \\dfrac{\\langle \\mathbf{x}, \\mathbf{y} \\rangle}{\\|\\mathbf{x}\\| \\, \\|\\mathbf{y}\\|}$。\n- 欧几里得内积是 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{E}} = \\mathbf{x}^{\\top} \\mathbf{y}$。\n- 给定一个对称正定矩阵 $\\mathbf{S}$，马哈拉诺比斯内积是 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{M}} = \\mathbf{x}^{\\top} \\mathbf{S}^{-1} \\mathbf{y}$。\n\n任务：\n1. 使用 $\\langle \\cdot, \\cdot \\rangle_{\\mathrm{E}}$，计算 $\\cos(\\theta_{\\mathrm{E}})$ 以及 $\\operatorname{span}(\\mathbf{r}_{A})$ 和 $\\operatorname{span}(\\mathbf{r}_{B})$ 之间的对应夹角 $\\theta_{\\mathrm{E}}$。\n2. 使用由 $\\mathbf{S}$ 导出的 $\\langle \\cdot, \\cdot \\rangle_{\\mathrm{M}}$，计算 $\\cos(\\theta_{\\mathrm{M}})$ 以及 $\\operatorname{span}(\\mathbf{r}_{A})$ 和 $\\operatorname{span}(\\mathbf{r}_{B})$ 之间的对应夹角 $\\theta_{\\mathrm{M}}$。\n\n解释为什么在这种情况下欧几里得内积可能具有误导性，以及马哈拉诺比斯内积如何在子空间对齐方面校正分析。以弧度表示最终报告的夹角。\n\n最终答案仅报告校正后的主夹角 $\\theta_{\\mathrm{M}}$（以弧度为单位）。如果存在精确值，请勿四舍五入。",
            "solution": "该问题经评估有效。所有提供的数据和定义都是自洽的，在神经数据分析和线性代数的背景下具有科学依据，并且是良构的。该问题客观，没有模糊、矛盾或不成立的前提。该任务是将定义的数学概念直接应用于系统神经科学中的一个现实场景。\n\n我们被给予以下信息：\n条件A的平均响应向量：$\\mathbf{r}_{A} = \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix}$\n条件B的平均响应向量：$\\mathbf{r}_{B} = \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix}$\n噪声协方差矩阵：$\\mathbf{S} = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}$\n\n问题要求我们使用两种不同的内积来计算由 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 张成的子空间之间的夹角，并解释结果。两个向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 之间的夹角 $\\theta$ 由 $\\cos(\\theta) = \\frac{\\langle \\mathbf{x}, \\mathbf{y} \\rangle}{\\|\\mathbf{x}\\| \\, \\|\\mathbf{y}\\|}$ 给出。\n\n任务1：使用欧几里得内积 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{E}} = \\mathbf{x}^{\\top} \\mathbf{y}$ 计算夹角。\n\n首先，我们计算 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的内积：\n$$ \\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{E}} = \\mathbf{r}_{A}^{\\top} \\mathbf{r}_{B} = \\begin{pmatrix} 10 & 1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} = (10)(10) + (1)(-1) = 100 - 1 = 99 $$\n\n接下来，我们计算 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的欧几里得范数：\n$$ \\|\\mathbf{r}_{A}\\|_{\\mathrm{E}}^2 = \\langle \\mathbf{r}_{A}, \\mathbf{r}_{A} \\rangle_{\\mathrm{E}} = (10)^2 + (1)^2 = 100 + 1 = 101 $$\n$$ \\|\\mathbf{r}_{B}\\|_{\\mathrm{E}}^2 = \\langle \\mathbf{r}_{B}, \\mathbf{r}_{B} \\rangle_{\\mathrm{E}} = (10)^2 + (-1)^2 = 100 + 1 = 101 $$\n范数分别为 $\\|\\mathbf{r}_{A}\\|_{\\mathrm{E}} = \\sqrt{101}$ 和 $\\|\\mathbf{r}_{B}\\|_{\\mathrm{E}} = \\sqrt{101}$。\n\n现在，我们可以计算 $\\cos(\\theta_{\\mathrm{E}})$：\n$$ \\cos(\\theta_{\\mathrm{E}}) = \\frac{\\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{E}}}{\\|\\mathbf{r}_{A}\\|_{\\mathrm{E}} \\, \\|\\mathbf{r}_{B}\\|_{\\mathrm{E}}} = \\frac{99}{\\sqrt{101} \\sqrt{101}} = \\frac{99}{101} $$\n夹角为 $\\theta_{\\mathrm{E}} = \\arccos\\left(\\frac{99}{101}\\right)$。由于 $\\frac{99}{101}$ 非常接近 $1$，这是一个很小的夹角，表明向量是高度对齐的。数值上，这大约是 $0.1987$ 弧度或 $11.4$ 度。\n\n任务2：使用马哈拉诺比斯内积 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{M}} = \\mathbf{x}^{\\top} \\mathbf{S}^{-1} \\mathbf{y}$ 计算夹角。\n\n首先，我们必须求协方差矩阵 $\\mathbf{S}$ 的逆矩阵。由于 $\\mathbf{S}$ 是一个对角矩阵，其逆矩阵是对角线元素取倒数后得到的矩阵：\n$$ \\mathbf{S}^{-1} = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} $$\n\n现在，我们计算 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的马哈拉诺比斯内积：\n$$ \\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{M}} = \\mathbf{r}_{A}^{\\top} \\mathbf{S}^{-1} \\mathbf{r}_{B} = \\begin{pmatrix} 10 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} 10 & 1 \\end{pmatrix} \\begin{pmatrix} (10) \\cdot \\frac{1}{100} \\\\ (-1) \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 10 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{10} \\\\ -1 \\end{pmatrix} = (10)\\left(\\frac{1}{10}\\right) + (1)(-1) = 1 - 1 = 0 $$\n由于马哈拉诺比斯内积为 $0$，这些向量关于该内积是正交的。\n\n我们可以不计算范数就直接计算 $\\cos(\\theta_{\\mathrm{M}})$ 的对应值，但为了完整起见，我们还是计算一下范数：\n$$ \\|\\mathbf{r}_{A}\\|_{\\mathrm{M}}^2 = \\langle \\mathbf{r}_{A}, \\mathbf{r}_{A} \\rangle_{\\mathrm{M}} = \\mathbf{r}_{A}^{\\top} \\mathbf{S}^{-1} \\mathbf{r}_{A} = \\begin{pmatrix} 10 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix} = (10)^2\\left(\\frac{1}{100}\\right) + (1)^2(1) = 1 + 1 = 2 $$\n$$ \\|\\mathbf{r}_{B}\\|_{\\mathrm{M}}^2 = \\langle \\mathbf{r}_{B}, \\mathbf{r}_{B} \\rangle_{\\mathrm{M}} = \\mathbf{r}_{B}^{\\top} \\mathbf{S}^{-1} \\mathbf{r}_{B} = \\begin{pmatrix} 10 & -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} = (10)^2\\left(\\frac{1}{100}\\right) + (-1)^2(1) = 1 + 1 = 2 $$\n所以，$\\|\\mathbf{r}_{A}\\|_{\\mathrm{M}} = \\sqrt{2}$ 且 $\\|\\mathbf{r}_{B}\\|_{\\mathrm{M}} = \\sqrt{2}$。\n\n那么，$\\cos(\\theta_{\\mathrm{M}})$ 是：\n$$ \\cos(\\theta_{\\mathrm{M}}) = \\frac{\\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{M}}}{\\|\\mathbf{r}_{A}\\|_{\\mathrm{M}} \\, \\|\\mathbf{r}_{B}\\|_{\\mathrm{M}}} = \\frac{0}{\\sqrt{2} \\sqrt{2}} = 0 $$\n夹角为 $\\theta_{\\mathrm{M}} = \\arccos(0) = \\frac{\\pi}{2}$ 弧度。\n\n对差异的解释：\n\n欧几里得内积将 $\\mathbb{R}^2$ 中的所有坐标轴视为同等重要。在这种情况下，两个向量在第一个坐标轴上都有一个值为10的大的相同分量。这个大的共同分量在点积计算中占主导地位，导致其值为99，非常接近范数之积（101）。因此，夹角 $\\theta_{\\mathrm{E}}$ 很小，给人一种条件 $A$ 和 $B$ 的神经响应方向几乎相同的误导性印象。\n\n然而，问题的背景至关重要。协方差矩阵 $\\mathbf{S}$ 告诉我们，神经活动在第一个轴上变化极大（方差 $\\sigma_1^2 = 100$），而在第二个轴上非常稳定（方差 $\\sigma_2^2 = 1$）。高噪声轴上的大信号分量在统计上不如低噪声轴上的小信号分量可靠。因此，原始向量空间的欧几里得几何结构是对神经编码功能几何的不良表示。\n\n马哈拉诺比斯内积通过重新缩放空间来校正这一点。它给予高方差方向较小的权重，给予低方差方向较大的权重。这相当于将向量变换到一个噪声是各向同性（在所有方向上均匀）的“白化”空间中。该变换为 $\\mathbf{r} \\to \\mathbf{S}^{-1/2}\\mathbf{r}$。在我们的例子中，$\\mathbf{S}^{-1/2} = \\begin{pmatrix} 1/10 & 0 \\\\ 0 & 1 \\end{pmatrix}$。应用此变换得到：\n$$ \\mathbf{r}'_{A} = \\mathbf{S}^{-1/2}\\mathbf{r}_{A} = \\begin{pmatrix} 1/10 & 0 \\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n$$ \\mathbf{r}'_{B} = \\mathbf{S}^{-1/2}\\mathbf{r}_{B} = \\begin{pmatrix} 1/10 & 0 \\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n在这个统计白化空间中，$\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的马哈拉诺比斯内积等于 $\\mathbf{r}'_{A}$ 和 $\\mathbf{r}'_{B}$ 的欧几里得内积：$\\langle \\mathbf{r}'_A, \\mathbf{r}'_B \\rangle_E = 1 \\cdot 1 + 1 \\cdot (-1) = 0$。向量 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 显然是正交的。\n\n马哈拉诺比斯分析揭示，在考虑了各向异性噪声结构后，一维子空间 $\\operatorname{span}(\\mathbf{r}_{A})$ 和 $\\operatorname{span}(\\mathbf{r}_{B})$ 是正交的。表面上的对齐是在一个非常嘈杂的维度上存在大的共同信号所造成的伪影。两种条件下真正的、有区分性的信号存在于统计上独立的方向上。校正后的夹角 $\\theta_{\\mathrm{M}} = \\frac{\\pi}{2}$ 恰当地反映了这种功能性正交。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{2}}\n$$"
        }
    ]
}