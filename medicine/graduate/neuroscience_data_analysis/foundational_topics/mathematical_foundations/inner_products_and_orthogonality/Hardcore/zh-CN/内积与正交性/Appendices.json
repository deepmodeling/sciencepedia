{
    "hands_on_practices": [
        {
            "introduction": "正交投影是数据分析中的一个基本概念，它让我们能够将一个复杂的信号分解为更简单、更易于解释的分量。第一个练习  为这项核心技能提供了具体的实践。通过在一个标准的欧几里得空间中计算一个向量在子空间上的投影，你将为解决神经科学中更抽象和更具应用性的问题打下坚实的计算基础。",
            "id": "2403749",
            "problem": "在一个具有$4$个自由度（degrees of freedom, DOF）的计算结构模型中，考虑配备了标准欧几里得内积 $\\langle x,y\\rangle = x^{\\mathsf{T}} y$ 的标准欧几里得空间 $\\mathbb{R}^{4}$。设力向量为 $v = \\begin{pmatrix}1 \\\\ 2 \\\\ 3 \\\\ 4\\end{pmatrix}$，并考虑两个振型 $u_{1} = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0\\end{pmatrix}$ 和 $u_{2} = \\begin{pmatrix}0 \\\\ 1 \\\\ 1 \\\\ 0\\end{pmatrix}$。请确定向量 $v$ 在由 $u_{1}$ 和 $u_{2}$ 所张成的子空间 $S \\subset \\mathbb{R}^{4}$ 上关于标准欧几里得内积的正交投影。\n\n请将您的答案以列向量的形式给出，其分量为精确的有理数。无需四舍五入。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 向量空间为标准欧几里得空间 $\\mathbb{R}^{4}$。\n- 内积为标准欧几里得内积，定义为 $\\langle x,y\\rangle = x^{\\mathsf{T}} y$。\n- 待投影的向量为 $v = \\begin{pmatrix}1 \\\\ 2 \\\\ 3 \\\\ 4\\end{pmatrix}$。\n- 子空间 $S$ 由向量 $u_{1} = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0\\end{pmatrix}$ 和 $u_{2} = \\begin{pmatrix}0 \\\\ 1 \\\\ 1 \\\\ 0\\end{pmatrix}$ 张成。\n- 任务是求向量 $v$ 在子空间 $S$ 上的正交投影。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是线性代数中的一个标准练习，具体涉及内积空间中的正交投影。所提供的背景（计算结构模型、自由度、力向量、振型）是这些数学概念在工程中的一个有效应用。该问题在科学上和数学上都是合理的。\n- **适定性**：该问题是适定的。向量 $u_1$ 和 $u_2$ 是线性无关的，因此构成二维子空间 $S$ 的一个有效基。一个向量在有限维子空间上的正交投影是一个具有唯一解的良定义运算。\n- **客观性**：问题使用精确、无歧义的数学术语进行陈述。\n\n**步骤 3：结论与行动**\n问题是有效的。将提供解答。\n\n目标是求向量 $v$ 在子空间 $S = \\text{span}\\{u_1, u_2\\}$ 上的正交投影。设该投影为 $p$。根据定义，投影 $p$ 是 $S$ 中唯一的向量，使得误差向量 $e = v - p$ 与子空间 $S$ 正交。如果 $e$ 与 $S$ 的一个基中的每个向量都正交，则该正交条件得到满足。因此，我们必须有：\n$$\n\\langle v - p, u_1 \\rangle = 0\n$$\n$$\n\\langle v - p, u_2 \\rangle = 0\n$$\n由于 $p$ 在 $S$ 中，它可以表示为基向量 $u_1$ 和 $u_2$ 的线性组合：\n$$\np = c_1 u_1 + c_2 u_2\n$$\n其中 $c_1$ 和 $c_2$ 为标量系数。将 $p$ 的这个表达式代入正交条件，得到：\n$$\n\\langle v - (c_1 u_1 + c_2 u_2), u_1 \\rangle = \\langle v, u_1 \\rangle - c_1 \\langle u_1, u_1 \\rangle - c_2 \\langle u_2, u_1 \\rangle = 0\n$$\n$$\n\\langle v - (c_1 u_1 + c_2 u_2), u_2 \\rangle = \\langle v, u_2 \\rangle - c_1 \\langle u_1, u_2 \\rangle - c_2 \\langle u_2, u_2 \\rangle = 0\n$$\n这就形成了一个关于系数 $c_1$ 和 $c_2$ 的线性方程组，称为正规方程：\n$$\n\\begin{pmatrix} \\langle u_1, u_1 \\rangle  \\langle u_1, u_2 \\rangle \\\\ \\langle u_2, u_1 \\rangle  \\langle u_2, u_2 \\rangle \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} \\langle v, u_1 \\rangle \\\\ \\langle v, u_2 \\rangle \\end{pmatrix}\n$$\n现在我们使用给定的向量计算所需的内积：\n$v = \\begin{pmatrix}1 \\\\ 2 \\\\ 3 \\\\ 4\\end{pmatrix}$， $u_{1} = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0\\end{pmatrix}$， $u_{2} = \\begin{pmatrix}0 \\\\ 1 \\\\ 1 \\\\ 0\\end{pmatrix}$。\n\n左侧格拉姆矩阵（Gram matrix）的内积为：\n$$\n\\langle u_1, u_1 \\rangle = 1^2 + 1^2 + 0^2 + 0^2 = 2\n$$\n$$\n\\langle u_2, u_2 \\rangle = 0^2 + 1^2 + 1^2 + 0^2 = 2\n$$\n$$\n\\langle u_1, u_2 \\rangle = \\langle u_2, u_1 \\rangle = (1)(0) + (1)(1) + (0)(1) + (0)(0) = 1\n$$\n右侧向量的内积为：\n$$\n\\langle v, u_1 \\rangle = (1)(1) + (2)(1) + (3)(0) + (4)(0) = 3\n$$\n$$\n\\langle v, u_2 \\rangle = (1)(0) + (2)(1) + (3)(1) + (4)(0) = 5\n$$\n代入这些值，正规方程变为：\n$$\n\\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix}\n$$\n我们求解这个关于 $c_1$ 和 $c_2$ 的方程组。该 $2 \\times 2$ 矩阵的行列式为 $(2)(2) - (1)(1) = 3$。矩阵的逆为：\n$$\n\\frac{1}{3} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n求解系数：\n$$\n\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} (2)(3) + (-1)(5) \\\\ (-1)(3) + (2)(5) \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 6 - 5 \\\\ -3 + 10 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 1 \\\\ 7 \\end{pmatrix}\n$$\n因此，系数为 $c_1 = \\frac{1}{3}$ 和 $c_2 = \\frac{7}{3}$。\n\n最后，将这些系数代回 $p$ 的表达式中，计算正交投影 $p$：\n$$\np = c_1 u_1 + c_2 u_2 = \\frac{1}{3} u_1 + \\frac{7}{3} u_2\n$$\n$$\np = \\frac{1}{3} \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0\\end{pmatrix} + \\frac{7}{3} \\begin{pmatrix}0 \\\\ 1 \\\\ 1 \\\\ 0\\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\frac{7}{3} \\\\ \\frac{7}{3} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} + \\frac{7}{3} \\\\ \\frac{7}{3} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{8}{3} \\\\ \\frac{7}{3} \\\\ 0 \\end{pmatrix}\n$$\n为了验证结果的正确性，可以检查误差向量 $e = v - p$ 是否与 $u_1$ 和 $u_2$ 都正交。\n$$\ne = v - p = \\begin{pmatrix}1 \\\\ 2 \\\\ 3 \\\\ 4\\end{pmatrix} - \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{8}{3} \\\\ \\frac{7}{3} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\\\ 4 \\end{pmatrix}\n$$\n$$\n\\langle e, u_1 \\rangle = (\\frac{2}{3})(1) + (-\\frac{2}{3})(1) + (\\frac{2}{3})(0) + (4)(0) = \\frac{2}{3} - \\frac{2}{3} = 0\n$$\n$$\n\\langle e, u_2 \\rangle = (\\frac{2}{3})(0) + (-\\frac{2}{3})(1) + (\\frac{2}{3})(1) + (4)(0) = -\\frac{2}{3} + \\frac{2}{3} = 0\n$$\n正交条件得到满足。结果正确。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{8}{3} \\\\ \\frac{7}{3} \\\\ 0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然欧几里得内积很直观，但它隐含地假设所有数据维度同等重要且具有相似的变异性——这在神经科学数据中很少成立。这个发人深省的练习  将展示这一假设会如何误导我们对神经表征相似性的判断。通过引入并对比考虑了数据噪声协方差的马氏（Mahalanobis）内积，你将学会揭示神经活动的“功能几何”结构，这是进行稳健数据分析的一项关键技能。",
            "id": "4170532",
            "problem": "一位系统神经科学家正在比较一个小神经元集合中，两种条件下与刺激锁定的群体响应方向。每种条件由对$2$个同时记录的神经元的试验平均响应向量来概括：对于条件$A$，平均向量为 $\\mathbf{r}_{A} = \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix}$；对于条件$B$，平均向量为 $\\mathbf{r}_{B} = \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix}$。在多次试验中，残余变异性（噪声）可以很好地近似为均值为零的高斯分布，其协方差矩阵为 $\\mathbf{S} = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}$，该矩阵是使用大量重复试验独立于均值估计出来的。\n\n分析者希望量化由 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 张成的一维子空间之间的对齐程度。他们首先使用欧几里得内积，然后使用由逆协方差矩阵导出的马氏内积来校正分析。\n\n仅使用以下标准基础：\n- $\\mathbb{R}^{n}$ 上的内积是一个双线性、对称、正定的映射 $\\langle \\cdot, \\cdot \\rangle$。它导出一个范数 $\\|\\mathbf{x}\\| = \\sqrt{\\langle \\mathbf{x}, \\mathbf{x} \\rangle}$。\n- 在内积空间中，两个非零向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 之间的夹角 $\\theta$ 定义为 $\\cos(\\theta) = \\dfrac{\\langle \\mathbf{x}, \\mathbf{y} \\rangle}{\\|\\mathbf{x}\\| \\, \\|\\mathbf{y}\\|}$。\n- 欧几里得内积为 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{E}} = \\mathbf{x}^{\\top} \\mathbf{y}$。\n- 给定一个对称正定矩阵 $\\mathbf{S}$，马氏内积为 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{M}} = \\mathbf{x}^{\\top} \\mathbf{S}^{-1} \\mathbf{y}$。\n\n任务：\n1. 使用 $\\langle \\cdot, \\cdot \\rangle_{\\mathrm{E}}$，计算 $\\operatorname{span}(\\mathbf{r}_{A})$ 和 $\\operatorname{span}(\\mathbf{r}_{B})$ 之间的 $\\cos(\\theta_{\\mathrm{E}})$ 以及对应的夹角 $\\theta_{\\mathrm{E}}$。\n2. 使用由 $\\mathbf{S}$ 导出的 $\\langle \\cdot, \\cdot \\rangle_{\\mathrm{M}}$，计算 $\\operatorname{span}(\\mathbf{r}_{A})$ 和 $\\operatorname{span}(\\mathbf{r}_{B})$ 之间的 $\\cos(\\theta_{\\mathrm{M}})$ 以及对应的夹角 $\\theta_{\\mathrm{M}}$。\n\n解释为什么在此情境下欧几里得内积可能会产生误导，以及马氏内积如何在子空间对齐方面校正分析。以弧度表示最终报告的夹角。\n\n仅报告校正后的主夹角 $\\theta_{\\mathrm{M}}$（以弧度为单位）作为你的最终答案。如果存在精确值，请不要四舍五入。",
            "solution": "该问题被评估为有效。所有提供的数据和定义都是自洽的，在神经数据分析和线性代数的背景下具有科学依据，并且是适定的。该问题是客观的，没有歧义、矛盾或不成立的前提。该任务是将定义的数学概念直接应用于系统神经科学中的一个现实场景。\n\n我们有以下给定的信息：\n条件A的平均响应向量：$\\mathbf{r}_{A} = \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix}$\n条件B的平均响应向量：$\\mathbf{r}_{B} = \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix}$\n噪声协方差矩阵：$\\mathbf{S} = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}$\n\n问题要求我们使用两种不同的内积来计算由 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 张成的子空间之间的夹角，并解释结果。两个向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 之间的夹角 $\\theta$ 由 $\\cos(\\theta) = \\frac{\\langle \\mathbf{x}, \\mathbf{y} \\rangle}{\\|\\mathbf{x}\\| \\, \\|\\mathbf{y}\\|}$ 给出。\n\n任务1：使用欧几里得内积计算夹角，$\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{E}} = \\mathbf{x}^{\\top} \\mathbf{y}$。\n\n首先，我们计算 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的内积：\n$$ \\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{E}} = \\mathbf{r}_{A}^{\\top} \\mathbf{r}_{B} = \\begin{pmatrix} 10  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} = (10)(10) + (1)(-1) = 100 - 1 = 99 $$\n\n接下来，我们计算 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的欧几里得范数：\n$$ \\|\\mathbf{r}_{A}\\|_{\\mathrm{E}}^2 = \\langle \\mathbf{r}_{A}, \\mathbf{r}_{A} \\rangle_{\\mathrm{E}} = (10)^2 + (1)^2 = 100 + 1 = 101 $$\n$$ \\|\\mathbf{r}_{B}\\|_{\\mathrm{E}}^2 = \\langle \\mathbf{r}_{B}, \\mathbf{r}_{B} \\rangle_{\\mathrm{E}} = (10)^2 + (-1)^2 = 100 + 1 = 101 $$\n范数分别为 $\\|\\mathbf{r}_{A}\\|_{\\mathrm{E}} = \\sqrt{101}$ 和 $\\|\\mathbf{r}_{B}\\|_{\\mathrm{E}} = \\sqrt{101}$。\n\n现在，我们可以计算 $\\cos(\\theta_{\\mathrm{E}})$：\n$$ \\cos(\\theta_{\\mathrm{E}}) = \\frac{\\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{E}}}{\\|\\mathbf{r}_{A}\\|_{\\mathrm{E}} \\, \\|\\mathbf{r}_{B}\\|_{\\mathrm{E}}} = \\frac{99}{\\sqrt{101} \\sqrt{101}} = \\frac{99}{101} $$\n夹角为 $\\theta_{\\mathrm{E}} = \\arccos\\left(\\frac{99}{101}\\right)$。由于 $\\frac{99}{101}$ 非常接近 $1$，这是一个很小的夹角，表明向量高度对齐。数值上，这大约是 $0.1987$ 弧度或 $11.4$ 度。\n\n任务2：使用马氏内积计算夹角，$\\langle \\mathbf{x}, \\mathbf{y} \\rangle_{\\mathrm{M}} = \\mathbf{x}^{\\top} \\mathbf{S}^{-1} \\mathbf{y}$。\n\n首先，我们必须求协方差矩阵 $\\mathbf{S}$ 的逆矩阵。由于 $\\mathbf{S}$ 是一个对角矩阵，其逆矩阵是对角线元素取倒数的矩阵：\n$$ \\mathbf{S}^{-1} = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} $$\n\n现在，我们计算 $\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的马氏内积：\n$$ \\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{M}} = \\mathbf{r}_{A}^{\\top} \\mathbf{S}^{-1} \\mathbf{r}_{B} = \\begin{pmatrix} 10  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} 10  1 \\end{pmatrix} \\begin{pmatrix} (10) \\cdot \\frac{1}{100} \\\\ (-1) \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 10  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{10} \\\\ -1 \\end{pmatrix} = (10)\\left(\\frac{1}{10}\\right) + (1)(-1) = 1 - 1 = 0 $$\n由于马氏内积为 $0$，这两个向量在此内积下是正交的。\n\n我们可以在不需要范数的情况下计算 $\\cos(\\theta_{\\mathrm{M}})$ 的对应值，但为了完整性，我们还是计算它们：\n$$ \\|\\mathbf{r}_{A}\\|_{\\mathrm{M}}^2 = \\langle \\mathbf{r}_{A}, \\mathbf{r}_{A} \\rangle_{\\mathrm{M}} = \\mathbf{r}_{A}^{\\top} \\mathbf{S}^{-1} \\mathbf{r}_{A} = \\begin{pmatrix} 10  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix} = (10)^2\\left(\\frac{1}{100}\\right) + (1)^2(1) = 1 + 1 = 2 $$\n$$ \\|\\mathbf{r}_{B}\\|_{\\mathrm{M}}^2 = \\langle \\mathbf{r}_{B}, \\mathbf{r}_{B} \\rangle_{\\mathrm{M}} = \\mathbf{r}_{B}^{\\top} \\mathbf{S}^{-1} \\mathbf{r}_{B} = \\begin{pmatrix} 10  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{100}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} = (10)^2\\left(\\frac{1}{100}\\right) + (-1)^2(1) = 1 + 1 = 2 $$\n因此，$\\|\\mathbf{r}_{A}\\|_{\\mathrm{M}} = \\sqrt{2}$ 且 $\\|\\mathbf{r}_{B}\\|_{\\mathrm{M}} = \\sqrt{2}$。\n\n那么，$\\cos(\\theta_{\\mathrm{M}})$ 是：\n$$ \\cos(\\theta_{\\mathrm{M}}) = \\frac{\\langle \\mathbf{r}_{A}, \\mathbf{r}_{B} \\rangle_{\\mathrm{M}}}{\\|\\mathbf{r}_{A}\\|_{\\mathrm{M}} \\, \\|\\mathbf{r}_{B}\\|_{\\mathrm{M}}} = \\frac{0}{\\sqrt{2} \\sqrt{2}} = 0 $$\n夹角为 $\\theta_{\\mathrm{M}} = \\arccos(0) = \\frac{\\pi}{2}$ 弧度。\n\n差异解释：\n\n欧几里得内积将 $\\mathbb{R}^2$ 中的所有坐标轴都视为同等重要。在这种情况下，两个向量在第一个坐标轴上都有一个值为 $10$ 的大的相同分量。这个大的共同分量主导了点积的计算，导致结果为 $99$，非常接近范数之积 ($101$)。因此，夹角 $\\theta_{\\mathrm{E}}$ 很小，给人一种误导性的印象，即条件 $A$ 和 $B$ 的神经响应方向几乎相同。\n\n然而，问题的背景至关重要。协方差矩阵 $\\mathbf{S}$ 告诉我们，神经活动沿着第一个轴的变异性极大（方差 $\\sigma_1^2 = 100$），而沿着第二个轴则非常稳定（方差 $\\sigma_2^2 = 1$）。在高噪声轴上的大信号分量比在低噪声轴上的小信号分量在统计上更不可靠。因此，原始向量空间的欧几里得几何结构不能很好地表示神经编码的功能几何结构。\n\n马氏内积通过重新缩放空间来纠正这一点。它给予高方差方向较小的权重，而给予低方差方向较大的权重。这等价于将向量变换到一个“白化”空间，在该空间中噪声是各向同性的（在所有方向上都是均匀的）。该变换为 $\\mathbf{r} \\to \\mathbf{S}^{-1/2}\\mathbf{r}$。在我们的例子中，$\\mathbf{S}^{-1/2} = \\begin{pmatrix} 1/10  0 \\\\ 0  1 \\end{pmatrix}$。应用此变换得到：\n$$ \\mathbf{r}'_{A} = \\mathbf{S}^{-1/2}\\mathbf{r}_{A} = \\begin{pmatrix} 1/10  0 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n$$ \\mathbf{r}'_{B} = \\mathbf{S}^{-1/2}\\mathbf{r}_{B} = \\begin{pmatrix} 1/10  0 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} $$\n在这个统计白化空间中，$\\mathbf{r}_{A}$ 和 $\\mathbf{r}_{B}$ 的马氏内积等于 $\\mathbf{r}'_{A}$ 和 $\\mathbf{r}'_{B}$ 的欧几里得内积：$\\langle \\mathbf{r}'_A, \\mathbf{r}'_B \\rangle_E = 1 \\cdot 1 + 1 \\cdot (-1) = 0$。向量 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 显然是正交的。\n\n马氏分析表明，在考虑了各向异性的噪声结构后，一维子空间 $\\operatorname{span}(\\mathbf{r}_{A})$ 和 $\\operatorname{span}(\\mathbf{r}_{B})$ 是正交的。表面上的对齐是在一个非常嘈杂的维度上存在巨大共同信号所造成的假象。这两种条件的真实、可区分的信号位于统计上独立的方向上。校正后的夹角 $\\theta_{\\mathrm{M}} = \\frac{\\pi}{2}$ 恰当地反映了这种功能上的正交性。",
            "answer": "$$\n\\boxed{\\frac{\\pi}{2}}\n$$"
        },
        {
            "introduction": "现在，我们将这些概念应用于神经影像分析的基石：用于fMRI数据的通用线性模型（GLM）。这个高级练习  旨在解决一个现实挑战，即不同时间点上噪声的非均匀性（异方差性）。你将使用一个由噪声结构决定的加权内积进行Gram-Schmidt正交化，从而创建一组正交标准化的回归量，并亲身体验这个优雅的数学框架如何简化大脑活动的参数估计，并使其在统计上更为稳健。",
            "id": "4170518",
            "problem": "一个具有四个重复时间的短组块设计功能性磁共振成像 (fMRI) 时间序列，通过一般线性模型 (GLM) 进行建模。其中，观测到的血氧水平依赖 (BOLD) 信号表示为描述任务事件的三个回归量和一个无关效应的线性组合。设回归量为列向量\n$$\n\\mathbf{r}_{1} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad\n\\mathbf{r}_{2} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{r}_{3} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix}.\n$$\n经验上发现，神经噪声随时间是独立的，但是异方差的，其协方差矩阵为\n$$\n\\mathbf{C} = \\operatorname{diag}(1, 2, 2, 1).\n$$\n考虑由 $\\mathbf{C}^{-1}$ 导出的加权内积，\n$$\n\\langle \\mathbf{u}, \\mathbf{v} \\rangle_{\\mathbf{C}} = \\mathbf{u}^{\\top} \\mathbf{C}^{-1} \\mathbf{v},\n$$\n它是正定的，因此在 $\\mathbb{R}^{4}$ 上定义了一个有效的内积。该组块观测到的 BOLD 向量为\n$$\n\\mathbf{y} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n\n仅使用内积、正交投影和内积空间上的 Gram–Schmidt 标准正交化的核心定义，完成以下操作：\n\n1. 对集合 $\\{\\mathbf{r}_{1}, \\mathbf{r}_{2}, \\mathbf{r}_{3}\\}$ 关于内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 进行 Gram–Schmidt 标准正交化，得到一个张成相同子空间的标准正交集 $\\{\\mathbf{q}_{1}, \\mathbf{q}_{2}, \\mathbf{q}_{3}\\}$。\n2. 从协方差为 $\\mathbf{C}$ 的 GLM 的加权最小二乘目标的定义出发，推导为什么当设计列在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下是标准正交的时候，系数估计值可以直接通过与 $\\mathbf{y}$ 的内积获得。\n3. 计算与观测数据 $\\mathbf{y}$ 对应的标准正交设计 $\\mathbf{Q} = [\\mathbf{q}_{1}\\ \\mathbf{q}_{2}\\ \\mathbf{q}_{3}]$ 的系数向量。\n\n将最终的系数向量以单个行向量的形式表示为精确值。无需四舍五入，且最终表达式中不应包含物理单位。",
            "solution": "我们首先回顾基本定义。给定一个对称正定矩阵 $\\mathbf{C}$，双线性形式 $\\langle \\mathbf{u}, \\mathbf{v} \\rangle_{\\mathbf{C}} = \\mathbf{u}^{\\top} \\mathbf{C}^{-1} \\mathbf{v}$ 在 $\\mathbb{R}^{n}$ 上定义了一个内积，其范数为 $\\|\\mathbf{u}\\|_{\\mathbf{C}} = \\sqrt{\\langle \\mathbf{u}, \\mathbf{u} \\rangle_{\\mathbf{C}}}$。关于此内积，到子空间上的正交投影的特征是最小化残差在范数 $\\|\\cdot\\|_{\\mathbf{C}}$ 下的平方范数。\n\n内积空间中的 Gram–Schmidt 过程如下：对于一组线性无关向量 $\\{\\mathbf{r}_{1}, \\mathbf{r}_{2}, \\mathbf{r}_{3}\\}$，定义\n$$\n\\mathbf{q}_{1} = \\frac{\\mathbf{r}_{1}}{\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}}}, \\quad\n\\mathbf{u}_{2} = \\mathbf{r}_{2} - \\langle \\mathbf{r}_{2}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\mathbf{q}_{1}, \\quad\n\\mathbf{q}_{2} = \\frac{\\mathbf{u}_{2}}{\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}}}, \\quad\n\\mathbf{u}_{3} = \\mathbf{r}_{3} - \\langle \\mathbf{r}_{3}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\mathbf{q}_{1} - \\langle \\mathbf{r}_{3}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} \\mathbf{q}_{2}, \\quad\n\\mathbf{q}_{3} = \\frac{\\mathbf{u}_{3}}{\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}}}.\n$$\n这就在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下产生一个标准正交集 $\\{\\mathbf{q}_{1}, \\mathbf{q}_{2}, \\mathbf{q}_{3}\\}$。\n\n我们一步步进行计算。首先，注意到\n$$\n\\mathbf{C}^{-1} = \\operatorname{diag}\\!\\left(1, \\frac{1}{2}, \\frac{1}{2}, 1\\right).\n$$\n计算 $\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}}^{2}$:\n$$\n\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}}^{2} = \\mathbf{r}_{1}^{\\top} \\mathbf{C}^{-1} \\mathbf{r}_{1} = 1 \\cdot 1 \\cdot 1 + 2 \\cdot 2 \\cdot \\frac{1}{2} + 0 \\cdot 0 \\cdot \\frac{1}{2} + 1 \\cdot 1 \\cdot 1 = 1 + 2 + 0 + 1 = 4.\n$$\n因此 $\\|\\mathbf{r}_{1}\\|_{\\mathbf{C}} = 2$ 并且\n$$\n\\mathbf{q}_{1} = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix}.\n$$\n接下来，\n$$\n\\langle \\mathbf{r}_{2}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} = \\mathbf{r}_{2}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{1} = \\begin{pmatrix} 0  1  1  0 \\end{pmatrix} \\mathbf{C}^{-1} \\begin{pmatrix} 1/2 \\\\ 1 \\\\ 0 \\\\ 1/2 \\end{pmatrix} = \\frac{1}{2}.\n$$\n因此\n$$\n\\mathbf{u}_{2} = \\mathbf{r}_{2} - \\frac{1}{2} \\mathbf{q}_{1} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{4} \\\\ \\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{4} \\end{pmatrix}.\n$$\n计算其范数：\n$$\n\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}}^{2} = \\left(-\\frac{1}{4}\\right)^{2} \\cdot 1 + \\left(\\frac{1}{2}\\right)^{2} \\cdot \\frac{1}{2} + 1^{2} \\cdot \\frac{1}{2} + \\left(-\\frac{1}{4}\\right)^{2} \\cdot 1 = \\frac{1}{16} + \\frac{1}{8} + \\frac{1}{2} + \\frac{1}{16} = \\frac{3}{4}.\n$$\n于是 $\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}} = \\frac{\\sqrt{3}}{2}$ 并且\n$$\n\\mathbf{q}_{2} = \\frac{\\mathbf{u}_{2}}{\\|\\mathbf{u}_{2}\\|_{\\mathbf{C}}} = \\frac{2}{\\sqrt{3}} \\begin{pmatrix} -\\frac{1}{4} \\\\ \\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2 \\sqrt{3}} \\\\ \\frac{1}{\\sqrt{3}} \\\\ \\frac{2}{\\sqrt{3}} \\\\ -\\frac{1}{2 \\sqrt{3}} \\end{pmatrix}.\n$$\n继续处理 $\\mathbf{r}_{3}$。首先，\n$$\n\\langle \\mathbf{r}_{3}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} = \\mathbf{r}_{3}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{1} = \\begin{pmatrix} 1  0  1  1 \\end{pmatrix} \\mathbf{C}^{-1} \\begin{pmatrix} 1/2 \\\\ 1 \\\\ 0 \\\\ 1/2 \\end{pmatrix} = 1,\n$$\n所以\n$$\n\\mathbf{v} = \\mathbf{r}_{3} - \\langle \\mathbf{r}_{3}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\mathbf{q}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 0 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -1 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix}.\n$$\n检查剩余的投影系数：\n$$\n\\langle \\mathbf{v}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} = \\mathbf{v}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{2} = \\begin{pmatrix} \\frac{1}{2}  -1  1  \\frac{1}{2} \\end{pmatrix} \\mathbf{C}^{-1} \\begin{pmatrix} -1/(2\\sqrt{3}) \\\\ 1/\\sqrt{3} \\\\ 2/\\sqrt{3} \\\\ -1/(2\\sqrt{3}) \\end{pmatrix} = 0.\n$$\n因此 $\\mathbf{u}_{3} = \\mathbf{v}$。其范数为\n$$\n\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}}^{2} = \\left(\\frac{1}{2}\\right)^{2} \\cdot 1 + (-1)^{2} \\cdot \\frac{1}{2} + 1^{2} \\cdot \\frac{1}{2} + \\left(\\frac{1}{2}\\right)^{2} \\cdot 1 = \\frac{1}{4} + \\frac{1}{2} + \\frac{1}{2} + \\frac{1}{4} = \\frac{3}{2},\n$$\n所以 $\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}} = \\sqrt{\\frac{3}{2}}$ 并且\n$$\n\\mathbf{q}_{3} = \\frac{\\mathbf{u}_{3}}{\\|\\mathbf{u}_{3}\\|_{\\mathbf{C}}} = \\sqrt{\\frac{2}{3}} \\begin{pmatrix} \\frac{1}{2} \\\\ -1 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\\\ -\\sqrt{\\frac{2}{3}} \\\\ \\sqrt{\\frac{2}{3}} \\\\ \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\end{pmatrix}.\n$$\n根据构造，$\\{\\mathbf{q}_{1}, \\mathbf{q}_{2}, \\mathbf{q}_{3}\\}$ 在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下是标准正交的。\n\n现在我们来证明系数简化的合理性。对于协方差为 $\\mathbf{C}$ 的 GLM，加权最小二乘 (WLS) 准则是最小化\n$$\nJ(\\boldsymbol{\\beta}) = \\|\\mathbf{y} - \\mathbf{X} \\boldsymbol{\\beta}\\|_{\\mathbf{C}}^{2} = (\\mathbf{y} - \\mathbf{X} \\boldsymbol{\\beta})^{\\top} \\mathbf{C}^{-1} (\\mathbf{y} - \\mathbf{X} \\boldsymbol{\\beta}),\n$$\n其中 $\\mathbf{X} = [\\mathbf{r}_{1}\\ \\mathbf{r}_{2}\\ \\mathbf{r}_{3}]$。设 $\\mathbf{Q} = [\\mathbf{q}_{1}\\ \\mathbf{q}_{2}\\ \\mathbf{q}_{3}]$ 是在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下同一列空间的一组标准正交基。该张成空间中的任意向量都可以唯一表示为 $\\sum_{i=1}^{3} \\alpha_{i} \\mathbf{q}_{i}$，并且 $\\mathbf{y}$ 到该张成空间上的正交投影为\n$$\n\\mathbf{P}_{\\mathcal{S}} \\mathbf{y} = \\sum_{i=1}^{3} \\langle \\mathbf{y}, \\mathbf{q}_{i} \\rangle_{\\mathbf{C}} \\mathbf{q}_{i},\n$$\n因为标准正交性意味着坐标 $\\alpha_{i}$ 恰好是内积 $\\langle \\mathbf{y}, \\mathbf{q}_{i} \\rangle_{\\mathbf{C}}$。因此，当设计列在内积 $\\langle \\cdot, \\cdot \\rangle_{\\mathbf{C}}$ 下是标准正交的时，$\\mathbf{Q}$-基下的系数向量为\n$$\n\\boldsymbol{\\beta}_{\\mathbf{Q}} = \\begin{pmatrix} \\langle \\mathbf{y}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} \\\\ \\langle \\mathbf{y}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} \\\\ \\langle \\mathbf{y}, \\mathbf{q}_{3} \\rangle_{\\mathbf{C}} \\end{pmatrix}.\n$$\n\n我们现在显式地计算这些内积。首先，\n$$\n\\langle \\mathbf{y}, \\mathbf{q}_{1} \\rangle_{\\mathbf{C}} = \\mathbf{y}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{1} = \\begin{pmatrix} 2  1  0  1 \\end{pmatrix} \\mathbf{C}^{-1} \\begin{pmatrix} 1/2 \\\\ 1 \\\\ 0 \\\\ 1/2 \\end{pmatrix} = 2.\n$$\n其次，\n$$\n\\langle \\mathbf{y}, \\mathbf{q}_{2} \\rangle_{\\mathbf{C}} = \\mathbf{y}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{2} = \\begin{pmatrix} 2  1  0  1 \\end{pmatrix} \\mathbf{C}^{-1} \\begin{pmatrix} -1/(2\\sqrt{3}) \\\\ 1/\\sqrt{3} \\\\ 2/\\sqrt{3} \\\\ -1/(2\\sqrt{3}) \\end{pmatrix} = -\\frac{1}{\\sqrt{3}}.\n$$\n第三，\n$$\n\\langle \\mathbf{y}, \\mathbf{q}_{3} \\rangle_{\\mathbf{C}} = \\mathbf{y}^{\\top} \\mathbf{C}^{-1} \\mathbf{q}_{3} = \\begin{pmatrix} 2  1  0  1 \\end{pmatrix} \\mathbf{C}^{-1} \\begin{pmatrix} \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\\\ -\\sqrt{\\frac{2}{3}} \\\\ \\sqrt{\\frac{2}{3}} \\\\ \\frac{1}{2} \\sqrt{\\frac{2}{3}} \\end{pmatrix} = \\sqrt{\\frac{2}{3}}.\n$$\n\n因此，对于标准正交设计 $\\mathbf{Q}$ 的系数向量是\n$$\n\\boldsymbol{\\beta}_{\\mathbf{Q}} = \\begin{pmatrix} 2  -\\frac{1}{\\sqrt{3}}  \\sqrt{\\frac{2}{3}} \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 2   -\\frac{1}{\\sqrt{3}}   \\sqrt{\\frac{2}{3}} \\end{pmatrix}}$$"
        }
    ]
}