{
    "hands_on_practices": [
        {
            "introduction": "在神经科学数据分析中，我们常常需要用不同的坐标系统来表示同一种神经活动模式，例如，从解剖学定义的感兴趣区域（ROI）基础切换到通过独立成分分析（ICA）提取的统计成分基础。这个练习将引导您从第一性原理出发，推导向量坐标在不同基之间转换的基本法则。通过完成这个练习 ，您将掌握坐标变换的核心机制，这是在不同特征空间中灵活处理和解读神经数据的一项关键技能。",
            "id": "4175034",
            "problem": "在神经科学数据分析中，一个常见的操作是将同一个神经活动模式在由不同基（例如解剖学定义的感兴趣区域与统计提取的成分）所诱导的不同坐标系中进行表示。考虑一个由试验平均响应模式构成的实向量空间 $\\mathbb{R}^{3}$，其坐标对应于从钙成像中提取的三个潜在特征。令 $\\mathcal{B} = \\{b_{1}, b_{2}, b_{3}\\}$ 是一个与解剖学定义的区域特征相关联的基，并令 $\\mathcal{B}' = \\{b'_{1}, b'_{2}, b'_{3}\\}$ 是通过独立成分分析（ICA; Independent Component Analysis）获得的基。\n\n仅从基、线性无关以及向量关于基的坐标表示的定义出发，推导向量 $y \\in \\mathbb{R}^{3}$ 的坐标如何通过一个基变换矩阵在 $\\mathcal{B}$ 和 $\\mathcal{B}'$ 之间进行变换。假设基变换矩阵 $T$ 将 $\\mathcal{B}$ 中的坐标映射到 $\\mathcal{B}'$ 中的坐标（因此，当定义域用 $\\mathcal{B}$ 表示，值域用 $\\mathcal{B}'$ 表示时，$T$ 是 $\\mathbb{R}^{3}$ 上单位线性算子的矩阵表示）。解释为什么如果 $\\mathcal{B}$ 和 $\\mathcal{B}'$ 都是基，那么 $T$ 必须是可逆的。\n\n然后，对于一个特定的数据集对齐，给定\n$$\nT \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n1  1  3 \\\\\n0  2  1\n\\end{pmatrix}.\n$$\n某个特定试验的神经活动模式在ICA基下的坐标为\n$$\n[y]_{\\mathcal{B}'} \\;=\\;\n\\begin{pmatrix}\n9 \\\\ -9 \\\\ 18\n\\end{pmatrix}.\n$$\n使用推导出的变换法则，精确计算解剖区域基坐标 $[y]_{\\mathcal{B}}$。将你的最终答案表示为最简整数形式的行向量；不需要四舍五入，也无需报告物理单位。",
            "solution": "问题陈述需经验证。\n\n### 第1步：提取已知条件\n- 向量空间：实向量空间 $\\mathbb{R}^{3}$。\n- 基 $\\mathcal{B}$：$\\mathcal{B} = \\{b_{1}, b_{2}, b_{3}\\}$，一个解剖学定义的基。\n- 基 $\\mathcal{B}'$：$\\mathcal{B}' = \\{b'_{1}, b'_{2}, b'_{3}\\}$，一个ICA定义的基。\n- 一个通用向量 $y \\in \\mathbb{R}^{3}$。\n- 一个基变换矩阵 $T$，将 $\\mathcal{B}$ 中的坐标映射到 $\\mathcal{B}'$ 中的坐标。当定义域用 $\\mathcal{B}$ 表示，值域用 $\\mathcal{B}'$ 表示时，$T$ 是 $\\mathbb{R}^{3}$ 上单位线性算子的矩阵表示。\n- 给定的具体矩阵 $T$ 为：\n$$\nT \\;=\\;\n\\begin{pmatrix}\n2  -1  0 \\\\\n1  1  3 \\\\\n0  2  1\n\\end{pmatrix}\n$$\n- 一个特定向量 $y$ 在基 $\\mathcal{B}'$ 中的坐标为：\n$$\n[y]_{\\mathcal{B}'} \\;=\\;\n\\begin{pmatrix}\n9 \\\\ -9 \\\\ 18\n\\end{pmatrix}\n$$\n- 目标是推导通用坐标变换法则，解释 $T$ 的可逆性，然后计算坐标向量 $[y]_{\\mathcal{B}}$，结果用最简整数形式的行向量表示。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是一个带有合乎情理的神经科学应用背景的线性代数标准练习。问题是适定的，提供了找到唯一解所需的所有定义和数据。语言客观而精确。该问题没有违反任何基本原则，不是不完整或矛盾的，也不是不适定的。给定矩阵的行列式不为零，确保了唯一解的存在。这是一个有实质内容的线性代数练习，并非琐碎或同义反复。\n\n### 第3步：结论与行动\n该问题有效。将提供完整解答。\n\n***\n\n根据要求，解答分为三个部分：变换法则的推导，基变换矩阵可逆性的解释，以及具体的计算。\n\n**1. 坐标变换法则的推导**\n\n设 $y$ 是向量空间 $\\mathbb{R}^{3}$ 中的一个任意向量。\n因为 $\\mathcal{B} = \\{b_1, b_2, b_3\\}$ 是 $\\mathbb{R}^{3}$ 的一个基，所以存在一组唯一的标量 $c_1, c_2, c_3 \\in \\mathbb{R}$ 使得\n$$ y = c_1 b_1 + c_2 b_2 + c_3 b_3 $$\n这些标量构成了 $y$ 关于基 $\\mathcal{B}$ 的坐标向量，记作 $[y]_{\\mathcal{B}}$：\n$$ [y]_{\\mathcal{B}} = \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} $$\n类似地，因为 $\\mathcal{B}' = \\{b'_1, b'_2, b'_3\\}$ 也是 $\\mathbb{R}^{3}$ 的一个基，所以存在另一组唯一的标量 $d_1, d_2, d_3 \\in \\mathbb{R}$ 使得\n$$ y = d_1 b'_1 + d_2 b'_2 + d_3 b'_3 $$\n这些标量构成了坐标向量 $[y]_{\\mathcal{B}'}$：\n$$ [y]_{\\mathcal{B}'} = \\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\end{pmatrix} $$\n问题陈述，矩阵 $T$ 代表单位线性变换 $id: \\mathbb{R}^{3} \\to \\mathbb{R}^{3}$，其中 $id(y) = y$，定义域空间的基为 $\\mathcal{B}$，值域空间的基为 $\\mathcal{B}'$。根据线性算子的矩阵表示的定义，矩阵 $T$ 将输入向量在定义域基下的坐标向量变换为输出向量在值域基下的坐标向量。\n因此，对于任意向量 $y$，我们有：\n$$ [id(y)]_{\\mathcal{B}'} = T [y]_{\\mathcal{B}} $$\n由于 $id(y) = y$，从基 $\\mathcal{B}$ 到基 $\\mathcal{B}'$ 的坐标变换法则为：\n$$ [y]_{\\mathcal{B}'} = T [y]_{\\mathcal{B}} $$\n这是基变换的基本关系。$T$ 的列是旧基向量（来自 $\\mathcal{B}$）在新基（$\\mathcal{B}'$）下的坐标向量。也就是说，$T$ 的第 $j$ 列是向量 $[b_j]_{\\mathcal{B}'}$。\n\n**2. 基变换矩阵 $T$ 的可逆性**\n\n一个方阵是可逆的，当且仅当其列向量线性无关。如前所述，$T$ 的列是坐标向量 $[b_1]_{\\mathcal{B}'}$、$[b_2]_{\\mathcal{B}'}$ 和 $[b_3]_{\\mathcal{B}'}$。为了证明 $T$ 是可逆的，我们必须证明这些列向量是线性无关的。\n考虑一个等于零向量的 $T$ 的列向量的线性组合：\n$$ c_1 [b_1]_{\\mathcal{B}'} + c_2 [b_2]_{\\mathcal{B}'} + c_3 [b_3]_{\\mathcal{B}'} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n从向量到其坐标表示的映射是一个线性变换（一个同构）。因此，我们可以合并左侧的项：\n$$ [c_1 b_1 + c_2 b_2 + c_3 b_3]_{\\mathcal{B}'} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n坐标向量为零向量的唯一向量是向量空间自身的零向量。因此，\n$$ c_1 b_1 + c_2 b_2 + c_3 b_3 = \\mathbf{0} $$\n其中 $\\mathbf{0}$ 是 $\\mathbb{R}^3$ 中的零向量。\n根据定义，一组向量构成一个基，当且仅当其元素是线性无关的。由于 $\\mathcal{B} = \\{b_1, b_2, b_3\\}$ 是一个基，向量 $b_1, b_2, b_3$ 是线性无关的。这意味着上述方程的唯一解是平凡解，即所有标量系数都为零：\n$$ c_1 = 0, \\quad c_2 = 0, \\quad c_3 = 0 $$\n这表明，能产生零向量的 $T$ 的列向量的线性组合只有平凡组合。因此，$T$ 的列是线性无关的。一个列向量线性无关的方阵是可逆的。因此，从一个基到另一个基的基变换矩阵 $T$ 必须是可逆的。\n\n**3. 解剖区域基坐标的计算**\n\n我们已知变换法则 $[y]_{\\mathcal{B}'} = T [y]_{\\mathcal{B}}$、矩阵 $T$ 和坐标向量 $[y]_{\\mathcal{B}'}$。我们需要求 $[y]_{\\mathcal{B}}$。由于 $T$ 是可逆的，我们可以从左边乘以其逆矩阵 $T^{-1}$：\n$$ T^{-1} [y]_{\\mathcal{B}'} = T^{-1} T [y]_{\\mathcal{B}} = I [y]_{\\mathcal{B}} = [y]_{\\mathcal{B}} $$\n所以，我们必须计算 $[y]_{\\mathcal{B}} = T^{-1} [y]_{\\mathcal{B}'}$。\n首先，我们求 $T = \\begin{pmatrix} 2  -1  0 \\\\ 1  1  3 \\\\ 0  2  1 \\end{pmatrix}$ 的逆矩阵。\n$T$ 的行列式是：\n$$ \\det(T) = 2(1 \\cdot 1 - 3 \\cdot 2) - (-1)(1 \\cdot 1 - 3 \\cdot 0) + 0(1 \\cdot 2 - 1 \\cdot 0) $$\n$$ \\det(T) = 2(1 - 6) + 1(1) = 2(-5) + 1 = -10 + 1 = -9 $$\n因为 $\\det(T) \\neq 0$，所以逆矩阵存在。\n逆矩阵由 $T^{-1} = \\frac{1}{\\det(T)} \\text{adj}(T)$ 给出，其中 $\\text{adj}(T)$ 是伴随矩阵（代数余子式矩阵的转置）。\n代数余子式矩阵是：\n$$ C = \\begin{pmatrix} +|{1 \\atop 2} {3 \\atop 1}|  -|{1 \\atop 0} {3 \\atop 1}|  +|{1 \\atop 0} {1 \\atop 2}| \\\\ -|{-1 \\atop 2} {0 \\atop 1}|  +|{2 \\atop 0} {0 \\atop 1}|  -|{2 \\atop 0} {-1 \\atop 2}| \\\\ +|{-1 \\atop 1} {0 \\atop 3}|  -|{2 \\atop 1} {0 \\atop 3}|  +|{2 \\atop 1} {-1 \\atop 1}| \\end{pmatrix} = \\begin{pmatrix} -5  -1  2 \\\\ 1  2  -4 \\\\ -3  -6  3 \\end{pmatrix} $$\n伴随矩阵是代数余子式矩阵的转置：\n$$ \\text{adj}(T) = C^T = \\begin{pmatrix} -5  1  -3 \\\\ -1  2  -6 \\\\ 2  -4  3 \\end{pmatrix} $$\n逆矩阵是：\n$$ T^{-1} = \\frac{1}{-9} \\begin{pmatrix} -5  1  -3 \\\\ -1  2  -6 \\\\ 2  -4  3 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 5  -1  3 \\\\ 1  -2  6 \\\\ -2  4  -3 \\end{pmatrix} $$\n现在我们可以计算 $[y]_{\\mathcal{B}}$：\n$$ [y]_{\\mathcal{B}} = T^{-1} [y]_{\\mathcal{B}'} = \\frac{1}{9} \\begin{pmatrix} 5  -1  3 \\\\ 1  -2  6 \\\\ -2  4  -3 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ -9 \\\\ 18 \\end{pmatrix} $$\n首先，我们进行矩阵-向量乘法：\n$$ \\begin{pmatrix} 5  -1  3 \\\\ 1  -2  6 \\\\ -2  4  -3 \\end{pmatrix} \\begin{pmatrix} 9 \\\\ -9 \\\\ 18 \\end{pmatrix} = \\begin{pmatrix} 5(9) + (-1)(-9) + 3(18) \\\\ 1(9) + (-2)(-9) + 6(18) \\\\ -2(9) + 4(-9) + (-3)(18) \\end{pmatrix} = \\begin{pmatrix} 45 + 9 + 54 \\\\ 9 + 18 + 108 \\\\ -18 - 36 - 54 \\end{pmatrix} = \\begin{pmatrix} 108 \\\\ 135 \\\\ -108 \\end{pmatrix} $$\n最后，我们乘以标量 $\\frac{1}{9}$：\n$$ [y]_{\\mathcal{B}} = \\frac{1}{9} \\begin{pmatrix} 108 \\\\ 135 \\\\ -108 \\end{pmatrix} = \\begin{pmatrix} \\frac{108}{9} \\\\ \\frac{135}{9} \\\\ \\frac{-108}{9} \\end{pmatrix} = \\begin{pmatrix} 12 \\\\ 15 \\\\ -12 \\end{pmatrix} $$\n$y$ 关于解剖基 $\\mathcal{B}$ 的坐标向量是 $\\begin{pmatrix} 12 \\\\ 15 \\\\ -12 \\end{pmatrix}$。问题要求将此答案表示为行向量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 12  15  -12 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在构建用于功能性磁共振成像（fMRI）数据分析的通用线性模型（GLM）时，解释变量（即回归量）的选择至关重要。如果回归量集合不是线性无关的，模型就会出现“多重共线性”问题，导致参数无法被唯一确定。本练习  模拟了一个常见的实验设计缺陷，即不慎构建了一组线性相关的回归量。通过计算设计矩阵的秩，您将学会如何诊断这种关键问题，确保您的统计模型具有可识别性和稳健性。",
            "id": "4175062",
            "problem": "一个研究团队正在使用一般线性模型（GLM）对功能性磁共振成像（fMRI）中的血氧水平依赖响应进行建模。该模型写作 $Y = X\\beta + \\varepsilon$，其中 $Y \\in \\mathbb{R}^{n}$ 是观测信号，$X \\in \\mathbb{R}^{n \\times p}$ 是设计矩阵，$\\beta \\in \\mathbb{R}^{p}$ 是参数，$\\varepsilon \\in \\mathbb{R}^{n}$ 代表噪声。该实验包含 $n = 9$ 次连续扫描，没有静息基线，并设有三个相互排斥的任务条件（认知状态），分别标记为 $A$、$B$ 和 $C$。在每次扫描中，恰好有一个条件处于活动状态。分析师构建了一个具有 $p = 5$ 列的设计矩阵 $X$：一个截距项，三个虚拟编码的条件回归量（分别对应于 $A$、$B$ 和 $C$），以及一个等于这三个虚拟编码条件回归量之和的“任务开启”回归量。所有回归量都是单位幅度的箱式函数列，未与任何血流动力学核函数进行卷积。\n\n实验安排将扫描 $1$–$3$ 分配给条件 $A$，扫描 $4$–$6$ 分配给条件 $B$，扫描 $7$–$9$ 分配给条件 $C$。最终得到的设计矩阵 $X \\in \\mathbb{R}^{9 \\times 5}$ 为\n$$\nX = \\begin{pmatrix}\n1  1  0  0  1 \\\\\n1  1  0  0  1 \\\\\n1  1  0  0  1 \\\\\n1  0  1  0  1 \\\\\n1  0  1  0  1 \\\\\n1  0  1  0  1 \\\\\n1  0  0  1  1 \\\\\n1  0  0  1  1 \\\\\n1  0  0  1  1\n\\end{pmatrix},\n$$\n其中第一列是截距项（全为1），第 $2$–$4$ 列分别是条件 $A$、$B$ 和 $C$ 的虚拟编码回归量，第五列是定义为三个虚拟编码列之和的“任务开启”回归量。\n\n仅使用线性代数中线性无关、秩和基的核心定义，以及上述GLM公式，确定 $X$ 的秩。请用一个不带单位的整数表示最终答案。无需四舍五入。",
            "solution": "矩阵的秩定义为其列空间的维度，列空间是由矩阵的列向量生成的向量空间。这个维度等于矩阵中线性无关的列向量的最大数量。问题要求我们确定给定的设计矩阵 $X \\in \\mathbb{R}^{9 \\times 5}$ 的秩：\n$$\nX = \\begin{pmatrix}\n1  1  0  0  1 \\\\\n1  1  0  0  1 \\\\\n1  1  0  0  1 \\\\\n1  0  1  0  1 \\\\\n1  0  1  0  1 \\\\\n1  0  1  0  1 \\\\\n1  0  0  1  1 \\\\\n1  0  0  1  1 \\\\\n1  0  0  1  1\n\\end{pmatrix}\n$$\n设 $X$ 的列向量记为 $x_1, x_2, x_3, x_4, x_5 \\in \\mathbb{R}^{9}$，其中下标对应于列索引。如果存在不全为零的标量 $c_1, \\dots, c_k$ 使得方程 $c_1 v_1 + \\dots + c_k v_k = \\mathbf{0}$ 成立，则向量集 $\\{v_1, \\dots, v_k\\}$ 是线性相关的。$X$ 的秩是 $\\{x_1, x_2, x_3, x_4, x_5\\}$ 的最大线性无关子集的大小。\n\n首先，我们找出 $X$ 的列之间的任何线性相关性。通过观察矩阵可以发现，第一列 $x_1$（截距项）和第五列 $x_5$（“任务开启”回归量）是相同的。\n$$\nx_1 = x_5\n$$\n这个关系意味着存在线性相关性，可以表示为一个等于零向量的非平凡线性组合：\n$$\n(1) x_1 + (0) x_2 + (0) x_3 + (0) x_4 + (-1) x_5 = \\mathbf{0}\n$$\n由于系数不全为零，因此这5个列向量的集合是线性相关的。这证明了 $X$ 的秩小于5。\n\n此外，问题陈述第五列被定义为三个虚拟编码条件回归量（第2、3、4列）的和。我们用给定的向量来验证这一点：\n$$\nx_2 + x_3 + x_4 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n得到的向量与第一列 $x_1$ 相同。因此，我们有第二个线性相关性：\n$$\nx_1 = x_2 + x_3 + x_4\n$$\n这可以写成另一个等于零向量的非平凡线性组合：\n$$\n(-1) x_1 + (1) x_2 + (1) x_3 + (1) x_4 + (0) x_5 = \\mathbf{0}\n$$\n这些相关性表明，对于生成 $X$ 的列空间（记作 $C(X)$）而言，某些列是冗余的。\n列空间为 $C(X) = \\text{span}\\{x_1, x_2, x_3, x_4, x_5\\}$。\n因为 $x_5 = x_1$，向量 $x_5$ 是冗余的，我们可以写成：\n$$\nC(X) = \\text{span}\\{x_1, x_2, x_3, x_4\\}\n$$\n再者，由于 $x_1 = x_2 + x_3 + x_4$，向量 $x_1$ 是 $x_2, x_3,$ 和 $x_4$ 的线性组合。因此，$x_1$ 在生成集中也是冗余的：\n$$\nC(X) = \\text{span}\\{x_2, x_3, x_4\\}\n$$\n$X$ 的秩是这个空间的维度。维度等于该空间的一个基中的向量数量。如果集合 $\\{x_2, x_3, x_4\\}$ 是线性无关的，它就构成了 $C(X)$ 的一个基。我们必须通过寻找标量 $c_2, c_3, c_4$ 来检验线性无关性，使得：\n$$\nc_2 x_2 + c_3 x_3 + c_4 x_4 = \\mathbf{0}\n$$\n代入向量分量：\n$$\nc_2 \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + c_3 \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + c_4 \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这个单一的向量方程等价于以下标量方程组：\n$$\n\\begin{pmatrix} c_2 \\\\ c_2 \\\\ c_2 \\\\ c_3 \\\\ c_3 \\\\ c_3 \\\\ c_4 \\\\ c_4 \\\\ c_4 \\end{pmatrix} = \\mathbf{0}\n$$\n从前3行，我们推断出 $c_2 = 0$。从第4、5、6行，我们推断出 $c_3 = 0$。从第7、8、9行，我们推断出 $c_4 = 0$。唯一的解是平凡解，$c_2 = 0, c_3 = 0, c_4 = 0$。\n因此，向量集合 $\\{x_2, x_3, x_4\\}$ 是线性无关的。\n\n由于集合 $\\{x_2, x_3, x_4\\}$ 是线性无关的，并且它生成了列空间 $C(X)$，所以它构成了 $C(X)$ 的一个基。根据定义，矩阵的秩是其列空间的任意一个基中的向量数量。我们找到的基 $\\{x_2, x_3, x_4\\}$ 包含3个向量。\n\n因此，矩阵 $X$ 的秩为 $3$。这个结果表明设计矩阵存在完全多重共线性，即秩（$3$）小于列数（$p=5$）的情况。在GLM的背景下，这意味着矩阵 $X^T X$ 是奇异的，无法为参数向量 $\\beta$ 确定唯一的普通最小二乘解。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "当我们发现模型的设计矩阵存在线性相关性时，下一个关键问题是：这对模型的参数估计意味着什么？这个练习  揭示了多重共线性的直接后果——最小二乘解的非唯一性。您将通过代数方法证明，一个秩亏的设计矩阵 $X$ 的非平凡零空间（null space）如何导致存在无穷多组同样能很好拟合数据的参数 $\\beta$。这项实践将抽象的零空间概念与模型可识别性的实际问题联系起来，深刻揭示了为什么线性无关性对于从数据中得出唯一科学结论至关重要。",
            "id": "4175036",
            "problem": "您正在神经科学数据分析中分析一个通用线性模型（GLM），该模型用于分析四个时间点的局部场电位（LFP）振幅的短时记录。该模型被建模为三个回归量的线性组合：一个基线项、一个条件A的刺激事件，以及一个被无意地构建为基线项和条件A回归量之和的复合无关回归量。设响应向量为 $$\\mathbf{y} = \\begin{pmatrix} 2 \\\\ 4 \\\\ 5 \\\\ 3 \\end{pmatrix},$$ 设计矩阵为 $$\\mathbf{X} = \\begin{pmatrix} 1  0  1 \\\\ 1  1  2 \\\\ 1  1  2 \\\\ 1  0  1 \\end{pmatrix},$$ 其中各列分别对应基线、条件A和复合无关回归量。\n\n从线性无关、矩阵的秩、矩阵的零空间以及通过最小化平方误差 $$\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|^{2}$$ 定义的最小二乘估计量的核心定义出发，完成以下任务：\n\n1. 使用零空间的代数定义，确定 $$\\mathbf{X}$$ 零空间中的一个非零向量，从而证明回归量之间的共线性产生了一个非平凡零空间。\n\n2. 使用最小二乘准则和零空间的性质，来刻画能产生相同拟合响应的参数向量流形。选择一个特定的代表解，该解通过仅拟合基线和条件A回归量（即排除复合无关回归量列）获得，然后将此解嵌入到完整的三参数空间中，以获得一个最小二乘解 $$\\boldsymbol{\\beta}_{0} \\in \\mathbb{R}^{3}$$。\n\n3. 结合您的结果，将等价参数向量的一维仿射子空间（即在此设计下不可区分的解构成的流形）写成一个关于自由标量参数 $$t \\in \\mathbb{R}$$ 的参数表达式的闭式形式。\n\n请将您在 $$\\mathbb{R}^{3}$$ 中的流形的这一单一参数表达式作为最终答案。无需四舍五入。最终答案中不包含单位。",
            "solution": "该问题经验证具有科学依据、是适定的且客观的。它代表了线性回归分析中一个标准的、尽管是退化的情况，涉及完全多重共线性。所有必要数据均已提供，且前提内部一致。因此，我将给出完整解答。\n\n问题要求分析一个最小二乘估计问题，其中设计矩阵 $\\mathbf{X}$ 的列是线性相关的。目标是找到最小化平方误差 $\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|^{2}$ 的参数向量 $\\boldsymbol{\\beta}$ 的完整集合。这组解构成一个仿射子空间，我们将对其进行刻画。\n\n给定的响应向量为 $\\mathbf{y} = \\begin{pmatrix} 2 \\\\ 4 \\\\ 5 \\\\ 3 \\end{pmatrix}$，设计矩阵为 $\\mathbf{X} = \\begin{pmatrix} 1  0  1 \\\\ 1  1  2 \\\\ 1  1  2 \\\\ 1  0  1 \\end{pmatrix}$。参数向量为 $\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\\\ \\beta_3 \\end{pmatrix}$，分别对应基线、条件A和复合无关回归量。\n\n**1. 确定 $\\mathbf{X}$ 的零空间**\n\n问题指出，$\\mathbf{X}$ 的第三列（我们记作 $\\mathbf{c}_3$）是前两列（$\\mathbf{c}_1$ 和 $\\mathbf{c}_2$）的和。我们可以验证这一点：\n$$\\mathbf{c}_1 + \\mathbf{c}_2 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\\\ 1 \\end{pmatrix} = \\mathbf{c}_3$$\n这种线性相关性可以写成 $\\mathbf{c}_1 + \\mathbf{c}_2 - \\mathbf{c}_3 = \\mathbf{0}$。这个方程表示 $\\mathbf{X}$ 的列的一个线性组合，其结果为零向量。\n\n根据定义，矩阵 $\\mathbf{X}$ 的零空间，记作 $N(\\mathbf{X})$，是所有满足 $\\mathbf{X}\\mathbf{v} = \\mathbf{0}$ 的向量 $\\mathbf{v}$ 的集合。方程 $\\mathbf{c}_1 + \\mathbf{c}_2 - \\mathbf{c}_3 = \\mathbf{0}$ 可以用矩阵形式表示为：\n$$\\mathbf{X} \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\mathbf{0}$$\n因此，非零向量 $\\mathbf{v} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix}$ 位于 $\\mathbf{X}$ 的零空间中。$\\mathbf{X}$ 的前两列是线性无关的，所以 $\\mathbf{X}$ 的秩为 $2$。根据秩-零度定理，零空间的维度（零度）是列数减去秩，即 $3 - 2 = 1$。因此，$\\mathbf{X}$ 的零空间是由 $\\mathbf{v}$ 生成的一维子空间：\n$$N(\\mathbf{X}) = \\{ t \\cdot \\mathbf{v} \\mid t \\in \\mathbb{R} \\} = \\left\\{ t \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} \\mid t \\in \\mathbb{R} \\right\\}$$\n\n**2. 寻找一个特定的最小二乘解 $\\boldsymbol{\\beta}_0$**\n\n最小二乘解是使 $\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|^{2}$ 最小化的向量 $\\boldsymbol{\\beta}$。这些解满足正规方程组 $\\mathbf{X}^{T}\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{X}^{T}\\mathbf{y}$。由于 $\\mathbf{X}$ 的列线性相关，矩阵 $\\mathbf{X}^{T}\\mathbf{X}$ 是奇异的，因此 $\\boldsymbol{\\beta}$ 没有唯一解。然而，解集是非空的。\n\n为了找到一个特定解，我们可以解决一个等价的、适定的问题。由于 $\\mathbf{c}_3$ 是冗余的，$\\mathbf{X}$ 的列空间与由其前两个（线性无关的）列构成的矩阵 $\\mathbf{X}_{red}$ 的列空间相同。\n$$\\mathbf{X}_{red} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  1 \\\\ 1  0 \\end{pmatrix}$$\n我们可以通过求解简化的最小二乘问题来找到一个唯一的参数向量 $\\boldsymbol{\\beta}_{red} = \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\end{pmatrix}$：最小化 $\\|\\mathbf{y} - \\mathbf{X}_{red}\\boldsymbol{\\beta}_{red}\\|^{2}$。相应的正规方程组是 $\\mathbf{X}_{red}^{T}\\mathbf{X}_{red}\\boldsymbol{\\beta}_{red} = \\mathbf{X}_{red}^{T}\\mathbf{y}$。\n\n首先，我们计算 $\\mathbf{X}_{red}^{T}\\mathbf{X}_{red}$：\n$$\\mathbf{X}_{red}^{T}\\mathbf{X}_{red} = \\begin{pmatrix} 1  1  1  1 \\\\ 0  1  1  0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 1  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 4  2 \\\\ 2  2 \\end{pmatrix}$$\n接下来，我们计算 $\\mathbf{X}_{red}^{T}\\mathbf{y}$：\n$$\\mathbf{X}_{red}^{T}\\mathbf{y} = \\begin{pmatrix} 1  1  1  1 \\\\ 0  1  1  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 4 \\\\ 5 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 2+4+5+3 \\\\ 0+4+5+0 \\end{pmatrix} = \\begin{pmatrix} 14 \\\\ 9 \\end{pmatrix}$$\n现在我们求解这个线性方程组：\n$$\\begin{pmatrix} 4  2 \\\\ 2  2 \\end{pmatrix} \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\end{pmatrix} = \\begin{pmatrix} 14 \\\\ 9 \\end{pmatrix}$$\n这得到方程组：\n1. $$4\\beta_1 + 2\\beta_2 = 14 \\implies 2\\beta_1 + \\beta_2 = 7$$\n2. $$2\\beta_1 + 2\\beta_2 = 9$$\n用第二个方程减去第一个方程得到 $\\beta_2 = 2$。将此结果代回第一个方程：$2\\beta_1 + 2 = 7 \\implies 2\\beta_1 = 5 \\implies \\beta_1 = \\frac{5}{2}$。\n所以，$\\boldsymbol{\\beta}_{red} = \\begin{pmatrix} 5/2 \\\\ 2 \\end{pmatrix}$。\n\n我们可以通过将冗余回归量的系数设为零，将此解嵌入到三维参数空间中。这为原始问题提供了一个特定解 $\\boldsymbol{\\beta}_0$：\n$$\\boldsymbol{\\beta}_{0} = \\begin{pmatrix} 5/2 \\\\ 2 \\\\ 0 \\end{pmatrix}$$\n这个向量 $\\boldsymbol{\\beta}_0$ 是一个有效的最小二乘解，因为预测响应 $\\mathbf{X}\\boldsymbol{\\beta}_0 = \\mathbf{X}_{red}\\boldsymbol{\\beta}_{red}$ 是 $\\mathbf{y}$ 在 $\\mathbf{X}$ 的列空间上的正交投影。\n\n**3. 所有解的流形的刻画**\n\n所有最小二乘解的集合由所有能产生相同最小平方误差的向量 $\\boldsymbol{\\beta}$ 组成。这等价于找到所有能产生与我们的特定解 $\\boldsymbol{\\beta}_0$ 相同的预测响应向量 $\\hat{\\mathbf{y}}$ 的 $\\boldsymbol{\\beta}$。\n$$\\mathbf{X}\\boldsymbol{\\beta} = \\mathbf{X}\\boldsymbol{\\beta}_{0}$$\n重新整理这个方程，我们得到：\n$$\\mathbf{X}\\boldsymbol{\\beta} - \\mathbf{X}\\boldsymbol{\\beta}_{0} = \\mathbf{0} \\implies \\mathbf{X}(\\boldsymbol{\\beta} - \\boldsymbol{\\beta}_{0}) = \\mathbf{0}$$\n这个方程表明，差值 $\\boldsymbol{\\beta} - \\boldsymbol{\\beta}_{0}$ 必须是 $\\mathbf{X}$ 零空间中的一个向量。\n从第1部分我们知道，$N(\\mathbf{X})$ 中的任何向量都可以写成 $t \\cdot \\mathbf{v}$ 的形式，其中标量 $t \\in \\mathbb{R}$，$\\mathbf{v} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix}$。\n因此，$\\boldsymbol{\\beta} - \\boldsymbol{\\beta}_{0} = t\\mathbf{v}$，这意味着任何最小二乘解的一般形式是：\n$$\\boldsymbol{\\beta}(t) = \\boldsymbol{\\beta}_{0} + t\\mathbf{v}$$\n代入我们找到的向量 $\\boldsymbol{\\beta}_{0}$ 和 $\\mathbf{v}$：\n$$\\boldsymbol{\\beta}(t) = \\begin{pmatrix} 5/2 \\\\ 2 \\\\ 0 \\end{pmatrix} + t \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 5/2 + t \\\\ 2 + t \\\\ 0 - t \\end{pmatrix} = \\begin{pmatrix} 5/2 + t \\\\ 2 + t \\\\ -t \\end{pmatrix}$$\n这个参数表达式定义了所有最小化最小二乘准则的参数向量构成的一维仿射子空间，它代表了这个秩亏模型中不可区分的解的流形。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{2} + t \\\\\n2 + t \\\\\n-t\n\\end{pmatrix}\n}\n$$"
        }
    ]
}