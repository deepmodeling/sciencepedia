{
    "hands_on_practices": [
        {
            "introduction": "掌握傅里叶级数的第一步是亲手计算一个基本函数的系数。这个练习将引导你分解一个在神经科学和信号处理中作为基本模型非常有用的函数——锯齿波。通过为函数 $f(x) = x$ 推导傅里叶级数，你将练习应用傅里叶系数的积分定义，并利用函数对称性来简化计算。",
            "id": "8857",
            "problem": "一个周期为 $2L$ 的周期函数 $f(x)$，如果满足某些条件（狄利克雷条件），则可以表示为其傅里叶级数。对于定义在区间 $[-L, L]$ 上的函数，其傅里叶级数由下式给出：\n$$\nf(x) \\sim \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\left[ a_n \\cos\\left(\\frac{n\\pi x}{L}\\right) + b_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right]\n$$\n级数的系数 $a_0$、$a_n$ 和 $b_n$ 使用以下公式计算：\n$$\na_0 = \\frac{1}{L} \\int_{-L}^{L} f(x) \\, dx\n$$\n$$\na_n = \\frac{1}{L} \\int_{-L}^{L} f(x) \\cos\\left(\\frac{n\\pi x}{L}\\right) \\, dx \\quad (n \\ge 1)\n$$\n$$\nb_n = \\frac{1}{L} \\int_{-L}^{L} f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) \\, dx \\quad (n \\ge 1)\n$$\n\n考虑定义在区间 $[-\\pi, \\pi]$ 上的简单线性函数 $f(x) = x$。该函数的周期为 $2\\pi$，因此 $L=\\pi$。\n\n推导该函数在指定区间上的完整傅里叶级数表示。",
            "solution": "问题是求函数 $f(x) = x$ 在区间 $[-\\pi, \\pi]$ 上的傅里叶级数。周期为 $2L = 2\\pi$，所以 $L=\\pi$。傅里叶级数的一般形式简化为：\n$$\nf(x) \\sim \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\left[ a_n \\cos(nx) + b_n \\sin(nx) \\right]\n$$\n我们需要计算系数 $a_0$、$a_n$ 和 $b_n$。\n\n**第1步：计算系数 $a_0$。**\n$a_0$ 的公式是：\n$$\na_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\, dx = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x \\, dx\n$$\n函数 $f(x) = x$ 是一个奇函数，即 $f(-x) = -f(x)$。奇函数在对称区间（如 $[-\\pi, \\pi]$）上的积分为零。\n$$\na_0 = 0\n$$\n或者，可以直接计算积分：\n$$\na_0 = \\frac{1}{\\pi} \\left[ \\frac{x^2}{2} \\right]_{-\\pi}^{\\pi} = \\frac{1}{2\\pi} (\\pi^2 - (-\\pi)^2) = \\frac{1}{2\\pi} (\\pi^2 - \\pi^2) = 0\n$$\n\n**第2步：计算系数 $a_n$。**\n$a_n$ 的公式是：\n$$\na_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\cos(nx) \\, dx = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x \\cos(nx) \\, dx\n$$\n被积函数是一个奇函数（$x$）和一个偶函数（$\\cos(nx)$）的乘积。一个奇函数和一个偶函数的乘积是奇函数。因此，在对称区间 $[-\\pi, \\pi]$ 上的积分为零。\n$$\na_n = 0 \\quad \\text{for all } n \\ge 1\n$$\n\n**第3步：计算系数 $b_n$。**\n$b_n$ 的公式是：\n$$\nb_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\sin(nx) \\, dx = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x \\sin(nx) \\, dx\n$$\n被积函数是一个奇函数（$x$）和一个奇函数（$\\sin(nx)$）的乘积。两个奇函数的乘积是偶函数。对于一个偶函数 $g(x)$，其在对称区间上的积分为 $\\int_{-a}^{a} g(x) dx = 2\\int_{0}^{a} g(x) dx$。\n$$\nb_n = \\frac{2}{\\pi} \\int_{0}^{\\pi} x \\sin(nx) \\, dx\n$$\n我们使用分部积分法，$\\int u \\, dv = uv - \\int v \\, du$。令 $u = x$ 和 $dv = \\sin(nx) \\, dx$。则 $du = dx$ 且 $v = -\\frac{1}{n}\\cos(nx)$。\n$$\n\\int x \\sin(nx) \\, dx = x \\left(-\\frac{\\cos(nx)}{n}\\right) - \\int \\left(-\\frac{\\cos(nx)}{n}\\right) \\, dx = -\\frac{x\\cos(nx)}{n} + \\frac{1}{n} \\int \\cos(nx) \\, dx\n$$\n$$\n= -\\frac{x\\cos(nx)}{n} + \\frac{\\sin(nx)}{n^2}\n$$\n现在，我们计算这个定积分：\n$$\nb_n = \\frac{2}{\\pi} \\left[ -\\frac{x\\cos(nx)}{n} + \\frac{\\sin(nx)}{n^2} \\right]_{0}^{\\pi}\n$$\n$$\nb_n = \\frac{2}{\\pi} \\left( \\left( -\\frac{\\pi\\cos(n\\pi)}{n} + \\frac{\\sin(n\\pi)}{n^2} \\right) - \\left( 0 + 0 \\right) \\right)\n$$\n我们知道对于任意整数 $n$，$\\sin(n\\pi) = 0$ 且 $\\cos(n\\pi) = (-1)^n$。\n$$\nb_n = \\frac{2}{\\pi} \\left( -\\frac{\\pi(-1)^n}{n} \\right) = -\\frac{2(-1)^n}{n} = \\frac{2(-1)(-1)^n}{n} = \\frac{2(-1)^{n+1}}{n}\n$$\n\n**第4步：组合傅里叶级数。**\n将系数代入级数公式：\n$$\nf(x) \\sim \\frac{0}{2} + \\sum_{n=1}^{\\infty} \\left[ 0 \\cdot \\cos(nx) + \\frac{2(-1)^{n+1}}{n} \\sin(nx) \\right]\n$$\n$$\nf(x) \\sim \\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nx)\n$$\n这可以写成：\n$$\nf(x) \\sim 2 \\left( \\sin(x) - \\frac{1}{2}\\sin(2x) + \\frac{1}{3}\\sin(3x) - \\frac{1}{4}\\sin(4x) + \\dots \\right)\n$$\n所求的傅里叶级数是最终组合的表达式。",
            "answer": "$$\n\\boxed{\\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nx)}\n$$"
        },
        {
            "introduction": "在掌握了基本计算之后，我们来探讨一个更深层的概念：信号的平滑度与其傅里叶系数衰减率之间的关系。这个练习通过比较一个连续的三角波和一个不连续的方波，揭示了一个在信号分析中至关重要的原则。理解这一原则有助于我们从神经信号的频谱中推断其时域特征，例如区分平滑的脑电波和尖锐的瞬态事件。",
            "id": "2174854",
            "problem": "在抽象信号分析中，周期性波形的平滑度与其高频谐波分量的振幅衰减速度直接相关。一个“更平滑”的信号，其高频谐波的功率应该更小，这对应于其傅里叶系数的更快衰减。\n\n考虑两个周期均为 $2L$ 的周期性信号。\n\n第一个信号是三角波 $f_T(x)$，在区间 $x \\in [-L, L]$ 上由以下函数定义：\n$$f_T(x) = V_0 \\left(1 - \\frac{|x|}{L}\\right)$$\n并进行周期性延拓。\n\n第二个信号是方波 $f_S(x)$，在区间 $x \\in [-L, L)$ 上由以下函数定义：\n$$f_S(x) = \\begin{cases} -V_0  &\\text{if } -L \\le x < 0 \\\\ V_0  &\\text{if } 0 \\le x < L \\end{cases}$$\n其中 $f_S(0) = f_S(L)=0$，并且也进行周期性延拓。\n\n两个信号都可以用以下形式的傅里叶级数表示：\n$$f(x) \\sim \\frac{a_0}{2} + \\sum_{n=1}^\\infty \\left( a_n \\cos\\left(\\frac{n\\pi x}{L}\\right) + b_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right)$$\n\n令 $|C_T(n)|$ 和 $|C_S(n)|$ 分别表示三角波和方波的非零傅里叶系数的幅值（即 $|a_n|$ 或 $|b_n|$，取决于哪一个不为零），其中 $n \\ge 1$。对于较大的 $n$ 值，这些系数的幅值与 $n^k$ 成正比，其中 $k$ 为某个幂次。下列哪个陈述正确地描述了这种正比关系？\n\nA. $|C_T(n)| \\propto \\frac{1}{n}$ 和 $|C_S(n)| \\propto \\frac{1}{n}$\n\nB. $|C_T(n)| \\propto \\frac{1}{n}$ 和 $|C_S(n)| \\propto \\frac{1}{n^2}$\n\nC. $|C_T(n)| \\propto \\frac{1}{n^2}$ 和 $|C_S(n)| \\propto \\frac{1}{n}$\n\nD. $|C_T(n)| \\propto \\frac{1}{n^2}$ 和 $|C_S(n)| \\propto \\frac{1}{n^2}$\n\nE. $|C_T(n)| \\propto \\frac{1}{n^3}$ 和 $|C_S(n)| \\propto \\frac{1}{n^2}$",
            "solution": "我们分析每个波形在一个长度为 $2L$ 的周期内的傅里叶级数系数，并确定它们在大 $n$ 时的衰减情况。\n\n对于在 $[-L,L]$ 上的三角波 $f_{T}(x) = V_{0}\\left(1 - \\frac{|x|}{L}\\right)$，注意到 $f_{T}$ 是偶函数，因此所有正弦系数 $b_{n}$ 都为零，只有余弦系数 $a_{n}$ 可能不为零。余弦系数为\n$$\na_{n} = \\frac{1}{L}\\int_{-L}^{L} f_{T}(x)\\cos\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx = \\frac{2}{L}\\int_{0}^{L} V_{0}\\left(1 - \\frac{x}{L}\\right)\\cos\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx.\n$$\n令 $\\alpha = \\frac{n\\pi}{L}$。那么\n$$\n\\int_{0}^{L}\\left(1 - \\frac{x}{L}\\right)\\cos(\\alpha x)\\,dx = \\int_{0}^{L}\\cos(\\alpha x)\\,dx - \\frac{1}{L}\\int_{0}^{L}x\\cos(\\alpha x)\\,dx.\n$$\n使用\n$$\n\\int_{0}^{L}\\cos(\\alpha x)\\,dx = \\frac{\\sin(\\alpha L)}{\\alpha} \\quad\\text{和}\\quad \\int_{0}^{L}x\\cos(\\alpha x)\\,dx = \\left[\\frac{x\\sin(\\alpha x)}{\\alpha} + \\frac{\\cos(\\alpha x)}{\\alpha^{2}}\\right]_{0}^{L},\n$$\n其中 $\\sin(\\alpha L)=\\sin(n\\pi)=0$ 且 $\\cos(\\alpha L)=\\cos(n\\pi)=(-1)^{n}$，我们得到\n$$\n\\int_{0}^{L}\\left(1 - \\frac{x}{L}\\right)\\cos(\\alpha x)\\,dx = 0 - \\frac{1}{L}\\left(\\frac{(-1)^{n}}{\\alpha^{2}} - \\frac{1}{\\alpha^{2}}\\right) = \\frac{1 - (-1)^{n}}{L\\alpha^{2}}.\n$$\n因此，\n$$\na_{n} = \\frac{2V_{0}}{L}\\cdot \\frac{1 - (-1)^{n}}{L\\alpha^{2}} = \\frac{2V_{0}}{L^{2}}\\cdot \\frac{1 - (-1)^{n}}{\\alpha^{2}} = \\frac{2V_{0}}{L^{2}}\\cdot \\frac{1 - (-1)^{n}}{(n\\pi/L)^{2}} = \\frac{2V_{0}}{\\pi^{2}n^{2}}\\left(1 - (-1)^{n}\\right).\n$$\n当 $n$ 为偶数时，此式为零；当 $n$ 为奇数时，等于 $\\frac{4V_{0}}{\\pi^{2}n^{2}}$。因此，对于较大的 $n$，非零系数满足 $|C_{T}(n)| \\propto n^{-2}$。\n\n对于方波 $f_{S}(x)$，其定义为当 $-L  x  0$ 时为 $-V_0$，当 $0  x  L$ 时为 $V_0$。这是一个奇函数，所以所有的余弦系数 $a_n$ 都为零。我们只需要计算正弦系数 $b_n$：\n$$\nb_n = \\frac{1}{L} \\int_{-L}^{L} f_S(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{2}{L} \\int_{0}^{L} V_0 \\sin\\left(\\frac{n\\pi x}{L}\\right) dx\n$$\n$$\n= \\frac{2V_0}{L} \\left[ -\\frac{L}{n\\pi} \\cos\\left(\\frac{n\\pi x}{L}\\right) \\right]_0^L = -\\frac{2V_0}{n\\pi} \\left( \\cos(n\\pi) - \\cos(0) \\right)\n$$\n$$\n= -\\frac{2V_0}{n\\pi} ((-1)^n - 1) = \\frac{2V_0}{n\\pi} (1 - (-1)^n)\n$$\n当 $n$ 为偶数时，$b_n=0$；当 $n$ 为奇数时，$b_n = \\frac{4V_0}{n\\pi}$。因此，对于较大的 $n$，非零系数满足 $|C_S(n)| \\propto n^{-1}$。\n\n综上所述，三角波的傅里叶系数以 $1/n^2$ 的速度衰减，而方波的系数以 $1/n$ 的速度衰减。这与我们的直觉相符：更平滑的三角波具有衰减更快的高频分量。因此，正确答案是 C。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "理论与实践的结合是神经数据分析的核心。当使用有限数量的谐波来重建一个信号时，会出现一种名为吉布斯现象（Gibbs phenomenon）的典型伪影。这个计算练习要求你不仅要推导方波的傅里叶级数，还要通过编程来量化其在不连续点附近的过冲（overshoot），并验证其如何收敛到一个理论常数。这项实践对于任何使用傅里叶方法分析真实世界数据的研究者来说，都是一次宝贵的经验。",
            "id": "3132915",
            "problem": "考虑一个 $2\\pi$-周期函数 $f(x)=\\mathrm{sgn}(\\sin x)$，其定义为当 $x\\in(0,\\pi)$ 时 $f(x)=+1$，当 $x\\in(-\\pi,0)$ 时 $f(x)=-1$，并进行周期性延拓，约定在傅里叶分析中不需要跳变点处的值。从 $2\\pi$-周期函数 $f$ 的傅里叶级数基本定义出发，\n$$a_0=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\,dx,\\quad a_n=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\cos(nx)\\,dx,\\quad b_n=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\sin(nx)\\,dx,$$\n推导其正弦级数系数，并为 $f(x)$ 构建包含 $N$ 项奇次谐波的部分和 $S_N(x)$，其中 $N$ 表示保留的奇次谐波的数量。角度必须使用弧度制。仅使用这些基本定义来获得 $S_N(x)$；不要假定任何预先给定的傅里叶系数公式。\n\n对于给定的 $N$，将在 $x=0$ 跳变点附近的吉布斯过冲比定义为\n$$r_N=\\frac{\\max_{x\\in(0,\\pi)} S_N(x)-f(0^+)}{\\Delta f},$$\n其中 $f(0^+)=+1$ 是在跳变点处的右极限，$\\Delta f= f(0^+)-f(0^-)=2$ 是跳跃幅度。通过在区间 $(0,\\pi/2)$ 内定位 $S_N(x)$ 的第一个局部最大值来数值估计 $r_N$；一个稳健的方法是在一个粗糙网格上评估 $S_N(x)$ 以框定第一个局部最大值，然后在此框定范围内的更密集子网格上进行精细搜索。数值验证当 $N\\to\\infty$ 时，$r_N$ 接近已知的吉布斯极限过冲常数 $\\approx 0.08949$。\n\n你的程序必须：\n- 根据推导出的傅里叶系数，仅使用奇次谐波构建 $S_N(x)$。\n- 通过两阶段网格搜索（先粗略框定，再局部精细化）在 $(0,\\pi/2)$ 区间内找到 $S_N(x)$ 的第一个局部最大值。\n- 使用上述定义计算 $r_N$，角度采用弧度制。\n\n测试集：\n- 使用 $N\\in\\{1,3,25,200\\}$ 来探究少量、中等和大量谐波的情况，包括边界行为（$N=1$）和近渐近行为（$N=200$）。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[r_1,r_3,r_{25},r_{200},\\text{is\\_close}]$。$r_N$ 的值必须四舍五入到 $5$ 位小数。最后一项 $\\text{is\\_close}$ 必须是一个布尔值，表示 $|r_{200}-0.08949|\\leq 5\\times 10^{-4}$ 是否成立。例如，输出必须看起来像 $[0.12345,0.06789,0.09123,0.08949,True]$。",
            "solution": "用户提供的问题是一个在傅里叶分析领域中，表述清晰且具有科学依据的练习，具体涉及方波的吉布斯现象。所有的定义和常数都是标准且正确的。任务是推导傅里叶级数，实现部分和，并数值研究过冲现象。该问题是有效的，将提供一个解决方案。\n\n问题要求分析 $2\\pi$-周期函数 $f(x) = \\mathrm{sgn}(\\sin x)$。该函数定义为当 $x \\in (0, \\pi)$ 时 $f(x)=+1$，当 $x \\in (-\\pi, 0)$ 时 $f(x)=-1$。\n\n首先，我们使用提供的积分定义来确定傅里叶系数 $a_0$、$a_n$ 和 $b_n$。我们从分析 $f(x)$ 的对称性开始。该函数是奇函数，因为对于任何 $x$，$f(-x) = \\mathrm{sgn}(\\sin(-x)) = \\mathrm{sgn}(-\\sin x) = -\\mathrm{sgn}(\\sin x) = -f(x)$。奇函数的傅里叶级数简化为纯正弦级数，这意味着所有的余弦系数，$a_0$ 和 $a_n$，都必须为零。我们将明确地验证这一点。\n\n系数 $a_0$ 由下式给出：\n$$a_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\, dx = \\frac{1}{\\pi} \\left( \\int_{-\\pi}^{0} (-1) \\, dx + \\int_{0}^{\\pi} (+1) \\, dx \\right)$$\n$$a_0 = \\frac{1}{\\pi} \\left( [-x]_{-\\pi}^{0} + [x]_{0}^{\\pi} \\right) = \\frac{1}{\\pi} \\left( (-(0) - (-(-\\pi))) + ((\\pi) - (0)) \\right) = \\frac{1}{\\pi} (-\\pi + \\pi) = 0$$\n\n对于 $n \\ge 1$ 的系数 $a_n$ 由下式给出：\n$$a_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\cos(nx) \\, dx$$\n被积函数是一个奇函数 $f(x)$ 和一个偶函数 $\\cos(nx)$ 的乘积。其结果是一个奇函数。任何奇函数在对称区间如 $[-\\pi, \\pi]$ 上的积分都为零。因此，对于所有 $n \\ge 1$，$a_n=0$。\n\n对于 $n \\ge 1$ 的正弦系数 $b_n$ 由下式给出：\n$$b_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\sin(nx) \\, dx$$\n被积函数是两个奇函数 $f(x)$ 和 $\\sin(nx)$ 的乘积。其乘积是一个偶函数。偶函数在对称区间 $[-\\pi, \\pi]$ 上的积分等于其在半区间 $[0, \\pi]$ 上积分的两倍。\n$$b_n = \\frac{2}{\\pi} \\int_{0}^{\\pi} f(x) \\sin(nx) \\, dx$$\n当 $x \\in (0, \\pi)$ 时，我们有 $f(x)=+1$。\n$$b_n = \\frac{2}{\\pi} \\int_{0}^{\\pi} (1) \\sin(nx) \\, dx = \\frac{2}{\\pi} \\left[ -\\frac{\\cos(nx)}{n} \\right]_{0}^{\\pi}$$\n$$b_n = -\\frac{2}{n\\pi} [\\cos(n\\pi) - \\cos(0)] = \\frac{2}{n\\pi} (1 - \\cos(n\\pi))$$\n由于 $\\cos(n\\pi) = (-1)^n$，该表达式变为：\n$$b_n = \\frac{2}{n\\pi} (1 - (-1)^n)$$\n这个结果意味着如果 $n$ 是偶数（例如，$n=2k$），$b_{2k} = \\frac{2}{2k\\pi} (1 - 1) = 0$。如果 $n$ 是奇数（例如，$n=2k-1$，$k=1, 2, \\dots$），$b_{2k-1} = \\frac{2}{(2k-1)\\pi} (1 - (-1)) = \\frac{4}{(2k-1)\\pi}$。\n\n问题将部分和 $S_N(x)$ 定义为保留前 $N$ 个奇次谐波。这对应于对 $k=1, \\dots, N$ 的项求和。所得的部分和为：\n$$S_N(x) = \\sum_{k=1}^{N} b_{2k-1} \\sin((2k-1)x) = \\sum_{k=1}^{N} \\frac{4}{(2k-1)\\pi} \\sin((2k-1)x)$$\n$$S_N(x) = \\frac{4}{\\pi} \\sum_{k=1}^{N} \\frac{\\sin((2k-1)x)}{2k-1}$$\n\n接下来，我们处理吉布斯过冲比 $r_N$。它被定义为：\n$$r_N = \\frac{\\max_{x\\in(0,\\pi)} S_N(x) - f(0^+)}{\\Delta f}$$\n使用给定值 $f(0^+) = 1$ 和跳跃幅度 $\\Delta f = f(0^+) - f(0^-) = 1 - (-1) = 2$，该公式变为：\n$$r_N = \\frac{\\max_{x\\in(0,\\pi)} S_N(x) - 1}{2}$$\n为了找到 $S_N(x)$ 的最大值，我们必须在区间 $(0, \\pi/2)$ 内找到其第一个峰值的位置。解析地，该点可以通过求解 $S_N'(x)=0$ 找到。其导数为：\n$$S_N'(x) = \\frac{d}{dx} \\left( \\frac{4}{\\pi} \\sum_{k=1}^{N} \\frac{\\sin((2k-1)x)}{2k-1} \\right) = \\frac{4}{\\pi} \\sum_{k=1}^{N} \\cos((2k-1)x)$$\n使用三角恒等式 $\\sum_{k=1}^{N} \\cos((2k-1)x) = \\frac{\\sin(2Nx)}{2\\sin x}$，我们有：\n$$S_N'(x) = \\frac{4}{\\pi} \\frac{\\sin(2Nx)}{2\\sin x} = \\frac{2 \\sin(2Nx)}{\\pi \\sin x}$$\n$S_N'(x)=0$ 的第一个正根出现在 $2Nx = \\pi$ 时，因此 $x_{\\text{max}} = \\frac{\\pi}{2N}$。问题所规定的数值程序——一个两阶段的网格搜索——将被用来近似这个最大值。首先，在 $(0, \\pi/2)$ 上进行粗略网格搜索，以确定最大值周围的一个狭窄区间。其次，在该区间内进行精细网格搜索，以高精度定位 $S_N(x)$ 的最大值。\n\n提供的Python代码将为指定的 $N \\in \\{1, 3, 25, 200\\}$ 值实现此逻辑，计算 $r_N$，并验证 $r_{200}$ 对已知吉布斯常数的渐近收敛性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef s_n(x_vals, N):\n    \"\"\"\n    Calculates the N-term odd-harmonic partial sum of the Fourier series for sgn(sin(x)).\n    \n    Args:\n        x_vals (np.ndarray): An array of x values (in radians) at which to evaluate the sum.\n        N (int): The number of odd harmonics to include in the sum.\n        \n    Returns:\n        np.ndarray: The values of S_N(x) corresponding to each x in x_vals.\n    \"\"\"\n    # The sum is over k=1 to N for harmonics n=2k-1.\n    k = np.arange(1, N + 1)\n    n_harmonics = 2 * k - 1\n    \n    # Use broadcasting for an efficient vectorized calculation.\n    # x_vals shape: (M,) -> (M, 1)\n    # n_harmonics shape: (N,)\n    # Resulting shape of arg: (M, N)\n    x_col = x_vals[:, np.newaxis]\n    arg = x_col * n_harmonics\n    \n    # Perform the summation\n    terms = np.sin(arg) / n_harmonics\n    sum_val = np.sum(terms, axis=1)\n    \n    return (4 / np.pi) * sum_val\n\ndef calculate_r(N):\n    \"\"\"\n    Numerically estimates the Gibbs overshoot ratio r_N for a given N.\n\n    Args:\n        N (int): The number of odd harmonics.\n\n    Returns:\n        float: The estimated value of r_N.\n    \"\"\"\n    # Stage 1: Coarse grid search to bracket the first maximum in (0, pi/2).\n    # We use a small positive number for the start of the interval to avoid x=0.\n    coarse_grid = np.linspace(1e-9, np.pi / 2, 2000)\n    s_coarse = s_n(coarse_grid, N)\n    idx_max_coarse = np.argmax(s_coarse)\n\n    # Define the search bracket for the fine grid. Handle edge cases.\n    if idx_max_coarse == 0:\n        bracket_start = coarse_grid[0]\n        bracket_end = coarse_grid[1]\n    elif idx_max_coarse == len(coarse_grid) - 1:\n        bracket_start = coarse_grid[-2]\n        bracket_end = coarse_grid[-1]\n    else:\n        bracket_start = coarse_grid[idx_max_coarse - 1]\n        bracket_end = coarse_grid[idx_max_coarse + 1]\n\n    # Stage 2: Fine grid search within the bracket to find the maximum value.\n    fine_grid = np.linspace(bracket_start, bracket_end, 10000)\n    s_fine = s_n(fine_grid, N)\n    s_max = np.max(s_fine)\n\n    # Calculate the Gibbs overshoot ratio r_N.\n    # f(0^+) = 1.0, Delta_f = f(0^+) - f(0^-) = 1 - (-1) = 2.0\n    f0_plus = 1.0\n    delta_f = 2.0\n    r_N = (s_max - f0_plus) / delta_f\n    \n    return r_N\n\ndef solve():\n    \"\"\"\n    Main function to execute the problem, calculate r_N for the test suite,\n    and print the final results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [1, 3, 25, 200]\n\n    results = []\n    for N in test_cases:\n        r_val = calculate_r(N)\n        results.append(r_val)\n\n    # Format the r_N values to 5 decimal places.\n    formatted_results = [f\"{r:.5f}\" for r in results]\n    \n    # Check if r_200 is close to the theoretical Gibbs constant.\n    gibbs_constant = 0.08949\n    tolerance = 5e-4\n    r_200 = results[-1]\n    is_close = abs(r_200 - gibbs_constant) = tolerance\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)},{is_close}]\")\n\nsolve()\n```"
        }
    ]
}