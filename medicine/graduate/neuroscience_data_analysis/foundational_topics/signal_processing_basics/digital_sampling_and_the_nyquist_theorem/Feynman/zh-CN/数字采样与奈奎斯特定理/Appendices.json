{
    "hands_on_practices": [
        {
            "introduction": "在数字信号处理中，混叠是必须避免的一个基本陷阱。当采样率不足以捕捉信号中的高频成分时，这些高频信号会“伪装”成低频信号，从而污染我们的数据。通过这个实践练习 ()，你将从第一性原理出发，推导频率折叠现象，并亲手计算在一个典型的神经科学场景中，一个高于奈奎斯特频率的干扰信号所产生的混叠频率。",
            "id": "4156321",
            "problem": "在一次颅内电生理实验中，一个频率为 $f_{0} = 900\\,\\mathrm{Hz}$ 的窄带伪影污染了局部场电位 (LFP) 记录。该时间序列以 $f_{s} = 1\\,\\mathrm{kHz}$ 的速率进行均匀采样数字化，采样前未进行有效的抗混叠滤波。您随后在基带区间 $[0, f_{s}/2]$ 内分析采样后的数据。\n\n请利用神经科学数据分析中与数字采样和重建相关的第一性原理，从连续时间正弦波表示和采样算子的定义出发，并结合“采样会在采样率的整数倍处产生频谱复制”这一公认事实进行分析。以此为基础，推导说明在离散时间中频率如何以 $f_{s}$ 为模变得不可区分，并解释向可观测基带的折叠现象是如何产生的。特别是，请通过一个显式的以 $f_{s}$ 为模的折叠论证来证明所观察到的混叠现象，阐明为什么以及如何将高于 $f_{s}/2$ 的频率分量映射到 $[0, f_{s}/2]$ 区间内。\n\n当采样率 $f_{s} = 1\\,\\mathrm{kHz}$ 时，计算在采样数据中可观察到的由 $f_{0} = 900\\,\\mathrm{Hz}$ 污染信号产生的混叠频率。请将最终答案表示为一个以赫兹 (Hz) 为单位的实数。无需四舍五入，给出精确值。",
            "solution": "该问题要求计算因连续时间信号欠采样而产生的混叠频率，这是包括神经科学在内的数字数据采集中常见的问题。问题的核心在于奈奎斯特-香农采样定理，该定理规定，要完美重建一个带限信号，采样频率 $f_s$ 必须严格大于信号中最大频率 $f_{max}$ 的两倍，即 $f_s  2f_{max}$。在本问题中，一个频率为 $f_0 = 900\\,\\mathrm{Hz}$ 的信号分量以 $f_s = 1\\,\\mathrm{kHz} = 1000\\,\\mathrm{Hz}$ 的速率被采样。奈奎斯特频率，即可以被无歧义表示的最高频率，为 $f_{Nyquist} = f_s/2 = 500\\,\\mathrm{Hz}$。由于 $f_0  f_{Nyquist}$，采样准则被违反，从而导致混叠。我们将从第一性原理出发，推导观察到的混叠频率。\n\n设连续时间伪影信号由一个正弦波表示：\n$$x(t) = A \\cos(2\\pi f_0 t + \\phi)$$\n其中 $A$ 是振幅，$f_0 = 900\\,\\mathrm{Hz}$ 是频率，$\\phi$ 是相位。\n\n均匀采样是在离散、等间隔的时间点上测量此连续信号值的过程。这可以建模为将信号 $x(t)$ 与一个无穷狄拉克$\\delta$函数序列（即采样函数 $s(t)$）相乘，定义如下：\n$$s(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s)$$\n其中 $T_s = 1/f_s$ 是采样周期。在本例中，$T_s = 1/1000\\,\\mathrm{s}$。\n\n采样后信号 $x_s(t)$ 是 $x(t)s(t)$ 的乘积：\n$$x_s(t) = x(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT_s) = \\sum_{n=-\\infty}^{\\infty} x(nT_s) \\delta(t - nT_s)$$\n结果是一个脉冲序列，其中每个脉冲的强度等于原始信号在相应时间瞬间的值。数字系统将这些值存储为一个离散时间序列，记为 $x[n]$：\n$$x[n] = x(t)|_{t=nT_s} = A \\cos(2\\pi f_0 nT_s + \\phi)$$\n代入 $T_s = 1/f_s$，我们得到：\n$$x[n] = A \\cos\\left(2\\pi \\frac{f_0}{f_s} n + \\phi\\right)$$\n这个方程揭示了离散时间信号中频率的根本性质。考虑另一个频率为 $f' = f_0 + k f_s$（其中 $k$ 为任意非零整数）的连续时间信号 $y(t)$。以相同的采样率 $f_s$ 对其进行采样，其离散时间表示 $y[n]$ 将是：\n$$y[n] = A \\cos\\left(2\\pi \\frac{f_0 + kf_s}{f_s} n + \\phi\\right) = A \\cos\\left(2\\pi \\frac{f_0}{f_s} n + 2\\pi k n + \\phi\\right)$$\n由于 $k$ 和 $n$ 都是整数，$2\\pi k n$ 是 $2\\pi$ 的整数倍。余弦函数是以 $2\\pi$ 为周期的函数，因此对于任意整数 $m$，都有 $\\cos(\\theta + 2\\pi m) = \\cos(\\theta)$。所以，\n$$y[n] = A \\cos\\left(2\\pi \\frac{f_0}{f_s} n + \\phi\\right) = x[n]$$\n这表明采样之后，对于一族连续时间频率 $f_0 + k f_s$（$k$ 为所有整数），其离散序列 $x[n]$ 是完全相同的。采样过程使得这些频率变得不可区分。所有的连续频率都被映射到一个主频率区间，通常选择为 $[-f_s/2, f_s/2)$。\n\n这种不可区分性也可以在频域中理解。采样函数 $s(t)$ 的傅里叶变换是另一个脉冲序列：\n$$\\mathcal{F}\\{s(t)\\} = S(f) = f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s)$$\n时域中的乘法对应于频域中的卷积。因此，采样后信号的频谱 $X_s(f)$ 是原始信号频谱 $X(f)$ 与 $S(f)$ 的卷积：\n$$X_s(f) = X(f) * S(f) = X(f) * \\left( f_s \\sum_{k=-\\infty}^{\\infty} \\delta(f - kf_s) \\right) = f_s \\sum_{k=-\\infty}^{\\infty} X(f - kf_s)$$\n这表明采样后信号的频谱由原始频谱 $X(f)$ 的无穷多个副本组成，这些副本按 $f_s$ 比例缩放，并平移至以采样频率的每个整数倍 $kf_s$ 为中心。\n原始信号 $x(t) = A \\cos(2\\pi f_0 t + \\phi)$ 在频率 $\\pm f_0$ 处有频谱分量（狄拉克$\\delta$函数）。采样过程在所有整数 $k$ 对应的 $\\pm f_0 + k f_s$ 处创建了这些分量的副本。\n\n对采样数据的分析是在基带区间内进行的，对于实值信号，该区间通常是 $[0, f_s/2]$。一个理想的重建系统（或像快速傅里叶变换这样的数字频谱分析仪）只观察这个频带内的频率。任何落入主区间 $[-f_s/2, f_s/2)$ 的副本频谱能量，都将被解释为源自该区间内的一个频率。\n\n对于给定的参数 $f_0 = 900\\,\\mathrm{Hz}$ 和 $f_s = 1000\\,\\mathrm{Hz}$，奈奎斯特频率为 $f_{Nyquist} = f_s/2 = 500\\,\\mathrm{Hz}$。分析区间是 $[0, 500]\\,\\mathrm{Hz}$。\n原始频率分量 $f_0 = 900\\,\\mathrm{Hz}$ 在此区间之外。我们必须找到一个整数 $k$，使得它的一个混叠频率 $\\pm f_0 + k f_s$ 落入主区间 $[-500, 500]\\,\\mathrm{Hz}$。\n让我们检查正频率分量 $+f_0$ 的混叠：\n- 当 $k = 0$ 时，频率是 $900\\,\\mathrm{Hz}$，在 $[-500, 500]\\,\\mathrm{Hz}$ 之外。\n- 当 $k = -1$ 时，频率是 $f_0 - f_s = 900 - 1000 = -100\\,\\mathrm{Hz}$。这落在 $[-500, 500]\\,\\mathrm{Hz}$ 之内。\n让我们检查负频率分量 $-f_0$ 的混叠：\n- 当 $k = 1$ 时，频率是 $-f_0 + f_s = -900 + 1000 = 100\\,\\mathrm{Hz}$。这也落在 $[-500, 500]\\,\\mathrm{Hz}$ 之内。\n\n因此，离散时间信号包含对应于连续时间频率 $\\pm 100\\,\\mathrm{Hz}$ 的频谱功率。当在正频率基带 $[0, f_s/2]$（即 $[0, 500]\\,\\mathrm{Hz}$）内分析数据时，观察到的分量将位于 $100\\,\\mathrm{Hz}$。\n\n这个过程通常被形象地看作是频率轴的“折叠”。在 $[f_s/2, f_s]$ 频带内，即 $[500, 1000]\\,\\mathrm{Hz}$ 的频率，会被折叠回基带。这个范围内的频率 $f$ 将会以混叠频率 $f_{alias} = f_s - f$ 出现。\n我们的信号频率 $f_0 = 900\\,\\mathrm{Hz}$ 位于这第一个混叠频带内。因此，其观察到的频率是：\n$$f_{alias} = f_s - f_0 = 1000\\,\\mathrm{Hz} - 900\\,\\mathrm{Hz} = 100\\,\\mathrm{Hz}$$\n这证实了从频谱复制论证得到的结果。这个 $900\\,\\mathrm{Hz}$ 的污染伪影将在采样数据中被错误地观察为一个 $100\\,\\mathrm{Hz}$ 的信号。",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "满足奈奎斯特采样定理只是确保信号不失真的第一步；在实际分析中，我们常常需要区分频率相近的多个振荡成分。信号的频率分辨率不仅取决于采样率$f_{s}$，更关键地取决于观测时长（即样本数$N$）以及所使用的窗函数。这项实践练习 () 将理论与频谱分析实践相结合，指导你如何计算达到特定频率分辨率所需的最小数据长度，这对于设计实验和正确解读傅里叶分析结果至关重要。",
            "id": "4156319",
            "problem": "为了对低频振荡进行频谱分析，以采样频率 $f_{s}$ 对一段海马区局部场电位 (LFP) 记录进行均匀采样。你需要估计一个长度为 $N$ 个样本的单个连续数据段的频谱，方法是在计算周期图之前，在时域上应用汉宁窗（Hann window，也称 Hanning window）。假设存在两个在 theta 波段附近、振幅近似相等的窄带振荡分量，其中心频率为 $f_{1}$ 和 $f_{2}$，满足 $|f_{2}-f_{1}| = \\Delta f_{\\mathrm{desired}}$。假设两个分量的频率都远低于奈奎斯特频率，因此采样不会引起混叠。\n\n从加窗序列的离散时间傅里叶变换 (DTFT) 的定义和已知的汉宁窗时域公式 $w[n] = \\tfrac{1}{2} - \\tfrac{1}{2}\\cos\\!\\left(\\tfrac{2\\pi n}{N-1}\\right)$ (其中 $0 \\le n \\le N-1$) 出发，推导出一个关于 $N$ 的准则，以保证这两个音调在该窗下是瑞利可分辨的。分辨的条件解释为：一个音调的谱峰落在另一个音调的加窗谱主瓣的第一个谱零点处（或更远位置）。使用此准则计算在以下条件下所需的最小整数 $N$：\n- 采样频率为 $f_{s} = 2048 \\ \\mathrm{Hz}$，\n- 期望的可分辨间隔为 $\\Delta f_{\\mathrm{desired}} = 0.25 \\ \\mathrm{Hz}$。\n\n假设在观测期间，这两个音调足够窄带且平稳，因此可分辨性由窗的频谱特性决定。将你的最终答案表示为满足该准则的最小整数样本数 $N$。$N$ 不带单位。",
            "solution": "该问题要求确定使用汉宁窗周期图法来分辨局部场电位 (LFP) 记录中两个间隔很近的正弦分量所需的最小样本数 $N$。分辨准则已明确定义：如果一个分量的谱峰位于另一个分量谱的第一个零点或其更远的位置，则认为这两个分量是可分辨的。\n\n设两个正弦分量的连续时间频率为 $f_1$ 和 $f_2$，频率间隔为 $\\Delta f = |f_2 - f_1|$。由于信号以频率 $f_s$ 进行采样，相应的离散时间频率为 $\\omega_1 = 2\\pi f_1 / f_s$ 和 $\\omega_2 = 2\\pi f_2 / f_s$。离散频率间隔为 $\\Delta \\omega = |\\omega_2 - \\omega_1| = 2\\pi \\Delta f / f_s$。\n\n时域加窗的过程对应于频域卷积。加窗信号的离散时间傅里叶变换 (DTFT) 是原始信号的 DTFT 与窗函数 DTFT 的卷积。对于一个由两个纯正弦波组成的信号，其 DTFT 包含位于 $\\pm \\omega_1$ 和 $\\pm \\omega_2$ 的两对狄拉克δ函数。因此，加窗信号的最终频谱是两个经过缩放和平移的窗函数频谱的叠加，分别以这些频率为中心。\n\n区分这两个谱峰的能力取决于窗函数频谱主瓣的宽度，记为 $W(\\omega)$。题目指定了瑞利分辨准则，这意味着频率间隔 $\\Delta f$ 必须至少等于窗函数频谱中心峰到其第一个零点的距离。我们将这个最小可分辨频率间隔表示为 $\\Delta f_{\\text{res}}$。因此，条件是 $\\Delta f \\ge \\Delta f_{\\text{res}}$。\n\n我们的首要任务是确定长度为 $N$ 的汉宁窗的 $\\Delta f_{\\text{res}}$。题目给出了汉宁窗在时域的定义，对于 $n \\in \\{0, 1, \\dots, N-1\\}$：\n$$w[n] = \\frac{1}{2} - \\frac{1}{2}\\cos\\left(\\frac{2\\pi n}{N-1}\\right)$$\n$w[n]$ 的 DTFT 可以通过使用欧拉公式表示余弦来求得：\n$$w[n] = \\frac{1}{2} - \\frac{1}{4}\\exp\\left(j\\frac{2\\pi n}{N-1}\\right) - \\frac{1}{4}\\exp\\left(-j\\frac{2\\pi n}{N-1}\\right)$$\n$w[n]$ 的 DTFT 是其三个非周期分量 DTFT 的和。每个分量都是一个有限长度的复指数，其 DTFT 是一个移位的狄利克雷核。这种构造产生的光谱主瓣比相同长度的矩形窗的主瓣宽得多，但旁瓣电平要低得多。\n\n对于长度为 $N$ 的矩形窗，其 DTFT 的第一个零点出现在距离主峰的数字频率偏移为 $\\Delta \\omega = 2\\pi/N$ 处。这对应于模拟频率偏移 $\\Delta f = f_s/N$。\n\n在谱分析中，一个标准结论是，汉宁窗的主瓣宽度（测量峰值两侧第一个零点之间的距离）大约是相同长度 $N$ 的矩形窗主瓣宽度的两倍。因此，汉宁窗从中心峰到第一个零点的距离是矩形窗的两倍。\n因此，汉宁窗的最小可分辨频率间隔为：\n$$\\Delta f_{\\text{res}} = 2 \\times \\left(\\frac{f_s}{N}\\right) = \\frac{2f_s}{N}$$\n\n根据题目的分辨准则，期望的频率间隔 $\\Delta f_{\\mathrm{desired}}$ 必须大于或等于这个最小可分辨间隔：\n$$\\Delta f_{\\mathrm{desired}} \\ge \\frac{2f_s}{N}$$\n我们必须找到满足此条件的最小整数 $N$。重新整理不等式以求解 $N$，我们得到：\n$$N \\ge \\frac{2f_s}{\\Delta f_{\\mathrm{desired}}}$$\n\n现在，我们将给定值代入此不等式：\n- 采样频率 $f_s = 2048 \\ \\mathrm{Hz}$。\n- 期望的可分辨间隔 $\\Delta f_{\\mathrm{desired}} = 0.25 \\ \\mathrm{Hz}$。\n\n$$N \\ge \\frac{2 \\times 2048}{0.25}$$\n$$N \\ge \\frac{4096}{0.25}$$\n$$N \\ge 4096 \\times 4$$\n$$N \\ge 16384$$\n\n满足此条件的最小整数样本数 $N$ 是 $16384$。这代表记录时长为 $T = N/f_s = 16384 / 2048 = 8$ 秒。",
            "answer": "$$\\boxed{16384}$$"
        },
        {
            "introduction": "我们之前的讨论都基于理想的、完全规则的采样过程。然而，现实世界的硬件总存在瑕疵，其中采样时钟的微小随机波动（称为“抖动”）是一个重要因素。这项练习 () 将带你探索这种时序不确定性如何直接影响数据的质量，特别是对于基于相位的分析。你将从基本原理推导出信号频率、时钟抖动与相位噪声之间的关系，并计算在严格的相位精度约束下，数据采集系统所能容忍的最大抖动是多少。",
            "id": "4156307",
            "problem": "一个神经科学实验室正在分析局部场电位中频率为 $f_{0} = 400\\,\\mathrm{Hz}$ 的窄带振荡。该信号由一个模数转换器 (ADC) 以 $f_{s} = 4\\,\\mathrm{kHz}$ 的采样率进行数字化，满足带限信号的采样要求。由于采样时钟的不完美性，采样时刻会经历随机的时间偏差，该偏差被建模为零均值的均方根 (RMS) 抖动 $\\sigma_{t}$，它与信号无关且在记录期间是平稳的。分析依赖于对该振荡的精确相位估计；为避免降低基于相位的测量指标（例如，发放相位直方图）的质量，实验室对相位噪声施加了一个界限，该噪声定义为振荡频率下的均方根相位偏差，并要求其不超过 $\\beta_{\\max} = 1.0 \\times 10^{-4}\\,\\mathrm{rad}$。假设该振荡在 $f_{0}$ 附近可以局部近似为纯正弦波，且时间抖动足够小，足以支持线性相位误差传播的假设，请从第一性原理出发，推导满足该相位噪声约束的最大允许均方根抖动 $\\sigma_{t,\\max}$。请以纳秒为单位表示您的最终答案，并四舍五入到三位有效数字。",
            "solution": "我们首先对感兴趣的信号进行建模。问题陈述该振荡可以近似为频率为 $f_0$ 的纯正弦波。这样的信号 $s(t)$可以写成：\n$$s(t) = A \\cos(2\\pi f_0 t + \\phi_i)$$\n其中 $A$ 是振幅，$\\phi_i$ 是任意的初始相位。信号在时间 $t$ 的总相位为：\n$$\\phi(t) = 2\\pi f_0 t + \\phi_i$$\n振荡的角频率为 $\\omega_0 = 2\\pi f_0$。因此相位可以写成 $\\phi(t) = \\omega_0 t + \\phi_i$。\n\n时间抖动在采样时刻引入了一个随机误差 $\\delta_t$。采样不是在理想时间 $t$ 进行，而是在实际时间 $t' = t + \\delta_t$ 进行。信号在该实际采样时间的相位是：\n$$\\phi(t') = \\phi(t + \\delta_t) = \\omega_0 (t + \\delta_t) + \\phi_i = \\omega_0 t + \\phi_i + \\omega_0 \\delta_t$$\n相位误差 $\\delta_\\phi$ 是实际采样时间的相位与理想采样时间的相位之差：\n$$\\delta_\\phi = \\phi(t') - \\phi(t) = (\\omega_0 t + \\phi_i + \\omega_0 \\delta_t) - (\\omega_0 t + \\phi_i) = \\omega_0 \\delta_t$$\n这是时间误差 $\\delta_t$ 和相位误差 $\\delta_\\phi$ 之间的线性关系。这个结果对于纯正弦波是精确的，并且与问题中关于线性相位误差传播的假设相符。\n\n问题以其均方根 (RMS) 值 $\\sigma_t$ 来规定抖动。由于抖动是零均值的，其 RMS 值等于其标准差：\n$$\\sigma_t = \\sqrt{E[\\delta_t^2]}$$\n其中 $E[\\cdot]$ 表示期望算子。\n\n相位噪声，用 $\\beta$ 表示，被定义为均方根相位偏差。由于时间抖动 $\\delta_t$ 是一个零均值随机变量，因此产生的相位误差 $\\delta_\\phi = \\omega_0 \\delta_t$ 也是一个零均值随机变量。所以，均方根相位偏差就是其标准差：\n$$\\beta = \\sqrt{E[\\delta_\\phi^2]}$$\n将表达式 $\\delta_\\phi = \\omega_0 \\delta_t$ 代入 $\\beta$ 的方程中：\n$$\\beta = \\sqrt{E[(\\omega_0 \\delta_t)^2]} = \\sqrt{\\omega_0^2 E[\\delta_t^2]} = \\omega_0 \\sqrt{E[\\delta_t^2]}$$\n认识到 $\\sqrt{E[\\delta_t^2]} = \\sigma_t$，我们得到了均方根相位噪声和均方根时间抖动之间的基本关系：\n$$\\beta = \\omega_0 \\sigma_t = 2\\pi f_0 \\sigma_t$$\n实验室的约束要求相位噪声不超过最大值 $\\beta_{\\max}$：\n$$\\beta \\leq \\beta_{\\max}$$\n代入我们推导出的关系：\n$$2\\pi f_0 \\sigma_t \\leq \\beta_{\\max}$$\n最大允许的均方根抖动 $\\sigma_{t,\\max}$，是使此不等式变为等式时的 $\\sigma_t$ 值：\n$$2\\pi f_0 \\sigma_{t,\\max} = \\beta_{\\max}$$\n解出 $\\sigma_{t,\\max}$：\n$$\\sigma_{t,\\max} = \\frac{\\beta_{\\max}}{2\\pi f_0}$$\n给定值为 $f_0 = 400\\,\\mathrm{Hz}$ 和 $\\beta_{\\max} = 1.0 \\times 10^{-4}\\,\\mathrm{rad}$。将这些值代入表达式中：\n$$\\sigma_{t,\\max} = \\frac{1.0 \\times 10^{-4}}{2\\pi (400)} \\,\\mathrm{s} = \\frac{1.0 \\times 10^{-4}}{800\\pi} \\,\\mathrm{s}$$\n现在，我们计算数值：\n$$\\sigma_{t,\\max} \\approx 3.97887357... \\times 10^{-8} \\,\\mathrm{s}$$\n问题要求结果以纳秒 ($1\\,\\mathrm{ns} = 10^{-9}\\,\\mathrm{s}$) 表示，并四舍五入到三位有效数字。\n$$\\sigma_{t,\\max} \\approx (3.97887357... \\times 10^{-8} \\,\\mathrm{s}) \\times \\left(\\frac{10^9 \\,\\mathrm{ns}}{1 \\,\\mathrm{s}}\\right) \\approx 39.7887... \\,\\mathrm{ns}$$\n四舍五入到三位有效数字，我们得到：\n$$\\sigma_{t,\\max} \\approx 39.8 \\,\\mathrm{ns}$$\n按照最终答案格式要求（$a \\times 10^b$ 其中 $1 \\le |a|  10$），将此值用标准科学记数法表示：\n$$39.8 = 3.98 \\times 10^1$$",
            "answer": "$$ \\boxed{3.98 \\times 10^1} $$"
        }
    ]
}