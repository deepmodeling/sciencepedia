{
    "hands_on_practices": [
        {
            "introduction": "Every filter design begins with a fundamental question: how complex must the filter be to meet our performance goals? This practice explores the core trade-offs between passband fidelity, stopband attenuation, and filter order. By working from the first principles of the Butterworth filter response , you will derive the mathematical relationship that governs these trade-offs and calculate the minimum complexity required to satisfy a given set of neurophysiological recording specifications.",
            "id": "4176290",
            "problem": "A neuroengineering team is building an analog anti-aliasing low-pass front-end for extracellular recordings of local field potentials (LFP). The passband is intended to preserve oscillations up to angular frequency $\\omega_p$ with at most an absolute amplitude deviation $\\delta_p$ relative to unit direct current (DC) gain, and the stopband must suppress power at and beyond angular frequency $\\omega_s$ by at least $A_s$ decibels. The filter family is constrained to the classical Butterworth class. Assume a standard continuous-time design and that the passband specification is enforced at $\\omega_p$ and the stopband specification at $\\omega_s$.\n\nYou are given the following specifications:\n- Passband edge: $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$.\n- Stopband edge: $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$.\n- Maximum passband deviation: $\\delta_p = 0.01$ (dimensionless, relative to unit DC gain).\n- Minimum stopband attenuation: $A_s = 60\\,\\mathrm{dB}$.\n\nStarting from the fundamental magnitude response property of Butterworth low-pass filters and the definitions of amplitude tolerance and decibel attenuation, determine the minimum integer filter order $N$ that guarantees both the passband and stopband specifications are simultaneously satisfied.\n\nReport the final answer as a single integer with no units. No rounding instruction is needed beyond selecting the minimal integer $N$ that meets the specifications.",
            "solution": "The problem requires finding the minimum integer order $N$ for a Butterworth low-pass filter that satisfies specific passband and stopband criteria. We begin with the squared magnitude response of an $N$-th order Butterworth low-pass filter with a unit direct current (DC) gain, which is given by:\n$$|H(j\\omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2N}}$$\nHere, $\\omega$ is the angular frequency, $N$ is the filter order, and $\\omega_c$ is the cutoff frequency, defined as the frequency at which the magnitude is attenuated by $3\\,\\mathrm{dB}$.\n\nFirst, we formalize the passband specification. The problem states that in the passband, up to the angular frequency $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$, the magnitude response must have at most an absolute deviation of $\\delta_p = 0.01$ relative to the unit DC gain. This is enforced at the passband edge $\\omega_p$, meaning the magnitude $|H(j\\omega_p)|$ must be at least $1 - \\delta_p$.\n$$|H(j\\omega_p)| \\ge 1 - \\delta_p$$\nTo simplify the algebra, we work with the squared magnitude:\n$$|H(j\\omega_p)|^2 \\ge (1 - \\delta_p)^2$$\nSubstituting the Butterworth response formula:\n$$\\frac{1}{1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}} \\ge (1 - \\delta_p)^2$$\nWe can rearrange this inequality to establish a constraint on the cutoff frequency $\\omega_c$:\n$$1 \\ge (1 - \\delta_p)^2 \\left(1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}\\right)$$\n$$\\frac{1}{(1 - \\delta_p)^2} \\ge 1 + \\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N}$$\n$$\\left(\\frac{\\omega_p}{\\omega_c}\\right)^{2N} \\le \\frac{1}{(1 - \\delta_p)^2} - 1$$\nThis inequality provides a lower bound for $\\omega_c^{2N}$:\n$$\\omega_c^{2N} \\ge \\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1}$$\n\nNext, we formalize the stopband specification. The attenuation in decibels, $A(\\omega)$, is defined as $A(\\omega) = -20 \\log_{10}(|H(j\\omega)|)$. The problem requires a minimum attenuation of $A_s = 60\\,\\mathrm{dB}$ at and beyond the stopband edge $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$. Enforcing this at $\\omega_s$:\n$$A(\\omega_s) \\ge A_s$$\n$$-20 \\log_{10}(|H(j\\omega_s)|) \\ge A_s$$\n$$\\log_{10}(|H(j\\omega_s)|) \\le -\\frac{A_s}{20}$$\n$$|H(j\\omega_s)| \\le 10^{-A_s/20}$$\nWorking with the squared magnitude:\n$$|H(j\\omega_s)|^2 \\le 10^{-A_s/10}$$\nSubstituting the Butterworth response formula:\n$$\\frac{1}{1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}} \\le 10^{-A_s/10}$$\nRearranging this inequality gives an upper bound on $\\omega_c^{2N}$:\n$$1 \\le 10^{-A_s/10} \\left(1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}\\right)$$\n$$10^{A_s/10} \\le 1 + \\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N}$$\n$$\\left(\\frac{\\omega_s}{\\omega_c}\\right)^{2N} \\ge 10^{A_s/10} - 1$$\n$$\\omega_c^{2N} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\n\nWe now have both a lower and an upper bound for the term $\\omega_c^{2N}$. For a valid filter to exist, the lower bound must be less than or equal to the upper bound:\n$$\\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1} \\le \\omega_c^{2N} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\nFrom this, we can form a single inequality that relates the filter order $N$ to the given specifications, eliminating the unknown cutoff frequency $\\omega_c$:\n$$\\frac{\\omega_p^{2N}}{\\frac{1}{(1 - \\delta_p)^2} - 1} \\le \\frac{\\omega_s^{2N}}{10^{A_s/10} - 1}$$\nTo solve for $N$, we rearrange the terms:\n$$\\left(\\frac{\\omega_s}{\\omega_p}\\right)^{2N} \\ge \\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}$$\nTaking the natural logarithm of both sides (the inequality direction is preserved since $\\omega_s/\\omega_p  1$):\n$$2N \\ln\\left(\\frac{\\omega_s}{\\omega_p}\\right) \\ge \\ln\\left(\\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}\\right)$$\nFinally, we solve for the minimum order $N$:\n$$N \\ge \\frac{\\ln\\left(\\frac{10^{A_s/10} - 1}{\\frac{1}{(1 - \\delta_p)^2} - 1}\\right)}{2 \\ln\\left(\\frac{\\omega_s}{\\omega_p}\\right)}$$\nNow, we substitute the provided values into this expression: $\\omega_p = 2\\pi \\times 200\\,\\mathrm{rad/s}$, $\\omega_s = 2\\pi \\times 1000\\,\\mathrm{rad/s}$, $\\delta_p = 0.01$, and $A_s = 60\\,\\mathrm{dB}$.\n\nThe ratio of the edge frequencies is:\n$$\\frac{\\omega_s}{\\omega_p} = \\frac{2\\pi \\times 1000}{2\\pi \\times 200} = 5$$\nThe stopband term in the numerator of the logarithm's argument is:\n$$10^{A_s/10} - 1 = 10^{60/10} - 1 = 10^6 - 1 = 999999$$\nThe passband term in the denominator of the logarithm's argument is:\n$$\\frac{1}{(1 - \\delta_p)^2} - 1 = \\frac{1}{(1 - 0.01)^2} - 1 = \\frac{1}{0.99^2} - 1 = \\frac{1}{0.9801} - 1 = \\frac{1 - 0.9801}{0.9801} = \\frac{0.0199}{0.9801}$$\nSubstituting these into the inequality for $N$:\n$$N \\ge \\frac{\\ln\\left(\\frac{999999}{0.0199/0.9801}\\right)}{2 \\ln(5)} = \\frac{\\ln\\left(\\frac{999999 \\times 0.9801}{0.0199}\\right)}{2 \\ln(5)}$$\nWe calculate the argument of the logarithm:\n$$\\frac{999999 \\times 0.9801}{0.0199} \\approx \\frac{980099.0199}{0.0199} \\approx 49251207.03$$\nNow, we compute the value for $N$:\n$$N \\ge \\frac{\\ln(49251207.03)}{2 \\ln(5)} \\approx \\frac{17.7126}{2 \\times 1.6094} \\approx \\frac{17.7126}{3.2188} \\approx 5.5028$$\nSince the filter order $N$ must be an integer, we must choose the smallest integer that satisfies this condition. This is found by taking the ceiling of the calculated value:\n$$N = \\lceil 5.5028 \\rceil = 6$$\nTherefore, the minimum integer filter order required to meet both specifications simultaneously is $6$.",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "While computationally efficient, Infinite Impulse Response (IIR) filters introduce a critical design consideration: stability. An unstable filter is not only useless but can produce catastrophic, unbounded outputs from perfectly normal input signals. This exercise  connects the theoretical definition of Bounded-Input Bounded-Output (BIBO) stability to its practical and elegant test in the z-domain, demonstrating how to ensure a filter's reliability by analyzing the location of its poles.",
            "id": "4176408",
            "problem": "In neural signal processing, one often designs Infinite Impulse Response (IIR) digital filters to isolate local field potentials or action potentials from extracellular recordings. Consider a causal Linear Time-Invariant (LTI) discrete-time band-pass filter used to isolate action potentials recorded at a sampling frequency of $30\\,\\text{kHz}$. The filter is implemented as a cascade of two second-order sections with transfer function\n$$\nH(z) \\;=\\; G \\,\\frac{\\left(1 - z^{-2}\\right)^{2}}{\\left(1 - 1.5\\,z^{-1} + 0.9025\\,z^{-2}\\right)\\left(1 - 1.2\\,z^{-1} + 0.9604\\,z^{-2}\\right)},\n$$\nwhere $G$ is a real gain constant chosen to set the passband gain.\n\nStarting from the definition of Bounded-Input Bounded-Output (BIBO) stability for discrete-time systems, and the convolution representation of LTI systems in terms of their impulse response, derive the BIBO stability condition in terms of the absolute summability of the impulse response. Using the $z$-transform and its Region of Convergence (ROC), explain why for a rational causal IIR filter, BIBO stability is equivalent to all poles lying strictly inside the unit circle.\n\nThen, for the given $H(z)$, compute all pole locations of the two second-order denominator polynomials, determine whether they lie inside the unit circle, and report the largest pole magnitude across all poles. Express your final answer as the numerical value of the largest pole magnitude. Round your final answer to four significant figures. No physical units are required in the final answer.",
            "solution": "The problem consists of three parts. First, deriving the Bounded-Input Bounded-Output (BIBO) stability condition for a discrete-time Linear Time-Invariant (LTI) system. Second, relating this condition to the pole locations of a causal rational transfer function. Third, applying this theory to find the largest pole magnitude of a specific filter.\n\nPart 1: Derivation of the BIBO Stability Condition\n\nA discrete-time LTI system is defined as BIBO stable if for every bounded input sequence $x[n]$, the output sequence $y[n]$ is also bounded. A sequence $s[n]$ is bounded if there exists a finite positive number $B$ such that $|s[n]| \\le B$ for all $n \\in \\mathbb{Z}$.\n\nLet the input $x[n]$ be bounded, so there exists a finite constant $B_x  0$ such that $|x[n]| \\le B_x$ for all $n$.\nThe output $y[n]$ of an LTI system is given by the convolution sum of the input $x[n]$ and the system's impulse response $h[n]$:\n$$y[n] = \\sum_{k=-\\infty}^{\\infty} h[k] x[n-k]$$\nTo find a bound on the output, we take the absolute value of $y[n]$:\n$$|y[n]| = \\left| \\sum_{k=-\\infty}^{\\infty} h[k] x[n-k] \\right|$$\nUsing the triangle inequality, which states that $|\\sum a_k| \\le \\sum |a_k|$, we can write:\n$$|y[n]| \\le \\sum_{k=-\\infty}^{\\infty} |h[k] x[n-k]|$$\nThe magnitude of a product is the product of the magnitudes, so $|h[k] x[n-k]| = |h[k]| |x[n-k]|$.\n$$|y[n]| \\le \\sum_{k=-\\infty}^{\\infty} |h[k]| |x[n-k]|$$\nSince the input is bounded by $B_x$, we have $|x[n-k]| \\le B_x$ for all $n$ and $k$. Substituting this into the inequality gives:\n$$|y[n]| \\le \\sum_{k=-\\infty}^{\\infty} |h[k]| B_x = B_x \\sum_{k=-\\infty}^{\\infty} |h[k]|$$\nFor the output $y[n]$ to be bounded, there must exist a finite constant $B_y$ such that $|y[n]| \\le B_y  \\infty$. From the inequality above, if the sum $\\sum_{k=-\\infty}^{\\infty} |h[k]|$ is finite, we can set $B_y = B_x \\sum_{k=-\\infty}^{\\infty} |h[k]|$, which is a finite number. Therefore, a sufficient condition for BIBO stability is that the impulse response $h[n]$ is absolutely summable:\n$$S = \\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$$\nThis condition is also necessary. To demonstrate this, one can construct a bounded input $x[n] = \\frac{h^*[-n]}{|h[-n]|}$ (for $h[-n] \\ne 0$, and $0$ otherwise), for which the output at $n=0$ becomes $y[0] = \\sum_k |h[k]|$. If this sum is infinite, the output is unbounded for a bounded input, violating the stability definition.\n\nPart 2: BIBO Stability and Pole Locations for Causal IIR Filters\n\nThe $z$-transform of the impulse response $h[n]$ is the system's transfer function, $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n] z^{-n}$.\nThe Region of Convergence (ROC) of $H(z)$ is the set of all complex values of $z$ for which this sum converges.\nThe BIBO stability condition is that $S = \\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$. Let's consider the magnitude of $H(z)$ evaluated on the unit circle, where $z = e^{j\\omega}$, for $\\omega \\in [-\\pi, \\pi]$.\n$$|H(e^{j\\omega})| = \\left| \\sum_{n=-\\infty}^{\\infty} h[n] e^{-j\\omega n} \\right| \\le \\sum_{n=-\\infty}^{\\infty} |h[n] e^{-j\\omega n}| = \\sum_{n=-\\infty}^{\\infty} |h[n]| |e^{-j\\omega n}|$$\nSince $|e^{-j\\omega n}| = 1$ for real $\\omega$, we have:\n$$|H(e^{j\\omega})| \\le \\sum_{n=-\\infty}^{\\infty} |h[n]| = S$$\nIf the system is BIBO stable, $S$ is finite, so $H(z)$ converges absolutely for all $z$ on the unit circle. This means the ROC of a stable LTI system must include the unit circle, $|z|=1$.\n\nFor a causal system, the impulse response is $h[n] = 0$ for $n  0$. Its $z$-transform is $H(z) = \\sum_{n=0}^{\\infty} h[n] z^{-n}$. A sequence that is zero for $n  0$ is a right-sided sequence, and the ROC for such a sequence is always the exterior of a circle, i.e., $|z|  r$, where $r$ is some radius.\nFor a rational transfer function $H(z) = N(z)/D(z)$, the poles are the roots of the denominator polynomial $D(z)$. The ROC is bounded by the poles. For a causal system, the ROC is the region in the $z$-plane outside the outermost pole. If $p_{max}$ is the pole with the largest magnitude, $r_{max} = |p_{max}|$, then the ROC is $|z|  r_{max}$.\n\nFor a causal LTI system to be BIBO stable, two conditions must be met simultaneously:\n1. Causality implies the ROC is of the form $|z|  r_{max}$.\n2. Stability implies the ROC must include the unit circle, $|z|=1$.\n\nFor the region $|z|  r_{max}$ to include the circle $|z|=1$, the radius $r_{max}$ must be strictly less than $1$. Thus, $r_{max} = |p_{max}|  1$. This means the magnitude of the largest pole must be less than $1$, which implies that all poles of the system must lie strictly inside the unit circle.\n\nPart 3: Pole Calculation for the Given Filter\n\nThe transfer function is:\n$$H(z) \\;=\\; G \\,\\frac{\\left(1 - z^{-2}\\right)^{2}}{\\left(1 - 1.5\\,z^{-1} + 0.9025\\,z^{-2}\\right)\\left(1 - 1.2\\,z^{-1} + 0.9604\\,z^{-2}\\right)}$$\nThe poles are the roots of the denominator polynomial. We need to find the values of $z$ for which the denominator is zero. This occurs when either of the two second-order factors is zero.\n\nLet's analyze the first factor: $D_1(z) = 1 - 1.5 z^{-1} + 0.9025 z^{-2} = 0$.\nMultiplying by $z^2$ gives a polynomial in $z$:\n$$z^2 - 1.5 z + 0.9025 = 0$$\nWe use the quadratic formula, $z = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b=-1.5$, and $c=0.9025$.\n$$p_{1,2} = \\frac{1.5 \\pm \\sqrt{(-1.5)^2 - 4(1)(0.9025)}}{2(1)} = \\frac{1.5 \\pm \\sqrt{2.25 - 3.61}}{2} = \\frac{1.5 \\pm \\sqrt{-1.36}}{2}$$\n$$p_{1,2} = \\frac{1.5}{2} \\pm j\\frac{\\sqrt{1.36}}{2} = 0.75 \\pm j\\sqrt{\\frac{1.36}{4}} = 0.75 \\pm j\\sqrt{0.34}$$\nThe magnitude of this complex conjugate pole pair is $|p| = \\sqrt{(\\text{Re}\\{p\\})^2 + (\\text{Im}\\{p\\})^2}$.\n$$|p_{1,2}| = \\sqrt{(0.75)^2 + (\\sqrt{0.34})^2} = \\sqrt{0.5625 + 0.34} = \\sqrt{0.9025} = 0.95$$\nSince $|p_{1,2}| = 0.95  1$, these poles are inside the unit circle.\n\nNow, let's analyze the second factor: $D_2(z) = 1 - 1.2 z^{-1} + 0.9604 z^{-2} = 0$.\nMultiplying by $z^2$:\n$$z^2 - 1.2 z + 0.9604 = 0$$\nUsing the quadratic formula with $a=1$, $b=-1.2$, and $c=0.9604$:\n$$p_{3,4} = \\frac{1.2 \\pm \\sqrt{(-1.2)^2 - 4(1)(0.9604)}}{2(1)} = \\frac{1.2 \\pm \\sqrt{1.44 - 3.8416}}{2} = \\frac{1.2 \\pm \\sqrt{-2.4016}}{2}$$\n$$p_{3,4} = \\frac{1.2}{2} \\pm j\\frac{\\sqrt{2.4016}}{2} = 0.6 \\pm j\\sqrt{\\frac{2.4016}{4}} = 0.6 \\pm j\\sqrt{0.6004}$$\nThe magnitude of this complex conjugate pole pair is:\n$$|p_{3,4}| = \\sqrt{(0.6)^2 + (\\sqrt{0.6004})^2} = \\sqrt{0.36 + 0.6004} = \\sqrt{0.9604} = 0.98$$\nSince $|p_{3,4}| = 0.98  1$, these poles are also inside the unit circle.\n\nThe four poles of the filter have magnitudes of $0.95$, $0.95$, $0.98$, and $0.98$. The largest pole magnitude is the maximum of these values:\n$$|p|_{max} = \\max(0.95, 0.98) = 0.98$$\nAll poles lie inside the unit circle, confirming that the specified causal filter is BIBO stable. The largest pole magnitude is $0.98$. The question requires the answer to be rounded to four significant figures.\n\nLargest pole magnitude $= 0.9800$.",
            "answer": "$$\\boxed{0.9800}$$"
        },
        {
            "introduction": "In many neuroscience applications, preserving the shape of a signal, such as an action potential, is as important as isolating its frequency band. This is where the time-domain properties of a filter become paramount. This practice  investigates the concept of group delay and reveals why linear-phase Finite Impulse Response (FIR) filters are often the tool of choice, as their constant group delay ensures that all frequency components are delayed equally, thus minimizing waveform distortion.",
            "id": "4176297",
            "problem": "In a neuroscience data analysis pipeline for local field potential (LFP) recordings, a finite impulse response (FIR) band-pass filter is used to isolate oscillations of interest while preserving waveform morphology. Consider a discrete-time, real-valued, linear-phase FIR band-pass filter designed with an odd length $N=401$ and a symmetric impulse response $h[n]$ under a sampling frequency $f_{s}=1000\\,\\mathrm{Hz}$. Using only the following foundational facts:\n- The discrete-time frequency response $H(\\omega)$ of a causal linear time-invariant (LTI) filter is defined via the discrete-time Fourier transform as $H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n)$.\n- The group delay $\\tau_{g}(\\omega)$ is defined as $\\tau_{g}(\\omega) = -\\frac{d}{d\\omega}\\,\\phi(\\omega)$, where $\\phi(\\omega)$ is the phase of $H(\\omega)$.\n- A real and even function of $\\omega$ has phase either $0$ or $\\pi$ wherever it is strictly positive or strictly negative, respectively, and therefore its phase is locally constant where its sign does not change.\n\nDerive, from these bases, an expression for the constant group delay of this filter in seconds, and then compute its numerical value in milliseconds under the stated sampling frequency. Express the final numerical answer as a single number in milliseconds. If any rounding is required, round to four significant figures.",
            "solution": "The group delay $\\tau_{g}(\\omega)$ of the filter is derived from its frequency response $H(\\omega)$. The filter is a real-valued, causal FIR filter of length $N=401$. Its frequency response is given by the discrete-time Fourier transform of its impulse response $h[n]$:\n$$H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n)$$\nThe length $N=401$ is odd. Let us define an integer $M$ such that $N = 2M+1$.\n$$M = \\frac{N-1}{2} = \\frac{401-1}{2} = \\frac{400}{2} = 200$$\nThe impulse response $h[n]$ is stated to be symmetric. For an odd-length causal filter, this means the impulse response is symmetric about the sample at $n=M$:\n$$h[n] = h[N-1-n] = h[2M-n] \\quad \\text{for } n = 0, 1, \\dots, N-1$$\nWe can rewrite the expression for $H(\\omega)$ by splitting the summation and utilizing this symmetry.\n$$H(\\omega) = \\sum_{n=0}^{M-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n) + h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=M+1}^{2M} h[n] \\exp(-\\mathrm{j}\\,\\omega n)$$\nIn the third term (the second summation), let us perform a change of variables. Let $k = 2M-n$, which implies $n = 2M-k$. When $n=M+1$, $k=M-1$. When $n=2M$, $k=0$. The summation becomes:\n$$\\sum_{k=0}^{M-1} h[2M-k] \\exp(-\\mathrm{j}\\,\\omega (2M-k))$$\nUsing the symmetry property $h[2M-k] = h[k]$, this becomes:\n$$\\sum_{k=0}^{M-1} h[k] \\exp(-\\mathrm{j}\\,\\omega (2M-k))$$\nSubstituting this back into the expression for $H(\\omega)$ after reverting the dummy index $k$ to $n$:\n$$H(\\omega) = \\sum_{n=0}^{M-1} h[n] \\exp(-\\mathrm{j}\\,\\omega n) + h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=0}^{M-1} h[n] \\exp(-\\mathrm{j}\\,\\omega (2M-n))$$\n$$H(\\omega) = h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=0}^{M-1} h[n] \\left( \\exp(-\\mathrm{j}\\,\\omega n) + \\exp(-\\mathrm{j}\\,\\omega (2M-n)) \\right)$$\nWe can factor out a common phase term from the expression in the parenthesis:\n$$\\exp(-\\mathrm{j}\\,\\omega n) + \\exp(-\\mathrm{j}\\,\\omega (2M-n)) = \\exp(-\\mathrm{j}\\,\\omega M) \\left( \\exp(\\mathrm{j}\\,\\omega (M-n)) + \\exp(-\\mathrm{j}\\,\\omega (M-n)) \\right)$$\nUsing Euler's formula, $\\cos(x) = \\frac{\\exp(\\mathrm{j}x) + \\exp(-\\mathrm{j}x)}{2}$, the term in the parenthesis simplifies to $2\\cos(\\omega(M-n))$.\nSubstituting this back yields:\n$$H(\\omega) = h[M] \\exp(-\\mathrm{j}\\,\\omega M) + \\sum_{n=0}^{M-1} h[n] \\left( \\exp(-\\mathrm{j}\\,\\omega M) \\, 2\\cos(\\omega(M-n)) \\right)$$\nNow, we factor out the common term $\\exp(-\\mathrm{j}\\,\\omega M)$ from the entire expression for $H(\\omega)$:\n$$H(\\omega) = \\exp(-\\mathrm{j}\\,\\omega M) \\left[ h[M] + \\sum_{n=0}^{M-1} 2h[n] \\cos(\\omega(M-n)) \\right]$$\nThis has the form $H(\\omega) = A(\\omega) \\exp(\\mathrm{j}\\,\\theta(\\omega))$, where the phase is linear in $\\omega$. Specifically, we identify:\n$$A(\\omega) = h[M] + \\sum_{n=0}^{M-1} 2h[n] \\cos(\\omega(M-n))$$\nand the phase term is $\\exp(-\\mathrm{j}\\,\\omega M)$.\nSince the impulse response $h[n]$ is real-valued, and the cosine function is real-valued, $A(\\omega)$ is a purely real-valued function of $\\omega$. Furthermore, since $\\cos(x) = \\cos(-x)$, $A(\\omega)$ is an even function of $\\omega$, i.e., $A(\\omega) = A(-\\omega)$.\nThe frequency response is therefore $H(\\omega) = A(\\omega) \\exp(-\\mathrm{j}\\,\\omega M)$. The total phase of the filter, $\\phi(\\omega)$, is the sum of the phase of $A(\\omega)$ and the phase of the complex exponential term:\n$$\\phi(\\omega) = \\arg(A(\\omega)) - \\omega M$$\nAs provided in the foundational facts, for a real function $A(\\omega)$, its phase $\\arg(A(\\omega))$ is $0$ where $A(\\omega)  0$ and $\\pi$ where $A(\\omega)  0$. Crucially, in frequency bands where $A(\\omega)$ does not change sign (such as the pass-band of a well-designed filter), the phase $\\arg(A(\\omega))$ is constant.\nThe group delay $\\tau_g(\\omega)$ is defined as:\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\phi(\\omega) = -\\frac{d}{d\\omega} \\left( \\arg(A(\\omega)) - \\omega M \\right)$$\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega}\\arg(A(\\omega)) + \\frac{d}{d\\omega}(\\omega M)$$\nSince $\\arg(A(\\omega))$ is piecewise constant (either $0$ or $\\pi$), its derivative with respect to $\\omega$ is zero everywhere except at the frequencies where $A(\\omega)=0$. Thus, for all frequencies where $A(\\omega) \\neq 0$:\n$$\\frac{d}{d\\omega}\\arg(A(\\omega)) = 0$$\nThe derivative of the linear phase component is:\n$$\\frac{d}{d\\omega}(\\omega M) = M$$\nTherefore, the group delay is constant and given by:\n$$\\tau_g(\\omega) = M$$\nThis result gives the group delay in units of samples. To convert this to a physical time in seconds, we multiply by the sampling period $T_s = 1/f_s$.\n$$\\tau_g = M \\cdot T_s = \\frac{N-1}{2} \\cdot \\frac{1}{f_s}$$\nUsing the given numerical values: $N=401$ and $f_s = 1000\\,\\mathrm{Hz}$.\n$$\\tau_g = \\frac{401-1}{2} \\cdot \\frac{1}{1000} = \\frac{200}{1000} = 0.2\\,\\mathrm{s}$$\nThe problem asks for the answer in milliseconds.\n$$\\tau_g = 0.2\\,\\mathrm{s} \\times 1000\\,\\frac{\\mathrm{ms}}{\\mathrm{s}} = 200\\,\\mathrm{ms}$$\nThe problem requests the final numerical answer be rounded to four significant figures if rounding is required. The result $200$ is exact. To express this in four significant figures, we write it as $200.0$.",
            "answer": "$$\\boxed{200.0}$$"
        }
    ]
}