{
    "hands_on_practices": [
        {
            "introduction": "周期图为我们提供了一种在频域中观察信号功率的工具，但频域中的功率与时域中的功率有何关联？本练习将引导您通过数值验证帕萨瓦尔定理（Parseval's theorem），这是一个保证能量守恒的基本原理。通过这个实践，您将加深对周期图归一化如何精确反映信号方差的理解。",
            "id": "4187236",
            "problem": "设一个实值、有限长度的神经时间序列表示为 $x[n]$，其中 $n \\in \\{0,1,\\dots,N-1\\}$，以采样频率 $F_s$（单位为赫兹，Hz）进行均匀采样。定义去除均值后的序列 $y[n] = x[n] - \\bar{x}$，其中 $\\bar{x} = \\frac{1}{N} \\sum_{n=0}^{N-1} x[n]$。有限样本方差定义为 $\\frac{1}{N} \\sum_{n=0}^{N-1} y[n]^2$（注意：这不是分母为 $N-1$ 的无偏估计量）。设 $Y[k]$ 表示 $y[n]$ 的离散傅里叶变换（DFT），使用非酉正变换和 $1/N$ 缩放的逆变换。设基于周期图的功率谱密度（PSD）根据第一性原理构建，使其在频率上的积分等于根据能量守恒定律的时域平均功率。\n\n从离散傅里叶变换（DFT）和逆离散傅里叶变换（IDFT）的基本定义出发，并根据 DFT 的时域和频域之间能量守恒的陈述（帕塞瓦尔定理），推导出一个以赫兹为单位的双边周期图的归一化方法，该方法应与 PSD 在频率上的积分和 $y[n]$ 的有限样本方差之间的等式相一致。然后，实现一个数值验证，证明周期图在所有 DFT 频点上的值之和乘以频点宽度等于 $y[n]$ 的有限样本方差。\n\n您的实现必须：\n- 使用非酉 DFT 约定 $Y[k] = \\sum_{n=0}^{N-1} y[n] e^{-j 2 \\pi k n / N}$ 和 $y[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} Y[k] e^{j 2 \\pi k n / N}$，其中角度单位为弧度。\n- 构建一个直接从 $Y[k]$ 获得的以赫兹为单位的双边周期图，使其在所有 $N$ 个频率仓上的总和乘以以赫兹为单位的频率仓宽度后，等于有限样本方差 $\\frac{1}{N} \\sum_{n=0}^{N-1} y[n]^2$。\n- 不应用任何锥形窗；使用原始的去除均值的信号。\n- 使用以赫兹为单位的采样频率 $F_s$；周期图的值必须具有信号单位的平方每赫兹的单位（例如，如果 $x[n]$ 的单位是微伏，则为 $\\mu\\mathrm{V}^2/\\mathrm{Hz}$）。最终的数值检查比较的是无量纲的量（方差和积分后的 PSD），因此输出中不需要物理单位。\n\n数值验证要求和容差：\n- 对于每个测试用例，计算绝对误差 $E_\\mathrm{abs} = \\left| \\sum_{k=0}^{N-1} S[k] \\, \\Delta f \\;-\\; \\frac{1}{N} \\sum_{n=0}^{N-1} y[n]^2 \\right|$，其中 $S[k]$ 是以赫兹为单位的双边周期图，$\\Delta f = \\frac{F_s}{N}$ 是以赫兹为单位的频点宽度。\n- 同时也计算相对误差 $E_\\mathrm{rel} = \\frac{E_\\mathrm{abs}}{\\max\\left(\\frac{1}{N} \\sum_{n=0}^{N-1} y[n]^2,\\; \\epsilon\\right)}$，其中 $\\epsilon$ 是一个小的正常数，以避免除以零。\n- 为每个用例报告一个布尔值，指示 $\\max(E_\\mathrm{abs}, E_\\mathrm{rel})  10^{-10}$ 是否成立。\n\n测试套件（三角函数的角度单位为弧度；频率单位为赫兹）：\n- 用例 1：$N=1024$，$F_s=1000$。信号 $x[n] = 0.5 + 2.0 \\sin\\!\\left(2\\pi \\cdot 50 \\cdot \\frac{n}{F_s}\\right) + 1.0 \\sin\\!\\left(2\\pi \\cdot 120 \\cdot \\frac{n}{F_s} + 0.3\\right)$。\n- 用例 2：$N=1000$，$F_s=800$。信号 $x[n]$ 是均值为零、标准差为 $0.8$ 的高斯白噪声；为保证可复现性，使用固定的随机种子。\n- 用例 3：$N=4096$，$F_s=2000$。信号 $x[n] = 1.23$（常数）。\n- 用例 4：$N=1501$，$F_s=600$。信号 $x[n]$ 是分段定义的：对于 $n  \\lfloor N/3 \\rfloor$，$x[n]=0$；对于 $\\lfloor N/3 \\rfloor \\le n  \\lfloor 2N/3 \\rfloor$，$x[n]=3.0$；对于 $n \\ge \\lfloor 2N/3 \\rfloor$，$x[n]=3.0 + 0.001 \\cdot \\left(n - \\lfloor 2N/3 \\rfloor \\right)$（一个小的线性斜坡）。\n- 用例 5：$N=2048$，$F_s=1000$。信号 $x[n] = 1.5 \\cos\\!\\left(\\pi n\\right) + 0.7 \\sin\\!\\left(2\\pi \\cdot 70 \\cdot \\frac{n}{F_s} + 0.1\\right) + 0.4 \\sin\\!\\left(2\\pi \\cdot 125.5 \\cdot \\frac{n}{F_s} + 1.7\\right) + 0.05 \\cdot \\eta[n]$，其中 $\\eta[n]$ 是均值为零、单位方差的高斯白噪声；为保证可复现性，使用固定的随机种子。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述用例的顺序排列结果，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是表示该用例是否通过数值验证的布尔值。",
            "solution": "问题要求推导一个双边周期图 $S[k]$ 的归一化因子，使得在频域中计算的总功率等于去除均值后的时间序列 $y[n]$ 的有限样本方差。这个等式是离散傅里叶变换（DFT）的帕塞瓦尔定理所表达的能量守恒原理的直接推论。\n\n首先，我们使用指定 DFT 对的帕塞瓦尔定理来建立时域和频域之间的关系。问题将正向和反向 DFT 定义为：\n- 正向 DFT：$Y[k] = \\sum_{n=0}^{N-1} y[n] e^{-j 2 \\pi k n / N}$\n- 反向 DFT (IDFT)：$y[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} Y[k] e^{j 2 \\pi k n / N}$\n\n为了推导帕塞瓦尔关系式，我们从信号的总能量开始，即其幅值平方和。由于 $y[n]$ 是实值，这即为平方和 $\\sum_{n=0}^{N-1} y[n]^2$。\n我们将 IDFT 的定义代入其中一个 $y[n]$ 项：\n$$ \\sum_{n=0}^{N-1} y[n]^2 = \\sum_{n=0}^{N-1} y[n] \\cdot y[n] = \\sum_{n=0}^{N-1} y[n] \\left( \\frac{1}{N} \\sum_{k=0}^{N-1} Y[k] e^{j 2 \\pi k n / N} \\right) $$\n通过交换求和顺序，我们可以对各项进行分组：\n$$ \\sum_{n=0}^{N-1} y[n]^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} Y[k] \\left( \\sum_{n=0}^{N-1} y[n] e^{j 2 \\pi k n / N} \\right) $$\n我们识别出内部的和是正向 DFT 的复共轭 $Y^*[k]$。对于实信号 $y[n]$，项 $\\sum_{n=0}^{N-1} y[n] e^{j 2 \\pi k n / N}$ 等价于 $Y[-k]$，即 $Y^*[k]$。一个更直接的方法是代入 IDFT 的共轭：\n$$ \\sum_{n=0}^{N-1} y[n]^2 = \\sum_{n=0}^{N-1} y[n] \\cdot y^*[n] = \\sum_{n=0}^{N-1} y[n] \\left( \\frac{1}{N} \\sum_{k=0}^{N-1} Y[k] e^{j 2 \\pi k n / N} \\right)^* = \\sum_{n=0}^{N-1} y[n] \\left( \\frac{1}{N} \\sum_{k=0}^{N-1} Y^*[k] e^{-j 2 \\pi k n / N} \\right) $$\n交换求和顺序：\n$$ \\sum_{n=0}^{N-1} y[n]^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} Y^*[k] \\left( \\sum_{n=0}^{N-1} y[n] e^{-j 2 \\pi k n / N} \\right) $$\n此时内部的和恰好是正向 DFT $Y[k]$ 的定义。这得出：\n$$ \\sum_{n=0}^{N-1} y[n]^2 = \\frac{1}{N} \\sum_{k=0}^{N-1} Y^*[k] Y[k] = \\frac{1}{N} \\sum_{k=0}^{N-1} |Y[k]|^2 $$\n这就是给定 DFT 约定下的帕塞瓦尔定理。\n\n问题将时域平均功率定义为 $y[n]$ 的有限样本方差：\n$$ P_{\\text{avg}} = \\frac{1}{N} \\sum_{n=0}^{N-1} y[n]^2 $$\n使用推导出的帕塞瓦尔关系式，我们可以用 DFT 系数来表示这个平均功率：\n$$ P_{\\text{avg}} = \\frac{1}{N} \\left( \\frac{1}{N} \\sum_{k=0}^{N-1} |Y[k]|^2 \\right) = \\frac{1}{N^2} \\sum_{k=0}^{N-1} |Y[k]|^2 $$\n问题要求功率谱密度（PSD）的积分（通过对周期图 $S[k]$ 的离散频率仓求和来近似）必须等于这个平均功率：\n$$ \\int \\text{PSD}(f) df \\approx \\sum_{k=0}^{N-1} S[k] \\Delta f = P_{\\text{avg}} $$\n频率仓宽度 $\\Delta f$ 是 DFT 中相邻频率分量之间的间距，由 $\\Delta f = F_s / N$ 给出，其中 $F_s$ 是以赫兹为单位的采样频率，N 是样本数。\n\n将 $\\Delta f$ 和 $P_{\\text{avg}}$ 的表达式代入所需的等式中，得到：\n$$ \\sum_{k=0}^{N-1} S[k] \\left( \\frac{F_s}{N} \\right) = \\frac{1}{N^2} \\sum_{k=0}^{N-1} |Y[k]|^2 $$\n为了使该等式成立，我们可以建立逐项关系，将周期图 $S[k]$ 定义为 DFT 系数平方幅值 $|Y[k]|^2$ 的函数。\n$$ S[k] \\frac{F_s}{N} = \\frac{1}{N^2} |Y[k]|^2 $$\n解出 $S[k]$ 得到归一化公式：\n$$ S[k] = \\frac{1}{N F_s} |Y[k]|^2 $$\n该表达式定义了双边周期图。我们来验证一下单位。如果信号 $y[n]$ 的单位是 $\\mu\\mathrm{V}$，那么它的 DFT $Y[k]$（作为一个和）的单位也是 $\\mu\\mathrm{V}$。因此， $|Y[k]|^2$ 的单位是 $\\mu\\mathrm{V}^2$。$N$ 是无量纲的，$F_s$ 的单位是赫兹。所以，$S[k]$ 的单位是 $\\mu\\mathrm{V}^2/\\mathrm{Hz}$，即单位频率的功率，这正是一个 PSD 所要求的。\n\n数值实现将对每个测试用例遵循以下步骤：\n1.  以采样频率 $F_s$ 生成长度为 $N$ 的时间序列 $x[n]$。\n2.  计算去除均值后的序列 $y[n] = x[n] - \\bar{x}$。\n3.  计算时域平均功率（有限样本方差）为 $P_{\\text{avg}} = \\frac{1}{N} \\sum_{n=0}^{N-1} y[n]^2$。这可以高效地计算为 `np.mean(y**2)`。\n4.  使用 `numpy.fft.fft` 计算 $y[n]$ 的 DFT $Y[k]$，该函数与指定的 DFT 定义相匹配。\n5.  使用推导出的公式计算双边周期图 $S[k]$：$S[k] = \\frac{1}{N F_s} |Y[k]|^2$。\n6.  通过对周期图值求和并乘以频率仓宽度 $\\Delta f = F_s/N$ 来近似 PSD 积分。频域中的总功率为 $P_{\\text{freq}} = \\sum_{k=0}^{N-1} S[k] \\Delta f$。\n7.  通过计算绝对误差 $E_{\\text{abs}} = |P_{\\text{freq}} - P_{\\text{avg}}|$ 和相对误差 $E_{\\text{rel}} = E_{\\text{abs}} / \\max(P_{\\text{avg}}, \\epsilon)$ 来验证等式。如果 $\\max(E_{\\text{abs}}, E_{\\text{rel}})$ 低于 $10^{-10}$ 的容差，则测试通过。使用双精度浮点运算，这个直接的数学恒等式应该能以非常高的精度成立，仅受限于机器精度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically verifies the normalization of a periodogram-based PSD.\n    The verification confirms that the integral of the PSD over frequency equals the\n    time-domain finite-sample variance of the signal, based on Parseval's theorem.\n    \"\"\"\n\n    test_cases_params = [\n        {'N': 1024, 'Fs': 1000.0, 'case_id': 1, 'info': 'Sinusoids'},\n        {'N': 1000, 'Fs': 800.0,  'case_id': 2, 'info': 'White noise'},\n        {'N': 4096, 'Fs': 2000.0, 'case_id': 3, 'info': 'Constant signal'},\n        {'N': 1501, 'Fs': 600.0,  'case_id': 4, 'info': 'Piecewise signal'},\n        {'N': 2048, 'Fs': 1000.0, 'case_id': 5, 'info': 'Mixed signal with noise'},\n    ]\n\n    results = []\n    \n    # Use a fixed random seed for reproducibility of noise-based signals.\n    rng = np.random.default_rng(seed=0)\n\n    for params in test_cases_params:\n        N = params['N']\n        Fs = params['Fs']\n        n = np.arange(N)\n        t = n / Fs\n\n        if params['case_id'] == 1:\n            x = 0.5 + 2.0 * np.sin(2 * np.pi * 50 * t) + 1.0 * np.sin(2 * np.pi * 120 * t + 0.3)\n        \n        elif params['case_id'] == 2:\n            x = rng.normal(loc=0.0, scale=0.8, size=N)\n        \n        elif params['case_id'] == 3:\n            x = np.full(N, 1.23)\n        \n        elif params['case_id'] == 4:\n            x = np.zeros(N, dtype=np.float64)\n            n1 = int(np.floor(N / 3))\n            n2 = int(np.floor(2 * N / 3))\n            x[n1:n2] = 3.0\n            ramp_indices = np.arange(n2, N)\n            x[ramp_indices] = 3.0 + 0.001 * (ramp_indices - n2)\n            \n        elif params['case_id'] == 5:\n            eta = rng.normal(loc=0.0, scale=1.0, size=N)\n            x = 1.5 * np.cos(np.pi * n) + \\\n                0.7 * np.sin(2 * np.pi * 70 * t + 0.1) + \\\n                0.4 * np.sin(2 * np.pi * 125.5 * t + 1.7) + \\\n                0.05 * eta\n\n        # Step 1: Mean-remove the signal to get y[n].\n        y = x - np.mean(x)\n\n        # Step 2: Calculate the finite-sample variance (time-domain average power).\n        # Variance = (1/N) * sum(y[n]^2)\n        time_domain_power = np.mean(y**2)\n\n        # Step 3: Compute the DFT of y[n].\n        # Y[k] = sum_{n=0}^{N-1} y[n] * exp(-j*2*pi*k*n/N)\n        Y = np.fft.fft(y)\n\n        # Step 4: Construct the two-sided periodogram S[k].\n        # From derivation: S[k] = (1 / (N * Fs)) * |Y[k]|^2\n        S = (1 / (N * Fs)) * np.abs(Y)**2\n        \n        # Step 5: Define the frequency bin width, delta_f.\n        delta_f = Fs / N\n\n        # Step 6: Calculate total power by integrating the PSD (sum * bin_width).\n        freq_domain_power = np.sum(S) * delta_f\n\n        # Step 7: Perform numerical verification.\n        epsilon = 1e-12\n        E_abs = np.abs(freq_domain_power - time_domain_power)\n        \n        # The denominator must not be zero.\n        denominator = np.maximum(time_domain_power, epsilon)\n        E_rel = E_abs / denominator\n\n        # Check if the maximum of the absolute and relative errors is within tolerance.\n        verification_passed = np.maximum(E_abs, E_rel)  1e-10\n        \n        results.append(verification_passed)\n\n    # Final print statement in the exact required format.\n    # Booleans are converted to lowercase strings 'true'/'false'.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在计算频谱时，我们看到的是离散的频率点，很容易将这些点之间的间距误认为是频谱的分辨率。本练习将挑战这一误解，要求您从第一性原理出发，推导并量化真实频谱分辨率（由观测时长决定）与表观频率网格间距（可通过零填充细化）之间的区别。理解这一关键差异对于正确解读任何基于FFT的频谱估计至关重要。",
            "id": "4187294",
            "problem": "为了使用周期图法估计功率谱密度 (PSD)，记录了一段来自大鼠海马体的局部场电位。采样后的离散时间信号为 $x[n]$，其中 $n=0,1,\\dots,N-1$，$N=4096$ 个样本是在采样频率 $f_{s}=1000\\,\\mathrm{Hz}$ 下采集的。经典周期图使用矩形窗（即，观测被时间限制在有限的记录长度内）。在通过快速傅里叶变换 (FFT) 计算离散傅里叶变换 (DFT) 之前，您需要考虑将记录补零至更长的长度 $L=65536$。\n\n从以下基本原理出发：\n- 观测值是潜在的无限长信号与一个矩形窗在时域上的乘积，时域上的乘法对应于频域上的卷积。\n- 离散时间傅里叶变换在由变换长度和采样频率决定的离散网格上对连续谱进行采样。\n\n完成以下任务：\n1. 根据矩形窗频域包络的性质，推导周期图的基本频率分辨率极限（以赫兹为单位），并将其表示为 $N$ 和 $f_{s}$ 的函数。您的推导应明确论证为什么此分辨率由记录长度决定，而不是由补零决定。\n2. 根据DFT频率采样的定义，推导补零到 $L$ 点后的表观频率网格间距（以赫兹为单位），并说明该网格间距如何依赖于 $L$ 和 $f_{s}$。\n\n然后，对于给定的 $N$、$f_{s}$ 和 $L$ 对这两个量进行数值计算，并以赫兹为单位提供最终数值结果。将每个数值四舍五入到八位有效数字。将您的最终答案表示为一个两元素的行向量，其中第一个元素是周期图的基本分辨率，第二个元素是补零后的表观网格间距。所有中间和最终频率均以 $\\mathrm{Hz}$（赫兹）表示。",
            "solution": "该问题要求推导和计算与离散时间信号的基于周期图的功率谱密度 (PSD) 估计相关的两个不同频率度量：基本频率分辨率和补零后的表观频率网格间距。\n\n首先，确立问题陈述的有效性。\n\n**步骤 1：提取已知条件**\n- 采样后的离散时间信号：$x[n]$\n- 原始记录中的样本数：$N=4096$\n- 采样频率：$f_{s}=1000\\,\\mathrm{Hz}$\n- 窗类型：矩形窗\n- 用于DFT计算的补零后长度：$L=65536$\n- 基本原理 1：观测值是潜在的无限长信号与一个矩形窗在时域上的乘积，对应于频域上的卷积。\n- 基本原理 2：离散时间傅里叶变换在由变换长度和采样频率决定的离散网格上对连续谱进行采样。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于数字信号处理的基本原理，特别是傅里叶分析和谱估计。加窗、谱泄漏、频率分辨率、补零和离散傅里叶变换 (DFT) 等概念都是标准的、科学上合理的。应用于局部场电位 (LFP) 数据在神经科学中是现实且常见的。\n- **适定性**：该问题提供了所有必要的参数（$N$、$f_s$、$L$）和明确的目标，以推导和计算所需的两个量。解是唯一且稳定的。\n- **客观性**：该问题使用精确、无歧义的技术语言陈述。它不包含主观或基于意见的论断。\n- 该问题未违反任何无效标准。它不是不合理、不完整、不切实际或不适定的。\n\n**结论与行动**\n问题是有效的。将提供完整的解决方案。\n\n**第 1 部分：基本频率分辨率的推导**\n\n谱估计的基本频率分辨率是指区分两个不同但间隔很近的频率分量的能力。对于周期图，此分辨率由观测窗口的长度决定，而不是由用于计算频谱的DFT长度决定。\n\n问题指出，观测到的有限长度信号（我们称之为 $x_w[n]$）是真实的、可能为无限长度的底层信号 $x_{true}[n]$ 与长度为 $N$ 的矩形窗 $w_R[n]$ 的乘积。\n$$x_w[n] = x_{true}[n] \\cdot w_R[n]$$\n其中矩形窗定义为：\n$$w_R[n] = \\begin{cases} 1  \\text{for } n = 0, 1, \\dots, N-1 \\\\ 0  \\text{otherwise} \\end{cases}$$\n时域中的乘法对应于频域中的卷积。加窗信号 $X_w(e^{j\\omega})$ 的离散时间傅里叶变换 (DTFT)——它代表了离散时间信号的连续谱——是真实信号频谱 $X_{true}(e^{j\\omega})$ 与窗函数频谱 $W_R(e^{j\\omega})$ 的卷积：\n$$X_w(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} X_{true}(e^{j\\theta}) W_R(e^{j(\\omega-\\theta)}) d\\theta$$\n这种卷积运算会用窗函数频谱 $W_R(e^{j\\omega})$ 的形状来“展宽”真实频谱 $X_{true}(e^{j\\omega})$。$W_R(e^{j\\omega})$ 主瓣的宽度决定了这种展宽的程度，从而设定了频率分辨率的极限。\n\n矩形窗 $w_R[n]$ 的DTFT由下式给出：\n$$W_R(e^{j\\omega}) = \\sum_{n=0}^{N-1} 1 \\cdot e^{-j\\omega n} = e^{-j\\omega\\frac{N-1}{2}} \\frac{\\sin(N\\omega/2)}{\\sin(\\omega/2)}$$\n该函数是狄利克雷核的一种形式。其幅度 $|W_R(e^{j\\omega})|$ 的主瓣中心位于 $\\omega=0$。分辨率通常根据此主瓣的宽度来定义。主瓣的第一个零点出现在分子 $\\sin(N\\omega/2)$ 等于零，而分母 $\\sin(\\omega/2)$ 不为零时。此条件在以下情况下满足：\n$$\\frac{N\\omega}{2} = k\\pi, \\quad \\text{for any non-zero integer } k$$\n主瓣两侧的第一个零点对应于 $k=\\pm 1$。因此，第一个零点的位置是：\n$$\\omega_{\\text{null}} = \\pm \\frac{2\\pi}{N} \\quad (\\text{radians per sample})$$\n频率分辨率 $\\Delta f_{res}$ 是区分两个频率分量所需的最小间隔。根据瑞利判据，如果一个分量的频谱响应的最大值与另一个分量的第一个最小值（零点）重合，则这两个分量恰好可分辨。这个间隔对应于从主瓣中心 ($\\omega=0$) 到第一个零点的距离，即每样本 $\\frac{2\\pi}{N}$ 弧度。\n\n为了将此分辨率从归一化角频率（弧度/样本）转换为物理频率（赫兹），我们使用关系式 $\\omega = 2\\pi f / f_s$，其中 $f$ 是物理频率，$f_s$ 是采样频率。\n设 $\\Delta \\omega_{res}$ 是以弧度/样本为单位的分辨率，$\\Delta f_{res}$ 是以赫兹为单位的分辨率。\n$$\\Delta \\omega_{res} = \\frac{2\\pi}{N}$$\n$$2\\pi \\frac{\\Delta f_{res}}{f_s} = \\frac{2\\pi}{N}$$\n求解 $\\Delta f_{res}$，我们得到基本频率分辨率：\n$$\\Delta f_{res} = \\frac{f_s}{N}$$\n此推导明确表明，分辨率仅取决于采样频率 $f_s$ 和原始记录长度 $N$。在进行DFT之前将信号补零至长度 $L  N$ 并不会改变原始时域窗口的持续时间。因此，它不会改变窗函数变换 $W_R(e^{j\\omega})$ 的形状，也无法改善其所施加的基本分辨率极限。补零仅仅是对被展宽的频谱 $X_w(e^{j\\omega})$ 提供了更密集的采样。\n\n**第 2 部分：表观频率网格间距的推导**\n\nDFT计算的是DTFT在离散频率点上的样本。这些点的间距取决于被变换序列的总长度，在本例中即为补零后的长度 $L$。\n\n一个信号 $x[n]$（假设长度为 $L$）的 $L$ 点DFT定义为：\n$$X[k] = \\sum_{n=0}^{L-1} x[n] e^{-j \\frac{2\\pi k n}{L}}, \\quad \\text{for } k = 0, 1, \\dots, L-1$$\n每个DFT谱线索引 $k$ 对应一个特定的分析频率。DFT在离散的归一化角频率上对连续谱 $X(e^{j\\omega})$进行采样：\n$$\\omega_k = \\frac{2\\pi k}{L} \\quad (\\text{radians per sample})$$\n为了找到与这些谱线对应的物理频率 $f_k$（以赫兹为单位），我们再次使用关系式 $\\omega_k = 2\\pi f_k / f_s$：\n$$2\\pi \\frac{f_k}{f_s} = \\frac{2\\pi k}{L}$$\n这给出了第 $k$ 条谱线的频率：\n$$f_k = k \\cdot \\frac{f_s}{L}$$\n表观频率网格间距 $\\Delta f_{grid}$ 是相邻DFT谱线之间的频率差，例如谱线 $k$ 和谱线 $k+1$ 之间：\n$$\\Delta f_{grid} = f_{k+1} - f_k = (k+1)\\frac{f_s}{L} - k\\frac{f_s}{L}$$\n这可以简化为：\n$$\\Delta f_{grid} = \\frac{f_s}{L}$$\n这个结果表明，DFT频率网格的间距由采样频率 $f_s$ 和总变换长度 $L$（包括补零）决定，而与原始信号长度 $N$ 无关。\n\n**数值计算**\n\n给定值为：\n- $N=4096$\n- $f_s=1000\\,\\mathrm{Hz}$\n- $L=65536$\n\n1.  **基本频率分辨率 ($\\Delta f_{res}$):**\n    $$\\Delta f_{res} = \\frac{f_s}{N} = \\frac{1000}{4096} = 0.244140625\\,\\mathrm{Hz}$$\n    四舍五入到八位有效数字，我们得到 $0.24414063\\,\\mathrm{Hz}$。\n\n2.  **表观频率网格间距 ($\\Delta f_{grid}$):**\n    $$\\Delta f_{grid} = \\frac{f_s}{L} = \\frac{1000}{65536} = 0.0152587890625\\,\\mathrm{Hz}$$\n    四舍五入到八位有效数字，我们得到 $0.015258789\\,\\mathrm{Hz}$。\n\n最终答案将以包含这两个数值的两元素行向量形式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.24414063  0.015258789 \\end{pmatrix}}$$"
        },
        {
            "introduction": "功率谱密度（PSD）图显示了功率在频率上的分布，但我们如何从中提取具体的量化指标？本练习将演示神经科学中的一个直接应用：从一个给定的PSD模型中计算特定频带（如此处的alpha波）内的均方根（RMS）振幅。这个过程揭示了抽象的谱密度函数与可量化的神经生理学指标之间的根本联系，即特定频带下的PSD积分等于该频带的方差或功率。",
            "id": "4187305",
            "problem": "在一次来自枕叶电极的静息态脑电图 (EEG) 记录中，一位研究者使用标准归一化的周期图法估计了单边功率谱密度 (PSD)，得到的 PSD 单位为 $\\mu\\text{V}^{2}/\\text{Hz}$，频率范围为非负。在本文定义为 $[8, 12]\\,\\text{Hz}$ 的 $\\alpha$ 波段中，电压 $x(t)$ 的经验拟合单边 PSD 模型为\n$$\nS_{x}(f) \\;=\\; N_{0} \\;+\\; A\\,\\exp\\!\\left(-\\frac{(f-f_{0})^{2}}{2\\,\\sigma^{2}}\\right),\n$$\n参数为 $N_{0} = 1\\,\\mu\\text{V}^{2}/\\text{Hz}$，$A = 50\\,\\mu\\text{V}^{2}/\\text{Hz}$，$f_{0} = 10\\,\\text{Hz}$，以及 $\\sigma = 0.5\\,\\text{Hz}$。假设在分析窗口内信号是平稳的，并且单边 PSD 定义在 $[0,\\infty)$ 上，其在频率上的积分等于 $x(t)$ 的方差。在感兴趣的频段内将 $S_{x}(f)$ 视为 $f$ 的连续函数，并忽略 $[8, 12]\\,\\text{Hz}$ 之外的频谱泄漏。\n\n从关联 PSD 与自协方差函数的 Wiener–Khinchin 定理出发，并结合方差和均方根 (RMS) 振幅的定义，推导由 $[8, 12]\\,\\text{Hz}$ 频段内的频率贡献的带限方差，然后计算相应的带限均方根振幅。用 $\\mu\\text{V}$ 单位表示最终的均方根振幅，并将答案四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个问题，该问题需要根据给定的脑电图 (EEG) 信号的功率谱密度 (PSD) 模型计算带限均方根 (RMS) 振幅。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- **主题**：功率谱密度估计：周期图法，在神经科学数据分析 (EEG) 的背景下。\n- **信号**：来自静息态脑电图记录的电压 $x(t)$。\n- **PSD 模型**：对于 $f \\in [8, 12]\\,\\text{Hz}$，单边 PSD $S_x(f)$ 的模型为：\n$$S_x(f) = N_0 + A \\exp\\left(-\\frac{(f-f_0)^2}{2\\sigma^2}\\right)$$\n- **参数**：\n    - 噪声基底：$N_0 = 1\\,\\mu\\text{V}^2/\\text{Hz}$\n    - 高斯振幅：$A = 50\\,\\mu\\text{V}^2/\\text{Hz}$\n    - 中心频率：$f_0 = 10\\,\\text{Hz}$\n    - 高斯标准差：$\\sigma = 0.5\\,\\text{Hz}$\n- **定义**：单边 PSD $S_x(f)$ 在 $[0, \\infty)$ 上的积分等于 $x(t)$ 的方差。\n- **任务**：\n    1. 推导由定义为 $[8, 12]\\,\\text{Hz}$ 的 $\\alpha$ 波段内的频率贡献的带限方差。\n    2. 计算相应的带限均方根振幅。\n- **约束条件**：\n    - 从 Wiener–Khinchin 定理出发。\n    - 忽略 $[8, 12]\\,\\text{Hz}$ 之外的频谱泄漏。\n    - 用 $\\mu\\text{V}$ 单位表示最终的均方根振幅。\n    - 将最终答案四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学性**：该问题在信号处理及其在神经科学中的应用方面有充分的科学依据。PSD、方差、RMS 振幅、Wiener-Khinchin 定理等概念，以及在 EEG α 波段分析中的具体应用都是标准的。用于谱峰的高斯加常数模型是一种常见且有效的唯象模型。单位和参数值对于 EEG 数据是物理上现实的。\n- **适定性**：该问题是适定的。它提供了一个明确的数学模型和所有必要的参数来计算一个唯一定义的量（带限均方根振幅）。\n- **客观性**：问题以客观、定量的语言陈述，没有歧义或主观论断。\n- **不完整或矛盾的设置**：问题是自洽的。提供了所有必要的信息，没有矛盾之处。\n- **其他缺陷**：该问题没有表现出任何其他缺陷，例如非形式化、不切实际、不适定、微不足道或超出科学可验证性。对 Wiener-Khinchin 定理的引用是为了确立 PSD 积分与方差之间的关系，这是问题的核心部分。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。将提供完整的解答。\n\n### 解题推导\n问题首先引用了 Wiener–Khinchin 定理，该定理建立了平稳随机过程的自协方差函数与其功率谱密度之间的基本关系。该定理的一个直接推论是，过程的方差 $\\sigma_x^2$（即零延迟下的自协方差）等于 PSD 在所有频率上的积分。对于问题中指定的定义在 $f \\geq 0$ 上的单边 PSD $S_x(f)$，此关系为：\n$$ \\sigma_x^2 = \\text{Var}[x(t)] = \\int_0^\\infty S_x(f) \\, df $$\n问题要求计算仅由指定 $\\alpha$ 波段 $[8, 12]\\,\\text{Hz}$ 内的频率贡献的方差。我们将此带限方差表示为 $\\sigma^2_{\\alpha}$。为求此值，我们将给定的 PSD 模型在此区间上积分：\n$$ \\sigma^2_{\\alpha} = \\int_{8\\,\\text{Hz}}^{12\\,\\text{Hz}} S_x(f) \\, df $$\n代入 $S_x(f)$ 的给定表达式：\n$$ \\sigma^2_{\\alpha} = \\int_{8}^{12} \\left[ N_0 + A \\exp\\left(-\\frac{(f-f_0)^2}{2\\sigma^2}\\right) \\right] df $$\n我们可以将这个积分分成两部分：\n$$ \\sigma^2_{\\alpha} = \\int_{8}^{12} N_0 \\, df + \\int_{8}^{12} A \\exp\\left(-\\frac{(f-f_0)^2}{2\\sigma^2}\\right) df $$\n第一部分代表恒定噪声基底的贡献，可以直接计算：\n$$ \\int_{8}^{12} N_0 \\, df = N_0 [f]_{8}^{12} = N_0 (12 - 8) = 4N_0 $$\n第二部分涉及对高斯函数进行积分。这个积分需要使用误差函数 $\\text{erf}(z)$，其定义为：\n$$ \\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-t^2) \\, dt $$\n一般高斯函数的不定积分可以用 $\\text{erf}(z)$ 表示：\n$$ \\int \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right) dx = \\sigma \\sqrt{\\frac{\\pi}{2}} \\, \\text{erf}\\left(\\frac{x-\\mu}{\\sqrt{2}\\sigma}\\right) + C $$\n将此应用于我们的高斯分量的定积分：\n$$ \\int_{8}^{12} A \\exp\\left(-\\frac{(f-f_0)^2}{2\\sigma^2}\\right) df = A \\left[ \\sigma \\sqrt{\\frac{\\pi}{2}} \\, \\text{erf}\\left(\\frac{f-f_0}{\\sqrt{2}\\sigma}\\right) \\right]_{8}^{12} $$\n$$ = A \\sigma \\sqrt{\\frac{\\pi}{2}} \\left[ \\text{erf}\\left(\\frac{12-f_0}{\\sqrt{2}\\sigma}\\right) - \\text{erf}\\left(\\frac{8-f_0}{\\sqrt{2}\\sigma}\\right) \\right] $$\n现在，我们代入给定的参数值：$f_0 = 10\\,\\text{Hz}$ 和 $\\sigma = 0.5\\,\\text{Hz}$。\n误差函数的自变量变为：\n上限：$\\frac{12 - 10}{\\sqrt{2} \\cdot 0.5} = \\frac{2}{0.5\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$\n下限：$\\frac{8 - 10}{\\sqrt{2} \\cdot 0.5} = \\frac{-2}{0.5\\sqrt{2}} = \\frac{-4}{\\sqrt{2}} = -2\\sqrt{2}$\n利用 $\\text{erf}(-z) = -\\text{erf}(z)$ 的性质，高斯积分的表达式可以简化为：\n$$ A \\sigma \\sqrt{\\frac{\\pi}{2}} \\left[ \\text{erf}(2\\sqrt{2}) - \\text{erf}(-2\\sqrt{2}) \\right] = A \\sigma \\sqrt{\\frac{\\pi}{2}} \\left[ \\text{erf}(2\\sqrt{2}) + \\text{erf}(2\\sqrt{2}) \\right] $$\n$$ = A \\sigma \\sqrt{\\frac{\\pi}{2}} \\left[ 2 \\, \\text{erf}(2\\sqrt{2}) \\right] = A \\sigma \\sqrt{2\\pi} \\, \\text{erf}(2\\sqrt{2}) $$\n将两部分结合起来，总的带限方差 $\\sigma^2_{\\alpha}$ 为：\n$$ \\sigma^2_{\\alpha} = 4N_0 + A \\sigma \\sqrt{2\\pi} \\, \\text{erf}(2\\sqrt{2}) $$\n代入常数的数值 $N_0 = 1\\,\\mu\\text{V}^2/\\text{Hz}$，$A = 50\\,\\mu\\text{V}^2/\\text{Hz}$，以及 $\\sigma = 0.5\\,\\text{Hz}$：\n$$ \\sigma^2_{\\alpha} = 4(1) + (50)(0.5) \\sqrt{2\\pi} \\, \\text{erf}(2\\sqrt{2}) $$\n$$ \\sigma^2_{\\alpha} = 4 + 25 \\sqrt{2\\pi} \\, \\text{erf}(2\\sqrt{2}) $$\n该方差的单位是 $(\\mu\\text{V}^2/\\text{Hz}) \\cdot \\text{Hz} = \\mu\\text{V}^2$。现在，我们计算其数值：\n$2\\sqrt{2} \\approx 2.828427$\n$\\text{erf}(2\\sqrt{2}) \\approx \\text{erf}(2.828427) \\approx 0.99989592$\n$\\sqrt{2\\pi} \\approx 2.506628$\n$$ \\sigma^2_{\\alpha} \\approx 4 + 25 \\cdot (2.506628) \\cdot (0.99989592) $$\n$$ \\sigma^2_{\\alpha} \\approx 4 + 62.665707 \\cdot 0.99989592 $$\n$$ \\sigma^2_{\\alpha} \\approx 4 + 62.659231 \\approx 66.659231 \\, \\mu\\text{V}^2 $$\n带限均方根 (RMS) 振幅（我们表示为 $E_{\\alpha}$）是带限方差的平方根：\n$$ E_{\\alpha} = \\sqrt{\\sigma^2_{\\alpha}} $$\n$$ E_{\\alpha} \\approx \\sqrt{66.659231} \\approx 8.164510 \\, \\mu\\text{V} $$\n问题要求将答案四舍五入到四位有效数字。\n$$ E_{\\alpha} \\approx 8.165 \\, \\mu\\text{V} $$",
            "answer": "$$\n\\boxed{8.165}\n$$"
        }
    ]
}