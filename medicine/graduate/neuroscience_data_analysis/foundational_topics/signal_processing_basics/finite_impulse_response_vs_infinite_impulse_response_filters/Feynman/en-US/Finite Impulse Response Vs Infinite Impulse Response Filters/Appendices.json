{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental distinction between FIR and IIR filters lies in their names: one has a finite impulse response, the other an infinite one. This exercise  takes you back to this core definition, asking you to determine a filter's type by directly analyzing its impulse response. By working through this problem, you will solidify your understanding of how the duration of $h[n]$ classifies a filter and relates to its fundamental properties of causality and stability.",
            "id": "4162619",
            "problem": "In extracellular spike sorting for local field potential (LFP) analysis, a common preprocessing step is to apply a linear time-invariant digital filter to suppress high-frequency noise while preserving spike-like transients. Consider a causal discrete-time linear time-invariant system characterized by the impulse response $h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$. A single isolated spike is modeled as an input $x[n] = \\delta[n]$. Starting from the fundamental definition of linear time-invariant systems and the convolution operation on discrete-time sequences, derive the output $y[n]$ for this input. Using first principles, determine whether the system is a finite impulse response (FIR) filter or an infinite impulse response (IIR) filter by analyzing the support of $h[n]$ and the structure of the system function in the complex $z$-domain. Additionally, assess causality and bounded-input bounded-output stability based on standard definitions. \n\nFinally, report the exact numerical value of the sample $y[2]$ as your final answer. No rounding is required, and your final reported value must be exact. Do not include any units. \n\nDefine any acronyms on first use, such as finite impulse response (FIR), infinite impulse response (IIR), and local field potential (LFP). All symbols and numbers must be written in mathematical notation.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- System: Causal discrete-time linear time-invariant (LTI).\n- Impulse response: $h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$. Here, $\\delta[n]$ is the Kronecker delta function.\n- Input signal: $x[n] = \\delta[n]$.\n- Task 1: Derive the output $y[n]$ using the discrete-time convolution definition.\n- Task 2: Determine if the system is a finite impulse response (FIR) or infinite impulse response (IIR) filter. This involves analysis of the support of $h[n]$ and the system function $H(z)$.\n- Task 3: Assess causality and bounded-input bounded-output (BIBO) stability.\n- Task 4: Report the exact numerical value of the output sample $y[2]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the fundamental principles of digital signal processing. The models for the filter ($h[n]$) and the neuronal spike ($x[n]$) are standard textbook simplifications used for pedagogical purposes in fields like biomedical engineering and computational neuroscience, particularly in the context of analyzing local field potential (LFP) data. The problem is well-posed, with all necessary information provided and no internal contradictions. The objectives are clear, objective, and formalizable. The problem does not violate any of the specified invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\n### Solution Derivation\nThe problem asks for several analyses of a discrete-time LTI system, a common task in preprocessing signals such as those from extracellular recordings.\n\nFirst, we derive the output signal $y[n]$. For a discrete-time LTI system, the output $y[n]$ is the convolution of the input signal $x[n]$ with the system's impulse response $h[n]$. The convolution sum is defined as:\n$$y[n] = x[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} x[k]h[n-k]$$\nThe input signal is given as a single impulse, $x[n] = \\delta[n]$. Substituting this into the convolution sum:\n$$y[n] = \\sum_{k=-\\infty}^{\\infty} \\delta[k]h[n-k]$$\nThe Kronecker delta function $\\delta[k]$ is non-zero only at the index $k=0$, where its value is $1$. This property, known as the sifting property, simplifies the summation to a single term evaluated at $k=0$:\n$$y[n] = h[n-0] = h[n]$$\nThis is a fundamental result: the response of an LTI system to an impulse input is, by definition, the impulse response of the system itself. Therefore, the output signal is:\n$$y[n] = h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$$\n\nNext, we determine whether the filter is a finite impulse response (FIR) or an infinite impulse response (IIR) filter. This can be done by two related methods.\n\nMethod 1: Analyzing the support of the impulse response $h[n]$.\nAn FIR filter is characterized by an impulse response that is non-zero for only a finite number of samples. An IIR filter has an impulse response that is non-zero for an infinite number of samples.\nThe given impulse response is $h[n] = 1 \\cdot \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$. The non-zero values of $h[n]$ occur only at indices $n=0, 1, 2$. Specifically, $h[0]=1$, $h[1]=\\frac{1}{2}$, and $h[2]=\\frac{1}{4}$. For all other integer values of $n$, $h[n]=0$. The duration of the impulse response is finite (length $3$). Therefore, the system is an FIR filter.\n\nMethod 2: Analyzing the system function $H(z)$.\nThe system function $H(z)$ is the $z$-transform of the impulse response $h[n]$:\n$$H(z) = \\mathcal{Z}\\{h[n]\\} = \\sum_{n=-\\infty}^{\\infty} h[n]z^{-n}$$\nSubstituting the given $h[n]$:\n$$H(z) = h[0]z^{-0} + h[1]z^{-1} + h[2]z^{-2} = 1 \\cdot 1 + \\frac{1}{2}z^{-1} + \\frac{1}{4}z^{-2}$$\n$$H(z) = 1 + \\frac{1}{2}z^{-1} + \\frac{1}{4}z^{-2}$$\nAn LTI system corresponds to an FIR filter if and only if its system function $H(z)$ is a polynomial in $z^{-1}$, which means all its poles are located at the origin $z=0$. To see the poles, we can write $H(z)$ as a rational function of $z$:\n$$H(z) = \\frac{z^2}{z^2} + \\frac{1}{2}\\frac{z}{z^2} + \\frac{1}{4}\\frac{1}{z^2} = \\frac{z^2 + \\frac{1}{2}z + \\frac{1}{4}}{z^2}$$\nThe poles of the system function are the roots of the denominator polynomial. Here, the denominator is $z^2$, so there is a double pole at $z=0$. Since all poles are at the origin, the system is confirmed to be an FIR filter. IIR filters, which are typically implemented recursively, have poles at locations other than the origin.\n\nNext, we assess causality and stability.\nCausality: A discrete-time LTI system is causal if its impulse response $h[n]$ is zero for all negative time indices, i.e., $h[n]=0$ for $n  0$. The given impulse response $h[n]$ is non-zero only for $n=0, 1, 2$. It is zero for all $n0$. Thus, the system is causal, as stated in the problem.\n\nBounded-Input Bounded-Output (BIBO) Stability: An LTI system is BIBO stable if and only if its impulse response is absolutely summable. The condition is:\n$$S = \\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$$\nFor the given system, we compute this sum:\n$$S = \\sum_{n=-\\infty}^{\\infty} |\\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]| = |h[0]| + |h[1]| + |h[2]|$$\n$$S = |1| + \\left|\\frac{1}{2}\\right| + \\left|\\frac{1}{4}\\right| = 1 + \\frac{1}{2} + \\frac{1}{4} = \\frac{4}{4} + \\frac{2}{4} + \\frac{1}{4} = \\frac{7}{4}$$\nSince $S=\\frac{7}{4}$ is a finite value, the system is BIBO stable. It is a general property that all FIR filters are stable.\n\nFinally, we find the exact numerical value of the output sample $y[2]$. As established, $y[n] = h[n]$. We need to evaluate this expression for $n=2$:\n$$y[2] = h[2] = 1 \\cdot \\delta[2] + \\frac{1}{2}\\delta[2-1] + \\frac{1}{4}\\delta[2-2]$$\n$$y[2] = 1 \\cdot \\delta[2] + \\frac{1}{2}\\delta[1] + \\frac{1}{4}\\delta[0]$$\nUsing the definition of the Kronecker delta function ($\\delta[0]=1$ and $\\delta[m]=0$ for $m \\neq 0$):\n$$y[2] = 1 \\cdot (0) + \\frac{1}{2} \\cdot (0) + \\frac{1}{4} \\cdot (1)$$\n$$y[2] = 0 + 0 + \\frac{1}{4} = \\frac{1}{4}$$\nThe value of the output at sample time $n=2$ is $\\frac{1}{4}$.",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "FIR filters are prized for their linear-phase property, making them ideal for applications like anti-aliasing where phase distortion is unacceptable. This practice  places you in a common neuroscience scenario: preparing a high-frequency signal for decimation. You will learn how to translate filter requirements—such as passband width and stopband attenuation—into the necessary filter complexity, quantified by the filter order $N$, using standard design estimation formulas.",
            "id": "4162544",
            "problem": "You are given a signal processing task motivated by Local Field Potential (LFP) analysis in neuroscience data. The objective is to design an anti-alias finite impulse response (FIR) low-pass filter to enable decimation from an initial sampling frequency of $10{,}000$ Hz to an output sampling frequency of $2{,}000$ Hz. The filter must preserve a specified passband while ensuring sufficient attenuation of all content that would alias into the decimated band. Your program must compute the required transition width in Hz and estimate the minimum FIR filter order using the Kaiser window method.\n\nStart from fundamental principles appropriate to discrete-time signal processing: the Shannon–Nyquist sampling theorem, the definitions of passband and stopband edges, the concept of aliasing during decimation, and the linear-phase nature of FIR filters. Use these principles to determine the earliest acceptable stopband edge for anti-aliasing and to compute the transition width. Then, using well-tested formulas associated with the Kaiser window method, estimate the minimum filter order required to meet specified amplitude constraints. Do not rely on any undocumented shortcuts; your computation must be derived from standard definitions and widely accepted formulas in signal processing.\n\nFor each test case, the parameters are:\n- The initial sampling frequency $f_s = 10{,}000$ Hz.\n- The decimation factor $D = 5$, so the output sampling frequency is $f_s/D = 2{,}000$ Hz.\n- A passband edge frequency $f_p$ in Hz that must be preserved with small ripple.\n- An allowed passband ripple amplitude $\\delta_p$ (unitless, linear scale).\n- A required stopband attenuation amplitude $\\delta_s$ (unitless, linear scale).\n\nScientific realism constraint: The anti-aliasing stopband must begin no later than the post-decimation Nyquist frequency, so the stopband edge frequency $f_s^{(\\text{edge})}$ is at most $(f_s/D)/2$ Hz. The transition width in Hz is the difference between the stopband edge and the passband edge, which must be positive.\n\nUsing the Kaiser window estimate, compute:\n- The transition width $\\Delta f$ in Hz.\n- The Kaiser parameter $\\beta$ based on the stopband attenuation requirement.\n- The estimated minimum FIR filter order $N$.\n\nUnits and rounding requirements:\n- Express $\\Delta f$ in Hz, rounded to three decimals.\n- Express $\\beta$ as a float, rounded to four decimals.\n- Express $N$ as an integer.\n\nTest suite:\n- Case $1$: $f_p = 800$ Hz, $\\delta_p = 0.01$, $\\delta_s = 0.001$.\n- Case $2$: $f_p = 900$ Hz, $\\delta_p = 0.01$, $\\delta_s = 0.001$.\n- Case $3$: $f_p = 800$ Hz, $\\delta_p = 0.005$, $\\delta_s = 0.00001$.\n- Case $4$: $f_p = 995$ Hz, $\\delta_p = 0.005$, $\\delta_s = 0.001$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the form $[\\Delta f,\\beta,N]$. For example, your program should print a line that looks like $[[\\Delta f_1,\\beta_1,N_1],[\\Delta f_2,\\beta_2,N_2],[\\Delta f_3,\\beta_3,N_3],[\\Delta f_4,\\beta_4,N_4]]$ with the specified rounding and without any spaces.",
            "solution": "The problem is assessed as valid. It is a well-posed engineering problem grounded in established principles of digital signal processing, with clear, objective specifications and a verifiable solution path.\n\nThe objective is to specify the parameters for an anti-aliasing low-pass finite impulse response (FIR) filter intended for the decimation of a signal, a common task in neuroscience data analysis such as with Local Field Potentials (LFP). We must determine the filter's transition width ($\\Delta f$), estimate the Kaiser window parameter ($\\beta$), and estimate the minimum required filter order ($N$). The solution will be derived from first principles.\n\nThe initial signal has a sampling frequency of $f_s = 10,000$ Hz. This signal is to be downsampled by a decimation factor of $D = 5$. The resulting output sampling frequency will be $f_s' = f_s / D = 10,000 / 5 = 2,000$ Hz.\n\nThe first principle to apply is the Shannon-Nyquist sampling theorem. For the decimated signal, the new sampling rate $f_s' = 2,000$ Hz can unambiguously represent frequencies up to its Nyquist frequency, which is $f'_{Nyquist} = f_s' / 2 = 2,000 / 2 = 1,000$ Hz. During decimation, frequencies in the original signal that are above $f'_{Nyquist}$ will alias (fold) into the new baseband of $[0, 1,000]$ Hz. To prevent this distortion, the anti-aliasing filter must suppress all frequency components at and above $f'_{Nyquist}$. This fundamental requirement dictates that the filter's stopband must begin at or before $1,000$ Hz. We denote the stopband edge frequency as $f_{st}$, which must satisfy the condition $f_{st} \\le 1,000$ Hz.\n\nThe filter's performance is defined by its passband, where desired frequencies are preserved, and its stopband, where unwanted frequencies are attenuated. The passband is specified to extend up to a frequency $f_p$. The region between the passband edge $f_p$ and the stopband edge $f_{st}$ is the transition band. The width of this band is $\\Delta f = f_{st} - f_p$. The problem statement requires $\\Delta f > 0$.\n\nA core principle of FIR filter design is that for a given set of ripple specifications, the required filter order $N$ is inversely proportional to the transition width $\\Delta f$. To design the most computationally efficient filter (i.e., one with the lowest possible order $N$), the transition width $\\Delta f$ must be maximized. Given the fixed passband edge $f_p$ from the test case and the anti-aliasing constraint $f_{st} \\le 1,000$ Hz, the maximum possible transition width is achieved by selecting the highest permissible stopband edge frequency. Therefore, the optimal choice is to set $f_{st} = 1,000$ Hz for all calculations. The transition width for each case is then computed as $\\Delta f = 1,000 \\text{ Hz} - f_p$.\n\nThe next step is to use the Kaiser window design formulas to estimate the filter order $N$ and the window shape parameter $\\beta$. These are standard empirical formulas that connect the filter specifications to the required design parameters.\n\nFirst, we determine the stopband attenuation $A_s$ in decibels (dB) from the required linear stopband attenuation amplitude $\\delta_s$. The relationship is:\n$$A_s = -20 \\log_{10}(\\delta_s)$$\nNext, the Kaiser parameter $\\beta$, which controls the trade-off between main-lobe width and side-lobe level of the window's frequency response, is estimated from $A_s$. The standard empirical formulas are:\n$$ \\beta = \\begin{cases} 0.1102(A_s - 8.7)  A_s  50 \\text{ dB} \\\\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21)  21 \\text{ dB} \\le A_s \\le 50 \\text{ dB} \\\\ 0  A_s  21 \\text{ dB} \\end{cases} $$\nFinally, the minimum required filter order $N$ is estimated. A well-accepted formula relates $N$ to the attenuation $A_s$ and the normalized transition width $\\Delta \\omega = 2\\pi (\\Delta f / f_s)$. The formula is:\n$$ N \\approx \\frac{A_s - 8}{2.285 \\Delta \\omega} = \\frac{f_s(A_s - 8)}{2.285 \\cdot 2\\pi \\Delta f} $$\nSince the filter order must be an integer, the calculated value is rounded up to the nearest integer (i.e., the ceiling is taken) to ensure the filter meets or exceeds the required specifications.\n\nWe now apply this systematic procedure to each test case.\n\n**Case 1:** $f_p = 800$ Hz, $\\delta_p = 0.01$, $\\delta_s = 0.001$.\n- Transition width: $\\Delta f = 1,000 - 800 = 200$ Hz.\n- Stopband attenuation: $A_s = -20 \\log_{10}(0.001) = 60$ dB. Since $A_s > 50$, we use the first formula for $\\beta$.\n- Kaiser parameter: $\\beta = 0.1102(60 - 8.7) = 5.65326 \\approx 5.6533$.\n- Filter order: $N \\approx \\frac{10,000(60 - 8)}{2.285 \\cdot 2\\pi \\cdot 200} \\approx 181.08$. Rounding up gives $N = 182$.\n\n**Case 2:** $f_p = 900$ Hz, $\\delta_p = 0.01$, $\\delta_s = 0.001$.\n- Transition width: $\\Delta f = 1,000 - 900 = 100$ Hz.\n- Stopband attenuation: $A_s = -20 \\log_{10}(0.001) = 60$ dB.\n- Kaiser parameter: $\\beta = 0.1102(60 - 8.7) = 5.65326 \\approx 5.6533$.\n- Filter order: $N \\approx \\frac{10,000(60 - 8)}{2.285 \\cdot 2\\pi \\cdot 100} \\approx 362.16$. Rounding up gives $N = 363$.\n\n**Case 3:** $f_p = 800$ Hz, $\\delta_p = 0.005$, $\\delta_s = 0.00001$.\n- Transition width: $\\Delta f = 1,000 - 800 = 200$ Hz.\n- Stopband attenuation: $A_s = -20 \\log_{10}(0.00001) = 100$ dB.\n- Kaiser parameter: $\\beta = 0.1102(100 - 8.7) = 10.06126 \\approx 10.0613$.\n- Filter order: $N \\approx \\frac{10,000(100 - 8)}{2.285 \\cdot 2\\pi \\cdot 200} \\approx 320.38$. Rounding up gives $N = 321$.\n\n**Case 4:** $f_p = 995$ Hz, $\\delta_p = 0.005$, $\\delta_s = 0.001$.\n- Transition width: $\\Delta f = 1,000 - 995 = 5$ Hz.\n- Stopband attenuation: $A_s = -20 \\log_{10}(0.001) = 60$ dB.\n- Kaiser parameter: $\\beta = 0.1102(60 - 8.7) = 5.65326 \\approx 5.6533$.\n- Filter order: $N \\approx \\frac{10,000(60 - 8)}{2.285 \\cdot 2\\pi \\cdot 5} \\approx 7241.49$. Rounding up gives $N = 7242$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes FIR filter parameters (transition width, Kaiser beta, and order N)\n    for a set of anti-aliasing filter design problems.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (passband_edge_freq_Hz, passband_ripple, stopband_ripple)\n    test_cases = [\n        (800.0, 0.01, 0.001),\n        (900.0, 0.01, 0.001),\n        (800.0, 0.005, 0.00001),\n        (995.0, 0.005, 0.001),\n    ]\n\n    # Constants from the problem statement\n    f_s = 10000.0  # Initial sampling frequency in Hz\n    D = 5.0        # Decimation factor\n    \n    # The stopband must begin at or before the Nyquist frequency of the decimated signal\n    # to prevent aliasing. To maximize transition width (and minimize filter order),\n    # we choose the latest possible stopband edge frequency.\n    f_st = (f_s / D) / 2.0  # f_st = (10000 / 5) / 2 = 1000.0 Hz\n\n    results = []\n    for case in test_cases:\n        f_p, delta_p, delta_s = case\n\n        # 1. Compute the transition width in Hz\n        # This is the difference between the stopband and passband edge frequencies.\n        delta_f = f_st - f_p\n\n        # 2. Compute the stopband attenuation in dB and the Kaiser parameter beta\n        # The stopband attenuation A_s (in positive dB) is derived from the linear ripple delta_s.\n        A_s = -20.0 * np.log10(delta_s)\n\n        # The Kaiser parameter beta is estimated using empirical formulas based on A_s.\n        if A_s  50.0:\n            beta = 0.1102 * (A_s - 8.7)\n        elif A_s = 21.0:\n            beta = 0.5842 * (A_s - 21.0)**0.4 + 0.07886 * (A_s - 21.0)\n        else:\n            beta = 0.0\n\n        # 3. Estimate the minimum FIR filter order N\n        # This uses another standard empirical formula for the Kaiser window method.\n        # N = (A_s - 8) / (2.285 * delta_omega), where delta_omega = 2*pi*delta_f / f_s\n        numerator = f_s * (A_s - 8.0)\n        denominator = 2.285 * 2.0 * np.pi * delta_f\n        \n        # The filter order N must be an integer. We take the ceiling to ensure\n        # the filter specifications are met or exceeded.\n        N = int(np.ceil(numerator / denominator))\n        \n        results.append((delta_f, beta, N))\n\n    # Format the results into a single string as specified in the problem.\n    # Example format: [[df1,b1,n1],[df2,b2,n2],...]\n    result_strings = []\n    for df_val, beta_val, n_val in results:\n        # Apply specified rounding: 3 decimals for df, 4 for beta.\n        result_strings.append(f\"[{df_val:.3f},{beta_val:.4f},{n_val}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "While FIR filters are stable and offer linear phase, IIR filters can achieve much sharper frequency cutoffs with significantly fewer computations. This efficiency comes with a critical trade-off, which is explored in this problem . You will investigate how the poles of an IIR filter, when placed close to the unit circle to create a high-Q filter, inevitably lead to prolonged \"ringing\" in the time domain, a crucial consideration when filtering data containing sharp transients like neural spikes.",
            "id": "4162561",
            "problem": "A laboratory is analyzing local field potential recordings contaminated by mains interference and impulsive motion artifacts. To suppress the narrowband interference while preserving neural signals, the laboratory deploys a causal, second-order Infinite Impulse Response (IIR) notch filter whose transfer function in the complex $z$-plane is\n$$\nH(z) \\;=\\; \\frac{1 \\;-\\; 2\\cos(\\omega_{0})\\,z^{-1} \\;+\\; z^{-2}}{1 \\;-\\; 2 r \\cos(\\omega_{0})\\,z^{-1} \\;+\\; r^{2} z^{-2}},\n$$\nwhere $0r1$ is the pole radius controlling the quality factor (Q), and $\\omega_{0}$ is the notch center in radians per sample. The data are sampled at rate $f_{s}$ and contain an impulsive artifact modeled as $\\delta[n]$ entering the filter input. You may assume the system is Linear Time-Invariant (LTI). You will analyze the ring-down caused by the poles and estimate how long the ringing persists until it decays to a specified fraction of its initial envelope.\n\nStarting only from the definitions of impulse response and the standard relationship between a rational $H(z)$ and its corresponding linear constant-coefficient difference equation, address the following:\n\n1) Write the constant-coefficient linear difference equation obeyed by the impulse response $h[n]$ implied by $H(z)$, and argue why, for $n$ sufficiently large that the direct forcing on the right-hand side vanishes, the response $h[n]$ must satisfy the homogeneous recursion associated with the characteristic roots at $z = r \\exp(\\pm j \\omega_{0})$.\n\n2) Solve the homogeneous recursion to obtain the general form of $h[n]$ for $n$ beyond the directly forced indices, and derive the form of the amplitude envelope of $h[n]$ in terms of $r$ and $n$. Clearly state how the envelope behaves with $n$ and why this corresponds to prolonged ringing for high quality factor (high-Q) poles.\n\n3) Define $n_{\\alpha}$ as the smallest nonnegative integer such that the envelope magnitude has decreased to a factor $\\alpha \\in (0,1)$ of its initial value. Derive an analytic expression for $n_{\\alpha}$ in terms of $r$ and $\\alpha$, using only logarithms and without invoking any pre-memorized decay-time formulas.\n\n4) Consider a realistic neuroscience setting: line-noise suppression at frequency $f_{0} = 50$ Hz from data sampled at $f_{s} = 1000$ Hz, so that $\\omega_{0} = 2\\pi f_{0}/f_{s}$ in radians per sample. Take $r = 0.99$. Using your expression from part $3$, compute the decay time $t_{95\\%}$ at which the ringing envelope has fallen to $\\alpha = 0.05$ of its initial value. Express $t_{95\\%}$ in milliseconds. Round your answer to three significant figures. State angles in radians if needed.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and objective. We may proceed with the solution.\n\n### Part 1: Difference Equation and Homogeneous Recursion\n\nThe relationship between the input $X(z)$ and output $Y(z)$ of a Linear Time-Invariant (LTI) system is given by its transfer function $H(z) = Y(z)/X(z)$. For the given IIR notch filter, we have:\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{1 - 2\\cos(\\omega_{0})z^{-1} + z^{-2}}{1 - 2 r \\cos(\\omega_{0})z^{-1} + r^{2} z^{-2}}\n$$\nTo find the difference equation relating the output sequence $y[n]$ to the input sequence $x[n]$, we cross-multiply the terms:\n$$\nY(z) \\left( 1 - 2 r \\cos(\\omega_{0})z^{-1} + r^{2} z^{-2} \\right) = X(z) \\left( 1 - 2\\cos(\\omega_{0})z^{-1} + z^{-2} \\right)\n$$\nWe now apply the inverse Z-transform to both sides. Recalling the time-shifting property of the Z-transform, where a multiplication by $z^{-k}$ in the Z-domain corresponds to a time delay of $k$ samples in the time domain (i.e., $w[n-k] \\leftrightarrow z^{-k}W(z)$), we obtain the linear constant-coefficient difference equation:\n$$\ny[n] - 2r\\cos(\\omega_{0})y[n-1] + r^{2}y[n-2] = x[n] - 2\\cos(\\omega_{0})x[n-1] + x[n-2]\n$$\nThe impulse response, denoted $h[n]$, is defined as the output of the system when the input is the unit impulse sequence, $x[n] = \\delta[n]$. Substituting $x[n]=\\delta[n]$ and $y[n]=h[n]$ into the difference equation gives:\n$$\nh[n] - 2r\\cos(\\omega_{0})h[n-1] + r^{2}h[n-2] = \\delta[n] - 2\\cos(\\omega_{0})\\delta[n-1] + \\delta[n-2]\n$$\nThe right-hand side of this equation is the forcing term. By definition, the unit impulse $\\delta[n]$ is non-zero only at $n=0$. Consequently, the term $\\delta[n-1]$ is non-zero only at $n=1$, and $\\delta[n-2]$ is non-zero only at $n=2$. Therefore, the entire forcing term is zero for all $n > 2$.\n\nFor $n > 2$, the impulse response $h[n]$ must satisfy the homogeneous version of the difference equation:\n$$\nh[n] - 2r\\cos(\\omega_{0})h[n-1] + r^{2}h[n-2] = 0\n$$\nThis is the homogeneous recursion that governs the behavior of the impulse response for sufficiently large $n$ (i.e., after the direct forcing from the input impulse has ceased). The characteristic equation of this recursion is found by assuming a solution of the form $z^n$, leading to:\n$$\nz^2 - 2r\\cos(\\omega_{0})z + r^2 = 0\n$$\nThe roots of this quadratic equation are the characteristic roots, which are identical to the poles of the transfer function $H(z)$:\n$$\nz = \\frac{2r\\cos(\\omega_0) \\pm \\sqrt{(2r\\cos(\\omega_0))^2 - 4r^2}}{2} = r\\cos(\\omega_0) \\pm \\sqrt{r^2\\cos^2(\\omega_0) - r^2}\n$$\n$$\nz = r\\cos(\\omega_0) \\pm \\sqrt{-r^2(1-\\cos^2(\\omega_0))} = r\\cos(\\omega_0) \\pm j r\\sin(\\omega_0)\n$$\nUsing Euler's formula, $\\exp(\\pm j\\theta) = \\cos(\\theta) \\pm j\\sin(\\theta)$, the roots are:\n$$\nz = r \\exp(\\pm j\\omega_0)\n$$\nThus, for $n > 2$, the impulse response $h[n]$ is governed by a homogeneous recursion whose characteristic roots are the poles of the filter.\n\n### Part 2: Homogeneous Solution and Amplitude Envelope\n\nThe general solution to a linear homogeneous recurrence relation with a pair of complex conjugate roots $p_1 = r\\exp(j\\omega_0)$ and $p_2 = r\\exp(-j\\omega_0)$ is of the form:\n$$\nh[n] = C_1 p_1^n + C_2 p_2^n = C_1(r\\exp(j\\omega_0))^n + C_2(r\\exp(-j\\omega_0))^n = r^n(C_1\\exp(j\\omega_0 n) + C_2\\exp(-j\\omega_0 n))\n$$\nSince the filter coefficients are real, its impulse response $h[n]$ must be a real-valued sequence. This requires that the coefficients $C_1$ and $C_2$ be complex conjugates. Let $C_1 = \\frac{A}{2}\\exp(j\\phi)$ and $C_2 = \\frac{A}{2}\\exp(-j\\phi)$, where $A$ and $\\phi$ are real constants. Substituting these into the expression for $h[n]$ gives:\n$$\nh[n] = r^n \\left( \\frac{A}{2}\\exp(j\\phi)\\exp(j\\omega_0 n) + \\frac{A}{2}\\exp(-j\\phi)\\exp(-j\\omega_0 n) \\right)\n$$\n$$\nh[n] = \\frac{A}{2} r^n \\left( \\exp(j(\\omega_0 n + \\phi)) + \\exp(-j(\\omega_0 n + \\phi)) \\right)\n$$\nApplying Euler's formula again ($2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$), we find the form of the impulse response for large $n$:\n$$\nh[n] = A r^n \\cos(\\omega_0 n + \\phi)\n$$\nThis represents a sinusoidal oscillation at the notch frequency $\\omega_0$, modulated by an amplitude envelope. The amplitude envelope is given by the term that bounds the magnitude of the cosine function:\n$$\n\\text{Envelope}(n) = |A r^n \\cos(\\omega_0 n + \\phi)| \\le |A|r^n\n$$\nThe envelope of the response is therefore $E[n] = |A|r^n$. Since the pole radius $r$ is restricted to $0  r  1$, the term $r^n$ is an exponentially decaying function as $n$ increases. This means the impulse response is a decaying sinusoid.\n\nFor high quality-factor (high-Q) filters, the frequency response has a very sharp and narrow notch. This is achieved by placing the poles very close to the unit circle in the $z$-plane, which corresponds to setting the pole radius $r$ to a value very close to $1$. As $r \\to 1^-$, the decay factor $r^n$ diminishes very slowly with increasing $n$. This slow decay of the impulse response envelope is the phenomenon known as \"ringing.\" A sharp feature in the frequency domain (high-Q) necessitates a long, slowly decaying response in the time domain, a direct consequence of the time-frequency uncertainty principle in signal processing.\n\n### Part 3: Derivation of the Decay Time $n_{\\alpha}$\n\nWe aim to find the number of samples $n_{\\alpha}$ at which the envelope has decayed to a fraction $\\alpha$ of its initial value. The envelope's decay is determined by the factor $r^n$. We can define a normalized envelope function $E_{norm}[n] = r^n$, whose initial value at $n=0$ is $E_{norm}[0] = r^0 = 1$.\n\nWe seek the value of $n$, denoted $n_{\\alpha}$, such that the normalized envelope reaches the value $\\alpha$:\n$$\nr^{n_{\\alpha}} = \\alpha\n$$\nTo solve for $n_{\\alpha}$, we take the natural logarithm of both sides of the equation:\n$$\n\\ln(r^{n_{\\alpha}}) = \\ln(\\alpha)\n$$\nUsing the logarithm property $\\ln(x^y) = y\\ln(x)$, we have:\n$$\nn_{\\alpha} \\ln(r) = \\ln(\\alpha)\n$$\nSince $0  r  1$, its logarithm $\\ln(r)$ is negative. We can isolate $n_{\\alpha}$ by dividing by $\\ln(r)$:\n$$\nn_{\\alpha} = \\frac{\\ln(\\alpha)}{\\ln(r)}\n$$\nThis expression is the analytical solution for $n_{\\alpha}$. Given that $0  \\alpha  1$, $\\ln(\\alpha)$ is also negative, so the ratio is positive, as expected for a time index. The problem defines $n_{\\alpha}$ as the smallest nonnegative integer satisfying the condition, which would formally be $n_{\\alpha} = \\lceil \\frac{\\ln(\\alpha)}{\\ln(r)} \\rceil$. However, the derived continuous expression is the standard analytical form for decay time calculations.\n\n### Part 4: Calculation of Decay Time $t_{95\\%}$\n\nWe are given the following parameters for a realistic neuroscience setting:\n- Line-noise frequency to suppress: $f_0 = 50$ Hz\n- Sampling rate: $f_s = 1000$ Hz\n- Pole radius: $r = 0.99$\n- Decay fraction: $\\alpha = 0.05$ (corresponding to a decay to $5\\%$ of the initial amplitude, or a $95\\%$ reduction)\n\nThe notch center frequency in radians per sample is $\\omega_0 = 2\\pi f_0 / f_s = 2\\pi (50) / 1000 = \\pi/10$ rad/sample. As noted in Part 2, the decay rate of the envelope depends only on $r$, not on $\\omega_0$.\n\nUsing the expression derived in Part 3, we first compute the number of samples $n_{0.05}$ for the envelope to decay to the fraction $\\alpha = 0.05$:\n$$\nn_{0.05} = \\frac{\\ln(0.05)}{\\ln(0.99)}\n$$\nThe time duration corresponding to $n$ samples is $t = n \\cdot T_s = n/f_s$, where $T_s$ is the sampling period. Therefore, the decay time $t_{95\\%}$ is:\n$$\nt_{95\\%} = n_{0.05} \\frac{1}{f_s} = \\frac{\\ln(0.05)}{\\ln(0.99)} \\frac{1}{1000 \\text{ s}^{-1}}\n$$\nNow, we compute the numerical value:\n$$\n\\ln(0.05) \\approx -2.995732\n$$\n$$\n\\ln(0.99) \\approx -0.010050\n$$\n$$\nn_{0.05} \\approx \\frac{-2.995732}{-0.010050} \\approx 298.073 \\text{ samples}\n$$\nThe decay time in seconds is:\n$$\nt_{95\\%} \\approx 298.073 \\times \\frac{1}{1000 \\text{ s}} \\approx 0.298073 \\text{ s}\n$$\nThe problem requires the answer in milliseconds, rounded to three significant figures.\n$$\nt_{95\\%} \\approx 0.298073 \\text{ s} \\times 1000 \\frac{\\text{ms}}{\\text{s}} = 298.073 \\text{ ms}\n$$\nRounding to three significant figures, we get:\n$$\nt_{95\\%} \\approx 298 \\text{ ms}\n$$",
            "answer": "$$\\boxed{298}$$"
        }
    ]
}