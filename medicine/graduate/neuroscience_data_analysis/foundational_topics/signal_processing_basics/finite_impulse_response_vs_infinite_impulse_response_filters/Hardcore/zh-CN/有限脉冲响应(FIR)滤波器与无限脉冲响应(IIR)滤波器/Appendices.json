{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固区分有限冲激响应（FIR）和无限冲激响应（IIR）滤波器的核心原则。通过分析一个简单的系统，你将从基本定义出发，运用冲激响应和Z变换来识别滤波器类型，并评估其稳定性和因果性。这项基本技能是理解和选择适合特定神经科学数据分析任务的滤波器的基础 。",
            "id": "4162619",
            "problem": "在用于局部场电位（LFP）分析的细胞外尖峰放电分类中，一个常见的预处理步骤是应用线性时不变数字滤波器来抑制高频噪声，同时保留类尖峰的瞬态信号。考虑一个因果离散时间线性时不变系统，其特征在于脉冲响应 $h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$。一个单一孤立的尖峰放电被建模为输入 $x[n] = \\delta[n]$。从线性时不变系统的基本定义和离散时间序列的卷积运算出发，推导此输入的输出 $y[n]$。使用第一性原理，通过分析 $h[n]$ 的支撑集以及复 $z$ 域中系统函数的结构，确定该系统是有限脉冲响应（FIR）滤波器还是无限脉冲响应（IIR）滤波器。此外，根据标准定义评估其因果性和有界输入有界输出稳定性。\n\n最后，报告样本 $y[2]$ 的精确数值作为最终答案。无需四舍五入，报告的最终值必须是精确的。不要包含任何单位。\n\n首次使用时需定义任何缩略词，例如有限脉冲响应（FIR）、无限脉冲响应（IIR）和局部场电位（LFP）。所有符号和数字必须以数学符号书写。",
            "solution": "在尝试解答之前，对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知条件\n- 系统：因果离散时间线性时不变（LTI）。\n- 脉冲响应：$h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$。其中 $\\delta[n]$ 是克罗内克（Kronecker）$\\delta$ 函数。\n- 输入信号：$x[n] = \\delta[n]$。\n- 任务 1：使用离散时间卷积定义推导输出 $y[n]$。\n- 任务 2：确定系统是有限脉冲响应（FIR）滤波器还是无限脉冲响应（IIR）滤波器。这涉及分析 $h[n]$ 的支撑集和系统函数 $H(z)$。\n- 任务 3：评估因果性和有界输入有界输出（BIBO）稳定性。\n- 任务 4：报告输出样本 $y[2]$ 的精确数值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于数字信号处理的基本原理。滤波器（$h[n]$）和神经元尖峰（$x[n]$）的模型是生物医学工程和计算神经科学等领域的标准教科书简化模型，用于教学目的，特别是在分析局部场电位（LFP）数据的背景下。该问题是适定的，提供了所有必要信息，且没有内部矛盾。目标清晰、客观且可形式化。该问题不违反任何指定的无效标准。\n\n### 步骤 3：结论与行动\n问题被判定为有效。将提供完整的解答。\n\n### 解答推导\n问题要求对一个离散时间 LTI 系统进行多项分析，这是预处理信号（如细胞外记录信号）中的一个常见任务。\n\n首先，我们推导输出信号 $y[n]$。对于一个离散时间 LTI 系统，输出 $y[n]$ 是输入信号 $x[n]$ 与系统脉冲响应 $h[n]$ 的卷积。卷积和定义为：\n$$y[n] = x[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} x[k]h[n-k]$$\n输入信号为单个脉冲，$x[n] = \\delta[n]$。将其代入卷积和：\n$$y[n] = \\sum_{k=-\\infty}^{\\infty} \\delta[k]h[n-k]$$\n克罗内克（Kronecker）$\\delta$ 函数 $\\delta[k]$ 仅在索引 $k=0$ 处非零，其值为 $1$。这个被称为筛选特性的性质将求和简化为在 $k=0$ 处求值的单项：\n$$y[n] = h[n-0] = h[n]$$\n这是一个基本结果：根据定义，LTI 系统对脉冲输入的响应就是系统本身的脉冲响应。因此，输出信号是：\n$$y[n] = h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$$\n\n接下来，我们确定该滤波器是有限脉冲响应（FIR）滤波器还是无限脉冲响应（IIR）滤波器。这可以通过两种相关的方法来完成。\n\n方法 1：分析脉冲响应 $h[n]$ 的支撑集。\nFIR 滤波器的特征是其脉冲响应仅在有限数量的样本上非零。IIR 滤波器的脉冲响应在无限数量的样本上非零。\n给定的脉冲响应是 $h[n] = 1 \\cdot \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$。$h[n]$ 的非零值仅出现在索引 $n=0, 1, 2$ 处。具体来说，$h[0]=1$，$h[1]=\\frac{1}{2}$，$h[2]=\\frac{1}{4}$。对于所有其他整数 $n$，$h[n]=0$。脉冲响应的持续时间是有限的（长度为 $3$）。因此，该系统是一个 FIR 滤波器。\n\n方法 2：分析系统函数 $H(z)$。\n系统函数 $H(z)$ 是脉冲响应 $h[n]$ 的 $z$ 变换：\n$$H(z) = \\mathcal{Z}\\{h[n]\\} = \\sum_{n=-\\infty}^{\\infty} h[n]z^{-n}$$\n代入给定的 $h[n]$：\n$$H(z) = h[0]z^{-0} + h[1]z^{-1} + h[2]z^{-2} = 1 \\cdot 1 + \\frac{1}{2}z^{-1} + \\frac{1}{4}z^{-2}$$\n$$H(z) = 1 + \\frac{1}{2}z^{-1} + \\frac{1}{4}z^{-2}$$\n一个 LTI 系统对应于一个 FIR 滤波器，当且仅当其系统函数 $H(z)$ 是一个关于 $z^{-1}$ 的多项式，这意味着其所有极点都位于原点 $z=0$。为了观察极点，我们可以将 $H(z)$ 写成一个关于 $z$ 的有理函数：\n$$H(z) = \\frac{z^2}{z^2} + \\frac{1}{2}\\frac{z}{z^2} + \\frac{1}{4}\\frac{1}{z^2} = \\frac{z^2 + \\frac{1}{2}z + \\frac{1}{4}}{z^2}$$\n系统函数的极点是分母多项式的根。在这里，分母是 $z^2$，因此在 $z=0$ 处有一个二重极点。由于所有极点都在原点，系统被确认为 FIR 滤波器。通常递归实现的 IIR 滤波器在原点以外的位置有极点。\n\n接下来，我们评估因果性和稳定性。\n因果性：如果一个离散时间 LTI 系统的脉冲响应 $h[n]$ 对于所有负时间索引都为零，即对于 $n  0$ 有 $h[n]=0$，则该系统是因果的。给定的脉冲响应 $h[n]$ 仅在 $n=0, 1, 2$ 时非零。对于所有 $n0$，它都为零。因此，该系统是因果的，正如问题中所述。\n\n有界输入有界输出（BIBO）稳定性：一个 LTI 系统是 BIBO 稳定的，当且仅当其脉冲响应是绝对可和的。条件是：\n$$S = \\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$$\n对于给定的系统，我们计算这个和：\n$$S = \\sum_{n=-\\infty}^{\\infty} |\\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]| = |h[0]| + |h[1]| + |h[2]|$$\n$$S = |1| + \\left|\\frac{1}{2}\\right| + \\left|\\frac{1}{4}\\right| = 1 + \\frac{1}{2} + \\frac{1}{4} = \\frac{4}{4} + \\frac{2}{4} + \\frac{1}{4} = \\frac{7}{4}$$\n由于 $S=\\frac{7}{4}$ 是一个有限值，该系统是 BIBO 稳定的。所有 FIR 滤波器都是稳定的是一个普遍性质。\n\n最后，我们求输出样本 $y[2]$ 的精确数值。如前所述，$y[n] = h[n]$。我们需要计算 $n=2$ 时这个表达式的值：\n$$y[2] = h[2] = 1 \\cdot \\delta[2] + \\frac{1}{2}\\delta[2-1] + \\frac{1}{4}\\delta[2-2]$$\n$$y[2] = 1 \\cdot \\delta[2] + \\frac{1}{2}\\delta[1] + \\frac{1}{4}\\delta[0]$$\n使用克罗内克（Kronecker）$\\delta$ 函数的定义（$\\delta[0]=1$ 且当 $m \\neq 0$ 时 $\\delta[m]=0$）：\n$$y[2] = 1 \\cdot (0) + \\frac{1}{2} \\cdot (0) + \\frac{1}{4} \\cdot (1)$$\n$$y[2] = 0 + 0 + \\frac{1}{4} = \\frac{1}{4}$$\n输出在样本时间 $n=2$ 处的值是 $\\frac{1}{4}$。",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "IIR滤波器因其计算效率而备受青睐，但在实现频率选择性急剧变化的滤波器（如高Q值的陷波滤波器）时，也伴随着独特的挑战。本练习将探讨一个关键的IIR特性：“振铃”现象，即对瞬时信号（如伪迹）产生的持续振荡响应。你将通过分析一个二阶IIR陷波滤波器，从理论上推导出其冲激响应的衰减时间与极点位置之间的直接关系，从而深刻理解IIR滤波器的设计权衡 。",
            "id": "4162561",
            "problem": "一个实验室正在分析受到工频干扰和脉冲运动伪影污染的局部场电位记录。为了在保留神经信号的同时抑制窄带干扰，该实验室采用了一个因果二阶无限脉冲响应 (IIR) 陷波滤波器，其在复$z$平面上的传递函数为\n$$\nH(z) \\;=\\; \\frac{1 \\;-\\; 2\\cos(\\omega_{0})\\,z^{-1} \\;+\\; z^{-2}}{1 \\;-\\; 2 r \\cos(\\omega_{0})\\,z^{-1} \\;+\\; r^{2} z^{-2}},\n$$\n其中 $0  r  1$，$0  \\omega_0  \\pi$。该滤波器的极点位于 $r\\exp(\\pm j\\omega_0)$，零点位于 $\\exp(\\pm j\\omega_0)$。对于高品质因数（高Q值）的陷波，极点半径 $r$ 被设置为非常接近1的值。\n\n请完成以下推导：\n\n- **第1部分**：对于一个单位脉冲输入 $x[n]=\\delta[n]$，推导当 $n$ 足够大时（即在输入脉冲的直接驱动停止后）控制脉冲响应 $h[n]$ 的齐次递推关系。\n- **第2部分**：解释为何脉冲响应的尾部具有衰减正弦波的形式，并指出其振幅包络由极点半径 $r$ 控制。\n- **第3部分**：推导出衰减时间 $n_{\\alpha}$ 的解析表达式，即包络衰减到其初始值的 $\\alpha$ 分数（其中 $0  \\alpha  1$）所需的样本数。\n- **第4部分**：计算 $t_{95\\%}$，即在抑制频率为 $f_0=50$ Hz、采样率为 $f_s=1000$ Hz、极点半径为 $r=0.99$ 的实际神经科学应用中，包络衰减到其初始值的 $5\\%$ 所需的时间。\n\n以毫秒为单位报告 $t_{95\\%}$ 的数值，四舍五入到三位有效数字。仅提交最终数值作为答案。不要包含任何单位。",
            "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，提法得当，且客观。我们可以开始解答。\n\n### 第1部分：差分方程和齐次递推\n\n线性时不变 (LTI) 系统的输入 $X(z)$ 和输出 $Y(z)$ 之间的关系由其传递函数 $H(z) = Y(z)/X(z)$ 给出。对于给定的 IIR 陷波滤波器，我们有：\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{1 - 2\\cos(\\omega_{0})z^{-1} + z^{-2}}{1 - 2 r \\cos(\\omega_{0})z^{-1} + r^{2} z^{-2}}\n$$\n为了找到关联输出序列 $y[n]$ 和输入序列 $x[n]$ 的差分方程，我们交叉相乘各项：\n$$\nY(z) \\left( 1 - 2 r \\cos(\\omega_{0})z^{-1} + r^{2} z^{-2} \\right) = X(z) \\left( 1 - 2\\cos(\\omega_{0})z^{-1} + z^{-2} \\right)\n$$\n现在我们对两边应用Z反变换。回顾Z变换的时移特性，即在Z域中乘以 $z^{-k}$ 对应于在时域中延迟 $k$ 个样本（即 $w[n-k] \\leftrightarrow z^{-k}W(z)$），我们得到线性常系数差分方程：\n$$\ny[n] - 2r\\cos(\\omega_{0})y[n-1] + r^{2}y[n-2] = x[n] - 2\\cos(\\omega_{0})x[n-1] + x[n-2]\n$$\n脉冲响应，记为 $h[n]$，定义为当输入是单位脉冲序列 $x[n] = \\delta[n]$ 时系统的输出。将 $x[n]=\\delta[n]$ 和 $y[n]=h[n]$ 代入差分方程，得到：\n$$\nh[n] - 2r\\cos(\\omega_{0})h[n-1] + r^{2}h[n-2] = \\delta[n] - 2\\cos(\\omega_{0})\\delta[n-1] + \\delta[n-2]\n$$\n此方程的右侧是驱动项。根据定义，单位脉冲 $\\delta[n]$ 仅在 $n=0$ 时非零。因此，$\\delta[n-1]$ 项仅在 $n=1$ 时非零，而 $\\delta[n-2]$ 项仅在 $n=2$ 时非零。所以，对于所有 $n > 2$，整个驱动项都为零。\n\n对于 $n > 2$，脉冲响应 $h[n]$ 必须满足该差分方程的齐次形式：\n$$\nh[n] - 2r\\cos(\\omega_{0})h[n-1] + r^{2}h[n-2] = 0\n$$\n这就是在 $n$ 足够大时（即输入脉冲的直接驱动停止后）控制脉冲响应行为的齐次递推关系。该递推关系的特征方程可以通过假设一个形式为 $z^n$ 的解来找到，从而得到：\n$$\nz^2 - 2r\\cos(\\omega_{0})z + r^2 = 0\n$$\n这个二次方程的根是特征根，它们与传递函数 $H(z)$ 的极点相同：\n$$\nz = \\frac{2r\\cos(\\omega_0) \\pm \\sqrt{(2r\\cos(\\omega_0))^2 - 4r^2}}{2} = r\\cos(\\omega_0) \\pm \\sqrt{r^2\\cos^2(\\omega_0) - r^2}\n$$\n$$\nz = r\\cos(\\omega_0) \\pm \\sqrt{-r^2(1-\\cos^2(\\omega_0))} = r\\cos(\\omega_0) \\pm j r\\sin(\\omega_0)\n$$\n使用欧拉公式 $\\exp(\\pm j\\theta) = \\cos(\\theta) \\pm j\\sin(\\theta)$，根为：\n$$\nz = r \\exp(\\pm j\\omega_0)\n$$\n因此，对于 $n > 2$，脉冲响应 $h[n]$ 由一个齐次递推关系控制，其特征根是滤波器的极点。\n\n### 第2部分：齐次解和振幅包络\n\n具有一对共轭复根 $p_1 = r\\exp(j\\omega_0)$ 和 $p_2 = r\\exp(-j\\omega_0)$ 的线性齐次递推关系的一般解形式为：\n$$\nh[n] = C_1 p_1^n + C_2 p_2^n = C_1(r\\exp(j\\omega_0))^n + C_2(r\\exp(-j\\omega_0))^n = r^n(C_1\\exp(j\\omega_0 n) + C_2\\exp(-j\\omega_0 n))\n$$\n由于滤波器的系数是实数，其脉冲响应 $h[n]$ 必须是一个实值序列。这要求系数 $C_1$ 和 $C_2$ 是复共轭的。设 $C_1 = \\frac{A}{2}\\exp(j\\phi)$ 和 $C_2 = \\frac{A}{2}\\exp(-j\\phi)$，其中 $A$ 和 $\\phi$ 是实常数。将这些代入 $h[n]$ 的表达式中得到：\n$$\nh[n] = r^n \\left( \\frac{A}{2}\\exp(j\\phi)\\exp(j\\omega_0 n) + \\frac{A}{2}\\exp(-j\\phi)\\exp(-j\\omega_0 n) \\right)\n$$\n$$\nh[n] = \\frac{A}{2} r^n \\left( \\exp(j(\\omega_0 n + \\phi)) + \\exp(-j(\\omega_0 n + \\phi)) \\right)\n$$\n再次应用欧拉公式（$2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$），我们得到大 $n$ 时脉冲响应的形式：\n$$\nh[n] = A r^n \\cos(\\omega_0 n + \\phi)\n$$\n这表示一个在陷波频率 $\\omega_0$ 处的正弦振荡，并由一个振幅包络所调制。振幅包络由限制余弦函数幅值的项给出：\n$$\n\\text{Envelope}(n) = |A r^n \\cos(\\omega_0 n + \\phi)| \\le |A|r^n\n$$\n因此，响应的包络是 $E[n] = |A|r^n$。由于极点半径 $r$ 被限制在 $0  r  1$ 之间，随着 $n$ 的增加，$r^n$ 项是一个指数衰减函数。这意味着脉冲响应是一个衰减的正弦波。\n\n对于高品质因数 (high-Q) 滤波器，其频率响应具有一个非常尖锐和狭窄的陷波。这是通过将极点放置在 $z$ 平面中非常靠近单位圆的位置来实现的，这对应于将极点半径 $r$ 设置为一个非常接近1的值。当 $r \\to 1^-$ 时，衰减因子 $r^n$ 随着 $n$ 的增加而衰减得非常缓慢。脉冲响应包络的这种缓慢衰减现象被称为“振铃”。频域中的一个尖锐特征（高Q值）必然要求时域中有一个长的、缓慢衰减的响应，这是信号处理中时频不确定性原理的直接结果。\n\n### 第3部分：衰减时间 $n_{\\alpha}$ 的推导\n\n我们的目标是找到样本数 $n_{\\alpha}$，在该点包络已衰减到其初始值的分数 $\\alpha$。包络的衰减由因子 $r^n$ 决定。我们可以定义一个归一化包络函数 $E_{norm}[n] = r^n$，其在 $n=0$ 时的初始值为 $E_{norm}[0] = r^0 = 1$。\n\n我们寻求 $n$ 的值，记为 $n_{\\alpha}$，使得归一化包络达到值 $\\alpha$：\n$$\nr^{n_{\\alpha}} = \\alpha\n$$\n为了解出 $n_{\\alpha}$，我们对等式两边取自然对数：\n$$\n\\ln(r^{n_{\\alpha}}) = \\ln(\\alpha)\n$$\n使用对数性质 $\\ln(x^y) = y\\ln(x)$，我们有：\n$$\nn_{\\alpha} \\ln(r) = \\ln(\\alpha)\n$$\n由于 $0  r  1$，其对数 $\\ln(r)$ 是负数。我们可以通过除以 $\\ln(r)$ 来分离出 $n_{\\alpha}$：\n$$\nn_{\\alpha} = \\frac{\\ln(\\alpha)}{\\ln(r)}\n$$\n这个表达式是 $n_{\\alpha}$ 的解析解。鉴于 $0  \\alpha  1$，$\\ln(\\alpha)$ 也是负数，所以这个比率是正数，正如时间索引所预期的那样。问题将 $n_{\\alpha}$ 定义为满足条件的最小非负整数，其形式上应为 $n_{\\alpha} = \\lceil \\frac{\\ln(\\alpha)}{\\ln(r)} \\rceil$。然而，推导出的连续表达式是衰减时间计算的标准解析形式。\n\n### 第4部分：衰减时间 $t_{95\\%}$ 的计算\n\n我们被给予以下用于真实神经科学情景的参数：\n- 要抑制的工频噪声频率：$f_0 = 50$ Hz\n- 采样率：$f_s = 1000$ Hz\n- 极点半径：$r = 0.99$\n- 衰减分数：$\\alpha = 0.05$（对应于衰减到初始振幅的 $5\\%$，或减少了 $95\\%$）\n\n以弧度/样本为单位的陷波中心频率是 $\\omega_0 = 2\\pi f_0 / f_s = 2\\pi (50) / 1000 = \\pi/10$ rad/sample。如第2部分所述，包络的衰减率仅取决于 $r$，而与 $\\omega_0$ 无关。\n\n使用在第3部分推导的表达式，我们首先计算包络衰减到分数 $\\alpha = 0.05$ 所需的样本数 $n_{0.05}$：\n$$\nn_{0.05} = \\frac{\\ln(0.05)}{\\ln(0.99)}\n$$\n对应于 $n$ 个样本的时间长度是 $t = n \\cdot T_s = n/f_s$，其中 $T_s$ 是采样周期。因此，衰减时间 $t_{95\\%}$ 是：\n$$\nt_{95\\%} = n_{0.05} \\frac{1}{f_s} = \\frac{\\ln(0.05)}{\\ln(0.99)} \\frac{1}{1000 \\text{ s}^{-1}}\n$$\n现在，我们计算数值：\n$$\n\\ln(0.05) \\approx -2.995732\n$$\n$$\n\\ln(0.99) \\approx -0.010050\n$$\n$$\nn_{0.05} \\approx \\frac{-2.995732}{-0.010050} \\approx 298.073 \\text{ samples}\n$$\n以秒为单位的衰减时间是：\n$$\nt_{95\\%} \\approx 298.073 \\times \\frac{1}{1000 \\text{ s}} \\approx 0.298073 \\text{ s}\n$$\n题目要求答案以毫秒为单位，并四舍五入到三位有效数字。\n$$\nt_{95\\%} \\approx 0.298073 \\text{ s} \\times 1000 \\frac{\\text{ms}}{\\text{s}} = 298.073 \\text{ ms}\n$$\n四舍五入到三位有效数字，我们得到：\n$$\nt_{95\\%} \\approx 298 \\text{ ms}\n$$",
            "answer": "$$\\boxed{298}$$"
        },
        {
            "introduction": "在离线神经信号分析中，为了避免相位失真，我们经常使用前向-后向滤波（例如通过`filtfilt`函数实现）来获得零相位响应。然而，这种强大的技术并非没有陷阱。本练习将深入探讨该操作的内部机理，揭示其稳定性如何依赖于所使用的基础IIR滤波器的稳定性，并强调在应用前进行稳定性检查的至关重要性 。",
            "id": "4162638",
            "problem": "一个分析局部场电位记录的实验室应用前后向零相位滤波（通过类似于 `filtfilt` 的算法实现）以避免相位失真。考虑严格因果的单极点无限脉冲响应 (IIR) 原型\n$$H(z)=\\frac{1}{1-a z^{-1}},$$\n其中实极点参数为 $a \\in \\mathbb{R}$。假设一个理想化的无限长度设定（无边缘瞬变），因此每次前向或后向处理都可以被视为一个线性时不变操作。令 $h[n]$ 表示 $H(z)$ 的脉冲响应，令 $g[n]$ 表示前后向算子的总体脉冲响应。\n\n仅从卷积、时间反转和 $z$ 变换的核心定义出发，完成以下任务：\n\n- 从 $H(z)$ 推导出 $h[n]$ 的精确表达式。\n- 从第一性原理出发，证明前后向算子的脉冲响应 $g[n]$ 是 $h[n]$ 的离散时间自相关，并为 $|a|  1$ 的情况推导出 $g[n]$ 作为 $a$ 和 $n$ 的函数的闭式解析表达式。\n- 使用您的表达式，通过识别发散项，明确证明如果 $H(z)$ 的任何极点满足 $|a| \\ge 1$，前后向算子将变得不稳定。\n- 提出在对有限长度的神经科学数据使用前后向滤波之前，应应用于通用有理IIR滤波器 $H(z)=\\frac{B(z)}{A(z)}$ 的具体应用前稳定性检查。这些检查应以其极点和脉冲响应的正则性来表述，并应由推导过程证明其合理性。\n\n仅提交 $g[n]$ 作为 $a$ 和 $n$ 的函数的最终闭式表达式（无单位）。无需四舍五入。此表达式将是唯一的评分项。",
            "solution": "该问题要求基于一阶IIR原型，对前后向零相位滤波算子进行多部分的推导和分析。我们将按要求从第一性原理出发。\n\n设输入信号为 $x[n]$。前向滤波过程将滤波器 $H(z)$ 应用于 $x[n]$，产生一个中间信号 $y_1[n]$。在时域中，这是一个卷积：$y_1[n] = (x * h)[n] = \\sum_{k=-\\infty}^{\\infty} x[k]h[n-k]$。在 $z$ 域中，这是一个乘积：$Y_1(z) = X(z)H(z)$。\n\n后向过程首先将中间信号 $y_1[n]$ 进行时间反转，得到 $y_1' [n] = y_1[-n]$。然后，将相同的滤波器 $H(z)$ 应用于 $y_1'[n]$，产生第二个中间信号 $y_2[n] = (y_1' * h)[n]$。最后，对后向过程的输出进行时间反转，以得到最终输出 $y_{fb}[n] = y_2[-n]$。\n\n我们可以在 $z$ 域中分析这个过程。时间反转信号 $f[-n]$ 的 $z$ 变换是 $F(z^{-1})$。\n1.  时间反转的中间信号的变换：$\\mathcal{Z}\\{y_1' [n]\\} = \\mathcal{Z}\\{y_1[-n]\\} = Y_1(z^{-1}) = X(z^{-1})H(z^{-1})$。\n2.  第二个中间信号的变换：$Y_2(z) = \\mathcal{Z}\\{y_1'[n]\\} H(z) = X(z^{-1})H(z^{-1})H(z)$。\n3.  最终输出的变换：$Y_{fb}(z) = \\mathcal{Z}\\{y_{fb}[n]\\} = \\mathcal{Z}\\{y_2[-n]\\} = Y_2(z^{-1})$。代入 $Y_2(z)$ 的表达式，我们得到：\n    $Y_{fb}(z) = X((z^{-1})^{-1}) H((z^{-1})^{-1}) H(z^{-1}) = X(z)H(z)H(z^{-1})$。\n\n前后向算子的总体传递函数 $G(z)$ 是 $Y_{fb}(z)/X(z)$ 的比率。\n$$G(z) = H(z)H(z^{-1})$$\n总体脉冲响应 $g[n]$ 是 $G(z)$ 的 $z$ 反变换。\n\n**任务1：推导脉冲响应 $h[n]$**\n\n给定的传递函数是 $H(z) = \\frac{1}{1-az^{-1}}$。对于一个严格因果的滤波器，其收敛域 (ROC) 是 $|z| > |a|$。脉冲响应 $h[n]$ 是 $H(z)$ 的 $z$ 反变换。我们可以通过将 $H(z)$ 展开为几何级数来找到它：\n$$H(z) = \\sum_{k=0}^{\\infty} (az^{-1})^k = \\sum_{k=0}^{\\infty} a^k z^{-k}$$\n$z$ 变换的定义是 $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n]z^{-n}$。通过比较两个表达式中 $z^{-n}$ 的系数，我们确定 $h[n]$ 为：\n当 $n \\ge 0$ 时，$h[n] = a^n$；当 $n  0$ 时，$h[n]=0$。\n使用离散时间单位阶跃函数 $u[n]$（其中当 $n \\ge 0$ 时 $u[n]=1$，当 $n  0$ 时 $u[n]=0$），我们可以将其紧凑地写为：\n$$h[n] = a^n u[n]$$\n为使此滤波器稳定，其脉冲响应必须是绝对可和的，即 $\\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$。这要求 $\\sum_{n=0}^{\\infty} |a^n|  \\infty$，此条件当且仅当 $|a|1$ 时成立。\n\n**任务2：证明 $g[n]$ 是 $h[n]$ 的自相关，并推导其闭式表达式**\n\n实信号 $h[n]$ 的离散时间自相关定义为 $r_{hh}[n] = \\sum_{k=-\\infty}^{\\infty} h[k]h[k-n]$。此操作等效于 $h[n]$ 与其时间反转信号 $h[-n]$ 的卷积。\n$$r_{hh}[n] = (h * h_{rev})[n] \\quad \\text{其中 } h_{rev}[n]=h[-n]$$\n自相关的 $z$ 变换为：\n$$\\mathcal{Z}\\{r_{hh}[n]\\} = \\mathcal{Z}\\{h[n]\\} \\mathcal{Z}\\{h[-n]\\} = H(z) H(z^{-1})$$\n这正是我们为总体传递函数 $G(z)$ 推导出的表达式。因此，总体脉冲响应 $g[n]$ 是原型脉冲响应 $h[n]$ 的自相关。\n\n现在，我们为稳定情况 $|a|1$ 推导 $g[n]$ 的闭式表达式。\n$$g[n] = r_{hh}[n] = \\sum_{k=-\\infty}^{\\infty} h[k]h[k-n]$$\n代入 $h[k] = a^k u[k]$:\n$$g[n] = \\sum_{k=-\\infty}^{\\infty} (a^k u[k]) (a^{k-n} u[k-n]) = \\sum_{k=-\\infty}^{\\infty} a^{2k-n} u[k] u[k-n]$$\n阶跃函数之积 $u[k]u[k-n]$ 仅在 $k \\ge 0$ 和 $k-n \\ge 0$（即 $k \\ge n$）时非零。\n我们分析 $n$ 值的两种情况。\n\n情况1：$n \\ge 0$。求和限由 $k \\ge n$ 确定。\n$$g[n] = \\sum_{k=n}^{\\infty} a^{2k-n} = a^{-n} \\sum_{k=n}^{\\infty} a^{2k} = a^{-n} \\sum_{k=n}^{\\infty} (a^2)^k$$\n这是一个几何级数。设索引为 $j=k-n$，因此 $k=j+n$。当 $k=n$ 时，$j=0$。\n$$g[n] = a^{-n} \\sum_{j=0}^{\\infty} (a^2)^{j+n} = a^{-n} (a^2)^n \\sum_{j=0}^{\\infty} (a^2)^j = a^n \\sum_{j=0}^{\\infty} (a^2)^j$$\n由于我们假设 $|a|1$，因此 $a^21$，所以级数收敛到 $\\frac{1}{1-a^2}$。\n$$g[n] = \\frac{a^n}{1-a^2} \\quad \\text{对于 } n \\ge 0$$\n\n情况2：$n  0$。求和限由 $k \\ge 0$ 和 $k \\ge n$ 确定。由于 $n$ 是负数，$k \\ge 0$ 是更严格的条件。\n$$g[n] = \\sum_{k=0}^{\\infty} a^{2k-n} = a^{-n} \\sum_{k=0}^{\\infty} (a^2)^k$$\n同样，级数收敛到 $\\frac{1}{1-a^2}$。\n$$g[n] = \\frac{a^{-n}}{1-a^2} \\quad \\text{对于 } n  0$$\n\n结合两种情况，我们可以对 $a$ 的指数使用绝对值函数：\n$$g[n] = \\frac{a^{|n|}}{1-a^2}$$\n这是总体脉冲响应的闭式表达式。注意 $g[n]=g[-n]$，这证实了脉冲响应是偶函数，对应于零相位频率响应。\n\n**任务3：证明 $|a| \\ge 1$ 时的不稳定性**\n\n闭式表达式 $g[n] = \\frac{a^{|n|}}{1-a^2}$ 是在 $|a|1$ 的假设下推导出来的，因为它依赖于几何级数的收敛。要分析 $|a| \\ge 1$ 的情况，我们必须回到 $g[n]$ 的求和定义。\n让我们考虑 $n \\ge 0$ 的情况，此时 $g[n] = \\sum_{k=n}^{\\infty} a^{2k-n}$。\n如果 $|a| > 1$，那么 $|a^2| > 1$。求和项 $a^{2k-n}$ 的幅值随着 $k$ 的增加而增长，因此和是发散的。对于所有 $n$，脉冲响应 $g[n]$ 都是无穷大。\n如果 $|a| = 1$，那么 $a^2 = 1$。和变为 $g[n] = \\sum_{k=n}^{\\infty} a^{-n} = a^{-n} \\sum_{k=n}^{\\infty} 1$。这是无穷多个常数的和，因此是发散的。\n在 $|a| \\ge 1$ 的两种子情况下，自相关和都是发散的，这意味着脉冲响应 $g[n]$ 的值不是有限的。具有无限脉冲响应的系统根本上是不稳定的。发散项是和 $\\sum_{k} h[k]h[k-n]$ 本身，它无法收敛，因为原型滤波器的脉冲响应 $h[n]$ 不是平方可和的（实际上，对于 $|a|>1$，它甚至不是有界的）。\n\n**任务4：为通用IIR滤波器提出稳定性检查**\n\n对于一个通用有理IIR滤波器 $H(z)=\\frac{B(z)}{A(z)}$，前后向算子的总体传递函数是 $G(z) = H(z)H(z^{-1})$。该算子的稳定性取决于其脉冲响应 $g[n]$ 的性质。\n总体算子是BIBO（有界输入，有界输出）稳定的，当且仅当其脉冲响应 $g[n]$ 是绝对可和的，即 $\\sum_{n=-\\infty}^{\\infty} |g[n]|  \\infty$。\n从推导可知，$g[n]$ 是 $h[n]$ 的自相关。$g[n]$ 绝对可和的一个充分条件是 $h[n]$ 绝对可和。对于一个因果、有理的LTI滤波器，其脉冲响应 $h[n]$ 是绝对可和的，当且仅当其所有极点（分母多项式 $A(z)$ 的根）都严格位于单位圆内部。\n\n因此，以下应用前检查是至关重要的：\n\n1.  **极点稳定性检查：** 在使用原型滤波器 $H(z) = B(z)/A(z)$ 应用前后向滤波之前，必须计算滤波器的所有极点，即分母多项式 $A(z)$ 的根。该过程是稳定的，当且仅当所有极点 $p_k$ 都满足条件 $|p_k|  1$。如果有任何极点位于单位圆上或单位圆外，即 $|p_k| \\ge 1$，则原型滤波器 $H(z)$ 不稳定，其脉冲响应 $h[n]$ 不是绝对可和的，并且得到的自相关 $g[n]$ 也将不是绝对可和的（其定义和将发散），从而导致零相位算子不稳定。\n\n2.  **正则性检查：** 应确认滤波器 $H(z)$ 是正常的（proper），即分子 $B(z)$ 的阶数不大于分母 $A(z)$ 的阶数。这确保了脉冲响应是因果的，在 $n0$ 时没有分量，这是 `filtfilt` 类算法的一个标准假设。",
            "answer": "$$\\boxed{\\frac{a^{|n|}}{1-a^2}}$$"
        }
    ]
}