{
    "hands_on_practices": [
        {
            "introduction": "The fundamental distinction between Finite Impulse Response (FIR) and Infinite Impulse Response (IIR) filters lies, as their names suggest, in the duration of their response to a theoretical impulse. This exercise provides a foundational check of this concept, starting from the first principles of linear time-invariant systems. By working through the convolution of a simple input with a filter defined by a short, finite-length impulse response , you will directly observe how this characteristic not only defines the filter as FIR but also inherently guarantees its stability.",
            "id": "4162619",
            "problem": "In extracellular spike sorting for local field potential (LFP) analysis, a common preprocessing step is to apply a linear time-invariant digital filter to suppress high-frequency noise while preserving spike-like transients. Consider a causal discrete-time linear time-invariant system characterized by the impulse response $h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$. A single isolated spike is modeled as an input $x[n] = \\delta[n]$. Starting from the fundamental definition of linear time-invariant systems and the convolution operation on discrete-time sequences, derive the output $y[n]$ for this input. Using first principles, determine whether the system is a finite impulse response (FIR) filter or an infinite impulse response (IIR) filter by analyzing the support of $h[n]$ and the structure of the system function in the complex $z$-domain. Additionally, assess causality and bounded-input bounded-output stability based on standard definitions. \n\nFinally, report the exact numerical value of the sample $y[2]$ as your final answer. No rounding is required, and your final reported value must be exact. Do not include any units. \n\nDefine any acronyms on first use, such as finite impulse response (FIR), infinite impulse response (IIR), and local field potential (LFP). All symbols and numbers must be written in mathematical notation.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- System: Causal discrete-time linear time-invariant (LTI).\n- Impulse response: $h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$. Here, $\\delta[n]$ is the Kronecker delta function.\n- Input signal: $x[n] = \\delta[n]$.\n- Task 1: Derive the output $y[n]$ using the discrete-time convolution definition.\n- Task 2: Determine if the system is a finite impulse response (FIR) or infinite impulse response (IIR) filter. This involves analysis of the support of $h[n]$ and the system function $H(z)$.\n- Task 3: Assess causality and bounded-input bounded-output (BIBO) stability.\n- Task 4: Report the exact numerical value of the output sample $y[2]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the fundamental principles of digital signal processing. The models for the filter ($h[n]$) and the neuronal spike ($x[n]$) are standard textbook simplifications used for pedagogical purposes in fields like biomedical engineering and computational neuroscience, particularly in the context of analyzing local field potential (LFP) data. The problem is well-posed, with all necessary information provided and no internal contradictions. The objectives are clear, objective, and formalizable. The problem does not violate any of the specified invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\n### Solution Derivation\nThe problem asks for several analyses of a discrete-time LTI system, a common task in preprocessing signals such as those from extracellular recordings.\n\nFirst, we derive the output signal $y[n]$. For a discrete-time LTI system, the output $y[n]$ is the convolution of the input signal $x[n]$ with the system's impulse response $h[n]$. The convolution sum is defined as:\n$$y[n] = x[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} x[k]h[n-k]$$\nThe input signal is given as a single impulse, $x[n] = \\delta[n]$. Substituting this into the convolution sum:\n$$y[n] = \\sum_{k=-\\infty}^{\\infty} \\delta[k]h[n-k]$$\nThe Kronecker delta function $\\delta[k]$ is non-zero only at the index $k=0$, where its value is $1$. This property, known as the sifting property, simplifies the summation to a single term evaluated at $k=0$:\n$$y[n] = h[n-0] = h[n]$$\nThis is a fundamental result: the response of an LTI system to an impulse input is, by definition, the impulse response of the system itself. Therefore, the output signal is:\n$$y[n] = h[n] = \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$$\n\nNext, we determine whether the filter is a finite impulse response (FIR) or an infinite impulse response (IIR) filter. This can be done by two related methods.\n\nMethod 1: Analyzing the support of the impulse response $h[n]$.\nAn FIR filter is characterized by an impulse response that is non-zero for only a finite number of samples. An IIR filter has an impulse response that is non-zero for an infinite number of samples.\nThe given impulse response is $h[n] = 1 \\cdot \\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]$. The non-zero values of $h[n]$ occur only at indices $n=0, 1, 2$. Specifically, $h[0]=1$, $h[1]=\\frac{1}{2}$, and $h[2]=\\frac{1}{4}$. For all other integer values of $n$, $h[n]=0$. The duration of the impulse response is finite (length $3$). Therefore, the system is an FIR filter.\n\nMethod 2: Analyzing the system function $H(z)$.\nThe system function $H(z)$ is the $z$-transform of the impulse response $h[n]$:\n$$H(z) = \\mathcal{Z}\\{h[n]\\} = \\sum_{n=-\\infty}^{\\infty} h[n]z^{-n}$$\nSubstituting the given $h[n]$:\n$$H(z) = h[0]z^{-0} + h[1]z^{-1} + h[2]z^{-2} = 1 \\cdot 1 + \\frac{1}{2}z^{-1} + \\frac{1}{4}z^{-2}$$\n$$H(z) = 1 + \\frac{1}{2}z^{-1} + \\frac{1}{4}z^{-2}$$\nAn LTI system corresponds to an FIR filter if and only if its system function $H(z)$ is a polynomial in $z^{-1}$, which means all its poles are located at the origin $z=0$. To see the poles, we can write $H(z)$ as a rational function of $z$:\n$$H(z) = \\frac{z^2}{z^2} + \\frac{1}{2}\\frac{z}{z^2} + \\frac{1}{4}\\frac{1}{z^2} = \\frac{z^2 + \\frac{1}{2}z + \\frac{1}{4}}{z^2}$$\nThe poles of the system function are the roots of the denominator polynomial. Here, the denominator is $z^2$, so there is a double pole at $z=0$. Since all poles are at the origin, the system is confirmed to be an FIR filter. IIR filters, which are typically implemented recursively, have poles at locations other than the origin.\n\nNext, we assess causality and stability.\nCausality: A discrete-time LTI system is causal if its impulse response $h[n]$ is zero for all negative time indices, i.e., $h[n]=0$ for $n  0$. The given impulse response $h[n]$ is non-zero only for $n=0, 1, 2$. It is zero for all $n0$. Thus, the system is causal, as stated in the problem.\n\nBounded-Input Bounded-Output (BIBO) Stability: An LTI system is BIBO stable if and only if its impulse response is absolutely summable. The condition is:\n$$S = \\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$$\nFor the given system, we compute this sum:\n$$S = \\sum_{n=-\\infty}^{\\infty} |\\delta[n] + \\frac{1}{2}\\delta[n-1] + \\frac{1}{4}\\delta[n-2]| = |h[0]| + |h[1]| + |h[2]|$$\n$$S = |1| + \\left|\\frac{1}{2}\\right| + \\left|\\frac{1}{4}\\right| = 1 + \\frac{1}{2} + \\frac{1}{4} = \\frac{4}{4} + \\frac{2}{4} + \\frac{1}{4} = \\frac{7}{4}$$\nSince $S=\\frac{7}{4}$ is a finite value, the system is BIBO stable. It is a general property that all FIR filters are stable.\n\nFinally, we find the exact numerical value of the output sample $y[2]$. As established, $y[n] = h[n]$. We need to evaluate this expression for $n=2$:\n$$y[2] = h[2] = 1 \\cdot \\delta[2] + \\frac{1}{2}\\delta[2-1] + \\frac{1}{4}\\delta[2-2]$$\n$$y[2] = 1 \\cdot \\delta[2] + \\frac{1}{2}\\delta[1] + \\frac{1}{4}\\delta[0]$$\nUsing the definition of the Kronecker delta function ($\\delta[0]=1$ and $\\delta[m]=0$ for $m \\neq 0$):\n$$y[2] = 1 \\cdot (0) + \\frac{1}{2} \\cdot (0) + \\frac{1}{4} \\cdot (1)$$\n$$y[2] = 0 + 0 + \\frac{1}{4} = \\frac{1}{4}$$\nThe value of the output at sample time $n=2$ is $\\frac{1}{4}$.",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "IIR filters achieve their characteristic sharp frequency responses and computational efficiency through recursive structures, which mathematically correspond to poles in their transfer function. This power, however, comes with a critical trade-off that is explored in this practice . You will analyze the direct link between pole location and filter behavior, demonstrating how placing poles very close to the unit circle to create a high-Q notch filter can cause prolonged \"ringing\" artifacts in the time domain, a common issue that can obscure neural data following transient events like spikes or electrical artifacts.",
            "id": "4162561",
            "problem": "A laboratory is analyzing local field potential recordings contaminated by mains interference and impulsive motion artifacts. To suppress the narrowband interference while preserving neural signals, the laboratory deploys a causal, second-order Infinite Impulse Response (IIR) notch filter whose transfer function in the complex $z$-plane is\n$$\nH(z) \\;=\\; \\frac{1 \\;-\\; 2\\cos(\\omega_{0})\\,z^{-1} \\;+\\; z^{-2}}{1 \\;-\\; 2 r \\cos(\\omega_{0})\\,z^{-1} \\;+\\; r^{2} z^{-2}},\n$$\nwhere $0r1$ is the pole radius controlling the quality factor, and $\\omega_{0}$ is the notch center in radians per sample. The data are sampled at rate $f_{s}$ and contain an impulsive artifact modeled as $\\delta[n]$ entering the filter input. You may assume the system is Linear Time-Invariant (LTI). You will analyze the ring-down caused by the poles and estimate how long the ringing persists until it decays to a specified fraction of its initial envelope.\n\nStarting only from the definitions of impulse response and the standard relationship between a rational $H(z)$ and its corresponding linear constant-coefficient difference equation, address the following:\n\n1) Write the constant-coefficient linear difference equation obeyed by the impulse response $h[n]$ implied by $H(z)$, and argue why, for $n$ sufficiently large that the direct forcing on the right-hand side vanishes, the response $h[n]$ must satisfy the homogeneous recursion associated with the characteristic roots at $z = r \\exp(\\pm j \\omega_{0})$.\n\n2) Solve the homogeneous recursion to obtain the general form of $h[n]$ for $n$ beyond the directly forced indices, and derive the form of the amplitude envelope of $h[n]$ in terms of $r$ and $n$. Clearly state how the envelope behaves with $n$ and why this corresponds to prolonged ringing for high quality factor (high-$Q$) poles.\n\n3) Define $n_{\\alpha}$ as the smallest nonnegative integer such that the envelope magnitude has decreased to a factor $\\alpha \\in (0,1)$ of its initial value. Derive an analytic expression for $n_{\\alpha}$ in terms of $r$ and $\\alpha$, using only logarithms and without invoking any pre-memorized decay-time formulas.\n\n4) Consider a realistic neuroscience setting: line-noise suppression at frequency $f_{0} = 50$ Hz from data sampled at $f_{s} = 1000$ Hz, so that $\\omega_{0} = 2\\pi f_{0}/f_{s}$ in radians per sample. Take $r = 0.99$. Using your expression from part $3$, compute the decay time $t_{95\\%}$ at which the ringing envelope has fallen to $\\alpha = 0.05$ of its initial value. Express $t_{95\\%}$ in milliseconds. Round your answer to three significant figures. State angles in radians if needed.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded, well-posed, and objective. We may proceed with the solution.\n\n### Part 1: Difference Equation and Homogeneous Recursion\n\nThe relationship between the input $X(z)$ and output $Y(z)$ of a Linear Time-Invariant (LTI) system is given by its transfer function $H(z) = Y(z)/X(z)$. For the given IIR notch filter, we have:\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{1 - 2\\cos(\\omega_{0})z^{-1} + z^{-2}}{1 - 2 r \\cos(\\omega_{0})z^{-1} + r^{2} z^{-2}}\n$$\nTo find the difference equation relating the output sequence $y[n]$ to the input sequence $x[n]$, we cross-multiply the terms:\n$$\nY(z) \\left( 1 - 2 r \\cos(\\omega_{0})z^{-1} + r^{2} z^{-2} \\right) = X(z) \\left( 1 - 2\\cos(\\omega_{0})z^{-1} + z^{-2} \\right)\n$$\nWe now apply the inverse Z-transform to both sides. Recalling the time-shifting property of the Z-transform, where a multiplication by $z^{-k}$ in the Z-domain corresponds to a time delay of $k$ samples in the time domain (i.e., $w[n-k] \\leftrightarrow z^{-k}W(z)$), we obtain the linear constant-coefficient difference equation:\n$$\ny[n] - 2r\\cos(\\omega_{0})y[n-1] + r^{2}y[n-2] = x[n] - 2\\cos(\\omega_{0})x[n-1] + x[n-2]\n$$\nThe impulse response, denoted $h[n]$, is defined as the output of the system when the input is the unit impulse sequence, $x[n] = \\delta[n]$. Substituting $x[n]=\\delta[n]$ and $y[n]=h[n]$ into the difference equation gives:\n$$\nh[n] - 2r\\cos(\\omega_{0})h[n-1] + r^{2}h[n-2] = \\delta[n] - 2\\cos(\\omega_{0})\\delta[n-1] + \\delta[n-2]\n$$\nThe right-hand side of this equation is the forcing term. By definition, the unit impulse $\\delta[n]$ is non-zero only at $n=0$. Consequently, the term $\\delta[n-1]$ is non-zero only at $n=1$, and $\\delta[n-2]$ is non-zero only at $n=2$. Therefore, the entire forcing term is zero for all $n  2$.\n\nFor $n  2$, the impulse response $h[n]$ must satisfy the homogeneous version of the difference equation:\n$$\nh[n] - 2r\\cos(\\omega_{0})h[n-1] + r^{2}h[n-2] = 0\n$$\nThis is the homogeneous recursion that governs the behavior of the impulse response for sufficiently large $n$ (i.e., after the direct forcing from the input impulse has ceased). The characteristic equation of this recursion is found by assuming a solution of the form $z^n$, leading to:\n$$\nz^2 - 2r\\cos(\\omega_{0})z + r^2 = 0\n$$\nThe roots of this quadratic equation are the characteristic roots, which are identical to the poles of the transfer function $H(z)$:\n$$\nz = \\frac{2r\\cos(\\omega_0) \\pm \\sqrt{(2r\\cos(\\omega_0))^2 - 4r^2}}{2} = r\\cos(\\omega_0) \\pm \\sqrt{r^2\\cos^2(\\omega_0) - r^2}\n$$\n$$\nz = r\\cos(\\omega_0) \\pm \\sqrt{-r^2(1-\\cos^2(\\omega_0))} = r\\cos(\\omega_0) \\pm j r\\sin(\\omega_0)\n$$\nUsing Euler's formula, $\\exp(\\pm j\\theta) = \\cos(\\theta) \\pm j\\sin(\\theta)$, the roots are:\n$$\nz = r \\exp(\\pm j\\omega_0)\n$$\nThus, for $n  2$, the impulse response $h[n]$ is governed by a homogeneous recursion whose characteristic roots are the poles of the filter.\n\n### Part 2: Homogeneous Solution and Amplitude Envelope\n\nThe general solution to a linear homogeneous recurrence relation with a pair of complex conjugate roots $p_1 = r\\exp(j\\omega_0)$ and $p_2 = r\\exp(-j\\omega_0)$ is of the form:\n$$\nh[n] = C_1 p_1^n + C_2 p_2^n = C_1(r\\exp(j\\omega_0))^n + C_2(r\\exp(-j\\omega_0))^n = r^n(C_1\\exp(j\\omega_0 n) + C_2\\exp(-j\\omega_0 n))\n$$\nSince the filter coefficients are real, its impulse response $h[n]$ must be a real-valued sequence. This requires that the coefficients $C_1$ and $C_2$ be complex conjugates. Let $C_1 = \\frac{A}{2}\\exp(j\\phi)$ and $C_2 = \\frac{A}{2}\\exp(-j\\phi)$, where $A$ and $\\phi$ are real constants. Substituting these into the expression for $h[n]$ gives:\n$$\nh[n] = r^n \\left( \\frac{A}{2}\\exp(j\\phi)\\exp(j\\omega_0 n) + \\frac{A}{2}\\exp(-j\\phi)\\exp(-j\\omega_0 n) \\right)\n$$\n$$\nh[n] = \\frac{A}{2} r^n \\left( \\exp(j(\\omega_0 n + \\phi)) + \\exp(-j(\\omega_0 n + \\phi)) \\right)\n$$\nApplying Euler's formula again ($2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$), we find the form of the impulse response for large $n$:\n$$\nh[n] = A r^n \\cos(\\omega_0 n + \\phi)\n$$\nThis represents a sinusoidal oscillation at the notch frequency $\\omega_0$, modulated by an amplitude envelope. The amplitude envelope is given by the term that bounds the magnitude of the cosine function:\n$$\n\\text{Envelope}(n) = |A r^n \\cos(\\omega_0 n + \\phi)| \\le |A|r^n\n$$\nThe envelope of the response is therefore $E[n] = |A|r^n$. Since the pole radius $r$ is restricted to $0  r  1$, the term $r^n$ is an exponentially decaying function as $n$ increases. This means the impulse response is a decaying sinusoid.\n\nFor high quality-factor (high-Q) filters, the frequency response has a very sharp and narrow notch. This is achieved by placing the poles very close to the unit circle in the $z$-plane, which corresponds to setting the pole radius $r$ to a value very close to $1$. As $r \\to 1^-$, the decay factor $r^n$ diminishes very slowly with increasing $n$. This slow decay of the impulse response envelope is the phenomenon known as \"ringing.\" A sharp feature in the frequency domain (high-Q) necessitates a long, slowly decaying response in the time domain, a direct consequence of the time-frequency uncertainty principle in signal processing.\n\n### Part 3: Derivation of the Decay Time $n_{\\alpha}$\n\nWe aim to find the number of samples $n_{\\alpha}$ at which the envelope has decayed to a fraction $\\alpha$ of its initial value. The envelope's decay is determined by the factor $r^n$. We can define a normalized envelope function $E_{norm}[n] = r^n$, whose initial value at $n=0$ is $E_{norm}[0] = r^0 = 1$.\n\nWe seek the value of $n$, denoted $n_{\\alpha}$, such that the normalized envelope reaches the value $\\alpha$:\n$$\nr^{n_{\\alpha}} = \\alpha\n$$\nTo solve for $n_{\\alpha}$, we take the natural logarithm of both sides of the equation:\n$$\n\\ln(r^{n_{\\alpha}}) = \\ln(\\alpha)\n$$\nUsing the logarithm property $\\ln(x^y) = y\\ln(x)$, we have:\n$$\nn_{\\alpha} \\ln(r) = \\ln(\\alpha)\n$$\nSince $0  r  1$, its logarithm $\\ln(r)$ is negative. We can isolate $n_{\\alpha}$ by dividing by $\\ln(r)$:\n$$\nn_{\\alpha} = \\frac{\\ln(\\alpha)}{\\ln(r)}\n$$\nThis expression is the analytical solution for $n_{\\alpha}$. Given that $0  \\alpha  1$, $\\ln(\\alpha)$ is also negative, so the ratio is positive, as expected for a time index. The problem defines $n_{\\alpha}$ as the smallest nonnegative integer satisfying the condition, which would formally be $n_{\\alpha} = \\lceil \\frac{\\ln(\\alpha)}{\\ln(r)} \\rceil$. However, the derived continuous expression is the standard analytical form for decay time calculations.\n\n### Part 4: Calculation of Decay Time $t_{95\\%}$\n\nWe are given the following parameters for a realistic neuroscience setting:\n- Line-noise frequency to suppress: $f_0 = 50$ Hz\n- Sampling rate: $f_s = 1000$ Hz\n- Pole radius: $r = 0.99$\n- Decay fraction: $\\alpha = 0.05$ (corresponding to a decay to $5\\%$ of the initial amplitude, or a $95\\%$ reduction)\n\nThe notch center frequency in radians per sample is $\\omega_0 = 2\\pi f_0 / f_s = 2\\pi (50) / 1000 = \\pi/10$ rad/sample. As noted in Part 2, the decay rate of the envelope depends only on $r$, not on $\\omega_0$.\n\nUsing the expression derived in Part 3, we first compute the number of samples $n_{0.05}$ for the envelope to decay to the fraction $\\alpha = 0.05$:\n$$\nn_{0.05} = \\frac{\\ln(0.05)}{\\ln(0.99)}\n$$\nThe time duration corresponding to $n$ samples is $t = n \\cdot T_s = n/f_s$, where $T_s$ is the sampling period. Therefore, the decay time $t_{95\\%}$ is:\n$$\nt_{95\\%} = n_{0.05} \\frac{1}{f_s} = \\frac{\\ln(0.05)}{\\ln(0.99)} \\frac{1}{1000\\,\\text{s}^{-1}}\n$$\nNow, we compute the numerical value:\n$$\n\\ln(0.05) \\approx -2.995732\n$$\n$$\n\\ln(0.99) \\approx -0.010050\n$$\n$$\nn_{0.05} \\approx \\frac{-2.995732}{-0.010050} \\approx 298.073 \\text{ samples}\n$$\nThe decay time in seconds is:\n$$\nt_{95\\%} \\approx 298.073 \\times \\frac{1}{1000\\,\\text{s}} \\approx 0.298073\\,\\text{s}\n$$\nThe problem requires the answer in milliseconds, rounded to three significant figures.\n$$\nt_{95\\%} \\approx 0.298073\\,\\text{s} \\times 1000 \\frac{\\text{ms}}{\\text{s}} = 298.073\\,\\text{ms}\n$$\nRounding to three significant figures, we get:\n$$\nt_{95\\%} \\approx 298\\,\\text{ms}\n$$",
            "answer": "$$\\boxed{298}$$"
        },
        {
            "introduction": "In many offline analyses, preserving the temporal alignment of features is critical, making zero-phase filtering an attractive technique. While forward-backward filtering is a common method to achieve this, its application with IIR filters hides a significant stability pitfall that practitioners must understand. This exercise  deconstructs the forward-backward process, revealing its mathematical equivalence to an autocorrelation and demonstrating precisely why the underlying IIR filter must be strictly stable to guarantee a convergent, usable output.",
            "id": "4162638",
            "problem": "A laboratory analyzing local field potential recordings applies forward–backward zero-phase filtering (as implemented by algorithms analogous to filtfilt) to avoid phase distortion. Consider the strictly causal $1$-pole infinite impulse response (IIR) prototype\n$$H(z)=\\frac{1}{1-a z^{-1}},$$\nwith real pole parameter $a \\in \\mathbb{R}$. Assume an idealized infinite-length setting (no edge transients), so that each forward or backward pass can be treated as a linear time-invariant operation. Let $h[n]$ denote the impulse response of $H(z)$ and let $g[n]$ denote the overall impulse response of the forward–backward operator.\n\nStarting only from the core definitions of convolution, time reversal, and the $z$-transform, do the following:\n\n- Derive the exact expression of $h[n]$ from $H(z)$.\n- Show from first principles that the forward–backward operator has an impulse response $g[n]$ that is the discrete-time autocorrelation of $h[n]$ and derive a closed-form analytic expression for $g[n]$ as a function of $a$ and $n$ for the case $|a|1$.\n- Using your expression, demonstrate explicitly why the forward–backward operator becomes unstable if any pole of $H(z)$ satisfies $|a| \\ge 1$, by identifying the term that diverges.\n- Propose concrete pre-application stability checks that should be applied to a general rational IIR filter $H(z)=\\frac{B(z)}{A(z)}$ before using forward–backward filtering on finite-length neuroscience data, expressed in terms of its poles and impulse response regularity. Your checks should be justified from the derivation.\n\nSubmit only the final closed-form expression for $g[n]$ as a function of $a$ and $n$ (no units). No rounding is required. This expression will be the sole graded quantity.",
            "solution": "The problem asks for a multi-part derivation and analysis of a forward–backward zero-phase filtering operator based on a first-order IIR prototype. We will proceed by first principles as requested.\n\nLet the input signal be $x[n]$. The forward filtering pass applies the filter $H(z)$ to $x[n]$, producing an intermediate signal $y_1[n]$. In the time domain, this is a convolution: $y_1[n] = (x * h)[n] = \\sum_{k=-\\infty}^{\\infty} x[k]h[n-k]$. In the $z$-domain, this is a product: $Y_1(z) = X(z)H(z)$.\n\nThe backward pass first time-reverses the intermediate signal $y_1[n]$ to get $y_1' [n] = y_1[-n]$. Then, it applies the same filter $H(z)$ to $y_1'[n]$, producing a second intermediate signal $y_2[n] = (y_1' * h)[n]$. Finally, the output of the backward pass is time-reversed to yield the final output, $y_{fb}[n] = y_2[-n]$.\n\nWe can analyze this process in the $z$-domain. The $z$-transform of a time-reversed signal $f[-n]$ is $F(z^{-1})$.\n1.  Transform of the time-reversed intermediate signal: $\\mathcal{Z}\\{y_1' [n]\\} = \\mathcal{Z}\\{y_1[-n]\\} = Y_1(z^{-1}) = X(z^{-1})H(z^{-1})$.\n2.  Transform of the second intermediate signal: $Y_2(z) = \\mathcal{Z}\\{y_1'[n]\\} H(z) = X(z^{-1})H(z^{-1})H(z)$.\n3.  Transform of the final output: $Y_{fb}(z) = \\mathcal{Z}\\{y_{fb}[n]\\} = \\mathcal{Z}\\{y_2[-n]\\} = Y_2(z^{-1})$. Substituting the expression for $Y_2(z)$, we get:\n    $Y_{fb}(z) = X((z^{-1})^{-1}) H((z^{-1})^{-1}) H(z^{-1}) = X(z)H(z)H(z^{-1})$.\n\nThe overall transfer function of the forward–backward operator, $G(z)$, is the ratio $Y_{fb}(z)/X(z)$.\n$$G(z) = H(z)H(z^{-1})$$\nThe overall impulse response, $g[n]$, is the inverse $z$-transform of $G(z)$.\n\n**Task 1: Derive the impulse response $h[n]$**\n\nThe given transfer function is $H(z) = \\frac{1}{1-az^{-1}}$. For a strictly causal filter, the region of convergence (ROC) is $|z|  |a|$. The impulse response $h[n]$ is the inverse $z$-transform of $H(z)$. We can find this by expanding $H(z)$ as a geometric series:\n$$H(z) = \\sum_{k=0}^{\\infty} (az^{-1})^k = \\sum_{k=0}^{\\infty} a^k z^{-k}$$\nThe definition of the $z$-transform is $H(z) = \\sum_{n=-\\infty}^{\\infty} h[n]z^{-n}$. By comparing coefficients of $z^{-n}$ in the two expressions, we identify $h[n]$ as:\n$h[n] = a^n$ for $n \\ge 0$, and $h[n]=0$ for $n  0$.\nUsing the discrete-time unit step function $u[n]$, where $u[n]=1$ for $n \\ge 0$ and $u[n]=0$ for $n  0$, we can write this compactly as:\n$$h[n] = a^n u[n]$$\nFor this filter to be stable, its impulse response must be absolutely summable, $\\sum_{n=-\\infty}^{\\infty} |h[n]|  \\infty$. This requires $\\sum_{n=0}^{\\infty} |a^n|  \\infty$, which holds if and only if $|a|1$.\n\n**Task 2: Show $g[n]$ is the autocorrelation of $h[n]$ and derive its closed-form expression**\n\nThe discrete-time autocorrelation of a real signal $h[n]$ is defined as $r_{hh}[n] = \\sum_{k=-\\infty}^{\\infty} h[k]h[k-n]$. This operation is equivalent to the convolution of $h[n]$ with its time-reversal, $h[-n]$.\n$$r_{hh}[n] = (h * h_{rev})[n] \\quad \\text{where } h_{rev}[n]=h[-n]$$\nThe $z$-transform of the autocorrelation is:\n$$\\mathcal{Z}\\{r_{hh}[n]\\} = \\mathcal{Z}\\{h[n]\\} \\mathcal{Z}\\{h[-n]\\} = H(z) H(z^{-1})$$\nThis is precisely the expression we derived for the overall transfer function $G(z)$. Therefore, the overall impulse response $g[n]$ is the autocorrelation of the prototype impulse response $h[n]$.\n\nNow, we derive the closed-form expression for $g[n]$ for the stable case $|a|1$.\n$$g[n] = r_{hh}[n] = \\sum_{k=-\\infty}^{\\infty} h[k]h[k-n]$$\nSubstituting $h[k] = a^k u[k]$:\n$$g[n] = \\sum_{k=-\\infty}^{\\infty} (a^k u[k]) (a^{k-n} u[k-n]) = \\sum_{k=-\\infty}^{\\infty} a^{2k-n} u[k] u[k-n]$$\nThe product of step functions $u[k]u[k-n]$ is non-zero only when $k \\ge 0$ and $k-n \\ge 0$ (i.e., $k \\ge n$).\nWe analyze two cases for the value of $n$.\n\nCase 1: $n \\ge 0$. The summation limits are determined by $k \\ge n$.\n$$g[n] = \\sum_{k=n}^{\\infty} a^{2k-n} = a^{-n} \\sum_{k=n}^{\\infty} a^{2k} = a^{-n} \\sum_{k=n}^{\\infty} (a^2)^k$$\nThis is a geometric series. Let the index be $j=k-n$, so $k=j+n$. When $k=n$, $j=0$.\n$$g[n] = a^{-n} \\sum_{j=0}^{\\infty} (a^2)^{j+n} = a^{-n} (a^2)^n \\sum_{j=0}^{\\infty} (a^2)^j = a^n \\sum_{j=0}^{\\infty} (a^2)^j$$\nSince we assume $|a|1$, it follows that $a^21$, so the series converges to $\\frac{1}{1-a^2}$.\n$$g[n] = \\frac{a^n}{1-a^2} \\quad \\text{for } n \\ge 0$$\n\nCase 2: $n  0$. The summation limits are determined by $k \\ge 0$ and $k \\ge n$. Since $n$ is negative, $k \\ge 0$ is the stricter condition.\n$$g[n] = \\sum_{k=0}^{\\infty} a^{2k-n} = a^{-n} \\sum_{k=0}^{\\infty} (a^2)^k$$\nAgain, the series converges to $\\frac{1}{1-a^2}$.\n$$g[n] = \\frac{a^{-n}}{1-a^2} \\quad \\text{for } n  0$$\n\nCombining both cases, we can use the absolute value function for the exponent of $a$:\n$$g[n] = \\frac{a^{|n|}}{1-a^2}$$\nThis is the closed-form expression for the overall impulse response. Note that $g[n]=g[-n]$, confirming that the impulse response is even, which corresponds to a zero-phase frequency response.\n\n**Task 3: Demonstrate instability for $|a| \\ge 1$**\n\nThe closed-form expression $g[n] = \\frac{a^{|n|}}{1-a^2}$ was derived under the assumption $|a|1$, as it relies on the convergence of a geometric series. To analyze the case $|a| \\ge 1$, we must return to the summation definition of $g[n]$.\nLet's consider $n \\ge 0$, for which $g[n] = \\sum_{k=n}^{\\infty} a^{2k-n}$.\nIf $|a|  1$, then $|a^2|  1$. The terms in the sum, $a^{2k-n}$, grow in magnitude as $k$ increases, so the sum diverges. The impulse response $g[n]$ is infinite for all $n$.\nIf $|a| = 1$, then $a^2 = 1$. The sum becomes $g[n] = \\sum_{k=n}^{\\infty} a^{-n} = a^{-n} \\sum_{k=n}^{\\infty} 1$. This is a sum of infinitely many constants and thus diverges.\nIn both subcases where $|a| \\ge 1$, the autocorrelation sum diverges, meaning the values of the impulse response $g[n]$ are not finite. A system with an infinite impulse response is fundamentally unstable. The diverging term is the sum $\\sum_{k} h[k]h[k-n]$ itself, which fails to converge because the impulse response $h[n]$ of the prototype filter is not square-summable (in fact, not even bounded for $|a|1$).\n\n**Task 4: Propose stability checks for a general IIR filter**\n\nFor a general rational IIR filter $H(z)=\\frac{B(z)}{A(z)}$, the overall transfer function of the forward-backward operator is $G(z) = H(z)H(z^{-1})$. The stability of this operator depends on the properties of its impulse response $g[n]$.\nThe overall operator is BIBO stable if and only if its impulse response $g[n]$ is absolutely summable, i.e., $\\sum_{n=-\\infty}^{\\infty} |g[n]|  \\infty$.\nFrom the derivation, $g[n]$ is the autocorrelation of $h[n]$. A sufficient condition for $g[n]$ to be absolutely summable is that $h[n]$ is absolutely summable. For a causal, rational LTI filter, the impulse response $h[n]$ is absolutely summable if and only if all of its poles (the roots of the denominator polynomial $A(z)$) lie strictly inside the unit circle.\n\nTherefore, the following pre-application check is essential:\n\n1.  **Pole Stability Check:** Before applying forward-backward filtering with a prototype filter $H(z) = B(z)/A(z)$, one must compute all poles of the filter, which are the roots of the denominator polynomial $A(z)$. The procedure is stable if and only if all poles $p_k$ satisfy the condition $|p_k|  1$. If any pole lies on or outside the unit circle, i.e., $|p_k| \\ge 1$, the prototype filter $H(z)$ is not stable, its impulse response $h[n]$ is not absolutely summable, and the resulting autocorrelation $g[n]$ will not be absolutely summable (its defining sum will diverge), rendering the zero-phase operator unstable.\n\n2.  **Regularity Check:** It should be confirmed that the filter $H(z)$ is proper, i.e., the degree of the numerator $B(z)$ is not greater than the degree of the denominator $A(z)$. This ensures a causal impulse response without components at $n0$, which is a standard assumption for `filtfilt`-type algorithms.",
            "answer": "$$\\boxed{\\frac{a^{|n|}}{1-a^2}}$$"
        }
    ]
}