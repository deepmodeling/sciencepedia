{
    "hands_on_practices": [
        {
            "introduction": "在神经科学数据分析中，我们常常对模型参数的某个函数感兴趣，而不仅仅是参数本身。例如，我们可能关心一个反应速率的平方，因为它可能与能量消耗有关。本练习将通过单变量Delta方法，为这种转换后估计量的分布和方差的推导提供一个基础性实践。",
            "id": "852388",
            "problem": "考虑一组 $n$ 个独立同分布 (i.i.d.) 的随机变量 $X_1, X_2, \\ldots, X_n$，它们来自参数为 $\\lambda > 0$ 的指数分布。单个观测值 $X_i$ 的概率密度函数 (PDF) 由下式给出：\n$$f(x_i; \\lambda) = \\lambda e^{-\\lambda x_i} \\quad \\text{for} \\quad x_i \\ge 0$$\n\n设 $\\hat{\\lambda}_n$ 是参数 $\\lambda$ 的最大似然估计量 (MLE)。根据最大似然估计量的渐近理论，我们知道 $\\hat{\\lambda}_n$ 是渐近正态的。具体来说，\n$$\n\\sqrt{n}(\\hat{\\lambda}_n - \\lambda) \\xrightarrow{d} N\\left(0, I(\\lambda)^{-1}\\right)\n$$\n当 $n \\to \\infty$ 时，其中 $I(\\lambda)$ 是来自该分布的单个观测值所包含的费雪信息 (Fisher information)。\n\nDelta 方法提供了一种寻找变换后估计量的渐近分布的方法。如果一个随机变量序列 $T_n$ 满足 $\\sqrt{n}(T_n - \\theta) \\xrightarrow{d} N(0, \\sigma^2)$，那么对于一个满足 $g'(\\theta) \\neq 0$ 的连续可微函数 $g$，变换后的序列 $g(T_n)$ 满足：\n$$\n\\sqrt{n}(g(T_n) - g(\\theta)) \\xrightarrow{d} N\\left(0, [g'(\\theta)]^2 \\sigma^2\\right)\n$$\n项 $[g'(\\theta)]^2 \\sigma^2$ 被定义为估计量 $g(T_n)$ 的渐近方差。\n\n你的任务是推导参数 $\\theta = \\lambda^2$ 的最大似然估计量的渐近方差。$\\theta$ 的估计量是通过代入 $\\lambda$ 的最大似然估计量来构造的，即 $\\hat{\\theta}_n = (\\hat{\\lambda}_n)^2$。",
            "solution": "1.  对于速率为 $\\lambda$ 的单个指数分布观测值，其费雪信息为：\n    $$I(\\lambda)=\\mathrm{E}\\left[\\left(\\frac{\\partial}{\\partial\\lambda}\\ln f(X;\\lambda)\\right)^2\\right]=\\frac{1}{\\lambda^2}$$\n    因此，最大似然估计量满足 $\\sqrt{n}(\\hat\\lambda_n-\\lambda)\\Rightarrow N\\bigl(0,\\lambda^2\\bigr)$。\n2.  定义 $\\theta=\\lambda^2$ 和 $g(\\lambda)=\\lambda^2$。那么 $g'(\\lambda)=2\\lambda$。根据 Delta 方法，$\\sqrt{n}\\bigl(g(\\hat\\lambda_n)-g(\\lambda)\\bigr)\\Rightarrow N\\bigl(0,(g'(\\lambda))^2\\lambda^2\\bigr)$。\n3.  计算渐近方差：$(g'(\\lambda))^2\\lambda^2=(2\\lambda)^2\\lambda^2=4\\lambda^4$。",
            "answer": "$$\\boxed{4\\lambda^4}$$"
        },
        {
            "introduction": "神经科学数据通常是多维的，例如在二维空间中追踪动物的位置，或同时记录多个神经元的活动。本练习将挑战你将Delta方法扩展到多维情况，通过一个直观的坐标系转换例子，学习如何使用雅可比矩阵来处理多维变量函数的渐近分布。",
            "id": "852428",
            "problem": "设 $(X_i, Y_i)$（$i=1, \\dots, n$）为一个由 $n$ 个独立同分布 (i.i.d.) 随机向量构成的序列，其中每个 $(X_i, Y_i)$ 均服从单位正方形 $[0, 1] \\times [0, 1]$ 上的均匀分布。令 $(\\bar{X}_n, \\bar{Y}_n)^T = \\frac{1}{n} \\sum_{i=1}^n (X_i, Y_i)^T$ 为样本均值向量。\n\n多元中心极限定理指出，如果 $\\mathbf{Z}_n$ 是独立同分布随机向量的样本均值，其总体均值为 $\\mu$，协方差矩阵为 $\\Sigma$，那么随机向量 $\\sqrt{n}(\\mathbf{Z}_n - \\mu)$ 依分布收敛于一个多元正态分布 $N(\\mathbf{0}, \\Sigma)$。\n\n多元 Delta 方法给出了变换后随机向量的渐近分布。如果 $g: \\mathbb{R}^k \\to \\mathbb{R}^m$ 是一个连续可微函数，那么 $\\sqrt{n}(g(\\mathbf{Z}_n) - g(\\mu))$ 依分布收敛于 $N(\\mathbf{0}, G \\Sigma G^T)$，其中 $G$ 是 $g$ 的 $m \\times k$ 雅可比矩阵，其元素为 $G_{ij} = \\frac{\\partial g_i}{\\partial z_j}$，并在点 $\\mu$ 处求值。\n\n设 $(R_n, \\Theta_n)$ 为样本均值向量 $(\\bar{X}_n, \\bar{Y}_n)$ 在极坐标系中的表示，其中半径为 $R_n = \\sqrt{\\bar{X}_n^2 + \\bar{Y}_n^2}$，角度为 $\\Theta_n = \\arctan(\\bar{Y}_n / \\bar{X}_n)$。设 $(r_\\mu, \\theta_\\mu)$ 为对应于总体均值向量 $\\mu = E[(X_i, Y_i)^T]$ 的极坐标。\n\n设 $\\Sigma_{R\\Theta}$ 为向量 $(\\sqrt{n}(R_n - r_\\mu), \\sqrt{n}(\\Theta_n - \\theta_\\mu))^T$ 的极限正态分布的 $2 \\times 2$ 协方差矩阵。\n\n推导该渐近协方差矩阵的迹 $\\text{Tr}(\\Sigma_{R\\Theta})$。",
            "solution": "1.  总体均值 $\\mu=(E[X],E[Y])=(1/2,1/2)$，协方差 $\\Sigma=\\text{diag}(\\text{Var}(X), \\text{Var}(Y))=\\text{diag}(1/12, 1/12)$。\n2.  定义 $g(x,y)=(r,\\theta)$，其中 $r=\\sqrt{x^2+y^2}$ 且 $\\theta=\\arctan(y/x)$。雅可比矩阵 $G$ 的元素为 $\\frac{\\partial r}{\\partial x}=\\frac{x}{r}$, $\\frac{\\partial r}{\\partial y}=\\frac{y}{r}$, $\\frac{\\partial \\theta}{\\partial x}=-\\frac{y}{x^2+y^2}$, $\\frac{\\partial \\theta}{\\partial y}=\\frac{x}{x^2+y^2}$。\n3.  在 $\\mu$ 处求值：$r_\\mu=\\sqrt{(1/2)^2+(1/2)^2}=1/\\sqrt{2}$，因此 $\\frac{\\partial r}{\\partial x}=\\frac{\\partial r}{\\partial y}=\\frac{1/2}{1/\\sqrt{2}}=\\frac{\\sqrt{2}}{2}$, $\\frac{\\partial \\theta}{\\partial x}=-\\frac{1/2}{1/2}=-1$, $\\frac{\\partial \\theta}{\\partial y}=1$。\n4.  雅可比矩阵为 $G=\\begin{pmatrix} \\sqrt{2}/2 & \\sqrt{2}/2 \\\\ -1 & 1 \\end{pmatrix}$。因此，渐近协方差矩阵为 $\\Sigma_{R\\Theta}=G\\Sigma G^T=\\frac{1}{12}GG^T$。\n5.  计算迹：$\\text{Tr}(\\Sigma_{R\\Theta})=\\frac{1}{12}\\text{Tr}(GG^T)=\\frac{1}{12}\\sum_{i,j}G_{ij}^2 = \\frac{1}{12}\\left[\\left(\\frac{\\sqrt{2}}{2}\\right)^2+\\left(\\frac{\\sqrt{2}}{2}\\right)^2+(-1)^2+1^2\\right]=\\frac{1}{12}\\left(\\frac{1}{2}+\\frac{1}{2}+1+1\\right)=\\frac{3}{12}=\\frac{1}{4}$。",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "比较两组（如实验组与对照组）的响应率是神经科学研究中的一个核心任务。对数优势比（log-odds ratio）是衡量效应大小的常用指标。此练习将应用多变量Delta方法来解决一个实际的统计问题，即推导样本对数优势比的渐近方差，这对于构建置信区间和进行假设检验至关重要。",
            "id": "852421",
            "problem": "考虑从两个不同的伯努利总体中抽取的两个独立随机样本，其样本量分别为 $n_1$ 和 $n_2$。第一个总体的成功概率为 $p_1$，第二个总体的成功概率为 $p_2$。设 $X_1$ 和 $X_2$ 分别为在第一个和第二个样本中观测到的成功次数。那么样本比例由 $\\hat{p}_1 = \\frac{X_1}{n_1}$ 和 $\\hat{p}_2 = \\frac{X_2}{n_2}$ 给出。\n\n在许多统计分析中，特别是在流行病学和临床试验中，对数优势比是一个非常重要的量。真实对数优势比定义为 $\\theta = \\log\\left(\\frac{p_1/(1-p_1)}{p_2/(1-p_2)}\\right)$。基于样本比例，该量的一个估计量是样本对数优势比：\n$$\n\\hat{\\theta} = \\log\\left(\\frac{\\hat{p}_1/(1-\\hat{p}_1)}{\\hat{p}_2/(1-\\hat{p}_2)}\\right)\n$$\n假设样本量 $n_1$ 和 $n_2$ 足够大，中心极限定理可以通过Delta方法进行扩展，以求出 $\\hat{\\theta}$ 的近似分布。\n\n推导对数优势比估计量 $\\text{Var}(\\hat{\\theta})$ 的渐近方差。",
            "solution": "问题要求对数优势比估计量 $\\hat{\\theta}$ 的渐近方差。我们可以使用多元Delta方法来求解。\n\n首先，根据中心极限定理，对于大样本量 $n_1$ 和 $n_2$，样本比例 $\\hat{p}_1$ 和 $\\hat{p}_2$ 近似服从正态分布：\n$$\n\\hat{p}_1 \\approx N\\left(p_1, \\frac{p_1(1-p_1)}{n_1}\\right)\n$$\n$$\n\\hat{p}_2 \\approx N\\left(p_2, \\frac{p_2(1-p_2)}{n_2}\\right)\n$$\n由于两个样本是独立的，随机变量 $\\hat{p}_1$ 和 $\\hat{p}_2$ 也是独立的。因此，样本比例向量 $\\hat{\\mathbf{p}} = (\\hat{p}_1, \\hat{p}_2)^T$ 服从渐近二元正态分布，其均值向量为 $\\boldsymbol{\\mu}$，协方差矩阵为 $\\boldsymbol{\\Sigma}$：\n$$\n\\boldsymbol{\\mu} = E[\\hat{\\mathbf{p}}] = \\begin{pmatrix} p_1 \\\\ p_2 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\Sigma} = \\text{Cov}(\\hat{\\mathbf{p}}) = \\begin{pmatrix} \\text{Var}(\\hat{p}_1) & \\text{Cov}(\\hat{p}_1, \\hat{p}_2) \\\\ \\text{Cov}(\\hat{p}_1, \\hat{p}_2) & \\text{Var}(\\hat{p}_2) \\end{pmatrix} = \\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1} & 0 \\\\ 0 & \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n$$\n估计量 $\\hat{\\theta}$ 是 $\\hat{p}_1$ 和 $\\hat{p}_2$ 的函数。设此函数为 $g(x, y)$：\n$$\ng(x, y) = \\log\\left(\\frac{x/(1-x)}{y/(1-y)}\\right) = \\log(x) - \\log(1-x) - \\log(y) + \\log(1-y)\n$$\n多元Delta方法表明，函数 $g(\\hat{\\mathbf{p}})$ 的渐近方差由下式给出：\n$$\n\\text{Var}(g(\\hat{\\mathbf{p}})) \\approx (\\nabla g(\\boldsymbol{\\mu}))^T \\boldsymbol{\\Sigma} (\\nabla g(\\boldsymbol{\\mu}))\n$$\n其中 $\\nabla g(\\boldsymbol{\\mu})$ 是 $g$ 在均值向量 $\\boldsymbol{\\mu} = (p_1, p_2)^T$ 处的梯度。\n\n首先，我们计算 $g(x, y)$ 的梯度：\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{1}{x} - \\frac{1}{1-x}(-1) = \\frac{1}{x} + \\frac{1}{1-x} = \\frac{1-x+x}{x(1-x)} = \\frac{1}{x(1-x)}\n$$\n$$\n\\frac{\\partial g}{\\partial y} = -\\frac{1}{y} + \\frac{1}{1-y}(-1) = -\\frac{1}{y} - \\frac{1}{1-y} = -\\frac{1-y+y}{y(1-y)} = -\\frac{1}{y(1-y)}\n$$\n所以梯度向量为 $\\nabla g(x,y) = \\left(\\frac{1}{x(1-x)}, -\\frac{1}{y(1-y)}\\right)^T$。\n\n接下来，我们在均值 $\\boldsymbol{\\mu} = (p_1, p_2)^T$ 处计算梯度：\n$$\n\\nabla g(\\boldsymbol{\\mu}) = \\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n现在，我们可以将梯度和协方差矩阵代入Delta方法的方差公式：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx \n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} & -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n\\begin{pmatrix} \\frac{p_1(1-p_1)}{n_1} & 0 \\\\ 0 & \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n我们从左到右进行矩阵乘法。首先，将行向量（梯度的转置）与协方差矩阵相乘：\n$$\n\\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\cdot \\frac{p_1(1-p_1)}{n_1} + (-\\frac{1}{p_2(1-p_2)}) \\cdot 0 & \\frac{1}{p_1(1-p_1)} \\cdot 0 + (-\\frac{1}{p_2(1-p_2)}) \\cdot \\frac{p_2(1-p_2)}{n_2} \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} \\frac{1}{n_1} & -\\frac{1}{n_2} \\end{pmatrix}\n$$\n最后，将得到的行向量与列向量（梯度）相乘：\n$$\n\\text{Var}(\\hat{\\theta}) \\approx \\begin{pmatrix} \\frac{1}{n_1} & -\\frac{1}{n_2} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{p_1(1-p_1)} \\\\ -\\frac{1}{p_2(1-p_2)} \\end{pmatrix}\n$$\n$$\n= \\left(\\frac{1}{n_1}\\right) \\left(\\frac{1}{p_1(1-p_1)}\\right) + \\left(-\\frac{1}{n_2}\\right) \\left(-\\frac{1}{p_2(1-p_2)}\\right)\n$$\n$$\n= \\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_2 p_2 (1-p_2)}\n$$\n这就是对数优势比估计量的渐近方差。",
            "answer": "$$\n\\boxed{\\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_2 p_2 (1-p_2)}}\n$$"
        }
    ]
}