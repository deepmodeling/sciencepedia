{
    "hands_on_practices": [
        {
            "introduction": "To build a strong foundation, we begin by exploring the fundamental distinction between Pearson and Spearman correlation. This first exercise uses a carefully constructed dataset to provide a clear, quantitative illustration of how Pearson's $r$ is sensitive specifically to linear trends, while Spearman's $\\rho_s$ can perfectly capture a more general monotonic relationship. Working through this example will solidify your understanding of which coefficient to choose based on the expected nature of the association in your data.",
            "id": "1911176",
            "problem": "An engineer is studying the effect of adding a novel performance-enhancing coating to a mechanical component. Let $x$ be the thickness of the coating in micrometers and $y$ be the measured efficiency of the component, on a scale from 1 to 20. The following five data points $(x_i, y_i)$ were collected from an experiment:\n$$ (1, 5.0), (2, 8.0), (3, 10.0), (4, 11.0), (10, 11.5) $$\nThe engineer wants to compare the strength of the linear relationship against the strength of the monotonic relationship between the coating thickness and efficiency. To do this, they decide to compute the ratio of the Pearson correlation coefficient, $r$, to the Spearman rank correlation coefficient, $\\rho_s$.\n\nCalculate the value of the ratio $\\frac{r}{\\rho_s}$ for the given dataset. Round your final answer to three significant figures.",
            "solution": "Let $n=5$ and the data be $(x_{i},y_{i})$ for $i=1,\\dots,5$. The Pearson correlation coefficient is\n$$\nr=\\frac{\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y})}{\\sqrt{\\left[\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}\\right]\\left[\\sum_{i=1}^{n}(y_{i}-\\bar{y})^{2}\\right]}},\n$$\nwhere $\\bar{x}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}$ and $\\bar{y}=\\frac{1}{n}\\sum_{i=1}^{n}y_{i}$.\n\nCompute the means:\n$$\n\\bar{x}=\\frac{1+2+3+4+10}{5}=4,\\qquad \\bar{y}=\\frac{5.0+8.0+10.0+11.0+11.5}{5}=9.1.\n$$\nCompute deviations, cross-products, and squares:\n$$\n\\begin{aligned}\n(x_{i}-\\bar{x})=(-3,-2,-1,0,6),\\\\\n(y_{i}-\\bar{y})=(-4.1,-1.1,0.9,1.9,2.4),\\\\\n\\sum (x_{i}-\\bar{x})(y_{i}-\\bar{y})=12.3+2.2-0.9+0+14.4=28,\\\\\n\\sum (x_{i}-\\bar{x})^{2}=9+4+1+0+36=50,\\\\\n\\sum (y_{i}-\\bar{y})^{2}=16.81+1.21+0.81+3.61+5.76=28.2.\n\\end{aligned}\n$$\nThus\n$$\nr=\\frac{28}{\\sqrt{50\\cdot 28.2}}=\\frac{28}{\\sqrt{1410}}.\n$$\n\nThe Spearman rank correlation $\\rho_{s}$ is the Pearson correlation of the ranks. There are no ties and the ranks for $x$ and $y$ are both $(1,2,3,4,5)$, so using\n$$\n\\rho_{s}=1-\\frac{6\\sum_{i=1}^{n}d_{i}^{2}}{n(n^{2}-1)},\n$$\nwith $d_{i}$ the rank differences, we have $d_{i}=0$ for all $i$, hence $\\rho_{s}=1$.\n\nTherefore, the desired ratio is\n$$\n\\frac{r}{\\rho_{s}}=r=\\frac{28}{\\sqrt{1410}}\\approx 0.745673\\ \\Rightarrow\\ \\text{to three significant figures } 0.746.\n$$",
            "answer": "$$\\boxed{0.746}$$"
        },
        {
            "introduction": "Moving from a general example to a scenario deeply rooted in neuroscience, we now consider the common phenomenon of neural response saturation. Many biological relationships are monotonic but non-linear, and failing to account for this can lead to underestimating the strength of an association . This practice uses a realistic model of a neuron's firing rate to demonstrate how Spearman correlation provides a more robust and often more meaningful measure of association in such ubiquitous experimental contexts.",
            "id": "4184829",
            "problem": "A single cortical neuron is probed with graded current injections of stimulus intensity $s$ (arbitrary units). Due to biophysical constraints (finite firing capacity and refractory effects), its steady-state firing rate $r$ follows a monotonic but saturating input-output function consistent with receptor-ligand kinetics, specifically $r(s) = \\frac{r_{\\max} s}{K + s}$, where $r_{\\max}  0$ and $K  0$ are constants. In one session, the experimenter uses $s$ values $s \\in \\{\\,0, 1, 2, 3, 4\\,\\}$ and measures the corresponding $r$ values as\n$$\nr \\in \\left\\{\\,0, \\frac{1}{2}, \\frac{2}{3}, \\frac{3}{4}, \\frac{4}{5}\\,\\right\\}.\n$$\nYou are to analyze the association between $s$ and $r$ using both the linear correlation perspective and the rank-based association perspective. Explain, starting from core definitions used in statistical data analysis, why the linear association metric for these data underestimates the underlying relationship in this saturating, monotonic regime, while the rank-based association captures the monotonic dependence.\n\nCompute the Spearman rank correlation coefficient $\\rho_{s}$ for this dataset. Provide only the value of $\\rho_{s}$ as your final answer. If any numerical approximation were required, you would be instructed to round to a specified number of significant figures; however, this problem does not require rounding.",
            "solution": "We begin from core definitions relevant to statistical association analysis in neuroscience data. The Pearson correlation coefficient between two real-valued variables $X$ and $Y$ is defined as\n$$\n\\rho_{P}(X,Y) = \\frac{\\operatorname{cov}(X,Y)}{\\sigma_{X}\\,\\sigma_{Y}} = \\frac{\\mathbb{E}\\!\\left[(X - \\mathbb{E}[X])(Y - \\mathbb{E}[Y])\\right]}{\\sqrt{\\mathbb{E}\\!\\left[(X - \\mathbb{E}[X])^{2}\\right]} \\sqrt{\\mathbb{E}\\!\\left[(Y - \\mathbb{E}[Y])^{2}\\right]}}.\n$$\nIn the finite-sample case with observed pairs $\\{(x_{i},y_{i})\\}_{i=1}^{n}$, the sample Pearson correlation $r_{P}$ replaces expectations with empirical averages. Pearson correlation quantifies linear association: it equals $1$ if and only if there exist constants $a0$ and $b$ such that $y_{i} = a x_{i} + b$ for all $i$.\n\nThe Spearman rank correlation coefficient, denoted $\\rho_{s}$, is defined as the Pearson correlation of the ranks of the variables. Let $R_{X,i}$ be the rank of $x_{i}$ among $\\{x_{1},\\dots,x_{n}\\}$, and $R_{Y,i}$ be the rank of $y_{i}$ among $\\{y_{1},\\dots,y_{n}\\}$. Then\n$$\n\\rho_{s}(X,Y) = \\rho_{P}(R_{X}, R_{Y}).\n$$\nWhen there are no ties and the mapping $y = f(x)$ is strictly monotonic increasing, the ranks are identical for all pairs, $R_{Y,i} = R_{X,i}$ for all $i$, and hence $\\rho_{s} = 1$ exactly.\n\nWe now apply these definitions to the given dataset. The stimulus intensities are $s \\in \\{\\,0, 1, 2, 3, 4\\,\\}$ and the firing rates are $r \\in \\left\\{\\,0, \\frac{1}{2}, \\frac{2}{3}, \\frac{3}{4}, \\frac{4}{5}\\right\\}$. The response function $r(s) = \\frac{s}{1+s}$ (here $r_{\\max} = 1$ and $K = 1$) is strictly increasing for all $s \\ge 0$, because its derivative is\n$$\n\\frac{d}{ds}\\left(\\frac{s}{1+s}\\right) = \\frac{1}{(1+s)^{2}}  0.\n$$\nTherefore, ordering by $s$ is identical to ordering by $r$. Explicitly, the rank order of $s$ is\n$$\ns: \\quad 0 \\prec 1 \\prec 2 \\prec 3 \\prec 4 \\quad \\Rightarrow \\quad R_{S} = (1, 2, 3, 4, 5),\n$$\nand the rank order of $r$ is\n$$\nr: \\quad 0 \\prec \\frac{1}{2} \\prec \\frac{2}{3} \\prec \\frac{3}{4} \\prec \\frac{4}{5} \\quad \\Rightarrow \\quad R_{R} = (1, 2, 3, 4, 5).\n$$\nThere are no ties. Hence $R_{R,i} = R_{S,i}$ for all $i \\in \\{1,2,3,4,5\\}$, and the Spearman rank correlation is\n$$\n\\rho_{s} = \\rho_{P}(R_{S}, R_{R}) = \\rho_{P}(R_{S}, R_{S}) = 1.\n$$\n\nTo illuminate why Pearson correlation underestimates association strength here, we compute the sample Pearson correlation for these specific values to show it is strictly less than $1$. Let $n = 5$, $x_{i} \\equiv s_{i} \\in \\{0,1,2,3,4\\}$, and $y_{i} \\equiv r_{i} \\in \\left\\{0, \\frac{1}{2}, \\frac{2}{3}, \\frac{3}{4}, \\frac{4}{5}\\right\\}$. The sample means are\n$$\n\\bar{x} = \\frac{0+1+2+3+4}{5} = 2, \\qquad \\bar{y} = \\frac{0 + \\frac{1}{2} + \\frac{2}{3} + \\frac{3}{4} + \\frac{4}{5}}{5} = \\frac{163}{300}.\n$$\nThe sample covariance numerator is\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})(y_{i}-\\bar{y}) = \\frac{37}{20}.\n$$\nThe sample variance sums are\n$$\n\\sum_{i=1}^{5}(x_{i}-\\bar{x})^{2} = 10, \\qquad \\sum_{i=1}^{5}(y_{i}-\\bar{y})^{2} = \\frac{947}{2250}.\n$$\nThus, the sample Pearson correlation is\n$$\nr_{P} = \\frac{\\frac{37}{20}}{\\sqrt{10}\\,\\sqrt{\\frac{947}{2250}}} \\approx 0.9012,\n$$\nwhich is less than $1$, despite the underlying dependence being perfectly monotonic. The reason is that Pearson correlation quantifies linear alignment; here the relationship $y = \\frac{x}{1+x}$ is concave and saturating: increments in $x$ at higher values yield diminishing increments in $y$, compressing variation in $y$ at the high end. This curvature reduces linear association even though the ordinal association is perfect. In contrast, Spearman rank correlation ignores the specific nonlinearity and uses ranks; because the mapping is strictly increasing with no ties, the rank order is identical, yielding $\\rho_{s} = 1$.\n\nTherefore, for this monotonic but saturating neural response, Spearman’s $\\rho_{s}$ captures the full association ($\\rho_{s} = 1$), while Pearson correlation underestimates it (here $r_{P} \\approx 0.9012$).",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Real-world data is seldom as clean as in theoretical models; it often contains imperfections that require careful handling. One common issue is the presence of tied values, which can arise from instrument quantization or stereotyped biological responses. This exercise tackles this practical challenge head-on, guiding you through the correct procedure for calculating Spearman's $\\rho_s$ by handling ties with average ranks, a crucial skill for ensuring the accuracy and integrity of your analyses.",
            "id": "4184831",
            "problem": "A cortical local field potential (LFP) amplitude $x_i$ and a simultaneously measured evoked firing-rate amplitude $y_i$ were recorded across $n=9$ stimulus trials in a sensory experiment. Due to quantization and repeated response patterns, several trials share identical amplitudes in both signals. The data are:\n- LFP amplitudes (in millivolts): $x = [\\,4.2,\\ 5.1,\\ 5.1,\\ 6.0,\\ 6.0,\\ 6.0,\\ 7.1,\\ 7.1,\\ 8.0\\,]$.\n- Firing-rate amplitudes (in arbitrary units): $y = [\\,13.0,\\ 13.5,\\ 13.5,\\ 14.2,\\ 14.2,\\ 14.2,\\ 15.1,\\ 15.6,\\ 15.1\\,]$.\n\nUsing fundamental definitions—specifically, interpreting Spearman’s correlation as the linear correlation between rank-transformed variables and handling repeated values by assigning tied observations the average of their positional ranks—compute the tie-adjusted Spearman correlation coefficient $\\rho_s$ between $x$ and $y$.\n\nProvide the final answer as an exact value. No rounding is required. The correlation coefficient is dimensionless; no units are required in the final answer.",
            "solution": "The problem requires the computation of the tie-adjusted Spearman correlation coefficient, $\\rho_s$, for two given datasets, $x$ and $y$. The problem specifies that $\\rho_s$ should be calculated as the Pearson product-moment correlation coefficient of the rank-transformed variables.\n\nFirst, the given data are:\nThe number of trials is $n=9$.\nLFP amplitudes: $x = [\\,4.2,\\ 5.1,\\ 5.1,\\ 6.0,\\ 6.0,\\ 6.0,\\ 7.1,\\ 7.1,\\ 8.0\\,]$.\nFiring-rate amplitudes: $y = [\\,13.0,\\ 13.5,\\ 13.5,\\ 14.2,\\ 14.2,\\ 14.2,\\ 15.1,\\ 15.6,\\ 15.1\\,]$.\n\nThe Spearman correlation coefficient, $\\rho_s$, is defined as the Pearson correlation coefficient applied to the ranks of the data. Let $R_{x,i}$ and $R_{y,i}$ be the ranks of the $i$-th observations $x_i$ and $y_i$, respectively. The formula is:\n$$ \\rho_s = \\frac{\\sum_{i=1}^{n} (R_{x,i} - \\bar{R}_x)(R_{y,i} - \\bar{R}_y)}{\\sqrt{\\sum_{i=1}^{n} (R_{x,i} - \\bar{R}_x)^2 \\sum_{i=1}^{n} (R_{y,i} - \\bar{R}_y)^2}} $$\nwhere $\\bar{R}_x$ and $\\bar{R}_y$ are the means of the ranks.\n\nStep 1: Rank the $x$ data.\nThe values of $x$ are already sorted: $[\\,4.2,\\ 5.1,\\ 5.1,\\ 6.0,\\ 6.0,\\ 6.0,\\ 7.1,\\ 7.1,\\ 8.0\\,]$.\nThe initial positional ranks are $[\\,1,\\ 2,\\ 3,\\ 4,\\ 5,\\ 6,\\ 7,\\ 8,\\ 9\\,]$.\nWe handle ties by assigning the average of the ranks to the tied observations.\n- The value $5.1$ occupies ranks $2$ and $3$. The average rank is $\\frac{2+3}{2} = 2.5$.\n- The value $6.0$ occupies ranks $4$, $5$, and $6$. The average rank is $\\frac{4+5+6}{3} = 5$.\n- The value $7.1$ occupies ranks $7$ and $8$. The average rank is $\\frac{7+8}{2} = 7.5$.\n- The value $4.2$ has rank $1$, and $8.0$ has rank $9$.\n\nThe rank vector for $x$, denoted $R_x$, is:\n$$ R_x = [\\,1,\\ 2.5,\\ 2.5,\\ 5,\\ 5,\\ 5,\\ 7.5,\\ 7.5,\\ 9\\,] $$\n\nStep 2: Rank the $y$ data.\nThe original $y$ data vector is $[\\,13.0,\\ 13.5,\\ 13.5,\\ 14.2,\\ 14.2,\\ 14.2,\\ 15.1,\\ 15.6,\\ 15.1\\,]$.\nTo rank these, we sort them while keeping track of their original indices:\nValue | Original Index | Positional Rank\n---|---|---\n$13.0$  | $1$     | $1$\n$13.5$  | $2$     | $2$\n$13.5$  | $3$     | $3$\n$14.2$  | $4$     | $4$\n$14.2$  | $5$     | $5$\n$14.2$  | $6$     | $6$\n$15.1$  | $7$     | $7$\n$15.1$  | $9$     | $8$\n$15.6$  | $8$     | $9$\n\nNow, we compute the average ranks for ties in $y$:\n- The value $13.5$ occupies ranks $2$ and $3$. The average rank is $\\frac{2+3}{2} = 2.5$.\n- The value $14.2$ occupies ranks $4$, $5$, and $6$. The average rank is $\\frac{4+5+6}{3} = 5$.\n- The value $15.1$ occupies ranks $7$ and $8$. The average rank is $\\frac{7+8}{2} = 7.5$.\n- The value $13.0$ has rank $1$, and $15.6$ has rank $9$.\n\nWe now construct the rank vector $R_y$ corresponding to the original order of $y$:\n- $y_1=13.0 \\implies R_{y,1}=1$\n- $y_2=13.5 \\implies R_{y,2}=2.5$\n- $y_3=13.5 \\implies R_{y,3}=2.5$\n- $y_4=14.2 \\implies R_{y,4}=5$\n- $y_5=14.2 \\implies R_{y,5}=5$\n- $y_6=14.2 \\implies R_{y,6}=5$\n- $y_7=15.1 \\implies R_{y,7}=7.5$\n- $y_8=15.6 \\implies R_{y,8}=9$\n- $y_9=15.1 \\implies R_{y,9}=7.5$\n\nThe rank vector for $y$, denoted $R_y$, is:\n$$ R_y = [\\,1,\\ 2.5,\\ 2.5,\\ 5,\\ 5,\\ 5,\\ 7.5,\\ 9,\\ 7.5\\,] $$\n\nStep 3: Calculate mean ranks and sums for the correlation formula.\nFor any set of ranks from $1$ to $n$, with or without ties, the sum of ranks is $\\frac{n(n+1)}{2}$. For $n=9$, the sum is $\\frac{9(10)}{2} = 45$.\nThe mean rank for both $R_x$ and $R_y$ is $\\bar{R} = \\frac{45}{9} = 5$.\nSo, $\\bar{R}_x = 5$ and $\\bar{R}_y = 5$.\n\nNow we calculate the three required sums: $\\sum (R_{x,i} - \\bar{R}_x)(R_{y,i} - \\bar{R}_y)$, $\\sum (R_{x,i} - \\bar{R}_x)^2$, and $\\sum (R_{y,i} - \\bar{R}_y)^2$.\nLet $d_{x,i} = R_{x,i} - 5$ and $d_{y,i} = R_{y,i} - 5$.\n\nThe vectors of deviations from the mean are:\n$d_x = [\\, -4,\\ -2.5,\\ -2.5,\\ 0,\\ 0,\\ 0,\\ 2.5,\\ 2.5,\\ 4 \\,]$\n$d_y = [\\, -4,\\ -2.5,\\ -2.5,\\ 0,\\ 0,\\ 0,\\ 2.5,\\ 4,\\ 2.5 \\,]$\n\nCalculate the sum of products for the numerator:\n$\\sum_i d_{x,i} d_{y,i} = (-4)(-4) + (-2.5)(-2.5) + (-2.5)(-2.5) + (0)(0) + (0)(0) + (0)(0) + (2.5)(2.5) + (2.5)(4) + (4)(2.5)$\n$\\sum_i d_{x,i} d_{y,i} = 16 + 6.25 + 6.25 + 0 + 0 + 0 + 6.25 + 10 + 10 = 54.75$\n\nCalculate the sum of squares for the denominator terms:\n$\\sum_i d_{x,i}^2 = (-4)^2 + (-2.5)^2 + (-2.5)^2 + 0^2 + 0^2 + 0^2 + (2.5)^2 + (2.5)^2 + 4^2$\n$\\sum_i d_{x,i}^2 = 16 + 6.25 + 6.25 + 0 + 0 + 0 + 6.25 + 6.25 + 16 = 32 + 4(6.25) = 32 + 25 = 57$\n\n$\\sum_i d_{y,i}^2 = (-4)^2 + (-2.5)^2 + (-2.5)^2 + 0^2 + 0^2 + 0^2 + (2.5)^2 + 4^2 + (2.5)^2$\n$\\sum_i d_{y,i}^2 = 16 + 6.25 + 6.25 + 0 + 0 + 0 + 6.25 + 16 + 6.25 = 32 + 4(6.25) = 32 + 25 = 57$\n\nStep 4: Compute the correlation coefficient $\\rho_s$.\nSubstitute the sums into the formula:\n$$ \\rho_s = \\frac{54.75}{\\sqrt{57 \\times 57}} = \\frac{54.75}{57} $$\nTo simplify, convert $54.75$ to a fraction: $54.75 = \\frac{219}{4}$.\n$$ \\rho_s = \\frac{219/4}{57} = \\frac{219}{4 \\times 57} $$\nWe factor the numbers to simplify the fraction. $57 = 3 \\times 19$. The sum of the digits of $219$ is $2+1+9=12$, so it is divisible by $3$. $219 = 3 \\times 73$.\n$$ \\rho_s = \\frac{3 \\times 73}{4 \\times 3 \\times 19} = \\frac{73}{4 \\times 19} = \\frac{73}{76} $$\nThe final exact value for the tie-adjusted Spearman correlation coefficient is $\\frac{73}{76}$.",
            "answer": "$$\\boxed{\\frac{73}{76}}$$"
        }
    ]
}