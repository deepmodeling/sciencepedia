{
    "hands_on_practices": [
        {
            "introduction": "在实验设计中，控制顺序效应的理想方法是测试所有可能的条件顺序，即“完全平衡”。然而，这种方法的实际可行性如何？本练习  将引导你从数学上探索完全平衡的极限，揭示为何即使条件数量适中，这种方法也常常变得不切实际。通过这个练习，你将深入理解实验复杂性随条件数量呈阶乘式增长的根本原因。",
            "id": "4150593",
            "problem": "一项认知神经科学实验在单次实验中向每位参与者以某种顺序呈现 $k$ 个不同的任务条件，每个条件仅出现一次。实验设计的目标是完全平衡（full counterbalancing），其定义为将 $k$ 个条件的所有可能顺序在参与者中进行等频率分配。请使用基本计数原理和标准渐近分析，推导可用唯一顺序的确切数量，然后对于给定的总样本量 $N$，确定一个解析近似解，该解表示可实现完全平衡的最大 $k$ 值。此处的可行性定义为：在所有参与者中，每个唯一顺序至少可以出现一次。\n\n您的推导必须从无放回序列的基本计数原理开始，并可以采用一个经过充分检验的 $k!$ 的渐近近似，以及 Lambert $W$ 函数的定义属性。请提供一个连续松弛 $k^{\\star}(N)$ 的闭式表达式，该表达式通过将总顺序数的渐近近似值设为等于 $N$ 并求解 $k$，来近似给定 $N$ 时的最大可行 $k$ 值。不要假设 $N$ 或 $k$ 的任何具体数值；您的最终表达式必须以符号形式依赖于 $N$。\n\n在您的论证中，还请解释为什么在神经科学中，对于中等大小的 $N$（例如，$N$ 在几十的量级），完全平衡通常是不可行的，以及为什么在一阶遗留效应假设和顺序效应的线性建模下，完全平衡可能并非必要。然而，您唯一需要作为最终答案报告的是 $k^{\\star}(N)$ 的闭式解析表达式。",
            "solution": "该问题要求推导 $k$ 个不同任务条件的唯一顺序数量，分析完全平衡的可行性，并推导在样本量为 $N$ 的参与者情况下，可实现平衡的最大条件数 $k^{\\star}(N)$ 的解析近似解。\n\n首先，我们确定一个包含 $k$ 个不同任务条件的实验中可用唯一顺序的确切数量，其中每个条件只呈现一次。这是一个经典的排列问题。将 $k$ 个不同项目排列成一个序列的方法数量由阶乘函数给出。因此，我们记为 $P_k$ 的唯一顺序总数为：\n$$P_k = k!$$\n其中 $k! = k \\times (k-1) \\times \\dots \\times 2 \\times 1$。\n\n问题将完全平衡定义为一种设计，其中每个可能的顺序在参与者之间被等频率地分配。给定的可行性条件是，在 $N$ 名参与者中，每个唯一顺序至少可以出现一次。这意味着参与者数量 $N$ 必须至少与唯一顺序的数量 $P_k$ 一样大。\n$$N \\ge k!$$\n\n这一要求解释了为什么完全平衡在实践中通常是不可行的，尤其是在神经科学领域，因为样本量常常受到成本、时间和参与者可得性的限制。阶乘函数增长得非常快。例如：\n- 对于 $k=3$ 个条件，$3! = 6$ 种可能的顺序。需要样本量 $N \\ge 6$，这很容易实现。\n- 对于 $k=4$ 个条件，$4! = 24$ 种可能的顺序。需要样本量 $N \\ge 24$，这处于典型研究规模的低端。\n- 对于 $k=5$ 个条件，$5! = 120$ 种可能的顺序。需要样本量 $N \\ge 120$，这个数字对于许多神经影像学（fMRI, MEG）或临床研究来说大得令人望而却步。\n- 对于 $k=6$ 个条件，$6! = 720$ 种可能的顺序，需要 $N \\ge 720$，这几乎总是不可行的。\n$k!$ 的超指数增长使得完全平衡即使对于中等数量的条件也变得不切实际。\n\n在完全平衡不可行的情况下，存在替代策略。平衡的主要目的是控制顺序效应。如果假设只有一阶遗留效应是显著的（即一个试次仅受其紧邻的前一个试次的影响），那么对所有顺序进行完全排列就不是必需的。可以使用拉丁方设计（Latin Square design），它确保每个条件在每个序列位置上只出现一次。更高级的平衡拉丁方（balanced Latin Squares）还可以确保每个条件在其他每个条件之前和之后都恰好出现一次。这些设计所要求的参与者数量是 $k$ 的倍数，而不是 $k!$，这使得它们效率大大提高。此外，顺序效应也可以通过解析方法来处理。通过将试次编号或呈现顺序作为连续或分类预测变量纳入广义线性模型（GLM）中，可以统计上估计与系统性顺序效应（如练习或疲劳）相关的方差，并将其从感兴趣的特定条件效应中剔除。\n\n我们现在继续推导在给定样本量 $N$ 的情况下，最大可行 $k$ 的解析近似解，记为连续松弛 $k^{\\star}(N)$。问题是在可行性边界上找到满足以下方程的 $k$ 值：\n$$k! = N$$\n为了求解 $k$，我们必须使用阶乘函数的近似。问题要求使用一个经过充分检验的渐近近似，为此我们使用Stirling近似的对数形式，该形式对于不小的 $k$ 值非常精确：\n$$\\ln(k!) \\approx k \\ln(k) - k$$\n将此代入我们可行性方程的自然对数形式 $\\ln(k!) = \\ln(N)$，我们得到：\n$$k \\ln(k) - k \\approx \\ln(N)$$\n为了求解这个关于 $k$ 的超越方程，我们将其重新整理以匹配 Lambert $W$ 函数的定义形式。该函数定义为：对于给定的 $z$，$W(z)$ 是满足 $W(z) \\exp(W(z)) = z$ 的值。\n\n让我们对我们的方程进行变换：\n$$k(\\ln(k) - 1) = \\ln(N)$$\n使用恒等式 $1 = \\ln(e)$，我们有：\n$$k(\\ln(k) - \\ln(e)) = \\ln(N)$$\n使用对数的商法则：\n$$k \\ln\\left(\\frac{k}{e}\\right) = \\ln(N)$$\n为了将其转化为 $Y \\exp(Y) = Z$ 的形式，我们定义一个新变量 $Y = \\ln\\left(\\frac{k}{e}\\right)$。根据这个定义，我们可以对两边取指数得到 $\\exp(Y) = \\frac{k}{e}$，这可以重新整理以用 $Y$ 表示 $k$：$k = e \\exp(Y)$。\n\n现在，我们将这个 $k$ 的表达式代回到我们的方程 $k \\ln\\left(\\frac{k}{e}\\right) = \\ln(N)$ 中：\n$$(e \\exp(Y)) Y = \\ln(N)$$\n两边除以常数 $e$，我们得到 Lambert $W$ 函数的标准形式：\n$$Y \\exp(Y) = \\frac{\\ln(N)}{e}$$\n根据 Lambert $W$ 函数的定义，$Y$ 的解是：\n$$Y = W\\left(\\frac{\\ln(N)}{e}\\right)$$\n我们现在代回我们最初对 $Y$ 的定义，即 $Y = \\ln\\left(\\frac{k}{e}\\right)$：\n$$\\ln\\left(\\frac{k}{e}\\right) = W\\left(\\frac{\\ln(N)}{e}\\right)$$\n为了求解 $k$，我们首先对两边取指数：\n$$\\frac{k}{e} = \\exp\\left(W\\left(\\frac{\\ln(N)}{e}\\right)\\right)$$\n最后，我们乘以 $e$ 来分离出 $k$。这给了我们连续近似解 $k^{\\star}(N)$：\n$$k^{\\star}(N) = e \\exp\\left(W\\left(\\frac{\\ln(N)}{e}\\right)\\right)$$\n这个表达式可以使用恒等式 $\\exp(W(z)) = \\frac{z}{W(z)}$ 来简化。设 $z = \\frac{\\ln(N)}{e}$，我们有：\n$$k^{\\star}(N) = e \\left[ \\frac{\\frac{\\ln(N)}{e}}{W\\left(\\frac{\\ln(N)}{e}\\right)} \\right]$$\n$$k^{\\star}(N) = \\frac{\\ln(N)}{W\\left(\\frac{\\ln(N)}{e}\\right)}$$\n这就是在给定样本量 $N$ 的情况下，最大可行条件数 $k$ 的连续近似的闭式解析表达式，它是使用 Stirling 近似和 Lambert $W$ 函数推导出来的。",
            "answer": "$$\n\\boxed{\\frac{\\ln(N)}{W\\left(\\frac{\\ln(N)}{e}\\right)}}\n$$"
        },
        {
            "introduction": "鉴于完全平衡在实践中常常难以实现，研究人员转而采用更高效的设计来控制顺序效应。平衡拉丁方 (Balanced Latin Square) 是一种强大的替代方案，它能有效控制一阶遗留效应，而无需海量的被试。本练习  将提供构建一个平衡拉丁方的动手经验，并验证其关键属性，从而将一个抽象的设计概念转化为一个具体的分析工具。",
            "id": "4150560",
            "problem": "一个认知神经科学实验比较了标记为$1,2,3,4,5,6$的$k=6$个刺激条件，并试图通过在试验顺序中平衡各条件间的直接前驱和后继关系来消除一阶遗留效应。一个平衡拉丁方（BLS）是一种设计，在该设计中，对于一组$k$个顺序，每个条件在每个序数位置上恰好出现一次，并且对于任何有序的不同条件对$(a,b)$（其中$a \\neq b$），有且仅有一个顺序中$b$紧随$a$之后。\n\n从拉丁方和一阶遗留效应的基本定义出发，通过明确列举$6$个顺序来推导一个大小为$k=6$的平衡拉丁方。使用你的构建方法，证明所得到的顺序集满足每个条件紧随每个其他不同条件之后一次的性质（忽略从最后一个位置回到第一个位置的回环邻接）。\n\n定义$6 \\times 6$的邻接矩阵$\\mathbf{A}$，令$A_{ab}$等于在这$6$个顺序中条件$a$紧随条件$b$之前的总次数，其中对于所有$a \\in \\{1,2,3,4,5,6\\}$，$A_{aa}=0$。计算$\\mathbf{A}$的行列式，结果为一个实数。不需要四舍五入。",
            "solution": "该问题要求为$k=6$个条件构建一个平衡拉丁方（BLS），并计算一个特定邻接矩阵的行列式。\n\n解决过程分四个阶段进行：\n1.  为$k=6$个条件构建一个平衡拉丁方（BLS）。\n2.  验证所构建的方阵满足BLS的定义，特别是一阶遗留效应的平衡性。\n3.  基于所构建方阵的性质定义邻接矩阵$\\mathbf{A}$。\n4.  计算矩阵$\\mathbf{A}$的行列式。\n\n设$k=6$个刺激条件的集合为$C = \\{1, 2, 3, 4, 5, 6\\}$。对于偶数个条件$k$，可以使用构建Williams Square的算法来构建平衡拉丁方。\n\n首先，使用以下序列构建方阵的第一行（顺序）：\n$1, 2, k, 3, k-1, 4, k-2, \\dots$\n对于$k=6$，这产生的序列是：\n$1, 2, 6, 3, 5, 4$\n\n接下来的$k-1=5$行是通过将$j$（$j=1, 2, \\dots, 5$）加到第一行的每个元素上生成的。加法是模$k$运算，其中余数集取为$\\{1, 2, \\dots, k\\}$而不是$\\{0, 1, \\dots, k-1\\}$。也就是说，如果和为$k$，它仍然是$k$；如果和超过$k$，我们减去$k$。\n\n得到的$k=6$个顺序如下：\n第1行（顺序1）：$1, 2, 6, 3, 5, 4$\n第2行（顺序2）：$(1+1), (2+1), (6+1 \\rightarrow 1), (3+1), (5+1), (4+1) \\Rightarrow 2, 3, 1, 4, 6, 5$\n第3行（顺序3）：$(2+1), (3+1), (1+1), (4+1), (6+1 \\rightarrow 1), (5+1) \\Rightarrow 3, 4, 2, 5, 1, 6$\n第4行（顺序4）：$(3+1), (4+1), (2+1), (5+1), (1+1), (6+1 \\rightarrow 1) \\Rightarrow 4, 5, 3, 6, 2, 1$\n第5行（顺序5）：$(4+1), (5+1), (3+1), (6+1 \\rightarrow 1), (2+1), (1+1) \\Rightarrow 5, 6, 4, 1, 3, 2$\n第6行（顺序6）：$(5+1), (6+1 \\rightarrow 1), (4+1), (1+1), (3+1), (2+1) \\Rightarrow 6, 1, 5, 2, 4, 3$\n\n完整的$6 \\times 6$顺序方阵是：\n$$\n\\begin{pmatrix}\n1  & 2  & 6  & 3  & 5  & 4 \\\\\n2  & 3  & 1  & 4  & 6  & 5 \\\\\n3  & 4  & 2  & 5  & 1  & 6 \\\\\n4  & 5  & 3  & 6  & 2  & 1 \\\\\n5  & 6  & 4  & 1  & 3  & 2 \\\\\n6  & 1  & 5  & 2  & 4  & 3\n\\end{pmatrix}\n$$\n这是一个拉丁方，因为来自$\\{1, \\dots, 6\\}$的每个条件在每行和每列中都恰好出现一次。\n\n接下来，我们必须证明这个设计对于一阶遗留效应是平衡的。这意味着对于任何两个不同的条件$a$和$b$，有序对$(a,b)$作为紧邻对（$b$紧随$a$之后）恰好出现一次。这样的有序对有$k(k-1) = 6 \\times 5 = 30$个。设计中相邻对的总数是$k \\times (k-1) = 6 \\times 5 = 30$。我们需要证明所有这30个对都是唯一的。这个性质是由第一行的构造保证的。\n\n第一行中的相邻对是：$(1,2), (2,6), (6,3), (3,5), (5,4)$。\n第二行中的相邻对是：$(2,3), (3,1), (1,4), (4,6), (6,5)$。\n...以此类推。\n通过检查可以确认，$k(k-1)=30$个可能的有序对（其中元素不同）每个都恰好出现一次。因此，该设计是一个平衡拉丁方。\n\n现在，我们定义$6 \\times 6$邻接矩阵$\\mathbf{A}$，其中$A_{ab}$是条件$a$紧随条件$b$之前的次数。这与上面验证的“$b$紧随$a$之后”是同一个概念。根据平衡拉丁方的性质，对于任意一对不同的条件$a, b \\in \\{1, \\dots, 6\\}$，$a$恰好在$b$之前出现一次。因此，对于所有$a \\neq b$，$A_{ab} = 1$。问题规定对角线元素为零，所以$A_{aa} = 0$。\n得到的矩阵$\\mathbf{A}$是：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n0 & 1 & 1 & 1 & 1 & 1 \\\\\n1 & 0 & 1 & 1 & 1 & 1 \\\\\n1 & 1 & 0 & 1 & 1 & 1 \\\\\n1 & 1 & 1 & 0 & 1 & 1 \\\\\n1 & 1 & 1 & 1 & 0 & 1 \\\\\n1 & 1 & 1 & 1 & 1 & 0\n\\end{pmatrix}\n$$\n这个矩阵可以表示为$\\mathbf{A} = \\mathbf{J} - \\mathbf{I}$，其中$\\mathbf{J}$是$6 \\times 6$的全1矩阵，$\\mathbf{I}$是$6 \\times 6$的单位矩阵。\n\n最后，我们计算$\\mathbf{A}$的行列式。一个矩阵的行列式是其特征值的乘积。我们可以通过先找到$\\mathbf{J}$的特征值来找到$\\mathbf{A}$的特征值。\n对于一个$n \\times n$的全1矩阵$\\mathbf{J}$，它的秩为$1$。这意味着存在一个特征值$\\lambda=0$，其重数为$n-1$。特征值的和等于矩阵的迹，$\\mathrm{Tr}(\\mathbf{J}) = n$。由于$n-1$个特征值为$0$，剩下的一个特征值必须是$n$。\n在我们的例子中，$n=6$，所以$\\mathbf{J}$的特征值是$6$（重数为$1$）和$0$（重数为$5$）。\n\n矩阵$\\mathbf{A}$与$\\mathbf{J}$的关系是$\\mathbf{A} = \\mathbf{J} - \\mathbf{I}$。如果$\\mathbf{v}$是$\\mathbf{J}$的特征向量，其特征值为$\\lambda_{\\mathbf{J}}$，那么：\n$$ \\mathbf{A}\\mathbf{v} = (\\mathbf{J} - \\mathbf{I})\\mathbf{v} = \\mathbf{J}\\mathbf{v} - \\mathbf{I}\\mathbf{v} = \\lambda_{\\mathbf{J}}\\mathbf{v} - \\mathbf{v} = (\\lambda_{\\mathbf{J}} - 1)\\mathbf{v} $$\n因此，$\\mathbf{A}$的特征值是$\\lambda_{\\mathbf{A}} = \\lambda_{\\mathbf{J}} - 1$。\n使用$\\mathbf{J}_6$的特征值：\n- 特征值$6$变为$6-1=5$（重数为$1$）。\n- 特征值$0$变为$0-1=-1$（重数为$5$）。\n\n$\\mathbf{A}$的行列式是其特征值的乘积：\n$$ \\det(\\mathbf{A}) = (5)^1 \\times (-1)^5 = 5 \\times (-1) = -5 $$\n\n另外，对于这种形式的矩阵$\\mathbf{A}_n = \\mathbf{J}_n - \\mathbf{I}_n$，其行列式有一个已知的公式：$\\det(\\mathbf{A}_n) = (-1)^{n-1}(n-1)$。\n对于$n=6$，这得到：\n$$ \\det(\\mathbf{A}_6) = (-1)^{6-1}(6-1) = (-1)^5(5) = -5 $$\n两种方法得到相同的结果。",
            "answer": "$$\n\\boxed{-5}\n$$"
        },
        {
            "introduction": "一个完美的实验设计在实际数据收集中总会面临挑战，例如由伪影或被试错误导致的试次丢失。这个案例研究  旨在弥合理想设计与数据分析现实之间的鸿沟。它要求你分析这种不可避免的数据丢失如何破坏原始的平衡设计，并思考如何采用有效的分析策略来纠正由此产生的偏差，确保结论的有效性。",
            "id": "4150669",
            "problem": "一位研究者正在分析一项认知神经科学实验中的脑电图（EEG）事件相关电位（ERP）。该实验包含 $4$ 种刺激条件 $\\{C_1, C_2, C_3, C_4\\}$，并采用完全平衡的设计进行呈现。平衡的定义是，在诸如组块、反应侧和时间等无关因素上，每种条件都有均等的呈现。这是通过随机分配和结构化的试次安排来实现的，以达到每个组块内各条件的试次数量相等。实验包含 $8$ 个组块，每个组块有 $20$ 个试次，计划为每个组块中每种条件 $5$ 个试次，因此每种条件计划的总试次数为 $40$ 次。\n\n试次因两个原因被排除：与伪迹相关的试次剔除和行为试次错误。实验者应用了标准的预处理方法，该方法会剔除由眼电图（EOG）检测到的含有眼动伪迹的试次，并从 ERP 叠加平均中排除反应错误的试次。实际的排除数量如下。\n\n按组块分的与伪迹相关的试次剔除：\n- 组块 $1$：$C_1$ 剔除 $4$ 个，$C_2$ 剔除 $1$ 个，$C_3$ 剔除 $1$ 个，$C_4$ 剔除 $0$ 个。\n- 组块 $2$：$C_1$ 剔除 $2$ 个，$C_2$ 剔除 $1$ 个，$C_3$ 剔除 $1$ 个，$C_4$ 剔除 $0$ 个。\n- 组块 $5$：$C_3$ 剔除 $2$ 个。\n- 所有其他组块：$0$ 次剔除。\n\n行为试次错误（错误反应），在各组块间大致均匀分布，但总数上与条件相关：\n- $C_1$：$2$ 个错误，$C_2$：$6$ 个错误，$C_3$：$10$ 个错误，$C_4$：$3$ 个错误。\n\n假设 ERP 叠加平均仅使用那些既无伪迹又反应正确的试次进行计算。请仅使用平衡（在无关因素上条件呈现均等）和随机化（分配与结果无关）的基本定义，以及缺失数据的基本分类（完全随机缺失、随机缺失、非随机缺失），分析这些排除如何影响平衡试次结构的完整性和条件比较的有效性。\n\n哪个选项正确定义了在此背景下的试次剔除和试次错误，正确描述了它们在给定情景下对平衡和试次结构完整性的影响，并提出了一种科学有效的分析补救措施？\n\nA. 试次剔除是指当被试拒绝继续实验时移除整个组块，而试次错误是脑电图时间序列中的任何噪声。因为原始安排是随机的，事后排除不会改变平衡，所以研究者应该直接使用未经调整的条件平均值进行分析。\n\nB. 试次剔除是因测量伪迹（例如，由眼电图检测到的眼动污染）而排除单个试次，试次错误是排除行为反应错误的试次。在这里，排除是依赖于条件和组块的，这违反了完全随机缺失的假设，并导致了全局和组块内的不平衡（例如，在组块 $1$–$2$ 中：$C_1$ 保留了 $10$ 个计划试次中的 $4$ 个，$C_2$ 保留了 $8$ 个，$C_3$ 保留了 $8$ 个，$C_4$ 保留了 $10$ 个）。这通过使条件与组块/时间及难度产生关联，破坏了平衡。一个有效的补救措施是使用按组块分层的方法进行分析，以均衡或加权每个组块内各条件的计数（例如，分层重采样或逆概率加权），并在混合效应模型中将组块（及其他无关因素）作为固定效应纳入，从而在不伪造神经数据的情况下恢复可比性。\n\nC. 试次剔除是排除反应错误的试次，而试次错误是实验者对条件的错误标记。因为行为错误只增加方差而不增加偏差，所以移除错误试次总能改善平衡；此外，删除有大量剔除的组块将恢复完美平衡，且不影响统计推断。\n\nD. 试次剔除等同于随机缺失数据，而试次错误在总体水平上可以忽略不计。为了在排除后保持平衡，研究者应该通过插值法填补被剔除的 ERP 时段，或者随机重新标记剩余的试次以达到各条件计数相等。",
            "solution": "选项B是正确的。该选项准确地指出了问题的核心：由于试次剔除（伪迹）和试次错误（行为）与实验条件及时间（组块）相关联，数据丢失并非“完全随机缺失”（MCAR）。这种非随机的丢失破坏了原有的平衡设计，引入了混淆变量。例如，条件$C_1$在实验早期（组块1-2）丢失了更多试次，而条件$C_3$的错误率最高，这使得条件效应与时间效应和任务难度效应纠缠在一起。选项B提出的补救措施——在混合效应模型中将组块作为固定效应或使用加权方法——是统计学上处理此类偏倚的标准和有效方法，它能够在分析阶段对不平衡进行校正。\n\n其他选项是错误的：\n- 选项A对术语的定义不正确，并且错误地断言事后排除不影响平衡，当排除与条件和组块相关时，这显然是错误的。\n- 选项C错误地声称移除错误试次总能改善平衡；实际上当错误率与条件相关时（如此处所示），这会引入偏差。同时，移除整个组块会损失大量数据和统计功效。\n- 选项D提出的插值法或随机重标记试次的方法在科学上是无效的，后者甚至构成学术不端行为。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}