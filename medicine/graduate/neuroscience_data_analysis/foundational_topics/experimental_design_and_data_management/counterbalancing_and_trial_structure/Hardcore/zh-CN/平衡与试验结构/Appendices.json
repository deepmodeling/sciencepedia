{
    "hands_on_practices": [
        {
            "introduction": "任何稳健实验设计的基础都是其随机化方案。本练习将引导你动手比较两种常见方法：简单随机化和置换区组随机化。通过分析计算试验不平衡的概率，你将具体理解为何像区组这样的结构化方法对于维持实验控制至关重要，尤其是在关心条件随时序变化的效应的研究中 。",
            "id": "4150481",
            "problem": "一个神经科学实验室正在为一次会话内实验设计一个双条件试验结构，其中每次试验被分配到两个条件之一，记为条件 $A$ 和条件 $B$。实验室关心在数据收集过程中各条件计数出现中期不平衡的概率，因为不平衡会混淆小样本段内神经反应轨迹的估计。\n\n定义在时间 $t$ 的不平衡为 $I(t) = |n_{A}(t) - n_{B}(t)|$，其中 $n_{A}(t)$ 和 $n_{B}(t)$ 分别是在前 $t$ 次试验中分配给条件 $A$ 和条件 $B$ 的试验次数。考虑 $t = 6$。\n\n正在考虑两种随机化方案：\n- 简单随机化：每次试验独立地以 $1/2$ 的概率分配给条件 $A$ 或条件 $B$。\n- 固定区组大小为 $4$ 的置换区组随机化：每 $4$ 次分配的区组中，恰好包含 $2$ 次条件 $A$ 和 $2$ 次条件 $B$ 的试验，其顺序是均匀随机的；多个区组被连接起来以产生完整的序列。\n\n从简单随机化下分配的独立性以及置换区组随机化下区组内精确平衡的核心定义出发，解析地推导（不使用任何捷径公式）在每种方案下 $I(6) \\geq 2$ 的概率。然后计算比率\n$$R = \\frac{\\Pr\\big(I(6) \\geq 2 \\text{ under simple randomization}\\big)}{\\Pr\\big(I(6) \\geq 2 \\text{ under permuted block randomization}\\big)}.$$\n以单个最简有理数的形式提供 $R$。不要四舍五入。最终答案不需要单位。",
            "solution": "我们首先使用基本概率原理来形式化这两种方案以及不平衡事件 $I(6) \\geq 2$。\n\n在简单随机化下，前 $6$ 次试验中的每一次都独立地以 $1/2$ 的概率分配给条件 $A$，$1/2$ 的概率分配给条件 $B$。令 $X$ 表示前 $6$ 次试验中分配给条件 $A$ 的次数。根据独立同分布，$X$ 服从参数为 $n=6$ 和 $p=1/2$ 的二项分布随机变量。不平衡为 $I(6) = |n_{A}(6) - n_{B}(6)| = |X - (6 - X)| = |2X - 6| = 2|X - 3|$。因此，事件 $I(6) \\geq 2$ 发生的条件恰好是 $|X - 3| \\geq 1$，这等价于 $X \\neq 3$。\n\n因此，\n$$\n\\Pr\\big(I(6) \\geq 2 \\text{ under simple randomization}\\big) = 1 - \\Pr(X = 3).\n$$\n根据计数论证，$\\Pr(X = 3)$ 等于 $6$ 次分配中恰好有 $3$ 次分配给条件 $A$ 的序列数，除以总序列数。分配给 $A$ 的次数为 $3$ 的序列数是 $\\binom{6}{3}$，总序列数是 $2^{6}$。因此，\n$$\n\\Pr(X = 3) = \\frac{\\binom{6}{3}}{2^{6}} = \\frac{20}{64} = \\frac{5}{16}.\n$$\n所以，\n$$\n\\Pr\\big(I(6) \\geq 2 \\text{ under simple randomization}\\big) = 1 - \\frac{5}{16} = \\frac{11}{16}.\n$$\n\n在固定区组大小为 $4$ 的置换区组随机化下，第一个包含 $4$ 次试验的区组中，恰好有 $2$ 次条件 $A$ 和 $2$ 次条件 $B$，其顺序是均匀随机的。经过 $4$ 次试验后，根据构造，不平衡为 $I(4) = 0$。接下来的 $2$ 次试验属于第二个区组，该区组也恰好包含 $2$ 次条件 $A$ 和 $2$ 次条件 $B$，以均匀随机的顺序排列。考虑从这第二个区组中抽取的前 $2$ 次。在这个区组内，任何抽取之前的构成为 $2$ 个 $A$ 和 $2$ 个 $B$。从区组中抽取的前两次都是条件 $A$ 的概率是\n$$\n\\Pr(\\text{AA in first two draws}) = \\frac{2}{4} \\cdot \\frac{1}{3} = \\frac{1}{6},\n$$\n并且前两次抽取都是条件 $B$ 的概率是相同的，\n$$\n\\Pr(\\text{BB in first two draws}) = \\frac{2}{4} \\cdot \\frac{1}{3} = \\frac{1}{6}.\n$$\n前两次抽取一个是 $A$ 一个是 $B$（即 $AB$ 或 $BA$）的概率是\n$$\n\\Pr(\\text{one } A \\text{ and one } B) = 1 - \\left(\\frac{1}{6} + \\frac{1}{6}\\right) = \\frac{2}{3}.\n$$\n结合第一个区组（贡献了 $2$ 个 $A$ 和 $2$ 个 $B$），$6$ 次试验后的总计数是：\n- 如果两次抽取都是 $A$，那么 $n_{A}(6) = 4$ 且 $n_{B}(6) = 2$，所以 $I(6) = |4 - 2| = 2$。\n- 如果两次抽取都是 $B$，那么 $n_{A}(6) = 2$ 且 $n_{B}(6) = 4$，所以 $I(6) = |2 - 4| = 2$。\n- 如果两次抽取一个是 $A$ 一个是 $B$，那么 $n_{A}(6) = 3$ 且 $n_{B}(6) = 3$，所以 $I(6) = 0$。\n\n因此，\n$$\n\\Pr\\big(I(6) \\geq 2 \\text{ under permuted block randomization}\\big) = \\Pr(\\text{AA or BB in first two draws of block}) = \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{3}.\n$$\n\n我们现在计算比率\n$$\nR = \\frac{\\Pr\\big(I(6) \\geq 2 \\text{ under simple randomization}\\big)}{\\Pr\\big(I(6) \\geq 2 \\text{ under permuted block randomization}\\big)} = \\frac{\\frac{11}{16}}{\\frac{1}{3}} = \\frac{11}{16} \\cdot 3 = \\frac{33}{16}.\n$$\n这提供了一个解析的量化，说明在 $t=6$ 时，置换区组法相对于简单随机化如何降低了不平衡的概率；该比率超过 $1$，证实了这种降低效果。",
            "answer": "$$\\boxed{\\frac{33}{16}}$$"
        },
        {
            "introduction": "除了简单的平衡，控制序列效应或“遗留效应”是平衡设计的一个主要目标。本练习将指导你构建一个平衡拉丁方，这是一种强大的设计，能确保每个条件紧随和紧随于所有其他条件的次数相同。通过这个练习，你将巩固对如何创建和验证系统性抵消一阶顺序效应的设计的理解 。",
            "id": "4150560",
            "problem": "一个认知神经科学实验比较了标记为 $1,2,3,4,5,6$ 的 $k=6$ 种刺激条件，并试图通过在不同的试验顺序中平衡各个条件之间的直接前导和后继关系来消除一阶残留效应。一个平衡拉丁方 (BLS) 是一种设计，在该设计中，在一组 $k$ 个顺序中，每个条件在每个顺序位置上恰好出现一次，并且对于任何由不同条件 $(a,b)$ 组成的有序对（其中 $a \\neq b$），有且仅有一个顺序使得 $a$ 紧随 $b$ 之前，且有且仅有一个顺序使得 $a$ 紧随 $b$ 之后。\n\n从拉丁方和一阶残留效应的基本定义出发，通过明确列举出这 6 个顺序，推导一个大小为 $k=6$ 的平衡拉丁方。使用你的构造方法，证明所得的顺序集合满足每个条件紧随其他每个不同条件之前和之后各恰好一次的性质（忽略从最后一个位置回到第一个位置的环绕邻接关系）。\n\n定义 $6 \\times 6$ 的邻接矩阵 $\\mathbf{A}$，其中 $A_{ab}$ 等于在这 6 个顺序中条件 $a$ 紧随条件 $b$ 之前的总次数，并且对于所有 $a \\in \\{1,2,3,4,5,6\\}$，$A_{aa}=0$。计算 $\\mathbf{A}$ 的行列式，结果为一个实数。无需四舍五入。",
            "solution": "题目陈述经评估是有效的。它在科学上基于实验设计的原则，特别是在认知神经科学及相关领域。平衡、一阶残留效应和拉丁方的概念是公认的。该问题是适定的，因为对于 $k=6$（一个偶数）的平衡拉丁方，已知其存在并可通过标准算法构造。该问题是客观的、数学上精确的，并包含足够的信息来为指定的邻接矩阵的行列式推导出唯一解。\n\n解答过程分四个阶段进行：\n1.  为 $k=6$ 个条件构造一个平衡拉丁方 (BLS)。\n2.  验证所构造的方阵满足 BLS 的定义，特别是一阶残留效应的平衡。\n3.  根据所构造方阵的性质定义邻接矩阵 $\\mathbf{A}$。\n4.  计算矩阵 $\\mathbf{A}$ 的行列式。\n\n设 $k=6$ 个刺激条件的集合为 $C = \\{1, 2, 3, 4, 5, 6\\}$。对于偶数个条件 $k$，可以使用构造 Williams 方的算法来构造一个平衡拉丁方。\n\n首先，方阵的第一行（顺序）使用以下序列构造：\n$1, 2, k, 3, k-1, 4, k-2, \\dots$\n对于 $k=6$，这产生序列：\n$1, 2, 6, 3, 5, 4$\n\n随后的 $k-1=5$ 行是通过将第一行的每个元素加上 $j$（其中 $j=1, 2, \\dots, 5$）来生成的。加法是在模 $k$ 的意义下进行的，其中剩余类集取为 $\\{1, 2, \\dots, k\\}$ 而不是 $\\{0, 1, \\dots, k-1\\}$。也就是说，如果和为 $k$，则结果保持为 $k$；如果和超过 $k$，则我们减去 $k$。\n\n由此得到的 $k=6$ 个顺序如下：\n第1行 (顺序1): $1, 2, 6, 3, 5, 4$\n第2行 (顺序2): $1+1, 2+1, 6+1 \\rightarrow 1, 3+1, 5+1, 4+1 \\Rightarrow 2, 3, 1, 4, 6, 5$\n第3行 (顺序3): $2+1, 3+1, 1+1, 4+1, 6+1 \\rightarrow 1, 5+1 \\Rightarrow 3, 4, 2, 5, 1, 6$\n第4行 (顺序4): $3+1, 4+1, 2+1, 5+1, 1+1, 6+1 \\rightarrow 1 \\Rightarrow 4, 5, 3, 6, 2, 1$\n第5行 (顺序5): $4+1, 5+1, 3+1, 6+1 \\rightarrow 1, 2+1, 1+1 \\Rightarrow 5, 6, 4, 1, 3, 2$\n第6行 (顺序6): $5+1, 6+1 \\rightarrow 1, 4+1, 1+1, 3+1, 2+1 \\Rightarrow 6, 1, 5, 2, 4, 3$\n\n完整的 $6 \\times 6$ 顺序方阵为：\n$$\n\\begin{pmatrix}\n1  2  6  3  5  4 \\\\\n2  3  1  4  6  5 \\\\\n3  4  2  5  1  6 \\\\\n4  5  3  6  2  1 \\\\\n5  6  4  1  3  2 \\\\\n6  1  5  2  4  3\n\\end{pmatrix}\n$$\n这是一个拉丁方，因为来自 $\\{1, ..., 6\\}$ 的每个条件在每行和每列中都恰好出现一次。\n\n接下来，我们必须证明这个设计对于一阶残留效应是平衡的。这需要证明对于任意两个不同的条件 $a$ 和 $b$，有序对 $(a,b)$ 作为直接相邻项恰好出现一次。共有 $k(k-1) = 6 \\times 5 = 30$ 个这样的有序对。设计中相邻对的总数是 $k \\times (k-1) = 6 \\times 5 = 30$。因此，我们需要证明所有这 30 个对都是唯一的。\n\n这个性质是由第一行的构造方法所保证的。让我们分析第一行 ($c_1, c_2, c_3, c_4, c_5, c_6$) 中相邻元素在模 $k=6$ 意义下的差。使用剩余类集 $\\{0, 1, ..., 5\\}$ 进行计算（映射 $m \\to m-1$），第一行 $1, 2, 6, 3, 5, 4$ 对应于 $0, 1, 5, 2, 4, 3$。\n相邻元素之间的差 $(c_{i+1} - c_i) \\pmod 6$ 为：\n$c_2 - c_1 \\equiv 1 - 0 \\equiv 1 \\pmod 6$\n$c_3 - c_2 \\equiv 5 - 1 \\equiv 4 \\pmod 6$\n$c_4 - c_3 \\equiv 2 - 5 \\equiv -3 \\equiv 3 \\pmod 6$\n$c_5 - c_4 \\equiv 4 - 2 \\equiv 2 \\pmod 6$\n$c_6 - c_5 \\equiv 3 - 4 \\equiv -1 \\equiv 5 \\pmod 6$\n差集为 $\\{1, 2, 3, 4, 5\\}$，这是模 6 的所有非零余数的集合。由于每个非零差 $d$ 在第一行中恰好出现一次，任何差为 $d = (b-a) \\pmod 6$ 的条件有序对 $(a,b)$ 都对应于第一行中的一个唯一的相邻对。具体来说，对 $(c_i, c_{i+1})$ 的差为 $d_i = (c_{i+1}-c_i) \\pmod 6$。对 $(a,a+d_i)$ 将出现在通过将第一行加上 $j=(a-c_i) \\pmod 6$ 生成的行中。因为每个 $d \\in \\{1, ..., 5\\}$ 都恰好出现一次，并且每一行都是一个完整的循环移位，所以每个可能的有序对 $(a,b)$（其中 $a \\neq b$）在所有顺序中都将恰好出现一次。这证明了所构造的方阵是如定义所述的平衡拉丁方。\n\n现在，我们定义 $6 \\times 6$ 的邻接矩阵 $\\mathbf{A}$，其中 $A_{ab}$ 是条件 $a$ 紧随条件 $b$ 之前的次数。根据刚刚证明的性质，对于任意一对不同的条件 $a, b \\in \\{1, \\dots, 6\\}$，$a$ 恰好在 $b$ 之前出现一次。因此，对于所有 $a \\neq b$，$A_{ab} = 1$。问题规定对角元素为零，所以 $A_{aa} = 0$。\n得到的矩阵 $\\mathbf{A}$ 是：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n0  1  1  1  1  1 \\\\\n1  0  1  1  1  1 \\\\\n1  1  0  1  1  1 \\\\\n1  1  1  0  1  1 \\\\\n1  1  1  1  0  1 \\\\\n1  1  1  1  1  0\n\\end{pmatrix}\n$$\n这个矩阵可以表示为 $\\mathbf{A} = \\mathbf{J} - \\mathbf{I}$，其中 $\\mathbf{J}$ 是 $6 \\times 6$ 的全 1 矩阵，$\\mathbf{I}$ 是 $6 \\times 6$ 的单位矩阵。\n\n最后，我们计算 $\\mathbf{A}$ 的行列式。一个矩阵的行列式是其特征值的乘积。我们可以通过先求出 $\\mathbf{J}$ 的特征值来找到 $\\mathbf{A}$ 的特征值。\n对于一个 $n \\times n$ 的全 1 矩阵 $\\mathbf{J}$，其秩为 1。这意味着存在一个特征值 $\\lambda=0$，其重数为 $n-1$。特征值的和等于矩阵的迹，$\\text{Tr}(\\mathbf{J}) = n$。由于有 $n-1$ 个特征值为 0，剩下的那个特征值必定是 $n$。\n在我们的例子中，$n=6$，所以 $\\mathbf{J}$ 的特征值为 6（重数为 1）和 0（重数为 5）。\n\n矩阵 $\\mathbf{A}$ 与 $\\mathbf{J}$ 的关系为 $\\mathbf{A} = \\mathbf{J} - \\mathbf{I}$。如果 $\\mathbf{v}$ 是 $\\mathbf{J}$ 的一个特征向量，其对应的特征值为 $\\lambda_{\\mathbf{J}}$，那么：\n$$ \\mathbf{A}\\mathbf{v} = (\\mathbf{J} - \\mathbf{I})\\mathbf{v} = \\mathbf{J}\\mathbf{v} - \\mathbf{I}\\mathbf{v} = \\lambda_{\\mathbf{J}}\\mathbf{v} - \\mathbf{v} = (\\lambda_{\\mathbf{J}} - 1)\\mathbf{v} $$\n因此，$\\mathbf{A}$ 的特征值为 $\\lambda_{\\mathbf{A}} = \\lambda_{\\mathbf{J}} - 1$。\n使用 $\\mathbf{J}_6$ 的特征值：\n- 特征值 6 变为 $6-1=5$（重数为 1）。\n- 特征值 0 变为 $0-1=-1$（重数为 5）。\n\n$\\mathbf{A}$ 的行列式是其特征值的乘积：\n$$ \\det(\\mathbf{A}) = (5)^1 \\times (-1)^5 = 5 \\times (-1) = -5 $$\n\n另外，对于这种形式的矩阵 $\\mathbf{A}_n = \\mathbf{J}_n - \\mathbf{I}_n$，其行列式有一个已知的公式 $\\det(\\mathbf{A}_n) = (-1)^{n-1}(n-1)$。\n对于 $n=6$，这得出：\n$$ \\det(\\mathbf{A}_6) = (-1)^{6-1}(6-1) = (-1)^5(5) = -5 $$\n两种方法得出相同的结果。",
            "answer": "$$\n\\boxed{-5}\n$$"
        },
        {
            "introduction": "理想的实验设计在与现实世界的数据采集接触时很少能保持完整，因为伪迹和被试错误会导致试验丢失。最后的这个练习提出了一个真实场景，挑战你像数据分析师一样思考，评估这些缺失数据如何破坏平衡设计的完整性。通过分析试验丢失的性质并考虑适当的分析补救措施，你将学会如何弥合理论设计与实际数据分析之间的鸿沟 。",
            "id": "4150669",
            "problem": "一名研究者正在分析一项认知神经科学实验中的脑电图（EEG）事件相关电位（ERP）。该实验包含 $4$ 个刺激条件 $\\{C_1, C_2, C_3, C_4\\}$，并采用完全平衡的设计呈现。平衡法定义为每个条件在无关因素（如组块、反应侧和时间）上的均等呈现，通过随机分配和结构化试次安排来实现，以确保每个组块内各条件的计数相等。实验包含 $8$ 个组块，每个组块有 $20$ 个试次，计划为每个组块中每个条件 $5$ 个试次，因此每个条件计划的总试次数为 $40$ 次。\n\n试次的排除有两个原因：伪迹相关的试次剔除和行为试次错误。实验者采用了标准的预处理方法，剔除了通过眼电图（EOG）检测到的带有眼动伪迹的试次，并从ERP平均中排除了反应错误的试次。根据经验，排除的计数如下。\n\n按组块分的伪迹相关试次剔除：\n- 组块 $1$：$C_1$ 剔除 $4$ 个，$C_2$ 剔除 $1$ 个，$C_3$ 剔除 $1$ 个，$C_4$ 剔除 $0$ 个。\n- 组块 $2$：$C_1$ 剔除 $2$ 个，$C_2$ 剔除 $1$ 个，$C_3$ 剔除 $1$ 个，$C_4$ 剔除 $0$ 个。\n- 组块 $5$：$C_3$ 剔除 $2$ 个。\n- 所有其他组块：$0$ 次剔除。\n\n行为试次错误（错误反应），在组块间大致均匀分布，但总数依赖于条件：\n- $C_1$：$2$ 个错误，$C_2$：$6$ 个错误，$C_3$：$10$ 个错误，$C_4$：$3$ 个错误。\n\n假设ERP平均值将仅根据既无伪迹又反应正确的试次计算。仅使用平衡法（无关因素间条件的均等呈现）和随机化（分配与结果无关）的基本定义，以及基本的数据缺失分类（完全随机缺失、随机缺失、非随机缺失），分析这些排除如何影响平衡试次结构的完整性和条件比较的有效性。\n\n在当前情境下，哪个选项正确定义了试次剔除和试次错误，正确描述了它们在给定场景中对平衡法和试次结构完整性的影响，并提出了一种科学上有效的分析补救措施？\n\nA. 试次剔除是指当参与者拒绝继续时移除整个组块，试次错误是EEG时间序列中的任何噪声。由于原始安排是随机化的，事后排除不会改变平衡法，因此研究者应继续使用未经调整的条件平均值。\n\nB. 试次剔除是因测量伪迹（例如，通过眼电图检测到的眼动污染）而排除单个试次，试次错误是排除行为反应不正确的试次。在这里，排除是依赖于条件和组块的，这违反了完全随机缺失的假设，并导致了全局和组块内的不平衡（例如，在组块$1$–$2$中：$C_1$保留了计划的$10$个试次中的$4$个，$C_2$保留了$8$个，$C_3$保留了$8$个，$C_4$保留了$10$个）。这通过使条件与组块/时间和难度相关联，破坏了平衡法。一个有效的补救措施是使用组块分层方法进行分析，该方法可以均衡或加权每个组块内各条件的计数（例如，分层重采样或逆概率加权），并将组块（以及其他无关因素）作为固定效应纳入混合效应模型中，从而在不伪造神经数据的情况下恢复可比性。\n\nC. 试次剔除是排除反应不正确的试次，试次错误是实验者对条件的错误标记。因为行为错误只增加方差而不增加偏差，所以移除错误试次总能改善平衡法；此外，丢弃有许多剔除的组块将恢复完美的平衡，而不会影响推断。\n\nD. 试次剔除等同于随机缺失数据，试次错误在总体水平上可以忽略不计。为了在排除后保持平衡法，研究者应该通过插值法来插补被剔除的ERP时段，或者随机重新标记剩余的试次以实现每个条件的计数相等。",
            "solution": "...",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}