{
    "hands_on_practices": [
        {
            "introduction": "在神经科学研究中，我们常常希望探究多个实验因子的影响，但测试所有因子组合的全因子实验可能成本过高。部分因子设计为高效筛选关键因子提供了一种强大策略，但这种高效性是以“别名混淆”（aliasing）为代价的。本练习旨在让你推导一个特定设计的别名结构，这是一项至关重要的技能，可以帮助你正确解释实验结果，并避免在规划后续研究时被混淆的效应误导 ()。",
            "id": "4161390",
            "problem": "一个系统神经科学实验室计划研究在受控刺激下，多个实验因子如何共同影响培养的皮层神经元的平均发放率。该团队考虑了$5$个二元因子，每个因子设有两个水平，并使用标准的$\\pm 1$约定进行编码：因子$A$（突触阻断剂存在 vs. 缺失），因子$B$（高 vs. 低细胞外钾离子浓度），因子$C$（光遗传学刺激开启 vs. 关闭），因子$D$（神经调节剂存在 vs. 缺失），以及因子$E$（膜电位钳制高 vs. 低）。为了在能够估计主效应的同时减少实验次数，并且假设大多数高阶交互作用可以忽略不计，他们采用了一个$2^{5-2}$次实验的部分因子设计，其生成元为$D=AB$和$E=AC$。\n\n请仅从两水平部分因子设计、生成元、定义关系以及通过定义关系产生的别名的核心定义出发，推导此设计中的定义关系和主效应的别名结构。使用您推导出的别名结构，确定哪些二因子交互作用与主效应相混杂。\n\n设$N$表示在此设计中与至少一个主效应成别名的不同二因子交互作用的总数。报告$N$的值。您的最终数值答案应为精确值，无需四舍五入。",
            "solution": "用户提供了一个关于部分因子实验设计的问题，这是统计方法和实验设计领域的一个主题。在继续之前需要进行严格的验证。\n\n### 步骤1：提取已知条件\n- 因子数量：$5$个，标记为$A、B、C、D$和$E$。\n- 因子水平：每个因子$2$个水平，编码为$\\pm 1$。\n- 设计类型：$2^{5-2}$次实验的部分因子设计。\n- 设计生成元：$D=AB$和$E=AC$。\n- 目标：推导定义关系和主效应的别名结构。随后，识别所有与主效应混杂的二因子交互作用，并报告其总数$N$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于完善的实验设计（DOE）数学理论，特别是两水平部分因子设计。神经科学实验的背景是合理的，因为这类设计在STEM（科学、技术、工程和数学）领域被广泛用于高效地研究多个因子。生成元、定义关系和别名等概念是该领域的标准术语。该问题满足此标准。\n2.  **良构性：** 该问题提供了唯一确定定义关系和别名结构所需的所有信息。因子数量、实验次数（通过设计表示法$2^{5-2}$隐式给出）以及具体的生成元（$D=AB$, $E=AC$）足以构建设计矩阵及其代数性质。问题是精确的，要求一个具体的可推导量（$N$）。该问题是良构的。\n3.  **客观性：** 语言正式且技术性强。它使用了统计学和实验设计的标准术语，没有歧义或主观措辞。该问题是客观的。\n4.  **未检测到其他缺陷：** 该问题不健全、不完整、矛盾、不现实或琐碎。它需要直接应用基本原理。\n\n### 步骤3：结论和行动\n问题有效。我现在将着手解决。\n\n### 解题推导\n该问题要求分析一个$2^{5-2}$部分因子设计。这是一个关于$k=5$个因子在$2^{5-2} = 2^3 = 8$次实验中的设计。该设计由$p=2$个生成元指定，这些生成元定义了某些因子的水平如何由其他因子的水平决定。\n\n因子用大写字母$A, B, C, D, E$表示。在因子水平的标准$\\pm 1$表示法中，生成元$D=AB$和$E=AC$意味着设计矩阵中因子$D$的列是因子$A$和$B$的列的逐元素乘积，而因子$E$的列是因子$A$和$C$的列的乘积。\n\n**1. 推导定义关系**\n生成元可以通过将等式两边同乘以右侧的因子来重写为单位元形式。利用对于任何因子$X$，都有$X^2=I$的性质（其中$I$是单位元，一个全为$+1$的列），我们得到：\n$D = AB \\implies D(AB) = (AB)(AB) \\implies ABD = A^2B^2 = I \\cdot I = I$。因此，第一个生成元的单位元形式是$g_1 = ABD$。\n$E = AC \\implies E(AC) = (AC)(AC) \\implies ACE = A^2C^2 = I \\cdot I = I$。因此，第二个生成元的单位元形式是$g_2 = ACE$。\n\n该设计的定义关系是由单位元$I$、生成元及其所有可能的乘积所构成的一个群。在这种情况下，我们需要计算这两个生成元的乘积：\n$g_1 g_2 = (ABD)(ACE) = A^2BCDE = I \\cdot BCDE = BCDE$。\n\n完整的定义关系是所有等价于单位元$I$的“字”的集合。因此，定义关系为：\n$$I = ABD = ACE = BCDE$$\n这个关系定义了设计的混杂模式。任何效应或交互作用乘以定义关系中的一个字（$I$除外），都会得到一个别名效应。\n\n**2. 推导主效应的别名结构**\n任何效应的别名结构都可以通过将其与定义关系中的每个字相乘来找到。所得项的集合彼此混杂。我们被要求专门找出主效应（$A, B, C, D, E$）的别名结构。\n\n- **主效应A的别名结构：**\n  将$A$与定义关系相乘：\n  $A \\cdot I = A$\n  $A \\cdot (ABD) = A^2BD = BD$\n  $A \\cdot (ACE) = A^2CE = CE$\n  $A \\cdot (BCDE) = ABCDE$\n  因此，主效应$A$与二因子交互作用$BD$和$CE$以及五因子交互作用$ABCDE$成别名。我们将其写为$[A] = A + BD + CE + ABCDE$。\n\n- **主效应B的别名结构：**\n  将$B$与定义关系相乘：\n  $B \\cdot I = B$\n  $B \\cdot (ABD) = AB^2D = AD$\n  $B \\cdot (ACE) = ABCE$\n  $B \\cdot (BCDE) = B^2CDE = CDE$\n  因此，主效应$B$与二因子交互作用$AD$以及三因子和四因子交互作用$CDE$和$ABCE$成别名。我们将其写为$[B] = B + AD + CDE + ABCE$。\n\n- **主效应C的别名结构：**\n  将$C$与定义关系相乘：\n  $C \\cdot I = C$\n  $C \\cdot (ABD) = ABCD$\n  $C \\cdot (ACE) = AC^2E = AE$\n  $C \\cdot (BCDE) = BC^2DE = BDE$\n  因此，主效应$C$与二因子交互作用$AE$以及三因子和四因子交互作用$BDE$和$ABCD$成别名。我们将其写为$[C] = C + AE + BDE + ABCD$。\n\n- **主效应D的别名结构：**\n  将$D$与定义关系相乘：\n  $D \\cdot I = D$\n  $D \\cdot (ABD)=ABD^2=AB$\n  $D \\cdot (ACE)=ACDE$\n  $D \\cdot (BCDE)=BCD^2E=BCE$\n  因此，主效应$D$与二因子交互作用$AB$以及三因子和四因子交互作用$BCE$和$ACDE$成别名。我们将其写为$[D] = D + AB + BCE + ACDE$。\n\n- **主效应E的别名结构：**\n  将$E$与定义关系相乘：\n  $E \\cdot I = E$\n  $E \\cdot (ABD) = ABDE$\n  $E \\cdot (ACE) = ACE^2 = AC$\n  $E \\cdot (BCDE) = BCD$\n  因此，主效应$E$与二因子交互作用$AC$以及三因子和四因子交互作用$BCD$和$ABDE$成别名。我们将其写为$[E] = E + AC + BCD + ABDE$。\n\n**3. 识别混杂的二因子交互作用并计数**\n问题要求$N$，即与至少一个主效应成别名的不同二因子交互作用的总数。我们可以直接从上面推导出的别名结构中提取这些信息。在三因子或更多因子的交互作用可忽略不计的普遍假设下，主要关注的是主效应与二因子交互作用的别名关系。\n\n- 从$[A] = A + BD + CE + ABCDE$中，二因子交互作用为$BD$和$CE$。\n- 从$[B] = B + AD + CDE + ABCE$中，二因子交互作用为$AD$。\n- 从$[C] = C + AE + BDE + ABCD$中，二因子交互作用为$AE$。\n- 从$[D] = D + AB + BCE + ACDE$中，二因子交互作用为$AB$。\n- 从$[E] = E + AC + BCD + ABDE$中，二因子交互作用为$AC$。\n\n让我们编制一个所有此类唯一的二因子交互作用的列表：\n1. $AB$（与$D$成别名）\n2. $AC$（与$E$成别名）\n3. $AD$（与$B$成别名）\n4. $AE$（与$C$成别名）\n5. $BD$（与$A$成别名）\n6. $CE$（与$A$成别名）\n\n这些都是不同的二因子交互作用。我们现在计算这个集合中交互作用的数量。共有$6$个这样的交互作用。\n\n因此，与主效应成别名的不同二因子交互作用的总数为$N=6$。\n设计的分辨度是定义关系中最短字的长度。在这里，最短的字是$ABD$和$ACE$，长度均为$3$。因此，这是一个分辨度III的设计。在分辨度III的设计中，主效应与二因子交互作用成别名，这与我们的发现是一致的。\n\n与主效应混杂的二因子交互作用的最终汇编：\n- $A$与$BD$和$CE$混杂。\n- $B$与$AD$混杂。\n- $C$与$AE$混杂。\n- $D$与$AB$混杂。\n- $E$与$AC$混杂。\n\n与主效应成别名的二因子交互作用的完整集合是$\\{AB, AC, AD, AE, BD, CE\\}$。该集合中的元素数量$N$为$6$。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "从因子实验中收集到数据后，下一步是量化各因子及其交互作用的效应。方差分析（ANOVA）是实现这一目标的核心方法，它将数据的总变异分解为归属于每个因子的不同来源。本练习将让你通过计算一个双因素设计中的自由度来巩固你对 ANOVA 内部机制的理解，这是构建正确的 $F$ 检验以判断统计显著性的基础 ()。",
            "id": "4161379",
            "problem": "一个神经科学实验室正在进行一项双因素被试间实验，使用功能性磁共振成像 (fMRI) 来评估一个预定义感兴趣区域内的局部血氧水平依赖 (BOLD) 信号振幅。该设计操纵了两个分类因素：因素 $A$（有 $3$ 个水平）代表一种神经调节药物条件，因素 $B$（有 $3$ 个水平）代表任务训练方案。参与者使用跨扫描日的区组随机化方法被随机分配到 $3 \\times 3$ 个处理组合之一，以保持每个单元的平衡，并控制由于每日扫描仪漂移引起的无关变异性。每个处理组合（单元）包含 $n=15$ 名独立的参与者，并使用针对独立组的双因素方差分析对数据进行分析。\n\n假设对于单元级结构，双因素被试间线性模型满足以下标准条件：效应的可加性、通过对因素效应及其交互作用施加和为零约束的可识别性、单元内部和单元之间同方差的独立误差，以及通过平衡随机化确保的正交性。从广义线性模型的定义以及将总平方和划分为归因于因素 $A$、因素 $B$、它们的交互作用 $A \\times B$ 和残差（单元内变异性）的分量开始，推导每个分量和总和的自由度。然后，指定主效应和交互作用的相应 $F$ 检验，并确定适当的分子和分母均方。\n\n按顺序计算并报告因素 $A$、因素 $B$、交互作用 $A \\times B$、误差和总和的自由度。将最终答案表示为单行矩阵。无需四舍五入。无需单位。",
            "solution": "该问题提出了一个双因素被试间实验设计，并要求推导和计算相应的双因素方差分析 (ANOVA) 的自由度，并指定相关的 $F$ 检验。\n\n首先，我们建立统计模型。设 $y_{ijk}$ 为对应于因素 $A$ 的第 $i$ 个水平和因素 $B$ 的第 $j$ 个水平的处理组合中第 $k$ 名参与者的实测 BOLD 信号。这些因素分别有 $a$ 个和 $b$ 个水平，每个单元有 $n$ 名参与者。在本问题中，给定 $a=3$，$b=3$ 和 $n=15$。总参与者人数为 $N = a \\times b \\times n = 3 \\times 3 \\times 15 = 135$。\n\n双因素方差分析的线性模型为：\n$$y_{ijk} = \\mu + \\alpha_i + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}$$\n其中 $i=1, \\dots, a$；$j=1, \\dots, b$；以及 $k=1, \\dots, n$。在此模型中：\n- $\\mu$ 是 BOLD 信号的总均值。\n- $\\alpha_i$ 是因素 $A$（药物条件）的第 $i$ 个水平的主效应。\n- $\\beta_j$ 是因素 $B$（训练方案）的第 $j$ 个水平的主效应。\n- $(\\alpha\\beta)_{ij}$ 是因素 $A$ 的第 $i$ 个水平与因素 $B$ 的第 $j$ 个水平之间的交互效应。\n- $\\epsilon_{ijk}$ 代表每个参与者的随机误差，假设其独立同分布，服从均值为 $0$、方差为 $\\sigma^2$ 的正态分布，即 $\\epsilon_{ijk} \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n为了使模型可识别，对效应参数施加和为零的约束：\n$$ \\sum_{i=1}^{a} \\alpha_i = 0 $$\n$$ \\sum_{j=1}^{b} \\beta_j = 0 $$\n$$ \\sum_{i=1}^{a} (\\alpha\\beta)_{ij} = 0 \\quad \\text{for each } j, \\quad \\text{and} \\quad \\sum_{j=1}^{b} (\\alpha\\beta)_{ij} = 0 \\quad \\text{for each } i $$\n\n方差分析的基本原理是将总平方和 ($SS_{Total}$) 分解为归因于每个因素、它们的交互作用以及残差的各个分量。总平方和衡量数据中的总变异性：\n$$SS_{Total} = \\sum_{i=1}^{a} \\sum_{j=1}^{b} \\sum_{k=1}^{n} (y_{ijk} - \\bar{y}_{...})^2$$\n其中 $\\bar{y}_{...}$ 是所有观测值的总均值。它被分解为：\n$$SS_{Total} = SS_A + SS_B + SS_{AB} + SS_{Error}$$\n\n每个平方和分量的自由度 ($df$) 对应于计算它所使用的独立信息片段的数量。\n\n1.  **总自由度 ($df_{Total}$):** 总数据集包含 $N = abn$ 个观测值。$SS_{Total}$ 的计算涉及这 $N$ 个值，但由于从数据中估计总均值 $\\bar{y}_{...}$，会损失一个自由度。因此：\n    $$df_{Total} = N - 1 = abn - 1$$\n\n2.  **因素 A 的自由度 ($df_A$):** 此分量与 $a$ 个主效应 $\\alpha_i$ 相关。由于约束 $\\sum_{i=1}^{a} \\alpha_i = 0$，这些效应中只有 $a-1$ 个是独立的；一旦其他效应已知，最后一个就被确定了。因此：\n    $$df_A = a - 1$$\n\n3.  **因素 B 的自由度 ($df_B$):** 类似地，对于因素 $B$ 的 $b$ 个主效应 $\\beta_j$，约束 $\\sum_{j=1}^{b} \\beta_j = 0$ 意味着只有 $b-1$ 个效应是独立的。因此：\n    $$df_B = b - 1$$\n\n4.  **交互作用的自由度 ($df_{AB}$):** 存在 $ab$ 个交互效应 $(\\alpha\\beta)_{ij}$。这些效应受到 $a$ 个行和约束以及 $b$ 个列和约束。然而，其中一个约束是多余的。独立约束的总数为 $a+b-1$。独立交互效应的数量是总效应数减去独立约束数：$ab - (a+b-1) = ab - a - b + 1$。这可以被因式分解为：\n    $$df_{AB} = (a-1)(b-1)$$\n\n5.  **误差自由度 ($df_{Error}$):** 误差平方和 $SS_{Error}$ 代表合并的单元内变异性，$SS_{Error} = \\sum_{i=1}^{a} \\sum_{j=1}^{b} \\sum_{k=1}^{n} (y_{ijk} - \\bar{y}_{ij.})^2$，其中 $\\bar{y}_{ij.}$ 是单元 $(i,j)$ 的均值。对于 $ab$ 个单元中的每一个，我们从 $n$ 个观测值中计算一个平方和，它有 $n-1$ 个自由度（因估计单元均值而损失一个）。由于设计是平衡的，总误差自由度是所有单元自由度的总和：\n    $$df_{Error} = ab(n-1)$$\n\n自由度的划分是可加的，我们可以验证这一点：\n$df_A + df_B + df_{AB} + df_{Error} = (a-1) + (b-1) + (a-1)(b-1) + ab(n-1)$\n$= a - 1 + b - 1 + (ab - a - b + 1) + abn - ab$\n$= abn - 1 = df_{Total}$。划分是一致的。\n\n接下来，我们指定 $F$ 检验。$F$ 统计量是两个均方 ($MS$) 的比值，其中 $MS = SS/df$。在此设计中，所有检验的分母都是误差均方，$MS_{Error} = SS_{Error}/df_{Error}$，即合并的单元内方差估计。\n\n-   **因素 A 主效应的检验：** 检验统计量为 $$F_A = \\frac{MS_A}{MS_{Error}} = \\frac{SS_A/df_A}{SS_{Error}/df_{Error}}$$ 该统计量与具有 $df_A$ 和 $df_{Error}$ 自由度的 $F$ 分布进行比较。\n-   **因素 B 主效应的检验：** 检验统计量为 $$F_B = \\frac{MS_B}{MS_{Error}} = \\frac{SS_B/df_B}{SS_{Error}/df_{Error}}$$ 该统计量与具有 $df_B$ 和 $df_{Error}$ 自由度的 $F$ 分布进行比较。\n-   **交互效应 A $\\times$ B 的检验：** 检验统计量为 $$F_{AB} = \\frac{MS_{AB}}{MS_{Error}} = \\frac{SS_{AB}/df_{AB}}{SS_{Error}/df_{Error}}$$ 该统计量与具有 $df_{AB}$ 和 $df_{Error}$ 自由度的 $F$ 分布进行比较。\n\n最后，我们根据给定的 $a=3$，$b=3$ 和 $n=15$ 计算自由度的具体值。\n-   $df_A = a - 1 = 3 - 1 = 2$。\n-   $df_B = b - 1 = 3 - 1 = 2$。\n-   $df_{AB} = (a-1)(b-1) = (3-1)(3-1) = 2 \\times 2 = 4$。\n-   $df_{Error} = ab(n-1) = (3)(3)(15-1) = 9 \\times 14 = 126$。\n-   $df_{Total} = abn - 1 = (3)(3)(15) - 1 = 135 - 1 = 134$。\n\n计算出的自由度为：因素 $A$ 为 $2$，因素 $B$ 为 $2$，交互作用 $A \\times B$ 为 $4$，误差为 $126$，总和为 $134$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  2  4  126  134\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "统计检验通常依赖于关于数据分布的假设，而这些假设在实践中可能不成立。随机化推断提供了一种有力的替代方法，它将统计显著性直接根植于随机分配这一物理行为本身。本练习将引导你在尖锐零假设（sharp null hypothesis）下，为一个两组实验推导精确的 $p$ 值，从而展示因果声明如何能仅凭实验设计本身得到严格的论证，而无需依赖参数模型 ()。",
            "id": "4161397",
            "problem": "一个团队正在一项受试者层面的随机实验中研究经颅磁刺激 (TMS) 对运动皮层兴奋性的因果效应。四十名神经系统健康的受试者被随机分为两组，TMS组和伪刺激组，每组人数相等，$n_1 = n_2 = 20$，采用完全随机化方法：从 $N=40$ 名受试者中为TMS组选择 $n_1$ 人的每一种分配方式都有同等可能性。每位受试者的响应是一个二元指标 $Y_i \\in \\{0,1\\}$，表示其干预后的运动诱发电位是否超过其基线水平。检验统计量是样本均值之差，\n$$\nT \\;=\\; \\bar{Y}_T - \\bar{Y}_C \\;=\\; \\frac{1}{n_1} \\sum_{i: Z_i=1} Y_i \\;-\\; \\frac{1}{n_2} \\sum_{i: Z_i=0} Y_i,\n$$\n其中 $Z_i \\in \\{0,1\\}$ 表示分配至TMS组 ($Z_i=1$) 或伪刺激组 ($Z_i=0$)。在无处理效应的尖锐零假设下，响应 $\\{Y_i\\}_{i=1}^{40}$ 是固定的，任何随机性仅源于分配机制。\n\n在此实验中，观测数据满足 $\\sum_{i=1}^{40} Y_i = 22$ 且 $\\sum_{i: Z_i=1} Y_i = 15$，因此检验统计量的观测值为 $T_{\\mathrm{obs}}$。\n\n从随机化原则（即在尖锐零假设下，$\\binom{N}{n_1}$ 种平衡分配中的每一种都是等可能的）出发，推导一个 $n_1=n_2=20$ 的双臂受试者层面完全随机化设计的检验统计量 $T$ 的精确随机化分布，此过程仅使用该设计所蕴含的组合计数方法。然后，利用此分布，将 $T_{\\mathrm{obs}}$ 的精确双边随机化 $p$ 值表示为一个仅包含二项式系数和有限和的单一闭式解析表达式。不要引入任何模型假设（例如随机分配之外的独立性或参数化似然），并且不要使用渐近近似。你的最终答案必须是该双边 $p$ 值的单一闭式表达式。如果你选择提供数值近似，请将答案四舍五入到四位有效数字；否则，请提供精确表达式。",
            "solution": "问题要求在无处理效应的尖锐零假设下，为一个随机化检验推导其精确的双边 $p$ 值。该推导必须仅基于完全随机化设计的组合特性。\n\n首先，我们将问题形式化。我们有 $N=40$ 名受试者，其中 $n_1=20$ 人被分配到处理组（TMS），$n_2=20$ 人被分配到对照组（伪刺激）。响应 $Y_i$ 是二元的，$Y_i \\in \\{0, 1\\}$。观测数据显示，响应为 $Y_i=1$（成功）的受试者总数为 $S = \\sum_{i=1}^{40} Y_i = 22$。因此，响应为 $Y_i=0$（失败）的受试者总数为 $F = N - S = 40 - 22 = 18$。\n\n尖锐零假设指出，处理对任何个体都没有影响。这意味着无论受试者接受TMS还是伪刺激，其响应 $Y_i$ 都会是相同的。在此假设下，这组由22个1和18个0组成的40个结果可以被视为固定的。实验中唯一的随机性来源是将受试者随机分配到处理组和对照组。\n\n实验涉及从总共 $N=40$ 名受试者中为处理组选择 $n_1=20$ 人。这样做的总方式数由二项式系数 $\\binom{N}{n_1} = \\binom{40}{20}$ 给出。在完全随机化下，这些分配中的每一种都是等可能的。\n\n设 $k$ 为一个随机变量，表示处理组中成功的数量（即 $Y_i=1$ 的受试者数量）。在零假设下，将受试者分配到处理组等同于从一个包含 $S=22$ 个成功和 $F=18$ 个失败的 $N=40$ 的总体中，进行大小为 $n_1=20$ 的无放回抽样。在处理组中观察到恰好 $k$ 个成功的概率遵循超几何分布。$k$ 的概率质量函数（PMF）为：\n$$ P(k) = \\frac{\\binom{S}{k} \\binom{F}{n_1-k}}{\\binom{N}{n_1}} = \\frac{\\binom{22}{k} \\binom{18}{20-k}}{\\binom{40}{20}} $$\n$k$ 的可能取值（分布的支撑集）是受约束的。成功的数量 $k$ 不能超过组内受试者数量 $n_1=20$，也不能超过总成功数 $S=22$。所以，$k \\le \\min(n_1, S) = 20$。处理组中失败的数量 $n_1-k$ 不能超过总失败数 $F=18$。这意味着 $20-k \\le 18$，所以 $k \\ge 2$。因此，$k$ 的支撑集是整数集合 $\\{k \\in \\mathbb{Z} \\mid 2 \\le k \\le 20\\}$。\n\n检验统计量由 $T = \\bar{Y}_T - \\bar{Y}_C$ 给出。让我们将 $T$ 表示为 $k$ 的函数。\n处理组中的成功数量为 $\\sum_{i: Z_i=1} Y_i = k$。\n处理组的均值为 $\\bar{Y}_T = \\frac{k}{n_1}$。\n对照组中的成功数量为 $S-k$。\n对照组的均值为 $\\bar{Y}_C = \\frac{S-k}{n_2}$。\n所以，检验统计量是：\n$$ T(k) = \\frac{k}{n_1} - \\frac{S-k}{n_2} $$\n代入给定值 $n_1=20$，$n_2=20$ 和 $S=22$：\n$$ T(k) = \\frac{k}{20} - \\frac{22-k}{20} = \\frac{k - (22-k)}{20} = \\frac{2k-22}{20} $$\n这个表达式表明 $T$ 是 $k$ 的一个严格递增的线性函数。\n\n问题指出，在TMS组中观察到的成功数量为 $\\sum_{i:Z_i=1} Y_i = 15$。这是我们的随机变量的观测值，$k_{\\mathrm{obs}}=15$。检验统计量的观测值为：\n$$ T_{\\mathrm{obs}} = T(15) = \\frac{2(15) - 22}{20} = \\frac{30 - 22}{20} = \\frac{8}{20} = 0.4 $$\n\n双边 $p$ 值是在尖锐零假设下，观察到至少与观测值一样极端的检验统计量的概率。数学上，这表示为 $p = P(|T| \\ge |T_{\\mathrm{obs}}|)$。\n$$ |T(k)| \\ge |T_{\\mathrm{obs}}| \\implies \\left|\\frac{2k-22}{20}\\right| \\ge |0.4| $$\n$$ |2k-22| \\ge 8 $$\n这个不等式可以分为两种情况：\n1. $2k - 22 \\ge 8 \\implies 2k \\ge 30 \\implies k \\ge 15$.\n2. $2k - 22 \\le -8 \\implies 2k \\le 14 \\implies k \\le 7$.\n\n因此，与观测值 $k_{\\mathrm{obs}}=15$ 同样极端或更极端的 $k$ 值集合是 $\\{k \\mid k \\le 7 \\text{ or } k \\ge 15\\}$。\n为了计算 $p$ 值，我们必须对此集合中所有落在分布支撑集 $[2, 20]$ 内的 $k$ 值，对它们的概率 $P(k)$ 进行求和。\n这些条件的并集给出了我们必须对其概率求和的整数集合：$\\{2, 3, 4, 5, 6, 7\\} \\cup \\{15, 16, 17, 18, 19, 20\\}$。\n\n$p$ 值是这些 $k$ 值的概率之和：\n$$ p = \\sum_{k \\in \\{2..7\\} \\cup \\{15..20\\}} P(k) = \\sum_{k=2}^{7} P(k) + \\sum_{k=15}^{20} P(k) $$\n代入 $P(k)$ 的表达式：\n$$ p = \\sum_{k=2}^{7} \\frac{\\binom{22}{k} \\binom{18}{20-k}}{\\binom{40}{20}} + \\sum_{k=15}^{20} \\frac{\\binom{22}{k} \\binom{18}{20-k}}{\\binom{40}{20}} $$\n这可以写成一个单一的闭式表达式：\n$$ p = \\frac{1}{\\binom{40}{20}} \\left( \\sum_{k=2}^{7} \\binom{22}{k} \\binom{18}{20-k} + \\sum_{k=15}^{20} \\binom{22}{k} \\binom{18}{20-k} \\right) $$\n这个表达式就是精确的双边随机化 $p$ 值，它是按要求仅使用组合计数推导出来的。它只涉及二项式系数和有限和。",
            "answer": "$$ \\boxed{ \\frac{1}{\\binom{40}{20}} \\left( \\sum_{k=2}^{7} \\binom{22}{k} \\binom{18}{20-k} + \\sum_{k=15}^{20} \\binom{22}{k} \\binom{18}{20-k} \\right) } $$"
        }
    ]
}