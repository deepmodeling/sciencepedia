{
    "hands_on_practices": [
        {
            "introduction": "在多因素实验中，一个核心任务是量化各个因素及其交互作用对观测结果的贡献。方差分析（ANOVA）为此提供了一个强大的框架，它将数据的总变异分解为归属于不同效应（主效应、交互作用）和随机误差的部分。这项练习将引导你从第一性原理出发，推导一个全因子设计的自由度，这是理解方差分析表中每个数字含义和构建$F$检验的关键一步。",
            "id": "4161379",
            "problem": "一个神经科学实验室正在进行一项双因素被试间实验，使用功能性磁共振成像 (fMRI) 来评估预定义感兴趣区域内的局部血氧水平依赖 (BOLD) 信号振幅。该实验设计操纵了两个分类因子：因子 $A$（有 $3$ 个水平）代表神经调节药物条件，因子 $B$（有 $3$ 个水平）代表任务训练方案。参与者通过跨扫描仪日的区组随机化被随机分配到 $3 \\times 3$ 个处理组合之一，以保持每个单元的平衡并控制由特定日的扫描仪漂移引起的无关变异性。每个处理组合（单元）包含 $n=15$ 名独立参与者，数据使用独立样本双因素方差分析进行分析。\n\n假设单元水平结构的双因素被试间线性模型满足以下标准条件：效应的可加性、通过对因子效应及其交互作用施加和为零约束实现的可识别性、单元内和单元间的同方差独立误差，以及通过平衡随机化确保的正交性。从广义线性模型和将平方和分解为归属于因子 $A$、因子 $B$、它们的交互作用 $A \\times B$ 以及残差（单元内变异性）的分量的定义出发，推导每个分量及总和的自由度。然后，指定主效应和交互作用的相应 $F$ 检验，并确定适当的分子和分母均方。\n\n按顺序计算并报告因子 $A$、因子 $B$、交互作用 $A \\times B$、误差和总和的自由度。将最终答案表示为单行矩阵。无需四舍五入。无需单位。",
            "solution": "该问题提出了一个双因素被试间实验设计，并要求推导和计算相应的双因素方差分析 (ANOVA) 的自由度，以及说明相关的 $F$ 检验。\n\n首先，我们建立统计模型。设 $y_{ijk}$ 为因子 $A$ 的第 $i$ 个水平和因子 $B$ 的第 $j$ 个水平所对应的处理组合中第 $k$ 名参与者测得的 BOLD 信号。因子分别有 $a$ 和 $b$ 个水平，每个单元有 $n$ 名参与者。在本问题中，给定 $a=3$，$b=3$，$n=15$。总参与者人数为 $N = a \\times b \\times n = 3 \\times 3 \\times 15 = 135$。\n\n双因素方差分析的线性模型是：\n$$y_{ijk} = \\mu + \\alpha_i + \\beta_j + (\\alpha\\beta)_{ij} + \\epsilon_{ijk}$$\n其中 $i=1, \\dots, a$；$j=1, \\dots, b$；$k=1, \\dots, n$。在此模型中：\n- $\\mu$ 是 BOLD 信号的总平均值。\n- $\\alpha_i$ 是因子 $A$（药物条件）第 $i$ 个水平的主效应。\n- $\\beta_j$ 是因子 $B$（训练方案）第 $j$ 个水平的主效应。\n- $(\\alpha\\beta)_{ij}$ 是因子 $A$ 的第 $i$ 个水平与因子 $B$ 的第 $j$ 个水平之间的交互效应。\n- $\\epsilon_{ijk}$ 代表每位参与者的随机误差，假设其独立同分布于均值为 $0$、方差为 $\\sigma^2$ 的正态分布，即 $\\epsilon_{ijk} \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n为使模型可识别，对效应参数施加和为零约束：\n$$ \\sum_{i=1}^{a} \\alpha_i = 0 $$\n$$ \\sum_{j=1}^{b} \\beta_j = 0 $$\n$$ \\sum_{i=1}^{a} (\\alpha\\beta)_{ij} = 0 \\quad \\text{for each } j, \\quad \\text{and} \\quad \\sum_{j=1}^{b} (\\alpha\\beta)_{ij} = 0 \\quad \\text{for each } i $$\n\n方差分析的基本原理是将总平方和 ($SS_{Total}$) 分解为归属于每个因子、它们的交互作用以及残差的分量。总平方和衡量数据中的总变异性：\n$$SS_{Total} = \\sum_{i=1}^{a} \\sum_{j=1}^{b} \\sum_{k=1}^{n} (y_{ijk} - \\bar{y}_{...})^2$$\n其中 $\\bar{y}_{...}$ 是所有观测值的总平均值。它被分解为：\n$$SS_{Total} = SS_A + SS_B + SS_{AB} + SS_{Error}$$\n\n每个平方和分量的自由度 ($df$) 对应于计算它所使用的独立信息片段的数量。\n\n1.  **总自由度 ($df_{Total}$):** 总数据集包含 $N = abn$ 个观测值。$SS_{Total}$ 的计算涉及这 $N$ 个值，但由于从数据中估计总平均值 $\\bar{y}_{...}$，会损失一个自由度。因此：\n    $$df_{Total} = N - 1 = abn - 1$$\n\n2.  **因子 A 的自由度 ($df_A$):** 该分量与 $a$ 个主效应 $\\alpha_i$ 相关。由于约束 $\\sum_{i=1}^{a} \\alpha_i = 0$，这些效应中只有 $a-1$ 个是独立的；一旦其他效应已知，最后一个就被固定了。因此：\n    $$df_A = a - 1$$\n\n3.  **因子 B 的自由度 ($df_B$):** 类似地，对于因子 $B$ 的 $b$ 个主效应 $\\beta_j$，约束 $\\sum_{j=1}^{b} \\beta_j = 0$ 意味着只有 $b-1$ 个效应是独立的。因此：\n    $$df_B = b - 1$$\n\n4.  **交互作用的自由度 ($df_{AB}$):** 存在 $ab$ 个交互效应 $(\\alpha\\beta)_{ij}$。这些效应受到 $a$ 个行和约束和 $b$ 个列和约束的限制。然而，其中一个约束是多余的。独立约束的总数为 $a+b-1$。独立交互效应的数量是总效应数减去独立约束数：$ab - (a+b-1) = ab - a - b + 1$。这可以因式分解为：\n    $$df_{AB} = (a-1)(b-1)$$\n\n5.  **误差自由度 ($df_{Error}$):** 误差平方和 $SS_{Error}$ 代表合并的单元内变异性，$SS_{Error} = \\sum_{i=1}^{a} \\sum_{j=1}^{b} \\sum_{k=1}^{n} (y_{ijk} - \\bar{y}_{ij.})^2$，其中 $\\bar{y}_{ij.}$ 是单元 $(i,j)$ 的均值。对于 $ab$ 个单元中的每一个，我们从 $n$ 个观测值中计算一个平方和，其自由度为 $n-1$（因估计单元均值而损失一个）。由于设计是平衡的，总误差自由度是所有单元自由度的总和：\n    $$df_{Error} = ab(n-1)$$\n\n自由度的分解是可加的，我们可以验证：\n$df_A + df_B + df_{AB} + df_{Error} = (a-1) + (b-1) + (a-1)(b-1) + ab(n-1)$\n$= a - 1 + b - 1 + (ab - a - b + 1) + abn - ab$\n$= abn - 1 = df_{Total}$。分解是一致的。\n\n接下来，我们指定 $F$ 检验。$F$ 统计量是两个均方 ($MS$) 的比值，其中 $MS = SS/df$。在此设计中，所有检验的分母都是误差均方，$MS_{Error} = SS_{Error}/df_{Error}$，即合并的单元内方差估计。\n\n-   **因子 A 主效应检验：** 检验统计量为 $F_A = \\frac{MS_A}{MS_{Error}} = \\frac{SS_A/df_A}{SS_{Error}/df_{Error}}$。将此统计量与自由度为 $df_A$ 和 $df_{Error}$ 的 $F$ 分布进行比较。\n-   **因子 B 主效应检验：** 检验统计量为 $F_B = \\frac{MS_B}{MS_{Error}} = \\frac{SS_B/df_B}{SS_{Error}/df_{Error}}$。将此统计量与自由度为 $df_B$ 和 $df_{Error}$ 的 $F$ 分布进行比较。\n-   **交互作用 A $\\times$ B 效应检验：** 检验统计量为 $F_{AB} = \\frac{MS_{AB}}{MS_{Error}} = \\frac{SS_{AB}/df_{AB}}{SS_{Error}/df_{Error}}$。将此统计量与自由度为 $df_{AB}$ 和 $df_{Error}$ 的 $F$ 分布进行比较。\n\n最后，我们根据给定的 $a=3$，$b=3$ 和 $n=15$ 计算自由度的具体值。\n-   $df_A = a - 1 = 3 - 1 = 2$。\n-   $df_B = b - 1 = 3 - 1 = 2$。\n-   $df_{AB} = (a-1)(b-1) = (3-1)(3-1) = 2 \\times 2 = 4$。\n-   $df_{Error} = ab(n-1) = (3)(3)(15-1) = 9 \\times 14 = 126$。\n-   $df_{Total} = abn - 1 = (3)(3)(15) - 1 = 135 - 1 = 134$。\n\n计算得出的自由度为：因子 $A$ 为 $2$，因子 $B$ 为 $2$，交互作用 $A \\times B$ 为 $4$，误差为 $126$，总和为 $134$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  2  4  126  134\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然全因子设计很彻底，但随着因子数量的增加，其实验成本会急剧上升。部分因子设计（fractional factorial designs）提供了一种在保持科学严谨性的同时节省资源的有效策略。这项练习的核心是理解这种效率的代价——效应别名（aliasing），即某些效应会变得无法区分，本练习将教你如何通过分析别名结构来明智地选择设计并解释结果。",
            "id": "4161390",
            "problem": "一个系统神经科学实验室计划研究在受控刺激下，多个实验因素如何共同影响培养的皮层神经元的平均发放率。该团队考虑了 $5$ 个二元因素，每个因素都有两个水平，使用标准的 $\\pm 1$ 约定进行编码：因素 $A$（突触阻断剂存在 vs. 缺失）、因素 $B$（高 vs. 低细胞外钾离子浓度）、因素 $C$（光遗传学刺激开启 vs. 关闭）、因素 $D$（神经调节剂存在 vs. 缺失）以及因素 $E$（膜电位钳制高 vs. 低）。为了在能够估计主效应的前提下减少实验次数，并假设大多数高阶交互作用可以忽略不计，他们采用了一个 $2^{5-2}$ 次运行的部分析因设计，其生成元为 $D=AB$ 和 $E=AC$。\n\n仅从两水平部分析因设计、生成元、定义关系和通过定义关系产生的别名关系这些核心定义出发，推导出此设计中的定义关系以及主效应的别名结构。利用你推导出的别名结构，确定哪些二因子交互作用与主效应相混杂。\n\n令 $N$ 表示在此设计中与至少一个主效应互为别名的不同二因子交互作用的总数。报告 $N$ 的值。你的最终数值答案应为精确值，无需四舍五入。",
            "solution": "该问题要求分析一个 $2^{5-2}$ 部分析因设计。这是一个针对 $k=5$ 个因素、进行 $2^{5-2} = 2^3 = 8$ 次运行的设计。该设计由 $p=2$ 个生成元指定，这些生成元定义了某些因素的水平如何由其他因素的水平决定。\n\n因素由大写字母 $A, B, C, D, E$ 表示。在因素水平的标准 $\\pm 1$ 表示法中，生成元 $D=AB$ 和 $E=AC$ 意味着设计矩阵中因素 $D$ 的列是因素 $A$ 和 $B$ 列的逐元素乘积，而因素 $E$ 的列是因素 $A$ 和 $C$ 列的乘积。\n\n**1. 推导定义关系**\n通过将等式两边同乘以右侧的因子，可以将生成元重写为恒等式形式。利用对于任何因子 $X$ 都有 $X^2=I$ 的性质（其中 $I$ 是恒等元，即一列 $+1$s），我们得到：\n$D = AB \\implies D(AB) = (AB)(AB) \\implies ABD = A^2B^2 = I \\cdot I = I$。因此，第一个生成元的恒等式形式为 $g_1 = ABD$。\n$E = AC \\implies E(AC) = (AC)(AC) \\implies ACE = A^2C^2 = I \\cdot I = I$。因此，第二个生成元的恒等式形式为 $g_2 = ACE$。\n\n该设计的定义关系是由恒等元 $I$、生成元及其所有可能的乘积构成的一个群。在本例中，我们需要计算两个生成元的乘积：\n$g_1 g_2 = (ABD)(ACE) = A^2BCDE = I \\cdot BCDE = BCDE$。\n\n完整的定义关系是所有等价于恒等元 $I$ 的“字”的集合。因此，定义关系是：\n$$I = ABD = ACE = BCDE$$\n此关系定义了设计的混杂模式。任何效应或交互作用乘以定义关系中的一个字（$I$ 除外）都会产生一个别名效应。\n\n**2. 推导主效应的别名结构**\n任何效应的别名结构都可以通过将其与定义关系中的每个字相乘得到。所得项的集合都彼此混杂。我们被要求具体找出主效应（$A, B, C, D, E$）的别名结构。\n\n- **主效应 A 的别名结构：**\n  将 $A$ 与定义关系相乘：\n  $A \\cdot I = A$\n  $A \\cdot (ABD) = A^2BD = BD$\n  $A \\cdot (ACE) = A^2CE = CE$\n  $A \\cdot (BCDE) = ABCDE$\n  因此，主效应 $A$ 与二因子交互作用 $BD$ 和 $CE$ 以及五因子交互作用 $ABCDE$ 互为别名。我们将其写作 $[A] = A + BD + CE + ABCDE$。\n\n- **主效应 B 的别名结构：**\n  将 $B$ 与定义关系相乘：\n  $B \\cdot I = B$\n  $B \\cdot (ABD) = AB^2D = AD$\n  $B \\cdot (ACE) = ABCE$\n  $B \\cdot (BCDE) = B^2CDE = CDE$\n  因此，主效应 $B$ 与二因子交互作用 $AD$ 以及三因子和四因子交互作用 $CDE$ 和 $ABCE$ 互为别名。我们将其写作 $[B] = B + AD + CDE + ABCE$。\n\n- **主效应 C 的别名结构：**\n  将 $C$ 与定义关系相乘：\n  $C \\cdot I = C$\n  $C \\cdot (ABD) = ABCD$\n  $C \\cdot (ACE) = AC^2E = AE$\n  $C \\cdot (BCDE) = BC^2DE = BDE$\n  因此，主效应 $C$ 与二因子交互作用 $AE$ 以及三因子和四因子交互作用 $BDE$ 和 $ABCD$ 互为别名。我们将其写作 $[C] = C + AE + BDE + ABCD$。\n\n- **主效应 D 的别名结构：**\n  将 $D$ 与定义关系相乘：\n  $D \\cdot I = D$\n  $D \\cdot (ABD)=ABD^2=AB$\n  $D \\cdot (ACE)=ACDE$\n  $D \\cdot (BCDE)=BCD^2E=BCE$\n  因此，主效应 $D$ 与二因子交互作用 $AB$ 以及三因子和四因子交互作用 $BCE$ 和 $ACDE$ 互为别名。我们将其写作 $[D] = D + AB + BCE + ACDE$。\n\n- **主效应 E 的别名结构：**\n  将 $E$ 与定义关系相乘：\n  $E \\cdot I = E$\n  $E \\cdot (ABD) = ABDE$\n  $E \\cdot (ACE) = ACE^2 = AC$\n  $E \\cdot (BCDE) = BCD$\n  因此，主效应 $E$ 与二因子交互作用 $AC$ 以及三因子和四因子交互作用 $BCD$ 和 $ABDE$ 互为别名。我们将其写作 $[E] = E + AC + BCD + ABDE$。\n\n**3. 识别混杂的二因子交互作用并计数**\n问题要求 $N$，即与至少一个主效应互为别名的不同二因子交互作用的总数。我们可以直接从上面推导出的别名结构中提取这些交互作用。在三因子或更多因子的交互作用可忽略不计的通常假设下，主要关注的是主效应与二因子交互作用的别名关系。\n\n- 从 $[A] = A + BD + CE + ABCDE$ 中，二因子交互作用是 $BD$ 和 $CE$。\n- 从 $[B] = B + AD + CDE + ABCE$ 中，二因子交互作用是 $AD$。\n- 从 $[C] = C + AE + BDE + ABCD$ 中，二因子交互作用是 $AE$。\n- 从 $[D] = D + AB + BCE + ACDE$ 中，二因子交互作用是 $AB$。\n- 从 $[E] = E + AC + BCD + ABDE$ 中，二因子交互作用是 $AC$。\n\n我们来编制一个所有此类唯一的二因子交互作用的列表：\n1. $AB$（与 $D$ 互为别名）\n2. $AC$（与 $E$ 互为别名）\n3. $AD$（与 $B$ 互为别名）\n4. $AE$（与 $C$ 互为别名）\n5. $BD$（与 $A$ 互为别名）\n6. $CE$（与 $A$ 互为别名）\n\n这些都是不同的二因子交互作用。我们现在计算这个集合中交互作用的数量。共有 $6$ 个这样的交互作用。\n\n因此，与主效应互为别名的不同二因子交互作用的总数是 $N=6$。\n设计的分辨度是定义关系中最短字的长度。在这里，最短的字是 $ABD$ 和 $ACE$，长度都为 $3$。因此，这是一个分辨度III的设计。在分辨度III的设计中，主效应与二因子交互作用互为别名，这与我们的发现一致。\n\n与主效应混杂的二因子交互作用的最终汇编：\n- $A$ 与 $BD$ 和 $CE$ 混杂。\n- $B$ 与 $AD$ 混杂。\n- $C$ 与 $AE$ 混杂。\n- $D$ 与 $AB$ 混杂。\n- $E$ 与 $AC$ 混杂。\n\n与主效应互为别名的二因子交互作用的完整集合是 $\\{AB, AC, AD, AE, BD, CE\\}$。该集合中的元素数量 $N$ 是 $6$。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "随机化是实验设计的基石，它赋予我们进行因果推断的能力。这项练习将超越传统的基于模型的检验（如t检验或ANOVA），直接展示随机分配本身如何构成统计推断的基础。我们将通过构造一个精确的随机化检验来计算$p$值，从而深刻理解为何随机实验是建立因果关系的黄金标准，而这一切都无需依赖于对数据分布的参数化假设。",
            "id": "4161397",
            "problem": "一个研究团队正在一项个体水平的随机实验中，研究经颅磁刺激 (TMS) 对运动皮层兴奋性的因果效应。四十名神经系统健康的受试者被随机分配到两个组：TMS组和伪刺激(sham)组，每组人数相等，$n_1 = n_2 = 20$，采用完全随机化方法：即每一种从 $N=40$ 名受试者中为TMS组选择 $n_1$ 人的分配方式都是等可能的。每位受试者的响应是一个二元指标 $Y_i \\in \\{0,1\\}$，表示其干预后的运动诱发电位是否超过其基线水平。检验统计量是样本均值之差，\n$$\nT \\;=\\; \\bar{Y}_T - \\bar{Y}_C \\;=\\; \\frac{1}{n_1} \\sum_{i: Z_i=1} Y_i \\;-\\; \\frac{1}{n_2} \\sum_{i: Z_i=0} Y_i,\n$$\n其中 $Z_i \\in \\{0,1\\}$ 表示分配到TMS组 ($Z_i=1$) 或伪刺激组 ($Z_i=0$)。在无治疗效应的尖锐原假设下，响应 $\\{Y_i\\}_{i=1}^{40}$ 是固定的，任何随机性仅来自于分配机制。\n\n在本次实验中，观测到的数据满足 $\\sum_{i=1}^{40} Y_i = 22$ 和 $\\sum_{i: Z_i=1} Y_i = 15$，因此检验统计量的观测值为 $T_{\\mathrm{obs}}$。\n\n从随机化原则出发（即在尖锐原假设下，$\\binom{N}{n_1}$ 种平衡分配中的每一种都是等可能的），请针对一个双臂、个体水平、完全随机化且 $n_1=n_2=20$ 的设计，仅使用该设计所蕴含的组合计数方法，推导 $T$ 的精确随机化分布。然后，利用此分布，将 $T_{\\mathrm{obs}}$ 的精确双侧随机化 $p$ 值表示为单个只包含二项式系数和有限和的闭式解析表达式。不要引用任何模型假设（例如除了随机分配之外的独立性或参数化似然），也不要使用渐近近似。你的最终答案必须是那个表示双侧 $p$ 值的单个闭式表达式。如果你选择提供数值近似，请将答案四舍五入到四位有效数字；否则，请提供精确表达式。",
            "solution": "问题要求在无治疗效应的尖锐原假设下，推导一个随机化检验的精确双侧 $p$ 值。该推导过程必须仅基于完全随机化设计的组合特性。\n\n首先，我们将问题形式化。我们有 $N=40$ 名受试者，其中 $n_1=20$ 人被分配到治疗组（TMS组），$n_2=20$ 人被分配到对照组（伪刺激组）。响应 $Y_i$ 是二元的，$Y_i \\in \\{0, 1\\}$。观测数据显示，响应为 $Y_i=1$（成功）的受试者总数为 $S = \\sum_{i=1}^{40} Y_i = 22$。因此，响应为 $Y_i=0$（失败）的受试者总数为 $F = N - S = 40 - 22 = 18$。\n\n尖锐原假设指出，治疗对任何个体都没有影响。这意味着无论受试者接受TMS还是伪刺激，其响应 $Y_i$ 都是相同的。在此假设下，由22个1和18个0组成的这40个结果的集合可以被视为固定的。实验中唯一的随机性来源是对受试者进行治疗组和对照组的随机分配。\n\n实验涉及从总共 $N=40$ 名受试者中为治疗组选择 $n_1=20$ 名受试者。实现这一选择的方法数由二项式系数 $\\binom{N}{n_1} = \\binom{40}{20}$ 给出。在完全随机化下，每种分配都是等可能的。\n\n令 $k$ 为随机变量，表示治疗组中成功的数量（即响应为 $Y_i=1$ 的受试者数量）。在原假设下，将受试者分配到治疗组等价于从一个包含 $S=22$ 个成功和 $F=18$ 个失败的总数 $N=40$ 的群体中，进行无放回地抽取大小为 $n_1=20$ 的样本。在治疗组中观测到恰好 $k$ 个成功的概率遵循超几何分布。$k$ 的概率质量函数 (PMF) 为：\n$$ P(k) = \\frac{\\binom{S}{k} \\binom{F}{n_1-k}}{\\binom{N}{n_1}} = \\frac{\\binom{22}{k} \\binom{18}{20-k}}{\\binom{40}{20}} $$\n$k$ 的可能取值（即分布的支撑集）是受限的。成功的数量 $k$ 不能超过组内受试者数量 $n_1=20$，也不能超过总成功数 $S=22$。因此，$k \\le \\min(n_1, S) = 20$。治疗组中失败的数量 $n_1-k$ 不能超过总失败数 $F=18$。这意味着 $20-k \\le 18$，所以 $k \\ge 2$。因此，$k$ 的支撑集是整数集合 $\\{k \\in \\mathbb{Z} \\mid 2 \\le k \\le 20\\}$。\n\n检验统计量由 $T = \\bar{Y}_T - \\bar{Y}_C$ 给出。我们把 $T$ 表示为 $k$ 的函数。\n治疗组中的成功数为 $\\sum_{i: Z_i=1} Y_i = k$。\n治疗组的均值为 $\\bar{Y}_T = \\frac{k}{n_1}$。\n对照组中的成功数为 $S-k$。\n对照组的均值为 $\\bar{Y}_C = \\frac{S-k}{n_2}$。\n所以，检验统计量是：\n$$ T(k) = \\frac{k}{n_1} - \\frac{S-k}{n_2} $$\n代入给定值 $n_1=20$, $n_2=20$, 和 $S=22$：\n$$ T(k) = \\frac{k}{20} - \\frac{22-k}{20} = \\frac{k - (22-k)}{20} = \\frac{2k-22}{20} $$\n这个表达式表明 $T$ 是 $k$ 的严格递增线性函数。\n\n问题陈述，在TMS组中观测到的成功数为 $\\sum_{i:Z_i=1} Y_i = 15$。这是我们随机变量的观测值，$k_{\\mathrm{obs}}=15$。检验统计量的观测值为：\n$$ T_{\\mathrm{obs}} = T(15) = \\frac{2(15) - 22}{20} = \\frac{30 - 22}{20} = \\frac{8}{20} = 0.4 $$\n\n双侧 $p$ 值是在尖锐原假设下，观测到至少与已观测值一样极端的检验统计量的概率。数学上，这表示为 $p = P(|T| \\ge |T_{\\mathrm{obs}}|)$。\n$$ |T(k)| \\ge |T_{\\mathrm{obs}}| \\implies \\left|\\frac{2k-22}{20}\\right| \\ge |0.4| $$\n$$ |2k-22| \\ge 8 $$\n这个不等式可以分为两种情况：\n1. $2k - 22 \\ge 8 \\implies 2k \\ge 30 \\implies k \\ge 15$。\n2. $2k - 22 \\le -8 \\implies 2k \\le 14 \\implies k \\le 7$。\n\n所以，与观测值 $k_{\\mathrm{obs}}=15$ 一样极端或更极端的 $k$ 值集合是 $\\{k \\mid k \\le 7 \\text{ 或 } k \\ge 15\\}$。\n为了计算 $p$ 值，我们必须对该集合中所有落在分布支撑集 $[2, 20]$ 内的 $k$ 值，求其概率 $P(k)$ 的和。\n这些条件的并集给出了我们必须对其概率求和的整数集合：$\\{2, 3, 4, 5, 6, 7\\} \\cup \\{15, 16, 17, 18, 19, 20\\}$。\n\n$p$ 值是这些 $k$ 值的概率之和：\n$$ p = \\sum_{k \\in \\{2..7\\} \\cup \\{15..20\\}} P(k) = \\sum_{k=2}^{7} P(k) + \\sum_{k=15}^{20} P(k) $$\n代入 $P(k)$ 的表达式：\n$$ p = \\sum_{k=2}^{7} \\frac{\\binom{22}{k} \\binom{18}{20-k}}{\\binom{40}{20}} + \\sum_{k=15}^{20} \\frac{\\binom{22}{k} \\binom{18}{20-k}}{\\binom{40}{20}} $$\n这可以写成一个单一的闭式表达式：\n$$ p = \\frac{1}{\\binom{40}{20}} \\left( \\sum_{k=2}^{7} \\binom{22}{k} \\binom{18}{20-k} + \\sum_{k=15}^{20} \\binom{22}{k} \\binom{18}{20-k} \\right) $$\n这个表达式就是所要求的、仅使用组合计数推导出的精确双侧随机化 $p$ 值。它只包含二项式系数和有限和。",
            "answer": "$$ \\boxed{ \\frac{1}{\\binom{40}{20}} \\left( \\sum_{k=2}^{7} \\binom{22}{k} \\binom{18}{20-k} + \\sum_{k=15}^{20} \\binom{22}{k} \\binom{18}{20-k} \\right) } $$"
        }
    ]
}