{
    "hands_on_practices": [
        {
            "introduction": "基线校正看似简单，但它依赖于一个关键假设：刺激前活动能够稳定地代表大脑的静息状态。当这一假设被违背时会发生什么？本练习将对此进行探讨。通过数学推导，你将揭示基线期内存在的缓慢且因条件而异的漂移，如何在刺激后ERP成分中产生完全人为的差异——这是任何严谨的ERP研究者都必须掌握的重要概念。",
            "id": "4173065",
            "problem": "考虑一个测量事件相关电位（ERP; Event-Related Potential）的双条件实验，其中条件 $c \\in \\{A,B\\}$ 的每个试次产生一个单通道时间序列 $x_{c,i}(t)$，该序列定义在一个时间窗口 $t \\in [-T_0, T_1]$ 内，刺激在 $t = 0$ 时出现。条件 $c$ 的 ERP 是跨试次的平均值 $\\bar{x}_c(t) = \\frac{1}{N_c} \\sum_{i=1}^{N_c} x_{c,i}(t)$，某个成分在潜伏期 $\\tau$ 的波幅定义为经过基线校正后的 $\\bar{x}_c(\\tau)$。基线校正从每个时间点减去刺激前窗口 $[-T_b,0)$ 内的均值，并逐试次应用：$x'_{c,i}(t) = x_{c,i}(t) - \\frac{1}{T_b}\\int_{-T_b}^{0} x_{c,i}(u)\\,du$。基线校正后的 ERP 为 $\\bar{x}'_c(t) = \\frac{1}{N_c} \\sum_{i=1}^{N_c} x'_{c,i}(t)$。假设一个生成模型，其中测量到的信号由诱发响应、缓慢的非诱发基线过程和噪声组成：$x_{c,i}(t) = s_c(t) + d_{c,i}(t) + \\epsilon_{c,i}(t)$，其中 $s_c(t)$ 是特定于条件的诱发响应，$d_{c,i}(t)$ 是一个在 $t=0$ 前后都存在的缓慢过程，$\\epsilon_{c,i}(t)$ 是独立于 $s_c(t)$ 和 $d_{c,i}(t)$ 的零均值噪声。假设 $d_{c,i}(t)$ 在该时间窗口内可以被一个确定性线性趋势 $d_{c,i}(t) = \\alpha_c t$ 充分近似，其中 $\\alpha_c$ 可能因缓慢漂移或先前过程的重叠而随条件变化，并且对于所有 $t \\ge 0$，$s_A(t) = s_B(t)$。在这些假设和定义下，用 $\\alpha_A$、$\\alpha_B$、$T_b$ 和 $\\tau$ 推导出期望差异 $\\Delta(\\tau) = \\mathbb{E}[\\bar{x}'_A(\\tau) - \\bar{x}'_B(\\tau)]$，并利用你的推导来评估减去具有不同均值的基线如何能在刺激后引起虚假的波幅差异。然后，评估以下关于虚假差异的存在及其缓解策略的陈述，并选择所有正确的选项：\n\nA. 如果刺激前漂移是特定于条件的，并且在刺激后以 $d_c(t) = \\alpha_c t$ 的形式继续，那么即使真实的诱发响应相同，使用窗口 $[-T_b,0)$ 进行基线校正也会在潜伏期 $\\tau$ 处产生一个期望差异 $(\\alpha_A - \\alpha_B)\\,(\\tau + T_b/2)$。\n\nB. 不论基线动态是否平稳，使用特定于条件的基线校正总能保证刺激后波幅差异是无偏的。\n\nC. 通过重加权试次来匹配各条件间的基线分布，使得经验基线均值相等，这样做可以消除偏差中的恒定偏移部分，但不能消除由不同斜率引起的时变部分。\n\nD. 在一个试次水平的广义线性模型（GLM; General Linear Model）中，将基线均值作为协变量，在控制刺激前基线的同时，将诱发波幅估计为刺激后回归量的系数，如果该模型包含适当的基函数（例如，一个关于时间的线性项），则可以消除由恒定和线性漂移引起的偏差。\n\nE. 对于 ERP 而言，在 $2\\,\\mathrm{Hz}$ 进行高通滤波总是一种安全的基线策略，因为它从不扭曲成分波幅。",
            "solution": "问题陈述具有科学依据，提法恰当且客观。它为事件相关电位（ERP）数据提出了一个简化但标准的生成模型，以探究在存在特定于条件的线性漂移时，基线校正所引入的伪迹。所有术语都已定义，假设也明确，这使得问题可以得到一个唯一且有意义的解。因此，我将着手进行推导和评估。\n\n第一步是推导两种条件下经基线校正的 ERP 波幅之间的期望差异，即 $\\Delta(\\tau) = \\mathbb{E}[\\bar{x}'_A(\\tau) - \\bar{x}'_B(\\tau)]$。\n\n条件 $c$ 下单个试次 $i$ 经基线校正后的信号由下式给出：\n$$x'_{c,i}(t) = x_{c,i}(t) - B_{c,i}$$\n其中 $B_{c,i}$ 是信号在刺激前基线区间 $[-T_b, 0)$ 内的均值：\n$$B_{c,i} = \\frac{1}{T_b}\\int_{-T_b}^{0} x_{c,i}(u)\\,du$$\n观测信号的生成模型为：\n$$x_{c,i}(t) = s_c(t) + d_{c,i}(t) + \\epsilon_{c,i}(t)$$\n其中 $s_c(t)$ 是诱发信号，$d_{c,i}(t)$ 是缓慢漂移，$\\epsilon_{c,i}(t)$ 是零均值噪声。\n我们已知漂移的具体形式为 $d_{c,i}(t) = \\alpha_c t$。通常假设诱发响应 $s_c(t)$ 在刺激前的时间里为零，即对于 $t  0$，$s_c(t) = 0$。\n\n将模型代入基线均值 $B_{c,i}$ 的表达式中：\n$$B_{c,i} = \\frac{1}{T_b}\\int_{-T_b}^{0} [s_c(u) + \\alpha_c u + \\epsilon_{c,i}(u)]\\,du$$\n由于对于 $u  0$，$s_c(u) = 0$，上式可简化为：\n$$B_{c,i} = \\frac{1}{T_b}\\int_{-T_b}^{0} [\\alpha_c u + \\epsilon_{c,i}(u)]\\,du = \\frac{\\alpha_c}{T_b}\\int_{-T_b}^{0} u\\,du + \\frac{1}{T_b}\\int_{-T_b}^{0} \\epsilon_{c,i}(u)\\,du$$\n线性项的积分为 $\\int_{-T_b}^{0} u\\,du = \\left[\\frac{u^2}{2}\\right]_{-T_b}^{0} = 0 - \\frac{(-T_b)^2}{2} = -\\frac{T_b^2}{2}$。\n所以，单个试次的基线均值为：\n$$B_{c,i} = \\frac{\\alpha_c}{T_b} \\left(-\\frac{T_b^2}{2}\\right) + \\frac{1}{T_b}\\int_{-T_b}^{0} \\epsilon_{c,i}(u)\\,du = -\\frac{\\alpha_c T_b}{2} + \\frac{1}{T_b}\\int_{-T_b}^{0} \\epsilon_{c,i}(u)\\,du$$\n现在，我们求刺激后潜伏期 $\\tau \\ge 0$ 处经基线校正的信号：\n$$x'_{c,i}(\\tau) = x_{c,i}(\\tau) - B_{c,i} = [s_c(\\tau) + \\alpha_c \\tau + \\epsilon_{c,i}(\\tau)] - \\left[-\\frac{\\alpha_c T_b}{2} + \\frac{1}{T_b}\\int_{-T_b}^{0} \\epsilon_{c,i}(u)\\,du\\right]$$\n$$x'_{c,i}(\\tau) = s_c(\\tau) + \\alpha_c \\tau + \\frac{\\alpha_c T_b}{2} + \\epsilon_{c,i}(\\tau) - \\frac{1}{T_b}\\int_{-T_b}^{0} \\epsilon_{c,i}(u)\\,du$$\n特定于条件的 ERP $\\bar{x}'_c(\\tau)$ 是 $x'_{c,i}(\\tau)$ 在 $N_c$ 个试次上的平均值。对所有可能的噪声实现取期望 $\\mathbb{E}[...]$，并注意到对于所有 $t$，$\\mathbb{E}[\\epsilon_{c,i}(t)] = 0$，我们得到：\n$$\\mathbb{E}[\\bar{x}'_c(\\tau)] = \\mathbb{E}\\left[\\frac{1}{N_c}\\sum_{i=1}^{N_c} x'_{c,i}(\\tau)\\right] = s_c(\\tau) + \\alpha_c \\tau + \\frac{\\alpha_c T_b}{2} = s_c(\\tau) + \\alpha_c\\left(\\tau + \\frac{T_b}{2}\\right)$$\n条件 A 和 B 之间的期望差异为：\n$$\\Delta(\\tau) = \\mathbb{E}[\\bar{x}'_A(\\tau)] - \\mathbb{E}[\\bar{x}'_B(\\tau)] = \\left[s_A(\\tau) + \\alpha_A\\left(\\tau + \\frac{T_b}{2}\\right)\\right] - \\left[s_B(\\tau) + \\alpha_B\\left(\\tau + \\frac{T_b}{2}\\right)\\right]$$\n$$\\Delta(\\tau) = (s_A(\\tau) - s_B(\\tau)) + (\\alpha_A - \\alpha_B)\\left(\\tau + \\frac{T_b}{2}\\right)$$\n问题陈述中指出，真实的刺激后诱发响应是相同的，即对于 $t \\ge 0$，$s_A(t) = s_B(t)$。因此，对于 $\\tau \\ge 0$，第一项为零。所得的期望差异纯粹是基线校正与差异性漂移相互作用产生的虚假伪迹：\n$$\\Delta(\\tau) = (\\alpha_A - \\alpha_B)\\left(\\tau + \\frac{T_b}{2}\\right)$$\n这个推导表明，刺激前漂移斜率的差异 $(\\alpha_A \\neq \\alpha_B)$ 会导致一个虚假的刺激后波幅差异，该差异不是恒定的，而是随潜伏期 $\\tau$ 线性变化。\n\n现在，我将评估每个陈述。\n\nA. 如果刺激前漂移是特定于条件的，并且在刺激后以 $d_c(t) = \\alpha_c t$ 的形式继续，那么即使真实的诱发响应相同，使用窗口 $[-T_b,0)$ 进行基线校正也会在潜伏期 $\\tau$ 处产生一个期望差异 $(\\alpha_A - \\alpha_B)\\,(\\tau + T_b/2)$。\n该陈述与上面推导的结果直接且精确地匹配。其公式与我们在给定假设下计算出的虚假期望差异 $\\Delta(\\tau)$ 完全相同。\n结论：**正确**。\n\nB. 不论基线动态是否平稳，使用特定于条件的基线校正总能保证刺激后波幅差异是无偏的。\n该陈述是错误的。我的推导提供了一个直接的反例。在线性非平稳动态（$d_c(t)=\\alpha_c t$）的情况下，应用特定于条件的基线校正会导致对波幅差异的有偏估计，$\\Delta(\\tau) = (\\alpha_A - \\alpha_B)(\\tau + T_b/2)$，如果 $\\alpha_A \\neq \\alpha_B$，该值非零。“总是保证”这一说法过于绝对，因为众所周知，这种常见的基线校正形式对各种非平稳性都很敏感。\n结论：**错误**。\n\nC. 通过重加权试次来匹配各条件间的基线分布，使得经验基线均值相等，这样做可以消除偏差中的恒定偏移部分，但不能消除由不同斜率引起的时变部分。\n推导出的偏差为 $\\Delta(\\tau) = (\\alpha_A - \\alpha_B)\\tau + (\\alpha_A - \\alpha_B)\\frac{T_b}{2}$。这包含两个部分：一个时变部分 $(\\alpha_A - \\alpha_B)\\tau$ 和一个恒定偏移部分 $(\\alpha_A - \\alpha_B)\\frac{T_b}{2}$。条件 $c$ 的期望基线均值为 $\\mathbb{E}[B_c] = -\\frac{\\alpha_c T_b}{2}$。因此，期望基线均值的差异为 $\\mathbb{E}[B_A] - \\mathbb{E}[B_B] = -(\\alpha_A - \\alpha_B)\\frac{T_b}{2}$。恒定偏移偏差是该差异的负值。一个匹配经验基线均值（例如，通过子采样或重加权试次）的程序会强制使各条件间的平均基线水平相等，从而消除偏差中的恒定偏移部分。然而，这个程序并不改变潜在的信号动态。时变部分 $(\\alpha_A - \\alpha_B)\\tau$ 的产生是由于在时间 $\\tau$ 的实际信号包含项 $\\alpha_c \\tau$，而这种持续漂移的差异并不能通过调整刺激前均值来校正。因此，该陈述准确地描述了这种校正策略的效果。\n结论：**正确**。\n\nD. 在一个试次水平的广义线性模型（GLM; General Linear Model）中，将基线均值作为协变量，在控制刺激前基线的同时，将诱发波幅估计为刺激后回归量的系数，如果该模型包含适当的基函数（例如，一个关于时间的线性项），则可以消除由恒定和线性漂移引起的偏差。\n该陈述描述了一种精巧且有效的减轻此类伪迹的方法。GLM 可以对多个因素对观测数据的贡献进行建模。在一个关于数据点 $x_{c,i}(t)$ 的试次水平模型中，可以包含实验条件、该试次的刺激前基线均值、时间 $t$ 本身，以及关键的时间与条件的交互作用的回归量。一个形式为 $x_i(t) \\sim \\text{Condition} + B_i + t + \\text{Condition} \\times t$ 的模型通过 $t$ 的主效应和交互项，明确地建模并估计了特定于条件的线性漂移。通过解释这种差异性漂移，该模型可以提供对条件对诱发响应效应的无偏估计。该方法移除了偏差的根本原因（即差异性斜率），从而校正了伪迹的时变和恒定偏移两个部分。\n结论：**正确**。\n\nE. 对于 ERP 而言，在 $2\\,\\mathrm{Hz}$ 进行高通滤波总是一种安全的基线策略，因为它从不扭曲成分波幅。\n该陈述是绝对错误的。高通滤波是一种线性时不变操作，它会移除或衰减低于其截止频率的频率分量。虽然它能有效去除缓慢漂移（这是一种低频现象），但它也会扭曲感兴趣信号中任何在阻带内有能量的部分。许多重要的 ERP 成分，如 P300、慢皮层电位和准备电位，其特征是缓慢的电压变化，并且在 $2\\,\\mathrm{Hz}$ 以下有大量能量。应用 $2\\,\\mathrm{Hz}$ 的高通滤波器会严重衰减和扭曲这些成分，可能导致对其波幅和潜伏期的错误结论。没有任何滤波策略是“总是安全的”或“从不扭曲”的；滤波器参数的选择必须根据感兴趣的特定 ERP 成分和噪声的性质来仔细考虑。\n结论：**错误**。",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "除了慢波漂移，ERP基线还经常受到尖锐、高振幅伪迹（如眨眼或肌肉活动）的污染。对基线期简单求平均会使校正结果对这些离群值（outliers）高度敏感。本练习将引入稳健统计学的概念，特别是Huber M估计量，作为样本均值的有力替代方案。你将计算该估计量在存在伪迹时的表现，从而证明其提供更稳定、偏差更小的基线估计的能力。",
            "id": "4202140",
            "problem": "一个实验室使用脑电图技术，在多次视觉刺激试验中记录事件相关电位 (ERP; Event-Related Potential)。在对各试次进行平均之前，每个试次都通过减去一个在 $-200 \\,\\mathrm{ms}$ 到 $0 \\,\\mathrm{ms}$ 的刺激前窗口上计算的基线估计量来进行基线校正。假设采样率足够高，使得基线窗口能产生许多独立样本，并且大样本近似对估计量的期望有效。\n\n设在任何给定试次中的基线样本都独立同分布于一个污染混合模型：样本有 $1 - \\epsilon$ 的概率从高斯分布 $\\mathcal{N}(0, \\sigma^{2})$ 中抽取，有 $\\epsilon$ 的概率是幅值为 $A$ 的离群值（其中 $A \\gg \\sigma$），这模拟了基线内出现的罕见正向伪迹。这种污染是单侧的（正向的）。假设刺激后时间点的测量噪声均值为零，且与基线样本独立。\n\n定义三个从基线窗口计算得到的单试次基线估计量：样本均值、样本中位数，以及一个稳健的 Huber M-估计量，其影响函数为\n$$\n\\psi(x) \\;=\\; \n\\begin{cases}\nx,  |x| \\le c,\\\\\nc\\,\\mathrm{sign}(x),  |x|  c,\n\\end{cases}\n$$\n其中 $c$ 是一个固定阈值。在上述混合模型的大样本极限下，Huber 基线估计量等于求解总体估计方程 $E[\\psi(X - \\theta)] = 0$ 的唯一解 $\\theta$。由于 $A \\gg c$，离群值对 $E[\\psi(X - \\theta)]$ 的贡献饱和于 $+c$。\n\n设在 $t_{0} = 100 \\,\\mathrm{ms}$ 处的潜在真实 ERP 幅值为 $S_{0}$，且在各试次中均相同。经过基线校正（从每个试次中减去基线估计量）和试次平均后，$t_{0}$ 处的期望平均幅值为 $S_{0}$ 减去基线估计量的期望。\n\n给定 $\\epsilon = 0.1$, $\\sigma = 1.5 \\,\\mu\\mathrm{V}$, $A = 12 \\,\\mu\\mathrm{V}$, $c = 2 \\,\\mu\\mathrm{V}$, 以及 $S_{0} = 3.2 \\,\\mu\\mathrm{V}$，当基线估计量为 Huber M-估计量时，使用所述的大样本近似来计算 $t_{0}$ 处的期望平均幅值。最终结果以微伏 ($\\mu\\mathrm{V}$) 表示，并将答案四舍五入至四位有效数字。",
            "solution": "目标是计算在刺激后时间点 $t_{0} = 100 \\,\\mathrm{ms}$ 处的期望平均幅值。该量由 $S_{0} - E[\\text{基线估计量}]$ 给出，其中 $S_{0}$ 是真实的 ERP 幅值，而基线估计量是 Huber M-估计量。问题指明，在大样本极限下，单个试次的估计量收敛于求解估计方程 $E[\\psi(X - \\theta)] = 0$ 的总体值 $\\theta$。对多个试次进行平均后，基线估计量的期望值就是这个总体值 $\\theta$。因此，我们需要计算 $S_{0} - \\theta$。\n\n代表单个基线样本的随机变量 $X$ 服从一个污染混合模型。其分布由下式给出：\n$X \\sim (1 - \\epsilon) \\mathcal{N}(0, \\sigma^{2}) + \\epsilon \\delta_A$\n其中 $\\delta_A$ 是在幅值 $A$ 处的一个点质量。\n\n$\\theta$ 的估计方程为 $E[\\psi(X - \\theta)] = 0$。我们可以使用全期望定律，按混合模型的各个成分展开此期望：\n$$ (1 - \\epsilon) E_{Z \\sim \\mathcal{N}(0, \\sigma^2)}[\\psi(Z - \\theta)] + \\epsilon E_{Y \\sim \\delta_A}[\\psi(Y - \\theta)] = 0 $$\n\n我们来计算第二项，它对应于离群值的贡献。该期望就是函数在点质量 $A$ 处的值：\n$E_{Y \\sim \\delta_A}[\\psi(Y - \\theta)] = \\psi(A - \\theta)$。\n影响函数 $\\psi(x)$ 由下式给出：\n$$\n\\psi(x) \\;=\\; \n\\begin{cases}\nx,  |x| \\le c,\\\\\nc\\,\\mathrm{sign}(x),  |x|  c,\n\\end{cases}\n$$\n给定 $A = 12 \\,\\mu\\mathrm{V}$ 和 $c = 2 \\,\\mu\\mathrm{V}$。真实的基线均值为 $E[X] = (1-\\epsilon)(0) + \\epsilon A = 0.1 \\times 12 = 1.2 \\,\\mu\\mathrm{V}$。Huber M-估计量是稳健的，其值将小于均值，因此我们可以预期 $\\theta$ 是一个小的正值。这确保了 $A - \\theta  c$。因此，$\\psi(A - \\theta) = c \\cdot \\mathrm{sign}(A - \\theta) = c$。\n\n估计方程简化为：\n$$ (1 - \\epsilon) E_{Z \\sim \\mathcal{N}(0, \\sigma^2)}[\\psi(Z - \\theta)] + \\epsilon c = 0 $$\n\n现在我们必须计算高斯分量的期望 $E_{Z \\sim \\mathcal{N}(0, \\sigma^2)}[\\psi(Z - \\theta)]$。设 $\\phi(z; \\mu, \\sigma^2)$ 和 $\\Phi(z; \\mu, \\sigma^2)$ 分别为正态分布的概率密度函数 (PDF) 和累积分布函数 (CDF)。该期望由以下积分给出：\n$$ E[\\psi(Z - \\theta)] = \\int_{-\\infty}^{\\infty} \\psi(z - \\theta) \\phi(z; 0, \\sigma^2) dz $$\n我们根据 $\\psi$ 的定义将积分拆分为：\n$$ E[\\psi(Z - \\theta)] = \\int_{-\\infty}^{\\theta-c} (-c) \\phi(z) dz + \\int_{\\theta-c}^{\\theta+c} (z - \\theta) \\phi(z) dz + \\int_{\\theta+c}^{\\infty} c \\phi(z) dz $$\n为简化计算，我们使用标准正态 PDF $\\phi_{std}(x)$ 和 CDF $\\Phi_{std}(x)$。令 $z' = z/\\sigma$。则 $\\phi(z; 0, \\sigma^2) dz = \\phi_{std}(z') dz'$。该期望可以写为：\n$$ E[\\psi(Z - \\theta)] = \\sigma(\\phi_{std}(\\frac{\\theta-c}{\\sigma}) - \\phi_{std}(\\frac{\\theta+c}{\\sigma})) - \\theta(\\Phi_{std}(\\frac{\\theta+c}{\\sigma}) - \\Phi_{std}(\\frac{\\theta-c}{\\sigma})) + c(1 - \\Phi_{std}(\\frac{\\theta+c}{\\sigma}) - \\Phi_{std}(\\frac{\\theta-c}{\\sigma})) $$\n将此代回完整的估计方程：\n$$ (1-\\epsilon) \\left[ \\sigma(\\phi_{std}(\\tfrac{\\theta-c}{\\sigma}) - \\phi_{std}(\\tfrac{\\theta+c}{\\sigma})) - \\theta(\\Phi_{std}(\\tfrac{\\theta+c}{\\sigma}) - \\Phi_{std}(\\tfrac{\\theta-c}{\\sigma})) + c(1 - \\Phi_{std}(\\tfrac{\\theta+c}{\\sigma}) - \\Phi_{std}(\\tfrac{\\theta-c}{\\sigma})) \\right] + \\epsilon c = 0 $$\n这是一个关于 $\\theta$ 的超越方程，必须通过数值方法求解。我们代入给定值：\n$\\epsilon = 0.1$\n$\\sigma = 1.5 \\,\\mu\\mathrm{V}$\n$c = 2 \\,\\mu\\mathrm{V}$\n\n方程变为：\n$$ (0.9) \\left[ 1.5(\\phi_{std}(\\tfrac{\\theta-2}{1.5}) - \\phi_{std}(\\tfrac{\\theta+2}{1.5})) - \\theta(\\Phi_{std}(\\tfrac{\\theta+2}{1.5}) - \\Phi_{std}(\\tfrac{\\theta-2}{1.5})) + 2(1 - \\Phi_{std}(\\tfrac{\\theta+2}{1.5}) - \\Phi_{std}(\\tfrac{\\theta-2}{1.5})) \\right] + (0.1)(2) = 0 $$\n使用数值求根算法解此关于 $\\theta$ 的方程，得出：\n$$ \\theta \\approx 0.272185 \\,\\mu\\mathrm{V} $$\n这个值表示在给定的伪迹污染模型下，由 Huber M-估计量引入的期望偏差。\n\n最后，我们计算 $t_{0}$ 处的期望平均幅值，即经过此基线偏差校正后的真实信号幅值：\n$$ \\text{期望幅值} = S_{0} - \\theta $$\n代入 $S_{0}$ 和计算出的 $\\theta$ 的值：\n$$ \\text{期望幅值} = 3.2 \\,\\mu\\mathrm{V} - 0.272185 \\,\\mu\\mathrm{V} = 2.927815 \\,\\mu\\mathrm{V} $$\n问题要求将结果四舍五入至四位有效数字。\n$$ 2.927815 \\to 2.928 $$",
            "answer": "$$\n\\boxed{2.928}\n$$"
        }
    ]
}