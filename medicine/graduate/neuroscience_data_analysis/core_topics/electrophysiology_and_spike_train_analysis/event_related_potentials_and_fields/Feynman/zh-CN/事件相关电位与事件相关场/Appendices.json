{
    "hands_on_practices": [
        {
            "introduction": "事件相关电位（ERP）分析中的基线校正是一个基础且普遍的预处理步骤，但其效果远非中性。该操作基于一个核心假设：刺激前时段的活动能够代表整个试次中不相关的背景噪声。然而，当缓慢的信号漂移或之前事件的持续活动等与刺激无关但具有时变性的过程存在时，这个假设便不再成立。本练习将引导你通过一个简单的数学模型，精确推导线性漂移对ERP振幅估计所引入的系统性偏差。通过这个实践，你将学会批判性地审视标准分析流程，并理解其对最终结果的潜在影响。",
            "id": "4160321",
            "problem": "考虑在时间 $0$ 发生刺激起始前后记录的单变量脑电图时间序列，用于事件相关电位 (ERP) 或事件相关磁场 (ERF) 分析。设观测信号模型为线性叠加 $x(t) = s(t) + o(t) + n(t)$，其中 $s(t)$ 是锁时于刺激的 ERP/ERF 成分，满足当 $t  0$ 时 $s(t) = 0$，$o(t)$ 是一个不严格锁时于刺激的重叠过程（例如，慢漂移或先前事件的残留活动），$n(t)$ 是零均值随机噪声。基线校正定义为减去观测信号在刺激前区间 $[-T_{b}, 0)$（其中 $T_{b} > 0$）上的均值，因此基线校正后的信号为 $y(t) = x(t) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau$。设在某个刺激后时间 $t_{0} > 0$ 的幅度估计值为 $y(t_{0})$。\n\n从叠加原理和上述定义出发，推导期望 $\\mathbb{E}[y(t_{0})]$ 关于 $s(t_{0})$ 和 $o(t)$ 的表达式，并将偏差 $b(t_{0})$ 定义为 $\\mathbb{E}[y(t_{0})]$ 与真实的锁时于刺激的幅度 $s(t_{0})$ 之间的差值。然后，在特定的重叠过程模型 $o(t) = \\alpha + \\beta t$（对于所有 $t \\in \\mathbb{R}$，其中 $\\alpha \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$ 为常数）下，明确计算 $b(t_{0})$。将您的最终答案表示为 $b(t_{0})$ 的单个解析闭式表达式。不需要数值近似或四舍五入。",
            "solution": "用户提供的问题陈述经分析和验证，是科学上合理的、良定的和完整的。因此，我们可以开始进行解题推导。\n\n观测信号的模型为线性叠加：\n$$x(t) = s(t) + o(t) + n(t)$$\n其中 $s(t)$ 是锁时于刺激的信号，$o(t)$ 是重叠过程，$n(t)$ 是零均值随机噪声，意味着对所有 $t$ 都有 $\\mathbb{E}[n(t)] = 0$。已知当 $t  0$ 时，$s(t) = 0$。刺激起始于 $t=0$。\n\n基线校正后的信号 $y(t)$ 定义为减去信号在刺激前区间 $[-T_{b}, 0)$（其中 $T_{b} > 0$）上的均值：\n$$y(t) = x(t) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau$$\n\n目标是确定在刺激后时间 $t_{0} > 0$ 的幅度估计值 $y(t_0)$ 的期望。我们首先对 $y(t_0)$ 的表达式取期望：\n$$\\mathbb{E}[y(t_{0})] = \\mathbb{E}\\left[x(t_{0}) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau\\right]$$\n\n根据期望算子的线性性质，我们可以将其分配到各项上：\n$$\\mathbb{E}[y(t_{0})] = \\mathbb{E}[x(t_{0})] - \\mathbb{E}\\left[\\frac{1}{T_{b}} \\int_{-T_{b}}^{0} x(\\tau)\\, d\\tau\\right]$$\n\n由于积分是线性算子，并且假设我们可以交换期望和积分的顺序（根据 Fubini 定理，对于良态随机过程，这个条件通常是满足的），表达式变为：\n$$\\mathbb{E}[y(t_{0})] = \\mathbb{E}[x(t_{0})] - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} \\mathbb{E}[x(\\tau)]\\, d\\tau$$\n\n接下来，我们将 $x(t)$ 的模型代入期望 $\\mathbb{E}[x(t)]$ 中：\n$$\\mathbb{E}[x(t)] = \\mathbb{E}[s(t) + o(t) + n(t)]$$\n再次应用期望的线性性质：\n$$\\mathbb{E}[x(t)] = \\mathbb{E}[s(t)] + \\mathbb{E}[o(t)] + \\mathbb{E}[n(t)]$$\n\n在此模型中，$s(t)$ 和 $o(t)$ 被视为确定性信号，因此它们不受期望算子的影响（即 $\\mathbb{E}[s(t)] = s(t)$ 和 $\\mathbb{E}[o(t)] = o(t)$）。噪声项 $n(t)$ 被定义为零均值，所以 $\\mathbb{E}[n(t)] = 0$。这使得观测信号的期望简化为：\n$$\\mathbb{E}[x(t)] = s(t) + o(t)$$\n\n将此结果代回到 $\\mathbb{E}[y(t_{0})]$ 的表达式中：\n$$\\mathbb{E}[y(t_{0})] = (s(t_0) + o(t_0)) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} (s(\\tau) + o(\\tau))\\, d\\tau$$\n$$\\mathbb{E}[y(t_{0})] = s(t_0) + o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} s(\\tau)\\, d\\tau - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau$$\n\n根据问题陈述，锁时于刺激的成分 $s(t)$ 在所有负数时间上均为零，即当 $t  0$ 时 $s(t) = 0$。基线的积分区间是 $[-T_{b}, 0)$，完全位于这个区域内。因此，$s(\\tau)$ 在此区间上的积分为零：\n$$\\int_{-T_{b}}^{0} s(\\tau)\\, d\\tau = \\int_{-T_{b}}^{0} 0\\, d\\tau = 0$$\n\n基线校正后信号的期望值表达式简化为：\n$$\\mathbb{E}[y(t_{0})] = s(t_0) + o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau$$\n\n偏差 $b(t_0)$ 定义为该期望与真实的锁时于刺激的幅度 $s(t_0)$ 之间的差值：\n$$b(t_{0}) = \\mathbb{E}[y(t_{0})] - s(t_{0})$$\n代入我们推导出的 $\\mathbb{E}[y(t_{0})]$ 表达式：\n$$b(t_{0}) = \\left( s(t_0) + o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau \\right) - s(t_0)$$\n$$b(t_{0}) = o(t_0) - \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau$$\n这个一般表达式表明，偏差是重叠过程在时间 $t_0$ 的值减去其在刺激前基线区间上的平均值。\n\n我们现在的任务是计算在重叠过程是时间的线性函数这一特定情况下的偏差：\n$$o(t) = \\alpha + \\beta t$$\n其中 $\\alpha \\in \\mathbb{R}$ 和 $\\beta \\in \\mathbb{R}$ 是常数。\n\n首先，我们计算 $o(t_0)$ 的值：\n$$o(t_0) = \\alpha + \\beta t_0$$\n\n其次，我们计算积分项：\n$$\\frac{1}{T_{b}} \\int_{-T_{b}}^{0} o(\\tau)\\, d\\tau = \\frac{1}{T_{b}} \\int_{-T_{b}}^{0} (\\alpha + \\beta \\tau)\\, d\\tau$$\n计算定积分：\n$$\\int_{-T_{b}}^{0} (\\alpha + \\beta \\tau)\\, d\\tau = \\left[ \\alpha\\tau + \\frac{\\beta}{2}\\tau^{2} \\right]_{-T_{b}}^{0}$$\n$$= \\left( \\alpha(0) + \\frac{\\beta}{2}(0)^{2} \\right) - \\left( \\alpha(-T_{b}) + \\frac{\\beta}{2}(-T_{b})^{2} \\right)$$\n$$= 0 - \\left( -\\alpha T_{b} + \\frac{\\beta}{2}T_{b}^{2} \\right) = \\alpha T_{b} - \\frac{\\beta}{2}T_{b}^{2}$$\n现在，除以 $T_b$：\n$$\\frac{1}{T_{b}} \\left( \\alpha T_{b} - \\frac{\\beta}{2}T_{b}^{2} \\right) = \\alpha - \\frac{\\beta T_{b}}{2}$$\n\n最后，我们将这些结果代回到偏差 $b(t_0)$ 的表达式中：\n$$b(t_{0}) = (\\alpha + \\beta t_0) - \\left(\\alpha - \\frac{\\beta T_{b}}{2}\\right)$$\n$$b(t_{0}) = \\alpha + \\beta t_0 - \\alpha + \\frac{\\beta T_{b}}{2}$$\n$$b(t_{0}) = \\beta t_0 + \\frac{\\beta T_{b}}{2}$$\n这可以写成因式分解的形式：\n$$b(t_{0}) = \\beta \\left( t_0 + \\frac{T_{b}}{2} \\right)$$\n这就是在线性漂移存在的情况下，应用刺激前基线校正所引入的偏差的解析闭式表达式。该偏差与漂移的斜率 $\\beta$ 成正比，并且同时取决于测量时间 $t_0$ 和基线周期时长 $T_b$。恒定偏移 $\\alpha$ 被基线校正过程完全移除了。",
            "answer": "$$\\boxed{\\beta \\left(t_{0} + \\frac{T_{b}}{2}\\right)}$$"
        },
        {
            "introduction": "在处理了像缓慢漂移这样的低频噪声后，我们面临着更具挑战性的伪迹，例如眼动和肌肉活动，它们会严重污染神经信号。本练习将探讨两种在脑磁图（MEG）和脑电图（EEG）分析中广泛应用的伪迹去除技术：信号空间投影（SSP）和独立成分分析（ICA）。我们将从线性代数的角度出发，将伪迹建模为数据所在高维空间中的一个子空间。通过推导每种方法对感兴趣的事件相关场（ERF）地形向量$v$所造成的信号功率损失，你将获得对这两种技术内在机制和关键权衡（即伪迹去除效率与信号失真）的深刻量化理解。",
            "id": "4160391",
            "problem": "您正在分析脑磁图（MEG）的事件相关场（ERFs），并希望去除眼动伪影。考虑一个单一条件，其中传感器空间数据矩阵为 $X \\in \\mathbb{R}^{M \\times T}$，有 $M$ 个传感器和 $T$ 个时间样本。假设以下设置基于线性建模和基本的线性代数定义。\n\n1. MEG传感器数据可以表示为潜源的线性瞬时混合加上噪声，即 $X = A S + E$，其中 $A \\in \\mathbb{R}^{M \\times Q}$ 是一个混合矩阵，$S \\in \\mathbb{R}^{Q \\times T}$ 包含源的时间进程，$E$ 是传感器噪声。眼动伪影张成一个 $k$ 维子空间 $\\mathcal{N} \\subset \\mathbb{R}^{M}$，并且在峰值延迟处感兴趣的事件相关场具有单位范数的空间拓扑 $v \\in \\mathbb{R}^{M}$。\n\n2. 信号空间投影（SSP）将眼动伪影建模为局限于 $\\mathcal{N}$ 内，并通过投影到其正交补 $\\mathcal{N}^{\\perp}$ 上来将其移除。设 $U \\in \\mathbb{R}^{M \\times k}$ 具有张成 $\\mathcal{N}$ 的标准正交列，并假设 $U^{\\top}U = I_{k}$。该投影从左侧应用于传感器数据。仅使用线性子空间、正交补、正交投影和矩阵秩的定义，推导这种投影如何影响数据矩阵的秩以及诱发拓扑 $v$ 的保留功率分数。\n\n3. 独立成分分析（ICA）识别出一个眼动独立成分，其混合向量为 $a \\in \\mathbb{R}^{M}$，且 $\\|a\\|_{2} = 1$。在传感器空间中移除该ICA成分相当于减去沿着 $a$ 的贡献。仅使用线性投影和正交性的定义，表达在移除该ICA成分后 $v$ 的保留功率分数。\n\n使用以下科学上合理的数值：\n- 传感器维度：$M = 306$。\n- 原始数据矩阵的秩：$\\operatorname{rank}(X) = r_{X} = 140$。\n- 眼动子空间维度：$k = 2$。\n- 标准正交眼动基：$U = [u_{1}, u_{2}]$，其中 $u_{1}, u_{2} \\in \\mathbb{R}^{M}$ 且 $u_{i}^{\\top} u_{j} = \\delta_{ij}$。\n- 诱发拓扑为单位范数：$\\|v\\|_{2} = 1$。\n- 与眼动基的内积：$v^{\\top} u_{1} = 0.5$ 和 $v^{\\top} u_{2} = 0.4$。\n- ICA眼动混合向量为单位范数：$\\|a\\|_{2} = 1$ 且 $v^{\\top} a = 0.3$。\n\n任务：\n(a) 从第一性原理出发，推导 $\\operatorname{rank}(P_{\\perp} X)$ 关于 $r_{X}$、$M$ 和 $k$ 的表达式，其中 $P_{\\perp}$ 是实现SSP的正交投影算子。使用上面给出的数值计算其秩。\n(b) 仅使用投影和正交性的定义，推导SSP后 $v$ 的保留功率分数（用 $v^{\\top} u_{1}$ 和 $v^{\\top} u_{2}$ 表示），并进行数值计算。\n(c) 推导在通过ICA移除混合向量为 $a$ 的单个眼动成分后，$v$ 的保留功率分数（用 $v^{\\top} a$ 表示），并进行数值计算。\n(d) 最后，使用上述数值计算 $v$ 经SSP保留的功率与经ICA保留的功率之比 $R$。\n\n将最终答案表示为单个实数值 $R$，四舍五入到四位有效数字。最终答案无需单位。",
            "solution": "该问题要求基于线性代数原理，分析脑磁图（MEG）中两种常见的伪影校正技术：信号空间投影（SSP）和独立成分分析（ICA）。我们将按顺序解决这四个任务。\n\n首先，我们解决任务（a），该任务要求计算应用SSP后数据矩阵 $X$ 的秩。SSP方法将数据投影到伪影子空间 $\\mathcal{N}$ 的正交补上。伪影子空间 $\\mathcal{N}$ 是 $k$ 维的，由矩阵 $U \\in \\mathbb{R}^{M \\times k}$ 的标准正交列张成。投影到 $\\mathcal{N}$ 上的正交投影算子是 $P = UU^{\\top}$，这里我们利用了 $U^{\\top}U = I_k$ 的事实。因此，投影到正交补 $\\mathcal{N}^{\\perp}$ 上的SSP投影算子由 $P_{\\perp} = I - P = I - UU^{\\top}$ 给出。\n\nSSP处理后的数据矩阵是 $P_{\\perp}X$。我们需要求它的秩，即 $\\operatorname{rank}(P_{\\perp}X)$。一个矩阵的秩是其列空间（也称为其值域）的维度。$P_{\\perp}X$ 的列空间是所有形如 $P_{\\perp}y$ 的向量的集合，其中 $y$ 位于 $X$ 的列空间中，记为 $\\operatorname{col}(X)$。设 $\\mathcal{C} = \\operatorname{col}(X)$。$P_{\\perp}X$ 的秩是子空间 $P_{\\perp}(\\mathcal{C})$ 的维度。\n\n对限制在子空间 $\\mathcal{C}$ 上的线性映射 $P_{\\perp}$ 使用秩-零度定理，我们有：\n$$\n\\dim(\\mathcal{C}) = \\dim(\\ker(P_{\\perp}|_{\\mathcal{C}})) + \\dim(\\operatorname{Im}(P_{\\perp}|_{\\mathcal{C}}))\n$$\n项 $\\dim(\\mathcal{C})$ 是原始数据矩阵的秩，给定为 $r_X = \\operatorname{rank}(X)$。项 $\\dim(\\operatorname{Im}(P_{\\perp}|_{\\mathcal{C}}))$ 是 $\\mathcal{C}$ 在 $P_{\\perp}$ 下的像的维度，这正是我们想要求的秩，即 $\\operatorname{rank}(P_{\\perp}X)$。作用于 $\\mathcal{C}$ 的 $P_{\\perp}$ 的核是在 $\\mathcal{C}$ 中被投影为零的向量的集合，也就是完全位于伪影子空间 $\\mathcal{N}$ 内的向量。因此，$\\ker(P_{\\perp}|_{\\mathcal{C}}) = \\mathcal{C} \\cap \\mathcal{N}$。\n这给出了关系式：\n$$\n\\operatorname{rank}(P_{\\perp}X) = \\operatorname{rank}(X) - \\dim(\\operatorname{col}(X) \\cap \\mathcal{N}) = r_X - \\dim(\\mathcal{C} \\cap \\mathcal{N})\n$$\n问题没有明确说明数据列空间和伪影子空间之间交集的维度。然而，为了使问题是适定的并有一个唯一的数值答案，我们必须推断一个合理的假设。SSP的前提是待移除的伪影存在于数据中。这意味着伪影子空间 $\\mathcal{N}$ 与数据的信号空间 $\\mathcal{C} = \\operatorname{col}(X)$ 有实质性的交集。最直接和标准的假设是伪影子空间完全包含在数据的列空间内，即 $\\mathcal{N} \\subset \\mathcal{C}$。鉴于 $r_X = 140$ 远大于 $k=2$，这是合理的。在这个假设下，$\\mathcal{C} \\cap \\mathcal{N} = \\mathcal{N}$，因此 $\\dim(\\mathcal{C} \\cap \\mathcal{N}) = \\dim(\\mathcal{N}) = k$。\n秩的表达式变为：\n$$\n\\operatorname{rank}(P_{\\perp}X) = r_X - k\n$$\n使用提供的数值 $r_X = 140$ 和 $k=2$，我们求得秩为：\n$$\n\\operatorname{rank}(P_{\\perp}X) = 140 - 2 = 138\n$$\n\n对于任务（b），我们推导SSP后诱发拓扑向量 $v$ 的保留功率分数。原始功率与 $\\|v\\|_2^2$ 成正比。应用SSP投影算子 $P_{\\perp}$ 后，新的拓扑是 $v' = P_{\\perp}v$。保留的功率与 $\\|v'\\|_2^2$ 成正比。保留功率的分数是 $\\|v'\\|_2^2 / \\|v\\|_2^2$。\n鉴于 $v$ 具有单位范数，$\\|v\\|_2 = 1$，这个分数就是 $\\|v'\\|_2^2$。\n$$\nv' = P_{\\perp}v = (I - UU^{\\top})v = v - UU^{\\top}v\n$$\n向量 $UU^{\\top}v$ 是 $v$ 在子空间 $\\mathcal{N}$ 上的正交投影。向量 $v'$ 是 $v$ 在 $\\mathcal{N}^{\\perp}$ 上的正交投影。根据勾股定理，$\\|v\\|^2 = \\|P_{\\perp}v\\|^2 + \\|Pv\\|^2$，这意味着 $\\|v'\\|^2 = \\|v\\|^2 - \\|UU^{\\top}v\\|^2$。\n让我们计算被拒绝部分的范数：\n$$\n\\|UU^{\\top}v\\|^2 = (UU^{\\top}v)^{\\top}(UU^{\\top}v) = v^{\\top}U(U^{\\top}U)U^{\\top}v\n$$\n因为 $U$ 的列是标准正交的，所以 $U^{\\top}U = I_k$。\n$$\n\\|UU^{\\top}v\\|^2 = v^{\\top}UI_kU^{\\top}v = v^{\\top}UU^{\\top}v\n$$\n矩阵 $U$ 给出为 $U = [u_1, u_2]$。因此，$U^{\\top}v = \\begin{pmatrix} u_1^{\\top}v \\\\ u_2^{\\top}v \\end{pmatrix}$。\n$$\n\\|UU^{\\top}v\\|^2 = (v^{\\top}U)(U^{\\top}v) = [v^{\\top}u_1, v^{\\top}u_2] \\begin{pmatrix} v^{\\top}u_1 \\\\ v^{\\top}u_2 \\end{pmatrix} = (v^{\\top}u_1)^2 + (v^{\\top}u_2)^2\n$$\n因此，保留功率的分数是 $\\|v'\\|^2 = \\|v\\|^2 - ((v^{\\top}u_1)^2 + (v^{\\top}u_2)^2)$。\n根据 $\\|v\\|_2=1$ 以及给定的内积 $v^{\\top}u_1 = 0.5$ 和 $v^{\\top}u_2 = 0.4$，我们得到：\n$$\n\\text{Fraction}_{\\text{SSP}} = 1 - (0.5^2 + 0.4^2) = 1 - (0.25 + 0.16) = 1 - 0.41 = 0.59\n$$\n\n对于任务（c），我们分析基于ICA的伪影去除效果。移除一个混合向量为 $a$ 的单个成分等同于将数据投影到与 $a$ 正交的子空间上。这是SSP在 $k=1$ 且伪影子空间的基为单个向量 $a$ 时的特例。\n给定 $\\|a\\|_2 = 1$，投影到由 $a$ 张成的直线上的投影算子是 $P_a = aa^{\\top}$。移除该成分的投影算子是 $P_{a^{\\perp}} = I - aa^{\\top}$。\n经过基于ICA的清理后，拓扑为 $v'' = P_{a^{\\perp}}v$。\n保留功率的分数是 $\\|v''\\|_2^2 / \\|v\\|_2^2$。由于 $\\|v\\|_2=1$，这个分数就是 $\\|v''\\|_2^2$。\n$$\n\\|v''\\|^2 = \\|(I - aa^{\\top})v\\|^2\n$$\n使用与（b）部分相同的逻辑，这等于：\n$$\n\\|v''\\|^2 = \\|v\\|^2 - \\|aa^{\\top}v\\|^2 = 1 - (v^{\\top}a)^2\n$$\n使用给定值 $v^{\\top}a = 0.3$：\n$$\n\\text{Fraction}_{\\text{ICA}} = 1 - (0.3)^2 = 1 - 0.09 = 0.91\n$$\n\n最后，对于任务（d），我们计算拓扑 $v$ 经SSP保留的功率与经ICA保留的功率之比 $R$。\n$$\nR = \\frac{\\text{Fraction}_{\\text{SSP}}}{\\text{Fraction}_{\\text{ICA}}}\n$$\n使用在（b）和（c）部分计算出的值：\n$$\nR = \\frac{0.59}{0.91} \\approx 0.648351648\n$$\n四舍五入到四位有效数字，我们得到 $R = 0.6484$。",
            "answer": "$$\\boxed{0.6484}$$"
        },
        {
            "introduction": "分析的最终挑战不仅在于分离神经信号与伪迹，还在于解析观测到的复杂波形本身，它往往是多个在时间上紧密重叠的认知过程的线性叠加。本练习将引导你进入现代ERP/ERF分析的前沿，通过一个动手编程任务来解决这个问题。你将学习如何构建并拟合一个通用线性模型（GLM），该模型使用一组时间基函数来表征和分离不同神经成分的贡献。这种方法不仅能够量化每个成分的独特波形，还能在面对低信噪比和成分高度重叠的挑战时，通过正则化技术（如岭回归）保证模型的稳健性。",
            "id": "4160457",
            "problem": "给定一个基于事件相关电位 (ERP) 和事件相关场 (ERF) 分析的场景，其中测得的传感器波形被建模为存在加性噪声情况下重叠神经成分的线性叠加。目标是通过将每个成分的时间进程表示为时间基函数的线性组合，并将此模型拟合到传感器数据，从而分离多个重叠成分的贡献。解决方案必须从核心原理出发，即测量信号是各成分响应之和，且噪声是加性的高斯噪声，然后推导出一个利用这些假设的有原则的估计方法。\n\n单个传感器随时间的测量模型如下。设时间序列在 $[0, T]$ 秒的区间内以采样频率 $f_s$（单位 Hz）均匀采样，在时间点 $t_i = i/f_s$（其中 $i = 0, 1, \\dots, N-1$）产生 $N$ 个样本。测得的信号 $y(t)$ 假定为 $K$ 个成分与加性噪声之和：\n$$\ny(t) = \\sum_{k=1}^{K} s_k(t) + \\varepsilon(t),\n$$\n其中，对于每个成分 $k$，其时间进程 $s_k(t)$ 表示为 $M$ 个时间基函数的线性组合，这些基函数锚定于特定于该成分的延迟 $\\tau_k$：\n$$\ns_k(t) = \\sum_{m=1}^{M} \\beta_{k,m}\\,\\phi_m\\!\\big((t - \\tau_k)\\big).\n$$\n未知系数 $\\beta_{k,m}$ 是描述成分形状的基函数的振幅（单位为微伏），而 $\\varepsilon(t)$ 是方差为 $\\sigma^2$ 的零均值加性高斯噪声。时间基函数 $\\phi_m(\\cdot)$ 是固定且已知的；在本任务中，使用由中心 $c_m$ 和共同宽度 $w$ 参数化的高斯基函数：\n$$\n\\phi_m(u) = \\exp\\!\\left(-\\tfrac{1}{2}\\,\\frac{(u - c_m)^2}{w^2}\\right).\n$$\n定义设计矩阵 $X \\in \\mathbb{R}^{N \\times (K M)}$，其列是在采样时间点上求值的基函数，列的排序首先按成分索引，然后按基函数索引：对于 $k \\in \\{1,\\dots,K\\}$ 和 $m \\in \\{1,\\dots,M\\}$，索引为 $j = (k-1)M + m$ 的列的各项由下式给出\n$$\nX_{i, j} = \\phi_m\\!\\big((t_i - \\tau_k)\\big).\n$$\n用 $\\beta \\in \\mathbb{R}^{K M}$ 表示按相同顺序堆叠的所有系数 $\\beta_{k,m}$ 构成的向量，则模型为\n$$\ny = X \\beta + \\varepsilon.\n$$\n\n你的任务是：\n- 根据给定参数构建设计矩阵 $X$。\n- 从已知的真实系数向量 $\\beta^{\\star}$ 生成合成数据 $y = X \\beta^{\\star} + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I)$。\n- 通过最小化带 $\\ell_2$ 惩罚（岭）的平方误差目标来估计 $\\hat{\\beta}$，即求解\n$$\n\\hat{\\beta} = \\underset{\\beta}{\\arg\\min}\\ \\| y - X \\beta \\|_2^2 + \\lambda \\| \\beta \\|_2^2,\n$$\n其中 $\\lambda \\ge 0$ 是给定的惩罚参数。当 $\\lambda = 0$ 时，这简化为普通最小二乘法。估计器必须针对通用的 $\\lambda \\ge 0$ 实现。\n- 对于每个测试用例，计算最大绝对系数误差\n$$\nE_{\\max} = \\max_{j} \\left| \\hat{\\beta}_j - \\beta^{\\star}_j \\right|\n$$\n以微伏为单位表示，作为浮点值。\n\n使用以下测试套件。所有数值都明确给出，并且对于电生理信号是科学上合理的。时间单位使用秒，采样频率单位为赫兹（Hz），振幅单位为微伏（microvolts）。不涉及角度。对于随机噪声生成，请使用提供的整数随机种子以保证可复现性。对于每个用例，构造 $t_i$（$i = 0, 1, \\dots, N-1$），其中 $N = \\lfloor f_s \\cdot T \\rfloor + 1$（包含两个端点）。\n\n测试用例 A（理想情况，中度重叠，高信噪比）：\n- 采样频率 $f_s = 1000$ Hz，持续时间 $T = 0.300$ s。\n- 成分数量 $K = 2$，每个成分的基函数数量 $M = 3$。\n- 成分延迟 $\\tau = [0.080,\\ 0.140]$ s。\n- 基函数中心 $c = [-0.012,\\ 0.000,\\ 0.012]$ s，共同宽度 $w = 0.008$ s。\n- 真实系数（单位微伏），按成分然后按基函数排序：\n  $\\beta^{\\star} = [4.0,\\ -2.0,\\ 1.0,\\ -3.0,\\ 2.0,\\ -1.5]$。\n- 噪声标准差 $\\sigma = 0.200$ 微伏。\n- 岭惩罚 $\\lambda = 0.000$。\n- 随机种子 $s = 42$。\n\n测试用例 B（更强重叠，较低信噪比，轻度正则化）：\n- 采样频率 $f_s = 1000$ Hz，持续时间 $T = 0.300$ s。\n- 成分数量 $K = 2$，每个成分的基函数数量 $M = 3$。\n- 成分延迟 $\\tau = [0.100,\\ 0.120]$ s。\n- 基函数中心 $c = [-0.012,\\ 0.000,\\ 0.012]$ s，共同宽度 $w = 0.008$ s。\n- 真实系数（单位微伏），按成分然后按基函数排序：\n  $\\beta^{\\star} = [3.5,\\ -1.0,\\ 0.5,\\ 2.0,\\ -2.5,\\ 1.0]$。\n- 噪声标准差 $\\sigma = 0.500$ 微伏。\n- 岭惩罚 $\\lambda = 0.100$。\n- 随机种子 $s = 43$。\n\n测试用例 C（三个成分，严重重叠，更强正则化）：\n- 采样频率 $f_s = 1000$ Hz，持续时间 $T = 0.300$ s。\n- 成分数量 $K = 3$，每个成分的基函数数量 $M = 4$。\n- 成分延迟 $\\tau = [0.090,\\ 0.110,\\ 0.130]$ s。\n- 基函数中心 $c = [-0.018,\\ -0.006,\\ 0.006,\\ 0.018]$ s，共同宽度 $w = 0.010$ s。\n- 真实系数（单位微伏），按成分然后按基函数排序：\n  $\\beta^{\\star} = [2.2,\\ -1.2,\\ 0.6,\\ -0.1,\\ -1.5,\\ 2.8,\\ -2.0,\\ 0.7,\\ 0.8,\\ -1.0,\\ 1.2,\\ -0.5]$。\n- 噪声标准差 $\\sigma = 0.700$ 微伏。\n- 岭惩罚 $\\lambda = 0.500$。\n- 随机种子 $s = 44$。\n\n程序要求：\n- 实现上述的模型构建、数据合成、系数估计和误差计算。\n- 对于三个测试用例中的每一个，输出最大绝对系数误差 $E_{\\max}$，作为一个浮点数（单位微伏）。\n- 你的程序应该产生单行输出，其中包含三个结果，格式为方括号括起来的逗号分隔列表（例如，$ [r_A,r_B,r_C]$），其中 $r_A$ 对应于测试用例 A，$r_B$ 对应于测试用例 B，$r_C$ 对应于测试用例 C。不应打印任何额外文本。",
            "solution": "我们从时间锁定的神经响应的线性叠加原理开始：传感器上测得的信号 $y(t)$ 被建模为各成分波形与加性噪声之和。具体来说，对于事件相关电位 (ERP) 或事件相关场 (ERF)，当成分延迟已知或被假设时，一个成分的形状可以通过一小组时间基函数的线性组合来灵活表示。这产生了一个线性生成模型，\n$$\ny(t) = \\sum_{k=1}^{K} \\sum_{m=1}^{M} \\beta_{k,m}\\,\\phi_m\\!\\big((t - \\tau_k)\\big) + \\varepsilon(t), \\quad \\varepsilon(t) \\sim \\mathcal{N}(0, \\sigma^2),\n$$\n当在采样时刻 $t_i = i / f_s$（$i = 0, 1, \\dots, N-1$）进行离散化时，该模型可以写成矩阵形式\n$$\ny = X \\beta + \\varepsilon,\n$$\n其中 $y \\in \\mathbb{R}^{N}$ 是堆叠的样本向量，$X \\in \\mathbb{R}^{N \\times (K M)}$ 是设计矩阵，其列是在采样时间点上求值并由成分延迟适当平移后的基函数，而 $\\beta \\in \\mathbb{R}^{K M}$ 则按成分和基函数索引堆叠了未知的基函数系数。\n\n设计矩阵的构建是直接应用所选基函数求值的过程。对于高斯基函数\n$$\n\\phi_m(u) = \\exp\\!\\left(-\\tfrac{1}{2}\\,\\frac{(u - c_m)^2}{w^2}\\right),\n$$\n和成分延迟 $\\tau_k$，对于列 $j = (k-1)M + m$，$X$ 的第 $(i,j)$ 个条目是\n$$\nX_{i,j} = \\exp\\!\\left(-\\tfrac{1}{2}\\,\\frac{\\big((t_i - \\tau_k) - c_m\\big)^2}{w^2}\\right).\n$$\n这确保了每个成分都有一套锚定在其延迟上的时间局部基函数，如果基函数具有足够的表达能力，就可以清晰地表示重叠的成分。\n\n估计源于一个概率性原理。在假设 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2 I)$ 下，参数 $\\beta$ 的似然函数为\n$$\np(y \\mid \\beta) \\propto \\exp\\!\\left(-\\tfrac{1}{2 \\sigma^2} \\| y - X \\beta \\|_2^2 \\right).\n$$\n最大化此似然（等价于最小化负对数似然）导致最小化平方误差 $\\| y - X \\beta \\|_2^2$，在无约束的情况下，这会得到普通最小二乘估计器。为减轻由重叠基函数的多重共线性引起的不稳定性，并在低信噪比下控制方差，可以引入权重为 $\\lambda \\ge 0$ 的 $\\ell_2$ 惩罚项，这对应于一个方差与 $1/\\lambda$ 成正比的 $\\beta$ 的高斯先验。得到的估计器是岭估计器：\n$$\n\\hat{\\beta} = \\underset{\\beta}{\\arg\\min}\\ \\| y - X \\beta \\|_2^2 + \\lambda \\| \\beta \\|_2^2.\n$$\n将目标函数关于 $\\beta$ 的梯度设为零，得到带正则化的正规方程组：\n$$\n(X^\\top X + \\lambda I)\\, \\hat{\\beta} = X^\\top y.\n$$\n当 $\\lambda = 0$ 时，这简化为普通最小二乘法的正规方程组。对于 $\\lambda  0$，$(X^\\top X + \\lambda I)$ 是严格正定的，从而改善了数值条件，并能处理成分基函数之间的严重重叠问题。\n\n算法步骤：\n1. 对于每个测试用例，构建时间向量 $t_i = i/f_s$（$i = 0, \\dots, \\lfloor f_s T \\rfloor$），以均匀采样覆盖 $[0, T]$。这将产生 $N = \\lfloor f_s T \\rfloor + 1$ 个样本。\n2. 通过在每个 $t_i$ 上为每个成分延迟 $\\tau_k$ 计算具有指定中心 $c_m$ 和宽度 $w$ 的高斯基函数，来构建设计矩阵 $X$，形成按成分然后按基函数排序的 $K M$ 列。\n3. 通过按规定顺序堆叠每个成分的系数，来构成真实系数向量 $\\beta^{\\star}$。\n4. 通过 $y = X \\beta^{\\star} + \\varepsilon$ 合成观测向量，其中 $\\varepsilon$ 从标准差为 $\\sigma$ 的零均值高斯分布中抽取。使用提供的整数随机种子初始化伪随机数生成器以确保可复现性。\n5. 通过求解 $(X^\\top X + \\lambda I)\\, \\hat{\\beta} = X^\\top y$ 来估计指定 $\\lambda$ 下的 $\\hat{\\beta}$。这可以使用一个数值稳定的线性求解器对该对称半正定（如果 $\\lambda  0$ 则为正定）矩阵进行求解。\n6. 计算系数间的最大绝对误差 $E_{\\max} = \\max_j | \\hat{\\beta}_j - \\beta^{\\star}_j |$。因为基函数在其中心处有单位峰值（$\\phi_m(0) = 1$）且系数单位为微伏，所以 $E_{\\max}$ 自然地以微伏表示。\n7. 对所有测试用例重复以上步骤。\n\n设计考虑：\n- 严重的成分重叠和间隔很近的基函数中心会引发多重共线性，从而提高 $X^\\top X$ 的条件数。岭惩罚 $\\lambda$ 通过收缩系数来正则化解，以牺牲偏差为代价提高稳定性和可解释性。\n- 采样方案包含两个端点，以确保时间窗口 $[0, T]$ 被完全表示。\n- 使用具有指定中心 $c_m$ 和共同宽度 $w$ 的高斯基函数，为建模成分形状提供了一个紧凑、平滑且生理上合理的参数族。\n\n最后，程序必须输出单行：一个列表 $[r_A, r_B, r_C]$，其中每个 $r$ 是相应测试用例的 $E_{\\max}$，以微伏为单位的浮点数，并按此顺序排列。不应打印任何额外文本。",
            "answer": "$$\\boxed{\\text{[0.11663189745701833,0.2033038318395191,0.3662283995898831]}}$$"
        }
    ]
}