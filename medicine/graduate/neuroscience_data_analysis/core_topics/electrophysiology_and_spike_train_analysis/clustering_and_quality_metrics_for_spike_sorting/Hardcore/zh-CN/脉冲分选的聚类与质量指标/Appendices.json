{
    "hands_on_practices": [
        {
            "introduction": "评估脉冲分选算法性能最直接的方法是将其输出与“基准”数据进行比较。本练习介绍从混淆矩阵中派生的基本评估指标——精确率和召回率，它们是评估分类性能的基石。掌握这些概念，您将能够量化特定的分选错误，例如“合并”（低精确率）和“分裂”（低召回率）。",
            "id": "4146355",
            "problem": "一个脉冲分选算法产生了三个分选单元，记为 $U_1$、$U_2$ 和 $U_3$。一次同步胞内记录为三个神经元提供了基准标签，记为 $GT_1$、$GT_2$ 和 $GT_3$。每个检测到的脉冲都已匹配到一个基准神经元或被视为未匹配（噪声/背景），得到以下计数：\n\n- 对于 $U_1$：$100$ 个脉冲匹配到 $GT_1$，$45$ 个脉冲匹配到 $GT_2$，$0$ 个脉冲匹配到 $GT_3$，还有 $5$ 个脉冲未匹配。\n- 对于 $U_2$：$5$ 个脉冲匹配到 $GT_1$，$0$ 个脉冲匹配到 $GT_2$，$65$ 个脉冲匹配到 $GT_3$，还有 $0$ 个脉冲未匹配。\n- 对于 $U_3$：$0$ 个脉冲匹配到 $GT_1$，$55$ 个脉冲匹配到 $GT_2$，$5$ 个脉冲匹配到 $GT_3$，还有 $30$ 个脉冲未匹配。\n\n每个神经元的基准脉冲总数如下：$GT_1$ 有 $120$ 个脉冲，$GT_2$ 有 $100$ 个脉冲，$GT_3$ 有 $80$ 个脉冲。\n\n使用脉冲分选质量的标准评估框架：\n- 构建混淆矩阵 $M$，其行由分选单元 $\\{U_1,U_2,U_3\\}$ 索引，列由基准标签 $\\{GT_1,GT_2,GT_3,\\text{未匹配}\\}$ 索引，其中 $\\text{未匹配}$ 表示未匹配的脉冲。\n- 对于每个分选单元 $U_i$，将其主导基准标签确定为其所在行中计数最大的列，并计算相对于该主导标签的单元精度和单元召回率。解释合并（一个分选单元包含来自多个基准神经元的脉冲）和分裂（一个基准神经元的脉冲分布在多个分选单元中）如何影响这些指标。\n\n选择所有正确的陈述：\n\nA. 混淆矩阵 $M$ 中对应于 $U_1$ 的行为 $(100,\\,45,\\,0,\\,5)$，且 $U_1$ 相对于 $GT_1$ 的单元精度和召回率分别为 $100/150$ 和 $100/120$。\n\nB. $GT_3$ 被分裂到 $U_2$ 和 $U_3$ 中，这降低了 $U_2$ 的单元召回率；对于 $U_2$，其相对于 $GT_3$ 的单元精度和召回率分别为 $65/70$ 和 $65/80$。\n\nC. $U_1$ 代表了 $GT_1$ 和 $GT_2$ 的一次合并，因此其相对于 $GT_1$ 的单元精度很高；具体来说，它等于 $100/120$。\n\nD. $U_3$ 相对于 $GT_2$ 的单元召回率为 $55/90$。\n\nE. 综合考虑所有分选单元，$GT_1$ 的总召回率为 $105/120$。",
            "solution": "问题陈述提供了关于一个脉冲分选算法性能的数据，并要求评估几条关于质量指标的陈述。该问题有科学依据，是良定的，且内部一致。\n\n首先，我们通过验证设定和定义必要术语来将问题形式化。\n\n已知条件如下：\n分选单元：$U_1$, $U_2$, $U_3$。\n基准神经元：$GT_1$, $GT_2$, $GT_3$。\n\n每个分选单元匹配和未匹配的脉冲计数如下：\n- 对于 $U_1$：$100$ 个脉冲匹配到 $GT_1$，$45$ 个脉冲匹配到 $GT_2$，$0$ 个脉冲匹配到 $GT_3$，还有 $5$ 个脉冲未匹配。\n- 对于 $U_2$：$5$ 个脉冲匹配到 $GT_1$，$0$ 个脉冲匹配到 $GT_2$，$65$ 个脉冲匹配到 $GT_3$，还有 $0$ 个脉冲未匹配。\n- 对于 $U_3$：$0$ 个脉冲匹配到 $GT_1$，$55$ 个脉冲匹配到 $GT_2$，$5$ 个脉冲匹配到 $GT_3$，还有 $30$ 个脉冲未匹配。\n\n每个神经元的基准脉冲总数如下：\n- $N_{GT_1} = 120$\n- $N_{GT_2} = 100$\n- $N_{GT_3} = 80$\n\n任务是构建混淆矩阵 $M$ 并评估关于单元精度和召回率的陈述。\n\n混淆矩阵 $M$ 的行由分选单元 $\\{U_1, U_2, U_3\\}$ 索引，列由基准标签 $\\{GT_1, GT_2, GT_3, \\text{未匹配}\\}$ 索引。矩阵项 $M_{ij}$ 是单元 $U_i$ 中匹配到基准神经元 $GT_j$ 的脉冲数量。\n\n根据所提供的数据，混淆矩阵 $M$ 为：\n$$ M = \\begin{pmatrix} 100  45  0  5 \\\\ 5  0  65  0 \\\\ 0  55  5  30 \\end{pmatrix} $$\n\n每个分选单元中的脉冲总数是其在 $M$ 中对应行的总和：\n- $U_1$ 中的总脉冲数：$N_{U_1} = 100 + 45 + 0 + 5 = 150$\n- $U_2$ 中的总脉冲数：$N_{U_2} = 5 + 0 + 65 + 0 = 70$\n- $U_3$ 中的总脉冲数：$N_{U_3} = 0 + 55 + 5 + 30 = 90$\n\n对于给定的分选单元 $U_i$，我们将其主导基准标签 $GT_j$ 确定为 $M$ 的第 $i$ 行中计数最高的那个（忽略“未匹配”列）。\n- 对于 $U_1$，主导标签是 $GT_1$ ($100  45$)。\n- 对于 $U_2$，主导标签是 $GT_3$ ($65  5$)。\n- 对于 $U_3$，主导标签是 $GT_2$ ($55  5$)。\n\n现在我们定义一个单元 $U_i$ 相对于其主导基准标签 $GT_j$ 的单元精度和召回率：\n- **精度 (Precision)**：$U_i$ 中正确来自 $GT_j$ 的脉冲所占的比例。\n  $$ \\text{精度}(U_i, GT_j) = \\frac{U_i \\text{ 中来自 } GT_j \\text{ 的脉冲数}}{U_i \\text{ 中的总脉冲数}} = \\frac{M_{ij}}{N_{U_i}} $$\n- **召回率 (Recall)**：$GT_j$ 的所有脉冲中被正确捕获到 $U_i$ 中的比例。\n  $$ \\text{召回率}(U_i, GT_j) = \\frac{U_i \\text{ 中来自 } GT_j \\text{ 的脉冲数}}{\\text{来自 } GT_j \\text{ 的总脉冲数}} = \\frac{M_{ij}}{N_{GT_j}} $$\n\n现在我们评估每个选项。\n\n**A. 混淆矩阵 $M$ 中对应于 $U_1$ 的行为 $(100,\\,45,\\,0,\\,5)$，且 $U_1$ 相对于 $GT_1$ 的单元精度和召回率分别为 $100/150$ 和 $100/120$。**\n根据问题描述，$U_1$ 的行确实是 $(100, 45, 0, 5)$。$U_1$ 的主导基准标签是 $GT_1$。\n- $U_1$ 中的总脉冲数是 $N_{U_1} = 150$。\n- 来自 $GT_1$ 的总脉冲数是 $N_{GT_1} = 120$。\n- $U_1$ 中来自 $GT_1$ 的脉冲数是 $M_{11} = 100$。\n- $U_1$ 相对于 $GT_1$ 的精度是 $\\frac{M_{11}}{N_{U_1}} = \\frac{100}{150}$。\n- $U_1$ 相对于 $GT_1$ 的召回率是 $\\frac{M_{11}}{N_{GT_1}} = \\frac{100}{120}$。\n陈述的两个部分在计算上和概念上都是正确的。来自 $GT_2$ 的 $45$ 个脉冲和 $5$ 个未匹配脉冲的存在降低了精度，这表现为一次“合并”错误。未能捕获 $GT_1$ 的全部 $120$ 个脉冲降低了召回率。\n**结论：正确。**\n\n**B. $GT_3$ 被分裂到 $U_2$ 和 $U_3$ 中，这降低了 $U_2$ 的单元召回率；对于 $U_2$，其相对于 $GT_3$ 的单元精度和召回率分别为 $65/70$ 和 $65/80$。**\n首先，我们检查 $GT_3$ 是否被分裂。\n- $U_2$ 包含 $65$ 个来自 $GT_3$ 的脉冲。\n- $U_3$ 包含 $5$ 个来自 $GT_3$ 的脉冲。\n由于来自单个基准神经元 $GT_3$ 的脉冲出现在多个分选单元中，根据定义，它被“分裂”了。这种分裂，加上任何遗漏的脉冲（为 $GT_3$ 找到的总数是 $65+5=70$，总共有 $80$ 个），意味着没有单个分选单元能捕获 $GT_3$ 的所有脉冲，因此降低了任何相关单元的单元召回率。这个推理是合理的。\n接下来，我们检查 $U_2$ 的计算。$U_2$ 的主导标签是 $GT_3$。\n- $U_2$ 中的总脉冲数是 $N_{U_2} = 70$。\n- 来自 $GT_3$ 的总脉冲数是 $N_{GT_3} = 80$。\n- $U_2$ 中来自 $GT_3$ 的脉冲数是 $M_{23} = 65$。\n- $U_2$ 相对于 $GT_3$ 的精度是 $\\frac{M_{23}}{N_{U_2}} = \\frac{65}{70}$。\n- $U_2$ 相对于 $GT_3$ 的召回率是 $\\frac{M_{23}}{N_{GT_3}} = \\frac{65}{80}$。\n推理和计算值都是正确的。\n**结论：正确。**\n\n**C. $U_1$ 代表了 $GT_1$ 和 $GT_2$ 的一次合并，因此其相对于 $GT_1$ 的单元精度很高；具体来说，它等于 $100/120$。**\n$U_1$ 包含 $100$ 个来自 $GT_1$ 的脉冲和 $45$ 个来自 $GT_2$ 的脉冲。这是一次“合并”。合并错误内在地*降低*了精度，因为精度公式的分母（单元中的总脉冲数）被假阳性（来自其他神经元的脉冲）夸大了。“因此其单元精度…很高”的推理是有缺陷的。此外，该陈述声称精度为 $\\frac{100}{120}$。\n- 根据选项 A 的计算，$U_1$ 相对于 $GT_1$ 的精度是 $\\frac{100}{150}$。\n- 值 $\\frac{100}{120}$ 是召回率，而不是精度。\n该陈述包含有缺陷的推理和不正确的精度值。\n**结论：不正确。**\n\n**D. $U_3$ 相对于 $GT_2$ 的单元召回率为 $55/90$。**\n$U_3$ 的主导基准标签是 $GT_2$。我们计算 $U_3$ 相对于 $GT_2$ 的召回率。\n- 来自 $GT_2$ 的总脉冲数是 $N_{GT_2} = 100$。\n- $U_3$ 中来自 $GT_2$ 的脉冲数是 $M_{32} = 55$。\n- $U_3$ 相对于 $GT_2$ 的召回率是 $\\frac{M_{32}}{N_{GT_2}} = \\frac{55}{100}$。\n该陈述声称召回率是 $\\frac{55}{90}$。我们来分析这个值。$U_3$ 中的总脉冲数是 $N_{U_3} = 90$。因此，$\\frac{55}{90}$ 是 $U_3$ 相对于 $GT_2$ 的*精度*，而不是召回率。该陈述将精度误认为是召回率。\n**结论：不正确。**\n\n**E. 综合考虑所有分选单元，$GT_1$ 的总召回率为 $105/120$。**\n一个基准神经元 $GT_j$ 的总召回率是其在所有分选单元中检测到的脉冲总数除以该神经元的总脉冲数。\n- 在 $U_1$ 中找到的来自 $GT_1$ 的脉冲：$100$。\n- 在 $U_2$ 中找到的来自 $GT_1$ 的脉冲：$5$。\n- 在 $U_3$ 中找到的来自 $GT_1$ 的脉冲：$0$。\n- 算法检测到的来自 $GT_1$ 的总脉冲数 = $100 + 5 + 0 = 105$。\n- 来自 $GT_1$ 的实际总脉冲数是 $N_{GT_1} = 120$。\n- $GT_1$ 的总召回率 = $\\frac{\\text{检测到的 } GT_1 \\text{ 脉冲总数}}{\\text{总 } GT_1 \\text{ 脉冲数}} = \\frac{105}{120}$。\n该陈述是正确的。\n**结论：正确。**\n\n总之，陈述 A、B 和 E 是正确的。",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "除了分类准确性，单个神经单元的质量通常通过其信噪比（$SNR$）来判断，但这依赖于对背景噪声的准确估计。本实践探讨了标准差在面对异常值时的脆弱性，并引入了一种更稳健的替代方法——中位数绝对偏差（MAD），从而突出了鲁棒统计学的一个关键原则。这项练习将使您能够在充满噪声的真实数据中计算出更可靠的质量指标，这是电生理学研究中的一个常见挑战。",
            "id": "4146368",
            "problem": "从细胞外记录中提取的单个单元簇通过信噪比 (SNR) 指标进行评估，以评定其单元质量。假设该单元模板的峰值振幅为 $A = 5\\,\\mu\\mathrm{V}$。SNR 定义为 $\\,\\mathrm{SNR} = A / \\sigma_{n}\\,$，其中 $\\sigma_{n}$ 是同一通道上基线噪声水平的标量估计值。\n\n你有一段很长的基线（无脉冲）噪声，可以用来估计 $\\sigma_{n}$。由于偶尔出现的运动伪影，噪声受到了污染，可以建模为一个对称的双组分混合模型：样本以 $(1-\\varepsilon)$ 的概率从一个均值为零、方差为 $\\sigma^{2}$ 的高斯分布中抽取，并以 $\\varepsilon$ 的概率从一个均值为零、方差更大的 $\\sigma_{o}^{2}$ 的高斯分布中抽取。假设 $\\varepsilon = 0.05$, $\\sigma = 1\\,\\mu\\mathrm{V}$，且 $\\sigma_{o} = 10\\,\\mu\\mathrm{V}$。\n\n考虑两种总体水平的噪声估计量：\n- 标准差估计量 $\\sigma_{\\mathrm{sd}}$，对于该混合模型，其定义为 $\\sigma_{\\mathrm{sd}} = \\sqrt{\\mathbb{E}[X^{2}] - (\\mathbb{E}[X])^{2}}$。\n- 缩放后的中位数绝对偏差 (MAD) 估计量 $\\sigma_{\\mathrm{mad}}$，定义为 $\\sigma_{\\mathrm{mad}} = c \\cdot \\mathrm{median}(|X - \\mathrm{median}(X)|)$，其中 $c = 1/\\Phi^{-1}(0.75) \\approx 1.4826$ 以使其对于标准差为 $\\sigma$ 的零均值高斯分布是 Fisher 一致的，而 $\\Phi$ 是标准正态累积分布函数。对于对称的零均值分布，$\\mathrm{median}(X) = 0$，因此 $\\mathrm{MAD} = \\mathrm{median}(|X|)$。\n\n仅使用上述核心定义，并针对指定的混合模型对总体量进行推理，确定在给定的污染条件下，关于 $\\sigma_{\\mathrm{mad}}$ 相对于 $\\sigma_{\\mathrm{sd}}$ 的相对稳健性以及该单元最终的 SNR 值的陈述中，哪一项最准确。请选择唯一最佳选项。\n\nA. 在宽分量 $5\\%$ 的污染下，总体标准差被扩大至约 $\\sigma_{\\mathrm{sd}} \\approx 2.44\\,\\mu\\mathrm{V}$，得到 $\\mathrm{SNR}_{\\mathrm{sd}} \\approx 2.05$。相比之下，缩放后的 MAD 仅略微变化至约 $\\sigma_{\\mathrm{mad}} \\approx 1.06\\,\\mu\\mathrm{V}$，得到 $\\mathrm{SNR}_{\\mathrm{mad}} \\approx 4.7$，接近未受污染时的值 $A/\\sigma = 5$。这说明了 MAD 相对于标准差对离群值的稳健性。\n\nB. 因为污染是对称且零均值的，所以 $\\sigma_{\\mathrm{sd}}$ 和 $\\sigma_{\\mathrm{mad}}$ 都被放大了大致相同的倍数，因此两个 SNR 估计值都约等于 $\\mathrm{SNR} \\approx 2.05$。\n\nC. 中位数绝对偏差 (MAD) 的崩溃点为 $50\\%$，这意味着即使是 $5\\%$ 的污染也会导致其灾难性失效，低估 $\\sigma_{n}$ 并高估 SNR。\n\nD. 标准差对于任何零均值分布都是无偏的，因此尽管存在离群值，$\\sigma_{\\mathrm{sd}} \\approx 1\\,\\mu\\mathrm{V}$，且两个 SNR 估计值都约等于 $\\mathrm{SNR} \\approx 5$。",
            "solution": "问题陈述已经过评估并被认为是有效的。它在科学上基于信号处理和稳健统计学应用于神经科学的原理，问题提出得当、客观，并包含推导出唯一解所需的所有必要信息。\n\n该问题要求针对一个指定的混合分布，计算两种不同的总体水平噪声尺度估计量 $\\sigma_{\\mathrm{sd}}$ 和 $\\sigma_{\\mathrm{mad}}$，然后比较由此产生的信噪比 (SNR)。\n\n噪声被建模为一个随机变量 $X$，从两种零均值高斯分布的混合体中抽取：\n- 以 $(1-\\varepsilon)$ 的概率从 $X \\sim \\mathcal{N}(0, \\sigma^2)$ 中抽取，其中 $\\sigma = 1\\,\\mu\\mathrm{V}$。\n- 以 $\\varepsilon$ 的概率从 $X \\sim \\mathcal{N}(0, \\sigma_o^2)$ 中抽取，其中 $\\sigma_o = 10\\,\\mu\\mathrm{V}$。\n污染比例为 $\\varepsilon = 0.05$。信号振幅为 $A = 5\\,\\mu\\mathrm{V}$。\n\n**1. 标准差估计量（$\\sigma_{\\mathrm{sd}}$）的计算**\n\n估计量 $\\sigma_{\\mathrm{sd}}$ 是混合分布的总体标准差。其定义为 $\\sigma_{\\mathrm{sd}} = \\sqrt{\\mathbb{E}[X^{2}] - (\\mathbb{E}[X])^{2}}$。\n\n首先，我们计算混合模型的均值 $\\mathbb{E}[X]$。根据全期望定律：\n$$ \\mathbb{E}[X] = (1-\\varepsilon) \\cdot \\mathbb{E}[\\mathcal{N}(0, \\sigma^2)] + \\varepsilon \\cdot \\mathbb{E}[\\mathcal{N}(0, \\sigma_o^2)] = (1-\\varepsilon) \\cdot 0 + \\varepsilon \\cdot 0 = 0 $$\n该混合分布是对称的，均值为 $0$。\n\n接下来，我们计算二阶矩 $\\mathbb{E}[X^2]$。\n$$ \\mathbb{E}[X^2] = (1-\\varepsilon) \\cdot \\mathbb{E}[(\\mathcal{N}(0, \\sigma^2))^2] + \\varepsilon \\cdot \\mathbb{E}[(\\mathcal{N}(0, \\sigma_o^2))^2] $$\n对于一个零均值随机变量，其二阶矩等于其方差。因此，$\\mathbb{E}[(\\mathcal{N}(0, \\sigma^2))^2] = \\sigma^2$ 且 $\\mathbb{E}[(\\mathcal{N}(0, \\sigma_o^2))^2] = \\sigma_o^2$。\n代入给定值：\n$$ \\mathbb{E}[X^2] = (1 - 0.05) \\cdot (1\\,\\mu\\mathrm{V})^2 + 0.05 \\cdot (10\\,\\mu\\mathrm{V})^2 $$\n$$ \\mathbb{E}[X^2] = 0.95 \\cdot 1\\,\\mu\\mathrm{V}^2 + 0.05 \\cdot 100\\,\\mu\\mathrm{V}^2 = 0.95\\,\\mu\\mathrm{V}^2 + 5\\,\\mu\\mathrm{V}^2 = 5.95\\,\\mu\\mathrm{V}^2 $$\n混合模型的方差为 $\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = 5.95 - 0^2 = 5.95\\,\\mu\\mathrm{V}^2$。\n因此，标准差估计量为：\n$$ \\sigma_{\\mathrm{sd}} = \\sqrt{5.95\\,\\mu\\mathrm{V}^2} \\approx 2.4393\\,\\mu\\mathrm{V} $$\n四舍五入到两位小数，我们得到 $\\sigma_{\\mathrm{sd}} \\approx 2.44\\,\\mu\\mathrm{V}$。\n\n使用此估计量计算出的 SNR 为：\n$$ \\mathrm{SNR}_{\\mathrm{sd}} = \\frac{A}{\\sigma_{\\mathrm{sd}}} = \\frac{5\\,\\mu\\mathrm{V}}{2.4393\\,\\mu\\mathrm{V}} \\approx 2.0498 $$\n四舍五入到两位小数，我们得到 $\\mathrm{SNR}_{\\mathrm{sd}} \\approx 2.05$。\n\n**2. 缩放后的MAD估计量（$\\sigma_{\\mathrm{mad}}$）的计算**\n\n估计量 $\\sigma_{\\mathrm{mad}}$ 定义为 $\\sigma_{\\mathrm{mad}} = c \\cdot \\mathrm{median}(|X - \\mathrm{median}(X)|)$，其中 $c \\approx 1.4826$。\n由于混合分布是对称且零均值的，$\\mathrm{median}(X) = 0$。该定义简化为 $\\sigma_{\\mathrm{mad}} = c \\cdot \\mathrm{median}(|X|)$。\n令 $m = \\mathrm{median}(|X|)$。根据定义，$m$ 是满足 $P(|X| \\le m) = 0.5$ 的值。\n$|X|$ 的累积分布函数 (CDF) 是 $F_{|X|}(y) = P(|X| \\le y)$。\n$$ P(|X| \\le y) = (1-\\varepsilon)P(|X_1| \\le y) + \\varepsilon P(|X_2| \\le y) $$\n其中 $X_1 \\sim \\mathcal{N}(0, \\sigma^2)$ 且 $X_2 \\sim \\mathcal{N}(0, \\sigma_o^2)$。\n对于一个变量 $Z \\sim \\mathcal{N}(0,s^2)$，其概率 $P(|Z| \\le y)$ 为 $2\\Phi(y/s) - 1$，其中 $\\Phi$ 是标准正态 CDF。\n我们需要求解 $m$：\n$$ (1-\\varepsilon) \\left(2\\Phi\\left(\\frac{m}{\\sigma}\\right) - 1\\right) + \\varepsilon \\left(2\\Phi\\left(\\frac{m}{\\sigma_o}\\right) - 1\\right) = 0.5 $$\n代入值 $\\varepsilon=0.05$, $\\sigma=1$, $\\sigma_o=10$：\n$$ 0.95 \\left(2\\Phi(m) - 1\\right) + 0.05 \\left(2\\Phi\\left(\\frac{m}{10}\\right) - 1\\right) = 0.5 $$\n这个方程必须通过数值方法求解 $m$。让我们测试一下选项 A 中隐含的值。\n选项 A 提示 $\\sigma_{\\mathrm{mad}} \\approx 1.06\\,\\mu\\mathrm{V}$。这意味着 $m = \\sigma_{\\mathrm{mad}}/c \\approx 1.06 / 1.4826 \\approx 0.715\\,\\mu\\mathrm{V}$。\n让我们检查 $m=0.715$ 是否满足方程：\n$$ 0.95 \\left(2\\Phi(0.715) - 1\\right) + 0.05 \\left(2\\Phi(0.0715) - 1\\right) $$\n使用标准正态分布表或计算器，$\\Phi(0.715) \\approx 0.7627$ 且 $\\Phi(0.0715) \\approx 0.5285$。\n$$ 0.95(2 \\cdot 0.7627 - 1) + 0.05(2 \\cdot 0.5285 - 1) \\approx 0.95(0.5254) + 0.05(0.057) $$\n$$ \\approx 0.49913 + 0.00285 = 0.50198 $$\n这个值非常接近 $0.5$，证实了 $m \\approx 0.715\\,\\mu\\mathrm{V}$ 是 $|X|$ 中位数的一个极佳近似值。\n使用这个中位数，估计量为：\n$$ \\sigma_{\\mathrm{mad}} = c \\cdot m \\approx 1.4826 \\cdot 0.715\\,\\mu\\mathrm{V} \\approx 1.060\\,\\mu\\mathrm{V} $$\n所以，$\\sigma_{\\mathrm{mad}} \\approx 1.06\\,\\mu\\mathrm{V}$ 是正确的。\n\n使用此估计量计算出的 SNR 为：\n$$ \\mathrm{SNR}_{\\mathrm{mad}} = \\frac{A}{\\sigma_{\\mathrm{mad}}} = \\frac{5\\,\\mu\\mathrm{V}}{1.06\\,\\mu\\mathrm{V}} \\approx 4.717 $$\n四舍五入到一位小数，我们得到 $\\mathrm{SNR}_{\\mathrm{mad}} \\approx 4.7$。\n\n作为比较，在未受污染的情况下 ($\\varepsilon=0$)，噪声纯粹是 $\\mathcal{N}(0, \\sigma^2)$ 分布，其中 $\\sigma=1\\,\\mu\\mathrm{V}$。真实的噪声尺度是 $\\sigma_n = 1\\,\\mu\\mathrm{V}$，SNR 将是 $A/\\sigma = 5/1 = 5$。MAD 估计量对于高斯分布是 Fisher 一致的，因此也会得出 $\\sigma_{\\mathrm{mad}} = 1\\,\\mu\\mathrm{V}$。\n污染将 $\\sigma_{\\mathrm{sd}}$ 从 $1\\,\\mu\\mathrm{V}$ 扩大到 $2.44\\,\\mu\\mathrm{V}$ (增长了 $144\\%$)，而它仅将 $\\sigma_{\\mathrm{mad}}$ 从 $1\\,\\mu\\mathrm{V}$ 扩大到 $1.06\\,\\mu\\mathrm{V}$ (增长了 $6\\%$)。\n\n**逐项分析**\n\n**A. 在宽分量 $5\\%$ 的污染下，总体标准差被扩大至约 $\\sigma_{\\mathrm{sd}} \\approx 2.44\\,\\mu\\mathrm{V}$，得到 $\\mathrm{SNR}_{\\mathrm{sd}} \\approx 2.05$。相比之下，缩放后的 MAD 仅略微变化至约 $\\sigma_{\\mathrm{mad}} \\approx 1.06\\,\\mu\\mathrm{V}$，得到 $\\mathrm{SNR}_{\\mathrm{mad}} \\approx 4.7$，接近未受污染时的值 $A/\\sigma = 5$。这说明了 MAD 相对于标准差对离群值的稳健性。**\n- 我们的计算得出 $\\sigma_{\\mathrm{sd}} \\approx 2.44\\,\\mu\\mathrm{V}$ 和 $\\mathrm{SNR}_{\\mathrm{sd}} \\approx 2.05$。这与选项相符。\n- 我们的计算得出 $\\sigma_{\\mathrm{mad}} \\approx 1.06\\,\\mu\\mathrm{V}$ 和 $\\mathrm{SNR}_{\\mathrm{mad}} \\approx 4.7$。这与选项相符。\n- $\\mathrm{SNR}_{\\mathrm{mad}} \\approx 4.7$ 的值确实接近未受污染时的值 $5$，而 $\\mathrm{SNR}_{\\mathrm{sd}} \\approx 2.05$ 则不然。\n- “这证明了 MAD 的稳健性”这一结论是对结果的正确解读。MAD 估计量对这 $5\\%$ 的高方差离群值远不那么敏感。\n- **结论：正确。**\n\n**B. 因为污染是对称且零均值的，所以 $\\sigma_{\\mathrm{sd}}$ 和 $\\sigma_{\\mathrm{mad}}$ 都被放大了大致相同的倍数，因此两个 SNR 估计值都约等于 $\\mathrm{SNR} \\approx 2.05$。**\n- 这在事实上是错误的。我们的计算表明 $\\sigma_{\\mathrm{sd}}$ 被放大了约 $2.44$ 倍，而 $\\sigma_{\\mathrm{mad}}$ 被放大了约 $1.06$ 倍。这些并非“大致相同”。得到的 SNR 值约为 $\\approx 2.05$ 和 $\\approx 4.7$，也大相径庭。污染的对称性并不意味着对不同尺度估计量有相同的影响。\n- **结论：错误。**\n\n**C. 中位数绝对偏差 (MAD) 的崩溃点为 $50\\%$，这意味着即使是 $5\\%$ 的污染也会导致其灾难性失效，低估 $\\sigma_{n}$ 并高估 SNR。**\n- 这种说法误解了崩溃点的含义。$50\\%$ 的崩溃点是可能达到的最高值，表明其具有极强的稳健性。这意味着该估计量可以容忍高达 $50\\%$ 的污染。$5\\%$ 的污染水平远在 MAD 预期表现稳健的范围内，而不是“灾难性地失效”。我们的计算证实了这一点：MAD 的估计值仍然接近理想值。\n- **结论：错误。**\n\n**D. 标准差对于任何零均值分布都是无偏的，因此尽管存在离群值，$\\sigma_{\\mathrm{sd}} \\approx 1\\,\\mu\\mathrm{V}$，且两个 SNR 估计值都约等于 $\\mathrm{SNR} \\approx 5$。**\n- 声称混合模型的总体标准差约为 $\\approx 1\\,\\mu\\mathrm{V}$ 是错误的。我们的计算表明它约为 $\\approx 2.44\\,\\mu\\mathrm{V}$。标准差就其本质而言（基于平方偏差），对离群值高度敏感，因此预期会显著增加。前提是错误的，因此 SNR 约为 $\\approx 5$ 的结论也是错误的。\n- **结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在许多实验中，基准数据是无法获得的，因此需要基于数据内在结构的质量度量。L-ratio 是一种广泛使用的度量标准，它将簇建模为多元高斯分布，从而量化簇的分离程度。它通过计算统计上与该簇接近的簇外脉冲，来估计簇的“污染”程度。这个动手计算练习将加深您对高维特征空间中距离度量的理解，并教会您如何将统计模型转化为实用的质量分数。",
            "id": "4146418",
            "problem": "给定一组用于脉冲聚类质量评估的脉冲波形特征距离和簇统计信息。假设单个候选簇的特征向量由均值为 $\\boldsymbol{\\mu}$、协方差矩阵为 $\\boldsymbol{\\Sigma}_{C}$ 的多元正态分布生成。在此模型下，簇中样本的马氏距离平方 $d^{2}$ 服从自由度为 $p$ 的卡方分布，其中 $p$ 是特征空间的维度，等于 $\\boldsymbol{\\Sigma}_{C}$ 的大小。\n\n您的任务是为每个测试用例计算一个称为L-比率的数值污染可能性代理指标。对于为未分配给该簇的脉冲计算出的一组马氏距离 $\\{d_{i}\\}$，该污染可能性代理指标需要对每个 $d_{i}$ 进行评估，计算在自由度为 $p$ 的卡方分布下，一个真实的簇成员的马氏距离平方大于或等于 $d_{i}^{2}$ 的概率。将所有非簇脉冲的这些概率相加，得到一个量，该量经过分配给该簇的脉冲数量 $N_{\\mathrm{cluster}}$ 归一化后，即为污染可能性代理指标。您必须使用卡方生存函数（累积分布函数（CDF）的补函数）来实现此计算，以确保数值稳定性。\n\n科学假设：\n- 簇特征服从多元正态分布。\n- 真实簇成员的马氏距离平方服从自由度为 $p$ 的卡方分布，其中 $p$ 等于 $\\boldsymbol{\\Sigma}_{C}$ 的维度。\n- 非簇马氏距离 $\\{d_{i}\\}$ 是相对于该簇的均值和协方差 $\\boldsymbol{\\Sigma}_{C}$ 计算的。\n\n对每个测试用例，计算L-比率作为一个实数，并四舍五入到6位小数。不涉及物理单位。最终输出必须将所有测试用例的结果汇总到一行，形式为方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是测试用例 $i$ 的四舍五入后的L-比率。\n\n测试套件：\n- 测试用例 1：\n  - 簇协方差 $\\boldsymbol{\\Sigma}_{C} = \\begin{bmatrix} 1.0  0.0 \\\\ 0.0  0.5 \\end{bmatrix}$。\n  - 非簇马氏距离 $[2.0, 3.0, 5.0]$。\n  - 分配给该簇的脉冲数量 $N_{\\mathrm{cluster}} = 150$。\n- 测试用例 2：\n  - 簇协方差 $\\boldsymbol{\\Sigma}_{C} = \\begin{bmatrix} 1.0  0.2  0.0 \\\\ 0.2  1.5  0.1 \\\\ 0.0  0.1  0.8 \\end{bmatrix}$。\n  - 非簇马氏距离 $[0.1, 0.2, 0.05, 0.3]$。\n  - 分配给该簇的脉冲数量 $N_{\\mathrm{cluster}} = 50$。\n- 测试用例 3：\n  - 簇协方差 $\\boldsymbol{\\Sigma}_{C} = \\begin{bmatrix} 2.0  0.0 \\\\ 0.0  2.0 \\end{bmatrix}$。\n  - 非簇马氏距离 $[10.0, 12.0]$。\n  - 分配给该簇的脉冲数量 $N_{\\mathrm{cluster}} = 200$。\n- 测试用例 4：\n  - 簇协方差 $\\boldsymbol{\\Sigma}_{C} = \\begin{bmatrix} 1.0 \\end{bmatrix}$。\n  - 非簇马氏距离 $[0.0, 10^{-8}]$。\n  - 分配给该簇的脉冲数量 $N_{\\mathrm{cluster}} = 1$。\n\n您的程序应生成单行输出，其中包含四个测试用例的L-比率结果，形式为方括号括起来的逗号分隔列表，每个值四舍五入到6位小数，格式严格为 $[r_1,r_2,r_3,r_4]$。",
            "solution": "问题陈述已经过严格验证，被认为是具有科学依据、提法明确且客观的。它提供了一套完整且一致的定义和数据，用以计算L-比率——这是神经科学数据分析中脉冲聚类领域公认的一个质量度量标准。其基础的统计假设是标准且适用于该背景的。因此，可以推导出一个唯一、稳定且有意义的解。\n\n主要任务是为几个测试用例计算L-比率。L-比率可作为候选脉冲簇污染程度的代理指标。它的定义基于簇特征分布的统计特性。问题假设属于某个给定簇的脉冲的特征向量是来自均值为 $\\boldsymbol{\\mu}$、协方差矩阵为 $\\boldsymbol{\\Sigma}_{C}$ 的多元正态分布的样本。该分布的一个基本性质是，一个真实成员到簇中心的马氏距离平方 $d^2$ 服从自由度为 $p$ 的卡方（$\\chi^2$）分布，其中 $p$ 是特征空间的维度。\n\nL-比率的形式化定义如下：\n$$\nL_{\\text{ratio}} = \\frac{1}{N_{\\text{cluster}}} \\sum_{i} P(\\chi^2_p \\ge d_i^2)\n$$\n在此方程中：\n- $N_{\\text{cluster}}$ 是分配给候选簇的脉冲总数。\n- 求和是针对所有*未*分配给该簇的脉冲。\n- $\\{d_i\\}$ 是这些非簇脉冲的马氏距离集合，该距离是相对于候选簇的均值和协方差计算的。\n- $p$ 是卡方分布的自由度，它等于特征空间的维度，由协方差矩阵 $\\boldsymbol{\\Sigma}_{C}$ 的大小给出。对于一个 $n \\times n$ 的矩阵 $\\boldsymbol{\\Sigma}_{C}$，我们有 $p=n$。\n- $P(\\chi^2_p \\ge d_i^2)$ 是从自由度为 $p$ 的 $\\chi^2$ 分布中随机抽取一个值，该值大于或等于马氏距离平方 $d_i^2$ 的概率。这个概率对应于 $\\chi^2$ 分布的生存函数（SF），即累积分布函数（CDF）的补函数，即 $S(x; p) = 1 - \\text{CDF}(x; p)$。为了获得更好的数值精度，特别是在参数值很大（此时CDF接近1）的情况下，规定直接使用生存函数。\n\n每个测试用例的计算步骤如下：\n\n1.  **确定自由度（$p$）**：从给定的簇协方差矩阵 $\\boldsymbol{\\Sigma}_{C}$ 中提取维度 $p$。如果 $\\boldsymbol{\\Sigma}_{C}$ 是一个 $n \\times n$ 的矩阵，则 $p = n$。\n\n2.  **计算概率**：对于所提供列表中的每个非簇马氏距离 $d_i$，首先计算其平方 $d_i^2$。然后，对该值使用自由度为 $p$ 的卡方生存函数进行评估，$S(d_i^2; p) = P(\\chi^2_p \\ge d_i^2)$。\n\n3.  **求和与归一化**：将上一步计算出的所有概率相加：$\\text{Sum} = \\sum_i S(d_i^2; p)$。\n\n4.  **计算L-比率**：将总和除以簇中的脉冲数量 $N_{\\text{cluster}}$，得到最终的L-比率：$L_{\\text{ratio}} = \\frac{\\text{Sum}}{N_{\\text{cluster}}}$。\n\n5.  **四舍五入**：按要求将计算出的L-比率四舍五入到6位小数。\n\n此过程将应用于四个测试用例中的每一个。\n\n**测试用例 1：**\n- $\\boldsymbol{\\Sigma}_{C}$ 是一个 $2 \\times 2$ 矩阵，因此 $p=2$。\n- 非簇马氏距离为 $[2.0, 3.0, 5.0]$。平方距离为 $[4.0, 9.0, 25.0]$。\n- $N_{\\text{cluster}} = 150$。\n- $L_{\\text{ratio}} = \\frac{1}{150} \\left( P(\\chi^2_2 \\ge 4.0) + P(\\chi^2_2 \\ge 9.0) + P(\\chi^2_2 \\ge 25.0) \\right)$。\n\n**测试用例 2：**\n- $\\boldsymbol{\\Sigma}_{C}$ 是一个 $3 \\times 3$ 矩阵，因此 $p=3$。\n- 非簇马氏距离为 $[0.1, 0.2, 0.05, 0.3]$。平方距离为 $[0.01, 0.04, 0.0025, 0.09]$。\n- $N_{\\text{cluster}} = 50$。\n- $L_{\\text{ratio}} = \\frac{1}{50} \\left( P(\\chi^2_3 \\ge 0.01) + P(\\chi^2_3 \\ge 0.04) + P(\\chi^2_3 \\ge 0.0025) + P(\\chi^2_3 \\ge 0.09) \\right)$。\n\n**测试用例 3：**\n- $\\boldsymbol{\\Sigma}_{C}$ 是一个 $2 \\times 2$ 矩阵，因此 $p=2$。\n- 非簇马氏距离为 $[10.0, 12.0]$。平方距离为 $[100.0, 144.0]$。\n- $N_{\\text{cluster}} = 200$。\n- $L_{\\text{ratio}} = \\frac{1}{200} \\left( P(\\chi^2_2 \\ge 100.0) + P(\\chi^2_2 \\ge 144.0) \\right)$。\n\n**测试用例 4：**\n- $\\boldsymbol{\\Sigma}_{C}$ 是一个 $1 \\times 1$ 矩阵，因此 $p=1$。\n- 非簇马氏距离为 $[0.0, 10^{-8}]$。平方距离为 $[0.0, 10^{-16}]$。\n- $N_{\\text{cluster}} = 1$。\n- $L_{\\text{ratio}} = \\frac{1}{1} \\left( P(\\chi^2_1 \\ge 0.0) + P(\\chi^2_1 \\ge 10^{-16}) \\right)$。注意，对于任何 $p  0$，$P(\\chi^2_p \\ge 0.0) = 1$。\n\n实现将使用数值库来准确评估卡方生存函数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Computes the L-ratio for a set of test cases based on spike sorting statistics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"Sigma_C\": np.array([[1.0, 0.0], [0.0, 0.5]]),\n            \"non_cluster_distances\": np.array([2.0, 3.0, 5.0]),\n            \"N_cluster\": 150\n        },\n        # Test case 2\n        {\n            \"Sigma_C\": np.array([[1.0, 0.2, 0.0], [0.2, 1.5, 0.1], [0.0, 0.1, 0.8]]),\n            \"non_cluster_distances\": np.array([0.1, 0.2, 0.05, 0.3]),\n            \"N_cluster\": 50\n        },\n        # Test case 3\n        {\n            \"Sigma_C\": np.array([[2.0, 0.0], [0.0, 2.0]]),\n            \"non_cluster_distances\": np.array([10.0, 12.0]),\n            \"N_cluster\": 200\n        },\n        # Test case 4\n        {\n            \"Sigma_C\": np.array([[1.0]]),\n            \"non_cluster_distances\": np.array([0.0, 1e-8]),\n            \"N_cluster\": 1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Sigma_C = case[\"Sigma_C\"]\n        non_cluster_distances = case[\"non_cluster_distances\"]\n        N_cluster = case[\"N_cluster\"]\n\n        # The number of degrees of freedom p is the dimensionality of Sigma_C.\n        p = Sigma_C.shape[0]\n\n        # Square the Mahalanobis distances for non-cluster spikes.\n        squared_distances = non_cluster_distances**2\n\n        # For each squared distance, compute the probability P(X = d^2)\n        # using the Chi-Square survival function (1 - CDF).\n        # This is more numerically stable than 1 - cdf(x) for large x.\n        probabilities = chi2.sf(squared_distances, df=p)\n\n        # Sum these probabilities.\n        sum_of_probs = np.sum(probabilities)\n\n        # Normalize by the number of spikes in the cluster to get the L-ratio.\n        l_ratio = sum_of_probs / N_cluster\n\n        # Round the result to 6 decimal places.\n        rounded_l_ratio = round(l_ratio, 6)\n        results.append(rounded_l_ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}