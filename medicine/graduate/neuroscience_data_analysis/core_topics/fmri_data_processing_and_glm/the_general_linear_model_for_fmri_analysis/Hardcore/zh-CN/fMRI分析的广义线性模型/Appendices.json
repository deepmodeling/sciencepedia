{
    "hands_on_practices": [
        {
            "introduction": "设计矩阵 $X$ 是通用线性模型（GLM）的核心，它将我们关于 BOLD 信号的假设具体化。虽然使用标准的血液动力学响应函数（HRF）很常见，但有时我们需要一种更灵活、数据驱动的方法来估计 HRF 的形状，而无需强加先验假设。本练习将指导您实践如何将一个理论模型——有限脉冲响应（FIR）模型——转化为一个具体的 GLM 设计矩阵，这是理解非参数化 fMRI 分析的基础步骤。",
            "id": "4199556",
            "problem": "您正在使用通用线性模型 (GLM) 分析一个单次运行的事件相关功能性磁共振成像 (fMRI) 实验。令 $N$ 表示采集的脑体积数量，并设重复时间 (TR) 在整个运行过程中保持不变。考虑一个任务条件 $c$，其起始时间由定义在索引集 $\\{0,1,\\dots,N-1\\}$ 上的离散时间刺激指示向量 $\\mathbf{s}^{(c)} \\in \\{0,1\\}^{N}$ 编码，其中如果条件 $c$ 的一个起始事件发生在时间索引 $t$ 处，则 $s^{(c)}_{t} = 1$，否则 $s^{(c)}_{t} = 0$。假设一个线性时不变的血流动力学系统，因此预测的血氧水平依赖 (BOLD) 信号由刺激与血流动力学响应函数 (HRF) 的离散时间卷积给出。在一种非参数方法中，将 HRF 近似为一个具有 $L$ 个时间窗的有限脉冲响应 (FIR) 模型，这意味着 HRF 由 $L$ 个未知系数表示，每个系数对应于窗口 $\\{0,1,\\dots,L-1\\}$ 内的一个延迟时间窗。\n\n仅从离散时间卷积的定义和上述的因果、有限支撑的 FIR 假设出发，为条件 $c$ 定义 FIR 模型，并构建相应的、用于非参数化估计 HRF 形状的设计子矩阵 $X^{(c)} \\in \\mathbb{R}^{N \\times L}$。您的构建必须是逐项的，即您必须为 $X^{(c)}$ 的 $(t,\\ell)$ 项提供一个闭式解析表达式，该表达式仅用刺激指示向量 $\\mathbf{s}^{(c)}$ 以及索引 $t \\in \\{0,1,\\dots,N-1\\}$ 和 $\\ell \\in \\{0,1,\\dots,L-1\\}$ 来表示。您可以使用离散时间指示函数 $\\mathbf{1}_{A}$，如果条件 $A$ 成立，其值为 $1$，否则为 $0$。将您的最终答案表示为单个无单位的闭式解析表达式。",
            "solution": "该问题要求为事件相关 fMRI 实验中的单个条件构建设计子矩阵，其中血流动力学响应使用有限脉冲响应 (FIR) 基组进行非参数化建模。该构建必须从第一性原理推导得出，即一个刺激指示向量与一个未知 FIR 滤波器的离散时间卷积。\n\n令 $\\mathbf{y} \\in \\mathbb{R}^{N}$ 为单个体素在 $N$ 个时间点上测得的血氧水平依赖 (BOLD) 信号，由 $t \\in \\{0, 1, \\dots, N-1\\}$ 索引。通用线性模型 (GLM) 假设该信号可以被建模为预测变量的线性组合加上噪声：\n$$ \\mathbf{y} = X \\boldsymbol{\\beta} + \\boldsymbol{\\epsilon} $$\n其中 $X$ 是设计矩阵，$\\boldsymbol{\\beta}$ 是待估计的未知参数向量，$\\boldsymbol{\\epsilon}$ 是残差向量。\n\n我们的目标是构建设计矩阵中对应于单个任务条件 $c$ 的特定部分 $X^{(c)} \\in \\mathbb{R}^{N \\times L}$。相关的参数 $\\boldsymbol{\\beta}^{(c)} \\in \\mathbb{R}^{L}$ 是血流动力学响应函数 (HRF) 的 FIR 模型的未知系数。因此，由条件 $c$ 引起的预测 BOLD 信号由 $\\mathbf{y}_{\\text{pred}}^{(c)} = X^{(c)} \\boldsymbol{\\beta}^{(c)}$ 给出。\n\n问题陈述该系统是线性时不变的 (LTI)。因此，在时间 $t$ 的预测 BOLD 信号，记为 $(y_{\\text{pred}}^{(c)})_t$，是刺激指示向量 $\\mathbf{s}^{(c)}$ 与我们记为 $h$ 的 HRF 的离散时间卷积。卷积定义为：\n$$ (y_{\\text{pred}}^{(c)})_t = (\\mathbf{s}^{(c)} * h)_t = \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} h(t-\\tau) $$\n问题指定了一个用于 HRF 的非参数 FIR 模型。这意味着 HRF 被表示为 $L$ 个时移脉冲的加权和。令未知权重（HRF 在不同时间延迟处的高度）为系数 $\\beta^{(c)}_0, \\beta^{(c)}_1, \\dots, \\beta^{(c)}_{L-1}$。HRF $h(k)$ 是为离散时间延迟 $k$ 定义的。FIR 模型假设 HRF 是因果的，并且具有 $L$ 个时间窗的有限支撑，因此 $h(k)$ 仅在 $k \\in \\{0, 1, \\dots, L-1\\}$ 时非零。我们可以将 HRF 写为：\n$$ h(k) = \\sum_{\\ell=0}^{L-1} \\beta^{(c)}_{\\ell} \\delta(k - \\ell) $$\n其中 $\\delta(m)$ 是离散时间脉冲或克罗内克δ函数，当 $m=0$ 时为 $1$，否则为 $0$。参数 $\\beta^{(c)}_{\\ell}$ 代表 HRF 在刺激后第 $\\ell$ 个时间窗的值。\n\n我们将 $h(k)$ 的这个 FIR 定义代入卷积方程。卷积和中 $h$ 的参数是 $(t-\\tau)$，所以我们用 $(t-\\tau)$ 替换 $k$：\n$$ (y_{\\text{pred}}^{(c)})_t = \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} \\left( \\sum_{\\ell=0}^{L-1} \\beta^{(c)}_{\\ell} \\delta((t-\\tau) - \\ell) \\right) $$\n由于求和是在有限范围内进行的，我们可以交换它们的顺序：\n$$ (y_{\\text{pred}}^{(c)})_t = \\sum_{\\ell=0}^{L-1} \\beta^{(c)}_{\\ell} \\left( \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} \\delta(t - \\tau - \\ell) \\right) $$\n这个表达式现在是未知参数 $\\beta^{(c)}_{\\ell}$ 的线性组合形式。这与 GLM 的结构相匹配。矩阵方程 $\\mathbf{y}_{\\text{pred}}^{(c)} = X^{(c)} \\boldsymbol{\\beta}^{(c)}$ 的第 $t$ 行是：\n$$ (y_{\\text{pred}}^{(c)})_t = \\sum_{\\ell=0}^{L-1} X^{(c)}_{t,\\ell} \\beta^{(c)}_{\\ell} $$\n通过将其与重新排列的卷积方程进行比较，我们可以确定设计子矩阵的项 $X^{(c)}_{t,\\ell}$：\n$$ X^{(c)}_{t,\\ell} = \\sum_{\\tau=0}^{N-1} s^{(c)}_{\\tau} \\delta(t - \\tau - \\ell) $$\n克罗内克δ项 $\\delta(t - \\tau - \\ell)$ 仅当其参数为零时才非零（等于 $1$），即当 $t - \\tau - \\ell = 0$ 时，这意味着 $\\tau = t - \\ell$。对于任何其他 $\\tau$ 值，该项为零。因此，只要 $\\tau = t - \\ell$ 这个值在求和边界 $[0, N-1]$ 内，对 $\\tau$ 的求和就会简化为单个项，在 $\\tau = t - \\ell$ 处求值。\n\n$\\tau$ 的值是 $t-\\ell$。矩阵项的索引是 $t \\in \\{0, 1, \\dots, N-1\\}$ 和 $\\ell \\in \\{0, 1, \\dots, L-1\\}$。\n我们来检查一下 $\\tau=t-\\ell$ 是否在 $s^{(c)}_{\\tau}$ 索引的有效范围内。\n1. 下界：$\\tau \\ge 0 \\implies t-\\ell \\ge 0 \\implies t \\ge \\ell$。\n2. 上界：$\\tau \\le N-1 \\implies t-\\ell \\le N-1$。由于 $t$ 的最大值是 $N-1$ 且 $\\ell$ 的最小值是 $0$，所以 $t-\\ell$ 的最大值是 $(N-1)-0 = N-1$。因此，对于给定的 $t$ 和 $\\ell$ 的范围，条件 $t-\\ell \\le N-1$ 总是满足的。\n\n因此，如果 $t  \\ell$，则 $\\tau = t-\\ell$ 的值为负，落在求和范围之外。在这种情况下，没有 $\\tau \\in [0, N-1]$ 能使δ函数非零，求和结果为 $0$。\n如果 $t \\ge \\ell$，则 $\\tau = t-\\ell$ 的值落在求和范围内。求和简化为单个项 $s^{(c)}_{t-\\ell} \\cdot 1 = s^{(c)}_{t-\\ell}$。\n\n我们可以使用离散时间指示函数 $\\mathbf{1}_{A}$ 来表示这种情形区分，如果条件 $A$ 为真，其值为 $1$，否则为 $0$。非零项的条件是 $t \\ge \\ell$。\n因此，设计子矩阵 $X^{(c)}$ 的第 $t$ 行、第 $\\ell$ 列的项由下式给出：\n$$ X^{(c)}_{t,\\ell} = s^{(c)}_{t-\\ell} \\cdot \\mathbf{1}_{t \\ge \\ell} $$\n这个表达式就是所要求的闭式表示。它通过取刺激指示向量 $\\mathbf{s}^{(c)}$ 并将其向下平移 $\\ell$ 个时间步，在顶部用零填充，来构建设计矩阵的每一列 $\\ell$。这是构建 FIR 设计矩阵的标准方法，而此推导从第一性原理验证了它。",
            "answer": "$$\\boxed{s^{(c)}_{t-\\ell} \\mathbf{1}_{t \\ge \\ell}}$$"
        },
        {
            "introduction": "构建设计矩阵后，正确解释估计出的 $\\beta$ 系数至关重要。然而，这些系数的含义并非一成不变，而是取决于回归量的参数化方式。本练习将通过第一性原理的推导，展示像均值中心化这样一个简单的操作，如何阐明截距项的解释，并改变模型中回归量与截距的正交性，这对于获得稳定且可解释的参数估计至关重要。",
            "id": "4199568",
            "problem": "您正在分析一个单体素预处理后的功能性磁共振成像（fMRI）血氧水平依赖（BOLD）时间序列，该序列采用广义线性模型（GLM）进行建模。设观测到的时间序列为 $y \\in \\mathbb{R}^{T}$，并考虑一个包含一个截距和一个任务回归量 $r \\in \\mathbb{R}^{T}$ 的设计。该回归量是通过将一个二元刺激 $u$ 与一个典范血液动力学响应函数 $h$ 进行卷积而构建的。假设存在均值为零、方差有限的加性噪声 $ \\varepsilon \\in \\mathbb{R}^{T}$，并且适当的预处理已使得误差可以很好地近似为随时间独立同方差。您对同一数据拟合了两个 GLM：\n1. 一个未中心化模型 $y = \\beta_{0}\\mathbf{1} + \\beta_{1} r + \\varepsilon$。\n2. 一个均值中心化模型 $y = \\alpha_{0}\\mathbf{1} + \\alpha_{1} r_{c} + \\varepsilon$，其中 $r_{c} = r - \\bar{r}\\,\\mathbf{1}$ 且 $\\bar{r} = \\frac{1}{T}\\mathbf{1}^{\\top} r$。\n\n从 GLM 和普通最小二乘准则的定义出发，根据基本原理推导对 $r$ 进行均值中心化如何改变系数的解释，并如何影响其与截距的正交结构。具体来说，请展示 $r_{c}$ 与截距 $\\mathbf{1}$ 之间的正交性，并通过令它们的拟合值相等来关联这两个 GLM 的参数化。您的最终任务是，用未中心化系数 $\\beta_{0}$、$\\beta_{1}$ 和均值 $\\bar{r}$ 来表示均值中心化截距系数 $\\alpha_{0}$，并提供一个单一的闭式解析表达式。\n\n最终答案只需报告所要求的关于 $\\alpha_{0}$ 的解析表达式。无需进行数值取整。",
            "solution": "我们从观测时间序列 $y \\in \\mathbb{R}^{T}$ 的广义线性模型（GLM）表示开始：\n$$\ny = X\\beta + \\varepsilon,\n$$\n其中 $X$ 是设计矩阵，$\\beta$ 是回归系数。在未中心化模型中，设计矩阵为 $X = [\\mathbf{1}\\ \\ r]$，参数向量为 $\\beta = \\begin{pmatrix}\\beta_{0} \\\\ \\beta_{1}\\end{pmatrix}$，得到\n$$\ny = \\beta_{0}\\mathbf{1} + \\beta_{1} r + \\varepsilon.\n$$\n在均值中心化模型中，我们定义\n$$\nr_{c} = r - \\bar{r}\\,\\mathbf{1}, \\quad \\text{其中} \\quad \\bar{r} = \\frac{1}{T}\\mathbf{1}^{\\top} r,\n$$\n设计矩阵变为 $X_{c} = [\\mathbf{1}\\ \\ r_{c}]$，参数向量为 $\\alpha = \\begin{pmatrix}\\alpha_{0} \\\\ \\alpha_{1}\\end{pmatrix}$，得到\n$$\ny = \\alpha_{0}\\mathbf{1} + \\alpha_{1} r_{c} + \\varepsilon.\n$$\n\n首先，我们证明均值中心化回归量 $r_{c}$ 与截距 $\\mathbf{1}$ 的正交性。计算其内积：\n$$\n\\mathbf{1}^{\\top} r_{c} = \\mathbf{1}^{\\top}(r - \\bar{r}\\,\\mathbf{1}) = \\mathbf{1}^{\\top} r - \\bar{r}\\,\\mathbf{1}^{\\top}\\mathbf{1}.\n$$\n根据定义，$\\bar{r} = \\frac{1}{T}\\mathbf{1}^{\\top} r$，所以\n$$\n\\mathbf{1}^{\\top} r_{c} = \\mathbf{1}^{\\top} r - \\left(\\frac{1}{T}\\mathbf{1}^{\\top} r\\right) \\cdot T = \\mathbf{1}^{\\top} r - \\mathbf{1}^{\\top} r = 0.\n$$\n因此，在欧几里得内积下，$r_{c}$ 与截距 $\\mathbf{1}$ 正交。这一性质直接影响普通最小二乘法中的正规方程，并简化了对截距的解释。\n\n接下来，我们通过用 $r_{c}$ 表示 $r$ 来关联这两种参数化：\n$$\nr = r_{c} + \\bar{r}\\,\\mathbf{1}.\n$$\n将此代入未中心化模型，以获得用中心化基表示的相同拟合值：\n$$\n\\beta_{0}\\mathbf{1} + \\beta_{1} r\n= \\beta_{0}\\mathbf{1} + \\beta_{1}(r_{c} + \\bar{r}\\,\\mathbf{1})\n= (\\beta_{0} + \\beta_{1}\\bar{r})\\mathbf{1} + \\beta_{1} r_{c}.\n$$\n由于这两个模型描述的是相同的数据并共享相同的误差过程，因此拟合值相等要求公共基向量 $\\mathbf{1}$ 和 $r_{c}$ 的系数相匹配：\n$$\n\\alpha_{0} = \\beta_{0} + \\beta_{1}\\bar{r}, \\quad \\alpha_{1} = \\beta_{1}.\n$$\n\n这种重参数化显示了由均值中心化引起的解释上的变化。在未中心化模型中，$\\beta_{0}$ 是当 $r = 0$ 时 $y$ 的预测值（即回归量幅度为零时的基线），而 $\\beta_{1}$ 则衡量 $r$ 每单位变化时 $y$ 的变化幅度。均值中心化后，正交性质 $\\mathbf{1}^{\\top} r_{c} = 0$ 意味着普通最小二乘法的正规方程将截距与 $r_{c}$ 解耦，从而得到一个等于 $y$ 样本均值的截距估计值：\n$$\n\\alpha_{0} = \\bar{y}, \\quad \\text{其中} \\quad \\bar{y} = \\frac{1}{T}\\mathbf{1}^{\\top} y,\n$$\n这是在中心化设计的标准普通最小二乘解下的结果。相应地，斜率保持不变，即 $\\alpha_{1} = \\beta_{1}$，因为中心化是一种线性重参数化，它不会改变对 $r$ 有贡献的列空间中的方向；它只是改变了截距和回归量之间共享方差的分配。\n\n因此，所要求的用未中心化参数和回归量均值表示的均值中心化截距 $\\alpha_{0}$ 的闭式解析表达式为\n$$\n\\alpha_{0} = \\beta_{0} + \\beta_{1}\\bar{r}.\n$$",
            "answer": "$$\\boxed{\\beta_{0}+\\beta_{1}\\,\\bar{r}}$$"
        },
        {
            "introduction": "在模型参数估计完成后，下一步是进行正式的假设检验。虽然 $t$ 检验适用于单个参数，但在 fMRI 分析中，我们经常需要评估关于多个参数的联合假设，例如，检验一个任务是否在整体上激活了某个体素（即同时检验多个 HRF 基函数的系数）。本练习将引导您完成 F 检验的全过程，从使用对比矩阵定义联合假设，到基于完整模型与简化模型的比较来计算最终的 F 统计量。",
            "id": "4199521",
            "problem": "考虑一个由广义线性模型 (GLM) 建模的单体素功能性磁共振成像 (fMRI) 时间序列，其中观测数据向量为 $y \\in \\mathbb{R}^{T}$，设计矩阵为 $X \\in \\mathbb{R}^{T \\times p}$。GLM 假设 $y = X\\beta + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I_{T})$ 在时间上独立同分布。该体素的设计矩阵 $X$ 包含 $p$ 列：两个与经典血液动力学响应函数进行卷积的任务回归量（第 $1$ 和第 $2$ 列）、一个参数调制器（第 $3$ 列）、一个截距项（第 $4$ 列），以及三个头动伪差回归量（第 $5$ 至第 $7$ 列）。你感兴趣的是检验任务诱发的响应不存在的联合原假设：$H_{0}: \\beta_{1} = 0$ 和 $\\beta_{2} = 0$，其表述为一般线性假设 $C\\beta = 0$。\n\n你的任务是：\n- 构建一个显式的对比矩阵 $C$，用以编码上述 GLM 中的 $H_{0}: \\beta_{1} = 0$ 和 $\\beta_{2} = 0$。\n- 从高斯噪声和普通最小二乘估计的假设出发，推导通过残差平方和之差来比较约束模型（施加 $C\\beta = 0$）与完整模型的 F 统计量。清晰地说明分子和分母的自由度。\n- 使用从此体素的最小二乘拟合中获得的以下科学上合理的值：扫描次数 $T = 240$，回归量数量 $p = 7$，完整模型残差平方和 $\\mathrm{SSE}_{\\mathrm{full}} = 375.4$，以及约束模型残差平方和 $\\mathrm{SSE}_{\\mathrm{rest}} = 401.0$。根据你的推导计算 F 统计量的值。将最终数值四舍五入至四位有效数字。将最终答案表示为无单位的纯数。",
            "solution": "#### 1. 构建对比矩阵 $C$\n\nGLM 由 $y = X\\beta + \\varepsilon$ 给出，其中参数向量 $\\beta$ 是 $\\mathbb{R}^{p}$ 中的一个列向量。给定 $p=7$，参数向量为 $\\beta = [\\beta_1, \\beta_2, \\beta_3, \\beta_4, \\beta_5, \\beta_6, \\beta_7]^T$。$\\beta$ 的分量与指定的设计矩阵 $X$ 的列相对应。\n\n原假设 $H_0$ 是任务诱发的响应不存在，表述为 $\\beta_1 = 0$ 和 $\\beta_2 = 0$。这代表了对参数向量 $\\beta$ 的一组两个同时成立的线性约束。我们需要将其表述为 $C\\beta=0$ 形式的一般线性假设。\n\n矩阵 $C$ 的构建必须使得乘积 $C\\beta$ 产生一个表示原假设中表达式的向量。由于有两个约束，矩阵 $C$ 将有两行。列数必须与 $\\beta$ 的维度（即 $p=7$）相匹配。设 $C$ 的秩为 $q$。\n\n第一个约束是 $\\beta_1 = 0$。这可以写成一个向量与 $\\beta$ 的点积：\n$$1 \\cdot \\beta_1 + 0 \\cdot \\beta_2 + 0 \\cdot \\beta_3 + 0 \\cdot \\beta_4 + 0 \\cdot \\beta_5 + 0 \\cdot \\beta_6 + 0 \\cdot \\beta_7 = 0$$\n这对应于 $C$ 的第一行为 $[1, 0, 0, 0, 0, 0, 0]$。\n\n第二个约束是 $\\beta_2 = 0$。这可以写成：\n$$0 \\cdot \\beta_1 + 1 \\cdot \\beta_2 + 0 \\cdot \\beta_3 + 0 \\cdot \\beta_4 + 0 \\cdot \\beta_5 + 0 \\cdot \\beta_6 + 0 \\cdot \\beta_7 = 0$$\n这对应于 $C$ 的第二行为 $[0, 1, 0, 0, 0, 0, 0]$。\n\n将这两行组合起来，得到对比矩阵 $C$：\n$$C = \\begin{pmatrix} 1  0  0  0  0  0  0 \\\\ 0  1  0  0  0  0  0 \\end{pmatrix}$$\n该矩阵的行是线性无关的，所以其秩为 $q = 2$。\n\n#### 2. F 统计量的推导\n\nF 统计量用于比较一个完整模型与其嵌套的约束模型。约束模型是通过在完整模型 $y = X\\beta + \\varepsilon$ 上施加原假设 $H_0: C\\beta=0$ 得到的。\n\n完整模型有 $p$ 个参数。$\\beta$ 的普通最小二乘 (OLS) 估计是 $\\hat{\\beta} = (X^T X)^{-1} X^T y$。完整模型的残差平方和是：\n$$\\mathrm{SSE}_{\\mathrm{full}} = \\|y - X\\hat{\\beta}\\|^2 = (y - X\\hat{\\beta})^T(y - X\\hat{\\beta})$$\n在误差 $\\varepsilon$ 服从正态分布的假设下，归一化的残差平方和服从卡方分布：\n$$\\frac{\\mathrm{SSE}_{\\mathrm{full}}}{\\sigma^2} \\sim \\chi^2_{T-p}$$\n自由度 $df_2 = T-p$ 是观测次数 $T$ 减去完整模型中的参数数量 $p$。量 $\\hat{\\sigma}^2 = \\frac{\\mathrm{SSE}_{\\mathrm{full}}}{T-p}$ 是误差方差 $\\sigma^2$ 的一个无偏估计量。\n\n约束模型是在由 $H_0: C\\beta=0$ 定义的 $q$ 个线性约束下进行估计的。在这些约束下的 OLS 估计产生一个估计值 $\\hat{\\beta}_{\\mathrm{rest}}$ 和相应的残差平方和 $\\mathrm{SSE}_{\\mathrm{rest}} = \\|y - X\\hat{\\beta}_{\\mathrm{rest}}\\|^2$。根据定义，由于约束模型是完整模型的一个特例，所以 $\\mathrm{SSE}_{\\mathrm{rest}} \\ge \\mathrm{SSE}_{\\mathrm{full}}$。\n\n由约束引起的残差平方和的增加量是 $\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}$。根据线性模型理论的一个标准结果，在原假设下，这个差值在归一化后也服从一个卡方分布，且与 $\\mathrm{SSE}_{\\mathrm{full}}$ 独立。\n$$\\frac{\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}}{\\sigma^2} \\sim \\chi^2_q$$\n自由度 $df_1 = q$ 是施加的线性无关约束的数量，也就是矩阵 $C$ 的秩。\n\nF 统计量定义为两个独立的卡方随机变量分别除以其各自自由度后的比值。\n$$F = \\frac{(\\text{假设的平方和}) / (\\text{假设的自由度})}{(\\text{残差平方和}) / (\\text{残差自由度})}$$\n代入上面推导出的表达式：\n$$F = \\frac{(\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}) / q}{\\mathrm{SSE}_{\\mathrm{full}} / (T-p)}$$\n在原假设 $H_0$ 下，该统计量服从自由度为 $q$ 和 $T-p$ 的 F 分布，记作 $F \\sim F_{q, T-p}$。未知的方差项 $\\sigma^2$ 在比值中被方便地消掉了。\n\n此 F 检验的自由度为：\n-   分子自由度：$df_1 = q = \\mathrm{rank}(C)$。\n-   分母自由度：$df_2 = T - p$。\n\n#### 3. F 统计量的计算\n\n我们已知以下数值：\n-   扫描次数 $T = 240$。\n-   回归量数量 $p = 7$。\n-   约束数量 $q = 2$ (来自 $C$ 的秩)。\n-   完整模型残差平方和 $\\mathrm{SSE}_{\\mathrm{full}} = 375.4$。\n-   约束模型残差平方和 $\\mathrm{SSE}_{\\mathrm{rest}} = 401.0$。\n\n首先，我们确定自由度：\n-   分子自由度：$df_1 = q = 2$。\n-   分母自由度：$df_2 = T - p = 240 - 7 = 233$。\n\n现在，我们将这些值代入 F 统计量的公式：\n$$F = \\frac{(\\mathrm{SSE}_{\\mathrm{rest}} - \\mathrm{SSE}_{\\mathrm{full}}) / q}{\\mathrm{SSE}_{\\mathrm{full}} / (T-p)}$$\n$$F = \\frac{(401.0 - 375.4) / 2}{375.4 / (240 - 7)}$$\n$$F = \\frac{25.6 / 2}{375.4 / 233}$$\n$$F = \\frac{12.8}{1.611158798...}$$\n$$F \\approx 7.944592435...$$\n\n将结果四舍五入至四位有效数字，得到 $7.945$。",
            "answer": "$$\\boxed{7.945}$$"
        }
    ]
}