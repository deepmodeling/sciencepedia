{
    "hands_on_practices": [
        {
            "introduction": "A foundational skill in neuroimaging is understanding the relationship between an image's internal grid structure (voxel indices) and its physical position in scanner space. This exercise guides you through constructing the affine transformation matrix that formally defines this mapping. By mastering this, you will gain insight into how spatial information is encoded in image headers and learn to calculate the Jacobian determinant, a crucial quantity for understanding how transformations affect local volume and for performing advanced analyses like voxel-based morphometry .",
            "id": "4164313",
            "problem": "A functional Magnetic Resonance Imaging (fMRI) volume is stored in the Right–Anterior–Superior (RAS) scanner coordinate orientation, meaning that the scanner coordinate axes $(x,y,z)$ increase toward right, anterior, and superior, respectively. The image grid is indexed by zero-based voxel indices $(i,j,k)$ referencing voxel centers, with dimensions $N_x$, $N_y$, and $N_z$ along the $i$, $j$, and $k$ axes, respectively. The voxel sizes along these axes are $(2,2,3)$ millimeters. There is no rotation between the voxel grid axes and the scanner axes; the $i$-axis aligns with $x$, the $j$-axis aligns with $y$, and the $k$-axis aligns with $z$.\n\nIn co-registration and normalization workflows for neuroscience data analysis, the mapping from voxel index space to scanner coordinate space is represented as a homogeneous coordinate affine transform. The image origin is defined such that the geometric center of the volume (i.e., the voxel with index $\\big((N_x-1)/2,\\,(N_y-1)/2,\\,(N_z-1)/2\\big)$) maps to scanner coordinates $(0,0,0)$.\n\nStarting from the core definitions of RAS orientation, voxel size scaling, and homogeneous coordinates, derive the $4 \\times 4$ affine mapping matrix that converts homogeneous voxel index coordinates $(i,j,k,1)^\\top$ into scanner coordinates $(x,y,z,1)^\\top$. Then, determine the Jacobian determinant of the linear part of this mapping, which quantifies the local differential volume scaling from voxel index space to scanner coordinate space. Express your final answer in $\\mathrm{mm}^3$ per $\\text{index-unit}^3$ as a pure number (do not include units). No numerical image dimensions are required for the Jacobian calculation. No rounding is needed.",
            "solution": "The problem requires the derivation of a $4 \\times 4$ affine transformation matrix that maps voxel indices to physical scanner coordinates, followed by the calculation of the Jacobian determinant of this mapping.\n\nFirst, we establish the relationship between the scanner coordinates $(x,y,z)$ and the voxel indices $(i,j,k)$ using homogeneous coordinates. This relationship is an affine transformation represented by a $4 \\times 4$ matrix $A$.\n\n$$\n\\begin{pmatrix} x \\\\ y \\\\ z \\\\ 1 \\end{pmatrix} = A \\begin{pmatrix} i \\\\ j \\\\ k \\\\ 1 \\end{pmatrix}\n$$\n\nThe matrix $A$ can be written in block form, comprising a $3 \\times 3$ linear transformation matrix $L$ (representing rotation and scaling) and a $3 \\times 1$ translation vector $\\mathbf{t} = (t_x, t_y, t_z)^\\top$:\n\n$$\nA = \\begin{pmatrix}\nL & \\mathbf{t} \\\\\n\\mathbf{0}^\\top & 1\n\\end{pmatrix} =\n\\begin{pmatrix}\nL_{11} & L_{12} & L_{13} & t_x \\\\\nL_{21} & L_{22} & L_{23} & t_y \\\\\nL_{31} & L_{32} & L_{33} & t_z \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\nThe problem statement provides the information needed to determine both $L$ and $\\mathbf{t}$.\n\nThe linear transformation matrix $L$ combines rotation and scaling. The problem states that there is no rotation between the voxel grid axes and the scanner axes, and that the $i$, $j$, and $k$ axes align with the $x$, $y$, and $z$ axes, respectively. This means the rotation component of $L$ is the identity matrix. The scaling component is determined by the voxel sizes, which are given as $(2, 2, 3)$ millimeters. Therefore, the linear transformation matrix $L$ is a diagonal matrix containing the voxel sizes:\n\n$$\nL = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}\n$$\n\nThe transformation from voxel indices to scanner coordinates, excluding translation, is:\n$x_{untranslated} = 2i$\n$y_{untranslated} = 2j$\n$z_{untranslated} = 3k$\n\nNext, we determine the translation vector $\\mathbf{t}$. The problem defines the origin of the mapping such that the geometric center of the image volume maps to the origin of the scanner coordinate system. The voxel index corresponding to the volume's center is given as $\\mathbf{p}_{vox,c} = \\left(\\frac{N_x-1}{2}, \\frac{N_y-1}{2}, \\frac{N_z-1}{2}\\right)$. This point must map to the scanner coordinate origin, $\\mathbf{p}_{scan,c} = (0, 0, 0)$.\n\nThe full affine transformation in non-homogeneous vector form is:\n$$\n\\mathbf{p}_{scan} = L \\mathbf{p}_{vox} + \\mathbf{t}\n$$\nwhere $\\mathbf{p}_{scan} = (x, y, z)^\\top$ and $\\mathbf{p}_{vox} = (i, j, k)^\\top$.\nSubstituting the center point correspondence, we get:\n$$\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = L \\begin{pmatrix} \\frac{N_x-1}{2} \\\\ \\frac{N_y-1}{2} \\\\ \\frac{N_z-1}{2} \\end{pmatrix} + \\mathbf{t}\n$$\nThis allows us to solve for the translation vector $\\mathbf{t}$:\n$$\n\\mathbf{t} = -L \\begin{pmatrix} \\frac{N_x-1}{2} \\\\ \\frac{N_y-1}{2} \\\\ \\frac{N_z-1}{2} \\end{pmatrix} = -\\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} \\frac{N_x-1}{2} \\\\ \\frac{N_y-1}{2} \\\\ \\frac{N_z-1}{2} \\end{pmatrix}\n$$\nPerforming the matrix-vector multiplication yields the components of $\\mathbf{t}$:\n$$\nt_x = -2 \\left( \\frac{N_x-1}{2} \\right) = -(N_x-1)\n$$\n$$\nt_y = -2 \\left( \\frac{N_y-1}{2} \\right) = -(N_y-1)\n$$\n$$\nt_z = -3 \\left( \\frac{N_z-1}{2} \\right)\n$$\nWith both $L$ and $\\mathbf{t}$ determined, the complete $4 \\times 4$ affine mapping matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n2 & 0 & 0 & -(N_x-1) \\\\\n0 & 2 & 0 & -(N_y-1) \\\\\n0 & 0 & 3 & -3\\frac{N_z-1}{2} \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\nThe second part of the task is to find the Jacobian determinant of the linear part of this mapping. The transformation is from the $3$-dimensional voxel index space $(i, j, k)$ to the $3$-dimensional scanner coordinate space $(x, y, z)$. The mapping function $f: \\mathbb{R}^3 \\to \\mathbb{R}^3$ is given by:\n$$\nf(i, j, k) = \\begin{pmatrix} x(i, j, k) \\\\ y(i, j, k) \\\\ z(i, j, k) \\end{pmatrix} = \\begin{pmatrix} 2i - (N_x-1) \\\\ 2j - (N_y-1) \\\\ 3k - 3\\frac{N_z-1}{2} \\end{pmatrix}\n$$\nThe Jacobian matrix, $J$, is the matrix of first-order partial derivatives of this function:\n$$\nJ = \\frac{\\partial(x, y, z)}{\\partial(i, j, k)} = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial i} & \\frac{\\partial x}{\\partial j} & \\frac{\\partial x}{\\partial k} \\\\\n\\frac{\\partial y}{\\partial i} & \\frac{\\partial y}{\\partial j} & \\frac{\\partial y}{\\partial k} \\\\\n\\frac{\\partial z}{\\partial i} & \\frac{\\partial z}{\\partial j} & \\frac{\\partial z}{\\partial k}\n\\end{pmatrix}\n$$\nCalculating these partial derivatives:\n$$\n\\frac{\\partial x}{\\partial i} = 2, \\quad \\frac{\\partial x}{\\partial j} = 0, \\quad \\frac{\\partial x}{\\partial k} = 0\n$$\n$$\n\\frac{\\partial y}{\\partial i} = 0, \\quad \\frac{\\partial y}{\\partial j} = 2, \\quad \\frac{\\partial y}{\\partial k} = 0\n$$\n$$\n\\frac{\\partial z}{\\partial i} = 0, \\quad \\frac{\\partial z}{\\partial j} = 0, \\quad \\frac{\\partial z}{\\partial k} = 3\n$$\nThus, the Jacobian matrix is:\n$$\nJ = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}\n$$\nThis is, as expected for an affine transformation, the same as the linear transformation matrix $L$. The problem asks for the Jacobian determinant of the \"linear part of this mapping\", which is precisely the determinant of this matrix.\nThe determinant of a diagonal matrix is the product of its diagonal elements:\n$$\n\\det(J) = 2 \\times 2 \\times 3 = 12\n$$\nThis value represents the constant volume scaling factor between the voxel index space and the scanner coordinate space. A unit cube in the index space (with volume $1 \\text{ index-unit}^3$) maps to a rectangular cuboid (a voxel) in the scanner space with volume $2 \\, \\mathrm{mm} \\times 2 \\, \\mathrm{mm} \\times 3 \\, \\mathrm{mm} = 12 \\, \\mathrm{mm}^3$. The Jacobian determinant captures this scaling, having units of $\\mathrm{mm}^3 / \\text{index-unit}^3$. The question requires the answer as a pure number.",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "Building on the concept of an image's spatial mapping, this practice addresses the core task of co-registration: aligning two different images, such as a functional EPI and a structural T1 scan. This exercise demonstrates the power of homogeneous coordinates, where composing multiple spatial transformations simplifies to matrix multiplication. You will practice deriving the single transform that maps one image's voxel space to another by combining their individual mappings to a common scanner space, a technique central to building and troubleshooting any fMRI analysis pipeline .",
            "id": "4164312",
            "problem": "Consider functional Magnetic Resonance Imaging (fMRI) Echo Planar Imaging (EPI) and structural T1-weighted imaging (T1) from the same subject. In spatial registration, each image’s voxel coordinates are mapped to its scanner (Right-Anterior-Superior) space by a $4\\times 4$ affine transformation in homogeneous coordinates. Let $\\mathbf{v}_{\\mathrm{EPI}} \\in \\mathbb{R}^{4}$ denote an EPI voxel coordinate in homogeneous form with the last entry equal to $1$, and let $\\mathbf{x}_{\\mathrm{EPI}} \\in \\mathbb{R}^{4}$ denote the corresponding scanner-space coordinate, related by $\\mathbf{x}_{\\mathrm{EPI}} = A_{\\mathrm{EPI}} \\mathbf{v}_{\\mathrm{EPI}}$. Similarly, for T1, let $\\mathbf{x}_{\\mathrm{T1}} = A_{\\mathrm{T1}} \\mathbf{v}_{\\mathrm{T1}}$. The affine matrix $A$ combines rotation, scaling (voxel size), and translation (scanner-space origin). We use homogeneous coordinates so that composition of transforms is represented by matrix multiplication, and inverse mappings are given by matrix inversion.\n\nAssume the following scientifically plausible acquisition geometry:\n- The EPI has isotropic voxel size $2$ millimeters, a rotation of $90^\\circ$ about the $z$-axis, and a translation of $(10,-4,2)$ millimeters in scanner space. Its affine is thus\n$$\nA_{\\mathrm{EPI}} =\n\\begin{pmatrix}\n0 & -2 & 0 & 10 \\\\\n2 & 0 & 0 & -4 \\\\\n0 & 0 & 2 & 2 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\n- The T1 has isotropic voxel size $1$ millimeter, a rotation of $180^\\circ$ about the $z$-axis, and a translation of $(3,5,-1)$ millimeters in scanner space. Its affine is thus\n$$\nA_{\\mathrm{T1}} =\n\\begin{pmatrix}\n-1 & 0 & 0 & 3 \\\\\n0 & -1 & 0 & 5 \\\\\n0 & 0 & 1 & -1 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\nAngles are in degrees, and translations are in millimeters.\n\nStarting from the core definitions of affine mappings in homogeneous coordinates and the physical meaning of their composition and inversion in co-registration, derive the affine transformation that maps an EPI voxel coordinate directly into the T1 voxel space. Then, compute this resulting $4\\times 4$ matrix explicitly. Express the translation components in millimeters. No rounding is required; provide the exact matrix entries.",
            "solution": "The objective is to find the affine transformation matrix, $M$, that maps a coordinate from the EPI's voxel space directly to the T1's voxel space. We are given the affine matrix $A_{\\mathrm{EPI}}$ that maps an EPI voxel coordinate $\\mathbf{v}_{\\mathrm{EPI}}$ to a common scanner space coordinate $\\mathbf{x}$, and the matrix $A_{\\mathrm{T1}}$ that maps a T1 voxel coordinate $\\mathbf{v}_{\\mathrm{T1}}$ to the same scanner space $\\mathbf{x}$.\n\nThe mappings are:\n$$ \\mathbf{x} = A_{\\mathrm{EPI}} \\mathbf{v}_{\\mathrm{EPI}} $$\n$$ \\mathbf{x} = A_{\\mathrm{T1}} \\mathbf{v}_{\\mathrm{T1}} $$\nTo find the transformation from $\\mathbf{v}_{\\mathrm{EPI}}$ to $\\mathbf{v}_{\\mathrm{T1}}$, we first express $\\mathbf{v}_{\\mathrm{T1}}$ in terms of $\\mathbf{x}$ by inverting the second equation:\n$$ \\mathbf{v}_{\\mathrm{T1}} = A_{\\mathrm{T1}}^{-1} \\mathbf{x} $$\nSubstituting the first equation into this gives the direct mapping from $\\mathbf{v}_{\\mathrm{EPI}}$ to $\\mathbf{v}_{\\mathrm{T1}}$:\n$$ \\mathbf{v}_{\\mathrm{T1}} = A_{\\mathrm{T1}}^{-1} \\left( A_{\\mathrm{EPI}} \\mathbf{v}_{\\mathrm{EPI}} \\right) = \\left( A_{\\mathrm{T1}}^{-1} A_{\\mathrm{EPI}} \\right) \\mathbf{v}_{\\mathrm{EPI}} $$\nThe desired transformation matrix is therefore the product $M = A_{\\mathrm{T1}}^{-1} A_{\\mathrm{EPI}}$.\n\nThe derivation proceeds in two steps: first, calculating $A_{\\mathrm{T1}}^{-1}$, and second, multiplying it by $A_{\\mathrm{EPI}}$.\n\nAn affine transformation matrix of the block form $A = \\begin{pmatrix} R & t \\\\ \\mathbf{0}^\\top & 1 \\end{pmatrix}$, where $R$ is a $3 \\times 3$ rotation-and-scaling matrix and $t$ is a $3 \\times 1$ translation vector, has an inverse given by $A^{-1} = \\begin{pmatrix} R^{-1} & -R^{-1}t \\\\ \\mathbf{0}^\\top & 1 \\end{pmatrix}$.\n\nThe given matrix $A_{\\mathrm{T1}}$ is:\n$$ A_{\\mathrm{T1}} = \\begin{pmatrix} -1 & 0 & 0 & 3 \\\\ 0 & -1 & 0 & 5 \\\\ 0 & 0 & 1 & -1 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\nThe rotation-scaling part is $R_{\\mathrm{T1}} = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$ and the translation part is $t_{\\mathrm{T1}} = \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix}$.\n\nThe inverse of $R_{\\mathrm{T1}}$, which is a diagonal matrix, is found by taking the reciprocal of each diagonal element:\n$$ R_{\\mathrm{T1}}^{-1} = \\begin{pmatrix} (-1)^{-1} & 0 & 0 \\\\ 0 & (-1)^{-1} & 0 \\\\ 0 & 0 & 1^{-1} \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nNext, we calculate the translation component of the inverse matrix, $-R_{\\mathrm{T1}}^{-1}t_{\\mathrm{T1}}$:\n$$ -R_{\\mathrm{T1}}^{-1}t_{\\mathrm{T1}} = - \\begin{pmatrix} -1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 5 \\\\ -1 \\end{pmatrix} = - \\begin{pmatrix} -3 \\\\ -5 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 5 \\\\ 1 \\end{pmatrix} $$\nAssembling these parts, we find the inverse of $A_{\\mathrm{T1}}$:\n$$ A_{\\mathrm{T1}}^{-1} = \\begin{pmatrix} -1 & 0 & 0 & 3 \\\\ 0 & -1 & 0 & 5 \\\\ 0 & 0 & 1 & 1 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\n\nNow, we compute the final matrix $M = A_{\\mathrm{T1}}^{-1} A_{\\mathrm{EPI}}$:\n$$ M = \\begin{pmatrix} -1 & 0 & 0 & 3 \\\\ 0 & -1 & 0 & 5 \\\\ 0 & 0 & 1 & 1 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & -2 & 0 & 10 \\\\ 2 & 0 & 0 & -4 \\\\ 0 & 0 & 2 & 2 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\nPerforming the matrix multiplication yields:\n$$ M = \\begin{pmatrix} \n(-1)(0) + (0)(2) + (0)(0) + (3)(0) & (-1)(-2) + (0)(0) + (0)(0) + (3)(0) & (-1)(0) + (0)(0) + (0)(2) + (3)(0) & (-1)(10) + (0)(-4) + (0)(2) + (3)(1) \\\\\n(0)(0) + (-1)(2) + (0)(0) + (5)(0) & (0)(-2) + (-1)(0) + (0)(0) + (5)(0) & (0)(0) + (-1)(0) + (0)(2) + (5)(0) & (0)(10) + (-1)(-4) + (0)(2) + (5)(1) \\\\\n(0)(0) + (0)(2) + (1)(0) + (1)(0) & (0)(-2) + (0)(0) + (1)(0) + (1)(0) & (0)(0) + (0)(0) + (1)(2) + (1)(0) & (0)(10) + (0)(-4) + (1)(2) + (1)(1) \\\\\n0 & 0 & 0 & 1 \n\\end{pmatrix} $$\n$$ M = \\begin{pmatrix} \n0 & 2 & 0 & -10+3 \\\\\n-2 & 0 & 0 & 4+5 \\\\\n0 & 0 & 2 & 2+1 \\\\\n0 & 0 & 0 & 1 \n\\end{pmatrix} = \\begin{pmatrix} \n0 & 2 & 0 & -7 \\\\\n-2 & 0 & 0 & 9 \\\\\n0 & 0 & 2 & 3 \\\\\n0 & 0 & 0 & 1 \n\\end{pmatrix} $$\nThe resulting matrix $M$ maps coordinates from the EPI voxel grid to the T1 voxel grid. Its translation components, $\\begin{pmatrix} -7 & 9 & 3 \\end{pmatrix}^\\top$, are in units of T1 voxels. Since the T1 image has an isotropic voxel size of $1$ millimeter, a translation of $1$ T1 voxel is equivalent to a translation of $1$ millimeter. Therefore, the translation components expressed in millimeters are $(-7, 9, 3)$ millimeters.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \n0 & 2 & 0 & -7 \\\\\n-2 & 0 & 0 & 9 \\\\\n0 & 0 & 2 & 3 \\\\\n0 & 0 & 0 & 1 \n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Applying a spatial transformation requires resampling the image onto a new grid, a process that inevitably alters the data. This exercise moves from the pure geometry of transformations to quantifying their practical impact on image quality, specifically the blurring introduced by interpolation. By modeling interpolation as a convolution and using the principle of variance addition, you will quantify the cumulative smoothing from repeated resampling steps, providing a rigorous justification for a critical best practice in fMRI analysis: always concatenate transforms to perform only a single resampling, thereby preserving the spatial precision of your data .",
            "id": "4164263",
            "problem": "A synthetic three-dimensional isotropic Gaussian blob is used to benchmark spatial registration in functional Magnetic Resonance Imaging (fMRI). The blob has an initial isotropic Full Width at Half Maximum (FWHM) of $\\mathrm{FWHM}_0 = 6$ mm and is sampled on an isotropic grid with voxel size $v = 2$ mm. A processing pipeline applies $n = 4$ successive rigid-body resampling operations due to co-registration and normalization, each implemented with trilinear interpolation. Treat trilinear interpolation as separable linear interpolation along each axis using the one-dimensional basis function $h(x) = \\max(1 - |x|, 0)$ defined in voxel units. Quantify the expected blurring introduced by these resampling steps as the increase in FWHM relative to the initial blob, using an equivalent Gaussian model that matches second moments (variances).\n\nStart from the following foundational facts:\n- A unit-integral, even kernel $k(x)$ with zero mean has variance $\\sigma_{k}^{2} = \\int_{-\\infty}^{\\infty} x^{2} k(x) \\, dx$.\n- For unit-integral kernels, the variance of the convolution equals the sum of variances along each axis.\n- For a Gaussian with standard deviation $\\sigma$, the Full Width at Half Maximum (FWHM) is $\\mathrm{FWHM} = 2 \\sqrt{2 \\ln 2} \\, \\sigma$.\n\nAssume isotropy and independence across axes, and model the net effect of repeated trilinear resampling as successive convolutions by $h(x)$ along each axis. Derive the expected increase in FWHM after $n$ resamplings in millimeters and compute its value for the given parameters. Round your final numeric answer to four significant figures and express it in millimeters (mm).",
            "solution": "The synthetic blob is initially Gaussian and isotropic, with initial Full Width at Half Maximum (FWHM) $\\mathrm{FWHM}_0 = 6$ mm. The Gaussian standard deviation $\\sigma_0$ that corresponds to $\\mathrm{FWHM}_0$ is obtained from the well-known relation between Gaussian standard deviation and Full Width at Half Maximum (FWHM), namely\n$$\n\\mathrm{FWHM} = 2 \\sqrt{2 \\ln 2} \\, \\sigma.\n$$\nThus,\n$$\n\\sigma_0 = \\frac{\\mathrm{FWHM}_0}{2 \\sqrt{2 \\ln 2}} \\quad \\text{and} \\quad \\sigma_0^{2} = \\frac{\\mathrm{FWHM}_0^{2}}{8 \\ln 2}.\n$$\nWith $\\mathrm{FWHM}_0 = 6$ mm, we obtain\n$$\n\\sigma_0^{2} = \\frac{36}{8 \\ln 2} = \\frac{9}{2 \\ln 2}.\n$$\n\nEach trilinear resampling is separable and corresponds in one dimension to convolution with the triangular kernel\n$$\nh(x) = \\max(1 - |x|, 0),\n$$\ndefined in voxel units. This kernel is even, has unit integral, and zero mean. Its variance in one dimension is\n$$\n\\sigma_{h}^{2} = \\int_{-1}^{1} x^{2} (1 - |x|) \\, dx = 2 \\int_{0}^{1} x^{2} (1 - x) \\, dx = 2 \\left( \\int_{0}^{1} x^{2} \\, dx - \\int_{0}^{1} x^{3} \\, dx \\right) = 2 \\left( \\frac{1}{3} - \\frac{1}{4} \\right) = \\frac{1}{6}.\n$$\nSince voxels have size $v = 2$ mm, converting from voxel units to millimeters gives one-dimensional variance per resampling step\n$$\n\\sigma_{h,\\mathrm{mm}}^{2} = v^{2} \\, \\sigma_{h}^{2} = v^{2} \\cdot \\frac{1}{6} = \\frac{v^{2}}{6}.\n$$\nFor $v = 2$ mm, this equals\n$$\n\\sigma_{h,\\mathrm{mm}}^{2} = \\frac{4}{6} = \\frac{2}{3}.\n$$\n\nBy the variance-addition property of convolution for unit-integral kernels, after $n$ independent resampling steps the effective one-dimensional variance becomes\n$$\n\\sigma_{\\mathrm{eff}}^{2} = \\sigma_0^{2} + n \\, \\sigma_{h,\\mathrm{mm}}^{2} = \\frac{9}{2 \\ln 2} + n \\cdot \\frac{2}{3}.\n$$\nWith $n = 4$,\n$$\n\\sigma_{\\mathrm{eff}}^{2} = \\frac{9}{2 \\ln 2} + \\frac{8}{3}.\n$$\nTherefore, the effective standard deviation is\n$$\n\\sigma_{\\mathrm{eff}} = \\sqrt{\\frac{9}{2 \\ln 2} + \\frac{8}{3}}.\n$$\nThe effective Full Width at Half Maximum (FWHM) is\n$$\n\\mathrm{FWHM}_{\\mathrm{eff}} = 2 \\sqrt{2 \\ln 2} \\, \\sigma_{\\mathrm{eff}},\n$$\nand the increase in FWHM due to resampling (i.e., the expected blurring introduced) is\n$$\n\\Delta \\mathrm{FWHM} = \\mathrm{FWHM}_{\\mathrm{eff}} - \\mathrm{FWHM}_0 = 2 \\sqrt{2 \\ln 2} \\left( \\sqrt{\\frac{9}{2 \\ln 2} + \\frac{8}{3}} - \\sqrt{\\frac{9}{2 \\ln 2}} \\right).\n$$\n\nNow compute the numeric value. Using $\\ln 2 \\approx 0.6931471805599453$, we have\n$$\n\\frac{9}{2 \\ln 2} \\approx 6.492127684000335, \\quad \\frac{8}{3} \\approx 2.6666666666666665,\n$$\nso\n$$\n\\sigma_{\\mathrm{eff}}^{2} \\approx 9.1587943506670015, \\quad \\sigma_{\\mathrm{eff}} \\approx 3.02635,\n$$\nand\n$$\n\\sigma_0 = \\sqrt{\\frac{9}{2 \\ln 2}} \\approx 2.5479654.\n$$\nThus\n$$\n\\Delta \\mathrm{FWHM} = 2 \\sqrt{2 \\ln 2} \\, (\\sigma_{\\mathrm{eff}} - \\sigma_0) \\approx 2.354820045 \\times (3.02635 - 2.5479654) \\approx 2.354820045 \\times 0.4783846 \\approx 1.12651 \\text{ mm}.\n$$\nRounded to four significant figures, the expected increase in Full Width at Half Maximum is\n$$\n1.127 \\text{ mm}.\n$$\n\nTo justify minimizing resampling steps, note that the increase in variance per axis is linear in $n$:\n$$\n\\sigma_{\\mathrm{eff}}^{2} = \\sigma_0^{2} + n \\cdot \\frac{v^{2}}{6},\n$$\nso\n$$\n\\frac{\\partial}{\\partial n} \\Delta \\mathrm{FWHM} = \\frac{\\partial}{\\partial n} \\left[ 2 \\sqrt{2 \\ln 2} \\left( \\sqrt{\\sigma_0^{2} + n \\cdot \\frac{v^{2}}{6}} - \\sigma_0 \\right) \\right] = \\frac{2 \\sqrt{2 \\ln 2}}{2 \\sqrt{\\sigma_0^{2} + n \\cdot \\frac{v^{2}}{6}}} \\cdot \\frac{v^{2}}{6} > 0,\n$$\nwhich shows $\\Delta \\mathrm{FWHM}$ increases monotonically with $n$. Therefore, combining transformations to reduce the number of resampling steps in co-registration and normalization minimizes cumulative blurring, preserving spatial resolution.",
            "answer": "$$\\boxed{1.127}$$"
        }
    ]
}