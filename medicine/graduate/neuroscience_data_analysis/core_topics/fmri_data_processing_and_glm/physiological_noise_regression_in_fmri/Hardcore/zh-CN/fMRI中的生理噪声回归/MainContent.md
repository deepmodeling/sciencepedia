## 引言
功能性磁共振成像（fMRI）已成为探索人脑功能的强大工具，但其测量的血氧水平依赖（BOLD）信号却极易受到非神经源性波动的污染。在这些污染源中，由心跳、呼吸等自主生理过程引起的生理噪声，是最主要且最复杂的混淆因素。这些噪声不仅会降低数据[信噪比](@entry_id:271861)，削弱[统计功效](@entry_id:197129)，更有可能引入系统性的伪影，导致对大脑激活和连接模式的错误解读。因此，准确地识别并校正生理噪声，是确保fMRI研究结论可靠性的关键一步。

本文旨在为研究者提供一个关于[fMRI生理噪声](@entry_id:1125178)回归的全面指南，系统性地阐述从基础原理到前沿应用的完整知识体系。通过以下三个章节的深入探讨，读者将能够：

*   在“原理与机制”一章中，您将深入了解生理噪声影响BOLD信号的生物物理通路，并系统学习主流回归校正方法（如[RETROICOR](@entry_id:1130972)、卷积模型、CompCor）的核心思想与实现细节。
*   在“应用与交叉学科联系”一章中，我们将展示这些技术如何在任务态与静息态分析、[多模态成像](@entry_id:913588)、高场强研究等多样化的场景中发挥关键作用，以确保研究结论的稳健性。
*   最后，在“动手实践”部分，您将通过解决一系列精心设计的问题，巩固对[混叠](@entry_id:146322)效应、相位计算和模型构建等核心概念的理解。

本文将带领您超越简单的“去噪”观念，将生理噪声处理视为一种贯穿[实验设计](@entry_id:142447)与数据分析的系统性思维，从而更深刻地理解并驾驭fMRI这一强大的神经科学研究工具。

## 原理与机制

在功能性磁共振成像（fMRI）的数据分析中，我们旨在从观测到的血氧水平依赖（BOLD）信号中准确推断神经活动。然而，BOLD信号不仅反映了神经活动，还混杂了源于心跳、呼吸等生理过程的非神经性波动。这些波动被称为生理噪声，是fMRI数据中最主要的混淆因素之一。若不加以妥善处理，生理噪声会降低[统计功效](@entry_id:197129)，甚至导致虚假的激活或连接模式。本章将深入探讨生理噪声的生物物理起源，系统介绍其主要来源，并详细阐述一系列基于回归的校正方法及其底层原理。

### 生理噪声的生物物理起源

要理解生理噪声为何以及如何影响fMRI信号，我们必须首先回到[BOLD信号](@entry_id:905586)产生的第一性原理。[BOLD信号](@entry_id:905586)的核心机制源于脱氧血红蛋白（deoxyhemoglobin, dHb）的磁特性。

脱氧血红蛋白是一种[顺磁性](@entry_id:139883)物质，它的存在会改变局部磁场的均匀性。在[梯度回波](@entry_id:895930)（gradient-echo）EPI序列中，这种不均匀性会导致水分子[质子自旋](@entry_id:159955)的失相位过程加速，从而缩短有效横向弛豫时间 $T_2^*$。信号强度 $S$ 与 $T_2^*$ 之间的关系可以近似表示为 $S(\mathrm{TE}) = S_0 \exp(-\mathrm{TE}/T_2^*)$，其中 $\mathrm{TE}$ 是回波时间。用[弛豫率](@entry_id:150136) $R_2^* = 1/T_2^*$ 来表示，则信号变化 $\delta S / S$ 与 $R_2^*$ 变化的关系为：

$$
\frac{\delta S}{S} \approx -\mathrm{TE} \cdot \delta R_2^*
$$

关键在于，局部 $R_2^*$ 的变化与脱氧血红蛋白浓度 $c_{\mathrm{dHb}}$ 的变化成正比，即 $\delta R_2^* \propto \delta c_{\mathrm{dHb}}$。这个关系是连接生理过程与fMRI信号的桥梁。任何能够改变局部 $c_{\mathrm{dHb}}$ 的过程，都将不可避免地调制[BOLD信号](@entry_id:905586) 。

神经活动和生理噪声正是通过这条共同的通路影响BOLD信号的：

*   **神经活动通路**：当某个脑区神经活动增强时，[神经血管耦合](@entry_id:154871)机制会被触发。这导致局部[脑血流量](@entry_id:912100)（CBF）的增加幅度远超脑氧代谢率（CMRO$_2$）的增加。这种过度灌注会“冲刷”掉静脉中的脱氧血红蛋白，导致 $c_{\mathrm{dHb}}$ 下降。根据上述关系， $c_{\mathrm{dHb}}$ 下降 $\implies \delta R_2^* \lt 0 \implies \delta S \gt 0$，从而产生我们通常观测到的正向BOLD响应。

*   **生理噪声通路**：心跳、呼吸等系统性生理过程同样能引起[血流动力学](@entry_id:1121718)参数的改变。例如，心脏搏动会引起血管的搏动性舒缩，呼吸深度的变化会改变动脉血中二氧化碳的浓度，进而通过化学反应调节血管舒张状态。这些过程同样会引起[脑血流量](@entry_id:912100)（CBF）、脑血容量（CBV）以及[脱氧血红蛋白](@entry_id:923281)浓度 $c_{\mathrm{dHb}}$ 的波动。例如，在小幅度的生理波动下，静脉血容量 $v(t)$ 和脱氧血红蛋白含量 $q(t)$ 的微小扰动，会通过一个复杂的[非线性](@entry_id:637147)关系（如Davis模型所描述）转化为BOLD信号 $y(t)$ 的波动 。由于这些生理波动通常遍布全脑或遵循血管分布，它们在fMRI数据中表现为广泛的、非神经源的信号起伏。

因此，生理噪声并非简单的加性白噪声，而是通过与神经信号相同的生物物理机制，乘性地调制着fMRI信号。这使得区分[神经信号](@entry_id:153963)和生理噪声成为一项极具挑战性但又至关重要的任务。

### 生理噪声源分类

生理噪声来源多样，其时间特性各不相同。理解这些噪声源的特征是选择和构建合适校正模型的基础。我们可以将它们大致分为两类：快速周期性效应和慢速调制效应 。

*   **心脏搏动（Cardiac Pulsation）**：心脏的每一次搏动都会产生压力波，沿着动脉系统传播。这不仅导致血管搏动性的容积变化，还会引起脑组织和[脑脊液](@entry_id:898244)的微小位移。这些快速的机械效应和血流变化是fMRI信号中一个主要的高频噪声源，其基频通常在健康成年人的静息态下位于 $0.9$ 至 $1.5 \, \mathrm{Hz}$ 范围内。

*   **呼吸运动（Respiratory Motion）**：呼吸过程中胸廓的运动会改变身体在主磁场（$B_0$）中的位置，从而引起磁场的微[小波](@entry_id:636492)动。这种效应在靠近气腔（如[鼻窦](@entry_id:904939)）的脑区尤为明显。呼吸运动本身是一个周期性过程，其[基频](@entry_id:268182)通常在 $0.2$ 至 $0.4 \, \mathrm{Hz}$ 之间。

*   **呼吸容积/时间（Respiratory Volume per Time, RVT）**：除了呼吸的周期性运动本身，呼吸的节律和深度也在缓慢变化。例如，一次深呼吸会暂时降低动脉血中的二氧化碳[分压](@entry_id:168927)（$P_a\text{CO}_2$），即低碳酸血症。由于二氧化碳是强效的[血管舒张](@entry_id:150952)剂，其浓度的降低会引起脑[血管收缩](@entry_id:152456)，导致全局性的CBF和[BOLD信号](@entry_id:905586)下降。这种由[呼吸模式](@entry_id:158261)变化引起的BOLD波动频率较低，主要集中在 $0.01$ 至 $0.1 \, \mathrm{Hz}$ 的频段，恰好与[静息态fMRI](@entry_id:1130967)研究关注的神经活动频段重叠。

*   **[心率变异性](@entry_id:150533)（Heart Rate Variability, HRV）**：心跳间隔并非恒定不变，其逐拍的变异性（HRV）反映了[自主神经系统](@entry_id:150808)的活动状态。HRV中的低频成分（LF, $0.04 - 0.15 \, \mathrm{Hz}$）和高频成分（HF, $0.15 - 0.4 \, \mathrm{Hz}$）与[血压调节](@entry_id:147968)和呼吸性窦性心律失常有关，这些变化同样会传递到[脑血流动力学](@entry_id:900319)，产生慢速的BOLD波动。

*   **其他相关现象**：还包括与自主神经系统相关的**Mayer波**（约 $0.1 \, \mathrm{Hz}$ 的血压和交感神经活动振荡）和更广泛的**血压振荡**。这些过程相互关联，共同构成了复杂的生理噪声背景。

### 基于回归的校正框架

处理生理噪声的主流方法是将其作为[混淆变量](@entry_id:199777)，在通用[线性模型](@entry_id:178302)（General Linear Model, GLM）的框架下进行回归。GLM将每个体素的BOLD时间序列 $y$ 建模为一组已知回归量（设计矩阵 $X$）的[线性组合](@entry_id:154743)，加上残差 $\epsilon$：

$$
y = X\beta + \epsilon
$$

通过在设计矩阵 $X$ 中包含能够表征生理噪声时间过程的列（即 nuisance regressors），GLM拟合过程可以将这部分方差归因于生理噪声，从而从残差 $\epsilon$ 和其他回归量（如任务激活）的估计中“清洗”掉它们的影响。一个全面的[设计矩阵](@entry_id:165826)通常包括任务相关的回归量 $X_{\mathrm{task}}$、头部运动参数 $X_{\mathrm{motion}}$、生理噪声回归量 $X_{\mathrm{physio}}$，以及用于处理扫描仪漂移的低频多项式趋势 $X_{\mathrm{poly}}$ ：

$$
X = [X_{\mathrm{task}} \mid X_{\mathrm{motion}} \mid X_{\mathrm{physio}} \mid X_{\mathrm{poly}}]
$$

接下来的小节将详细介绍构建 $X_{\mathrm{physio}}$ 的几种主流方法。

### 基于外部记录的校正方法

这类方法利用与fMRI扫描同步记录的外部生理信号（如[心电图](@entry_id:912817)ECG、脉搏血氧饱和度、呼吸带）来构建噪声回归量。

#### [RETROICOR](@entry_id:1130972)：对周期性伪影建模

回顾性图像校正（Retrospective Image Correction, [RETROICOR](@entry_id:1130972)）是处理心脏和呼吸周期性伪影的经典方法 。其核心思想是，这些伪影的信号变化与生理周期的**相位**（phase）紧密相关。

**原理与机制**：[RETROICOR](@entry_id:1130972)利用傅里叶级数来近似表达伪影与相位的函数关系。对于心脏周期，其相位 $\phi_c(t)$ 在每次心跳（如[R波](@entry_id:753996)峰）时重置为 $0$，并线性增加至 $2\pi$ 直至下次心跳。呼吸相位 $\phi_r(t)$ 同理。然后，构建一组正弦和余弦回归量：

$$
\{\cos(k\phi_c(t)), \sin(k\phi_c(t))\}_{k=1}^{M_c} \quad \text{and} \quad \{\cos(k\phi_r(t)), \sin(k\phi_r(t))\}_{k=1}^{M_r}
$$

其中 $k$ 是[谐波](@entry_id:181533)阶数，通常取到二阶或三阶（$M_c=2, M_r=2$）就足以捕捉伪影的主要非正弦特征。这些回归量被直接加入GLM的[设计矩阵](@entry_id:165826)中。值得注意的是，它们模拟的是直接的物理伪影，而非经过[血流动力学](@entry_id:1121718)响应的信号，因此**不应**与血流动力学响应函数（HRF）进行卷积 。

**关于混叠的挑战与解决方案**：一个常见的疑问是，fMRI的重复时间（TR）通常为 $1$ 到 $2$ 秒，对应的采样频率（$0.5-1 \, \mathrm{Hz}$）远低于心脏搏动的频率（约 $1-1.5 \, \mathrm{Hz}$）。根据[奈奎斯特-香农采样定理](@entry_id:262499)，心脏信号在fMRI时间序列中会被严重**[混叠](@entry_id:146322)**（aliasing），即其原始频率会“折叠”到一个更低的、错误的频率上。那么[RETROICOR](@entry_id:1130972)为何依然有效？

答案在于其巧妙的实现方式 。[RETROICOR](@entry_id:1130972)的回归量是基于高[时间分辨率](@entry_id:194281)的外部生理记录（例如 $100 \, \mathrm{Hz}$）计算出[瞬时相位](@entry_id:1126533)，然后再根据fMRI每个**层片（slice）**的精确[采集时间](@entry_id:266526)点对相位回归量进行**下采样**。由于fMRI数据中的生理噪声和我们构建的回归量经历了完全相同的采样和[混叠](@entry_id:146322)过程，它们在最终的离散时间序列中保持了完美的线性关系。因此，即使信号被混叠，GLM仍然可以有效地利用混叠后的回归量来移除[混叠](@entry_id:146322)后的噪声。这也是为什么精确的层片[采集时间](@entry_id:266526)信息对于[RETROICOR](@entry_id:1130972)至关重要，尤其是在交错或多带（multi-band）采集成像中。为了保证不发生混叠，[采样频率](@entry_id:264884)必须至少是信号最高频率的两倍。例如，要无混叠地采集 $1.5 \, \mathrm{Hz}$ 的心跳信号，TR必须满足 $\frac{1}{2 \cdot \mathrm{TR}} > 1.5 \, \mathrm{Hz}$，即 $\mathrm{TR} \lt 1/3 \, \mathrm{s}$，这对于大多数f[MRI序列](@entry_id:912871)是不现实的 。

#### 卷积模型：对慢速波动建模

[RETROICOR](@entry_id:1130972)主要处理与生理周期相位锁定的快速伪影，而由RVT和HRV引起的慢速BOLD波动则需要不同的建模策略。这些效应是间接的，涉及生理变化、信号传导和血管响应等一系列延迟过程。

**原理与机制**：直接将RVT或HR时间序列作为回归量是无效的，因为它没有考虑生理变化与其在脑部[BOLD信号](@entry_id:905586)中表现出来之间的延迟和动态过程。正确的方法是采用[线性时不变](@entry_id:276287)（LTI）系统理论，将慢速BOLD波动建模为RVT或HR输入信号与一个**生理[响应函数](@entry_id:142629)**（Physiological Response Function）进行卷积的结果 。

$$
\text{BOLD}_{\text{physio}}(t) = (\text{RVT} * \text{RRF})(t) + (\text{HRV} * \text{CRF})(t)
$$

这里的RRF（Respiratory Response Function）和CRF（Cardiac Response Function）是描述[单位脉冲](@entry_id:272155)输入（如一次深呼吸或一次[心率](@entry_id:151170)突变）所引起的[BOLD信号](@entry_id:905586)响应的[脉冲响应函数](@entry_id:1126431)。

**生理响应函数的特征**：这些函数的形状由其底层生理机制决定 。
*   **RRF**：通常表现为一个显著延迟（因为血液从肺部传输到大脑需要时间）且形态宽广的波形。当使用RVT作为输入时（一次深呼吸对应RVT的正向脉冲），RRF通常是一个负向波谷，峰值延迟约在 $12$ 到 $20$ 秒，反映了深呼吸导致的低碳酸血症引起[血管收缩](@entry_id:152456)，从而降低了BOLD信号 。
*   **CRF**：其形状更为复杂，常呈现双相或三相形态。这可能反映了[心率](@entry_id:151170)变化后快速的机械或压力效应，与随之而来的、较慢的[脑血管自动调节](@entry_id:914804)（autoregulation）反馈之间的相互作用 。

通过将RVT和HRV时间序列与这些经验或数据驱动得到的[响应函数](@entry_id:142629)进行卷积，我们可以生成更准确的回归量，用于在GLM中解释生理来源的慢速BOLD波动。

### 基于fMRI数据的校正方法：CompCor

在没有外部生理记录的情况下，我们仍然可以从fMRI数据本身提取生理噪声的代理指标。CompCor（Component-based Correction）就是此类方法中的杰出代表 。

**原理与机制**：CompCor的基本假设是，生理噪声在脑白质（White Matter, WM）和[脑脊液](@entry_id:898244)（Cerebrospinal Fluid, CSF）等非神经组织中是主要的方差来源。这些组织的神经活动极少，因此其信号波动主要反映了系统性的生理效应和头部运动。通过对这些“噪声区域”的信号进行主成分分析（Principal Component Analysis, PCA），我们可以提取出代表主要噪声模式的时间序列，并将它们作为 nuisance regressors。

CompCor主要有两种变体：

*   **aCompCor（Anatomical CompCor）**：首先，基于受试者的高分辨率解剖图像，定义一个包含WM和CSF的解剖学噪声兴趣区（ROI）。为避免信号泄露，通常会对该ROI进行腐蚀（erode）处理，确保不包含邻近的[灰质](@entry_id:912560)体素。然后，提取该ROI内所有体素的时间序列，并对这个数据矩阵执行PCA。得到的时间主成分（temporal principal components）中，解释方差最大的前几个成分（例如5个）被选为噪声回归量。

*   **tCompCor（Temporal CompCor）**：tCompCor不依赖于解剖学先验，而是根据时间动态来定义噪声ROI。它首先识别出全脑或一个广泛脑区内时间方差最高的体素（例如，方差排名前2%的体素）。其逻辑是，生理和运动伪影通常会引起大幅度的信号波动。然后，对这些高方差体素的时间序列进行PCA，同样提取前几个主成分作为噪声回归量。

这两种方法都通过数据驱动的方式识别并移除了fMRI数据中的共享方差成分，有效地降低了生理噪声的影响，而无需外部设备。

### 高级主题与潜在陷阱

虽然生理噪声回归技术非常强大，但在实际应用中也需注意一些复杂问题。

#### [非平稳性](@entry_id:180513)问题

生理噪声与[BOLD信号](@entry_id:905586)之间的关系并非一成不变。在fMRI扫描过程中，受试者的觉醒度、注意力和自主神经状态都在不断变化，这会导致生理响应[函数的振幅](@entry_id:160674)和延迟发生改变。这种时变特性被称为**非平稳性（nonstationarity）** 。

一个全局的、时间不变的GLM模型可能无法完美捕捉这种动态变化。为了解决这个问题，可以采用**滑动窗口（sliding-window）**估计。这种方法假设在足够短的时间窗口内，生理-BOLD耦合关系是近似平稳的（即局部平稳性）。通过在整个时间序列上滑动这个窗口，并为每个窗口分别估计[回归系数](@entry_id:634860)，我们可以得到一组时变的系数，从而更好地追踪非平稳的噪声贡献。当然，这也引入了经典的**偏倚-方差权衡（bias-variance trade-off）**：窗口越短，对变化的追踪越灵敏（偏倚低），但估计的方差也越大；窗口越长，估计越稳定（方差低），但可能平滑掉真实的动态变化（偏倚高） 。

#### 过度校正的风险

当任务设计本身就涉及生理状态的改变时（例如，[呼吸暂停](@entry_id:149431)任务、情绪诱发任务），一个关键的风险是**过度校正（overcorrection）**。如果用于校正的生理噪声回归量与任务相关的神经信号回归量存在相关性（即共線性），那么在回归过程中，一部分真实的“信号”方差可能会被错误地归因于“噪声”并被移除，从而导致任务激活的估计被削弱 。

我们可以用[投影矩阵](@entry_id:154479)的语言来精确地描述这个问题。假设 $x$ 是任务回归量，$Z$ 是噪声回归量矩阵。在序贯回归流程中（先用 $Z$ 清理数据，再用 $x$ 拟合残差），任务效应的估计值 $\hat{\beta}_{\text{step}}$ 会被一个衰减因子 $\kappa$ 缩放：

$$
\hat{\beta}_{\text{step}} = \kappa(Z, x) \beta_{\text{true}}
$$

其中，衰减因子 $\kappa$ 的计算公式为：

$$
\kappa(Z, x) = 1 - \frac{\lVert P_Z x \rVert^2}{\lVert x \rVert^2}
$$

这里 $P_Z = Z(Z^{\top}Z)^{+}Z^{\top}$ 是向噪声子空间 $\mathrm{span}(Z)$ 的投影算子。这个公式明确指出，只要任务回归量 $x$ 在噪声子空间上存在非零投影（即 $\lVert P_Z x \rVert^2 > 0$），信号衰减就会发生。衰减的程度等于 $x$ 的方差中可以被噪声回归量解释的比例。

因此，研究者在选择噪声回归模型时必须保持警惕。进行敏感性分析，例如比较包含不同 nuisance sets（如仅运动、仅生理、两者结合）时任务激活强度的变化，是评估和理解潜在过度校正风险的重要步骤 。

总之，生理噪声是fMRI数据中一个复杂但可控的混淆因素。通过深入理解其生物物理机制和时间特性，并审慎应用[RETROICOR](@entry_id:1130972)、卷积模型、CompCor等一系列先进的回归技术，研究者可以显著提高[fMRI分析](@entry_id:1125162)的[信度和效度](@entry_id:915949)。