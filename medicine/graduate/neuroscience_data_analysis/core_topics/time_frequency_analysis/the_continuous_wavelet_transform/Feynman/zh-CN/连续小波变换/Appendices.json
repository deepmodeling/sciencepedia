{
    "hands_on_practices": [
        {
            "introduction": "在应用连续小波变换（CWT）之前，我们必须建立一个关键的联系：如何将我们感兴趣的神经振荡频率，转化为小波变换算法所需的“尺度”参数。本练习将引导您从傅里叶理论的第一性原理出发，推导小波尺度 $a$ 与其对应的伪频率 $f$ 之间的基本关系。掌握这项技能，您将能够设计一套精确覆盖特定神经频带的自定义尺度，为任何目标明确的时频分析奠定坚实基础 。",
            "id": "4198700",
            "problem": "给定一个离散神经时间序列 $x[n]$，其采样频率为 $f_s$（单位：赫兹Hz），采样周期 $\\Delta t$（单位：秒）等于 $\\Delta t = 1 / f_s$。考虑连续小波变换（CWT），其对于母小波 $\\psi(t)$ 定义为经过尺度缩放和平移的小波原子 $\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t-b}{a}\\right)$，其中尺度 $a > 0$，平移 $b \\in \\mathbb{R}$。在神经科学数据分析中，一种常用的母小波是 Morlet 小波，它具有明确定义的谱峰。您必须从傅里叶变换和小波尺度的基本性质出发，利用尺度关系推导出一个原理性映射，该映射用于建立 Morlet 小波的尺度 $a$ 与其对应的伪频率 $f$（单位：赫兹Hz）之间的关系。与 Morlet 小波相关的角频率参数必须以弧度处理，并且您必须明确使用弧度作为角度单位。\n\n设计一个离散尺度集合 $\\{a_k\\}_{k=0}^{K-1}$，使得每个尺度对应的伪频率能够覆盖目标频带 $[f_{\\min}, f_{\\max}]$（单位：赫兹Hz），其中 $f_{\\max} \\leq f_s/2$（奈奎斯特极限）。使用恒定品质因数（constant-$Q$）设计准则：相邻的伪频率必须在整个频带上形成一个等比数列，即存在一个常数比率 $r$，使得对于所有有效的 $k$ 都有 $f_{k+1} = r \\cdot f_k$。您必须从第一性原理出发，推导 $a_k$ 和 $f_k$ 之间的映射关系，而不能假设任何预先给定的小波频率-尺度公式，然后实现该映射，从期望的伪频率计算出尺度。\n\n您的程序必须为每个测试用例实现以下步骤：\n- 计算 $\\Delta t = 1 / f_s$。\n- 根据恒定-$Q$ 准则，构建 $K$ 个伪频率 $\\{f_k\\}$，使其以等比方式跨越 $[f_{\\min}, f_{\\max}]$，对于 $K \\geq 2$，设 $f_0 = f_{\\max}$ 且 $f_{K-1} = f_{\\min}$。对于 $K = 1$，设 $f_0 = f_{\\min} = f_{\\max}$。\n- 使用您推导的映射关系，计算实现这些伪频率的尺度 $\\{a_k\\}$。\n- 从尺度重新计算伪频率 $\\{\\hat{f}_k\\}$ 以验证一致性。\n\n对于每个测试用例，计算并返回以下可量化的输出：\n1. 最小伪频率 $\\min_k \\hat{f}_k$（浮点数，单位：赫兹Hz）。\n2. 最大伪频率 $\\max_k \\hat{f}_k$（浮点数，单位：赫兹Hz）。\n3. 目标频带边缘与实现的伪频率之间的最大相对边缘误差：$\\max\\left(\\left|\\frac{f_{\\min} - \\min_k \\hat{f}_k}{f_{\\min}}\\right|, \\left|\\frac{f_{\\max} - \\max_k \\hat{f}_k}{f_{\\max}}\\right|\\right)$（浮点数）。\n4. 实现的连续频率比率与目标等比比率 $r$ 之间的最大绝对偏差（浮点数）。对于 $K=1$，将此偏差定义为 $0$。\n5. 一个布尔值，指示所有实现的伪频率是否都位于闭区间 $[f_{\\min}, f_{\\max}]$ 内（包含边界），允许标准双精度浮点运算水平的数值舍入误差。\n\n单位和角度规范：\n- 所有频率 $f$、$f_{\\min}$、$f_{\\max}$、$f_s$、$\\hat{f}_k$ 的单位均为赫兹Hz。\n- 采样周期 $\\Delta t$ 的单位为秒。\n- 角频率参数的单位为弧度，使用的任何角度量都必须是弧度。\n- 不允许使用以度为单位的角度。\n\n测试套件：\n为以下参数集 $\\left(f_s, f_{\\min}, f_{\\max}, K, \\omega_0\\right)$ 提供结果，其中 $\\omega_0$ 是在您的推导和实现中使用的 Morlet 小波中心角频率参数（单位：弧度）：\n- 案例 1：$\\left(f_s = 1000, f_{\\min} = 4, f_{\\max} = 100, K = 12, \\omega_0 = 6\\right)$。\n- 案例 2：$\\left(f_s = 500, f_{\\min} = 20, f_{\\max} = 240, K = 18, \\omega_0 = 6\\right)$。\n- 案例 3：$\\left(f_s = 250, f_{\\min} = 1, f_{\\max} = 4, K = 10, \\omega_0 = 5\\right)$。\n- 案例 4：$\\left(f_s = 1000, f_{\\min} = 30, f_{\\max} = 30, K = 1, \\omega_0 = 6\\right)$。\n- 案例 5：$\\left(f_s = 2000, f_{\\min} = 800, f_{\\max} = 950, K = 5, \\omega_0 = 7\\right)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由逗号分隔的列表，并用方括号括起来。每个测试用例的结果本身必须是包含上述五个值的列表，且顺序完全一致，从而形成一个嵌套列表。例如，输出形式应为 $[\\,[\\text{case1\\_min},\\text{case1\\_max},\\text{case1\\_err},\\text{case1\\_dev},\\text{case1\\_bool}],\\ldots\\,]$。",
            "solution": "我们从连续小波变换（CWT）的定义开始，对于母小波 $\\psi(t)$，经过尺度缩放的小波原子由 $\\psi_{a}(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t}{a}\\right)$ 给出，其中尺度 $a > 0$。在推导尺度-频率映射时，不需要平移参数。在神经科学中，一种广泛使用的母小波是 Morlet 小波，它由一个无量纲时间变量定义为\n$$\n\\psi(t) = \\pi^{-1/4} \\exp\\left(i\\,\\omega_0\\, t\\right)\\exp\\left(-\\frac{t^2}{2}\\right),\n$$\n其中 $\\omega_0$ 是一个中心角频率参数，单位为弧度。我们使用的关键基础事实是：\n1. 傅里叶变换的尺度缩放性质：如果 $\\mathcal{F}\\{\\psi(t)\\}(\\omega) = \\hat{\\psi}(\\omega)$，则 $\\psi_a(t) = \\frac{1}{\\sqrt{a}}\\psi\\left(\\frac{t}{a}\\right)$ 的傅里叶变换为 $\\hat{\\psi}_a(\\omega) = \\sqrt{a}\\,\\hat{\\psi}(a\\,\\omega)$。\n2. 对于未缩放的小波 $\\psi(t)$，由于高斯包络调制了复指数 $\\exp(i\\,\\omega_0 t)$，Morlet 小波在傅里叶域的峰值出现在角频率约等于 $\\omega = \\omega_0$ 的位置。\n\n利用这些性质，我们推导谱峰如何随尺度变化。对于经过尺度缩放的小波 $\\psi_a(t)$，其傅里叶变换为 $\\hat{\\psi}_a(\\omega) = \\sqrt{a}\\,\\hat{\\psi}(a\\,\\omega)$，因此 $\\hat{\\psi}_a(\\omega)$ 的峰值位置出现在 $a\\,\\omega \\approx \\omega_0$ 时，即\n$$\n\\omega \\approx \\frac{\\omega_0}{a}.\n$$\n这确立了尺度缩放后小波在连续时间下的中心角频率。为了将其与采样周期为 $\\Delta t = 1/f_s$（单位：秒）的离散时间采样信号 $x[n]$ 联系起来，我们将角频率转换为每秒周期数（赫兹Hz）。角频率和普通频率通过 $\\omega = 2\\pi f$ 关联，单位为弧度/秒。代入后得到，\n$$\n2\\pi f \\approx \\frac{\\omega_0}{a}.\n$$\n在采样数据分析中，由给定尺度 $a$ 实现的伪频率（单位：赫兹Hz）必须考虑离散采样间隔 $\\Delta t$。因为母小波中使用的无量纲时间通过 $t_{\\text{phys}} = t \\cdot \\Delta t$ 对应于物理时间，所以有效频率（单位：赫兹Hz）为\n$$\nf(a) \\approx \\frac{\\omega_0}{2\\pi\\, a\\, \\Delta t}.\n$$\n这就是从傅里叶尺度缩放性质和角频率定义推导出的所要求的尺度到伪频率的映射关系。该关系中，$\\omega_0$ 的角度单位为弧度，$\\Delta t$ 的单位为秒。\n\n现在，我们根据恒定品质因数准则，设计一个离散尺度集合 $\\{a_k\\}_{k=0}^{K-1}$，以覆盖目标频带 $[f_{\\min}, f_{\\max}]$（单位：赫兹Hz）。恒定-$Q$ 设计要求相邻的伪频率形成一个等比数列。设 $K$ 为尺度数量。对于 $K \\geq 2$，定义一个目标伪频率的等比数列 $\\{f_k\\}$：\n$$\nf_k = f_{\\max}\\, r^k, \\quad k = 0,1,\\ldots,K-1,\n$$\n其公比为\n$$\nr = \\left(\\frac{f_{\\min}}{f_{\\max}}\\right)^{\\frac{1}{K-1}}.\n$$\n这确保了 $f_0 = f_{\\max}$ 且 $f_{K-1} = f_{\\min}$。对于 $K = 1$，我们设置 $f_0 = f_{\\min} = f_{\\max}$，这可以简单地覆盖该频带。给定推导出的尺度 $a$ 和伪频率 $f$ 之间的映射关系，我们反转该映射，从期望的伪频率中获取尺度：\n$$\na_k = \\frac{\\omega_0}{2\\pi\\, f_k\\, \\Delta t}.\n$$\n为验证正确性，我们从尺度重新计算实现的伪频率：\n$$\n\\hat{f}_k = \\frac{\\omega_0}{2\\pi\\, a_k\\, \\Delta t}.\n$$\n根据构造，$\\hat{f}_k$ 与 $f_k$ 相等，只存在浮点舍入误差。\n\n每个测试用例的算法步骤：\n1. 计算 $\\Delta t = 1/f_s$。\n2. 如果 $K \\geq 2$，计算 $r = (f_{\\min}/f_{\\max})^{1/(K-1)}$ 和序列 $f_k = f_{\\max} r^k$。如果 $K = 1$，设 $f_0 = f_{\\min} = f_{\\max}$。\n3. 计算尺度 $a_k = \\omega_0/(2\\pi f_k \\Delta t)$。\n4. 重新计算 $\\hat{f}_k = \\omega_0/(2\\pi a_k \\Delta t)$。\n5. 计算输出：\n   - $\\min_k \\hat{f}_k$ 和 $\\max_k \\hat{f}_k$（单位：赫兹Hz）。\n   - 最大相对边缘误差 $\\max\\left(\\left|\\frac{f_{\\min} - \\min_k \\hat{f}_k}{f_{\\min}}\\right|, \\left|\\frac{f_{\\max} - \\max_k \\hat{f}_k}{f_{\\max}}\\right|\\right)$。\n   - 实现的连续比率 $\\hat{r}_k = \\hat{f}_{k+1}/\\hat{f}_k$ 与目标比率 $r$ 的最大绝对偏差。对于 $K=1$，此偏差定义为 $0$。\n   - 一个布尔值，指示所有 $\\hat{f}_k$ 是否都在 $[f_{\\min}, f_{\\max}]$（包含边界）内，允许数值舍入误差。\n\n科学真实性和约束：\n- 在所提供的测试套件中，设计确保了 $f_{\\max} \\leq f_s/2$（奈奎斯特极限）。\n- Morlet 参数 $\\omega_0$ 以弧度为单位指定，并保持在神经科学中使用的典型值范围内（$\\omega_0$ 在 $5$ 到 $7$ 的范围内很常见）。\n\n测试套件覆盖范围：\n- 案例1 是一个典型的局部场电位分析频带，参数为 $f_s = 1000$, $[f_{\\min}, f_{\\max}] = [4, 100]$, $K = 12$, $\\omega_0 = 6$。\n- 案例2 接近奈奎斯特极限，参数为 $f_s = 500$, $[20, 240]$, $K = 18$, $\\omega_0 = 6$。\n- 案例3 关注低频段，参数为 $f_s = 250$, $[1, 4]$, $K = 10, \\omega_0 = 5$。\n- 案例4 测试退化的单尺度场景，参数为 $f_s = 1000$, $[30, 30]$, $K = 1$, $\\omega_0 = 6$。\n- 案例5 是一个靠近奈奎斯特极限的窄高频带，参数为 $f_s = 2000$, $[800, 950]$, $K = 5$, $\\omega_0 = 7$。\n\n对于每个测试用例，最终程序输出列表 $[\\min_k \\hat{f}_k, \\max_k \\hat{f}_k, \\text{edge\\_error}, \\text{ratio\\_deviation}, \\text{coverage\\_boolean}]$，所有结果汇集成一个顶层列表并作为单行打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef design_scales_and_metrics(fs, f_min, f_max, K, w0):\n    \"\"\"\n    Design constant-Q pseudo-frequencies and corresponding scales for a Morlet wavelet,\n    then compute verification metrics.\n\n    Parameters:\n        fs (float): Sampling frequency in Hz.\n        f_min (float): Minimum target pseudo-frequency in Hz.\n        f_max (float): Maximum target pseudo-frequency in Hz.\n        K (int): Number of scales.\n        w0 (float): Morlet central angular frequency parameter in radians.\n\n    Returns:\n        list: [min_fk, max_fk, edge_rel_error, ratio_dev, coverage_bool]\n    \"\"\"\n    dt = 1.0 / fs\n\n    # Construct geometric sequence of target pseudo-frequencies\n    if K >= 2:\n        r = (f_min / f_max) ** (1.0 / (K - 1))\n        # f_k descending from f_max to f_min\n        f_k = f_max * (r ** np.arange(K))\n    else:\n        # K == 1\n        r = 1.0\n        f_k = np.array([f_min], dtype=float)\n\n    # Compute scales from derived mapping: a_k = w0 / (2*pi*f_k*dt)\n    two_pi = 2.0 * np.pi\n    a_k = w0 / (two_pi * f_k * dt)\n\n    # Recompute pseudo-frequencies from scales to verify: f_hat_k = w0 / (2*pi*a_k*dt)\n    f_hat_k = w0 / (two_pi * a_k * dt)\n\n    # Metrics\n    min_fk = float(np.min(f_hat_k))\n    max_fk = float(np.max(f_hat_k))\n\n    # Edge relative error\n    # Avoid division by zero if f_min == 0 (not present in our test suite)\n    edge_err_min = abs((f_min - min_fk) / f_min) if f_min != 0 else abs(f_min - min_fk)\n    edge_err_max = abs((f_max - max_fk) / f_max) if f_max != 0 else abs(f_max - max_fk)\n    edge_rel_error = float(max(edge_err_min, edge_err_max))\n\n    # Ratio deviation: compare realized consecutive ratios to target r\n    if K >= 2:\n        realized_ratios = f_hat_k[1:] / f_hat_k[:-1]\n        ratio_dev = float(np.max(np.abs(realized_ratios - r)))\n    else:\n        ratio_dev = 0.0\n\n    # Coverage boolean: all realized pseudo-frequencies within [f_min, f_max]\n    # Allow tiny numerical tolerance\n    tol = 1e-12\n    coverage_bool = bool((min_fk >= f_min - tol) and (max_fk <= f_max + tol))\n\n    return [min_fk, max_fk, edge_rel_error, ratio_dev, coverage_bool]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (fs, f_min, f_max, K, w0)\n    test_cases = [\n        (1000.0, 4.0, 100.0, 12, 6.0),\n        (500.0, 20.0, 240.0, 18, 6.0),\n        (250.0, 1.0, 4.0, 10, 5.0),\n        (1000.0, 30.0, 30.0, 1, 6.0),\n        (2000.0, 800.0, 950.0, 5, 7.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        fs, f_min, f_max, K, w0 = case\n        result = design_scales_and_metrics(fs, f_min, f_max, K, w0)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际研究中，我们处理的神经信号记录总是长度有限的，这会在CWT分析的开始和结束阶段引入伪影。本练习要求您从数学上推导并量化信号边界附近的振幅衰减，这一现象通常被称为“影响锥”（cone of influence）。理解这些边界效应对于正确解读CWT结果至关重要，能帮助您避免对数据边缘的神经活动做出错误判断 。",
            "id": "4198675",
            "problem": "给定一个在神经科学数据分析中使用的一维信号的有限时长观测。目标是分析有限长度信号在边界附近对连续小波变换 (CWT) 的影响，推导缩放和平移后小波的有效截断，并量化振幅偏差作为尺度的函数。请仅使用基于以下基本依据的数学上严格的定义和推导。\n\n定义和假设：\n- 信号 $x(t)$ 相对于母小波 $\\psi(t)$ 的连续小波变换 (CWT) 定义为\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} x(t) \\, \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\, dt,\n$$\n其中 $a \\in \\mathbb{R}^{+}$ 是尺度，$b \\in \\mathbb{R}$ 是平移，$\\psi^{*}$ 表示复共轭。\n- 观测到的信号在时间上被限制在 $[0, T]$ 秒的区间内，其中 $T > 0$ 是总时长（秒）。观测到的 CWT 为\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{0}^{T} x(t) \\, \\psi^{*}\\!\\left(\\frac{t-b}{a}\\right) \\, dt.\n$$\n- 母小波是复Morlet小波，\n$$\n\\psi(t) = \\pi^{-1/4} \\, e^{i \\omega_{0} t} \\, e^{-t^{2}/2},\n$$\n其中心角频率 $\\omega_{0} > 0$。缩放和平移后的小波为\n$$\n\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}} \\psi\\!\\left(\\frac{t-b}{a}\\right).\n$$\n- 分析信号是一个窄带振荡，模型为\n$$\nx(t) = e^{i 2\\pi f_{0} t},\n$$\n其中 $f_{0}$ 是振荡频率，单位为赫兹 (Hz)。\n- 所有时间必须以秒表示，所有频率必须以赫兹表示。没有需要报告的角度。\n\n任务：\n1. 推导由有限观测区间 $[0,T]$ 引起的、在边界附近对缩放和平移后的小波 $\\psi_{a,b}(t)$ 的有效截断。定义能量包含分数\n$$\n\\Gamma(a,b;T) = \\frac{\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}{\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}\n$$\n并使用基本积分和著名的特殊函数以闭式形式表示它。\n2. 从连续小波变换的定义和有限观测区间出发，推导边界附近振幅偏差的闭式表达式，定义为\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|},\n$$\n作为尺度 $a$、平移 $b$、时长 $T$、振荡频率 $f_{0}$ 和小波中心角频率 $\\omega_{0}$ 的函数。\n3. 实现一个程序，使用您推导的表达式计算下面每个测试用例的 $B(a,b;T,f_{0},\\omega_{0})$。对于每个用例，设置 $f_{0}$ 以匹配给定尺度下小波的峰值响应，即 $f_{0} = \\omega_{0}/(2\\pi a)$，以分离边界引起的影响。$T$ 和 $b$ 的单位必须是秒，$f_{0}$ 的单位必须是赫兹。\n4. 最终程序输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其中包含以下测试套件的振幅偏差值 $B$。每个结果必须是浮点数。\n\n测试套件（时间单位：秒，频率单位：赫兹）：\n- 用例 1（靠近左边界，中等尺度）：$T = 10.0$, $b = 0.5$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$。\n- 用例 2（恰好在左边界，中等尺度）：$T = 10.0$, $b = 0.0$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$。\n- 用例 3（靠近左边界，大尺度）：$T = 10.0$, $b = 0.5$, $a = 2.0$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$。\n- 用例 4（区间中心）：$T = 10.0$, $b = 5.0$, $a = 1.0$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$。\n- 用例 5（靠近右边界，中等尺度）：$T = 10.0$, $b = 9.5$, $a = 0.5$, $\\omega_{0} = 6.0$, $f_{0} = \\omega_{0}/(2\\pi a)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3},r_{4},r_{5}]$），其中每个 $r_{k}$ 是相应情况下 $B(a,b;T,f_{0},\\omega_{0})$ 的浮点值。",
            "solution": "问题陈述具有科学依据、问题明确、客观，并包含了进行严格推导所需的所有必要信息。连续小波变换 (CWT)、复Morlet小波的定义以及问题目标在时频分析领域都是标准的。因此，我们可以着手求解。\n\n分析分为两个主要任务：首先，推导能量包含分数 $\\Gamma(a,b;T)$；其次，推导振幅偏差 $B(a,b;T,f_{0},\\omega_{0})$。\n\n**任务 1：能量包含分数 $\\Gamma(a,b;T)$ 的推导**\n\n能量包含分数 $\\Gamma(a,b;T)$ 定义为在观测区间 $[0, T]$ 内缩放和平移后的小波能量与其在 $(-\\infty, \\infty)$ 上的总能量之比。\n$$\n\\Gamma(a,b;T) = \\frac{\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}{\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt}\n$$\n母小波是 $\\psi(t) = \\pi^{-1/4} e^{i \\omega_{0} t} e^{-t^{2}/2}$。缩放和平移后的小波是 $\\psi_{a,b}(t) = \\frac{1}{\\sqrt{a}} \\psi\\left(\\frac{t-b}{a}\\right)$。\n\n首先，我们计算 $\\psi_{a,b}(t)$ 的模的平方：\n$$\n\\left| \\psi_{a,b}(t) \\right|^2 = \\left| \\frac{1}{\\sqrt{a}} \\pi^{-1/4} e^{i \\omega_{0} (t-b)/a} e^{-((t-b)/a)^{2}/2} \\right|^2 = \\frac{1}{a} \\pi^{-1/2} \\left| e^{i \\omega_{0} (t-b)/a} \\right|^2 \\left| e^{-((t-b)/a)^{2}/2} \\right|^2\n$$\n因为 $|e^{i\\theta}| = 1$ 并且实数的指数函数是其自身的模，我们得到：\n$$\n\\left| \\psi_{a,b}(t) \\right|^2 = \\frac{1}{a \\sqrt{\\pi}} e^{-((t-b)/a)^{2}}\n$$\n$\\Gamma(a,b;T)$ 的分母是总能量。我们证明该小波具有单位能量：\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-((t-b)/a)^{2}} \\, dt\n$$\n令 $u = (t-b)/a$，则 $dt = a \\, du$。积分限仍为 $(-\\infty, \\infty)$。\n$$\n\\int_{-\\infty}^{\\infty} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-u^2} (a \\, du) = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-u^2} \\, du = \\frac{1}{\\sqrt{\\pi}} \\sqrt{\\pi} = 1\n$$\n这证实了分母为 $1$。\n\n接下来，我们计算分子，即在有限区间 $[0, T]$ 上的积分：\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{a \\sqrt{\\pi}} \\int_{0}^{T} e^{-((t-b)/a)^{2}} \\, dt\n$$\n使用相同的代换 $u = (t-b)/a$，积分限变为 $u_{lower} = -b/a$ 和 $u_{upper} = (T-b)/a$。\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{\\sqrt{\\pi}} \\int_{-b/a}^{(T-b)/a} e^{-u^2} \\, du\n$$\n这个积分可以用误差函数 $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-x^2} \\, dx$ 来表示。积分 $\\int_{z_1}^{z_2} e^{-x^2} dx = \\frac{\\sqrt{\\pi}}{2}(\\text{erf}(z_2) - \\text{erf}(z_1))$。\n$$\n\\frac{1}{\\sqrt{\\pi}} \\int_{-b/a}^{(T-b)/a} e^{-u^2} \\, du = \\frac{1}{\\sqrt{\\pi}} \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) - \\text{erf}\\left(-\\frac{b}{a}\\right) \\right]\n$$\n利用性质 $\\text{erf}(-z) = -\\text{erf}(z)$，我们得到分子的闭式表达式。\n$$\n\\int_{0}^{T} \\left| \\psi_{a,b}(t) \\right|^{2} \\, dt = \\frac{1}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) + \\text{erf}\\left(\\frac{b}{a}\\right) \\right]\n$$\n因此，能量包含分数为：\n$$\n\\Gamma(a,b;T) = \\frac{1}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{a}\\right) + \\text{erf}\\left(\\frac{b}{a}\\right) \\right]\n$$\n\n**任务 2：振幅偏差 $B(a,b;T,f_{0},\\omega_{0})$ 的推导**\n\n振幅偏差 $B$ 是有限信号的CWT模值 $\\left| \\widetilde{W}_{x}(a,b) \\right|$ 与无限信号的CWT模值 $\\left| W_{x}(a,b) \\right|$ 之比。\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|}\n$$\n信号为 $x(t) = e^{i 2\\pi f_{0} t}$，小波变换使用 $\\psi_{a,b}^*(t) = \\frac{1}{\\sqrt{a}} \\psi^*\\left(\\frac{t-b}{a}\\right)$ 计算。母小波的复共轭是 $\\psi^*(t) = \\pi^{-1/4} e^{-i \\omega_{0} t} e^{-t^{2}/2}$。\n无限信号的CWT为：\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}} \\int_{-\\infty}^{\\infty} e^{i 2\\pi f_{0} t} \\, \\pi^{-1/4} e^{-i \\omega_{0} (t-b)/a} e^{-((t-b)/a)^{2}/2} \\, dt\n$$\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{-\\infty}^{\\infty} e^{i(2\\pi f_0 - \\omega_0/a) t} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\n问题指定将分析频率 $f_{0}$ 设置为与尺度 $a$ 处小波的峰值响应相匹配，即 $f_{0} = \\omega_{0}/(2\\pi a)$。此条件意味着 $2\\pi f_0 - \\omega_0/a = 0$，从而显著简化了积分：\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{-\\infty}^{\\infty} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\n该积分为标准高斯积分。令 $v = (t-b)/(\\sqrt{2}a)$，则 $dt=\\sqrt{2}a \\, dv$。\n$$\n\\int_{-\\infty}^{\\infty} e^{-(t-b)^2/(2a^2)} \\, dt = \\int_{-\\infty}^{\\infty} e^{-v^2} (\\sqrt{2}a \\, dv) = \\sqrt{2}a \\sqrt{\\pi}\n$$\n将其代回，我们得到：\n$$\nW_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} (\\sqrt{2}a \\sqrt{\\pi}) = \\sqrt{2a} \\pi^{1/4} e^{i\\omega_0 b/a}\n$$\n因此，其模为 $|W_{x}(a,b)| = \\sqrt{2a} \\pi^{1/4}$。\n\n现在我们在相同的条件 $f_{0} = \\omega_{0}/(2\\pi a)$ 下，计算在区间 $[0, T]$ 上的观测CWT $\\widetilde{W}_{x}(a,b)$：\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt\n$$\n使用相同的代换 $v = (t-b)/(\\sqrt{2}a)$，$v$ 的积分限变为 $v_{lower} = -b/(\\sqrt{2}a)$ 和 $v_{upper} = (T-b)/(\\sqrt{2}a)$。\n$$\n\\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt = \\int_{-b/(\\sqrt{2}a)}^{(T-b)/(\\sqrt{2}a)} e^{-v^2} (\\sqrt{2}a \\, dv) = \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) - \\text{erf}\\left(-\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n$$\n\\int_{0}^{T} e^{-(t-b)^2/(2a^2)} \\, dt = \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n将此代入 $\\widetilde{W}_{x}(a,b)$ 的表达式中：\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\pi^{-1/4}}{\\sqrt{a}} e^{i\\omega_0 b/a} \\left( \\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right] \\right)\n$$\n$$\n\\widetilde{W}_{x}(a,b) = \\frac{\\sqrt{2a} \\pi^{1/4}}{2} e^{i\\omega_0 b/a} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n通过取绝对值来找到模。由于 $a>0$, $T>0$，并且对于测试用例 $0 \\le b \\le T$，误差函数的参数为非负，因此方括号中的项是实数且非负。\n$$\n\\left| \\widetilde{W}_{x}(a,b) \\right| = \\frac{\\sqrt{2a} \\pi^{1/4}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n最后，我们计算比率 $B$：\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{\\left| \\widetilde{W}_{x}(a,b) \\right|}{\\left| W_{x}(a,b) \\right|} = \\frac{\\frac{\\sqrt{2a} \\pi^{1/4}}{2} \\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]}{\\sqrt{2a} \\pi^{1/4}}\n$$\n这简化为振幅偏差的最终表达式：\n$$\nB(a,b;T,f_{0},\\omega_{0}) = \\frac{1}{2}\\left[ \\text{erf}\\left(\\frac{T-b}{\\sqrt{2}a}\\right) + \\text{erf}\\left(\\frac{b}{\\sqrt{2}a}\\right) \\right]\n$$\n请注意，在指定的频率条件下，偏差 $B$ 与 $\\omega_0$ 和 $f_0$ 无关。它纯粹是小波的时间支撑（由尺度 $a$ 决定）与其位置 $b$ 相对于信号边界 $[0, T]$ 的几何关系的函数。\n\n提供的代码实现了这个最终的 $B$ 公式，以计算测试套件的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the amplitude bias of the CWT near signal boundaries\n    for a given set of parameters.\n    \"\"\"\n    # Test Suite (T, b, a, omega_0)\n    # T: signal duration in seconds\n    # b: wavelet translation in seconds\n    # a: wavelet scale (dimensionless)\n    # omega_0: wavelet central angular frequency (rad/s)\n    # f_0 is set to omega_0 / (2*pi*a) as per the problem, which simplifies\n    # the bias formula to be independent of f_0 and omega_0.\n    test_cases = [\n        # Case 1: T=10.0, b=0.5, a=0.5, omega_0=6.0\n        (10.0, 0.5, 0.5, 6.0),\n        # Case 2: T=10.0, b=0.0, a=0.5, omega_0=6.0\n        (10.0, 0.0, 0.5, 6.0),\n        # Case 3: T=10.0, b=0.5, a=2.0, omega_0=6.0\n        (10.0, 0.5, 2.0, 6.0),\n        # Case 4: T=10.0, b=5.0, a=1.0, omega_0=6.0\n        (10.0, 5.0, 1.0, 6.0),\n        # Case 5: T=10.0, b=9.5, a=0.5, omega_0=6.0\n        (10.0, 9.5, 0.5, 6.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, b, a, omega_0 = case\n\n        # The derived closed-form expression for the amplitude bias B is:\n        # B = 0.5 * [ erf((T-b)/(sqrt(2)*a)) + erf(b/(sqrt(2)*a)) ]\n        # This formula is valid under the condition f_0 = omega_0 / (2*pi*a),\n        # which isolates boundary effects from frequency mismatch effects.\n\n        arg1 = (T - b) / (np.sqrt(2.0) * a)\n        arg2 = b / (np.sqrt(2.0) * a)\n\n        bias = 0.5 * (erf(arg1) + erf(arg2))\n        results.append(bias)\n\n    # Format the final output as a single line: [r1,r2,r3,r4,r5]\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "母小波形状的选择，特别是其无量纲中心频率参数 $\\omega_0$ 的选择，直接决定了分析对不同持续时间神经事件的敏感度。本练习将挑战您通过解析推导，确定最优的 $\\omega_0$ 值，以最大化CWT对一个已知时长的瞬态振荡的响应，从而深刻揭示小波分析中固有的时频分辨率权衡。通过解决这个问题，您将能够更直观地理解如何调整小波参数，使其对特定的神经生理现象（例如，短暂的伽马爆发与持续的阿尔法节律）最为敏感 。",
            "id": "4198724",
            "problem": "您正在使用连续小波变换（CWT）分析局部场电位记录中的一个瞬态窄带神经振荡爆发。该振荡可以建模为一个以 $b_{0}$ 为中心的具有矩形时间支持的复正弦信号：$x(t) = A \\exp\\!\\big(i\\,2\\pi f\\,t\\big)\\,w(t)$，其中当 $|t-b_{0}| \\leq T/2$ 时 $w(t) = 1$，否则 $w(t) = 0$，$A$ 是恒定振幅，$f$ 是振荡频率，$T$ 是爆发的持续时间。您使用如下定义的CWT来分析 $x(t)$：\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}}\\int_{-\\infty}^{\\infty} x(t)\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt,\n$$\n其中 $\\psi(t)$ 是复Morlet小波（CMW）母小波，$\\psi(t) = \\pi^{-1/4}\\,\\exp\\!\\big(i\\,\\omega_{0}\\,t\\big)\\,\\exp\\!\\big(-t^{2}/2\\big)$，$\\omega_{0}$ 是母小波的无量纲中心频率，${}^{*}$ 表示复共轭。假设容许性校正可以忽略不计（当 $\\omega_{0}$ 足够大时成立），并且分析在振荡时间 $b=b_{0}$ 和匹配尺度下进行，该尺度使小波的中心频率与振荡对齐，即选择尺度 $a$ 以使尺度化小波的中心角频率等于 $2\\pi f$。在这些条件下，从第一性原理出发，推导出一个选择 $\\omega_{0}$ 的解析判据，以最大化CWT系数的模的平方 $|W_{x}(a,b)|^{2}$ 的可检测性，并以 $f$ 和 $T$ 的单个闭式表达式形式给出最优的 $\\omega_{0}$。将最终答案表示为一个无量纲数乘以 $fT$ 的形式，并将数值系数四舍五入到四位有效数字。清晰地陈述您使用的任何中间定义，并使用CWT定义和CMW形式所隐含的小波响应来解析地证明您的选择。",
            "solution": "用户希望找到复Morlet小波（CMW）的最优无量纲中心频率 $\\omega_0$，以最大化瞬态神经振荡的可检测性。可检测性定义为连续小波变换（CWT）系数的模的平方，即 $|W_x(a,b)|^2$。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件**\n-   信号模型：$x(t) = A \\exp(i\\,2\\pi f\\,t)\\,w(t)$，其中 $A$ 是恒定振幅，$f$ 是振荡频率。\n-   时间窗口：当 $|t-b_0| \\leq T/2$ 时 $w(t) = 1$，否则 $w(t) = 0$。$T$ 是持续时间，$b_0$ 是中心时间。\n-   CWT定义：$W_{x}(a,b) = \\frac{1}{\\sqrt{a}}\\int_{-\\infty}^{\\infty} x(t)\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt$。\n-   母小波：复Morlet小波（CMW），$\\psi(t) = \\pi^{-1/4}\\,\\exp(i\\,\\omega_0\\,t)\\,\\exp(-t^2/2)$，其中 $\\omega_0$ 是无量纲中心频率。\n-   分析条件：CWT在时间 $b=b_0$ 和匹配尺度 $a$ 下进行评估，在该尺度下，尺度化小波的中心角频率等于信号的角频率 $2\\pi f$。\n-   目标：推导一个选择 $\\omega_0$ 的解析判据，以最大化 $|W_x(a,b_0)|^2$，并以 $k \\cdot fT$ 的形式给出最优 $\\omega_0$ 的表达式，其中 $k$ 四舍五入到四位有效数字。\n\n**1.2. 使用提取的已知条件进行验证**\n-   **科学基础**：该问题在科学上是合理的。它采用了CWT、复Morlet小波和神经爆发的规范模型的标准定义。该问题探讨了时频分析中的一个基本权衡，这是信号处理及其应用（包括神经科学）中的一个核心概念。\n-   **适定性**：该问题是适定的。目标是在明确指定的约束条件下，相对于单个参数 $\\omega_0$ 最大化一个明确定义的数学函数 $|W_x(a,b_0)|^2$。所有必要的组件都已提供，可以用来构建和解决该优化问题。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观因素。\n\n**1.3. 结论与行动**\n该问题是有效的。这是一个信号处理中标准的、尽管不平凡的优化问题。可以进行求解过程。\n\n### 第2步：求解推导\n\n信号 $x(t)$ 在给定尺度 $a$ 和时间 $b$ 的CWT系数为：\n$$\nW_{x}(a,b) = \\frac{1}{\\sqrt{a}}\\int_{-\\infty}^{\\infty} x(t)\\,\\psi^{*}\\!\\left(\\frac{t-b}{a}\\right)\\,dt\n$$\n信号仅在 $t \\in [b_0 - T/2, b_0 + T/2]$ 时非零。CMW的复共轭为：\n$$\n\\psi^{*}(t) = \\pi^{-1/4}\\,\\exp(-i\\,\\omega_0\\,t)\\,\\exp(-t^2/2)\n$$\n根据要求，我们在 $b=b_0$ 处评估CWT：\n$$\nW_{x}(a,b_0) = \\frac{1}{\\sqrt{a}}\\int_{b_0-T/2}^{b_0+T/2} A \\exp(i\\,2\\pi f t) \\left[ \\pi^{-1/4}\\,\\exp\\left(-i\\,\\omega_0\\,\\frac{t-b_0}{a}\\right)\\,\\exp\\left(-\\frac{1}{2}\\left(\\frac{t-b_0}{a}\\right)^2\\right) \\right] dt\n$$\n接下来，我们应用匹配尺度条件。尺度化小波 $\\psi((t-b)/a)$ 的中心角频率是 $\\omega_0/a$。这必须与信号的角频率 $2\\pi f$ 相匹配。\n$$\n\\frac{\\omega_0}{a} = 2\\pi f \\implies a = \\frac{\\omega_0}{2\\pi f}\n$$\n将此条件代入CWT积分：\n$$\nW_{x}(a,b_0) = \\frac{A\\pi^{-1/4}}{\\sqrt{a}}\\int_{b_0-T/2}^{b_0+T/2} \\exp(i\\,2\\pi f t) \\exp\\left(-i\\,(2\\pi f)(t-b_0)\\right)\\exp\\left(-\\frac{(t-b_0)^2}{2a^2}\\right) dt\n$$\n被积函数中的振荡项简化为：\n$$\n\\exp(i\\,2\\pi f t) \\exp(-i\\,2\\pi f t + i\\,2\\pi fb_0) = \\exp(i\\,2\\pi fb_0)\n$$\n由于 $\\exp(i\\,2\\pi fb_0)$ 相对于积分变量 $t$ 是一个常数，可以将其移到积分外：\n$$\nW_{x}(a,b_0) = \\frac{A\\pi^{-1/4}\\exp(i\\,2\\pi fb_0)}{\\sqrt{a}} \\int_{b_0-T/2}^{b_0+T/2} \\exp\\left(-\\frac{(t-b_0)^2}{2a^2}\\right) dt\n$$\n为了计算剩余的积分，我们进行变量替换。令 $u = t - b_0$，则 $du = dt$。积分限变为 $u = -T/2$ 到 $u = T/2$：\n$$\n\\int_{-T/2}^{T/2} \\exp\\left(-\\frac{u^2}{2a^2}\\right) du\n$$\n这个积分与误差函数 $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z \\exp(-y^2)dy$ 相关。令 $y = \\frac{u}{\\sqrt{2}a}$，这意味着 $du = \\sqrt{2}a\\,dy$。积分限变为 $y = \\mp \\frac{T}{2\\sqrt{2}a}$。\n$$\n\\int_{-T/(2\\sqrt{2}a)}^{T/(2\\sqrt{2}a)} \\exp(-y^2) \\sqrt{2}a\\,dy = \\sqrt{2}a \\left[ \\frac{\\sqrt{\\pi}}{2} \\text{erf}(y) \\right]_{-T/(2\\sqrt{2}a)}^{T/(2\\sqrt{2}a)}\n$$\n使用性质 $\\text{erf}(-z) = -\\text{erf}(z)$，此式可计算为：\n$$\n\\sqrt{2}a \\frac{\\sqrt{\\pi}}{2} \\left( \\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right) - \\text{erf}\\left(-\\frac{T}{2\\sqrt{2}a}\\right) \\right) = \\sqrt{2\\pi}a\\,\\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right)\n$$\n将此结果代回 $W_x(a,b_0)$ 的表达式中：\n$$\nW_{x}(a,b_0) = \\frac{A\\pi^{-1/4}\\exp(i\\,2\\pi fb_0)}{\\sqrt{a}} \\left( \\sqrt{2\\pi}a\\,\\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right) \\right) = A\\sqrt{2}\\pi^{1/4}\\sqrt{a} \\exp(i\\,2\\pi fb_0) \\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right)\n$$\n我们要最大化的是模的平方 $|W_x(a,b_0)|^2$。项 $\\exp(i\\,2\\pi fb_0)$ 的模为1。\n$$\n|W_x(a,b_0)|^2 = |A|^2 (2\\sqrt{\\pi}) a \\left[ \\text{erf}\\left(\\frac{T}{2\\sqrt{2}a}\\right) \\right]^2\n$$\n为了找到最优的 $\\omega_0$，我们通过代入 $a = \\frac{\\omega_0}{2\\pi f}$ 将此量表示为 $\\omega_0$ 的函数：\n$$\n|W_x(a,b_0)|^2 = |A|^2 (2\\sqrt{\\pi}) \\left(\\frac{\\omega_0}{2\\pi f}\\right) \\left[ \\text{erf}\\left(\\frac{T}{2\\sqrt{2}(\\omega_0/2\\pi f)}\\right) \\right]^2 = \\frac{|A|^2}{\\sqrt{\\pi}f} \\omega_0 \\left[ \\text{erf}\\left(\\frac{\\pi f T}{\\sqrt{2}\\omega_0}\\right) \\right]^2\n$$\n为了对 $\\omega_0$ 最大化此表达式，我们只需考虑依赖于 $\\omega_0$ 的项。设 $g(\\omega_0)$ 为这部分：\n$$\ng(\\omega_0) = \\omega_0 \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\right]^2, \\quad \\text{其中 } C = \\frac{\\pi f T}{\\sqrt{2}}\n$$\n我们通过将导数 $g'(\\omega_0)$ 设为零来找到最大值。使用乘法法则和链式法则：\n$$\ng'(\\omega_0) = \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\right]^2 + \\omega_0 \\cdot 2\\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\cdot \\frac{d}{d\\omega_0}\\left[\\text{erf}\\left(\\frac{C}{\\omega_0}\\right)\\right]\n$$\n误差函数的导数是 $\\frac{d}{dz}\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\exp(-z^2)$。\n$$\n\\frac{d}{d\\omega_0}\\left[\\text{erf}\\left(\\frac{C}{\\omega_0}\\right)\\right] = \\frac{2}{\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right) \\cdot \\left(-\\frac{C}{\\omega_0^2}\\right)\n$$\n将此代回 $g'(\\omega_0)$：\n$$\ng'(\\omega_0) = \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\right]^2 - \\frac{4C}{\\omega_0\\sqrt{\\pi}}\\text{erf}\\left(\\frac{C}{\\omega_0}\\right)\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right)\n$$\n令 $g'(\\omega_0) = 0$ 可得：\n$$\n\\text{erf}\\left(\\frac{C}{\\omega_0}\\right) \\left[ \\text{erf}\\left(\\frac{C}{\\omega_0}\\right) - \\frac{4C}{\\omega_0\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right) \\right] = 0\n$$\n如果 $\\text{erf}(C/\\omega_0) = 0$，该方程有一个平凡解，这意味着 $C=0$ 或 $\\omega_0 \\to \\infty$。这对应于一个最小值。非平凡解，即给出最大值的解，是通过将括号中的项设为零得到的。这提供了解析判据：\n$$\n\\text{erf}\\left(\\frac{C}{\\omega_0}\\right) = \\frac{4C}{\\omega_0\\sqrt{\\pi}}\\exp\\left(-\\left(\\frac{C}{\\omega_0}\\right)^2\\right)\n$$\n令 $z_{opt} = \\frac{C}{\\omega_{0, opt}} = \\frac{\\pi f T}{\\sqrt{2}\\omega_{0, opt}}$，其中 $\\omega_{0,opt}$ 是 $\\omega_0$ 的最优值。$z_{opt}$ 的判据是一个超越方程：\n$$\n\\text{erf}(z_{opt}) = \\frac{4z_{opt}}{\\sqrt{\\pi}}\\exp(-z_{opt}^2)\n$$\n该方程必须进行数值求解。一个数值求根算法得出解：\n$$\nz_{opt} \\approx 0.98986\n$$\n现在我们可以解出最优的 $\\omega_0$：\n$$\n\\omega_{0, opt} = \\frac{\\pi f T}{\\sqrt{2}z_{opt}} = \\left( \\frac{\\pi}{\\sqrt{2}z_{opt}} \\right) fT\n$$\n我们计算无量纲系数 $k = \\frac{\\pi}{\\sqrt{2}z_{opt}}$：\n$$\nk = \\frac{\\pi}{\\sqrt{2} \\cdot 0.98986} \\approx \\frac{3.14159}{1.41421 \\cdot 0.98986} \\approx \\frac{3.14159}{1.39985} \\approx 2.244249\n$$\n按要求将该系数四舍五入到四位有效数字，得到 $k=2.244$。\n因此，最优的无量纲中心频率是：\n$$\n\\omega_{0, opt} = 2.244 fT\n$$",
            "answer": "$$\n\\boxed{2.244 fT}\n$$"
        }
    ]
}