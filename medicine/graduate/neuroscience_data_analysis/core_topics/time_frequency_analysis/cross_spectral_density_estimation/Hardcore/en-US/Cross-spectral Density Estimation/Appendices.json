{
    "hands_on_practices": [
        {
            "introduction": "A primary goal in spectral estimation is to obtain a stable estimate with low variance. This practice grounds your understanding of how variance is controlled in modern spectral analysis by combining two powerful techniques: averaging across repeated experimental trials and using multiple tapers within each trial . By deriving the variance of this combined estimator, you will formally prove how the total number of independent spectral samples, from both trials and tapers, directly governs the precision of your cross-spectral density estimate.",
            "id": "4151873",
            "problem": "Consider a repeated-stimulus experiment in which simultaneous Local Field Potential (LFP) recordings $x(t)$ and $y(t)$ are made from two cortical sites over $T$ independent trials, each of duration sufficiently long that the processes can be treated as stationary within-trial. For each trial, you compute $K$ tapered Fourier transforms at frequency $f$ using orthonormal Discrete Prolate Spheroidal Sequences (DPSS) with time-bandwidth product $NW$, yielding $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ for $t \\in \\{1,\\dots,T\\}$ and $k \\in \\{1,\\dots,K\\}$. Assume the following modeling assumptions, which are standard in spectral analysis of Gaussian stationary processes and hold to high accuracy for DPSS multitapering:\n- Across trials and tapers, the complex Fourier coefficients $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ are independent and identically distributed proper complex Gaussian random vectors with mean zero and spectral covariance matrix at frequency $f$ given by\n$$\n\\mathbf{S}(f) \\equiv \\begin{pmatrix}\nS_{xx}(f)  S_{xy}(f) \\\\\nS_{xy}^*(f)  S_{yy}(f)\n\\end{pmatrix},\n$$\nso that $E[F_{x}^{(t,k)}(f)\\,{F_{x}^{(t,k)}(f)}^*] = S_{xx}(f)$, $E[F_{y}^{(t,k)}(f)\\,{F_{y}^{(t,k)}(f)}^*] = S_{yy}(f)$, and $E[F_{x}^{(t,k)}(f)\\,{F_{y}^{(t,k)}(f)}^*] = S_{xy}(f)$, with all improper moments (e.g., $E[F_{x}^{(t,k)}(f)\\,F_{y}^{(t,k)}(f)]$) equal to $0$.\n- The orthonormality and spectral concentration of the $K$ DPSS imply that different tapers within a trial produce effectively independent, identically distributed estimates at the target frequency $f$.\n\nDefine the multitaper, trial-averaged cross-spectral density estimator at frequency $f$ by\n$$\n\\hat{S}_{xy}(f) \\equiv \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} F_{x}^{(t,k)}(f)\\,{F_{y}^{(t,k)}(f)}^*.\n$$\nStarting from the definition of cross-spectral density as an expectation and using only the above independence and proper complex Gaussian assumptions, derive a closed-form analytic expression for the mean-square variance of the complex estimator,\n$$\n\\mathrm{Var}\\!\\left[\\hat{S}_{xy}(f)\\right] \\equiv E\\!\\left[\\,\\left|\\hat{S}_{xy}(f) - S_{xy}(f)\\right|^{2}\\right],\n$$\nexplicitly exhibiting how the variance reduction arises jointly from the number of trials $T$ and the number of tapers $K$.\n\nAnswer specification:\n- Provide your final answer as a single symbolic expression in terms of $S_{xx}(f)$, $S_{yy}(f)$, $K$, and $T$.\n- No numerical approximation or rounding is required.\n- Do not include units.",
            "solution": "The problem asks for the derivation of the mean-square variance of the multitaper, trial-averaged cross-spectral density estimator, $\\hat{S}_{xy}(f)$. The variance of a complex random variable $Z$ is defined as $\\mathrm{Var}[Z] \\equiv E\\left[|Z - E[Z]|^2\\right]$.\n\nThe estimator is defined as:\n$$\n\\hat{S}_{xy}(f) \\equiv \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} F_{x}^{(t,k)}(f)\\,{F_{y}^{(t,k)}(f)}^*\n$$\nLet us define an individual cross-spectral estimate from taper $k$ of trial $t$ as the complex random variable $Z_{t,k}$:\n$$\nZ_{t,k} = F_{x}^{(t,k)}(f)\\,{F_{y}^{(t,k)}(f)}^*\n$$\nThe estimator can then be written as the sample mean of these $KT$ individual estimates:\n$$\n\\hat{S}_{xy}(f) = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} Z_{t,k}\n$$\nAccording to the problem statement, the complex Fourier coefficients $\\{F_{x}^{(t,k)}(f), F_{y}^{(t,k)}(f)\\}$ are independent and identically distributed (i.i.d.) across all trials $t \\in \\{1, \\dots, T\\}$ and tapers $k \\in \\{1, \\dots, K\\}$. Consequently, the variables $Z_{t,k}$ are also i.i.d. for all pairs $(t,k)$.\n\nFirst, we determine if the estimator is biased. We compute its expectation by leveraging the linearity of the expectation operator:\n$$\nE[\\hat{S}_{xy}(f)] = E\\left[\\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} Z_{t,k}\\right] = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} E[Z_{t,k}]\n$$\nThe expectation of each individual estimate $Z_{t,k}$ is, by definition, the true cross-spectral density $S_{xy}(f)$:\n$$\nE[Z_{t,k}] = E\\left[F_{x}^{(t,k)}(f)\\,{F_{y}^{(t,k)}(f)}^*\\right] = S_{xy}(f)\n$$\nSince this expectation is the same for all $(t,k)$, we have:\n$$\nE[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\sum_{t=1}^{T} \\sum_{k=1}^{K} S_{xy}(f) = \\frac{1}{KT} (KT) S_{xy}(f) = S_{xy}(f)\n$$\nThe estimator $\\hat{S}_{xy}(f)$ is unbiased. Therefore, the mean-square variance defined in the problem, $E\\left[\\,|\\hat{S}_{xy}(f) - S_{xy}(f)|^{2}\\right]$, simplifies to the variance of the estimator, $\\mathrm{Var}[\\hat{S}_{xy}(f)]$.\n\nFor a sample mean of $N$ i.i.d. random variables $X_i$, the variance of the mean is $\\mathrm{Var}[\\frac{1}{N}\\sum X_i] = \\frac{1}{N^2} \\sum \\mathrm{Var}[X_i] = \\frac{N}{N^2}\\mathrm{Var}[X_1] = \\frac{1}{N}\\mathrm{Var}[X_1]$. Applying this principle to our estimator, which is the mean of $KT$ i.i.d. variables $Z_{t,k}$, its variance is:\n$$\n\\mathrm{Var}[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\mathrm{Var}[Z_{t,k}]\n$$\nWe now need to calculate the variance of a single estimate $Z_{t,k}$. For simplicity, we drop the indices $(t,k)$ and denote the Fourier coefficients as $X = F_{x}(f)$ and $Y = F_{y}(f)$, so $Z = X Y^*$. The variance is given by:\n$$\n\\mathrm{Var}[Z] = E[|Z|^2] - |E[Z]|^2\n$$\nWe have already established that $|E[Z]|^2 = |S_{xy}(f)|^2$. We now compute $E[|Z|^2]$:\n$$\nE[|Z|^2] = E\\left[|X Y^*|^2\\right] = E\\left[|X|^2 |Y^*|^2\\right] = E\\left[|X|^2 |Y|^2\\right] = E[(X X^*)(Y Y^*)]\n$$\nTo evaluate this fourth-order moment, we use Isserlis' theorem (also known as Wick's theorem) for zero-mean complex Gaussian random variables. For four such variables $W_1, W_2, W_3, W_4$, the expectation of their product is:\n$$\nE[W_1 W_2 W_3 W_4] = E[W_1 W_2]E[W_3 W_4] + E[W_1 W_3]E[W_2 W_4] + E[W_1 W_4]E[W_2 W_3]\n$$\nIn our case, the variables are $W_1 = X$, $W_2 = X^*$, $W_3 = Y$, and $W_4 = Y^*$. Substituting these into the formula yields:\n$$\nE[X X^* Y Y^*] = E[X X^*]E[Y Y^*] + E[XY]E[X^* Y^*] + E[X Y^*]E[X^* Y]\n$$\nFrom the problem statement, we have the following expectations:\n- $E[X X^*] = S_{xx}(f)$\n- $E[Y Y^*] = S_{yy}(f)$\n- $E[X Y^*] = S_{xy}(f)$\n- $E[X^* Y] = (E[X Y^*])^* = S_{xy}^*(f)$\n- $E[XY] = 0$ and $E[X^* Y^*] = (E[XY])^* = 0$, as all improper moments are zero for proper complex Gaussian variables.\n\nSubstituting these values into the expression for the fourth-order moment:\n$$\nE[|Z|^2] = E[X X^* Y Y^*] = (S_{xx}(f))(S_{yy}(f)) + (0)(0) + (S_{xy}(f))(S_{xy}^*(f))\n$$\n$$\nE[|Z|^2] = S_{xx}(f)S_{yy}(f) + |S_{xy}(f)|^2\n$$\nNow, we can compute the variance of a single estimate $Z$:\n$$\n\\mathrm{Var}[Z] = E[|Z|^2] - |E[Z]|^2 = \\left(S_{xx}(f)S_{yy}(f) + |S_{xy}(f)|^2\\right) - |S_{xy}(f)|^2\n$$\n$$\n\\mathrm{Var}[Z] = S_{xx}(f)S_{yy}(f)\n$$\nFinally, we substitute this result back into the expression for the variance of the estimator $\\hat{S}_{xy}(f)$:\n$$\n\\mathrm{Var}[\\hat{S}_{xy}(f)] = \\frac{1}{KT} \\mathrm{Var}[Z] = \\frac{1}{KT} S_{xx}(f)S_{yy}(f)\n$$\nThis expression demonstrates that the variance of the cross-spectral estimator is inversely proportional to the total number of independent estimates, which is the product of the number of trials $T$ and the number of tapers $K$. This reduction in variance is the principal motivation for using multitapering and trial-averaging in spectral analysis. The final result depends on the auto-spectral densities of the two signals and is independent of the true cross-spectral density.",
            "answer": "$$\n\\boxed{\\frac{S_{xx}(f) S_{yy}(f)}{KT}}\n$$"
        },
        {
            "introduction": "Data preprocessing steps are essential, but they are never truly neutral; each one acts as a filter that can alter your data. A common step, removing the mean from each data segment, is often used to mitigate slow drifts but can introduce its own artifacts, especially at low frequencies . This exercise challenges you to treat mean-subtraction as a linear filter and derive its frequency response, revealing precisely how it attenuates power and cross-spectral density near $f=0$.",
            "id": "4151802",
            "problem": "Consider two jointly wide-sense stationary neural time series $x[n]$ and $y[n]$ sampled at interval $\\Delta t$, with true cross-spectral density (CSD) $S_{xy}(f)$ that is slowly varying near $f=0$. You estimate the CSD using $L$-point, non-overlapping, rectangular segments as follows: for each segment, subtract the sample mean from each series, compute the $L$-point discrete Fourier transform, form the cross-periodogram, and finally average across segments. Assume $L$ is large and that edge effects from segmentation can be neglected for frequencies $|f| \\ll \\frac{1}{L \\Delta t}$. Use only the following fundamental bases: (i) the definition of CSD as the Fourier transform of the cross-covariance, (ii) the linear systems fact that passing both signals through the same linear time-invariant filter with frequency response $H(\\omega)$ multiplies the CSD by $|H(\\omega)|^{2}$, and (iii) the discrete-time Fourier transform of a length-$L$ rectangular sequence.\n\nTreat per-segment mean removal as an operator that, in the large-$L$ and low-frequency regime stated above, is equivalent to passing the data through a finite impulse response filter prior to segmentation. Starting from the fundamental bases, derive the leading-order low-frequency multiplicative attenuation factor $A(f)$ such that the expected detrended CSD estimate satisfies\n$$\n\\mathbb{E}\\!\\left[\\hat{S}_{xy}^{(\\mathrm{detrend})}(f)\\right] \\approx A(f)\\, S_{xy}(f)\n$$\nfor $|f| \\ll \\frac{1}{L \\Delta t}$. Your derivation must begin from the stated bases and proceed logically to an asymptotic expression for $A(f)$ to the first nonzero order in $f$ in terms of $L$, $f$, and $\\Delta t$. Provide your final answer as a single closed-form analytic expression for $A(f)$; do not compute any numerical value. No rounding is required, and no units should appear in the final boxed expression.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It frames a standard problem in spectral analysis within a clear set of constraints and asks for a rigorous derivation based on fundamental principles. I will therefore proceed with the solution.\n\nThe objective is to derive the low-frequency attenuation factor $A(f)$ affecting the cross-spectral density (CSD) estimate when per-segment mean subtraction is performed. The problem states that for large segment length $L$ and in the low-frequency regime $|f| \\ll \\frac{1}{L \\Delta t}$, this operation is equivalent to passing the data through a linear time-invariant (LTI) filter. Our first step is to characterize this filter.\n\nLet a data segment of a time series be denoted by $x[n]$ for $n \\in \\{0, 1, \\dots, L-1\\}$. The operation of mean subtraction produces a new segment $x'[n]$:\n$$\nx'[n] = x[n] - \\bar{x} = x[n] - \\frac{1}{L}\\sum_{k=0}^{L-1} x[k]\n$$\nThis operation can be described by an impulse response $h[n]$. The output $x'[n]$ is the result of the convolution of the input $x[n]$ with $h[n]$. Observing the structure of the operation, we can identify $h[n]$ as:\n$$\nh[n] = \\delta[n] - \\frac{1}{L}\\mathbf{1}_{[0, L-1]}[n]\n$$\nwhere $\\delta[n]$ is the Kronecker delta function and $\\mathbf{1}_{[0, L-1]}[n]$ is a rectangular window of length $L$, equal to $1$ for $n \\in \\{0, 1, \\dots, L-1\\}$ and $0$ otherwise.\n\nThe next step, following the problem's directive, is to find the frequency response $H(f)$ of this filter. $H(f)$ is the discrete-time Fourier transform (DTFT) of $h[n]$. Let $\\omega = 2\\pi f \\Delta t$ be the normalized angular frequency.\n$$\nH(f) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-i\\omega n) = \\mathcal{F}\\{\\delta[n]\\} - \\frac{1}{L}\\mathcal{F}\\{\\mathbf{1}_{[0, L-1]}[n]\\}\n$$\nThe DTFT of the delta function is $1$. The DTFT of the rectangular window is a standard result, given by basis (iii):\n$$\n\\mathcal{F}\\{\\mathbf{1}_{[0, L-1]}[n]\\} = \\sum_{n=0}^{L-1} \\exp(-i\\omega n)\n$$\nThis is a finite geometric series. Its sum, for $\\omega \\neq 0$, is $\\frac{1-\\exp(-i\\omega L)}{1-\\exp(-i\\omega)}$. At $\\omega=0$, the sum is plainly $L$.\n\nThus, the frequency response is:\n$$\nH(f) = 1 - \\frac{1}{L} \\sum_{n=0}^{L-1} \\exp(-i\\omega n)\n$$\nAccording to basis (ii), when both signals $x[n]$ and $y[n]$ are passed through this same filter, the resulting CSD is multiplied by the factor $|H(f)|^2$. Therefore, the attenuation factor $A(f)$ is given by $A(f) = |H(f)|^2$. We are asked to find the leading-order low-frequency behavior of $A(f)$. This necessitates a Taylor series expansion of $H(f)$ for small $\\omega$.\n\nFor small $\\omega$, we expand the exponential term $\\exp(-i\\omega n)$:\n$$\n\\exp(-i\\omega n) \\approx 1 - i\\omega n - \\frac{(\\omega n)^2}{2}\n$$\nWe substitute this into the sum:\n$$\n\\sum_{n=0}^{L-1} \\exp(-i\\omega n) \\approx \\sum_{n=0}^{L-1} \\left(1 - i\\omega n - \\frac{\\omega^2 n^2}{2}\\right) = \\sum_{n=0}^{L-1} 1 - i\\omega \\sum_{n=0}^{L-1} n - \\frac{\\omega^2}{2} \\sum_{n=0}^{L-1} n^2\n$$\nUsing the standard formulas for sums of powers:\n$\\sum_{n=0}^{L-1} 1 = L$\n$\\sum_{n=0}^{L-1} n = \\frac{(L-1)L}{2}$\n$\\sum_{n=0}^{L-1} n^2 = \\frac{(L-1)L(2L-1)}{6}$\n\nThe sum becomes:\n$$\n\\sum_{n=0}^{L-1} \\exp(-i\\omega n) \\approx L - i\\omega \\frac{L(L-1)}{2} - \\frac{\\omega^2}{2} \\frac{L(L-1)(2L-1)}{6}\n$$\nNow, substitute this back into the expression for $H(f)$:\n$$\nH(f) \\approx 1 - \\frac{1}{L} \\left[ L - i\\omega \\frac{L(L-1)}{2} - \\omega^2 \\frac{L(L-1)(2L-1)}{12} \\right]\n$$\n$$\nH(f) \\approx 1 - \\left[ 1 - i\\omega \\frac{L-1}{2} - \\omega^2 \\frac{(L-1)(2L-1)}{12} \\right]\n$$\n$$\nH(f) \\approx i\\omega \\frac{L-1}{2} + \\omega^2 \\frac{(L-1)(2L-1)}{12}\n$$\nAt frequency $f=0$ ($\\omega=0$), $H(0)=0$, which is correct as mean subtraction removes the DC component completely. The leading-order term for small, non-zero $\\omega$ is the imaginary term, which is of order $\\omega$.\n\nThe attenuation factor is $A(f) = |H(f)|^2$. For a complex number $z = a+ib$, $|z|^2 = a^2+b^2$. In our case, the real part is of order $\\omega^2$ and the imaginary part is of order $\\omega$.\n$$\nA(f) = \\left| i\\omega \\frac{L-1}{2} + \\omega^2 \\frac{(L-1)(2L-1)}{12} \\right|^2 = \\left(\\omega^2 \\frac{(L-1)(2L-1)}{12}\\right)^2 + \\left(\\omega \\frac{L-1}{2}\\right)^2\n$$\nThe first term is of order $\\omega^4$ and the second is of order $\\omega^2$. The problem asks for the leading-order non-zero term, which is the $\\omega^2$ term.\n$$\nA(f) \\approx \\left(\\omega \\frac{L-1}{2}\\right)^2\n$$\nFinally, we substitute $\\omega = 2\\pi f \\Delta t$ to express the result in the requested variables:\n$$\nA(f) \\approx \\left( (2\\pi f \\Delta t) \\frac{L-1}{2} \\right)^2 = (\\pi (L-1) f \\Delta t)^2\n$$\nThis is the asymptotic expression for the multiplicative attenuation factor for $|f| \\ll \\frac{1}{L \\Delta t}$, derived from the specified fundamental bases.",
            "answer": "$$\n\\boxed{(\\pi (L-1) f \\Delta t)^{2}}\n$$"
        },
        {
            "introduction": "In electrophysiology, all voltage is measured as a potential difference, making the choice of reference electrode a critical and often problematic aspect of experimental design. A seemingly innocuous reference can introduce widespread, spurious coherence that can be mistaken for genuine neural interaction . This problem explores the mechanisms of reference contamination and tests your knowledge of advanced strategies, such as using the imaginary part of coherency or the surface Laplacian, to obtain more robust and interpretable connectivity estimates.",
            "id": "4151847",
            "problem": "An investigator analyzes Electroencephalography (EEG) recordings from a healthy participant with a high-density montage of $N=64$ channels, focusing on two occipital electrodes, denoted $x(t)$ for $\\mathrm{O1}$ and $y(t)$ for $\\mathrm{O2}$. The goal is to estimate the cross-spectral density $S_{xy}(f)$ in the alpha band around $f \\approx 10\\,\\mathrm{Hz}$ for two different re-referencing schemes: linked mastoids and average reference. Under linked mastoids, the reference is $r_{\\mathrm{LM}}(t) = \\left(m_{1}(t) + m_{2}(t)\\right)/2$, where $m_{1}(t)$ and $m_{2}(t)$ are mastoid signals. Under average reference, the reference is $r_{\\mathrm{AR}}(t) = \\frac{1}{N}\\sum_{k=1}^{N} v_{k}(t)$, where $v_{k}(t)$ are the scalp channel potentials. Empirically, the mastoids exhibit non-negligible alpha power due to volume conduction, and the average reference includes contributions from $\\mathrm{O1}$, $\\mathrm{O2}$, and other channels.\n\nAssume that within the analysis window, all processes are wide-sense stationary, re-referencing is performed by subtraction of the chosen reference from each channel, and $S_{xy}(f)$ is computed from the re-referenced signals using a consistent spectral estimator. Based on first principles of linear transformations of signals and the definition of cross-spectral density, which statements about how reference choice alters $S_{xy}(f)$ between $\\mathrm{O1}$ and $\\mathrm{O2}$ and strategies to minimize spurious coherence are most accurate? Select all that apply.\n\nA. Because both $\\mathrm{O1}$ and $\\mathrm{O2}$ share the same linked mastoid reference, the cross-spectral density between the re-referenced signals contains an additive contribution from the mastoid signal even if $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, which can inflate apparent coherence near $f\\approx 10\\,\\mathrm{Hz}$.\n\nB. With a high-density montage and average reference, the common reference term cancels to first order across channels, so if the original $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, $S_{xy}(f)$ for the re-referenced signals tends toward $0$ as $N$ grows, thereby reducing spurious coherence.\n\nC. Linear re-referencing leaves $S_{xy}(f)$ invariant, hence reference choice cannot change coherence between channels.\n\nD. Computing the imaginary part of coherency derived from $S_{xy}(f)$ suppresses zero-phase inflation due to common reference and volume conduction, thereby reducing spurious coherence estimates.\n\nE. Applying the surface Laplacian, also called current source density (CSD), as a linear spatial transform before spectral estimation reduces shared low-spatial-frequency components and thus lowers spurious zero-lag cross-spectral power between occipital channels.\n\nF. Increasing the number of averages in Welch’s method alone eliminates bias from common reference in $S_{xy}(f)$.",
            "solution": "The problem asks to evaluate statements about the effect of re-referencing on the cross-spectral density ($S_{xy}(f)$) between two EEG channels (O1 and O2) and strategies to mitigate resulting artifacts. The core of the analysis rests on understanding how subtracting a common reference signal modifies the spectral properties of the signals.\n\nLet the EEG potentials at O1 and O2 be denoted by $v_x(t)$ and $v_y(t)$, respectively. Let $r(t)$ be the reference signal. The re-referenced signals, $x'(t)$ and $y'(t)$, are given by:\n$$x'(t) = v_x(t) - r(t)$$\n$$y'(t) = v_y(t) - r(t)$$\nAll signals are assumed to be wide-sense stationary. The cross-spectral density (CSD) is the Fourier transform of the cross-correlation function. The cross-correlation of the re-referenced signals is:\n$$R_{x'y'}(\\tau) = E[x'(t) y'(t+\\tau)] = E[(v_x(t) - r(t))(v_y(t+\\tau) - r(t+\\tau))]$$\nExpanding the product and applying the linearity of expectation yields:\n$$R_{x'y'}(\\tau) = E[v_x(t)v_y(t+\\tau)] - E[v_x(t)r(t+\\tau)] - E[r(t)v_y(t+\\tau)] + E[r(t)r(t+\\tau)]$$\nIn terms of correlation functions, this is:\n$$R_{x'y'}(\\tau) = R_{v_x v_y}(\\tau) - R_{v_x r}(\\tau) - R_{r v_y}(\\tau) + R_{rr}(\\tau)$$\nApplying the Fourier transform to each term gives the CSD of the re-referenced signals, $S_{x'y'}(f)$:\n$$S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$$\nThis equation is the foundation for evaluating the provided statements. $S_{v_x v_y}(f)$ is the CSD of the original signals, while the other three terms represent the influence of the reference. $S_{rr}(f)$ is the power spectral density (PSD) of the reference signal itself.\n\nNow, we evaluate each option:\n\n**A. Because both $\\mathrm{O1}$ and $\\mathrm{O2}$ share the same linked mastoid reference, the cross-spectral density between the re-referenced signals contains an additive contribution from the mastoid signal even if $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, which can inflate apparent coherence near $f\\approx 10\\,\\mathrm{Hz}$.**\n\nThe reference is $r(t) = r_{\\mathrm{LM}}(t)$. The problem states that the mastoids exhibit non-negligible alpha power, meaning $S_{rr}(f) = S_{r_{\\mathrm{LM}} r_{\\mathrm{LM}}}(f)$ is large around $f \\approx 10\\,\\mathrm{Hz}$.\nFrom our derived formula:\n$$S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$$\nIf the original signals $v_x(t)$ and $v_y(t)$ are independent (and assuming zero mean), their cross-spectrum $S_{v_x v_y}(f)$ is zero. The expression for the re-referenced CSD becomes:\n$$S_{x'y'}(f) = - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$$\nThe term $+S_{rr}(f)$ is a direct additive contribution from the reference signal's power. Since $S_{rr}(f)$ is stated to be significant in the alpha band, this term will be non-zero, creating a spurious non-zero CSD between the re-referenced O1 and O2 signals. This spurious CSD inflates the numerator of the coherence calculation, $\\gamma^2(f) = |S_{xy}(f)|^2 / (S_{xx}(f)S_{yy}(f))$, leading to an artificially high coherence estimate. The statement accurately describes this well-known artifact.\n\nVerdict: **Correct**.\n\n**B. With a high-density montage and average reference, the common reference term cancels to first order across channels, so if the original $\\mathrm{O1}$ and $\\mathrm{O2}$ are independent, $S_{xy}(f)$ for the re-referenced signals tends toward $0$ as $N$ grows, thereby reducing spurious coherence.**\n\nThe average reference is $r(t) = r_{\\mathrm{AR}}(t) = \\frac{1}{N}\\sum_{k=1}^{N} v_{k}(t)$. Let's analyze the terms of the CSD formula. Assume the original signals $v_k(t)$ are mutually uncorrelated, each with power spectrum $S_{v_k v_k}(f)$, and $v_x(t) = v_1(t)$, $v_y(t) = v_2(t)$.\nThe power of the reference is $S_{rr}(f) = S_{r_{\\mathrm{AR}} r_{\\mathrm{AR}}}(f) = \\frac{1}{N^2} \\sum_{k=1}^{N} S_{v_k v_k}(f)$.\nThe cross-spectra with the reference are $S_{v_x r}(f) = S_{v_1, \\frac{1}{N}\\sum_k v_k}(f) = \\frac{1}{N}S_{v_1 v_1}(f)$ and $S_{r v_y}(f) = S_{\\frac{1}{N}\\sum_k v_k, v_2}(f) = \\frac{1}{N} S_{v_2 v_2}(f)$ (since $S_{v_k v_j}(f) = 0$ for $k \\ne j$).\nIf the original O1 and O2 are independent, $S_{v_x v_y}(f)=0$. The re-referenced CSD is:\n$$S_{x'y'}(f) = 0 - \\frac{1}{N}S_{v_x v_x}(f) - \\frac{1}{N}S_{v_y v_y}(f) + \\frac{1}{N^2}\\sum_{k=1}^{N} S_{v_k v_k}(f)$$\nLet $\\bar{S}_{vv}(f) = \\frac{1}{N}\\sum_{k=1}^{N} S_{v_k v_k}(f)$ be the average power spectrum. Then:\n$$S_{x'y'}(f) = -\\frac{1}{N}S_{v_x v_x}(f) - \\frac{1}{N}S_{v_y v_y}(f) + \\frac{1}{N}\\bar{S}_{vv}(f) = \\frac{1}{N}\\left(\\bar{S}_{vv}(f) - S_{v_x v_x}(f) - S_{v_y v_y}(f)\\right)$$\nAs the number of channels $N$ becomes large, the term $\\frac{1}{N}$ drives the entire expression towards zero. The average reference $r_{\\mathrm{AR}}(t)$ approaches a stable zero potential (by a law of large numbers argument), so its contaminating effect diminishes. The statement that $S_{xy}(f)$ tends toward $0$ as $N$ grows is accurate.\n\nVerdict: **Correct**.\n\n**C. Linear re-referencing leaves $S_{xy}(f)$ invariant, hence reference choice cannot change coherence between channels.**\n\nAs derived in the preamble, the new CSD is $S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$. For $S_{x'y'}(f)$ to be equal to $S_{v_x v_y}(f)$, the following condition must hold: $-S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f) = 0$. This is not true in general. For almost any active reference $r(t)$ (i.e., $S_{rr}(f) \\ne 0$), the CSD will be altered. The entire premise of the \"reference problem\" in EEG is that the choice of reference *does* alter spectral measures, including CSD and coherence. This statement is fundamentally incorrect.\n\nVerdict: **Incorrect**.\n\n**D. Computing the imaginary part of coherency derived from $S_{xy}(f)$ suppresses zero-phase inflation due to common reference and volume conduction, thereby reducing spurious coherence estimates.**\n\nSpurious correlation from a common reference or volume conduction is typically a zero-phase-lag phenomenon. The contribution of a common reference signal $r(t)$ to the CSD includes the term $S_{rr}(f)$, which is the power spectral density of a real-valued signal. A PSD is always real-valued, so $\\text{Im}\\{S_{rr}(f)\\} = 0$. Similarly, volume conduction is often modeled as an instantaneous mixing of sources, which also contributes a real-valued component to the CSD.\nThe coherency is the complex-valued quantity $\\gamma_{xy}(f) = \\frac{S_{xy}(f)}{\\sqrt{S_{xx}(f) S_{yy}(f)}}$.\nThe imaginary part of the coherency is $\\text{Im}\\{\\gamma_{xy}(f)\\} = \\frac{\\text{Im}\\{S_{xy}(f)\\}}{\\sqrt{S_{xx}(f) S_{yy}(f)}}$.\nBy computing $\\text{Im}\\{S_{xy}(f)\\}$, one isolates the portion of the cross-spectrum corresponding to non-zero phase lags. True neurophysiological interactions often involve propagation delays, leading to a non-zero phase lag and thus a non-zero imaginary part of the CSD. By focusing on this imaginary component, the zero-phase artifacts from common reference and volume conduction are indeed suppressed. This is a recognized technique for obtaining more robust estimates of brain connectivity.\n\nVerdict: **Correct**.\n\n**E. Applying the surface Laplacian, also called current source density (CSD), as a linear spatial transform before spectral estimation reduces shared low-spatial-frequency components and thus lowers spurious zero-lag cross-spectral power between occipital channels.**\n\nThe surface Laplacian is an estimate of the second spatial derivative of the scalp potential field. It acts as a spatial high-pass filter, meaning it attenuates components that are broadly distributed (low spatial frequency) and enhances components that are spatially focal (high spatial frequency).\nA common reference signal affects all channels, creating a very low (zero) spatial frequency component. Similarly, volume conduction from deep or distant sources smears the potential across the scalp, also creating a low spatial frequency signal component shared by many electrodes. The surface Laplacian transform is explicitly designed to combat these effects. By attenuating these shared, widespread signals, it reduces the common signal components between the two occipital channels before the spectral analysis is performed. This directly reduces the spurious cross-spectral power that arises from these common components. Furthermore, the Laplacian is reference-independent, effectively solving the reference problem.\n\nVerdict: **Correct**.\n\n**F. Increasing the number of averages in Welch’s method alone eliminates bias from common reference in $S_{xy}(f)$.**\n\nWelch's method for spectral estimation involves averaging the periodograms of multiple, possibly overlapping, segments of the data. This procedure has a well-known statistical effect: it reduces the *variance* of the spectral estimate. As the number of segments $K$ goes to infinity, the variance of the estimate approaches zero. The estimate converges to the expected value of the periodogram, which (for long enough segments) is the true CSD of the input signals.\nIn this context, the input signals are the re-referenced signals $x'(t)$ and $y'(t)$. Therefore, Welch's method provides a good estimate of $S_{x'y'}(f) = S_{v_x v_y}(f) - S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$.\nThe \"bias\" in question is the deviation of $S_{x'y'}(f)$ from the desired \"true\" CSD, $S_{v_x v_y}(f)$. This bias is represented by the terms involving the reference, $- S_{v_x r}(f) - S_{r v_y}(f) + S_{rr}(f)$. Welch's method makes the estimate of the *biased spectrum* more precise; it does not remove the bias itself. The bias is inherent to the re-referenced data. To eliminate this bias, one must change the data itself (e.g., via Laplacian) or use a different referencing scheme, not simply change the spectral estimation parameters.\n\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{ABDE}$$"
        }
    ]
}