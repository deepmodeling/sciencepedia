{
    "hands_on_practices": [
        {
            "introduction": "Before applying the Hilbert transform to complex neural data, it is crucial to understand its behavior on a simple, ideal signal. This practice solidifies the theoretical foundation by deriving the analytic signal for a basic sinusoid, revealing the elegant relationship between cosine and sine functions as the real and imaginary parts of a complex exponential. By verifying the one-sided spectrum, you will grasp the core principle that allows for the unambiguous definition of instantaneous amplitude and phase. ",
            "id": "4199768",
            "problem": "In intracranial electrophysiology and electroencephalography (EEG), narrowband oscillations are often approximated locally as deterministic sinusoids to study instantaneous amplitude and instantaneous phase via the Hilbert transform. Consider the real-valued signal $x(t) = \\cos(\\omega_{0} t)$, where $\\omega_{0}  0$ is a constant angular frequency expressed in radians per second and $t$ is time in seconds. The Hilbert transform $\\mathcal{H}\\{x\\}(t)$ of a real signal $x(t)$ is defined by the Cauchy principal value convolution with the kernel $h(t) = \\frac{1}{\\pi t}$, i.e., $\\mathcal{H}\\{x\\}(t) = \\bigl(x * h\\bigr)(t)$, and the associated analytic signal $z(t)$ is formed by combining $x(t)$ with its quadrature component $\\mathcal{H}\\{x\\}(t)$.\n\nUsing only fundamental transform definitions and properties of linear time-invariant systems and distributions, derive $\\mathcal{H}\\{\\cos(\\omega_{0} t)\\}(t)$ and the corresponding analytic signal $z_{\\cos}(t)$, and use the Fourier transform to verify rigorously that $z_{\\cos}(t)$ has a one-sided spectrum (i.e., no negative-frequency support). Then generalize the derivation to $x(t) = \\sin(\\omega_{0} t)$ to obtain $\\mathcal{H}\\{\\sin(\\omega_{0} t)\\}(t)$ and $z_{\\sin}(t)$, and verify the same one-sided spectrum property.\n\nFinally, provide the exact closed-form expressions for the analytic signals $z_{\\cos}(t)$ and $z_{\\sin}(t)$ in terms of $\\omega_{0}$ and $t$. Angles must be in radians. No numerical rounding is required, and no units should appear in the final expressions.",
            "solution": "The problem is valid as it is scientifically grounded in signal processing theory, well-posed with clear definitions and objectives, and free from any factual or logical inconsistencies. We will proceed with the derivation using the Fourier transform properties.\n\nThe Hilbert transform $\\mathcal{H}\\{x(t)\\}$ is defined by the convolution $x(t) * h(t)$, where the kernel is $h(t) = \\frac{1}{\\pi t}$. By the convolution theorem, this operation corresponds to multiplication in the frequency domain. We define the Fourier transform and its inverse as:\n$$\nX(\\omega) = \\mathcal{F}\\{x(t)\\} = \\int_{-\\infty}^{\\infty} x(t) e^{-i\\omega t} dt\n$$\n$$\nx(t) = \\mathcal{F}^{-1}\\{X(\\omega)\\} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} X(\\omega) e^{i\\omega t} d\\omega\n$$\nThe Fourier transform of the kernel $h(t)$ is a standard result:\n$$\nH(\\omega) = \\mathcal{F}\\left\\{\\frac{1}{\\pi t}\\right\\}(\\omega) = -i \\cdot \\text{sgn}(\\omega)\n$$\nwhere $\\text{sgn}(\\omega)$ is the signum function. Thus, the Hilbert transform can be calculated as:\n$$\n\\mathcal{H}\\{x\\}(t) = \\mathcal{F}^{-1}\\{ -i \\cdot \\text{sgn}(\\omega) \\cdot X(\\omega) \\}\n$$\nThe analytic signal $z(t)$ is then $z(t) = x(t) + i\\mathcal{H}\\{x\\}(t)$. In the frequency domain, its transform $Z(\\omega)$ is:\n$$\nZ(\\omega) = \\mathcal{F}\\{x(t) + i\\mathcal{H}\\{x\\}(t)\\} = X(\\omega) + i(-i \\cdot \\text{sgn}(\\omega) \\cdot X(\\omega)) = X(\\omega) + \\text{sgn}(\\omega)X(\\omega)\n$$\nThis simplifies to:\n$$\nZ(\\omega) = (1 + \\text{sgn}(\\omega))X(\\omega) = \\begin{cases} 2X(\\omega),  \\omega  0 \\\\ X(0),  \\omega = 0 \\\\ 0,  \\omega  0 \\end{cases}\n$$\nThis relationship inherently shows that the analytic signal has a one-sided spectrum for any real signal $x(t)$ with no DC component ($X(0)=0$). We will now verify this explicitly for the given sinusoidal signals.\n\n**Part 1: Derivation for $x(t) = \\cos(\\omega_{0} t)$**\n\nFirst, we find the Fourier transform of $x(t) = \\cos(\\omega_{0} t)$. Using Euler's identity, $\\cos(\\omega_{0} t) = \\frac{1}{2}(\\exp(i\\omega_{0} t) + \\exp(-i\\omega_{0} t))$, and the known transform $\\mathcal{F}\\{\\exp(i\\omega_{c}t)\\} = 2\\pi\\delta(\\omega - \\omega_{c})$, we get:\n$$\nX_{\\cos}(\\omega) = \\mathcal{F}\\{\\cos(\\omega_{0} t)\\} = \\frac{1}{2} [2\\pi\\delta(\\omega - \\omega_{0}) + 2\\pi\\delta(\\omega + \\omega_{0})] = \\pi[\\delta(\\omega - \\omega_{0}) + \\delta(\\omega + \\omega_{0})]\n$$\nNow, we find the Fourier transform of the Hilbert-transformed signal, denoted by $Y_{\\cos}(\\omega)$:\n$$\nY_{\\cos}(\\omega) = H(\\omega)X_{\\cos}(\\omega) = -i \\cdot \\text{sgn}(\\omega) \\cdot \\pi[\\delta(\\omega - \\omega_{0}) + \\delta(\\omega + \\omega_{0})]\n$$\nUsing the sifting property of the Dirac delta distribution, $\\phi(\\omega)\\delta(\\omega - a) = \\phi(a)\\delta(\\omega - a)$, and noting that $\\omega_{0}  0$:\n$$\nY_{\\cos}(\\omega) = -i\\pi[\\text{sgn}(\\omega_{0})\\delta(\\omega - \\omega_{0}) + \\text{sgn}(-\\omega_{0})\\delta(\\omega + \\omega_{0})]\n$$\n$$\nY_{\\cos}(\\omega) = -i\\pi[(1)\\delta(\\omega - \\omega_{0}) + (-1)\\delta(\\omega + \\omega_{0})] = -i\\pi[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})]\n$$\nTo find the Hilbert transform in the time domain, we take the inverse Fourier transform of $Y_{\\cos}(\\omega)$. Recognizing that $\\mathcal{F}\\{\\sin(\\omega_{0} t)\\} = \\frac{\\pi}{i}[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})]$, we can write:\n$$\nY_{\\cos}(\\omega) = -i\\pi[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})] = \\frac{\\pi}{i}[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})] = \\mathcal{F}\\{\\sin(\\omega_{0} t)\\}\n$$\nTherefore, the Hilbert transform of $\\cos(\\omega_{0} t)$ is:\n$$\n\\mathcal{H}\\{\\cos(\\omega_{0} t)\\}(t) = \\sin(\\omega_{0} t)\n$$\nThe corresponding analytic signal $z_{\\cos}(t)$ is:\n$$\nz_{\\cos}(t) = x(t) + i\\mathcal{H}\\{x(t)\\}(t) = \\cos(\\omega_{0} t) + i\\sin(\\omega_{0} t) = \\exp(i\\omega_{0} t)\n$$\nTo verify its one-sided spectrum, we compute its Fourier transform $Z_{\\cos}(\\omega)$:\n$$\nZ_{\\cos}(\\omega) = \\mathcal{F}\\{\\exp(i\\omega_{0} t)\\} = 2\\pi\\delta(\\omega - \\omega_{0})\n$$\nSince $\\omega_{0}  0$, the spectrum $Z_{\\cos}(\\omega)$ is non-zero only at the positive frequency $\\omega = \\omega_{0}$. It has no support for negative frequencies, confirming it is a one-sided spectrum.\n\n**Part 2: Derivation for $x(t) = \\sin(\\omega_{0} t)$**\n\nWe follow the same procedure for $x(t) = \\sin(\\omega_{0} t)$. Using Euler's identity, $\\sin(\\omega_{0} t) = \\frac{1}{2i}(\\exp(i\\omega_{0} t) - \\exp(-i\\omega_{0} t))$, the Fourier transform is:\n$$\nX_{\\sin}(\\omega) = \\mathcal{F}\\{\\sin(\\omega_{0} t)\\} = \\frac{1}{2i} [2\\pi\\delta(\\omega - \\omega_{0}) - 2\\pi\\delta(\\omega + \\omega_{0})] = \\frac{\\pi}{i}[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})]\n$$\nThe Fourier transform of its Hilbert transform, $Y_{\\sin}(\\omega)$, is:\n$$\nY_{\\sin}(\\omega) = H(\\omega)X_{\\sin}(\\omega) = (-i \\cdot \\text{sgn}(\\omega)) \\left( \\frac{\\pi}{i}[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})] \\right)\n$$\n$$\nY_{\\sin}(\\omega) = -\\pi \\cdot \\text{sgn}(\\omega)[\\delta(\\omega - \\omega_{0}) - \\delta(\\omega + \\omega_{0})]\n$$\nApplying the sifting property and using $\\omega_{0}  0$:\n$$\nY_{\\sin}(\\omega) = -\\pi[\\text{sgn}(\\omega_{0})\\delta(\\omega - \\omega_{0}) - \\text{sgn}(-\\omega_{0})\\delta(\\omega + \\omega_{0})]\n$$\n$$\nY_{\\sin}(\\omega) = -\\pi[(1)\\delta(\\omega - \\omega_{0}) - (-1)\\delta(\\omega + \\omega_{0})] = -\\pi[\\delta(\\omega - \\omega_{0}) + \\delta(\\omega + \\omega_{0})]\n$$\nWe recognize this as the negative of the Fourier transform of $\\cos(\\omega_{0} t)$:\n$$\nY_{\\sin}(\\omega) = -\\mathcal{F}\\{\\cos(\\omega_{0} t)\\}\n$$\nTherefore, the Hilbert transform of $\\sin(\\omega_{0} t)$ is:\n$$\n\\mathcal{H}\\{\\sin(\\omega_{0} t)\\}(t) = -\\cos(\\omega_{0} t)\n$$\nThe corresponding analytic signal $z_{\\sin}(t)$ is:\n$$\nz_{\\sin}(t) = x(t) + i\\mathcal{H}\\{x(t)\\}(t) = \\sin(\\omega_{0} t) + i(-\\cos(\\omega_{0} t)) = \\sin(\\omega_{0} t) - i\\cos(\\omega_{0} t)\n$$\nThis can be rewritten as:\n$$\nz_{\\sin}(t) = -i(\\cos(\\omega_{0} t) + i\\sin(\\omega_{0} t)) = -i\\exp(i\\omega_{0} t)\n$$\nTo verify its one-sided spectrum, we compute its Fourier transform $Z_{\\sin}(\\omega)$:\n$$\nZ_{\\sin}(\\omega) = \\mathcal{F}\\{-i\\exp(i\\omega_{0} t)\\} = -i \\mathcal{F}\\{\\exp(i\\omega_{0} t)\\} = -i \\cdot 2\\pi\\delta(\\omega - \\omega_{0})\n$$\nSince $\\omega_{0}  0$, the spectrum $Z_{\\sin}(\\omega)$ is also non-zero only at the positive frequency $\\omega = \\omega_{0}$, confirming it is a one-sided spectrum.\n\n**Final Expressions**\n\nThe exact closed-form expressions for the analytic signals are:\nFor $x(t) = \\cos(\\omega_{0} t)$, the analytic signal is $z_{\\cos}(t) = \\exp(i\\omega_{0} t)$.\nFor $x(t) = \\sin(\\omega_{0} t)$, the analytic signal is $z_{\\sin}(t) = -i\\exp(i\\omega_{0} t)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp(i \\omega_{0} t)  -i \\exp(i \\omega_{0} t)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from continuous-time theory to practical application requires a robust digital algorithm. This hands-on exercise guides you through the standard method of computing the analytic signal using the Fast Fourier Transform (FFT), a computationally efficient approach essential for analyzing large datasets. You will implement the process of zeroing negative frequencies and learn to extract the instantaneous amplitude, phase, and frequency from a discrete time series. ",
            "id": "4199809",
            "problem": "You are given a uniformly sampled, real-valued, finite-length time series $x[n]$ representing an electroencephalography (EEG) epoch. The sampling rate is $f_s = 1000$ Hz and the epoch length is $N = 2048$ samples. The goal is to compute the complex-valued analytic signal $z[n]$ of $x[n]$ via a frequency-domain construction that is consistent with the definition of the analytic signal and the symmetry properties of the Discrete Fourier Transform (DFT) for real inputs. From $z[n]$, you must compute the instantaneous amplitude $A[n]$ and the instantaneous phase $\\phi[n]$ (in radians), and then estimate the instantaneous frequency $f_{\\mathrm{inst}}[n]$ (in Hz) as the time derivative of the unwrapped phase divided by $2\\pi$.\n\nYour program must implement the analytic signal computation using a Fast Fourier Transform (FFT) library, and it must explicitly handle the real-input symmetry and the special cases associated with even $N$, such as the direct current (DC) bin $k = 0$ and the Nyquist bin $k = N/2$. Do not use built-in Hilbert transform routines; instead, build the frequency-domain construction yourself.\n\nUse the following test suite of four signals, all defined on $n = 0,1,\\dots,N-1$ with $t[n] = n / f_s$:\n- Test case $1$ (amplitude-modulated narrowband): $x_1[n] = \\left(1 + 0.5 \\cos\\left(2\\pi \\cdot 0.5 \\cdot t[n]\\right)\\right)\\cos\\left(2\\pi \\cdot 10 \\cdot t[n] + 0.3\\right)$. Evaluate at index $n_1 = 1000$.\n- Test case $2$ (constant): $x_2[n] = 2.0$. Evaluate at index $n_2 = 500$.\n- Test case $3$ (high-frequency sinusoid below Nyquist): $x_3[n] = \\cos\\left(2\\pi \\cdot 450 \\cdot t[n]\\right)$. Evaluate at index $n_3 = 256$.\n- Test case $4$ (zero signal): $x_4[n] = 0$. Evaluate at index $n_4 = 100$.\n\nFor each test case $i \\in \\{1,2,3,4\\}$, compute:\n- $A_i = A[n_i] = |z[n_i]|$ (unitless),\n- $\\phi_i = \\phi[n_i]$ in radians,\n- $f_i = f_{\\mathrm{inst}}[n_i]$ in Hz.\n\nDefine the instantaneous frequency estimate by first computing the unwrapped phase $\\tilde{\\phi}[n]$ and then forming a numerical derivative with respect to time $t[n]$; express $f_{\\mathrm{inst}}[n]$ in Hz. The angle unit for $\\phi[n]$ must be radians. The sampling interval is $\\Delta t = 1/f_s$ seconds. All outputs must be real numbers.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[A_1,\\phi_1,f_1,A_2,\\phi_2,f_2,A_3,\\phi_3,f_3,A_4,\\phi_4,f_4]$.\n\nEnsure scientific realism and numerical robustness, including appropriate handling of the DC and Nyquist components for even $N$. The task must be solved in purely mathematical and algorithmic terms using definitions and properties of the DFT for real signals. Angle values must be in radians, and instantaneous frequency values must be in Hz. No external input is permitted; the program must be self-contained and use the specified test suite.",
            "solution": "The user-provided problem has been analyzed and validated. It is scientifically grounded, well-posed, and objective. It contains no contradictions, missing information, or unrealistic premises. The task is a standard problem in digital signal processing, specifically the computation of the analytic signal and its associated instantaneous parameters for discrete-time series. The methodology prescribed—frequency-domain construction via the Fast Fourier Transform (FFT)—is a correct and standard approach. The problem specifies all necessary parameters and test cases for a unique, verifiable solution.\n\nThe solution proceeds as follows: First, we establish the theoretical foundation for the analytic signal in both continuous and discrete time. Second, we detail the algorithm for its numerical computation using the Discrete Fourier Transform (DFT), paying special attention to the properties of the DFT for real-valued signals of even length. Finally, we define the procedures for calculating the instantaneous amplitude, phase, and frequency from the computed analytic signal.\n\n**1. Theoretical Foundation of the Analytic Signal**\n\nFor a real-valued, continuous-time signal $x(t)$, its analytic signal $z(t)$ is a complex-valued signal defined as:\n$$\nz(t) = x(t) + i \\hat{x}(t)\n$$\nwhere $\\hat{x}(t)$ is the Hilbert transform of $x(t)$. The Hilbert transform is defined by the convolution:\n$$\n\\hat{x}(t) = \\mathcal{H}\\{x(t)\\} = \\frac{1}{\\pi} \\text{P.V.} \\int_{-\\infty}^{\\infty} \\frac{x(\\tau)}{t-\\tau} d\\tau\n$$\nwhere $\\text{P.V.}$ denotes the Cauchy principal value of the integral. In the frequency domain, the Hilbert transform corresponds to a phase shift of $-\\pi/2$ for positive frequencies and $+\\pi/2$ for negative frequencies. If $X(f)$ is the Fourier transform of $x(t)$, the Fourier transform of $\\hat{x}(t)$ is $\\hat{X}(f) = -i \\cdot \\text{sgn}(f) \\cdot X(f)$, where $\\text{sgn}(f)$ is the signum function.\n\nThe Fourier transform of the analytic signal, $Z(f)$, is therefore:\n$$\nZ(f) = X(f) + i\\hat{X}(f) = X(f) + i(-i \\cdot \\text{sgn}(f) \\cdot X(f)) = X(f)(1 + \\text{sgn}(f))\n$$\nThis results in:\n$$\nZ(f) = \n\\begin{cases} \n2X(f),  f  0 \\\\\nX(f),  f = 0 \\\\\n0,  f  0 \n\\end{cases}\n$$\nThe analytic signal thus entirely suppresses negative frequency components, doubles the magnitude of positive frequency components, and preserves the DC component.\n\n**2. Discrete-Time Implementation via the Discrete Fourier Transform (DFT)**\n\nFor a finite-length, real-valued discrete-time signal $x[n]$ of length $N$, sampled at a rate $f_s$, we use the DFT to transition to the frequency domain. Let $X[k]$ be the DFT of $x[n]$:\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] e^{-i 2\\pi kn/N}, \\quad k = 0, 1, \\dots, N-1\n$$\nFor a real signal $x[n]$, its DFT exhibits Hermitian symmetry: $X[k] = X^*[N-k]$ for $k=1, \\dots, N-1$. The bin $k=0$ corresponds to the DC component, and the bins $k=1, \\dots, \\lfloor (N-1)/2 \\rfloor$ correspond to positive frequencies. For an even $N$, as specified in the problem ($N=2048$), the bin $k=N/2$ corresponds to the Nyquist frequency. The bins $k=N/2+1, \\dots, N-1$ correspond to the negative frequencies.\n\nTo construct the DFT of the analytic signal, $Z[k]$, we apply the logic from the continuous case to the discrete spectrum $X[k]$. For an even length $N$:\n1.  **DC Component ($k=0$):** This component is preserved. $Z[0] = X[0]$.\n2.  **Positive Frequencies ($k=1, \\dots, N/2 - 1$):** These components are doubled to ensure that the real part of the resulting analytic signal conserves energy. $Z[k] = 2X[k]$.\n3.  **Nyquist Component ($k=N/2$):** This frequency is its own negative counterpart. A common and consistent convention is to preserve this component. $Z[N/2] = X[N/2]$.\n4.  **Negative Frequencies ($k=N/2 + 1, \\dots, N-1$):** These components are zeroed out. $Z[k] = 0$.\n\nOnce the frequency-domain representation $Z[k]$ is constructed, the discrete-time analytic signal $z[n]$ is recovered using the inverse DFT (IDFT):\n$$\nz[n] = \\frac{1}{N} \\sum_{k=0}^{N-1} Z[k] e^{i 2\\pi kn/N}\n$$\nThe problem specifies the use of a Fast Fourier Transform (FFT) library, which is an efficient algorithm for computing the DFT and IDFT.\n\n**3. Calculation of Instantaneous Parameters**\n\nFrom the complex-valued analytic signal $z[n]$, we can extract the instantaneous amplitude $A[n]$ and instantaneous phase $\\phi[n]$.\n\nThe **instantaneous amplitude** is the magnitude of $z[n]$:\n$$\nA[n] = |z[n]| = \\sqrt{(\\text{Re}\\{z[n]\\})^2 + (\\text{Im}\\{z[n]\\})^2}\n$$\n\nThe **instantaneous phase** (or argument) is given by:\n$$\n\\phi[n] = \\arg(z[n]) = \\text{atan2}(\\text{Im}\\{z[n]\\}, \\text{Re}\\{z[n]\\})\n$$\nThe `atan2` function correctly computes the angle in all four quadrants, producing a result in the interval $(-\\pi, \\pi]$. This is the wrapped phase.\n\nThe **instantaneous frequency** $f_{\\mathrm{inst}}[n]$ is defined as the rate of change of phase, scaled appropriately. To compute a meaningful derivative, the phase must first be \"unwrapped\". Unwrapping, denoted $\\tilde{\\phi}[n]$, corrects the artificial jumps of $\\pm 2\\pi$ that occur when the phase crosses the branch cut of the `atan2` function. This is achieved by adding or subtracting integer multiples of $2\\pi$ to successive phase values to keep the absolute jump between consecutive samples less than or equal to $\\pi$.\n\nThe instantaneous frequency in Hz is defined as:\n$$\nf_{\\mathrm{inst}}(t) = \\frac{1}{2\\pi} \\frac{d\\tilde{\\phi}(t)}{dt}\n$$\nFor our discrete signal $x[n]$ with sampling interval $\\Delta t = 1/f_s$, we approximate the derivative using a numerical finite difference. A second-order central difference scheme offers good accuracy for interior points of the signal:\n$$\nf_{\\mathrm{inst}}[n] = \\frac{1}{2\\pi} \\frac{\\tilde{\\phi}[n+1] - \\tilde{\\phi}[n-1]}{2\\Delta t} = \\frac{f_s}{4\\pi} (\\tilde{\\phi}[n+1] - \\tilde{\\phi}[n-1])\n$$\nThe evaluation points $n_i$ provided in the test cases are all interior points, making the central difference method appropriate and robust.\n\n**4. Application to Test Cases**\n\nThe procedure is applied to each of the four test signals. The parameters are $f_s = 1000$ Hz and $N=2048$. For each signal $x_i[n]$, we compute $z_i[n]$ and then evaluate $A_i = |z_i[n_i]|$, $\\phi_i = \\arg(z_i[n_i])$, and $f_i = f_{\\mathrm{inst}}[n_i]$ at the specified index $n_i$. For the zero signal, all resulting values are deterministically zero. For the constant signal $x_2[n]=2.0$, the analytic signal is $z_2[n]=2.0$, leading to an amplitude of $2.0$ and zero phase and frequency. For the oscillatory signals, the results will approximate the parameters of the carrier wave, with deviations caused by modulation (Case 1) and spectral leakage due to finite-length analysis (Case 3).",
            "answer": "```python\nimport numpy as np\nfrom scipy.fft import fft, ifft\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing instantaneous amplitude, phase, and frequency\n    for a suite of test signals using a frequency-domain construction of the\n    analytic signal.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    fs = 1000  # Sampling rate in Hz\n    N = 2048   # Number of samples\n    t = np.arange(N) / fs  # Time vector in seconds\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"signal_func\": lambda t: (1 + 0.5 * np.cos(2 * np.pi * 0.5 * t)) * np.cos(2 * np.pi * 10 * t + 0.3),\n            \"eval_n\": 1000,\n            \"label\": \"AM Narrowband\"\n        },\n        {\n            \"signal_func\": lambda t: np.full(t.shape, 2.0),\n            \"eval_n\": 500,\n            \"label\": \"Constant\"\n        },\n        {\n            \"signal_func\": lambda t: np.cos(2 * np.pi * 450 * t),\n            \"eval_n\": 256,\n            \"label\": \"High-Frequency Sinusoid\"\n        },\n        {\n            \"signal_func\": lambda t: np.zeros(t.shape),\n            \"eval_n\": 100,\n            \"label\": \"Zero Signal\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # --- Signal Generation ---\n        x = case[\"signal_func\"](t)\n        eval_n = case[\"eval_n\"]\n        \n        # --- Analytic Signal Computation ---\n        # 1. Compute the DFT of the real-valued signal x[n].\n        # The result from SciPy's FFT is a complex array X[k].\n        X = fft(x)\n\n        # 2. Construct the DFT of the analytic signal, Z[k].\n        # For an even N, we follow the specified frequency-domain construction rule.\n        Z = np.zeros_like(X, dtype=np.complex128)\n        \n        # Preserve DC component (k=0)\n        Z[0] = X[0]\n        \n        # Double positive frequency components (k=1 to N/2-1)\n        Z[1:N//2] = 2.0 * X[1:N//2]\n        \n        # Preserve Nyquist component (k=N/2)\n        Z[N//2] = X[N//2]\n        \n        # Zero out negative frequency components (k=N/2+1 to N-1)\n        # This is already handled by initializing Z with zeros.\n\n        # 3. Compute the inverse DFT to get the time-domain analytic signal z[n].\n        z = ifft(Z)\n\n        # --- Instantaneous Parameter Calculation ---\n        \n        # Special handling for the zero signal to avoid potential NaN/instability,\n        # although numpy handles angle(0) and gradient(zeros) gracefully.\n        if np.all(x == 0):\n            A_n = 0.0\n            phi_n = 0.0\n            f_inst_n = 0.0\n        else:\n            # Instantaneous Amplitude: A[n] = |z[n]|\n            amplitude = np.abs(z)\n            A_n = amplitude[eval_n]\n\n            # Instantaneous Phase (wrapped): phi[n] = arg(z[n]) in [-pi, pi]\n            phase = np.angle(z)\n            phi_n = phase[eval_n]\n\n            # Instantaneous Frequency: f_inst[n] = (1/2pi) * d(phi_unwrapped)/dt\n            # 1. Unwrap phase to get a continuous phase angle\n            unwrapped_phase = np.unwrap(phase)\n            \n            # 2. Compute the time derivative of the unwrapped phase using\n            # a second-order central difference for interior points.\n            # np.gradient handles this robustly. dt = 1/fs.\n            dt = 1.0 / fs\n            d_phi_dt = np.gradient(unwrapped_phase, dt)\n            \n            # 3. Convert angular frequency (rad/s) to frequency (Hz)\n            instantaneous_frequency = d_phi_dt / (2 * np.pi)\n            f_inst_n = instantaneous_frequency[eval_n]\n\n        results.extend([A_n, phi_n, f_inst_n])\n\n    # --- Final Output Formatting ---\n    # Format the results into the required single-line string.\n    output_str = \"[\" + \",\".join(f\"{v:.10f}\" for v in results) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The power of the Hilbert transform to separate a signal's amplitude envelope from its phase rests on a key assumption, formalized by Bedrosian’s theorem. This practice challenges you to explore what happens when this assumption is violated—a common scenario in complex biological signals where the spectra of the amplitude and carrier overlap. By quantifying the resulting bias, you will develop a critical understanding of the limitations of this method and learn when its results should be interpreted with caution. ",
            "id": "4199775",
            "problem": "Consider a real-valued neural time series model $x(t)$ formed by amplitude modulation of a narrowband carrier, defined by $x(t) = A(t)\\cos\\left(\\phi(t)\\right)$, where the true instantaneous amplitude is $A(t)$ and the true instantaneous phase is $\\phi(t)$. The analytic signal $z(t)$ of $x(t)$ is given by $z(t) = x(t) + i\\,\\mathcal{H}\\{x\\}(t)$, where $\\mathcal{H}\\{\\cdot\\}$ denotes the Hilbert Transform (HT), defined by the principal-value convolution $\\mathcal{H}\\{x\\}(t) = \\left(x * \\frac{1}{\\pi t}\\right)(t)$. The standard Hilbert-based estimators for amplitude and phase are $\\widehat{A}(t) = |z(t)|$ and $\\widehat{\\phi}(t) = \\arg\\big(z(t)\\big)$, respectively. Bedrosian’s theorem states that if the Fourier transform supports of $A(t)$ and $\\cos\\left(\\phi(t)\\right)$ are disjoint in frequency (that is, $A(t)$ is strictly lowpass and $\\cos\\left(\\phi(t)\\right)$ is strictly highpass with non-overlapping support), then $\\mathcal{H}\\{A(t)\\cos\\left(\\phi(t)\\right)\\}(t) = A(t)\\,\\mathcal{H}\\{\\cos\\left(\\phi(t)\\right)\\}(t)$, and the Hilbert-based estimators recover $A(t)$ and $\\phi(t)$ exactly. In practice, neural signals may exhibit overlapping spectra between $A(t)$ and the carrier, violating the conditions of Bedrosian’s theorem and inducing bias in $\\widehat{A}(t)$ and $\\widehat{\\phi}(t)$.\n\nYour task is to construct counterexamples with overlapping spectra and compute bias metrics that quantify the deviation of the Hilbert-based estimators from the ground truth. Work in discrete time at sampling frequency $f_s$ (in $\\mathrm{Hz}$), over a duration $T$ (in $\\mathrm{s}$), with angle quantities in radians. Use the following model components:\n\n- True phase: $\\phi(t) = 2\\pi f_c t$, with carrier frequency $f_c$ (in $\\mathrm{Hz}$).\n- True amplitude: $A(t) = 1 + a_\\ell \\cos(2\\pi f_\\ell t) + a_h \\cos(2\\pi f_h t) + a_{h2} \\cos(2\\pi f_{h2} t)$, where $a_\\ell, a_h, a_{h2} \\in [0,1)$ are amplitude coefficients, and $f_\\ell, f_h, f_{h2}$ (in $\\mathrm{Hz}$) are modulation frequencies. Ensure that $A(t)  0$ for all $t$ to avoid trivial envelope sign ambiguities.\n\nGiven $x(t) = A(t)\\cos(2\\pi f_c t)$, construct the analytic signal $z(t)$ and compute the Hilbert-based estimates $\\widehat{A}(t)$ and $\\widehat{\\phi}(t)$ by the definitions above. To mitigate end effects inherent to the Hilbert Transform, discard the first and last $10\\%$ of the samples when computing metrics.\n\nDefine the following bias metrics:\n- Amplitude bias $b_A = \\frac{1}{N}\\sum_{n=1}^N \\left(\\widehat{A}[n] - A[n]\\right)$, where $N$ is the number of retained samples.\n- Phase bias $b_\\phi$ as the circular mean of the phase difference $\\Delta\\phi[n] = \\mathrm{arg}\\left(e^{i(\\widehat{\\phi}[n] - \\phi[n])}\\right)$, namely\n$$\nb_\\phi = \\mathrm{atan2}\\!\\left(\\frac{1}{N}\\sum_{n=1}^N \\sin\\left(\\Delta\\phi[n]\\right),\\;\\frac{1}{N}\\sum_{n=1}^N \\cos\\left(\\Delta\\phi[n]\\right)\\right).\n$$\nThis $b_\\phi$ is a signed angle in radians indicating the central tendency of the phase error on the unit circle.\n\nImplement a program that constructs the following four test cases and computes $(b_A, b_\\phi)$ for each:\n\n- Case 1 (disjoint spectra; Bedrosian conditions satisfied): $f_s = 1000\\,\\mathrm{Hz}$, $T = 2\\,\\mathrm{s}$, $f_c = 40\\,\\mathrm{Hz}$, $a_\\ell = 0.4$, $f_\\ell = 3\\,\\mathrm{Hz}$, $a_h = 0.0$, $f_h = 0\\,\\mathrm{Hz}$, $a_{h2} = 0.0$, $f_{h2} = 0\\,\\mathrm{Hz}$.\n- Case 2 (mild overlap at the carrier): $f_s = 1000\\,\\mathrm{Hz}$, $T = 2\\,\\mathrm{s}$, $f_c = 40\\,\\mathrm{Hz}$, $a_\\ell = 0.4$, $f_\\ell = 3\\,\\mathrm{Hz}$, $a_h = 0.1$, $f_h = 40\\,\\mathrm{Hz}$, $a_{h2} = 0.0$, $f_{h2} = 0\\,\\mathrm{Hz}$.\n- Case 3 (strong overlap at the carrier): $f_s = 1000\\,\\mathrm{Hz}$, $T = 2\\,\\mathrm{s}$, $f_c = 40\\,\\mathrm{Hz}$, $a_\\ell = 0.2$, $f_\\ell = 3\\,\\mathrm{Hz}$, $a_h = 0.4$, $f_h = 40\\,\\mathrm{Hz}$, $a_{h2} = 0.0$, $f_{h2} = 0\\,\\mathrm{Hz}$.\n- Case 4 (overlap at and near the carrier): $f_s = 1000\\,\\mathrm{Hz}$, $T = 2\\,\\mathrm{s}$, $f_c = 40\\,\\mathrm{Hz}$, $a_\\ell = 0.2$, $f_\\ell = 3\\,\\mathrm{Hz}$, $a_h = 0.3$, $f_h = 40\\,\\mathrm{Hz}$, $a_{h2} = 0.2$, $f_{h2} = 41\\,\\mathrm{Hz}$.\n\nYour program should produce a single line of output containing the eight floating-point results as a comma-separated list enclosed in square brackets, ordered by test case and metric: $[b_{A,1},b_{\\phi,1},b_{A,2},b_{\\phi,2},b_{A,3},b_{\\phi,3},b_{A,4},b_{\\phi,4}]$. Angles must be in radians. No other text should be printed.",
            "solution": "The problem requires the computation of bias in Hilbert-based estimators of instantaneous amplitude and phase for a simulated neural time series. The bias arises when the conditions of Bedrosian's theorem are violated due to spectral overlap between the amplitude envelope and the carrier signal. A systematic solution involves constructing the signal, computing the analytic signal via the Hilbert transform, extracting the estimated attributes, and then calculating the specified bias metrics.\n\nThe model for the real-valued signal is $x(t) = A(t)\\cos(\\phi(t))$, where $A(t)$ is the instantaneous amplitude and $\\phi(t)$ is the instantaneous phase. The objective is to estimate $A(t)$ and $\\phi(t)$ from $x(t)$. The standard method utilizes the analytic signal, $z(t)$, which is a complex signal whose real part is $x(t)$ and whose imaginary part is the Hilbert transform of $x(t)$, denoted $\\mathcal{H}\\{x\\}(t)$.\n$$\nz(t) = x(t) + i\\,\\mathcal{H}\\{x\\}(t)\n$$\nThe Hilbert transform is defined by the convolution $\\mathcal{H}\\{x\\}(t) = (x * \\frac{1}{\\pi t})(t)$. From the analytic signal, the instantaneous amplitude and phase are estimated as:\n$$\n\\widehat{A}(t) = |z(t)| \\quad \\text{and} \\quad \\widehat{\\phi}(t) = \\arg\\left(z(t)\\right)\n$$\nBedrosian's theorem provides sufficient conditions for these estimators to be exact, i.e., $\\widehat{A}(t) = A(t)$ and $\\widehat{\\phi}(t) = \\phi(t)$. The theorem states that if the Fourier spectrum of the low-pass signal $A(t)$ is limited to frequencies below some $f_{max}$, and the spectrum of the high-pass signal $\\cos(\\phi(t))$ is contained in frequencies above $f_{min}$, with $f_{max}  f_{min}$ (i.e., their spectral supports are disjoint), then the Hilbert transform of their product separates:\n$$\n\\mathcal{H}\\{A(t)\\cos(\\phi(t))\\}(t) = A(t)\\,\\mathcal{H}\\{\\cos(\\phi(t))\\}\n$$\nFor the specific carrier $\\cos(\\phi(t)) = \\cos(2\\pi f_c t)$, its Hilbert transform is $\\mathcal{H}\\{\\cos(2\\pi f_c t)\\}(t) = \\sin(2\\pi f_c t)$. Under Bedrosian's conditions, the analytic signal becomes:\n$$\nz(t) = A(t)\\cos(2\\pi f_c t) + i\\,A(t)\\sin(2\\pi f_c t) = A(t)e^{i2\\pi f_c t}\n$$\nTaking the magnitude and angle of this ideal $z(t)$ correctly yields $\\widehat{A}(t) = A(t)$ and $\\widehat{\\phi}(t) = 2\\pi f_c t = \\phi(t)$.\n\nThe problem investigates scenarios where the spectral-disjointness condition is violated. The true amplitude is defined as $A(t) = 1 + a_\\ell \\cos(2\\pi f_\\ell t) + a_h \\cos(2\\pi f_h t) + a_{h2} \\cos(2\\pi f_{h2} t)$. The spectrum of $A(t)$ contains frequencies $f_\\ell$, $f_h$, and $f_{h2}$. The carrier frequency is $f_c$. If any of the modulation frequencies in $A(t)$ are comparable to or greater than $f_c$, their spectra will overlap, Bedrosian's theorem will not hold, and the estimators $\\widehat{A}(t)$ and $\\widehat{\\phi}(t)$ will be biased.\n\nThe algorithmic procedure to quantify this bias for the given discrete-time test cases is as follows:\n$1$. For each case, define the parameters: sampling frequency $f_s$, duration $T$, carrier frequency $f_c$, and amplitude modulation parameters $a_\\ell, f_\\ell, a_h, f_h, a_{h2}, f_{h2}$.\n$2$. Generate a discrete time vector $t[n] = n/f_s$ for $n = 0, 1, \\dots, N_{total}-1$, where $N_{total} = \\lfloor f_s T \\rfloor$.\n$3$. Construct the ground-truth signals: true amplitude $A[n]$ and true phase $\\phi[n]$ using the provided equations.\n$4$. Construct the time-series signal $x[n] = A[n]\\cos(\\phi[n])$.\n$5$. Compute the discrete analytic signal $z[n]$ of $x[n]$. This is efficiently done using the Fast Fourier Transform (FFT) method, as implemented in `scipy.signal.hilbert`. This function computes the FFT of $x[n]$, zeros out the coefficients corresponding to negative frequencies, doubles the coefficients for positive frequencies (with special care for DC and Nyquist), and then computes the inverse FFT.\n$6$. From $z[n]$, calculate the estimated amplitude $\\widehat{A}[n] = |z[n]|$ and estimated phase $\\widehat{\\phi}[n] = \\arg(z[n])$.\n$7$. To mitigate boundary artifacts from the circular convolution inherent in the FFT-based Hilbert transform, the first and last $10\\%$ of all time series ($A[n]$, $\\phi[n]$, $\\widehat{A}[n]$, and $\\widehat{\\phi}[n]$) are discarded.\n$8$. On the remaining $N$ samples, compute the bias metrics. The amplitude bias $b_A$ is the simple arithmetic mean of the error:\n$$\nb_A = \\frac{1}{N}\\sum_{n=1}^N \\left(\\widehat{A}[n] - A[n]\\right)\n$$\nThe phase bias $b_\\phi$ is a circular mean, which properly handles the wrapped nature of phase. It is the angle of the mean resultant vector of the phase errors on the unit circle:\n$$\nb_\\phi = \\mathrm{atan2}\\!\\left(\\frac{1}{N}\\sum_{n=1}^N \\sin\\left(\\Delta\\phi[n]\\right),\\;\\frac{1}{N}\\sum_{n=1}^N \\cos\\left(\\Delta\\phi[n]\\right)\\right)\n$$\nwhere the phase difference $\\Delta\\phi[n]$ is wrapped to the interval $(-\\pi, \\pi]$ by computing $\\Delta\\phi[n] = \\arg(e^{i(\\widehat{\\phi}[n] - \\phi[n])})$. This is computationally equivalent to finding the angle of the average of the complex phasors representing the phase errors: $b_\\phi = \\arg\\left(\\frac{1}{N}\\sum_{n=1}^{N} e^{i(\\widehat{\\phi}[n] - \\phi[n])}\\right)$.\n\nThe four test cases are designed to illustrate the effect of increasing spectral overlap:\n- Case $1$: The maximum frequency in $A(t)$ is $f_\\ell = 3\\,\\mathrm{Hz}$, which is much smaller than the carrier $f_c = 40\\,\\mathrm{Hz}$. The spectra are well-separated, satisfying Bedrosian's condition. We expect negligible bias.\n- Case $2$: A modulation component is introduced at $f_h = 40\\,\\mathrm{Hz}$, which is equal to the carrier frequency $f_c$. This creates direct spectral overlap, violating the theorem's conditions. We expect non-zero bias.\n- Case $3$: The overlap condition from Case $2$ is intensified by increasing the coefficient $a_h$. A larger bias is anticipated.\n- Case $4$: Additional overlap is introduced via a modulation frequency $f_{h2} = 41\\,\\mathrm{Hz}$, which is very close to the carrier frequency. This creates a complex overlap scenario involving multiple interfering spectral components.\n\nThe following program implements this entire procedure to compute the required bias metrics for all four cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy.signal import hilbert\n\ndef calculate_biases(fs, T, fc, al, fl, ah, fh, ah2, fh2):\n    \"\"\"\n    Constructs a signal and computes amplitude and phase biases.\n\n    Args:\n        fs (float): Sampling frequency in Hz.\n        T (float): Signal duration in seconds.\n        fc (float): Carrier frequency in Hz.\n        al (float): Amplitude coefficient for low-frequency modulation.\n        fl (float): Frequency for low-frequency modulation in Hz.\n        ah (float): Amplitude coefficient for high-frequency modulation.\n        fh (float): Frequency for high-frequency modulation in Hz.\n        ah2 (float): Amplitude coefficient for second high-frequency modulation.\n        fh2 (float): Frequency for second high-frequency modulation in Hz.\n\n    Returns:\n        tuple[float, float]: A tuple containing the amplitude bias (b_A) and\n                             phase bias (b_phi) in radians.\n    \"\"\"\n    # 1. Create time vector and ground-truth signal components\n    n_total = int(fs * T)\n    t = np.arange(n_total) / fs\n\n    A_t = 1.0 + al * np.cos(2 * np.pi * fl * t) + \\\n          ah * np.cos(2 * np.pi * fh * t) + \\\n          ah2 * np.cos(2 * np.pi * fh2 * t)\n\n    phi_t = 2 * np.pi * fc * t\n    x_t = A_t * np.cos(phi_t)\n\n    # 2. Compute the analytic signal and extract estimated attributes\n    z_t = hilbert(x_t)\n    A_hat = np.abs(z_t)\n    phi_hat = np.angle(z_t)  # This is the wrapped instantaneous phase\n\n    # 3. Trim data to mitigate end effects\n    trim_samples = int(0.1 * n_total)\n    retained_slice = slice(trim_samples, -trim_samples)\n\n    A_t_trimmed = A_t[retained_slice]\n    A_hat_trimmed = A_hat[retained_slice]\n    phi_t_trimmed = phi_t[retained_slice]\n    phi_hat_trimmed = phi_hat[retained_slice]\n\n    # 4. Compute bias metrics\n    # Amplitude bias: simple mean of the error\n    b_A = np.mean(A_hat_trimmed - A_t_trimmed)\n\n    # Phase bias: circular mean of the phase error\n    phase_diff = phi_hat_trimmed - phi_t_trimmed\n    # The mean of complex phasors gives the resultant vector; its angle is the circular mean.\n    b_phi = np.angle(np.mean(np.exp(1j * phase_diff)))\n\n    return b_A, b_phi\n\ndef solve():\n    \"\"\"\n    Runs the four test cases and prints the results in the specified format.\n    \"\"\"\n    # (fs, T, fc, al, fl, ah, fh, ah2, fh2)\n    test_cases = [\n        # Case 1: Disjoint spectra (Bedrosian conditions satisfied)\n        (1000, 2, 40, 0.4, 3, 0.0, 0, 0.0, 0),\n        # Case 2: Mild overlap at the carrier\n        (1000, 2, 40, 0.4, 3, 0.1, 40, 0.0, 0),\n        # Case 3: Strong overlap at the carrier\n        (1000, 2, 40, 0.2, 3, 0.4, 40, 0.0, 0),\n        # Case 4: Overlap at and near the carrier\n        (1000, 2, 40, 0.2, 3, 0.3, 40, 0.2, 41),\n    ]\n\n    results = []\n    for params in test_cases:\n        b_A, b_phi = calculate_biases(*params)\n        results.extend([b_A, b_phi])\n\n    # Format the final output string as per the problem specification.\n    # A precision of 8 decimal places is used for clear representation.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}