{
    "hands_on_practices": [
        {
            "introduction": "Before analyzing empirical data, it is crucial to understand the theoretical properties of the ROC curve under a generative model. The binormal model, which assumes that decision scores from both the 'signal' and 'noise' classes follow Gaussian distributions, is a foundational framework in signal detection theory. This exercise () challenges you to derive the characteristic shape of the ROC curve under this model and to find a closed-form expression for the total Area Under the Curve (AUC), providing deep insight into how classifier performance is determined by the separation and variance of the underlying score distributions.",
            "id": "4568441",
            "problem": "A preventive medicine program evaluates a continuous screening score $S$ for detecting a condition (present indicator $D=1$, absent indicator $D=0$). Individuals are classified as screen-positive if $S \\ge \\tau$ for a threshold $\\tau \\in \\mathbb{R}$. The true positive rate (TPR) is defined as $\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid D=1)$ and the false positive rate (FPR) is defined as $\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid D=0)$. Assume the following binormal model holds: $S \\mid D=1 \\sim N(\\mu_1,\\sigma_1^2)$ and $S \\mid D=0 \\sim N(\\mu_0,\\sigma_0^2)$, with $\\sigma_1 > 0$ and $\\sigma_0 > 0$. Also assume that, when computing the area under the receiver operating characteristic (ROC) curve, scores from diseased and non-diseased individuals are sampled independently.\n\nStarting from the definitions of $\\mathrm{TPR}(\\tau)$ and $\\mathrm{FPR}(\\tau)$ and the properties of the normal cumulative distribution function $\\Phi(\\cdot)$ and its quantile function $\\Phi^{-1}(\\cdot)$, (i) derive the ROC curve by eliminating the threshold $\\tau$ to express $\\mathrm{TPR}$ as a function of $\\mathrm{FPR}$, and (ii) derive a closed-form expression for the Area Under the Curve (AUC) in terms of $\\mu_1$, $\\mu_0$, $\\sigma_1$, and $\\sigma_0$. Finally, re-express the AUC in terms of the parameters $a = \\frac{\\mu_1 - \\mu_0}{\\sigma_1}$ and $b = \\frac{\\sigma_0}{\\sigma_1}$, and provide this final AUC as a single closed-form analytic expression. No numerical approximation or rounding is required, and no units should be included in the final answer.",
            "solution": "The user wants a detailed solution to a problem in preventive medicine, where the task is to derive the receiver operating characteristic (ROC) curve and the Area Under the Curve (AUC) for a binormal model.\n\n### Step 1: Problem Validation\n\nFirst, I will validate the problem statement.\n\n#### 1.1: Extract Givens\n-   A continuous screening score $S$ is used for detecting a condition.\n-   The condition is either present ($D=1$) or absent ($D=0$).\n-   An individual is classified as screen-positive if their score $S$ is greater than or equal to a threshold $\\tau$, i.e., $S \\ge \\tau$.\n-   The True Positive Rate is defined as $\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid D=1)$.\n-   The False Positive Rate is defined as $\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid D=0)$.\n-   The scores follow a binormal model:\n    -   $S$ conditional on $D=1$ is normally distributed: $S \\mid D=1 \\sim N(\\mu_1, \\sigma_1^2)$.\n    -   $S$ conditional on $D=0$ is normally distributed: $S \\mid D=0 \\sim N(\\mu_0, \\sigma_0^2)$.\n-   The standard deviations are positive: $\\sigma_1 > 0$ and $\\sigma_0 > 0$.\n-   $\\Phi(\\cdot)$ is the cumulative distribution function (CDF) of the standard normal distribution, $N(0,1)$.\n-   $\\Phi^{-1}(\\cdot)$ is the quantile function (inverse CDF) of the standard normal distribution.\n-   Scores from diseased ($D=1$) and non-diseased ($D=0$) individuals are sampled independently.\n-   Task (i): Derive the ROC curve, which is an expression for $\\mathrm{TPR}$ as a function of $\\mathrm{FPR}$.\n-   Task (ii): Derive a closed-form expression for the AUC in terms of $\\mu_1$, $\\mu_0$, $\\sigma_1$, and $\\sigma_0$.\n-   Task (iii): Re-express the AUC in terms of the parameters $a = \\frac{\\mu_1 - \\mu_0}{\\sigma_1}$ and $b = \\frac{\\sigma_0}{\\sigma_1}$ and provide this as the final answer.\n\n#### 1.2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is based on the binormal model for ROC analysis, a standard and well-established statistical framework used in medical diagnostics, signal detection theory, and machine learning. All definitions and concepts ($\\mathrm{TPR}$, $\\mathrm{FPR}$, ROC, AUC, normal distribution) are fundamental to statistics and its applications. The problem is scientifically sound.\n-   **Well-Posed:** The problem is clearly stated, with all necessary parameters and distributions defined. It asks for a specific derivation, which leads to a unique and well-defined mathematical expression.\n-   **Objective:** The problem is formulated in precise, objective mathematical language, free from any subjectivity or ambiguity.\n-   **Flaw Check:** The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, and mathematically feasible. It is a standard, non-trivial derivation problem in statistics.\n\n#### 1.3: Verdict and Action\nThe problem is **valid**. I will proceed with the derivation.\n\n### Step 2: Derivation and Solution\n\nThe solution will be developed in three parts as requested by the problem statement.\n\n#### Part (i): Derive the ROC curve\n\nThe ROC curve plots the True Positive Rate ($\\mathrm{TPR}$) against the False Positive Rate ($\\mathrm{FPR}$) for all possible values of the threshold $\\tau$. We need to express $\\mathrm{TPR}$ as a function of $\\mathrm{FPR}$.\n\nFirst, we express $\\mathrm{TPR}(\\tau)$ and $\\mathrm{FPR}(\\tau)$ in terms of the standard normal CDF, $\\Phi$.\n\nFor the diseased population ($D=1$), the score $S$ follows $N(\\mu_1, \\sigma_1^2)$. We can standardize the score by defining a random variable $Z_1 = \\frac{S - \\mu_1}{\\sigma_1}$, where $Z_1 \\sim N(0,1)$.\nThe $\\mathrm{TPR}$ is:\n$$\n\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid D=1) = \\mathbb{P}\\left(\\frac{S - \\mu_1}{\\sigma_1} \\ge \\frac{\\tau - \\mu_1}{\\sigma_1}\\right) = \\mathbb{P}\\left(Z_1 \\ge \\frac{\\tau - \\mu_1}{\\sigma_1}\\right)\n$$\nUsing the property of the standard normal CDF, $\\mathbb{P}(Z_1 \\ge z) = 1 - \\Phi(z)$, and the symmetry property $1 - \\Phi(z) = \\Phi(-z)$, we get:\n$$\n\\mathrm{TPR}(\\tau) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_1}{\\sigma_1}\\right) = \\Phi\\left(-\\frac{\\tau - \\mu_1}{\\sigma_1}\\right) = \\Phi\\left(\\frac{\\mu_1 - \\tau}{\\sigma_1}\\right)\n$$\n\nFor the non-diseased population ($D=0$), the score $S$ follows $N(\\mu_0, \\sigma_0^2)$. We standardize the score by defining $Z_0 = \\frac{S - \\mu_0}{\\sigma_0}$, where $Z_0 \\sim N(0,1)$.\nThe $\\mathrm{FPR}$ is:\n$$\n\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\ge \\tau \\mid D=0) = \\mathbb{P}\\left(\\frac{S - \\mu_0}{\\sigma_0} \\ge \\frac{\\tau - \\mu_0}{\\sigma_0}\\right) = \\mathbb{P}\\left(Z_0 \\ge \\frac{\\tau - \\mu_0}{\\sigma_0}\\right)\n$$\nSimilarly, we have:\n$$\n\\mathrm{FPR}(\\tau) = 1 - \\Phi\\left(\\frac{\\tau - \\mu_0}{\\sigma_0}\\right) = \\Phi\\left(-\\frac{\\tau - \\mu_0}{\\sigma_0}\\right) = \\Phi\\left(\\frac{\\mu_0 - \\tau}{\\sigma_0}\\right)\n$$\n\nTo find the ROC curve, we must eliminate the parameter $\\tau$. We start by expressing $\\tau$ in terms of the $\\mathrm{FPR}$. Let $x = \\mathrm{FPR}(\\tau)$.\n$$\nx = \\Phi\\left(\\frac{\\mu_0 - \\tau}{\\sigma_0}\\right)\n$$\nApplying the standard normal quantile function, $\\Phi^{-1}$, to both sides:\n$$\n\\Phi^{-1}(x) = \\frac{\\mu_0 - \\tau}{\\sigma_0}\n$$\nSolving for $\\tau$:\n$$\n\\sigma_0 \\Phi^{-1}(x) = \\mu_0 - \\tau \\implies \\tau = \\mu_0 - \\sigma_0 \\Phi^{-1}(x)\n$$\nNow, we substitute this expression for $\\tau$ into the equation for the $\\mathrm{TPR}$. Let $y = \\mathrm{TPR}$.\n$$\ny = \\Phi\\left(\\frac{\\mu_1 - \\tau}{\\sigma_1}\\right) = \\Phi\\left(\\frac{\\mu_1 - (\\mu_0 - \\sigma_0 \\Phi^{-1}(x))}{\\sigma_1}\\right)\n$$\n$$\ny = \\Phi\\left(\\frac{\\mu_1 - \\mu_0 + \\sigma_0 \\Phi^{-1}(x)}{\\sigma_1}\\right)\n$$\nThis equation can be rewritten as:\n$$\ny = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma_1} + \\frac{\\sigma_0}{\\sigma_1} \\Phi^{-1}(x)\\right)\n$$\nThis is the equation for the ROC curve, expressing $\\mathrm{TPR}$ ($y$) as a function of $\\mathrm{FPR}$ ($x$).\n\n#### Part (ii): Derive the AUC\n\nThe Area Under the ROC Curve (AUC) has a direct probabilistic interpretation: it is the probability that a randomly selected individual from the diseased group ($D=1$) has a higher score than a randomly selected individual from the non-diseased group ($D=0$).\nLet $S_1$ be a random score from the population with $D=1$, so $S_1 \\sim N(\\mu_1, \\sigma_1^2)$.\nLet $S_0$ be a random score from the population with $D=0$, so $S_0 \\sim N(\\mu_0, \\sigma_0^2)$.\nThe problem states that $S_1$ and $S_0$ are independent.\nThe AUC is given by $\\mathbb{P}(S_1 > S_0)$, which is equivalent to $\\mathbb{P}(S_1 - S_0 > 0)$.\n\nLet's define a new random variable $W = S_1 - S_0$. Since $S_1$ and $S_0$ are independent normal random variables, their difference $W$ is also normally distributed.\nThe mean of $W$ is:\n$$\n\\mathbb{E}[W] = \\mathbb{E}[S_1 - S_0] = \\mathbb{E}[S_1] - \\mathbb{E}[S_0] = \\mu_1 - \\mu_0\n$$\nThe variance of $W$ is:\n$$\n\\mathrm{Var}(W) = \\mathrm{Var}(S_1 - S_0) = \\mathrm{Var}(S_1) + \\mathrm{Var}(S_0) = \\sigma_1^2 + \\sigma_0^2\n$$\nThus, $W \\sim N(\\mu_1 - \\mu_0, \\sigma_1^2 + \\sigma_0^2)$.\n\nWe now compute the probability $\\mathbb{P}(W > 0)$ by standardizing $W$:\n$$\n\\mathrm{AUC} = \\mathbb{P}(W > 0) = \\mathbb{P}\\left(\\frac{W - (\\mu_1 - \\mu_0)}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}} > \\frac{0 - (\\mu_1 - \\mu_0)}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}\\right)\n$$\nLet $Z = \\frac{W - (\\mu_1 - \\mu_0)}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}$, which is a standard normal variable, $Z \\sim N(0,1)$.\n$$\n\\mathrm{AUC} = \\mathbb{P}\\left(Z > -\\frac{\\mu_1 - \\mu_0}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}\\right)\n$$\nUsing the symmetry property $\\mathbb{P}(Z > -z) = \\mathbb{P}(Z  z) = \\Phi(z)$, we get:\n$$\n\\mathrm{AUC} = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}\\right)\n$$\nThis is the closed-form expression for the AUC in terms of the original parameters.\n\n#### Part (iii): Re-express the AUC\n\nFinally, we re-express the AUC using the given parameters $a = \\frac{\\mu_1 - \\mu_0}{\\sigma_1}$ and $b = \\frac{\\sigma_0}{\\sigma_1}$.\nThe argument of the $\\Phi$ function in our AUC expression is $\\frac{\\mu_1 - \\mu_0}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}$.\nTo introduce $a$ and $b$, we can divide both the numerator and the denominator by $\\sigma_1$ (which is valid since $\\sigma_1 > 0$):\n$$\n\\frac{\\mu_1 - \\mu_0}{\\sqrt{\\sigma_1^2 + \\sigma_0^2}} = \\frac{\\frac{\\mu_1 - \\mu_0}{\\sigma_1}}{\\frac{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}{\\sigma_1}}\n$$\nThe numerator is exactly $a$:\n$$\n\\frac{\\mu_1 - \\mu_0}{\\sigma_1} = a\n$$\nThe denominator can be simplified by bringing $\\sigma_1$ inside the square root:\n$$\n\\frac{\\sqrt{\\sigma_1^2 + \\sigma_0^2}}{\\sigma_1} = \\sqrt{\\frac{\\sigma_1^2 + \\sigma_0^2}{\\sigma_1^2}} = \\sqrt{\\frac{\\sigma_1^2}{\\sigma_1^2} + \\frac{\\sigma_0^2}{\\sigma_1^2}} = \\sqrt{1 + \\left(\\frac{\\sigma_0}{\\sigma_1}\\right)^2}\n$$\nThe term $\\frac{\\sigma_0}{\\sigma_1}$ is exactly $b$. So the denominator becomes $\\sqrt{1 + b^2}$.\nSubstituting these back into the argument of $\\Phi$:\n$$\n\\frac{a}{\\sqrt{1 + b^2}}\n$$\nTherefore, the final expression for the AUC in terms of $a$ and $b$ is:\n$$\n\\mathrm{AUC} = \\Phi\\left(\\frac{a}{\\sqrt{1 + b^2}}\\right)\n$$\nThis is the required single closed-form analytic expression.",
            "answer": "$$\\boxed{\\Phi\\left(\\frac{a}{\\sqrt{1 + b^2}}\\right)}$$"
        },
        {
            "introduction": "An ROC curve presents a spectrum of possible trade-offs between sensitivity and specificity, but which trade-off is 'best'? The answer depends on the context of the decision, including the prevalence of the condition and the relative costs of making different types of errors. This practice () moves from descriptive analysis to optimal decision-making by tasking you with deriving the Bayes-optimal threshold that minimizes the expected misclassification cost, connecting the geometric properties of the ROC curve to the principles of Bayesian decision theory.",
            "id": "4189176",
            "problem": "A cortical decoder produces a continuous neurometric score $S$ intended to indicate whether a transient somatosensory stimulus is present ($Y=1$) or absent ($Y=0$). In a particular experimental condition, the conditional distributions of $S$ are well described by Gaussian densities with equal variance: when $Y=1$, $S \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$; when $Y=0$, $S \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$. A threshold rule declares the stimulus present if $S \\geq \\tau$ and absent otherwise. Let the prevalence of stimulus-present trials be $\\pi = \\mathbb{P}(Y=1)$, with $\\mathbb{P}(Y=0)=1-\\pi$. Let $C_{FP}$ denote the cost of a false positive (declaring present when absent) and $C_{FN}$ denote the cost of a false negative (declaring absent when present). The receiver operating characteristic (ROC) curve is the set of achievable pairs of true positive rate (TPR) and false positive rate (FPR) indexed by the threshold $\\tau$, where $\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\geq \\tau \\mid Y=1)$ and $\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\geq \\tau \\mid Y=0)$.\n\nStarting only from the definitions of expected misclassification cost, Gaussian densities, and the ROC as a parametric curve in the threshold, derive the Bayes-optimal threshold $\\tau^{\\star}$ that minimizes the expected misclassification cost. Then, using the parametric representation of the ROC by $\\tau$, show how the slope of the ROC at the optimal operating point relates to the tangent condition implied by cost minimization.\n\nFinally, compute the optimal threshold for the following experimentally measured parameter values: $\\mu_{0} = -0.2$, $\\mu_{1} = 1.0$, $\\sigma = 0.5$, $C_{FP} = 2$, $C_{FN} = 4$, and $\\pi = 0.4$. Round your numerical answer for $\\tau^{\\star}$ to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Neurometric score: $S$.\n- Stimulus state: $Y=1$ (present), $Y=0$ (absent).\n- Conditional distribution for stimulus present ($Y=1$): $S \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$.\n- Conditional distribution for stimulus absent ($Y=0$): $S \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$.\n- Decision rule: Stimulus is declared present if $S \\geq \\tau$, absent if $S  \\tau$.\n- Prevalence of stimulus-present trials: $\\pi = \\mathbb{P}(Y=1)$, $\\mathbb{P}(Y=0)=1-\\pi$.\n- Cost of a false positive: $C_{FP}$.\n- Cost of a false negative: $C_{FN}$.\n- True Positive Rate: $\\mathrm{TPR}(\\tau) = \\mathbb{P}(S \\geq \\tau \\mid Y=1)$.\n- False Positive Rate: $\\mathrm{FPR}(\\tau) = \\mathbb{P}(S \\geq \\tau \\mid Y=0)$.\n- Task 1: Derive the Bayes-optimal threshold $\\tau^{\\star}$ that minimizes the expected misclassification cost.\n- Task 2: Relate the slope of the ROC curve at $\\tau^{\\star}$ to the tangent condition from cost minimization.\n- Task 3: Compute $\\tau^{\\star}$ for the parameters: $\\mu_{0} = -0.2$, $\\mu_{1} = 1.0$, $\\sigma = 0.5$, $C_{FP} = 2$, $C_{FN} = 4$, $\\pi = 0.4$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, using standard principles of signal detection theory and Bayesian decision theory, which are central to neuroscience data analysis. The use of Gaussian distributions to model neural responses is a common and valid simplification. The problem is well-posed, providing all necessary parameters ($\\mu_0, \\mu_1, \\sigma, C_{FP}, C_{FN}, \\pi$) and a clear objective (minimize expected cost). The terminology is precise and objective. The problem is self-contained, consistent, and does not violate any scientific or mathematical principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n### Part 1: Derivation of the Bayes-Optimal Threshold $\\tau^{\\star}$\n\nThe expected misclassification cost, $C(\\tau)$, is the sum of the expected costs of false positives and false negatives. A false positive occurs when $Y=0$ but the decision is $1$ (i.e., $S \\geq \\tau$). A false negative occurs when $Y=1$ but the decision is $0$ (i.e., $S  \\tau$).\n\nThe expected cost is given by:\n$$\nC(\\tau) = C_{FP} \\cdot \\mathbb{P}(\\text{decision}=1, Y=0) + C_{FN} \\cdot \\mathbb{P}(\\text{decision}=0, Y=1)\n$$\nUsing the law of total probability and the decision rule:\n$$\nC(\\tau) = C_{FP} \\cdot \\mathbb{P}(S \\geq \\tau \\mid Y=0) \\mathbb{P}(Y=0) + C_{FN} \\cdot \\mathbb{P}(S  \\tau \\mid Y=1) \\mathbb{P}(Y=1)\n$$\nLet $p(s|Y=i)$ denote the probability density function (PDF) for the score $S$ given the state $Y=i$. For $i \\in \\{0, 1\\}$, this is the Gaussian PDF: $p(s|Y=i) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(s-\\mu_i)^2}{2\\sigma^2}\\right)$.\nThe cost function can be written in integral form:\n$$\nC(\\tau) = C_{FP} (1-\\pi) \\int_{\\tau}^{\\infty} p(s|Y=0) \\,ds + C_{FN} \\pi \\int_{-\\infty}^{\\tau} p(s|Y=1) \\,ds\n$$\nTo find the threshold $\\tau^{\\star}$ that minimizes $C(\\tau)$, we differentiate $C(\\tau)$ with respect to $\\tau$ and set the result to zero. Using the Leibniz integral rule ($\\frac{d}{dx} \\int_{a(x)}^{b(x)} f(t) dt = f(b(x))b'(x) - f(a(x))a'(x)$), we find:\n$$\n\\frac{dC(\\tau)}{d\\tau} = C_{FP} (1-\\pi) [-p(\\tau|Y=0)] + C_{FN} \\pi [p(\\tau|Y=1)]\n$$\nSetting the derivative to zero for the optimal threshold $\\tau^{\\star}$:\n$$\nC_{FN} \\pi p(\\tau^{\\star}|Y=1) = C_{FP} (1-\\pi) p(\\tau^{\\star}|Y=0)\n$$\nThis can be rearranged into a likelihood ratio condition:\n$$\n\\frac{p(\\tau^{\\star}|Y=1)}{p(\\tau^{\\star}|Y=0)} = \\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\n$$\nNow, we substitute the Gaussian PDFs into this equation. The constant term $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}$ cancels out:\n$$\n\\frac{\\exp\\left(-\\frac{(\\tau^{\\star}-\\mu_1)^2}{2\\sigma^2}\\right)}{\\exp\\left(-\\frac{(\\tau^{\\star}-\\mu_0)^2}{2\\sigma^2}\\right)} = \\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\n$$\n$$\n\\exp\\left(\\frac{(\\tau^{\\star}-\\mu_0)^2 - (\\tau^{\\star}-\\mu_1)^2}{2\\sigma^2}\\right) = \\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\n$$\nTaking the natural logarithm of both sides:\n$$\n\\frac{(\\tau^{\\star}-\\mu_0)^2 - (\\tau^{\\star}-\\mu_1)^2}{2\\sigma^2} = \\ln\\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\n$$\nExpanding the squared terms in the numerator:\n$$\n(\\tau^{\\star2} - 2\\tau^{\\star}\\mu_0 + \\mu_0^2) - (\\tau^{\\star2} - 2\\tau^{\\star}\\mu_1 + \\mu_1^2) = 2\\tau^{\\star}(\\mu_1 - \\mu_0) - (\\mu_1^2 - \\mu_0^2)\n$$\nSubstituting this back and solving for $\\tau^{\\star}$:\n$$\n2\\tau^{\\star}(\\mu_1 - \\mu_0) - (\\mu_1^2 - \\mu_0^2) = 2\\sigma^2 \\ln\\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\n$$\n$$\n2\\tau^{\\star}(\\mu_1 - \\mu_0) = \\mu_1^2 - \\mu_0^2 + 2\\sigma^2 \\ln\\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\n$$\n$$\n2\\tau^{\\star}(\\mu_1 - \\mu_0) = (\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0) + 2\\sigma^2 \\ln\\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\n$$\nAssuming $\\mu_1 \\neq \\mu_0$, we divide by $2(\\mu_1 - \\mu_0)$:\n$$\n\\tau^{\\star} = \\frac{\\mu_1+\\mu_0}{2} + \\frac{\\sigma^2}{\\mu_1-\\mu_0} \\ln\\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\n$$\n\n### Part 2: ROC Slope and Tangent Condition\n\nThe ROC curve is a parametric plot of $(\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau))$. The slope of the ROC curve at a point corresponding to a threshold $\\tau$ is $\\frac{d(\\mathrm{TPR})}{d(\\mathrm{FPR})}$. Using the chain rule, this is $\\frac{d(\\mathrm{TPR})/d\\tau}{d(\\mathrm{FPR})/d\\tau}$.\n\nFirst, we find the derivatives of TPR and FPR with respect to $\\tau$:\n$$\n\\mathrm{TPR}(\\tau) = \\int_{\\tau}^{\\infty} p(s|Y=1) \\,ds \\implies \\frac{d(\\mathrm{TPR})}{d\\tau} = -p(\\tau|Y=1)\n$$\n$$\n\\mathrm{FPR}(\\tau) = \\int_{\\tau}^{\\infty} p(s|Y=0) \\,ds \\implies \\frac{d(\\mathrm{FPR})}{d\\tau} = -p(\\tau|Y=0)\n$$\nThe slope of the ROC curve is therefore:\n$$\n\\frac{d(\\mathrm{TPR})}{d(\\mathrm{FPR})} = \\frac{-p(\\tau|Y=1)}{-p(\\tau|Y=0)} = \\frac{p(\\tau|Y=1)}{p(\\tau|Y=0)}\n$$\nThis is the likelihood ratio at the score value $\\tau$.\n\nNow consider the tangent condition from cost minimization. The total cost is $C(\\tau) = C_{FP}(1-\\pi)\\mathrm{FPR}(\\tau) + C_{FN}\\pi(1-\\mathrm{TPR}(\\tau))$.\nLines of constant expected cost (iso-cost lines) in the ROC space (with axes FPR, TPR) are defined by:\n$$\nC_{\\text{const}} = C_{FP}(1-\\pi)\\mathrm{FPR} + C_{FN}\\pi(1-\\mathrm{TPR})\n$$\nRearranging to express TPR as a function of FPR (like $y=mx+b$):\n$$\nC_{FN}\\pi\\mathrm{TPR} = C_{FP}(1-\\pi)\\mathrm{FPR} + C_{FN}\\pi - C_{\\text{const}}\n$$\n$$\n\\mathrm{TPR} = \\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\\mathrm{FPR} + \\left(1 - \\frac{C_{\\text{const}}}{C_{FN}\\pi}\\right)\n$$\nThe slope of these iso-cost lines is constant and equal to $M = \\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}$.\nMinimizing the expected cost corresponds to finding the point on the convex ROC curve that is tangent to an iso-cost line. At this optimal operating point, the slope of the ROC curve must equal the slope of the iso-cost line.\nTherefore, at the optimal threshold $\\tau^{\\star}$:\n$$\n\\text{Slope of ROC at } \\tau^{\\star} = \\text{Slope of iso-cost line}\n$$\n$$\n\\frac{p(\\tau^{\\star}|Y=1)}{p(\\tau^{\\star}|Y=0)} = \\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\n$$\nThis is precisely the same optimality condition derived by direct differentiation of the cost function $C(\\tau)$. This confirms the geometric interpretation that the Bayes-optimal operating point lies at the tangency point between the ROC curve and the line representing the trade-off between costs and prevalences.\n\n### Part 3: Numerical Calculation of $\\tau^{\\star}$\n\nWe are given the parameters:\n$\\mu_{0} = -0.2$, $\\mu_{1} = 1.0$, $\\sigma = 0.5$, $C_{FP} = 2$, $C_{FN} = 4$, $\\pi = 0.4$.\nFrom these, we derive:\n$\\sigma^2 = (0.5)^2 = 0.25$\n$1-\\pi = 1 - 0.4 = 0.6$\n\nWe use the derived formula for $\\tau^{\\star}$:\n$$\n\\tau^{\\star} = \\frac{\\mu_1+\\mu_0}{2} + \\frac{\\sigma^2}{\\mu_1-\\mu_0} \\ln\\left(\\frac{C_{FP}(1-\\pi)}{C_{FN}\\pi}\\right)\n$$\nSubstitute the values:\n$$\n\\tau^{\\star} = \\frac{1.0 + (-0.2)}{2} + \\frac{0.25}{1.0 - (-0.2)} \\ln\\left(\\frac{2 \\times 0.6}{4 \\times 0.4}\\right)\n$$\n$$\n\\tau^{\\star} = \\frac{0.8}{2} + \\frac{0.25}{1.2} \\ln\\left(\\frac{1.2}{1.6}\\right)\n$$\n$$\n\\tau^{\\star} = 0.4 + \\frac{0.25}{1.2} \\ln(0.75)\n$$\nNow, we compute the numerical values:\n$$\n\\frac{0.25}{1.2} = \\frac{1/4}{6/5} = \\frac{5}{24} \\approx 0.208333...\n$$\n$$\n\\ln(0.75) \\approx -0.287682\n$$\n$$\n\\tau^{\\star} \\approx 0.4 + (0.208333...) \\times (-0.287682)\n$$\n$$\n\\tau^{\\star} \\approx 0.4 - 0.05993375\n$$\n$$\n\\tau^{\\star} \\approx 0.34006625\n$$\nRounding to four significant figures, the optimal threshold is $0.3401$.",
            "answer": "$$\n\\boxed{0.3401}\n$$"
        },
        {
            "introduction": "Theoretical models provide invaluable insight, but in neuroscience data analysis, we typically work with finite datasets of neural activity scores and ground-truth labels. This requires robust algorithms to construct an empirical ROC curve and evaluate performance. This hands-on coding exercise () will guide you through implementing the standard algorithm for generating an ROC curve from discrete data and calculating the partial Area Under the Curve (pAUC), a metric that is particularly relevant when performance is critical in a low false-positive rate regime.",
            "id": "4189171",
            "problem": "You are given deconvolved calcium imaging activity scores aligned to electrophysiology ground-truth binary labels across time bins. For each time bin index $i$ in a dataset of $n$ bins, let $s_i \\in \\mathbb{R}$ denote the deconvolved score and $y_i \\in \\{0,1\\}$ denote the ground-truth label, where $y_i = 1$ indicates that an electrophysiology-confirmed event (spike) occurred in bin $i$. An event detector declares a positive detection at threshold $\\tau \\in \\mathbb{R}$ if $s_i \\ge \\tau$ and declares a negative detection otherwise. From first principles, define and use the following:\n\n- True Positive (TP), False Positive (FP), True Negative (TN), and False Negative (FN) counts at threshold $\\tau$ are functions of the predictions relative to $y_i$.\n- True Positive Rate (TPR) is $ \\mathrm{TPR}(\\tau) = \\dfrac{\\mathrm{TP}(\\tau)}{P} $ where $P = \\sum_{i=1}^{n} y_i$ is the total number of positives.\n- False Positive Rate (FPR) is $ \\mathrm{FPR}(\\tau) = \\dfrac{\\mathrm{FP}(\\tau)}{N} $ where $N = \\sum_{i=1}^{n} (1 - y_i)$ is the total number of negatives.\n- The Receiver Operating Characteristic (ROC) curve is the set of points $\\{(\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau)) : \\tau \\in \\mathbb{R}\\}$ traced by varying the threshold $\\tau$ from $+\\infty$ to $-\\infty$, evaluated only at thresholds that change the prediction, which for finite data are the unique score values.\n- For a given false positive budget $ \\alpha \\in [0,1] $, the partial Area Under the Curve (partial AUC) is the integral $$ \\mathrm{pAUC}(\\alpha) = \\int_{0}^{\\alpha} \\mathrm{TPR}(\\mathrm{FPR}) \\, d(\\mathrm{FPR}) $$ computed along the ROC curve using piecewise linear interpolation between consecutive ROC points. The normalized partial AUC is defined as $$ \\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha) = \\begin{cases}\\dfrac{\\mathrm{pAUC}(\\alpha)}{\\alpha},  \\alpha  0, \\\\ 0,  \\alpha = 0.\\end{cases} $$\n\nYour task is to implement a complete, runnable program that, for each test case provided below, constructs the ROC curve from the scores and labels using the above fundamental definitions, computes the partial AUC up to the specified low false positive rate constraint $\\alpha$, and returns the normalized partial AUC value as a decimal. You must compute the ROC curve by sorting the unique score thresholds in descending order, grouping ties, and using exact counts to produce monotone $\\mathrm{FPR}$ and $\\mathrm{TPR}$ sequences, then integrate using the trapezoidal rule on the piecewise linear ROC segments up to $ \\alpha $.\n\nUse the following test suite. Each test case is a triple $(\\mathbf{s}, \\mathbf{y}, \\alpha)$ where $\\mathbf{s}$ is the list of scores, $\\mathbf{y}$ is the list of labels aligned to $\\mathbf{s}$, and $\\alpha$ is the maximum false positive rate. All quantities are dimensionless and must be expressed as decimals (not percentages).\n\n- Case $1$ (happy path, moderate overlap, balanced-ish):\n  - $\\mathbf{s} = [\\, 0.88, 0.82, 0.79, 0.75, 0.71, 0.64, 0.58, 0.54, 0.66, 0.60, 0.59, 0.57, 0.52, 0.50, 0.46, 0.43, 0.38, 0.34, 0.29, 0.22 \\,]$\n  - $\\mathbf{y} = [\\, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 \\,]$\n  - $\\alpha = 0.10$\n- Case $2$ (all scores identical, random-like classifier behavior):\n  - $\\mathbf{s} = [\\, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50 \\,]$\n  - $\\mathbf{y} = [\\, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 \\,]$\n  - $\\alpha = 0.20$\n- Case $3$ (highly imbalanced negatives, extremely low false positive budget):\n  - $\\mathbf{s} = [\\, 0.90, 0.87, 0.85, 0.88, 0.86, 0.84, 0.70, 0.60, 0.58, 0.55, 0.52, 0.50, 0.47, 0.45, 0.43, 0.40, 0.37, 0.35, 0.33, 0.30, 0.28, 0.26, 0.24, 0.22, 0.20, 0.18, 0.16, 0.14, 0.12, 0.10 \\,]$\n  - $\\mathbf{y} = [\\, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 \\,]$\n  - $\\alpha = 0.02$\n- Case $4$ (perfect separation):\n  - $\\mathbf{s} = [\\, 0.95, 0.92, 0.90, 0.88, 0.85, 0.20, 0.18, 0.15, 0.10, 0.05 \\,]$\n  - $\\mathbf{y} = [\\, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 \\,]$\n  - $\\alpha = 0.30$\n- Case $5$ (inverted classifier, worst-case under low false positives):\n  - $\\mathbf{s} = [\\, 0.20, 0.18, 0.15, 0.10, 0.05, 0.95, 0.92, 0.90, 0.88, 0.85 \\,]$\n  - $\\mathbf{y} = [\\, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0 \\,]$\n  - $\\alpha = 0.10$\n- Case $6$ (boundary condition $\\alpha = 0$):\n  - $\\mathbf{s} = [\\, 0.70, 0.60, 0.55, 0.40 \\,]$\n  - $\\mathbf{y} = [\\, 1, 0, 1, 0 \\,]$\n  - $\\alpha = 0.00$\n\nYour program should produce a single line of output containing the normalized partial AUC values for the cases in the order above, as a comma-separated list enclosed in square brackets, for example $[r_1,r_2,r_3,r_4,r_5,r_6]$, where each $r_k$ is the computed $\\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha)$ for case $k$ as a decimal.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of signal detection theory, specifically the construction and analysis of Receiver Operating Characteristic (ROC) curves, a standard methodology in neuroscience, machine learning, and other STEM fields for evaluating binary classifiers. The problem is well-posed, with all necessary definitions, data, and constraints provided to ensure a unique, verifiable solution. The language is objective and mathematically precise. Therefore, we may proceed with a principled solution.\n\nThe task is to compute the normalized partial Area Under the Curve, $\\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha)$, for a series of datasets. This requires a two-step process: first, constructing the ROC curve from the provided scores and labels, and second, integrating the area under this curve up to a specified false positive rate, $\\alpha$.\n\n**1. ROC Curve Construction from First Principles**\n\nAn ROC curve illustrates the diagnostic ability of a binary classifier system as its discrimination threshold is varied. The curve plots the True Positive Rate ($\\mathrm{TPR}$) against the False Positive Rate ($\\mathrm{FPR}$) at various threshold settings.\n\nGiven a set of scores $\\{s_i\\}_{i=1}^n$ and corresponding true binary labels $\\{y_i\\}_{i=1}^n$ where $y_i \\in \\{0,1\\}$, a decision rule classifies an observation $i$ as positive if its score $s_i$ is greater than or equal to a threshold $\\tau$, and negative otherwise.\n\nThe fundamental quantities are defined at a given threshold $\\tau$:\n- True Positives, $\\mathrm{TP}(\\tau)$: The count of correctly identified positive instances. $\\mathrm{TP}(\\tau) = \\sum_{i: s_i \\ge \\tau \\land y_i=1} 1$.\n- False Positives, $\\mathrm{FP}(\\tau)$: The count of negative instances incorrectly identified as positive. $\\mathrm{FP}(\\tau) = \\sum_{i: s_i \\ge \\tau \\land y_i=0} 1$.\n- True Negatives, $\\mathrm{TN}(\\tau)$: The count of correctly identified negative instances.\n- False Negatives, $\\mathrm{FN}(\\tau)$: The count of positive instances incorrectly identified as negative.\n\nThe total number of actual positive instances is $P = \\sum_{i=1}^n y_i$, and the total number of actual negative instances is $N = \\sum_{i=1}^n (1 - y_i)$.\n\nThe rates are then defined as:\n- True Positive Rate: $\\mathrm{TPR}(\\tau) = \\dfrac{\\mathrm{TP}(\\tau)}{P}$\n- False Positive Rate: $\\mathrm{FPR}(\\tau) = \\dfrac{\\mathrm{FP}(\\tau)}{N}$\n\nTo construct the ROC curve, we trace the $(\\mathrm{FPR}(\\tau), \\mathrm{TPR}(\\tau))$ points as $\\tau$ is swept from $+\\infty$ to $-\\infty$.\n- At $\\tau = +\\infty$, no scores meet the criterion $s_i \\ge \\tau$. Thus, $\\mathrm{TP}(+\\infty) = 0$ and $\\mathrm{FP}(+\\infty) = 0$. This gives the starting point of the ROC curve, $(\\mathrm{FPR}, \\mathrm{TPR}) = (0, 0)$.\n- As $\\tau$ decreases, it will cross the values of the scores $s_i$. The values of $\\mathrm{TP}(\\tau)$ and $\\mathrm{FP}(\\tau)$ are piecewise constant and only change when $\\tau$ is equal to one of the scores present in the data. Therefore, we only need to evaluate the rates at thresholds corresponding to the unique score values.\n\nThe algorithm to generate the ROC points is as follows:\n1. Identify the set of unique scores in the data and sort them in descending order, let these be $\\{t_1, t_2, \\dots, t_k\\}$ where $t_1  t_2  \\dots  t_k$.\n2. Initialize cumulative true positives, $\\mathrm{tp}_{\\mathrm{cum}}$, and false positives, $\\mathrm{fp}_{\\mathrm{cum}}$, to $0$. Initialize the list of ROC points with $(0, 0)$.\n3. For each unique threshold $t_j$ from $j=1$ to $k$:\n    a. Count the number of actual positive labels ($\\Delta \\mathrm{tp}$) and actual negative labels ($\\Delta \\mathrm{fp}$) among all data points with score $s_i = t_j$.\n    b. Update the cumulative counts: $\\mathrm{tp}_{\\mathrm{cum}} \\leftarrow \\mathrm{tp}_{\\mathrm{cum}} + \\Delta \\mathrm{tp}$ and $\\mathrm{fp}_{\\mathrm{cum}} \\leftarrow \\mathrm{fp}_{\\mathrm{cum}} + \\Delta \\mathrm{fp}$.\n    c. Add a new point $(\\mathrm{fp}_{\\mathrm{cum}}/N, \\mathrm{tp}_{\\mathrm{cum}}/P)$ to the list of ROC points.\nThis process correctly handles tied scores by moving diagonally on the ROC plot, increasing both $\\mathrm{TPR}$ and $\\mathrm{FPR}$ simultaneously. The resulting list of points, when connected by line segments, forms the ROC curve.\n\n**2. Partial AUC Calculation and Normalization**\n\nThe partial Area Under the Curve, $\\mathrm{pAUC}(\\alpha)$, is the integral of the ROC curve from $\\mathrm{FPR}=0$ to $\\mathrm{FPR}=\\alpha$:\n$$ \\mathrm{pAUC}(\\alpha) = \\int_{0}^{\\alpha} \\mathrm{TPR}(\\mathrm{FPR}) \\, d(\\mathrm{FPR}) $$\nSince the ROC curve constructed from finite data is piecewise linear, this integral can be computed as a sum of areas of trapezoids formed by consecutive ROC points.\n\nLet the sequence of ROC points be $(x_0, y_0), (x_1, y_1), \\dots, (x_m, y_m)$, where $(x_0, y_0) = (0, 0)$ and $x_i = \\mathrm{FPR}_i, y_i = \\mathrm{TPR}_i$.\nThe algorithm for computing $\\mathrm{pAUC}(\\alpha)$ is:\n1. Initialize total area, $A$, to $0$.\n2. Iterate through the ROC points from $i=1$ to $m$. Let the previous point be $(x_{i-1}, y_{i-1})$ and the current point be $(x_i, y_i)$.\n3. If the previous point's FPR is already beyond the budget (i.e., $x_{i-1} \\ge \\alpha$), terminate the integration.\n4. If the current segment is entirely within the budget (i.e., $x_i \\le \\alpha$), add the full area of the trapezoid to the total:\n   $$ A \\leftarrow A + \\frac{1}{2} (y_i + y_{i-1})(x_i - x_{i-1}) $$\n5. If the current segment crosses the budget boundary (i.e., $x_{i-1}  \\alpha  x_i$), we must integrate only up to $\\alpha$. We find the TPR value at $\\mathrm{FPR}=\\alpha$ by linear interpolation along the segment from $(x_{i-1}, y_{i-1})$ to $(x_i, y_i)$:\n   $$ y_{\\alpha} = y_{i-1} + (y_i - y_{i-1}) \\frac{\\alpha - x_{i-1}}{x_i - x_{i-1}} $$\n   The area of this final, clipped trapezoid is:\n   $$ A \\leftarrow A + \\frac{1}{2} (y_{\\alpha} + y_{i-1})(\\alpha - x_{i-1}) $$\n   After adding this area, the integration is complete, so we terminate the loop.\n\nFinally, the problem asks for the normalized partial AUC, which is defined as:\n$$ \\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha) = \\begin{cases}\\dfrac{\\mathrm{pAUC}(\\alpha)}{\\alpha},  \\alpha  0, \\\\ 0,  \\alpha = 0.\\end{cases} $$\nThis normalization scales the result. For a perfect classifier that achieves $\\mathrm{TPR}=1$ for any $\\mathrm{FPR}0$, the $\\mathrm{pAUC}(\\alpha)$ would be $\\alpha$, and thus $\\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha)=1$. For a classifier that is no better than random guessing along the diagonal, $\\mathrm{TPR}=\\mathrm{FPR}$, the $\\mathrm{pAUC}(\\alpha) = \\alpha^2/2$, and $\\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha)=\\alpha/2$. For the worst-case classifier that only produces false positives in the low-FPR region, $\\mathrm{pAUC}_{\\mathrm{norm}}(\\alpha)=0$.\n\nThe following implementation adheres to these principles to solve the provided test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases specified.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path, moderate overlap, balanced-ish)\n        (\n            [0.88, 0.82, 0.79, 0.75, 0.71, 0.64, 0.58, 0.54, 0.66, 0.60, 0.59, 0.57, 0.52, 0.50, 0.46, 0.43, 0.38, 0.34, 0.29, 0.22],\n            [1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            0.10\n        ),\n        # Case 2 (all scores identical, random-like classifier behavior)\n        (\n            [0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50],\n            [1, 1, 1, 1, 1, 0, 0, 0, 0, 0],\n            0.20\n        ),\n        # Case 3 (highly imbalanced negatives, extremely low false positive budget)\n        (\n            [0.90, 0.87, 0.85, 0.88, 0.86, 0.84, 0.70, 0.60, 0.58, 0.55, 0.52, 0.50, 0.47, 0.45, 0.43, 0.40, 0.37, 0.35, 0.33, 0.30, 0.28, 0.26, 0.24, 0.22, 0.20, 0.18, 0.16, 0.14, 0.12, 0.10],\n            [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            0.02\n        ),\n        # Case 4 (perfect separation)\n        (\n            [0.95, 0.92, 0.90, 0.88, 0.85, 0.20, 0.18, 0.15, 0.10, 0.05],\n            [1, 1, 1, 1, 1, 0, 0, 0, 0, 0],\n            0.30\n        ),\n        # Case 5 (inverted classifier, worst-case under low false positives)\n        (\n            [0.20, 0.18, 0.15, 0.10, 0.05, 0.95, 0.92, 0.90, 0.88, 0.85],\n            [1, 1, 1, 1, 1, 0, 0, 0, 0, 0],\n            0.10\n        ),\n        # Case 6 (boundary condition alpha = 0)\n        (\n            [0.70, 0.60, 0.55, 0.40],\n            [1, 0, 1, 0],\n            0.00\n        )\n    ]\n\n    results = []\n    for scores, labels, alpha in test_cases:\n        result = calculate_pauc_norm(scores, labels, alpha)\n        results.append(f\"{result:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_pauc_norm(scores, labels, alpha):\n    \"\"\"\n    Computes the normalized partial Area Under the ROC Curve (pAUC_norm).\n\n    Args:\n        scores (list or np.ndarray): Deconvolved activity scores.\n        labels (list or np.ndarray): Ground-truth binary labels (0 or 1).\n        alpha (float): The maximum false positive rate for partial AUC calculation.\n\n    Returns:\n        float: The normalized partial AUC value.\n    \"\"\"\n    if alpha == 0.0:\n        return 0.0\n\n    scores = np.asarray(scores, dtype=np.float64)\n    labels = np.asarray(labels, dtype=np.int32)\n    \n    pos_mask = (labels == 1)\n    neg_mask = (labels == 0)\n    \n    P = np.sum(pos_mask)\n    N = np.sum(neg_mask)\n\n    if P == 0 or N == 0:\n        # If no positives, TPR is always 0, so pAUC is 0.\n        # If no negatives, FPR is always 0, ROC is a vertical line at FPR=0,\n        # so integral over [0, alpha] has zero width and area is 0.\n        return 0.0\n\n    # Get unique scores and sort them in descending order for threshold sweeping\n    unique_scores = np.unique(scores)[::-1]\n    \n    roc_points = [(0.0, 0.0)]\n    tp_cum = 0\n    fp_cum = 0\n    \n    # Construct ROC curve points by processing scores in descending order\n    for threshold in unique_scores:\n        threshold_mask = (scores == threshold)\n        delta_tp = np.sum(pos_mask[threshold_mask])\n        delta_fp = np.sum(neg_mask[threshold_mask])\n        \n        tp_cum += delta_tp\n        fp_cum += delta_fp\n        \n        roc_points.append((fp_cum / N, tp_cum / P))\n\n    # Calculate partial AUC using trapezoidal rule\n    pauc = 0.0\n    for i in range(1, len(roc_points)):\n        x_prev, y_prev = roc_points[i - 1]\n        x_curr, y_curr = roc_points[i]\n\n        # Stop if the previous point is already past the budget\n        if x_prev = alpha:\n            break\n\n        # If the whole segment is within the budget, add the full trapezoid area\n        if x_curr = alpha:\n            pauc += 0.5 * (y_prev + y_curr) * (x_curr - x_prev)\n        # If the segment crosses the budget, add the area up to alpha and stop\n        else:\n            # Check for vertical line case: x_curr == x_prev\n            # If so, this segment has zero width and adds no area.\n            if x_curr  x_prev:\n                # Interpolate TPR at FPR = alpha\n                y_interp = y_prev + (y_curr - y_prev) * (alpha - x_prev) / (x_curr - x_prev)\n                pauc += 0.5 * (y_prev + y_interp) * (alpha - x_prev)\n            break\n            \n    # Normalize the partial AUC by alpha\n    pauc_norm = pauc / alpha\n    return pauc_norm\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}