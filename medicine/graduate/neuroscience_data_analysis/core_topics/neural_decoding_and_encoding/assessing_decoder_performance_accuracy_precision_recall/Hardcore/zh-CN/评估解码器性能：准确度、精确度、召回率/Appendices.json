{
    "hands_on_practices": [
        {
            "introduction": "准确率（Accuracy）是评估分类器性能最直观的指标，但其本身可能具有误导性，尤其是在处理类别不平衡的数据集时。此练习将指导您计算解码器的经验准确率，并将其与一个基于类别流行度的随机基准进行比较。通过这个实践，您将学会如何将解码器性能置于一个有意义的背景下进行评估，而不是仅仅依赖于一个孤立的数值 。",
            "id": "4139271",
            "problem": "一个二进制神经解码器被训练用于将单次试验的神经响应分类为“刺激A”或“非A”。在一个留出的测试集上，观察到以下试验计数：真阳性 $\\text{TP} = 215$，假阴性 $\\text{FN} = 85$，假阳性 $\\text{FP} = 120$，以及真阴性 $\\text{TN} = 580$。仅使用准确率的核心定义（即正确分类试验的比例）和基本概率，计算该解码器在测试集上的经验准确率。然后，按如下方式定义一个机会水平基线：一个与经验流行率匹配的随机猜测器，它在每次试验中独立地以等于测试集中“刺激A”的经验流行率的概率预测“刺激A”，否则预测“非A”。从第一性原理计算此基线的期望准确率。最后，报告超出机会水平的准确率优势，定义为解码器的经验准确率减去基线的期望准确率。将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "该问题需要进行三部分计算：一个二进制解码器的经验准确率，一个与经验流行率匹配的随机基线的期望准确率，以及这两个值之间的差值。该问题定义明确，具有科学依据，并为得出唯一解提供了所有必要数据。\n\n首先，我们根据解码器在测试集上性能的混淆矩阵来定义给定的量：\n- 真阳性：$\\text{TP} = 215$\n- 假阴性：$\\text{FN} = 85$\n- 假阳性：$\\text{FP} = 120$\n- 真阴性：$\\text{TN} = 580$\n\n测试集中的总试验次数 $N$ 是这四种结果的总和：\n$$N = \\text{TP} + \\text{FN} + \\text{FP} + \\text{TN}$$\n$$N = 215 + 85 + 120 + 580 = 1000$$\n\n解码器的经验准确率，记为 $\\text{Acc}_{\\text{decoder}}$，定义为正确分类试验的比例。正确分类是真阳性和真阴性的总和。\n$$\\text{Acc}_{\\text{decoder}} = \\frac{\\text{TP} + \\text{TN}}{N}$$\n代入给定值：\n$$\\text{Acc}_{\\text{decoder}} = \\frac{215 + 580}{1000} = \\frac{795}{1000} = 0.795$$\n\n接下来，我们必须计算机会水平基线的期望准确率。该基线定义为一个随机猜测器，它以等于测试集中“刺激A”的经验流行率的概率来预测“刺激A”。\n\n首先，我们计算“刺激A”的经验流行率，我们将其记为 $P_{\\text{A}}$。这是真实情况为“刺激A”的试验所占的比例。刺激实际上是“A”的总试验次数是真阳性和假阴性的总和（即，解码器本应说“A”的情况）。\n$$N_{\\text{A}} = \\text{TP} + \\text{FN} = 215 + 85 = 300$$\n因此，“刺激A”的流行率为：\n$$P_{\\text{A}} = \\frac{N_{\\text{A}}}{N} = \\frac{300}{1000} = 0.3$$\n\n类似地，真实情况为“非A”的试验次数是假阳性和真阴性的总和。\n$$N_{\\text{not A}} = \\text{FP} + \\text{TN} = 120 + 580 = 700$$\n“非A”的流行率为：\n$$P_{\\text{not A}} = \\frac{N_{\\text{not A}}}{N} = \\frac{700}{1000} = 0.7$$\n注意 $P_{\\text{A}} + P_{\\text{not A}} = 0.3 + 0.7 = 1$，正如预期。\n\n基线猜测器根据这些流行率进行预测。设 $\\hat{Y}$ 为猜测器预测的随机变量，$Y$ 为真实刺激标签的随机变量。猜测器的策略是：\n- $P(\\hat{Y} = \\text{\"A\"}) = P_{\\text{A}} = 0.3$\n- $P(\\hat{Y} = \\text{\"not A\"}) = P_{\\text{not A}} = 0.7$\n\n该基线的期望准确率 $\\text{Acc}_{\\text{baseline}}$ 是其预测与真实标签匹配的概率，即 $P(\\hat{Y} = Y)$。由于对于任何给定的试验，猜测都是独立于真实标签做出的，因此可以将其计算为两种正确方式的概率之和：\n1. 真实标签是“A”，且猜测器预测“A”。\n2. 真实标签是“非A”，且猜测器预测“非A”。\n\n一次正确猜测的总概率为：\n$$\\text{Acc}_{\\text{baseline}} = P(\\hat{Y} = \\text{\"A\"} \\text{ and } Y = \\text{\"A\"}) + P(\\hat{Y} = \\text{\"not A\"} \\text{ and } Y = \\text{\"not A\"})$$\n由于猜测与真实标签的独立性：\n$$\\text{Acc}_{\\text{baseline}} = P(\\hat{Y} = \\text{\"A\"}) \\times P(Y = \\text{\"A\"}) + P(\\hat{Y} = \\text{\"not A\"}) \\times P(Y = \\text{\"not A\"})$$\n给定真实标签的概率 $P(Y)$ 就是其经验流行率。因此：\n$$\\text{Acc}_{\\text{baseline}} = P_{\\text{A}} \\times P_{\\text{A}} + P_{\\text{not A}} \\times P_{\\text{not A}}$$\n$$\\text{Acc}_{\\text{baseline}} = P_{\\text{A}}^2 + P_{\\text{not A}}^2$$\n代入计算出的流行率值：\n$$\\text{Acc}_{\\text{baseline}} = (0.3)^2 + (0.7)^2 = 0.09 + 0.49 = 0.58$$\n\n最后，问题要求计算超出机会水平的准确率优势，即解码器的经验准确率与基线的期望准确率之差。\n$$\\text{准确率优势} = \\text{Acc}_{\\text{decoder}} - \\text{Acc}_{\\text{baseline}}$$\n$$\\text{准确率优势} = 0.795 - 0.58 = 0.215$$\n\n问题要求最终答案以小数形式表示，并四舍五入到四位有效数字。数字 $0.215$ 有三位有效数字。为了用四位有效数字表示，我们在末尾添加一个零。\n$$\\text{准确率优势} = 0.2150$$",
            "answer": "$$\\boxed{0.2150}$$"
        },
        {
            "introduction": "即使两个解码器具有完全相同的准确率，它们的实际应用价值也可能大相径庭。本练习探讨了这种“准确率悖论”，您将为两个准确率相同但错误类型分布不同的解码器构建混淆矩阵。这个过程将加深您对精确率（Precision）和召回率（Recall）之间权衡的理解，并强调根据具体应用场景中假阳性和假阴性的不同代价来选择模型的重要性 。",
            "id": "4139270",
            "problem": "在一个皮层群体解码实验中，训练一个二元解码器，根据多神经元脉冲活动和局部场电位（LFP），来分类每次试验中刺激是存在（$\\text{positive}$）还是不存在（$\\text{negative}$）。评估集包含 $N=1500$ 次试验，其真实标签为：$300$ 个阳性样本和 $1200$ 个阴性样本。两个独立训练的解码器 $D_{1}$ 和 $D_{2}$ 在同一个数据集上进行评估。相对于真实标签，两个解码器都达到了相同的准确率 $0.92$。\n\n仅使用准确率、精确率、召回率以及精确率和召回率的调和平均数的正式定义，为 $D_{1}$ 构建一个反映较高召回率和较低精确率的允许混淆矩阵，并为 $D_{2}$ 构建另一个反映较高精确率和较低召回率的允许混淆矩阵，且满足以下约束条件：\n- 总错误数由准确率要求固定。\n- 对于 $D_{1}$，假阳性（false positive）的数量比假阴性（false negative）的数量多 $80$。\n- 对于 $D_{2}$，假阴性的数量比假阳性的数量多 $80$。\n\n设混淆矩阵由真阳性（$TP$）、假阳性（$FP$）、真阴性（$TN$）和假阴性（$FN$）的数量参数化。构建两个矩阵后，计算每个解码器的精确率和召回率，然后计算每个解码器的精确率和召回率的调和平均数。请提供一个原则性的解释，说明在这个神经科学背景下，考虑到类别分布以及假阳性和假阴性的代价，偏好更高召回率与更高精确率的实际意义。\n\n最后，计算 $D_{1}$ 和 $D_{2}$ 之间精确率和召回率的调和平均数的绝对差，并以小数形式报告。将最终数值答案四舍五入到四位有效数字。答案中不允许使用百分号。",
            "solution": "问题陈述已经过验证，被认为是合理的、适定的和有科学依据的。所有必要信息都已提供，约束条件是一致的，并导向唯一的解。\n\n核心任务是根据一组约束条件，为二元解码器 $D_1$ 和 $D_2$ 构建和评估两个混淆矩阵。设混淆矩阵的四个组成部分为真阳性（$TP$）、假阳性（$FP$）、真阴性（$TN$）和假阴性（$FN$）。\n\n性能指标的基本定义如下：\n-   准确率（$A$）：正确分类的比例。\n$$A = \\frac{TP + TN}{TP + TN + FP + FN}$$\n-   精确率（$P$）：预测为阳性的样本中实际为阳性的比例。\n$$P = \\frac{TP}{TP + FP}$$\n-   召回率（$R$）：实际为阳性的样本中被正确识别的比例。也称为灵敏度或真阳性率。\n$$R = \\frac{TP}{TP + FN}$$\n-   精确率和召回率的调和平均数（$H$）：通常表示为 $F_1$ 分数，它提供了一个平衡精确率和召回率的单一指标。\n$$H = \\frac{2 \\cdot P \\cdot R}{P + R} = \\frac{2 \\cdot \\frac{TP}{TP+FP} \\cdot \\frac{TP}{TP+FN}}{\\frac{TP}{TP+FP} + \\frac{TP}{TP+FN}} = \\frac{2TP}{2TP + FP + FN}$$\n\n问题提供了以下全局参数：\n-   试验总数：$N = 1500$。\n-   实际阳性试验数（真实标签）：$N_{pos} = TP + FN = 300$。\n-   实际阴性试验数（真实标签）：$N_{neg} = TN + FP = 1200$。\n-   两个解码器的准确率：$A = 0.92$。\n\n根据准确率，我们可以确定正确和错误预测的总数。\n总正确预测数（$TP+TN$） = $A \\times N = 0.92 \\times 1500 = 1380$。\n总错误预测数（$FP+FN$） = $(1-A) \\times N = (1 - 0.92) \\times 1500 = 0.08 \\times 1500 = 120$。\n这个固定的总错误数，$FP+FN = 120$，适用于解码器 $D_1$ 和 $D_2$。\n\n**解码器 $D_1$ 的分析（较高召回率，较低精确率）**\n\n对于 $D_1$，我们对其错误有两个约束条件：\n1.  总错误数为 $120$：$FP_1 + FN_1 = 120$。\n2.  假阳性数量比假阴性数量多 $80$：$FP_1 = FN_1 + 80$。\n\n我们求解这个线性方程组：\n$$(FN_1 + 80) + FN_1 = 120$$\n$$2FN_1 + 80 = 120$$\n$$2FN_1 = 40$$\n$$FN_1 = 20$$\n因此，$FP_1 = 20 + 80 = 100$。\n\n现在我们可以确定 $D_1$ 的真预测数：\n-   真阳性数 $TP_1 = N_{pos} - FN_1 = 300 - 20 = 280$。\n-   真阴性数 $TN_1 = N_{neg} - FP_1 = 1200 - 100 = 1100$。\n\n$D_1$ 的混淆矩阵为：$TP_1=280$，$FN_1=20$，$FP_1=100$，$TN_1=1100$。\n\n我们计算 $D_1$ 的精确率、召回率和调和平均数：\n-   精确率 $P_1 = \\frac{TP_1}{TP_1 + FP_1} = \\frac{280}{280 + 100} = \\frac{280}{380} = \\frac{14}{19}$。\n-   召回率 $R_1 = \\frac{TP_1}{TP_1 + FN_1} = \\frac{280}{280 + 20} = \\frac{280}{300} = \\frac{14}{15}$。\n-   调和平均数 $H_1 = \\frac{2 P_1 R_1}{P_1 + R_1} = \\frac{2 \\cdot \\frac{14}{19} \\cdot \\frac{14}{15}}{\\frac{14}{19} + \\frac{14}{15}} = \\frac{2 \\cdot 14 \\cdot (\\frac{14}{19 \\cdot 15})}{14 \\cdot (\\frac{1}{19} + \\frac{1}{15})} = \\frac{2 \\cdot \\frac{14}{285}}{\\frac{15+19}{285}} = \\frac{2 \\cdot 14}{34} = \\frac{14}{17}$。\n\n**解码器 $D_2$ 的分析（较高精确率，较低召回率）**\n\n对于 $D_2$，关于错误的约束条件是：\n1.  总错误数为 $120$：$FP_2 + FN_2 = 120$。\n2.  假阴性数量比假阳性数量多 $80$：$FN_2 = FP_2 + 80$。\n\n我们求解这个方程组：\n$$FP_2 + (FP_2 + 80) = 120$$\n$$2FP_2 + 80 = 120$$\n$$2FP_2 = 40$$\n$$FP_2 = 20$$\n因此，$FN_2 = 20 + 80 = 100$。\n\n现在我们确定 $D_2$ 的真预测数：\n-   真阳性数 $TP_2 = N_{pos} - FN_2 = 300 - 100 = 200$。\n-   真阴性数 $TN_2 = N_{neg} - FP_2 = 1200 - 20 = 1180$。\n\n$D_2$ 的混淆矩阵为：$TP_2=200$，$FN_2=100$，$FP_2=20$，$TN_2=1180$。\n\n我们计算 $D_2$ 的精确率、召回率和调和平均数：\n-   精确率 $P_2 = \\frac{TP_2}{TP_2 + FP_2} = \\frac{200}{200 + 20} = \\frac{200}{220} = \\frac{10}{11}$。\n-   召回率 $R_2 = \\frac{TP_2}{TP_2 + FN_2} = \\frac{200}{200 + 100} = \\frac{200}{300} = \\frac{2}{3}$。\n-   调和平均数 $H_2 = \\frac{2 P_2 R_2}{P_2 + R_2} = \\frac{2 \\cdot \\frac{10}{11} \\cdot \\frac{2}{3}}{\\frac{10}{11} + \\frac{2}{3}} = \\frac{2 \\cdot \\frac{20}{33}}{\\frac{30+22}{33}} = \\frac{40}{52} = \\frac{10}{13}$。\n\n**实际意义**\n\n选择像 $D_1$（$R_1 = 14/15 \\approx 0.933$，$P_1 = 14/19 \\approx 0.737$）这样的高召回率解码器，还是像 $D_2$（$R_2 = 2/3 \\approx 0.667$，$P_2 = 10/11 \\approx 0.909$）这样的高精确率解码器，取决于在特定的神经科学或临床应用中，假阴性与假阳性的相对成本。\n\n当解码器未能检测到存在的刺激时（一次“漏报”），就会发生假阴性（$FN$）。当解码器在刺激不存在时发出信号（一次“误报”），就会发生假阳性（$FP$）。\n\n-   **偏好高召回率（$D_1$）：** 解码器 $D_1$ 的假阴性很少（$FN_1=20$），但代价是更多的假阳性（$FP_1=100$）。当漏报的后果严重时，首选高召回率模型。例如，在设计用于检测即将发生的癫痫发作的脑机接口中，未能检测到真正的癫痫发作（漏报）可能对患者是灾难性的。在这种情况下，偶尔触发不必要警告的误报要可接受得多。\n\n-   **偏好高精确率（$D_2$）：** 解码器 $D_2$ 的假阳性非常少（$FP_2=20$），但代价是更多的假阴性（$FN_2=100$）。当误报的后果严重时，高精确率模型至关重要。例如，如果解码器的输出触发侵入性或高风险的干预措施，如向大脑输送强效药物或电刺激，那么误报的代价将极其高昂（例如，导致有害的副作用）。在这种情况下，宁可漏掉一些真实事件，以确保任何干预都是基于高度可信的检测。\n\n存在显著的类别不平衡（$300$ 个阳性样本 vs. $1200$ 个阴性样本）使得准确率成为一个不充分的指标。一个总是预测“阴性”的平凡解码器将达到 $1200/1500 = 80\\%$ 的准确率，但其召回率为零，因此毫无用处。精确率和召回率为评估这种不平衡数据集上的性能提供了更细致、更有意义的方法。\n\n**最终计算**\n\n最后一步是计算 $D_1$ 和 $D_2$ 之间精确率和召回率的调和平均数的绝对差。\n$$|H_1 - H_2| = \\left| \\frac{14}{17} - \\frac{10}{13} \\right|$$\n为了对分数进行减法，我们找到一个公分母，即 $17 \\times 13 = 221$。\n$$|H_1 - H_2| = \\left| \\frac{14 \\times 13}{17 \\times 13} - \\frac{10 \\times 17}{13 \\times 17} \\right| = \\left| \\frac{182}{221} - \\frac{170}{221} \\right| = \\frac{12}{221}$$\n作为小数，这等于 $12 \\div 221 \\approx 0.05429864$。\n四舍五入到四位有效数字得到 $0.05430$。",
            "answer": "$$\\boxed{0.05430}$$"
        },
        {
            "introduction": "虽然 $F1$ 分数（$F1$-score）是一个常用于平衡精确率和召回率的指标，但最大化 $F1$ 分数不一定等同于在非对称错误代价下最大化预期效用。本练习通过一个具体的神经科学解码场景，要求您对比基于 $F1$ 分数和基于预期效用理论的两种不同决策阈值选择策略。这个高级实践将帮助您理解如何将评估指标与应用的最终目标（例如，最小化风险或成本）更紧密地结合起来 。",
            "id": "4139336",
            "problem": "一个团队正在开发一种闭环脑机接口解码器，该解码器必须根据群体神经元放电活动实时检测瞬时感觉刺激的存在。在 $12$ 个试验时期中，解码器对每个时期都输出一个校准过的刺激存在的后验概率 $p_i \\in [0,1]$ 和真实标签 $y_i \\in \\{0,1\\}$，其中 $y_i=1$ 表示刺激存在，$y_i=0$ 表示刺激不存在。按 $p_i$ 降序排列的 $(p_i,y_i)$ 列表如下：\n\n$$\n(0.95,1),\\ (0.90,0),\\ (0.80,1),\\ (0.70,1),\\ (0.60,0),\\ (0.50,0),\\ (0.45,0),\\ (0.40,1),\\ (0.35,0),\\ (0.30,1),\\ (0.20,0),\\ (0.10,0).\n$$\n\n对于一个固定的决策阈值 $\\tau \\in [0,1]$，当 $p_i \\ge \\tau$ 时，解码器预测为 $1$，否则预测为 $0$。该团队正在考虑用两个标准来选择 $\\tau$：\n\n1. $\\mathrm{F1}$-分数 (F1)，由根据已实现的标签计算出的精确率和召回率定义。精确率是预测为正例中实际为正例的比例，召回率是实际正例中被正确预测的比例。$\\mathrm{F1}$-分数是精确率和召回率的调和平均数。该团队将选择在能产生不同预测正例集合的阈值中，使 $\\mathrm{F1}$ 值最大化的 $\\tau$。如果出现平局，他们将选择最大化 $\\mathrm{F1}$ 的阈值中最大的那个 $\\tau$。\n\n2. 非对称误差成本下的期望效用。假设假阳性成本为 $c_{\\mathrm{FP}} = 1$ 个效用单位，假阴性成本为 $c_{\\mathrm{FN}} = 10$ 个效用单位，正确决策的成本为零。该团队将选择相对于后验概率 $p_i$ 能最大化期望效用（等同于最小化期望成本）的 $\\tau$。\n\n仅使用精确率、召回率、$\\mathrm{F1}$-分数、期望成本和后验概率的基本定义，不借助任何预先推导的阈值规则，确定使 $\\mathrm{F1}$ 最大化的决策阈值和使期望成本最小化的决策阈值。然后，计算在 $\\mathrm{F1}$-最优阈值下的总期望成本与在期望效用-最优阈值下的总期望成本之间的差值。将您的最终数值答案四舍五入到四位有效数字，并以效用单位表示。您的最终答案必须是一个实数。",
            "solution": "问题陈述经过严格验证，确认有效。它在科学上基于统计决策理论和机器学习评估的标准原则，表述清晰，包含所有必要信息和无歧义的定义，并且在表述上是客观的。因此，我们可以进行完整的解答。\n\n该问题要求完成两项主要任务：首先，找到优化两个不同标准（F1-分数和期望效用）的决策阈值；其次，计算使用这两个阈值时总期望成本的差值。\n\n设 $N=12$ 个数据点的集合为 $\\{(p_i, y_i)\\}_{i=1}^{12}$。真实标签 $y_i \\in \\{0, 1\\}$ 表示刺激不存在 ($0$) 或存在 ($1$)。后验概率 $p_i$ 代表 $P(y_i=1)$。决策规则是，如果 $p_i \\ge \\tau$，则预测为正例 ($\\hat{y}_i=1$)；如果 $p_i  \\tau$，则预测为负例 ($\\hat{y}_i=0$)。\n\n首先，我们确定数据集中实际正例 ($P$) 和实际负例 ($N$) 的数量。\n正例样本 ($y_i=1$) 对应的 $p_i \\in \\{0.95, 0.80, 0.70, 0.40, 0.30\\}$。因此，正例总数为 $P=5$。\n负例样本 ($y_i=0$) 对应的 $p_i \\in \\{0.90, 0.60, 0.50, 0.45, 0.35, 0.20, 0.10\\}$。因此，负例总数为 $N=7$。\n\n### 第1部分：寻找 F1-最优阈值 ($\\tau_{\\mathrm{F1}}$)\n\nF1-分数是精确率 (Prec) 和召回率 (Rec) 的调和平均数：\n$$ \\mathrm{Prec} = \\frac{\\mathrm{TP}}{\\mathrm{TP}+\\mathrm{FP}}, \\quad \\mathrm{Rec} = \\frac{\\mathrm{TP}}{\\mathrm{TP}+\\mathrm{FN}}, \\quad \\mathrm{F1} = 2 \\frac{\\mathrm{Prec} \\cdot \\mathrm{Rec}}{\\mathrm{Prec} + \\mathrm{Rec}} = \\frac{2\\mathrm{TP}}{2\\mathrm{TP}+\\mathrm{FP}+\\mathrm{FN}} $$\n其中 TP、FP 和 FN 分别是真阳性、假阳性和假阴性的数量。这些计数取决于阈值 $\\tau$ 的选择。能够产生不同预测集合的阈值是数据集中唯一的 $p_i$ 值。我们为每个潜在的阈值评估 F1-分数。数据已按 $p_i$ 排序，这简化了计算。对于阈值 $\\tau=p_{(k)}$，排序列表中的前 $k$ 个项目被预测为正例。\n\n我们将以 $12$ 个唯一的 $p_i$ 值作为阈值，将结果制成表格：\n- 对于 $\\tau=0.95$：将 $\\{ (0.95, 1) \\}$ 预测为正例。TP=$1$，FP=$0$。FN=$P$-TP=$5-1=4$。F1 = $\\frac{2(1)}{2(1)+0+4} = \\frac{2}{6} = \\frac{1}{3} \\approx 0.3333$。\n- 对于 $\\tau=0.90$：将 $\\{ (0.95, 1), (0.90, 0) \\}$ 预测为正例。TP=$1$，FP=$1$。FN=$4$。F1 = $\\frac{2(1)}{2(1)+1+4} = \\frac{2}{7} \\approx 0.2857$。\n- 对于 $\\tau=0.80$：将前 $3$ 个项目预测为正例。TP=$2$，FP=$1$。FN=$3$。F1 = $\\frac{2(2)}{2(2)+1+3} = \\frac{4}{8} = \\frac{1}{2} = 0.5$。\n- 对于 $\\tau=0.70$：将前 $4$ 个项目预测为正例。TP=$3$，FP=$1$。FN=$2$。F1 = $\\frac{2(3)}{2(3)+1+2} = \\frac{6}{9} = \\frac{2}{3} \\approx 0.6667$。\n- 对于 $\\tau=0.60$：将前 $5$ 个项目预测为正例。TP=$3$，FP=$2$。FN=$2$。F1 = $\\frac{2(3)}{2(3)+2+2} = \\frac{6}{10} = \\frac{3}{5} = 0.6$。\n- 对于 $\\tau=0.50$：将前 $6$ 个项目预测为正例。TP=$3$，FP=$3$。FN=$2$。F1 = $\\frac{2(3)}{2(3)+3+2} = \\frac{6}{11} \\approx 0.5455$。\n- 对于 $\\tau=0.45$：将前 $7$ 个项目预测为正例。TP=$3$，FP=$4$。FN=$2$。F1 = $\\frac{2(3)}{2(3)+4+2} = \\frac{6}{12} = \\frac{1}{2} = 0.5$。\n- 对于 $\\tau=0.40$：将前 $8$ 个项目预测为正例。TP=$4$，FP=$4$。FN=$1$。F1 = $\\frac{2(4)}{2(4)+4+1} = \\frac{8}{13} \\approx 0.6154$。\n- 对于 $\\tau=0.35$：将前 $9$ 个项目预测为正例。TP=$4$，FP=$5$。FN=$1$。F1 = $\\frac{2(4)}{2(4)+5+1} = \\frac{8}{14} = \\frac{4}{7} \\approx 0.5714$。\n- 对于 $\\tau=0.30$：将前 $10$ 个项目预测为正例。TP=$5$，FP=$5$。FN=$0$。F1 = $\\frac{2(5)}{2(5)+5+0} = \\frac{10}{15} = \\frac{2}{3} \\approx 0.6667$。\n- 对于 $\\tau=0.20$：将前 $11$ 个项目预测为正例。TP=$5$，FP=$6$。FN=$0$。F1 = $\\frac{2(5)}{2(5)+6+0} = \\frac{10}{16} = \\frac{5}{8} = 0.625$。\n- 对于 $\\tau=0.10$：将所有 $12$ 个项目预测为正例。TP=$5$，FP=$7$。FN=$0$。F1 = $\\frac{2(5)}{2(5)+7+0} = \\frac{10}{17} \\approx 0.5882$。\n\n最大 F1-分数为 $\\frac{2}{3}$，出现在 $\\tau=0.70$ 和 $\\tau=0.30$ 时。问题指定了平局决胜规则：“选择最大化 F1 的阈值中最大的那个 $\\tau$”。因此，F1-最优阈值为 $\\tau_{\\mathrm{F1}} = 0.70$。\n\n### 第2部分：寻找期望效用-最优阈值 ($\\tau_{\\mathrm{EU}}$)\n\n目标是在给定后验概率 $p_i$ 的情况下，选择一个能最小化总期望成本的阈值 $\\tau$。成本为 $c_{\\mathrm{FP}} = 1$ 和 $c_{\\mathrm{FN}} = 10$。正确决策的成本为 $0$。\n\n对于单个试验 $i$，我们考虑每种可能决策的期望成本：\n- 如果我们预测为正例 ($\\hat{y}_i=1$)，期望成本是假阳性概率 ($1-p_i$) 乘以其成本：\n  $E[\\text{Cost} | \\hat{y}_i=1] = p_i \\cdot 0 + (1-p_i) \\cdot c_{\\mathrm{FP}} = 1-p_i$。\n- 如果我们预测为负例 ($\\hat{y}_i=0$)，期望成本是假阴性概率 ($p_i$) 乘以其成本：\n  $E[\\text{Cost} | \\hat{y}_i=0] = p_i \\cdot c_{\\mathrm{FN}} + (1-p_i) \\cdot 0 = 10 p_i$。\n\n为了最小化试验 $i$ 的期望成本，我们应该在 $E[\\text{Cost} | \\hat{y}_i=1]  E[\\text{Cost} | \\hat{y}_i=0]$ 时预测为正例。\n$$ 1-p_i  10 p_i \\implies 1  11 p_i \\implies p_i > \\frac{1}{11} $$\n如果 $p_i = \\frac{1}{11}$，成本相等。最优规则是当 $p_i \\ge \\frac{1}{11}$ 时预测为正例，否则预测为负例。问题中将决策规则定义为当 $p_i \\ge \\tau$ 时预测为正例。因此，在所有试验中实施此最优策略的阈值 $\\tau$ 为 $\\tau_{\\mathrm{EU}} = \\frac{1}{11}$。\n\n### 第3部分：计算总期望成本的差值\n\n给定阈值 $\\tau$ 的总期望成本是每个试验根据该试验的决策所产生的期望成本之和：\n$$ C(\\tau) = \\sum_{i: p_i \\ge \\tau} (1-p_i)c_{\\mathrm{FP}} + \\sum_{i: p_i  \\tau} p_i c_{\\mathrm{FN}} = \\sum_{i: p_i \\ge \\tau} (1-p_i) + 10 \\sum_{i: p_i  \\tau} p_i $$\n我们需要计算 $\\Delta C = C(\\tau_{\\mathrm{F1}}) - C(\\tau_{\\mathrm{EU}})$。\n\n**A. 计算 $C(\\tau_{\\mathrm{F1}}) = C(0.70)$：**\n$p_i \\ge 0.70$ 的试验集合为 $\\{0.95, 0.90, 0.80, 0.70\\}$。\n$p_i  0.70$ 的试验集合为 $\\{0.60, 0.50, 0.45, 0.40, 0.35, 0.30, 0.20, 0.10\\}$。\n$$\n\\begin{align*}\nC(0.70) = [(1-0.95) + (1-0.90) + (1-0.80) + (1-0.70)] \\\\\n\\quad + 10 \\cdot [0.60 + 0.50 + 0.45 + 0.40 + 0.35 + 0.30 + 0.20 + 0.10] \\\\\n= [0.05 + 0.10 + 0.20 + 0.30] + 10 \\cdot [2.90] \\\\\n= 0.65 + 29.0 \\\\\n= 29.65\n\\end{align*}\n$$\n\n**B. 计算 $C(\\tau_{\\mathrm{EU}}) = C(1/11)$：**\n阈值为 $\\tau_{\\mathrm{EU}} = \\frac{1}{11} \\approx 0.0909$。我们必须检查哪些 $p_i$ 值大于或等于此阈值。\n数据集中最小的 $p_i$ 是 $0.10$。由于 $0.10 = \\frac{1}{10} > \\frac{1}{11}$，所有 $12$ 个给定的概率 $p_i$ 都大于 $\\tau_{\\mathrm{EU}}$。\n因此，对于 $\\tau_{\\mathrm{EU}}$，所有试验都被预测为正例。成本函数中的第二项求和是针对一个空集，因此为 $0$。\n$$\nC(1/11) = \\sum_{i=1}^{12} (1-p_i) = 12 - \\sum_{i=1}^{12} p_i\n$$\n所有概率的总和是：\n$$ \\sum_{i=1}^{12} p_i = 0.95+0.90+0.80+0.70+0.60+0.50+0.45+0.40+0.35+0.30+0.20+0.10 = 6.25 $$\n所以，最小总期望成本为：\n$$ C(1/11) = 12 - 6.25 = 5.75 $$\n\n**C. 计算差值：**\n在 F1-最优阈值下的总期望成本与在效用-最优阈值下的总期望成本之间的差值为：\n$$ \\Delta C = C(0.70) - C(1/11) = 29.65 - 5.75 = 23.90 $$\n问题要求将答案四舍五入到四位有效数字。数值 $23.90$ 已经有四位有效数字。",
            "answer": "$$\\boxed{23.90}$$"
        }
    ]
}