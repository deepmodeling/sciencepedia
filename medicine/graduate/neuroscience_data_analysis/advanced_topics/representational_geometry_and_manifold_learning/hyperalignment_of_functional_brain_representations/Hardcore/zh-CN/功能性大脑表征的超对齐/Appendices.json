{
    "hands_on_practices": [
        {
            "introduction": "超对齐的核心目标是在不同被试之间对齐功能性大脑表征，同时保持每个被试自身表征空间的内在几何结构。正交变换因其等距性（即保持距离和角度）而被选为实现此目标的数学工具。本练习 () 将通过一个具体的计算任务，让你亲手验证这一关键属性：你将计算一个简化的表征非相似性矩阵 (Representational Dissimilarity Matrix, RDM)，然后证明一个正交旋转不会改变其结构，从而加深对超对齐基本原理的理解。",
            "id": "4168872",
            "problem": "考虑一个简化的功能性磁共振成像 (fMRI) 表征数据集，其包含 $T=6$ 个时间点和 $d=3$ 个特征，组织成一个矩阵 $X \\in \\mathbb{R}^{T \\times d}$，其中每一行是某个时间点的多体素模式。这些时间点被划分为三个刺激条件，标记为 $1$、$2$ 和 $3$，每个条件有两个重复。设数据和标签由以下公式给出\n$$\nX = \\begin{pmatrix}\n1  2  0 \\\\\n0  1  1 \\\\\n2  0  1 \\\\\n3  1  -1 \\\\\n-1  2  2 \\\\\n4  -1  2\n\\end{pmatrix}, \\quad c = \\begin{pmatrix}\n1,\\, 2,\\, 3,\\, 1,\\, 2,\\, 3\n\\end{pmatrix},\n$$\n其中 $c_t \\in \\{1,2,3\\}$ 是时间点 $t$ 的条件标签。在超对齐 (hyperalignment) 中，特定于被试的多变量模式通过正交变换进行对齐，以保持跨被试的表征几何结构。在本问题中，我们研究表征非相似性矩阵 (Representational Dissimilarity Matrix, RDM) 在此类正交旋转下的不变性。\n\n执行以下步骤：\n\n1. 对于每个条件 $i \\in \\{1,2,3\\}$，计算特定于条件的模式向量 $\\mu_i \\in \\mathbb{R}^{3}$，其值为标签等于 $i$ 的 $X$ 矩阵各行的算术平均值。\n\n2. 构建一个 $3 \\times 3$ 的表征非相似性矩阵 (RDM)，记为 $R$，其非对角线元素为 $R_{ij} = \\|\\mu_i - \\mu_j\\|_2^2$ ($i \\neq j$)，对角线元素为 $R_{ii} = 0$。这里 $\\|\\cdot\\|_2$ 表示欧几里得范数。\n\n3. 设 $Q \\in \\mathbb{R}^{3 \\times 3}$ 为正交旋转矩阵\n$$\nQ = \\begin{pmatrix}\n0  -1  0 \\\\\n1  0  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\n该矩阵满足 $Q^{\\top}Q = I$。计算旋转后的条件向量 $\\nu_i = Q \\mu_i$，并构建旋转后的 RDM $R'$，其元素为 $R'_{ij} = \\|\\nu_i - \\nu_j\\|_2^2$ ($i \\neq j$) 和 $R'_{ii} = 0$。\n\n4. 仅使用欧几里得范数和正交矩阵的定义，判断 $R$ 和 $R'$ 是否必然相同。\n\n5. 计算两个 RDM 之间差值的弗罗贝尼乌斯范数 $\\|R - R'\\|_F$，其中对于任意矩阵 $A$，$ \\|A\\|_F = \\sqrt{\\sum_{i,j} a_{ij}^2}$。将你的最终答案表示为一个实数。无需四舍五入。",
            "solution": "该问题要求我们分析正交旋转对从简化 fMRI 数据集派生出的表征非相似性矩阵 (RDM) 的影响。我们给定了一个数据矩阵 $X \\in \\mathbb{R}^{T \\times d}$（其中 $T=6, d=3$）和一个条件标签向量 $c$。\n$$\nX = \\begin{pmatrix}\n1  2  0 \\\\\n0  1  1 \\\\\n2  0  1 \\\\\n3  1  -1 \\\\\n-1  2  2 \\\\\n4  -1  2\n\\end{pmatrix}, \\quad c = \\begin{pmatrix}\n1  2  3  1  2  3\n\\end{pmatrix}\n$$\n\n我们将按指定步骤进行。\n\n**步骤 1：计算特定于条件的模式向量 $\\mu_i$**\n\n条件 $i \\in \\{1, 2, 3\\}$ 的向量 $\\mu_i$ 是 $X$ 矩阵中对应于该条件的各行的算术平均值。\n\n对于条件 $i=1$，相关的行是 $X$ 的第 1 行和第 4 行：\n$$\n\\mu_1 = \\frac{1}{2} \\left( \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 3 \\\\ 1 \\\\ -1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 4 \\\\ 3 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix}\n$$\n\n对于条件 $i=2$，相关的行是 $X$ 的第 2 行和第 5 行：\n$$\n\\mu_2 = \\frac{1}{2} \\left( \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ 2 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} -1 \\\\ 3 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix}\n$$\n\n对于条件 $i=3$，相关的行是 $X$ 的第 3 行和第 6 行：\n$$\n\\mu_3 = \\frac{1}{2} \\left( \\begin{pmatrix} 2 \\\\ 0 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 4 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 6 \\\\ -1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n\n**步骤 2：构建表征非相似性矩阵 $R$**\n\nRDM $R$ 是一个 $3 \\times 3$ 矩阵，其元素为 $R_{ij} = \\|\\mu_i - \\mu_j\\|_2^2$ ($i \\neq j$) 和 $R_{ii} = 0$。\n\n对角线元素为 $R_{11} = R_{22} = R_{33} = 0$。\n对于非对角线元素：\n$R_{12} = \\|\\mu_1 - \\mu_2\\|_2^2$:\n$$\n\\mu_1 - \\mu_2 = \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} 5/2 \\\\ 0 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR_{12} = \\left(\\frac{5}{2}\\right)^2 + 0^2 + (-2)^2 = \\frac{25}{4} + 4 = \\frac{25+16}{4} = \\frac{41}{4}\n$$\n\n$R_{13} = \\|\\mu_1 - \\mu_3\\|_2^2$:\n$$\n\\mu_1 - \\mu_3 = \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR_{13} = (-1)^2 + 2^2 + (-2)^2 = 1 + 4 + 4 = 9\n$$\n\n$R_{23} = \\|\\mu_2 - \\mu_3\\|_2^2$:\n$$\n\\mu_2 - \\mu_3 = \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -7/2 \\\\ 2 \\\\ 0 \\end{pmatrix}\n$$\n$$\nR_{23} = \\left(-\\frac{7}{2}\\right)^2 + 2^2 + 0^2 = \\frac{49}{4} + 4 = \\frac{49+16}{4} = \\frac{65}{4}\n$$\n\n由于平方欧几里得距离是对称的，因此 $R_{ij} = R_{ji}$。完整的 RDM 如下：\n$$\nR = \\begin{pmatrix} 0  \\frac{41}{4}  9 \\\\ \\frac{41}{4}  0  \\frac{65}{4} \\\\ 9  \\frac{65}{4}  0 \\end{pmatrix}\n$$\n\n**步骤 3：计算旋转后的向量 $\\nu_i$ 和 RDM $R'$**\n\n正交旋转矩阵为 $Q = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix}$。我们计算 $\\nu_i = Q \\mu_i$。\n$$\n\\nu_1 = Q \\mu_1 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3/2 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} -3/2 \\\\ 2 \\\\ -1/2 \\end{pmatrix}\n$$\n$$\n\\nu_2 = Q \\mu_2 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} -1/2 \\\\ 3/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n$$\n\\nu_3 = Q \\mu_3 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3 \\\\ 3/2 \\end{pmatrix}\n$$\n现在我们构建旋转后的 RDM $R'$，其元素为 $R'_{ij} = \\|\\nu_i - \\nu_j\\|_2^2$。\n$R'_{12} = \\|\\nu_1 - \\nu_2\\|_2^2$:\n$$\n\\nu_1 - \\nu_2 = \\begin{pmatrix} -3/2 \\\\ 2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} -3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 5/2 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR'_{12} = 0^2 + \\left(\\frac{5}{2}\\right)^2 + (-2)^2 = \\frac{25}{4} + 4 = \\frac{41}{4}\n$$\n这与 $R_{12}$ 相同。\n\n$R'_{13} = \\|\\nu_1 - \\nu_3\\|_2^2$:\n$$\n\\nu_1 - \\nu_3 = \\begin{pmatrix} -3/2 \\\\ 2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 3 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -1 \\\\ -2 \\end{pmatrix}\n$$\n$$\nR'_{13} = (-2)^2 + (-1)^2 + (-2)^2 = 4 + 1 + 4 = 9\n$$\n这与 $R_{13}$ 相同。\n\n$R'_{23} = \\|\\nu_2 - \\nu_3\\|_2^2$:\n$$\n\\nu_2 - \\nu_3 = \\begin{pmatrix} -3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 3 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -7/2 \\\\ 0 \\end{pmatrix}\n$$\n$$\nR'_{23} = (-2)^2 + \\left(-\\frac{7}{2}\\right)^2 + 0^2 = 4 + \\frac{49}{4} = \\frac{16+49}{4} = \\frac{65}{4}\n$$\n这与 $R_{23}$ 相同。\n得到的 RDM $R'$ 与 $R$ 相同：\n$$\nR' = \\begin{pmatrix} 0  \\frac{41}{4}  9 \\\\ \\frac{41}{4}  0  \\frac{65}{4} \\\\ 9  \\frac{65}{4}  0 \\end{pmatrix}\n$$\n\n**步骤 4：判断 $R$ 和 $R'$ 是否必然相同**\n\n是的，$R$ 和 $R'$ 必然相同。这是正交变换的一个普遍性质。\n设 $v$ 是 $\\mathbb{R}^d$ 中的任意向量。其平方欧几里得范数为 $\\|v\\|_2^2 = v^\\top v$。\n考虑一个向量 $v$ 经正交矩阵 $Q$ 变换后的平方范数：\n$$\n\\|Qv\\|_2^2 = (Qv)^\\top (Qv)\n$$\n使用转置性质 $(AB)^\\top = B^\\top A^\\top$，我们有：\n$$\n\\|Qv\\|_2^2 = v^\\top Q^\\top Q v\n$$\n根据定义，正交矩阵 $Q$ 满足 $Q^\\top Q = I$，其中 $I$ 是单位矩阵。将此代入方程中：\n$$\n\\|Qv\\|_2^2 = v^\\top I v = v^\\top v = \\|v\\|_2^2\n$$\n这表明正交变换保持任意向量的范数不变。这个性质被称为等距变换 (isometry)。\n\n现在，考虑 RDM 的元素。对于任意 $i \\neq j$：\n$$\nR_{ij} = \\|\\mu_i - \\mu_j\\|_2^2\n$$\n$$\nR'_{ij} = \\|\\nu_i - \\nu_j\\|_2^2 = \\|Q\\mu_i - Q\\mu_j\\|_2^2\n$$\n利用矩阵乘法的线性性质，$Q\\mu_i - Q\\mu_j = Q(\\mu_i - \\mu_j)$。设差分向量为 $v_{ij} = \\mu_i - \\mu_j$。\n那么 $R'_{ij} = \\|Q v_{ij}\\|_2^2$。\n根据我们上面的证明，$\\|Q v_{ij}\\|_2^2 = \\|v_{ij}\\|_2^2$。\n因此，\n$$\nR'_{ij} = \\|v_{ij}\\|_2^2 = \\|\\mu_i - \\mu_j\\|_2^2 = R_{ij}\n$$\n对角线元素 $R_{ii} = 0$ 和 $R'_{ii} = 0$ 也相等。由于对于任意选择的向量 $\\mu_i$ 和任意正交矩阵 $Q$，矩阵 $R$ 和 $R'$ 的所有对应元素都相等，因此这两个矩阵必然相同，$R = R'$。\n\n**步骤 5：计算差值的弗罗贝尼乌斯范数，$\\|R - R'\\|_F$**\n\n基于步骤 4 的理论论证，并通过步骤 2 和 3 中的显式计算得到证实，我们已经确定 $R = R'$。\n因此，差值矩阵是零矩阵：\n$$\nR - R' = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n矩阵 $A$ 的弗罗贝尼乌斯范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} a_{ij}^2}$。对于零矩阵，所有元素都为 $0$，因此它们的平方也为 $0$。\n$$\n\\|R - R'\\|_F = \\sqrt{0^2 + 0^2 + \\dots + 0^2} = \\sqrt{0} = 0\n$$\n两个 RDM 之间差值的弗罗贝尼乌斯范数为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在理解了为何使用正交变换来保持几何结构后，下一个自然的问题是如何找到能最佳对齐两个被试数据的那一个“正确”变换。这个问题通常被构建为一个正交普罗克汝斯 (Orthogonal Procrustes) 问题，即寻找一个最优旋转矩阵。本练习 () 设计了一个理想化的思想实验，其中两个被试的体素被完美地置换，这使得恢复对齐关系的目标变得直观，有助于你为普罗克汝斯分析框架建立坚实的直觉。",
            "id": "4168877",
            "problem": "考虑在相同的锁时自然刺激方案下，使用功能性磁共振成像（fMRI）观察的两名受试者。对于受试者 $1$，设其时间-体素数据矩阵为 $X \\in \\mathbb{R}^{T \\times V}$，其中 $T$ 是时间点的数量，$V$ 是体素的数量。假设 $X$ 的列是线性无关的，并且处于一般位置（没有重复或零列）。对于受试者 $2$，假设测量了相同的基础功能表征，但体素顺序被 $\\{1,\\dots,V\\}$ 的一个偶置换 $\\pi$ 所排列，得到 $Y = X P$，其中 $P \\in \\mathbb{R}^{V \\times V}$ 是与 $\\pi$ 相关联的置换矩阵。回想一下，置换矩阵 $P$ 满足 $P^\\top P = I$，并且如果 $\\pi$ 是偶置换，则 $\\det(P) = +1$，因此 $P \\in \\mathrm{SO}(V)$，即特殊正交群。\n\n超对齐可以建模为一个正交 Procrustes 问题：找到一个 $R \\in \\mathbb{R}^{V \\times V}$，在约束条件 $R^\\top R = I$ 下，最小化目标函数 $\\lVert Y R - X \\rVert_F^2$，并可选择性地加上约束条件 $\\det(R) = +1$。这里 $\\lVert \\cdot \\rVert_F$ 表示弗罗贝尼乌斯范数。跨体素的表征几何可以通过格拉姆矩阵 $G_X = X^\\top X$ 来表征，该矩阵编码了体素响应剖面随时间的内积。\n\n仅使用正交矩阵、置换矩阵、欧几里得范数和内积的基本性质，在上述背景下对以下陈述进行推理。选择所有正确的陈述。\n\nA. 在 $Y = X P$ 且 $\\pi$ 为偶置换的情况下，存在一个 $R \\in \\mathrm{SO}(V)$ 可以实现零误差的精确对齐，具体为 $R = P^\\top$，此时有 $Y R = X$ 和 $\\lVert Y R - X \\rVert_F^2 = 0$。\n\nB. 对于任何置换（偶数或奇数），$X$ 的行（体素空间中的时间点向量）之间的成对欧几里得距离与 $Y$ 的行之间的成对欧几里得距离相同，因为任何置换矩阵的右乘都相当于对体素坐标进行正交变换，并保持欧几里得距离不变。\n\nC. 如果超对齐变换被约束在特殊正交群 $\\mathrm{SO}(V)$ 内，并且受试者之间的体素置换是奇置换（因此 $\\det(P) = -1$），那么在所述假设下，精确恢复是不可能的；最小对齐误差严格为正。\n\nD. 格拉姆矩阵 $G_X = X^\\top X$ 在列置换下会以一种破坏共享几何的方式发生变化；因此，当体素顺序被置换时，共享几何在受试者之间不被保留。\n\nE. 在 $Y = X P$ 且 $X$ 为满列秩的设置中，正交 Procrustes 解 $R$是唯一的且等于 $P^\\top$，无论是否强制施加行列式约束 $\\det(R) = +1$。\n\n选择正确的选项。",
            "solution": "问题的核心是在 $R$ 的正交性约束下，最小化目标函数 $f(R) = \\lVert YR - X \\rVert_F^2$。我们已知理想化的关系 $Y = XP$，其中 $P$ 是一个置换矩阵。\n\n让我们将 $Y=XP$ 代入目标函数：\n$$ \\lVert YR - X \\rVert_F^2 = \\lVert (XP)R - X \\rVert_F^2 $$\n弗罗贝尼乌斯范数由迹内积导出，$\\lVert A \\rVert_F^2 = \\text{tr}(A^\\top A)$。其可能的最小值为 $0$，当且仅当其参数为零矩阵时取到。我们寻求一个正交矩阵 $R$，如果可能的话，使误差为零。\n$$ (XP)R - X = 0 $$\n$$ X(PR - I) = 0 $$\n其中 $I$ 是 $V \\times V$ 单位矩阵。\n问题陈述中提到 $X$ 的列是线性无关的。这意味着如果对于某个矩阵 $A \\in \\mathbb{R}^{V \\times V}$ 有 $X A = 0$，那么必然有 $A=0$。在我们的情况下，这意味着我们需要：\n$$ PR - I = 0 \\implies PR = I $$\n由于 $P$ 是一个置换矩阵，它是正交的，所以它的逆是它的转置：$P^{-1} = P^\\top$。\n$$ R = P^{-1} = P^\\top $$\n这表明，如果我们选择 $R = P^\\top$，对齐误差恰好为零：\n$$ \\lVert Y(P^\\top) - X \\rVert_F^2 = \\lVert (XP)P^\\top - X \\rVert_F^2 = \\lVert X(PP^\\top) - X \\rVert_F^2 = \\lVert XI - X \\rVert_F^2 = \\lVert 0 \\rVert_F^2 = 0 $$\n由于 $P$ 是正交的，$P^\\top$ 也是正交的，所以 $R = P^\\top$ 是无约束正交 Procrustes 问题（其中 $R \\in \\mathrm{O}(V)$）的一个有效解。由于可能的最小误差是 $0$，这就是最优解。\n\n如果矩阵 $B^\\top A$ 是满秩的，则正交 Procrustes 问题 $\\min_{R^\\top R=I} \\lVert AR-B \\rVert_F^2$ 的解的唯一性得到保证。在我们的例子中，这个矩阵是 $X^\\top Y = X^\\top (XP) = (X^\\top X)P$。由于 $X$ 的列是线性无关的，$X^\\top X$ 是正定的，因此是可逆的。$P$ 也是可逆的。因此，它们的乘积 $(X^\\top X)P$ 是可逆的（满秩），所以解是唯一的。\n\n我们现在将使用这些发现来评估每个陈述。\n\n### 逐项分析\n\n**A. 在 $Y = X P$ 且 $\\pi$ 为偶置换的情况下，存在一个 $R \\in \\mathrm{SO}(V)$ 可以实现零误差的精确对齐，具体为 $R = P^\\top$，此时有 $Y R = X$ 和 $\\lVert Y R - X \\rVert_F^2 = 0$。**\n\n如上所述，选择 $R = P^\\top$ 会导致零对齐误差：$\\lVert Y P^\\top - X \\rVert_F^2 = 0$，这意味着 $Y P^\\top = X$。\n该陈述要求这个解 $R$ 属于特殊正交群 $\\mathrm{SO}(V)$。这意味着必须满足两个条件：\n1. $R$ 必须是正交的：$R^\\top R = I$。\n2. $R$ 的行列式必须是 $+1$：$\\det(R) = +1$。\n\n对于 $R = P^\\top$：\n1. 由于 $P$ 是一个置换矩阵，它是正交的（$P^\\top P = I$）。它的转置 $R=P^\\top$ 也是正交的，因为 $R^\\top R = (P^\\top)^\\top P^\\top = P P^\\top = I$。\n2. 一个矩阵的转置的行列式等于该矩阵本身的行列式：$\\det(R) = \\det(P^\\top) = \\det(P)$。问题陈述中说置换 $\\pi$ 是偶置换，其对应的置换矩阵 $P$ 的行列式为 $\\det(P) = +1$。因此，$\\det(R) = +1$。\n\n由于 $R = P^\\top$ 是正交的且行列式为 $+1$，它属于 $\\mathrm{SO}(V)$。该陈述的所有部分都是正确的。\n**结论：正确。**\n\n**B. 对于任何置换（偶数或奇数），$X$ 的行（体素空间中的时间点向量）之间的成对欧几里得距离与 $Y$ 的行之间的成对欧几里得距离相同，因为任何置换矩阵的右乘都相当于对体素坐标进行正交变换，并保持欧几里得距离不变。**\n\n设 $x_i^\\top$ 和 $x_j^\\top$ 分别是矩阵 $X$ 的第 $i$ 行和第 $j$ 行。它们是 $\\mathbb{R}^{1 \\times V}$ 中的向量。这两个时间点在体素空间中的欧几里得距离的平方是 $\\lVert x_i^\\top - x_j^\\top \\rVert_2^2$。\n$Y = XP$ 的相应行是 $y_i^\\top = x_i^\\top P$ 和 $y_j^\\top = x_j^\\top P$。\n受试者 2 的欧几里得距离的平方是：\n$$ \\lVert y_i^\\top - y_j^\\top \\rVert_2^2 = \\lVert x_i^\\top P - x_j^\\top P \\rVert_2^2 = \\lVert (x_i^\\top - x_j^\\top)P \\rVert_2^2 $$\n设 $v^\\top = x_i^\\top - x_j^\\top$。范数的平方是 $\\lVert v^\\top P \\rVert_2^2 = (v^\\top P)(v^\\top P)^\\top = v^\\top P P^\\top v$。\n任何置换矩阵 $P$（无论是偶置换还是奇置换）都是正交的，即 $P P^\\top = I$。\n$$ v^\\top P P^\\top v = v^\\top I v = v^\\top v = \\lVert v^\\top \\rVert_2^2 $$\n因此，$\\lVert y_i^\\top - y_j^\\top \\rVert_2^2 = \\lVert x_i^\\top - x_j^\\top \\rVert_2^2$。欧几里得距离得以保持。陈述中提供的推理也是正确的：右乘一个正交矩阵（$P$）会保持欧几里得范数。\n**结论：正确。**\n\n**C. 如果超对齐变换被约束在特殊正交群 $\\mathrm{SO}(V)$ 内，并且受试者之间的体素置换是奇置换（因此 $\\det(P) = -1$），那么在所述假设下，精确恢复是不可能的；最小对齐误差严格为正。**\n\n在这种情况下，我们有 $Y=XP$ 且 $\\det(P)=-1$。我们寻求在 $R \\in \\mathrm{SO}(V)$ 的约束下最小化 $\\lVert YR - X \\rVert_F^2$。\n如初始推导所示，当且仅当 $R = P^\\top$ 时，才能实现零误差（$\\lVert YR - X \\rVert_F^2 = 0$）。\n让我们检查一下这个最优解 $R=P^\\top$ 是否满足约束条件 $R \\in \\mathrm{SO}(V)$。\n矩阵 $P^\\top$ 是正交的。然而，它的行列式是 $\\det(P^\\top) = \\det(P) = -1$。\n由于 $\\det(P^\\top) = -1$，矩阵 $R=P^\\top$ 属于 $\\mathrm{O}(V)$ 但不属于 $\\mathrm{SO}(V)$。\n约束条件要求解 $R$ 属于 $\\mathrm{SO}(V)$，因此唯一能给出零误差的变换 $R=P^\\top$ 是被禁止的。\n任何其他变换 $R' \\in \\mathrm{SO}(V)$ 都不会等于 $P^\\top$。对于任何 $R' \\neq P^\\top$，我们有 $PR' \\neq I$。\n由于 $X$ 的列是线性无关的，$X(PR' - I) \\neq 0$。\n因此，对于任何 $R' \\in \\mathrm{SO}(V)$，误差 $\\lVert YR' - X \\rVert_F^2 = \\lVert X(PR' - I) \\rVert_F^2$ 必须严格大于 $0$。\n所以，精确恢复是不可能的，且最小误差严格为正。\n**结论：正确。**\n\n**D. 格拉姆矩阵 $G_X = X^\\top X$ 在列置换下会以一种破坏共享几何的方式发生变化；因此，当体素顺序被置换时，共享几何在受试者之间不被保留。**\n\n让我们计算受试者 2 的格拉姆矩阵，$G_Y = Y^\\top Y$。\n$$ G_Y = (XP)^\\top(XP) = P^\\top X^\\top X P = P^\\top G_X P $$\n矩阵 $G_Y$ 通过正交矩阵 $P$ 的相似变换与 $G_X$ 相关。这种变换保留了基本的几何性质，最显著的是特征值。体素响应剖面之间的成对内积集合是保留的，尽管它们在矩阵中的排列被置换了。具体来说，如果 $Y$ 的列是 $y_k$，$X$ 的列是 $x_j$，且 $y_k = x_{\\pi(k)}$，那么 $G_Y$ 的 $(i, j)$ 项是 $y_i^\\top y_j = x_{\\pi(i)}^\\top x_{\\pi(j)}$，这正是 $G_X$ 的 $(\\pi(i), \\pi(j))$ 项。这只是对体素索引的重新标记，而不是对几何的破坏。许多对齐方法的核心假设正是这种几何结构是保留的并且可以被恢复。该陈述根本上是错误的。\n**结论：错误。**\n\n**E. 在 $Y = X P$ 且 $X$ 为满列秩的设置中，正交 Procrustes 解 $R$是唯一的且等于 $P^\\top$，无论是否强制施加行列式约束 $\\det(R) = +1$。**\n\n该陈述声称，对于无约束的正交问题（$R \\in \\mathrm{O}(V)$）和有约束的特殊正交问题（$R \\in \\mathrm{SO}(V)$），解都是 $R = P^\\top$。\n让我们分析这个说法。\n情况 1：无约束问题（$R \\in \\mathrm{O}(V)$）。如前所述，最小化 $\\lVert YR - X \\rVert_F^2$ 的唯一解确实是 $R = P^\\top$。\n情况 2：有约束问题（$R \\in \\mathrm{SO}(V)$）。解必须满足 $\\det(R)=+1$。\n\n考虑如果置换 $P$ 是奇置换，即 $\\det(P)=-1$ 时会发生什么。\n无约束解是 $R = P^\\top$。其行列式为 $\\det(P^\\top) = \\det(P) = -1$。\n有约束的解的行列式必须为 $+1$。因此，有约束的解不能是 $P^\\top$。\n在这种情况下，无约束问题的解与有约束问题的解是不同的。因此，“无论是否强制施加行列式约束”这一说法是错误的。只需一个反例即可证伪这一普遍性论断，而奇置换的情况就提供了这样一个反例。\n**结论：错误。**\n\n最终正确的陈述是 A、B 和 C。",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "前两个练习探讨了理想化的模型，但真实世界的 fMRI 数据充满了噪声，且特征之间常常高度相关（即病态条件）。直接应用基础的普罗克汝斯方法可能会导致解不稳定并过拟合噪声。本练习 () 引入了岭回归正则化，这是一种在实践中至关重要的修正，它通过引入微小的偏差来换取解的稳定性。通过推导正则化解并分析其特性，你将把理论知识与实际应用联系起来，理解在处理真实数据时所面临的权衡。",
            "id": "4168818",
            "problem": "在功能性大脑表征的超对齐中，研究者试图将被试特有的多变量时间序列对齐到一个公共表征空间中，从而使得同源刺激在不同被试间能引发相似的响应模式。考虑通过功能性磁共振成像（fMRI）观察两名被试，产生时间对齐的响应矩阵 $X \\in \\mathbb{R}^{T \\times d}$ 和 $Y \\in \\mathbb{R}^{T \\times d}$，其中 $T$ 是时间点的数量，$d$ 是特征的数量（例如，一个脑区内的体素或主成分）。超对齐通常将被试间的对齐建模为一个从 $X$ 到 $Y$ 的线性映射 $R \\in \\mathbb{R}^{d \\times d}$。\n\n从标准的最小二乘对齐原理出发，选择对齐映射 $R$ 以最小化由弗罗贝尼乌斯范数衡量的 $X R$ 和 $Y$ 之间的差异平方和。在存在噪声和病态条件的情况下，引入了对 $R$ 能量的二次惩罚（岭回归）。使用带有弗罗贝尼乌斯范数的最小二乘法的基本定义以及 Tikhonov（岭）正则化原理，推导出以下形式的岭正则化普罗克汝斯目标函数\n$$\n\\min_{R \\in \\mathbb{R}^{d \\times d}} \\ \\|X R - Y\\|_{F}^{2} + \\lambda \\|R\\|_{F}^{2},\n$$\n其中 $\\lambda  0$ 是正则化参数，并从矩阵微积分的基本原理出发，证明其无约束全局最小值点 $R^{\\star}$ 如何偏离正交性（即，通常情况下 $R^{\\star \\top} R^{\\star} \\neq I$）。基于 $X$ 的奇异值结构和岭惩罚的影响，解释这种偏离对于含噪数据的优缺点。\n\n然后，对于一个 $T = 3$ 和 $d = 2$ 的具体二维超对齐玩具实例，令\n$$\nX = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n1  1\n\\end{pmatrix},\n\\qquad\nY = \\begin{pmatrix}\n1  1 \\\\\n1  0 \\\\\n2  1\n\\end{pmatrix},\n$$\n并选择 $\\lambda = 1$。计算全局最小值点 $R^{\\star}$，并通过弗罗贝尼乌斯范数差异量化其与正交性的偏离程度\n$$\n\\Delta \\equiv \\|R^{\\star \\top} R^{\\star} - I\\|_{F}.\n$$\n将最终的 $\\Delta$ 表示为精确的闭式解析表达式；不要近似或四舍五入。由于 $\\Delta$ 是无量纲的，因此不需要物理单位。",
            "solution": "所陈述的问题具有科学依据，是适定且客观的。它基于线性代数、矩阵微积分和正则化理论的既定原则，并应用于计算神经科学中的一个标准问题。所有必要的数据和定义都已提供，且内部没有矛盾。因此，该问题被认为是有效的，可以构建解答。\n\n该问题要求两个主要部分：首先，对岭正则化的普罗克汝斯目标函数进行一般性推导和分析；其次，对一个玩具示例进行具体计算。\n\n**第1部分：一般性推导与分析**\n\n待最小化的目标函数由下式给出\n$$\nL(R) = \\|X R - Y\\|_{F}^{2} + \\lambda \\|R\\|_{F}^{2}\n$$\n其中 $X \\in \\mathbb{R}^{T \\times d}$，$Y \\in \\mathbb{R}^{T \\times d}$，$R \\in \\mathbb{R}^{d \\times d}$，且 $\\lambda  0$。矩阵 $A$ 的弗罗贝尼乌斯范数定义为 $\\|A\\|_F = \\sqrt{\\sum_{i,j} A_{ij}^2}$，其平方可以方便地使用迹算子表示：$\\|A\\|_{F}^{2} = \\text{Tr}(A^{\\top} A)$。\n\n将此属性应用于目标函数，我们得到：\n$$\nL(R) = \\text{Tr}((X R - Y)^{\\top}(X R - Y)) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n我们展开第一项：\n$$\nL(R) = \\text{Tr}((R^{\\top}X^{\\top} - Y^{\\top})(X R - Y)) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n$$\nL(R) = \\text{Tr}(R^{\\top}X^{\\top}XR - R^{\\top}X^{\\top}Y - Y^{\\top}XR + Y^{\\top}Y) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n利用迹算子的线性性质 $\\text{Tr}(A+B) = \\text{Tr}(A) + \\text{Tr}(B)$ 及其循环性质 $\\text{Tr}(ABC) = \\text{Tr}(CAB)$，我们注意到 $\\text{Tr}(Y^\\top X R) = \\text{Tr}((Y^\\top X R)^\\top) = \\text{Tr}(R^\\top X^\\top Y)$。因此，两个交叉项是相同的。目标函数变为：\n$$\nL(R) = \\text{Tr}(R^{\\top}X^{\\top}XR) - 2\\text{Tr}(R^{\\top}X^{\\top}Y) + \\text{Tr}(Y^{\\top}Y) + \\lambda \\text{Tr}(R^{\\top}R)\n$$\n为了找到最小值点 $R^{\\star}$，我们计算 $L(R)$ 关于 $R$ 的梯度，并将其设为零矩阵。使用标准的矩阵微积分法则：\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}A R B) = A^{\\top} R B^{\\top} + A R B \\quad (\\text{此处， } A=X^\\top X, B=I) \\implies \\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}X^{\\top}XR) = 2 X^{\\top}XR\n$$\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}C) = C \\quad (\\text{此处， } C=X^\\top Y) \\implies \\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}X^{\\top}Y) = X^{\\top}Y\n$$\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(R^{\\top}R) = 2R\n$$\n$$\n\\frac{\\partial}{\\partial R} \\text{Tr}(Y^{\\top}Y) = 0\n$$\n因此，$L(R)$ 的梯度为：\n$$\n\\nabla_R L(R) = 2X^{\\top}XR - 2X^{\\top}Y + 2\\lambda R\n$$\n将梯度设为零以求最优的 $R^{\\star}$：\n$$\n2X^{\\top}XR^{\\star} - 2X^{\\top}Y + 2\\lambda R^{\\star} = 0\n$$\n$$\nX^{\\top}XR^{\\star} + \\lambda R^{\\star} = X^{\\top}Y\n$$\n$$\n(X^{\\top}X + \\lambda I)R^{\\star} = X^{\\top}Y\n$$\n矩阵 $X^{\\top}X$ 是半正定的。由于 $\\lambda  0$，矩阵 $\\lambda I$ 是正定的。因此，和 $(X^{\\top}X + \\lambda I)$ 是正定的，从而也是可逆的。我们可以解出 $R^{\\star}$：\n$$\nR^{\\star} = (X^{\\top}X + \\lambda I)^{-1} X^{\\top}Y\n$$\n由于目标函数是严格凸的，这是唯一的全局最小值点。\n\n现在我们来分析其与正交性的偏离。一个正交矩阵 $R_o$ 满足 $R_o^{\\top}R_o = I$。推导出的解 $R^{\\star}$ 通常不是正交的。项 $\\lambda \\|R\\|_F^2$ 惩罚具有大弗罗贝尼乌斯范数的解。由于 $\\|R\\|_F^2 = \\text{Tr}(R^\\top R) = \\sum_i \\sigma_i^2$，其中 $\\sigma_i$ 是 $R$ 的奇异值，这个惩罚项会将解的奇异值“收缩”到零。正交矩阵的所有奇异值都等于 $1$。正则化项将解从这个约束中拉开，导致变换不纯粹是旋转/反射，而是包含了缩放。\n\n这种偏离的**优点**源于解的稳定性。来自真实数据的矩阵 $X$ 通常是病态的，意味着其列高度相关。这使得 $X^{\\top}X$ 近乎奇异，带有一些非常小的特征值。在非正则化的情况下（$\\lambda=0$），解 $R_0 = (X^{\\top}X)^{-1}X^{\\top}Y$ 会涉及对这个病态矩阵求逆。$X^{\\top}X$ 的小特征值在其逆矩阵中会变成非常大的特征值，从而放大了 $Y$ 中存在的任何噪声。解 $R_0$ 会非常不稳定并过拟合数据。通过加上 $\\lambda I$，我们在求逆之前将正常数 $\\lambda$ 加到 $X^{\\top}X$ 的每个特征值上。如果 $\\sigma_i^2$ 是 $X^\\top X$ 的特征值，那么 $(X^\\top X + \\lambda I)^{-1}$ 的特征值是 $1/(\\sigma_i^2 + \\lambda)$。这可以防止分母接近于零，从而稳定了逆矩阵，进而稳定了解 $R^{\\star}$。这是一个经典的偏差-方差权衡：我们引入偏差（解不再是真正的最小二乘拟合），以减小方差（解对噪声更具鲁棒性）。\n\n其**缺点**是，得到的变换 $R^{\\star}$ 是有偏的，并且不是一个等距变换。它会收缩数据，尤其是在 $X$ 的低方差方向上（对应于 $X^\\top X$ 的小特征值）。如果基础科学假设是大脑表征之间通过纯旋转（一种等距变换）相关联，那么这种收缩会扭曲几何关系，这可能是不希望看到的。正则化可能会衰减那些恰好位于低方差方向上的微弱但有意义的信号。\n\n**第2部分：具体计算**\n\n给定 $T=3$，$d=2$，$\\lambda=1$，以及矩阵：\n$$\nX = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix}, \\qquad Y = \\begin{pmatrix} 1  1 \\\\ 1  0 \\\\ 2  1 \\end{pmatrix}\n$$\n首先，我们计算 $X^{\\top}X$ 和 $X^{\\top}Y$：\n$$\nX^{\\top}X = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1+0+1  0+0+1 \\\\ 0+0+1  0+1+1 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\nX^{\\top}Y = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  0 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} 1+0+2  1+0+1 \\\\ 0+1+2  0+0+1 \\end{pmatrix} = \\begin{pmatrix} 3  2 \\\\ 3  1 \\end{pmatrix}\n$$\n接着，我们用 $\\lambda=1$ 计算 $R^{\\star} = (X^{\\top}X + \\lambda I)^{-1} X^{\\top}Y$：\n$$\nX^{\\top}X + \\lambda I = \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + 1 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix}\n$$\n该矩阵的逆是：\n$$\n(X^{\\top}X + \\lambda I)^{-1} = \\frac{1}{3 \\cdot 3 - 1 \\cdot 1} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix} = \\frac{1}{8} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix}\n$$\n现在，我们可以求出 $R^{\\star}$：\n$$\nR^{\\star} = \\frac{1}{8} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix} \\begin{pmatrix} 3  2 \\\\ 3  1 \\end{pmatrix} = \\frac{1}{8} \\begin{pmatrix} 9-3  6-1 \\\\ -3+9  -2+3 \\end{pmatrix} = \\frac{1}{8} \\begin{pmatrix} 6  5 \\\\ 6  1 \\end{pmatrix}\n$$\n为了量化与正交性的偏离程度，我们计算 $\\Delta = \\|R^{\\star \\top} R^{\\star} - I\\|_{F}$。首先，我们计算 $R^{\\star \\top} R^{\\star}$：\n$$\nR^{\\star \\top} = \\frac{1}{8} \\begin{pmatrix} 6  6 \\\\ 5  1 \\end{pmatrix}\n$$\n$$\nR^{\\star \\top} R^{\\star} = \\left(\\frac{1}{8}\\right)^2 \\begin{pmatrix} 6  6 \\\\ 5  1 \\end{pmatrix} \\begin{pmatrix} 6  5 \\\\ 6  1 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 36+36  30+6 \\\\ 30+6  25+1 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 72  36 \\\\ 36  26 \\end{pmatrix}\n$$\n接下来，我们减去单位矩阵 $I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$：\n$$\nR^{\\star \\top} R^{\\star} - I = \\frac{1}{64} \\begin{pmatrix} 72  36 \\\\ 36  26 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 72-64  36 \\\\ 36  26-64 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 8  36 \\\\ 36  -38 \\end{pmatrix}\n$$\n最后，我们计算这个差分矩阵的弗罗贝尼乌斯范数：\n$$\n\\Delta^2 = \\|R^{\\star \\top} R^{\\star} - I\\|_{F}^{2} = \\left(\\frac{1}{64}\\right)^2 \\left( 8^2 + 36^2 + 36^2 + (-38)^2 \\right)\n$$\n$$\n\\Delta^2 = \\frac{1}{4096} \\left( 64 + 1296 + 1296 + 1444 \\right) = \\frac{1}{4096} \\left( 4100 \\right) = \\frac{4100}{4096}\n$$\n我们可以通过将分子和分母同时除以 $4$ 来简化这个分数：\n$$\n\\Delta^2 = \\frac{1025}{1024}\n$$\n取平方根求 $\\Delta$：\n$$\n\\Delta = \\sqrt{\\frac{1025}{1024}} = \\frac{\\sqrt{1025}}{\\sqrt{1024}} = \\frac{\\sqrt{25 \\cdot 41}}{32} = \\frac{5\\sqrt{41}}{32}\n$$\n这就是与正交性偏离程度的最终精确表达式。",
            "answer": "$$\n\\boxed{\\frac{5\\sqrt{41}}{32}}\n$$"
        }
    ]
}