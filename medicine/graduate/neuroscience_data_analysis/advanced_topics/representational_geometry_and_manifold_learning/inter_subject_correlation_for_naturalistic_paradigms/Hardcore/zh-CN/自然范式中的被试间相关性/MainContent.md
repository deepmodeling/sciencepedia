## 引言
随着神经科学研究从高度受控的简单任务转向模拟真实世界的自然情境范式（如观看电影或聆听故事），我们迫切需要能够处理复杂、连续刺激下大脑活动的分析工具。传统的通用线性模型（GLM）在面对难以完全[参数化](@entry_id:265163)的自然刺激时显得力不从心。为了填补这一空白，[被试间相关性](@entry_id:1126568)（Inter-Subject Correlation, ISC）分析应运而生，它通过直接比较不同被试在接收相同刺激时的大脑活动同步性，成为一种强大而灵活的“无模型”方法。

本文旨在为研究生及相关领域研究者提供一份关于ISC分析的全面指南。您将系统性地学习到ISC的理论精髓、应用广度与实践智慧。文章分为三个核心部分：首先，在“原理与机制”一章中，我们将深入探讨ISC的数学基础、统计特性以及进行有效[统计推断](@entry_id:172747)的关键考量。接着，“应用与跨学科连接”一章将展示ISC如何被扩展应用于绘制大[脑网络](@entry_id:912843)动态图谱、连接神经活动与行为，并与EEG/MEG等[多模态数据](@entry_id:635386)和[计算模型](@entry_id:637456)（如SRM）相结合。最后，“动手实践”部分提供了三个精心设计的编程练习，帮助您将理论知识转化为实际操作技能。

现在，让我们从ISC分析最根本的“是什么”和“为什么”出发，一同探索其核心原理与机制。

## 原理与机制

本章深入探讨了[被试间相关性](@entry_id:1126568)（Inter-Subject Correlation, ISC）分析的核心原理与机制。我们将从其基本定义出发，阐明其作为一种[神经科学数据分析](@entry_id:1128665)方法的独特之处，并详细解析其背后的数学与统计学基础。此外，本章还将系统性地讨论在实际应用中必须考虑的关键问题，包括统计推断的有效性、空间对齐的挑战以及潜在的混淆因素。

### 跨被试相关性的基本定义与理论基础

在自然情境范式下，例如观看电影或收听故事，所有被试都暴露于同一个连续、动态变化的刺激。ISC分析的核心思想是，如果一个大脑区域的活动是由这个共享刺激可靠驱动的，那么不同被试在该区域的神经活动时间序列应当表现出同步性。ISC方法巧妙地利用一个被试的大脑响应作为预测另一个被试大脑响应的模型，从而量化这种跨被试的同步程度。

#### 跨被试相关性 (ISC) 与试次[重测信度](@entry_id:924530) (TRR)

从形式上看，对于在特定脑区（例如一个体素或一个感兴趣区域）记录的连续时间序列信号 $x_i(t)$（代表被试 $i$ 在时间点 $t$ 的信号），两名被试 $i$ 和 $j$ 之间的 **成对ISC (pairwise ISC)** 被定义为他们时间序列之间的皮尔逊相关系数 $r_{ij}$。为了获得一个代表整个样本的概括性指标，通常会对所有可能的被试对的[相关系数](@entry_id:147037)进行平均。一种标准的做法是先通过 **Fisher $z$ 变换** ($z = \text{arctanh}(r)$) 将相关系数 $r$ 转换为近似正态分布的 $z$ 值，然后计算 $z$ 值的平均数，最后再将平均后的 $z$ 值逆变换回 $r$ 值。这个最终的 $r$ 值量化了由共同刺激所锁定的、跨个体的神经活动同步性。

重要的是要将ISC与另一个相关但概念上截然不同的指标——**试次[重测信度](@entry_id:924530) (Test-Retest Reliability, TRR)**——区分开来 。TRR旨在评估单个被试测量值的稳定性。要计算TRR，需要让同一个被试 $i$ 在两次独立的实验中经历相同的实验范式（例如观看同一部电影两次），从而得到两个时间序列 $x_i^{(1)}(t)$ 和 $x_i^{(2)}(t)$。TRR就是这两个时间序列之间的相关性。因此，ISC衡量的是 **不同被试之间** 的同步性，其变异主要反映了共享的刺激驱动响应；而TRR衡量的是 **同一个被试内部** 响应的稳定性，它同时包含了共享的刺激驱动成分和个体特有的、稳定的响应模式。

#### 与通用线性模型 (GLM) 的对比

ISC分析的另一个显著特点是，它在量化刺激驱动的响应时，是一种“无模型” (model-free) 的方法——特指它不需要关于刺激具体特征的先验模型。这与传统的 **通用[线性模型](@entry_id:178302) (General Linear Model, GLM)** 分析形成了鲜明对比 。在GLM框架下，研究者必须构建一个[设计矩阵](@entry_id:165826) $X(t)$，其中包含描述刺激特征（例如，事件的发生、任务条件的切换）的回归量。随后，将每个被试的[BOLD信号](@entry_id:905586) $y_{s,v}(t)$ 对该[设计矩阵](@entry_id:165826)进行回归拟合：$y_{s,v}(t) = X(t)\beta_{s,v} + \eta_{s,v}(t)$。

对于特征复杂、连续且难以完全[参数化](@entry_id:265163)的自然情境刺激（如电影），构建一个完整的设计矩阵 $X(t)$ 变得极具挑战性。任何对刺激特征的遗漏或错误设定都将导致GLM低估由刺激驱动的真实方差，因为未被建模的共享响应将被归入残差项 $\eta_{s,v}(t)$ 中。ISC通过直接比较被试间的大脑信号，巧妙地绕开了这一难题。它对任何能够在被试间产生可靠时间锁定响应的刺激成分都敏感，无论这些成分是否被研究者先验地识别和量化。因此，在探索复杂的自然情境刺激所引发的神经响应时，ISC能够捕捉到可能被设定不当的GLM所忽略的共享神经活动。

### 自然情境范式的有效性机制

为何像电影或叙事故事这样复杂的自然情境刺激能够有效地在不同个体间诱发同步的神经活动？答案在于这些刺激的内在结构与大脑处理信息的方式之间的相互作用。我们可以将观测到的信号 $x_i(t)$ 分解为一个共享的、由刺激锁定的成分和一个 idiosyncratic（个体特有）的成分 。

一个具有丰富时间结构的自然情境刺激（例如，包含情节、事件边界和情感弧线的电影）能够可靠地、持续地调动个体的多种高级认知过程，包括注意力、[记忆提取](@entry_id:915397)、场景分割和[情绪加工](@entry_id:909958)。这些认知过程被刺激中的事件以时间锁定的方式在不同被试间同步驱动。这就在被试间产生了一个高方差的、共享的神经响应轨迹。尽管[血流动力学](@entry_id:1121718)响应（HRF）的慢速特性会对神经信号进行低通滤波，但由叙事结构驱动的强劲、缓慢的信号波动得以保留。

其结果是，在总信号中，共享成分的“[信噪比](@entry_id:271861)”得以大幅提升。共享信号的方差 $\text{Var}(s_i)$ 远大于个体特有噪声的方差 $\text{Var}(\nu_i)$，从而导致了较高的IS[C值](@entry_id:272975)。相比之下，如果将刺激的时间序列打乱（即时间置乱），虽然保留了低阶的[频谱](@entry_id:276824)特性，但破坏了对于同步高级认知过程至关重要的高阶时序依赖性。此时，共享信号成分会变得微弱且无结构，尤其是在高级联合皮层，导致ISC显著下降。而对于[白噪声](@entry_id:145248)这类完全无结构的刺激，除了可能在初级感觉皮层引发一些同步的随机追踪外，它无法有效驱动整合性的高级认知过程，因此在大部分脑区观测到的ISC会接近于零 。

### ISC估计量的数学与统计特性

ISC的核心计算是[皮尔逊相关](@entry_id:260880)，理解其数学性质对于正确解读结果至关重要。同时，不同的ISC计算方案（估计量）也具有不同的统计特性。

#### 皮尔逊相关系数的核心性质

将ISC定义为[皮尔逊相关系数](@entry_id:918491)，赋予了它一系列明确的数学属性。设两个去均值后的时间序列向量为 $\mathbf{u}_i$ 和 $\mathbf{u}_j$，ISC可以表示为这两个向量夹角的余弦：$r_{ij} = \frac{\langle \mathbf{u}_i, \mathbf{u}_j \rangle}{\|\mathbf{u}_i\| \|\mathbf{u}_j\|}$。基于这一定义和柯西-[施瓦茨不等式](@entry_id:202153)，我们可以确立以下关键性质 ：

1.  **对称性 (Symmetry)**: 由于协方差的定义是对称的，即 $\text{cov}(x_i, x_j) = \text{cov}(x_j, x_i)$，因此ISC也是对称的：$r_{ij} = r_{ji}$。
2.  **有界性 (Boundedness)**: ISC的值被限定在 $[-1, 1]$ 区间内。当且仅当一个被试的去均值时间序列是另一个被试的线性变换时（即 $\mathbf{u}_j = a \mathbf{u}_i$ 对于某个非零常数 $a$），相关性的绝对值才会达到 $1$。
3.  **[仿射变换](@entry_id:144885)[不变性](@entry_id:140168) (Invariance to Affine Transformations)**: [皮尔逊相关系数](@entry_id:918491)对于尺度的改变和偏移是不变的。这意味着，如果我们将一个被试的时间序列乘以一个正常数 $a$ 并加上一个常数 $b$（即 $x'_i(t) = a x_i(t) + b$），其与任何其他被试 $j$ 的IS[C值](@entry_id:272975) $r_{ij}$ 保持不变。如果乘以一个负常数，IS[C值](@entry_id:272975)的符号会反转。这一性质非常重要，因为它意味着ISC对被试间[BOLD信号](@entry_id:905586)的平均幅度和绝对基线的差异具有鲁棒性，从而更专注于信号波动的形态相似性 。

需要特别强调的是，ISC对时间失准极其敏感。对一个时间序列进行哪怕是很小的平移，都可能使其与另一个时间序列的相关性大幅降低甚至消失。因此，精确的时间对齐是ISC分析的绝对前提 。

#### 常用ISC估计量的比较

在实践中，有几种计算ISC的方案。我们可以通过一个简单的生成模型 $y_i(t) = s(t) + \varepsilon_i(t)$ 来理解它们的差异，其中 $s(t)$ 是方差为 $\sigma_s^2$ 的共享信号，$\varepsilon_i(t)$ 是方差为 $\sigma_\varepsilon^2$ 且跨被试独立的噪声 。

1.  **成对ISC (Pairwise ISC)**: 这是最直接的方法，计算所有被试对 $(i, j)$ 的[相关系数](@entry_id:147037) $r_{ij}$，然后取平均。其期望的总体相关性参数为 $\rho_{\text{pair}} = \frac{\text{Cov}(y_i, y_j)}{\sqrt{\text{Var}(y_i)\text{Var}(y_j)}} = \frac{\sigma_s^2}{\sigma_s^2 + \sigma_\varepsilon^2}$ 。

2.  **留一法ISC (Leave-One-Out, LOO-ISC)**: 此方法将每个被试 $i$ 的时间序列与其余所有 $N-1$ 个被试的平均时间序列 $m_{-i}(t)$ 进行相关。$m_{-i}(t)$ 是对共享信号 $s(t)$ 的一个更优估计，因为 averaging out（平均掉）了大部分噪声。其总体相关性参数为 $\rho_{\text{LOO}}(N) = \frac{\sigma_s^2}{\sqrt{(\sigma_s^2 + \sigma_\varepsilon^2)(\sigma_s^2 + \frac{\sigma_\varepsilon^2}{N-1})}}$。当 $N > 2$ 时，$\rho_{\text{LOO}}(N) > \rho_{\text{pair}}$，这意味着LOO-ISC相对于成对ISC是一个有偏估计量，它会系统性地高估成[对相关](@entry_id:203353)性。然而，由于其[信噪比](@entry_id:271861)更高，LOO-ISC通常具有更低的采样方差，使其在统计功效上更优。随着[样本量](@entry_id:910360) $N$ 趋于无穷，$\rho_{\text{LOO}}(N)$ 收敛于 $\sqrt{\rho_{\text{pair}}}$ 。

3.  **包含自身的组平均ISC (Group-Mean Including Self)**: 即将被试 $i$ 与包含其自身在内的所有被试的平均时间序列 $m(t)$ 相关。这种方法引入了循环性（circularity），因为被试 $i$ 的噪声 $\varepsilon_i(t)$ 同时出现在了被相关的两个时间序列中。这会人为地拔高相关性，使其[期望值](@entry_id:150961)甚至高于LOO-ISC。因此，这种方法通常不被推荐使用 。

基于这些分析，LOO-ISC因其在[统计功效](@entry_id:197129)上的优势而成为一种广受欢迎的计算方案，但研究者需要意识到它与真实成[对相关](@entry_id:203353)性之间的系统性偏差。

### 统计推断：评估显著性

观察到一个非零的ISC值后，我们必须进行统计推断来判断这个值是否显著大于机会水平。fMRI时间序列数据固有的 **[自相关](@entry_id:138991)性 (autocorrelation)** 是此处最大的挑战。

#### [参数化](@entry_id:265163)校正：[有效自由度](@entry_id:161063)

标准的[皮尔逊相关](@entry_id:260880)性显著性检验（例如，使用 $t$ 分布）假设样本是[独立同分布](@entry_id:169067)的。然而，fMRI信号由于[血流动力学](@entry_id:1121718)响应的慢速特性和生理噪声的存在，表现出显著的时间自相关性（即，一个时间点的值与其相邻时间点的值相关）。正自相关意味着时间序列的“有效”[独立样本](@entry_id:177139)数远小于其名义上的样本数（即时间点总数 $N$）。

如果忽略自相关性，直接使用名义样本数 $N$ 进行检验，会低估[相关系数](@entry_id:147037)在零假设下的真实采样方差，从而导致检验统计量被人为拔高，$p$ 值被低估。这会使得I类错误率（假阳性率）膨胀，导致我们将纯属偶然的发现误判为显著结果 。

一种校正方法是估算 **有效样本数 (effective sample size)**，或称 **[有效自由度](@entry_id:161063) ($n_{\text{eff}}$)**。对于两个自回归参数分别为 $\phi_x$ 和 $\phi_y$ 的一阶自回归(AR(1))过程，有效样本数可以近似为：
$$ n_{\text{eff}} \approx N \frac{1 - \phi_x \phi_y}{1 + \phi_x \phi_y} $$
例如，对于长度为 $N=600$ 的两个时间序列，其AR(1)参数分别为 $\phi_x=0.6$ 和 $\phi_y=0.5$，计算出的有效样本数约为 $323$，远小于 $600$。

获得 $n_{\text{eff}}$ 后，一个稳健的统计检验流程如下 ：
1.  对观测到的相关系数 $r$ 进行Fisher $z$ 变换：$z_r = \text{arctanh}(r)$。
2.  计算[检验统计量](@entry_id:897871) $Z = z_r \sqrt{n_{\text{eff}}-3}$。在[零假设](@entry_id:265441)下，$Z$ 近似服从[标准正态分布](@entry_id:184509) $N(0,1)$。
3.  根据 $Z$ 值计算相应的 $p$ 值。

#### 非[参数化](@entry_id:265163)方法：置换与[自助法](@entry_id:1121782)检验

非[参数化](@entry_id:265163)方法通过从数据自身构建[零分布](@entry_id:195412)，放宽了对数据分布的假设。其关键在于生成代理数据 (surrogate data) 时，必须在打破我们关心的效应（跨被试同步性）的同时，保持可能影响统计量分布的“滋扰”属性（如自相关性）。

-   **错误方法：时间点置换 (Time-point permutation)**: 将每个被试的时间序列独立地进行[随机置换](@entry_id:268827)。这种方法虽然打破了跨被试同步性，但也彻底摧毁了每个时间序列内部的自相关结构。用这种方法生成的零分布，其方差会被人为地低估，同样导致假阳性率膨胀 。

-   **正确方法：[移动块自助法](@entry_id:169926) (Moving block bootstrap)**: 此方法通过[重复抽样](@entry_id:274194)数据中的连续块（block）来构建代理数据。由于块内的原始时间顺序得以保留，数据的局部[自相关](@entry_id:138991)结构也得到了保留。为了对窗口长度为 $W$ 的动态ISC进行有效的检验，选择的块长 $L$ 应当至少与 $W$ 相当（$L \ge W$），以确保代理数据能够正确地反映原始数据在分析窗口内的依赖结构。这种方法生成的[零分布](@entry_id:195412)能够正确地体现出[自相关数据](@entry_id:746580)应有的、更大的采样方差，从而提供一个有效的显著性检验 。其他有效的方法还包括基于傅里叶变换的相位随机化等。

### 实践考量与潜在混淆因素

在将ISC应用于真实数据时，一些实际问题和潜在的混淆因素可能会严重影响结果的有效性和解释。

#### 空间对应性问题

体素级别（voxelwise）的ISC分析依赖于一个核心假设：在标准解剖空间（如[MNI空间](@entry_id:1127985)）中的同一个体素坐标，对应于不同被试大脑中具有相同功能的区域。然而，**解剖对齐不等于[功能对齐](@entry_id:1125376)** 。大脑的宏观解剖结构（如[脑沟和脑回](@entry_id:905148)）在个体间具有一定的共性，但精细的功能区域（如视觉皮层的朝向柱）的位置和范围在个体间存在显著差异。

这种解剖-功能的不匹配意味着，在标准空间的某个体素 $v^\star$，其记录的信号可能是不同功能信号的混合体。我们可以用一个简单的模型来理解其后果：$x_{s,v^\star}(t) = a_s s(t) + b_s u_s(t)$，其中 $s(t)$ 是共享信号，$u_s(t)$ 是个体特有信号，$a_s$ 和 $b_s$ 是[混合系数](@entry_id:1127968)。由于功能区域的错位，不同被试在同一体素坐标下的 $a_s$ 值会有很大差异。如果某个被试 $k$ 的 $a_k$ 值很小（即该体素几乎不包含与共享[信号相关](@entry_id:274796)的区域），那么他/她与其他任何被试在该体素的ISC值都会很低。此外，个体特有信号 $u_s(t)$ 的存在（即 $b_s \neq 0$）会增加总方差（分母），从而稀释（衰减）相关性（分子不变）。这两个因素共同作用，导致由于空间错位而测得的IS[C值](@entry_id:272975)被系统性地低估。这也解释了为何在实践中，除了体素级别分析，研究者也常采用感兴趣区域（ROI）平均或搜索灯（searchlight）等方法来部分缓解这一问题。

#### 共享的“滋扰”信号作为混淆

ISC量化的是任何在被试间同步的、且与刺激时间锁定的信号。这意味着，除了我们感兴趣的高级认知过程外，一些非神经源的“滋扰”信号如果也在被试间同步，就会产生“伪”ISC。

-   **共享的生理伪迹**: 一个设计精良的刺激，比如一部悬疑电影，可能会在紧张的场景中系统性地改变所有观众的呼吸或心率。这些同步的生理变化会通过对BOLD信号的直接影响，在全脑范围内（尤其是在大血管附近）产生显著的ISC，但这并不反映对电影内容的认知加工 。

-   **共享的眼动行为**: 在观看视觉叙事时，这是一个主要的混淆因素。导演的镜头语言会引导观众的注意力，使得大部分被试的注视点、扫视和眨眼模式高度同步。由于初级视觉皮层是 **[视网膜拓扑](@entry_id:896798)映射 (retinotopic)** 的，同步的眼动导致了同步的[视网膜](@entry_id:148411)输入，进而驱动了初级视觉皮层中同步的神经活动和BOLD信号。这种ISC是真实存在的，但它反映的是低级的、由眼动介导的感觉输入同步，而非必然是高级的认知理解同步 。

    对此类已知的、可测量的混淆源，标准的控制策略是：将这些“滋扰”信号（例如，从眼动仪记录的注视点坐标、扫视/眨眼事件、瞳孔直径等）作为回归量，为每个被试构建一个GLM。这些回归量需先与HRF进行卷积。然后，从原始BOLD信号中回归掉这些滋扰变量所能解释的方差，得到残差时间序列。最后，在这些“净化”后的残差序列上计算ISC。通过比较回归前后的ISC图，可以量化并评估混淆因素的贡献 。

#### 个体特异性的时间动态

ISC分析的基本假设是信号在被试间的完美时间对齐。现实中这一假设也可能被打破。

-   **[血流动力学](@entry_id:1121718)响应 (HRF) 的变异**: 不同被试的HRF可能存在差异。如果差异主要体现在一个恒定的延迟上，可以通过计算 **时滞ISC (lagged ISC)** 来解决。但如果差异体现在HRF的形状上（例如，宽度或弥散程度），这会降低零时滞的ISC，需要更高级的方法（如解卷积）来处理 。

-   **非均匀时间扭曲 (Non-uniform time warping)**: 在某些任务中（如阅读），被试可能会以略微不同的速度处理信息。这会导致他们的神经响应在时间轴上相对于彼此发生[非线性](@entry_id:637147)的拉伸或压缩。这种“时间扭曲”会破坏标准ISC所依赖的线性时间对齐，需要专门的[动态时间规整](@entry_id:168022)算法来校正 。

总之，ISC作为一种强大的自然情境[神经数据分析](@entry_id:1128577)工具，其应用和解释需要建立在对其核心原理、统计特性和潜在局限的深刻理解之上。本章所阐述的机制为后续章节中更高级的应用和方法论探讨奠定了坚实的基础。