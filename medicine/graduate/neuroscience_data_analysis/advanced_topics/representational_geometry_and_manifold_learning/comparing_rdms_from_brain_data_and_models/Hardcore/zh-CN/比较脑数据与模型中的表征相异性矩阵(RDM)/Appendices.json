{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立您对两种广泛使用的相异性度量的基础理解。通过分析推导在线性变换下余弦距离和相关距离之间的差异，您将揭示区分它们的核心数学特性。这项实践对于明智地选择使用哪种度量至关重要，因为它突出了它们对神经模式的整体振幅和基线的不同敏感性 。",
            "id": "4147129",
            "problem": "考虑单个大脑区域中的两个条件响应向量，表示为 $x \\in \\mathbb{R}^{p}$ 和 $y \\in \\mathbb{R}^{p}$，其中 $p \\geq 2$ 是测量通道（例如，体素）的数量。设 $x$ 为给定条件的经验大脑模式，并假设模型对同一条件的预测由线性变换 $y = \\gamma x + \\beta \\mathbf{1}$ 给出，其中 $\\mathbf{1} \\in \\mathbb{R}^{p}$ 是全1向量，$\\gamma \\in \\mathbb{R} \\setminus \\{0\\}$ 是一个缩放参数，$\\beta \\in \\mathbb{R}$ 是一个加性偏移量。将 $x$ 的均值表示为 $\\bar{x} = \\frac{1}{p} \\sum_{i=1}^{p} x_{i}$，并假设 $\\|x - \\bar{x}\\mathbf{1}\\| \\neq 0$，以使中心化变异是非退化的。对于给定的相异性度量，一对向量的表征相异性矩阵（RDM）条目定义为1减去相应的相似性。\n\n仅使用余弦距离（1减余弦相似性）和相关距离（1减在均值中心化向量上计算的皮尔逊相关系数）的标准定义，推导基于余弦和基于相关的RDM条目之差的闭式解析表达式，\n$$\\Delta \\equiv d_{\\mathrm{cos}}(x,y) - d_{\\mathrm{corr}}(x,y),$$\n用 $p$、$\\gamma$、$\\beta$、$\\bar{x}$ 和 $\\|x\\|$ 来表示。将您的最终答案表示为单个简化的解析表达式。不需要四舍五入，也不涉及单位。",
            "solution": "问题要求推导两个向量 $x, y \\in \\mathbb{R}^p$（其中 $y$ 是 $x$ 的线性变换）的基于余弦和基于相关的 RDM 条目之差的闭式表达式。该差异表示为 $\\Delta \\equiv d_{\\mathrm{cos}}(x,y) - d_{\\mathrm{corr}}(x,y)$。\n\n相异性的定义为 $d = 1 - s$，其中 $s$ 是相应的相似性度量。\n因此，\n$$ \\Delta = \\left(1 - s_{\\mathrm{cos}}(x,y)\\right) - \\left(1 - \\rho(x,y)\\right) = \\rho(x,y) - s_{\\mathrm{cos}}(x,y) $$\n其中 $s_{\\mathrm{cos}}(x,y)$ 是余弦相似性，$\\rho(x,y)$ 是皮尔逊相关系数。我们将分别推导每个相似性项。\n\n首先，我们计算皮尔逊相关系数 $\\rho(x,y)$。两个维度为 $p$ 的向量 $x$ 和 $y$ 之间的皮尔逊相关性的定义是它们均值中心化版本之间的余弦相似性。设 $x_c = x - \\bar{x}\\mathbf{1}$ 和 $y_c = y - \\bar{y}\\mathbf{1}$ 为中心化向量，其中 $\\bar{x}$ 和 $\\bar{y}$ 分别是各自的均值，$\\mathbf{1}$ 是全1向量。那么，\n$$ \\rho(x,y) = \\frac{x_c \\cdot y_c}{\\|x_c\\| \\|y_c\\|} $$\n向量 $y$ 由线性变换 $y = \\gamma x + \\beta \\mathbf{1}$ 给出，其中 $\\gamma \\in \\mathbb{R} \\setminus \\{0\\}$ 且 $\\beta \\in \\mathbb{R}$。\n$y$ 的均值是：\n$$ \\bar{y} = \\frac{1}{p} \\sum_{i=1}^{p} y_i = \\frac{1}{p} \\sum_{i=1}^{p} (\\gamma x_i + \\beta) = \\gamma \\left(\\frac{1}{p} \\sum_{i=1}^{p} x_i\\right) + \\frac{1}{p} (p\\beta) = \\gamma \\bar{x} + \\beta $$\n现在我们求中心化向量 $y_c$：\n$$ y_c = y - \\bar{y}\\mathbf{1} = (\\gamma x + \\beta \\mathbf{1}) - (\\gamma \\bar{x} + \\beta)\\mathbf{1} = \\gamma x + \\beta \\mathbf{1} - \\gamma \\bar{x}\\mathbf{1} - \\beta \\mathbf{1} = \\gamma (x - \\bar{x}\\mathbf{1}) = \\gamma x_c $$\n这表明加性偏移量 $\\beta$ 通过均值中心化被移除了。我们现在可以计算 $\\rho(x,y)$ 的各项。\n分子中的点积是：\n$$ x_c \\cdot y_c = x_c \\cdot (\\gamma x_c) = \\gamma (x_c \\cdot x_c) = \\gamma \\|x_c\\|^2 = \\gamma \\|x - \\bar{x}\\mathbf{1}\\|^2 $$\n分母中的范数是：\n$$ \\|x_c\\| \\|y_c\\| = \\|x - \\bar{x}\\mathbf{1}\\| \\|\\gamma (x - \\bar{x}\\mathbf{1})\\| = \\|x - \\bar{x}\\mathbf{1}\\| |\\gamma| \\|x - \\bar{x}\\mathbf{1}\\| = |\\gamma| \\|x - \\bar{x}\\mathbf{1}\\|^2 $$\n将这些代入 $\\rho(x,y)$ 的表达式中：\n$$ \\rho(x,y) = \\frac{\\gamma \\|x - \\bar{x}\\mathbf{1}\\|^2}{|\\gamma| \\|x - \\bar{x}\\mathbf{1}\\|^2} $$\n题目说明 $\\|x - \\bar{x}\\mathbf{1}\\| \\neq 0$，所以我们可以消去这一项。又因为给定 $\\gamma \\neq 0$，我们得到：\n$$ \\rho(x,y) = \\frac{\\gamma}{|\\gamma|} = \\mathrm{sgn}(\\gamma) $$\n因此，相关距离是 $d_{\\mathrm{corr}}(x,y) = 1 - \\rho(x,y) = 1 - \\mathrm{sgn}(\\gamma)$。\n\n接下来，我们计算余弦相似性 $s_{\\mathrm{cos}}(x,y)$。\n$$ s_{\\mathrm{cos}}(x,y) = \\frac{x \\cdot y}{\\|x\\| \\|y\\|} $$\n分子中的点积是：\n$$ x \\cdot y = x \\cdot (\\gamma x + \\beta \\mathbf{1}) = \\gamma (x \\cdot x) + \\beta (x \\cdot \\mathbf{1}) $$\n我们知道 $x \\cdot x = \\|x\\|^2$ 并且 $x \\cdot \\mathbf{1} = \\sum_{i=1}^{p} x_i = p \\bar{x}$。所以，分子是 $\\gamma \\|x\\|^2 + p\\beta\\bar{x}$。\n对于分母，我们需要 $\\|y\\|$。我们先计算它的平方值：\n$$ \\|y\\|^2 = y \\cdot y = (\\gamma x + \\beta \\mathbf{1}) \\cdot (\\gamma x + \\beta \\mathbf{1}) = \\gamma^2 (x \\cdot x) + 2\\gamma\\beta (x \\cdot \\mathbf{1}) + \\beta^2 (\\mathbf{1} \\cdot \\mathbf{1}) $$\n使用 $x \\cdot x = \\|x\\|^2$、$x \\cdot \\mathbf{1} = p\\bar{x}$ 和 $\\mathbf{1} \\cdot \\mathbf{1} = p$，我们得到：\n$$ \\|y\\|^2 = \\gamma^2 \\|x\\|^2 + 2p\\gamma\\beta\\bar{x} + p\\beta^2 $$\n因此，$\\|y\\| = \\sqrt{\\gamma^2 \\|x\\|^2 + 2p\\gamma\\beta\\bar{x} + p\\beta^2}$。余弦相似性是：\n$$ s_{\\mathrm{cos}}(x,y) = \\frac{\\gamma \\|x\\|^2 + p\\beta\\bar{x}}{\\|x\\| \\sqrt{\\gamma^2 \\|x\\|^2 + 2p\\gamma\\beta\\bar{x} + p\\beta^2}} $$\n余弦距离是 $d_{\\mathrm{cos}}(x,y) = 1 - s_{\\mathrm{cos}}(x,y)$。\n\n最后，我们计算差值 $\\Delta$：\n$$ \\Delta = \\rho(x,y) - s_{\\mathrm{cos}}(x,y) = \\mathrm{sgn}(\\gamma) - \\frac{\\gamma \\|x\\|^2 + p\\beta\\bar{x}}{\\|x\\| \\sqrt{\\gamma^2 \\|x\\|^2 + 2p\\gamma\\beta\\bar{x} + p\\beta^2}} $$\n这个表达式是用所需的变量 $p$、$\\gamma$、$\\beta$、$\\bar{x}$ 和 $\\|x\\|$ 表示的。它代表了两个RDM条目之差的最终闭式解析表达式。\n符号函数 $\\mathrm{sgn}(\\gamma)$ 定义为：如果 $\\gamma > 0$ 则为 $1$，如果 $\\gamma  0$ 则为 $-1$，在 $\\gamma=0$ 时未定义，但问题指明 $\\gamma \\neq 0$。\n\n最终表达式为：\n$$ \\Delta = \\mathrm{sgn}(\\gamma) - \\frac{\\gamma \\|x\\|^2 + p \\beta \\bar{x}}{\\|x\\| \\sqrt{\\gamma^2 \\|x\\|^2 + 2p\\gamma\\beta\\bar{x} + p\\beta^2}} $$\n这是简化后的结果。",
            "answer": "$$\\boxed{\\mathrm{sgn}(\\gamma) - \\frac{\\gamma \\|x\\|^2 + p \\beta \\bar{x}}{\\|x\\| \\sqrt{\\gamma^2 \\|x\\|^2 + 2p\\gamma\\beta\\bar{x} + p\\beta^2}}}$$"
        },
        {
            "introduction": "本练习将理论付诸实践，引导您完成一个比较大脑和模型RDM的完整分析流程的具体示例。您将计算交叉验证的马氏（crossnobis）距离——一种从噪声数据中估计相异性的稳健技术，并应用收缩正则化来稳定噪声协方差估计。这项动手计算  巩固了从处理类原始模式到获得最终可解释的大脑-模型相关性的整个过程。",
            "id": "4147090",
            "problem": "一个实验室试图将大脑响应的表征几何与一个候选计算模型进行比较。大脑响应是在两个（$2$）个独立的数据分区（例如，折半运行）上测量的，每个分区为 $C=3$ 种刺激条件提供了跨越 $M=2$ 个体素的平均响应模式。设分区 $\\mathsf{A}$ 中的平均模式向量为\n$\\mathbf{x}_{1}^{\\mathsf{A}} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，$\\mathbf{x}_{2}^{\\mathsf{A}} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，以及 $\\mathbf{x}_{3}^{\\mathsf{A}} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，\n分区 $\\mathsf{B}$ 中的向量为\n$\\mathbf{x}_{1}^{\\mathsf{B}} = \\begin{pmatrix}0.9 \\\\ 0.1\\end{pmatrix}$，$\\mathbf{x}_{2}^{\\mathsf{B}} = \\begin{pmatrix}0.1 \\\\ 0.9\\end{pmatrix}$，以及 $\\mathbf{x}_{3}^{\\mathsf{B}} = \\begin{pmatrix}1.05 \\\\ 0.95\\end{pmatrix}$。\n根据汇集了两个分区的试次级残差，样本噪声协方差估计为\n$\\hat{\\Sigma} = \\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix}$。\n为了提高估计的稳定性，该实验室应用协方差的收缩估计器，\n$\\hat{\\Sigma}_{\\lambda} = (1-\\lambda)\\,\\hat{\\Sigma} + \\lambda\\,I$，\n其中 $I$ 是单位矩阵，$\\lambda \\in [0,1]$ 是收缩参数。\n\n从表征非相似性矩阵（RDM）的标准定义（其中每个非对角线元素量化了一对条件之间的非相似性）出发，并基于协方差为 $\\Sigma$ 的高斯噪声引出噪声白化距离的原理，使用 $\\hat{\\Sigma}_{\\lambda}$ 作为噪声协方差的替代，推导出三个条件对 $(1,2)$, $(1,3)$ 和 $(2,3)$ 的交叉验证噪声调整马氏非相似性（crossnobis 距离）。使用 $\\lambda = 0.3$。然后，将这三个距离作为大脑 RDM 的条目来构建该矩阵。\n\n候选模型指定了表征向量 $\\mathbf{m}_{1} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，$\\mathbf{m}_{2} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，和 $\\mathbf{m}_{3} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，并将其 RDM 条目定义为模型向量之间的欧几里得距离的平方。计算大脑 RDM（crossnobis 距离）和模型 RDM（欧几里得距离的平方）在这三对条件上的皮尔逊相关系数。将最终的相关系数四舍五入到四位有效数字，并以小数形式表示。\n\n最后，讨论收缩参数 $\\lambda$ 在最终 RDM 中引入的偏差-方差权衡，解释在何种情况下收缩会以增加偏差为代价来减小方差，以及这种权衡在计算出的非相似性中如何体现。",
            "solution": "目标是计算大脑表征非相似性矩阵（RDM）和模型 RDM 之间的皮尔逊相关系数，并讨论在大脑 RDM 计算中使用的收缩参数所带来的偏差-方差权衡。\n\n首先，我们构建大脑 RDM。这需要为 $3$ 个条件对计算交叉验证的噪声调整马氏非相似性（crossnobis 距离）。该计算基于噪声协方差矩阵的收缩估计 $\\hat{\\Sigma}_{\\lambda}$。\n\n给定的样本协方差矩阵为 $\\hat{\\Sigma} = \\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix}$，收缩参数为 $\\lambda = 0.3$。单位矩阵为 $I = \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}$。收缩正则化的协方差矩阵 $\\hat{\\Sigma}_{\\lambda}$ 由下式给出：\n$$ \\hat{\\Sigma}_{\\lambda} = (1-\\lambda)\\,\\hat{\\Sigma} + \\lambda\\,I $$\n代入给定值：\n$$ \\hat{\\Sigma}_{0.3} = (1-0.3) \\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix} + 0.3 \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} $$\n$$ \\hat{\\Sigma}_{0.3} = 0.7 \\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix} + 0.3 \\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix} = \\begin{pmatrix}1.4  0.7 \\\\ 0.7  1.4\\end{pmatrix} + \\begin{pmatrix}0.3  0 \\\\ 0  0.3\\end{pmatrix} = \\begin{pmatrix}1.7  0.7 \\\\ 0.7  1.7\\end{pmatrix} $$\n为了计算马氏距离，我们需要该矩阵的逆矩阵 $\\hat{\\Sigma}_{0.3}^{-1}$。\n行列式为 $\\det(\\hat{\\Sigma}_{0.3}) = (1.7)(1.7) - (0.7)(0.7) = 2.89 - 0.49 = 2.4$。\n逆矩阵为：\n$$ \\hat{\\Sigma}_{0.3}^{-1} = \\frac{1}{2.4} \\begin{pmatrix}1.7  -0.7 \\\\ -0.7  1.7\\end{pmatrix} $$\n条件 $i$ 和 $j$ 之间的 crossnobis 非相似性 $d^2(i,j)$ 定义为：\n$$ d^2(i,j) = (\\mathbf{x}_i^{\\mathsf{A}} - \\mathbf{x}_j^{\\mathsf{A}})^T \\hat{\\Sigma}_{0.3}^{-1} (\\mathbf{x}_i^{\\mathsf{B}} - \\mathbf{x}_j^{\\mathsf{B}}) $$\n我们来计算每个分区的向量差：\n对于分区 $\\mathsf{A}$：\n$\\Delta \\mathbf{x}_{12}^{\\mathsf{A}} = \\mathbf{x}_1^{\\mathsf{A}} - \\mathbf{x}_2^{\\mathsf{A}} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} - \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$\n$\\Delta \\mathbf{x}_{13}^{\\mathsf{A}} = \\mathbf{x}_1^{\\mathsf{A}} - \\mathbf{x}_3^{\\mathsf{A}} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} - \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}0 \\\\ -1\\end{pmatrix}$\n$\\Delta \\mathbf{x}_{23}^{\\mathsf{A}} = \\mathbf{x}_2^{\\mathsf{A}} - \\mathbf{x}_3^{\\mathsf{A}} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}-1 \\\\ 0\\end{pmatrix}$\n\n对于分区 $\\mathsf{B}$：\n$\\Delta \\mathbf{x}_{12}^{\\mathsf{B}} = \\mathbf{x}_1^{\\mathsf{B}} - \\mathbf{x}_2^{\\mathsf{B}} = \\begin{pmatrix}0.9 \\\\ 0.1\\end{pmatrix} - \\begin{pmatrix}0.1 \\\\ 0.9\\end{pmatrix} = \\begin{pmatrix}0.8 \\\\ -0.8\\end{pmatrix}$\n$\\Delta \\mathbf{x}_{13}^{\\mathsf{B}} = \\mathbf{x}_1^{\\mathsf{B}} - \\mathbf{x}_3^{\\mathsf{B}} = \\begin{pmatrix}0.9 \\\\ 0.1\\end{pmatrix} - \\begin{pmatrix}1.05 \\\\ 0.95\\end{pmatrix} = \\begin{pmatrix}-0.15 \\\\ -0.85\\end{pmatrix}$\n$\\Delta \\mathbf{x}_{23}^{\\mathsf{B}} = \\mathbf{x}_2^{\\mathsf{B}} - \\mathbf{x}_3^{\\mathsf{B}} = \\begin{pmatrix}0.1 \\\\ 0.9\\end{pmatrix} - \\begin{pmatrix}1.05 \\\\ 0.95\\end{pmatrix} = \\begin{pmatrix}-0.95 \\\\ -0.05\\end{pmatrix}$\n\n现在我们计算非相似性：\n$d_{\\text{brain}}^2(1,2) = \\begin{pmatrix}1  -1\\end{pmatrix} \\frac{1}{2.4} \\begin{pmatrix}1.7  -0.7 \\\\ -0.7  1.7\\end{pmatrix} \\begin{pmatrix}0.8 \\\\ -0.8\\end{pmatrix} = \\frac{1}{2.4} \\begin{pmatrix}1  -1\\end{pmatrix} \\begin{pmatrix}1.92 \\\\ -1.92\\end{pmatrix} = \\frac{1.92 - (-1.92)}{2.4} = \\frac{3.84}{2.4} = 1.6$\n\n$d_{\\text{brain}}^2(1,3) = \\begin{pmatrix}0  -1\\end{pmatrix} \\frac{1}{2.4} \\begin{pmatrix}1.7  -0.7 \\\\ -0.7  1.7\\end{pmatrix} \\begin{pmatrix}-0.15 \\\\ -0.85\\end{pmatrix} = \\frac{1}{2.4} \\begin{pmatrix}0  -1\\end{pmatrix} \\begin{pmatrix}0.34 \\\\ -1.34\\end{pmatrix} = \\frac{1.34}{2.4} = \\frac{67}{120}$\n\n$d_{\\text{brain}}^2(2,3) = \\begin{pmatrix}-1  0\\end{pmatrix} \\frac{1}{2.4} \\begin{pmatrix}1.7  -0.7 \\\\ -0.7  1.7\\end{pmatrix} \\begin{pmatrix}-0.95 \\\\ -0.05\\end{pmatrix} = \\frac{1}{2.4} \\begin{pmatrix}-1  0\\end{pmatrix} \\begin{pmatrix}-1.58 \\\\ 0.58\\end{pmatrix} = \\frac{1.58}{2.4} = \\frac{79}{120}$\n\n大脑 RDM 的条目构成了向量 $\\mathbf{d}_{\\text{brain}} = \\begin{pmatrix} 1.6   \\frac{67}{120}   \\frac{79}{120} \\end{pmatrix}^T$。\n\n其次，我们构建模型 RDM。其条目是模型向量 $\\mathbf{m}_{1} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$，$\\mathbf{m}_{2} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，和 $\\mathbf{m}_{3} = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$ 之间的欧几里得距离的平方。\n$d_{\\text{model}}^2(1,2) = ||\\mathbf{m}_1 - \\mathbf{m}_2||^2 = ||\\begin{pmatrix}1 \\\\ -1\\end{pmatrix}||^2 = 1^2 + (-1)^2 = 2$\n$d_{\\text{model}}^2(1,3) = ||\\mathbf{m}_1 - \\mathbf{m}_3||^2 = ||\\begin{pmatrix}0 \\\\ -1\\end{pmatrix}||^2 = 0^2 + (-1)^2 = 1$\n$d_{\\text{model}}^2(2,3) = ||\\mathbf{m}_2 - \\mathbf{m}_3||^2 = ||\\begin{pmatrix}-1 \\\\ 0\\end{pmatrix}||^2 = (-1)^2 + 0^2 = 1$\n模型 RDM 的条目构成了向量 $\\mathbf{d}_{\\text{model}} = \\begin{pmatrix} 2   1   1 \\end{pmatrix}^T$。\n\n第三，我们计算 $\\mathbf{d}_{\\text{brain}}$ 和 $\\mathbf{d}_{\\text{model}}$ 之间的皮尔逊相关系数 $r$。令 $\\mathbf{u} = \\mathbf{d}_{\\text{brain}}$ 且 $\\mathbf{v} = \\mathbf{d}_{\\text{model}}$。\n均值为：\n$\\bar{u} = \\frac{1}{3} (1.6 + \\frac{67}{120} + \\frac{79}{120}) = \\frac{1}{3} (\\frac{192}{120} + \\frac{146}{120}) = \\frac{1}{3} \\frac{338}{120} = \\frac{169}{180}$\n$\\bar{v} = \\frac{1}{3} (2+1+1) = \\frac{4}{3}$\n\n中心化后的向量为：\n$u - \\bar{u} = \\begin{pmatrix} 1.6 - \\frac{169}{180} \\\\ \\frac{67}{120} - \\frac{169}{180} \\\\ \\frac{79}{120} - \\frac{169}{180} \\end{pmatrix} = \\begin{pmatrix} \\frac{288-169}{180} \\\\ \\frac{201-338}{360} \\\\ \\frac{237-338}{360} \\end{pmatrix} = \\begin{pmatrix} \\frac{119}{180} \\\\ -\\frac{137}{360} \\\\ -\\frac{101}{360} \\end{pmatrix}$\n$v - \\bar{v} = \\begin{pmatrix} 2 - \\frac{4}{3} \\\\ 1 - \\frac{4}{3} \\\\ 1 - \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ -\\frac{1}{3} \\\\ -\\frac{1}{3} \\end{pmatrix}$\n\n相关系数公式的分子是偏差乘积之和：\n$\\sum (u_i - \\bar{u})(v_i - \\bar{v}) = (\\frac{119}{180})(\\frac{2}{3}) + (-\\frac{137}{360})(-\\frac{1}{3}) + (-\\frac{101}{360})(-\\frac{1}{3})$\n$= \\frac{238}{540} + \\frac{137}{1080} + \\frac{101}{1080} = \\frac{476}{1080} + \\frac{238}{1080} = \\frac{714}{1080} = \\frac{119}{180}$\n\n分母项是离差平方和的平方根：\n$\\sum (u_i - \\bar{u})^2 = (\\frac{119}{180})^2 + (\\frac{-137}{360})^2 + (\\frac{-101}{360})^2 = \\frac{14161}{32400} + \\frac{18769}{129600} + \\frac{10201}{129600}$\n$= \\frac{4 \\times 14161 + 18769 + 10201}{129600} = \\frac{56644 + 18769 + 10201}{129600} = \\frac{85614}{129600} = \\frac{14269}{21600}$\n$\\sum (v_i - \\bar{v})^2 = (\\frac{2}{3})^2 + (-\\frac{1}{3})^2 + (-\\frac{1}{3})^2 = \\frac{4}{9} + \\frac{1}{9} + \\frac{1}{9} = \\frac{6}{9} = \\frac{2}{3}$\n\n皮尔逊相关系数为：\n$$ r = \\frac{\\frac{119}{180}}{\\sqrt{\\frac{14269}{21600}} \\sqrt{\\frac{2}{3}}} = \\frac{\\frac{119}{180}}{\\sqrt{\\frac{14269 \\times 2}{21600 \\times 3}}} = \\frac{\\frac{119}{180}}{\\sqrt{\\frac{28538}{64800}}} $$\n为了简化，我们可以计算 $r^2$：\n$$ r^2 = \\frac{(\\frac{119}{180})^2}{\\frac{28538}{64800}} = \\frac{\\frac{14161}{32400}}{\\frac{28538}{64800}} = \\frac{14161}{32400} \\frac{64800}{28538} = \\frac{14161 \\times 2}{28538} = \\frac{28322}{28538} $$\n$$ r = \\sqrt{\\frac{28322}{28538}} \\approx \\sqrt{0.992429399} \\approx 0.9962075 $$\n四舍五入到四位有效数字，相关系数为 $0.9962$。\n\n最后，我们讨论由收缩参数 $\\lambda$ 引入的偏差-方差权衡。\n协方差矩阵的收缩估计器 $\\hat{\\Sigma}_{\\lambda} = (1-\\lambda)\\hat{\\Sigma} + \\lambda I$ 结合了样本协方差 $\\hat{\\Sigma}$ 和一个缩放后的单位矩阵 $I$。这项技术是一种正则化形式。\n\n偏差：样本协方差 $\\hat{\\Sigma}$ 是真实噪声协方差 $\\Sigma$ 的一个（渐进）无偏估计。而单位矩阵 $I$ 通常是 $\\Sigma$ 的一个有偏估计，除非真实噪声是球形的（即 $\\Sigma \\propto I$）。通过选择 $\\lambda  0$，我们向协方差估计中引入了偏差。该估计器的期望值为 $E[\\hat{\\Sigma}_{\\lambda}] = (1-\\lambda)\\Sigma + \\lambda I$。偏差为 $E[\\hat{\\Sigma}_{\\lambda}] - \\Sigma = \\lambda(I - \\Sigma)$。此偏差随着 $\\lambda$ 的增大以及真实协方差结构偏离单位矩阵的程度（例如，强的非对角线相关性）而增大。在我们的问题中，$\\hat{\\Sigma}$ 具有非零的非对角线元素，因此使用 $\\lambda=0.3$ 会引入一种偏差，该偏差会低估体素之间的真实协方差。\n\n方差：样本协方差 $\\hat{\\Sigma}$ 可能具有高方差，意味着其条目在不同的数据样本中可能存在显著波动，特别是当用于估计的数据点数量相对于维度（体素）数量较少时。相比之下，单位矩阵 $I$ 是一个常数，其方差为零。收缩估计器的方差为 $\\text{Var}(\\hat{\\Sigma}_{\\lambda}) = (1-\\lambda)^2 \\text{Var}(\\hat{\\Sigma})$。随着 $\\lambda$ 从 $0$ 增加到 $1$，估计器的方差减小，使得估计更加稳定。\n\n权衡：收缩的使用体现了经典的偏差-方差权衡。通过增加 $\\lambda$，我们接受协方差估计中更多的偏差，以换取其方差的减小。对于噪声大或高维数据，方差的大幅减小可能超过偏差的增加，从而导致更低的总均方误差和对真实协方差更稳健的估计。一个最优的 $\\lambda$ 会平衡这两个相互竞争的因素。\n\n在非相似性中的体现：这种权衡直接影响计算出的 crossnobis 距离 $d^2 = \\Delta \\mathbf{x}^{\\mathsf{A} T} \\hat{\\Sigma}_{\\lambda}^{-1} \\Delta \\mathbf{x}^{\\mathsf{B}}$。矩阵 $\\hat{\\Sigma}_{\\lambda}^{-1}$ 起到噪声白化变换的作用。如果 $\\lambda=0$，我们使用 $\\hat{\\Sigma}^{-1}$，它提供了一种无偏但可能不稳定的白化。如果 $\\hat{\\Sigma}$ 是病态的，$\\hat{\\Sigma}^{-1}$ 将会有巨大的条目，过度放大某些维度上的噪声，并导致高度可变（高方差）的非相似性估计。如果 $\\lambda=1$，我们使用 $I^{-1}=I$，这假定噪声是不相关且在所有体素上具有相等方差。这是一个强烈的、有偏的假设，但它导致了非常稳定（低方差）的非相似性计算（交叉验证的点积）。使用像 $0.3$ 这样的中间值 $\\lambda$ 可以对矩阵求逆进行正则化，使得非相似性估计比纯马氏距离（$\\lambda=0$）更稳定，但代价是不完美的噪声白化（偏差）。其期望是，这会产生一个更可靠的 RDM，通过不被采样噪声所淹没，从而更好地反映真实的表征几何。",
            "answer": "$$ \\boxed{0.9962} $$"
        },
        {
            "introduction": "在发现大脑RDM和模型RDM之间的相关性后，关键的最后一步是确定这种关系是否具有统计显著性。本练习专注于置换检验的正确实施，这是一种对表征相似性分析（RSA）中的有效推断至关重要的非参数方法。通过理解为什么正确地重排刺激标签是至关重要的，您将学会避免常见的陷阱，并确保您的统计结论是稳健和可辩护的 。",
            "id": "4147113",
            "problem": "一位研究者试图检验一个计算视觉模型是否能捕捉到通过功能性磁共振成像（fMRI）测量的人类腹侧视觉皮层区域的表征几何。对于 $n$ 个刺激中的每一个，研究者计算一个大脑响应向量和一个模型特征向量，然后构建两个 $n \\times n$ 的表征非相似性矩阵（RDM），分别记为 $D^{(b)}$（大脑）和 $D^{(m)}$（模型），其中 $D^{(b)}_{ij}$ 和 $D^{(m)}_{ij}$ 分别量化了刺激 $i$ 和刺激 $j$ 在大脑和模型特征空间中的非相似性。研究者使用斯皮尔曼等级相关统计量 $t$ 来总结 $D^{(b)}$ 和 $D^{(m)}$ 之间的一致性，该统计量定义为由每个RDM的上三角（不包括对角线）元素构成的向量之间的斯皮尔曼相关：\n$$\nt \\;=\\; \\rho_{S}\\!\\Big(\\operatorname{vec}_{\\triangle}\\big(D^{(b)}\\big),\\, \\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)\\Big).\n$$\n为了在没有分布假设的情况下评估统计显著性，研究者打算使用一种置换检验，该检验通过打乱刺激标签，利用了原假设下的可交换性原理。\n\n从以下基本定义和事实出发：\n- RDM是一个关于刺激的成对非相似性的对称矩阵，且 $D_{ii}=0$ 和 $D_{ij}=D_{ji}$。\n- 在原假设（即大脑和模型之间的刺激身份不对应）下，刺激标签是可交换的；等价地，刺激标签的任何置换都不应改变连接 $D^{(b)}$ 和 $D^{(m)}$ 的联合分布。\n- 对RDM的有效置换必须在两个维度（行和列）上一致地置换刺激标签，以保持对称性和成对条目之间的结构依赖关系。\n\n哪个选项通过打乱刺激标签正确地定义了适用于斯皮尔曼相关 $t$ 的置换检验，并精确地陈述了所检验的原假设？\n\nA. 对 $n$ 个刺激标签进行随机置换 $\\pi$，通过构建 $D^{(b)}_{\\pi} = P D^{(b)} P^{\\top}$ 将其应用于大脑RDM，其中 $P$ 是对应于 $\\pi$ 的置换矩阵。对每个 $\\pi$，计算\n$$\nt_{\\pi} \\;=\\; \\rho_{S}\\!\\Big(\\operatorname{vec}_{\\triangle}\\big(D^{(b)}_{\\pi}\\big),\\, \\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)\\Big),\n$$\n并使用 $\\{t_{\\pi}\\}$ 的经验分布来评估 $t$。原假设是大脑和模型之间的刺激标签是可交换的，即从 $D^{(b)}$ 中的刺激身份到 $D^{(m)}$ 中刺激身份的映射不携带任何信息，因此对应条目之间的总体斯皮尔曼相关为 $0$，并且 $t$ 的分布在 $\\pi$ 置换下保持不变。\n\nB. 随机打乱 $\\operatorname{vec}_{\\triangle}\\big(D^{(b)}\\big)$ 的条目，而不考虑它们来自哪个配对，然后将这个打乱后的向量与 $\\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)$ 进行相关。原假设是大脑中的各个成对非相似性是独立同分布的，因此大脑RDM中条目的顺序是无关紧要的。\n\nC. 在计算 $D^{(b)}$ 之前，随机置换fMRI数据中跨刺激的试验重复，保持 $D^{(m)}$ 不变，然后在得到的矩阵上计算相关性 $t$。原假设是试验身份在刺激内部和刺激之间是可交换的，因此任何观察到的相关性都必定源于试验水平的噪声，而非刺激水平的结构。\n\nD. 通过应用两个不相关的置换 $\\pi_{r}$ 和 $\\pi_{c}$ 来独立地置换 $D^{(b)}$ 的行和列标签，形成一个矩阵 $D'^{\\,(b)}$，其条目为 $D'^{\\,(b)}_{ij} = D^{(b)}_{\\pi_{r}(i)\\,\\pi_{c}(j)}$，然后将 $\\operatorname{vec}_{\\triangle}\\big(D'^{\\,(b)}\\big)$ 与 $\\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)$ 进行相关。原假设是大脑和模型的RDM在行和列上分别独立，因此破坏对称性不会影响期望的相关性。",
            "solution": "### 步骤1：提取已知信息\n问题陈述提供了以下信息和定义：\n- 有 $n$ 个刺激。\n- 给定两个 $n \\times n$ 的表征非相似性矩阵（RDM）：$D^{(b)}$（大脑数据）和 $D^{(m)}$（模型）。\n- 条目 $D^{(b)}_{ij}$ 和 $D^{(m)}_{ij}$ 代表刺激 $i$ 和刺激 $j$ 之间的非相似性。\n- 一个检验统计量 $t$ 被定义为RDM上三角部分的向量化后的斯皮尔曼等级相关：\n$$\nt \\;=\\; \\rho_{S}\\!\\Big(\\operatorname{vec}_{\\triangle}\\big(D^{(b)}\\big),\\, \\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)\\Big).\n$$\n- 将使用置换检验来评估 $t$ 的统计显著性。\n- RDM的基本属性：它是一个对称矩阵（$D_{ij}=D_{ji}$），对角线为零（$D_{ii}=0$）。\n- 原假设（$H_0$）下置换检验的原理：大脑和模型之间的刺激标签是可交换的。\n- 对有效置换的约束：它必须在行和列上一致地置换刺激标签，以保持RDM的对称性及其条目之间的结构依赖关系。\n\n### 步骤2：使用提取的已知信息进行验证\n问题陈述描述了计算神经科学中一个标准且重要的程序，称为表征相似性分析（RSA）。\n- **科学基础：** 整个设置是现代系统和认知神经科学的基石。使用RDM来表征表征几何，比较大脑数据（fMRI）和计算模型，选择斯皮尔曼相关以允许非线性但单调的关系，以及使用置换检验进行非参数推断，这些都是公认的标准实践。该问题牢固地植根于科学方法论。\n- **定义明确：** 问题是精确的。它要求为给定的统计量（$t$）找到正确的置换程序来检验一个特定且明确定义的原假设。所提供的原则和约束允许通过逻辑和统计推理确定唯一且正确的答案。\n- **客观性：** 问题使用形式化的数学和统计语言描述，没有歧义或主观性。\n\n该问题并非不健全、不完整、矛盾、不切实际或病态的。所有术语要么是形式上定义的（$t$，RDM），要么是该领域的标准术语（置换检验，可交换性）。\n\n### 步骤3：结论和行动\n问题陈述是**有效的**。解题过程将从第一性原理出发推导正确的置换程序，然后评估每个选项。\n\n### 推导与选项分析\n\n核心任务是在原假设 $H_0$（即大脑的表征几何与模型的表征几何之间没有系统性关系）下，为统计量 $t$ 构建一个零分布。该假设意味着刺激标签 $\\{1, 2, \\dots, n\\}$ 在 $D^{(b)}$ 和 $D^{(m)}$ 之间没有有意义的对应关系。因此，任何观察到的相关性都可归因于偶然。可交换性原理意味着，如果 $H_0$ 为真，对其中一个RDM的刺激标签进行任何置换，都不应系统性地改变其与另一个RDM的相关性结果。\n\n让我们将对一个RDM（比如 $D^{(b)}$）“置换刺激标签”这一行为形式化。RDM是一个行和列都由同一组刺激索引的矩阵。如果我们对刺激标签应用一个置换 $\\pi$，那么现在被标记为刺激 '$i$' 和刺激 '$j$' 之间的新非相似性必须是旧的刺激 `$\\pi(i)$` 和刺激 `$\\pi(j)$` 之间的非相似性。这是不正确的。置换是重新分配标签。新矩阵，我们称之为 $D^{(b)}_{\\pi}$，其 $(i,j)$ 位置上的值应该是对应于被移动到第 $i$ 和第 $j$ 位置的刺激之间的非相似性。设 $\\pi$ 是 $\\{1, ..., n\\}$ 的一个置换。与 $\\pi$ 对应的置换矩阵 $P$ 通常定义为，当它从左侧乘以一个矩阵时，会对该矩阵的行进行置换。对于RDM，我们必须以相同的方式置换列，以保持刺激与其行和列的对应关系。这个操作，即相似变换，由 $D^{(b)}_{\\pi} = P D^{(b)} P^{\\top}$ 给出，其中 $P^{\\top} = P^{-1}$ 因为置换矩阵是正交的。这个变换同时置换了行和列，保持了矩阵的对称性（因为 $D$ 是对称的，所以 $(P D P^{\\top})^{\\top} = (P^{\\top})^{\\top} D^{\\top} P^{\\top} = P D P^{\\top}$）和其零对角线。这正确地实现了对刺激标签的打乱，同时保留了RDM的内部依赖结构，符合问题约束的要求。\n\n因此，置换检验的程序如下：\n1.  根据原始矩阵 $D^{(b)}$ 和 $D^{(m)}$ 计算观察到的统计量 $t$。\n2.  重复大量迭代：\n    a. 生成 $n$ 个刺激标签的一个随机置换 $\\pi$。\n    b. 构建相应的置换矩阵 $P$。\n    c. 将置换应用于其中一个RDM，例如，$D^{(b)}_{\\pi} = P D^{(b)} P^{\\top}$。\n    d. 在置换后的数据上计算统计量：$t_{\\pi} = \\rho_{S}(\\operatorname{vec}_{\\triangle}(D^{(b)}_{\\pi}), \\operatorname{vec}_{\\triangle}(D^{(m)}))$。\n3.  $\\{t_{\\pi}\\}$ 值的集合构成了经验零分布。p值是这些零分布值中大于或等于观察值 $t$ 的比例。\n\n现在我们根据这个正确的程序来评估每个选项。\n\n**A. 对 $n$ 个刺激标签进行随机置换 $\\pi$，通过构建 $D^{(b)}_{\\pi} = P D^{(b)} P^{\\top}$ 将其应用于大脑RDM，其中 $P$ 是对应于 $\\pi$ 的置换矩阵。对每个 $\\pi$，计算 $t_{\\pi} \\;=\\; \\rho_{S}\\!\\Big(\\operatorname{vec}_{\\triangle}\\big(D^{(b)}_{\\pi}\\big),\\, \\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)\\Big)$，并使用 $\\{t_{\\pi}\\}$ 的经验分布来评估 $t$。原假设是大脑和模型之间的刺激标签是可交换的，即从 $D^{(b)}$ 中的刺激身份到 $D^{(m)}$ 中刺激身份的映射不携带任何信息，因此对应条目之间的总体斯皮尔曼相关为 $0$，并且 $t$ 的分布在 $\\pi$ 置换下保持不变。**\n\n该选项与推导出的正确程序完全匹配。公式 $D^{(b)}_{\\pi} = P D^{(b)} P^{\\top}$ 是对刺激进行重新标记的正确矩阵操作。随后计算 $t_{\\pi}$ 和构建零分布是标准做法。对原假设的陈述准确而全面，正确地将可交换标签的概念与两个RDM之间缺乏信息映射联系起来。\n\n**结论：正确**\n\n**B. 随机打乱 $\\operatorname{vec}_{\\triangle}\\big(D^{(b)}\\big)$ 的条目，而不考虑它们来自哪个配对，然后将这个打乱后的向量与 $\\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)$ 进行相关。原假设是大脑中的各个成对非相似性是独立同分布的，因此大脑RDM中条目的顺序是无关紧要的。**\n\n这个程序存在根本性缺陷。RDM的条目不是独立的。例如，涉及一个共同刺激的非相似性（如 $D_{ij}$ 和 $D_{ik}$）在结构上是相关的。打乱 $\\operatorname{vec}_{\\triangle}(D^{(b)})$ 的单个条目会破坏表征空间的这种内在结构。问题陈述明确要求有效的置换必须保持“成对条目之间的结构依赖关系”。这个程序违反了那个关键的约束。它检验的是一个更强且通常是错误的原假设，即所有成对非相似性之间都是独立的。\n\n**结论：不正确**\n\n**C. 在计算 $D^{(b)}$ 之前，随机置换fMRI数据中跨刺激的试验重复，保持 $D^{(m)}$ 不变，然后在得到的矩阵上计算相关性 $t$。原假设是试验身份在刺激内部和刺激之间是可交换的，因此任何观察到的相关性都必定源于试验水平的噪声，而非刺激水平的结构。**\n\n这个程序检验的是一个不同的原假设。它问的是大脑响应是否包含任何与刺激相关的信息。通过在计算大脑RDM之前就置换不同刺激的试验，这会抹去 $D^{(b)}$ 中任何与刺激系统相关的结构。这是一个有效的检验，用于回答“大脑数据中是否存在任何表征结构？”，但它不是针对主要问题“大脑数据中的表征结构是否与模型数据中的结构相似？”的正确检验。本问题是关于比较两个给定的、结构化的RDM。\n\n**结论：不正确**\n\n**D. 通过应用两个不相关的置换 $\\pi_{r}$ 和 $\\pi_{c}$ 来独立地置换 $D^{(b)}$ 的行和列标签，形成一个矩阵 $D'^{\\,(b)}$，其条目为 $D'^{\\,(b)}_{ij} = D^{(b)}_{\\pi_{r}(i)\\,\\pi_{c}(j)}$，然后将 $\\operatorname{vec}_{\\triangle}\\big(D'^{\\,(b)}\\big)$ 与 $\\operatorname{vec}_{\\triangle}\\big(D^{(m)}\\big)$ 进行相关。原假设是大脑和模型的RDM在行和列上分别独立，因此破坏对称性不会影响期望的相关性。**\n\n这个程序是错误的，因为它违反了RDM的一个基本属性。对行和列应用两个独立的置换 $\\pi_r$ 和 $\\pi_c$ 通常会破坏矩阵的对称性。得到的矩阵 $D'^{\\,(b)}$ 将不再是一个RDM，因为 $D'^{\\,(b)}_{ij} = D^{(b)}_{\\pi_{r}(i)\\,\\pi_{c}(j)}$ 将不等于 $D'^{\\,(b)}_{ji} = D^{(b)}_{\\pi_{r}(j)\\,\\pi_{c}(i)}$。问题陈述明确要求有效的置换要“保持对称性”。这个程序未能满足这一要求。\n\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}