## 引言
在神经科学中，一个核心挑战是理解大脑如何表征信息。我们如何能在一个共同的框架下，比较不同刺激在大脑中唤起的复杂活动模式，并将其与[计算模型](@entry_id:637456)或行为反应联系起来？[表征相似性分析](@entry_id:1130877)（Representational Similarity Analysis, RSA）为解决这一难题提供了强有力的工具。它通过将不同来源的数据转换成一种通用的“语言”——[表征非相似性矩阵](@entry_id:1130874)（RDM），从而超越了对单个神经元或体素活动的简单测量，转而关注表征空间的抽象几何结构。

本文旨在提供一份关于RSA的全面指南。在“原理与机制”一章中，我们将深入探讨RDM的数学基础，学习如何从神经影像数据中稳健地构建RDM，以及比较它们的统计方法。接着，在“应用与跨学科连接”一章中，我们将展示RSA如何在实际研究中大放异彩，从绘制大脑信息地图到检验人工智能模型，再到探索意识等复杂认知现象。最后，在“动手实践”一章中，您将通过具体的计算练习，巩固关键概念，并将理论知识转化为实践技能。通过这三章的学习，您将掌握使用RSA连接大脑、模型与心智的核心方法。

## 原理与机制

本章旨在深入阐述[表征相似性分析](@entry_id:1130877)（Representational Similarity Analysis, RSA）的核心原理与关键机制。我们将系统性地探讨[表征非相似性矩阵](@entry_id:1130874)（Representational Dissimilarity Matrix, RDM）的数学基础，从神经影像数据构建 RDM 的标准流程，比较不同 RDM 的[统计推断](@entry_id:172747)方法，以及如何科学地解释分析结果。最后，我们会将 RSA 置于更广阔的[计算神经科学](@entry_id:274500)框架中，探讨其与[编码模型](@entry_id:1124422)的关系。

### 定义[表征非相似性矩阵](@entry_id:1130874) (RDM)

[表征相似性分析](@entry_id:1130877)的核心是**[表征非相似性矩阵](@entry_id:1130874)（Representational Dissimilarity Matrix, RDM）**。给定一组 $n$ 个实验条件（如不同的刺激），一个 RDM 是一个 $n \times n$ 的方阵 $D$，其每一个元素 $D_{ij}$ 量化了大脑或[计算模型](@entry_id:637456)对条件 $i$ 和条件 $j$ 的神经表征之间的非相似性或距离。

从数学角度看，一个标准的 RDM 具有以下几个基本属性 ：
1.  **对称性 (Symmetry)**：任意一对条件 $(i,j)$ 之间的非相似性与 $(j,i)$ 之间的非相似性是相同的，即 $D_{ij} = D_{ji}$。这反映了非相似性通常是针对无序对来定义的。
2.  **空心对角线 (Hollow Diagonal)**：任何条件与其自身的非相似性为零，即 $D_{ii} = 0$。这源于任何表征与自身完全相同。对角线全为零的矩阵在数学上被称为“空心矩阵”。
3.  **非负性 (Non-negativity)**：非相似性的值通常是大于等于零的实数，即 $D_{ij} \ge 0$。

值得注意的是，RDM 的定义并不要求其满足两个更强的数学属性：**[三角不等式](@entry_id:143750)**（即 $D_{ik} \le D_{ij} + D_{jk}$）和**正半定性**。这使得 RDM 的概念比严格的[度量空间](@entry_id:138860)（metric space）更为宽泛，能够容纳更多种类的非[相似性度量](@entry_id:896637)。

为了更清晰地理解 RDM 的特性，我们可以将其与**相似性矩阵（similarity matrix）**进行对比。相似性矩阵 $S$ 的元素 $S_{ij}$ 量化了表征之间的相似度，值越大表示越相似。一个典型的例子是[格拉姆矩阵](@entry_id:203297)（Gram matrix）。若我们将每个条件的 $p$ 维神经活动模式表示为向量 $x_i \in \mathbb{R}^p$，并将这些向量作为行堆叠成一个数据矩阵 $X \in \mathbb{R}^{n \times p}$，那么通过[内积](@entry_id:750660)定义的相似性矩阵 $S$ 就是一个[格拉姆矩阵](@entry_id:203297) $S = X X^\top$。与 RDM 不同，这个相似性矩阵通常具有非零的对角线元素（$S_{ii} = x_i^\top x_i = \|x_i\|^2$，即活动模式的能量或长度的平方），并且根据其定义，它总是对称且正半定的。RDM 的灵活性（即不要求满足[三角不等式](@entry_id:143750)或正半定性）是其强大功能的一部分，因为它允许研究者使用各种在统计和概念上合理的非[相似性度量](@entry_id:896637)。

### 构建RDM：选择非[相似性度量](@entry_id:896637)

RDM 中编码的**表征几何（representational geometry）**完全取决于我们选择的非[相似性度量](@entry_id:896637)。不同的度量对神经活动模式的不同方面敏感，因此，选择一个合适的度量是进行有意义分析的关键一步。

#### 度量、半度量与非相似性

我们可以根据非相似性函数 $d(i,j)$ 满足的数学公理对其进行分类 。对于空间中的任意三点 $i,j,k$：
1.  **非负性**：$d(i,j) \ge 0$
2.  **同一性**：$d(i,j)=0 \Leftrightarrow i=j$
3.  **对称性**：$d(i,j)=d(j,i)$
4.  **[三角不等式](@entry_id:143750)**：$d(i,k) \le d(i,j) + d(j,k)$

一个同时满足这四个条件的函数被称为**度量（metric）**。如果一个函数只满足前三个条件，但可能违[反三角不等式](@entry_id:146102)，则被称为**半度量（semimetric）**。更广义的**非相似性（dissimilarity）**则可能违反更多条件。

让我们分析几种在神经科学中常用的非[相似性度量](@entry_id:896637)：
-   **欧几里得距离 (Euclidean distance, $d_E$)**：这是[向量空间](@entry_id:151108)中由范数导出的标准距离，它满足所有四个公理，因此是一个真**度量**。
-   **角距离 (Angular distance, $d_A$)**：定义为单位化后向量之间的夹角（即其相关性的反余弦，$d_A(s,t) = \arccos(\text{corr}(x_s, x_t))$）。它对应于高维单位[球面上的测地线](@entry_id:275643)距离，同样是一个**度量**。
-   **[相关距离](@entry_id:634939) (Correlation distance, $d_C$)**：定义为 $1$ 减去皮尔逊相关系数（$d_C = 1 - r$）。尽管它满足非负性、同一性和对称性，但它常常违[反三角不等式](@entry_id:146102)。因此，[相关距离](@entry_id:634939)是一个**半度量**。
-   **平方欧几里得距离 (Squared Euclidean distance, $d_{E^2}$)**：即欧几里得距离的平方。它同样是一个**半度量**，因为它也可能违[反三角不等式](@entry_id:146102)。
-   **交叉验证[马氏距离](@entry_id:269828) (Cross-validated Mahalanobis dissimilarity, or crossnobis, $\hat{\delta}$)**：这是一个用于估计真实[马氏距离](@entry_id:269828)平方的[无偏估计量](@entry_id:756290)。由于其构造方式（涉及[独立数](@entry_id:260943)据集估计的[内积](@entry_id:750660)），在有限样本下它可能产生负值，因此违反了非负性。所以，它既不是度量也不是半度量，但其[无偏性](@entry_id:902438)等优良统计特性使其在实践中非常有用。

#### 度量的恒定性

除了满足哪些公理，非[相似性度量](@entry_id:896637)的**恒定性（invariance properties）**也至关重要，因为它决定了度量对表征空间的何种变换不敏感 。考虑一个[仿射变换](@entry_id:144885) $y = Ax + b$，其中 $A$ 是一个[可逆矩阵](@entry_id:171829)，$b$ 是一个平移向量。

-   **[欧几里得距离](@entry_id:143990)**对平移（$b$）和[正交变换](@entry_id:155650)（$A$ 满足 $A^\top A = I$，即[旋转和反射](@entry_id:136876)）保持不变。这意味着它捕捉的是表征点云的“刚性”几何结构，不受其在空间中的整体平移或旋转的影响。

-   **[相关距离](@entry_id:634939)**对每个活动模式的整体缩放（$x \to cx, c>0$）和内部成分的平移（即为每个特征通道加上一个常数）保持不变，但对外部的空间平移（$b$）或[混合特征](@entry_id:907829)的旋转（$A$）不具备恒定性。这使得它专注于活动模式的“轮廓”，而忽略了其整体激活强度和平均激活水平。

-   **马氏距离 (Mahalanobis distance)**，定义为 $d_M^2(x_i, x_j) = (x_i - x_j)^\top \Sigma^{-1} (x_i - x_j)$，其中 $\Sigma$ 是噪声协方差矩阵。它的一个卓越特性是，只要相应地变换度量本身，它对任何[可逆线性变换](@entry_id:149915) $A$ 都保持不变。这等价于在一个“白化”的空间中计算欧几里得距离，在这个空间里，噪声协方差被转换为了[单位矩阵](@entry_id:156724)。因此，马氏距离能够有效地消除由[相关噪声](@entry_id:137358)引起的表征空间仿射扭曲，提供了一个在统计上更为稳健的几何描述。

### 从神经影像数据构建大脑 RDM

将 RDM 的理论概念应用于真实的神经影像数据（如 fMRI）需要一个严谨的统计流程，以从充满噪声的原始信号中估计出可靠的神经活动模式。

#### 通用[线性模型](@entry_id:178302) (GLM)

估计与特定刺激相关的多体素活动模式的标准工具是**通用线性模型 (General Linear Model, GLM)** 。对于一个包含 $V$ 个体素的感兴趣区域，GLM 可以表示为：
$$Y = X\beta + \epsilon$$

其中：
-   $Y \in \mathbb{R}^{T \times V}$ 是观测到的数据矩阵，代表 $V$ 个体素在 $T$ 个时间点上的 BOLD 信号。
-   $X \in \mathbb{R}^{T \times P}$ 是**设计矩阵**。它包含了 $P$ 个预测变量（回归子）。为了估计每个刺激的活动模式，我们会为每个刺激条件构建一个回归子，通常通过将刺激的起始时间点与标准的**血氧[响应函数](@entry_id:142629) (Hemodynamic Response Function, HRF)**进行卷积来生成。此外，为了保证估计的准确性，[设计矩阵](@entry_id:165826)还必须包含一系列**滋扰回归子 (nuisance regressors)**，如头动参数、用于去除低频漂移的高通滤波回归子以及用于解释不同实验运行（run）之间基线差异的常数项。
-   $\beta \in \mathbb{R}^{P \times V}$ 是待估计的[回归系数](@entry_id:634860)矩阵。$\beta$ 中与特定刺激回归子对应的每一行都是一个 $V$ 维向量，代表了该刺激所诱发的神经活动模式。
-   $\epsilon$ 是噪声项。fMRI 数据中的噪声存在**时间[自相关](@entry_id:138991)**，这意味着[普通最小二乘法](@entry_id:137121)（OLS）的假设被违反。为了获得高效且无偏的估计，应采用考虑了时间协方差的**[广义最小二乘法](@entry_id:272590) (Generalized Least Squares, GLS)**，通常通过“[预白化](@entry_id:185911)”（prewhitening）技术实现。

#### 从活动模式估计到非相似性

从 GLM 获得每个刺激的活动模式估计 $\hat{\beta}_i$ 后，下一步是计算它们之间的非相似性。一个关键问题是，估计值 $\hat{\beta}_i$ 本身包含噪声，这会系统性地偏倚（bias）许多非[相似性度量](@entry_id:896637)。例如，两个模式之间真实的平方欧几里得距离是 $\|\beta_i - \beta_j\|^2$，但其实际估计的[期望值](@entry_id:150961)会因为噪声方差而被人为地抬高：$E[\|\hat{\beta}_i - \hat{\beta}_j\|^2] = \|\beta_i - \beta_j\|^2 + \text{bias}$，其中 bias 项为正。

解决这个问题的标准方法是**[交叉验证](@entry_id:164650) (cross-validation)**。其核心思想是使用数据的独立子集来获得对活动模式的独立估计。例如，我们可以将 fMRI 数据分成奇数次运行和偶数次运行，并分别为这两个独立的数据集拟合 GLM，得到两套独立的模式估计值，记为 $\hat{\beta}^{(1)}$ 和 $\hat{\beta}^{(2)}$。

利用这些独立的估计，我们可以构建无偏的非相似性估计量。例如，对于平方[欧几里得距离](@entry_id:143990)，一个[无偏估计量](@entry_id:756290)是 $(\hat{\beta}_i^{(1)} - \hat{\beta}_j^{(1)})^\top(\hat{\beta}_i^{(2)} - \hat{\beta}_j^{(2)})$。这一思想是**[交叉验证](@entry_id:164650)[马氏距离](@entry_id:269828) (crossnobis)** 的基础，它是一种先进的、无偏的非[相似性度量](@entry_id:896637)，同时还考虑了体素间的噪声协方差结构 $\Sigma$  ：
$$d_{ij}^2 = (\hat{\beta}_i^A - \hat{\beta}_j^A)^\top \hat{\Sigma}^{-1} (\hat{\beta}_i^B - \hat{\beta}_j^B)$$
其中，上标 $A$ 和 $B$ 代表来自两个[独立数](@entry_id:260943)据分割的估计，而 $\hat{\Sigma}^{-1}$ 是从 GLM 残差中估计的噪声协方差矩阵的逆。

### 比较 RDM：[统计推断](@entry_id:172747)

RSA 的核心步骤是比较由大脑数据构建的 RDM（$D^{\text{brain}}$）和一个或多个由[计算模型](@entry_id:637456)或理论假设生成的 RDM（$D^{\text{model}}$）。

#### [向量化](@entry_id:193244)

为了进行定量比较，我们首先需要将 $n \times n$ 的 RDM 矩阵转换为向量。由于 RDM 是对称且对角线为零的，所有关于不同条件对之间非相似性的信息都包含在其非对角[线元](@entry_id:196833)素中。为了避免重复计数和包含无信息的零，标准的做法是提取矩阵的**严格上三角**或严格下三角部分，并将其展平成一个向量 。这个向量的长度为 $m = \binom{n}{2} = \frac{n(n-1)}{2}$，即从 $n$ 个条件中选取两个的组合数。

至关重要的是，在比较多个 RDM 时，必须对所有 RDM 使用**完全相同的元素顺序**进行[向量化](@entry_id:193244)。这样才能确保向量中相同位置的元素对应于同一对条件的非相似性，从而使后续的相关性计算有意义。

#### 选择相关性度量

[向量化](@entry_id:193244)之后，我们通常通过计算大脑 RDM 向量和模型 RDM 向量之间的相关性来评估模型的拟合优度。最常用的两种相关性度量是[皮尔逊相关](@entry_id:260880)和[斯皮尔曼等级相关](@entry_id:755150)。

在 RSA 中，**[斯皮尔曼等级相关](@entry_id:755150)（Spearman's rank correlation, $r_s$）**通常是更受青睐的选择 。其定义为对两个变量进行等级转换后，再计算它们之间的皮尔逊相关系数。具体来说，如果 $R_i$ 和 $S_i$ 分别是 $v^{\text{brain}}_i$ 和 $v^{\text{model}}_i$ 在各自向量中的排名，那么：
$$r_s = \frac{\sum_{i=1}^{m} (R_i - \overline{R})(S_i - \overline{S})}{\sqrt{\sum_{i=1}^{m} (R_i - \overline{R})^2} \sqrt{\sum_{i=1}^{m} (S_i - \overline{S})^2}}$$

使用[斯皮尔曼相关](@entry_id:896527)的关键理由在于其**对单调变换的稳健性**。它衡量的是两个变量之间是否存在单调关系（即一个变量增加时，另一个变量也倾向于增加或减少），而不管这种关系是否是线性的。在比较大脑和模型的 RDM 时，我们通常只关心它们非相似性值的[序数](@entry_id:150084)结构是否一致，而不能假设它们之间的关系是线性的，或者它们的数值尺度可以直接比较。[斯皮尔曼相关](@entry_id:896527)完美地契合了这一需求。

#### 控制[混淆变量](@entry_id:199777)

在评估特定[计算模型](@entry_id:637456)的表现时，一个严谨的研究必须排除**[混淆变量](@entry_id:199777) (confounds)** 的影响。例如，一个声称能够解释高级物体表征的模型，其 RDM 与大脑 RDM 之间的相关性可能仅仅是由于两者都与图像的低级视觉属性（如像素亮度、空间频率）相关而产生的伪相关。

为了解决这个问题，我们可以采用**[多元回归](@entry_id:144007)（multiple regression）**的方法，它允许我们评估一个预测变量在控制了其他预测变量（即[混淆变量](@entry_id:199777)）后的独特贡献 。具体步骤如下：
1.  **构建混淆 RDM**：为每一个潜在的[混淆变量](@entry_id:199777)构建一个 RDM。例如，可以通过计算每对图像原始像素向量之间的[欧几里得距离](@entry_id:143990)来构建一个“像素相似性 RDM”，或者通过对每张图像进行傅里叶变换，提取其在不同[空间频率](@entry_id:270500)波段的能量作为[特征向量](@entry_id:151813)，然后计算这些[特征向量](@entry_id:151813)之间的距离来构建一个“空间频率 RDM”。
2.  **执行[多元回归](@entry_id:144007)**：将[向量化](@entry_id:193244)后的大脑 RDM（$\mathbf{r}_{\text{brain}}$）作为因变量，将我们感兴趣的模型 RDM（$\mathbf{r}_{\text{model}}$）和所有混淆 RDM（$\mathbf{r}_{\text{confound_1}}, \mathbf{r}_{\text{confound_2}}, \dots$）作为[自变量](@entry_id:267118)，拟合一个多元线性模型：
    $$\mathbf{r}_{\text{brain}} = \beta_0 + \beta_1 \mathbf{r}_{\text{model}} + \beta_2 \mathbf{r}_{\text{confound_1}} + \dots + \epsilon$$
3.  **评估独特贡献**：模型 $\mathbf{r}_{\text{model}}$ 的[回归系数](@entry_id:634860) $\beta_1$（或相应的[半偏相关](@entry_id:893374)系数）现在量化了该模型在排除了所有[混淆变量](@entry_id:199777)的影响后，对大脑[表征几何](@entry_id:1130876)的**独[特解](@entry_id:149080)释力**。

### 解释相关性：信度的作用

当我们得到一个大脑-模型的相关性系数时，一个自然的问题是：“这个值算高还是低？” 要科学地回答这个问题，我们必须考虑测量噪声的影响。

任何经验测量都包含噪声，这会导致观测到的相关性被**衰减 (attenuation)**，即系统性地低于潜在的真实相关性。我们可以通过**信度 (reliability)** 的概念来精确地量化这一效应  。

信度定义为真实分数方差在总观测分数方差中所占的比例。假设我们观测到的大脑 RDM 向量 $x$ 是真实信号 $t$ 和噪声 $\varepsilon$ 的和（$x = t + \varepsilon$）。大脑 RDM 的信度可以定义为 $\rho_b = \frac{\text{Var}(t)}{\text{Var}(x)}$。可以证明，观测到的模型-大脑相关性 $\text{Corr}(x,m)$ 与真实相关性 $\text{Corr}(t,m)$ 之间的关系为：
$$\text{Corr}(x,m) = \text{Corr}(t,m) \sqrt{\rho_b}$$

这个公式揭示了一个深刻的道理：观测相关性的上限受制于数据的信度。因为真实相关性 $\text{Corr}(t,m)$ 的绝对值不可能超过 1，所以观测相关性的绝对值不可能超过 $\sqrt{\rho_b}$。这个上限被称为**噪声[天花](@entry_id:920451)板 (noise ceiling)**，它为评价模型表现提供了一个基准：一个完美的模型，其与真实大脑表征的 RDM 的相关性为 1，在与实际观测数据比较时，所能达到的期望相关性最大也只能是 $\sqrt{\rho_b}$。

在更一般的情况下，当模型 RDM 本身也包含噪声时（例如，模型是一个[随机过程](@entry_id:268487)），[衰减校正](@entry_id:918169)公式变为：
$$\rho_{T_X T_Y} = \frac{\rho_{XY}}{\sqrt{\rho_{XX} \rho_{YY}}}$$
其中，$\rho_{XY}$ 是观测到的相关性，$\rho_{XX}$ 和 $\rho_{YY}$ 分别是大脑 RDM 和模型 RDM 的信度，而 $\rho_{T_X T_Y}$ 则是我们希望估计的、排除了测量噪声影响的“真实”相关性。

在实践中，我们可以通过**分半信度 (split-half reliability)** 来估计一个 RDM 的信度。具体做法是将数据（如被试或试次）随机分成两半，为每一半数据分别计算一个 RDM，然后计算这两个 RDM 向量之间的相关性 $r_{\text{half}}$。由于这个信度是基于一半数据量计算的，我们需要使用**斯皮尔曼-布朗预测公式 (Spearman-Brown prediction formula)** 将其校正为全数据的信度：
$$\rho_{\text{full}} = \frac{2 r_{\text{half}}}{1 + r_{\text{half}}}$$

例如，假设观测到的大脑-模型相关性为 $r_{\text{obs}} = 0.42$。大脑数据的分半信度为 $r_{\text{brain, half}} = 0.58$，模型的为 $r_{\text{model, half}} = 0.86$。首先，我们计算全数据的信度：
$$\rho_{\text{brain, full}} = \frac{2 \times 0.58}{1 + 0.58} \approx 0.7342$$
$$\rho_{\text{model, full}} = \frac{2 \times 0.86}{1 + 0.86} \approx 0.9247$$
然后，我们计算[衰减校正](@entry_id:918169)后的真实相关性估计：
$$r_{\text{corrected}} = \frac{0.42}{\sqrt{0.7342 \times 0.9247}} \approx 0.5097$$
这个结果表明，一旦我们考虑了测量噪声的衰减效应，大脑和模型表征结构之间的潜在真实相关性估计值是 $0.5097$，远高于观测到的 $0.42$。

### RSA 的定位：与编码模型的比较

最后，为了全面理解 RSA，有必要将其与[计算神经科学](@entry_id:274500)中另一个主流分析框架——**[编码模型](@entry_id:1124422) (encoding models)**——进行比较 。

[编码模型](@entry_id:1124422)旨在建立一个从刺激特征到单个体素或神经元反应的预测模型。一个典型的线性[编码模型](@entry_id:1124422)可以写成 $Y = XW + \varepsilon$，其中 $Y$ 是神经活动矩阵， $X$ 是刺激特征矩阵，模型的目标是学习一个权重矩阵 $W$，使得模型预测 $\hat{Y} = XW$ 能在交叉验证中尽可能准确地复现真实的神经活动 $Y$。

RSA 和编码模型在目标和优势上存在显著差异：
-   **核心问题**：RSA 关注的是表征的**几何结构**——不同条件下的神经活动模式之间的距离关系。编码模型则关注**预测性**和**特征调谐 (feature tuning)**——特定特征如何映射到单个神经单元的反应。
-   **空间特异性**：编码模型是天然具有空间特异性的，其输出（如权重图或预测准确率图）可以直接映射到大脑解剖结构上，从而揭示信息表征的脑区分布。而基础的 RSA 则通过在整个感兴趣区域内计算非相似性，**抽象掉了空间拓扑信息**。
-   **恒定性与跨被试分析**：RSA（特别是使用欧几里得或[相关距离](@entry_id:634939)时）对于表征模式的[正交变换](@entry_id:155650)（旋转）具有[不变性](@entry_id:140168)。这意味着即使不同被试大脑中精细的活动模式排布存在差异（可建模为未知的被试特异性旋转），他们的 RDM 仍然可以直接比较。相比之下，[编码模型](@entry_id:1124422)的权重 $W$ 在这种变换下会变得不可比，使得跨被试的权重分析变得困难，除非有完美的解剖对齐。
-   **统计功效**：在典型的高维神经影像数据中（体素数量 $p$ 远大于刺激数量 $n$），RSA 通常具有更高的[统计功效](@entry_id:197129)。因为它避免了拟合一个巨大的参数矩阵 $W$（包含 $k \times p$ 个参数），从而减少了[过拟合](@entry_id:139093)的风险。未经正则化的编码模型在这种情况下[几乎必然](@entry_id:262518)会[过拟合](@entry_id:139093)。

总而言之，RSA 和[编码模型](@entry_id:1124422)并非相互排斥，而是**互补的**。它们从不同角度探究神经表征的奥秘：RSA 揭示了表征空间的抽象几何，而编码模型则提供了关于该表征如何在具体的神经基质上实现的、具有预测性的解释。选择哪种方法，或如何结合使用它们，取决于研究者试图回答的具体科学问题。