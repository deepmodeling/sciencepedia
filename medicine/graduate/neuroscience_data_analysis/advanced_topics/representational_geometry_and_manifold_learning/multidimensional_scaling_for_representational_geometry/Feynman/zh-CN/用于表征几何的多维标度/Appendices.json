{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将引导你完整地走一遍经典多维标度（MDS）分析的全过程。从假设的神经响应向量开始，你将构建一个表征相异度矩阵（RDM），然后应用MDS将表征结构分解为其主要成分。这项练习  旨在巩固从原始神经活动模式、它们的几何相异度，到MDS提供的低维摘要之间的联系。",
            "id": "4179073",
            "problem": "在一个测量四种视觉条件下多体素活动模式的实验中，您获得了跨两个体素的以下响应向量：条件 $1$ 的响应为 $r_{1} = (0, 0)$，条件 $2$ 的响应为 $r_{2} = (1, 0)$，条件 $3$ 的响应为 $r_{3} = (0, 2)$，条件 $4$ 的响应为 $r_{4} = (1, 2)$。使用响应向量之间的欧几里得距离，构建表征相异性矩阵（RDM）。然后，对RDM应用经典多维尺度分析，以获得中心化配置及其谱分解。最后，计算第一个主坐标所捕获的总表征方差的比例（即，经典多维尺度分析解的最大正特征值除以所有正特征值之和）。请以未经四舍五入的精确分数形式提供最终答案。",
            "solution": "用户要求我解决一个问题，该问题涉及构建表征相异性矩阵（RDM）并应用经典多维尺度分析（MDS）来确定第一个主坐标所解释的方差比例。\n\n### 步骤 1：提取给定信息\n- 实验涉及四种条件。\n- 在二维体素空间中的响应向量如下：\n  - 条件 $1$：$r_1 = (0, 0)$\n  - 条件 $2$：$r_2 = (1, 0)$\n  - 条件 $3$：$r_3 = (0, 2)$\n  - 条件 $4$：$r_4 = (1, 2)$\n- 相异性度量是响应向量之间的欧几里得距离。\n- 任务是计算第一个主坐标所捕获的总表征方差的比例，定义为经典MDS解的最大正特征值除以所有正特征值之和。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学依据：** 该问题使用了神经科学数据分析的标准概念，特别是表征相似性分析（RSA）和多维尺度分析（MDS）。方法和数据在科学上是合理的。\n- **适定性：** 问题提供了所有必要的数据和定义。响应向量有明确定义，相异性度量（欧几里得距离）已指定，待计算的量也根据MDS解的特征值进行了明确定义。存在唯一、稳定且有意义的解。\n- **客观性：** 问题使用精确的数学语言陈述，不含主观或基于意见的主张。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行解答。\n\n###\n解答过程包括三个主要部分：\n1. 使用欧几里得距离，根据给定的响应向量构建表征相异性矩阵（RDM）。\n2. 应用经典多维尺度分析（MDS）求所得格拉姆矩阵的特征值。\n3. 计算所需的方差比例。\n\n**第1部分：构建RDM**\nRDM，记作 $\\Delta$，是一个对称的 $4 \\times 4$ 矩阵，其中每个元素 $\\Delta_{ij}$ 是条件 $i$ 和条件 $j$ 之间的相异性。在这里，相异性是欧几里得距离 $d(r_i, r_j)$。\n\n给定的响应向量是 $r_1 = (0, 0)$，$r_2 = (1, 0)$，$r_3 = (0, 2)$ 和 $r_4 = (1, 2)$。\n两两之间的欧几里得距离为：\n- $d(r_1, r_2) = \\sqrt{(0-1)^2 + (0-0)^2} = \\sqrt{1} = 1$\n- $d(r_1, r_3) = \\sqrt{(0-0)^2 + (0-2)^2} = \\sqrt{4} = 2$\n- $d(r_1, r_4) = \\sqrt{(0-1)^2 + (0-2)^2} = \\sqrt{1+4} = \\sqrt{5}$\n- $d(r_2, r_3) = \\sqrt{(1-0)^2 + (0-2)^2} = \\sqrt{1+4} = \\sqrt{5}$\n- $d(r_2, r_4) = \\sqrt{(1-1)^2 + (0-2)^2} = \\sqrt{4} = 2$\n- $d(r_3, r_4) = \\sqrt{(0-1)^2 + (2-2)^2} = \\sqrt{1} = 1$\n对角线元素为 $d(r_i, r_i) = 0$。由于距离矩阵是对称的（$\\Delta_{ij} = \\Delta_{ji}$），我们可以构建完整的RDM：\n$$\n\\Delta = \\begin{pmatrix}\n0  1  2  \\sqrt{5} \\\\\n1  0  \\sqrt{5}  2 \\\\\n2  \\sqrt{5}  0  1 \\\\\n\\sqrt{5}  2  1  0\n\\end{pmatrix}\n$$\n\n**第2部分：应用经典多维尺度分析**\n经典MDS（也称为Torgerson-Gower尺度分析）旨在找到一个点的配置，使得点间的距离与给定的相异性相匹配。由于我们的相异性是从现有配置中导出的欧几里得距离，MDS将恢复这个原始配置的中心化版本。\n\n该过程首先创建平方相异性矩阵 $\\Delta^{(2)}$，其中 $(\\Delta^{(2)})_{ij} = (\\Delta_{ij})^2$：\n$$\n\\Delta^{(2)} = \\begin{pmatrix}\n0  1  4  5 \\\\\n1  0  5  4 \\\\\n4  5  0  1 \\\\\n5  4  1  0\n\\end{pmatrix}\n$$\n接下来，我们通过对 $\\Delta^{(2)}$ 进行双重中心化来计算格拉姆矩阵 $B$：$B = -\\frac{1}{2} J \\Delta^{(2)} J$，其中 $J = I - \\frac{1}{n} \\mathbf{1}\\mathbf{1}^T$ 是中心化矩阵（$n=4$）。\n\n然而，存在一种更直接的方法。由于我们有原始坐标，我们可以通过计算中心化坐标的内积矩阵来找到格拉姆矩阵 $B$。设原始坐标矩阵为 $X$：\n$$\nX = \\begin{pmatrix}\n0  0 \\\\\n1  0 \\\\\n0  2 \\\\\n1  2\n\\end{pmatrix}\n$$\n点的数量为 $n=4$。这些点的质心（均值向量）是：\n$$\n\\bar{r} = \\frac{1}{4} \\sum_{i=1}^{4} r_i = \\frac{1}{4} \\left( (0+1+0+1), (0+0+2+2) \\right) = \\frac{1}{4} (2, 4) = \\left(\\frac{1}{2}, 1\\right)\n$$\n通过从 $X$ 的每一行减去质心，得到中心化坐标矩阵 $X_c$：\n$$\nX_c = \\begin{pmatrix}\n0 - \\frac{1}{2}  0 - 1 \\\\\n1 - \\frac{1}{2}  0 - 1 \\\\\n0 - \\frac{1}{2}  2 - 1 \\\\\n1 - \\frac{1}{2}  2 - 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{2}  -1 \\\\\n\\frac{1}{2}  -1 \\\\\n-\\frac{1}{2}  1 \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}\n$$\n格拉姆矩阵由 $B = X_c X_c^T$ 给出。$B$ 的谱分解给出了经典MDS问题的解。$B$ 的特征值是所需的量。\n\n线性代数中的一个基本结果指出，对于任何矩阵 $A$，$A A^T$ 的非零特征值与 $A^T A$ 的非零特征值相同。在我们的例子中，计算 $X_c^T X_c$ 的特征值比计算 $B = X_c X_c^T$ 的特征值简单得多，因为 $X_c$ 是一个 $4 \\times 2$ 矩阵，所以 $X_c^T X_c$ 是一个 $2 \\times 2$ 矩阵。我们称这个矩阵为 $C = X_c^T X_c$。\n\n$$\nC = X_c^T X_c =\n\\begin{pmatrix}\n-\\frac{1}{2}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{2} \\\\\n-1  -1  1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n-\\frac{1}{2}  -1 \\\\\n\\frac{1}{2}  -1 \\\\\n-\\frac{1}{2}  1 \\\\\n\\frac{1}{2}  1\n\\end{pmatrix}\n$$\n让我们计算 $C$ 的元素：\n$$\nC_{11} = \\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} = 1\n$$\n$$\nC_{12} = \\left(-\\frac{1}{2}\\right)(-1) + \\left(\\frac{1}{2}\\right)(-1) + \\left(-\\frac{1}{2}\\right)(1) + \\left(\\frac{1}{2}\\right)(1) = \\frac{1}{2} - \\frac{1}{2} - \\frac{1}{2} + \\frac{1}{2} = 0\n$$\n$$\nC_{21} = C_{12} = 0\n$$\n$$\nC_{22} = (-1)^2 + (-1)^2 + 1^2 + 1^2 = 1 + 1 + 1 + 1 = 4\n$$\n所以矩阵 $C$ 是：\n$$\nC = \\begin{pmatrix}\n1  0 \\\\\n0  4\n\\end{pmatrix}\n$$\n这个对角矩阵的特征值就是其对角线上的元素：$\\lambda_a = 1$ 和 $\\lambda_b = 4$。这些是格拉姆矩阵 $B$ 的两个非零特征值。$B$ 的另外两个特征值为零。\n经典MDS解的正特征值为 $\\lambda_1 = 4$ 和 $\\lambda_2 = 1$（按从大到小排序）。\n\n**第3部分：计算方差比例**\n问题要求计算第一个主坐标所捕获的总表征方差的比例。这被定义为最大正特征值与所有正特征值之和的比率。\n\n最大正特征值为 $\\lambda_{\\max} = \\lambda_1 = 4$。\n所有正特征值之和为 $\\sum \\lambda_{i>0} = \\lambda_1 + \\lambda_2 = 4 + 1 = 5$。\n\n该比例为：\n$$\n\\text{Proportion} = \\frac{\\lambda_{\\max}}{\\sum \\lambda_{i>0}} = \\frac{4}{5}\n$$\n这个结果意味着第一个主坐标（即在表征几何中捕获最多变异性的维度）解释了相异性结构中总方差的 $80\\%$。",
            "answer": "$$\n\\boxed{\\frac{4}{5}}\n$$"
        },
        {
            "introduction": "非度量多维标度（NMDS）超越了经典MDS对距离的严格保持，通过仅保留相异度的秩次顺序，提供了一种更灵活的方法。此练习  聚焦于NMDS的核心计算步骤：单调回归。该方法旨在寻找最佳拟合的单调函数，以将嵌入距离与原始相异度对齐。通过计算Kruskal压力值，你将亲身体验如何量化非度量嵌入的拟合优度。",
            "id": "4179037",
            "problem": "一个实验室正在分析由一组刺激诱发的神经活动模式之间的表征非相似性。科学家从一个表征非相似性矩阵 (RDM) 中提取了一组非相似性值 $\\delta_{ij}$，并从相同刺激的一个临时二维嵌入中测量了点间距离 $d_{ij}$。本着非度量多维尺度分析 (MDS) 的精神，通过寻找一个从非相似性到拟合距离的单调递增变换来评估拟合优度，该变换能使 $d_{ij}$ 值与 $\\delta_{ij}$ 值的秩次序最佳对齐。\n\n考虑从一名受试者的记录会话中获得的不同刺激对的以下七对测量值 $(\\delta_{ij}, d_{ij})$：\n$(0.8,\\, 1.1)$, $(1.2,\\, 0.9)$, $(1.4,\\, 1.3)$, $(1.5,\\, 1.7)$, $(1.9,\\, 1.6)$, $(2.1,\\, 2.0)$, $(2.3,\\, 1.9)$。\n\n假设所有对的权重相等。遵循经典的非度量程序，使用最小二乘准则对距离与非相似性进行单调回归拟合，并强制拟合映射相对于 $\\delta_{ij}$ 是非递减的。然后计算该拟合产生的 Kruskal's stress-1。\n\n将最终的压力值表示为一个无量纲小数，并四舍五入到四位有效数字。",
            "solution": "用户希望我解决一个问题，该问题涉及对一组数据点进行单调回归，然后计算 Kruskal's stress-1。\n\n### 步骤 1：提取已知信息\n-   **数据**：七对非相似性值 $\\delta_{ij}$ 和点间距离 $d_{ij}$ 的测量值。这些配对 $(\\delta_{ij}, d_{ij})$ 是：\n    $(0.8, 1.1)$, $(1.2, 0.9)$, $(1.4, 1.3)$, $(1.5, 1.7)$, $(1.9, 1.6)$, $(2.1, 2.0)$, $(2.3, 1.9)$。\n-   **方法**：\n    1.  对距离 $d_{ij}$ 与非相似性 $\\delta_{ij}$ 进行单调回归拟合。\n    2.  拟合必须强制一个非递减映射，即，如果 $\\delta_{ij}  \\delta_{kl}$，则拟合距离必须满足 $\\hat{d}_{ij} \\le \\hat{d}_{kl}$。\n    3.  拟合的准则是最小二乘准则，即最小化 $\\sum (d_{ij} - \\hat{d}_{ij})^2$。\n    4.  假设所有对的权重相等。\n-   **输出**：计算得到的 Kruskal's stress-1，$S_1$，并将其表示为四舍五入到四位有效数字的小数。\n\n### 步骤 2：使用提取的已知信息进行验证\n-   **科学性**：该问题描述了非度量多维尺度分析 (MDS) 的一个核心组成部分，这是一种成熟的统计技术，广泛应用于数据分析，包括神经科学中用于分析表征几何。单调回归和 Kruskal's stress 是该领域的标准概念。该问题在科学上是合理的。\n-   **适定性**：提供了数据，明确定义了目标（计算 stress-1），并指定了方法（通过最小二乘法进行单调回归）。池邻违规者算法 (PAVA) 为最小二乘准则下的单调回归问题提供了唯一的解。该问题是适定的。\n-   **客观性**：问题使用了精确的术语（$\\delta_{ij}$、$d_{ij}$、单调回归、Kruskal's stress-1）并提供了数值数据。没有主观或含糊的陈述。该问题是客观的。\n-   **完整性**：提供了进行所需计算的所有必要数据和约束。该问题是自包含的。\n\n### 步骤 3：结论和行动\n该问题是有效的。这是一个应用非度量 MDS 原则的标准的、定义明确的数值练习。我将继续进行求解。\n\n该问题要求我们首先找到一组拟合距离（记为 $\\hat{d}_{ij}$），这组距离相对于给定的非相似性值 $\\delta_{ij}$ 是单调非递减的，并且在最小二乘意义上尽可能接近观测到的距离 $d_{ij}$。这个过程被称为单调回归或保序回归。一旦找到拟合距离 $\\hat{d}_{ij}$，我们就计算 Kruskal's stress-1。\n\n首先，我们必须根据非相似性值 $\\delta_{ij}$ 对数据对进行排序。设数据对的数量为 $n=7$。给定的非相似性值已经按升序排列：\n$0.8, 1.2, 1.4, 1.5, 1.9, 2.1, 2.3$。\n我们将相应的观测距离序列表示为 $D = (d_{(1)}, d_{(2)}, \\dots, d_{(7)})$。\n$$D = (1.1, 0.9, 1.3, 1.7, 1.6, 2.0, 1.9)$$\n我们寻求一个新的拟合距离序列 $\\hat{D} = (\\hat{d}_{(1)}, \\hat{d}_{(2)}, \\dots, \\hat{d}_{(7)})$，使得：\n1.  它是单调非递减的：$\\hat{d}_{(1)} \\le \\hat{d}_{(2)} \\le \\dots \\le \\hat{d}_{(7)}$。\n2.  它最小化平方误差和：$\\sum_{k=1}^{7} (d_{(k)} - \\hat{d}_{(k)})^2$。\n\n解决这个问题的标准算法是池邻违规者算法 (PAVA)。该算法迭代地识别和解决违反单调性约束的情况。如果对于某个 $k$，有 $\\hat{d}_{(k)} > \\hat{d}_{(k+1)}$，就发生了违规。当发现这样的违规时，违规的值将被它们的加权平均值（由于权重相等，这里是简单平均值）所取代。重复此过程，直到没有违规为止。\n\n让我们将 PAVA 应用于我们的序列 $D$：\n初始序列：$(1.1, 0.9, 1.3, 1.7, 1.6, 2.0, 1.9)$。\n\n1.  我们从左到右扫描。第一个违规发生在第一个和第二个元素之间：$1.1 > 0.9$。我们必须将这两个值合并。\n    平均值为 $\\frac{1.1 + 0.9}{2} = 1.0$。\n    序列变为：$(1.0, 1.0, 1.3, 1.7, 1.6, 2.0, 1.9)$。\n    我们从新的块开始向后检查。这个块就是 $(1.0, 1.0)$，它是单调的。我们继续向前扫描。\n\n2.  现在的序列是 $\\hat{D} = (1.0, 1.0, 1.3, 1.7, 1.6, 2.0, 1.9)$。\n    我们继续扫描：$1.0 \\le 1.0 \\le 1.3 \\le 1.7$。下一个比较是在第四个和第五个元素之间：$1.7 > 1.6$。这是一个违规。我们将这两个值合并。\n    平均值为 $\\frac{1.7 + 1.6}{2} = 1.65$。\n    序列变为：$(1.0, 1.0, 1.3, 1.65, 1.65, 2.0, 1.9)$。\n    我们必须检查这个新块与前一个值的关系：$1.3 \\le 1.65$。单调性保持。我们继续向前扫描。\n\n3.  现在的序列是 $\\hat{D} = (1.0, 1.0, 1.3, 1.65, 1.65, 2.0, 1.9)$。\n    我们继续扫描：$1.65 \\le 1.65 \\le 2.0$。下一个比较是在第六个和第七个元素之间：$2.0 > 1.9$。这是一个违规。我们将这两个值合并。\n    平均值为 $\\frac{2.0 + 1.9}{2} = 1.95$。\n    序列变为：$(1.0, 1.0, 1.3, 1.65, 1.65, 1.95, 1.95)$。\n    我们检查这个新块与前一个值的关系：$1.65 \\le 1.95$。单调性保持。\n\n最终序列是 $(1.0, 1.0, 1.3, 1.65, 1.65, 1.95, 1.95)$。让我们验证其单调性：\n$1.0 \\le 1.0 \\le 1.3 \\le 1.65 \\le 1.65 \\le 1.95 \\le 1.95$。\n该序列是完全非递减的。这就是我们的拟合距离序列 $\\hat{D}$。\n所以，$\\hat{d}_{(1)}=1.0$, $\\hat{d}_{(2)}=1.0$, $\\hat{d}_{(3)}=1.3$, $\\hat{d}_{(4)}=1.65$, $\\hat{d}_{(5)}=1.65$, $\\hat{d}_{(6)}=1.95$, $\\hat{d}_{(7)}=1.95$。\n\n现在我们计算 Kruskal's stress-1，其定义为：\n$$S_1 = \\sqrt{\\frac{\\sum (d_{ij} - \\hat{d}_{ij})^2}{\\sum d_{ij}^2}}$$\n求和是在所有 $n=7$ 个数据对上进行的。\n\n首先，我们计算分子，即残差平方和 $\\sum_{k=1}^{7} (d_{(k)} - \\hat{d}_{(k)})^2$：\n-   $(d_{(1)} - \\hat{d}_{(1)})^2 = (1.1 - 1.0)^2 = 0.1^2 = 0.01$。\n-   $(d_{(2)} - \\hat{d}_{(2)})^2 = (0.9 - 1.0)^2 = (-0.1)^2 = 0.01$。\n-   $(d_{(3)} - \\hat{d}_{(3)})^2 = (1.3 - 1.3)^2 = 0^2 = 0$。\n-   $(d_{(4)} - \\hat{d}_{(4)})^2 = (1.7 - 1.65)^2 = 0.05^2 = 0.0025$。\n-   $(d_{(5)} - \\hat{d}_{(5)})^2 = (1.6 - 1.65)^2 = (-0.05)^2 = 0.0025$。\n-   $(d_{(6)} - \\hat{d}_{(6)})^2 = (2.0 - 1.95)^2 = 0.05^2 = 0.0025$。\n-   $(d_{(7)} - \\hat{d}_{(7)})^2 = (1.9 - 1.95)^2 = (-0.05)^2 = 0.0025$。\n\n残差平方和为：\n$\\sum (d_{(k)} - \\hat{d}_{(k)})^2 = 0.01 + 0.01 + 0 + 0.0025 + 0.0025 + 0.0025 + 0.0025 = 0.03$.\n\n接下来，我们计算分母，即原始距离的平方和 $\\sum_{k=1}^{7} d_{(k)}^2$：\n-   $d_{(1)}^2 = 1.1^2 = 1.21$。\n-   $d_{(2)}^2 = 0.9^2 = 0.81$。\n-   $d_{(3)}^2 = 1.3^2 = 1.69$。\n-   $d_{(4)}^2 = 1.7^2 = 2.89$。\n-   $d_{(5)}^2 = 1.6^2 = 2.56$。\n-   $d_{(6)}^2 = 2.0^2 = 4.00$。\n-   $d_{(7)}^2 = 1.9^2 = 3.61$。\n\n距离平方和为：\n$\\sum d_{(k)}^2 = 1.21 + 0.81 + 1.69 + 2.89 + 2.56 + 4.00 + 3.61 = 16.77$.\n\n现在，我们可以计算 stress-1 的值：\n$$S_1 = \\sqrt{\\frac{0.03}{16.77}} \\approx \\sqrt{0.00178890876...} \\approx 0.042295500...$$\n\n问题要求答案四舍五入到四位有效数字。\n第一个有效数字是 $4$。接下来的三位是 $2, 2, 9$。第五位有效数字是 $5$，这意味着我们需要将第四位向上取整。\n$0.0422955...$ 四舍五入到四位有效数字是 $0.04230$。",
            "answer": "$$\n\\boxed{0.04230}\n$$"
        },
        {
            "introduction": "在实际应用中，测量得到的相异度可能并不完全对应于任何欧几里得空间中的距离，这通常是由于噪声或度量本身的性质所致。这项高级练习  探讨了如何处理此类非欧几里得数据，即通过将相应的内积矩阵投影到最近的有效（半正定）矩阵上。这个过程是主坐标分析（PCoA）的核心，它确保了嵌入的几何有效性，并使你能够量化此校正所引入的失真程度。",
            "id": "4179062",
            "problem": "一个实验室从一个神经元群体中收集了三种视觉刺激之间的成对非相似性，并将它们组合成一个对角线元素为零的平方非相似性对称矩阵 $D^{(2)}$。尽管这些测量值旨在反映表征向量之间的平方欧几里得距离，但测量噪声可能会使 $D^{(2)}$ 变为非欧几里得的。考虑以下具体情况\n$$\nD^{(2)} \\;=\\; \\begin{pmatrix}\n0  1  16 \\\\\n1  0  4 \\\\\n16  4  0\n\\end{pmatrix}.\n$$\n使用经典多维标度分析 (MDS) 来恢复一个点的构型，其点间距离近似于 $D^{(2)}$。仅从以下定义出发：(i) 如果点是均值中心化的，则内积 (格拉姆) 矩阵编码了成对内积；(ii) 点之间的平方欧几里得距离由其内积决定。请执行以下步骤：\n\n1. 在均值中心化的假设下，推导如何从一个通用的平方非相似性矩阵 $D^{(2)}$ 获得内积矩阵 $B$。然后，对于给定的 $D^{(2)}$，计算相应的 $B$。\n\n2. 利用 $B$ 的谱性质，通过将 $B$ 的任何负特征值设为零，同时保持非负特征值不变，构造一个投影内积矩阵 $B^{+}$。解释为什么在弗罗贝尼乌斯范数下最小化 $B$ 的变化的意义上，这个投影是最近的。\n\n3. 从 $B^{+}$ 重构一个平方欧几里得距离矩阵 $D^{(2)}_{\\text{proj}}$，该矩阵与在欧几里得空间中的嵌入相一致，并根据内积和平方距离之间的关系简要论证此重构的形式。\n\n4. 通过计算弗罗贝尼乌斯范数 $\\|B - B^{+}\\|_{F}$ 的精确值，来量化投影引起的失真。将您的最终答案表示为不进行四舍五入的单一闭式解析表达式。\n\n提供 $\\|B - B^{+}\\|_{F}$ 的精确值作为您的最终答案。",
            "solution": "用户希望我解决一个关于多维标度分析 (MDS) 的问题。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- 一个平方非相似性的对称矩阵：\n$$\nD^{(2)} \\;=\\; \\begin{pmatrix}\n0  1  16 \\\\\n1  0  4 \\\\\n16  4  0\n\\end{pmatrix}\n$$\n- 定义 (i)：对于均值中心化的点，内积 (格拉姆) 矩阵 $B$ 编码了成对内积。\n- 定义 (ii)：点之间的平方欧几里得距离由其内积决定。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学上成立**：该问题探讨了经典多维标度分析 (MDS)，这是一种用于分析表征相似性的数据分析、计算统计学和神经科学中的标准且成熟的技术。测量噪声可能导致非欧几里得非相似性矩阵这一前提，是MDS实际应用中一个公认的问题。所描述的校正方法——通过将相关的内积矩阵投影到半正定矩阵锥上——是标准方法（称为主坐标分析）。该问题牢固地建立在公认的数学和统计原理之上。\n- **良构的**：该问题清晰地结构化为四个顺序任务。它提供了进行计算所需的所有数据（矩阵 $D^{(2)}$）和定义。期望的输出是具体且明确无误的。每个步骤都存在唯一的解。\n- **客观的**：该问题以精确、正式和客观的数学语言陈述。它不含主观主张或意见。\n- **完整性和一致性**：该问题是自洽的。所提供的矩阵和定义足以执行所有必需的计算和推导。设置中没有矛盾。\n- **主题相关性**：该问题明确提到了用于表征几何和神经科学数据分析的MDS，这正是所要求的主题。\n- **其他缺陷**：该问题并非琐碎、隐喻性或不切实际。它展示了线性代数在数据分析背景下的一个标准的、非平凡的应用。\n\n**第3步：结论与行动**\n\n该问题是有效的，因为它科学上合理、良构、客观且自洽。我将继续提供完整解答。\n\n### 解答\n\n该问题要求使用经典多维标度分析 (MDS) 的原理，对给定的平方非相似性矩阵 $D^{(2)}$ 进行四部分分析。\n\n**1. 内积矩阵 $B$ 的推导与计算**\n\n设存在由向量 $\\mathbf{x}_1, \\dots, \\mathbf{x}_n \\in \\mathbb{R}^p$ 表示的 $n$ 个点。点 $\\mathbf{x}_i$ 和 $\\mathbf{x}_j$ 之间的平方欧几里得距离由 $d_{ij}^2 = \\|\\mathbf{x}_i - \\mathbf{x}_j\\|^2$ 给出。这些平方距离的矩阵是 $D^{(2)}$。内积 (格拉姆) 矩阵是 $B$，其元素为 $B_{ij} = \\mathbf{x}_i^T \\mathbf{x}_j$。\n\n展开平方距离，我们得到：\n$$\nd_{ij}^2 = (\\mathbf{x}_i - \\mathbf{x}_j)^T(\\mathbf{x}_i - \\mathbf{x}_j) = \\mathbf{x}_i^T\\mathbf{x}_i - 2 \\mathbf{x}_i^T\\mathbf{x}_j + \\mathbf{x}_j^T\\mathbf{x}_j = B_{ii} - 2B_{ij} + B_{jj}\n$$\n问题指定点的构型是均值中心化的，这意味着 $\\sum_{k=1}^n \\mathbf{x}_k = \\mathbf{0}$。这意味着格拉姆矩阵 $B$ 的行和与列和都为零：\n$$\n\\sum_{j=1}^n B_{ij} = \\sum_{j=1}^n \\mathbf{x}_i^T \\mathbf{x}_j = \\mathbf{x}_i^T \\left(\\sum_{j=1}^n \\mathbf{x}_j\\right) = \\mathbf{x}_i^T \\mathbf{0} = 0\n$$\n$$\n\\sum_{i=1}^n B_{ij} = \\sum_{i=1}^n \\mathbf{x}_i^T \\mathbf{x}_j = \\left(\\sum_{i=1}^n \\mathbf{x}_i\\right)^T \\mathbf{x}_j = \\mathbf{0}^T \\mathbf{x}_j = 0\n$$\n利用此性质，我们可以从 $D^{(2)}$ 推导出 $B$。将 $d_{ij}^2$ 对 $j$ 和 $i$ 求和：\n$$\n\\sum_{j=1}^n d_{ij}^2 = \\sum_{j=1}^n (B_{ii} - 2B_{ij} + B_{jj}) = n B_{ii} - 2\\sum_{j=1}^n B_{ij} + \\sum_{j=1}^n B_{jj} = n B_{ii} + \\text{Tr}(B)\n$$\n$$\n\\sum_{i=1}^n d_{ij}^2 = \\sum_{i=1}^n (B_{ii} - 2B_{ij} + B_{jj}) = \\sum_{i=1}^n B_{ii} - 2\\sum_{i=1}^n B_{ij} + n B_{jj} = \\text{Tr}(B) + n B_{jj}\n$$\n对两个指标求和得到 $\\sum_{i,j} d_{ij}^2 = 2n\\text{Tr}(B)$，所以 $\\text{Tr}(B) = \\frac{1}{2n}\\sum_{i,j} d_{ij}^2$。\n\n让我们定义 $D^{(2)}$ 元素的行、列和总体平均值：\n$d_{i\\cdot}^2 = \\frac{1}{n} \\sum_{j=1}^n d_{ij}^2$, $d_{\\cdot j}^2 = \\frac{1}{n} \\sum_{i=1}^n d_{ij}^2$, and $d_{\\cdot\\cdot}^2 = \\frac{1}{n^2} \\sum_{i,j} d_{ij}^2$。\n从上面的求和中：\n$d_{i\\cdot}^2 = B_{ii} + \\frac{1}{n}\\text{Tr}(B)$,\n$d_{\\cdot j}^2 = B_{jj} + \\frac{1}{n}\\text{Tr}(B)$,\n$d_{\\cdot\\cdot}^2 = \\frac{2}{n}\\text{Tr}(B)$。\n现在，我们用这些量来表示 $B_{ij}$：\n$$\nB_{ij} = -\\frac{1}{2} (d_{ij}^2 - B_{ii} - B_{jj}) = -\\frac{1}{2} \\left[d_{ij}^2 - \\left(d_{i\\cdot}^2 - \\frac{1}{n}\\text{Tr}(B)\\right) - \\left(d_{\\cdot j}^2 - \\frac{1}{n}\\text{Tr}(B)\\right)\\right]\n$$\n$$\nB_{ij} = -\\frac{1}{2} \\left[d_{ij}^2 - d_{i\\cdot}^2 - d_{\\cdot j}^2 + \\frac{2}{n}\\text{Tr}(B)\\right] = -\\frac{1}{2} (d_{ij}^2 - d_{i\\cdot}^2 - d_{\\cdot j}^2 + d_{\\cdot\\cdot}^2)\n$$\n这就是“双中心化”公式。对于给定的矩阵 $D^{(2)}$，其中 $n=3$：\n$$\nD^{(2)} \\;=\\; \\begin{pmatrix}\n0  1  16 \\\\\n1  0  4 \\\\\n16  4  0\n\\end{pmatrix}\n$$\n行和分别为 17、5 和 20。总和为 42。由于 $D^{(2)}$ 是对称的，列和与行和相同。\n行/列平均值为：\n$d_{1\\cdot}^2 = d_{\\cdot 1}^2 = 17/3$。\n$d_{2\\cdot}^2 = d_{\\cdot 2}^2 = 5/3$。\n$d_{3\\cdot}^2 = d_{\\cdot 3}^2 = 20/3$。\n总体平均值为 $d_{\\cdot\\cdot}^2 = 42/3^2 = 14/3$。\n现在我们计算 $B$ 的元素：\n$B_{11} = -\\frac{1}{2}(0 - \\frac{17}{3} - \\frac{17}{3} + \\frac{14}{3}) = -\\frac{1}{2}(-\\frac{20}{3}) = \\frac{10}{3}$。\n$B_{22} = -\\frac{1}{2}(0 - \\frac{5}{3} - \\frac{5}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{4}{3}) = -\\frac{2}{3}$。\n$B_{33} = -\\frac{1}{2}(0 - \\frac{20}{3} - \\frac{20}{3} + \\frac{14}{3}) = -\\frac{1}{2}(-\\frac{26}{3}) = \\frac{13}{3}$。\n$B_{12} = -\\frac{1}{2}(1 - \\frac{17}{3} - \\frac{5}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{3-17-5+14}{3}) = -\\frac{1}{2}(-\\frac{5}{3}) = \\frac{5}{6}$。\n$B_{13} = -\\frac{1}{2}(16 - \\frac{17}{3} - \\frac{20}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{48-17-20+14}{3}) = -\\frac{1}{2}(\\frac{25}{3}) = -\\frac{25}{6}$。\n$B_{23} = -\\frac{1}{2}(4 - \\frac{5}{3} - \\frac{20}{3} + \\frac{14}{3}) = -\\frac{1}{2}(\\frac{12-5-20+14}{3}) = -\\frac{1}{2}(\\frac{1}{3}) = -\\frac{1}{6}$。\n因此内积矩阵为：\n$$\nB \\;=\\; \\begin{pmatrix}\n10/3  5/6  -25/6 \\\\\n5/6  -2/3  -1/6 \\\\\n-25/6  -1/6  13/3\n\\end{pmatrix} \\;=\\; \\frac{1}{6} \\begin{pmatrix}\n20  5  -25 \\\\\n5  -4  -1 \\\\\n-25  -1  26\n\\end{pmatrix}\n$$\n\n**2. 到半正定锥上的投影**\n\n为了找到 $B$ 的谱性质，我们计算其特征值。令 $\\lambda$ 为 $B$ 的一个特征值，$\\mu = 6\\lambda$ 为 $6B$ 的一个特征值。$6B$ 的特征方程为 $\\det(6B - \\mu I) = 0$。\n$$\n\\det \\begin{pmatrix}\n20-\\mu  5  -25 \\\\\n5  -4-\\mu  -1 \\\\\n-25  -1  26-\\mu\n\\end{pmatrix} = 0\n$$\n展开行列式得到：\n$(20-\\mu)[(-4-\\mu)(26-\\mu) - 1] - 5[5(26-\\mu) - 25] - 25[-5 - (-25)(-4-\\mu)] = 0$\n$-\\mu^3 + 42\\mu^2 + 315\\mu = 0$\n$-\\mu(\\mu^2 - 42\\mu - 315) = 0$\n一个特征值是 $\\mu_1 = 0$。另外两个是二次方程的根：\n$$\n\\mu = \\frac{42 \\pm \\sqrt{(-42)^2 - 4(1)(-315)}}{2} = \\frac{42 \\pm \\sqrt{1764 + 1260}}{2} = \\frac{42 \\pm \\sqrt{3024}}{2}\n$$\n化简平方根：$\\sqrt{3024} = \\sqrt{144 \\cdot 21} = 12\\sqrt{21}$。\n$$\n\\mu = \\frac{42 \\pm 12\\sqrt{21}}{2} = 21 \\pm 6\\sqrt{21}\n$$\n$6B$ 的特征值是 $\\mu_1=0$，$\\mu_2 = 21 + 6\\sqrt{21}$，和 $\\mu_3 = 21 - 6\\sqrt{21}$。$B$ 的特征值是 $\\lambda_i = \\mu_i/6$：\n$\\lambda_1=0$，$\\lambda_2 = \\frac{7}{2} + \\sqrt{21}$，$\\lambda_3 = \\frac{7}{2} - \\sqrt{21}$。\n我们检查 $\\lambda_3$ 的符号。由于 $(\\sqrt{21})^2 = 21$ 且 $(7/2)^2 = 49/4 = 12.25$，我们有 $\\sqrt{21} > 7/2$，所以 $\\lambda_3  0$。矩阵 $B$ 不是半正定的，这证实了 $D^{(2)}$ 是非欧几里得的。\n\n投影矩阵 $B^{+}$ 是通过将负特征值设为零而形成的。设 $B$ 的谱分解为 $B = V \\Lambda V^T$，其中 $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$，$V$ 是特征向量的正交矩阵。那么 $B^{+} = V \\Lambda^{+} V^T$，其中 $\\Lambda^{+} = \\text{diag}(\\max(0,\\lambda_1), \\max(0,\\lambda_2), \\max(0,\\lambda_3))$。\n$$\n\\Lambda^{+} = \\text{diag}(0, \\frac{7}{2} + \\sqrt{21}, 0)\n$$\n就弗罗贝尼乌斯范数而言，这个投影找到了与 $B$ 最近的半正定矩阵。这是 Eckart-Young-Mirsky 定理的一个结果，该结果专门用于半正定近似。对于一个对称矩阵 $B$，在所有半正定矩阵 $X$ 上最小化 $\\|B-X\\|_F$ 的问题，可以通过找到 $B$ 的谱分解 $B = V\\Lambda V^T$ 并设置 $X = V \\text{diag}(\\max(0,\\lambda_i)) V^T$ 来解决。弗罗贝尼乌斯范数是酉不变的，所以 $\\|B-X\\|_F^2 = \\|\\Lambda - V^T X V\\|_F^2$。当 $V^T X V$ 是对角矩阵 $\\Lambda^{+}$ 时，达到最小值，这意味着 $X=B^{+}$。\n\n**3. 欧几里得距离矩阵 $D^{(2)}_{\\text{proj}}$ 的重构**\n\n平方距离矩阵 $D^{(2)}$ 与其对应的中心化内积矩阵 $B$ 之间的关系由 $d_{ij}^2 = B_{ii} - 2B_{ij} + B_{jj}$ 给出。为了重构一个保证是欧几里得的平方距离矩阵 $D^{(2)}_{\\text{proj}}$，我们将此公式应用于投影后的半正定内积矩阵 $B^{+}$。\n$$\n(D^{(2)}_{\\text{proj}})_{ij} = (B^{+})_{ii} - 2(B^{+})_{ij} + (B^{+})_{jj}\n$$\n这种重构是合理的，因为 $B^{+}$ 是半正定的，所以是一个有效的格拉姆矩阵。这意味着在欧几里得空间中存在一个点的构型 $\\{\\mathbf{y}_i\\}$，使得它们的内积由 $B^{+}_{ij} = \\mathbf{y}_i^T \\mathbf{y}_j$ 给出。那么这些点之间的平方欧几里得距离必然由 $\\|\\mathbf{y}_i - \\mathbf{y}_j\\|^2 = B^{+}_{ii} - 2B^{+}_{ij} + B^{+}_{jj}$ 给出，这正是 $(D^{(2)}_{\\text{proj}})_{ij}$ 的公式。\n\n**4. 量化失真**\n\n失真是原始内积矩阵与投影内积矩阵之差的弗罗贝尼乌斯范数，即 $\\|B - B^{+}\\|_F$。利用弗罗贝尼乌斯范数的酉不变性：\n$$\n\\|B - B^{+}\\|_F = \\|V \\Lambda V^T - V \\Lambda^{+} V^T\\|_F = \\|V (\\Lambda - \\Lambda^{+}) V^T\\|_F = \\|\\Lambda - \\Lambda^{+}\\|_F\n$$\n特征值矩阵之间的差是：\n$$\n\\Lambda - \\Lambda^{+} = \\text{diag}(\\lambda_1 - \\max(0,\\lambda_1), \\lambda_2 - \\max(0,\\lambda_2), \\lambda_3 - \\max(0,\\lambda_3))\n$$\n$$\n\\Lambda - \\Lambda^{+} = \\text{diag}(0 - 0, (\\frac{7}{2} + \\sqrt{21}) - (\\frac{7}{2} + \\sqrt{21}), (\\frac{7}{2} - \\sqrt{21}) - 0)\n$$\n$$\n\\Lambda - \\Lambda^{+} = \\text{diag}(0, 0, \\frac{7}{2} - \\sqrt{21})\n$$\n这个对角矩阵的弗罗贝尼乌斯范数是其对角元素平方和的平方根：\n$$\n\\|B - B^{+}\\|_F = \\sqrt{0^2 + 0^2 + \\left(\\frac{7}{2} - \\sqrt{21}\\right)^2} = \\left|\\frac{7}{2} - \\sqrt{21}\\right|\n$$\n由于我们已经确定 $\\frac{7}{2} - \\sqrt{21}  0$，其绝对值为：\n$$\n\\|B - B^{+}\\|_F = - \\left(\\frac{7}{2} - \\sqrt{21}\\right) = \\sqrt{21} - \\frac{7}{2}\n$$\n这个量表示 $B$ 的负特征值的绝对值之和。",
            "answer": "$$\n\\boxed{\\sqrt{21} - \\frac{7}{2}}\n$$"
        }
    ]
}